# Foreword
This Technical Specification (TS) has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes the characteristics of the Layer 1 multiplexing
and channel coding in the FDD mode of UTRA.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies.
[1] 3GPP TS 25.201: \"Physical layer - General Description\".
[2] 3GPP TS 25.211: \"Physical channels and mapping of transport channels onto
physical channels (FDD)\".
[3] 3GPP TS 25.213: \"Spreading and modulation (FDD)\".
[4] 3GPP TS 25.214: \"Physical layer procedures (FDD)\".
[5] 3GPP TS 25.215: \"Physical layer -- Measurements (FDD)\".
[6] 3GPP TS 25.221: \"Physical channels and mapping of transport channels onto
physical channels (TDD)\".
[7] 3GPP TS 25.222: \"Multiplexing and channel coding (TDD)\".
[8] 3GPP TS 25.223: \"Spreading and modulation (TDD)\".
[9] 3GPP TS 25.224: \"Physical layer procedures (TDD)\".
[10] 3GPP TS 25.225: \"Physical layer -- Measurements (TDD)\".
[11] 3GPP TS 25.302: \"Services Provided by the Physical Layer\".
[12] 3GPP TS 25.402: \"Synchronization in UTRAN, Stage 2\".
[13] 3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol Specification\".
[14] ITU-T Recommendation X.691 (12/97) \"Information technology - ASN.1
encoding rules: Specification of Packed Encoding Rules (PER)\"
[15] 3GPP TS 25.306: \"UE Radio Access capabilities\".
[16] 3GPP TS 25.321: \"Medium Access Control (MAC) protocol specification\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
apply:
**Assisting secondary serving HS-DSCH Cell(s):** In addition to the serving
HS-DSCH cell, a cell in the secondary downlink frequency, where the UE is
configured to simultaneously monitor a HS-SCCH set and receive HS-DSCH if it
is scheduled in that cell. There can be up to two assisting secondary serving
HS-DSCH cells.
**Assisting serving HS-DSCH Cell:** In addition to the serving HS-DSCH cell, a
cell in the same frequency, where the UE is configured to simultaneously
monitor a HS-SCCH set and receive HS-DSCH if it is scheduled in that cell.
**Cell group** : A group of (one, two, or three) Multiflow mode cells that
have the same CPICH timing. The cells that belong to a cell group are
indicated by higher layers.
**DL FET:** DL FET refers to early termination of DL DPCH transmission upon
receiving an acknowledgement message. In this context, a DL FET ACK/NACK
message represents an acknowledge message sent on UL DPCCH for DL FET.
**DL_DCH_FET_Config** : Higher layers signal this configuration parameter to
indicate enhanced DCH physical layer configuration. The possible values are 0
and 1. The value 0 indicates Mode 0 configuration where DL transport channels
concatenation and DL FET ACK/NACK signalling on UL are not configured. The
value 1 indicates Mode 1 where DL transport channel concatenation and DL FET
ACK/NACK signalling on UL are configured.
**MIMO mode:** This term refers to the downlink MIMO configuration with two
transmit antennas
**MIMO mode with four transmit antennas:** This term refers to the downlink
MIMO configuration with four transmit antennas
**Multiflow mode:** The UE is configured in Multiflow mode when it is
configured with assisting serving HS-DSCH cell.
**Primary uplink frequency:** If a single uplink frequency is configured for
the UE, then it is the _primary uplink frequency_. In case more than one
uplink frequency is configured for the UE, then the primary uplink frequency
is the frequency on which the E-DCH corresponding to the serving E-DCH cell
associated with the serving HS-DSCH cell is transmitted. The association
between a pair of uplink and downlink frequencies is indicated by higher
layers.
**Secondary uplink frequency:** A _secondary uplink frequency_ is a frequency
on which an E-DCH corresponding to a serving E-DCH cell associated with a
secondary serving HS-DSCH cell is transmitted. The association between a pair
of uplink and downlink frequencies is indicated by higher layers.
**TG:** Transmission Gap is consecutive empty slots that have been obtained
with a transmission time reduction method. The transmission gap can be
contained in one or two consecutive radio frames.
**TGL:** Transmission Gap Length is the number of consecutive empty slots that
have been obtained with a transmission time reduction method. 0 ≤ _TGL_ ≤ 14.
The CFNs of the radio frames containing the first empty slot of the
transmission gaps, the CFNs of the radio frames containing the last empty
slot, the respective positions N~first~ and N~last~ within these frames of the
first and last empty slots of the transmission gaps, and the transmission gap
lengths can be calculated with the compressed mode parameters described in
[5].
**TrCH number:** The transport channel number identifies a TrCH in the context
of L1. The L3 transport channel identity (TrCH ID) maps onto the L1 transport
channel number. The mapping between the transport channel number and the TrCH
ID is as follows: TrCH 1 corresponds to the TrCH with the lowest TrCH ID, TrCH
2 corresponds to the TrCH with the next lowest TrCH ID and so on.
**UL DPCH 10ms Mode** : When configured by higher layers for the TTI to be
transmitted [16], UL DPCH follows physical channel procedures specific to this
mode. UL DPCH 10ms Mode can only happen when DL_DCH_FET_Config is configured.
**UL 20ms Compression Interval (CI):** A time interval of 20ms duration
aligned to a 20ms TTI defined for UL DPCH physical layer procedures when
DL_DCH_FET_Config is configured by higher layers.
**1^st^ secondary serving HS-DSCH cell** : If the UE is configured with two
uplink frequencies, the 1^st^ secondary serving HS-DSCH cell is the secondary
serving HS-DSCH cell that is associated with the secondary uplink frequency.
If the UE is configured with a single uplink frequency, the 1^st^ secondary
serving HS-DSCH cell is a secondary serving HS-DSCH cell whose index is
indicated by higher layers.
**2^nd^ secondary serving HS-DSCH cell** : If the UE is configured with more
than two serving HS-DSCH cells, the 2^nd^ secondary serving HS-DSCH cell is a
secondary serving HS-DSCH cell whose index is indicated by higher layers.
**3^rd^ secondary serving HS-DSCH cell** : If the UE is configured with more
than three serving HS-DSCH cells, the 3rd secondary serving HS-DSCH cell is a
secondary serving HS-DSCH cell whose index is indicated by higher layers.
**4^th^ secondary serving HS-DSCH cell** : If the UE is configured with more
than four serving HS-DSCH cells, the 4^th^ secondary serving HS-DSCH cell is a
secondary serving HS-DSCH cell whose index is indicated by higher layers.
**5^th^ secondary serving HS-DSCH cell** : If the UE is configured with more
than five serving HS-DSCH cells, the 5^th^ secondary serving HS-DSCH cell is a
secondary serving HS-DSCH cell whose index is indicated by higher layers.
**6^th^ secondary serving HS-DSCH cell** : If the UE is configured with more
than six serving HS-DSCH cells, the 6^th^ secondary serving HS-DSCH cell is a
secondary serving HS-DSCH cell whose index is indicated by higher layers.
**7^th^ secondary serving HS-DSCH cell** : If the UE is configured with eight
serving HS-DSCH cells, the 7^th^ secondary serving HS-DSCH cell is a secondary
serving HS-DSCH cell whose index is indicated by higher layers.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
_x_ round towards _∞_ , i.e. integer such that _x ≤ x \ Z._ The code blocks after segmentation are of the same
size. The number of code blocks on TrCH _i_ is denoted by _C~i~_. If the
number of bits input to the segmentation, _X~i~_ , is not a multiple of _C~i~_
, filler bits are added to the beginning of the first block. If turbo coding
is selected and _X~i~ \  _K_ Number of bits input to Turbo code internal interleaver
>
> _R_ Number of rows of rectangular matrix
>
> _C_ Number of columns of rectangular matrix
>
> _p_ Prime number
>
> _v_ Primitive root
>
> {width="0.9722222222222222in" height="0.2638888888888889in"} Base sequence
> for intra-row permutation
>
> _q~i~_ Minimum prime integers
>
> _r~i~_ Permuted prime integers
>
> {width="0.9722222222222222in" height="0.3055555555555556in"} Inter-row
> permutation pattern
>
> {width="1.0694444444444444in" height="0.3333333333333333in"} Intra-row
> permutation pattern of _i_ -th row
>
> _i_ Index of row number of rectangular matrix
>
> _j_ Index of column number of rectangular matrix
>
> _k_ Index of bit sequence
##### 4.2.3.2.3.1 Bits-input to rectangular matrix with padding {#bits-input-
to-rectangular-matrix-with-padding .H6}
The bit sequence {width="1.0416666666666667in" height="0.25in"} input to the
Turbo code internal interleaver is written into the rectangular matrix as
follows.
(1) Determine the number of rows of the rectangular matrix, _R_ , such that:
{width="2.888888888888889in" height="0.6666666666666666in"}.
The rows of rectangular matrix are numbered 0, 1, ..., _R_ \- 1 from top to
bottom.
(2) Determine the prime number to be used in the intra-permutation, _p_ , and
the number of columns of rectangular matrix, _C_ , such that:
if (481 {width="0.1388888888888889in" height="0.16666666666666666in"} _K_
{width="0.1388888888888889in" height="0.16666666666666666in"} 530) then
_p = 53_ and _C_ = _p_.
else
Find minimum prime number _p_ from table 2 such that
{width="0.875in" height="0.20833333333333334in"},
and determine _C_ such that
{width="2.3194444444444446in" height="0.6527777777777778in"}.
end if
The columns of rectangular matrix are numbered 0, 1, ..., _C_ \- 1 from left
to right.
Table 2: List of prime number _p_ and associated primitive root _v_
* * *
_p_ _v_ _p_ _v_ _p_ _v_ _p_ _v_ _p_ _v_ 7 3 47 5 101 2 157 5 223 3 11 2 53 2
103 5 163 2 227 2 13 2 59 2 107 2 167 5 229 6 17 3 61 2 109 6 173 2 233 3 19 2
67 2 113 3 179 2 239 7 23 5 71 7 127 3 181 2 241 7 29 2 73 5 131 2 191 19 251
6 31 3 79 3 137 3 193 5 257 3 37 2 83 2 139 2 197 2  
41 6 89 3 149 2 199 3  
43 3 97 5 151 6 211 2
* * *
(3) Write the input bit sequence {width="1.0416666666666667in"
height="0.25in"} into the _R_ {width="0.125in"
height="0.1388888888888889in"}_C_ rectangular matrix row by row starting with
bit _y_ ~1~ in column 0 of row 0:
{width="2.7222222222222223in" height="0.875in"}
> where _y_ ~k~ = _x_ ~k~ for _k_ = 1, 2, ..., _K_ and if _R_{width="0.125in"
> height="0.1388888888888889in"}_C_{width="0.125in" height="0.125in"}_K_ , the
> dummy bits are padded such that {width="0.6111111111111112in"
> height="0.20833333333333334in"} for _k_ = _K_ \+ 1, _K_ \+ 2, ...,
> _R_{width="0.125in" height="0.1388888888888889in"}_C_. These dummy bits are
> pruned away from the output of the rectangular matrix after intra-row and
> inter-row permutations.
##### 4.2.3.2.3.2 Intra-row and inter-row permutations {#intra-row-and-inter-
row-permutations .H6}
After the bits-input to the _R_{width="0.125in"
height="0.1388888888888889in"}_C_ rectangular matrix, the intra-row and inter-
row permutations for the _R_{width="0.125in" height="0.1388888888888889in"}_C_
rectangular matrix are performed stepwise by using the following algorithm
with steps (1) -- (6):
(1) Select a primitive root _v_ from table 2 in clause 4.2.3.2.3.1, which is
indicated on the right side of the prime number _p_.
(2) Construct the base sequence {width="0.9722222222222222in"
height="0.2638888888888889in"} for intra-row permutation as:
{width="1.4583333333333333in" height="0.20833333333333334in"}, _j_ = 1, 2,...,
(_p_ \- 2), and _s_(0) = 1.
(3) Assign _q_ ~0~ = 1 to be the first prime integer in the sequence
{width="0.8333333333333334in" height="0.2638888888888889in"}, and determine
the prime integer _q~i~_ in the sequence {width="0.8333333333333334in"
height="0.2638888888888889in"} to be a least prime integer such that
g.c.d(_q~i~_ , _p_ \- 1) = 1 _,_ _q~i~_ > 6, and _q~i~_ > _q_ ~(_i_ \ -\ 1)~
for each _i_ = 1, 2, ..., _R_ \-- 1. Here g.c.d. is greatest common divisor.
(4) Permute the sequence {width="0.8333333333333334in"
height="0.2638888888888889in"} to make the sequence
{width="0.8055555555555556in" height="0.2638888888888889in"} such that
_r~T~_ ~(_i_)~ = _q~i~_ , _i_ = 0, 1, ..., _R_ \- 1,
> where {width="0.9722222222222222in" height="0.3055555555555556in"} is the
> inter-row permutation pattern defined as the one of the four kind of
> patterns, which are shown in table 3, depending on the number of input bits
> _K_.
Table 3: Inter-row permutation patterns for Turbo code internal interleaver
+-----------------------+--------------------+-----------------------+ | Number of input bits | Number of rows _R_ | Inter-row permutation | | | | patterns | | _K_ | | | | | | \ | +-----------------------+--------------------+-----------------------+ | (40{width="0.125in" | | | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.152 | | | | 7777777777778in"}159) | | | +-----------------------+--------------------+-----------------------+ | (160{width="0.125in" | | 3, 2, 1, 0> | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.152 | | | | 7777777777778in"}200) | | | | or | | | | (481{width="0.125in" | | | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.152 | | | | 7777777777778in"}530) | | | +-----------------------+--------------------+-----------------------+ | ( | 20 | \ | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.1527 | | | | 777777777778in"}2480) | | | | or | | | | ( | | | | 3161{width="0.125in" | | | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.1527 | | | | 777777777778in"}3210) | | | +-----------------------+--------------------+-----------------------+ | _K_ = any other value | 20 | \ | +-----------------------+--------------------+-----------------------+
(5) Perform the _i_ -th (_i_ = 0, 1, ..., _R_ \- 1) intra-row permutation as:
if (_C_ = _p_) then
{width="1.6388888888888888in" height="0.20833333333333334in"}, _j_ = 0, 1,
..., (_p_ \- 2), and _U~i~_(_p_ \- 1) = 0,
where _U~i~_(_j_) is the original bit position of _j_ -th permuted bit of _i_
-th row.
end if
if (_C_ = _p_ \+ 1) then
> {width="1.6388888888888888in" height="0.20833333333333334in"}, _j_ = 0, 1,
> ..., (_p_ \- 2). _U~i~_(_p_ \- 1) = 0, and _U~i~_(_p_) = _p_ ,
>
> where _U~i~_(_j_) is the original bit position of _j_ -th permuted bit of
> _i_ -th row, and
if (_K_ = _R_{width="0.125in" height="0.1388888888888889in"}_C_) then
Exchange _U~R~_ ~-1~(_p_) with _U~R~_ ~-1~(0).
end if
end if
if (_C_ = _p_ \- 1) then
{width="1.8194444444444444in" height="0.20833333333333334in"}, _j_ = 0, 1,
..., (_p_ \- 2),
where _U~i~_(_j_) is the original bit position of _j_ -th permuted bit of _i_
-th row.
end if
(6) Perform the inter-row permutation for the rectangular matrix based on the
pattern {width="0.9722222222222222in" height="0.3055555555555556in"},
where _T_(_i_) is the original row position of the _i_ -th permuted row.
##### 4.2.3.2.3.3 Bits-output from rectangular matrix with pruning {#bits-
output-from-rectangular-matrix-with-pruning .H6}
After intra-row and inter-row permutations, the bits of the permuted
rectangular matrix are denoted by _y_ \'_~k~_ :
{width="2.3194444444444446in" height="0.875in"}
The output of the Turbo code internal interleaver is the bit sequence read out
column by column from the intra-row and inter-row permuted _R_
{width="0.125in" height="0.125in"} _C_ rectangular matrix starting with bit
_y_ \'~1~ in row 0 of column 0 and ending with bit _y_ \'_~CR~_ in row _R_ \-
1 of column _C_ \- 1. The output is pruned by deleting dummy bits that were
padded to the input of the rectangular matrix before intra-row and inter row
permutations, i.e. bits _y_ \'_~k~_ that corresponds to bits _y~k~_ with _k >
K_ are removed from the output. The bits output from Turbo code internal
interleaver are denoted by _x_ \'~1~, _x_ \'~2~, ..., _x_ \'_~K~_ , where _x_
\'~1~ corresponds to the bit _y_ \'_~k~_ with smallest index _k_ after
pruning, _x_ \'~2~ to the bit _y_ \'_~k~_ with second smallest index _k_ after
pruning, and so on. The number of bits output from Turbo code internal
interleaver is _K_ and the total number of pruned bits is:
_R_ {width="0.125in" height="0.1388888888888889in"} _C_ \-- _K_.
#### 4.2.3.3 Concatenation of encoded blocks
After the channel coding for each code block, if _C~i~_ is greater than 1, the
encoded blocks are serially concatenated so that the block with lowest index
_r_ is output first from the channel coding block, otherwise the encoded block
is output from channel coding block as it is. The bits output are denoted by
{width="1.125in" height="0.2638888888888889in"}, where _i_ is the TrCH number
and _E~i~_ =  _C~i~Y~i~_. The output bits are defined by the following
relations:
{width="0.625in" height="0.25in"} _k =_ 1, 2 _, ..., Y~i~_
{width="0.9166666666666666in" height="0.2638888888888889in"} _k = Y~i~_ _+_ 1
_, Y~i~_ _+_ 2 _, ...,_ 2 _Y~i~_
{width="0.9722222222222222in" height="0.2638888888888889in"} _k =_ 2 _Y~i~_
_+_ 1, 2 _Y~i~_ _+_ 2 _, ...,_ 3 _Y~i~_
{width="0.19375in" height="9.652777777777778e-2in"}
{width="1.2361111111111112in" height="0.2638888888888889in"} _k =_ (_C~i~_ \-
1)_Y~i~_ _+_ 1 _,_ (_C~i~_ \- 1)_Y~i~_ _+_ 2 _, ..., C~i~Y~i~_
If no code blocks are input to the channel coding (_C~i~_ = 0), no bits shall
be output from the channel coding, i.e. _E~i~_ = 0.
### 4.2.4 Radio frame size equalisation
Radio frame size equalisation is padding the input bit sequence in order to
ensure that the output can be segmented in _F~i~_ data segments of same size
as described in subclause 4.2.7. Radio frame size equalisation is only
performed in the UL.
The input bit sequence to the radio frame size equalisation is denoted
by{width="1.1527777777777777in" height="0.2638888888888889in"}, where _i_ is
TrCH number and _E~i~_ the number of bits. The output bit sequence is denoted
by{width="1.0416666666666667in" height="0.2638888888888889in"}, where _T~i~_
is the number of bits. The output bit sequence is derived as follows:
\- _t~ik~_ = _c~ik~_ ~,~ for k = 1... _E~i~_ ; and
\- _t~ik~_ = {0, 1} for k= _E~i~_ +1... _T~i~_ , if _E~i~_ \ | +-------+----------------------+---------------------------------------------+ | 10 ms | 1 | \ | +-------+----------------------+---------------------------------------------+ | 20 ms | 2 | \ | +-------+----------------------+---------------------------------------------+ | 40 ms | 4 | \ | +-------+----------------------+---------------------------------------------+ | 80 ms | 8 | \ | +-------+----------------------+---------------------------------------------+
Table 4A: Inter-column permutation patterns for 1st interleaving for uplink
when UL_DPCH_10ms_Mode is configured by higher layers
+-------+----------------------+---------------------------------------------+ | TTI | Number of columns C1 | Inter-column permutation patterns | | | | | | | | \ | +-------+----------------------+---------------------------------------------+ | 20 ms | 1 | \ | +-------+----------------------+---------------------------------------------+ | 40 ms | 2 | \ | +-------+----------------------+---------------------------------------------+ | 80 ms | 4 | \ | +-------+----------------------+---------------------------------------------+
#### 4.2.5.3 Relation between input and output of 1^st^ interleaving in uplink
The bits input to the 1^st^ interleaving are denoted by
{width="1.1527777777777777in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _T~i~_ the number of bits. Hence, x _~i,k~ = t~i,k~_ and X
_~i~_ _=_ _T~i~_.
The bits output from the 1^st^ interleaving are denoted by
{width="1.3333333333333333in" height="0.2638888888888889in"}, and d _~i,k~ =
y~i,k~_.
#### 4.2.5.4 Relation between input and output of 1^st^ interleaving in
downlink
If fixed positions of the TrCHs in a radio frame is used then the bits input
to the 1^st^ interleaving are denoted by {width="1.2083333333333333in"
height="0.2638888888888889in"}, where _i_ is the TrCH number. Hence, x _~ik~ =
h~ik~_ and X _~i~ = D~i~_.
If flexible positions of the TrCHs in a radio frame is used then the bits
input to the 1^st^ interleaving are denoted by {width="1.2361111111111112in"
height="0.2638888888888889in"}, where _i_ is the TrCH number. Hence, x _~ik~ =
g~ik~_ and X _~i~ = G~i~_.
The bits output from the 1^st^ interleaving are denoted by
{width="1.1805555555555556in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _Q~i~_ is the number of bits. Hence, _q~ik~ = y~ik~_ , _Q~i~_
= _F~i~H~i~_ if fixed positions are used, and _Q~i~_ = _G~i~_ if flexible
positions are used. _H~i~_ is defined in subclause 4.2.9.1.
### 4.2.6 Radio frame segmentation
When the transmission time interval is longer than 10 ms, the input bit
sequence is segmented and mapped onto _F~i~_ segments. Following rate matching
in the DL and radio frame size equalisation in the UL the input bit sequence
length is guaranteed to be an integer multiple of _F~i~_.
The input bit sequence is denoted by {width="1.1666666666666667in"
height="0.2638888888888889in"} where _i_ is the TrCH number and _X~i~_ is the
number bits. The _F~i~_ output bit sequences per TTI are denoted by
{width="1.6666666666666667in" height="0.2638888888888889in"}where _n~i~_ is
the segment number and _Y~i~_ is the number of bits per radio frame for TrCH
_i_. The output sequences are defined as follows:
{width="0.3333333333333333in" height="0.2638888888888889in"}=
{width="0.7083333333333334in" height="0.2638888888888889in"}, _n~i~_ =
1..._F~i~_ , _k_ = 1..._Y~i~_
where
_Y~i~_ = (_X~i~_ / _F~i~_) is the number of bits per segment.
In downlink, the _n~i~_ -th segment is mapped to the radio frame _n~i~_ -1 of
the transmission time interval.
In uplink when UL_DPCH_10ms_Mode is not configured by higher layers, the
_n~i~_ -th segment, 1 ≤ _n~i~_ ≤ _F~i~_ is mapped to radio frame _n~i~_ -1 of
the transmission time interval.
In uplink when UL_DPCH_10ms_Mode is configured by higher layers, the _n~i~_
^th^ segment, 1 ≤ _n~i~_ ≤ _F~i~_ , is mapped to theradio frame 2 _n~i\ ~_ \--
2 of the transmission time interval. No bits are input to the radio frame 2
_n~i\ ~_ \-- 1.
#### 4.2.6.1 Relation between input and output of the radio frame segmentation
block in uplink
The input bit sequence to the radio frame segmentation is denoted by
{width="1.2361111111111112in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _T~i~_ the number of bits. Hence, _x~ik~ = d~ik~_ and _X~i~ =
T~i~_.
The output bit sequence corresponding to radio frame _n~i~_ is denoted by
{width="1.125in" height="0.2638888888888889in"}, where _i_ is the TrCH number
and _N~i~_ is the number of bits. Hence, {width="0.7083333333333334in"
height="0.2638888888888889in"}and _N~i~ = Y~i~_.
#### 4.2.6.2 Relation between input and output of the radio frame segmentation
block in downlink
The bits input to the radio frame segmentation are denoted by
{width="1.1805555555555556in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _Q~i~_ the number of bits. Hence, _x~ik~ = q~ik~_ and _X~i~ =
Q~i~_.
The output bit sequence corresponding to radio frame _n~i~_ is denoted by
{width="1.25in" height="0.2638888888888889in"}, where _i_ is the TrCH number
and _V~i~_ is the number of bits. Hence, {width="0.7222222222222222in"
height="0.2638888888888889in"}and _V~i~ = Y~i~_.
### 4.2.7 Rate matching
Rate matching means that bits on a transport channel are repeated or
punctured. Higher layers assign a rate-matching attribute for each transport
channel. This attribute is semi-static and can only be changed through higher
layer signalling. The rate-matching attribute is used when the number of bits
to be repeated or punctured is calculated.
The number of bits on a transport channel can vary between different
transmission time intervals. In the downlink the transmission is interrupted
if the number of bits is lower than maximum. When the number of bits between
different transmission time intervals in uplink is changed, bits are repeated
or punctured to ensure that the total bit rate after TrCH multiplexing is
identical to the total channel bit rate of the allocated dedicated physical
channels.
If no bits are input to the rate matching for all TrCHs within a CCTrCH, the
rate matching shall output no bits for all TrCHs within the CCTrCH and no
uplink DPDCH will be selected in the case of uplink rate matching.
**Notation used in subclause 4.2.7 and subclauses:**
_N~i,j~:_ For uplink: Number of bits in a radio frame before rate matching on
TrCH _i_ with transport format combination _j_ . When UL_DPCH_10ms Mode is
configured by higher layers, the derivation of _N~i,j~_ is described in detail
in subclauses 4.2.6 and 4.2.6.1.
For downlink: An intermediate calculation variable (not an integer but a
multiple of 1/8).
{width="0.31875in" height="0.2569444444444444in"}_:_ Number of bits in a
transmission time interval before rate matching on TrCH _i_ with transport
format _l_. Used in downlink only.
{width="0.3576388888888889in" height="0.24375in"}_:_ For uplink: If positive -
number of bits that should be repeated in each radio frame on TrCH _i_ with
transport format combination _j_.
If negative - number of bits that should be punctured in each radio frame on
TrCH _i_ with transport format combination _j_.
For downlink : An intermediate calculation variable (not an integer but a
multiple of 1/8).
{width="0.4076388888888889in" height="0.2569444444444444in"}_:_ If positive -
number of bits to be repeated in each transmission time interval on TrCH _i_
with transport format _l_.
If negative - number of bits to be punctured in each transmission time
interval on TrCH _i_ with transport format _l_.
Used in downlink only.
_N~TGL~_ : Positive or null: number of bits in the radio frame corresponding
to the gap for compressed mode for the CCTrCH.
_RM~i~:_ Semi-static rate matching attribute for transport channel _i_.
_RM~i~_ is provided by higher layers or takes a value as indicated in
subclause 4.2.13 or subclause 4.2.0.
_PL:_ Puncturing limit for uplink. This value limits the amount of puncturing
that can be applied in order to avoid multicode or to enable the use of a
higher spreading factor. Signalled from higher layers. The allowed puncturing
in % is actually equal to (1-PL)*100.
_N~data,j~:_ Total number of bits that are available for the CCTrCH in a radio
frame with transport format combination _j_.
_I:_ Number of TrCHs in the CCTrCH.
_Z~i,j~:_ Intermediate calculation variable.
_F~i~:_ Number of radio frames in the transmission time interval of TrCH _i,_
except for uplink when UL_DPCH_10ms_Mode is configured. In uplink, when
UL_DPCH_10ms_Mode is configured, _F~i~ is the number of radio frames in the
transmission time interval of TrCH i divided by 2_.
_n~i~:_ Radio frame number in the transmission time interval of TrCH _i_. In
downlink, and in uplink when UL_DPCH_10ms_Mode is not configured by higher
layers, _0 ≤ n~i~ \  15 | | | | | | {width="1.1256944444444446in" | | | height="0.2638888888888889in"}, | | | in second frame if _N~first~ + | | | TGL_ > 15 | +----------------------------------+----------------------------------+
_N~first~_ and _TGL_ are defined in subclause 4.4.
In a radio frame compressed by spreading factor reduction,
{width="1.8055555555555556in" height="0.2777777777777778in"}, where
{width="1.625in" height="0.4305555555555556in"}
If _∆N~i,j~_ = 0 then the output data of the rate matching is the same as the
input data and the rate matching algorithm of subclause 4.2.7.5 does not need
to be executed.
If _∆N~i,j~_ ≠ 0 the parameters listed in subclauses 4.2.7.1.2.1 and
4.2.7.1.2.2 shall be used for determining _e~ini~_ , _e~plus~_ , and
_e~minus~_ (regardless if the radio frame is compressed or not).
##### 4.2.7.1.2.1 Convolutionally encoded TrCHs {#convolutionally-encoded-
trchs .H6}
_R_ = ∆ _N~i~_ ~,_j_ ~ mod _N~i~_ ~,_j_ ~ -- note: in this context ∆ _N~i~_
~,_j_ ~ mod _N~i~_ ~,_j_ ~ is in the range of 0 to _N~ij~_ -1 i.e. -1 mod 10 =
9.
if _R_ ≠ 0 and 2× _R_ ≤ _N~ij~_
then q =  _N~i,j~_ / _R_ 
else
q =  _N~i~_ ~,_j_ ~ / (_R_ \- _N~i~_ ~,_j_ ~) 
endif
\-- note: q is a signed quantity.
if q is even
then q\' = q + gcd(q, _F~i~_)/ _F~i~_ \-- where gcd (q, _F~i~_) means
greatest common divisor of q and _F~i~_
\-- note that q\' is not an integer, but a multiple of 1/8
else
q\' = q
endif
for _x_ = 0 to _F~i~_ \- 1
S[  _x_ ×q\'  mod _F~i~_] = (  _x_ ×q\'  div _F~i~_)
end for
∆ _N~i~_ = ∆ _N~i~_ ~,_j_ ~
a = 2
For each radio frame, the rate-matching pattern is calculated with the
algorithm in subclause 4.2.7.5, where :
_X~i~_ = _N~i~_ ~,_j_ ~., and
_e~ini~_ = (a×S[P1 _~Fi~_(_n~i~_)]×\|∆ _N~i~_ \| + 1) mod (a⋅ _N~ij~_).
_e_ ~plus~ = a× _N~i~_ ~,_j_ ~
_e_ ~minus~ = a×\|∆ _N~i~_ \|
puncturing for ∆ _N_ \_0,
the parameters in subclause 4.2.7.1.2.1 are used.
If puncturing is to be performed, the parameters below shall be used. Index
_b_ is used to indicate systematic (_b_ =1), 1^st^ parity (_b_ =2), and 2^nd^
parity bit (_b_ =3).
_a=2_ when _b_ =2
_a=1_ when _b_ =3
{width="1.7222222222222223in" height="0.5277777777777778in"}
If {width="0.2916666666666667in" height="0.2222222222222222in"} is calculated
as 0 for _b_ =2 or _b_ =3, then the following procedure and the rate matching
algorithm of subclause 4.2.7.5 don\'t need to be performed for the
corresponding parity bit stream.
X~i~ = N~i,j~ /3 ,
q = X~i~ /\|∆N~i~\| 
if(q{width="0.1388888888888889in" height="0.16666666666666666in"}2)
for _r=_ 0 to _F~i~_ -1
S[(3× _r_ +b-1) mod _F~I~_] = _r_ mod 2;
end for
else
if _q_ is even
then q\' = q -- _gcd(_ q _,_ _F~i~)_ / _F~i~_ \-- where _gcd (_ q _, F~i~)_
means greatest common divisor of q and _F~i~_ \ \-- note that q\' is not an
integer, but a multiple of 1/8
else q\' = q
endif
for _x_ =0 to _F~i~_ -1
r =  _x_ ×q\' mod _F~i~_ ;
S[(3×r+b-1) mod _F~i~_] =  _x_ ×q\' div _F~i~_ ;
endfor
endif
For each radio frame, the rate-matching pattern is calculated with the
algorithm in subclause 4.2.7.5, where:
_X~i~_ is as above:
e~ini~ = (a×S[P1 _~Fi~_(_n~i~_)] ×\|∆N~i~\| + X~i~) mod (a× _X~i~_), if e~ini~
=0 then _e~ini~_ = a× _X~i~_
e~plus~ = a× _X~i~_
e~minus~ = a×∆ _N~i~_ 
#### 4.2.7.2 Determination of rate matching parameters in downlink
For downlink channels, _N~data,j~_ does not depend on the transport format
combination _j_. _N~data,*~_ is given by the channelization code(s) assigned
by higher layers.
Denote the number of physical channels used for the CCTrCH by _P_. _N~data,*~_
is the number of bits available to the CCTrCH in one radio frame and defined
as _N~data,*~_ =_P_ ×15×(_N~data~_ ~1~+_N~data~_ ~2~), where _N~data1~_ and
_N~data2~_ are defined in [2]. Note that contrary to the uplink, the same rate
matching patterns are used in TTIs containing no compressed radio frames and
in TTIs containing radio frames compressed by spreading factor reduction or
higher layer scheduling.
##### 4.2.7.2.1 Determination of rate matching parameters for fixed positions
of TrCHs
##### 4.2.7.2.1.1 Calculation of ∆ _N~i~_ ~,max~ for normal mode and
compressed mode by spreading factor reduction {#calculation-of-nimax-for-
normal-mode-and-compressed-mode-by-spreading-factor-reduction .H6}
First an intermediate calculation variable {width="0.2916666666666667in"
height="0.2638888888888889in"} is calculated for all transport channels _i_ by
the following formula:
{width="1.5145833333333334in" height="0.4263888888888889in"}
In order to compute the {width="0.44375in" height="0.2777777777777778in"}
parameters for all TrCH _i_ and all TF _l_ , we first compute an intermediate
parameter ∆ _N~i,~_ ~max~ by the following formula, where {width="0.375in"
height="0.2638888888888889in"} is derived from {width="0.2916666666666667in"
height="0.2638888888888889in"} by the formula given at subclause 4.2.7:
{width="1.3055555555555556in" height="0.2638888888888889in"}
If {width="0.7777777777777778in" height="0.2638888888888889in"} then, for TrCH
_i_ , the output data of the rate matching is the same as the input data and
the rate matching algorithm of subclause 4.2.7.5 does not need to be executed.
In this case we have :
{width="1.5in" height="0.2777777777777778in"}
If {width="0.7777777777777778in" height="0.2638888888888889in"} the parameters
listed in subclauses 4.2.7.2.1.3 and 4.2.7.2.1.4 shall be used for determining
_e~ini~_ , _e~plus~_ , and _e~minus~,_ and {width="0.44375in"
height="0.2777777777777778in"}.
##### 4.2.7.2.1.2 Void {#void-1 .H6}
##### 4.2.7.2.1.3 Determination of rate matching parameters for
convolutionally encoded TrCHs {#determination-of-rate-matching-parameters-for-
convolutionally-encoded-trchs .H6}
{width="0.94375in" height="0.2638888888888889in"}
_a_ =2
{width="1.2222222222222223in" height="0.3333333333333333in"}
For each transmission time interval of TrCH _i_ with TF _l_ , the rate-
matching pattern is calculated with the algorithm in subclause 4.2.7.5. The
following parameters are used as input:
{width="0.7083333333333334in" height="0.2638888888888889in"}
{width="0.3888888888888889in" height="0.25in"}1
{width="1.0138888888888888in" height="0.2638888888888889in"}
{width="1.1111111111111112in" height="0.2777777777777778in"}
Puncturing if {width="0.5694444444444444in" height="0.25in"}, repetition
otherwise. The values of {width="0.44375in" height="0.2777777777777778in"}may
be computed by counting repetitions or puncturing when the algorithm of
subclause 4.2.7.5 is run. The resulting values of {width="0.44375in"
height="0.2777777777777778in"} can be represented with following expression.
{width="2.19375in" height="0.5277777777777778in"}
##### 4.2.7.2.1.4 Determination of rate matching parameters for Turbo encoded
TrCHs {#determination-of-rate-matching-parameters-for-turbo-encoded-trchs .H6}
If repetition is to be performed on turbo encoded TrCHs,
i.e.{width="0.7777777777777778in" height="0.2638888888888889in"}, the
parameters in subclause 4.2.7.2.1.3 are used.
If puncturing is to be performed, the parameters below shall be used. Index
_b_ is used to indicate systematic (_b_ =1), 1^st^ parity (_b_ =2), and 2^nd^
parity bit (_b_ =3).
_a=2_ when _b=_ 2
_a=1_ when _b=_ 3
The bits indicated by _b_ =1 shall not be punctured.
{width="2.0965277777777778in" height="0.5277777777777778in"}
{width="1.5277777777777777in" height="0.3333333333333333in"}
For each transmission time interval of TrCH _i_ with TF _l_ , the rate-
matching pattern is calculated with the algorithm in subcaluse 4.2.7.5. The
following parameters are used as input:
{width="0.8888888888888888in" height="0.2638888888888889in"}
{width="0.7083333333333334in" height="0.25in"}
{width="1.0138888888888888in" height="0.2638888888888889in"}
{width="1.1527777777777777in" height="0.3055555555555556in"}
The values of {width="0.44375in" height="0.2777777777777778in"}may be computed
by counting puncturing when the algorithm of subclause 4.2.7.5 is run. The
resulting values of {width="0.44375in" height="0.2777777777777778in"} can be
represented with following expression.
{width="3.138888888888889in" height="0.6388888888888888in"}
In the above equation, the first term of the right hand side represents the
amount of puncturing for _b_ =2 and the second term represents the amount of
puncturing for _b_ =3.
##### 4.2.7.2.1A Determination of rate matching parameters for pseudo-flexible
positions of TrCHs
Pseudo-flexible rate matching is identical to fixed-position rate matching,
with a difference that in psueduo-flexible rate matching, rate matching
parameters are re-evaluated for each maximum TTI, and the value of _RM~i~_ is
set to 0 in Equation (1) of subclause 4.2.7 if _M~i\ ~_ =0 (i.e., no transport
blocks are sent in the TTI) for each transport channel _i_ with the maximum
TTI value among all the transport channels multiplexed into the CCTrCH.
When there is a configuration with more than one transport channel having the
maximum TTI and more than one of those transport channels having a transport
format with no transport blocks multiplexed into a CCTrCH, the UE behaviour is
unspecified.
As a consequence of re-evaluating rate-matching parameters per maximum TTI in
pseudo-flexible rate matching, derived parameters dependent on rate matching,
for example the parameters corresponding to DTX indication bits in Section
4.2.9.1, can change from one maximum TTI to another in pseudo-flexible rate
matching, unlike in fixed position rate matching.
##### 4.2.7.2.2 Determination of rate matching parameters for flexible
positions of TrCHs
##### 4.2.7.2.2.1 Calculations for normal mode, compressed mode by higher
layer scheduling, and compressed mode by spreading factor reduction
{#calculations-for-normal-mode-compressed-mode-by-higher-layer-scheduling-and-
compressed-mode-by-spreading-factor-reduction .H6}
First an intermediate calculation variable {width="0.2361111111111111in"
height="0.2638888888888889in"} is calculated for all transport channels _i_
and all transport format combinations _j_ by the following formula:
{width="1.2861111111111112in" height="0.4722222222222222in"}
Then rate matching ratios _RF~i~_ are calculated for each the transport
channel _i_ in order to minimise the number of DTX bits when the bit rate of
the CCTrCH is maximum. The _RF~i~_ ratios are defined by the following
formula:
{width="2.1131944444444444in" height="0.6472222222222223in"}
The computation of {width="0.44375in" height="0.2777777777777778in"}
parameters is then performed in two phases. In a first phase, tentative
temporary values of {width="0.44375in" height="0.2777777777777778in"} are
computed, and in the second phase they are checked and corrected. The first
phase, by use of the _RF~i~_ ratios, ensures that the number of DTX indication
bits inserted is minimum when the CCTrCH bit rate is maximum, but it does not
ensure that the maximum CCTrCH bit rate is not greater than _N~data,*~_. per
10ms. The latter condition is ensured through the checking and possible
corrections carried out in the second phase.
At the end of the second phase, the latest value of {width="0.44375in"
height="0.2777777777777778in"}is the definitive value.
The first phase defines the tentative temporary {width="0.44375in"
height="0.2777777777777778in"} for all transport channel _i_ and any of its
transport format _l_ by use of the following formula:
{width="4.163888888888889in" height="0.7076388888888889in"}
The second phase is defined by the following algorithm:
for all {width="0.1388888888888889in" height="0.20833333333333334in"} in
_TFCS_ in ascending order of TFCI do \-- for all TFC
{width="1.7916666666666667in" height="0.5138888888888888in"} -- CCTrCH bit
rate (bits per 10ms) for TFC _j_
if {width="0.7361111111111112in" height="0.2638888888888889in"} then
for _i_ = 1 to _I_ do -- for all TrCH
{width="1.0965277777777778in" height="0.2638888888888889in"} --
{width="0.3888888888888889in" height="0.2638888888888889in"} is derived from
{width="0.2916666666666667in" height="0.2638888888888889in"} by the formula
given at subclause 4.2.7.
if {width="1.0277777777777777in" height="0.2777777777777778in"}then
{width="1.0277777777777777in" height="0.2777777777777778in"}
end-if
end-for
end-if
end-for
If {width="0.7083333333333334in" height="0.2777777777777778in"} then, for TrCH
_i_ at TF _l_ , the output data of the rate matching is the same as the input
data and the rate matching algorithm of subclause 4.2.7.5 does not need to be
executed.
If {width="0.7222222222222222in" height="0.2777777777777778in"} the parameters
listed in subclauses 4.2.7.2.2.2 and 4.2.7.2.2.3 shall be used for determining
_e~ini~_ , _e~plus~_ , and _e~minus~_.
##### 4.2.7.2.2.2 Determination of rate matching parameters for
convolutionally encoded TrCHs {#determination-of-rate-matching-parameters-for-
convolutionally-encoded-trchs-1 .H6}
{width="0.8888888888888888in" height="0.2638888888888889in"}
_a=2_
For each transmission time interval of TrCH _i_ with TF _l_ , the rate-
matching pattern is calculated with the algorithm in subclause 4.2.7.5. The
following parameters are used as input:
{width="0.7083333333333334in" height="0.2638888888888889in"}
{width="0.3888888888888889in" height="0.25in"}1
{width="1.0416666666666667in" height="0.2777777777777778in"}
{width="1.1388888888888888in" height="0.2777777777777778in"}
puncturing for {width="0.5694444444444444in" height="0.25in"}, repetition
otherwise.
##### 4.2.7.2.2.3 Determination of rate matching parameters for Turbo encoded
TrCHs {#determination-of-rate-matching-parameters-for-turbo-encoded-trchs-1
.H6}
If repetition is to be performed on turbo encoded TrCHs, i.e.
{width="0.7083333333333334in" height="0.2638888888888889in"}, the parameters
in subclause 4.2.7.2.2.2 are used.
If puncturing is to be performed, the parameters below shall be used. Index
_b_ is used to indicate systematic (_b_ =1), 1^st^ parity (_b_ =2), and 2^nd^
parity bit (_b_ =3).
_a=2_ when _b_ =2
_a=1_ when _b=_ 3
The bits indicated by _b_ =1 shall not be punctured.
{width="1.7638888888888888in" height="0.5277777777777778in"}
For each transmission time interval of TrCH _i_ with TF _l_ , the rate-
matching pattern is calculated with the algorithm in subclause 4.2.7.5. The
following parameters are used as input:
{width="0.8888888888888888in" height="0.2638888888888889in"},
{width="0.5833333333333334in" height="0.25in"},
{width="0.9027777777777778in" height="0.2638888888888889in"}
{width="1.1388888888888888in" height="0.2777777777777778in"}
#### 4.2.7.3 Bit separation and collection in uplink
The systematic bits of turbo encoded TrCHs shall not be punctured, the other
bits may be punctured. The systematic bits, first parity bits, and second
parity bits in the bit sequence input to the rate matching block are therefore
separated into three sequences.
The first sequence contains:
\- All of the systematic bits that are from turbo encoded TrCHs.
\- From 0 to 2 first and/or second parity bits that are from turbo encoded
TrCHs. These bits come into the first sequence when the total number of bits
in a block after radio frame segmentation is not a multiple of three.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The second sequence contains:
\- All of the first parity bits that are from turbo encoded TrCHs, except
those that go into the first sequence when the total number of bits is not a
multiple of three.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The third sequence contains:
\- All of the second parity bits that are from turbo encoded TrCHs, except
those that go into the first sequence when the total number of bits is not a
multiple of three.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The second and third sequences shall be of equal length, whereas the first
sequence can contain from 0 to 2 more bits. Puncturing is applied only to the
second and third sequences.The bit separation function is transparent for
convolutionally encoded TrCHs and for turbo encoded TrCHs with repetition. The
bit separation and bit collection are illustrated in figures 5 and 6.
{width="6.125694444444444in" height="3.225in"}
Figure 5: Puncturing of turbo encoded TrCHs in uplink
{width="6.690277777777778in" height="3.1909722222222223in"}
Figure 6: Rate matching for convolutionally encoded TrCHs\ and for turbo
encoded TrCHs with repetition in uplink
The bit separation is dependent on the 1^st^ interleaving and offsets are used
to define the separation for different TTIs. _b_ indicates the three sequences
defined in this section, with _b_ =1 indicating the first sequence, _b_ = 2
the second one, and _b_ = 3 the third one. The offsets _α~b~_ for these
sequences are listed in table 5.
Table 5: TTI dependent offset needed for bit separation
* * *
TTI (ms) _α_ ~1~ _α_ ~2~ _α_ ~3~ 10, 40 0 1 2 20, 80 0 2 1
* * *
The bit separation is different for different radio frames in the TTI. A
second offset is therefore needed. The radio frame number for TrCH _i_ is
denoted by _n~i~_. and the offset by {width="0.25in"
height="0.2638888888888889in"}.
Table 6: Radio frame dependent offset needed for bit separation
* * *
TTI (ms) _β_ ~0~ _β_ ~1~ _β_ ~2~ _β_ ~3~ _β_ ~4~ _β_ ~5~ _β_ ~6~ _β_ ~7~ 10 0
NA NA NA NA NA NA NA 20 0 1 NA NA NA NA NA NA 40 0 1 2 0 NA NA NA NA 80 0 1 2
0 1 2 0 1
* * *
##### 4.2.7.3.1 Bit separation
The bits input to the rate matching are denoted
by{width="1.1527777777777777in" height="0.2638888888888889in"}, where _i_ is
the TrCH number and _N~i~_ is the number of bits input to the rate matching
block. Note that the transport format combination number _j_ for simplicity
has been left out in the bit numbering, i.e. _N~i~_ =_N~ij~_. The bits after
separation are denoted by{width="1.3888888888888888in"
height="0.2638888888888889in"}. For turbo encoded TrCHs with puncturing, _b_
indicates the three sequences defined in clause 4.2.7.3, with _b_ =1
indicating the first sequence, and so forth. For all other cases _b_ is
defined to be 1. _X~i~_ is the number of bits in each separated bit sequence.
The relation between _e~ik~_ and _x~bik~_ is given below.
For turbo encoded TrCHs with puncturing:
{width="1.6805555555555556in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _X~i~ X~i~ =_  _N~i~_ /3
{width="1.44375in" height="0.2638888888888889in"} _k_ = 1, ..., _N~i~_ mod 3
Note: When (_N~i~_ mod 3) = 0 this row is not needed.
{width="1.7222222222222223in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~_ =  _N~i~_ /3
{width="1.7083333333333333in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~_ =  _N~i~_ /3
For convolutionally encoded TrCHs and turbo encoded TrCHs with repetition:
{width="0.6805555555555556in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~ = N~i~_
##### 4.2.7.3.2 Bit collection
The bits _x~bik~_ are input to the rate matching algorithm described in
subclause 4.2.7.5. The bits output from the rate matching algorithm are
denoted{width="1.4027777777777777in" height="0.2638888888888889in"}.
Bit collection is the inverse function of the separation. The bits after
collection are denoted by {width="1.3465277777777778in"
height="0.2638888888888889in"}_._ After bit collection, the bits indicated as
punctured are removed and the bits are then denoted
by{width="1.2222222222222223in" height="0.2638888888888889in"}, where _i_ is
the TrCH number and _V~i~_ = _N~ij~_ +_∆N~ij~_. The relations between _y~bik~_
, _z~bik~_ , and _f~ik~_ are given below.
For turbo encoded TrCHs with puncturing (_Y~i~=X~i~_):
{width="1.7083333333333333in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _Y~i~_
{width="1.4583333333333333in" height="0.2638888888888889in"} _k_ = 1, ...,
_N~i~_ mod 3 Note: When (_N~i~_ mod 3) = 0 this row is not needed.
{width="1.7361111111111112in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _Y~i~_
{width="1.75in" height="0.2916666666666667in"} _k_ = 1, 2, 3, ..., _Y~i~_
After the bit collection, bits _z~i,k~_ with value _δ_ , where
_δ[∉]{.underline}_{0, 1}, are removed from the bit sequence. Bit _f~i,~_ ~1~
corresponds to the bit _z~i,k~_ with smallest index _k_ after puncturing, bit
_f~i,~_ ~2~ corresponds to the bit _z~i,k~_ with second smallest index _k_
after puncturing, and so on.
For convolutionally encoded TrCHs and turbo encoded TrCHs with repetition:
{width="0.7083333333333334in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _Y~i~_
When repetition is used, _f~i,k~_ =_z~i,k~_ and _Y~i~_ =_V~i~_.
When puncturing is used, _Y~i~_ =_X~i~_ and bits _z~i,k~_ with value _δ_ ,
where _δ∉_{0, 1}, are removed from the bit sequence. Bit _f~i,~_ ~1~
corresponds to the bit _z~i,k~_ with smallest index _k_ after puncturing, bit
_f~i,~_ ~2~ corresponds to the bit _z~i,k~_ with second smallest index _k_
after puncturing, and so on.
#### 4.2.7.4 Bit separation and collection in downlink
The systematic bits of turbo encoded TrCHs shall not be punctured, the other
bits may be punctured.
The systematic bits, first parity bits and second parity bits in the bit
sequence input to the rate matching block are therefore separated into three
sequences of equal lengths.
The first sequence contains :
\- All of the systematic bits that are from turbo encoded TrCHs.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The second sequence contains:
\- All of the first parity bits that are from turbo encoded TrCHs.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The third sequence contains:
\- All of the second parity bits that are from turbo encoded TrCHs.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
Puncturing is applied only to the second and third sequences.
The bit separation function is transparent for convolutionally encoded TrCHs
and for turbo encoded TrCHs with repetition. The bit separation and bit
collection are illustrated in figures 7 and 8.
{width="6.125694444444444in" height="2.6125in"}
Figure 7: Puncturing of turbo encoded TrCHs in downlink
{width="6.690277777777778in" height="2.5770833333333334in"}
Figure 8: Rate matching for convolutionally encoded TrCHs\ and for turbo
encoded TrCHs with repetition in downlink
##### 4.2.7.4.1 Bit separation
The bits input to the rate matching are denoted
by{width="1.1527777777777777in" height="0.2638888888888889in"}, where _i_ is
the TrCH number and _E~i~_ is the number of bits input to the rate matching
block. Note that _E~i~_ is a multiple of 3 for turbo encoded TrCHs and that
the transport format _l_ for simplicity has been left out in the bit
numbering, i.e. _E~i~_ ={width="0.34652777777777777in"
height="0.2638888888888889in"}. The bits after separation are denoted
by{width="1.3888888888888888in" height="0.2638888888888889in"}. For turbo
encoded TrCHs with puncturing, _b_ indicates the three sequences defined in
clause 4.2.7.4, with b=1 indicating the first sequence, and so forth. For all
other cases _b_ is defined to be 1. _X~i~_ is the number of bits in each
separated bit sequence. The relation between _c~ik~_ and _x~bik~_ is given
below.
For turbo encoded TrCHs with puncturing:
{width="1.0in" height="0.2638888888888889in"} _k_ = 1, 2, 3, ..., _X~i~ X~i~ =
E~i~_ /3
{width="1.0416666666666667in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~_ = _E~i~_ /3
{width="1.0277777777777777in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~_ = _E~i~_ /3
For convolutionally encoded TrCHs and turbo encoded TrCHs with repetition:
{width="0.69375in" height="0.2638888888888889in"} _k_ = 1, 2, 3, ..., _X~i~_
_X~i~ = E~i~_
##### 4.2.7.4.2 Bit collection
The bits _x~bik~_ are input to the rate matching algorithm described in
subclause 4.2.7.5. The bits output from the rate matching algorithm are
denoted{width="1.4027777777777777in" height="0.2638888888888889in"}.
Bit collection is the inverse function of the separation. The bits after
collection are denoted by {width="1.3465277777777778in"
height="0.2638888888888889in"}_._ After bit collection, the bits indicated as
punctured are removed and the bits are then denoted
by{width="1.2777777777777777in" height="0.2638888888888889in"}, where _i_ is
the TrCH number and _G~i~_ = {width="0.34652777777777777in"
height="0.2638888888888889in"}+{width="0.44375in"
height="0.2638888888888889in"}. The relations between _y~bik~_ , _z~bik~_ ,
and _g~ik~_ are given below.
For turbo encoded TrCHs with puncturing (_Y~i~=X~i~_):
{width="1.0277777777777777in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _Y~i~_
{width="1.0555555555555556in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _Y~i~_
{width="1.0416666666666667in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _Y~i~_
After the bit collection, bits _z~i,k~_ with value _δ_ , where _δ∉_{0, 1}, are
removed from the bit sequence. Bit _g~i,~_ ~1~ corresponds to the bit _z~i,k~_
with smallest index _k_ after puncturing, bit _g~i,~_ ~2~ corresponds to the
bit _z~i,k~_ with second smallest index _k_ after puncturing, and so on.
For convolutionally encoded TrCHs and turbo encoded TrCHs with repetition:
{width="0.7083333333333334in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _Y~i~_
When repetition is used, _g~i,k~_ =_z~i,k~_ and _Y~i~_ =_G~i~_.
When puncturing is used, _Y~i~_ =_X~i~_ and bits _z~i,k~_ with value _δ_ ,
where _δ∉_{0, 1}, are removed from the bit sequence. Bit _g~i,~_ ~1~
corresponds to the bit _z~i,k~_ with smallest index _k_ after puncturing, bit
_g~i,~_ ~2~ corresponds to the bit _z~i,k~_ with second smallest index _k_
after puncturing, and so on.
#### 4.2.7.5 Rate matching pattern determination
Denote the bits before rate matching by:
{width="1.2083333333333333in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and the sequence is defined in 4.2.7.3 for uplink or in 4.2.7.4
for downlink. Parameters _X~i~_ , e~ini~, e~plus~, and e~minus~ are given in
4.2.7.1 for uplink or in 4.2.7.2 for downlink.
The rate matching rule is as follows:
if puncturing is to be performed
e = e~ini~ -- initial error between current and desired puncturing ratio
m = 1 -- index of current bit
do while m \ 15 | | | | | | {width="1.7715277777777778in" | | | height="0.4583333333333333in"}, | | | in second frame if _N~first~ + | | | TGL_ > 15 | +----------------------------------+----------------------------------+
_N~first~_ and _TGL_ are defined in subclause 4.4.
The bits output from the DTX insertion block are denoted by
{width="1.3194444444444444in" height="0.2638888888888889in"}. Note that these
bits are three valued. They are defined by the following relations:
{width="0.5138888888888888in" height="0.25in"} k = 1, 2, 3, ..., S
{width="0.5in" height="0.25in"} k = S+1, S+2, S+3, ..., _P⋅R_
where DTX indication bits are denoted by _δ_. Here _s_ ~k~ ∈{0,1, p}and _δ_
∉{0,1}.
### 4.2.10 Physical channel segmentation
When more than one PhCH is used, physical channel segmentation divides the
bits among the different PhCHs. The bits input to the physical channel
segmentation are denoted by {width="1.0555555555555556in" height="0.25in"},
where _X_ is the number of bits input to the physical channel segmentation
block. The number of PhCHs is denoted by _P._
The bits after physical channel segmentation are denoted
{width="1.3194444444444444in" height="0.2361111111111111in"}, where _p_ is
PhCH number and _U_ is the number of bits in one radio frame for each PhCH,
i.e. {width="0.4583333333333333in" height="0.4305555555555556in"}. The
relation between _x~k~_ and _u~p,k~_ is given below.
For all modes, some bits of the input flow are mapped to each code until the
number of bits on the code is _U_. All bits of the input flow are taken to be
mapped to the codes.
Bits on first PhCH after physical channel segmentation:
_u~1,\ k~ = x~k~ k =_ 1, 2 , ..., _U_
Bits on second PhCH after physical channel segmentation:
_u~2,\ k~ = x~k+U\ ~_ _k =_ 1, 2 , ..., _U_
...
Bits on the _P^th^_ PhCH after physical channel segmentation:
_u~P,k~ = x ~k+(P-1)~_ ~× _U_ ~ _k =_ 1, 2 , ..., _U_
#### 4.2.10.1 Relation between input and output of the physical segmentation
block in uplink
The bits input to the physical segmentation are denoted by {width="0.94375in"
height="0.25in"}. Hence, _x~k~ = s~k~_ and _Y = S_.
#### 4.2.10.2 Relation between input and output of the physical segmentation
block in downlink
The bits input to the physical segmentation are denoted by
{width="1.2638888888888888in" height="0.2638888888888889in"}. Hence, _x~k~ =
w~k~_ and _Y = PU_.
### 4.2.11 2^nd^ interleaving
The 2^nd^ interleaving is a block interleaver and consists of bits input to a
matrix with padding, the inter-column permutation for the matrix and bits
output from the matrix with pruning. The bits input to the block interleaver
are denoted by {width="1.44375in" height="0.2638888888888889in"}, where _p_ is
PhCH number and _U_ is the number of bits in one radio frame for one PhCH. The
output bit sequence from the block interleaver is derived as follows:
(1) Assign C2 _=_ 30 to be the number of columns of the matrix. The columns of
the matrix are numbered 0, 1, 2, ..., C2 _-_ 1 from left to right.
(2) Determine the number of rows of the matrix, R2, by finding minimum integer
R2 such that:
_U ≤_ R2 × C2 _._
The rows of rectangular matrix are numbered 0, 1, 2, ..., R2 - 1 from top to
bottom.
(3) Write the input bit sequence {width="1.3194444444444444in"
height="0.2361111111111111in"} into the R2 {width="0.125in"
height="0.1388888888888889in"} C2 matrix row by row starting with bit
{width="0.2638888888888889in" height="0.2361111111111111in"} in column 0 of
row 0:
{width="3.9305555555555554in" height="1.0277777777777777in"}
> where {width="0.7361111111111112in" height="0.2638888888888889in"} for _k_ =
> 1, 2, ..., _U_ and if R2 × C2 > _U_ , the dummy bits are padded such that
> {width="0.2916666666666667in" height="0.2638888888888889in"} = 0 or 1 for
> _k_ = _U_ \+ 1, _U_ \+ 2, ..., R2 × C2. These dummy bits are pruned away
> from the output of the matrix after the inter-column permutation.
(4) Perform the inter-column permutation for the matrix based on the pattern
{width="1.2083333333333333in" height="0.3055555555555556in"} that is shown in
table 7, where P2(_j_) is the original column position of the _j_ -th permuted
column. After permutation of the columns, the bits are denoted by
{width="0.3055555555555556in" height="0.2361111111111111in"}.
{width="3.236111111111111in" height="1.0277777777777777in"}
(5) The output of the block interleaver is the bit sequence read out column by
column from the inter-column permuted R2 {width="0.125in"
height="0.1388888888888889in"} C2 matrix. The output is pruned by deleting
dummy bits that were padded to the input of the matrix before the inter-column
permutation, i.e. bits {width="0.3055555555555556in"
height="0.2361111111111111in"} that corresponds to bits
{width="0.2777777777777778in" height="0.2361111111111111in"} with _k >U_ are
removed from the output. The bits after 2^nd^ interleaving are denoted by
{width="1.0965277777777778in" height="0.2638888888888889in"}, where _v~p,~_
~1~ corresponds to the bit {width="0.3055555555555556in"
height="0.2361111111111111in"} with smallest index _k_ after pruning, _v~p,~_
~2~ to the bit {width="0.3055555555555556in" height="0.2361111111111111in"}
with second smallest index _k_ after pruning, and so on.
Table 7 Inter-column permutation pattern for 2nd interleaving
+----------------------+----------------------------------------------+ | Number of columns C2 | Inter-column permutation pattern | | | | | | \ | +----------------------+----------------------------------------------+ | 30 | \ | +----------------------+----------------------------------------------+
#### 4.2.11.1 2^nd^ interleaving for Secondary CCPCH with 16QAM
For MBSFN transmissions with 16QAM, the 2^nd^ interleaving for Secondary CCPCH
is done as illustrated in figure 8a below. The basic block interleaver is as
described in Clause 4.2.11. For 16QAM modulated bits, there are two identical
basic block interleavers of size R2×30, where R2 is the minimum integer
fulfilling
$\left\lceil \frac{U}{2} \right\rceil \leq R2 \times \text{30}$,
The output bits from the physical channel segmentation are divided two by two
between the interleavers: bits _u~p,k~_ and u~p,k+1~ go to the first
interleaver and bits _u~p,k+2~_ and _u~p,k+3~_ go to the second interleaver.
Bits are collected two by two from the interleavers: bits _v~p,k~_ and
_v~p,k+1~_ are obtained from the first interleaver and bits _v~p,k+2~_ and
_v~p,k+3~_ are obtained from the second interleaver, where k mod 4=1.
{width="6.5in" height="1.9916666666666667in"}
Figure 8a: Interleaver structure for Secondary CCPCH
### 4.2.12 Physical channel mapping
The PhCH for both uplink and downlink is defined in [2]. The bits input to the
physical channel mapping are denoted by {width="1.0965277777777778in"
height="0.2638888888888889in"}, where _p_ is the PhCH number and _U_ is the
number of bits in one radio frame for one PhCH. The bits _v~p,k~_ are mapped
to the PhCHs so that the bits for each PhCH are transmitted over the air in
ascending order with respect to _k_.
In compressed mode, no bits are mapped to certain slots of the PhCH(s). If
_N~first~_ \+ _TGL_ ≤ 15, no bits are mapped to slots _N~first~_ to _N~last~_.
If _N~first~_ \+ _TGL_ > 15, i.e. the transmission gap spans two consecutive
radio frames, the mapping is as follows:
\- In the first radio frame, no bits are mapped to slots _N~first~, N~first~_
+1, _N~first~_ +2, ..., 14.
\- In the second radio frame, no bits are mapped to the slots 0, 1, 2, ...,
_N~last~_.
_TGL, N~first~_ , and _N~last~_ are defined in subclause 4.4.
#### 4.2.12.1 Uplink
When UL_DPCH_10ms_Mode is configured, uplink physical channel mapping depends
on whether a compressed-mode transmission gap overlaps with the first radio
frame in 20ms CI. A distinction is made between the following cases:
##### 4.2.12.1.1 UL_DPCH_10ms_Mode is not configured by higher layers, or, no
compressed-mode transmission gap overlaps with the first radio frame in the
20ms CI
In uplink, the PhCHs used during a radio frame are either completely filled
with bits that are transmitted over the air or not used at all. The only
exception is when the UE is in compressed mode. The transmission can then be
turned off during consecutive slots of the radio frame.
##### 4.2.12.1.2 UL_DPCH_10ms_Mode is configured by higher layers, and, a
compressed-mode transmission gap overlaps with the first radio frame in 20ms
CI
In this case, physical channel mapping is performed over 20ms Compression
Intervals (20m CI). Note that as a consequence of radio frame segmentation
procedure in Subclause 4.2.6, there are no bit inputs to the second radio
frame in one 20ms CI. Denote the bit inputs to the physical channel mapping in
a 20ms CI by {width="1.34375in" height="0.17708333333333334in"}, where _p_ is
the PhCH number and _[U]{.underline}_ is the number of bits in one radio frame
for one PhCH[.]{.underline} _Then,_ the 15 slots used to map the bits
{width="1.34375in" height="0.17708333333333334in"}are the first 15 slots in
the 20ms CI excluding slots in the compressed-mode transmission gap. In other
words,
_if N~first~_ \+ _TGL_ ≤ 15, i.e., the transmission gap spans only one radio
frame, and the mapping is as follows
> The 15 slots used for mapping are slots 0 to _N~first~_ \-- 1 in the first
> 10ms radio frame in the 20ms CI, slots _N~last~_ \+ 1 _to slot 14 in_ in the
> first 10ms radio frame in the 20ms CI, and slots 0 to TGL \-- 1 in the
> second radio frame of the 20ms CI.
_Else if N~first~_ \+ _TGL_ > 15, i.e., the transmission gap spans two
consecutive radio frames, the mapping is as follows:
If the transmission gap occurs at the beginning of the first radio frame of
the 20ms CI, then the 15 slots used for mapping are slots _N~last~ + 1 to slot
14 of the first radio frame of the 20ms CI and slots 0 to N~last~ of the
second radio frame of the 20ms CI;_
_Else, if_ the transmission gap occurs at the end of the first radio frame of
the 20ms CI, then the 15 slots used for mapping are slots 0 to _N~first~ -- 1
of the first radio frame of the 20ms CI and slots N~last~ \+ 1 to N~last~ + 15
- N~first~ of the second radio frame of the 20ms CI._
#### 4.2.12.2 Downlink
In downlink, the PhCHs do not need to be completely filled with bits that are
transmitted over the air. Values _v~p,k~_ ∉{0, 1} correspond to DTX
indicators, which are mapped to the DPCCH/DPDCH fields but are not transmitted
over the air.
In compressed mode when DL_DCH_FET_Config is configured by higher layers, the
mapping of data bits onto the slots of the PhCH is the same as normal mode,
with a difference that the data bits that are mapped to slots in a
transmission gap are not transmitted over the air.
During compressed mode by reducing the spreading factor by 2, the data bits
are always mapped into 7.5 slots within a compressed frame. No bits are mapped
to the DPDCH field as follows:
If _N~first~_ \+ _TGL_ ≤ 15, i.e. the transmission gap spans one radio frame,
if _N~first~_ \+ 7 ≤ 14
no bits are mapped to slots _N~first~_ ,_N~first~_ \+ 1, _N~first~_ +2,...,
_N~first~+6_
no bits are mapped to the first (N~Data1~+ N~Data2~)/2 bit positions of slot
_N~first~+7_
else
no bits are mapped to slots _N~first~_ , _N~first~_ \+ 1, _N~first~_ \+ 2,...,
14
no bits are mapped to slots _N~first~_ \- 1, _N~first~_ \- 2, _N~first~_ \- 3,
..., _8_
no bits are mapped to the last (N~Data1~+ N~Data2~)/2 bit positions of slot 7
end if
If _N~first~_ \+ _TGL_ > 15, i.e. the transmission gap spans two consecutive
radio frames,
> In the first radio frame, no bits are mapped to last (N~Data1~+ N~Data2~)/2
> bit positions in slot 7 as well as to slots 8, 9, 10, ..., 14.
>
> In the second radio frame, no bits are mapped to slots 0, 1, 2, ..., 6 as
> well as to first (N~Data1~+ N~Data2~)/2 bit positions in slot 7.
N~Data1~and N~Data2~ are defined in [2].
### 4.2.13 Restrictions on different types of CCTrCHs
Restrictions on the different types of CCTrCHs are described in general terms
in TS 25.302[11]. In this subclause those restrictions are given with layer 1
notation.
#### 4.2.13.1 Uplink Dedicated channel (DCH)
The maximum value of the number of TrCHs _I_ in a CCTrCH, the maximum value of
the number of transport blocks _M~i~_ on each transport channel, and the
maximum value of the number of DPDCHs _P_ are given from the UE capability
class.
#### 4.2.13.2 Random Access Channel (RACH)
\- There can only be one TrCH in each RACH CCTrCH, i.e. _I_ =1, _s~k~ = f_ ~1
_k_ ~ and _S_ = _V_ ~1~.
\- The maximum value of the number of transport blocks _M_ ~1~ on the
transport channel is given from the UE capability class.
\- The transmission time interval is either 10 ms or 20 ms.
\- Only one PRACH is used, i.e. _P_ =1, _u_ ~1 _k_ ~ = _s~k~_ , and _U_ = _S_.
\- The Static rate matching parameter _RM_ ~1~ is not provided by higher layer
signalling on the System information as the other transport channel
parameters. Any value may be used as there is one transport channel in the
CCTrCH, hence one transport channel per Transport Format Combination and no
need to do any balancing between multiple transport channels.
#### 4.2.13.3 Void
#### 4.2.13.4 Downlink Dedicated Channel (DCH)
The maximum value of the number of TrCHs _I_ in a CCTrCH, the maximum value of
the number of transport blocks _M~i~_ on each transport channel, and the
maximum value of the number of DPDCHs _P_ are given from the UE capability
class.
#### 4.2.13.5 Void
#### 4.2.13.6 Broadcast channel (BCH)
\- There can only be one TrCH in a BCH CCTrCH, i.e. _I_ =1, _s~k~ = f_ ~1 _k_
~, and _S_ = _V_ ~1~.
\- There can only be one transport block in each transmission time interval,
i.e. _M_ ~1~ = 1.
\- All transport format attributes have predefined values which are provided
in [11] apart from the rate matching _RM_ ~1~.
\- The Static rate matching parameter _RM_ ~1~ is not provided by higher layer
signalling neither fixed. Any value may be used as there is one transport
channel in the CCTrCH, hence one transport channel per Transport Format
Combination and no need to do any balancing between multiple transport
channels.
\- Only one primary or secondary CCPCH is used per CCTrCH, i.e. _P_ =1.
#### 4.2.13.7 Forward access and paging channels (FACH and PCH)
\- The maximum value of the number of TrCHs _I_ in a CCTrCH and the maximum
value of the number of transport blocks _M~i~_ on each transport channel are
given from the UE capability class.
\- The transmission time interval for TrCHs of PCH type is always 10 ms.
\- Only one secondary CCPCH is used per CCTrCH, i.e. _P_ =1.
#### 4.2.13.8 High Speed Downlink Shared Channel (HS-DSCH) associated with a
DCH
\- There can be only one TrCH in an HS-DSCH CCTrCH, i.e. _I_ = 1,
\- In case the UE is not configured in MIMO mode and not in MIMO mode with
four transmit antennas or the UE is configured in MIMO mode and single-stream
restriction is configured, there can only be one transport block in each
transmission time interval, i.e. _M~1~_ = 1. In case the UE is configured in
MIMO mode, there can be one or two transport blocks in each transmission time
interval and in case the UE is configured in MIMO mode with four transmit
antennas, there can be up to four transport blocks in each transmission time
interval.
\- The transmission time interval for TrCHs of HS-DSCH type is always 2 ms.
\- The maximum value of the number of HS-PDSCHs _P_ are given from the UE
capability class.
#### 4.2.13.9 Enhanced Dedicated Channel (E-DCH)
\- There can be only one TrCH in the E-DCH CCTrCH, i.e. _I_ = 1.
\- If the UL_MIMO_Enabled is not set to TRUE, there can only be one transport
block in each transmission time interval, i.e. _M~1~_ = 1. If the
UL_MIMO_Enabled is set to TRUE, there can be one or two transport blocks in
each transmission time interval..
\- The transmission time interval for TrCHs of E-DCH type is 2 ms or 10 ms. If
the UL_MIMO_Enabled is set to TRUE, the transmission time interval for TrCHs
of E-DCH type is always set to 2 ms.
\- The maximum value of the number of E-DPDCHs _P_ are given from the UE
capabilities.
### 4.2.14 Multiplexing of different transport channels into one CCTrCH, and
mapping of one CCTrCH onto physical channels
The following rules shall apply to the different transport channels which are
part of the same CCTrCH:
1) Transport channels multiplexed into one CCTrCh shall have co-ordinated
timings. When the TFCS of a CCTrCH is changed because one or more transport
channels are added to the CCTrCH or reconfigured within the CCTrCH, or removed
from the CCTrCH, the change may only be made at the start of a radio frame
with CFN fulfilling the relation
CFN mod F~max~ = 0,
> where F~max~ denotes the maximum number of radio frames within the
> transmission time intervals of all transport channels which are multiplexed
> into the same CCTrCH, including any transport channels _i_ which are added,
> reconfigured or have been removed, and CFN denotes the connection frame
> number of the first radio frame of the changed CCTrCH.
>
> After addition or reconfiguration of a transport channel _i_ within a
> CCTrCH, the TTI of transport channel _i_ may only start in radio frames with
> CFN fulfilling the relation:
CFN mod F~i~ = 0.
2) Only transport channels with the same active set can be mapped onto the
same CCTrCH.
3) Different CCTrCHs cannot be mapped onto the same PhCH.
4) One CCTrCH shall be mapped onto one or several PhCHs. These physical
channels shall all have the same SF, except for the case of four E-DPDCHs,
where two E-DPDCHs have spreading factor 2 and the other two E-DPDCHs have
spreading factor 4, and for the case of four S-E-DPDCHs, where two S-E-DPDCHs
have spreading factor 2 and the other two S-E-DPDCHs have spreading factor 4.
> All physical channels belonging to the same CCTrCH shall use the same
> modulation scheme with the exception that, when transmitted, the modulation
> scheme used by the four S-E-DPDCHsmay be different from that used by the
> four E-DPDCHs.
>
> The 4PAM modulation shall only be used for orthogonal PhCH pairs which are
> orthogonal in phase and use the same OVSF code.
>
> The 8PAM modulation shall only be used for orthogonal PhCH pairs which are
> orthogonal in phase and use the same OVSF code.
5) Dedicated Transport channels and common transport channels cannot be
multiplexed into the same CCTrCH.
6) For the common transport channels, only the FACH and PCH may belong to the
same CCTrCH.
There are hence two types of CCTrCH:
1) CCTrCH of dedicated type, corresponding to the result of coding and
multiplexing of one or several DCHs or one E-DCH.
2) CCTrCH of common type, corresponding to the result of the coding and
multiplexing of a common channel, RACH in the uplink, HS-DSCH, BCH, or
FACH/PCH for the downlink.
#### 4.2.14.1 Allowed CCTrCH combinations for one UE
##### 4.2.14.1.1 Allowed CCTrCH combinations on the uplink
The following CCTrCH combinations for one UE are allowed:
1) one CCTrCH of dedicated type or
1a) two CCTrCHs of dedicated type, one being of DCH type and the other one of
E-DCH type or
2) one CCTrCH of common type.
##### 4.2.14.1.2 Allowed CCTrCH combinations on the downlink
The following CCTrCH combinations for one UE are allowed:
\- x CCTrCH of dedicated type + y CCTrCH of common type. The allowed
combination of CCTrCHs of dedicated and common type are given from UE radio
access capabilities. There can be a maximum of one CCTrCH of common type for
HS-DSCH. The maximum number of CCTrCHs of common type for FACH is determined
from UE capabilities. With one CCTrCH of common type for HS-DSCH, there shall
be only one CCTrCH of dedicated type.
NOTE 1: There is only one DPCCH in the uplink, hence one TPC bits flow on the
uplink to control possibly the different DPDCHs on the downlink, part of the
same or several CCTrCHs.
NOTE 2: There is only one DPCCH in the downlink, even with multiple CCTrCHs.
With multiple CCTrCHs, the DPCCH is transmitted on one of the physical
channels of that CCTrCH which has the smallest SF among the multiple CCTrCHs.
Thus there is only one TPC command flow and only one TFCI word in downlink
even with multiple CCTrCHs.
NOTE 3: in the current release, only 1 CCTrCH of dedicated type is supported.
## 4.3 Transport format detection
If the transport format set of a TrCH _i_ contains more than one transport
format, the transport format can be detected according to one of the following
methods:
\- TFCI based detection: This method is applicable when the transport format
combination is signalled using the TFCI field;
\- explicit blind detection: This method typically consists of detecting the
TF of TrCH _i_ by use of channel decoding and CRC check;
\- guided detection: This method is applicable when there is at least one
other TrCH _i\'_ , hereafter called guiding TrCH, such that:
\- the guiding TrCH has the same TTI duration as the TrCH under consideration,
i.e. F~i\'~ = F~i~;
\- different TFs of the TrCH under consideration correspond to different TFs
of the guiding TrCH;
\- explicit blind detection is used on the guiding TrCH.
If the transport format set for a TrCH _i_ does not contain more than one
transport format with more than zero transport blocks, no explicit blind
transport format detection needs to be performed for this TrCH. The UE can use
guided detection for this TrCH or single transport format detection, where the
UE always assumes the transport format corresponding to more than zero
transport blocks for decoding.
For uplink, blind transport format detection is a network controlled option.
For downlink, the UE shall be capable of performing blind transport format
detection, if certain restrictions on the configured transport channels are
fulfilled.
### 4.3.1 Blind transport format detection
When no TFCI is available then explicit blind detection or guided detection
shall be performed on all TrCHs within the CCTrCH that have more than one
transport format and that do not use single transport format detection. The UE
shall only be required to support blind transport format detection if all of
the following restrictions are fulfilled:
1\. either only one CCTrCH is received, or one CCTrCH of dedicated type and
one CCTrCH of common type for HS-DSCH are received by the UE;
> If only one CCTrCH is received by the UE, the following conditions apply to
> that CCTrCH and those TrCHs that are multiplexed on the CCTrCH. If one
> CCTrCH of dedicated type and one CCTrCH of common type for HS-DSCH are
> received by the UE, the following conditions apply to the dedicated type
> CCTrCH and the TrCHs that are multiplexed on the dedicated type CCTrCH.
2\. the number of CCTrCH bits received per radio frame is 600 or less;
3\. the number of transport format combinations of the CCTrCH is 64 or less;
4\. fixed positions of the transport channels is used on the CCTrCH to be
detectable;
5\. convolutional coding is used on all explicitly detectable TrCHs;
6\. CRC with non-zero length is appended to all transport blocks on all
explicitly detectable TrCHs;
7\. at least one transport block shall be transmitted per TTI on each
explicitly detectable TrCH;
8\. the number of explicitly detectable TrCHs is 3 or less;
9\. for all explicitly detectable TrCHs _i_ , the number of code blocks in one
TTI (C~i~) shall not exceed 1;
10\. the sum of the transport format set sizes of all explicitly detectable
TrCHs, is 16 or less. The transport format set size is defined as the number
of transport formats within the transport format set;
11\. there is at least one TrCH that can be used as the guiding transport
channel for all transport channels using guided detection.
Examples of blind transport format detection methods are given in annex A.
### 4.3.1A Single transport format detection
When no TFCI is available, then single transport format detection shall be
applied on all TrCHs within the CCTrCH that have a transport format set not
containing more than one transport format with more than zero transport blocks
and that do not use guided detection. The UE shall only be required to support
single transport format detection if the following restrictions are fulfilled:
> 1\. For each transport channel that is single transport format detected, CRC
> with non-zero length is appended to all transport blocks within the non-zero
> transport block transport format;
>
> 2\. fixed positions of the transport channels is used on the CCTrCH to be
> detectable.
### 4.3.2 Transport format detection based on TFCI
If a TFCI is available, then TFCI based detection shall be applicable to all
TrCHs within the CCTrCH. The TFCI informs the receiver about the transport
format combination of the CCTrCHs. As soon as the TFCI is detected, the
transport format combination, and hence the transport formats of the
individual transport channels are known.
If higher layers indicate that S-CCPCHs can be soft combined during a period
of consecutive TTIs, then the same TFC is used on those S-CCPCHs for each
combinable TTI. The UE may therefore detect TFCI on one S-CCPCH to determine
the TFC on all S-CCPCHs that can be soft combined. (S-CCPCH soft combining is
further specified in [4]).
### 4.3.3 Coding of Transport-Format-Combination Indicator (TFCI)
The TFCI is encoded using a (32, 10) sub-code of the second order Reed-Muller
code. The coding procedure is as shown in figure 9.
{width="3.95in" height="0.7902777777777777in"}
Figure 9: Channel coding of TFCI information bits
If the TFCI consist of less than 10 bits, it is padded with zeros to 10 bits,
by setting the most significant bits to zero. The length of the TFCI code word
is 32 bits.
The code words of the (32,10) sub-code of second order Reed-Muller code are
linear combination of 10 basis sequences. The basis sequences are as in the
following table 8.
Table 8: Basis sequences for (32,10) TFCI code
* * *
i M~i,0~ M~i,1~ M~i,2~ M~i,3~ M~i,4~ M~i,5~ M~i,6~ M~i,7~ M~i,8~ M~i,9~ 0 1 0
0 0 0 1 0 0 0 0 1 0 1 0 0 0 1 1 0 0 0 2 1 1 0 0 0 1 0 0 0 1 3 0 0 1 0 0 1 1 0
1 1 4 1 0 1 0 0 1 0 0 0 1 5 0 1 1 0 0 1 0 0 1 0 6 1 1 1 0 0 1 0 1 0 0 7 0 0 0
1 0 1 0 1 1 0 8 1 0 0 1 0 1 1 1 1 0 9 0 1 0 1 0 1 1 0 1 1 10 1 1 0 1 0 1 0 0 1
1 11 0 0 1 1 0 1 0 1 1 0 12 1 0 1 1 0 1 0 1 0 1 13 0 1 1 1 0 1 1 0 0 1 14 1 1
1 1 0 1 1 1 1 1 15 1 0 0 0 1 1 1 1 0 0 16 0 1 0 0 1 1 1 1 0 1 17 1 1 0 0 1 1 1
0 1 0 18 0 0 1 0 1 1 0 1 1 1 19 1 0 1 0 1 1 0 1 0 1 20 0 1 1 0 1 1 0 0 1 1 21
1 1 1 0 1 1 0 1 1 1 22 0 0 0 1 1 1 0 1 0 0 23 1 0 0 1 1 1 1 1 0 1 24 0 1 0 1 1
1 1 0 1 0 25 1 1 0 1 1 1 1 0 0 1 26 0 0 1 1 1 1 0 0 1 0 27 1 0 1 1 1 1 1 1 0 0
28 0 1 1 1 1 1 1 1 1 0 29 1 1 1 1 1 1 1 1 1 1 30 0 0 0 0 0 1 0 0 0 0 31 0 0 0
0 1 1 1 0 0 0
* * *
When UL_DPCH_10ms_Mode is not configured by higher layers, the TFCI
information bits a~0~ , a~1~ , a~2~ , a~3~ , a~4~ , a~5~ , a~6~ , a~7~ , a~8~
, a~9~ (where a~0~ is LSB and a~9~ is MSB) shall correspond to the TFC index
(expressed in unsigned binary form) defined by the RRC layer to reference the
TFC of the CCTrCH in the associated DPCH radio frame.
When UL_DPCH_10ms_Mode is configured by higher layers, the TFCI information
bits a~0~ , a~1~ , a~2~ , a~3~ , a~4~ , a~5~ , a~6~ , a~7~ , a~8~ , a~9~
(where a~0~ is LSB and a~9~ is MSB) shall correspond to unsigned binary
expression of the sum of the TFC index and the size of TFCS.
The output code word bits b~i~ are given by:
{width="1.7638888888888888in" height="0.4722222222222222in"}
where _i_ = 0, ..., 31.
The output bits are denoted by _b~k~_ , _k_ = 0, 1, 2, ..., 31.
In downlink, when the SF \ 32, the remaining positions are filled by repetition (in reversed
order):
_d~D-k~_ ~-1~ = _b_ ~(_E+k_)\ mod\ 32~
where _k_ = 0, ..., _D_ -33.
##### 4.3.5.2.1.2 Uplink DPCCH slot format 5 {#uplink-dpcch-slot-format-5 .H6}
In each 20ms CI, the first 10 UL DPCCH slots that are not in a compressed mode
transmission gap contain TFCI information. The bits of the codeword are
directly mapped to these slots. Within a slot, the bit with lower index is
transmitted before the bit with higher index. The coded bits _b~k~_ , are
mapped to the transmitted TFCI bits _d~k~_ , according to the following
formula:
_d~k~_ = _b~k~, , for k = 0,..., 19._
##### 4.3.5.2.2 Downlink compressed mode
For downlink compressed mode, the slot format is changed so that no TFCI coded
bits are lost. The different slot formats in compressed mode do not match the
exact number of TFCI bits for all possible TGLs. DTX is therefore used if the
number of bits available in the TFCI fields in one compressed frame exceeds
the number of TFCI bits given from the slot format. The block of bits in the
TFCI fields where DTX is used starts on the first TFCI field after the
transmission gap. If there are more bits available in the TFCI fields before
the transmission gap than TFCI bits, DTX is also used on the bits in the last
TFCI fields before the transmission gap.
Denote the number of bits available in the TFCI fields of one compressed radio
frame by _D_ and the number of bits in the TFCI field in a slot by N~TFCI~.
The parameter _E_ is used to determine the position of the first bit in the
TFCI field on which DTX is used.
_E_ = N~first~ N~TFCI~, if the start of the transmission gap is allocated to
the current frame.
_E_ = 0, if the start of the transmission gap is allocated to the previous
frame and the end of the transmission gap is allocated to the current frame.
Denote the total number of TFCI bits to be transmitted by _F_. _F_ = 32 for
slot formats _n_ A or _n_ B, where _n_ = 0, 1, ..., 11 (see table 11 in [2]).
Otherwise, _F_ = 128. The TFCI coded bits _b~k~_ are mapped to the bits in the
TFCI fields _d~k~_. The following relations define the mapping for each
compressed frame.
If _E_ > 0,
_d~k~_ = _b~k~_ ~mod\ 32~
where _k_ = 0, 1, 2, ..., min (_E_ , _F_)-1.
If _E_ \ 15, then N~last~ = (N~first~ + TGL -- 1) mod 15 ( in the
next frame ).
When the transmission gap spans two consecutive radio frames, N~first~ and TGL
must be chosen so that at least 8 slots in each radio frame are transmitted.
{width="5.8069444444444445in" height="6.125in"}
Figure 15: Transmission gap positions with different Nfirst
### 4.4.5 Transmission gap position for E‑DCH
In the following, the transmission gap position for E‑DCH during compressed
frames is specified for the case when E‑DCH TTI length is 10 ms. Slots that
are not idle due to uplink compressed mode are termed \"available\".
The parameter _n~first~_ and _n~last~_ are used to determine the transmission
gap position due to uplink compressed mode in the current radio frame. If the
start of the transmission gap is allocated in the current frame _n~first~_
=_N~first~_ else _n~first~_ =0. If the end of a transmission gap is allocated
in the current frame _n~last~_ =_N~last~_ else _n~last~_ =14.
#### 4.4.5.1 E‑DPDCH Transmission Gap Position during Initial Transmissions
If an initial transmission overlaps with a compressed frame the starting slot
of the consecutive E‑DPDCH idle slots within the E‑DCH TTI is _n~first~_ , and
_n~last~_ is the final idle slot within the 10 ms E‑DCH TTI. The number of
transmitted slots _n~tx1~_ is given by _n~tx1~_ =14+_n~first~_ -_n~last~_.
If the initial transmission occurs in a non‑compressed uplink frame, _n~tx1~_
=15.
#### 4.4.5.2 E‑DPDCH Transmission Gap Position during Retransmissions
If the current retransmission occurs in a compressed frame the maximum number
of slots available for the retransmission is given by _n~max~_ =14+_n~first~_
-_n~last~_. Else the maximum number of slots available for the retransmission
_n~max~_ is 15.
If the initial transmission was compressed and in the retransmission more than
_n~tx1~_ slots are available for transmission (_n~max~_ >_n~tx1~_), the last
_n~dtx~_ =_n~max~_ -_n~tx1~_ available slots of the E‑DPDCH frame are E‑DPDCH
idle slots. The parameter _n~tx1~_ refers to the number of transmitted slots
calculated as defined in 4.4.5.1 for the corresponding initial transmission.
The E‑DPDCH transmission gap in case a retransmission occurs in a compressed
frame or a retransmission occurs in a non‑compressed frame for which initial
transmission was compressed is defined as follows:
> If _n~max\ ~_ ≤ _n~tx1~_
>
> E‑DPDCH idle slots are slots _n~first~_ , _n~first~_ +1, .., _n~last~_
>
> Else
>
> If a retransmission occurs in a compressed frame and _n~first~_ \
> E‑DPDCH idle slots are the slots _n~first~_ , _n~first~_ +1, .., _n~last~_
> and 15-_n~dtx~_ , 15-_n~dtx~_ +1, ..,14
>
> Else
>
> E‑DPDCH idle slots are the slots _n~tx1~, n~tx1~+1,_ ..,14
#### 4.4.5.3 E‑DPCCH Transmission Gap Position
If a transmission overlaps with an uplink compressed frame the starting slot
of the compressed mode gap within the E‑DCH TTI is _n~first~_ , and _n~last~_
is the final E‑DPCCH idle slot within the 10 ms E‑DCH TTI.
## 4.5 Coding for HS-DSCH
Data arrives to the coding unit in form of a maximum of one transport block
once every transmission time interval. The transmission time interval is 2 ms
which is mapped to a radio sub-frame of 3 slots.
The following coding steps can be identified:
\- add CRC to each transport block (see subclause 4.5.1);
\- bit scrambling (see subclause 4.5.1A);
\- code block segmentation (see subclause 4.5.2);
\- channel coding (see subclause 4.5.3);
\- hybrid ARQ (see subclause 4.5.4);
\- physical channel segmentation (see subclause 4.5.5);
\- interleaving for HS-DSCH (see subclause 4.5.6);
\- constellation re-arrangement for 16QAM and 64QAM (see subclause 4.5.7);
\- mapping to physical channels (see subclause 4.5.8).
The coding steps for HS-DSCH are shown in the figure below.
Figure 16: Coding chain for HS-DSCH
In the following the number of transport blocks and the number of transport
channels is always one i.e. m=1, i=1. When referencing non HS-DSCH formulae
which are used in correspondence with HS-DSCH formulae the convention is used
that transport block subscripts may be omitted (e.g. X~1~ may be written X).
### 4.5.1 CRC attachment for HS-DSCH
#### 4.5.1.1 CRC attachment method 1 for HS-DSCH
CRC attachment method 1 for the HS-DSCH transport channel shall be done using
the general method described in 4.2.1 above with the following specific
parameters.
The CRC length shall always be L~1~ = 24 bits.
#### 4.5.1.2 CRC attachment method 2 for HS-DSCH
CRC attachment method 2 for the HS-DSCH transport channel shall be done
according to the following method.
From the sequence of bits _a~1~, a~2~, a~3~,..., a~A~_ , where _A_ is the size
of the HS-DSCH transport block _,_ a CRC of length L~1~ = 24 bits is
calculated according to Clause 4.2.1.1 above. This gives a sequence of bits
_c~im1~, c~im2~, c~im3~,..., c~im24\ ~_ where
$c_{k} = p_{\text{im}(\text{25} - k)}$ _k=1,2,...,24_
This sequence of bits is then masked with the UE Identity _x~ue,1~, x~ue,2~,
..., x~ue,16~_ and then appended to the sequence of bits _a~1~, a~2~,
a~3~,..., a~A~_ to form the sequence of bits _b~1~, b~2~, b~3~,..., b~B~_ ,
where _B_ = _A_ \+ 24, and
_b~k~ = a~k~ k=1,2,...,A_
_b~k~ = c~k-A~ k=A+1,...,A+8_
_b~k~ =_ (_c~k-A~_ \+ _x~ue~_ ,_~k-A-8~_) mod 2 _k=A+9, ...,A+24_
### 4.5.1A Bit scrambling for HS-DSCH
The bits output from the HS-DSCH CRC attachment are scrambled in the bit
scrambler. The bits input to the bit scrambler are denoted by
$b_{\text{im},1},b_{\text{im},2},b_{\text{im},3},\text{.}\text{.}\text{.},b_{\text{im},B}$,
where _B_ is the number of bits input to the HS-DSCH bit scrambler The bits
after bit scrambling are denoted
$d_{\text{im},1},d_{\text{im},2},d_{\text{im},3},\text{.}\text{.}\text{.},d_{\text{im},B}$.
Bit scrambling is defined by the following relation:
$d_{\text{im},k} = \left( b_{\text{im},k} + y_{k} \right)\text{mod}2$ _k_ =
1,2,...,_B_
and $y_{k}$ results from the following operation:
$y'_{\gamma} = 0$ -15 \ N_{\text{sys}} + N_{p1} + N_{p2}$ repetition is
performed in the second rate matching stage. A similar repetition rate in all
bit streams is achieved by setting the number of transmitted systematic bits
to $N_{t,\text{sys}} = \left\lfloor N_{\text{sys}} \cdot
\frac{N_{\text{data}}}{N_{\text{sys}} + 2N_{p1}} \right\rfloor$.
The number of parity bits in a transmission is: $N_{t,p1} = \left\lfloor
\frac{N_{\text{data}} - N_{t,\text{sys}}}{2} \right\rfloor$ and $N_{t,p2} =
\left\lceil \frac{N_{\text{data}} - N_{t,\text{sys}}}{2} \right\rceil$ for the
parity 1 and parity 2 bits, respectively.
Table 10 below summarizes the resulting parameter choice for the second rate
matching stage.
Table 10: Parameters for HARQ second rate matching
* * *
                *X~i~*   *e~plus~*   *e~minus~*
Systematic\  
RM S
Parity 1\  
RM P1_2
Parity 2\  
RM P2_2
* * *
The rate matching parameter _e~ini~_ is calculated for each bit stream
according to the RV parameters r and s using
$e_{\text{ini}}(r) = \left{ \left( X_{i} - \left\lfloor \frac{r \cdot
e_{\text{plus}}}{r_{\text{max}}} \right\rfloor - 1 \right)\
\text{mod}e_{\text{plus}} \right} + 1$ in the case of puncturing ,
i.e.,$N_{\text{data}} \leq N_{\text{sys}} + N_{p1} + N_{p2}$, and
$e_{\text{ini}}(r) = \left{ \left( X_{i} - \left\lfloor (s + 2 \cdot r\frac{)
\cdot e_{\text{plus}}}{(}2 \cdot r_{\text{max}}) \right\rfloor - 1 \right)\
\text{mod}e_{\text{plus}} \right} + 1$ for repetition, i.e., $N_{\text{data}}
> N_{\text{sys}} + N_{p1} + N_{p2}$. Where and is the total number of
redundancy versions allowed by varying as defined in 4.6.2. Note that r~max~
varies depending on the modulation mode, i.e. for 16QAM and 64QAM, _r~max~_ =
2 and for QPSK _r~max~_ = 4.
Note: For the modulo operation the following clarification is used: the value
of (x mod y) is strictly in the range of 0 to _y_ -1 (i.e. -1 mod 10 = 9).
#### 4.5.4.4 HARQ bit collection
The HARQ bit collection is achieved using a rectangular interleaver of size .
The number of rows and columns are determined from:
$N_{\text{row}} = 6$ for 64QAM,$N_{\text{row}} = 4$ for 16QAM and
$N_{\text{row}} = 2$ for QPSK
$N_{\text{col}} = \frac{N_{\text{data}}}{N_{\text{row}}}$
where _N~data~_ is used as defined in 4.5.4.3.
Data is written into the interleaver column by column, and read out of the
interleaver column by column starting from the first column.
_N~t,sys~_ is the number of transmitted systematic bits. Intermediate values
_N~r~_ and _N~c~_ are calculated using:
$N_{r} = \left\lfloor \frac{N_{t,\text{sys}}}{N_{\text{col}}} \right\rfloor$
and $N_{c} = N_{t,\text{sys}} - N_{r} \cdot N_{\text{col}}$.
If _N~c~_ =0 and _N~r\ ~_ > 0, the systematic bits are written into rows
1..._N~r~._
Otherwise systematic bits are written into rows 1..._N~r~+1_ in the first
_N~c~_ columns and, if _N~r\ ~_ > 0, also into rows 1..._N~r~_ in the
remaining _N~col~-N~c~_ columns.
The remaining space is filled with parity bits. The parity bits are written
column wise into the remaining rows of the respective columns. Parity 1 and 2
bits are written in alternating order, starting with a parity 2 bit in the
first available column with the lowest index number.
In the case of 64QAM for each column the bits are read out of the interleaver
in the order row 1, row 2, row 3, row 4, row 5, row 6. In the case of 16QAM
for each column the bits are read out of the interleaver in the order row 1,
row 2, row 3, row 4. In the case of QPSK for each column the bits are read out
of the interleaver in the order row1, row2.
### 4.5.5 Physical channel segmentation for HS-DSCH
When more than one HS-PDSCH is used, physical channel segmentation divides the
bits among the different physical channels. The bits input to the physical
channel segmentation are denoted by w~1~, w~2~, w~3~,...w~R~, where R is the
number of bits input to the physical channel segmentation block. The number of
PhCHs is denoted by _P._
The bits after physical channel segmentation are denoted
{width="1.2916666666666667in" height="0.2638888888888889in"}, where _p_ is
PhCH number and _U_ is the number of bits in one radio sub-frame for each HS-
PDSCH, i.e. . The relation between w _~k~_ and _u~p,k~_ is given below.
For all modes, some bits of the input flow are mapped to each code until the
number of bits on the code is _U_.
Bits on first PhCH after physical channel segmentation:
_u~1,\ k~ = w~k~ k =_ 1, 2 , ..., _U_
Bits on second PhCH after physical channel segmentation:
_u~2,\ k~ = w~k+U~_ _k =_ 1, 2 , ..., _U_
...
Bits on the _P^th^_ PhCH after physical channel segmentation:
_u~P,k~ = w~k+(P-1)~_ ~× _U_ ~ _k =_ 1, 2 , ..., _U_
### 4.5.6 Interleaving for HS-DSCH
The interleaving for FDD is done as shown in figure 18 below, separately for
each physical channel. The bits input to the block interleaver are denoted by
$u_{p,1},u_{p,2},u_{p,3},\text{.}\text{.}\text{.},u_{p,U}$, where _p_ is PhCH
number and _U_ is the number of bits in one TTI for one PhCH. For QPSK _U_ =
960, for 16QAM _U_ = 1920 and for 64QAM _U_ = 2880\. The basic interleaver is
as the 2^nd^ interleaver described in Clause 4.2.11. The interleaver is of
fixed size: R2=32 rows and C2=30 columns.
{width="6.5in" height="3.013888888888889in"}
Figure 18: Interleaver structure for HS-DSCH
For 16QAM, there are two identical interleavers of the same fixed size R2×C2 =
32×30. The output bits from the physical channel segmentation are divided two
by two between the interleavers: bits _u~p,k~_ and u~p,k+1~ go to the first
interleaver and bits _u~p,k+2~_ and _u~p,k+3~_ go to the second interleaver.
Bits are collected two by two from the interleavers: bits _v~p,k~_ and
_v~p,k+1~_ are obtained from the first interleaver and bits _v~p,k+2~_ and
_v~p,k+3~_ are obtained from the second interleaver, where k mod 4=1.
For 64QAM, there are three identical interleavers of the same fixed size R2×C2
= 32×30. The output bits from the physical channel segmentation are divided
two by two between the interleavers: bits _u~p,k~_ and u~p,k+1~ go to the
first interleaver, bits _u~p,k+2~_ and _u~p,k+3~_ go to the second interleaver
and bits _u~p,k+4~_ and _u~p,k+5~_ go to the third interleaver. Bits are
collected two by two from the interleavers: bits _v~p,k~_ and _v~p,k+1~_ are
obtained from the first interleaver, bits _v~p,k+2~_ and _v~p,k+3~_ are
obtained from the second interleaver and bits _v~p,k+4~_ and _v~p,k+5~_ are
obtained from the third interleaver, where k mod 6=1.
### 4.5.7 Constellation re-arrangement for 16 QAM and 64QAM
This function only applies to 16QAM and 64QAM modulated bits. In case of QPSK
it is transparent.
Table 11 describes the operations that produce the different rearrangements
for 16QAM. The bits of the input sequence are mapped in groups of 4 so that
_v~p,k~, v~p,k+1~, v~p,k+2~, v~p,k+3~_ are used, where k mod 4 = 1. The output
bit sequences map to the output bits in groups of 4, i.e. _r~p,k~, r~p,k+1~,
r~p,k+2~, r~p,k+3~_ , where k mod 4 = 1.
Table 11: Constellation re-arrangement for 16QAM
* * *
constellation version parameter _b_ Output bit sequence Operation 0 None 1
Swapping MSBs with LSBs 2 Inversion of the logical values of LSBs 3 Swapping
MSBs with LSBs and inversion of logical values of LSBs
* * *
Table 11A describes the operations that produce the different rearrangements
for 64QAM. The bits of the input sequence are mapped in groups of 6 so that
_v~p,k~, v~p,k+1~, v~p,k+2~, v~p,k+3~, v~p,k+4~, v~p,k+5~_ are used, where k
mod 6 = 1. The output bit sequences map to the output bits in groups of 6,
i.e. _r~p,k~, r~p,k+1~, r~p,k+2~, r~p,k+3~, r~p,k+4~, r~p,k+5~_ , where k mod
6 = 1.
Table 11A: Constellation re-arrangement for 64QAM
* * *
constellation version parameter _b_ Output bit sequence Operation 0 None 1
Swapping MSBs and LSBs. Inversion of Middle SBs 2 Left circular shift of pair
of SBs. Inversion of Middle SBs 3 Inversion of Middle SBs
* * *
### 4.5.8 Physical channel mapping for HS-DSCH
The HS-PDSCH is defined in [2]. The bits input to the physical channel mapping
are denoted by _r~p,1~_ , _r~p,2~_ ,...,_r~p,U~_ , where _p_ is the physical
channel number and _U_ is the number of bits in one radio sub-frame for one
HS-PDSCH. The bits _r~p,k~_ are mapped to the PhCHs so that the bits for each
PhCH are transmitted over the air in ascending order with respect to _k_.
## 4.6 Coding for HS-SCCH type 1
### 4.6.1 Overview
HS-SCCH shall be of type 1 when the following two conditions are both true:
\- the UE is not configured in MIMO mode and not in MIMO mode with four
transmit antennas, and
\- the conditions for usage of HS-SCCH type 2 are not met.
In this section, the terms "HS-SCCH" and "HS-SCCH type 1" are used
interchangeably.
The following information is transmitted by means of the HS-SCCH type 1
physical channel.
\- Channelization-code-set information (7 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- Transport-block size information (6 bits): _x~tbs,1~, x~tbs,2~, ...,
x~tbs,6~_
\- Hybrid-ARQ process information (3 bits): _x~hap,1~, x~hap,2~, x~hap,3~_
\- Redundancy and constellation version (3 bits): _x~rv,1~, x~rv,2~, x~rv,3~_
\- New data indicator (1 bit): _x~nd,1~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
For an HS-SCCH order,
\- x~ccs,1~, x~ccs,2~, ..., x~ccs,7~_,_ x~ms,1~ shall be set to \'\'11100000'
\- x~tbs,1~, x~tbs,2~, ..., x~tbs,~~4~ _shall be set to \'\'_ 1111 _'_
\- x~tbs,5~_,_ ~tbs,6~ _shall be set to_ x~eodt,1~, x~eodt,2~
\- x~hap,1~, x~hap,2~, x~hap,3~, x~rv,1~, x~rv,2~, x~rv,3~ _shall be set to_
x~odt,1~, x~odt,2~, x~odt,3~_, x~ord,1~, x~or~_ ~d,2~, x~ord,3~
\- x~nd,1~ _is reserved_
_where x~eodt,1~, x~eodt,2~, x~odt,1~, x~odt,2~, x~odt,3~, x~ord,1~, x~ord,2~,
x~ord,3~ are defined in subclause 4.6C._
Figure 19 below illustrates the overall coding chain for HS-SCCH type 1.
Figure 19: Coding chain for HS-SCCH type 1
### 4.6.2 HS-SCCH information field mapping
#### 4.6.2.1 Redundancy and constellation version coding
The redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are coded jointly to produce the value X~rv~. X~rv~ is
alternatively represented as the sequence x~rv,1~, x~rv,2~, x~rv,3~ where
x~rv,1~ is the MSB. This is done according to tables 12 and 13 according to
the modulation mode used:
Table 12: RV coding for 16QAM and 64QAM
* * *
X~rv~ (value) s R b 0 1 0 0 1 0 0 0 2 1 1 1 3 0 1 1 4 1 0 1 5 1 0 2 6 1 0 3 7
1 1 0
* * *
Table 13: RV coding for QPSK
* * *
X~rv~ (value) s r 0 1 0 1 0 0 2 1 1 3 0 1 4 1 2 5 0 2 6 1 3 7 0 3
* * *
#### 4.6.2.2 Modulation scheme mapping
The value of _x~ms,1~_ is derived from the modulation and given by the
following:
#### 4.6.2.3 Channelization code-set mapping
The channelization code-set bits x~ccs,1~, x~ccs,2~, ..., x~ccs,7~ are coded
according to the following:
Given P (multi-)codes starting at code O, and given the HS-SCCH number if
64QAM is configured for the UE and x~ms,1~=1, calculate the information-field
using the unsigned binary representation of integers calculated by the
expressions,
for the first three bits (code group indicator) of which _x~ccs,1~_ is the
MSB:
_x~ccs,1~, x~ccs,2~, x~ccs,3~_ = min(P-1,15-P)
If 64QAM is not configured for the UE, or if 64QAM is configured and
x~ms,1~=0, then
for the last four bits (code offset indicator) of which _x~ccs,4~_ is the MSB:
_x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,7~_ = \|O-1-P/8 *15\|
Otherwise (i.e. if 64QAM is configured for the UE and x~ms,1~=1),
_P_ and _O_ shall fulfil \|O-1-P/8 *15\| mod 2 = (HS‑SCCH number) mod 2, and
then
_x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,dummy~_ = \|O-1-P/8 *15\|, where
_x~ccs,dummy~_ is a dummy bit that is not transmitted on HS-SCCH.
Furthermore,
$x_{\text{ccs},7} = \left{ \begin{matrix} 0 & \begin{matrix} \text{if} &
\text{16}\text{QAM} \ \end{matrix} \ 1 & \begin{matrix} \text{if} &
\text{64}\text{QAM} \ \end{matrix} \ \end{matrix} \right.\ $.
The definitions of P and O are given in [3]. The HS-SCCH number is given by
the position in the list of HS-SCCH Channelisation Code Informations signalled
by higher layers. The HS-SCCH number is associated with the code offset
indicator and code group indicator as described above if 64QAM is configured
for the UE and x~ms,1~=1.
#### 4.6.2.4 UE identity mapping
The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[13]. This is mapped such that x~ue,1~ corresponds to the MSB and x~ue,16~ to
the LSB, cf. [14].
#### 4.6.2.5 HARQ process identifier mapping
Hybrid-ARQ process information (3 bits) _x~hap,1~, x~hap,2~, x~hap,3~_ is the
unsigned binary representation of the HARQ process identifier where _x~hap,1~_
is MSB.
#### 4.6.2.6 Transport block size index mapping
Transport-block size information (6 bits) _x~tbs,1~, x~tbs,2~, ..., x~tbs,6\
~_ is unsigned binary representation of the transport block size index where
_x~tbs,1~_ is MSB.
### 4.6.3 Multiplexing of HS-SCCH information
The channelization-code-set information _x~ccs,1~, x~ccs,2~, ..., x~ccs,7~_
and modulation-scheme information _x~ms,1~_ are multiplexed together. This
gives a sequence of bits _x~1,1~, x~1,2~, ..., x~1,8~_ where
_x~1,i~ = x~ccs,i~ i=1,2,...,7_
_x~1,i~ = x~ms,i-7~ i=8_
The transport-block-size information _x~tbs,1~, x~tbs,2~, ..., x~tbs,6~_ ,
Hybrid-ARQ-process information _x~hap,1~,x~hap,2~, x~hap,3~_ , redundancy-
version information _x~rv,1~, x~rv,2~_ , x~rv,3~ and new-data indicator
_x~nd,1~_ are multiplexed together. This gives a sequence of bits _x~2,1~,
x~2,2~, ..., x~2,13~_ where
_x~2,i~ = x~tbs,i~ i=1,2,...,6_
_x~2,i~ = x~hap,i-6~ i=7,8,9_
_x~2,i~ = x~rv,i-9~ i=10,11,12_
_x~2,i~ = x~nd,i-12~ i=13_
### 4.6.4 CRC attachment for HS-SCCH
From the sequence of bits _x~1,1~, x~1,2~, ..., x~1,8,~ x~2,1~, x~2,2~, ...,
x~2,13~_ a 16 bits CRC is calculated according to Clause 4.2.1.1. This gives a
sequence of bits _c~1~, c~2~, ..., c~16\ ~_ where
$c_{k} = p_{\text{im}(\text{17} - k)}$ _k=1,2,...,16_
This sequence of bits is then masked with the UE Identity _x~ue,1~, x~ue,2~,
..., x~ue,16~_ and then appended to the sequence of bits _x~2,1~, x~2,2~, ...,
x~2,13~_ to form the sequence of bits _y~1~, y~2~, ..., y~29~_ , where
_y~i~ = x~2,i~ i=1,2,...,13_
_y~i~ =_ (_c~i-13~_ \+ _x~ue~_ ,~i-13~ ) mod 2 _i=14,15,...,29_
### 4.6.5 Channel coding for HS-SCCH
Rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is applied to
the sequence of bits x _~1,1~,x~1,2~, ...,x~1,8~_ ~.~ This gives a sequence of
bits _z~1,1~, z~1,2~, ..., z~1,48~_ ~.~
Rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is applied to
the sequence of bits _y~1~, y~2~, ..., y~29~_ ~.~ This gives a sequence of
bits _z~2,1~, z~2,2~, ..., z~2,111~_ ~.~
Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.
### 4.6.6 Rate matching for HS-SCCH
From the input sequence _z~1,1~, z~1,2~, ..., z~1,48~_ the bits _z~1,1~,
z~1,2~, z~1,4~, z~1,8~, z~1,42~, z~1,45~, z~1,47~, z~1,48~_ are punctured to
obtain the output sequence _r~1,1~,r~1,2~...r~1,40~._
From the input sequence _z~2,1~, z~2,2~, ..., z~2,111~_ the bits _z~2,1~,
z~2,2~, z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~, z~2,12~, z~2,14~,
z~2,15~, z~2,24~, z~2,42~, z~2,48~, z~2,54~, z~2,57~, z~2,60~, z~2,66~,
z~2,69~, z~2,96~, z~2,99~, z~2,101~, z~2,102~, z~2,104~, z~2,105~, z~2,106~,
z~2,107~, z~2,108~, z~2,109~, z~2,110~, z~2,111~_ are punctured to obtain the
output sequence _r~2,1~,r~2,2~...r~2,80~_.
### 4.6.7 UE specific masking for HS-SCCH
The rate matched bits _r~1,1~,r~1,2~...r~1,40~_ shall be masked in an UE
specific way using the UE identity _x~ue,1~, x~ue,2~, ..., x~ue,16~,_ to
produce the bits _s~1,1~,s~1,2~...s~1,40~_.
Intermediate code word bits b~i~, i=1,2...,48, are defined by encoding the UE
identity bits using the rate ½ convolutional coding described in Clause
4.2.3.1. Eight bits out of the resulting 48 convolutionally encoded bits are
punctured using the rate matching rule of Clause 4.6.6 for the HS-SCCH part 1
sequence, that is, the intermediate code word bits b~1~, b~2~, b~4~, b~8~,
b~42~, b~45~, b~47~, b~48,~ are punctured to obtain the 40 bit UE specific
scrambling sequence c~1~, c~2~, ....c~40~. _._
The mask output bits _s~1,1~,s~1,2~...s~1,40~_ are calculated as follows:
_s~1,k~ =_(_r~1,k~ + c~k~_) _mod 2_ for k = 1,2...40
### 4.6.8 Physical channel mapping for HS-SCCH
The HS-SCCH sub-frame is described in[2].
The sequence of bits _s~1,1~, s~1,2~,, ..., s~1,40~_ is mapped to the first
slot of the HS-SCCH sub frame. The bits _s~1,k~_ are mapped to the PhCHs so
that the bits for each PhCH are transmitted over the air in ascending order
with respect to _k_.
The sequence of bits _r~2,1~, r~2,2~,, ...,,r~2,80~_ is mapped to the second
and third slot of the HS-SCCH sub frame. The bits _r~2,k~_ are mapped to the
PhCHs so that the bits for each PhCH are transmitted over the air in ascending
order with respect to _k_.
## 4.6A Coding for HS-SCCH type 2
### 4.6A.1 Overview
HS-SCCH type 2 is used for HS-SCCH-less operation. HS-SCCH type 2 is not used
when the UE is configured in MIMO mode or in MIMO mode with four transmit
antennas. During second and third transmission, the following information is
transmitted by means of the HS-SCCH type 2 physical channel.
\- Channelization-code-set information (7 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- Special Information type (6 bits): _x~type,1~, x~type,2~, ..., x~type,6~_
\- Special Information (7 bits): _x~info,1~, x~info,2~, x~info,3~, x~info,4~,
x~info,5~, x~info,6~, x~info,7~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
Figure 19A below illustrates the overall coding chain for HS-SCCH type 2.
Figure 19A: Coding chain for HS-SCCH type 2
### 4.6A.2 HS-SCCH Type 2 information field mapping
##### 4.6A.2.1 The first transmission
When HS-SCCH_less_mode=1 for a UE (as defined in [4]), the first transmission
of an HS-DSCH transport block using CRC attachment method 2 shall be sent
without an associated HS-SCCH. In this case, the UE shall use the following
signalling values in order to attempt to decode the transport block:
\- Channelization-code-set information: _Configured by higher layers_
\- Modulation scheme information: _QPSK_
\- Transport-block size information: _Each of four possible sizes configured
by higher layers_
\- Redundancy and constellation version: X~rv~ _=0_ (see 4.6.2.1)
\- UE identity: _Configured by higher layers_
##### 4.6A.2.2 The second and the third transmissions
For HS-SCCH_less_mode=1 there are at maximum 3 transmissions for a HS-DSCH
transport block using CRC attachment method 2. The 2^nd^ and 3^rd^
transmissions of a transport block that was sent without an associated HS-SCCH
in the first transmission, as described in subclause 4.6A.2.1.1, are
associated with an HS-SCCH of type 2.
###### 4.6A.2.2.1 Special Information mapping
The Special Information type _x~type,1~, x~type,2~, ..., x~type,6~_ shall be
set to \'\'111110' to indicate HS-SCCH less operation.
The Special Information bits _x~info,1~, x~info,2~, ..., x~info,7~ are
comprised of:_
> \- Transport-block size information (2 bits): _x~info,1~, x~info,2~_ =
> _x~tbs,1~, x~tbs,2~_
>
> \- Pointer to the previous transmission (3 bits): _x~info,3~, x~info,4~,
> x~info,5~_ = _x~ptr,1~, x~ptr,2~, x~ptr,3~_
>
> \- Second or third transmission (1 bit): _x~info,6~_ = _x~sec,1~_
>
> \- Reserved (1 bit): _x~info,7~_ = _x~res,1~_
###### # 4.6A.2.2.1.1 Transport-block size information mapping
The Transport-block size information (2 bits) _x~tbs,1~, x~tbs,2~_ is the
unsigned binary representation of a reference to one of the four Transport-
block sizes and the associated number of HS-PDSCH codes for the first
transmission configured by higher layers.
* * *
x~tbs,1~, x~tbs,2~ **Entry in "Transport Block size list" as signalled in the
HS-SCCH-less Information of HS_SCCH_LESS_PARAMS [13]** \'\'00' 1^st^ entry
\'\'01' 2^nd^ entry \'\'10' 3^rd^ entry \'\'11' 4^th^ entry
* * *
###### # 4.6A.2.2.1.2 Pointer to the previous transmission mapping
Pointer to the previous transmission (3 bits) _x~ptr,1~, x~ptr,2~, x~ptr,3\ ~_
is the unsigned binary representation of s, such that the previous
transmission of the same transport block started (6+s) subframes before the
start of this transmission.
###### # 4.6A.2.2.1.3 Second or third transmission mapping
Second or Third transmission (1 bit) indicates whether this is the second or
third transmission.
If _x~sec,1~_ = _\'\'0'_ , this is a second transmission.
If _x~sec,1~_ = _\'\'1'_ , this is a third transmission.
###### 4.6A.2.2.2 Redundancy and Constellation Version mapping
The redundancy version X~rv~ for the second and third transmissions shall be
equal to 3 and 4 respectively, as defined in Table 13.
###### 4.6A.2.2.3 Modulation scheme mapping
The value of _x~ms,1~_ shall be set to \'\'0' (QPSK).
###### 4.6A.2.2.4 Channelization code-set mapping
The channelization code-set bits _x~ccs,1~, x~ccs,2~, ..., x~ccs,7~_ are coded
as per clause 4.6.2.3 where the value of P shall be set to either 1 or 2.
###### 4.6A.2.2.5 UE identity mapping
The UE identity is encoded as per clause 4.6.2.4.
### 4.6A.3 Multiplexing of HS-SCCH Type 2 information
The channelization-code-set information _x~ccs,1~, x~ccs,2~, ..., x~ccs,7~_
and modulation-scheme information _x~ms,1~_ are multiplexed together. This
gives a sequence of bits _x~1,1~, x~1,2~, ..., x~1,8~_ where
_x~1,i~ = x~ccs,i~ i=1,2,...,7_
_x~1,i~ = x~ms,i-7~ i=8_
The Special Information type _x~type,1~, x~type,2~, ..., x~type,6~_ , and
Special Information _x~info,1~, x~info,2~, x~info,3~, x~info,4~, x~info,5~,
x~info,6~, x~info,7~_ are multiplexed together. This gives a sequence of bits
_x~2,1~, x~2,2~, ..., x~2,13~_ where
_x~2,i~ = x~type,i~ i=1,2,...,6_
_x~2,i~ = x~info,i-6~ i=7,8,...,13_
### 4.6A.4 CRC attachment for HS-SCCH Type 2
The sequence of bits _y~1~, y~2~, ..., y~29~_ , is calculated according to
Clause 4.6.4.
### 4.6A.5 Channel coding for HS-SCCH Type 2
Channel coding is performed according to Clause 4.6.5.
### 4.6A.6 Rate matching for HS-SCCH Type 2
Rate matching is performed according to Clause 4.6.6.
### 4.6A.7 UE specific masking for HS-SCCH Type 2
The mask output bits _s~1,1~,s~1,2~...s~1,40~_ are calculated according to
Clause 4.6.7.
### 4.6A.8 Physical channel mapping for HS-SCCH Type 2
Physical channel mapping is performed according to Clause 4.6.8.
## 4.6B Coding for HS-SCCH type 3
### 4.6B.1 Overview
HS-SCCH type 3 is used when the UE is configured in MIMO mode. If one
transport block is transmitted on the associated HS-PDSCH(s) or an HS-SCCH
order is transmitted, the following information is transmitted by means of the
HS-SCCH type 3 physical channel:
\- Channelization-code-set information (7 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~_
\- Modulation scheme and number of transport blocks information (3 bits):
_x~ms,1~, x~ms,2~, x~ms,3~_
\- Precoding weight information (2 bits): _x~pwipb,1~, x~pwipb,2~_
\- Transport-block size information (6 bits): _x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6~_
\- Hybrid-ARQ process information (4 bits): _x~hap,1~, x~hap,2~, ...,
x~hap,4~_
\- Redundancy and constellation version (2 bits): _x~rvpb,1~, x~rvpb,2~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
For an HS-SCCH order,
\- x~ccs,1~, x~ccs,2~, ..., x~ccs,7~_,_ x~ms,1~, x~ms,2~, x~ms,3~_,_
x~pwipb,1~, x~pwipb,2~ shall be set to \'\'111000000000'
\- x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,4~ _shall be set to \'\'_ 1111 _'_
\- x~tbspb,5~_,_ x~tbspb,6~ _shall be set to_ x~eodt,1~, x~eodt,2~
\- x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~, x~rvpb,1~, x~rvpb,2~ _shall be set
to_ x~odt,1~, x~odt,2~, x~odt,3~_, x~ord,1~, x~or~_ ~d,2~, x~ord,3~
_where x~eodt,1~, x~eodt,2~_ , _x~odt,1~, x~odt,2~, x~odt,3~, x~ord,1~,
x~ord,2~, x~ord,3~ are defined in subclause 4.6C._
If two transport blocks are transmitted on the associated HS-PDSCHs (not
applicable when single-stream restriction is configured), the following
information is transmitted by means of the HS-SCCH type 3 physical channel:
\- Channelization-code-set information (7 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~_
\- Modulation scheme and number of transport blocks information (3 bits):
_x~ms,1~, x~ms,2~, x~ms,3~_
\- Precoding weight information for the primary transport block (2 bits):
_x~pwipb,1~, x~pwipb,2~_
\- Transport-block size information for the primary transport block (6 bits):
_x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~_
\- Transport-block size information for the secondary transport block (6
bits): _x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6~_
\- Hybrid-ARQ process information (4 bits): _x~hap,1~, x~hap,2~,..., x~hap,4~_
\- Redundancy and constellation version for the primary transport block (2
bits): _x~rvpb,1~, x~rvpb,2~_
\- Redundancy and constellation version for the secondary transport block (2
bits): _x~rvsb,1~, x~rvsb,2~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
Figure 19B below illustrates the overall coding chain for HS-SCCH type 3\.
Note that some information shown is not present if only one transport block is
transmitted on the associated HS-PDSCH(s).
Figure 19B: Coding chain for HS-SCCH type 3
### 4.6B.2 HS-SCCH type 3 information field mapping
#### 4.6B.2.1 Redundancy and constellation version coding
For each of the primary transport block and a secondary transport block if two
transport blocks are transmitted on the associated HS-PDSCH(s), the redundancy
version (RV) parameters _r_ , _s_ and constellation version parameter _b_ are
coded jointly to produce the values X~rvpb~ and X~rvsb~ respectively. The
transmitted sequences x~rvpb,1~, x~rvpb,2~ and x~rvsb,1~, x~rvsb,2~ are the
binary representations of X~rvpb~ and X~rvsb~, respectively, where x~rvpb,1~
and x~rvsb,1~ are the MSBs.
For the primary transport block if only one transport block is transmitted on
the associated HS-PDSCH(s), the redundancy version (RV) parameters _r_ , _s_
and constellation version parameter _b_ are coded jointly to produce the value
X~rvpb~. The transmitted sequence x~rvpb,1~, x~rvpb,2~ is the binary
representation of X~rvpb~, where x~rvpb,1~ is the MSB.
Joint coding of parameters _r_ , _s_ and constellation version parameter _b_
is done according to tables 13A and 13B according to the modulation mode used.
If X~rvpb~ = 0 or X~rvsb~ = 0, the UE shall treat the corresponding transport
block as an initial transmission.
Table 13A: RV coding for 16QAM and 64QAM for HS-SCCH type 3
* * *
**X~rvpb~ or X~rvsb~ (value)** **_N~sys~_ / _N~data~_ \ for the last four bits (code offset indicator) of which _x~ccs,4~_ is the
> MSB:
>
> _x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,7~_ = \|O-1-P/8 *15\|
Otherwise (i.e. if 64QAM is configured for the UE and _x~ms,1~, x~ms,2~,
x~ms,3~_ is equal to "101"),
> _P_ and _O_ shall fulfil \|O-1-P/8 *15\| mod 2 = (HS‑SCCH number) mod 2,
> and then
>
> _x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,dummy~_ = \|O-1-P/8 *15\|, where
> _x~ccs,dummy~_ is a dummy bit that is not transmitted on HS-SCCH.
Furthermore,
_x~ccs,7~_ = 0 if the modulation for the secondary transport block is QPSK,
and
_x~ccs,7~_ = 1 if the number of transport blocks = 1.
The definitions of P and O are given in [3]. The HS-SCCH number is given by
the position in the list of HS-SCCH Channelisation Code Informations signalled
by higher layers. The HS-SCCH number is associated with the code offset
indicator and code group indicator as described above if 64QAM is configured
for the UE and _x~ms,1~_ , _x~ms,2~_ , _x~ms,3~_ is equal to "101".
If two transport blocks are transmitted on the associated HS-PDSCH(s), the
same set of channelization codes shall be used for both transport blocks.
#### 4.6B.2.4 UE identity mapping
The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[13]. This is mapped such that x~ue,1~ corresponds to the MSB and x~ue,16~ to
the LSB, cf. [14].
#### 4.6B.2.5 HARQ process identifier mapping
If two transport blocks are transmitted on the associated HS-PDSCH(s), the
mapping relationship between the hybrid-ARQ processes and the transport blocks
is such that when the HARQ-process with identifier _HAP~pb~_ is mapped to the
primary transport block, the HARQ-process with the identifier given by $\left(
\text{HAP}_{\text{pb}} + N_{\text{proc}}/2 \right)\text{mod}\left(
N_{\text{proc}} \right)$ shall be mapped to the secondary transport block,
where _N~proc~_ is the number of HARQ processes configured by higher layers.
The combination of HARQ-processes is indicated by the hybrid-ARQ process
information (4 bits) _x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~_ which are the
unsigned binary representation of _HAP~pb~_ where _x~hap,1~_ is MSB.
If only one transport block is transmitted on the associated HS-PDSCH(s), the
above mapping is ignored and the hybrid-ARQ process information _x~hap,1~,
x~hap,2~, x~hap,3~, x~hap,4~_ is the unsigned binary representation of the
HARQ process identifier where _x~hap,1~_ is MSB.
#### 4.6B.2.6 Transport block size index mapping
The transport-block size information _x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6\
~_ is the unsigned binary representation of the transport block size index for
the primary transport block, where _x~tbspb,1~_ is the MSB.
If two transport blocks are transmitted on the associated HS-PDSCH(s), the
transport-block size information _x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6\ ~_
is the unsigned binary representation of the transport block size index for
the secondary transport block, where _x~tbssb,1~_ is the MSB.
#### 4.6B.2.7 Precoding Weight Information mapping
The precoding weight information for the primary transport block _x~pwipb,1~,
x~pwipb,2~_ is derived from the precoding weight factor w~2~ as defined in
[4], according to Table 14A.
Table 14A: Mapping of precoding weight information for primary transport block
* * *
w~2~ _x~pwipb,1~, x~pwipb,2~_ 00 01 10 11
* * *
### 4.6B.3 Multiplexing of HS-SCCH type 3 information
The channelization-code-set information _x~ccs,1~, x~ccs,2~, ..., x~ccs,7~,_
modulation-scheme and number of transport blocks information _x~ms,1~,
x~ms,2~, x~ms,3~_ and precoding weight information _x~pwipb,1~, x~pwipb,2~_
are multiplexed together. This gives a sequence of bits _x~1,1~, x~1,2~, ...,
x~1,12,~_ where
_x~1,i~ = x~ccs,i~ i=1,2,...,7_
_x~1,i~ = x~ms,i-7~ i=8,9,10_
_x~1,i~ = x~pwipb,i-10~ i=11,12_
If one transport block is transmitted on the associated HS-PDSCH(s), the
transport-block-size information _x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~_ ,
Hybrid-ARQ-process information _x~hap,1~,x~hap,2~, ..., x~hap,4~_ and
redundancy-version information _x~rvpb,1~, x~rvpb,2~_ are multiplexed
together. This gives a sequence of bits _x~2,1~, x~2,2~, ..., x~2,12~_ where
_x~2,i~ = x~tbs,i~ i=1,2,...,6_
_x~2,i~ = x~hap,i-6~ i=7,8,...,10_
_x~2,i~ = x~rv,i-10~ i=11,12_
If two transport blocks are transmitted on the associated HS-PDSCHs, the
transport-block-size information for the primary transport block _x~tbspb,1~,
x~tbspb,2~, ..., x~tbspb,6~_ , transport-block-size information for the
secondary transport block _x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6~_ , Hybrid-
ARQ-process information _x~hap,1~,x~hap,2~, ..., x~hap,4~_ , redundancy-
version information for the primary transport block _x~rvpb,1~, x~rvpb,2~_ ,
and redundancy-version information for the secondary transport block
_x~rvsb,1~, x~rvsb,2~_ are multiplexed together. This gives a sequence of bits
_x~2,1~, x~2,2~, ..., x~2,20~_ where
_x~2,i~ = x~tbspb,i~ i=1,2,...,6_
_x~2,i~ = x~tbssb,i-6~ i=7,8,...,12_
_x~2,i~ = x~hap,i-12~ i=13,14,...,16_
_x~2,i~ = x~rvpb,i-16~ i=17,18_
_x~2,i~ = x~rvsb,i-18~ i=19,20_
### 4.6B.4 CRC attachment for HS-SCCH type 3
If one transport block is transmitted on the associated HS-PDSCH(s), from the
sequence of bits _x~1,1~, x~1,2~, ..., x~1,12,~ x~2,1~, x~2,2~, ..., x~2,12~_
a 16-bit CRC is calculated according to Clause 4.2.1.1. This gives a sequence
of bits _c~1~, c~2~, ..., c~16\ ~_ where
$c_{k} = p_{\text{im}(\text{17} - k)}$ _k=1,2,...,16_
This sequence of bits is then masked with the UE Identity _x~ue,1~, x~ue,2~,
..., x~ue,16~_ and then appended to the sequence of bits _x~2,1~, x~2,2~, ...,
x~2,12~_ to form the sequence of bits _y~1~, y~2~, ..., y~28~_ , where
_y~i~ = x~2,i~ i=1,2,...,12_
_y~i~ =_ (_c~i-12~_ \+ _x~ue~_ ,~i-12~ ) mod 2 _i=13,14,...,28_
If two transport blocks are transmitted on the associated HS-PDSCHs, from the
sequence of bits _x~1,1~, x~1,2~, ..., x~1,12,~ x~2,1~, x~2,2~, ..., x~2,20~_
a 16-bit CRC is calculated according to Clause 4.2.1.1. This gives a sequence
of bits _c~1~, c~2~, ..., c~16\ ~_ where
$c_{k} = p_{\text{im}(\text{17} - k)}$ _k=1,2,...,16_
This sequence of bits is then masked with the UE Identity _x~ue,1~, x~ue,2~,
..., x~ue,16~_ and then appended to the sequence of bits _x~2,1~, x~2,2~, ...,
x~2,20~_ to form the sequence of bits _y~1~, y~2~, ..., y~36~_ , where
_y~i~ = x~2,i~ i=1,2,...,20_
_y~i~ =_ (_c~i-20~_ \+ _x~ue~_ ,~i-20~) mod 2 _i=21,22,...,36_
### 4.6B.5 Channel coding for HS-SCCH type 3
Rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is applied to
the sequence of bits x _~1,1~,x~1,2~, ...,x~1,12~_ ~.~ This gives a sequence
of bits _z~1,1~, z~1,2~, ..., z~1,60~_ ~.~
If one transport block is transmitted on the associated HS-PDSCH(s), rate 1/3
convolutional coding, as described in Clause 4.2.3.1, is applied to the
sequence of bits _y~1~, y~2~, ..., y~28~_ ~.~ This gives a sequence of bits
_z~2,1~, z~2,2~, ..., z~2,108~_ ~.~
If two transport blocks are transmitted on the associated HS-PDSCHs, rate 1/3
convolutional coding, as described in Clause 4.2.3.1, is applied to the
sequence of bits _y~1~, y~2~, ..., y~36~_ ~.~ This gives a sequence of bits
_z~2,1~, z~2,2~, ..., z~2,132~_ ~.~
Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.
### 4.6B.6 Rate matching for HS-SCCH type 3
From the input sequence _z~1,1~, z~1,2~, ..., z~1,\ 60~_ the bits _z~1,1~,
z~1,2~, z~1,4~, z~1,6~, z~1,8~, z~1,12~, z~1,15~, z~1,18~, z~1,21~, z~1,24~,
z~1,37~, z~1,40~, z~1,43~, z~1,46~, z~1,49~, z~1,53~, z~1,55~, z~1,57~,
z~1,59~, z~1,60~_ are punctured to obtain the output sequence
_r~1,1~,r~1,2~...r~1,40~._
If one transport block is transmitted on the associated HS-PDSCH(s), from the
input sequence _z~2,1~, z~2,2~, ..., z~2,108~_ the bits _z~2,1~, z~2,2~,
z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~, z~2,12~, z~2,14~, z~2,15~,
z~2,24~, z~2,42~, z~2,48~, z~2,63~, z~2,66~, z~2,93~, z~2,96~, z~2,98~,
z~2,99~, z~2,101~, z~2,102~, z~2,103~, z~2,104~, z~2,105~, z~2,106~, z~2,107~,
z~2,108~_ are punctured to obtain the output sequence
_r~2,1~,r~2,2~...r~2,80~_.
If two transport blocks are transmitted on the associated HS-PDSCHs, from the
input sequence _z~2,1~, z~2,2~, ..., z~2,132~_ the bits _z~2,1~, z~2,2~,
z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~, z~2,10~, z~2,11~, z~2,13~,
z~2,14~, z~2,16~, z~2,19~, z~2,22~, z~2,25~, z~2,28~, z~2,31~, z~2,34~,
z~2,37~, z~2,40~, z~2,43~, z~2,46~, z~2,49~, z~2,55~, z~2,61~, z~2,72~,
z~2,78~, z~2,84~, z~2,87~, z~2,90~, z~2,93~, z~2,96~, z~2,99~, z~2,102~ ,
z~2,105~, z~2,108~, z~2,111~, z~2,114~, z~2,117~, z~2,119~, z~2,120~,
z~2,122~, z~2,123~, z~2,125~, z~2,126~, z~2,127~, z~2,128~, z~2,129~,
z~2,130~, z~2,131~, z~2,132~_ are punctured to obtain the output sequence
_r~2,1~,r~2,2~...r~2,80~_.
### 4.6B.7 UE specific masking for HS-SCCH type 3
The output bits _s~1,1~,s~1,2~...s~1,40~_ are calculated as described in
subclause 4.6.7.
### 4.6B.8 Physical channel mapping for HS-SCCH type 3
The HS-SCCH sub-frame is described in [2]. The physical channel mapping is
carried out as described in subclause 4.6.8.
## 4.6C Coding for HS-SCCH orders
### 4.6C.1 Overview
HS-SCCH orders are commands sent to the UE using HS-SCCH. No HS-PDSCH is
associated with HS-SCCH orders.
The following information is transmitted by means of the HS-SCCH order
physical channel.
> \- Extended order type (2bits) _x~eodt,1~, x~eodt,2~_
\- Order type (3 bits): _x~odt,1~, x~odt,2~, x~odt,3~_
\- Order (3 bits): _x~ord,1~, x~ord,2~, x~ord,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The coding for HS-SCCH orders is specified in subclause 4.6.1 for a cell where
the UE is not configured in MIMO mode and not configured in MIMO mode with
four transmit antennas or if the UE is in CELL_FACH state and in subclause
4.6B.1 for a cell where the UE is configured in MIMO mode, in subclause 4.6D.1
for a cell where the UE is configured in MIMO mode with four transmit antennas
with the exception of HS-DSCH serving cell change order, which is always
transmitted using HS-SCCH type 1 specified in subclause 4.6.1.
### 4.6C.2 HS-SCCH Order information field mapping in the CELL_DCH state
#### 4.6C.2.1 Order type mapping
If the extended Order type _x~eodt,1~, x~eodt,2\ ~_ = '01' and the Order type
_x~odt,1~, x~odt,2~, x~odt,3~_ = _\'\'000'_ , then the mapping for _x~ord,1~,
x~ord,2~, x~ord,3~_ is according to subclause 4.6C.2.2.1.
If the extended Order type _x~eodt,1~, x~eodt,2\ ~_ = '01' and the Order type
_x~odt,1~, x~odt,2~, x~odt,3~_ = _\'\'011'_ , then the mapping for _x~ord,1~,
x~ord,2~, x~ord,3~_ is according to subclause 4.6C.2.2.3.
If the extended Order type _x~eodt,1~, x~eodt,2\ ~_ = '11' and the Order type
_x~odt,1~, x~odt,2~, x~odt,3~_ = _\'\'010'_ , then the mapping for _x~ord,1~,
x~ord,2~, x~ord,3~_ is according to subclause 4.6C.2.2.4.
If the extended Order type _xeodt,1, xeodt,2_ = \"11\" and the Order type
_xodt,1, xodt,2, xodt,3_ = _\'\'011\"_ , then the mapping for
_x~ord,1~,x~ord,2~, x~ord,3~_ is according to subclause 4.6C.2.2.5.
Otherwise the mapping for _x~eodt,1~ , x~eodt,2~,_ _x~odt,1~, x~odt,2~,
x~odt,3~_ , _x~ord,1~, x~ord,2~, x~ord,3~_ is according to subclause
4.6C.2.2.2.
#### 4.6C.2.2 Order mapping
##### 4.6C.2.2.1 Orders for activation and deactivation of DTX, DRX and HS-
SCCH-less operation and for HS-DSCH serving cell change
If the order is transmitted from the serving HS-DSCH cell or a secondary
serving HS-DSCH cell, for this Order type, _x~ord,1~, x~ord,2~, x~ord,3~_ is
comprised of:
> \- DRX activation (1 bit): _x~ord,1~_ = _x~drx,1~_
>
> \- DTX activation (1 bit): _x~ord,2~_ = _x~dtx,1~_
>
> \- HS-SCCH-less operation activation (1 bit): _x~ord,3~_ = _x~hs-scch-
> less,1~_
If _x~drx,1~_ = _\'\'0'_ , then the HS-SCCH order is a DRX De-activation
order.
If _x~drx,1~_ = _\'\'1'_ , then the HS-SCCH order is a DRX Activation order.
If _x~dtx,1~_ = _\'\'0'_ , then the HS-SCCH order is a DTX De-activation
order.
If _x~dtx,1~_ = _\'\'1'_ , then the HS-SCCH order is a DTX Activation order.
If _x~hs-scch-less,1~_ = _\'\'0'_ , then the HS-SCCH order is a HS-SCCH-less
operation De-activation order.
If _x~hs-scch-less,1~_ = _\'\'1'_ , then the HS-SCCH order is a HS-SCCH-less
operation Activation order.
If the order is transmitted from a non-serving cell using HS-SCCH type 1
specified in subclause 4.6.1 and _x~ord,1~, x~ord,2~, x~ord,3~_ = _\'\'000'_ ,
then it is an HS-DSCH serving cell change order .
_x~drx,1~, x~dtx,1~_ = _\'\'10'_ is a reserved combination (not used in this
release).
##### 4.6C.2.2.2 Orders for activation and deactivation of Secondary serving
HS-DSCH cells and Secondary uplink frequency
For these Extended Order types and Order types, the meaning of the orders is
listed in Table 14B for the case where Secondary_Cell_Enabled is less than 4.
For the case where Secondary_Cell_Enabled is greater than 3 the meaning of the
orders is listed in Table 14B.1.
When Secondary_Cell_Enabled is 1,
\- the order type _x~odt,1~_ , _x~odt,2~_ , _x~odt,3~_ = \'010' is unused;
\- regardless of the signaled value of _x~ord,1~_ the UE shall assume
_x~ord,1~_ = _\'0'_ ;
_\- x~ord,2~_ , _x~ord,3~_ = _\'\'10'_ is an unused combination.
When the UE is configured in Multiflow mode the following exceptions to the
definitions in table 14B apply:
\- For the orders received from the Serving or the Secondary Serving HS-DSCH
cell, the UE shall consider the 1^st^ Secondary Serving cell to refer to the
Secondary Serving HS-DSCH cell and apply the received order to that cell. The
activation status of all other cells shall remain unchanged.
\- For the orders received from the Assisting Serving or Assisting Secondary
Serving HS-DSCH cell the UE shall consider the 1^st^ Secondary Serving cell to
refer to the Assisting Secondary Serving HS-DSCH cell and apply the received
order to that cell. The activation status of all other cells shall remain
unchanged.
\- For the orders received from the Assisting Serving or Assisting Secondary
Serving HS-DSCH cell the UE shall ignore activation status related to the
Secondary Uplink Frequency and maintain the activation status of the Secondary
Uplink Frequency unchanged.
\- The order contents related to the 2^nd^ and 3^rd^ Secondary Serving HS-DSCH
cells shall be ignored.
Table 14B: Orders for activation and deactivation of Secondary serving HS-DSCH
cells and Secondary uplink frequency when Secondary_Cell_Enabled is less than
4, or when the UE is configured in Multiflow mode.
* * *
Extended Order Type Order Type Order Mapping Activation Status of Secondary
Serving HS-DSCH cells and Secondary Uplink Frequency A= Activate; D = De-
activate  
x~eodt,1~, x~eodt,2~ _x~odt,1~, x~odt,2~, x~odt,3~_ _x~ord,1~_ _x~ord,2~_
_x~ord,3~_ **1^st^ Secondary Serving HS-DSCH cell** **2^nd^ Secondary Serving
HS-DSCH cell** **3^rd^ Secondary Serving HS-DSCH cell** **Secondary Uplink
Frequency** 01 001 0 0 0 D D D D 0 0 1 A D D D 0 1 1 A D D A 0 1 0 D A D D 1 0
0 A A D D 1 0 1 A A D A 1 1 0 D D A D 1 1 1 A D A D 010 0 0 0 A D A A 0 0 1 D
A A D 0 1 0 A A A D 0 1 1 A A A A 1 0 0 Unused (Reserved)  
1 0 1 Unused (Reserved)  
1 1 0 Unused (Reserved)  
1 1 1 Unused (Reserved)
* * *
Table 14B.1: Orders for activation and deactivation of Secondary serving HS-
DSCH cells and Secondary uplink frequency when Secondary_Cell_Enabled is
greater than 3.
* * *
Extended Order Type Order Type Order Mapping Activation Status of Secondary
Serving HS-DSCH cells and Secondary Uplink Frequency A= Activate; D = De-
activate  
x~eodt,,1~ x~eodt,,2~ _x~odt,1~, x~odt,2~, x~odt,3~_ _x~ord,1~_ _x~ord,2~_
_x~ord,3~_ **1^st^ Sec Serving HS-DSCH cell** **2^nd^ Sec Serving HS-DSCH
cell** **3^rd^ Sec Serving HS-DSCH cell** **4^th^ Sec Serving HS-DSCH cell**
**5^th^ Sec Serving HS-DSCH cell** **6^th^ Sec Serving HS-DSCH cell** **7^th^
Sec Serving HS-DSCH cell** **Sec Uplink Freq** 00 000 0 0 0 A D A D A D A A  
0 0 1 D A A D A D A D  
0 1 1 A A A D A D A A  
0 1 0 A A A D A D A D  
1 0 0 D D D A A D A D  
1 0 1 A D D A A D A D  
1 1 0 D A D A A D A D  
1 1 1 A D D A A D A A  
00 001 0 0 0 A A D A A D A D  
0 0 1 A A D A A D A A  
0 1 1 A D A A A D A D  
0 1 0 D D A A A D A D  
1 0 0 A D A A A D A A  
1 0 1 D A A A A D A D  
1 1 0 A A A A A D A D  
1 1 1 A A A A A D A A  
00 010 0 0 0 D D D D D A A D  
0 0 1 A D D D D A A D  
0 1 1 A D D D D A A A  
0 1 0 D A D D D A A D  
1 0 0 A A D D D A A D  
1 0 1 A A D D D A A A  
1 1 0 D D A D D A A D  
1 1 1 A D A D D A A D  
00 011 0 0 0 A D A D D A A A  
0 0 1 D A A D D A A D  
0 1 1 A A A D D A A A  
0 1 0 A A A D D A A D  
1 0 0 D D D A D A A D  
1 0 1 A D D A D A A D  
1 1 0 D A D A D A A D  
1 1 1 A D D A D A A A  
00 100 0 0 0 A A D A D A A D  
0 0 1 A A D A D A A A  
0 1 1 A D A A D A A D  
0 1 0 D D A A D A A D  
1 0 0 A D A A D A A A  
1 0 1 D A A A D A A D  
1 1 0 A A A A D A A D  
1 1 1 A A A A D A A A  
00 101 0 0 0 D D D D A A A D  
0 0 1 A D D D A A A D  
0 1 1 A D D D A A A A  
0 1 0 D A D D A A A D  
1 0 0 A A D D A A A D  
1 0 1 A A D D A A A A  
1 1 0 D D A D A A A D  
1 1 1 A D A D A A A D  
00 110 0 0 0 A D A D A A A A  
0 0 1 D A A D A A A D  
0 1 1 A A A D A A A A  
0 1 0 A A A D A A A D  
1 0 0 D D D A A A A D  
1 0 1 A D D A A A A D  
1 1 0 D A D A A A A D  
1 1 1 A D D A A A A A  
00 111 0 0 0 A A D A A A A D  
0 0 1 A A D A A A A A  
0 1 1 A D A A A A A D  
0 1 0 D D A A A A A D  
1 0 0 A D A A A A A A  
1 0 1 D A A A A A A D  
1 1 0 A A A A A A A D  
1 1 1 A A A A A A A A  
01 001 0 0 0 D D D D D D D D  
0 0 1 A D D D D D D D  
0 1 1 A D D D D D D A  
0 1 0 D A D D D D D D  
1 0 0 A A D D D D D D  
1 0 1 A A D D D D D A  
1 1 0 D D A D D D D D  
1 1 1 A D A D D D D D  
01 010 0 0 0 A D A D D D D A  
0 0 1 D A A D D D D D  
0 1 1 A A A D D D D A  
0 1 0 A A A D D D D D  
1 0 0 D D D A D D D D  
1 0 1 A D D A D D D D  
1 1 0 D A D A D D D D  
1 1 1 A D D A D D D A  
01 100 0 0 0 D D D D A D D D  
0 0 1 A D D D A D D D  
0 1 1 A D D D A D D A  
0 1 0 D A D D A D D D  
1 0 0 A A D D A D D D  
1 0 1 A A D D A D D A  
1 1 0 D D A D A D D D  
1 1 1 A D A D A D D D  
01 101 0 0 0 A D A D A D D A  
0 0 1 D A A D A D D D  
0 1 1 A A A D A D D A  
0 1 0 A A A D A D D D  
1 0 0 D D D A A D D D  
1 0 1 A D D A A D D D  
1 1 0 D A D A A D D D  
1 1 1 A D D A A D D A  
01 110 0 0 0 A A D A A D D D  
0 0 1 A A D A A D D A  
0 1 1 A D A A A D D D  
0 1 0 D D A A A D D D  
1 0 0 A D A A A D D A  
1 0 1 D A A A A D D D  
1 1 0 A A A A A D D D  
1 1 1 A A A A A D D A  
01 111 0 0 0 D D D D D A D D  
0 0 1 A D D D D A D D  
0 1 1 A D D D D A D A  
0 1 0 D A D D D A D D  
1 0 0 A A D D D A D D  
1 0 1 A A D D D A D A  
1 1 0 D D A D D A D D  
1 1 1 A D A D D A D D  
10 000 0 0 0 A D A D D A D A  
0 0 1 D A A D D A D D  
0 1 1 A A A D D A D A  
0 1 0 A A A D D A D D  
1 0 0 D D D A D A D D  
1 0 1 A D D A D A D D  
1 1 0 D A D A D A D D  
1 1 1 A D D A D A D A  
10 001 0 0 0 A A D A D A D D  
0 0 1 A A D A D A D A  
0 1 1 A D A A D A D D  
0 1 0 D D A A D A D D  
1 0 0 A D A A D A D A  
1 0 1 D A A A D A D D  
1 1 0 A A A A D A D D  
1 1 1 A A A A D A D A  
10 010 0 0 0 D D D D A A D D  
0 0 1 A D D D A A D D  
0 1 1 A D D D A A D A  
0 1 0 D A D D A A D D  
1 0 0 A A D D A A D D  
1 0 1 A A D D A A D A  
1 1 0 D D A D A A D D  
1 1 1 A D A D A A D D  
10 011 0 0 0 A D A D A A D A  
0 0 1 D A A D A A D D  
0 1 1 A A A D A A D A  
0 1 0 A A A D A A D D  
1 0 0 D D D A A A D D  
1 0 1 A D D A A A D D  
1 1 0 D A D A A A D D  
1 1 1 A D D A A A D A  
10 100 0 0 0 A A D A A A D D  
0 0 1 A A D A A A D A  
0 1 1 A D A A A A D D  
0 1 0 D D A A A A D D  
1 0 0 A D A A A A D A  
1 0 1 D A A A A A D D  
1 1 0 A A A A A A D D  
1 1 1 A A A A A A D A  
10 101 0 0 0 D D D D D D A D  
0 0 1 A D D D D D A D  
0 1 1 A D D D D D A A  
0 1 0 D A D D D D A D  
1 0 0 A A D D D D A D  
1 0 1 A A D D D D A A  
1 1 0 D D A D D D A D  
1 1 1 A D A D D D A D  
10 110 0 0 0 A D A D D D A A  
0 0 1 D A A D D D A D  
0 1 1 A A A D D D A A  
0 1 0 A A A D D D A D  
1 0 0 D D D A D D A D  
1 0 1 A D D A D D A D  
1 1 0 D A D A D D A D  
1 1 1 A D D A D D A A  
10 111 0 0 0 A A D A D D A D  
0 0 1 A A D A D D A A  
0 1 1 A D A A D D A D  
0 1 0 D D A A D D A D  
1 0 0 A D A A D D A A  
1 0 1 D A A A D D A D  
1 1 0 A A A A D D A D  
1 1 1 A A A A D D A A  
11 000 0 0 0 D D D D A D A D  
0 0 1 A D D D A D A D  
0 1 1 A D D D A D A A  
0 1 0 D A D D A D A D  
1 0 0 A A D D A D A D  
1 0 1 A A D D A D A A  
1 1 0 D D A D A D A D  
1 1 1 A D A D A D A D  
11 001 0 0 0 A A D A D D D D  
0 0 1 A A D A D D D A  
0 1 1 A D A A D D D D  
0 1 0 D D A A D D D D  
1 0 0 A D A A D D D A  
1 0 1 D A A A D D D D  
1 1 0 A A A A D D D D  
1 1 1 A A A A D D D A
* * *
##### 4.6C.2.2.3 Orders for Switching between Uplink Closed Loop Transmit
Diversity Activation states
For this Order type, the meaning of the orders is listed in Table 14B.2.
When the UE is configured in Multiflow mode, if any of the orders related to
uplink CLTD activation states as defined in Table 14B.2 are received from the
Assisting Serving or Assisting Secondary Serving HS-DSCH cell, then the UE
shall ignore the orders and maintain the uplink CLTD activation state
unchanged.
Table 14B.2: Orders for UE when UL_CLTD_Enabled is TRUE
* * *
Extended Order Type **Order Type** **Order Mapping** **Activation States\  
A= Activate; D = De-activate**
x~eodt,1~, x~eodt,2~ _x~odt,1~, x~odt,2~, x~odt,3~_ _x~ord,1~_ _x~ord,2~_
_x~ord,3~_ **1** **2** **3**
                                                                                                                            **Tx on Antenna 1 and Antenna 2 with Beamforming (Note 1)**   **Single Tx on Antenna 1 with no S-DPCCH**   **Single Tx on Antenna 2 with no S-DPCCH**
01 011 1 1 1 A D D
                                                          0                   0                                1            D                                                             A                                            D
                                                          0                   1                                0            D                                                             D                                            A
                                                          1                   0                                1            Unused (Reserved)
                                                          1                   1                                0            Unused (Reserved)
                                                          0                   0                                0            Unused (Reserved)
                                                          0                   1                                1            Unused (Reserved)
                                                          1                   0                                0            Unused (Reserved)
* * *
Note 1: The precoding weights for beamforming are defined in [4].
##### 4.6C.2.2.4 Orders for activating and de-activating demodulation common
pilots (D-CPICH) when the UE is configured in MIMO mode with four transmit
antennas
For this Order type, the meaning of the orders is listed in Table 14B.3.
Table 14B.3: Orders when the UE is configured in MIMO mode with four transmit
antennas
* * *
Extended Order Type Order Type Order Mapping D-CPICH Activation States\  
A= Activate; D = De-activate
x~eodt,1~, x~eodt,2~ _x~odt,1~, x~odt,2~, x~odt,3~_ _x~ord,1~_ _x~ord,2~_
_x~ord,3~_
11 010 1 1 1 **A**
                                                          0               0                              0            **D**
                                                          0               0                              1            Unused (Reserved)
                                                          0               1                              0            Unused (Reserved)
                                                          0               1                              1            Unused (Reserved)
                                                          1               0                              0            Unused (Reserved)
                                                          1               0                              1            Unused (Reserved)
                                                          1               1                              0            Unused (Reserved)
* * *
Note 1: The activation and de-activation status corresponds to individual HS-
DSCH cell.
Note 2: Activation and de-activation indication applies for all the
demodulation common pilots configured in the cell.
##### 4.6C.2.2.5 Orders for switching the E-DCH TTI, and for start/stop a
simplified HS-SCCH type 1 transmission interval
If the order is transmitted from the serving HS-DSCH cell or a secondary
serving HS-DSCH cell, for this Order type, the meaning of the orders for
single cell E-DCH is listed in Table 14B.3A and the meaning of the orders for
dual cell E-DCH is listed in Table 14B.3B.
Table 14B.3A: Orders for switching the E-DCH TTI for single cell E-DCH and for
start/stop a simplified HS-SCCH type 1 transmission interval
* * *
Extended\ Order Type Order Mapping Interpretation  
Order Type
x~eodt,1~, x~eodt,2~ x~odt,1~, x~odt,2~, x~odt,3~ x~ord,1~ x~ord,2~ x~ord,3~
11 011 0 0 0 TTI switch order from 2ms to 10ms
                                                        0               0                1          TTI switch order from 10ms to 2ms
                                                        0               1                0          Start simplified HS-SCCH type 1 transmission interval order
                                                        0               1                1          Stop simplified HS-SCCH type 1 transmission interval order
                                                        1               0                0          Unused (Reserved) for single cell E-DCH
                                                        1               0                1          Unused (Reserved) for single cell E-DCH
                                                        1               1                0          Unused (Reserved) for single cell E-DCH
                                                        1               1                1          Unused (Reserved) for single cell E-DCH
* * *
Table 14B.3B: Orders for switching the E-DCH TTI for dual cell E-DCH
* * *
Extended\ Order Type Order Mapping Interpretation  
Order Type
x~eodt,1~, x~eodt,2~ x~odt,1~, x~odt,2~, x~odt,3~ x~ord,1~ x~ord,2~ x~ord,3~
11 011 0 0 0 Unused (Reserved for dual cell E-DCH)
                                                        0               0                1          Unused (Reserved for dual cell E-DCH)
                                                        0               1                0          TTI switch order to 2ms+10ms
                                                        0               1                1          TTI switch order to 10ms+2ms
                                                        1               0                0          TTI switch order to 2ms+2ms
                                                        1               0                1          TTI switch order to 10ms+10ms
                                                        1               1                0          Unused (Reserved for dual cell E-DCH)
                                                        1               1                1          Unused (Reserved for dual cell E-DCH)
* * *
NOTE 1: (Table 14B.3B): For the TTI switch orders the TTI length displayed on
the left hand side applies to the primary uplink frequency, while the TTI
length displayed on the right hand side applies to the secondary uplink
frequency.
NOTE 2: (Table 14B.3B): The TTI switch orders also apply if the secondary
uplink frequency is deactivated, but it becomes effective on the secondary
uplink frequency upon its re-activation.
#### 4.6C.2.3 UE identity mapping
The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[13]. This is mapped such that x~ue,1~ corresponds to the MSB and x~ue,16~ to
the LSB, cf. [14].
### 4.6C.3 HS-SCCH order information field mapping in the CELL_FACH and
CELL_PCH states
#### 4.6C.3.1 Order type mapping
If the extended Order type _x~eodt,1~, x~eodt,2\ ~_ = '01' and the Order type
_x~odt,1~, x~odt,2~, x~odt,3~_ = _\'\'000'_ , then the mapping for _x~ord,1~,
x~ord,2~, x~ord,3~_ is according to subclause 4.6C.3.2.
#### 4.6C.3.2 Order mapping
##### 4.6C.3.2.1 Orders for network triggered HS-DPCCH transmission
For this Order type, the Order mapping _x~ord,1~, x~ord,2~, x~ord,3~_ and the
associated meaning is as follows:
If _x~ord,1~, x~ord,2~, x~ord,3~_ = _\'\'001'_ , then the HS-SCCH order is an
order for triggering the random access procedure in CELL_FACH as specified in
subclause 6.1A in [4].
##### 4.6C.3.2.2 Orders for HS-DSCH reception during CELL_FACH HS-SCCH DRX
operation
For this Order type, the Order mapping _x~ord,1~, x~ord,2~, x~ord,3~_ and the
associated meaning is as follows:
If _x~ord,1~, x~ord,2~, x~ord,3~_ = _\'\'110"_ then the HS-SCCH order is an
order for notifying about an HS-DSCH transmission during CELL_FACH HS-SCCH DRX
operation as specified in [4] subclause 6A.1.3.2.
## 4.6D Coding for HS-SCCH type 4
### 4.6D.1 Overview
HS-SCCH type 4 is used when the UE is configured in MIMO mode with four
transmit antennas. If one transport block is transmitted on the associated HS-
PDSCH(s) or an HS-SCCH order is transmitted, the following information is
transmitted by means of the HS-SCCH type 4 physical channel:
\- Channelization-code-set information (7 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~_
\- Modulation scheme and number of transport blocks information (5 bits):
_x~ms,1~, x~ms,2~, x~ms,3,~ x~ms,4~, x~ms,5~_
\- Precoding weight information (4 bits): _x~pwipb,1~, x~pwipb,2,~ x~pwipb,3~,
x~pwipb,4~_
\- Transport-block size information (6 bits): _x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6~_
\- Hybrid-ARQ process information (4 bits): _x~hap,1~, x~hap,2~, ...,
x~hap,4~_
\- Redundancy and constellation version (2 bits): _x~rvpb,1~, x~rvpb,2~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
For an HS-SCCH order,
\- x~ccs,1~, x~ccs,2~, ..., x~ccs,7~_,_ x~ms,1~, x~ms,2~, x~ms,3~, x~ms,4,~
x~ms,5~_,_ x~pwipb,1~, x~pwipb,2,~ x~pwipb,3~, x~pwipb,4~ shall be set to
\'\'1110000000000000'
\- x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,4~ _shall be set to \'\'_ 1111 _'_
\- x~tbspb,5~_,_ x~tbspb,6~ _shall be set to_ x~eodt,1~, x~eodt,2~
\- x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~, x~rvpb,1~, x~rvpb,2~ _shall be set
to_ x~odt,1~, x~odt,2~, x~odt,3~_, x~ord,1~, x~or~_ ~d,2~, x~ord,3~
_where x~eodt,1~, x~eodt,2~_ , _x~odt,1~, x~odt,2~, x~odt,3~, x~ord,1~,
x~ord,2~, x~ord,3~ are defined in subclause 4.6C._
If more than one transport block is transmitted on the associated HS-PDSCHs,
the following information is transmitted by means of the HS-SCCH type 4
physical channel:
\- Channelization-code-set information (7 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~_
\- Modulation scheme and number of transport blocks information (5 bits):
_x~ms,1~, x~ms,2~, x~ms,3,~ x~ms,4~, x~ms,5~_
\- Precoding weight information (4 bits): _x~pwipb,1~, x~pwipb,2,~ x~pwipb,3~,
x~pwipb,4~_
\- Transport-block size information for the primary or/and fourth transport
block (6 bits): _x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~_
\- Transport-block size information for the second or/and third transport
block (6 bits): _x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6~_
\- Hybrid-ARQ process information (4 bits): _x~hap,1~, x~hap,2~,..., x~hap,4~_
\- Redundancy and constellation version for the primary or/and fourth
transport block (2 bits): _x~rvpb,1~, x~rvpb,2~_
\- Redundancy and constellation version for the second or/and third transport
block (2 bits): _x~rvsb,1~, x~rvsb,2~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The overall coding chain for HS-SCCH type 4 is same as that of HS-SCCH type 3
as shown in Figure 19 B.
### 4.6D.2 HS-SCCH type 4 information field mapping
#### 4.6D.2.1 Redundancy and constellation version coding
If four transport blocks are transmitted on the associated HS-PDSCH(s), the
redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are coded jointly to produce the values X~rvpb~ for the primary
and the fourth transport blocks and X~rvsb~ for the second and the third
transport blocks respectively. The transmitted sequences x~rvpb,1~, x~rvpb,2~
and x~rvsb,1~, x~rvsb,2~ are the binary representations of X~rvpb~ and
X~rvsb~, respectively, where x~rvpb,1~ and x~rvsb,1~ are the MSBs.
If three transport blocks are transmitted on the associated HS-PDSCH(s), the
redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are coded jointly to produce the values X~rvpb~ for the primary
transport block and X~rvsb~ for the second and the third transport blocks
respectively. The transmitted sequences x~rvpb,1~, x~rvpb,2~ and x~rvsb,1~,
x~rvsb,2~ are the binary representations of X~rvpb~ and X~rvsb~, respectively,
where x~rvpb,1~ and x~rvsb,1~ are the MSBs.
For each of the primary transport block and a second transport block if two
transport blocks are transmitted on the associated HS-PDSCH(s), the redundancy
version (RV) parameters _r_ , _s_ and constellation version parameter _b_ are
coded jointly to produce the values X~rvpb~ and X~rvsb~ respectively. The
transmitted sequences x~rvpb,1~, x~rvpb,2~ and x~rvsb,1~, x~rvsb,2~ are the
binary representations of X~rvpb~ and X~rvsb~, respectively, where x~rvpb,1~
and x~rvsb,1~ are the MSBs.
For the primary transport block if only one transport block is transmitted on
the associated HS-PDSCH(s), the redundancy version (RV) parameters _r_ , _s_
and constellation version parameter _b_ are coded jointly to produce the value
X~rvpb~. The transmitted sequence x~rvpb,\ 1~, x~rvpb,\ 2~ is the binary
representation of X~rvpb~, where x~rvpb,1~ is the MSB.
Joint coding of parameters _r_ , _s_ and constellation version parameter _b_
is done according to tables 14B.4 and 14B.5 according to the modulation mode
used. If X~rvpb~ = 0 or X~rvsb~ = 0, the UE shall treat the corresponding
transport block as an initial transmission.
Table 14B.4: RV coding for 16QAM and 64QAM for HS-SCCH type 4
* * *
**X~rvpb~ or X~rvsb~ (value)** **_N~sys~_ / _N~data~_ \ Figure 20C.1: Construction of composite NTBP/PCI/CQI for Type A CQI report
In case a type A CQI shall be reported, the number of transport blocks
preferred bits ri~0~ ,ri~1~, precoding control indication bits pci~0~ ,
pci~1,~ pci~2,~ pci~3~, and the channel quality indication bits cqi~0~ ,
cqi~1~ , cqi~2~ , cqi~3~ , cqi~4~, cqi~5~, cqi~6~, cqi~7~ are concatenated to
the composite number of transport blocks preferred, precoding control
indication and channel quality indication bits according to the relation
For type B CQI report the composite PCI/CQI shall be constructed according to
the scheme depicted in Figure 20C.2.
> Figure 20C.2: Construction of composite NTBP/PCI/CQI for Type B CQI report
In case a type B CQI shall be reported, the precoding control indication bits
pci~0~ , pci~1,~ pci~2,~ pci~3~, and the channel quality indication bits
cqi~0~ , cqi~1~ , cqi~2~ , cqi~3~ , cqi~4~ are concatenated to the composite
precoding control indication and channel quality indication bits according to
the relation
##### 4.7.3E.1.2.6 Channel coding for composite number of transport blocks
preferred, precoding control indication and channel quality indication bits
{#e.1.2.6-channel-coding-for-composite-number-of-transport-blocks-preferred-
precoding-control-indication-and-channel-quality-indication-bits .H6}
In case a type A CQI needs to be reported, rate 1/2 convolutional coding, as
described in Clause 4.2.3.1 is applied to the sequence of bits _a~0~_ , _a~1~_
, ..., _a~13~_ , resulting in the sequence of bits _d~0~_ , _d~1~_ , ...,
_d~43~_.
Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.
In case a type B CQI needs to be reported, rate 1/3 convolutional coding, as
described in Clause 4.2.3.1 is applied to the sequence of bits _a~0~_ , _a~1~_
, ..., _a~8~_ , resulting in the sequence of bits _d~0~_ , _d~1~_ , ...,
_d~50~_.
Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.
##### 4.7.3E.1.2.7 Rate matching for composite number of transport blocks
preferred, precoding control indication and channel quality indication bits
{#e.1.2.7-rate-matching-for-composite-number-of-transport-blocks-preferred-
precoding-control-indication-and-channel-quality-indication-bits .H6}
In case a type A CQI needs to be reported, from the input sequence _d~0~_ ,
_d~1~_ , ..., _d~43\ ~_ the bits _d~0~_ , _d~2~_ , _d~41~_ , _d~43~_ are
punctured to obtain the output sequence b~0~, b~1~, ..., b~39~ .
In case a type B CQI needs to be reported, from the input sequence _d~0~_ ,
_d~1~_ , ..., _d~50\ ~_ the bits _d~0~_ , _d~2~_ , _d~3~_ , _d~4~_ , _d~6~_ ,
_d~44~_ , _d~45~_ , _d~46~_ , _d~47~_ , _d~48~_ , _d~50~_ are punctured to
obtain the output sequence b~0~, b~1~, ..., b~39~ .
#### 4.7.3E.2 Channel coding for HS-DPCCH when the UE is configured in MIMO
mode with four transmit antennas in any cell and Secondary_Cell_Enabled is 1
Two forms of channel coding are used, one for the composite number of
transport blocks preferred (NTBP), precoding control indication (PCI) and
channel quality indication (CQI) and another for HARQ-ACK (acknowledgement).
##### 4.7.3E.2.1 Channel coding for the composite HS-DPCCH HARQ-ACK
The HARQ acknowledgement message associated with a cell for which the UE is
configured in MIMO mode with four transmit antennas shall be coded to 10 bits
as in Table 15C.3B in subclause 4.7.3E.1.1.
The HARQ acknowledgement message associated with a cell for which the UE is
configured in MIMO mode shall be coded to 10 bits as in Table 15B in subclause
4.7.3.1.
The HARQ acknowledgement message associated with a cell for which the UE is
configured not in MIMO mode and not in MIMO mode with four transmit antennas
shall be coded to 10 bits as specified in Table 15 in subclause 4.7.2.
The HARQ acknowledgement messages corresponding to the serving HS-DSCH cell
and secondary serving HS-DSCH cell in that order are encoded and concatenated
into the same slot according to Figure 20D in clause 4.7.4.1.
##### 4.7.3E.2.2 Channel coding for HS-DPCCH composite number of transport
blocks preferred, precoding control indication and channel quality indication
The channel coding for NTBP, PCI and CQI associated with a cell for which the
UE is configured in MIMO mode with four transmit antennas is specified in
subclause 4.7.3E.1.2.
The channel coding for PCI and CQI associated with a cell for which the UE is
configured in MIMO mode is specified in subclause 4.7.3.2.
The channel coding for CQI associated with a cell for which the UE is
configured not in MIMO mode and not in MIMO mode with four transmit antennas
is specified in subclause 4.7.2.2.
#### 4.7.3E.3 Channel coding for HS-DPCCH when the UE is configured in MIMO
mode with four transmit antennas in any cell and Secondary_Cell_Enabled is 2
Two forms of channel coding are used, one for the composite number of
transport blocks preferred (NTBP), precoding control indication (PCI) and
channel quality indication (CQI) and another for HARQ-ACK (acknowledgement).
##### 4.7.3E.3.1 Channel coding for the composite HS-DPCCH HARQ-ACK
The HARQ acknowledgement message associated with a cell for which the UE is
configured in MIMO mode with four transmit antennas shall be coded to 10 bits
as in Table 15C.3B in subclause 4.7.3E.1.1.
The HARQ acknowledgement message associated with a cell for which the UE is
configured in MIMO mode shall be coded to 10 bits as in Table 15B in subclause
4.7.3.1.
The HARQ acknowledgement message associated with a cell for which the UE is
not configured in MIMO mode and not configured in MIMO mode with four transmit
antennas shall be coded to 10 bits as specified in Table 15 in subclause
4.7.2.
The HARQ acknowledgement messages corresponding to the serving HS-DSCH cell
and 1^st^ secondary serving HS-DSCH cell in that order are encoded and
concatenated into the same slot according to Figure 20D in clause 4.7.4.1.
##### 4.7.3E.3.2 Channel coding for HS-DPCCH composite number of transport
blocks preferred, precoding control indication and channel quality indication
The channel coding for NTBP, PCI and CQI associated with a cell for which the
UE is configured in MIMO mode with four transmit antennas is specified in
subclause 4.7.3E.1.2.
The channel coding for PCI and CQI associated with a cell for which the UE is
configured in MIMO mode is specified in subclause 4.7.3.2.
The channel coding for PCI and CQI associated with a cell for which the UE is
configured not in MIMO mode and not in MIMO mode with four transmit antennas
is specified in subclause 4.7.2.2.
#### 4.7.3E.4 Channel coding for HS-DPCCH when the UE is configured in MIMO
mode with four transmit antennas in any cell and Secondary_Cell_Enabled is 3
Two forms of channel coding are used, one for the composite number of
transport blocks preferred (NTBP), precoding control indication (PCI) and
channel quality indication (CQI) and another for HARQ-ACK (acknowledgement).
##### 4.7.3E.4.1 Channel coding for the composite HS-DPCCH HARQ-ACK
The HARQ acknowledgement message associated with a cell for which the UE is
configured in MIMO mode with four transmit antennas shall be coded to 10 bits
as in Table 15C.3B in subclause 4.7.3E.1.1.
The HARQ acknowledgement message associated with a cell for which the UE is
configured in MIMO mode shall be coded to 10 bits as in Table 15B in subclause
4.7.3.1.
The HARQ acknowledgement message associated with a cell for which the UE is
configured not in MIMO mode and not in MIMO mode with four transmit antennas
shall be coded to 10 bits as specified in Table 15 in subclause 4.7.2.
The HARQ acknowledgement messages corresponding to the serving HS-DSCH cell
and 1^st^ secondary serving HS-DSCH cell in that order are encoded and
concatenated into the same slot according to Figure 20D in clause 4.7.4.1.
The HARQ acknowledgement messages corresponding to the 2^nd^ secondary serving
HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH cell in that order are
encoded and concatenated into the same slot according to Figure 20D.1 in
clause 4.7.4.1.
##### 4.7.3E.4.2 Channel coding for HS-DPCCH composite number of transport
blocks preferred, precoding control indication and channel quality indication
The channel coding for NTBP, PCI and CQI associated with a cell for which the
UE is configured in MIMO mode with four transmit antennas is specified in
subclause 4.7.3E.1.2.
The channel coding for PCI and CQI associated with a cell for which the UE is
configured in MIMO mode is specified in subclause 4.7.3.2.
The channel coding for PCI and CQI associated with a cell for which the UE is
configured not in MIMO mode and not in MIMO mode with four transmit antennas
is specified in subclause 4.7.2.2.
### 4.7.4 Physical channel mapping for HS-DPCCH
#### 4.7.4.1 Physical Channel mapping for HS-DPCCH HARQ-ACK
This section is not applicable when the UE is configured in MIMO mode with
four transmit antennas in at least one cell.
If the HS-DPCCH slot format 0 as defined in [2] is used, the HS-DPCCH physical
channel mapping function shall map the input bits w~k~ directly to physical
channel so that bits are transmitted over the air in ascending order with
respect to k.
If the HS-DPCCH slot format 1 as defined in [2], is used, the HS-DPCCH
physical channel mapping function shall map the input bits w~k~ to the
physical channel so that bits are transmitted over the air in ascending order
with respect to k as follows:
\- If Secondary_Cell_Enabled is equal to 7 and Secondary_Cell_Active is equal
to 7
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH according
to Figure 20D:
\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
and
\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair of the
2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH
cell in that order
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH~2~
according to Figure 20D.1:
\- HARQ-ACK3 comprising the HARQ acknowledgement messages for the pair of the
4^th^ secondary serving HS-DSCH cell and the 5^th^ secondary serving HS-DSCH
cell in that order
\- HARQ-ACK4 comprising the HARQ acknowledgement messages for the pair of the
6^th^ secondary serving HS-DSCH cell and the 7^th^ secondary serving HS-DSCH
cell in that order
\- If Secondary_Cell_Enabled is equal to 6 and Secondary_Cell_Active is equal
to 6
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH according
to Figure 20D:
\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
and
\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair of the
2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH
cell in that order
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH~2~
according to Figure 20D.1:
\- HARQ-ACK3 comprising the HARQ acknowledgement messages for the pair of the
4^th^ secondary serving HS-DSCH cell and the 5^th^ secondary serving HS-DSCH
cell in that order
\- HARQ-ACK4 comprising the HARQ acknowledgement messages for the 6^th^
secondary serving HS-DSCH cell and a DTX message in that order
\- If Secondary_Cell_Enabled is equal to 5 and Secondary_Cell_Active is equal
to 5
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH according
to Figure 20D:
\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
and
\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair of the
2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH
cell in that order
\- The following HARQ-ACK message is transmitted on HS-DPCCH~2~:
\- The HARQ acknowledgement messages for the pair of the 4^th^ secondary
serving HS-DSCH cell and the 5^th^ secondary serving HS-DSCH cell are repeated
according to Figure 20E.
\- If Secondary_Cell_Enabled is equal to 4 and Secondary_Cell_Active is equal
to 4
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH according
to Figure 20D:
\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
and
\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair of the
2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH
cell in that order
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH~2~:
\- The HARQ-ACK comprising the HARQ acknowledgement the 4^th^ secondary
serving HS-DSCH cell and a DTX message in that order and it is repeated
according to Figure 20E.
\- If Secondary_Cell_Enabled is greater than 3 and Secondary_Cell_Active is
less than Secondary_Cell_Enabled:
\- If none of the 4^th^, 5^th^, 6^th^, or 7^th^ secondary serving HS-DSCH cell
is activated the HARQ-ACK transmissions on HS-DPCCH~2~ are DTXed
\- If at most one of the 1^st^, 2^nd^, or 3^rd^ secondary serving HS-DSCH cell
is activated the HARQ-ACK message is repeated according to Figure 20E
\- If one of the 4^th^, 5^th^, 6^th^, and 7^th^ secondary serving HS-DSCH cell
is activated the HARQ-ACK message is repeated according to Figure 20E.
\- If two of the 4^th^, 5^th^, 6^th^ and 7^th^ secondary serving HS-DSCH cell
are active the HARQ-ACK comprises the HARQ acknowledgement messages for the
pair of the secondary serving HS-DSCH cell with lowest index as indicated by
higher layers and the other activated secondary serving HS-DSCH cell in that
order. The HARQ-ACK message is repeated according to Figure 20E.
\- Otherwise the transmissions of the HARQ-ACK messages is the same as if
Secondary_Cell_Active was equal to Secondary_Cell_Enabled but where DTX
message(s) is transmitted in place of deactivated secondary serving HS-DSCH
cells.
\- If Secondary_Cell_Enabled is 3 and Secondary_Cell_Active is 2 or 3 then the
following two HARQ-ACK messages are encoded and concatenated into the same
slot according to Figure 20D :
\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
and
\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair of
2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH
cell in that order
\- If Secondary_Cell_Enabled is 2 with MIMO configured in at least one of the
cells and Secondary_Cell_Active is 2 then the following two HARQ-ACK messages,
are encoded and concatenated into the same slot according to Figure 20D:
\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
and
\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the 2^nd^
secondary serving HS-DSCH cell and a DTX message in that order
\- If Secondary_Cell_Enabled is more than 1 and Secondary_Cell_Active is 0 or
1 then the transmission of the HARQ-ACK message is repeated according to
Figure 20E.
{width="6.5in" height="3.4583333333333335in"}
Figure 20D: Concatenation of 2 HARQ-ACK messages
In Figure 20D, the concatenation of the 2 HARQ-ACK messages is according to
the relation:
{width="6.5in" height="3.6979166666666665in"}
Figure 20D.1: Concatenation of 2 HARQ-ACK messages on HS-DPCCH~2~
{width="3.6319444444444446in" height="3.140277777777778in"}
Figure 20E: Repetition of HARQ-ACK message
In Figure 20E, the repetition of the HARQ-ACK message is according to the
relation:
#### 4.7.4.2 Physical Channel mapping for HS-DPCCH PCI/CQI
Table 15C.4 lists the CQI and PCI/CQI report mapping scenarios when
Secondary_Cell_Enabled is less than 4. Tables 15C.5 and 15C.6 list the CQI and
PCI/CQI report mapping scenarios when Secondary_Cell_Enabled is greater than
3. The transmission timing and repetition of the 1^st^ and the 2^nd^ CQI and
PCI/CQI report is defined in [4].
Table 15C.4: The CQI and PCI/CQI report mapping scenarios when
Secondary_Cell_Enabled is less than 4
+------+-------+-------+-------+-------+-------+-------+-------+-------+ | Case | Se | MIMO | HS- | Se | 1^st^ | 2^nd^ | | | | | conda | confi | DPCCH | conda | CQI | CQI | | | | | ry_\ | gured | slot | ry_\ | or | or | | | | | Ce | in | f | Ce | PC | PC | | | | | ll_\ | any | ormat | ll_\ | I/CQI | I/CQI | | | | | En | cell | | A | r | r | | | | | abled | | | ctive | eport | eport | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | | CQI | CQI | | | | | | | | | or\ | or\ | | | | | | | | | PC | PC | | | | | | | | | I/CQI | I/CQI | | | | | | | | | Type | Type | | | | | | | | | A/B | A/B | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | 0 | No | 0 | 0 | CQI | Not | | | | | | | | | | appli | | | | | | | | | | cable | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | | Yes | 0 | 0 | PC | Not | | | | | | | | | I/CQI | appli | | | | | | | | | | cable | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | 1 | No | 0 | 1 | C | Not | | | | | | | | | QI~0~ | appli | | | | | Note | | | | & | cable | | | | | 2 | | | | C | | | | | | | | | | QI~1~ | | | | | | | | | | | | | | | | | | | | Note | | | | | | | | | | 5 | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | | | | 0 | C | Not | | | | | | | | | QI~0~ | appli | | | | | | | | | | cable | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | | Yes | 0 | 1 | PCI/C | PCI/C | | | | | | | | | QI~0~ | QI~1~ | | | | | | Note | | | | | | | | | | 1 | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | | | | 0 | PCI/C | DTX | | | | | | | | | QI~0~ | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | 2 | No | 0 | 2 | C | C | | | | | | | | | QI~0~ | QI~1~ | | | | | Note | | | | | & | | | | | 2 | | | | | C | | | | | | | | | | QI~2~ | | | | | | | | | | | | | | | | | | | | Note | | | | | | | | | | 5 | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | | | | 1 | C | C | | | | | | | | | QI~0~ | QI~n~ | | | | | | | | | | | | | | | | | | | | Note | | | | | | | | | | 4 | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | | | | 0 | C | DTX | | | | | | | | | QI~0~ | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | | CQI 1 | CQI 2 | CQI 1 | CQI 2 | | | | | | | or | or | or | or | | | | | | | PC | PC | PC | PC | | | | | | | I/CQI | I/CQI | I/CQI | I/CQI | | | | | | | 1 | 2\ | 1\ | 2\ | | | | | | | Type | Type | Type | Type | | | | | | | A/B | A/B | A/B | A/B | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | 2 | Yes\ | 1 | 2 | PCI/C | PCI/C | PCI/C | DTX | | | | Note | | | QI~0~ | QI~2~ | QI~1~ | | | | Note | 1 | | | | | | | | | 2 | | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | | | | 1 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~0~ | QI~0~ | QI~n~ | QI~n~ | | | | | | | | | | | | | | | | | | | Note | Note | | | | | | | | | 4 | 4 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | | | | 0 | PCI/C | PCI/C | DTX | | | | | | | | QI~0~ | QI~0~ | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 13 | 3 | No | 1 | 3 | C | C | C | C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | Note | | | | | | | | | | 2 | | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 14 | | | | 2 | C | C | C | C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | | | | | | | | | | | | | | | | Note | Note | Note | | | | | | | | 3 | 3 | 3 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 15 | | | | 1 | C | C | C | C | | | | | | | QI~0~ | QI~0~ | QI~n~ | QI~n~ | | | | | | | | | | | | | | | | | | | Note | Note | | | | | | | | | 4 | 4 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 16 | | | | 0 | C | C | DTX | | | | | | | | QI~0~ | QI~0~ | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 17 | | Yes | 1 | 3 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | | Note | | | | | | | | | | 1 | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 18 | | | | 2 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | | | | | | | | | | | | | | | | Note | Note | Note | | | | | | | | 3 | 3 | 3 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 19 | | | | 1 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~0~ | QI~0~ | QI~n~ | QI~n~ | | | | | | | | | | | | | | | | | | | Note | Note | | | | | | | | | 4 | 4 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | | | | 0 | PCI/C | PCI/C | DTX | | | | | | | | QI~0~ | QI~0~ | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+
Note 1: If the UE is configured in MIMO mode in at least one cell, but not in
all cells, a CQI value is reported instead of PCI/CQI value for the non-MIMO
cell(s).
Note 2: The CQI~0~ and PCI/CQI~0~ refer to the serving HS-DSCH cell's CQI and
PCI/CQI reports respectively, the CQI~n~ and PCI/CQI~n~ refer to the n^th^
secondary serving HS-DSCH cell's reports.
Note 3: The deactivated secondary cell's CQI or PCI/CQI is not transmitted
(DTX'd).
Note 4: The CQI or the PCI/CQI of the single active secondary cell is
transmitted.
Note 5: The two CQI values are jointly encoded.
Table 15C.5: The CQI and PCI/CQI report mapping for HS-DPCCH when
Secondary_Cell_Enabled is greater than 3.
+------+-------+-------+-------+-------+-------+-------+-------+-------+ | Case | Se | MIMO | HS- | A | 1^st^ | 2^nd^ | | | | | conda | confi | DPCCH | ctive | CQI | CQI | | | | | ry_\ | gured | slot | seco | or | or | | | | | Ce | in | f | ndary | PC | PC | | | | | ll_\ | any | ormat | cells | I/CQI | I/CQI | | | | | En | cell | | out | r | r | | | | | abled | | | of | eport | eport | | | | | | | | 1 | | | | | | | | | | ^st^, | | | | | | | | | | 2 | | | | | | | | | | ^nd^, | | | | | | | | | | 3^rd^ | | | | | | | | | | seco | | | | | | | | | | ndary | | | | | | | | | | cell | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | | CQI 1 | CQI 2 | CQI 1 | CQI 2 | | | | | | | or | or | or | or | | | | | | | PC | PC | PC | PC | | | | | | | I/CQI | I/CQI | I/CQI | I/CQI | | | | | | | 1 | 2\ | 1\ | 2\ | | | | | | | Type | Type | Type | Type | | | | | | | A/B | A/B | A/B | A/B | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 21a | 4-7 | No | 1 | 3 | C | C | C | C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | Note | | | | | | | | | | 2 | | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 22a | | | | 2 | C | C | C | C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | | | | | | | | | | | | | | | | Note | Note | Note | | | | | | | | 3 | 3 | 3 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 23a | | | | 1 | C | C | C | C | | | | | | | QI~0~ | QI~0~ | QI~n~ | QI~n~ | | | | | | | | | | | | | | | | | | | Note | Note | | | | | | | | | 4 | 4 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 24a | | | | 0 | C | C | DTX | | | | | | | | QI~0~ | QI~0~ | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 25a | | Yes | 1 | 3 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | | Note | | | | | | | | | | 1 | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 26a | | | | 2 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~0~ | QI~2~ | QI~1~ | QI~3~ | | | | | | | | | | | | | | | | | | Note | Note | Note | | | | | | | | 3 | 3 | 3 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 27a | | | | 1 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~0~ | QI~0~ | QI~n~ | QI~n~ | | | | | | | | | | | | | | | | | | | Note | Note | | | | | | | | | 4 | 4 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 28a | | | | 0 | PCI/C | PCI/C | DTX | | | | | | | | QI~0~ | QI~0~ | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+
Note 1: If the UE is configured in MIMO mode in at least one cell, but not in
all cells, a CQI value is reported instead of PCI/CQI value for the non-MIMO
cell(s).
Note 2: The CQI~0~ and PCI/CQI~0~ refer to the serving HS-DSCH cell's CQI and
PCI/CQI reports respectively, the CQI~n~ and PCI/CQI~n~ refer to the n^th^
secondary serving HS-DSCH cell's reports, and n ⊂ {1,2,3}.
Note 3: The deactivated secondary cell's CQI or PCI/CQI is not transmitted
(DTX'd).
Note 4: The CQI or the PCI/CQI of the single active secondary cell is
transmitted.
Table 15C.6: The CQI and PCI/CQI report mapping for HS-DPCCH2 when
Secondary_Cell_Enabled is greater than 3.
+------+-------+-------+-------+-------+-------+-------+-------+-------+ | Case | Se | MIMO | HS- | A | 3^rd^ | 4^th^ | | | | | conda | confi | DPCCH | ctive | CQI | CQI | | | | | ry_\ | gured | slot | seco | or | or | | | | | Ce | in | f | ndary | PC | PC | | | | | ll_\ | any | ormat | cells | I/CQI | I/CQI | | | | | En | cell | | out | r | r | | | | | abled | | | of | eport | eport | | | | | | | | 4 | | | | | | | | | | ^th^, | | | | | | | | | | 5 | | | | | | | | | | ^th^, | | | | | | | | | | 6^th^ | | | | | | | | | | and | | | | | | | | | | 7^th^ | | | | | | | | | | seco | | | | | | | | | | ndary | | | | | | | | | | cell | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | | CQI 3 | CQI 4 | CQI 3 | CQI 4 | | | | | | | or | or | or | or | | | | | | | PC | PC | PC | PC | | | | | | | I/CQI | I/CQI | I/CQI | I/CQI | | | | | | | 3 | 4\ | 3\ | 4\ | | | | | | | Type | Type | Type | Type | | | | | | | A/B | A/B | A/B | A/B | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 21b | 4-7 | No | 1 | 4 | C | C | C | C | | | | | | | QI~4~ | QI~6~ | QI~5~ | QI~7~ | | | Note | | | | | | | | | | 2 | | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 22b | | | | 3 | C | C | C | C | | | | | | | QI~4~ | QI~6~ | QI~5~ | QI~7~ | | | | | | | | | | | | | | | | | Note | Note | Note | Note | | | | | | | 3 | 3 | 3 | 3 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 23b | | | | 2 | C | C | C | C | | | | | | | QI~n~ | QI~n~ | QI~m~ | QI~m~ | | | | | | | | | | | | | | | | | Note | Note | Note | Note | | | | | | | 2 | 2 | 2 | 2 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 24b | | | | 1 | C | C | DTX | | | | | | | | QI~n~ | QI~n~ | | | | | | | | | | | | | | | | | | | Note | Note | | | | | | | | | 4 | 4 | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 25b | | | | 0 | DTX | DTX | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 26b | | Yes | 1 | 4 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~4~ | QI~6~ | QI~5~ | QI~7~ | | | | Note | | | | | | | | | | 1 | | | | | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 27b | | | | 3 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~4~ | QI~6~ | QI~5~ | QI~7~ | | | | | | | | | | | | | | | | | Note | Note | Note | Note | | | | | | | 3 | 3 | 3 | 3 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 28b | | | | 2 | PCI/C | PCI/C | PCI/C | PCI/C | | | | | | | QI~n~ | QI~n~ | QI~m~ | QI~m~ | | | | | | | | | | | | | | | | | Note | Note | Note | Note | | | | | | | 2 | 2 | 2 | 2 | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 29b | | | | 1 | PCI/C | PCI/C | DTX | | | | | | | | QI~n~ | QI~n~ | | | | | | | | | | | | | | | | | | | Note | Note | | | | | | | | | 4 | 4 | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+ | 30b | | | | 0 | DTX | DTX | | | +------+-------+-------+-------+-------+-------+-------+-------+-------+
Note 1: If the UE is configured in MIMO mode in at least one cell, but not in
all cells, a CQI value is reported instead of PCI/CQI value for the non-MIMO
cell(s).
Note 2: The CQI~n~ and PCI/CQI~n~ refer to the n^th^ secondary serving HS-DSCH
cell's reports, and the CQI~m~ and PCI/CQI~m~ refer to the m^th^ secondary
serving HS-DSCH cell's reports, where n \ Cell activation status \'\'A': Indicates a cell that is active (not
> deactivated by an HS-SCCH order).
>
> Cell activation status \'\'-': Indicates a cell that is inactive
> (deactivated by an HS-SCCH order).
>
> Cell group n: A group of (one, two, or three) Multiflow mode cells that have
> the same CPICH timing. The cells that belong to a cell group are indicated
> by higher layers.
>
> Ai & Aj: HARQ-ACK field for jointly encoded HARQ-ACK information of cell i
> and cell j.
>
> Ai & Aj & Ak: HARQ-ACK field for jointly encoded HARQ-ACK information of
> cell i, cell j and cell k.
>
> Ai & D: HARQ-ACK field for jointly encoded HARQ-ACK information of cell i
> and DTX indication.
>
> Ai & Aj & D: HARQ-ACK field for jointly encoded HARQ-ACK information of cell
> i, cell j and DTX indication.
>
> Ai & D & Aj: HARQ-ACK field for jointly encoded HARQ-ACK information of cell
> i, DTX indication, and HARQ-ACK information of cell j.
>
> CQIi: CQI field for CQI information of cell i.
>
> PCI/CQIi: PCI/CQI field for jointly encoded PCI and CQI information of cell
> i.
>
> CQIi & CQIj: Jointly encoded CQI field for CQI information of cell i and
> cell j.
##### 4.7.4.3.1 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI
when the UE is configured with one serving and one assisting serving HS-DSCH
cell
When MIMO is not configured in any cell;
\- The HS-DPCCH mapping follows the table 15C.8.
\- The HARQ-ACK and CQI encoding follow the definition in subclause 4.7.3A.
\- HS-DPCCH is transmitted using slot format #0.
Table 15C.8: The UE is configured with one serving and one assisting serving
HS-DSCH cell and no cells are in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Cell0**
**Cell1**  
1 A A A0 & A1 CQI0 & CQI1
* * *
In this table cell 0 refers to the serving HS-DSCH cell, and cell 1 refers to
the assisting serving HS-DSCH cell.
When MIMO is configured in at least one cell;
> \- The HS-DPCCH mapping follows the table 15C.9.
>
> \- The HARQ-ACK encoding follows the subclause 4.7.3D.1.
>
> \- The channel coding for CQI associated with a cell for which the UE is not
> configured in MIMO mode is specified in subclause 4.7.2.2.
>
> \- The channel coding for PCI and CQI associated with a cell for which the
> UE is configured in MIMO mode is specified in subclause 4.7.3.2.
\- HS-DPCCH is transmitted using slot format #0.
Table 15C.9: The UE is configured with one serving and one assisting serving
HS-DSCH cell and at least one cell is configured in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe #1** **HS-DPCCH
subframe #2**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Slot 0**
**Slot 1** **Slot 2** **Cell0** **Cell1**  
2 A A A0 & A1 PCI/CQI0 A0 & A1 PCI/CQI1
* * *
In this table cell 0 refers to the serving HS-DSCH cell, and cell 1 refers to
the assisting serving HS-DSCH cell.
##### 4.7.4.3.2 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI
when the UE is configured with two serving and one assisting serving or one
serving and two assisting serving HS-DSCH cells
When MIMO is not configured in any cell;
> \- If the UE is configured with two serving and one assisting serving HS-
> DSCH cells the HS-DPCCH mapping follows the table 15C.10
>
> \- If the UE is configured with one serving and two assisting serving HS-
> DSCH cells the HS-DPCCH mapping follows the table 15C.11.
>
> \- The HARQ-ACK encoding follow the definition in subclause 4.7.3C.1.
>
> \- The CQI encoding for composite CQI reports containing channel quality
> indication for two cells follows the definition in subclause 4.7.3A.2
>
> \- The CQI encoding for the separately encoded CQI reports follows the
> definition in subclause 4.7.2.2.
\- HS-DPCCH is transmitted using slot format #0.
Table 15C.10: The UE is configured with two serving and one assisting serving
HS-DSCH cells and no cells are in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe #1** **HS-DPCCH
subframe #2**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Slot 0**
**Slot 1** **Slot 2**  
**Cell0** **Cell1** **Cell2**  
3 A A A A0&A1&A2 CQI0 & CQI1 A0&A1&A2 CQI2  
4 A - A A0&D&A2 CQI0 A0&D&A2 CQI2
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
secondary serving HS-DSCH cell and cell 2 refers to the assisting serving HS-
DSCH cell.
Table 15C.11: The UE is configured with one serving and two assisting serving
HS-DSCH cells and no cells are in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe #1** **HS-DPCCH
subframe #2**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Slot 0**
**Slot 1** **Slot 2**  
**Cell0** **Cell1** **Cell2**  
5 A A A A0&A1&A2 CQI0 A0&A1&A2 CQI1 & CQI2  
6 A A - A0&A1&D CQI0 A0&A1&D CQI1
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
assisting serving HS-DSCH cell and cell 2 refers to the assisting secondary
serving HS-DSCH cell.
When MIMO is configured in at least one cell;
> \- If the UE is configured with two serving and one assisting serving HS-
> DSCH cells the HS-DPCCH mapping follows the table 15C.12
>
> \- If the UE is configured with one serving and two assisting serving HS-
> DSCH cells the HS-DPCCH mapping follows the table 15C.13.
>
> \- The channel coding for HARQ-ACK for all cells is specified in subclause
> 4.7.3B.1.
>
> \- The channel coding for CQI associated with a cell for which the UE is not
> configured in MIMO mode is specified in subclause 4.7.2.2.
>
> \- The channel coding for PCI and CQI associated with a cell for which the
> UE is configured in MIMO mode is specified in subclause 4.7.3.2.
>
> \- HS-DPCCH is transmitted using slot format #1.
Table 15C.12: The UE is configured with two serving and one assisting serving
HS-DSCH cells and at least one cell is configured in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe #1** **HS-DPCCH
subframe #2**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Slot 0**
**Slot 1** **Slot 2**  
**Cell0** **Cell1** **Cell2**  
7 A A A A0&A1 A2&D PCI/CQI0 PCI/CQI1 A0&A1 A2&D PCI/CQI2 PCI/CQI2 8 A - A A0&D
A2&D PCI/CQI0 PCI/CQI0 A0&D A2&D PCI/CQI2 PCI/CQI2
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
secondary serving HS-DSCH cell and cell 2 refers to the assisting serving HS-
DSCH cell.
Table 15C.13: The UE is configured with one serving and two assisting serving
HS-DSCH cells and at least one cell is configured in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe #1** **HS-DPCCH
subframe #2**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Slot 0**
**Slot 1** **Slot 2**  
**Cell0** **Cell1** **Cell2**  
9 A A A A0&D A1&A2 PCI/CQI0 PCI/CQI0 A0&D A1&A2 PCI/CQI1 PCI/CQI2 10 A A -
A0&D A1&D PCI/CQI0 PCI/CQI0 A0&D A1&D PCI/CQI1 PCI/CQI1
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
assisting serving HS-DSCH cell and cell 2 refers to the assisting secondary
serving HS-DSCH cell.
##### 4.7.4.3.3 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI
when the UE is configured with two serving and two assisting serving HS-DSCH
cells
When MIMO is not configured in any cell;
> \- The HS-DPCCH mapping follows the table 15C.14
>
> \- The channel coding for HARQ-ACK is specified in subclause 4.7.3B.1.
>
> \- The channel coding for CQI is specified in subclause 4.7.2.2.
>
> \- HS-DPCCH is transmitted using slot format #1.
Table 15C.14: The UE is configured with two serving and two assisting serving
HS-DSCH cells and no cells are in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe #1** **HS-DPCCH
subframe #2**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Slot 0**
**Slot 1** **Slot 2**  
**Cell0** **Cell1** **Cell2** **Cell3**  
11 A A A A A0&A1 A2&A3 CQI0 CQI1 A0&A1 A2&A3 CQI2 CQI3 12 A A A - A0&A1 A2&D
CQI0 CQI1 A0&A1 A2&D CQI2 CQI2 13 A - A A A0&D A2&A3 CQI0 CQI0 A0&D A2&A3 CQI2
CQI3 14 A - A - A0&D A2&D CQI0 CQI0 A0&D A2&D CQI2 CQI2
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
secondary serving HS-DSCH cell, cell 2 refers to the assisting serving HS-DSCH
cell and cell 3 refers to the assisting secondary serving HS-DSCH cell.
When MIMO is configured in at least one cell;
> \- The HS-DPCCH mapping follows the table 15C.15
>
> \- The channel coding for HARQ-ACK for all cells is specified in subclause
> 4.7.3B.1.
>
> \- The channel coding for CQI associated with a cell for which the UE is not
> configured in MIMO mode is specified in subclause 4.7.2.2.
>
> \- The channel coding for PCI and CQI associated with a cell for which the
> UE is configured in MIMO mode is specified in subclause 4.7.3.2.
>
> \- HS-DPCCH is transmitted using slot format #1.
Table 15C.15: The UE is configured with two serving and two assisting serving
HS-DSCH cells and at least one cell is configured in MIMO mode
* * *
**MF case** **Cell activation status** **HS-DPCCH subframe #1** **HS-DPCCH
subframe #2**  
**Cell group 1** **Cell group 2** **Slot 0** **Slot 1** **Slot 2** **Slot 0**
**Slot 1** **Slot 2**  
**Cell0** **Cell1** **Cell2** **Cell3**  
15 A A A A A0&A1 A2&A3 PCI/CQI0 PCI/CQI1 A0&A1 A2&A3 PCI/CQI2 PCI/CQI3 16 A A
A - A0&A1 A2&D PCI/CQI0 PCI/CQI1 A0&A1 A2&D PCI/CQI2 PCI/CQI2 17 A - A A A0&D
A2&A3 PCI/CQI0 PCI/CQI0 A0&D A2&A3 PCI/CQI2 PCI/CQI3 18 A - A - A0&D A2&D
PCI/CQI0 PCI/CQI0 A0&D A2&D PCI/CQI2 PCI/CQI2
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
secondary serving HS-DSCH cell, cell 2 refers to the assisting serving HS-DSCH
cell and cell 3 refers to the assisting secondary serving HS-DSCH cell.
##### 4.7.4.3.4 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI
when the UE is configured with three serving and one assisting serving HS-DSCH
cells or one serving and three assisting serving HS-DSCH cells
When MIMO is not configured in any cell;
\- If the UE is configured with three serving and one assisting serving HS-
DSCH cells, the HS-DPCCH mapping follows the table 15C.16.
\- If the UE is configured with one serving and three assisting serving HS-
DSCH cells, the HS-DPCCH mapping follows the table 15C.17.
\- The channel coding for HARQ-ACK is specified in subclause 4.7.3B.1.
\- The channel coding for CQI is specified in subclause 4.7.2.2.
\- HS-DPCCH is transmitted using slot format #1.
Table 15C.16: The UE is configured with three serving and one assisting
serving HS-DSCH cells and no cells are in MIMO mode
* * *
MF case Cell activation status HS-DPCCH subframe #1 HS-DPCCH subframe #2  
Cell group 1 CG2 Slot 0 Slot 1 Slot 2 Slot 0 Slot 1 Slot 2  
Cell0 Cell1 Cell2 Cell3  
19 A A A A A0&A1 A2&A3 CQI0 CQI1 A0&A1 A2&A3 CQI2 CQI3 20 A - A A A0&D A2&A3
CQI0 CQI0 A0&D A2&A3 CQI2 CQI3 21 A A - A A0&A1 D&A3 CQI0 CQI1 A0&A1 D&A3 DTX
CQI3 22 A - - A A0&D D&A3 CQI0 CQI0 A0&D D&A3 DTX CQI3
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
1st secondary serving HS-DSCH cell, cell 2 refers to the 2nd secondary serving
HS-DSCH cell and cell 3 refers to the assisting serving HS-DSCH cell.
Table 15C.17: The UE is configured with one serving and three assisting
serving HS-DSCH cells and no cells are in MIMO mode
* * *
MF case Cell activation status HS-DPCCH subframe #1 HS-DPCCH subframe #2  
CG1 Cell group 2 Slot 0 Slot 1 Slot 2 Slot 0 Slot 1 Slot 2  
**Cell0** **Cell1** **Cell2** **Cell3**  
23 A A A A A0&A1 A2&A3 CQI0 CQI1 A0&A1 A2&A3 CQI2 CQI3 24 A A - A A0&A1 D&A3
CQI0 CQI1 A0&A1 D&A3 DTX CQI3 25 A A A - A0&A1 A2&D CQI0 CQI1 A0&A1 A2&D CQI2
DTX 26 A A - - A0&A1 D CQI0 CQI1 A0&A1 D DTX DTX
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
assisting serving HS-DSCH cell, cell 2 refers to the 1st assisting secondary
serving HS-DSCH cell and cell 3 refers to the 2nd assisting secondary serving
HS-DSCH cell.
When MIMO is configured in at least one cell;
\- If the UE is configured with three serving and one assisting serving HS-
DSCH cells, the HS-DPCCH mapping follows the table 15C.18.
\- If the UE is configured with one serving and three assisting serving HS-
DSCH cells, the HS-DPCCH mapping follows the table 15C.19.
\- The channel coding for HARQ-ACK for all cells is specified in subclause
4.7.3B.1, with the following exceptions:
\- The second half (last 10 bits) of the Slot0 in Table 15C.18, where the
channel coding is specified in subclause 4.7.3D.1.
\- The first half (first 10 bits) of the Slot0 in Table 15C.19, where the
channel coding is specified in subclause 4.7.3D.1
\- The channel coding for CQI associated with a cell for which the UE is not
configured in MIMO mode is specified in subclause 4.7.2.2.
\- The channel coding for PCI and CQI associated with a cell for which the UE
is configured in MIMO mode is specified in subclause 4.7.3.2.
\- HS-DPCCH is transmitted using slot format #1.
Table 15C.18: The UE is configured with three serving and one assisting
serving HS-DSCH cells and at least one cell is configured in MIMO mode
* * *
MF case Cell activation status HS-DPCCH subframe #1 HS-DPCCH subframe #2  
Cell group 1 CG2 Slot 0 Slot 1 Slot 2 Slot 0 Slot 1 Slot 2  
Cell0 Cell1 Cell2 Cell3  
27 A A A A A0&A1 A2&A3 PCI/CQI0 PCI/CQI1 A0&A1 A2&A3 PCI/CQI2 PCI/CQI3 28 A -
A A A0&D A2&A3 PCI/CQI0 PCI/CQI0 A0&D A2&A3 PCI/CQI2 PCI/CQI3 29 A A - A A0&A1
D&A3 PCI/CQI0 PCI/CQI1 A0&A1 D&A3 DTX PCI/CQI3 30 A - - A A0&D D&A3 PCI/CQI0
PCI/CQI0 A0&D D&A3 DTX PCI/CQI3
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
1st secondary serving HS-DSCH cell, cell 2 refers to the 2nd secondary serving
HS-DSCH cell and cell 3 refers to the assisting serving HS-DSCH cell.
Table 15C.19: The UE is configured with one serving and three assisting
serving HS-DSCH cells and at least one cell is configured in MIMO mode
* * *
MF case Cell activation status HS-DPCCH subframe #1 HS-DPCCH subframe #2  
CG1 Cell group 2 Slot 0 Slot 1 Slot 2 Slot 0 Slot 1 Slot 2  
**Cell0** **Cell1** **Cell2** **Cell3**  
31 A A A A A0&A1 A2&A3 PCI/CQI0 PCI/CQI1 A0&A1 A2&A3 PCI/CQI2 PCI/CQI3 32 A A
- A A0&A1 A2&D PCI/CQI0 PCI/CQI1 A0&A1 D&A3 DTX PCI/CQI3 33 A A A - A0&A1 D&A3
PCI/CQI0 PCI/CQI1 A0&A1 A2&D PCI/CQI2 DTX 34 A A - - A0&A1 D PCI/CQI0 PCI/CQI1
A0&A1 D DTX DTX
* * *
In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers to the
assisting serving HS-DSCH cell, cell 2 refers to the 1st assisting secondary
serving HS-DSCH cell and cell 3 refers to the 2nd assisting secondary serving
HS-DSCH cell.
#### 4.7.4.4 Physical Channel mapping for HS-DPCCH when the UE is configured
in MIMO mode with four transmit antennas in at least one cell
##### 4.7.4.4.1 Physical Channel mapping for HS-DPCCH HARQ-ACK
If the HS-DPCCH slot format 0 as defined in [2], is used, the HS-DPCCH
physical channel mapping function shall map the input bits w~k~ directly to
physical channel so that bits are transmitted over the air in ascending order
with respect to k.
If the HS-DPCCH slot format 1 as defined in [2], is used, the HS-DPCCH
physical channel mapping function shall map the input bits w~k~ to the
physical channel so that bits are transmitted over the air in ascending order
with respect to k as follows:
\- If Secondary_Cell_Enabled is equal to 3 and Secondary_Cell_Active is equal
to 3
\- The following HARQ-ACK messages are transmitted on HS-DPCCH:
\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
\- The following HARQ-ACK messages are transmitted on HS-DPCCH~2~ :
\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of the
2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH
cell in that order
\- If Secondary_Cell_Enabled is equal to 2 and Secondary_Cell_Active is equal
to 2
\- The following HARQ-ACK messages are transmitted on HS-DPCCH:
\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
\- The following HARQ-ACK messages are transmitted on HS-DPCCH~2~ :
\- HARQ-ACK comprising the HARQ acknowledgement message for the 2^nd^
secondary serving HS-DSCH cell
\- If Secondary_Cell_Enabled is equal to 1 and Secondary_Cell_Active is equal
to 1
\- The following two HARQ-ACK messages are transmitted on HS-DPCCH
\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that order
\- If Secondary_Cell_Enabled is equal to 3 and Secondary_Cell_Active is less
than Secondary_Cell_Enabled:
\- If none of the 2^nd^ or 3^rd^ secondary serving HS-DSCH cell is activated
HS-DPCCH~2~ is not transmitted
\- If only one of the 2^nd^ or 3^rd^ secondary serving HS-DSCH cell is
activated the HARQ-ACK is repeated according to the Figure 20E
\- If the 1^st^ secondary serving HS-DSCH cell is not activated the HARQ-ACK
is repeated according to the Figure 20E
\- Otherwise the transmissions of the HARQ-ACK messages are the same as if
Secondary_Cell_Active was equal to Secondary_Cell_Enabled.
\- If Secondary_Cell_Enabled is equal to 2 and Secondary_Cell_Active is less
than Secondary_Cell_Enabled:
\- If the 2^nd^ secondary serving HS-DSCH cell is not activated the HARQ-ACK
transmissions on HS-DPCCH~2~ are DTXed
\- If the 1^st^ secondary serving HS-DSCH cell is not activated the HARQ-ACK
is repeated according to the Figure 20E
\- Otherwise the transmissions of the HARQ-ACK messages are the same as if
Secondary_Cell_Active was equal to Secondary_Cell_Enabled.
\- If Secondary_Cell_Enabled is equal to 1 and Secondary_Cell_Active is 0 then
the transmission of the HARQ-ACK message is repeated according to Figure 20E.
##### 4.7.4.4.2 Physical Channel mapping for HS-DPCCH NTBP/PCI/CQI
If the HS-DPCCH slot format 0 as defined in [2] is used, the HS-DPCCH physical
channel mapping function shall map the input bits b~k~ directly to physical
channel so that bits are transmitted over the air in ascending order with
respect to k.
If the HS-DPCCH slot format 1 as defined in [2] is used, the HS-DPCCH physical
channel mapping function shall map the input bits b~k~ directly to physical
channel so that bits are transmitted over the air in ascending order with
respect to k.
\- If Secondary_Cell_Enabled is equal to 3 and Secondary_Cell_Active is equal
to 3
\- The following is transmitted on HS-DPCCH:
\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or NTBP/PCI/CQI1)
and the 1st secondary serving HS-DSCH cell (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2)
are mapped to a separate subframe as specified in [4].
\- If the serving cell is configured in MIMO mode with four transmit antennas
and the 1^st^ secondary serving cell is not configured in MIMO mode with four
transmit antennas, the CQI2 or PCI/CQI2 of the 1^st^ secondary serving cell is
repeated.
\- If the serving cell is not configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is configured in MIMO mode with
four transmit antennas, the CQI1 or PCI/CQI1 of the serving cell is repeated.
\- If both the serving cell and 1^st^ secondary serving cell are not
configured in MIMO mode with four transmit antennas the CQI1 or PCI/CQI1 and
CQI2 or PCI/CQI2 are mapped to a separate subframe as specified in [4].
\- The following is transmitted on HS-DPCCH~2~:
\- The report for the 2^nd^ secondary HS-DSCH cell (CQI3 or PCI/CQI3 or
NTBP/PCI/CQI3) and the 3^rd^ secondary HS-DSCH cell (CQI4 or PCI/CQI4 or
NTBP/PCI/CQI4) are mapped to a separate subframe as specified in [4].
\- If the 2^nd^ serving cell is configured in MIMO mode with four transmit
antennas and the 3^rd^ secondary serving cell is not configured in MIMO mode
with four transmit antennas, the CQI4 or PCI/CQI4 of the 3^rd^ secondary
serving cell is repeated.
\- If the 2^nd^ serving cell is not configured in MIMO mode with four transmit
antennas and the 3^rd^ secondary serving cell is configured in MIMO mode with
four transmit antennas, the CQI3 or PCI/CQI3 of the 2^nd^ serving cell is
repeated.
\- If both the 2^nd^ serving cell and 3^rd^ secondary serving cell are not
configured in MIMO mode with four transmit antennas the CQI3 or PCI/CQI3 and
CQI4 or PCI/CQI4 are mapped to a separate subframe as specified in [4].
\- If Secondary_Cell_Enabled is equal to 2 and Secondary_Cell_Active is equal
to 2
\- The following is transmitted on HS-DPCCH:
\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or NTBP/PCI/CQI1)
and the 1st secondary serving HS-DSCH cell (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2)
are mapped to a separate subframe as specified in [4].
\- If the serving cell is configured in MIMO mode with four transmit antennas
and the 1^st^ secondary serving cell is not configured in MIMO mode with four
transmit antennas, the CQI2 or PCI/CQI2 of the 1^st^ secondary serving cell is
repeated.
\- If the serving cell is not configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is configured in MIMO mode with
four transmit antennas, the CQI1 or PCI/CQI1 of the serving cell is repeated.
\- If both the serving cell and 1^st^ secondary serving cell are not
configured in MIMO mode with four transmit antennas the CQI1 or PCI/CQI1 and
CQI2 or PCI/CQI2 are mapped to a separate subframe as specified in [4].
\- The following is transmitted on HS-DPCCH~2~:
\- If the 2^nd^ serving cell is configured in MIMO mode with four transmit
antennas the HS-DPCCH~2~ physical channel mapping function shall map NTBP/
PCI/CQI3 to the physical channel.
\- If the 2^nd^ serving cell is not configured in MIMO mode with four transmit
antennas the HS-DPCCH~2~ physical channel mapping function shall map CQI3 or
PCI/CQI3 to the physical channel.
\- If Secondary_Cell_Enabled is equal to 1 and Secondary_Cell_Active is equal
to 1
\- The following is transmitted on HS-DPCCH:
\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or NTBP/PCI/CQI1)
and the 1st secondary serving HS-DSCH cell (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2)
are mapped to a separate subframe as specified in [4].
\- If the serving cell is configured in MIMO mode with four transmit antennas
and the 1^st^ secondary serving cell is not configured in MIMO mode with four
transmit antennas, the CQI2 or PCI/CQI2 of the 1^st^ secondary serving cell is
repeated.
\- If the serving cell is not configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is configured in MIMO mode with
four transmit antennas, the CQI1 or PCI/CQI1 of the serving cell is repeated.
\- If Secondary_Cell_Enabled is equal to 1 and Secondary_Cell_Active is less
than Secondary_Cell_Enabled:
\- The following is transmitted on HS-DPCCH:
\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or NTBP/PCI/CQI1)
and the 1st secondary serving HS-DSCH cell (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2)
are mapped to a separate subframe as specified in [4]. The slots corresponding
to the (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2) are DTXed.
\- If Secondary_Cell_Enabled is equal to 2 and Secondary_Cell_Active is less
than Secondary_Cell_Enabled:
\- If the 2^nd^ serving cell is not activated HS-DPCCH~2~ is not transmitted.
\- The following is transmitted on HS-DPCCH:
\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or NTBP/PCI/CQI1)
and the 1st secondary serving HS-DSCH cell (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2)
are mapped to a separate subframe as specified in [4]. The slots corresponding
to the (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2) are DTXed.
\- The following is transmitted on HS-DPCCH~2~:
\- If the 2^nd^ serving cell is configured in MIMO mode with four transmit
antennas the HS-DPCCH~2~ physical channel mapping function shall map NTBP/
PCI/CQI3 to the physical channel
\- If the 2^nd^ serving cell is not configured in MIMO mode with four transmit
antennas the HS-DPCCH~2~ physical channel mapping function shall map CQI3 or
PCI/CQI3 to the physical channel.
\- If Secondary_Cell_Enabled is equal to 3 and Secondary_Cell_Active is less
than Secondary_Cell_Enabled:
\- If none of the 2^nd^ or 3^rd^ secondary serving HS-DSCH cell is activated
HS-DPCCH~2~ is not transmitted and the rules in case Secondary_Cell_Enabled is
equal to 1 and Secondary_Cell_Active is equal to 1 are followed for HS-DPCCH
\- The following is transmitted on HS-DPCCH:
\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or NTBP/PCI/CQI1)
and the 1st secondary serving HS-DSCH cell (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2)
are mapped to a separate subframe as specified in [4]. The slots corresponding
to the (CQI2 or PCI/CQI2 or NTBP/PCI/CQI2) are DTXed.
\- The following is transmitted on HS-DPCCH~2~:
\- If the 3^rd^ secondary serving HS-DSCH cell is not activated, the report
for the 2^nd^ secondary HS-DSCH cell (CQI3 or PCI/CQI3 or NTBP/PCI/CQI3) and
the 3^rd^ secondary serving HS-DSCH cell (CQI4 or PCI/CQI4 or NTBP/PCI/CQI4)
are mapped to a separate subframe as specified in [4]. The slots corresponding
to the (CQI4 or PCI/CQI4 or NTBP/PCI/CQI4) are DTXed.
\- If the 2^rd^ secondary serving HS-DSCH cell is not activated, the report
for the 3^rd^ secondary HS-DSCH cell (CQI4 or PCI/CQI4 or NTBP/PCI/CQI4) and
the 2^nd^ secondary serving HS-DSCH cell (CQI3 or PCI/CQI3 or NTBP/PCI/CQI3)
are mapped to a separate subframe as specified in [4]. The slots corresponding
to the (CQI3 or PCI/CQI3 or NTBP/PCI/CQI3) are DTXed.
\- If Secondary_Cell_Enabled is equal to 0
\- The following is transmitted on HS-DPCCH:
\- The physical channel mapping function shall map NTBP/ PCI/CQI1 to the
physical channel.
## 4.8 Coding for E‑DCH
Figure 21 shows the processing structure for the E‑DCH transport channel
mapped onto a separate CCTrCH.
If UL_MIMO_Enabled is not set to TRUE, or UL_MIMO_Enabled is set to TRUE and
UL_CLTD_Active is not 1, data arrives to the coding unit in form of a maximum
of one transport block once every transmission time interval (TTI).
If UL_MIMO_Enabled is set to TRUE and UL_CLTD_Active = 1, data arrives to the
coding unit in form of a maximum of two transport blocks once every TTI.
> \- If a single transport block arrives to the coding unit in a TTI, the
> transport block is processed as when UL_MIMO_Enabled is not set to TRUE.
>
> \- If two transport blocks arrive to the coding unit in a TTI, each
> transport block is separately processed as when UL_MIMO_Enabled is not set
> to TRUE, with the exception of the rank-dependent determinations of SF,
> modulation, number of E-DPDCHs and S-E-DPDCHs, and the physical channel
> mapping.
The following coding steps can be identified:
\- Add CRC to the transport block
\- Code block segmentation
\- Channel coding
\- Physical layer hybrid ARQ and rate matching
\- Physical channel segmentation
\- Interleaving
\- Physical channel mapping
The coding steps for E-DCH transport channel are shown in the figure below.
Figure 21: Transport channel processing for E-DCH
In the following the number of transport blocks per TTI and the number of
transport channels is always one i.e. _m_ =1 and _i_ =1. When referencing non
E-DCH formulae which are used in correspondence with E-DCH formulae the
convention is used that transport block subscripts may be omitted (e.g. _X~1~_
may be written _X_).
### 4.8.1 CRC attachment for E-DCH
CRC attachment for the E-DCH transport channel shall be performed according to
the general method described in 4.2.1 above with the following specific
parameters.
The CRC length shall always be _L~1~_ =24 bits.
### 4.8.2 Code block segmentation for E-DCH
Code block segmentation for the E-DCH transport channel shall be performed
according to the general method described in 4.2.2.2 with the following
specific parameters.
There is a maximum of one transport block. The bits
$b_{\text{im}1},b_{\text{im}2},b_{\text{im}3},\text{.}\text{.}\text{.},b_{\text{imB}_{i}}$
input to the block are mapped to the bits
$x_{i1},x_{i2},x_{i3},\text{.}\text{.}\text{.},x_{\text{iX}_{i}}$ directly. It
follows that _X~i~_ = _B~i~_. Note that the bits _x_ referenced here refer
only to the internals of the code block segmentation function. The output bits
from the code block segmentation function are _o~ir1~_ , _o~ir2~_ , _o~ir3~_ ,
..., _o~irK~_.
The value of _Z_ = 5114 for turbo coding shall be used.
### 4.8.3 Channel coding for E-DCH
Channel coding for the E-DCH transport channel shall be performed according to
the general method described in clause 4.2.3 above with the following specific
parameters.
There is a maximum of one transport block, _i_ =1. The rate 1/3 turbo coding
shall be used.
### 4.8.4 Physical layer HARQ functionality and rate matching for E-DCH
The hybrid ARQ functionality matches the number of bits at the output of the
channel coder to the total number of bits of the E-DPDCH or S-E-DPDCH set to
which the E-DCH transport channel is mapped. The hybrid ARQ functionality is
controlled by the redundancy version (RV) parameters.
Figure 22: E‑DCH hybrid ARQ functionality
#### 4.8.4.1 Determination of SF, modulation scheme and number of E-DPDCH
PhCHs needed
The maximum amount of puncturing that can be applied is
\- 1-_PL~non-max~_ if the modulation scheme or the number of code channels is
less than the maximum allowed by the UE capability and restrictions imposed by
UTRAN.
\- 1-_PL~mod~_~switch~_ if the modulation scheme is BPSK, the number of
E-DPDCH code channels equals to 4 and the usage of 4PAM is allowed by the UE
capability and restrictions imposed by UTRAN.
\- 1-_PL~mod~_~switch_2~_ if the modulation scheme is 4PAM, the number of
E-DPDCH code channels equals to 4 and the usage of 8PAM is allowed by the UE
capability and restrictions imposed by UTRAN.
\- 1-_PL~max~_ if the modulation scheme and the number of code channels equals
to the maximum allowed by the UE capability and restrictions imposed by UTRAN.
The number of available bits per TTI of one E-DPDCH for all possible spreading
factors and modulation schemes is denoted by _N~256~, N~128~, N~64~, N~32~,
N~16~, N~8~, N~4~, N~2~,_ _M~4~, M~2~, L~4~_ and _L~2\ ~_ where the index
refers to the spreading factor. _N refers to BPSK modulation, M to 4PAM
modulation and L to 8PAM modulation._
The possible number of bits available to the CCTrCH of E-DCH type on all
E-DPDCHs, _N~e,data~_ , then are {_N~256~, N~128~, N_ ~64~, _N_ ~32~, _N_
~16~, _N_ ~8~, _N_ ~4~, _2_ × _N_ ~4~, 2× _N_ ~2~, 2× _N_ ~2~+2× _N_ ~4~, 2×
_M_ ~2~+2× _M_ ~4~, 2× _L_ ~2~+2× _L_ ~4~}.
SET0 denotes the set of _N~e,data~_ values allowed by the UTRAN and supported
by the UE, as part of the UE's capability. SET0 can be a subset of {_N~256~,
N~128~, N_ ~64~, _N_ ~32~, _N_ ~16~, _N_ ~8~, _N_ ~4~, _2_ × _N_ ~4~, 2× _N_
~2~, 2× _N_ ~2~+2× _N_ ~4~, 2× _M_ ~2~+2× _M_ ~4~, 2× _L_ ~2~+2× _L_ ~4~}.
The total number of bits in a TTI on all E-DPDCHs before rate matching with
transport format j is _N~e,j~_. The total number of bits available for the
E‑DCH transmission per TTI on all E-DPDCHs with transport format j,
_N~e,data,j~_ , is determined by executing the following algorithm, where
_\- PL~non-max~_ is signalled from higher layers,
_\- PL~mod~_~,switch~_ is equal to 0.468,
_\- PL~mod~_~switch_2~_ is equal to 0.4,
_\- PL~max~_ is equal to 0.44 , except when the _N~e,data~_ = 2× _N_ ~2~+2×
_N_ ~4~, 2× _M_ ~2~+2× _M_ ~4~ or 2× _L_ ~2~+2× _L_ ~4~ is allowed by the
UTRAN and supported by the UE, in which case _PL~max~_ is equal to 0.33:
> If the UE transmits only one transport block:
>
> SET1 = { _N~e,data~_ in SET0 such that _N~e,data~_ \-- _N~e,j~_ is non
> negative }
>
> If SET1 is not empty and the smallest element of SET1 requires just one
> E-DPDCH then
>
> _N~e,data,j~_ = min SET1
>
> Else
>
> SET2 = { _N~e,data~_ in SET0 without 2× _N_ ~2~+2× _N_ ~4~, 2× _M_ ~2~+2×
> _M_ ~4~ and 2× _L_ ~2~+2× _L_ ~4~ such that _N~e,data~_ \-- _PL~non-max~_ ×
> _N~e,j~_ is non negative }
>
> If SET2 is not empty then
>
> Sort SET2 in ascending order
>
> _N~e,data\ ~_ = min SET2
>
> While _N~e,data~_ is not the max of SET2 and the follower of _N~e,data\ ~_
> requires only one E-DPDCH do
>
> _N~e,data\ ~_ = follower of _N~e,data~_ in SET2
>
> End while
>
> _N~e,data,j~_ = _N~e,data~_
>
> Else
>
> If SET0 includes 2× _N_ ~2~+2× _N_ ~4~
>
> _N~e,data~_ = 2× _N_ ~2~+2× _N_ ~4~
>
> _If N~e,data~ / N~e,j~ \ 
> _N~e,data~ = 2×M~2~+2×M~4~_
>
> _End if_
>
> _If N~e,data~ is equal to 2×M~2~+2×M~4~ and N~e,data~ / N~e,j~ \  PL~mod_switch_2~_ and SET0 includes _2×L~2~+2×L~4~_
>
> _N~e,data~ = 2×L~2~+2×L~4~_
>
> _End if_
>
> _N~e,data,j~_ = _N~e,data~_ provided that _N~e,data,j~_ \- _PL~max~_ ×
> _N~e,j~_ is non negative
>
> Else
>
> _N~e,data,j~_ = max SET0 provided that _N~e,data,j~_ \- _PL~max~_ × _N~e,j~_
> is non negative
>
> _End if_
>
> End if
>
> End if
>
> Else (when UE transmits two transport blocks)
>
> _N~e,data~_ = 2× _N_ ~2~+2× _N_ ~4~
>
> _If N~e,data~ / N~e,j~ \  _2×M~2~+2×M~4~_
>
> _N~e,data~ = 2×M~2~+2×M~4~_
>
> _End if_
>
> _If N~e,data~ is equal to 2×M~2~+2×M~4~, N~e,data~ / N~e,j~ \  PL~mod_switch_2~_ and SET0 includes _2×L~2~+2×L~4~_
>
> _N~e,data~ = 2×L~2~+2×L~4~_
>
> _End if_
>
> _N~e,data,j~_ = _N~e,data~_ provided that _N~e,data~_ \- _PL~max~_ ×
> _N~e,j~_ is non negative
>
> End if
While E‑DCH TTI length is 10 ms, if an initial transmission occurs in a
compressed frame, or a retransmission occurs in a compressed frame, or a
retransmission occurs in a non‑compressed frame for which initial transmission
was compressed, the number of available bits per TTI of one E‑DPDCH for all
possible spreading factors denoted by _N~256~, N~128~, N~64~, N~32~, N~16~,
N~8~, N~4~_ and _N~2~_ used in the algorithm above is replaced by _k_ ×
_N~256~, k_ × _N~128~, k_ × _N~64~, k_ × _N~32~, k_ × _N~16~, k_ × _N~8~, k_ ×
_N~4~_ and _k_ × _N~2~._ The parameter _k_ is equal to _n~tx1~_ /15 and
_n~tx1~_ is defined in 4.4.5.1.
#### 4.8.4.1A Determination of SF, modulation scheme and number of S-E-DPDCH
PhCHs needed
S-E-DPDCHs are only present when the UE transmits two transport blocks. When
present, the number of S-E-DPDCHs is always 4.
The maximum amount of puncturing that can be applied is
\- 1-_PL~non-max~_ if the modulation scheme is less than the maximum allowed
by the UE capability and restrictions imposed by UTRAN.
\- 1-_PL~mod~_~switch~_ if the modulation scheme is BPSK and the usage of 4PAM
is allowed by the UE capability and restrictions imposed by UTRAN.
\- 1-_PL~mod~_~switch_2~_ if the modulation scheme is 4PAM and the usage of
8PAM is allowed by the UE capability and restrictions imposed by UTRAN.
\- 1-_PL~max~_ if the modulation scheme equals to the maximum allowed by the
UE capability and restrictions imposed by UTRAN.
The number of available bits per TTI of one S-E-DPDCH for all possible
spreading factors and modulation schemes is denoted by _N~4~, N~2~,_ _M~4~,
M~2~, L~4~_ and _L~2~,_ where the index refers to the spreading factor. _N
refers to BPSK modulation, M to 4PAM modulation and L to 8PAM modulation._
The possible number of bits available to the CCTrCH of E-DCH type on all S-E-
DPDCHs, _N~e,data~_ , then are {2× _N_ ~2~+2× _N_ ~4~, 2× _M_ ~2~+2× _M_ ~4~,
2× _L_ ~2~+2× _L_ ~4~}.
SET0 denotes the set of _N~e,data~_ values allowed by the UTRAN and supported
by the UE, as part of the UE's capability. SET0 can be a subset of {2× _N_
~2~+2× _N_ ~4~, 2× _M_ ~2~+2× _M_ ~4~, 2× _L_ ~2~+2× _L_ ~4~}.
The total number of bits in a TTI on all S-E-DPDCHs before rate matching with
transport format j is _N~e,j~_. The total number of bits available for the
E‑DCH transmission per TTI on all S-E-DPDCHs with transport format j,
_N~e,data,j~_ , is determined by executing the following algorithm, where
_\- PL~mod_switch~_ is equal to 0.468,
_\- PL~mod_switch_2~_ is equal to 0.4,
_\- PL~max~_ is equal to 0.33:
> _N~e,data~_ = 2× _N_ ~2~+2× _N_ ~4~
_If N~e,data~ / N~e,j~ \  _N~e,data~ = 2×M~2~+2×M~4~_
>
> _End if_
_If N~e,data~ is equal to 2×M~2~+2×M~4~, N~e,data~ / N~e,j~ \  _N~e,data~ = 2×L~2~+2×L~4~_
>
> _End if_
>
> _N~e,data,j~_ = _N~e,data~_ provided that _N~e,data~_ \- _PL~max~_ ×
> _N~e,j~_ is non negative
#### 4.8.4.2 HARQ bit separation
The HARQ bit separation function shall be performed in the same way as bit
separation for turbo encoded TrCHs with puncturing in 4.2.7.4.1 above.
#### 4.8.4.3 HARQ Rate Matching Stage
The hybrid ARQ rate matching for the E-DCH transport channel shall be done
with the general method described in 4.2.7.5 with the following specific
parameters.
The parameters of the rate matching stage depend on the value of the RV
parameters _s_ and _r_. The _s_ and _r_ combinations corresponding to each RV
allowed for the E-DCH are listed in the table below.
Table 15D: RV for E-DCH
* * *
E-DCH RV Index _s_ _r_ 0 1 0 1 0 0 2 1 1 3 0 1
* * *
The parameter _e~plus~_ , _e~minus~_ and _e~ini~_ are calculated with the
general method for QPSK as described in 4.5.4.3 above. The following
parameters are used as input:
_N~sys~_ = _N~p1~_ = _N~p2~_ = _N~e,j~_ /3
_N~data~_ = _N~e,data,j~_
_r~max~_ = 2
During uplink compressed frames while E‑DCH TTI length is 10 ms and if
_N~data~_ >_N~e,j~_ :
\- If _N~data~_ mod 3 = 1, one _δ_ bit is added to the _N~t,sys~_ bits as the
last systematic bit and another δ bit is added to the _N~t,p1~_ bits as the
last _N~t,p1~_ bit.
\- If _N~data~_ mod 3 = 2, one _δ_ bit is added to the _N~t,sys~_ bits as the
last systematic bit.
#### 4.8.4.4 HARQ bit collection
The HARQ bit collection shall be performed according to the general method for
bit collection for turbo encoded TrCHs with puncturing as specified in
4.2.7.4.2 including the removal of the bits with value _δ_.
### 4.8.5 Physical channel segmentation for E‑DCH
When more than one E-DPDCH or S-E-DPDCH is used, physical channel segmentation
distributes the bits among the different physical channels. The bits input to
the physical channel segmentation are denoted by _s~1~_ , _s~2~_ , _s~3~_ ,
...,_s~R~_ , where _R_ is the number of bits input to the physical channel
segmentation block. The number of PhCHs is denoted by _P._
The bits after physical channel segmentation are denoted _u~p,k~_ where _p_ is
the PhCH number. _U(p)_ is the number of physical channel bits in one E-DCH
TTI for the p^th^ E-DPDCH or S-E-DPDCH. The relation between s _~k~_ and
_u~p,k~_ is given below.
Bits on first PhCH after physical channel segmentation:
$u_{1,k} = s_{k}$ _k_ = 1, 2, ..., _U(1)_
Bits on p^th^ PhCH after physical channel segmentation:
> $u_{p,k} = s_{k + \sum_{q = 1}^{p - 1}{U(q)}}$ _k_ = 1, 2, ..., _U_(p)
### 4.8.6 Interleaving for E‑DCH
The interleaving is done as shown in figure 22A below, separately for each
physical channel. The bits input to the block interleaver are denoted by
$u_{p,1},u_{p,2},u_{p,3},\text{.}\text{.}\text{.},u_{p,U}$, where _p_ is PhCH
number and _U_ =_U(p)_ is the number of bits in one TTI for one PhCH.
{width="6.5in" height="2.6347222222222224in"}
Figure 22A: Interleaver structure for E-DCH
The basic interleaver is as the 2^nd^ interleaver described in Clause 4.2.11.
For 4PAM, there are two identical interleavers of the same size R2×30, where
R2 is the minimum integer fulfilling $\left\lceil \frac{U}{2} \right\rceil
\leq R2 \times \text{30}$. The output bits from the physical channel
segmentation are divided one by one between the interleavers: bit _u~p,k~_
goes to the first interleaver and bit _u~p,k+1~_ goes to the second
interleaver. Bits are collected one by one from the interleavers: bit _v~p,k~_
is obtained from the first interleaver and bit _v~p,k+1~_ is obtained from the
second interleaver, where k mod 2=1.
For 8PAM, there are three identical interleavers of the same size R2×30, where
R2 is the minimum integer fulfilling $\left\lceil \frac{U}{3} \right\rceil
\leq R2 \times \text{30}$. The output bits from the physical channel
segmentation are divided one by one between the interleavers: bit _u~p,k~_
goes to the first interleaver, bit _u~p,k+1~_ goes to the second interleaver
and bit _u~p,k+2~_ goes to the third interleaver. Bits are collected one by
one from the interleavers: bit _v~p,k~_ is obtained from the first
interleaver, bit _v~p,k+1~_ is obtained from the second interleaver and bit
_v~p,k+2~_ is obtained from the third interleaver, where k mod 3=1.
### 4.8.7 Physical channel mapping for E‑DCH
The E-DCH structure is described in [2]. The bits input to the physical
channel mapping are denoted ν _~p,1~_ , ν _~p,2~_ , ..., ν _~p,U(p)~_. The
bits ν _~p,k~_ are mapped to the PhCHs such that the bits for each PhCH are
transmitted over the air in ascending order with respect to _k_.
During compressed frames in the uplink and when E‑DCH TTI is 10 ms:
\- For the initial transmission the bits shall be consecutively mapped to the
non‑idle slots. The UE shall not map any bit to the E‑DPDCH idle slots
specified in 4.4.5.1.
\- In case a retransmission occurs in a compressed frame or a retransmission
occurs in a non‑compressed frame for which initial transmission was
compressed:
\- If _n~tx1~_ >_n~max~_ : The bits shall be consecutively mapped to the
_n~max~_ available slots. The remaining bits are not transmitted.
\- If _n~tx1~_ ≤ _n~max~_ : The bits shall be consecutively mapped to the
_n~tx1~_ non‑idle slots, whilst no bits are mapped to the idle slots.
\- The transmission gap position and the parameters _n~tx1~_ and _n~max~_ are
specified in 4.4.5.2.
## 4.9 Coding for E‑DPCCH
The following information is transmitted by means of the E-DPCCH:
\- Retransmission sequence number (RSN): _x~rsn,1~_ , _x~rsn,2~_
\- E-TFCI: _x~tfci,1~_ , _x~tfci,2~_ , ..., _x~tfci,7~_
_\- \"Happy\" bit_ : _x~h,1~_
### 4.9.1 Overview
The figure below illustrates the overall coding chain for E-DPCCH.
Figure 23: Coding chain for E‑DPCCH
### 4.9.2 E‑DPCCH information field mapping
#### 4.9.2.1 Information field mapping of E‑TFCI
The E‑TFCI is mapped such that _x~tfci,1~ corresponds to the MSB._
#### 4.9.2.2 Information field mapping of retransmission sequence number
To indicate the redundancy version (RV) of each HARQ transmission and to
assist the Node B soft buffer management a two bit retransmission sequence
number (RSN) is signalled from the UE to the Node B. The Node B can avoid soft
buffer corruption by flushing the soft buffer associated to one HARQ process
in case more than 3 consecutive E‑DPCCH transmissions on that HARQ process can
not be decoded or the last received RSN is incompatible with the current one.
The RSN is set by higher layers as described in [16]. The RSN is mapped such
that _x~rsn,1~ corresponds to the MSB._
The applied E-DCH RV index specifying the used RV (_s_ and _r_ parameter)
depends on the RSN, on _N~sys~_ / _N~e,data,j~_ , and if RSN=3 also on the
TTIN (TTI number). For 10 ms TTI the TTI number is equal to the CFN, for 2 ms
TTI
TTIN = 5*CFN + subframe number
where the subframe number counts the five TTIs which are within a given CFN,
starting from 0 for the first TTI to 4 for the last TTI. N~ARQ~ is the number
of Hybrid ARQ processes.
Table 16: Relation between RSN value and E-DCH RV Index
* * *
**RSN Value** _N~sys~_ / _N~e,data,j~_ **\  \- Absolute Grant Scope: _x~ags,1~_
### 4.10.1 Overview
Figure 24 below illustrates the overall coding chain for the E‑AGCH.
Figure 24: Coding for E‑AGCH
### 4.10.1A E-AGCH information field mapping
#### 4.10.1A.1 Information field mapping of **the** Absolute Grant Value
The Absolute Grant Value information is specified in Table 16B and Table
16.B.1. The values are mapped such that _x~agv,1~_ corresponds to the MSB of
the index.
Based on higher layer signalling, either Table 16B or Table 16.B.1 is
selected.
Table 16B: Mapping of Absolute Grant Value
* * *
Absolute Grant Value Index (168/15)^2^x6 31 (150/15)^2^x6 30 (168/15)^2^x4 29
(150/15)^2^x4 28 (134/15)^2^x4 27 (119/15)^2^x4 26 (150/15)^2^x2 25
(95/15)^2^x4 24 (168/15)^2^ 23 (150/15)^2^ 22 (134/15)^2^ 21 (119/15)^2^ 20
(106/15)^2^ 19 (95/15)^2^ 18 (84/15)^2^ 17 (75/15)^2^ 16 (67/15)^2^ 15
(60/15)^2^ 14 (53/15)^2^ 13 (47/15)^2^ 12 (42/15)^2^ 11 (38/15)^2^ 10
(34/15)^2^ 9 (30/15)^2^ 8 (27/15)^2^ 7 (24/15)^2^ 6 (19/15)^2^ 5 (15/15)^2^ 4
(11/15)^2^ 3 (7/15)^2^ 2 ZERO_GRANT* 1 INACTIVE* 0
* * *
NOTE *: These values are specified in [16].
Table 16B.1: Alternative Mapping of Absolute Grant Value
* * *
Absolute Grant Value Index (377/15)^2^x4 31 (237/15)^2^x6 30 (168/15)^2^*6 29
(150/15)^2^*6 28 (168/15)^2^*4 27 (150/15)^2^x4 26 (134/15)^2^x4 25
(119/15)^2^x4 24 (150/15)^2^x2 23 (95/15)^2^x4 22 (168/15)^2^ 21 (150/15)^2^
20 (134/15)^2^ 19 (119/15)^2^ 18 (106/15)^2^ 17 (95/15)^2^ 16 (84/15)^2^ 15
(75/15)^2^ 14 (67/15)^2^ 13 (60/15)^2^ 12 (53/15)^2^ 11 (47/15)^2^ 10
(42/15)^2^ 9 (38/15)^2^ 8 (34/15)^2^ 7 (30/15)^2^ 6 (27/15)^2^ 5 (24/15)^2^ 4
(19/15)^2^ 3 (15/15)^2^ 2 ZERO_GRANT* 1 INACTIVE* 0
* * *
NOTE *: These values are specified in [16].
#### 4.10.1A.2 Information field mapping of the Absolute Grant Scope
The value of _x~ags,1\ ~_ is set as specified in Table 16C.
Table 16C: Mapping of Absolute Grant Scope
* * *
Absolute Grant Scope _x~ags,1~_ \"Per HARQ process\" 1 \"All HARQ processes\"
0
* * *
### 4.10.1B Multiplexing of E-AGCH information
The Absolute Grant Value information _x~agv,1~, x~agv,2~, ..., x~agv,5~_ and
the Absolute Grant Scope _information_ _x~ags,1\ ~_ are multiplexed together.
This gives a sequence of bits _x~ag,1~_ , _x~ag,2~_ , ..., _x~ag,\ 6\ ~_ where
_x~ag,k~ = x~agv,k~ k=1,2,...,5_
_x~ag,k~ = x~ags,7-k~ k=6_
### 4.10.2 CRC attachment for E‑AGCH
The E-RNTI is the E‑DCH Radio Network Identifier defined in [13]. It is mapped
such that _x~id,1\ ~_ corresponds to the MSB.
From the sequence of bits _x~ag,1~_ , _x~ag,2~_ , ..., _x~ag,6~_ a 16 bit CRC
is calculated according to clause 4.2.1.1. That gives the sequence of bits
_c~1~_ , _c~2~_ , ..., _c~16~_ where
$c_{k} = p_{\text{im}(\text{17} - k)}$ _k=1,2,...,16_
This sequence of bits is then masked with _x~id,1~, x~id,2~, ..., x~id,16~_
and appended to the sequence of bits _x~ag,1~_ , _x~ag,2~_ , ..., _x~ag,6~_ to
form the sequence of bits _y~1~_ , _y~2~_ , ..., _y~22~ where_
_y~i~=x~ag,i~ i=1,2, ...,6_
_y~i~=(c~i-6~ + x~id~,~i-6~) mod 2 i= 7, ..., 22_
### 4.10.3 Channel coding for E‑AGCH
Rate 1/3 convolutional coding, as described in Clause 4.2.3.1 is applied to
the sequence of bits _y~1~_ , _y~2~_ , ..., _y~22~_ , resulting in the
sequence of bits _z~1~_ , _z~2~_ , ..., _z~90~_.
### 4.10.4 Rate matching for E‑AGCH
From the input sequence z~1~, z~2~, ..., z~90~ the bits z~1~, z~2~, z~5~,
z~6~, z~7~, z~11~, z~12~, z~14~, z~15~, z~17~, z~23~, z~24~, z~31~, z~37~,
z~44~, z~47~, z~61~, z~63~, z~64~, z~71~, z~72~, z~75~, z~77~, z~80~, z~83~,
z~84~, z~85~, z~87~, z~88~, z~90~ are punctured to obtain the output sequence
r~1~, r~2~, ..., r~60~.
### 4.10.5 Physical channel mapping for E‑AGCH
The E‑AGCH sub frame is described in [2]. The sequence of bits _r~1~_ , _r~2~_
, ..., _r~60\ ~_ is mapped to the corresponding E‑AGCH sub frame. The bits
_r~k~_ are mapped so that they are transmitted over the air in ascending order
with respect to k. If the E‑DCH TTI is equal to 10 ms the same sequence of
bits is transmitted in all the E‑AGCH sub frames of the E‑AGCH radio frame.
## 4.10A Coding for E-ROCH
The following information is transmitted by means of the E-DCH rank and offset
channel (E-ROCH):
\- S-ETFC Offset: _x~seo,1~, x~seo,2~, ..., x~seo,5~_
> \- Rank Indication: _x~ri,1~_
### 4.10A.1 Overview
The E-ROCH coding chain uses the same coding chain as the E-AGCH. Figure 24B
below illustrates the overall coding chain for the E-ROCH.
Figure 24B: Coding for E-ROCH
### 4.10A.2 E-ROCH information field mapping
#### 4.10A.2.1 Information field mapping of **the S-ETFC Offset**
The S-ETFC Offset information is specified in Table 16D. The values are mapped
such that _x~seo,1~_ corresponds to the MSB of the index.
Table 16D: Mapping of S-ETFC Offset value
* * *
**S-ETFC Offset Value** **Index** 60/30 31 55/30 30 50/30 29 45/30 28 40/30 27
35/30 26 30/30 25 28/30 24 26/30 23 24/30 22 22/30 21 21/30 20 20/30 19 19/30
18 18/30 17 17/30 16 16/30 15 15/30 14 14/30 13 13/30 12 12/30 11 11/30 10
10/30 9 9/30 8 8/30 7 7/30 6 6/30 5 5/30 4 4/30 3 3/30 2 2/30 1 1/30 0
* * *
#### 4.10A.2.2 Information field mapping of the Rank Indication
The value of _x~ri,1\ ~_ is set as specified in Table 16E.
Table 16E: Mapping of Rank Indication
* * *
Rank Indication _x~ri,1~_ \"Rank 2 allowed\" 1 \"Rank 2 not allowed\" 0
* * *
### 4.10A.3 Multiplexing of E-ROCH information
The S-ETFC Offset information _x~seo,1~, x~seo,2~, ..., x~seo,5~_ and the Rank
Indication _information_ _x~ri,1\ ~_ are multiplexed together. This gives a
sequence of bits _x~ro,1~_ , _x~ro,2~_ , ..., _x~ro,\ 6\ ~_ where
_x~ro,k~ = x~seo,k~ k=1,2,...,5_
_x~ro,6~ = x~ri,1~_
### 4.10A.4 CRC attachment for E-ROCH
The S-E-RNTI is the E‑DCH Radio Network Identifier specific to E-ROCH defined
in [13]. It is mapped such that _x~id,1\ ~_ corresponds to the MSB.
From the sequence of bits _x~ro,1~_ , _x~ro,2~_ , ..., _x~ro,6~_ a 16 bit CRC
is calculated according to clause 4.2.1.1. That gives the sequence of bits
_c~1~_ , _c~2~_ , ..., _c~16~_ where
$c_{k} = p_{\text{im}(\text{17} - k)}$ _k=1,2,...,16_
This sequence of bits is then masked with _x~id,1~, x~id,2~, ..., x~id,16~_
and appended to the sequence of bits _x~ro,1~_ , _x~ro,2~_ , ..., _x~ro,6~_ to
form the sequence of bits _y~1~_ , _y~2~_ , ..., _y~22~ where_
_y~i~=x~ro,i~ i=1,2, ...,6_
_y~i~=(c~i-6~ + x~id~,~i-6~) mod 2 i= 7, ..., 22_
### 4.10A.5 Channel coding for E-ROCH
Rate 1/3 convolutional coding, as described in Clause 4.2.3.1 is applied to
the sequence of bits _y~1~_ , _y~2~_ , ..., _y~22~_ , resulting in the
sequence of bits _z~1~_ , _z~2~_ , ..., _z~90~_.
### 4.10A.6 Rate matching for E-ROCH
From the input sequence z~1~, z~2~, ..., z~90~ the bits z~1~, z~2~, z~5~,
z~6~, z~7~, z~11~, z~12~, z~14~, z~15~, z~17~, z~23~, z~24~, z~31~, z~37~,
z~44~, z~47~, z~61~, z~63~, z~64~, z~71~, z~72~, z~75~, z~77~, z~80~, z~83~,
z~84~, z~85~, z~87~, z~88~, z~90~ are punctured to obtain the output sequence
r~1~, r~2~, ..., r~60~.
### 4.10A.7 Physical channel mapping for E-ROCH
The E-ROCH sub frame is described in [2]. The sequence of bits _r~1~_ , _r~2~_
, ..., _r~60\ ~_ is mapped to the corresponding E-ROCH sub frame. The bits
_r~k~_ are mapped so that they are transmitted over the air in ascending order
with respect to k.
## 4.11 Mapping for E‑RGCH Relative Grant
### 4.11.1 Overview
The relative grant is transmitted on the E-RGCH as described in [2].
### 4.11.2 Relative Grant mapping
The relative grant (RG) command is mapped to the relative grant value as
described in the table below.
Table 17: Mapping of RG value
* * *
Command RG Value (serving E-DCH RLS) RG Value (other radio links) UP +1 not
allowed HOLD 0 0 DOWN -1 -1
* * *
## 4.12 Mapping for E-HICH ACK/NACK
### 4.12.1 Overview
The ACK/NACK is transmitted on the E‑HICH as described in [2].
### 4.12.2 ACK/NACK mapping
The ACK/NACK command is mapped to the HARQ acknowledgement indicator as
described in the table below.
Table 18: Mapping of HARQ Acknowledgement
* * *
Command HARQ acknowledgement indicator ACK +1 NACK (RLSs not containing the
serving E-DCH cell) 0 NACK (RLS containing the serving E-DCH cell) -1
* * *
###### ## Annex A (informative): Blind transport format detection
# A.1 Blind transport format detection using fixed positions
## A.1.1 Blind transport format detection using received power ratio
For the dual transport format case (the possible data rates are 0 and full
rate, and CRC is only transmitted for full rate), blind transport format
detection using received power ratio can be used.
The transport format detection is then done using average received power ratio
of DPDCH to DPCCH. Define the following:
_\- Pc:_ Received power per bit of DPCCH calculated from all pilot and TPC
bits per slot over a radio frame;
_\- Pd:_ Received power per bit of DPDCH calculated from _X_ bits per slot
over a radio frame;
_\- X:_ the number of DPDCH bits per slot when transport format corresponds to
full rate;
_\- T:_ Threshold of average received power ratio of DPDCH to DPCCH for
transport format detection.
The decision rule can then be formulated as:
If _Pd/Pc >T_ then:
\- full rate transport format detected;
else
\- zero rate transport format detected.
## A.1.2 Blind transport format detection using CRC
For the multiple transport format case (the possible data rates are 0, ...,
(full rate)/r, ..., full rate, and CRC is transmitted for all transport
formats), blind transport format detection using CRC can be used.
At the transmitter, the data stream with variable number of bits from higher
layers is block-encoded using a cyclic redundancy check (CRC) and then
convolutionally encoded. CRC parity bits are attached just after the data
stream with variable number of bits as shown in figure A.1.
The receiver knows only the possible transport formats (or the possible end
bit position {n~end~}) by Layer-3 negotiation. The receiver performs Viterbi-
decoding on the soft decision sample sequence. The correct trellis path of the
Viterbi-decoder ends at the zero state at the correct end bit position.
The blind transport format detection method using CRC traces back the
surviving trellis path ending at the zero state (hypothetical trellis path) at
each possible end bit position to recover the data sequence. For each
recovered data sequence error-detection is performed by checking the CRC, and
if there is no error, the recovered sequence is declared to be correct.
The following variable is defined:
s(n~end~) = - 10 log ( (a~0~(n~end~) -- a~min~(n~end~) ) /
(a~max~(n~end~)-a~min~(n~end~) ) ) [dB] (Eq. 1)
where a~max~(n~end~) and a~min~(n~end~) are the maximum and minimum path-
metric values among all survivors at end bit position n~end~, and a~0~(n~end~)
is the path-metric value at zero state.
In order to reduce the probability of false detection (this happens if the
selected path is wrong but the CRC misses the error detection), a path
selection threshold D is introduced. The threshold D determines whether the
hypothetical trellis path connected to the zero state should be traced back or
not at each end bit position n~end~. If the hypothetical trellis path
connected to the zero state that satisfies:
s(n~end~) ≤ D (Eq. 2)
is found, the path is traced back to recover the frame data, where D is the
path selection threshold and a design parameter.
If more than one end bit positions satisfying Eq. 2 is found, the end bit
position which has minimum value of s(n~end~) is declared to be correct. If no
path satisfying Eq. 2 is found even after all possible end bit positions have
been exhausted, the received frame data is declared to be in error.
Figure A-2 shows the procedure of blind transport format detection using CRC.
{width="5.198611111111111in" height="1.0215277777777778in"}
Figure A.1: An example of data with variable number of bits.\ Four possible
transport formats, and transmitted end bit position nend = 3
{width="5.634027777777778in" height="7.147916666666666in"}
Figure A.2: Basic processing flow of blind transport format detection
# A.2 Blind transport format detection using pseudo-flexible positions
The blind detection procedure for each TTI begins by assuming a hypothesis for
all values of _RM~i~_ of Equation (1) of subclause 4.2.7, based on a
corresponding hypothesis regarding whether certain TrCHs are delivering a
transport block during that TTI. Based on this hypothesis, the blind detection
then proceeds similar to blind transport format detection with fixed
positions. If this hypothesis results in a successful detection of at least
one transport format based on a passing CRC, the assumed hypothesis is
considered to be validated to be correct. If there is no passing CRC, this
process is repeated with another hypothesis, until all hypotheses are
exhausted.
###### ## Annex B (informative): Compressed mode idle lengths
The tables B.1-B.3 show the resulting idle lengths for different transmission
gap lengths, UL/DL modes and DL frame types when DPCCH/DPDCH are used in the
uplink and DPCH in the downlink. The idle lengths given are calculated purely
from the slot and frame structures and the UL/DL offset. They do not contain
margins for e.g. synthesizer switching.
# B.1 Idle lengths for DL, UL and DL+UL compressed mode for DPCH
Table B.1: Parameters for DL compressed mode
+-----+-----------+-----------+-----------+-----------+-----------+ | TGL | DL Frame\ | Spreading | Idle | Tra | Idle | | | Type | Factor | length | nsmission | frame | | | | | [ms] | time | | | | | | | | Combining | | | | | | Reduction | | | | | | | method | | +-----+-----------+-----------+-----------+-----------+-----------+ | 3 | A | 512 -- 4 | 1.73 -- | Spreading | (S) | | | | | 1.99 | factor | | | | | | | division | (D) | | | | | | by 2 or | =(1,2) or | | | | | | | (2,1) | | | | | | Higher | | | | | | | layer | | | | | | | s | | | | | | | cheduling | | +-----+-----------+-----------+-----------+-----------+-----------+ | | B | | 1.60 -- | | | | | | | 1.86 | | | +-----+-----------+-----------+-----------+-----------+-----------+ | 4 | A | | 2.40 -- | | (S) | | | | | 2.66 | | | | | | | | | (D) | | | | | | | =(1,3), | | | | | | | (2,2) or | | | | | | | (3,1) | +-----+-----------+-----------+-----------+-----------+-----------+ | | B | | 2.27 -- | | | | | | | 2.53 | | | +-----+-----------+-----------+-----------+-----------+-----------+ | 5 | A | | 3.07 -- | | (S) | | | | | 3.33 | | | | | | | | | (D) = | | | | | | | (1,4), | | | | | | | (2,3), | | | | | | | (3, 2) or | | | | | | | (4,1) | +-----+-----------+-----------+-----------+-----------+-----------+ | | B | | 2.93 -- | | | | | | | 3.19 | | | +-----+-----------+-----------+-----------+-----------+-----------+ | 7 | A | | 4.40 -- | | (S) | | | | | 4.66 | | | | | | | | | ( | | | | | | | D)=(1,6), | | | | | | | (2,5), | | | | | | | (3,4), | | | | | | | (4,3), | | | | | | | (5,2) or | | | | | | | (6,1) | +-----+-----------+-----------+-----------+-----------+-----------+ | | B | | 4.27 -- | | | | | | | 4.53 | | | +-----+-----------+-----------+-----------+-----------+-----------+ | 10 | A | | 6.40 -- | | ( | | | | | 6.66 | | D)=(3,7), | | | | | | | (4,6), | | | | | | | (5,5), | | | | | | | (6,4) or | | | | | | | (7,3) | +-----+-----------+-----------+-----------+-----------+-----------+ | | B | | 6.27 -- | | | | | | | 6.53 | | | +-----+-----------+-----------+-----------+-----------+-----------+ | 14 | A | | 9.07 -- | | (D) | | | | | 9.33 | | =(7,7) | +-----+-----------+-----------+-----------+-----------+-----------+ | | B | | 8.93 -- | | | | | | | 9.19 | | | +-----+-----------+-----------+-----------+-----------+-----------+
Table B.2: Parameters for UL compressed mode
+-----+---------------+---------------+---------------+---------------+ | TGL | Spreading | Idle length | Transmission | Idle frame | | | Factor | [ms] | time | | | | | | | Combining | | | | | Reduction | | | | | | method | | +-----+---------------+---------------+---------------+---------------+ | 3 | 256 -- 4 | 2.00 | Spreading | (S) | | | | | factor | | | | | | division by 2 | (D) =(1,2) | | | | | or | or (2,1) | | | | | | | | | | | Higher layer | | | | | | scheduling | | +-----+---------------+---------------+---------------+---------------+ | 4 | | 2.67 | | (S) | | | | | | | | | | | | (D) =(1,3), | | | | | | (2,2) or | | | | | | (3,1) | +-----+---------------+---------------+---------------+---------------+ | 5 | | 3.33 | | (S) | | | | | | | | | | | | (D) = | | | | | | (1,4), (2,3), | | | | | | (3, 2) or | | | | | | (4,1) | +-----+---------------+---------------+---------------+---------------+ | 7 | | 4.67 | | (S) | | | | | | | | | | | | (D)=(1,6), | | | | | | (2,5), (3,4), | | | | | | (4,3), (5,2) | | | | | | or (6,1) | +-----+---------------+---------------+---------------+---------------+ | 10 | | 6.67 | | (D)=(3,7), | | | | | | (4,6), (5,5), | | | | | | (6,4) or | | | | | | (7,3) | +-----+---------------+---------------+---------------+---------------+ | 14 | | 9.33 | | (D) =(7,7) | +-----+---------------+---------------+---------------+---------------+
Table B.3: Parameters for combined UL/DL compressed mode
+-----+-----------+-----------+-----------+-----------+-----------+ | TGL | DL Frame\ | Spreading | Idle | Tra | Idle | | | Type | Factor | length | nsmission | frame | | | | | [ms] | time | | | | | | | | Combining | | | | | | Reduction | | | | | | | method | | +-----+-----------+-----------+-----------+-----------+-----------+ | 3 | A or B | DL:\ | 1.47 -- | Spreading | (S) | | | | 512 -- 4 | 1.73 | factor | | | | | | | division | (D) | | | | UL: | | by 2 or | =(1,2) or | | | | | | | (2,1) | | | | 256 -- 4 | | Higher | | | | | | | layer | | | | | | | s | | | | | | | cheduling | | +-----+-----------+-----------+-----------+-----------+-----------+ | 4 | | | 2.13 -- | | (S) | | | | | 2.39 | | | | | | | | | (D) | | | | | | | =(1,3), | | | | | | | (2,2) or | | | | | | | (3,1) | +-----+-----------+-----------+-----------+-----------+-----------+ | 5 | | | 2.80 -- | | (S) | | | | | 3.06 | | | | | | | | | (D) = | | | | | | | (1,4), | | | | | | | (2,3), | | | | | | | (3, 2) or | | | | | | | (4,1) | +-----+-----------+-----------+-----------+-----------+-----------+ | 7 | | | 4.13 -- | | (S) | | | | | 4.39 | | | | | | | | | ( | | | | | | | D)=(1,6), | | | | | | | (2,5), | | | | | | | (3,4), | | | | | | | (4,3), | | | | | | | (5,2) or | | | | | | | (6,1) | +-----+-----------+-----------+-----------+-----------+-----------+ | 10 | | | 6.13 -- | | ( | | | | | 6.39 | | D)=(3,7), | | | | | | | (4,6), | | | | | | | (5,5), | | | | | | | (6,4) or | | | | | | | (7,3) | +-----+-----------+-----------+-----------+-----------+-----------+ | 14 | | | 8.80 -- | | (D) | | | | | 9.06 | | =(7,7) | +-----+-----------+-----------+-----------+-----------+-----------+
(S): Single-frame method as shown in figure 14 (1).
(D): Double-frame method as shown in figure 14 (2). (x,y) indicates x: the
number of idle slots in the first frame, y: the number of idle slots in the
second frame.
NOTE: Compressed mode by spreading factor reduction is not supported when SF=4
is used in normal mode
#