# Foreword
This Technical Specification (TS) was been produced by ETSI Technical
Committee Telecommunications and Internet converged Services and Protocols for
Advanced Networking (TISPAN) and originally published as ETSI TS 183 005 [12].
It was transferred to the 3rd Generation Partnership Project (3GPP) in in
January 2008.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the, stage three, Protocol Description of the
Conference (CONF) service based on stage one and two of the ISDN CONF
supplementary service. Within the Next Generation Network (NGN) the stage 3 is
specified using the IP~~-~~Multimedia Call Control Protocol based on Session
Initiation Protocol (SIP) and Session Description Protocol (SDP).
The present document specifies centralized conferencing, using a conference
focus, distributed conferencing is out of scope.
The present document does not cover the cases of :
a) cascading conference services; and
b) the support of the PSTN/ISDN conference service hosted in the PSTN.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
Referenced documents which are not found to be publicly available in the
expected location might be found at
[http://docbox.etsi.org/Reference]{.underline}.
For online referenced documents, information sufficient to identify and locate
the source shall be provided. Preferably, the primary source of the referenced
document should be cited, in order to ensure traceability. Furthermore, the
reference should, as far as possible, remain valid for the expected life of
the document. The reference shall include the method of access to the
referenced document and the full network address, with the same punctuation
and use of upper case and lower case letters.
NOTE: While any hyperlinks included in this clause were valid at the time of
publication ETSI cannot guarantee their long term validity.
## 2.1 Normative references
The following referenced documents are indispensable for the application of
the present document. For dated references, only the edition cited applies.
For non-specific references, the latest edition of the referenced document
(including any amendments) applies.
[1] ETSI TS 181 002: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Multimedia Telephony with
PSTN/ISDN simulation services\".
[2] ETSI ES 283 003: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); IP Multimedia Call Control
Protocol based on Session Initiation Protocol (SIP) and Session Description
Protocol (SDP) Stage 3 [3GPP TS 24.229 [Release 7], modified]\".
[3] IETF RFC 4575: \"A Session Initiation Protocol (SIP) Event Package for
Conference State\".
[4] Void.
[5] Void.
[6] Void.
[7] ETSI TS 124 147: \"Digital cellular telecommunications system (Phase 2+);
Universal Mobile Telecommunications System (UMTS); Conferencing using the IP
Multimedia (IM) Core Network (CN) subsystem; Stage 3 (3GPP TS 24.147 Release
7)\".
[8] IETF RFC 3891: \"The SIP Replaces header\".
[9] ETSI ES 283 027 \" Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Endorsement of the SIP-ISUP
Interworking between the IP Multimedia (IM) Core Network (CN) subsystem and
Circuit Switched (CS) networks\ [3GPP TS 29.163 (Release 7), modified]\".
[10] ETSI TS 129 163: \"Digital cellular telecommunications system (Phase 2+);
Universal Mobile Telecommunications System (UMTS); Interworking between the IP
Multimedia (IM) Core Network (CN) subsystem and Circuit Switched (CS) networks
(3GPP TS 29.163 Release 7)\".
[11] ETSI TS 183 028: \" Telecommunications and Internet converged Services
and Protocols for Advanced Networking (TISPAN); Common Basic Communication
procedures; Protocol specification \".
## 2.2 Informative references
[12] ETSI TS 183 005 V2.5.0: \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); PSTN/ISDN simulation
services: Conference (CONF); Protocol specification\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TS 181 002 [1] and TS 124 147 [7] apply.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ACR/CB Anonymous Communication Rejection and Communication Barring
AS Application Server
CDIV Communication DIVersion
CONF CONFerence calling
CPG Call ProGress
CS Circuit Switch
ECT Explicit Communication Transfer
HOLD communication HOLD
IBCF Interworking Border Control Function
I-CSCF Interrogating Call Server Control Function
IMS IP Multimedia Subsystem
IP Internet Protocol
ISDN Integrated Service Data Network
MCID Malicious Communication IDentification
MGCF Media Gateway Control Function
NGN Next Generation Network
OIP Originating Identification Presentation
OIR Originating Identification Restriction
P-CSCF Proxy CSCF
PSTN Public Switched **Telephone** Network
SIP Session Initiation Protocol
TIP Terminating Identification Presentation
TIR Terminating Identification Restriction
UE User Equipment
# 4 CONFerence (CONF)
## 4.1 Introduction
The **CONFerence (CONF)** service enables a user to participate in and control
a simultaneous communication involving a number of users.
## 4.2 Description
### 4.2.1 General description
When the CONF service is invoked, conference resources are allocated to the
served user.
Once a conference is active, users can join and leave a conference, and remote
users can be added to or removed from the conference.
Conference participants can request to be informed of these actions.
## 4.3 Operational requirements
### 4.3.1 Provision/withdrawal
The CONF service shall be provided after prior arrangement with the service
provider.
### 4.3.2 Requirements on the originating network side
No specific requirements are needed in the network.
### 4.3.3 Requirements in the network
No specific requirements are needed in the network.
### 4.3.4 Requirements on the terminating network side
No specific requirements are needed in the network.
## 4.4 Coding requirements
For coding requirements see TS 124 147 [7], clause 5.
## 4.5 Signalling requirements
### 4.5.1 Activation/deactivation/registration
Not applicable.
### 4.5.2 Invocation and operation
This clause describes the usage of and the changes to the procedures of TS 124
147 [7] for invoking and operating a conference.
#### 4.5.2.1 Actions at the originating UE
##### 4.5.2.1.1 User joining a conference
Procedures according to TS 124 147 [7], clause 5.3.1.4 shall apply.
##### 4.5.2.1.2 User inviting another user to a conference
Procedures according to TS 124 147 [7], clause 5.3.1.5 shall apply with the
following additions to clause 5.3.1.5.3 of\ TS 124 147 [7]:
> \- A UE that has initiated an emergency call, shall not perform any
> procedures to add the remote user in that call to a conference.
\- In order to avoid the establishment of a second communication to the
invited user, in case of an active session the UE may additionally include the
Replaces header in the header portion of the SIP URI of the Refer-to header of
the REFER request. The included Replaces header shall refer to the active
dialog that is replaced by the ad-hoc conference. The Replaces header shall
comply with RFC 3891 [8].
NOTE 1: In case of an interworking to the PSTN the routing of the INVITE
request from the conference focus to the MGCF that handles the Replaces
information is not deterministic and the replacement of the active dialog
might fail.
EXAMPLE: Refer-To: \.
NOTE 2: If a conference participant invites another user to a conference by
using a REFER request targeted at the other user (following TS 124 147 [7] ,
clause 5.3.1.5.2), there can be cases where such REFER request is intercepted
by an AS serving the requesting user which applies special REFER handling
procedures according to TS 183 028 [11] sub clause 4.7.2.9.7.2. The
consequence of this is that the conference focus AS will receive an INVITE
from the referrers AS and not from the targeted user. This however does not
affect the conference focus procedures in any way.
##### 4.5.2.1.3 User leaving a conference
Procedures according to TS 124.147 [7], clause 5.3.1.6 shall apply.
##### 4.5.2.1.4 User creating a conference
Procedures according to TS 124.147 [7], clause 5.3.1.3 shall apply.
##### 4.5.2.1.5 Subscription for the conference event package
Procedures according to TS 124.147 [7], clause 5.3.1.2 shall apply.
#### 4.5.2.2 Actions at the conferencing AS
##### 4.5.2.2.1 Conference focus
Procedures according to TS 124 147 [7] , clauses 5.3.2 and 6.3.2 shall apply
with the following additions to clause 5.3.2.5.2 of TS 124 147 [7]:
  * If a Referred-By header is available in the REFER request, the AS shall verify if the provided Referred-By header contains a valid identity of the requesting user. If not, the AS shall replace the Referred-By header with a valid value matching the REFER request\'s P-Asserted-Identity.
If no Referred-By header is available in the request, the AS shall add a
Referred-By header that matches the REFER request\'s P-Asserted-Identity.
The procedures described in clause 5.3.2.5.5 of TS 124 147 [7] shall not
apply.
##### 4.5.2.2.2 Conference notification service
In case of the subscription of a conference participant to the conference
notification service, procedures according to\ TS 124.147 [7], clause 5.3.3
shall apply.
#### 4.5.2.3 Actions at the incoming I-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.4 Actions at the outgoing IBCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.5 Actions at the incoming IBCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.6 Actions at the destination P-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.7 Actions at the destination UE
Upon receipt of an INVITE request that includes a Replaces header, the UE
shall apply the procedures described in RFC 3891 [8] to the INVITE request.
#### 4.5.2.8 Actions at the MGCF
Procedures according to TS 124 147 [7] , clause 5.2.4 shall apply.
NOTE: In the case of an interworking a request to a PSTN user to dial into a
conference (by means of sending a REFER request to the PSTN user) will result
in a 403 Forbidden response from the MGCF.
#### 4.5.2.9 Actions at the S-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
## 4.6 Interaction with other supplementary services
### 4.6.1 Communication HOLD (HOLD)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.2 Terminating Identification Presentation (TIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.3 Terminating Identification Restriction (TIR)
For the conferencing AS implementing the conference focus, the following
applies:
  * If a participant is added to the conference and if TIR is active for the terminating party of this session, then the identity information of that participant shall not be included in conference notifications to other participants.
### 4.6.4 Originating Identification Presentation (OIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.5 Originating Identification Restriction (OIR)
For the conferencing AS implementing the conference focus, the following
applies:
  * If a participant joins the conference and if OIR is active for the originating party of this session, then the identity information of that participant shall not be included in conference notifications to other participants.
  * If a REFER request is received and if Privacy header field is set to \"header\" or \"user\", then for the INVITE request to the refer-to target, the conference AS shall:
a) not insert Referred-by header field, if it does not exist in the > REFER
request; or
b) remove Referred-By header field, if Privacy header field of the > REFER
request set to \"user\".
  * If an INVITE request with \"recipient-list\" body is received, and if Privacy header field is set to \"user\", then the conference AS shall anonymize the From header field of resulting reINVITE request, if there is established dialog between the conference controller and the target of the reINVITE request.
### 4.6.6 CONFerence calling (CONF)
Not applicable.
NOTE: Cascading conference services are out of scope of the present
specification.
### 4.6.7 Communication DIVersion services (CDIV)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.8 Malicious Communication IDentification (MCID)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.9 Anonymous Communication Rejection and Communication Barring (ACR/CB)
The focus AS shall not accept REFER requests with a refer-to target that is
barred by the conference creators Outgoing Communication Barring (OCB) rules.
The focus AS shall remove the URI that is barred by the conference creator
Outgoing Communication Barring (OCB) rules from the list of URIs in the
\"recipient-list\" body of INVITE request.
### 4.6.10 Explicit Communication Transfer (ECT)
No impact, i.e. neither service shall affect the operation of the other
service.
## 4.7 Interworking with other networks
### 4.7.1 Interworking with PSTN/ISDN
The procedures of TS 129 163 [10] shall apply with the additions of ES 283 027
[9] and the additions in clause 4.7.1.1.
#### 4.7.1.1 Interworking between the IMS conference status notifications and
the notification messages of the PSTN/ISDN CONF supplementary service
In this clause the interworking from the conference event package RFC 4575 [3]
to the messages of the PSTN/ISDN CONF supplementary service is described. Note
that an interworking from the PSTN/ISDN to the NGN is out of scope.
##### 4.7.1.1.1 Procedures at the MGCF
##### 4.7.1.1.1.1 Subscribing for the conference event package {#subscribing-
for-the-conference-event-package .H6}
Based on local policy, the MGCF may subscribe for the conference event package
on behalf of the PSTN/ISDN participant after he joins or is added to a
conference.
When the conference event package option is implemented, and one of the
following events occurs at the MGCF:
  * A 200 OK is received as a response to an initial INVITE request originated by the MGCF, where the Contact header field contains an \"isfocus\" parameter; or
  * An ACK message is received which acknowledges a 200 OK response to the initial INVITE request, and the initial INVITE request is originated by the conferencing AS and contains an \"isfocus\" parameter in the Contact header field.
Then the following steps shall be performed:
1) A SUBSCRIBE request shall be created according to RFC 4575 [3];
2) The request URI is set to the Contact address of the conferencing AS;
3) The P-Asserted-Identity header field, the From header field and the Privacy
header field are set with the same value as:
  * the P-Asserted-Identity header field, the From header field and the Privacy header field in the initial INVITE request originated by the MGCF; or
  * the P-Asserted-Identity header field, the To header field and the Privacy header field in a 1xx or 2xx response sent by the MGCF to the initial INVITE request from the conferencing AS.
##### 4.7.1.1.1.2 Interworking the Notification {#interworking-the-
notification .H6}
NOTE: There is a need to differentiate between the procedures of interworking
for a full and a partial type of notification.
When a full type of notification is received a check is made of the content.
If the changes with respect a previous version of the notification have not
been sent on to the PSTN/ISDN for this session, the MGCF shall do an ISUP
interaction towards the PSTN. If the changes with respect a previous version
of the notification have been sent to the PSTN/ISDN for this session, the MGCF
shall not do an ISUP interaction towards the PSTN.
When a partial notification is received then it is assumed that a value of a
received notification has changed, so the MGCF shall do an ISUP interaction
towards the PSTN.
  * Conference established:
Upon the receipt of a conference information document with the \ element _active_ is set to \"true\", the MGCF shall send a CPG
message to the CS side with a notification \"_conference established_ \".
  * Participant added:
Upon the receipt of a conference information document with the \ and the element _status of endpointâ€‘status-type_ is set to \"connected\"
and it was not set to \"on-hold\" before and the Contact URI in the element
_entity_ is not the address of the served PSTN/ISDN participant, the MGCF
shall send a CPG message to the CS side with a notification \"_other party
added_ \".
  * Served PSTN/ISDN participant isolated:
Upon the receipt of a conference information document with the \ and the element _status of endpointâ€‘status-type_ is set to \"on-hold\"
and it was set to \"connected\" before and the Contact URI in the element
_entity_ is the address of the served PSTN/ISDN participant, the MGCF shall
send a CPG message to the CS side with a notification \"_isolated_ \".
  * Other participant isolated:
Upon the receipt of a conference information document with the \ and the element _status of endpointâ€‘status-type_ is set to \"on-hold\"
and it was set to \"connected\" before and the Contact URI in the element
_entity_ is not the address of the served PSTN/ISDN participant, the MGCF
shall send a CPG message to the CS side with a notification \"_other party
isolated_ \".
  * Served PSTN/ISDN participant reattached:
Upon the receipt of a conference information document with the \ and the element _status of endpointâ€‘status-type_ is set to \"connected\"
and it was set to \"on-hold\" before and the Contact URI in the element
_entity_ is the address of the served PSTN/ISDN participant, the MGCF shall
send a CPG message to the CS side with a notification \"_reattached_ \".
  * Other participant reattached:
Upon the receipt of a conference information document with the \ and the element _status of endpointâ€‘status-type_ is set to \"connected\"
and it was set to \"on-hold\" before and the Contact URI in the element
_entity_ is not the address of the served PSTN/ISDN participant, the MGCF
shall send a CPG message to the CS side with a notification \"_other party
reattached_ \".
  * Other party disconnected:
Upon the receipt of a conference information document with the \ and the element _status of endpointâ€‘status-type_ is set to
\"disconnected\" and the element _joining-method of joining-type_ is not set
to \"focus-owner, the MGCF shall send a CPG message to the CS side with a
notification \"_other party disconnected_ \".
### 4.7.2 Interworking with PSTN/ISDN Emulation
The interworking with PSTN/ISDN Emulation is for further study.
### 4.7.3 Interaction with external IP network
For SIP based networks the procedures used shall be compliant with **ES 283
003 [1]**.
The interworking with non SIP networks is for further study.
## 4.8 Parameter values (timers)
Not applicable.
###### ## Annex A (informative): Signalling flows
# A.1 Call flow for CONF interworking between NGN and PSTN
Figure A.1 depictures a flow where two UEs are engaged in a call, and one of
the users is located in the PSTN. At some point in time, UE A decides to
activate the CONF service and move the call to a centralized conference. UE A
creates the conference, and provides instructions to the conference server to
contact UE B and replace the initial communication with a communication to the
conference server.
{width="5.800694444444445in" height="7.620138888888889in"}
Figure A.1: CONF interworking signalling flow in case of an active
communication\ between NGN and PSTN
  * Description figure A.1
NOTE: Only the most relevant messages are shown in figure A.1
UE-A is in an active voice session with a PSTN/ISDN TE (SIP dialog with Call-
ID, to-tag and from-tag between UE-A and MGCF). It then creates a conference
and invites the PSTN/ISDN TE to the conference by sending a REFER to the
conference focus, which invites the PSTN/ISDN TE to the conference by sending
an INVITE which includes the Replaces header to the MGCF. The MGCF confirms
the session, switches the existing bearer channel to the new RTP session, and
terminates the session which is replaced.
1\. to 3. UE-A initiates a voice session with a PSTN/ISDN TE by sending an
INVITE to the MGCF.
Table A.1: 1.INVITE (UE-A to P-CSCF)
INVITE tel:+1-212-555-2222 SIP/2.0
Via: SIP/2.0/UDP
[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
Max-Forwards: 70
Route: \,
\
P-Preferred-Identity: \"John Doe\" \
P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
Privacy: none
From: \;tag=171828
To: \
Call-ID: cb03a0s09a2sdfglkj490333
Cseq: 127 INVITE
Require: sec-agree
Proxy-Require: sec-agree
Supported: precondition, 100rel
Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
spi-s=87654321; port-c=8642; port-s=7531
Contact: \
Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE
Content-Type: application/sdp
Content-Length: (...)
v=0
o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd
s=-
c=IN IP6 5555::aaa:bbb:ccc:ddd
t=0 0
m=video 3400 RTP/AVP 98 99
b=AS:75
a=curr:qos local none
a=curr:qos remote none
a=des:qos mandatory local sendrecv
a=des:qos none remote sendrecv
a=rtpmap:98 H263
a=fmtp:98 profile-level-id=0
a=rtpmap:99 MP4V-ES
m=audio 3456 RTP/AVP 97 96
b=AS:25.4
a=curr:qos local none
a=curr:qos remote none
a=des:qos mandatory local sendrecv
a=des:qos none remote sendrecv
a=rtpmap:97 AMR
a=fmtp:97 mode-set=0,2,5,7; maxframes=2
a=rtpmap:96 telephone-event
4: Interaction to reserve resources.
5: SS7: IAM.
7: SS7: ANM.
8: Interaction for session establishment.
9 to 11: The MGCF sends a final response back to the session originator.
Table A.2: 9. 200 OK (MGCF to S-CSCF)
SIP/2.0 200 OK
Via: SIP/2.0/UDP bgcf1.home1.net;branch=z9hG4bK6546q2.1, SIP/2.0/UDP
scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP
pcscf1.home1.net;branch=z9hG4bK431h23.1, SIP/2.0/UDP
[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
Record-Route: \, \
P-Asserted-Identity: \
P-Charging-Vector:
Privacy: none
From:
To: \;tag=314159
Call-ID:
CSeq:
Require: 100rel
Contact: \
Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE
RSeq: 9021
Content-Type: application/sdp
Content-Length: (...)
v=0
o=- 2987933623 2987933623 IN IP6 5555::eee:fff:aaa:bbb
s=-
c=IN IP6 5555::eee:fff:aaa:bbb
t=0 0
m=video 0 RTP/AVP 98 99
m=audio 6544 RTP/AVP 97 96
b=AS:25.4
a=curr:qos local none
a=curr:qos remote none
a=des:qos mandatory local sendrecv
a=des:qos none remote sendrecv
a=conf:qos remote sendrecv
a=rtpmap:97 AMR
a=fmtp:97 mode-set=0,2,5,7; maxframes=2
a=rtpmap:96 telephone-event
12 to 14: The Calling party acknowledges the final response with an ACK
request.
15 to 24: UE-A creates a conference by sending an INVITE to the Conference
Factory URI and connects to the conference.
Table A.3: 15. INVITE request (UE-A to P-CSCF)
> INVITE sip:conference-factory1\@mrfc1.home1.net SIP/2.0
>
> Via: SIP/2.0/UDP
> [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
>
> Max-Forwards: 70
>
> Route: \,
> \
>
> P-Preferred-Identity: \"John Doe\" \
>
> P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
>
> Privacy: none
>
> From: \; tag=171829
>
> To: \
>
> Call-ID: cb03a0s09a2sdfglkj490444
>
> Cseq: 127 INVITE
>
> Require: sec-agree
>
> Proxy-Require: sec-agree
>
> Supported: precondition, 100rel
>
> Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
> spi-s=87654321; port-c=8642; port-s=7531
>
> Contact: \
>
> Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE, SUBSCRIBE,
> NOTIFY
>
> Content-Type: application/sdp
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd
>
> s=-
>
> c=IN IP6 5555::aaa:bbb:ccc:ddd
>
> t=0 0
>
> m=video 3400 RTP/AVP 98 99
>
> b=AS:75
>
> a=curr:qos local none
>
> a=curr:qos remote none
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos none remote sendrecv
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> a=rtpmap:99:MPVMP4V-ES
>
> m=audio 3456 RTP/AVP 97 96
>
> b=AS:25.4
>
> a=curr:qos local none
>
> a=curr:qos remote none
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos none remote sendrecv
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
25 to 27: UE-A invites the PSTN/ISDN TE to the conference by sending a REFER
request to the conference focus, the \"method\" parameter set to \"INVITE\".
The Refer-To header of the REFER request includes the Replaces parameter with
Call-ID, to-tag and fromâ€‘tag from the existing SIP dialog.
Table A.4: 25. REFER request (UE-A to P-CSCF)
> REFER sip: conference1\@mrfc1.home1.net SIP/2.0
>
> Via: SIP/2.0/UDP
> [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
>
> Max-Forwards: 70
>
> Route: \,
> \
>
> P-Preferred-Identity: \"John Doe\" \
>
> P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
>
> Privacy: none
>
> From: \; tag=171829
>
> To: \
>
> Call-ID: cb03a0s09a2sdfglkj490555
>
> Cseq: 127 REFER
>
> Require: sec-agree
>
> Refer-To: \ method=INVITE?Replaces=cb03a0s09a2sdfglkj490333%3Bto-tag%3D314159%3Bfrom-
> tag%3D171828&Requrie=replaces >
>
> Referred-By: \
>
> Proxy-Require: sec-agree
>
> Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
> spi-s=87654321; port-c=8642; port-s=7531
>
> Contact: \
>
> Content-Length: 0
27a: Interactions to reserve resources for an additional participant in the
conference.
28 to 30: The conference focus sends a NOTIFY request containing information
about the progress of the REFER request processing. The Subscription-State is
set to \"active\".
31 to 32: The conference focus invites the PSTN/ISDN TE by sending an INVITE
request to the MGCF. The INVITE request includes the Replaces header with
Call-ID, to-tag and from-tag from the existing SIP dialog.
Table A.5: 31. INVITE request (MRFC/AS to S-CSCF)
> INVITE sip:mgcf1.home1.net SIP/2.0
>
> Via: SIP/2.0/UDP mrfc1.home1.net;branch=z9hG4bK23273846
>
> Max-Forwards: 70
>
> P-Asserted-Identity: \
>
> P-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\";
> orig-ioi=home1.net
>
> Privacy: none
>
> From: \;tag=171123
>
> To: \
>
> Call-ID: bc03a0s09a2sdfglkj490333
>
> Cseq: 127 INVITE
>
> Require: replaces
>
> Replaces: cb03a0s09a2sdfglkj490333;to-tag=314159;from-tag=171828
>
> Supported: precondition, 100rel
>
> Referred-By: \
>
> Contact: \;isfocus
>
> Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE, SUBSCRIBE,
> NOTIFY
>
> Allow-Events: conference
>
> Content-Type: application/sdp
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933615 2987933615 IN IP6 5555::abc:def:abc:abc
>
> s=-
>
> c=IN IP6 5555::abc:def:abc:def
>
> t=0 0
>
> m=video 10001 RTP/AVP 98
>
> b=AS:75
>
> a=curr:qos local none
>
> a=curr:qos remote none
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos none remote sendrecv
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> m=audio 6544 RTP/AVP 97 96
>
> b=AS:25.4
>
> a=curr:qos local none
>
> a=curr:qos remote none
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos none remote sendrecv
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
33: Interaction for switching existing bearer channel to new RTP.
34 to 35: The MGCF sends a final response back to the session originator.
35a: Interaction to add the participant to the conference.
36 to 37: The Calling party acknowledges the final response with an ACK
request.
38 to 40: The conference focus sends a NOTIFY request containing information
about the progress of the REFER request processing. The Subscription-State is
set to \"terminated\".
41: The MGCF replaces the existing RTP stream to UE-A with the new RTP stream
to the conferencefocus.
42 to 44: The MGCF releases the session with UE-A by sending a BYE request to
UE-A.
45 to 47: UE-A responds with a 200 OK response.
# A.2 Call flow for 3PTY CONF
## A.2.1 Invite other user to 3PTY CONF by sending REFER request
Figure A.2 depictures a flow where two UEs, UE-1 and UE-2, are engaged in a
call. At some point in time, UE-1 decides to involve UE-3 into the
communication and activate the 3PTY CONF service. UE-1 puts UE-2 on hold,
initiates a session toward UE-3 to get the user\'s permission to start 3PTY
call, creates the conference, and moves the original communication with both
UE-2 and UE-3 to the conference server.
{width="5.995138888888889in" height="8.788194444444445in"}
Figure A.2: Call flow for 3PTY conference
## A.2.2 Invite other user to 3PTY CONF by sending INVITE request with URI
list
Figure A.3 depictures a flow where UA-A is involved in 2 communications with
UA-B and UA-C, both 2 communications are on-hold. The AS is involved in both 2
communications as a B2BUA.
When user A intends to start the 3PTY conference, UA-A sends INVITE to the AS
to create the conference and indicates that certain dialogs shall be re-used
for this conference, The AS sends re-INVITEs in the indicated dialogs and
connects the media to the conference bridge. The dialogs can be indicated by
adding the Call-ID header field, the From header field and the To header field
to the entries in the URI list of the initial INVITE
{width="5.743055555555555in" height="7.6722222222222225in"}
Figure A.3: Call flow for 3PTY conference
1: UA-A creates a conference and invites user B and user C to the conference
by sending an INVITE to the Conference Factory URI and including URI list in
the INVITE request, UA-A indicates the certain dialogs which be re-used for
this conference in the uri list by ? mechanism.
INVITE CONF AS
To: CONF AS
From: A
Require: recipient-list-invite
Content-Type: application/resource-lists+xml
Content-Disposition: recipient-list
\
\
\
\
\
\
\
2: AS verifies if the dialogs in URI list matches to a partial dialog which AS
already involved, In the case of a match the AS use this dialog ID information
to send re-INVITE request to UA-B and UA-C in the partial dialogs between the
AS and the invited users in order to connect the media of the invited users to
the MRFP.
#