# Foreword
This Technical Specification (TS) was been produced by ETSI Technical
Committee Telecommunications and Internet converged Services and Protocols for
Advanced Networking (TISPAN) and originally published as ETSI TS 183 054 [14].
It was transferred to the 3rd Generation Partnership Project (3GPP) in
December 2007.The contents of the present document are subject to continuing
work within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released by the
TSG with an identifying change of release date and an increase in version
number as follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the, stage three, Protocol Description of the
Closed User Group (CUG) service, based on stage one and two of the ISDN
Communication diversion supplementary services. Within the Next Generation
Network (NGN) the stage 3 description is specified using the IP Multimedia
Communication Control Protocol based on Session Initiation Protocol (SIP) and
Session Description Protocol (SDP).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
Referenced documents which are not found to be publicly available in the
expected location might be found at
[http://docbox.etsi.org/Reference]{.underline}.
For online referenced documents, information sufficient to identify and locate
the source shall be provided. Preferably, the primary source of the referenced
document should be cited, in order to ensure traceability. Furthermore, the
reference should, as far as possible, remain valid for the expected life of
the document. The reference shall include the method of access to the
referenced document and the full network address, with the same punctuation
and use of upper case and lower case letters.
NOTE: While any hyperlinks included in this clause were valid at the time of
publication ETSI cannot guarantee their long term validity.
## 2.1 Normative references
The following referenced documents are indispensable for the application of
the present document. For dated references, only the edition cited applies.
For non-specific references, the latest edition of the referenced document
(including any amendments) applies.
[1] ETSI TS 181 002: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Multimedia Telephony with
PSTN/ISDN simulation services\".
[2] ETSI ES 283 003: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); IP Multimedia Call Control
Protocol based on Session Initiation Protocol (SIP) and Session Description
Protocol (SDP) Stage 3 [3GPP TS 24.229, modified]\".
[3] ETSI EN 300 356-9 (V4.1.2): \"Integrated Services Digital Network (ISDN);
Signalling System No.7 (SS7); ISDN User Part (ISUP) version 4 for the
international interface; Part 9: Closed User Group (CUG) supplementary service
[ITU-T Recommendation Q.735, clause 1 (1993) modified]\".
[4] IETF RFC 5621: \"Message Body Handling in the Session Initiation Protocol
(SIP)\".
## 2.2 Informative references
[14] ETSI TS 183 054 V2.1.0: \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); PSTN/ISDN simulation
services; Protocol specification Closed User Group (CUG)\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TS 181 002 [1] and the following apply:
**basic service:** bearer or teleservice. Within the scope of SIP based
networks the identification of a bearer or teleservice can be derived from the
SDP used
**Closed User Group (CUG) communication:** closed user group communication is
a communication which is restricted to a pre-defined group of users
**Closed User Group (CUG) member:** user who has subscribed to the CUG service
and is one of the users in the group formed by a particular closed user group
**CUG index:** parameter used by the originating user to select a particular
CUG when originating a communication
NOTE: The index is also used by the network to indicate to the terminating
user the CUG from which an incoming communication has originated. This index
has only local significance, i.e. the index used by the originating user is,
in general, different from the index used by the terminating user to identify
the same CUG.
**CUG interlock code:** means of identifying CUG membership within the network
NOTE: At the originating side, if a CUG match exists, the CUG index
identifying a CUG maps to the CUG interlock code for that CUG. If a CUG match
exists at the terminating side the CUG interlock code identifying a CUG maps
to the CUG index representing that CUG. CUG interlock code has relevance on NN
level between AS.
**CUG manager:** authority representing the interests of all the members of a
CUG
NOTE: By planning and controlling the membership and members\' options, the
manager can provide the overall CUG service expected by the members as a
whole. The CUG manager need not be a CUG member and the concept has no
signalling implications.
**Incoming access:** arrangement which allows a member of a closed user group
to receive communications from outside the closed user group
**Incoming communications barred within a closed user group:** access
restriction that prevents a closed user group member from receiving
communications from other members of that group
**Outgoing access:** arrangement which allows a member of a closed user group
to place communications outside the closed user group
**Outgoing communications barred within a closed user group:** access
restriction that prevents a closed user group member from placing
communications to other members of that group
**preferential CUG:** user subscribing to preferential CUG nominates a CUG
index which the network uses as a default to identify the required CUG in the
absence of any CUG information in the outgoing communication request
NOTE: A preferential CUG applies to a Public ID.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ACR Anonymous Call Rejection
**AS** Application Server
**BGCF** Breakout Gateway Control Function
CDIV **Communication DIVersion**
CONF Conference calling
**CSCF** Call Session Control Function
CUG Closed User Group
ECT Explicit Communication Transfer
HOLD communication HOLD
IA Incoming Access
**IBCF** Interconnection Border Control Function
ICB Incoming Communication Barring
IMS IP Multimedia Subsystem
IP Internet Protocol
ISDN **Integrated Service Data Network**
MCID Malicious Communication IDentification
**MGCF** Media Gateway Control Function
NGN Next Generation Network
OA Outgoing Access
OCB Outgoing Communication Barring
OIP Originating Identification Presentation
OIR Originating Identification Restriction
PSTN Public Switched **Telephone** Network
S-CSCF Server-Call Session Control Function
SDP Session Description Protocol
SIP Session Initiation Protocol
TIP Terminating Identity Presentation
TIR Terminating Identification Restriction
UA User Agent
UE User Equipment
**URI** Universal Resource Identifier
XML eXtensible Markup Language
# 4 Closed User Group (CUG)
## 4.1 Introduction
The Closed User Group (CUG) service enables users to form groups of members,
whose communication profile is restricted for incoming and outgoing
communications.
## 4.2 Description
Members of a specific CUG can communicate among themselves but not, in
general, with users outside the group.
Specific CUG members can have additional capabilities that allow them to
initiate outgoing communications to users outside the group, and/or to accept
incoming communications from users outside the group. Specific CUG members can
have additional restrictions that prevent outgoing communications to other
members of the CUG, or prevent incoming communications from other members of
the CUG.
A closed user group consists of a number of members from one or more public,
and/or private networks. A specific user may be a member of one or more CUGs.
Subscription to a closed user group shall be defined for all communication
services, or in relation to one, or to a list of communication services.
## 4.3 Operational requirements
### 4.3.1 Provision/withdrawal
The CUG service shall be provided after prior arrangement with the service
provider.
As a network option based on subscription basis. The CUG service can be
offered with several subscription options.
The provisioning of a new CUG shall require a prior arrangement between the
CUG Manager and the network provider.
The provision of the CUG service to a new member and also the assignment of
the various CUG service options to a new or existing member shall require a
prior arrangement between the CUG member and the network provider in
coordination with the CUG Manager of the affected CUG.
The CUG Service is provisioned by the operator.
The subscription options can be divided into three groups:
  * General Subscription options.
  * Per CUG.
  * Per Public ID.
General Subscription options:
A user can be a member of several closed user groups as shown in table
4.3.1.1. Each CUG is bind to the members with an individual CUG Index. Each
network operator shall define the maximum number of closed user groups which
can be allocated to an individual user.
Table 4.3.1.1: General subscription options
* * *
Subscription options Value Closed user groups List of one or more closed user
group indices
* * *
Subscription options per CUG:
  * For a particular closed user group, the associated set of general subscription options can apply to one basic service, to a particular set of basic services, or to all basic services (see table 4.3.1.2).
Table 4.3.1.2: Subscription options per CUG
+----------------------------------+----------------------------------+ | Subscription options | Value | +----------------------------------+----------------------------------+ | Intra closed user group | None designated | | restrictions (for each closed | | | user group) | ________ | | | ________________ | | | | | | Incoming communications barred | | | within a closed user group | | | | | | ________ | | | ________________ | | | | | | Outgoing communications barred | | | within a closed user group | +----------------------------------+----------------------------------+ | Applicability to basic services | list of one or more basic | | (for each closed user group) | services | | | | | | ________ | | | ________________ | | | | | | all basic services | +----------------------------------+----------------------------------+
Subscription options per Public ID:
  * The network shall provide a subscription option in order to enable the user to specify a preferential closed user group (see table 4.3.1.3).
  * The user can request that no preferential closed user group exists, or can request that a particular one of the user\'s closed user groups (or the only one if a single closed user group applies) is used as a preferential closed user group.
  * The closed user group indices shall be allocated by prior arrangement with the service provider.
  * The choice of preferential closed user group shall be alterable only by service provider action upon request by the served user.
  * The CUG service shall be withdrawn at the customer\'s request, or for administrative reasons.
Table 4.3.1.3: Subscription options per Public ID
+--------------------------------+------------------------------------+ | subscription options | Value | +--------------------------------+------------------------------------+ | Preferential closed user group | None designated | | | | | | _______ | | | _________________ | | | | | | closed user group index | +--------------------------------+------------------------------------+ | Outgoing access | allowed per communication | | | | | | _______ | | | _________________ | | | | | | allowed permanent (default) | | | | | | _______ | | | _________________ | | | | | | not allowed | +--------------------------------+------------------------------------+ | Incoming access | allowed | | | | | | _______ | | | _________________ | | | | | | not allowed | +--------------------------------+------------------------------------+
### 4.3.2 Requirements on the originating network side
For correct interactions with other services, it is necessary for the
originating network side to store, for the duration of the communication,
details of whether a non-CUG, CUG (without outgoing access) or CUG (with
outgoing access) communication was requested in the information sent to the
destination network side. The CUG identity (if any) requested of the
destination network side must also be retained.
### 4.3.3 Requirements in the terminating network
For correct interactions with other supplementary services, it is necessary
for the destination network side to store, for the duration of the
communication, details of whether a non-CUG or CUG (with or without outgoing
access) communication request was passed to the user. The CUG identity (if
any) requested must also be retained.
## 4.4 Coding requirements
### 4.4.1 XML definition
This clause defines the XML Schema to be used for providing the CUG Interlock
code and the CUGcommunicationindicator.
The application/vnd.etsi.cug+xml MIME type used to provide CUG Interlock code,
cugIndex outgoingAccessRequest and the CUGcommunicationindicator the XML used
shall be coded as following described:
\
\
\
\XML Schema Definition for the closed user group\
parameter\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
### 4.4.2 SIP-Messages used for CUG
The following SIP messages are used for the invocation and control of the CUG
service.
Table 4.4.1.1: SIP Message used for CUG
* * *
SIP Message SIP URI parameter Used for INVITE xml MIME CUG  
403 rejection because the user does not belongs to the CUG or other failure.
603 rejection because of barring or CUG with call barring. 500 rejection of a
CUG communication due to network caused reasons e.g. traversing the
communication towards an IMS not supporting the CUG Service.
* * *
## 4.5 Signalling requirements
### 4.5.1 Activation/deactivation/registration
For activation/deactivation/registration of the CUG the Ut interface could be
used. More detail is described in clause 4.9.
Other possibilities for provisioning could be used too like web based
provisioning or pre-provisioning by the operator.
### 4.5.2 Invocation and operation
#### 4.5.2.1 Actions at the originating UA
Explicit request of CUG service:
  * The originating user can explicitly request the CUG service by including in the initial INVITE an xml CUGrequestType containing the preferred CUG and an outgoing access request.
NOTE: If the user is subscribed to the preferential CUG service and the
preferred CUG is not included, the default CUG will be used.
  * To indicate outgoing access the user shall set the value of the \"outgoingAccessRequest\" parameter to TRUE.
Implicit request of CUG service:
  * The originating user with CUG service can request the CUG service without including an xml CUGrequestType in the initial INVITE. In this case the procedures according to ES 283 003 [2] shall apply
Call originating from a user without CUG service:
  * It is possible for a user without CUG service to make a call to a user with CUG service. In this case the procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.2 Actions at the originating P-CSCF
Procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.3 Actions at the originating S-CSCF
Procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.4 Actions at the AS of the originating User
Upon receipt of a request for CUG service the AS shall check its validity as
shown in table 4.5.2.4.1 in conjunction with the access capabilities contained
in the user profile. If a non-valid request is received or the checks cannot
be performed, then the network shall reject the communication and return an
appropriate indication to the originating user.
A received INVITE may include an xml CUGrequestType containing the preferred
CUG and an outgoing access request.
NOTE: In particular, a validation check is performed by verifying that both
the originating and terminating parties belong to the CUG indicated by the
interlock code.
The data for each CUG that a user belongs to, is stored at the AS of the
originating User.
The actions at AS of the originating user at communication set-up from a user
belonging to a CUG, depends on the result of the validation checks performed,
based on whether the user belongs to one or more CUGs.
a) CUG without outgoing access.
If the result of the validation check indicates that the communication should
be dealt with as a CUG communication, the interlock code of the selected CUG
is obtained. The INVITE forwarded towards the terminating network then
includes the cugInterlockBinaryCode, networkIndicator and
cugCommunicationIndicator.
b) CUG communication with outgoing access.
If the result of the validation check indicates that the communication should
be dealt with as a CUG communication with outgoing access, the communication
shall be treated as a Non-CUG communication.
c) Non-CUG.
If the result of the validation check indicates that the communication should
be dealt with as a nonâ€‘CUG communication, the INVITE message forwarded towards
the terminating network then does not include a cugInterlockBinaryCode,
networkIndicator and cugCommunicationIndicator
d) Communication rejected.
If the result of the validation check indicates that the communication is to
be rejected, the communication setâ€‘up is not initiated. A 403 Response with a
Reason header included shall be sent back as shown in table 4.5.2.4.1.
Table 4.5.2.4.1: Validation check of CUG communication concerning the
originating user
+----------+----------+----------+----------+----------+----------+ | | In | | | | | | | dication | | | | | | | from | | | | | | | ori | | | | | | | ginating | | | | | | | user | | | | | | | sent | | | | | | | within | | | | | | | an | | | | | | | INVITE | | | | | +----------+----------+----------+----------+----------+----------+ | Calling | INVITE | INVITE | INVITE | INVITE | INVITE | | user | for CUG | for CUG | for CUG | for CUG | for | | class | with | with | commu | commu | Non-CUG | | defined | CUGIndex | CUGIndex | nication | nication | commu | | within | | & | without | without | nication | | the user | | outgo | CUGIndex | CUGIndex | | | profile | | ingAcces | | & with | | | | | sRequest | | outgo | | | | | | | ingAcces | | | | | | | sRequest | | +----------+----------+----------+----------+----------+----------+ | CUG | CUG | CUG | Return | Return | 403 | | without | commu | commu | 403 | 403 | | | pr | nication | nication | | | | | eference | (*1) | (*1) | | | | | | (*3)\ | (*3)\ | | | | | | IC: | IC: | | | | | | spec. | spec. | | | | | | CUG | CUG | | | | +----------+----------+----------+----------+----------+----------+ | CUG+OAE | CUG | CUG+OA | Return | Non-CUG | Return | | without | commu | (*2) | 403 | commu | 403 | | pr | nication | (*3)\ | | nication | | | eference | (*1) | IC: | | | | | | (*3)\ | spec. | | | | | | IC: | CUG | | | | | | spec. | | | | | | | CUG | | | | | +----------+----------+----------+----------+----------+----------+ | CUG+OAI\ | CUG+OA | CUG+OA | Non-CUG | Non-CUG | Non-CUG | | without | (*2) | (*2) | commu | commu | commu | | pr | (*3)\ | (*3)\ | nication | nication | nication | | eference | IC: | IC: | | | | | | spec. | spec. | | | | | | CUG | CUG | | | | +----------+----------+----------+----------+----------+----------+ | CUG with | CUG | CUG | CUG | 403 | CUG | | pr | commu | commu | (*4) | | commun | | eference | nication | nication | commun | | ication\ | | | (*1) | (*1) | ication\ | | IC: | | | (*3)\ | (*3)\ | IC: | | pref. | | | IC: | IC: | pref. | | CUG | | | spec. | spec. | CUG | | (*4) | | | CUG | CUG | | | | +----------+----------+----------+----------+----------+----------+ | CUG+OAE | CUG | CUG+OA | CUG | Non-CUG | CUG | | with | commu | (*2) | (*4)\ | commu | commu | | pr | nication | (*3)\ | IC: | nication | nication | | eference | (*1) | IC: | pref. | | (*4)\ | | | (*3)\ | spec. | CUG | | pref. | | | IC: | CUG | | | CUG | | | spec. | | | | | | | CUG | | | | | +----------+----------+----------+----------+----------+----------+ | CUG+OAI | CUG+OA\ | CUG+OA\ | (*4) | CUG+OA | (*4) | | with | (*1) | (*2) | (*5) | (*1) | (*5) | | pr | (*2) | (*3) | | (*4)\ | | | eference | (*3)\ | (*1)\ | | IC: | | | | IC: | IC: | | pref. | | | | spec. | spec. | | CUG | | | | CUG | CUG | | | | +----------+----------+----------+----------+----------+----------+ | No CUG | Return | Return | Return | Return | Non-CUG | | | 403 | 403 | 403 | 403 | commu | | | | | | | nication | +----------+----------+----------+----------+----------+----------+ | OAE | | | | | | | Outgoing | | | | | | | access, | | | | | | | explicit | | | | | | | request | | | | | | | r | | | | | | | equired. | | | | | | | | | | | | | | OAI | | | | | | | Outgoing | | | | | | | access, | | | | | | | implicit | | | | | | | outgoing | | | | | | | access | | | | | | | for all | | | | | | | communi | | | | | | | cations. | | | | | | | | | | | | | | IC | | | | | | | I | | | | | | | nterlock | | | | | | | code of | | | | | | | the CUG | | | | | | | s | | | | | | | elected. | | | | | | | | | | | | | | spec. | | | | | | | CUG | | | | | | | specific | | | | | | | CUG | | | | | | | i | | | | | | | ndicated | | | | | | | within | | | | | | | the | | | | | | | CUCIndex | | | | | | | | | | | | | | pref. | | | | | | | CUG | | | | | | | p | | | | | | | referred | | | | | | | CUG | | | | | | | i | | | | | | | ndicated | | | | | | | by the | | | | | | | user | | | | | | | profile | | | | | | | | | | | | | | NOTE: As | | | | | | | IA | | | | | | | ( | | | | | | | incoming | | | | | | | access) | | | | | | | a | | | | | | | ttribute | | | | | | | of the | | | | | | | calling | | | | | | | user is | | | | | | | of no | | | | | | | concern | | | | | | | for this | | | | | | | va | | | | | | | lidation | | | | | | | check, | | | | | | | C | | | | | | | UG+OA/IA | | | | | | | is | | | | | | | eq | | | | | | | uivalent | | | | | | | to | | | | | | | CUG+OA | | | | | | | in this | | | | | | | table. | | | | | | | | | | | | | | (*1) In | | | | | | | case of | | | | | | | OCB | | | | | | | ( | | | | | | | outgoing | | | | | | | commun | | | | | | | ications | | | | | | | barred) | | | | | | | return | | | | | | | 603. | | | | | | | | | | | | | | (*2) In | | | | | | | case of | | | | | | | OCB | | | | | | | within | | | | | | | the CUG, | | | | | | | the | | | | | | | commu | | | | | | | nication | | | | | | | is | | | | | | | int | | | | | | | erpreted | | | | | | | as a | | | | | | | non-CUG | | | | | | | commun | | | | | | | ication. | | | | | | | An | | | | | | | INVITE | | | | | | | without | | | | | | | a | | | | | | | cugInte | | | | | | | rlockBin | | | | | | | aryCode, | | | | | | | networkI | | | | | | | ndicator | | | | | | | and | | | | | | | c | | | | | | | ugCommun | | | | | | | icationI | | | | | | | ndicator | | | | | | | shall be | | | | | | | sent | | | | | | | towards | | | | | | | the | | | | | | | ter | | | | | | | minating | | | | | | | user. | | | | | | | | | | | | | | (*3) In | | | | | | | case the | | | | | | | s | | | | | | | pecified | | | | | | | index | | | | | | | does not | | | | | | | match | | | | | | | any of | | | | | | | the | | | | | | | re | | | | | | | gistered | | | | | | | indices, | | | | | | | 403 | | | | | | | | | | | | | | (*4) In | | | | | | | the case | | | | | | | of OCB | | | | | | | within | | | | | | | the CUG, | | | | | | | this | | | | | | | com | | | | | | | bination | | | | | | | is not | | | | | | | allowed. | | | | | | | | | | | | | | (*5) | | | | | | | Both | | | | | | | \'Pref | | | | | | | erential | | | | | | | CUG\' | | | | | | | and | | | | | | | \'im | | | | | | | plicit\' | | | | | | | outgoing | | | | | | | access | | | | | | | options | | | | | | | imply | | | | | | | that no | | | | | | | su | | | | | | | bscriber | | | | | | | pr | | | | | | | ocedures | | | | | | | are | | | | | | | needed | | | | | | | to | | | | | | | invoke | | | | | | | either | | | | | | | option | | | | | | | when | | | | | | | placing | | | | | | | a | | | | | | | commun | | | | | | | ication. | | | | | | | When a | | | | | | | user | | | | | | | su | | | | | | | bscribes | | | | | | | to both | | | | | | | options, | | | | | | | the | | | | | | | network | | | | | | | does not | | | | | | | know | | | | | | | which | | | | | | | option | | | | | | | the user | | | | | | | is | | | | | | | i | | | | | | | nvoking, | | | | | | | if no | | | | | | | ad | | | | | | | ditional | | | | | | | pr | | | | | | | ocedures | | | | | | | are used | | | | | | | when | | | | | | | placing | | | | | | | the | | | | | | | commun | | | | | | | ication. | | | | | | | Then one | | | | | | | of the | | | | | | | f | | | | | | | ollowing | | | | | | | op | | | | | | | erations | | | | | | | are | | | | | | | reco | | | | | | | mmended: | | | | | | | | | | | | | | a) if | | | | | | | no | | | | | | | inf | | | | | | | ormation | | | | | | | is | | | | | | | given, | | | | | | | the | | | | | | | pref | | | | | | | erential | | | | | | | CUG will | | | | | | | be | | | | | | | assumed, | | | | | | | this | | | | | | | shall be | | | | | | | included | | | | | | | in the | | | | | | | INVITE | | | | | | | sent | | | | | | | towards | | | | | | | the | | | | | | | ter | | | | | | | minating | | | | | | | user. | | | | | | | | | | | | | | b) the | | | | | | | network | | | | | | | will | | | | | | | route | | | | | | | the | | | | | | | commu | | | | | | | nication | | | | | | | with | | | | | | | pref | | | | | | | erential | | | | | | | CUG with | | | | | | | outgoing | | | | | | | access. | | | | | | | The | | | | | | | commu | | | | | | | nication | | | | | | | will | | | | | | | t | | | | | | | herefore | | | | | | | be | | | | | | | c | | | | | | | onnected | | | | | | | if the | | | | | | | ter | | | | | | | minating | | | | | | | access | | | | | | | is: | | | | | | | | | | | | | | - a | | | | | | | member | | | | | | | of | | | | | | | pref | | | | | | | erential | | | | | | | CUG; or | | | | | | | | | | | | | | - a | | | | | | | member | | | | | | | of | | | | | | | another | | | | | | | CUG with | | | | | | | incoming | | | | | | | access; | | | | | | | or | | | | | | | | | | | | | | - a | | | | | | | non-CUG | | | | | | | user. | | | | | | +----------+----------+----------+----------+----------+----------+
When a vnd.etsi.cug+xml MIME body is included in the outgoing INVITE request
the AS shall set the handling parameter in the Content-Disposition for this
MIME body to \"required\" as described in RFC 5621 [4] if outgoing access is
not allowed.
#### 4.5.2.5 Actions at the incoming I-CSCF
Procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.6 Actions at the outgoing IBCF
Procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.7 Actions at the incoming IBCF
Procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.8 Actions at the BGCF
Basic call procedures according to ES 283 003 [2] shall apply.
The interworking with other NGN is described in clauses 4.7.3 and 4.7.4.
#### 4.5.2.9 Actions at the MGCF
Procedures according to ES 283 003 [2] shall apply.
The interworking is described in clause 4.7.1.
#### 4.5.2.10 Actions at the AS of the terminating user
Table 4.5.2.10.1: Handling of a CUG communication at the AS of the terminating
user
+---------+---------+---------+---------+---------+---------+---------+ | | | Class | | | | | | | | of | | | | | | | | term | | | | | | | | inating | | | | | | | | user | | | | | +---------+---------+---------+---------+---------+---------+---------+ | CUG | CUG | CUG | CUG+IA | No CUG | | | | cugC | match | | | | | | | ommunic | check | | | | | | | ationIn | | | | | | | | dicator | | | | | | | | in | | | | | | | | INVITE | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | | | No ICB | ICB | No ICB | ICB | | +---------+---------+---------+---------+---------+---------+---------+ | CUG | Match | CUG | Sent | CUG | Sent | Sent | | with OA | | call | 603 | call | 603 | 403 | | not | | | | | | | | allowed | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | | No | Sent | Sent | | | | | | match | 403 | 403 | | | | +---------+---------+---------+---------+---------+---------+---------+ | CUG | Match | CUG | Sent | CUG+OA\ | Non-CUG | Non-CUG | | with OA | | call | 603 | call | call | call | | allowed | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | | No | Sent | Non-CUG | | | | | | match | 403 | call | | | | +---------+---------+---------+---------+---------+---------+---------+ | Non-CUG | -- | Sent | Non-CUG | | | | | | | 403 | call | | | | +---------+---------+---------+---------+---------+---------+---------+ | IA | | | | | | | | I | | | | | | | | ncoming | | | | | | | | access | | | | | | | | Non-CUG | | | | | | | | call | | | | | | | | | | | | | | | | OA | | | | | | | | O | | | | | | | | utgoing | | | | | | | | access | | | | | | | | | | | | | | | | ICB | | | | | | | | I | | | | | | | | ncoming | | | | | | | | communi | | | | | | | | cations | | | | | | | | barred | | | | | | | | | | | | | | | | Match | | | | | | | | The | | | | | | | | in | | | | | | | | terlock | | | | | | | | code in | | | | | | | | the | | | | | | | | r | | | | | | | | eceived | | | | | | | | INVITE | | | | | | | | matches | | | | | | | | one of | | | | | | | | the | | | | | | | | CUGs to | | | | | | | | which | | | | | | | | the | | | | | | | | user | | | | | | | | b | | | | | | | | elongs. | | | | | | | | | | | | | | | | No | | | | | | | | match | | | | | | | | The | | | | | | | | in | | | | | | | | terlock | | | | | | | | code | | | | | | | | does | | | | | | | | not | | | | | | | | match | | | | | | | | any of | | | | | | | | the | | | | | | | | CUGs to | | | | | | | | which | | | | | | | | the | | | | | | | | term | | | | | | | | inating | | | | | | | | user | | | | | | | | b | | | | | | | | elongs. | | | | | | | | | | | | | | | | NOTE: | | | | | | | | As OA | | | | | | | | at | | | | | | | | tribute | | | | | | | | of the | | | | | | | | term | | | | | | | | inating | | | | | | | | user is | | | | | | | | of no | | | | | | | | concern | | | | | | | | at the | | | | | | | | AS of | | | | | | | | the | | | | | | | | term | | | | | | | | inating | | | | | | | | User , | | | | | | | | CUG+OA | | | | | | | | class | | | | | | | | is | | | | | | | | equ | | | | | | | | ivalent | | | | | | | | to CUG, | | | | | | | | and | | | | | | | | CUG+IA | | | | | | | | class | | | | | | | | is | | | | | | | | equ | | | | | | | | ivalent | | | | | | | | to | | | | | | | | CUG+IA | | | | | | | | in this | | | | | | | | table. | | | | | | | | Subsc | | | | | | | | ription | | | | | | | | of | | | | | | | | prefe | | | | | | | | rential | | | | | | | | CUG by | | | | | | | | the | | | | | | | | term | | | | | | | | inating | | | | | | | | user is | | | | | | | | also of | | | | | | | | no | | | | | | | | concern | | | | | | | | in this | | | | | | | | table. | | | | | | | +---------+---------+---------+---------+---------+---------+---------+
In case of each successful CUG Check an INVITE without a CUG xml MIME shall be
sent towards the terminating user. Therefore the received CUG xml MIME shall
be discarded.
#### 4.5.2.11 Actions at the destination P-CSCF
Procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.12 Actions at the terminating UA
Procedures according to ES 283 003 [2] shall apply.
## 4.6 Interaction with other services
### 4.6.1 Communication Hold (HOLD)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.2 Terminating Identification Presentation (TIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.3 Terminating Identification Restriction (TIR)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.4 Originating Identification Presentation (OIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.5 Originating Identification Restriction (OIR)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.6 Conference calling (CONF)
When the communication involving the first conferee is added to the
conference, then the conference shall assume the CUG of that communication.\
In order to add a subsequent communication to the conference, then the CUG of
that communication shall be checked against the CUG of the conference.
### 4.6.7 Communication Diversion Services (CDIV)
#### 4.6.7.1 Communication Forwarding Unconditional (CFU)
CUG restrictions shall be checked and met for the communication between the
originating party and the forwarding party. The information of a CUG applied
by the NGN on the original communication shall be used for the communication
forwarding and by this means CUG restrictions shall be checked and met for the
communication between the originating party and the forwarded-to party.\ In
the case of multiple forwarding, CUG restrictions between the originating
party and the forwarding party have to be checked and met at each intermediate
forwarding point. In addition, CUG restrictions between the originating party
and forwarded-to party shall be met end-to-end.
The outgoing communication barring information of the forwarding party shall
not be used to determine whether the communication can be forwarded.
The CUG information sent to the \"forwarded-to\" destination shall the same
CUG information of the originating party that was sent from the originating
network.
#### 4.6.7.2 Communication Forwarding Busy (CFB)
See interactions with CFU in clause 4.6.7.1.
#### 4.6.7.3 Call Forwarding No Reply (CFNR)
See interactions with CFU in clause 4.6.7.1.
NOTE: CUG restrictions were checked and met for the communication between the
originating party and the forwarding party when the communication was offered
to the forwarding party.
#### 4.6.7.4 Communication Forwarding on Not Logged-in (CFNL)
See interactions with CFU in clause 4.6.7.1.
#### 4.6.7.5 Communication Forwarding on Subscriber Not Reachable (CFNRc).
See interactions with CFU in clause 4.6.7.1.
#### 4.6.7.6 Communication Deflection (CD)
The information of a CUG applied by the NGN on the original communication
shall be used for the deflected part of the communication and by this means
CUG restrictions shall be checked and met for the communication between the
originating party and the deflected-to party.
In the case of multiple deflections, CUG restrictions between the originating
party and the deflecting party have to be checked and met at each intermediate
deflecting point. In addition, CUG restrictions between the originating party
and deflected-to party shall be met end-to-end.\ When a communication is
deflected, a new check of the CUG restrictions between the originating party
and the deflected-to party is made at the \"deflected-to\" destination. The
CUG information sent to the \'deflected-to\' destination is the same CUG
information of the originating party that was sent from the originating
network.
The outgoing communication barring information of the deflecting party shall
not be used to determine whether the communication can be deflected.
NOTE: CUG restrictions were checked and met for the communication between the
originating party and the deflecting party when the communication was offered
to the deflecting party.
### 4.6.8 Malicious Communication Identification (MCID)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.9 Anonymous Communication Rejection and Communication Barring (ACR/CB)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.10 Explicit Communication Transfer (ECT)
The two communications shall use the same CUG for the transfer to be
successful.
NOTE: CUG restrictions between users will have been checked when the first
communication is established. Similarly, CUG restrictions between users will
have been checked when establishing the second communication.
### 4.6.11 Closed User Group (CUG)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.12 Three-Party (3PTY)
For the successful invocation of the three party simulation service any CUG
restrictions applied to one communication shall match with any CUG
restrictions applied to the other communication.
## 4.7 Interactions with other networks
### 4.7.1 Interaction with PSTN/ISDN
#### 4.7.1.1 Interworking at the I-MGCF
Tables 4.7.1.1.1 and 4.7.1.1.2 show the mapping of CUG relevant messages at
the I-MGCF.
Table 4.7.1.1.1: Mapping of SIP messages to ISUP messages
* * *
SIP Message _ISUP Message_ INVITE containing a XML CUG body with CUG XML
schema _IAM containing the_ **Closed user group interlock code Parameter and
the** _closed user group call indicator of the Optional Forward Call Indicator
Parameter_
* * *
Interworking of the CUG XML schema with the ISUP Closed user group interlock
code parameter and the _Closed user group call indicator_ of the optional
forward call indicator parameter is shown in tables 4.7.1.1.3 and 4.7.1.1.4.
Table 4.7.1.1.2: Mapping of the SIP XML CUG Element to the ISUP closed
usergroup interloccode parameter
* * *
CUG XML Element Source component value ISUP Closed user group interlock code
Parameter derived value of parameter field NetworkIdenticator
networkIdentityType = 4 hexbinary coded digits _\"Network Identity\"_ Octet 1
& Octet 2 including 4 binary coded digits deviated from XML _Network Identity_
CUGInterlockBinaryCode sixteenbitType = 16 bit coded value _\"Binary Code\"_
Octet 3 & Octet 4 including a 16 bit Binary Code deviated from the XML Binary
Code NOTE: ISUP Closed user group interlock code Parameter Octet 1 contains
\"Network Identity\" (NI) digits 1 & 2 and Octet 2 contains \"Network
Identity\" digits 3 & 4.The networkidentityType is filled with \"Octet1 &
Octet 2\" = \"NI digit 1, NI digit 2, NI digit 3, NI digit 4\". Example: Digit
1=0, Digit 2=4, Digit 3=9, Digit 4=0 so the networkidentityType is encoded
with \"0490\".
* * *
Table 4.7.1.1.3: Mapping of the SIP XML CUG Element to the ISUP **_closed user
group call indicator included in the_** optional Forward Call Indicator
Parameter
* * *
CUG XML Element Source component value ISUP _\"Optional Forward Call
Indicator\"_ Parameter derived value of parameter field
cugCommunicationIndicator _Type=00_ _\"closed user group call\" indicator_
non-CUG call _Type=01_ spare _Type=10_ closed user group call, outgoing access
allowed _Type=11_ closed user group call, outgoing access not allowed
* * *
If an INVITE with the MIME including a cug XML element is received and the
terminating network is not supporting CUG then the I-MGCF shall behave as
shown in table 4.7.1.1.4.
Table 4.7.1.1.4: Action at the I-MGCF with a PSTN/ISDN network without CUG
capability
* * *
cugCommunicationIndicator in INVITE Action at the I-MGCF _Type=11 (_ CUG
without outgoing access) Release the communication with 403 _Type=10 (_ CUG
with outgoing access) Treat the communication as an ordinary call NOTE Non-CUG
Treat the communication as an ordinary call NOTE: The
cugCommunicationIndicator shall not be mapped if appropriate or include the
CUG call indicator of the optional forward call indicator to non-CUG call.
* * *
#### 4.7.1.2 Interworking at the O-MGCF
Tables 4.7.1.2.1 and 4.1.2.2 show the mapping of CUG relevant messages at the
O-MGCF.
Table 4.7.1.2.1 Mapping of ISUP messages to SIP messages
* * *
ISUP Message SIP Message IAM containing the **Closed user group interlock code
Parameter and the** closed user group call indicator of the Optional Forward
Call Indicator Parameter INVITE containing a XML CUG body with CUG XML schema
* * *
Table 4.7.1.2.2: Mapping of the ISUP closed usergroup interloccode to SIP XML
CUG element
* * *
_ISUP_ Closed user group interlock code _Parameter_ Source component value CUG
XML Element _derived value of parameter field_ _\"Network Identity\"_ Octet 1
& Octet 2 including 4 binary coded digits NetworkIdenticator
networkIdentityType = 4 hexbinary coded digits deviated from Network Identity
(NOTE) _\"Binary Code\"_ Octet 3 & Octet 4 including a 16 bit Binary Code
CUGInterlockBinaryCode sixteenbitType = 16 bit coded value deviated from
Binary Code NOTE: ISUP Closed user group interlock code Parameter Octet 1
contains \"Network Identity\" (NI) digits 1 & 2 and Octet 2 contains \"Network
Identity\" digits 3 & 4.The networkidentityType shall be filled with \"Octet1
& Octet 2\" = \"NI digit 1, NI digit 2, NI digit 3, NI digit 4\". Example:
Digit 1=0, Digit 2=4, Digit 3=9, Digit 4=0 so the networkidentityType is
encoded with \"0490\".
* * *
Table 4.7.1.2.3: Mapping of the ISUP **_Closed user group call indicator_** to
SIP XML CUG element
* * *
ISUP Optional Forward Call Indicator Parameter Source component value CUG XML
Element derived value of parameter field closed user group call indicator non-
CUG call cugCommunicationIndicator Type=00 spare Type=01 closed user group
call, outgoing access allowed Type=10 closed user group call, outgoing access
not allowed Type=11
* * *
If the IMS network is not supporting CUG the procedures described within ETSI
EN 300 356-9 [3] shall apply if an INVITE with the MIME including a cug XML
element is received.
### 4.7.2 Interaction with PSTN/ISDN Emulation
An interworking is only possible if the XML and AS procedures for cug defined
within the present document are supported by the emulation domain (AS of the
terminating/originating user) connected to.
### 4.7.3 Interaction with external IP networks
ES 283 003 [2] specifies the procedures used by a UE compliant to the TISPAN
SIP profile to communicate with an external SIP device possibly lacking TISPAN
SIP profile capabilities.
###### ## Annex A (informative): Bibliography
ETSI TS 183 028: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Common Basic Communication
procedures; Protocol specification\".
ETSI ES 282 001: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); NGN Functional Architecture
Release 1\".
ETSI ES 283 027: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Endorsement of the SIP-ISUP
Interworking between the IP Multimedia (IM) Core Network (CN) subsystem and
Circuit Switched (CS) networks[3GPP TS 29.163 (Release 7), modified]\".
#