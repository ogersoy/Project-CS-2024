# Foreword
This Technical Specification (TS) was been produced by ETSI Technical
Committee Telecommunications and Internet converged Services and Protocols for
Advanced Networking (TISPAN) and originally published as ETSI TS 183 016 [12].
It was transferred to the 3^rd^ Generation Partnership Project (3GPP) in
December 2007.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the, stage three, Protocol Description of the
Malicious Call Communication Identification (MCID) service based on the stage
one and two of ISDN Malicious Call Identification supplementary service.
Within the Next Generation Network (NGN) the stage 3 description is specified
using the IP Multimedia Call Control Protocol based on Session Initiation
Protocol (SIP) and Session Description Protocol (SDP). The MCID service will
store session related information independent of the service requested.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
Referenced documents which are not found to be publicly available in the
expected location might be found at
_[http://docbox.etsi.org/Reference]{.underline}_.
NOTE: While any hyperlinks included in this clause were valid at the time of
publication ETSI cannot guarantee their long term validity.
[1] ETSI TS 181 002: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Multimedia Telephony with
PSTN/ISDN simulation services\".
[2] ETSI ES 283 003: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); IP Multimedia Call Control
Protocol based on Session Initiation Protocol (SIP) and Session Description
Protocol (SDP) Stage 3 [3GPP TS 24.229 (Release 7), modified]\".
[3] Void.
[4] ETSI TS 181 006: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN);Direct Communication Service in
NGN;Service Description [Endorsement of OMA-ERELD-PoC-V1] NGN DC stage 1\".
[5] Void.
[6] Void.
[7] Void.
[8] Void.
[9] ETSI TS 183 033: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN);IP Multimedia; Diameter based
protocol for the interfaces between the Call Session Control Function and the
User Profile Server Function/Subscription Locator Function; Signalling flows
and protocol details [3GPP TS 29.228 V6.8.0 and\ 3GPP TS 29.229 V6.6.0,
modified]. Endorsement of 29.228 & 29.229\".
[10] IETF RFC 3966: \"The tel URI for Telephone Numbers\".
[11] IETF RFC 3986: \"Uniform Resource Identifier (URI): Generic Syntax\".
[12] ETSI TS 183 016 V2.5.0: \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); PSTN/ISDN simulation
services; Malicious Communication Identification (MCID); Protocol
specification\".
[13] 3GPP TS 29.163: \"Interworking between the IP Multimedia (IM) Core
Network (CN) subsystem and Circuit Switched (CS) networks\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TS 181 002 [1], TS 181 006 [4], TR 180 000 and the following apply:
**communication information:** information collected and registered by the
MCID service
**identity information: includes all the information (RFC 3966 [** 10**] and
RFC 3986 [** 11**]) identifying a user, including trusted (network generated)
and/or untrusted (user generated) identities**
**trusted identity:** network generated user address information
**untrusted identity:** user generated user address information
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ACR Anonymous Communication Rejection
AS Application Server
BGCF Border Gateway Control Function
CB Communication session Barring
CD Communication Deflection
CDIV Communication DIVersion Services
CFB Communication Forwarding Busy
CFNL Communication Forwarding on Not Logged-in
CFNR Communication Forwarding No Reply
CFU Communication Forwarding Unconditional
CONF Conference
CW Call Waiting
DPII Destination Party Identity Information
ECT Explicit Communication Transfer
HOLD communication Hold
IBCF Interconnection Border Control Function
I-CSCF Interrogating - Call Service Control Function
IM IP Multimedia
IMS IP Multimedia Subsystem
IP Internet Protocol
ISDN Integrated Service Digital Network
MCID Malicious Call Identification
MGCF Media Gateway Control Function
NGN Next Generation Network
OIP Originating Identification Presentation
OIR Originating Identification Restriction
OPII Originating Party Identity Information
PSTN **Public Switched Telephone Network**
P-CSCF Proxy - Call Service Control Function
S-CSCF Service - Call Session Control Function
SDP Session Description Protocol
SIP Session Initiation Protocol
TIP Terminating Identification Presentation
TIR Terminating Identification Restriction
UE User Equipment
URI Uniform Resource Identifier
# 4 Malicious Communication Identification (MCID)
## 4.1 Introduction
The MCID service will store session related information of incoming
communications independent of the service requested. The following
communication information shall be registered:
  * Destination Party Identity Information;
  * originating Party Identity Information; and
  * local time and date of the invocation in the network serving the called user.
The communication information shall not be available to the terminal equipment
under the control of the called user nor the originating user. The
communication information shall be stored at a location(s) under the control
of the network operator. In order for the MCID service to operate when two
networks are involved both networks need to be within the same trust domain
for identity information transfer.
A network subscription option may be provided which allows automatic
invocation of MCID service on communications to the served user which are not
answered.
_NOTE_ : The purpose of this option is to allow for registration of
communications that ring for a short time only.
A user subscription option where the MCID service can either be invoked during
the active phase of the communication, or after the active phase for a limited
period but never after communication termination by the served user.
## 4.2 Description
### 4.2.1 General description
The Malicious Communication Identification (MCID) service allows the service
provider to trace the identity information of the source of an incoming
communication on request of the destination user.
## 4.3 Operational requirements
### 4.3.1 Provision/withdrawal
This service shall be provided and withdrawn after pre-arrangement with the
service provider, in accordance with national legal requirements.
This service has two modes: permanent mode and temporary mode. The permanent
mode is active for all incoming communications, and the temporary mode is
active only for the incoming communications declared by the served user.
As a network option, the MCID service can be offered with several subscription
options. A network providing the MCID service shall support permanent mode at
a minimum. Subscription options are summarized in table 4.3.1.1.
Table 4.3.1.1: Subscription options for MCID services
* * *
Subscription options Value
Mode Permanent Mode\ Temporary Mode
* * *
### 4.3.2 Requirements on the originating network side
No specific requirements are needed in the originating network.
### 4.3.3 Void
Void.
### 4.3.4 Requirements on the terminating network side
No specific requirements are needed in the terminating network.
## 4.4 Coding requirements
The present clause defines the XML Schema to be used for providing the MCID
Request/Response and to invoke the temporary mode of the MCID Service.
The application/vnd.etsi.mcid+xml MIME type used to provide request of a
missing originating ID and the delivery of the requested originating id AS of
the served user shall be coded as following described:
\
\
\
\XML Schema Definition to the mcid request-response to the
Malicious Communication Identification simulation service\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
## 4.5 Signalling requirements
### 4.5.1 Activation/deactivation/registration
The MCID service is provisioned only by the network operator as an automatic
invocation on all calls to the served user.
NOTE: On demand invocation by the user may be available in later releases.
### 4.5.2 Invocation and operation
#### 4.5.2.1 Actions at the originating UE
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.2 Actions at the originating P-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.3 Actions at the originating S-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.4 Actions at the terminating S-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
If the subscriber has a permanent or case by case subscription, based on
Initial Filter Criteria (IFC) the INVITE request is forwarded to the AS that
provides the MCID service. Annex B provides an example on how an Initial
Filter Criteria (IFC) can be configured.
#### 4.5.2.5 Actions at the AS of the terminating user
The AS shall at the minimum store the following elements of a received INVITE
request:
  * Destination Party Identity Information included in the Request-URI;
  * Originating Party Identity Information included in the P-Asserted-Identity header field, if the\ P-Asserted-Identity header field is included in the request;
  * local time and date of the invocation in the network serving the called user;
  * call diversion information received in the History-Info header, if the History-Info header filed is included in the request (escaped Reason);
  * Referred-By header field when available;
  * Contact header; [ ]{.underline}
  * To header; and
  * From header.
NOTE: The Originating Party Identity Information included in the P-Asserted-
Identity header field is always present in the INVITE request if the request
is originated in a trusted network.
If the INVITE request does not contain the information of the originating
party, the AS shall send an INFO request including an Identification Request
MIME body.
When receiving the INFO request containing identification information, the AS
shall in addition to the already stored information elements of the earlier
received INVITE request, at the minimum store the information as received in
the body of the INFO request.
##### 4.5.2.5.1 Subscriber has a permanent supervision
The AS shall register stored information. The exact procedure to register the
information is implementation dependent and out of scope of the present
document.
4.5.2.5.2 Subscriber has a temporary subscription
The AS shall store the required elements of a received INVITE request until
the communication has been terminated for a limited period.
A received RE-INVITE of the served user is identified as MCID request and the
AS shall register the required information.
The exact procedure to register the information is implementation dependent
and out of scope of the present document.
After receiving a BYE from the originating side the call state shall be held
for a current time defined by Timer\ TMCID-BYE.
With expiry of the TMCID-BYE the BYE shall be forwarded to the served user and
the communication shall be released according to the basic communication
procedures defined in ES 283 003 [2].
If no MCID request was received the stored elements for the last communication
shall be deleted.
4.5.2.5.3 Request of a missing or incomplete originating Id (network option)
The present clause is applicable when interacting with the PSTN/ISDN.
If a received initial INVITE does not contain an originating identification or
a incomplete originating identification the AS shall send a INFO Message
containing a XML mcid body with MCID XML Request schema requesting the
originating ID towards the originating network.
After sending of the INFO requesting the originating id, timer TO-ID (as
defined in clause 4.8) is started.
When the Identification response (INFO containing a XML mcid body with MCID
XML Response schema containing the originating identity) is received:
  * the timer TO-ID is stopped; and
  * the MCID information is stored;and
  * a 180 Ringing response is sent towards the originating user according to the basic communication procedures.
When a Identification response INFO message is received without the
Originating Party Identity information:
  * timer TO-ID is stopped; and
  * a 180 Ringing response is sent towards the originating user according to the basic communication procedures.
When the timer TO-ID expires before an Identification response INFO message is
received, a 180 Ringing response is sent towards the originating user
according to the basic communication procedures.
#### 4.5.2.6 Actions at the incoming I-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.7 Actions at the outgoing IBCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.8 Actions at the incoming IBCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.9 Actions at the BGCF
Basic call procedures according to ES 283 003 [2] shall apply.
NOTE: The interworking with other NGN is described in clause 4.7.3.
#### 4.5.2.10 Actions at the MGCF
Basic call procedures according to ES 283 003 [2] shall apply.
NOTE: The interworking with other NGN is described in clause 4.7.3.
#### 4.5.2.11 Actions at the destination P-CSCF
Basic communication procedures according to ES 283 003 [2] shall apply.
#### 4.5.2.12 Actions at the destination UE
Basic communication procedures according to ES 283 003 [2] shall apply.
##### 4.5.2.12.1 Subscriber has a temporary subscription
In case of invoking the MCID service the UE shall sent a Re-INVITE.
As a network operator option including a XML-MIME with XML mcid body with MCID
XML Request schema containing a McidRequestIndicator set to 1 could be sent.
## 4.6 Interaction with other services
### 4.6.1 Communication Hold (HOLD)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.2 Terminating Identification Presentation (TIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.3 Terminating Identification Restriction (TIR)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.4 Originating Identification Presentation (OIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.5 Originating Identification Restriction (OIR)
Even if the originating identification is a secret (restricted)
identification, MCID invocation is possible.
### 4.6.6 Conference (CONF)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.7 Communication Diversion Services (CDIV)
The MCID service can be invoked for a diverted communication. In addition to
the normal operation of the MCID service, the identity of the first diverting
user shall be registered and, as a network option, the last diverting user can
be registered.
#### 4.6.7.1 Communication Forwarding Unconditional (CFU)
If the served user has activated CFU service, once forwarding has taken place,
the forwarding user cannot invoke the MCID service.
#### 4.6.7.2 Communication Forwarding Busy (CFB)
If the served user has activated CFB, once forwarding has taken place, the
forwarding user cannot invoke the MCID service.
#### 4.6.7.3 Communication Forwarding No Reply (CFNR)
If the served user has activated CFNR, once forwarding has taken place, the
forwarding user (served user) cannot invoke the MCID service.
The MCID service shall not be automatically invoked when an alerting
communication is terminated due to the invocation of the communication
forwarding no reply service.
#### 4.6.7.4 Communication Forwarding on Not Logged-In (CFNL)
If the served user has activated CFNL, once forwarding has taken place, the
forwarding user (served user) cannot invoke the MCID service even after a log-
in procedure.
The MCID service shall not be automatically invoked when an alerting
communication is terminated due to the invocation of the communication
forwarding not logged in service.
#### 4.6.7.5 Communication Deflection (CD)
If the served user has activated communication deflection, once deflection has
taken place, the deflecting user cannot invoke the MCID service.
The MCID service shall not be automatically invoked when an alerting
communication is terminated due to the invocation of the communication
deflection service.
### 4.6.8 Call Waiting (CW)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.9 Anonymous Communication Rejection and Communication session Barring
(ACR/CB)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.10 Explicit Communication Transfer (ECT)
If the transferor invokes the malicious communication identification
simulation service on an initial communication after that communication has
been successfully transferred then the AS will reject the request.
## 4.7 Interactions with other networks
### 4.7.1 Interworking with the PSTN/ISDN
#### 4.7.1.1 Interworking at the O-MGCF
The following clause describes the interworking of the request/response
mechanism for a missing originating identity in the initial INVITE.
* * *
ISUP Message SIP Message IDR INFO containing a XML mcid body with MCID XML
Request schema IDS INFO containing a XML mcid body with MCID XML Response
schema
* * *
#### 4.7.1.1.1 Interworking of the MCID XML Request schema with the ISUP MCID
request indicators
The following codes are used in the MCID request indicators parameter field.
* * *
bit A: ISUP Parameter XML Element bit A: MCID request indicator
McidRequestIndicato 0 MCID not requested type=0 1 MCID requested type=1
[]{.underline}  
bit B: Holding indicator (national use) HoldingIndicator 0 holding not
requested type=0 1 holding requested type=1
* * *
#### 4.7.1.1.2 Interworking of the ISUP MCID response indicators with the MCID
XML Response schema
The following codes are used in the MCID response indicators parameter field.
* * *
           ISUP Parameter                             XML Element
bit A: _MCID response indicator_ McidResponseIndicator 0 MCID not included
type=0 1 MCID included type=1
bit B: _Hold provided indicator (national use)_ HoldingProvidedIndicator 0
holding not provided type=0 1 holding provided type=1
* * *
[]{.underline}
#### 4.7.1.1.3 Interworking of the ISUP Calling Party Number in an
Identification Response with the OrigPartyIdentity within the MCID XML
Response schema
If the O-MGCF receives an ISUP Identification Response containing a Calling
Party Number with the screening indicator set to \"_user provided, verified
and passed_ \" or \"_network provided_ \", the O-MGCF shall map the Calling
Party Number to the MCID XML Response schema OrigPartyIdentity element
applying the same mapping procedures as specified in 3GPP TS 29.163 [13] table
14 for the mapping into the SIP P-Asserted-Identity header and shall map the
Calling Party Number APRI to the MCID XML Response schema
OrigPartyPresentationRestriction element. If the Calling Party Number APRI has
a value of \"_presentation allowed_ \" then the MCID XML Response schema
OrigPartyPresentationRestriction element shall be set to \"_false_ \",
otherwise it shall be set to \"_true_ \".
##### 4.7.1.1.4 Interworking of the ISUP Generic Number in an Identification
Response with the GenericNumber within the MCID XML Response schema
If the O-MGCF receives an ISUP Identification Response containing a Generic
Number with the screening indicator set to \"_user provided, verified and
passed_ \", or \"_user provided, not verified_ \", or \"_network provided_ \",
the O-MGCF shall map the Generic Number to the MCID XML Response schema
GenericNumber element applying the same mapping procedures as specified in
3GPP TS 29.163 [13] table 13 for the mapping into the SIP From header and
shall map the Generic Number APRI to the MCID XML Response schema
GenericNumberPresentationRestriction element. If the Generic Number APRI has a
value of \"_presentation allowed_ \" then the MCID XML Response schema
GenericNumberPresentationRestriction element shall be set to \"_false_ \",
otherwise it shall be set to \"_true_ \".
### 4.7.1.2 Interworking at the I-MGCF
Not applicable.
### 4.7.2 Interaction with PSTN/ISDN emulation
No MCID service specific impact identified.
### 4.7.3 Interaction with external IP network
If the other external IP network is supporting MCID regarding the present
document no impact is seen.
## 4.8 Parameter values (timers)
A new timer is identified in the destination exchange:
Timer TO-ID: 4-15 seconds.
Timer TO-ID is initiated only at the AS of the served user after sending an
MCID request in an INFO message and is stopped at the receipt of an INFO
containing a XML mcid body with MCID XML Response schema.
At expiry of the timer, the communication continues according to the basic
communication procedures.
A new timer is identified in the AS to count the post time for invoking the
MCID temporary mode.
Timer TMCID-BYE: recommended 0-120 seconds. The timer value is defined by the
Operator.
Timer TMCID-BYE initiated only at the AS of the served user after receiving a
CANCEL or BYE request.
At expiry of the timer, the communication continues shall be released
according to the basic communication procedures defined in ES 283 003 [2].
###### ## Annex A (informative): Signalling Flows
# A.1 MCID invocation
The MCID invokes, in the destination, the storage of data.
Figure A.1 shows an example signalling flow for the scenario.
{width="5.084722222222222in" height="4.510416666666667in"}
Figure A.1: MCID Permanent and triggered by the B user
The steps of the flow are as follows:
1) INVITE request (to S-CSCF).
The INVITE request is sent from the UE to S-CSCF The INVITE includes a
P-Asserted-Identity as follows:
P-Asserted-Identity: \"John Doe\" \ with Privacy: id or
Privacy header or Privacy user.
2) 100 (Trying) Response (from S-CSCF).
3) Evaluation of initial filter criteria.
The initial Filter criteria identifies that the requested URI is subscribed to
the MCID service. Therefore the S-CSCF forwards the INVITE to the MCID AS.
4) INVITE request (S-CSCF to AS).
INVITE is send to the AS.
5) 100 Response from S-CSCF.
6) AS stores Data.
AS stores:
  * Request URI.
  * To header.
  * P-Asserted-Identity header.
  * From header.
  * Contact header.
  * Time and date.
7-12) INVITE request(S-CSCF to AS).
INVITE is send towards the UE:B.
## A.2 Identity information not present in the initial request
Hereby, we show a PSTN to NGN scenario, but notice that any call, originated
in the PSTN domain and being diverted before reaching the served user AS, must
be treated in the same manner. The terminating AS sends a 18x provisional
response previous to sending a SIP INFO message, which requests the
information from the originating network. It can then route the call while
waiting for an answer to the INFO request. Note that the 18x response is sent
reliably, should not indicate ringing (should not be a 180 response), and
contains no SDP. This 18x response establishes a early dialog, which is needed
before the INFO request can be sent.
{width="6.125in" height="2.9479166666666665in"}
Figure A.2.1:MCID with Information Request towards the ISDN/PSTN
The Terminating AS will then wait for an INFO request containing the response
to the information query in the previous INFO request. This message provides
the requested identity. If such a message is not received within a period of
time, the service cannot be provided.
{width="6.125in" height="2.9479166666666665in"}
Figure A.2.2: MCID with Information Response towards the ISDN/PSTN
### A.3 MCID invocation in temporary mode
The MCID invokes, in the destination, the storage of data.
Figure A.3.1 shows an example signalling flow for the scenario.
{width="4.207638888888889in" height="5.595833333333333in"}
Figure A.3.1: MCID Permanent and triggered by the B user
The steps of the flow are as follows:
1) INVITE request (to S-CSCF).
The INVITE request is sent from the UE to S-CSCF The INVITE includes a
P-Asserted-Identity as follows:
P-Asserted-Identity: \"John Doe\" \ with Privacy: id or
Privacy header or Privacy user.
2) 100 (Trying) Response (from S-CSCF).
3) Evaluation of initial filter criteria.
The initial Filter criteria identifies that the requested URI is subscribed to
the MCID service. Therefore the S-CSCF forwards the INVITE to the MCID AS.
4) INVITE request (S-CSCF to AS).
INVITE is send to the AS.
5) 100 Response from S-CSCF.
6) Temporarily AS stores Data.
AS stores:
  * Request URI.
  * To header.
  * P-Asserted-Identity header.
  * From header.
  * Contact header.
  * Time and date.
7-12) INVITE request(S-CSCF to AS).
INVITE is send towards the UE:B.
NOTE: 180 Ringing is not shown.
13-18) UE-B takes the communication. A200 OK is sent towards UE-A.
19-22) UE-B initiates the temporary mode with sending a Re-INVITE.
23) The AS finally stores the regarding MCID data cached at step 6).
###### ## Annex B (informative): Example of filter criteria
This annex provides an example of a filter criterion that triggers SIP
requests that are subject to initial filter criteria evaluation.
**The coding of the Initial Filter Criteria is described in** TS 183 033 [9].
# B.1 Terminating S-CSCF
If a user identified by the Request-URI is provided with the MCID service the
IFC can be:
The S-CSCF forwards all INVITE requests to the AS providing the MCID service.
###### ### Annex C: (void)
Note: In its original form [12] this annex contained the ETSI TISPAN change
request history table which now appears at the start of annex E.
###### ## Annex D (informative): Bibliography
ETSI ETS 300 128: \"Integrated Services Digital Network (ISDN); Malicious Call
Identification (MCID) supplementary service; Service description\".
ETSI EN 300 356-11: \"Integrated Services Digital Network (ISDN); Signalling
System No.7 (SS7); ISDN User Part (ISUP) version 4 for the international
interface; Part 11: Malicious Call Identification (MCID) supplementary service
[ITU-T Recommendation Q.731, clause 7 (1997) modified]\".
ETSI ES 283 027: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); Endorsement of the SIP-ISUP
Interworking between the IP Multimedia (IM) Core Network (CN) subsystem and
Circuit Switched (CS) networks [3GPP TS 29.163 (Release 7), modified]\".
IETF RFC 3265: \"Session Initiation Protocol (SIP) Specific Event
Notification\".
ETSI TR 180 000: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); NGN Terminology\".
#