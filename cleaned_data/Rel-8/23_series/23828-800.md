# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document is a temporary architectural solution placeholder for
Earthquake and Tsunami Warning System (ETWS). This document is to present
various architecture and function approaches for 3GPP networks (i.e. GERAN,
UTRAN, and LTE) based on the ETWS requirements described in TS 22.168 [2].
NOTE: The contents of this Technical Report led into normative specification
of ETWS in related specifications and the contents of this study should be
considered out of date.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"3G Vocabulary\".
[2] 3GPP TS 22.168: \"Earthquake and Tsunami Warning System (ETWS)
Requirements; Stage 1\".
[3] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service (CBS)\".
[4] 3GPP TS 25.331: \"RRC Protocol Specification\".
[5] 3GPP TR 25.925: \"Radio Interface for Broadcast/Multicast Services\".
[6] 3GPP TR 25.419: \"UTRAN Iu interface: Service Area Broadcast Protocol
SABP\".
[7] 3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS);
Architecture and functional description\".
[8] 3GPP TS 22.042: \"Network Identity and Time Zone (NITZ) service
description; Stage 1\".
[9] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core
network protocols; Stage 3\".
[10] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[11] 3GPP TS 23.048: \"Security mechanisms for the (U)SIM application toolkit;
Stage 2\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**Primary Notification:** is information which is used specifically in
_Earthquake and Tsunami Warning System_ in order to notify users about the
most urgent event in seconds rather than minutes, such as imminent occurrence
of Earthquake.
**Secondary Notification:** is information which is used specifically in
_Earthquake and Tsunami Warning System_ in order to notify users supplementary
information that is of lesser urgency such as instructions on what to do /
where to get help, for example, map to refuge facilities, time table of food
distribution .These information, in general, would be issued by local
government.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] apply. An abbreviation defined in the present document takes precedence
over the definition of the same abbreviation, if any, in TR 21.905 [1].
# 4 Overview of ETWS
## 4.1 General
## 4.2 Technical requirements
The following technical requirements are identified:
\- The primary Notification shall be delivered within 4 seconds from the
presentation of the information to the PLMN to the UE in the Notification
Area. This may require the introduction of additional capabilities to current
messaging services
\- Based on the geographical information indicated by the Warning Notification
Provider, the network operator shall have the capability to select the
Notification Areas on their network configuration such as distribution of
cells, Node Bs, and RNCs. At least NodeB level granularity shall be achieved.
\- Primary Notification shall support at least three types of emergency
indications: Earthquake, Tsunami, and Testing.
\- Primary Notification and Secondary Notification shall support indications
of UE behaviour. Specification on the number of UE behaviours and types of UE
behaviour is FFS.
\- A security mechanism shall be provided to mitigate threats of duplicate or
false ETWS messages.
\- The solution shall attempt to minimize the impact to the UE battery life.
## 4.3 Architectural considerations
Following architectural considerations are identified:
\- Network operator may deploy multiple radio access technologies e.g. both
GERAN and UTRAN or LTE and UTRAN; consequently, the consideration is how the
warning notification can be sent to users with different messaging service
centres (e.g. CBC for CBS and BM-SC for MBMS).
# 5 Alternative 1: CBS with IMSI paging
## 5.1 General
This clause describes the ETWS architecture using CBS (TS 23.041 [3]). The
intention is not to cause any architectural impact to the network and the UE.
Protocol level impact may be expected, in which ETWS specific indications
shall be provided. The following solution applies to idle-mode UE only.
Editor\'s Note: A solution for Active-mode UE will be studied.
The solution applies to GERAN, UTRAN, and EUTRAN.
This clause however describes in detail the applicability to the UTRAN case.
Figure 5.1.1: Overview of CBS architecture on UMTS
\- The functionality of CBE and the capability of CBE-CBC interface are
outside the scope of the 3GPP specification.
\- The cell broadcast centre (CBC) is part of the core network and connected
to a routing node e.g. a 3G SGSN via the Bc reference point.
\- Based on this architecture and on the current requirements for cell
broadcast, the core network elements such MSC, VLR, HLR etc are not involved
in the service delivery.
## 5.2 Description
### 5.2.1 Solution for Idle-Mode UE
For idle mode UEs, the function and protocol specifications are based on the
mechanism described in TS 23.041 [3]. In addition, an enhancement of the RNC
capability to use PAGING TYPE1 as the Primary Notification is presented below.
For Secondary Notification, Cell Broadcast is used.
In this solution, it is proposed to reuse the existing paging message on the
radio accesses, by using the unique MCC+MNC combination [MCC=901, MNC=08]. The
combination [MCC=901, MNC=08] is currently reserved for 3GPP use, therefore it
can be assured that no mobiles exist with IMSIs starting with MCC=901, MNC=08.
ETWS-enabled mobiles would \"understand\" IMSIs starting with [MCC=901,
MNC=08] and would react to it accordingly. The remaining part of the IMSI
(i.e. the \"MSIN\" part), can be used to convey more data to the EWTS-enabled
mobiles. This allows having no impact to the over-the-air protocols, which do
not need to be modified, and minimizing the impact to the battery life of the
UE.
Figure 5.2.1 Enhanced CBS procedure
1\. CBC shall initiate the procedure by sending a WRITE-REPLACE message to the
RNC. The message shall included Disaster Type, earthquake or tsunami. The
message may include additional information in the _Broadcast Message Content_
field.
2\. According to TS 23.041 [3], functionality of RNC for CBS control is
\"_Scheduling of CBS messages on the CBS related radio resources\"_. In
detail, modification of system information which is higher-level scheduling
information (TR 25.925 [5]) including the change indication of CTCH data
allocation on FACH and SCCPCH triggers RNC to send PAGING TYPE 1 message to
the UE for CBS related radio resources control. In addition, upon the
reception of WRITE-REPLACE message, the PAGING TYPE 1 message includes an IMSI
starting with [MCC=901, MNC=08] and coded according to the type of emergency
(earthquake, tsunami or testing) the alerts refer to. The MSIN part of the
IMSI may contain additional information (see clause 5.2.2.3) based on the
content of the _Broadcast Message Content_ field. How this ETWS indication is
secured is FFS.
3\. The RNC sends a BMC SCHEDULE MESSAGE to provide DRX information of cell
broadcast data at the UE.
4\. The RNC sends a BMC CBS MESSAGE which carries the actual cell broadcast
data.
5\. The RNC sends a BMC REPORT-SUCCESS in return of Write-Replace.
### 5.2.2 Suggested Information Elements
#### 5.2.2.1 General
This clause describes a description of the information elements used in the
delivery of ETWS primary / secondary notifications. These are further
specified in Stage 3.
#### 5.2.2.2 WRITE-REPLACE
Information elements of WRITE-REPLACE (TS 25.419 [6]) with additional
information element of _Disaster Type_ are presented below.
Table 5.2.2.2: Contents of WRITE-REPLACE
* * *
PARAMETER PRESENCE Message Type M Message Identifier M New Serial Number M Old
Serial Number O Service Areas List M Category O Repetition Period M Number of
Broadcasts Requested M Data Coding Scheme M Broadcast Message Content M
Disaster Type O
* * *
Disaster Type represents the type of disaster, and for ETWS type of
\"earthquake\" and \"tsunami\" shall be supported.
#### 5.2.2.3 PAGING TYPE 1 for Primary Notification
The Information elements of PAGING TYPE1 (TS 25.331 [4]) contains an IMSI
starting with [MCC=901, MNC=08].
The MSIN part of the IMSI contains ten digits (in BCD format) and therefore
can be used to code various additional pieces of information, for example:
\- A regional indicator, to allow future extensions in the coding semantic,
should new requirements occur at a later stage.
\- The expected behaviour of the mobile device (e.g. emit a sound at reception
of primary information, vibrate at reception of secondary information, etc.).
\- The type of emergency (e.g. tsunami, earthquake).
\- Location of the supplementary information (e.g. \"CBS\", plus CBS channel
number, or \"MBMS\", etc.).
\- Additional room to provide an identifier to the alert, e.g. to prevent
duplication. This particular aspect relates to security implications of ETWS,
which are expected to be addressed by SA WG3
The following two figures pictorially illustrate examples of the usage of IMSI
starting with the 901-08 combination:
\- Figure 5.2.2.3.1 shows the more general case of IMSIs starting with
MCC=901, MNC=08. This is a generic depiction that shows how some potential
flexibility exists in the construction of the \"further details\".
\- Figure 5.2.2.3.2 shows an example of usage of IMSIs starting with MCC=901,
MNC=08, in line with the above description.
{width="3.872916666666667in" height="1.5222222222222221in"}
Figure 5.2.2.3.1: Usage of MCC=901, MNC=08 for ETWS -- example of \"generic\"
coding
{width="5.995833333333334in" height="2.4097222222222223in"}
Figure 5.2.2.3.2: Usage of MCC=901, MNC=08 for ETWS --example of coding of the
further details
For Secondary Notification, as it is stated in TS 22.168 [2], there is a
requirement that network shall be able to indicate UE behaviour for Primary
Notification and Secondary Notification. On the regard of Primary
Notification, it is possible to indicate so by utilizing the information value
included in PAGING TYPE1 described above.
#### 5.2.2.4 CBS Message for Secondary Notification
For Secondary Notification (CBS Message), the Message Code in Serial Number is
used as shown below (see TS 23.041 [3]). With this proposal there will be no
network architecture enhancement, but this only introduces additional usage of
Message Code.
* * *
Octet 1 Octet 2  
7 6 5 4 3 2 1 0 7 6 5 4 3 2 1 0 GS Message Code Update Number
* * *
Figure 5.2.2.4.1: Contents of Serial Number
Although it is under the responsibility of CT WG1 to specify parameter of
Serial Number, to capture the concrete idea, following is the example contents
of Serial Number.
Table5.2.2.4.1: Information Value of Message Code for indication of UE
behaviour
+-------------------------------+-------------------------------------+ | Message Code | UE behaviour | | | | | (Octet1 bit5 and Octet1 bit4) | | +-------------------------------+-------------------------------------+ | 00 | Normal | +-------------------------------+-------------------------------------+ | 01 | Display content of message in the | | | foreground | +-------------------------------+-------------------------------------+ | 10 | Ring a buzzer | +-------------------------------+-------------------------------------+ | 11 | Display content of message in the | | | foreground and ring a buzzer | +-------------------------------+-------------------------------------+
## 5.3 Summary
### 5.3.1 Evaluation
This solution is evaluated as follows:
Table 5.3.1.1: Solution evaluation on enhanced CBS
+----------------+----------------+----------------+----------------+ | ETWS | Description | Meet | Comments | | Requirements | | Requirement? | | +----------------+----------------+----------------+----------------+ | 1 Duration of | Primary | Yes | | | delivery time | Notification | | | | | delivery time | | | | | is less than 4 | | | | | seconds. | | | +----------------+----------------+----------------+----------------+ | 2 Granularity | Granularity of | Yes | | | of the | broadcast area | | | | distribution | coincides with | | | | | granularity of | | | | | cell sites | | | +----------------+----------------+----------------+----------------+ | 3 Information | It is possible | Yes | For Secondary | | element | to distinguish | | Notification, | | | between | | it may be | | | Primary | | possible by | | | Notification | | allocating new | | | for earthquake | | CBS Message ID | | | and tsunami | | for ETWS. | | | with value | | | | | included in | | Specification | | | Paging Type1. | | of ETWS | | | | | specific | | | | | Message ID is | | | | | required to | | | | | satisfy SA1 | | | | | requirement. | | | | | | | | | | Specification | | | | | on this point | | | | | is FFS. | +----------------+----------------+----------------+----------------+ | | It is possible | Yes | When using | | | to distinguish | | Cell Broad | | | ETWS message | | Cast and | | | from others | | Message ID | | | using sender | | assigned to | | | information | | warning | | | e.g. Message | | notification | | | ID. | | can be | | | | | recognized by | | | | | UE, then the | | | | | ETWS is | | | | | d | | | | | istinguishable | | | | | within CBS | | | | | messages. | +----------------+----------------+----------------+----------------+ | | Primary | Yes | | | | Notification | | | | | is possible to | | | | | indicate UE | | | | | behaviour for | | | | | earthquake and | | | | | tsunami with | | | | | value included | | | | | in Paging | | | | | Type1. | | | | | | | | | | Secondary | | | | | Notification | | | | | is possible to | | | | | indicate UE | | | | | behaviour for | | | | | earthquake and | | | | | tsunami with | | | | | value included | | | | | in Serial | | | | | Number. | | | +----------------+----------------+----------------+----------------+ | 4. Active | | FFS | Note: This row | | Mode | | | will be filled | | | | | after SA1 | | | | | provides the | | | | | requirements. | +----------------+----------------+----------------+----------------+
# 6 Alternative 2: E-MBMS
## 6.1 General
This clause describes the ETWS architecture using E-MBMS (TS 23.246 [7]). The
intention of this architecture alternative is not to give any architectural
impact to the network and the UE.
{width="6.652083333333334in" height="2.1756944444444444in"}
Figure 6.1.1: eMBMS architecture for EPS
NOTE: The eBM-SC uses both MBMS Bearers (over SGmb/SGi-mb) and EPS Bearers
(over SGi).
## 6.2 Description
### 6.2.1 Alternative 2-1: Pure eMBMS
#### 6.2.1.1 General
In this alternative, ETWS primary / secondary notifications are sent as MBMS
data, as described in TS 23.246 [7].
#### 6.2.1.2 Description
The function and protocol specifications are described in TS 23.246 [7].
Figure 6.2.1.2.1: eMBMS Session Start procedure for E-UTRAN
1\. eBM-SC sends a Session Start Request message to MBMS2 to indicate the
impending start of the transmission and to provide the session attributes
(QoS, MBMS service Area, Session identifier, estimated session duration). The
list of session attributes is FFS.
2\. The MBMS2 responds with a Session Start Response message with information
for eBM-SC to send MBMS data to the MBMS2.
3\. The MBMS2 stores the session attributes and allocates a transport network
IP multicast address for this session and sends a Session Start Request
(session attributes, including IP Multicast Address) message to MBMS1.
4\. The MBMS1 stores the session attributes and responds to the MBMS2.
5\. The MBMS1 sends a Session Start Request message to E-UTRAN.
Editor\'s Note: It is FFS whether MBMS1 can send Session Start to all E-UTRAN
nodes controlled by that MBMS 1 and rely on E-UTRAN to perform Service Area
filtering.
6\. The E-UTRAN responds the MBMS1 to confirm the reception of the Session
Start Request message.
Editor\'s Note: The order of step 7 and step 8 is ffs.
7\. The eNodeBs send IP multicast Join message to the received user plane IP
multicast address allocated by the MBMS2.
Editor\'s Note: It is FFS at what time the eNodeB performs Join after
receiving Session Start Request message.
8\. The E-UTRAN establishes the necessary radio resources for the transfer of
MBMS data to the interested UEs. RAN resource set up can be scheduled
according to the time to MBMS data transfer parameter.
9\. The eBM-SC starts sending the ETWS primary / secondary notification as
MBMS data.
10\. MBMS2 function receives ETWS primary / secondary notification as MBMS
data and may add synchronization information (ffs at this stage). MBMS2 sends
the ETWS primary / secondary notification as MBMS data using IP multicast
towards all joined eNBs.
### 6.2.2 Alternative 2: Primary Notification in Session Start
#### 6.2.2.1 General
In this alternative, ETWS Primary notification is sent in Session Start
message and Secondary notification is sent as MBMS data.
#### 6.2.2.2 Architecture Details
The function and protocol specifications are described in TS 23.246 [7].
Figure 6.2.2.2.1: eMBMS Session Start procedure for E-UTRAN
1\. eBM-SC sends a ETWS Primary Notification indicator in Session Start
Request message to MBMS2 to indicate the impending start of the transmission
and to provide the session attributes (QoS, MBMS service Area, Session
identifier, estimated session duration). The list of session attributes is
FFS.
2\. The MBMS2 responds with a Session Start Response message with information
for eBM-SC to send MBMS data to the MBMS2.
3\. The MBMS2 stores the session attributes and allocates a transport network
IP multicast address for this session and sends a ETWS primary notification
indicator in Session Start Request (session attributes, including IP Multicast
Address) message to MBMS1.
4\. The MBMS1 stores the session attributes and responds to the MBMS2.
5\. The MBMS1 sends a ETWS Primary notification indicator in Session Start
Request message to E-UTRAN.
6\. The E-UTRAN responds the MBMS1 to confirm the reception of the Session
Start Request message.
7\. The eNodeBs send IP multicast Join message to the received user plane IP
multicast address allocated by the MBMS2.
8\. The E-UTRAN establishes the necessary radio resources for the transfer of
MBMS data to the interested UEs. RAN resource set up can be scheduled
according to the time to MBMS data transfer parameter. Primary Notification is
sent from eNB to the UE during this procedure [FFS]. How this will be secured
is FFS.
9\. The eBM-SC starts sending the ETWS secondary notification as MBMS data.
10\. MBMS2 function receives ETWS secondary notification as MBMS data and may
add synchronization information (ffs at this stage). MBMS2 sends the ETWS
secondary notification as MBMS data using IP multicast towards all joined
eNBs.
## 6.3 Summary
For E-MBMS, Alternative 2 is preferable to alternative 1, because with this
approach Primary notification can be sent to the UE faster than sending
Primary Notification as MBMS message.
E-MBMS alternative will be applicable to EUTRAN access only.
# 7 Alternative 3: MBMS
# 8 Alternative 4: Enhanced CBS over GERAN with idle and connected mode
solutions
## 8.1 General
This alternative describes how CBS could be slightly enhanced to provide ETWS
warning notifications across GERAN.
## 8.2 Idle mode description
The following procedure is applicable for idle mode mobiles:
{width="6.040277777777778in" height="4.113888888888889in"}
Figure 8.2.1: GERAN Idle Mode
0 The SMS CB Service Centre receives an authenticated request from a valid
authority to send an \"ETWS warning\". The SMS CB uses the TS 23.048 [11]
framework to encrypt the CB message and the TS 23.041 [3] mechanisms to
indicate that the CB message shall be delivered by the ME to the (U)SIM.
1 The SMS CB SC sends an \"ETWS\" write-replace to the BSC. The BSC recognises
the ETWS tag and acts differently to normal SMS CBs.
2 The BSC sends the SMS BROADCAST REQ with an \"ETWS\" tag to all its BTSs
(within the impacted area)
3 The BTS uses the ETWS tag to alert all idle mode mobiles that they should
enable CB reception (to save battery power, many mobiles may have it switched
off). The BTS (or BSC) does this by setting the \"page mode\" to \"same as
before\" in all paging request type 1, type 2, type 3, Immediate assignment,
immediate assignment extended and Immediate assignment reject messages that it
sends (for a time period that at least exceeds multiple DRX periods. The
equivalent messages on any/every PBCCH that is in use also have their \"page
mode\" set to \"same as before\".
In parallel, the BTS starts, at the earliest opportunity sending the actual
ETWS CB message. This message is continually repeated for the duration
indicated by the SMS CB Service centre.
NOTE Alternative CB \'switch on\' mechanisms might include a pre-defined TMSI
that is sent with the \'identity type\' set to \"no identity\". However this
mechanism would interrupt on-going cellular operations (e.g. page request type
3 and Immediate Assignment messages can not be sent).
4 The mobile activates CB reception. (For mobiles receiving GPRS data, this
might reduce the GPRS data rate).
5 The mobile receives the CB message and passes it to the (U)SIM.
6 The (U)SIM decrypts the message and checks its validity (e.g. that integrity
checks and replay protection checks are successful).
7 (U)SIM tool kit features are used to pass the decrypted warning back to the
ME.
8 The ME displays the warning and alerts the user (possibly over-riding
internal ME \'silent mode\' settings).
## 8.3 Connected mode solution
GSM Cell broadcast is not received by mobiles that are in calls (have RR
connections established). These users might also benefit from notification.
The following procedure might be suitable for connected mode mobiles:
{width="6.040277777777778in" height="4.113888888888889in"}
Figure 8.2.2: GERAN connected mode
0,1,2 These steps are the same as step 0,1,2 in the idle mode solution.
3 The BTS copies the CB message content into a point to point short message
structure, with the SMS indicating that the mobile shall deliver it to the
(U)SIM. A new internal SMS header field can be defined that indicates to the
(U)SIM that the body is a converted ETWS encrypted CB message,
4 For each mobile in RR connected mode, the BTS establishes SAPI 3 on the
SACCH (this might interrupt/reset ongoing SMS message transfer -- but increase
the chance of ETWS warning delivery).
5 The mobile acknowledges establishment of SAPI 3.
6 The BTS sends the SMS to the mobile.
7 The mobile receives the SMS message and passes it to the (U)SIM
8 The (U)SIM decrypts the message and checks its validity (eg, that integrity
checks and replay protection checks are successful).
9 (U)SIM tool kit features are used to pass the decrypted warning back to the
ME.
10 The ME displays the warning and alerts the user (possibly over-riding
internal ME \'silent mode\' settings).
# 9 Alternative 5: Enhanced CBS with Optional Information Elements Over Paging
Message
## 9.1 Architecture Overview
This clause describes the ETWS architecture using a CBS core network (TS
23.041 [3]). While Alternative 1 focuses only on the delivery speed of the
warning notification, this alternative considers the security aspects as well
to cover the global requirements.
Figure 9.1.1: Overview of ETWS architecture
\- The functionality of Government ETWS Centre (GEC) and the capability of
CBE-CBC interface are outside the scope of the 3GPP specification.
\- The cell broadcast centre (CBC) is part of the core network and connected
to a concentrator node e.g. a GERAN BSC, UTRAN RNC or EPS nodes via the Bc
reference point.
NOTE 1: TS 23.041 [3] defines the individual interfaces for GERAN/UTRAN.
\- Based on this architecture and on the current requirements for cell
broadcast, other core network elements such as MSC, VLR, SGSN, GGSN, HLR etc
are not involved in the service delivery.
NOTE 2: The architecture for EPS (MME or E-UTRAN) [FFS] is still under
development.
## 9.2 High Level Description for GERAN, UTRAN and E-UTRAN
### 9.2.1 UE support
While the support of ETWS in UE is optional, UEs that support ETWS are
intended to comply with this description.
### 9.2.2 Solution for Idle-Mode UE
For idle mode UEs, the ETWS warning information is broadcast within the cell.
In order to minimise UE battery consumption, the UE follows its normal DRX
scheme. When the UE wakes up for its paging occasion and ETWS information is
being sent, the UE is commanded to receive the ETWS information.
In some cases, the ETWS information is fully contained within the paging
message. More usually, security requirements mean that the UE has to also
receive other broadcast information.
The ETWS information is made available to the GERAN/UTRAN/E-UTRAN using the
CBS infrastructure and mechanisms described in TS 23.041 [3].
NOTE: The above-mentioned solutions are to be considered in RAN and GERAN
groups.
### 9.2.3 Solution for Connected-Mode UE
For GERAN, the GSM BTS can encapsulate the Warning and Security Information
into a point-to-point SMS and inject it into the SACCH of each mobile. See
\"Alternative 5\" for more details.
For UTRAN, UEs in URA-PCH and Cell-PCH should monitor the paging channel and
react to \"ETWS paging\" a paging messages with ETWS indication in the same
way as idle mode UEs. Solutions for UEs in other RRC connected mode sub-states
are not specified in this release of the specifications.
For E-UTRAN, solution for Connected-Mode UE should be specified.
Note: The above-mentioned solutions are to be further considered in RAN and
GERAN groups.
### 9.2.4 Security
Security is provided by appending Digital Signatures and Timestamps to the
Warning Information.
This security mechanism is based on regulatory requirements.
A regulator in a certain different country can put preference on speed of
delivery time over security features. A mechanism to mitigate security threats
which could happen in such a country is provided by ensuring that the UE only
accepts \"unsigned\" warnings in that country, and that , the UE has
authenticated the network during its registration in that country. This
requires the use of a USIM, rather than a SIM.
NOTE: Details of the security mechanism are to be investigated and specified
in SA WG3.
## 9.3 Information Flow
The following information flow describes the overall concept of how ETWS
works. It focuses on idle mode. Specifics for connected mode are described in
clause 8.3.
Figure 9.3.1: The ETWS information flow for idle mode UE
NOTE 1: The architecture for EPS (MME or E-UTRAN) [FFS] is still under
development.
0\. Device Management is used to configure the UE with a list of PLMNs that
wish the UE to accept ETWS warnings \"without security\". By default, the list
in the UE shall be empty (i.e. the default setting shall be that security is
needed for all PLMNs).
1\. Network registration and Security (e.g. mutual authentication) procedures
are performed. The UE stores a flag that indicates whether or note it has
authenticated the network. To guard against replay attacks, at least one of
the core network nodes (MSC or SGSN or MME) uses the Network Information and
Time Zone (NITZ) feature, see TS 22.042 [8] and TS 24.008 [9] to send the
current Time of Day to the UE. The UE shall synchronise an internal ETWS clock
to the time supplied in this procedure and keep this clock running with an
accuracy of better than [1] minute while registered on this PLMN.
2\. GEC (e.g. Information Source such as PSAP or Regulator) sends emergency
information ( \"warning type\", \"warning message\", \"impacted area\", \"time
period\") to the CBC. The CBC shall authenticate this request. The \"warning
type\" takes one of the following values {earthquake, tsunami, test, other}.
The \"warning message\" contains a [text] based warning message with less than
[X] octets of content.
Editor\'s Note: time period depends on regulatory policy.
Editor\'s Note: It is FFS for SA3 whether the GEC or the CBC add the Digital
Signature and Timestamp
Editor\'s Note: It is FFS what is the combined size of the warning message,
digital signature and timestamp
3\. Using the \"impacted area information\", the CBC identifies which BSCs,
RNCs, and EPS node need to be contacted and constructs the \"Cell ID/Service
Area ID list\" for the cells in which the information is to be broadcast.
The CBC shall send a WRITE-REPLACE message to all the identified BSCs, RNCs
and EPS node. The message shall include an \"emergency indication\" to
differentiate it from normal Cell broadcast information, as well as the \"Cell
ID/Service Area ID list\", \"warning type\", \"warning message\", \"impacted
area\", \"digital signature\" and \"timestamp\" information.
4\. The BSCs, RNCs and EPS nodes use the \"Cell ID/Service Area ID list\"
information to identify which BTSs, NodeBs and eNodeBs need to transmit this
information, and then, they relay this information to them using the
appropriate Abis/Iub/?? [FFS for EPS] interface message (e.g. \"SMS broadcast
request\" on the A-bis interface).
5\. The BTS/NodeB/eNodeB receives the SMS Broadcast Request /Iub message/??
[FFS for EPS] message containing the emergency indication. As parallel
actions, the BTS/NodeB/eNodeB shall:
Editor\'s Note: in UMTS, whether the following actions are performed by the
RNC or NodeB is FFS.
a) start to broadcast the \"warning message\", \"digital signature\" and
\"timestamp\". Whether this broadcast uses a Cell Broadcast channel or
modified System Information messages, or another technique is to be defined by
RAN groups and can be RAT specific. This broadcast information is repeated
continuously by the BTS/NodeB/eNodeB for the \"time period\" requested by the
GEC.
From the BTS/NodeB/eNodeB perspective, these 3 fields can be treated as one
information element and the BTS/NodeB/eNodeB need not check (and, indeed,
might not be able to check) that the \"digital signature\" and \"timestamp\"
fields are present.
b) use paging messages in every paging group to alert idle mode mobiles to
receive the broadcast warning message. This is the \"ETWS indication \".
Typically these paging messages are repeated in all paging groups for several
DRX periods.
NOTE 2: It should be investigated in RAN/GERAN groups whether page messages
containing an \"ETWS IMSI\" with MCC=901 and MNC=08 are used for this purpose.
This MCC and MNC combination is an escape PLMN code that is reserved in TS
23.003 [10].
c) the \"warning type\" is copied into the paging message. When the \"warning
type\" is set to \'other\', all of the warning information is included in the
broadcast \"warning message\".
NOTE 3: It should be investigated in RAN/GERAN groups whether the \"warning
type\" is encoded within the MSIN field (see TS 23.003 [10]) in the \"ETWS
IMSI\" or a new information element.
d) handle connected mode mobiles as described in clause 8.3, above.
6\. The UE receives a paging message containing the \"ETWS IMSI\" \"ETWS
indication\".
7a. If the UE has been configured to receive ETWS warnings \"without
security\", and the UE has authenticated the core network of the
BTS/NodeB/eNodeB it is camped on, then the UE can use \"warning types\"
\'earthquake\' and \'tsunami\' immediately to alert the user.
The alerting signal shall override any normal \"silent\" or \"meeting\" mode
settings on the UE.
The UE activates reception of the broadcast messages containing the \"warning
message\", \"digital signature\" and \"timestamp\".
If the \"digital signature\" and/or \"timestamp\" are present and security
checks fail, then the UE notifies the user of this fact and stops the user
alerting.
If both the \"digital signature\" and \"timestamp\" are present and security
checks pass, then the UE indicates the contents of the \"warning message\" to
the user along with an indication that the message has been authenticated.
In other cases the UE indicates the contents of the \"warning message\" to the
user along with an indication that the message has not been authenticated.
7b. If the UE has not been configured to receive ETWS warnings \"without
security \", the UE activates reception of the broadcast messages containing
the \"warning message\", \"digital signature\" and \"timestamp\".
Unless both the \"digital signature\" and \"timestamp\" are present and the
security checks pass, the UE shall ignore the message; return to normal idle
mode; and ignore pages with the \"ETWS IMSI\" \"ETWS indication\" for the next
[X] seconds.
NOTE 4: Repetition period is subject to regulatory requirements.
If both the \"digital signature\" and \"timestamp\" are present and security
checks pass, then the UE alerts the user; and indicates the contents of the
\"warning message\" to the user along with an indication that the message has
been authenticated.
The alerting signal shall override any normal \"silent\" or \"meeting\" mode
settings on the UE.
NOTE 5: If Cell Broadcast is used in GERAN, it is anticipated that the MS
shall have previously stored the SMS CB Channel Description transmitted in the
System Information type 4 message.
8\. The BSC/RNC/EPS node sends a BMC REPORT-SUCCESS in return of Write-
Replace.
9\. CBC sends acknowledgement message to GEC.
# 10 Conclusion
Alternative 5 is preferred by SA WG2 because this fulfils the global
requirements.
The further details need to be specified by RAN and GERAN groups, required
information elements and protocols need to be specified in CT groups, the
security mechanisms need to be specified by SA WG3.
#