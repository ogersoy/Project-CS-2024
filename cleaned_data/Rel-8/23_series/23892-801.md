# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
Development of the architecture for Voice Call Continuity has identified that
supporting domain transfer of active mid-call services by implementing these
services in both the CS domain and IMS is not a viable solution in the 3GPP
Rel‑7 timeframe. Therefore it has been proposed that an architecture is
necessary that allows implementation of such services in IMS while also
allowing control of the services when the serving access network is the CS
domain. In addition to the VCC scenario, the increased deployment of VoIP
capable access technologies will encourage further service development on IMS
also increasing the importance of being able to access these services via CS
domain access independently of the support of VCC.
# 1 Scope
## 1.1 General
This document contains the results of the feasibility study into the
architectural requirements and alternatives for the delivery of consistent
services to the user mainly via IMS centralized services regardless of the
attached access type; e.g. CS domain access or IP-CAN. Considerations include
overall requirements, architectural requirements, alternative architectures
and evaluation of potential architectural solutions.
The study shall consider how to access the IMS-based multimedia telephony
services while still allowing innovative services. Specifically, it shall
provide consideration for the handling of the multiple media types that are
enabled by the IMS multimedia telephony communication service (MMTel)
utilizing CS services of TS11 and CS video telephony reliant upon BS30.
Emergency calls that utilise TS12 are outside the scope of this work item in
this release.
It shall include an investigation into call/session establishment via CS
domain access and IP-CAN and for calls/sessions transferred across CS domain
access and IP-CAN, including the interactions with domain selection. The
solution should be applicable for terminals with or without VCC capabilities.
Impact on legacy terminals with the same subscription (e.g. SIM swapping)
should be studied.
The study shall also investigate the means to support and the need of the
evolution of a network towards the IMS centralized services architecture. The
assumption for this evolution is that some networks may not immediately
migrate all services to the IMS centralized services architecture. In
addition, given that some calls may not be rerouted to IMS during the
migratory period, the study shall investigate how to ensure that equivalent
services are implemented in IMS and the CS domain.
Overall, Centralized IMS Services Control supports the introduction of MMTel
by enabling support of IMS bi‑directional speech media services when no bi-
directional speech media capable IP-CAN is useable. Combined with the domain
transfer capability of VCC, service continuity for bi-directional speech media
is enabled for MMTel between a bi-directional speech media capable IP-CAN and
CS access. Furthermore it supports the introduction of MMTel by enabling
terminals without IMS to support receiving IMS‑based speech services.
## 1.2 Motivation and background
Communication networks are evolving towards packet-based infrastructures. A
single common consolidated core network offers service providers the
possibility of reduced core network complexity and maintenance. As service
providers shift their core network infrastructure from the CS domain to a
consolidated common IMS infrastructure the need will exist to enable the
consistent provision of services to subscribers over a variety of accesses,
including CS domain and PS domain accesses.
Initially it can be expected that the coverage of IP-CANs capable of
transporting bi-directional speech media will be limited compared to CS domain
access networks at least during the introduction period of IP-CANs capable of
transporting bi-directional speech media. Therefore a need exists to specify
an architecture that supports the provision of IMS based services across a
variety of PS domain or CS domain access networks (see figure 1.2-1). This
thereby enables a consistent user-experience with bi-directional speech
services of IMS subscribers irrespective when being inside or outside the
coverage of an IP-CAN capable of transporting bi-directional speech media.
Figure 1.2-1: IMS based services across a variety of PS and/or CS domain
access networks
In order to take advantage of all the new capabilities IMS has to offer, it is
assumed that new terminals are required. However, there is also an interest to
analyze whether IMS bi-directional speech services can be supported to
terminals without any IMS capabilities in order to enable centralization of
service management in IMS.
Already TR 23.806**[** 8], introduced the concept of IMS controlled service
continuity in clause 6.3 \"Service Continuity Model: IMS Controlled
Alternative\". The Voice Call Continuity (VCC) Application is described in TS
23.206**[** 3],which implements a distributed service model where both CS and
IMS services can be used by a VCC subscriber as follows:
\- When using a PS domain access, only IMS services are offered.
\- When using a CS domain access, call control and supplementary services are
active in IMS with the exception of mid call and presentation services, which
are active in the CS domain.
Moreover, the development of the architecture for Voice Call Continuity has
identified that supporting domain transfer of active mid-call services by
implementing such services in both the CS domain and IMS is not a viable
solution in the 3GPP Rel‑7 timeframe. When mid-call services are active, the
domain transfer cannot be executed unless the mid-call service is finalized
first.
Therefore it is proposed to develop an architecture that allows implementation
of such services in IMS while also allowing IMS control when the serving
access network is in the CS domain. In addition to the VCC scenario, the
increased deployment of bi-directional speech media capable access
technologies will encourage further service development on IMS. This therefore
increases the importance of being able to access these services via CS domain
access independently of the support of VCC and also independently of having an
IMS enabled terminal. The solution for centralized IMS service control should
also support call independent IMS supplementary services management.
Different access network scenarios for centralized IMS service control can be
envisioned as depicted in Figure 1.2-2:
\- Scenario A: The serving access network is an IP-CAN capable of transporting
bi-directional speech media. Here both media transport and session control
signalling is carried over the IP CAN.
\- Scenario B: The serving access network is a CS access: Here both media
transport and session control signalling is carried over CS domain access.
\- Scenario C: Both CS domain access and an IP-CAN are serving access networks
(possibly, it has been determined that the IP-CAN is not bi-directional speech
media capable or operator policy/user preference prevent usage of IP-CAN or
usage of IP-CAN for bi-directional speech media communications): Here, media
transport is carried over CS access and session and media control signalling
is carried either over the CS domain access or over the IP-CAN not capable of
transporting bi-directional speech media.
NOTE: If CS access is used for media transport, CS signalling according to TS
24.008**[** 7] is always used to setup CS bi-directional speech media e.g.
TS11 call.
Figure 1.2-2: Scenarios for Centralized IMS Service Control
Within the study of Centralized IMS Service Control both Scenario B and
Scenario C need to be investigated for bi-directional speech services.
Scenario A shall not be impacted by the study of Centralized IMS Service
Control. In Scenario C, depending on operator policy/user preference, access
and terminal capabilities, additional IMS controlled media (e.g. video, text)
can be carried over an IP-CAN that is not capable of transporting bi-
directional speech media.
For the above-introduced scenarios, the following main cases for session
continuity for bi-directional speech can be distinguished (see also figure
1.2-3 and figure 1.2-4), both requiring domain transfer for bi-directional
speech between bi-directional speech media capable IP-CAN and CS access (Voice
Call Continuity as specified in TS 23.206**[** 3]).
**Service Continuity Scenario 1: Access Scenarios A & B:**
Figure 1.2-3: Service continuity between scenario A and B
**Service Continuity Scenario 2: Access Scenarios A & C**
Figure 1.2-4: Service continuity between scenario A and C
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 22.101: \"Service principles\".
[2] 3GPP TS 22.173: \"IP Multimedia Core Network Subsystem (IMS) Multimedia
Telephony Service and supplementary services\".
[3] 3GPP TS 23.206: \"Voice Call Continuity between CS and IMS\".
[4] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS)\".
[5] 3GPP TS 24.173: \"IMS Multimedia telephony service and supplementary
services\".
[6] 3GPP TS 24.229: \"Internet Protocol (IP) multimedia call control protocol
based on Session Initiation Protocol (SIP) and Session Description Protocol
(SDP)\".
[7] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core
network protocols\".
[8] 3GPP TR 23.806: \"Voice call continuity between Circuit Switched (CS) and
IP Multimedia Subsystem (IMS) Study\".
[9] 3GPP TR 23.826: \"Feasibility study on Voice Call Continuity (VCC) support
for emergency calls\".
[10] 3GPP TS 25.413: \"**UTRAN Iu interface Radio Access Network Application
Part (RANAP) signalling** \"**.**
**[11]** 3GPP TS 23.009: \"Handover procedures\".
[12] 3GPP TS 43.055: \"Dual Transfer Mode (DTM)\".
[13] ITU-T Recommendation H.248.18 (11/2002): \"Gateway control protocol:
Package for support of multiple profiles\".
[14] 3GPP TS 29.232: \"Media Gateway Controller (MGC) - Media Gateway (MGW)
interface; Stage 3\".
[15] 3GPP TS 29.332: \"Media Gateway Control Function (MGCF) - IM Media
Gateway (IM-MGW); Mn interface\".
[16] IETF RFC 3680 (March 2004): \"A Session Initiation Protocol (SIP) Event
Package for Registrations\".
[17] 3GPP TS 23.204: \"**Support of Short Message Service (SMS) over generic
3GPP Internet Protocol (IP) access** \".
[18] 3GPP TS 29.163: \"Interworking between the IP Multimedia (IM) Core
Network (CN) subsystem and Circuit Switched (CS) networks\".
[19] 3GPP TS 23.893: \"Feasibility study on multimedia session continuity\".
[20] 3GPP TS 33.210: \"3G Security; Network Domain Security; IP network layer
security\".
[21] 3GPP TS 23.292: \"IP Multimedia Subsystem (IMS) Centralized Services;
Stage 2\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the**[** following] terms and
definitions**[** given in ... and the following] apply.
**Bearer Control Signalling Path: Standard CS** signalling path used to
control the call established to setup CS voice bearer between the UE and IMS.
**CS Access Signalling** : Standard CS signalling used between the UE and the
CS network.
**ICS UE** : The ICS UE is a User Equipment that contains the new UE
capabilities defined in this document and that is capable of receiving
telephony services and other services offered by IMS while the voice bearer is
established via CS. An ICS UE can also be a UE which can access IMS via an IP-
CAN that supports the full duplex speech component of the IMS multimedia
telephony service, and follows the procedure defined in TS 22.101 [1], TS
22.173 [2], TS 23.228 [4], TS 24.229 [6] and TS 24.173 [5]. An ICS UE is not
necessarily capable of VCC.
**ICS Enhanced MSC Server** : An MSC Server which has been enhanced with ICS
capability.
**Non-ICS UE** : The non-ICS UE is a User Equipment that does not contain the
new capabilities defined in this document. A non-ICS UE is not necessarily
capable of VCC.
**RUA Leg:** The call leg between the ICCF and the remote end. It is formed at
the ICCF for presentation of the SIP UA behaviour to IMS on behalf of the UE.
The TAS, VCC AS and other Application Servers are invoked on the RUA Leg.
**Session Control Signalling Path:** Signalling path established between the
UE and the ICCF, either directly via PS through an IP-CAN or via CS network
elements such as the VMSC and the HSS for enablement of IMS control of user
sessions at the ICCF when using CS voice bearers.
**Session Transfer Identifier** : Session Transfer Identifier is an identifier
used by Domain Transfer Function to identify the anchored sessions destined to
or originated from a specific UE. It is used by the UE or the network to
identify the specific anchored session to perform Domain Transfer.
**UE Leg:** The call leg between the ICCF and the UE. It is formed at the ICCF
by combining of the CS call established between the UE and the ICCF to set up
the voice bearer, with the control information communicated between the UE and
ICCF to enable the completion of the call towards the remote end.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
CAAF CS Access Adaptation Function
ICCC IMS CS Control Channel
I1-cs IMS CS Control Channel implemented over the CS domain
I1-ps IMS CS Control Channel implemented over the PS domain
ICS IMS Centralized Services
ICCP IMS CS Control Protocol
ICCF IMS CS Control Function
IMSC ICS Enhanced MSC Server
L-CAAF Local CS Access Adaptation Function
L-CAAF-n Local CS Access Adaptation Function-network equivalent
RUA Remote User Agent
R-CAAF Remote CS Access Adaptation Function
VCC Voice Call Continuity
# 4 Overall requirements
# 5 Architectural requirements and considerations
## 5.1 Basic assumptions
### 5.1.1 Domain Transfer principles
Domain Transfer procedures are based on the following principles:
\- For IMS sessions established over PS access, standard IMS procedures are
used. Multiple sessions exist for multiple calls; e.g. two sessions with two
different media exists. All of the user sessions are anchored at the DTF in
the VCC Application, with one Access Leg and one Remote Leg per session
established for all user sessions at the DTF.
\- For IMS sessions with bi-directional speech media established over CS
access the RUA in the ICCF presents user sessions to IMS as standard IMS
sessions after combining with CS media. Multiple sessions exist for multiple
calls, but only one CS bearer is used for these sessions; i.e. only one
session is active over the CS bearer. All of the user sessions are anchored at
the DTF in the VCC Application, with one Access Leg and one Remote Leg per
session established for all user sessions at the DTF.
\- The Access Legs associated with all the sessions present in the
transferring-out domain at the time of Domain Transfer are updated at the DTF
in the VCC Application with information from the transferring-in domain. This
is required for proper control of current sessions after Domain Transfer and
to ensure that the control of these sessions is consistent with any new
sessions established after Domain Transfer.
\- At most one active session and zero or more inactive sessions with bi-
directional speech media is transferred as part of Domain Transfer.
\- Domain Transfers of UE‑based conferencing is not supported.
## 5.2 Architectural requirements
### 5.2.1 Service consistency
The following requirements are defined to ensure service consistency:
\- It shall be possible to provide the services offered by the Telephony
Application Server to the users who are accessing the network via the CS
domain or via an IP-CAN. Support of MMTel full duplex speech service set shall
be provided as defined in TS 22.173 [2] and TS 24.173 [5].
\- Current definition of the multimedia telephony service offered by the
TASshall not be changed due to the centralization of services in IMS.
\- Home IMS network services shall be provided when using CS access for speech
media transport in home and roaming networks; however a reduced service
offering may be provided subject to the constraints of the access network.
\- Home IMS network services shall not be impacted by the solution for
Centralized IMS Service Control when using an IP-CAN for speech media
transport in home and roaming networks.
\- The solution shall support call independent IMS supplementary services
management for users who are accessing the network via the CS domain or via an
IP-CAN.
\- Solution needs to work also over international transit networks.
Editors Note 1: The capabilities of the international transit networks need to
be identified.
\- It shall be possible to support Emergency Call and Priority Services (ETS)
for IMS Centralized Services users.
Emergency calls specifically using TS12, SMS, CBS, Fax, Data, Voice Group Call
Service and eMLPP/priority services are not centralized in Release 8 in IMS.
Provision of SMS in IMS is specified in 23.204 [17].
### 5.2.2 Core network requirements
#### 5.2.2.1 IMS Core Network
\- Impacts on IMS entities should be minimized.
#### 5.2.2.2 CS Core Network
\- Impacts on CS network elements should be minimized.
### 5.2.3 Use of VCC Application Domain Transfer with ICS
Domain Transfer functions of TS 23.206 [3] shall be used to enable service
continuity of IMS sessions between PS and CS access for sessions established
by ICS UEs capable of VCC.
The Rel‑7 VCC Domain Transfer procedures may require enhancements for support
of transfers of single sessions between CS and PS access. Further enhancements
to these procedures are required for support of Domain Transfer of multiple
sessions.
### 5.2.4 Access domain selection
Access domain selection shall be performed for ICS.
### **5.2.5** Redirection of CS calls to IMS
Redirection of CS calls to IMS should be possible.
## 5.3 UE requirements
### **5.3.1 Support of ICS UEs**
Subject to operator policy, the ICS UE shall perform the IMS SIP registration
procedure as defined in TS 23.228 [4].
Editor\'s note: There are no agreed assumptions on how ICS will be rolled out
and deployed in networks and whether the feature will be subject to a specific
subscription. The operation of an ICS UE in a network where some users have an
ICS subscription and others do not is FFS.
### 5.3.2 Support of Pre-Rel‑08 non ICS Enhanced UEs
Pre-Release 8 UEs (without IMS Centralized Services enhancements) should be
supported. When services are provided by the IMS, a reduced supplementary
service set may be allowed.
Editor\'s Note: The impact of providing IMS Centralized Services for a non-ICS
enhanced UE e.g. in terms of service data synchronization requirements, needs
to be studied**.**
## 5.4 Service continuity requirements
\- The IMS Centralized Services solution is required to enable subscribers to
have **consistent service behaviour upon Domain Transfers between** access
networks, subject to the constraints of the device and access network.
Editor\'s Note: multimedia and non-voice services require further
consideration for seamless transparency.
### 5.4.1 Priority Service (ETS)
The IMS centralized services solution needs to support Domain Transfers of
Priority Service.
Editor\'s Note: It is for further study whether Priority Service can be
provided from IMS domain when using CS access.
### 5.4.2 Supplementary services
The IMS centralized services solution needs to provide subscribers with a
consistent supplementary service behaviour upon Domain Transfers (e.g. Call
Forwarding, Communication Waiting, Call Hold, etc.).
## 5.5 Session scenarios
### 5.5.1 Session scenarios when a PS network is used that supports the full
duplex speech component of the IMS multimedia telephony service
When the UE has access to a PS network **_that supports the full duplex speech
component of the IMS multimedia telephony service,_** then standard IMS
session scenarios are supported according to the procedures specified in TS
22.101 [1], TS 22.173 [2], TS 23.228 [4], TS 24.229 [6] and TS 24.173 [5], no
further amendments required.
### 5.5.2 Session scenarios when a PS network is used that does not support
the full duplex speech component of the IMS multimedia telephony service
When the UE has access to a PS network **_that does not_** **_support support
the full duplex speech component of the IMS multimedia telephony service or
where the full duplex speech component of the IMS multimedia telephony service
is not allowed but where the UE can use a CS domain to access IMS services,_**
then the solution shall support the IMS session scenarios specified in clause
5.5.3.
NOTE: It is not clear how the UE understands if a PS network is capable of
supporting the full duplex speech component of the IMS multimedia telephony
service, but this issue is considered out of the scope of this document.
### 5.5.3 Session scenarios when a CS network is used to access IMS services
#### 5.5.3.1 Session scenarios for an ICS UE
When an ICS UE accesses IMS services over a CS network, then the following IMS
session scenarios shall be supported according to the procedures specified in
TS 22.101 [1], TS 22.173 [2], TS 23.228 [4], TS 24.229 [6] and TS 24.173 [5],
along with the solution specified in this document.
\- Basic voice service origination and terminating sessions.
\- Voice origination and termination service sessions with Line ID services
(e.g. OIP, OIR, TIP, TIR) controlled in IMS.
\- Voice origination and termination service sessions with Communication
Barring services controlled in IMS.
\- Voice termination service sessions with Communication Diversion services
controlled in IMS.
\- Voice origination and termination service sessions with mid-call services
(e.g. Hold/Resume, Conferencing, CW, ECT) controlled in IMS.
\- Communication services setting modifications (e.g. changing forwarding info
or activating barring services, etc).
Editor\'s note: Procedure for the communication services setting modifications
where PS domain is not available is FFS.
The solution shall provide also generic capabilities to enable introduction of
new bi-directional speech related IMS services via CS bearer without further
standardisation.
#### 5.5.3.2 Additional session scenarios for ICS UE capable of VCC
In addition to session scenarios specified in clause 5.5.3.1 for ICS UEs, the
solution shall support the following VCC session scenarios according to
network procedures specified in TS 23.206 [3] when a ICS UE is capable of VCC:
\- Domain Transfers of basic voice service sessions in both directions
(between networks **_that support the full duplex speech component of the IMS
multimedia telephony service_** over IP-CAN and CS).
\- Domain Transfers of voice sessions with non mid call services in both
directions (between networks **_that support the full duplex speech component
of the IMS multimedia telephony service_** over IP-CAN and CS).
\- Domain Transfers of voice sessions with mid call services in both
directions (between networks **_that support the full duplex speech component
of the IMS multimedia telephony service_** over IP-CAN and CS).
\- Domain Transfers of Emergency sessions in both directions using the work
being done in TR 23.826 [9], VCC support for Emergency Calls as a basis.
#### 5.5.3.3 Session scenarios for non-ICS UEs
##### 5.5.3.3.1 When using CS networks upgraded with ICS capability
The solution shall support the following IMS session scenarios together with
the procedures specified in TS 22.101 [1], TS 22.173 [2], TS 23.228 [4], TS
24.229 [6] and TS 24.173 [5] when a non-ICS UE accesses IMS services via
GSM/UMTS CS network which has been upgraded with the ICS capability:
\- Basic voice service origination and terminating sessions.
\- Voice origination and termination service sessions with Line ID services
(e.g. OIP, OIR, TIP, TIR) controlled in IMS.
\- Voice origination and termination service sessions with Communication
Barring services controlled in IMS.
\- Voice termination service sessions with Communication Diversion services
controlled in IMS.
\- Voice origination and termination service sessions with mid-call services
(Hold/Resume, Conferencing, CW, ECT) controlled in IMS.
##### 5.5.3.3.2 When using CS networks not upgraded with ICS capability
The solution shall support the following IMS session scenarios together with
the procedures specified in TS 22.101 [1], TS 22.173 [2], TS 23.228 [4], TS
24.229 [6] and TS 24.173 [5] when a non-ICS UE accesses IMS services via
GSM/UMTS CS network which has not been upgraded with the ICS capability:
\- Basic voice service origination and terminating sessions.
\- Voice origination and termination service sessions with Communication
Barring services controlled in IMS.
\- Voice termination service sessions with Communication Diversion services
controlled in IMS.
Support of the following session scenarios may not be possible when a non-ICS
UE accesses IMS services via GSM/UMTS CS network not upgraded with the ICS
capability; these session scenarios may be supported with control of
respective Supplementary Services in CS domain if necessary.
\- Voice origination and termination service sessions with Line ID services
(OIP, OIR, TIP, TIR) controlled in IMS.
\- Voice origination and termination service sessions with mid-call services
(Hold/Resume, Conferencing, CW, ECT) controlled in IMS.
##### 5.5.3.3.3 Additional session scenarios for non-ICS UE capable of VCC
In addition to session scenarios specified in the clause 5.5.3.3.1 and clause
5.5.3.3.2 for a non-ICS UE, the solution shall support the following VCC
session scenarios according to procedures specified in TS 23.206 [3] when a
non-ICS UE capable of VCC accesses IMS services via GSM/UMTS CS network:
\- Domain Transfers of basic voice service sessions in both directions.
\- Domain Transfers of voice sessions with non mid call services in both
directions.
### 5.5.4 Session scenarios for co-existence of ICS UE and Non ICS UEs
solutions
Co-existence of ICS UE and non ICS UE in the same network shall be supported.
A network with a VMSC enhanced for support of non-ICS UE shall be able to
support call originations, terminations and Domain Transfer scenarios for ICS
UE as specified in clause 5.5.3.1 Session scenarios for an ICS UE.
Roaming of ICS users to a network with a VMSC enhanced for non ICS UE shall be
supported. A visited network with a VMSC enhanced for support of non ICS UE
shall be able to support call originations, terminations and Domain Transfer
scenarios for ICS UE as specified in clause 5.5.3.1 Session scenarios for an
ICS UE when an ICS user with a ICS UE roams into this network.
ICS UE that connects to the ICCF via VMSC that has been enhanced for ICS will
use the ICCC to access the ICS services unless ICCC connectivity is not
available in HPLMN or VPLMN. However, when the ICS UE is not able to use ICCC
(e.g. due to lack of UTRAN in case of I1-ps), the ICS UE falls back to non-ICS
UE behaviour.
Editor\'s Note: It is FFS whether the IMSC needs to know whether the UE is an
ICS UE or non ICS UE for the support if I1-cs which terminates on the IMSC.
When it serves the ICS user, the VMSC enhanced for ICS initiates SIP session
to route the UE initiated calls to IMS, regardless whether the user uses ICS
UE or non ICS UE, hence the VMSC enhanced for ICS does not perform CAMEL
service execution to reroute the UE initiated calls.
ICCF does not need to be aware whether the session has been initiated via ICS
enhanced VMSC or regular VMSC.
# 6 Architecture alternatives
Editor\'s Note: This clause will describe and evaluate detailed reference
architectures, including network elements, interfaces and reference points,
suitable to provide Centralized IMS Services
## 6.1 Introduction
The architectural alternatives described here may broadly be divided into
those that have UE impacts and those that do not. Descriptions of the
alternatives that impact the UE follow the ICS Reference Architecture and
Reference Point clauses. The alternatives that do not impact the UE are
described in a clause following the ICS Reference Architecture.
In the architecture alternatives described here _a fundamental part of the
architecture is the concept of the IMS CS Control Channel (ICCC). This is_ a
logical control channel, established between the UE and an IMS network element
for establishment and/or service control of IMS sessions using CS voice
bearers as described below.
### 6.1.1 IMS CS Control Channel (ICCC)
The IMS CS Control Channel (ICCC) is a logical control channel used to
transport signalling between the ICS UE or L-CAAF-n and the IMS when accessing
IMS services via the CS domain. ICCC is used when needed, e.g. for IMS
registration, on session establishment and/or service control of IMS sessions
using CS voice bearers. The ICCC between the UE and the ICCF can in principle
be established over the CS domain network, in which case it is referred to as
I1-cs, or over the PS domain, in which case it is referred to as I1-ps. When
I1-cs is established it can also be used for effecting communication service
setting modifications or ICS UE could establish a circuit switch data
connection and run Ut over it.
Editor\'s Note 1: Selection of circuit switch data or I1-cs for effecting
communication service setting modifications is for further study.
Editor\'s Note 2: Fitting communication service setting modification messages
in a minimal number of USSD messages is for further study.
\- Transport mechanism for I1-cs is USSD and the transport mechanism for I1-ps
is a PS bearer.
\- IP connectivity is needed between the L-CAAF-n and ICCF for the support of
ICCC.
The USSD transport mechanism does not offer as much bandwidth as the PS bearer
so when using the USSD transport mechanism the limited bandwidth has to be
taken into account and a suitable IMS CS Control Protocol (ICCP) is required.
The ICCP may be implemented as a functional or stimulus protocol as driven by
the architectural requirements. Details of ICCP implementation are for further
study.
IMS SIP signalling is carried over the I1-ps.
Editor\'s Note 3: Procedures for use of ICCC for IMS registration when using
CS access, and session establishment and/or service control of IMS sessions
established using CS voice bearers are FFS.
Editor\'s Note 4: ICCC only applies to MMTEL services. Potential use of ICCC
for non-MMTEL services is FFS.
## 6.2 Reference architecture for ICS UEs
### 6.2.1 Reference architecture diagram
The figure below provides a Reference Architecture for IMS voice sessions
established by an ICS UE using CS voice bearers and for voice sessions
transferred between CS and PS access.
NOTE: Only relevant functions are shown.
Figure 6.2.1-1: ICS -- Reference Architecture
The architecture introduces two new logical functions, the IMS CS Control
Function (ICCF) and the ICS UE, as described below.
### 6.2.2 IMS CS Control Function (ICCF)
The IMS CS Control Function (ICCF) provides functions necessary for provision
of IMS services for calls originated or terminated over CS access networks,
for calls transferred between CS and PS access networks. and for communication
services setting modifications over I1-cs. Note: alternatively, ICS UE could
establish a circuit switch data connection and run Ut over it. Note:
Communication setting modifications via Ut are not affected. The ICCF belongs
to the IMS home network and is includes the following functions: the CS Access
Adaptation Function (CAAF) and the Remote User Agent (RUA).
Based on information received and decoded by CAAF, the ICCF will determine the
one or more commands to be executed, causing information to be encoded and
exchanged by functions internal to the ICCF (e.g. RUA, RPC).
#### 6.2.2.1 Remote User Agent (RUA)
The Remote User Agent (RUA) performs SIP User Agent functions on behalf of the
ICS UE for IMS voice sessions established using CS voice bearers.
Editor\'s Note: Interaction details between the redirection functionality in
the ICCF versus the one used in the VCC application is FFS
The RUA combines the CS call established between the UE and the RUA to set up
a voice bearer, and the ICCC established between the RUA and the UE either
directly or via the CAAF. It enables the completion of the call leg towards
the UE, referred to hereafter as the \"UE Leg\"; and presents the session
through the S-CSCF toward the other party, on a call leg referred to hereafter
as the \"RUA Leg\". The UE Leg and the RUA Leg form a B2BUA at the RUA. The
TAS and other Application Servers are executed on the RUA Leg as part of
standard service execution logic at the S-CSCF. The session processing
complies with the current IMS procedures (e.g. MMTel as in TS 24.173[5] for
standardized supplementary services). In other words TAS and other IMS
Application Servers do not see a difference regarding the current IMS/MMtel
procedures, whether it serves a UE roaming in CS or in IP-CAN. This does not
exclude access specific information passing via SIP and its use when necessary
by the services.
#### 6.2.2.2 Realization of the ICCF
The ICCF is realized with an ISC interface to S-CSCF for both I1-cs and I1-ps.
It is invoked as the very first SIP AS in the originating call and the last
one in terminating calls i.e. closest to the access. It needs to be ensured
that the AS implementing DTF of VCC Application is either second for
originating calls or second last for terminating calls.
Further details for the realization of ICCF vary based on the various
architecture alternatives as described below.
##### 6.2.2.2.1 I1-ps approach
The Gm reference point is used to realize the I1 reference point with use of
3GPP SIP signalling for registration and session control. The ISC interface
and the Ma reference point are used for PSI routing to the ICCF to establish
voice bearer via the CS domain. The Ut reference point is used for
communication services setting modifications.
The ISC interface is used for realization of the I2 reference point.
Figure 6.2.2.2.1-1 illustrates the realization of ICCF for the I1-ps approach.
Figure 6.2.2.2.1-1: Realization of ICCF for I1-ps approach
##### 6.2.2.2.2 I1-cs approach
The A/Iu interface as well as the gsmSCF-HLR interface is used to realize the
I1 reference point with use of USSD transport to carry information required to
generate IMS signalling at the ICCF. The ISC interface and the Ma reference
point are used for PSI routing to the ICCF to establish voice bearer via the
CS domain.
##### 6.2.2.2.2.1 I1-cs: unregistered user solution {#i1-cs-unregistered-user-
solution .H6}
For realization of I2, the ISC interface is used for originations and
terminations. IMS Registration via CS access is not supported.
Figure 6.2.2.2.2.1-1 illustrates the realization of ICCF for the I1-cs:
unregistered user solution.
Figure 6.2.2.2.2.1-1: Realization of ICCF for I1-cs: unregistered and
registered user solution
The CAAF of the ICCF presents gsmSCF-HLR interface towards the HSS for USSD
signalling. The ICCF functionality is similar to the ICCF in the I1-ps
approach except that it does not the include the CAAF for USSD handling.
##### 6.2.2.2.2.2 I1-cs approach: registered user solution {#i1-cs-approach-
registered-user-solution .H6}
##### 6.2.2.2.2.2.1 I1-cs approach: registered user solution-ISC model
{#i1-cs-approach-registered-user-solution-isc-model .H6}
The ISC is used for realization of I2, i.e., origination and termination
procedures are executed over the ISC interface.
Editor\'s note: Two solution alternatives have been suggested for execution of
the IMS Registration via CS access; one using the ISC and the other using the
Cx interface. Selection of a particular alternative is expected at conclusion
of this study.
Figure 6.2.2.2.2.1-1 illustrates the realization of ICCF for the I1-cs:
registered user solution-ISC model.
The CAAF of the ICCF presents gsmSCF-HLR interface towards the HSS for USSD
signalling. The ICCF functionality is identical to the I1-ps approach except
the inclusion of CAAF for USSD handling.
##### 6.2.2.2.2.2.2 I1-cs approach: registered user solution-Mw model {#i1-cs-
approach-registered-user-solution-mw-model .H6}
The Mw is used for realization of I2, i.e. the IMS Registration via CS access,
origination and termination procedures are executed over the Mw reference
point.
Figure 6.2.2.2.2.2.2-1 illustrates the realization of ICCF for the I1-cs:
registered user solution.
Figure 6.2.2.2.2.2.2-1: Realization of ICCF for I1-cs only: registered user
solution-Mw model
The CAAF of the ICCF presents gsmSCF-HLR interface towards the HSS for USSD
signalling.
Editor\'s Note 1: Use of Access Selection Function for ICCF when using I1-ps
and I1-cs is FFS.
Editor\'s Note 2: Whether to use ISC or Mw for I2 reference point for
registered user solution of I1-cs is FFS.
Editor\'s Note 3: It is for FFS whether to support only I1-cs, only I1-ps or
both.
Editor\'s Note 4: A decision would be required for selection of one physical
implementation of RUA.
Editor\'s Note 5: The interaction between VCC and the ICCF is for further
study.
Editor\'s Note 6: The handling of registration via the I2 reference point is
for further study.
Editor\'s Note 7: It is FFS whether IMS Registration is required over CS
access.
#### 6.2.2.3 CS Access Adaptation Function (CAAF)
The CS Access Adaptation Function (CAAF) is an ICCF internal adaptation
function for the service control signalling between CS domain and IMS. The
CAAF conveys the information received from the ICS UE over CS access
signalling to ICCF functions such as the RUA and RPC, and vice versa. The RUA
uses the information received from the CAAF for initiation and control of SIP
sessions.
The Remote CS Access Adaptation Function (R-CAAF) resides in the ICCF with a
Local CS Access Adaptation Function (L-CAAF) provided in the ICS UE.
The CAAF can also be used as an adaptation function for requests for
communication services setting modifications. In this instance the CAAF
conveys the information received from the ICS UE over CS access signalling to
a RPC.
Editor\'s Note: Use of USSD for transport of communication services setting
related request is FFS.
The CAAF is not employed in the ICCF and the UE when the I1-ps is used.
#### 6.2.2.4 Remote Provisioning Client (RPC)
The Remote Provisioning Client (RPC) is an ICCF internal adaptation function
for the communication setting modifications signalling between CS domain and
IMS. The RPC conveys communication setting modifications information received
from the ICS UE over CS access signalling to the TAS. The settings to be
modified are defined by as part of the definition of current IMS procedures
(e.g. MMTel as in TS 24.173[5] for standardized supplementary services). The
ASes involved do not see the difference, whether they serve a UE roaming in CS
or in IP-CAN.
### 6.2.3 ICS UE
The ICS UE is a UE capable of ICS. An ICS UE communicates via I1 with the
ICCF.
The UE contains the L-CAAF for enablement of I1-cs.
## 6.3 Architecture for support of non-ICS UE
### 6.3.1 L-CAAF-n approach
#### 6.3.1.1 Reference architecture
The ICS Ref Architecture in figure 6.3.1-1 may be used to provide ICS support
but requires CS core network upgrades. The limitations of the legacy UEs need
to be taken into consideration.
NOTE: Only relevant functions are shown.
Figure 6.3.1-1: Architecture for support of non ICS UE, L-CAAF-n approach
#### 6.3.1.2 Extensions to the CAAF in the ICCF for support of non ICS UEs
The CAAF provides necessary adaptation needed for enablement of the RUA in the
ICCF.
The CAAF is provided as a functional element; i.e. for non ICS UEs, the L-CAAF
logic which is otherwise associated with ICS UEs is provided by a CS Core
Network function, the Local CS Access Adaptation Function-network (L-CAAF-n)
on the access edge of the VMSC on behalf of the UE. The L-CAAF-n also provides
interworking with TS 24.008 [7] as necessary.
The CAAF is exclusively provided by the L-CAAF-n associated with the VMSC and
therefore the R-CAAF component in the ICCF is not required.
Editor\'s Note: Call independent aspects such as user configuration of
supplementary services are FFS.
#### 6.3.1.3 Service Support for non ICS UE using L-CAAF-n
When using the L-CAAF-n approach for non ICS UE, the RUA of the ICCF provides
SIP UA behaviour on behalf of the non ICS UE, with the L-CAAF-n providing the
interworking between CS Access Signalling and ICCC; this enables exclusive
control of services in IMS.
Note that the service behaviour is subject to the limitations of the UE and CS
access signalling, and is comparable to that of normal CS users.
##### 6.3.1.3.1 Line ID Services (OIP, OIR, TIP, TIR)
With the L-CAAF-n providing the interworking between CS Access Signalling and
ICCC and the RUA of the ICCF providing SIP UA behaviour on behalf of the non
ICS UE, these services are provided in IMS.
##### 6.3.1.3.2 Communication Diversion Services
##### 6.3.1.3.2.1 Communication Diversion services exclusively controlled in
home IMS (CFU, CFNL) {#communication-diversion-services-exclusively-
controlled-in-home-ims-cfu-cfnl .H6}
With the L-CAAF-n providing the interworking between CS Access Signalling and
ICCC and RUA of the ICCF providing the SIP UA behaviour on behalf of the non
ICS UE, these services are provided in IMS.
##### 6.3.1.3.2.2 Communication Diversion services requiring participation of
serving network (CFNR, CFB) {#communication-diversion-services-requiring-
participation-of-serving-network-cfnr-cfb .H6}
With the L-CAAF-n providing the interworking between CS Access Signalling and
ICCC and the RUA of the ICCF providing SIP UA behaviour on behalf of the non
ICS UE, these services are provided in IMS.
##### 6.3.1.3.3 Communication Deflection
With the L-CAAF-n providing the interworking between CS Access Signalling and
ICCC and the RUA of the ICCF providing SIP UA behaviour on behalf of the non
ICS UE, these services are provided in IMS.
##### 6.3.1.3.4 Communication Barring
With the L-CAAF-n providing the interworking between CS Access Signalling and
ICCC and the RUA of the ICCF providing SIP UA behaviour on behalf of the non
ICS UE, these services are provided in IMS.
##### 6.3.1.3.5 Mid call services (Communication Hold, CW, Conf, Communication
Transfer)
With the L-CAAF-n providing the interworking between CS Access Signalling and
ICCC and the RUA of the ICCF providing SIP UA behaviour on behalf of the non
ICS UE, these services are provided in IMS.
##### 6.3.1.3.6 Voice Call Continuity
The Voice Call Continuity for non ICS UEs capable of VCC is based on TS
23.206.
##### 6.3.1.3.7 User configuration of Supplementary Services
Service data management and control of user configuration of services data is
provided by IMS.
##### 6.3.1.3.8 Serving Domain Considerations
Table 6.1.3.8-1 below provides recommendation for serving domain for the
services discussed in this clause:
Table 6.1.3.8-1: Service set for non ICS UE solution; L-CAAF-n approach
* * *
Service Capability Serving Domain **Supplementary Services**  
Originating Identification Presentation IMS Originating Identification
Restriction IMS Terminating Identification Presentation IMS Terminating
Identification Restriction IMS Communication Diversion (CFU, CFNL) IMS
Communication Diversion (CFNR, CFB) IMS Communication Deflection IMS Call Wait
IMS Communication Hold IMS Communication Barring IMS Conference IMS Explicit
Communication Transfer IMS
** Service Continuity **  
Basic Service Continuity IMS^1^ Service Continuity on non mid call services
IMS^1^ Service Continuity with mid call services N/A
**Other capabilities**  
Call Independent Supplementary Services Operations IMS ^1^ Applicable to non
ICS UE capable of VCC.
* * *
#### 6.3.1.4 Physical realization of ICCF with L-CAAF-n approach
The following figure illustrates the physical realization of the ICCF with the
L-CAAF-n approach for non ICS UE.
Figure 6.3.1.3-1: Realization of ICCF; L-CAAF-n approach for non ICS UE
Editor\'s note: Details of session control procedures on I4 are FFS.
The ISC interface is used for realization of the I2 reference point.
### 6.3.2 CAMEL approach
The ICS reference architecture in figure 6.3.2-1 may be used to provide
reduced ICS support without requiring VMSC enhancements. When considering
deployment of this option the limitations of the legacy UEs need to be taken
into consideration.
Figure 6.3.2-1: Architecture for non ICS UE support, CAMEL approach
NOTE: Only relevant functions are shown.
Standard CS call control procedures are used for setup of CS sessions with
CAMEL used for redirection of the CS calls to IMS, as specified in TS 23.206
[3], in conjunction with the standard MGCF providing the interworking between
the CS call control and SIP. SIP is used for call control with the ICCF
providing SIP UA behaviour on behalf of the UE for control of user sessions.
Control in IMS of some serving network services e.g. line id services and mid
call services is not possible with this option. These services may
alternatively be provided in the CS domain for sessions established for non
ICS UEs.
Editor\'s note 1: interaction with VCC to support VCC and ICS users for non
ICS UEs is FFS.
Editor\'s note 2: Solution for Call independent aspects such as user
configuration and interworking/alignment of supplementary services data across
CS domain and IMS is to be provided.
#### 6.3.2.1 Service Support for non ICS UE, using the Architecture with CAMEL
approach
In the CS network agnostic solution for the non ICS UEs, the ICCF provides a
SIP UA behavior on behalf of the non ICS UE for CS sessions established using
standard CS procedures, and redirected to IMS using techniques similar to the
procedures defined for VCC in TS 23.206. Since the solution uses standard CS
procedures for sessions established over CS access, it is limited in its
service offering as discussed below:
##### 6.3.2.1.1 Line ID Services (OIP, OIR, TIP, TIR)
Since standard session setup procedures are used to establish the non ICS UE
sessions, with the VMSC controlling session origination and session delivery
from/to the non ICS UEs, Line ID services configuration in the HLR component
of the HSS for appropriate service execution at the VMSC is required. Some
control of these services may also be provided in IMS with an AS manipulating
the information being presented from/to the ICS subscriber using a non ICS UE.
##### 6.3.2.1.2 Communication Diversion Services
##### 6.3.2.1.2.1 Communication Diversion services exclusively controlled in
home IMS (CFU, CFNL) {#communication-diversion-services-exclusively-
controlled-in-home-ims-cfu-cfnl-1 .H6}
With the ICCF providing the SIP UA behaviour on behalf of the non ICS UE,
these services are provided in IMS.
##### 6.3.2.1.2.2 Communication Diversion services requiring participation of
serving network (CFNR, CFB) {#communication-diversion-services-requiring-
participation-of-serving-network-cfnr-cfb-1 .H6}
Some control of these services may be provided in IMS. Since standard session
setup procedures are used to establish the non ICS UE sessions, with the VMSC
controlling session origination and session delivery from/to the non ICS UEs,
some handling of these services is also required at the VMSC.
##### 6.3.2.1.2.3 Communication Deflection {#communication-deflection-1 .H6}
This service can only be provided by the VMSC.
##### 6.3.2.1.3 Communication Barring Services (CB)
With the ICCF providing the SIP UA behaviour on behalf of the non ICS UE,
these services are provided in IMS.
##### 6.3.2.1.4 Mid call services (Communication Hold, CW, Conf, Communication
Transfer)
Since standard session setup procedures are used to establish the non ICS UE
sessions, with the standard CS signalling for invocation of these services,
these services can only be provided in CS domain.
##### 6.3.2.1.5 Session continuity
The Voice Call Continuity for non ICS UEs capable of VCC is based on TS
23.206. The session continuity of ICS video call would require DTF to be
enhanced with capability of anchoring multimedia call which is under study in
MMSC WI .TS 23.206 modification are required.
##### 6.3.2.1.6 User configuration of Supplementary Services
Service data management and control of user configuration of services data is
provided by the IMS for services controlled in IMS and by the CS domain for
services controlled in CS domain
##### 6.3.2.1.7 Serving domain considerations
Table 6.3.2.1.7-1 below provides recommendation for serving domain for the
services discussed in this clause:
Table 6.3.2.1.7-1: Service set for non ICS UE with CS network agnostic
solution
+----------------------------------------------------+----------------+ | Service Capability | Serving Domain | +----------------------------------------------------+----------------+ | **Supplementary Services** | | +----------------------------------------------------+----------------+ | Originating Identification Presentation | IMS^2^ | +----------------------------------------------------+----------------+ | Originating Identification Restriction | IMS^2^ | +----------------------------------------------------+----------------+ | Terminating Identification Presentation | IMS^2^ | +----------------------------------------------------+----------------+ | Terminating Identification Restriction | IMS^2^ | +----------------------------------------------------+----------------+ | Communication Diversion (CFU, CFNL) | IMS | +----------------------------------------------------+----------------+ | Communication Diversion (CFNR, CFB) | IMS ^2^ | +----------------------------------------------------+----------------+ | Communication Deflection | CS or n.a.^1^ | +----------------------------------------------------+----------------+ | Call Wait | CS or n.a.^1^ | +----------------------------------------------------+----------------+ | Communication Hold | CS or n.a.^1^ | +----------------------------------------------------+----------------+ | Communication Barring | IMS | +----------------------------------------------------+----------------+ | Conference | CS or n.a.^1^ | +----------------------------------------------------+----------------+ | Explicit Communication Transfer | CS or n.a.^1^ | +----------------------------------------------------+----------------+ | | | +----------------------------------------------------+----------------+ | **Service Continuity ** | | +----------------------------------------------------+----------------+ | Basic Service Continuity | IMS^3^ | +----------------------------------------------------+----------------+ | Service Continuity on non mid call services | IMS^3^ | +----------------------------------------------------+----------------+ | Service Continuity with mid call services | n.a. | +----------------------------------------------------+----------------+ | | | +----------------------------------------------------+----------------+ |** Other capabilities** | | +----------------------------------------------------+----------------+ | Call Independent Supplementary Services Operations | IMS/CS^4^ | +----------------------------------------------------+----------------+ | ^1^ Control in IMS of this service is not | | | possible. As an alternative, this service may be | | | provided by CS domain: In this case a | | | configuration in the HLR component of the HSS for | | | appropriate service execution at the VMSC is | | | required. | | | | | | ^2^ Exclusive control in IMS of this service is | | | not possible, some support from the CS domain may | | | be required. Configuration in the HLR component of | | | the HSS for appropriate service execution at the | | | VMSC is required. | | | | | | ^3^ Applicable to non ICS UEs capable of VCC. | | | | | | ^4^ Service data management provided by the IMS | | | for services controlled in IMS and by CS domain | | | (if services are provided) for services controlled | | | in CS domain. | | +----------------------------------------------------+----------------+
The HLR configuration that enables the execution of CLIR, CLIP, COLP, COLR,
Call Deflection, Call Wait, Call Hold, Multiparty, Explicit Call Transfer in
the CS domain should be used when the ICS subscriber is using a non-ICS UE and
according to operator policy, in order to avoid conflicts with the
corresponding services provided by IMS.
Editor\'s Note: How to trigger the use of the appropriate HLR configuration is
to be investigated.
## 6.3.3 Architecture with Enhanced MSC Server
#### 6.3.3.1 Reference architecture
The ICS reference architecture in figure 6.3.3-1 may be used to provide ICS
support but requires MSC Server upgrades in both the home and visited
networks. The limitations of the legacy UEs need to be taken into
consideration.
{width="3.6666666666666665in" height="2.354861111111111in"}
NOTE: Only relevant functions are shown.
Figure 6.3.3-1: Architecture for ICS support without terminal impact, with MSC
Server enhancements
The MSC Server provides the necessary interworking between TS 24.008 [7] and
SIP. The MSC Server also controls a MGW to provide the user plane interworking
between CS access and RTP bearers.
Editor\'s note: Physical realization of this MGW is for further study.
## 6.3a ICS Architecture for ICS UE and non-ICS UE
This architecture alternative combines the architectures in clause 6.2 and 6.3
for a unified ICS solution that provides the following capabilities for ICS UE
and non ICS UE:
\- Consistency and continuity of operator services with an ICS UE that uses
both I1-ps and I1-cs.
\- ICCC transport change between I1-ps and I1-cs based on access network
capabilities for ICS UE.
\- IMS service control and R7 VCC based Domain Transfers with a non ICS UE.
\- Facilitate Session Continuity according to TR 23.893 [19].
### 6.3a.1 IMS CS Control Channel (ICCC)
Same as defined in clause 6.1.1 with the following difference:
I1-cs runs transparently to the VMSC when the ICS UE is attached to a standard
VMSC. I1-cs need not be transparent to the VMSC when the ICS UE is attached to
an ICS Enhanced MSC Server; i.e. the ICS capabilities of the ICS Enhanced MSC
Server may be used to interwork I1-cs with SIP at the ICS Enhanced MSC Server
for signalling efficiencies; e.g. to avoid unnecessary HSS hop when processing
USSD messages.
### 6.3a.2 Reference architecture diagram
Figure 6.3a.2-1 ICS Architecture for ICS and non ICS UE
This architecture introduces new logical functions as described below.
#### 6.3a.2.1 IMS CS Control Function (ICCF)
Same as defined in clause 6.2.
The R-CAAF is employed only when using I1-cs which is established via a
standard VMSC, or when using I1-cs which is established via IMSC Server which
does not implement the option for non transparent I1-cs. To be able to employ
the R-CAAF, the ICCF must know whether there is an IMSC that implements the
option for non transparent I1-cs or not. This capability is negotiated during
the registration procedure between the IMSC and ICCF.
For ICS User using ICS UE using I1-ps and I1-cs established via an IMSC and
for non ICS UE, and for session established via IP-CAN, the RUA of the ICCF is
inserted in the ICS User session path as part of the originating and
terminating iFC execution. For I1-cs established via a standard VMSC, the RUA
is invoked via USSD or through PSI routing.
The RUA provides UA behaviour for all ICS User sessions; the ICS UE or an IMSC
enables the RUA in the ICCF, with a SIP UA also running on the ICS UE or the
IMSC.
The RUA maintains the access network information required to enable the T-ADS;
it also maintains the end-to-end SIP session state for all ICS User sessions
to enable Service Continuity and change of ICCC transport while maintaining an
active session.
The ICCF is not required when using non ICS UEs which are capable of receiving
voice telephony services only over GSM/UMTS CS access.
#### 6.3a.2.2 ICS Enhanced MSC Server (IMSC)
Selected the approach as documented in the Conclusion clause of this TR.
#### 6.3a.2.3 ICS UE
Same as defined in clause 6.2.3
ICS UE receives ICS when using an ICS Enhanced VMSC Server or a standard VMSC.
#### 6.3a.2.4 Remote Provisioning Client (RPC)
Same as defined in clause 6.2.2.4.
#### 6.3a.2.5 Reference Points
##### 6.3a.2.5.1 I1 Reference Points
Same as defined in clause 6.4.1 with the following difference:
I1-ps is established using the Gm reference point as in clause 6.4.
When I1-cs is established via standard VMSC, it is transparent to the serving
CS network.
When I1-cs is established via an IMSC, it may not be transparent to the IMSC
if the R-CAAF resides in the IMSC as an internal adaptation function.
The I1 reference points are used only for ICS UE.
##### 6.3a.2.5.2 I2 Reference Point
Same as defined in clause 6.4.2.
The I2 reference point is used for ICS UE and non ICS UE.
##### 6.3a.2.5.3 I5 Reference Point
Same as defined in clause 6.4.5.
##### 6.3a.2.5.4 I6 Reference Point
Same as defined in clause 6.4.6.
The I6 reference point is used for routing of session control signalling to
IMS, with the ICCF inserted in the session path via iFC execution.
The I6 reference point is used for ICS UE when using I1-cs via an IMSC and for
non ICS UE.
Editor\'s note: Use of the I4 reference point for ICS capability exchange
between the ICCF and the ICS Enhanced MSC Server is FFS.
### 6.3a.3 Signalling and Bearer Architecture for ICS UE: I1-ps with Bearer
Control Signalling Path established via standard VMSC
Same as in clause 6.5.1 Signalling and bearer architecture for full duplex
speech over CS access.
### 6.3a.4 Signalling and Bearer Architecture for ICS UE: I1-ps with Bearer
Control Signalling Path established via IMSC
The signalling and bearer setup for I1-ps when using an IMSC for CS bearer
setup is the same as when using a standard VMSC with a difference that the
IMSC sets up the Bearer Control Signalling Path as a standard SIP session
towards home IMS, and that IMSC registers to IMS on behalf of the ICS UE.
{width="6.659027777777778in" height="4.081944444444445in"}
Figure 6.3a.4-1: Signalling/Bearer Paths for PS transport of ICCC; CS bearer
setup via IMSC
### 6.3a.5 Signalling and Bearer Architecture for ICS UE: I1-cs using a
standard VMSC
Same as in clause 6.6.1 Signalling and bearer architecture for full duplex
speech over CS access.
### 6.3a.6 Signalling and Bearer Architecture for ICS UE with I1-cs using an
IMSC and non ICS UE
When attached to an IMSC, the ICS UE or a non ICS UE may receive IMS services
as enabled by interworking of CS Access Signalling for the I6 reference point
by the IMSC.
{width="6.65625in" height="3.092361111111111in"}
Figure 6.3a.6-1: Signalling/Bearer Paths for I1-cs of ICS UE and non ICS UE
attached to a IMSC
In this model ICS is enabled by the ICS Enhanced MSC Server interworking the
CS Access Signalling with 3GPP IMS SIP. New procedures over the I6 reference
point are used to set up the Session Control Signalling Path between the IMSC
and remote end with the ICCF inserted in the session path using originating
and terminating iFCs. The media is established between the UE and the remote
end through a MGW controlled by the IMSC. The SDP information related to the
media is carried in the Session Control Signalling Path. The ICCF maintains
the end-to-end session state and access specific information to enable Service
Continuity and T-ADS. When IMSC serves the ICS UE using I1-cs, the IMSC
registers to IMS on behalf of the UE, regardless whether the IMSC implements
the transparent or non transparent option of I1-cs.
Interworking of CS Access Signalling with 3GPP SIP for session setup for this
model enables the capability to provide all services exclusively by IMS.
NOTE: When IMSC is serving ICS UE using I1-cs, the I1-cs may or may not be
transparent to IMSC depending on the implementation option. The figure
6.3a.6-1 shows only the non-transparent option.
### 6.3a.7 Signalling and Bearer Architecture for an ICS User who only owns a
non ICS UE which is capable of receiving voice telephony services only over
GSM/UMTS CS access
**Same as in clause 6.8.a.1.1.**
## 6.4 ICS Reference Points
### 6.4.1 I1 Reference Point
For ICS UEs, the I1 reference point is used between the ICS UE and the ICCF.
The I1 reference point implements either the I1-cs or the I1-ps. The I1-cs may
be established through the CS domain network using CS Access Signalling and
the I1-ps may be established through PS domain using PS transport.
### 6.4.2 I2 Reference Point
The I2 reference point is used between the ICCF and the CSCF for presentation
of the SIP UA behaviour toward IMS for control of user sessions.
### 6.4.3 I3 Reference Point
The I3 reference point is established between non ICS UE and the ICCF through
the non-enhanced CS network using standard CS network procedures for CS
session establishment and using CAMEL for redirection of CS originating
sessions to IMS.
The I3 reference point is only applicable to the architecture for ICS support
without terminal impact or VMSC enhancements.
### 6.4.4 I4 Reference Point
For non ICS UEs, the I4 reference point is used between the L-CAAF-n
associated with the VMSC and the ICCF for establishment and control of ICCC.
### 6.4.5 I5 Reference Point
The I5 reference point is used between the ICCF and the AS for securely
managing and configuring data for ICS when I1-cs is used or when a circuit
switch data connection with Ut over it is established. This reference point
uses capabilities defined for the Ut reference point as defined in TS 23.002
[18].
### 6.4.6 I6 Reference Point
The I6 reference point is established between the MSC Server and the home IMS
of the ICS subscriber using a non ICS UE for presentation of the SIP UA
behaviour toward IMS for control of user sessions. The Mw reference point is
used as the baseline for I6.
### 6.4.7 I7 Reference Point
The I7 reference point is established between the MSC Server and the MGW for
interworking the user plane on CS access interfaces (A and IuCS reference
points) with the user plane in IMS (Mb reference point).
The I7 reference point is realized by adding the Mn reference point to the MSC
Server. This allows the MSC Server to control both a CS-MGW and an IM-MGW,
which is sufficient to perform the necessary user plane interworking. This is
depicted in the following figure.
{width="4.59375in" height="1.6034722222222222in"}
Figure 6.4.7-1
For resource efficiency, H.248.18 [13] can be used to allow the enhanced MSC
Server and its MGW to negotiate the use of both the Mc and Mn profiles,
defined in TS 29.232 [14] and TS 29.332 [15] respectively.
The TS shall not define a new reference point, but instead shall add the Mn
reference point to the MSC Server.
## 6.4a Applicability of the Domain Selection Function to ICS
### 6.4a.1 Service Domain Selection (SDS) for ICS
Service control for all ICS user sessions is provided by IMS, hence the
service domain selection, if applied, results in selection of IMS as the
serving domain for all ICS user sessions.
SDS may be required in the CS domain core network for originating sessions
established using CS call control and for terminating sessions directed to the
CS domain so that the ICS user sessions are redirected to IMS for service
control.
### 6.4a.2 Access Domain Selection (ADS) for ICS
#### 6.4a.2.1 ADS for originating sessions
ADS for originating sessions is executed in the UE, as specified in TS 23.221,
clause 7.2a Domain selection for UE originating sessions / calls.
#### 6.4a.2.2 ADS for terminating sessions
The ADS for terminating sessions is executed by the last Application Server as
part of the terminating iFC.
For a network which implements the ICCF, the ICCF is the last AS for the ICS
user.
NOTE 1: The ADS need not be physically collocated with the ICCF.
NOTE 2: ADS selection criteria is in TS 23.221 clause 7.2b, Access Domain
Selection for terminating sessions
Alternatively for the I1-ps approach and the I1-cs approach, the initial ADS
for terminating sessions could be executed in the UE in conjunction with the
network based on operator policy and taking into account its own capabilities
and those of the access network. Figure 6.4a.2.2-1 shows an example handling
logic for UE based domain selection in ICS.
In both cases, the access domain used by all ICS UE and non ICS UE active
sessions is taken into account during ADS for any new incoming call.
Figure 6.4a.2.2-1: Example handling logic for UE based Terminating Access
Domain Selection for ICS
The ICCF will be included in the call flow for all MT calls.
1 If the terminal is IMS registered the ICCF sends an INVITE to the
terminating UE
a. If the terminal determines it is in a bi-directional speech/media capable
IP-CAN it will respond to the INVITE with a standard 18x response and the
session will be established via IMS.
b. If the terminal determines it is in a IP-CAN where bi-directional
speech/media cannot be supported, but where the access network can support
simultaneous PS and CS, it will respond with a 18x response, that indicates
that the media should be carried via a CS bearer. The UE will then establish a
CS bearer towards the ICCF, and the ICCF will correlate the CS bearer with the
IMS session.
c. If the terminal determines it is in a IP-CAN where bi-directional
speech/media cannot be supported and where there is no simultaneous CS and PS
in the access network, it responds by sending a suitable error response
towards the ICCF to indicate that the session will be established via the CS
domain using I1-cs procedures. Further control and configuration of services
will be via USSD.
2 If the terminal is not IMS registered via an IP-CAN but is CS registered,
the ICCF will use USSD to send the incoming call notification towards the
terminal. The UE will establish a CS bearer towards the ICCF using I1-cs call
establishment procedures that the ICCF will correlate with the IMS session.
Further control and configuration of services will be via USSD.
##### 6.4a.2.2.1 Interactions with VCC for ADS of terminating sessions
In a network that implements the ICCF the ADS for terminating sessions
established for ICS UE capable of VCC is executed by the ICCF which is invoked
after the DTF of the VCC AS, as part of the terminating iFC, or by network in
conjunction with the UE based on operator policy and taking into account the
capabilities of the access network. TS 23.206 modifications are required.
NOTE: How the UE determines the bi-directional speech/media capabilities of
the access network is not within the scope of this study.
Editor\'s note: Details of modifications to TS 23.206 are FFS.
ADS for terminating sessions established for a VCC subscriber who is not an
ICS user is provided as specified in TS 23.206.
It is not specified which AS performs T-ADS for a network that does not
implement ICCF or VCC.
ADS is performed only once per session.
## 6.5 Architectural alternative: I1-ps approach
### 6.5.1 Signalling and bearer architecture for full duplex speech over CS
access
When in CS coverage with simultaneous PS access available, e.g. UTRAN, the ICS
UE may use IMS SIP signalling over PS bearers for enablement of I1-ps when
**_support of the full duplex speech component of the IMS multimedia telephony
service_** is not available **_over PS bearer_**.
Figure 6.5.1-1: Signalling/Bearer Paths for PS transport of ICCC
In this model the I1-ps is enabled by using IMS SIP signalling over PS
bearers, and is used for session setup when establishing IMS voice sessions
using CS voice bearers. IMS SIP signalling is used in the UE for control of
all calls with the I1-ps established through the Session Control Signalling
Path over PS access. Standard IMS call control procedures are used to set up
the Session Control Signalling Path between the UE and remote end with the RUA
inserted in the session path. No bi-directional speech media is transmitted
over the IP-CAN. In parallel, the UE establishes a Bearer Control Signalling
path with the RUA by establishing a CS call toward the RUA. The Bearer Control
Signalling and Session Control Signalling stimuli are combined at the RUA for
presentation of the IMS session toward the CSCF on behalf of the UE.
The UE maintains the SIP/SDP state machine with RUA also maintaining a copy of
the state data when present in the session path.
Use of the I1-ps for session setup for this model enables the capability to
provide all services exclusively by IMS.
The CAAF is not required when using I1-ps with RUA providing control of IMS
sessions using CS voice bearers.
### 6.5.2 Information flows
#### 6.5.2.1 Registration
Provides an example flow for Registration made by an ICS UE where by a dynamic
RUA DN is allocated to be used for session originations where CS domain is
used for bearer plane.
Figure 6.5.2.1-1
1\. IMS registration procedure per TS 23.228 [4] is performed. As part of the
IMS registration procedure subscriber data shall be loaded into S-CSCF. This
data shall include a URL that identifies the location of where the
configuration data (RUA DN) for the subscriber shall be stored.
2\. 3rd party registration shall be performed to the ICCF as per TS 23.228 [4]
3\. ICCF shall subscriber to the REG Event package per TS 23.228 [4]
4\. ICCF shall receive a SIP NOTIFY per TS 23.228 [4] in response to the REG
EVENT subscription. The SIP NOTIFY shall include a URL that identifies the
location of where the configuration data (RUA DN) for the subscriber shall be
stored per RFC 4483.
5\. The ICCF allocates a unique RUA DN that has the properties that when
received in a SIP INVITE from a MGCF in a future session set-up is ,the ICCF
can retrieve the necessary call information from the initial SIP INVITE that
indicated that the voice media is not conveyed via the IP-CAN. The RUA DN
shall be stored at the location as identified by the URL received in the SIP
NOTIFY.
6\. The ICS UE shall subscribe to the Reg Event Package per TS 23.228 [4]
7\. The ICS UE shall receive a SIP NOTIFY that includes a URL that identifies
the location of where the configuration data (RUA DN) for the subscriber shall
be stored per RFC 4483.
8\. The ICS UE shall retrieve the configuration data from the URL as
identified in step 7.
#### 6.5.2.2 Origination
##### 6.5.2.2.1 Calls established using CS bearers with use of I1-ps
Figure 6.5.2.2.1-1 provides an example flow for a call made by an ICS UE‑A to
the other end B with I1-ps.
Figure 6.5.2.2.1-1: ICS UE origination: PS transport
1,2. ICS UE‑A generates a SIP INVITE initiating a session toward the other end
B, and sends it toward the home IMS. The SIP INVITE message has sufficient
information needed at the RUA of the ICCF to correlate the session request
with the Bearer Control Session established with the RUA of the ICCF in steps
3 through 6. It also contains information that the voice media is not
converyed via the IP-CAN. The PCRF or P-CSCF needs to recognise that the PS
media is not used for the voice component in order to avoid the PCC
authorizing or provisioning PS bearer resources for them.
NOTE 1: The SIP Session Control Signalling is used to carry information that
would be otherwise (i.e. in regular IMS procedures) carried in the same SIP
dialog than voice media (examples: voice media is inactivated, location of the
UE is carried in PIDF-LO element and SIP Call-Info header carries e.g.
business card). In other words, the SIP Session Control Signalling is not used
for SIP messages that are sent out of the SIP dialog of voice media (examples:
REFER, SUBCSCRIBE, NOTIFY, PUBLISH, MESSAGE as these messages are typically
sent out of the existing voice SIP dialog).
NOTE 2: How the UE selects when to use the voice SIP dialog also for other
media will follow the requirements defined in the communication service
framework in TS 23.228 [4], clause 4.13.
3\. The ICS UE initiates standard CS procedures for establishing a CS
originated call with the RUA of ICCF to establish the Bearer Control
Signalling session with the RUA of ICCF. The UE‑A sends a CS SETUP message to
DN associated with the RUA of ICCF. The DN used by the UE to establish the
Bearer Control Signalling session is either statically configured on the UE or
assigned to the UE by the ICCF upon IMS Registration. The Bearer Control
Signalling session is identified at the ICCF by the caller\'s identity for
correlation with the Session Control Signalling session as there can be only
one Bearer Control Signalling session for an ICS UE at any given time. If the
ICS UE has multiple IMS sessions for voice, a single circuit bearer is
alternated between the multiple sessions.
NOTE 3: The ISUP link might (especially in roaming situations) not be able to
transfer enough information to correlate the SIP INVITE. Under such
circumstances the ICCF may need to interact with a CAMEL Service.
NOTE 4: Steps 3-5 may occur in parallel to steps 1-2.
4\. Standard VMSC procedure for CS origination.
5\. Standard MGCF procedure for PSTN origination. The I-CSCF routes the INVITE
based on the standard procedures \"PSI based Application Server Termination
(direct or --indirect) procedures in TS 23.228 [4]. S-CSCF selected may not be
the same one as in step 1. The PSI routing points to the same RUA of the ICCF
as in step 1 (e.g. with the use of dedicated PSI per user).
6\. Standard IMS procedure to route the SIP INVITE message to the RUA of the
ICCF is invoked as part of standard iFC processing at the S-CSCF.
7\. The RUA of the ICCF the invokes a B2BUA, terminating the UE Leg and
originating the RUA Leg for presentation of an IMS session toward Other end B
on behalf of ICS UE‑A. The RUA of the ICCF combines the SDP offers received
for the Session Control Signalling and Bearer Control Signalling as one offer
towards the other end B. The SDP offer used to establish the voice media send
towards other end B follows the regular IMS procedures for a VoIP offer for
voice media.
8\. Standard IMS originated session processing at the CSCF.
NOTE 5: VCC and Originating Supplementary services (e.g. OCB, OIR), if any,
are executed in the Application Servers in home IMS. These are not shown in
the figure.
NOTE 6: VCC Application may anchor the SIP session before it leaves the
originating IMS (as per regular Rel‑07 VCC procedures), these are not shown in
the figure.
NOTE 7: Once the B party answers to the SDP offer, the RUA of the ICCF needs
to modify also the leg towards the MGCF. The RUA of the ICCF sends a Re-INVITE
to MGCF, MGCF modifies the remote MGW resource reservation accordingly. The
Re-INVITE modifies the remote IP address and codec of MGW in order to send and
receive RTP stream from/to B party. This is not shown in the figure.
NOTE 8: E.164 resources are considered scarce. Assigning multiple E.164
numbers to each ICS UE may not be possible for some operators.
##### 6.5.2.2.2 Calls established using CS bearers with use of I1-ps (Dynamic
RUA DN allocation)
When an ICS UE establishes a call using CS bearers with use of I1-ps, it will
setup a call using an RUA DN that has the properties that when received, the
ICCF can retrieve the necessary call information stored upon receipt of a
first INVITE. This RUA DN is either provisioned on demand (i.e. during a call
setup) or at another time (e.g. during registration). In order to conserve
E.164 numbers, such an RUA DN is likely to be released after a (configurable)
period. In such a case, another RUA DN would have to be used.
Figure 6.5.2.2.2-1 provides an example flow for a call made by an ICS UE‑A to
the other end B with I1-ps, where the ICS UE‑A uses a dynamic RUA DN).
Figure 6.5.2.2.2-1: ICS UE origination: PS transport
1,2. ICS UE‑A generates a SIP INVITE initiating a session toward the other end
B, and sends it toward the home IMS. The SIP INVITE message has sufficient
information needed at the RUA to set up the outgoing SIP INVITE in step 6. The
SIP INVITE also contains information that the voice media is not conveyed via
the IP-CAN. The PCRF or P-CSCF needs to recognise that the PS media is not
used for the voice component in order to avoid the PCC authorizing or
provisioning PS bearer resources for them.
Editor\'s Note 1: The details on correlating the session request with the
Bearer Control Session established with the RUA are FFS.
NOTE 1: The SIP Session Control Signalling is used to carry information that
would be otherwise (i.e. in regular IMS procedures) carried in the same SIP
dialog than voice media (examples: voice media is inactivated, location of the
UE is carried in PIDF-LO element and SIP Call-Info header carries e.g.
business card). In other words, the SIP Session Control Signalling is not used
for SIP messages that are sent out of the SIP dialog of voice media (examples:
REFER, SUBCSCRIBE, NOTIFY, PUBLISH, MESSAGE as these messages are typically
sent out of the existing voice SIP dialog).
NOTE 2: How the UE selects when to use the voice SIP dialog also for other
media will follow the requirements defined in the communication service
framework in TS 23.228 [4], clause 4.13.
3\. The ICS UE initiates standard CS procedures for establishing a CS
originated call with the RUA of ICCF to establish the Bearer Control
Signalling session with the RUA of ICCF. The UE‑A sends a CS SETUP message to
the RUA DN that was received in a previous 200Ok (see step 10) for session
establishment or as a result of registration
4\. Standard VMSC procedure for CS origination.
5\. Standard MGCF procedure for PSTN origination. The I-CSCF routes the INVITE
based on the standard procedures \"PSI based Application Server Termination
(direct or --indirect) procedures in TS 23.228 [4]. S-CSCF selected may not be
the same one as in step 1. The PSI routing points to the same RUA of the ICCF
as in step 1.
6\. Standard IMS procedure to route the SIP INVITE message to the RUA of the
ICCF is invoked as part of standard iFC processing at the S-CSCF.
7\. Upon receipt of the SIP INVITE, the RUA will use the received RUA DN to
correlate the original SIP INVITE in step 1 with the received SIP INVITE.
B2BUA will be invoked, terminating the UE Leg and originating the RUA Leg for
presentation of an IMS session toward Other end B on behalf of ICS UE‑A. The
RUA of the ICCF combines the SDP offers received for the Session Control
Signalling and Bearer Control Signalling as one offer towards the other end B.
The SDP offer used to establish the voice media send towards other end B
follows regular IMS procedures.
Editor\'s Note 3: the behaviour of the ICCF upon receipt of a released RUA DN
is FFS.
8-9. Standard IMS originated session processing at the CSCF.
10-11. Upon receipt of the SIP 200Ok from UE‑B, the ICCF allocates a unique
RUA DN that has the properties that when received in a 2nd SIP INVITE in a
future session set-up (step 6) the ICCF can retrieve the necessary call
information from the initial SIP INVITE received to initiate a session (step
2). The RUA DN is sent back to ICS UE‑A in SIP 200OK per RFC 4483.
NOTE 4: VCC and Originating Supplementary services (e.g. OCB, OIR), if any,
are executed in the Application Servers in home IMS. These are not shown in
the figure.
NOTE 5: VCC Application may anchor the SIP session before it leaves the
originating IMS (as per TS 23.206 [x] ), these are not shown in the figure.
NOTE 6: Once the B party answers to the SDP offer, the RUA of the ICCF needs
to modify also the leg towards the MGCF. The RUA of the ICCF sends a Re-INVITE
to MGCF, MGCF modifies the remote MGW resource reservation accordingly. The
Re-INVITE modifies the remote IP address and codec of MGW in order to send and
receive RTP stream from/to B party. This is not shown in the figure.
#### 6.5.2.3 Termination
##### 6.5.2.3.1 Calls established using CS bearers with use of I1-ps
The figure 6.5.2.3-1 provides an example flow for a call destined to an ICS UE
when the PS transport alternative for ICCC is used to support the setup of
terminating sessions.
Figure 6.5.2.3.1-1: ICS UE termination using CS bearers with use of I1-ps
1\. An incoming SIP INVITE is received at the S-CSCF of the B party.
2\. The S-CSCF forwards the INVITE to the ICCF.
3\. The ICCF fetches a number such as MSRN if a media connection is not
already established to UE‑B.
Editor\'s Note 1: The type of number to be used and how the number is
allocated is FFS. The Relationship and interworking with DSFVCC is FFS.
4\. The ICCF generates an INVITE to the other end B indicating the use of a CS
bearer.
5\. The INVITE is sent to the UE‑B via I1-ps. It also contains information
that the voice media is not conveyed via the IP-CAN. The PCRF or P-CSCF needs
to recognise that the PS media is not used for the voice component in order to
avoid the PCC authorizing or provisioning PS bearer resources for them.
6\. UE‑B responds with a 183 Session Progress. The user is not alerted.
7\. The ICCF receives the 183 Session Progress from the UE.
8\. The ICCF sends an INVITE (tel URI = MSRN) to the S-CSCF.
9\. The Request URI has been modified, the S-CSCF skips further service
execution and routes the call towards the CS domain.
10\. The MGCF sends an IAM to the VMSC.
11\. VMSC sends SETUP to UE‑B.
12\. The user accepted the call, the UE sends the 200 OK.
13\. UE‑B responds with a CONNECT message.
14\. VMSC responds with ANM towards the IMS.
15\. MGCF sends the 200 OK to the S-CSCF.
16\. S-CSCF forwards the 200 OK to the ICCF.
17\. The ICCF sends a 200 OK as response to the INVITE in step 2 towards the
S-CSCF.
18\. S-CSCF forwards the 200 OK towards the A party.
##### 6.5.2.3.2 Using CS Origination procedures to set up the Bearer Control
Signalling session
The figure 6.5.2.3.2-1 provides an example flow for a call destined to an ICS
UE when the PS transport alternative for ICCC is used to support the setup of
terminating sessions using standard CS Origination procedures for setting up
Bearer Control Signalling session.
NOTE: The un-bolded steps are related to the Session Control Signalling set-up
procedures. The bolded steps are related to the Bearer Control Signalling
session set-up procedures.
Figure 6.5.2.3.2-1: ICS UE termination using CS bearers using CS Origination
procedures with use of I1-ps
1\. An incoming SIP INVITE is received at the S-CSCF of the B party with an
Offer containing SDP from the A-party.
2\. The S-CSCF forwards the INVITE to the ICCF.
3\. The ICCF performs access selection and chooses the CS domain.
4\. The ICCF sends a 183 Session Progress back to the S-CSCF.
5\. The S-CSCF sends the 183 Session Progress to the A-party.
6\. The ICCF (acting as a B2BUA) establishes a session over I1-ps by sending
an INVITE to the B-party. This INVITE contains an indication to inform the UE
to initiate the CS bearer establishment procedure. The INVITE also contains a
dynamic RUA PSI to enable the ICCF to later on correlate the outgoing session
control signalling with the incoming bearer control signalling.
7\. UE‑B responds with a 183 Session Progress.
8\. UE‑B sends a SETUP message to the VMSC to establish the Bearer Control
Signalling session. The SETUP message includes the RUA PSI DN as the called
party number. This will establish the circuit voice bearer between the UE and
IMS.
9\. The VMSC responds with a call proceeding message and begins to set up the
Bearer Control Signalling session.
10\. The VMSC processes the SETUP message and sends an IAM to the MGCF. The
SETUP message contains the RUA PSI DN. [NOTE: Standard VMSC procedures for CS
origination]
11\. The MGCF performs a setup of the MGW and creates an INVITE with an Offer
containing the SDP from the MGW. The INVITE is sent to the ICCF (via the
I/S-CSCF). [NOTE: Standard MGCF procedure for PSTN origination]
12\. The I/S-CSCF forwards the INVITE to RUA of ICCF.
13\. The ICCF sends an UPDATE to the S-CSCF with an Answer to the Offer from
the A-party, containing the SDP from the MGW.
14\. The S-CSCF forwards the UPDATE to the A-party.
15\. The S-CSCF receives a 200 OK to the UPDATE.
16\. The S-CSCF forwards the 200 OK to the ICCF.
17\. The ICCF sends a 183 Session Progress to S-CSCF with an Answer to the
Offer from the MGW, containing the SDP from the A-party.
18\. The S-CSCF sends the 183 Session Progress to the MGCF.
19\. The MGCF creates an ACM and sends it to the VMSC.
20\. Alerting is sent from the VMSC to UE‑B.
21\. The ICCF sends a 200 OK to S-CSCF in response to the INVITE in Step 12.
22\. The S-CSCF forwards the 200 OK to the MGCF.
23\. The MGCF creates an ANM and sends it to the VMSC.
24\. The VMSC sends a Connect to UE‑B. The set up of the bearer is complete.
25\. User alerting at UE‑B; UE‑B sends 180 Ringing to the ICCF.
26\. The ICCF forwards the 180 Ringing to the S-CSCF for communicating toward
UE‑A.
27\. The S-CSCF forwards the 180 Ringing to UE‑A.
28\. User answer at UE‑B; UE‑B sends a 200 OK to the ICCF for the INVITE in
Step 6.
29\. The ICCF forwards the 200 OK to the S-CSCF for communicating toward UE.
30\. The S-CSCF forwards the 200 OK towards to the A-party.
NOTE: Steps 21-24 above related to the Bearer Control Session set-up
procedures may alternatively be sent after the 200 OK has been sent from the
ICCF towards UE‑A.
#### 6.5.2.4 Mid-call services
##### 6.5.2.4.1 Calls established using CS bearers with use of I1-ps
Figure 6.5.2.4.1-1 provides an example flow for a call made by an ICS UE‑A to
the other end C after holding the other end B.
Figure 6.5.2.4.1-1: ICS UE mid-call service-A holds B, calls C: PS transport
1\. ICS UE‑A Holds Call to the other end B by sending a \"HOLD indication\"
via SIP Re-INVITE message to RUA.
2\. Standard IMS procedure to communicate the SIP message to the RUA.
3\. RUA composes an SDP offer towards the B party to put the voice media on
hold. SDP offer/answer for hold follows the standard MMTel procedures.
4\. Standard IMS procedure to communicate the SIP message to the B party.
5\. UE‑A generates a SIP INVITE initiating a session toward the other end C,
and sends it toward the P-CSCF and I/S-CSCF. The SIP INVITE message has
sufficient information needed at the RUA to correlate the session request with
the Bearer Control Session established previously with the RUA. The SDP offer
in INVITE indicates to the RUA that the UE‑A is willing to establish a voice
call via CS bearer, and the actual details for voice media will be offered by
MGCF.
6\. Standard IMS procedure to communicate the SIP message to the RUA.
NOTE: Annex B describes two ways to handle media/RTCP report of the held party
(party-B) and the media connection toward ICS UE‑A and party C. As the result
of the procedure in Annex B, ICS UE‑A & party C are talking.
#### 6.5.2.5 Domain Transfer to CS
The following figure provides an example flow for Domain Transfer to CS when
the user is engaged in a held voice session with the other end B and an active
voice session with the other end C, when using ICS UE with I1-ps and the AS
approach for the ICCF.
Figure 6.5.2.5-1: Domain Transfer to CS
As a starting point, user A has two ongoing voice calls, one in Active state
with C, and another on Hold with B. This means the UE‑A has two ongoing SIP
dialogs which both include Session and Bearer Control Signalling, one dialog
towards UE‑C and another UE‑B. Neither of them traverses via RUA. Procedures
to establish such dialogs follow the procedures in TS 24.173 [5].
1\. Upon detection of conditions requiring Domain Transfer, UE‑A initiates the
Domain Transfer to CS by establishing a Bearer Control Path with RUA of the
ICCF through the VMSC.
2\. UE‑A sends an INVITE over GPRS transport requesting the Domain Transfer of
the active session with the other end C. If the UE received the STI from the
DTF during session establishment then the domain transfer request contains an
STI, otherwise, only the VDI, as defined in TS 23.206 [3], is used. The
transfer session is created in the UE with the current state information of
the session being transferred.
NOTE 1: Due to change of the IP address, the UE needs to re-register to IMS
over the transferred-in access before it is able to send INVITE to VDI for
Domain Transfer.
3\. Standard originating iFC execution processing at the CSCF results in
execution of the RUA.
The Bearer Control Signalling session established in the INVITE sent by S-CSCF
in step 1 is identified at the ICCF by the caller\'s identity for correlation
with the Session Control Signalling session transferred via the INVITE sent by
the S-CSCF in step 3 as there can be only one Bearer Control Signalling
session for an ICS UE at any given time. If the ICS UE has multiple IMS
sessions for voice, a single circuit bearer is alternated between the multiple
sessions.
NOTE 2: The ISUP link might (especially in roaming situations) not be able to
transfer enough information to correlate the SIP INVITE. Under such
circumstances the ICCF may need to interact with a CAMEL Service.
4\. The INVITE is extended toward the CSCF by the RUA after combining with the
media components established via the MGCF/MGW in Step 1. The INVITE is
processed at the CSCF using standard IMS procedures and the DTF of the VCC AS
is invoked as part of standard iFC processing at the CSCF, as in regular Rel07
VCC procedures.
5\. The DTF uses Access Leg Update procedure to update the Access Leg and the
Remote Leg associated with the other end C\'s session. The DTF extends a Re-
INVITE toward the other end C for update of SDP. Standard Domain Transfer
procedure at CSCF for extending the Re-INVITE toward the other end C. A CS
bearer path is re-established between the UE‑A and the other end C via MGW as
a result of the Re-INVITE processing at the other end C. The DTF and UE
subsequently release the other end C\'s Access Leg previously established via
IMS.
6\. UE‑A sends an INVITE over GPRS with held SDP requesting the Domain
Transfer of the held session with the other end B. If the UE received the STI
from the DTF during session establishment then the domain transfer request
contains an STI, otherwise. only the VDI, as defined in TS 23.206 [3], is
used.
Step 6 may execute in parallel with procedures initiated by Step 2.
7\. Standard processing at the CSCF for directing toward RUA.
8\. The INVITE is extended back to the CSCF by the RUA.
9\. The INVITE is processed at the CSCF using standard procedures and the DTF
is invoked as part of standard iFC processing at the CSCF.
The DTF identifies this session as a held session and updates the Access Leg
with the information received in the INVITE. This is needed for completion of
the call control signalling path between the UE and the other end B via the
Access Leg established with DTF via CS domain. An Access Leg update of the
held session toward the other end B, in other words, the updating of the
Remote Leg of the B\'s session may not be necessary at this point since active
media is not needed for this session until B is \"Resumed\". However, this
procedure may be carried out in parallel to completion of Domain Transfer of
the active session toward the other end C as a UE implementation option.
NOTE 3: The DTF must send re-INVITE also for the held session for continuation
of the RTCP reports if previously being sent to the UE port.
The DTF and UE subsequently release the other end B\'s Access Leg previously
established via IMS, as in regular Release 7 VCC procedures. This completes
the Domain Transfer procedures.
10\. After the Domain Transfer the User A may want to swap the calls between B
and C. User A subsequently Holds the other end C and Resumes the other end B.
A Re-INVITE is sent with held SDP for C\'s session is sent by UE‑A.
11\. The Re-INVITE with held SDP is communicated to the other end C and the
session is Held.
12\. A Re-INVITE for Resuming B\'s session is also sent by the UE‑A.
13\. The Re-INVITE is processed at the CSCF and the DTF for Access Leg Update
of B\'s session resulting in establishing and/or updating of an IP bearer
between the other end B and the UE‑A (bearer is established if it was not
established in the Held state as part of procedure initiated in Step 9; bearer
is updated if it was established in the Held state as part of procedure
initiated in Step 9).
##### 6.5.2.5.3 Assignment of Session Transfer Identifier
See clause 6.6.2.
#### 6.5.2.6 I1-ps to I1-cs fallback
The Figure 6.5.2.6-1 provides an example flow for Session Control Signalling
Path handover from I1-ps to I1-cs.
Figure 6.5.2.6-1: Session Control Signalling Path handover from I1-ps to I1-cs
1\. Upon detecting that PS access can not satisfy the signalling communication
requirement for PS session control signalling path or becomes unavailable, ICS
UE triggers the session control signalling path handover.
2\. ICS UE sends the session control signalling path handover request with PS
session control signalling path information to ICCF over I1-cs.
3\. ICCF identifies the PS session control signalling path to be handed over,
and decides to accept the handover request, then returns the acknowledgement
to ICS UE.
After the above steps, the session control signalling path is handed over from
the PS access to the CS access, and the subsequent session control signalling
will be over I1-cs.
If the ICCF detects that the ICS UE is not reachable by PS and the UE has not
already made a fallback to I1-cs, the ICCF shall clear all session related to
the user currently being controlled over I1-ps.
### 6.5.3 I1-ps handover scenarios
#### 6.5.3.1 Introduction
When in CS coverage with simultaneous PS access available, e.g. UTRAN, the ICS
UE may use IMS SIP signalling over PS bearers for enablement of I1-ps when
**_support of the full duplex speech component of the IMS multimedia telephony
service_** is not available **_over PS bearer_**. However, it is possible that
session and media control signalling transport over the PS access in an
ongoing session becomes unavailable while the CS access in the same session is
still available. Under such circumstance, to keep the control signalling
continuity, the signalling transport is supposed to be handed over from PS
access to CS access.
#### 6.5.3.2 Handovers within 3G access for IMS sessions using CS voice bearer
established with I1-ps
Figure 6.5.3.2-1 below provides signalling and bearer paths for an IMS session
using CS voice bearer established in 3G access with I1-ps before and after
handover to another 3G access.
Figure 6.5.3.2-1: Handovers from 3G to 3G with I1-ps
Standard UMTS Relocation procedures are used for handover of the Session
Control Signalling Path and the CS Access Signalling along with the associated
circuit voice bearer to the target access network. The coordination between
the two Iu signalling connections, one with the PS core network for Session
Control Signalling Path and the other with the CS core network for CS Access
Signalling is performed by the target access network as described in TS 25.413
[10].
The I1-ps is maintained upon handover to the target 3G access network.
#### 6.5.3.3 Handovers of IMS sessions using CS voice bearer established in 3G
access with I1-ps to 2G access
##### 6.5.3.3.1 PS Domain available after HO to 2G access
Figure 6.5.3.3.1-1 below provides signalling and bearer paths for an IMS
session using CS voice bearer established in 3G access with I1-ps before and
after handover to 2G access where PS domain is available (e.g. DTM).
Figure 6.5.3.3.1-1: Handovers from 3G to 2G with I1-ps
Standard Rel‑07 DTM Handover procedures, TS 43.055 [12], defined for DTM/3G
handovers are used for handover of the Session Control Signalling Path and the
CS Access Signalling along with the associated circuit voice bearer to the
target access network.
The I1-ps is maintained upon handover to the target 2G access network.
##### 6.5.3.3.2 PS Domain is not available after HO to 2G access
Figure 6.5.3.2.2-1 below provides signalling and bearer paths for an IMS
session using CS voice bearer established in 3G access with I1-ps before and
after handover to any 2G access where PS domain is not possible (e.g. non-DTM
cell at target access).
Figure 6.5.3.3.2-1: Handovers from 3G to 2G with I1-ps
Standard CS handover procedure, TS 23.009 [11], is used to relocate the CS
Access Signalling and the associated circuit voice bearer from the source 3G
access to target 2G access. Upon completion of the CS handover of the CS
Access Signalling and the associated circuit voice bearer to the target 2G
access, the UE sends a handover notification message using ICCP to establish
the I1-cs for the Session Control Signalling Path with the ICCF.
The I1-cs is used for session control signalling post handover to 2G access.
#### 6.5.3.4 Handovers of IMS sessions using CS voice bearer established in 2G
access with I1-ps to 2G/3G access
##### 6.5.3.4.1 PS Domain is available after HO to target access
Figure 6.5.3.4.1-1 below provides signalling and bearer paths for an IMS
session using CS voice bearer established via GPRS EDGE with DTM using I1-ps
before and after handover to any 2G/3G access where PS domain is available
(e.g. DTM or Multi-RAB).
Figure 6.5.3.4-1: Handovers from 2G to 2G/3G with I1-ps
Standard Rel‑07 DTM Handover procedures, TS 43.055 [12], defined for DTM/3G
handovers are used for handover of the Session Control Signalling Path and the
CS Access Signalling along with the associated circuit voice bearer to the
target access network.
The I1-ps is maintained upon handover to the target 2G access network.
##### 6.5.3.4.2 PS Domain is not available after HO to target access
Figure 6.5.3.4.2-1 below provides signalling and bearer paths for an IMS
session using CS voice bearer established via GPRS EDGE with DTM using I1-ps
before and after handover to any 2G/3G access.
Figure 6.5.3.4.2-1: Handovers from 2G to 2G/3G with I1-ps
Standard CS handover procedure, TS 23.009 [11] is used to relocate the CS
Access Signalling and the associated circuit voice bearer from the source GPRS
EDGE capable access of DTM to target 2G/3G access. Upon completion of the CS
handover of the CS Access Signalling and the associated circuit voice bearer
to the target 2G/3G access, the UE sends a handover notification message using
ICCP to establish the I1-cs for the Session Control Signalling Path with the
ICCF.
The I1-cs is used for session control signalling after handover from the GPRS
EDGE access capable of DTM to any 2G/3G access.
## 6.6 Architectural alternative: I1-cs Application Server approach
### 6.6.1 Signalling and bearer architecture for full duplex speech over CS
access
#### 6.6.1.1 Calls established using CS bearers
##### 6.6.1.1.1 Introduction
The Signalling/bearer paths for an IMS session established via CS access with
USSD transport of the I1-cs are described in figure below.
NOTE: gsmSCF used for redirection of CS calls and USSD processing is not shown
for brevity.
Figure 6.6.1.1.1-1: Signalling/Bearer Paths-USSD transport
USSD is used for transport of the I1-cs communicating the Session Control
Signalling via the VMSC to the CAAF. The CAAF performs necessary adaptation
when relaying the Session Control Signalling to RUA which presents SIP UA
behaviour on behalf of the UE toward IMS.
The UE establishes a Bearer Control Signalling path with the RUA by
establishing a CS call toward the RUA. In parallel, it establishes the I1-cs
through the Session Control Signalling Path with the CAAF and RUA using USSD.
The Bearer Control Signalling and Session Control Signalling stimuli are
combined at the RUA for presentation of SIP UA behaviour for establishment of
an IMS session.
The UE maintains the key elements of the SIP/SDP state machine and the RUA
also maintains a copy of the state data when present in the session path.
Use of the I1-cs for session setup for this model enables the capability to
provide all services exclusively by IMS.
### 6.6.2 Assignment of Session Transfer Identifier
The DTF assigns a Session Transfer Identifier on the VCC\'s Access Leg when it
receives an originating session request from the ICS UE or a session request
towards ICS UE while there is another ongoing session (or sessions) for that
IMPU, and transports it to the ICS UE (possibly through the ICCF when the UE
is using CS access). The STI assigned by the DTF shall be different from the
VDN/VDI. Similarly, if multiple UEs share the same IMPU, sessions initiated by
the second (and subsequent) UEs will be assigned STI.
When the UE initiates a session transfer request, it includes the received
Session Transfer Identifier and/or VDN/VDI (possibly through the ICCC to the
DTF), the DTF uses the Session Transfer Identifier to identify which session
will be transferred.
NOTE: If the UE did not receive the STI from the DTF then the domain session
transfer request does not contain an STI. In this case the VDN/VDI, as defined
in TS 23.206 [3], is used.
### 6.6.2a Registration
#### 6.6.2a.1 IMS Registration via CS access
##### 6.6.2a.1.1 Introduction
The following clauses provide alternative approaches for IMS registration, or
analogous procedures.
##### 6.6.2a.1.2 IMS Registration via CS access using ISC
##### 6.6.2a.1.2.1 Assumptions {#a.1.2.1-assumptions .H6}
\- ICCF is a home IMS node, hence considered a trusted node.
\- General assumptions related to roaming relationships apply for SS7
connectivity between the home IMS network and the visited CS network.
\- The CS subscription is issued by an operator trusted by the IMS operator.
\- The ICS user is authenticated with the home CS network via the visited CS
network.
\- The user is authenticated in CS prior to when the UE establishes the ICCC-
cs with the ICCF for registration in IMS. The user does not need to be re-
authenticated as part of IMS Registration because it has been authenticated by
the CS network.
\- It is assumed that the identities that the UE and network uses for CS
domain access using ICS are based on IMSI or derived from IMSI (for IMS). Note
that the IMSI is required for CS service.
\- It is assumed that the ISC interface is used for the IMS Registration
procedure with the ADS executed as part of the ICCF.
##### 6.6.2a.1.2.2 Example Information flow {#a.1.2.2-example-information-flow
.H6}
An example information flow for a user registering in IMS via the CS access is
provided in the figure below.
NOTE: This procedure only applies to the Trusted Registration performed by the
ICCF; as a pre-condition CS authentication is assumed.
Figure: ICS UE IMS Registration via CS Access
1\. After the UE has performed Location Update in the CS network, it may
request the RUA of the ICCF to perform the IMS registration as trusted
registration for the UE. To do so, the UE sends the content of SIP Register
encoded in ICCP, in a USSD message to the ICCF using IMSI as the identity.
Alternatively CAMEL mobility triggers may be used to inform the ICCF about the
CS attach of the ICS user.
2\. Upon receipt of the register information flow, the ICCF initiates a
Trusted Registration for the user by sending the Register to the I‑CSCF with
required information (e.g. Public User Identity derived from IMSI, ICCF IP
address as \"Contact\" address, etc). The Register message from the ICCF does
not include an Authorization header field or the header fields or header field
values as required by RFC3329. This is same as the registration procedures
used with early IMS security (TR 33.978).
3\. The I‑CSCF performs User Authorization Request /User Authorization Answer
with the HSS to authorise the Register request and locate the S-CSCF if
already assigned to the user or allocate an S-CSCF otherwise. Note that the
private identity is obtained from the IMSI (which is contained in the T-IMPU).
4\. The I‑CSCF forwards the Register to the S-CSCF.
5\. The S-CSCF identifies the Register as a Trusted Registration from the ICCF
which is a trusted Application Server (either based on a dedicated network
interface for the ICCF or based on a Security Association with the ICCF, such
as IPSec SA as in NDS/IP TS 33.210 [20]). The S-CSCF then checks the contact
address against a configured list of transport address/range associated with
the ICCF Application Servers. If there is a match, then, the S-CSCF skips any
further authentication procedures as it is assumed that the user has already
been authenticated in the CS domain prior to contacting the ICCF.
The S-CSCF performs the Server Assignment Request/Server Assignment Answer
with the HSS resulting in the user status as \"registered\" and the S-CSCF
name stored in the HSS, if initial registration, and download of the user
profile data (e.g. the registered and unregistered iFCs). The S-CSCF also
obtains the Implicitly Registered IMPUs from the HSS as part of the SAR/SAA.
The S-CSCF stores the user information as downloaded from the HSS. The S‑CSCF
stores the RUA\'s address/name, as supplied by the RUA for each of the
implicitly registered IMPUs. This represents the address/name that the home
network forwards the subsequent terminating session signalling to the ICS UE.
If the user is already in \"registered\" state for the same IMPU, but with a
different contact address (e.g. due to IMS registration using IP-CAN), then
the S-CSCF creates another record for the IMPU with the contact address with
the RUA\'s address for that IMPU.
If a Register request is received with an Authorization header anytime
during/afterwards, then, the S-CSCF behaves according to clause 5.4.1.2 of TS
24.229 [6].
6\. Service control execution at the S-CSCF is performed according to the
standard procedures.
7\. The S‑CSCF returns the 200 OK to the I‑CSCF.
8\. The I‑CSCF sends the 200 OK to the ICCF.
9\. The ICCF processes this information and relays via the CAAF, the result
back to the UE in a USSD message. The ICCF allocates a unique RUA DN that has
the properties that when received in a SIP INVITE from a MGCF in a future
session set-up is ,the ICCF can retrieve the necessary call information . This
RUA DN is included in the USSD back to the UE.
Editor\'s note: The relation between RUA DN, VDI/VDN and STI is FFS.
##### 6.6.2a.1.3 CS Registration Status Push and Pull over Cx and Sh
##### 6.6.2a.1.3.1 Proposal {#a.1.3.1-proposal .H6}
_A new procedure is proposed for subscriber registration in IMS when attaching
via the CS network. Using this procedure, the subscriber may be treated as
\"Registered\" for the purposes of service delivery even when only available
over CS access. This new registration procedure uses the knowledge of the
user\'s CS location data in the HSS to mark the subscriber as \"CS
Registered\" in the user\'s IMS subscription data, so that the CS Registration
status is made available to the S-CSCF on IMS Registration and/or ICS user
session establishment prior to IMS Registration to enable registered service
delivery for ICS user sessions. The CS Registration status is used at the
S-CSCF along with the IMS user status to evaluate filter criteria for the
invocation of the respective Application Servers._
_The HSS stores the location information for a user. When a UE attaches to the
CS network, the VLR sends a MAP Update Location message to the HSS to inform
the HSS of the registered VLR and MSC._
_When there is a change in a user\'s CS location data at the HSS, i.e. one of
the following events:_
\- A change from NIL‑VLR-Number to a registered VLR-Number.
\- A change from a registered VLR-Number to a NIL-VLR-Number (i.e. user roams
into a VLR area that s/he is not allowed to have access or the operator
manually cancels the CS registration for the user).
\- The VLR purges the user\'s record (i.e. the HSS receives a Purge-MS MAP
message and sets the MS-Purged flag. From the point of view of the HSS, the
user has no CS location).
_Then the HSS stores a new registration status called \"CS Registration
status\" in the user\'s IMS subscription data. The CS Registration status has
two possible states: \"R_ egistered\" or \"Not registered\".
The CS Registration status is always kept up to date in the HSS and pushed
down to the S-CSCF when possible:
\- In the case that the HSS has an S-CSCF name already stored (e.g. when the
user is IMS Registered) then the CS registration status change signalled from
the VMSC to the HSS (stored as CS Registration Status) is simply pushed to the
S-CSCF over the Cx interface.
\- In the case that the HSS does not have an S-CSCF name already stored, then
the CS Registration Status is held at the HSS in the IMS subscription until
one of the following events, where upon the CS Registration Status is pulled
from the HSS along with the Service Profile:
1\. Standard IMS SIP Registration.
2\. IMS Un-registration (i.e. terminating call to a not registered user that
has unregistered services configured).
3\. UE initiates a new session when in CS access when the user is not
currently registered in IMS.
The CS Registration Status may be provided in a new AVP or could be contained
in the service profile along with the modified filter criteria. The benefit of
a new AVP allows the change in CS Registration Status to be signalled without
the need to send the service profile again to the S-CSCF.
Application Servers can also be made aware that the ICS user is registered to
receive services over CS access. The Sh interface could be utilized to good
effect here. Without changes to the Sh interface, a new data reference can be
provided to allow the AS to query (Sh-Pull), or subscribe to be notified (Sh-
Subs-Notif) and be notified (Sh-Notify) if the user is registered or not
registered via CS access to receive IMS Centralized Services.
_The CS Registration status may also be used to configure a new set of iFCs,
\"CS Registered iFC\", specifically for the service execution when the ICS
user is registered only via the CS access. CS Registered iFC may be utilized
based on service provider policy. Alternatively, a new SPT may be configured
to filter on the CS Registration status._
_If a new condition is added inside SPT for CS registration status,
unregistered iFC\'s can be configured which check if CS registration is
registered/not-registered, and thus registered or unregistered state service
may be invoked as appropriate._
Editors Note: The possibility to use a new set of iFCs is FFS.
_Table 6.6.2a.1.3.1-1 indicates how triggering could be invoked if new type(s)
of iFC were specified._
Table 6.6.2a.1.3.1-1: Use of Registration via CS to influence the invocation
of iFC in the S-CSCF
* * *
IMS Registration Status _CS Registration Status_ iFC invoked in the S-CSCF Not
Registered Not Registered Unregistered iFC Registered Not Registered
Registered iFC Not Registered Registered CS Registered iFC or Registered iFC,
or Unregistered iFC (based on service provider policy) Registered Registered
Registered iFC
* * *
NOTE: If there are no data services in the network, then the Registered-iFC
and the CS-Registered -iFC may be the same.
Existing IMS SIP Deregistration procedures are not impacted by the
introduction of the CS Registration Status and iFC modifications. When the
user is IMS Registered and CS Registered and an IMS Deregistration occurs, the
S-CSCF may remove the user-profile from the S-CSCF as a result of the
deregistration. In this case, the S-CSCF is furnished with the CS Registration
Status on the next originating or terminating session.
##### 6.6.2a.1.3.2 Use cases {#a.1.3.2-use-cases .H6}
**Use Case 1: Standard IMS Registration followed by CS Registration**
Figure 6.6.2a.1.3.2-1: Use Case 1: Standard IMS Registration followed by CS
Registration
1\. The user is currently not IMS registered via CS access and is not
registered in IMS (no S-CSCF allocated).
2\. Standard IMS SIP Registration procedure occurs via an IP-CAN (involving
SIP-Register, Cx-Query + Cx-Select-Pull, Cx-AuthDataReq, 401 Unauthorized,
second SIP-Register, 3rd Party Register).
3\. On successful authentication, the S-CSCF sends a Cx-Put + Cx-Pull to the
HSS. This corresponds to the Server Assignment Request (SAR) command with a
Server Assignment Type (SAT) set to \"Registration\".
4\. The HSS responds with a Cx-Put Resp + Cx-Pull Resp containing the complete
user profile together with the CS Registration Status set to Not-Registered.
This corresponds to the Server Assignment Answer (SAA) command.
5\. Standard IMS SIP Registration completion via an IP-CAN
NOTE: Steps 2-5 illustrates the standard IMS SIP Registration procedure.
6\. ICS User roams from an area where s/he did not have CS access to an area
where CS access is allowed and performs a CS Attach.
7\. VLR sends an Update Location to the HSS
8\. The HSS updates the user\'s IMS data with the CS registration status of
Registered. As the user is already IMS registered (and has an S-CSCF name
stored), the CS registration status of Registered is \"pushed\" to the S-CSCF
using a Cx-Update_Subscr_Data request to inform the S-CSCF that the user is
available for services over CS access. This corresponds to a Push Profile
Request (PPR) command. The S-CSCF responds with a Cx-Update_Subcr_Data Resp.
This corresponds to the Push Profile Answer (PPA) command.
9\. Assuming that an AS (e.g. TAS, ICCF, VCC AS) has previously subscribed to
be notified of any changes in the CS-Registration-Status, the HSS sends a Sh-
Notif request to the AS together with the CS-Registration-Status. This
corresponds to the Push Notification Request (PNR) command. The AS responds
with a Sh-Notif Resp. This corresponds to the Push Notification Answer (PNA)
command.
**Use Case 2: CS Registration followed by Standard IMS Registration**
Figure 6.6.2a.1.3.2-2: Use Case 2: CS Registration followed by Standard IMS
Registration
1\. The user is currently not IMS registered via CS access and is not
registered in IMS (no S-CSCF is allocated).
2\. ICS User roams from an area where s/he did not have CS access to an area
where CS access is allowed and performs a CS Attach.
3\. VLR sends an Update Location to the HSS.
4\. As the user is not IMS registered (i.e. no S-CSCF name is stored), the HSS
stores the current CS Registration Status (i.e. Registered) in the user\'s IMS
data.
5\. Standard IMS SIP Registration procedure occurs via an IP-CAN (involving
SIP-Register, Cx-Query + Cx-Select-Pull, Cx-AuthDataReq, 401 Unauthorized,
second SIP-Register, 3rd Party Register).
6\. On successful authentication, the S-CSCF sends a Cx-Put + Cx-Pull to the
HSS. This corresponds to the Server Assignment Request (SAR) command with a
Server Assignment Type (SAT) set to \"Registration\".
7\. Assuming that an AS (e.g. TAS, ICCF, VCC AS) has previously subscribed to
be notified of any changes in the CS-Registration-Status, the HSS sends a Sh-
Notif request to the AS together with the CS-Registration-Status. This
corresponds to the Push Notification Request (PNR) command. The AS responds
with a Sh-Notif Resp. This corresponds to the Push Notification Answer (PNA)
command.
8\. The HSS responds with a Cx-Put Resp + Cx-Pull Resp containing the complete
user profile together with the CS Registration Status set to Registered. This
corresponds to the Server Assignment Answer (SAA) command.
9\. Standard IMS SIP Registration completion via an IP-CAN.
NOTE: Steps 5-9 illustrate the standard IMS SIP Registration procedure with
notification to AS occurring in step 7.
**Use Case 3: CS Registration followed by CS-Origination**
Figure 6.6.2a.1.3.2-3: Use Case 3: CS Registration followed by CS-Origination
Steps 1 to 4: Same as in Use Case 2.
Steps 5 to 13: CS Origination procedures for an ICS UE. This particular
example is showing I1-cs as documented in figure 6.6.2.1.1-1, steps 1 to 9.
NOTE: The I-CSCF locates the S-CSCF by sending a Cx-Location-Query to the HSS
and the HSS responds with the experimental result code of \"Diameter
Unregistered Service\". For brevity, this is not shown in the diagram above.
14\. The I-CSCF contacts the S-CSCF. The S-CSCF sends a Cx-Put + Cx-Pull to
the HSS for the unregistered user. This corresponds to the Server Assignment
Request (SAR) command with a Server Assignment Type (SAT) set to
\"Unregistered User\".
15\. The HSS responds with a Cx-Put Resp + Cx-Pull Resp containing the
complete user profile together with the CS Registration Status set to
Registered. This corresponds to the Server Assignment Answer (SAA) command.
16\. Assuming that an AS (e.g. ICCF, VCC AS, TAS) has previously subscribed to
be notified of any changes in the CS-Registration-Status, the HSS sends a Sh-
Notif request to the AS together with the CS-Registration-Status. This
corresponds to the Push Notification Request (PNR) command. The AS responds
with a Sh-Notif Resp. This corresponds to the Push Notification Answer (PNA)
command.
17\. The S-CSCF invokes the most appropriate iFC as the user is registered via
CS access, but not registered in IMS.
18\. After triggering and service execution, the S-CSCF sends the INVITE to
the remote end.
**Use Case 4: CS Registration followed by CS-Termination**
Figure 6.6.2a.1.3.2-4: Use Case 4: CS Registration followed by CS-Termination
Steps 1 to 4: Same as in Use Case 2
5\. Invite sent in from the Far End to I-CSCF.
NOTE: The I-CSCF locates the S-CSCF by sending a Cx-Location-Query to the HSS
and the HSS responds with the experimental result code of \"Diameter
Unregistered Service\". For brevity, this is not shown in the figure above.
6\. I-CSCF contacts the S-CSCF. S-CSCF sends in an SAR to the HSS with SAT set
to \"Unregistered User\".
7\. Assuming that an AS (e.g. ICCF, VCC AS, TAS) has previously subscribed to
be notified of any changes in the CS-Registration-Status, the HSS sends a Sh-
Notif request to the AS together with the CS-Registration-Status. This
corresponds to the Push Notification Request (PNR) command. The AS responds
with a Sh-Notif Resp. This corresponds to the Push Notification Answer (PNA)
command.
8\. HSS downloads the complete profile in the SAA together with the CS
Registration Status set to \"IMS-Registered-via-CS-access\".
9\. The S-CSCF invokes the most appropriate filter criteria as the user is CS
registered but IMS not registered. Termination procedures continue.
**Use Case 5: CS Deregistration**
Figure 6.6.2a.1.3.2-5: Use Case 5: CS Deregistration
1\. User is currently registered in IMS and is registered in IMS via CS
access. The S-CSCF contains these registration statuses and the complete user
profile.
2\. The ICS User roams into a new VLR area and does a CS attach.
3\. The VLR sends an Update Location to the HSS.
4\. The user\'s roaming entitlement in the HSS does not allow the user to roam
the current VLR area. The HSS sends back a \"Roaming Not Allowed\" response.
5\. CS access is barred for the user in the current VLR area.
6\. The HSS updates the user\'s IMS data with the CS Registration Status of
\"Not Registered\". As the HSS has an S-CSCF name stored for the user, the HSS
sends a Cx-Update_Subscr_Data request to the S-CSCF with the CS Registration
Status set to \"Not Registered\". This corresponds to a Push Profile Request
(PPR) command. The S-CSCF responds with a Cx-Update_Subcr_Data Resp. This
corresponds to the Push Profile Answer (PPA) command.
7\. The S-CSCF marks the user CS Registration Status as \"Not Registered\".
8\. Assuming that an AS (e.g. TAS, ICCF, VCC AS) has previously subscribed to
be notified of any changes in the CS-Registration-Status, the HSS sends a Sh-
Notif request to the AS together with the CS-Registration-Status. This
corresponds to the Push Notification Request (PNR) command. The AS responds
with a Sh-Notif Resp. This corresponds to the Push Notification Answer (PNA)
command.
9\. Invite sent in from the Far End to I-CSCF. I-CSCF sends in a Location
Information Retrieval (LIR) request to the HSS and the HSS returns \"Diameter
Success\". I-CSCF contacts S-CSCF.
10\. S-CSCF invokes terminating registered filter criteria as the user is
still registered in IMS. Terminating procedures continue.
##### 6.6.2a.1.4 RUA Registration in IMS when attached to CS access
See clause 6.7.1a.1.
For I1-cs Application Server model, ICCF is included in terminating iFC and
would be invoked via iFC. The ICCF is the last AS and collocates with DSF. It
is invoked via the filter criteria and is always involved whether ICS UE is in
CS access or in PS access. There are also two cases here:
\- If CS access is selected, the INVITE message is routed to CS access (either
via DSF fetching CSRN or using ICCP).
\- If PS access is selected, DSF indicates sufficient information in the
INVITE message only to select PS contact in the S-CSCF.
### 6.6.2b Video call
ICS video call handling principles:
1 Solutions of multimedia inter-working from TS 29.163 [18], version 7.6.0,
for fallback and service change are applicable with ICS video call.
2 In case of the ICS UE originating Non-SCUDIF service change, the mechanism
Re-dial with release of the radio connection (TR 23.801, TS 24.008) to setup a
new CS bearer supporting the new media type is needed.
3 Sharing one CS bearer between voice session and video session are not
supported in this stage.
4 If there are two or more sessions sharing one CS bearer, Whether to support
service change (e.g. from video to speech) for one of the sessions is FFS.
#### 6.6.2b.1 Fallback to speech at session establishment
If Fallback occurs on the CS side, normal SDP offer/answer procedure is
performed in the IMS side. There is no new requirement to ICS architect and
already be supported by current architect.
#### 6.6.2b.2 Service change with SCUDIF
##### 6.6.2b.2.1 IM CN subsystem originated change
If IM CN subsystem originated SCUDIF service change, normal media re-
negotiation procedure is performed in the IMS side. There is no new
requirement to ICS architect and already be supported by current architect.
##### 6.6.2b.2.2 CS network originated change
If IM CN subsystem originated SCUDIF service change, normal media re-
negotiation is performed in the IMS side. There is no new requirement to ICS
architect and already be supported by current architect.
#### 6.6.2b.3 Non-SCUDIF case (ISUP or BICC without SCUDIF)
If IM CN subsystem originated Non-SCUDIF service change, normal media re-
negotiation is performed in the IMS side. There is no new requirement to ICS
architect and already be supported by current architect.
In TS 29.163 [18], when service change is initiated by the CS network or CS
UE, Re-dial mechanism with release of the CS connection is recommended
solution for switching between Circuit Switched voice and video services when
SCUDIF is not supported by the CS network.
Under ICS architecture, a more effective and user friendly method is provided
for switching between voice and video services when SCUDIF feature is not
supported.
Figure 6.6.2b.3-1 shows an ICS UE originates Non-SCUDIF service change from
speech to video during an ongoing session.
Figure _6.6.2b.3-1_ : ICS UE originates Non-SCUDIF service change from speech
to video during an ongoing session
1\. UE‑A and UE‑B perform speech talking. After verbal agreement, UE‑A sends a
video call invitation to the ICCF.
2\. UE‑A disconnects the existing CS call leg with the ICCF. According to
clause 6.11 Media Handling, the ICCF can utilize MRFC/MRFP to be sure that the
RTCP packets would be sent continuously as \"remote end-point aliveness
information\" to UE‑B.
3\. UE‑A setups a new CS call leg supporting video call with the ICCF and the
ICCF receives an INVITE with MGW SDP from the MGCF including video media
invitation.
4\. The ICCF sends a Re-INVITE/UPDATE with MGW SDP including video media
invitation to UE‑B. UE‑B feeds back 200 OK with video media information to
accept the invitation.
Then UE‑A and UE‑B perform video talking.
#### 6.6.2b.4 Normal video call flow
##### 6.6.2b.4.1 Origination
##### 6.6.2b.4.1.1 Origination Calls established using CS multimedia bearers
{#b.4.1.1-origination-calls-established-using-cs-multimedia-bearers .H6}
Figure 6.6.2b.4.1.1-1 provides an example call flow for a video call made by
an ICS UE‑A to the other end B with I1-cs for call control, the AS approach
for RUA implementation. The H.245 negotiation procedures take place after the
CS call being established. Note that other origination approaches (e.g. I1-ps,
CAMEL) are applicable.
{width="6.689583333333333in" height="5.126388888888889in"}
Figure 6.6.2b.4.1.1-1: ICS UE video call origination: USSD transport--AS
Approach--I1-cs for call control
1\. ICS UE‑A sends a SETUP message to VMSC to establish the CS multimedia
bearer leg. The SETUP message includes the RUA PSI DN as the called party
number. This will establish the CS domain multimedia bearer path with the
ICCF.
2\. The VMSC responds with a call proceeding message and begins to setup the
CS multimedia bearer path.
3\. The VMSC processes the SETUP message and sends an IAM to the MGCF. The IAM
message contains the RUA PSI DN.
NOTE 1: Standard VMSC procedure for CS origination.
4\. The MGCF performs a setup of the MGW and creates an INVITE that is sent to
the S-CSCF that serves the ICCF. This may involve sending the INVITE to the
I-CSCF first to locate the S-CSCF and to translate the RUA PSI DN to a SIP-
URI.
NOTE 2: Standard MGCF procedure for PSTN origination.
5\. The S-CSCF forwards the INVITE to RUA of ICCF. When the RUA has received
both the USSD message (steps 6-8) and the INVITE, it has sufficient
information to setup a session with party B.
6\. ICS UE‑A encodes in ICCP sufficient information (e.g. containing B party
address (SIP or Tel URI) for the RUA of the ICCF to generate a SIP INVITE
initiating a session toward the other end B, to be sent in a USSD message, and
sends it toward the CAAF of the ICCF via the VMSC. The USSD message has
sufficient information needed at the ICCF to correlate the session request
with the multimedia bearer path established with the RUA in steps 1-5.
Editor\'s note: Whether SIP Invite is compressed as such to fit to USSD, or
similar information is otherwise carried on top of USSD is for further study.
7\. Standard VMSC procedure to communicate the USSD message to the Home
network.
8\. Standard HSS procedure to communicate the USSD message to the associated
service node.
Step 6 - 8 occurs in parallel to steps 2 - 5. The UE may also invoke some
supplementary service from home IMS like temporary OIR.
NOTE 3: Signalling Optimizations may be achieved by combining the two step
procedure for setting up of Session Control Signalling Path and the Bearer
Control Signalling session in one step or by omitting the Session Control
Signalling set-up for basic calls when no service needs to be invoked.
9 CAAF of ICCF performs necessary adaptation and relays information needed for
generation of the SIP INVITE at the RUA of ICCF. The RUA of ICCF acting as a
B2BUA creates a SIP INVITE with appropriate SDP information and sends it to
the S-CSCF (i.e., terminating the UE Leg and originating the RUA Leg for
presentation of IMS session toward other end B on behalf of UE‑A).
10 The S-CSCF routes the INVITE to the correct termination for the party B
based on standard IMS originated session processing at the S-CSCF.
NOTE 4: VCC and Originating Supplementary services (e.g. OCB, OIR), if any,
are executed on the RUA Leg in the Application Servers in home IMS. These are
not shown in the figure.
11\~16. The UE‑B answers the call and the multimedia BC (bearer capability) is
established.
17\. H.245 negotiation procedures are performed between the MGCF and ICS UE‑A.
Then the CS multimedia bearer is established.
##### 6.6.2b.4.2 Termination
##### 6.6.2b.4.2.1 Termination Calls established using CS multimedia bearers
{#b.4.2.1-termination-calls-established-using-cs-multimedia-bearers .H6}
The figure 6.6.2b.4.2.1-1 provides an example call flow for a video call
destined to ICS UE‑B with I1-cs for call control, the AS approach for RUA
implementation. The H.245 negotiation procedures take place after the CS call
being established. Note that other termination approaches (e.g. Using CS
Origination procedures) are applicable.
Figure 6.6.2b.4.2.1-1: ICS UE termination using CS multimedia bearers with use
of I1-cs
1\. An incoming SIP INVITE is received at the S-CSCF of the B party.
2\. The S-CSCF forwards the INVITE to the ICCF.
3\. The ICCF performs Access Domain Selection, and then fetches a number such
as MSRN if a media connection is not already established to UE‑B.
Editor\'s note: The type of number to be used and how the number is allocated
is FFS. The Relationship and interworking with DSFVCC is FFS.
4\. ICCF initiates an ICS Incoming Call Request to the HSS.
Editor\'s note: Whether Sh is used instead of MAP is FFS.
5\. The HSS sends an USSD message to the VMSC.
6\. The UE‑B receives the USSD including the calling party ID.
7\. The ICCF sends an INVITE (tel URI = MSRN) to the S-CSCF.
8\. The Request URI has been modified, the S-CSCF skips further service
execution and routes the call towards the CS domain.
9\. The MGCF sends an IAM to the VMSC.
10\. VMSC sends SETUP to UE‑B.
11\. UE‑B responds with a CONNECT message.
12\. VMSC responds with ANM towards the IMS.
13\. H.245 negotiation procedures are performed between the MGCF and UE‑B.
Then the CS multimedia bearer is established.
14\. MGCF sends the 200 OK to the S-CSCF.
15\. S-CSCF forwards the 200 OK to the ICCF.
16\. The ICCF sends a 200 OK as response to the INVITE in step 2 towards the
S-CSCF.
17\. S-CSCF forwards the 200 OK towards the A party.
#### 6.6.2b.5 Session continuity
### 6.6.3 Information flows
#### 6.6.3.1 I1-cs unregistered user solution
##### 6.6.3.1.1 Origination
##### 6.6.3.1.1.1 Use of USSD over I1 reference point for Call Origination
{#use-of-ussd-over-i1-reference-point-for-call-origination .H6}
Figure 6.6.3.1.1.1-1 provides an example flow for a call made by an ICS UE‑A
to the other end B with USSD transport of ICCC, the AS approach for RUA
implementation when I1 reference point is used for call setup.
Figure 6.6.3.1.1.1-1: ICS UE origination: USSD transport--AS Approach--I1
reference point for call control
1\. ICS UE‑A sends a SETUP message to VMSC to establish the bearer leg. The
SETUP message includes the RUA PSI DN as the called party number. This will
establish the CS domain bearer path with the ICCF.
2\. The VMSC responds with a call proceeding message and begins to setup the
bearer path.
3\. The VMSC processes the SETUP message and sends an IAM to the MGCF. The
SETUP message contains the RUA PSI DN.
NOTE 1: Standard VMSC procedure for CS origination.
4\. The MGCF performs a setup of the MGW and creates an INVITE that is sent to
the S-CSCF that serves the ICCF. This may involve sending the INVITE to the
I-CSCF first to located the S-CSCF and to translate the RUA PSI DN to a SIP-
URI.
NOTE 2: Standard MGCF procedure for PSTN origination.
5\. The S-CSCF forwards the INVITE to RUA of ICCF. When the RUA has received
both the USSD message (steps 6-8) and the INVITE, it has sufficient
information to setup a session with party B.
6\. ICS UE‑A encodes in ICCP sufficient information (e.g. containing B party
address (SIP or Tel URI) for the RUA of the ICCF to generate a SIP INVITE
initiating a session toward the other end B, to be sent in a USSD message, and
sends it toward the CAAF of the ICCF via the VMSC. The USSD message has
sufficient information needed at the ICCF to correlate the session request
with the bearer path established with the RUA in steps 1 \- 5.
Editor\'s note: Whether SIP Invite is compressed as such to fit to USSD, or
similar information is otherwise carried on top of USSD is for further study.
7\. Standard VMSC procedure to communicate the USSD message to the Home
network.
8\. Standard HSS procedure to communicate the USSD message to the associated
service node.
Steps 6 - 8 occurs in parallel to Steps 2 - 5. The UE may also invoke some
supplementary service from home IMS like temporary OIR.
NOTE 3: Signalling Optimizations may be achieved by combining the two step
procedure for setting up of Session Control Signalling Path and the Bearer
Control Signalling session in one step or by omitting the Session Control
Signalling set-up for basic calls when no service needs to be invoked.
9\. CAAF of ICCF performs necessary adaptation and relays information needed
for generation of the SIP INVITE at the RUA of ICCF. The RUA of ICCF acting as
a B2BUA creates a SIP INVITE with appropriate SDP information and sends it to
the S-CSCF (i.e., terminating the UE Leg and originating the RUA Leg for
presentation of IMS session toward other end B on behalf of UE‑A).
10\. The S-CSCF routes the INVITE to the correct termination for the party B
based on standard IMS originated session processing at the S-CSCF.
NOTE 4: VCC and Originating Supplementary services (e.g. OCB, OIR), if any,
are executed on the RUA Leg in the Application Servers in home IMS. These are
not shown in the figure.
##### 6.6.3.1.1.2 Use of USSD over I1 reference point for Call Origination --
alternative procedure1 {#use-of-ussd-over-i1-reference-point-for-call-
origination-alternative-procedure1 .H6}
The figure 6.6.3.1.1.2-1 provides an example flow for a call made by an ICS
UE‑A to the other end B with USSD transport of ICCC, the AS approach for RUA
implementation when I1 reference point is used for call setup.
{width="6.653472222222222in" height="5.001388888888889in"}
Figure 6.6.3.1.1.2-1: ICS UE origination: USSD transport--AS Approach--I1
reference point for call control alternative procedure
1\. The ICS UE initiates a call by sending an ICS Call Initiation Request
inside a USSD dialog to the HSS containing B party address (SIP or Tel URI).
2\. The USSD application within the HSS forwards the USSD Request to the ICCF
instance addressed in the HSS. The ICCF shall store the received B Party
Address\'s against an IMRN.
3\. The ICCF allocates a roaming number if a media connection is not already
established to the ICS UE. The ICCF returns the IMRN in an ICS Response within
the USSD dialog. The USSD response is returned all the way to the ICS UE.
4\. The ICS UE uses the IMRN to establish a normal CS call set up to the ICCF
via MGCF. PSI routing is used to route the call from MGCF to ICCF.
5\. Following that, ICCF initiates the call towards UE‑B by sending a SIP
INVITE to the S-CSCF.
6\. ICCF receives SIP 180 ringing.
7\. ICCF receives SIP 200 OK.
8\. ICCF send an ICS Call initiation response to the ICS UE that includes the
connected status.
9\. ICCF sends an ACK to the UE‑B and the media is now established end to end.
##### 6.6.3.1.1.3 Use of USSD over I1 reference point for Call Origination --
alternative procedure 2 {#use-of-ussd-over-i1-reference-point-for-call-
origination-alternative-procedure-2 .H6}
Figure 6.6.3.1.1.3-1 provides an example flow for a call made by an ICS UE‑A
to the other end B with USSD transport of ICCC, the AS approach for RUA
implementation when I1 reference point is used for call setup.
Figure 6.6.3.1.1.3-1: ICS UE origination: USSD transport--AS Approach--I1
reference point for call control -- alternative procedure 2
1\. ICS UE‑A sends a SETUP message to VMSC to establish the bearer leg. The
SETUP message includes the RUA DNa that was received in a previous USSD (step
8c -- RUA DNb) as the called party number. This will establish the CS domain
bearer path with the ICCF.
2\. The VMSC responds with a call proceeding message and begins to setup the
bearer path.
3\. The VMSC processes the SETUP message and sends an IAM to the MGCF. The
SETUP message contains the RUA PSI DN.
NOTE 1: Standard VMSC procedure for CS origination.
4\. The MGCF performs a setup of the MGW and creates an INVITE that is sent to
the S-CSCF that serves the ICCF. This may involve sending the INVITE to the
I-CSCF first to located the S-CSCF and to translate the RUA PSI DN to a SIP-
URI.
NOTE 2: Standard MGCF procedure for PSTN origination.
5\. The S-CSCF forwards the INVITE to RUA of ICCF. When the RUA has received
both the USSD message (steps 6-8) and the INVITE, it has sufficient
information to setup a session with party B.
6\. ICS UE‑A encodes in ICCP sufficient information (e.g. containing B party
address (SIP or Tel URI), RUA DNa for the RUA of the ICCF to generate a SIP
INVITE initiating a session toward the other end B, to be sent in a USSD
message, and sends it toward the CAAF of the ICCF via the VMSC. The USSD
message has sufficient information needed at the ICCF to correlate the session
request with the bearer path established with the RUA in steps 1 - 5.
Editor\'s note: Whether SIP Invite is compressed as such to fit to USSD, or
similar information is otherwise carried on top of USSD is for further study.
7\. Standard VMSC procedure to communicate the USSD message to the Home
network.
8\. Standard HSS procedure to communicate the USSD message to the associated
service node.
8a-8c. Upon receipt of the USSD from UE‑A, the ICCF allocates a unique RUA DNb
that has the properties that when received in a future session set-up (step 5)
the ICCF can retrieve the necessary call information from the initial SIP
INVITE received to initiate a session (step 2). The RUA DNb is sent back to
ICS UE‑A in USSD.
Steps 6 - 8 occurs in parallel to Steps 2 - 5. The UE may also invoke some
supplementary service from home IMS like temporary OIR.
NOTE 3: Signalling Optimizations may be achieved by combining the two step
procedure for setting up of Session Control Signalling Path and the Bearer
Control Signalling session in one step or by omitting the Session Control
Signalling set-up for basic calls when no service needs to be invoked.
9\. CAAF of ICCF performs necessary adaptation and relays information needed
for generation of the SIP INVITE at the RUA of ICCF. The RUA of ICCF acting as
a B2BUA creates a SIP INVITE with appropriate SDP information and sends it to
the S-CSCF (i.e., terminating the UE Leg and originating the RUA Leg for
presentation of IMS session toward other end B on behalf of UE‑A).
10\. The S-CSCF routes the INVITE to the correct termination for the party B
based on standard IMS originated session processing at the S-CSCF.
NOTE 4: VCC and Originating Supplementary services (e.g. OCB, OIR), if any,
are executed on the RUA Leg in the Application Servers in home IMS. These are
not shown in the figure.
##### 6.6.3.1.2 Termination
##### 6.6.3.1.2.1 Introduction {#introduction-4 .H6}
Example information flows for session terminations using different models for
the signalling/bearer architecture for full-duplex speech service with IMS
centralized services over CS access are discussed in the following.
##### 6.6.3.1.2.2 Calls established using CS bearers with use of I1-cs
{#calls-established-using-cs-bearers-with-use-of-i1-cs .H6}
The figure 6.6.3.1.2.2-1 provides an example flow for a call destined to an
ICS UE when the USSD transport alternative for ICCC is used to support the
setup of terminating sessions.
{width="6.690277777777778in" height="4.011111111111111in"}
Figure 6.6.2.2.2-1: ICS UE termination using CS bearers with use of I1-cs
1 An incoming SIP INVITE is received at the S-CSCF of the B party.
2 The S-CSCF forwards the INVITE to the ICCF.
3 The ICCF performs Access Domain Selection, and then fetches a number such as
MSRN if a media connection is not already established to UE‑B.
Editor\'s note 1: The type of number to be used and how the number is
allocated is FFS. The Relationship and interworking with DSFVCC is FFS.
4 ICCF initiates an ICS Incoming Call Request to the HSS.
Editor\'s note 2: Whether Sh is used instead of MAP is FFS.
5 The HSS sends an USSD message to the VMSC.
6 The UE‑B receives the USSD including the calling party ID.
7 The ICCF sends an INVITE (tel URI = MSRN) to the S-CSCF.
8 The Request URI has been modified, the S-CSCF skips further service
execution and routes the call towards the CS domain.
9 The MGCF sends an IAM to the VMSC.
10 VMSC sends SETUP to UE‑B.
11 UE‑B responds with a CONNECT message.
12 VMSC responds with ANM towards the IMS.
13 MGCF sends the 200 OK to the S-CSCF.
14 S-CSCF forwards the 200 OK to the ICCF.
15 The ICCF sends a 200 OK as response to the INVITE in step 2 towards the
S-CSCF.
16 S-CSCF forwards the 200 OK towards the A party.
##### 6.6.3.1.2.2.1 Using CS Origination procedures to set up the Bearer
Control Signalling session {#using-cs-origination-procedures-to-set-up-the-
bearer-control-signalling-session-1 .H6}
The figure 6.6.3.1.2.2.1-1 provides an example flow for a call destined to an
ICS UE when the USSD transport alternative for ICCC is used to support the
setup of terminating sessions using CS Origination procedures for setting up
the Bearer Control Signalling session.
NOTE: The un-bolded steps are related to the Session Control Signalling set-up
procedures. The bolded steps are related to the Bearer Control Signalling
session set-up procedures.
Figure 6.6.3.1.2.2.1-1: ICS UE termination using CS bearers using CS
Origination procedures with use of I1-cs
1\. An incoming SIP INVITE is received at the S-CSCF of the B party with an
Offer containing SDP from the A-party.
2\. The S-CSCF forwards the INVITE to the ICCF.
3\. The ICCF performs access selection and chooses the CS domain.
4\. The ICCF (acting as a B2BUA) establishes a session over I1-cs by sending
an Incoming Call Request (in a USSD message) to the HSS. The request contains
a SIP or Tel URI of the A and B parties (B subject to privacy), GRUU
information and any other necessary information to complete the call.
Additionally, an E.164 number is sent in the outbound USSD which is then used
by the ICCF later on to correlate the incoming call.
5\. The HSS sends an USSD message to the VMSC.
6\. UE‑B receives the USSD message from the VMSC after paging for USSD as
necessary.
7\. UE‑B sends a SETUP message to the VMSC to establish the Bearer Control
Signalling session. The SETUP message includes the RUA PSI DN as the called
party number. This will establish the circuit voice bearer between the UE and
IMS.
8\. The VMSC responds with a call proceeding message and begins to set up the
Bearer Control Signalling session.
9\. The VMSC processes the SETUP message and sends an IAM to the MGCF. The
SETUP message contains the RUA PSI DN. [NOTE: Standard VMSC procedures for CS
origination]
10\. The MGCF performs a setup of the MGW and creates an INVITE with an Offer
containing the SDP from the MGW. The INVITE is sent via the I/S-CSCF to the
ICCF. [NOTE: Standard MGCF procedure for PSTN origination]
11\. The I/S-CSCF forwards the INVITE to RUA of ICCF.
12\. The ICCF sends an UPDATE to the S-CSCF with an Answer to the Offer from
the A-party, containing the SDP from the MGW.
13\. The S-CSCF forwards the UPDATE to the A-party.
14\. The S-CSCF receives a 200 OK to the UPDATE.
15\. The S-CSCF forwards the 200 OK to the ICCF.
16\. The ICCF sends a 183 Session Progress to S-CSCF with an Answer to the
Offer from the MGW, containing the SDP from the A-party.
17\. The S-CSCF sends the 183 Session Progress to the MGCF.
18\. The MGCF creates an ACM and sends it to the VMSC.
19\. Alerting is send from the VMSC to UE‑B.
20\. The ICCF sends a 200 OK to S-CSCF in response to the INVITE in Step 12.
21\. The S-CSCF forwards the 200 OK to the MGCF.
22\. The MGCF creates an ANM and sends it to the VMSC.
23\. The VMSC sends a Connect to UE‑B. The set up of the bearer is complete.
24\. User Alerting at UE‑B; UE‑B sends Ringing in a USSD message to the VMSC.
25\. The VMSC forwards the USSD (Ringing) to the HSS.
26\. The HSS forwards the USSD (Ringing) to the CAAF of the ICCF.
27\. The CAAF of the ICCF performs the necessary adaptation and relays the
information needed for generation of the SIP message at the RUA of the ICCF.
The RUA of the ICCF acting as a B2BUA creates a 180 Ringing and sends it to
the S-CSCF for communicating with UE‑A.
28\. The S-CSCF forwards the 180 Ringing to UE‑A.
29\. User Answer at UE‑B; UE‑B sends Answer in a USSD message to the VMSC.
30\. The VMSC forwards the USSD (Answer) to the HSS.
31\. The HSS forwards the USSD (Answer) to the CAAF of the ICCF.
32\. The CAAF of the ICCF performs the necessary adaptation and relays the
information needed for generation of the SIP message at the RUA of the ICCF.
The RUA of the ICCF acting as a B2BUA creates a 200 OK and sends it to the
S-CSCF for communicating with UE‑A.
33\. The S-CSCF forwards the 200 OK to UE‑A.
NOTE: Steps 20-23 above related to the Bearer Control Session set-up
procedures may alternatively be sent after the 200 OK has been sent from the
ICCF towards UE‑A.
##### 6.6.3.1.2.3 Calls established using CS bearers without use of ICCC
{#calls-established-using-cs-bearers-without-use-of-iccc .H6}
The figure 6.6.3.1.2.3-1 provides an example for setup of terminating sessions
towards a legacy UE or if ICCC is not required, e.g. for provisioning the
caller ID.
{width="6.690277777777778in" height="3.5520833333333335in"}
Figure 6.6.3.1.2.3-1: ICS UE termination using CS bearers without use of ICCC
1 An incoming SIP INVITE is received at the S-CSCF of the B party.
2 The S-CSCF forwards the INVITE to the ICCF.
3 The ICCF performs Access Domain Selection, and then fetches a number such as
MSRN if a media connection is not already established to UE‑B.
Editor\'s note: The type of number to be used and how the number is allocated
is FFS.
4 The ICCF sends an INVITE (tel URI = MSRN) to the S-CSCF.
5 The Request URI has been modified, the S-CSCF skips further service
execution and routes the call towards the CS domain.
6 The MGCF sends an IAM to the VMSC.
7 VMSC sends SETUP to UE‑B.
8 UE‑B responds with a CONNECT message.
9 VMSC responds with ANM towards the IMS.
10 MGCF sends the 200 OK to the S-CSCF.
11 S-CSCF forwards the 200 OK to the ICCF.
12 The ICCF sends a 200 OK as response to the INVITE in step 2 towards the
S-CSCF.
13 S-CSCF forwards the 200 OK towards the A party.
##### 6.6.3.1.3 Mid-call services
NOTE: The same call flows apply to the IMS adaptor model (see clause 6.7.2.3).
##### 6.6.3.1.3.1 Calls established using CS bearers with use of USSD
transport for I1-cs, AS approach for RUA {#calls-established-using-cs-bearers-
with-use-of-ussd-transport-for-i1-cs-as-approach-for-rua .H6}
Figure 6.6.3.1.3.1-1 provides an example flow for a call made by an ICS UE‑A
to the other end C after holding the other end B.
{width="6.6506944444444445in" height="4.248611111111111in"}
Figure 6.6.3.1.3.1-1: ICS UE mid-call service-A holds B, calls C: USSD
transport, AS approach for RUA
1 ICS UE‑A to place the call with the other end B on hold. The ICS UE‑A
encodes in ICCP sufficient information for the RUA of the ICCF to generate a
SIP message to hold the media and sends it in a USSD message to the CAAF of
the ICCF.
2 Standard VMSC procedure to communicate the USSD message to the Home network.
3 Standard HSS procedure to communicate the USSD message to the associated
service node.
4 The CAAF of ICCF terminates the USSD message and communicates it to the RUA
of the ICCF. The RUA of the ICCF generates a SIP message to party B to put the
media on HOLD.
5 Standard CSCF procedure toward the other end B.
6 ICS UE‑A sets up a call toward the other end C by sending a USSD message to
the CAAF of the ICCF.
7 Standard VMSC procedure to communicate the USSD message to the Home network.
8 Standard HSS procedure to communicate the USSD message to the associated
service node.
9 The CAAF of the ICCF terminates the USSD message; and communicates it to the
RUA of the ICCF. The RUA of the ICCF generates a SIP Invite to initiate an IMS
session toward the other end C.
10 Standard CSCF procedure toward the other end C.
Editor\'s Note: The interaction between ICCF/MGCF/MGW in order to connect
party A and C is FFS.
##### 6.6.3.1.3.2 Explicit Call Transfer service {#explicit-call-transfer-
service .H6}
##### 6.6.3.1.3.2.1 ICS UE being a transferor {#ics-ue-being-a-transferor .H6}
Some messages are omitted for brevity.
Figure 6.6.3.1.3.2.1-1 provides an example flow for ICS UE‑A transferring the
session to 3^rd^ party.
Figure 6.6.3.1.3.2.1-1: ICS UE‑A being a transferor transfers the session to
3^rd^ party
1\. UE‑A have two sessions, the session with 3rd party is on hold，the session
with 2nd party is active. UE‑A initiates ECT service and sends REFER request
with address of 3rd Party to ICCF using ICCP protocol;
2\. ICCF sends SIP Refer message to S-CSCF;
3\. S-CSCF sends SIP Refer message to TAS.
4\. TAS sends SIP Refer message to S-CSCF;
5\. S-CSCF sends SIP Refer message to 2nd party.
6\. 2nd party sends SIP 202 Accept to S-CSCF;
7\. S-CSCF forwards SIP 202 Accept towards the TAS.
8\. TAS sends SIP 202 Accept to S-CSCF;
9\. S-CSCF sends SIP 202 Accept to ICCF;
10\. ICCF sends 202 accept to UE using ICCP protocol.
11\~14. Standard ECT procedure to establish a session between 2^nd^ party and
3^rd^ party.
15\~18. 2nd party sends notify 200 OK to UE‑A.
19\. ICCF sends notify 200 OK to UE‑A using ICCP protocol.
NOTE: TISPAN is considering that TAS changes the Refer message to Re-invite in
order to avoid requirements on transferee (using IP-CAN access).
##### 6.6.3.1.3.2.2 ICS UE being a transferee {#ics-ue-being-a-transferee .H6}
Figure 6.6.3.1.3.2.2-1 provides an example flow for ICS UE‑A being a
transferee, 2^nd^ transfer the session to 3^rd^ party.
Figure 6.6.3.1.3.2.2-1: ICS UE‑A being a transferee, 2^nd^ transfers the
session to 3^rd^ party
1\. UE‑A and 2nd Party are talking. 2nd party initiates ECT service and sends
REFER message to TAS.
2\. TAS sends refer message to S-CSCF.
NOTE: If TAS sends Re-invite message instead of refer message according to
TISPAN group\'s latest conclusion, ICCF will transfer this re-invite towards
ICS UE.
3\. S-CSCF sends refer message to ICCF.
4\. The ICCF notifies the UE‑A through an ICCP message including the REFER
target (i.e. address of 3rd Party).
5\. The UE‑A requests a call to the 3rd Party through an ICCP message.
6\~8. ICCF sends 202 accept to 2nd party.
9\~11. The ICCF sends an INVITE with MGW SDP of existing CS call leg to the
3rd Party.
12\~14. 3rd party sends 200 OK to ICCF.
15\. ICCF sends 200 OK to UE using ICCP protocol.
16\. ICCF sends UPDATE/Re-invite to the MGCF to redirect the MGW to the 3rd
Party.
17\~19. ICCF sends notify 200 OK to 2nd party.
##### 6.6.3.1.3.3 CONF service {#conf-service .H6}
Figure 6.6.3.1.3.3-1 provides an example flow of ICS UE executing CONF service
via the CS access.
Figure 6.6.2.3.x-1 The flow of UE‑A executing CONF service.
1\. UE A have two sessions, the session with UE‑B is hold, the session with
UE‑C is active. UE‑A requests RUA to establish CONF using ICCP protocol.
2\. ICCF sends SIP Invite to Conference AS including MGW SDP.
3\. Conference AS responses 200 OK including Conference Focus URI.
4\. ICCF sends ACK to Conference AS.
5\. ICCF sends update to MGCF to redirect MGW media to the Conference.
6\. ICCF sends Refer request towards UE‑B to invite UE‑B to the Conference.
7\. UE‑B sends SIP invite request towards Conference AS.
8\. Conference AS responds 200 OK to UE‑B.
9\. UE‑B sends ACK to Conference AS.
10\. UE‑B sends notify 200 OK to ICCF.
11\. ICCF sends Bye to UE‑B.
12\. ICCF sends Refer request towards UE‑C to invite UE‑C to the Conference.
13\. UE‑C sends SIP invite request towards Conference AS.
14\. Conference AS responds 200 OK to UE‑C.
15\. UE‑C sends ACK to Conference AS.
16\. UE‑C sends notify 200 OK to ICCF.
NOTE 1: If ICCF is not inserted in PS session path, Notify message will be
sent to UE.
17\. ICCF sends Bye to UE‑C.
18\. ICCF sends Conference SUCC message to UE‑A using ICCP protocol.
NOTE 2: AS an alternative, ICCF may sends refer message to Conference AS
instead of sending to UE‑B and UE‑C, Conference AS to invite UE‑B and UE‑C to
Conference.
##### 6.6.3.1.4 Domain Transfer
##### 6.6.3.1.4.1 Domain Transfer to IMS {#domain-transfer-to-ims .H6}
The following figure provides an example flow for Domain Transfer to IMS when
the user is engaged in a held voice session with the other end B and an active
voice session with the other end C, when using ICS UE and the AS approach for
the ICCF.
Figure 6.6.3.1.4.1-1: Domain Transfer to IMS
1\. Upon detection of conditions requiring Domain Transfer, the UE initiates
registration with IMS (if not already registered in IMS). Then, the UE‑A
initiates the Domain Transfer of the active session to IMS by sending an
INVITE to the other end C. If the UE received the STI from the DTF during
session establishment then the domain transfer request contains an STI,
otherwise, only the VDI, as defined in TS 23.206 [3], is used. The transfer
session is created in the UE with the current state information of the session
being transferred.
2\. The INVITE is processed at the CSCF using standard procedures and the DTF
of VCC AS is invoked as part of standard iFC processing at the CSCF.
3\. The DTF of VCC AS uses Access Leg Update procedure to update the Access
Leg and the Remote Leg associated with the other end C\'s session. The DTF of
VCC AS extends a Re-INVITE toward the other end C for update of the SDP.
4\. Standard Domain Transfer procedure at CSCF for extending the Re-INVITE
toward the other end C. An IP bearer path is established between UE‑A and the
other end C as a result of the Re-INVITE processing at the other end C.
The DTF of VCC AS and UE subsequently release the other end C\'s Access Leg
previously established via CS domain.
5\. UE‑A sends an INVITE for the held session to the other end B with a held
SDP. If the UE received the STI from the DTF during session establishment then
the domain transfer request contains an STI, otherwise, only the VDI, as
defined in TS 23.206 [3], is used. The INVITE is processed at the CSCF using
standard procedures and the DTF of VCC AS is invoked as part of standard iFC
processing at the CSCF
Step 5 may execute in parallel with procedures initiated by step 1.
6\. The DTF of the VCC AS updates the Access Leg with the information received
in the INVITE. This is needed for completion of the call control signalling
path between the UE and the other end B via the Access Leg established with
DTF of the VCC AS in IMS.
NOTE: An Access Leg update of the held session toward the other end B
(updating of the Remote Leg of the B\'s session) may not be necessary at this
point since active media is not needed for this session until B is
\"Resumed\". However, this procedure may be carried out in parallel to
completion of Domain Transfer of the active session toward the other end C as
a UE implementation option.
The DTF of VCC AS and UE subsequently release the other end B\'s Access Leg
previously established via CS domain.
Editors Note 1: Release of pre-DT resources is FFS.
7\. User subsequently Holds the other end C and Resumes the other end B. This
results in a Re-INVITE with held SDP for C\'s session to be sent by UE‑A.
8\. The Re-INVITE with held SDP is communicated to the other end C and the
session is Held.
9\. A Re-INVITE for Resuming B\'s session is also sent by the UE‑A.
10\. The Re-INVITE is processed at the CSCF and the DTF of VCC AS for Access
Leg Update of B\'s session resulting in establishing and/or updating of an IP
bearer between the other end B and the UE‑A\ (bearer is established if it was
not established in the Held state as part of procedure initiated in step 6;
bearer is updated if it was established in the Held state as part of procedure
initiated in step 6).
##### 6.6.3.1.4.2 Domain Transfer to CS {#domain-transfer-to-cs-1 .H6}
The following figure provides an example flow for Domain Transfer to CS when
the user is engaged in a held voice session with the other end B and an active
voice session with the other end C, when using ICS UE with I1-cs and the AS
approach for the ICCF.
Figure 6.6.3.1.4.2-1: Domain Transfer to CS -- I1-cs, AS approach for ICCF
1\. Upon detection of conditions requiring Domain Transfer, the UE‑A initiates
location update with the CS network if not already done and initiates the
Domain Transfer to IMS by establishing a Bearer Control Path with RUA of the
ICCF through the VMSC.
2\. UE‑A sends information required to generate INVITE embedded in ICCP over
USSD, for initiating the Domain Transfer of the active session with the other
end C. If the UE received the STI from the DTF during session establishment
then the domain transfer request contains an STI, otherwise only the VDN, as
defined in TS 23.206 [3], is used. The transfer session is created in the UE
with the current state information of the session being transferred.
Steps 1 and 2 may be combined for signalling optimizations.
The Bearer Control Signalling session established in the INVITE sent by S-CSCF
in step 1 is identified at the ICCF by the caller\'s identity for correlation
with the Session Control Signalling session transferred via the INVITE sent by
the S-CSCF in step 3 as there can be only one Bearer Control Signalling
session for an ICS UE at any given time. If the ICS UE has multiple IMS
sessions for voice, a single circuit bearer is alternated between the multiple
sessions.
NOTE 1: The ISUP link might (especially in roaming situations) not be able to
transfer enough information to correlate the SIP INVITE. Under such
circumstances the ICCF may need to interact with a CAMEL Service.
3\. The information required to generate the INVITE is extracted from the USSD
envelop by the CAAF of ICCF and propagated as SIP INVITE to IMS by the RUA of
ICCF.
4\. The INVITE is processed at the CSCF using standard procedures and the DTF
of the VCC AS is invoked as part of standard iFC processing at the CSCF.
Editor\'s Note: It is FFS how to identify ME1\'s public user id relationship
when ME1 and ME2 use the same public user id.
5\. The DTF of the VCC AS uses Access Leg Update procedure to update the
Access Leg and the Remote Leg associated with the other end C\'s session. The
DTF of VCC AS extends a Re-INVITE toward the other end C for update of SDP.
6\. Standard Domain Transfer procedure at CSCF for extending the Re-INVITE
toward the other end C. A CS bearer path is established between UE‑A and the
other end C as a result of the Re-INVITE processing at the other end C. The
DTF of the VCC AS and UE subsequently release the other end C\'s Access Leg
previously established via IMS.
7\. UE‑A sends information required to generate INVITE embedded in ICCP over
USSD, identifying the held session with the other end B with information
indicating a held SDP. If the UE received the STI from the DTF during session
establishment then the domain transfer request contains an STI, otherwise only
the VDN, as defined in TS 23.206 [3], is used. step 7 could be combined with
procedures initiated by Step 2.
8\. The information needed to generate INVITE is extracted from the CS access
signalling envelop by the CAAF of ICCF and propagated to as SIP INVITE to IMS
by the RUA of ICCF.
9\. The INVITE is processed at the CSCF using standard procedures and the DTF
of VCC AS is invoked as part of standard iFC processing at the CSCF.
The DTF of VCC AS identifies this session as a held session and updates the
Access Leg with the information received in the INVITE. This is needed for
completion of the call control signalling path between the UE and the other
end B via the Access Leg established with DTF of VCC AS via CS domain.
An Access Leg update of the held session toward the other end B, in other
words, the updating of the Remote Leg of the B\'s session may not be necessary
at this point since active media is not needed for this session until B is
\"Resumed\". However, this procedure may be carried out in parallel to
completion of Domain Transfer of the active session toward the other end C as
a UE implementation option.
NOTE 2: The DTF of VCC AS must send re-INVITE also for the held session for
continuation of the RTCP reports if previously being sent to the UE port.
The DTF of VCC AS and UE subsequently release the other end B\'s Access Leg
previously established via IMS.
10\. User subsequently Holds the other end C and Resumes the other end B.
Information required to generate a Re-INVITE embedded in ICCP over USSD, with
information indicating held SDP for C\'s session is sent by UE‑A.
11\. The information needed to generate Re-INVITE with held SDP is extracted
from the CS access signalling envelop by the CAAF of ICCF and propagated as
SIP INVITE to IMS by the RUA of ICCF.
12\. The Re-INVITE with held SDP is communicated to the other end C and the
session is Held.
13\. The information needed to generate Re-INVITE embedded in ICCP over USSD,
for Resuming B\'s session is sent by the UE‑A. Note that step 13 could be
combined with procedures initiated by step 10.
14\. The information needed to generate Re-INVITE is extracted from the CS
access signalling envelop by the CAAF of ICCF and propagated as SIP INVITE to
IMS by the RUA of ICCF.
15\. The Re-INVITE is processed at the CSCF and the DTF of VCC AS for Access
Leg Update of B\'s session resulting in establishing and/or updating of an IP
bearer between the other end B and the UE‑A\ (bearer is established if it was
not established in the Held state as part of procedure initiated in step 9;
bearer is updated if it was established in the Held state as part of procedure
initiated in step 9).
##### 6.6.3.1.5 Managing Network Services related Information
##### 6.6.3.1.5.1 Using I1-cs {#using-i1-cs .H6}
The following figure provides an example flow for Managing Network Services
related Information, when using ICS UE with I1-cs and the AS approach for the
ICCF. The I5 reference point is used to manage network services related
information from the ICCF. This does not preclude the use of other mechanisms
for managing network services related information, e.g. using OSA or OA&M
mechanisms; the details of these other mechanisms are out of scope of this
document.
Figure 6.6.3.1.5.1-1: Managing Network Services related Information -- using
I1-cs
1\. ICS UE initiates management of network services related information. The
ICS UE encodes in ICCP sufficient information for the ICCF to use capabilities
defined for the Ut reference point as defined in TS 23.002 [18] and TS 24.173
[5] for managing network services related information and sends it in a USSD
message to the CAAF part of the ICCF.
2\. Standard VMSC procedure to communicate the USSD message to the Home
network.
3\. Standard HSS procedure to communicate the USSD message to the associated
service node
NOTE 1: The ICCF maybe statically assigned. Details are FFS.
4\. The CAAF part of the ICCF terminates the USSD message. According to clause
6.2.2, the ICCF has the RPC part of the ICCF use capabilities defined for the
Ut reference point as defined in TS 23.002 [18] and TS 24.173 [5] for managing
network services related information.
5\. The AS generates a response to the ICCF.
6\. This step consists of a standard service node procedure to communicate the
USSD message to the HSS, a standard HSS procedure to communicate the USSD
message to the VMSC, and a standard VMSC procedure to communicate the USSD
message to the ICS UE.
##### 6.6.3.1.5.2 Using IP-CAN {#using-ip-can .H6}
As specified in TS 24.173 [5].
#### 6.6.3.2 I1-cs: registered user solution -- ISC model
##### 6.6.3.2.1 IMS Registration via CS access
##### 6.6.3.2.2 Origination, termination, Mid-call services and Domain
Transfer
The information flows for Originations, Terminations, Mid Call services and
Domain Transfers are the same as in clause 6.6.3.1, unless specified below.
##### 6.6.3.2.3 Managing Network Services related Information
See clause 6.6.3.1.5, Managing Network Services related Information.
## 6.7 Architectural alternative: I1-cs IMS Adaptor approach
### 6.7.1 Signalling and bearer architecture for full duplex speech over CS
access
This model is centred around the concept of emulating a standard IMS capable
UE accessing IMS services via CS access, as an IMS end point, hence CS access
specific adaptations are handled in the ICCF. In this approach, the ICCF acts
as a light-weight P-CSCF (e.g. only includes a simplified IMS security and
doesn\'t include policy handling towards the PCRF) towards the IMS core (see
also figure 6.7.1-1). The ICCF is not impacted by additional IMS sessions
established over IP-CAN in case a suitable IP-CAN is available.
Transparent CS Signalling, using USSD dialogues, is used to communicate needed
session control signalling information from the UE using I1-cs via the MSC-S /
MSC/VLR through the HSS (at initial registration in IMS and when UE is roaming
in a visited domain), or directly from the MSC-S / MSC/VLR, when UE is roaming
or at home, to the ICCF (serving MSC assumed to have a suitable USSD
application for ICS). I1-cs is terminated in the CAAF of the ICCF and the CAAF
performs necessary adaptation for the I1-cs when relaying the Session Control
Signalling to/from the RUA which presents SIP UA behaviour on behalf of the UE
toward IMS.
Editor\'s Note 1: IMS registration performed over the RUA leg is FFS.
Editor\'s Note 2: The IMS registration performed over the RUA leg and the
security implications are for further study.
For establishment of IMS sessions via CS access, the UE establishes a media
control signalling path with the SIP UA (RUA) within the ICCF by establishing
a CS call toward the ICCF (the CAAF in the ICCF is bypassed). Different
options do exist to route the CS call from the UE to the ICCF. In parallel, it
establishes a session control signalling path with the USSD Handler in the
CAAF within the ICCF using transparent CS Signalling using USSD as described
above. The media control Signalling and session control Signalling are
combined in the RUA at the ICCF for presentation of SIP UA behaviour for
establishment of an IMS session.
The same principle applies for a terminating call to the UE, ie. I1-cs is used
to carry signalling needed for establishment and/or for any required control
of terminating IMS sessions from the ICCF to the UE, and media transport over
CS access is either established or an already established one is reused.
The UE uses a session control signalling path via the ICCF to control the
service related to the first session (e.g. mid call handling). Subsequent call
related input is communicated to the ICCF using the session control signalling
path; i.e. CS call setup procedures are not used for establishment of
subsequent user sessions or for invocation of mid-call voice services. Upon
Domain Transfer from CS access to PS access, the CS access related service
state is released in both the ICCF and the UE.
Use of the I1-cs for session setup enables provisioning of MMTel bi-
directional speech services to ICS UEs when using CS access with this model.
Figure 6.7.1-1: Signalling/Bearer Paths: USSD transport of ICCP with IMS
Adaptor approach
NOTE 1: Some details omitted for brevity.
NOTE 2: In some cases the bearer control signalling path can carry session
control signalling for IMS session as well.
### 6.7.1a Registration
#### 6.7.1a.1 RUA Registration in IMS when attached to CS access
##### 6.7.1a.1.1 Triggers for RUA Registration / De-registration
The following table contains possible triggers to start / stop RUA
registration. In addition, the table contains information whether this trigger
is of use for ICS UE or non ICS UE, respectively:
Table 6.7.1a.1.1-1: Possible triggers to start / stop RUA registration
* * *
Possible trigger to start / stop RUA registration ICS UE non ICS UE Push by
UE: using ICCP to ICCF Yes No Push by network: Using CAMEL ph3 M-CSI (only
attach / detach) Yes Yes Push: new HSS functionality (attach / detach) FFS FFS
Pull: CAMEL ph2 ATI poll to retrieve attach / detach status Yes Yes
Registration Timeout in ICCF Yes Yes
* * *
Some of the above-listed triggers are combined into a solution for ICS UEs
which can be enhanced to support non ICS UEs as well:
\- To support ICS UEs: -
\- Registration trigger using ICCP from the UE to the ICCF right after IMSI
attach; de-registration trigger via ICCP if possible before detach
\- Timeout in the ICCF to de-register in IMS (e.g. in case the UE could not
de-register via ICCP).
\- If registration timeout occurs, and the user is engaged in a call, the ICCF
re-registers the ICS user in IMS
\- If registration timeout occurs, and the user is not engaged in a call, the
ICCF performs a Sh or MAP ATI poll to HSS to check CS status of an ICS user.
\- If an ICS user is detached, then the ICCF de-registers the ICS user in IMS.
\- If an ICS user is attached, then the ICCF re-registers the ICS user in IMS
and starts a registration timer again.
> NOTE: The higher the value of the registration timeout timer is, the lower
> the signalling load.
\- To support non ICS UEs, either of the following solutions should be
applied:
\- M-CSI attach / detach trigger to inform the ICCF in case the UE has
attached / detached (note: this requires CAMEL PH3 support in VPLMN and HPLMN)
\- The HSS pushes attach / detach trigger to inform the ICCF in case the UE
has attached / detached (note: details of solution are FFS, especially how to
detect detach in VPLMN)
##### 6.7.1a.1.2 RUA Registration by the ICCF
The RUA in the ICCF performs a trusted registration on behalf of the UE. The
solution for trusted registration by the RUA in the ICCF is similar to Early
IMS security as specified in 3GPP Rel‑6 TR 33.978 (see S2-071863 for details).
In summary, the trusted registration allows the ICCF to register on behalf of
a CS UE, based on the fact that it can be verified that the UE has been
authenticated in the CS domain (this could be checked e.g. at the ICCF or at
the HSS).
Similar to Early IMS, the RUA in the ICCF registers using a Temporary-IMPU
based on the IMSI, which allows the I-CSCF and S-CSCF to derive the IMPI based
on this T-IMPU.
When a register request is received without the Authorization-Header, the
S-CSCF first checks the IP address in the \"Contact\" header field as well as
the received IP address of the first Via header with the list of pre-
configured ICCF IP addresses. If there is a match, it is considered as an ICS
Registration and the UE is considered authenticated.
It has been concluded by SA3 that the overall procedures provide sufficient
security for the purposes of ICS and does not impose any new threats and risks
to the IMS system, assuming that the ICCF is within the same security domain
as the S-CSCF and that it also exists within the same IMS trust domain.
The registered contact address is the ICCF, i.e., if the Request-URI would be
matched, then a terminating call would be routed to the ICCF.
The RUA Registration provides the following information into the contact in
the S-CSCF
\- Feature tag to indicate capability audio only. A terminating SIP INVITE
which is indicating other capabilities would not match the CS contact.
\- Indicate in CS access characteristics (details are stage 3 issue). Possible
solutions are:
\- Indicates CS access in P-Access-Network-Info as new access network type
(e.g. \"GERAN-cs\", \"UTRAN-cs\").
\- New feature tag indicating CS access
NOTE: CS access characteristics is only set by ICCF.
To select between PS contact and CS contact bound to one IMPU, DSF will
provide sufficient information in the request message sent to S-CSCF to
indicate if it should select PS or CS contact. So with RUA registration there
is no possibility that S-CSCF will fork to both PS and CS contact, i.e. the
possibility to fork to one terminal twice. Standard measure can be applied
here, such as Accept-Contact, Reject-Contact, etc.
On reception of a REGISTER request, the S-CSCF sends a third-party REGISTER
request to each Application Server that matches the Filter Criteria sent from
the HSS for the REGISTER request. If it is necessary to match only the initial
filter criteria for ICCF registration but not for UE registration (or vice
versa), the content of a PANI header or a contact headers could be used to
differentiate those cases as criteria, e.g. if an AS always assumes that a UE
is accessible via PS when registered, a third-party REGISTER request should
not be sent to the AS when the UE is registered via ICCF from CS. But in the
light of ICS principle to provide the IMS services both in CS access and PS
access in the similar manner, the requirements to differentiate those cases
have to be further studied and understood. The Application Server can use the
RegEvent package as specified in RFC 3680 to see whether a user is IMS
registered and to know all of the registered public IDs which are in the same
implicit registered set.
NOTE: In case the ICS UE would also register in IMS over Gm reference point,
then the S-CSCF maintains for both the registration over Gm and the RUA
registration a contact with a unique IMPI/IMPU binding. Each contact can be
de-registered individually.
##### 6.7.1a.1.3 Originating / terminating call
**CS Originating session:**
If a session is originated in CS access, it is routed via PSI routing directly
to the ICCF. The ICCF routes then the INVITE to the S-CSCF using standard call
origination procedures.
Considering that a call originated in PS access does not need to involve ICCF
in the originating session, ICCF is not included in originating iFC.
Followed the ICCF, the S-CSCF is trying to match the filter criteria for that
SIP request according to their priority for other Application Servers. Only if
the filter criteria are matched then the application server is invoked. The
first AS to be invoked after ICCF for VCC capable ICS-UE would be DTF.
**Terminating session:**
The terminating session is routed first to S-CSCF using standard procedures.
The S-CSCF invokes first other Application Servers if the corresponding filter
criteria are matched. And ICCF is not included in terminating iFC. The last AS
invoked via iFC performs access domain selection, And ICCF is only involved
when CS access is selected. There are two cases:
\- If CS access is selected, sufficient information (e.g. Accept-Contact with
feature tag indicating CS) is indicated in the INVITE message only to select
CS contact in the S-CSCF. The S-CSCF selects ICCF which contact from CS access
is registered and route the INVITE message to ICCF.
\- If PS access is selected, sufficient information (e.g. Reject-Contact with
feature tag indicating CS) is indicated in the INVITE message only to select
PS contact in the S-CSCF.
Editor\'s note: Alternative solution which does not need to perform access
domain selection is FFS.
##### 6.7.1a.1.4 RUA De-Registration by the ICCF
The ICCF will de-register the contact for the ICS UE if it receives a
corresponding trigger, as discussed in clause 6.7.1a.1.1. In case the ICCF
does not re-register on behalf of the ICS UE, the RUA registration will time
out.
##### 6.7.1a.1.5 Network De-Registration
In case the S-CSCF initiates network de-registration, as the ICCF has
subscribed to reg-event package, the ICCF will be notified by the network and
it can subsequently inform the ICS UE via USSD.
##### 6.7.1a.1.6 RUA registration use cases
NOTE: These use cases are applicable to both IA model and AS model for I1-cs.
**Use case 1: RUA registration:**
This example exemplifies the case in which the trigger for registration is
sent by UE (see also clause 6.6.2a.1.2.2 which describes the same use case).
{width="6.679861111111111in" height="3.761111111111111in"}
Figure 6.7.1a.1.6-1: RUA registration
1\. ICS UE attaches to CS access.
2\. Upon CS attachment, ICS UE sends ICS registration request towards HLR
using USSD via MSC.
3\. HLR forwards the request to targeted ICCF.
4\. The RUA in ICCF composes the SIP REGISTER message based on the received
USSD message as described in 6.7.1a.1.2, and sends it to IMS network.
5\. IMS Registration is done. It should be noted that since ICCF is a trusted
node, there is no need to return SIP 401 response. Instead SIP 200 OK is sent
back to ICCF.
6\. ICCF sends a USSD message back to HLR, informing the result of the
registration request.
7\. HLR sends the USSD message to the ICS UE via MSC.
**Use case 2: RUA registration followed by IMS registration:**
{width="6.673611111111111in" height="2.7180555555555554in"}
Figure 6.7.1a.1.6-2: RUA registration followed by IMS registration
1\. When the ICS UE attaches to CS access, it does the RUA registration as
shown in Use Case 1.
2\. After the RUA registration, the CS contact, which points to the ICCF, is
now bound with the IMPU of the ICS UE in S-CSCF.
3\. Now the ICS UE obtains PS access, it executes the standard IMS
registration in IMS.
4\. After the IMS registration, the PS contact is now also bound with the IMPU
of the ICS UE.
**Use case 3: IMS registration followed by RUA registration:**
{width="6.673611111111111in" height="2.7180555555555554in"}
Figure 6.7.1a.1.6-3: IMS registration followed by RUA registration
1\. When the ICS UE attaches to PS access, it does the IMS registration.
2\. After the IMS registration, the PS contact is now bound with the IMPU of
the ICS UE in S-CSCF.
3\. Now the ICS UE obtains CS access, it executes the RUA registration as
shown in Use Case 1.
4\. After the RUA registration, the CS contact, which points to the ICCF, is
now also bound with the IMPU of the ICS UE in S-CSCF.
**Use case 4: RUA de-registration:**
This example exemplifies the case in which the trigger for de-registration is
sent by UE.
{width="6.679166666666666in" height="3.772222222222222in"}
Figure 6.7.1a.6-4: RUA de-registration
1\. ICS UE sends ICS de-registration request towards HLR using USSD via MSC.
2\. HLR forwards the request to targeted ICCF.
3\. The RUA in ICCF composes the SIP REGISTER message, with the Expire
header\'s value set to zero, based on the received USSD message, and sends it
to IMS network.
4\. IMS deregistration is done. SIP 200 OK is sent back to ICCF.
5\. ICCF sends a USSD message back to HLR, informing the result of the de-
registration request.
6\. HLR sends the USSD message to the ICS UE via MSC.
7\. The ICS UE detaches from CS access.
### 6.7.2 Information flows
#### 6.7.2.1 Origination
##### 6.7.2.1.1 Use of USSD transport in IMS Adaptor approach for session
control
The figure 6.7.2.1.1-1 provides an example flow for a call made by an ICS UE
to UE‑B in the IMS Adaptor approach when using USSD transport of ICCC, when
ICCC is used for setup of all sessions.
{width="6.672916666666667in" height="4.864583333333333in"}
Figure 6.7.2.1.1-1: Use of USSD transport in IMS Adaptor approach for
originating session control
1\. The ICS UE initiates a call by sending an ICS Call Initiation Request
inside a USSD dialog to the HSS containing B party address (SIP or Tel URI).
2\. The USSD application within the HSS forwards the USSD Request to the ICCF
instance addressed in the HSS. The ICCF shall store the received B Party
Address\'s against an IMRN.
3\. The ICCF allocates a roaming number if a media connection is not already
established to the ICS UE. The ICCF returns the IMRN in an ICS Response within
the USSD dialog. The USSD response is returned all the way to the ICS UE.
4\. The ICS UE uses the IMRN to establish a normal CS call set up to the ICCF
via MGCF. PSI routing is used to route the call from MGCF to ICCF.
5\. Following that, ICCF initiates the call towards UE‑B by sending a SIP
INVITE to the S-CSCF.
6\. ICCF receives SIP 180 ringing.
7\. ICCF receives SIP 200 OK.
8\. ICCF send an ICS Call initiation response to the ICS UE that includes the
connected status.
9\. ICCF sends an ACK to the UE‑B and the media is now established end to end.
#### 6.7.2.2 Termination
##### 6.7.2.2.1 Use of USSD transport in IMS Adaptor approach for session
control
Figure 6.7.2.2.1-1 provides an example flow for a call destined to an ICS UE
when USSD transport for ICCP is used to support the setup of all terminating
sessions.
Figure 6.7.2.2.1-1: Use of USSD transport in IMS Adaptor approach for session
terminations
1\. An incoming SIP INVITE is received at the ICCF instance bound to the
actual target ICS UE of the call.
2\. ICCF initiates an ICS Incoming Call Request USSD to the MSC-S where the
ICS UE is. The MSC pages the ICS UE. This step is optional.
3\. ICCF then fetches a number such as MSRN if a media connection is not
already established to the ICS UE.
Editor\'s note 1: The types of number to be used and how the number is
allocated are FFS.
4\. ICCF establishes a call leg using the MSRN (or other type of number) for
that purpose. PSI routing is used to route the call from MGCF to ICCF.
Editor\'s note 2: The relationship and/or interaction between step 2 an 4 is
FFS.
5\. ICCF sends a SIP 200 OK to the S-CSCF.
6\. S-CSCF returns a SIP ACK and the media path is now established end to end.
##### 6.7.2.2.2 Use of USSD transport in IMS Adaptor approach for session
control
Figure 6.7.2.2.2-1 provides an example flow for a call destined to an ICS UE
when USSD transport for ICCP is used to support the setup of all terminating
sessions.
Figure 6.7.2.2.2-1: Use of USSD transport in IMS Adaptor approach for session
terminations
1\. An incoming SIP INVITE is received at the ICCF instance bound to the
actual target ICS UE of the call. The ICCF shall store the information
received in the INVITE such as but not limited to TO, FROM, CONTACT, PRIVACY
INDICATION, GRUU, R-URI, SDP etc. Against this information shall be assigned
an IMRN which is an E.164 number. The E.164 number or IMRN could be dynamic or
may even be assigned sequentially. However the property of the IMRN shall be
such that if the ICCF receives it back it shall be able to deduce the stored
information and the corresponding incoming call leg.
2-4. ICCF initiates an ICS Incoming Call Request using USSD containing but not
limited to: Flag to indicate its an ICS message, a flag to indicate it is for
MT call, A Party -- if allowed or indication that A-party ID is withheld,
B-Party address -- SIP or Tel URI, GRUU, the called ID so that the B party
knows which public user ID it was called on to the MSC-S where the ICS UE is.
The MSC pages the ICS UE, this step is optional. A USSD response is sent out
towards the IMRN.
5\. The UE shall originate a voice call in the CS domain according to
\"Information flow for an MO call\" in TS 23.018 [3] using the assigned E.164
number to establish an Access Leg via the CS domain to the ICCF.
6\. The originating call is processed in the CS network according to CS
origination procedures described in TS23.206 clause 6.2.2 VCC UE Origination
from CS Domain for routing to IMS. However the CAMEL triggers shall be
deactivated due to CAMEL deactivation trigger information being provided in
the MAP Insert Subscriber Data. The VMSC routes the call towards the user\'s
home IMS network via an MGCF.
7\. The MGCF initiates an INVITE towards the I-CSCF in the home IMS of the
originating UE.
7b. The I-CSCF routes the INVITE to the ICCF on one of the following standard
procedures specified in \"PSI based Application Server termination - direct
and PSI based Application Server termination - indirect\" procedures in TS
23.228 [4].
NOTE 1: Direct routing to ICCF is shown, although routing via S-CSCF is also
possible.
NOTE 2: For PSI, the ISC & Ma Reference Points are supported by the ICCF (see
clause 6.2.2.2.2).
8\. The ICCF analyzes the received E.164 number and correlates it with the
stored information so that it can complete the incoming call and bridge the
incoming call from the B party with the incoming call from the A party. The
E.164 number shall then be returned to the quarantine pool after which it
maybe reused again at some suitable point
9a. ICCF returns a SIP 200 OK to the S-CSCF. Note: steps 9a and 9b can be
executed in parallel or in a different order.
9b. ICCF returns a SIP 200 OK and the media path is now established end to
end.
NOTE 3: charging records will need to be correlated. The IMRN could be used
for this.
#### 6.7.2.3 Mid-call services
##### 6.7.2.3.1 General
Example information flows for mid-call services for the signalling/bearer
architecture for full-duplex speech service with IMS centralized services over
CS access are discussed in the following.
##### 6.7.2.3.2 Mid-call event handling
Figure 6.7.2.3.2-1 provides an example flow when an ICS UE receiving services
in IMS is engaged in a call with a B party puts B on hold and initiates a new
call to a C party.
Figure 6.7.2.3.2-1: Mid-call event handling
1\. The ICS UE sends an ICS Hold Request on B party inside a USSD dialog to
the HSS.
2\. The USSD application within the HSS routes the USSD Request to the
appropriate ICCF.
3\. The ICCF sends a SIP UPDATE to the B party to put the B party on hold.
4\. ICCF receives a SIP 200 OK.
5\. ICCF forwards an ICS Returned Result within a USSD Response to the ICS UE.
6\. The ICS UE initiates a new call to the C party by sending an ICS Call
Initiation Request within the USSD dialog to the HSS.
7\. The HSS routes the USSD Request to the appropriate ICCF.
8\. The ICCF sends a SIP INVITE to the C party.
9\. ICCF receives SIP 180 ringing.
10\. The ICCF sends an ICS Call Initiation Response to the ICS UE that
includes the Alert status.
Editor\'s note 1: How the ICCF will then redirect the media to the appropriate
bearer in the MGW, or if other means could be used, is FFS.
11\. ICCF receives SIP 200 OK.
12\. ICCF send an ICS Call Initiation Response to the C party that includes
the connected status.
13\. ICCF send an SIP ACK to the C party and the media is now established e2e
between the ICS UE and C party.
Editor\'s note 2: When the ICCF puts B party on hold, normally RTCP should be
continually by sent between B party, in order to keep the link alive. How to
handle RTCP reports from the held B party is FFS.
#### 6.7.2.4 Domain Transfer
Example information flows for domain transfers are shown below. It\'s assumed
that the ICS UE stores the service states.
Editor\'s note 1: Support for multiple call continuity with mid call services
is FFS.
Editor\'s note 2: The STID concept should be incorporated (S2-072037).
##### 6.7.2.4.1 Single Call Continuity from CS access to PS access
The following figure provides an example flow for single call continuity
between an ICS user and an IMS user from CS access to PS access.
{width="6.659027777777778in" height="4.406944444444444in"}
Figure 6.7.2.4.1-1: Single call continuity from CS access to PS access
1\. If not already done so, the ICS UE registers in IMS from PS access to
receive services.
2\. The ICS UE initiates a SIP INVITE towards DTF using VDI to establish a
target access leg in PS access and request call transfer. SDP includes UE
address in PS access. The IMS core routes the SIP INVITE to the DTF where the
source access leg from CS access is currently anchored.
3\. The DTF sends a UPDATE or Re-INVITE to the remote end to request a change
of address in the media connection.
4\. The remote end returns a 200 OK to the DTF via IMS core. PSI routing is
used to route the call from MGCF to ICCF.
5\. The DTF in turn sends the 200 OK to the ICS UE via IMS core.
6\. The DTF then clears the source access leg in CS access and the media
connection is now established in PS access to the remote end.
##### 6.7.2.4.2 Single call continuity from PS access to CS access
##### 6.7.2.4.2.1 Use of ICCP to route a call on the transferring-in domain
{#use-of-iccp-to-route-a-call-on-the-transferring-in-domain .H6}
The following figure provides an example flow for a single call continuity
between a ICS user and a IMS user from CS access to PS access, where ICCC is
used for setup of all sessions.
{width="6.657638888888889in" height="4.6375in"}
Figure 6.7.2.4.2.1-1: Single call continuity from PS access to CS access, use
of ICCP to route a call
1\. ICS UE initiates an ICS Call Initiation Request within a USSD dialog
towards DTF using VDN to establish a target access leg in CS access and
request call transfer.
2\. The USSD application within the HSS forwards the USSD Request to ICCF.
3\. The ICCF selects an IMRN if a media connection is not already established
to the ICS UE. The ICCF returns the IMRN in an ICS response within the USSD
dialog. The USSD response is returned all the way to the ICS UE.
4\. The ICS UE uses the IMRN to establish a normal CS call set up to the ICCF
via MGCF. PSI routing is used to route the call from MGCF to ICCF.
5\. Following that, ICCF initiates a call to the VDN by sending a SIP INVITE
to the IMS core which routes the INVITE towards the DTF where the source
access leg from PS access is currently anchored. SDP includes MGW address in
CS access.
6\. The DTF sends a UPDATE or re-INVITE towards remote end via the IMS core to
request a change of address in the media connection.
7\. The remote end returns a 200 OK to the DTF.
8\. The DTF in turn sends a 200 OK to the ICCF.
9\. ICCF sends an ICS Call Initiation Result including the connected status
back to the ICS UE within the USSD dialog.
10\. The media connection is now established in CS access to the remote end
and the DTF clears the source access leg in PS access.
##### 6.7.2.4.2.2 Use of CAMEL to route a call on the transferring-in domain
{#use-of-camel-to-route-a-call-on-the-transferring-in-domain .H6}
The following figure provides an example flow for single call continuity
between a ICS user and a IMS user from CS access to PS access, where CAMEL is
used for routing a call to IMS.
{width="6.657638888888889in" height="4.6375in"}
Figure 6.7.2.4.2.2: Single call continuity from PS access to CS access, use of
CAMEL to route a call
1\. The ICS UE initiates a normal CS call towards DTF using VDN to establish a
target access leg in CS access and request call transfer.
2\. The MSC-S sends a CAMEL originating trigger request to the ICCF to fetch
an IMRN for ICCF.
3\. The ICCF selects and returns an IMRN to the MSC-S.
4\. The MSC-S routes a call to the IMRN to establish a normal CS call set up
to the ICCF via MGCF.
5\. Following that, ICCF initiates the call to the VDN by sending a SIP INVITE
to the IMS core which routes the INVITE towards the DTF where the source
access leg from PS access is currently anchored. SDP includes MGW address in
CS access.
6\. The DTF sends a UPDATE or re-INVITE towards remote end via the IMS core to
request a change of address in the media connection.
7\. The remote end returns a 200 OK to the DTF via IMS core.
8\. The DTF in turn sends the 200 OK to the ICCF via IMS core.
9\. The ICCF sends the 200 OK to the MGCF.
10\. The MGCF sends the ANM to the MSC-S.
11\. The MSC-S sends the Connect to the ICS UE.
12\. The media connection is now established in CS access to the remote end
and the DTF clears the source access leg in PS access.
##### 6.7.2.4.3 Assignment of Session Transfer Identifier
See clause 6.6.2.
#### 6.7.2.5 Managing Network Services related Information
See clause 6.6.3.1.5, Managing Network Services related Information.
## 6.8 Architectural alternative: L-CAAF-n approach
### 6.8.1 Signalling and bearer architecture
#### 6.8.1.3 Calls established using CS bearers with non ICS UE
The signalling/bearer paths for an IMS session established via CS access for
the L-CAAF-n approach is described in figure 6.8.1.3-1.
Figure 6.8.1.3-1: Signalling/Bearer Paths-non ICS UE‑ L-CAAF-n approach
CS Access Signalling is intercepted by the L-CAAF-n function, which
establishes a session control signalling path to the ICCF. The L-CAAF-n
performs necessary interworking with TS 24.008 [7]. The ICCF presents SIP UA
behaviour on behalf of the UE toward IMS.
The UE establishes a standard CS call towards the CS core network; The
L-CAAF-n intercepts the CS Access Signalling and establishes the Bearer
Control Signalling path with the ICCF by establishing a CS call toward the
ICCF. In parallel, it establishes the Session Control Signalling Path with the
ICCF. The Bearer Control Signalling and Session Control Signalling stimuli are
combined at the ICCF for presentation of SIP UA behaviour for establishment of
an IMS session.
Use of the Session Control Signalling Path for session setup for this model
enables the capability to provide all services exclusively by IMS.
Editor\'s note: A solution for call independent aspects such as user
configuration and interworking/alignment of supplementary services data across
CS domain and IMS is to be provided.
### 6.8.2 Information flows
## 6.8a Architectural alternative: Enhanced MSC Server approach
### 6.8a.1 Signalling and bearer architecture
#### 6.8a.1.1 Calls established using CS bearers with non ICS UE
The Signalling/bearer paths for an IMS session established via CS access by
non ICS UE with the enhanced MSC Server presenting a single SIP session is
described in figure 6.8a.1.1-1.
{width="6.242361111111111in" height="2.6180555555555554in"}
Figure 6.8a.1.1-1: Signalling/Bearer Paths-non ICS UE‑ Enhanced MSC Server
approach
CS Access Signalling is terminated by the enhanced MSC Server, which
establishes a single SIP session towards the IMS. The MSC Server performs
necessary interworking with TS 24.008 [7]. The MSC Server presents SIP UA
behaviour on behalf of the UE toward IMS.
Use of the direct SIP signalling between the MSC Server and CSCF for this
model enables the capability to provide telephony services exclusively in IMS.
### 6.8a.1a IMS Address Discovery
Prior to initiating IMS registration on behalf of the UE, the MSC Server must
discover the address of the appropriate recipient IMS node for the SIP
REGISTER, e.g. I-CSCF or IBCF. The MSC Server derives a home domain name using
the IMSI of the subscriber and performs a DNS query on this domain name, which
returns the IP address(es) of the I-CSCF/IBCF. The structure of the derived
domain name is a stage 3 issue. This domain name would effectively serve as a
SIP URI for the domain name of the home network.
### 6.8a.2 Information Flows
#### 6.8a.2.1 Registration
The following information flows depict the user registering in IMS via CS
access for various idle-mode mobility scenarios.
**Use Case 1: Initial IMS Registration via MSC Server:**
Figure 6.8a.2.1-1 Non ICS UE IMS registration via MSC Server
1\. The UE is not registered in CS or IMS.
2\. Standard CS Attach procedures are initiated towards the CS network.
3\. Standard CS location update, authentication and insert subscriber data
procedures.
4\. A CS Attach Accept is returned to the UE.
5\. Upon successful location update in CS, the MSC Server discovers the
address of the appropriate I-CSCF/IBCF and sends a trusted SIP REGISTER to the
IMS with the appropriate information (e.g. Temporary Public User Identity
derived from IMSI, MSC Server address as the host portion of the \"Contact\"
address, etc.). The REGISTER from the MSC Server does not include an
Authorization header field or the header field values as required by RFC 3329.
The principles of TR 33.803 shall be followed to allow this type of
registration to co-exist with registrations which must be authenticated by the
IMS. Network Domain Security (TS 33.210 [20]) can also be used to authenticate
the MSC Server sending the REGISTER. This REGISTER also provides the following
information in the Contact header:
\- Feature tag to indicate capability audio only. A terminating SIP INVITE
which is indicating other capabilities would not match the CS contact.
\- Indication of CS access characteristics (details are stage 3 issue).
Possible solutions are:
\- Indicates CS access in P-Access-Network-Info as new access network type
(e.g. \"GERAN-cs\", \"UTRAN-cs\").
\- New feature tag indicating CS access.
Editor\'s note: How the MSC Server decides whether or not to initiate IMS
registration for this subscriber is for further study.
6\. Standard I-CSCF/HSS procedures for S-CSCF location/allocation. Note that
the private identity is obtained from the IMSI, which is contained in the
T-IMPU.
7\. The I-CSCF forwards the REGISTER to the S-CSCF.
8\. The S-CSCF identifies the REGISTER as a trusted registration from the MSC
Server which is a trusted network node. The S-CSCF skips any further
authentication procedures as it is assumed that the user has already been
authenticated in the CS domain. The S-CSCF performs the SAR / SAA exchange
with the HSS, resulting in the user status as \"registered\" and the S-CSCF
name stored in the HSS. The S-CSCF stores the Contact address for each of the
implicitly registered IMPUs.
NOTE: In case the user is already in the \"registered\" state for the same
IMPI/IMPU but with a different contact address, and the previous registration
has not expired, the S-CSCF performs the network initiated deregistration
procedure for the old contact address.
9\. Service control execution at the S-CSCF is performed according to the
standard procedures.
10-11. A 200 OK response to REGISTER is returned. Note that IMS registration
success/failure does not impact the CS attach status of the UE.
**Use Case 2: IMS registration via new MSC Server:**
Figure 6.8a.2.1-2 Non ICS UE IMS registration via MSC Server
1\. The UE is registered in CS and IMS.
2\. Standard Location Updating procedures initiated towards the CS network.
3\. Standard CS location update and authentication procedures.
4\. The MAP Cancel Location procedures are completed between the HLR component
of the HSS and the old VLR.
5\. MAP Insert Subscriber Data procedures are completed towards the new VLR.
6\. The HLR component of the HSS completes the MAP Update Location procedure
with the new VLR.
7\. A Location Updating Accept is sent to the UE.
8\. The MSC Server initiates deregistration procedures towards IMS (REGISTER
with Expires header value of 0). Step 8 can be triggered in parallel with step
5.
9\. Standard I-CSCF/HSS procedures for S-CSCF location.
10\. The I-CSCF forwards the REGISTER to the S-CSCF.
11\. Service control execution at the S-CSCF is performed according to the
standard procedures.
12\. The S-CSCF identifies the REGISTER as a trusted registration from the MSC
Server which is a trusted network node. The S-CSCF skips any further
authentication procedures as it is assumed that the user has already been
authenticated in the CS domain. The S-CSCF performs the SAR / SAA exchange
with the HSS according to standard procedures.
13\. The MSC Server discovers the address of the appropriate I-CSCF/IBCF and
sends a trusted SIP REGISTER to the IMS as described in the previous use case.
14\. Standard I-CSCF/HSS procedures for S-CSCF location/allocation. Note that
the private identity is obtained from the IMSI, which is contained in the
T-IMPU.
15\. The I-CSCF forwards the REGISTER to the S-CSCF.
16\. The S-CSCF handles the REGISTER as described in the previous use case.
17\. Service control execution at the S-CSCF is performed according to the
standard procedures.
18-19. A 200 OK to REGISTER is returned _._
**Use Case 3: UE registered in IMS via MSC Server roams to non-enhanced
VMSC:**
Figure 6.8a.2.1-3: Non ICS UE (registered at MSC Server) registration at
Legacy VMSC
1\. The UE is registered in CS and IMS.
2\. Standard Location Updating procedures initiated towards the CS network.
3\. Standard CS location update and authentication procedures.
4\. The MAP Cancel Location procedures are completed between the HLR component
of the HSS and the old VLR.
5\. A MAP Update Location response is returned to the legacy VMSC.
6\. Location Updating Accept is sent to the UE.
7\. The MSC Server initiates deregistration procedures towards IMS (REGISTER
with Expires header value of 0).
8\. Standard I-CSCF/HSS procedures for S-CSCF location.
9\. The I-CSCF forwards the REGISTER to the S-CSCF.
10\. Service control execution at the S-CSCF is performed according to the
standard procedures.
11\. The S-CSCF identifies the REGISTER as a trusted registration from the MSC
Server which is a trusted network node. The S-CSCF skips any further
authentication procedures as it is assumed that the user has already been
authenticated in the CS domain. The S-CSCF performs the SAR / SAA exchange
with the HSS according to standard procedures. In this scenario, subsequent
calls attempts to this UE shall be redirected to the CS domain via the MGCF,
which is an example of \"services related to unregistered state\" as described
in TS 23.228 [4].
12-13. A 200 OK to REGISTER is returned.
#### 6.8a.2.2 Origination
The following information flow depicts IMS call origination performed via CS
access.
Figure 6.8a.2.2-1 Non ICS UE IMS origination at MSC Server
The non-ICS UE IMS origination procedure is as follows: -
1\. The UE originates a voice call in the CS domain to the party-B using
standard CS call setup procedures.
2\. The MSC Server translates the setup message and initiates a SIP INVITE
request addressed to a tel URI or, if directed by operator\'s local policy, to
a SIP URI (using an E.164 address in the user portion and the setting
user=phone), includes an initial SDP in the INVITE request, and forwards the
request to the S-CSCF along the path determined upon the UE\'s most recent
registration procedure.
3\. The S-CSCF invokes service control using registered iFC.
4\. The S-CSCF forwards the INVITE to the B-party UE.
5\. The B-party UE accepts the session with a 200 OK response back to the
S-CSCF.
6\. The 200 OK is forwarded to the MSC Server.
7\. The MSC Server translates the 200 OK and sends a connect message to the
non ICS UE. The voice session can then be established between A-party and
B-party.
#### 6.8a.2.3 Termination
The following information flows depict IMS call termination made via CS
access.
**Use case 1:** User is registered in IMS:
Figure 6.8a.2.3-1: Non ICS UE (registered in IMS) termination
The Non-ICS UE IMS (registered in IMS) termination procedure is as follows:
1\. Party A sends an INVITE request for initiating a voice session with the
Party B non ICS UE.
2\. The I-CSCF in the terminating home network performs Location Query
procedure with the HSS to acquire the S-CSCF address of Party B according to
standard IMS procedures.
3\. The I-CSCF forwards the INVITE request to the S-CSCF.
4\. The S CSCF invokes service control using registered iFC according to
standard IMS procedures.
5\. The final iFC directs the INVITE to the access domain selection (ADS)
function. The MSC Server is chosen. Note that the presence of the ADS in the
iFC depends on the IMS subscription, it will not be required in all
subscription scenarios.
6\. The S-CSCF forwards the message to the MSC Server based on the contact
address stored during registration, i.e. using standard S-CSCF procedures.
7\. The MSC Server initiates the paging and sends a setup message to the Party
B UE.
8\. The Party B UE accepts the request and sends a connect message to the MSC
Server.
9\. The MSC Server translates the connect message into a 200 OK and sends it
to the S-CSCF.
10\. The S-CSCF sends the 200 OK to the ADS.
11\. The S-CSCF sends the 200 OK to the I-CSCF.
12\. The I-CSCF sends the 200 OK to the Party A UE.
**Use case 2** : User is not registered in IMS, call is redirected to the CS
domain. This is considered a fallback solution to cover scenarios where the
VMSC cannot register the UE in IMS.
Figure 6.8a.2.3-2: Non ICS UE (not registered in IMS) termination
The Non-ICS UE IMS UE (not registered in IMS) termination is as follows:
1\. The Party A UE sends an INVITE request for initiating a voice session with
the Party B non ICS UE.
2\. The I-CSCF in the terminating home network performs Location Query
procedure with the HSS to acquire the S-CSCF address of Party B, according to
standard IMS procedures.
3\. The I-CSCF forwards the INVITE request to the S-CSCF.
4\. The S-CSCF invokes service control using unregistered iFC.
5\. The final iFC directs the INVITE to the access domain selection function.
The user is not registered in IMS but attached to the CS network, so breakout
to CS domain is chosen. A CSRN is fetched for routing to the CS domain.
6\. The INVITE is returned to the S-CSCF.
7\. The S-CSCF forwards the INVITE request to the BGCF. Termination of the
call to Party B then follows standard CS procedures.
#### 6.8a.2.4 Session Transfer
The following information flows illustrate session transfer scenarios
involving CS access in networks enhanced with enhanced MSC Server
capabilities.
Figure 6.8a.2.4-1 Session Transfer IMS to CS
1\. The VCC UE sends the Setup message towards the MSC with the VDN as the
called party number.
2\. The MSC Server initiates an INVITE towards the UE\'s home IMS, using
routing information obtained during IMS registration. The VDN is carried in
the Request-URI.
3\. Originating iFC results in the INVITE being routed to the DTF. The DTF
uses the VDN to recognize the INVITE request is for a session transfer and
correlates this session with the existing session for VCC user.
4\. The DTF function initiates Access Leg Update procedures towards the remote
endpoint.
5\. The DTF function initiates Source Access Leg Release procedures.
Figure 6.8a.2.4-2 Session Transfer CS to IMS
1\. The VCC UE registers with IMS, if not already registered. It subsequently
initiates an IMS originated session using a VDI.
2\. Once the INVITE is returned to the S-CSCF, originating iFC results in
routing of the IMS origination session to the DTF. The DTF detects the VDI and
associates this INVITE request with an existing dialog.
3\. The DTF function initiates Access Leg Update procedures towards the remote
endpoint using standard VCC procedures.
4\. The DTF function initiates Source Access Leg Release procedures using
standard VCC procedures.
### 6.8a.3 Originated Service Domain Selection for enhanced MSC server
One of the tasks of the enhanced MSC Server is to decide whether a particular
UE, which performs CS attach to the network, will receive services from CS
domain or from IMS. Hence the enhanced MSC server has to perform originated
Service Domain Selection (OSDS).
In order to perform OSDS, the enhanced MSC server needs to be able to
differentiate between:
\- Users which require enhanced MSC server functionality to receive services
from IMS.
\- Users which receive services from CS and which don\'t require enhanced MSC
server functionality.
For that purpose, the enhanced MSC server needs to know whether an attaching
user shall receive services from IMS and thus receive additional information
about the subscriber. Since this is subscriber related information, it is
stored in the HSS.
There are different candidate reference points which can be used by the
enhanced MSC server to perform the differentiation: -
\- MAP
\- Sh
\- Cx
\- I6 using SIP register
These options for O-SDS are discussed in more detail below.
**Option MAP:**
{width="6.675694444444445in" height="2.8756944444444446in"}
Figure 6.8a.3-1: ICS support flag in MAP
One possibility is to introduce a new flag into MAP Update Location to enable
ICS capability negotiation between VPLMN and HPLMN.
MSC/VLR sets this flag in MAP Update Location if MSC/VLR has the enhanced MSC
server capability as described in TR 23.892 and wishes to put corresponding
subscriber under ICS control.
NOTE 1: If the flag is not present then this would be a clear indication to
HSS that MSC/VLR does not support ICS.
HSS sets this flag in the Update Location response message If HSS recognizes
new flag from MSC/VLR (i.e. ICS capable HSS) and wishes to put corresponding
subscriber under ICS control. Note: if the flag is not present then this would
be a clear indication to MSC that HSS does not support ICS and that this user
will not require enhanced MSC server functionality. Based on the MAP
functionality, Pre-Rel‑8 HSS can ignore new introduced information element as
unknown so that there is no harm to pre-rel8 HSS even if new ICS flag is
received.
One other possibility is to introduce an indicator in the subscriber data
which would indicate to the enhanced MSC server that the subscriber requires
enhanced MSC server functionality. If the indicator is not present, then this
would be a clear indication to enhanced MSC server that the subscriber does
not require enhanced MSC server functionality. If the enhanced MSC server
functionality is not present in the MSC, then this indicator has to be ignored
(i.e. it should not cause unwanted behaviour).
**Option Sh:**
Prerequisites:
\- An ICS specific Temporary Public User Identity is provisioned based on the
IMSI (similar as to what is already defined in TS 23.003, but different in the
user and/or domain part so as not to clash with UE registrations).
NOTE 2: The Sh does not use the IMPI in the protocol today.
\- MSC-Server and HSS are in the same trust domain i.e. Sh is allowed. Note
that today use of Sh is not specifically defined between different operators
and so it _may_ be required that restrictions need to be added in order to
define what data is allowed to be sent to the visited operator. Of course, if
two operators are part of the same trust domain, such functionality could of
course be argued as unnecessary. Liaison with SA3 may be required here for
guidance.
\- MSC-Server must be able to find the address of the HSS to be contacted.
\- A flag indicating that the user requires ICS enhanced MSC Server
functionality is provisioned in the subscriber data.
The subscriber profile retrieval has to be performed for all users which are
attaching to the CS network via this MSC.
In order for the MSC-Server to be able to contact the correct HSS, the MSC-
Server will need to know, at the very least, the address/FQDN of an SLF. As
specified in TS 23.002, the MSC-Server could query the SLF to get the name of
the HSS containing the required subscriber specific data.
**Option Cx:**
Same as for Option Sh, except that the enhanced MSC-Server uses the Cx
interface.
**Option SIP Register:**
After performing successful location update procedures in the CS domain, the
enhanced MSC-Server determines this subscriber to be a potential IMS
subscriber and tries to register the user in IMS. IMS registration would only
succeed for IMS subscribers which have the IMPI in the IRS in the HSS used
during registration and fail otherwise. If the registration in IMS succeeds,
the enhanced MSC-Server continues to handle this subscriber as IMS subscriber.
The routing of the registration message is handled by standard IMS routing.
Note that if the enhanced MSC-Server uses a different IMPI/IMPU during
registration than the UE when doing IMS registration, the UE can be registered
in IMS in addition to the enhanced MSC-Server and thus negating the need for
support of IMS simultaneous registrations for the same IMPI/IMPU combination.
Whether or not there is a need to differentiate between ICS users which shall
only be handled by enhanced MSC-Server and ICS users which shall only use ICS
UE, is FFS. However, currently there are no requirements identified.
**Conclusions on Different Options:**
Overall, it can be concluded that the OSDS in the enhanced MSC server using a
MAP approach would have the benefit of re-using existing agreements between
two operators for the VLR to HLR/HSS interaction. On the other hand, the
drawback could be seen as impacting current MAP protocol and legacy equipment
such as the HLR. However, as clearly indicated, there would not be any
backwards compatibility issues with pre-Rel‑8 equipment.
The Sh option and Cx option provide the benefit of allowing the enhanced MSC
server to act as an AS or CSCF (respectively), re-using the existing Sh/Cx
interface protocols (the Cx might even require enhancements). One drawback is
that yet another interconnect interface must be used (in addition to existing
MAP and the required SIP interface) when the subscriber is roaming. There may
also be potential issues with allowing Sh and Cx between networks that are not
fully trusted. Where both networks are in the same trust domain, there is no
issue.
The SIP register approach does not require a new interconnect interface, but
instead tries to register appropriate subscribers in IMS and if this
registration succeeds, the user is identified to receive his services from the
IMS. Note that a pre-screening based on operator-policy in the enhanced MSC
server can be performed to limit the number of users for which registration in
IMS is tried.
Further on, SIP register can be used by enhanced MSC server to determine
whether the attaching user is an IMS subscriber or not.
It has been concluded that the SIP register approach would be the appropriate
way forward for the enhanced MSC server.
After performing successful location update procedures in the CS domain, the
MSC determines this subscriber to be a potential IMS subscriber and tries to
register the user in IMS. IMS registration would only succeed for IMS
subscribers and fail for CS only users. If the registration in IMS succeeds,
the MSC continues to handle this subscriber as IMS subscriber.
Editor\'s note 1: It is FFS how the MSC determines this subscriber to be a
potential IMS subscriber.
The routing of the registration message is handled by standard IMS routing.
Note that a pre-screening based on operator-policy in the enhanced MSC server
can be performed to limit the number of users for which registration in IMS is
tried.
Editor\'s note 2: Whether or not there is a need to differentiate between ICS
users which shall only be handled by enhanced MSC server and ICS users which
shall only use ICS UE is FFS.
### 6.8a.4 Co-existences of ICS UE and MSC Server approach
#### 6.8a.4.1 Use of IMSI-derived IMPU/IMPI by both ICS UE and enhanced MSC
Server
**Assumptions**
\- ICS UE has IMSI.
\- IMSI-derived T-IMPU-UE/T-IMPI-UE is used by ICS UE to register in IMS (no
ISIM).
\- IMSI-derived T-IMPU-N/T-IMPI-N is used by network function to register in
IMS.
NOTE: T-IMPU-UE/T-IMPI-UE is different from T-IMPU-N/T-IMPI-N.
Therefore this user has in his subscriber profile in the HSS the following
private IDs:
\- T-IMPI-UE (derived from IMSI).
\- T-IMPI-N (derived from IMSI).
The user has (at least) the following public IDs:
\- Tel-URI
\- SIP-URI
\- T-IMPU-UE (based on IMSI) -- barred
\- T-IMPU-N (based on IMSI) -- barred
These are grouped into Implicit Registration Set (IRS) as follows and as shown
in the following figure:
\- Implicit Registration Set:
\- T-IMPU-UE (based on IMSI).
\- T-IMPU-N (based on IMSI).
\- Tel-URI (based on MSISDN).
\- SIP-URI.
{width="5.689583333333333in" height="3.688888888888889in"}
Figure 6.8a.4.1-1: Implicit Registration Set - IMSI-derived IMPU/IMPI by both
ICS UE and enhanced MSC Server
Using this Implicit Registration Set configuration, the user can have
multiple, simultaneous registrations in CS and in PS as there will be
different IMPI/IMPU combinations from the enhanced MSC server and from the ICS
UE.
#### 6.8a.4.2 ISIM registered UE and enhanced MSC Server
Today, there are recommendations that suggest that if a UE includes both USIM
and ISIM, and registers in IMS, the ISIM shall be used.
**Assumptions:**
\- User has a UICC including both a USIM and an ISIM.
\- ICS UE uses credentials stored in ISIM for registration in IMS.
\- IMSI-derived T-IMPU-N/T-IMPI-N is used by network function to register in
IMS.
Therefore this user has in his subscriber profile in the HSS the following
private IDs:
\- IMPI (as stored on the ISIM)
\- T-IMPI-N (derived from IMSI)
The user has (at least) the following public IDs: -
\- Tel-URI
\- SIP-URI
\- T-IMPU-N (based on IMSI) -- barred
These are grouped into Implicit Registration Set as follows and as shown in
the following figure:
\- Implicit Registration Set:
\- T-IMPU-N (based on IMSI).
\- Tel-URI (based on MSISDN).
\- SIP-URI.
{width="5.689583333333333in" height="3.688888888888889in"}
Figure 6.8a.4.2-1: Implicit Registration Set - ISIM registered UE and enhanced
MSC Server
Using this Implicit Registration Set configuration, the user can have multiple
contacts with different IMPI/IMPU combinations from the enhanced MSC server,
and from a UE having an ISIM.
When the user is using a non-ICS UE, the enhanced MSC will be able to register
the user based on the network derived IMPU/IMPI (based on the IMSI).
If an ISIM registered UE is used and the user becomes registered through both
PS and CS, the IMS registration through PS can use the identities on ISIM
(i.e., identities not derived from the IMSI), while the CS registration is
based on the IMSI instead. The correlation between the CS and PS will be
possible then based on the shared public user identities (and in particular
that the IMSI derived identity belongs to the same Implicit Registration Set
as the ISIM IMPU).
#### 6.8a.4.3 Co-existence of ICCF and enhanced MSC server
The definition of non-ICS UE reveals that two classes of UEs are covered,
namely:
\- non-ICS UE with VCC capability (i.e., could be seen as a Rel‑7 UE); and
\- non-ICS UE without VCC capability (which could be any UE pre Rel‑7 or even
Rel‑7 UEs without VCC capability).
UEs without VCC capability are supported by the enhanced MSC server approach
without any doubt, but of course do not support domain transfer. UEs with VCC
Rel‑7 capability are supported as well, however, since the enhanced MSC server
is Rel‑8 functionality, also Rel‑8 VCC or even MMSC implementation will be
necessary, as it was always stated that changes to TS 23.206 are necessary.
Also it has been clarified that all limitations of VCC Rel‑7 especially with
regard to mid-call handling apply as well.
When now looking at ICS UEs, which have the possibility to use ICCC for
additional signalling, two possibilities can be differentiated for the
signalling between UE and CN:
A Both TS 24.008 [7] and ICCC are used:
A-1 enhanced MSC server + ICCF.
A-2 I1-cs termination in enhanced MSC server.
B Only TS 24.008 [7] is used.
It has to be noted that without ICCC the additional session transfer
capabilities especially regarding mid-call and support of subsequent calls as
under study in ICS will not be enabled.
Since it has been clarified in TR 23.893 [19] that MMSC users which use CS
access for media transmission are ICS users at the same time, no special
consideration for MMSC users must be given from an enhanced MSC server
perspective.
Obviously, in case A.1) the ICCF has to be used in order to support both I1-cs
and I1-ps. However, in case of an originated session, the ICCF would receive
from the enhanced MSC server an originated SIP INVITE, whereas it would
receive from the MGCF a terminated SIP INVITE. One advantage of A.1 is that
ICCF and enhanced MSC Server can evolve independently.
Since the USSD signalling for I1-cs is passing the enhanced MSC server anyway,
it is one option to terminate I1-cs in the enhanced MSC server; this case is
denoted as A.2 in the following. One advantage with A.2 is that USSD for I1-cs
does not need to be transported over the NNI. Support for I1-ps would still
require ICCF to be included in the signalling path. Note that A.2 could be
seen as a deployment option for I1-cs support.
In case B), when the UE is not using ICCC, then either we fall back to VCC Rel
7 limitations or additional functionality in the DTF is required. The DTF
would have to identify the active call and the call on hold, and in any case
not more than 2 calls are allowed in parallel for the same IMPU, making it
impossible to support concepts in which multiple UE share the same IMPU.
The following table summarize the above-provided analysis.
+----------------+----------------+----------------+----------------+ | **UE |** Signalling | **MMSC | ** | | Capability:** | between CN and | R | Limitations:**| | | UE;\ | equirements:** | | | | 24.008 always | | | | | via enhanced | | | | | MSC server** | | | +----------------+----------------+----------------+----------------+ | Pre‑Rel‑7 UE | 24.008 only | N/A | No Domain | | | | | Transfer | | | | | possible | +----------------+----------------+----------------+----------------+ | VCC (Rel‑7) UE | 24.008 only | \"Normal\" | VCC possible | | | | Rel‑8 | with MMSC with | | | | | its identified | | | | | limitations | +----------------+----------------+----------------+----------------+ | ICS & MMSC | A) 24.008 + | A) \"Normal\" | A) None | | (Rel‑8) UE | I1-cs | Rel‑8 | | | | | | | | | A.1) enhanced | | | | | MSC server + | | | | | I1-cs | | | | | termination in | | | | | ICCF | | | | | | | | | | A.2) I1-cs | | | | | termination in | | | | | enhanced MSC | | | | | server | | | +----------------+----------------+----------------+----------------+ | | B) 24.008 | B) DTF needs | B) only 2 | | | only | to identify | calls for the | | | | the active | same IMPU (1 | | | | call. | active, 1 | | | | | hold) | +----------------+----------------+----------------+----------------+
Case B) is limited compared to Case A, but Case B can support VCC Rel‑7
behaviour. In order to support more than Rel‑7 behaviour, case A) needs to be
considered. Case A) is also covering the case in which an operator wants to
deploy both support for ICS UE and non ICS UE in one PLMN. This combination
would also enable to easily fallback from ICS UE capability to enhanced MSC
server support in case of SIM swapping between ICS UE and a non-ICS UE.
### 6.8a.5 Subscription to the registration event package
After successful initial IMS registration on behalf of the UE, the eMSC-S
shall be able to subscribe to the registration event package as described in
RFC 3680 [16]. The eMSC-S shall automatically refresh this subscription as
necessary.
The actions taken by the eMSC-S upon receiving a network-initiated
deregistration indication from IMS should be consistent with UE handling as
described in TS 24.229 [6].
Network-initiated deregistration from IMS shall only affect the status of the
UE\'s registration in IMS, it shall not impact CS registration status.
In the event that IMS re-registration is not performed, fallback mechanisms as
documented in clause 6.20.1 shall be utilized for centralization of services
in IMS for non ICS UE.
## 6.9 CAMEL redirection of CS call to IMS
### 6.9.1 Call origination using CAMEL redirection of CS call to IMS
For non-ICS UE and as an option for each of the above ICCC solutions, initial
call origination can be implemented using CAMEL triggers to re-route the first
ICS call towards the ICCF. Figure 6.9.1-1 provides an example flow for a call
made by an ICS UE‑A to the other end B using CAMEL to redirect the CS calls to
IMS, with AS approach of RUA of ICCF implementation.
Figure 6.9.1-1: ICS origination: CAMEL Redirection to IMS
1\. ICS UE‑A initiates a call to user B. The ICS UE initiates standard CS
procedures for establishing a CS originated call.
2\. Standard VMSC procedure for CS origination. CAMEL origination triggers are
used at the VMSC to reroute the call to RUA of ICCF by retrieving an IMRN
which is allocated as part of the CAMEL origination trigger processing as
described in TS 23.206 clause 6.2.2.2.
Editor\'s Note 1: How Line ID services (e.g. temp OIR) are executed when using
CS call control for initial session setup is FFS.
Editor\'s Note 2: The relationship and inter-working with VCC is FFS.
3\. Standard MGCF procedure for PSTN origination.
4\. Standard CSCF procedure for PSI termination.
5\. The RUA of the ICCF invokes a B2BUA, terminating the UE Leg and the other
originating the RUA Leg for presentation of IMS session toward other end B on
behalf of ICS UE‑A.
6\. Standard IMS originated session processing at the CSCF.
Editor\'s Note 3: If subsequent call/service control uses SIP via I1-ps, both
parties must be able to establish the PS session control signalling in the
call setup phase and in middle of the voice call when the service needs to be
invoked. How to associate the existing CS bearer with the subsequent control
signalling sent via I1-ps is FFS.
### 6.9.2 Use of CS call control procedures for first session setup, CAMEL
used to redirect CS calls to IMS
For each of the ICCC based ICS solutions, it is also possible to use standard
CS call control procedures for setup of the first UE session with CAMEL used
for redirection of the first user session to IMS. In this case, the ICCC is
used for subsequent session set up and control of mid call services. SIP is
used with the RUA providing SIP UA behaviour on behalf of the UE for control
of all user sessions. The Bearer Control Signalling path is established
between the UE and the RUA by redirecting the CS call toward the RUA using CS
redirection techniques such as the CAMEL origination triggers.
If a supplementary service needs to be invoked for the first user session, the
UE uses ICCC to control the service related to the first session. The UE uses
the ICCC for establishment and service control of the second user voice
session. CS call setup procedures are not used for establishment of subsequent
user sessions or invocation of mid-call voice services. The RUA maintains the
SIP/SDP state machine. Upon Domain Transfer, the service state is released in
the UE. The RUA is therefore inserted in the session path for IMS sessions
established for a dual mode UE for synchronization of service data post Domain
Transfer to CS when using this model.
Call based (temporary) line identification services shall be provided as
assisted by CS domain with this model.
Editor\'s Note: The need for distributed service configuration for some
Supplementary Services e.g. Line ID services with this model is FFS.
## 6.9a Deriving ICS specific IMPI/IMPU
For an ICS UE or a non-ICS UE, when it has no ISIM but USIM and performs a
registration via PS access and when the network performs another registration
on behalf of the UE, they may use the same IMPI and IMPU derived from the
IMSI, resulting in different Contact for each registration. This is the reason
why multiple registration support is needed in this case. Multiple
registration support will be available in 3GPP R8 also due to other
requirements (e.g. MMSC), still an alternative solution would be desirable if
it does not rely on multiple registration support. The following describes
such an alternative. Such a solution for enhanced MSC Server approach has been
elaborated in clause 6.8a.4.
Instead of using the same IMPI/IMPU derived from the IMSI as the UE, the
network should use different IMPI and IMPU derived from the IMSI when it
performs registration on behalf of the UE (see also clause 6.8a.4.1) Such as
\\@ics.mnc\.mcc\.3gppnetwork.org is used by the network while
the UE uses \\@ims.mnc\.mcc\.3gppnetwork.org as the IMPI in
the REGISTER message, according to the rules in TS 23.003. How the format is
exactly defined is stage 3 issue. And these two pairs of IMPI/IMPU shall
belong to the same implicit registration set, and the two temporary IMPUs
should be barred for SIP non-registration procedures, as indicated in TS
23.228 [4]. This would make a solution independent on multiple registration
function, while it works the same in all the other aspects.
## 6.10 Requirements on ICCP when using CS access
### 6.10.1 General
ICCP is used within the context of the I1-cs architectural alternatives to
support ICS enabled clients receiving IMS services over a CS access. It needs
to be transported within USSD, and as such it provides a singular transport
solution for all GSM/UMTS CS access networks with an ICS enabled UE.
### 6.10.2 ICCP functional requirements
\- The ICCP shall support an ICS capable UE to perform presentation services
like OIP and TIP if needed to present SIP URI.
\- The ICCP shall support the mid-call handling capabilities, such as call
hold, resume, etc.
\- The ICCP shall support an ICS capable UE (if it is necessary) to identify
and request the individual call for service execution, e.g. to identify the
call to be transferred.
\- The ICCP may support an ICS capable UE to perform communication services
setting modifications.
NOTE: Identification of an individual call is necessary if the ICCF is not
involved in the path over PS access.
Editor\'s note: Whether or not additional ICCP functional requirements are
needed for initial registration, re-registration and de-registration, for call
initiation, for domain transfer and for call identification is FFS.
### 6.10.3 ICCP Non-functional requirements
\- The number of bytes required to transfer the ICCP must be minimized so that
it can fit with a single USSD where possible.
\- The processing to be performed over ICCP must be minimized so that no
noticeable latency in call set up vs. a normal CS call is to be experienced by
end-users.
## 6.11 Media Handling
In the architecture alternatives described, the ICCF provides SIP UA behaviour
on behalf of the UE towards IMS, and thereof controls all subsequent session
set up and mid call services. To achieve this, the ICCF needs not only handle
the session control signalling but also control the media accordingly, as
it\'s the only entity besides ICS UE who owns the knowledge of the ongoing
sessions. For example, for holding an existing session at mid call and
subsequently originating a new session, The ICCF has to give instruction to
toggle between the sessions and direct the media to correct destination.
During mid call service Hold, according to TS 26.114, RTCP packets should be
sent continuously as \"remote end-point aliveness information\" to the held
remote end. Meanwhile if UE originates a new session towards another remote
end, a new media path would be needed from the UE to the new remote end. In
this case ICCF can utilize MRFC/MRFP to handle both media paths. MRFC/MRFP can
be either linked in statically or dynamically.
The conclusion is to link in MRFC/MRFP dynamically.
Editor\'s Note: how MRFC/MRFP is invoked from ICCF is FFS.
## 6.12 ICS Data Management
### 6.12.0 Introduction
ICS presents situations where the subscriber may use either the CS or IMS
domain, for instance, to set a call forwarding value. Note that the services
are centralized in IMS, so the call forwarding is a service provided by IMS.
The following sections detail solutions which allow this to be done.
ICS presents situations where the CS and IMS network must share service
information. This allows a subscriber to use either domain, for instance, to
set a call forwarding value. The following sections detail solutions which
allow this to be done.
If the service sets between IMS and CS domains need to be aligned, then the
service set in IMS has to be limited to the CS telephony supplementary service
set and vice versa, since there are services in IMS which cannot be mapped to
existing CS supplementary services and since there are CS supplementary
services which are not defined in IMS. . All of the solution alternatives
shall consider only TS11 applicable supplementary services and shall exclude
services that do not have a corresponding service in MMTel (e.g. BOIC and BIC
when roaming).
The following sub-clauses discuss the alternatives for ICS Data Management.
NOTE: The following rules are independent whether the operator uses the
enhanced MSC solution, the ICS UE solution or a combination of both. The
following alternatives apply regardless of the conclusion on which entity
should perform the settings conversion between MMTel and CS telephony
supplementary services.
### 6.12.1 Alternative 1: Different data models are not allowed under the same
subscription
Alternative 1 is illustrated in the figure below:
{width="5.636805555555555in" height="2.316666666666667in"}
Figure 6.12.1-1: Alternative 1
In this alternative, it is not allowed to use the same subscription with an
ICS UE (MMTel UE) and a non ICS UE (non MMTel UE):
\- A user needs to use two separate subscriptions when using an ICS UE and a
non ICS UE, or
\- The operator needs to restrict MMTel service for all users.
Both ensure that the service setting modification requests can always be
converted back and forth between the end user\'s device and network.
This alternative does not require any standardization work.
### 6.12.2 Alternative 2: One-time upgrade
Alternative 2 is illustrated in the figure below.
{width="6.2652777777777775in" height="4.300694444444445in"}
Figure 6.12.2-1: Alternative 2
For clarity reasons the User-2 is not shown in the figure, but the one-time
upgrade is performed per subscriber, i.e. User-2 may continue to use CS
telephony supplementary service data model while User-1 has been upgraded to
use MMTel data model.
In this alternative, it is allowed to use the same subscription with an ICS UE
(MMTel) and a non ICS UE (non MMTel UE) with the following restrictions:
\- A user who uses a non ICS UE (non MMTel UE) only and has not used an ICS UE
(MMTel UE) under the same subscription, uses the CS telephony supplementary
service data model, and the service data conversion between CS domain and IMS
is therefore possible.
\- A user who begins to use the MMTel service data model (e.g. takes an MMTel
UE into use under the same subscription), results in the behaviour that the
settings in IMS may not be able to be converted from/to CS domain. For this
reason, the network stores a subscriber specific flag that indicates which
data model is in use. When the operator switches the user to the MMTel service
data model, the operator sets the flag to indicate that MMTel service data
model is in use, and from now on the network needs to block the CS telephony
supplementary service setting commands from the UE. At the time of upgrade to
MMTel service model, the operator must also instruct the end user not to use
the CS telephony supplementary service settings UI anymore, but to use either
an MMTel settings UI in the MMTel UE, or other access to the MMTel settings
the operator may provide. This upgrade from CS telephony supplementary service
data model to MMTel data model is performed only once per subscriber. The
actual trigger for the upgrade does not need to be standardized.
Editor\'s Note: It is FFS what is the mechanism to block the CS telephony
supplementary service setting commands in the network. At least blocking the
SS commands in HLR or use of CAMEL service may be considered. This may depend
on the decision which entity is responsible to convert the settings between CS
telephony supplementary services and MMTel.
\- In order to access the MMTel service settings from non MMTel UE after the
upgrade, the operator may provide e.g. a Ut service settings client
implemented in J2ME application, SIM toolkit application, or WAP/web page.
Such client may be pushed to the non MMTel UE at the point of upgrade, with
the instructions to the end user how to use them. It is up to the operator to
decide what kind of mechanism is provided to its user to access the MMTel
service settings. It also depends on the legacy UE, what kind of means it
supports. This will not be standardized.
NOTE: The drawback of this alternative is that the CS telephony supplementary
service settings UI cannot be used after the one-time upgrade to MMTel
services.
### 6.12.3 Alternative 3: Convert the settings whenever possible
Alternative 3 is illustrated in the figure below.
{width="6.138194444444444in" height="3.8375in"}
Figure 6.12.3-1: Alternative 3
In this alternative it is allowed to use the same subscription with an ICS UE
(MMTel) and a non ICS UE (non MMTel UE) with the following restrictions:
\- The service settings are converted between CS domain and IMS whenever the
settings data in IMS allows it.
\- Whenever the user submits a service data to MMTel settings that is not
possible to convert to CS domain, the conversion is not performed. If the end
user now tries to retrieve the service settings in CS while using a legacy UE,
the network returns a \"network error\" indication to the user. Thus the end
user may not be able to know the reason why the settings are not available.
The end user might not even try to modify the settings after such network
error. But if the end user anyhow now tries to modify the settings (e.g.
activate the CFU), there are two alternatives; either the network replaces the
corresponding settings in the current MMTel settings with the new value, or
the network blocks the modification which cannot be unambiguously mapped to
the current MMTel settings.
Editor\'s Note: It is FFS whether the conversion and replacement functions
should be standardized, or left implementation specific.
\- Whenever the user modifies the MMTel service settings such that they can be
converted to CS telephony supplementary service settings again, the user is
able to use a legacy UE for retrieving and modifying service settings.
NOTE: This alternative would lead to inconsistent user experience, because
retrieving/modifying the services from the legacy UE works in some cases and
in some cases not. The user may not be aware why the service settings
occasionally are not available to the legacy UE.
### 6.12.4 Option: Limited MMTel Service Set
A possible complementary to the alternatives above would be to standardize an
XML schema for a subset of MMTel service set equal to CS telephony
supplementary service set. The settings from a UE that implements the support
for this schema can be converted back and forth with CS telephony
supplementary service settings. A limited version of MMTel implemented in the
UE ensures an access to the service settings of the CS telephony supplementary
service model over the Ut reference point.
### 6.12.5 Non-transparent data solution alternative
This solution proposes to extend the Sh interface to allow an IMS AS to
request CS information.
Currently, the Sh interface supports transferring service data to IMS AS, but
it does not support transferring CS service data to IMS AS. The IMS AS cannot
update the CS service data in HLR/HSS either. This solution extends the Sh
interface to support this functionality.
{width="5.988194444444445in" height="2.8430555555555554in"}
Figure 6.12.1-1: Non-transparent data solution
The following extensions for the Sh interface are necessary:
\- Add a new data Ref value in the Sh-Subscribe message allowing the IMS AS to
subscribe the CS service data change in HSS/HLR;
\- Add a new data Ref value in the Sh-Update message used when IMS AS changes
CS service data.
Once the Sh interface is modified, the HSS/HLR can use the information flow
shown in Figure 6.12.1-2 to change the CS service data stored in IMS AS
Figure 6.12.1-2: Using extended Sh interface for IMS AS to subscribe CS
supplementary data change in HSS/HLR
The IMS AS can also use the modified Sh interface to modify the CS service
data stored in HSS/HLR as shown in the flow of Figure 6.12.1-3.
Figure 6.12.1-3: Using extended Sh interface to transfer CS supplementary data
from IMS AS to HSS/HLR
**Overall, this alternative has the disadvantage of requiring modifications to
extend the Sh interface. However, the solution also has the following
benefits:**
\- The extended Sh interface can be shared by other Application Servers.
\- This approach maintains the integrity of the principle of transparent data.
Since the CS related data is a new data type, it is not considered transparent
data. The HSS/HLR would be expected to define and use this information, as
opposed to transparent data which the HSS is not supposed to understand or
modify.
NOTE: The definition of XML data structure used in Sh message and the detail
of the new added data reference value needs stage 3 work.
### 6.12.6 Transparent data solution alternative
This second solution allows the Sh interface to remain the same, but violates
the principle that the HSS not understand or modify any of the transparent
data. This solution has the HSS/HLR create a copy of the CS service data but
in a format which is more suitable as transparent data (e.g. XML). The HSS/HLR
and any Application Servers can use and share this particular file of
transparent data using current Sh interface message without any extensions.
This approach is shown in Figure 6.12.2-1.
Figure 6.12.2-1: Transparent data solution
In this solution, HSS/HLR converts the CS service data to the related
transparent data and back again as needed. The HSS/HLR needs to be aware of
the data structure of this specific transparent data file, and continues to be
ignorant of all the other transparent data files. However, it does violates
the principle that HSS/HLR is not aware of any of the transparent data
structures.
Figure 6.12.2-2 shows how this would work when the UE modifies the service
data via the IMS AS. The IMS AS is assumed to have a current copy of the
service data. The UE\'s modification of this data is made in the AS, and then
sent via an Sh update to the specific transparent data file known to the HSS.
The HSS will acknowledge this transfer in Step 3, and then copy any changes
from the transparent data file to the CS copy of the file.
{width="5.03125in" height="3.03125in"}
Figure 6.12.2-2: Information flow for IMS AS changes HSS/HLR\'s CS service
data
This approach also supports changes made by the CS network in much the same
way as the first alternative. The messaging for a CS based change is shown in
Figure 6.12.2-3.
Figure 6.12.2-3: Information flow for HSS/HLR updates IMS AS\'s CS service
data
The HSS/HLR will copy the CS changes to the transparent data before it
notifies IMS AS in Step 4.
The advantage of this alternative is the Sh interface can be used without
modification. However the HSS will be violating the principle that the HSS
does not understand or use the contents of any transparent data file.
Editor\'s Note: Whether New Data Service Indication value needs to be added in
Sh-Subscribe and Sh-Notification message is FFS.
NOTE 1: Data synchronization between these two copies of data is
implementation specific.
NOTE 2: The definition of XML data structure need stage 3\'s work.
### 6.12.7 Data validation discussion
HLR already has the functionality for CS service data\'s validation. Both of
the proposed solutions can reuse this part of functionality if the rules for
the data validation do not change when the service is moved to IMS.
It is possible that the data validation rules will change, and this opens the
question of whether the HLR/HSS is modified to support the new rules, or if
the IMS AS does the data checking. In cases where the IMS AS is now used to
check the data, the CS transactions will need to send the data to the IMS AS
first before the CS transaction completes. If the IMS AS accepts the data as
provided, the CS transaction can complete successfully. If the IMS AS rejects
the data, then the CS transaction will complete with a failure.
The IMS AS modifications via the Ut interface has a similar issue if the HSS
does the data validation. The data will need to be sent to the HSS to
determine if the settings are allowed, and the IMS AS will need to check to
see the HSS data transaction completes successfully before it completes the
transaction to the UE over the Ut interface. The procedures used in order to
have either the HSS or the IMS AS approve the data is FFS.
## 6.13 Service Support for ICS UE, using I1-ps and I1-cs approach, ICCC for
call setup
### 6.13.1 Line ID Services (OIP, OIR, TIP, TIR)
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS. ICCC is used for communication of Line ID
information between the IMS and the UE for IMS sessions using CS voice media.
### 6.13.2 Communication Diversion Services
#### 6.13.2.1 Communication Diversion services exclusively controlled in home
IMS (CFU, CFNL)
With the ICCF providing the SIP UA behaviour on behalf of the ICS UE, these
services are provided in IMS.
#### 6.13.2.2 Communication Diversion services requiring participation of
serving network (CFNRy, CFNRc and CFB)
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS. ICCC may be used for indication of the
service triggers to IMS, another option is use of Release cause code generated
by the CS network nodes. In addition, CFNRc can be triggered by using the MAP
failure code response generated by the CS network nodes.
##### 6.13.2.2.1 Communication Forwarding on mobile subscriber not reachable
(CFNRc) over I1-CS
##### 6.13.2.2.1.1 CFNRc for no paging response {#cfnrc-for-no-paging-response
.H6}
Figure 6.13.2.2.1.1-1: CFNRc for no paging response over I1-cs
1\. An incoming SIP INVITE is received at the S-CSCF of the B party.
2\. The S-CSCF forwards the INVITE to the TAS and ICCF.
3\. The ICCF (acting as a B2BUA) sends a MAP request to HSS and the HSS
forwards the MAP request to the VMSC.
4\. VMSC sends page message to UE‑B.
5\. No response to the page message, VMSC determines that the UE‑B is not
reachable.
6\. VMSC sends a MAP Error message to ICCF, with the absent subscriber failure
code.
7\. ICCF converts the MAP Error message into SIP response with unreachable
indication according to the failure code, and sends the SIP message to TAS via
S-CSCF.
8\. According the SIP message and service profile data, TAS executes the CFNRc
logic.
##### 6.13.2.2.1.2 CFNRc for the IMSI detach {#cfnrc-for-the-imsi-detach .H6}
Figure 6.13.2.2.1.2-1: CFNRc for the IMSI detach over I1-cs
1\. An incoming SIP INVITE is received at the S-CSCF of the B party.
2\. The S-CSCF forwards the INVITE to the TAS and ICCF.
3\. The ICCF (acting as a B2BUA) sends a MAP request to the HSS and the HSS
forwards the MAP request to the VMSC.
If the subscriber absent information is already known by HSS, HSS will send a
MAP error message with the absent subscriber failure code to the ICCF
directly. Then the call flow will skip to step 6.
4\. VMSC gets the subscriber \'IMSI detach\' from the subscriber data of VLR.
5\. VMSC sends a MAP Error message to ICCF, with the absent subscriber failure
code.
6\. ICCF converts the MAP Error message to a SIP response with unreachable
indication according to the failure code, and sends the SIP message to TAS via
S-CSCF.
7\. TAS executes the CFNRc logic.
##### 6.13.2.2.2 Communication Forwarding on Busy User (CFB)
##### 6.13.2.2.2.1 Communication Forwarding on Busy User (CFB) over I1-cs
{#communication-forwarding-on-busy-user-cfb-over-i1-cs .H6}
Figure 6.13.2.2.3.1-1: CFB Service over I1-cs
1\. An incoming SIP INVITE is received at the S-CSCF of the B party from the A
party.
2\. The S-CSCF forwards the INVITE to the TAS and ICCF.
3\. The ICCF sends an incoming Call Request in USSD message to the VMSC over
I1-cs.
4\. The VMSC forwards the USSD message to B party.
5\. After UE‑B alerting, it rejects this call due to busyness, and sends UDUB
(User Determined User Busy) in a USSD message to the VMSC.
6\. The VMSC forwards this USSD message to the ICCF.
7\. The ICCF creates SIP 486 expressing B party is busy, and sends the SIP 486
to the TAS via the CSCF.
8\. The TAS processes the SIP 486 and executes the CFB logic.
##### 6.13.2.2.2.2 Communication Forwarding on Busy User (CFB) over I1-ps
{#communication-forwarding-on-busy-user-cfb-over-i1-ps .H6}
The CFB call flow over I1-ps follows the procedures specified in ETSI TS 183
004 [A1.4].
### 6.13.3 Communication Deflection
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS. ICCC is used for indication of the service
triggers to IMS.
#### 6.13.3.1 Communication Deflection (CD) over I1-cs
Figure 6.13.3.1-1: CD Service over I1-cs
1\. An incoming SIP INVITE is received at the S-CSCF of the B party from the A
party.
2\. The S-CSCF forwards the INVITE to the TAS and ICCF.
3\. The ICCF sends an incoming Call Request in USSD message to the VMSC over
I1-cs.
4\. The VMSC forwards the USSD message to B party.
5\. After UE‑B alerting, it sends CD request with C party number in USSD
message to the ICCF.
6\. The VMSC forwards the USSD message to the ICCF.
7\. The ICCF converts the Communication Deflection request into SIP 302 which
contains SIP or Tel URI of C party. Then the ICCF sends SIP 302 to the TAS via
the CSCF.
8\. The TAS executes the Communication Deflection logic.
#### 6.13.3.2 Communication Deflection (CD) over I1-ps
The CD call flow over I1-ps follows the procedures specified in ETSI TS 183
004[A1.2].
### 6.13.4 Communication Barring
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS.
### 6.13.5 Mid call services (Communication Hold, CW, Conf, Communication
Transfer)
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS. ICCC is used for communication of service
control signalling between the IMS and the UE for IMS sessions using CS voice
media.
### 6.13.6 Session continuity
The Voice Call Continuity for ICS UEs capable of VCC is based on TS 23.206.
The session continuity of ICS video call would require DTF to be enhanced with
capability of anchoring multimedia call which is under study in MMSC WI . TS
23.206 modification are required.
### 6.13.7 User configuration of Supplementary Services
Service data management and control of user configuration of services data is
provided by IMS.
### 6.13.8 Serving Domain Considerations
Table 6.13.8-1 below provides recommendation for serving domain for the
services discussed in this clause:
Table 6.13.8-1: Service set for ICS UE with I1-ps and I1-cs, use of ICCC
* * *
Service Capability Serving Domain **Supplementary Services**  
Originating Identification Presentation IMS Originating Identification
Restriction IMS Terminating Identification Presentation IMS Terminating
Identification Restriction IMS Communication Diversion (CFU, CFNL) IMS
Communication Diversion (CFNR, CFB) IMS Communication Deflection IMS Call Wait
IMS Communication Hold IMS Communication Barring IMS Conference IMS Explicit
Communication Transfer IMS
**Service Continuity **  
Basic Service Continuity IMS^1^ Service Continuity on non mid call services
IMS^1^ Service Continuity with mid call services IMS^1^
**Other capabilities**  
Call Independent Supplementary Services Operations IMS ^1^ Applicable to ICS
UEs capable of VCC.
* * *
## 6.14 Service Support for ICS UE using I1-cs approach, CS call control with
CAMEL for call setup
When using the I1-cs approach with CS call setup for ICS UEs, the ICCF
provides a SIP UA behaviour on behalf of the ICS UE for CS sessions
established using standard CS procedures, and redirected to IMS using
techniques similar to the procedures defined for VCC in TS 23.206. Since the
solution uses standard CS procedures for sessions established over CS access,
it is limited in its service offering as discussed below.
### 6.14.1 Line ID Services (OIP, OIR, TIP, TIR)
Since standard session setup procedures are used to establish the ICS UE
sessions, with the VMSC controlling session origination and session delivery
from/to the ICS UEs, Line ID services configuration in the HLR component of
the HSS for appropriate service execution at the VMSC is required. Some
control of these services may also be provided in IMS with the use of ICCC.
### 6.14.2 Communication Diversion Services
#### 6.14.2.1 Communication Diversion services exclusively controlled in home
IMS (CFU, CFNL, CFNRy, CFNRc)
With the ICCF providing the SIP UA behaviour on behalf of the ICS UE, these
services are provided in IMS.
Editor\'s note: It is FFS how CFNR is provided in IMS.
##### 6.14.2.1.1 Communication Forwarding Unconditional (CFU)
Incoming call will be redirected to the pre-configured target by TAS if the
CFU service has been actived. This service is independent of the access
network type used.
##### 6.14.2.1.2 Communication Forwarding on Not Logged-in (CFNL)
Editor Note: CFNL will depend on the result of CS registration discussion, and
it is regardless of the implement of ICS termination.
##### 6.14.2.1.3 Communication Forwarding on Subscriber Not Reachable (CFNRc)
Figure 6.14.2.1.3-1: CFNRc Service
1\. An incoming SIP INVITE is received at the S-CSCF of the B party.
2-4. The S-CSCF forwards the INVITE to the TAS and ICCF.
5-7. The ICCF generates an INVITE to the UE‑B via CS domain.
8-9. An ISUP RELEASE with cause \"unreachable\" will be return from CS CN
while the subscriber is unreachable.\ The cause will be #18(no user
responding) when fail to paging UE‑B or #20(subscriber absent) when MSC got
SRI response with \"subscriber absent\" from HLR.
10-12. The RELEASE message will be convert to SIP response with unreachable
indication by MGCF and forwards to TAS for execute CFNRc service logic.
NOTE 1: The release cause return from CS-CN in step-9 will be #18(no user
responding) when fail to paging UE‑B or #20(subscriber absent) when MSC got
SRI response with \"subscriber absent\" from HLR. According TS 29.163 [18],
MGCF will map to SIP 480 for ISUP REL with #18(no user
responding)/#20(subscriber absent) and #19 (no answer from the user)/#21(call
rejected).
In TISPAN WI03075 ETSI TS 183 004, TAS will execute CFNRc service if the
response message is 408(Request timeout), 503(Service unavailable) or
500(Server internal error).
So TAS can\'t distinguish the really release cause from the response SIP
message. There may be some possible mechanisms to resolve this problem: 1)
ICCF checks the call session\'s state and then convert SIP 480 to the correct
SIP response. 2) TAS checks the call session\'s state and then executes the
correct service logic. 3) MGCF separate SIP response by CS release cause.
Which mechanisms will be recommended for standardization is stage 3 work.
NOTE 2: Option 2 needs special TAS treatment.
NOTE 3: Option 3 requires MGCF upgrade to Rel‑8.
##### 6.14.2.1.4 Communication Forwarding on No Reply (CFNRy)
Figure 6.14.2.1.4-1: CFNRy Service
This call flow applies for both the I1-cs and the I1-ps approach.
1\. An incoming SIP INVITE is received at the S-CSCF of the B party.
2-4. The S-CSCF forwards the INVITE to the TAS and ICCF.
5-8. The ICCF generates an INVITE to the UE‑B via CS domain. If the message is
to be routed to CS, the IMS entity (e.g. in case the ICCF sends the SRI
message to get the MSRN towards the HLR) will insert the indication to the SRI
message in order to suppress the announcement in the MSC if the call cannot be
successfully established later.
9-14. The UE‑B sends back an ALERTING indication.
15-17. When got an alerting from UE‑B, TAS would start the non-reply timer,
and forwards SIP 180 to next hop.
18\. After ALERTING, UE‑B has not any other requests or responses, so the non-
reply timer in TAS would not be stopped until expired, and CFNRy service will
be triggered.
19-23. The TAS executes CFNRy logic, sends an 181 SIP message to remote
original caller party to indicate that call is forwarding, cancels the call
establishing with UE‑B, and redirects the call to pre-configured target like
UE‑C or voice mail.
NOTE 1: Within the MSC there should be no MT CAMEL trigger for \"No Answer\"
and \"Busy\" configured.
NOTE 2: In case the timer expires and the MSC does not play an announcement,
the MSC should at least release the call.
#### 6.14.2.2 Communication Diversion services requiring participation of
serving network (CFB)
Some control of these services may be provided in IMS. Since standard session
setup procedures are used to establish the ICS UE sessions, with the VMSC
controlling session origination and session delivery from/to the ICS UEs, some
specific functions may also required at the VMSC.
Figure 6.14.2.2-1: CFB Service
This call flow applies for both the I1-cs and the I1-ps approach.
1\. An incoming SIP INVITE is received at the S-CSCF of the B party.
2-4. The S-CSCF forwards the INVITE to the TAS and ICCF.
5-8. The ICCF generates an INVITE to the UE‑B via CS domain. If the message is
to be routed to CS, the IMS entity (e.g. in case the ICCF sends the SRI
message to get the MSRN towards the HLR) will insert the indication to the SRI
message to suppress the announcement in the MSC if the call cannot be
successfully established later.
9-10. The UE‑B disconnects the call and returns a cause: UDUB, then the MSC
will release the incoming call with a cause \"User Busy\" in RELEASE message.
11\. MGCF will convert the RELEASE message with failure cause \"User
Busy\"(#17) to a 486(Busy Here) SIP message and forwards to next hop.
12-14. The 486 Busy Here SIP response will be returned to TAS finally, and the
CFB logic would be executed by the TAS.
NOTE: In case the timer expires and the MSC does not play an announcement, the
MSC should at least release the call.
### 6.14.3 Communication Deflection
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS. ICCC is used for indication of the service
triggers to IMS.
### 6.14.4 Communication Barring
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS.
### 6.14.5 Mid call services (Communication Hold, CW, Conf, Communication
Transfer)
With the RUA of the ICCF providing SIP UA behaviour on behalf of the ICS UE,
these services are provided in IMS. ICCC is used for communication of service
control signalling between the IMS and the UE for IMS sessions using CS voice
media.
### 6.14.6 Session continuity
The Voice Call Continuity for ICS UEs capable of VCC is based on TS 23.206.
The session continuity of ICS video call would require DTF to be enhanced with
capability of anchoring multimedia call which is under study in MMSC WI . TS
23.206 modification are required.
### 6.14.7 User configuration of Supplementary Services
Service data management and control of user configuration of services data is
provided by the IMS for services controlled in IMS and by the CS domain for
services controlled in CS domain.
### 6.14.8 Serving Domain Considerations
Table 6.14.8-1 below provides recommendation for serving domain for the
services discussed in this clause:
Table 6.14.8-1: Service set for ICS UE with and I1-cs, use of CAMEL
+----------------------------------------------------+----------------+ | Service Capability | Serving Domain | +----------------------------------------------------+----------------+ | **Supplementary Services** | | +----------------------------------------------------+----------------+ | Originating Identification Presentation | IMS^1^ | +----------------------------------------------------+----------------+ | Originating Identification Restriction | IMS^1^ | +----------------------------------------------------+----------------+ | Terminating Identification Presentation | IMS^1^ | +----------------------------------------------------+----------------+ | Terminating Identification Restriction | IMS^1^ | +----------------------------------------------------+----------------+ | Communication Diversion (CFU, CFNL, CFNR) | IMS | +----------------------------------------------------+----------------+ | Communication Diversion (CFB) | IMS^2^ | +----------------------------------------------------+----------------+ | Communication Deflection | IMS | +----------------------------------------------------+----------------+ | Call Wait | IMS | +----------------------------------------------------+----------------+ | Communication Hold | IMS | +----------------------------------------------------+----------------+ | Communication Barring | IMS | +----------------------------------------------------+----------------+ | Conference | IMS | +----------------------------------------------------+----------------+ | Explicit Communication Transfer | IMS | +----------------------------------------------------+----------------+ | | | +----------------------------------------------------+----------------+ | ** Service Continuity ** | | +----------------------------------------------------+----------------+ | Basic Service Continuity | IMS^3^ | +----------------------------------------------------+----------------+ | Service Continuity on non mid call services | IMS^3^ | +----------------------------------------------------+----------------+ | Service Continuity with mid call services | IMS^3^ | +----------------------------------------------------+----------------+ | | | +----------------------------------------------------+----------------+ | **Other capabilities** | | +----------------------------------------------------+----------------+ | Call Independent Supplementary Services Operations | IMS/CS^4^ | +----------------------------------------------------+----------------+ | ^1^ Exclusive control in IMS of this service is | | | not possible, configuration of the CS domain | | | service is required. May require ICCC for control | | | of service in IMS. | | | | | | ^2^ Some specific VMSC functions may be required | | | such as use of VT-CSI or ISUP Release cause. The | | | exact mechanism is FFS. | | | | | | ^3^ Applicable to ICS UEs capable of VCC. | | | | | | ^4^ Service data management provided by the IMS | | | for services controlled in IMS and by CS domain | | | for services controlled in CS domain. | | +----------------------------------------------------+----------------+
## 6.15 Domain selection function to ICS
### 6.15.1 Access Domain Selection (ADS)
#### 6.15.1.1 ADS for terminating sessions (TADS)
When TADS-IMS selects the IMS access (e.g. selected I1-ps or just using IP-
CAN) to deliver the termination session, the TADS in the UE can indicate to
the TADS-IMS whether voice session should be delivered via CS access and
whether I1-ps or I1-cs should be used for continuing the session setup.
The following figure depicts the relationship between TADS-IMS and TADS in UE.
Figure 6.15.1.1-1: Relationship between TADS-IMS and TADS in UE
The TADS in the UE may use the following information to determine the response
to TADS-IMS.
\- ICS capable IMS network.
\- Access network currently on.
\- User preference and operator policy.
\- Any other information that the UE can be used to determine the media
capabilities of the IP-CAN.
NOTE: If the TADS-UE determines the session (both media and session control
signalling) can be delivered over the IP-CAN then the UE would continue the
session setup as defined for IMS.
#### 6.15.1.2 TADS-UE Scenarios
The following figure 6.15.1.2-1 shows a high level call flow between TADS in
the IMS and in the ICS UE for selection ICS termination.
Figure 6.15.1.2-1: TADS in the IMS and in the ICS UE for selection ICS
termination
1\. An incoming SIP INVITE from the originating party and is forwarded to
ICCF.
2\. ICCF invokes the TADS (TADS-IMS) and it selects the IP-CAN to deliver the
session. An INVITE2 is generated toward the ICS UE.
3\. When ICS UE receives the INVITE2, the TADS in the UE determine that the
IP-CAN is not suitable for voice media and it needs to use the CS access for
voice. It also determines whether I1-cs or I1-ps (e.g. based on DTM or
multiRab case) can be used for session signalling.
4\. TADS-UE indicates to TADS-IMS that voice needs to be delivered over CS
media and which session signalling is to be used (I1-cs or I1-ps).
Editors Note: It is FFD on how step4 and 5 are combined to minimize the time
delay for call setup.
ICCF performs the ICS termination based on the procedure defined in clause 6.5
(for I1-ps) or clause 6.6 (i1-cs).
## 6.16 Impact on IMS
## 6.17 Impact on CS Core Network
## 6.18 Impact on UE
ICS UE shall be able to learn whether both HPLMN and the VPLMN supports ICCC;
i.e. whether I1-ps and/or I1-cs or neither are supported. UE needs this
information e.g. to determine whether it should use the ICCC in call
initiations
Editor\'s Note: How the UE learns whether the HPLMN and VPLMN supports ICCC or
not is FFS.
Non-ICS UE does not need to learn the home or visited network support for ICS.
## 6.19 Fallback Mechanisms
### 6.19.1 Fallback for L‑CAAF-n and enhanced MSC solutions
#### 6.19.1.1 Introduction
It is possible that a UE could move on to an MSC that is either not enhanced
for ICS or does not have an associated L‑CAAF‑n. This can occur when a network
has a partial roll‑out of an L‑CAAF‑n or enhanced MSC solution, or when
roaming outside of the HPLMN. Therefore, a default behaviour needs to be
specified in order for the HPLMN to still provide some kind of service to the
subscriber.
#### 6.19.1.2 Possible Solutions
When there is no ICS functionality available at an attached MSC, the following
fallback solutions are possible:
1\. Fallback to redirection to IMS. That is, to redirect all originated calls
to the IMS by using CAMEL. This of course will not provide for mid-call
services in IMS, and also means that the subscriber will be present in CS, but
unregistered in IMS. Terminating services will be in IMS, using redirection
from the GMSC in the HPLMN.
2\. Fallback to CS:
2.1. MO calls handled in CS (i.e. MSC in VPLMN), MT calls handled in IMS.
Hence originating or mid‑call services will be in CS domain and terminating
services in IMS.
2.2. MO calls and MT calls handled in CS. For incoming IMS calls, the T-SDS
(Terminating Service Domain Selection function) will need to be enhanced to be
made dynamic as currently it is only statically configured.
3\. Fall back to UE based ICS solution. This is not considered a valid
alternative, since if the UE supports ICS, and home network supports ICCC,
then the ICS UE will use ICCC, and the UE will not rely on ICS function in
VMSC. If the ICCC is not available, the ICS UE has to disable its ICS
functionality, thus falling back to UE based ICS solution is impossible in any
case.
Option 2.2, above, will require fairly substantial work in order to provide a
technical realisation: possibly too much work for the actual benefit it
brings. Option 3 is not applicable.
Option 1 provides the most functionality out of all options, but of course
relies on CAMEL support in the VPLMN.
Option 2.1 will have a fairly simple technical realisation and is probably the
best option to use when there is no CAMEL in the VPLMN (a fairly rare case in
most roaming agreements between most operators, but certainly not an
impossibility). This option may also be used if the subscriber is using only
services that are standardised already as a Supplementary Service, but the
HPLMN was provisioning these in IMS as part of a network‑based ICS
architecture.
#### 6.19.1.3 Conclusion
Options 1 and 2.1 should be defined in the network based ICS solution. It
should be an operator option (e.g. by CAMEL provisioning) when option 1 should
be used and when option 2.1 should be used in VPLMNs with CAMEL. In VPLMNs
with no CAMEL, option 2.1 should always be used.
In the above cases, the HLR/HSS should download to the VMSC/VLR the service
data that enables the execution of the required services in the CS domain.
Option 2.2 is too complex in relation to their actual use and benefits they
will bring. Option 3 is not applicable.
## **6.20 ICS capability exchange between the ICCF and the ICS UE**
### 6.20.1 ICS capability exchange between the ICCF and the ICS UE
The ICS UE establishes a dialogue with the ICCF for ICS capability exchange
upon network attachment. This may be achieved by using a new SIP event package
or USSD exchange between the ICS UE and the ICCF.
The following information is exchanged as part of this dialogue:
\- UE\'s ICS capability.
\- ICCC capability of the HPLMN and VPLMN, more specifically, type of ICCC
expected for use with the current network attachment.
### 6.20.2 ICS Association between the ICCF and the IMSC
The ICS Association is established between the ICCF and an IMSC when a ICS
user attaches to an IMSC.
The IMSC discovers the following as part of this exchange:
\- Control domain for the served user; the control domain is IMS if the
Location Update is performed for an ICS user and operator policy allows
delivery of ICS to the ICS user via the serving CS network (e.g. service
provider policy allows ICS only when the ICS user is not internationally
roaming).
\- UE\'s ICS capability; the IMSC provides the UE identity to request this
capability.
\- ICCC capability of the VPLMN, more specifically, type of ICCC expected for
use with the current network attachment.
#### 6.20.2.1 Alternatives for establishing ICS Association between ICCF and
IMSC
The following options are possible for implementation of the ICS Association
between the ICCF and the IMSC.
**Option 1: Diameter exchange upon CS Attach**
Figure 6.20.2.1-1. below illustrates use of Diameter to establish the ICS
Association between the ICCF and the IMSC upon CS Attach.
Figure 6.20.2.1-1: ICS Association using Diameter
The HSS maintains the ICS subscription information, as well as subscriber
location to aid in determining the IMSC contact address as part of the
subscriber data. Upon Location Update from an IMSC, this information is pushed
down to the ICCF over the Sh or MAP interface. With the use of this
information, the ICCF initiates a dialogue with the IMSC to establish the ICS
Association. A new Diameter interface between the ICCF and the IMSC is used
for establishment of the ICS Association (Step 4 in the figure).
After the ICS Association has been established for a ICS UE, the IMSC
initiates a SIP REGISTER for the UE if it\'s a non ICS UE or a ICS UE using
I1-cs.
**Option 2: USSD exchange upon CS Attach**
The IMSC uses UE initiated USSD procedure toward the ICCF upon CS Attach to
establish the ICS Association. Figure 6.20.2.1-1 below illustrates use of USSD
to establish the ICS Association between the ICCF and the IMSC upon CS Attach.
Figure 6.20.2.1-2: ICS Association using USSD
After the ICS Association has been established for a ICS UE, the IMSC
initiates a SIP REGISTER for the UE if it\'s a non ICS UE or a ICS UE using
I1-cs.
This option eliminates the need for MAP/Sh enhancements and/or a new Diameter
interface between the ICCF and the IMSC.
**Option 3: Use of SIP REGISTER upon CS Attach**
Upon CS Attach, the IMSC establishes the ICS Association as part of the SIP
REGISTER; SIP extensions may be required to exchange ICS information as part
of IMS Registration via CS access.
This option eliminates the need for new interface or USSD but requires local
VPLMN configuration of ICS subscription for ICS users as the IMSC shall only
redirect ICS users to IMS.
# 7 Conclusion
## 7.1 Interim conclusion on registered services to ICS users when using I1-cs
With I1-cs, two solutions are described in the TR on how to enable registered
services (services invoked as a result of registered iFC) to ICS users
registered in IMS via CS access:
\- I1-cs: registered user solution: SIP Register performed by the ICCF; and
\- I1-cs: registered user solution: CS Registration status push from the HSS.
During the course of the study, it has been recognized that both methods
require standardization effort.
Registered services are also available for the ICS user using I1-cs when the
user is registered in IMS via an IP-CAN using the IMS SIP registration
procedure defined in TS 23.228 [4]. When not registered in IMS via an IP-CAN,
or in absence of I1-cs mechanisms for registration via CS access, the
unregistered user solution described in the TR supports many of the
requirements with use of standard IMS procedures.
Finally, the study has shown that both solutions have their advantages and
disadvantages. However, it is believed that the benefits of the two registered
user solutions are outweighed by the cost of supporting them and so they are
not recommended for further specification. Thus no I1-cs mechanism for
registration is to be specified.
## 7.2 Conclusion on ICS architecture solutions
Different approaches have been identified as possible solutions for enablement
of ICS for ICS UE. The SIP Application Server approach with I1-ps and I1-cs
(described in clauses 6.5 and 6.6) is recommended as the working assumption
for ICS UE.
The use of Mw reference point for the ICCF (described in clause 6.7) is not
recommended to be specified in normative specifications.
Different approaches have been identified as possible solutions for enablement
of ICS for non ICS UEs. The approach of the enhanced MSC‑Server (described in
clauses 6.3.3 and 6.8a) is recommended as the baseline for non ICS UEs in the
normative specification, along with the associated fallback mechanisms
(described in clause 6.19).
The L-CAAF-n approach for non ICS UE (clause 6.3.1) is _not_ recommended to be
specified in normative specifications.
## 7.3 Conclusion on use of ICCC
Two different methods of call control have been documented for initiation of
ICS UE sessions established using CS bearers:
\- Method 1: Using ICCC (SIP with I1-ps or ICCP with I1-cs) in conjunction
with TS 24.008 [7] signalling.
\- Method 2: Using CAMEL based redirection to IMS in conjunction with TS
24.008 [7] signalling.
Both of these methods are recommended for standardization of ICS UE session
originations and terminations when using CS bearers.
Operator policy may control the use of I1-cs or I1-ps.
ICCC has to be used for mid-call signalling and to setup subsequent sessions.
### 7.3.1 Conclusion on the use of I1-ps
#### 7.3.1.1 Conclusion on the use of I1-ps to initiate the first ICS UE
session
To always use SIP with I1-ps in conjunction with TS 24.008 [7] signalling
#### 7.3.1.2 Conclusion on the use of I1-ps for Domain Transfer
I1-ps is always used for Domain Transfer from a VoIP capable access network to
CS access network.
### 7.3.2 Conclusion on the use of I1-cs
#### 7.3.2.1 Conclusion on the use of I1-cs to initiate the first ICS UE
session
Operator policy may decide on one of the following two alternatives:
**EITHER**
\- To always use ICCP with I1-cs in conjunction with TS 24.008 [7] signalling.
**OR**
\- To use CAMEL signalling in conjunction with TS 24.008 [7] signalling for
call origination, if no IMS parameters (such as SIP URI) need to be sent by
the originating party.
\- To use standard CS call termination if no IMS parameters (such as SIP URI)
need to be sent to the terminating party.
\- To use ICCP with I1-cs in conjunction with TS 24.008 [7] signalling if IMS
parameters (such as SIP URI) need to be exchanged.
The Setup message used in CS origination procedures should contain the B-Party
number whenever an E.164 number is dialled so that the MSC can analyse the
B-party digits and so detect any undetected emergency calls.
#### 7.3.2.2 Conclusion on the use of I1-cs for Domain Transfers
\- Domain transfer may be performed without I1-cs when the ICS UE is involved
in only one session and when a STI was not assigned to the session by the DTF
(as specified in clause 6.6.2) and with no supplementary services (e.g. HOLD)
invoked
\- Domain transfer is performed with use of I1-cs when the ICS UE is involved
in more than one session or in a session for which a STI was assigned by the
DTF (as specified in clause 6.6.2) or when a supplementary service (e.g. HOLD)
is invoked.
## 7.4 Conclusion on centralization of conditional call forwarding
Three different solutions have been proposed for the centralization of
conditional call forwarding services in IMS when the call has been delivered
using CS call control. These solutions are discussed in this TR, and a brief
overview of them has been provided below:
**Solution 1: Use default PSIs**
In this solution, Conditional CF is configured in IMS with default service
configuration in the CS domain. The Conditional CF services are configured in
the HLR. The different forwarded number can be set in HLR to indicate the type
of CF. The VMSC redirects the call to IMS for appropriate handling of the
service in IMS.
**Solution 2: Use MAP suppression-of-announcements**
In this solution, Conditional CF is configured and provisioned in IMS domain
exclusively, according to IMS Centralized Service principle. It provides means
to suppress the announcement in CS domain at the MSC for CFNR/CFB. MGCF
provides the appropriate responses to TAS on behalf of the ICS user in CS
domain.
**Solution 3: Use CAMEL O-CSI**
In this solution, Conditional CF is configured in IMS with default service
configuration in the CS domain so that the VMSC invokes the CF service in the
CS domain upon detection of CF triggers. The O-CSI camel service is also
assumed to be configured in HLR especially as one natural assumption is that
ICS users are likely to have VCC capability. It is used to redirect session
control to IMS for processing of CF.
These three solutions may be supported standalone or may be combined with each
other if necessary.
**It** is recommended to document these solutions and if necessary,
combinations of these solutions as implementation options in the technical
specification for IMS Centralized Services.
## 7.5 Conclusion on ICS UE receiving home IMS services via an IMSC
When using an ICS UE, the ICCF in the home IMS network as defined in clause
6.2.2.2 of this document shall provide the ICS control function, with an IMSC
providing access to the ICCF.
The conclusions of this TR that apply to ICS UE (clauses 7.2, 7.3 and 7.4) are
applicable when using an IMSC as well as when using CS network not enhanced
for non ICS UE.
The IMSC applies the same procedures for registration in IMS regardless of the
ICS capability of the UE . Whether or not the IMSC applies the registration
procedure for ICS user is based on configuration as described in 6.8a.3
Originated Service Domain Selection for enhanced MSC server.
## 7.6 Conclusion on handling of multiple media for IMS Centralized Services
Speech media of a session may be transmitted over CS access. Bi-directional
video may be transmitted multiplexed with speech over CS access (BS30) only in
case UTRAN is used as access network and based on operator policy and UE
capabilities. Video and other media components of a session may also be
transmitted via PS access.
When bi-directional video is transmitted multiplexed with speech over CS
access, for the SIP Application Server approach with I1-ps and I1-cs, the
interworking between H.245 and SIP/SDP shall be done by the MGCF and IM MGW as
described in TS 29.163 [18]; for the enhanced MSC‑Server approach, similarly,
the enhanced MSC server and MGW shall provide the interworking between H.245
and SIP/SDP.
Service continuity for multimedia call is handled within the MMSC study.
## 7.7 Conclusion on use of ICCC for CS terminations
When using I1-ps, the solution that describes the use of CS-Origination
procedures to set up the bearer control signalling session is recommended for
standardization.
When using I1-cs or when not using ICCC, the solution that describes the use
of standard CS-Termination procedures to set up the bearer control signalling
session is recommended for standardization.
## 7.8 Conclusion on relation between ICS and Service Continuity
The conclusion regarding the relation between ICS and Service Continuity with
regard to domain / session transfer is as follows:
\- ICS TS shall include the following aspects from TR 23.892:
\- Functionality required for centralization of services in the solutions for
ICS UE and non ICS UE (i.e. enhanced MSC Server solution).
\- Communication of parameters required to identify sessions for domain
transfer / session transfer between the ICS UE and ICCF using either I1-ps or
I1-cs (the parameter as such are transmitted to / from DTF and hence the
detail of which parameter is transmitted needs to be documented in the Service
Continuity TS).
\- Description of the internal ICCF capability to merge / split two SIP
sessions in the case of I1-ps on its own, namely the SIP session over the
session control signalling path via PS access and the SIP session for the
bearer control signalling path
\- Service Continuity TS shall include the following aspects from TR 23.892:
\- The functionality required for IMS Service Continuity requests from / to CS
access in the UE and the AS (e.g. session transfer function).
\- Transfer of one or more bi-directional speech sessions in order to enable
domain transfer while Call Hold/Resume, Conference or Explicit Communication
Transfer is active.
> NOTE 1: Session transfer between different accesses and partial session
> transfer is discussed in TR 23.893 [19] and is out of scope of this ICS
> work.
>
> NOTE 2: Session split/merge function needed for the user when media is
> carried simultaneously over two accesses is discussed in TR 23.893 [19] and
> is out of scope of this ICS work.
\- The IMS Session Continuity procedures (e.g. anchoring of originating and
terminating calls, termination and domain transfer).
\- Definition of session transfer related parameters like VDI/VDN, STI, ST
info.
\- How to assign parameters needed to identify sessions and media for session
transfer.
\- It is recommended to not describe how the parameter is being transmitted
between the UE and the network when using a CS access for media transmission
(i.e. when to use I1-cs and when to use I1-ps) and to leave that detail for
the ICS TS.
NOTE 3: Finalization of the ICS TS is not dependent on the Service Continuity
TS, even though there will be cross-references between the two TS.
## 7.9 Conclusion on the relationship between ICS and MMSC
Both ICS and MMSC specify functions which are provided by a SIP application
server. These functions may be collocated as optional functions in a single
SIP application server. The interfaces and interactions between them are not
specified in this release.
## 7.10 Conclusion on T-ADS
The T-ADS has two functions, the selection function and the execution
function. The selection function needs to be able to select for a terminating
session amongst the following:
\- Registration in IMS by the ICS or non-ICS UE for speech or speech and video
via PS for media via PS (\"PS contact\")
\- Registration in IMS by the ICS UE via PS for media via CS (\"I1-ps
contact\")
\- Registration in IMS by the ICS UE via PS for non-speech media and UE is
reachable in CS (IMS registered for non speech only, hence speech services and
or speech/video use I1-cs; \"non-speech contact\")
\- Registration in IMS by the IMSC for media via CS (\"IMSC contact\")
\- No registration in IMS but ICS or non-ICS UE reachable in CS
(\"unregistered\", for I1-cs and in fallback cases for IMSC)
If either only \"PS contacts\" or only \"IMSC contact\" for one UE are
possible in the S-CSCF, then standard contact selection in the S-CSCF is
sufficient and T-ADS is not needed.
The selection and execution function of the T-ADS are provided by the same AS.
The execution function of the T-ADS is in the last IMS application server in
the terminating iFC.
For a network which implements the ICCF, the ICCF is the last AS.
For a network requiring T-ADS but which does not implement the ICCF, the last
AS is not specified (one candidate is MMSC AS, as defined in TR 23.893 [19]).
NOTE: The AS which implements the ICCF may be the same AS which implements the
MMSC.
T-ADS should be described in the normative specification in TS 23.292 [21].
###### ### Annex A: ICS Service examples with I1-ps
# A.1 Customized Alerting Tone
Customized alerting tone (also known as customized ring tone) is a service
where the callee is able to customize the alerting tone (typically a music
song) that is played to the caller while the callee is alerted. This service
can be and is offered in today\'s CS networks by routing the call via a
special announcement server, that connects the caller to the announcement
while the callee is alerted. IMS can extend this service so that the callee
sends the music clip (either the music clip itself or a reference to the clip
is sent in a SIP method) to the caller, and caller\'s device plays the clip
locally to the caller. This service is currently under discussion also in
TISPAN NGN R2, and thus a possible candidate for 3GPP MMTel in Rel‑8.
The next example illustrates how the service is currently offered in the IMS
using mechanisms defined in RFC 3261, when both A and B party use IP-CAN to
access IMS services.
{width="5.999305555555556in" height="2.0520833333333335in"}
Figure A.1-1
1\. The caller calls to callee and sends INVITE towards UE‑B
2\. INVITE is routed to UE‑B
3\. UE‑B alerts the user.
4\. Callee has pre-configured the UE‑B to send a customized ringing tone
towards the caller. The ringing tone may be different depending on e.g. the
caller\'s ID. UE‑B sends 180 Ringing response towards UE‑A. The response
contains an Alert-Info header, which carries a reference to the ringing tone,
the actual ringing tone is either pre-configured in the Media Server, or
carried in the body of the 180 Ringing.
5\. UE‑A receives the 180 Ringing.
6\. Optionally UE‑A retrieves the ringing tone from the Media Server if
reference is used.
7\. UE‑A plays the ring tone to the caller.
In the next figure we show how the same service can be offered when UE‑A is in
ICS system using CS access.
{width="5.999305555555556in" height="2.259027777777778in"}
Figure A.1-2
1a The caller calls to callee and sends INVITE towards UE‑B
1b The caller initiates a CS call towards the MGCF/MGW.
Rest of the flow is identical with the previous flow where the caller was
accessing the IMS services via IP-CAN:
2\. INVITE is routed to UE‑B
3\. UE‑B alerts the user.
4\. Callee has pre-configured the UE‑B to send a customized ringing tone
towards the caller. The ringing tone may be different depending on e.g. the
caller\'s ID. UE‑B sends 180 Ringing response towards UE‑A. The response
contains an Alert-Info header, which carries a reference to the ringing tone,
the actual ringing tone is either pre-configured in the Media Server, or
carried in the body of the 180 Ringing.
5\. UE‑A receives the 180 Ringing.
6\. Optionally UE‑A retrieves the ringing tone from the Media Server if
reference is used.
7\. UE‑A plays the ring tone to the caller.
In similar manner, also the UE‑B may use CS access via ICS to access the IMS
services. The ringing tone in this example can be a short audio clip or e.g. a
midi file. Also other media can be offered in similar manner, e.g. a video
ringing tone, as long as the size of the media file is feasible to be
transferred during the call setup phase.
As a conclusion, this service can be offered exactly in the same manner in ICS
than in pure IMS. There is no impact to the SIP protocol or IMS procedures
regarding this service due to introduction of ICS.
# A.2 Instant Picture Presentation
In this example, the caller (UE‑A) wants to send a \"near real time\" picture
as part of session setup to UE‑B (e.g. want to show the callee her new hair
style). Basically, she just took a picture of herself and then places the call
to the callee. UE‑A encodes the picture into a feasible size to be included in
the SIP INVITE. Image can be carried in INVITE using the Call-Info header with
purpose=icon, the image can either be referenced in the media server, or
carried as such in the body of the INVITE. Using reference in this example
does not make too much sense because the caller will have to place it in a
server first prior to the call; thus, delaying the whole call setup routine to
callee.
In the next figure we show how the service can be offered when UE‑A is in ICS
system using CS access.
{width="6.001388888888889in" height="2.265972222222222in"}
Figure A.2-1
1a The caller calls to callee and sends INVITE towards UE‑B along with the
snapshot.
1b The caller initiates a CS call towards the MGCF/MGW.
2\. INVITE is routed to UE‑B.
3\. UE‑B alerts the user with the snapshot of caller
4\. UE‑B sends 180 Ringing response towards UE‑A.
5\. UE‑A receives the 180 Ringing.
In similar manner, also the UE‑B may use CS access via ICS to access the IMS
services.
As a conclusion, this service can be offered exactly in the same manner in ICS
than in pure IMS. There is no impact to the SIP protocol or IMS procedures
regarding this service due to introduction of ICS.
# A.3 Call Reject with customized reason
This service is similar to the customized alerting tone, but here the
additional multimedia content is rendered to caller related to the call
release in the setup phase. In the next figure we show how the service can be
offered exactly as in SIP/IMS, even while the callee (UE‑B) is using ICS and
CS access to access the IMS services.
{width="5.995138888888889in" height="2.1145833333333335in"}
Figure A.3-1
1\. The caller calls to callee and sends INVITE towards UE‑B.
2a The INVITE is routed to the UE‑B.
2b ICCF initiates a CS SETUP via MGCF towards the UE‑B.
3\. UE‑B alerts the callee.
4\. UE‑B sends 180 Ringing towards the UE‑A.
5\. UE‑A receives the 180 Ringing.
6\. Callee decides to reject the call.
7\. Callee has pre-configured to the UE‑B a few predefined error responses,
like \"I will call you later\", \"On vacation\", \"In a meeting, is it
urgent?\", etc. Callee selects one of these responses and the UE‑B attaches
the response to the 486 Busy Here. As described in RFC 3261, the additional
error response can be carried in Error-Info header of 486, either as a
reference, or as a direct content in the body of the response. The additional
error information can also be e.g. a short audio clip. UE‑B sends 486 Busy
Here response towards the UE‑A.
8\. UE‑A receives the 486 Busy Here.
9\. Optionally UE‑A retrieves the additional error information from the Media
Server if reference is used.
10\. UE‑A plays the error information to the caller.
In similar manner, also the UE‑A may use CS access via ICS to access the IMS
services. As a conclusion, this service can be offered exactly in the same
manner in ICS than in pure IMS. There is no impact to the SIP protocol or IMS
procedures regarding this service due to introduction of ICS.
# A.4 Caller\'s Location
In this service example the caller\'s UE fetches its location and offers it in
the call setup towards the callee. Callee can present the caller\'s location
in the screen of the UE‑B e.g. using a street map, which is either stored
locally in the UE‑B, or retrieved from a map database in the network.
In the next figure we show how the service can be offered exactly as in
SIP/IMS, even while the callee (UE‑B) is using ICS and CS access to access the
IMS services.
{width="5.998611111111111in" height="2.477777777777778in"}
Figure A.4-1
1\. The caller calls to callee and sends an INVITE towards UE‑B. The INVITE
includes a Geolocation header as described in SIP Location Conveyance I-D
(draft-ietf-sip-location-conveyance-07) and the location of the user carried
in PIDF-LO (RFC 4119) in the body of the INVITE. The PIDF-LO element carries
the location of the UE‑A. The UE‑A may have retrieved its location e.g. by
using its integrated GPS receiver, as a civic address from DHCP server as
described in RFC 4676, or by other means. Also the IMS-A may add the location
of the UE‑A on behalf of the UE, if the network supports location retrieval
function and thus is able to locate the UE‑A.
2.a The INVITE is routed to the UE‑B.
2.b ICCF initiates a CS SETUP via MGCF towards the UE‑B.
3\. UE‑B alerts the callee.
4\. Optionally the UE‑B uses the location of the caller to retrieve e.g. a
street map from a network map database, if the UE‑B does not have integrated
map database.
5\. UE‑B renders the map data to the screen, along with the current location
of the caller.
6\. UE‑B sends 180 Ringing towards the UE‑A (can be sent in parallel with
steps 3-5).
7\. UE‑A receives the 180 Ringing.
8\. Callee decides to answer the call. UE‑B sends 200 OK towards UE‑A.
9\. UE‑B receives the 200 OK for INVITE.
In similar manner, also the UE‑A may use CS access via ICS to access the IMS
services. Also UE‑B may provide his/her location to UE‑A using similar
procedure and PIDF-LO element e.g. in the body of 180 Ringing response. As a
conclusion, this service can be offered exactly in the same manner in ICS than
in pure IMS. There is no impact to the SIP protocol or IMS procedures
regarding this service due to introduction of ICS.
# A.5 Ad-hoc conferencing
This example shows how the multimedia conferencing service can be offered in
ICS. IMS Multimedia conferencing (TS 24.147) is part of 3GPP R7 Multimedia
Telephony service (TS 24.173). It defines SIP procedures to create a
multiparty conference session, add and remove users to/from the session,
add/remove media to/from the multiparty session, receive notifications on
other users in the conference session, etc. In this example we show how all of
these standard procedures can be offered also via the CS access, while the
user is accessing the IMS services via ICS. In this example user A initiates
the conference session and is using CS access, user B is invited participant
using CS access, and user C is invited participant using IP-CAN access.
{width="5.998611111111111in" height="3.5104166666666665in"}
Figure A.5-1
1\. The user A wants to create an ad-hoc voice conference with users B and C.
User A selects the B and C from his/her local phonebook and selects \"create a
conference call\" in the UI. UE‑A sends an INVITE towards the conference
server, the identities of B and C are carried in the body of the INVITE, as
described in draft-ietf-sip-uri-list-conferencing-01 (part of TS 24.173). User
A may also add a subject to the conference session, e.g. \"Urgent, meeting
today is moved up 2 hrs which is now!\".
2\. UE‑A initiates a CS SETUP via MGCF towards the ICCF.
3\. Conference AS (may be part of TAS) receives the INVITE. The AS creates the
conference session and responds with 200 OK. UE‑A receives the 200 OK for
INVITE. 200 OK carries in the Contact header the SIP URI of the conference
session and the isfocus parameter.
4\. UE‑A subscribes for the conference state event package as described in RFC
4575 (part of TS 24.173). The notification indicates to the UE‑A whenever the
invited user is added to the conference, whether some invited user fails to
accept the conference invitation (e.g. is busy), and later on during the
conference session, whenever another user is added or old user leaves the
session. The event package may also carry information about the supported
medias in the conference session, it may indicate that the conference AS
supports e.g. voice, video, and messaging. UE‑A may update the information on
the UI regarding the conference state, participants, etc, whenever it gets the
notification from the conference AS.
NOTE: SUBSCRIBE/NOTIFY is not routed through the ICCF.
5\. Conference AS invites the participants B and C to the session. AS sends
INVITE towards user B. UE‑B receives an INVITE which carries in the Contact
header the SIP URI of the conference session and the isfocus parameter.
6\. ICCF initiates a CS SETUP via MGCF towards the UE‑B.
7\. UE‑B alerts the user B. UE‑B may indicate to the user B that this is a
multiparty session.
8\. UE‑B sends 180 Ringing towards the conference AS.
9\. UE‑B subscribes for the conference state event package. The notification
indicates to the UE‑B who are the other invitees in the conference session,
whether some invited user fails to accept the conference invitation (e.g. is
busy), and later on during the conference session, whenever another user is
added or old user leaves the session. The event package carries also the
subject of the session, \"Urgent, meeting today is moved up 2 hrs which is
now!\". The event package may also carry information about the supported
medias in the conference session, it may indicate that the conference AS
supports e.g. voice, video, and messaging. UE‑B may update the information on
the UI regarding the conference state, participants, etc, whenever it gets the
notification from the conference AS.
10\. User B answers the call.
11\. UE‑B sends 200 OK for INVITE towards the conference AS. Conference AS
updates the status of the user B in the conference event package and delivers
it to the other participants via NOTIFY.
12-17. Conference AS invites the user C to the conference. This can be
performed in parallel with steps 5-11.
In the next example flow the user A adds user D to the conference session.
User D uses IP-CAN to access IMS services.
{width="5.985416666666667in" height="3.3430555555555554in"}
Figure A.5-2
1\. The user A wants to add user D to the conference session. User A select
the user D from his/her phonebook and selects \"add to the conference\". UE‑D
sends REFER towards the conference AS. The REFER contains the identity of the
user D in the Refer-To header. AS invite the user D to the session, the AS
sends INVITE towards the UE‑D.
NOTE: REFER is not routed through the ICCF.
2\. UE‑D receives the INVITE. It carries in the Contact header the SIP URI of
the conference session and the isfocus parameter.
3\. UE‑D alerts the user D.
4\. UE‑D sends 180 Ringing towards the conference AS. UE‑D subscribes the
conference state event package and gets notified on the other participants in
the conference session (not shown in the figure). The event package carries
also the subject of the session, \"Urgent, meeting today is moved up 2 hrs
which is now!\". The event package may also carry information about the
supported medias in the conference session, it may indicate that the
conference AS supports e.g. voice, video, and messaging.
5\. User D answers the call.
6\. UE‑D sends 200 OK for INVITE towards the conference AS.
7\. Conference AS sends NOTIFY to UE‑A to indicate that user D was
successfully added to the conference session.
8\. Conference AS sends NOTIFY to UE‑B to indicate that user D was
successfully added to the conference session.
9\. Conference AS sends NOTIFY to UE‑C to indicate that user D was
successfully added to the conference session.
10\. Conference AS sends NOTIFY to UE‑D to indicate the other participants of
the conference session.
In the next example flow we show how user A is able to add another media (e.g.
messaging) to the conference session.
{width="5.999305555555556in" height="3.915277777777778in"}
Figure A.5-3
1\. The user A noticed earlier via the conference state event package that the
conference AS supports messaging media. User A wants to add a messaging media
to the conference session in order to share a few important notes he/she has
made during the conference call. UE‑A sends a Re-INVITE with SDP offer
indicating an MSRP media.
2\. Conference AS accepts the SDP offer by sending 200 OK for INVITE with SDP
answer.
3\. Conference AS sends a Re-INVITE indicating an MSRP media towards UE‑B.
4\. UE‑B accepts the MSRP media.
5\. Conference AS sends a Re-INVITE indicating an MSRP media towards UE‑D.
6\. UE‑D accepts the MSRP media.
7\. Conference AS sends a Re-INVITE indicating an MSRP media towards UE‑C.
8\. UE‑C accepts the MSRP media.
9\. Conference AS sends a NOTIFY to UE‑A to indicate that the user\'s B, C and
D have accepted the MSRP media.
10\. Conference AS sends a NOTIFY to UE‑B to indicate that the user\'s A, C
and D have accepted the MSRP media.
11\. Conference AS sends a NOTIFY to UE‑C to indicate that the user\'s A, B
and D have accepted the MSRP media.
12\. Conference AS sends a NOTIFY to UE‑D to indicate that the user\'s A, B
and C have accepted the MSRP media. From now on, all participants are able to
send and receive MSRP messages in the conference session.
As a conclusion, this service can be offered exactly in the same manner in ICS
than in pure IMS. There is no impact to the SIP protocol or IMS procedures
regarding this service due to introduction of ICS.
###### ### Annex B: Information flow for mid call service using MRFC/MRFP
The following figures B.1-1 and B.2-1 show two examples for dynamic link-in of
MRFC/MRFP invoked by the ICCF. Figure B.3-1 shows an example for MRFC/MRFP
invoked by the TAS.
# B.1 Information flow for using MFRP by ICCF for held call only
{width="6.653472222222222in" height="4.134722222222222in"}
Figure B.1-1: Media handling in Hold and Originating Session Setup
**The precondition of the procedure is that there is an active session before
UE‑A and UE‑B.**
**1.** UE‑A sends an ICS Hold Request inside a USSD dialog to HSS via MSC, and
HSS routes the request to the addressed ICCF.
2\. ICCF sends a SIP Update via S-CSCF to hold UE‑B.
3\. ICCF sends a SIP Update to MGCF to set the media into inactive. Now only
RTCP is sent to UE‑B from IM-MGW.
4\. UE‑A now sends an ICS Request inside a USSD dialog to HSS via MSC, in
order to initiates a call to UE C, and HSS routes the request to the addressed
ICCF.
5\. ICCF sends a SIP Invite via S-CSCF to UE C, with the media set to
inactive.
6\. UE C sends a SIP 180 Ringing via S-CSCF to the ICCF.
7\. UE C sends a SIP 200 OK via S-CSCF to the ICCF.
8\. ICCF sends a SIP ACK via S-CSCF to UE C. Now the session is established
but the media transfer is not allowed.
9\. ICCF then sends a SIP Invite via S-CSCF to MRFC/MRFP to prepare a dialog
for UE‑B.
10\. MGCF/MRFP sends a SIP 200 OK via S-CSCF to the ICCF.
11\. ICCF sends a SIP Re-Invite via S-CSCF to UE‑B to update the media path.
12\. UE‑B sends a SIP 200 OK via S-CSCF to the ICCF.
13\. ICCF sends a SIP Update to MGCF to activate and redirect the media to UE
C.
14\. ICCF sends a SIP Update to UE C to activate the media. Now the media path
is established e-2-e between UE‑A and UE C, and RTCP is sent from MRFP to
UE‑B.
# B.2 Information flow for using MFRP for both active and held call
Figure B.2-1: Information flow for mid call using MRFC/MRFP
1) UE‑A initiates Hold request towards ICCF using ICCP protocol.
2) ICCF sends SIP Update request to UE‑B to hold UE‑B\'s media.
3) ICCF sends SIP Update request to MGCF to hold MGW\'s media.
4) ICCF sends Hold ack response towards UE‑A.
NOTE: The session between UE‑A and UE‑B is successfully put on hold.
5) UE‑A sends Invite request towards ICCF, the called party is UE‑C.
6) ICCF sends SIP Invite request to MRFC including media information of MGW.
7) MRFC responses SIP 200 OK including media information of MRFP.
8) ICCF sends SIP Invite request towards MRFC including UE‑B\'s media
information.
9) MRFC responses SIP 200 OK including media information of MRFP.
10) ICCF sends SIP Invite to MRFC with null media information.
11) MRFC responses SIP 200 OK including media information of MRFP.
12) ICCF sends SIP Invite towards UE‑C including MRFP\'s media information
return in step 11.
13) UE‑C responses SIP 183 response including UE‑C\'s media information.
14) ICCF sends SIP Update request to MRFC to change the media information
related to UE‑C.
15) UE‑C sends SIP 180 response.
16) ICCF sends 180 response using ICCP towards UE‑A.
17) UE‑C sends SIP 200 OK response.
18) ICCF sends SIP Update request to UE‑B to change UE‑B\'s media path to
MRFP.
19) ICCF receives SIP 200 OK response.
20) ICCF sends SIP update request towards MGCF to active bearer of UE‑A.
21) ICCF receives SIP 200 OK from MGCF.
22) ICCF sends 200 Ok response to UE‑A using ICCP.
The consequent call retrieve (retrieve call with UE‑B, hold call with UE‑C)
flow is not shown in this figure for reasons of simplification.
# B.3 information flow for using MFRP by TAS for held call
Figure B.3-1: Information flow for mid call using MRFC/MRFP by TAS
The precondition of the procedure is that there is an active session between
UE‑A and UE‑B. The TAS is remained in the RUA leg.
1) UE‑A initiates a Hold request towards ICCF using ICCP protocol.
2) ICCF sends a SIP Update request to MGCF to set MGW\'s media inactive.
3) MGCF responses a SIP 200 OK back to ICCF
4) ICCF sends a SIP Update request to TAS via S-CSCF to hold UE‑B\'s media.
5) TAS sends a SIP Invite request including media information of UE‑B to MRFC
to play announcement to UE‑B.
6) MRFC responses a SIP 200 OK including media information of MRFP.
7) TAS sends a SIP ACK to MRFC.
8) TAS sends a SIP Update request including media information of MRFP to UE‑B
via S-CSCF to change UE‑B\'s media path to MRFP.
9) UE‑B responses a SIP 200 OK to TAS via S-CSCF. Now MRFP plays announcement
to UE‑B.
10) TAS responses a SIP 200 OK to ICCF via S-CSCF.
11) ICCF sends a Hold ACK response towards UE‑A.
12) UE‑A sends an Invite request towards ICCF using ICCP protocol, the called
party is UE C.
13) ICCF sends a SIP Invite towards UE C including MGW\'s media information
via S-CSCF and TAS.
14) UE C sends a SIP 180 response back to ICCF via S-CSCF and TAS.
15) ICCF sends a 180 response using ICCP towards UE‑A.
16) UE C sends a SIP 200 OK response back to ICCF via S-CSCF and TAS.
17) ICCF sends a 200 Ok response to UE‑A using ICCP.
18) ICCF sends a SIP ACK to UE C via S-CSCF and TAS.
19) ICCF sends a SIP Update request towards MGCF to active and redirects the
media to UE‑C.
20) MGCF responses a SIP 200 OK to ICCF.
Now the media path is established between UE‑A and UE C, and the announcement
is played to UE‑B.
NOTE: For the clarity of the call flow, the S-CSCF is not shown in the figure.
The messages between ICCF and TAS should pass through the S-CSCF, as well as
the messages between TAS and MRFC, UE‑B (UE C) and TAS etc.
###### ### Annex C: Comparative analysis of solutions for non ICS UE support
A CS network enhancement approach using L-CAAF-n in the visited CS network and
an approach using CAMEL redirection have been documented as two different
alternatives for ICS support of non ICS UEs. Table Y.1 below provides a
comparative analysis for the two alternatives.
Table C-1: L-CAAF-n vs. CAMEL solution for non ICS UE support
+----------------------+----------------------+----------------------+ | Analysis criteria | L-CAAF-n approach | CAMEL approach | +----------------------+----------------------+----------------------+ | **Call Setup | | | | Capabilities** | | | +----------------------+----------------------+----------------------+ | Calls to/from users | Supported. | Supported. | | addressable by E.164 | | | | numbers. | | | +----------------------+----------------------+----------------------+ | Calls to/from users | Call originations | Call originations | | addressable only by | from ICS user to a | from ICS user to a | | SIP-URIs | SIP URI is not | SIP URI not | | | possible due to UE | possible; CLI not | | | limitations; CLI not | presented for call | | | presented for call | terminations to ICS | | | terminations to ICS | user when SIP URI is | | | user when SIP URI is | used as caller\'s | | | used as caller\'s | identity. | | | identity. | | +----------------------+----------------------+----------------------+ | **Supplementary | | | | Service | | | | Capabilities** | | | +----------------------+----------------------+----------------------+ | Line ID services | Service controlled | Require service | | | exclusively in IMS. | configuration in the | | | Presentation of SIP | HLR. Presentation of | | | URI, and richer | SIP URI, and richer | | | modes such as | modes such as | | | picture/business | picture/business | | | card caller id as | card caller id as | | | CLI not possible. | CLI not possible. | +----------------------+----------------------+----------------------+ | Communication | Service controlled | CFU and CFNL | | Diversion services | exclusively in IMS. | provided exclusively | | | | in IMS. IMS may not | | | | be able to | | | | distinguish between | | | | CFB, CFNRy and | | | | CFNRc, so further | | | | study is required. | +----------------------+----------------------+----------------------+ | Call Hold, Conf, CW, | Service controlled | Service controlled | | ECT, Call Deflection | exclusively in IMS. | in CS domain. | +----------------------+----------------------+----------------------+ | **Supplementary | | | | Service Data | | | | Management** | | | +----------------------+----------------------+----------------------+ | Service data | Service data | Service data | | configuration | configuration in | configuration in IMS | | | IMS. Details of this | for services | | | is FFS. | controlled in IMS | | | | and in CS domain for | | | | services controlled | | | | in CS domain. | | | | Details of this is | | | | FFS. | +----------------------+----------------------+----------------------+ | User configuration | CISS interworked | Requires a solution | | of service data | with Ut in the | for interworking | | | L-CAAF-n. Details of | CISS with IMS. | | | this is FFS. | Details of this is | | | | FFS. | +----------------------+----------------------+----------------------+ | Service data | Requires service | Requires a solution | | synchronization | data synchronization | for static and | | | for roaming into CS | dynamic service data | | | networks not | synchronization for | | | upgraded with | services which are | | | L-CAAF-n. Details of | configured in IMS | | | this is FFS. | and CS domain such | | | | as the Line ID | | | | services. Details of | | | | this is FFS. | +----------------------+----------------------+----------------------+ | **VCC | | | | Capabilities [only | | | | applicable to VCC | | | | capable UE]** | | | +----------------------+----------------------+----------------------+ | Basic Service | Supported. | Supported. | | Continuity | | | +----------------------+----------------------+----------------------+ | Service Continuity | Supported. | Supported. | | with non mid call | | | | services | | | +----------------------+----------------------+----------------------+ | Service Continuity | Not possible due to | Not possible due to | | with mid call | UE limitations. | UE limitations. | | services | | | +----------------------+----------------------+----------------------+ | **Infrastructure | | | | Impact** | | | +----------------------+----------------------+----------------------+ | IMS Core Network | Requires AS and HSS | Requires AS and HSS | | impact | enhancements for | enhancements for | | | service data | service data | | | synchronization and | synchronization and | | | user configuration | user configuration | | | of service data for | of service data. | | | support of roaming | | | | to networks not | | | | upgraded with | | | | L-CAAF-n | | +----------------------+----------------------+----------------------+ | CS Core Network | Requires CS core | Requires HLR | | impact | network enhancements | enhancements for | | | for L-CAAF-n. | service data | | | | synchronization, and | | | Requires HLR | user configuration | | | enhancements for | of service data. | | | service data | | | | synchronization, and | Requires an | | | user configuration | interface between | | | of service data for | the gsmSCF and the | | | support of roaming | ICCF for | | | to networks not | communication of | | | upgraded with | call related data | | | L-CAAF-n. | such as Original | | | | Called Party Number | | | | for redirection of | | | | CS calls to IMS. | +----------------------+----------------------+----------------------+ | **Other criteria** | ** ** | ** ** | +----------------------+----------------------+----------------------+ | Support of Emergency | IMS Control of | IMS Control of | | calls | Emergency calls | Emergency calls | | | established via PS | established via CS | | | or CS access may be | access not possible. | | | possible but | Support of service | | | solutions for IMS | continuity for | | | control of Emergency | Emergency calls not | | | calls are FFS. | possible due to UE | | | Support of service | limitations. | | | continuity for | | | | Emergency calls not | | | | possible due to UE | | | | limitations. | | +----------------------+----------------------+----------------------+
###### ### Annex D: MGW Realization for the Enhanced MSC Server approach
**Option 1: New MGW and reference point**
In this option, a new logical MGW function would be defined to directly
interwork CS access interfaces (A and IuCS) with the Mb reference point. This
new MGW (i.e. different than the CS-MGW and IM-MGW) would be controlled by the
MSC Server via a new reference point I7. While the MGW function and reference
point would be new, they would be realized by a combination of the CS-MGW and
IM-MGW and the combined Mc and Mn reference points respectively.
{width="3.0097222222222224in" height="1.0722222222222222in"}
Figure D-1
This option involves the most impact to 3GPP specifications.
**Option 2: MSC Server support for IMS-MGW**
In this option, the Mn reference point would be added to the MSC Server,
allowing it to directly control the IMS-MGW. This effectively decouples the Mn
reference point from the MGCF function, as Mn would now be applicable to
multiple call control functions which interwork CS and IMS bearers. The bearer
interworking required by this architecture would involve both the CS-MGW and
IMS-MGW functions, which could obviously be combined into a single physical
node in implementation. The I7 reference point is realized by using both the
Mc and Mn reference points.
{width="3.8847222222222224in" height="1.6034722222222222in"}
Figure D-2
**Option 3: Co-location of MSC Server and MGCF**
In this option, the call control function is assumed to be a combination MSC
Server and MGCF, allowing it to directly control the CS-MGW and IMS-MGW
functions, which could obviously be combined into a single physical node in
implementation.
{width="3.9895833333333335in" height="1.636111111111111in"}
Figure D-3
While this option provides the Mn interface to the MSC Server/MGCF, it is
misleading as MGCF functionality (i.e. interworking between the Mg reference
point and either ISUP or BICC) as a whole is not required by the eMSC-S.
**Option 4: Reuse Mc changes being introduced for SIP-I**
R8 is adding SIP-I to the Nc reference point, which is also resulting in
changes to the Mc reference point. This will allow a MGW to interwork CS
access bearers and RTP bearer (which does not use NbUP framing). This is the
interworking required by this architecture, therefore this R8 work can be
leveraged.
{width="3.3125in" height="1.28125in"}
Figure D-4
These Mc changes are being specified in TS 23.231 (stage 2) and TS 29.231
(stage 3).
While this work in R8 is expected to provide the CS-MGW with the changes
required to meet the user plane requirements of this architecture, the CS-MGW
remains a CS domain node and these changes are being made to the Nb reference
point. i.e. the CS-MGW is not being enhanced to support the Mb reference
point.
#