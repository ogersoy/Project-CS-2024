# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document defines the Stage 2 service description for the Evolved
3GPP Packet Switched Domain - also known as the Evolved Packet System (EPS) in
this document. The Evolved 3GPP Packet Switched Domain provides IP
connectivity using the Evolved Universal Terrestrial Radio Access Network
(E-UTRAN).
The specification covers both roaming and non-roaming scenarios and covers all
aspects, including mobility between E-UTRAN and pre-E-UTRAN 3GPP radio access
technologies, policy control and charging, and authentication.
The Radio Access Network functionality is documented only to the extent
necessary to describe the overall system. TS 36.300 [5] contains the overall
description of the Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access Network (E-UTRAN).
ITU-T Recommendation I.130 [3] describes a three-stage method for
characterisation of telecommunication services, and ITU-T Recommendation Q.65
[4] defines Stage 2 of the method.
TS 23.402 [2] is a companion specification to this specification.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".
[3] ITU‑T Recommendation I.130: \"Method for the characterization of
telecommunication services supported by an ISDN and network capabilities of an
ISDN\".
[4] ITU‑T Recommendation Q.65: \"The unified functional methodology for the
characterization of services and network capabilities\".
[5] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access (E-UTRAN); Overall description;
Stage 2\".
[6] 3GPP TS 23.203: \"Policy and charging control architecture\".
[7] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[8] 3GPP TS 43.129: \"Packet-switched handover for GERAN A/Gb mode; Stage 2\".
[9] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[10] 3GPP TS 23.122: \"Non-Access-Stratum (NAS) functions related to Mobile
Station in idle mode\".
[11] 3GPP TS 43.022: \"Functions related to MS in idle mode and group receive
mode\".
[12] 3GPP TS 25.304: \"UE procedures in idle mode and procedures for cell re-
selection in connected mode\".
[13] 3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS);
Architecture and functional description\".
[14] 3GPP TS 29.060: \"GPRS Tunnelling Protocol (GTP) across the Gn and Gp
interface\".
[15] 3GPP TS 43.051: \"GERAN Overall description - Stage 2\".
[16] 3GPP TS 25.401: \"UTRAN overall description\".
[17] IETF RFC 1034 (1987): \"Domain names -- concepts and facilities\" (STD
13).
[18] IETF RFC 4862: \"IPv6 Stateless Address Autoconfiguration\".
[19] IETF RFC 2131: \"Dynamic Host Configuration Protocol\".
[20] IETF RFC 3736: \"Stateless Dynamic Host Configuration Protocol (DHCP)
Service for IPv6\".
[21] IETF RFC 3633: \"IPv6 Prefix Options for Dynamic Host Configuration
Protocol (DHCP) version 6\".
[22] 3GPP TS 25.413: \"UTRAN Iu interface Radio Access Network Application
Part (RANAP) signalling\".
[23] 3GPP TS 44.064: \"Mobile Station - Serving GPRS Support Node (MS-SGSN);
Logical Link Control (LLC) Layer Specification\".
[24] 3GPP TS 23.251: \"Network Sharing; Architecture and functional
description\".
[25] IETF RFC 4039: \"Rapid Commit Option for the Dynamic Host Configuration
Protocol version 4 (DHCPv4)\".
[26] IETF RFC 768: \"User Datagram Protocol\".
[27] 3GPP TS 23.221: \"Architectural requirements\".
[28] 3GPP TS 23.008: \"Organization of subscriber data\".
[29] 3GPP TS 23.078: \"Customized Applications for Mobile network Enhanced
Logic (CAMEL) Phase X; Stage 2\".
[30] 3GPP TS 23.236: \"Intra-domain connection of Radio Access Network (RAN)
nodes to multiple Core Network (CN) nodes\".
[31] IETF RFC 3588: \"Diameter Base Protocol\".
[32] IETF RFC 4861: \"Neighbor Discovery for IP Version 6 (IPv6)\".
[33] 3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol Specification\".
[34] 3GPP TS 36.304: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) procedures in idle mode\".
[35] IETF RFC 4960: \"Stream Control Transmission Protocol\".
[36] 3GPP TS 36.413: \"Evolved Universal Terrestrial Access Network (E-UTRAN);
S1 Application Protocol (S1AP)\".
[37] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
[38] 3GPP TS 29.061: \"Interworking between the Public Land Mobile Network
(PLMN) supporting packet based services and Packet Data Networks (PDN)\".
[39] IETF RFC 3041: \"Privacy Extensions for Stateless Address
Autoconfiguration in IPv6\".
[40] 3GPP TS 33.102: \"3G Security; Security architecture\".
[41] 3GPP TS 33.401: \"3GPP System Architecture Evolution: Security
Architecture\".
[42] 3GPP TS 48.018: \"General Packet Radio Service (GPRS); Base Station
System (BSS) - Serving GPRS Support Node (SGSN); BSS GPRS Protocol (BSSGP)\".
[43] 3GPP TS 29.274: \"General Packet Radio Service (GPRS); Evolved GPRS
Tunnelling Protocol (eGTP) for EPS\".
[44] 3GPP TS 32.251: \"Telecommunication management; Charging management;
Packet Switched (PS) domain charging\".
[45] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
aspects\".
[46] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[47] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core
Network Protocols; Stage 3\".
[48] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service
(CBS)\".
[49] 3GPP TS 22.042: \"Network Identity and Time Zone (NITZ) service
description; Stage 1\".
[50] Void.
[51] 3GPP TS 32.240: \"Charging architecture and principles\".
[52] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
[53] Void.
[54] 3GPP TS 23.107: \"Quality of Service (QoS) concept and architecture\".
[55] 3GPP TS 23.002: \"Network Architecture\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**MME Pool Area:** An MME Pool Area is defined as an area within which a UE
may be served without need to change the serving MME. An MME Pool Area is
served by one or more MMEs (\"pool of MMEs\") in parallel. MME Pool Areas are
a collection of complete Tracking Areas. MME Pool Areas may overlap each
other.
**Serving GW Service Area:** A **Serving GW Service** Area is defined as an
area within which a UE may be served without need to change the Serving GW. A
**Serving GW Service** Area is served by one or more Serving GWs in parallel.
**Serving GW Service** Areas are a collection of complete Tracking Areas.
**Serving GW Service** Areas may overlap each other.
**PDN Connection:** The association between a UE represented by one IPv4
address and/or one IPv6 prefix and a PDN represented by an APN.
**Default Bearer:** The EPS bearer which is first established for a new PDN
connection and remains established throughout the lifetime of the PDN
connection.
**Default APN:** A Default APN is defined as the APN which is marked as
default in the subscription data and used during the Attach procedure and the
UE requested PDN connectivity procedure when no APN is provided by the UE.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
AF Application Function
ARP Allocation and Retention Priority
AMBR Aggregate Maximum Bit Rate
CBC Cell Broadcast Centre
CBE Cell Broadcast Entity
DL TFT DownLink Traffic Flow Template
ECGI E-UTRAN Cell Global Identifier
ECM EPS Connection Management
EMM EPS Mobility Management
EPC Evolved Packet Core
EPS Evolved Packet System
E-RAB E-UTRAN Radio Access Bearer
E-UTRAN Evolved Universal Terrestrial Radio Access Network
GBR Guaranteed Bit Rate
GUMMEI Globally Unique MME Identifier
GUTI Globally Unique Temporary Identity
GW Gateway
HFN Hyper Frame Number
ISR Idle mode Signalling Reduction
OFCS Offline Charging System
LBI Linked EPS Bearer Id
MBR Maximum Bit Rate
MME Mobility Management Entity
MMEC MME Code
M-TMSI M-Temporary Mobile Subscriber Identity
OMC-ID Operation and Maintenance Centre Identity
P‑GW PDN Gateway
PDCP Packet Data Convergence Protocol
PMIP Proxy Mobile IP
PSAP Public Safety Answering Point
PTI Procedure Transaction Id
QCI QoS Class Identifier
S‑GW Serving Gateway
S-TMSI S-Temporary Mobile Subscriber Identity
SDF Service Data Flow
TAC Tracking Area Code
TAD Traffic Aggregate Description
TAI Tracking Area Identity
TAU Tracking Area Update
TI Transaction Identifier
TIN Temporary Identity used in Next update
URRP-MME UE Reachability Request Parameter for MME
UL TFT UpLink Traffic Flow Template
ULR-Flags Update Location Request Flags
# 4 Architecture model and concepts
## 4.1 General concepts
Local breakout of IP traffic via the visited PLMN is supported, when network
policies and user subscription allow it. Local breakout may be combined with
support for multiple simultaneous PDN connections, described in clause 5.10.
## 4.2 Architecture reference model
### 4.2.1 Non-roaming architecture
Figure 4.2.1-1: Non-roaming architecture for 3GPP accesses
Figure 4.2.1-2: Non-roaming architecture for 3GPP accesses. Single gateway
configuration option
NOTE 1: Also in this configuration option, S5 can be used between non
collocated Serving Gateway and PDN Gateway.
NOTE 2: Additional interfaces for 2G/3G access are shown in TS 23.060 [7].
### 4.2.2 Roaming architecture
{width="6.663888888888889in" height="4.011111111111111in"}
Figure 4.2.2-1: Roaming architecture for 3GPP accesses. Home routed traffic
NOTE 1: Additional interfaces/reference points for 2G/3G accesses are
documented in TS 23.060 [7].
The figures 4.2.2-2 and 4.2.2-3 represent the Roaming with local breakout case
with Application Function (AF) in the Home Network and in the Visited Network
respectively. The concurrent use of AF\'s in the home network and AF\'s in the
visited network is not excluded.
{width="6.674305555555556in" height="4.386111111111111in"}
Figure 4.2.2-2: Roaming architecture for local breakout, with home operator\'s
application functions only
NOTE 2: See TS 23.203 [6] for the role of and functions related to Home and
Visited PCRF and S9/Rx reference points.
NOTE 3: In figure 4.2.2‑2, the control plane signalling and the user plane for
accessing to Home Operator\'s services traverse over the SGi reference point
via the Visited Operator\'s PDN.
Figure 4.2.2-3: Roaming architecture for local breakout, with visited
operator\'s application functions only
### 4.2.3 Reference points
**S1-MME** : Reference point for the control plane protocol between E-UTRAN
and MME.
**S1-U** : Reference point between E-UTRAN and Serving GW for the per bearer
user plane tunnelling and inter eNodeB path switching during handover.
**S3** : It enables user and bearer information exchange for inter 3GPP access
network mobility in idle and/or active state.
**S4** : It provides related control and mobility support between GPRS Core
and the 3GPP Anchor function of Serving GW. In addition, if Direct Tunnel is
not established, it provides the user plane tunnelling.
**S5** : It provides user plane tunnelling and tunnel management between
Serving GW and PDN GW. It is used for Serving GW relocation due to UE mobility
and if the Serving GW needs to connect to a non-collocated PDN GW for the
required PDN connectivity.
**S6a** : It enables transfer of subscription and authentication data for
authenticating/authorizing user access to the evolved system (AAA interface)
between MME and HSS.
**Gx** : It provides transfer of (QoS) policy and charging rules from PCRF to
Policy and Charging Enforcement Function (PCEF) in the PDN GW.
**S8** : Inter-PLMN reference point providing user and control plane between
the Serving GW in the VPLMN and the PDN GW in the HPLMN. S8 is the inter PLMN
variant of S5.
**S9** : It provides transfer of (QoS) policy and charging control information
between the Home PCRF and the Visited PCRF in order to support local breakout
function.
**S10** : Reference point between MMEs for MME relocation and MME to MME
information transfer.
**S11** : Reference point between MME and Serving GW.
**S12** : Reference point between UTRAN and Serving GW for user plane
tunnelling when Direct Tunnel is established. It is based on the Iu-u/Gn-u
reference point using the GTP-U protocol as defined between SGSN and UTRAN or
respectively between SGSN and GGSN. Usage of S12 is an operator configuration
option.
**S13** : It enables UE identity check procedure between MME and EIR.
**SGi:** It is the reference point between the PDN GW and the packet data
network. Packet data network may be an operator external public or private
packet data network or an intra operator packet data network, e.g. for
provision of IMS services. This reference point corresponds to Gi for 3GPP
accesses.
**Rx** : The Rx reference point resides between the AF and the PCRF in the TS
23.203 [6].
When data forwarding is used as part of mobility procedures different user
plane routes may be used based on the network configuration (e.g. direct or
indirect data forwarding). These routes can be between eNodeB and RNC, eNodeB
and SGSN, RNC and S‑GW or between S‑GW and SGSN. Explicit reference points are
not defined for these routes.
Protocol assumption:
\- The S1-U is based on GTP-U protocol;
\- The S3 is based on GTP protocol;
\- The S4 is based on GTP protocol;
\- The S5 is based on GTP protocol. PMIP variant of S5 is described in TS
23.402 [2];
\- The S8 is based on GTP protocol. PMIP variant of S8 is described in TS
23.402 [2].
\- S3, S4, S5, S8, S10 and S11 interfaces are designed to manage EPS bearers
as defined in clause 4.7.2.
NOTE: Redundancy support on reference points S5 and S8 should be taken into
account.
### 4.2.4 Warning System architecture
Refer to TS 23.041 [48] and TS 23.002 [55] for the Warning System
architecture.
## 4.3 High level functions
### 4.3.1 General
The following list gives the logical functions performed within this system.
Several functional groupings (meta functions) are defined and each encompasses
a number of individual functions:
\- Network Access Control Functions.
\- Packet Routing and Transfer Functions.
\- Mobility Management Functions.
\- Security Functions.
\- Radio Resource Management Functions.
\- Network Management Functions.
### 4.3.2 Network access control functions
#### 4.3.2.1 General
Network access is the means by which a user is connected to the evolved packet
core system.
#### 4.3.2.2 Network/Access network selection
It is the means by which a UE selects a PLMN/Access network from which to gain
IP connectivity. The network/access network selection procedure varies for
different access technologies. For 3GPP access networks, the network selection
principles are described in TS 23.122 [10]. For 3GPP access networks, the
access network selection procedures are described in TS 36.300 [5], TS 43.022
[11] and TS 25.304 [12].
Architectural impacts stemming from support for network/access network
selection procedures for non-3GPP access and between 3GPP access and non-3GPP
accesses are described in TS 23.402 [2].
#### 4.3.2.3 Authentication and authorisation function
This function performs the identification and authentication of the service
requester, and the validation of the service request type to ensure that the
user is authorised to use the particular network services. The authentication
function is performed in association with the Mobility Management functions.
#### 4.3.2.4 Admission control function
The purpose of admission control is to determine if the requested resources
are available, and then reserve those resources.
#### 4.3.2.5 Policy and Charging Enforcement Function
This includes all the functionality of PCEF as defined by TS 23.203 [6]. The
PCEF encompasses service data flow detection, policy enforcement and flow
based charging functionalities as defined in TS 23.203 [6].
#### 4.3.2.6 Lawful Interception
Lawful interception is the action, performed by a network operator / access
provider / service provider, of making available certain information and
providing that information to a law enforcement monitoring facility.
### 4.3.3 Packet routing and transfer functions
#### 4.3.3.1 General
A route is an ordered list of nodes used for the transfer of packets within
and between the PLMN(s). Each route consists of the originating node, zero or
more relay nodes and the destination node. Routing is the process of
determining and using, in accordance with a set of rules, the route for
transmission of a message within and between the PLMN(s).
The EPS is an IP network and uses the standard routing and transport
mechanisms of the underlying IP network.
#### 4.3.3.2 IP header compression function
The IP header compression function optimises use of radio capacity by IP
header compression mechanisms.
#### 4.3.3.3 Packet screening function
The packet screening function provides the network with the capability to
check that the UE is using the exact IPv4-Address and/or IPv6-Prefix that was
assigned to the UE.
### 4.3.4 Security functions
#### 4.3.4.1 Ciphering function
The ciphering function preserves the confidentiality of user data and
signalling across the radio channels.
#### 4.3.4.2 Integrity protection function
The integrity protection function ensures the integrity of the signalling
between the UE and the network.
### 4.3.5 Mobility management functions
#### 4.3.5.1 General
The mobility management functions are used to keep track of the current
location of a UE.
#### 4.3.5.2 Reachability Management for UE in ECM-IDLE state
The location of a UE in ECM-IDLE state is known by the network on a Tracking
Area List granularity. A UE in ECM-IDLE state is paged in all cells of the
Tracking Areas in which it is currently registered. The UE may be registered
in multiple Tracking Areas. All the tracking areas in a Tracking Area List to
which a UE is registered are served by the same serving MME.
An EMM-REGISTERED UE performs periodic Tracking Area Updates with the network
after the expiry of the periodic TAU timer.
If the UE is out of E-UTRAN coverage (including the cases when the UE is
camped on GERAN/UTRAN cells) when its periodic TAU timer expires, the UE
shall:
\- if ISR is activated, start the E-UTRAN Deactivate ISR timer. After the
E-UTRAN Deactivate ISR timer expires the UE shall deactivate ISR by setting
its TIN to \"P-TMSI\".
\- if ISR is activated and the UE is camping on a GERAN/UTRAN cell (or returns
to coverage in GERAN/UTRAN) and the UE is EPS/IMSI attached, perform a LAU
procedure in NMO II/III or a combined RA/LA update procedure in NMO I.
\- when EMM-REGISTERED, perform a Tracking Area Update when it next returns to
E‑UTRAN coverage.
If the UE is camped on an E‑UTRAN cell or is in ECM‑CONNECTED state when the
UE\'s periodic RAU timer expires, the UE shall:
\- if ISR is activated, start the GERAN/UTRAN Deactivate ISR timer. After the
GERAN/UTRAN Deactivate ISR timer expires the UE shall deactivate ISR by
setting its TIN to \"GUTI\".
\- perform a Routing Area Update when it next returns to GERAN/UTRAN coverage.
If the UE is EPS attached only and either camps on an E UTRAN cell or is in
ECM CONNECTED state when the UE\'s periodic LAU timer expires, the UE shall
perform a Location Area Update procedure in NMO II/III or combined RA/LA
update in NMO I when it next returns to GERAN/UTRAN coverage.
The E-UTRAN Deactivate ISR timer is stopped when the UE performs a successful
Tracking Area Update or combined TA/LA Update and the GERAN/UTRAN Deactivate
ISR timer is stopped when the UE performs a successful Routing Area Update or
combined RA/LA Update.
Expiry of the periodic TAU timer, or, the periodic RAU timer, or, the periodic
LAU timer shall not cause the UE to change RAT.
The UE\'s periodic TAU timer is restarted from its initial value whenever the
UE enters ECM‑IDLE mode and when the UE leaves the E‑UTRAN connection due to
handover to GERAN/UTRAN. UTRAN RRC state transitions and GERAN GPRS
STANDBY/READY state transitions shall have no other impact on the periodic TAU
timer.
E‑UTRAN RRC state transitions shall have no impact on the periodic RAU timer
or periodic LAU timer except that handover from GERAN/UTRAN to E‑UTRAN shall
cause the periodic RAU timer to be started from its initial value.
Handover from E‑UTRAN to UTRAN/GERAN shall cause the periodic TAU timer to be
started from its initial value.
Typically, the MME runs a mobile reachable timer with a similar value to the
UE\'s periodic TAU timer. If this timer expires in the MME, the MME can deduce
that the UE is \'out of coverage\' at that moment. However, the MME does not
know for how long the UE has been out of coverage, so, the MME shall not
immediately delete the UE\'s bearers. Instead the MME should clear the PPF
flag in the MME and start an Implicit Detach timer, with a relatively large
value and if ISR is activated, at least slightly larger than the UE\'s E-UTRAN
Deactivate ISR timer. With the PPF clear, the MME does not page the UE in
E‑UTRAN coverage and shall send a Downlink Data Notification Reject message to
the Serving GW when receiving a Downlink Data Notification message from the
Serving GW. If this Implicit Detach timer expires before the UE contacts the
network, then the MME can deduce that the UE has been \'out of coverage\' for
a long period of time and implicitly detach the UE as described in clause
5.3.8.3 \"MME-initiated Detach procedure\".
NOTE 1: The SGSN has similar functionality as the MME.
NOTE 2: Alternative MME implementations are permitted, however, the externally
visible MME behaviour should conform to the above description.
#### 4.3.5.3 Tracking Area list management
Tracking Area list management comprises the functions to allocate and
reallocate a Tracking Area Identity list to the UE. All the tracking areas in
a Tracking Area List to which a UE is registered are served by the same
serving MME.
#### 4.3.5.4 Inter-eNodeB mobility anchor function
The Inter-eNodeB Mobility Anchor is the functional entity that anchors the
user plane for E-UTRAN mobility.
#### 4.3.5.5 Inter-3GPP mobility anchor function
The Inter-3GPP Mobility Anchor is the functional entity that anchors the user
plane for mobility between 3GPP 2G/3G access systems and the E-UTRA access
system.
#### 4.3.5.6 Idle mode signalling reduction function
The Idle mode Signalling Reduction (ISR) function provides a mechanism to
limit signalling during inter-RAT cell-reselection in idle mode (ECM-IDLE,
PMM-IDLE, GPRS STANDBY states).
NOTE: The Idle mode Signalling Reduction function is mandatory for E-UTRAN UEs
that support GERAN and/or UTRAN and optional for core network. The UE\'s ISR
capability in the UE Core Network Capability element is for test purpose.
ISR shall be activated by decision of the CN nodes and shall be explicitly
signalled to the UE as \"ISR activated\" in the RAU and TAU Accept messages.
The UE may have valid MM parameters both from MME and from SGSN. The
\"Temporary Identity used in Next update\" (TIN) is a parameter of the UE\'s
MM context, which identifies the UE identity that the UE shall indicate in the
next RAU Request, TAU Request or Attach Request message. The TIN also
identifies the status of ISR activation in the UE.
The TIN can take one of the three values, \"P‑TMSI\", \"GUTI\" or \"RAT-
related TMSI\". The UE shall set the TIN when receiving an Attach Accept, a
TAU Accept or RAU Accept message according to the rules in table 4.3.5.6-1.
Table 4.3.5.6-1: Setting of the TIN
+----------------------+----------------------+----------------------+ | Message received by | Current TIN value | TIN value to be set | | UE | stored by UE | by the UE when | | | | receiving message | +----------------------+----------------------+----------------------+ | Attach Accept via | Any value | GUTI | | E-UTRAN | | | | | | | | (never indicates | | | | \"ISR activated\") | | | +----------------------+----------------------+----------------------+ | Attach Accept via | Any value | P-TMSI | | GERAN/UTRAN | | | | | | | | (never indicates | | | | \"ISR activated\") | | | +----------------------+----------------------+----------------------+ | TAU Accept | Any value | GUTI | | | | | | not indicating \"ISR | | | | Activated\" | | | +----------------------+----------------------+----------------------+ | TAU Accept | GUTI | GUTI | | | | | | indicating \"ISR | P‑TMSI or | RAT-related TMSI | | Activated\" | RAT-related TMSI | | +----------------------+----------------------+----------------------+ | RAU Accept | Any value | P‑TMSI | | | | | | not indicating \"ISR | | | | Activated\" | | | +----------------------+----------------------+----------------------+ | RAU Accept | P‑TMSI | P‑TMSI | | | | | | indicating \"ISR | GUTI or RAT-related | RAT-related TMSI | | Activated\" | TMSI | | +----------------------+----------------------+----------------------+
When \"ISR Activated\" is indicated by the RAU/TAU Accept message but the UE
shall not set the TIN to \"RAT-related TMSI\" is a special situation. Here the
UE has deactivated ISR due to special situation handling. By maintaining the
old TIN value the UE remembers to use the RAT specific TMSI indicated by the
TIN when updating with the CN node of the other RAT.
Only if the TIN is set to \"RAT-related TMSI\" ISR behaviour is enabled for
the UE, i.e. the UE can change between all registered areas and RATs without
any update signalling and it listens for paging on the RAT it is camped on. If
the TIN is set to \"RAT-related TMSI\", the UE\'s P‑TMSI and RAI as well as
its GUTI and TAI(s) shall remain registered with the network and shall remain
valid in the UE.
Table 4.3.5.6-2: Temporary UE Identity that the UE shall indicate in Attach
Request and TAU/RAU Request (as \"old GUTI\" or as \"old P‑TMSI/RAI\"
information element)
* * *
Message to be sent by UE TIN value: P-TMSI TIN value: GUTI TIN value: RAT-
related TMSI TAU Request GUTI mapped from P‑TMSI/RAI GUTI GUTI RAU Request
P-TMSI/RAI P‑TMSI/RAI mapped from GUTI P‑TMSI/RAI Attach Request via E-UTRAN
GUTI mapped from P‑TMSI/RAI GUTI GUTI Attach Request via GERAN/UTRAN
P‑TMSI/RAI P‑TMSI/RAI mapped from GUTI P‑TMSI/RAI
* * *
Table 4.3.5.6-2 shows which temporary identity the UE shall indicate in a
Tracking or Routing Area Update Request or in an Attach Request message, when
the UE stores these as valid parameters.
Situations may occur that cause unsynchronized state information in the UE,
MME and SGSN. Such special situations trigger a deactivation of ISR locally in
the UE.
The UE shall deactivate ISR locally by setting its TIN to the temporary
identity of the currently used RAT in following special situations:
\- Modification of any EPS bearer context or PDP context which was activated
before the ISR is activated in the UE;
\- At the time when the UE moves from E_UTRAN to GERAN/UTRAN or moves from
GERAN/UTRAN to E‑UTRAN, if any EPS bearer context or PDP context activated
after the ISR was activated in the UE exists;
\- After updating either MME or SGSN about the change of the UE specific DRX
parameters to guarantee that the other CN node is also updated;
\- After updating either MME or SGSN about the change of the UE Core Network
Capabilities to guarantee that the other CN node is also updated;
\- E-UTRAN selection by a UTRAN-connected UE (e.g. when in URA_PCH to release
Iu on UTRAN side);
\- After a LAU procedure if the UE has CS fallback activated.
The UE shall deactivate ISR locally by setting its TIN to the temporary
identity of the RAT that is still available to the UE in following special
situations:
\- After the RAT-specific Deactivate ISR timer expires, e.g. because the
coverage of that RAT is lost or the RAT is no more selected by the UE (this
may result also in implicit detach by SGSN or MME).
ISR shall be deactivated in the UE by the CN node using normal update
signalling, i.e. by omitting the signalling of \"ISR Activated\", in following
special situations:
\- CN node change resulting in context transfer between the same type of CN
nodes (SGSN to SGSN or MME to MME);
\- Serving GW change.
#### 4.3.5.7 Mobility Restrictions
Mobility Restrictions comprises the functions for restrictions to mobility
handling of a UE in E-UTRAN access. The Mobility Restriction functionality is
provided by the UE, the radio access network and the core network.
Mobility Restriction functionality in state ECM-IDLE is executed in UE based
on information received from the core network. Mobility Restriction
functionality in state ECM-CONNECTED is executed in the radio network and the
core network.
In state ECM-CONNECTED, the core network provides the radio network with a
Handover Restriction List. The Handover Restriction List specifies roaming,
area and access restrictions. If roaming restriction to GERAN or UTRAN access
needs to be enforced, a MME that is connected to eNBs that may handover or
invoke release with redirection to UTRAN or GERAN is configured with a list of
HPLMN IDs that are permitted to access GERAN or UTRAN unless restricted by the
UE individual access restriction information received from HSS.
#### 4.3.5.8 IMS voice over PS Session Supported Indication
The serving PLMN shall send an indication toward the UE during the Attach
procedure and Tracking Area Update procedures if an IMS voice over PS session
is supported. The serving PLMN uses this indicator to indicate to the UE
whether it can expect a successful IMS voice over PS session. A UE with \"IMS
voice over PS\" voice capability should take this indication into account, as
specified in TS 23.221 [27].
NOTE: Support of IMS voice over PS session does not imply support of IMS
Emergency over PS, as specified in TS 23.221 [27].
The serving PLMN provides this indication based e.g., on local policy, HPLMN,
the SRVCC capability of the network and UE and/or extends of E-UTRAN/UTRAN
coverage. The serving PLMN shall indicate to the UE that the UE can expect a
successful IMS voice over PS session only if the MME is configured to know
that the serving PLMN has a roaming agreement for IMS voice with the HPLMN of
the UE. This indication is per TAI list.
### 4.3.6 Radio Resource Management functions
Radio resource management functions are concerned with the allocation and
maintenance of radio communication paths, and are performed by the radio
access network. The RRM strategy in E-UTRAN may be based on user specific
information.
To support radio resource management in E-UTRAN the MME provides the parameter
\'Index to RAT/Frequency Selection Priority\' (RFSP Index) to an eNodeB across
S1. The RFSP Index is mapped by the eNodeB to locally defined configuration in
order to apply specific RRM strategies. The RFSP Index is UE specific and
applies to all the Radio Bearers. Examples of how this parameter may be used
by the E-UTRAN:
\- to derive UE specific cell reselection priorities to control idle mode
camping.
\- to decide on redirecting active mode UEs to different frequency layers or
RATs.
The MME receives the RFSP Index from the HSS (e.g., during the Attach
procedure). For non-roaming subscribers the MME transparently forwards the
RFSP Index to the eNodeB across S1. For roaming subscribers the MME may
alternatively send an RFSP Index value to the eNodeB across S1 that is based
on the visited network policy (e.g., an RFSP Index pre-configured per HPLMN,
or a single RFSP Index value to be used for all roamers independent of the
HPLMN). The RFSP Index is also forwarded from source eNodeB to target eNodeB
when X2 is used for intra-E‑UTRAN handover.
The MME stores the RFSP Index value received from the HSS and the RFSP Index
value in use. The RFSP Index in use is derived based on visited network
policy. During inter-MME mobility procedures, the source MME forwards both
RFSP Index values to the target MME. If the target MME belongs to a different
PLMN than the source MME, then the target MME may replace the received RFSP
Index value in use with a new RFSP Index value in use that is based on the
policy of its PLMN.
The S1 messages that transfer the RFSP Index to the eNodeB are specified in TS
36.413 [36]. Refer to TS 36.300 [5] for further information on E-UTRAN.
### 4.3.7 Network management functions
#### 4.3.7.1 General
Network management functions provide mechanisms to support O&M functions
related to the Evolved Packet System.
#### 4.3.7.2 Load balancing between MMEs
The MME Load Balancing functionality permits UEs that are entering into an MME
Pool Area to be directed to an appropriate MME in a manner that achieves load
balancing between MMEs. This is achieved by setting a Weight Factor for each
MME, such that the probability of the eNodeB selecting an MME is proportional
to its Weight Factor. The Weight Factor is typically set according to the
capacity of an MME node relative to other MME nodes. The Weight Factor is sent
from the MME to the eNodeB via S1-AP messages (see TS 36.413 [36]).
NOTE 1: An operator may decide to change the Weight Factor after the
establishment of S1-MME connectivity as a result of changes in the MME
capacities. E.g., a newly installed MME may be given a very much higher Weight
Factor for an initial period of time making it faster to increase its load.
NOTE 2: It is intended that the Weight Factor is NOT changed frequently. e.g.
in a mature network, changes on a monthly basis could be anticipated, e.g. due
to the addition of RAN or CN nodes.
#### 4.3.7.3 Load re-balancing between MMEs
The MME Load Re-balancing functionality permits UEs that are registered on an
MME (within an MME Pool Area) to be moved to another MME.
NOTE 1: An example use for the MME Load Re-balancing function is for the O+M
related removal of one MME from an MME Pool Area.
NOTE 2: Typically, this procedure should not be used when the MME becomes
overloaded because the Load Balancing function should have ensured that the
other MMEs in the pool area are similarly overloaded.
The eNodeBs may have their Load Balancing parameters adjusted beforehand (e.g.
the Weight Factor is set to zero if all subscribers are to be removed from the
MME, which will route new entrants to the pool area into other MMEs).
In addition the MME may off-load a cross-section of its subscribers with
minimal impacts on the network and users (e.g. the MME should avoid offloading
only the low activity users while retaining the high activity subscribers.
Gradual rather than sudden off-loading should be performed as a sudden re-
balance of large number of subscribers could overload other MMEs in the pool.
With minimal impact on network and the user\'s experience, the subscribers
should be off-loaded as soon as possible). The load re-balancing can off-load
part of or all the subscribers.
To off-load ECM-CONNECTED mode UEs, the MME initiates the S1 Release procedure
with release cause \"load balancing TAU required\" (clause 5.3.5). The S1 and
RRC connections are released and the UE initiates a TAU but does not provide
registered MME information to eNodeB in the RRC establishment.
The MME should not release all S1 connections which are selected to be
released immediately when offloading is initiated. The MME may wait until the
S1 Release is performed due to inactivity. When the MME is to be offloaded
completely the MME can enforce an S1 Release for all remaining UEs that were
not offloaded by normal TAU procedures or by S1 releases caused by inactivity.
To off-load UEs which perform TA Updates or Attaches initiated in ECM-IDLE
mode, the MME completes that procedure and the procedure ends with the MME
releasing S1 with release cause \"load balancing TAU required\". The S1 and
RRC connections are released and the UE initiates a TAU but does not provide
registered MME information to eNodeB in the RRC establishment.
When the UE does not provide registered MME information in the RRC
establishment the eNodeB should select an MME based on the Weight Factors of
the MMEs in the pool.
To off-load UEs in ECM-IDLE state without waiting for the UE to perform a TAU
or perform Service request and become ECM‑CONNECTED, the MME first pages UE to
bring it to ECM-CONNECTED state. If paging the UE fails and ISR is activated,
the MME should adjust its paging retransmission strategy (e.g. limit the
number of short spaced retransmissions) to take into account the fact that the
UE might be in GERAN/UTRAN coverage.
#### 4.3.7.4 MME control of overload
The MME shall contain mechanisms for avoiding and handling overload
situations. These can include the use of NAS signalling to reject NAS requests
from UEs.
In addition, under unusual circumstances, the MME shall restrict the load that
its eNodeBs are generating on it if it is configured to enable the overload
restriction. This can be achieved by the MME invoking the S1 interface
overload procedure (see TS 36.300 [5] and TS 36.413 [36] to a proportion of
the eNodeB\'s with which the MME has S1 interface connections. To reflect the
amount of load that the MME wishes to reduce, the MME can adjust the
proportion of eNodeBs which are sent S1 interface OVERLOAD START message, and
the content of the OVERLOAD START message.
The MME should select the eNodeBs at random (so that if two MMEs within a pool
area are overloaded, they do not both send OVERLOAD START messages to exactly
the same set of eNodeBs).
Using the OVERLOAD START message, the MME can request the eNodeB to:
\- reject all RRC connection requests that are for non-emergency mobile
originated services; or
NOTE 1: This blocks PS service and service provided by the MSC following an
EPS/IMSI attach procedure.
\- reject all new RRC connection requests for EPS Mobility Management
signalling (e.g. for TA Updates) for that MME; or
\- only permit RRC connection establishments for emergency sessions for that
MME.
NOTE 2: The MME can restrict the number of responses to paging by not sending
paging messages for a proportion of the events that initiate paging.
NOTE 3: The support for emergency sessions (and subsequent support within
priority services) are not fully supported in this release.
When rejecting an RRC connection request for overload reasons the eNodeB
indicates to the UE an appropriate timer value that limits further RRC
connection requests for a while.
When the MME has recovered and wishes to increase its load, the MME sends
OVERLOAD STOP messages to the eNodeB(s).
Hardware and/or software failures within an MME may reduce the MME\'s load
handling capability. Typically such failures should result in alarms which
alert the operator/O+M system. Only if the operator/O+M system is sure that
there is spare capacity in the rest of the pool, the operator/O+M system might
use the load re-balancing procedure to move some load off this MME. However,
extreme care is needed to ensure that this load re-balancing does not overload
other MMEs within the pool area (or neighbouring SGSNs) as this might lead to
a much wider system failure.
### 4.3.8 Selection functions
#### 4.3.8.1 PDN GW selection function (3GPP accesses)
The PDN GW selection function allocates a PDN GW that shall provide the PDN
connectivity for the 3GPP access. The function uses subscriber information
provided by the HSS and possibly additional criteria. The PDN subscription
contexts provided by the HSS contain:
\- the identity of a PDN GW and an APN (PDN subscription contexts with
subscribed PDN GW address are not used when there is interoperation with pre
Rel‑8 2G/3G SGSN), or
\- an APN and an indication for this APN whether the allocation of a PDN GW
from the visited PLMN is allowed or whether a PDN GW from the home PLMN shall
be allocated. Optionally an identity of a PDN GW may be contained for handover
with non-3GPP accesses.
In the case of static address allocation, a static PDN GW is selected by
either having the APN configured to map to a given PDN GW, or the PDN GW
identity provided by the HSS indicates the static PDN GW.
The HSS also indicates which of the PDN subscription contexts is the Default
one for the UE.
To establish connectivity with a PDN when the UE is already connected to one
or more PDNs, the UE provides the requested APN for the PDN GW selection
function.
If one of the PDN subscription contexts provided by the HSS contains a wild
card APN (see TS 23.003 [9]), a PDN connection with dynamic address allocation
may be established towards any APN requested by the UE.
If the HSS provides the identity of a statically allocated PDN GW, or the HSS
provides the identity of a dynamically allocated PDN GW and the Request Type
indicates \"Handover\", no further PDN GW selection functionality is
performed. If the HSS provides the identity of a dynamically allocated PDN GW,
the HSS also provides information that identifies the PLMN in which the PDN GW
is located.
NOTE 1: The MME uses this information to determine an appropriate APN-OI and
S8 protocol type (PMIP or GTP) when the MME and PDN GW are located in
different PLMNs.
If the HSS provides the identity of a dynamically allocated PDN GW and the
Request Type indicates \"initial Request \", either the provided PDN GW is
used or a new PDN GW is selected. The PDN GW identity refers to a specific PDN
GW. If the PDN GW identity includes the IP address of the PDN GW, that IP
address shall be used as the PDN GW IP address; otherwise the PDN GW identity
includes an FQDN which is used to derive the PDN GW IP address by using Domain
Name Service function, taking into account the protocol type on S5/S8 (PMIP or
GTP).
NOTE 2: Provision of a PDN GW identity of a PDN GW as part of the subscriber
information allows also for a PDN GW allocation by HSS.
If the HSS provides a PDN subscription context that allows for allocation of a
PDN GW from the visited PLMN for this APN, the PDN GW selection function
derives a PDN GW identity from the visited PLMN. If a visited PDN GW identity
cannot be derived, or if the subscription does not allow for allocation of a
PDN GW from the visited PLMN, then the APN is used to derive a PDN GW identity
from the HPLMN. The PDN GW identity is derived from the APN, subscription data
and additional information by using the Domain Name Service function. If the
PDN GW identity is a logical name instead of an IP address, the PDN GW address
is derived from the PDN GW identity, protocol type on S5/S8 (PMIP or GTP) by
using the Domain Name Service function. The S8 protocol type (PMIP or GTP) is
configured per HPLMN in MME/SGSN.
If the APN‑OI Replacement field exists in the subscription data, the PDN GW
domain name will be constructed by replacing the APN‑OI with the value
received in the APN‑OI Replacement field for home routed traffic. Otherwise,
or when the resolution of the above PDN GW domain name fails, the PDN GW
domain name will be constructed by appending the appropriate APN-OI labels by
the serving node specified in Annex A of TS 23.060 [7] and TS 23.003 [9]. If
the Domain Name Service function provides a list of PDN GW addresses, one PDN
GW address is selected from this list. If the selected PDN GW cannot be used,
e.g. due to an error, then another PDN GW is selected from the list. The
specific interaction between the MME/SGSN and the Domain Name Service function
may include functionality to allow for the retrieval or provision of
additional information regarding the PDN GW capabilities (e.g. whether the PDN
GW supports PMIP‑based or GTP-based S5/S8, or both).
The APN as constructed by the MME/SGSN is provided in charging data, to other
SGSN and MME over the S3, S10 and S16 interfaces as well as to Serving GW and
PDN GW over the S11, S4 and S5/S8 interfaces with the following
clarifications:
\- If the PDN GW domain name was constructed using the APN-OI Replacement
field and the last three labels of the APN-OI Replacement field is on the
default APN-OI format as specified in TS 23.003 [9], (i.e.
\"mnc\.mcc\.gprs\"), the MME/SGSN shall use the last three labels of
the APN-OI Replacement field when constructing the APN to be sent to another
MME, SGSN and Serving GW.
NOTE 3: In order to comply with the APN-OI definition in TS 23.003 [9], the
APN-OI will contain three labels when being sent to other network entities as
part of a full APN. This is the case even if the APN used for PDN GW selection
with the DNS function is constructed from an APN-OI Replacement field with a
different number of labels.
\- If the PDN GW domain name was constructed using the APN-OI Replacement
field and the APN-OI Replacement field (last or only three labels) is not on
the default APN-OI format, the MME/SGSN uses a default APN-OI based on the
PLMN ID derived from the IMSI when constructing the APN to be sent to another
MME, SGSN and Serving GW.
If the UE provides an APN for a PDN, this APN is then used to derive the PDN
GW identity as specified for the case of HSS provided APN if one of the
subscription contexts allows for this APN.
If there is an existing PDN connection to the same APN used to derive the PDN
GW address, the same PDN GW shall be selected.
As part of PDN GW selection, an IP address of the assigned PDN GW may be
provided to the UE for use with host based mobility as defined in TS 23.402
[2], if the PDN GW supports host-based mobility for inter-access mobility
towards accesses where host-based mobility can be used. If a UE explicitly
requests the address of the PDN GW and the PDN GW supports host based mobility
then the PDN GW address shall be returned to the UE.
#### 4.3.8.2 Serving GW selection function
The Serving GW selection function selects an available Serving GW to serve a
UE. The selection bases on network topology, i.e. the selected Serving GW
serves the UE\'s location and for overlapping Serving GW service areas, the
selection may prefer Serving GWs with service areas that reduce the
probability of changing the Serving GW. Other criteria for Serving GW
selection should include load balancing between Serving GWs.
If a subscriber of a GTP only network roams into a PMIP network, the PDN GWs
selected for local breakout support the PMIP protocol, while PDN GWs for home
routed traffic use GTP. This means the Serving GW selected for such
subscribers may need to support both GTP and PMIP, so that it is possible to
set up both local breakout and home routed sessions for these subscribers. For
a Serving GW supporting both GTP and PMIP, the MME/SGSN should indicate the
Serving GW which protocol should be used over S5/S8 interface. The MME/SGSN is
configured with the S8 variant(s) on a per HPLMN granularity.
If a subscriber of a GTP only network roams into a PMIP network, the PDN GWs
selected for local breakout may support GTP or the subscriber may not be
allowed to use PDN GWs of the visited network. In both cases a GTP only based
Serving GW may be selected. These cases are considered as roaming between GTP
based operators.
If combined Serving and PDN GWs are configured in the network the Serving GW
Selection Function preferably derives a Serving GW that is also a PDN GW for
the UE.
The Domain Name Service function may be used to resolve a DNS string into a
list of possible Serving GW addresses which serve the UE\'s location. The
specific interaction between the MME/SGSN and the Domain Name Service function
may include functionality to allow for the retrieval or provision of
additional information regarding the Serving GW capabilities (e.g. whether the
Serving GW supports PMIP-based or GTP-based S5/S8, or both). The details of
the selection are implementation specific.
For handover from non-3GPP accesses in roaming scenario, the Serving GW
selection function for local anchoring is described in TS 23.402 [2].
The Serving GW selection function in the MME is used to ensure that all
Tracking Areas in the Tracking Area List belong to the same Serving GW service
area.
#### 4.3.8.3 MME selection function
The MME selection function selects an available MME for serving a UE. The
selection is based on network topology, i.e. the selected MME serves the UE\'s
location and for overlapping MME service areas, the selection may prefer MMEs
with service areas that reduce the probability of changing the MME. When a
MME/SGSN selects a target MME, the selection function performs a simple load
balancing between the possible target MMEs. When an eNodeB selects an MME, the
selection shall achieve load balancing as specified in clause 4.3.7.2.
#### 4.3.8.4 SGSN selection function
The SGSN selection function selects an available SGSN to serve a UE. The
selection is based on network topology, i.e. the selected SGSN serves the
UE\'s location and for overlapping SGSN service areas, the selection may
prefer SGSNs with service areas that reduce the probability of changing the
SGSN. When a MME/SGSN selects a target SGSN, the selection function performs a
simple load balancing between the possible target SGSNs.
#### 4.3.8.5 Selection of PCRF
The PDN GW and AF may be served by one or more PCRF nodes in the HPLMN and, in
roaming with local breakout scenarios, one or more PCRF nodes in the VPLMN.
The selection of PCRF and linking of the different UE\'s PCC sessions over the
multiple PCRF interfaces (e.g. Rx session, Gx session, S9 session etc.) for a
UE IP CAN session is described in TS 23.203 [6].
### 4.3.9 IP network related functions
#### 4.3.9.1 Domain Name Service function
The Domain Name Service function resolves logical PDN GW names to PDN GW
addresses. This function is standard Internet functionality according to RFC
1034 [17], which allows resolution of any name to an IP address (or addresses)
for PDN GWs and other nodes within the EPS.
#### 4.3.9.2 DHCP function
The Dynamic Host Configuration Function allows to deliver IP configuration
information for UEs. This function is standard Internet functionality
according to RFC 2131 [19], RFC 3736 [20], RFC 3633 [21] and RFC 4039 [25].
### 4.3.10 Functionality for Connection of eNodeBs to Multiple MMEs
An eNodeB may connect to several MMEs. This implies that an eNodeB must be
able to determine which of the MMEs, covering the area where an UE is located,
should receive the signalling sent from a UE. To avoid unnecessary signalling
in the core network, a UE that has attached to one MME should generally
continue to be served by this MME as long as the UE is in the radio coverage
of the pool area to which the MME is associated. The concept of pool area is a
RAN based definition that comprises one or more TA(s) that, from a RAN
perspective, are served by a certain group of MMEs. This does not exclude that
one or more of the MMEs in this group serve TAs outside the pool area. This
group of MMEs is also referred to as an MME pool.
To enable the eNodeB to determine which MME to select when forwarding messages
from an UE, this functionality defines a routing mechanism (and other related
mechanism). A routing mechanism (and other related mechanism) is defined for
the MMEs. The routing mechanism is required to find the correct old MME (from
the multiple MMEs that are associated with a pool area). When a UE roams out
of the pool area and into the area of one or more MMEs that do not know about
the internal structure of the pool area where the UE roamed from, the new MME
will send the Identification Request message or the Context Request message to
the old MME using the GUTI. The routing mechanism in both the MMEs and the
eNodeB utilises the fact that every MME that serves a pool area must have its
own unique value range of the GUTI parameter within the pool area.
### 4.3.11 E-UTRAN Sharing Function
E‑UTRAN Sharing is an agreement between operators and shall be transparent to
the user. This implies that an E‑UTRAN UE needs to be able to discriminate
between core network operators available in a shared radio access network and
that these operators can be handled in the same way as operators in non-shared
networks. E‑UTRAN terminals support E‑UTRAN Sharing.
An E‑UTRAN Sharing architecture allows different core network operators to
connect to a shared radio access network. The operators do not only share the
radio network elements, but may also share the radio resources themselves. In
addition to this shared radio access network the operators may or may not have
additional dedicated radio access networks, like for example, 3G or 2G radio
access networks. For E‑UTRAN both Multi-Operator Core Network (MOCN)
configuration and Gateway Core Network (GWCN) configuration as defined in TS
23.251 [24] are supported over the S1 reference point. E‑UTRAN terminals shall
support shared networks and hence, only functions for \"Supporting UEs\" in TS
23.251 [24] applies for E‑UTRAN Sharing.
E‑UTRAN Radio Access Network Sharing functions is further described in TS
36.300 [5].
## 4.4 Network elements
### 4.4.1 E-UTRAN
E-UTRAN is described in more detail in TS 36.300 [5].
In addition to the E-UTRAN functions described in TS 36.300 [5], E-UTRAN
functions include:
\- Header compression and user plane ciphering;
\- MME selection when no routing to an MME can be determined from the
information provided by the UE;
\- UL bearer level rate enforcement based on UE-AMBR and MBR via means of
uplink scheduling\ (e.g. by limiting the amount of UL resources granted per UE
over time);
\- DL bearer level rate enforcement based on UE-AMBR;
\- UL and DL bearer level admission control;
\- Transport level packet marking in the uplink, e.g. setting the DiffServ
Code Point, based on the QCI of the associated EPS bearer.
### 4.4.2 MME
MME functions include:
\- NAS signalling;
\- NAS signalling security;
\- Inter CN node signalling for mobility between 3GPP access networks
(terminating S3);
\- UE Reachability in ECM-IDLE state (including control and execution of
paging retransmission);
\- Tracking Area list management;
\- PDN GW and Serving GW selection;
\- MME selection for handovers with MME change;
\- SGSN selection for handovers to 2G or 3G 3GPP access networks;
\- Roaming (S6a towards home HSS);
\- Authentication;
\- Authorization;
\- Bearer management functions including dedicated bearer establishment;
\- Lawful Interception of signalling traffic;
\- Warning message transfer function (including selection of appropriate
eNodeB);
\- UE Reachability procedures.
NOTE: The Serving GW and the MME may be implemented in one physical node or
separated physical nodes.
### 4.4.3 Gateway
#### 4.4.3.1 General
Two logical Gateways exist:
\- Serving GW (S‑GW);
\- PDN GW (P‑GW).
NOTE: The PDN GW and the Serving GW may be implemented in one physical node or
separated physical nodes.
#### 4.4.3.2 Serving GW
The Serving GW is the gateway which terminates the interface towards E-UTRAN.
For each UE associated with the EPS, at a given point of time, there is a
single Serving GW.
The functions of the Serving GW, for both the GTP-based and the PMIP-based
S5/S8, include:
\- the local Mobility Anchor point for inter-eNodeB handover;
\- sending of one or more \"end marker\" to the source eNodeB, source SGSN or
source RNC immediately after switching the path during inter-eNodeB and inter-
RAT handover, especially to assist the reordering function in eNodeB.
\- Mobility anchoring for inter-3GPP mobility (terminating S4 and relaying the
traffic between 2G/3G system and PDN GW);
\- ECM-IDLE mode downlink packet buffering and initiation of network triggered
service request procedure;
\- Lawful Interception;
\- Packet routing and forwarding;
\- Transport level packet marking in the uplink and the downlink, e.g. setting
the DiffServ Code Point, based on the QCI of the associated EPS bearer;
\- Accounting for inter-operator charging. For GTP-based S5/S8, the Serving GW
generates accounting data per UE and bearer;
\- Interfacing OFCS according to charging principles and through reference
points specified in TS 32.240 [51].
Additional Serving GW functions for the PMIP-based S5/S8 are captured in TS
23.402 [2].
Connectivity to a GGSN is not supported.
#### 4.4.3.3 PDN GW
The PDN GW is the gateway which terminates the SGi interface towards the PDN.
If a UE is accessing multiple PDNs, there may be more than one PDN GW for that
UE, however a mix of S5/S8 connectivity and Gn/Gp connectivity is not
supported for that UE simultaneously.
PDN GW functions include for both the GTP-based and the PMIP-based S5/S8:
\- Per-user based packet filtering (by e.g. deep packet inspection);
\- Lawful Interception;
\- UE IP address allocation;
\- Transport level packet marking in the uplink and downlink, e.g. setting the
DiffServ Code Point, based on the QCI of the associated EPS bearer;
\- Accounting for inter-operator charging;
\- UL and DL service level charging as defined in TS 23.203 [6]\ (e.g. based
on SDFs defined by the PCRF, or based on deep packet inspection defined by
local policy);
\- Interfacing OFCS through according to charging principles and through
reference points specified in TS 32.240 [51].
\- UL and DL service level gating control as defined in TS 23.203 [6];
\- UL and DL service level rate enforcement as defined in TS 23.203 [6]\ (e.g.
by rate policing/shaping per SDF);
\- UL and DL rate enforcement based on APN-AMBR\ (e.g. by rate
policing/shaping per aggregate of traffic of all SDFs of the same APN that are
associated with Non-GBR QCIs);
\- DL rate enforcement based on the accumulated MBRs of the aggregate of SDFs
with the same GBR QCI\ (e.g. by rate policing/shaping);
\- DHCPv4 (server and client) and DHCPv6 (client and server) functions;
\- The network does not support PPP bearer type in this version of the
specification. Pre-Release 8 PPP functionality of a GGSN may be implemented in
the PDN GW;
\- packet screening.
Additionally the PDN GW includes the following functions for the GTP-based
S5/S8:
\- UL and DL bearer binding as defined in TS 23.203 [6];
\- UL bearer binding verification as defined in TS 23.203 [6];
\- Functionality as defined in RFC 4861 [32];
\- Accounting per UE and bearer.
The P‑GW provides PDN connectivity to both GERAN/UTRAN only UEs and E‑UTRAN
capable UEs using any of E‑UTRAN, GERAN or UTRAN. The P‑GW provides PDN
connectivity to E‑UTRAN capable UEs using E‑UTRAN only over the S5/S8
interface.
### 4.4.4 SGSN
In addition to the functions described in TS 23.060 [7], SGSN functions
include:
\- Inter EPC node signalling for mobility between 2G/3G and E-UTRAN 3GPP
access networks;
\- PDN and Serving GW selection: the selection of S‑GW/P‑GW by the SGSN is as
specified for the MME;
\- MME selection for handovers to E-UTRAN 3GPP access network.
### 4.4.5 GERAN
GERAN is described in more detail in TS 43.051 [15].
### 4.4.6 UTRAN
UTRAN is described in more detail in TS 25.401 [16].
### 4.4.7 PCRF
#### 4.4.7.1 General
PCRF is the policy and charging control element. PCRF functions are described
in more detail in TS 23.203 [6].
In non-roaming scenario, there is only a single PCRF in the HPLMN associated
with one UE\'s IP-CAN session. The PCRF terminates the Rx interface and the Gx
interface.
In a roaming scenario with local breakout of traffic there may be two PCRFs
associated with one UE\'s IP-CAN session:
\- H-PCRF that resides within the H-PLMN;
\- V-PCRF that resides within the V-PLMN.
#### 4.4.7.2 Home PCRF (H-PCRF)
The functions of the H-PCRF include:
\- terminates the Rx reference point for home network services;
\- terminates the S9 reference point for roaming with local breakout;
\- associates the sessions established over the multiple reference points (S9,
Rx), for the same UE\'s IP-CAN session (PCC session binding).
The functionality of H-PCRF is described in TS 23.203 [6].
#### 4.4.7.3 Visited PCRF (V-PCRF)
The functions of the V-PCRF include:
\- terminates the Gx and S9 reference points for roaming with local breakout;
\- terminates Rx for roaming with local breakout and visited operator\'s
Application Function.
The functionality of V-PCRF is described in TS 23.203 [6].
### 4.4.8 PDN GW\'s associated AAA Server
The PDN Gateway may interact with a AAA server over the SGi interface. This
AAA Server may maintain information associated with UE access to the EPC and
provide authorization and other network services. This AAA Server could be a
RADIUS or Diameter Server in an external PDN network, as defined in TS 29.061
[38]. This AAA Server is logically separate from the HSS and the 3GPP AAA
Server.
## 4.5 Void
## 4.6 EPS Mobility Management and Connection Management states
### 4.6.1 General
The EPS Mobility Management (EMM) states describe the Mobility Management
states that result from the mobility management procedures e.g. Attach and
Tracking Area Update procedures.
Two EMM states are described in this document:
\- EMM-DEREGISTERED.
\- EMM-REGISTERED.
NOTE 1: Other specifications may define more detailed EMM states (see e.g. TS
24.301 [46]).
The EPS Connection Management (ECM) states describe the signalling
connectivity between the UE and the EPC.
Two ECM states are described in this document:
\- ECM-IDLE.
\- ECM-CONNECTED.
NOTE 2: The ECM-CONNECTED and ECM-IDLE states used in this document correspond
respectively to the EMM-CONNECTED and ECM-IDLE modes defined in TS 24.301
[46].
In general, the ECM and EMM states are independent of each other. Transition
from EMM-REGISTERED to EMM-DEREGISTERED can occur regardless of the ECM state,
e.g. by explicit detach signalling in ECM-CONNECTED or by implicit detach
locally in the MME during ECM-IDLE. However there are some relations, e.g. to
transition from EMM-DEREGISTERED to EMM-REGISTERED the UE has to be in the
ECM-CONNECTED state.
### 4.6.2 Definition of main EPS Mobility Management states
#### 4.6.2.1 EMM-DEREGISTERED
In the EMM‑DEREGISTERED state, the EMM context in MME holds no valid location
or routing information for the UE. The UE is not reachable by a MME, as the UE
location is not known.
In the EMM-DEREGISTERED state, some UE context can still be stored in the UE
and MME, e.g. to avoid running an AKA procedure during every Attach procedure.
#### 4.6.2.2 EMM-REGISTERED
The UE enters the EMM-REGISTERED state by a successful registration with an
Attach procedure to either E-UTRAN or GERAN/UTRAN. The MME enters the EMM-
REGISTERED state by a successful Tracking Area Update procedure for a UE
selecting an E-UTRAN cell from GERAN/UTRAN or by an Attach procedure via
E-UTRAN. In the EMM-REGISTERED state, the UE can receive services that require
registration in the EPS.
NOTE: The UE employs a single combined state machine for EMM and GMM states.
The UE location is known in the MME to at least an accuracy of the tracking
area list allocated to that UE (excluding some abnormal cases).
In the EMM-REGISTERED state, the UE shall:
\- always have at least one active PDN connection;
\- setup the EPS security context.
After performing the Detach procedure, the state is changed to EMM-
DEREGISTERED in the UE and in the MME. Upon receiving the TAU Reject and
Attach Reject messages the actions of the UE and MME depend upon the \'cause
value\' in the reject message, but, in many cases the state is changed to EMM-
DEREGISTERED in the UE and in the MME.
If all the bearers belonging to a UE are released (e.g., after handover from
E‑UTRAN to non-3GPP access), the MME shall change the MM state of the UE to
EMM-DEREGISTERED. If the UE camps on E-UTRAN and the UE detects that all of
its bearers are released, the UE shall change the MM state to EMM-
DEREGISTERED. If all the bearers (PDP contexts) belonging to a UE are
released, while the UE camps on GERAN/UTRAN, the UE shall deactivate ISR by
setting its TIN to \"P-TMSI\" as specified in TS 23.060 [7]. This ensures that
the UE performs Tracking Area Update when it re-selects E-UTRAN. If the UE
switches off its E‑UTRAN interface when performing handover to non-3GPP
access, the UE shall automatically change its MM state to EMM-DEREGISTERED.
The MME may perform an implicit detach any time after the Implicit Detach
timer expires. The state is changed to EMM-DEREGISTERED in the MME after
performing the implicit detach.
### 4.6.3 Definition of EPS Connection Management states
#### 4.6.3.1 ECM-IDLE
A UE is in ECM-IDLE state when no NAS signalling connection between UE and
network exists. In ECM-IDLE state, a UE performs cell selection/reselection
according to TS 36.304 [34] and PLMN selection according to TS 23.122 [10].
There exists no UE context in E-UTRAN for the UE in the ECM-IDLE state. There
is no S1_MME and no S1_U connection for the UE in the ECM-IDLE state.
In the EMM-REGISTERED and ECM-IDLE state, the UE shall:
\- perform a tracking area update if the current TA is not in the list of TAs
that the UE has received from the network in order to maintain the
registration and enable the MME to page the UE;
\- perform the periodic tracking area updating procedure to notify the EPC
that the UE is available;
\- perform a tracking area update if the RRC connection was released with
release cause \"load balancing TAU required\";
\- perform a tracking area update when the UE reselects an E-UTRAN cell and
the UE\'s TIN indicates \"P-TMSI\";
\- perform a tracking area update for a change of the UE\'s Core Network
Capability information or the UE specific DRX parameter;
\- answer to paging from the MME by performing a service request procedure;
\- perform the service request procedure in order to establish the radio
bearers when uplink user data is to be sent.
The UE and the MME shall enter the ECM-CONNECTED state when the signalling
connection is established between the UE and the MME. Initial NAS messages
that initiate a transition from ECM-IDLE to ECM-CONNECTED state are Attach
Request, Tracking Area Update Request, Service Request or Detach Request.
When the UE is in ECM‑IDLE state, the UE and the network may be
unsynchronized, i.e. the UE and the network may have different sets of
established EPS bearers. When the UE and the MME enter the ECM‑CONNECTED
state, the set of EPS Bearers is synchronized between the UE and network.
#### 4.6.3.2 ECM-CONNECTED
The UE location is known in the MME with an accuracy of a serving eNodeB ID.
The mobility of UE is handled by the handover procedure.
The UE performs the tracking area update procedure when the TAI in the EMM
system information is not in the list of TA\'s that the UE registered with the
network, or when the UE handovers to an E‑UTRAN cell and the UE\'s TIN
indicates \"P-TMSI\".
For a UE in the ECM-CONNECTED state, there exists a signalling connection
between the UE and the MME. The signalling connection is made up of two parts:
an RRC connection and an S1_MME connection.
The UE shall enter the ECM-IDLE state when its signalling connection to the
MME has been released or broken. This release or failure is explicitly
indicated by the eNodeB to the UE or detected by the UE.
The S1 release procedure changes the state at both UE and MME from ECM-
CONNECTED to ECM-IDLE.
NOTE 1: The UE may not receive the indication for the S1 release, e.g. due to
radio link error or out of coverage. In this case, there can be temporal
mismatch between the ECM-state in the UE and the ECM-state in the MME.
After a signalling procedure, the MME may decide to release the signalling
connection to the UE, after which the state at both the UE and the MME is
changed to ECM-IDLE.
NOTE 2: There are some abnormal cases where the UE transitions to ECM-IDLE.
When a UE changes to ECM‑CONNECTED state and if a radio bearer cannot be
established, or the UE cannot maintain a bearer in the ECM-CONNECTED state
during handovers, the corresponding EPS bearer is deactivated.
### 4.6.4 State transition and functions
Figure 4.6.4-1: EMM state model in UE
Figure 4.6.4-2: EMM state model in MME
{width="4.728472222222222in" height="1.6979166666666667in"}
Figure 4.6.4-3: ECM state model in UE
{width="4.728472222222222in" height="1.6979166666666667in"}
Figure 4.6.4-4: ECM state model in MME
## 4.7 Overall QoS concept
### 4.7.1 PDN connectivity service
The Evolved Packet System provides IP connectivity between a UE and a PLMN
external packet data network. This is referred to as PDN Connectivity Service.
The PDN Connectivity Service supports the transport of traffic flow
aggregate(s), consisting of one or more Service Data Flows (SDFs).
NOTE: The concept of SDF is defined in the context of PCC, TS 23.203 [6], and
is not explicitly visible in the NAS signalling.
### 4.7.2 The EPS bearer
#### 4.7.2.1 The EPS bearer in general
For E-UTRAN access to the EPC the PDN connectivity service is provided by an
EPS bearer for GTP-based S5/S8, and by an EPS bearer concatenated with IP
connectivity between Serving GW and PDN GW for PMIP-based S5/S8.
An EPS bearer uniquely identifies traffic flows that receive a common QoS
treatment between a UE and a PDN GW for GTP-based S5/S8, and between UE and
Serving GW for PMIP-based S5/S8. The packet filters signalled in the NAS
procedures are associated with a unique packet filter identifier on per-PDN
connection basis.
NOTE 1: The EPS Bearer Identity together with the packet filter identifier is
used to reference which packet filter the UE intends to modify or delete, i.e.
it is used to implement the unique packet filter identifier.
The EPS bearer traffic flow template (TFT) is the set of all packet filters
associated with that EPS bearer.
An EPS bearer is the level of granularity for bearer level QoS control in the
EPC/E-UTRAN. That is, all traffic mapped to the same EPS bearer receive the
same bearer level packet forwarding treatment (e.g. scheduling policy, queue
management policy, rate shaping policy, RLC configuration, etc.). Providing
different bearer level packet forwarding treatment requires separate EPS
bearers.
NOTE 2: In addition but independent to bearer level QoS control, the PCC
framework allows an optional enforcement of service level QoS control on the
granularity of SDFs independent of the mapping of SDFs to EPS bearers.
One EPS bearer is established when the UE connects to a PDN, and that remains
established throughout the lifetime of the PDN connection to provide the UE
with always-on IP connectivity to that PDN. That bearer is referred to as the
default bearer. Any additional EPS bearer that is established for the same PDN
connection is referred to as a dedicated bearer.
An UpLink Traffic Flow Template (UL TFT) is the set of uplink packet filters
in a TFT. A DownLink Traffic Flow Template (DL TFT) is the set of downlink
packet filters in a TFT. Every dedicated EPS bearer is associated with a TFT.
The UE uses the UL TFT for mapping traffic to an EPS bearer in the uplink
direction. The PCEF (for GTP-based S5/S8) or the BBERF (for PMIP-based S5/S8)
uses the DL TFT for mapping traffic to an EPS bearer in the downlink
direction. The UE may use the UL TFT and DL TFT to associate EPS Bearer
Activation or Modification procedures to an application and to traffic flow
aggregates of the application. Therefore the PDN GW shall, in the Create
Dedicated Bearer Request and the Update Bearer Request messages, provide all
available traffic flow description information (e.g. source and destination IP
address and port numbers and the protocol information).
For the UE, the evaluation precedence order of the packet filters making up
the UL TFTs is signalled from the P‑GW to the UE as part of any appropriate
TFT operations.
NOTE 3: The evaluation precedence index of the packet filters associated with
the default bearer, in relation to those associated with the dedicated
bearers, is up to operator configuration. It is possible to \"force\" certain
traffic onto the default bearer by setting the evaluation precedence index of
the corresponding filters to a value that is lower than the values used for
filters associated with the dedicated bearers. It is also possible use the
default bearer for traffic that does not match any of the filters associated
with the dedicated bearers. In this case, the evaluation precedence index of
the corresponding filter(s) (e.g., a \"match all filter\") need to be set to a
value that is higher than the values used for filters associated with
dedicated bearers.
A unidirectional EPS bearer is either associated with an UL TFT or a DL TFT
that matches the unidirectional traffic flow(s) and a DL TFT or an UL TFT in
the other direction that blocks all traffic flows.
The initial bearer level QoS parameter values of the default bearer are
assigned by the network, based on subscription data (in E-UTRAN the MME sets
those initial values based on subscription data retrieved from HSS).
In a non-roaming scenario, the PCEF may change the QoS parameter value
received from the MME based on interaction with the PCRF or based on local
configuration. When the PCEF changes those values, the MME shall use the
bearer level QoS parameter values received on the S11 reference point during
establishment or modification of the default bearer.
In a roaming scenario, based on local configuration, the MME may downgrade the
ARP or APN-AMBR and/or remap QCI parameter values received from HSS to the
value locally configured in MME (e.g., when the values received from HSS do
not comply with services provided by the visited PLMN). The PCEF may change
the QoS parameter values received from the MME based on interaction with the
PCRF or based on local configuration. Alternatively, the PCEF may reject the
bearer establishment.
NOTE 4: In roaming scenarios, the ARP/APN-AMBR/QCI values provided by the MME
for a default bearer may deviate from the subscribed values depending on the
roaming agreement. If the PCC/PCEF rejects the establishment of the default
bearer, this implies that Attach via E-UTRAN will fail. Similarly, if the PCEF
(based on interaction with the PCRF or based on local configuration) upgrades
the ARP/APN-AMBR/QCI parameter values received from the MME, the default
bearer establishment and attach may be rejected by the MME.
NOTE 5: Subscription data related to bearer level QoS parameter values
retrieved from the HSS are not applicable for dedicated bearers.
For of E-UTRAN, the decision to establish or modify a dedicated bearer can
only be taken by the EPC, and the bearer level QoS parameter values are always
assigned by the EPC.
The MME shall not modify the bearer level QoS parameter values received on the
S11 reference point during establishment or modification of a default or
dedicated bearer. Instead, the MME shall only transparently forwards those
values to the E-UTRAN. Consequently, \"QoS negotiation\" between the E-UTRAN
and the EPC during default or dedicated bearer establishment / modification is
not supported. The MME may, however, reject the establishment or modification
of a default or dedicated bearer (e.g. if the bearer level QoS parameter
values sent by the PCEF over a GTP based S8 roaming interface do not comply
with a roaming agreement).
The distinction between default and dedicated bearers should be transparent to
the access network (e.g. E-UTRAN).
An EPS bearer is referred to as a GBR bearer if dedicated network resources
related to a Guaranteed Bit Rate (GBR) value that is associated with the EPS
bearer are permanently allocated (e.g. by an admission control function in the
eNodeB) at bearer establishment/modification. Otherwise, an EPS bearer is
referred to as a Non-GBR bearer.
NOTE 6: Admission control can be performed at establishment / modification of
a Non-GBR bearer even though a Non-GBR bearer is not associated with a GBR
value.
A dedicated bearer can either be a GBR or a Non-GBR bearer. A default bearer
shall be a Non-GBR bearer.
NOTE 7: A default bearer provides the UE with IP connectivity throughout the
lifetime of the PDN connection. That motivates the restriction of a default
bearer to bearer type Non-GBR.
The UE routes uplink packets to the different EPS bearers based on uplink
packet filters in the TFTs assigned to these EPS bearers. The UE evaluates for
a match, first the uplink packet filter amongst all TFTs that has the lowest
evaluation precedence index and, if no match is found, proceeds with the
evaluation of uplink packet filters in increasing order of their evaluation
precedence index. This procedure shall be executed until a match is found or
all uplink packet filters have been evaluated. If a match is found, the uplink
data packet is transmitted on the EPS bearer that is associated with the TFT
of the matching uplink packet filter. If no match is found, the uplink data
packet shall be sent via the EPS bearer that has not been assigned any uplink
packet filter. If all EPS bearers (including the default EPS bearer for that
PDN) have been assigned one or more uplink packet filters, the UE shall
discard the uplink data packet.
#### 4.7.2.2 The EPS bearer with GTP-based S5/S8
Figure 4.7.2.2-1: Two Unicast EPS bearers (GTP-based S5/S8)
An EPS bearer is realized by the following elements:
\- In the UE, the UL TFT maps a traffic flow aggregate to an EPS bearer in the
uplink direction;
\- In the PDN GW, the DL TFT maps a traffic flow aggregate to an EPS bearer in
the downlink direction;
\- A radio bearer (defined in TS 36.300 [5]) transports the packets of an EPS
bearer between a UE and an eNodeB. If a radio bearer exists, there is a one-
to-one mapping between an EPS bearer and this radio bearer;
\- An S1 bearer transports the packets of an EPS bearer between an eNodeB and
a Serving GW;
\- An E-RAB (E-UTRAN Radio Access Bearer) refers to the concatenation of an S1
bearer and the corresponding radio bearer, as defined in TS 36.300 [5].
\- An S5/S8 bearer transports the packets of an EPS bearer between a Serving
GW and a PDN GW;
\- A UE stores a mapping between an uplink packet filter and a radio bearer to
create the mapping between a traffic flow aggregate and a radio bearer in the
uplink;
\- A PDN GW stores a mapping between a downlink packet filter and an S5/S8
bearer to create the mapping between a traffic flow aggregate and an S5/S8
bearer in the downlink;
\- An eNodeB stores a one-to-one mapping between a radio bearer and an S1
Bearer to create the mapping between a radio bearer and an S1 bearer in both
the uplink and downlink;
\- A Serving GW stores a one-to-one mapping between an S1 Bearer and an S5/S8
bearer to create the mapping between an S1 bearer and an S5/S8 bearer in both
the uplink and downlink.
The PDN GW routes downlink packets to the different EPS bearers based on the
downlink packet filters in the TFTs assigned to the EPS bearers in the PDN
connection. Upon reception of a downlink data packet, the PDN GW evaluates for
a match, first the downlink packet filter that has the lowest evaluation
precedence index and, if no match is found, proceeds with the evaluation of
downlink packet filters in increasing order of their evaluation precedence
index. This procedure shall be executed until a match is found, in which case
the downlink data packet is tunnelled to the Serving GW on the EPS bearer that
is associated with the TFT of the matching downlink packet filter. If no match
is found, the downlink data packet shall be sent via the EPS bearer that does
not have any downlink packet filter assigned. If all EPS bearers (including
the default EPS bearer for that PDN) have been assigned a downlink packet
filter, the PDN GW shall discard the downlink data packet.
#### 4.7.2.3 The EPS bearer with PMIP-based S5/S8
See clause 4.6 in TS 23.402 [2].
### 4.7.3 Bearer level QoS parameters
The EPS bearer QoS profile includes the parameters QCI, ARP, GBR and MBR,
described in this clause. This clause also describes QoS parameters which are
applied to an aggregated set of EPS Bearers: APN‑AMBR and UE‑AMBR.
Each EPS bearer (GBR and Non-GBR) is associated with the following bearer
level QoS parameters:
\- QoS Class Identifier (QCI);
\- Allocation and Retention Priority (ARP).
A QCI is a scalar that is used as a reference to access node-specific
parameters that control bearer level packet forwarding treatment (e.g.
scheduling weights, admission thresholds, queue management thresholds, link
layer protocol configuration, etc.), and that have been pre-configured by the
operator owning the access node (e.g. eNodeB). A one-to-one mapping of
standardized QCI values to standardized characteristics is captured TS 23.203
[6].
NOTE 1: On the radio interface and on S1, each PDU (e.g. RLC PDU or GTP-U PDU)
is indirectly associated with one QCI via the bearer identifier carried in the
PDU header. The same applies to the S5 and S8 interfaces if they are based on
GTP.
The ARP shall contain information about the priority level (scalar), the pre-
emption capability (flag) and the pre-emption vulnerability (flag). The
primary purpose of ARP is to decide whether a bearer establishment /
modification request can be accepted or needs to be rejected due to resource
limitations (typically available radio capacity for GBR bearers). The priority
level information of the ARP is used for this decision to ensure that the
request of the bearer with the higher priority level is preferred. In
addition, the ARP can be used (e.g. by the eNodeB) to decide which bearer(s)
to drop during exceptional resource limitations (e.g. at handover). The pre-
emption capability information of the ARP defines whether a bearer with a
lower ARP priority level should be dropped to free up the required resources.
The pre-emption vulnerability information of the ARP defines whether a bearer
is applicable for such dropping by a pre-emption capable bearer with a higher
ARP priority value. Once successfully established, a bearer\'s ARP shall not
have any impact on the bearer level packet forwarding treatment (e.g.
scheduling and rate control). Such packet forwarding treatment should be
solely determined by the other EPS bearer QoS parameters: QCI, GBR and MBR,
and by the AMBR parameters. The ARP is not included within the EPS QoS Profile
sent to the UE.
NOTE 2: The ARP should be understood as \"Priority of Allocation and
Retention\"; not as \"Allocation, Retention, and Priority\".
NOTE 3: Video telephony is one use case where it may be beneficial to use EPS
bearers with different ARP values for the same UE. In this use case an
operator could map voice to one bearer with a higher ARP, and video to another
bearer with a lower ARP. In a congestion situation (e.g. cell edge) the eNodeB
can then drop the \"video bearer\" without affecting the \"voice bearer\".
This would improve service continuity.
NOTE 4: The ARP may also be used to free up capacity in exceptional
situations, e.g. a disaster situation. In such a case the eNodeB may drop
bearers with a lower ARP priority level to free up capacity if the pre-emption
vulnerability information allows this.
Each GBR bearer is additionally associated with the following bearer level QoS
parameters:
\- Guaranteed Bit Rate (GBR);
\- Maximum Bit Rate (MBR).
The GBR denotes the bit rate that can be expected to be provided by a GBR
bearer. The MBR limits the bit rate that can be expected to be provided by a
GBR bearer (e.g. excess traffic may get discarded by a rate shaping function).
See clause 4.7.4 for further details on GBR and MBR.
Each APN access, by a UE, is associated with the following QoS parameter:
\- per APN Aggregate Maximum Bit Rate (APN-AMBR).
The APN‑AMBR is a subscription parameter stored per APN in the HSS. It limits
the aggregate bit rate that can be expected to be provided across all Non‑GBR
bearers and across all PDN connections of the same APN (e.g. excess traffic
may get discarded by a rate shaping function). Each of those Non‑GBR bearers
could potentially utilize the entire APN‑AMBR, e.g. when the other Non‑GBR
bearers do not carry any traffic. GBR bearers are outside the scope of
APN‑AMBR. The P‑GW enforces the APN‑AMBR in downlink. Enforcement of APN‑AMBR
in uplink is done in the UE and additionally in the P‑GW.
NOTE 5: All simultaneous active PDN connections of a UE that are associated
with the same APN shall be provided by the same PDN GW (see clauses 4.3.8.1
and 5.10.1).
Each UE in state EMM-REGISTERED is associated with the following bearer
aggregate level QoS parameter:
\- per UE Aggregate Maximum Bit Rate (UE-AMBR).
The UE‑AMBR is limited by a subscription parameter stored in the HSS. The MME
shall set the UE‑AMBR to the sum of the APN‑AMBR of all active APNs up to the
value of the subscribed UE‑AMBR. The UE‑AMBR limits the aggregate bit rate
that can be expected to be provided across all Non‑GBR bearers of a UE (e.g.
excess traffic may get discarded by a rate shaping function). Each of those
Non‑GBR bearers could potentially utilize the entire UE‑AMBR, e.g. when the
other Non‑GBR bearers do not carry any traffic. GBR bearers are outside the
scope of UE AMBR. The E‑UTRAN enforces the UE‑AMBR in uplink and downlink.
The GBR and MBR denote bit rates of traffic per bearer while UE-AMBR/APN-AMBR
denote bit rates of traffic per group of bearers. Each of those QoS parameters
has an uplink and a downlink component. On S1_MME the values of the GBR, MBR,
and AMBR refer to the bit stream excluding the GTP-U/IP header overhead of the
tunnel on S1_U.
The HSS defines, for each PDN subscription context, the \'EPS subscribed QoS
profile\' which contains the bearer level QoS parameter values for the default
bearer (QCI and ARP) and the subscribed APN-AMBR value. The subscribed ARP
shall be used to set the priority level of the EPS bearer parameter ARP for
the default bearer while the pre-emption capability and the pre-emption
vulnerability information for the default bearer are set based on MME operator
policy. In addition, the subscribed ARP shall be applied by the P-GW for
setting the ARP priority level of all dedicated EPS bearers of the same PDN
connection unless a specific ARP priority level setting is required (due to
P-GW configuration or interaction with the PCRF).
NOTE 6: The ARP parameter of the EPS bearer can be modified by the P‑GW (e.g.
based on interaction with the PCRF) to assign the appropriate pre-emption
capability and the pre-emption vulnerability setting.
The ARP pre-emption vulnerability of the default bearer should be set
appropriately to minimize the risk of unnecessary release of the default
bearer.
### 4.7.4 Support for Application / Service Layer Rate Adaptation
Neither the EPC nor the E-UTRAN supports any explicit feedback to trigger a
rate adaptation scheme at the application / service / transport layer.
The MBR of a particular GBR bearer shall be set equal to the GBR.
NOTE: Support for \"MBR > GBR\" bearers may be introduced in a future release.
The EPC does not support E-UTRAN-initiated \"QoS re-negotiation\". That is,
the EPC does not support an eNodeB initiated bearer modification procedure. If
an eNodeB can no longer sustain the GBR of an active GBR bearer then the
eNodeB should simply trigger a deactivation of that bearer.
### 4.7.5 Application of PCC in the Evolved Packet System
The Evolved Packet System applies the PCC framework as defined in TS 23.203
[6] for QoS policy and charging control. PCC functionality is present in the
AF, PCEF and PCRF.
An EPS needs to support both PCEF and PCRF functionality to enable dynamic
policy and charging control by means of installation of PCC rules based on
user and service dimensions. However, an EPS may only support PCEF
functionality in which case it shall support static policy and charging
control.
NOTE: The local configuration of PCEF static policy and charging control
functionality is not subject to standardization. The PCEF static policy and
control functionality is not based on subscription information.
The following applies to the use of dynamic policy and charging control in
EPS:
\- The service level (per SDF) QoS parameters are conveyed in PCC rules (one
PCC rule per SDF) over the Gx reference point. The service level QoS
parameters consist of a QoS Class Identifier (QCI) Allocation and Retention
Priority (ARP) and authorised Guaranteed and Maximum Bit Rate values for
uplink and downlink. The QCI is a scalar that represents the QoS
characteristics that the EPS is expected to provide for the SDF. ARP is an
indicator of the priority for the SDF that is used to decide about the
assignment of resources due to resource limitations. The service level ARP
assigned by PCRF in a PCC rule may be different from the bearer level ARP
stored in subscription data;
\- The set of standardized QCIs and their characteristics that the PCRF in an
EPS can select from is provided in TS 23.203 [6]. It is expected that the PCRF
selects a QCI in such a way that the IP-CAN receiving it can support it;
\- It is not required that an IP-CAN supports all standardized QCIs;
\- In the case of IP address configuration subsequent to initial attachment,
i.e. through DHCP mechanism to complete the IP address configuration, the PDN
GW/PCEF shall notify the PCRF of the UE\'s IP address by means of an IP-CAN
Session Modification procedure or IP-CAN Session Establishment procedure as
defined in TS 23.203 [6] when it is assigned. If the PCRF response leads to an
EPS bearer modification the PDN GW should initiate a bearer update procedure;
\- For local breakout, the visited network has the capability to reject the
QoS authorized by the home network based on operator policies.
The following applies regardless of whether dynamic or static policy and
charging control is used in EPS:
\- For E-UTRAN the value of the ARP of an EPS bearer is identical to the value
of the ARP of the SDF(s) mapped to that EPS bearer;
\- For the same UE/PDN connection: SDFs associated with different QCIs or with
the same service-level QCI but different ARP shall not be mapped to the same
EPS bearer;
\- The bearer level QCI of an EPS bearer is identical to the value of the QCI
of the SDF(s) mapped to that EPS bearer.
## 4.8 Compatibility Issues
### 4.8.1 Network Configuration for Interaction with UTRAN/GERAN
GPRS idle mode mobility within GERAN or UTRAN and also between GERAN and UTRAN
specifies a set of sequence number handling functions, e.g. the exchange of
sequence numbers during Routing Area Update procedures. EPS idle mode mobility
procedures don\'t specify any such sequence number mappings for IRAT mobility
scenarios. To avoid interoperation issues a network that deploys E-UTRAN
together with GERAN and/or UTRAN shall not configure usage of the GPRS feature
\"reordering required\" for PDP contexts of PDP type IPv4, IPv6 or IPv4v6.
Also the network shall not configure usage of lossless PDCP of UTRAN and the
GERAN SGSN shall not configure usage of acknowledged mode LLC/NSAPI/SNDCP.
# 5 Functional description and information flows
## 5.1 Control and user planes
NOTE:
\- Refer to TS 23.402 [2] for the corresponding protocol stack for PMIP based
S5/S8.
\- Refer to TS 23.203 [6] for the corresponding protocol stack for Policy
Control and Charging (PCC) function related reference points.
### 5.1.1 Control Plane
#### 5.1.1.1 General
The control plane consists of protocols for control and support of the user
plane functions:
\- controlling the E-UTRA network access connections, such as attaching to and
detaching from E-UTRAN;
\- controlling the attributes of an established network access connection,
such as activation of an IP address;
\- controlling the routing path of an established network connection in order
to support user mobility; and
\- controlling the assignment of network resources to meet changing user
demands.
The following control planes are used in E-UTRAN mode.
#### 5.1.1.2 eNodeB - MME
{width="3.936111111111111in" height="2.529861111111111in"}
**Legend:**
\- **S1 Application Protocol (S1-AP):** Application Layer Protocol between the
eNodeB and the MME.
\- **SCTP for the control plane (SCTP):** This protocol guarantees delivery of
signalling messages between MME and eNodeB (S1). SCTP is defined in RFC 4960
[35].
Figure 5.1.1.2-1: Control Plane for S1-MME Interface
#### 5.1.1.3 UE - MME
{width="6.304166666666666in" height="1.8854166666666667in"}
Legend:
\- **NAS:** The NAS protocol supports mobility management functionality and
user plane bearer activation, modification and deactivation. It is also
responsible of ciphering and integrity protection of NAS signalling.
\- **LTE-Uu:** The radio protocol of E-UTRAN between the UE and the eNodeB is
specified in TS 36.300 [5].
Figure 5.1.1.3-1: Control Plane UE - MME
#### 5.1.1.4 SGSN - MME
{width="3.542361111111111in" height="2.2493055555555554in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the control plane (GTP‑C):** This protocol
tunnels signalling messages between SGSN and MME (S3).
\- **User Datagram Protocol (UDP):** This protocol transfers signalling
messages. UDP is defined in RFC 768 [26].
Figure 5.1.1.4-1: Control Plane for S3 Interface
#### 5.1.1.5 SGSN - S‑GW
{width="3.542361111111111in" height="2.2493055555555554in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the control plane (GTP‑C):** This protocol
tunnels signalling messages between SGSN and S‑GW (S4).
\- **User Datagram Protocol (UDP):** This protocol transfers signalling
messages. UDP is defined in RFC 768 [26].
Figure 5.1.1.5-1: Control Plane for S4 interface
#### 5.1.1.6 S‑GW - P‑GW
{width="3.5416666666666665in" height="2.3541666666666665in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the control plane (GTP‑C):** This protocol
tunnels signalling messages between S‑GW and P‑GW (S5 or S8).
\- **User Datagram Protocol (UDP):** This protocol transfers signalling
messages between S‑GW and P‑GW. UDP is defined in RFC 768 [26].
Figure 5.1.1.6-1: Control Plane for S5 and S8 interfaces
#### 5.1.1.7 MME - MME
{width="3.542361111111111in" height="2.3756944444444446in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the control plane (GTP‑C):** This protocol
tunnels signalling messages between MMEs (S10).
\- **User Datagram Protocol (UDP):** This protocol transfers signalling
messages between MMEs. UDP is defined in RFC 768 [26].
Figure 5.1.1.7-1: Control Plane for S10 interface
#### 5.1.1.8 MME - S‑GW
{width="3.542361111111111in" height="2.15625in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the control plane (GTP‑C):** This protocol
tunnels signalling messages between MME and S‑GW (S11).
\- **User Datagram Protocol (UDP):** This protocol transfers signalling
messages. UDP is defined in RFC 768 [26].
Figure 5.1.1.8-1: Control Plane for S11 interface
#### 5.1.1.9 MME - HSS
**Legend:**
\- **Diameter:** This protocol supports transferring of subscription and
authentication data for authenticating/authorizing user access to the evolved
system between MME and HSS (S6a). Diameter is defined in RFC 3588 [31].
\- **Stream Control Transmission Protocol (SCTP):** This protocol transfers
signalling messages. SCTP is defined in RFC 4960 [35].
Figure 5.1.1.9-1: Control Plane for S6a interface
#### 5.1.1.10 MME - EIR
**Legend:**
\- **Diameter:** This protocol supports UE identity check procedure between
MME and EIR (S13). Diameter is defined in RFC 3588 [31].
\- **Stream Control Transmission Protocol (SCTP):** This protocol transfers
signalling messages. SCTP is defined in RFC 4960 [35].
Figure 5.1.1.10-1: Control Plane for S13 interface
#### 5.1.1.11 Void
### 5.1.2 User Plane
#### 5.1.2.1 UE - P‑GW user plane with E-UTRAN
{width="6.495833333333334in" height="3.0215277777777776in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the user plane (GTP‑U):** This protocol
tunnels user data between eNodeB and the S‑GW as well as between the S‑GW and
the P‑GW in the backbone network. GTP shall encapsulate all end user IP
packets.
\- **MME** controls the user plane tunnel establishment and establishes User
Plane Bearers between eNodeB and S‑GW.
\- **UDP/IP:** These are the backbone network protocols used for routing user
data and control signalling.
\- **LTE-Uu:** The radio protocols of E-UTRAN between the UE and the eNodeB
are specified in TS 36.300 [5].
Figure 5.1.2.1-1: User Plane
#### 5.1.2.2 eNodeB - S‑GW
{width="3.542361111111111in" height="2.442361111111111in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the user plane (GTP‑U):** This protocol
tunnels user data between eNodeB and S‑GW.
\- **User Datagram Protocol (UDP):** This protocol transfers user data. UDP is
defined in RFC 768 [26].
Figure 5.1.2.2-1: User Plane for eNodeB -- S‑GW
#### 5.1.2.3 UE - PDN GW user plane with 2G access via the S4 interface
{width="6.670833333333333in" height="3.5506944444444444in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the user plane (GTP‑U):** This protocol
tunnels user data between SGSN and the S‑GW as well as between the S‑GW and
the P‑GW in the backbone network. GTP shall encapsulate all end user IP
packets.
\- **UDP/IP:** These are the backbone network protocols used for routing user
data and control signalling.
\- Protocols on the Um and the Gb interfaces are described in TS 23.060 [7].
Figure 5.1.2.3-1: User Plane for A/Gb mode
#### 5.1.2.4 UE - PDN GW user plane with 3G access via the S12 interface
{width="6.663888888888889in" height="3.145138888888889in"}
**Legend:**
\- **GPRS Tunnelling Protocol for the user plane (GTP‑U):** This protocol
tunnels user data between UTRAN and the S‑GW as well as between the S‑GW and
the P‑GW in the backbone network. GTP shall encapsulate all end user IP
packets.
\- **UDP/IP:** These are the backbone network protocols used for routing user
data and control signalling.
\- Protocols on the Uu interface are described in TS 23.060 [7].
\- SGSN controls the user plane tunnel establishment and establish a Direct
Tunnel between UTRAN and S‑GW as shown in Figure 5.1.2.4-1.
Figure 5.1.2.4-1: User Plane for UTRAN mode and Direct Tunnel on S12
#### 5.1.2.5 UE - PDN GW user plane with 3G access via the S4 interface
{width="6.663888888888889in" height="3.0625in"}
NOTE: Please refer to TS 23.402 [2] for the corresponding stack for PMIP based
S5/S8.
**Legend:**
\- **GPRS Tunnelling Protocol for the user plane (GTP‑U):** This protocol
tunnels user data between UTRAN and the SGSN, between SGSN and S‑GW as well as
between the S‑GW and the P‑GW in the backbone network. GTP shall encapsulate
all end user IP packets.
\- **UDP/IP:** These are the backbone network protocols used for routing user
data and control signalling.
\- Protocols on the Uu and the Iu interfaces are described in TS 23.060 [7].
\- **SGSN** controls the user plane tunnel establishment and establishes a
tunnel between SGSN and S‑GW. If Direct Tunnel is established between UTRAN
and S‑GW, see Figure 5.1.2.4-1.
Figure 5.1.2.5-1: User Plane for Iu mode
## 5.2 Identities
### 5.2.1 EPS bearer identity
An EPS bearer identity uniquely identifies an EPS bearer for one UE accessing
via E-UTRAN. The EPS Bearer Identity is allocated by the MME. There is a one
to one mapping between EPS RB and EPS Bearer, and the mapping between EPS RB
Identity and EPS Bearer Identity is made by E-UTRAN. The E-RAB ID value used
at S1 and X2 interfaces to identify an E-RAB is the same as the EPS Bearer ID
value used to identify the associated EPS Bearer.
When there is a mapping between an EPS bearer and a PDP context, the same
identity value is used for the EPS bearer ID and the NSAPI/RAB ID.
In some SM signalling messages in GERAN/UTRAN, transaction identifier (TI)
represents NSAPI. The TI is dynamically allocated by the UE for UE-requested
PDP context activation, and by the network for network-requested PDP context
activation. A corresponding allocation is also needed for EPS Bearers in order
to successfully transfer Bearers to GERAN/UTRAN. The TI is deallocated when a
PDP context/EPS Bearer has been deactivated. TI usage is defined in TS 23.060
[7].
### 5.2.2 Globally Unique Temporary UE Identity
The MME shall allocate a Globally Unique Temporary Identity (GUTI) to the UE.
The GUTI is defined in TS 23.003 [9].
### 5.2.3 Tracking Area Identity (TAI)
This is the identity used to identify tracking areas. The Tracking Area
Identity is constructed from the MCC (Mobile Country Code), MNC (Mobile
Network Code) and TAC (Tracking Area Code).
NOTE: Changes in the TAI of a cell can occur but are normally infrequent and
linked with O+M activity.
### 5.2.4 eNodeB S1-AP UE Identity (eNodeB S1-AP UE ID)
This is the temporary identity used to identify a UE on the S1-MME reference
point within the eNodeB. It is unique within the eNodeB.
### 5.2.5 MME S1-AP UE Identity (MME S1-AP UE ID)
This is the temporary identity used to identify a UE on the S1-MME reference
point within the MME. It is unique within the MME.
## 5.3 Authentication, security and location management
### 5.3.1 IP address allocation
#### 5.3.1.1 General
A UE shall perform the address allocation procedures for at least one IP
address (either IPv4 address or IPv6 prefix) after the default bearer
activation if no IPv4 address is allocated during the default bearer
activation.
One of the following ways shall be used to allocate IP addresses for the UE:
a) The HPLMN allocates the IP address to the UE when the default bearer is
activated (dynamic or static HPLMN address);
b) The VPLMN allocates the IP address to the UE when the default bearer is
activated (dynamic VPLMN address); or
c) The PDN operator or administrator allocates an (dynamic or static) IP
address to the UE when the default bearer is activated (External PDN Address
Allocation).
The IP address allocated for the default bearer shall also be used for the
dedicated bearers within the same PDN connection. IP address allocation for
PDN connections, which are activated by the UE requested PDN connectivity
procedure, is handled with the same set of mechanisms as those used within the
Attach procedure.
PDN types IPv4, IPv6 and IPv4v6 are supported. An EPS Bearer of PDN type
IPv4v6 may be associated with one IPv6 prefix only or with both one IPv4
address and one IPv6 prefix. PDN type IPv4 is associated with an IPv4 address.
PDN type IPv6 is associated with an IPv6 prefix. PDN types IPv4 and IPv6 are
utilised for the UE and/or the PDN GW support IPv4 addressing only or IPv6
prefix only; or operator preferences dictate the use of a single IP version
only, or the subscription is limited to IPv4 only or IPv6 only for this APN.
In addition, PDN type IPv4 and IPv6 are utilised for interworking with nodes
of earlier releases.
The UE sets the PDN type during the Attach procedure based on its IP stack
configuration as follows:
\- A UE which is IPv6 and IPv4 capable shall request for PDN type IPv4v6.
\- A UE which is only IPv4 capable shall request for PDN type IPv4.
\- A UE which is only IPv6 capable shall request for PDN type IPv6.
\- When the IP version capability of the UE is unknown in the UE (as in the
case when the MT and TE are separated and the capability of the TE is not
known in the MT), the UE shall request for PDN type IPv4v6.
The HSS stores one or more PDN types per APN in the subscription data. During
the Attach or UE requested PDN connectivity procedure he MME compares the
requested PDN type to the PDN type in the subscription records for the given
APN and sets the PDN type as follows:
\- If the requested PDN type is allowed by subscription, the MME sets the PDN
type as requested.
\- If the requested PDN type is IPv4v6 and subscription data only allows PDN
type IPv4 or only allows PDN type IPv6, the MME sets the PDN type according to
the subscribed value. A reason cause shall be returned to the UE indicating
that only the assigned PDN type is allowed. In this case the UE shall not
request another PDN connection to the same APN for the other IP version.
\- If the requested PDN type is IPv4 or IPv6, and neither the requested PDN
type nor PDN type IPv4v6 are subscribed, the PDN connection request is
rejected.
\- If the requested PDN type is IPv4v6, and both IPv4 and IPv6 PDN types are
allowed by subscription but not IPv4v6, the MME shall set the PDN type to IPv4
or IPv6 where the selection between IPv4 and IPv6 is implementation specific.
The UE may then initiate the UE requested PDN connectivity procedure to this
APN in order to activate a second PDN connection with the other single address
PDN type which was not allocated by the network.
The PDN GW may restrict the usage of a PDN type IPv4v6 as follows.
\- If the PDN GW receives a request for PDN type IPv4v6, but the PDN GW
operator preferences dictate the use of IPv4 addressing only or IPv6 prefix
only for this APN, the PDN type shall be changed to a single address PDN type
(IPv4 or IPv6) and a reason cause shall be returned to the UE indicating that
only the assigned PDN type is allowed. In this case the UE shall not request
another PDN connection to the same APN for the other IP version.
\- If the PDN GW receives a request for PDN type IPv4v6, but the MME does not
set the Dual Address Bearer Flag due to the MME operator using single
addressing per bearer to support interworking with nodes of earlier releases
the PDN type shall be changed to a single IP version only and a reason cause
shall be returned to the UE indicating that only single IP version per PDN
connection is allowed. In this case the UE may request another PDN connection
for the other IP version using the UE requested PDN connectivity procedure to
the same APN with a single address PDN type (IPv4 or IPv6) other than the one
already activated.
During inter-RAT mobility between E‑UTRAN and UTRAN/GERAN, an EPS bearer with
PDN type IPv4v6 shall be mapped one-to-one to PDP type IPv4v6.
During inter-RAT mobility between E-UTRAN and UTRAN/GERAN, an EPS bearer with
PDN type IPv4 shall be mapped one-to-one to a PDP context of PDP type IPv4. An
EPS bearer with PDN type IPv6 shall be mapped one-to-one to a PDP context of
PDP type IPv6.
It is the HPLMN operator that shall define in the subscription whether a
dynamic HPLMN or VPLMN address may be used.
The EPS UE may indicate to the network within the Protocol Configuration
Options element that the UE wants to obtain the IPv4 address with DHCPv4:
\- the UE may indicate that it prefers to obtain an IPv4 address as part of
the default bearer activation procedure. In such a case, the UE relies on the
EPS network to provide IPv4 address to the UE as part of the default bearer
activation procedure.
\- the UE may indicate that it prefers to obtain the IPv4 address after the
default bearer setup by DHCPv4. That is, when the EPS network supports DHCPv4
and allows that, it does not provide the IPv4 address for the UE as part of
the default bearer activation procedures. The network may respond to the UE by
setting the PDN Address to 0.0.0.0. After the default bearer establishment
procedure is completed, the UE uses the connectivity with the EPS and
initiates the IPv4 address allocation on its own using DHCPv4. However, if the
EPS network provides IPv4 address to the UE as part of the default bearer
activation procedure, the UE should accept the IPv4 address indicated in the
default bearer activation procedure.
\- if the UE sends no Address Allocation Preference, the PDN GW determines
whether to use DHCPv4 or not based on per APN configuration
Both EPS network elements and UE shall support the following mechanisms:
a. IPv4 address allocation via default bearer activation, if IPv4 is
supported.
b. /64 IPv6 prefix allocation via IPv6 Stateless Address autoconfiguration
according to RFC 4862 [18], if IPv6 is supported;
Furthermore, the Protocol Configuration Options may be used during bearer
activation to configure parameters which are needed for IP address allocation.
Both EPS network elements and UE may support the following mechanisms:
a. IPv4 address allocation and IPv4 parameter configuration after the attach
procedure via DHCPv4 according to RFC 2131 [19] and RFC 4039 [25];
b. IPv6 parameter configuration via Stateless DHCPv6 according to RFC 3736
[20].
EPS network elements may support the following mechanism:
a. Allocation of a static IPv4 address and/or a static IPv6 prefix based on
subscription data in the HSS.
If the static IP address/prefix is not stored in the HSS subscription record,
it may be configured on a per-user per-APN basis in the DHCP/Radius/Diameter
server and the PDN GW retrieves the IP address/prefix for the UE from the
DHCP/Radius/Diameter server. In this case, static IP address/prefix is
allocated by the same procedures as the dynamic IP address/prefix allocation.
The following clauses describe how the above listed IP address allocation
mechanisms work when GTP based S5/S8 is used. The way of working of the IP
address allocation mechanisms for PMIP based S5/S8 can be found in TS 23.402
[2].The procedures can be used both for PLMN (VPLMN/HPLMN) or external PDN
based IP address allocation.
NOTE 1: It is transparent to the UE whether the PLMN or the external PDN
allocates the IP address and whether the IP address is static or dynamic.
In order to support DHCP based IP address configuration, the PDN GW shall act
as the DHCP server for HPLMN assigned dynamic and static and VPLMN assigned
dynamic IP addressing. When DHCP is used for external PDN assigned addressing
and parameter configuration, the PDN GW shall act as the DHCP server towards
the UE and it shall act as the DHCP client towards the external DHCP server.
The Serving GW does not have any DHCP functionality. It forwards packets,
including DHCP packets, between the UE and the PDN GW.
IPv6 Stateless Address autoconfiguration specified in RFC 4862 [18] is the
basic mechanism to allocate /64 IPv6 prefix to the UE.
During default bearer establishment, the PDN GW sends the IPv6 prefix and
Interface Identifier to the S‑GW, and then the S‑GW forwards the IPv6 prefix
and Interface Identifier to the MME or to the SGSN. The MME or the SGSN
forwards the IPv6 Interface Identifier to the UE. The MME does not forward the
IPv6 prefix to the UE. If the UE receives the IPv6 prefix from the SGSN during
PDP Context Activation procedure, it shall ignore it.
#### 5.3.1.2 IP address allocation, renewal and release mechanisms for GTP
based S5/S8
##### 5.3.1.2.1 IPv4 address allocation via default bearer activation and
release via PDN connection release
An IPv4 address may be provided to the UE as part of the default bearer
activation and the IPv4 address is released when PDN connection associated
with the IPv4 address is released.
When the PLMN allocates an IPv4 address, it is the PDN GW responsibility to
allocate and release the IPv4 address. The PDN GW may use an internal IPv4
address pool in this case. The PDN GW allocates an IPv4 address upon default
bearer activation and it releases the IPv4 address upon PDN connection release
associated with the IPv4 address for a given UE.
NOTE: If the PDN type is IPv4v6, when the PDN Connection is released, the IPv6
address is also released.
When an IPv4 address is allocated from an external PDN, it is the PDN GW
responsibility to obtain the IPv4 address from the external PDN, and to
allocate, renew and release the IPv4 address. The PDN GW may use DHCPv4 to
obtain, renew and release the IPv4 address from the external PDN. If RADIUS or
Diameter is used towards the external PDN, as described in TS 29.061 [38], the
IP address can be obtained, renewed and released as part of these procedures.
If DHCPv4 is used, the PDN GW functions as a DHCPv4 Client. If RADIUS is used,
the PDN GW functions as a RADIUS Client. If Diameter is used, the PDN GW
functions as a Diameter Client.
After releasing the IPv4 address, the PDN GW should not assign that IPv4
address to other user immediately.
##### 5.3.1.2.2 IPv6 prefix allocation, renewal and release via IPv6 stateless
address autoconfiguration
When the PLMN allocates an IPv6 prefix, it is the PDN GW responsibility to
allocate and release the IPv6 prefix. The PDN GW may use an internal IPv6
prefix pool in this case. The PDN GW allocates a globally unique /64 IPv6
prefix via Router Advertisement to a given UE.
When an IPv6 prefix is allocated from an external PDN, it is the PDN GW
responsibility to obtain the IPv6 prefix from the external PDN and to
allocate, renew and release the IPv6 prefix. The PDN GW may use DHCPv6 to
obtain the IPv6 prefix from the external PDN. In this case, the PDN GW
functions as a DHCPv6 client. If RADIUS or Diameter is used towards the
external PDN as described in TS 29.061 [38], the IPv6 prefix can be obtained,
renewed and released as part of these procedures. If RADIUS is used, the PDN
GW functions as the RADIUS Client. If Diameter is used, the PDN GW functions
as the Diameter Client.
The procedure of stateless IPv6 address autoconfiguration is the following:
After default bearer establishment the UE may send a Router Solicitation
message to the PDN GW to solicit a Router Advertisement message. The PDN GW
sends a Router Advertisement message (solicited or unsolicited) to the UE. The
Router Advertisement messages shall contain the same IPv6 prefix as the one
provided during default bearer establishment. If the UE receives an IPv6
prefix from a SGSN during the PDP Context activation procedure, it shall
ignore it.
After the UE has received the Router Advertisement message, it constructs a
full IPv6 address via IPv6 Stateless Address autoconfiguration in accordance
with RFC 4862 [18]. To ensure that the link-local address generated by the UE
does not collide with the link-local address of the PDN GW, the PDN GW shall
provide an interface identifier (see RFC 4862 [18]) to the UE and the UE shall
use this interface identifier to configure its link-local address. For
stateless address autoconfiguration however, the UE can choose any interface
identifier to generate IPv6 addresses, other than link-local, without
involving the network. For privacy, RFC 3041 [39], the UE may change the
interface identifier used to generate full IPv6 addresses, without involving
the network.
Any prefix that the PDN GW advertises to the UE is globally unique. The PDN GW
shall also record the relationship between the UE\'s identity (IMSI) and the
allocated IPv6 prefix. Because any prefix that the PDN GW advertises to the UE
is globally unique, there is no need for the UE to perform Duplicate Address
Detection for any IPv6 address configured from the allocated IPv6 prefix. Even
if the UE does not need to use Neighbor Solicitation messages for Duplicate
Address Detection, the UE may, for example, use them to perform Neighbor
Unreachability Detection towards the PDN GW, as defined in RFC 4861 [32].
Therefore, the PDN GW shall respond with a Neighbor Advertisement upon
receiving a Neighbor Solicitation message from the UE.
In order to renew the allocated IPv6 prefix, the PDN GW sends a Router
Advertisement (solicited or unsolicited) to the UE with the same prefix and
new non-zero values in preferred and valid lifetime fields.
In order to release the allocated IPv6 prefix, the PDN GW shall initiate the
PDN connection release procedure. Upon release of the PDN connection, the UE
shall implicitly release the prefix for the corresponding PDN connection.
NOTE 2: If the PDN type is IPv4v6, when the PDN Connection is released, the
IPv4 address is also released.
After releasing the IPv6 prefix, the PDN GW should not assign that IPv6 prefix
to other user immediately.
##### 5.3.1.2.3 IPv6 parameter configuration via stateless DHCPv6
The UE may use stateless DHCPv6 for additional parameter configuration. The
PDN GW acts as the DHCP server. When PLMN based parameter configuration is
used, the PDN GW provides the requested parameters from locally provisioned
database. When external PDN based parameter configuration is used, the PDN GW
obtains the requested configuration parameters from the external PDN as
described in the previous clauses. When the PDN GW acts as a DHCPv6 server
towards the UE, the PDN GW may act as DHCPv6 client towards the external PDN
to request the configuration parameters for the UE. If RADIUS or Diameter is
used towards the external PDN as described in TS 29.061 [38], the requested
configuration parameters can be fetched as part of these procedures.
##### 5.3.1.2.4 IPv4 address allocation, renewal and release and IPv4
parameter configuration via DHCPv4
When the PLMN allocates an IPv4 address, it is the PDN GW responsibility to
allocate, renew and release the IPv4 address.
When external PDN allocation is used, the PDN GW functions as a DHCPv4 server
towards the UE. The PDN GW may act as a DHCP Client when interacting with a
DHCPv4 server in the external PDN in order to obtain, renew and release the
IPv4 address and to obtain the configuration parameters. Or, if RADIUS or
Diameter is used towards the external PDN as described in TS 29.061 [38], the
IPv4 address and the requested configuration parameters can be obtained,
renewed and released as part of these procedures.
If dynamic policy provisioning is deployed, and the PCRF was not informed
about the IPv4 address at IP-CAN session establishment, the PDN GW shall
initiate an IP-CAN Session Modification procedure to inform the PCRF about an
allocated IPv4 address. If the IPv4 address is released, the PDN GW shall
inform the PCRF about the de-allocation of an IPv4 address.
If the UE sends DHCPv4 lease renewal message to renew the lease of the
allocated IPv4 address, the PDN GW shall renew the lease of the allocated IPv4
address. If the IPv4 address was obtained from an external PDN, the PDN GW
shall perform the DHCPv4 lease renewal procedure with the external PDN if
DHCPv4 was used for obtaining IPv4 address from external PDN. If Diameter or
RADIUS procedures where used to obtain the IPv4 address from external PDN, the
PDN GW may perform corresponding update procedures as applicable. If the
external PDN extends lease of the allocated IPv4 address, the PDN GW responds
accordingly to the UE. Otherwise, if the external PDN does not extend the
lease of the allocated IPv4 address, the PDN GW responds with the remaining
lease time of the IPv4 address. If there is no PDN address allocated to the UE
for this PDN connection, the PDN GW shall perform PDN GW initiated bearer
deactivation procedure as defined in clause 5.4.4.1.
If the UE sends DHCPv4 release message to release the allocated IPv4 address
for the PDN connection, the PDN GW may anytime thereafter release the IPv4
address. If the PDN connection has no allocated PDN address, the PDN GW may at
any time initiate PDN GW initiated bearer deactivation procedure as defined in
clause 5.4.4.1.
If the PDN connection is released without any DHCPv4 release signalling with
the UE, the UE and the PDN GW shall release the IPv4 address implicitly, as
soon as the PDN connection is released.
After releasing the IPv4 address, the PDN GW should not assign that IPv4
address to any other user immediately.
##### 5.3.1.2.5 Void
### 5.3.2 Attach procedure
#### 5.3.2.1 E-UTRAN Initial Attach
A UE/user needs to register with the network to receive services that require
registration. This registration is described as Network Attachment. The
always-on IP connectivity for UE/users of the EPS is enabled by establishing a
default EPS bearer during Network Attachment. The PCC rules applied to the
default EPS bearer may be predefined in the PDN GW and activated in the
attachment by the PDN GW itself. The Attach procedure may trigger one or
multiple Dedicated Bearer Establishment procedures to establish dedicated EPS
bearer(s) for that UE. During the attach procedure, the UE may request for an
IP address allocation. Terminals utilising only IETF based mechanisms for IP
address allocation are also supported.
During the Initial Attach procedure the Mobile Equipment Identity is obtained
from the UE. The MME operator may check the ME Identity with an EIR. At least
in roaming situations, the MME should pass the ME Identity to the HSS, and, if
a PDN GW outside of the VPLMN, should pass the ME Identity to the PDN GW.
Figure 5.3.2.1-1: Attach procedure
NOTE 1: For a PMIP-based S5/S8, procedure steps (A), (B), and (C) are defined
in TS 23.402 [2]. Steps 7, 10, 13, 14, 15 and 23a/b concern GTP based S5/S8.
NOTE 2: The Serving GWs and PDN GWs involved in steps 7 and/or 10 may be
different to those in steps 13‑15.
NOTE 3: The steps in (D) are executed only upon handover from non-3GPP access.
NOTE 4: More detail on procedure steps (E) is defined in the procedure steps
(B) in clause 5.3.8.3.
NOTE 5: More detail on procedure steps (F) is defined in the procedure steps
(B) in clause 5.3.8.4.
1\. The UE initiates the Attach procedure by the transmission, to the eNodeB,
of an Attach Request (IMSI or old GUTI, last visited TAI (if available), UE
Core Network Capability, UE Specific DRX parameters, Attach Type, ESM message
container (Request Type, PDN Type, Protocol Configuration Options, Ciphered
Options Transfer Flag), KSI~ASME~, NAS sequence number, NAS-MAC, additional
GUTI, P-TMSI signature) message together with RRC parameters indicating the
Selected Network and the old GUMMEI. The old GUTI may be derived from a P‑TMSI
and RAI. IMSI shall be included if the UE does not have a valid GUTI or a
valid P‑TMSI available. The UE stores the TIN in detached state. If the UE\'s
TIN indicates \"GUTI\" or \"RAT-related TMSI\" and the UE holds a valid GUTI
then the old GUTI indicates this valid GUTI. If the UE\'s TIN indicates
\"P‑TMSI\" and the UE holds a valid P‑TMSI and related RAI then these two
elements are indicated as the old GUTI. Mapping a P‑TMSI and RAI to a GUTI is
specified in TS 23.003 [9]. If the UE holds a valid GUTI and the old GUTI
indicates a GUTI mapped from a P-TMSI and RAI, then the UE indicates the GUTI
as additional GUTI. If the old GUTI indicates a GUTI mapped from a P-TMSI and
RAI and the UE has a valid P-TMSI signature associated to it, the P-TMSI
signature shall be included.
If available, the last visited TAI shall be included in order to help the MME
produce a good list of TAIs for any subsequent Attach Accept message. Selected
Network indicates the PLMN that is selected for network sharing purposes. The
RRC parameter \"old GUMMEI\" takes its value from the \"old GUTI\" contained
in the Attach Request. UE Network Capability is described in UE capabilities,
see clause 5.11.
If the UE has valid security parameters, the Attach Request message shall be
integrity protected by the NAS-MAC in order to allow validation of the UE by
the MME. KSI~ASME~, NAS sequence number and NAS-MAC are included if the UE has
valid EPS security parameters. NAS sequence number indicates the sequential
number of the NAS message. If the UE does not have a valid EPS security
association, then the Attach Request message is not integrity protected. In
this case the security association is established in step 5a. The UE network
capabilities indicate also the supported NAS and AS security algorithms. PDN
type indicates the requested IP version (IPv4, IPv4/IPv6, IPv6). Protocol
Configuration Options (PCO) are used to transfer parameters between the UE and
the PDN GW, and are sent transparently through the MME and the Serving GW. The
Protocol Configuration Options may include the Address Allocation Preference
indicating that the UE prefers to obtain an IPv4 address only after the
default bearer activation by means of DHCPv4. If the UE intends to send PCO
which require ciphering (e.g., PAP/CHAP usernames and passwords) or send an
APN, or both, the UE shall set the Ciphered Options Transfer Flag and send PCO
or APN or both only after authentication and NAS security setup have been
completed (see below). If the UE has UTRAN or GERAN capabilities, it should
send the NRSU in the PCO to indicate the support of the network requested
bearer control in UTRAN/GERAN. Request Type is included in the ESM message
container and indicates \"Handover\" when the UE has already an activated PDN
GW/HA due to mobility with non-3GPP accesses. Attach Type indicates whether it
is an EPS or a combined EPS/IMSI attach.
2\. The eNodeB derives the MME from the RRC parameters carrying the old GUMMEI
and the indicated Selected Network. If that MME is not associated with the
eNodeB or the old GUMMEI is not available, the eNodeB selects an MME as
described in clause 4.3.8.3 on \"MME selection function\". The eNodeB forwards
the Attach Request message to the new MME contained in a S1-MME control
message (Initial UE message) together with the Selected Network and TAI+ECGI
of the cell from where it received the message to the new MME.
3\. If the UE identifies itself with GUTI and the MME has changed since
detach, the new MME uses the GUTI received from the UE to derive the old
MME/SGSN address, and send an Identification Request (old GUTI, complete
Attach Request message) to the old MME/SGSN to request the IMSI. If the
request is sent to an old MME, the old MME first verifies the Attach Request
message by NAS MAC and then responds with Identification Response (MM
Context). If the request is sent to an old SGSN, the old SGSN first verifies
the Attach Request message by the P-TMSI signature and then responds with
Identification Response (MM Context). If the UE is not known in the old
MME/SGSN or if the integrity check or P-TMSI signature check for the Attach
Request message fails, the old MME/SGSN responds with an appropriate error
cause. The MM context contains security related information (as well as IMSI)
as described in clause 5.7.2 (Information Storage for MME).
The additional GUTI in the Attach Request message allows the new MME to find
any already existing UE context stored in the new MME when the old GUTI
indicates a value mapped from a P-TMSI and RAI.
NOTE 6: A SGSN always responds with the UMTS security parameters and the MME
may store it for later use.
4\. If the UE is unknown in both the old MME/SGSN and new MME, the new MME
sends an Identity Request to the UE to request the IMSI. The UE responds with
Identity Response (IMSI).
5a If no UE context for the UE exists anywhere in the network, if the Attach
Request (sent in step 1) was not integrity protected, or if the check of the
integrity failed, then authentication and NAS security setup to activate
integrity protection and NAS ciphering are mandatory. Otherwise it is
optional. If NAS security algorithm is to be changed, the NAS security setup
is performed in this step. The authentication and NAS security setup functions
are defined in clause 5.3.10 on \"Security Function\".
After step 5a, all NAS messages shall be protected by the NAS security
functions (integrity and ciphering) indicated by the MME.
5b. The ME Identity shall be retrieved from the UE. The ME identity shall be
transferred encrypted. In order to minimise signalling delays, the retrieval
of the ME Identity may be combined with NAS security setup in step 5a. The MME
may send the ME Identity Check Request (ME Identity, IMSI) to the EIR. The EIR
shall respond with ME Identity Check Ack (Result). Dependent upon the Result,
the MME decides whether to continue with this Attach procedure or to reject
the UE.
6\. If the UE has set the Ciphered Options Transfer Flag in the Attach Request
message, the Ciphered Options i.e. PCO or APN or both, shall now be retrieved
from the UE.
In order to handle situations where the UE may have subscriptions to multiple
PDNs, if the Protocol Configuration Options contains user credentials (e.g.
user name/password within PAP or CHAP parameters) then the UE should also send
the APN to the MME.
7\. If there are active bearer contexts in the new MME for this particular UE
(i.e. the UE re-attaches to the same MME without having properly detached
before), the new MME deletes these bearer contexts by sending Delete Session
Request (TEIDs) messages to the GWs involved. The GWs acknowledge with Delete
Session Response (TEIDs) message. If a PCRF is deployed, the PDN GW employs an
IP-CAN Session Termination procedure to indicate that resources have been
released.
8\. If the MME has changed since the last detach, or if there is no valid
subscription context for the UE in the MME, or if the ME identity has changed,
or if the UE provides an IMSI or the UE provides an old GUTI which doesn\'t
refer to a valid context in the MME, the MME sends an Update Location Request
(MME Identity, IMSI, ME Identity, MME Capabilities, ULR-Flags) message to the
HSS. The MME capabilities indicate the MME\'s support for regional access
restrictions functionality. ULR-Flags indicates \"Initial-Attach-Indicator\"
as this is an Attach procedure.
9\. The HSS sends Cancel Location (IMSI, Cancellation Type) to the old MME.
The old MME acknowledges with Cancel Location Ack (IMSI) and removes the MM
and bearer contexts. If the ULR-Flags indicates \"Initial-Attach-Indicator\"
and the HSS has the SGSN registration, then the HSS sends Cancel Location
(IMSI, Cancellation Type) to the old SGSN. The Cancellation Type indicates the
old MME/SGSN to release the old Serving GW resource.
10\. If there are active bearer contexts in the old MME/SGSN for this
particular UE, the old MME/SGSN deletes these bearer contexts by sending
Delete Session Request (TEIDs) messages to the GWs involved. The GWs return
Delete Session Response (TEIDs) message to the old MME/SGSN. If a PCRF is
deployed, the PDN GW employs an IP‑CAN Session Termination procedure as
defined in TS 23.203 [6] to indicate that resources have been released.
11\. The HSS acknowledges the Update Location message by sending an Update
Location Ack (IMSI, Subscription data) message to the new MME. The
Subscription Data contain one or more PDN subscription contexts. Each PDN
subscription context contains an \'EPS subscribed QoS profile\' and the
subscribed APN-AMBR (see clause 4.7.3). The new MME validates the UE\'s
presence in the (new) TA. If due to regional subscription restrictions or
access restrictions the UE is not allowed to attach in the TA or due to
subscription checking fails for other reasons, the new MME rejects the Attach
Request with an appropriate cause. If all checks are successful then the new
MME constructs a context for the UE. If the APN provided by the UE is not
allowed by subscription, or the Update Location is rejected by the HSS, the
new MME rejects the Attach Request from the UE with an appropriate cause.
12\. If a subscribed PDN address is allocated for the UE for this APN, the PDN
subscription context contains the UE\'s IPv4 address and/or the IPv6 prefix
and optionally the PDN GW identity. If the PDN subscription context contains a
subscribed IPv4 address and/or IPv6 prefix, the MME indicates it in the PDN
address. For Request Type indicating \"Initial Request\", if the UE does not
provide an APN, the MME shall use the PDN GW corresponding to the default APN
for default bearer activation. If the UE provides an APN, this APN shall be
employed for default bearer activation. For Request type indicating
\"Handover\", if the UE provides an APN, the MME shall use the PDN GW
corresponding to the provided APN for default bearer activation, If the UE
does not provide an APN, and the subscription context from HSS contains a PDN
GW identity corresponding to the default APN, the MME shall use the PDN GW
corresponding to the default APN for default bearer activation. The case where
the Request type indicates \"Handover\" and the UE does not provide an APN,
and the subscription context from HSS does not contain a PDN GW identity
corresponding to the default APN constitutes an error case. If the Request
type indicates \"Initial Request\" and the selected PDN subscription context
contains no PDN GW identity the new MME selects a PDN GW as described in
clause 4.3.8.1 on PDN GW selection function (3GPP accesses). If the PDN
subscription context contains a dynamically allocated PDN GW identity and the
Request Type does not indicate \"Handover\" the MME may select a new PDN GW as
described in clause PDN GW selection function, e.g. to allocate a PDN GW that
allows for more efficient routing. The new MME selects a Serving GW as
described in clause 4.3.8.2 on Serving GW selection function and allocates an
EPS Bearer Identity for the Default Bearer associated with the UE. Then it
sends a Create Session Request (IMSI, MSISDN, MME TEID for control plane, PDN
GW address, PDN Address, APN, RAT type, Default EPS Bearer QoS, PDN Type, APN-
AMBR, EPS Bearer Identity, Protocol Configuration Options, Handover
Indication, ME Identity, User Location Information (ECGI), MS Info Change
Reporting support indication, Selection Mode, Charging Characteristics, Trace
Reference, Trace Type, Trigger Id, OMC Identity, Maximum APN Restriction, Dual
Address Bearer Flag, the Protocol Type over S5/S8) message to the selected
Serving GW.
The RAT type is provided in this message for the later PCC decision. The
subscribed APN‑AMBR for the APN is also provided in this message. The MSISDN
is included if provided in the subscription data from the HSS. Handover
Indication is included if the Request type indicates handover. Selection Mode
indicates whether a subscribed APN was selected, or a non-subscribed APN sent
by the UE was selected. Charging Characteristics indicates which kind of
charging the bearer context is liable for. The MME may change the requested
PDN type according to the subscription data for this APN as described in
clause 5.3.1.1. The MME shall set the Dual Address Bearer Flag when the PDN
type is set to IPv4v6 and all SGSNs which the UE may be handed over to are
Release 8 or above supporting dual addressing, which is determined based on
node pre-configuration by the operator. The Protocol Type over S5/S8 is
provided to Serving GW which protocol should be used over S5/S8 interface.
The charging characteristics for the PS subscription and individually
subscribed APNs as well as the way of handling Charging Characteristics and
whether to send them or not to the P‑GW is defined in TS 32.251 [44]. The MME
shall include Trace Reference, Trace Type, Trigger Id, and OMC Identity if
S‑GW and/or P‑GW trace is activated. The MME shall copy Trace Reference, Trace
Type, and OMC Identity from the trace information received from the HLR or
OMC.
The Maximum APN Restriction denotes the most stringent restriction as required
by any already active bearer context. If there are no already active bearer
contexts, this value is set to the least restrictive type (see clause 15.4 of
TS 23.060 [7]). If the P‑GW receives the Maximum APN Restriction, then the
P‑GW shall check if the Maximum APN Restriction value does not conflict with
the APN Restriction value associated with this bearer context request. If
there is no conflict the request shall be allowed, otherwise the request shall
be rejected with sending an appropriate error cause to the UE.
13\. The Serving GW creates a new entry in its EPS Bearer table and sends a
Create Session Request (IMSI, MSISDN, APN, Serving GW Address for the user
plane, Serving GW TEID of the user plane, Serving GW TEID of the control
plane, RAT type, Default EPS Bearer QoS, PDN Type, PDN Address, subscribed
APN-AMBR, EPS Bearer Identity, Protocol Configuration Options, Handover
Indication, ME Identity, User Location Information (ECGI), MS Info Change
Reporting support indication, Selection Mode, Charging Characteristics, Trace
Reference, Trace Type, Trigger Id, OMC Identity, Maximum APN Restriction, Dual
Address Bearer Flag) message to the PDN GW indicated by the PDN GW address
received in the previous step. After this step, the Serving GW buffers any
downlink packets it may receive from the PDN GW without sending a Downlink
Data Notification message to the MME until it receives the Modify Bearer
Request message in step 23 below. The MSISDN is included if received from the
MME.
14\. If dynamic PCC is deployed and the Handover Indication is not present,
the PDN GW performs an IP-CAN Session Establishment procedure as defined in TS
23.203 [6], and thereby obtains the default PCC rules for the UE. This may
lead to the establishment of a number of dedicated bearers following the
procedures defined in clause 5.4.1 in association with the establishment of
the default bearer, which is described in Annex F.
The IMSI, UE IP address, User Location Information (ECGI), Serving Network,
RAT type, APN-AMBR, Default EPS Bearer QoS are provided to the PCRF by the PDN
GW if received by the previous message. The User Location Information is used
for location based charging.
The PCRF may modify the APN-AMBR and the QoS parameters (QCI and ARP)
associated with the default bearer in the response to the PDN GW as defined in
TS 23.203 [6].
NOTE 7: While the PDN GW/PCEF may be configured to activate predefined PCC
rules for the default bearer, the interaction with the PCRF is still required
to provide e.g. the UE IP address information to the PCRF.
NOTE 8: If the IP address is not available when the PDN GW performs the IP-CAN
Session Establishment procedure with the PCRF, the PDN GW initiates an IP-CAN
Session Modification procedure to inform the PCRF about an allocated IP
address as soon as the address is available. In this version of the
specification, this is applicable only to IPv4 address allocation.
If dynamic PCC is deployed and the Handover Indication is present, the PDN GW
executes a PCEF Initiated IP‑CAN Session Modification procedure with the PCRF
as specified in TS 23.203 [6] to report the new IP‑CAN type. Depending on the
active PCC rules, the establishment of dedicated bearers for the UE may be
required. The establishment of those bearers shall take place in combination
with the default bearer activation as described in Annex F. This procedure can
continue without waiting for a PCRF response. If changes to the active PCC
rules are required, the PCRF may provide them after the handover procedure is
finished.
In both cases (Handover Indication is present or not), if dynamic PCC is not
deployed, the PDN GW may apply local QoS policy. This may lead to the
establishment of a number of dedicated bearers for the UE following the
procedures defined in clause 5.4.1 in combination with the establishment of
the default bearer, which is described in Annex F.
15\. The P‑GW creates a new entry in its EPS bearer context table and
generates a Charging Id. The new entry allows the P‑GW to route user plane
PDUs between the S‑GW and the packet data network, and to start charging. The
way the P‑GW handles Charging Characteristics that it may have received is
defined in TS 32.251 [44].
The PDN GW returns a Create Session Response (PDN GW Address for the user
plane, PDN GW TEID of the user plane, PDN GW TEID of the control plane, PDN
Type, PDN Address, EPS Bearer Identity, EPS Bearer QoS, Protocol Configuration
Options, Charging Id, Prohibit Payload Compression, APN Restriction, Cause, MS
Info Change Reporting Action (Start) (if the PDN GW decides to receive UE\'s
location information during the session), APN-AMBR) message to the Serving GW.
The PDN GW takes into account the received PDN type, the Dual Address Bearer
Flag and the policies of operator when the PDN GW selects the PDN type to be
used as follows. If the received PDN type is IPv4v6 and both IPv4 and IPv6
addressing is possible in the PDN but the Dual Address Bearer Flag is not set,
or only single IP version addressing for this APN is possible in the PDN, the
PDN GW selects a single IP version (either IPv4 or IPv6). If the received PDN
type is IPv4 or IPv6, the PDN GW uses the received PDN type if it is supported
in the PDN, otherwise an appropriate error cause will be returned. The PDN GW
allocates a PDN Address according to the selected PDN type. If the PDN GW has
selected a PDN type different from the received PDN Type, the PDN GW indicates
together with the PDN type IE a reason cause to the UE why the PDN type has
been modified, as described in clause 5.3.1.1. PDN Address may contain an IPv4
address for IPv4 and/or an IPv6 prefix and an Interface Identifier. If the PDN
has been configured by the operator so that the PDN addresses for the
requested APN shall be allocated by usage of DHCPv4 only, or if the PDN GW
allows the UE to use DHCPv4 for address allocation according to the Address
Allocation Preference received from the UE, the PDN Address shall be set to
0.0.0.0, indicating that the IPv4 PDN address shall be negotiated by the UE
with DHCPv4 after completion of the Default Bearer Activation procedure. For
external PDN addressing for IPv6, the PDN GW obtains the IPv6 prefix from the
external PDN using either RADIUS or Diameter client function. In the PDN
Address field of the Create Session Response, the PDN GW includes the
Interface Identifier and IPv6 prefix. The PDN GW sends Router Advertisement to
the UE after default bearer establishment with the IPv6 prefix information for
all cases.
If the PDN address is contained in the Create Session Request, the PDN GW
shall allocate the IPv4 address and/or IPv6 prefix contained in the PDN
address to the UE. The IP address allocation details are described in clause
5.3.1 on \"IP Address Allocation\". The PDN GW derives the BCM based on the
NRSU and operator policy. Protocol Configuration Options contains the BCM as
well as optional PDN parameters that the P‑GW may transfer to the UE. These
optional PDN parameters may be requested by the UE, or may be sent unsolicited
by the P‑GW. Protocol Configuration Options are sent transparently through the
MME.
When the Handover Indication is present, the PDN GW does not yet send downlink
packets to the S‑GW; the downlink path is to be switched at step 23a.
16\. If the MS Info Change Reporting Action (Start) is received for this
bearer context, then the S‑GW shall store this for the bearer context and the
S‑GW shall report to that P‑GW whenever a UE\'s location change occurs that
meets the P‑GW request, as described in clause 15.1.1a of TS 23.060 [7].
The Serving GW returns a Create Session Response (PDN Type, PDN Address,
Serving GW address for User Plane, Serving GW TEID for User Plane, Serving GW
TEID for control plane, EPS Bearer Identity, EPS Bearer QoS, PDN GW addresses
and TEIDs (GTP-based S5/S8) or GRE keys (PMIP-based S5/S8) at the PDN GW(s)
for uplink traffic, Protocol Configuration Options, Prohibit Payload
Compression, APN Restriction, Cause, MS Info Change Reporting Action (Start),
APN-AMBR) message to the new MME.
17\. If an APN Restriction is received, then the MME shall store this value
for the Bearer Context and the MME shall check this received value with the
stored value for the Maximum APN Restriction to ensure there are no conflicts
between values. If the Bearer Context is accepted, the MME shall determine a
(new) value for the Maximum APN Restriction. If there is no previously stored
value for Maximum APN Restriction, then the Maximum APN Restriction shall be
set to the value of the received APN Restriction.
If the MS Info Change Reporting Action (Start) is received for this bearer
context, then the MME shall store this for the bearer context and the MME
shall report whenever a UE\'s location change occurs that meets the request,
as described in clause 15.1.1a of TS 23.060 [7].
The MME determines the UE AMBR to be used by the eNodeB based on the
subscribed UE-AMBR and the APN‑AMBR for the default APN, see clause 4.7.3.
The new MME sends an Attach Accept (APN, GUTI, PDN Type, PDN Address, TAI
List, EPS Bearer Identity, Session Management Request, Protocol Configuration
Options, NAS sequence number, NAS-MAC, IMS Voice over PS session supported
Indication) message to the eNodeB. GUTI is included if the new MME allocates a
new GUTI. This message is contained in an S1_MME control message Initial
Context Setup Request. This S1 control message also includes the AS security
context information for the UE, the Handover Restriction List, the EPS Bearer
QoS, the UE-AMBR, EPS Bearer Identity, as well as the TEID at the Serving GW
used for user plane and the address of the Serving GW for user plane. In the
Attach Accept message, the MME does not include the IPv6 prefix within the PDN
Address. The MME includes the EPS Bearer QoS parameter QCI and APN-AMBR into
the Session Management Request. Furthermore, if the UE has UTRAN or GERAN
capabilities, the MME uses the EPS bearer QoS information to derive the
corresponding PDP context parameters QoS Negotiated (R99 QoS profile), Radio
Priority, Packet Flow Id and TI and includes them in the Session Management
Request. If the UE indicated in the UE Network Capability it does not support
BSS packet flow procedures, then the MME shall not include the Packet Flow Id.
Handover Restriction List is described in clause 4.3.5.7 \"Mobility
Restrictions\". The MME sets the IMS Voice over PS session supported
Indication as described in clause 4.3.5.8.
If the MME or PDN GW has changed the PDN Type, an appropriate reason cause
shall be returned to the UE as described in clause 5.3.1.1.
18\. The eNodeB sends the RRC Connection Reconfiguration message including the
EPS Radio Bearer Identity to the UE, and the Attach Accept message will be
sent along to the UE. The UE shall store the QoS Negotiated, Radio Priority,
Packet Flow Id and TI, which it received in the Session Management Request,
for use when accessing via GERAN or UTRAN. The APN is provided to the UE to
notify it of the APN for which the activated default bearer is associated. For
further details, see TS 36.331 [37]. The UE may provide EPS Bearer QoS
parameters to the application handling the traffic flow(s). The application
usage of the EPS Bearer QoS is implementation dependent. The UE shall not
reject the RRC Connection Reconfiguration on the basis of the EPS Bearer QoS
parameters contained in the Session Management Request.
When receiving the Attach Accept message the UE shall set its TIN to \"GUTI\"
as no ISR Activated is indicated.
If the UE receives an IPv4 address set to 0.0.0.0, it may negotiate the IPv4
address with DHCPv4 as specified in TS 29.061 [38]. If the UE receives an IPv6
interface identifier, it may wait for the Router Advertisement from the
network with the IPv6 prefix information or it may send a Router Solicitation
if necessary.
NOTE 9: The IP address allocation details are described in clause 5.3.1 on
\"IP Address Allocation\".
19\. The UE sends the RRC Connection Reconfiguration Complete message to the
eNodeB. For further details, see TS 36.331 [37].
20\. The eNodeB sends the Initial Context Response message to the new MME.
This Initial Context Response message includes the TEID of the eNodeB and the
address of the eNodeB used for downlink traffic on the S1_U reference point.
21\. The UE sends a Direct Transfer message to the eNodeB, which includes the
Attach Complete (EPS Bearer Identity, NAS sequence number, NAS-MAC) message.
22\. The eNodeB forwards the Attach Complete message to the new MME in an
Uplink NAS Transport message.
After the Attach Accept message and once the UE has obtained a PDN Address,
the UE can then send uplink packets towards the eNodeB which will then be
tunnelled to the Serving GW and PDN GW. If the UE requested for a dual address
PDN type (IPv4v6) to a given APN and was granted a single address PDN type
(IPv4 or IPv6) by the network with a reason cause indicating that only single
IP version per PDN connection is allowed sent together with the PDN type, the
UE may request for the activation of a parallel PDN connection to the same APN
with a single address PDN type (IPv4 or IPv6) other than the one already
activated. If the UE receives no reason cause in step 18 in response to an
IPv4v6 PDN type and it receives an IPv6 Interface Identifier apart from the
IPv4 address or 0.0.0.0 in the PDN Address field, it considers that the
request for a dual address PDN was successful. It can wait for the Router
Advertisement from the network with the IPv6 prefix information or it may send
Router Solicitation if necessary.
23\. Upon reception of both, the Initial Context Response message in step 21
and the Attach Complete message in step 22, the new MME sends a Modify Bearer
Request (EPS Bearer Identity, eNodeB address, eNodeB TEID, Handover
Indication) message to the Serving GW.
23a. If the Handover Indication is included in step 23, the Serving GW sends a
Modify Bearer Request (Handover Indication) message to the PDN GW to prompt
the PDN GW to tunnel packets from non 3GPP IP access to 3GPP access system and
immediately start routing packets to the Serving GW for the default and any
dedicated EPS bearers established.
23b. The PDN GW acknowledges by sending Modify Bearer Response to the Serving
GW.
24\. The Serving GW acknowledges by sending Modify Bearer Response (EPS Bearer
Identity) message to the new MME. The Serving GW can then send its buffered
downlink packets.
25\. After the MME receives Modify Bearer Response (EPS Bearer Identity)
message, if Request type does not indicate handover and an EPS bearer was
established and the subscription data indicates that the user is allowed to
perform handover to non-3GPP accesses, and if the MME selected a PDN GW that
is different from the PDN GW identity which was indicated by the HSS in the
PDN subscription context, the MME shall send a Notify Request including the
APN and PDN GW identity to the HSS for mobility with non-3GPP accesses. The
message shall also include information that identifies the PLMN in which the
PDN GW is located.
26\. The HSS stores the APN and PDN GW identity pair and sends a Notify
Response to the MME.
NOTE 10: For handover from non-3GPP access, the PDN GW initiates resource
allocation deactivation procedure in the trusted/untrusted non-3GPP IP access
as specified in TS 23.402 [2].
#### 5.3.2.2 UTRAN/GERAN Initial Attach
When a UE attaches to UTRAN/GERAN, it executes the normal attach procedure as
defined in TS 23.060 [7]. When the UE needs an IP address, it initiates PDP
context activation procedure as defined in TS 23.060 [7].
### 5.3.3 Tracking Area Update procedures
#### 5.3.3.0 Triggers for tracking area update
A standalone tracking area update (with or without S‑GW change, described in
clauses 5.3.3.1 and 5.3.3.2 respectively) occurs when a GPRS-attached or
E‑UTRAN-attached UE experiences any of the following conditions:
\- UE detects it has entered a new TA that is not in the list of TAIs that the
UE registered with the network;
\- the periodic TA update timer has expired;
\- UE was in UTRAN PMM_Connected state (e.g. URA_PCH) when it reselects to
E‑UTRAN;
\- UE was in GPRS READY state when it reselects to E‑UTRAN;
\- the TIN indicates \"P-TMSI\" when the UE reselects to E-UTRAN (e.g. due to
bearer configuration modifications performed on GERAN/UTRAN);
\- the RRC connection was released with release cause \"load re-balancing TAU
required\";
\- the RRC layer in the UE informs the UE\'s NAS layer that an RRC connection
failure (in either E-UTRAN or UTRAN) has occurred;
\- a change of the UE Network Capability and/or MS Network Capability and/or
UE Specific DRX Parameters and/or TS 24.008 [47] MS Radio Access capability
(e.g. due to GERAN radio capability change or CDMA 2000 Radio Access
Technology Capability change) information of the UE.
\- for a SR-VCC capable UE, a change of MS Classmark 2 and/or MS Classmark 3
and/or Supported Codecs.
The procedure is initiated by an UE in either ECM-IDLE state or ECM-CONNECTED
state. The decision to perform S‑GW change during the tracking area update
procedure is made by the MME independently from the triggers above.
The cell selection for UTRAN is described in TS 25.304 [12] and TS 25.331
[33].
#### 5.3.3.0A Provision of UE\'s TAI to MME in ECM-CONNECTED state
The eNodeB shall include the TAI+ECGI of the current cell in every S1-AP
UPLINK NAS TRANSPORT message.
NOTE: An eNodeB can contain cells from more than one Tracking Area and intra-
eNodeB cell changes are not normally notified to the MME. However, the MME
needs to know the UE\'s current TAI in order to correctly produce a TAU accept
message.
#### 5.3.3.1 Tracking Area Update procedure with Serving GW change
Figure 5.3.3.1-1: Tracking Area Update procedure with Serving GW change
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2]. Steps 9 and 10 concern GTP based S5/S8.
NOTE 2: In case of Tracking Area Update without MME change the signalling in
steps 4, 5, 7 and steps 12-17 are skipped.
1\. One of the triggers described in clause 5.3.3.0 for starting the TAU
procedure occurs.
2\. The UE initiates the TAU procedure by sending, to the eNodeB, a TAU
Request (UE Core Network Capability, old GUTI, last visited TAI, active flag,
EPS bearer status, P‑TMSI Signature, additional GUTI, eKSI, NAS sequence
number, NAS-MAC, KSI) message together with RRC parameters indicating the
Selected Network and the old GUMMEI. . An exception is that, if the TAU was
triggered for load re-balancing purposes (see clause 4.3.7.3), the old GUMMEI
is not included in the RRC parameters.
If the UE\'s TIN indicates \"GUTI\" or \"RAT‑related TMSI\" and the UE holds a
valid GUTI then the old GUTI indicates this valid GUTI. If the UE\'s TIN
indicates \"P‑TMSI\" and the UE holds a valid P‑TMSI and related RAI then
these two elements are indicated as the old GUTI. Mapping a P‑TMSI and RAI to
a GUTI is specified in Annex H. When the UE is in connected mode (e.g. in
URA_PCH) when it reselects to E‑UTRAN, the UE shall set its TIN to \"P‑TMSI\".
If the UE holds a valid GUTI and the old GUTI indicates a GUTI mapped from a
P-TMSI and RAI, then the UE indicates the GUTI as additional GUTI. If the old
GUTI indicates a GUTI mapped from a P-TMSI and RAI, and the UE has a valid
P-TMSI signature, the P-TMSI signature shall be included.
The additional GUTI in the Tracking Area Update Request message allows the new
MME to find any already existing UE context stored in the new MME when the old
GUTI indicates a value mapped from a P-TMSI and RAI.
The RRC parameter \"old GUMMEI\" takes its value from the identifier that is
signalled as the old GUTI according to the rules above. For a combined
MME/SGSN the eNodeB is configured to route the MME‑code(s) of this combined
node to the same combined node. This eNodeB is also configured to route
MME‑code(s) of GUTIs that are generated by the UE\'s mapping of the P‑TMSIs
allocated by the combined node. Such an eNodeB configuration may also be used
for separate nodes to avoid changing nodes in the pool caused by inter RAT
mobility.
The last visited TAI shall be included in order to help the MME produce a good
list of TAIs for any subsequent TAU Accept message. Selected Network indicates
the network that is selected. Active flag is a request by UE to activate the
radio and S1 bearers for all the active EPS Bearers by the TAU procedure when
the UE is in ECM-IDLE state. The EPS bearer status indicates each EPS bearer
that is active in the UE. The TAU Request message shall be integrity protected
by the NAS-MAC as described in TS 33.401 [41]. eKSI, NAS sequence number and
NAS-MAC are included if the UE has valid EPS security parameters. NAS sequence
number indicates the sequential number of the NAS message. KSI is included if
the UE indicates a GUTI mapped from a P‑TMSI in the information element \"old
GUTI\".
3\. The eNodeB derives the MME from the RRC parameters carrying the old GUMMEI
and the indicated Selected Network. If that MME is not associated with that
eNodeB or the GUMMEI is not available or the UE indicates that the TAU
procedure was triggered by load re-balancing, the eNodeB selects an MME as
described in clause 4.3.8.3 on \"MME Selection Function\".
The eNodeB forwards the TAU Request message together with the TAI+ECGI of the
cell from where it received the message and with the Selected Network to the
new MME.
4\. The new MME uses the GUTI received from the UE to derive the old MME/S4
SGSN address, and sends a Context Request (old GUTI, complete TAU Request
message, P‑TMSI Signature, MME Address, UE validated) message to the old
MME/old S4 SGSN to retrieve user information. UE Validated indicates that the
new MME has validated the integrity protection of the TAU message, e.g. based
on native EPS security context for the UE. To validate the Context Request the
old MME uses the complete TAU Request message and the old S4 SGSN uses the
P‑TMSI Signature and responds with an appropriate error if integrity check
fails in old MME/S4 SGSN. This shall initiate the security functions in the
new MME. If the security functions authenticate the UE correctly, the new MME
shall send a Context Request (IMSI, complete TAU Request message, MME Address,
UE Validated) message to the old MME/S4 SGSN with the UE Validated set. If the
new MME indicates that it has authenticated the UE or if the old MME/old S4
SGSN correctly validates the UE, then the old MME/old S4 SGSN starts a timer.
5\. If the Context Request is sent to an old MME the old MME responds with a
Context Response (ME Identity (if available), MM Context, EPS Bearer
Context(s), Serving GW signalling Address and TEID(s), ISR Supported, MS Info
Change Reporting Action (if available), UE Core Network Capability, UE
Specific DRX Parameters) message.
If the Context Request is sent to an old S4 SGSN the old S4 SGSN responds with
a Context Response (MM Context, EPS Bearer Context(s), Serving GW signalling
Address and TEID(s), ISR Supported, MS Info Change Reporting Action (if
available), UE Core Network Capability, UE Specific DRX Parameters).
The MM Context contains security related information as well as other
parameters (including IMSI, ME Identity (if available) and MSISDN) as
described in clause 5.7.2 (Information Storage for MME). The unused
Authentication Quintets in the MM Context are also maintained in the SGSN. TS
33.401 [41] gives further details on the transfer of security related
information.
The PDN GW Address and TEID(s) (for GTP-based S5/S8) or GRE Keys (PMIP-based
S5/S8 at the PDN GW(s) for uplink traffic) and the TI(s), is part of the EPS
Bearer Context. If the UE is not known in the old MME/old S4 SGSN or if the
integrity check for the TAU Request message fails, the old MME/old S4 SGSN
responds with an appropriate error cause. ISR Supported is indicated if the
old MME/old S4 SGSN is capable to activate ISR for the UE. The MSISDN is
included if the old MME/old S4 SGSN has it stored for that UE.
6\. If the integrity check of TAU Request message (sent in step 2) failed,
then authentication is mandatory. The authentication functions are defined in
clause 5.3.10 on \"Security Function\". Ciphering procedures are described in
clause 5.3.10 on \"Security Function\". If GUTI allocation is going to be done
and the network supports ciphering, the NAS messages shall be ciphered.
If this TAU request is received for a UE which is already in ECM_CONNECTED
state and the PLMN-ID of the TAI sent by the eNodeB in Step 3 is different
from that of the GUTI in the TAU Request message, the MME shall delay
authenticating the UE until after Step 21 (TAU Complete message).
NOTE 3: The MME delays the authentication such that the UE first updates its
registered PLMN-ID to the new PLMN-ID selected by the RAN during handover. The
new PLMN-ID is provided by the MME to the UE as part of the GUTI in the TAU
accept message in Step 20. Doing this ensures that the same PLMN-ID is used in
the derivation of the Kasme key by both the network and the UE.
7\. The MME (if the MME has changed then it is the new MME) determines to
relocate the Serving GW. The Serving GW is relocated when the old Serving GW
cannot continue to serve the UE. The MME (if the MME has changed then it is
the new MME) may also decide to relocate the Serving GW if a new Serving GW is
expected to serve the UE longer and/or with a more optimal UE to PDN GW path,
or if a new Serving GW can be co-located with the PDN GW. Selection of a new
Serving GW is performed according to clause 4.3.8.2 on \"Serving GW selection
function\".
If the MME has changed the new MME sends a Context Acknowledge (Serving GW
change indication) message to the old MME/old S4 SGSN. Serving GW change
indication indicates a new Serving GW has been selected. The old MME/old S4
SGSN marks in its UE context that the information in the GWs is invalid. And,
if the old node is an MME, the old MME marks in its UE context that the
information in the HSS is invalid. This ensures that the old MME/old S4 SGSN
updates the GWs, and the old MME updates the HSS, if the UE initiates a TAU or
RAU procedure back to the old MME/old S4 SGSN before completing the ongoing
TAU procedure. If the security functions do not authenticate the UE correctly,
then the TAU shall be rejected, and the new MME shall send a reject indication
to the old MME/old S4 SGSN. The old MME/old S4 SGSN shall continue as if the
Identification and Context Request was never received.
ISR is not indicated in the Context Acknowledge as ISR is not activated due to
the S‑GW change.
8\. If the MME has changed the new MME verifies the EPS bearer status received
from the UE with the bearer contexts received from the old MME/old S4 SGSN. .
If the MME has not changed the MME verifies EPS bearer status from the UE with
the bearer contexts available in the MM context. The MME releases any network
resources related to EPS bearers that are not active in the UE. If there is no
bearer context at all, the MME rejects the TAU Request.
If the MME selected a new Serving GW it sends a Create Session Request (IMSI,
bearer contexts, MME Address and TEID, Type, the Protocol Type over S5/S8, RAT
type) message per PDN connection to the selected new Serving GW. The PDN GW
address and TFT (for PMIP-based S5/S8) are indicated in the bearer Contexts.
Type indicates to the Serving GW to send the Create Session Request the PDN
GW. The Protocol Type over S5/S8 is provided to Serving GW which protocol
should be used over S5/S8 interface. RAT type indicates a change in radio
access. If the PDN GW requested UE\'s location info, the MME also includes the
User Location Information IE in this message.
9\. The Serving GW informs the PDN GW(s) about the change of for example the
RAT type that e.g. can be used for charging, by sending the message Modify
Bearer Request (Serving GW Address and TEID, RAT type) per PDN connection to
the PDN GW(s) concerned. User Location Information IE is also included if it
is present in step 8.
9a If dynamic PCC is deployed, and RAT type information needs to be conveyed
from the PDN GW to the PCRF, then the PDN GW shall send RAT type information
to the PCRF by means of an IP‑CAN Session Modification procedure as defined in
TS 23.203 [6].
NOTE 4: The PDN GW does not need to wait for the PCRF response, but continues
in the next step. If the PCRF response leads to an EPS bearer modification the
PDN GW should initiate a bearer update procedure.
10\. The PDN GW updates its bearer contexts and returns a Modify Bearer
Response (MSISDN Charging Id) message. The MSISDN is included if the PDN GW
has it stored in its UE context.
11\. The Serving GW updates its bearer context. This allows the Serving GW to
route bearer PDUs to the PDN GW when received from eNodeB.
The Serving GW returns a Create Session Response (Serving GW address and TEID
for user plane and control plane and PDN GW TEIDs (for GTP-based S5/S8) or GRE
keys (for PMIP-based S5/S8) for uplink traffic and control plane) message to
the new MME.
12\. The new MME verifies whether it holds subscription data for the UE
identified by the GUTI, the additional GUTI or by the IMSI received with the
context data from the old CN node. If there are no subscription data in the
new MME for this UE then the new MME sends an Update Location Request (MME
Identity, IMSI, ULR-Flags, MME Capabilities) message to the HSS. ULR-Flags
indicates that update location is sent from an MME and the MME registration
shall be updated in HSS. The HSS does not cancel any SGSN registration. The
MME capabilities indicate the MME\'s support for regional access restrictions
functionality.
13\. The HSS sends the message Cancel Location (IMSI, Cancellation Type) to
the old MME with Cancellation Type set to Update Procedure.
14\. If the timer started in step 4 is not running, the old MME removes the MM
context. Otherwise, the contexts are removed when the timer expires. It also
ensures that the MM context is kept in the old MME for the case the UE
initiates another TAU procedure before completing the ongoing TAU procedure to
the new MME. The old MME acknowledges with the message Cancel Location Ack
(IMSI).
15\. When old S4 SGSN receives the Context Acknowledge message and if the UE
is in Iu Connected, the old S4 SGSN sends an Iu Release Command message to the
RNC after the timer started in step 4 has expired.
16\. The RNC responds with an Iu Release Complete message.
17\. The HSS acknowledges the Update Location Request message by sending an
Update Location Ack (IMSI, Subscription Data) message to the new MME. If the
Update Location is rejected by the HSS, the new MME rejects the TAU Request
from the UE with an appropriate cause. The new MME validates the UE\'s
presence in the (new) TA. If due to regional subscription restrictions or
access restrictions the UE is not allowed to access the TA, the MME rejects
the Tracking Area Update Request with an appropriate cause to the UE. If all
checks are successful then the new MME constructs a context for the UE.
18\. If the MME has changed, when the timer started in step 4 expires the old
MME/old S4 SGSN releases any local MME or SGSN bearer resources and if it
received the Serving GW change indication in the Context Acknowledge message,
the old MME/old S4 SGSN deletes the EPS bearer resources by sending Delete
Session Request (Cause, TEID) messages to the old Serving GW. Cause indicates
to the old Serving GW that the old Serving GW shall not initiate a delete
procedure towards the PDN GW. If ISR is activated the cause also indicates to
the old S‑GW that the old S‑GW shall delete the bearer resources on the other
old CN node by sending Delete Bearer Request message(s) to that CN node. If
the MME has not changed, step 11 triggers the release of EPS bearer resources
when a new Serving GW is allocated.
19\. The Serving GW acknowledges with Delete Session Response (TEID) messages.
The Serving GW discards any packets buffered for the UE.
20\. The MME sends a TAU Accept (GUTI, TAI list, EPS bearer status, NAS
sequence number, NAS-MAC, IMS Voice over PS session supported Indication)
message to the UE. If the active flag is set the MME may provide the eNodeB
with Handover Restriction List. GUTI is included if the MME allocates a new
GUTI. If the \"active flag\" is set in the TAU Request message the user plane
setup procedure can be activated in conjunction with the TAU Accept message.
The procedure is described in detail in TS 36.300 [5]. The message sequence
should be the same as for the UE triggered Service Request procedure specified
in clause 5.3.4.1 from the step when MME establishes the bearer(s). The MME
indicates the EPS bearer status IE to the UE. The UE removes any internal
resources related to bearers that are not marked active in the received EPS
bearer status. Handover Restriction List is described in clause 4.3.5.7
\"Mobility Restrictions\". The MME sets the IMS Voice over PS session
supported Indication as described in clause 4.3.5.8.
When receiving the TAU Accept message and there is no ISR Activated indication
the UE shall set its TIN to \"GUTI\".
For a S‑GW change, ISR Activated is never indicated by the MME as it needs a
RAU with the same S‑GW first to activate ISR. For an MME change, ISR is not
activated by the new MME to avoid context transfer procedures with two old CN
nodes.
21\. If GUTI was included in the TAU Accept, the UE acknowledges the received
message by returning a TAU Complete message to the MME.
When the \"Active flag\" is not set in the TAU Request message and the
Tracking Area Update was not initiated in ECM-CONNECTED state, the new MME
releases the signalling connection with UE, according to clause 5.3.5.
NOTE 5: The new MME may initiate E‑RAB establishment (see TS 36.413 [36])
after execution of the security functions, or wait until completion of the TA
update procedure. For the UE, E‑RAB establishment may occur anytime after the
TA update request is sent.
In the case of a rejected tracking area update operation, due to regional
subscription, roaming restrictions, or access restrictions (see TS 23.221 [27]
and TS 23.008 [28]) the new MME shall not construct an MM context for the UE.
A reject shall be returned to the UE with an appropriate cause and the S1
connection shall be released. Upon return to idle, the UE shall act according
to TS 23.122 [10].
The new MME shall determine the Maximum APN restriction based on the received
APN Restriction of each bearer context in the Context Response message and
then store the new Maximum APN restriction value.
The bearer contexts shall be prioritized by the new MME. If the new MME is
unable to support the same number of active bearer contexts as received from
old MME/SGSN, the prioritisation is used to decide which bearer contexts to
maintain active and which ones to delete. In any case, the new MME shall first
update all contexts in one or more P‑GWs and then deactivate the bearer
context(s) that it cannot maintain as described in the clause \"MME Initiated
Dedicated Bearer Deactivation Procedure\". This shall not cause the MME to
reject the tracking area update.
NOTE 6: If the MS (UE) was in PMM-CONNECTED state the bearer contexts are sent
already in the Forward Relocation Request message as described in the clause
\"Serving RNS relocation procedures\" of TS 23.060 [7].
If the tracking area update procedure fails a maximum allowable number of
times, or if the MME returns a Tracking Area Update Reject (Cause) message,
the UE shall enter EMM DEREGISTERED state.
#### 5.3.3.2 E-UTRAN Tracking Area Update without S‑GW Change
Figure 5.3.3.2-1: E-UTRAN Tracking Area Update without S‑GW change
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 12 and 14 concern GTP based S5/S8.
NOTE 2: In case of Tracking Area Update without MME change the signalling in
steps 4, 5, 7 and steps 9-19 are skipped.
1\. One of the triggers described in clause 5.3.3.0 for starting the TAU
procedure occurs.
2\. The UE initiates a TAU procedure by sending, to the eNodeB, a Tracking
Area Update Request (UE Core Network Capability, active flag, EPS bearer
status, old GUTI, last visited TAI, P-TMSI signature, additional GUTI,
KSI~SGSN~, KSI~ASME~, NAS sequence number, NAS-MAC) message together with RRC
parameters indicating the Selected Network and the old GUMMEI. An exception is
that, if the TAU was triggered for load re-balancing purposes (see clause
4.3.7.3), the old GUMMEI is not included in the RRC parameters.
If the UE\'s TIN indicates \"GUTI\" or \"RAT‑related TMSI\" and the UE holds a
valid GUTI then the old GUTI indicates this valid GUTI. If the UE\'s TIN
indicates \"P‑TMSI\" and the UE holds a valid P‑TMSI and related RAI then
these two elements are indicated as the old GUTI. Mapping a P‑TMSI and RAI to
a GUTI is specified in Annex H. When the UE is in connected mode (e.g. in
URA_PCH) when it reselects to E-UTRAN, the UE shall set its TIN to \"P‑TMSI\".
If the UE holds a valid GUTI and the old GUTI indicates a GUTI mapped from a
P-TMSI and RAI, then the UE indicates the GUTI as additional GUTI. If the old
GUTI indicates a GUTI mapped from a P-TMSI and RAI, and the UE has a valid
P-TMSI signature, the P-TMSI signature shall be included.
The additional GUTI in the Tracking Area Update Request message allows the new
MME to find any already existing UE context stored in the new MME when the old
GUTI indicates a value mapped from a P-TMSI and RAI.
The RRC parameter \"old GUMMEI\" takes its value from the identifier that is
signalled as the old GUTI according to the rules above. For a combined
MME/SGSN the eNodeB is configured to route the MME‑code(s) of this combined
node to the same combined node. This eNodeB is also configured to route
MME‑code(s) of GUTIs that are generated the UE\'s mapping of the P‑TMSIs
allocated by the combined node. Such an eNodeB configuration may also be used
for separate nodes to avoid changing nodes in the pool caused by inter RAT
mobility.
The last visited TAI shall be included in order to help the MME produce a good
list of TAIs for any subsequent TAU Accept message. Selected Network indicates
the network that is selected. Active flag is a request by the UE to activate
the radio and S1 bearers for all the active EPS Bearers by the TAU procedure.
The UE\'s ISR capability is included in the UE Core Network Capability
element. The EPS bearer status indicates each EPS bearer that is active in the
UE. The TAU Request message shall be integrity protected by the NAS-MAC as
described in TS 33.401 [41]. KSI~ASME~ is included if the UE has valid
security parameters. NAS sequence number indicates the sequential number of
the NAS message.
KSI~SGSN~ is included if the UE indicates a GUTI mapped from a P‑TMSI in the
information element \"old GUTI\".
3\. The eNodeB derives the MME from the RRC parameters carrying the old GUMMEI
and the indicated Selected Network. If that GUMMEI is not associated with the
eNodeB, or the GUMMEI is not available or the UE indicates that the TAU
procedure was triggered by load re-balancing, the eNodeB selects the MME as
described in clause 4.3.8.3 on \"MME Selection Function\". The eNodeB forwards
the TAU Request message together with the TAI+ECGI of the cell from where it
received the message and with the Selected Network to the MME.
4\. The new MME uses the GUTI received from the UE to derive the old MME/S4
SGSN address and sends a Context Request (old GUTI, MME Address, UE Validated,
complete TAU Request message, P‑TMSI Signature) message to the old MME/S4 SGSN
to retrieve the user information. UE Validated indicates that the new MME has
validated the integrity protection of the TAU message, e.g. based on native
EPS security context for the UE. To validate the Context Request the old MME
uses the complete TAU Request message and the old S4 SGSN uses the P-TMSI
Signature and responds with an appropriate error if integrity check fails in
old MME/S4 SGSN.. This shall initiate the security functions in the new MME.
If the security functions authenticate the UE correctly, the new MME shall
send a Context Request (IMSI, complete TAU Request message, MME Address, UE
Validated) message to the old MME/S4 SGSN with the UE Validated set. If the
new MME indicates that it has authenticated the UE or if the old MME/old S4
SGSN authenticates the UE, the old MME/old S4 SGSN starts a timer.
5\. If the Context Request is sent to an old MME the old MME responds with a
Context Response (IMSI, ME Identity (if available), MSISDN, unused EPS
Authentication Vectors, KSI~ASME~, K~ASME~, EPS Bearer Context(s), Serving GW
signalling Address and TEID(s), MS Info Change Reporting Action (if
available), UE Core Network Capability, UE Specific DRX Parameters) message.
If the Context Request is sent to an old S4 SGSN the old S4 SGSN responds with
a Context Response (IMSI, ME Identity (if available), MSISDN, unused
Authentication Quintets, CK, IK, KSI~SGSN~, EPS Bearer Context(s), Serving GW
signalling Address and TEID(s), ISR Supported, MS Info Change Reporting Action
(if available), UE Core Network Capability, UE Specific DRX Parameters)
message. The Authentication Quintets are maintained by the old S4 SGSN. TS
33.401 [41] gives further details on the transfer of security related
information.
The PDN GW Address and TEID(s) (for GTP-based S5/S8) or GRE Keys (PMIP-based
S5/S8 at the PDN GW(s) for uplink traffic and the TI(s), is part of the EPS
Bearer Context. ISR Supported is indicated if the old SGSN is capable to
activate ISR for the UE.
The new MME shall ignore the UE Core Network Capability contained in the
Context Response only when it has previously received an UE Core Network
Capability in the Tracking Area Update Request. If the UE is not known in the
old MME/old S4 SGSN or if the integrity check for the TAU request message
fails, the old MME/old S4 SGSN responds with an appropriate error cause.
6\. If the integrity check of TAU Request message (sent in step 2) failed,
then authentication is mandatory. The authentication functions are defined in
clause 5.3.10 on \"Security Function\". Ciphering procedures are described in
clause 5.3.10 on \"Security Function\". If GUTI allocation is going to be done
and the network supports ciphering, the NAS messages shall be ciphered.
If this TAU request is received for a UE which is already in ECM_CONNECTED
state and the PLMN-ID of the TAI sent by the eNodeB in Step 3 is different
from that of the GUTI included in the TAU Request message, the MME shall delay
authenticating the UE until after Step 21 (TAU Complete message).
NOTE 3: The MME delays the authentication such that the UE first updates its
registered PLMN-ID to the new PLMN-ID selected by the RAN during handover. The
new PLMN-ID is provided by the MME to the UE as part of the GUTI in the TAU
accept message in Step 20. Doing this ensures that the same PLMN-ID is used in
the derivation of the Kasme key by both the network and the UE.
7\. If the old node is an old MME the new MME sends a Context Acknowledge
message to the old MME. The old MME marks in its context that the information
in the GWs and the HSS are invalid. This ensures that the MME updates the GWs
and the HSS if the UE initiates a TAU procedure back to the MME before
completing the ongoing TAU procedure.
If the old node is an old S4 SGSN the MME sends a Context Acknowledge (ISR
Activated) message to the old SGSN. Unless ISR Activated is indicated by the
MME, the old S4 SGSN marks in its context that the information in the GWs is
invalid. This ensures that the old S4 SGSN updates the GWs if the UE initiates
a RAU procedure back to the old S4 SGSN before completing the ongoing TAU
procedure. If ISR Activated is indicated to the old S4 SGSN, this indicates
that the old S4 SGSN shall maintain its UE context including authentication
quintets and stop the timer started in step 4. In this case, if the Implicit
Detach timer is running, the old S4 SGSN shall re-start it with a slightly
larger value than the UE\'s GERAN/UTRAN Deactivate ISR timer. Also, in this
case, if the old SGSN has maintained the Serving GW address for user plane and
S4 GTP-U TEID, the old SGSN shall remove Serving GW address for user plane and
S4 GTP-U TEID locally. When ISR Activated is not indicated and this timer
expires the old SGSN deletes all bearer resources of that UE. As the Context
Acknowledge from the MME does not include any S‑GW change the S4 SGSN does not
send any Delete Session Request message to the S‑GW.
If the security functions do not authenticate the UE correctly, then the TAU
shall be rejected, and the MME shall send a reject indication to the old
MME/old S4 SGSN. The old MME/old S4 SGSN shall continue as if the
Identification and Context Request was never received.
8\. Void.
9\. If the MME has changed the new MME adopts the bearer contexts received
from the old MME/SGSN as the UE\'s EPS bearer contexts to be maintained by the
new MME. The MME establishes the EPS bearer(s) in the indicated order. The MME
deactivates the EPS bearers which cannot be established.
The MME verifies the EPS bearer status received from the UE with the EPS
bearer contexts it maintains and releases any network resources related to EPS
bearers that are not active in the UE. If there is no bearer context at all,
the MME rejects the TAU Request. If the MME has changed the new MME sends a
Modify Bearer Request (new MME address and TEID, Serving network identity, ISR
Activated, RAT type) message per PDN connection to the Serving GW. The PDN GW
address is indicated in the bearer contexts. If indicated, the information ISR
Activated indicates that ISR is activated. If the PDN GW requested UE\'s
location info, the MME also includes the User Location Information IE in this
message. If the old node is an old MME at a Tracking Area Update with a MME
change ISR Activated shall not be indicated.
When the Modify Bearer Request does not indicate ISR Activated the S‑GW
deletes any ISR resources by sending a Delete Bearer Request to the other CN
node that has bearer resources on the S‑GW reserved.
10\. If the RAT type has changed or the Serving GW has received the User
Location Information IE from the MME in step 9 the Serving GW informs the PDN
GW(s) about this information that e.g. can be used for charging, by sending
the message Modify Bearer Request (RAT type) per PDN connection to the PDN
GW(s) concerned. User Location Information IE is also included if it is
present in step 9.
11\. If dynamic PCC is deployed, and RAT type information or UE location
information needs to be conveyed from the PDN GW to the PCRF, then the PDN GW
shall send this information to the PCRF by means of an IP‑CAN Session
Modification procedure as defined in TS 23.203 [6].
NOTE 4: The PDN GW does not need to wait for the PCRF response, but continues
in the next step. If the PCRF response leads to an EPS bearer modification the
PDN GW should initiate a bearer update procedure.
12\. The PDN GW updates its context field to allow DL PDUs to be routed to the
correct Serving GW. PDN GW returns a Modify Bearer Response (MSISDN) to the
Serving GW. The MSISDN is included if the PDN GW has it stored in its UE
context.
13\. The Serving GW updates its bearer context. If ISR Activated is indicated
in step 9 and RAT Type received in step 9 indicates E‑UTRAN, then the Serving
GW only updates the MME Control Plane Address stored locally and keep the SGSN
related information unchanged. Also, in this case, if the Serving GW has
maintained the SGSN address for user plane and S4 GTP-U TEID, the Serving GW
shall remove the SGSN address for user plane and S4 GTP-U TEID locally.
Otherwise the Serving GW shall update all of the information stored locally
for this UE with the related information received from the MME. This allows
the Serving GW to route Bearer PDUs to the PDN GW when received from eNodeB.
The Serving GW returns a Modify Bearer Response (Serving GW address and TEID
for uplink traffic) message to the new MME.
14\. The new MME verifies whether it holds subscription data for the UE
identified by the GUTI, the additional GUTI or by the IMSI received with the
context data from the old CN node. If there are no subscription data in the
new MME for this UE then the new MME informs the HSS of the change of MME by
sending an Update Location Request (MME Id, IMSI, ULR-Flags, MME Capabilities)
message to the HSS. ULR-Flags indicates that update location is sent from an
MME and the MME registration shall be updated in HSS. The HSS does not cancel
any SGSN registration. The MME capabilities indicate the MME\'s support for
regional access restrictions functionality.
15\. The HSS sends a Cancel Location (IMSI, Cancellation type) message to the
old MME with a Cancellation Type set to Update Procedure.
16\. When receiving a Cancel Location message and the timer started in step 4
is not running, the old MME removes the MM and bearer contexts. Otherwise, the
contexts are removed when the timer expires. It also ensures that the MM
context is kept in the old MME for the case the UE initiates another TAU
procedure before completing the ongoing TAU procedure to the new MME. The old
MME acknowledges with a Cancel Location Ack (IMSI) message.
NOTE 5: ISR Activated is never indicated from new to old MME.
So an old MME deletes all the bearer resources of the UE in any case when the
timer started in step 4 expires, which is independent on receiving a Cancel
Location message.
17\. When receiving the Context Acknowledge message and if the UE is Iu
Connected, the old SGSN sends an Iu Release Command message to the RNC after
the timer started in step 4 has expired.
18\. The RNC responds with an Iu Release Complete message.
19\. The HSS acknowledges the Update Location Request by returning an Update
Location Ack (IMSI, Subscription Data) message to the new MME after the
cancelling of the old MME context is finished. If the Update Location is
rejected by the HSS, the MME rejects the TAU Request from the UE with an
appropriate cause sent in the TAU Reject message to the UE. The new MME
validates the UE\'s presence in the (new) TA. If due to regional subscription
restrictions or access restrictions the UE is not allowed to be attached in
the TA, the MME rejects the Tracking Area Update Request with an appropriate
cause to the UE. If all checks are successful, the MME constructs an MM
context for the UE.
20\. The MME responds to the UE with a Tracking Area Update Accept (GUTI, TAI-
list, EPS bearer status, NAS sequence number, NAS-MAC, ISR Activated, IMS
Voice over PS session supported Indication) message. If the active flag is set
the Handover Restriction List may be sent to eNodeB as eNodeB handles the
roaming restrictions and access restrictions in the Intra E-UTRAN case. If the
\"active flag\" is set in the TAU Request message the user plane setup
procedure is activated in conjunction with the TAU Accept message. The
procedure is described in detail in TS 36.300 [5]. The message sequence should
be the same as for the UE triggered Service Request procedure specified in
clause 5.3.4.1 from the step when MME establish the bearers(s). The EPS bearer
status indicates the active bearers in the network. The UE removes any
internal resources related to bearers not marked active in the received EPS
bearer status. If ISR Activated is indicated to the UE, this indicates that
its P-TMSI and RAI shall remain registered with the network and shall remain
valid in the UE. At a Tracking Area Update with an MME change ISR Activated
shall not be indicated. At a Tracking Area Update without an MME change, if
ISR is activated for the UE when the MME receives the Tracking Area Update
Request, the MME should maintain ISR by indicating ISR Activated in the
Tracking Area Update Accept message. Handover Restriction List is described in
clause 4.3.5.7 \"Mobility Restrictions\". The MME sets the IMS Voice over PS
session supported Indication as described in clause 4.3.5.8.
When receiving the TAU Accept message and there is no ISR Activated indication
the UE shall set its TIN to \"GUTI\". When ISR Activated is indicated and the
UE\'s TIN indicates \"GUTI\" the UE\'s TIN shall not be changed. When ISR
Activated is indicated and the TIN is \"P‑TMSI\" or \"RAT‑related TMSI\" the
UE shall set its TIN to \"RAT‑related TMSI\".
For an MME change ISR is not activated by the new MME to avoid context
transfer procedures with two old CN nodes.
21\. If the GUTI was changed the UE acknowledges the new GUTI by returning a
Tracking Area Update Complete message to the MME.
When the \"Active flag\" is not set in the TAU Request message and the
Tracking Area Update was not initiated in ECM-CONNECTED state, the MME
releases the signalling connection with UE, according to clause 5.3.5.
NOTE 6: The new MME may initiate E‑RAB establishment (see TS 36.413 [36])
after execution of the security functions, or wait until completion of the TA
update procedure. For the UE, E‑RAB establishment may occur anytime after the
TA update request is sent.
In the case of a rejected tracking area update operation, due to regional
subscription, roaming restrictions, or access restrictions (see TS 23.221 [27]
and TS 23.008 [28]) the new MME shall not construct an MM context for the UE.
A reject shall be returned to the UE with an appropriate cause and the S1
connection shall be released. Upon return to idle, the UE shall act according
to TS 23.122 [10].
If the new MME is unable to update the bearer context in one or more P‑GWs,
the new MME shall deactivate the corresponding bearer contexts as described in
clause \"MME Initiated Dedicated Bearer Deactivation Procedure\". This shall
not cause the MME to reject the tracking area update.
The new MME shall determine the Maximum APN restriction based on the received
APN Restriction of each bearer context in the Context Response message and
then store the new Maximum APN restriction value.
The bearer contexts shall be prioritized by the new MME. If the new MME is
unable to support the same number of active bearer contexts as received from
old MME/SGSN, the prioritisation is used to decide which bearer contexts to
maintain active and which ones to delete. In any case, the new MME shall first
update all contexts in one or more P‑GWs and then deactivate the context(s)
that it cannot maintain as described in clause \"MME Initiated Dedicated
Bearer Deactivation Procedure\". This shall not cause the MME to reject the
tracking area update.
NOTE 7: If the MS (UE) was in PMM-CONNECTED state the bearer contexts are sent
already in the Forward Relocation Request message as described in clause
\"Serving RNS relocation procedures\" of TS 23.060 [7].
If the tracking area update procedure fails a maximum allowable number of
times, or if the MME returns a Tracking Area Update Reject (Cause) message,
the UE shall enter EMM DEREGISTERED state.
If the Update Location Ack message indicates a reject, this should be
indicated to the UE, and the UE shall not access non-PS services until a
successful location update is performed.
#### 5.3.3.3 Routing Area Update with MME interaction and without S‑GW change
The Routing Area Update without S‑GW change procedure takes place when a UE
that is registered with an MME selects a UTRAN or GERAN cell and the S‑GW is
not changed by the procedure. In this case, the UE changes to a Routing Area
that the UE has not yet registered with the network. This procedure is
initiated by an ECM-IDLE state UE and may also be initiated if the UE is in
ECM-CONNECTED state. The RA update case is illustrated in Figure 5.3.3.3-1.
NOTE 0: This procedure covers the MME to 2G or 3G SGSN RAU.
Figure 5.3.3.3-1: Routing Area Update with MME interaction and without S‑GW
change
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2]. Steps 8 and 10 concern GTP based S5/S8.
1\. The UE selects a UTRAN or GERAN cell. This cell is in a Routing Area that
the UE not yet registered with the network, or the UE reselects a UTRAN or
GERAN cell and the TIN indicates \"GUTI\". The UE in ECM‑CONNECTED state may
change to the GERAN cell through Network Assisted Cell Change (NACC).
2a. The UE sends a Routing Area Update Request (old P-TMSI, old RAI, UE Core
Network Capability, P‑TMSI Signature, additional P‑TMSI/RAI, KSI) message to
the new SGSN.
If the UE\'s internal TIN indicates \"GUTI\" and the UE holds a valid GUTI
then the UE indicates the GUTI as the old P‑TMSI and old RAI. If the UE\'s TIN
indicates \"P‑TMSI\" or \"RAT‑related TMSI\" and the UE holds a valid P‑TMSI
and related RAI then these two elements are indicated as old P‑TMSI and old
RAI. Mapping a GUTI to a P‑TMSI and an RAI is specified in TS 23.003 [9].
If the UE holds a valid P‑TMSI and related RAI and the old P-TMSI and old RAI
indicate a P-TMSI/RAI mapped from a GUTI, then the UE indicates these
parameters as additional P‑TMSI/RAI.
The old P‑TMSI is indicated in the RAU Request message for Iu‑mode only. For
Gb mode the TLLI is derived from the value that is determined as the old
P‑TMSI according to the rules above. The routing parameter that is signalled
in the RRC signalling to the RNC for routing to the SGSN is derived from the
identifier that is signalled as the old P‑TMSI according to the rules above.
For a combined MME/SGSN the RAN is configured to route the NRI(s) of this
combined node to the same combined node. The RAN is also configured to route
NRI(s) of P‑TMSIs that are generated by the UE\'s mapping of the GUTIs
allocated by the combined node. Such a RAN configuration may also be used for
separate nodes to avoid changing nodes in the pool caused by inter RAT
mobility.
If the UE has a follow-on request, i.e. if there is pending uplink traffic
(signalling or data), the 3G SGSN may use, as an implementation option, the
follow-on request indication to release or keep the Iu connection after the
completion of the RA update procedure.
KSI is mapped from an eKSI identifying a K~ASME~ if the UE indicates a P‑TMSI
mapped from GUTI in the information element \"old P‑TMSI\". KSI identifies a
(CK, IK) pair if the UE indicates a P‑TMSI in the information element \"old
P‑TMSI\".
2b. The RNC shall add the Routing Area Identity before forwarding the message
to the SGSN. This RA identity corresponds to the RAI in the MM system
information sent by the RNC to the UE. The BSS shall add the Cell Global
Identity (CGI) of the cell where the UE is located before passing the message
to the new SGSN.
3\. The new S4 SGSN uses the old RAI received from the UE to derive the old
MME address, and sends a Context Request (P‑TMSI, old RAI, New SGSN Address,
P‑TMSI Signature) message to the old MME to get the context for the UE. To
validate the Context Request the old MME uses a NAS token mapped from the
P‑TMSI Signature. If the UE is not known in the old MME, the old MME responds
with an appropriate error cause. If integrity check fails in the old MME, the
old MME responds with an appropriate error cause which shall initiate the
security functions in the new S4 SGSN. If the security functions authenticate
the UE correctly, the new S4 SGSN shall send a Context Request (IMSI, old RAI,
New SGSN Address, UE Validated) message to the old MME.UE Validated indicates
that the new S4 SGSN has authenticated the UE. If the new S4 SGSN indicates
that it has authenticated the UE or if the old MME authenticates the UE, the
old MME starts a timer.
4\. The old MME responds with one Context Response (IMSI, ME Identity (if
available), MSISDN, KSI, CK, IK, unused Authentication Quintets, EPS Bearer
Contexts, Serving GW signalling Address and TEID(s), MS Info Change Reporting
Action (if available), UE Core Network Capability, UE Specific DRX Parameters)
message. The PDN GW Address and TEID(s) (for GTP-based S5/S8) or GRE Keys
(PMIP-based S5/S8) for uplink traffic and control plane, and the TI(s) is part
of the EPS Bearer context(s). The unused Authentication Quintets in the MM
Context may be sent if stored by the MME and if the MME received the unused
Authentication Quintets from the same SGSN previously.
The new S4 SGSN shall ignore the UE Core Network Capability contained in the
Context Response only when it has previously received an UE Core Network
Capability in the Routing Area Update Request. If UE is not known in the old
MME, the old MME responds with an appropriate error cause.
The new SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps the EPS
Bearer QoS parameter values of an EPS bearer to the pre-Rel-8 QoS parameter
values of a PDP context as defined in Annex E. The PDP context(s) are
established in the indicated order. The SGSN deactivates the PDP contexts
which cannot be established.
5\. Security functions may be executed. Procedures are defined in clause
5.3.10 on \"Security Function\".
6\. The new S4 SGSN sends a Context Acknowledge (ISR Activated) message to the
old MME. Unless ISR is indicated by the new S4 SGSN, the old MME marks in its
context that the information in the GWs is invalid. This ensures that the old
MME updates the GWs if the UE initiates a TAU procedure back to the old MME
before completing the ongoing RAU procedure. ISR Activated indicates to the
old MME that it shall maintain the UE\'s contexts and the MME stops the timer
started in step 3. In this case, if the Implicit Detach timer is running, the
old MME shall re-start it with a slightly larger value than the UE\'s E-UTRAN
Deactivate ISR timer. When ISR Activated is not indicated and this timer
expires the old MME deletes all bearer resources of that UE. As the Context
Acknowledge from the new S4 SGSN does not include any S‑GW change the old MME
does not send any Delete Session Request message to the S‑GW.
If the security functions do not authenticate the UE correctly, then the RAU
is rejected, and the new S4 SGSN sends a reject indication to the old MME. The
old MME shall continue as if the Identification and Context Request was never
received.
7\. In this procedure flow the Serving GW is not relocated. The SGSN sends a
Modify Bearer Request (new SGSN Address and TEID, serving network identity,
RAT type, ISR Activated) message per PDN connection to the Serving GW. If
indicated, the information ISR Activated indicates that ISR is activated. If
the PDN GW requested UE\'s location info, the SGSN also includes the User
Location Information IE in this message.
When the Modify Bearer Request does not indicate ISR Activated the S‑GW
deletes any ISR resources by sending a Delete Bearer Request to the other CN
node that has bearer resources on the S‑GW reserved. RAT type indicates a
change in radio access.
If ISR Activated is indicated or SGSN and SGW are configured to release S4
U-Plane when EPS Bearer Contexts associated with the released RABs are to be
preserved, the SGSN does not send SGSN address and TEID for U-Plane in Modify
Bearer Request.
8\. If the RAT type has changed or the Serving GW has received the User
Location Information IE from the MME in step 7 the Serving GW informs the PDN
GW(s) about the change of this information that e.g. can be used for charging,
by sending the message Modify Bearer Request (RAT type) per PDN connection to
the PDN GW(s) concerned. User Location Information IE is also included if it
is present in step 7.
9\. If dynamic PCC is deployed, and RAT type information or UE location
information needs to be conveyed from the PDN GW to the PCRF, then the PDN GW
shall send this information to the PCRF by means of an IP‑CAN Session
Modification procedure as defined in TS 23.203 [6].
NOTE 2: The PDN GW does not need to wait for the PCRF response, but continues
in the next step. If the PCRF response leads to an EPS bearer modification the
PDN GW should initiate a bearer update procedure.
10\. The PDN GW updates its context field and returns a Modify Bearer Response
(MSISDN) message to the Serving GW. MSISDN is included if the PDN GW has it
stored in its UE context.
11\. The Serving GW updates its context fields. If ISR Activated is indicated
in step 7 and RAT Type received in step 7 indicates UTRAN or GERAN, then the
Serving GW only updates the SGSN Control Plane Address, SGSN User Plane
Address and SGSN User Plane TEID (for two Tunnel) stored locally and keep the
MME related information unchanged. Otherwise the Serving GW shall update all
of the information stored locally for this UE with the related information
received from the SGSN. Then the Serving GW returns a Modify Bearer Response
(Serving GW address and TEID for uplink traffic) message.
12\. The new SGSN verifies whether it holds subscription data for the UE
identified by the P‑TMSI, the additional PTMSI/RAI or by the IMSI received
with the context data from the old CN node. The additional P-TMSI/RAI allows
the new SGSN to find any already existing UE context stored in the new SGSN.
If there are no subscription data in the new SGSN for this UE then the new
SGSN informs the HSS of the change of the SGSN by sending an Update Location
(SGSN Number, SGSN Address, IMSI) message to the HSS.
13\. The HSS sends a Cancel Location (IMSI, Cancellation Type) message to the
old SGSN with the Cancellation Type set to Update Procedure.
When receiving the Cancel Location message the old SGSN removes all the UE
contexts. The old SGSN acknowledges with a Cancel Location Ack (IMSI) message.
14\. When receiving the Context Acknowledge message from the new SGSN and if
the old MME has an S1-MME association for the UE, the source MME sends a S1-U
Release Command to the source eNodeB after the timer started in step 3 has
expired. The RRC connection is released by the source eNodeB. The source
eNodeB confirms the release of the RRC connection and of the S1-U connection
by sending a S1-U Release Complete message to the source MME.
15\. The HSS acknowledges the Update Location message by sending an Update
Location Ack (IMSI, Subscription Data) to the new SGSN. If the Update Location
is rejected by the HSS, the new SGSN rejects the RAU Request from the UE with
an appropriate cause. The new SGSN validates the UE\'s presence in the (new)
RA. If due to regional subscription restrictions or access restrictions the UE
is not allowed to be attached in the RA, the SGSN rejects the Routing Area
Update Request with an appropriate cause to the UE and notifies the HSS of the
rejection.
16\. Void.
17\. Void.
18\. The new SGSN responds to the UE with a Routing Area Update Accept
(P-TMSI, P-TMSI signature, ISR Activated) message to the UE. P-TMSI is
included if the SGSN allocates a new P-TMSI.
If ISR Activated is indicated to the UE, its GUTI and list of TAs shall remain
registered with the network and shall remain valid in the UE.
When receiving the RAU Accept message and there is no ISR Activated indication
the UE shall set its TIN to \"P‑TMSI\". When ISR Activated is indicated and
the UE\'s TIN indicates \"P‑TMSI\" the TIN shall not be changed. When ISR
Activated is indicated and the UE\'s TIN indicates \"GUTI\" or \"RAT‑related
TMSI\" the UE shall set its TIN to \"RAT‑related TMSI\".
For an SGSN change ISR is not activated by the new SGSN to avoid context
transfer procedures with two old CN nodes.
19\. If P-TMSI was included in the Routing Area Update Accept message, the UE
acknowledges the new P-TMSI by returning a Routing Area Update Complete
message to the SGSN.
20\. For Iu-mode, if the UE has uplink data or signalling pending it shall
send a Service Request (P-TMSI, CKSN, Service Type) message to the new SGSN.
If a P-TMSI was allocated in step 18, that P-TMSI is the one included in this
message. Service Type specifies the requested service. Service Type shall
indicate one of the following: Data or Signalling.
21\. If the UE has sent the Service Request, the new 3G SGSN requests the RNC
to establish a radio access bearer by sending a RAB Assignment Request (RAB
ID(s), QoS Profile(s), GTP SNDs, GTP SNUs, PDCP SNUs) message to the RNC. If
Direct Tunnel is established the SGSN provides to the RNC the Serving GW\'s
Address for User Plane and TEID for uplink data.
22\. If the SGSN established Direct Tunnel in step 21) it shall send Modify
Bearer Request per PDN connection to the Serving GW and include the RNC\'s
Address for User Plane and downlink TEID for data. The Serving GW updates the
Address for User Plane and TEID for downlink data and return a Modify Bearer
Response.
NOTE 3: EPS does not support any CAMEL procedures.
NOTE 4: The new SGSN may initiate RAB establishment after execution of the
security functions (step 5), or wait until completion of the RA update
procedure. For the MS, RAB establishment may occur anytime after the RA update
request is sent (step 2).
In the case of a rejected routing area update operation, due to regional
subscription, roaming restrictions, or access restrictions (see TS 23.221 [27]
and TS 23.008 [28]) the new SGSN shall not construct an MM context. A reject
shall be returned to the UE with an appropriate cause and the PS signalling
connection shall be released. Upon return to idle, the UE shall act according
to TS 23.122 [10].
If the network supports the MOCN configuration for network sharing, the SGSN
may, if the UE is not a \'Network Sharing Supporting MS\', in this case decide
to initiate redirection by sending a Reroute Command to the RNS, as described
in TS 23.251 [24] instead of rejecting the routing area update.
If the new SGSN is unable to update the bearer context in one or more P‑GWs,
the new SGSN shall deactivate the corresponding bearer contexts as described
in clause \"SGSN-initiated PDP Context Deactivation Procedure\" of TS 23.060
[7]. This shall not cause the SGSN to reject the routing area update.
The new SGSN shall determine the Maximum APN restriction based on the received
APN Restriction of each bearer context in the Context Response message and
then store the new Maximum APN restriction value.
The PDP contexts shall be prioritized by the new SGSN. If the new SGSN is
unable to support the same number of active PDP contexts as received from the
old MME, the prioritisation is used to decide which PDP contexts to maintain
active and which ones to delete. In any case, the new SGSN shall first update
all PDP contexts in one or more P‑GWs and then deactivate the PDP context(s)
that it cannot maintain as described in clause \"SGSN-initiated PDP Context
Deactivation Procedure\" of TS 23.060 [7]. This shall not cause the SGSN to
reject the routing area update.
NOTE 5: If the UE was in PMM-CONNECTED state the bearer contexts are sent
already in the Forward Relocation Request message as described in clause
\"Serving RNS relocation procedures\" of TS 23.060 [7].
If the routing area update procedure fails a maximum allowable number of
times, or if the SGSN returns a Routing Area Update Reject (Cause) message,
the UE shall enter PMM DETACHED state.
If the Update Location Ack message indicates a reject, this should be
indicated to the UE, and the UE shall not access non-PS services until a
successful location update is performed.
#### 5.3.3.4 Void
#### 5.3.3.5 Void
#### 5.3.3.6 Routing Area Update with MME interaction and with S‑GW change
The Routing Area Update with S‑GW change procedure takes place when a UE that
is registered with an MME selects a UTRAN or GERAN cell and the S‑GW is
changed by the procedure. In this case, the UE changes to a Routing Area that
the UE has not yet registered with the network. This procedure is initiated by
an ECM-IDLE state UE and may also be initiated if the UE is in ECM-CONNECTED
state. This RA update case is illustrated in Figure 5.3.3.6-1.
NOTE 0: This procedure covers the MME to 2G or 3G SGSN RAU.
Figure 5.3.3.6-1: Routing Area Update with MME interaction and with S‑GW
change
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2]. Steps 8 and 10 concern GTP based S5/S8
1\. The UE selects a UTRAN or GERAN cell. This cell is in a Routing Area that
the UE not yet registered with the network or the UE reselects a UTRAN or
GERAN cell and the TIN indicates \"GUTI\". The UE in ECM‑CONNECTED state may
change to the GERAN cell through Network Assisted Cell Change (NACC).
2a. The UE sends a Routing Area Update Request (old RAI, old P-TMSI, UE Core
Network Capability, P‑TMSI Signature, additional P‑TMSI/RAI, KSI) message to
the new SGSN.
If the UE\'s TIN indicates \"GUTI\" and the UE holds a valid GUTI then the UE
indicates the GUTI as the old P‑TMSI and old RAI. If the UE\'s TIN indicates
\"P‑TMSI\" or \"RAT‑related TMSI\" and the UE holds a valid P‑TMSI and related
RAI then these two elements are indicated as old P‑TMSI and old RAI. Mapping a
GUTI to a P‑TMSI and an RAI is specified in TS 23.003 [9].
If the UE holds a valid P‑TMSI and related RAI and the old P-TMSI and old RAI
indicate a P-TMSI/RAI mapped from a GUTI, then the UE indicates these
parameters as additional P‑TMSI/RAI.
The old P‑TMSI is indicated in the RAU Request message for Iu‑mode only. For
Gb mode the TLLI is derived from the value that is determined as the old
P‑TMSI according to the rules above. The routing parameter that is signalled
in the RRC signalling to the RNC for routing to the SGSN is derived from the
identifier that is signalled as the old P‑TMSI according to the rules above.
For a combined MME/SGSN the RAN is configured to route the NRI(s) of this
combined node to the same combined node. The RAN is also configured to route
NRI(s) of P‑TMSIs that are generated by the UE\'s mapping of the GUTIs
allocated by the combined node. Such a RAN configuration may also be used for
separate nodes to avoid changing nodes in the pool caused by inter RAT
mobility.
If the UE has a follow-on request, i.e. if there is pending uplink traffic
(signalling or data), the 3G-SGSN may use, as an implementation option, the
follow-on request indication to release or keep the Iu connection after the
completion of the RA update procedure.
KSI is mapped from an eKSI identifying a K~ASME~ if the UE indicates a P‑TMSI
mapped from GUTI in the information element \"old P‑TMSI\". KSI identifies a
(CK, IK) pair if the UE indicates a P‑TMSI in the information element \"old
P‑TMSI\".
2b. The RNC shall add the Routing Area Identity before forwarding the message
to the SGSN. This RA identity corresponds to the RAI in the MM system
information sent by the RNC to the UE. The BSS shall add the Cell Global
Identity (CGI) of the cell where the UE is located before passing the message
to the new SGSN.
3\. The new S4 SGSN uses the old RAI received from the UE to derive the old
MME address, and the new S4 SGSN sends a Context Request (P‑TMSI, old RAI, New
SGSN Address, P‑TMSI Signature) message to the old MME to get the context for
the UE. To validate the Context Request the old MME uses a NAS token mapped
from the P-TMSI Signature. If the UE is not known in the old MME, the old MME
responds with an appropriate error cause. If integrity check fails in the old
MME, the old MME responds with an appropriate error cause which should
initiate the security functions in the new S4 SGSN. If the security functions
authenticate the UE correctly, the new S4 SGSN shall send a Context Request
(IMSI, old RAI, New SGSN Address, UE Validated) message to the old MME. UE
Validated indicates that the new S4 SGSN has authenticated the UE. If the new
S4 SGSN indicates that it has authenticated the UE or if the old MME
authenticates the UE, the old MME starts a timer.
> 4\. The old MME responds with a Context Response (MM Context, EPS Bearer
> Contexts, Serving GW signalling Address and TEID(s) , MS Info Change
> Reporting Action (if available)) message. The MM context contains security
> related information as well as other parameters (including IMSI and MSISDN)
> as specified in clause 5.7.2 (Information Storage for MME). The PDN GW
> Address and TEID(s) (for GTP-based S5/S8) or GRE Keys (PMIP-based S5/S8) for
> uplink traffic and control plane, and the TI(s) is part of the EPS Bearer
> context(s). The unused Authentication Quintets in the MM Context may be sent
> if stored by the MME and if the MME received the unused Authentication
> Quintets from the same SGSN previously.
The new SGSN shall ignore the UE Core Network Capability in the MM Context of
the Context Response only when it has previously received an UE Core Network
Capability in the Routing Area Request. If UE is not known in the old MME, the
old MME responds with a appropriate error cause.
The new SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps the EPS
Bearer QoS parameter values of an EPS bearer to the pre-Rel-8 QoS parameter
values of a bearer context as defined in Annex E. The PDP context(s) are
established in the indicated order. The SGSN deactivates the PDP contexts
which cannot be established.
5\. Security functions may be executed. Procedures are defined in clause
5.3.10 on \"Security Function\".
6\. The new SGSN determines to relocate the Serving GW. The Serving GW is
relocated when the old Serving GW cannot continue to serve the UE. The new
SGSN may also decide to relocate the Serving GW if a new Serving GW is
expected to serve the UE longer and/or with a more optimal UE to PDN GW path,
or if a new Serving GW can be co-located with the PDN GW. Selection of a new
Serving GW is performed according to clause 4.3.8.2 on \"Serving GW selection
function\".
The new SGSN sends a Context Acknowledge (Serving GW change indication)
message to the old MME. Serving GW change indication indicates a new Serving
GW has been selected. The old MME marks in its context that the information in
the GWs is invalid. This ensures that the old MME updates the GWs if the UE
initiates a TAU procedure back to the old MME before completing the ongoing
RAU procedure. The old MME deletes all bearer resources of the UE when the
timer started in step 3 expires.
If the security functions do not authenticate the UE correctly, then the RAU
is rejected, and the new S4 SGSN sends a reject indication to the old MME. The
MME shall continue as if the Identification and Context Request was never
received.
7\. In this procedure flow the Serving GW is relocated. The SGSN sends a
Create Session Request (IMSI, bearer contexts, SGSN Address and TEID for the
control plane, RAT Type, Type, the Protocol Type over S5/S8, etc) message per
PDN connection to the selected new Serving GW. The PDN GW address is indicated
in the bearer contexts. Type indicates to the Serving GW to send the Modify
Bearer Request the PDN GW. The Protocol Type over S5/S8 is provided to Serving
GW which protocol should be used over S5/S8 interface. RAT type indicates a
change in radio access. If the PDN GW requested UE\'s location info, the SGSN
also includes the User Location Information IE in this message.
8\. The new Serving GW sends the message Modify Bearer Request (Serving GW
Address, Serving GW TEID, RAT type) per PDN connection to the PDN GW
concerned. User Location Information IE is also included if it is present in
step 7.
9\. If dynamic PCC is deployed, and RAT type information or UE location
information needs to be conveyed from the PDN GW to the PCRF, then the PDN GW
shall send this information to the PCRF by means of an IP-CAN Session
Modification procedure as defined in TS 23.203 [6].
NOTE 2: The PDN GW does not need to wait for the PCRF response, but continues
in the next step. If the PCRF response leads to an EPS bearer modification the
PDN GW should initiate a bearer update procedure.
10\. The PDN GW updates its context field and returns a Modify Bearer Response
(Charging Id, MSISDN) message to the Serving GW. The MSISDN is included if the
PDN GW has it stored in its UE context.
11\. The new Serving GW updates its bearer context. This allows the Serving GW
to route Bearer PDUs to the PDN GW when received from RNC. The new Serving GW
returns a Create Session Response (Serving GW address and TEID, PDN GW Address
and TEIDs (for GTP-based S5/S8) or GRE keys (for PMIP-based S5/S8) at the PDN
GW(s) for uplink traffic) message to the SGSN.
12\. The new SGSN verifies whether it holds subscription data for the UE
identified by the P‑TMSI, the additional P‑TMSI/RAI or by the IMSI received
with the context data from the old CN node. The additional P-TMSI/RAI allows
the new SGSN to find any already existing UE context stored in the new SGSN.
If there are no subscription data in the new SGSN for this UE then the new
SGSN informs the HSS of the change of SGSN by sending an Update Location (SGSN
Number, SGSN Address, IMSI) message to the HSS.
13\. The HSS sends a Cancel Location (IMSI, Cancellation Type) message to the
old SGSN with the Cancellation Type set to Update Procedure.
When receiving the Cancel Location message the old SGSN removes all the UE
contexts. The old SGSN acknowledges with a Cancel Location Ack (IMSI) message.
14\. When receiving the Context Acknowledge message from the new S4 SGSN and
if the old MME has an S1-MME association for the UE, the source MME sends a
S1-U Release Command to the source eNodeB after the timer started in step 3
has expired. The RRC connection is released by the source eNodeB. The source
eNodeB confirms the release of the RRC connection and of the S1-U connection
by sending a S1-U Release Complete message to the source MME.
15\. The HSS acknowledges the Update Location message by sending an Update
Location Ack (IMSI, Subscription Data) to the new SGSN. If the Update Location
is rejected by the HSS, the new SGSN rejects the RAU Request from the UE with
an appropriate cause. The new SGSN validates the UE\'s presence in the (new)
RA. If due to regional subscription restrictions or access restrictions the UE
is not allowed to be attached in the RA, the SGSN rejects the Routing Area
Update Request with an appropriate cause to the UE and notifies the HSS of the
rejection.
16\. When the timer started in step 3 expires and the old MME received the
Serving GW change indication in the Context Acknowledge message, the old MME
deletes the EPS bearer resources by sending Delete Session Request (Cause,
TEID) messages to the old Serving GW. Cause indicates to the old Serving GW
that the old Serving GW shall not initiate a delete procedure towards the PDN
GW. If ISR is activated the cause also indicates to the old S‑GW that the old
S‑GW shall delete the bearer resources on the other old CN node by sending
Delete Bearer Request message(s) to that CN node.
17\. The old Serving GW acknowledges with Delete Session Response (TEID)
messages. The old Serving GW discards any packets buffered for the UE.
18\. The new SGSN responds to the UE with a Routing Area Update Accept
(P-TMSI, P-TMSI Signature) message.
For an S‑GW change ISR Activated is never indicated by the SGSN to the UE as
it needs a TAU with the same S‑GW first to activate ISR. For an SGSN change
ISR is not activated by the new SGSN to avoid context transfer procedures with
two old CN nodes.
When receiving the RAU Accept message, as there is no ISR Activated
indication, the UE shall set its TIN to \"P‑TMSI\".
NOTE 3: When ISR Activated is indicated and the UE\'s TIN indicates \"P‑TMSI\"
the TIN is not changed. When ISR Activated is indicated and the UE\'s TIN
indicates \"GUTI\" or \"RAT‑related TMSI\" the UE shall set its TIN to
\"RAT‑related TMSI\".
19\. If the P-TMSI was included in the RAU Accept message, the UE acknowledges
the new P-TMSI by returning a Routing Area Update Complete message to the
SGSN.
20\. For Iu-mode, if the UE has uplink data or signalling pending it shall
send a Service Request (P-TMSI, CKSN, Service Type) message to the new SGSN.
If a P-TMSI was allocated in step 18, that P-TMSI is the one included in this
message. Service Type specifies the requested service. Service Type shall
indicate one of the following: Data or Signalling.
21\. If the UE has sent the Service Request, the new 3G SGSN requests the RNC
to establish a radio access bearer by sending a RAB Assignment Request (RAB
ID(s), QoS Profile(s), GTP SNDs, GTP SNUs, PDCP SNUs) message to the RNC. If
Direct Tunnel is established the SGSN provides to the RNC the Serving GW\'s
Address for User Plane and TEID for uplink data.
22\. If the SGSN established Direct Tunnel in step 21) it shall send Modify
Bearer Request to the Serving GW and include the RNC\'s Address for User Plane
and downlink TEID for data. The Serving GW updates the Address for User Plane
and TEID for downlink data and return a Modify Bearer Response.
NOTE 4: EPS does not support any CAMEL procedures.
In the case of a rejected routing area update operation, due to regional
subscription, roaming restrictions, access restrictions (see TS 23.221 [27]
and TS 23.008 [28]) or because the SGSN cannot determine the HLR address to
establish the locating updating dialogue, the new SGSN shall not construct an
MM context. A reject shall be returned to the UE with an appropriate cause and
the PS signalling connection shall be released. Upon return to idle, the UE
shall act according to TS 23.122 [10].
If the new SGSN is unable to update the bearer context in one or more P‑GWs,
the new SGSN shall deactivate the corresponding bearer contexts as described
in clause \"SGSN-initiated PDP Context Deactivation Procedure\" of TS 23.060
[7]. This shall not cause the SGSN to reject the routing area update.
The new SGSN shall determine the Maximum APN restriction based on the received
APN Restriction of each bearer context from the P‑GW and then store the new
Maximum APN restriction value.
The PDP contexts shall be prioritized by the new SGSN. If the new SGSN is
unable to support the same number of active PDP contexts as received from old
MME, the prioritisation is used to decide which PDP contexts to maintain
active and which ones to delete. In any case, the new SGSN shall first update
all PDP contexts in one or more P‑GWs and then deactivate the PDP context(s)
that it cannot maintain as described in clause \"SGSN-initiated PDP Context
Deactivation Procedure\" of TS 23.060 [7]. This shall not cause the SGSN to
reject the routing area update.
If the routing area update procedure fails a maximum allowable number of
times, or if the SGSN returns a Routing Area Update Reject (Cause) message,
the MS shall enter IDLE state.
### 5.3.4 Service Request procedures
#### 5.3.4.1 UE triggered Service Request
Figure 5.3.4.1-1: UE triggered Service Request procedure
NOTE: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 9 and 11 concern GTP-based S5/S8.
1\. The UE sends NAS message Service Request towards the MME encapsulated in
an RRC message to the eNodeB. The RRC message(s) that can be used to carry the
S-TMSI and this NAS message are described in TS 36.300 [5].
2\. The eNodeB forwards NAS message to MME. NAS message is encapsulated in an
S1-AP: Initial UE Message (NAS message, TAI+ECGI of the serving cell, S-TMSI).
Details of this step are described in TS 36.300 [5]. If the MME can\'t handle
the Service Request it will reject it.
3\. NAS authentication/security procedures as defined in clause 5.3.10 on
\"Security function\" may be performed.
4\. The MME sends S1-AP Initial Context Setup Request (Serving GW address,
S1-TEID(s) (UL), EPS Bearer QoS(s), Security Context, MME Signalling
Connection Id, Handover Restriction List) message to the eNodeB. This step
activates the radio and S1 bearers for all the active EPS Bearers. The eNodeB
stores the Security Context, MME Signalling Connection Id, EPS Bearer QoS(s)
and S1-TEID(s) in the UE RAN context. The step is described in detail in TS
36.300 [5]. Handover Restriction List is described in clause 4.3.5.7
\"Mobility Restrictions\".
5\. The eNodeB performs the radio bearer establishment procedure. The user
plane security is established at this step, which is described in detail in TS
36.300 [5]. When the user plane radio bearers are setup the Service Request is
completed and EPS bearer state is synchronized between the UE and the network,
i.e. the UE should remove the EPS bearer for which no radio bearers are setup.
6\. The uplink data from the UE can now be forwarded by eNodeB to the Serving
GW. The eNodeB sends the uplink data to the Serving GW address and TEID
provided in the step 4. The Serving GW forwards the uplink data to the PDN GW.
7\. The eNodeB sends an S1-AP message Initial Context Setup Complete (eNodeB
address, List of accepted EPS bearers, List of rejected EPS bearers, S1
TEID(s) (DL)) to the MME. This step is described in detail in TS 36.300 [5].
8\. The MME sends a Modify Bearer Request message (eNodeB address, S1 TEID(s)
(DL) for the accepted EPS bearers, Delay Downlink Packet Notification Request,
RAT Type) per PDN connection to the Serving GW. The Serving GW is now able to
transmit downlink data towards the UE. The usage of the Delay Downlink Packet
Notification Request Information Element is specified in clause 5.3.4.2 below.
If the PDN GW requested UE\'s location info and the UE\'s location info has
changed, the MME also includes the User Location Information IE in this
message.
The MME releases the non-accepted bearers by triggering the bearer release
procedure as specified in clause 5.4.4.2. If the Serving GW receives a DL
packet for a non-accepted bearer, the Serving GW drops the DL packet and does
not send a Downlink Data Notification to the MME.
9\. If the RAT Type has changed compared to the last reported RAT Type or if
the UE\'s Location Info IE is present in step 8, the Serving GW shall send the
Modify Bearer Request message (RAT Type) per PDN connection to the PDN GW.
User Location Information IE is also included if it is present in step 8.
10\. If dynamic PCC is deployed, the PDN GW interacts with the PCRF to get the
PCC rule(s) according to the RAT Type by means of a PCEF initiated IP‑CAN
Session Modification procedure as defined in TS 23.203 [6]. If dynamic PCC is
not deployed, the PDN GW may apply local QoS policy.
11\. The PDN GW sends the Modify Bearer Response to the Serving GW.
12\. The Serving GW sends a Modify Bearer Response to the MME.
#### 5.3.4.2 Handling of abnormal conditions in UE triggered Service Request
Under certain conditions, the current UE triggered Service Request procedure
can cause unnecessary Downlink Packet Notification messages which increase the
load of the MME.
This can occur when uplink data sent in step 6 causes a response on the
downlink which arrives at the Serving GW before the Update Bearer Request
message, step 8. This data cannot be forwarded from the Serving GW to the
eNodeB and hence it triggers a Downlink Data Notification message.
If the MME receives a Downlink Data Notification after step 2 and before step
9, the MME shall not send S1 interface paging messages. However, across all
the UEs on that MME, the MME shall monitor the rate at which these events
occur. If the rate becomes significant (as configured by the operator) and the
MME\'s load exceeds an operator configured value, the MME shall indicate
\"Delay Downlink Packet Notification Request\" with parameter D to the Serving
Gateway, where D is the requested delay given as an integer multiple of 50 ms,
or zero. The Serving GW then uses this delay in between receiving downlink
data and sending the Downlink Data Notification message.
NOTE 1: A low rate of reception of Downlink Data Notifications between steps 2
and 9 should be considered a normal circumstance, e.g. due to the chance that
a UE Terminating call/session is initiated at roughly the same time as the UE
triggered Service Request procedure.
NOTE 2: It is recommended that this rate is determined over 60 second periods.
The MME shall use the step 8, Modify Bearer Request of the UE initiated
Service Request procedure to indicate \"Delay Downlink Packet Notification
Request\" to the Serving GW.
To determine the amount of delay requested by a given MME, the Serving GW
either uses the last Modify Bearer Request message which is part of a Service
Request procedure, or, just uses one of the Service Request procedure\'s
Modify Bearer Request messages received within the preceding 30 seconds. The
latter mode of operation shall be taken into account when implementing the
MME.
The MME is responsible for setting the value of D. The exact algorithm for
setting the value is implementation dependent, two examples are given below to
serve as a guideline:
EXAMPLE 1: The MME adaptively increases the value of D when the rate of
unnecessary Downlink Data Notifications is too high; and correspondingly it
decreases the value when the rate is not too high.
EXAMPLE 2: When unnecessary Downlink Data Notifications arrive, the MME
measures the average time from the reception of the unnecessary Downlink Data
Notification to the reception of the Modify Bearer Response from the Serving
GW in the same UE triggered Service Request Procedure. The value of D is
calculated from this average, by adding a safety margin.
Normally, upon receipt of a downlink data packet for which there is no DL-TEID
of the S1 user plane tunnel, the S‑GW shall send the Downlink Data
Notification message to the MME without delay.
If the S‑GW determines from the last Modify Bearer Request message which is
part of a Service Request procedure that a given MME request delaying of the
Downlink Packet Notification by a delay of D, it shall (only for UEs of that
MME) buffer the Downlink Data for a period D. If the DL-TEID and eNodeB
address for the UE is received before the expiry of the timer, the timer shall
be cancelled and the Network triggered Service Request procedure is finished
without sending the Downlink Data Notification message to the MME, i.e. DL
data are sent to the UE. Otherwise the Downlink Data Notification message is
sent to the MME when the timer expires.
NOTE 3: The above procedure and indicated time values are intended to ensure
that the procedure is \"stable\"; avoids RAN impacts; and, that the negative
impacts of shortening the DRX interval on UE battery life are avoided.
#### 5.3.4.3 Network Triggered Service Request
Figure 5.3.4.3-1: Network triggered Service Request procedure
If the MME needs to signal with the UE that is in ECM-IDLE state, e.g. to
perform the MME/HSS-initiated detach procedure for the ECM-IDLE mode UE or the
S‑GW receives control signalling (e.g. Create Bearer Request or Update Bearer
Request), the MME starts network triggered service request procedure from step
3a in the Network Triggered Service request procedure.If ISR is activated,
when the Serving GW receives a Create Bearer Request or Update Bearer Request
for a UE, and the S‑GW does not have a downlink S1-U and the SGSN has notified
the Serving GW that the UE has moved to PMM-IDLE or STANDBY state, the Serving
GW buffers signalling messages and triggers MME and SGSN to page the UE. In
this case the S‑GW will be notified about the current RAT type based on the UE
triggered service request procedure. The S‑GW will go on executing the
dedicated bearer activation or dedicated bearer modification procedure, i.e.
send the corresponding buffered signalling to MME or SGSN which UE resides in
now and inform the current RAT type to the PDN GW if the RAT type has been
changed compared to the last reported RAT Type. If dynamic PCC is deployed,
the current RAT type information shall also be conveyed from the PDN GW to the
PCRF. If the PCRF response leads to an EPS bearer modification the PDN GW
should initiate a bearer update procedure as specified in clause 5.4.2.1
below.
1\. When the Serving GW receives a downlink data packet for a UE known as not
user plane connected (i.e. the S‑GW context data indicates no downlink user
plane TEID), it buffers the downlink data packet and identifies which MME or
SGSN is serving that UE.
If that MME has requested the S‑GW to delay sending the Downlink Data
Notification (see clause 5.3.4.2 on \"Handling of abnormal conditions in UE
triggered Service Request\"), the Serving GW buffers the downlink data and
waits until the timer expires before continuing with step 2. If the DL-TEID
and eNodeB address for that UE is received before the expiry of the timer, the
timer shall be cancelled and the Network triggered Service Request procedure
is finished without executing the steps below, i.e. DL data are sent to the
UE.
If the Serving GW receives additional downlink data packets for this UE before
the expiry of the timer, the Serving GW does not restart this timer.
2\. The Serving GW sends a Downlink Data Notification message to the MME and
SGSN nodes for which it has control plane connectivity for the given UE. The
MME and SGSN respond to the S‑GW with a Downlink Data Notification Ack
message.
If the Serving GW receives additional downlink data packets for this UE, the
Serving GW buffers these downlink data packets and the Serving GW does not
send a new Downlink Data Notification.
3a. If the UE is registered in the MME, the MME sends a Paging message (NAS ID
for paging, TAI(s), UE identity based DRX index, Paging DRX length) to each
eNodeB belonging to the tracking area(s) in which the UE is registered. The
step is described in detail in TS 36.300 [5] and TS 36.413 [36]. Steps 3-4 are
omitted if the MME already has a signalling connection over S1-MME towards the
UE.
3b. If the UE is registered in the SGSN, the SGSN sends paging messages to
RNC/BSS, which is described in detail in TS 23.060 [7].
4a. If eNodeBs receive paging messages from the MME, the UE is paged by the
eNodeBs. The step is described in detail in TS 36.300 [5] and TS 36.304 [34].
4b. If RNC/BSS nodes receive paging messages from the SGSN the UE is paged by
the RNSC/BSS, which is described in detail in TS 23.060 [7].
5\. When UE is in the ECM-IDLE state, upon reception of paging indication in
E-UTRAN access, the UE initiates the UE triggered Service Request procedure
(clause 5.3.4.1). If the MME already has a signalling connection over S1-MME
towards the UE, then the messages sequence performed start from the step when
MME establishes the bearer(s).
Upon reception of paging indication in UTRAN or GERAN access, the MS shall
respond in respective access as specified TS 24.008 [47] and the SGSN shall
notify the S‑GW.
The MME and/or SGSN supervises the paging procedure with a timer. If the MME
and/or SGSN receives no response from the UE to the Paging Request message, it
may repeat the paging. The repetition strategy is operator dependent.
If the MME and/or SGSN receives no response from the UE after this paging
repetition procedure, it shall use the Downlink Data Notification Reject
message to notify the Serving GW about the paging failure. In that case, if
ISR is not activated, the Serving GW deletes the buffered packet(s). If ISR is
activated and the Serving GW receives paging failure from both SGSN and MME,
the Serving GW deletes the buffered packet(s) or rejects the control
signalling which triggers the Service Request procedure.
6a. If ISR is activated and paging response is received in E‑UTRAN access the
Serving GW sends a \"Stop Paging\" message to the SGSN.
6b. If ISR is activated and paging response is received in UTRAN or GERAN
access the Serving GW sends a \"Stop Paging\" message to the MME.
The Serving GW transmits downlink data towards the UE, via the RAT which
performed the Service Request procedure.
If the network triggered service request fails due to no response from the UE,
then MME and/or SGSN may based on operator policy initiate the Dedicated
Bearer Deactivation procedure for preserved GBR bearers. For detail, see
clause 5.4.4.2 for MME and TS 23.060 [7] for SGSN.
### 5.3.5 S1 release procedure
This procedure is used to release the logical S1-AP signalling connection
(over S1-MME) and all S1 bearers (in S1-U) for a UE. The procedure will move
the UE from ECM-CONNECTED to ECM-IDLE in both the UE and MME, and all UE
related context information is deleted in the eNodeB.
The initiation of S1 Release procedure is either:
\- eNodeB-initiated with cause e.g. O&M Intervention, Unspecified Failure,
User Inactivity, Repeated RRC signalling Integrity Check Failure, Release due
to UE generated signalling connection release, etc.; or
\- MME-initiated with cause e.g. authentication failure, detach, etc.
In case of eNodeB Failure, MME may based on operator policy either preserve
all bearers or initiate the Dedicated Bearer Deactivation procedure for GBR
bearers. See clause 5.4.4.2.
Both eNodeB-initiated and MME-initiated S1 release procedures are shown in
Figure 5.3.5-1.
Figure 5.3.5-1: S1 Release Procedure
1\. If the eNodeB detects a need to release the UE\'s signalling connection
and all radio bearers for the UE, the eNodeB sends an S1 UE Context Release
Request (Cause) message to the MME. Cause indicates the reason for the release
(e.g. O&M intervention, unspecified failure, user inactivity, repeated
integrity checking failure, or release due to UE generated signalling
connection release).
NOTE: Step 1 is only performed when the eNodeB-initiated S1 release procedure
is considered. Step 1 is not performed and the procedure starts with Step 2
when the MME-initiated S1 release procedure is considered.
2\. The MME sends a Release Access Bearers Request message to the S‑GW that
requests the release of all S1-U bearers for the UE. This message is triggered
either by an S1 Release Request message from the eNodeB, or by another MME
event.
3\. The S‑GW releases all eNodeB related information (address and TEIDs) for
the UE and responds with a Release Access Bearers Response message to the MME.
Other elements of the UE\'s S‑GW context are not affected. The S‑GW retains
the S1-U configuration that the S‑GW allocated for the UE\'s bearers. The S‑GW
starts buffering downlink packets received for the UE and initiating the
\"Network Triggered Service Request\" procedure, described in clause 5.3.4.3,
if downlink packets arrive for the UE.
4\. The MME releases S1 by sending the S1 UE Context Release Command (Cause)
message to the eNodeB.
5\. If the RRC connection is not already released, the eNodeB sends a RRC
Connection Release message to the UE in Acknowledged Mode. Once the message is
acknowledged by the UE, the eNodeB deletes the UE\'s context.
6\. The eNodeB confirms the S1 Release by returning an S1 UE Context Release
Complete message to the MME. With this, the signalling connection between the
MME and the eNodeB for that UE is released. This step shall be performed
promptly after step 4, e.g. it shall not be delayed in situations where the UE
does not acknowledge the RRC Connection Release.
The MME deletes any eNodeB related information (address and TEIDs) from the
UE\'s MME context, but, retains the rest of the UE\'s MME context including
the S‑GW\'s S1-U configuration information (address and TEIDs). All non-GBR
EPS bearers established for the UE are preserved in the MME and in the Serving
GW.
If the cause of S1 release is different from User inactivity, e.g. \"Radio
Connection With UE Lost\", the MME shall trigger the MME Initiated Dedicated
Bearer Deactivation procedure (clause 5.4.4.2) for the GBR bearer(s) of the UE
after the S1 Release procedure is completed.
If the cause of S1 release is because of UE inactivity, the MME shall preserve
the GBR bearers.
NOTE: EPC does not support the GPRS preservation feature with setting the MBR
for GBR bearers to zero.
### 5.3.6 Void
### 5.3.7 GUTI Reallocation procedure
The MME may initiate the GUTI Reallocation procedure to reallocate the GUTI
and/or TAI list at any time when a signalling association is established
between UE and MME. The GUTI Reallocation procedure allocates a new GUTI
and/or a new TAI list to the UE. The GUTI and/or the TAI list may also be
reallocated by the Attach or the Tracking Area Update procedures.
The GUTI Reallocation procedure is illustrated in Figure 5.3.7-1.
{width="4.553472222222222in" height="2.125in"}
Figure 5.3.7-1: GUTI Reallocation Procedure
1\. The MME sends GUTI Reallocation Command (GUTI, TAI list) to the UE.
2\. The UE returns GUTI Reallocation Complete message to the MME.
### 5.3.8 Detach procedure
#### 5.3.8.1 General
The Detach procedure allows:
\- the UE to inform the network that it does not want to access the EPS any
longer, and
\- the network to inform the UE that it does not have access to the EPS any
longer.
The UE is detached either explicitly or implicitly:
\- Explicit detach: The network or the UE explicitly requests detach and
signal with each other.
\- Implicit detach: The network detaches the UE, without notifying the UE.
This is typically the case when the network presumes that it is not able to
communicate with the UE, e.g. due to radio conditions.
Four detach procedures are provided when the UE accesses the EPS through
E-UTRAN. The first detach procedure is UE-initiated detach procedure and other
detach procedures are network-initiated detach procedure:
\- UE-Initiated Detach Procedure. In the ISR activated case the UE initiated
detach is split into to sub procedures, one for UE camping on E-UTRAN and one
for UE camping on GERAN/UTRAN;
\- MME-Initiated Detach Procedure;
\- SGSN-Initiated Detach procedure with ISR activated;
\- HSS-Initiated Detach Procedure.
NOTE 1: The MME and the UE may enter EMM-DEREGISTERED state without the above
procedures.
When the Detach procedure is initiated by the network, the MME and/or the SGSN
may not be in radio contact with the UE and therefore the User Location
Information signalled to the PDN GW may be the last known location of the UE
stored by the MME or the SGSN. In this release of the specification it is not
possible for the MME or the SGSN to signal to the PDN GW the time when the
User Location Information was acquired.
#### 5.3.8.2 UE-initiated Detach procedure
The Detach procedure when initiated by the UE is described in clauses
5.3.8.2.1 and 5.3.8.2.2.
##### 5.3.8.2.1 UE-initiated Detach procedure for E-UTRAN
Figure 5.3.8.2-1 shows the case when UE camps on E-UTRAN and Detach Request is
sent to MME.
Figure 5.3.8.2-1: UE-Initiated Detach Procedure - UE camping on E-UTRAN
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 6, 7 and 8 concern GTP based S5/S8
1\. The UE sends NAS message Detach Request (GUTI, Switch Off) to the MME.
This NAS message is used to trigger the establishment of the S1 connection if
the UE was in ECM-IDLE mode. Switch Off indicates whether detach is due to a
switch off situation or not. The eNodeB forwards this NAS message to the MME
along with the TAI+ECGI of the cell which the UE is using.
NOTE 2: Security procedures may be invoked if the NAS message is used to
establish the S1 connection.
2\. The active EPS Bearers in the Serving GW regarding this particular UE are
deactivated by the MME sending Delete Session Request (TEID) per PDN
connection to the Serving GW. If ISR is activated, then the Serving GW shall
not release the Control Plane TEID allocated for MME/SGSN until it receives
the Delete Session Request message in step 5. If the PDN GW requested UE\'s
location info, the MME also includes the User Location Information IE in this
message.
3\. When the S‑GW receives the first Delete Session Request message from the
MME or SGSN in ISR activated state, the Serving GW deactivates ISR, releases
the related EPS Bearer context information and responds with Delete Session
Response (TEID).
When the S‑GW receives the Delete Session Request message from the MME or SGSN
in ISR deactivated state, the Serving GW releases the related EPS Bearer
context information and jumps to step 6 by sending a Delete Session Request
(TEID) message per PDN connection to the PDN GW. After step 7 the Serving GW
responds back to the MME/SGSN with the Delete Session Response (TEID) message.
4\. If ISR is activated, MME sends Detach Notification (Cause) message to the
associated SGSN. The Cause indicates complete detach.
5\. The active PDP contexts in the Serving GW regarding this particular UE are
deactivated by the SGSN sending Delete Session Request (TEID) per PDN
connection to the Serving GW. If the PDN GW requested UE\'s location info, the
SGSN also includes the User Location Information IE in this message.
6\. If ISR is activated, Serving GW deactivates ISR. If ISR is not activated
in the Serving GW, the Serving GW sends Delete Session Request (TEID) per PDN
connection to the PDN GW. If ISR is not activated, this step shall be
triggered by step 2. This message includes an indication that all bearers
belonging to that PDN connection shall be released. If the MME and/or SGSN
sends UE\'s Location Information in step 2 and/or step 5, it is an
implementation specific behaviour on the S-GW to decide which of the received
User Location Information to forward to the PDN GW.
7\. The PDN GW acknowledges with Delete Bearer Response (TEID).
8\. The PDN GW employs a PCEF initiated IP‑CAN Session Termination Procedure
as defined in TS 23.203 [6] with the PCRF to indicate to the PCRF that EPS
Bearer is released if PCRF is applied in the network.
9\. The Serving GW acknowledges with Delete Session Response (TEID).
10\. The SGSN sends Detach Acknowledge message to the MME.
11\. If Switch Off indicates that detach is not due to a switch off situation,
the MME sends a Detach Accept to the UE.
12\. The MME releases the S1-MME signalling connection for the UE by sending
S1 Release Command to the eNodeB with Cause set to Detach. The details of this
step are covered in the \"S1 Release Procedure\", as described in clause
5.3.5.
##### 5.3.8.2.2 UE-initiated Detach procedure for GERAN/UTRAN with ISR
activated
Figure 5.3.8.2-2 shows the case when UE with ISR Activated camps on
GERAN/UTRAN and Detach Request is sent to SGSN. Refer to clause 6.6.1 of TS
23.060 [7] for the UE-initiated Detach procedure when ISR is not activated.
Figure 5.3.8.2-2: UE-Initiated Detach Procedure - UE camping on GERAN/UTRAN,
ISR activated
1\. The UE sends NAS message Detach Request (Detach Type, P‑TMSI,
P‑TMSI‑Signature, Switch Off) to the SGSN. Detach Type indicates which type of
detach is to be performed, i.e. GPRS Detach only, IMSI Detach only or combined
GPRS and IMSI Detach. Switch Off indicates whether detach is due to a switch
off situation or not. The Detach Request message includes P‑TMSI and P‑TMSI
Signature. P‑TMSI Signature is used to check the validity of the Detach
Request message. If P‑TMSI Signature is not valid or is not included, the
authentication procedure should be performed.
2\. The active EPS Bearers in the Serving GW regarding this particular UE are
deactivated by the SGSN sending Delete Session Request (TEID) per PDN
connection to the Serving GW. Because ISR is activated, then the Serving GW
shall not release the Control Plan TEID allocated for MME/SGSN until it
receives the Delete Session Request message in step 5. If the PDN GW requested
UE\'s location info, the SGSN also includes the User Location Information IE
in this message.
3\. Because the Serving GW receives this message in ISR activated state, the
Serving GW deactivates ISR and acknowledges with Delete Session Response
(TEID).
4\. Because ISR is activated, the SGSN sends Detach Notification (Cause)
message to the associated MME. Cause indicates complete detach.
5\. The active PDP contexts in the Serving GW regarding this particular UE are
deactivated by the MME sending Delete Session Request (TEID) per PDN
connection to the Serving GW. If the PDN GW requested UE\'s location info, the
MME also includes the User Location Information IE in this message.
6\. Serving GW deactivates ISR and sends Delete Session Request (TEID) per PDN
connection to the PDN GW. If ISR is not activated, this step shall be
triggered by step 2. This message includes an indication that all bearers
belonging to that PDN connection shall be released. If the MME and/or SGSN
sends UE\'s Location Information in step 2 and/or step 5, it is an
implementation specific behaviour on the S-GW to decide which of the received
User Location Information to forward to the PDN GW.
7\. The PDN GW acknowledges with Delete Session Response (TEID).
8\. The PDN GW employs a PCEF initiated IP CAN Session Termination Procedure
as defined in TS 23.203 [6] with the PCRF to indicate to the PCRF that EPS
Bearer is released if PCRF is applied in the network.
9\. The Serving GW acknowledges with Delete Session Response (TEID).
10\. The MME sends Detach Acknowledge message to the SGSN.
11\. If Switch Off indicates that detach is not due to a switch off situation,
the SGSN sends a Detach Accept to the UE.
12\. If the MS was GPRS detached, then the 3G SGSN releases the PS signalling
connection.
#### 5.3.8.3 MME-initiated Detach procedure
The MME-Initiated Detach procedure when initiated by the MME is illustrated in
Figure 5.3.8.3-1.
Figure 5.3.8.3-1: MME-Initiated Detach Procedure
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 3, 4 and 5 concern GTP based S5/S8.
NOTE 2: Procedure steps (B) are used by the procedure steps (E) in clause
5.3.2.1.
1\. The MME initiated detach procedure is either explicit (e.g. by O&M
intervention) or implicit. The MME may implicitly detach a UE, if it has not
had communication with UE for a long period of time. The MME does not send the
Detach Request (Detach Type) message to the UE for implicit detach. The
implicit detach is local to the MME, i.e. an SGSN registration will not be
detached. If the UE is in ECM-CONNNECTED state the MME may explicitly detach
the UE by sending a Detach Request message to the UE. The Detach Type may be
set to re-attach in which case the UE should re-attach at the end of the
detach process. If the UE is in ECM-IDLE state the MME pages the UE.
2\. Any EPS Bearer Context information in the Serving GW regarding this
particular UE and related to the MME are deactivated by the MME sending Delete
Session Request (TEID) message per PDN connection to the Serving GW. If the
PDN GW requested UE\'s location info, the MME also includes the User Location
Information IE in this message.
3\. When the S‑GW receives the first Delete Session Request message from the
MME or SGSN in ISR activated state, the Serving GW deactivates ISR, releases
the related EPS Bearer context information and responds with Delete Session
Response (TEID).
When the S‑GW receives the Delete Session Request message from the MME or SGSN
in ISR deactivated state, the Serving GW releases the related EPS Bearer
context information and jumps to step 6 by sending a Delete Session Request
(TEID) message to the PDN GW. After step 7 the Serving GW responds back to the
MME/SGSN with the Delete Session Response (TEID) message.
4\. If ISR is activated, MME sends Detach Notification (Cause) message to the
associated SGSN. The cause indicates whether it is a local or complete detach.
5\. If cause indicates complete detach then the SGSN sends a Delete Session
Request (TEID) message per PDN connection to the Serving GW. If Cause
indicates local detach then SGSN deactivates ISR and steps 5 to 9 shall be
skipped. If the PDN GW requested UE\'s location info, the SGSN also includes
the User Location Information IE in this message.
6\. If ISR is activated, Serving GW deactivates ISR.
If ISR is not activated and the Serving GW received one or several Delete
Session Request message(s) from SGSN in step 2, the Serving GW sends a Delete
Session Request (TEID) message for each associated PDN connection to the PDN
GW. This message includes an indication that all bearers belonging to that PDN
connection shall be released.
If the MME and/or SGSN send(s) UE\'s Location Information in step 2 and/or
Step 5, it is an implementation specific behaviour on S-GW to decide which of
the received User Location Information to forward to the PDN GW.
7\. The PDN GW acknowledges with Delete Bearer Response (TEID) message.
8\. The PDN GW employs an IP‑CAN Session Termination procedure as defined in
TS 23.203 [6] with the PCRF to indicate to the PCRF that the EPS Bearer(s) are
released if a PCRF is configured.
9\. The Serving GW acknowledges with Delete Session Response (TEID) message.
10\. The SGSN sends Detach Acknowledge message to the MME.
11\. If the UE receives the Detach Request message from the MME in the step 1,
the UE sends a Detach Accept message to the MME any time after step 1. The
eNodeB forwards this NAS message to the MME along with the TAI+ECGI of the
cell which the UE is using.
12\. After receiving the Detach Accept message, Delete Session Response and,
if appropriate, Detach Acknowledge message, the MME releases the S1-MME
signalling connection for the UE by sending an S1 Release Command (Cause)
message to the eNodeB. The details of this step are covered in the \"S1
Release Procedure\", as described in clause 5.3.5 by step 4 to step 6. If the
Detach Type requests the UE to make a new attach, the UE reattaches after the
RRC Connection Release is completed.
#### 5.3.8.3A SGSN-initiated Detach procedure with ISR activated
The SGSN-Initiated Detach procedure with ISR activated is illustrated in
Figure 5.3.8.3A-1. Refer to clause 6.6.2.1 of TS 23.060 [7] for the SGSN-
initiated Detach procedure when ISR is not activated.
Figure 5.3.8.3A-1: SGSN-Initiated Detach Procedure with ISR activated
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 3, 4 and 5 concern GTP based S5/S8.
1\. The SGSN initiated detach procedure is either explicit (e.g. by O&M
intervention) or implicit. The SGSN may implicitly detach a UE, if it has not
had communication with UE for a long period of time. The SGSN does not send
the Detach Request (Detach Type) message to the UE for implicit detach. The
implicit detach is local to the SGSN, i.e. an MME registration will not be
detached. If the UE is in PMM-CONNNECTED state the SGSN may explicitly detach
the UE by sending a Detach Request message to the UE. The Detach Type may be
set to re-attach in which case the UE should re-attach at the end of the
detach process. If the UE is in PMM-IDLE state the SGSN pages the UE.
2\. Any EPS Bearer Context information in the Serving GW regarding this
particular UE and related to the SGSN is deactivated by the SGSN sending
Delete Session Request (TEID) message per PDN connection to the Serving GW. If
the PDN GW requested UE\'s location info, the SGSN also includes the User
Location Information IE in this message.
3\. Because the Serving GW receives this message in ISR activated state, the
Serving GW deactivates ISR, releases the SGSN related EPS Bearer context
information and acknowledges with Delete Session Response (TEID).
4\. Because ISR is activated, the SGSN sends Detach Notification (Cause)
message to the associated MME. The cause indicates whether it is a local or
complete detach.
5\. If cause indicates complete detach then the MME sends a Delete Session
Request (TEID) message per PDN connection to the Serving GW. If Cause
indicates local detach then MME deactivates ISR and steps 5 to 9 shall be
skipped. If the PDN GW requested UE\'s location info, the MME also includes
the User Location Information IE in this message.
6\. The Serving GW sends a Delete Session Request (TEID) message per PDN
connection to the PDN GW. This message includes an indication that all bearers
belonging to that PDN connection shall be released. If the MME and/or SGSN
sends UE\'s Location Information in step 2 and/or step 5, it is an
implementation specific behaviour on S-GW to decide which of the received User
Location Information to forward to the PDN GW.
7\. The PDN GW acknowledges with Delete Session Response (TEID) message.
8\. The PDN GW employs an IP CAN Session Termination procedure as defined in
TS 23.203 [6] with the PCRF to indicate to the PCRF that the EPS Bearer(s) are
released if a PCRF is configured.
9\. The Serving GW acknowledges with Delete Session Response (TEID) message.
10\. The MME sends Detach Acknowledge message to the SGSN.
11\. If the UE receives the Detach Request message from the SGSN in the step
1, the UE sends a Detach Accept message to the SGSN any time after step 1.
12\. After receiving the Detach Accept message, if Detach Type did not request
the UE to make a new attach, then the 3G SGSN releases the PS signalling
connection.
#### 5.3.8.4 HSS-initiated Detach procedure
The HSS-Initiated Detach procedure is initiated by the HSS. The HSS uses this
procedure for operator-determined purposes to request the removal of a
subscriber\'s MM and EPS bearer at the MME and also at the SGSN if both an MME
and an SGSN are registered in the HSS.
For subscription change, e.g. RAT restrictions to disallow one of the RATs,
the Insert Subscription Data procedure shall be used towards the MME, and also
towards the SGSN if both an MME and an SGSN are registered in the HSS.
This procedure is not applied if a Cancel Location is sent to the MME or the
SGSN with a cause other than Subscription Withdrawn.
The HSS-Initiated Detach Procedure is illustrated in Figure 5.3.8.4-1.
Figure 5.3.8.4-1: HSS-Initiated Detach Procedure
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 4, 5 and 6 concern GTP based S5/S8.
NOTE 2: Procedure steps (B) are used by the procedure steps (F) in clause
5.3.2.1.
NOTE 3: The steps below apply for an S4-SGSN. For Gn/Gp SGSN, the procedure
specified in clause 6.6.2.2. of TS 23.060 [7] applies for the SGSN.
1\. If the HSS wants to request the immediate deletion of a subscriber\'s MM
contexts and EPS Bearers, the HSS shall send a Cancel Location (IMSI,
Cancellation Type) message with Cancellation Type set to Subscription
Withdrawn to the registered MME and also to the SGSN if an SGSN is also
registered.
2\. If Cancellation Type is Subscription Withdrawn, the MME/SGSN which has an
active UE context informs the UE which is in ECM-CONNECTED state, that it has
been detached, by sending Detach Request message to the UE. If the UE is in
ECM-IDLE state the MME pages the UE.
NOTE 4: The UE will receive only one Detach Request message in the RAT where
it currently camps on.
3a. If the MME has an active UE context, the MME sends a Delete Session
Request (TEID) message per PDN connection to the Serving GW to deactivate the
EPS Bearer Context information in the Serving GW.
3b. If the SGSN has an active UE context, the SGSN sends a Delete Session
request (TEID) per PDN connection to the Serving GW to deactivate the EPS
Bearer Context information in the Serving GW.
4\. When the S‑GW receives the first Delete Session Request message from the
MME or SGSN in ISR activated state, the Serving GW deactivates ISR, releases
the related EPS Bearer context information and responds with Delete Session
Response in step 7.
When the S‑GW receives one or several Delete Session Request message(s) from
the MME or SGSN in ISR deactivated state, the Serving GW releases the related
EPS Bearer context information and sends a Delete Session Request (TEID)
message for each associated PDN connection to the PDN GW. This message
includes an indication that all bearers belonging to that PDN connection shall
be released.
If the MME and/or the SGSN sends UE\'s Location Information in step 3a and/or
step 3b, it is an implementation specific behaviour on S-GW to decide which of
the received User Location Information to forward to the PDN GW.
5\. The PDN GW acknowledges with Delete Session Response (TEID) message.
6\. The PDN GW employs a PCEF initiated IP‑CAN Session Termination procedure
as defined in TS 23.203 [6] with the PCRF to indicate to the PCRF that the EPS
bearer is released if a PCRF is configured.
7\. The Serving GW acknowledges with Delete Session Response (TEID) message.
8\. If the UE receives the Detach Request message from the MME/SGSN, the UE
sends a Detach Accept message to the MME/SGSN any time after step 2. The
message is sent either in E-UTRAN or GERAN/UTRAN access depending on which
access the UE received the Detach Request. For the Detach Accept message from
UE to MME the eNodeB forwards this NAS message to the MME along with the
TAI+ECGI of the cell which the UE is using.
9\. The MME/SGSN confirms the deletion of the MM contexts and the EPS
Bearer(s) with a Cancel Location Ack (IMSI) message to the HSS.
10a. After receiving the Detach Accept message, the MME releases the S1-MME
signalling connection for the UE by sending S1 Release Command (Cause) message
to the eNodeB with Cause set to Detach. The details of this step are covered
in the \"S1 Release Procedure\", as described in clause 5.3.5.
10b. After receiving the Detach Accept message, if Detach Type did not request
the UE to make a new attach, then the 3G SGSN releases the PS signalling
connection
### 5.3.9 HSS User Profile management function procedure
#### 5.3.9.1 General
The HSS user profile management function allows the HSS to update the HSS user
profile stored in the MME. Whenever the HSS user profile is changed for a user
in the HSS, and the changes affect the HSS user profile stored in the MME, the
MME shall be informed about these changes by the means of the following
procedure:
\- Insert Subscriber Data procedure, used to add or modify the HSS user
profile in the MME.
#### 5.3.9.2 Insert Subscriber Data procedure
The Insert Subscriber Data procedure is illustrated in Figure 5.3.9.2-1.
Figure 5.3.9.2-1: Insert Subscriber Data procedure
1\. The HSS sends an Insert Subscriber Data (IMSI, Subscription Data) message
to the MME.
2\. The MME updates the stored Subscription Data and acknowledges the Insert
Subscriber Data message by returning an Insert Subscriber Data Ack (IMSI)
message to the HSS. The update result should be contained in the Ack message.
The MME initiates appropriate action according to the changed subscriber data
(e.g. MME initiates detach if the UE is not allowed to roam in this network).
For received PDN subscription contexts that have no related active PDN
connection in the MME, no further action is required except storage in the
MME. Otherwise if the subscribed QoS Profile has been modified and the UE is
in ECM‑CONNECTED state or in ECM-IDLE state when ISR is not activated, the HSS
Initiated Subscribed QoS Modification procedure, as described in Figure
5.4.2.2-1, is invoked from step 2a. If the UE is in ECM‑IDLE state and the ISR
is activated, this procedure is invoked at the next ECM‑IDLE to ECM‑CONNECTED
transition. If the UE is in ECM‑IDLE state and the ISR is not activated and if
the subscription change no longer allows the PDN connection, the MME initiated
PDN disconnection procedure in clause 5.10.3 is used to delete the concerned
PDN connection.
#### 5.3.9.3 Purge function
The Purge function allows an MME to inform the HSS that it has deleted the
subscription data and MM context of a detached MS. The MME may, as an
implementation option, delete the subscription data and MM context of an UE
immediately after the implicit or explicit detach of the UE. Alternatively the
MME may keep for some time the subscription data and the MM context of the
detached UE, so that the data can be reused at a later attach without
accessing the HSS.
{width="3.604861111111111in" height="1.3847222222222222in"}
Figure 5.3.9.3-1: Purge Procedure
1\. After deleting the Subscription data and MM contexts of a detached UE, the
MME sends Purge UE (IMSI) message to the HSS.
2\. The HSS sets the UE Purged for E-UTRAN flag and acknowledges with a Purge
UE Ack message.
### 5.3.10 Security Function
#### 5.3.10.1 General
The security functions include:
The security functions include:
\- Guards against unauthorised EPS service usage (authentication of the UE by
the network and service request validation).
\- Provision of user identity confidentiality (temporary identification and
ciphering).
\- Provision of user data and signalling confidentiality (ciphering).
\- Provision of origin authentication of signalling data (integrity
protection).
\- Authentication of the network by the UE.
Security-related network functions for EPS are described in TS 33.401 [41].
#### 5.3.10.2 Authentication and Key Agreement
EPS AKA is the authentication and key agreement procedure that shall be used
over E-UTRAN, between the UE and MME. EPS AKA is specified in TS 33.401 [41].
#### 5.3.10.3 User Identity Confidentiality
An M-TMSI identifies a user between the UE and the MME. The relationship
between M-TMSI and IMSI is known only in the UE and in the MME.
#### 5.3.10.4 User Data and Signalling Confidentiality
There are two different levels of the security associations between the UE and
the network.
i) RRC and UP security association is between the UE and E‑UTRAN. The RRC
security associations protect the RRC signalling between the UE and E‑UTRAN
(integrity protection and ciphering). The UP security association is also
between the UE and E‑UTRAN and provide user plane encryption function.
ii) NAS security association is between the UE and the MME. It provides
integrity protection and encryption of NAS signalling.
##### 5.3.10.4.1 AS security mode command procedure
The MME triggers the RRC level AS security mode command procedure by sending
the needed security parameters to the eNodeB. This enables ciphering of the UP
traffic and ciphering and integrity protection of the RRC signalling as
described in TS 33.401 [41].
##### 5.3.10.4.2 NAS Security Mode Command procedure
The MME uses the NAS Security Mode Command (SMC) procedure to establish a NAS
security association between the UE and MME, in order to protect the further
NAS signalling messages. This procedure is also used to make changes in the
security association, e.g. to change the security algorithm.
Figure 5.3.10.4.2-1: NAS Security Mode Command Procedure
1\. The MME sends NAS Security Mode Command (Selected NAS algorithms, eKSI, ME
Identity request, UE Security Capability) message to the UE. ME identity
request may be included when NAS SMC is combined with ME Identity retrieval
(see clause 5.3.10.5).
2\. The UE responds NAS with Security Mode Complete (NAS-MAC, ME Identity)
message. The UE includes the ME Identity if it was requested in step 1.
NOTE: The NAS Security Mode Command procedure is typically executed as part of
the Attach procedure (see clause 5.3.2.1) in advance of, or in combination
with, executing the ME Identity Check procedure (see clause 5.3.10.5) and in
the TAU procedure (see clauses 5.3.3.1 and 5.3.3.2).
More details of the procedure are described in TS 33.401 [41].
#### 5.3.10.5 ME identity check procedure
The Mobile Equipment Identity Check Procedure permits the operator(s) of the
MME and/or the HSS and/or the PDN GW to check the Mobile Equipment\'s identity
(e.g. to check that it has not been stolen, or, to verify that it does not
have faults).
The ME Identity can be checked by the MME passing it to an Equipment Identity
Register (EIR) and then the MME analysing the response from the EIR in order
to determine its subsequent actions (e.g. sending an Attach Reject if the EIR
indicates that the Mobile Equipment is blacklisted).
The ME identity check procedure is illustrated in Figure 5.3.10.5-1.
Figure 5.3.10.5-1: Identity Check Procedure
1\. The MME sends Identity Request (Identity Type) to the UE. The UE responds
with Identity Response (Mobile Identity).
2\. If the MME is configured to check the IMEI against the EIR, it sends ME
Identity Check (ME Identity, IMSI) to EIR. The EIR responds with ME Identity
Check Ack (Result).
NOTE: The Identity Check Procedure is typically executed as part of the Attach
procedure (see clause 5.3.2.1).
For roaming situations, in order to permit the HPLMN operator to check the ME
Identity, the VPLMN shall obtain the ME identity at Initial Attach when
Request Type does not indicate handover, and, at Tracking Area Update from
UTRAN/GERAN if the old SGSN does not provide the ME Identity. In order to
minimise signalling delays during these procedures, the MME should obtain the
ME Identity in the NAS Security Mode Complete message during the EPC
Authentication and Ciphering procedure as defined in clause 5.3.10.4.2. More
details are described in TS 33.401 [41].
At Initial Attach when Request Type does not indicate handover, the MME
includes the ME Identity in the Update Location message to the HSS.
NOTE: The mechanisms by which the HSS and/or PDN GW check the ME Identity are
not standardised in this release of the 3GPP specifications.
### 5.3.11 UE Reachability procedures
#### 5.3.11.1 General
There are two procedures necessary for any service related entity that would
need to be notified by the reachability of the UE at EPC NAS level:
\- UE Reachability Notification Request procedure; and
\- UE Activity Notification procedure.
#### 5.3.11.2 UE Reachability Notification Request procedure
The UE Reachability Notification Request procedure is illustrated in Figure
5.3.11.2-1.
Figure 5.3.11.2-1: UE Reachability Notification Request Procedure
1) If a service-related entity requests the HSS to provide an indication
regarding UE reachability on EPS, the HSS stores the service-related entity
and sets the URRP-MME parameter to indicate that such request is received. If
the value of URRP-MME parameter has changed from \"not set\" to \"set\", the
HSS sends a UE-REACHABILITY-NOTIFICATION-REQUEST (URRP-MME) to the MME. If the
MME has an MM context for that user, the MME sets URRP-MME to indicate the
need to report to the HSS information regarding changes in UE reachability,
e.g. when the next NAS activity with that UE is detected.
#### 5.3.11.3 UE Activity Notification procedure
The UE Activity Notification procedure is illustrated in Figure 5.3.11.3-1.
Figure 5.3.11.3-1: UE Activity Procedure
1) The MME receives an indication regarding UE reachability, e.g. an Attach
Request message from the UE or MME receive an indication from S‑GW that UE has
handed over to non-3GPP coverage.
2) If the MME contains an MM context of the UE and if URRP-MME for that UE is
configured to report once that the UE is reachable, the MME shall send a UE-
Activity-Notification (IMSI, UE-Reachable) message to the HSS and clears the
corresponding URRP-MME for that UE.
3) When the HSS receives the UE-Activity-Notification (IMSI, UE-Reachable)
message or the Update Location message for an UE that has URRP-MME set, it
triggers appropriate notifications to the entities that have subscribed to the
HSS for this notification and clears the URRP-MME for that UE.
## 5.4 Session Management, QoS and interaction with PCC functionality
### 5.4.1 Dedicated bearer activation
The dedicated bearer activation procedure for a GTP based S5/S8 is depicted in
figure 5.4.1-1.
Figure 5.4.1-1: Dedicated Bearer Activation Procedure
NOTE 1: Steps 3-10 are common for architecture variants with GTP based S5/S8
and PMIP-based S5/S8. For an PMIP-based S5/S8, procedure steps (A) and (B) are
defined in TS 23.402 [2]. Steps 1, 2, 11 and 12 concern GTP based S5/S8.
1\. If dynamic PCC is deployed, the PCRF sends a PCC decision provision (QoS
policy) message to the PDN GW. This corresponds to the initial steps of the
PCRF-Initiated IP‑CAN Session Modification procedure or to the PCRF response
in the PCEF initiated IP-CAN Session Modification procedure as defined in TS
23.203 [6], up to the point that the PDN GW requests IP‑CAN Bearer Signalling.
If dynamic PCC is not deployed, the PDN GW may apply local QoS policy.
2\. The PDN GW uses this QoS policy to assign the EPS Bearer QoS, i.e., it
assigns the values to the bearer level QoS parameters QCI, ARP, GBR and MBR;
see clause 4.7.3. The PDN GW sends a Create Bearer Request message (IMSI, PTI,
EPS Bearer QoS, TFT, S5/S8 TEID, Charging Id, LBI, Protocol Configuration
Options) to the Serving GW, the Linked EPS Bearer Identity (LBI) is the EPS
Bearer Identity of the default bearer. The Procedure Transaction Id (PTI)
parameter is only used when the procedure was initiated by a UE Requested
Bearer Resource Modification Procedure - see clause 5.4.5. Protocol
Configuration Options may be used to transfer application level parameters
between the UE and the PDN GW (see TS 23.228 [52]), and are sent transparently
through the MME and the Serving GW.
NOTE: The PCO is sent in the dedicated bearer activation procedure either in
response to a PCO received from the UE, or without the need to send a response
to a UE provided PCO e.g. when the network wants the bearer to be dedicated
for IMS signalling.
3\. The Serving GW sends the Create Bearer Request (IMSI, PTI, EPS Bearer QoS,
TFT, S1-TEID, LBI, Protocol Configuration Options) message to the MME. If the
UE is in ECM-IDLE state the MME will trigger the Network Triggered Service
Request from step 3 (which is specified in clause 5.3.4.3). In that case the
following steps 4-7 may be combined into Network Triggered Service Request
procedure or be performed standalone.
4\. The MME selects an EPS Bearer Identity, which has not yet been assigned to
the UE. The MME then builds a Session Management Request including the PTI,
TFT, EPS Bearer QoS parameters (excluding ARP), Protocol Configuration
Options, the EPS Bearer Identity and the Linked EPS Bearer Identity (LBI). If
the UE has UTRAN or GERAN capabilities, the MME uses the EPS bearer QoS
parameters to derive the corresponding PDP context parameters QoS Negotiated
(R99 QoS profile), Radio Priority, Packet Flow Id and TI and includes them in
the Session Management Request. If the UE indicated in the UE Network
Capability it does not support BSS packet flow procedures, then the MME shall
not include the Packet Flow Id. The MME then signals the Bearer Setup Request
(EPS Bearer Identity, EPS Bearer QoS, Session Management Request, S1-TEID)
message to the eNodeB.
5\. The eNodeB maps the EPS Bearer QoS to the Radio Bearer QoS. It then
signals a RRC Connection Reconfiguration (Radio Bearer QoS, Session Management
Request, EPS RB Identity) message to the UE. The UE shall store the QoS
Negotiated, Radio Priority, Packet Flow Id and TI, which it received in the
Session Management Request, for use when accessing via GERAN or UTRAN. The UE
NAS stores the EPS Bearer Identity and links the dedicated bearer to the
default bearer indicated by the Linked EPS Bearer Identity (LBI). The UE uses
the uplink packet filter (UL TFT) to determine the mapping of traffic flows to
the radio bearer. The UE may provide the EPS Bearer QoS parameters to the
application handling the traffic flow. The application usage of the EPS Bearer
QoS is implementation dependent. The UE shall not reject the RRC Connection
Reconfiguration on the basis of the EPS Bearer QoS parameters contained in the
Session Management Request.
NOTE 2: The details of the Radio Bearer QoS are specified in TS 36.300 [5].
6\. The UE acknowledges the radio bearer activation to the eNodeB with a RRC
Connection Reconfiguration Complete message.
7\. The eNodeB acknowledges the bearer activation to the MME with a Bearer
Setup Response (EPS Bearer Identity, S1-TEID) message. The eNodeB indicates
whether the requested EPS Bearer QoS could be allocated or not.
8\. The UE NAS layer builds a Session Management Response including EPS Bearer
Identity. The UE then sends a Direct Transfer (Session Management Response)
message to the eNodeB.
9\. The eNodeB sends an Uplink NAS Transport (Session Management Response)
message to the MME.
10\. Upon reception of the Bearer Setup Response message in step 7 and the
Session Management Response message in step 9, the MME acknowledges the bearer
activation to the Serving GW by sending a Create Bearer Response (EPS Bearer
Identity, S1-TEID) message.
11\. The Serving GW acknowledges the bearer activation to the PDN GW by
sending a Create Bearer Response (EPS Bearer Identity, S5/S8-TEID) message.
12\. If the dedicated bearer activation procedure was triggered by a PCC
Decision Provision message from the PCRF, the PDN GW indicates to the PCRF
whether the requested PCC decision (QoS policy) could be enforced or not,
allowing the completion of the PCRF-Initiated IP‑CAN Session Modification
procedure or the PCEF initiated IP-CAN Session Modification procedure as
defined in TS 23.203 [6], after the completion of IP‑CAN bearer signalling.
NOTE 3: The exact signalling of step 1 and 12 (e.g. for local break-out) is
outside the scope of this specification. This signalling and its interaction
with the dedicated bearer activation procedure are to be specified in TS
23.203 [6]. Steps 1 and 12 are included here only for completeness.
### 5.4.2 Bearer modification with bearer QoS update
### 5.4.2.1 PDN GW initiated bearer modification with bearer QoS update
The PDN GW initiated bearer modification procedure (including EPS Bearer QoS
update) for a GTP based S5/S8 is depicted in figure 5.4.2.1-1. This procedure
is used in cases when one or several of the EPS Bearer QoS parameters QCI,
GBR, MBR or ARP are modified (including the QCI and the ARP of the default EPS
bearer e.g. due to the HSS Initiated Subscribed QoS Modification procedure, as
described in clause 5.4.2.2, or to modify the APN-AMBR. Modification from a
QCI of resource type non-GBR to a QCI of resource type GBR and vice versa is
not supported by this procedure.
NOTE 1: The QCI of an existing dedicated bearer should only be modified if no
additional bearer can be established with the desired QCI.
Figure 5.4.2.1-1: Bearer Modification Procedure with Bearer QoS Update
NOTE 2: Steps 3-10 are common for architecture variants with GTP based S5/S8
and PMIP-based S5/S8. For a PMIP-based S5/S8, procedure steps (A) and (B) are
defined in TS 23.402 [2]. Steps 1, 2, 11 and 12 concern GTP based S5/S8.
1\. If dynamic PCC is deployed, the PCRF sends a PCC decision provision (QoS
policy) message to the PDN GW. This corresponds to the initial steps of the
PCRF-Initiated IP‑CAN Session Modification procedure or to the PCRF response
in the PCEF initiated IP-CAN Session Modification procedure as defined in TS
23.203 [6], up to the point that the PDN GW requests IP‑CAN Bearer Signalling.
If dynamic PCC is not deployed, the PDN GW may apply local QoS policy.
2\. The PDN GW uses this QoS policy to determine that the authorized QoS of a
service data flow has changed or that a service data flow shall be aggregated
to or removed from an active bearer. The PDN GW generates the TFT and updates
the EPS Bearer QoS to match the traffic flow aggregate. The PDN GW then sends
the Update Bearer Request (PTI, EPS Bearer Identity, EPS Bearer QoS, APN-AMBR,
TFT) message to the Serving GW. The Procedure Transaction Id (PTI) parameter
is used when the procedure was initiated by a UE Requested Bearer Resource
Modification Procedure - see clause 5.4.5. For APN-AMBR, the EPS bearer
identity must refer to a non-GBR bearer.
3\. The Serving GW sends the Update Bearer Request (PTI, EPS Bearer Identity,
EPS Bearer QoS, TFT, APN‑AMBR) message to the MME. If the UE is in ECM‑IDLE
state the MME will trigger the Network Triggered Service Request from step 3
(which is specified in clause 5.3.4.3). In that case the following steps 4‑7
may be combined into Network Triggered Service Request procedure or be
performed standalone.
4\. The MME builds a Session Management Request including the PTI, EPS Bearer
QoS parameters (excluding ARP), TFT, APN‑AMBR and EPS Bearer Identity. If the
UE has UTRAN or GERAN capabilities, the MME uses the EPS Bearer QoS parameters
to derive the corresponding PDP context parameters QoS Negotiated (R99 QoS
profile), Radio Priority and Packet Flow Id and includes them in the Session
Management Request. If the UE indicated in the UE Network Capability it does
not support BSS packet flow procedures, then the MME shall not include the
Packet Flow Id. If the APN‑AMBR has changed the MME may update the UE‑AMBR if
appropriate. The MME then sends the Bearer Modify Request (EPS Bearer
Identity, EPS Bearer QoS, Session Management Request, UE‑AMBR) message to the
eNodeB.
5\. The eNodeB maps the modified EPS Bearer QoS to the Radio Bearer QoS. It
then signals a RRC Connection Reconfiguration (Radio Bearer QoS, Session
Management Request, EPS RB Identity) message to the UE. The UE shall store the
QoS Negotiated, Radio Priority, Packet Flow Id, which it received in the
Session Management Request, for use when accessing via GERAN or UTRAN. If the
APN-AMBR has changed, the UE stores the modified APN-AMBR value and sets the
MBR parameter of the corresponding non-GBR PDP contexts (of this PDN
connection) to the new value. The UE uses the uplink packet filter (UL TFT) to
determine the mapping of traffic flows to the radio bearer. The UE may provide
EPS Bearer QoS parameters to the application handling the traffic flow(s). The
application usage of the EPS Bearer QoS is implementation dependent. The UE
shall not reject the Radio Bearer Modify Request on the basis of the EPS
Bearer QoS parameters contained in the Session Management Request. The UE
shall set its TIN to \"GUTI\" if the modified EPS bearer was established
before ISR activation.
NOTE 3: The details of the Radio Bearer QoS are specified in TS 36.300 [5].
6\. The UE acknowledges the radio bearer modification to the eNodeB with a RRC
Connection Reconfiguration Complete message.
7\. The eNodeB acknowledges the bearer modification to the MME with a Bearer
Modify Response (EPS Bearer Identity) message. With this message, the eNodeB
indicates whether the requested EPS Bearer QoS could be allocated or not.
8\. The UE NAS layer builds a Session Management Response including EPS Bearer
Identity. The UE then sends a Direct Transfer (Session Management Response)
message to the eNodeB.
9\. The eNodeB sends an Uplink NAS Transport (Session Management Response)
message to the MME.
10\. Upon reception of the Bearer Modify Response message in step 7 and the
Session Management Response message in step 9, the MME acknowledges the bearer
modification to the Serving GW by sending an Update Bearer Response (EPS
Bearer Identity) message.
11\. The Serving GW acknowledges the bearer modification to the PDN GW by
sending an Update Bearer Response (EPS Bearer Identity) message.
12\. If the Bearer modification procedure was triggered by a PCC Decision
Provision message from the PCRF, the PDN GW indicates to the PCRF whether the
requested PCC decision (QoS policy) could be enforced or not by sending a
Provision Ack message allowing the completion of the PCRF-Initiated IP‑CAN
Session Modification procedure or the PCEF initiated IP-CAN Session
Modification procedure as defined in TS 23.203 [6], after the completion of
IP‑CAN bearer signalling.
NOTE 4: The exact signalling of step 1 and 12 (e.g. for local break-out) is
outside the scope of this specification. This signalling and its interaction
with the bearer activation procedure are to be specified in TS 23.203 [6].
Steps 1 and 12 are included here only for completeness.
#### 5.4.2.2 HSS Initiated Subscribed QoS Modification
The HSS Initiated Subscribed QoS Modification for a GTP-based S5/S8 is
depicted in figure 5.4.2.2-1.
Figure 5.4.2.2-1: HSS Initiated Subscribed QoS Modification
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and steps (B) are defined
in TS 23.402 [2]. Steps 3, 4, 5, 7 and 8 concern GTP based S5/S8.
1\. The HSS sends an Insert Subscriber Data (IMSI, Subscription Data) message
to the MME. The Subscription Data includes EPS subscribed QoS (QCI, ARP) and
the subscribed UE-AMBR and APN‑AMBR.
1a. The MME updates the stored Subscription Data and acknowledges the Insert
Subscriber Data message by returning an Insert Subscriber Data Ack (IMSI)
message to the HSS (see clause 5.3.9.2).
2a. If only the subscribed UE-AMBR has been modified, the MME calculates a new
UE-AMBR value as described in clause 4.7.3 and may then signal a modified UE-
AMBR value to the eNodeB by using S1-AP UE Context Modification Procedure. The
HSS Initiated Subscribed QoS Modification Procedure ends after completion of
the UE Context Modification Procedure.
2b. If the QCI and/or ARP and/or subscribed APN-AMBR has been modified and
there is related active PDN connection with the modified QoS Profile the MME
sends the Modify Bearer Command (EPS Bearer Identity, EPS Bearer QoS,
APN‑AMBR) message to the Serving GW. The EPS Bearer Identity identifies the
default bearer of the affected PDN connection. The EPS Bearer QoS contains the
EPS subscribed QoS profile to be updated.
3\. The Serving GW sends the Modify Bearer Command (EPS Bearer Identity, EPS
Bearer QoS, APN‑AMBR) message to the PDN GW.
4\. If PCC infrastructure is deployed, the PDN GW informs the PCRF about the
updated EPS Bearer QoS. The PCRF sends new updated PCC decision to the PDN GW.
This corresponds to the PCEF-initiated IP‑CAN Session Modification procedure
as defined in TS 23.203 [6].
The PCRF may modify the APN-AMBR and the QoS parameters (QCI and ARP)
associated with the default bearer in the response to the PDN GW as defined in
TS 23.203 [6].
5\. The PDN GW modifies the default bearer of each PDN connection
corresponding to the APN for which subscribed QoS has been modified. If the
subscribed ARP parameter has been changed, the PDN GW shall also modify all
dedicated EPS bearers having the previously subscribed ARP value unless
superseded by PCRF decision. The PDN GW then sends the Update Bearer Request
(EPS Bearer Identity, EPS Bearer QoS, TFT, APN‑AMBR) message to the Serving
GW.
NOTE 2: As no PTI is included the MME use protocol specific details, as
described in TS 29.274 [43], to determine if the Update Bearer Request was
triggered by this procedure or not.
6\. If the QCI and/or ARP parameter(s) have been modified, steps 3 to 10, as
described in clause 5.4.2.1, Figure 5.4.2.1-1, are invoked. If neither the QCI
nor the ARP have been modified, but instead only the APN-AMBR was updated,
steps 3 to 8, as described in clause 5.4.3, Figure 5.4.3-1, are invoked.
7\. The Serving GW acknowledges the bearer modification to the PDN GW by
sending an Update Bearer Response (EPS Bearer Identity) message. If the bearer
modification fails the PDN GW deletes the concerned EPS Bearer.
8\. The PDN GW indicates to the PCRF whether the requested PCC decision was
enforced or not by sending a Provision Ack message.
### 5.4.3 PDN GW initiated bearer modification without bearer QoS update
The bearer modification procedure without bearer QoS update is used to update
the TFT for an active default or dedicated bearer, or to modify the APN-AMBR.
NOTE 1: If neither the contents of the TFT nor the APN-AMBR are modified, this
procedure does not apply.
The procedure for a GTP based S5/S8 is depicted in figure 5.4.3‑1. In this
procedure there is no need to update the underlying radio bearer(s). This
procedure may be triggered if the APN-AMBR is changed by the PCRF/PDN GW.
Figure 5.4.3-1: Bearer Modification Procedure without Bearer QoS Update
NOTE 2: Steps 3-8 are common for architecture variants with GTP based S5/S8
and PMIP-based S5/S8. For an PMIP-based S5/S8, procedure steps (A) and (B) are
defined in TS 23.402 [2]. Steps 1, 2, 9 and 10 concern GTP based S5/S8. Steps
3-8 may also be used within the HSS Initiated Subscribed QoS Modification.
1\. If dynamic PCC is deployed, the PCRF sends a PCC decision provision (QoS
policy) message to the PDN GW. This corresponds to the beginning of the PCRF-
initiated IP-CAN Session Modification procedure or to the PCRF response in the
PCEF initiated IP-CAN Session Modification procedure as defined in TS 23.203
[6], up to the point that the PDN GW requests IP-CAN Bearer Signalling. If
dynamic PCC is not deployed, the PDN GW may apply local QoS policy.
2\. The PDN GW uses this QoS policy to determine that a service data flow
shall be aggregated to or removed from an active bearer. The PDN GW generates
the TFT and determines that no update of the EPS Bearer QoS is needed. The PDN
GW then sends the Update Bearer Request (PTI, EPS Bearer Identity, APN-AMBR,
TFT) message to the Serving GW. The Procedure Transaction Id (PTI) parameter
is used when the procedure was initiated by a UE Requested Bearer Resource
Modification procedure -- see clause 5.4.5.
3\. The Serving GW sends the Update Bearer Request (PTI, EPS Bearer Identity,
APN-AMBR, TFT) message to the MME. If the UE is in ECM-IDLE state the MME will
trigger the Network Triggered Service Request from step 3 (which is specified
in clause 5.3.4.3). In that case the following steps 4-7 may be combined into
Network Triggered Service Request procedure or be performed standalone.
4\. The MME builds a Session Management Request message including the TFT,
APN-AMBR and EPS Bearer Identity. The MME then sends a Downlink NAS Transport
(Session Management Configuration) message to the eNodeB. If the APN AMBR has
changed, the MME may also update the UE AMBR.
5\. The eNodeB sends the Direct Transfer (Session Management Request) message
to the UE. The UE uses the uplink packet filter (UL TFT) to determine the
mapping of traffic flows to the radio bearer. The UE stores the modified APN-
AMBR value and sets the MBR parameter of the corresponding non-GBR PDP
contexts (of this PDN connection) to the new value. The UE shall set its TIN
to \"GUTI\" if the modified EPS bearer was established before ISR activation.
6\. The UE NAS layer builds a Session Management Response including EPS Bearer
Identity. The UE then sends a Direct Transfer (Session Management Response)
message to the eNodeB.
7\. The eNodeB sends an Uplink NAS Transport (Session Management Response)
message to the MME.
8\. The MME acknowledges the bearer modification to the Serving GW by sending
an Update Bearer Response (EPS Bearer Identity) message.
9\. The Serving GW acknowledges the bearer modification to the PDN GW by
sending an Update Bearer Response (EPS Bearer Identity) message.
10\. If the bearer modification procedure was triggered by a PCC Decision
Provision message from the PCRF, the PDN GW indicates to the PCRF whether the
requested PCC decision (QoS policy) could be enforced or not by sending a
Provision Ack message. This then allows the PCRF-Initiated IP‑CAN Session
Modification procedure or the PCEF initiated IP-CAN Session Modification
procedure as defined in TS 23.203 [6] to continue and eventually conclude,
proceeding after the completion of IP‑CAN bearer signalling.
NOTE 3: The exact signalling of step 1 and 10 (e.g. for local break-out) is
outside the scope of this specification. This signalling and its interaction
with the bearer activation procedure are to be specified in TS 23.203 [6].
Steps 1 and 10 are included here only for completeness.
### 5.4.4 Bearer deactivation
#### 5.4.4.1 PDN GW initiated bearer deactivation
The bearer deactivation procedure for a GTP based S5/S8 is depicted in figure
5.4.4.1-1. In this procedure, the UE is assumed to be in ECM-CONNECTED. This
procedure can be used to deactivate a dedicated bearer or deactivate all
bearers belonging to a PDN address. If the default bearer belonging to a PDN
connection is deactivated, the PDN GW deactivates all bearers belonging to the
PDN connection.
Figure 5.4.4.1-1: PDN GW Initiated Bearer Deactivation, UE in active mode
NOTE 1: Steps 3-8 are common for architecture variants with GTP based S5/S8
and PMIP-based S5/S8. For an PMIP-based S5/S8, procedure steps (A) and (B) are
defined in TS 23.402 [2]. Steps 1, 2, 9 and 10 concern GTP-based S5/S8.
1\. If dynamic PCC is not deployed, the PDN GW is triggered to initiate the
Bearer Deactivation procedure due either a QoS policy or on request from the
MME (as outlined in clause 5.4.4.2). Optionally, the PCRF sends QoS policy to
the PDN GW. This corresponds to the initial steps of the PCRF-initiated IP‑CAN
Session Modification procedure or the response to the PCEF initiated IP-CAN
Session Modification procedure as defined in TS 23.203 [6], up to the point
that the PDN GW requests IP‑CAN Bearer Signalling. If dynamic PCC is not
deployed, the PDN GW may apply local QoS policy. The PDN GW initiated Bearer
deactivation is also performed when handovers without optimization occurs from
3GPP to non-3GPP, in which case, the default bearer and all the dedicated
bearers associated with the PDN address are released, but the PDN address is
kept in the PDN GW.
2\. The PDN GW sends a Delete Bearer Request (PTI, EPS Bearer Identity,
Causes) message to the Serving GW. The Procedure Transaction Id (PTI)
parameter in this step and in the following steps is only used when the
procedure was initiated by a UE Requested Bearer Resource Modification
Procedure - see clause 5.4.5. This message can include an indication that all
bearers belonging to that PDN connection shall be released. The PDN GW
includes \'Cause\' IE in the Delete Bearer Request message and sets the IE to
\'RAT changed from 3GPP to Non-3GPP\' if the Delete Bearer Request message is
caused by handover without optimization occurs from 3GPP to non-3GPP.
3a. The Serving GW sends the Delete Bearer Request (PTI, EPS Bearer Identity,
Cause) message to the MME. This message can include an indication that all
bearers belonging to that PDN connection shall be released.
3b. If ISR is activated, the Serving GW sends the Delete Bearer Request (PTI,
EPS Bearer Identity, Cause) message to the SGSN. This message can include an
indication that all bearers belonging to that PDN connection shall be
released, and the SGSN releases all bearer resources of the PDN connection.
NOTE 2: If all the bearers belonging to a UE are released due to handover
without optimization occurs from 3GPP to non-3GPP, the SGSN changes the MM
state of the UE to IDLE (GERAN network) or PMM-DETACHED (UTRAN network).
4a. If the last PDN connection of the UE is being released and the bearer
deletion is neither due to ISR deactivation nor due to handover to non-3GPP
accesses, the MME explicitly detaches the UE by sending a Detach Request
message to the UE. If the UE is in ECM-IDLE state the MME pages the UE. Steps
4b to 7b are skipped in this case, and the procedure continues from step 7c.
4b. If the release of the bearer in E‑UTRAN has already been signalled to the
MME, steps 4‑7 are omitted. Otherwise the MME sends the S1-AP Deactivate
Bearer Request (EPS Bearer Identity) message to the eNodeB. The MME builds a
NAS Deactivate EPS Bearer Context Request message including the EPS Bearer
Identity, and includes it in the S1-AP Deactivate Bearer Request message. When
the bearer deactivation procedure was originally triggered by a UE request,
the NAS Deactivate EPS Bearer Context Request message includes the PTI.
5\. The eNodeB sends the RRC Connection Reconfiguration message including the
EPS Radio Bearer Identity to release and the NAS Deactivate EPS Bearer Context
Request message to the UE.
6a. The UE RRC releases the radio bearers indicated in the RRC message in step
5, and indicates the radio bearer status to the UE NAS. Then the UE NAS
removes the UL TFTs and EPS Bearer Identity according to the radio bearer
status indication from the UE RRC. The UE responds to the RRC Connection
Reconfiguration Complete message to the eNodeB.
6b. The eNodeB acknowledges the bearer deactivation to the MME with a
Deactivate Bearer Response (EPS Bearer Identity) message.
7a The UE NAS layer builds a Deactivate EPS Bearer Context Accept message
including EPS Bearer Identity. The UE then sends a Direct Transfer (Deactivate
EPS Bearer Context Accept) message to the eNodeB.
7b. The eNodeB sends an Uplink NAS Transport (Deactivate EPS Bearer Context
Accept) message to the MME.
7c. If the UE receives the Detach Request message from the MME in the step 4a,
the UE sends a Detach Accept message to the MME any time after step 4a. The
eNodeB forwards this NAS message to the MME along with the TAI+ECGI of the
cell which the UE is using.
NOTE 3: The UE may not be able to send this message, e.g. when the UE is out
of coverage of E-UTRAN due to mobility to non-3GPP access.
8a. The MME deletes the bearer context related to the deactivated EPS bearer
and acknowledges the bearer deactivation to the Serving GW by sending a Delete
Bearer Response (EPS Bearer Identity) message.
8b The SGSN deletes PDP Context related to the deactivated EPS bearer and
acknowledges the bearer deactivation to the Serving GW by sending a Delete
Bearer Response (EPS Bearer Identity) message.
9\. If ISR is activated, after receiving the two Delete Bearer Response
messages from the MME and the SGSN, or if ISR is not activated, after
receiving the Delete Bearer Response messages from the MME, the Serving GW
deletes the bearer context related to the deactivated EPS bearer acknowledges
the bearer deactivation to the PDN GW by sending a Delete Bearer Response (EPS
Bearer Identity) message.
10\. The PDN GW deletes the bearer context related to the deactivated EPS
bearer. If the dedicated bearer deactivation procedure was triggered by
receiving a PCC decision message from the PCRF, the PDN GW indicates to the
PCRF whether the requested PCC decision was successfully enforced by
completing the PCRF-initiated IP‑CAN Session Modification procedure or the
PCEF initiated IP-CAN Session Modification procedure as defined in TS 23.203
[6], proceeding after the completion of IP‑CAN bearer signalling.
11\. If the UE is being explicitly detached, the MME releases the S1-MME
signalling connection for the UE by sending an S1 Release Command (Cause)
message to the eNodeB. The details of this step are covered in the \"S1
Release Procedure\", as described in clause 5.3.5 by step 4 to step 6.
NOTE 4: The exact signalling of step 1 and 10 (e.g. for local break-out) is
outside the scope of this specification. This signalling and its interaction
with the dedicated bearer activation procedure are to be specified in TS
23.203 [6]. Steps 1 and 10 are included here only for completeness.
Steps 4 to 7 are not performed when the UE is in (a) ECM-IDLE and the last PDN
connection of the UE is not being deleted or (b) UE is in ECM-IDLE and the
last PDN connection is deleted due to ISR deactivation or due to handover to
non-3GPP access. The EPS bearer state is synchronized between the UE and the
network at the next ECM-IDLE to ECM-CONNECTED transition (e.g. Service Request
or TAU procedure).
If all the bearers belonging to a UE are released, the MME shall change the MM
state of the UE to EMM-DEREGISTERED and the MME sends the S1 Release Command
to the eNodeB, which initiates the release of the RRC connection for the given
UE if it is not released yet, and returns an S1 Release Complete message to
the MME.
If the default bearer belonging to a PDN connection is deactivated, the MME
determines the Maximum APN Restriction for the remaining PDN connections and
stores this new value for the Maximum APN Restriction. In addition if ISR is
activated the SGSN determines the Maximum APN Restriction for the remaining
bearer contexts and stores this new value for the Maximum APN Restriction.
#### 5.4.4.2 MME Initiated Dedicated Bearer Deactivation
MME initiated Dedicated Bearer Deactivation is depicted in Figure 5.4.4.2-1
below. This procedure deactivates dedicated bearers. Default bearers are not
affected. To initiate the release of the full PDN connection including the
default bearer, the MME uses the UE or MME requested PDN disconnection
procedure defined in clause 5.10.3.
In case of eNodeB Failure, MME may, based on operator policy, either preserve
all bearers or initiate the Dedicated Bearer Deactivation procedure, as shown
in Figure 5.4.4.2-1 below. In deactivating the GBR bearers, MME may take the
EPS bearer QoS into account.
Figure 5.4.4.2-1: MME initiated Dedicated Bearer Deactivation
NOTE: For a PMIP-based S5/S8, procedure steps (A) and steps (B) are defined in
TS 23.402 [2]. Steps 3, 4, 5 and 9 concern GTP based S5/S8
0\. Radio bearers for the UE in the ECM-CONNECTED state may be released due to
local reasons (e.g. abnormal resource limitation or radio conditions do not
allow the eNodeB to maintain all the allocated GBR bearers: it is not expected
that non-GBR bearers are released by the eNodeB unless caused by error
situations). The UE deletes the bearer contexts related to the released radio
bearers.
1\. When the eNodeB releases radio bearers in step 0, it sends an indication
of bearer release to the MME. This indication may be e.g. the Bearer Release
Request (EPS Bearer Identity) message to the MME, or alternatively Initial
Context Setup Complete, Handover Request Ack and UE Context Response, Path
Switch Request may also indicate the release of a bearer.
2\. The MME sends the Delete Bearer Command (EPS Bearer Identity) message per
PDN connection to the Serving GW to deactivate the selected dedicated bearer.
3\. The Serving GW sends the Delete Bearer Command (EPS Bearer Identity)
message per PDN connection to the PDN GW.
4\. If PCC infrastructure is deployed, the PDN GW informs the PCRF about the
loss of resources by means of a PCEF-initiated IP‑CAN Session Modification
procedure as defined in TS 23.203 [6]. The PCRF sends a updated PCC decision
to the PDN GW.
5\. The PDN GW sends a Delete Bearer Request (EPS Bearer Identity) message to
the Serving GW.
6\. The Serving GW sends the Delete Bearer Request (EPS Bearer Identity)
message to the MME.
7\. Steps between steps 4 and 7, as described in clause 5.4.4.1, are invoked.
This is omitted if the bearer deactivation was triggered by the eNodeB in step
0 and step 1.
8\. The MME deletes the bearer contexts related to the deactivated EPS bearer
and acknowledges the bearer deactivation to the Serving GW by sending a Delete
Bearer Response (EPS Bearer Identity) message.
9\. The Serving GW deletes the bearer context related to the deactivated EPS
bearer and acknowledges the bearer deactivation to the PDN GW by sending a
Delete Bearer Response (EPS Bearer Identity) message.
### 5.4.5 UE requested bearer resource modification
The UE requested bearer resource modification procedure for an E-UTRAN is
depicted in figure 5.4.5-1. The procedure allows the UE to request for a
modification of bearer resources (e.g. allocation or release of resources) for
one traffic flow aggregate with a specific QoS demand. Alternatively, the
procedure allows the UE to request for the modification of the packet filters
used for an active traffic flow aggregate, without changing QoS. If accepted
by the network, the request invokes either the Dedicated Bearer Activation
Procedure, the Bearer Modification Procedure or a dedicated bearer is
deactivated using the PDN GW Initiated Bearer Deactivation Procedure. The
procedure is used by the UE when the UE already has a PDN connection with the
PDN GW. A UE can send a subsequent Request Bearer Resource Modification
Message before the previous procedure is completed.
In this procedure the UE signals a Traffic Aggregate Description (TAD) which
is a partial TFT, together with a Procedure Transaction Identifier (PTI), and
an EPS Bearer Identity (when the TAD operation is modify or delete). When the
TAD operation is modify or delete, the packet filter identifiers of the TAD
are the same as the TFT packet filter identifiers of the referenced EPS Bearer
(as the concatenation of the TFT packet filter identifier and the EPS Bearer
identifier represents a unique packet filter identifier within the PDN
connection), for which resources are being modified. The TAD is released by
the UE after it has received a TFT related to the current PTI from the
network.
Figure 5.4.5-1: UE requested bearer resource modification
NOTE: Steps 1, 2, and 5 are common for architecture variants with GTP-based
S5/S8 and PMIP-based S5/S8. The procedure steps marked (A) differ in the case
that PMIP-based S5/S8 is employed and is defined in TS 23.402 [2].
1\. The UE sends a Request Bearer Resource Modification (LBI, PTI, EPS Bearer
Identity, QoS, TAD, Protocol Configuration Options) message to the MME. If the
UE was in ECM-IDLE mode, this NAS message is preceded by the Service Request
procedure.
The TAD indicates one requested operation (add, modify, or delete packet
filters). If traffic flows are added, the TAD includes the packet filter(s)
(consisting of the packet filter information including packet filter
precedence, but without a packet filter identifier) to be added. The UE also
sends the QCI requested and GBR, if applicable, for the added traffic flows.
The TAD is released when the procedure is completed.
When requesting for a modification of GBR (i.e. decrease or increase), the TAD
shall include packet filter identifier(s) for which the GBR change request
applies to. The UE includes the GBR requirement of the EPS Bearer. The TAD is
released when the procedure is completed.
When requesting for a modification of a packet filter (e.g. change of port
number), the TAD shall include packet filter identifier for which the change
request applies to together with the changed packet filter information.
If the UE requests for deletion of traffic flows, the TAD includes the packet
filter identifier(s) to be deleted. If the packet filters to be deleted were
mapped to a GBR Bearer, the UE includes the new GBR requirement of the EPS
Bearer.
The UE sends the Linked Bearer Id (LBI) only when the requested operation is
add, to indicate to which PDN connection the additional bearer resource is
linked to. The EPS Bearer Identity is only sent when the requested operation
is modify or delete. The Procedure Transaction Id is dynamically allocated by
the UE for this procedure. The UE should ensure as far as possible that
previously used PTI values are not immediately reused. The PTI is released
when the procedure is completed. Protocol Configuration Options may be used to
transfer application level parameters between the UE and the PDN GW (see TS
23.228 [52]), and are sent transparently through the MME and the Serving GW.
2\. The MME sends the Bearer Resource Command (IMSI, LBI, PTI, EPS Bearer
Identity, QoS, TAD, Protocol Configuration Options) message to the selected
Serving GW. The MME validates the request using the Linked Bearer Id. The same
Serving GW address is used by the MME as for the EPS Bearer identified by the
Linked Bearer Id received in the Request Bearer Resource Modification message.
3\. The Serving GW sends the Bearer Resource Command (IMSI, LBI, PTI, EPS
Bearer Identity, QoS, TAD, Protocol Configuration Options) message to the PDN
GW. The Serving GW sends the message to the same PDN GW as for the EPS Bearer
identified by the Linked Bearer Id.
4\. The PDN GW may either apply a locally configured QoS policy, or it may
interact with the PCRF to trigger the appropriate PCC decision, which may take
into account subscription information. This corresponds to the beginning of a
PCEF-initiated IP‑CAN Session Modification procedure as defined in TS 23.203
[6], up to the point that the PDN GW requests IP‑CAN Bearer Signalling. When
interacting with PCRF, the PDN GW provides to the PCRF the content of the TAD
and if applicable, the GBR change (increase or decrease) associated with the
packet filter information contained in the TAD. The GBR change is either
calculated from the current Bearer QoS and the requested Bearer QoS from the
UE, or set to the requested GBR if the TAD indicates an add operation and no
EPS Bearer Identity was received. If the TAD indicates an add operation, the
requested QCI is also provided to the PCRF.
If the TAD operation is modify or delete, then the PDN GW provides the SDF
filter identifier(s), previously assigned on Gx, that correspond to the
received packet filter identifiers of the EPS bearer indicated by the received
EPS bearer identity.
5\. If the request is accepted, either the Dedicated Bearer Activation
Procedure (according to clause 5.4.1), the PDN GW Initiated Bearer
Deactivation Procedure (according to clause 5.4.4.1) or one of the Dedicated
Bearer Modification Procedures (according to clause 5.4.2.1 or 5.4.3) is
invoked. The PTI allocated by the UE is used as a parameter in the invoked
Dedicated Bearer Activation Procedure, the PDN GW Initiated Bearer
Deactivation Procedure or the Dedicated Bearer Modification Procedure to
correlate it to the UE Requested Bearer Resource Modification Procedure. This
provides the UE with the necessary linkage to what EPS Bearer to be used for
the new traffic flow aggregate. The PDN GW shall not modify the QoS parameters
requested by the UE.
The PDN GW inserts, modifies or removes packet filter(s) corresponding to the
TAD into the TFT for the EPS bearer. When a new packet filter is inserted into
a TFT, the PDN GW assigns a new packet filter identifier which is unique
within the TFT. The PDN GW maintains the relation between the SDF filter
identifier in the PCC rule received from the PCRF and the packet filter
identifier of the TFT of this EPS bearer. If all of the packet filter(s) for a
dedicated EPS bearer have been removed from the TFT, the PDN GW performs the
PDN GW Initiated Bearer Deactivation Procedure.
If the requested QoS is not granted (i.e. the requested QoS cannot be accepted
or resources could not be allocated) the PDN GW sends a Bearer Resource
Failure Indication (with a cause indicating the reason why the request failed
or was rejected) message, which shall be delivered to the UE.
6\. If the PDN GW interacted with the PCRF in step 4, the PDN GW indicates to
the PCRF whether the PCC decision could be enforced or not. This corresponds
to the completion of the PCEF-initiated IP‑CAN session modification procedure
as defined in TS 23.203 [6], proceeding after the completion of IP‑CAN bearer
signalling.
### 5.4.6 Void
## 5.5 Handover
### 5.5.1 Intra-E-UTRAN handover
#### 5.5.1.1 X2-based handover
##### 5.5.1.1.1 General
These procedures are used to hand over a UE from a source eNodeB to a target
eNodeB using the X2 reference point. In these procedures the MME is unchanged.
Two procedures are defined depending on whether the Serving GW is unchanged or
is relocated. In addition to the X2 reference point between the source and
target eNodeB, the procedures rely on the presence of S1-MME reference point
between the MME and the source eNodeB as well as between the MME and the
target eNodeB.
The handover preparation and execution phases are performed as specified in TS
36.300 [5].
If the serving PLMN changes during an X2-based handover, the source eNodeB
shall indicate to the target eNodeB (in the Handover Restriction List) the
PLMN selected to be the new Serving PLMN.
When the UE receives the handover command it will remove any EPS bearers for
which it did not receive the corresponding EPS radio bearers in the target
cell. As part of handover execution, downlink and optionally also uplink
packets are forwarded from the source eNodeB to the target eNodeB. When the UE
has arrived to the target eNodeB, downlink data forwarded from the source
eNodeB can be sent to it. Uplink data from the UE can be delivered via the
(source) Serving GW to the PDN GW or optionally forwarded from the source
eNodeB to the target eNodeB. Only the handover completion phase is affected by
a potential change of the Serving GW, the handover preparation and execution
phases are identical.
If the MME receives a rejection to a NAS procedure (e.g. dedicated bearer
establishment/modification/release; location reporting control; NAS message
transfer; etc.) from the eNodeB with an indication that an X2 handover is in
progress (see TS 36.300 [5]), the MME shall reattempt the same NAS procedure
either when the handover is complete or the handover is deemed to have failed.
The failure is known by expiry of the timer guarding the NAS procedure.
If the MME receives a rejection to a UE Context Modification Request message
with a CS Fallback indicator from the eNodeB with an indication that an X2
handover is in progress, the MME shall resend a UE Context Modification
Request message with CS Fallback indicator to the target eNodeB when the
handover is complete.
##### 5.5.1.1.2 X2-based handover without Serving GW relocation
This procedure is used to hand over a UE from a source eNodeB to a target
eNodeB using X2 when the MME is unchanged and decides that the Serving GW is
also unchanged. The presence of IP connectivity between the Serving GW and the
source eNodeB, as well as between the Serving GW and the target eNodeB is
assumed.
Figure 5.5.1.1.2-1: X2-based handover without Serving GW relocation
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2].
1\. The target eNodeB sends a Path Switch Request message to MME to inform
that the UE has changed cell, including the TAI+ECGI of the target cell and
the list of EPS bearers to be switched. The MME determines that the Serving GW
can continue to serve the UE
2\. The MME sends a Modify Bearer Request (eNodeB address(es) and TEIDs for
downlink user plane for the accepted EPS bearers, ISR Activated) message per
PDN connection to the Serving GW for each PDN connection where the default
bearer has been accepted by the target eNodeB. If the PDN GW requested UE\'s
location info, the MME also includes the User Location Information IE in this
message. If ISR was activated before this procedure, MME should maintain ISR.
The UE is informed about the ISR status in the Tracking Area Update procedure.
The MME uses the list of EPS bearers to be switched, received in step 1, to
determine whether any dedicated EPS bearers in the UE context have not been
accepted by the target eNodeB. The MME releases the non-accepted dedicated
bearers by triggering the bearer release procedure as specified in clause
5.4.4.2. If the Serving GW receives a DL packet for a non-accepted bearer, the
Serving GW drops the DL packet and does not send a Downlink Data Notification
to the MME.
If the default bearer of a PDN connection has not been accepted by the target
eNodeB and there are multiple PDN connections active, the MME shall consider
all bearers of that PDN connection as failed and release that PDN connection
by triggering the MME requested PDN disconnection procedure specified in
clause 5.10.3.
If none of the default EPS bearers have been accepted by the target eNodeB,
the MME shall act as specified in step 6.
3\. If the Serving GW has received the User Location Information IE from the
MME in step 2 the Serving GW informs the PDN GW(s) about this information that
e.g. can be used for charging, by sending the message Modify Bearer Request
(Serving GW Address and TEID, User Location Information IE) per PDN connection
to the PDN GW(s) concerned. A Modify Bearer Response message is sent back to
the Serving GW.
4\. The Serving GW starts sending downlink packets to the target eNodeB using
the newly received address and TEIDs. A Modify Bearer Response message is sent
back to the MME.
5\. In order to assist the reordering function in the target eNodeB, the
Serving GW shall send one or more \"end marker\" packets on the old path
immediately after switching the path as defined in TS 36.300 [5], clause
10.1.2.2.
6\. The MME confirms the Path Switch Request message with the Path Switch
Request Ack message. If the UE‑AMBR is changed, e.g. all the EPS bearers which
are associated to the same APN are rejected in the target eNodeB, the MME
shall provide the updated value of UE‑AMBR to the target eNodeB in the Path
Switch Request Ack message.
If some EPS bearers have not been switched successfully in the core network,
the MME shall indicate in the Path Switch Request Ack message which bearers
failed to be established (see more detail in TS 36.413 [36]) and for dedicated
bearers initiate the bearer release procedure as specified in clause 5.4.4.2
to release the core network resources of the failed dedicated EPS bearers. The
target eNodeB shall delete the corresponding bearer contexts when it is
informed that bearers have not been established in the core network.
If none of the default EPS bearers have been switched successfully in the core
network or if they have not been accepted by the target eNodeB, the MME shall
send a Path Switch Request Failure message (see more detail in TS 36.413 [36])
to the target eNodeB. The MME performs explicit detach of the UE as described
in the MME initiated detach procedure of clause 5.3.8.3.
7\. By sending Release Resource the target eNodeB informs success of the
handover to source eNodeB and triggers the release of resources. This step is
specified in TS 36.300 [5].
8\. The UE initiates a Tracking Area Update procedure when one of the
conditions listed in clause \"Triggers for tracking area update\" applies. If
ISR is activated for the UE when the MME receives the Tracking Area Update
Request, the MME should maintain ISR by indicating ISR Activated in the
Tracking Area Update Accept message.
NOTE 2: It is only a subset of the TA update procedure that is performed by
the MME, since the UE is in ECM‑CONNECTED state and the MME is not changed.
##### 5.5.1.1.3 X2-based handover with Serving GW relocation
This procedure is used to hand over a UE from a source eNodeB to a target
eNodeB using X2 when the MME is unchanged and the MME decides that the Serving
GW is to be relocated. The presence of IP connectivity between the source
Serving GW and the source eNodeB, between the source Serving GW and the target
eNodeB, and between the target Serving GW and target eNodeB is assumed. (If
there is no IP connectivity between target eNodeB and source Serving GW, it is
assumed that the S1-based handover procedure in clause 5.5.1.2 shall be used
instead.)
Figure 5.5.1.1.3-1: X2-based handover with Serving GW relocation
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2].
1\. The target eNodeB sends a Path Switch Request message to MME to inform
that the UE has changed cell, including the ECGI of the target cell and the
list of EPS bearers to be switched.. The MME determines that the Serving GW is
relocated and selects a new Serving GW according to clause 4.3.8.2 on
\"Serving GW Selection Function\".
NOTE 2: The MME knows the S‑GW Service Area with a TA granularity.
2\. The MME sends a Create Session Request (bearer context(s) with PDN GW
addresses and TEIDs (for GTP-based S5/S8) or GRE keys (for PMIP-based S5/S8)
at the PDN GW(s) for uplink traffic, eNodeB address(es) and TEIDs for downlink
user plane for the accepted EPS bearers, the Protocol Type over S5/S8) message
per PDN connection to the target Serving GW for each PDN connection where the
default bearer has been accepted by the target eNodeB. The target Serving GW
allocates the S‑GW addresses and TEIDs for the uplink traffic on S1_U
reference point (one TEID per bearer). The Protocol Type over S5/S8 is
provided to Serving GW which protocol should be used over S5/S8 interface. If
the PDN GW requested UE\'s location info, the MME also includes the User
Location Information IE in this message.
The MME uses the list of EPS bearers to be switched, received in step 1, to
determine whether any dedicated EPS bearers in the UE context have not been
accepted by the target eNodeB. The MME releases the non-accepted dedicated
bearers by triggering the bearer release procedure as specified in clause
5.4.4.2 via target Serving GW. If the Serving GW receives a DL packet for a
non-accepted bearer, the Serving GW drops the DL packet and does not send a
Downlink Data Notification to the MME.
If the default bearer of a PDN connection has not been accepted by the target
eNodeB and there are multiple PDN connections active, the MME shall consider
all bearers of that PDN connection as failed and release that PDN connection
by triggering the MME requested PDN disconnection procedure specified in
clause 5.10.3 via source Serving GW.
If none of the default EPS bearers have been accepted by the target eNodeB,
the MME shall act as specified in step 5.
3\. The target Serving GW assigns addresses and TEIDs (one per bearer) for
downlink traffic from the PDN GW. The Serving GW allocates DL TEIDs on S5/S8
even for non-accepted bearers. It sends a Modify Bearer Request (Serving GW
addresses for user plane and TEID(s)) message per PDN connection to the PDN
GW(s). The S‑GW also includes User Location Information IE if it is present in
step 2. The PDN GW updates its context field and returns a Modify Bearer
Response (Charging Id, MSISDN, etc.) message to the Serving GW. The MSISDN is
included if the PDN GW has it stored in its UE context. The PDN GW starts
sending downlink packets to the target GW using the newly received address and
TEIDs. These downlink packets will use the new downlink path via the target
Serving GW to the target eNodeB.
4\. The target Serving GW sends a Create Session Response (Serving GW
addresses and uplink TEID(s) for user plane) message back to the target MME.
The MME starts a timer, to be used in step 7.
5\. The MME confirms the Path Switch Request message with the Path Switch
Request Ack (Serving GW addresses and uplink TEID(s) for user plane) message.
If the UE‑AMBR is changed, e.g. all the EPS bearers which are associated to
the same APN are rejected in the target eNodeB, the MME shall provide the
updated value of UE‑AMBR to the target eNodeB in the Path Switch Request Ack
message. The target eNodeB starts using the new Serving GW address(es) and
TEID(s) for forwarding subsequent uplink packets.
If some EPS bearers have not been switched successfully in the core network,
the MME shall indicate in the Path Switch Request Ack message which bearers
failed to be established (see more detail in TS 36.413 [36]) and for dedicated
bearers initiate the bearer release procedure as specified in clause 5.4.4.2
to release the core network resources of the failed dedicated EPS bearers. The
target eNodeB shall delete the corresponding bearer contexts when it is
informed that bearers have not been established in the core network.
If none of the default EPS bearers have been switched successfully in the core
network or if they have not been accepted by the target eNodeB, the MME shall
send a Path Switch Request Failure message (see more detail in TS 36.413 [36])
to the target eNodeB. The MME performs explicit detach of the UE as described
in the MME initiated detach procedure of clause 5.3.8.3.
6\. By sending Release Resource the target eNodeB informs success of the
handover to source eNodeB and triggers the release of resources. This step is
specified in TS 36.300 [5].
7\. When the timer has expired after step 4, the source MME releases the
bearer(s) in the source Serving GW by sending a Delete Session Request message
(Cause). Cause indicates to the Source Serving GW that the Source Serving GW
shall not initiate a delete procedure towards the PDN GW. The Source Serving
GW acknowledges with Delete Session Response messages. If ISR has been
activated, the cause also indicates to the Source S‑GW that the Source S‑GW
shall delete the bearer resources on the other old CN node by sending Delete
Bearer Request message(s) to that CN node.
8\. The UE initiates a Tracking Area Update procedure when one of the
conditions listed in clause \"Triggers for tracking area update\" applies.
NOTE 3: It is only a subset of the TA update procedure that is performed by
the MME, since the UE is in ECM‑CONNECTED state. The UE is informed about the
ISR status in the Tracking Area Update procedure.
#### 5.5.1.2 S1-based handover
##### 5.5.1.2.1 General
The S1-based handover procedure is used when the X2-based handover cannot be
used. The source eNodeB initiates a handover by sending Handover Required
message over the S1-MME reference point. This procedure may relocate the MME
and/or the Serving GW. The source MME selects the target MME. The MME should
not be relocated during inter-eNodeB handover unless the UE leaves the MME
Pool Area where the UE is served. The MME (target MME for MME relocation)
determines if the Serving GW needs to be relocated. If the Serving GW needs to
be relocated the MME selects the target Serving GW, as specified in clause
4.3.8.2 on Serving GW selection function.
The source eNodeB decides which of the EPS bearers are subject for forwarding
of downlink and optionally also uplink data packets from the source eNodeB to
the target eNodeB. The EPC does not change the decisions taken by the RAN
node. Packet forwarding can take place either directly from the source eNodeB
to the target eNodeB, or indirectly from the source eNodeB to the target
eNodeB via the source and target Serving GWs (or if the Serving GW is not
relocated, only the single Serving GW).
The availability of a direct forwarding path is determined in the source
eNodeB and indicated to the source MME. If X2 connectivity is available
between the source and target eNodeBs, a direct forwarding path is available.
If a direct forwarding path is not available, indirect forwarding may be used.
The source MME uses the indication from the source eNodeB to determine whether
to apply indirect forwarding. The source MME indicates to the target MME
whether indirect forwarding should apply. Based on this indication, the target
MME determines whether it applies indirect forwarding.
If the MME receives a rejection to an S1 interface procedure (e.g. dedicated
bearer establishment/modification/release; location reporting control; NAS
message transfer; UE Context Modification Request message with a CS Fallback
indicator; etc.) from the eNodeB with an indication that an S1 handover is in
progress (see TS 36.300 [5]), the MME shall reattempt the same S1 interface
procedure when either the handover is complete or is deemed to have failed if
the MME is still the serving MME (if the MME is no longer serving the UE, then
the procedure fails).
In order to minimise the number of procedures rejected by the eNodeB, the MME
should pause non-handover related S1 interface procedures (e.g. downlink NAS
message transfer, E-RAB Setup/Modify/Release, etc.) while a handover is
ongoing (i.e. from the time that a Handover Required has been received until
either the Handover procedure has succeeded (Handover Notify) or failed
(Handover Failure)) and continue them once the Handover procedure has
completed if the MME is still the serving MME (if the MME is no longer serving
the UE, then the procedure fails).
##### 5.5.1.2.2 S1-based handover, normal
This procedure describes the S1-based handover in the normal case, and clause
5.5.1.2.3 describes it when the procedure is rejected by the target eNodeB or
the target MME and clause 5.5.1.2.4 describes when the procedure is canceled
by the source eNodeB.
Figure 5.5.1.2.2-1: S1-based handover
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2]. Steps 16 and 16a concern GTP based S5/S8.
NOTE 2: If the Serving GW is not relocated, the box \"Source Serving GW\" in
figure 5.5.1.2.2-1 is acting as the target Serving GW.
1\. The source eNodeB decides to initiate an S1-based handover to the target
eNodeB. This can be triggered e.g. by no X2 connectivity to the target eNodeB,
or by an error indication from the target eNodeB after an unsuccessful
X2-based handover, or by dynamic information learnt by the source eNodeB.
2\. The source eNodeB sends Handover Required (Direct Forwarding Path
Availability, Source to Target transparent container, target eNodeB Identity,
target TAI, S1AP Cause) to the source MME. The source eNodeB indicates which
bearers are subject to data forwarding. Direct Forwarding Path Availability
indicates whether direct forwarding is available from the source eNodeB to the
target eNodeB. This indication from source eNodeB can be based on e.g. the
presence of X2. The target TAI is sent to MME to facilitate the selection of a
suitable target MME.
3\. The source MME selects the target MME as described in clause 4.3.8.3 on
\"MME Selection Function\" and if it has determined to relocate the MME, it
sends a Forward Relocation Request (MME UE context, Source to Target
transparent container, TI(s), RAN Cause, target eNodeB Identity, target TAI,
MS Info Change Reporting Action (if available), Direct Forwarding Flag)
message to the target MME. The target TAI is sent to the target MME to help it
to determine whether S‑GW relocation is needed (and, if needed, aid S‑GW
selection).
The MME UE context includes IMSI, ME Identity, UE security context, UE Network
Capability, AMBR, Selected CN operator ID, APN restriction, Serving GW address
and TEID for control signalling, and EPS Bearer context(s).
An EPS Bearer context includes the PDN GW addresses and TEIDs (for GTP-based
S5/S8) or GRE keys (for PMIP-based S5/S8) at the PDN GW(s) for uplink traffic,
APN, Serving GW addresses and TEIDs for uplink traffic, and TI.
RAN Cause indicates the S1AP Cause as received from source eNodeB.
The Direct Forwarding Flag indicates if direct forwarding is applied, or if
indirect forwarding is going to be set up by the source side.
The target MME shall determine the Maximum APN restriction based on the APN
Restriction of each bearer context in the Forward Relocation Request, and
shall subsequently store the new Maximum APN restriction value.
4\. If the MME has been relocated, the target MME verifies whether the source
Serving GW can continue to serve the UE. If not, it selects a new Serving GW
as described in clause 4.3.8.2 on \"Serving GW Selection Function\". If the
MME has not been relocated, the source MME decides on this Serving GW re-
selection.
If the source Serving GW continues to serve the UE, no message is sent in this
step. In this case, the target Serving GW is identical to the source Serving
GW.
If a new Serving GW is selected, the target MME sends a Create Session Request
(bearer context(s) with PDN GW addresses and TEIDs (for GTP-based S5/S8) or
GRE keys (for PMIP-based S5/S8) at the PDN GW(s) for uplink traffic) message
per PDN connection to the target Serving GW. The target Serving GW allocates
the S‑GW addresses and TEIDs for the uplink traffic on S1_U reference point
(one TEID per bearer). The target Serving GW sends a Create Session Response
(Serving GW addresses and uplink TEID(s) for user plane) message back to the
target MME.
5\. The Target MME sends Handover Request (EPS Bearers to Setup, AMBR, S1AP
Cause, Source to Target transparent container, Handover Restriction List)
message to the target eNodeB. This message creates the UE context in the
target eNodeB, including information about the bearers, and the security
context. For each EPS Bearer, the Bearers to Setup includes Serving GW address
and uplink TEID for user plane, and EPS Bearer QoS. Handover Restriction List
is sent if available in the Target MME; it is described in clause 4.3.5.7
\"Mobility Restrictions\".
S1AP Cause indicates the RAN Cause as received from source MME.
The target eNodeB sends a Handover Request Acknowledge (EPS Bearer Setup list,
EPS Bearers failed to setup list, Target to Source transparent container)
message to the target MME. The EPS Bearer Setup list includes a list of
addresses and TEIDs allocated at the target eNodeB for downlink traffic on
S1‑U reference point (one TEID per bearer) and addresses and TEIDs for
receiving forwarded data if necessary. If the UE‑AMBR is changed, e.g. all the
EPS bearers which are associated to the same APN are rejected in the target
eNodeB, the MME shall recalculate the new UE-AMBR and signal the modified
UE‑AMBR value to the target eNodeB.
If none of the default EPS bearers have been accepted by the target eNodeB,
the target MME shall reject the handover as specified in clause 5.5.1.2.3.
6\. If indirect forwarding applies and the Serving GW is relocated, the target
MME sets up forwarding parameters by sending Create Indirect Data Forwarding
Tunnel Request (target eNodeB addresses and TEIDs for forwarding) to the
Serving GW. The Serving GW sends a Create Indirect Data Forwarding Tunnel
Response (target Serving GW addresses and TEIDs for forwarding) to the target
MME. If the Serving GW is not relocated, indirect forwarding may be set up in
step 8 below.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
7\. If the MME has been relocated, the target MME sends a Forward Relocation
Response (Cause, Target to Source transparent container, Serving GW change
indication, EPS Bearer Setup list, Addresses and TEIDs) message to the source
MME. For indirect forwarding, this message includes Serving GW Address and
TEIDs for indirect forwarding (source or target). Serving GW change indication
indicates a new Serving GW has been selected.
8\. If indirect forwarding applies, the source MME sends Create Indirect Data
Forwarding Tunnel Request (addresses and TEIDs for forwarding) to the Serving
GW. If the Serving GW is relocated it includes the tunnel identifier to the
target serving GW.
The Serving GW responds with a Create Indirect Data Forwarding Tunnel Response
(Serving GW addresses and TEIDs for forwarding) message to the source MME.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
9\. The source MME sends a Handover Command (Target to Source transparent
container, Bearers subject to forwarding, Bearers to Release) message to the
source eNodeB. The Bearers subject to forwarding includes list of addresses
and TEIDs allocated for forwarding. The Bearers to Release includes the list
of bearers to be released.
9a. The Handover Command is constructed using the Target to Source transparent
container and is sent to the UE. Upon reception of this message the UE will
remove any EPS bearers for which it did not receive the corresponding EPS
radio bearers in the target cell.
10\. The source eNodeB sends the eNodeB Status Transfer message to the target
eNodeB via the MME(s) to convey the PDCP and HFN status of the E-RABs for
which PDCP status preservation applies, as specified in TS 36.300 [5]. The
source eNodeB may omit sending this message if none of the E-RABs of the UE
shall be treated with PDCP status preservation.
If there is an MME relocation the source MME sends this information to the
target MME via the Forward Access Context Notification message which the
target MME acknowledges. The source MME or, if the MME is relocated, the
target MME, sends the information to the target eNodeB via the eNodeB Status
Transfer message.
11\. The source eNodeB should start forwarding of downlink data from the
source eNodeB towards the target eNodeB for bearers subject to data
forwarding. This may be either direct (step 11a) or indirect forwarding (step
11b).
12\. After the UE has successfully synchronized to the target cell, it sends a
Handover Confirm message to the target eNodeB. Downlink packets forwarded from
the source eNodeB can be sent to the UE. Also, uplink packets can be sent from
the UE, which are forwarded to the target Serving GW and on to the PDN GW.
13\. The target eNodeB sends a Handover Notify (TAI+ECGI) message to the
target MME.
14\. If the MME has been relocated, the target MME sends a Forward Relocation
Complete Notification () message to the source MME. The source MME in response
sends a Forward Relocation Complete Acknowledge () message to the target MME.
Regardless if MME has been relocated or not, a timer in source MME is started
to supervise when resources in Source eNodeB and if the Serving GW is
relocated, also resources in Source Serving GW shall be released.
Upon receipt of the Forward Relocation Complete Acknowledge message the target
MME starts a timer if the target MME allocated S‑GW resources for indirect
forwarding.
15\. The MME sends a Modify Bearer Request (eNodeB address and TEID allocated
at the target eNodeB for downlink traffic on S1‑U for the accepted EPS
bearers, ISR Activated) message to the target Serving GW for each PDN
connection, including the PDN connections that need to be released. If the PDN
GW requested UE\'s location info (determined from the UE context), the MME
also includes the User Location Information IE in this message. For the case
that neither MME nor S-GW changed, if ISR was activated before this procedure
MME should maintain ISR. The UE is informed about the ISR status in the
Tracking Area Update procedure.
The MME releases the non-accepted dedicated bearers by triggering the bearer
release procedure as specified in clause 5.4.4.2. If the Serving GW receives a
DL packet for a non-accepted bearer, the Serving GW drops the DL packet and
does not send a Downlink Data Notification to the MME.
If the default bearer of a PDN connection has not been accepted by the target
eNodeB and there are other PDN connections active, the MME shall handle it in
the same way as if all bearers of a PDN connection have not been accepted. The
MME releases these PDN connections by triggering the MME requested PDN
disconnection procedure specified in clause 5.10.3.
When the Modify Bearer Request does not indicate ISR Activated the Serving GW
deletes any ISR resources by sending a Delete Bearer Request to the other CN
node that has bearer resources on the Serving GW reserved.
16\. If the Serving GW is relocated, the target Serving GW assigns addresses
and TEIDs (one per bearer) for downlink traffic from the PDN GW. It sends a
Modify Bearer Request (Serving GW addresses for user plane and TEID(s))
message per PDN connection to the PDN GW(s). The S‑GW also includes User
Location Information IE if it is present in step 15. The Serving GW allocates
DL TEIDs on S5/S8 even for non-accepted bearers. The PDN GW updates its
context field and returns a Modify Bearer Response (Charging Id, MSISDN)
message to the target Serving GW. The MSISDN is included if the PDN GW has it
stored in its UE context. The PDN GW starts sending downlink packets to the
target GW using the newly received address and TEIDs. These downlink packets
will use the new downlink path via the target Serving GW to the target eNodeB.
If the Serving GW is not relocated, no message is sent in this step and
downlink packets from the Serving‑GW are immediately sent on to the target
eNodeB.
17\. The target Serving GW sends a Modify Bearer Response message to the
target MME. The message is a response to a message sent at step 15.
If the Serving GW does not change, the Serving GW shall send one or more \"end
marker\" packets on the old path immediately after switching the path in order
to assist the reordering function in the target eNodeB.
18\. The UE initiates a Tracking Area Update procedure when one of the
conditions listed in clause \"Triggers for tracking area update\" applies.
The target MME knows that it is a Handover procedure that has been performed
for this UE as it received the bearer context(s) by handover messages and
therefore the target MME performs only a subset of the TA update procedure,
specifically it excludes the context transfer procedures between source MME
and target MME.
19\. When the timer started in step 14 expires the source MME sends a UE
Context Release Command () message to the source eNodeB. The source eNodeB
releases its resources related to the UE and responds with a UE Context
Release Complete () message. When the timer started in step 14 expires and if
the source MME received the Serving GW change indication in the Forward
Relocation Response message, it deletes the EPS bearer resources by sending
Delete Session Request (Cause, LBI) messages to the Source Serving GW. Cause
indicates to the Source Serving GW that the Serving GW changes and the Source
Serving GW shall not initiate a delete procedure towards the PDN GW. The
Source Serving GW acknowledges with Delete Session Response () messages. If
ISR has been activated before this procedure, the cause also indicates to the
Source S‑GW that the Source S‑GW shall delete the bearer resources on the
other old CN node by sending Delete Bearer Request message(s) to that CN node.
20\. If indirect forwarding was used then the expiry of the timer at source
MME started at step 14 triggers the source MME to send a Delete Indirect Data
Forwarding Tunnel Request message to the S‑GW to release the temporary
resources used for indirect forwarding that were allocated at step 8.
21\. If indirect forwarding was used and the Serving GW is relocated, then the
expiry of the timer at target MME started at step 14 triggers the target MME
to send a Delete Indirect Data Forwarding Tunnel Request message to the target
S‑GW to release temporary resources used for indirect forwarding that were
allocated at step 6.
##### 5.5.1.2.3 S1-based handover, Reject
The Target eNodeB rejects the use of the Handover procedure if none of the
requested bearers in the Handover Request message could be established. In
this case no UE context is established in the target MME/eNodeB and no
resources are allocated. Further, the Target MME rejects the handover request
and clears all resource in Target eNodeB and Target MME if the Target eNodeB
accepts the handover request but none of the default EPS bearers gets
resources allocated. In both cases the UE remains in the Source eNodeB/MME.
Figure 5.5.1.2.3-1: S1-based handover, Reject
NOTE 1: Steps 3, 4, 7 and 8 are performed if the MME is relocated.
NOTE 2: If the MME is not relocated Steps 5 and 6 are performed by the source
MME and, in the description below, the source MME acts as the target MME.
1-5. Steps 1 to 5 in the flow are identical to steps 1-5 in clause 5.5.1.2.2.
6a. If the Target eNodeB fails to allocate any resources for any of the
requested EPS bearers it sends a Handover Failure (Cause) message to the
Target MME. The Target MME clears any reserved resources for this UE in the
target MME.
6b. If the Target MME receives a Handover Request Acknowledge message from the
Target eNodeB but none of the default EPS bearers are in the EPS Bearer Setup
list IE, the Target MME clears any reserved resources for this UE in both the
Target MME and the Target eNodeB.
7\. This step is only performed for Serving GW relocation, i.e. if steps 4/4a
have been performed. The Target MME deletes the EPS bearer resources by
sending Delete Session Request (Cause, TEID) messages to the Target Serving
GW. The Target Serving GW acknowledges with Delete Session Response (TEID)
messages.
8\. The Target MME sends the Forward Relocation Response (Cause) message to
the Source MME.
9\. When the Source MME receives the Forward Relocation Response message, it
send a Handover Preparation Failure (Cause) message to the Source eNodeB.
##### 5.5.1.2.4 S1-based handover, Cancel
Instead of completing the handover procedure, the source eNodeB may at any
time during the handover procedure, up to the time when a handover command
message is sent to the UE cancel the handover.
The MME shall cancel the handover resources as defined in clause 5.5.2.5.1 for
case the source RAN is eNodeB.
### 5.5.2 Inter RAT handover
#### 5.5.2.0 General
During Inter RAT handover indirect forwarding may apply for the dowlink data
forwarding performed as part of the handover. From its configuration data the
MME knows whether indirect forwarding applies and it allocates a dowlink data
forwarding path on a Serving GWs for indirect forwarding. From its
configuration data the S4 SGSN knows whether indirect forwarding applies and
it allocates dowlink data forwarding paths on Serving GWs for indirect
forwarding. It is configured on MME and S4 SGSN whether indirect dowlink data
forwarding does not apply, applies always or applies only for inter PLMN inter
RAT handovers.
#### 5.5.2.1 E-UTRAN to UTRAN Iu mode Inter RAT handover
##### 5.5.2.1.1 General
Pre-conditions:
\- The UE is in ECM-CONNECTED state (E-UTRAN mode).
##### 5.5.2.1.2 Preparation phase
Figure 5.5.2.1.2-1: E-UTRAN to UTRAN Iu mode Inter RAT HO, preparation phase
1\. The source eNodeB decides to initiate an Inter-RAT handover to the target
access network, UTRAN Iu mode. At this point both uplink and downlink user
data is transmitted via the following: Bearer(s) between UE and source eNodeB,
GTP tunnel(s) between source eNodeB, Serving GW and PDN GW.
NOTE 1: The process leading to the handover decision is outside of the scope
of this specification.
2\. The source eNodeB sends a Handover Required (S1AP Cause, Target RNC
Identifier, Source eNodeB Identifier, Source to Target Transparent Container)
message to the source MME to request the CN to establish resources in the
target RNC, target SGSN and the Serving GW. The bearers that will be subject
to data forwarding (if any) are identified by the target SGSN in a later step
(see step 7 below).
3\. The source MME determines from the \'Target RNC Identifier\' IE that the
type of handover is IRAT Handover to UTRAN Iu mode. The Source MME initiates
the Handover resource allocation procedure by sending a Forward Relocation
Request (IMSI, Target Identification, MM Context, PDN Connections, MME Tunnel
Endpoint Identifier for Control Plane, MME Address for Control plane, Source
to Target Transparent Container, RAN Cause, MS Info Change Reporting Action
(if available), ISR Supported, TI(s)) message to the target SGSN. The
information ISR Supported is indicated if the source MME is capable to
activate ISR for the UE. When ISR is activated the message should be sent to
the SGSN that maintains ISR for the UE when this SGSN is serving the target
identified by the Target Identification. This message includes all PDN
Connections active in the source system and for each PDN Connection includes
the associated APN, the address and the uplink Tunnel endpoint parameters of
the Serving GW for control plane, and a list of EPS Bearer Contexts. RAN Cause
indicates the S1AP Cause as received from source eNodeB.
The target SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps the EPS
Bearer QoS parameter values of an EPS bearer to the pre-Rel-8 QoS parameter
values of a bearer context as defined in Annex E
Prioritization of PDP Contexts is performed by the target core network node,
i.e. target SGSN.
The MM context contains security related information, e.g. supported ciphering
algorithms as described in TS 29.274 [43]. Handling of security keys is
described in TS 33.401 [41].
The target SGSN shall determine the Maximum APN restriction based on the APN
Restriction of each bearer context in the Forward Relocation Request, and
shall subsequently store the new Maximum APN restriction value.
4\. The target SGSN determines if the Serving GW is to be relocated, e.g., due
to PLMN change. If the Serving GW is to be relocated, the target SGSN selects
the target Serving GW as described under clause 4.3.8.2 on \"Serving GW
selection function\", and sends a Create Session Request message (IMSI, SGSN
Tunnel Endpoint Identifier for Control Plane, SGSN Address for Control plane,
PDN GW address(es) for user plane, PDN GW UL TEID(s) for user plane, PDN GW
address(es) for control plane, and PDN GW TEID(s) for control plane, the
Protocol Type over S5/S8) per PDN connection to the target Serving GW. The
Protocol Type over S5/S8 is provided to Serving GW which protocol should be
used over S5/S8 interface.
The target SGSN establishes the EPS Bearer context(s) in the indicated order.
The SGSN deactivates the EPS Bearer contexts which cannot be established.
4a. The target Serving GW allocates its local resources and returns a Create
Session Response (Serving GW address(es) for user plane, Serving GW UL TEID(s)
for user plane, Serving GW Address for control plane, Serving GW TEID for
control plane) message to the target SGSN.
5\. The target SGSN requests the target RNC to establish the radio network
resources (RABs) by sending the message Relocation Request (UE Identifier,
Cause, CN Domain Indicator, Integrity protection information (i.e. IK and
allowed Integrity Protection algorithms), Encryption information (i.e. CK and
allowed Ciphering algorithms), RAB to be setup list, Source RNC to Target RNC
Transparent Container, Service Handover related information). If the Access
Restriction is present in the MM context, the Service Handover related
information shall be included by the target SGSN for the Relocation Request
message in order for RNC to restrict the UE in connected mode to handover to
the RAT prohibited by the Access Restriction.
For each RAB requested to be established, RABs To Be Setup shall contain
information such as RAB ID, RAB parameters, Transport Layer Address, and Iu
Transport Association. The RAB ID information element contains the NSAPI
value, and the RAB parameters information element gives the QoS profile. The
Transport Layer Address is the Serving GW Address for user plane (if Direct
Tunnel is used) or the SGSN Address for user plane (if Direct Tunnel is not
used), and the Iu Transport Association corresponds to the uplink Tunnel
Endpoint Identifier Data in Serving GW or SGSN respectively.
Ciphering and integrity protection keys are sent to the target RNC to allow
data transfer to continue in the new RAT/mode target cell without requiring a
new AKA (Authentication and Key Agreement) procedure. Information that is
required to be sent to the UE (either in the Relocation Command message or
after the handover completion message) from RRC in the target RNC shall be
included in the RRC message sent from the target RNC to the UE via the
transparent container. More details are described in TS 33.401 [41].
In the target RNC radio and Iu user plane resources are reserved for the
accepted RABs. Cause indicates the RAN Cause as received from source MME. The
Source RNC to Target RNC Transparent Container includes the value from the
Source to Target Transparent Container received from the source eNodeB.
5a. The target RNC allocates the resources and returns the applicable
parameters to the target SGSN in the message Relocation Request Acknowledge
(Target RNC to Source RNC Transparent Container, RABs setup list, RABs failed
to setup list).
Upon sending the Relocation Request Acknowledge message the target RNC shall
be prepared to receive downlink GTP PDUs from the Serving GW, or Target SGSN
if Direct Tunnel is not used, for the accepted RABs.
Each RAB in the RABs setup list is defined by a Transport Layer Address, which
is the target RNC Address for user data, and the Iu Transport Association,
which corresponds to the downlink Tunnel Endpoint Identifier for user data.
Any EPS Bearer contexts for which a RAB was not established are maintained in
the target SGSN and the UE. These EPS Bearer contexts shall be deactivated by
the target SGSN via explicit SM procedures upon the completion of the routing
area update (RAU) procedure.
6\. If \'Indirect Forwarding\' and relocation of Serving GW apply and Direct
Tunnel is used, the target SGSN sends a Create Indirect Data Forwarding Tunnel
Request message (Target RNC Address and TEID(s) for DL user plane data
forwarding) to the Serving GW. If \'Indirect Forwarding\' and relocation of
Serving GW apply and Direct Tunnel is not used, then the target SGSN sends a
Create Indirect Data Forwarding Tunnel Request message (SGSN Address and
TEID(s) for DL data forwarding) to the Serving GW.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
6a. The Serving GW returns a Create Indirect Data Forwarding Tunnel Response
(Cause, Serving GW Address(es) and Serving GW DL TEID(s) for data forwarding)
message to the target SGSN.
7\. The target SGSN sends the message Forward Relocation Response (Cause, SGSN
Tunnel Endpoint Identifier for Control Plane, SGSN Address for Control Plane,
Target to Source Transparent Container, Cause, RAB Setup Information,
Additional RAB Setup Information, Address(es) and TEID(s) for User Traffic
Data Forwarding, Serving GW change indication) to the source MME. Serving GW
change indication indicates a new Serving GW has been selected. The Target to
Source Transparent Container contains the value from the Target RNC to Source
RNC Transparent Container received from the target RNC.
The IE \'Address(es) and TEID(s) for User Traffic Data Forwarding\' defines
the destination tunnelling endpoint for data forwarding in target system, and
it is set as follows:
\- If \'Direct Forwarding\' applies, or if \'Indirect Forwarding\' and no
relocation of Serving GW apply and Direct Tunnel is used, then the IE
\'Address(es) and TEID(s) for User Traffic Data Forwarding\' contains the
addresses and GTP-U tunnel endpoint parameters to the Target RNC received in
step 5a.
\- If \'Indirect Forwarding\' and relocation of Serving GW apply, then the IE
\'Address(es) and TEID(s) for User Traffic Data Forwarding\' contains the
address and DL GTP-U tunnel endpoint parameters to the Serving GW received in
step 6a. This is independent from using Direct Tunnel or not.
\- If \'Indirect Forwarding\' applies and Direct Tunnel is not used and
relocation of Serving GW does not apply, then the IE \'Address(es) and TEID(s)
for User Traffic Data Forwarding\' contains the DL GTP-U tunnel endpoint
parameters to the Target SGSN.
8\. If \"Indirect Forwarding\" applies, the Source MME sends the message
Create Indirect Data Forwarding Tunnel Request (Address(es) and TEID(s) for
Data Forwarding (received in step 7)), EPS Bearer ID(s)) to the Serving GW
used for indirect forwarding.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
8a. The Serving GW returns the forwarding parameters by sending the message
Create Indirect Data Forwarding Tunnel Response (Cause, Serving GW Address(es)
and TEID(s) for Data Forwarding). If the Serving GW doesn\'t support data
forwarding, an appropriate cause value shall be returned and the Serving GW
Address(es) and TEID(s) will not be included in the message.
##### 5.5.2.1.3 Execution phase
Figure 5.5.2.1.3-1: E-UTRAN to UTRAN Iu mode Inter RAT HO, execution phase
NOTE: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2]. Step (B) shows PCRF interaction in the case of PMIP-based S5/S8.
Steps 8 and 8a concern GTP based S5/S8
The source eNodeB continues to receive downlink and uplink user plane PDUs.
1\. The source MME completes the preparation phase towards source eNodeB by
sending the message Handover Command (Target to Source Transparent Container,
E-RABs to Release List, Bearers Subject to Data Forwarding List). The
\"Bearers Subject to Data forwarding list\" IE may be included in the message
and it shall be a list of \'Address(es) and TEID(s) for user traffic data
forwarding\' received from target side in the preparation phase (Step 7 of the
preparation phase) when \'Direct Forwarding\' applies, or the parameters
received in Step 8a of the preparation phase when \'Indirect Forwarding\'
applies.
The source eNodeB initiates data forwarding for bearers specified in the
\"Bearers Subject to Data Forwarding List\". The data forwarding may go
directly to target RNC or alternatively go via the Serving GW if so decided by
source MME and or/ target SGSN in the preparation phase.
2\. The source eNodeB will give a command to the UE to handover to the target
access network via the message HO from E-UTRAN Command. This message includes
a transparent container including radio aspect parameters that the target RNC
has set-up in the preparation phase. The details of this E-UTRAN specific
signalling are described in TS 36.300 [5].
Upon the reception of the HO from E-UTRAN Command message containing the
Handover Command message, the UE shall associate its bearer IDs to the
respective RABs based on the relation with the NSAPI and shall suspend the
uplink transmission of the user plane data.
3\. Void.
4\. The UE moves to the target UTRAN Iu (3G) system and executes the handover
according to the parameters provided in the message delivered in step 2. The
procedure is the same as in step 6 and 8 in clause 5.2.2.2 in TS 43.129 [8]
with the additional function of association of the received RABs and existing
Bearer Id related to the particular NSAPI.
The UE may resume the user data transfer only for those NSAPIs for which there
are radio resources allocated in the target RNC.
The UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\" to
\"GUTI\", if any EPS bearer context activated after the ISR was activated in
the UE exists.
5\. When the new source RNC-ID + S-RNTI are successfully exchanged with the
UE, the target RNC shall send the Relocation Complete message to the target
SGSN. The purpose of the Relocation Complete procedure is to indicate by the
target RNC the completion of the relocation from the source E-UTRAN to the
RNC. After the reception of the Relocation Complete message the target SGSN
shall be prepared to receive data from the target RNC. Each uplink N-PDU
received by the target SGSN is forwarded directly to the Serving GW.
6\. Then the target SGSN knows that the UE has arrived to the target side and
target SGSN informs the source MME by sending the Forward Relocation Complete
Notification (ISR Activated, Serving GW change) message. If indicated, ISR
Activated indicates to the source MME that it shall maintain the UE\'s context
and that it shall activate ISR, which is only possible when the S‑GW is not
changed. The source MME will also acknowledge that information. A timer in
source MME is started to supervise when resources in Source eNodeB and Source
Serving GW (for Serving GW relocation) shall be released.
When the timer expires and ISR Activated is not indicated by the target SGSN
the source MME releases all bearer resources of the UE. If Serving GW change
is indicated and this timer expires the source MME deletes the EPS bearer
resources by sending Delete Session Request (Cause, TEID) messages to the
Source Serving GW. Cause indicates to the Source Serving GW that the Serving
GW changes and the Source Serving GW shall not initiate a delete procedure
towards the PDN GW. If Serving GW change is indicated and ISR has been
activated before this procedure, the cause also indicates to the Source S‑GW
that the Source S‑GW shall delete the bearer resources on the other old CN
node by sending Delete Bearer Request message(s) to that CN node.
Upon receipt of the Forward Relocation Complete Acknowledge message the target
SGSN starts a timer if the target SGSN allocated S‑GW resources for indirect
forwarding.
7\. The target SGSN will now complete the Handover procedure by informing the
Serving GW (for Serving GW relocation this will be the Target Serving GW) that
the target SGSN is now responsible for all the EPS Bearer Contexts the UE has
established. This is performed in the message Modify Bearer Request (SGSN
Tunnel Endpoint Identifier for Control Plane, NSAPI(s), SGSN Address for
Control Plane, SGSN Address(es) and TEID(s) for User Traffic for the accepted
EPS bearers (if Direct Tunnel is not used) or RNC Address(es) and TEID(s) for
User Traffic for the accepted EPS bearers (if Direct Tunnel is used), PDN GW
addresses and TEIDs (for GTP-based S5/S8) or GRE keys (for PMIP-based S5/S8)
at the PDN GW(s) for uplink traffic and RAT type, ISR Activated) per PDN
connection. If the PDN GW requested UE\'s location info (determined from the
UE context), the SGSN also includes the User Location Information IE in this
message. If indicated, the information ISR Activated indicates that ISR is
activated, which is only possible when the S‑GW is not changed. When the
Modify Bearer Request does not indicate ISR Activated and S‑GW is not changed,
the S‑GW deletes any ISR resources by sending a Delete Bearer Request to the
other CN node that has bearer resources on the S‑GW reserved.
The SGSN releases the non-accepted EPS Bearer contexts by triggering the
Bearer Context deactivation procedure. If the Serving GW receives a DL packet
for a non-accepted bearer, the Serving GW drops the DL packet and does not
send a Downlink Data Notification to the SGSN.
8\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) may inform the PDN GW(s) the change of for example for Serving GW
relocation or the RAT type that e.g. can be used for charging, by sending the
message Modify Bearer Request per PDN connection. The S‑GW also includes User
Location Information IE if it is present in step 7. For Serving GW relocation,
the Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers. The
PDN GW must acknowledge the request with the message Modify Bearer Response.
In the case of Serving GW relocation, the PDN GW updates its context field and
returns a Modify Bearer Response (Charging Id, MSISDN, etc.) message to the
Serving GW. The MSISDN is included if the PDN GW has it stored in its UE
context.
If PCC infrastructure is used, the PDN GW informs the PCRF about the change
of, for example, the RAT type.
9\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) acknowledges the user plane switch to the target SGSN via the message
Modify Bearer Response (Cause, Serving GW Tunnel Endpoint Identifier for
Control Plane, Serving GW Address for Control Plane, Protocol Configuration
Options). At this stage the user plane path is established for all EPS Bearer
contexts between the UE, target RNC, target SGSN if Direct Tunnel is not used,
Serving GW (for Serving GW relocation this will be the Target Serving GW) and
PDN GW.
If the Serving GW does not change, the Serving GW shall send one or more \"end
marker\" packets on the old path immediately after switching the path.
10\. When the UE recognises that its current Routing Area is not registered
with the network, or when the UE\'s TIN indicates \"GUTI\", the UE initiates a
Routing Area Update procedure with the target SGSN informing it that the UE is
located in a new routing area. It is RAN functionality to provide the PMM-
CONNECTED UE with Routing Area information.
The target SGSN knows that an IRAT Handover has been performed for this UE as
it received the bearer context(s) by handover messages and therefore the
target SGSN performs only a subset of the RAU procedure, specifically it
excludes the context transfer procedures between source MME and target SGSN.
11\. When the timer started at step 6 expires, the source MME sends a Release
Resources message to the Source eNodeB. The Source eNodeB releases its
resources related to the UE.
When the timer started in step 6 expires and if the source MME received the
Serving GW change indication in the Forward Relocation Response message, it
deletes the EPS bearer resources by sending Delete Session Request (Cause,
TEID) messages to the Source Serving GW. Cause indicates to the Source Serving
GW that the Source Serving GW shall not initiate a delete procedure towards
the PDN GW. The Source Serving GW acknowledges with Delete Session Response
(TEID) messages. If ISR has been activated before this procedure, the cause
also indicates to the Source S‑GW that the Source S‑GW shall delete the bearer
resources on the other old CN node by sending Delete Bearer Request message(s)
to that CN node.
12\. If indirect forwarding was used then the expiry of the timer at source
MME started at step 6 triggers the source MME to send a Delete Indirect Data
Forwarding Tunnel Request message to the S‑GW to release the temporary
resources used for indirect forwarding.
13\. If indirect forwarding was used and the Serving GW is relocated, then the
expiry of the timer at target SGSN started at step 6 triggers the target SGSN
to send a Delete Indirect Data Forwarding Tunnel Request message to the target
S GW to release temporary resources used for indirect forwarding.
##### 5.5.2.1.4 E-UTRAN to UTRAN Iu mode Inter RAT handover Reject
The Target RNC may reject the use of the Handover procedure if none of the
requested RABs in the Relocation Request message could be established. In this
case no UE context is established in the target SGSN/RNC and no resources are
allocated. The UE remains in the Source eNodeB/MME.
Figure 5.5.2.1.4-1: E-UTRAN to UTRAN Iu mode Inter RAT HO reject
1\. The Step 1 to 5 in the flow are identical to the ones in clause 5.5.2.1.2.
6\. If the Target RNC fails to allocate any resources for any of the requested
RABs it sends a Relocation Failure (Cause) message to the Target SGSN. When
the Target SGSN receives the Relocation Failure message from Target RNC the
Target SGSN clears any reserved resources for this UE.
7\. This step is only performed for Serving GW relocation, i.e. if Steps 4/4a
have been performed. The Target SGSN deletes the EPS bearer resources by
sending Delete Session Request (Cause, TEID) messages to the Target Serving
GW. The Target Serving GW acknowledges with Delete Session Response (TEID)
messages.
8\. The Target SGSN sends the Forward Relocation Response (Cause) message to
the Source MME.
9\. When the Source MME receives the Forward Relocation Response message it
send a Handover Preparation Failure (Cause) message to the Source eNodeB.
#### 5.5.2.2 UTRAN Iu mode to E-UTRAN Inter RAT handover
##### 5.5.2.2.1 General
The UTRAN Iu mode to E-UTRAN Inter RAT handover procedure takes place when the
network decides to perform a handover. The decision to perform PS handover
from UTRAN Iu mode to E-UTRAN is taken by the network based on radio condition
measurements reported by the UE to the UTRAN RNC.
##### 5.5.2.2.2 Preparation phase
Figure 5.5.2.2.2-1: UTRAN Iu mode to E-UTRAN Inter RAT HO, preparation phase
1\. The source RNC decides to initiate an Inter-RAT handover to the E-UTRAN.
At this point both uplink and downlink user data is transmitted via the
following: Bearers between UE and source RNC, GTP tunnel(s) between source
RNC, source SGSN (only if Direct Tunnel is not used), Serving GW and PDN GW.
NOTE 1: The process leading to the handover decision is outside of the scope
of this specification.
2\. The source RNC sends a Relocation Required (Cause, Target eNodeB
Identifier, Source RNC Identifier, Source RNC to Target RNC Transparent
Container) message to the source SGSN to request the CN to establish resources
in the target eNodeB, Target MME and the Serving GW. The bearers that will be
subject to data forwarding (if any) are identified by the target MME in a
later step (see step 7 below).
3\. The source SGSN determines from the \'Target eNodeB Identifier\' IE that
the type of handover is IRAT Handover to E-UTRAN. The Source SGSN initiates
the Handover resource allocation procedure by sending Forward Relocation
Request (IMSI, Target Identification, MM Context, PDN Connections, SGSN Tunnel
Endpoint Identifier for Control Plane, SGSN Address for Control plane, Source
to Target Transparent Container, RAN Cause, MS Info Change Reporting Action
(if available), ISR Supported) message to the target MME. This message
includes all EPS Bearer contexts corresponding to all the bearers established
in the source system and the uplink Tunnel endpoint parameters of the Serving
GW. If the information ISR Supported is indicated, this indicates that the
source SGSN is capable to activate ISR for the UE. When ISR is activated the
message should be sent to the MME that maintains ISR for the UE when this MME
is serving the target identified by the Target Identification. RAN Cause
indicates the Cause as received from source RNC. The Source to Target
Transparent Container contains the value from the Source RNC to Target RNC
Transparent Container received from the Source RNC.
This message includes all PDN Connections active in the source system and for
each PDN Connection includes the associated APN, the address and the uplink
tunnel endpoint parameters of the Serving GW for control plane, and a list of
EPS Bearer Contexts.
Prioritization of EPS Bearer Contexts is performed by the target core network
node.
The MM context contains security related information, e.g. UE Network
capabilities and used UMTS integrity and ciphering algorithm(s) as well as
keys, as described in clause 5.7.2 (Information Storage for MME).
The target MME selects the NAS ciphering and integrity algorithm to use. These
algorithms will be sent transparently from the target eNodeB to the UE in the
Target to Source Transparent Container (EPC part).
The MME establishes the EPS bearer(s) in the prioritized order. The MME
deactivates the EPS bearers which cannot be established.
The target MME shall determine the Maximum APN restriction based on the APN
Restriction of each bearer context received in the Forward Relocation Request,
and shall subsequently store the new Maximum APN restriction value.
4\. The target MME determines if the Serving GW is to be relocated, e.g., due
to PLMN change. If the Serving GW is to be relocated, the target MME selects
the target Serving GW as described under clause 4.3.8.2 on \"Serving GW
selection function\". The target MME sends a Create Session Request message
(IMSI, MME Address and TEID, MME Tunnel Endpoint Identifier for Control Plane,
MME Address for Control plane, PDN GW address(es) for user plane, PDN GW UL
TEID(s) for user plane, PDN GW address for control plane, and PDN GW TEID(s)
for control plane, the Protocol Type over S5/S8) per PDN connection to the
target Serving GW. The Protocol Type over S5/S8 is provided to Serving GW
which protocol should be used over S5/S8 interface.
4a. The target Serving GW allocates its local resources and returns them in a
Create Session Response (Serving GW address(es) for user plane, Serving GW UL
TEID(s) for user plane, Serving GW Address for control plane, Serving GW TEID
for control plane) message to the target MME.
5\. The target MME requests the target eNodeB to establish the bearer(s) by
sending the message Handover Request (UE Identifier, S1AP Cause, K~eNB~,
allowed AS Integrity Protection and Ciphering algorithm(s), NAS Security
Parameters to E-UTRAN, EPS Bearers to be setup list, Source to Target
Transparent Container). NAS Security Parameters to E‑UTRAN includes the NAS
Integrity Protection and Ciphering algorithm(s), eKSI and NONCE~MME~ are
targeted for the UE. S1AP Cause indicates the RAN Cause as received from
source SGSN. The Source to Target Transparent Container contains the value
from the RAN Transparent Container received from the source SGSN.
NOTE 2: The target MME derives K\'~ASME~ from CK and IK in the MM context and
associates it with eKSI, as described in TS 33.401 [41] and selects NAS
Integrity Protection and Ciphering algorithm(s). The MME and UE derive the NAS
keys and K~eNB~ from K\'~ASME~. If the MME shares an EPS security association
with the UE, the MME may activate this native EPS security context by
initiating a NAS SMC procedure after having completed the handover procedure.
For each EPS bearer requested to be established, \'EPS Bearers To Be Setup\'
IE shall contain information such as ID, bearer parameters, Transport Layer
Address and S1 Transport Association. The target MME ignores any Activity
Status Indicator within an EPS Bearer Context and requests the target eNodeB
to allocate resources for all EPS Bearer Contexts received from the source
side. The Transport Layer Address is the Serving GW Address for user data, and
the S1 Transport Association corresponds to the uplink Tunnel Endpoint
Identifier Data.
The information about the selected NAS ciphering and integrity protection
algorithm(s), eKSI and NONCE~MME~ will be sent transparently from the target
eNodeB to the UE in the Target to Source Transparent Container, and in the
message UTRAN HO Command from source RNC to the UE. This will then allow data
transfer to continue in the new RAT/mode target cell without requiring a new
AKA (Authentication and Key Agreement) procedure. More details are described
in TS 33.401 [41].
5a. The target eNodeB allocates the requested resources and returns the
applicable parameters to the target MME in the message Handover Request
Acknowledge (Target to Source Transparent Container, EPS Bearers setup list,
EPS Bearers failed to setup list). The target eNodeB shall ignore it if the
number of radio bearers in the Source to Target Transparent container does not
comply with the number of bearers requested by the MME and allocate bearers as
requested by the MME. Upon sending the Handover Request Acknowledge message
the target eNodeB shall be prepared to receive downlink GTP PDUs from the
Serving GW for the accepted EPS bearers.
The target eNodeB selects AS integrity and ciphering algorithm(s). In addition
to the information provided by the MME (eKSI, NAS Integrity Protection and
Ciphering algorithm(s) and NONCE~MME~), the target eNodeB inserts AS integrity
and ciphering algorithm(s) into the UTRAN RRC message, which is contained in
the Target to Source Transparent Container.
6\. If \'Indirect Forwarding\' and relocation of Serving GW apply, the target
MME sends a Create Indirect Data Forwarding Tunnel Request message (Target
eNodeB Address, addresses and TEID(s) for DL data forwarding) to the Serving
GW.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
6a. The Serving GW returns a Create Indirect Data Forwarding Tunnel Response
(Cause, Serving GW Address(es) and Serving GW DL TEID(s) for data forwarding)
message to the target MME.
7\. The target MME sends the message Forward Relocation Response (Cause, List
of Set Up RABs, MME Tunnel Endpoint Identifier for Control Plane, RAN Cause,
MME Address for control plane, Target to Source Transparent Container,
Address(es) and TEID(s) for Data Forwarding, Serving GW change indication) to
the source SGSN. Serving GW change indication indicates whether a new Serving
GW has been selected. The Target to Source Transparent Container includes the
value from the Target to Source Transparent Container received from the target
eNodeB.
The IE \'Address(es) and TEID(s) for Data Forwarding\' defines the destination
tunnelling endpoint for data forwarding in target system, and it is set as
follows. If \'Direct Forwarding\' applies or if \'Indirect Forwarding\' but no
relocation of Serving GW applies, then the IEs \'Address(es) and TEID(s) for
Data Forwarding\' contains the forwarding DL GTP-U tunnel endpoint parameters
to the eNodeB received in step 5a.
If \'Indirect Forwarding\' and relocation of Serving GW apply, the IEs
\'Address(es) and TEID(s) for Data Forwarding\' contains the DL GTP-U tunnel
endpoint parameters to the Target eNodeB or to the forwarding Serving GW
received in step 6a.
8\. If \"Indirect Forwarding\" applies, the source SGSN shall send the message
Create Indirect Data Forwarding Tunnel Request (Address(es) and TEID(s) for
Data Forwarding (received in step 7)) to the Serving GW used for indirect
forwarding.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
8a. The Serving GW returns the forwarding user plane parameters by sending the
message Create Indirect Data Forwarding Tunnel Response (Cause, Serving GW
Address(es) and TEID(s) for DL Data Forwarding). If the Serving GW doesn\'t
support data forwarding, an appropriate cause value shall be returned and the
Serving GW Address(es) and TEID(s) will not be included in the message.
##### 5.5.2.2.3 Execution phase
Figure 5.5.2.2.3-1: UTRAN Iu mode to E-UTRAN Inter RAT HO, execution phase
NOTE: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2]. Step (B) shows PCRF interaction in the case of PMIP-based S5/S8.
Steps 9 and 9a concern GTP based S5/S8.
The source RNC continues to receive downlink and uplink user plane PDUs.
1\. The source SGSN completes the preparation phase towards source RNC by
sending the message Relocation Command (Target RNC to Source RNC Transparent
Container, RABs to be Released List, RABs Subject to Data Forwarding List).
The \"RABs to be Released list\" IE will be the list of all NSAPIs (RAB Ids)
for which a Bearer was not established in Target eNodeB. The \"RABs Subject to
Data forwarding list\" IE may be included in the message and it shall be a
list of \'Address(es) and TEID(s) for user traffic data forwarding\' received
from target side in step 7 of the preparation phase when \'Direct Forwarding\'
applies. If \'Indirect Forwarding\' is applicable and Direct Tunnel is used
the \"RABs Subject to Data Forwarding List\" IE includes the parameters
received in Step 8a of the preparation phase. If \'Indirect Forwarding\' is
applicable and Direct Tunnel is not used the \"RABs Subject to Data Forwarding
List\" IE includes the source SGSN address(es) and TEID(s) allocated for
indirect data forwarding by Source SGSN. The Target RNC to Source RNC
Transparent Container contains the value from the Target to Source Transparent
Container received from the target MME.
2\. The source RNC will command to the UE to handover to the target eNodeB via
the message HO from UTRAN Command. The access network specific message to UE
includes a transparent container including radio aspect parameters that the
target eNodeB has set-up in the preparation phase.
The source RNC may initiate data forwarding for the indicated RABs/EPS Bearer
contexts specified in the \"RABs Subject to Data Forwarding List\". The data
forwarding may go directly to target eNodeB, or alternatively go via the
Serving GW if so decided by source SGSN and/or target MME in the preparation
phase.
Upon the reception of the HO from UTRAN Command message containing the
Relocation Command message, the UE shall associate its RAB IDs to the
respective bearers ID based on the relation with the NSAPI and shall suspend
the uplink transmission of the user plane data.
3\. Void.
4\. The UE moves to the E-UTRAN and performs access procedures toward target
eNodeB.
The UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\" to
\"P-TMSI\", if any PDP context activated after the ISR was activated in the UE
exists.
5\. When the UE has got access to target eNodeB it sends the message HO to
E-UTRAN Complete.\ The UE shall implicitly derive the EPS bearers for which an
E-RAB was not established from the HO from UTRAN Command and deactivate them
locally without an explicit NAS message at this step.
6\. When the UE has successfully accessed the target eNodeB, the target eNodeB
informs the target MME by sending the message Handover Notify (TAI+ECGI).
7\. Then the target MME knows that the UE has arrived to the target side and
target MME informs the source SGSN by sending the Forward Relocation Complete
Notification (ISR Activated, Serving GW change) message. If ISR Activated is
indicated, this indicates to the source SGSN that it shall maintain the UE\'s
contexts and activate ISR, which is only possible when the S‑GW is not
changed. The source SGSN shall also acknowledge that information. A timer in
source SGSN is started to supervise when resources in the in Source RNC and
Source Serving GW (for Serving GW relocation) shall be released
Upon receipt of the Forward Relocation Complete Acknowledge message the target
MME starts a timer if the target MME applies indirect forwarding.
8\. The target MME will now complete the Inter-RAT Handover procedure by
informing the Serving GW (for Serving GW relocation this will be the Target
Serving GW) that the target MME is now responsible for all the bearers the UE
have established. This is performed in the message Modify Bearer Request
(Cause, MME Tunnel Endpoint Identifier for Control Plane, EPS Bearer ID, MME
Address for Control Plane, eNodeB Address(es) and TEID(s) for User Traffic for
the accepted EPS bearers, PDN GW addresses and TEIDs (for GTP-based S5/S8) or
GRE keys (for PMIP-based S5/S8) at the PDN GW(s) for uplink traffic and RAT
type, ISR Activated) per PDN connection. If the PDN GW requested UE\'s
location info (determined from the UE context), the MME also includes the User
Location Information IE in this message. If indicated, the information ISR
Activated indicates that ISR is activated, which is only possible when the
S‑GW was not changed. When the Modify Bearer Request does not indicate ISR
Activated and S‑GW is not changed, the S‑GW deletes any ISR resources by
sending a Delete Bearer Request to the other CN node that has bearer resources
on the S‑GW reserved.
The MME releases the non-accepted bearers by triggering the bearer release
procedure as specified in clause 5.4.4.2. If the Serving GW receives a DL
packet for a non-accepted bearer, the Serving GW drops the DL packet and does
not send a Downlink Data Notification to the MME.
9\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) may inform the PDN GW the change of for example for Serving GW relocation
or the RAT type that e.g. can be used for charging, by sending the message
Modify Bearer Request per PDN connection. The S‑GW also includes User Location
Information IE if it is present in step 8. For Serving GW relocation, the
Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers. The PDN
GW must acknowledge the request with the message Modify Bearer Response. In
the case of Serving GW relocation, the PDN GW updates its context field and
returns a Modify Bearer Response (Charging Id, MSISDN, etc.) message to the
Serving GW. The MSISDN is included if the PDN GW has it stored in its UE
context.
If PCC infrastructure is used, the PDN GW informs the PCRF about the change
of, for example, the RAT type.
10\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) acknowledges the user plane switch to the target MME via the message
Modify Bearer Response (Cause, Serving GW Tunnel Endpoint Identifier for
Control Plane, Serving GW Address for Control Plane, Protocol Configuration
Options). At this stage the user plane path is established for all bearers
between the UE, target eNodeB, Serving GW (for Serving GW relocation this will
be the Target Serving GW) and PDN GW.
If the Serving GW does not change, the Serving GW shall send one or more \"end
marker\" packets on the old path immediately after switching the path in order
to assist the reordering function in the target eNodeB.
11\. The UE initiates a Tracking Area Update procedure when one of the
conditions listed in clause \"Triggers for tracking area update\" applies.
The target MME knows that an IRAT Handover has been performed for this UE as
it received the bearer context(s) by handover messages and therefore the
target MME performs only a subset of the TA update procedure, specifically it
excludes the context transfer procedures between source SGSN and target MME.
12\. When the timer started in step 7 expires the source SGSN will clean‑up
all its resources towards source RNC by performing the Iu Release procedures.
When there is no longer any need for the RNC to forward data, the source RNC
responds with an Iu Release Complete message.
When the timer started in step 7 expires and if the source SGSN received the
Serving GW change indication in the Forward Relocation Response message, it
deletes the EPS bearer resources by sending Delete Session Request (Cause,
TEID) messages to the Source Serving GW. Cause indicates to the Source Serving
GW that the Serving GW changes and the Source Serving GW shall not initiate a
delete procedure towards the PDN GW. The Source Serving GW acknowledges with
Delete Session Response (TEID) messages. If ISR has been activated before this
procedure, the cause also indicates to the Source S‑GW that the Source S‑GW
shall delete the bearer resources on the other old CN node by sending Delete
Bearer Request message(s) to that CN node.
13\. If indirect forwarding was used then the expiry of the timer at source
SGSN started at step 7 triggers the source SGSN to send a Delete Indirect Data
Forwarding Tunnel Request message to the S‑GW to release the temporary
resources used for indirect forwarding.
14\. If indirect forwarding was used and the Serving GW is relocated, then the
expiry of the timer at target MME started at step 7 triggers the target MME to
send a Delete Indirect Data Forwarding Tunnel Request message to the target
S‑GW to release temporary resources used for indirect forwarding.
##### 5.5.2.2.4 UTRAN Iu mode to E-UTRAN Inter RAT handover reject
The Target eNodeB may reject the use of the Handover procedure if none of the
requested EPS bearers in the Handover Request message could be established. In
this case no UE context is established in the target MME/eNodeB and no
resources are allocated. The UE remains in the Source RNC/SGSN.
Figure 5.5.2.2.4-1: UTRAN Iu mode to E-UTRAN Inter RAT HO reject
1\. Steps 1 to 5 in the flow are identical to the ones in clause 5.5.2.2.2.
6\. If the Target eNodeB fails to allocate any resources for any of the
requested EPS Bearers it sends a Handover Failure (Cause) message to the
Target MME. When the Target MME receives the Handover Failure message from
Target eNodeB the Target MME clears any reserved resources for this UE.
7\. This step is only performed for Serving GW relocation, i.e. if Steps 4/4a
have been performed. The Target MME deletes the EPS bearer resources by
sending Delete Session Request (Cause, TEID) messages to the Target Serving
GW. The Target Serving GW acknowledges with Delete Session Response (TEID)
messages.
8\. The Target MME sends the Forward Relocation Response (Cause) message to
the Source SGSN.
9\. When the Source SGSN receives the Forward Relocation Response message it
send a Relocation Preparation Failure (Cause) message to the Source RNC.
#### 5.5.2.3 E-UTRAN to GERAN A/Gb mode Inter RAT handover
##### 5.5.2.3.1 General
The procedure is based on Packet-switched handover for GERAN A/Gb mode defined
in TS 43.129 [8].
Pre-conditions:
\- The UE is in ECM-CONNECTED state (E-UTRAN mode);
\- The BSS must support PFM, Packet Flow Management, procedures.
##### 5.5.2.3.2 Preparation phase
Figure 5.5.2.3.2-1: E-UTRAN to GERAN A/Gb Inter RAT HO, preparation phase
1\. The source eNodeB decides to initiate an Inter RAT Handover to the target
GERAN A/Gb mode (2G) system. At this point both uplink and downlink user data
is transmitted via the following: Bearer(s) between UE and Source eNodeB, GTP
tunnel(s) between Source eNodeB, Serving GW and PDN GW.
NOTE 1: The process leading to the handover decision is outside of the scope
of this specification
2\. The source eNodeB sends a Handover Required (S1AP Cause, Target System
Identifier, Source eNodeB Identifier, Source to Target Transparent Container)
message to the Source MME to request the CN to establish resources in the
Target BSS, Target SGSN and the Serving GW. The bearers that will be subject
to data forwarding (if any) are identified by the target SGSN in a later step
(see step 7 below).
The \'Target System Identifier\' IE contains the identity of the target global
cell Id.
3\. The Source MME determines from the \'Target System Identifier\' IE that
the type of handover is IRAT Handover to GERAN A/Gb mode. The Source MME
initiates the Handover resource allocation procedure by sending a Forward
Relocation Request (IMSI, Target Identification (shall be set to \"empty\"),
MM Context, PDN Connections, MME Tunnel Endpoint Identifier for Control Plane,
MME Address for Control plane, Source to Target Transparent Container, Packet
Flow ID, XID parameters (if available), Target Cell Identification, MS Info
Change Reporting Action (if available), ISR Supported, TI(s), RAN Cause)
message to the target SGSN. If the information ISR Supported is indicated,
this indicates that the source MME is capable to activate ISR for the UE. When
ISR is activated the message should be sent to the SGSN that maintains ISR for
the UE when this SGSN is serving the target identified by the Target
Identification. This message includes all PDN Connections active in the source
system and for each PDN Connection includes the associated APN, the address
and the uplink Tunnel endpoint parameters of the Serving GW for control plane,
and a list of EPS Bearer Contexts.
The target SGSN maps the EPS bearers to PDP contexts 1-to-1 and maps the EPS
Bearer QoS parameter values of an EPS bearer to the pre-Rel-8 QoS parameter
values of a bearer context as defined in Annex E.
Prioritization of PDP Contexts is performed by the target core network node,
i.e. target SGSN.
If the Source MME supports IRAT Handover to GERAN A/Gb procedure it has to
allocate a valid PFI during the bearer activation procedure. RAN Cause
indicates the S1AP Cause as received from the source eNodeB. The Source to
Target Transparent Container includes the value from the Source to Target
Transparent Container received from the source eNodeB.
The MM context contains security related information, e.g. supported ciphering
algorithms, as described in TS 29.274 [43]. Handling of security keys is
described in TS 33.401 [41].
The target SGSN selects the ciphering algorithm to use. This algorithm will be
sent transparently from the target SGSN to the UE in the NAS container for
Handover (part of the Target to Source Transparent Container). The IOV-UI
parameter, generated in the target SGSN, is used as input to the ciphering
procedure and it will also be transferred transparently from the target SGSN
to the UE in the NAS container for Handover. More details are described in TS
33.401 [41].
When the target SGSN receives the Forward Relocation Request message the
required EPS Bearer, MM, SNDCP and LLC contexts are established and a new
P-TMSI is allocated for the UE. When this message is received by the target
SGSN, it begins the process of establishing PFCs for all EPS Bearer contexts.
When the target SGSN receives the Forward Relocation Request message it
extracts from the EPS Bearer Contexts the NSAPIs and SAPIs and PFIs to be used
in the target SGSN. If for a given EPS Bearer Context the target SGSN does not
receive a PFI from the source MME, it shall not request the target BSS to
allocate TBF resources corresponding to that EPS Bearer Context. If none of
the EPS Bearer Contexts forwarded from the source MME has a valid PFI
allocated the target SGSN shall consider this as a failure case and the
request for Handover shall be rejected.
If when an SAPI and PFI was available at the source MME but the target SGSN
does not support the same SAPI and PFI for a certain NSAPI as the source MME,
the target SGSN shall continue the Handover procedure only for those NSAPIs
for which it can support the same PFI and SAPI as the source MME. All EPS
Bearer contexts for which no resources are allocated by the target SGSN or for
which it cannot support the same SAPI and PFI (i.e. the corresponding NSAPIs
are not addressed in the response message of the target SGSN), are maintained
and the related SAPIs and PFIs are kept. These EPS Bearer contexts may be
modified or deactivated by the target SGSN via explicit SM procedures upon RAU
procedure.
The source MME shall indicate the current XID parameter settings if available
(i.e. those XID parameters received during a previous IRAT Handover procedure)
to the target SGSN. If the target SGSN can accept all XID parameters as
indicated by the source MME, the target SGSN shall create a NAS container for
Handover indicating \'Reset to the old XID parameters\'. Otherwise, if the
target SGSN cannot accept all XID parameters indicated by the source MME or if
no XID parameters were indicated by the source MME, the target SGSN shall
create a NAS container for Handover indicating Reset (i.e. reset to default
parameters).
The target SGSN shall determine the Maximum APN restriction based on the APN
Restriction of each bearer context in the Forward Relocation Request, and
shall subsequently store the new Maximum APN restriction value.
4\. The target SGSN determines if the Serving GW is to be relocated, e.g., due
to PLMN change. If the Serving GW is to be relocated, the target SGSN selects
the target Serving GW as described under clause 4.3.8.2 on \"Serving GW
selection function\", and sends a Create Session Request message (IMSI, SGSN
Tunnel Endpoint Identifier for Control Plane, SGSN Address for Control plane,
PDN GW address(es) for user plane, PDN GW UL TEID(s) for user plane, PDN GW
address(es) for control plane, and PDN GW TEID(s) for control plane, the
Protocol Type over S5/S8) per PDN connection to the target Serving GW. The
Protocol Type over S5/S8 is provided to Serving GW which protocol should be
used over S5/S8 interface.
4a. The target Serving GW allocates its local resources and returns a Create
Session Response (Serving GW address(es) for user plane, Serving GW UL TEID(s)
for user plane, Serving GW Address for control plane, Serving GW TEID for
control plane) message to the target SGSN.
5\. The target SGSN establishes the EPS Bearer context(s) in the indicated
order. The SGSN deactivates the EPS Bearer contexts which cannot be
established.
The Target SGSN requests the Target BSS to establish the necessary resources
(PFCs) by sending the message PS Handover Request (Local TLLI, IMSI, Cause,
Target Cell Identifier, PFCs to be set-up list, Source RNC to Target BSS
Transparent Container and NAS container for handover. The target SGSN shall
not request resources for which the Activity Status Indicator within a EPS
Bearer Context indicates that no active bearer exists on the source side for
that PDP context. The Cause indicates the RAN Cause as received from the
source MME. The Source RNC to Target BSS Transparent Container contains the
value from the Source to Target Transparent Container received from the source
MME. All EPS Bearer Contexts indicate active status because E-UTRAN does not
support selective RAB handling.
Based upon the ABQP for each PFC the target BSS makes a decision about which
PFCs to assign radio resources. The algorithm by which the BSS decides which
PFCs that need resources is implementation specific. Due to resource
limitations not all downloaded PFCs will necessarily receive resource
allocation. The target BSS allocates TBFs for each PFC that it can
accommodate.
The target BSS shall prepare the \'Target to Source Transparent Container\'
which contains a PS Handover Command including the EPC part (NAS container for
Handover) and the RN part (Handover Radio Resources).
5a. The Target BSS allocates the requested resources and returns the
applicable parameters to the Target SGSN in the message PS Handover Request
Acknowledge (Local TLLI, List of set-up PFCs, Target BSS to Source RNC
Transparent Container, Cause). Upon sending the PS Handover Request
Acknowledge message the target BSS shall be prepared to receive downlink LLC
PDUs from the target SGSN for the accepted PFCs.
Any EPS Bearer contexts for which a PFC was not established are maintained in
the target SGSN and the related SAPIs and PFIs are kept. These EPS Bearer
contexts shall be deactivated by the target SGSN via explicit SM procedures
upon the completion of the routing area update (RAU) procedure.
6\. If indirect forwarding and relocation of Serving GW applies the target
SGSN sends a Create Indirect Data Forwarding Tunnel Request message (Target
SGSN Address(es) and TEID(s) for DL data forwarding) to the Serving GW used
for indirect packet forwarding.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
6a. The Serving GW returns a Create Indirect Data Forwarding Tunnel Response
(Cause, Serving GW DL Address(es) and TEID(s) for data forwarding) message to
the target SGSN.
7\. The Target SGSN sends the message Forward Relocation Response (Cause, SGSN
Tunnel Endpoint Identifier for Control Plane, SGSN Address for Control Plane,
Target to Source Transparent Container, RAN Cause, List of set-up PFIs,
Address(es) and TEID(s) for User Traffic Data Forwarding, Serving GW change
indication) to the Source MME. Serving GW change indication indicates a new
Serving GW has been selected. RAN Cause indicates the Cause as received from
the target BSS. The Target to Source Transparent Container includes the value
from the Target BSS to Source RNC Transparent Container received from the
target BSS.
If \'Indirect Forwarding\' and relocation of Serving GW applies, then the IEs
\'Address(es) and TEID(s) for User Traffic Data Forwarding\' contain the DL
GTP-U tunnel endpoint parameters received in step 6a. Otherwise the IEs
\'Address(es) and TEID(s) for User Traffic Data Forwarding\' contains the DL
GTP-U tunnel endpoint parameters to the Target SGSN.
The target SGSN activates the allocated LLC/SNDCP engines as specified in TS
44.064 [23] for an SGSN originated Reset or \'Reset to the old XID
parameters\'.
8\. If \"Indirect Forwarding\" applies, the Source MME sends the message
Create Indirect Data Forwarding Tunnel Request (Address(es) and TEID(s) for
Data Forwarding (received in step 7)) to the Serving GW used for indirect
packet forwarding.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
8a. The Serving GW returns the forwarding user plane parameters by sending the
message Create Indirect Data Forwarding Tunnel Response (Cause, Serving GW
Address(es) and TEID(s) for Data Forwarding). If the Serving GW doesn\'t
support data forwarding, an appropriate cause value shall be returned and the
Serving GW Address(es) and TEID(s) will not be included in the message.
##### 5.5.2.3.3 Execution phase
Figure 5.5.2.3.3-1: E-UTRAN to GERAN A/Gb mode Inter RAT HO, execution phase
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) and (B) are defined in TS
23.402 [2]. Step (B) shows PCRF interaction in the case of PMIP-based S5/S8.
Steps 10 and 10a concern GTP based S5/S8
The source eNodeB continues to receive downlink and uplink user plane PDUs.
1\. The Source MME completes the preparation phase towards Source eNodeB by
sending the message Handover Command (Target to Source Transparent Container
(PS Handover Command with RN part and EPC part), E‑RABs to Release List,
Bearers Subject to Data Forwarding List), S1AP Cause. The \"Bearers Subject to
Data forwarding list\" may be included in the message and it shall be a list
of \'Address(es) and TEID(s) for user traffic data forwarding\' received from
target side in the preparation phase (Step 7 of the preparation phase for
Direct Forwarding, else parameters received in Step 8a of the preparation
phase). S1AP Cause indicates the RAN Cause as received from the target SGSN.
Source eNodeB initiate data forwarding for the bearers specified in the
\"Bearers Subject to Data Forwarding List\". The data forwarding may go
directly i.e. to target SGSN or alternatively go via the Serving GW if so
decided by source MME and/or target SGSN in the preparation phase.
2\. The Source eNodeB will give a command to the UE to handover to the Target
Access System via the message HO from E-UTRAN Command. This message includes a
transparent container including radio aspect parameters that the Target BSS
has set-up in the preparation phase (RN part). This message also includes the
XID and IOV-UI parameters received from the Target SGSN (EPC part).
Upon the reception of the HO from E-UTRAN Command message containing the
Handover Command message, the UE shall associate its bearer IDs to the
respective PFIs based on the relation with the NSAPI and shall suspend the
uplink transmission of the user plane data.
3\. Void.
4\. The UE moves to the Target GERAN A/Gb (2G) system and performs executes
the handover according to the parameters provided in the message delivered in
step 2. The procedure is the same as in step 6 in clause 5.3.2.2 in TS 43.129
[8] with the additional function of association of the received PFI and
existing Bearer Id related to the particular NSAPI.
The UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\" to
\"GUTI\", if any EPS bearer context activated after the ISR was activated in
the UE exists.
5\. After accessing the cell using access bursts and receiving timing advance
information from the BSS in step 4, the UE processes the NAS container and
then sends one XID response message to the target SGSN via target BSS. The UE
sends this message immediately after receiving the Packet Physical Information
message containing the timing advance or, in the synchronised network case,
immediately if the PS Handover Access message is not required to be sent.
Upon sending the XID Response message, the UE shall resume the user data
transfer only for those NSAPIs for which there are radio resources allocated
in the target cell. For NSAPIs using LLC ADM, for which radio resources were
not allocated in the target cell, the MS may request for radio resources using
the legacy procedures.
If the Target SGSN indicated XID Reset (i.e. reset to default XID parameters)
in the NAS container included in the HO from E-UTRAN Command message, and to
avoid collision cases the mobile station may avoid triggering XID negotiation
for any LLC SAPI used in LLC ADM, but wait for the SGSN to do so (see step
12). In any case the mobile station may avoid triggering XID negotiation for
any LLC SAPI used in LLC ABM, but wait for the SGSN to do so (see step 12a).
This step is the same as specified in clause 5.3.2.2 in TS 43.129 [8].
6\. Upon reception of the first correct RLC/MAC block (sent in normal burst
format) from the UE to the Target BSS, the Target BSS informs the Target SGSN
by sending the message PS Handover Complete (IMSI, and Local TLLI), Request
for Inter RAT Handover Info). The target BSS that supports inter-RAT PS
handover to UTRAN shall, when the INTER RAT HANDOVER INFO was not included in
the Source BSS to Target BSS transparent container received in the PS HANDOVER
REQUEST message as specified in TS 48.018 [42], request the INTER RAT HANDOVER
INFO from the target SGSN by setting the \'Request for Inter RAT Handover
Info\' to \'1\'.
7\. The Target BSS also relays the message XID Response to the Target SGSN.
Note, the message in step 6 and 7 may arrive in any order in the Target SGSN.
8\. Then the Target SGSN knows that the UE has arrived to the target side and
Target SGSN informs the Source MME by sending the Forward Relocation Complete
Notification (ISR Activated, Serving GW change) message. If ISR Activated is
indicated, the source MME shall maintain the UE\'s contexts and activate ISR,
which is only possible when the S‑GW is not changed. The Source MME will also
acknowledge that information. A timer in source MME is started to supervise
when resources in Source eNodeB and Source Serving GW (for Serving GW
relocation) shall be released.
Upon receipt of the Forward Relocation Complete Acknowledge message the target
SGSN starts a timer if the target SGSN allocated S‑GW resources for indirect
forwarding.
9\. The Target SGSN will now complete the Handover procedure by informing the
Serving GW (for Serving GW relocation this will be the Target Serving GW) that
the Target SGSN is now responsible for all the EPS Bearer Context(s) the UE
has established. This is performed in the message Modify Bearer Request (SGSN
Tunnel Endpoint Identifier for Control Plane, NSAPI(s), SGSN Address for
Control Plane, SGSN Address(es) and TEID(s) for User Traffic for the accepted
EPS bearers, PDN GW addresses and TEIDs (for GTP-based S5/S8) or GRE keys (for
PMIP-based S5/S8) at the PDN GW(s) for uplink traffic and RAT type, ISR
Activated) per PDN connection. If the PDN GW requested UE\'s location info
(determined from the UE context), the SGSN also includes the User Location
Information IE in this message. If indicated, ISR Activated indicates that ISR
is activated, which is only possible when the S‑GW was not changed. When the
Modify Bearer Request does not indicate ISR Activated and S‑GW is not changed,
the S‑GW deletes any ISR resources by sending a Delete Bearer Request to the
other CN node that has bearer resources on the S‑GW reserved.
The SGSN releases the non-accepted EPS Bearer contexts by triggering the EPS
Bearer context deactivation procedure. If the Serving GW receives a DL packet
for a non-accepted bearer, the Serving GW drops the DL packet and does not
send a Downlink Data Notification to the SGSN.
10\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) may inform the PDN GW the change of, for example, for Serving GW
relocation or the RAT type, that e.g. can be used for charging, by sending the
message Modify Bearer Request per PDN connection. The S‑GW also includes User
Location Information IE if it is present in step 9. For Serving GW relocation,
the Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers. The
PDN GW must acknowledge the request with the message Modify Bearer Response.
In the case of Serving GW relocation, the PDN GW updates its context field and
returns a Modify Bearer Response (Charging Id, MSISDN, etc.) message to the
Serving GW. The MSISDN is included if the PDN GW has it stored in its UE
context.
If PCC infrastructure is used, the PDN GW informs the PCRF about the change
of, for example, the RAT type.
11\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) acknowledges the user plane switch to the Target SGSN via the message
Modify Bearer Response (Cause, Serving GW Tunnel Endpoint Identifier for
Control Plane, Serving GW Address for Control Plane, Protocol Configuration
Options). At this stage the user plane path is established for all EPS Bearer
contexts between the UE, Target BSS, Target SGSN, Serving GW (for Serving GW
relocation this will be the Target Serving GW) and PDN GW.
If the Serving GW does not change, the Serving GW shall send one or more \"end
marker\" packets on the old path immediately after switching the path.
12\. If the Target SGSN indicated XID Reset (i.e. reset to default XID
parameters) in the NAS container included in the HO from E-UTRAN Command
message, then on receipt of the PS Handover Complete the Target SGSN initiates
an LLC/SNDCP XID negotiation for each LLC SAPI used in LLC ADM. In this case
if the Target SGSN wants to use the default XID parameters, it shall send an
empty XID Command. If the Target SGSN indicated \'Reset to the old XID
parameters\' in the NAS container, no further XID negotiation is required for
LLC SAPIs used in LLC ADM only.
12a. The Target SGSN (re-)establishes LLC ABM for the EPS Bearer contexts
which use acknowledged information transfer. During the exchange of SABM and
UA the SGSN shall perform LLC/SNDCP XID negotiation.
These steps (12 and 12a) are the same as specified in clause 5.3.2.2 in TS
43.129 [8].
13\. After the UE has finished the reconfiguration procedure the UE shall
initiate the Routing Area Update procedure.
NOTE 2: The RAU procedure is performed regardless if the UE has this routing
area registered or not, as specified by TS 43.129 [8]. This is needed e.g. to
update the START-PS value stored in the 2G-SGSN. The START_PS is delivered to
SGSN in INTER RAT HANDOVER INFO parameter of RAU Complete message when
requested by SGSN in RAU Accepted.
The target SGSN knows that an IRAT Handover has been performed for this UE as
it received the bearer context(s) by handover messages and therefore the
target SGSN performs only a subset of the RAU procedure, specifically it
excludes the context transfer procedures between source MME and target SGSN.
13a. Upon reception of the PS Handover Complete message with the \'Request for
Inter RAT Handover Info\' set to \'1\', the SGSN should send then PS Handover
Complete Acknowledge (TLLI, INTER RAT HANDOVER INFO) to the target BSS.
NOTE 3: A SGSN that does not recognize the \"Request for Inter RAT Handover
Info\" in the PS Handover Complete message will not send the PS Handover
Complete Acknowledge message back to the BSS,
The target BSS receiving the PS Handover Complete Acknowledge message shall
set the \'Reliable INTER RAT HANDOVER\' to \'1\' in the PS Handover Required
message in any subsequent PS handover to GERAN A/Gb mode. The target BSS
failing to receive the PS Handover Complete Acknowledge message shall set the
\'Reliable INTER RAT HANDOVER\' to \'0\' in the PS Handover Required message
in any subsequent PS handover to GERAN A/Gb mode. The Target BSS shall, upon
receipt of the INTER RAT HANDOVER INFO in the PS Handover Complete Acknowledge
message, overwrite its current INTER RAT HANDOVER INFO with this new one.
14\. When the timer started at step 8 expires, the source MME sends a Release
Resources message to the source eNodeB. The Source eNodeB releases its
resources related to the UE.
When the timer started in step 8 expires and if the source MME received the
Serving GW change indication in the Forward Relocation Response message, it
deletes the EPS bearer resources by sending Delete Session Request (Cause,
TEID) messages to the Source Serving GW. Cause indicates to the Source Serving
GW that the Serving GW changes and the Source Serving GW shall not initiate a
delete procedure towards the PDN GW. The Source Serving GW acknowledges with
Delete Session Response (TEID) messages. If ISR has been activated before this
procedure, the cause also indicates to the Source S‑GW that the Source S‑GW
shall delete the bearer resources on the other old CN node by sending Delete
Bearer Request message(s) to that CN node.
15\. If indirect forwarding was used then the expiry of the timer at source
MME started at step 8 triggers the source MME to send a Delete Indirect Data
Forwarding Tunnel Request message to the S‑GW to release the temporary
resources used for indirect forwarding.
16\. If indirect forwarding was used and the Serving GW is relocated, then the
expiry of the timer at target SGSN started at step 8 triggers the target SGSN
to send a Delete Indirect Data Forwarding Tunnel Request message to the target
S‑GW to release temporary resources used for indirect forwarding.
##### 5.5.2.3.4 E-UTRAN to GERAN A/Gb mode Inter RAT handover reject
The Target BSS may reject the use of the Handover procedure if none of the
requested PFCs in the PS Handover Request message could be established. In
this case no UE context is established in the target SGSN/BSS and no resources
are allocated. The UE remains in the Source eNodeB/MME.
Figure 5.5.2.3.4-1: E-UTRAN to GERAN A/Gb Inter RAT HO reject
1\. Steps 1 to 5 in the flow are identical to the ones in clause 5.5.2.3.2.
6\. If the Target BSS fails to allocate any resources for any of the requested
PFCs it sends a PS Handover Request Nack (Cause) message to the Target SGSN.
When the Target SGSN receives the PS Handover Request Nack message from Target
BSS the Target SGSN clears any reserved resources for this UE.
7\. This step is only performed for Serving GW relocation, i.e. if Steps 4/4a
have been performed. The Target SGSN deletes the EPS bearer resources by
sending Delete Session Request (Cause, TEID) messages to the Target Serving
GW. The Target Serving GW acknowledges with Delete Session Response (TEID)
messages.
8\. The Target SGSN sends the Forward Relocation Response (Cause) message to
the Source MME.
9\. When the Source MME receives the Forward Relocation Response message it
send a Handover Preparation Failure (Cause) message to the Source eNodeB.
#### 5.5.2.4 GERAN A/Gb mode to E-UTRAN Inter RAT handover
##### 5.5.2.4.1 General
The procedure is based on Packet-switched handover for GERAN A/Gb mode,
defined in TS 43.129 [8].
Pre-conditions:
\- The UE is in READY state (GERAN A/Gb mode);
\- The UE has at least one PDP/EPS Bearer Context established;
\- The BSS must support PFM, Packet Flow Management, procedures.
##### 5.5.2.4.2 Preparation phase
Figure 5.5.2.4.2-1: GERAN A/Gb mode to E-UTRAN inter RAT HO, preparation phase
1\. The source access system, Source BSS, decides to initiate an Inter-RAT
Handover to the E-UTRAN. At this point both uplink and downlink user data is
transmitted via the following: Bearers between UE and Source BSS, BSSGP PFC
tunnel(s) between source BSS and source SGSN, GTP tunnel(s) between Source
SGSN, Serving GW and PDN GW.
NOTE 1: The process leading to the handover decision is outside of the scope
of this specification.
2\. The source BSS sends the message PS handover Required (TLLI, Cause, Source
Cell Identifier, Target eNodeB Identifier, Source BSS to Target RNC
Transparent Container and active PFCs list) to Source SGSN to request the CN
to establish resources in the Target eNodeB, Target MME and the Serving GW.
3\. The Source SGSN determines from the \'Target eNodeB Identifier\' IE that
the type of handover is IRAT PS Handover to E-UTRAN. The Source SGSN initiates
the Handover resource allocation procedure by sending message Forward
Relocation Request (IMSI, Target Identification, MM Context, PDN Connections,
SGSN Tunnel Endpoint Identifier for Control Plane, SGSN Address for Control
plane, Source to Target Transparent Container, RAN Cause, Packet Flow ID,
SNDCP XID parameters, LLC XID parameters, MS Info Change Reporting Action (if
available), ISR Supported) to the target MME. When ISR is activated the
message should be sent to the MME that maintains ISR for the UE when this MME
is serving the target identified by the Target Identification. If indicated,
the information ISR Supported indicates that the source SGSN is capable to
activate ISR for the UE. This message includes all PDN Connections active in
the source system and for each PDN Connection includes the associated APN, the
address and the uplink tunnel endpoint parameters of the Serving GW for
control plane, and a list of EPS Bearer Contexts established in the source
system. The EPS Bearer Contexts indicate the PFIs and the XID parameters
related to those EPS Bearer Contexts, and the uplink Tunnel endpoint
parameters of the Serving GW.
The RAN Cause includes the value from the Cause IE received from the source
BSS. Source to Target Transparent Container includes the value from the Source
BSS to Target RNC Transparent Container received from the source BSS.
Prioritization of EPS Bearer Contexts is performed by the target core network
node.
The MME establishes the EPS bearer(s) in the prioritized order. The MME
deactivates the EPS bearers which cannot be established.
The MM context contains security related information, e.g. supported ciphering
algorithms as described in TS 29.274 [43]. Handling of security keys is
described in TS 33.401 [41].
For the EPS Bearer Context with traffic class equals \'Background\', the
source SGSN shall indicate via the Activity Status Indicator IE that radio
bearers shall be established on the target side.
The target MME shall determine the Maximum APN restriction based on the APN
Restriction of each bearer context in the Forward Relocation Request, and
shall subsequently store the new Maximum APN restriction value.
4\. The target MME determines if the Serving GW is to be relocated, e.g. due
to PLMN change. If the Serving GW is to be relocated, the target MME selects
the target Serving GW as described under clause 4.3.8.2 on \"Serving GW
selection function\". The target MME sends a Create Session Request message
(IMSI, MME Tunnel Endpoint Identifier for Control Plane, MME Address for
Control plane, PDN GW address(es) for user plane, PDN GW UL TEID(s) for user
plane, PDN GW address for control plane, and PDN GW TEID(s) for control plane,
the Protocol Type over S5/S8) per PDN connection to the target Serving GW. The
Protocol Type over S5/S8 is provided to Serving GW which protocol should be
used over S5/S8 interface.
4a. The target Serving GW allocates its local resources and returns them in a
Create Session Response (Serving GW address(es) for user plane, Serving GW UL
TEID(s) for user plane, Serving GW Address for control plane, Serving GW TEID
for control plane) message to the target MME.
5\. The Target MME will request the Target eNodeB to establish the Bearer(s)
by sending the message Handover Request (UE Identifier, S1AP Cause, Integrity
protection information (i.e. IK and allowed Integrity Protection algorithms),
Encryption information (i.e. CK and allowed Ciphering algorithms), EPS Bearers
to be setup list, Source to Target Transparent Container, Handover Restriction
List). The Target MME ignores any Activity Status Indicator within an EPS
Bearer Context and requests the eNodeB to allocate resources for all EPS
Bearer Contexts received from the source side. The S1AP Cause includes the
value from the RAN Cause IE received from the source SGSN. The target eNodeB
shall ignore it if the number of radio bearers in the Source to Target
Transparent container does not comply with the number of bearers requested by
the MME and allocate bearers as requested by the MME. Handover Restriction
List is sent if it is available in the Target MME; it is described in clause
4.3.5.7.
For each EPS bearer requested to be established, \'EPS Bearers To Be Setup\'
IE shall contain information such as ID, bearer parameters, Transport Layer
Address and S1 Transport Association. The Transport Layer Address is the
Serving GW Address for user data, and the S1 Transport Association corresponds
to the uplink Tunnel Endpoint Identifier Data.
The ciphering and integrity protection keys will be sent transparently from
the target eNodeB to the UE in the Target to Source Transparent Container, and
in the message PS Handover Command from source BSS to the UE. This will then
allow data transfer to continue in the new RAT/mode target cell without
requiring a new AKA (Authentication and Key Agreement) procedure. More details
are described in TS 33.401 [41].
5a. The Target eNodeB allocates the request resources and returns the
applicable parameters to the Target MME in the message Handover Request
Acknowledge (Target to Source Transparent Container, S1AP Cause, EPS Bearers
setup list, EPS Bearers failed to setup list). Upon sending the Handover
Request Acknowledge message the target eNodeB shall be prepared to receive
downlink GTP PDUs from the Serving GW for the accepted EPS bearers.
6\. If \'Indirect Forwarding\' and relocation of Serving GW apply, the target
MME sends a Create Indirect Data Forwarding Tunnel Request message (Target
eNodeB Address(es) and TEID(s) for DL data forwarding) to the Serving GW.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
6a. The Serving GW returns a Create Indirect Data Forwarding Tunnel Response
(Cause, Serving GW Address(es) and DL TEID(s) for data forwarding) message to
the target MME.
7\. The Target MME sends the message Forward Relocation Response (Cause, List
of Set Up PFCs, MME Tunnel Endpoint Identifier for Control Plane, RAN Cause,
MME Address for control plane, Target to Source Transparent Container,
Address(es) and TEID(s) for Data Forwarding, Serving GW change indication) to
the Source SGSN. Serving GW change indication indicates whether a new Serving
GW has been selected. The RAN Cause includes the value from the S1AP Cause IE
received from the target eNodeB. The Target to Source Transparent Container
includes the value from the Target to Source Transparent Container received
from the target eNodeB.
If \'Direct Forwarding\' applies or if \'Indirect Forwarding\' but no
relocation of Serving GW applies, then the IEs \'Address(es) and TEID(s) for
Data Forwarding\' contains the DL GTP-U tunnel endpoint parameters to the
eNodeB received in step 5a. If \'Indirect Forwarding\' and relocation of
Serving GW apply, the IEs \'Address(es) and TEID(s) for Data Forwarding\'
contain the DL GTP-U tunnel endpoint parameters to the Serving GW received in
step 6a.
8\. If \'Indirect Forwarding\' applies, the source SGSN shall send the message
Create Indirect Data Forwarding Tunnel Request (Address(es) and TEID(s) for
Data Forwarding (received in step 7)) to the Serving GW used for indirect
packet forwarding.
Indirect forwarding may be performed via a Serving GW which is different from
the Serving GW used as the anchor point for the UE.
8a. The Serving GW returns the forwarding user plane parameters by sending the
message Create Indirect Data Forwarding Tunnel Response (Cause, Serving GW
Address(es) and TEID(s) for Data Forwarding). If the Serving GW doesn\'t
support data forwarding, an appropriate cause value shall be returned and the
Serving GW Address(es) and TEID(s) will not be included in the message.
##### 5.5.2.4.3 Execution phase
Figure 5.5.2.4.3-1: GERAN A/Gb mode to E-UTRAN Inter RAT HO, execution phase
NOTE: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 9 and 9a concern GTP based S5/S8.
The source SGSN continues to receive downlink and uplink user plane PDUs.
When source SGSN receives the Forward Relocation Response message it may start
downlink N-PDU relay and duplication to the target eNodeB (for Direct
Forwarding) or via the Serving GW (for Indirect Forwarding), and the target
eNodeB may start blind transmission of downlink user data towards the UE over
the allocated radio channels.
1\. The Source SGSN completes the preparation phase towards Source BSS by
sending the message PS HO Required Acknowledge (TLLI, List of Set Up PFCs,
Target RNC to Source BSS Transparent Container, Cause). This message includes
all PFIs that could be established on the Target side. The Cause includes the
value from the RAN Cause IE received from the target MME. The Target RNC to
Source BSS Transparent Container includes the value from the Target to Source
Transparent Container received from the target MME.
Before sending the PS Handover Required Acknowledge message, the source SGSN
may suspend downlink data transfer for any EPS Bearer contexts.
Before sending the PS Handover Command message to the UE the source BSS, may
try to empty the downlink BSS buffer for any BSS PFCs.
2\. The Source BSS will command the UE to handover to the target eNodeB via
the message PS Handover Command. The access system specific message to UE
includes a transparent container including radio aspect parameters that the
Target eNodeB has set-up in the preparation phase.
3\. Void.
4\. The UE moves to the E-UTRAN and performs access procedures toward Target
eNodeB.
The UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\" to
\"P-TMSI\", if any PDP context activated after the ISR was activated in the UE
exists.
5\. When the UE has got access to Target eNodeB it sends the message HO to
E-UTRAN Complete.\ The UE shall implicitly derive the EPS bearers for which an
E-RAB was not established from the PS Handover Command and deactivate them
locally without an explicit NAS message at this step.
6\. When the UE has successfully accessed the Target eNodeB, the Target eNodeB
informs the Target MME by sending the message Handover Notify (TAI+ECGI).
Upon receipt of the Handover Notify message the target MME starts a timer if
the target MME applies indirect forwarding.
7\. Then the Target MME knows that the UE has arrived to the target side and
Target MME informs the Source SGSN by sending the Forward Relocation Complete
Notification (ISR Activated, Serving GW change) message. If indicated, ISR
Activated indicates to the source SGSN that it shall maintain the UE\'s
contexts and activate ISR, which is only possible when the S‑GW is not
changed. The Source SGSN shall also acknowledge that information. When the
Forward Relocation Complete Notification message has been received and there
is no longer any need for the SGSN to forward data, the SGSN stops data
forwarding. A timer in source SGSN is started to supervise when resources in
the Source Serving GW (for Serving GW relocation) shall be released.
8\. The Target MME will now complete the Handover procedure by informing the
Serving GW (for Serving GW relocation this will be the Target Serving GW) that
the Target MME is now responsible for all the EPS bearers the UE have
established. This is performed in the message Modify Bearer Request (Cause,
MME Tunnel Endpoint Identifier for Control Plane, EPS Bearer ID(s), MME
Address for Control Plane, eNodeB Address(es) and TEID(s) for User Traffic for
the accepted EPS bearers, PDN GW addresses and TEIDs (for GTP-based S5/S8) or
GRE keys (for PMIP-based S5/S8) at the PDN GW(s) for uplink traffic and RAT
type, ISR Activated) per PDN connection. If the PDN GW requested UE\'s
location info (determined from the UE context), the MME also includes the User
Location Information IE in this message. If indicated, ISR Activated indicates
that ISR is activated, which is only possible when the S‑GW was not changed.
When the Modify Bearer Request does not indicate ISR Activated and S‑GW is not
changed, the S‑GW deletes any ISR resources by sending a Delete Bearer Request
to the other CN node that has bearer resources on the S‑GW reserved.
The MME releases the non-accepted bearers by triggering the bearer release
procedure as specified in clause 5.4.4.2. If the Serving GW receives a DL
packet for a non-accepted bearer, the Serving GW drops the DL packet and does
not send a Downlink Data Notification to the MME.
9\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) informs the PDN GW(s) the change of, for example, for Serving GW
relocation or the RAT type, that e.g. can be used for charging, by sending the
message Modify Bearer Request per PDN connection. The S‑GW also includes User
Location Information IE if it is present in step 8. For Serving GW relocation,
the Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers. The
PDN GW must acknowledge the request with the message Modify Bearer Response
(Charging Id, MSISDN, etc.) to the Serving GW.
If PCC infrastructure is used, the PDN GW informs the PCRF about the change
of, for example, the RAT type.
10\. The Serving GW (for Serving GW relocation this will be the Target Serving
GW) acknowledges the user plane switch to the Target MME via the message
Modify Bearer Response (Cause, Serving GW Tunnel Endpoint Identifier for
Control Plane, Serving GW (for Serving GW relocation this will be the Target
Serving GW) Address for Control Plane, Protocol Configuration Options). At
this stage the user plane path is established for all bearers between the UE,
Target eNodeB, Serving GW (for Serving GW relocation this will be the Target
Serving GW) and PDN GW.
If the Serving GW does not change, the Serving GW shall send one or more \"end
marker\" packets on the old path immediately after switching the path in order
to assist the reordering function in the target eNodeB.
11\. When the timer started in step 7 expires the Source SGSN will clean-up
all its resources towards Source BSS by performing the BSS Packet Flow Delete
procedure.
12\. The UE initiates a Tracking Area Update procedure when one of the
conditions listed in clause \"Triggers for tracking area update\" applies.
The target MME knows that an IRAT Handover has been performed for this UE as
it received the bearer context(s) by handover messages and therefore the
target MME performs only a subset of the TA update procedure, specifically it
excludes the context transfer procedures between source SGSN and target MME.
13\. When the timer started in step 7 expires and if the source SGSN received
the Serving GW change indication in the Forward Relocation Response message,
it deletes the EPS bearer resources by sending Delete Session Request (Cause,
TEID) messages to the Source Serving GW. Cause indicates to the Source Serving
GW that the Serving GW changes and the Source Serving GW shall not initiate a
delete procedure towards the PDN GW. The Source Serving GW acknowledges with
Delete Session Response (TEID) messages. If ISR has been activated before this
procedure, the cause also indicates to the Source S‑GW that the Source S‑GW
shall delete the bearer resources on the other old CN node by sending Delete
Bearer Request message(s) to that CN node.
14\. If indirect forwarding was used then the expiry of the timer at source
SGSN started at step 7 triggers the source SGSN to send a Delete Indirect Data
Forwarding Tunnel Request message to the S‑ GW to release the temporary
resources used for indirect forwarding.
15\. If indirect forwarding was used and the Serving GW is relocated, then the
expiry of the timer at target MME started at step 6 triggers the target MME to
send a Delete Indirect Data Forwarding Tunnel Request message to the target S‑
GW to release temporary resources used for indirect forwarding.
##### 5.5.2.4.4 GERAN A/Gb mode to E-UTRAN Inter RAT handover reject
The Target eNodeB may reject the use of the Handover procedure if none of the
requested EPS bearers in the Handover Request message could be established. In
this case no UE context is established in the target MME/eNodeB and no
resources are allocated. The UE remains in the Source BSS/SGSN.
Figure 5.5.2.4.4-1: GERAN A/Gb mode to E-UTRAN inter RAT HO reject
1\. Steps 1 to 5 in the flow are identical to the ones in clause 5.5.2.4.2.
6\. If the Target eNodeB fails to allocate any resources for any of the
requested EPS Bearers it sends a Handover Failure (Cause) message to the
Target MME. When the Target MME receives the Handover Failure message from
Target eNodeB the Target MME clears any reserved resources for this UE.
7\. This step is only performed for Serving GW relocation, i.e. if Steps 4/4a
have been performed. The Target MME deletes the EPS bearer resources by
sending Delete Session Request (Cause, TEID) messages to the Target Serving
GW. The Target Serving GW acknowledges with Delete Session Response (TEID)
messages.
8\. The Target MME sends the Forward Relocation Response (Cause) message to
the Source SGSN.
9\. When the Source SGSN receives the Forward Relocation Response message it
send a PS Handover Required Negative Acknowledge (Cause) message to the Source
BSS.
#### 5.5.2.5 Inter RAT handover Cancel
##### 5.5.2.5.1 General
Instead of completing the handover procedure, the source RAN node (eNodeB, RNC
or BSS) may at any time during the handover procedure, up to the time when a
handover command message is sent to the UE cancel the handover. The reason for
cancelling may be e.g. due to a timer expiration or due to other events within
the source RAN node and is initiated by sending a handover cancel PDU to the
source EPC node (MME or SGSN).
A handover cancel PDU shall also be sent by the source RAN node after a
handover command message is sent to the UE for the case where the handover
fails and the UE returns to the old cell or radio contact with the UE is lost.
This is done in order to release the resources reserved for the Handover in
the target system.
##### 5.5.2.5.2 Source RAN to Target RAN Inter RAT handover Cancel
Figure 5.5.2.5.2-1: Inter RAT handover Cancel
1\. The source RAN decides to cancel the previously requested relocation of
Handover resources. This may be due to not enough accepted bearers, UE
returned to source cell or any other reason.
2\. The source RAN sends a Cancel message with a Cause to the source EPC node
(SGSN or MME). If the source RAN is:
a) BSS the message sent is PS Handover Cancel (Cause),
b) RNC the message sent is Relocation Cancel (Cause), or
c) eNodeB the message sent is Handover Cancel (Cause).
3\. The source EPC node terminates the relocation towards the target side by
sending a Relocation Cancel Request (IMSI) message to the target EPC node. The
Source EPC node also resumes operation on the resources in the source side.
4\. The target EPC node triggers the release of resources in the target RAN
and also releases its own resources allocated for this handover.
5\. This step is only performed for Serving GW relocation. The Target EPC node
deletes the EPS bearer resources by sending Delete Session Request (Cause,
TEID) messages to the Target Serving GW. The Target Serving GW acknowledges
with Delete Session Response (TEID) messages.
6\. The target EPC node acknowledge the release of all resources on the target
side by returning a Relocation Cancel Response (Cause) message to the source
EPC node.
7\. The source EPC node returns a Cancel acknowledge message to the source
RAN. If the source RAN is:
a) BSS there will be no acknowledge message sent to the source BSS,
b) RNC the message sent is Relocation Cancel Acknowledge (Cause), or
c) eNodeB the message sent is Handover Cancel Acknowledge (Cause).
8\. If indirect forwarding tunnel is setup during handover preparation then
cancellation of handover triggers the source MME/SGSN to send a Delete
Indirect Data Forwarding Tunnel Request message to the S‑ GW to release the
temporary resources used for indirect forwarding.
9\. If indirect forwarding tunnel is setup during handover preparation and
Serving GW is relocated then cancellation of handover triggers the target
MME/SGSN to send a Delete Indirect Data Forwarding Tunnel Request message to
the S‑ GW to release the temporary resources used for indirect forwarding.
## 5.6 Network Assisted Cell Change
Network Assisted Cell Change (NACC) is a means that enables better performance
for packet data services upon inter-cell change for those networks that do not
support PS Handover. It reduces the service interruption time for UEs in
active mode upon cell change by providing in the source cell, prior to the
cell change, system information of a target cell allowing packet access.
Within the scope of this specification, NACC is applicable for inter-RAT cell
changes from a source E‑UTRAN cell towards a target GERAN cell.
When the UE changes from a source E‑UTRAN cell towards a target GERAN cell,
the UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\" to
\"GUTI\", if any EPS bearer context activated after the ISR was activated in
the UE exists.
### 5.6.1 Architecture Principles for E-UTRAN to GERAN NACC
Introducing NACC from E‑UTRAN to GERAN follows the principles of the Network
Assisted Cell Change between UTRAN and GERAN as described in TS 25.413 [22]
and TS 23.060 [7]. It specifies the RAN Information Management (RIM)
procedures as depicted in figure 5.6‑1.
Figure 5.6-1: E-UTRAN to GERAN NACC basic network architecture
The support for the NACC from E‑UTRAN to GERAN has the following impacts on
E‑UTRAN / GERAN architecture:
\- Affected nodes: BSC, eNodeB, MME, SGSN;
\- Affected network interfaces: Gb, Iu, S3, Gn, S1;
\- Affected radio interfaces: Um and Uu.
### 5.6.2 RAN Information Management (RIM) procedures
#### 5.6.2.1 General
The RAN Information Management (RIM) procedures provide a generic mechanism
for the exchange of arbitrary information between applications belonging to
the RAN nodes. The RAN information is transferred via the MME and SGSN core
network node(s). In order to make the RAN information transparent for the Core
Network, the RAN information is included in a RIM container that shall not be
interpreted by the Core Network nodes.
The RIM procedures are optional both in the RAN and the CN nodes. For the Gb
interface the use of RIM procedures is negotiated at start/restart of the Gb
link. For the Iu interface there is no negotiation of using RIM procedures or
not at Iu link start/restart.
The RAN information is transferred in RIM containers from the source RAN node
to the destination RAN node by use of messages. Each message carrying the RIM
container is routed and relayed independently by the core network node(s). Any
relation between messages is transparent for the MME/SGSN, i.e. a
request/response exchange between RIM applications, for example, is routed and
relayed as two independent messages by the MME/SGSN.
The interfaces which will be used are the Gb, the Iu, the S1, Gn and the S3
interfaces. The RAN information in the RIM container shall be transparent for
the Core Network. An MME or SGSN supporting the RIM procedures provides
addressing, routing and relaying functions.
#### 5.6.2.2 Addressing, routing and relaying
##### 5.6.2.2.1 Addressing
All the messages used for the exchange of RAN information contain the
addresses of the source and destination RAN nodes. A BSS is addressed by
Routing Area Identity (RAI) + Cell Identity (CI) of one of its cells. An
eNodeB is addressed by the Target eNodeB Identifier.
##### 5.6.2.2.2 Routing
The following description applies to all the messages used for the exchange of
RAN information.
The source RAN node sends a message to its MME or SGSN including the source
and destination addresses. The SGSN/MME uses the destination address to route
the message encapsulated in a GTP message to the correct MME/SGSN via the S3
or Gn interface.
The MME/SGSN connected to the destination RAN node decides which RAN node to
send the message to based on the destination address.
##### 5.6.2.2.3 Relaying
The SGSN performs relaying between BSSGP messages, RANAP messages and GTP
messages as described in TS 48.018 [42], TS 25.413 [22], TS 29.060 [14] and TS
29.274 [43]. The MME performs relaying between S1 and S3/Gn messages as
described in TS 36.413 [36] and TS 29.274 [43] / TS 29.060 [14].
#### 5.6.2.3 Applications using the RIM Procedures
The RAN node applications, which use the RIM procedures, are fully transparent
for the MME and SGSN. These applications are described in RAN specifications.
An example is the Network Assisted Cell Change described in TS 48.018 [42], TS
25.413 [22] and TS 36.413 [36].
## 5.7 Information storage
This clause describes information storage structures required for the EPS when
3GPP access only is deployed. Information storage for the case where non 3GPP
accesses are deployed is in TS 23.402 [2].
### 5.7.1 HSS
IMSI is the prime key to the data stored in the HSS. The data held in the HSS
is defined in Table 5.7.1-1 here below.
The table below is applicable to E‑UTRAN in standalone operation only.
Table 5.7.1-1: HSS data
* * *
Field Description IMSI IMSI is the main reference key. MSISDN The basic MSISDN
of the UE (Presence of MSISDN is optional). IMEI / IMEISV International Mobile
Equipment Identity - Software Version Number MME Address The IP address of the
MME currently serving this MS. MME Capabilities Indicates the capabilities of
the MME with respect to core functionality e.g. regional access restrictions.
MS PS Purged from EPS Indicates that the EMM and ESM contexts of the UE are
deleted from the MME. ODB parameters Indicates that the status of the operator
determined barring Access Restriction Indicates the access restriction
subscription information. EPS Subscribed Charging Characteristics The charging
characteristics for the MS, e.g. normal, prepaid, flat-rate, and/or hot
billing subscription. Trace Reference Identifies a record or a collection of
records for a particular trace. Trace Type Indicates the type of trace, e.g.
HSS trace, and/or MME/ Serving GW / PDN GW trace. OMC Identity Identifies the
OMC that shall receive the trace record(s). Subscribed-UE-AMBR The Maximum
Aggregated uplink and downlink MBRs to be shared across all Non-GBR bearers
according to the subscription of the user. APN-OI Replacement Indicates the
domain name to replace the APN OI when constructing the PDN GW FQDN upon which
to perform DNS queries. This replacement applies for all the APNs in the
subscriber\'s profile. RFSP Index An index to specific RRM configuration in
the E-UTRAN URRP-MME UE Reachability Request Parameter indicating that UE
activity notification from MME has been requested by the HSS. Each
subscription profile contains one or more PDN subscription contexts:  
Context Identifier Index of the PDN subscription context. PDN Address
Indicates subscribed IP address(es). PDN Type Indicates the subscribed PDN
Type (IPv4, IPv6, IPv4v6) Access Point Name (APN) A label according to DNS
naming conventions describing the access point to the packet data network (or
a wildcard) (NOTE 6). EPS subscribed QoS profile The bearer level QoS
parameter values for that APN\'s default bearer (QCI and ARP) (see clause
4.7.3). Subscribed-APN-AMBR The maximum aggregated uplink and downlink MBRs to
be shared across all Non-GBR bearers, which are established for this APN. EPS
PDN Subscribed Charging Characteristics The charging characteristics of this
PDN subscription context for the MS, e.g. normal, prepaid, flat-rate, and/or
hot billing subscription. The charging characteristics is associated with this
APN. VPLMN Address Allowed Specifies whether for this APN the UE is allowed to
use the PDN GW in the domain of the HPLMN only, or additionally the PDN GW in
the domain of the VPLMN. PDN GW identity The identity of the PDN GW used for
this APN. The PDN GW identity may be either an FQDN or an IP address. The PDN
GW identity refers to a specific PDN GW. PDN GW Allocation Type Indicates
whether the PDN GW is statically allocated or dynamically selected by other
nodes. A statically allocated PDN GW is not changed during PDN GW selection.
PLMN of PDN GW Identifies the PLMN in which the dynamically selected PDN GW is
located. List of APN - PDN GW ID relations (for PDN subscription context with
wildcard APN):  
APN - P‑GW relation #n The APN and the identity of the dynamically allocated
PDN GW of a PDN connection that is authorised by the PDN subscription context
with the wildcard APN. The PDN GW identity may be either an FQDN or an IP
address. The PDN GW identity refers to a specific PDN GW.
* * *
NOTE 1: IMEI and SVN are stored in HSS when the Automatic Device Detection
feature is supported, see clause 15.5 of TS 23.060 [7].
NOTE 2: The \'EPS subscribed QoS profile\' stored in HSS is complementary to
the legacy \'GPRS subscribed QoS profile\'.
NOTE 3: In order to avoid impacts on the current GPRS roaming environment
(including that used on the GRX network), such format as
\"*.mnc\.mcc\.gprs\" for the value of APN‑OI Replacement is be
required.
NOTE 4: How to indicate which of the PDN subscription contexts stored in the
HSS is the default one for the UE is defined in stage 3.
NOTE 5: To help with the selection of a co-located or topologically
appropriate PDN GW and Serving GW, the PDN GW identity shall be in the form of
an FQDN.
NOTE 6: The \"Access Point Name (APN)\" field in the table above contains the
APN-NI part of the APN.
One (and only one) of the PDN subscription contexts stored in the HSS may
contain a wild card APN (see TS 23.003 [9]) in the Access Point Name field.
The PDN subscription context marked as the default one shall not contain a
wild card APN.
The PDN subscription context with a wildcard APN shall not contain a
statically allocated PDN GW.
### 5.7.2 MME
The MME maintains MM context and EPS bearer context information for UEs in the
ECM-IDLE, ECM‑CONNECTED and EMM-DEREGISTERED states. Table 5.7.2-1 shows the
context fields for one UE.
Table 5.7.2-1: MME MM and EPS bearer Contexts
+----------------------------------+----------------------------------+ | Field | Description | +----------------------------------+----------------------------------+ | IMSI | IMSI (International Mobile | | | Subscriber Identity) is the | | | subscribers permanent identity. | +----------------------------------+----------------------------------+ | MSISDN | The basic MSISDN of the UE. The | | | presence is dictated by its | | | storage in the HSS. | +----------------------------------+----------------------------------+ | MM State | Mobility management state | | | ECM-IDLE, ECM-CONNECTED, | | | EMM-DEREGISTERED. | +----------------------------------+----------------------------------+ | GUTI | Globally Unique Temporary | | | Identity. | +----------------------------------+----------------------------------+ | ME Identity | Mobile Equipment Identity -- | | | (e.g. IMEI/IMEISV) Software | | | Version Number | +----------------------------------+----------------------------------+ | Tracking Area List | Current Tracking area list | +----------------------------------+----------------------------------+ | TAI of last TAU | TAI of the TA in which the last | | | Tracking Area Update was | | | initiated. | +----------------------------------+----------------------------------+ | E-UTRAN Cell Global Identity | Last known E-UTRAN cell | +----------------------------------+----------------------------------+ | E-UTRAN Cell Identity Age | Time elapsed since the last | | | E-UTRAN Cell Global Identity was | | | acquired | +----------------------------------+----------------------------------+ | Authentication Vector | Temporary authentication and key | | | agreement data that enables an | | | MME to engage in AKA with a | | | particular user. An EPS | | | Authentication Vector consists | | | of four elements: | | | | | | a) network challenge RAND, | | | | | | b) an expected response XRES, | | | | | | c) Key K~ASME~, | | | | | | d) a network authentication | | | token AUTN. | +----------------------------------+----------------------------------+ | UE Radio Access Capability | UE radio access capabilities. | +----------------------------------+----------------------------------+ | MS Classmark 2 | GERAN/UTRAN CS domain core | | | network classmark (used if the | | | MS supports SRVCC to GERAN or | | | UTRAN) | +----------------------------------+----------------------------------+ | MS Classmark 3 | GERAN CS domain radio network | | | classmark (used if the MS | | | supports SRVCC to GERAN) | +----------------------------------+----------------------------------+ | Supported Codecs | List of codecs supported in the | | | CS domain (used if the MS | | | supports SRVCC to GERAN or | | | UTRAN) | +----------------------------------+----------------------------------+ | UE Network Capability | UE network capabilities | | | including security algorithms | | | and key derivation functions | | | supported by the UE | +----------------------------------+----------------------------------+ | MS Network Capability | For a GERAN and/or UTRAN capable | | | UE, this contains information | | | needed by the SGSN. | +----------------------------------+----------------------------------+ | UE Specific DRX Parameters | UE specific DRX parameters for | | | A/Gb mode, Iu mode and S1‑mode | +----------------------------------+----------------------------------+ | Selected NAS Algorithm | Selected NAS security algorithm | +----------------------------------+----------------------------------+ | Selected AS Algorithm | Selected AS security algorithms. | +----------------------------------+----------------------------------+ | eKSI | Key Set Identifier for the main | | | key K~ASME~. Also indicates | | | whether the UE is using security | | | keys derived from UMTS-AKA or | | | EPS-AKA security association. | +----------------------------------+----------------------------------+ | K~ASME~ | Main key for E-UTRAN key | | | hierarchy based on CK, IK and | | | Serving network identity | +----------------------------------+----------------------------------+ | NAS Keys and COUNT | K~NASint~, K_~NASenc~, and NAS | | | COUNT parameter. | +----------------------------------+----------------------------------+ | Selected CN operator id | Selected core network operator | | | identity (to support network | | | sharing as defined in | | | TS 23.251 [24]). | +----------------------------------+----------------------------------+ | Recovery | Indicates if the HSS is | | | performing database recovery. | +----------------------------------+----------------------------------+ | Access Restriction | The access restriction | | | subscription information. | +----------------------------------+----------------------------------+ | ODB for PS parameters | Indicates that the status of the | | | operator determined barring for | | | packet oriented services. | +----------------------------------+----------------------------------+ | MME IP address for S11 | MME IP address for the S11 | | | interface (used by S‑GW) | +----------------------------------+----------------------------------+ | MME TEID for S11 | MME Tunnel Endpoint Identifier | | | for S11 interface. | +----------------------------------+----------------------------------+ | S‑GW IP address for S11/S4 | S‑GW IP address for the S11 and | | | S4 interfaces | +----------------------------------+----------------------------------+ | S‑GW TEID for S11/S4 | S‑GW Tunnel Endpoint Identifier | | | for the S11 and S4 interfaces. | +----------------------------------+----------------------------------+ | SGSN IP address for S3 | SGSN IP address for the S3 | | | interface (used if ISR is | | | activated for the GERAN and /or | | | UTRAN capable UE) | +----------------------------------+----------------------------------+ | SGSN TEID for S3 | SGSN Tunnel Endpoint Identifier | | | for S3 interface (used if ISR is | | | activated for the GERAN and /or | | | UTRAN capable UE) | +----------------------------------+----------------------------------+ | eNodeB Address in Use | The IP address of the eNodeB | | | currently used for control plane | | | signalling. | +----------------------------------+----------------------------------+ | eNB UE S1AP ID | Unique identity of the UE within | | | eNodeB. | +----------------------------------+----------------------------------+ | MME UE S1AP ID | Unique identity of the UE within | | | MME. | +----------------------------------+----------------------------------+ | Subscribed UE-AMBR | The Maximum Aggregated uplink | | | and downlink MBR values to be | | | shared across all Non-GBR | | | bearers according to the | | | subscription of the user. | +----------------------------------+----------------------------------+ | UE-AMBR | The currently used Maximum | | | Aggregated uplink and downlink | | | MBR values to be shared across | | | all Non-GBR bearers. | +----------------------------------+----------------------------------+ | EPS Subscribed Charging | The charging characteristics for | | Characteristics | the MS, e.g. normal, prepaid, | | | flat rate and/or hot billing. | +----------------------------------+----------------------------------+ | Subscribed RFSP Index | An index to specific RRM | | | configuration in the E-UTRAN | | | that is received from the HSS. | +----------------------------------+----------------------------------+ | RFSP Index in Use | An index to specific RRM | | | configuration in the E-UTRAN | | | that is currently in use. | +----------------------------------+----------------------------------+ | Trace reference | Identifies a record or a | | | collection of records for a | | | particular trace. | +----------------------------------+----------------------------------+ | Trace type | Indicates the type of trace | +----------------------------------+----------------------------------+ | Trigger id | Identifies the entity that | | | initiated the trace | +----------------------------------+----------------------------------+ | OMC identity | Identifies the OMC that shall | | | receive the trace record(s). | +----------------------------------+----------------------------------+ | URRP-MME | URRP-MME indicating that the HSS | | | has requested the MME to notify | | | the HSS regarding UE | | | reachability at the MME | +----------------------------------+----------------------------------+ | APN-OI-Replacement | Indicates the domain name to | | | replace the APN OI when | | | constructing the PDN GW FQDN | | | upon which to perform DNS | | | queries. | +----------------------------------+----------------------------------+ | For each active PDN connection: | | +----------------------------------+----------------------------------+ | APN in Use | The APN currently used. This APN | | | shall be composed of the APN | | | Network Identifier and the APN | | | Operator Identifier. | +----------------------------------+----------------------------------+ | APN Subscribed | The subscribed APN received from | | | the HSS. | +----------------------------------+----------------------------------+ | APN Restriction | Denotes the restriction on the | | | combination of types of APN for | | | the APN associated with this EPS | | | bearer Context. | +----------------------------------+----------------------------------+ | PDN Type | IPv4, IPv6 or IPv4v6 | +----------------------------------+----------------------------------+ | IP Address(es) | IPv4 address and/or IPv6 prefix | | | | | | NOTE: The MME might not have | | | information on the allocated | | | IPv4 address. Alternatively, | | | following mobility involving a | | | pre-release 8 SGSN, this IPv4 | | | address might not be the one | | | allocated to the UE. | +----------------------------------+----------------------------------+ | EPS PDN Charging Characteristics | The charging characteristics of | | | this PDN connection, e.g. | | | normal, prepaid, flat-rate | | | and/or hot billing. | +----------------------------------+----------------------------------+ | VPLMN Address Allowed | Specifies whether the UE is | | | allowed to use the APN in the | | | domain of the HPLMN only, or | | | additionally the APN in the | | | domain of the VPLMN. | +----------------------------------+----------------------------------+ | PDN GW Address in Use (control | The IP address of the PDN GW | | plane) | currently used for sending | | | control plane signalling. | +----------------------------------+----------------------------------+ | PDN GW TEID for S5/S8 (control | PDN GW Tunnel Endpoint | | plane) | Identifier for the S5/S8 | | | interface for the control plane. | +----------------------------------+----------------------------------+ | MS Info Change Reporting Action | Need to communicate change in | | | User Location Information to the | | | PDN GW with this EPS bearer | | | Context. | +----------------------------------+----------------------------------+ | EPS subscribed QoS profile | The bearer level QoS parameter | | | values for that APN\'s default | | | bearer (QCI and ARP) (see | | | clause 4.7.3). | +----------------------------------+----------------------------------+ | Subscribed APN-AMBR | The Maximum Aggregated uplink | | | and downlink MBR values to be | | | shared across all Non-GBR | | | bearers, which are established | | | for this APN, according to the | | | subscription of the user. | +----------------------------------+----------------------------------+ | APN-AMBR | The Maximum Aggregated uplink | | | and downlink MBR values to be | | | shared across all Non-GBR | | | bearers, which are established | | | for this APN, as decided by the | | | PDN GW. | +----------------------------------+----------------------------------+ | PDN GW GRE Key for uplink | PDN GW assigned GRE Key for the | | traffic (user plane) | S5/S8 interface for the user | | | plane for uplink traffic. (For | | | PMIP-based S5/S8 only) | +----------------------------------+----------------------------------+ | Default bearer | Identifies the EPS Bearer Id of | | | the default bearer within the | | | given PDN connection. | +----------------------------------+----------------------------------+ | For each bearer within the PDN | | | connection: | | +----------------------------------+----------------------------------+ | EPS Bearer ID | An EPS bearer identity uniquely | | | identifies an EP S bearer for | | | one UE accessing via E-UTRAN | +----------------------------------+----------------------------------+ | TI | Transaction Identifier | +----------------------------------+----------------------------------+ | IP address for S1-u | IP address of the S‑GW for the | | | S1-u interfaces. | +----------------------------------+----------------------------------+ | TEID for S1u | Tunnel Endpoint Identifier of | | | the S‑GW for the S1-u interface. | +----------------------------------+----------------------------------+ | PDN GW TEID for S5/S8 (user | P‑GW Tunnel Endpoint Identifier | | plane) | for the S5/S8 interface for the | | | user plane. (Used for S‑GW | | | change only). | | | | | | NOTE: The PDN GW TEID is needed | | | in MME context as S‑GW | | | relocation is triggered without | | | interaction with the source | | | S‑GW, e.g. when a TAU occurs. | | | The Target S‑GW requires this | | | Information Element, so it must | | | be stored by the MME. | +----------------------------------+----------------------------------+ | PDN GW IP address for S5/S8 | P GW IP address for user plane | | (user plane) | for the S5/S8 interface for the | | | user plane. (Used for S‑GW | | | change only). | | | | | | NOTE: The PDN GW IP address for | | | user plane is needed in MME | | | context as S‑GW relocation is | | | triggered without interaction | | | with the source S‑GW, e.g. when | | | a TAU occurs. The Target S‑GW | | | requires this Information | | | Element, so it must be stored by | | | the MME. | +----------------------------------+----------------------------------+ | EPS bearer QoS | QCI and ARP | | | | | | optionally: GBR and MBR for GBR | | | bearer | +----------------------------------+----------------------------------+ | TFT | Traffic Flow Template. (For | | | PMIP-based S5/S8 only) | +----------------------------------+----------------------------------+
### 5.7.3 Serving GW
The Serving GW maintains the following EPS bearer context information for UEs.
Table 5.7.3-1 shows the context fields for one UE.
Table 5.7.3-1: S‑GW EPS bearer context
+-----------------------+-----------------------+---------+---------+ | Field | Description | E-UTRAN | UTRAN/\ | | | | | GERAN | +-----------------------+-----------------------+---------+---------+ | IMSI | IMSI (International | X | X | | | Mobile Subscriber | | | | | Identity) is the | | | | | subscriber permanent | | | | | identity. | | | +-----------------------+-----------------------+---------+---------+ | MSISDN | The basic MSISDN of | X | X | | | the UE. The presence | | | | | is dictated by its | | | | | storage in the HSS. | | | +-----------------------+-----------------------+---------+---------+ | Selected CN operator | Selected core network | X | X | | id | operator identity (to | | | | | support network | | | | | sharing as defined in | | | | | TS 23.251 [24]). | | | +-----------------------+-----------------------+---------+---------+ | MME TEID for S11 | MME Tunnel Endpoint | X | | | | Identifier for the | | | | | S11 interface | | | +-----------------------+-----------------------+---------+---------+ | MME IP address for | MME IP address the | X | | | S11 | S11 interface. | | | +-----------------------+-----------------------+---------+---------+ | S‑GW TEID for S11/S4 | S‑GW Tunnel Endpoint | X | X | | (control plane) | Identifier for the | | | | | S11 Interface and the | | | | | S4 Interface (control | | | | | plane). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW IP address for | S‑GW IP address for | X | X | | S11/S4 (control | the S11 interface and | | | | plane) | the S4 Interface | | | | | (control plane). | | | +-----------------------+-----------------------+---------+---------+ | SGSN IP address for | SGSN IP address for | | X | | S4 (control plane) | the S4 interface | | | | | (Used by the S‑GW). | | | +-----------------------+-----------------------+---------+---------+ | SGSN TEID for S4 | SGSN Tunnel Endpoint | | X | | (control plane) | Identifier for the S4 | | | | | interface. | | | +-----------------------+-----------------------+---------+---------+ | Trace reference | Identifies a record | X | X | | | or a collection of | | | | | records for a | | | | | particular trace. | | | +-----------------------+-----------------------+---------+---------+ | Trace type | Indicates the type of | X | X | | | trace | | | +-----------------------+-----------------------+---------+---------+ | Trigger id | Identifies the entity | X | X | | | that initiated the | | | | | trace | | | +-----------------------+-----------------------+---------+---------+ | OMC identity | Identifies the OMC | X | X | | | that shall receive | | | | | the trace record(s). | | | +-----------------------+-----------------------+---------+---------+ | | | | | +-----------------------+-----------------------+---------+---------+ | | | | | +-----------------------+-----------------------+---------+---------+ | For each PDN | | | | | Connection: | | | | | | | | | | NOTE: The following | | | | | entries are repeated | | | | | for each PDN. | | | | +-----------------------+-----------------------+---------+---------+ | APN in Use | The APN currently | X | X | | | used. This APN shall | | | | | be composed of the | | | | | APN Network | | | | | Identifier and the | | | | | APN Operator | | | | | Identifier. | | | +-----------------------+-----------------------+---------+---------+ | EPS PDN Charging | The charging | X | X | | Characteristics | characteristics of | | | | | this PDN connection, | | | | | e.g. normal, prepaid, | | | | | flat-rate and/or hot | | | | | billing. | | | +-----------------------+-----------------------+---------+---------+ | P‑GW Address in Use | The IP address of the | X | X | | (control plane) | P‑GW currently used | | | | | for sending control | | | | | plane signalling. | | | +-----------------------+-----------------------+---------+---------+ | P‑GW TEID for S5/S8 | P‑GW Tunnel Endpoint | X | X | | (control plane) | Identifier for the | | | | | S5/S8 interface for | | | | | the control plane. | | | | | (For GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | P‑GW Address in Use | The IP address of the | X | X | | (user plane) | P‑GW currently used | | | | | for sending user | | | | | plane traffic. (For | | | | | PMIP-based S5/S8 | | | | | only) | | | +-----------------------+-----------------------+---------+---------+ | P‑GW GRE Key for | PDN GW assigned GRE | X | X | | uplink traffic (user | Key for the S5/S8 | | | | plane) | interface for the | | | | | user plane for uplink | | | | | traffic. (For | | | | | PMIP-based S5/S8 | | | | | only) | | | +-----------------------+-----------------------+---------+---------+ | S‑GW IP address for | S‑GW IP address for | X | X | | S5/S8 (control plane) | the S5/S8 for the | | | | | control plane | | | | | signalling. | | | +-----------------------+-----------------------+---------+---------+ | S‑GW TEID for S5/S8 | S‑GW Tunnel Endpoint | X | X | | (control plane) | Identifier for the | | | | | S5/S8 control plane | | | | | interface. (For | | | | | GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW Address in Use | The IP address of the | X | X | | (user plane) | S‑GW currently used | | | | | for sending user | | | | | plane traffic. (For | | | | | PMIP-based S5/S8 | | | | | only) | | | +-----------------------+-----------------------+---------+---------+ | S‑GW GRE Key for | Serving GW assigned | X | X | | downlink traffic | GRE Key for the S5/S8 | | | | (user plane) | interface for the | | | | | user plane for | | | | | downlink traffic. | | | | | (For PMIP-based S5/S8 | | | | | only) | | | +-----------------------+-----------------------+---------+---------+ | Default Bearer | Identifies the | X | X | | | default bearer within | | | | | the PDN connection by | | | | | its EPS Bearer Id. | | | | | (For PMIP based | | | | | S5/S8.) | | | +-----------------------+-----------------------+---------+---------+ | For each EPS Bearer | | | | | within the PDN | | | | | Connection: | | | | | | | | | | NOTE: The following | | | | | entries defining the | | | | | EPS Bearer specific | | | | | parameters are | | | | | included within the | | | | | set of parameters | | | | | defining the PDN | | | | | Connection. | | | | +-----------------------+-----------------------+---------+---------+ | EPS Bearer Id | An EPS bearer | X | X | | | identity uniquely | | | | | identifies an EPS | | | | | bearer for one UE | | | | | accessing via E-UTRAN | | | +-----------------------+-----------------------+---------+---------+ | TFT | Traffic Flow Template | X | X | +-----------------------+-----------------------+---------+---------+ | P‑GW Address in Use | The IP address of the | X | X | | (user plane) | P‑GW currently used | | | | | for sending user | | | | | plane traffic. (For | | | | | GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | P‑GW TEID for S5/S8 | P‑GW Tunnel Endpoint | X | X | | (user plane) | Identifier for the | | | | | S5/S8 interface for | | | | | the user plane. (For | | | | | GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW IP address for | S‑GW IP address for | X | X | | S5/S8 (user plane) | user plane data | | | | | received from PDN GW. | | | | | (For GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW TEID for S5/S8 | S‑GW Tunnel Endpoint | X | X | | (user plane) | Identifier for the | | | | | S5/S8 interface for | | | | | the user plane. (For | | | | | GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW IP address for | S‑GW IP address for | X | X | | S1-u, S12 and S4 | the S1-u interface | | | | (user plane) | (Used by the eNodeB), | | | | | for the S12 interface | | | | | (used by the RNC) and | | | | | for the S4 interface | | | | | (used by the SGSN). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW TEID for S1-u, | S‑GW Tunnel Endpoint | X | X | | S12 and S4 (user | Identifier for the | | | | plane) | S1-u interface, for | | | | | the S12 interface | | | | | (used by the RNC) and | | | | | for the S4 interface | | | | | (used by the SGSN). | | | +-----------------------+-----------------------+---------+---------+ | eNodeB IP address for | eNodeB IP address for | X | | | S1-u | the S1-u interface | | | | | (Used by the S‑GW). | | | +-----------------------+-----------------------+---------+---------+ | eNodeB TEID for S1-u | eNodeB Tunnel | X | | | | Endpoint Identifier | | | | | for the S1-u | | | | | interface. | | | +-----------------------+-----------------------+---------+---------+ | RNC IP address for | RNC IP address for | | X | | S12 | the S12 interface | | | | | (Used by the S‑GW). | | | +-----------------------+-----------------------+---------+---------+ | RNC TEID for S12 | RNC Tunnel Endpoint | | X | | | Identifier for the | | | | | S12 interface. | | | +-----------------------+-----------------------+---------+---------+ | SGSN IP address for | SGSN IP address for | | X | | S4 (user plane) | the S4 interface | | | | | (Used by the S‑GW). | | | +-----------------------+-----------------------+---------+---------+ | SGSN TEID for S4 | SGSN Tunnel Endpoint | | X | | (user plane) | Identifier for the S4 | | | | | interface. | | | +-----------------------+-----------------------+---------+---------+ | EPS Bearer QoS | ARP, GBR, MBR, QCI. | X | X | +-----------------------+-----------------------+---------+---------+ | Charging Id | Charging identifier, | X | X | | | identifies charging | | | | | records generated by | | | | | S‑GW and PDN GW. | | | +-----------------------+-----------------------+---------+---------+
### 5.7.4 PDN GW
The PDN GW maintains the following EPS bearer context information for UEs.
Table 5.7.4-1 shows the context fields for one UE.
Table 5.7.4-1: P‑GW context
+-----------------------+-----------------------+---------+---------+ | Field | Description | E-UTRAN | UTRAN/\ | | | | | GERAN | +-----------------------+-----------------------+---------+---------+ | IMSI | IMSI (International | X | X | | | Mobile Subscriber | | | | | Identity) is the | | | | | subscriber permanent | | | | | identity. | | | +-----------------------+-----------------------+---------+---------+ | MSISDN | The basic MSISDN of | X | X | | | the UE. The presence | | | | | is dictated by its | | | | | storage in the HSS. | | | +-----------------------+-----------------------+---------+---------+ | Selected CN operator | Selected core network | X | X | | id | operator identity (to | | | | | support network | | | | | sharing as defined in | | | | | TS 23.251 [24]). | | | +-----------------------+-----------------------+---------+---------+ | RAT type | Current RAT | X | X | +-----------------------+-----------------------+---------+---------+ | Trace reference | Identifies a record | X | X | | | or a collection of | | | | | records for a | | | | | particular trace. | | | +-----------------------+-----------------------+---------+---------+ | Trace type | Indicates the type of | X | X | | | trace | | | +-----------------------+-----------------------+---------+---------+ | Trigger id | Identifies the entity | X | X | | | that initiated the | | | | | trace | | | +-----------------------+-----------------------+---------+---------+ | OMC identity | Identifies the OMC | X | X | | | that shall receive | | | | | the trace record(s). | | | +-----------------------+-----------------------+---------+---------+ | For each APN in use: | | | | | | | | | | NOTE: The following | | | | | entries are repeated | | | | | for each APN. | | | | +-----------------------+-----------------------+---------+---------+ | APN in use | The APN currently | X | X | | | used. The APN shall | | | | | be composed of the | | | | | APN Network | | | | | Identifier and the | | | | | APN Operator | | | | | Identifier. | | | +-----------------------+-----------------------+---------+---------+ | APN-AMBR | The maximum | X | X | | | aggregated uplink and | | | | | downlink MBR values | | | | | to be shared across | | | | | all Non-GBR bearers, | | | | | which are established | | | | | for this APN. | | | +-----------------------+-----------------------+---------+---------+ | For each PDN | | | | | Connection within the | | | | | APN: | | | | | | | | | | NOTE: The following | | | | | entries are repeated | | | | | for each PDN | | | | | connection within the | | | | | APN. | | | | +-----------------------+-----------------------+---------+---------+ | IP Address(es) | IPv4 address and/or | X | X | | | IPv6 prefix | | | +-----------------------+-----------------------+---------+---------+ | PDN type | IPv4, IPv6, or IPv4v6 | X | X | +-----------------------+-----------------------+---------+---------+ | S‑GW Address in Use | The IP address of the | X | X | | (control plane) | S‑GW currently used | | | | | for sending control | | | | | plane signalling. | | | +-----------------------+-----------------------+---------+---------+ | S‑GW TEID for S5/S8 | S‑GW Tunnel Endpoint | X | X | | (control plane) | Identifier for the | | | | | S5/S8 interface for | | | | | the control plane. | | | | | (For GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW Address in Use | The IP address of the | X | X | | (user plane) | S‑GW currently used | | | | | for sending user | | | | | plane traffic. (For | | | | | PMIP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | S‑GW GRE Key for | Serving GW assigned | X | X | | downlink traffic | GRE Key for the S5/S8 | | | | (user plane) | interface for the | | | | | user plane for | | | | | downlink traffic. | | | | | (For PMIP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | P‑GW IP address for | P‑GW IP address for | X | X | | S5/S8 (control plane) | the S5/S8 for the | | | | | control plane | | | | | signalling. | | | +-----------------------+-----------------------+---------+---------+ | P‑GW TEID for S5/S8 | P‑GW Tunnel Endpoint | X | X | | (control plane) | Identifier for the | | | | | S5/S8 control plane | | | | | interface. (For | | | | | GTP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | P‑GW Address in Use | The IP address of the | X | X | | (user plane) | P‑GW currently used | | | | | for sending user | | | | | plane traffic. (For | | | | | PMIP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | P‑GW GRE Key for | PDN GW assigned GRE | X | X | | uplink traffic (user | Key for the S5/S8 | | | | plane) | interface for the | | | | | user plane for uplink | | | | | traffic. (For | | | | | PMIP-based S5/S8 | | | | | only). | | | +-----------------------+-----------------------+---------+---------+ | MS Info Change | The MME and/or SGSN | | X | | Reporting support | serving the UE | | | | indication | support(s) procedures | | | | | for reporting User | | | | | Location Information | | | | | changes. | | | +-----------------------+-----------------------+---------+---------+ | MS Info Change | Denotes whether the | | X | | Reporting Action | MME and/or the SGSN | | | | | is/are requested to | | | | | send changes in ser | | | | | Location Information | | | | | change for this | | | | | bearer | | | +-----------------------+-----------------------+---------+---------+ | BCM | The negotiated Bearer | | X | | | Control Mode for | | | | | GERAN/UTRAN. | | | +-----------------------+-----------------------+---------+---------+ | Default Bearer | Identifies the | X | X | | | default bearer within | | | | | the PDN connection by | | | | | its EPS Bearer Id. | | | | | The default bearer is | | | | | the one which is | | | | | established first | | | | | within the PDN | | | | | connection. (For GTP | | | | | based S5/S8). | | | +-----------------------+-----------------------+---------+---------+ | EPS PDN Charging | The charging | X | X | | Characteristics | characteristics of | | | | | this PDN connection, | | | | | e.g. normal, prepaid, | | | | | flat rate and/or hot | | | | | billing | | | +-----------------------+-----------------------+---------+---------+ | For each EPS Bearer | | | | | within the PDN | | | | | Connection: | | | | | | | | | | NOTE 1: The following | | | | | entries defining the | | | | | EPS Bearer specific | | | | | parameters are | | | | | included within the | | | | | set of parameters | | | | | defining the PDN | | | | | Connection. | | | | | | | | | | NOTE 2: The following | | | | | entries are stored | | | | | only for GTP-based | | | | | S5/S8. | | | | +-----------------------+-----------------------+---------+---------+ | EPS Bearer Id | An EPS bearer | X | X | | | identity uniquely | | | | | identifies an EPS | | | | | bearer for one UE | | | | | accessing via E-UTRAN | | | +-----------------------+-----------------------+---------+---------+ | TFT | Traffic Flow Template | X | X | +-----------------------+-----------------------+---------+---------+ | S‑GW Address in Use | The IP address of the | X | X | | (user plane) | S‑GW currently used | | | | | for sending user | | | | | plane traffic. | | | +-----------------------+-----------------------+---------+---------+ | S‑GW TEID for S5/S8 | S‑GW Tunnel Endpoint | X | X | | (user plane) | Identifier for the | | | | | S5/S8 interface for | | | | | the user plane. | | | +-----------------------+-----------------------+---------+---------+ | P‑GW IP address for | P‑GW IP address for | X | X | | S5/S8 (user plane) | user plane data | | | | | received from PDN GW. | | | +-----------------------+-----------------------+---------+---------+ | P‑GW TEID for S5/S8 | P‑GW Tunnel Endpoint | X | X | | (user plane) | Identifier for the | | | | | GTP Based S5/S8 | | | | | interface for user | | | | | plane. | | | +-----------------------+-----------------------+---------+---------+ | EPS Bearer QoS | ARP, GBR, MBR, QCI. | X | X | +-----------------------+-----------------------+---------+---------+ | Charging Id | Charging identifier, | X | X | | | identifies charging | | | | | records generated by | | | | | S‑GW and PDN GW. | | | +-----------------------+-----------------------+---------+---------+
### 5.7.5 UE
The UE maintains the following context information. Table 5.7.5-1 shows the
context fields. A GERAN or UTRAN capable UE maintains in addition the context
information as described in a similar UE context table in TS 23.060 [7].
Table 5.7.5-1: UE context
* * *
Field Description IMSI IMSI (International Mobile Subscriber Identity) is the
subscribers permanent identity. EMM State Mobility management state EMM-
REGISTERED, EMM-DEREGISTERED. GUTI Globally Unique Temporary Identity. ME
Identity Mobile Equipment Identity -- (e.g. IMEI/IMEISV) Software Version
Number. Tracking Area List Current Tracking area list. last visited TAI A TAI
which is contained in the TA list the UE registered to the network and which
identifies the tracking area last visited by the UE. Selected NAS Algorithm
Selected NAS security algorithm. Selected AS Algorithm Selected AS security
algorithms. eKSI Key Set Identifier for the main key K~ASME.~ Also indicates
whether the UE is using security keys derived from UTRAN or E-UTRAN security
association. K~ASME~ Main key for E-UTRAN key hierarchy based on CK, IK and
Serving network identity. NAS Keys and COUNT K~NASint~, K~NASenc~, and NAS
COUNT parameter. Temporary Identity used in Next update (TIN) This parameter
is used internally by the UE to memorise which temporary ID it has to indicate
in the Attach Request and RAU/TAU Request as specified in clause 4.3.5.6. UE
Specific DRX Parameters Preferred E-UTRAN DRX cycle length **For each active
PDN connection:**  
APN in Use The APN currently used. This APN shall be composed of the APN
Network Identifier and the APN Operator Identifier. APN-AMBR The maximum
aggregated uplink and downlink MBR to be shared across all Non-GBR bearers,
which are established for this APN. Assigned PDN Type The PDN Type assigned by
the network (IPv4, IPv6, or IPv4v6). IP Address(es) IPv4 address and/or IPv6
prefix Default Bearer Identifies the default bearer within the PDN connection
by its EPS Bearer Id. The default bearer is the one which is established first
within the PDN connection. **For each EPS Bearer within the PDN connection**  
EPS Bearer ID An EPS bearer identity uniquely identifies an EPS bearer for one
UE accessing via E-UTRAN. TI Transaction Identifier EPS bearer QoS GBR and MBR
for GBR bearer. TFT Traffic Flow Template.
* * *
### 5.7.6 Handling of Wild Card APN
When the wild card APN is present in the subscription context, the UE is
authorized to connect to APNs which are not present in the subscription
context.
When a request is received for registering a PDN GW ID and there is no PDN
subscription context with this APN, the nodes (HSS/MME/ S4 SGSN) shall store
the PDN GW ID - APN relation for the UE.
When a request is received for deregistering of PDN GW ID and there is no PDN
subscription context with this APN, the nodes (HSS/MME/S4 SGSN) shall delete
the PDN GW ID - APN relation from the list of APN - PDN GW ID relations.
## 5.7A Charging
Accounting functionality is provided by the Serving GW and the PDN GW.
The Serving GW shall be able to collect and report, for each UE, accounting
information, i.e. the amount of data transmitted in uplink and downlink
direction categorized with the QCI and ARP pair per UE per PDN connection. For
GTP-based S5/S8 the accounting information is collected and reported per
bearer.
The Serving GW shall not collect UE accounting information for packets that
are being processed for the sole purpose of indirect forwarding.
The Serving GW for inter-operator charging, and the PDN GW shall be able to
interface the OFCS according to charging principles and through reference
points specified in TS 32.240 [51].
The PDN GW shall be able to provide charging functionality for each UE
according to TS 23.203 [6].
A PDN GW without a Gx interface shall be able to support flow based online and
offline charging based on local configuration and interaction with the Online
and Offline Charging Systems.
The PDN GW shall be able to collect and report, for each UE, accounting
information, i.e. the amount of data transmitted in uplink and downlink
direction categorized with the QCI and ARP pair per UE per PDN connection. For
GTP-based S5/S8 the accounting information is collected and reported per
bearer.
The Charging identifier(s) generated by the PDN GW per bearer for GTP-based
S5/S8 and per PDN connection for PMIP-based S5/S8 and the PDN GW address for
control signalling enables the correlation of the reporting from a Serving GW
and a PDN GW.
The PDN GW receives Charging Characteristics from the Serving GW through
GTP-S5/S8, or through PMIP for PMIP-based S5/S8. The handling of the Charging
Characteristics in the P‑GW is defined in TS 32.251 [44].
## 5.8 MBMS
MBMS is a point-to-multipoint service in which data is transmitted from a
single source entity to multiple recipients. Transmitting the same data to
multiple recipients allows network resources to be shared.
MBMS is not supported by the Evolved Packet System in this version of the
specifications.
## 5.9 Interactions with other services
NOTE: Specific support for emergency access and location services are out of
scope of this Release.
### 5.9.1 Location Reporting Procedure
This procedure is used by an MME to request the eNodeB to report where the UE
is currently located when the target UE is in ECM-CONNECTED state. The need
for the eNodeB to continue reporting ceases when the UE transitions to ECM-
IDLE. This procedure may be used for services that require accurate cell
identification (e.g. for emergency calls, lawful intercept, charging).
NOTE 1: The details of Location Service architecture and procedures for EPS
are not described in this Release.
NOTE 2: For intra eNodeB cell change MME does not support sending the location
change to Serving GW in this version of the specification.
Figure 5.9.1-1: Location Reporting Procedure
1) The MME sends a Location Reporting Control message to the eNodeB. The
Location Reporting Control message shall identify the UE for which reports are
requested, the requested location information and may contain information such
as reporting type. Requested location information is TAI+EGCI. Reporting type
indicates whether the message is intended to trigger a single stand‑alone
report about the current Cell ID serving the UE or start the eNodeB to report
whenever the UE changes cell.
2) The eNodeB sends a Location Report message informing the MME about the
location of the UE which shall include the requested location information.
3) The MME can send a Cancel Location Reporting message to inform the eNodeB
that it should terminate location reporting for a given UE. This message is
needed only when the reporting was requested for a reporting period.
NOTE 2: Location reporting is transferred during X2 handover, although new
control signalling is not transferred during an active handover.
## 5.10 Multiple-PDN support
### 5.10.1 General
The EPS shall support simultaneous exchange of IP traffic to multiple PDNs
through the use of separate PDN GWs or single PDN GW. The usage of multiple
PDNs is controlled by network policies and defined in the user subscription.
The EPS shall support UE-initiated connectivity establishment in order to
allow multiple PDN connections to one or more PDNs. It shall be possible for a
UE to initiate disconnection from any PDN.
All simultaneous active PDN connections of a UE that are associated with the
same APN shall be provided by the same P‑GW.
UE support for multiple PDN connections is optional.
### 5.10.2 UE requested PDN connectivity
The UE requested PDN connectivity procedure for an E-UTRAN is depicted in
figure 5.10.2-1. The procedure allows the UE to request for connectivity to a
PDN including allocation of a default bearer. The PDN connectivity procedure
may trigger one or multiple Dedicated Bearer Establishment procedures to
establish dedicated EPS bearer(s) for that UE.
Figure 5.10.2-1: UE requested PDN connectivity
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 3, 4, 5 and 13a/b concern GTP based S5/S8.
NOTE 2: The UE also uses this procedure to request re-establishment of
existing PDN connectivity upon handover from non-3GPP accesses.
NOTE 3: The steps in (B) are executed only upon handover from non-3GPP access.
1\. The UE initiates the UE Requested PDN procedure by the transmission of a
PDN Connectivity Request (APN, PDN Type, Protocol Configuration Options,
Request Type) message. If the UE was in ECM-IDLE mode, this NAS message is
preceded by the Service Request procedure. PDN type indicates the requested IP
version (IPv4, IPv4v6, IPv6). The MME verifies that the APN provided by UE is
allowed by subscription. If the UE did not provide an APN, the MME shall use
the APN from the default PDN subscription context, and, use this APN for the
remainder of this procedure. Protocol Configuration Options (PCO) are used to
transfer parameters between the UE and the PDN GW, and are sent transparently
through the MME and the Serving GW. The Protocol Configuration Options may
include the Address Allocation Preference, which indicates that the UE prefers
to obtain an IPv4 address only after the default bearer activation by means of
DHCPv4. If the UE has UTRAN or GERAN capabilities, it should send the NRSU in
the PCO to indicate the support of the network requested bearer control in
UTRAN/GERAN. The Request Type indicates \"initial request\" if the UE requests
new additional PDN connectivity over the 3GPP access network. For multiple PDN
connections, the Request Type indicates \"handover\" when the UE is performing
an handover from non-3GPP access and the UE has already established
connectivity with the PDN over the non-3GPP access.
2\. If the Request Type indicates \"Handover\", the MME uses the PDN GW stored
in the Subscription Data retrieved by the MME during the Update Location
performed at attach. If the Request Type indicates \"initial request\" the MME
selects a PDN GW as described in clause 4.3.8.1 on PDN GW Selection Function
(3GPP accesses), allocates a Bearer Id, and sends a Create Session Bearer
Request (IMSI, MSISDN, MME TEID for control plane, RAT type, PDN GW address,
PDN Address, Default EPS Bearer QoS, PDN Type, subscribed APN-AMBR, APN, EPS
Bearer Id, Protocol Configuration Options, Handover Indication, ME Identity,
User Location Information (ECGI), MS Info Change Reporting support indication,
Selection Mode, Charging Characteristics, Trace Reference, Trace Type, Trigger
Id, OMC Identity, Maximum APN Restriction, Dual Address Bearer Flag) message
to the Serving GW.
The RAT type is provided in this message for the later PCC decision. The
MSISDN is included if the MME has it stored for that UE. Handover Indication
is included if the Request Type indicates \"handover\". Selection Mode
indicates whether a subscribed APN was selected, or a non-subscribed APN sent
by the UE was selected. The P‑GW may use Selection Mode when deciding whether
to accept or reject the default bearer activation. For example, if an APN
requires subscription, the P‑GW is configured to accept only the default
bearer activation that requests a subscribed APN as indicated by Selection
Mode. Charging Characteristics indicates which kind of charging the bearer
context is liable for.
The charging characteristics for the PS subscription and individually
subscribed APNs as well as the way of handling Charging Characteristics and
whether to send them or not to the P‑GW is defined in TS 32.251 [44]. The MME
shall include Trace Reference, Trace Type, Trigger Id, and OMC Identity if
S‑GW and/or P‑GW trace is activated. The MME shall copy Trace Reference, Trace
Type, and OMC Identity from the trace information received from the HLR or
OMC.
The Maximum APN Restriction denotes the most stringent restriction as required
by any already active bearer context. If there are no already active bearer
contexts, this value is set to the least restrictive type (see clause 15.4 of
TS 23.060 [7]). If the P‑GW receives the Maximum APN Restriction, then the
P‑GW shall check if the Maximum APN Restriction value does not conflict with
the APN Restriction value associated with this bearer context request. If
there is no conflict the request shall be allowed, otherwise the request shall
be rejected with sending an appropriate error cause to the UE.
If the PDN subscription context contains a subscribed IPv4 address and/or IPv6
prefix, the MME indicates it in the PDN address. The MME may change the
requested PDN type according to the subscription data for this APN as
described in clause 5.3.1.1. The MME shall set the Dual Address Bearer Flag
when the PDN type is set to IPv4v6 and all SGSNs which the UE may be handed
over to are Release 8 or above supporting dual addressing, which is determined
based on node pre-configuration by the operator.
3\. The Serving GW creates a new entry in its EPS Bearer table and sends a
Create Session Request (IMSI, MSISDN, Serving GW Address for the user plane,
Serving GW TEID of the user plane, Serving GW TEID of the control plane, RAT
type, Default EPS Bearer QoS, PDN Type, PDN Address, subscribed APN-AMBR, APN,
Bearer Id, Protocol Configuration Options, Handover Indication, ME Identity,
User Location Information (ECGI), MS Info Change Reporting support indication,
Selection Mode, Charging Characteristics, Trace Reference, Trace Type, Trigger
Id, OMC Identity, Maximum APN Restriction, Dual Address Bearer Flag) message
to the PDN GW indicated in the PDN GW address received in the previous step.
After this step, the Serving GW buffers any downlink packets it may receive
from the PDN GW until receives the message in step 13 below. The MSISDN is
included if received from the MME. If the Handover Indication is included, the
Serving GW includes it in the Create Session Request message.
4\. If dynamic PCC is deployed and the Handover Indication is not present, the
PDN GW may employ an IP‑CAN Session Establishment procedure as defined in TS
23.203 [6] with the PCRF to get the default PCC rules for the UE. This may
lead to the establishment of a number of dedicated bearers following the
procedures defined in clause 5.4.1 in association with the establishment of
the default bearer which is described in Annex F.
The RAT type is provided to the PCRF by the PDN GW if received by the previous
message. If the PDN GW/PCEF is configured to activate predefined PCC rules for
the default bearer, the interaction with the PCRF is not required (e.g.
operator may configure to do this) at the moment.
The PCRF may modify the APN-AMBR and the QoS parameters (QCI and ARP)
associated with the default bearer in the response to the PDN GW as defined in
TS 23.203 [6].
If dynamic PCC is deployed and the Handover Indication is present, the PDN GW
executes a PCEF‑Initiated IP‑CAN Session Modification procedure with the PCRF
as specified in TS 23.203 [6] to report the new IP‑CAN type. Depending on the
active PCC rules, the establishment of dedicated bearer for the UE may be
required. The establishment of those bearers shall take place in combination
with the default bearer activation as described in Annex F. This procedure can
continue without waiting for a PCRF response. If changes to the active PCC
rules are required, the PCRF may provide them after the handover procedure is
finished.
In both cases (Handover Indication is present or not), if dynamic PCC is not
deployed, the PDN GW may apply local QoS policy. This may lead to the
establishment of a number of dedicated bearers for the UE following the
procedures defined in clause 5.4.1 in combination with the establishment of
the default bearer, which is described in Annex F.
5\. The P‑GW creates a new entry in its EPS bearer context table and generates
a Charging Id. The new entry allows the P‑GW to route user plane PDUs between
the S‑GW and the packet data network, and to start charging. The way the P‑GW
handles Charging Characteristics that it may have received is defined in TS
32.251 [44].
The PDN GW returns a Create Session Response (PDN GW Address for the user
plane, PDN GW TEID of the user plane, PDN GW TEID of the control plane, PDN
Type, PDN Address, EPS Bearer Id, EPS Bearer QoS, Protocol Configuration
Options, Charging Id, Prohibit Payload Compression, APN Restriction, Cause, MS
Info Change Reporting Action (Start) (if the PDN GW decides to receive UE\'s
location information during the session), APN-AMBR) message to the Serving GW.
The PDN GW takes into account the received PDN type, the Dual Address Bearer
Flag and the policies of operator when the PDN GW selects the PDN type to be
used as follows. If the received PDN type is IPv4v6 and both IPv4 and IPv6
addressing are possible in the PDN but the Dual Address Bearer Flag is not
set, or only single IP version addressing for this APN is possible in the PDN,
the PDN GW selects a single IP version (either IPv4 or IPv6). If the received
PDN type is IPv4 or IPv6, the PDN GW uses the PDN type if it is supported in
the PDN, otherwise an appropriate error cause will be returned. The PDN GW
allocates a PDN Address according to the selected PDN Type If the PDN GW has
selected a PDN type different from the received PDN Type, the PDN GW indicates
together with the PDN type IE a reason cause to the UE why the PDN type has
been modified, as described in clause 5.3.1.1. PDN Address may contain an IPv4
address for IPv4 and/or an IPv6 prefix and an Interface Identifier. If the PDN
has been configured by the operator so that the PDN addresses for the
requested APN shall be allocated by usage of DHCPv4 only, or if the PDN GW
allows the UE to use DHCPv4 for address allocation according to the Address
Allocation Preference received from the UE, the PDN Address shall be set to
0.0.0.0, indicating that the IPv4 address shall be negotiated by the UE with
after completion of the Default Bearer Activation procedure. For external PDN
addressing for IPv6, the PDN GW obtains the IPv6 prefix from the external PDN
using either RADIUS or Diameter client function. In the PDN Address field of
the Create Session Response, the PDN GW includes the Interface Identifier and
IPv6 prefix. The PDN GW sends Router Advertisement to the UE after default
bearer establishment with the IPv6 prefix information for all cases. If the
PDN address is contained in the Create Session Request, the PDN GW shall
allocate the IPv4 address and/or IP6 prefix contained in the PDN address to
the UE. If Handover Indication indicates \"Handover\", the PDN Address
Information shall contain the same IP address the UE obtained during PDN
connectivity establishment over the non-3GPP access. The PDN GW derives the
BCM based on the NRSU and operator policy. Protocol Configuration Options
contains the BCM as well as optional PDN parameters that the P‑GW may transfer
to the UE. These optional PDN parameters may be requested by the UE, or may be
sent unsolicited by the P‑GW. Protocol Configuration Options are sent
transparently through the MME.
When the Handover Indication is present, the PDN GW does not yet send downlink
packets to the S‑GW; the downlink path is to be switched at step 13a.
6\. If the MS Info Change Reporting Action (Start) is received for this bearer
context, then the S‑GW shall store this for the bearer context and the S‑GW
shall report to that P‑GW whenever a UE\'s Location Information change occurs
that meets the P‑GW request, as described in clause 15.1.1a of TS 23.060 [7].
The Serving GW returns a Create Session Response (PDN Type, PDN Address,
Serving GW address for User Plane, Serving GW TEID for User Plane, Serving GW
TEID for control plane, EPS Bearer Id, EPS Bearer QoS, Protocol Configuration
Options, Prohibit Payload Compression, APN Restriction, Cause, MS Info Change
Reporting Action (Start), APN-AMBR) message to the MME. The DL TFT for PMIP-
based S5/S8 is obtained from interaction between the Serving GW and the PCRF
as described in clause 5.6.1 of TS 23.402 [2], when PCC is deployed;
otherwise, the DL TFT IE is wildcarded, matching any downlink traffic. If the
UE indicates the Request Type as \"Handover\", this message also serves as an
indication to the MME that the S5/S8 bearer setup and update has been
successful. At this step the GTP tunnel(s) over S5/S8 are established.
7\. If an APN Restriction is received, then the MME shall store this value for
the Bearer Context and the MME shall check this received value with the stored
value for the Maximum APN Restriction to ensure there are no conflicts between
values. If the consequence of this check results in the PDN connectivity being
rejected, the MME shall initiate a Bearer Deactivation and return an
appropriate error cause. If the PDN Connectivity Request is accepted, the MME
shall determine a (new) value for the Maximum APN Restriction. If there is no
previously stored value for Maximum APN Restriction, then the Maximum APN
Restriction shall be set to the value of the received APN Restriction.
If the MS Info Change Reporting Action (Start) is received for this bearer
context, then the MME shall store this for the bearer context and the MME
shall report whenever a UE\'s Location Information change occurs that meets
the request, as described in clause 15.1.1a of TS 23.060 [7].
The MME may need to modify the UE AMBR, which has been assigned to the eNodeB,
based on the subscribed UE-AMBR and the updated set of APN-AMBRs in use. The
principles to determine the UE-AMBR are described in clause 4.7.3.
The MME sends PDN Connectivity Accept (APN, PDN Type, PDN Address, EPS Bearer
Id, Session Management Request, Protocol Configuration Options) message to the
UE. This message is contained in an S1_MME control message Bearer Setup
Request (EPS Bearer QoS, UE-AMBR, PDN Connectivity Accept, S1-TEID) to the
eNodeB. This S1 control message includes the TEID at the Serving GW used for
user plane and the address of the Serving GW for user plane. In the PDN
Connectivity Accept message, the MME does not include the IPv6 prefix within
the PDN Address. The MME includes the APN-AMBR and the EPS Bearer QoS
parameter QCI into the Session Management Request. Furthermore, if the UE has
UTRAN or GERAN capabilities, the MME uses the EPS bearer QoS parameters to
derive the corresponding PDP context parameters QoS Negotiated (R99 QoS
profile), Radio Priority, Packet Flow Id and TI and includes them in the
Session Management Request. If the UE indicated in the UE Network Capability
that it does not support BSS packet flow procedures, then the MME shall not
include the Packet Flow Id. MME will not send the S1 Bearer Setup Request
message until any outstanding S1 Bearer Setup Response message for the same UE
has been received or timed out. If the APN-AMBR has changed the MME may update
the UE-AMBR if appropriate.
If the MME or PDN GW has changed the PDN Type, an appropriate reason cause
shall be returned to the UE as described in clause 5.3.1.1.
8\. The eNodeB sends RRC Connection Reconfiguration to the UE including the
PDN Connectivity Accept message. The UE shall store the QoS Negotiated, Radio
Priority, Packet Flow Id and TI, which it received in the Session Management
Request IE, for use when accessing via GERAN or UTRAN. The UE may provide EPS
Bearer QoS parameters to the application handling the traffic flow. The
application usage of the EPS Bearer QoS is implementation dependent. The UE
shall not reject the RRC Connection Reconfiguration on the basis of the EPS
Bearer QoS parameters contained in the Session Management Request.
If the UE receives an IPv4 address set to 0.0.0.0, it may negotiate the IPv4
address with DHCPv4 as specified in TS 29.061 [38], If the UE receives an IPv6
interface identifier, it may wait for the Router Advertisement from the
network with the IPv6 prefix information or it may send a Router Solicitation
if necessary.
NOTE 4: The IP address allocation details are described in clause 5.3.1 on
\"IP Address Allocation\".
9\. The UE sends the RRC Connection Reconfiguration Complete to the eNodeB.
10\. The eNodeB send an S1-AP Bearer Setup Response to the MME. The S1-AP
message includes the TEID of the eNodeB and the address of the eNodeB used for
downlink traffic on the S1_U reference point.
11\. The UE NAS layer builds a PDN Connectivity Complete message including EPS
Bearer Identity. The UE then sends a Direct Transfer (PDN Connectivity
Complete) message to the eNodeB.
12\. The eNodeB sends an Uplink NAS Transport (PDN Connectivity Complete)
message to the MME.
After the PDN Connectivity Accept message and once the UE has obtained a PDN
Address Information, the UE can then send uplink packets towards the eNodeB
which will then be tunnelled to the Serving GW and PDN GW. If the UE requested
for a dual address PDN type (IPv4v6) to a given APN and was granted a single
address PDN type (IPv4 or IPv6) by the network with a reason cause indicating
that only single IP version per PDN connection is allowed, the UE may request
for the activation of a parallel PDN connection to the same APN with a single
address PDN type (IPv4 or IPv6) other than the one already activated. If the
UE receives no reason cause in step 8 in response to a IPv4v6 PDN type and it
receives an IPv6 Interface Identifier apart from the IPv4 address or 0.0.0.0
in the PDN Address field, it considers that the request for a dual address PDN
was successful. It can wait for the Router Advertisement from the network with
the IPv6 prefix information or it may send Router Solicitation if necessary.
13\. Upon reception of the Bearer Setup Response message in step 10 and the
PDN Connectivity Complete message in step 12, the MME sends a Modify Bearer
Request (EPS Bearer Identity, eNodeB address, eNodeB TEID, Handover
Indication) message to the Serving GW. If Request Type indicates \"handover\",
the Handover Indication is also included.
13a. If the Handover Indication is included in step 13, the Serving GW sends a
Modify Bearer Request (Handover Indication) message to the PDN GW to prompt
the PDN GW to tunnel packets from non 3GPP IP access to 3GPP access system and
immediately start routing packets to the Serving GW for the default and any
dedicated EPS bearers established.
13b. The PDN GW acknowledges by sending Modify Bearer Response to the Serving
GW.
14\. The Serving GW acknowledges by sending Modify Bearer Response (EPS Bearer
Identity) to the MME. The Serving GW can then send its buffered downlink
packets.
15\. After the MME receives Modify Bearer Response in step 14, if Request type
does not indicate handover and an EPS bearer was established and if the
subscription data indicates that the user is allowed to perform handover to
non-3GPP accesses and if this is the first PDN connection associated with this
APN and if the MME selected a PDN GW that is different from the PDN GW
identity which was previously indicated by the HSS in the PDN subscription
context, the MME shall send a Notify Request including the PDN GW address and
the APN to the HSS for mobility with non-3GPP accesses. The message shall also
include information that identifies the PLMN in which the PDN GW is located.
16\. The HSS stores the PDN GW identity and the associated APN, and sends a
Notify Response to the MME.
NOTE 5: For handover from non-3GPP access, the PDN GW initiates resource
allocation deactivation procedure in the trusted/untrusted non-3GPP IP access
as specified in TS 23.402 [2].
### 5.10.3 UE or MME requested PDN disconnection
The UE or MME requested PDN disconnection procedure for an E-UTRAN is depicted
in figure 5.10.3-1. The procedure allows the UE to request for disconnection
from one PDN. Bearers including the default bearer of this PDN shall be
deleted during this procedure. The procedure also allows the MME to initiate
the release of a PDN connection.
This procedure is not used to terminate the last PDN connection. The UE uses
the UE-initiated Detach procedure in clause 5.3.8.2 to disconnect the last PDN
connection. The MME uses the MME-initiated Detach procedure in clause 5.3.8.3
to release the last PDN connection.
Figure 5.10.3-1: UE or MME requested PDN disconnection
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 3, 4 and 5 concern GTP based S5/S8.
1\. The procedure is triggered by either step 1a or step 1b.
1a. The UE initiates the UE requested PDN disconnection procedure by the
transmission of a PDN Disconnection Request (LBI) message. The LBI indicates
the default bearer associated with the PDN connection being disconnected. If
the UE was in ECM-IDLE mode, this NAS message is preceded by the Service
Request procedure.
1b. The MME decides to release the PDN connection. This may be e.g. due to
change of subscription or lack of resources.
2\. The EPS Bearers in the Serving GW for the particular PDN connection are
deactivated by the MME by sending Delete Session Request (TEID, LBI) to the
Serving GW. This message includes an indication that all bearers belonging to
that PDN connection shall be released. If the PDN GW requested UE\'s location
info (determined from the UE context), the MME also includes the User Location
Information IE in this message.
NOTE 2: If the PDN connection release was initiated by the MME the User
Location Information signalled to PDN GW is the last known location of the UE
(last known ECGI) stored by the MME. In this release of the specification, the
MME cannot signal to the PDN GW the time when the User Location Information
was acquired last.
3\. The Serving GW sends Delete Session Request (TEID, LBI) to the PDN GW. The
S‑GW also includes User Location Information IE if it is present in step 2.
4\. The PDN GW acknowledges with Delete Session Response.
5\. The PDN GW employs the PCEF-initiated IP‑CAN Session Termination procedure
as defined in TS 23.203 [6] to indicate to the PCRF that the IP-CAN session is
released if PCRF is applied in the network.
6\. The Serving GW acknowledges with Delete Session Response.
7\. The MME initiates the deactivation of all Bearers associated with the PDN
connection to the eNodeB by sending the Deactivate Bearer Request message to
the eNodeB. The MME shall re-calculate the UE-AMBR (see clause 4.7.3.) and
then provide the UE-AMBR to the eNodeB.
8\. The eNodeB releases the corresponding radio bearers by sending the RRC
Connection Reconfiguration message to the UE.
9\. The UE releases all resources corresponding to the PDN connection and
acknowledges this by sending the RRC Connection Reconfiguration Complete
message to the eNodeB.
10\. The eNodeB sends an acknowledgement of the deactivation to the MME.
The MME determines the Maximum APN Restriction for the remaining PDN
connections and stores this new value for the Maximum APN Restriction.
## 5.11 UE Capability Handling
### 5.11.1 General
The UE Capability information is made up of the UE Radio Capability
information and the UE Core Network Capability information.
### 5.11.2 UE Radio Capability Handling
The UE Radio Capability information contains information on RATs that the UE
supports (e.g. power class, frequency bands, etc). Consequently, this
information can be sufficiently large (e.g. >50 octets) that it is undesirable
to send it across the radio interface at every transition from ECM‑IDLE to
ECM‑CONNECTED. To avoid this radio overhead, the MME stores the UE Capability
information during ECM‑IDLE state and the MME shall, if it is available, send
its most up to date UE Radio Capability information to the E‑UTRAN in the S1
interface INITIAL CONTEXT SETUP REQUEST message unless the UE is performing an
Attach procedure or a Tracking Area Update procedure for the \"first TAU
following GERAN/UTRAN Attach\" or for a \"UE radio capability update\".
NOTE 1: For a GERAN/UTRAN/E-UTRAN capable UE, the UE Radio Capability
information that the MME stores is broadly equivalent to the combination of
the MS Radio Access capability sent in the TS 24.008 [47] Attach Request or
RAU Request messages plus the E-UTRAN Inter RAT Handover information sent in
the TS 24.008 [47] Attach Complete or RAU Complete messages. The UTRAN Radio
Capabilities are excluded owing to issues with the handling of dynamic UMTS
security parameters.
If the UE is performing an Attach procedure or a Tracking Area Update
procedure for the \"first TAU following GERAN/UTRAN Attach\" or for \"UE radio
capability update\", the MME shall delete (or mark as deleted) any UE Radio
Capability information that it has stored, and, if the MME sends an S1
interface INITIAL CONTEXT SETUP REQUEST message during that procedure, the MME
shall not send any UE Radio Capability information to the E‑UTRAN in that
message. This triggers the E‑UTRAN to request the UE Radio Capability from the
UE and upload it to the MME in the S1 interface UE CAPABILITY INFO INDICATION
message.
If the UE is performing a Service Request (or other) procedure and the MME
does not have UE Radio Capability information available (or it is available,
but marked as \"deleted\"), then the MME sends an S1 interface INITIAL CONTEXT
SETUP REQUEST message to the E‑UTRAN without any UE Radio Capability
information in it. This triggers the E‑UTRAN to request the UE Radio
Capability from the UE and upload it to the MME in the S1 interface UE
CAPABILITY INFO INDICATION message.
NOTE 2: This use of the INITIAL CONTEXT SETUP REQUEST message means that for a
signalling only procedure such as a periodic Tracking Area Update, the UE
Radio Capability would not be sent to the E‑UTRAN.
NOTE 3: If a \"first TAU following GERAN/UTRAN Attach\" Tracking Area Update
is performed during ECM-CONNECTED mode, e.g. after an inter RAT handover, no
INITIAL CONTEXT SETUP REQUEST is sent and the UE Radio Capability information
in the MME will remain deleted until the next ECM-IDLE to ECM-CONNECTED
transition (or later, e.g. if the next activity from the UE is another
Tracking Area Update).
The UE Radio Capability is not provided directly from one CN node to another.
It will be uploaded to the MME when the E-UTRAN requests the UE Radio
Capability information from the UE.
During handover via the MME (both intra RAT and inter RAT), the radio
capability information for the source and target 3GPP RATs (with the possible
exception of UTRAN) are transferred in the \"source to target transparent
container\". Information on additional 3GPP RATs is optionally transferred in
the \"source to target transparent container\". Transfer of the radio
capability information related to the source and/or additional RATs is
beneficial as it avoids the need for the target RAT to retrieve the
information from the UE prior to a subsequent inter-RAT handover.
Owing to issues with dynamic UTRAN security parameters, special rules apply to
the handling of the UTRAN radio capability information at inter-RAT handover
(see e.g. the HandoverPreparationInformation message description in TS 36.331
[37] and the usage of the PS Handover Complete Ack message in TS 43.129 [8]
and TS 48.018 [42]).
To allow for the addition of future radio technologies, frequency bands, and
other enhancements, the MME shall store the UE Radio Capability Information
even if it is larger than specified in TS 36.331 [37], up to a maximum size of
510 octets.
NOTE 4: The 510 octet value comes from the information element encoding rules
described in TS 24.007 [45] and the assumption that the information contained
within this UE Radio Capability Information Element stored by the MME is the
equivalent of information signalled in two information elements in the GERAN
NAS signalling for the case of GERAN to E‑UTRAN PS handover.
The E‑UTRAN stores the UE Radio Capability information, received in the S1
interface INITIAL CONTEXT SETUP REQUEST message or obtained from the UE, for
the duration of the RRC connection for that UE. Before any handover attempt
from E-UTRAN to UTRAN, the E-UTRAN retrieves the UE\'s UTRAN Radio
Capabilities from the UE.
If the UE\'s non-UTRAN UE Radio Capability information changes while in ECM-
IDLE state (including cases of being in GERAN/UTRAN coverage), the UE shall
perform a Tracking Area Update indicating \"UE radio capability update\" when
it next returns to E‑UTRAN coverage.
NOTE 5: In this release of the specifications, \"UE radio capability update\"
is only supported for changes of GERAN radio capabilities in ECM-IDLE. Any
change in the UE\'s E‑UTRAN capabilities requires the UE to detach and then
re-attach to the system.
### 5.11.3 UE Core Network Capability
The UE Core Network Capability is split into the UE Network Capability IE
(mostly for E-UTRAN access related core network parameters) and the MS Network
Capability IE (mostly for UTRAN/GERAN access related core network parameters)
and contains non radio-related capabilities, e.g. the NAS security algorithms
etc. Both the UE Network Capability and the MS Network Capability are
transferred between CN nodes at MME to MME, MME to SGSN, SGSN to SGSN, and
SGSN to MME changes.
In order to ensure that the UE Core Network Capability information stored in
the MME is up to date (e.g. to handle the situation when the USIM is moved
into a different device while out of coverage, and the old device did not send
the Detach message; and the cases of inter-RAT Tracking Area Update), the UE
shall send the UE Core Network Capability information to the MME during the
Attach and non-periodic Tracking Area Update procedure within the NAS message.
The MME shall store always the latest UE Core Network Capability received from
the UE. Any UE Core Network Capability that an MME receives from an old
MME/SGSN is replaced when the UE provides the UE Core Network Capability with
Attach and the Tracking Area Update signalling. The MME shall remove the
stored MS Network Capability, if MS Network Capability is not included in
Attach or non-periodic Tracking Area Update signaling e.g. UE is only capable
of E-UTRAN.
If the UE\'s UE Core Network Capability information changes (in either ECM-
CONNECTED or in ECM-IDLE state (including cases of being in GERAN/UTRAN
coverage and having ISR activated)), the UE shall perform a Tracking Area
Update (\'type\' different to \'periodic\') when it next returns to E‑UTRAN
coverage - see clause 5.3.3.0.
To allow for the addition of future features, the MME shall store the UE
Network Capability and the MS Network Capability even if either or both is
larger than specified in TS 24.008 [47]/TS 24.301 [46], up to a maximum size
of 32 octets for each IE.
## 5.12 Warning message delivery
### 5.12.1 General
Warning message delivery is similar to Cell Broadcast Service defined in TS
23.041 [48], it permits a number of unacknowledged Warning messages to be
broadcast to UEs within a particular area.
The maximum size of the Warning message for E‑UTRAN is different from that of
UTRAN/GERAN.
When S1-flex is used, the eNodeB may receive duplicated Warning messages.
For details on the Warning system message delivery, see TS 23.041 [48].
### 5.12.2 Void
## 5.13 Discontinuous Reception and UE Specific DRX Parameter handling
During the Attach procedure in E-UTRAN, UTRAN and/or GERAN, the UE signals its
UE Specific DRX Parameters to the Core Network (MME in the E-UTRAN case and
SGSN in UTRAN/GERAN case).
In E-UTRAN and UTRAN, the UE may signal that it wishes to use the DRX cycle
length broadcast in the RAN\'s System Information. Alternatively, the UE can
propose a DRX cycle length. The MME shall accept the value proposed by the UE.
In each S1 interface Page Request message, the MME shall send the E-UTRAN
relevant information from the UE Specific DRX Parameters (to help determine
the DRX cycle length) and information derived from the IMSI (which defines
when the UE will be awake from its sleep mode). Details are specified in TS
36.304 [34].
NOTE 1: To ease backward compatibility with Pre-Release 8 SGSNs, the UTRAN and
E-UTRAN DRX cycle lengths are encoded in the same field within the TS 24.008
[47] DRX parameter information element.
At MME to MME, MME to SGSN and SGSN to MME mobility, the UE Specific DRX
Parameters are sent from the old CN node to the new CN node as part of the MM
context information and should not be sent by the UE in the Tracking Area
Update message.
NOTE 2: it is assumed that all SGSNs are Release 99 or newer and hence support
storage of the Release \'99 encoding of the TS 24.008 [47] DRX parameter
information element.
If a CN node receives UE Specific DRX Parameters in a dedicated message from
the UE (e.g. in a Tracking Area Update or Attach message), then the CN node
updates any stored information with the information supplied by the UE and
uses the UE provided information in preference to any information that might
be received from another CN node during the same procedure.
If the UE wishes to alter its GERAN or UTRAN/E-UTRAN UE Specific DRX
Parameters while in E-UTRAN, then it shall send a Tracking Area Update Request
message to the MME containing its new UE Specific DRX Parameters. If ISR had
been activated for the UE, then the UE shall deactivate ISR by setting its TIN
to \"GUTI\" so that the UE performs a Routing Area Update when it next enters
GERAN/UTRAN coverage. When the UE performs that Routing Area Update, the SGSN
will receive the updated DRX parameters within the MM context information sent
by the MME and hence the UE should not include them again in the Routing Area
Update Request message.
If the UE wishes to alter its E‑UTRAN/UTRAN or GERAN DRX Parameters while in
GERAN or UTRAN coverage, then the UE shall send a Routing Area Update Request
message to the SGSN containing its new UE DRX Parameters. If ISR has been
activated, the UE shall deactivate ISR by setting its TIN to \"P‑TMSI\" so
that the UE performs a Tracking Area Update when it next returns to E‑UTRAN
coverage. When the UE performs that Tracking Area Update, the MME will receive
the updated DRX parameters within the MM context information sent by the SGSN
and hence the UE should not include them again in the Tracking Area Update
message.
## 5.14 Configuration Transfer procedure
The purpose of the Configuration Transfer is to enable the transfer of
information between two eNodeBs at any time via S1 interface and the Core
Network. An example of application is to exchange the eNodeBs IP addresses in
order to be able to use X2 interface between the eNodeBs for Self-Optimized
Networks (SON), as specified in TS 36.413 [36].
### 5.14.1 Architecture Principles for Configuration Transfer
Configuration Transfer between two eNodeBs follows the principles used by RAN
Information Management (RIM) procedures (see clause 5.6.2) between UTRAN,
E-UTRAN and GERAN i.e. providing a generic mechanism for the exchange of
arbitrary information between applications belonging to the RAN nodes. However
Configuration Transfer is only used for intra-RAT E-UTRAN information exchange
whereas RIM procedures are designed for inter-RAT information exchange. Such a
separate procedure allows avoiding impacts to other RAT access systems when
transferred information is added or modified.
The information is transferred via the MME core network node(s). In order to
make the information transparent for the Core Network, the information is
included in an E-UTRAN transparent container that includes source and target
eNodeB addresses, which allows the Core Network nodes to route the messages.
The mechanism is depicted in figure 5.14 1. An example for such transferred
information is the SON information, as specified in TS 36.413 [36].
Figure 5.14-1: inter E-UTRAN Configuration Transfer basic network architecture
The E-UTRAN transparent containers are transferred from the source E-UTRAN
node to the destination E-UTRAN node by use of Configuration Transfer
messages.
An ENB Configuration Transfer message is used from the eNodeB to the MME over
S1 interface, a MME Configuration Transfer message is used from the MME to the
eNodeB over S1 interface, and a Configuration Transfer Tunnel message is used
to tunnel the E-UTRAN transparent container from a source MME to a target MME
over the S10 interface.
Each Configuration Transfer message carrying the E-UTRAN transparent container
is routed and relayed independently by the core network node(s). Any relation
between messages is transparent for the MME, i.e. a request/response exchange
between applications, for example SON applications, is routed and relayed as
two independent messages by the MME. An MME supporting the Configuration
Transfer procedures provides addressing, routing and relaying functions.
### 5.14.2 Addressing, routing and relaying
#### 5.14.2.1 Addressing
All the Configuration Transfer messages contain the addresses of the source
and destination RAN nodes. An eNodeB is addressed by the Target eNodeB
Identifier.
#### 5.14.2.2 Routing
The following description applies to all the Configuration Transfer messages
used for the exchange of an E-UTRAN transparent container.
The source RAN node sends a message to its MME including the source and
destination addresses. The MME uses the destination address to route the
message encapsulated in a GTP message to the correct MME via the S10 interface
(see TS 29.274 [43]).
The MME connected to the destination RAN node decides which RAN node to send
the message to, based on the destination address.
#### 5.14.2.3 Relaying
The MME performs relaying between GTPv2 messages as described in TS 29.274
[43]. The MME performs relaying between S1 and S10 messages as described in TS
36.413 [36] and TS 29.274 [43].
#### 5.14.2.4 Applications using the Configuration Transfer procedures
The RAN node applications, which use the Configuration Transfer procedures,
are fully transparent for the MME. These applications are described in RAN
specifications. An example of application is the transfer of information
required for Self-Optimized Networks (SON).
###### ### Annex A: Void
###### ### Annex B: Void
###### ### Annex C: Void
###### ## Annex D (normative): Interoperation with Gn/Gp SGSNs
# D.1 General Considerations
This annex specifies interworking between the EPS and 3GPP 2G and/or 3G SGSNs,
which provide only Gn and Gp interfaces but no S3, S4 or S5/S8 interfaces,
i.e. these Gn/Gp SGSNs provide no functionality that is introduced
specifically for the EPS or for interoperation with the E-UTRAN.
Interoperation scenarios for operating E-UTRAN with a PLMN maintaining Gn/Gp
SGSNs are supported only with a GTP-based S5/S8.
NOTE: PMIP-based S5/S8 may be used, but does not support handovers between the
Gn/Gp SGSN and MME/S‑GW.
The S5/S8 interface for the Operator with Gn/Gp SGSNs will be GTP-based, but
can be changed to PMIP-based S5/S8 when the Gn/Gp SGSNs evolve to S4 SGSNs.
For these interoperation scenarios the GERAN/UTRAN has to support
interoperation with E‑UTRAN.
# D.2 Interoperation Scenario
## D.2.1 Roaming interoperation scenario
In the roaming scenario the vPLMN operates Gn/Gp 2G and/or 3G SGSNs as well as
MME and S‑GW for E-UTRAN access. The hPLMN operates a P‑GW.
Roaming and inter access mobility between Gn/Gp 2G and/or 3G SGSNs and an
MME/S‑GW are enabled by:
\- Gn functionality as specified between two Gn/Gp SGSNs, which is provided by
the MME, and
\- Gp functionality as specified between Gn/Gp SGSN and Gn/Gp GGSN that is
provided by the P‑GW.
All this Gp and Gn functionality bases on GTP version 1 only.
The architecture for interoperation with Gn/Gp SGSNs in the non-roaming case
is illustrated in Figure D.2.1-1.
**Figure D.2.1-1** : Roaming architecture for interoperation with Gn/Gp SGSN
## D.2.2 Non-roaming interoperation scenario
In the non-roaming scenario the PLMN operates Gn/Gp 2G and/or 3G SGSNs as well
as MME and S‑GW for E-UTRAN access.
Intra PLMN roaming and inter access mobility between Gn/Gp 2G and/or 3G SGSNs
and an MME/S‑GW are enabled by:
\- Gn functionality as specified between two Gn/Gp SGSNs, which is provided by
the MME, and
\- Gn functionality as specified between Gn/Gp SGSN and Gn/Gp GGSN that is
provided by the P‑GW.
All this Gn functionality is based on GTP version 1 only.
The architecture for interoperation with Gn/Gp SGSNs in the non-roaming case
is illustrated in Figure D.2.2-1.
**Figure D.2.2-1** : Non-roaming Architecture for interoperation with Gn/Gp
SGSNs
NOTE: If the Rel-7 SGSN applies Direct Tunnel there is a user plane connection
between P‑GW and UTRAN.
# D.3 Interoperation procedures
## D.3.1 General
The interoperation procedures describe information flows for Gn/Gp SGSNs and
other EPS network elements. All messages between Gn/Gp SGSN and MME, between
Gn/Gp SGSN and HSS and between Gn/Gp SGSN and P‑GW as well as the therein
contained information elements are the same as specified for the adequate TS
23.060 [7] procedures that are between Gn/Gp SGSNs. These messages and
procedure step descriptions are taken from TS 23.060 [7] for explanatory
purposes only. These descriptions are in _italic text_ and shall not be
modified by the interoperation procedures. It cannot be assumed that the
messages and procedure step descriptions that are taken from TS 23.060 [7]
will be updated when modifications or corrections are performed for TS 23.060
[7]. If there are any discrepancies for these messages and procedure step
descriptions TS 23.060 [7] takes precedence. The messages between the MME and
any other node than the Gn/Gp SGSN as well as the therein contained
information elements are the same as specified in the main body of this
technical specification for the inter RAT Routing Area Update procedure. If
there are any discrepancies for these messages the descriptions from the main
body of this Technical Specification take precedence.
An operator that has pre-Rel‑8 SGSNs in its network should use separate EPS
bearers for IPv4 and IPv6 addressing, such that both addresses can be
maintained when moving to a pre-Rel‑8 SGSN from a Rel‑8 SGSN or MME (see
clause 5.3.1). This is configured into the SGSN and MME nodes which set the
Dual Address Bearer Flag depending on whether a UE may or may not be handed
over to a pre-Rel‑8 SGSN, as specified in clauses 5.3.2.1 and 5.10.2.
## **D.3.2 Void**
## **D.3.3** MME to 3G SGSN combined hard handover and SRNS relocation
procedure
The MME to 3G Gn/Gp SGSN Combined Hard Handover and SRNS Relocation procedure
is illustrated in Figure D.3.3-1.
Any steps descriptions that are from inter Gn/GP SGSNs procedures of TS 23.060
[7] are shown as _italic text_ and remain unmodified. In those step
descriptions an MS stands for UE, old SGSN for old MME and GGSN for P‑GW.
The procedure parts between E-UTRAN eNodeB and UE, and between E-UTRAN eNodeB
and MME are compliant with the equivalent procedure parts in clause \"5.5
Handover\".
Figure D.3.3-1: MME to 3G SGSN combined hard handover and SRNS relocation
procedure
1\. The source eNodeB decides to initiate a handover to the target access
network, UTRAN Iu mode. At this point both uplink and downlink user data is
transmitted via the following: Bearer(s) between UE and source eNodeB, GTP
tunnel(s) between source eNodeB, Serving GW and PDN GW.
2\. The source eNodeB sends a Handover Required (S1AP Cause, Target RNC
Identifier, Source eNodeB Identifier, Source to Target Transparent Container)
message to the source MME to request the CN to establish resources in the
target RNC and the target SGSN. The bearers that will be subject to data
forwarding (if any) are identified by the new SGSN in a later step (see step 5
below).
3\. The old MME sends a Forward Relocation Request message (IMSI, Tunnel
Endpoint Identifier Signalling, MM Context, PDP Context, Target
Identification, RAN Transparent Container, RANAP Cause, GCSI) to the new SGSN.
For relocation to an area where Intra Domain Connection of RAN Nodes to
Multiple CN Nodes is used, the old MME may have multiple new Gn/Gp SGSNs for
each relocation target in a pool area, in which case the old MME will select
one of them to become the new Gn/Gp SGSN, as specified in TS 23.236 [30]. PDP
context contains GGSN Address for User Plane and Uplink TEID for Data (to this
GGSN Address and Uplink TEID for Data, the Serving GW and the new SGSN send
uplink packets). At the same time a timer is started on the MM and PDP
contexts in the old MME (see Routing Area Update procedure in clause
\"Location Management Procedures (Iu mode)\"). The old MME does not set any
GCSI flag as the MME has no GPRS CAMEL Subscription Information. The S1AP
Cause received from eNodeB is indicated as RANAP Cause. The Source to Target
Transparent Container received from eNodeB is indicated as RAN Transparent
Container.
NOTE 1: The GGSN user plane address and uplink TEID are the old P‑GW user
plane address and TEID. The MME maps the EPS bearer parameters to PDP
contexts.
_4\. The new SGSN sends a Relocation Request message (Permanent NAS UE
Identity, Cause, CN Domain Indicator, Source RNC To Target RNC Transparent
Container, RAB To Be Setup, Service Handover related information) to the
target RNC. For each RAB requested to be established, RABs To Be Setup shall
contain information such as RAB ID, RAB parameters, Transport Layer Address,
and Iu Transport Association. SGSN shall not establish RABs for PDP contexts
with maximum bitrate for uplink and downlink of 0 kbit/s. The list of RABs
requested by the new SGSN may differ from list of RABs established in the
Source RNC contained in the Source-RNC to target RNC transparent container.
The target RNC should not establish the RABs (as identified from the Source-
RNC to target RNC transparent container) that did not exist in the source RNC
prior to the relocation. The RAB ID information element contains the NSAPI
value, and the RAB parameters information element gives the QoS profile. The
Transport Layer Address is the SGSN Address for user data, and the Iu
Transport Association corresponds to the uplink Tunnel Endpoint Identifier
Data. The new SGSN may decide to establish Direct Tunnel unless it has
received a \'set\' GCSI flag from the old SGSN. If the new SGSN decides to
establish Direct Tunnel, it provides to the target RNC the GGSN\'s Address for
User Plane and TEID for Uplink data. If the Access Restriction is present in
the MM context, the Service Handover related information shall be included by
the target SGSN for the Relocation Request message in order for RNC to
restrict the UE in connected mode to handover to the RAT prohibited by the
Access Restriction._
_After all the necessary resources for accepted RABs including the Iu user
plane are successfully allocated, the target RNC shall send the Relocation
Request Acknowledge message (Target RNC To Source RNC Transparent Container,
RABs Setup, RABs Failed To Setup) to the new SGSN. Each RAB to be setup is
defined by a Transport Layer Address, which is the target RNC Address for user
data, and the Iu Transport Association, which corresponds to the downlink
Tunnel Endpoint Identifier for user data. The transparent container contains
all radio-related information that the MS needs for the handover, i.e. a
complete RRC message (e.g., Physical Channel Reconfiguration in UTRAN case, or
Handover From UTRAN, or Handover Command in GERAN Iu mode case) to be sent
transparently via CN and source SRNC to the MS. For each RAB to be set up, the
target RNC may receive simultaneously downlink user packets both from the
source SRNC and from the new SGSN._
NOTE 2: This step for the new SGSN is unmodified compared to pre-Rel-8. If the
new SGSN decides to establish Direct Tunnel, it provides to the target RNC the
P‑GW Address for User Plane and TEID for Uplink data. The UE acts as the MS;
the old eNodeB acts as the source SRNC.
_5\. When resources for the transmission of user data between target RNC and
new SGSN have been allocated and the new SGSN is ready for relocation of SRNS,
the Forward Relocation Response (Cause, RAN Transparent Container, RANAP
Cause, Target-RNC Information) message is sent from the new SGSN to the old
SGSN. This message indicates that the target RNC is ready to receive from
source SRNC the forwarded downlink PDUs, i.e., the relocation resource
allocation procedure is terminated successfully. RAN transparent container and
RANAP Cause are information from the target RNC to be forwarded to the source
SRNC. The Target RNC Information, one information element for each RAB to be
set up, contains the RNC Tunnel Endpoint Identifier and RNC IP address for
data forwarding from the source SRNC to the target RNC. The Forward Relocation
Response message is applicable only in case of inter-SGSN SRNS relocation._
NOTE 3: This step is unmodified compared to pre-Rel-8. The old MME acts as the
old SGSN, and the source eNodeB as the source SRNC.
6\. If \'Indirect Forwarding\' applies the source MME sends a Create Indirect
Data Forwarding Tunnel Request message (IMSI, MME Tunnel Endpoint Identifier
for Control Plane, MME Address for Control plane, Target RNC Address and
TEID(s) for DL user plane) to the Serving GW.
7\. The Serving GW returns a Create Indirect Data Forwarding Tunnel Response
(Cause, Serving GW DL TEID(s)) message to the source MME. If the Serving GW
doesn\'t support data forwarding, an appropriate cause value shall be
returned.
8\. The source MME completes the preparation phase towards source eNodeB by
sending the message Handover Command (Target to Source Transparent Container,
Bearers Subject to Data Forwarding List, S1AP Cause). \"Bearers Subject to
Data forwarding list\" may be included in the message and it shall be a list
of \'Address(es) and TEID(s) for user traffic data forwarding\' received from
target side in the preparation phase (Step 5) in the case of direct forwarding
or received from the Serving GW in the preparation phase (Step 7) in the case
of indirect forwarding. RANAP Cause as received from new SGSN is indicated as
S1AP Cause. RAN Transparent Container as received from new SGSN is indicated
as Target to Source Transparent Container.
9\. The source eNodeB initiates data forwarding for bearers specified in the
\"Bearers Subject to Data Forwarding List\". The data forwarding may go
directly to target RNC or alternatively go via the Serving GW if so decided by
source MME in the preparation phase.
10\. The source eNodeB will give a command to the UE to handover to the target
access network via the message HO from E-UTRAN Command. This message includes
a transparent container including radio aspect parameters that the target RNC
has set-up in the preparation phase. The details of this E-UTRAN specific
signalling are described in TS 36.300 [5].
_11 Void._
NOTE 4: The source eNodeB does not send any RAN contexts towards the target
RNC.
_12\. The target RNC shall send a Relocation Detect message to the new SGSN
when the relocation execution trigger is received. For SRNS relocation type
\"UE Involved\", the relocation execution trigger may be received from the Uu
interface; i.e., when target RNC detects the MS on the lower layers. When the
Relocation Detect message is sent, the target RNC shall start SRNC operation._
NOTE 5: This step is unmodified compared to pre-Rel-8.
_13\. When the MS has reconfigured itself, it sends an RRC message e.g., a
Physical Channel Reconfiguration Complete message to the target SRNC._
The UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\" to
\"GUTI\", if any EPS bearer context activated after the ISR was activated in
the UE exists.
_14\. When the target SRNC receives the appropriate RRC message, e.g. Physical
Channel Reconfiguration Complete message or the Radio Bearer Release Complete
message in UTRAN case, or the Handover To UTRAN Complete message or Handover
Complete message in GERAN case, i.e. the new SRNC‑ID + S‑RNTI are successfully
exchanged with the MS by the radio protocols, the target SRNC shall initiate a
Relocation Complete procedure by sending the Relocation Complete message to
the new SGSN. The purpose of the Relocation Complete procedure is to indicate
by the target SRNC the completion of the relocation of the SRNS to the CN._
NOTE 6: This step is unmodified compared to pre-Rel-8. The UE acts as the MS.
_15\. Upon receipt of Relocation Complete message, if the SRNS Relocation is
an inter SGSN SRNS relocation, the new SGSN signals to the old SGSN the
completion of the SRNS relocation procedure by sending a Forward Relocation
Complete message._
A timer in _source MME is started to supervise when resources in Source eNodeB
and Source_ Serving GW shall be released.
NOTE 7: For the SGSN this step is unmodified compared to pre-Rel-8. The old
MME acts as the old SGSN, and the source eNodeB as the source SRNC.
_16\. Upon receipt of the Relocation Complete message, the CN shall switch the
user plane from the source RNC to the target SRNC. If the SRNS Relocation is
an inter-SGSN SRNS relocation or if Direct Tunnel was established in intra-
SGSN SRNS relocation, the new SGSN sends Update PDP Context Request messages
(new SGSN Address, SGSN Tunnel Endpoint Identifier, QoS Negotiated, serving
network identity, CGI/SAI, RAT type, CGI/SAI/RAI change support indication,
NRSN, DTI) to the GGSNs concerned. The SGSN shall send the serving network
identity to the GGSN. If Direct Tunnel is established the SGSN provides to
GGSN the RNC\'s Address for User Plane and TEID for Downlink data and shall
include the DTI to instruct the GGSN to apply Direct Tunnel specific error
handling procedure as described in clause 13.8. NRSN indicates SGSN support of
the network requested bearer control. The GGSNs update their PDP context
fields and return an Update PDP Context Response (GGSN Tunnel Endpoint
Identifier, Prohibit Payload Compression, APN Restriction, CGI/SAI/RAI change
report required, BCM) message. The Prohibit Payload Compression indicates that
the SGSN should negotiate no data compression for this PDP context._
The PDN GW shall include a Charging Id to be used at the SGSN as the Charging
Id for reporting usage for this PDP context. The PDN GW shall include the
Charging Id in the offline charging data.
NOTE 8: This step is unmodified compared to pre-Rel-8. The P‑GW acts as the
GGSN.
17\. After the MS has finished the reconfiguration procedure and if the new
Routing Area Identification is different from the old one or if the MS\' TIN
indicates \"GUTI\", the MS initiates the Routing Area Update procedure. See
clause \"Location Management Procedures (Iu mode)\".
NOTE 9: It is only a subset of the RA update procedure that is performed,
since the MS is in PMM‑CONNECTED state.
NOTE 10: This step is unmodified compared to pre-Rel-8. The UE acts as the MS.
The old EPS bearer information in old MME and Serving GW is removed as part of
the Routing Area Update procedure.
18\. When the timer started in step 15 expires, the source MME deletes the EPS
bearer resources by sending Delete Session Request (Cause, TEID) messages to
the Serving GW because the new SGSN is a Gn/Gp SGSN, which is derived from
using GTPv1 for relocation signalling between new Gn/Gp SGSN and old MME. The
new Gn/Gp SGSN does not signal any Serving GW change. Cause indicates to the
Serving GW that the Serving GW changes and the Serving GW shall not initiate a
delete procedure towards the PDN GW. The Source Serving GW acknowledges with
Delete Session Response (TEID) messages. If ISR is activated the cause also
indicates to the old S‑GW that the old S‑GW shall delete the bearer resources
on the other old CN node by sending Delete Bearer Request message(s) to that
CN node. If resources for indirect forwarding have been allocated then these
are released.
When the timer started in step 15 expires, the source MME sends a Release
Resources message to the source eNodeB. When the Release Resources message has
been received and there is no longer any need for the eNodeB to forward data,
the source eNodeB releases its resources.
_If the SRNS Relocation is inter-SGSN, then the following CAMEL procedure
calls shall be performed (see referenced procedures in TS 23.078 [29])_
NOTE 11: The C1 CAMEL procedure call was omitted intentionally from this
procedure since EPS does not support CAMEL procedure calls. The other CAMEL
procedure calls are unmodified compared to pre-Rel‑8.
_The new SGSN shall determine the Maximum APN restriction based on the
received APN Restriction of each PDP context from the GGSN and then store the
new Maximum APN restriction value._
_If the SRNS Relocation is intra-SGSN, then the above mentioned CAMEL
procedures calls shall not be performed._
_If Routing Area Update occurs, the SGSN shall determine whether Direct Tunnel
can be used based on the received GPRS CAMEL Subscription Information. If
Direct Tunnel can not be maintained the SGSN shall re-establish RABs and
initiate the Update PDP Context procedure to update the IP Address and TEID
for Uplink and Downlink data._
_If Routing Area Update occurs, then the following CAMEL procedure calls shall
be performed (see referenced procedures in TS 23.078 [29]):_
_C2) CAMEL_GPRS_Routing_Area_Update_Session and CAMEL_PS_Notification._
_They are called in the following order:_
_\- The CAMEL_GPRS_Routing_Area_Update_Session procedure is called. The
procedure returns as result \"Continue\"._
_\- Then the CAMEL_PS_Notification procedure is called. The procedure returns
as result \"Continue\"._
_C3) CAMEL_GPRS_Routing_Area_Update_Context._
_This procedure is called several times: once per PDP context. It returns as
result \"Continue\"._
_For C2 and C3: refer to Routing Area Update procedure description for
detailed message flow._
NOTE 12: Handover Reject is performed as defined in clause 5.5.2.1.4,
excluding steps 4 and 7.
## **D.3.4** 3G SGSN to MME combined hard handover and SRNS relocation
procedure
The 3G Gn/Gp SGSN to MME Combined Hard Handover and SRNS Relocation procedure
is illustrated in Figure D.3.4-1.
Any steps descriptions that are from TS 23.060 [7] are shown as _italic text_
and remain unmodified. In those step descriptions an MS stands for UE, new
SGSN for new MME and GGSN for P‑GW.
The procedure between E-UTRAN eNodeB and UE, and between E-UTRAN eNodeB and
MME are compliant with the equivalent procedure parts in clause 5.5: Handover.
Figure D.3.4-1: 3G Gn/Gp SGSN to MME combined hard handover and SRNS
relocation procedure
1\. The source RNC decides to initiate a handover to E-UTRAN.
_2\. The source SRNC sends a Relocation Required message (Relocation Type,
Cause, Source ID, Target ID, Source RNC To Target RNC Transparent Container)
to the old SGSN. The source SRNC shall set Relocation Type to \"UE Involved\".
Source RNC To Target RNC Transparent Container includes the necessary
information for relocation co‑ordination, security functionality and RRC
protocol context information (including MS Capabilities)._
NOTE 1: This step is unmodified compared to pre-Rel-8. The target eNodeB acts
as the target RNC.
NOTE 1a: The Target ID identifies an eNodeB. With Rel-8 Iu functionality this
is an eNodeB ID. As an implementations option for supporting introduction
scenarios with pre-Rel8 SGSNs the source RNC may be configured to use RNC IDs
instead of eNodeB IDs to identify a target eNodeB. Cause indicates the UTRAN
to E‑UTRAN handover. The Cause is relayed transparently by the SGSN. Source
RNC to Target RNC Transparent Container carries information for the target
eNodeB. This container is relayed transparently by the SGSN.
_3\. The old SGSN determines from the Target ID if the SRNS relocation is
intra-SGSN SRNS relocation or inter-SGSN SRNS relocation. In case of inter-
SGSN SRNS relocation the old SGSN initiates the relocation resource allocation
procedure by sending a Forward Relocation Request message (IMSI, Tunnel
Endpoint Identifier Signalling, MM Context, PDP Context, Target
Identification, RAN Transparent Container, RANAP Cause, GCSI) to the new SGSN.
For relocation to an area where Intra Domain Connection of RAN Nodes to
Multiple CN Nodes is used, the old SGSN may \-- if it provides Intra Domain
Connection of RAN Nodes to Multiple CN Nodes -have multiple target SGSNs for
each relocation target in a pool area, in which case the old SGSN will select
one of them to become the new SGSN, as specified in TS 23.236 [30]. PDP
context contains GGSN Address for User Plane and Uplink TEID for Data (to this
GGSN Address and Uplink TEID for Data, the old SGSN and the new SGSN send
uplink packets). At the same time a timer is started on the MM and PDP
contexts in the old SGSN (see Routing Area Update procedure in clause
\"Location Management Procedures (Iu mode)\"). The Forward Relocation Request
message is applicable only in case of inter-SGSN SRNS relocation. The old SGSN
\'sets\' the GCSI flag if the MM context contains GPRS CAMEL Subscription
Information._
NOTE 2: This step is unmodified compared to pre-Rel-8. The new MME acts as the
new SGSN, and the P‑GW as the GGSN. The GGSN user plane address and uplink
TEID are the P‑GW user plane address and TEID. The MME maps the PDP context
parameters to EPS bearers.
4\. The MME selects a Serving GW and sends a Create Session Request (bearer
context(s) with PDN GW addresses and TEIDs for uplink traffic, APN-AMBR)
message per PDN connection to the target Serving GW. For relocation from Gn/Gp
SGSN, the target MME provides the APN-AMBR based on the mapping from MBR (as
specified in Annex E) to the Serving GW.
5\. The Serving GW allocates the S‑GW addresses and TEIDs for the uplink
traffic on S1_U reference point (one TEID per bearer). The target Serving GW
sends a Create Session Response (Serving GW addresses and uplink TEID(s) for
user plane) message back to the target MME.
6\. The new MME requests the target eNodeB to establish the bearer(s) by
sending the message Handover Request (UE Identifier, S1AP Cause, CN Domain
Indicator, K~eNB~, NAS Security Parameters to E-UTRAN, EPS Bearers to be setup
list, Source to Target Transparent Container, Serving GW Address(es) and
TEID(s) for User Traffic Data, Handover Restriction List). S1AP Cause
indicates the RANAP Cause as received from SGSN. Source to Target Transparent
Container contains the RAN Transparent Container as received from SGSN. The
NAS Security Parameters to E-UTRAN includes the NAS Integrity Protection and
Ciphering algorithm(s), eKSI and NONCE~MME~ IEs information elements. Handover
Restriction List is sent if it is available in the Target MME; it is described
in clause 4.3.5.7.
If the MME did not receive the UE Network Capability information from the old
SGSN, then the MME will not have received information on the E-UTRAN Integrity
Protection and Encryption algorithms that the UE supports. In this case, the
MME can assume that the UE supports both EIA1/EEA1 and EIA2/EEA2.
NOTE 3: The MME derives K\'~ASME~ from CK and IK in the MM context and
associates it with eKSI, as described in TS 33.401 [41] and selects NAS
Integrity Protection and Ciphering algorithms(s). eKSI and key derivation
parameters are targeted for UE. The MME and UE derive the NAS keys and K~eNB~
from K\'~ASME~. If the MME shares an EPS security association with the UE, the
MME may activate this native EPS security context by initiating a NAS SMC
procedure after having completed the handover procedure.
The MME shall not request the target eNodeB to establish EPS GBR bearers with
maximum bitrate set to 0 and those EPS bearers should not be included in the
EPS Bearers to be setup list and should be deactivated by the MME. For the
remaining EPS Bearer Contexts the MME ignores any Activity Status Indicator
within an EPS Bearer Context and requests the target eNodeB to allocate
resources for all the remaining EPS Bearer Contexts.
The local UE-AMBR shall be included in the \'EPS Bearers be setup list \' IE.
The local UE-AMBR is described in clause Annex E.
NOTE 4: The MME derives the security parameters from the security parameters
received from the SGSN.
NOTE 5: An MME that supports handovers from pre-Rel-8 3G SGSNs derives from
the RNC ID received from old SGSN an eNodeB address.
7\. The target eNodeB allocates the requested resources and returns the
applicable parameters to the target MME in the message Handover Request
Acknowledge (Target to Source Transparent Container, EPS Bearers setup list,
EPS Bearers failed to setup list, Cause). The target eNodeB shall ignore it if
the number of radio bearers in the Source to Target Transparent container does
not comply with the number of bearers requested by the MME and allocate
bearers as requested by the MME.
The target eNodeB inserts the information provided by the MME (eKSI, selected
NAS Integrity Protection and Ciphering algorithm(s), NONCE~MME~) and selected
AS integrity and ciphering algorithm(s) into the UTRAN RRC message, which is
contained in the Target to Source Transparent Container.
8\. If \'Indirect Forwarding\' and relocation of Serving GW apply, the target
MME sends a Create Indirect Data Forwarding Tunnel Request message (IMSI, MME
Tunnel Endpoint Identifier for Control Plane, MME Address for Control plane,
Target eNodeB Address and TEID(s) for DL user plane) to the Serving GW. The
allocation of a new Serving GW by steps 4 and 5 the MME shall consider as a
Serving GW change.
9\. The Serving GW returns a Create Indirect Data Forwarding Tunnel Response
(Cause, Serving GW DL TEID(s)) message to the source MME. If the Serving GW
doesn\'t support data forwarding, an appropriate cause value shall be
returned.
_10\. When resources for the transmission of user data between target RNC and
new SGSN have been allocated and the new SGSN is ready for relocation of SRNS,
the Forward Relocation Response (Cause, RAN Transparent Container, RANAP
Cause, Target-RNC Information) message is sent from the new SGSN to the old
SGSN. This message indicates that the target RNC is ready to receive from
source SRNC the forwarded downlink PDUs, i.e., the relocation resource
allocation procedure is terminated successfully. RAN transparent container and
RANAP Cause are information from the target RNC to be forwarded to the source
SRNC. The Target RNC Information, one information element for each RAB to be
set up, contains the RNC Tunnel Endpoint Identifier and RNC IP address for
data forwarding from the source SRNC to the target RNC. The Forward Relocation
Response message is applicable only in case of inter-SGSN SRNS relocation._
NOTE 6: This step is unmodified compared to pre-Rel-8. The new MME acts as the
new SGSN, and the target eNodeB as the target SRNC. RANAP Cause indicates the
Cause as received from target eNodeB. RAN Transparent Container contains the
Target to Source Transparent Container as received from eNodeB.
_11\. The old SGSN continues the relocation of SRNS by sending a Relocation
Command message (Target RNC To Source RNC Transparent Container, RABs To Be
Released, RABs Subject To Data Forwarding) to the source SRNC. The old SGSN
decides the RABs to be subject for data forwarding based on QoS, and those
RABs shall be contained in RABs subject to data forwarding. For each RAB
subject to data forwarding, the information element shall contain RAB ID,
Transport Layer Address, and Iu Transport Association. These are the same
Transport Layer Address and Iu Transport Association that the target RNC had
sent to new SGSN in Relocation Request Acknowledge message, and these are used
for forwarding of downlink N‑PDU from the source SRNC to the target RNC. The
source SRNC is now ready to forward downlink user data directly to the target
RNC over the Iu interface. This forwarding is performed for downlink user data
only._
NOTE 7: This step is unmodified compared to pre-Rel-8. The target eNodeB acts
as the target RNC, and the new MME acts as the new SGSN. The forwarding of
downlink user data from source SRNC may go directly to target eNodeB or via
the Serving GW.
_12\. The source SRNC may, according to the QoS profile, begins the forwarding
of data for the RABs to be subject for data forwarding._
_NOTE 8: The order of steps, starting from step 7 onwards, does not
necessarily reflect the order of events. For instance, source RNC may start
data forwarding (step 7), send the RRC message to MS (step 8) and forward SRNS
Context message to the old SGSN (step 9) almost simultaneously._
_The data forwarding at SRNS relocation shall be carried out through the Iu
interface, meaning that the GTP-PDUs exchanged between the source SRNC and the
target RNC are duplicated in the source SRNC and routed at the IP layer
towards the target RNC. For each radio bearer which uses lossless PDCP the
GTP-PDUs related to transmitted but not yet acknowledged PDCP-PDUs are
duplicated and routed at IP layer towards the target RNC together with their
related downlink PDCP sequence numbers. The source RNC continues transmitting
duplicates of downlink data and receiving uplink data._
_Before the serving RNC role is not yet taken over by target RNC and when
downlink user plane data starts to arrive to target RNC, the target RNC may
buffer or discard arriving downlink GTP-PDUs according to the related QoS
profile._
NOTE 9: This step is unmodified compared to pre-Rel-8. The target eNodeB acts
as the target SRNC. The data forwarding may go directly to target eNodeB or
alternatively go via the Serving GW if so decided by new MME in the
preparation phase.
_13\. Before sending the RRC message the uplink and downlink data transfer
shall be suspended in the source SRNC for RABs, which require delivery order.
The RRC message is for example Physical Channel Reconfiguration for RNS to RNS
relocation, or Intersystem to UTRAN Handover for BSS to RNS relocation, or
Handover from UTRAN Command for BSS relocation, or Handover Command for BSS to
BSS relocation. When the source SRNC is ready, the source RNC shall trigger
the execution of relocation of SRNS by sending to the MS the RRC message
provided in the Target RNC to source RNC transparent container, e.g., a
Physical Channel Reconfiguration (UE Information Elements, CN Information
Elements) message. UE Information Elements include among others new SRNC
identity and S‑RNTI. CN Information Elements contain among others Location
Area Identification and Routing Area Identification._
_When the MS has reconfigured itself, it sends an RRC message e.g., a Physical
Channel Reconfiguration Complete message to the target SRNC. If the Forward
SRNS Context message with the sequence numbers is received, the exchange of
packets with the MS may start. If this message is not yet received, the target
RNC may start the packet transfer for all RABs, which do not require
maintaining the delivery order._
NOTE 10: This step is unmodified compared to pre-Rel-8. This text is valid for
the RRC message sent from source RNC to the UE. When the UE has got access to
target eNodeB it sends the HO to E-UTRAN Complete message. This RRC message
received as part of Target to Source Transparent Container, includes
information about the selected security algorithms and related key
information. Based on this information, the UE selects the same algorithms for
the NAS if the KSI value indicates that the MME has no security association
with the UE. If the KSI value indicates that the MME has a security
association with the UE, but the UE has lost the security context of the
E-UTRAN side (error case), the UE will start Attach procedure on the E-UTRAN
side
14\. There is no RAN context transfer during inter RAT handovers with E-UTRAN.
If the source RNC originates any SRNC contexts the MME acknowledges the
receipt towards the SGSN and ignores the message content.
NOTE 11: This step is unmodified compared to pre-Rel-8. The new MME acts as
the new SGSN, and the target eNodeB as the target SRNC.
15\. When the UE has successfully accessed the target eNodeB, the target
eNodeB informs the target MME by sending the message Handover Notify
(TAI+ECGI). The UE shall implicitly derive the EPS bearers for which an E-RAB
was not established from the HO from UTRAN Command and deactivate them locally
without an explicit NAS message at this step.
16\. Upon receipt of Handover Notify message, if the SRNS Relocation is an
inter SGSN SRNS relocation, the new SGSN signals to the old SGSN the
completion of the SRNS relocation procedure by sending a Forward Relocation
Complete message.
Upon receipt of the Relocation Complete message the new MME starts a timer.
NOTE 12: This step is unmodified compared to pre-Rel-8 except that the
Handover Notify message is received instead of a Relocation Complete message.
The new MME acts as the new SGSN.
17\. The target MME will now complete the handover procedure by informing the
Serving GW that the target MME is now responsible for all the bearers the UE
have established. This is performed in the message Modify Bearer Request
(Cause, Tunnel Endpoint Identifier Control Plane, MME Address for Control
Plane, eNodeB Address(es) and TEID(s) for User Traffic, RAT type, APN-AMBR)
per PDN connection. If the PDN GW requested UE\'s location info (determined
from the UE context), the MME also includes the User Location Information IE
in this message.
The MME releases the non-accepted bearers by triggering the bearer release
procedure as specified in clause 5.4.4.2. If the Serving GW receives a DL
packet for a non-accepted bearer, the Serving GW drops the DL packet and does
not send a Downlink Data Notification to the MME.
18\. The Serving GW informs the PDN GW the APN- AMBR and the change of for
example the RAT type that e.g. can be used for charging, by sending the
message Modify Bearer Request (APN-AMBR) per PDN connection. The S‑GW also
includes User Location Information IE if it is present in step 17. The Serving
GW allocates DL TEIDs on S5/S8 even for non-accepted bearers. The PDN GW must
acknowledge the request with the message Modify Bearer Response (Default
bearer id, APN Restriction). When the UE moves from Gn/Gp SGSN to the MME, the
PDN GW shall send the APN restriction of each bearer context to the Serving GW
19\. The Serving GW acknowledges the user plane switch to the target MME via
the message Modify Bearer Response (Cause, Tunnel Endpoint Identifier Control
Plane, Serving GW Address for Control Plane, Default bearer id, APN
restriction). The Serving GW shall forward the received APN Restriction to the
MME. At this stage the user plane path is established for all bearers between
the UE, target eNodeB, Serving GW and PDN GW.
_20\. Upon receiving the Relocation Complete message or, if it is an inter-
SGSN SRNS relocation, the Forward Relocation Complete message, the old SGSN
sends an Iu Release Command message to the source RNC. When the RNC data-
forwarding timer has expired, the source RNC responds with an Iu Release
Complete message._
NOTE 13: This step is unmodified compared to pre-Rel-8.
21\. The UE initiates a Tracking Area Update procedure when one of the
conditions listed in clause \"Triggers for tracking area update\" applies.
The target MME knows that an IRAT Handover has been performed for this UE as
it received the bearer context(s) by handover messages and therefore the
target MME performs only a subset of the TA update procedure, specifically it
excludes the context transfer procedures between source SGSN and target MME.
The target MME gets the subscribed UE-AMBR value and the subscribed APN-AMBR
value from the HSS during the TA update procedure.
22\. The target MME calculates UE-AMBR as defined in clause 4.7.3. If the
local UE-AMBR provided by the MME as defined in Annex E is different from the
corresponding derived UE-AMBR, or the APN-AMBR mapped from the subscribed MBR
is different from the subscribed APN-AMBR, or the mapped subscribed QoS
profile (i.e. the subscribed QoS profile mapped according to Annex E) of the
default bearer is different from the EPS Subscribed QoS profile received from
the HSS, the new MME shall initiate Subscribed QoS Modification procedure as
described in clause 5.4.2.2, Figure 5.4.2.2-1.
23\. When the timer started in step 16 expires the new MME releases the
resources that have been allocated for indirect forwarding.
_If the SRNS Relocation is inter-SGSN, then the following CAMEL procedure
calls shall be performed (see referenced procedures in TS 23.078 [29])_
_C1) CAMEL_GPRS_PDP_Context_Disconnection, CAMEL_GPRS_Detach and
CAMEL_PS_Notification._
_They are called in the following order:_
_\- The CAMEL_GPRS_PDP_Context_Disconnection procedure is called several
times: once per PDP context. The procedure returns as result \"Continue\"._
_\- Then the CAMEL_GPRS_Detach procedure is called once. The procedure returns
as result \"Continue\"._
_\- Then the CAMEL_PS_Notification procedure is called once. The procedure
returns as result \"Continue\"._
_The new SGSN shall determine the Maximum APN restriction based on the
received APN Restriction of each PDP context from the GGSN and then store the
new Maximum APN restriction value._
_If the SRNS Relocation is intra-SGSN, then the above mentioned CAMEL
procedures calls shall not be performed._
_If Routing Area Update occurs, the SGSN shall determine whether Direct Tunnel
can be used based on the received GPRS CAMEL Subscription Information. If
Direct Tunnel can not be maintained the SGSN shall re-establish RABs and
initiate the Update PDP Context procedure to update the IP Address and TEID
for Uplink and Downlink data._
_If Routing Area Update occurs, then the following CAMEL procedure calls shall
be performed (see referenced procedures in TS 23.078 [29]):_
NOTE 14: This CAMEL handling is unmodified compared to pre-Rel-8.
NOTE 15: CAMEL procedure calls C2 and C3 were omitted intentionally from this
procedure since EPS does not support CAMEL procedure calls.
NOTE 16: Handover Reject procedure is performed as defined in clause
5.5.2.2.4.
## **D.3.5** Routing Area Update
The Routing Area Update procedure takes place when a UE that is registered
with an MME selects a UTRAN or GERAN cell served by a Gn/Gp SGSN. In this
case, the UE changes to a Routing Area that the UE has not yet registered with
the network. This procedure is initiated by an idle state or by a connected
state UE. The Routing Area Update procedure is illustrated in Figure D.3.5-1.
Any step descriptions that are taken from TS 23.060 [7] for a Gn/Gp SGSN are
shown as _italic_ text and remain unmodified. In that step descriptions an MS
stands for UE, old SGSN for old MME and GGSN for P‑GW. The old MME behaves
towards the new Gn/Gp SGSN always like an old Gn/Gp 3G-SGSN, regardless of
whether the new Gn/Gp SGSN is a 2G-SGSN or a 3G-SGSN.
Figure D.3.5-1: Routing Area Update procedure
0\. The UE selects a UTRAN or GERAN cell. This cell is in a Routing Area that
the UE not yet registered with the network or the UE reselects a UTRAN or
GERAN cell and the TIN indicates \"GUTI\". The UE in ECM‑CONNECTED state may
change to the GERAN cell through Network Assisted Cell Change (NACC).
1\. The MS sends a Routing Area Update Request (old P‑TMSI, old RAI, old
P‑TMSI Signature, Update Type, follow on request, Classmark, MS Network
Capability, additional P‑TMSI/RAI, KSI) to the new SGSN. Update Type shall
indicate RA update, periodic RA update, Combined RA / LA Update or Combined RA
/ LA Update with IMSI attach requested. The BSS shall add the Cell Global
Identity including the RAC and LAC of the cell where the message was received
before passing the message to the SGSN. The SRNC shall add the Routing Area
Identity before forwarding the message to the 3G-SGSN. Classmark contains the
MS GPRS multislot capabilities and supported GPRS ciphering algorithms as
defined in TS 24.008 [47]. The SGSN may use, as an implementation option, the
follow-on request indication to release or keep the Iu connection after the
completion of the RA update procedure.
If the UE\'s TIN indicates \"GUTI\" and the UE holds a valid GUTI then the UE
indicates the GUTI as the old P‑TMSI and old RAI. If the UE\'s TIN indicates
\"P‑TMSI\" or \"RAT‑related TMSI\" and the UE holds a valid P‑TMSI and related
RAI then these two elements are indicated as old P‑TMSI and old RAI. Mapping a
GUTI to a P‑TMSI and an RAI is specified in TS 23.003 [9].
If the UE holds a valid P‑TMSI and related RAI and the old P-TMSI and old RAI
indicate a P-TMSI/RAI mapped from a GUTI, then the UE indicates these
parameters as additional P‑TMSI/RAI. The Gn/Gp SGSN shall ignore this
additional P‑TMSI/RAI.
The old P‑TMSI is indicated in the RAU Request message for Iu‑mode only. For
Gb mode the TLLI is derived from the value that is determined as the old
P‑TMSI according to the rules above. The routing parameter that is signalled
in the RRC signalling to the RNC for routing to the SGSN is derived from the
identifier that is signalled as the old P‑TMSI according to the rules above.
For a combined MME/SGSN the RAN is configured to route the NRI(s) of this
combined node to the same combined node. The RAN is also configured to route
NRI(s) of P‑TMSIs that are generated by the UE\'s mapping of the GUTIs
allocated by the combined node. Such a RAN configuration may also be used for
separate nodes to avoid changing nodes in the pool caused by inter RAT
mobility.
KSI is mapped from an eKSI identifying a K~ASME~ if the UE indicates a P‑TMSI
mapped from GUTI in the information element \"old P‑TMSI\". KSI identifies a
(CK, IK) pair if the UE indicates a P‑TMSI in the information element \"old
P‑TMSI\".
2\. _The new SGSN sends SGSN Context Request (old RAI, TLLI or old P-TMSI, old
P‑TMSI Signature, New SGSN Address) to the old SGSN to get the MM and PDP
contexts for the MS. If the new SGSN provides functionality for Intra Domain
Connection of RAN Nodes to Multiple CN Nodes, the new SGSN may derive the old
SGSN from the old RAI and the old P-TMSI (or TLLI) and send the SGSN Context
Request message to this old SGSN. Otherwise, the new SGSN derives the old SGSN
from the old RAI. In any case the new SGSN will derive an SGSN that it
believes is the old SGSN. This derived SGSN is itself the old SGSN, or it is
associated with the same pool area as the actual old SGSN and it will
determine the correct old SGSN from the P-TMSI (or TLLI) and relay the message
to that actual old SGSN._
NOTE 2: A GUTI mapped to a P-TMSI/RAI provides an old RAI that uniquely
identifies an old MME then there is no need to relay between MME in the old
pool, regardless whether the new SGSN supports such functionality or not.
Mapping a GUTI to a P‑TMSI and an RAI is specified in Annex H.
_The old SGSN validates the old P‑TMSI Signature and responds with an
appropriate error cause if it does not match the value stored in the old SGSN.
This should initiate the security functions in the new SGSN. If the security
functions authenticate the MS correctly, the new SGSN shall send an SGSN
Context Request (old RAI, TLLI, MS Validated, New SGSN Address) message to the
old SGSN. MS Validated indicates that the new SGSN has authenticated the MS.
If the old P‑TMSI Signature was valid or if the new SGSN indicates that it has
authenticated the MS, the old SGSN starts a timer. If the MS is not known in
the old SGSN, the old SGSN responds with an appropriate error cause._
NOTE 3: For the new SGSN, this step is unmodified compared to pre-Rel-8. The
MME (called old SGSN in above description) needs to provide SGSN
functionality.
2b. _The old 3G SGSN responds with an SGSN Context Response (MM Context, PDP
Contexts) message. For each PDP context the old 3G-SGSN shall include the GTP
sequence number for the next uplink GTP PDU to be tunnelled to the GGSN and
the next downlink GTP sequence number for the next PDU to be sent to the MS.
Each PDP Context also includes the PDCP sequence numbers if PDCP sequence
numbers are received from the old SRNS. The new 3G-SGSN shall ignore the MS
Network Capability contained in MM Context of SGSN Context Response only when
it has previously received an MS Network Capability in the Routing Area
Request. The GTP sequence numbers received from the old 3G-SGSN are only
relevant if delivery order is required for the PDP context (QoS profile)._
NOTE 4: This step is for the Gn/Gp SGSN unmodified compared to pre-Rel-8. The
MME (old SGSN in this step) maps EPS bearers one-to-one to PDP contexts and
provides the Release 99 parameters of the bearer QoS profile to the new SGSN.
The Gn signalling between the new Gn/Gp SGSN and the old CN node has no
capabilities to indicate ISR Activated or ISR Supported. The GTP and PDCP
sequence numbers are not relevant as the network does not configure usage of
\"delivery order required\" and does not configure loss less UTRAN PDCP as
described in clause \"compatibility issues\".
3\. _Security functions may be executed. These procedures are defined in
clause \"Security Function\" in TS 23.060 [7]. Ciphering mode shall be set if
ciphering is supported. If the SGSN Context Response message did not include
IMEISV and ADD is supported by the SGSN, the SGSN retrieves the IMEISV from
the MS._
_If the security functions fail (e.g. because the SGSN cannot determine the
HLR address to establish the Send Authentication Info dialogue), the Inter
SGSN RAU Update procedure fails. A reject shall be returned to the MS with an
appropriate cause._
NOTE 5: This step is unmodified compared to pre-Rel-8.
4\. _The new SGSN sends an SGSN Context Acknowledge message to the old SGSN._
The old MME (which is the old SGSN from the new SGSN\'s point of view) marks
in its context that the information in the GWs and the HSS are invalid. This
triggers the GWs, and the HSS to be updated if the UE initiates a Tracking
Area Update procedure back to the old MME before completing the ongoing
Routing Area Update procedure. _If the security functions do not authenticate
the MS correctly, then the routing area update shall be rejected, and the new
SGSN shall send a reject indication to the old SGSN._ The old MME shall
continue as if the SGSN Context Request was never received.
NOTE 6: The new SGSN\'s operation is unmodified compared to pre-Rel-8. The old
MME/S-GW (old SGSN from the new SGSN\'s point of view) does not forward any
data towards the new SGSN.
5\. Void.
6\. _The new SGSN sends Update PDP Context Request (new SGSN Address, TEID,
QoS Negotiated, serving network identity, CGI/SAI, RAT type, CGI/SAI/RAI
change support indication, NRSN) to the GGSNs concerned. The SGSN shall send
the serving network identity to the GGSN. NRSN indicates SGSN support of the
network requested bearer control. The SGSN shall only indicate that it
supports the procedure if it supports it and it is indicated that the MS also
supports it in the SGSN Context Response message as described above. If the
NRSN is not included in the Update PDP Context Request message the GGSN shall,
following this procedure, perform a GGSN-Initiated PDP Context Modification to
change the BCM to \'MS-Only\' for all PDP-Address/APN-pairs for which the
current BCM is \'MS/NW\'. The GGSNs update their PDP context fields and return
Update PDP Context Response (TEID, Prohibit Payload Compression, APN
Restriction, CGI/SAI/RAI change report required, BCM). The Prohibit Payload
Compression indicates that the SGSN should negotiate no data compression for
this PDP context._
NOTE 9: This step is unmodified compared to pre-Rel-8.
7\. _The new SGSN informs the HLR of the change of SGSN by sending Update
Location (SGSN Number, SGSN Address, IMSI, IMEISV, Update Type) to the HLR.
IMEISV is sent if the ADD function is supported._ Update Type indicates
\"normal update\".
NOTE 10: This step is unmodified compared to pre-Rel-8. Clarification about
update type added to show that this is the trigger for the HSS to cancel only
an old SGSN and not also an old MME.
8\. The HLR sends Cancel Location (IMSI, Cancellation Type) to any old SGSN
with Cancellation Type set to Update Procedure. The old SGSN removes the MM
and EPS bearer contexts. The old SGSN acknowledges with Cancel Location Ack
(IMSI).
NOTE 11: For the Gn/Gp SGSN the HSS interoperation is unmodified compared to
earlier standards Releases.
9\. _The HLR sends Insert Subscriber Data (IMSI, GPRS Subscription Data) to
the new SGSN. The new SGSN validates the UE\'s presence in the (new) RA. If
due to regional subscription restrictions or access restrictions the MS is not
allowed to be attached in the RA, the SGSN rejects the Routing Area Update
Request with an appropriate cause, and may return an Insert Subscriber Data
Ack (IMSI, SGSN Area Restricted) message to the HLR. If the network supports
the MOCN configuration for network sharing, the SGSN may, if the MS is not a
\'Network Sharing Supporting MS\', in this case decide to initiate redirection
by sending a Reroute Command to the RNS, as described in TS 23.251 [24]
instead of rejecting the Routing Area Update Request. If all checks are
successful, the SGSN constructs an MM context for the MS and returns an Insert
Subscriber Data Ack (IMSI) message to the HLR._
NOTE 12: This step is unmodified compared to pre-Rel-8.
_10\. The HLR acknowledges the Update Location by sending Update Location Ack
(IMSI) to the new SGSN._
NOTE 13: This step is unmodified compared to pre-Rel-8.
11\. If the new SGSN is a 2G-SGSN: _The new SGSN validates the MS\'s presence
in the new RA. If due to roaming restrictions or access restrictions the MS,
is not allowed to be attached in the SGSN, or if subscription checking fails,
the new SGSN rejects the routing area update with an appropriate cause. If all
checks are successful, the new SGSN constructs MM and PDP contexts for the MS.
A logical link is established between the new SGSN and the MS. The new SGSN
responds to the MS with Routing Area Update Accept (P‑TMSI, P‑TMSI Signature,
Receive N‑PDU Number). Receive N‑PDU Number contains the acknowledgements for
each acknowledged-mode NSAPI used by the MS, thereby confirming all mobile-
originated N‑PDUs successfully transferred before the start of the update
procedure._
If the new SGSN is a 3G-SGSN: _The new SGSN validates the MS\'s presence in
the new RA. If due to roaming restrictions or access restrictions the MS is
not allowed to be attached in the RA, or if subscription checking fails, the
SGSN rejects the routing area update with an appropriate cause. If the network
supports the MOCN configuration for network sharing, the SGSN may, if the MS
is not a \'Network Sharing Supporting MS\', in this case decide to initiate
redirection by sending a Reroute Command to the RNS, as described in TS 23.251
[24] instead of rejecting the routing area update. If all checks are
successful, the new SGSN establishes MM context for the MS. The new SGSN
responds to the MS with Routing Area Update Accept (P-TMSI, VLR TMSI, P-TMSI
Signature)._
When receiving the RAU Accept message and there is no ISR Activated indication
the UE shall set its TIN to \"P‑TMSI\".
NOTE 13a: A Gn/Gp SGSN never indicates ISR Activated as it does not support
ISR.
NOTE 14: For the SGSN this step is unmodified compared earlier standards
Releases. N-PDU numbers are not relevant as the network does not configure
usage of acknowledged mode NSAPIs as described in clause \"compatibility
issues\".
12\. If the new SGSN is a 2G-SGSN: _The MS acknowledges the new P‑TMSI by
returning a Routing Area Update Complete (Receive N‑PDU Number) message to the
SGSN. Receive N‑PDU Number contains the acknowledgements for each
acknowledged-mode NSAPI used by the MS, thereby confirming all mobile-
terminated N‑PDUs successfully transferred before the start of the update
procedure. If Receive N‑PDU Number confirms reception of N‑PDUs that were
forwarded from the old SGSN, these N‑PDUs shall be discarded by the new SGSN.
LLC and SNDCP in the MS are reset._
If the new SGSN is a 3G-SGSN: _The MS confirms the reallocation of the TMSIs
by returning a Routing Area Update Complete message to the SGSN._
NOTE 15: This step is unmodified compared to pre-Rel-8. N-PDU numbers are not
relevant as the network does not configure usage of acknowledged mode NSAPIs
as described in clause \"compatibility issues\".
13\. When the timer started in step 2) expires the old MME releases any RAN
and Serving GW resources. The old MME deletes the EPS bearer resources by
sending Delete Session Request (TEID, cause) messages to the Serving GW. Cause
indicates to the old Serving GW that the old Serving GW shall not initiate a
delete procedure towards the PDN GW. The old MME derives from the GTPv1
context transfer signalling that the new SGSN is a Gn/Gp SGSN and therefore
any old S‑GW resources are released by the old MME. A Gn/Gp SGSN does not
signal any S‑GW change. If the old S‑GW has due to ISR a control connection
with another CN node (MME or SGSN) the cause also indicates to the old S‑GW
that the old S‑GW shall delete the bearer resources on the other old CN node
by sending Delete Bearer Request message(s) to that other old CN node.
If the old MME has an S1-MME association for the UE, the source MME sends a
S1-U Release Command to the source eNodeB when receiving the SGSN Context
Acknowledge message from the new SGSN. The RRC connection is released by the
source eNodeB. The source eNodeB confirms the release of the RRC connection
and of the S1-U connection by sending a S1-U Release Complete message to the
source MME.
NOTE 16: The new SGSN may initiate RAB establishment after execution of the
security functions, or wait until completion of the RA update procedure. For
the MS, RAB establishment may occur anytime after the Routing Area Update
Request is sent.
_In the case of a rejected routing area update operation, due to regional
subscription, roaming restrictions, access restrictions (see TS 23.221 [27]
and TS 23.008 [28]) or because the SGSN cannot determine the HLR address to
establish the locating updating dialogue, the new SGSN shall not construct an
MM context. A reject shall be returned to the MS with an appropriate cause and
the PS signalling connection shall be released. Upon return to idle, the MS
shall act according to TS 23.122 [10]._
_If the network supports the MOCN configuration for network sharing, the SGSN
may, if the MS is not a \'Network Sharing Supporting MS\', in this case decide
to initiate redirection by sending a Reroute Command to the RNS, as described
in TS 23.251 [24] instead of rejecting the routing area update._
_If the new SGSN is unable to update the PDP context in one or more GGSNs, the
new SGSN shall deactivate the corresponding PDP contexts as described in
clause \"SGSN-initiated PDP Context Deactivation Procedure\". This shall not
cause the SGSN to reject the routing area update._
_The PDP Contexts shall be sent from old to new SGSN in a prioritized order,
i.e. the most important PDP Context first in the SGSN Context Response
message. (The prioritization method is implementation dependent, but should be
based on the current activity)._
_The new SGSN shall determine the Maximum APN restriction based on the
received APN Restriction of each PDP context from the GGSN and then store the
new Maximum APN restriction value._
_If the new SGSN is unable to support the same number of active PDP contexts
as received from old SGSN, the new SGSN should use the prioritisation sent by
old SGSN as input when deciding which PDP contexts to maintain active and
which ones to delete. In any case, the new SGSN shall first update all
contexts in one or more GGSNs and then deactivate the context(s) that it
cannot maintain as described in clause \"SGSN-initiated PDP Context
Deactivation Procedure\". This shall not cause the SGSN to reject the routing
area update._
_NOTE 17: In case MS was in PMM-CONNECTED state the PDP Contexts are sent
already in the Forward Relocation Request message as described in clause
\"Serving RNS relocation procedures\" of TS 23.060 [7]._
_If the routing area update procedure fails a maximum allowable number of
times, or if the SGSN returns a Routing Area Update Reject (Cause) message,
the MS shall enter IDLE state._
NOTE 18: The C1 CAMEL procedure call was omitted intentionally from this
procedure since EPS does not support CAMEL procedure calls. The other CAMEL
procedure calls are unmodified compared to pre-Rel-8.
_The CAMEL procedure calls shall be performed, see referenced procedures in TS
23.078 [29]:_
_C2) CAMEL_GPRS_Routing_Area_Update_Session and CAMEL_PS_Notification._
_They are called in the following order:_
_\- The CAMEL_GPRS_Routing_Area_Update_Session procedure is called. The
procedure returns as result \"Continue\"._
_\- Then the CAMEL_PS_Notification procedure is called. The procedure returns
as result \"Continue\"._
_C3) CAMEL_GPRS_Routing_Area_Update_Context._
## **D.3.6** Gn/Gp SGSN to MME Tracking Area Update
The Pre-Rel‑8 SGSN to MME Tracking Area Update procedure is illustrated in
Figure D.3.6-1.
Any steps descriptions that are from TS 23.060 [7] are shown as italic text
and remain unmodified. In those step descriptions an MS stands for UE, new
SGSN for new MME, old SGSN for old Gn/Gp SGSN, GGSN for P‑GW, and HLR for HSS.
The new MME behaves towards the old Gn/Gp SGSN always like a Gn/Gp 3G-SGSN,
regardless of whether the old Gn/Gp SGSN is a 2G-SGSN or a 3G-SGSN.
Figure D.3.6-1: Gn/Gp SGSN to MME Tracking Area Update procedure
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 13 and 15 concern GTP based S5/S8.
1\. One of the triggers described in clause 5.3.3.0 for starting the TAU
procedure occurs.
2\. The UE sends to the eNodeB a Tracking Area Update Request (last visited
TAI, P‑TMSI Signature, old GUTI, UE Core Network Capability, active flag, EPS
bearer status, additional GUTI, eKSI, NAS sequence number, NAS-MAC, KSI)
message together with RRC parameters indicating the Selected Network and the
old GUMMEI.
If the UE\'s TIN indicates \"GUTI\" or \"RAT‑related TMSI\" and the UE holds a
valid GUTI then the old GUTI indicates this valid GUTI. If the UE\'s TIN
indicates \"P‑TMSI\" and the UE holds a valid P‑TMSI and related RAI then
these two elements are indicated as the old GUTI. Mapping a P‑TMSI and an RAI
to a GUTI is specified in Annex H.
If the UE holds a valid GUTI and the old GUTI indicates a GUTI mapped from a
P-TMSI and RAI, then the UE indicates the native GUTI as additional GUTI. If
the old GUTI indicates a GUTI mapped from a P-TMSI and RAI, and the UE has a
valid P-TMSI signature, the P-TMSI signature shall be included.
The RRC parameter \"old GUMMEI\" takes its value from the identifier that is
signalled as the old GUTI according to the rules above. For a combined
MME/SGSN the eNodeB is configured to route the MME‑code(s) of this combined
node to the same combined node. This eNodeB is also configured to route
MME‑code(s) of GUTIs that are generated by the UE\'s mapping of the P‑TMSIs
allocated by the combined node. Such an eNodeB configuration may also be used
for separate nodes to avoid changing nodes in the pool caused by inter RAT
mobility.
NOTE 2: In the scenario of this flow the UE\'s TIN indicates \"P‑TMSI\" and
therefore the UE indicates a P‑TMSI as the old GUTI.
The last visited TAI is included if the UE has any in order to help the MME to
produce a good list of TAIs for any subsequent TAU Accept message. Selected
Network indicates the network that is selected. Active flag is a request by UE
to activate the radio and S1 bearers for all the active EPS Bearers by the TAU
procedure. The EPS bearer status indicates each EPS bearer that is active
within the UE. The UE\'s ISR capability is included in the UE Core Network
Capability element.
If the UE has valid EPS security parameters, the TAU Request message shall be
integrity protected by the NAS‑MAC in order to allow validation of the UE by
the MME. eKSI, NAS sequence number and NAS‑MAC are included if the UE has
valid EPS security parameters. NAS sequence number indicates the sequential
number of the NAS message. KSI is included if the UE indicates a GUTI mapped
from a P‑TMSI in the information element \"old GUTI\".
3\. The eNodeB derives the MME from the RRC parameters carrying the old GUMMEI
and the indicated Selected Network. If that GUMMEI is not associated with the
eNodeB, or the GUMMEI is not available, the eNodeB selects the MME as
described in clause 4.3.8.3 on \"MME Selection Function\".
The eNodeB forwards the TAU Request message together with the TAI+ECGI of the
cell from where it received the message and with the Selected Network to the
MME.
4\. The new MME sends SGSN Context Request (old RAI, P‑TMSI, old P‑TMSI
Signature, New SGSN Address) to the old SGSN to get the MM and PDP contexts
for the UE.
The new MME shall support functionality for Intra Domain Connection of RAN
Nodes to Multiple CN Nodes, i.e. the MME derives the old SGSN from the old RAI
and the old P-TMSI (or TLLI).
5\. If the old SGSN is a 2G-SGSN: _The old 2G-SGSN validates the old P‑TMSI
Signature and responds with an appropriate error cause if it does not match
the value stored in the old 2G SGSN. This should initiate the security
functions in the new SGSN. If the security functions authenticate the MS
correctly, the new SGSN shall send an SGSN Context Request (old RAI, old
PTMSI, MS Validated, New SGSN Address) message to the old SGSN. MS Validated
indicates that the new SGSN has authenticated the MS. If the old P‑TMSI
Signature was valid or if the new SGSN indicates that it has authenticated the
MS, the old SGSN stops assigning SNDCP N‑PDU numbers to downlink N‑PDUs
received, and responds with SGSN Context Response (MM Context, PDP Contexts).
If the MS is not known in the old SGSN, the old SGSN responds with an
appropriate error cause. The old SGSN stores New SGSN Address, to allow the
old SGSN to forward data packets to the new SGSN. Each PDP Context includes
the SNDCP Send N‑PDU Number for the next downlink N‑PDU to be sent in
acknowledged mode to the MS, the SNDCP Receive N‑PDU Number for the next
uplink N‑PDU to be received in acknowledged mode from the MS, the GTP sequence
number for the next downlink N‑PDU to be sent to the MS and the GTP sequence
number for the next uplink N‑PDU to be tunnelled to the GGSN. The old SGSN
starts a timer and stops the transmission of N-PDUs to the MS. The new SGSN
shall ignore the MS Network Capability contained in MM Context of SGSN Context
Response only when it has previously received an MS Network Capability in the
Routing Area Request._
If the old SGSN is a 3G-SGSN: _The old 3G-SGSN validates the old P‑TMSI
Signature and responds with an appropriate error cause if it does not match
the value stored in the old SGSN. This should initiate the security functions
in the new SGSN. If the security functions authenticate the MS correctly, the
new SGSN shall send an SGSN Context Request (IMSI, old RAI, MS Validated)
message to the old 3G-SGSN. MS Validated indicates that the new SGSN has
authenticated the MS. If the old P‑TMSI Signature was valid or if the new SGSN
indicates that it has authenticated the MS, the old SGSN starts a timer. If
the MS is not known in the old SGSN, the old 3G-SGSN responds with an
appropriate error cause._
_The old 3G SGSN responds with an SGSN Context Response (MM Context, PDP
Contexts) message. For each PDP context the old 3G SGSN shall include the GTP
sequence number for the next uplink GTP PDU to be tunnelled to the GGSN and
the next downlink GTP sequence number for the next PDU to be sent to the MS.
Each PDP Context also includes the PDCP sequence numbers if PDCP sequence
numbers are received from the old SRNS. The new 3G-SGSN shall ignore the MS
Network Capability contained in MM Context of SGSN Context Response only when
it has previously received an MS Network Capability in the Routing Area
Request. The GTP sequence numbers received from the old 3G-SGSN are only
relevant if delivery order is required for the PDP context (QoS profile)._
NOTE 3: In this step, the new \"SGSN\" shall be understood to be a new \"MME\"
and the old SGSN stores new SGSN Address, to allow the old SGSN to forward
data packets to the new \"S‑GW or eNodeB\". This step describes both the 2G
and 3G SGSN variants due to combining the 2G or 3G SGSN to MME TAU into a
single procedure.
NOTE 4: For the old SGSN, this step is unmodified compared to pre-Rel-8. The
MME (called new SGSN in above description) must provide SGSN functionality
which includes mapping PDP contexts to EPS bearer information. SNDCP, GTP and
PDCP sequence numbers are not relevant for the MME as the network does not
configure usage of \"delivery order required\", does not configure
acknowledged mode NSAPIs (SNDCP) and does not configure loss less UTRAN PDCP
as described in clause \"compatibility issues\".
6\. Security functions may be executed. Procedures are defined in clause
5.3.10 on Security Function. If the SGSN Context Response message from the old
SGSN did not include IMEISV, the MME shall retrieve the ME Identity (the
IMEISV) from the UE.
7\. The new MME sends an SGSN Context Acknowledge message to the old SGSN.
_This informs the old SGSN that the new SGSN is ready to receive data packets
belonging to the activated PDP contexts. The old SGSN marks in its context
that the MSC/VLR association and the information in the GGSNs and the HLR are
invalid. This triggers the MSC/VLR, the GGSNs, and the HLR to be updated if
the MS initiates a routing area update procedure back to the old SGSN before
completing the ongoing routing area update procedure._
If the security functions do not authenticate the UE correctly, then the
Tracking area update shall be rejected, and the new MME shall send a reject
indication to the old SGSN. _The old SGSN shall continue as if the SGSN
Context Request was never received._
NOTE 5: in the _italic_ text of this step, new \"SGSN\" shall be understood as
to be a new \"MME\". The MME needs to map PDP contexts received from pre-Rel‑8
SGSN into EPS bearer information. The GGSN address(es) and TEIDs map to the
PDN GW address(es) and TEIDs respectively. . The MME maps PDP contexts to EPS
bearers one-to-one and it translates the release 99 QoS parameters to the EPS
bearer QoS parameters.
NOTE 6: The SGSN operation is unmodified compared to pre-Rel-8. The MME
indicates reserved TEID and IP address parameters from an S-GW to the old SGSN
so that the old Gn/Gp SGSN can forward data packets when needed. The S-GW
discards any packets received from old Gn/Gp SGSN.
NOTE 7: The Gn signalling between the new MME and the old Gn/Gp SGSN has no
capabilities to indicate ISR Supported or ISR Activated.
If there is no PDP context at all, the MME rejects the TAU Request.
8\. The old SGSN or the old RNC forward data to the S-GW and the S-GW discards
these data.
9\. The new MME adopts the bearer contexts received from the SGSN as the UE\'s
EPS bearer contexts to be maintained by the new MME. The new MME maps the PDP
contexts to the EPS bearers 1-to-1 and maps the pre-Rel-8 QoS parameter values
of a PDP context to the EPS Bearer QoS parameter values of an EPS bearer as
defined in Annex E. The MME establishes the EPS bearer(s) in the indicated
order. The MME deactivates the EPS bearers which cannot be established.
The MME verifies the EPS bearer status received from the UE with the bearer
contexts received from the old SGSN and releases any network resources related
to EPS bearers that are not active in the UE. If the UE has no PDP context,
the MME rejects the TAU Request.
The new MME selects a Serving GW and sends an Create Session Request (IMSI,
MME Address and TEID, PDN GW address and TEID, EPS Bearer QoS, serving network
identity, ME Identity, User Location Information IE, RAT type, MS Info Change
Reporting support indication, NRS (received from the SGSN)) message per PDN
connection to the Serving GW. The MME shall send the serving network identity
to the Serving GW. The new MME does not indicate ISR Activated.
10\. The Serving GW creates contexts and informs the PDN GW(s) about the
change of the RAT type. The Serving GW sends a Modify Bearer Request (Serving
GW Address and TEID, RAT type, ME Identity, User Location Information IE, MS
Info Change Reporting support indication) message per PDN connection to the
PDN GW(s) concerned.
11\. If dynamic PCC is deployed, and RAT type information needs to be conveyed
from the PDN GW to the PCRF, then the PDN GW shall send RAT type information
to the PCRF by performing an IP‑CAN Session Modification procedure as defined
in TS 23.203 [6].
NOTE 8: The PDN GW does not need to wait for the PCRF response, but continues
in the next step. If the PCRF response leads to an EPS bearer modification the
PDN GW should initiate a bearer update procedure.
12\. The PDN GW updates its context field and returns a Modify Bearer Response
(PDN GW address and TEID, MSISDN, Default bearer id, Charging Id, MS Info
Change Reporting Action (Start) (if the PDN GW decides to receive UE\'s
location information during the session), APN Restriction) message to the
Serving GW. The MSISDN is included if the PDN GW has it stored in its UE
context. When the UE moves from Gn/Gp SGSN to the MME, the PDN GW shall send
the APN restriction of each bearer context to the Serving GW.
13\. The Serving GW updates its context and returns an Create Session Response
(Serving GW address and TEID for user plane, PDN GW address and TEID, Serving
GW Address and TEID for the control plane, Default bearer id, APN restriction)
message to the new MME. The message also includes MS Info Change Reporting
Action (Start) if it is included in step 12. The Serving GW shall forward the
received APN Restriction to the MME.
14\. To ensure the release of all UE resources in the Gn/Gp SGSN the new MME
informs the HSS of the change of the serving core network node by sending an
Update Location Request (MME Address, IMSI, ME Identity, ULR-Flags, MME
Capabilities) message to the HSS. The ME Identity is included if the SGSN
Context Response did not contain the IMEISV. Because of interoperation with an
Gn/Gp SGSN, which the new MME identifies from the GTPv1 Context Response
signalling, the ULR-Flags indicates \"Single-Registration-Indication\". The
MME capabilities indicate the MME\'s support for regional access restrictions
functionality.
15\. If the MME changes, then the HSS cancels any old MME. The HSS sends a
Cancel Location (IMSI, Cancellation type) message to the old MME, with a
Cancellation Type set to Update Procedure.
16\. The old MME removes the MM context.
The old MME releases any local bearer resources and it deletes the EPS bearer
resources by sending Delete Session Request (Cause, TEID) messages to the
Serving GW. Cause indicates that the S‑GW shall not initiate a delete
procedure towards the PDN GW. If ISR is activated then the cause also
indicates to the old S‑GW that the old S‑GW shall delete the bearer resources
on the other old CN node by sending Delete Bearer Request message(s) to that
CN node.
The old MME acknowledges with a Cancel Location Ack (IMSI) message.
17\. The HSS cancels any old SGSN node as the ULR-Flags indicates \"Single-
Registration-Indication\". _The HSS sends a Cancel Location (IMSI,
Cancellation Type) message to the old SGSN. The old SGSN removes the
contexts._
_If the timer started in step 5 is not running, the old SGSN removes the MM
context. Otherwise, the contexts are removed when the timer expires. It also
ensures that the MM context is kept in the old SGSN for the case the UE
initiates another TAU procedure before completing the ongoing TAU procedure to
the new MME._
NOTE 9: In all other mobility scenarios a new CN node initiates only
cancellation of an old CN node of the same type via HSS. In this scenario here
(Gn/Gp SGSN to MME TAU) the new MME, by indicating single registration,
initiates in addition the cancellation of the old Gn/Gp SGSN via HSS to make
sure that any PDP contexts of the UE are properly released. MME and S4 SGSN
release PDP/PDN contexts based on context transfer signalling.
18\. _On receipt of Cancel Location, if the MS is PMM CONNECTED in the old
SGSN, the old SGSN sends an Iu Release Command message to the old SRNC._
19\. _When the data-forwarding timer has expired, the SRNS responds with an Iu
Release Complete message._
20\. _The old SGSN acknowledges with a Cancel Location Ack (IMSI) message._
21\. The new MME validates the UE\'s presence in the (new) TA. If due to
regional subscription restrictions or access restrictions the UE is not
allowed to be attached in the TA, the MME rejects the Tracking Area Update
Request with an appropriate cause and notifies the HSS of the rejection
(details of this notification is a stage 3 detail). If all checks are
successful, the MME constructs an MM context for the UE, the HLR acknowledges
the Update Location by sending Update Location Ack (IMSI, Subscription Data)
message to the new MME. If the Update Location is rejected by the HSS, the MME
rejects the TAU Request from the UE with an appropriate cause sent in the TAU
Reject message to the UE.
22\. The new MME responds to the UE with a Tracking Area Update Accept (GUTI,
TAI-list, EPS bearer status, NAS sequence number, NAS-MAC, ISR Activated)
message. Restriction list shall be sent to eNodeB as eNodeB handles the
roaming restrictions and access restrictions in the Intra E-UTRAN case.
If the \"active flag\" is set in the TAU Request message the user plane setup
procedure can be activated in conjunction with the TAU Accept message. The
procedure is described in detail in TS 36.300 [5]. The messages sequence
should be the same as for the UE triggered Service Request procedure specified
in clause 5.3.4.1 from the step when MME establishes the bearer(s). If the
active flag is set the MME may provide the eNodeB with Handover Restriction
List. Handover Restriction List is described in clause 4.3.5.7 \"Mobility
Restrictions\". The EPS bearer status indicates the active bearers in the
network. The UE removes any internal resources related to bearers not marked
active in the received EPS bearer status.
When receiving the TAU Accept message and there is no ISR Activated indication
the UE shall set its TIN to \"GUTI\".
NOTE 10: In the case of interoperation with Gn/Gp SGSNs, ISR Activated is
never indicated by the MME as the SGSN does not support ISR, which the new MME
recognises from Gn interface signalling that does not support ISR indications.
23\. If the GUTI was included in the TAU Accept message, the UE acknowledges
the message by returning a Tracking Area Update Complete message to the MME.
When the \"Active flag\" is not set in the TAU Request message and the
Tracking Area Update was not initiated in ECM-CONNECTED state, the MME
releases the signalling connection with UE, according to clause 5.3.5.
NOTE 11: The new MME may initiate E‑RAB establishment (see TS 36.413 [36])
after execution of the security functions (step 5), or wait until completion
of the TA update procedure. For the UE, E‑RAB establishment may occur anytime
after the TA update request is sent (step 2).
23\. The target MME calculates UE-AMBR as defined in clause 4.7.3. If the
local UE-AMBR provided by the MME as defined in Annex E is different from the
corresponding derived UE-AMBR, or the APN-AMBR mapped from the subscribed MBR
is different from the subscribed APN-AMBR, or the mapped subscribed QoS
profile (i.e. the subscribed QoS profile mapped according to Annex E) of the
default bearer is different from the EPS Subscribed QoS profile received from
the HSS, the new MME shall initiate Subscribed QoS Modification procedure as
described in clause 5.4.2.2, Figure 5.4.2.2-1.
In the case of a rejected tracking area update operation, due to regional
subscription, roaming restrictions, or access restrictions (see TS 23.221 [27]
and TS 23.008 [28]) the new MME shall not construct a bearer context. A reject
shall be returned to the UE with an appropriate cause and the S1 connection
shall be released. Upon return to idle, the UE shall act according to TS
23.122 [10].
If the new MME is unable to update the bearer context in one or more P‑GWs,
the new MME shall deactivate the corresponding bearer contexts as described in
clause \"MME Initiated Dedicated Bearer Deactivation Procedure\". This shall
not cause the MME to reject the tracking area update.
_The PDP Contexts shall be sent from old SGSN to new SGSN (MME) in a
prioritized order, i.e. the most important PDP Context first in the SGSN
Context Response message. (The prioritization method is implementation
dependent, but should be based on the current activity)._
The new MME shall determine the Maximum APN restriction based on the received
APN Restriction of each bearer context from the P‑GW and then store the new
Maximum APN restriction value.
If there are active EPS GBR bearers with maximum bitrate set to 0, the MME
should initiate MME Initiated Dedicated Bearer Deactivation (as specified in
clause 5.4.4.2) to deactivate the related EPS bearer Context.
If the new MME is unable to support the same number of active bearer contexts
as received from old SGSN, the new MME should use the prioritisation sent by
old SGSN as input when deciding which bearer contexts to maintain active and
which ones to delete. In any case, the new MME shall first update all contexts
in one or more P‑GWs and then deactivate the context(s) that it cannot
maintain as described in clause \"MME Initiated Dedicated Bearer Deactivation
Procedure\". This shall not cause the MME to reject the tracking area update.
NOTE 12: If MS (UE) was in PMM-CONNECTED state the PDP Contexts are sent
already in the Forward Relocation Request message as described in clause
\"Serving RNS relocation procedures\" of TS 23.060 [7].
If the tracking area update procedure fails a maximum allowable number of
times, or if the MME returns a Tracking Area Update Reject (Cause) message,
the UE shall enter EMM DEREGISTERED state.
If the Update Location Ack message indicates a reject, this should be
indicated to the UE, and the UE shall not access non-PS services until a
successful location update is performed.
_The CAMEL procedure calls shall be performed, see referenced procedures in TS
23.078 [29]:_
_C1) CAMEL_GPRS_PDP_Context_Disconnection, CAMEL_GPRS_Detach and
CAMEL_PS_Notification._
_They are called in the following order:_
_\- The CAMEL_GPRS_PDP_Context_Disconnection procedure is called several
times: once per PDP context. The procedure returns as result \"Continue\"._
_\- Then the CAMEL_GPRS_Detach procedure is called once. The procedure returns
as result \"Continue\"._
_\- Then the CAMEL_PS_Notification procedure is called once. The procedure
returns as result \"Continue\"._
NOTE 13: This CAMEL handling is unmodified compared to pre-Rel-8.
NOTE 14: CAMEL procedure calls C2 and C3 were omitted intentionally from this
procedure since EPS does not support CAMEL procedure calls.
## D.3.7 E-UTRAN to GERAN A/Gb mode Inter RAT handover
### D.3.7.1 General
The interoperation procedures describe information flows for Gn/Gp SGSNs and
other EPS network elements. All messages between SGSN and MME, between SGSN
and BSS, between SGSN and HSS and between SGSN and P‑GW (GGSN in TS 43.129
[8]) as well as the therein contained information elements are the same as
specified for the adequate TS 43.129 [8] procedures. These messages and
procedure step descriptions are taken from TS 43.129 [8] for explanatory
purposes only. These descriptions are in _italic text_ and shall not be
modified by the interoperation procedures. It cannot be assumed that the
messages and procedure step descriptions that are taken from TS 43.129 [8]
will be updated when modifications or corrections are performed for TS 43.129
[8]. If there are any discrepancies for these messages and procedure step
descriptions TS 43.129 [8] takes precedence.
The messages between the MME and any other node than the Gn/Gp SGSN as well as
the therein contained information elements are the same as specified in the
main body of this technical specification for the IRAT handover E‑UTRAN
to/from GERAN A/Gb mode procedure (clauses 5.5.2.3 and 5.5.2.4). These
descriptions are in **_bold italic text_** and shall be modified
simultaneously when clauses 5.5.2.3 or 5.5.2.4 are updated.
### D.3.7.2 Preparation phase
Figure D.3.7.2-1: E-UTRAN to GERAN A/Gb Inter RAT HO, preparation phase
**_1\. The source eNodeB decides to initiate an Inter RAT Handover to the
target GERAN A/Gb mode (2G) system. At this point both uplink and downlink
user data is transmitted via the following: Bearer(s) between UE and Source
eNodeB, GTP tunnel(s) between Source eNodeB, Serving GW and PDN GW._**
**_NOTE 1: The process leading to the handover decision is outside of the
scope of this specification_**
**_2\. The source eNodeB sends a Handover Required (Cause, Target System
Identifier, Source eNodeB Identifier, Source BSS to Target BSS Transparent
Container) message to the Source MME to request the CN to establish resources
in the Target BSS, Target SGSN and the Serving GW. The bearers that will be
subject to data forwarding (if any) are identified by the new SGSN in a later
step (see step 8 below)._**
**_The \'Target System Identifier\' IE contains the identity of the target
global cell Id._**
NOTE 2: This step is unmodified compared to clause 5.5.2.3.2. The target SGSN
acts as the new SGSN.
_3 The old SGSN determines from the Target Cell Identifier that the type of
handover is inter-RAT/mode handover. In case of Inter-RAT/ mode Inter-SGSN PS
handover, the old SGSN initiates the PS Handover resource allocation procedure
by sending a Forward Relocation Request (IMSI, Tunnel Endpoint Identifier
Control Plane, RANAP Cause, Target Cell Identifier, MM Context, PDP Contexts,
Packet Flow ID, SNDCP XID parameters, LLC XID parameters, PDP Context
Prioritisation, Source BSS To Target BSS Transparent Container [RN part] in
the BSS Container, Source RNC Id, SGSN Address for control plane) message to
the new SGSN. If the old SGSN supports PS handover procedures then it has to
allocate a valid PFI according to clause 4.4.1 during the PDP Context
activation procedure. Each PDP context contains the GGSN Address for User
Plane and the Uplink TEID for Data (to this GGSN Address and Uplink TEID for
Data the old SGSN and the new SGSN send uplink packets)._
_The MM context contains security related information, e.g. supported
ciphering algorithms as described in TS 29.060 [14]. The relation between GSM
and UMTS security parameters is defined in TS 33.102 [40],_
_The new SGSN selects the ciphering algorithm to use. This algorithm will be
sent transparently from the new SGSN to the MS. The IOV-UI parameter generated
in the new SGSN and used, as input to the ciphering procedure will also be
transferred transparently from the new SGSN to the MS._
_When the new SGSN receives the Forward Relocation Request message the
required PDP, MM, SNDCP and LLC contexts are established and a new P-TMSI is
allocated for the MS. When this message is received by the new SGSN it begins
the process of establishing PFCs for all PDP contexts._
_When the new SGSN receives the Forward Relocation Request message it extracts
from the PDP Contexts the NSAPIs and SAPIs and PFIs to be used in the new
SGSN. If for a given PDP Context the new SGSN does not receive a PFI from the
old SGSN, it shall not request the target BSS to allocate TBF resources
corresponding to that PDP Context. If none of the PDP Contexts forwarded from
the old SGSN has a valid PFI allocated the new SGSN shall consider this as a
failure case and the request for PS handover shall be rejected._
_In case when an SAPI and PFI was available at the old SGSN but the new SGSN
does not support the same SAPI and PFI for a certain NSAPI as the old SGSN,
the new SGSN shall continue the PS handover procedure only for those NSAPIs
for which it can support the same PFI and SAPI as the old SGSN. All PDP
contexts for which no resources are allocated by the new SGSN or for which it
cannot support the same SAPI and PFI (i.e. the corresponding NSAPIs are not
addressed in the response message of the target SGSN), are maintained and the
related SAPIs and PFIs are kept. These PDP contexts may be modified or
deactivated by the new SGSN via explicit SM procedures upon RAU procedure._
_The old SGSN shall indicate the current XID parameter settings if available
(i.e. those negotiated at the old SGSN when the MS was in A/Gb mode or
received during a previous inter-SGSN PS handover) to the new SGSN. If the new
SGSN can accept all XID parameters as indicated by the old SGSN, the new SGSN
shall create a NAS container for PS HO indicating \'Reset to the old XID
parameters\'. Otherwise, if the new SGSN cannot accept all XID parameters
indicated by the old SGSN or if no XID parameters were indicated by the old
SGSN, the new SGSN shall create a NAS container for PS HO indicating Reset
(i.e. reset to default parameters)._
NOTE 3: This step is unmodified compared to pre-Rel-8. The Source eNodeB acts
as the source RNC, Source MME acts as the old SGSN, and the PDN GW acts as the
GGSN.
_4\. The new SGSN sends a PS Handover Request (Local TLLI, IMSI, Cause, Target
Cell Identifier, Source BSS to Target BSS Transparent Container (RN part),
PFCs To Be Set Up List, NAS container for PS HO) message to the target BSS.
The new SGSN shall not request resources for PFCs associated with PDP contexts
with maximum bit rate for uplink and downlink of 0 kbit/s or for which the
Activity Status Indicator within the PDP Context indicates that no active RAB
exists on the source side._
_5\. Based upon the ABQP for each PFC the target BSS makes a decision about
which PFCs to assign radio resources. The algorithm by which the BSS decides
which PFCs that need resources is implementation specific. Due to resource
limitations not all downloaded PFCs will necessarily receive resource
allocation. The target BSS allocates TBFs for each PFC that it can
accommodate._
_6\. The target BSS shall prepare the Target BSS to Source BSS Transparent
Container which contains a PS Handover Command including the CN part (NAS
container for PS HO) and the RN part (PS Handover Radio Resources)._
_7\. Target BSS shall send the PS Handover Request Acknowledge message (Local
TLLI, List of Set Up PFCs, Target BSS to Source BSS Transparent Container)
message to the new SGSN. Upon sending the PS Handover Request Acknowledge
message the target BSS shall be prepared to receive downlink LLC PDUs from the
new SGSN for the accepted PFCs._
_Any PDP contexts for which a PFC was not established are maintained in the
new SGSN and the related SAPIs and PFIs are kept. These PDP contexts may be
modified or deactivated by the new SGSN via explicit SM procedures upon the
completion of the routing area update (RAU) procedure._
_8\. The new SGSN passes the assigned list of TEIDs for each PDP context for
which a PFC was assigned in the RAB setup information IE in the Forward
Relocation Response (Cause, List of Set Up PFCs, Target BSS to Source BSS
Transparent Container) in the BSS Container, Tunnel Endpoint Identifier
Control Plane, SGSN Address for User Traffic, Tunnel Endpoint Identifier Data
II) message to the old SGSN. The NSAPIs of the active PDP Contexts received in
the Forward Relocation Request message for which the PS handover continues,
i.e. for which resources are allocated for the PFCs in the target BSS, are
indicated in this message._
_The Tunnel Endpoint Identifier Data II, one information for each PDP context,
is the tunnel endpoint of the new SGSN and is used for data forwarding from
the Source eNodeB, via the new SGSN, to the target BSS._
_The new SGSN activates the allocated LLC/SNDCP engines as specified in TS
44.064 [23] for an SGSN originated Reset or \'Reset to the old XID
parameters\'._
_When the old SGSN receives the Forward Relocation Response message and it
decides to proceed with the handover, the preparation phase is finished and
the execution phase will follow._
NOTE 4: This step is mostly unmodified compared to pre-Rel-8. The Source MME
acts as the old SGSN, and the PDN GW acts as the GGSN.
**_9\. If \'Indirect Forwarding\' applies, the source MME sends a Create
Indirect Data Forwarding Tunnel Request message (Cause, SGSN Address(es) and
TEID(s) for Data Forwarding) to the Serving GW. Cause indicates that the
bearer(s) are subject to data forwarding._**
**_Indirect forwarding may be performed via a Serving GW which is different
from the Serving GW used as the anchor point for the UE._**
**_9a. The Serving GW returns a Create Indirect Data Forwarding Tunnel
Response (Cause, Serving GW Address(es) and TEID(s) for Data Forwarding)
message to the target MME. If the Serving GW doesn\'t support data forwarding,
an appropriate cause value shall be returned and the Serving GW Address(es)
and TEID(s) will not be included in the message._**
### D.3.7.3 Execution phase
Figure D.3.7.3-1: E-UTRAN to GERAN A/Gb mode Inter RAT HO, execution phase
_The source eNodeB continues to receive downlink and uplink user plane PDUs._
1\. The Source MME completes the preparation phase towards Source eNodeB by
sending the message Handover Command (Target BSS to Source BSS Transparent
Container (PS Handover Command with RN part and EPC part), Bearers Subject to
Data Forwarding List). The \"Bearers Subject to Data forwarding list\" may be
included in the message and it shall be a list of \'Address(es) and TEID(s)
for user traffic data forwarding\' received from target side in the
preparation phase (Forward Relocation Response message (Step 8)).
Source eNodeB initiate data forwarding for the bearers specified in the
\"Bearers Subject to Data Forwarding List\". The data forwarding goes directly
to target SGSN decided in the preparation phase.
**_2\. The Source eNodeB will give a command to the UE to handover to the
Target Access System via the message HO from E-UTRAN Command. This message
includes a transparent container including radio aspect parameters that the
Target BSS has set-up in the preparation phase (RN part). This message also
includes the XID and IOV-UI parameters received from the Target SGSN (EPC
part)._**
**_Upon the reception of the HO from E-UTRAN Command message containing the
Handover Command message, the UE shall associate its bearer IDs to the
respective PFIs based on the relation with the NSAPI and shall suspend the
uplink transmission of the user plane data._**
NOTE 1: This step is unmodified compared to clause 5.5.2.3.3. The target SGSN
acts as the new SGSN.
3\. Void.
NOTE 2: The source eNodeB does not send any RAN context towards the target
BSS.
_4\. The MS executes the handover according to the parameters provided in the
message delivered in step 2. The procedure is the same as in step 6 in clause
5.1.4.2 in TS 43.129 [8] with the additional function of association of the
received PFI and existing RAB Id related to the particular NSAPI as described
in clause 4.4.1 in TS 43.129 [8]._
The UE locally deactivates ISR by setting its TIN from \"RAT-related TMSI\" to
\"GUTI\", if any EPS bearer context activated after the ISR was activated in
the UE exists.
_5/7. After accessing the cell using access bursts and receiving timing
advance information from the BSS in step 2, the MS processes the NAS container
and then sends one XID Response message to the new SGSN. The MS sends this
message immediately after receiving the Packet Physical Information message
containing the timing advance or, in the synchronised network case,
immediately if the PS Handover Access message is not required to be sent (see
clause 6.2 in TS 43.129 [8])._
_Upon sending the XID Response message, the MS shall resume the user data
transfer only for those NSAPIs for which there are radio resources allocated
in the target cell. For NSAPIs using LLC ADM for which radio resources were
not allocated in the target cell the MS may request for radio resources using
the legacy procedures._
_NOTE 3: If the new SGSN indicated Reset (i.e. reset to default parameters) in
the NAS container for PS HO included in the Handover from UTRAN Command
message (UTRAN) or the Handover from GERAN Iu Command message, in order to
avoid collision cases the mobile station may avoid triggering XID negotiation
for any LLC SAPI used in LLC ADM, but wait for the SGSN to do so (see step
12). In any case the mobile station may avoid triggering XID negotiation for
any LLC SAPI used in LLC ABM, but wait for the SGSN to do so (see step 12a)._
NOTE 4: This step is unmodified compared to pre-Rel-8. The message \"HO from
E-UTRAN Command\" acts as the \"Handover from UTRAN Command\" message (UTRAN)
or the \"Handover from GERAN Iu Command\" message.
_6\. Upon reception of the first correct RLC/MAC block (sent in normal burst
format) from the MS the target BSS sends a PS Handover Complete (Local TLLI,
Handover Complete Status) message to inform the new SGSN that the MS has
arrived in the target cell. Each uplink N-PDU received by the new SGSN via the
target BSS is then forwarded directly to the GGSN._
NOTE 5: This step is unmodified compared to pre-Rel-8. The PDN GW acts as the
GGSN.
_8\. Upon receiving the PS Handover Complete message, the new SGSN send a
Forward Relocation Complete message to the old SGSN to indicate completion of
the PS handover procedures. The old SGSN responds with a Forward Relocation
Complete Acknowledge message._
A timer in source MME is started to supervise when resources in Source eNodeB
and Source Serving GW shall be released.
NOTE 6: This step is unmodified compared to pre-Rel-8. The Source MME acts as
the old SGSN.
_9/11. The new SGSN sends an Update PDP Context Request (new SGSN Address,
TEID, QoS Negotiated) message to the GGSN concerned. The GGSN updates the PDP
context fields and returns an Update PDP Context Response (TEID) message. From
now on the GGSN sends new incoming downlink IP packets to the new SGSN instead
of to the old SGSN._
The PDN GW shall include a Charging Id to be used at the SGSN as the Charging
Id for reporting usage for this PDP context. The PDN GW shall include the
Charging Id in the offline charging data.
NOTE 7: This step is unmodified compared to pre-Rel-8. The Source MME acts as
the old SGSN, and the PDN GW acts as the GGSN.
_12\. If the new SGSN indicated Reset (i.e. reset to default parameters) in
the NAS container for PS HO included in the Handover from UTRAN Command
message (UTRAN) or the Handover from GERAN Iu Command message, then on receipt
of the PS Handover Complete the new SGSN initiates an LLC/SNDCP XID
negotiation for each LLC SAPI used in LLC ADM. In this case if the SGSN wants
to use the default parameters, it shall send an empty XID Command. If the new
SGSN indicated \'Reset to the old XID parameters\' in the NAS container for PS
HO, no further XID negotiation is required for LLC SAPIs used in LLC ADM
only._
NOTE 8: This step is unmodified compared to pre-Rel-8. The message \"HO from
E-UTRAN Command\" acts as the \"Handover from UTRAN Command\" message (UTRAN)
or the \"Handover from GERAN Iu Command\" message.
_12a. The new SGSN (re-)establishes LLC ABM for the PDP contexts which use
acknowledged information transfer. During the exchange of SABM and UA the SGSN
shall perform LLC/SNDCP XID negotiation._
_13\. The MS sends a Routing Area Update Request (Old P-TMSI, Old RAI, Old
P-TMSI signature, Update Type) message to the new SGSN informing it that the
source cell belongs to a new routing area. The MS shall send this message
immediately after message 5, see TS 23.060 [7]._
_The new SGSN knows that a handover has been performed for this MS and can
therefore exclude the SGSN context procedures which normally are used within
the RA Update procedure._
For further descriptions of the Routing Area Update procedure see TS 43.129
[8], clauses 5.5.2.3 and 5.6.1.1.1.
NOTE 9: The RAU procedure is performed regardless if the routing area is
changed or not, as specified by TS 43.129 [8].
**_14\. When the timer started at step 8 expires, the source MME sends a
Release Resources message to the source eNodeB. The Source eNodeB releases its
resources related to the UE._**
Additionally, the source MME deletes the EPS bearer resources by sending
Delete Session Request (Cause, TEID) messages to the Serving GW. Cause
indicates to the Serving GW that it shall not initiate a delete procedure
towards the PDN GW. The Serving GW acknowledges with Delete Session Response
(TEID) messages. If ISR is activated then the cause also indicates to the old
Serving GW that the old Serving GW shall delete the bearer resources on the
other old CN node by sending Delete Bearer Request message(s) to that CN node.
15\. When the timer started in step 8 expires and if resources for indirect
forwarding have been allocated then they are released.
## D.3.8 GERAN A/Gb mode to E-UTRAN Inter RAT handover
### D.3.8.1 General
See clause D.3.7.1.
### D.3.8.2 Preparation phase
Figure D.3.8.2-1: GERAN A/Gb mode to E-UTRAN inter RAT HO, preparation phase
_1\. The source BSS decides to initiate a PS handover. At this point both
uplink and downlink user data is transmitted via the following: TBFs between
MS and source BSS, BSSGP PFCs tunnel(s) between source BSS and old SGSN, GTP
tunnel(s) between old SGSN and GGSN._
NOTE 1: The MS acts as UE, and the PDN GW acts as the GGSN.
**_2\. The source BSS sends the message PS handover Required (TLLI, Cause,
Source Cell Identifier, Target eNodeB Identifier, Source to Target Transparent
Container (RN part), and active PFCs list) to Source SGSN to request the CN to
establish resources in the Target eNodeB, Target MME and the Serving GW._**
NOTE 2: The Source SGSN acts as the Old SGSN.
NOTE 3: As an implementations option for supporting introduction scenarios
with pre-Rel‑8 SGSNs the source BSS may be configured to use RNC IDs instead
of eNodeB IDs to identify a target eNodeB. Cause indicates the GERAN to
E‑UTRAN handover. The Cause is relayed transparently by the SGSN. Source to
Target Transparent Container carries information for the target eNodeB. This
container is relayed transparently by the SGSN.
**_3\. The Source SGSN determines from the \'Target eNodeB Identifier\' IE
that the type of handover is IRAT PS Handover to E-UTRAN. The Source SGSN
initiates the Handover resource allocation procedure by sending message
Forward Relocation Request (IMSI, Target Identification, MM Context, PDP
Context, SGSN Tunnel Endpoint Identifier for Control Plane, SGSN Address for
Control plane, Source to Target Transparent Container (RN part), Packet Flow
ID, SNDCP XID parameters, LLC XID parameters) to the target MME. This message
includes all PDP contexts that are established in the source system indicating
the PFIs and the XID parameters related to those PDP Contexts, and the uplink
Tunnel endpoint parameters of the Serving GW._**
**_The PDP Contexts shall be sent in a prioritized order, i.e. the most
important PDP Context first. The prioritization method is implementation
dependent, but should be based on the current activity._**
**_NOTE 4: Assigning the highest priority to the PDP context without TFT could
be done to get service continuity for all ongoing services regardless of the
number of supported EPS bearers in the UE and network._**
**_The target MME maps the PDP contexts to the EPS bearers 1-to-1 and maps the
pre-Rel-8 QoS parameter values of a PDP context to the EPS Bearer QoS
parameter values of an EPS bearer as defined in Annex E. The MME establishes
the EPS bearer(s) in the indicated order. The MME deactivates the EPS bearers
which cannot be established._**
**_The MM context contains security related information, e.g. supported
ciphering algorithms as described in TS 29.060 [14]._**
**_For the PDP Context with traffic class equals \'Background\', the source
SGSN shall indicate via the Activity Status Indicator IE that EPS bearers
shall be established on the target side._**
NOTE 5: The Source SGSN acts as the old SGSN.
4\. The target MME selects the Serving GW as described under clause 4.3.8.2 on
\"Serving GW selection function\". The target MME sends a Create Session
Request message (IMSI, MME Tunnel Endpoint Identifier for Control Plane, MME
Address for Control plane, PDN GW address(es) for user plane, PDN GW UL
TEID(s) for user plane, PDN GW address for control plane, and PDN GW TEID(s)
for control plane, the Protocol Type over S5/S8) per PDN connection to the
Serving GW. The Protocol Type over S5/S8 is provided to Serving GW which
protocol should be used over S5/S8 interface.
**_4a. The Serving GW allocates its local resources and returns them in a
Create Session Response (Serving GW address(es) for user plane, Serving GW UL
TEID(s) for user plane, Serving GW Address for control plane, Serving GW TEID
for control plane) message to the target MME._**
**_5\. The Target MME will request the Target eNodeB to establish the
Bearer(s) by sending the message Handover Request (UE Identifier, S1AP Cause,
Integrity protection information (i.e. IK and allowed Integrity Protection
algorithms), Encryption information (i.e. CK and allowed Ciphering
algorithms), EPS Bearers to be setup list, Source to Target Transparent
Container). The Target MME shall not request resources for which the Activity
Status Indicator within a PDP Context indicates that no active bearer exists
on the source side for that PDP Context._**
**_For each EPS bearer requested to be established, \'EPS Bearers To Be
Setup\' IE shall contain information such as ID, bearer parameters, Transport
Layer Address and S1 Transport Association. The Transport Layer Address is the
Serving GW Address for user data, and the S1 Transport Association corresponds
to the uplink Tunnel Endpoint Identifier Data._**
The target MME shall not request the target eNodeB to establish EPS GBR
bearers with maximum bitrate set to 0 and those EPS bearers should not be
included in the EPS Bearers to be setup list and should be deactivated by the
MME. For the remaining EPS Bearer Contexts the MME ignores any Activity Status
Indicator within an EPS Bearer Context and requests the target eNodeB to
allocate resources for all the remaining EPS Bearer Contexts.
**_The ciphering and integrity protection keys will be sent transparently from
the target eNodeB to the UE in the Target to Source Transparent Container, and
in the message PS Handover Command from source BSS to the UE. This will then
allow data transfer to continue in the new RAT/mode target cell without
requiring a new AKA (Authentication and Key Agreement) procedure._**
The local UE-AMBR shall be included in the \'EPS Bearers be setup list\' IE.
The local UE-AMBR is described in clause Annex E.
**_5a. The Target eNodeB allocates the request resources and returns the
applicable parameters to the Target MME in the message Handover Request
Acknowledge (Target to Source Transparent Container, EPS Bearers setup list,
EPS Bearers failed to setup list). Upon sending the Handover Request
Acknowledge message the target eNodeB shall be prepared to receive downlink
GTP PDUs from the Serving GW for the accepted EPS bearers._**
The target eNodeB shall ignore it if the number of radio bearers in the Source
to Target Transparent container does not comply with the number of bearers
requested by the MME and allocate bearers as requested by the MME.
**_6\. If \'Indirect Forwarding\' applies, the target MME sends a Create
Indirect Data Forwarding Tunnel Request message (Cause, Target eNodeB
Address(es), TEID(s) for DL user plane) to the Serving GW. Cause indicates
that the bearer(s) are subject to data forwarding._**
**_6a. The Serving GW returns a Create Indirect Data Forwarding Tunnel
Response (Cause, Serving GW Address(es) and TEID(s) for Data Forwarding)
message to the target MME. If the Serving GW doesn\'t support data forwarding,
an appropriate cause value shall be returned and the Serving GW Address(es)
and TEID(s) will not be included in the message._**
**_7\. The Target MME sends the message Forward Relocation Response (Cause,
List of Set Up PFCs, MME Tunnel Endpoint Identifier for Control Plane, S1-AP
cause, MME Address for control plane, Target to Source Transparent Container,
Address(es) and TEID(s) for Data Forwarding, Serving GW change indication) to
the Source SGSN. Serving GW change indication indicates a new Serving GW has
been selected._**
If \'Direct Forwarding\' is applicable, then the IEs \'Address(es) and TEID(s)
for Data Forwarding\' contains the DL GTP-U tunnel endpoint parameters to the
eNodeB. If \'Indirect Forwarding\' applies the IEs \'Address(es) and TEID(s)
for Data Forwarding\' contain the DL GTP-U tunnel endpoint parameters to the
Serving GW.
NOTE 6: The Source SGSN acts as the old SGSN.
### D.3.8.3 Execution phase
Figure D.3.8.3-1: GERAN A/Gb mode to E-UTRAN Inter RAT HO, execution phase
NOTE 1: For a PMIP-based S5/S8, procedure steps (A) are defined in TS 23.402
[2]. Steps 9 and 9a concern GTP based S5/S8.
The old SGSN continues to receive downlink and uplink user plane PDUs.
When old SGSN receives the Forward Relocation Response message it may start
downlink N-PDU relay and duplication to the target eNodeB, and the target
eNodeB may start blind transmission of downlink user data towards the UE over
the allocated radio channels.
**_1\. The Source SGSN completes the preparation phase towards Source BSS by
sending the message PS HO Required Acknowledge (TLLI, List of Set Up PFCs,
Target to Source Transparent Container). This message includes all PFIs that
could be established on the Target side._**
**_Before sending the PS Handover Required Acknowledge message, the source
SGSN may suspend downlink data transfer for any PDP contexts._**
**_Before sending the PS Handover Command message to the UE the source BSS,
may try to empty the downlink BSS buffer for any BSS PFCs._**
NOTE 2: The Source SGSN acts as the old SGSN.
**_2\. The Source BSS will command the UE to handover to the target eNodeB via
the message PS Handover Command. The access system specific message to UE
includes a transparent container including radio aspect parameters that the
Target eNodeB has set-up in the preparation phase._**
3\. There is no RAN context transfer during inter RAT handovers with E-UTRAN.
If the source SGSN originates any SRNS contexts the MME acknowledges the
receipt towards the SGSN and ignores the message content.
**_4\. The UE moves to the E-UTRAN and performs access procedures toward
Target eNodeB._**
**_5\. When the UE has got access to Target eNodeB it sends the message HO to
E-UTRAN Complete. The UE shall implicitly derive the EPS bearers for which an
E-RAB was not established from the PS Handover Command and deactivate them
locally without an explicit NAS message at this step._**
**_6\. When the UE has successfully accessed the Target eNodeB, the Target
eNodeB informs the Target MME by sending the message Handover Notify._**
Upon receipt of the Handover Notify message the target MME starts a timer if
the target MME applies indirect forwarding.
7\. Then the Target MME knows that the UE has arrived to the target side and
Target MME informs the old SGSN by sending the Forward Relocation Complete ()
message. The old SGSN will also acknowledge that information. When the Forward
Relocation Complete message has been received and there is no longer any need
for the Old SGSN to forward data, the old SGSN stops data forwarding. A timer
in old SGSN is started to supervise when resources shall be released.
**_8\. The Target MME will now complete the Handover procedure by informing
the Serving GW (for Serving GW relocation this will be the Target Serving GW)
that the Target MME is now responsible for all the EPS bearers the UE have
established. This is performed in the message Modify Bearer Request (Cause,
MME Tunnel Endpoint Identifier for Control Plane, EPS Bearer ID(s), MME
Address for Control Plane, eNodeB Address(es) and TEID(s) for User Traffic for
the accepted EPS bearers, PDN GW addresses and TEIDs (for GTP-based S5/S8) or
GRE keys (for PMIP-based S5/S8) at the PDN GW(s) for uplink traffic and RAT
type) per PDN connection._**
**_In case any EPS bearers are to be released the MME triggers the bearer
release procedure as specified in clause 5.4.4.2. If the Serving GW receives a
DL packet for a non-accepted bearer, the Serving GW drops the DL packet and
does not send a Downlink Data Notification to the MME._**
NOTE 3: The text regarding \"Target Serving GW\" shall be ignored.
**_9\. The Serving GW (for Serving GW relocation this will be the Target
Serving GW) informs the PDN GW(s) the change of, for example, for Serving GW
relocation or the RAT type, that e.g. can be used for charging, by sending the
message Modify Bearer Request per PDN connection. For Serving GW relocation,
the Serving GW allocates DL TEIDs on S5/S8 even for non-accepted bearers. The
PDN GW must acknowledge the request with the message Modify Bearer Response
(APN Restriction). When the UE moves from Gn/Gp SGSN to the MME, the PDN GW
shall send the APN restriction of each bearer context to the Serving GW._**
**_If PCC infrastructure is used, the PDN GW informs the PCRF about the change
of, for example, the RAT type._**
The Modify Bearer Response also indicates the identity of the default bearer
and the Charging Id towards the S‑GW.
NOTE 4: The text regarding \"Target Serving GW\" shall be ignored.
**_10\. The Serving GW (for Serving GW relocation this will be the Target
Serving GW) acknowledges the user plane switch to the Target MME via the
message Modify Bearer Response (Cause, Serving GW Tunnel Endpoint Identifier
for Control Plane, Serving GW (for Serving GW relocation this will be the
Target Serving GW) Address for Control Plane, Protocol Configuration Options,
PDN GW addresses and TEIDs (for GTP-based S5/S8) or GRE keys (for PMIP-based
S5/S8) at the PDN GW(s) for uplink traffic, APN Restriction). The Serving GW
shall forward the received APN Restriction to the MME. At this stage the user
plane path is established for all bearers between the UE, Target eNodeB,
Serving GW (for Serving GW relocation this will be the Target Serving GW) and
PDN GW._**
In addition, the Modify Bearer Response indicates the identity of the default
bearer towards the MME.
**_11\. When the timer started in step 7 expires the Source SGSN will clean-up
all its resources towards Source BSS by performing the BSS Packet Flow Delete
procedure._**
When the timer started in step 6 expires the target MME releases the resources
that have been allocated for indirect forwarding.
NOTE 5: The text regarding \"Target Serving GW\" shall be ignored.
**_12\. The RAN triggers the UE to initiate a Tracking Area Update procedure
with the target MME. It is RAN functionality to provide the ECM CONNECTED UE
with the trigger information._**
**_The target MME knows that an IRAT Handover has been performed for this UE
as it received the bearer context(s) by handover messages and therefore the
target MME performs only a subset of the TA update procedure, specifically it
excludes the context transfer procedures between source SGSN and target
MME.\_** The target MME gets the subscribed UE-AMBR value and the subscribed
APN-AMBR value from the HSS during the TA update procedure.
13\. The target MME calculates UE-AMBR as defined in clause 4.7.3. If the
local UE-AMBR provided by the MME as defined in Annex E is different from the
corresponding derived UE-AMBR, or the APN-AMBR mapped from the subscribed MBR
is different from the subscribed APN-AMBR, or the mapped subscribed QoS
profile (i.e. the subscribed QoS profile mapped according to Annex E) of the
default bearer is different from the EPS Subscribed QoS profile received from
the HSS, the new MME shall initiate Subscribed QoS Modification procedure as
described in clause 5.4.2.2, Figure 5.4.2.2-1.
###### ## Annex E (normative): Mapping between EPS and pre-Rel-8 QoS
parameters
This annex specifies how the QoS parameter values of an EPS bearer are mapped
to/from the pre-Rel-8 QoS parameter values of a PDP context in PDN GW, S4-SGSN
and MME.
Within this specification, different names are used for the QoS parameter of a
PDP context e.g. \"pre-Rel‑8 QoS parameters\" and \"R99 QoS Profile\", but
nevertheless the whole QoS IE as described in TS 24.008 [47] is referred to
including the R99 and R98/97 QoS attributes. This means that the MME performs
QoS mapping, populates and forwards both R99 and R97/98 QoS attributes towards
the UE in S1 mode, if the UE supports A/Gb mode or Iu mode or both. The MME
also performs QoS mapping, populates and forwards both R99 and R97/98 QoS
attributes also on Gn when deployed in the interoperation scenarios as listed
in Annex D, clause D.2. The S4-SGSN performs QoS mapping, populates and
forwards either both R99 and R97/98 QoS attributes or only R97/98 QoS
attributes towards the UE in Iu mode and A/Gb mode. The P-GW performs QoS
mapping, populates and forwards both R99 and R97/98 QoS attributes over Gn/Gp
when deployed in the interoperation scenarios as listed in Annex D, clause
D.2.
The following mapping rules hold:
\- There is a one-to-one mapping between an EPS bearer and a PDP context.
\- When EPS bearer QoS parameters are mapped to pre-Rel-8 QoS parameters the
pre-emption capability and the pre-emption vulnerability information of the
EPS bearer ARP are ignored and the priority of the EPS bearer parameter ARP is
mapped to the pre-Rel-8 bearer parameter ARP, as described in table E.1.
Table E.1: Mapping of EPS bearer ARP to pre-Rel-8 ARP
+---------------------------+-----------+ | EPS | Pre-Rel-8 | | | | | Bearer ARP Priority Value | ARP Value | +---------------------------+-----------+ | 1 to H | 1 | +---------------------------+-----------+ | H+1 to M | 2 | +---------------------------+-----------+ | M+1 to 15 | 3 | +---------------------------+-----------+
When pre-Rel-8 QoS parameters are mapped to EPS bearer QoS parameters the pre-
emption capability and the pre-emption vulnerability information of the EPS
bearer ARP are set based on operator policy in the entity that performs the
mapping. The pre-Rel‑8 bearer parameter ARP is mapped to the priority level
information of the EPS bearer parameter ARP as described in table E.2.
Table E.2: Mapping of pre-Rel-8 ARP to EPS bearer ARP
+-----------+---------------------------+ | Pre-Rel-8 | EPS | | | | | ARP Value | Bearer ARP Priority Value | +-----------+---------------------------+ | 1 | 1 | +-----------+---------------------------+ | 2 | H+1 | +-----------+---------------------------+ | 3 | M+1 | +-----------+---------------------------+
The values of H (high priority) and M (medium priority) can be set according
to operator requirements to ensure proper treatment of users with higher
priority level information. The minimum value of H is 1. The minimum value of
M is H+1.
NOTE 1: The setting of the values for H and M may be based on the SGSN mapping
from the pre-Rel‑8 ARP parameter to the ARP parameter that is used for
UTRAN/GERAN.
NOTE 2: After a handover from UTRAN/GERAN to E-UTRAN the ARP parameter of the
EPS bearer can be modified by the P‑GW to re-assign the appropriate priority
level, pre-emption capability and pre-emption vulnerability setting.
NOTE 3: A mapping from the EPS bearer parameter ARP to the pre-Rel‑8 bearer
parameter ARP is not required for a P‑GW when connected to an SGSN via Gn/Gp
as any change of the bearer ARP parameter may get overwritten by the SGSN due
to subscription enforcement. However, the P‑GW should not combine services
with different EPS bearer ARP values onto the same PDP context to enable a
modification of the bearer ARP without impacting the assignment of services to
bearers after a handover to E-UTRAN.
\- The EPS bearer parameters GBR and MBR of a GBR EPS bearer are mapped one-
to-one to/from the pre-Rel-8 bearer parameters GBR and MBR of a PDP context
associated with Traffic class \'conversational\' or \'streaming\'.
\- When EPS bearer QoS parameters are mapped to pre-Rel-8 QoS parameters the
pre-Rel-8 bearer parameter MBR of PDP contexts associated with Traffic Class
\'interactive\' or \'background\' is set equal to the value of the authorized
APN-AMBR. If the APN-AMBR is modified while the UE accesses the EPS through
E-UTRAN, the UE shall also set the pre-Rel-8 bearer parameter MBR to the new
APN-AMBR value for all non-GBR PDP contexts of this PDN connection. The P‑GW
shall enforce the APN-AMBR across all PDP contexts with Traffic Class
\'interactive\' and \'background\' for that APN.
\- When pre-Rel-8 QoS parameters are mapped to EPS bearer QoS parameters the
AMBR for the corresponding APN shall be set equal to the MBR value of the
subscribed QoS profile. At handover from a Gn/Gp SGSN the MME or S4-SGSN shall
provide this APN-AMBR value to the Serving GW and the PDN GW for each PDN
connection. It is required that the subscribed MBR in the HLR/HSS is set to
the desired APN-AMBR value for all subscribed APNs which may lead to a
selection of a P‑GW. The UE derives the APN-AMBR from the value of the MBR of
a PDP context created by the PDP Context Activation Procedure as described in
TS 23.060 [7].
NOTE 5: If the pre-Rel-8 UE with the updated subscribed MBR is connected to a
GGSN, the GGSN can downgrade the MBR of the PDP contexts based on either local
policy or PCC (where the MBR per QCI information is provided to the PCEF).
\- For handover from a Gn/Gp SGSN the MME provides a local UE-AMBR to the
eNodeB until MME gets the EPS subscribed UE-AMBR. When the MME gets the
subscribed UE‑AMBR value from the HSS, it calculates the UE-AMBR (UE-
AMBR=MIN(subscribed UE-AMBR, sum APN-AMBR of all active APNs)). Then it
compares this value with the local UE-AMBR and of the local UE-AMBRs is
different from the corresponding derived UE-AMBR, the MME initiates HSS
Initiated Subscribed QoS Modification procedure to notify the derived UE-AMBR
to the eNodeB.
NOTE 6: The local UE-AMBR may be for example based on the summing up of the
APN-AMBR values of all a active APNs of the UE or on internal configuration.
\- A standardized value of the EPS bearer parameter QCI is mapped one-to-one
to/from values of the pre-Rel-8 parameters Traffic Class, Traffic Handling
Priority, Signalling Indication, and Source Statistics Descriptor as shown in
Table E.3.
NOTE 7: When mapping to QCI=2 or QCI=3, the pre‑Rel‑8 parameter Transfer Delay
is used in addition to the four pre‑Rel‑8 parameters mentioned above.
\- When EPS bearer QoS parameters are mapped to pre-Rel-8 QoS parameters the
setting of the values of the pre-Rel-8 parameters Transfer Delay and SDU Error
Ratio is derived from the corresponding QCI\'s Packet Delay Budget and Packet
Loss Rate, respectively. When Packet Loss Rate parameter is further mapped to
pre-Rel‑8 QoS parameter Reliability Class (TS 23.107 [54], table 7), the
Residual BER is considered \GBR bearers\" 8.0.0 8.1.0 2008-03 SP-39 SP-080116
0064 1 C Table of Standardized QCIs 8.0.0 8.1.0 2008-03 SP-39 SP-080126 0063 1
B Subscriber Type on S1 8.0.0 8.1.0 2008-03 SP-39 SP-080118 0061 2 F Clean-up
of QoS Sections in 23.401 8.0.0 8.1.0 2008-03 SP-39 SP-080115 0060 3 B
Recommended QCI to DiffServ Code Point Mapping 8.0.0 8.1.0 2008-03 SP-39
SP-080118 0056 2 F Selecting and signalling the security algorithms in
handover from Rel-8 UTRAN to E-UTRAN 8.0.0 8.1.0 2008-03 SP-39 SP-080117 0055
2 D The editorial modification for attach procedure 8.0.0 8.1.0 2008-03 SP-39
SP-080118 0049 3 F High level description of Tracking and Reachability
Management for UE in ECM-IDLE state 8.0.0 8.1.0 2008-03 SP-39 SP-080118 0044 1
F Section on \'Security Function\' 8.0.0 8.1.0 2008-03 SP-39 SP-080115 0041 4
B A method to achieve load balancing 8.0.0 8.1.0 2008-03 SP-39 SP-080118 0033
3 F Several FFS clean-up 8.0.0 8.1.0 2008-03 SP-39 SP-080118 0032 2 F
Correction of the MME Initiated Bearer procedures 8.0.0 8.1.0 2008-03 SP-39
SP-080118 0031 1 F Relationship between EPS Bearer Identity and NSAPI/RAB ID
8.0.0 8.1.0 2008-03 SP-39 SP-080115 0030 2 B PCC Rules update in ISR 8.0.0
8.1.0 2008-03 SP-39 SP-080116 0029 2 C Detach procedure with ISR 8.0.0 8.1.0
2008-03 SP-39 SP-080116 0028 1 C CR on TAU/RAU with ISR 8.0.0 8.1.0 2008-03
SP-39 SP-080115 0026 8 B UE requested PDN disconnection procedure 8.0.0 8.1.0
2008-03 SP-39 SP-080116 0020 2 C Inclusion of EIR reference point in SAE
architecture 8.0.0 8.1.0 2008-03 SP-39 SP-080118 0019 3 F Parameters used at
PCRF interaction at Attach (E-UTRAN) 8.0.0 8.1.0 2008-03 SP-39 SP-080116 0017
1 C Default bearer modification without bearer QoS update 8.0.0 8.1.0 2008-03
SP-39 SP-080116 0016 2 C Refinements to handover between non-3GPP and 3GPP
accesses 8.0.0 8.1.0 2008-03 SP-39 SP-080118 0015 1 F Serving GW relocation
8.0.0 8.1.0 2008-03 SP-39 SP-080116 0007 2 C GTP-PMIP roaming 8.0.0 8.1.0
2008-03 SP-39 SP-080118 0004 - F Corrections 3G to E-UTRAN IRAT Handover 8.0.0
8.1.0 2008-03 SP-39 SP-080118 0003 1 F Corrections 2G to E-UTRAN IRAT Handover
8.0.0 8.1.0 2008-03 SP-39 SP-080116 0002 3 C 3G to E-UTRAN IRAT Handover with
non-3GDT Support 8.0.0 8.1.0 2008-06 SP-40 SP-080375 0011 15 C Changes for
dual stack in GERAN/UTRAN 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0038 2 F Removal
of references to \'blue text\' 8.1.0 8.2.0 2008-06 SP-40 SP-080376 0039 3 C
Correction of CAMEL details for several pre Rel-8 procedures 8.1.0 8.2.0
2008-06 SP-40 SP-080377 0047 4 F Network Assisted Cell Change from E-UTRAN to
GERAN 8.1.0 8.2.0 2008-06 SP-40 SP-080375 0118 8 C AMBR per UE 8.1.0 8.2.0
2008-06 SP-40 SP-080377 0171 7 F Periodic TA update description 8.1.0 8.2.0
2008-06 SP-40 SP-080375 0174 3 F Authentication Vector Update 8.1.0 8.2.0
2008-06 SP-40 SP-080378 0177 6 F Simplify the trigger of Serving GW buffering
8.1.0 8.2.0 2008-06 SP-40 SP-080376 0187 2 F Corrections for bearer
modification procedures 8.1.0 8.2.0 2008-06 SP-40 SP-080379 0201 - F Update of
the S1 Release Procedure 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0208 2 C Removal
of Annex C 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0209 2 C Removal of Annex B
8.1.0 8.2.0 2008-06 SP-40 SP-080378 0210 2 F Recommended QCI to DiffServ Code
Point Mapping 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0214 1 C S5/S8 Protocol
Indication transferred over S11 Interface 8.1.0 8.2.0 2008-06 SP-40 SP-080376
0217 2 C downlink signalling triggered service request procedure in ISR 8.1.0
8.2.0 2008-06 SP-40 SP-080375 0218 2 C Bearer Management with ISR triggered by
Subscription Data Changing 8.1.0 8.2.0 2008-06 SP-40 SP-080375 0225 1 F
Clarification about TAI value being deleted when UE is powered up 8.1.0 8.2.0
2008-06 SP-40 SP-080375 0229 2 F Bearer Update Indication in Create Bearer
Request message 8.1.0 8.2.0 2008-06 SP-40 SP-080375 0232 1 F Alignment of
subscription data descriptions 8.1.0 8.2.0 2008-06 SP-40 SP-080375 0233 2 F
Adding information elements to default bearer activations 8.1.0 8.2.0 2008-06
SP-40 SP-080377 0253 3 C Multi-PDN connectivity to one APN 8.1.0 8.2.0 2008-06
SP-40 SP-080376 0259 3 F EPS Mobility Management and Connection Management
states 8.1.0 8.2.0 2008-06 SP-40 SP-080376 0267 3 C Clarify Service Request
types 8.1.0 8.2.0 2008-06 SP-40 SP-080375 0275 3 B Acquisition of UE location
8.1.0 8.2.0 2008-06 SP-40 SP-080376 0277 1 F Correction of Local Breakout
diagrams 8.1.0 8.2.0 2008-06 SP-40 SP-080376 0281 6 C Clarifications for
static IP allocation during attach. 8.1.0 8.2.0 2008-06 SP-40 SP-080377 0293 1
C Load re-balancing solution 8.1.0 8.2.0 2008-06 SP-40 SP-080376 0294 1 F
Clarification of IP address allocation requirements 8.1.0 8.2.0 2008-06 SP-40
SP-080376 0295 1 C Clarification of SDF QoS in UE initiated Bearer Resource
Request 8.1.0 8.2.0 2008-06 SP-40 SP-080377 0296 1 F Lawful Interception of
signalling traffic at MME 8.1.0 8.2.0 2008-06 SP-40 SP-080377 0300 1 B E-UTRAN
to GERAN Network Assisted Cell Change 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0308
2 C Support of EPC bearer model on S3 and S4 interfaces 8.1.0 8.2.0 2008-06
SP-40 SP-080377 0309 3 C Interoperability between UEs and different PS domain
network configurations 8.1.0 8.2.0 2008-06 SP-40 SP-080377 0312 2 C PDN GW
identification 8.1.0 8.2.0 2008-06 SP-40 SP-080377 0314 2 F ISR alignments for
R7 interoperation procedures 8.1.0 8.2.0 2008-06 SP-40 SP-080379 0319 1 B
Updating pre-Rel-8 SGSN to Gn/Gp SGSN 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0320
2 F QoS IE provided to the UE 8.1.0 8.2.0 2008-06 SP-40 SP-080379 0325 - F TAU
Request Validation 8.1.0 8.2.0 2008-06 SP-40 SP-080376 0326 1 F Dedicated
bearer activation in combination with UE requested PDN connectivity 8.1.0
8.2.0 2008-06 SP-40 SP-080379 0327 1 F Updating TAU of HOV procedures 8.1.0
8.2.0 2008-06 SP-40 SP-080376 0328 1 C EPS bearer context information storage
amendments 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0336 2 F Storage of the PDN GW
Address in HSS 8.1.0 8.2.0 2008-06 SP-40 SP-080378 0338 2 C Support for
handover with multiple PDNs in TS 23.401 8.1.0 8.2.0 2008-06 SP-40 SP-080375
0339 3 F Clarification of Detach procedure in section 5.3.8.2 8.1.0 8.2.0
2008-06 SP-40 SP-080375 0341 1 C Clarification of return of PDN GW address
during Initial attach 8.1.0 8.2.0 2008-06 SP-40 SP-080377 0346 2 F Missing DL
TFTs 8.1.0 8.2.0 2008-06 SP-40 SP-080377 0349 1 C Operator\'s and user\'s
preference on DHCPv4 usage 8.1.0 8.2.0 2008-06 SP-40 SP-080376 0352 1 B Select
the same PDN GW when simultaneous multiple PDN Connections are used for an APN
8.1.0 8.2.0 2008-06 SP-40 SP-080378 0361 3 B Static IP address provision 8.1.0
8.2.0 2008-06 SP-40 SP-080378 0370 1 F Removing non-critical FFSs from 23.401
8.1.0 8.2.0 2008-06 SP-40 SP-080331 0372 4 B UE capability handling in LTE/SAE
8.1.0 8.2.0 2008-06 SP-40 SP-080377 0383 3 B Mapping between S-TMSI and P-TMSI
8.1.0 8.2.0 2008-06 SP-40 SP-080379 0385 - C TAU in connected mode 8.1.0 8.2.0
2008-06 SP-40 SP-080375 0386 2 B Addition of AAA Server Network Element 8.1.0
8.2.0 2008-06 SP-40 SP-080381 0387 - F P‑GW initiated bearer deactivation with
ISR activated, ISR for Rel-8 TAU/RAU Procedures, Encryption for PAP/CHAP
parameters at UE Attach, NAS/AS inter-actions and PCC Interaction (Merger of
SA WG2 agreed CRs 0292, 0301, 0303, 0315, 0357) 8.1.0 8.2.0 2008-09 SP-41
SP-080589 0136 5 F Clarification to Procedure Transaction Id (PTI) use in
bearer modification procedures. 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0172 6 F
Uplink TFT precedence in the UE 8.2.0 8.3.0 2008-09 SP-41 SP-080588 0205 5 C
Revised DNS Function for Service Selection 8.2.0 8.3.0 2008-09 SP-41 SP-080589
0255 2 D Move description of reference points from section 4.5 to (new)
section 4.2.3 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0270 2 F Overload handling
8.2.0 8.3.0 2008-09 SP-41 SP-080589 0279 4 F Clarifications on IPv4 address
and IPv6 prefix release. 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0286 4 F
Clarification to EMM state machine 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0298 1
F Correction of \"RFSP\" parameter 8.2.0 8.3.0 2008-09 SP-41 SP-080588 0344 3
C Offloading UE in ISR-activated mode 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0390
5 F Separation of NAS signalling and PCC concepts 8.2.0 8.3.0 2008-09 SP-41
SP-080588 0391 2 C TFT handling 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0395 1 F
Clarification on the IP-CAN session procedure for IP address allocation 8.2.0
8.3.0 2008-09 SP-41 SP-080589 0404 - F ISR TEID-C clarification 8.2.0 8.3.0
2008-09 SP-41 SP-080589 0410 1 F Correct \"Context ID\" to \"GTP-C TEID\"
8.2.0 8.3.0 2008-09 SP-41 SP-080589 0412 - F Correction on the description of
UE S1AP ID 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0417 1 F Alignments for
non-3GPP handover 8.2.0 8.3.0 2008-09 SP-41 SP-080589 0418 2 F Clarification
of E-UTRAN Radio Access Network Sharing support EPC 8.2.0 8.3.0 2008-09 SP-41
SP-080589 0419 1 F Cleanup of PDN GW functionality 8.2.0 8.3.0 2008-09 SP-41
SP-080590 0420 1 F IRAT Handover Reject 8.2.0 8.3.0 2008-09 SP-41 SP-080590
0421 1 F IRAT Handover Cancel 8.2.0 8.3.0 2008-09 SP-41 SP-080590 0423 2 F
Updates to include TI, Transaction Id, in EPS 8.2.0 8.3.0 2008-09 SP-41
SP-080590 0426 2 F Updates to S1 handover to Cleanup of handover procedures
8.2.0 8.3.0 2008-09 SP-41 SP-080588 0428 3 C Address allocation implied PCC
interaction 8.2.0 8.3.0 2008-09 SP-41 SP-080590 0435 1 F Clarification on
periodic timer expiration 8.2.0 8.3.0 2008-09 SP-41 SP-080590 0437 2 F
Clarification on IP address allocation 8.2.0 8.3.0 2008-09 SP-41 SP-080590
0446 1 F Clarification for MME load balancing 8.2.0 8.3.0 2008-09 SP-41
SP-080590 0447 1 F Handovers between S4 and Gn/Gp SGSNs 8.2.0 8.3.0 2008-09
SP-41 SP-080590 0448 2 F Correction of RAU without S‑GW change 8.2.0 8.3.0
2008-09 SP-41 SP-080590 0449 2 F Triggering TAU 8.2.0 8.3.0 2008-09 SP-41
SP-080590 0451 3 F Clarifications and Corrections related to UE-AMBR and APN-
AMBR 8.2.0 8.3.0 2008-09 SP-41 SP-080590 0452 1 F Address Allocation Related
Corrections 8.2.0 8.3.0 2008-09 SP-41 SP-080590 0458 2 F Alignment of HSS
optimised interactions 8.2.0 8.3.0 2008-09 SP-41 SP-080590 0459 1 F Using
GUMMEI in MME routing at the eNodeB 8.2.0 8.3.0 2008-09 SP-41 SP-080590 0460 2
F Combining triggers for Tracking Area Update 8.2.0 8.3.0 2008-09 SP-41
SP-080591 0461 4 F Completion of UE capability handling in LTE/SAE 8.2.0 8.3.0
2008-09 SP-41 SP-080591 0466 3 F Two Type non-GBR AMBR and MBR QoS Mapping for
I-RAT HO 8.2.0 8.3.0 2008-09 SP-41 SP-080569 0480 4 B Warning system
architecture 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0482 - F Release of the last
PDN connection 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0483 4 F Clarification for
MME overload control 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0486 1 F Corrections
to UE-triggered Service Request 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0488 3 F
UL ESM piggybacking on RRC signalling 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0490
2 F EPS bearer context deactivation based on indication from RRC/S1-AP 8.2.0
8.3.0 2008-09 SP-41 SP-080591 0497 1 F MME ownership of TAs in a TA List 8.2.0
8.3.0 2008-09 SP-41 SP-080591 0500 1 F Handling of Dual address bearer flag
for PMIP-S5 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0502 1 F Clarification of
updates between S4 and Gn/Gp SGSNs 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0507 1
F S1AP alignment in Attach procedure 8.2.0 8.3.0 2008-09 SP-41 SP-080591 0508
1 F Editorial fix on IP-CAN session procedure 8.2.0 8.3.0 2008-09 SP-41
SP-080591 0510 2 F Indicating the Default PDN Subscription Context in the HSS
8.2.0 8.3.0 2008-09 SP-41 SP-080591 0512 4 F Packet Routing Function. 8.2.0
8.3.0 2008-09 SP-41 SP-080591 0513 1 F Clarification to Bearer Control Mode
(BCM) use. 8.2.0 8.3.0 2008-09 SP-41 SP-080592 0515 3 F Elaboration of flow
details in procedure S1-based handover 8.2.0 8.3.0 2008-09 SP-41 SP-080592
0517 1 F IRAT E-UTRAN -- GERAN Handover in Annex D 8.2.0 8.3.0 2008-09 SP-41
SP-080592 0518 2 F Stand alone SMC procedure in Attach and TAU 8.2.0 8.3.0
2008-09 SP-41 SP-080592 0524 1 F Error Correction on UE requested PDN
Connectivity 8.2.0 8.3.0 2008-09 SP-41 SP-080592 0529 - F Clarification of
HSS-initiated Detach procedure 8.2.0 8.3.0 2008-09 SP-41 SP-080592 0533 1 F
Control Plane for S6a and S13 8.2.0 8.3.0 2008-09 SP-41 SP-080592 0535 1 F
Rel-7/Rel-8 QCI Alignment 8.2.0 8.3.0 2008-09 SP-41 SP-080592 0536 3 F Default
bearer handling 8.2.0 8.3.0 2008-09 SP-41 SP-080592 0538 1 F Correction to UE
requested PDN disconnection procedure 8.2.0 8.3.0 2008-09 SP-41 SP-080592 0543
- F Completion of Radio Resource Management Functions 8.2.0 8.3.0 2008-09
SP-41 SP-080593 0544 1 F Clarification on Attach and TAU procedures 8.2.0
8.3.0 2008-09 SP-41 SP-080593 0546 1 F Clarification on paging no response
mechanism 8.2.0 8.3.0 2008-09 SP-41 SP-080588 0547 4 F Clarification of
implicitly detach procedure in case of ISR 8.2.0 8.3.0 2008-09 SP-41 SP-080593
0550 - F Removing FFS on load balancing weight 8.2.0 8.3.0 2008-09 SP-41
SP-080593 0551 2 F TAI and ECGI in S1 Handover Notify messages and associated
corrections 8.2.0 8.3.0 2008-09 SP-41 SP-080588 0553 3 B Update of 23.401 for
SMS procedures for E-UTRAN 8.2.0 8.3.0 2008-09 SP-41 SP-080593 0554 1 F
Inhibiting charging during indirect forwarding 8.2.0 8.3.0 2008-09 SP-41
SP-080593 0558 2 F PDN GW Identity clarification 8.2.0 8.3.0 2008-09 SP-41
SP-080593 0569 - F MME behaviour after sending a TAU Accept 8.2.0 8.3.0
2008-09 SP-41 SP-080593 0570 1 F Removal of the \"SAE bearer\" term 8.2.0
8.3.0 2008-09 SP-41 SP-080593 0571 1 F Removal of GUTI Definition 8.2.0 8.3.0
2008-09 SP-41 SP-080593 0572 - F Inter RAT Handover corrections. Other action,
indication and terminology alignments/corrections. 8.2.0 8.3.0 2008-12 SP-42
SP-080818 0173 6 F Content and packet screening in Gateways 8.3.0 8.4.0
2008-12 SP-42 SP-080818 0392 4 F Clarification about TAI/RAI value being
deleted 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0445 5 F Allocation/Retention
Priority details 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0450 5 F Indirect
forwarding for IRAT handovers 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0453 3 F
Transfer of AMBR between SGSN and MME 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0485
3 F Corrections and clarifications to ECM states 8.3.0 8.4.0 2008-12 SP-42
SP-080818 0521 2 F Correction on HSS Initiated Subscribed QoS Modification
procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0531 2 F Error cases when UE
changes to ECM-IDLE 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0578 2 F Clarification
of User Activity detection on EPS 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0579 5 F
Unnecessary Default PDN Connection Establishment during Handover Attach 8.3.0
8.4.0 2008-12 SP-42 SP-080818 0580 1 F Clarification for BCM 8.3.0 8.4.0
2008-12 SP-42 SP-080818 0584 1 F Clarification on Subscribed APN-AMBR 8.3.0
8.4.0 2008-12 SP-42 SP-080818 0586 3 F Clarification of Allocation and Release
of Resource for Data Forwarding 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0587 1 F
Removing the descriptions of HRL from the UE requested PDN connectivity
procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080818 0590 3 F Clarification of MM
state and implicitly detach procedure in case of ISR 8.3.0 8.4.0 2008-12 SP-42
SP-080819 0594 4 F Removing FFS in SBc protocol stack and addition of
duplication detection in the UE 8.3.0 8.4.0 2008-12 SP-42 SP-080819 0597 1 F
Clarification on the use of KSI~ASME~ and KSI in 23.401 8.3.0 8.4.0 2008-12
SP-42 SP-080819 0598 - F Clarification on Delete Bearer Request 8.3.0 8.4.0
2008-12 SP-42 SP-080819 0601 2 F Load balance during Inter MME/SGSN handover
8.3.0 8.4.0 2008-12 SP-42 SP-080819 0602 2 F Clarification on no paging
response 8.3.0 8.4.0 2008-12 SP-42 SP-080819 0603 2 F Detach the UE in ECM-
IDLE state 8.3.0 8.4.0 2008-12 SP-42 SP-080819 0605 2 F Alignment of QoS
terminology and minor AMBR corrections 8.3.0 8.4.0 2008-12 SP-42 SP-080819
0606 5 F Clarification to the UE requested bearer resource modification
procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080819 0607 1 F Change of default
bearer QoS and APN-AMBR 8.3.0 8.4.0 2008-12 SP-42 SP-080819 0608 1 F
Correction of UL TFT and service data flow usage 8.3.0 8.4.0 2008-12 SP-42
SP-080819 0609 1 F Update of Attach Procedure 8.3.0 8.4.0 2008-12 SP-42
SP-080819 0610 6 F Update of TAU Procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080819
0612 5 F Default bearer knowledge 8.3.0 8.4.0 2008-12 SP-42 SP-080819 0613 2 F
Release of bearers at handover 8.3.0 8.4.0 2008-12 SP-42 SP-080819 0615 2 F
Correction of Handover from UTRAN to E-UTRAN 8.3.0 8.4.0 2008-12 SP-42
SP-080820 0616 2 F Align Update Location sequence to be the same for MME and
for S4 SGSN 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0617 1 F Add interfaces to the
Offline Charging system in the Architecture Reference Model 8.3.0 8.4.0
2008-12 SP-42 SP-080820 0619 2 F Clarification of EMM state when all bearers
are released in 2G/3G 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0620 1 D Change RAB
in EPC to E-RAB 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0621 2 F Update of UE-AMBR
in the partial HO procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0622 3 F
Security Function in the Attach Procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080820
0623 2 F PDN Connection in the Attach procedure 8.3.0 8.4.0 2008-12 SP-42
SP-080820 0624 2 F Supplement items of HSS and MME in Information Storage
8.3.0 8.4.0 2008-12 SP-42 SP-080820 0625 1 F Updates to IP address release
mechanism 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0626 2 F Update to EPS Bearer
and QoS 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0628 2 F Update to the Detach
procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0629 2 F Update to the Session
Management procedures 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0631 1 F Cleanup on
PDN GW selection function 8.3.0 8.4.0 2008-12 SP-42 SP-080820 0635 1 F Align
S1-based HO with X2-based HO regarding S‑GW change 8.3.0 8.4.0 2008-12 SP-42
SP-080820 0636 1 F ISR parameters and actions: alignment leftovers 8.3.0 8.4.0
2008-12 SP-42 SP-080821 0637 1 F Clarification on S1 release for MME load re-
balancing 8.3.0 8.4.0 2008-12 SP-42 SP-080821 0639 1 F Handling of PCO
parameters at Initial Attach 8.3.0 8.4.0 2008-12 SP-42 SP-080821 0640 1 F
Update for ISR annex 8.3.0 8.4.0 2008-12 SP-42 SP-080821 0641 1 F Clarify SRNS
Context handling 8.3.0 8.4.0 2008-12 SP-42 SP-080821 0642 1 F Clarify ISR
handling during bearer procedures 8.3.0 8.4.0 2008-12 SP-42 SP-080821 0643 1 F
Corrections for the IRAT handover with Gn/Gp SGSNs 8.3.0 8.4.0 2008-12 SP-42
SP-080821 0644 1 F Corrections for container and cause handling during
handovers 8.3.0 8.4.0 2008-12 SP-42 SP-080802 0647 - F EPS bearer and QoS
mapping related FFSs in I-RAT handovers 8.3.0 8.4.0 2008-12 SP-42 SP-080821
0648 2 F Updates to information storage tables 8.3.0 8.4.0 2008-12 SP-42
SP-080821 0651 1 F Remove the \"update-needed\" status in UE 8.3.0 8.4.0
2008-12 SP-42 SP-080821 0652 3 F ARP Value for Default Bearer 8.3.0 8.4.0
2008-12 SP-42 SP-080821 0655 2 F RFSP Index in the MM Context 8.3.0 8.4.0
2008-12 SP-42 SP-080821 0656 3 F DRX parameter handling in LTE, 2G and 3G
8.3.0 8.4.0 2008-12 SP-42 SP-080821 0657 - F Adding TAI into Path Switch
Request 8.3.0 8.4.0 2008-12 SP-42 SP-080821 0660 1 F Adding PCO in more EPS
procedures due to IMS 8.3.0 8.4.0 2008-12 SP-42 SP-080821 0663 2 F
Introduction of concept of E-RAB in 23.401 8.3.0 8.4.0 2008-12 SP-42 SP-080822
0666 1 F Clarification on the Relationship between TA List and S‑GW SA 8.3.0
8.4.0 2008-12 SP-42 SP-080822 0667 1 F Clarification on ISR capability 8.3.0
8.4.0 2008-12 SP-42 SP-080822 0668 2 F Wild card APN usage in E-UTRAN 8.3.0
8.4.0 2008-12 SP-42 SP-080822 0669 - F Clarifications to packet screening
function 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0670 2 F MME initiated PDN
connection deactivation 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0671 2 F Update
the HSS initiated detach procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0673 1
F S1-based Handover, Reject 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0674 1 F
Remove SRNS Context during IRAT to/from GERAN 8.3.0 8.4.0 2008-12 SP-42
SP-080822 0675 - F Correction of ref. to GTP specification in IRAT handover
flows 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0676 1 F Transfer of PDCP SN at S1
based handover via MME 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0677 2 F Update the
detach procedure to also include SGSN as initiator in the ISR case 8.3.0 8.4.0
2008-12 SP-42 SP-080822 0679 1 D Editorial tidy-up of editor\'s notes and
typos 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0680 1 F Correction to UE Radio
Capabilities during RRC Connection Establishment 8.3.0 8.4.0 2008-12 SP-42
SP-080822 0681 1 F Correction to UE Radio Capabilities during RRC Connection
Establishment 8.3.0 8.4.0 2008-12 SP-42 SP-080822 0682 - F Correction to
location reporting control 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0683 1 F
Removing network management function 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0685
1 F Handling of NAS requests during an ongoing X2 HO 8.3.0 8.4.0 2008-12 SP-42
SP-080823 0686 1 F Correction to QoS mapping between EPS and pre-Rel-8 8.3.0
8.4.0 2008-12 SP-42 SP-080823 0688 1 F QoS handling at HO from UTRAN/GERAN
8.3.0 8.4.0 2008-12 SP-42 SP-080823 0697 1 F Corrections to S‑GW and P‑GW
Information Storage 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0699 3 F Packet
Reordering in E-UTRAN for S1-HO and UTRAN Iu mode to E-UTRAN Inter-RAT
handover without S‑GW change 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0706 1 F
Corrections on APN-AMBR usage and storage 8.3.0 8.4.0 2008-12 SP-42 SP-080823
0707 2 F Sorting of PDP Contexts during inter-RAT handover 8.3.0 8.4.0 2008-12
SP-42 SP-080823 0710 2 F Combination of ME Identity Retrieval and NAS SMC
procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0711 1 F Clarification to EPS
Bearer Deactivation 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0714 3 F UE location
Info at P‑GW for LTE access. 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0715 1 F
Handling GBR PDP Context with MBR set to 0 from Gn/Gp SGSN to MME 8.3.0 8.4.0
2008-12 SP-42 SP-080823 0716 2 F Update Type on S6a in Attach procedure 8.3.0
8.4.0 2008-12 SP-42 SP-080823 0717 - F UE Reachability Request Parameter
Storage 8.3.0 8.4.0 2008-12 SP-42 SP-080823 0718 1 F S1 connection release in
the MME-initiated Detach procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080824 0720 -
F Cleanup on the UTRAN Iu mode to E-UTRAN Inter RAT handover 8.3.0 8.4.0
2008-12 SP-42 SP-080824 0721 2 F Re-arrangement of the Insert subscriber data
procedure 8.3.0 8.4.0 2008-12 SP-42 SP-080824 0723 1 F Correction of KSI
parameter handling 8.3.0 8.4.0 2008-12 SP-42 SP-080824 0724 1 F Correction of
Cancel Location in figure 8.3.0 8.4.0 2008-12 SP-42 SP-080824 0725 1 F Summery
of UE rules for ISR high level description 8.3.0 8.4.0 2008-12 SP-42 SP-080824
0729 1 F Charging Characteristics handling clarification 8.3.0 8.4.0 2008-12
SP-42 SP-080824 0730 2 F Mapping of QCI=3 8.3.0 8.4.0 2008-12 SP-42 SP-080824
0731 - F Correction to MME initiated Bearer Deactivation procedure 8.3.0 8.4.0
2008-12 - - - - - MCC Correction of missing row in Table 5.7.1-1 (deleted in
error when removing the status column (CR0679R1) and spell check. 8.4.0 8.4.1
2009-03 SP-43 SP-090114 0732 1 F Alignment of S3 to transfer EPS Bearers
instead of PDP contexts at IRAT handover 8.4.1 8.5.0 2009-03 SP-43 SP-090114
0733 1 F IRAT Handover procedures updated with references to security
specification 8.4.1 8.5.0 2009-03 SP-43 SP-090114 0734 1 F Error correction of
TAU procedure 8.4.1 8.5.0 2009-03 SP-43 SP-090114 0735 1 F Clarify text on
subscribed QoS 8.4.1 8.5.0 2009-03 SP-43 SP-090114 0739 2 F Refinement to the
procedures for storing PDN GW information in HSS 8.4.1 8.5.0 2009-03 SP-43
SP-090114 0740 2 F Handling Wild CARD APN in 3GPP Access 8.4.1 8.5.0 2009-03
SP-43 SP-090114 0741 1 F Alignment of Figure with the text of MME-HSS
interaction 8.4.1 8.5.0 2009-03 SP-43 SP-090114 0742 1 F Clarification of IPv6
prefix and interface identifier allocation to UE 8.4.1 8.5.0 2009-03 SP-43
SP-090114 0745 2 F Correction on the PDN type 8.4.1 8.5.0 2009-03 SP-43
SP-090114 0746 1 F Clarification on PDN GW selection function 8.4.1 8.5.0
2009-03 SP-43 SP-090114 0748 2 F Relation between EPS MM and CM state 8.4.1
8.5.0 2009-03 SP-43 SP-090114 0749 1 F Clarifications on APN Selection 8.4.1
8.5.0 2009-03 SP-43 SP-090114 0752 2 F Corrections about the UE location Info
reporting in detach procedure. 8.4.1 8.5.0 2009-03 SP-43 SP-090114 0754 2 F
Un-successful case clarification for X2 HO 8.4.1 8.5.0 2009-03 SP-43 SP-090114
0757 3 F Handling NAS Procedure at the MME 8.4.1 8.5.0 2009-03 SP-43 SP-090114
0758 1 F \'Bearers Requesting Data Forwarding List\' in inter-RAT handover
8.4.1 8.5.0 2009-03 SP-43 SP-090114 0759 2 F Prioritization of EPS Bearers and
PDP Contexts during TAU 8.4.1 8.5.0 2009-03 SP-43 SP-090114 0760 1 F Storage
of the IPv4 address in the MME 8.4.1 8.5.0 2009-03 SP-43 SP-090114 0761 2 F
M-PDN Detach Specification for 3GPP Accesses 8.4.1 8.5.0 2009-03 SP-43
SP-090115 0768 2 F Cause IE and Transparent Container IE Cleanup. 8.4.1 8.5.0
2009-03 SP-43 SP-090115 0770 1 F PDP Context to EPS Bearer mapping in MME
during Gn/Gp-SGSN to MME TAU. 8.4.1 8.5.0 2009-03 SP-43 SP-090115 0771 3 F
Correction of Routing Area Update procedures using S4 8.4.1 8.5.0 2009-03
SP-43 SP-090115 0772 - F Cleanup of definitions and abbreviations 8.4.1 8.5.0
2009-03 SP-43 SP-090115 0773 2 F UE capability handling at inter-RAT handover
8.4.1 8.5.0 2009-03 SP-43 SP-090115 0774 1 F NAS message/S1 procedure handling
during S1 interface handover 8.4.1 8.5.0 2009-03 SP-43 SP-090115 0775 1 F PCC
related update of bearer activation and modification procedure 8.4.1 8.5.0
2009-03 SP-43 SP-090115 0776 1 F Removal of editor\'s notes and FFS\' 8.4.1
8.5.0 2009-03 SP-43 SP-090115 0777 3 F Clarification on the UE identity
handling during Attach procedure 8.4.1 8.5.0 2009-03 SP-43 SP-090115 0778 3 F
Clarification of the additional P-TMSI/RAI 8.4.1 8.5.0 2009-03 SP-43 SP-090115
0779 3 F Establish all the Dedicated Bearers in combination with default
bearer in Handover Attach or Handover PDN connectivity 8.4.1 8.5.0 2009-03
SP-43 SP-090115 0780 2 F Clarification that PDN GW initiated bearer
modification procedure supports change of QCI 8.4.1 8.5.0 2009-03 SP-43
SP-090115 0781 1 D Editorial updates on MME control of overload clause 8.4.1
8.5.0 2009-03 SP-43 SP-090115 0793 1 F Remove TCP option from S6a and S13
8.4.1 8.5.0 2009-03 SP-43 SP-090115 0794 2 F Unconditional RAU at handover to
same RA; Impact to E-UTRAN handover procedures 8.4.1 8.5.0 2009-03 SP-43
SP-090115 0795 - F Clarification of reference in MME-Initiated Detach
procedure 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0796 1 F Mapping for non-GBR
PDP-contexts 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0798 4 F Alignment of UE
requested bearer resource modification procedure 8.4.1 8.5.0 2009-03 SP-43
SP-090116 0799 - F Clarification that dedicated bearers are per PDN connection
8.4.1 8.5.0 2009-03 SP-43 SP-090116 0803 2 F Data Forwarding Path between SGW
and S4-SGSN for IRAT HO from E-UTRAN to UTRAN Iu-mode 8.4.1 8.5.0 2009-03
SP-43 SP-090116 0806 1 F The synchronization of EPS security context during
the TAU procedure 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0808 1 F Prioritization
of EPS Bearers and PDP Contexts during TAU 8.4.1 8.5.0 2009-03 SP-43 SP-090116
0809 2 F Introducing Data Forwarding indication for inter RAT handover to
EUTRAN 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0812 2 F Clarification of
Subscribed PDN Type IPv4v6 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0816 2 F
Clarification of UE Validated Context Request message 8.4.1 8.5.0 2009-03
SP-43 SP-090116 0819 1 F Bearer Handling Correction in ECM-CONNECTED 8.4.1
8.5.0 2009-03 SP-43 SP-090116 0821 - F UE-AMBR Handling In UE or MME initiated
PDN Disconnect 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0824 - F Correction of IPv6
address allocation for GTP-based S5/S8 8.4.1 8.5.0 2009-03 SP-43 SP-090116
0833 1 F Location dependent charging 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0836
- F Core Network Classmark Handling 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0837 1
F RRC Connection Recovery by NAS 8.4.1 8.5.0 2009-03 SP-43 SP-090116 0843 1 F
Alignments related to NAS security handling 8.4.1 8.5.0 2009-06 SP-44
SP-090331 0790 3 F Correction of standalone Insert Subscriber Data procedure
8.5.0 8.6.0 2009-06 SP-44 SP-090331 0791 4 F Use and assignment of PTI 8.5.0
8.6.0 2009-06 SP-44 SP-090331 0838 2 F Warning system: accuracy of internal
clock 8.5.0 8.6.0 2009-06 SP-44 SP-090331 0840 2 F Additional GUTI in TAU
procedures 8.5.0 8.6.0 2009-06 SP-44 SP-090331 0841 2 F Corrections to ISR
description 8.5.0 8.6.0 2009-06 SP-44 SP-090331 0849 2 F Same Serving GW IP
Address and UP TEID for S1-u, S12 and S4 UP 8.5.0 8.6.0 2009-06 SP-44
SP-090332 0854 - F Some typo corrections in the handover procedures. 8.5.0
8.6.0 2009-06 SP-44 SP-090332 0855 2 F IPv6 prefix allocation corrections.
8.5.0 8.6.0 2009-06 SP-44 SP-090331 0862 2 F Clarification of the ISR
capability 8.5.0 8.6.0 2009-06 SP-44 SP-090331 0864 2 F GTPv2-C message
alignment in Section 5.3.5 8.5.0 8.6.0 2009-06 SP-44 SP-090331 0866 2 F
Clarification of the Security Mode Control procedure 8.5.0 8.6.0 2009-06 SP-44
SP-090332 0870 - F Clarification of the trigger of TAU in EMM-REGISTERED and
ECM-IDLE state 8.5.0 8.6.0 2009-06 SP-44 SP-090332 0876 3 F Clarification on
PDN Type 8.5.0 8.6.0 2009-06 SP-44 SP-090332 0879 3 F Charging identity and
characteristics for EPS 8.5.0 8.6.0 2009-06 SP-44 SP-090332 0886 1 F GTPv2
Message Name Alignment - Clauses 5.4 to 5.5.1 8.5.0 8.6.0 2009-06 SP-44
SP-090332 0888 4 F EPS Bearer Release function in the attach Procedure 8.5.0
8.6.0 2009-06 SP-44 SP-090332 0889 2 F Add the PDN Type to UE Context in
Information Storage clause 8.5.0 8.6.0 2009-06 SP-44 SP-090335 0894 2 F Adding
interaction with HSS/AAA in PDN GW initiated bearer deactivation procedure
8.5.0 8.6.0 2009-06 SP-44 SP-090333 0896 2 F PDN GW information Storage 8.5.0
8.6.0 2009-06 SP-44 SP-090335 0903 2 F Data Forwarding Path between RNC and
S4-SGSN 8.5.0 8.6.0 2009-06 SP-44 SP-090335 0911 2 F GTPv2 message name
alignment in clauses 5.5.2 and 5.10 8.5.0 8.6.0 2009-06 SP-44 SP-090333 0916 2
F Align E-UTRAN Initial Attach with GTPv2 message names 8.5.0 8.6.0 2009-06
SP-44 SP-090333 0917 2 F Align RAU procedures with GTPv2 message names 8.5.0
8.6.0 2009-06 SP-44 SP-090333 0918 2 F Align TAU procedures with GTPv2 message
names 8.5.0 8.6.0 2009-06 SP-44 SP-090333 0919 2 F Align UE triggered Service
Request procedure with GTPv2 message names 8.5.0 8.6.0 2009-06 SP-44 SP-090333
0931 2 F Alignement between Stage 3 and Stage 2 -- Section D 3.7 8.5.0 8.6.0
2009-06 SP-44 SP-090335 0932 3 F Alignement Stage 3 and 2 for section 5.3.8 --
Detach procedure 8.5.0 8.6.0 2009-06 SP-44 SP-090333 0933 2 F Alignement
between Stage 3 and Stage 2 -- Section D 3.8 8.5.0 8.6.0 2009-06 SP-44
SP-090334 0934 - F Removal of eMBMS from Rel 8 8.5.0 8.6.0 2009-06 SP-44
SP-090333 0937 2 F Removal of FFS from \"Packet Routing and Transfer
Function\" 8.5.0 8.6.0 2009-06 SP-44 SP-090334 0942 1 F Resolution of
editor\'s note in section 5.3.3.2 8.5.0 8.6.0 2009-06 SP-44 SP-090334 0946 3 F
Annex-D3.3 Message Alignment to Stage 3 8.5.0 8.6.0 2009-06 SP-44 SP-090334
0947 3 F Annex-D3.4 Message Alignment to Stage 3 8.5.0 8.6.0 2009-06 SP-44
SP-090335 0948 4 F Annex-D3.5 Message Alignment to Stage 3 8.5.0 8.6.0 2009-06
SP-44 SP-090335 0949 4 F Annex-D3.6 Message Alignment to Stage 3 8.5.0 8.6.0
2009-06 SP-44 SP-090334 0958 1 F Clarification on QoS of Default bearer 8.5.0
8.6.0 2009-06 SP-44 SP-090334 0963 2 F Handling of TFT 8.5.0 8.6.0 2009-06
SP-44 SP-090343 0966 1 F E-UTRAN to UTRAN handover clarification 8.5.0 8.6.0
2009-06 SP-44 SP-090334 0968 1 F Compatibility issues 8.5.0 8.6.0 2009-06
SP-44 SP-090334 0970 2 F Clarification of data forwarding during RAU/TAU 8.5.0
8.6.0 2009-06 SP-44 SP-090335 0972 3 F Clarification of data forwarding during
RAU/TAU with Gn/Gp SGSNs 8.5.0 8.6.0 2009-06 SP-44 SP-090334 0976 2 F UE
reachability procedure correction 8.5.0 8.6.0 2009-06 SP-44 SP-090336 0985 1 F
Annex F Correction of GTPv2 terminology 8.5.0 8.6.0 2009-06 SP-44 SP-090343
0987 1 F GERAN/UTRAN to E-UTRAN handover clarification 8.5.0 8.6.0 2009-06
SP-44 SP-090336 0996 4 F IMS voice Indication 8.5.0 8.6.0 2009-06 SP-44
SP-090336 1007 3 F Some corrections to the references. 8.5.0 8.6.0 2009-06
SP-44 SP-090336 1009 2 F APN-AMBR in GERAN/UTRAN 8.5.0 8.6.0 2009-06 SP-44
SP-090336 1013 - F \"Charging Characteritics\" receipt in P-GW in PMIP based
S5/S8 systems 8.5.0 8.6.0 2009-06 SP-44 SP-090336 1015 1 F Network Triggered
Service Request for UE in ECM-CONNECTED State 8.5.0 8.6.0 2009-06 SP-44
SP-090337 1018 1 F Clarification on PCC signalling during E-UTRAN attach 8.5.0
8.6.0 2009-06 SP-44 SP-090337 1020 2 F Correction of the PDN connectivity
procedure 8.5.0 8.6.0 2009-06 SP-44 SP-090337 1027 1 F NAS message not
optional in Delete Bearer Request Command to eNB 8.5.0 8.6.0 2009-06 SP-44
SP-090335 1029 4 F Handling of last PDN disconnection by PDN GW 8.5.0 8.6.0
2009-06 SP-44 SP-090337 1034 2 F Editorial correction in Detach and
Deactivation procedure 8.5.0 8.6.0 2009-06 SP-44 SP-090337 1043 2 F
Description of Configuration Transfer procedure 8.5.0 8.6.0 2009-06 SP-44
SP-090337 1047 1 F Correction the UE identity in the service request procedure
8.5.0 8.6.0 2009-06 SP-44 SP-090337 1069 1 F Add the missing parameter in
23.401 for R8 8.5.0 8.6.0 2009-06 SP-44 SP-090337 1074 2 F Change of
subscribed ARP affecting whole PDN connection 8.5.0 8.6.0 2009-06 SP-44
SP-090337 1076 1 F BCM support of E-UTRAN capabale UE 8.5.0 8.6.0 2009-06
SP-44 SP-090336 1085 2 F Correction to Attach Procedure for APN-AMBR Storage
in the UE 8.5.0 8.6.0 2009-09 SP-45 SP-090586 1092 2 F MME does not support CS
service on control of overload 8.6.0 8.7.0 2009-09 SP-45 SP-090580 1095 3 F
Clarification about Message ID, Serial Number and Message Content settings
8.6.0 8.7.0 2009-09 SP-45 SP-090584 1096 2 F ISR Snapshot (alignment with CT1)
and some other clarifications 8.6.0 8.7.0 2009-09 SP-45 SP-090586 1097 1 F No
unnecessary TFT updates 8.6.0 8.7.0 2009-09 SP-45 SP-090586 1098 - F Remove
Charging Id from S11 8.6.0 8.7.0 2009-09 SP-45 SP-090586 1100 - F Corrections
to information storage for MME and Serving GW 8.6.0 8.7.0 2009-09 SP-45
SP-090586 1112 - F The MME function clarification 8.6.0 8.7.0 2009-09 SP-45
SP-090586 1124 - F Correction to UE triggered Service Request procedure 8.6.0
8.7.0 2009-09 SP-45 SP-090587 1126 - F Clarification about resources release
allocated for indirect forwarding 8.6.0 8.7.0 2009-09 SP-45 SP-090587 1128 1 F
Corrections on the Load re-balancing between MMEs and MME control of overload.
8.6.0 8.7.0 2009-09 SP-45 SP-090587 1130 - F Remove the rejection notification
to the HSS when the UE is rejected. 8.6.0 8.7.0 2009-09 SP-45 SP-090587 1147 1
F Correction on architecture figure 8.6.0 8.7.0 2009-09 SP-45 SP-090587 1153 1
F Add missing parameters 8.6.0 8.7.0 2009-09 SP-45 SP-090587 1156 1 F
Alignment of APN OI Replacement Usage 8.6.0 8.7.0 2009-09 SP-45 SP-090594 1160
1 F Support of the Dual Address Bearer with PMIP 8.6.0 8.7.0 2009-09 SP-45
SP-090587 1162 2 F TAI to be conveyed between MMEs in handover 8.6.0 8.7.0
2009-09 SP-45 SP-090588 1171 7 F Remove un-necessary and un-relevant LAU from
ISR 8.6.0 8.7.0 2009-09 SP-45 SP-090588 1177 1 F Mapping of APN-AMBR to MBR by
UE 8.6.0 8.7.0 2009-09 SP-45 SP-090588 1181 - F Yet another correction for
data forwarding 8.6.0 8.7.0 2009-09 SP-45 SP-090588 1183 1 F Corrections for
wildcard APN 8.6.0 8.7.0 2009-09 SP-45 SP-090588 1185 2 F Fix misalignment of
QCI mapping for pre-Rel-8 QoS 8.6.0 8.7.0 2009-09 SP-45 SP-090588 1192 1 F
Warning system: accuracy of internal clock - update from SA3 8.6.0 8.7.0
2009-09 SP-45 SP-090589 1202 1 F Clarification on the condition for resource
release of other CN node during handover procedure 8.6.0 8.7.0 2009-09 SP-45
SP-090589 1210 - F ISR not locally deactivated during bearer establishment and
modification 8.6.0 8.7.0 2009-09 SP-45 SP-090589 1216 2 F Corrections about
iRAT handover procedures 8.6.0 8.7.0 2009-09 SP-45 SP-090592 1234 1 F Correct
Information Storage for MME 8.6.0 8.7.0 2009-09 SP-45 SP-090589 1247 1 F EPS
bearer preservation at S1 Release 8.6.0 8.7.0 2009-09 SP-45 SP-090584 1261 3 F
APN Restriction Transfer 8.6.0 8.7.0 2009-09 SP-45 SP-090589 1264 1 F
Clarification of TEIDs for data forwarding 8.6.0 8.7.0 2009-09 SP-45 SP-090589
1290 - F Missing PGW actions during UE requested bearer resource modification
procedure 8.6.0 8.7.0 2009-12 SP-46 SP-090780 1198 1 F MM context after TAU
Reject 8.7.0 8.8.0 2009-12 SP-46 SP-090783 1200 1 F Clarification on DRX
parameter handling 8.7.0 8.8.0 2009-12 SP-46 SP-090783 1212 1 F Attach type
correction 8.7.0 8.8.0 2009-12 SP-46 SP-090779 1218 2 F Clarification for
X2-based handover 8.7.0 8.8.0 2009-12 SP-46 SP-090779 1220 3 F Correction IRAT
handover procedure between GERAN A/Gb mode and E-UTRAN 8.7.0 8.8.0 2009-12
SP-46 SP-090784 1254 2 F Refactoring Security Parameters for Maintainability
8.7.0 8.8.0 2009-12 SP-46 SP-090784 1282 1 F Clean up some obsoleted Gtpv2 IEs
8.7.0 8.8.0 2009-12 SP-46 SP-090783 1300 1 F Correction of Data Forwarding
procedures 8.7.0 8.8.0 2009-12 SP-46 SP-090783 1301 1 F Correction to Message
granularity of GTPv2 messages 8.7.0 8.8.0 2009-12 SP-46 SP-090782 1307 - F
Network Triggered Service Request further clarification 8.7.0 8.8.0 2009-12
SP-46 SP-090779 1309 - F Removal of S-GW resources for indirect forwarding in
Inter RAT handover 8.7.0 8.8.0 2009-12 SP-46 SP-090780 1311 1 F Corrections on
the Load re-balancing between MMEs in TAU procedure 8.7.0 8.8.0 2009-12 SP-46
SP-090782 1317 - F Clarify the transfer of MS Info Change Reporting Action IE
between CN nodes 8.7.0 8.8.0 2009-12 SP-46 SP-090781 1328 1 F Mapping of APN-
AMBR to MBR by UE 8.7.0 8.8.0 2009-12 SP-46 SP-090770 1330 - F Correction to
S1 release procedure description 8.7.0 8.8.0 2009-12 SP-46 SP-090780 1338 1 F
Correction to the figure for Routing Area Update without S-GW change 8.7.0
8.8.0 2009-12 SP-46 SP-090784 1348 3 F On X2 based inter-PLMN HO 8.7.0 8.8.0
2009-12 SP-46 SP-090784 1352 - F Alignment in Detach procedure 8.7.0 8.8.0
2009-12 SP-46 SP-090780 1356 - F Correction of TAU procedure 8.7.0 8.8.0
2009-12 SP-46 SP-090779 1358 4 F Clarification of X2 handover procedure
failure 8.7.0 8.8.0 2009-12 SP-46 SP-090781 1360 1 F Removal QoS Negotiated in
the modify bearer request message 8.7.0 8.8.0 2009-12 SP-46 SP-090782 1362 - F
Correction on the UE requested PDN connectivity procedure 8.7.0 8.8.0 2009-12
SP-46 SP-090781 1369 1 F GBR bearer handling at eNodeB Failure 8.7.0 8.8.0
2009-12 SP-46 SP-090769 1371 1 F Data Coding Scheme for ETWS 8.7.0 8.8.0
2009-12 SP-46 SP-090782 1375 3 F Alignment of UE Radio capability handling
with RAN 2 decisions on UTRAN RAC handling 8.7.0 8.8.0 2009-12 SP-46 SP-090779
1377 - F Allocation of S-GW resources for indirect forwarding in Inter RAT
handover 8.7.0 8.8.0 2009-12 SP-46 SP-090783 1379 - F SCTP reference
correction 8.7.0 8.8.0 2009-12 SP-46 SP-090784 1405 1 F Determine the Maximum
APN restriction in PDN disconnection 8.7.0 8.8.0 2009-12 SP-46 SP-090784 1410
- F GWCN sharing for LTE 8.7.0 8.8.0 2009-12 SP-46 SP-090781 1413 2 F Add the
function of QoS mapping to the PGW 8.7.0 8.8.0 2009-12 SP-46 SP-090783 1426 2
F Correction to APN-OI Replacement handling to support interworking with pre
Rel-8 SGSN 8.7.0 8.8.0 2009-12 SP-46 SP-090779 1430 3 F Correction to APN-OI
handling an inter-access handovers 8.7.0 8.8.0 2009-12 SP-46 SP-090781 1440 2
F GBR bearer release when MME fail to page the UE 8.7.0 8.8.0 2009-12 SP-46
SP-090782 1444 1 F Alignment of UE Radio capability handling with GERAN
decisions 8.7.0 8.8.0 2010-03 SP-47 SP-100234 1448 3 F Procedure of
duplication detection mechanism in ETWS 8.8.0 8.9.0 2010-03 SP-47 SP-100132
1457 2 F ECGI/TAI information Reporting procedure 8.8.0 8.9.0 2010-03 SP-47
SP-100132 1459 2 F Inter RAT Handover Info handling during EUTRAN to GERAN HO
8.8.0 8.9.0 2010-03 SP-47 SP-100132 1466 1 F Corrections for X2 based handover
8.8.0 8.9.0 2010-03 SP-47 SP-100132 1477 3 F Correction in X2 Path Switch
Request Procedure 8.8.0 8.9.0 2010-03 SP-47 SP-100133 1492 1 F Clarification
on CS fallback handling during HO 8.8.0 8.9.0 2010-03 SP-47 SP-100135 1494 1 F
Removal of indirect uplink data forwarding from Inter RAT handovers 8.8.0
8.9.0 2010-03 SP-47 SP-100132 1502 6 F Clarification for inter-PLMN Handover
8.8.0 8.9.0 2010-03 SP-47 SP-100132 1507 3 F ISR deactivation in PDN GW
initiated bearer modification with bearer QoS update 8.8.0 8.9.0 2010-03 SP-47
SP-100132 1521 1 F Use of Handover Restriction List in X2 handover 8.8.0 8.9.0
2010-06 SP-48 SP-100314 1468 3 F Correction of Update Location request
signalling 8.9.0 8.10.0 2010-06 SP-48 SP-100313 1470 3 F Refactoring Security
Parameters for Maintainability 8.9.0 8.10.0 2010-06 SP-48 SP-100313 1487 2 F
IP CAN Session Modification procedure with RAT type changed in D.3.6 8.9.0
8.10.0 2010-06 SP-48 SP-100313 1516 2 F Correction to the pre- Rel‑8 QoS
mapping 8.9.0 8.10.0 2010-06 SP-48 SP-100313 1539 1 F Clarify the condition of
MME initiated QoS modification 8.9.0 8.10.0 2010-06 SP-48 SP-100313 1541 1 F
Clarification about the MME behaviour during the TAU procedure 8.9.0 8.10.0
2010-06 SP-48 SP-100313 1543 4 F Fix error on ISR deactivation in S1 HO with
MME relocation without S-GW change 8.9.0 8.10.0 2010-06 SP-48 SP-100313 1551 4
F TAU without MME change 8.9.0 8.10.0 2010-06 SP-48 SP-100314 1553 1 F Mapping
of EPS QoS to R\'99 QoS 8.9.0 8.10.0 2010-06 SP-48 SP-100314 1564 2 F
Correction of HSS update conditions 8.9.0 8.10.0 2010-06 SP-48 SP-100313 1566
- F EPS bearer context handling during the IRAT handover 8.9.0 8.10.0 2010-06
SP-48 SP-100314 1573 1 F The PDN disconnection during S1 HO procedure 8.9.0
8.10.0 2010-06 SP-48 SP-100314 1591 2 F Clarification of PDN GW initiated
modification in idle mode 8.9.0 8.10.0 2010-06 SP-48 SP-100314 1596 2 F ISR
maintain and deactivation during X2 HO 8.9.0 8.10.0 2010-06 SP-48 SP-100314
1627 1 F S1-based handover cancel 8.9.0 8.10.0 2010-09 SP-49 SP-100530 1667 1
F Correction of TAU procedure with ISR activation 8.10.0 8.11.0 2010-09 SP-49
SP-100530 1699 1 F Modifying and rejecting bearer level QoS parameter for
default bearer 8.10.0 8.11.0 2010-09 SP-49 SP-100530 1731 2 F Correction to
ISR indication during Context Req Procedure 8.10.0 8.11.0 2010-09 SP-49
SP-100534 1717 1 C Removal of unnecessary signaling from detach and PDN
disconnection procedures 8.10.0 8.11.0 2010-09 SP-49 SP-100534 1746 1 F
Setting of IMS voice over PS Session Supported Indication based on IMS roaming
agreements 8.10.0 8.11.0 2010-12 SP-50 SP-100672 1814 3 F Correction to the
PDN GW initiated QoS update 8.11.0 8.12.0 2011-03 SP-51 SP-110060 1949 1 F
Correction to authentication vectors forwarding between MME and SGSN 8.12.0
8.13.0 2011-03 SP-51 SP-110061 1975 - F Deletion of Notify Messages in PGW-
initiated Bearer Deactivation Procedure 8.12.0 8.13.0 2011-03 SP-51 SP-110061
1981 1 F Correction of Gn/Gp SGSN to MME Tracking Area Update procedure 8.12.0
8.13.0 2011-03 SP-51 SP-110060 2057 1 F Modifying and rejecting bearer level
QoS parameter QCI for default bearer 8.12.0 8.13.0 2011-06 SP-52 SP-110321
2122 1 F MME Behaviour when MS Network Capability is not included in
Attach/TAU 8.13.0 8.14.0 2011-12 SP-54 SP-110729 2195 2 F QoS mapping 8.14.0
8.15.0 2011-12 SP-54 SP-110764 2202 2 F Correction to UE warning message
indication with regards to \'digital signature\' and \'timestamp\' 8.14.0
8.15.0