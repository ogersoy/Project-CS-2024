# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
Machine to Machine (M2M) Communication is seen as a form of data communication
between entities that when deployed do not necessarily need human interaction.
One of the challenges with M2M communication is that deployed M2M equipments
are managed remotely without any direct human interaction with the device.
TR 22.868 presents a study on machine-to-machine (M2M) communication. The
purpose of the present study is to evaluate the feasibility of remotely
managed USIM/ISIM application solutions from a security point of view.
.
# 1 Scope
The present document studies how to make it possible for the network to
provision remote management of USIM/ISIM application in an M2M equipment in a
secure way in a 3GPP system. It is envisioned that a M2M equipment is
incorporated in a device that a) could be assembled by an equipment
manufacturer, or b) could be assembled by an OEM (original equipment
manufacturer) that includes the M2M equipment in the device. The M2M equipment
could be a device that is fully self-contained or a device with interfaces to
attach, for example, sensors and on-site service equipment.
The scope of this feasibility study is to study the remote management of
USIM/ISIM application when the USIM/ISIM application resides in the UICC and
when the USIM/ISIM application resides in the M2M equipment.
The scope of this study includes definition of a trust model for remote
management of USIM/ISIM application and security threats and security
requirements need to be identified.
Furthermore, this study would include the following items:
\- to investigate candidate security solutions that allow provisioning to take
place in a secure manner;
\- to investigate candidate signalling procedures for provisioning remote
management of USIM/ISIM application in a M2M equipment;
\- to identify what functionality of the current USIM/ISIM application has to
be covered by remote management of the USIM/ISIM application
\- to identify what other functionality that may need to be added due to the
new USIM/ISIM application provisioning method
> \- the study may identify principle requirements for protected storage and
> the execution environment (e.g. by collaborating with relevant working
> groups such as the OMTP Hardware group)
Editor\'s Note: Security concerns about downloading subscription credentials
on the UICC have been raised by GSMA SCaG with LS TD S3-080657. SA3 needs to
get more clarifications on the concerns from GSMA as requested by SA plenary
in LS TD S3-080659. TD S3-080657 and possible feedback to TD S3-080659 have to
be taken into consideration by SA3 while progressing this activity.
Editor\'s Note: Due to the SA plenary decision that USIM /USIM application
always resides on UICC term M2M USIM needs to be used instead of USIM /USIM
application in this TR for the cases when the USIM is not residing in the
UICC. This needs to be applied to the TR before presenting it to SA plenary.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 22.868: \"Study on Facilitating Machine to Machine\".
It is preferred that the reference to 21.905 be the first in the list.
# 3 Definitions, symbols and abbreviations
Delete from the above heading those words which are not applicable.
Subclause numbering depends on applicability and should be renumbered
accordingly.
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [x] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[x].
Definition format
**\ **: \.
**Example:** text used to clarify abstract rules by applying them literally.
**Trusted Environment**. The Trusted environment (TRE) with the M2ME provides
some hardware and software protection and separation for the provisioning,
storage, execution and management of MIDs. A TRE can be validated at any time
by an external agency that is authorised to do so.
**Manageable Identity** : a provisioned and managed module that is capable of
representing a certain identity claim. **A Manageable Identity** (MID) used in
the context of M2M equipment may consist of a security policy, a set of
credentials and files, a package of executable code that makes use of these
credentials and files.
**MID Credentials** : e.g. user identifiers, permanent cryptographic keys and
algorithm customisation parameters.
**MID Engine** : The executable part of a MID.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
Symbol format
\ \
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[x] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [x].
Abbreviation format
\ \
DdoS Distributed Denial of Service (attack)
MID Manageable Identity
MIDE MID Engine
MITM Man In The Middle (attack)
M2M Machine-to-Machine
M2ME M2M equipment
PS Provisioning Server or Provisioning Service, according to context
RAM Remote Application Management
RFM Remote File Management
TCG Trusted Computing Group
TRE Trusted environment
USIM Universal Subscriber Identity Module
ISIM IM Services Identity Module
# 4 General aspects and assumptions
Editor\'s note: This chapter provides background, overview, benefits and some
use cases and assumptions.
## 4.1 General security analysis
Editor\'s note: Possible threats and security requirements will be listed
here.
### 4.1.1 Use cases
SA1 has performed a study in TR 22.868 where they have identified a number of
use cases (cf. TR 22.868, clause 4.4 [2]) covering the most important user
requirements and also outlined some areas where they think improvements are
needed.
Use Case a: In-Car Communications Equipment
The user acquires a car that is provided with an in-car combined Sat-Nav and
mobile communications system, enabling use of voice, email services and
Internet multimedia access (e.g., on-line map download). This was fitted, e.g.
by the factory or by the dealer, without any knowledge of the new owner's
subscription to any networks. When the user first uses the equipment, he is
instructed by the MMI of the mobile equipment to use an available network to
register with his chosen home operator to obtain a subscription. This can be
done using a temporary connection to the PLMN of his chosen HO or that of the
VNO. Alternatively, connection to an available public or Enterprise WLAN
enables the user to access to the registration website of the chosen HO in
order to register for mobile network subscription or for a combined WLAN and
mobile subscription. After registration, the required network access
applications are downloaded to the in-car communications system. This includes
a USIM for mobile network access and an ISIM for Internet multimedia services
that involve an IMS. The user is informed of a successful registration.
Use Case b: Home Gateway and Personal Network
An ADSL subscriber acquires a home gateway for use on his home ADSL system. He
has already registered separately for the ADSL connection to his home. The
gateway incorporates Personal Network Management functionality to allow
several personal devices to communicate securely with external IP networks
including TISPAN NGNs. When the user plugs in the gateway, it communicates
with the HO's ADSL network which initiates an automatic registration procedure
for the gateway. The operator downloads a USIM application to the gateway
which enables it to connect securely to the HO's IP network using EAP-AKA. The
gateway also uses the USIM application to provide seed keys for establishing
an IPSec Security Association with the network. An ISIM application is also
downloaded to the gateway. This is used to provide secure IMS connectivity
using a variety of IMS identities which are used by the home devices on the
PN.
Use Case c: Personal Multi-Network Communications Device
The user acquires a personal communications device that allows mobile and WLAN
connectivity. The device could be e.g. a camera or camcorder with wide area
connectivity or e.g. a dual-network smartphone. When the user switches on the
device for the first time, he is instructed by its MMI to use an available
network to register with his chosen home operator to obtain a mobile or WLAN
or combined subscription for the device. This can be done using a temporary
connection to the mobile network of his chosen HO or that of the VNO.
Alternatively, connection to an available public or Enterprise WLAN enables
the user to access to the registration website(s) of the chosen operator(s).
After registration, the required network access applications are downloaded to
the in-car communications system. This could includes a USIM for mobile
network access, an ISIM for Internet multimedia services that involve an IMS
and possibly a further USIM for WLAN access (if the WLAN requires EAP-AKA).
The user is informed of a successful registration.
### 4.1.2 Identified issues and Initial Considerations
The following issues can be identified from the Use Cases above, and a number
of features are proposed that could be beneficial to study in order to solve
the identified problems.
**Issue 1: How to prevent theft of and tampering with subscription
credentials**
NOTE: many of the issues below relate to attacks that may be perpetrated
directly on a provisioned M2M equipment and attacks that may be perpetrated
against the remote provisioning and management process.
Editor's note: It has to be revisited whether the M2M equipment refers to the
wireless module or the module where the wireless module is attached to.
This issue includes the following threats, whereby an attacker:
  * copies the customer's credentials to a different piece of M2M > equipment with the intent of using it to make calls at the > customer's expense;
  * copies the customer's credentials to a different piece of M2M > equipment with the intent of masquerading as the customer when > enacting transactions, e.g. electronic payment, access to IT > systems, etc.;
  * modifies the credentials to those of another user, e.g. himself. > This would typically be performed on a piece of stolen M2M > equipment;
  * performs an unauthorised migration of the customer to another > operator's network by modifying the credentials to a set that > would apply to that customer on the other operator's network;
  * adds a set of credentials that are not authorised by the customer or > the home operator;
  * An attacker maliciously renders the customer's credentials unusable, > e.g. in an attack over an IP channel to the equipment;
  * Renders the credentials unusable due to exposure to environments > that might normally be encountered by the M2M equipment, for > example a magnetic or electrostatic field.
  * Copies the credentials so as to be able to determine the derived > ciphering and integrity keys used for traffic protection so as to > be able to eavesdrop upon and/or tamper with communications > between the M2M terminal and the network.
> In Use Cases 1, 2, and 3 of [2], SA1 has identified the problem of how to
> ensure that the M2M equipment is tamper resistant despite e.g. the
> removability of the UICC. To solve this problem it would be beneficial if
> either of the following were implemented:
>
> Option 1: if the UICC could be physically integrated into the M2M equipment
> in such a away as to make it infeasible to remove the UICC without rendering
> the UICC permanently unusable. The USIM application would then still run and
> be managed in a secured, non-removable execution environment which is tamper
> resistant.
>
> Option 2: if the USIM application could be integrated and embedded within
> the M2M equipment in a protected module (i.e. without a physical UICC). That
> protected module would thus provide for the USIM application a secured
> execution and storage environment which is tamper resistant in the M2M
> equipment. Such an environment requires counter-measures against logical
> attacks on the USIM/ISIM application, similar to counter-measures that are
> currently provided by a physical UICC.
>
> Option 3: if the USIM application is implemented on a removable UICC,
> appropriate actions could be specified/taken according to the specific use
> case considered, to discourage/invalidate the UICC removal (i.e. making the
> UICC removal unproductive or even counterproductive for the attacker).
> Moreover, for some Use Cases the unauthorized removal of the UICC may also
> be prevented/discouraged by physical means (to be implemented on the M2M
> equipment). For M2M module a new removable UICC Form Factor could be
> specified to fulfil new requirements coming from the M2M market (e.g. high
> temperatures, long life duration, vibrations, etc..)
Editor's note: It needs to be studied what is meant with secured environments.
Editor's note: Also other options are possible.
All options imply that even if someone is able to steal the M2M equipment,
they won't be able to tamper with or copy the subscription credentials from
the M2M equipment. It would be beneficial to study all these options.
**Issue 2: How to initially provision a new M2M equipment with a new USIM
application from an operator of customer choice**
If we assume that the UICC is physically integrated into the M2M equipment in
such a away as to make it infeasible to remove the UICC without rendering the
UICC permanently unusable, as per **option 1** above, there are the following
subcases:
a) The USIM application is provisioned to the UICC prior being physically
integrated into the M2M equipment. This implies that the customer of the M2M
equipment needs to select his Home Operator upon ordering the M2M equipment to
the supplier. The selection of HO by the customer of the M2M equipment is
straightforward (no new provisioning processes required).
b) The USIM application is provisioned to the UICC after being s physically
integrated into the M2M equipment. This allows the customer of the M2M
equipment to select his Home Operator while receiving the M2M equipment from
the supplier.
If we assume that the USIM application is integrated into the M2M equipment,
as per **option 2** above (i.e. not using a physical UICC), then new problems
arise, such as:
  * how can the customer of the M2M equipment select his chosen home operator after the M2M equipment has been delivered from the supplier?
  * how to remotely and securely provision the M2M equipment with a new USIM/ISIM application of his chosen home operator;
  * how the HO can ensure the trustworthiness of the M2M equipment
To solve these issues it would be very beneficial if it was possible to:
  * select the home operator of the customer's choice
  * obtain a secure IP connection to a network for the purpose of registration and provisioning
  * register on-line with the chosen home operator for obtaining a subscription to that operator's networks. This includes the possibility of linking the new equipment to an existing subscription.
  * verify credentials for the M2M equipment\'s trustworthiness as a receptor of such provisioning service before the HO allows provisioning of the M2M equipment to take place. The components to be verified for authenticity and/or integrity should include the secure module and the M2M equipment (\"the platform\"). Optionally the HO may choose to verify only the platform. Exactly when and under what circumstances such verification should take place is FFS
  * initially download a USIM/ISIM application of the customer choice into a new M2M equipment, over a secured channel; and
  * if this phase of initial download of a USIM/ISIM application, could take place after the M2M equipment has been delivered by the supplier to the customer; and
  * if the customer could deploy a large set of M2M equipments and associate them with one certain home operator. This could require batch registration and provisioning.
```{=html}
``` \- operate a secure process for on-line provisioning and management > that
provides at least authentication of origin, confidentiality, > data integrity
and anti-replay protection.
If we assume that the USIM application is implemented on a removable UICC, as
per **option 3** above, the selection of home operator by the customer of the
M2M equipment is implicit in the UICC chosen. This case is straightforward in
the sense that it does not imply new processes, logistics and distribution to
the chosen Operator. Hence it does not imply additional costs, nor new
provisioning processes, for the chosen HO. However, the process of choosing
the home operator may have additional impacts. Editor\'s Note: Additional
costs and processes of choosing the home operator are FFS.
Editor\'s Note: The issue of choosing the operator may be a separate issue
which seems valid for all the options.
**Issue 3: How to change subscription to a different operator**
Use Case 3 of [TR22.868] also describes the problem of when the M2M equipment-
customer needs to change the subscription due to change of power supplier, who
happens to have a contract with a different mobile operator.
For this specific issue, the following sub-cases need to be considered:
a) Authorized change of subscription. A subcase for this is authorization for
the change of the removable physical UICC
b) Unauthorized (i.e. fraudulent) change of subscription.
Editor's note: the relevance of Sub-case b) is FFS. It could make sense in
case of subsidising of M2M equipments (a customer might try to change operator
in contravention of the contract with the current operator, e.g. if the
equipment cost has been subsidised by the current operator in exchange for the
customer staying with that operator for a contracted period of time). However
equipment subsidising may not be a realistic practice for M2M when there is no
direct commercial relationship between the Operator and the consumer.
The usage of a removable UICC in the M2M equipment is conceptually
straightforward to enable change of subscription. However, there may be issues
with arranging the physical removal.
NOTE: With reference to the specific Use Case 3 of [2], the costs of replacing
the UICCs to the M2M equipments are at the expense of the "new comer" power
supplier that is willing to make business with new mobile operator. Also, how
to physically prevent, in an adequate and effective way, the unauthorized UICC
removal from the M2M equipment cannot be considered within the scope of 3GPP
(this is at the expense of the power supplier that is providing service to the
M2M equipments).
Identified issues and initial considerations:
  * another operator might try to migrate the current operator's customers, with or without the consent of the customers but without the consent of the current operator;
### 4.1.3 Assumptions
Editor's note: This section needs to be revisited when the issues in section
4.1.2 have been resolved.
#### 4.1.3.1 General
From the analysis above the following assumptions can be derived:
  * It should be possible to prevent theft of the subscription. The following options could be considered:
    * The physical UICC is integrated with the M2M equipment (i.e. the UICC is not physically removable from the M2M equipment); and
    * The USIM/ISIM application is embedded within the M2M equipment (without a UICC), which:
      * provides a secure execution environment,
      * provides a secure storage environment that protects secrets
      * prevents the loading of unauthorised software on the M2M equipment ("secure boot")
      * has some degree of physical protection against attack
      * is tamper resistant.
Editor\'s Note: It has to be further studied whether this requirement can be
relaxed.
  * may provide a means of detection and reporting (to a TBD network entity) of evidence of tampering on the USIM/ISIM functionality or the secure environment (SE) within the M2M equipment that provides such functionality
  * meets relevant requirements from [OMTP TR0], [GSMA/EICTA Principles concerning handset theft] and other relevant industry standards on prevention against attack.
```{=html}
``` \- Physically removable UICC
```{=html}
``` \- It should be possible for the mobile operator to verify the secure
execution environment prior to provisioning of the downloadable USIM
application.
```{=html}
``` \- It should be possible to securely initially provision a new USIM
application to the M2M equipment
Editor's note: What part of the USIM application that is downloaded is FFS.
  * It should be possible to securely change the subscription in the M2M equipment remotely.
#### 4.1.3.2 Security Assurance for USIM application integrated into M2M
terminal
Traditionally USIM applications have been required to be instantiated within a
removable UICC. Operators buy and own the UICCs of their subscribers and can
therefore impose their own requirements on their UICC suppliers. Apart from
the occasional security failing (e.g. the weak COMP-128 algorithm) this model
has served operators well and it is to be expected that there will be some
concern at the suggestion that the USIM application could be integrated into
the M2M equipment itself (an M2M equipment that will not be owned by the
operator) instead of in a UICC. One of the major concerns that operators have
with the USIM application being integrated into the M2M terminal (with "an
integrated USIM") is that the integrated USIM will not be as robust as a USIM
within a UICC. Operators also have concerns for reasons other than security
and these reasons must also be taken into account.
This sub-section examines methods whereby operators could be given assurances
that integrated USIMs are indeed sufficiently robust.
The methods by which operators are given assurance about the robustness of
their UICCs is first examined. The following points can be made:
  1. Security assurances are gained because the operator chooses their UICC supplier and can therefore choose a supplier that meets the operator's security requirements. Since operator revenues will suffer if the UICC security is broken, the operator has an incentive to choose a reputable and competent supplier.
  2. If the supplier turns out not to be reputable and competent, the operator can move, with a certain delay, to an alternative supplier.
  3. Further, the operator may choose to have a very small number of UICC suppliers and can therefore spend a reasonable amount of time auditing each supplier, or alternatively requiring the supplier to get themselves audited against an agreed standard, such as the GSMA Smartcard Supplier Accreditation System.
  4. Finally, UICC suppliers generally release new products at a lower rate than terminal suppliers and have a smaller range of platforms on which UICCs are built than most terminal suppliers. There is therefore a relatively small range of UICCs and UICC platforms and again this gives the operator the chance to spend some time examining each candidate
  5. [Further, the UICC is a system with relatively limited complexity when compared with MEs. Therefore, it can be assessed for security and robustness with less effort than that which would be required for an M2ME. Even though UICCs are growing more complex, they are likely to remain less complex than an ME).]{.underline}
There seem to be two forces at work here:
a. Market forces, in that operators have an incentive to choose good UICC
suppliers or their revenues will suffer, and that operators can reasonably
easily change bad UICC suppliers, and UICC suppliers therefore have an
incentive to produce robust UICCs or they will not be chosen by operators
b. The opportunity for due diligence (because of the relatively small number
of UICC platforms) and audit, which operators may choose to carry out
themselves (because of the relatively small number of UICC suppliers), or
require their suppliers to get themselves audited to
It might be thought that these two methods do not give operators assurance if
the USIM application is integrated into the terminal, for the following
reasons:
  * The operator does not own the M2M terminal and cannot therefore impose their own security requirements on the M2M terminal supplier
  * As the operator does not own the M2M terminal, operator market forces cannot be used to safeguard standards of security
  * There are more terminal suppliers than smartcard suppliers, and terminal suppliers typically have more frequent update of products and platforms that smartcard supplies do. There is therefore too large a range for the operator, or any entity, to carry out sufficient due diligence on the terminal suppliers or their products and platforms.
However, the following points can be made in response:
  1. Although the operator may not be the final owner of an M2M terminal with an integrated USIM, the operator may choose to use their expertise in terminal sourcing on behalf of final owners and so be a distributor of such terminals, i.e. buy these terminals themselves and then sell onto the final owners in the same way that many operators today are distributors of consumer terminals. Operator market forces can in this way be brought to bear on the M2M terminal market.
a. However, it should be noted that the UICC is primarily a security device,
and security can be a very significant factor in purchasing decisions. The M2M
terminal is not primarily a security device and security cannot therefore be
such a significant factor.
b. Further, operators will not be the only purchasers of M2M terminals. There
may be some very significant non-operator purchasers of M2M terminals such as
those within the automotive industry. Operator market forces may not in
reality be that significant.
c. Finally, its clear that the operator is no longer in sole control of the
security of their USIM applications via direct relationship with their UICC
providers, and that the operator is now dependent on other entities, including
other operators, equipment suppliers and possibly certification agencies.
  2. Although the operator may not be the owner of the entire M2M terminal, it may become a sole 'owner' of certain functionality (an "operator compartment") -- such as one that manages and performs integrated USIM functionality - of the M2M terminal, by use of available technologies (e.g. the trusted mobile platform technology from TCG [see e.g. the Mobile Reference Architecture and Mobile Trusted Module specifications at https://www.trustedcomputinggroup.org/specs/mobilephone/ and the Global Platform Device Application Security Management, at http://www.globalplatform.org/specificationsdevice.asp). The operator who has ownership of the integrated USIM functionality can exclude interfering actions on it by any other stakeholder of the M2M terminal.
a. However, the feasibility of operator controlled M2ME functionality is yet
be studied or proven if the M2ME has to support multiple operator compartments
or if transfer of control of an operator compartment from one operator to
another is required.
  3. There are technologies (such as those described within TCG specifications) available that enable the operator to audit the trustworthiness (e.g. authenticity and integrity) of software responsible for all or selected functionality (such as the application and USIM security functionality) in a remotely located terminal during the time of its deployment. Use of such technologies can increase the operational trustworthiness of the M2M terminal.
  4. Although the present number of consumer terminal suppliers is more than the number of smartcard suppliers, M2M terminals may be a niche market with fewer suppliers.
  5. Further, although the number of consumer terminal suppliers is relatively large, the number of terminal hardware suppliers is actually quite small, and this is also likely to be the case for M2M terminals. If the architecture of M2M terminals with integrated USIMs is designed so that the security of the integrated USIM application mainly or totally depends on certain isolated portions of the terminal hardware, e.g. a hardware-embodied Trusted Environment (TrE) within such terminals, then this further reduces the number of entities that an operator or other relying party needs to conduct very detailed due diligence upon (though the requirement to still audit the final terminal supplier is admitted),
  6. Requirements for terminal supplier audit can be used (as they often are on smartcard suppliers) as can requirements on the robustness of the terminal implementation, in the following way:
a. The M2M terminal, and especially the TrE within such a terminal, can be
required to authenticate itself (as Alternative 4) requires), e.g. by means of
a public key certificate. There could be a central body overseeing issuance of
such certificates (though not perhaps issuing them itself) and imposing
requirements on terminal suppliers or the suppliers of TrEs, if the TrE is a
physically discrete component.
b. Operators or other USIM-issuing entities could be required to refuse to
issue USIM applications into terminals that do not have a certificate from the
PKI of this overseeing central body.
c. The requirements imposed by the central body could include the terminal
supplier (and TrE supplier, if applicable) having successfully passed an audit
on their processes.
d. These requirements could also include security requirements on the
robustness of the terminal implementation that the terminal supplier self-
certifies to ("robustness rules"). If it is found that M2M terminals from a
supplier do not in fact meet the security requirements, then measures could be
imposed on the terminal supplier in order to ensure corrections are made as
soon as possible.
e. However, it\'s not clear which entity would take on this central role nor
what the infrastructure requirements would be. The cost of running this
infrastructure may result in the overall cost of the integrated M2M-USIM
option being greater than the cost of using UICCs. There may be difficult
legal issues.
By these means it seems that the power of market forces and of audit and due
diligence, the chief means by which security standards are upheld for
smartcard suppliers, can also be used with respect to suppliers of M2M
terminals.
## 4.2 Other assumptions
The following additional assumptions about the operation of the M2M equipment
are made:
  * The USIM/ISIM (whether on a separate UICC or integrated into the M2M equipment) may support a number of lifecycle states (e.g. installed but not activated, activated, suspended)
  * It may be possible to securely update the software and firmware of the M2M equipment OTA
  * For M2M equipment with an integrated USIM/ISIM application, its expected that:
    * There will be mechanisms to prevent the unauthorised replacement of one operator's USIM/ISIM application with another operator's USIM/ISIM application
    * There will be mechanisms to prevent the download of software that would interfere with the operation of the integrated USIM/ISIM application
    * Appropriate software isolation will be enforced, e.g. between the secure environment and the main processing environment of the M2M equipment, and possibly within the secure environment itself
    * There may be the opportunity for an operator who has downloaded a USIM/ISIM application to the M2M equipment to configure some aspects of the security policy of the M2M equipment
    * It may be possible for the integrated USIM/ISIM application to be updated OTA
# 5 Architectural alternatives
Editor\'s note: This chapter describes the architectural alternatives when the
USIM/ISIM application resides on the M2M equipment or on the UICC. Also
network aspects shall be taken into account.
## 5.1 M2M equipment architecture alternatives
Editor\'s note: This chapter describes the different architecture alternatives
for the M2M equipment when the USIM/ISIM application resides on the M2M
equipment or on the UICC. This includes architecture for provisioning, remote
management and operation.
### 5.1.1 Equipment Architecture Alternative 1
#### 5.1.1.1 Trusted Environment (TRE)
##### 5.1.1.1.1 General Functions of the TRE
Editor\'s Note: Concrete examples should be added to this section.
Editor\'s Note: It is ffs whether all these functions are needed for the
purposes of the TR.
The TRE should be a logically separate area in the M2M equipment with hardware
support for this separation. It is not necessarily a removable module, i.e. it
can be functions within an IC or functions that are distributed across a group
of Ics. The TRE should define logical and physical interfaces to the outside
world. These are usable only under control of an entity which is authorised to
communicate directly with the TRE.
The TRE should provide a root of trust for the secure storage and secure
execution environment for multiple MIDs and for certain functions concerned
with the provisioning and management of MIDs.
The TRE should be pre-provisioned in a secure, out-of-band facility with any
required cryptographic keys and other credentials. Other security-critical
functions of the TRE are also typically pre-provisioned onto the M2ME in the
same way. Other functions are typically provisioned by download after the M2ME
is issued.
Editor\'s Note: the definition of which TRE functions may be downloaded after
issue of the M2ME is FFS, if it is deemed within the scope of 3GPP to define
that.
The TRE should provide a degree of protection against physical and logical
attacks.
Editor\'s Note: the degree of assurance to be supported is FFS.
The TRE should support and enforce its own security policy
The TRE should be sufficiently secure as to allow the storage and execution of
MIDs that are currently implemented only in UICCs or other smart card
platforms.
The TRE should have interfaces to parts of the M2M equipment that are outside
the TRE.
The TRE should haveits own embedded, unique identity that is typically
associated with the identity of the M2ME platform that, where used, is also
embedded in the TRE. The TRE should be capable of securely authenticating
those identities to the issuing authorities using standardised protocols. The
issuing authorities can validate the TRE\'s identity as being that of a valid,
issued, TRE and M2ME. Those identities are embedded as part of a physically
secure, out-of-band process that takes place before the M2ME is issued.
The TRE should be able to perform user authentication and access control for
single or multiple users, where relevant to the use case for that type of
M2ME.
The TRE should provide a secure audit record of its transactions. Records
would typically be protected against unauthorised access.
The TRE should be able to be updated remotely by an authorised entity using
standardised secure protocols.
The TRE could be either implemented in a standalone or embedded UICC with
certain enhanced functionality, or alternatively as an integrated solution on
the M2ME utilizing HW and SW components provided by the M2ME.
  * If the TRE is implemented in an enhanced UICC, such TRE should still support downloading and remote provisioning and management of the MID and the MIDE within the TRE.
  * If the TRE is implemented as an integrated solution in the M2ME, the M2ME should support integrity check of the SW that make up the TRE code base. Coverage of such SW checks should be full. TRE SW should be checked at least once at boot-time of the M2ME. Checks of the SW could also be conducted more frequently, e.g., during runtime but as a background processes, or during dormancy periods when the M2ME keeps non-essential functions off to save power, or prior to any operation which relies upon the integrity of the TRE.
Future enhancements that can be considered for the TRE include support for
multiple isolated, trusted domains, each owned by a stakeholder-owner, within
the TRE. Such domains could be completely isolated from each other, or be
isolated against tampering and unauthorized access but could provide inter-
domain services. If such domains could provide services to each other, the TRE
and its composite domains may also provide inter-domain authentication and/or
attestation functionality.
##### 5.1.1.1.2 TRE Functions Related to the Management of MIDs
Editor\'s note: It is ffs whether functions of this complexity are needed for
the purposes of the TR.
The TRE should have interfaces to the world external to the M2ME for the
remote provisioning and lifecycle management of MIDs.
The TRE should allow MIDs to share MIDE functions, e.g. cryptographic
algorithms, but only where authorised by the security policies of the
respective MIDs and only where the MIDs have been activated.
The TRE should supervise the transition of MIDs though their various lifecycle
stages.
The TRE should maintain a registry of the MIDs that it manages, including
information about their current lifecycle and security status.
The TRE should be able to support and enforce the security policies of MIDs.
The TRE should support user authentication services, where required by MIDs.
##### 5.1.1.1.3 TRE Functions Related to the Remote Provisioning of MIDs
The TRE should be deemed as being sufficiently secure as to permit the on-line
provisioning of MIDs whose security is currently assured by provisioning them
out-of-band onto UICCs.
A provisioning protocol is used to transport MIDs from a Provisioning Sever
(PS) in the network to the M2ME. The TRE should supervise this process and
controls the security aspects of it.
The provisioning function is also used for de-provisioning and/or updating
MIDs, to support the complete MID lifecycle management process. Updates can
either be pushed to, or pulled from, the PS to the M2ME. The protocol should
enable the M2ME to verify that management instructions come from a valid
source.
The provisioning function ensures that MIDs are delivered only to the correct
and authentic M2Mes. The PS checks that the M2ME is the legitimate end-point
for a set of MIDs. MID credentials are typically created during a registration
phase where the user signs up for a service. The MIDs can only be successfully
provisioned to the M2ME that acts on behalf of the user who registered for the
service in the first place. This implies that phases of the secure session
between TRE and PS are bound to each other by some identifier. For instance,
Liberty Alliance protocols separate the registration process from the actual
provisioning process but bind them together with security tokens and
identifiers.
The provisioning process is defined so that it allows re-provisioning of
USIM/ISIM credentials and applications for new operator(s) or service
provider(s) while using connectivity services offered by an existing operator
or service provider.
Editor\'s Note: It has to be considered if this is the correct place of the
function and if other options needs to be added.
The PS can remotely question the system state of the M2ME, to ensure that MIDs
will be stored only in a valid M2ME. This process may require explicit
validation of the TRE and also possibly the M2ME platform, before the
provisioning of MIDs can proceed. The TRE's security policy may apply further
conditions by specifying which provisioning-related events are permitted to
drive a M2ME/TRE authentication.
Editor\'s Note: methods for remotely validating the TRE are FFS.
## 5.2 Network architecture alternatives
Editor\'s note: This chapter describes the different network architecture
alternatives. This includes architecture for provisioning, remote management
and operation.
### 5.2.1 General
When analyzing the use cases in [TR 22.868], a beneficial function would be to
support initial network provisioning of a USIM application to the M2M
equipment.
Editor\'s Note: what parts of the USIM/ISIM application that is provisioned to
the M2M-enabled equipments is FFS.
NOTE: For simplicity the term 'USIM/ISIM application' is used, which shall not
be interpreted as a complete USIM/ISIM application as standardized today.
### 5.2.2 Alternative 1 Architecture with Registration Operator
#### 5.2.2.1 General
SA1 TR 22.868 [2] has identified possible obstacles for M2M business in mobile
networks. One of the obstacles for M2M business in mobile networks in [2] is
subscription handling. E.g. the following issues can be identified:
> \- With the current model the operator needs to be chosen (and consequently
> UICCs need to be installed) before the M2M equipments are deployed in the
> field. Installing UICCs in the field would be costly, especially for large
> numbers of terminals. This introduces inflexibility to the M2M deployment
> process.
>
> \- Changing UICC (i.e. subscription) would involve costly physical
> maintenance work on all machines in the field, especially for large numbers
> of terminals
>
> \- Changing UICC (i.e. subscription) may be non-trivial physically as the
> UICC needs to be carefully protected against tampering or stealing since a
> M2M equipment is usually unattended.
NOTE: TR 22.868 does not challenge the use of UICC.
The possibility to remotely provision (i.e. download) and manage subscriptions
(i.e. USIM/ISIM applications) would be an important enabler for M2M business
to take off in mobile networks.
The objective of Alternative 1 is to achieve a state where the M2M equipment
is ready to operate in a mobile network using the USIM/ISIM application of
customer\'s choice. To achieve this, it is seen that the following three
issues need to be solved:
> **Initial connectivity:** When the M2M equipment is turned on for the first
> time in the field, it needs to be solved how the M2M equipment gets initial
> network connectivity when a USIM of intended new home operator is not yet
> downloaded to the M2M equipment.
>
> **Discovery of the intended new home operator:** When the M2M equipment has
> established (initial) network connectivity, the M2M equipment needs to
> discover the intended new home operator for enabling the download of the
> USIM/ISIM application.
>
> **Secure download of USIM/ISIM application** : When the intended new home
> operator has been found, the USIM/ISIM application needs to be downloaded
> and activated in a secure way.
Alternative 1 provides an architecture for download and management of
USIM/ISIM applications which uses _Registration Operator_ and _preliminary
credentials_.
Five steps are identified in this approach to solve the three issues listed
above:
1) Manufacture credential installation phase
2) M2M equipment subscription registration
3) Initial network connectivity and IP connectivity
4) Discovery of new home operator
5) Provisioning of the USIM application
**[Step 1: Manufacture credential installation phase]{.underline}**
In order to have initial access to 3GPP access networks, the M2ME needs to
have suitable credentials available. As the credentials relating to the
intended new home operator are not yet available, the M2ME needs to be pre-
configured with preliminary connectivity credentials called the preliminary
IMSI (PIMSI) and a preliminary key Kp. These credentials are owned by the
Registration Operator and they not associated to the Selected Home Operator.
In addition, the M2ME needs to be pre-configured with provisioning credentials
(e.g. public/private key pair with certificates) which are used for securing
the USIM/ISIM provisioning process. Additionally, an address of the
Registration Operator may be pre-configured.
**[Step 2: M2M equipment subscription registration]{.underline}**
This step includes two registrations. First the customer purchases the M2MEs.
It is important to note that at this point the customer does not need to know
the future operator. Later in time the customer selects the Selected Home
Operator of his choice. The customer then registers all the M2ME(s) with the
Selected Home Operator. The Selected Home Operator passes information on the
registered M2ME(s) to Registration Operator who associates the M2M(s) to the
Selected Home Operator.
**[Step 3: Initial network connectivity and IP connectivity]{.underline}**
When the M2ME is turned on, it uses the standard GSM/UMTS/EPS procedures to
attach to any visited operator that accepts the PIMSI. The M2ME will use the
preliminary connectivity credentials for authentication to the Registration
Operator via the visited network and to get IP connectivity.
**[Step 4: Discovery of new home operator]{.underline}**
After reaching initial connectivity the M2ME does not yet have information on
the Selected Home Operator. Therefore the M2ME contacts the Registration
Operator which at this point can be regarded it \"temporary home operator\".
The Registration operator has information on the Selected Home Operator (from
step 2) and it redirects the M2ME to contact the Selected Home Operator.
**[Step 5: Provisioning of the USIM/ISIM application]{.underline}**
The USIM/ISIM application/data/credentials to be downloaded to the M2ME have
been prepared by the Selected Home Operator. The USIM application is
downloaded securely to the M2ME using the provisioning credentials. The
trustworthiness of the M2ME is verified. The new USIM application will be
activated, and the M2ME is ready to operate. Editor\'s Note. The editor\'s
note in the scope section about the LS from GSMA may have an impact to step 3
and 5.
####
Editor's note: The following concerns were raised against alternative 1 in the
email discussion held:
Raised concerns:
1) Provisioning of the credentials by the Registration Service may be a
nightmare.
2) The operating procedures for the exchange of credentials between the Owner,
Registration service and the operator need to be defined. This will be a vital
part of this operation. Not sure how this can be addressed in SA3, perhaps
there needs to some involvement by GSMA SG in this area?
3) When receiving a request from M2M equipment for USIM download, how does the
Selected Home Operator know that the USIM download is allowed for this
specific M2M equipment?
4) What is the relationship between the Selected Home Operator and the
Registration Service?
5) Is it within the scope of the GSMA to operate Registration Service?
6) This alternative assumes that the USIM/ISIM application resides on the M2M
equipment rather than on a UICC. This is a major departure from the well
accepted UICC-based security model used in 3GPP systems. It is far from clear
that 3GPP is ready to accept a move away from UICC-based solutions.
7) This alternative makes assumptions about the service requirements that
should be addressed by the security solution (e.g. ability to download USIM
application over the air, etc.). It is important to note that SA1 has not yet
agreed any service requirements for M2M applications.
8) The alternative assumes that both the registration of the mobile phone to
the Home Network via the Registration Service, as well as provisioning of the
USIM application and credentials onto the phone by the Home Network will take
place without verification of either the trustworthiness or authenticity of
the security environments (e.g. UICC, or other hardware/software security
devices or environments) on the phone nor the authenticity of the credentials
held in such secure environments.
9) The alternative assumes that the entity that provisions the downloadable
USIM applications and credentials are identical to the selected home network,
thereby limiting the flexibility whereby such an entity can be a third-party
Provisioning Service provider affilitiated with, but independent from, the
home network operator.
10) The alternative assumes that the registration and USIM provisioning
processes will be conducted whereby the communication between the mobile phone
and the various entities involved in these processes will not be protected for
privacy or integrity. Since these two processes, especially the USIM
provisioning deals with highly sensitive data, there needs to be measures to
protect such communication.
11) The download of initial authentication vectors for the P-IMSI, for
temporary network access, may not be optimal. It only serves to authenticate
the P-IMSI for the purpose of temporary network access until USIM parameters
can be download from the Selected Home Operator (SHO). In order to do this
though, it seems to require about as much temporary network access as is
eventually required with the SHO! Also, unless this authentication of the
P-IMSI is also used to authenticate the UE for the purposes of hosting the
device, that UE authentication must also later be performed. However, a
symmetric protocol is not optimal for UE authentication, as it requires the
secure maintenance of a large database of keys on the network side, when this
would not be required if an asymmetric UE authentication method were used.
12) The architecture assumes that it is not known at manufacture of the M2M
terminal who the Selected Home Operator will be. The architecture should allow
for this fact to be known and taken account of by the manufacturer.
13) Exactly which problem is solved by the Registration Service?
> We believe it is useful to consider the requirements below so as to enable
> flexibility and modularity in the solutions. In this way, different modules
> of a solution could address different requirements, if appropriate.
>
> A) Avoid the cost of subscriptions and SIMs "going live" a long time before
> the M2M device is activated and the subscription is used, or
>
> B) Avoid the need to make a decision for a particular mobile operator at
> manufacturing time, or
>
> C) Avoid the need to insert a SIM in the M2M device when it is being
> deployed, or
>
> D) Enable the owner of the M2M device to change from one operator to another
> one without having to handle a SIM while the M2M device is in the field?
14) It should be made clear which functions in alternative 1 are required for
enabling connectivity and which are required for enabling remote USIM
management.\"
15) Placement of Registration Service: If registration service is one entity,
then all parties have to accept the Registration Service and the interface
type. The involved parties would not only be all operators (also those that
just forward, i.e. visited operator), but also all the manufacturers of
various \"machines\" e.g. cars, parcel companies, etc.
16) Placement of Registration Service: If registration service is one entity,
there are some control issues. The registration service would have most likely
have a direct interface with HSS and be able to trigger changes of data there.
Who is trusted enough to run such a service? On the political side, which
country would exercise its legal control over the registration service?
17) Placement of Registration Service: If the registration service is one
entity, Denial of Service or accidental downtime are having a large business
impact.
18) Placement of Registration Service: If a distributed entity, then the
manufacturers and visited network have to find out, which registration service
is applicable. This may be solved, if one of them hosts the registration
service or there is some sort of identity for this. But the issue remains that
all manufacturers and visited networks would have to trust all registration
services.
19) Placement of Registration Service: Would the registration service be aware
of the supported algorithms and hence indirectly or directly be aware what
algorithms the operators support? In our view, authentication and key
derivation algorithms should be standardised for M2M.
20) Scalability: Many machines may be sold in areas where the service is not
available, this means, if the manufacturer registers at manufacturing time ALL
his machines, then there will be a lot of \"dead data\" in the registration
service. To avoid this the registration service may delete old data if not
used, but how should it know, if the machine is just waiting on a shelf in a
shop to be sold or if it has been shipped to far-far-away country.
21) Scalability: The amount of potential interfaces may be an issue since
there are many manufacturers and operators that would need a "pipe" to the
registration service. This could result in load problems, also all interfaces
would need to be tested and validated (like today's roaming interfaces). If
the applications include metering, tracking and tracing and pay as you drive,
one should consider how many valuable parcels, cars, containers, laptops,
metering devices there are, then this could really be a scalability issue.
(Synchronised time of activation, amount of devices vs. central registration
service, identification of devices)
22) The manufacturers may need to change their manufacturing process to enable
\"personalization\" at the manufacturing time so that the data for the
registration can be send to the registration service. (Cf. the need to ship
SIMlock related data from manufacturer to operator today)
23) Can the machine also unregister (and potentially register again) using the
registration service? (e.g. car is sold or parcel is delivered to a user)
24) Concerns have been raised towards the idea of a non-smartcard based
solution. In particular a software only based "soft-(U)SIM" seems like a very
risky concept. There are two main reasons for the scepticism about a non-
smartcard based solution:\ \- Scepticism about the actual attainable security
of non-smartcard solutions\ \- From a security managements perspective the
introduction of non-smartcard based solutions seems to increase the overall
complexity of the security architecture.\ New non-smartcard solutions will
probably require new operational policies etc. There is added cost to this and
there also seems to be an increased security risk.
#### 5.2.2.2 Roles
This section discusses the different roles in network architecture alternative
1.
**[Registration operator:]{.underline}**
This is a role that enables the after-purchase discovery of the Selected Home
Operator, i.e. the M2ME accesses a Registration Operator to discover its
Selected Home Operator. There can be one or more registration operators
offering this discovery service. Any mobile operator can play this role.
The Registration Operator supports the following functions:
  * providing preliminary credentials to the Equipment Supplier to allow installing the preliminary credentials to M2ME;
  * providing initial network connectivity to the M2ME via the Visited Operator using the preliminary credentials for authentication of the M2ME(s); . The Registration Operator needs to have a roaming agreement with the Visited Operator;\ association of the M2M equipment(s) with a Selected Home operator when requested by the Selected Home Operator;
  * providing the address of the selected Home Operator to the M2ME, if it has been successfully authenticated at initial attach.
NOTE: A mobile operator may play both roles as Visited- and Registration
Operator thus allowing to retain the M2ME attached to its network right after
USIM provisioning, providing access to normal operations.
**[Selected Home operator:]{.underline}**
The Selected Home operator supports the following functions:
  * allow registration of M2ME(s) by the owner of the M2ME;
  * registration of M2ME(s) at the Registration Operator;
  * perform the provisioning of the USIM application/ parameters to the M2ME;
  * attestation of the device with the help of the Attestation Authority.
**[Equipment Supplier of the M2ME:]{.underline}**
The Equipment Supplier supports the following functions:
  * pre-configuration of the M2ME(s) prior to delivery to the customer with preliminary credentials received from the Registration Operator in order to allow temporary initial 3GPP network access;
  * pre-configuration of the M2ME(s) prior to delivery to the customer with platform validation credentials received from the Platform Validation Authority in order to allow the Selected Home Operator to validate the platform of the M2ME;
  * provide the M2ME(s) and their identities to the Device Owner.
**[Device Owner:]{.underline}**
The Device Owner (the owner of the M2ME) supports the following functions:
  * purchasing M2ME(s) from the Equipment Supplier;
  * choosing a Selected Home Operator that can ensure service availability where the M2ME is to be deployed;
  * registration of M2ME(s) at the Selected Home operator.
**[Visited operator:]{.underline}**
The Visited operator supports the following functions:
  * Providing a temporary 3GPP network access to M2ME with preliminary credentials (e.g. PIMSI). The only requirement for the Visited Operator is to have a roaming agreement with the Registration Operator. The Visited Operator may provide restricted connectivity to the M2ME during the access to the Registration Operator. These restrictions are indicated by the Registration Operator to the Visited Operator.
**[Platform Validation Authority:]{.underline}**
The Platform Validation Authority supports the following functions:
  * providing platform validation credentials to the Equipment Supplier;
  * validation of the M2ME platform when requested by the Selected Home Operator;
  * registration and revocation status handling of certificates in a PKI.
NOTE: It is assumed that there exist one or more PKI structures used for
handling cryptographic certificates for devices, signatures, and secure
session establishment.
Figure 1: The roles and their relations
#### 5.2.2.3 Network Architecture
##### 5.2.2.3.1 Overview
In this architecture it is envisioned that there are multiple registration
operators that offer services such as registration, certificate status reports
and platform validation. These functions and services might be separately
located and run by different operators but the most probable scenario is that
several functionalities will be co-located at the same operator. Figure show a
potential architecture with the roles described in previously. The PVAs in
this scenario not only act as platform validation agencies, but as global
certificate authorities. Hence, it is assumed that the number of PVAs is
limited, and that all parties trust the root certificates from the PVAs.
Figure 2: Network elements
#### 5.2.2.3.2 Interactions
The following steps constitute one set of example procedures whereby the
downloading and provisioning of U(I)SIM on the M2ME can take place where the
M2ME accesses a 3G VO's network in its initial network access. It is assumed
that the RO(HSS/AuC) holds 3GPP shared secrets associated with the M2ME, such
that RO is able to generate authentication vectors needed for initial IP
connectivity.
**Pre-credential installation and subscription registration:**
  1. The ES asks a Registration Operator for set of unique network-access credentials for the user. The RO creates the credentials, stores them locally and forwards them to the ES, who provisions them into the M2ME TrE.
  2. Additionally, the ES asks a PVA to create credentials for validation of the platform authenticity/integrity. The PVA creates and stores such credentials which are then sent to the ES, who provisions the credentials into the M2ME.
  3. The M2ME is purchased and delivered to the M2ME U/S.
  4. After purchasing the M2ME, the M2ME U/S registers for a subscription at a selected SHO.
  5. The SHO contacts the RO (DR-SP) and informs it that SHO now has a subscription with the M2ME. The RO (DR-SP) updates its registers with information on how the M2ME should discover the SHO.
> **Initial IP connectivity and USIM/ISIM provisioning:**
>
> Figure 3 shows a possible scenario of how to provision U(I)SIM credentials
> to a M2ME.
Figure 3. Steps of a USIM provisioning scenario.
The procedure can be divided into the following steps:
  1. The M2ME uses the standard GSM/UMTS principle (GPRS/PS) to decode network information and attaches to the network of any VO. In the attach message the M2ME sends it's PIMSI. The RO provides authentication vectors to the VO such that an ordinary AKA can be performed between the VO and the M2ME.
> After this stage and until the M2ME connects to the network using SHO's
> U(I)SIM credentials after downloading and provisioning them, all
> communication between the M2ME to the various network entities is done via
> the air interface provided by the VO. Traffic is encrypted over the air
> interface and terminated in the VO. Integrity and confidentiality protection
> of credentials has to be provided by other means.
  1. The RO (DR-SP) aids the M2ME to find its correct SHO. The result is redirection of the M2ME to the SHO.
  2. The M2ME TrE is validated by the PVA.
  3. The SHO (DP-SP) provisions the U(I)SIM credentials to the M2ME using OMA DM. The M2ME provisions the downloaded credentials into the TrE and reports the success/failure status of the provisioning to the DP-SP. The switch to the new USIM is done at next AKA (or after a dedicated action, e.g. power down power-up cycle).
##### 5.2.2.3.3 Network architecture details for provisioning of USIM/ISIM
credentials
###### 5.2.2.3.3.1 General
Five steps are identified in the procedure described above in order to be able
to perform network provisioning of USIM/ISIM credentials:
  1. Manufacture pre-credential installation phase
  2. M2ME subscription registration
  3. Initial IP connectivity establishment
  4. Discovery of SHO
  5. Provisioning of the USIM/ISIM credentials
###### 5.2.2.3.3.2 Manufacture pre-credential installation phase
> The ES asks a RO for set of unique network-access credentials for user _A_ ,
> {PIMSI _~A~_ , K _~A~_}. The RO creates the network-access credentials and
> stores them in its HSS/AuC. The OR then forwards them to the ES, who
> installs them into the M2ME TrE.
>
> Additionally, the ES asks a PVA to create validation credentials used to
> check the authenticity/integrity of the platform. The PVA creates a public
> cryptography key pair {PrK _~A~_ , PuK _~A~_} and a corresponding
> certificate, Cert _~A~_. This certificate is signed by the PVA, which is
> considered as a trusted authority. The credentials {PrK _~A~_ , PuK _~A~_ ,
> Cert _~A~_} are sent back to the ES who installs the validation credentials
> into the M2ME.
>
> During provisioning of the USIM credentials, it should be possible for the
> M2ME to verify that the USIM is indeed provisioned by the selected SHO. To
> achieve this some secret need to be installed in the TrE of the M2ME. We
> will call this secret the network verification key, denoted K~NetVer~ The
> possibility of installing a list of several such secrets which could be used
> to change operator is FFS.
>
> Editor\'s Note: There may be issues with managing big number of the
> K~NetVer~ keys.
>
> The M2ME is purchased and delivered to the M2ME U/S. On delivery, PIMSI
> _~A~_ , the secret K~NetVer~ (alt. several K~NetVer~ keys) together with the
> address of the RO is given to the device owner (M2ME U/S), e.g., on a piece
> of paper.
###### 5.2.2.3.3.3 M2ME subscription registration
Subscriber information registration can be done in several different ways.
However, in the context of this alternative it is assumed that the M2ME is
shipped to the end customer before the SHO has been chosen.
The M2ME U/S registers for a subscription at the selected SHO. Information
about the considered M2ME devises that need to be provided to the SHO are the
PIMSIs, the K~NetVer~ keys, and which RO that is associated with the M2MEs.
The SHO stores the information obtained by the M2ME U/S. The SHO also
generates downloadable USIM credentials and stores them in the HSS/AuC.
The SHO contacts the RO (DR-SP) and informs it that SHO now has a subscription
with the M2ME. The RO (DR-SP) updates its registers with information on how
the M2ME should discover the SHO.
###### 5.2.2.3.3.4 Initial network connectivity and IP connectivity
Once the device has been configured and the subscriber has been registered by
the operator, an M2ME will be able to use its pre-credential values to attach
to any network that accepts the PIMSI, i.e., all networks with a roaming
agreement with the RO, see Figure Figure.
Figure 4. Standard AKA with VO, where RO provides authentication vectors.
The attaching and authentication procedure is performed as follows:
  1. The M2ME uses the standard GSM/UMTS/EPS principle to decode network information and attaches to the network of any VO. In the attach message the M2ME sends its PIMSI to the VO.
  2. The VO, identifying the RO from the PIMSI, contacts the RO that will accept the PIMSI as a legitimate preliminary credential.
  3. The RO (HSS/AuC) issues a set of Authentication Vectors (AV), based on the secret key K _~A~_ shared between the RO (HSS/Auc) and the M2ME.
  4. The M2ME and the VO perform the standard AKA process. If the authentication is successful, the M2ME is allowed access to the VO\'s network.
###### 5.2.2.3.3.5 Discovery of SHO
To be able to acquire new USIM credentials, the M2ME needs to find the address
of the SHO in some manner. In this architecture we assume that DR-SP is in
fact an OMA-DM server. The OMA DM sends a push over-the-air bootstrapping
message to the M2ME, see Figure. The bootstrapping message transfers the M2ME
into a state where it can initiate a device management session with a new
device management server, i.e., the DP-SP.
Figure 5. RO helps the M2ME to find its selected SHO by sending a OMA DM
bootstrapping message.
###### 5.2.2.3.3.6 Provisioning of the USIM/ISM credentials
> The provisiong is assumed to be performed using OMA DM as proposed in
> S3-080681. A possible provisioning scenario is illustrated in Figure and
> described by the following steps:
Figure 6. OMA DM USIM credential procedure.
  1. The M2ME sends to the SHO (DP-SP) information about the M2ME, such as information about the TrE. The M2ME uses its private key PrK _~A~_ to sign the information and attaches its certificate, Cert _~M2ME~_. The M2ME generates a nonce which is incorporated in the object to prevent replay attacks.
  2. The OMA DM server consults the received information and validates that the provisioning request relates to an ongoing M2M provisioning, this is done by checking the signature and the freshness of the nonce.
  3. The OMA DM back end system contacts the PVA (the PVA used is indicated in Cert _~A~_) to verify that the TrE can be trusted. The PVA reports the result back to the SHO. It is assumed that the number of PVAs is limited, and that they can be seen as trusted parties by all entities. The PVA contacts an OCSP to check the status of the certificate of the M2ME.
  4. If the TrE is deemed trustworthy, the DP-SP (OMA-DM) retrieves the wrapped (encrypted) platform credential for the device and provisions them to the M2ME. The nonce send by the M2ME in step 2 is appended is included so that the M2ME can detect replayed objects. The wrapping of the blob is done using the public key, PuK, of the M2ME. This blob contains the USIM application/credentials, as well as the shared secret K~NetVer~ used by the M2ME to verify that the SHO is indeed the chosen SHO. This blob can only be opened using the platform credentials, i.e., the private key, PrK, which the M2ME holds in its TrE.
  5. The M2ME receives the encrypted credentials which are decrypted (using the private key PrK) inside the TrE. The M2ME can verify that it comes from the correct SHO by checking the shared key, K~NetVer,~ , if so the parameters are extracted and securely stored. The device is assumed to react on the presence of the provisioned USIM application, and locally provision the application to the secure environment corresponding to the platform credential. The M2ME finally returns success of failure to the network
##### 5.2.2.3.4 Distributed Registration Service
According to the description so far, any mobile operator can become a
Registration Operator and thus host a registration service. This would allow a
distributed registration with better scalability and reliability.
Additionally, each Registration Operator may introduce internally technologies
to increase reliability such as load balancing, three-tier architecture or
failover.
Regarding served PIMSI space there are two architecture alternatives, Common
and Disjoint PIMSI space. There are two Registration Service Operator
scenarios, Centralized and Distributed RS Operator. This relationship between
PIMSI space ownership versus PIMSI space distribution is depicted in the table
below.
* * *
                         Centralized RS Operator   Distributed RS Operator
Common PIMSI space 1 2 Disjoint PIMSI space 3 4
* * *
1\. In this architecture there is a centralized Registration Operator (RO),
e.g. GSMA, that owns the PIMSI space. Allocating the PIMSI space for this
scenario could be done by assigning a new MCC for PIMSI use. Internal data
distribution (on servers, possibly geographically distributed) for high
availability etc. within the RSO is out of scope.
2\. Under this architecture, each Registration Operator serves the whole sub-
space of active PIMSIs. This means that in principle, any Registration
Operator can serve any roaming M2M equipment. In order to keep consistency
across registration services, any suitable technology can be employed: Master-
Slave replication or peer-to-peer propagation updates. In Master-Slave, a
central master copy is only accessible to Home Operators for provisioning and
to Registration Operators for reading. In peer-to-peer, one update in a local
registration service is replicated to the peer ones.
Editor\'s Note: It is FFS how a M2M equipment can distinguish between a plain-
old roaming operator and one offering registration services.
**3\. This architecture differs from case 1 with regards to how the PIMSIs are
allocated from the IMSI space. Here each disjoint PIMSI space could e.g. be
allocated for separate servers of the centralized RSO.**
**4.** Under this architecture, one Registration Operator serves a selected
sub-space of PIMSIs, namely the ones that have been agreed with the Selected
Home Operator. Here the Selected Home Operator or the Registration one handle
the local provisioning of active PIMSIs.
Editor\'s Note: Besides the previous note, it is for FFS how M2M equipment can
distinguish between a one registration operator that is not serving its PIMSI
from the one that actually.
### 5.2.3 Alternative 2: Open Architecture
#### 5.2.3.1 General
In this alternative architecture the tamper-resistant module supporting the
remotely provisioned and managed USIM/ISIM application can apply to option 2
in clause 4.1.2 as previously described, i.e. the module is not a physical
UICC. It can also apply to an embedded UICC. In such a case, an operator may
authenticate the UICC before remote provisioning of their USIM
application/parameters into it.
  * the roles required for temporary network connection, registering to the HO and provisioning of the USIM/ISIM applications are separated out and may be contracted to various parties;
  * provision is made for credentials for temporary network access and for authentication/validation of the security of the module that will support the remotely provisioned and managed USIM/ISIM applications;
  * mechanisms are required for the discovery of the various entities by the M2M-enabled equipment and for the setting up of secure channels for registration, provisioning and management
  * provisions are made, utilizing the roles defined, for M2M-enabled equipment to change subscription from one HO to another.
  * provisions are made for network entities to create, maintain, communicate , authenticate/validate, verify, and use information about trustworthiness (as in the context of the TCG) of the M2M-enabled equipment in performing such tasks as registration and provisioning of the U(I)SIM functionality on the M2M-enabled equipment during various stages of the M2M-enabled equipment's lifecycle
NOTE: Exact definition of "authentication/validation of the trustworthiness of
the M2M-enabled equipment" is FFS, but for now, it may be interpreted as
collective functionality of elements in this architecture
authenticate/validate the authenticity and integrity of any hardware,
firmware, and/or software including all or parts of the OS, and any data,
keys, secrets or credentials, that are needed or related to the functionality
of the M2M equipment to authenticate itself to a 3G M2M network using the
U(I)SIM functionality
#### 5.2.3.2 Roles
This section discusses the different functional roles in a potential network
architecture.
The following roles have been identified:
**Home Operator:**
The Network Operator which has the commercial relationship with the customer
and with whom the customer wishes to register the M2M-enabled equipment. The
HO may operate some or all of the other roles, especially RS and PS, or they
may all be separate commercial entities with an operational relationship with
the HO and with each other.
**[Registration Service (RS):]{.underline}**
This is a role that enables the after-purchase selection of a specific HO and
registration of the M2M-enabled equipment with that HO. It could be an
independent service but more likely it would be operated by the selected HO
whose RS may be contactable only via the HO's 3GPP network or may be
contactable directly via the Internet and discoverable e.g. using
functionality in the M2M-enabled equipment.
The RS should support the following usage-related functions:
  * To allow the customer to select the HO after delivery of the M2M-enabled equipment(s) from the supplier;
  * To allow the M2M-enabled equipment to have an IP connection to the RS using either temporary authenticated network access or limited open network access;
  * To allow the M2M-enabled equipment to request for a USIM/ISIM application provisioning to take place via a VNO as the M2M equipment is not yet associated with any HO;
  * To approve the provisioning request and to authorise the PS to provision the M2M-enabled equipment.
  * Registration of M2M-enabled equipment(s) by the owner of the M2M-enabled equipment
In order to support the usage-related functions described above, the RS needs
to support the following technical functions:
  * association of the M2M-enabled equipment(s) with a selected HO
NOTE: If the RS can only be accessed via an authenticated connection to the
associated HO's network, the RS cannot provide the network identity of that HO
to the M2M equipment. A method would be needed to enable discovery of the HO's
network identity before the RS was contacted, e.g. the addresses of one or
more RS and/or Hos' network identities could be provisioned into the
M2M-enabled equipment at some point in the supply chain. Another alternative
is for the RS to be discoverable and addressable directly using the IP
connectivity provided by the VNO's network.
  * connection to the M2M-enabled equipment via all mobile operator's 3GPP networks and, if applicable, all compatible non-3GPP networks.
  * validation, via the CADSA, of the bootstrapping credentials which the M2M-enabled equipment possesses as proof of the authenticity of its embedded secure device. This role may be subsumed into the role below, i.e. validation of the platform security credentials.
  * validation, via the CADSA, of the Platform Security credentials of the M2M-enabled equipment as proof of the authenticity and/or integrity of the M2M-enabled equipment as a platform
  * connection to the PS for authorisation and audit.
  * Generate or obtain the package of data to be downloaded, i.e. in this case the USIM/ISIM credentials, files and executables. Transmit this data securely to the PS. Alternatively, this function could be provided by the PS itself.
  * Facilitate the setting up of a security association between the M2M-enabled equipment and the PS. This could require the generation and transmission of security tokens over secure channels to the M2M-enabled equipment and PS.
Editor\'s Note: The ownership of the RS is FFS.
**Credential Authority for Temporary Network Access (CATNA):**
CATNA is the authority responsible for the validation of credentials required
for temporary access to communications networks for the purpose of
registration and provisioning of operational network access. This function is
required only where unauthenticated connectivity is not available for this
purpose. This function could be provided by a central organisation. CATNA
supports the following functions:
  * Issuing of temporary network-access credentials, e.g. preliminary IMSI numbers and preliminary keys, for each M2M-enabled equipment. These can be used for authenticated initial temporary 3GPP network access to enable the USIM/ISIM application provisioning procedure to take place.
```{=html}
``` \- To allow the equipment supplier to pre-configure the M2M-enabled
equipments with the above temporary credentials, issued by the CATNA, This
includes:
    -   **Secure transmission of the above credentials to the
        organization that is responsible for embedding them in the
        M2M-enabled equipment's secure environment.**
    -   **Registration of the above credentials in a database.**
    -   Validation of the credentials described above, when requested by
        a relying party using the requisite protocols. This could
        include the secure transmission of authentication vectors and/or
        other related data to the relying party.
NOTE: prior to successful registration of the M2M-enabled equipment to a HO,
all 3GPP access networks are considered as visited networks.
NOTE: It may be desirable for the CATNA to have additional functionality which
may include:
  * **Creating, maintaining and updating a database of 'masked P-IMSI data' that is cryptographically mapped to all individual P-IMSIs and has certain freshness qualities to thwart replay attacks; such 'masked P-IMSI data' would be used to uniquely and securely indicate the preliminary network-access credentials of the M2M-equipment.**
Editor\'s note: These additional functionalities are FFS.
**Credential Authority for Device Security Authentication/validation (CADSA)**
CADSA is the authority responsible for credentials that authenticate/validate
the authenticity of the secure device within M2M-enabled equipment that is
used for storage and execution of the downloaded USIM/ISIM applications. This
function could be performed by one or more commercial organisations who issue
credentials such as certificates and key pairs and who provide certificate
validation services. According to options described earlier, the secure device
could be a UICC or some other form of secure module embedded in the
M2M-enabled equipment. This function is required where strong authentication
of the secure device is a pre-requisite for provisioning of the USIM/ISIM
applications.
CADSA is also responsible for credentials that authenticate/validate the
"trustworthiness" of the M2M-enabled equipment as a platform that supports the
secure device embedded in the M2M-enabled equipment. This function could be
performed by one or more commercial organizations who issue credentials such
as certificates and key pairs such as those defined in TCG specifications and
who provide certificate validation services. Since remote update of the
M2M-enabled equipment's SW/FW, including those that impact the M2M-enabled
equipment functionality to support the U(I)SIM or its remote management, may
be expected in operation, the CADSA needs to update "trustworthiness"
credentials that would result from such update of the SW/FW on the
M2M-equipment during the deployment lifecyle of the equipment.
CADSA provides the following functions:
  * Creation and issuing of credentials to authenticate/validate the security of the secure device within the M2M-enabled equipment.
  * **Secure transmission of the above credentials to the organization that is responsible for embedding them in the M2M-enabled equipment's secure environment.**
  * **Registration of the above credentials in a database.**
  * Validation of the credentials described above, when requested by a relying party using the requisite protocols. This could include the secure transmission of authentication vectors and/or other related data to the relying party.
  * Maintenance of data relating to the validity of a device's issued credentials.
  * Creation and issuing of credentials to authenticate/validate the 'trustworthiness' of the M2M-enabled equipment,
NOTE: The content and format of 'trustworthiness' is FFS. Use of credentials
or certificates defined in the TCG may suffice. For example, a
"trustworthiness" credential may contain protected secrets, such as certain
values held by one or more protected registers in a trusted processing module
embedded in the M2M-enabled equipment and protected by encryption with signing
keys protected within the M2M-enabled equipment.
  * **Secure transmission of the above "trustworthiness" credentials to the network entities that are responsible for using such credentials in regard to the remote management of the U(I)SIM capability in the M2M-enabled equipment.**
  * **Registration of the above credentials in a database.**
  * Validation of the credentials described above, when requested by a relying party using the requisite protocols. This could include the secure transmission of "trustworthiness" credentials and/or other related data to the relying party.
  * Maintenance of data relating to the validity of a device's issued Platform credentials.
  * Receive information regarding successful update of certain sensitive SW/FW on the M2M-enabled equipment from entities (such as the Provisioning Service) responsible for such updates; and revoking old "trustworthiness" credentials and creating and maintaining new "trustworthiness" credentials upon reception of such information.
NOTE: It may be desirable for the CADSA to have additional functionality which
may include:
  * **Communication to the HO information about the up-to-date information on the "trustworthiness" of the M2M-enabled equipment as a platform. It may be desirable, on further studies, to incorporate such "trustworthiness" information to derive AKA keys to be used for remote U(I)SIM management, for example by using the GBA.**
**[Provisioning Service (PS):]{.underline}**
In order to support the following:
  * perform the secure provisioning of the USIM/ISIM application and their parameters to the M2M-enabled equipment;
the PS needs to support the following functions:
  * Receive authorisation from the RS to provision the M2M-enabled equipment. This could include a security token for communicating with the M2M-enabled equipment.
  * Receive from the RS the application package to be downloaded. Alternatively the PS could generate this from stored rules and advise the RS of the credentials that have been downloaded to the M2M-enabled equipment.
  * Provisioning of a USIM/ISIM application or USIM/ISIM parameters to the M2M-enabled equipment.
  * Perform future updates to a USIM/ISIM application or USIM/ISIM parameters to the M2M-enabled equipment and future provisioning of new applications.
  * Notify the RS of a successful or unsuccessful provisioning event.
> NOTE: It may be desirable for the PS to have additional functionality which
> may include:
  * **Supervising (or monitoring the interactions and impact of) any provisioning by another entity such as the HO, or direct provisioning, of updates to certain SW/FW of the M2M-enabled equipment after its initial deployment.**
  * Provisioning of such SW/FW updates in compliance with the relevant OMA specifications (OMA DM, FOTA, Download, etc). When the M2M-enabled equipment supports OTA update procedures, any updates made should comply with the platform security rules agreed to between the manufacturer and Operator.
  * The exact roles of the PS in terms of the SW/FW update and monitoring is FFS.
Editor\'s Note: The ownership of the Provisioning Service is FFS.
[]{.underline}
**[Supplier of the M2M-enabled equipment:]{.underline}**
The supplier of the M2M equipment supports the following functions:
  * Securely obtain credentials from the CATNA for authentication for the temporary initial network access.
  * Pre-configuration of the M2M equipment(s), prior to delivery to the customer, with those preliminary network-access credentials in order to allow temporary initial network access.
  * Obtain securely from a CADSA the bootstrapping credentials for use in proving to the RS, via the CADSA, that the M2M-enabled equipment complies with a standardised set of security requirements. This activity may be contracted out to an approved organisation with the required secure infrastructure.
  * Pre-configuration of the M2M equipment(s), prior to delivery to the customer, with the bootstrapping credentials This pre-configuration activity may be contracted out to an approved organisation with the required secure infrastructure.
  * Provide a means for the equipment owner to select the desired RS/HO, or for this to happen automatically when the equipment is connected to an access network.
NOTE: At this point that the M2M equipment leaves the supplier, it is not
normally associated with a Selected HO. Some uses cases may require the
identity of the HO and a corresponding discovery mechanism to be pre-
configured in the equipment.
[]{.underline}
**[Owner of the M2M-Enabled Equipment:]{.underline}**
The owner of the M2M-enabled equipment supports the following function:
  * Selection of HO and registration of all the M2M equipment(s) with this selected HO.
  * Informing the RS of an impending subscription change from one HO to another HO.
```{=html}
``` \- Provisioning "reference platform trustworthiness credentials" into the
M2M-enabled equipment.
    -   In essence, the 'owner' must know what kind of platform
        > trustworthiness state the M2M-enabled equipment should be at
        > various points of the equipment's deployment lifecycle, and
        > must be able to provision a trusted credential for such
        > information into the M2M-enabled equipment at various points
        > of the equipment's deployment lifecycle.
  * Providing the CADSA with 'reference platform trustworthiness credentials'
    * The CADSA, upon receipt of such 'reference platform > trustworthiness' credentials, uses them to verify the > trustworthiness of the M2M-enabled equipment.
    * The 'owner' may be able to obtain such 'reference platform > trustworthiness' credentials from a trusted third party (e.g. > equipment manufacturer or supplier, or a TTP that has a > trusted relationship with the manufacturer or the supplier).
    * Note also, that a TTP may be able to provide such 'reference > platform trustworthiness' credentials to the CADSA directly, > upon authorization by the 'owner'.
  * Additionally, capability and functionality for the owner of the M2M-enabled equipment to remotely facilitate 1) on-equipment detection of possible tampering to the M2M-enabled equipment and 2) automated reaction to such detection, including reporting of tamper-detection event and evidence of tampering to the selected HO as well as automatic disabling of certain key functions and deletion of some sensitive keys and data, may be highly desired by some operators
[]{.underline}
**[Visited Network Operator (VNO):]{.underline}**
All access networks that are accessed for the purpose of initial registration
and provisioning of the USIM/ISIM applications are considered to be VNOs. If
the M2M-enabled equipment becomes registered for a different operator, then
the VNO remains a VNO. If the M2M-enabled equipment becomes registered to the
operator that is currently the VNO, then the VNO becomes the HO. The VNO
supports the following functions:
  * providing temporary network access to M2M-enabled equipment, i.e. where access credentials and authentication may be required. This could be based on the temporary network access credentials such as a preliminary IMSI (PIMSI).
  * Where it is considered permissible, to provide open network access to the RS, i.e. where no credentials or authentication are required for access to at least the services of the RS. This function applies, e.g., when the VNO will become the customer's HO after the registration and provisioning events.
  * After registration and provisioning: providing full network (and IMS) access using the provisioned USIM/ (and ISIM) applications
#### 5.2.3.3 Relationships
The relationships between these roles are described in Figure 6 below. The
lines in this figure indicate that a negotiation is taking place between
linked roles and possibly that a corresponding contractual relationship
exists, but do not indicate a standardized technical interface.
The following assumptions are made:
  * The manufacturer or supplier of the M2M equipment registers the M2M equipment at the CATNA, and the CATNA distributes preliminary IMSIs to manufacturers/suppliers.
  * The device owner purchases the M2M equipment from the supplier and registers the M2M equipment at the selected Home Operator.
  * The RS and the VNO interact via a roaming interface. The selected HO registers at the RS after being selected by the device owner.
Figure 6: The roles and their relationships.
Relationships are as follows:
1) Supplier obtains preliminary credentials from CADSA. These credentials are
for authentication/validation of the security of the secure module. Loads
credentials into device. Note: credentials could be generated by supplier and
communicated to CADSA. Supplier obtains "trustworthiness" credentials from
CADSA. These credentials are for authenticating/validating the
"trustworthiness" of the M2M-enabled equipment as a platform embedding the
functions of the secure module. Credentials could be generated by supplier and
communicated to CADSA.
Editor\'s Note: Whether CATNA has a role in the "trustworthiness" credentials
embedding and/or obtaining the M2M-enabled equipment is FFS.
2) Supplier obtains credentials from CATNA. These are for authenticated
connection to a VNO's network, if a direct IP connection to the RS/PS of the
chosen HO is not openly available.
3) Supplier provides equipment to user
4) M2M enabled equipment is able to connect to VNOs' networks, if required.
NOTE: relationships 5 and 6 below are not required if the VNO can provide an
unauthenticated network connection to the HO's RS/PS, ie. If relationship (7)
can be used.
5) VNO can contact CATNA for authentication based on preliminary credentials
and/or for roaming authentication vectors for a network connection to HO's
network
6) CATNA can mediate a roaming connection from VNO to HO
7) This is an alternative to relationships 5 and 6. VNO can provide
unauthenticated direct connection to the RS that is used by the HO.
8) HO uses the services of the RS. The RS may be a part of the HO's
infrastructure or may be an external entity with a commercial relationship
with the HO.
9) The RS uses the services of the CADSA to authenticate/validate the security
of the secure module in the M2M-enabled equipment.
10) The RS uses the services of CADSA to authenticate/validate the
"trustworthiness" of the M2M-enabled equipment.
Editor\'s Note: steps 8 and 9 above may be combined, at the discretion of the
HO. Also, the HO may decide to authenticate/validate only the platform.
Exactly when and under what circumstances such verification should take place
is FFS
11) The RS uses the services of the PS for provisioning.
#### 5.2.3.4 Network architecture
A potential network architecture with the roles described above, could be as
shown in figure 7 below.
{width="7.771527777777778in" height="4.399305555555555in"}
Figure 7: Network authentication and USIM application installation in the
M2M-equipment.
**[Preliminary IMSI:]{.underline}**
Preliminary IMSI is a temporary private identity provided by the CATNA which
uniquely identifies each CATNA-registered M2M-enabled equipment. This
preliminary IMSI, where required, needs to be installed in the M2M equipment
by the supplier in order to allow the M2M equipment to register in a 3GPP
network without being associated yet with any specific HO.
It may be desirable that, when transmitted, the Preliminary IMSI is protected
for integrity and/or confidentiality, to mitigate vulnerabilities due to
certain threats (e.g. base-station redirection attack). Use of cryptographic
hash algorithms as well as ciphering can be considered. If such methods are
used, assurance of freshness of the cryptographic processing (e.g. keys,
hashes, etc) must be addressed, by use of, for example, nonces.
NOTE: The preliminary IMSI is not required if the VNO provides unauthenticated
network access for the purpose of connecting to the RS.
Editor\'s Note: The shortage of IMSI-numbers could be an open issue to
resolve. This is FFS.
**[Prerequisites for remote provisioning and management:]{.underline}**
**[Once:]{.underline}**
  1. the M2M-enabled equipment has been pre-configured with preliminary credentials provided by the CATNA; and
  2. the M2M-enabled equipment has been registered with the selected HO; and
  3. the M2M-enabled equipment has successfully authenticated/validated the trustworthiness of whole or selected core part(s) of the M2M-enabled equipment by the CADSA; and
  4. the CADSA has authenticated/validated the trustworthiness of the whole or selected core parts of the M2M-enabled equipment and reported the state of such successful authentication/validation to the CATNA, RS, and HO, and
  5. the M2M-enabled equipment has been associated at the RS with a selected HO, and
  6. the RS has registered the equipment with the CATNA, then
> the M2M-enabled equipment will be able to use its preliminary credentials to
> register at any VNO that accepts the PIMSI and that requires its use.
NOTE: Alternatively, the prerequisites 3 and 4 above may be omitted as
prerequisites for the attach to the VNO but as prerequisites for a later
stage, i.e., for provisioning of the M2M-enabled equipment after its attach to
the VNO.
**[Interactions for initial registration and U(I)SIM
provisioning]{.underline}**
The following interactions would be needed between the nodes in figure 4, for
initial registration and provisioning of U(I)SIM on the M2M equipment:
1\. The M2M Equipment uses the standard GSM/UMTS principle (GPRS/PS) to decode
network information and can attach to the network of any VNO that will accept
the included PIMSI (according to the allowed networked list pre-configured in
the M2M Equipment). The M2M equipment is authenticated by the standard UMTS
AKA procedure by the VNO. Alternatively the VNO, who may operate WLAN or DSL
access, may allow unauthenticated access to the network for registration
purposes.
NOTE: All networks are at this phase considered as VNOs' networks.
NOTE: In order to be able to perform client authentication for initial
attachment to the VNO's network, the M2M equipment needs to support an
algorithm which is shared by all the M2M equipments and the CATNA. Such an
algorithm could be MILENAGE. It is not possible to use a proprietary algorithm
NOTE: Steps 2, 3, 4, 5 below are not required if the VNO allows
unauthenticated access to its network for the purpose of registering the
M2M-enabled equipment to a RS.
2\. The VNO identifies the IMSI as a PIMSI and contacts the CATNA with the
PIMSI in order to get preliminary authentication vectors for the PIMSI.
3\. The CATNA discovers the HO's network identity from the M2M-enabled
equipment and obtains authentication vectors for roaming to the latter's
network.
4\. If the M2M-enabled equipment is successfully authenticated and receives a
usable IP connection to the VNO's network, then the M2M equipment can navigate
to the desired RS via a secured connection.
5\. The RS connects to the HO and registers the M2M-enabled equipment for
connection to the HO's network.
6\. This is an alternative to 2, 3, 4, 5. The VNO provides a direct IP
connection to the RS associated with the HO. The RS connects to the HO and
registers the M2M-enabled equipment for connection to the HO's network
7\. Using the services of the CADSA, the RS validates the trustworthiness of
the M2M-enabled equipment as a receptor of the U(I)SIM provisioning service.
The components to be verified for authenticity and/or integrity include the
secure module and the M2M-enabled equipment (\"the platform\"). Optionally,
the HO may choose to verify only the platform. Exactly when and under what
circumstances such verification should take place is FFS
8\. The RS contacts the PS to authorize the provisioning of the USIM/ISIM
application.
9\. The PS downloads the USIM application to the M2M-enabled equipment, after
receiving authorization from the RS.
#### 5.2.3.5 How Alternative 2 can be used for USIM/ISIM re-provisioning due
to a change of the Home Operator
In this section we illustrate how the architecture alternative 2 can
facilitate a secure re-provisioning of USIM/ISIM due to a change of the Home
Operator (HO) that an M2M-enabled equipment is subscribed to.
The RS coordinates the re-registration of the M2M equipment between the Old HO
and the New HO. In this case, the news about the impending subscription change
may have originated from the owner of the M2M-enabled equipment to the RS.
An example of a procedure to securely authenticate the M2M equipment for re-
provisioning due to a change of subscription of the Hos is depicted in the
next figure.
Figure 8. Re-provisioning of an M2M equipment due to Subscription Change
> The interactions among the network nodes according to the above example
> scenario are as follows:
1) Via a secure application-layer message, the owner of the M2M-enabled
equipment alerts the RS that a subscription change from the Old HO to the New
HO will take place. This is done via the VNO.
```{=html}
``` 1) The RS contacts the CADSA and requests it to obtain (a) information
that can verify U(I)SIM credentials of the M2M equipment, and (b) information
that can verify any new "platform trustworthiness" credentials of the M2M
equipment.
2) The CADSA contacts the New HO and obtains information required to verify
M2M equipment's U(I)SIM-related credential.
3) The CADSA also contacts the owner to obtain information to use to verify
"platform trustworthiness" credential when it is later received from the
M2M-enabled equipment.
> 4B) Alternatively, the CADSA contacts a TTP to obtain such credentials.
4) The RS contacts the CATNA so that the CATNA can update its record linking
the P-IMSI of the M2M equipment to the New HO.
5) The RS contacts the M2M equipment, via the VNO, to prepare for re-
provisioning due to a subscription change.
6) The M2M equipment discards the current Avs, corresponding to the Old HO,
that it has, and sends the P-IMSI again to the VNO for a fresh attach to the
VNO.
7) The VNO sends the P-IMSI to the CATNA
8) The CATNA discovers the New HO's network identity from the P-IMSI and
obtains authentication vectors (Avs) for roaming to the New HO's network. The
CATNA delivers the Avs to the HO.
9) The M2M equipment communicates securely with the RS via the VNO, and RS
registers it with the New HO.
10) The RS instructs the M2M equipment, via VNO, to send current "platform
trustworthiness" credentials.
11) The M2M equipment sends the RS, via the VNO, its "platform
trustworthiness" credentials.
12) The RS forwards the U(I)SIM related credentials as well as the "platform
trustworthiness" credentials to the CADSA for verification.
13) The CADSA verifies the M2M equipment's U(I)SIM credentials as well as the
"platform trustworthiness" credentials. Upon successful verification, the
CADSA authorizes the RS to go ahead with registering the M2M-equipment.
14) The RS assists the New HO to attach the M2M-enabled equipment to the New
HO's 3GPP network.
15) The RS authorizes the PS to go ahead with provisioning new U(I)SIM
credentials/applications to the M2M enabled equipment.
16) The PS associated with the RS re-provisions the M2M-enabled equipment with
new U(I)SIM application and/or credentials. This is done via the New HO and
the VNO.
17) The PS notifies the RS of successful re-provisioning
18) The RS notifies the New HO, the CADSA, and the "owner" of successful re-
provisioning. Alternatively, the notifications can be done in cascades, from
the RS to the HO, then to CADSA and to 'owner',for example.
In another variant of the above second scenario, we consider the case where
the U(I)SIM credentials for the Old HO and that for the New HO are pre-
provisioned already in the USIM before the subscription change takes place. In
this case, these two separate sets of credentials need to be strictly
separated, and neither of the two HO's involved in the subscription change
shall be allowed to obtain each other's U(I)SIM credentials. We propose to
implement such isolation using TCG techniques, especially the techniques of
mobile trusted phone. The M2M-equipment would still need to be re-registered
by the RS to the New HO. Thus, the usual functions of the CATNA (to provide
preliminary authentication and Avs) and those of the CADSA (to provide
credentials verification) may stay the same as in the above scenario.
The New HO's U(I)SIM credentials may be configured through similar procedures
as initial provisioning described previously, protected and isolated from the
Old HO within a trusted environment in the M2M-enabled equipment. The re-
provisioning step will now comprise of 'deactivation' of the current U(I)SIM
credentials and subsequent 'activation' of the New HO's U(I)SIM credentials.
The PS's role in this case therefore deactivation of Old credentials and
activation of New credentials at the M2M-enabled equipment.
Note that in all of the above examples we assumed that all other network
elements, that is, the VNO, RS, CATNA, CADSA, and PS, stay the same and only
the Hos change. For example, the PS may reside inside each HO, so there may
need to be a change of the PS as well as the HO too. Also, a change of the HO
may also mean that the VNO that the M2M equipment can talk to may also need to
change. Again, the assumptions we held for the above 'relationship example'
can be easily modified because of the flexibility in the architecture, and
relationships similar to but reflecting a different assumption can be easily
obtained.
#### 5.2.3.6 How Alternative 2 addresses the issues that were raised by SA3#49
concerning Alternative 1
  1. Provisioning of the credentials by the Registration Service may be a nightmare.
> RS does not have to be a part of the HO. RS does not have to also deal with
> temporary network access. PS can be a separate entity
  1. The operating procedures for the exchange of credentials between the Owner, Registration service and the operator need to be defined. This will be a vital part of this operation. Not sure how this can be addressed in SA3, perhaps there needs to some involvement by GSMA SG in this area?
> This is addressed at a high level. Possibly Liberty Alliance or Global
> Platform protocols are appropriate.
  1. When receiving a request from M2M equipment for USIM download, how does the Selected Home Operator know that the USIM download is allowed for this specific M2M equipment?
> The bootstrap credentials are validated by the CADSA.
>
> The "trustworthiness" of the M2M-enabled equipment itself, not just that of
> the U(I)SIM credentials held by the equipment, is also validated by the
> CADSA. This obviously enhances the level of trust that the operator can have
> in the process of validating the equipment requesting access and service.
  1. What is the relationship between the Selected Home Operator and the Registration Service?
> See description of roles and relationships.
  1. Is it within the scope of the GSMA to operate Registration Service?
> This is possible within alternative 2.
  1. Alternative 1 assumes that the USIM/ISIM application resides on the M2M equipment rather than on a UICC. This is a major departure from the well accepted UICC-based security model used in 3GPP systems. It is far from clear that 3GPP is ready to accept a move away from UICC-based solutions.
> This is not covered by alternative 2. But this TR is only a study item.
  1. Alternative 1 makes assumptions about the service requirements that should be addressed by the security solution (e.g. ability to download USIM application over the air, etc.). It is important to note that SA1 has not yet agreed any service requirements for M2M applications.
> Noted.
  1. Alternative 1 assumes that both the registration of the mobile phone to the Home Network via the Registration Service, as well as provisioning of the USIM application and credentials onto the phone by the Home Network will take place without verification of either the trustworthiness or authenticity of the security environments (e.g. UICC, or other hardware/software security devices or environments) on the phone nor the authenticity of the credentials held in such secure environments.
> Alternative 2 addresses this using bootstrapping credentials and by defining
> a CADSA.
  1. Alternative 1 assumes that the entity that provisions the downloadable USIM applications and credentials are identical to the selected home network, thereby limiting the flexibility whereby such an entity can be a third-party Provisioning Service provider affiliated with, but independent from, the home network operator.
> Alternative 2 allows the role of Provisioning Service to be separated out
> from the role of Home Operator.
  1. Alternative 1 assumes that the registration and USIM provisioning processes will be conducted whereby the communication between the mobile phone and the various entities involved in these processes will not be protected for privacy or integrity. Since these two processes, especially the USIM provisioning deals with highly sensitive data, there needs to be measures to protect such communication.
> The need for authentication and secure channels needs to be brought out in
> the sections of the TR that will deal with security "assumptions" and
> "issues".
>
> Possible 'masking' of the P-IMSI, where 'unmasking' is performed by the RS
> or the CATNA, can be considered, as was hinted in section 5.2.2.3.
  1. The download of initial authentication vectors for the P-IMSI, for temporary network access, may not be optimal. It only serves to authenticate the P-IMSI for the purpose of temporary network access until USIM parameters can be download from the Selected Home Operator (SHO). In order to do this though, it seems to require about as much temporary network access as is eventually required with the SHO! Also, unless this authentication of the P-IMSI is also used to authenticate the UE for the purposes of hosting the device, that UE authentication must also later be performed. However, a symmetric protocol is not optimal for UE authentication, as it requires the secure maintenance of a large database of keys on the network side, when this would not be required if an asymmetric UE authentication method were used.
> This is not addressed in alternative 2. Hopefully it will be possible for
> the equipment to get an operational IP connection to the RS/PS without
> having to go through a verified authentication process for access to the
> VNO's and HO's networks.
  1. The architecture assumes that it is not known at manufacture of the M2M terminal who the Selected Home Operator will be. The architecture should allow for this fact to be known and taken account of by the manufacturer.
> Alternative 2 mentions this requirement (see the subsection on "roles") but
> does not say how it is to be done.
  1. Exactly which problem is solved by the Registration Service?
A. We believe it is useful to consider the requirements below so as to enable
flexibility and modularity in the solutions. In this way, different modules of
a solution could address different requirements, if appropriate.
> Alternative 2 addresses this requirement by separating out the functional
> roles
B. Avoid the cost of subscriptions and SIMs "going live" a long time before
the M2M device is activated and the subscription is used, or _(not addressed
in alternative 2)_
C. Avoid the need to make a decision for a particular mobile operator at
manufacturing time , _is addressed in alternative 2)_ or
D. Avoid the need to insert a SIM in the M2M device when it is being deployed,
_(is addressed in alternative 2)_ or
E. Enable the owner of the M2M device to change from one operator to another
one without having to handle a SIM while the M2M device is in the field? _(the
provisioning process in alternative 2 can be used to request the download of a
new subscription)_ See section 5.2.3.5.
```{=html}
``` 14\. It should be made clear which functions in alternative 1 are required
for enabling connectivity and which are required for enabling remote USIM
management.\"
> This is made clear in alternative 2.
  1. Placement of Registration Service: If registration service is one entity, then all parties have to accept the Registration Service and the interface type. The involved parties would not only be all operators (also those that just forward, i.e. visited operator), but also all the manufacturers of various \"machines\" e.g. cars, parcel companies, etc.
> The different roles in alternative 1's RS are separated out in alternative
> 2.
  1. Placement of Registration Service: If registration service is one entity, there are some control issues. The registration service would have most likely have a direct interface with HSS and be able to trigger changes of data there. Who is trusted enough to run such a service? On the political side, which country would exercise its legal control over the registration service?
> In alternative 2, the RS does not have to be a centralised service, but the
> CATNA may be. The CATNA will not need to interface directly with any NO's
> HSS.
  1. Placement of Registration Service: If the registration service is one entity, Denial of Service or accidental downtime are having a large business impact.
> RS does not have to be 1 entity in alternative 2.
  1. Placement of Registration Service: If a distributed entity, then the manufacturers and visited network have to find out, which registration service is applicable. This may be solved, if one of them hosts the registration service or there is some sort of identity for this. But the issue remains that all manufacturers and visited networks would have to trust all registration services.
> Alternative 2 makes some suggestions as to how the RS may be discovered. It
> may require Liberty Alliance Discovery Service functionality. Trust of the
> RS could again require Liberty Alliance functionality to provide
> authentication and a secure communications session.
  1. Placement of Registration Service: Would the registration service be aware of the supported algorithms and hence indirectly or directly be aware what algorithms the operators support? In our view, authentication and key derivation algorithms should be standardised for M2M.
> This is not yet addressed in alternative 2.
  1. Scalability: Many machines may be sold in areas where the service is not available, this means, if the manufacturer registers at manufacturing time ALL his machines, then there will be a lot of \"dead data\" in the registration service. To avoid this the registration service may delete old data if not used, but how should it know, if the machine is just waiting on a shelf in a shop to be sold or if it has been shipped to far-far-away country.
> This is not yet fully addressed in alternative 2. The case of change of the
> HO is addressed in alternative 2 at a high level, in section 5.2.3.5.
  1. Scalability: The amount of potential interfaces may be an issue since there are many manufacturers and operators that would need a "pipe" to the registration service. This could result in load problems, also all interfaces would need to be tested and validated (like today's roaming interfaces). If the applications include metering, tracking and tracing and pay as you drive, one should consider how many valuable parcels, cars, containers, laptops, metering devices there are, then this could really be a scalability issue. (Synchronised time of activation, amount of devices vs. central registration service, identification of devices)
> This is not yet addressed in alternative 2 but the alternative does not
> require any entity to be centralized. Interfaces within a distributed
> architecture can use Liberty Alliance protocols, for instance, for
> discovery, session management and security.
  1. The manufacturers may need to change their manufacturing process to enable \"personalization\" at the manufacturing time so that the data for the registration can be send to the registration service. (Cf. the need to ship SIMlock related data from manufacturer to operator today).
> Noted. In alternative 2, the bootstrap credentials need to be obtained from
> a CADSA. Credentials for temporary network access may need to be sent by the
> manufacturer to a CATNA.
  1. Can the machine also unregister (and potentially register again) using the registration service? (e.g. car is sold or parcel is delivered to a user)
> This is not yet addressed by alternative 2, as there is no defined use case.
  1. Concerns have been raised towards the idea of a non-smartcard based solution and remain unconvinced about the merits of such solutions. In particular a software only based "soft-(U)SIM" seems like a very risky concept. There are two main reasons for our skepticism:\
     * Telenor is far from convinced about the actual attainable security of non-smartcard solutions\
     * From a security managements perspective the introduction of non-smartcard based solutions seems to increase the overall complexity of the security architecture.\ New non-smartcard solutions will probably require new operational policies etc. There is added cost to this and there also seems to be an increased security risk.
> Noted. This TR is a feasibility study. The requirements have first to be
> identified and then the feasibility conclusions can be agreed. The
> additional functionality provided by the CADSA to authenticate/validate the
> "trustworthiness" of the M2M-enabled equipment as a whole or at least the
> part that supports the U(I)SIM functions and its management, rather than
> just the U(I)SIM credentials, enhances the security level of the
> architecture.
### 5.2.4 Alternative 3 "Architecture with separated connectivity and **remote
application management** services"
#### 5.2.4.1 General
The fundamental issue for establishing operational M2M connectivity is the
initial provisioning of the necessary credentials to the M2M terminal. As an
MTM terminal can be constrained in its I/O capabilities as well as by its
physical location, we cannot make the simplifying assumption that the M2M user
always will have physical access to the MTM terminal and manually insert the
credentials by means of a physical token or some other local wired or wireless
interface. It must be possible to arrange any required post-manufacturing
provisioning and application management to be carried out over the
GSM/UMTS/EPS network itself. For the duration of this activity we call the
GSM/UMTS/EPS connection by the name _initial MTM connectivity_ , since the
lifetime and functional scope of this connection is constrained in many of our
architectural options. When the actual M2M credentials have been provisioned
and activated and the MTM terminal has reached a long-term operational state
the network connectivity is denoted _operational MTM connectivity_. Our
aspiration is that the operational connectivity is no different from the
connectivity of any other GSM/UMTS/EPS device, and that arranging the MTM
initial connectivity requires a minimum of changes in the current network
settings and protocols.
The other term defined by this alternative is _application management_. In
this term we also include the (U)SIM application management, i.e. the
management of the network credentials and other settings and services residing
within the (U)SIM application. We also single out M2M application management
for maintenance of applications and services on the M2M terminal itself.
For the activation of application management and connectivity our architecture
defines two services -- _the connectivity activation service_ to enable
initial (or operational) connectivity, and the very central _application
activation service_ which either performs M2M terminal management or resolves
addressing issues for it.
The following sections define the properties of the respective services. The
document concludes with a few example instantiations of initial M2M
provisioning possibilities, described in the architecture context.
#### 5.2.4.2
(Only most relevant terms listed)
AAS Application Activation Service
IMSI International Mobile Subscriber Identity (SIM identity)
K(i) SIM root key
M2M Machine -- to -- machine
Opc Operator Constant: Milenage 3G algorithm configuration option
PIMSI (vs. TR 33.812). The IMSI in use during in the initial connectivity
(legacy or synthetic)
USIM Subscriber Identity Module (application handling network authentication
at the terminal)
#### 5.2.4.3 Services
##### 5.2.4.3.1 M2M Connectivity Services
An M2M connectivity service provides communication between two M2M entities
attached to (possibly distinct) 3GPP-defined networks (GERAN, UTRAN, E-UTRAN),
using the CS or PS services of these networks. The only difference from
regular CS or PS services provided in GSM, UMTS or EPS is that M2M-specific
filters may be applied in the terminal or in the network, which restrict the
sets of entities with which an M2M terminal can communicate.
The filters restricting the service could e.g. be realized by constraining
communication to certain APNs in PS service.
Editor's note: an M2M entity is a functional entity which plays a role in the
provision of M2M communication. The precise definition is left open at this
point.
In particular, the identities (IMSI, MSISDN), used by an M2M connectivity
service are the same as those used in today's GSM, UMTS or EPS systems.
Editor's note: it is ffs whether there is a restriction on future M2M
communication growth through a shortage of IMSIs or MSISDNs. If so, then
enhancements to these identities may be needed. This is, however, not within
the remit of 3GPP SA3.
Furthermore, the credentials used for connectivity are assumed to have the
same functionality as SIM and USIM used in today's GSM, UMTS or EPS systems.
Nothing is meant to be implied in this clause 5.2.4 about the form in which
these credentials are stored on the M2M terminal (SIM card, UICC, trusted HW
module, soft SIM, etc..)
This approach to M2M connectivity services has the advantage that current GSM,
UMTS or EPS systems do not need to be changed at radio, link or IP layer for
M2M purposes.
**_Initial M2M connectivity service:_**
This service restricts an M2M terminal to GSM, UMTS or EPS communication with
dedicated M2M servers required for making an M2M terminal fully operational
after initial start up of the M2M terminal. Such a dedicated server could e.g.
be an M2M activation server**,** cf. below.
_Initial connectivity provisioning aspects -- legacy credentials vs. synthetic
ones_ :
At least two alternative approaches for arranging credentials for the initial
M2M connectivity can be envisioned. One is that the M2M terminal comes
equipped with _legacy credentials_ , i.e. functional GSM/UMTS credentials
associated with an existing network operator at the time the M2M reaches the
end customer (the assumption also includes the presence of the algorithm set
corresponding to the operator in question).
It would depend on the type of M2M terminal when the SIM or USIM functions
would be inserted in the M2M terminal. This could happen during manufacturing
if the M2M terminal does not allow easy insertion of a SIM/USIM after the
machine has been built, or after the M2M user purchased the machine and before
the M2M terminal is switched on.
In the legacy credentials approach, the same procedures as for users today
could be used on the network side. This may, however, not be the most
efficient way of handling M2M users. Optimized administration procedures for
handling of M2M users, e.g. for handling bulk subscriptions, could be
beneficial. There is also no need for M2M subscriptions to become active at
the time SIMs / USIMs are issued. (cf. below under "activation service")
The other approach is to assume the presence of some default algorithms in the
M2M terminal at the time of manufacturing, but to include in the device only
"_synthetic" credentials,_ not specifically assigned to or endorsed by any
existing operator in the marketplace. In this setting it is assumed that the
synthetic credentials are only used for connectivity during (initial)
registration, and there is no business proposition to actually extend the
lifetime or feature set of these credentials to turn them into credentials for
the operational connectivity service -- as would be a possibility in the
legacy credentials approach.
This architecture can be arranged by the introduction of a new (virtual)
registration operator with roaming agreements in place for the purpose of M2M
registration, whereby the credentials still can be structurally equivalent to
legacy credentials, although they could never be used for any other purpose
than M2M registration. Another way is to define the synthetic credentials
based on a publicly known, mathematical (one-way) function _f_ , i.e. f(Ku) =
{IMSI, Ki, (Opc)}, where **Ku** would be set in the terminal at manufacturing,
but also indicated on the M2M terminal or associated with the device in some
other way. As an overview, the use of these credentials can be arranged by the
end user indicating Ku to the operator (for the operational connectivity
service) at the time when the service agreement is signed, whereby the
operator will configure the credentials implied by Ku into its own AuC.
In all abovementioned approaches, the M2M terminal would be accepted by the
operator on network entry either as 1) a roaming customer or as 2) a local
customer), and the initial connectivity would be carried out based on these
credentials.
**_Operational M2M connectivity service:_**
This service provides all the GSM, UMTS or EPS communication required by the
M2M application. It may restrict an M2M terminal to communication with servers
specific to the M2M application. E.g. when the M2M use case is car tracking
then the M2M terminal would be restricted to communicating with the M2M server
of a specific car rental company. This service could be seen as a regular GSM,
UMTS or EPS service with an M2M-specific subscription profile. The above
mentioned restrictions could then be part of the service restrictions
implemented in a user/subscription profile.
_Operational provisioning aspects_ :
Cf. below under M2M application provisioning.
##### 5.2.4.3.2 Remote M2M application management service
The M2M user and the M2M servers used by the M2M application, and perhaps even
the M2M application itself, may not be known at manufacturing time. Then the
provisioning of all parameters or SW related to the M2M application must be
done remotely onto the M2M terminal. This is the function of the remote M2M
application management service. This service can be used e.g. to download SW
realizing the logic of a particular M2M application, or configuring
application parameters, such as addresses of M2M application servers in the
network. The specific case of provisioning the (U)SIM credentials is
considered in section 5.2.4.3.3.
As an extension of this service the corresponding management actions in the
network could be supported:
\- in the communication network to implement the restricting filters,
\- in the M2M application servers so that they know which M2M terminals to
accept.
Appropriate application layer security is likely to be required for this
service. Relying on GSM/UMTS/EPS security alone may be insufficient. Due to
the embedded nature of the M2M terminal, the origin of any software and its
integrity must likely be cryptographically ascertained. Source validation or
authorization functionality is also necessary when M2M terminal application
configuration options are set.
The use of OMA DM as a reference framework for application management seems to
be a valid alternative.
##### 5.2.4.3.3 Remote USIM application management service
When M2M terminal are deployed in the field it may be technically difficult
and / or costly to change the SIM cards or UICCs in the M2M terminals. I.e.,
it may be technically difficult for an M2M subscriber to change the
connectivity provider (mobile operator) for M2M terminals in the field. Hence,
a service is required to support operator change by changing (U)SIM
applications remotely while the M2M terminal is in the field. Such a service
must comprise at least two parts:
  * download of a new (U)SIM;
  * switching from old to new (U)SIM in such a way that connectivity is guaranteed all the time.
Appropriate application layer security is likely to be required for this
service. Relying on GSM/UMTS/EPS security may be insufficient, since
GSM/UMTS/EPS security would allow the visited operator to read the (U)SIM
credentials. (U)SIM credentials are so sensitive that only dedicated entities
in the home network and in the MTM terminal shall know them. Furthermore, the
cryptographic strength of GSM encryption algorithms is questionable, and
integrity is not provided in GSM.
The details of the provisioning protocol are not considered in the scope of
this text, but the following principles are put forth as fundaments for the
(U)SIM provisioning activity:
  * The protocol is carried out over a data channel between the M2M terminal and the AAS, after the initial connectivity has been arranged, and the AAS address has been resolved by the M2M terminal.
  * A secure binding between the MTM terminal and the (U)SIM provisioning messages destined for it must exist during provisioning. Depending on implementation choices, in this context an additional "trust service / server" may also be needed in a final architecture. Alternatively or complementary to this, user activity in the provisioning process may provide input for the binding.
  * The confidentiality and integrity of the (U)SIM credential secrets in transfer to the M2M terminal must be ascertained.
  * Usability aspects should be taken into account. The M2M user should ideally be able to treat the activation of the operational connectivity and the (U)SIM provisioning as one operation, process-wise not too different from the current activity of purchasing a new pre-paid SIM or establishing a contract with a network operator. If legacy (U)SIMs are provisioned then this treatment as one operation is not required.
OMA-DM is identified as one suitable framework for U(SIM) provisioning.
However, the requirements in terms of security (e.g. device binding) are not
immediately satisfied by the current protocol, and if chosen, at least some
new self-contained data structures (in the security sense) will be needed for
(U)SIM provisioning with OMA-DM.
In the context of (U)SIM provisioning, the data that needs to be provisioned
includes
\- The (U)SIM application secret **Ki** (for SIM) or K (for USIM)\ \- The
mobile subscriber identifier **IMSI** \ \- Algorithm specification /
identifiers. E.g. for Milenage 3G, this includes the operator constant Opc
In addition to the basic security-relevant information, the (U)SIM application
may contain a large amount of network-specific configuration information like
data access points and SMS service center addresses. Some of this basic
information could be part of the initial provisioning messages, but the
provisioning of this data does not need the same security guarantees as the
keying.
##### 5.2.4.3.4 Connectivity activation service
The period between the point in time of provisioning (U)SIM functionality into
the M2M terminal, cf. above, and the point in time of starting to use
connectivity may be quite long (perhaps weeks or even months). In the legacy
credentials case, for the operator providing the initial connectivity service
it may be undesirable to have live subscriptions in his network without any
activity over an extended period of time.
Therefore, a service may be useful (but not mandatory) by which an M2M user
can indicate to the initial connectivity service provider that the M2M
terminal is going to be switched on, and the subscription has to be activated
in the network. Such a service could e.g. be realized over an appropriately
protected web portal.
##### 5.2.4.3.5 Application activation service
This service is crucial for this architecture. It is a prerequisite for the
use of the remote USIM /M2M application management services. During the
connection to the application activation service, the M2M terminal will be
provisioned with
  * software functionalities / updates / algorithms needed for its upcoming operational use
  * credentials for accessing the network during operational connectivity
  * additionally needed naming, network, or service parameters
Resolving the address of the application activation service can be done in one
of many alternative ways. Any security association between the M2M terminal
and the application activation server must also be managed.
After initial start up, the M2M terminal shall contact the application
activation server. The application activation server then provides the M2M
terminal with the required parameters (addresses, security association) for
the following two services:
\- a remote M2M application management service, cf. above. This service is
always needed unless the details of the M2M application have already been
configured into the M2M terminal before start up.
\- a remote (U)SIM application management service, cf. above. This service is
only required when the initial connectivity cannot provide operational
connectivity as well, or if the M2M user wants to change the connectivity
provider. When the M2M subscriber decides at a later point to change the
connectivity provider then the address of the (U)SIM application management
server cannot be known at start-up time, but security credentials for such a
server and conditions when to accept a request from an unknown such server
could be made known to the M2M terminal at start-up time.
The application activation service needs input from the M2M user or M2M
subscriber regarding the parameters for the particular M2M application server
or the (U)SIM application management server run by a new connectivity
provider, in some scenarios, also the new (U)SIM credentials of the
connectivity provider. The M2M user or M2M subscriber could provide this input
e.g. through a web portal, located either at the connectivity activation
service or with the new connectivity provider.
There is no need for a central application activation server. E.g. every
initial connectivity provider could also operate an application activation
server. Alternatively, such an application activation server could be provided
by a third party.
###### 5.2.4.3.5.1 Resolving the network location of the application
activation service
The network location of the application activation service needs to be known
to the M2M terminal at the time the M2M terminal initially connects to the
network. In the case where legacy credentials are used, the most
straightforward approach is that the initial connectivity provider or the
device manufacturer provides this service, and pre-configures the address of
the service into the M2M terminal at the same time when the legacy credential
is inserted into the M2M terminal. If the naming is provided at a sufficiently
high level of abstraction (e.g. a DNS name) the actual location of the server
may move during the lifetime of the system. The name can be globally
resolvable, or it can be a fixed address (for all devices) that needs to be
resolved in the local access network. The latter would e.g. be a reasonable
choice when using synthetic credentials with constructed addresses, where
roaming during initialization with a high possibility could not be supported.
The drawbacks of the fixed (legacy) address approach lies in the longevity of
the solutions, a longer time might pass between MTM terminals being
manufactured and them being taken into active use. This implies that the
stakeholders operating the application activation service must commit to it
for an extended period of time -- and it is not immediately visible whether
there is (in all scenarios) a viable revenue stream for such operations.
#### 5.2.4.4 Roles
The following functional roles have been identified in the scope of M2M
operation and activation.
**M2M terminal user / M2M terminal subscriber**
The person or organization that the service provided by the M2M terminal
targets or benefits. Typically the owner or beneficiary of the operator
subscription. The M2M terminal user will manage the application activation of
the M2M terminal.
Editor's note: for conventional services and terminals, it is clear how to
distinguish user and subscriber. But, for M2M terminals, there is no person
"using" the terminal in the traditional sense as the M2M terminal is typically
unattended. It should therefore be reconsidered how to precisely define the
roles of M2M terminal user and M2M terminal subscriber, and whether they
really are two separate roles.
**M2M terminal manufacturer**
The manufacturer of the M2M terminal. The manufacturer may be a business
stakeholder in the initial connectivity service or in the application
activation service.
**Connectivity provider**
The network operator providing connectivity in the operational state of the
M2M terminal. In some activation scenarios, a separate initial connectivity
provider can be identified. In other scenarios, the provider of initial and
operational connectivity coincide.
**M2M application provider**
A service entity that typically provides a service implemented using M2M
terminals by means of applications embedded in or provisioned to M2M
terminals.
**Remote (U)SIM management provider**
The management endpoint of the USIM application configuration, providing to
the M2M terminal the USIM credentials of the connectivity provider.
**Activation service provider**
The entity operating the application and possibly the connectivity activation
service. Depending on the activation scenario, the service provider can be one
of the following: manufacturer, connectivity provider, M2M application
provider, or even another party.
**Regulator**
Governmental body or other legislative or regulatory entity governing the
operation of the terminals, and networks in a country or region.
#### 5.2.4.5 Functional entities
Depending on the activation scenario, a set of the following functional
entities will be present in the network during the activation and subsequent
operational state of the M2M terminal.
**M2M terminal**
The M2M terminal is an embedded communication device including the (U)SIM
application, communication stacks and logic for communicating over a
GSM/UMTS/EPS network. The M2M terminal also includes applications (and
hardware) for providing a service, interfaces providing local communication
means for a service, or a computational environment and physical interfaces
providing an environment to host a dynamically provisioned service. The M2M
terminal additionally may provide a (network) management interface for
terminal activation and possible service management.
GSM/UMTS/EPS network entities may in some plausible scenarios be complemented
by additional functionality, mainly to support the initial connectivity of the
M2M terminal. Constrained routing of information to and from the M2M terminal
(filtering) during its activation is proposed in some activation scenarios. It
is, however, considered undesirable, or even infeasible to modify the existing
GSM/UMTS/EPS network infrastructure for the purposes of M2M communication.
**M2M application server**
The application hosted in or in conjunction with the M2M terminal will likely
need management support, configuration and provisioning. In some cases the
complete application may be provisioned. The application server is the entity
that provides the network end-point for this functionality. Depending on the
foreseen variety of support provided by this entity, it could be further
partitioned, e.g. into M2M application-logic server and M2M application data
server. The application itself, in its operational state, will also have one
or several end-points for its communication with another device. This peer
entity is not explicitly addressed by this architecture.
**USIM application server**
The server that provides (U)SIM application management, and possibly algorithm
download, making the M2M terminal operational with respect to the connectivity
provider. This server is architecturally similar to the M2M application
server.
**Activation server**
The activation server is needed to provide dynamic addressability of the
respective application servers, which in some activation scenarios will be
conditioned on the choice of connectivity provider as well as on the selection
of application, and its provider.
#### 5.2.4.6 Example steps for making M2M terminal operational
The following three examples identify three options of system setup in terms
of achieving the initial provisioning for the M2M terminal. The scenarios
highlight a few separation options for arranging initial connectivity and
application provisioning in the scope of the provided architecture, the
variations focusing on
a) Providing the initial connectivity\ b) Finding (resolving the address) of
the application activation service(s).
The examples do not detail the deployed provisioning protocols for (U)SIM and
application deployment.
##### 5.2.4.6.1 Preconfigured Application Activation server with legacy
credentials
{width="5.282638888888889in" height="3.222916666666667in"}
Figure 9: Preconfigured AAS, legacy credentials
  1. The M2M terminal is manufactured
  2. the (U)SIM and the parameters of the application activation server are configured into the M2M terminal, cf. 5.2.4.3.1 on initial connectivity provisioning aspects. Step 2 may have to be done jointly with step 1 or later, depending on the type of terminal.
  3. the M2M user / subscriber uses the connectivity and application activation services (e.g. via web portal).
  4. the connectivity provider activates the subscription and sets the required filters in the network.
  5. the application activation service provider configures the parameters of the application management servers (derived from M2M user input in step 3) into the application activation server.
  6. the M2M user switches the M2M terminal on.
  7. the M2M terminal sends an activation message to the pre-configured application activation server.
  8. the application activation server provides the M2M terminal with the parameters of the M2M application management server and, optionally, the (U)SIM management server.
  9. the M2M terminal contacts the (U)SIM management server, if required.
  10. the (U)SIM management server downloads a new (U)SIM to the M2M terminal, if required, and the M2M terminal switches to the new (U)SIM.
  11. the M2M terminal contacts the M2M application management server.
  12. the M2M application management server configures the parameters of the M2M application into the M2M terminal.
  13. M2M terminal and M2M application server are ready for use.
##### 5.2.4.6.2 Dynamic Application Activation server with legacy credentials
{width="4.975694444444445in" height="2.9166666666666665in"}
Figure 10: Dynamic AAS, legacy credentials
1\. The M2M terminal is manufactured
2\. the (U)SIM and the parameters of the application activation server are
configured into the M2M terminal, cf. 5.2.4.3.1 on initial connectivity
provisioning aspects. Step 2 may have to be done jointly with step 1 or later,
depending on the type of terminal.
3\. the M2M user / subscriber uses the connectivity activation service (e.g.
via web portal).
4\. the connectivity provider activates the subscription and sets the required
filters in the network.
5\. the connectivity provider configures the parameters of the application
management servers (derived from M2M user input in step 3) into the
application activation server.
6\. the M2M user switches the M2M terminal on.
7\. the application activation server triggers the M2M terminal using e.g. OTA
SMS provisioning, indicating the address of the AAS. Subsequently, the M2M
terminal connects to the AAS. For this alternative, the AAS must be told
somehow that the M2M terminal has been switched on, or rely on retransmissions
over a period of time.
8\. the AAS provides the M2M terminal with the application management & USIM
parameters (The M2M application management server and (U)SIM management server
are here a single server).
9\. M2M terminal and M2M application server are ready for use.
##### 5.2.4.6.3 Static, locally resolved Application Activation server
address, synthethic (U)SIM credential
{width="5.441666666666666in" height="3.027083333333333in"}
Figure 11: Static AAS, synthetic credentials
1\. The M2M terminal is manufactured, configured with the synthetic credential
based on Ku. The M2M terminal is also "labelled" with Ku for the user to read
it. The MTM terminal is also configured with a _locally resolved_ DNS name for
the AAS.
2\. the M2M user / subscriber uses the connectivity activation service (e.g.
via web portal), and gives Ku to the network
3\. the connectivity provider activates a subscription based on Ku and sets
the required filters in the network.
4\. the connectivity provider activates a new credential set into the AuC as
well as to AAS in the form of provisioning messages
5\. the M2M user switches the M2M terminal on.
6\. the M2M terminal tries to access all available networks with the
credential based on Ku. Eventually it will succeed, if the user has made a
service contract with one of the locally visible operators.
7\. Subsequently, the M2M terminal connects to the AAS.
8\. the AAS provides the M2M terminal with the application management & USIM
parameters (The M2M application management server and (U)SIM management server
are here a single server).
9\. M2M terminal and M2M application server are ready for use.
### 5.2.5 Alternative 4 Unified Network Architecture
Editor's Note: this section, if adopted, will replace network architecture
alternatives 1, 2 and 3.
#### 5.2.5.1 Principles of the Unified Network Architecture
The following principles characterize the proposed unified network
architecture:
  * Unified architecture to support USIM/ISIM provisioning and management for M2M Terminals (equipments) of different types and capabilities
  * Separation of the connectivity services and USIM/ISIM management services
  * Separation of initial and operational connectivity services
  * Security of the USIM/ISIM management to be independent of the security of the initial connectivity service.
  * Requirement for IP connectivity for provisioning and management of USIM/ISIM credentials and applications
  * Use of provisional IDs to obtain registration of the M2M terminal with the selected home operator through a secure connection via a visited network operator
  * Validation of the authenticity and integrity of the terminal as a trusted platform before provisioning takes place
  * Support for re-provisioning due to change of selected home operators
#### 5.2.5.2 Required Services
#####
**Required services for remote management of USIM/ISIM functionality on an M2M
equipment are broadly categorized into two groups. They are:**
  * Connectivity Services
  * Application Services
#### 5.2.5.3 Summary of Required Connectivity Services
##### 5.2.5.3.1 General
**The purpose of the provisioning and management services described in the
present document is to obtain credentials and applications required by the M2M
equipment for operational use. In order to achieve this, several layers of
connectivity are required, as follows:**
##### **5.2.5.3.2** Initial Network Connectivity
Before connection to a provisioning or management service can be achieved for
the first time, i.e. before the operational USIM/ISIM have been downloaded and
activated, initial network connectivity must be achieved to an IP network. The
M2M equipment is required to support bootstrapping functions for this purpose.
Several different solutions to this problem may be required, depending on the
type of equipment and on the type of AN that is available to the equipment for
initial connectivity. Examples could include:
  * Use of pre-provisioned preliminary credentials to access a visited 3GPP PLMN for initial connectivity;
  * Use of user-provided or pre-provisioned credentials to obtain a fixed-network or WLAN for initial connectivity.
Possibilities for equipment types and AN types are described in the uses cases
in the present document and in [TR 22.868]. In the current architecture we
primarily consider pre-provisioned preliminary credentials for accessing a
visited 3GPP PLMN. However, we do allow for the case where IP connectivity is
achieved by other means than using pre-provisioned 3GPP credentials.
Editor\'s Note: It is still TBD whether any other pre-provisioned credentials
are within the scope of this study.
##### **5.2.5.3.3** Use of access-specific mechanisms to aid in address
resolution
Once initial connectivity is set up, the M2M equipment needs to know the
address of one or more servers in order to proceed with provisioning process.
Depending on the selected IP network, there are some commonly used bootstrap
mechanisms by which the address(es) of these services may be provided.
Examples include
  * BOOTP/DHCP for IP networks
  * OMA DM bootstrap for 3G networks
These mechanisms are part of the initial connectivity, but can be used to
provide a solution to the address resolution problem in cases where the
necessary server address(es) cannot be preconfigured into the M2M equipment.
###### **5.2.5.3.3.1** Using OMA DM bootstrap for address resolution
This section provides one example of performing the mechanism. Other methods
may also be possible.
OMA-DM provides a bootstrap mechanism based on connectionless OTA push. This
mechanism can be used if no network configuration parameters are pre-
configured in the M2M equipment. At least two configuration contexts can be
identified -- the context for provisioning the USIM application, and the
context for provisioning M2M applications.
Note 1: A single OMA-DM context can be bootstrapped only once. Thus a
mechanism for re-bootstrapping contexts is needed FFS.
The OMA BOOTSTRAP characteristic defines the PROVURL to which the OMA-DM
client will initiate the connection. In addition, an access point definition
(NAPDEF) for the access network in question should be added to the
provisioning message to enable IP connectivity (CSD or GPRS bearers) on the
device.
Server authentication of the Bootstrap message origin is defined in OMA-WAP-
ProvBoot-V1_1 and OMA-TS-DM_Security-V1_2. For M2M, a reasonable choice is to
use a password method, i.e. a shared secret between the server and the M2M
equipment. This secret, referred to as device PIN, must be given to the
bootstrap server (DR-SP) as part of the setup of M2M terminal provisioning
definition. The same authentication token can be used for transport-neutral
security in further OMA DM communication. There is also a requirement for the
OMA DM client to authenticate the server during the provisioning activity.
This is typically handled by using a trusted credential for the TLS
negotiation (server certificate). Two options could be envisioned:
1\. The MTM equipment incorporates all necessary trust roots (root
certificates) to validate the server
2\. The OMA DM Bootstrap message is augmented with the certificate/public
key/public key hash of the OMA DM server.\ \ Note: This has been done before
(MS) by the addition of a "CertificateStore" characteristic, but could also be
conveyed in a more subtle way, e.g. by including the public key hash in the
ProvURL parameter, or by the addition of a VENDORCONFIG characteristic in the
bootstrap message.
Note 2: OMA DM bootstrap poses a more general problem for VNO connectivity. In
practice probably the NAPDEF actually could refer to the SHO NAPDEF, since the
network topology may route GPRS data packets through the SHO anyway, but if
not, the SHO or DR-SP may need to know more details of the AN in order to
provision the right NAPDEF for the roaming situation
##### **5.2.5.3.4** IP Connectivity for Provisioning/Management of the
USIM/ISIM application and Other Credentials
Once initial IP connectivity has been established, IP connections to the
registration, provisioning and management services can be achieved for the
purpose of obtaining the operational network-access credentials as well as
additional needed configuration, including security policies if any, and
software. The process for provisioning and management of operational
credentials is independent of the AN that is being used for initial
connectivity.
Furthermore, there is independence between the AN that is used for initial
connectivity and the networks over which the operational credentials are
intended for use. For example, any Ans that provide initial connectivity can
be used to provision:
  * Credentials to access the operational network with
  * Authentication software and algorithms that operate on the afore-mentioned credentials
Examples of these include:
  * a USIM application and an associated USIM credential that will be used by the M2M equipment for operational access to 3GPP;
  * an ISIM application and an associated ISIM credential that will be used by the M2M equipment for operational access to an IMS, over any available AN.
Editor\'s Note: It is TBD whether a certificate-based application that will be
used for operational access to ADSL or WLAN may also be considered as an
example in the above.
##### **5.2.5.3.5** IP Connectivity for Provisioning/Management of M2M
Applications
The provisioning and management of M2M applications (see the use cases in the
present document and [TR 22.868]) may require a subsequent IP connection to
entities that are separate from those used to provision and manage the
operational credentials. The independence of this function from the AN will be
the same as described above.
##### **5.2.5.3.6** Operational Connectivity
Once the required network access applications and possibly also M2M
applications have been provisioned and activated, they are then used by the
M2M equipment to access one or more available, compatible networks and to run
the operational M2M applications.
Editor\'s Note: whether provisioning and activation of M2M applications should
also be described here is TBD by the SA3.
Note : The Operational connectivity may also include a separate provisioning
activity to set up (3GPP) network connectivity parameters, like SMS service
centers, internet connectivity etc.
Connectivity to an IMS may be required for operational use, using the
appropriate layers of the operational AN.
During the state of this operational connectivity provided by an operator, the
owner of the M2M equipment may change the IP connectivity subscription to
another operator without having to go through an initial connectivity state.
#### 5.2.5.4 Required Application Services
**The following is a summary list of the application services required for the
architecture described in this document.**
  1. **Discovery and Registration services;**
  2. **USIM/ISIM Download and Provisioning services**
Editor\'s Note: Other application services that may be considered to be
additionally required may include activation, registration, and
download/provisioning of M2M applications other than for USIM/ISIM. They may
include services for equipment (device) management. Tamper detection/reaction
type of services may also be considered. These are TBD.
#### 5.2.5.5 Functional Roles
**The following functional roles are defined for this Unified Architecture:**
  1. **M2M Equipment User/Subscriber (M2ME U/S)**
  2. **M2M Equipment Supplier (ES)**
  3. **Connectivity Service Providers (CSPs)**
```{=html}
``` 1\. **(Non-3GPP) Initial Connectivity Service Provider (N3G-ICSP)**
  1. **(3GPP) Initial Connectivity Operator (ICO).**
  2. **(3GPP) Visited Operator (VO)**
  3. **(3GPP) Selected Home Operator (SHO)**
```{=html}
``` 4\. **Application Service Providers (ASPs)**
```{=html}
``` 1\. **Discovery and Registration Service Provider (DR-SP)**
  1. **USIM/ISIM Downloading and Provisioning Service Provider (DP-SP)**
Editor\'s Note: Other types of ASPs that may be considered later include
Activation Service Providers for activation of the equipment, USIM/ISIM, and
other applications, and Registration service providers and Download and
provisioning service providers for applications other than USIM/ISIM. These
are TBD
  1. **Connectivity Credentials Issuing Authority (CCIA)**
  2. **Platform Validation Authority (PVA)**
  3. **Regulator (RG)**
The following describes a summary of the functions of the roles listed above:
**1\. M2M Equipment User/Subscriber (M2ME U/S)**
> The person or organization that subscribes to a selected home operator (SHO)
> for services that it receives and consumes, services, including services for
> connectivity and application registration and activation, that are provided
> by the M2M Equipment under the subscription contract.
Editor's note: In order to avoid possible confusion, we are not re-using term
'M2M Terminal User' as was used in [2] and instead proposes to use a new term
Equipment User/Subscriber. **Usage of the terms user and subscriber needs to
be enhanced to remove possible confusion with SA1 TR 22.868.**
> Editor's note: The use of the term 'M2M Equipment', instead of the term 'M2M
> terminal' as used in [TR 22.868] has been approved for TR 33.812.
An M2ME U/S must support the following functions:
  * Select a Home Operator (a SHO) and deliver all the M2M equipment(s) parameters to this Selected Home Operator (SHO)
An M2ME U/S may support the following functions:
  * Inform the Initial Connectivity Operator (ICO) of an impending subscription change from one SHO to another SHO, in case of a subscription change.
```{=html}
``` \- Contact any relevant activation service provider for activation of
these services.
  * Upon request, and if available and appropriate, provide the Platform Validation Authority (PVA) with credentials needed for validation of the M2M Equipment as a platform or applications provided by the M2M equipment including those supporting USIM/ISIM remote management.
  * The M2ME U/S may be able to obtain credentials for platform and/or applications from a trusted third party (e.g. equipment manufacturer or supplier, or a TTP that has a trusted relationship with the manufacturer or the supplier).
Editor's note: Further explanation of the trust relation needs to be added.
**2\. M2M Equipment Supplier (ES)**
The supplier of the M2M Equipment. Typically the supplier is a manufacturer.
An equipment supplier (ES) may be a business stakeholder in the initial
connectivity service or in the application activation service. The ES must
support the following functions:
  * Interact with a Connectivity Credentials Issuing Authority (CCIA) to make it possible that a credential for temporary initial network access is created and securely embedded or downloaded into the M2M equipment
> Example methods of such interactions may include
  * CCIA generates credentials and sends to ES to embed during manufacture time; or
  * ES generates and embeds them and sends them to CCIA afterwards; or
  * ES generates and embeds them and they are communicated to CCIA via the user (note: this was the \"synthetic credentials\" idea from Nokia)
```{=html}
``` \- Interact with a Platform Validation Authority (PVA) to make it possible
that a credential for validation of the platform authenticity/integrity is
created and securely embedded into the M2M equipment, before downloading and
provisioning of the USIM/ISIM takes place.
> Example methods of such interactions may include
  * PVA generates credentials and sends to ES to embed during > manufacture time; or
  * ES generates and embeds them and sends them to PVA afterwards; or
  * ES generates and embeds them and they are communicated to PVA by the > M2M Equipment as part of the platform validation protocol
> An ES may support the following functions:
  * Provide a means for the M2ME U/S to select the desired SHO, or for > this to happen automatically when the equipment is connected to an > access network.
> NOTE: At this point that the M2M equipment leaves the supplier, it is not
> normally associated with a Selected HO. Some uses cases may require the
> identity of the SHO and a corresponding discovery mechanism to be pre-
> configured in the equipment.
>
> If a supplier is not the manufacturer of the M2M Equipment, it must still be
> able to perform all the functions listed above, possibly in cooperation with
> the manufacturer.
**3\. Connectivity Service Providers (CSP)**
> These are roles that provide connectivity service to the M2M equipment, and
> include operators of 3GPP networks that provide connectivity services for
> initial network access, registration, or operational use of the M2M
> equipment.
>
> Non-3GPP service providers (e.g. fixed network, ADSL or WLAN) that provide
> non-3G access to activation and registration services for the M2M equipment
> may also play these roles.
Editor\'s Note: This is TBD by SA3.
> In some activation scenarios, a CSP providing initial connectivity can be
> identified apart from the provider of operational connectivity. In other
> scenarios, the provider of initial and operational connectivity services are
> the same.
>
> In this architecture, we define the following types of Connectivity Service
> Providers (CSPs).
  1. **(Non-3GPP) Initial Connectivity Service Provider (N3G-ICSP)**
> **N3G-ICSPs are connectivity service providers such as fixed network service
> providers, IMS service providers, or WLAN providers that provide non-3G
> access to activation and registration services for the M2M equipment.**
  1. **(3GPP) Initial Connectivity Operator (ICO)**
> This is a role that provides connectivity services to help with the post-
> purchase discovery of the SHO..
>
> The following is assumed for the ICO for its usage-related functions:
  * To provide IP connectivity services so that M2ME U/S should not have > to select the SHO prior to delivery of the M2M equipment from the > ES;
  * To provide IP connectivity services for the M2M equipment to > request, from a USIM/ISIM Download and Provisioning Service > Provider (UDP-SP), for downloading and provisioning of USIM/ISIM > credentials and applications, via a roamed Visited Operator (VO) > network.
> In order to support this usage, the ICO may support the following functions:
  * Authenticate the M2M equipment for connectivity services ; i.e. > provide authentication vectors (Avs) to the connected visited 3GPP > operator in order to allow the 3GPP operator to authenticate the > M2M equipment at initial attach;
  * Generate and transmit authentication vectors or complete 3GPP > attachment credentials to the ES to allow for pre-configured > credentials for temporary access or,
  * Receive authentication vectors or complete 3GPP attachment > credentials from either the ES, the SHO or the M2ME U/S
Editor\'s Note: The ownership of the ICO is FFS, although the role of the ICO
might be taken by the VO.
  1. **(3GPP) Visited Operator (VO)**
> A Visited Operator (VO) is any 3GPP operator that operates a network that is
> accessed for the purpose of initial registration and provisioning of the
> USIM/ISIM applications and credentials.
>
> If the M2M equipment becomes registered for a different operator after an
> initial attach to a VO, then the VO remains a VO. If the M2M-enabled
> equipment becomes registered to the operator that is currently the VO, then
> the VO becomes the SHO.
>
> The VO supports the following functions:
  * Provide a temporary 3GPP network access to M2M equipment, where > access credentials and authentication may be required. This could > be based on the temporary network access credentials such as a > preliminary IMSI (PIMSI).
Editor\'s Note: It is FFS the PIMSI-structure so that the Visited Operator can
provides temporary access
Editor\'s Note: It is FFS whether the Visited Operator shall provide full
connectivity or a restricted one during temporary access, e.g., for discovery
of Selected Home Operator and/or provisioning.
  * Where considered permissible, provide open network access to the > Discovery and Registration Service Provider (DR-SP), i.e. where no > credentials or authentication are required for access to at least > the services of the DR-SP. This function applies, e.g., when the > VO will become the customer's SHO after the registration and > provisioning events.
    1. **(3GPP) Selected Home Operator (SHO)**
> **A Selected Home Operator (SHO) is a role for a 3G operator who must
> perform the following functions:**
  * **Has a subscription contract with the M2M Equipment User/Subscriber > (U/S) to provide connectivity services (and application services > if it also takes on the role of an application service provider) > for the M2M equipment;**
  * **Authorise UDP-SP to provision M2M equipment with USIM parameters > generated by, or generated on behalf of, the SHO**
  * In case of re-provisioning and while there is an operational > connection to an M2M equipment, provide connectivity services > between the M2M equipment and a UDP-SP for re-provisioning of a > USIM/ISIM to the M2M equipment.
```{=html}
``` \- In case of re-provisioning and while there is an operational >
connection to an M2M equipment, Provides connectivity services for > the
attestation services of the device with the help of the CCIA > and the PVA for
a re-provisioning of the USIM/ISIM application or > credentials.
    4.  **Applications Service Providers (ASP's)**
> These are roles that provide various applications for the M2M Equipment and
> the M2M User/Subscriber. They are further categorized as follows:
  * USIM/ISIM Registration service provider (DR-SP)
  * USIM/ISIM Downloading and provisioning service provider (DP-SP)
Editor\'s Note Whether we need service providers for Activation of USIM/ISIM,
and Activation, Registration, Download/Provisioning, and Management for non-
USIM/ISIM M2M applications is FFS.
> Note: The Application Service Providers are really roles but may not be
> separate entities. For example, many of the A-SP's that are described below
> provide certain application services that are separate from the 3G
> connectivity services provided by the CSPs defined above; however, they may
> still be implemented as part of the CSPs (and especially operators).
>
> Note: Any and all combinations of the roles of the two types of application
> service providers can be merged to the same network entity. In such cases,
> any interactions between two different types of application service
> providers supported by a single entity may be supported by proprietary
> means.
  1. **Discovery and Registration Service Provider (DR-SP)**
> **The DR-SP is a role that provides application services that aid the
> discovery (of SHO by the M2M equipment) and registration (of the M2M
> equipment by the SHO).**
>
> **The DR-SP must perform the following functions:**
  * **Assist the M2M equipment with its SHO discovery process by offering address resolution service**
Editor\'s Note: we have assumed here that the Initial Connectivity Provider
(ICO) provides connectivity services for the SHO discovery process, while the
DR-SP provides application services for the same process. How exactly the ICO
and the DR-SP's roles can be demarcated is FFS; as well as whether this is
needed too.
Note: In BT's usage cases, connectivity services for registration (SHO
discovery process) may be provided by non-3G means. Therefore, it is not clear
whether we can drop the DR-SP and just stick with the ICO as the role that
provides 'all' functions needed for the registration of M2M equipment to a
SHO. This is the reason why I tried to separate the roles of the ICO and the
DR-SP.
  * Assist registration of the M2M equipment by the SHO.
Note: DP-SP may be owned by the ICO.
  1. **USIM/ISIM Downloading and Provisioning Service Provider (DP-SP)**
> **This is a role for managing the downloading and provisioning of the
> USIM/ISIM applications and credentials to the M2ME.**
>
> In order to support the following:
  * perform the secure provisioning of the USIM/ISIM application and > their parameters to the M2ME;
> the DP-SP needs to support the following functions:
  * Receive some addressing information for the client from SHO or ICO > to access the client, or alternatively rely on OMA-DM > bootstrapping for inducing the M2ME to connect to the DP-SP
  * Receive the authorisation from the SHO or ICO to provision the M2ME. > This could include a security token for communicating with the > M2ME.
  * Receive from the SHO the USIM/ISIM application and credentials > package to be downloaded. Alternatively the DP-SP could generate > this from stored rules and advise the SHO of the credentials that > have been downloaded to the M2ME.
  * Provision the USIM/ISIM application and credentials to the M2ME.
  * Perform future updates to a USIM/ISIM application or credentials to > the M2ME and future provisioning of new applications.
  * Notify the SHO of a successful or unsuccessful provisioning event.
Note: DP-SP may be a role assumed by the SHO.
Note: The provisioning of the USIM application to the M2ME, likely involves
the existence of\ a) a TrE platform key for which the application secrets are
sealed\ b) A platform credential (by the PVA) certifying the public part of
the platform key
Note: If the platform credential by the PVA is stored on the M2ME, and read by
OMA-DM only at provisioning time, the SHO cannot produce the encrypted USIM
application provisioning blob in advance (prior to OMA-DM provisioning). An
alternative is that the respective device platform credentials are managed
centrally by the PVA that issued them in the first place, and e.g. accessible
on request to the SHO.
  1. **USIM Application Provisioning Scenario -- OMA-DM**
> **The following scenario outlines the provisioning steps in the context of
> OMA-DM. It is assumed that two OMA DM management objects have been defined;
> the M2MMobj and the M2MSIMMobj. The first one is used to carry information
> about the M2ME and its TrE to the OMA DM Server and the latter is used to
> transport the U(I)SIM parameters (and possibly code) to the TrE of the
> M2ME.**
Note: The standardisation of OMA DM management objects is a relatively simple
process and can mainly be done in 3GPP (SA3) if so desired. OMA needs then to
register the defined object to become a valid OMA DM management object.
  * **The addressing, and alternatively connectivity settings are provisioned by an OMA-DM Bootstrap message. The authentication of the Bootstrap may be based on a shared secret, and if the validation succeeds, the client connects to the OMA DM server, provided that means for server authentication are possible.**
  * The DP-SP (OMA DM server) consults the OMA DM management object for M2M (M2MMobj), and validates that the provisioning request relates to an ongoing M2M provisioning. The OMA DM back-end system contacts the PVA to verify that the TrE can be trusted and then retrieves the wrapped platform credential for the device, and prepares the M2MSIMMobj for provisioning by the OMA DM Server. .
    * Note: In the current architecture, the DP-SP might be separate from the SHO. If so, possibly the USIM application provisioning must be done in two phases -- first the platform credential is retrieved from the device, validated, and given to the SHO, whereby the SHO provides the USIM application provisioning data encrypted for the device to be provisioned in a secondary stage
    * Note: To limit the security requirements on the OMA DM server it is assumed that the OMA DM server only receives an encrypted blob containing the USIM application information including the IMSI, the key K, an algorithm identifier and possible algorithm constants or algorithm code packaged for the device that can only be opened using the platform key that the M2ME holds in its TrE. OMA DM includes support for XML Encryption and XML Signatures and hence these can be straightforwardly applied. The binary blob could e.g. be a PKCS-formatted envelope for the device, externally formatted e.g. to be further sent to an embedded UICC or other TrE for decryption, validation and deployment.
    * Note: The suggested procedures allow an abstraction at the SHO to be independent of the specifics of TrE. The TrE specifics, e.g. Java or STIP or Native, can be handled by the OMA DM (DM is designed the take care of this and can handle different devices, brands, etc)
    * Note: The use of the PVA assumes a trust relation. If cryptographic certificates are used in this context this assumes the existence of at least a limited PKI and that the DP-SP has root certificates that can be used to verify that the correct (trusted) PVA is performing the TrE check(s).
  * The M2ME receives the M2MSIMMobj and can verify that it comes from the correct SHO and by checking the registration nonce one achieves protection against replay attacks. The encrypted blob with the parameters in decrypted inside the TrE and the parameters are extracted and securely stored.. The blob may also contain device-specific authentication tokens or passwords to authorize the USIM application provisioning activity in that specific device. These tokens may be distributed with the M2ME device, and provided to the SHO by the M2ME user
    * Note: If cryptographic certificates are used in connection with XML signatures the TrE of the M2ME must be configured (e.g. at manufacturing time) with one or several root certificates.
  * The device (OMA-DM client) is assumed to react on the presence of the provisioned USIM application, and locally provision the application to the TrE corresponding to the platform credential.
Note: the SHO may wait to prepare the credentials for the M2ME until being
contacted by the OMA DM backend system. However it seems more advantageous
(e.g. when bulk provisioning is to be performed) to have the SHO prepare the
(wrapped) credentials as result of the registration of the devices and their
respective platform credentials in advance at the SHO. Both approaches are
possible and the final decision can be left to the SHO.
  1. **Trust relations in the USIM Application Provisioning Scenario -- OMA-DM**
**The following text outlines the trust relations and possible cryptographic
components of the provisioning scenario given above:**
  1. OMA DM Bootstrap. A device PIN (given by the M2ME user to the SHO) authorizes the bootstrap activity in the M2M device.
  2. OMA DM Bootstrap. The existence of trust roots on the M2M device may authenticate the validity of the bootstrapped server, e.g. based on a server-authenticated TLS channel for provisioning.
  3. PVA platform credential. The SHO validates the Platform Credential (PfC) of the M2ME (e.g., by verifying the public component of a device key based on PKI mechanisms), and assert that the M2ME (and esp. its TrE) are M2M compliant and trustworthy
  4. The SHO may in an encrypted USIM application provisioning blob also include a device-specific USIM provisioning authorization token. This is similar in intent to the device PIN in 1), but is independent of OMA-DM, and managed by the TrE rather than the device.
  5. The SHO may sign the USIM application provisioning blob by XML signature, providing for the M2ME the means to authenticate the origin of the provisioning packet, provided that suitable trust roots for this activity exist on the M2ME.
  6. The SHO may structure the encryption of the USIM application provisioning blob as an XML Encryption. This format provides additional cryptographic support e.g. in terms of definition of deployed algorithm. It is still expected that the actual decryption of the contents will be handled by the TrE
Note: In short, a PVA-originated limited PKI can bind together all relevant\
communicating parties involved in the USIM provisioning activity. M2ME \--
specific, and e.g.\ M2ME user mediated secrets/passwords may be used to
authorize the activity at the device.
Note: The PVA trust roots that reside on the device may be global, but may
just as well be\ M2M ES--specific or SHO-specific.
  1. **Connectivity Credentials Issuing Authority (CCIA)**
> **CCIA i** s the authority responsible for generation of credentials
> required for temporary access to communications networks for the purpose of
> registration and provisioning of operational network access. This role is
> required where unauthenticated connectivity is not available for this
> purpose. This role could be assumed by a central organisation.
>
> CCIA must support the following functions:
  * Issuing, or receiving from an issuer, of temporary network-access > credentials, e.g. preliminary IMSI numbers and preliminary keys, > for each M2M equipment. These credentials can be used for > authenticated initial temporary 3GPP network access to eventually > enable the USIM/ISIM application provisioning procedure to take > place.
```{=html}
``` \- Helping the M2M equipment supplier (U/S) to configure the M2M >
equipment with the above temporary credentials. Modes of such > configuration
may include:
    -   CCIA generates credentials and sends to ES to embed during
        > manufacture time; or
    -   ES generates and embeds them and sends them to CCIA afterwards;
        > or
    -   ES generates and embeds them and they are communicated to CCIA
        > via the user
```{=html}
``` \- Validation of the temporary-access credentials, when presented by a >
VO after it receives the credentials from a M2M equipment wanting > temporary
network access if the VO is not capable of verifying the > credential itself.
  1. **Platform Validation Authority (PVA)**
> PVA is the authority responsible for validation of credentials used to
> verify the M2M equipment as a trusted platform. Platform here refers to an
> environment of the M2M equipment that must be protected and secured against
> compromises and provide secure execution and storage functionality.
>
> A PVA must support the following functions:
  * Validation of platform credentials (PC) that assert the authenticity > and integrity of the M2M equipment as a platform to hold the > USIM/ISIM application and credentials;
> NOTE: The PC may be created by the Equipment Supplier (ES) and obtained by
> the PVA for future validation when a PC is presented for a validation-
> service requesting entity.
Editor\'s Note: The content and format of a Platform Credential (PC) is FFS.
PC may contain several parts some of which are device-specific and some common
to a group of devices. E.g., (1) an ES public key to act as the root of trust
for verification (public, common), (2) a device-specific private key stored in
the M2ME (secret, device-specific), (3) a certificate issued to the
corresponding public key by the ES (public, device-specific) asserting the
expected system state of the M2ME. In this scenario, PC needs to be obtained
by PVA in advance of the manufacture in a secure manner; is embedded or
initialized in the M2M equipment during manufacture; and can be provided along
with other information during platform validation .
  * Provide the UDP-SP and SHO with information related to the success > or failure of the validation of the M2M equipment.
Editor\'s Note: Whether PVA may also issue platform credential (PC) rather
than only validate the PC is FFS. If PVA issues PC, the role of the PVA could
be performed by one (e.g. OCSP) or more commercial organizations that are
trusted to issue and then later validate such credentials.
> In case remote update of the M2M equipment's SW/FW requires a new PC, the
> PVA must be able to obtain the new PC.
  1. **Regulator (RG)**
> Governmental body or other legislative or regulatory entity governing the
> operation of the terminals, and networks in a country or region.
  1. **Temporary Connectivity Credentials**
> **Note: The 3 prior alternatives (1, 2, and 3) have used various names for
> the credential needed for the M2M equipment to attach initially (or
> temporarily) to visitor operator's network. Terms such as P-IMSI, PIMSI, and
> synthetic credentials were used.**
#### 5.2.5.6 Relationship Models
##### 5.2.5.6.1 Full Relationship Model (Initial Connectivity via 3GPP VNO)
This sub-section describes the relationships that exist between the functional
roles and entities that are described in the previous sub-section.
This sub-section does not describe the network architecture, nor does it make
any assumptions about how the roles should be combined in any physical
implementation.
Figure 12: relationships between the functional roles
The relationships that are numbered on the above diagram are described below.
The numbered lines show logical relationships and do not attempt to show the
physical network connectivity over which the relationships are conducted. The
numbers do not represent any particular sequence of events. Examples of
definitive sequence of events are presented in the subsection on network
architecture.
1 M2ME E/S and CCIA exchange credentials that are required for provisioning
into the M2ME for initial network connectivity. This is a one-time operation.
2 PVA receives, from M2ME E/S, reference credentials required for validation
of the security of the TrE and M2ME. This is a one-time operation
3 M2ME E/S installs credentials for initial connectivity and reference
credentials required for validation of the trustworthiness of the TrE and M2ME
into the M2ME.
4 M2ME E/S supplies the M2ME to the M2ME U/S
5 M2ME U/S takes possession of the M2ME from the M2ME E/S
6 Relationship deleted
7 VNO provides initial 3GPP network connectivity for access to registration
and provisioning services.
8 ICO provides authentication services to the 3GPP VNO
9 ICO provides IP connectivity to the M2ME via the 3GPP VNO and interacts with
the M2ME for authentication and key agreement.
10 ICO and CCIA interact so that the ICO can obtain AVs for initial network
connectivity to the VNO. This happens every time that initial network
connectivity is required by the M2ME, which might be only once in the lifetime
of the M2ME.
11 SHO and PVA interact to validate the security of the M2ME, including the
TrE.
12 SHO and M2ME U/S have a subscription relationship.
13 ICO and DR-SP provide a discovery service to the M2ME, using the VNO's
network..
> 14 Via the VNO's network, the M2ME requests operational MID(s) from the SHO.
> After provisioning of operational MIDs, the SHO provides operational network
> connectivity to the M2ME, including for the purpose of changing subscription
> to a different SHO.
>
> 15 the SHO and DP-SP interact in order to initiate and finalise the process
> of provisioning of operational MIDs to the M2ME
>
> 16 The DP-SP and M2ME interact, using IP connectivity, for the purpose of
> provisioning of operational MIDs to the latter.
>
> 17 The RG has relationships with many of the functional roles for the
> purpose of governing the operation of the terminals, and networks in a
> country or region
>
> 18 The PVA and M2ME interact to perform steps required to validate the M2ME
> prior to the SHO provisioning the MID(s) and SHO-related network access
> credentials into the M2ME.
##### 5.2.5.6.2 Full Relationship Model (Initial Connectivity via N3GP-ICP)
This sub-section describes the relationships that exist between the functional
roles and entities that are described in the previous sub-section, in the case
when the initial connectivity for the M2ME is provided by a N3G-ICP. .
This sub-section does not describe the network architecture, nor does it make
any assumptions about how the roles should be combined in any physical
implementation
Figure 13: Relationships between the functional roles
The relationships that are numbered on the above diagram are described below.
The numbered lines show logical relationships and do not attempt to show the
physical network connectivity over which the relationships are conducted. The
numbers do not represent any particular sequence of events. Examples of
definitive sequence of events are presented in the subsection on network
architecture.
Note: some roles and some relationships are omitted for clarity, e.g., those
for supplying the M2ME and for establishment of the initial connectivity
credentials in the M2ME and in the PVA. They are similar to those in the
previous subsection.
> 1 The N3G-ICP provides non-3GPP connectivity to the M2ME, for initial
> connectivity and thereafter for access to all other entities that require an
> IP connection to the M2ME for registration and provisioning services.
>
> 2 The N3G-ICP directs the M2ME to the registration and discovery services of
> the DR-SP
>
> 3 The DR-SP provides discovery services to enable the M2ME to discover and
> register to the SHO
>
> 4 The PVA provides authentication services for the SHO
>
> 5 The PVA can authenticate the TrE and M2ME on behalf of the SHO
>
> 6 The DP-SP provides provisioning services for the SHO
>
> 7 The DP-SP provides provisioning services to the M2ME on behalf of the SHO
>
> 8 The RG has relationships with many of the functional roles for the purpose
> of governing the operation of the terminals, and networks in a country or
> region
##### 5.2.5.6.3 Simplified Relationship Model
In many real-life scenarios, the relationship model could be simplified due to
the co-ownership of some of the logical roles. Such co-ownership would render
some of the relationships as internal interfaces which would then be out of
scope.
> Examples of co-ownership:
  * SHO and VNO. This is for the case where the M2ME obtains initial connectivity to the same network that is the SHO
  * SHO and DP-SP
  * VNO and ICO
  * ICO and CCIA
  * ICO and DR-SP
  * Combinations of the above examples, on an atomic basis.
#### 5.2.5.7 Network Architecture
This section describes the network architecture that utilizes the roles
defined in Section 5.2.5.5 above. First we will describe the provisional ID
that the M2ME furnishes to the initial access network. Later, we will describe
the network architecture by giving examples of steps taken for the M2ME to be
remotely provisioned with the correct U(I)SIM application and credentials
under the architecture considered.
**[Provisional Connectivity ID (PCID)]{.underline}**
Provisional Connectivity ID (PCID) is a temporary private identity that
uniquely identifies each M2ME. The PCID, where required, needs to be installed
in the M2ME by the supplier in order to allow the M2ME to register in a 3GPP
network without being associated yet with any specific HO. The ideal case is
that the PCID follows the same format as the IMSI and therefore that the VNO
does not have to be M2M-aware in anyway. The "MCC" and "MNC" fields in the
IMSI/PCID will indicate to the VNO SHO which entity it should contact to
obtain authentication vectors to authenticate the PCID with.
The PCID is created by the CCIA. There are several possibilities in CCIA as an
entity in the network architecture:
  1. The ES is its own CCIA, and creates the PCID. The ES then provisions the PCID into the M2ME). .
  2. The CCIA is a third-party entity. The CCIA issues the PCID, and then sends it to the ES, which then provisions it into the M2ME.
When a PCID is presented from the M2ME to a VNO, the ideal case is, as said
above, is that the VNO does not have to be M2M-aware and can contact, on the
basis of the MCC and MNC fields in the PCID/IMSI, the DR-SP for that M2ME and
obtain authentication vectors that can be used to authenticate the M2ME prior
to it being given temporary network access.
Editor\'s Note: The shortage of IMSI numbers could be an open issue to
resolve. This is FFS.
**[Network Interactions for U/ISIM Provisioning in case of Authenticated
Access -- Alternative 1.]{.underline}**
The following steps constitute one set of example procedures whereby the
downloading and provisioning of U(I)SIM on the M2ME can take place where the
M2ME accesses a 3G VNO's network in its initial network access. Thus, the VNO
provides the air interface to the M2ME in this scenario:
  1. The M2ME uses the standard GSM/UMTS principle (GPRS/PS) to decode network information and attaches to the network of any VNO. In the attach message the M2ME sends a PCID to the VNO.
> Note: In order to be able to perform client authentication for initial
> attachment to the VNO's network, the M2ME may need to support an algorithm
> which is shared by all the M2ME's and the VNO. Such an algorithm could be
> MILENAGE, with customization parameters that are common. It is not possible
> to use a proprietary algorithm.
  1. The VNO contacts an ICO. Note that in some cases the ICO may be co-located with the VNO.
  2. The ICO transfers Authentication Vectors (AV's) for the claimed PCID to the VNO. The VNO uses these to authenticate the PCID/M2ME.
  3. If authentication of the PCID/M2ME by the VNO is successful, the VNO provides IP connectivity for the M2ME to be able to reach the DR-SP using such connection. This also requires that the subscription data stored at ICO and related to the PCID must allow access to an APN and the corresponding GGSN which allows connectivity to DR-SP
  4. The M2ME connects to the DR-SP using IP connectivity provided by the VNO network. Concurrently, the ICO forwards the PCID to the DR-SP.
  5. The DR-SP aids the M2ME to find its SHO, or, alternatively, finds the correct SHO for the M2ME.
> Editor's note: Exactly how the DR-SP will aid the M2ME to discover the SHO
> is FFS.
  1. The DR-SP connects to the SHO and registers the M2ME for connection to the SHO's network.
  2. The SHO requests a PVA (or requests the DR-SP to request the PVA) to validate the authenticity and integrity of the M2ME.
  3. The PVA validates the authenticity and integrity of the M2ME.
  4. The PVA sends the validation results back to the SHO.
  5. The SHO, upon receiving a positive validation, contacts a DP-SP and authorizes provisioning of the U(I)SIM application to the M2ME.
  6. The DP-SP downloads a MID object to the M2ME.
  7. The M2ME provisions the downloaded MID into the TrE and reports the success/failure status of the provisioning to the DP-SP.
  8. The DP-SP reports the success/failure status of the provisioning back to the SHO.
Note that the steps described in 1. to 14. above must be further assured of
appropriate types and levels of security. For example, the steps 10. to 14.
involving the downloading and provisioning of the MID may be secured by use of
the OMA DM protocol and the DP-SP (acting as server). In another example, the
steps involving the validation of the M2ME (and/or the TrE) may be done by way
of using the OCSP protocol and the PVA (acting as a server).
The above steps are depicted in the following figure. Note that in this
figure, the dark-green arrows indicate connections between the operators,
service providers, and validation authorities, and black solid arrow indicates
the air interface for the initial network access from the M2ME to the VNO's
network, and the blue dashed arrows indicate the connections between the M2ME
and the ICO via the air interface provided by the VNO's network, and the blue
dotted arrows indicate the connections between the M2ME and the DR-SP, DP-SP
and the PVA, over the air interface of the VNO's network and the IP
connectivity provided by the ICO.
{width="6.75in" height="4.875in"}
Figure 14: Network authentication and MID Provisioning in the M2ME, in the
case of 3G authenticated access (Alternative 1)
**[Network Interactions under one Possible Hosting Scenario]{.underline}**
In many real-life situations, there are only two operators physically present
to provide access and services for an M2ME. They would be an ICO and an SHO.
The following describes an example of network interactions when this is the
case. In such cases, the ICO would also be the VNO that the M2ME initially
accesses. In this case, it would also be reasonable to assume that the role of
the DR-SP would be hosted by the ICO. Separately, we can also envision that in
many real-life cases the role of the PVA and the DP-SP may be hosted by the
SHO.
In what follows, we describe an example of network interactions when the ICO
(VNO) hosts the DR-SP, and the SHO hosts the PVA and the DP-SP. In this case,
the sequence of interactions can be as follows:
  1. The M2ME uses the standard GSM/UMTS principle (GPRS/PS) to decode network information and attaches to the network of an ICO. In the attach message the M2ME sends a PCID to the ICO.
  2. The ICO authenticates the PCID/M2ME using AV's for the PCID.
  3. The ICO provides IP connectivity for the M2ME.
  4. The M2ME contacts the DR-SP hosted by the ICO. The PCID received from the M2ME in its initial attach to the ICO is forwarded to the DR-SP. The DR-SP aids the M2ME to find its SHO, or, alternatively, finds the correct SHO for the M2ME on the M2ME's behalf.
  5. The SHO receives the registration information about the M2ME from the DR-SP hosted by the VNO. After verifying it, the SHO registers the M2ME for connection to the SHO's network.
  6. The PVA hosted by the SHO validates the authenticity and integrity of the TrE and the M2ME.
  7. If the validation of the M2ME TrE and M2ME performed in step 5. above is successful, the DP-SP hosted by the SHO supervises downloading and supervising of a MID object to the M2ME. The M2ME provisions the downloaded MID into the TrE.
{width="6.75in" height="4.875in"}
Figure 15 Network authentication and MID Provisioning in the M2ME in one
hosting scenario
**[Network Interactions for U/ISIM Provisioning in case of Initial Network
Access by a N3G-ICP]{.underline}**
The following interactions would be needed between the nodes in figure 4, for
initial registration and provisioning of U(I)SIM on the M2ME where the M2ME
communicates with a 3G VNO, and the VNO may operate WLAN or DSL access and may
allow unauthenticated (or non-3G authenticated) access to the network for
registration purposes:
  1. The M2ME accesses a N3G-ICP to register itself for the U(I)SIM download/provisioning purposes. The M2ME is either authenticated using a non-3G mechanism (which is out of scope of this document) then granted access upon such authentication, or given unauthenticated access, for access to a network for registration purposes. The M2ME, in its access attempt, sends its PCID to the N3G-ICP.
  2. The N3G-ICP provides a direct IP connection to a DR-SP associated with a SHO. It sends the PCID to the DR-SP.
> After this stage, and until the M2ME connects to the network using SHO's
> U(I)SIM credentials after downloading and provisioning them, all
> communication between the M2ME and the various network entities is done via
> the IP connectivity provided by the N3G-ICP.
  1. The DR-SP aids the M2ME to find its SHO, or, alternatively, finds the correct SHO for the M2ME. The end result is redirection of the M2ME to the SHO.
Editor's note: Exactly how the DR-SP will aid the M2ME to discover the SHO is
FFS.
  1. The DR-SP connects to the SHO and registers the M2ME for connection to the SHO's network.
  2. The SHO requests a PVA to validate the authenticity and integrity of the M2ME.
  3. The PVA validates the authenticity and integrity of the M2ME.
  4. The PVA sends the validation results back to the SHO.
  5. The SHO contacts a DP-SP and authorizes provisioning of the U(I)SIM application to the M2ME.
  6. The DP-SP downloads a MID object to the M2ME.
  7. The M2ME provisions the downloaded MID into the TrE and reports the success/failure status of the provisioning to the DP-SP.
  8. The DP-SP reports the success/failure status of the provisioning back to the SHO\ The following figure depicts the U(I)SIM download/provisioning process as described in the text above.
{width="6.5in" height="3.625in"}
Figure 16: Network authentication and MID Provisioning in the M2ME, in the
case of non-3G initial connectivity access
#### 5.2.5.8 How to change to a new operator
##### 5.2.5.8.1 General
In this section we describe the process used to change the old selected home
operator to a new selected home operator. It is worthwhile to discuss this
situation in a little more depth, since the architecture used in this phase
may be to some degree orthogonal to the architecture presented in the previous
section.
In this section the design principles used for the architecture governing
operator change uis first described, and after this an extended role model is
described followed by a set of architecture proposals.
##### 5.2.5.8.2 Design principles
The following are the design principles proposed to hold for the architecture
used during the operator change procedure:
  * Reuse as much as possible of initial provisioning architecture
  * The new operator should be able to individually verify the integrity of the device just as in the case of initial provisioning
  * It should be possible, from an architectural point of view, to have more than one U(I)SIM MID stored in the device at a single moment. Not more than one USIM MID can be active at any time.
  * The owner of the device should be in control of which U(I)SIM MID in the device that is providing the connectivity
  * The new selection of an SHO should be possible at any time under control of the M2ME U/S.
It is FFS which entity should coordinate the change of operator procedure.
Possible options are:
  * M2M Equipment User/Subscriber (M2ME U/S)
  * Old Selected home Operator (OSHO)
  * New Selected Home Operator (NSHO)
  * Discovery and Registration Service Provider (DR-SP)
##### 5.2.5.8.3 Additions to role model
The role model described in section 5.5 takes a relatively static viewpoint,
since it does not take into account how new and old selected home operators
relate to each other and to the M2M Equipment User/subscriber (M2ME U/S) and
the other roles. This section will aim to describe these issues by first
describing the new roles and then describing the overall relationship.
###### 5.2.5.8.2.1 Old Selected Home Operator
The Old Selected Home Operator (OSHO) is the role that in the beginning of the
process acts a SHO, but after the process of operator change, is considered a
Visited Operator in the context of section 5.5.
###### 5.2.5.8.2.2 New Selected Home Operator
The New Selected Home Operator (NSHO) fulfills the same role as the Selected
Home Operator does in section 5.5.
###### 5.2.5.8.2.3 Relationship between roles
The M2ME U/S has a contract with the OSHO in the beginning of the use case and
a contract with the NSHO at the end of the use case.
Editor\'s Note: It is FFS what the other relationships look like.
##### 5.2.5.8.3 Network architecture
###### 5.2.5.8.3.1 General
In this section we illustrate how the architecture alternative 4 can
facilitate a secure re-provisioning of USIM/ISIM due to a change of the
Selected Home Operator (HO) that an M2ME is subscribed to.
###### 5.2.5.8.3.2 Re-provisioning using connectivity provided by OSHO
One way of doing this is by conducting the re-provisioning using connectivity
provided by the OSHO. In this section, an example of steps for re-provisioning
of a new U(I)SIM MID due to a change of SHO is described as in the following:
19) The M2ME U/S contacts the NSHO and transfers the M2ME's parameters.
20) The M2ME U/S contacts the M2ME and instructs it to perform a re-
provisioning.
21) The NSHO requests the PVA to validate the M2ME.
22) The PVA validates the M2ME.
23) If the validation is successful, the PVA indicates to the NSHO the
successful status of the validation.
24) The NSHO sends its MID to the DP-SP.
25) The DP-SP securely sends the new MID to the M2ME using the connectivity
provided by the OSHO. This should be an atomic step in the sense that the
whole MID is downloaded before any other steps are initiated.
26) Before installing the new MID originating from the NSHO, the M2ME discards
the current AVs and other U(I)SIM credentials corresponding to the OSHO
27) The M2ME sends a message to the OSHO indicating that the M2ME has
discarded the current AVs and other U(I)SIM credentials corresponding to the
OSHO.
28) The OSHO sends an acknowledgment to the M2ME regarding the receipt of the
above message.
29) The M2ME sends the acknowledgement message to the DP-SP, which relays it
to the NSHO. Some privacy filtering may be applied here, to filter out and
shield any sensitive information about the OSHO from the view of the NSHO.
30) The M2ME provisions, with the aid of the DP-SP, the new MID from the NSHO
into the TrE.
31) The DP-SP reports the success/failure status of the provisioning back to
the NSHO.
32) The NSHO sends a message to the DR-SP to register the M2ME as 'subscribing
to' the NSHO, for future discovery queries.
In another variant of the above steps, the U(I)SIM credentials for the OSHO
and that for the NSHO may be pre-provisioned already in the USIM before the
subscription change takes place. In this case, these two separate sets of
credentials need to be strictly separated, and neither of the two HO's
involved in the subscription change shall be allowed to obtain each other's
U(I)SIM credentials. Appropriate HW or SW isolation techniques must be used.
###### 5.2.5.8.3.3 Going back to the pristine state
In this section we describe how the device could change to a new operator by
being rolled back to the pristine state, and then re-do the initial
provisioning phase. The basic idea here is that some entity contacts the M2ME
and instructs it to perform a re-provisioning. This some entity may be the
owner or someone with similar management rights of the device. A description
of the method now follows:
1) The M2ME U/S contacts the NSHO and transfers the M2ME's parameters.
2) The M2ME U/S contacts the M2ME and instructs it to perform a re-
provisioning.
3) The M2ME removes the OSHO's U(I)SIM and returns to the pristine state.
4) The M2ME uses the standard GSM/UMTS principle (GPRS/PS) to decode network
information and attaches to the network of any VNO. In the attach message the
M2ME sends its PCID to the VNO.
5) The VNO contacts an ICO. The ICO transfers Authentication Vectors (AV's)
claimed for the PCID to the VNO, which the VNO uses to authenticate the
PCID/M2ME. Note that in some cases the ICO may be co-located with the VNO.
6) If authentication of the PCID/M2ME by the VNO is successful, the VNO
provides IP connectivity for the M2ME to be able to reach the DR-SP using such
connection. This also requires that the subscription data stored at ICO and
related to the PCID must allow access to an APN and the corresponding GGSN
which allows connectivity to DR-SP
7) The M2ME connects to the DR-SP.
8) The DR-SP aids the M2ME to find the NSHO.\ \ Editor's note: Exactly how the
DR-SP will aid the M2ME to discover the NSHO is FFS.
9) The NSHO requests a PVA to validate the authenticity and integrity of the
M2ME.
10) The PVA validates the authenticity and integrity of the M2ME.
11) The PVA sends the validation results back to the NSHO.
12) The NSHO, upon receiving a positive validation, contacts a DP-SP and
authorizes provisioning of the U(I)SIM MID to the M2ME.
13) The DP-SP downloads a MID object to the M2ME.
14) The M2ME provisions the downloaded MID into the TrE and reports the
success/failure status of the provisioning to the DP-SP.
15) The DP-SP reports the success/failure status of the provisioning back to
the NSHO.
For future enhancements, the M2ME may also be able to download, install and
use a new credential for the initial network access. Once an M2ME has been
provisioned, an updated value for the initial network access credential could
be delivered as a MID to the M2ME for future use in assisting with a SHO re-
provisioning process. This way, the credential would be extracted, stored, and
used exclusively in the TRE of the M2ME.
The initial network access credential could have a lifetime associated with
it. When, during a U(I)SIM re-provisioning process due to change of SHO, the
M2ME senses that its existing initial network access credential is about to
expire, the M2ME may request and receive a new initial network access
credential from a network entity (e.g. a DP-SP or a CCIA, etc). Alternatively,
an appropriate network entity could initiate the replacement of the initial
network access credential.
#### 5.2.5.9 How Alternative 4 addresses the issues that were raised by SA3#49
concerning Alternative 1
Questions are in normal font. Answers are in italic font
  1. Provisioning of the credentials by the Registration Service may be a nightmare.
> _CCIA will have a relationship with ESs for provisioning of credentials for
> initial connectivity. Credentials can be generated by the ES or by the CCIA.
> Also, the PVA will use credentials that validate the security of the TrE
> and/or the M2ME as a platform. These credentials have to be pre-provisioned
> into the M2ME. It is assumed that installation of all these credentials will
> be a normal part of the TrE/M2ME manufacturing process, and will take place
> in a secure environment_.
  1. The operating procedures for the exchange of credentials between the Owner, Registration service and the operator need to be defined. This will be a vital part of this operation. Not sure how this can be addressed in SA3, perhaps there needs to some involvement by GSMA SG in this area?
> _This is addressed at a high level. Possibly Liberty Alliance protocols are
> appropriate_.
  1. When receiving a request from M2M equipment for USIM download, how does the Selected Home Operator know that the USIM download is allowed for this specific M2M equipment?
> _The SHO trusts that the DP-SP would not request USIM download to the M2ME
> unless the DP-SP had confirmation from the M2ME Owner that the Owner had
> chosen the SHO. The platform credentials are validated by the PVA, thereby
> validating the security of the M2ME._
  1. What is the relationship between the Selected Home Operator and the Registration Service?
> _See description of roles and relationships. In this case, it's SHO and DR-
> SP. DR-SP may be owned by the ICO, in which case the roles may be collapsed
> together._
  1. Is it within the scope of the GSMA to operate Registration Service?
> _Operation of DR-SP by a central organization is possible within alternative
> 4, but only if the DR-SP is not owned by the ICO._
  1. Alternative 1 assumes that the USIM/ISIM application resides on the M2M equipment rather than on a UICC. This is a major departure from the well accepted UICC-based security model used in 3GPP systems. It is far from clear that 3GPP is ready to accept a move away from UICC-based solutions.
> _This is not covered by Network Architecture alternatives, but is addressed
> elsewhere in the TR. N.B. this TR is only a study item, to look at
> feasibility._
  1. Alternative 1 makes assumptions about the service requirements that should be addressed by the security solution (e.g. ability to download USIM application over the air, etc.). It is important to note that SA1 has not yet agreed any service requirements for M2M applications.
> _Noted. Other parts of the TR address issues of security._
  1. Alternative 1 assumes that both the registration of the mobile phone to the Home Network via the Registration Service, as well as provisioning of the USIM application and credentials onto the phone by the Home Network will take place without verification of either the trustworthiness or authenticity of the security environments (e.g. UICC, or other hardware/software security devices or environments) on the phone nor the authenticity of the credentials held in such secure environments.
> _Alternative 4 addresses this using credentials for validation of the client
> platform and by defining a PVA._
  1. Alternative 1 assumes that the entity that provisions the downloadable USIM applications and credentials are identical to the selected home network, thereby limiting the flexibility whereby such an entity can be a third-party Provisioning Service provider affiliated with, but independent from, the home network operator.
> _Alternative 4 separates the role of DP-SP from the role of SHO. Alternative
> 4 makes no prior assumptions about ownership of the DP-SP, but says that SHO
> may own the role of DP-SP._
  1. Alternative 1 assumes that the registration and USIM provisioning processes will be conducted whereby the communication between the mobile phone and the various entities involved in these processes will not be protected for privacy or integrity. Since these two processes, especially the USIM provisioning deals with highly sensitive data, there needs to be measures to protect such communication.
> _The need for authentication and secure channels is dealt with in other
> sections of the TR. Those assumptions and issues are not repeated in the
> description of Network Architecture Alternatives._
  1. The download of initial authentication vectors for the P-IMSI, for temporary network access, may not be optimal. It only serves to authenticate the P-IMSI for the purpose of temporary network access until USIM parameters can be download from the Selected Home Operator (SHO). In order to do this though, it seems to require about as much temporary network access as is eventually required with the SHO! Also, unless this authentication of the P-IMSI is also used to authenticate the UE for the purposes of hosting the device, that UE authentication must also later be performed. However, a symmetric protocol is not optimal for UE authentication, as it requires the secure maintenance of a large database of keys on the network side, when this would not be required if an asymmetric UE authentication method were used.
> _This is not addressed in alternative 4. It was discussed in SA3 meetings
> and it was decided that the use of asymmetric UE authentication is not
> suitable for initial or operational 3GPP network access._
  1. The architecture assumes that it is not known at manufacture of the M2M terminal who the Selected Home Operator will be. The architecture should allow for this fact to be known and taken account of by the manufacturer.
> _Alternative 4 includes discovery of the SHO by the UE, using the address-
> resolution services of the DR-SP._
  1. Exactly which problem is solved by the Registration Service?
A. We believe it is useful to consider the requirements below so as to enable
flexibility and modularity in the solutions. In this way, different modules of
a solution could address different requirements, if appropriate.
> _Alternative 4 addresses this requirement by separating out the functional
> roles_
B. Avoid the cost of subscriptions and SIMs "going live" a long time before
the M2M device is activated and the subscription is used, or _(not addressed
in alternative 4)_
C. Avoid the need to make a decision for a particular mobile operator at
manufacturing time ,( _is addressed in alternative 4 by use of DR-SP to
discover the SHO)_ or
D. Avoid the need to insert a SIM in the M2M device when it is being deployed,
_(is addressed by the architecture in alternative 4 and in other parts of the
TR)_ or
E. Enable the owner of the M2M device to change from one operator to another
one without having to handle a SIM while the M2M device is in the field? _The
provisioning process in alternative 4 can be used to request the download of a
new subscription._
```{=html}
``` 14\. It should be made clear which functions in alternative 1 are required
for enabling connectivity and which are required for enabling remote USIM
management.\"
> _This is made clear in alternative 4._
  1. Placement of Registration Service: If registration service is one entity, then all parties have to accept the Registration Service and the interface type. The involved parties would not only be all operators (also those that just forward, i.e. visited operator), but also all the manufacturers of various \"machines\" e.g. cars, parcel companies, etc.
> _The different roles in alternative 1's RS are separated out in alternative
> 4._
  1. Placement of Registration Service: If registration service is one entity, there are some control issues. The registration service would have most likely have a direct interface with HSS and be able to trigger changes of data there. Who is trusted enough to run such a service? On the political side, which country would exercise its legal control over the registration service?
> _In alternative 4, the RS of alternative 1 is split into several functional
> entities. DR-SP may be a centralized entity, in which case it will not
> access any HO's HSS, but Alternative 4 does not make any prior assumptions
> about ownership. CCIA will access a VNO's or ICO's HSS only in the case
> where the CCIA is owned by those NOs._
  1. Placement of Registration Service: If the registration service is one entity, Denial of Service or accidental downtime are having a large business impact.
> _RS is split into different functional entities in alternative 4._
  1. Placement of Registration Service: If a distributed entity, then the manufacturers and visited network have to find out, which registration service is applicable. This may be solved, if one of them hosts the registration service or there is some sort of identity for this. But the issue remains that all manufacturers and visited networks would have to trust all registration services.
> _Alternative 4 includes DR-SP (which may be centrally operated) for
> discovery of the SHO. Establishment of trust in a fully open architecture
> may require, e.g. Liberty Alliance protocols. These provide discovery,
> authentication and a secure communications session._
  1. Placement of Registration Service: Would the registration service be aware of the supported algorithms and hence indirectly or directly be aware what algorithms the operators support? In our view, authentication and key derivation algorithms should be standardised for M2M.
> _This is not addressed in the Network Architecture Alternatives. It may be
> addressed in other parts of the TR_
  1. Scalability: Many machines may be sold in areas where the service is not available, this means, if the manufacturer registers at manufacturing time ALL his machines, then there will be a lot of \"dead data\" in the registration service. To avoid this the registration service may delete old data if not used, but how should it know, if the machine is just waiting on a shelf in a shop to be sold or if it has been shipped to far-far-away country.
> _This is not yet fully addressed in alternative 4. The case of change of the
> HO is addressed in alternative 4 at a high level._
  1. Scalability: The amount of potential interfaces may be an issue since there are many manufacturers and operators that would need a "pipe" to the registration service. This could result in load problems, also all interfaces would need to be tested and validated (like today's roaming interfaces). If the applications include metering, tracking and tracing and pay as you drive, one should consider how many valuable parcels, cars, containers, laptops, metering devices there are, then this could really be a scalability issue. (Synchronised time of activation, amount of devices vs. central registration service, identification of devices)
> _This is not yet addressed in alternative 4 but the alternative does not
> require any entity to be centralized. Interfaces within a distributed
> architecture can use Liberty Alliance protocols, for instance, for
> discovery, session management and security._
  1. The manufacturers may need to change their manufacturing process to enable \"personalization\" at the manufacturing time so that the data for the registration can be send to the registration service. (Cf. the need to ship SIMlock related data from manufacturer to operator today).
> _Noted. In alternative 4, credentials for initial network connectivity can
> be generated by either the ES or a CCIA and distributed from one to the
> other (operators are not involved, unless an operator owns the CCIA).
> Likewise, credentials for validation of the TrE/M2ME platform may be
> generated by either these or a PVA and distributed from one to the other._
  1. Can the machine also unregister (and potentially register again) using the registration service? (e.g. car is sold or parcel is delivered to a user)
> _Alternative 4 includes functionality to allow de-registration with a SHO
> and registration with a new SHO._
  1. Concerns have been raised towards the idea of a non-smartcard based solution and remain unconvinced about the merits of such solutions. In particular a software only based "soft-(U)SIM" seems like a very risky concept. There are two main reasons for our skepticism:\
     * Telenor is far from convinced about the actual attainable security of non-smartcard solutions\
     * From a security managements perspective the introduction of non-smartcard based solutions seems to increase the overall complexity of the security architecture.\ New non-smartcard solutions will probably require new operational policies etc. There is added cost to this and there also seems to be an increased security risk.
> _Noted. The requirements for that have been identified elsewhere in the TR
> and suitable feasibility conclusions will be agreed. The additional
> functionality provided by the PVA to authenticate/validate the
> "trustworthiness" of the M2M-enabled equipment as a whole or at least the
> part that supports the U(I)SIM functions and its management, rather than
> just the U(I)SIM credentials, enhances the security level of the
> architecture._
### 5.2.6 Alternative 5 "Architecture with removable-UICC"
Editor's Note: The "removable UICC" option has to be addressed with the
appropriate architecture. It may turn out that no separate architecture is
needed for this case.
### 5.2.7 Alternative 6
#### 5.2.7.1 General
This contribution clause presents a straight-forward mechanism that solves one
of the most important requirements from M2M operators: i.e. the possibility to
change MNO in M2M equipments over air. This can be achieved without any exotic
requirements on 'virtual operators', 'temporary network connections',
temporary ID:s, registration services etc.
This mechanism is independent on choice of implementation of USIM, be it UICC
based or not.
It is thus also independent on any assumptions on tamper resistance.
#### 5.2.7.2 Principles
Initial provisioning of M2M Equipments is done with already existing methods
or with any new method developed for M2ME manufacturers and/or M2M operators.
The following steps describe the mechanism for change of MNO OTA. Note that
the M2M operator in the following may in fact be an M2ME manufacturer if it is
the case that this is logistically favourable.
1) The M2M operator chooses an initial MNO = MNO~A~ for his M2M operations.
The subscription contract stipulates that the MNO must support a change to
another MNO under certain, specified conditions upon which they have agreed.
2) After initial service has started (or even before it has begun, if agreed
in the contract) the M2M operator may decide to swap to another MNO = MNO~B.~
3) MNO~B~ delivers a list of IMSI to MNO~A~, for all M2ME that shall change
MNO.
4) MNO~A~ changes IMSI in the USIM to the new IMSI obtained from MNO~B~ for
all relevant M2ME, using standardised OTA procedures.
5) MNO~A~ delivers a list to MNO~B~ containing all M2ME with their new IMSI,
subscriber key K, and the associated OTA key.
6) MNO~B~ can now offer services to these M2ME. If it desired MNO~B~ can as an
option later also change the subscriber keys OTA.
#### 5.2.7.3 Requirements
This mechanism depends on the following requirements:
  * The mechanism has to be supported by contractual agreements
  * Involved operators must have a certain trust towards each other
  * All involved operators must support a common AKA. It is proposed that a Milenage profile (Milenage with OP 128 zeroes etc) is prescribed for this.
  * All involved operators must use 3GPP (now partly ETSI SCP) specified OTA procedures (an M2M profile of OTA may be needed)
# 6 Functionality
Editor\'s note: This chapter focuses on needed functionality of the solutions
for the different architectural alternatives including network impacts and
impacts on the USIM/ISIM application. It will be defined later if this chapter
needs to be before the architecture alternatives.
## 6.1 General
In order to ensure that the issues in the sections of the present document on
"use cases" and "identified issues and initial considerations" are adequately
addressed, it is assumed that any operational ecosystem will be equipped with
the following features and security counter-measures.
## 6.2 Lifecycle of MIDs
MIDs should be able to exist in any one of the following lifecycle states:
**Installed** : an instance of a MID has been created and has an entry in the
M2ME\'s registry
**Activated** : an instance of the MID is authorised for operational use.
**Selected** : this state marks the commencement of a session with a MID. Only
an activated MID can be selected.
**De-selected** : this state marks the cessation of a session with a MID.
**Blocked** : an instance of a MID has been temporarily de-activated and is
not available for use. An example of this is when the status of an
application-specific PIN becomes \"blocked\", as described in [TS102 221].
Unblocking of a MID causes it to be restored to the Activated state.
**Retired** : an instance of a MID is permanently unavailable for use, but is
still instantiated in the M2ME. An example of this is where a credential is
permanently deleted but some executable components (i.e. MID Engines) of the
MID that are used by other applications are still active.
**Deleted** : a MID is permanently removed from the M2ME\'s memory. Deletion
may be applied to a MID that is in any of the above lifecycle states.
## 6.3 Contents of a Typical Downloadable MID
A typical downloadable MID would include credentials, executables (including
algorithms and a system of files and access control mechanisms) and data (e.g.
file contents, security policy, etc).
It is possible that the sensitive objects within the MID package could be
encrypted.
The PS and M2ME could conduct a protocol conversation prior to provisioning a
MID, to see which parts of the MID are already available in the TrE. This is
particularly true if MIDs are to be shared in the TrE.
Some standardisation of MID packaging will be necessary, so as to avoid
proprietary implementation by different M2ME ES and DP-PS. OMA DM. Liberty
Alliance protocols such as Advanced Client could be suitable candidates.
## 6.4 Authentication and Key Agreement Functions for Initial Network
Connectivity
Editor\'s Note: This section is to be reviewed after the section on Trusted
Environment has been finalised.
The process of providing initial 3GPP network connectivity to a M2ME should
not require the VNO to support any new functions related to the acquiring of
AVs from an ICO. This requires the ICO to support existing method of providing
AVs, e.g. MAP.
Therefore, standard UMTS AKA functions are required in the M2ME for the
purpose of obtaining initial connectivity to a VNO\'s 3GPP network, prior to
the provisioning of an operational MID for use on the SHO\'s 3GPP network.
Such initial AKA functions in the M2ME would typically include a preliminary
user-identification credential (e.g. a PCID), a shared secret key(s) and
cryptographic algorithm(s).
The objects mentioned above would typically be exchanged between the ES and
the CCIA and pre-provisioned into the M2ME by the ES in a secure facility.
The initial AKA functionality (data and executables) may be stored and/or
executed within the TrE. Bootstrapping credentials may also be provided for
accessing non-3GPP networks, e.g. WLAN, but the precise nature of those
credentials is out of scope.
Future enhancements to the M2ME's AKA functions for initial network
connectivity may include capability to download and replace the existing
initial connectivity credential with a new one.
# 7 Analysis
Editor\'s note: This chapter contains analysis of the alternatives, for
example a threat analysis.
## 7.1 M2M equipment security
Editor\' Note: Comments and original text have to be merged to make a
consistent section.
### 7.1.1 General
Due to issues identified in section 4.1.2, there is a need to have a M2M
equipment providing:
  * secure execution environment
  * secure storage,
  * tamper-resistance
Moreover, it should be possible for operator or third entity to check that all
those requirements are together satisfied by the M2M equipment.
### 7.1.2 M2M equipment with UICC
The smart card is a tamper resistant device. It has a primary role of storing
credentials and performing sensitive cryptographic computations. The smart
card contains hardware and software countermeasures to protect against
invasive and non-invasive attacks performed to retrieve secrets and obtain
sensitive data during execution of computations. For example the smart card
contains physical encapsulation of critical circuitry.
Certification, such as Common Criteria, is a means to guaranty a security
level for an execution environment. Smart card industry is familiar with
certification processes since certification is often mandated in banking to
guaranty security.\ _Comment_ : This is true, but actually the vast majority
of SIM cards are NOT Common Criteria certified.
Smart card benefits from rich experience to provide security and to resist
against software and hardware attacks, e.g. banking, identity, wireless
communications...
Consequently, UICC in M2M equipment is a tamper-resistant device providing
secure execution environment and secure storage for M2M equipment.
### 7.1.3 M2M equipment without UICC
In case of M2M equipment without UICC, there is a need to secure the M2M
equipment.
The following issues can be identified to secure part of the M2M equipment
without UICC:
  * What are the boundaries of the part of the M2M equipment to secure?\ _Comment_ : This can be described. A secure execution environment is certainly required and this, and attendant hardware and software, can help define the boundary.
  * How to describe the means to secure the part of the M2M equipment in order to provide secure storage and secure execution?\ _Comment_ : We note that many new phone processors have secure execution environments, for example TI M-shield and ARM Trustzone processors. There are phones of the market now supporting secure execution environments. There have been phones supporting hardware enforced secure storage for a number of years now
```{=html}
``` \- By means of requirements on the M2M equipment? Or by means of >
specifications defining the security mechanisms to be implemented > in the M2M
equipment?\ > _Comment_ : A high level security architecture and some security
> requirements can do this. Essential components of such security >
requirements for a tamper-resistant trusted environment in a phone > are
relatively well-known too, and are expected to be incorporated > into the TR
relatively easily in the near future.
```{=html}
``` \- In case that there is no specification of the security mechanisms to
implement:
```{=html}
``` \- What will be the level of confidence in the countermeasures of the >
solution against software and physical attacks? All M2M equipments > may not
secure the same functions. Generic tests could not be > applied.\ > _Comment_
: The same is true for smartcards -- there are NO > security requirements on
smartcards standardised in 3GPP at all, > the only thing giving confidence is
the fact that the operator > chooses his smartcard supplier. We can have a
similar approach for > USIM on M2M terminals -- if an operator does not like a
certain > terminal type, they don't accept its USIM as valid. The draft >
architecture in 33.812 would allow for this. In the smartcard > world,
implementation is not specified by 3GPP or ETSI, but the > secure protocols
for remote management are and this could include > adoption of the
specifications of other bodies such as Liberty > Alliance and OMA. It is the
province of other industry and > inter-industry bodies to specify things such
as CC protection > profiles, if required. OMTP also provides some very
comprehensive > requirement specifications for such secure execution
environments.
  * M2M equipments would not have the same level of security\ > _Comment_ : UICCs do not all have the same level of security > either.
```{=html}
``` \- In case that a certification is required:\ _Comment_ : This section
assumes that Common Criteria is the only form of certification -- this is not
the case. There are valid models for self-certification to agreed robustness
rules as is done for terminals supporting Digital Rights Management (DRM)
technology
```{=html}
``` \- What will be the scope of the target of evaluation of the solution > to
secure part of the M2M equipment without UICC?\ > _Comment_ : Taking the term
"target of evaluation" loosely, a TOE > could be semi-formally defined for the
secure execution > environment on a processor supporting this, and attendant
s/w and > h/w (e.g. the secure boot mechanism on the terminal)
  * Do Protection Profiles exist for this type of solution?
  * What is the expertise of companies providing the solution to perform > certification of this type of solution?\ > _Comment_ : Terminal manufacturers that engage in either government > products or in products supporting strong DRM have experience in > evaluating products for robustness of implementation. In addition, > such expertise can also be brought in by recruitment or by > professional services.
```{=html}
``` \- What is the level of security of the secured part of the M2M equipment
against software and physical attacks compared to the security level offered
by the other solutions, and in particular those which are UICC-based?\
_Comment_ : We believe that terminals with an integrated USIM solution can
meet the required levels of security. Further, we do not see that there is any
reason why the terminal cannot in principle be made just as secure as a UICC.
With respect to some forms of side channel attack, e.g. power and timing
analysis, the integrated USIM solution may well provide more resistance than a
UICC due to the higher number of contemporaneous processes masking critical
cryptographic opearations
  * If the selected solution to protect a part of the M2M equipment relies on the addition of a specific hardware element to M2M equipment, what is the benefit compared to UICC-based solutions?\ _Comment_ : The addition of specific hardware elements may not be required. However, even if it is required, the solution would have the advantage over UICC-based solutions of not exposing a physical UICC-ME interface that could be attacked. The solution is also likely to have other advantages, e.g. cost, power consumption, provisioning efficiency, size. In some implementations, an advantage is that it does not require the terminal to support a physical UICC interface. There are use cases in TR33.812 that describe terminals that would not be supplied with a UICC connector as standard
# 8 Summary and conclusions
Editor\'s note: This chapter contains summary and conclusions on the
feasibility of realising the remote management of a USIM/ISIM application on
the M2M equipment or on the UICC. The conclusions take into account potential
requirements on system functionality, including secure provisioning, remote
management and operational aspects.
#