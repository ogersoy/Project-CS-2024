# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
> Version x.y.z
>
> where:
>
> x the first digit:
>
> 1 presented to TSG for information;
>
> 2 presented to TSG for approval;
>
> 3 or greater indicates TSG approved document under change control.
>
> y the second digit is incremented for all changes of substance, i.e.
> technical enhancements, corrections, updates, etc.
>
> z the third digit is incremented when editorial only changes have been
> incorporated in the document.
# Introduction
The present document is the result of a split of TS 23.048 Release 5 between
the generic part and the bearers specific application. The generic part has
been transferred to SCP. The present document is the bearers specific part.
# 1 Scope
The present document defines the remote management of files and applets on the
SIM/USIM/ISIM.
It describes the APDU format for remote management.
Furthermore the document specifies:
\- a set of commands coded according to this APDU structure and used in the
remote file management on the SIM/USIM specified in TS 51.011 [1], TS 31.101
[2], TS 31.102 [3], TS 31.103 [6].
\- a set of commands coded according to this APDU structure and used in the
remote applet management on the SIM/USIM. This is based on ETSI TS 102 226
[4].
The remote APDU structure for SIM/USIM/ISIM applications shall comply with the
one defined in ETSI TS 102 226 [4]. The present document only contains
additional requirements or explicit limitations for SIM/USIM/ISIM
applications.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication > and/or edition number or version number) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 51.011 Release 4: \"Specification of the Subscriber Identity
Module - Mobile Equipment (SIM-ME) interface\".
[2] 3GPP TS 31.101: \"UICC-Terminal Interface; Physical and Logical
Characteristics\".
[3] 3GPP TS 31.102: \"Characteristics of the USIM Application\".
[4] ETSI TS 102 226 V8.3.0: \"Smart Cards; Remote APDU structure for UICC
based applications\".
[5] ISO/IEC 7816-4: \"Information technology - Identification cards -
Integrated circuit cards, Part 4: Organization, security and commands for
interchange\".
[6] 3GPP TS 31.103: \"Characteristics of the IP Multimedia Services Identity
Module (ISIM) application\".
# 3 Definitions and abbreviations
For the purposes of the present document, the abbreviations, terms and
definitions given in ETSI TS 102 226 [4] apply.
# 4 Remote APDU Format
## 4.1 Remote command coding
The SIM/USIM/ISIM Remote command coding shall comply with the Remote command
coding of ETSI TS 102 226 [4].
## 4.2 Response coding
The SIM/USIM/ISIM Response coding shall comply with the Response coding of
ETSI TS 102 226 [4], added features are defined below.
### 4.2.1 (U)SIM specific behaviour for Response Packets (Using SMS-PP)
If PoR is not requested, no data shall be returned by the (U)SIM's RE/RA and
the (U)SIM's RE/RA shall indicate to the terminal to issue a RP-ACK.
If PoR is requested, data shall be returned by the (U)SIM's RE/RA. The
(U)SIM's RE/RA shall indicate to the terminal to issue:
\- a RP-ACK if the response status code octet is '00' or,
\- a RP-ERROR if there is a security error of some kind (see table 5).
The data returned by the (U)SIM is the complete Response Packet to be included
in the User Data part of the SMS-DELIVER-REPORT.
Because the (U)SIM is unable to indicate to the Terminal that the TP-UDHI bit
is to be set, the Sending Entity receiving the Response Packet shall expect
the UDH structure in any event.
If a proof of Receipt is required by the sending entity, the Additional
Response Data sent by the Remote Management Application shall be formatted
according to ETSI TS 102 226 [4].
### 4.2.2 Void
# 5 Remote File Management (RFM)
## 5.1 SIM Remote File Management
Command and Response formats are defined in ETSI TS 102 226 [4]. Nevertheless,
the list of commands defined in ETSI TS 102 226 [4] for Remote File Management
does not apply for SIM application. All the SIM Remote File Management
commands are defined below.
The standardised commands are listed in table 5.1. The commands are as defined
in TS 51.011 [1], except that the SELECT command is extended from the one in
TS 51.011 [1] to include \"SELECT by path\" as defined in ISO/IEC 7816-4 [6].
Table 5.1: SIM Remote File Management Commands
* * *
Operational command SELECT UPDATE BINARY UPDATE RECORD SEEK INCREASE VERIFY
CHV CHANGE CHV DISABLE CHV ENABLE CHV UNBLOCK CHV INVALIDATE REHABILITATE READ
BINARY READ RECORD
* * *
To retrieve the Response parameters/data of a case 4 command the GET RESPONSE
command defined in TS 51.011 [1] shall be issued (Class Byte is \'A0\').
The GET RESPONSE and any case 2 command (i.e. READ BINARY, READ RECORD) shall
only occur once in a command string and, if present, shall be the last command
in the string. The Response Data shall be placed in the Additional Response
Data element of the Response Packet.
## 5.2 USIM Remote File Management
USIM Remote File Management shall comply with ETSI TS 102 226 [4].
The standardised commands are listed in ETSI TS 102 226 [4].
## 5.3 UICC Shared File System Remote File Management
UICC Shared File System Remote File Management shall comply with ETSI TS 102
226 [4].
The standardised commands are listed in ETSI TS 102 226 [4].
## 5.4 ISIM Remote File Management
ISIM Remote File Management shall comply with ETSI TS 102 226 [4].
The standardised commands are listed in ETSI TS 102 226 [4].
# 6 Remote Applet Management
SIM/USIM Remote Applet Management shall comply with ETSI TS 102 226 [4], added
features are defined below.
## 6.1 SIM File System Access Domain Parameter
This parameter indicates the mechanism used to control the applet instance
access to the SIM File System. It is a parameter of the INSTALL [for install]
command described in ETSI TS 102 226 [4].
This parameter shall be used only if the \"SIM File Access and Toolkit
Application Specific Parameters\" TLV object (Tag \'CA\') is present.
* * *
Value Name Support ADD length \'00\' See TS 102 226 [4] - - \'01\' SIM access
mechanism Optional 2 \'02\' to \'FF\' See TS 102 226 [4] - -
* * *
### 6.1.1 SIM Access Mechanism
This mechanism shall be used, if supported, by the framework if the Access
Domain Parameter value is \'01\'. It shall use the Access Domain Data passed
at applet instantiation to define the access conditions fulfilled while the
toolkit applet is running.
The APDU Access Domain Data is a bit map combination of the file access
condition levels described in TS 51.011 [1]. When the bit is set the
associated Access Condition is granted.
The APDU Access Domain Data is coded as follows:
Byte 1:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                ADM4
                                                ADM5
                                                ADM6
                                                ADM7
                                                ADM8
                                                ADM9
                                                ADM10
                                                RFU
* * *
Byte 2:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                ALWays
                                                CHV1
                                                CHV2
                                                RFU
                                                ADM0
                                                ADM1
                                                ADM2
                                                ADM3
* * *
EXAMPLE: Possible combinations of fulfilled Access Conditions are shown below:
* * *
ADD value Applet access condition fulfilled \'00 00\' No access \'00 01\'
ALWays \'00 02\' CHV1 \'00 03\' ALWays and CHV1 \'00 04\' CHV2 \'00 05\'
ALWays and CHV2 \'00 06\' CHV1 and CHV2 : : \'00 10\' ADM0 : : \'00 20\' ADM1
: : \'00 22\' ADM1 and CHV1 : : \'01 00\' ADM4 : : \'40 00\' ADM10 : : \'41
37\' ADM10 and ADM4 and ADM1 and ADM0 and CHV2 and CHV1 and ALWays : :
* * *
# 7 Additional command for push
The PUSH command behaviour shall comply with ETSI TS 102 226 [4]. The specific
behaviour of USIM Toolkit applications is stated below.
## 7.1 USIM specific behaviour for responses using SMS-PP
The behaviour for responses shall comply with ETSI TS 102 226 [4].
As the processing of the PUSH command may result in proactive commands being
issued, the PUSH command result may be sent back in the additional response
data of a response packet using SMS-SUBMIT.
#