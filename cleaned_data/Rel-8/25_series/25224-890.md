# Foreword
This Technical Specification (TS) has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes the Physical Layer Procedures in the TDD mode
of UTRA.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 25.201: \"Physical layer - general description\".
[2] 3GPP TS 25.102: \"UE physical layer capabilities\".
[3] 3GPP TS 25.211: \"Physical channels and mapping of transport channels onto
physical channels (FDD)\".
[4] 3GPP TS 25.212: \"Multiplexing and channel coding (FDD)\".
[5] 3GPP TS 25.213: \"Spreading and modulation (FDD)\".
[6] 3GPP TS 25.214: \"Physical layer procedures (FDD)\".
[7] 3GPP TS 25.215: \"Physical Layer - Measurements (FDD)\".
[8] 3GPP TS 25.221: \"Physical channels and mapping of transport channels onto
physical channels (TDD)\".
[9] 3GPP TS 25.222: \"Multiplexing and channel coding (TDD)\".
[10] 3GPP TS 25.223: \"Spreading and modulation (TDD)\".
[11] 3GPP TS 25.225: \"Physical Layer - Measurements (TDD)\".
[12] 3GPP TS 25.301: \"Radio Interface Protocol Architecture\".
[13] 3GPP TS 25.302: \"Services Provided by the Physical Layer\".
[14] 3GPP TS 25.401: \"UTRAN Overall Description\".
[15] 3GPP TS 25.331: \"RRC Protocol Specification\"
[16] 3GPP TS 25.433: \"UTRAN Iub Interface NBAP Signalling\"
[17] 3GPP TS 25.105: \"UTRA (BS) TDD; Radio transmission and Reception\"
[18] 3GPP TS 25.321: \"MAC protocol specification\"
[19] 3GPP TS 25.303: \"Interlayer Procedures in Connected Mode\"
[20] 3GPP TS 25.402: \"Synchronisation in UTRAN Stage 2\"
# 3 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ACK Acknowledgement
ASC Access Service Class
BCCH Broadcast Control Channel
BCH Broadcast Channel
CCTrCH Coded Composite Transport Channel
CDMA Code Division Multiple Access
CQI Channel Quality Information
CRC Cyclic Redundancy Check
DCA Dynamic Channel Allocation
DL Downlink
DPCH Dedicated Physical Channel
DTX Discontinuous Transmission
E-AGCH E-DCH Absolute Grant Channel
ECSN E-AGCH Cyclic Sequence Number
E-DCH Enhanced Dedicated Channel
E-HICH E-DCH Hybrid ARQ Indicator Channel
ENI E-UCCH Number Indicator
E-PUCH E-DCH Physical Uplink Channel
E-RUCCH E-DCH Random Access Uplink Control Channel
E-UCCH E-DCH Uplink Control Channel
FACH Forward Access Channel
FDD Frequency Division Duplex
HS-DSCH High Speed Downlink Shared Channel
HS-PDSCH High Speed Physical Downlink Shared Channel
HS-SCCH Shared Control Channel for HS-DSCH
HS-SICH Shared Information Channel for HS-DSCH
IMB Integrated Mobile Broadcast
ISCP Interference Signal Code Power
MAC Medium Access Control
MBMS Multimedia Broadcast/Multicast Service
MBSFN MBMS over a Single Frequency Network
MICH MBMS Indicator Channel
MIMO Multiple Input Multiple Output
MS burst MBSFN Special burst
MT burst MBSFN Traffic burst
NACK Negative Acknowledgement
NRT Non-Real Time
P-CCPCH Primary Common Control Physical Channel
PC Power Control
PDSCH Physical Downlink Shared Channel
PICH Paging Indicator Channel
PLCCH Physical Layer Common Control Channel
PRACH Physical Random Access Channel
PUSCH Physical Uplink Shared Channel
RACH Random Access Channel
RL Radio Link
RRC Radio Resource Control
RSCP Received Signal Code Power
RT Real Time
RU Resource Unit
SBGP Special Burst Generation Gap
SBP Special Burst Period
SBSP Special Burst Scheduling Period
S-CCPCH Secondary Common Control Physical Channel
SCH Synchronisation Channel
SCTD Space Code Transmit Diversity
SFN System Frame Number
SIR Signal--to-Interference Ratio
SNPL Serving and Neighbour cell Pathloss
SSCH Secondary Synchronisation Channel
STD Selective Transmit Diversity
TA Timing Advance
TDD Time Division Duplex
TF Transport Format
TFC Transport Format Combination
TFCI Transport Format Combination Indicator
TFCS Transport Format Combination Set
TFRI Transport Format Resource Indicator
TPC Transmit Power Control
TSTD Time Switched Transmit Diversity
TTI Transmission Time Interval
TxAA Transmit Adaptive Antennas
UE User Equipment
UL Uplink
UMTS Universal Mobile Telecommunications System
UTRAN UMTS Radio Access Network
VBR Variable Bit Rate
# 4 Physical layer procedures for the 3.84 Mcps option
## 4.1 General
Sub-clauses 4.2 to 4.13 do not apply to 3.84 Mcps MBSFN IMB operation.
Physical layer procedures for 3.84 Mcps MBSFN IMB operation are described in
sub-clause 4.14.
## 4.2 Transmitter Power Control
### 4.2.1 General Parameters
Power control is applied for the TDD mode to limit the interference level
within the system thus reducing the intercell interference level and to reduce
the power consumption in the UE.
All codes within one timeslot allocated to the same CCTrCH use the same
transmission power, in case they have the same spreading factor.
Table 1: Transmit Power Control characteristics
+----------------------+----------------------+----------------------+ | | Uplink | Downlink | +----------------------+----------------------+----------------------+ | **Power control | Variable | Variable, with rate | | rate** | | depending on the | | | 1-7 slots delay (2 | slot allocation. | | | slot SCH) | | | | | | | | 1-14 slots delay (1 | | | | slot SCH) | | +----------------------+----------------------+----------------------+ | **TPC Step size** | -- | 1dB or 2 dB or 3 dB | +----------------------+----------------------+----------------------+ | **Remarks** | All figures are | | | | without processing | | | | and measurement | | | | times | | +----------------------+----------------------+----------------------+
### 4.2.2 Uplink Control
#### 4.2.2.1 General Limits
During the operation of the uplink power control procedure the UE transmit
power shall not exceed a maximum allowed value which is the lower out of the
maximum output power of the terminal power class and a value which may be set
by higher layer signalling.
Uplink power control shall be performed while the total UE transmit power is
below the maximum allowed output power. In some cases the total UE transmit
power in a timeslot after uplink power control calculation might exceed the
maximum allowed output power. In these cases the calculated transmit power of
all uplink physical channels in this timeslot shall be scaled by the same
amount in dB before transmission. The total UE transmission power used shall
be the maximum allowed output power.
The UTRAN may not expect the UE to be capable of reducing its total transmit
power below the minimum level specified in [2].
#### 4.2.2.2 PRACH
The transmit power for the PRACH is set by higher layers based on open loop
power control as described in [15].
#### 4.2.2.3 DPCH, PUSCH and HS-SICH
The transmit power for DPCH, PUSCH and HS-SICH is set by higher layers based
on open loop power control as described in [15].
In the case that an ACK is being transmitted on the HS-SICH, the UE shall
apply a power offset to the transmit power of the entire HS-SICH. This power
offset shall be signalled by higher layers.
##### 4.2.2.3.1 Gain Factors
Two or more transport channels may be multiplexed onto a CCTrCH as described
in [9]. These transport channels undergo rate matching which involves
repetition or puncturing. This rate matching affects the transmit power
required to obtain a particular E~b~/N~0~. Thus, the transmission power of the
CCTrCH shall be weighted by a gain factor β.
There are two ways of controlling the gain factors for different TFC's within
a CCTrCH transmitted in a radio frame:
\- β is signalled for the TFC, or
\- β is computed for the TFC, based upon the signalled settings for a
reference TFC.
Combinations of the two above methods may be used to associate β values to all
TFC's in the TFCS for a CCTrCH. The two methods are described in sections
4.2.2.3.1.1 and 4.2.2.3.1.2 respectively. Several reference TFC's for several
different CCTrCH's may be signalled from higher layers.
The weight and gain factors may vary on a radio frame basis depending upon the
current SF and TFC used. The setting of weight and gain factors is independent
of any other form of power control. That means that the transmit power P~UL~
is calculated according to the formula given in [15] and then the weight and
gain factors are applied on top of that, cf. [10].
##### 4.2.2.3.1.1 Signalled Gain Factors {#signalled-gain-factors .H6}
When the gain factor _β~j~_ is signalled by higher layers for a certain TFC,
the signalled values are used directly for weighting DPCH or PUSCH within a
CCTrCH. Exact values are given in [10].
##### 4.2.2.3.1.2 Computed Gain Factors {#computed-gain-factors .H6}
The gain factor  _β~j~_ may also be computed for certain TFCs, based on the
signalled settings for a reference TFC:
Let _β~ref~_ denote the signalled gain factor for the reference TFC. Further,
let _β~j~_ denote the gain factor used for the _j_ -th TFC.
Define the variable: {width="1.3194444444444444in" height="0.375in"}
where _RM_ ~i~ is the semi-static rate matching attribute for transport
channel _i_ , _N~i~_ is the number of bits output from the radio frame
segmentation block for transport channel _i_ and the sum is taken over all the
transport channels _i_ in the reference TFC.
Similarly, define the variable {width="1.2361111111111112in" height="0.375in"}
where the sum is taken over all the transport channels _i_ in the _j_ -th TFC.
Moreover, define the variable {width="0.94375in"
height="0.4722222222222222in"}
where _SF~i~_ is the spreading factor of DPCH or PUSCH _i_ and the sum is
taken over all DPCH or PUSCH _i_ used in the reference TFC.
Similarly, define the variable {width="0.8611111111111112in"
height="0.4722222222222222in"}
where the sum is taken over all DPCH or PUSCH _i_ used in the _j_ -th TFC.
The gain factors _β~j~_ for the _j_ -th TFC are then computed as follows:
No quantisation of β~j~ is performed and as such, values other than the
quantised β~j~ given in [10] may be used.
##### 4.2.2.3.2 Out of synchronisation handling
As stated in 4.2.3.4 , the association between TPC commands sent on uplink
DPCH and PUSCH, with the power controlled downlink DPCH and PDSCH is signaled
by higher layers. In the case of multiple DL CCTrCHs it is possible that an UL
CCTrCH will provide TPC commands to more than one DL CCTrCH.
In the second phase of synchronisation evaluation, as defined in 4.4.2.1.2,
the UE shall shut off the transmission of an UL CCTrCH if the following
criteria are fulfilled for any one of the DL CCTrCHs commanded by its TPC:
\- The UE estimates the received dedicated channel burst quality over the last
160 ms period to be worse than a threshold Q~out~, and in addition, no special
burst, as defined in 4.5, is detected with quality above a threshold,
Q~sbout~. Q~out~ and Q~sbout~ are defined implicitly by the relevant tests in
[2]. If the UE detects the beacon channel reception level [10 dB] above the
handover triggering level, then the UE shall use a 320 ms estimation period
for the burst quality evaluation and for the Special Burst detection window.
UE shall subsequently resume the uplink transmission of the CCTrCH if the
following criteria are fulfilled:
\- The UE estimates the received dedicated CCTrCH burst reception quality over
the last 160 ms period to be better than a threshold Q~in~ or the UE detects a
burst with quality above threshold Q~sbin~ and TFCI decoded to be that of the
Special Burst. Q~in~ and Q~sbin~ are defined implicitly by the relevant tests
in [2]. If the UE detects the beacon channel reception level [10 dB] above the
handover triggering level, then the UE shall use a 320 ms estimation period
for the burst quality evaluation and for the Special Burst detection window.
#### 4.2.2.4 E-PUCH
The power of E-PUCH is set based upon the sum of:
  1. An open loop component based upon beacon channel pathloss and on the E-PUCH constant value signalled by higher layers (K~E-PUCH~).
  2. A closed-loop TPC component. One TPC bit is signalled to the UE within each E-AGCH. The TPC command is derived by Node-B.
  3. An adjustment factor (β~e~) accounting for the E-TFC selected by the UE and the HARQ offset.
The transmit power of the E-PUCH is calculated in the UE as follows:
... where:
  * P~e-base~ is a closed-loop quantity maintained by the UE and which is incremented or decremented by a value Δ~e-base~ upon each receipt of a TPC command on E-AGCH. On receipt of a TPC "up" command, P~e-base~ is incremented by Δ~e-base~. On receipt of a TPC "down" command, P~e-base~ is decremented by Δ~e-base~. The TPC step size Δ~e-base~ is configured by higher layers [15].
  * L is a pathloss term derived by higher layers from beacon function physical channel measurements. It may comprise a weighted sum of the instantaneous (L~PCCPCH~) and filtered (L~0~) pathloss measurements (as described in [15])
  * β~e~ is the gain factor derived for the selected E-TFC transport block size, E-PUCH physical resource size, E-PUCH modulation type and HARQ offset according to subclause 4.2.2.4.1.
  * K~E-PUCH~ is the E-PUCH constant value signalled by higher layers [15].
Higher layers in the UE shall use the current calculated E-PUCH power in
conjunction with the current absolute grant (power) value in order to
determine the set of E-TFC's available (see [18]).
When setting the initial transmit power for E-PUCH or following an extended
pause in the reception of TPC commands on E-AGCH, the UE shall set P~e-base~
equal to the average of the I~BTS~ values (see [15]) over the timeslots
configured for E-DCH use. When receipt of TPC commands on E-AGCH recommences,
the TPC commands shall be used to modify P~e-base~ from its previously set
value.
##### 4.2.2.4.1 Gain Factors for E-PUCH
A beta factor _β~e~_ shall be derived by the UE as a function of:
  * the selected E-TFC transport block size
  * the E-PUCH resource occupation in the E-DCH TTI
  * the modulation type (QPSK/16-QAM)
  * the HARQ power offset (see [18])
Higher layers shall provide a set of reference points defining the
relationship between the coderate of E-DCH transmission (λ~e~) and the
relative reference power per resource unit (β~λ~ dB). A set of reference
points is provided separately for each of QPSK and 16-QAM modulation.
The coderate of E-DCH transmission λ~e~ for the selected E-TFC, physical
resource allocation and modulation type is defined as:
... in which S~e~ is the transport block size of the selected E-TFC and R~e~
is the number of physical channel bits output from the physical channel
mapping stage of E-DCH transport channel processing as described in [9].
The maximum and minimum values of λ signalled by higher layers for the
appropriate modulation type are denoted λ~max~ and λ~min~ respectively. For a
given λ~e~ there exists a λ~0~ and a λ~1~ such that:
  * If λ~min~≤λ~e~\λ~e~
  * Else
    * If λ~e~\λ~min~.
    * If λ~e~≥λ~max~ then λ~0~ is the largest signalled λ for which λ\ Q~hsin~, where Q~hsin~ is a quality threshold
defined implicitly by the relevant tests in [2].
Out-of-sync shall be reported using the CPHY-Out-of-Sync-IND primitive. "Out-
of-sync" is generated in the event that, during the last 160ms period, Q~hs~
\ SBSP (special burst scheduling parameter) for downlink transmissions
The default value for both SBGP and SBSP shall be 8.
The Special Burst shall be transmitted using the physical channel with the
lowest physical channel sequence number (_p_) as defined by the rate matching
function in [9].
Special Bursts shall not be transmitted for HS-SCCH and for CCTrCHs mapped to
S-CCPCH or HS-PDSCH in non-Beacon locations, i.e. only DTX shall be applied to
these physical channels.
### 4.5.3 Use of Special Bursts for Initial Establishment / Reconfiguration
Upon initial establishment or reconfiguration for either 160 ms following
detection of in-sync, or until the first transport block is received from
higher layers, both the UE and the Node B shall transmit the special burst for
each CCTrCH mapped to UL DPCH, DL DPCH, PUSCH and PDSCH physical channels.
The Special Burst shall be transmitted using the physical channel with the
lowest physical channel sequence number (_p_) as defined by the rate matching
function in [9].
### 4.5.4 Use of Special Bursts for DTX on Beacon Channels
In the case that a beacon-function physical channel (S-CCPCH or PDSCH) would
be DTX'd, then a Special Burst shall be transmitted on the Beacon Channel in
that frame instead in order to maintain the beacon functionality.
## 4.6 Downlink Transmit Diversity
Downlink transmit diversity for PDSCH, DPCH, P-CCPCH, S-CCPCH, PICH, MICH, HS-
SCCH, HS-PDSCH, E-AGCH, E-HICH and SCH is optional in UTRAN. Its support is
mandatory at the UE.
### 4.6.1 Transmit Diversity for PDSCH, DPCH, HS-SCCH, HS-PDSCH and E-AGCH
The transmitter structure to support transmit diversity for PDSCH, DPCH, HS-
SCCH, HS-PDSCH and E-AGCH transmission is shown in figure 1. Channel coding,
interleaving and spreading are done as in non-diversity mode. The spread
complex valued signal is fed to both TX antenna branches, and weighted with
antenna specific weight factors _w~1\ ~_ and _w~2~_. The weight factors are
complex valued signals (i.e., _w~i~_ = _a~i~_ \+ j _b~i\ ~_), in general.
These weight factors are calculated on a per slot and per user basis.
The weight factors are determined by the UTRAN. Examples of transmit diversity
schemes are given in annex B.
{width="4.263888888888889in" height="2.433333333333333in"}
Figure 1: Downlink transmitter structure to support Transmit Diversity\ for
PDSCH, DPCH, HS-SCCH, HS-PDSCH and E-AGCH transmission (UTRAN Access Point)
### 4.6.2 Transmit Diversity for SCH **and S-CCPCH**
Time Switched Transmit Diversity (TSTD) can be employed as a transmit
diversity scheme for the synchronisation channel and/or S-CCPCH.
#### 4.6.2.1 SCH Transmission Scheme
The transmitter structure to support transmit diversity for SCH transmission
is shown in figure 2. P-SCH and S-SCH are transmitted from antenna 1 and
antenna 2 alternatively. An example for the antenna switching pattern is shown
in figure 3.
{width="4.716666666666667in" height="2.0541666666666667in"}
Figure 2: Downlink transmitter structure to support Transmit Diversity\ for
SCH transmission (UTRAN Access Point)
{width="6.061111111111111in" height="2.3555555555555556in"}
Figure 3: Antenna Switching Pattern (Case 2)
#### 4.6.2.2 S-CCPCH Transmission Scheme
The transmitter structure to support TSTD for S-CCPCH is shown in figure 3a.
The antenna switching pattern is under the control of the Node-B and is not
explicitly known to the UE. Switching may only be performed during the guard
periods between timeslots.
Figure 3a: Downlink transmitter structure to support TSTD\ for S-CCPCH
transmission (UTRAN Access Point)
### 4.6.3 Transmit Diversity for Beacon Channels
When beacon channels use burst type 4, SCTD shall not be applied.
When beacon channels use burst type 1, Space Code Transmit Diversity (SCTD)
for beacon channels may be employed optionally in the UTRAN. The support is
mandatory in the UE except for the case where the UE only supports burst type
4. The use of SCTD will be indicated by higher layers. If SCTD is active
within a cell:
\- SCTD shall be applied to any beacon channel, and
\- the maximum number K~Cell~ of midambles for burst type 1 that are supported
in this cell may be 8 or 16, see [8]. The case of K~Cell~ = 4 midambles is not
allowed for this burst type.
#### 4.6.3.1 SCTD Transmission Scheme
The open loop downlink transmit diversity scheme for beacon channels is shown
in figure 4. Channel coding, rate matching, interleaving and bit-to-symbol
mapping are performed as in the non-diversity mode. In Space Code Transmit
Diversity mode the data sequence is spread with the channelisation codes
{width="0.34652777777777777in" height="0.25in"}and
{width="0.3611111111111111in" height="0.25in"}and scrambled with the cell
specific scrambling code. The spread sequence on code
{width="0.3611111111111111in" height="0.25in"} is then transmitted on the
diversity antenna. The power applied to each antenna shall be equal.
{width="4.817361111111111in" height="2.2256944444444446in"}
Figure 4: Block Diagram of the transmitter SCTD
## 4.7 Random access procedure
The physical random access procedure described below is invoked whenever a
higher layer requests transmission of a message on the RACH. The physical
random access procedure is controlled by primitives from RRC and MAC.
Retransmission on the RACH in case of failed transmission (e.g. due to a
collision) is controlled by higher layers. Thus, the backoff algorithm and
associated handling of timers is not described here. The definition of the
RACH in terms of PRACH Access Service Classes is broadcast on the BCH in each
cell. Parameters for common physical channel uplink outer loop power control
are also broadcast on the BCH in each cell. The UE needs to decode this
information prior to transmission on the RACH. Higher layer signalling may
indicate, that in some frames a timeslot shall be blocked for RACH uplink
transmission.
### 4.7.1 Physical random access procedure
The physical random access procedure described in this subclause is initiated
upon request from the MAC sublayer (see [18] and [19]).
Note: The selection of a PRACH is done by the RRC Layer.
Before the physical random-access procedure can be initiated, Layer 1 shall
receive the following information from the RRC layer using the primitives
CPHY-TrCH-Config-REQ and CPHY-RL-Setup/Modify-REQ.
\- the available PRACH channelization codes (There is a 1-1 mapping between
the channelization code and the midamble shift as defined by RRC) for each
Access Service Class (ASC) of the selected PRACH (the selection of a PRACH is
done by the RRC ). CPHY-RL-Setup/Modify-REQ);
\- the timeslot, spreading factor, and midamble type(direct or inverted) for
the selected PRACH (CPHY-RL-Setup/Modify-REQ);
> \- the RACH Transport Format (CPHY-TrCH-Config-REQ);
\- the RACH transport channel identity (CPHY-TrCH-Config-REQ)
\- the set of parameters for common physical channel uplink outer loop power
control(CPHY-RL-Setup/Modify-REQ).
NOTE: The above parameters may be updated from higher layers before each
physical random access procedure is initiated.
At each initiation of the physical random access procedure, Layer 1 shall
receive the following information from the MAC:
\- the ASC of the PRACH transmission;
\- the data to be transmitted (Transport Block Set).
the selected ASC sub-channel. The ASC subchannel is defined in reference [18].
The value is passed in the PHY-Data-REQ is the C[FN~CELL.~]{.underline}
In addition, Layer 1 may receive information from higher layers, that a
timeslot in certain frames shall be blocked for PRACH uplink transmission.
The physical random-access procedure shall be performed as follows:
1 Randomly select one channelization code from the set of available codes for
the selected ASC. The random function shall be such that each code is chosen
with equal probability.
2 Determine the midamble shift to use, based on the selected channelization
code.
3 Set the PRACH message transmission power level according to the
specification for common physical channels in uplink (see subclause 4.2.2.2).
4 Transmit the RACH Transport Block Set (the random access message) with no
timing advance in the selected sub-channel using the selected channelization
code.
## 4.7A E-RUCCH transmission procedure
Requests for the transmission of an E-RUCCH are controlled by higher layers
[18].
The E-RUCCH random access procedure shall be performed as follows:
1 Randomly select one channelization code from the set of available codes for
E-RUCCH. The random function shall be such that each code is chosen with equal
probability.
2 Determine the midamble shift to use, based on the selected channelization
code.
3 Set the E-RUCCH message transmission power level according to subclause
4.2.2.5.
4 Transmit the E-RUCCH with no timing advance using the selected
channelization code.
## 4.8 DSCH procedure
The physical downlink shared channel procedure described below shall be
applied by the UE when the physical layer signalling either with the midamble
based signalling or TFCI based signalling is used to indicate for the UE the
need for PDSCH detection. There is also a third alternative to indicate to the
UE the need for the PDSCH detection and this is done by means of higher layer
signalling, already described in [8].
### 4.8.1 DSCH procedure with TFCI indication
When the UE has been allocated by higher layers to receive data on DSCH using
the TFCI, the UE shall decode the PDSCH in the following cases:
\- In case of a standalone PDSCH the TFCI is located on the PDSCH itself, then
the UE shall decode the TFCI and based on which data rate was indicated by the
TFCI, the decoding shall be performed. The UE shall decode PDSCH only if the
TFCI word decode corresponds to the TFC part of the TFCS given to the UE by
higher layers.
\- In case that the TFCI is located on the DCH, the UE shall decode the PDSCH
frame or frames if the TFCI on the DCH indicates the need for PDSCH reception.
Upon reception of the DCH time slot or time slots, the PDSCH slot (or first
PDSCH slot) shall start _SFN n+2_ after the DCH frame containing the TFCI,
where n indicates the SFN on which the DCH is received. In the case that the
TFCI is repeated over several frames, the PDSCH slot shall start _SFN n+2_
after the frame having the DCH slot which contains the last part of the
repeated TFCI.
### 4.8.2 DSCH procedure with midamble indication
When the UE has been allocated by higher layers to receive PDSCH based on the
midamble used on the PDSCH (midamble based signalling described in [8]), the
UE shall operate as follows:
\- The UE shall test the midamble it received and if the midamble received was
the same as indicated by higher layers to correspond to PDSCH reception, the
UE shall detect the PDSCH data according to the TF given by the higher layers
for the UE.
\- In case of multiple time slot allocation for the DSCH indicated to be part
of the TF for the UE, the UE shall receive all timeslots if the midamble of
the first timeslot of PDSCH was the midamble indicated to the UE by higher
layers.
\- In case the standalone PDSCH (no associated DCH) contains the TFCI the UE
shall detect the TF indicated by the TFCI on PDSCH.
## 4.9 Node B Synchronisation Procedure over the Air
An option exists to use cell sync bursts to achieve and maintain Node B
synchronisation [20]. This optional procedure is based on transmissions of
cell synchronisation bursts [10] in predetermined timeslots normally assigned
to contain PRACH, according to an RNC schedule. Such soundings between
neighbouring cells facilitate timing offset measurements by the cells. The
timing offset measurements are reported back to the RNC for processing. The
RNC generates cell timing updates that are transmitted to the Node Bs and
cells for implementation.
When Cell Sync Bursts are used to achieve and maintain intercell
Synchronisation there are three distinct phases, with a potential additional
sub-phase involving late entrant cells.
### 4.9.1 Frequency Acquisition Phase
The frequency acquisition phase is used to bring cells of an RNS area to
within frequency limits prior to initial synchronisation. No traffic is
supported during this phase. In this phase cell(s) identified as master time
reference shall transmit cell sync bursts [10] specified by higher layers
continuously, i. e. one in every timeslot. All other cells shall listen for
transmissions and shall perform frequency locking to the transmissions
received. They shall signal completion of frequency acquisition to the RNC and
begin continuous transmission of cell sync bursts specified by higher layers.
### 4.9.2 Initial Synchronisation
For Initial Phase, where no traffic is supported, the following procedure for
initial synchronisation may be used to bring cells of an RNS area into
synchronisation at network start up. In this phase each cell shall transmit
cell sync bursts [10] according to the higher layer command. All cells use the
same cell sync burst code and code offset. Each cell shall listen for
transmissions from other cells. Each cell shall report the timing and received
SIR of successfully detected cell sync bursts to the RNC. The RNC uses these
measurements to adjust the timing of each cell to achieve the required
synchronisation accuracy.
### 4.9.3 Steady-State Phase
The steady-state phase is used to maintain the required synchronisation
accuracy. With the start of the steady-state phase, traffic is supported in a
cell. A procedure that may be used for the steady-state phase involves cell
synch bursts [10] that are transmitted and received without effect on existing
traffic. Higher layers signal the transmit parameters, i.e., when to transmit
which code and code offset, and which transmit power to use. The higher layers
also signal to appropriate cells the receive parameters i. e. which codes and
code offsets to measure in a certain timeslot. Upon determination of errors in
timing, the RNC may adjust the timing of a cell or cells.
### 4.9.4 Late entrant cells
A procedure that may be used for introducing new cells into an already
synchronised RNS involves the one time transmission of a single cell sync
burst [10] (scheduled by higher layers) by all neighbour cells of the late
entrant cell. and received by the late entrant cell. The RNC may use this
information to adjust the late entrant cell sufficiently to allow the cell to
enter steady state phase.
## 4.10 Idle periods for IPDL location method
### 4.10.1 General
To support time difference measurements for location services, idle periods
can be created in the downlink (hence the name IPDL) during which time
transmission of all channels from a Node B is temporarily ceased, except for
the SCH transmission. During these idle periods the visibility of neighbour
cells from the UE is improved.
The idle periods are arranged in a determined pattern according to higher
layer parameters. An idle period has a duration of one time slot. During idle
periods only the SCH is transmitted. No attempt is made to prevent data loss.
In general there are two modes for these idle periods:
\- Continuous mode, and
\- Burst mode.
In continuous mode the idle periods are active all the time. In burst mode the
idle periods are arranged in bursts where each burst contains enough idle
periods to allow a UE to make sufficient measurements for its location to be
calculated. The bursts are separated by a period where no idle periods occur.
The time difference measurements can be performed on any channel. If the
P-CCPCH falls in an idle slot, UTRAN may decide not to transmit the P-CCPCH in
two consecutive frames, the first of these two frames containing the idle
slot. This option is signalled by higher layers.
### 4.10.2 Parameters of IPDL
The following parameters are signalled to the UE via higher layers:
**IP_Status:** This is a logic value that indicates if the idle periods are
arranged in continuous or burst mode.
**IP_Spacing:** The number of 10 ms radio frames between the start of a radio
frame that contains an idle period and the next radio frame that contains the
next idle period. Note that there is at most one idle period in a radio frame.
**IP_Start:** The number of the first frame with idle periods. In case of
continuous mode IP_Start is the SFN of the first frame with idle periods and
in case of burst mode IP_Start defines the number of frames after Burst_Start
with the first frame with idle periods.
**IP_Slot:** The number of the slot that has to be idle [0..14].
**IP_PCCPCH:** This logic value indicates, if the P-CCPCH is switched off in
two consecutive frames. The first of these two frames contains the idle
period.
Additionally in the case of burst mode operation the following parameters are
also communicated to the UE.
**Burst_Start:** Specifies the start of the first burst of idle periods.
256×Burst_Start is the SFN where the first burst of idle periods starts.
**Burst_Length:** The number of idle periods in a burst of idle periods.
**Burst_Freq:** Specifies the time between the start of a burst and the start
of the next burst. 256×Burst_Freq is the number of radio frames between the
start of a burst and the start of the next burst.
### 4.10.3 Calculation of idle period position
In burst mode, burst #0 starts in the radio frame with SFN = 256×Burst_Start.
Burst #n starts in the radio frame with SFN = 256×Burst_Start + _n_
×256×Burst_Freq ( _n_ = 0,1,2, ...). The sequence of bursts according to this
formula continues up to and including the radio frame with SFN = 4095. At the
start of the radio frame with SFN = 0, the burst sequence is terminated (no
idle periods are generated) and at SFN = 256×Burst_Start the burst sequence is
restarted with burst #0 followed by burst #1 etc., as described above.
Continuous mode is equivalent to burst mode, with only one burst spanning the
whole SFN cycle of 4096 radio frames, this burst starts in the radio frame
with SFN = 0. In case of continuous mode the parameter IP_Start defines the
first frame with idle periods.
The position of an idle period is defined by two values: IP_Frame(_x_) and
IP_Slot. IP_Frame(_x_) defines the _x_ ^th^ frame within a burst that contains
the idle period. IP_Slot defines the slot in that frame during which no
transmission takes place except for the SCH.
The actual frame with idle periods within a burst is calculated as follows:
IP_Frame(_x_) = IP_Start + (_x_ -1 _)_ × IP_Spacing with _x_ = 1, 2, 3, ....
If the parameter IP_PCCPCH is set to 1, then the P-CCPCH will not be
transmitted in the frame IP_Frame(_x_) +1 within a burst.
Figure 5 below illustrates the idle periods for the burst mode case, if the
IP_P-CCPCH parameter is set to 0.
{width="6.5784722222222225in" height="3.935416666666667in"}
Figure 5: Idle Period placement in the case of burst mode operation with IP_P-
CCPCH parameter set to 0
## 4.11 HS-DSCH Procedure
### 4.11.1 Link Adaptation Procedure
For HS-DSCH, the modulation scheme and effective code rate shall be selected
by higher layers located within the NodeB. This shall be achieved by
appropriate selection of an HS-DSCH transport block size, modulation format
and resources by higher layers. Selection of these parameters may be based on
CQI reports from the UE.
The overall HS-DSCH link adaptation procedure consists of _two parts:_
_Node B procedure:_
1) The NodeB shall transmit HS-SCCH carrying a UE identity identifying the UE
for which HS-DSCH TTI allocation has been given. In the case of HS-DSCH
transmissions in consecutive TTIs to the same UE, the same HS-SCCH shall be
used for associated signalling.
2) The NodeB transmits HS-DSCH to the UE using the resources indicated in the
HS-SCCH.
3) Upon receiving the HS-SICH from the respective UE, the status report
(ACK/NACK and CQI) shall be passed to higher layers.
_UE procedure:_
1) When indicated by higher layers, the UE shall start monitoring all HS-SCCHs
that are in its HS-SCCH set as signalled to it by higher layers. The
information carried on the HS-SCCH is described in [8].
2) In the case that a HS-SCCH is identified to be correct by its CRC, the UE
shall read the HS-PDSCHs indicated by the HS-SCCH. In the case that a HS-SCCH
is identified to be incorrect, the UE shall discard the data on the HS-SCCH
and return to monitoring.
3) After reading the HS-PDSCHs, the UE shall generate an ACK/NACK message and
transmit this to the NodeB in the associated HS-SICH, along with the most
recently derived CQI.
The mapping of HS-PDSCH channelisation code set and timeslot information
carried by the HS-SCCH for a given HS-DSCH TTI is described in [9].
For a given allocation of HS-PDSCH resources to a UE for a specific HS-DSCH
TTI, the following shall apply:
  * If timeslot information on HS-SCCH indicates two or more timeslots, none of these timeslots shall comprise a beacon channel.
  * If timeslot information on HS-SCCH indicates a single timeslot and this timeslot comprises a beacon channel then:
    * The Node-B shall not indicate SF=1 for any HS-PDSCH resource.
    * The set of HS-PDSCH resources allocated by the Node-B to a UE shall exclusively comprise either beacon function or non-beacon function physical channels. The Node B shall therefore not allocate both beacon function and non-beacon function physical channels within the beacon timeslot to the UE. If the HS-DSCH for a specific HS-DSCH TTI is mapped to the beacon channel, this shall be signalled using _k~start~_ = 1 and _k~stop~_ = 1. For a definition of the first and last allocated channelisation code indices _k~start~_ and _k~stop~_ on HS-SCCH refer to [9].
    * When SCTD antenna diversity is applied to the beacon channel, then the presence of channelisation code $C_{\text{16}}^{(1)}$ within the channelisation code set information on HS-SCCH shall implicitly indicate the presence of channelisation code $C_{\text{16}}^{(2)}$.
### 4.11.2 HS-DSCH Channel Quality Indication Procedure
The channel quality indicator (CQI) provides the NodeB with an estimate of the
code rate that would have maximised the single-transmission throughput of the
previous HS-DSCH transmission if decoded in isolation. The CQI report requires
to be referenced to a given set of HS-PDSCH resources by the NodeB, but note
that the UE is not restricted to making measurements only on these reference
resources when deriving a given CQI. The reference resources for a CQI report
shall be a set of HS-PDSCH resources that were received by the UE in a single
TTI, and contain a complete transport block. These resources will be known to
the NodeB from the relative timings of the HS-SICH carrying the CQI and
previous HS-DSCH transmissions to the UE.
The CQI consists of two fields; a Recommended Transport Block Size (RTBS) and
a Recommended Modulation Format (RMF). The UE shall use the same mapping table
for these fields as is being used for the time slot information and modulation
scheme information fields respectively of the HS-SCCH [18].
The reporting procedure is as follows:
1\. The UE receives a message on an HS-SCCH telling it which resources have
been allocated to it for the next associated HS-DSCH transmission.
2\. The UE reads the associated HS-DSCH transmission, and makes the necessary
measurements to derive a CQI that it estimates would have given it the highest
single-transmission throughput for the allocated resources whilst achieving a
BLER of no more than 10 %.
> BLER, in this context, is defined as the probability that a transport block
> transmitted using the RTBS and RMF is received in error if decoded in
> isolation. For the purposes of this calculation, it shall be assumed that
> the transport block that would be transmitted with these parameters would
> use redundancy version parameters s = 1 and r = 0\. Note that, by this
> definition, a UE shall never report a CQI that corresponds to a code rate
> greater than unity.
>
> Using this definition of BLER, single-transmission throughput shall be
> defined as follows :
single-transmission throughput = (1 -- BLER) × RTBS
  1. The CQI report derived from a given HS-DSCH transmission shall be reported to the NodeB in the next HS-SICH available to the UE following that HS-DSCH transmission, unless that HS-SICH immediately follows the last allocated HS-DSCH timeslot, in which case the subsequent available HS-SICH shall be used by the UE. This HS-SICH may not necessarily be the same HS-SICH that carries the ACK/NACK information for that HS-DSCH transmission. The UE shall always transmit the most recently derived CQI in any given HS-SICH, which may mean that some CQI reports are discarded without being transmitted to the NodeB.
## 4.12 Macro-diversity procedure
When signalled by higher layers, the UE shall combine transmissions on
signalled transport channels from multiple radio links. UTRAN shall only
indicate that a transport channel on a radio link may be combined with a
transport channel on another radio link when those transport channels do not
occupy the same time slot. UTRAN shall transmit identical transport blocks on
the multiple radio links on the transport channels that may be combined. UTRAN
may multiplex onto a CCTrCH other transport channels with transport channels
that can be combined. The TTIs of transmissions that may be combined shall
start at the same SFN on each of the multiple radio links.
## 4.13 E-DCH related procedures
### 4.13.1 ACK/NACK detection
The physical layer in the UE shall detect ACK or NACK contained within the
E-HICH. Which E-HICH is associated with the corresponding E-DCH transmission
is defined in [8].
### 4.13.2 Serving and neighbour cell pathloss metric derivation
The UE shall be capable of measuring the P-CCPCH RSCP of the serving cell and
of intra-frequency neighbour cells in accordance with [11]. The P-CCPCH
transmit power (P~ref~) of the serving cell and of each intra-frequency
neighbour cell in the monitored neighbour cell list shall be signalled by
higher layers to the UE in order that the UE may estimate the mean pathloss to
the serving cell (L~serv~) and to each of the N neighbour cells in the
monitored neighbour cell list (L~1~, L~2~, ... L~N~).
Higher layers shall configure the UE to use SNPL reporting type 1 or SNPL
reporting type 2. In accordance with the SNPL reporting type, the UE shall be
capable of forming a metric corresponding to:
$\Phi = \frac{1}{\sum_{n = 1}^{N}{L_{\text{serv}}L_{n}}}$ {for SNPL reporting
type 1}
$\Phi = \frac{\underset{n = 1\text{.}\text{.}N}{\text{min}}\left( L_{n}
\right)}{L_{\text{serv}}}$ {for SNPL reporting type 2}
The metric φ shall be converted into a logarithmic (dB) value Q and shall be
mapped to a Serving and Neighbour Cell Pathloss (SNPL) index according to
table 1b. The SNPL index is supplied to and used by higher layers (see [18]).
Table 1b: SNPL mapping
* * *
Q = 10*log~10~(φ) SNPL index Q \ {width="3.861111111111111in" height="0.375in"}
>
> ...where, {width="0.7638888888888888in" height="0.2638888888888889in"} is
> the _reference Desired E-PUCH RX power_ signalled by RRC signalling
> according to [15], which is set to the average value of the interference
> signal power level over the timeslots configured for E-DCH use.
>
> {width="0.3333333333333333in" height="0.19375in"}is the power control step
> size Δ~e-base~ configured by higher layers, and {width="0.375in"
> height="0.25in"} is a closed-loop control command.
  * {width="0.1527777777777778in" height="0.18055555555555555in"} is a pathloss term derived from beacon function physical channels. The same as that in 5.1.1.4, if indicated as allowed by higher layers, the UE may optionally take into account pathloss modification which is estimated from the most recently received beacon function physical channel transmission, in addition to the TPC commands when calculating the transmit power.
  * {width="0.20833333333333334in" height="0.25in"}is the gain factor for the selected E-TFC transport block size, the allocated E-PUCH physical resources, and the Modulation type and HARQ power offset according to subclause 5.1.1.6.1. If the smallest E-TFC is selected, {width="0.20833333333333334in" height="0.25in"} equals to the sum of absolute grant value and α~e.~
Higher layers in the UE shall use the current calculated E-PUCH power in
conjunction with the current absolute grant (power) value in order to
determine the set of E-TFC's available.
UE maintains a closed-loop quantity Pe-base for both scheduled transmission
and non-scheduled transmission. {width="0.4166666666666667in"
height="0.25in"}is incremented or decremented by a value Δ~e-base~ upon each
receipt of a TPC command on E-AGCH and on E-HICH. When receipt of TPC commands
on E-AGCH and on E-HICH is in the same sub-frame, UE shall treat one single
TPC command if they are identical and discard them if they are different.
When following an extended pause, which is signalled by higher layers, in the
reception of TPC commands on E-AGCH and on E-HICH, the UE shall set
{width="0.4166666666666667in" height="0.25in"}equal to the _reference Desired
E-PUCH RX power_. When receipt of TPC commands on E-AGCH or on E-HICH
recommences, the TPC commands shall be used to modify
{width="0.4166666666666667in" height="0.25in"}from its previously set value.
##### 5.1.1.6.1 Gain Factors for E-PUCH
A beta factor shall be derived by the UE as a function of:
  * the selected E-TFC transport block size
  * the E-PUCH resource occupation in the E-DCH TTI
  * the modulation type (QPSK/16-QAM)
  * the HARQ power offset
Higher layers shall provide a mapping table containing a set of reference
points, which defines the relationship between the coderate of E-DCH
transmission (λ~e~) and the relative reference power per resource unit (β~λ~
dB). The mapping table is provided separately for each of QPSK and 16-QAM
modulation.
The coderate of E-DCH transmission λ~e~ for the selected E-TFC, physical
resource allocation and modulation type is defined as:
... in which S~e~ is the transport block size of the selected E-TFC and R~e~
is the number of physical channel bits output from the physical channel
mapping stage of E-DCH transport channel processing as described in [9]. The
precision requirement for λ~e~ is 1x10^-4^ and the quantization mode is
truncation.
The maximum and minimum values of λ are the maximum and minimum values of
Reference Code Rate respectively, which are signalled by higher layers for the
appropriate modulation type [15], and are denoted λ~max~ and λ~min~
respectively. For a given λ~e~ there exist a λ~0~ and a λ~1~ such that:
  * If λ~min~≤λ~e~\λ~e~
  * Else
    * If λ~e~\λ~min~.
    * If λ~e~≥λ~max~ then λ~0~ is the largest signalled λ for which λ\ SFN' is the system frame number counting the sub-frames. The system frame
> number of the radio frames (SFN) can be derived from SFN' by
SFN=SFN' div 2, where div is the remainder free division operation.
During a 1.28 Mcps TDD to 1.28 Mcps TDD hand-over the UE shall transmit in the
new cell with timing advance TA adjusted by the relative timing difference ∆t
between the new and the old cell if indicated by higher layers:
TA~new~ = TA~old~ + 2∆t.
#### 5.2.4.1 Out of synchronization handling
Same as that of 3,84 Mcps TDD, cf.[ 4.2.2.3.2 Out of synchronisation
handling.]
### 5.2.5 HS-SICH
If there is associated uplink DPCH or non-scheduled E-PUCH, the initial
transmit timing for the HS-SICH shall be taken from that of the associated
uplink DPCH or non-scheduled E-PUCH. Otherwise, the initial transmit timing
for the HS-SICH shall be taken from that of the last uplink transmission
except UpPCH transmission. The UE shall then adjust the timing of the HS-SICH
according to SS commands transmitted to it on the HS-SCCH or HS-PDSCH. The
step size for these commands shall be signalled to the UE by higher layers.
The UE shall ignore the SS command transmitted on an HS-SCCH order which is an
uplink synchronization establishment command. In the case that there is a gap
of one or more subframes during which no SS commands are received by the UE,
the UE shall adjust the timing of the HS-SICH according to the associated
uplink DPCH or non-scheduled E-PUCH or other uplink channel except UpPCH until
such time as another HS-SCCH transmission or HS-PDSCH with SS command is
received.
### 5.2.6 E-PUCH
Uplink synchronization control procedure for E-PUCH remains the same as that
used for DPCH, cf. 5.2.4 DPCH and PUSCH, using SS commands carried on E-AGCH
or on E-HICH. When receipt of SS commands on E-AGCH and on E-HICH is in the
same sub-frame, UE shall treat one single SS command if they are identical and
discard them if they are different.
If configured with DPCH, the timing of E-PUCH can be directly set to the
timing of the DPCH. If configured with non-scheduled transmission, the timing
of scheduled E-PUCH can be set to the timing of the non-scheduled E-PUCH. If
neither DPCH nor non-scheduled transmission is configured, the timing of
E-PUCH can be set to the timing of other uplink channels except UpPCH.
### 5.2.7 E-RUCCH
The Node B shall measure the received SYNC-UL timing deviation UpPCH~POS~.
UpPCH~POS~ is sent in the FPACH and is represented as an 13 bit number
(0-8191) being the multiple of 1/8 chips which is nearest to received position
of the UpPCH.
Time of the beginning of the E-RUCCH T~TX‑E-RUCCH~ is given by:
T~TX‑E-RUCCH~ = T~RX-E-RUCCH~ --(UpPCH~ADV~ + UpPCH~POS~ -- 8*16 T~C~)
in multiple of 1/8 chips, where
T~TX-\ E-RUCCH~ is the beginning time of E-RUCCH transmission with the UE's
timing,
T~RX-\ E-RUCCH~ is the beginning time of E-RUCCH reception with the UE's
timing if the E-RUCCH was a DL channel,
UpPCH~ADV~ is the timing advance of the UpPCH.
### 5.2.8 Standalone midamble channel
The transmit timing for the standalone midamble channel shall be taken from
that of the last uplink transmission.
## 5.3 Synchronisation procedures
### 5.3.1 Cell search
During the initial cell search, the UE searches for a cell. It then determines
the DwPTS synchronisation, scrambling code and basic midamble code, control
multi-frame synchronisation and then reads the BCH. How cell search is
typically done is described in Annex CA.
For MBSFN FACH, the downlink scrambling codes and basic midamble codes to be
used for non-beacon timeslots are signalled by higher layers.
### 5.3.2 DCH synchronization
The DPCH synchronisation is the same as that of 3.84 Mcps TDD, cf. [4.4.2
Dedicated channel synchronisation].
### 5.3.2A Shared physical channel synchronization
For HS-DSCH and E-PUCH operation without DPCH, the synchronisation procedure
is defined in the subclause.
#### 5.3.2A.1 Synchronisation primitives
##### 5.3.2A.1.1 General
For the shared physical channels, synchronisation primitives are used to
indicate the synchronisation status of radio links, both in uplink and
downlink. The definition of the primitives is given in the following
subclauses.
##### 5.3.2A.1.2 Downlink synchronisation primitives
The UE shall measure any of the following downlink physical channels to
estimate downlink quality.
a) HS-PDSCH
b) HS-SCCH
c) E-AGCH
Layer 1 in the UE shall check the synchronization status of downlink physical
channels. Synchronisation status is indicated to higher layers, using the
CPHY-Sync-IND or CPHY-Out-of-Sync-IND primitives.
The criteria for reporting synchronization status are defined in two different
phases.
The first phase lasts until the downlink shared channel is considered to be
established by higher layers. During this phase, out-of-sync shall not be
reported.in-sync shall be reported using the CPHY-Sync-IND primitive if the
following criterion is fulfilled.
\- At least one downlink physical channel with a CRC attached is received in
the current subframe with correct CRC.
The second phase starts after the downlink shared channel is considered
established by higher layers. During this phase, both out-of-sync and in-sync
are reported as follows.
Out-of-sync shall be reported using the CPHY-Out-of-Sync-IND primitive based
on the synchronization status in an out-of-sync detection window if the
following criterion is fulfilled.The out-of-sync detection window (out-of-sync
window) is configured by higher layers.
\- No downlink physical channel has been received with a correct CRC in the
out-of-sync detection window period.
In the second phase, the first out-of-sync detection window starts when the
second phase starts; after this, the next out-of-sync detection window starts
right after the previous out-of-sync detection window.
In-sync shall be reported using the CPHY-Sync-IND primitive if the following
criteria is fulfilled:
\- At least one downlink physical channel with a CRC attached is received in
the current subframe with correct CRC.
##### 5.3.2A.1.3 Uplink synchronisation primitives
Layer 1 in the Node B shall check synchronisation status of uplink physical
channels. Synchronisation status is indicated to the RL Failure/Restored
triggering function using either the CPHY-Sync-IND or CPHY-Out-of-Sync-IND
primitive.The exact criteria for indicating in-sync/out-of-sync is not subject
to specification.
#### 5.3.2A.2 Radio link monitoring
##### 5.3.2A.2.1 Downlink radio link failure
The downlink shared physical channels are monitored by the UE, to trigger
radio link failure procedures. The downlink radio link failure status is
specified in [15], and is based on the synchronisation status primitives CPHY-
Sync-IND and CPHY-Out-of-Sync-IND, indicating in-sync and out-of-sync
respectively.
##### 5.3.2A.2.2 Uplink radio link failure/restore
The uplink shared physical channels are monitored by the Node B in order to
trigger uplink radio link failure/restore procedures. The uplink radio link
failure/restore status is reported using the synchronisation status primitives
CPHY-Sync-IND and CPHY-Out-of-Sync-IND, indicating in-sync and out-of-sync
respectively.
When the uplink shared physical channel is in the in-sync state, Node B shall
start timer T_RLFAILURE after receiving N_OUTSYNC_IND consecutive out-of-sync
indications. Node B shall stop and reset timer T_RLFAILURE upon receiving
successive N_INSYNC_IND in-sync indications. If T_RLFAILURE expires, Node B
shall indicate to higher layers the uplink shared physical channel is out-of-
sync using the synchronization status primitives. Furthermore, the uplink
shared physical channel state shall be changed to the out-of-sync state.
When the uplink shared physical channel is in the out-of-sync state, after
receiving N_INSYNC_IND successive in-sync indications Node B shall indicate
that the uplink shared physical channel has re-established synchronisation and
the uplink shared physical channel's state shall be changed to the in-sync-
state. The specific parameter settings (values of T_RLFAILURE, N_OUTSYNC_IND,
and N_INSYNC_IND) are configurable, see [16].
### 5.3.3 Synchronization procedure in CELL_FACH state
#### 5.3.3.1 Uplink synchronization status detection
Maintaining of uplink synchronization is not needed in CELL_FACH state, UE
could be out of synchronization after a period of transmission pause.
The uplink synchronization status detection is under control of Node B, which
determines UE's synchronization status according to a timer T-sync. The timer
is UE specific and the parameter is configured by higher layers. Node B
determines the UE out of synchronization when the T-sync timer expires and in
synchronization otherwise. The details of the timer T-sync operation are shown
as below:
\- Initially starting the timer
When Node B receives the UE's uplink E-RUCCH transmission correctly, it will
initially start the timer.
\- Restarting the timer
When Node B receives the UE's any uplink transmission (e.g. E-RUCCH, E-DCH or
HS-SICH) correctly, it will restart the timer.
#### 5.3.3.2 Establishment of uplink synchronization
Node B shall order UE to establish the uplink synchronization via HS-SCCH
order in case that it detects the UE is out of uplink synchronization.
Response to this synchronization establishment command, UE then initiates the
random access procedure, cf [subclause 5.6 Random Access Procedure], which
only involves the UpPCH and the E-RUCCH.
Node B will limit the synchronization delay based on a timer T-protect. If
Node B doesn't receive the E-RUCCH in the synchronization procedure before
T-protect expires, Node B will restart another uplink synchroniztion procedure
via HS-SCCH order. After N-protect successive uplink synchronization attempts,
Node B shall terminate the synchroniztion procedure and indicate an uplink
synchronization failure to higher layers. The specific parameter settings
(values of T-protect and N-protect) are configured by higher layers.
## 5.4 Discontinuous transmission (DTX) procedure
The DTX procedure shall be applied for CCTrCHs mapped to S-CCPCH, UL DPCH, DL
DPCH, PUSCH and PDSCH, if the total bit rate of the CCTrCH differs from the
total channel bit rate of the physical channels allocated to this CCTrCH.
Rate matching is used in order to fill resource units completely, that are
only partially filled with data. In the case that after rate matching and
multiplexing no data at all is to be transmitted in a resource unit the
complete resource unit shall be discarded from transmission (DTX), unless a
Special Burst is transmitted in the RU. This applies also to the case where
only one resource unit is allocated and no data has to be transmitted.
The special burst is transmitted in both consecutive subframes (subframe#1 and
#2). SS Bits may be transmitted in Special Bursts.for each CCTrCH mapped to UL
DPCH, DL DPCH, PUSCH and PDSCH physical channels.
### 5.4.1 Description of Special Bursts
For S-CCPCH, UL DPCH, DL DPCH, PUSCH and PDSCH, the Special Burst has the same
timeslot format as the burst used for data provided by higher layers. If the
timeslot format contains a TFCI field, then the TFCI field shall be filled
with "0" bits. The Special Burst may also carry layer 1 control symbols such
as TPC bits for the purposes of inner-loop power control. The data portions of
the Special Burst are filled with an arbitrary bit pattern.
For S-CCPCH, UL DPCH, DL DPCH, PUSCH and PDSCH, the transmission power of the
special burst shall be the same as that of the substituted physical channel of
the CCTrCH. In the case of uplink physical channels where autonomous spreading
factor change by the UE is permitted by higher layers, the substituted
physical channel is considered to be that which would have been employed for
the lowest non-zero rate TFC within the set of allowed TFC's and the
transmission power of the Special Burst shall again correspond to that of the
physical channel substituted.
### 5.4.2 Use of Special Bursts during DTX
In the case that after link establishment there are no transport blocks
provided for transmission by higher layers for a given CCTrCH mapped to UL
DPCH, DL DPCH, PUSCH or PDSCH physical channels, then a Special Burst shall be
transmitted in the first allocated frame of the transmission pause. If,
including the first frame, there is a consecutive period of Special Burst
Period (SBP) frames without transport blocks provided by higher layers, then
another special burst shall be generated and transmitted at the next possible
frame. This pattern shall be continued until transport blocks are provided for
the CCTrCH by the higher layers. SBP shall be provided by higher layers. The
value of SBP shall be independently specified for uplink and for downlink and
shall be designated as
SBGP (special burst generation period) for uplink transmissions
> SBSP (special burst scheduling parameter) for downlink transmissions
The default value for both SBGP and SBSP shall be 8.
If DTX is applied on S-CCPCH carrying MBSFN FACH, special burst shall be sent
in the first radio frame of each associated TTI.
The Special Burst shall be transmitted using the physical channel with the
lowest physical channel sequence number (_p_) as defined by the rate matching
function in [9].
### 5.4.3 Use of Special Bursts for Initial Establishment / Reconfiguration
Upon initial establishment or reconfiguration for either 160 ms following
detection of in-sync, or until the first transport block is received from
higher layers, both the UE and the Node B shall transmit the special burst for
each CCTrCH mapped to UL DPCH, DL DPCH, PUSCH and PDSCH physical channels.
The Special Burst shall be transmitted using the physical channel with the
lowest physical channel sequence number (_p_) as defined by the rate matching
function in [9].
## 5.5 Downlink Transmit Diversity
Downlink Transmit diversity for PDSCH, DPCH, P-CCPCH, S-CCPCH, PICH, MICH, HS-
SCCH, HS-PDSCH, E-AGCH, E-HICH and DwPCH is optional in UTRAN. Its support is
mandatory at the UE.
### 5.5.1 Transmit Diversity for PDSCH, DPCH, HS-SCCH, HS-PDSCH and E-AGCH
Time Switched Transmit Diversity (TSTD) may be employed as transmit diversity
scheme for downlink DPCH and PDSCH. Closed loop Transmit Diversity may be
employed as transmit diversity scheme for downlink DPCH, HS-SCCH, HS-PDSCH and
E-AGCH.
#### 5.5.1.1 TSTD for PDSCH and DPCH
TSTD can be employed as transmit diversity scheme for PDSCH and downlink DPCH.
An example for the transmitter structure of the TSTD transmitter is shown in
figure 6. Channel coding, rate matching, interleaving, bit-to-symbol mapping,
spreading, and scrambling are performed as in the non-diversity mode. Then the
data is time multiplexed with the midamble sequence. Then, after pulse
shaping, modulation and amplification, DPCH and/or PDSCH is transmitted from
antenna 1 and antenna 2 alternately every sub-frame. Not all DPCHs and/or
PDSCHs in the sub-frame need to be transmitted on the same antenna and not all
DPCHs and/or PDSCHs within a sub-frame have to use TSTD. Figure 7 shows an
example for the antenna switching pattern for the transmission of DPCH/PDSCH
for the case that all physical channels are transmitted with TSTD and are
using the same antenna in the sub-frame.
{width="6.297916666666667in" height="2.2319444444444443in"}
Figure 6: Example for TSTD Transmitter structure for DPCH/PDSCH and P-CCPCH.
{width="5.886111111111111in" height="2.7416666666666667in"}
Figure 7: Example for the antenna swithing pattern for TSTD transmission of
DPCH/PDSCH and P-CCPCH: all physical channels are transmitted with TSTD and
are using the same antenna in the sub-frame.
#### 5.5.1.2 Closed Loop Tx Diversity for PDSCH, DPCH, HS-SCCH, HS-PDSCH and
E-AGCH
The transmitter structure to support transmit diversity for DPCH, PDSCH, HS-
SCCH, HS-PDSCH and E-AGCH transmission is shown in figure 8. Channel coding,
interleaving and spreading are done as in non-diversity mode. The spread
complex valued signal is fed to both TX antenna branches, and weighted with
antenna specific weight factors w~1~ and w~2~. The weight factors are complex
valued signals (i.e., w~i~ = a~i~ + jb~i~ ), in general. These weight factors
are calculated on a per slot and per user basis.
The weight factors are determined by the UTRAN.
{width="4.263888888888889in" height="2.433333333333333in"}
Figure 8: Downlink transmitter structure to support Transmit Diversity\ for
DPCH, PDSCH, HS-SCCH, HS-PDSCH and E-AGCH transmission (UTRAN Access Point) in
1.28 Mcps TDD
### 5.5.2 Transmit Diversity for DwPCH
The transmitter structure to support transmit diversity for DwPCH transmission
is shown in figure 9. DwPCH is transmitted from antenna 1 and antenna 2
alternatively.
{width="4.716666666666667in" height="2.0541666666666667in"}
Figure 9: Downlink transmitter structure to support Transmit Diversity\ for
DwPCH transmission (UTRAN Access Point) in 1.28 Mcps TDD
### 5.5.3 Transmit Diversity for P-CCPCH
TSTD or Space Code Transmit Diversity (SCTD) can be employed as transmit
diversity scheme for the Primary Common Control Physical Channel (P-CCPCH)
#### 5.5.3.1 TSTD Transmission Scheme for P-CCPCH
A block diagram of an example of a TSTD transmitter is shown in figure 6\.
Channel coding, rate matching, interleaving, bit-to-symbol mapping, spreading,
and scrambling are performed as in the non-diversity mode. Then the data is
time multiplexed with the midamble sequence. Then, after pulse shaping and
modulation and amplification, P-CCPCH is transmitted from antenna 1 and
antenna 2 alternately every sub-frame. If there is a DPCH that uses TSTD, TSTD
is also applied to P-CCPCH. An example of the antenna-switching pattern is
shown in figure 7. If TSTD is applied to P-CCPCH, it shall also be applied to
other beacon channels.
### 5.5.4 SCTD Transmission Scheme for Beacon Channels
The use of SCTD will be indicated by higher layers. If SCTD is active within a
cell, SCTD shall be applied to any beacon channel. When beacon channel is used
on dedicated MBSFN frequency, SCTD shall not be applied.
The SCTD open loop downlink transmit diversity scheme for beacon channels is
shown in figure 10, exemplary for the P-CCPCH. Channel coding, rate matching,
interleaving and bit-to-symbol mapping are performed as in the non-diversity
mode. In TxDiversity mode the beacon channel that is allocated to code
{width="0.34652777777777777in" height="0.25in"} is spread with the
channelisation codes {width="0.34652777777777777in" height="0.25in"}and
{width="0.3611111111111111in" height="0.25in"}and scrambled with the cell
specific scrambling code. The beacon channel that is allocated to code
{width="0.3611111111111111in" height="0.25in"} is spread with the
channelisation codes {width="0.3611111111111111in" height="0.25in"}and
{width="0.3611111111111111in" height="0.25in"}and scrambled with the cell
specific scrambling code. The spread sequences on code
{width="0.3611111111111111in" height="0.25in"} and code
{width="0.3611111111111111in" height="0.25in"} are then transmitted on the
diversity antenna. The power applied to each antenna shall be equal.
The use of SCTD will be indicated by higher layers.
{width="5.184027777777778in" height="4.993055555555555in"}
Figure 10: Block Diagram of the transmitter (SCTD) in 1.28 Mcps TDD, exemplary
for the P-CCPCH
## 5.6 Random Access Procedure
The physical random access procedure described below is invoked whenever a
higher layer requests transmission of a message on the RACH. The physical
random access procedure is controlled by primitives from RRC and MAC.
### 5.6.1 Definitions
FPACH~i\ :~ : The i^th^ FPACH number parameter i indicates the position of the
FPACH, the first position is corresponding to the first instance defined in IE
"PRACH system information list)" (see [15]).
L~i~ : Length of RACH transport blocks associated to FPACH~i~ in sub-frames
N~RACHi~ : The number of PRACHs associated to the i^th^ FPACH
n~RACHi~ : The number of a PRACH associated to the i^th^ FPACH ranging from 0
to N~RACHi~-1
M : Maximum number transmissions in the UpPCH
WT : Maximum number of sub-frames to wait for the network acknowledgement to a
sent signature
SFN' : The sub-frame number counting the sub-frames. At the beginning of the
frame with the system frame number SFN=0 the sub-frame number is set to zero.
### 5.6.1A UpPCH sub-channel
In order to separate different ASCs, UpPCH has N sub-channels associated with
it (numbered from 0 to N-1). N may be assigned the value 1,2,4, or 8 by higher
layer signaling.
  * Sub-channel i for UpPCH is defined as the UpPTS timeslot in the sub_frame where SFN' mod N = i.
Where SFN': the sub-frame number counting the sub-frames. At the beginning of
the frame with the system frame number SFN=0 the sub-frame number is set to
zero.
The following figure illustrates the eight possible sub channels for the case,
N=8.
Figure 10A : Example of UpPCH subchannels
### 5.6.2 Preparation of random access
When the UE is in idle mode, it will keep the downlink synchronisation and
read the system information. From the used SYNC-DL code in DwPCH, the UE will
get the code set of 8 SYNC-UL codes (signatures) assigned to UpPCH for random
access.
The description (codes, spreading factor, midambles, time slots) of the
P-RACH, FPACH, S-CCPCH (carrying the FACH transport channel) channel; mapping
relation of RACH and FPACH; ASC (available SYNC-UL sequences and available
sub-channels) sets for each RACH are broadcast on the BCH.
Thus, when sending a SYNC-UL sequence, the UE knows which FPACH resource,
P-RACH resources and S-CCPCH resources will be used for the access.
The physical random access procedure described in this sub-clause is initiated
upon request from the MAC sub-layer (see [18] and [19]).
Before the physical random-access procedure can be initiated, Layer 1 shall
receive the following information by a CPHY-TrCH-Config-REQ from the RRC
layer:
\- The uplink access position by higher layers.
\- The association between which signatures and which FPACHs; which FPACHs and
which PRACHs; which PRACHs and which S-CCPCHs; including the parameter values
for each listed physical channel.
\- The length L~i~ of a RACH message associated to FPACH~i~ can be configured
to be either 1 or 2 or 4 sub-frames corresponding to a length in time of
either 5 ms or 10 ms or 20 ms.
NOTE 1: N~RACHi~ PRACHs can be associated with to FPACH~i~. The maximum
allowed
N~RACHi~ is L~i~.
\- The available UpPCH sub-channels for each Access Service Class (ASC);
\- The set of Transport Format parameters for the PRACH message;
\- The \"M\" maximum number transmissions in the UpPCH;
\- The \"WT\" maximum number of sub-frames to wait for the network
acknowledgement to a sent signature; (1..4) the maximum value supported by
Layer 1 is 4 sub-frames.
\- The initial signature power \"Signature_Initial_Power\";
\- The power-ramping factor Power Ramp Step [Integer];
The above parameters may be updated from higher layers before each physical
random access procedure is initiated.
At each initiation of the physical random access procedure, Layer 1 shall
receive the following information from the higher layers (MAC):
\- The Transport Format to be used for the specific PRACH message;
\- The ASC for the specific Random Access procedure;
\- The data to be transmitted (Transport Block Set).
\- The type of random access
### 5.6.3 Random access procedure
The physical random-access procedure shall be performed as follows:
UE side:
1 Set the Signature Re-Transmission Counter to M.
2 Set the Signature transmission power to Signature_Initial_Power.
3 Based on the type of random access and the transport format indicated by MAC
layer, an E-RUCCH or unique RACH used for the radio access is chosen, and then
randomly select one UpPCH sub-channel and one signature respectively from the
available ones for the given ASC. The random function shall be such that each
of the allowed selections is chosen with equal probability.
4 Transmit the signature at UpPCH or other uplink access position indicated by
higher layers using the selected UpPCH sub-channel at the signature
transmission power. In the case that the Commanded Signature transmission
Power exceeds the maximum allowed value, set the Signature transmission Power
to the maximum allowed power.
5 After sending a signature, listen to the relevant FPACH for the next WT sub-
frames to get the network acknowledgement. The UE will read the FPACH~i~
associated to the transmitted UpPCH only in the sub-frames fulfilling the
following relation:
> (SFN' mod L~i~)=n~RACHi~ ; n~RACHi~=0,..., N~RACHi~-1, Here, FPACH to which
> UE should listen is decided according to the following formula:
FPACH~i~= N mod M,
Where, N denotes the signature number (0..7) and M denotes the maximum number
of FPACHs that defined in the cell.
6 In case no valid answer is detected in the due time: Increase the Signature
transmission power by ∆P~0~ = Power Ramp Step [dB], decrease the Signature Re-
transmission counter by one and if it is still greater than 0, then repeat
from step 3; else report a random access failure to the MAC sub-layer.
7 In case a valid answer is detected in the due time
a) set the timing and power level values according to the indication received
by the network in the FPACH~i~
b) send at the sub-frame coming 2 sub-frames after the one carrying the
signature acknowledgement, the RACH message on the relevant PRACH. In case
L~i~ is bigger than one and the sub-frame number of the acknowledgement is odd
the UE will wait one more sub-frame. The relevant PRACH is the n~RACHi~ ^th^
PRACH associated to the FPACH~i~ if the following equation ifs fulfilled:
(SFN' mod L~i~)=n~RACHi~ ;
Here SFN' is the sub-frame number of the arrival of the acknowledgement.
Both on the UpPCH and on the PRACH, the transmit power level shall never
exceed the indicated value signalled by the network.
Network side:
\- The node B will transmit the FPACH~i~ associated with the received UpPCH
only in the sub-frames fulfilling the following relation:
(SFN' mod L)=n~RACHi~ ; n~RACHi~=0,..., N~RACHi~-1,
> Here, FPACH number i is selected according to the following formula based on
> acknowledged signature:
FPACH~i~= N mod M,
> Where, N denotes the signature number (0..7) and M denotes the maximum
> number of FPACH that defined in the cell.
\- The Node B will not acknowledge UpPCHs transmitted more than WT sub-frames
ago
At the reception of a valid signature:
\- Measure the timing deviation with respect to the reference time T~ref~ of
the received first path in time from the UpPCH and acknowledge the detected
signature sending the FPACH burst on the relevant FPACH.
For examples on the random access procedure refer to Annex CB.
#### 5.6.3.1 The use and generation of the information fields transmitted in
the FPACH
The Fast Physical Access CHannel (FPACH) is used by the Node B to carry, in a
single burst, the acknowledgement of a detected signature with timing and
power level adjustment indication to a user equipment.
The length and coding of the information fields is explained in TS25.221 sub-
clause 5A.3.3.1 .
##### 5.6.3.1.1 Signature Reference Number
The Signature Reference Number field contains the number of the acknowledged
signature. The user equipment shall use this information to verify whether it
is the recipient of the FPACH message.
##### 5.6.3.1.2 Relative Sub-Frame Number
The Relative Sub-Frame Number field indicates the current sub-frame number
with respect to the sub-frame at which the acknowledged signature has been
detected.
The user equipment shall use this information to verify whether it is the
recipient of the FPACH message.
##### 5.6.3.1.3 Received starting position of the UpPCH (UpPCH~POS~)
The _received starting position of the UpPCH (UpPCH~POS~)_ field indirectly
indicates to the user equipment the timing adjustment it has to implement for
the following transmission to the network. The node B computes the proper
value for this parameter according to the following rules: UpPCH~POS~ =
UpPCH~Rxpath~ - UpPCH~TS~
where
UpPCH~Rxpath~: time of the reception in the Node B of the SYNC-UL to be used
in the uplink synchronization process
UpPCH~TS~: time instance 128 chips prior to the start of the UpPCH according
to the Node B internal timing
This information shall be used by the UE to adjust its timing when accessing
the network, as described in section [5.2 \'Uplink Synchronisation\'] .
##### 5.6.3.1.4 Transmit Power Level Command for the RACH message
This field indicates to the user equipment the power level to use for the RACH
message transmission on the FPACH associated P-RACH.
The network may set this value based on the measured interference level (I)
(in dBm) on the specific PRACH and on the desired signal to interference ratio
(SIR) (in dB) on this channel as follows:
_Transmit Power Level Command for the PRACH(_ PRX~PRACH,des~_)_
PRX~PRACH,des~ is the desired receive power level on the PRACH.
The UE shall add to this value the estimated path-loss to compute the power
level to transmit for the PRACH.
### 5.6.3A E-RUCCH procedure
Requests for the transmission of an E-RUCCH are controlled by higher layers
[18].
The available eight SYNC_UL signatures in a cell is devided into two subsets,
one for the access of RACH information and the other for the access of E-RUCCH
information.
When a Node B detects a SYNC_UL signature and acknowledges it on the related
FPACH, it should do some recordings, including the FPACH channel number, the
sub-frame on which the acknowledgement is sent and the SYNC_UL signature
number. When a PRACH or E-RUCCH comes from a UE, the Node B should derive the
related FPACH and the sub-frame on which the acknowledgement was sent for the
UE and find the right record. The signature number in the record can help the
Node B know the access type.
Random access procedure for enhanced uplink is basically same as random access
procedure in subclause 5.6.3, only adding some new definitions.
L~iE~ is the Length of E-RUCCH information transport blocks associated to
FPACHi in sub-frames.
N~RACHi~ is the number of PRACHs associated to the ith FPACH.
N~E-RUCCHi~ is the number of E-RUCCHs associated to the ith FPACH and
N~E-RUCCHi~ equals to $\text{min}\left{ N_{\text{RACHi}},L_{\text{iE}}
\right}$.
When SF of PRACH code equals to 16, L~iE~ will be 2, otherwise L~iE~ will be
1。
When SF of PRACH code equals to 4, SF of E-RUCCH will be 8, otherwise E-RUCCHs
has the same SF with PRACH.
When n~E-RUCCHi~ equals to n~RACHi~, E-RUCCH will share the same code resource
with PRACH. And when SF of PRACH code equals to 4, the code resource assigned
to PRACH including two codes (code i and code i+1) of SF 8, E-RUCCH can use
the ith code of SF 8.
If FPACH~i~ sent an acknowledgement for E-RUCCH information, the sub-frames on
which an acknowledgement is sent on FPACHi is fulfilling the following
relation:
(SFN' mod L~iE~)=n~E-RUCCHi~ ; n~E-RUCCHi~=0,..., N~E-RUCCHi~-1,
Where, SFN' is the sub-frame number of the acknowledgement on FPACH
Accordingly, the code resource assigned to PRACH may be used by PRACH or
E-RUCCH, we should make two prescript avoiding the collision between PRACH and
E-RUCCH.
When Node B sent a FPACH~i~ for $\text{PRACH}_{\text{nRACHi}}$ in sub frame
K，Node B could not send a FPACH~i~ for $E - \text{RUCCH}_{n_{E -
\text{RUCCHi}}}$ before sub frame K+L~i~；
When Node B sent a FPACH~i~ for $E - \text{RUCCH}_{n_{E - \text{RUCCHi}}}$ in
sub frame K，Node B could not send a FPACHi for
$\text{PRACH}_{\text{nRACHi}}$before sub frame K+L~iE~。
The interval between the acknowledgement on FPACH and transmission of E-RUCCH
is fixed for a UE. The UE will send at the sub-frame coming 2 sub-frames after
the one carrying the signature acknowledgement. In case L~iE~ is bigger than
one and the sub-frame number of the acknowledgement is odd the UE will wait
one more sub-frame.
The transmission power and the transmission timing are set according to
subclause 5.1.1.7 and 5.2.7 respectively.
### 5.6.4 Random access collision
When a collision is very likely or in bad propagation environment, the Node B
does not transmit the FPACH or cannot receive the SYNC-UL. In this case, the
UE will not get any response from the Node B. Thus the UE will have to adjust
its Tx time and Tx power level based on a new measurement and send a SYNC-UL
again after a random delay.
Note that at each (re-)transmission, the SYNC-UL sequence and the UpPCH sub-
channel will be randomly selected again by the UE.
Note: Due to the two-step approach a collision most likely happens on the
UpPCH. The resources allocated to PRACH and E-RUCCH are virtually collision
free. This two-step approach will guarantee that the RACH resources can be
handled with conventional traffic on the same UL time slots.
## 5.7 Node B Synchronisation Procedure over the Air
An option exists to use the regular DwPCH transmissions to achieve and
maintain Node B synchronisation [20]. This optional procedure is based on
measurements of DwPCHs from neighbouring cells according to an RNC schedule.
The timing offset measurements are reported back to the RNC for processing.
The RNC generates cell timing updates that are transmitted to the Node Bs and
cells for implementation (common with the 3.84 Mcps TDD option). Alternatively
the RNC may indicate that the NodeB shall autonomously adjust the cell
timings. Two distinct phases can be distinguished for Node B synchronisation
over the air, with a potential additional sub-phase involving late entrant
cells.
### 5.7.1 Initial Synchronisation
Common with 3.84 Mcps TDD, see [4.9.2 Initial Synchronisation], however, the
regular DwPCHs are used as cell sync bursts.
### 5.7.2 Steady-State Phase
Common with 3.84 Mcps TDD, see [4.9.3 Steady-State Phase], however, the
regular DwPCHs are used as cell sync bursts. If the NodeB adjusts the cell
timings autonomously, it shall take into account the propagation delay,
signaled by the RNC.
### 5.7.3 Late entrant cells
A procedure that may be used for introducing new cells into an already
synchronised RNS involves the continuous measurement of the DwPCHs of the
neighbouring cells by the late entrant cell. The RNC may use this information
to adjust the late entrant cell sufficiently to allow the cell to enter steady
state phase.
## 5.8 Idle periods for IPDL location method
### 5.8.1 General
To support time difference measurements for location services, idle periods
can be created in the downlink (hence the name IPDL) during which time
transmission of the DwPCH from a Node B is temporarily ceased. During these
idle periods the visibility of neighbour cells from the UE is improved.
The idle periods are arranged in a determined pattern according to higher
layer parameters. An idle period has a duration of one DwPTS.
In general there are two modes for these idle periods:
\- Continuous mode, and
\- Burst mode
In continuous mode, the idle periods are active all the time. In burst mode
the idle periods are arranged in bursts where each burst contains enough idle
periods to allow a UE to make sufficient measurements for its location to be
calculated. The bursts are separated by a period where no idle periods occur.
The time difference measurements can be performed on any channel.
### 5.8.2 Parameters of IPDL
The following parameters are signalled to the UE via higher layers:
**IP_Status:** This is a logic value that indicates if the idle periods are
arranged in continuous or burst mode.
**IP_Spacing:** The number of 10 ms radio frames between the start of a radio
frame that contains an idle period and the next radio frame that contains the
next idle period.
**IP_Start:** The number of the first frame with idle periods. In case of
continuous mode IP_Start is the SFN of the first frame with idle periods and
in case of burst mode IP_Start defines the number of frames after Burst_Start
with the first frame with idle periods.
**IP_Sub:** Indicates whether the idle period is to occur in the odd, the even
or both the odd and even 5 ms sub-frames of the 10 ms idle frame.
Additionally in the case of burst mode operation the following parameters are
also communicated to the UE.
**Burst_Start:** Specifies the start of the first burst of idle periods.
256×Burst_Start is the SFN where the first burst of idle periods starts.
**Burst_Length:** The number of idle periods in a burst of idle periods.
**Burst_Freq:** Specifies the time between the start of a burst and the start
of the next burst. 256×Burst_Freq is the number of radio frames between the
start of a burst and the start of the next burst.
### 5.8.3 Calculation of idle period position
In burst mode, burst #0 starts in the radio frame with SFN = 256×Burst_Start.
Burst #n starts in the radio frame with SFN = 256×Burst_Start + _n_
×256×Burst_Freq ( _n_ = 0,1,2, ...). The sequence of bursts according to this
formula continues up to and including the radio frame with SFN = 4095. At the
start of the radio frame with SFN = 0, the burst sequence is terminated (no
idle periods are generated) and at SFN = 256×Burst_Start the burst sequence is
restarted with burst #0 followed by burst #1 etc., as described above.
Continuous mode is equivalent to burst mode, with only one burst spanning the
whole SFN cycle of 4096 radio frames, this burst starts in the radio frame
with SFN = 0. In case of continuous mode the parameter IP_Start defines the
first frame with idle periods.
The DwPCH, that has to be idle, is defined by two values: IP_Frame(_x_) and
IP_Sub. IP_Frame(_x_) defines the _x_ ^th^ frame within a burst in which
subframe with the number IP_Sub has to be switched off.
The actual frame with idle periods within a burst is calculated as follows:
IP_Frame(_x_) = IP_Start + (_x_ -1 _)_ × IP_Spacing with _x_ = 1, 2, 3, ....
Figure 11 below illustrates the idle periods for the burst mode which shows
the case that both subframes within each frame have DwPTS as an idle period.
Figure 11: Idle periods of burst mode for 1.28Mcps TDD
## 5.9 HS-DSCH Procedure in CELL_DCH state
### 5.9.1 Link Adaptation Procedure
For HS-DSCH, the modulation scheme and effective code rate shall be selected
by higher layers located within the Node B. This shall be achieved by
appropriate selection of an HS-DSCH transport block size, modulation format
and resources by higher layers. If the UE is configured in MIMO mode, higher
layers may select the number of data streams, i.e. single or dual stream HS-
DSCH transmission, and the transport block size, modulation format and
resources for each stream. The Node B shall decide the number of data streams
based on the uplink channel estimation and CQI reports from the UE. If UE
supports multi-carrier HS-DSCH reception, higher layers may select multiple
carriers to transfer data. Carriers selection may be based on CQI reports from
the UE. If UE supports multi-carrier HS-DSCH transmission, UE shall report the
CQI information of every carrier via HS-SICH.
The overall HS-DSCH link adaptation procedure consists of _two parts:_
_Node B procedure:_
1) The NodeB transmits HS-SCCH carrying a UE identity identifying the UE to
which HS-DSCH TTI is to be granted. In case of HS-DSCH transmissions in
consecutive TTIs to the same UE, the same HS-SCCH shall be used for associated
signalling. If the UE is configured in MIMO mode, the Node B shall determine
appropriate HS-SCCH type for single or dual stream HS-DSCH transmission. If UE
supports multi-carrier HS-DSCH reception, above HS-SCCH detection procedure
applied on each independent carriers.
2) The NodeB transmits HS-DSCH to the UE using the grant indicated in the HS-
SCCH. If UE supports multi-carrier HS-DSCH reception, the mapping relation
between HS-SCCH and its associated HS-DSCH is set by higher layers.
3) Upon receiving the HS-SICH from the respective UE, the status report
(ACK/NACK and CQI) shall be passed to higher layers. If UE supports multi-
carrier HS-DSCH reception, the mapping relation between HS-SICH and its
associated HS-DSCH is set by higher layers.
_UE procedure:_
1) When indicated by higher layers, the UE shall start monitoring all HS-SCCHs
that are in its HS-SCCH set as signalled to it by higher layers. The
information carried on the HS-SCCH is described in [8]. If UE supports multi-
carrier HS-DSCH reception, the monitoring HS-SCCH set is signalled by higher
layers.
2) In the case that a HS-SCCH is identified to be correct by its CRC, the UE
shall read the HS-PDSCHs indicated by the HS-SCCH. If the UE is configured in
MIMO mode, UE may acquire HS-PDSCH resource allocation information of each
stream according to the associated HS-SCCH. If UE supports multi-carrier HS-
DSCH reception, UE may acquire HS-PDSCH resource allocation information of
each carrier according to the associated HS-SCCHs, the mapping relation
between every HS-SCCH and its associated HS-PDSCH is signalled by higher
layers. In the case that a HS-SCCH is identified to be incorrect, the UE shall
discard the data on the HS-SCCH and return to monitoring.
3) After reading the HS-PDSCHs, the UE shall generate an ACK/NACK message and
transmit this to the NodeB in the associated HS-SICH, along with the most
recently derived CQI. If the UE is configured in MIMO mode, the CQI and
ACK/NACK of each stream are transferred via the associated HS-SICH. If UE
supports multi-carrier HS-DSCH reception, the CQI and ACK/NACK of every
carrier are transferred via individual HS-SICH.
The mapping of HS-PDSCH channelisation code set and timeslot information
carried by the HS-SCCH for a given HS-DSCH TTI is described in [9].
For a given allocation of HS-PDSCH resources to a UE for a specific HS-DSCH
TTI, the following shall apply:
  * If timeslot information on HS-SCCH indicates two or more timeslots, none of these timeslots shall comprise a beacon channel.
  * If timeslot information on HS-SCCH indicates a single timeslot and this timeslot comprises a beacon channel then:
    * The Node-B shall not indicate SF=1 for any HS-PDSCH resource.
    * The set of HS-PDSCH resources allocated by the Node-B to a UE shall exclusively comprise either beacon function or non-beacon function physical channels. The Node B shall therefore not allocate both beacon function and non-beacon function physical channels within the beacon timeslot to the UE. If the HS-DSCH for a specific HS-DSCH TTI is mapped to the beacon channel, this shall be signalled using _k~start~_ = 1 and _k~stop~_ = 1. For a definition of the first and last allocated channelisation code indices _k~start~_ and _k~stop~_ on HS-SCCH refer to [9].
    * When SCTD antenna diversity is applied to the beacon channel, then the presence of channelisation code $C_{\text{16}}^{(1)}$ within the channelisation code set information on HS-SCCH shall implicitly indicate the presence of channelisation code $C_{\text{16}}^{(2)}$.
### 5.9.2 HS-DSCH Channel Quality Indication Procedure
For the HS-SICH associated to the HS-SCCH command for allocation or release of
the semi-persistent HS-PDSCH resources and HS-SCCH command for activation or
deactivation of DRX and the HS-SICH associated to HS-SCCH type1 or HS-SCCH
type 4 or HS-SCCH type 8 with transport block size information set to all
zeros, UE shall feedback ACK and CQI on HS-SICH with RTBS equals to zero.
The channel quality indicator (CQI) provides the Node B with an estimate of
the code rate that would have maximized the single-transmission throughput of
the previous HS-DSCH transmission if decoded in isolation. The CQI report
requires to be referenced to a given set of HS-PDSCH resources by the Node B,
but note that the UE is not restricted to making measurements only on these
reference resources when deriving a given CQI. The reference resources for a
CQI report shall be a set of HS-PDSCH resources that were received by the UE
in a single TTI, and contain a complete transport block. These resources will
be known to the Node B from the relative timings of the HS-SICH carrying the
CQI and previous HS-DSCH transmissions to the UE.
The CQI consists of two fields; a Recommended Transport Block Size (RTBS) and
a Recommended Modulation Format (RMF). The UE shall use the same mapping table
for these fields as is being used for the time slot information and modulation
scheme information fields respectively of the HS-SCCH [18]. If the UE is
configured in MIMO mode, the HS-SICH shall consists of the CQI reports of each
stream, i.e. the RTBS and RMF of each stream.
The reporting procedure is as follows:
1\. The UE receives a message on an HS-SCCH telling it which resources have
been allocated to it for the next associated HS-DSCH transmission.
2\. The UE reads the associated HS-DSCH transmission, and makes the necessary
measurements to derive a CQI that it estimates would have given it the highest
single-transmission throughput for the allocated resources whilst achieving a
BLER of no more than 10 %. If the UE is configured in MIMO mode, the CQI would
have given the highest single-transmission throughput for each stream
respectively in the allocated resources whilst achieving BLER of each stream
of no more than 10%.
> BLER, in this context, is defined as the probability that a transport block
> transmitted using the RTBS and RMF is received in error if decoded in
> isolation. For the purposes of this calculation, it shall be assumed that
> the transport block that would be transmitted with these parameters would
> use redundancy version parameters s = 1 and r = 0\. Note that, by this
> definition, a UE shall never report a CQI that corresponds to a code rate
> greater than unity.
>
> Using this definition of BLER, single-transmission throughput shall be
> defined as follows :
single-transmission throughput = (1 -- BLER) × RTBS
> If the UE is configured in MIMO mode, the single-transmission throughput
> shall be defined as the sum of each stream throughput.
3\. The CQI report derived from a given HS-DSCH transmission shall be reported
to the Node B in the next HS-SICH available to the UE following that HS-DSCH
transmission, unless that HS-SICH immediately follows the last allocated HS-
DSCH timeslot, in which case the subsequent available HS-SICH shall be used by
the UE. This HS-SICH may not necessarily be the same HS-SICH that carries the
ACK/NACK information for that HS-DSCH transmission. The UE shall always
transmit the most recently derived CQI in any given HS-SICH, which may mean
that some CQI reports are discarded without being transmitted to the Node B.
### 5.9.3 HS-SCCH monitoring procedure
If HS_SCCH_DRX_Active is FALSE, UE shall monitor a set of HS-SCCHs as follows.
For 1.28Mcps TDD, in a multi-frequency HS-DSCH cell, a UE divides its HS-SCCH
set into one or more HS-SCCH subsets; in each HS-SCCH subset all HS-SCCHs are
associated with the same frequency's HS-PDSCH. When indicated by higher
layers, the UE shall start monitoring all HS-SCCHs in all HS-SCCH subsets to
acquire the configuration information of HS-PDSCHs. In the case that one HS-
SCCH is detected carrying its UE identity, the UE shall skip monitoring the
remaining HS-SCCHs in this HS-SCCH subset, and restrict its monitoring only to
previously detected HS-SCCH in the following TTIs. The UE shall set all HS-
SCCHs carrying its UE identity in all HS-SCCH subsets into an active set, and
set all HS-SCCH subsets in which no HS-SCCH carries its UE identity into a
remaining set.
In the case that the multi-carrier number (as described in [15]) is not
configured by high layers, a UE shall always monitor all HS-SCCH subsets.
Otherwise, the UE may skip monitoring remaining HS-SCCH subsets when the
number of HS-SCCHs carrying its UE identity, i.e. the number of HS-SCCHs in
the active set, is equal to the configured value.
During the following TTIs, the UE shall update and maintain the active set and
the remaining set. If one or more HS-SCCHs in the active set do not carry its
UE identity, the UE shall remove them from the active set and set their
corresponding HS-SCCH subsets into remaining set. Meanwhile, if one or more
HS-SCCHs in remaining sets are detected carrying its UE identity, the UE shall
set these founded HS-SCCHs into the active set and remove their corresponding
HS-SCCH subsets from the remaining set.
If HS_SCCH_DRX_Active is TRUE, UE shall monitor a set of HS-SCCHs in the
subframes according to rules defined in the subclause 5.13.
## 5.9A HS-DSCH Procedure in CELL_FACH state
### 5.9A.1 Link Adaptation Procedure
In HS-DSCH reception in CELL_FACH state, the measurement result on RACH can be
used for initial link adaptation. Only when UE is allocated a dedicated UE
identity, the ACK/NACK feedback is provided and a measurement report is
associated with each HS-DSCH link adaptation procedure. When downlink
transmission is recommenced following a transmission pause, Node B shall order
UE to perform the uplink synchronization procedure cf [subclause 5.3.3.2
Establishment of uplink synchronization] in case it detects the UE is out of
synchronization. If Node B receives E-RUCCH from the UE, the Node B can then
resume the HS-DSCH transmission for the UE, and the link adaptation procedure
is the same as that in CELL_DCH state, cf.5.9.1.
### 5.9A.2 HS-DSCH Channel Quality Indication Procedure
If the UE is configured without dedicated UE identity, the UE shall not
transmit an HS-SICH. If the UE is configured with a dedicated UE identity, but
the HS-SCCH is an uplink synchronization establishment order, then its
associated HS-SICH shall not be transmitted. Otherwise, the channel quality
indication shall be transmitted on HS-SICH, and the HS-DSCH channel quality
indication procedure is the same as that in CELL_DCH state of 1.28Mcps TDD,
cf. 5.9.2.
### 5.9A.3 HS-SCCH monitoring procedure
When HS_DSCH_DRX_CELL_FACH_STATUS is FALSE (as described in [15]), UE shall
monitor HS-SCCHs continuously as in CELL_DCH state cf. 5.9.3.
When HS_DSCH_DRX_CELL_FACH_STATUS is TRUE (as described in [15]), UE shall
monitor HS-SCCHs according to the following rules:
  * Once the UE receives HS-SCCH carrying its dedicated identity and feeds back on HS-SICH, the UE shall monitor HS-SCCHs continuously for a period of inactivity time (T321) configured by higher layer.
  * Once the UE receives HS-SCCH order carrying synchronization establishment command and accomplishes the uplink synchronization establishment, the UE shall monitor HS-SCCHs continuously for a period of inactivity time (T321) configured by higher layer.
  * Whenever the UE monitors E-AGCH continuously as described in 5.11.3A, the UE shall always monitor HS-SCCHs.
  * The UE shall monitor HS-SCCHs for the RX burst length of the DRX Cycle and may choose not to monitor HS-SCCHs for the rest of the time of the DRX Cycle (as described in [15]).
## 5.9B HS-DSCH Procedure in CELL_PCH or URA_PCH state
### 5.9B.1 Link Adaptation Procedure
In HS-DSCH reception in CELL_PCH and URA_PCH state, after receiving a paging
indication on PICH for its specific PI, the UE with a stored dedicated UE
identity shall start monitoring HS-SCCH while the UE without a dedicated UE
identity shall start monitoring the HS-PDSCH(s). The HS-PDSCH physical
resource and associated signalling are broadcasted in the system information.
In a multi-frequency cell, HS-DSCH reception in CELL_PCH and URA_PCH is only
on primary frequency.
_Node B procedure:_
The timing relation of the PICH frame to the associated HS-SCCH subframe or
the HS-DSCH is described in 7.2.7.3 and 7.2.7.4 of [8].
If the UE is configured with a dedicated UE identity, the Node B shall use the
following procedures:
  * The Node B shall transmit the HS-SCCH order associated with the PICH frame using the dedicated UE identity.
  * If the Node B has received E-RUCCH, the Node B considers that the UE has transitted to CELL_FACH state.
If the UE is configured without dedicated UE identity, the Node B shall use
the following procedures:
  * The Node B shall not transmit an HS-SCCH.
  * The Node B shall transmit an HS-DSCH transport block in the HS-DSCH subframe with parameters configured by RRC layer.
  * The Node B shall retransmit the HS-DSCH transport block (2*m-1) times in the next contiguous subframes without transmitting HS-SCCH.
  * The Node B shall use QPSK modulation for each transmission of HS-PDSCH.
  * For the first transmission and retransmission, the redundancy and constellation version of the HS-DSCH transport block are 0, 3, 4, 7, 0, 3...
_UE procedure:_
If the UE has detected a paging indication intended for this UE, the UE shall
perform the following actions:
If the UE is configured with a dedicated UE identity, UE shall receive the
corresponding HS-SCCH subframes：
\- if the UE detects that one of the monitored HS-SCCHs in a set of associated
HS-SCCH subframes carries consistent control information (HS-SCCH order)
intended for this UE, the UE shall initiate the uplink synchronization
procedure and transit to CELL_FACH state.
\- if the UE detects that one of the monitored HS-SCCHs in a set of associated
HS-SCCH subframes carries consistent control information (HS-SCCH type 1
carrying BCCH specific H-RNTI), the UE shall receive the corresponding HS-DSCH
based on the association and timing between HS-SCCH and HS-DSCH.
\- if the UE does not detect any HS-SCCH carries consistent control
information intended for this UE in the M subframes, the UE shall resume the
DRX operation.
If the UE is configured without dedicated UE identity and there is no legacy
PCH channel, UE shall receive the corresponding HS-DSCH TTIs and:
\- consider that paging message is retransmitted in 2*m subframes, the
parameter _m_ is the number of frame that a paging sub-channel occupies.
\- combine retransmissions to the same HARQ buffer.
\- pass the data to higher layers if the CRC is correct after decoding the
data.
\- resume the DRX operation if the CRC fails after receiving 2*m subframes.
### 5.9B.2 HS-DSCH Channel Quality Indication Procedure
The UE in CELL_PCH or URA_PCH state does not report CQI via HS-SICH.
### 5.9B.3 HS-SCCH monitoring procedure
The UE with a stored dedicated UE identity shall monitor HS-SCCH in M sub-
frames after receiving its specific paging indication on PICH (as described in
[8]).
The UE without a dedicated UE identity shall not monitor any HS-SCCH.
## 5.10 Macro-diversity procedure
The macro-diversity procedure is the same as that of 3.84 Mcps TDD, cf. 4.12
Macro-diversity procedure.
## 5.11 E-DCH Procedure
### 5.11.1 ACK/NACK detection
The physical layer in the UE shall detect ACK or NACK contained within the
E-HICH. Which E-HICH is associated with the corresponding E-DCH transmission
is defined in [8].
### 5.11.2 Serving and neighbour cell pathloss metric derivation
The UE shall be capable of measuring the P-CCPCH RSCP of the serving cell and
of intra-frequency and inter-frequency neighbour cells in accordance with
[11]. The P-CCPCH transmit power (P~ref~) of the serving cell and of each
neighbour cell (with a primary or a secondary frequency being the same as UE's
current working frequency) in the monitored neighbour cell list shall be
signalled by higher layers to the UE in order that the UE may estimate the
mean pathloss to the serving cell (L~serv~) and to each of the N neighbour
cells in the monitored neighbour cell list (L~1~, L~2~, ... L~N~). The
pathloss used in the following formulas is a linear value, but not a
logarithmic (dB) value.
Higher layers shall configure the UE to use SNPL reporting type 1 or SNPL
reporting type 2. In accordance with the SNPL reporting type, the UE shall be
capable of forming a metric corresponding to:
$\Phi = \frac{1}{\sum_{n = 1}^{N}{L_{\text{serv}}L_{n}}}$ {for SNPL reporting
type 1}
$\Phi = \frac{\underset{n = 1\text{.}\text{.}N}{\text{min}}\left( L_{n}
\right)}{L_{\text{serv}}}$ {for SNPL reporting type 2}
The metric φ shall be converted into a logarithmic (dB) value Q and shall be
mapped to a Serving and Neighbour Cell Pathloss (SNPL) index according to
table 2b. The SNPL index is supplied to and used by higher layers (see [18]).
Table 2b: SNPL mapping
* * *
**Q = 10*log~10~(φ)** **SNPL index** Q \ If the allocated resource for the UE includes multiple uplink timeslots in
> one TTI, the UE shall transmit the uplink physical channels in every
> timeslot by using the antenna selected according to the received downlink
> signaling value and the predefined relationship between UE and Node B. The
> details are as follows:
  * If there is an HS-SICH in this TTI, the Node B implicitly informs the UE by HCSN on HS-SCCH which antenna shall be used to transmit HS-SICH. The UE shall use the antenna indicated by the parity of HCSN decimal value to transmit HS-SICH. Based on the reference antenna carrying HS-SICH, the UE switches the transmit antennas in turn for the consequent uplink transmission in this TTI;
  * Else if there is no HS-SICH but scheduled E-PUCH in this TTI, the Node B implicitly informs UE by ECSN on E-AGCH which antenna shall be used to transmit the first timeslot of E-PUCH. UE shall use the antenna indicated by the parity of ECSN decimal value to transmit first timeslot of E-PUCH. And based on the reference antenna carrying the first timeslot of E-PUCH, the UE switches the transmit antennas in turn for the consequent uplink transmission in this TTI;
  * Else, the UE shall take the antenna used to transmit the uplink channel in the first timeslot of this TTI as reference and switch the transmit antennas in turn in the consequent uplink timeslots in this TTI. The reference antenna is the other antenna different from the one used last time for this transmission type which may be non-scheduled transmission, semi-persistent transmission and RDI E-PUCH transmission.
> Else, the allocated resource for the UE just include one uplink timeslot in
> one TTI, the UE shall select the antenna according to the different uplink
> channel.
  * If there is an HS-SICH in this uplink timeslot, the UE shall select the antenna indicated by the parity of HCSN decimal value on the associated HS-SCCH;
  * Else if there is no HS-SICH but scheduled E-PUCH in this uplink timeslot, the UE shall select the antenna indicated by the parity of ECSN decimal value on E-AGCH;
  * Else, the UE shall select the other antenna different from the one used last time for this transmission type which may be non-scheduled transmission, semi-persistent transmission and RDI E-PUCH transmission.
If the standalone midamble channel is configured, the UE antennas time
switched transmission procedures for uplink physical channels are described
below.
> If the UE needs to transmit an HS-SICH, the UE shall use a different antenna
> from the one used for HS-SICH to transmit the associated standalone midamble
> channel in the other uplink timeslot of the same subframe configured by
> higher layers.
>
> If there is other uplink physical channel(s) besides HS-SICH in subframe for
> the UE to transmit, the standalone midamble channel shall be omitted.
## 5.13 Control Channel Discontinuous reception procedures
If the higher layers set CONTROL_CHANNEL_DRX_STATUS to TRUE (as described in
[15]) and Enabling_Delay is configured to be finite value, after
Enabling_Delay radio frames have passed, UE_ DRX_Enabled is TRUE. Or if the
higher layers set CONTROL_CHANNEL_DRX_STATUS to TRUE and Enabling_Delay is
configured to be infinity, after the UE has received DRX activation order via
HS-SCCH order, UE_DRX_Enabled is TRUE. Otherwise UE_ DRX_Enabled is FALSE.
Whether discontinuous downlink HS-SCCH reception operation or discontinuous
downlink E-AGCH reception operation is applied is determined by the setting of
HS_SCCH_DRX_Active and E_AGCH_DRX_Active as follows:
**HS_SCCH_DRX_Active** shall be set to TRUE while UE_ DRX_Enabled is TRUE and
discontinuous downlink HS-SCCH reception is activated. Otherwise, HS-SCCH
_DRX_Active shall be set to FALSE.
Discontinuous downlink HS-SCCH reception shall be activated at the time when
UE_ DRX_Enabled is set to TRUE, and may be further deactivated or activated by
layer 1 HS-SCCH orders (see section 5.13.2).
**E_AGCH_DRX_Active** shall be set to TRUE while UE_DRX_Enabled is TRUE,
E-AGCH DRX information is configured and discontinuous downlink E-AGCH
reception is activated. Otherwise, E_AGCH_DRX_Active shall be set to FALSE.
Discontinuous downlink E-AGCH reception shall be activated at the time when
UE_ DRX_Enabled is set to TRUE and E-AGCH DRX information is configured and
may be further deactivated or activated by layer 1 HS-SCCH orders.
The higher layers define the discontinuous reception procedures using the
following parameters (defined in [15]):
**HS_SCCH_DRX Offset** : HS-SCCH reception pattern offset in subframes.
**E_AGCH_DRX Offset** : E-AGCH reception pattern offset in subframes.
**Enabling_Delay** : ensures that the HS-SCCHs and E-AGCHs are received
continuously for Enabling_Delay radio frames after CONTROL_CHANNEL_DRX_STATUS
is set to TRUE.
**HS_SCCH_DRX cycle** : HS-SCCH reception pattern length in subframes.
**E_AGCH_DRX cycle** : E-AGCH reception pattern length in subframes.
**Inactivity_Threshold_for_HS_SCCH_DRX_cycle** : For single carrier HS-DSCH
reception, when HS_SCCH _DRX_Active is TRUE, this timer shall be started or
restarted in the same subframe as the HS-SICH corresponding to an HS-PDSCH
reception.
For multi-carrier HS-DSCH reception, this timer should be maintained per UE.
When HS_SCCH _DRX_Active is TRUE, this timer shall be started or restarted in
the same subframe as the occurrence of any HS-SICH on any configured carrier
corresponding to an HS-PDSCH reception.
**E_AGCH_Inactivity_Monitor_Threshold** : When E_AGCH_DRX_Active is TRUE, this
timer shall be started or restarted in the same subframe as the E-HICH which
contains the HARQ-ACK corresponding to the latest scheduling information
indicating the TEBS equals zero. If the UE is transmitting SI only MAC-e PDU
with TEBS equals zero and the UE is monitoring E-AGCHs only in the E-AGCH
reception pattern, this timer shall not be started or restarted.
### 5.13.1 Discontinuous downlink reception
The HS-SCCH reception pattern is the same for all the configured carriers of
the UE and is derived from a discontinuous reception subframe numbering as
follows.
The HS-SCCH reception pattern is the set of subframes whose HS-SCCH
discontinuous reception radio frame number CFN and subframe number subframe
number verify:
((2*CFN - HS_SCCH_DRX Offset + subframe number) **MOD** HS_SCCH_DRX cycle) = 0
For the first subframe within each radio frame, the subframe number shall be
set to 0. For the second subframe within each radio frame, the subframe number
shall be set to 1.
When HS_SCCH_DRX_Active is FALSE, the UE shall monitor HS-SCCHs continuously
according to rules defined in the subclause 5.9.3.
When HS_SCCH_DRX_Active is TRUE and the timer Inactivity Threshold for HS-SCCH
DRX cycle is not configured by higher layers, the UE shall monitor the HS-SCCH
subframes in the HS-SCCH reception pattern on all configured carriers.
When HS_SCCH_DRX_Active is TRUE and the timer Inactivity Threshold for HS-SCCH
DRX cycle is configured by higher layers, the UE is required to monitor the
HS-SCCHs in the UE's HS-SCCH set on all configured carriers continuously when
the timer is running. The UE shall only monitor the HS-SCCH subframes in the
HS-SCCH reception pattern on all configured carriers when the timer is
expired.
The E-AGCH reception pattern is the set of subframes whose E-AGCH
discontinuous reception radio frame number CFN and subframe number verify:
((2*CFN - E_AGCH_DRX Offset + subframe number) **MOD** E_AGCH_DRX cycle) = 0
When E_AGCH_DRX_Active is FALSE and E-AGCH DRX information is configured, UE
shall monitor E-AGCHs continuously.
When E_AGCH_DRX_Active is FALSE and the E-AGCH DRX information is not
configured, UE shall monitor E-AGCHs according to rules defined in the
subclause 5.11.3.
When E_AGCH_DRX_Active is TRUE and TEBS is larger than zero, the UE shall
monitor the E-AGCHs continuously.
When E_AGCH_DRX_Active is TRUE and TEBS is equal to zero, the UE is required
to monitor the E-AGCHs in the UE's E-AGCH set continuously until the subframe
when the timer E_AGCH_Inactivity_Monitor_Threshold is expired. The UE shall
start to monitor the E-AGCH subframes in the E-AGCH reception pattern from the
next subframe when the timer is expired.
The HS-SCCH reception pattern is illustrated by Figure 11B. The grey subframes
correspond to the HS-SCCH reception pattern HS_SCCH_DRX cycle =4.
**Figure 11B: Example for HS-SCCH reception pattern**
### 5.13.2 HS-SCCH orders
The Node B may activate and deactivate the discontinuous downlink reception
operation through physical layer commands transmitted on one of the HS-SCCHs
in the HS-SCCH set as specified in [9].The activation and deactivation of the
discontinuous downlink reception operation is applied by the UE in the same
subframe as the HS-SICH subframe which contains the HARQ-ACK corresponding to
the order.
# 6 Physical layer procedures for the 7.68 Mcps option
## 6.1 Transmitter Power Control
The transmit power control procedure is identical to that of the 3.84Mcps TDD
option [clause 4.2] with the exception that the tablulated α~e~ values of
subclause 4.2.2.4.1 for uplink power control of E-PUCH are substituted with
the following values of table 3.
Table 3: Tabulated α~e~ values for the 7.68Mcps option
* * *
SF~E-PUCH~ $\alpha_{e}$ (dB) 1 15 2 12 4 9 8 6 16 3 32 0
* * *
## 6.2 Timing Advance
UTRAN may adjust the UE transmission timing with timing advance. The initial
value for timing advance (TA~phys~) will be determined in the UTRAN by
measurement of the timing of the PRACH or E-RUCCH. The required timing advance
will be represented as a 9 bit number (0-511) \'UL Timing Advance\' TA~ul~,
being the multiplier of 4 chips which is nearest to the required timing
advance (i.e. TA~phys~ = TA~ul~ × 4 chips).
When Timing Advance is used the UTRAN will continuously measure the timing of
a transmission from the UE and send the necessary timing advance value. On
receipt of this value the UE shall adjust the timing of its transmissions
accordingly in steps of ±4chips. The transmission of TA values is done by
means of higher layer messages. Upon receiving the TA command the UE shall
adjust its transmission timing according to the timing advance command at the
frame number specified by higher layer signaling. The UE is signaled the TA
value in advance of the specified frame activation time to allow for local
processing of the command and application of the TA adjustment on the
specified frame. Node-B is also signaled the TA value and radio frame number
that the TA adjustment is expected.to take place.
If TA is enabled by higher layers, after handover the UE shall transmit in the
new cell with timing advance TA adjusted by the relative timing difference ∆t
between the new and the old cell:
TA~new~ = TA~old~ + 2∆t.
## 6.3 Synchronisation procedures
The synchronisation procedures are identical to those of the 3.84Mcps TDD
option [clause 4.4].
## 6.4 Discontinuous transmission (DTX) procedure
The discontinuous transmission procedure is identical to that of the 3.84Mcps
TDD option [clause 4.5].
## 6.5 Downlink Transmit Diversity
Downlink transmit diversity for PDSCH, DPCH, P-CCPCH, S-CCPCH, PICH, MICH, HS-
SCCH, HS-PDSCH, E-AGCH, E-HICH and SCH is optional in UTRAN. Its support is
mandatory at the UE.
### 6.5.1 Transmit Diversity for PDSCH, DPCH, HS-SCCH, HS-PDSCH and E-AGCH
Transmit diversity for PDSCH, DPCH, HS-SCCH, HS-PDSCH and E-AGCH is identical
to the 3.84Mcps TDD option [clause 4.6.1].
### 6.5.2 Transmit Diversity for SCH **and S-CCPCH**
Transmit diversity for SCH and S-CCPCH is identical to the 3.84Mcps TDD option
[clause 4.6.2].
### 6.5.3 Transmit Diversity for Beacon Channels
When beacon channels use burst type 4, SCTD shall not be applied.
When beacon channels use burst type 1, Space Code Transmit Diversity (SCTD)
for beacon channels may be employed optionally in the UTRAN. The support is
mandatory in the UE except for the case where the UE only supports burst type
4. The use of SCTD will be indicated by higher layers. If SCTD is active
within a cell:
\- SCTD shall be applied to any beacon channel, and
\- the maximum number K~Cell~ of midambles for burst type 1 that are supported
in this cell may be 8 or 16, see [8]. The case of K~Cell~ = 4 midambles is not
allowed for this burst type.
#### 6.5.3.1 SCTD Transmission Scheme
The open loop downlink transmit diversity scheme for beacon channels is shown
in figure 12. Channel coding, rate matching, interleaving and bit-to-symbol
mapping are performed as in the non-diversity mode. In Space Code Transmit
Diversity mode the data sequence is spread with the channelisation codes
$c_{\text{32}}^{(k = 1)}$and $c_{\text{32}}^{(k = 2)}$and scrambled with the
cell specific scrambling code. The spread sequence on code $c_{\text{32}}^{(k
= 2)}$ is then transmitted on the diversity antenna. The power applied to each
antenna shall be equal.
{width="4.817361111111111in" height="2.2256944444444446in"}
Figure 12: Block Diagram of the transmitter SCTD
## 6.6 Random access procedure
The physical random access procedure described below is invoked whenever a
higher layer requests transmission of a message on the RACH. The physical
random access procedure is controlled by primitives from RRC and MAC.
Retransmission on the RACH in case of failed transmission (e.g. due to a
collision) is controlled by higher layers. Thus, the backoff algorithm and
associated handling of timers is not described here. The definition of the
RACH in terms of PRACH Access Service Classes is broadcast on the BCH in each
cell. Parameters for common physical channel uplink outer loop power control
are also broadcast on the BCH in each cell. The UE needs to decode this
information prior to transmission on the RACH.
### 6.6.1 Physical random access procedure
The physical random access procedure is identical to that of the 3.84Mcps TDD
option [clause 4.7.1].
## 6.6A E-RUCCH transmission procedure
The E-RUCCH transmission procedure is identical to that of the 3.84Mcps TDD
option [clause 4.7A]
## 6.7 DSCH procedure
Higher layer signalling is used to indicate to the UE the need for PDSCH
detection.
## 6.8 Idle periods for IPDL location method
The IPDL procedure is identical to that of the 3.84Mcps TDD option [clause
4.10].
## 6.9 HS-DSCH Procedure
### 6.9.1 Link Adaptation Procedure
For HS-DSCH, the modulation scheme and effective code rate shall be selected
by higher layers located within the NodeB. This shall be achieved by
appropriate selection of an HS-DSCH transport block size, modulation format
and resources by higher layers. Selection of these parameters may be based on
CQI reports from the UE.
The overall HS-DSCH link adaptation procedure consists of _two parts:_
_Node B procedure:_
1) The NodeB shall transmit HS-SCCH carrying a UE identity identifying the UE
for which HS-DSCH TTI allocation has been given. In the case of HS-DSCH
transmissions in consecutive TTIs to the same UE, the same HS-SCCH shall be
used for associated signalling.
2) The NodeB transmits HS-DSCH to the UE using the resources indicated in the
HS-SCCH.
3) Upon receiving the HS-SICH from the respective UE, the status report
(ACK/NACK and CQI) shall be passed to higher layers.
_UE procedure:_
1) When indicated by higher layers, the UE shall start monitoring all HS-SCCHs
that are in its HS-SCCH set as signalled to it by higher layers. The
information carried on the HS-SCCH is described in [8].
2) In the case that a HS-SCCH is identified to be correct by its CRC, the UE
shall read the HS-PDSCHs indicated by the HS-SCCH. In the case that a HS-SCCH
is identified to be incorrect, the UE shall discard the data on the HS-SCCH
and return to monitoring.
3) After reading the HS-PDSCHs, the UE shall generate an ACK/NACK message and
transmit this to the NodeB in the associated HS-SICH, along with the most
recently derived CQI.
The mapping of HS-PDSCH channelisation code set and timeslot information
carried by the HS-SCCH for a given HS-DSCH TTI is described in [9].
For a given allocation of HS-PDSCH resources to a UE for a specific HS-DSCH
TTI, the following shall apply:
  * If timeslot information on HS-SCCH indicates two or more timeslots, none of these timeslots shall comprise a beacon channel.
  * If timeslot information on HS-SCCH indicates a single timeslot and this timeslot comprises a beacon channel then:
    * The Node-B shall not indicate SF=1 for any HS-PDSCH resource.
    * The set of HS-PDSCH resources allocated by the Node-B to a UE shall exclusively comprise either beacon function or non-beacon function physical channels. The Node B shall therefore not allocate both beacon function and non-beacon function physical channels within the beacon timeslot to the UE. If the HS-DSCH for a specific HS-DSCH TTI is mapped to the beacon channel, this shall be signalled using _k~start~_ = 1 and _k~stop~_ = 1. For a definition of the first and last allocated channelisation code indices _k~start~_ and _k~stop~_ on HS-SCCH refer to [9].
    * When SCTD antenna diversity is applied to the beacon channel, then the presence of channelisation code $c_{\text{32}}^{(k = 1)}$ within the channelisation code set information on HS-SCCH shall implicitly indicate the presence of channelisation code $c_{\text{32}}^{(k = 2)}$.
### 6.9.2 HS-DSCH Channel Quality Indication Procedure
The HS-DSCH channel quality indication procedure is identical to that of the
3.84Mcps TDD option [clause 4.11.2].
## 6.10 Macro-diversity procedure
The macrodiversity procedure is identical to that of the 3.84Mcps TDD option
[clause 4.12].
## 6.11 E-DCH related procedures
### 6.11.1 ACK/NACK detection
The procedure for detection of ACK/NACK is identical to that of the 3.84Mcps
option [subclause 4.13.1]
### 6.11.2 Serving and neighbour cell pathloss metric derivation
The procedure for serving and neighbour cell metric derivation is identical to
that of the 3.84Mcps option [subclause 4.13.2]
### 6.11.3 Channelisation code hopping procedure for E-PUCH
For the 7.68Mcps option, the procedure for channelisation code hopping on
E-PUCH is identical to that of the 3.84Mcps option [subclause 4.13.3] with two
exceptions:
i) the code hopping index parameter is calculated as: $h_{i} = \left( t_{i} +
\text{CFN} \right)\text{mod}\ \text{32}$
ii) the code hopping index parameter sequences of table 1c are substituted for
the values of table 4 below.
Table 4: Hopping index parameter sequences for the 7.68Mcps options
* * *
                Hop index h~i~                                                                                                                                                         
         CRRI   0                1    2    3    4    5    6    7    8    9    10   11   12   13   14   15   16   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31
SF32  
1 31 1 17 9 25 5 21 13 29 3 19 11 27 7 23 15 31 2 18 10 26 6 22 14 30 4 20 12
28 8 24 16 32 2 32 2 18 10 26 6 22 14 30 4 20 12 28 8 24 16 32 1 17 9 25 5 21
13 29 3 19 11 27 7 23 15 31 3 33 3 19 11 27 7 23 15 31 1 17 9 25 5 21 13 29 4
20 12 28 8 24 16 32 2 18 10 26 6 22 14 30 4 34 4 20 12 28 8 24 16 32 2 18 10
26 6 22 14 30 3 19 11 27 7 23 15 31 1 17 9 25 5 21 13 29 5 35 5 21 13 29 1 17
9 25 7 23 15 31 3 19 11 27 6 22 14 30 2 18 10 26 8 24 16 32 4 20 12 28 6 36 6
22 14 30 2 18 10 26 8 24 16 32 4 20 12 28 5 21 13 29 1 17 9 25 7 23 15 31 3 19
11 27 7 37 7 23 15 31 3 19 11 27 5 21 13 29 1 17 9 25 8 24 16 32 4 20 12 28 6
22 14 30 2 18 10 26 8 38 8 24 16 32 4 20 12 28 6 22 14 30 2 18 10 26 7 23 15
31 3 19 11 27 5 21 13 29 1 17 9 25 9 39 9 25 1 17 13 29 5 21 11 27 3 19 15 31
7 23 10 26 2 18 14 30 6 22 12 28 4 20 16 32 8 24 10 40 10 26 2 18 14 30 6 22
12 28 4 20 16 32 8 24 9 25 1 17 13 29 5 21 11 27 3 19 15 31 7 23 11 41 11 27 3
19 15 31 7 23 9 25 1 17 13 29 5 21 12 28 4 20 16 32 8 24 10 26 2 18 14 30 6 22
12 42 12 28 4 20 16 32 8 24 10 26 2 18 14 30 6 22 11 27 3 19 15 31 7 23 9 25 1
17 13 29 5 21 13 43 13 29 5 21 9 25 1 17 15 31 7 23 11 27 3 19 14 30 6 22 10
26 2 18 16 32 8 24 12 28 4 20 14 44 14 30 6 22 10 26 2 18 16 32 8 24 12 28 4
20 13 29 5 21 9 25 1 17 15 31 7 23 11 27 3 19 15 45 15 31 7 23 11 27 3 19 13
29 5 21 9 25 1 17 16 32 8 24 12 28 4 20 14 30 6 22 10 26 2 18 16 46 16 32 8 24
12 28 4 20 14 30 6 22 10 26 2 18 15 31 7 23 11 27 3 19 13 29 5 21 9 25 1 17 17
47 17 1 25 9 21 5 29 13 19 3 27 11 23 7 31 15 18 2 26 10 22 6 30 14 20 4 28 12
24 8 32 16 18 48 18 2 26 10 22 6 30 14 20 4 28 12 24 8 32 16 17 1 25 9 21 5 29
13 19 3 27 11 23 7 31 15 19 49 19 3 27 11 23 7 31 15 17 1 25 9 21 5 29 13 20 4
28 12 24 8 32 16 18 2 26 10 22 6 30 14 20 50 20 4 28 12 24 8 32 16 18 2 26 10
22 6 30 14 19 3 27 11 23 7 31 15 17 1 25 9 21 5 29 13 21 51 21 5 29 13 17 1 25
9 23 7 31 15 19 3 27 11 22 6 30 14 18 2 26 10 24 8 32 16 20 4 28 12 22 52 22 6
30 14 18 2 26 10 24 8 32 16 20 4 28 12 21 5 29 13 17 1 25 9 23 7 31 15 19 3 27
11 23 53 23 7 31 15 19 3 27 11 21 5 29 13 17 1 25 9 24 8 32 16 20 4 28 12 22 6
30 14 18 2 26 10 24 54 24 8 32 16 20 4 28 12 22 6 30 14 18 2 26 10 23 7 31 15
19 3 27 11 21 5 29 13 17 1 25 9 25 55 25 9 17 1 29 13 21 5 27 11 19 3 31 15 23
7 26 10 18 2 30 14 22 6 28 12 20 4 32 16 24 8 26 56 26 10 18 2 30 14 22 6 28
12 20 4 32 16 24 8 25 9 17 1 29 13 21 5 27 11 19 3 31 15 23 7 27 57 27 11 19 3
31 15 23 7 25 9 17 1 29 13 21 5 28 12 20 4 32 16 24 8 26 10 18 2 30 14 22 6 28
58 28 12 20 4 32 16 24 8 26 10 18 2 30 14 22 6 27 11 19 3 31 15 23 7 25 9 17 1
29 13 21 5 29 59 29 13 21 5 25 9 17 1 31 15 23 7 27 11 19 3 30 14 22 6 26 10
18 2 32 16 24 8 28 12 20 4 30 60 30 14 22 6 26 10 18 2 32 16 24 8 28 12 20 4
29 13 21 5 25 9 17 1 31 15 23 7 27 11 19 3 31 61 31 15 23 7 27 11 19 3 29 13
21 5 25 9 17 1 32 16 24 8 28 12 20 4 30 14 22 6 26 10 18 2 32 62 32 16 24 8 28
12 20 4 30 14 22 6 26 10 18 2 31 15 23 7 27 11 19 3 29 13 21 5 25 9 17 1
SF16  
1 15 1 9 5 13 3 11 7 15 2 10 6 14 4 12 8 16 1 9 5 13 3 11 7 15 2 10 6 14 4 12
8 16 2 16 2 10 6 14 4 12 8 16 1 9 5 13 3 11 7 15 2 10 6 14 4 12 8 16 1 9 5 13
3 11 7 15 3 17 3 11 7 15 1 9 5 13 4 12 8 16 2 10 6 14 3 11 7 15 1 9 5 13 4 12
8 16 2 10 6 14 4 18 4 12 8 16 2 10 6 14 3 11 7 15 1 9 5 13 4 12 8 16 2 10 6 14
3 11 7 15 1 9 5 13 5 19 5 13 1 9 7 15 3 11 6 14 2 10 8 16 4 12 5 13 1 9 7 15 3
11 6 14 2 10 8 16 4 12 6 20 6 14 2 10 8 16 4 12 5 13 1 9 7 15 3 11 6 14 2 10 8
16 4 12 5 13 1 9 7 15 3 11 7 21 7 15 3 11 5 13 1 9 8 16 4 12 6 14 2 10 7 15 3
11 5 13 1 9 8 16 4 12 6 14 2 10 8 22 8 16 4 12 6 14 2 10 7 15 3 11 5 13 1 9 8
16 4 12 6 14 2 10 7 15 3 11 5 13 1 9 9 23 9 1 13 5 11 3 15 7 10 2 14 6 12 4 16
8 9 1 13 5 11 3 15 7 10 2 14 6 12 4 16 8 10 24 10 2 14 6 12 4 16 8 9 1 13 5 11
3 15 7 10 2 14 6 12 4 16 8 9 1 13 5 11 3 15 7 11 25 11 3 15 7 9 1 13 5 12 4 16
8 10 2 14 6 11 3 15 7 9 1 13 5 12 4 16 8 10 2 14 6 12 26 12 4 16 8 10 2 14 6
11 3 15 7 9 1 13 5 12 4 16 8 10 2 14 6 11 3 15 7 9 1 13 5 13 27 13 5 9 1 15 7
11 3 14 6 10 2 16 8 12 4 13 5 9 1 15 7 11 3 14 6 10 2 16 8 12 4 14 28 14 6 10
2 16 8 12 4 13 5 9 1 15 7 11 3 14 6 10 2 16 8 12 4 13 5 9 1 15 7 11 3 15 29 15
7 11 3 13 5 9 1 16 8 12 4 14 6 10 2 15 7 11 3 13 5 9 1 16 8 12 4 14 6 10 2 16
30 16 8 12 4 14 6 10 2 15 7 11 3 13 5 9 1 16 8 12 4 14 6 10 2 15 7 11 3 13 5 9
1
SF8  
1 7 1 5 3 7 2 6 4 8 1 5 3 7 2 6 4 8 1 5 3 7 2 6 4 8 1 5 3 7 2 6 4 8 2 8 2 6 4
8 1 5 3 7 2 6 4 8 1 5 3 7 2 6 4 8 1 5 3 7 2 6 4 8 1 5 3 7 3 9 3 7 1 5 4 8 2 6
3 7 1 5 4 8 2 6 3 7 1 5 4 8 2 6 3 7 1 5 4 8 2 6 4 10 4 8 2 6 3 7 1 5 4 8 2 6 3
7 1 5 4 8 2 6 3 7 1 5 4 8 2 6 3 7 1 5 5 11 5 1 7 3 6 2 8 4 5 1 7 3 6 2 8 4 5 1
7 3 6 2 8 4 5 1 7 3 6 2 8 4 6 12 6 2 8 4 5 1 7 3 6 2 8 4 5 1 7 3 6 2 8 4 5 1 7
3 6 2 8 4 5 1 7 3 7 13 7 3 5 1 8 4 6 2 7 3 5 1 8 4 6 2 7 3 5 1 8 4 6 2 7 3 5 1
8 4 6 2 8 14 8 4 6 2 7 3 5 1 8 4 6 2 7 3 5 1 8 4 6 2 7 3 5 1 8 4 6 2 7 3 5 1
SF4  
1 3 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 2 4 2 4 1
3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 2 4 1 3 3 5 3 1 4 2 3 1 4 2
3 1 4 2 3 1 4 2 3 1 4 2 3 1 4 2 3 1 4 2 3 1 4 2 4 6 4 2 3 1 4 2 3 1 4 2 3 1 4
2 3 1 4 2 3 1 4 2 3 1 4 2 3 1 4 2 3 1
SF2  
1 1 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 2 2 2 1 2
1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1
SF1  
1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
* * *
###### ## Annex A (informative): Power Control
# A.1 Example Implementation of Downlink Power Control in the UE
The power control may be realized by two cascaded control loops. The outer
loop controls the transmission quality, whose reference value is set by higher
layers [15], by providing the reference value for the inner loop. This
reference value should be the SIR at the UE [15]. The inner loop controls the
physical quantity for which the outer loop produces the reference value (e. g.
the SIR) by generating TPC commands. This may be done by comparing the
measured SIR to its reference value. When the measured value is higher than
the target SIR value, TPC command = \"down\". When this is lower than or equal
to the target SIR value, TPC command = \"up\".
In case of a downlink transmission pause on the DPCH or PDSCH, the receive
power (RSCP) of the data can no longer be used for inner loop SIR calculations
in the UE. In this case the UE should trace the fluctuations of the pathloss
based on the P-CCPCH and use these values instead for generating the TPC
commands. This pathloss together with the timeslot ISCP measurement in the
data timeslot, which is ongoing, should be used to calculate a virtual SIR
value:
SIR~virt~(i) = RSCP~virt~(i) − ISCP(i) + 10 lg SF ,
RSCP~virt~(i) = RSCP~0~ + L~0~ -- L(i) + {width="0.7673611111111112in"
height="0.47152777777777777in"},
RSCP: Received signal code power in dBm
ISCP: Interference signal code power in the DPCH / PDSCH timeslot in dBm
SF： Used spreading factor
L: pathloss in dB measured on the P-CCPCH. The same weighting of the long- and
short-term pathloss should be used as for uplink open loop power control, see
Annex A.1
i: index for the frames during a transmission pause, 1 ≤ i ≤ number of frames
in the pause
L~0~: weighted pathloss in the last frame before the transmission pause in dB
RSCP~0~: RSCP of the data that was used in the SIR calculation of the last
frame before the pause in dBm
TPC (k): ± power control stepsize in dB according to the TPC bit generated and
transmitted in frame k, TPC bit \"up\" = +stepsize, TPC bit \"down\" =
−stepsize
# A.2 Example Implementation of Closed Loop Uplink Power Control in Node B for
1.28Mcps TDD
Uplink power control is based on a quality target, set by higher layers. An
example implementation for a Node B TPC calculation algorithm is SIR based. In
this algorithm, an outer loop sets a target SIR value, SIR~target~, which may
be adjusted from time to time in order to ensure that the quality target is
met. In the meantime, as part of an inner loop a calculation of SIR in
associated uplink transmissions may be carried out. When the measured value is
higher than the target SIR value, TPC command = \"down\". When the measurement
is lower than or equal to the target SIR, TPC command = \"up\".
# A.3 Example Implementation of Downlink Power Control in UE for 1.28Mcps TDD
when TSTD is used
Downlink power control is based on a quality target, set by higher layers. An
example implementation for a UE TPC calculation algorithm is SIR based. In
this algorithm, an outer loop sets a target SIR value, SIR~target~, which may
be adjusted from time to time in order to ensure that the quality target is
met. In the meantime, as part of an inner loop a calculation of SIR in
associated downlink transmissions may be carried out. When the measured value
is higher than the target SIR value, TPC command = \"down\". When the
measurement is lower than or equal to the target SIR, TPC command = \"up\".
When TSTD is applied, the UE can use the consecutive measurements of SIR to
calculate SIR~AVG~:
SIR~AVG~(i) = w~1~SIR(i-1) + w~2~SIR(i),
where, w~1~ + w~2~ = 1, w~1~ >= 0, w~2~ >= 0, and SIR(i) is the measurement of
SIR in sub-frame i and SIR~AVG~(i) is the measurement of SIR~AVG~ in sub-frame
i. If SIR~AVG~ is greater than the target SIR value, TPC command = \"down\".
If the SIR~AVG~ is smaller than the target SIR value, TPC command = \"up\".
In case of a downlink transmission pause on the DPCH, the example in Annex A.1
can be used for DL power control with RSCP~virt~(i) and ISCP(i) replaced by
RSCP~AVG~(i) and ISCP~AVG~(i), where
RSCP~AVG~(i) = w~1~RSCP~virt~(i-1) + w~2~RSCP~virt~(i),
ISCP~AVG~(i) = w~1~ISCP(i-1) + w~2~ISCP(i).
# A.4 Example Implementation of open Loop Power Control for access procedure
for 1.28Mcps TDD
The higher layer signals (on BCH) a power increment that is applied to the
SYNC-UL burst only for the access procedure. At each new transmission of a
SYNC-UL burst during the access procedure, the transmit power level can be
increased by this power increment.
# A.5 Example Implementation of Closed Loop Uplink HS-SICH Power Control in
Node B for 1.28Mcps TDD
If the UE is not configured in MIMO mode, uplink power control is based on a
quality target and a power offset, set by higher layers. An example
implementation for a Node B TPC calculation algorithm is SIR based (HS-SICH
SIR Target). In this algorithm, if an ACK is decoded from HS-SICH, the Node B
shall adjust the measured value of HS-SICH with a power offset. When the
(adjusted) measured value is higher than the target SIR value, TPC command =
\"down\". When the (adjusted) measurement is lower than or equal to the target
SIR, TPC command = \"up\"
If the UE is configured in MIMO mode, uplink power control is based on a
quality target and a power offset, set by higher layers. An example
implementation for a Node B TPC calculation algorithm is SIR based (HS-SICH
SIR Target). In this algorithm, if an ACK is decoded from HS-SICH for single
stream transmission or two ACKs are decoded from HS-SICH for dual stream
transmission, the Node B shall adjust the measured value of HS-SICH with a
power offset. When the (adjusted) measured value is higher than the target SIR
value, TPC command = \"down\". When the (adjusted) measurement is lower than
or equal to the target SIR, TPC command = \"up\".
###### ## Annex B (informative): Determination of Weight Information
Selective Transmit Diversity (STD) and Transmit Adaptive Antennas (TxAA) are
examples of transmit diversity schemes for dedicated physical channels.
# B.1 STD Weights
The weight vector will take only two values depending on the signal strength
received by each antenna in the uplink slot. For each user, the antenna
receiving the highest power will be selected (i.e. the corresponding weight
will be set to 1).
Table B.1: STD weights for two TX antennas
* * *
                                      W~1~   W~2~
Antenna 1 receiving highest power 1 0 Antenna 2 receiving highest power 0 1
* * *
# B.2 TxAA Weights
In a generic sense, the weight vector to be applied at the transmitter is the
_[w]{.underline}_ that maximises:
P=[w]{.underline}^H^H^H^H[w]{.underline} (1)
where
H=[[h]{.underline}~1~ [h]{.underline}~2~] and [w]{.underline} = [ w~1~, w~2~
]^T^
and where the column vector _[h]{.underline}~i~_ represents the estimated
uplink channel impulse response for the i\'th transmission antenna, of length
equal to the length of the channel impulse response.
###### ## Annex C (informative): Cell search procedure for 3.84Mcps TDD
During the cell search, the UE searches for a cell and determines the downlink
scrambling code, basic midamble code and frame synchronisation of that cell.
The cell search is typically carried out in three steps:
**Step 1: Primary synchronisation code acquisition**
During the first step of the cell search procedure, the UE uses the SCH\'s
primary synchronisation code to find a cell. This is typically done with a
single matched filter (or any similar device) matched to the primary
synchronisation code which is common to all cells. A cell can be found by
detecting peaks in the matched filter output.
Note that for a cell of SCH slot configuration case 1, the SCH can be received
periodically every 15 slots. In case of a cell of SCH slot configuration case
2, the following SCH slot can be received at offsets of either 7 or 8 slots
from the previous SCH slot.
Step 2: Code group identification and slot synchronisation
During the second step of the cell search procedure, the UE uses the SCH\'s
secondary synchronisation codes to identify 1 out of 32 code groups for the
cell found in the first step. This is typically done by correlating the
received signal with the secondary synchronisation codes at the detected peak
positions of the first step. The primary synchronisation code provides the
phase reference for coherent detection of the secondary synchronisation codes.
The code group can then uniquely be identified by detection of the maximum
correlation values.
Each code group indicates a different t~offset~ parameter and 4 specific cell
parameters. Each of the cell parameters is associated with one particular
downlink scrambling code and one particular long and short basic midamble
code. When the UE has determined the code group, it can unambiguously derive
the slot timing of the found cell from the detected peak position in the first
step and the t~offset~ parameter of the found code group in the second step.
Note that the modulation of the secondary synchronisation codes also indicates
the position of the SCH slot within a 2 frames period, e.g. a frame with even
or odd SFN. Additionally, in the case of SCH slot configuration following case
2, the SCH slot position within one frame, e.g. first or last SCH slot, can be
derived from the modulation of the secondary synchronisation codes.
Step 3: Downlink scrambling code, basic midamble code identification and frame
synchronisation
During the third and last step of the cell search procedure, the UE determines
the exact downlink scrambling code, basic midamble code and frame timing used
by the found cell. The long basic midamble code can be identified by
correlation over the P-CCPCH (or any other beacon channel) with the 4 possible
long basic midamble codes of the code group found in the second step. A
P-CCPCH (or any other beacon channel) always uses the midamble m^(1)^ (and in
case of SCTD also midamble m^(2)^) derived from the long basic midamble code
and always uses a fixed and pre-assigned channelisation code.
When the long basic midamble code has been identified, downlink scrambling
code and cell parameter are also known. The UE can read system and cell
specific BCH information and acquire frame synchronisation.
Note that even for an initial cell parameter assignment, a cell cycles through
a set composed of 2 different cell parameters according to the SFN of a frame,
e.g. the downlink scrambling code and the basic midamble code of a cell
alternate for frames with even and odd SFN. Cell parameter cycling leaves the
code group of a cell unchanged.
If the UE has received information about which cell parameters or SCH
configurations to search for, cell search can be simplified.
###### ## Annex CA (informative): Cell search procedure for 1.28Mcps TDD
During the initial cell search, the UE searches for a cell. It then determines
the DwPTS synchronization, scrambling and basic midamble code identification,
control multi-frame synchronisation and then reads the contents in BCH. This
initial cell search is carried out in 4 steps:
**Step 1: Search for DwPTS**
During the first step of the initial cell search procedure, the UE uses the
SYNC-DL (in DwPTS) to acquire DwPTS synchronization to a cell. This is
typically done with one or more matched filters (or any similar device)
matched to the received SYNC-DL which is chosen from PN sequences set. A
single or more matched filter (or any similar device) is used for this
purpose. During this procedure, the UE needs to identify which of the 32
possible SYNC-DL sequences is used.
**Step 2: Scrambling and basic midamble code identification**
During the second step of the initial cell search procedure, the UE receives
the midamble of the P-CCPCH.The P-CCPCH is followed by the DwPTS. In the 1.28
Mcps TDD each DwPTS code corresponds to a group of 4 different basic midamble
code. Therefore there are total 128 midamble codes and these codes are not
overlapping with each other. Basic midamble code number divided by 4 gives the
SYNC-DL code number. Since the SYNC-DL and the group of basic midamble codes
of the P-CCPCH are related one by one (i.e, once the SYNC-DL is detected, the
4 midamble codes can be determined), the UE knows which 4 basic midamble codes
are used. Then the UE can determine the used basic midamble code using a try
and error technique. The same basic midamble code will be used throughout the
frame. As each basic midamble code is associated with a scrambling code, the
scrambling code is also known by that time. According to the result of the
search for the right midamble code, UE may go to next step or go back to step
1.
**Step 3: Control multi-frame synchronisation**
During the third step of the initial cell search procedure, the UE searches
for the MIB( Master Indication Block) of multi-frame of the BCH in the P-CCPCH
indicated by QPSK phase modulation of the DwPTS with respect to the P-CCPCH
midamble. The control multi-frame is positioned by a sequence of QPSK symbols
modulated on the DwPTS. [n] consecutive DwPTS are sufficient for detecting the
current position in the control multi-frame. According to the result of the
control multi-frame synchronisation for the right midamble code, UE may go to
next step or go back to step 2.
**Step 4: Read the BCH**
The (complete) broadcast information of the found cell in one or several BCHs
is read. According to the result the UE may move back to previous steps or the
initial cell search is finished.
**For Dedicated Carrier MBSFN**
For the MS burst, the preamble codes (see the Table AA.1a in TS25.221) are
segmented into even code group and odd code group, P~P,even~ group and
P~P,odd~ group (see the clause 8.3Aa in TS25.223). When the preamble of the MS
burst is P~P,odd~, it indicates that the next sub-frame is the beginning of
the multi-frame of PCCPCH; otherwise, the preamble of MS burst uses the
P~P,even~ (P~P,even~ and P~P,odd~ belong to the same subgroup)~.~ The preamble
of MT burst is decided by the upper-layer signaling. This initial SFN cell
search is carried out in 4 steps:
**Step 1: Search for P~P,even~**
During the first step of the initial SFN cell search procedure, the UE uses
the P~P,even~ (in MS burst) to acquire synchronization to a SFN cell.
**Step 2: Multi-frame synchronization**
During the second step of the initial SFN cell search procedure, the UE
searches for the P~P,odd~ (in MS burst) to get the beginning position of the
multi-frame of PCCPCH. According to the result of multi-frame synchronization,
UE may go to next step or go back to step 1.
**Step 3: Read the BCCH**
The UE reads the MIB (Master Indication Block) of multi-frame P-CCPCHs in the
BCH and gets the system information of the found SFN cell. According to the
result of reading the BCCH, UE may go to next step or go back to step 2.
**Step 4: Read the MCCH**
The UE reads the MCCH indicated by the BCCH information. According to the
result the UE may move back to previous steps or the initial cell search is
finished.
###### ## Annex CB (informative): Examples random access procedure for
1.28Mcps TDD
Table CB.1: One PRACH, TTI=5ms, WT=4, L =1, SF4 PRACH
Sub-frame Number | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10  
---|---|---|---|---|---|---|---|---|---|---|---  
Users sending on UpPCH | 1 2 | 3 4 | 5 6 | 7 8 |  |  |  |  |  |  |   
Acknowledged user on FPACH |  | 1 | 2 | 3 | 4 | 5 | 6 | 7 |  |  |   
User sending on PRACH 0 |  |  |  | 1 | 2 | 3 | 4 | 5 | 6 | 7 |   
User 8 is not granted because more than 5 sub-frames would have passed since
the UpPCH.
Table CB.2: Two PRACHs, TTI=10ms, WT=4, L =2, SF8 PRACH
Sub-frame Number | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11  
---|---|---|---|---|---|---|---|---|---|---|---|---  
Users sending on UpPCH | 1 2 | 3 4 | 5 6 | 7 8 |  |  |  |  |  |  |  |   
Acknowledged user on FPACH |  | 1 | 2 | 3 | 4 | 5 | 6 | 7 |  |  |  |   
User sending on PRACH 0 |  |  |  |  | 2 | 2 | 4 | 4 | 6 | 6 |  |   
User sending on PRACH 1 |  |  |  |  | 1 | 1 | 3 | 3 | 5 | 5 | 7 | 7  
User 8 is not granted because more than 5 sub-frames would have passed since
the UpPCH.
Table CB.3: Four PRACHs, TTI=20ms, WT=4, L =4, SF16 PRACH
Sub-frame Number | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13  
---|---|---|---|---|---|---|---|---|---|---|---|---|---|---  
Users sending on UpPCH | 1 2 | 3 4 | 5 6 | 7 8 |  |  |  |  |  |  |  |  |  |   
Acknowledged user on FPACH |  | 1 | 2 | 3 | 4 | 5 | 6 | 7 |  |  |  |  |  |   
User sending on PRACH 0 |  |  |  |  |  |  | 4 | 4 | 4 | 4 |  |  |  |   
User sending on PRACH 1 |  |  |  |  | 1 | 1 | 1 | 1 | 5 | 5 | 5 | 5 |  |   
User sending on PRACH 2 |  |  |  |  | 2 | 2 | 2 | 2 | 6 | 6 | 6 | 6 |  |   
User sending on PRACH 3 |  |  |  |  |  |  | 3 | 3 | 3 | 3 | 7 | 7 | 7 | 7  
User 8 is not granted because more than 5 sub-frames would have passed since
the UpPCH.
Table CB.4: Two PRACHs, TTI=20ms, WT=4, L =4, SF16 PRACH
Sub-frame Number | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12  
---|---|---|---|---|---|---|---|---|---|---|---|---|---  
Users sending on UpPCH | 1 2 | 3 4 | 5 6 | 7 8 |  |  |  |  |  |  |  |  |   
Acknowledged user on FPACH | X | 1 |  |  | 2 | 3 |  |  | X | X |  |  |   
User sending on PRACH 0 |  |  |  |  |  |  | 2 | 2 | 2 | 2 |  |  |   
User sending on PRACH 1 |  |  |  |  | 1 | 1 | 1 | 1 | 3 | 3 | 3 | 3 |   
The FPACH is used ONLY in sub-frames 0, 1, 4, 5, 8, 9,... because they
correspond to the used RACH resources.
The FPACH in sub-frame 0 is not used because no UpPCH is preceding.
The FPACH in sub-frames 8,9 is not used because no UpPCH is preceding in the
last 4 sub-frames.
In contrast to the previous examples users 4,5,6,7 are not granted because
they would not lead to a RACH anyway. In this example their grant would come
too late.
User 8 is not granted because more than 4 sub-frames would have passed since
the UpPCH.
#