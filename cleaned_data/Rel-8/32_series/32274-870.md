# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document is part of a series of documents that specify charging
functionality and charging management in GSM/UMTS networks. The GSM/UMTS core
network charging architecture and principles are specified in 3GPP TS 32.240
[2], which provides an umbrella for other charging management TSs that
specify:
  * the content of the CDRs per domain / subsystem / service (offline > charging);
  * the content of real-time charging messages per domain / subsystem / > service (online charging);
  * the functionality of online and offline charging for those domains / > subsystems / services;
  * the interfaces that are used in the charging framework to transfer > the charging information (i.e. CDRs or charging events).
The complete document structure for these TSs is defined in 3GPP TS 32.240
[2].
The present document specifies the Offline and Online Charging description for
the Short Message Service (SMS), based on the functional description in 3GPP
TS 23.040 [7] and on the SMS over IP in 3GPP TS 23.204 [8]. The present
document does not replace existing offline SMS charging functionality and
therefore is in addition to that defined in 3GPP TS 32.250 [9] and 3GPP TS
32.251 [10]. This charging description includes the offline and online
charging architecture and scenarios specific to SMS, as well as the mapping of
the common 3GPP charging architecture specified in 3GPP TS 32.240 [1] onto
SMS. It further specifies the structure and content of the CDRs for offline
charging, and the charging events for online charging. The present document is
related to other 3GPP charging TSs as follows:
  * The common 3GPP charging architecture is specified in 3GPP TS 32.240 > [2];
  * The parameters, abstract syntax and encoding rules for the CDRs are > specified in 3GPP TS 32.298 [3];
  * A transaction based mechanism for the transfer of CDRs within the > network is specified in TS 32.295 [6];
  * The file based mechanism used to transfer the CDRs from the network > to the operator's billing domain (e.g. the billing system or a > mediation device) is specified in 3GPP TS 32.297 [5];
  * The 3GPP Diameter application that is used for SMS offline and > online charging is specified in 3GPP TS 32.299 [4].
Furthermore, requirements that govern the charging work are specified in 3GPP
TS 22.115 [102].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 32.240: \"Telecommunication management; Charging management;
Charging architecture and principles\".
[3] 3GPP TS 32.298: \"Telecommunication management; Charging management;
Charging Data Record (CDR) parameter description\".
[4] 3GPP TS 32.299: \"Telecommunication management; Charging management;
Diameter charging application\".
[5] 3GPP TS 32.297: \"Telecommunication management; Charging management;
Charging Data Record (CDR) file format and transfer\".
[6] 3GPP TS 32.295: \"Telecommunication management; Charging management;
Charging Data Record (CDR) transfer\".
[7] 3GPP TS 23.040: \"Technical realization of Short Message Service (SMS)\"
[8] 3GPP TS 23.204: \"Support of Short Message Service (SMS) over generic 3GPP
Internet Protocol (IP) access; Stage 2\"
[9] 3GPP TS 32.250: \"Telecommunication management; Charging management;
Circuit Switched (CS) domain charging\".
[10] 3GPP TS 32.251: \"Telecommunication management; Charging management;
Packet Switched (PS) domain charging\".
[11] 3GPP TS 32.296: \"Telecommunication management; Charging management;
Online Charging System (OCS) applications and interfaces\".
[12] IETF RFC 4006: \"Diameter Credit-Control Application\"
[13] 3GPP TS 32.270: \"Telecommunication management; Charging management;
Multimedia Messaging Service (MMS) charging\".
[14] 3GPP TS 23.038: \"Alphabets and language-specific information\".
[15] 3GPP TS 32.260: \"Telecommunication management; Charging management; IP
Multimedia Services (IMS) charging\".
[16] 3GPP TS 22.142: \" Value Added Services (VAS) for Short Message Service
(SMS) requirements \"
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1], TS 32.240 [2] and the following apply. A term defined in the
present document takes precedence over the definition of the same term, if
any, in TR 21.905 [1] or TS 32.240[2].
**SMS node** : An SMS node, in this specification, refers to either an SMS
router, IP-SM-GW, SMS-SC or a combination of these nodes.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], TS 32.240 [2] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in TR 21.905 [1] or TS 32.240 [2].
# 4 Architecture considerations
## 4.1 High level SMS architecture
The high level SMS architecture is as defined in 3GPP TS 23.040 [7].Only the
SMS Router, SMS-SC and the IP-SM-GW are within the scope of this
specification. The details for the other nodes in the SMS architecture are
defined within 3GPP TS 32.250 [9] and 3GPP TS 32.251 [10].
## 4.2 SMS offline charging architecture
Editor\'s Note: The offline architecture is For Further Study.
## 4.3 SMS online charging architecture
For online charging, the relevant SMS nodes utilise the Ro interface and
application towards the OCS as specified in TS 32.299 [4]. The Ro reference
point covers all online charging functionality required for SMS.
The SMS online charging architecture is depicted in figure 4.3.
Figure 4.3: SMS online charging architecture
Details on the interfaces and functions can be found in TS 32.240 [2] for the
general architecture components, TS 32.296 [11] for the OCS, and 32.299 [4]
for the Ro application.
# 5 SMS charging principles and scenarios
## 5.1 SMS charging principles
### 5.1.1 General principles
The Short Message Service comprises 4 main operational scenarios:
\- Person to Person: The message is sent by a UE as originator and received by
a UE as destination.
\- Person to Application: The message is sent by a UE as originator and
received by a third party application as destination.
\- Application to Person: The message is sent by a third party application as
originator and received by a UE as destination.
\- Application to Application: The message is sent by a third party
application as originator and received by another third party application as
destination.
In addition SMS Nodes may apply services such as value added services
specified in 3GPP TS 22.142 [16], services defined in industry standard
protocols for SM submission from applications in a fixed network (protocols
such as SMPP, UCP/EMI, OIS, CIMD, etc.) or vendor specific services as
endorsed by 3GPP TS 23.040 [7].
As such, the SMS node collects charging information such as:
\- the destination and source addresses applied for an SM;
\- an indication of origination or termination handling;
\- identification of the node(s) and connection(s) involved in the SM
transaction;
\- SM validity period;
\- in scenarios involving an application / VASP, the charging information
describes the identification of the application / VASP;
\- requested SM service type.
### 5.1.2 Segmentation and concatenation
Information about concatenated messages should be sent to the charging systems
in order to apply the appropriate charging models. The charging system may be
required to be stateful to process information about segmented messages.
### 5.1.3 Triggers for generation of charging information
The following service level events shall, based on operator configuration,
trigger the generation of charging information:
\- Simple submission -- based on reception at the SMS node.
\- Enhanced submission -- based on completion of the transaction handling at
the SMS node.
\- Origination retry -- based on the enhanced submission where the initial
handling fails and a redelivery attempt is initiated.
\- Delivery report
\- Termination -- Application to Person scenario only.
\- Termination retry -- Application to Person scenario only -- reattempt
delivery of an SM to a terminating entity;
\- SM service request.
Depending on the charging model applied, a \"refund\" may be necessary for
unsuccessful delivery.
See clause 5.3 for detailed procedures associated with the triggers above.
## 5.2 SMS offline charging scenarios
### 5.2.1 Basic principles
Editor\'s Note: For Further Study.
### 5.2.2 Rf message flows
Editor\'s Note: For Further Study.
### 5.2.3 CDR generation
#### 5.2.3.1 Triggers for xxx-CDR charging information collection
Editor\'s Note: For Further Study.
#### 5.2.3.2 Triggers for xxx-CDR Charging Information Addition
Editor\'s Note: For Further Study.
#### 5.2.3.3 Triggers for xxx-CDR closure
Editor\'s Note: For Further Study.
### 5.2.4 Ga record transfer flows
Editor\'s Note: For Further Study.
### 5.2.5 B~xx~ CDR file transfer
Editor\'s Note: For Further Study.
## 5.3 SMS online charging scenarios
### 5.3.1 Basic principles
SMS online charging uses the Credit Control application as specified in 3GPP
TS 32.299 [4].
SMS charging may use the Immediate Event Charging (IEC) principle or the Event
Charging with Unit Reservation (ECUR) principle as specified in 3GPP TS 32.299
[4]. The chargeable events for subscriber charging are associated with SM
transactions.
An implementation may use either IEC or ECUR for charging events based on
operator configuration.
The units used for quota shall be service specific and based on an SM.
The selection of the OCS is implementation specific as there is no guaranteed
means of providing the OCS address to the CTF.
In addition, SMS charging may use the Refund Account principle when the
operation has not been successfully completed after an Immediate Event
Charging (IEC).
NOTE: For SMSIP, the IP-SM-GW may receive information relevant for online
charging through signalling in IMS.
### 5.3.2 Ro message flows
#### 5.3.2.1 Simple Submission
This clause contains message flows for the different operation models IEC
(figure 5.3.2.1-1) and ECUR (figure 5.3.2.1‑2).
Figure 5.3.2.1-1: Online charging in simple submission for IEC
1) Depending on which SMS mechanism (i.e. SMS or SMSIP) is in operation, the
SMS node receives an incoming SM-Submit or a MAP-Forward-SM.
2) The SMS node triggers a Debit Units Request message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Debit Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the origination procedures.
Figure 5.3.2.1-2: Online charging in simple submission for ECUR
1) Depending on which SMS mechanism (i.e. SMS or SMSIP) is in operation, the
SMS node receives an incoming SM-Submit or a MAP-Forward-SM.
2) The SMS node triggers a Reserve Units Request (Initial) message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Reserve Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the origination procedures.
6) The SM transaction is successfully acknowledged.
7) The SMS node triggers a Reserve Units Request (Terminate) message to the
OCS reporting the successful event transaction.
8) The OCS performs the appropriate credit processing based on the received
request.
9) The OCS responds with a Reserve Units Response message to the SMS node..
#### 5.3.2.2 Enhanced Submission
The enhanced submission procedures are similar to the simple submission
procedures using ECUR. However, the trigger for Reserve Units Request
(Terminate) may be based on unsuccessful handling e.g. negative
acknowledgement and with or without successful storage of the message for
future redelivery attempts. See failure scenarios defined in clause 5.3.2.7.
#### 5.3.2.3 Delivery Report
The origination of delivery reports use the same procedures as the simple
submission procedures as described within clause 5.3.2.1. The delivery report
itself is contained within a new SM.
#### 5.3.2.4 Origination retry
This clause contains message flows for the different operation models IEC
(figure 5.3.2.4-1) and ECUR (figure 5.3.2.4‑2) for redelivery attempts in the
origination direction.
Figure 5.3.2.4-1: Online charging in origination redelivery attempt for IEC
1) An SMS node internal trigger occurs to attempt a redelivery of a previously
failed and stored SM.
2) The SMS node triggers a Debit Units Request message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Debit Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the origination procedures.
Figure 5.3.2.4-2: Online charging in origination redelivery attempt for ECUR
1) An SMS node internal trigger occurs to attempt a redelivery of a previously
failed and stored SM.
2) The SMS node triggers a Reserve Units Request (Initial) message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Reserve Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the origination or termination procedures.
6) The SM transaction is successfully acknowledged.
7) The SMS node triggers a Reserve Units Request (Terminate) message to the
OCS reporting the successful event transaction.
8) The OCS performs the appropriate credit processing based on the received
request.
9) The OCS responds with a Reserve Units Response message to the SMS node.
#### 5.3.2.5 Termination charge
Figure 5.3.2.5-1: Online charging in termination for IEC
1) The SMS node receives an incoming SM-SUBMIT from an application destined
for a mobile recipient.
NOTE: This scenario differs from simple submission charging as described in
subclause 5.3.2.1 in that typically the mobile recipient (instead of
originator or both parties) will be charged for such a short message.
2) The SMS node triggers a Debit Units Request message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Debit Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the termination procedures.
Figure 5.3.2.5-2: Online charging in termination for ECUR
1) The SMS node receives an incoming SM-SUBMIT from an application destined
for a mobile recipient.
NOTE: This scenario differs from simple submission charging as described in
subclause 5.3.2.1 in that typically the mobile recipient (instead of
originator or both parties) will be charged for such a short message.
2) The SMS node triggers a Reserve Units Request (Initial) message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Reserve Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the termination procedures.
6) The SM transaction is successfully acknowledged.
7) The SMS node triggers a Reserve Units Request (Terminate) message to the
OCS reporting the successful event transaction.
8) The OCS performs the appropriate credit processing based on the received
request.
9) The OCS responds with a Reserve Units Response message to the SMS node.
#### 5.3.2.6 Termination charge retry
Figure 5.3.2.6-1: Online charging in termination redelivery attempt for IEC
1) An SMS node internal trigger occurs to attempt a redelivery of a previously
failed and stored SM.
2) The SMS node triggers a Debit Units Request message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Debit Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the termination procedures.
Figure 5.3.2.6-2: Online charging in termination redelivery attempt for ECUR
1) An SMS node internal trigger occurs to attempt a redelivery of a previously
failed and stored SM.
2) The SMS node triggers a Reserve Units Request (Initial) message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Reserve Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the termination procedures.
6) The SM transaction is successfully acknowledged.
7) The SMS node triggers a Reserve Units Request (Terminate) message to the
OCS reporting the successful event transaction.
8) The OCS performs the appropriate credit processing based on the received
request.
9) The OCS responds with a Reserve Units Response message to the SMS node.
#### 5.3.2.7 Unsuccessful transaction
Unsuccessful transaction after IEC
The following flow in figure 5.3.2.7-1 only applies where a refund action is
required for unsuccessful delivery.
Figure 5.3.2.7-1: Unsuccessful transaction after IEC
1) The SMS node receives a trigger to attempt delivery of an SM. This may be
for origination, termination or redelivery attempt.
2) The SMS node triggers a Debit Units Request message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Debit Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
origination or termination procedures.
6) The SM transaction is acknowledged as an unsuccessful transaction (either
via explicit signalling or an internal trigger).
7) The SMS node triggers a Debit Units Request (Refund Account) message to the
OCS.
8) The OCS performs the appropriate refund processing based on the received
request.
9) The OCS responds with a Debit Units Response (Refund Account) message to
the SMS node.
Unsuccessful transaction in ECUR
Figure 5.3.2.7-2: Unsuccessful transaction for ECUR
1) The SMS node receives a trigger occurs to attempt delivery of an SM. This
may be for origination, termination or redelivery attempt.
2) The SMS node triggers a Reserve Units Request (Initial) message to the OCS.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Reserve Units Response message to the SMS node.
5) If authorised, the SMS node continues the SM processing as appropriate for
the origination or termination procedures.
6) The SM transaction is acknowledged as an unsuccessful transaction (either
via explicit signalling or an internal trigger).
7) The SMS node triggers a Reserve Units Request (Terminate) message to the
OCS reporting the used unit for the service to zero. This characterizes the
unsuccessful event transaction.
8) The OCS performs the appropriate credit processing based on the received
request.
9) The OCS responds with a Reserve Units Response message to the SMS node.
#### 5.3.2.8 IMS/SMS Interworking Messages Charging
This clause contains message flows for the different operation models IEC
(figure 5.3.2.8-1) and ECUR (figure 5.3.2.8‑2) for IMS/SMS Interworking
messages in the origination direction.
Figure 5.3.2.8-1: Online charging in origination IMS/SMS Interworking Messages
for IEC
1) The IP-SM-GW receives an incoming SIP MESSAGE.
2) The IP-SM-GW parses the SIP MESSAGE.
3) The IP-SM-GW triggers a Debit Units Request message to the OCS.
4) The OCS performs the appropriate credit processing based on the received
Debit Units Request.
5) The OCS responds with a Debit Units Response message to the IP-SM-GW.
6) IP-SM-GW converts the SIP MESSAGE to 1 or n (n>=1) short messages.
7) If authorised, the IP-SM-GW forwards the segmented short messages.
Figure 5.3.2.8-2: Online charging in origination IMS/SMS Interworking Messages
for ECUR
1) The IP-SM-GW receives an incoming SIP MESSAGE.
2) The IP-SM-GW parses the SIP MESSAGE.
3) The IP-SM-GW triggers a Reserve Units Request (Initial) message to the OCS.
4) The OCS performs the appropriate credit processing based on the received
Reserve Units Request.
5) The OCS responds with a Reserve Units Response message to the IP-SM-GW.
6) IP-SM-GW converts the SIP MESSAGE to 1 or n (n>=1) short messages.
7) If authorised, the IP-SM-GW forwards segmented short messages.
8) All the short messages transactions are successfully acknowledged.
9) The IP-SM-GW triggers a Reserve Units Request (Terminate) message to the
OCS reporting the successful event transaction.
10) The OCS performs the appropriate credit processing based on the received
request.
11) The OCS responds with a Reserve Units Response message to the IP-SM-GW.
#### 5.3.2.9 Simple Submission with SM service request
This clause contains message flows for operation models IEC (figure 5.3.2.9-1)
where application of a SM service is subject to charging independent from the
SM submission.
Editors Note: Simple SM submission with SM service request for operation model
ECUR is FFS.
Figure 5.3.2.9-1: Online charging in simple submission with SM service request
for IEC
1) Depending on which SMS mechanism (i.e. SMS or SMSIP) is in operation, the
SMS node receives an incoming SM-Submit or a MAP-Forward-SM which includes a
SM service request (such as forwarding or SM copy).
2) The SMS node triggers a Debit Units Request message to the OCS for the SM
submission.
3) The OCS performs the appropriate credit processing based on the received
request.
4) The OCS responds with a Debit Units Response message for the SM submission
to the SMS node.
5) If normal SM processing is authorized in step 4, the SMS Node analyzes the
SM and detects that a SM service must be applied that is subject to charging.
6) If a SM service subject to charging is detected in step 5, the SMS node
triggers an additional Debit Units Request message to the OCS for the
requested SM service.
7) The OCS performs the appropriate credit processing based on the received
request.
8) The OCS responds with a Debit Units Response message for the requested SM
service to the SMS node.
9) If authorised in step 7, the SMS node applies the requested SM service.
> NOTE 1: Depending on the nature of the requested SM service, \"service
> application\" may involve creating additional messages (for example in case
> of a SM copy service). This is deemed part of step 9 and not otherwise shown
> in this diagram.
10) If authorised in step 4, the SMS node continues the SM processing as
appropriate for the origination procedures.
> NOTE 2: Authorization of SM processing is independent of the authorization
> for application of a SM service. I.e. If authorization is for SM processing
> is granted in step 4 but authorization for SM service is refused in step 8
> SM processing appropriate for the originating service continues without
> applying the requested SM service.
### 5.3.3 Credit Control related
#### 5.3.3.1 Triggers for stopping for an SMS Credit Control session
Used in ECUR only, a Debit / Reserve Units Request message to terminate the
credit control session is sent to OCS when:
\- Validity time for granted quota expires
\- Granted quota runs out (i.e. a successful event has occurred)
\- Abort-Session-Request is received from the OCS
The expiration of the validity time for quota does not require the SMS
procedures to be terminated. The CTF shall be configurable as to whether on
expiration of validity time, the service should be aborted or not; i.e.
whether the stored message should be deleted and no further (re-)delivery
attempt should be made.
#### 5.3.3.2 Triggers for providing interim information for a SMS Credit
Control session
The provision of interim information for credit control is not used in this
release of the specification, due to the use of IEC and ECUR.
# 6 Definition of charging information
## 6.1 Data description for SMS offline charging
### 6.1.1 Rf message contents
#### 6.1.1.1 Summary of Offline Charging Message Formats
Editor\'s Note: For Further Study.
#### 6.1.1.2 Structure for the Accounting Message Formats
##### 6.1.1.2.1 Accounting-Request Message
Editor\'s Note: For Further Study.
##### 6.1.1.2.2 Accounting-Answer Message
Editor\'s Note: For Further Study.
### 6.1.2 Ga message contents
Editor\'s Note: For Further Study.
### 6.1.3 CDR description on the B~xx~ interface
Editor\'s Note: For Further Study.
## 6.2 Data description for SMS online charging
### 6.2.1 Ro message contents
#### 6.2.1.0 General
The SMS node generates Debit / Reserve Units information that can be
transferred from the CTF to the OCF. For this purpose, SMS online charging
utilises the _Debit Units and Reserve Units_ procedure that is specified in
the 3GPP Debit / Reserve Units operation in 3GPP TS 32.299 [4].
The SMS node generates refund information that can be transferred from the CTF
to the OCF. For this purpose, it uses REFUND procedure defined in IETF RFC
4006 [12] with extended AVPs.
The _Debit / Reserve Units_ procedure employs the _Debit / Reserve Units
Request_ and _Debit / Reserve Units Response_ messages.
The Refund Account procedure employs the Debit Units Request (Refund Account)
request and response messages.
Table 6.2.1 describes the use of these messages for SMS online charging.
Table 6.2.1: SMS Online Charging Messages contents
* * *
Command-Name Source Destination  
Debit / Reserve Units Request CTF OCS  
Debit / Reserve Units Response OCS CTF
* * *
This clause 6.2.1 describes the different fields used in the credit control
messages.
Detailed descriptions of the fields are provided in 3GPP TS 32.299 [4].
#### 6.2.1.1 Summary of Message Formats
#### 6.2.1.2 Structure for the Credit Control Message Formats
##### 6.2.1.2.1 Debit/Reserve Units Request Message
Table 6.2.1.2.1 illustrates the basic structure of a _Debit / Reserve Units
Request_ message from SMS node as used for SMS online charging.
Table 6.2.1.2.1: _Debit / Reserve Units Request_ Message Contents for SMS
* * *
Field Category Description Session Identifier M This field identifies the
operation session. Originator Host M This field contains the identification of
the source point of the operation. Originator Domain M This field contains the
realm of the operation originator. Destination Domain M This field contains
the realm of the operation destination. Operation Identifier M This field is a
unique operation identifier. Operation Token M This field contains the service
context, i.e. SMS charging. Operation Type M This field defines the transfer
type: event for immediate event based charging and initial, terminate for ECUR
based charging. Operation Number M This field contains the sequence number of
the transferred messages. Destination Host O**~C~** This field contains the
identification of the destination point of the operation. User Name O**~C~**
This field contains the identification of the source node. Origination State
O**~C~** Used for ECUR only. Origination Timestamp O**~C~** This field
contains the time when the operation is requested. Subscriber Identifier
O**~M~** This field contains the identification of the subscriber (i.e.
MSISDN) that uses the requested service. Termination Cause O**~C~** This field
contains information about the cause for termination of a credit control
session. Used for terminating credit control sessions in ECUR only. Requested-
Action O**~C~** This field contains the requested action, used for IEC only.
Multiple Operation O**~M~** This field indicate the occurrence of multiple
operations. Used for ECUR only Multiple Unit Operation O**~C~** This field
contains the parameter for the quota management. Used for ECUR only Subscriber
Equipment Number O**~C~** This field contains the identification of the user
equipment used to access service. Included if information is made available to
the node. Proxy Information O**~C~** This field contains the parameter of the
proxy. Route Information O**~C~** This field contains the parameter of the
route. Service Information O**~M~** This field holds the SMS specific
parameter and is described in clause 6.3.
* * *
##### 6.2.1.2.2 Debit / Reserve Units Response Message
Table 6.2.1.2.2 illustrates the basic structure of a Debit / Reserve Units
Response message as used for SMS charging. This message is always used by the
OCS as specified below, independent of the receiving SMS node and the
operation type that is being replied to.
Table 6.2.1.2.2: Debit / Reserve Units Response Message Contents for SMS
* * *
Field Category Description Session Identifier M This field identifies the
operation session. Operation Result M This field identifies the result of the
operation. Originator Host M This field contains the identification of the
source point of the operation. Originator Domain M This field contains the
realm of the operation originator. Operation Identifier M This field is a
unique operation identifier. Operation Type M This field defines the transfer
type: event for event based charging and start, interim, stop for session
based charging. Operation Number M This field contains the sequence number of
the transferred messages. Operation Failover - Not used for SMS in 3GPP.
Multiple Unit Operation O**~C~** This field contains the parameter for the
quota management. Used in IEC for refund purpose and in ECUR. Operation
Failure Action O**~C~** This field defines the resulting operation at the SMS
node if a failure has occurred at the OCS for ECUR. Operation Event Failure
Action O~C~ This field defines the resulting operation at the SMS node if a
failure has occurred at the OCS for IEC. Redirection Host O~C~  
Redirection Host Usage O~C~  
Redirection Cache Time O~C~  
Proxy Information O~C~ This field contains the parameter of the proxy. Route
Information O~C~ This field contains the parameter of the route. Failed
parameter O~C~ This field contains missing and/or unsupported parameter that
caused the failure. Service Information O~C~ This field contains SMS specific
information.
* * *
Editor\'s Note: The mechanism to carry refund information is For Future Study.
## 6.3 SMS charging specific parameters
### 6.3.1 Definition of the SMS charging information
#### 6.3.1.1 SMS charging information assignment for Service-Information
The components in the Service Information that are use for SMS charging can be
found in table 6.3.1.1.
Table 6.3.1.1: Service Information used for SMS Charging
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Service Information | O~M~ | This is a structured field | | | | and holds the 3GPP | | | | specific parameter as | | | | defined in TS 32.299 | | | | [50]. For SMS Charging | | | | the SMS-Information and | | | | selected parameters of MMS | | | | Information,PS-Information | | | | and IMS information are | | | | used. | +----------------------------+----------+----------------------------+ | SMS Information | O~M~ | This is a structured field | | | | and holds the SMS specific | | | | parameters. The details | | | | are defined in table | | | | 6.3.1.2. | +----------------------------+----------+----------------------------+ | MMS Information | O~M~ | This is a structure field | | | | and the following | | | | parameters are specific to | | | | SMS. The complete | | | | structure is defined in | | | | 3GPP TS 32.270 [13] | +----------------------------+----------+----------------------------+ | Originator Address | O~M~ | This field holds the | | | | address of the originator | | | | of the SM. This will | | | | typically be an E.164 | | | | number or a shortcode. | | | | Multiple addresses may be | | | | carried if additional | | | | information is available, | | | | e.g. IMSI and E.164 | | | | number. | +----------------------------+----------+----------------------------+ | | | | +----------------------------+----------+----------------------------+ | Submission Time | O~C~ | This field holds the | | | | timestamp of when the | | | | submitted SM arrived at | | | | the originating SMS Node. | | | | The information to | | | | populate this field is | | | | obtained from the | | | | TP | | | | -Service-Center-Time-Stamp | | | | (TP-SCTS) as defined in | | | | 3GPP TS 23.040 [7]. If a | | | | refund or retransmission | | | | is required, the timestamp | | | | carries the timestamp | | | | associated with the | | | | original submitted SM. | +----------------------------+----------+----------------------------+ | Priority | O~C~ | This field holds any | | | | priority information | | | | associated with an SM.\ | | | | Applicable to terminating | | | | procedures only. Priority | | | | handling is defined in | | | | 3GPP TS 23.040 [13]. The | | | | value "low" is not | | | | applicable. | +----------------------------+----------+----------------------------+ | Message Id | O~M~ | This field carries the | | | | identity used to identify | | | | an SM in the SMS node | | | | associated with entity | | | | that submitted it. The | | | | information to populate | | | | this field is obtained | | | | from the | | | | TP-Message-Reference | | | | (TP-MR) as defined in 3GPP | | | | TS 23.040 [7]. | +----------------------------+----------+----------------------------+ | Message Size | O~M~ | This field carries the | | | | length of the user data | | | | part of the SM. The | | | | information to populate | | | | this field is obtained | | | | from the | | | | TP-User-Data-Length | | | | (TP-UDL) as defined in | | | | 3GPP TS 23.040 [7] | +----------------------------+----------+----------------------------+ | Message Class | O~M~ | Used as defined in 3GPP TS | | | | 32.270 [13]. It is | | | | implementation dependent | | | | the value selected for a | | | | specific transaction. | +----------------------------+----------+----------------------------+ | Delivery Report Requested | O~C~ | This field indicates | | | | whether a delivery report | | | | is requested by the SM | | | | originator. The | | | | information to populate | | | | this field is obtained | | | | from the | | | | TP-Status-Report-Request | | | | (TP-SRR) as defined in | | | | 3GPP TS 23.040 [7] | +----------------------------+----------+----------------------------+ | PS Information | O~C~ | This is a structured field | | | | and the following | | | | parameters are specific to | | | | SMS. The complete | | | | structure is defined in TS | | | | 32.251 [11]. | +----------------------------+----------+----------------------------+ | PDP Address | O~C~ | This field holds the IP | | | | address used by the | | | | subscriber for the SMS | | | | transaction. Included if | | | | the SMS node is the | | | | IP-SM-GW. | +----------------------------+----------+----------------------------+ | 3GPP User Location Info | O~C~ | This field holds the | | | | information about the | | | | location of the subscriber | | | | during the SMS | | | | transaction. | +----------------------------+----------+----------------------------+ | 3GPP RAT Type | O~C~ | This field holds | | | | information about the | | | | radio access technology | | | | used for the SMS | | | | transaction. | +----------------------------+----------+----------------------------+ | IMS Information | O~C~ | This is a structured field | | | | and the following | | | | parameters are specific to | | | | SMS. The complete | | | | structure is defined in TS | | | | 32.260 [15]. | +----------------------------+----------+----------------------------+ | User Session Id | O~C~ | This field holds the | | | | session identifier. For a | | | | SIP session the Session-ID | | | | contains the SIP Call ID. | +----------------------------+----------+----------------------------+ | > **Number Portability | O~C~ | This field includes | | > routing information** | | information on number | | | | portability after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network. | +----------------------------+----------+----------------------------+ | > **Carrier Select routing | O~C~ | This field includes | | > information** | | information on carrier | | | | select after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network. | +----------------------------+----------+----------------------------+
#### 6.3.1.2 Definition of the SMS Information
The components in the SMS Information that are used for SMS charging can be
found in table 6.3.1.2.
Table 6.3.1.2: SMS Information used for SMS Charging
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | SMS Node | O~M~ | Identifies the SMS Node as | | | | IP-SM-GW or SMS Router or | | | | a combined IP-SM-GW / SMS | | | | Router or as SMS-SC. | +----------------------------+----------+----------------------------+ | SM Client Address | O~M~ | This field holds the | | | | address of the SMS node to | | | | which the charging system | | | | is connected to. This may | | | | be the same as the SMSC | | | | Address field. | +----------------------------+----------+----------------------------+ | Originator SCCP Address | O~C~ | This field holds the SCCP | | | | calling address used to | | | | receive the SM at the SMS | | | | node. Only present if | | | | SMSIP is not used for the | | | | inward connection. | +----------------------------+----------+----------------------------+ | Originator Received | O~C~ | This field holds the | | Address | | original, unmodified | | | | address of the originator | | | | of the SM, as received by | | | | the SMS node, in case | | | | address manipulation (such | | | | as number plan | | | | corrections) have been | | | | applied in the SMS node. | | | | This will typically be an | | | | E.164 number or a | | | | shortcode. Multiple | | | | addresses may be carried | | | | if additional information | | | | is available, e.g. IMSI | | | | and E.164 number. | +----------------------------+----------+----------------------------+ | Recipient Info | Oc | This field holds recipient | | | | information for the SM. | | | | Each occurrence of this | | | | field denotes a different | | | | recipient. | | | | | | | | Multiple occurrences of | | | | this field are allowed in | | | | case\ | | | | - multiple recipients are | | | | associated with the | | | | charged event and | | | | | | | | - all other charging | | | | information is identical | | | | for all recipients. | | | | | | | | In case the SM contains a | | | | Delivery Report, as | | | | described in subclause | | | | 5.3.2.3, this field | | | | identifies the recipient | | | | of this Delivery Report. | | | | This recipient information | | | | must correspond to the | | | | originator information of | | | | the message that triggered | | | | this Delivery Report. | | | | (Note 2) | +----------------------------+----------+----------------------------+ | Recipient Address | Oc | This field holds the | | | | address of the recipient | | | | of the SM. This will | | | | typically be an E.164 | | | | number or a shortcode. | | | | Multiple addresses may be | | | | carried if additional | | | | information is available, | | | | e.g. shortcode or IMSI and | | | | E.164 number. | +----------------------------+----------+----------------------------+ | Recipient Received Address | O~C~ | This field holds the | | | | original, unmodified | | | | address of the recipient | | | | of the SM, as received by | | | | the SMS node, in case | | | | address manipulation (such | | | | as number plan | | | | corrections) have been | | | | applied in the SMS node. | | | | This will typically be an | | | | E.164 number or a | | | | shortcode. Multiple | | | | addresses may be carried | | | | if additional information | | | | is available, e.g. | | | | shortcode or IMSI and | | | | E.164 number. | +----------------------------+----------+----------------------------+ | Recipient SCCP Address | O~C~ | This field holds the SCCP | | | | called address used by the | | | | SMS node to onward deliver | | | | the SM. Only present if | | | | SMSIP is not used for the | | | | outward connection. | +----------------------------+----------+----------------------------+ | SM Destination Interface | O~M~ | This is a structured field | | | | containing information | | | | describing the interface | | | | on which the SM is to be | | | | delivered (i.e. the next | | | | hop) | | | | | | | | In case the charging event | | | | is for person to | | | | application messaging or | | | | for application to | | | | application messaging (see | | | | subclause 5.1.1) this | | | | field holds the | | | | identification of the | | | | application. (See also | | | | Note 3) | +----------------------------+----------+----------------------------+ | SM Protocol Id | O~C~ | This field holds the | | | | TP-PROTOCOL-ID (TP-PID) as | | | | defined in 3GPP TS 23.040 | | | | [7]. This field relates | | | | to the recipient when | | | | charging MT SMS messages | | | | as specified in 32.240 | | | | [1]. | +----------------------------+----------+----------------------------+ | SMSC Address | O~M~ | This field holds the | | | | address of the SMSC to | | | | which the originating or | | | | terminating SM is directed | | | | to. | +----------------------------+----------+----------------------------+ | SM Data Coding Scheme | O~M~ | This field holds the data | | | | coding scheme used within | | | | the SM. The information to | | | | populate this field is | | | | obtained from TP-DCS | | | | header. | +----------------------------+----------+----------------------------+ | | | | +----------------------------+----------+----------------------------+ | SM Message Type | O~M~ | This field identifies the | | | | message that triggered the | | | | generation of charging | | | | information. | +----------------------------+----------+----------------------------+ | SM Originator Interface | O~M~ | This is a structured field | | | | containing information | | | | describing the interface | | | | on which the SM was | | | | received by the SMS node | | | | (i.e. the previous hop) | | | | | | | | In case the charging event | | | | is for application to | | | | person messaging or for | | | | application to application | | | | messaging (see subclause | | | | 5.1.1) this field holds | | | | the identification of the | | | | application. (See also | | | | Note 3) | +----------------------------+----------+----------------------------+ | SM Protocol Id | O~C~ | This field holds the | | | | TP-PROTOCOL-ID (TP-PID) as | | | | defined in 3GPP TS 23.040 | | | | [7] This field relates | | | | to the originator when | | | | charging MO SMS messages | | | | as specified in 32.240 | | | | [1]. | +----------------------------+----------+----------------------------+ | SM Reply Path Requested | O~C~ | This field carries an | | | | indication of whether a | | | | reply SM to an original SM | | | | shall follow the same path | | | | as identified by the | | | | TP-Reply-Path (TP-RP) | | | | flag. | +----------------------------+----------+----------------------------+ | SM User Data Header | O~C~ | This field carries the | | | | user data header extracted | | | | from the user data of the | | | | SM. The user data header | | | | (TP-UDH) is specified in | | | | 3GPP TS 23.040 [7] | +----------------------------+----------+----------------------------+ | SM Status | O~C~ | This field holds the | | | | information from the | | | | TP-Status field in a | | | | Status-Report TPDU. This | | | | information is only | | | | applicable to delivery | | | | report charging procedures | | | | or where ECUR is employed. | +----------------------------+----------+----------------------------+ | SM Discharge Time | O~C~ | This field holds the time | | | | associated with the event | | | | being reported in the SM | | | | Status field. This | | | | information is only | | | | applicable to delivery | | | | report charging | | | | procedures. | +----------------------------+----------+----------------------------+ | Number of Messages Sent | O~C~ | Indicates the number of | | | | SMSs sent by the IMS | | | | application if applicable. | +----------------------------+----------+----------------------------+ | SM Service Type | O~C~ | This field indicates the | | | | type of SM service that | | | | caused the charging | | | | interaction. It is only | | | | applicable for SM | | | | supplementary service | | | | procedures. | +----------------------------+----------+----------------------------+
NOTE 1: The case of multi-destinations of SMS refers to SMS and Internet
Electronic Mail interworking as specified in subsclause 3.8 of TS 23.040 [7]
NOTE 2: Implementations vary as to the originator address that is presented to
an end user for a Delivery Report. Typically the originator address either
identifies the SMS node that generated the Delivery Report or the originator
address of a Delivery Report identifies the recipient of the original message
that triggered this Report. It is expected that the charging event contains
the information presented to the end user.
NOTE 3: There is a distinction between short numbers (as conveyed in
originator and/or recipient address fields) and the identification of SM
applications (as carried in SM Originator Interface and/or SM Destination
Interface). Short numbers are used by end users to address a service of an
applications. Multiple short numbers may map to one application capable of
multiple services. The identification of an application is how an application
is know to the operator.
### 6.3.2 Formal parameter description
#### 6.3.2.1 SMS charging information for CDRs
Editor's Note: For Future Study.
#### 6.3.2.2 SMS charging information for charging events
Editor's Note: For Future Study.
#