# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the stage 3 of the PMIPv6 Based Mobility and
Tunnelling Protocols used over the PMIP-based S2a, S2b, S5, and S8 reference
points defined in 3GPP TS 23.402 [3], and are thus applicable to the Serving
GW, PDN Gateway, ePDG, and Trusted Non-3GPP Access. Protocols specifications
are compliant with relevant IETF RFCs. In this specification PMIP refers to
PMIPv6 as defined in IETF RFC5213 [4].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.401: \"GPRS enhancements for E-UTRAN access \".
[3] 3GPP TS 23.402: \"Architecture Enhancements for non-3GPP accesses\".
[4] IETF RFC 5213: \"Proxy Mobile IPv6\".
[5] IETF Draft, \"IPv4 Support for Proxy Mobile IPv6\", draft-ietf-netlmm-
pmip6-ipv4-support-17, work in progress.
[6] IETF Draft, \"Binding Revocation for IPv6 Mobility\", draft-ietf-mext-
binding-revocation-14, work in progress.
[7] IETF Draft, \"GRE Key Option for Proxy Mobile IPv6\", draft-ietf-netlmm-
grekey-option-09, work in progress.
[8] IETF RFC 3775, \"Mobility Support in IPv6\".
[9] IETF RFC 4282: \"The Network Access Identifier\".
[10] IETF RFC 4283: \"Mobile Node Identifier Option for Mobile IPv6 (MIPv6)\".
[11] IETF RFC 5149: \"Service Selection for Mobile Ipv6\".
[12] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[13] 3GPP TS 23.007: \"Restoration Procedures\".
[14] Void
[15] Void
[16] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core
network protocols\".
[17] IETF Draft, draft-ietf-netlmm-pmipv6-heartbeat-07, \"Heartbeat Mechanism
for Proxy Mobile IPv6\", work in progress.
[18] IANA Mobile Ipv6 Parameters Registry,
\.
[19] 3GPP TS 33.402: \"3GPP System Architecture Evolution (SAE); Security
aspects of non-3GPP accesses\".
[20] IETF RFC 2784: \"Generic Routing Encapsulation (GRE)\".
[21] IETF RFC 2890: \"Key and Sequence Number Extensions to GRE\".
[22] 3GPP TS 29.274: \"3GPP Evolved Packet System (EPS); Evolved General
Packet Radio Service (GPRS) Tunnelling Protocol for Control plane (GTPv2-C);
Stage 3\".
[23] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[24] 3GPP TS 29.282: \"Mobile IPv6 vendor specific option format and usage
within 3GPP\".
[25] 3GPP TS 32.251: \"Charging Management; Packet Switched (PS) domain
charging\".
[26] 3GPP TS 32.298: \"Charging Management; Charging Data Record (CDR)
parameter description\".
[27] IETF RFC 4291: \"IP Version 6 Addressing Architecture\".
[28] 3GPP TS 29.060: \"General Packet Radio Service (GPRS); GPRS Tunnelling
Protocol (GTP) across the Gn and Gp interface\".
[29] ITU-T Recommendation E.164: \"The international public telecommunication
numbering plan\".
[30] 3GPP TS 29.212: \"Policy and Charging Control over Gx reference point\".
[31] IETF RFC 2473: \"Generic Packet Tunneling in IPv6 Specification\".
[32] IANA Registry of Assigned Numbers. Mobile IPv6 parameters, Status Codes:
http://www.iana.org/assignments/mobility-parameters/mobility-
parameters.xhtml#mobility-parameters-6.
[32] IANA Registry of Assigned Numbers. Mobile IPv6 parameters, Binding
Revocation Acknowledgement Status Codes:
http://www.iana.org/assignments/mobility-parameters/mobility-
parameters.xhtml#binding-revocation-status-codes.
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
The following terms used in this Technical Specification are defined in the
PMIPv6 specification IETF RFC 5213 [4]: IPv6 Home Network Prefix, Proxy Care-
of Address, Local Mobility Anchor Address. The following terms used in this
Technical Specification are defined in the IPv4 Support for PMIPv6
specification IETF Draft draft-ietf-netlmm-pmip6-ipv4-support [5]: IPv4 Home
Address, IPv4 Local Mobility Anchor Address. The following terms used in this
Technical Specification are defined in the MIPv6 specification [8] and
extended by the PMIPv6 specification IETF RFC 5213 [4]: Binding Cache Entry,
Binding Update List Entry. The following terms used in this specification are
defined in the Binding Revocation for MIPv6 Mobility [6]: Binding Revocation
Indication and Binding Revocation Acknowledgement.
**Local Mobility Anchor:** Within EPS the Local Mobility Anchor functionality
consists of a PMIPv6 Local Mobility Anchor as described in the PMIPv6
specification IETF RFC 5213 [4] with support of IPv4 Support for PMIPv6 as
defined in IETF Draft draft-ietf-netlmm-pmip6-ipv4-support [5], Binding
Revocation for IPv6 Mobility as defined in IETF Draft draft-ietf-mext-binding-
revocation [6], GRE Key Option for PMIPv6 as defined in IETF Draft draft-ietf-
netlmm-grekey-option [7], and PMIPv6 Heartbeat Mechanism as defined in IETF
Draft draft-netlmm-pmipv6-heartbeat [17].
**Mobile Access Gateway:** Within EPS the Mobility Access Gateway
functionality consists of a PMIPv6 Mobility Access Gateway as described in the
PMIPv6 specification IETF RFC 5213 [4] with support of IPv4 Support for PMIPv6
as defined in IETF Draft draft-ietf-netlmm-pmip6-ipv4-support [5], Binding
Revocation for IPv6 Mobility as defined in IETF Darft draft-ietf-mext-binding-
revocation [6], GRE Key Option for PMIPv6 as defined in IETF Draft draft-ietf-
netlmm-grekey-option [7], and PMIPv6 Heartbeat Mechanism as defined in IETF
Draft draft-netlmm-pmipv6-heartbeat [17].
**PDN Connection:** The association between a UE represented by one IPv4 Home
Address and/or one IPv6 Home Network Prefix, and a PDN represented by an APN.
On a PMIPv6 peer (MAG or LMA) there is a one-to-one mapping between a PDN
connection and a PMIPv6 binding.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
3GSPEC 3GPP Specific PMIPv6 Error Code
BCE Binding Cache Entry
BRA Binding Revocation Acknowledgement
BRI Binding Revocation Indication
BULE Binding Update List Entry
EPC Evolved Packet Core
GRE Generic Routing Encapsulation
GW Gateway
IPv4-LMAA IPv4 LMAA
LMA Local Mobility Anchor
LMAA LMA Address
MAG Mobility Access Gateway
MIPv6 Mobile IPv6
PBA Proxy Binding Acknowledgment
PBU Proxy Binding Update
PMIPv6 Proxy MIPv6
Proxy-CoA Proxy Care-of Address
# 4 General
## 4.1 PDN connection
On a PMIPv6 peer (MAG or LMA) there is a one-to-one mapping between a PDN
connection and a PMIPv6 binding.
Traffic sent over a given PDN connection is encapsulated with GRE [20] using
different, per-interface per-PDN connection, per direction (uplink and
downlink) GRE keys [21] to allow multiplexing and demultiplexing of traffic
belonging to different PDN connections at MAG and LMA. For the handover
between 3GPP access and non-3GPP access, the uplink GRE Key shall be the same.
## 4.2 PMIPv6 protocol stacks
Protocol stacks for PMIPv6 are depicted in Figure 4.2-1. The MAG functions are
defined in 3GPP TS 23.402 [3], e. g., relaying DHCPv4/DHCPv6 packets between
the UE and the DHCP server, forwarding the payload packets between the UE and
the LMA.
Figure 4.2-1: Protocols stacks for PMIP
The Control Plane A is for PMIPv6 signals transported over IPv4, and the
Control Plane B is for PMIPv6 signals transported over IPv6. When IPv4
transport is used, UDP encapsulation may be used as described in draft-ietf-
netlmm-pmip6-ipv4-support [5].
# 5 Mobility Management procedures
## 5.1 Proxy Mobile IPv6 PDN Connection Creation procedure
### 5.1.1 General
The PMIPv6 PDN Connection Creation procedure is initiated by the node acting
as a MAG to create a new PDN connection with the node acting as an LMA for an
UE that either attaches for the first time to the EPC, or connects to an
additional PDN. The procedure starts with the MAG sending a PBU including the
APN to the LMA to register with the LMA a binding for the UE\'s PDN
connection. The LMA confirms establishment of the binding by sending a PBA to
the MAG. Establishment of the binding achieves the following:
  * **PDN selection:** The LMA select the PDN based on the APN contained in the PBU.
  * **IPv6 Home Network Prefix assignment:** The LMA assigns to the UE\'s PDN connection an IPv6 Home Network Prefix valid in the selected PDN.
  * **IPv4 Home Address assignment:** The LMA assigns to the UE\'s PDN connection an IPv4 Home Address valid in the selected PDN.
  * **Downlink and Uplink GRE Key Assignment:** The MAG and LMA will establish downlink and uplink GRE keys to be used for GRE encapsulation of the PDN connection\'s downlink and uplink traffic, respectively.
  * **GRE Tunnel Establishment:** A GRE tunnel is established between the MAG and LMA with the assigned GRE keys to carry uplink and downlink traffic that the UE respectively sends and receives on the PDN connection.
  * **BCE Creation:** The LMA creates a BCE for the PDN connection.
  * **BULE Creation:** The MAG creates a BULE for the PDN connection.
  * **MAG Link Local Address assignment:** The LMA assigns the MAG link local address.
  * **UE Interface Identifier (IID) assignment:** The LMA assigns to the UE an IPv6 Interface Identifier to allow formation of an UE Link Local Address from the well-known link local address prefix (fe80::/64).
#### 5.1.1.1 Proxy Binding Update
The fields of a PBU message for the PMIPv6 PDN Connection Creation procedure
are depicted in Table 5.1.1.1-1.
The Mobility Options in a PBU message for the PMIPv6 PDN Connection Creation
procedure are depicted in Table 5.1.1.1-2.
Other flags are not used by this specification.
Table 5.1.1.1-1: Fields of a PBU message for the PMIPv6 PDN Connection
Creation procedure
* * *
Information element IE Description Reference Sequence Number Set to a locally
(i.e. per MAG) monotonically increasing value. IETF RFC 5213 [4] Lifetime Set
to the requested number of time units the binding shall remain valid. IETF RFC
3775 [8] Acknowledge (A) Set to \"1\" to request an acknowledgement message.
IETF RFC 3775 [8] Proxy Registration Flag (P) Set to \"1\" to indicate that
the Binding Update message is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.1.1.1-2: Mobility Options in a PBU message for the PMIPv6 PDN
Connection Creation procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS 23.003 | | Identifier option | | identifier of the | [12] | | | | UE as specified | | | | | in 3GPP TS 23.003 | | | | | [12]. The | | | | | format of the NAI | | | | | is specified in | | | | | the subclause | | | | | 19.3 in 3GPP TS | | | | | 23.003 [12]. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | For dynamic | IETF RFC 5213 | | Prefix option | | allocation, set | [4] | | | | to the value | | | | | \"0::/0\" to | | | | | request | | | | | allocation for | | | | | the UE\'s PDN | | | | | connection of an | | | | | IPv6 Home Network | | | | | Prefix in the PDN | | | | | corresponding the | | | | | EPS Access Point | | | | | Name. For static | | | | | allocation, set | | | | | to the received | | | | | static allocated | | | | | IPv6 Home Network | | | | | Prefix. NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Link-local | C | Present when IPv6 | IETF RFC 5213 | | Address | | Home Network | [4] | | | | Prefix option is | | | | | present. | | | | | Link-local | | | | | address of the | | | | | MAG. Set to | | | | | ALL_ZERO (all | | | | | bits set to 0), | | | | | indicating that | | | | | the MAG requests | | | | | a link-local | | | | | address to be | | | | | used on the | | | | | access link | | | | | shared with the | | | | | UE. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Set to the value | IETF RFC 5213 | | option | | \"1\" to indicate | [4] | | | | attachment over a | | | | | new interface. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Set to the 3GPP | IETF RFC 5213 | | Type option | | access type, i.e. | [4] | | | | GERAN, UTRAN or | | | | | E-UTRAN, or to | | | | | the value | | | | | matching the | | | | | characteristics | | | | | of the non-3GPP | | | | | access (e.g., | | | | | HRPD) the UE is | | | | | using to attach | | | | | to the EPS as | | | | | defined in the | | | | | Access Technology | | | | | Type Option type | | | | | values registry | | | | | of the IANA | | | | | Mobile IPv6 | | | | | Parameters | | | | | Registry [18]. | | | | | | | | | | The ePDG may use | | | | | the access | | | | | technology type | | | | | of the untrusted | | | | | non-3GPP access | | | | | network if it is | | | | | able to acquire | | | | | it; otherwise it | | | | | shall indicate | | | | | Virtual as the | | | | | access | | | | | technology. | | | | | | | | | | NOTE 2. | | | | | | | | | | NOTE 3. | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Set to the | IETF RFC 5213 | | | | current time | [4] | +-------------------+------+-------------------+-------------------+ | GRE key option | M | Set to the | draft-ietf-net | | | | downlink GRE key | lmm-grekey-option | | | | to be used for | [7] | | | | downlink GRE | | | | | encapsulated | | | | | packets sent over | | | | | the PDN | | | | | connection. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | C | For dynamic | dr | | Request option | | allocation, set | aft-ietf-netlmm-p | | | | to the value | mip6-ipv4-support | | | | \"0.0.0.0\" to | [5] | | | | request | | | | | allocation for | | | | | the UE\'s PDN | | | | | connection of an | | | | | IPv4 Home Address | | | | | in the PDN | | | | | corresponding to | | | | | the EPS Access | | | | | Point Name. For | | | | | static | | | | | allocation, set | | | | | to the received | | | | | static allocated | | | | | IPv4 Home | | | | | Address. NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the UE | | | | | attaches the new | | | | | PDN connection. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 4. | | +-------------------+------+-------------------+-------------------+ | Protocol | O | Contain Protocol | Subclause | | Configuration | | Configuration | 12.1.1.0 | | Options | | Options. | | +-------------------+------+-------------------+-------------------+ | PDN GW IP Address | O | Contain PDN GW IP | Subclause | | | | address (on S2a | 12.1.1.4 | | | | or S2b when used | | | | | for chained | | | | | S2a/S2b-PMIP | | | | | based S8). | | +-------------------+------+-------------------+-------------------+ | Fully Qualified | O | Contain a Fully | Subclause | | PDN Connection | | Qualified PDN | 12.1.1.2 | | Set Identifier | | _Connection Set | | | | | Identifier if | | | | | generated by the_ | | | | | MAG on the S5/S8 | | | | | interfaces as | | | | | specified in 3GPP | | | | | TS 23.007 [13]. | | +-------------------+------+-------------------+-------------------+ | Fully Qualified | O | Contain a Fully | Subclause | | PDN Connection | | Qualified PDN | 12.1.1.2 | | Set Identifier | | _Connection Set | | | | | Identifier if | | | | | generated by the | | | | | MME,_ and | | | | | included by the | | | | | MAG on the S5/S8 | | | | | interfaces as | | | | | specified in 3GPP | | | | | TS 23.007 [13]. | | +-------------------+------+-------------------+-------------------+ | Selection Mode | O | Contains APN | Subclause | | | | selection mode | 12.1.1.7 | | | | (on S5/S8). | | +-------------------+------+-------------------+-------------------+ | Charging | O | Contains the | Subclause | | Characteristics | | Charging | 12.1.1.8 | | | | Characteristics | | | | | to be applied for | | | | | EPC charging | | +-------------------+------+-------------------+-------------------+ | Serving Network | C | This IE shall be | Subclause | | | | included on S5 | 12.1.1.9 | | | | and S8 interfaces | | | | | to identify the | | | | | Serving Network | | +-------------------+------+-------------------+-------------------+ | Mobile Equipment | O | Contains the MEI | Subclause | | Identity | | of the UE (on | 12.1.1.10 | | | | S5/S8) | | +-------------------+------+-------------------+-------------------+ | MSISDN | O | Contains the | Subclause | | | | MSISDN of the | 12.1.1.11 | | | | user (on S5/S8) | | +-------------------+------+-------------------+-------------------+ | Maximum APN | O | Contains the most | Subclause | | Restriction | | stringent | 12.1.1.13 | | | | restriction of | | | | | already active | | | | | PDN connections | | | | | (on S5/S8). | | +-------------------+------+-------------------+-------------------+ | NOTE 1: At least | | | | | one of the two | | | | | options, namely, | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option or the | | | | | IPv4 Home Address | | | | | Request option | | | | | shall be present. | | | | | If both an IPv6 | | | | | Home Network | | | | | Prefix and an | | | | | IPv4 Home Address | | | | | are requested, | | | | | both options | | | | | shall be included | | | | | in the same PBU | | | | | message. | | | | | | | | | | NOTE 2: The | | | | | methods that the | | | | | ePDG may use to | | | | | acquire the | | | | | access technology | | | | | type of the | | | | | untrusted | | | | | non-3GPP IP | | | | | access network | | | | | are not specified | | | | | in this release. | | | | | | | | | | NOTE 3: The | | | | | PDN-GW can be | | | | | informed about | | | | | the type of | | | | | access network | | | | | used by the UE | | | | | over several | | | | | reference points, | | | | | see 3GPP TS | | | | | 29.212 [30] for | | | | | the mapping | | | | | between the code | | | | | values for the | | | | | different access | | | | | network types. | | | | | | | | | | NOTE 4: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
#### 5.1.1.2 Proxy Binding Acknowledgement
The fields of a PBA message for the PMIPv6 PDN Connection Creation procedure
are depicted in Table 5.1.1.2-1.
The Mobility Options in a PBA message for the PMIPv6 PDN Connection Creation
procedure are depicted in Table 5.1.1.2-2.
Other flags are not used by this specification.
Table 5.1.1.2-1: Fields of a PBA message for the PMIPv6 PDN Connection
Creation procedure
* * *
Information element IE Description Reference Status Set to indicate the
result. IETF RFC 3775 [8] Sequence Number Set to the value received in the
corresponding PBU. IETF RFC 5213 [4] Lifetime Set to the granted number of
time units the binding shall remain valid. IETF RFC 3775 [8] Proxy
Registration Flag (P) Set to \"1\" to indicate that the Binding Update message
is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.1.1.2-2: Mobility Options in a PBA message for the PMIPv6 PDN
Connection Creation procedure
* * *
Information element Cat. IE Description Reference Mobile Node Identifier
option M Copied from corresponding field of PBU. IETF RFC 5213 [4] IPv6 Home
Network Prefix option C Present if IPv6 Home Network Prefix is allocated. When
it's present, set to the IPv6 Home Network Prefix Allocated for the UE\'s PDN
connection based on the selected PDN corresponding to the EPS Access Point
Name for dynamic allocation, or set to the static IPv6 Home Network Prefix
received in the PBU for static allocation. In addition, the Interface
Identifier (IID) allocated for the UE is encoded in the low order 64 bits of
this option, i.e., the IPv6 Home Network Prefix option. IETF RFC 5213 [4]
Link-local Address C Present when IPv6 Home Network Prefix option is present.
Link-local address to be used by the MAG on the access link shared with the
UE. IETF RFC 5213 [4] Handoff Indicator option M Copied from corresponding
field of PBU. IETF RFC 5213 [4] Access Technology Type option M Copied from
corresponding field of PBU. IETF RFC 5213 [4] Timestamp option M Copied from
corresponding field of PBU, or set to the current time of LMA in case of
timestamp error. IETF RFC 5213 [4] GRE key option M Set to the uplink GRE key
to be used for uplink GRE encapsulated packets sent over the PDN connection.
draft-ietf-netlmm-grekey-option [7] IPv4 Home Address Reply Option C Present
if IPv4 address is allocated. When it's present, set to the IPv4 Home Address
allocated for the UE\'s PDN connection based on the selected PDN corresponding
to the EPS Access Point Name for dynamic allocation, or set to the static IPv4
Home Address received in the PBU for static allocation. NOTE 1 draft-ietf-
netlmm-pmip6-ipv4-support [5] IPv4 Default Router Address Option C Set to the
UE's IPv4 default router address. This option shall be present if and only if
IPv4 Home Address Reply Option is present. draft-ietf-netlmm-
pmip6-ipv4-support [5] Service Selection Mobility Option M Copied from the
corresponding field in the PBU message, formatted as defined in 3GPP TS 23.003
[12] IETF RFC 5149[11] PDN Type Indication C This option shall be present if
and only if PDN type is changed in the PDN GW compared to what was requested
in the PBU. Subclause 12.1.1.3 DHCPv4 Address Allocation Procedure Indication
C This option shall be present if and only if DHCPv4 is to be used to allocate
the IPv4 address to the UE. Subclause 12.1.1.5 Protocol Configuration Options
O Contain Protocol Configuration Options. Subclause 12.1.1.0 3GPP Specific
PMIPv6 Error Code O Contain 3GPP Specific PMIPv6 Error Code Subclause 12.1.1.1
Fully Qualified PDN Connection Set Identifier O Contain a Fully Qualified PDN
_Connection Set Identifier if generated by the LMA_ on the S5/S8 interfaces as
specified in 3GPP TS 23.007 [13]_._ Subclause 12.1.1.2 Charging ID M Contain
the Charging ID information Subclause 12.1.1.6 APN Restriction O Contains the
restriction of this PDN connection (on S5/S8). Subclause 12.1.1.12 NOTE 1: If
the PDN type is IPv4v6 and DHCPv4 is to be used to allocate the IPv4 address
to the UE, the IPv4 Home Address Reply Option shall not be included.
* * *
### 5.1.2 MAG procedures
A MAG initiating the PMIPv6 PDN Connection Creation procedure shall follow the
\"Mobile Node Attachment and Initial Binding Registration\" procedure
described in the PMIPv6 [4] and IPv4 support for PMIPv6 [5] specifications
with the following additional requirements:
  1. Generate a downlink GRE key that is not already in use locally for the PDN connection\'s downlink traffic to that UE, as specified in the GRE Key Option for PMIPv6 specification [7].
  2. For IP address allocation, the IPv6 Home Network Prefix option and/or the IPv4 Home Address Request option shall be present according to the UE request and the user subscription for non-3GPP access, or according to the PDN Type received from the MME/SGSN for 3GPP access.
  3. If the static IPv4 Home Address and/or IPv6 Home Network Prefix are available at the MAG, set them in the IPv4 home address Request option and/or the IPv6 home prefix option in the PBU.
  4. Optionally, assign a Fully Qualified PDN Connection Set Identifier that identifies a set of PDN connections belonging to an arbitrary number of UEs.
Set other parameters in the PBU as specified by the PBU parameters section for
this procedure.
### 5.1.3 LMA procedures
On reception of a PBU, the LMA shall initiate the \"Initial Binding
Registration (New Mobility session)\" and \"Processing Binding Registrations\"
procedures described in the PMIPv6 [4] and IPv4 support for PMIPv6 [5]
specifications with the following additional requirements:
  1. Select the PDN for the UE\'s PDN connection based on the APN present in the PBU.
  2. Check if the received IPv6 Home prefix and/or IPv4 Home address are topologically correct.
  3. If no static IPv6 Home Network Prefix and/or IPv4 Home Address were received in the PBU, allocate the IPv6 Home Network Prefix and/or an IPv4 Home Address for the selected PDN.
  4. If a PCO with value IPv4 Address Allocation via DHCPv4 is present in the PBU,
  5. if the LMA allocates an IPv4 address, it shall include the IPv4 Home Address Reply Option in the PBA message
  6. if the LMA allocates an IPv6 address, the LMA shall not allocate an IPv4 address and shall not include the IPv4 Home Address Reply Option in the PBA message
  7. Generate a uplink GRE key that is not already in use locally for the PDN connection\'s uplink traffic from that UE, as specified in the GRE Key Option for PMIPv6 specification [7].
  8. Assign to the UE an IPv6 Interface Identifier to allow formation of an UE Link Local Address from the well-known link local address prefix (fe80::/64).
  9. Optionally, assign a Fully Qualified PDN Connection Set Identifier that identifies a set of PDN connections belonging to an arbitrary number of UEs.
  10. Set parameters in the PBA as specified by the PBA parameters section for this procedure.
## 5.2 Proxy Mobile IPv6 PDN Connection Lifetime Extension procedure
### 5.2.1 General
The PMIPv6 PDN Connection Lifetime Extension procedure is initiated by the
node acting as a MAG to prolong the lifetime of an existing PDN connection
with the node acting as an LMA for an UE that is already attached. This
procedure may also be used when the MME is relocated and the MAG remains
unchanged (see 3GPP TS 23.007 [13]). The procedure starts with the MAG sending
a PBU to the LMA to extend the binding lifetime for the UE\'s PDN connection.
The LMA confirms that the binding lifetime is extended by sending a PBA to the
MAG.
#### 5.2.1.1 Proxy Binding Update
The fields of a PBU message for the PMIPv6 PDN Connection Lifetime Extension
procedure are depicted in Table 5.2.1.1-1.
The Mobility Options in a PBU message for the PMIPv6 PDN Connection Lifetime
Extension procedure are depicted in Table 5.2.1.1-2.
Other flags are not used by this specification.
Table 5.2.1.1-1: Fields of a PBU message for the PMIPv6 PDN Connection
Lifetime Extension procedure
* * *
Information element IE Description Reference Sequence Number Set to a locally
(i.e. per MAG) monotonically increasing value. IETF RFC 5213 [4] Lifetime Set
to the requested number of time units the binding shall remain valid. IETF RFC
3775 [8] Acknowledge (A) Set to \"1\" to request an acknowledgement message.
IETF RFC 3775 [8] Proxy Registration Flag (P) Set to \"1\" to indicate that
the Binding Update message is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.2.1.1-2: Mobility Options in a PBU message for the PMIPv6 PDN
Connection Lifetime Extension procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS 23.003 | | Identifier option | | identifier of the | [12] | | | | UE as specified | | | | | in 3GPP TS 23.003 | | | | | [12]. The | | | | | format of the NAI | | | | | is specified in | | | | | the subclause | | | | | 19.3 in 3GPP TS | | | | | 23.003 [12]. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | Set to the IPv6 | IETF RFC 5213 | | Prefix option | | Home Network | [4] | | | | Prefix allocated | | | | | to the UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Link-local | C | Present when IPv6 | IETF RFC 5213 | | Address | | Home Network | [4] | | | | Prefix option is | | | | | present. Set to | | | | | the link-local | | | | | address already | | | | | allocated to the | | | | | MAG (in the | | | | | previous initial | | | | | binding | | | | | registration) for | | | | | use on the access | | | | | link shared with | | | | | the UE. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Set to the value | IETF RFC 5213 | | option | | \"5\" to indicate | [4] | | | | handoff state not | | | | | changed | | | | | ( | | | | | Re-registration). | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Set to the 3GPP | IETF RFC 5213 | | Type option | | access type, i.e. | [4] | | | | GERAN, UTRAN or | | | | | E-UTRAN, or to | | | | | the value | | | | | matching the | | | | | characteristics | | | | | of the non-3GPP | | | | | access (e.g., | | | | | HRPD) the UE is | | | | | using to attach | | | | | to the EPS as | | | | | defined in the | | | | | Access Technology | | | | | Type Option type | | | | | values registry | | | | | of the IANA | | | | | Mobile IPv6 | | | | | Parameters | | | | | Registry [18]. | | | | | | | | | | The ePDG may use | | | | | the access | | | | | technology type | | | | | of the untrusted | | | | | non-3GPP access | | | | | network if it is | | | | | able to acquire | | | | | it; otherwise it | | | | | shall indicate | | | | | Virtual as the | | | | | access | | | | | technology. | | | | | | | | | | NOTE 2 | | | | | | | | | | NOTE 3 | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Set to the | IETF RFC 5213 | | | | current time | [4] | +-------------------+------+-------------------+-------------------+ | GRE Key option | M | Set to the | draft-ietf-net | | | | previously | lmm-grekey-option | | | | exchanged | [7] | | | | downlink GRE key | | | | | to be used for | | | | | downlink GRE | | | | | encapsulated | | | | | packets sent over | | | | | the PDN | | | | | connection. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | C | Set to the IPv4 | dr | | Request option | | Home Address | aft-ietf-netlmm-p | | | | allocated for the | mip6-ipv4-support | | | | UE\'s PDN | [5] | | | | connection based | | | | | on the selected | | | | | PDN. NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the | | | | | UE\'s PDN | | | | | connection is | | | | | attached. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 4. | | +-------------------+------+-------------------+-------------------+ | MME Fully | O | Contain a Fully | Subclause | | Qualified PDN | | Qualified PDN | 12.1.1.2 | | Connection Set | | Connection Set | | | Identifier | | Identifier if | | | | | generated by the | | | | | MME, and included | | | | | by the MAG on the | | | | | S5/S8 interfaces | | | | | as specified in | | | | | 3GPP TS 23.007 | | | | | [13]. | | +-------------------+------+-------------------+-------------------+ | MAG Fully | O | Contain a Fully | Subclause | | Qualified PDN | | Qualified PDN | 12.1.1.2 | | Connection Set | | Connection Set | | | Identifier | | Identifier if | | | | | generated by the | | | | | MAG on the S5/S8 | | | | | interfaces as | | | | | specified in 3GPP | | | | | TS 23.007 [13]. | | +-------------------+------+-------------------+-------------------+ | NOTE 1: At least | | | | | one of the two | | | | | options, namely, | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option or the | | | | | IPv4 Home Address | | | | | Request option | | | | | shall be present. | | | | | If the UE has | | | | | both IPv4 home | | | | | address and IPv6 | | | | | home network | | | | | prefix | | | | | registered, both | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option and IPv4 | | | | | Home Address | | | | | Request option | | | | | shall be included | | | | | in the same PBU | | | | | message. | | | | | | | | | | NOTE 2: The | | | | | methods that the | | | | | ePDG may use to | | | | | acquire the | | | | | access technology | | | | | type of the | | | | | untrusted | | | | | non-3GPP IP | | | | | access network | | | | | are not specified | | | | | in this release. | | | | | | | | | | NOTE 3: The | | | | | PDN-GW can be | | | | | informed about | | | | | the type of | | | | | access network | | | | | used by the UE | | | | | over several | | | | | reference points, | | | | | see 3GPP TS | | | | | 29.212 [30] for | | | | | the mapping | | | | | between the code | | | | | values for the | | | | | different access | | | | | network types. | | | | | | | | | | NOTE 4: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
#### 5.2.1.2 Proxy Binding Acknowledgement
The fields of a PBA message for the PMIPv6 PDN Connection Lifetime Extension
procedure are depicted in Table 5.2.1.2-1.
The Mobility Options in a PBA message for the PMIPv6 PDN Connection Lifetime
Extension procedure are depicted in Table 5.2.1.2-2.
Other flags are not used by this specification.
Table 5.2.1.2-1: Fields of a PBA message for the PMIPv6 PDN Connection
Lifetime Extension procedure
* * *
Information element IE Description Reference Status Set to indicate the
result. IETF RFC 3775 [8] Sequence Number Set to the value received in the
corresponding PBU. IETF RFC 5213 [4] Lifetime Set to the granted number of
time units the binding shall remain valid. IETF RFC 3775 [8] Proxy
Registration Flag (P) Set to \"1\" to indicate that the Binding Update message
is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.2.1.2-2: Mobility Options in a PBA message for the PMIPv6 PDN
Connection Lifetime Extension procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Copied from | IETF RFC 5213 | | Identifier option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | If it is present | IETF RFC 5213 | | Prefix option | | in the | [4] | | | | corresponding | | | | | PBU, set to the | | | | | IPv6 Home Network | | | | | Prefix allocated | | | | | to the UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. | | +-------------------+------+-------------------+-------------------+ | Link-local | C | Present when IPv6 | IETF RFC 5213 | | Address | | Home Network | [4] | | | | Prefix option is | | | | | present. Set to | | | | | the link-local | | | | | address already | | | | | allocated to the | | | | | MAG (in the | | | | | previous initial | | | | | binding | | | | | registration) for | | | | | use on the access | | | | | link shared with | | | | | the UE. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Copied from | IETF RFC 5213 | | option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Copied from | IETF RFC 5213 | | Type option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Copied from | IETF RFC 5213 | | | | corresponding | [4] | | | | field of PBU, or | | | | | set to the | | | | | current time of | | | | | LMA in case of | | | | | timestamp error. | | +-------------------+------+-------------------+-------------------+ | GRE key option | M | Set to the | draft-ietf-net | | | | previously | lmm-grekey-option | | | | exchanged uplink | [7] | | | | GRE key to be | | | | | used for uplink | | | | | GRE encapsulated | | | | | packets sent over | | | | | the PDN | | | | | connection. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | C | If it is present | dr | | Reply Option | | in the | aft-ietf-netlmm-p | | | | corresponding | mip6-ipv4-support | | | | PBU, set to the | [5] | | | | IPv4 Home Address | | | | | allocated for the | | | | | UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. | | +-------------------+------+-------------------+-------------------+ | IPv4 Default | C | Set to the UE's | dr | | Router Address | | IPv4 default | aft-ietf-netlmm-p | | Option | | router address. | mip6-ipv4-support | | | | This option shall | [5] | | | | be present if and | | | | | only if IPv4 Home | | | | | Address Reply | | | | | Option is present | | | | | and PBU is | | | | | accepted. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Copied from the | IETF RFC | | Mobility Option | | corresponding | 5149[11] | | | | field in the PBU | | | | | message. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | 3GPP Specific | O | Contain 3GPP | Subclause | | PMIPv6 Error Code | | Specific PMIPv6 | 12.1.1.1 | | | | Error Code | | +-------------------+------+-------------------+-------------------+ | LMA Fully | O | Contain a Fully | Subclause | | Qualified PDN | | Qualified PDN | 12.1.1.2 | | Connection Set | | Connection Set | | | Identifier | | Identifier if | | | | | generated by the | | | | | LMA on the S5/S8 | | | | | interfaces as | | | | | specified in 3GPP | | | | | TS 23.007 [13]. | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
### 5.2.2 MAG procedures
A MAG initiating the PMIPv6 PDN Connection Lifetime Extension procedure shall
follow the \"Extending Binding Lifetime\" procedure described in the PMIPv6
[4] and IPv4 support for PMIPv6 [5] specifications, while parameters in the
PBU are set as specified by the PBU parameters section for this procedure.
When an MME FQ-CSID is received by the MAG during MME relocation, if the MAG
supports the feature according to 3GPP TS 23.007 [13], it shall store the Node
ID and CSID from the MME FQ-CSID for the PDN connection and forward the MME
FQ-CSID to the LMA in the PBU.
### 5.2.3 LMA procedures
On reception of a PBU, the LMA shall initiate the \"Binding Lifetime Extension
without Handover\" procedure as described in the PMIPv6 [4] and IPv4 support
for PMIPv6 [5] specifications, while parameters in the PBA are set as
specified by the PBA parameters section for this procedure. When an MME FQ-
CSID is received by the LMA, if the LMA supports the feature according to 3GPP
TS 23.007 [13], it shall store the Node-ID and CSID from the MME FQ-CSID in
place of those previously stored for the PDN connection.
## 5.3 Proxy Mobile IPv6 PDN Connection Handover procedure
### 5.3.1 General
The PMIPv6 PDN Connection Handover procedure is initiated by the node acting
as a new MAG for the UE to update an existing PDN connection for an UE that is
already attached to the EPC. The procedure starts with the MAG sending a PBU
including the APN to the LMA to update the binding for the UE\'s PDN
connection. The LMA confirms update of the binding by sending a PBA to the
MAG. Update of the binding achieves the following:
  * **IPv6 Home Network Prefix re-assignment:** The LMA re-assigns to the UE's PDN connection the IPv6 Home Network Prefix valid in the selected PDN.
  * **IPv4 Home Address re-assignment:** The LMA re-assigns to the UE's PDN connection the IPv4 Home Address valid in the selected PDN.
  * **Downlink and Uplink GRE Key Assignment:** The MAG and LMA will establish downlink and uplink GRE keys to be used for GRE encapsulation of downlink and uplink traffic, respectively on the PDN connection.
  * **GRE Tunnel Establishment:** A GRE tunnel is established between the MAG and LMA with the assigned GRE keys to carry uplink and downlink traffic that UE respectively sends and receives on the PDN connection.
  * **BCE Update:** The LMA updates or creates the BCE for the PDN connection.
  * **BULE Creation:** The new MAG creates a BULE for the PDN connection.
  * **IP address(es) preservation:** the IP addresses allocated in the previous initial attachment are reused if IP address(es) preservation decision is made.
  * **MAG Link Local Address re-assignment:** The LMA re-assigns the same MAG link local address.
  * **UE Interface Identifier (IID) re-assignment:** The LMA re-assigns to the UE the same IPv6 Interface Identifier to allow formation of the same UE Link Local Address from the well-known link local address prefix (fe80::/64).
#### 5.3.1.1 Proxy Binding Update
The fields of a PBU message for the PMIPv6 PDN Connection Handover procedure
are depicted in Table 5.3.1.1-1.
The Mobility Options in a PBU message for the PMIPv6 PDN Connection Handover
procedure are depicted in Table 5.3.1.1-2.
Table 5.3.1.1-1: Fields of a PBU message for the PDN Connection Handover
procedure
* * *
Information element IE Description Reference Sequence Number Set to a locally
(i.e. per MAG) monotonically increasing value. IETF RFC 5213 [4] Lifetime Set
to the requested number of time units the binding shall remain valid. IETF RFC
3775 [8] Acknowledge (A) Set to \"1\" to request an acknowledgement message.
IETF RFC 3775 [8] Proxy Registration Flag (P) Set to \"1\" to indicate that
the Binding Update message is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.3.1.1-2: Mobility Options in a PBU message for the PMIPv6 PDN
Connection Handover procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS 23.003 | | Identifier option | | identifier of the | [12] | | | | UE as specified | | | | | in 3GPP TS 23.003 | | | | | [12]. The | | | | | format of the NAI | | | | | is specified in | | | | | the subclause | | | | | 19.3 in 3GPP TS | | | | | 23.003 [12]. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | If available at | IETF RFC 5213 | | Prefix option | | the MAG, set to | [4] | | | | the IPv6 Home | | | | | Network Prefix | | | | | allocated to the | | | | | UE\'s PDN | | | | | connection. | | | | | Otherwise, set to | | | | | the value | | | | | \"0::/0\" to | | | | | request | | | | | allocation for | | | | | the UE\'s PDN | | | | | connection of an | | | | | IPv6 Home Network | | | | | Prefix for the UE | | | | | in the PDN | | | | | corresponding to | | | | | the EPS Access | | | | | Point Name. NOTE | | | | | 1. | | +-------------------+------+-------------------+-------------------+ | Link-local | C | Present when IPv6 | IETF RFC 5213 | | Address | | Home Network | [4] | | | | Prefix option is | | | | | present. Set to | | | | | the link-local | | | | | address already | | | | | allocated to the | | | | | MAG (in the | | | | | previous initial | | | | | binding | | | | | registration) for | | | | | use on the access | | | | | link shared with | | | | | the UE. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Set to the value | IETF RFC 5213 | | option | | \"2\" (Handoff | [4] | | | | between two | | | | | different | | | | | interfaces) in | | | | | case the handover | | | | | is an inter | | | | | access handover | | | | | (i.e. from 3GPP | | | | | to non-3GPP, from | | | | | non-3GPP to 3GPP, | | | | | or between two | | | | | non-3GPP | | | | | accesses) and IP | | | | | address(es) | | | | | preservation | | | | | decision is | | | | | taken; or | | | | | | | | | | Set to the value | | | | | \"3\" (Handoff | | | | | between mobile | | | | | access gateways | | | | | for the same | | | | | interface) in | | | | | case the handover | | | | | is an intra | | | | | access (i.e. | | | | | between two 3GPP | | | | | accesses) | | | | | handover; or | | | | | | | | | | Set to the value | | | | | \"4\" (Handoff | | | | | state unknown) in | | | | | case the handover | | | | | is an inter | | | | | access handover | | | | | (i.e. from 3GPP | | | | | to non-3GPP, from | | | | | non-3GPP to 3GPP, | | | | | or between two | | | | | non-3GPP | | | | | accesses) and IP | | | | | address(es) | | | | | preservation | | | | | decision is | | | | | negative or | | | | | unknown. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Set to the 3GPP | IETF RFC 5213 | | Type option | | access type, | [4] | | | | i.e., to GERAN, | | | | | UTRAN or E-UTRAN, | | | | | or to the value | | | | | matching the | | | | | characteristics | | | | | of the non-3GPP | | | | | access (e.g., | | | | | HRPD) the UE is | | | | | using to attach | | | | | to the EPS as | | | | | defined in the | | | | | Access Technology | | | | | Type Option type | | | | | values registry | | | | | of the IANA | | | | | Mobile IPv6 | | | | | Parameters | | | | | Registry [18]. | | | | | | | | | | The ePDG may use | | | | | the access | | | | | technology type | | | | | of the untrusted | | | | | non-3GPP access | | | | | network if it is | | | | | able to acquire | | | | | it; otherwise it | | | | | shall indicate | | | | | Virtual as the | | | | | access | | | | | technology. | | | | | | | | | | NOTE 2 | | | | | | | | | | NOTE 3 | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Set to the | IETF RFC 5213 | | | | current time | [4] | +-------------------+------+-------------------+-------------------+ | GRE key option | M | Set to the | draft-ietf-net | | | | downlink GRE key | lmm-grekey-option | | | | to be used for | [7] | | | | downlink GRE | | | | | encapsulated | | | | | packets sent over | | | | | the PDN | | | | | connection. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | C | If available at | dr | | Request option | | the MAG, set to | aft-ietf-netlmm-p | | | | the IPv4 Address | mip6-ipv4-support | | | | allocated to the | [5] | | | | UE\'s PDN | | | | | connection. | | | | | Otherwise, set to | | | | | the value | | | | | \"0.0.0.0\" to | | | | | request | | | | | allocation for | | | | | the UE\'s PDN | | | | | connection of an | | | | | IPv4 Home Address | | | | | in the PDN | | | | | corresponding to | | | | | the EPS Access | | | | | Point Name. NOTE | | | | | 1. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the | | | | | UE\'s PDN | | | | | connection is | | | | | attached. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 4. | | +-------------------+------+-------------------+-------------------+ | Protocol | O | Contain Protocol | Subclause | | Configuration | | Configuration | 12.1.1.0 | | Options | | Options. | | +-------------------+------+-------------------+-------------------+ | PDN GW IP Address | O | Contain PDN GW IP | Subclause | | | | address (on S2a | 12.1.1.4 | | | | or S2b when used | | | | | for chained | | | | | S2a/S2b-PMIP | | | | | based S8).. | | +-------------------+------+-------------------+-------------------+ | Fully Qualified | O | Contain a Fully | Subclause | | PDN Connection | | Qualified PDN | 12.1.1.2 | | Set Identifier | | _Connection Set | | | | | Identifier if | | | | | generated by_ the | | | | | MAG on the S5/S8 | | | | | interfaces as | | | | | specified in 3GPP | | | | | TS 23.007 [13]. | | +-------------------+------+-------------------+-------------------+ | Fully Qualified | O | Contain a Fully | Subclause | | PDN Connection | | Qualified PDN | 12.1.1.2 | | Set Identifier | | _Connection Set | | | | | Identifier if | | | | | generated by the | | | | | MME,_ and | | | | | included by the | | | | | MAG on the S5/S8 | | | | | interfaces as | | | | | specified in 3GPP | | | | | TS 23.007 [13]. | | +-------------------+------+-------------------+-------------------+ | Selection Mode | C | Contains APN | Subclause | | | | selection mode | 12.1.1.7 | | | | (on S5/S8). Shall | | | | | be present if the | | | | | PDN connection is | | | | | initiated by S4 | | | | | SGSN or MME. | | +-------------------+------+-------------------+-------------------+ | Charging | O | Contains the | Subclause | | Characteristics | | Charging | 12.1.1.8 | | | | Characteristics | | | | | to be applied for | | | | | EPC charging | | +-------------------+------+-------------------+-------------------+ | Serving Network | C | This IE shall be | Subclause | | | | included on S5 | 12.1.1.9 | | | | and S8 interfaces | | | | | to identify the | | | | | Serving Network | | +-------------------+------+-------------------+-------------------+ | Mobile Equipment | O | Contains the MEI | Subclause | | Identity | | of the UE (on | 12.1.1.10 | | | | S5/S8) | | +-------------------+------+-------------------+-------------------+ | MSISDN | O | Contains the | Subclause | | | | MSISDN of the | 12.1.1.11 | | | | user (on S5/S8) | | +-------------------+------+-------------------+-------------------+ | Maximum APN | O | Contains the most | Subclause | | Restriction | | stringent | 12.1.1.13 | | | | restriction of | | | | | already active | | | | | PDN connections | | | | | (on S5/S8). | | +-------------------+------+-------------------+-------------------+ | NOTE 1: At least | | | | | one of the two | | | | | options, namely, | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option or the | | | | | IPv4 Home Address | | | | | Request option | | | | | shall be present. | | | | | If the MAG knows | | | | | the UE has both | | | | | IPv4 home address | | | | | and IPv6 home | | | | | network prefix | | | | | registered, both | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option and IPv4 | | | | | Home Address | | | | | Request option | | | | | shall be included | | | | | in the same PBU | | | | | message. | | | | | | | | | | NOTE 2: The | | | | | methods that the | | | | | ePDG may use to | | | | | acquire the | | | | | access technology | | | | | type of the | | | | | untrusted | | | | | non-3GPP IP | | | | | access network | | | | | are not specified | | | | | in this release. | | | | | | | | | | NOTE 3: The | | | | | PDN-GW can be | | | | | informed about | | | | | the type of | | | | | access network | | | | | used by the UE | | | | | over several | | | | | reference points, | | | | | see 3GPP TS | | | | | 29.212 [30] for | | | | | the mapping | | | | | between the code | | | | | values for the | | | | | different access | | | | | network types. | | | | | | | | | | NOTE 4: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
#### 5.3.1.2 Proxy Binding Acknowledgement
The fields of a PBA message for the PMIPv6 PDN Connection Handover procedure
are depicted in Table 5.3.1.2-1.
The Mobility Options in a PBA message for the PMIPv6 PDN Connection Handover
procedure are depicted in Table 5.3.1.2-2.
Other flags are not used by this specification.
Table 5.3.1.2-1: Fields of a PBA message for the PMIPv6 PDN Connection
Handover procedure
* * *
Information element IE Description Reference Status Set to indicate the
result. IETF RFC 3775 [8] Sequence Number Set to the value received in the
corresponding PBU. IETF RFC 5213 [4] Lifetime Set to the granted number of
time units the binding shall remain valid. IETF RFC 3775 [8] Proxy
Registration Flag (P) Set to \"1\" to indicate that the Binding Update message
is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.3.1.2-2: Mobility Options in a PBA message for the PMIPv6 PDN
Connection Handover procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Copied from | IETF RFC 5213 | | Identifier option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | Present if IPv6 | IETF RFC 5213 | | Prefix option | | Home Network | [4] | | | | Prefix is | | | | | allocated. When | | | | | it's present, set | | | | | to the IPv6 Home | | | | | Network Prefix | | | | | Allocated for the | | | | | UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN corresponding | | | | | to the EPS Access | | | | | Point Name for | | | | | dynamic | | | | | allocation, or | | | | | set to the static | | | | | IPv6 Home Network | | | | | Prefix received | | | | | in the PBU for | | | | | static | | | | | allocation. In | | | | | addition, the | | | | | Interface | | | | | Identifier (IID) | | | | | allocated for the | | | | | UE is encoded in | | | | | the low order 64 | | | | | bits of this | | | | | option, i.e., the | | | | | IPv6 Home Network | | | | | Prefix option. | | +-------------------+------+-------------------+-------------------+ | Link-local | C | Present when IPv6 | IETF RFC 5213 | | Address | | Home Network | [4] | | | | Prefix option is | | | | | present. Set to | | | | | the link-local | | | | | address already | | | | | allocated to the | | | | | MAG (in the | | | | | previous initial | | | | | binding | | | | | registration) for | | | | | use on the access | | | | | link shared with | | | | | the UE. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Copied from | IETF RFC 5213 | | option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Copied from | IETF RFC 5213 | | Type option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Copied from | IETF RFC 5213 | | | | corresponding | [4] | | | | field of PBU, or | | | | | set to the | | | | | current time of | | | | | LMA in case of | | | | | timestamp error. | | +-------------------+------+-------------------+-------------------+ | GRE key option | M | Set to the uplink | draft-ietf-net | | | | GRE key to be | lmm-grekey-option | | | | used for uplink | [7] | | | | GRE encapsulated | | | | | packets sent over | | | | | the PDN | | | | | connection. The | | | | | same uplink GRE | | | | | key used for the | | | | | UE\'s PDN | | | | | connection with | | | | | the previous MAG | | | | | shall be | | | | | re-assigned. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | C | Present if IPv4 | dr | | Reply Option | | address is | aft-ietf-netlmm-p | | | | allocated. When | mip6-ipv4-support | | | | it's present, set | [5] | | | | to the IPv4 Home | | | | | Address allocated | | | | | for the UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN corresponding | | | | | to the EPS Access | | | | | Point Name for | | | | | dynamic | | | | | allocation, or | | | | | set to the static | | | | | IPv4 Home Address | | | | | received in the | | | | | PBU for static | | | | | allocation. | | +-------------------+------+-------------------+-------------------+ | IPv4 Default | C | Set to the UE's | dr | | Router Address | | IPv4 default | aft-ietf-netlmm-p | | Option | | router address. | mip6-ipv4-support | | | | This option shall | [5] | | | | be present if and | | | | | only if IPv4 Home | | | | | Address Reply | | | | | Option is | | | | | present. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Copied from the | IETF RFC | | Mobility Option | | corresponding | 5149[11] | | | | field in the PBU | | | | | message. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | PDN Type | C | This option shall | Subclause | | Indication | | be present if and | 12.1.1.3 | | | | only if PDN type | | | | | is changed in the | | | | | PDN GW compared | | | | | to what was | | | | | requested in the | | | | | PBU. | | +-------------------+------+-------------------+-------------------+ | PMIPv6 DHCPv4 | C | This option shall | Subclause | | Address | | be present if and | 12.1.1.5 | | Allocation | | only if DHCPv4 is | | | Procedure | | to be used to | | | Indication | | allocate the IPv4 | | | | | address to the | | | | | UE. | | +-------------------+------+-------------------+-------------------+ | Protocol | O | Contain Protocol | Subclause | | Configuration | | Configuration | 12.1.1.0 | | Options | | Options. | | +-------------------+------+-------------------+-------------------+ | 3GPP Specific | O | Contain 3GPP | Subclause | | PMIPv6 Error Code | | Specific PMIPv6 | 12.1.1.1 | | | | Error Code | | +-------------------+------+-------------------+-------------------+ | Fully Qualified | O | Contain a Fully | Subclause | | PDN Connection | | Qualified PDN | 12.1.1.2 | | Set Identifier | | _Connection Set | | | List | | Identifiers if | | | | | generated_ by the | | | | | LMA on the S5/S8 | | | | | interfaces as | | | | | specified in 3GPP | | | | | TS 23.007 | | | | | [13]_._ | | +-------------------+------+-------------------+-------------------+ | Charging ID | M | Contain the | Subclause | | | | Charging ID | 12.1.1.6 | | | | information | | +-------------------+------+-------------------+-------------------+ | APN Restriction | O | Contains the | Subclause | | | | restriction of | 12.1.1.12 | | | | this PDN | | | | | connection (on | | | | | S5/S8). | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
### 5.3.2 MAG procedures
A MAG initiating the PMIPv6 PDN Connection Handover procedure shall follow the
\"Mobile Node Attachment and Initial Binding Registration\" procedure
described in the PMIPv6 [4] and IPv4 support for PMIPv6 [5] specifications
with the following additional requirements:
  1. Generate a downlink GRE key that is not already in use locally for the PDN connection\'s downlink traffic to that UE, as specified in the GRE Key Option for PMIPv6 specification [7].
  2. Set other parameters in the PBU as specified by the PBU parameters section for this procedure.
  3. Optionally, assign a Fully Qualified PDN Connection Set Identifier that identifies a set of PDN connections belonging to an arbitrary number of UEs.
### 5.3.3 LMA procedures
On reception of a PBU, the LMA shall initiate the \"Binding Lifetime Extension
(After handoff)\" and \"Processing Proxy Binding Updates\" procedures
described in the PMIPv6 [4] and IPv4 support for PMIPv6 [5] specifications
with the following additional requirements:
  1. Re-assign the same uplink GRE key that was used by the previous MAG for the PDN connection\'s uplink traffic from the UE, as specified in the GRE Key Option for PMIPv6 specification [7].
  2. Check if the received IPv6 Home prefix and/or IPv4 Home address are topologically correct.
  3. Dynamic IP address allocation:
a) If Handoff Indicator option is \"2\" or \"3\": Re-allocate the IPv6 Home
Network Prefix and/or the IPv4 Home Address for the selected PDN which
were/was allocated during the previous attachment.
b) If Handoff Indicator option is \"4\": Make the IP address preservation
decision as per the PMIPv6 specification [4].
  1. Optionally, assign or reuse a Fully Qualified PDN Connection Set Identifier that identifies a set of PDN connections belonging to an arbitrary number of UEs.
  2. Set parameters in the PBA as specified by the PBA parameters section for this procedure.
If no existing BCE is found, the LMA shall follow the Proxy Mobile IPv6 PDN
Connection Creation procedure as specified in section 5.1.3.
## 5.4 Proxy Mobile IPv6 MAG Initiated PDN Connection Deletion procedure
### 5.4.1 General
The PMIPv6 MAG Initiated PDN Connection Deletion procedure is initiated by the
node acting as a MAG to tear down an existing PDN connection with the node
acting as an LMA. The procedure starts with the MAG sending a PBU to the LMA
to deregister with the LMA a binding for the UE\'s PDN connection. The LMA
confirms deregistration of the binding by sending a PBA to the MAG.
Deregistration of the binding achieves the following:
  * **IPv6 Home Network Prefix deallocation:** When the PDN connection is released, the LMA returns the IPv6 Home Network Prefix assigned to the UE\'s PDN connection to the pool of free IPv6 Home Network Prefixes.
  * **IPv4 Home Address deallocation:** When the PDN connection is released, the LMA returns the IPv4 Home Address assigned to the UE\'s PDN connection to the pool of free IPv4 Home Network Addresses.
  * **Downlink and Uplink GRE Key de-assignment:** The MAG and LMA will return, respectively, the PDN connection\'s uplink and downlink GRE keys to their respective pool of free GRE keys.
  * **GRE Tunnel Tear-down:** The GRE tunnel between the MAG and LMA is deleted.
  * **BCE Deletion:** The LMA deletes the BCE for the PDN connection.
  * **BULE Deletion:** The MAG deletes the BULE for the PDN connection.
#### 5.4.1.1 Proxy Binding Update
The fields of a PBU message for the PMIPv6 MAG Initiated PDN Connection
Deletion procedure are depicted in Table 5.4.1.1-1.
The Mobility Options in a PBU message for the PMIPv6 MAG Initiated PDN
Connection Deletion procedure are depicted in Table 5.4.1.1-2.
Other flags are not used by this specification.
Table 5.4.1.1-1: Fields of a PBU message for the PMIPv6 MAG Initiated PDN
Connection Deletion procedure
* * *
Information element IE Description Reference Sequence Number Set to a locally
(i.e. per MAG) monotonically increasing value. IETF RFC 5213 [4] Lifetime Set
to \"0\" to request deletion of the BCE. IETF RFC 3775 [8] Acknowledge (A) Set
to \"1\" to request an acknowledgement message. IETF RFC 3775 [8] Proxy
Registration Flag (P) Set to \"1\" to indicate that the Binding Update message
is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.4.1.1-2: Mobility Options in a PBU message for the PMIPv6 MAG
Initiated PDN Connection Deletion procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS 23.003 | | Identifier option | | identifier of the | [12] | | | | UE as specified | | | | | in 3GPP TS 23.003 | | | | | [12]. The | | | | | format of the NAI | | | | | is specified in | | | | | the subclause | | | | | 19.3 in 3GPP TS | | | | | 23.003 [12]. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | Set to the IPv6 | IETF RFC 5213 | | Prefix option | | Home Network | [4] | | | | Prefix allocated | | | | | to the UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Set to the value | IETF RFC 5213 | | option | | \"4\" to indicate | [4] | | | | Handoff state | | | | | unknown. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Set to the 3GPP | IETF RFC 5213 | | Type option | | access type, | [4] | | | | i.e., to GERAN, | | | | | UTRAN or E-UTRAN, | | | | | or to the value | | | | | matching the | | | | | characteristics | | | | | of the non-3GPP | | | | | access (e.g., | | | | | HRPD) the UE is | | | | | using to attach | | | | | to the EPS as | | | | | defined in the | | | | | Access Technology | | | | | Type Option type | | | | | values registry | | | | | of the IANA | | | | | Mobile IPv6 | | | | | Parameters | | | | | Registry [18]. | | | | | | | | | | The ePDG may use | | | | | the access | | | | | technology type | | | | | of the untrusted | | | | | non-3GPP access | | | | | network if it is | | | | | able to acquire | | | | | it; otherwise it | | | | | shall indicate | | | | | Virtual as the | | | | | access | | | | | technology. | | | | | | | | | | NOTE 2 | | | | | | | | | | NOTE 3 | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Set to the | IETF RFC 5213 | | | | current time | [4] | +-------------------+------+-------------------+-------------------+ | IPv4 Home Request | C | Set to the IPv4 | dr | | Address option | | Home Address | aft-ietf-netlmm-p | | | | allocated for the | mip6-ipv4-support | | | | UE\'s PDN | [5] | | | | connection based | | | | | on the selected | | | | | PDN. NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the | | | | | UE\'s PDN | | | | | connection is | | | | | attached. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 4. | | +-------------------+------+-------------------+-------------------+ | Protocol | O | Contain Protocol | Subclause | | Configuration | | Configuration | 12.1.1.0 | | Options | | Options. | | +-------------------+------+-------------------+-------------------+ | NOTE 1: At least | | | | | one of the two | | | | | options, namely, | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option or the | | | | | IPv4 Home Address | | | | | Request option | | | | | shall be present. | | | | | If the UE has | | | | | both IPv4 home | | | | | address and IPv6 | | | | | home network | | | | | prefix | | | | | registered, both | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option and IPv4 | | | | | Home Address | | | | | Request option | | | | | shall be included | | | | | in the same PBU | | | | | message. | | | | | | | | | | NOTE 2: The | | | | | methods that the | | | | | ePDG may use to | | | | | acquire the | | | | | access technology | | | | | type of the | | | | | untrusted | | | | | non-3GPP IP | | | | | access network | | | | | are not specified | | | | | in this release. | | | | | | | | | | NOTE 3: The | | | | | PDN-GW can be | | | | | informed about | | | | | the type of | | | | | access network | | | | | used by the UE | | | | | over several | | | | | reference points, | | | | | see 3GPP TS | | | | | 29.212 [30] for | | | | | the mapping | | | | | between the code | | | | | values for the | | | | | different access | | | | | network types. | | | | | | | | | | NOTE 4: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
#### 5.4.1.2 Proxy Binding Acknowledgement
The fields of a PBA message for the PMIPv6 MAG Initiated PDN Connection
Deletion procedure are depicted in Table 5.4.1.2-1.
The Mobility Options in a PBA message for the MAG Initiated PDN Connection
Deletion procedure are depicted in Table 5.4.1.2-2.
Other flags are not used by this specification.
Table 5.4.1.2-1: Fields of a PBA message for the PMIPv6 MAG Initiated PDN
Connection Deletion procedure
* * *
Information element IE Description Reference Status Set to indicate the
result. IETF RFC 3775 [8] Sequence Number Set to a value received in the
corresponding PBU. IETF RFC 5213 [4] Lifetime Set to \"0\" to request deletion
of the binding. IETF RFC 3775 [8] Proxy Registration Flag (P) Set to \"1\" to
indicate that the Binding Update message is a proxy registration. IETF RFC
5213 [4]
* * *
Table 5.4.1.2-2: Mobility Options in a PBA message for the PMIPv6 MAG
Initiated PDN Connection Deletion procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Copied from | IETF RFC 5213 | | Identifier option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | If it is present | IETF RFC 5213 | | Prefix option | | in the | [4] | | | | corresponding | | | | | PBU, set to the | | | | | IPv6 Home Network | | | | | Prefix allocated | | | | | to the UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Copied from | IETF RFC 5213 | | option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Copied from | IETF RFC 5213 | | Type option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Copied from | IETF RFC 5213 | | | | corresponding | [4] | | | | field of PBU, or | | | | | set to the | | | | | current time of | | | | | LMA in case of | | | | | timestamp error. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | C | If it is present | dr | | Reply Option | | in the | aft-ietf-netlmm-p | | | | corresponding | mip6-ipv4-support | | | | PBU, set to the | [5] | | | | IPv4 Home Address | | | | | allocated for the | | | | | UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. | | +-------------------+------+-------------------+-------------------+ | IPv4 Default | C | Set to the UE's | dr | | Router Address | | IPv4 default | aft-ietf-netlmm-p | | Option | | router address. | mip6-ipv4-support | | | | This option shall | [5] | | | | be present if and | | | | | only if IPv4 Home | | | | | Address Reply | | | | | Option is present | | | | | and PBU is | | | | | accepted. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Copied from the | IETF RFC | | Mobility Option | | corresponding | 5149[11] | | | | field in the PBU | | | | | message. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Protocol | O | Contain Protocol | Subclause | | Configuration | | Configuration | 12.1.1.0 | | Options | | Options. | | +-------------------+------+-------------------+-------------------+ | 3GPP Specific | O | Contain 3GPP | Subclause | | PMIPv6 Error Code | | Specific PMIPv6 | 12.1.1.1 | | | | Error Code | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
### 5.4.2 MAG procedures
A MAG initiating the PMIPv6 Initial MAG Initiated PDN Connection Deletion
procedure shall follow the \"Mobile Node Detachment and Binding De-
Registration\" procedure described in the PMIPv6 [4] and IPv4 support for
PMIPv6 [5] specifications, while parameters in the PBU are set as specified by
the PBU parameters section for this procedure.
### 5.4.3 LMA procedures
On reception of a PBU, the LMA shall initiate the \"Binding De-Registration\"
procedure described in the PMIPv6 [4] and IPv4 support for PMIPv6 [5]
specifications, while parameters in the PBA are set as specified by the PBA
parameters section for this procedure.
## 5.5 Proxy Mobile IPv6 LMA Initiated PDN Connection Deletion procedure
### 5.5.1 General
In EPC the PMIPv6 LMA Initiated PDN Connection Deletion is initiated by the
node acting as a LMA to notify the node acting as a MAG, that the Binding
Cache Entry related to the UE is about to be deactivated, so the MAG should
remove the resources related to that PDN connection. The procedure starts with
the LMA sending a BRI to the MAG to revoke the binding. The MAG confirms the
revocation of the binding by sending a BRA to the LMA.
The LMA Initiated PDN Connection Deletion Procedure initiated by the LMA
achieves the following:
  * **IPv6 Home Network Prefix release** : When the UE\'s PDN connection is deactivated, the LMA returns the IPv6 Home Network Prefix assigned to the UE\'s PDN connection to the pool of free IPv6 Home Network Prefixes.
  * **IPv4 Home Address release** : When the UE\'s PDN connection is deactivated, the LMA returns the IPv4 Home Address assigned to the UE\'s PDN connection to the pool of free IPv4 Home Network Addresses.
  * **Downlink and Uplink GRE keys de-assignment** : The MAG and LMA will return, respectively, the PDN connection\'s uplink and downlink GRE keys to their respective pool of free GRE keys.
  * **GRE tunnel Deletion** : The GRE tunnel is removed from the LMA and the MAG.
  * **BCE Deletion** : The LMA deletes the BCE for the PDN connection.
  * **BULE Deletion** : The MAG deletes the BULE for the PDN connection.
#### 5.5.1.1 Binding Revocation Indication
The fields of a BRI message for the PMIPv6 LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.5.1.1-1.
The Mobility Options in a BRI message for the LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.5.1.1-2.
Table 5.5.1.1-1: Fields of a BRI message for the PMIPv6
* * *
Information element IE Description Reference Sequence Number A sequence number
generated by the LMA, and increased for every BRI sent. draft-ietf-mext-
binding-revocation [6] Revocation Trigger Set to a value indicating the event
which triggered the revoking node to send the BRI message draft-ietf-mext-
binding-revocation [6] Proxy Binding Flag (P) Set to \"1\" to indicate that
the Binding Revocation Indication is for a proxy MIPv6 binding entry. IETF RFC
5213 [4] IPv4 HoA Binding Only (V) Set to \"0\" to request for complete
binding revocation draft-ietf-mext-binding-revocation [6] Global Per-Peer
Bindings (G) Set to 0 to indicate that the request is for a specific PMIPv6
BCE. draft-ietf-mext-binding-revocation [6]
* * *
Table 5.5.1.1-2: Mobility Options in a BRI message for the PMIPv6 LMA
Initiated PDN Connection Deletion
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS | | Identifier option | | identifier of the | 23.003[12] | | | | UE, as specified | | | | | in 3GPP TS | | | | | 23.003[12]. The | | | | | format of the NAI | | | | | is specified in | | | | | the subclause | | | | | 19.3 in 3GPP TS | | | | | 23.003 [12]. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | Set to the Home | IETF RFC 5213 | | Prefix option | | Network Prefix of | [4] | | | | the UE\'s PDN | | | | | connection. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Request | C | Set to the IPv4 | dr | | Address option | | home address of | aft-ietf-netlmm-p | | | | the UE\'s PDN | mip6-ipv4-support | | | | connection. | [5] | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the | | | | | UE\'s PDN | | | | | connection is | | | | | attached. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 2. | | +-------------------+------+-------------------+-------------------+ | Protocol | O | Contain Protocol | Subclause | | Configuration | | Configuration | 12.1.1.0 | | Options | | Options | | +-------------------+------+-------------------+-------------------+ | NOTE 1: At least | | | | | one of the two | | | | | options, namely, | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option or the | | | | | IPv4 Home Address | | | | | Request option | | | | | shall be present. | | | | | If the UE has | | | | | both IPv4 home | | | | | address and IPv6 | | | | | home network | | | | | prefix | | | | | registered, both | | | | | the IPv6 Home | | | | | Network Prefix | | | | | option and IPv4 | | | | | Home Address | | | | | Request option | | | | | shall be included | | | | | in the same BRI | | | | | message. | | | | | | | | | | NOTE 2: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
#### 5.5.1.2 Binding Revocation Acknowledgment
The fields of a BRA message for the PMIPv6 LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.5.1.2-1.
The Mobility Options in a BRA message for the LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.5.1.2-2.
Table 5.5.1.2-1: Fields of a BRA message for a PMIPv6 LMA Initiated PDN
Connection Deletion
* * *
Information element IE Description Reference Sequence Number Set to the value
received in the corresponding BRI. draft-ietf-mext-binding-revocation [6]
Status Indicates the result of the BRI draft-ietf-mext-binding-revocation [6]
Proxy Registration Flag (P) Set to \"1\" to indicate that the Binding
Revocation Acknowledgment is for a proxy MIPv6 binding entry. IETF RFC 5213
[4] IPv4 HoA Binding Only (V) Set to \"0\"; the same value as for BRI draft-
ietf-mext-binding-revocation [6] Global Per-Peer Bindings (G) Set to \"0\";
the same value as for the BRI. draft-ietf-mext-binding-revocation [6]
* * *
Table 5.5.1.2-2: Mobility Options in a BRA message for the PMIPv6 LMA
Initiated PDN Connection Deletion
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Copied from | IETF RFC 5213 | | Identifier option | | corresponding | [4] | | | | field of BRI. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | C | Set to the IPv6 | IETF RFC 5213 | | Prefix option | | Home Network | [4] | | | | Prefix of the | | | | | UE\'s PDN | | | | | connection | | | | | received in BRI. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | C | Set to the IPv4 | dr | | Reply Option | | home address of | aft-ietf-netlmm-p | | | | the UE\'s PDN | mip6-ipv4-support | | | | connection | [5] | | | | received in BRI. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Copied from the | IETF RFC | | Mobility Option | | corresponding | 5149[11] | | | | field in the PBU | | | | | message. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | Protocol | O | Contain Protocol | Subclause | | Configuration | | Configuration | 12.1.1.0 | | Options | | Options | | +-------------------+------+-------------------+-------------------+ | 3GPP Specific | O | Contain 3GPP | Subclause | | PMIPv6 Error Code | | Specific PMIPv6 | 12.1.1.1 | | | | Error Code | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
### 5.5.2 MAG procedures
The MAG shall follow the \"Local Mobility Anchor Revokes a PMIPv6 Binding\"
procedure described in the draft-ietf-mext-binding-revocation [6]. The MAG
should release the resources associated with the UE\'s PDN connection referred
to in the BRI message.
The MAG shall respond with a BRA.
### 5.5.3 LMA procedures
The LMA shall send a BRI to the MAG as described in the \"Local Mobility
Anchor Revokes a PMIPv6 binding\" procedure described in the draft-ietf-mext-
binding-revocation [6]. The LMA shall clear the BCE related to the UE\'s PDN
connection after sending the BRI in case of UE detach.
## 5.6 Proxy Mobile IPv6 PDN Connection IPv4 address allocation procedure
### 5.6.1 General
This procedure is initiated by the node acting as a MAG when DHCPv4 message is
received from the UE which requires a new IPv4 address. The MAG sends a PBU to
LMA requesting a new IPv4 address for an existing PDN connection. The LMA
assigns a new IPv4 address by sending a PBA to the MAG. IPv4 address
assignment procedure achieves the following:
  * **IPv4 Home Address assignment:** The LMA assigns to the UE\'s PDN connection an IPv4 Home Address valid in the selected PDN.
#### 5.6.1.1 Proxy Binding Update
The fields of a PBU message for the PMIPv6 PDN Connection IPv4 address
allocation procedure are depicted in Table 5.6.1.1-1.
The Mobility Options in a PBU message for the PMIPv6 PDN Connection IPv4
address allocation procedure are depicted in Table 5.6.1.1-2.
Other flags are not used by this specification.
Table 5.6.1.1-1: Fields of a PBU message for the PMIPv6 PDN Connection IPv4
address allocation procedure
* * *
Information element IE Description Reference Sequence Number Set to a locally
(i.e. per MAG) monotonically increasing value. IETF RFC 5213 [4] Lifetime Set
to the requested number of time units the binding shall remain valid. IETF RFC
3775 [8] Acknowledge (A) Set to \"1\" to request an acknowledgement message.
IETF RFC 3775 [8] Proxy Registration Flag (P) Set to \"1\" to indicate that
the Binding Update message is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.6.1.1-2: Mobility Options in a PBU message for the PMIPv6 PDN
Connection IPv4 address allocation procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS 23.003 | | Identifier option | | identifier of the | [12] | | | | UE as specified | | | | | in 3GPP TS 23.003 | | | | | [12]. The | | | | | format of the NAI | | | | | is specified in | | | | | the subclause | | | | | 19.3 in 3GPP TS | | | | | 23.003 [12]. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | M | Set to the IPv6 | IETF RFC 5213 | | Prefix option | | Home Network | [4] | | | | Prefix allocated | | | | | to the UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. | | +-------------------+------+-------------------+-------------------+ | Link-local | M | Set to the | IETF RFC 5213 | | Address | | link-local | [4] | | | | address already | | | | | allocated to the | | | | | MAG (in the | | | | | previous initial | | | | | binding | | | | | registration) for | | | | | use on the access | | | | | link shared with | | | | | the UE. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Set to the value | IETF RFC 5213 | | option | | \"5\" to indicate | [4] | | | | handoff state not | | | | | changed | | | | | ( | | | | | Re-registration). | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Set to the 3GPP | IETF RFC 5213 | | Type option | | access type, | [4] | | | | i.e., to GERAN, | | | | | UTRAN or E-UTRAN, | | | | | or to the value | | | | | matching the | | | | | characteristics | | | | | of the non-3GPP | | | | | access (e.g., | | | | | HRPD) the UE is | | | | | using to attach | | | | | to the EPS as | | | | | defined in the | | | | | Access Technology | | | | | Type Option type | | | | | values registry | | | | | of the IANA | | | | | Mobile IPv6 | | | | | Parameters | | | | | Registry [18]. | | | | | | | | | | NOTE 1 | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Set to the | IETF RFC 5213 | | | | current time | [4] | +-------------------+------+-------------------+-------------------+ | IPv4 Home Request | M | For dynamic | dr | | Address option | | allocation, set | aft-ietf-netlmm-p | | | | to the value | mip6-ipv4-support | | | | \"0.0.0.0\" to | [5] | | | | request | | | | | allocation for | | | | | the UE\'s PDN | | | | | connection of an | | | | | IPv4 Home Address | | | | | in the PDN | | | | | corresponding to | | | | | the EPS Access | | | | | Point Name. For | | | | | static | | | | | allocation, set | | | | | to the received | | | | | static allocated | | | | | IPv4 Home | | | | | Address. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the | | | | | UE\'s PDN | | | | | connection is | | | | | attached. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 2. | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The | | | | | PDN-GW can be | | | | | informed about | | | | | the type of | | | | | access network | | | | | used by the UE | | | | | over several | | | | | reference points, | | | | | see 3GPP TS | | | | | 29.212 [30] for | | | | | the mapping | | | | | between the code | | | | | values for the | | | | | different access | | | | | network types. | | | | | | | | | | NOTE 2: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
#### 5.6.1.2 Proxy Binding Acknowledgement
The fields of a PBA message for the PMIPv6 PDN Connection IPv4 address
allocation procedure are depicted in Table 5.6.1.2-1.
The Mobility Options in a PBA message for the PMIPv6 PDN Connection IPv4
address allocation procedure are depicted in Table 5.6.1.2-2.
Other flags are not used by this specification.
Table 5.6.1.2-1: Fields of a PBA message for the PMIPv6 PDN Connection IPv4
address allocation procedure
* * *
Information element IE Description Reference Status Set to indicate the
result. IETF RFC 3775 [8] Sequence Number Set to the value received in the
corresponding PBU. IETF RFC 5213 [4] Lifetime Set to the granted number of
time units the binding shall remain valid. IETF RFC 3775 [8] Proxy
Registration Flag (P) Set to \"1\" to indicate that the Binding Update message
is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.6.1.2-2: Mobility Options in a PBA message for the PMIPv6 PDN
Connection IPv4 address allocation procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Copied from | IETF RFC 5213 | | Identifier option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | IPv6 Home Network | M | Set to the IPv6 | IETF RFC 5213 | | Prefix option | | Home Network | [4] | | | | Prefix allocated | | | | | to the UE\'s PDN | | | | | connection based | | | | | on the selected | | | | | PDN. | | +-------------------+------+-------------------+-------------------+ | Link-local | M | Set to the | IETF RFC 5213 | | Address | | link-local | [4] | | | | address already | | | | | allocated to the | | | | | MAG (in the | | | | | previous initial | | | | | binding | | | | | registration) for | | | | | use on the access | | | | | link shared with | | | | | the UE. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Copied from | IETF RFC 5213 | | option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Copied from | IETF RFC 5213 | | Type option | | corresponding | [4] | | | | field of PBU. | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Copied from | IETF RFC 5213 | | | | corresponding | [4] | | | | field of PBU, or | | | | | set to the | | | | | current time of | | | | | LMA in case of | | | | | timestamp error. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | M | Set to the IPv4 | dr | | Reply option | | Home Address | aft-ietf-netlmm-p | | | | allocated for the | mip6-ipv4-support | | | | UE\'s PDN | [5] | | | | connection based | | | | | on the selected | | | | | PDN corresponding | | | | | to the EPS Access | | | | | Point Name for | | | | | dynamic | | | | | allocation, or | | | | | set to the static | | | | | IPv4 Home Address | | | | | received in the | | | | | PBU for static | | | | | allocation. | | +-------------------+------+-------------------+-------------------+ | IPv4 Default | M | Set to the UE's | dr | | Router Address | | IPv4 default | aft-ietf-netlmm-p | | Option | | router address. | mip6-ipv4-support | | | | | [5] | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Copied from the | IETF RFC | | Mobility Option | | corresponding | 5149[11] | | | | field in the PBU | | | | | message. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | 3GPP Specific | O | Contain 3GPP | Subclause | | PMIPv6 Error Code | | Specific PMIPv6 | 12.1.1.1 | | | | Error Code | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
### 5.6.2 MAG procedures
The MAG initiating IPv4 Address Allocation using DHCPv4 procedure shall follow
the \"Extending Binding Lifetime\" procedure described in the PMIPv6 [4] and
\"DHCP Relay Agent co-located with MAG\" or \"DHCP Server co-located with
MAG\" procedure as described in IPv4 support for PMIPv6 [5] specifications,
while parameters in the PBU are set as specified by the PBU parameters section
for this procedure.
  1. If the static IPv4 Home Address is available at the MAG, set it in the IPv4 home address Request option in the PBU.
  2. Set other parameters in the PBU as specified by the PBU parameters section for this procedure.
### 5.6.3 LMA procedures
On reception of a PBU, the LMA shall initiate the \"Binding Lifetime Extension
without Handover\" procedures as described in the PMIPv6 [4] and IPv4 support
for PMIPv6 [5] specifications with the following additional requirements:
  1. Check if the received IPv4 Home address is topologically correct.
  2. Allocate an IPv4 Home Address for the selected PDN.
  3. Set parameters in the PBA as specified by the PBA parameters section for this procedure.
## 5.7 Proxy Mobile IPv6 LMA Initiated IPv4 Address Release procedure
### 5.7.1 General
In the case when UE is assigned both IPv6 HNP and IPv4 Home Address, if IPv4
Address lease expires or DHCPv4 Release procedure, the node acting as LMA
initiates IPv4 Address Release procedure to notify the node acting as MAG
about release of IPv4 address of UE for a certain PDN connection. LMA
indicates MAG by sending a BRI and MAG confirms by replying with a BRA as
described in draft-ietf-mext-binding-revocation [6].
LMA Initiated IPv4 Address Release procedure achieves the following:
  * **IPv4 Home Address release** : The LMA returns the IPv4 Home Address assigned to the UE\'s PDN connection to the pool of free IPv4 Home Network Addresses.
#### 5.7.1.1 Binding Revocation Indication
The fields of a BRI message for the PMIPv6 LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.7.1.1-1.
The Mobility Options in a BRI message for the LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.7.1.1-2.
Table 5.7.1.1-1: Fields of a BRI message for the LMA Initiated IPv4 Address
Release
* * *
Information element IE Description Reference Sequence Number A sequence number
generated by the LMA, and increased for every BRI sent. draft-ietf-mext-
binding-revocation [6] Revocation Trigger Set to a value indicating the event
which triggered the revoking node to send the BRI message. draft-ietf-mext-
binding-revocation [6] Proxy Binding Flag (P) Set to \"1\" to indicate that
the Binding Revocation Indication is for a proxy MIPv6 binding entry. draft-
ietf-netlmm-proxymip6 [4] IPv4 HoA Binding Only (V) Set to \"1\" to revoke
IPv4 address only draft-ietf-mext-binding-revocation [6] Global Per-Peer
Bindings (G) Set to 0 to indicate that the request is for a specific PMIPv6
BCE. draft-ietf-mext-binding-revocation [6]
* * *
Table 5.7.1.1-2: Mobility Options in a BRI message for the LMA Initiated IPv4
Address Release
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS | | Identifier option | | identifier of the | 23.003[12] | | | | UE, as specified | | | | | in 3GPP TS | | | | | 23.003[12]. The | | | | | format of the NAI | | | | | is specified in | | | | | the subclause | | | | | 19.3 in 3GPP TS | | | | | 23.003 [12]. | | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | M | Set to the IPv4 | dr | | Request option | | home address of | aft-ietf-netlmm-p | | | | the UE\'s PDN | mip6-ipv4-support | | | | connection. | [5] | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the | | | | | UE\'s PDN | | | | | connection is | | | | | attached. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
#### 5.7.1.2 Binding Revocation Acknowledgment
The fields of a BRA message for the PMIPv6 LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.7.1.2-1.
The Mobility Options in a BRA message for the LMA Initiated PDN Connection
Deletion procedure are depicted in Table 5.7.1.2-2.
Table 5.7.1.2-1: Fields of a BRA message for a LMA Initiated IPv4 Address
Release
* * *
Information element IE Description Reference Sequence Number Set to the value
received in the corresponding BRI. draft-ietf-mext-binding-revocation [6]
Status Indicates the result of the BRI draft-ietf-mext-binding-revocation [6]
Proxy Binding Flag (P) Set to \"1\" to indicate that the Binding Revocation
Indication is for a proxy MIPv6 binding entry. draft-ietf-netlmm-proxymip6 [4]
IPv4 HoA Binding Only (V) Set to \"1\"; the same value as for BRI draft-ietf-
mext-binding-revocation [6] Global Per-Peer Bindings (G) Set to 0 to indicate
that the request is for a specific PMIPv6 BCE. draft-ietf-mext-binding-
revocation [6]
* * *
Table 5.7.1.2-2: Mobility Options in a BRA message for the LMA Initiated IPv4
Address Release
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Copied from | draft-ietf | | Identifier option | | corresponding | -netlmm-proxymip6 | | | | field of BRI. | [4] | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | M | Set to the IPv4 | dr | | Reply Option | | home address of | aft-ietf-netlmm-p | | | | the UE\'s PDN | mip6-ipv4-support | | | | connection | [5] | | | | received in BRI. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Copied from the | IETF RFC | | Mobility Option | | corresponding | 5149[11] | | | | field in the PBU | | | | | message. | | | | | | | | | | The encoding the | | | | | APN field follows | | | | | 3GPP TS 23.003 | | | | | [12] subclause | | | | | 9.1 but excluding | | | | | the trailing zero | | | | | byte. The content | | | | | of the APN field | | | | | shall be the full | | | | | APN with both the | | | | | APN Network | | | | | Identifier and | | | | | default APN | | | | | Operator | | | | | Identifier being | | | | | present as | | | | | specified in 3GPP | | | | | TS 23.003 [12] | | | | | subclauses 9.1.1 | | | | | and 9.1.2. | | | | | | | | | | NOTE 1. | | +-------------------+------+-------------------+-------------------+ | 3GPP Specific | O | Contain 3GPP | Subclause | | PMIPv6 Error Code | | Specific PMIPv6 | 12.1.1.1 | | | | Error Code | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The APN | | | | | field is not | | | | | encoded as a | | | | | dotted string as | | | | | commonly used in | | | | | documentation. | | | | +-------------------+------+-------------------+-------------------+
### 5.7.2 MAG procedures
The MAG shall follow the procedure for Revocation Trigger in BRI as \"IPv4 HoA
only\" in \"Binding Revocation Responder\" sub-section of \"Mobile Access
Gateway\" described in the draft-ietf-mext-binding-revocation [6]. The MAG
shall respond with a BRA. BRA message parameters are set as per the details in
BRA section of the procedure.
### 5.7.3 LMA procedures
The LMA shall send a BRI to the MAG as described for revoking IPv4 address
only in the \"Binding Revocation Initiator\" sub-section of \"Local Mobility
Anchor\" described in the draft-ietf-mext-binding-revocation [6]. The LMA
shall delete the IPv4 Address from corresponding BCE related to the UE\'s PDN
connection after recieving the BRA in reply to the BRI sent from LMA. BRI
message parameters are set as per the details in BRI section of the procedure.
## 5.8 Proxy Mobile IPv6 Multiple PDN Extensions
### 5.8.1 General
In EPC a UE can connect or disconnect to multiple distinct PDNs in an
independent manner. Thus a distinct PMIPv6 BCE and BULE exist for each of the
PDN connections of an UE.
### 5.8.2 Extensions to PMIPv6 Data Structure
There shall be a unique BCE and BULE for each PDN connection. Each PDN
connection can be uniquely identified by the APN in the BCE and BULE. To
support Multiple PDNs the MAG and LMA maintains extended data structure
compared to the standard PMIPv6 as defined in IETF RFC 5213 [4]. Since
multiple PDN connections of a UE can be distinguised based on an APN, both the
BCE on the LMA and the BULE on the MAG need to be extended with the following
additional field:
\- APN of a UE\'s PDN connection.
### 5.8.3 Extensions to PMIPv6 BULE and BCE Lookups
To support Multiple PDNs the MAG and LMA perform extended lookups on the
extended data structure compared to the standard PMIPv6 as defined in IETF RFC
5213 [4].
In standard PMIPv6 as defined in IETF RFC 5213 [4], a PMIPv6 BCE is looked up
based on the Mobile Node Identifier (MN-Id), the access technology types (ATT)
and if it exist the MN\'s link-layer identifier (MN-LL-Id).
In EPC the MN-LL-Id is not used and the EPC support handover between different
interfaces for handover between non-3GPP and 3GPP accesses. Since a distinct
PMIPv6 BCE exists for each of the PDN connections of an UE, and since multiple
PDN connections of a UE can be distinguised based on an APN, there is a one-
to-one mapping between a PMIPv6 BCE, a PDN connection, and the (MN-Id, APN)
tuple.
Thus, an UE PDN connection can be uniquely indentified by a (MN-Id, APN)
tuple, the BCE and BULE are accordingly looked up on a per (MN-Id, APN) tuple
basis.
## 5.9 Serving GW Procedure at Chaining Case
### 5.9.1 General
Chained S2a/S2b with GTP-based S8 is not supported in this release.
Chained S2a/S2b with PMIP-based S8 is used when VPLMN has business
relationship with Non-3GPP Networks and Serving GW in VPLMN supporting a LMA
function as local non-3GPP Anchor.
### 5.9.2 Signalling procedures
When either of the S2a or S2b interfaces is chained with a PMIP-based S8
interface, the Serving GW acts as the signaling endpoint for each interface.
On the S2a or S2b interface, the Serving GW acts as an LMA. On the chained
PMIP-based S8 interface, the Serving GW acts as MAG. When a procedure is
initiated by its peer on a given interface for a given PDN connection, the
Serving GW shall trigger an equivalent procedure over the chained interface
for the designated PDN connection. The procedure initiated by its peer cannot
be completed before the completion of the equivalent procedure initiated over
the chained interface.
#### 5.9.2.1 PMIP-based S8 Serving GW procedures
Upon receiving a PMIPv6 message over S8 for an LMA initiated procedure for a
given PDN connection, the Serving GW shall initiate the corresponding LMA
procedure over S2a or S2b for the designated PDN connection.
Upon receiving a PMIPv6 message over S2a or S2b for a MAG initiated procedure
for a given PDN connection, the Serving GW shall initiate the corresponding
MAG procedure over PMIP-based S8 for the designated PDN connection.
Table 5.9.2.1-1: procedure, message and IE mapping at PMIPv6 based S8
* * *
Initiated procedure Messages Initiating interface Chained interface
Corresponding procedure Chained interface Corresponding messages PDN
Connection Creation as specified in subclause 5.1 PBU/PBA S2a or S2b PMIPv6
based S8 PDN Connection Creation as specified in subclause 5.1 PBU/PBA PDN
Connection Lifetime Extension as specified in subclause 5.2 PBU/PBA S2a or S2b
PMIPv6 based S8 PDN Connection Lifetime Extension as specified in subclause
5.2 PBU/PBA PDN Connection Handover as specified in subclause 5.3 PBU/PBA S2a
or S2b PMIPv6 based S8 PDN Connection Handover as specified in subclause 5.3
PBU/PBA MAG Initiated PDN Connection Deletion as specified in subclause 5.4
PBU/PBA S2a or S2b PMIPv6 based S8 MAG Initiated PDN Connection Deletion as
specified in subclause 5.4 PBU/PBA **LMA Initiated PDN Connection Deletion as
specified in subclause 5.5** **BRI/BRA** **PMIPv6 based S8** **S2a or S2b**
**LMA Initiated PDN Connection Deletion as specified in subclause 5.5**
**BRI/BRA**
* * *
### 5.9.3 Payload packets at chained case
When the S2a or S2b interfaces is chained with a PMIP-based S8 interface, both
uplink and downlink payload packets are forwarded by the Serving GW between
the S2a or S2b PMIPv6 GRE tunnel and the S8 PMIPv6 GRE tunnel for a given PDN
connection.
## 5.10 Proxy Mobile IPv6 MAG Initiated IPv4 Address Release procedure
### 5.10.1 General
In the case when UE is assigned both IPv6 HNP and IPv4 Home Address, for
DHCPv4 Release procedure, the node acting as MAG initiates the selective de-
registration of IPv4 home address procedure to notify the node acting as LMA
about release of IPv4 address of UE for a certain PDN connection. MAG notifies
LMA by sending a PBU and LMA confirms by replying with a PBA as described in
draft-ietf-netlmm-pmip6-ipv4-support [5]. IPv4 address release procedure
achieves the following:
**IPv4 Home Address release:** The LMA releases an IPv4 Home Address of the
UE\'s PDN connection.
#### 5.10.1.1 Proxy Binding Update
The fields of a PBU message for the PMIPv6 MAG Initiated IPv4 Address Release
procedure are depicted in Table 5.10.1.1-1.
The Mobility Options in a PBU message for the PMIPv6 MAG Initiated IPv4
Address Release procedure are depicted in Table 5.10.1.1-2.
Other flags are not used by this specification.
Table 5.10.1.1-1: Fields of a PBU message for the PMIPv6 MAG Initiated IPv4
Address Release procedure
* * *
Information element IE Description Reference Sequence Number Set to a locally
(i.e. per MAG) monotonically increasing value. IETF RFC 5213 [4] Lifetime Set
to "0" to request deletion of the IPv4 binding. draft-ietf-netlmm-
pmip6-ipv4-support [5] Acknowledge (A) Set to \"1\" to request an
acknowledgement message. IETF RFC 3775 [8] Proxy Registration Flag (P) Set to
\"1\" to indicate that the Binding Update message is a proxy registration.
IETF RFC 5213 [4]
* * *
Table 5.10.1.1-2: Mobility Options in a PBU message for the PMIPv6 MAG
Initiated IPv4 Address Release procedure
+-------------------+------+-------------------+-------------------+ | Information | Cat. | IE Description | Reference | | element | | | | +-------------------+------+-------------------+-------------------+ | Mobile Node | M | Set to the NAI | 3GPP TS 23.003 | | Identifier option | | identifier of the | [12] | | | | UE as specified | | | | | in 3GPP TS 23.003 | | | | | [12]. | | +-------------------+------+-------------------+-------------------+ | Handoff Indicator | M | Set to the value | IETF RFC 5213 | | option | | \"4\" to indicate | [4] | | | | Handoff state | | | | | unknown. | | +-------------------+------+-------------------+-------------------+ | Access Technology | M | Set to the value | IETF RFC 5213 | | Type option | | matching the | [4] | | | | characteristics | | | | | of the non-3GPP | | | | | access on S2a | | | | | (e.g., HRPD) the | | | | | UE is using to | | | | | attach to the EPS | | | | | as defined in the | | | | | Access Technology | | | | | Type Option type | | | | | values registry | | | | | of the IANA | | | | | Mobile IPv6 | | | | | Parameters | | | | | Registry [18]. | | | | | | | | | | NOTE 1 | | +-------------------+------+-------------------+-------------------+ | Timestamp option | M | Set to the | IETF RFC 5213 | | | | current time | [4] | +-------------------+------+-------------------+-------------------+ | IPv4 Home Address | M | Set to the IPv4 | dr | | Request option | | Home Address to | aft-ietf-netlmm-p | | | | be released of | mip6-ipv4-support | | | | the UE\'s PDN | [5] | | | | connection. | | +-------------------+------+-------------------+-------------------+ | Service Selection | M | Set to the EPS | IETF RFC | | Mobility Option | | Access Point Name | 5149[11] | | | | to which the | | | | | UE\'s PDN | | | | | connection is | | | | | attached, | | | | | formatted as | | | | | defined in 3GPP | | | | | TS 23.003 [12] | | +-------------------+------+-------------------+-------------------+ | NOTE 1: The | | | | | PDN-GW can be | | | | | informed about | | | | | the type of | | | | | access network | | | | | used by the UE | | | | | over several | | | | | reference points, | | | | | see 3GPP TS | | | | | 29.212 [30] for | | | | | the mapping | | | | | between the code | | | | | values for the | | | | | different access | | | | | network types. | | | | +-------------------+------+-------------------+-------------------+
#### 5.10.1.2 Proxy Binding Acknowledgement
The fields of a PBA message for the PMIPv6 MAG Initiated IPv4 Address Release
procedure are depicted in Table 5.10.1.2-1.
The Mobility Options in a PBA message for the PMIPv6 MAG Initiated IPv4
Address Release procedure are depicted in Table 5.10.1.2-2.
Other flags are not used by this specification.
Table 5.10.1.2-1: Fields of a PBA message for the PMIPv6 MAG Initiated IPv4
Address Release procedure
* * *
Information element IE Description Reference Status Set to indicate the
result. IETF RFC 3775 [8] Sequence Number Set to the value received in the
corresponding PBU. IETF RFC 5213 [4] Lifetime Set to "0" to request deletion
of the IPv4 binding. draft-ietf-netlmm-pmip6-ipv4-support [5] Proxy
Registration Flag (P) Set to \"1\" to indicate that the Binding Update message
is a proxy registration. IETF RFC 5213 [4]
* * *
Table 5.10.1.2-2: Mobility Options in a PBA message for the PMIPv6 MAG
Initiated IPv4 Address Release procedure
* * *
Information element Cat. IE Description Reference Mobile Node Identifier
option M Copied from corresponding field of PBU. IETF RFC 5213 [4] Handoff
Indicator option M Copied from corresponding field of PBU. IETF RFC 5213 [4]
Access Technology Type option M Copied from corresponding field of PBU. IETF
RFC 5213 [4] Timestamp option M Copied from corresponding field of PBU, or set
to the current time of LMA in case of timestamp error. IETF RFC 5213 [4] IPv4
Home Address Reply Option M Set to the released IPv4 Home Address of the UE\'s
PDN connection. draft-ietf-netlmm-pmip6-ipv4-support [5] IPv4 Default Router
Address Option M Set to the UE's IPv4 default router address. draft-ietf-
netlmm-pmip6-ipv4-support [5] Service Selection Mobility Option M Copied from
the corresponding field in the PBU message, formatted as defined in 3GPP TS
23.003 [12] IETF RFC 5149[11] 3GPP Specific PMIPv6 Error Code O Contain 3GPP
Specific PMIPv6 Error Code Subclause 12.1.1.1
* * *
### 5.10.2 MAG procedures
The MAG initiating IPv4 Address Release using DHCPv4 procedure shall follow
the \"Selective De-Registration\" procedure and \"DHCP Server co-located with
MAG\" procedure as described in IPv4 support for PMIPv6 [5] specifications,
while parameters in the PBU are set as specified by the PBU parameters section
for this procedure.
  1. Set the IPv4 home address to be released in the IPv4 home address Request option in the PBU.
  2. Set other parameters in the PBU as specified by the PBU parameters section for this procedure.
### 5.10.3 LMA procedures
On reception of a PBU, the LMA shall initiate the \"Selective De-
Registration\" procedures as described in the IPv4 support for PMIPv6 [5]
specifications with the following additional requirements:
  1. Release the IPv4 Home Address corresponding to the IPv4 home address Request option in the PBU message.
  2. Set parameters in the PBA as specified by the PBA parameters section for this procedure.
# 6 Tunnel Management procedures
## 6.1 General
The Mobile Anchor Gateway (MAG) and the Local Mobility Anchor (LMA) establish
and maintain a bi-directional tunnel for each PDN connection, which is used
for routing the UE's PDN connection user-plane traffic between the MAG and the
LMA. This tunnel is based on GRE [20] encapsulation and is established as a
result of exchanging the Proxy Binding Update (PBU) and the Proxy Binding
Acknowledgment (PBA) messages between the MAG and LMA. The PBU and PBA
messages establish unique Binding Cache Entry (BCE) and Binding Update List
Entry (BULE) entries for each PDN connection at the LMA and the MAG
respectively. The tunnel end points are the Proxy-CoA and LMAA with GRE
encapsulation (for IPv6 transport network) or IPv4-Proxy-CoA and IPv4-LMAA
with GRE encapsulation (for IPv4 transport network), as described in draft-
ietf-netlmm-grekey-option [7]. GRE encapsulation shall always be used; the GRE
tunneling negotiation described in [7] is not applicable and the GRE Key
Identifier Option shall always be present in the PBU messages for PMIPv6 PDN
Connection Creation and binding registration after handover.
Tear down of GRE tunnels and cleanup of state is done explicitly by MAG
Initiated PDN Connection Deletion or LMA Initiated PDN Connection Deletion;
additionally, the tunnel is torn down when the binding lifetime expires as
described in IETF RFC 5213 [4].
Signalling messages as specified in Section 4 are sent natively without
encapsulation in IPv6 transport network and with IPv4 or IPv4-UDP
encapsulation in IPv4 transport network as specified in IETF draft-ietf-
netlmm-pmip6-ipv4-support [5].
A PMIPv6 node (MAG or LMA) that has no unicast IPv6 address but has a unicast
IPv4 address shall be able to receive a PMIPv6 message with this IPv4 address
in the destination address field of the outer IPv4 header, and the
corresponding IPv4-mapped IPv6 address in the destination address field of the
inner IPv6 header. When such a PMIPv6 node sends a PMIPv6 message to a PMIPv6
peer, it shall send the PMIPv6 message with its IPv4 address in the source
address field in the outer IPv4 header, and the corresponding IPv4-mapped IPv6
address in the source address field of the inner IPv6 header. This IPv4-mapped
IPv6 shall not be provisionned in the DNS.
When a PMIPv6 node (MAG or LMA) sends a PMIPv6 message to a PMIPv6 peer for
which it does not have a unicast IPv6 address but has a unicast IPv4 address,
it shall send the PMIPv6 message with its peer IPv4 address in the destination
address field in the outer IPv4 header, and the corresponding IPv4-mapped IPv6
address in the destination address field of the inner IPv6 header.
The IPv4-mapped IPv6 address is constructed from an IPv4 address as specified
in IETF RFC 4291[27].
The maximum size of an inner IP packet that may be transmitted without
fragmentation by the PDN GW or the MS/UE is the same as the maximum N-PDU size
that can be transmitted without IP fragmentation as defined in 3GPP TS 23.060
[23].
It is recommended to set the default inner MTU size at the PDN GW to 1280
octets in order to avoid IP fragmentation of both inner IP packets (in the PDN
GW or UE/MS) and outer IP packets in the backbone.
NOTE: The UE/MS, or a server in an external network, may determine the inner
MTU path by methods such as MTU discovery and hence fragment correctly at the
source.
## 6.2 MAG procedure
When the PDN connectivity is established, the downlink GRE key for the PDN
connection downlink traffic is selected by the MAG and sent to LMA in PBU
message. This downlink GRE key shall be unique within the MAG for a given LMAA
or IPv4-LMAA.
The uplink GRE key is received from LMA in a PBA message, and also from the
MME in case Serving GW relocation occurs. The MAG shall be able to send the
PDN connection uplink traffic using the received uplink GRE key towards the
LMAA or IPv4-LMAA before sending the PBU or before receiving the PBA.
When the PDN connection is released, the downlink GRE key shall be released by
the MAG.
## 6.3 LMA procedure
When the PDN connectivity is established, the uplink GRE key for the PDN
connection uplink traffic is selected by the LMA and sent to MAG in PBA
message. This uplink GRE key shall be unique within the LMA.
The LMA function shall be able to accept the PDN connection uplink packets
from any MAG without enforcing that the source IP address of the outer IP
header matches the Proxy-CoA in the UE BCE.
If GTP based S5/S8 is used for E-UTRAN access and PMIP based S2a is used for
HRPD access, and optimized handover between E-UTRAN and HRPD is supported,
when the PGW allocates an uplink TEID for a default bearer of a GTP tunnel, it
shall also reserve an uplink GRE key with the same value of the default bearer
uplink TEID.
When the PDN connection is released, the uplink GRE key shall be released by
the LMA.
## 6.4 Data Structures
### 6.4.1 Binding Update List Entry
MAG maintains a unique Binding Update List Entry for for each PDN connection
of a UE. The required elements of BULE as per 3GPP requirements are described
in table 6.4.1-1.
Table 6.4.1-1: Elements of BULE
+----------------------+----------------------+----------------------+ | Element | Description | Reference | +----------------------+----------------------+----------------------+ | Mobile Node | Set to the NAI | 3GPP TS 23.003 | | Identifier | identifier of the UE | [12], | | | as specified in 3GPP | draft-i | | | TS 23.003 [12]. | etf-netlmm-proxymip6 | | | | [4] | +----------------------+----------------------+----------------------+ | Access Point Name | Set to the EPS | 3GPP TS 23.003 | | | Access Point Name to | [12] | | | which the UE\'s PDN | | | | connection is | | | | attached, formatted | | | | as defined in 3GPP | | | | TS 23.003 [12] | | +----------------------+----------------------+----------------------+ | Lifetime | Set to lifetime | IETF RFC 3775 [8] | | | granted for the | | | | binding as received | | | | in PBA. | | +----------------------+----------------------+----------------------+ | Remaining Lifetime | This lifetime is | IETF RFC 3775 [8] | | | initialized from the | | | | lifetime granted for | | | | the binding and is | | | | decremented until it | | | | reaches 0. | | +----------------------+----------------------+----------------------+ | Sequence Number | The sequence number | IETF RFC 3775 [8] | | | of the last Proxy | | | | Binding Update | | | | message sent. | | +----------------------+----------------------+----------------------+ | Timestamp | Time at which last | IETF RFC 3775 [8] | | | PBU was sent. | | +----------------------+----------------------+----------------------+ | Binding Flag | Set to 1 if MAG | IETF RFC 3775 [8] | | | receives an ICMPv6 | | | | parameter problem, | | | | code 1, error | | | | message in response | | | | to a PBU. | | | | | | | | Set to 0 if MAG | | | | continues to send | | | | PBU. | | +----------------------+----------------------+----------------------+ | IPv6 Home Network | IPv6 Home Network | draft-i | | Prefix | Prefix assigned to | etf-netlmm-proxymip6 | | | the UE\'s PDN | [4] | | | connection. | | +----------------------+----------------------+----------------------+ | Link-local Address | IPv6 Link-local | IETF RFC 5213 [4] | | | address to be used | | | | by the MAG on the | | | | access link shared | | | | with the UE. | | +----------------------+----------------------+----------------------+ | IPv4 Home Address | IPv4 Home Address | draft-i | | | assigned to UE\'s | etf-netlmm-proxymip6 | | | PDN connection. | [4] | +----------------------+----------------------+----------------------+ | IPv4 default-router | The IPv4 | draft-ietf-netlm | | address | default-router | m-pmip6-ipv4-support | | | address of the | [5] | | | mobile node. | | +----------------------+----------------------+----------------------+ | LMA IPv6 Address | IPv6 Address of the | IETF RFC 3775 [8] | | | LMA. | | +----------------------+----------------------+----------------------+ | LMA IPv4 Address | IPv4 Address of the | draft-ietf-netlm | | | LMA. | m-pmip6-ipv4-support | | | | [5] | +----------------------+----------------------+----------------------+ | Downlink GRE Key | Downlink GRE key for | draft-ietf- | | | the PDN connection | netlmm-grekey-option | | | as selected by MAG. | [7] | +----------------------+----------------------+----------------------+ | Uplink GRE key | Uplink GRE key for | draft-ietf- | | | the PDN connection | netlmm-grekey-option | | | selected by LMA as | [7] | | | received in GRE Key | | | | option of PBA. | | +----------------------+----------------------+----------------------+ | Chained Binding | Reference to the | | | Cache Entry | corresponding BCE | | | | used for the binding | | | | on the S8 interface. | | | | | | | | It shall be present | | | | only in the Serving | | | | GW, in case of | | | | S2a/S2b - PMIP | | | | based-S8 chaining. | | +----------------------+----------------------+----------------------+
### 6.4.2 Binding Cache Entry
LMA maintains a unique Binding Cache Entry for each PDN connection for a UE.
The required elements of BCE as per 3GPP requirements are described in table
6.4.1-2.
Table 6.4.2-1: Elements of BCE
+----------------------+----------------------+----------------------+ | Element | Element Description | Reference | +----------------------+----------------------+----------------------+ | Mobile Node | The MN-Id mobility | 3GPP TS 23.003 | | Identifier | option as received | [12], | | | in PBU. | draft-i | | | | etf-netlmm-proxymip6 | | | | [4] | +----------------------+----------------------+----------------------+ | Access Point Name | The Service | 3GPP TS 23.003 | | | Selection Mobility | [12] | | | option received in | | | | PBU | | +----------------------+----------------------+----------------------+ | Lifetime | Lifetime granted for | IETF RFC 3775 [8] | | | the binding. | | +----------------------+----------------------+----------------------+ | Sequence Number | Sequence number of | IETF RFC 3775 [8] | | | last received PBU. | | +----------------------+----------------------+----------------------+ | IPv6 Home Network | IPv6 Home Network | draft-i | | Prefix | Prefix assigned to | etf-netlmm-proxymip6 | | | the UE\'s PDN | [4] | | | connection. | | +----------------------+----------------------+----------------------+ | Link-local Address | The assigned IPv6 | IETF RFC 5213 [4] | | | link local address | | | | to MAG for use on | | | | the access link | | | | shared with the UE. | | +----------------------+----------------------+----------------------+ | IPv4 Home Address | IPv4 Home Address | draft-i | | | assigned to UE\'s | etf-netlmm-proxymip6 | | | PDN connection. | [4] | +----------------------+----------------------+----------------------+ | IPv4 default-router | The IPv4 | draft-ietf-netlm | | address | default-router | m-pmip6-ipv4-support | | | address of the | [5] | | | mobile node. | | +----------------------+----------------------+----------------------+ | IPv6 Proxy | MAG IPv6 Address, | IETF RFC 3775 [8] | | care-of-address | i.e. the source | | | | address of the IP | | | | packet in which PBU | | | | was received. | | +----------------------+----------------------+----------------------+ | IPv4 Proxy | MAG IPv4 Address. | draft-ietf-netlm | | care-of-address | | m-pmip6-ipv4-support | | | | [5] | +----------------------+----------------------+----------------------+ | Access Technology | Access Technology | draft-i | | Type | Type as received in | etf-netlmm-proxymip6 | | | PBU. | [4] | +----------------------+----------------------+----------------------+ | Timestamp | Timestamp as | | | | received in PBU. | | +----------------------+----------------------+----------------------+ | Binding Flag | '1' as it is proxy | draft-i | | | registration. | etf-netlmm-proxymip6 | | | | [4] | +----------------------+----------------------+----------------------+ | Downlink GRE key | Downlink GRE key for | draft-ietf- | | | the PDN connection | netlmm-grekey-option | | | selected by MAG as | [7] | | | received in GRE key | | | | option of PBU. | | +----------------------+----------------------+----------------------+ | Uplink GRE key | Uplink GRE key for | draft-ietf- | | | the PDN connection | netlmm-grekey-option | | | selected by LMA. | [7] | +----------------------+----------------------+----------------------+ | Chained Binding | Reference to the | | | Update List Entry | corresponding BULE | | | | used for binding on | | | | the S2a / S2b | | | | interface. | | | | | | | | It shall be present | | | | only in the Serving | | | | GW, in case of | | | | S2a/S2b -- | | | | PMIP-based S8 | | | | chaining. | | +----------------------+----------------------+----------------------+
## 6.5 Security
Security aspects for PMIPv6 are described in 3GPP TS 33.402 [19].
# 7 Path Management procedures
## 7.1 General
The path management for PMIPv6 is very similar to that of GTP; the main
difference is the use of PMIPv6 messages instead of GTP messages.
The restoration procedures that are triggered by path failure detection are
specified in 3GPP TS 23.007 [13].
## 7.2 Heartbeat Mechanism
### 7.2.1 General
A LMA or MAG shall support sending Heartbeat Message to a peer MAG or LMA for
Failure Detection and Restart Detection. The Heartbeat Message and procedures
of Failure Detection and Restart Detection are defined in IETF Draft draft-
ietf-netlmm-pmipv6-heartbeat [17]. When and how often a Heartbeat Request
message are sent is implementation specific but a periodic Heartbeat Request
shall not be sent more often than every 60 s on each path.
### 7.2.2 Heartbeat Message
#### 7.2.2.1 Heartbeat Request
Table 7.2.2.1-1 specifies the information elements included in the Heartbeat
Request message.
Table 7.2.2.1-1: Fields of a Heartbeat message for the Heartbeat request
* * *
Information element IE Description Reference R flag Set to 0 for a request
message. draft-ietf-netlmm-pmipv6-heartbeat[17] Sequence Number Set to a
locally monotonically increasing value. draft-ietf-netlmm-pmipv6-heartbeat
[17]
* * *
#### 7.2.2.2 Heartbeat Response
Table 7.2.2.2-1 and 7.2.2.2-2 specifies the information elements included in
the Heartbeat Response message.
Table 7.2.2.2-1: Fields of a Heartbeat message for the Heartbeat Response
* * *
Information element IE Description Reference R flag Set to 1 for a response
message. draft-ietf-netlmm-pmipv6-heartbeat [17] U flag Set to 0 if the
heartbeat response is sent as an answer to a heartbeat request. Set to 1
otherwise. draft-ietf-netlmm-pmipv6-heartbeat [17] Sequence Number Set to the
value received in the corresponding Heartbeat Request message. draft-ietf-
netlmm-pmipv6-heartbeat [17]
* * *
Table 7.2.2.2-2: Mobility Options in a Heartbeat message for the Heartbeat
Response
* * *
Information element IE Description Reference Restart Counter indicates the
current Restart Counter value draft-ietf-netlmm-pmipv6-heartbeat [17]
* * *
## 7.3 Void
## 7.4 Void
## 7.5 Void
## 7.6 UE-specific Error Handling
### 7.6.1 General
A PMIPv6 node (i.e., LMA or MAG) may support the UE-specific error indication
such that a PMIPv6 node may send a message to the source PMIPv6 node when no
binding exists for a packet received from a GRE tunnel.
### 7.6.2 MAG and LMA procedure
If a PMIPv6 receiving node (i.e. MAG or LMA) verifies that no PMIPv6 binding
exists for a received user packet based on GRE Key, the receiving PMIPv6 node
shall discard the packet. The PMIPv6 node may report the error to the peer
PMIPv6 node, in the form of an ICMP message, as specified in Sections 8.2 and
8.3 of IETF RFC2473 [31] for the node unreachable error case.
## 7.7 Void
## 7.8 Partial node failure requiring the removal of a subset of sessions
### 7.8.1 General
See 3GPP TS 23.007[13] for the description of this function.
### 7.8.2 Binding Revocation Indication message
The fields of a BRI message to revoke bulk PMIPv6 bindings initiated by the
LMA or the MAG are depicted in Table 7.8.2-1.
The Mobility Options in a BRI message to revoke bulk PMIPv6 bindings sent by
the LMA or the MAG are depicted in Table 7.8.2-2.
Table 7.8.2-1: Fields of a BRI message for the PMIPv6
* * *
Information element IE Description Reference Sequence Number A sequence number
generated by the LMA, and increased for every BRI sent. draft-ietf-mext-
binding-revocation [6] Revocation Trigger Set to a the value of \"Revoking
Mobility Node Local Policy\" draft-ietf-mext-binding-revocation [6] Proxy
Binding Flag (P) Set to \"1\" to indicate that the Binding Revocation
Indication is for a proxy MIPv6 binding entry. RFC 5213 [4] Global Per-Peer
Bindings (G) Set to 1 draft-ietf-mext-binding-revocation [6]
* * *
Table 7.8.2-2: Mobility Options in a BRI message for the PMIPv6 LMA or MAG
Initiated bulk PDN Connections Deletion for Partial Node failure
* * *
Information element Cat. IE Description Reference Mobile Node Identifier C Set
to the IP address of the MAG, only when the BRI message is sent by the MAG.
3GPP TS 23.402[3] Fully Qualified PDN Connection Set Identifier M This IE
shall be included by the MAG or LMA on the S5/S8 interfaces (see 3GPP TS
23.007 [13]) and contains the Fully Qualified PDN Connection Set Identifier(s)
that need to be revoked. Subclause 12.1.1.2
* * *
### 7.8.3 Binding Revocation Acknowledgement message
The fields of a BRA message to revoke bulk PMIPv6 bindings for the PMIPv6 LMA
or MAG Initiated PDN Connection Deletion procedure are depicted in Table
7.8.3-1.
Table 7.8.3-1: Fields of a BRA message for a PMIPv6 for a MAG or LMA Initiated
bulk PDN Connections Deletion for Partial Node failure
* * *
Information element IE Description Reference Sequence Number Set to the value
received in the corresponding BRI. draft-ietf-mext-binding-revocation [6]
Status Indicates the result of the BRI. draft-muhanna-mext-binding-revocation
[6] Proxy Registration Flag (P) Set to \"1\" to indicate that the Binding
Revocation Acknowledgment is for a proxy MIPv6 binding entry. RFC 5213 [4]
Global Per-Peer Bindings (G) Set to 1; the same value as for the BRI. draft-
ietf-mext-binding-revocation [6]
* * *
### 7.8.4 MAG procedures
The MAG can be the initiator or the receiver of a BRI message to revoke bulk
PMIPv6 bindings.\ \ The MAG shall follow the \"Local Mobility Anchor Revokes
Bulk PMIPv6 Bindings\" procedure described in the draft-ietf-mext-binding-
revocation [6] when it receives a Binding Revocation Indication message with G
bit set, removing the sessions identified by the Fully Qualified PDN
Connection Set Identifier Mobility Option.\ \ The MAG shall follow the
\"Mobile Access Gateway Revoke Bulk PMIPv6 Bindings\" when it sends a Binding
Revocation Indication message with G bit set to the LMA, including the Fully
Qualified PDN Connection Set Identifier Mobility Option.
### 7.8.5 LMA procedures
The LMA can be the initiator or the receiver of a BRI message to revoke bulk
PMIPv6 bindings.\ \ The LMA shall follow the \"Mobile Access Gateway Revokes
Bulk PMIPv6 Bindings\" procedure described in the draft-ietf-mext-binding-
revocation [6] when it receives a Binding Revocation Indication message with G
bit set, removing the sessions identified by the Fully Qualified PDN
Connection Set Identifier Mobility Option.\ \ The LMA shall follow the \"Local
Mobility Anchor Revoke Bulk PMIPv6 Bindings\" when it sends a Binding
Revocation Indication message with G bit set to the LMA, including the Fully
Qualified PDN Connection Set Identifier Mobility Option.
# 8 PMIP-based S5 and PMIP-based S8 description
## 8.1 Initial Attach procedures
### 8.1.1 General
### 8.1.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Creation as outlined in subclause 5.1.2.
### 8.1.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Creation as outlined in subclause 5.1.3
## 8.2 Serving GW Initiated PDN Connection Lifetime Extension procedures
### 8.2.1 General
### 8.2.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Lifetime Extension as outlined in subclause 5.2.2.
### 8.2.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Lifetime Extension as outlined in subclause 5.2.3.
## 8.3 UE, MME or HSS initiated Detach procedures
### 8.3.1 General
### 8.3.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 MAG Initiated PDN
Connection Deletion as outlined in subclause 5.4.2 repeated for each PDN
connection of the UE.
### 8.3.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 MAG Initiated PDN
Connection Deletion as outlined in subclause 5.4.3.
## 8.4 PDN GW Initiated PDN Disconnection procedures
### 8.4.1 General
### 8.4.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 LMA Initiated PDN
Connection Deletion as outlined in subclause 5.5.2.
### 8.4.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 LMA Initiated PDN
Connection Deletion for the selected PDN connection as outlined in subclause
5.5.3.
## 8.5 UE Requested Additional PDN Connectivity procedures
### 8.5.1 General
### 8.5.2 Serving GW procedures
If the Request Type indicates \"initial attach\", the Serving GW shall follow
the MAG procedure for the PMIPv6 PDN Connection Creation as outlined in
subclause 5.1.2.
If the Request Type indicates \"Handover\", the Serving GW shall follow the
MAG procedure for the PMIPv6 PDN Connection Handover as outlined in subclause
5.3.2.
### 8.5.3 PDN GW procedures
If the Request Type indicates \"initial attach\", the PDN GW shall follow the
LMA procedure for the PMIPv6 PDN Connection Creation as outlined in subclause
5.1.3.
If the Request Type indicates \"Handover\", the PDN GW shall follow the LMA
procedure for the PMIPv6 PDN Connection Handover as outlined in subclause
5.3.3.
## 8.6 Handover procedures
### 8.6.1 Intra-LTE TAU and Inter-eNodeB Handover with Serving GW Relocation
procedures
#### 8.6.1.1 General
#### 8.6.1.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.2 repeated for each PDN connection of
the UE.
#### 8.6.1.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.3.
### 8.6.2 TAU/RAU or Handover between GERAN A/Gb Mode or UTRAN Iu Mode and
E-UTRAN procedures
#### 8.6.2.1 General
#### 8.6.2.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.2 repeated for each PDN connection of
the UE.
#### 8.6.2.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.3.
### 8.6.3 Handover from Trusted or Untrusted Non-3GPP IP Access over S2a/S2b
to 3GPP Access Handover E-UTRAN over PMIP based S5/S8 without optimization
procedures
#### 8.6.3.1 General
#### 8.6.3.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.2 repeated for each PDN connection of
the UE.
#### 8.6.3.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.3
### 8.6.4 Handover from Trusted or Untrusted Non-3GPP IP Access over S2a/S2b
to 3GPP Access UTRAN/GERAN over PMIP based S5/S8 without optimization
#### 8.6.4.1 General
#### 8.6.4.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.2 repeated for each PDN connection of
the UE.
#### 8.6.4.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.3.
### 8.6.5 Handover from Trusted or Untrusted Non-3GPP IP Access over S2c to
3GPP Access over PMIP based S5/S8 without optimization
#### 8.6.5.1 General
#### 8.6.5.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.2 repeated for each PDN connection of
the UE.
#### 8.6.5.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.3.
### 8.6.6 Optimised Active Handover: cdma2000 eHRPD Access to EUTRAN
#### 8.6.6.1 General
#### 8.6.6.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.2 repeated for each PDN connection of
the UE.
#### 8.6.6.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.3.
### 8.6.7 Optimized Idle Mode Mobility: cdma2000 eHRPD Access to E-UTRAN
Access
#### 8.6.7.1 General
#### 8.6.7.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.2 repeated for each PDN connection of
the UE.
#### 8.6.7.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection
Handover as outlined in subclause 5.3.3..
## 8.7 UE Requested PDN Disconnection procedures
### 8.7.1 General
### 8.7.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the PMIPv6 MAG Initiated PDN
Connection Deletion, for the selected PDN connection as outlined in subclause
5.4.2.
### 8.7.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the PMIPv6 MAG Initiated PDN
Connection Deletion, for the selected PDN connection as outlined in subclause
5.4.3.
## 8.8 IPv4 Address Allocation using DHCP
### 8.8.1 General
### 8.8.2 Serving GW procedures
The Serving GW shall follow the MAG procedure for the Proxy Mobile IPv6 PDN
Connection IPv4 Address Allocation Procedure as defined in sub clause 5.6.2.
### 8.8.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the Proxy Mobile IPv6 PDN
Connection IPv4 Address Allocation Procedure as defined in sub clause 5.6.3.
## 8.9 PDN-GW Initiated IPv4 Address Delete Procedure
### 8.9.1 General
### 8.9.2 Serving GW procedures
If UE is assigned both IPv6 HNP and IPv4 HoA, the Serving GW shall follow the
MAG procedure for the LMA Initiated IPv4 Address Release procedure as defined
in sub clause 5.7.2.
### 8.9.3 PDN GW procedures
If UE is assigned both IPv6 HNP and IPv4 HoA, the PDN GW shall follow the LMA
procedure for the LMA Initiated IPv4 Address Release procedure as defined in
sub clause 5.7.3.
If UE is assigned only IPv4 HoA, then PDN-GW initiated PDN Disconnection
procedure is initiated.
# 9 Trusted Non-3GPP Access over S2a Description
## 9.1 Initial Attach procedures
### 9.1.1 General
### 9.1.2 Trusted Non-3GPP Access procedures
In PMIPv6 mode, the Trusted Non-3GPP Access shall follow the MAG procedure for
the PMIPv6 PDN Connection Creation as outlined in subclause 5.1.2.
### 9.1.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the MAG procedure for the PMIPv6 PDN
Connection Creation as outlined in subclause 5.1.3.
## 9.2 Trusted Non-3GPP Access Initiated PDN Connection Lifetime Extension
procedures
### 9.2.1 General
### 9.2.2 Trusted Non-3GPP Access procedures
In PMIPv6 mode, the Trusted Non-3GPP Access shall follow the MAG procedure for
the PMIPv6 PDN Connection Lifetime Extension as outlined in subclause 5.2.2.
### 9.2.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 PDN
Connection Lifetime Extension as outlined in subclause 5.2.3.
## 9.3 UE / Trusted Non-3GPP Access Initiated Detach and UE Requested PDN
Disconnection procedures
### 9.3.1 General
### 9.3.2 Trusted Non-3GPP Access procedures
In PMIPv6 mode, the Trusted Non-3GPP Access shall follow the MAG procedure for
the PMIPv6 MAG Initiated PDN Connection Deletion as outlined in subclause
5.4.2 for PDN Disconnection procedure,.
For Detach the Trusted Non-3GPP Access shall follow the above repeated for
each PDN connection of the UE.
### 9.3.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 MAG
Initiated PDN Connection Deletion as outlined in subclause 5.4.3.
## 9.4 HSS / AAA Initiated Detach procedures
### 9.4.1 General
The HSS/AAA may initiate a detach procedure resulting in a PMIPv6 De-
Registration.
### 9.4.2 Trusted Non-3GPP Access procedures
In PMIPv6 mode, the Trusted Non-3GPP Access shall follow the MAG procedure for
the PMIPv6 MAG Initiated PDN Connection Deletion as outlined in subclause
5.4.2 repeated for each PDN connection of the UE.
### 9.4.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 MAG
Initiated PDN Connection Deletion as outlined in subclause 5.4.3.
## 9.5 UE Initiated Connectivity to Additional PDN procedures
### 9.5.1 General
### 9.5.2 Trusted Non-3GPP Access procedures
In PMIPv6 mode, if the Request Type indicates \"initial attach\", the Trusted
Non-3GPP Access shall follow the MAG procedure for the PMIPv6 PDN Connection
Creation as outlined in subclause 5.1.2. If the Request Type indicates
\"Handover\", the Trusted Non-3GPP Access shall follow the MAG procedure for
the PMIPv6 PDN Connection Handover as outlined in subclause 5.3.2.
### 9.5.3 PDN GW procedures
In PMIPv6 mode, if the Request Type indicates \"initial attach\", the PDN GW
shall follow the LMA procedure for the PMIPv6 PDN Connection Creation as
outlined in subclause 5.1.3. If the Request Type indicates \"Handover\", the
PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection Handover
as outlined in subclause 5.3.3.
## 9.6 3GPP Access to Trusted Non-3GPP IP Access with PMIPv6 on S2a Handover
procedures without optimization
### 9.6.1 General
### 9.6.2 Trusted Non-3GPP Access procedures
In PMIPv6 mode, the Trusted Non-3GPP Access shall follow the MAG procedure for
the PMIPv6 PDN Connection Handover as outlined in subclause 5.3.2.
### 9.6.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 PDN
Connection Handover as outlined in subclause 5.3.3.
If IPv6 network prefix preservation is supported at a handover from 3GPP
Access with a GTP-based S5/S8 to non-3GPP Access, the LMA shall provide to the
MAG the link-local address which is used by the PDN GW at the link shared with
the UE in the 3GPP Access.
## 9.7 PDN GW Initiated Resource Allocation Deactivation procedures
### 9.7.1 General
### 9.7.2 Trusted Non-3GPP Access procedures
In PMIPv6 mode, the Trusted Non-3GPP Access shall follow the MAG procedure for
the PMIPv6 LMA Initiated PDN Connection Deletion as outlined in subclause
5.5.2.
### 9.7.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 LMA
Initiated PDN Connection Deletion as outlined in subclause 5.5.3.
## 9.8 IPv4 Address Allocation using DHCP
### 9.8.1 General
### 9.8.2 Trusted Non-3GPP Access procedures
The Trusted Non-3GPP Access shall follow the MAG procedure for the Proxy
Mobile IPv6 PDN Connection IPv4 Address Allocation Procedure as defined in sub
clause 5.6.2.
### 9.8.3 PDN GW procedures
The PDN GW shall follow the LMA procedure for the Proxy Mobile IPv6 PDN
Connection IPv4 Address Allocation Procedure as defined in sub clause 5.6.3.
## 9.9 PDN-GW Initiated IPv4 Address Delete Procedure
### 9.9.1 General
### 9.9.2 Trusted Non-3GPP Access procedures
If UE is assigned both IPv6 HNP and IPv4 HoA, the Trusted Non-3GPP Access
shall follow the MAG procedure for the LMA Initiated IPv4 Address Release
procedure as defined in sub clause 5.7.2.
### 9.9.3 PDN GW procedures
If UE is assigned both IPv6 HNP and IPv4 HoA, the PDN GW shall follow the LMA
procedure for the LMA Initiated IPv4 Address Release procedure as defined in
sub clause 5.7.3.
If UE is assigned only IPv4 HoA, then PDN-GW initiated Resource Allocation
Deactivation procedure is initiated.
## 9.10 Optimized E-UTRAN to CDMA2000 eHRPD Handover procedure
### 9.10.1 General
### 9.10.2 CDMA2000 HRPD access procedure
In PMIPv6 mode, the CDMA2000 HRPD access shall follow the MAG procedure for
the PMIPv6 PDN Connection Handover procedure as outlined in subclause 5.3.2.
### 9.10.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 PDN
Connection Handover procedure as outlined in subclause 5.3.3.
## 9.11 Optimized Idle Mode Mobility: E-UTRAN Access to cdma2000 eHRPD Access
procedure
### 9.11.1 General
### 9.11.2 CDMA2000 eHRPD access procedure
In PMIPv6 mode, the CDMA2000 eHRPD access shall follow the MAG procedure for
the PMIPv6 PDN Connection Handover procedure as outlined in subclause 5.3.2.
### 9.11.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 PDN
Connection Handover procedure as outlined in subclause 5.3.3.
# 10 Untrusted Non-3GPP Access over S2b Description
## 10.1 Initial Attach procedures
### 10.1.1 General
### 10.1.2 ePDG procedures
In PMIPv6 mode, the ePDG shall follow the MAG procedure for the PMIPv6 PDN
Connection Creation as outlined in subclause 5.1.2.
### 10.1.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the MAG procedure for the PMIPv6 PDN
Connection Creation as outlined in subclause 5.1.3.
## 10.2 ePDG Initiated PDN Connection Lifetime Extension procedures
### 10.2.1 General
### 10.2.2 ePDG procedures
In PMIPv6 mode, the ePDG shall follow the MAG procedure for the PMIPv6 PDN
Connection Lifetime Extension as outlined in subclause 5.2.2.
### 10.2.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 PDN
Connection Lifetime Extension as outlined in subclause 5.2.3.
## 10.3 UE / ePDG Initiated Detach and UE Requested PDN Disconnection
procedures
### 10.3.1 General
### 10.3.2 ePDG procedures
In PMIPv6 mode, the ePDG shall follow the MAG procedure for the PMIPv6 MAG
Initiated PDN Connection Deletion as outlined in subclause 5.4.2 for PDN
Disconnection procedure,
For Detach the ePDG shall follow the above repeated for each PDN connection of
the UE.
### 10.3.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 MAG
Initiated PDN Connection Deletion as outlined in subclause 5.4.3.
## 10.4 HSS / AAA Initiated Detach procedures
### 10.4.1 General
The HSS/AAA may initiate a detach procedure resulting in a PMIPv6 De-
Registration.
### 10.4.2 ePDG procedures
In PMIPv6 mode, the ePDG shall follow the MAG procedure for the PMIPv6 MAG
Initiated PDN Connection Deletion as outlined in subclause 5.4.2 repeated for
each PDN connection of the UE.
### 10.4.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 MAG
Initiated PDN Connection Deletion as outlined in subclause 5.4.3.
## 10.5 UE Initiated Connectivity to Additional PDN procedures
### 10.5.1 General
### 10.5.2 ePDG procedures
In PMIPv6 mode, if the Request Type indicates \"initial attach\", the ePDG
shall follow the MAG procedure for the PMIPv6 PDN Connection Creation as
outlined in subclause 5.1.2. If the Request Type indicates \"Handover\", the
ePDG shall follow the MAG procedure for the PMIPv6 PDN Connection Handover as
outlined in subclause 5.3.2.
### 10.5.3 PDN GW procedures
In PMIPv6 mode, if the Request Type indicates \"initial attach\", the PDN GW
shall follow the LMA procedure for the PMIPv6 PDN Connection Creation as
outlined in subclause 5.1.3. If the Request Type indicates \"Handover\", the
PDN GW shall follow the LMA procedure for the PMIPv6 PDN Connection Handover
as outlined in subclause 5.3.3.
## 10.6 3GPP Access to Untrusted Non-3GPP IP Access with PMIPv6 on S2b
Handover procedures without optimization
### 10.6.1 General
### 10.6.2 ePDG procedures
In PMIPv6 mode, the ePDG shall follow the MAG procedure for the PMIPv6 PDN
Connection Handover as outlined in subclause 5.3.2.
### 10.6.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 PDN
Connection Handover as outlined in subclause 5.3.3.
If IPv6 network prefix preservation is supported at a handover from 3GPP
Access with a GTP-based S5/S8 to non-3GPP Access, the LMA shall provide to the
MAG the link-local address which is used by the PDN GW at the link shared with
the UE in the 3GPP Access.
## 10.7 PDN GW Initiated Resource Allocation Deactivation procedures
### 10.7.1 General
### 10.7.2 ePDG procedures
In PMIPv6 mode, the ePDG shall follow the MAG procedure for the PMIPv6 LMA
Initiated PDN Connection Deletion as outlined in subclause 5.5.2.
### 10.7.3 PDN GW procedures
In PMIPv6 mode, the PDN GW shall follow the LMA procedure for the PMIPv6 LMA
Initiated PDN Connection Deletion as outlined in subclause 5.5.3.
## 10.8 PDN-GW Initiated IPv4 Address Delete Procedure
### 10.8.1 General
### 10.8.2 ePDG procedures
If UE is assigned both IPv6 HNP and IPv4 HoA, the ePDG shall follow the MAG
procedure for the LMA Initiated IPv4 Address Release procedure as defined in
sub clause 5.7.2.
### 10.8.3 PDN GW procedures
If UE is assigned both IPv6 HNP and IPv4 HoA, the PDN GW shall follow the LMA
procedure for the LMA Initiated IPv4 Address Release procedure as defined in
sub clause 5.7.3.
If UE is assigned only IPv4 HoA, then PDN-GW initiated Resource Allocation
Deactivation procedure is initiated.
# 11 S2a and S2b Chaining with PMIP-based S8 Description
## 11.1 Initial Attach procedures
### 11.1.1 General
### 11.1.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 PDN Connection Creation. In addition to the general
procedure, it shall include the PDN GW IP address received during the
authorization procedure into the PBU request, encoding it into a Vendor-
Specific Option (refer to clause 12.1.1.4).
### 11.1.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the LMA procedure for the PMIPv6 PDN Connection Creation on the S2a/S2b
interface. In addition to the general procedure, the Serving GW shall include
the PDN GW IP address received in the PBU request into the PBA, using the same
encoding (refer to clause 12.1.1.4).
\- the MAG procedure for the PMIPv6 PDN Connection Creation on the S8
interface. The Serving GW shall send the PBU request to the PDN GW IP address
received on the chained S2a / S2b interface.
## 11.2 ePDG / Trusted Non-3GPP Access Initiated PDN Connection Lifetime
Extension procedures
### 11.2.1 General
### 11.2.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 PDN Connection Lifetime Extension.
### 11.2.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the LMA procedure for the PMIPv6 PDN Connection Lifetime Extension on the
S2a/S2b interface.
\- the MAG procedure for the PMIPv6 PDN Connection Lifetime Extension on the
S8 interface.
## 11.3 UE / ePDG / Trusted Non-3GPP Access Initiated Detach procedures
### 11.3.1 General
### 11.3.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 MAG Initiated PDN Connection Deletion repeated for
each PDN connection of the UE.
### 11.3.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the LMA procedure for the PMIPv6 MAG Initiated PDN Connection Deletion on
the S2a/S2b interface.
\- the MAG procedure for the PMIPv6 MAG Initiated PDN Connection Deletion on
the S8 interface.
## 11.4 HSS / AAA Initiated Detach procedures
### 11.4.1 General
The HSS/AAA may initiate a detach procedure resulting in a PMIPv6 De-
Registration.
### 11.4.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 MAG Initiated PDN Connection Deletion repeated for
each PDN connection of the UE.
### 11.4.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the LMA procedure for the PMIPv6 MAG Initiated PDN Connection Deletion on
the S2a/S2b interface.
\- the MAG procedure for the PMIPv6 MAG Initiated PDN Connection Deletion on
the S8 interface.
## 11.5 UE Initiated Connectivity to Additional PDN procedures
### 11.5.1 General
### 11.5.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 PDN Connection Creation if the Request Type indicates
\"initial attach\", or the PMIPv6 PDN Connection Handover if the Request Type
indicates \"Handover\". In addition to the general procedure, it shall include
the PDN GW IP address received during the authorization procedure into the PBU
request, encoding it to the Vendor-Specific Option (refer to clause 12.1.1.4).
### 11.5.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the LMA procedure for the PMIPv6 PDN Connection Creation if the Request
Type indicates \"initial attach\", or the PMIPv6 PDN Connection Handover if
the Request Type indicates \"Handover\" on the S2a/S2b interface. In addition
to the general procedure, the Serving GW shall include the PDN GW IP address
received in the PBU request into the PBA, using the same encoding (refer to
clause 12.1.1.4).
\- the MAG procedure for the PMIPv6 PDN Connection Creation if the Request
Type indicates \"initial attach\", or the PMIPv6 PDN Connection Handover if
the Request Type indicates \"Handover\" on the S8 interface. The Serving GW
shall send the PBU request to the PDN GW IP address received on the chained
S2a / S2b interface.
## 11.6 3GPP Access to Trusted / Untrusted Non-3GPP IP Access Handover
procedures without optimization
### 11.6.1 General
### 11.6.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 PDN Connection Handover. In addition to the general
procedure, it shall include the PDN GW IP address received during the
authorization procedure into the PBU request, encoding it to the Vendor-
Specific Option (refer to clause 12.1.1.4).
### 11.6.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the LMA procedure for the PMIPv6 PDN Connection Handover on the S2a/S2b
interface. In addition to the general procedure, the Serving GW shall include
the PDN GW IP address received in the PBU request into the PBA, using the same
encoding (refer to clause 12.1.1.4).
\- the MAG procedure for the PMIPv6 PDN Connection Handover on the S8
interface. The Serving GW shall send the PBU request to the PDN GW IP address
received on the chained S2a / S2b interface.
## 11.7 UE Requested PDN Disconnection procedures
### 11.7.1 General
### 11.7.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 MAG Initiated PDN Connection Deletion, for the
selected PDN connection.
### 11.7.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the LMA procedure for the PMIPv6 MAG Initiated PDN Connection Deletion, for
the selected PDN connection on the S2a/S2b interface.
\- the MAG procedure for the PMIPv6 MAG Initiated PDN Connection Deletion, for
the selected PDN connection on the S8 interface.
## 11.8 PDN GW Initiated Resource Allocation Deactivation procedures
### 11.8.1 General
### 11.8.2 ePDG / Trusted Non-3GPP Access procedures
In PMIPv6 mode, the ePDG or Trusted Non-3GPP Access shall follow the MAG
procedure for the PMIPv6 LMA Initiated PDN Connection Deletion.
### 11.8.3 Serving GW procedures
In PMIPv6 mode, the Serving GW shall follow:
\- the MAG procedure for the PMIPv6 LMA Initiated PDN Connection Deletion on
the S8 interface.
\- the LMA procedure for the PMIPv6 LMA Initiated PDN Connection Deletion on
the S2a/S2b interface.
# 12 Information Elements
## 12.1 Additional Proxy Mobile IPv6 Information Elements
### 12.1.1 3GPP-Specific PMIPv6 Information Elements
#### 12.1.1.0 General
This specification requires the encoding of additional 3GPP-specific
Information Elements for PMIPv6 with the 3GPP Mobility Option, as defined by
3GPP TS 29. 282 [24]. The 3GPP specific Information Elements defined by this
specification are listed in the table 12.1.1.0-1.
Table 12.1.1.0-1: 3GPP Specific PMIPv6 Information Elements
* * *
3GPP Specific PMIPv6 Information eElement 3GPP Specific PMIPv6 Information
Element Description Protocol Configuration Options 3GPP PCO data, in the
format from 3GPP TS 24.008 [16] subclause 10.5.6.3 3GPP Specific PMIPv6 error
code 3GPP Vendor-Specific PMIPv6 error code, as specified in subclause
12.1.1.1 PDN GW IP address PDN GW IP address, as specified in subclause
12.1.1.4 DHCPv4 Address Allocation Procedure Indication DHCPv4 Address
Allocation Procedure Indication, as specified in subclause 12.1.1.5. Fully
Qualified PDN Connection Set Identifier FQ-CSID as specified in subclause
12.1.1.2 PDN Type Indication PDN type indication as specified in subclause
12.1.1.3 Charging ID Charging ID as specified in subclause 12.1.1.6 Selection
Mode Selection Mode as specified in subclause 12.1.1.7 Charging
Characteristics Subclause 12.1.1.8 Serving Network Subclause 12.1.1.9 Mobile
Equipment Identity Subclause 12.1.1.10 MSISDN Subclause 12.1.1.11 APN
Restriction Subclause 12.1.1.12 Maximum APN Restriction Subclause 12.1.1.13
* * *
Depending on the need for 3GPP-specific information content, there several
items of this information element may be added to the PBU, PBA, BRI, or BRA.
The subtype for a 3GPP specific PMIPv6 Information Element is defined in 3GPP
TS 29.282 [24]. The data format of the 3GPP specific PMIPv6 Information
Element is defined in this specification. If the data format is defined by
another specification, that specification shall be referenced in the table
above.
#### 12.1.1.1 3GPP Specific PMIPv6 Error Code
Proxy Binding Acknowledgement (PBA) and Binding Revocation Acknowledgment
(BRA) contain a mandatory Status information element and also may contain a
3GPP Specific PMIPv6 Error Code (3GSPEC) information element, which is coded
within Mobility Options field.
NOTE: IETF RFC 5213 [4] and IETF RFC 3775 [8] specify PMIPv6 Status values for
a PBA message for indicating the acceptance of a message, or for reporting an
error. Up-to-date values for the Status field are specified in the IANA
registry of assigned numbers [32]. IETF RFC 5846 [6] specifies PMIPv6 Status
values for the BRA message. Up-to-date BRA status values are specified in the
IANA registry of assigned numbers [33].
The purpose of the 3GSPEC information element, which is depicted in Figure
12.1.1.1-1 is to carry a GTPv2 Cause value within PMIP _v6_ messages. 3GPP TS
29.274 [22] specifies GTPv2 Cause values.
* * *
Bits  
Octets 8 7 6 5 4 3 2 1 1 3GPP Specific PMIPv6 Error Code
* * *
Figure 12.1.1.1-1: 3GPP Specific PMIPv6 Error Code
If MAG/SGW receives a 3GSPEC IE in Proxy Binding Acknowledgement message from
LMA/PGW, which requires that the MAG/SGW shall send a GTPv2 message to
MME/SGSN, then the MAG/SGW shall copy 3GSPEC value into GTPv2 Cause IE . If in
such case, the MAG/SGW does not receive 3GSPEC IE with PBA, depending on the
overall meaning of the PMIPv6 Status IE the MAG/SGW shall send to MME/SGSN one
of the following GTPv2 Cause values with CS bit set to 1:
\- \"Request Accepted\" (decimal 16), if the received PMIPv6 Status indicates
PBU acceptance.
\- \"Request rejected for a PMIP reason\" (decimal 112), if the received
PMIPv6 Status indicates PBU rejection.
If MAG/SGW receives a Cause IE with a GTPv2 message, which requires sending a
Binding Revocation Acknowledgement message to LMA/PGW, the MAG/SGW shall copy
the GTPv2 Cause value into the 3GSPEC IE.
#### 12.1.1.2 Fully Qualified PDN Connection Set Identifier (FQ-CSID)
A fully qualified PDN Connection Set Identifier (FQ-CSID) identifies a set of
PDN connections belonging to an arbitrary number of UEs on a node such as a
MME, SGW or PGW. The FQ-CSID is _generated by the MAG, the LMA and any other
node such as the MME for 3GPP access. It is generated for each new PDN
connection, and it is used in case of partial node failure to identify the PDN
connections associated with a Connection Set Identifier._
The FQ-CSID is coded as follows:
* * *
                      Bits                                                                                       
     Octets           8                                             7                    6   5   4   3   2   1   
     1                Node-ID Type                                  Number of CSIDs= m                           
     2 to p           Node-ID                                                                                    
     (p+1) to (p+2)   First PDN Connection Set Identifier (CSID)                                                 
     (p+3) to (p+4)   Second PDN Connection Set Identifier (CSID)                                                
     \...             \...                                                                                       
     (m-1) to m       m\"th PDN Connection Set Identifier (CSID)
* * *
Figure 12.1.1.2-1: FQ-CSID
The details of each field and value are specified in 3GPP TS 29.274[22].
#### 12.1.1.3 PDN Type Indication
The purpose of the _PDN type indication option is to indicate the GW decision
to change the PDN type and a cause for the change. This attribute is set by
the LMA in the PBA._
The MAG shall set the PDN type accordingly, if this option is present in the
PBA.
* * *
Bits  
Octets 8 7 6 5 4 3 2 1 1 PDN type  
2 Cause
* * *
Figure 12.1.1.3-1: PMIPv6 PDN type indication
The following defines the value of the PMIPv6 PDN type indication.
+------------------------------------------------+ | PDN type value | +------------------------------------------------+ | #1: IPv4 | | | | #2: IPv6 | +------------------------------------------------+ | Cause value as defined in 3GPP TS 29.274[13] | | | | #18: New PDN type due to network preference; | +------------------------------------------------+
#### 12.1.1.4 PDN GW IP address
The purpose of the PDN GW IP address information element is to carry the IP
address of the PDN GW to which the receiving Serving GW shall send a PBU on
the chained S8 interface. This information element shall be included only in a
PBU for initial attach or handover sent on S2a or S2b interface for S2a/S2b -
PMIP based S8 chaining scenario.The content and encoding of the PDN GW IP
address is depicted on Figure 12.1.1.4-1.
* * *
              Bits                                               
     Octets   8                      7   6   5   4   3   2   1   
     1-4/32   IPv4 or IPv6 Address
* * *
Figure 12.1.1.4-1: PDN GW IP Address
#### 12.1.1.5 DHCPv4 Address Allocation Procedure Indication
The purpose of the _DHCPv4 Address Allocation option is to indicate that
DHCPv4 is to be used in allocating the IPv4 address to the UE if the option is
present in the PBA message._
#### 12.1.1.6 Charging ID
The Charging ID is defined in figure 12.1.1.6-1.
* * *
              Bits                                            
     Octets   8                   7   6   5   4   3   2   1   
     1-4      Charging ID value
* * *
Figure 12.1.1.6-1: Charging ID
#### 12.1.1.7 Selection Mode
Selection Mode indicates they way the MME or SGSN selected the APN: whether a
subscribed APN was selected, or whether a non-subscribed APN sent by a UE or a
non-subscribed APN chosen by the SGSN was selected. The Selection Mode is
defined in 3GPP TS 23.060 [23]
The encoding of the Selection Mode is shown in Figure 12.1.1.7-1.
* * *
           Bits
Octets 8 7 6 5 4 3 2 1 1 Reserved Selection Mode
* * *
Figure 12.1.1.7-1: Selection mode
The reserved bits shall be set to 1 by the MAG and not processed by the LMA.
The defined Selection Mode values are shown in Table 12.1.17-1.
Table 12.1.1.7-1: Selection Mode
* * *
Value Selection mode value 0 MS or network provided APN, subscribed verified 1
MS provided APN, subscription not verified 2 Network provided APN,
subscription not verified 3 For future use. Shall not be sent. If received,
shall be interpreted as the value \'2\'.
* * *
#### 12.1.1.8 Charging Characteristics
The Charging Characteristics information element is defined in 3GPP TS 32.251
[25] and is a way of informing both the SGW and PGW of the rules for producing
charging information based on operator configured triggers. For the encoding
of this information element see 3GPP TS 32.298 [26].
The Charging Characteristics is defined in figure 12.1.1.8-1.
* * *
              Bits                                                         
     Octets   8                                7   6   5   4   3   2   1   
     1-2      Charging Characteristics value
* * *
Figure 12.1.1.8-1: Charging Characteristics
#### 12.1.1.9 Serving Network
Serving Network identifies the serving network the UE is attached to. The
format of the Serving Network 3GPP-specific Information Element is defined
below.
* * *
           Bits
Octets 8 7 6 5 4 3 2 1  
1 MCC digit 2 MCC digit 1  
2 MNC digit 3 MCC digit 3  
3 MNC digit 2 MNC digit 1
* * *
Figure 12.1.1.9-1
#### 12.1.1.10 Mobile Equipment Identity
The purpose of the Mobile Equipment Identity (MEI) information element is used
to convey the UE\'s terminal identity from the Serving GW to the PDN GW over
the S5/S8 interface.
The encoding of the MEI is depicted in Figure 12.1.1.10-1.
* * *
              Bits                                                    
     Octets   8                           7   6   5   4   3   2   1   
     1 to 8   Mobile Equipment Identity
* * *
Figure 12.1.1.10-1: Mobile Equipment Identity (MEI)
The MEI contains either the IMEI or IMEISV in the format defined in subclause
6.2 of 3GPP TS 23.003 [12].
The MEI shall contain the IMEISV if it is available. If only the IMEI is
available, then the last semiâ€‘octet of octet 8 of MEI shall be set to
\"1111\". Both IMEI and IMEISV are TBCD encoded, where IMEI is 15 BCD digits
and IMEISV is 16 BCD digits. Bits 5 to 8 of octet n encodes digit 2n, bits 1
to 4 of octet n encodes digit 2n-1. Digits are packed contiguously with no
internal padding.
NOTE: This encoding follows that of the IMEI(SV) field in the International
Mobile Equipment Identity (and Software Version) (IMEI(SV)) information
element defined in clause 7.7.53 of 3GPP TS 29.060 [28].
#### 12.1.1.11 MSISDN
The purpose of the MSISDN information element is used to convey the user\'s
MSISDN from the Serving GW to the PDN GW over the S5/S8 interface. MSISDN is
defined in 3GPP TS 23.003 [12].
The content and encoding of the MSISDN is depicted on Figure 12.1.1.11-1.
* * *
              Bits                                                        
     Octets   8                7                  6   5   4   3   2   1   
     1        Number digit 2   Number digit 1
     n        Number digit m   Number digit m-1
* * *
Figure 12.1.1.11-1: MSISDN
Octets 1 to n represent the MSISDN value in international number format as
described in ITU-T Rec E.164 [29], encoded as TBCD digits, i.e. digits from 0
through 9 are encoded \"0000\" to \"1001\". When there is an odd number of
digits, bits 8 to 5 of the last octet are encoded with the filler \"1111\".
#### 12.1.1.12 APN Restriction
The APN Restriction is defined in figure 12.1.1.12-1. The APN Restriction
value is specified in 3GPP TS 29.274 [22].
* * *
              Bits                                                
     Octets   8                       7   6   5   4   3   2   1   
     1        APN Restriction value
* * *
Figure 12.1.1.12-1: APN Restriction
#### 12.1.1.13 Maximum APN Restriction
The Maximum APN Restriction is defined in figure 12.1.1.13-1. The Maximum APN
Restriction value is specified in 3GPP TS 29.274 [22].
* * *
              Bits                                                        
     Octets   8                               7   6   5   4   3   2   1   
     1        Maximum APN Restriction value
* * *
Figure 12.1.1.13-1: Maximum APN Restriction
#