# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
**Structure of the OSA API Mapping (3GPP TR 29.998)**
The present document is part 5 subpart 4 of a multi-part deliverable covering
the Open Service Access (OSA); Application Programming Interface (API) Mapping
for OSA.
Table: Overview of the OSA APIs & Protocol Mappings 29.198 & 29.998-family
+-------+-------+-------+-------+-------+-------+-------+-------+ | OSA | OSA | | | | | | | | API | API | | | | | | | | spec | Ma | | | | | | | | ifica | pping | | | | | | | | tions | - | | | | | | | | 29. | 29. | | | | | | | | 198-f | 998-f | | | | | | | | amily | amily | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ove | 29.9 | Ove | | | | | | 98-01 | rview | 98-01 | rview | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | C | * | _Not | | | | | | 98-02 | ommon | 29.99 | A | | | | | | | Data | 8-02_ | pplic | | | | | | | D | | able _| | | | | | | efini | | | | | | | | | tions | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Fram | * |_ Not | | | | | | 98-03 | ework | 29.99 | A | | | | | | | | 8-03 _| pplic | | | | | | | | | able_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * | 2 | 2 | 2 | 2 | **2 | 2 | Ge | | *Call | 9.198 | 9.198 | 9.198 | 9.198 | 9.198 | 9.998 | neric | | Co | -04-1 | -04-2 | -04-3 | -04-4 | -04-5 | -04-1 | Call | | ntrol | | | | M | Conf. | | Co | | (CC) | C | Ge | M | ulti- | CC | | ntrol | | SCF** | ommon | neric | ulti- | media | SCF**| | -- | | | CC | CC | Party | CC | | | CAP | | | data | SCF | CC | SCF | | | ma | | | d | | SCF | | | | pping | | | efini | | | | | | | | | tions | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | |_29 |_ Ge | | | | | | | | .998- | neric | | | | | | | | 04-2 _| Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | INAP | | | | | | | | | map | | | | | | | | | ping_ | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | | _29 |_ Ge | | | | | | | | .998- | neric | | | | | | | | 04-3 _| Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | M | | | | | | | | | egaco | | | | | | | | | map | | | | | | | | | ping_ | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | | 2 | Multi | | | | | | | | 9.998 | party | | | | | | | | -04-4 | Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | ISC | | | | | | | | | ma | | | | | | | | | pping | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | User | 2 | User | | | | | | 98-05 | I | 9.998 | I | | | | | | | ntera | -05-1 | ntera | | | | | | | ction | | ction | | | | | | | SCF | | -- | | | | | | | | | CAP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | _29 |_ User | | | | | | | | .998- | I | | | | | | | | 05-2 _| ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | INAP | | | | | | | | | map | | | | | | | | | ping_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | _29 |_ User | | | | | | | | .998- | I | | | | | | | | 05-3 _| ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | M | | | | | | | | | egaco | | | | | | | | | map | | | | | | | | | ping_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | **29\. | * | | | | | | | | 998-0 | _User | | | | | | | | 5-4_ _| I | | | | | | | | | ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | SMS | | | | | | | | | mapp | | | | | | | | | ing_ _| | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Mob | 2 | User | | | | | | 98-06 | ility | 9.998 | S | | | | | | | SCF | -06-1 | tatus | | | | | | | | | and | | | | | | | | | User | | | | | | | | | Loc | | | | | | | | | ation | | | | | | | | | -- | | | | | | | | | MAP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | 2 | User | | | | | | | | 9.998 | S | | | | | | | | -06-2 | tatus | | | | | | | | | and | | | | | | | | | User | | | | | | | | | Loc | | | | | | | | | ation | | | | | | | | | -- | | | | | | | | | SIP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ter | * |_ Not | | | | | | 98-07 | minal | 29.99 | A | | | | | | | Ca | 8-07 _| pplic | | | | | | | pabil | | able_ | | | | | | | ities | | | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Data | 29.9 | Data | | | | | | 98-08 | Se | 98-08 | Se | | | | | | | ssion | | ssion | | | | | | | Co | | Co | | | | | | | ntrol | | ntrol | | | | | | | SCF | | -- | | | | | | | | | CAP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * | _Ge | * |_ Not | | | | | | 29.19 | neric | 29.99 | A | | | | | | 8-09 _| Mess | 8-09_ | pplic | | | | | | | aging | | able _| | | | | | | SCF_ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * | _Co | * |_ Not | | | | | | 29.19 | nnect | 29.99 | A | | | | | | 8-10 _| ivity | 8-10_ | pplic | | | | | | | Ma | | able _| | | | | | | nager | | | | | | | | | SCF_ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ac | * | _Not | | | | | | 98-11 | count | 29.99 | A | | | | | | | Manag | 8-11_ | pplic | | | | | | | ement | | able _| | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Cha | * |_ Not | | | | | | 98-12 | rging | 29.99 | A | | | | | | | SCF | 8-12 _| pplic | | | | | | | | | able_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | P | * | _Not | | | | | | 98-13 | olicy | 29.99 | A | | | | | | | Manag | 8-13_ | pplic | | | | | | | ement | | able _| | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Pre | * |_ Not | | | | | | 98-14 | sence | 29.99 | A | | | | | | | & | 8-14 _| pplic | | | | | | | Av | | able_ | | | | | | | ailab | | | | | | | | | ility | | | | | | | | | Manag | | | | | | | | | ement | | | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Multi | * | _Not | | | | | | 98-15 | Media | 29.99 | A | | | | | | | Mess | 8-15_ | pplic | | | | | | | aging | | able _| | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Se | * |_ Not | | | | | | 98-16 | rvice | 29.99 | A | | | | | | | B | 8-16 _| pplic | | | | | | | roker | | able_ | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+
# 1 Scope
The present document investigates how the OSA User Interaction Interface Class
methods defined in 3GPP TS 29.198‑5 [5] can be mapped onto CAMEL Application
Part operations and Mobile Application Part operations, within the context of
SMS. The mapping of the OSA API to the CAP and relevant MAP operations is
considered informative, and not normative. An overview of the mapping TR is
contained in the introduction of the present document as well as in 3GPP TR
29.998-1 [10].
The OSA specifications define an architecture that enables application
developers to make use of network functionality through an open standardised
interface, i.e. the OSA API\'s. The API specification is contained in the 3GPP
TS 29.198 series of specifications. An overview of these is available in the
introduction of the present document as well as in 3GPP TS 29.198-1 [1]. The
concepts and the functional architecture for the Open Service Access (OSA) are
described by 3GPP TS 23.198 [3]. The requirements for OSA are defined in 3GPP
TS 22.127 [2].
# 2 References
  * References are either specific (identified by date of publication > and/or edition number or version number) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 29.198-1: \"Open Service Access (OSA); Application Programming
Interface (API); Part 1: Overview\".
[2] 3GPP TS 22.127: \"Service Requirement for the Open Services Access (OSA);
Stage 1\".
[3] 3GPP TS 23.198: \"Open Service Access (OSA); Stage 2\".
[4] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[5] 3GPP TS 29.198-5: \"Open Service Access (OSA); Application Programming
Interface (API); Part 5: Generic user interaction\".
[6] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[7] 3GPP TS 29.078: \"Customised Applications for Mobile network Enhanced
Logic (CAMEL) Phase 3; CAMEL Application Part (CAP) specification\".
[8] 3GPP TS 22.101: \"Service Aspects; Service Principles\".
[9] ITU-T Recommendation Q.850: \"Usage of cause and location in the Digital
Subscriber Signalling System No. 1 and the Signalling System No. 7 ISDN User
Part\".
[10] 3GPP TR 29.998-1: \"Open Service Access (OSA); Application Programming
Interface (API) Mapping for OSA; Part 1: General Issues on API Mapping\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TS 29.198-1 [1] apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TS
29.198-1 [1] apply.
# 4 Generic Message Transfer Service SMS Call Flows
## 4.1 User Interaction
The User Interaction interface is used by applications to interact with end
users. The API supports call and non-call related User Interaction. In mapping
the User Interaction interface to SMS call flows, only non-call related User
Interaction is applicable.
### 4.1.1 createUI
**_createUI_** is a method that is used to create a new (non call related)
user interaction object.
NOTE: There are no associated CAP or MAP, SMS call flows.
Figure 4-1: Call Flow for createUI
Table 4-1: Normal Operation
* * *
Pre-conditions The application has been instructed to initiate a non call
related User Interaction 1 The application invokes the **_createUI_** method 2
The SCS creates a new UI object
* * *
**Parameter Mapping**
None.
### 4.1.2 createUICall
**_createUICall_** is a method that does not map to SMS delivery.
### 4.1.3 enableUINotification
**_enableUINotification_** is a method that enables the reception of a user
initiated user interaction. The user initiates this interaction by means of a
CAMEL Phase 3 enabled MO SMS.
Figure 4-2: Call Flow for enableUINotification
Two alternatives have been identified:
1\. The application requests notifications to be enabled (see table 4-2).
2\. HLR rejects CSI updates (see table 4-3).
Table 4-2: Normal Operation
* * *
Pre-conditions An agreement is established between the network operator\ and
the service provider for the event notification to be enabled
1 The application invokes the **_enableUINotification_** method
2 The gsmSCF sends a MAP **_AnyTimeModification_** to the HLR in order to
Activate the necessary CAMEL Subscription Information (SMS-CSI) (see note)
**NOTE:** CAMEL phase 3 only allows for activation/deactivation of the CSI and
not modification of the contents of the CSIs. As the SMS-CSI relates only to
MO messaging, only originating addresses are considered.\  
For SMS-CSI only DP SMS_Collected_Info is supported.
* * *
Table 4-3: Error condition
* * *
Pre-conditions gsmSCF had previously sent a MAP _AnyTimeModification_ message\
to the HLR as a result of an _enableUINotification_ request from the
application
1 HLR rejects the request to update the CSI
2 The gsmSCF sends an internal message to the SCS to indicate the up date
failure
3 The SCS invokes the exception on **_enableUINotification_**
* * *
Table 4-4: Parameter Mapping
+----------------------------------+----------------------------------+ | From: enableUINotification | To: MAP AnyTimeModification | +----------------------------------+----------------------------------+ | appInterface | | +----------------------------------+----------------------------------+ | | gsmSCFAddress | +----------------------------------+----------------------------------+ | eventCriteria | | | (TpUIEventCriteria): | | +----------------------------------+----------------------------------+ | OriginatingAddress | subscriberIdentity (see note) | +----------------------------------+----------------------------------+ | DestinationAddress | | +----------------------------------+----------------------------------+ | ServiceCode | | +----------------------------------+----------------------------------+ | assignmentID | | +----------------------------------+----------------------------------+ | | modification | | | RequestFor-CallForwardingSS-Data | +----------------------------------+----------------------------------+ | | modificat | | | ionRequestFor-CallBarringSS-Data | +----------------------------------+----------------------------------+ | | modificationRequestFor-CSI | | | | | | Requested CSI = SMS-CSI | | | | | | ModifyNotificationFlag | | | | | | Modify CSI State = Activate | +----------------------------------+----------------------------------+ | NOTE: In case an address range | | | is used, a separate MAP | | | AnyTimeModificationRequest shall | | | be sent for every address in the | | | range. | | +----------------------------------+----------------------------------+
### 4.1.4 disableUINotification
**_disableUINotification_** is a method that allows the application to remove
notification for UI related actions previously set.
Figure 4-3: Call Flow for disableUINotification
Table 4-5: Normal Operation
* * *
Pre-conditions An agreement is established between the network operator\ and
the service provider for the event notification to be disabled
1 The application invokes the **_disableUINotification_** method
2 The gsmSCF sends a MAP **_AnyTimeModification_** to the HLR in order to de-
activate the CAMEL subscription Information (SMS-CSI). Note that CAMEL Phase 3
only allows the capability to activate/deactivate CSI and not to modify the
triggering information
* * *
Table 4-6: Parameter Mapping
+----------------------------------+----------------------------------+ | From: disableUINotification | To: MAP AnyTimeModification | +----------------------------------+----------------------------------+ | assignmentID | | +----------------------------------+----------------------------------+ | | gsmSCFAddress | +----------------------------------+----------------------------------+ | | subscriberIdentity (see note) | +----------------------------------+----------------------------------+ | | modification | | | RequestFor-CallForwardingSS-Data | +----------------------------------+----------------------------------+ | | modificat | | | ionRequestFor-CallBarringSS-Data | +----------------------------------+----------------------------------+ | | modificationRequestFor-CSI | | | | | | - Requested CSI = SMS-CSI | | | | | | - ModifyNotificationFlag | | | | | | - Modify CSI State = Deactivate | +----------------------------------+----------------------------------+ | NOTE: A separate MAP | | | AnyTimeModificationRequest shall | | | be sent for every originating | | | address in the prior | | | enableUINotification and known | | | to the IpUIManager. | | +----------------------------------+----------------------------------+
### 4.1.5 userInteractionEventNotify
**_userInteractionEventNotify_** is a method that notifies the application of
a user initiated request for user interaction.
Figure 4-4: Call Flow for userInteractionEventNotify
Table 4-7
* * *
Pre-conditions CAMEL MO SMS interaction between gsmSSF and gsmSCF 1 The gsmSCF
has previously enabled the SMS-CSI DP triggers using the MAP
AnyTimeModification for the origination mobile subscriber address 2 The gsmSCF
receives the CAP **_InitialDPSMS_** from the gsmSSF 2 The gsmSCF sends an
equivalent internal message to the SCS 3 The SCS identified the correct
application that enable the notification request from the subscriber and
invokes the **_userInteractionEventNotify_** method
* * *
Table 4-8: Parameter Mapping
* * *
From: initialDPSMS To: _userInteractionEventNotify_ ui eventInfo
(TpUIEventInfo) : CallingPartyNumber OriginatingAddress
DestinationSubscriberNumber DestinationAddress ServiceKey ServiceCode
DataTypeIndication (= TP-DataCodingScheme) EventType DataString assignmentID
appInterface (output) IMSI  
LocationInfo in MSC ( C )  
LocationInfor in SGSN ( C )  
Time&Timezone  
TP-ShortMessageSubmissionSpecificInfo  
TP-ProtocolIdentifier  
TP-DataCodingScheme (=DataTypeIndication in eventInfo above)  
TP-ValidityPeriod ( C )  
SMSC Address  
NOTE: C = Conditional, supplied if available.
* * *
### 4.1.6 userInteractionAborted
**_userInteractionAborted_** is a method that indicates to the application
that the User Interaction service instance has terminated or closed
abnormally. No further communication will be possible between the User
Interaction service instance and the application.
Figure 4-5: Call Flow for userInteractionAborted
**Parameter Mapping**
None.
### 4.1.7 userInteractionNotificationInterrupted
**_userInteractionNotificationInterrupted_** is a method that indicates to the
application that all user interaction event notifications have been
temporarily interrupted.
NOTE: There are no associated CAP or MAP, SMS Call Flows.
Figure 4-6: Call Flow for userInteractionNotificationInterrupted
Table 4-9: Normal Operation
* * *
Pre-conditions User interaction event notifications have been enabled\ using
the _enableUINotification_ method on the UIManager interface
1 The SCS has detected, or has been informed of, a fault which prevents
further user interaction events from being notified
2 The SCS invokes the **_userInteractionNotificationInterrupted_** method
* * *
**Parameter Mapping**
None.
### 4.1.8 userInteractionNotificationContinued
**_userInteractionNotificationContinued_** is a method that indicates to the
application that user interaction event notifications will again be possible.
NOTE: There are no associated CAP or MAP, SMS Call Flows.
Figure 4-7: Call Flow for userInteractionNotificationContinued
Table 4-10: Normal Operation
* * *
Pre-conditions User interaction event notifications have been interrupted\ and
_userInteractionNotificationInterrupted_ method has been invoked
1 The SCS detects that user interaction event notifications are again possible
2 The SCS invokes the **_userInteractionNotificationContinued_** method
* * *
**Parameter Mapping**
None.
### 4.1.9 userInteractionFaultDetected
**_userInteractionFaultDetected_** is a method that indicates to the
application that a fault has been detected in the user interaction. This
method is invoked e.g. if the call has been deassigned.
Figure 4-8: Call Flow for userInteractionFaultDetected
Two scenarios have been identified:
1\. Interaction between a gsmSSF and gsmSCF (see table 4-11).
2\. Interaction between a HLR or MSC and SMS-G/IWMSC (see table 4-12).
Table 4-11: Normal Operation
* * *
Pre-conditions User interaction is in progress between the gsmSSF and gsmSCF 1
The gsmSCF detects or receives an indication that there is an error in the
user interaction 2 The gsmSCF sends an equivalent internal message to the SCS
3 The SCS invokes the **_userInteractionFaultDetected_** method to the
appropriate application
* * *
Table 4-12
* * *
Pre-conditions User interaction is in progress between the HLR or MSC and the
SMS-G/IWMSC 1 The SMS-G/IWMSC detects or receives an indication that there is
an error in the user interaction 2 The SMS-G/IWMSC sends an equivalent
internal message to the SCS 3 The SCS invokes the
**_userInteractionFaultDetected_** method to the appropriate application
* * *
Table 4-13: Parameter Mapping
* * *
From: Dialogue Error To: _userInteractionFaultDetected_
userInteractionIdentifier fault ReturnError
* * *
### 4.1.10 sendInfoReq
**_sendInfoReq_** is an asynchronous method that sends information to the
user.
Figure 4-9: Call Flow for sendInfoReq (scenario 1)
Figure 4-10: Call Flow for sendInfoReq (scenario 2)
Two Alternatives have been identified:
1\. MT SMS based interaction between the SMS-GMSC and MS (see table 4-14).
2\. CAMEL MO SMS based interaction between the gsmSCF and gsmSSF (see table
4-15).
Table 4-14: Normal Operation
* * *
Pre-conditions SMS interaction required by application 1 The application
invokes the sendInfoReq method 2 The SCS sends an equivalent internal message
to the SMS-GMSC 3 The SMS-GMSC sends a MAP **_SendRoutinginfoForSM_** message
to the HLR to obtain the serving MSC . If the MSC address is returned the SMS-
GMSC will send one or more MAP **_MTForwardShortMessage_** messages.
* * *
Table 4-15
* * *
Pre-conditions A control relationship exists between the gsmSCF and gsmSSFas a
result\ of a prior _InitialDPSMS_ message being received by the gsmSCF
1 The application invokes the **_sendInfoReq_** method
2 The SCS sends an equivalent internal message to the gsmSC
3 The gsmSCF sends a **_RequestReportSMS_** message to the gsmSSF if the
application requested a response in order to request an **_EventReportSMS_**
message at a future point in time indicating SMS submission or failure. If the
application logic has specified cost in the **_sendInfoReq_** , the gsmSCF
shall send a **_FurnishChargingInfoSMS_** to the gsmSSF. If the application
modifies the target address for the original MO SMS, the gsmSCF shall send a
**_ConnectSMS_** message to the gsmSSF, and if no address modification has
been carried out by the application, a **_ContinueSMS_** message is sent from
the gsmSCF to gsmSSF.
* * *
Table 4-16: Parameter Mapping (Scenario 1)
* * *
From: sendInfoReq To: MAP SendRoutingInfoForSM userInteractionSessionID  
info (choice)  
infoID  
InfoData  
infoAddress  
variableInfoSet  
variablePartInteger  
variablePartAddress MSISDN variablePartTime  
variablePartDate  
variablePartPrice  
repeatIndicator  
responseRequested  
assignmentID  
SM-PRI --(Note set enabled for direct SMS service) ServiceCentreAddress
* * *
Table 4-17
* * *
From: sendInfoReq To: MAP MTForwardShortMessage
userInteractionSessionID
                                                                                                     SM RP DA = IMSI/LMSI from SRI Conf
                                                                                                     SM RP OA = SMS-GMSC Address (Not used in Reply)
                                                                                                     SM RP UI = 03.40 SMS-Deliver
                                                                                                     MessageTypeIndicator
                                                                                                     MoreMessagesToSend = RepeatIndicator
                                                                                                     ReplyPath = Not set for SendInfoReq\
                                                                                                     (see Note)
                                                                                                     StatusReportInd = ResponseRequested
                                                                                                     OrigAddress (application SME)
**info (choice)**
infoID
infoData Encoded in ShortMessagePDU; DataCoding Scheme,UserDataLength &
UserData
infoAddress
variableInfoSet
variablePartInteger
variablePartAddress
variablePartTime SC Time Stamp
variablePartDate SC Time Stamp
variablePartPrice
RepeatIndicator = MMS in UI above
ResponseRequested = SRI in UI above
assignmentID
NOTE: SendInfoReq does not request a reply message, therefore the reply path
shall be disabled.\  
Replies to the message from the handset should be returned to the enabled SMSC
for the handset.\  
The SMSC can either discard replies or be configured to contact the
application SME.
* * *
Table 4-18: Scenario 2
* * *
From: sendInfoReq To: RequestReportSMSEvent userInteractionSessionID  
info (choice)  
infoID  
infoData  
infoAddress  
variableInfoSet  
repeatIndicator  
responseRequested SMSEvent ; Enable an event if a sendInfoRes is needed
assignmentID
* * *
Table 4-19
* * *
From: sendInfoReq To: FurnishChargingInfoSMS userInteractionSessionID  
info (choice)  
infoID  
infoData  
infoAddress  
variableInfoSet  
variablePartInteger  
variablePartAddress  
variablePartTime  
variablePartDate  
variablePartPrice FCI Billing Charging Characteristics repeatIndicator  
responseRequested  
assignmentID
* * *
Table 4-20
* * *
From: sendInfoReq To: ConnectSMS userInteractionSessionID  
CallingPartysNumber info (choice)  
infoID  
infoData  
infoAddress  
variableInfoSet  
variablePartInteger  
variablePartAddress DestinationSubscriberNumber variablePartTime  
variablePartDate  
variablePartPrice  
repeatIndicator  
responseRequested  
assignmentID  
SMSCAddress
* * *
No mapping exists between _sendInfoReq_ and _continueSMS_.
### 4.1.11 sendInfoRes
**_sendInfoRes_** is an asynchronous method that informs the application about
the start or the completion of a **_sendInfoReq()_**. This response is called
only if the application has requested a response.
Figure 4-11: Call Flow for sendInfoRes (scenario 1)
Figure 4-12: Call Flow for sendInfoRes (scenario 2)
Two alternatives have been identified:
1\. SMS based interaction between the MS and the SMS-GMSC (see table 4-21).
2\. Notification from gsmSSF to gsmSCF of an event previously requested by a
RequestReportSMSEvent (see table 4-22).
Table 4-21: Normal Operation
* * *
Pre-conditions The application has previously invoked the _sendInfoReq_
method\ and has requested a notification
1 The SMS-GMSC receives a MAP **_MT-ForwardShortMessage confirmation_**
message from the MSC
2 The SMS-GMSC sends an equivalent internal message to the SCS
3 The SCS identifies the correct application and invokes the **_sendInfoRes_**
method
* * *
Table 4-22
* * *
Pre-conditions  
1 The gsmSCF has previously requested the gsmSSF to monitor for a particular
SMS related event (e.g. SMS_Submitted, SMS_Failure) using the CAP
**_RequestReportSMSEvent_** method. 2 The gsmSSF detects the SMS event and
forwards the CAP **_EventReportSMS_** message to the gsmSCF 2 The gsmSCF sends
an equivalent internal message to the SCS 3 The SCS identified the correct
application that previously requested notification of the event, and invokes
the **_sendInfoRes_** method
* * *
Table 4-23: Parameter Mapping (Scenario 1)
* * *
From: MAP MT-ForwardShortMessage To: sendInfoRes userInteractionSessionID
assignmentID response
* * *
Table 4-24: Scenario 2
+--------------------------+-----------------------------------+ | From: CAP EventReportSMS | To: sendInfoRes | +--------------------------+-----------------------------------+ | | userInteractionSessionID | +--------------------------+-----------------------------------+ | | assignmentID | +--------------------------+-----------------------------------+ | EventType | Response = P_UI_MESSAGE_STORED | | | | | smsSubmitted | | +--------------------------+-----------------------------------+ | EventSpecificInfo | | +--------------------------+-----------------------------------+ | MISC SMS Info | | +--------------------------+-----------------------------------+
### 4.1.12 sendInfoErr
**_sendInfoErr_** is an asynchronous method that indicates that the request to
send information was unsuccessful.
Figure 4-13: Call Flow for sendInfoErr (scenario 1)
Figure 4-14: Call Flow for sendInfoErr (scenario 2)
Figure 4-15: Call Flow for sendInfoErr (scenario 3)
Three alternatives have been identified:
1\. MT SMS based interaction between the SMS-GMSC and MSC (see table 4-25).
2\. MO SMS, notification from gsmSSF to gsmSCF of an event previously
requested by a RequestReportSMSEvent (see table 4-26).
3\. MO SMS, dialogue error returned from gsmSSF to gsmSCF in response to prior
message attempt required in relation to a _sendInfoReq_ _(see table 4-27)._ **
Table 4-25: Normal Operation
* * *
Pre-conditions The application has previously invoked the _sendInfoReq_ method
1 As part of the MT SMS delivery dialogue the SMS-GMSC is returned an error
from either the HLR originated **sendRoutingInfoForSMConf** , or MSC
originated **MTForwardSMConf** 2 The SMS-GMSC sends an equivalent internal
message to the SCS 3 The SCS identifies the correct application and invokes
the **_sendInfoErr_** method
* * *
Table 4-26
* * *
Pre-conditions The application has previously invoked the _sendInfoReq_ method
(see note) 1 The gsmSCF has previously requested the gsmSSF to monitor for a
particular SMS related event (e.g. SMS_Submitted, SMS_Failure) using the CAP
**_RequestReportSMSEvent_** method 2 The gsmSSF detects the SMS event and
forwards the CAP **_EventReportSMS_** message to the gsmSCF 3 The gsmSCF sends
an equivalent internal message to the SCS 4 The SCS identified the correct
application that previously requested notification of the event, and invokes
the **_sendInfoErr_** method NOTE: **responseRequested** shall be required in
order to request notification of the subsequent event.
* * *
_Table 4-27_
* * *
Pre-conditions The application has previously invoked the _sendInfoReq_ method
(see note) 1 As a result of the contents of the **_sendInfoReq_** , the gsmSCF
has sent one of the following messages to the gsmSSF, RequestReportSMSEvent,
FurnishChargingInfoSMS, ConnectSMS, ContinueSMS 2 If any individual message
fails, a TCAP dialogue error shall be returned from gsmSSF to gsmSCF 3 The
gsmSCF sends an equivalent internal message to the SCS 4 The SCS identified
the correct application that previously requested notification of the event,
and invokes the **_sendInfoErr_** method 5 Depending on the message in error,
the application may be required to release the SMS processing using the
**_release_** method NOTE: **responseRequested** may or may not be required.
* * *
Table 4-28: Parameter Mapping (Scenario 1)
* * *
From: MAP SendRoutingInfoForSM To: sendInfoErr userInteractionSessionID
InvokeID assignmentID UserError error
* * *
Table 4-29
* * *
From: MAP MTForwardSM To: sendInfoErr userInteractionSessionID InvokeID
assignmentID UserError error
* * *
Table 4-30: Scenario 2
+--------------------------+--------------------------+ | From: CAP EventReportSMS | To: sendInfoErr | +--------------------------+--------------------------+ | | userInteractionSessionID | +--------------------------+--------------------------+ | | assignmentID | +--------------------------+--------------------------+ | EventType | | | | | | smsFailure | | +--------------------------+--------------------------+ | EventSpecificInfo | error | | | | | FailureSpecificInfo | | +--------------------------+--------------------------+ | MISC SMS Info | | +--------------------------+--------------------------+
Table 4-31: Scenario 3
* * *
From: TCAP Return Error To: sendInfoErr userInteractionSessionID InvokeID
assignmentID Error error
* * *
### 4.1.13 sendInfoAndCollectReq
**_sendInfoAndCollectReq_** is an asynchronous method that plays an
announcement or sends other information to the user and collects some
information from the user. The announcement usually prompts for a number of
characters (for example, these are digits or text strings such as \"YES\" if
the user's terminal device is a phone).
Figure 4-16: Call Flow for sendInfoAndCollectReq (scenario 1)
Figure 4-17: Call Flow for sendInfoAndCollectReq (scenario 2)
Two Alternatives have been identified.
1\. MT SMS based interaction between the SMS-G/IWMSC and the MS (see table
4-32).
2\. CAMEL MO SMS based interaction between the gsmSCF and gsmSSF (see table
4-33).
Table 4-32: Normal Operation
* * *
Pre-conditions SMS interaction requierd by application.\ SMS Gateway and
Interworking MSC functionality supported on the same node.
1 The application invokes the **_sendInfoAndCollectReq_** method
2 The SCS sends an equivalent internal message to the SMS-GMSC
3 The SMS-GMSC sends a MAP **_SendRoutinginfoForSM_** message to the HLR to
obtain the serving MSC . If the MSC address is returned the SMS-GMSC will send
one or more MAP **_MTForwardShortMessage_** messages with the address of the
SMS-GMSC as the service centre address for this message (SM_RP_OA), **and**
the ReplyPath Flag in the SM_RP_UI enabled. This ensures that SMS replies are
returned to the collocated SMS-IWMSC.
* * *
Table 4-33
* * *
Pre-conditions A control relationship exists between the gsmSCF and gsmSSF as
a result\ of a prior _InitialDPSMS_ message being received by the gsmSCF
1 The application invokes the **_sendInfoAndCollectReq_** method
2 The SCS sends an equivalent internal message to the gsmSCF
3 The gsmSCF sends a **_RequestReportSMS_** message to the gsmSSF if the
application requested a response in order to request an **_EventReportSMS_**
message at a future point in time indicating SMS submission or failure. If the
application logic has specified cost in the **_sendInfoAndCollectReq_** , the
gsmSCF shall send a **_FurnishChargingInfoSMS_** to the gsmSSF
4 Whether modification of the destination of the original MO SMS takes place
or not, the gsmSCF shall send a **_ConnectSMS_** message to the gsmSSF in
order to set the calling party address to be used when replying to the SMS to
the address of the gsmSCF
**NOTE: T** he **_ContinueSMS_** method does not map to the
**_SendInfoAndCollectReq_** operation. Also the SMS-CSI triggers enabled in
the network, ensure that the reply SMS results in an **_InitialDPSMS_** being
delivered to the gsmSCF. See subclause 4.1.14. This **_InitialDPSMS_** shall
contain the collected information in response to the
**_sendInfoAndCollectReq_** \-- this is limited to the first octet of the SMS-
SUBMIT PDU, and indicates that a response message has been returned to the
original message.
* * *
Table 4-34: Parameter Mapping (Scenario 1)
* * *
From: sendInfoAndCollectReq To: MAP SendRoutingInfoForSM
userInteractionSessionID  
info (choice)  
infoID  
InfoData  
infoAddress  
variableInfoSet  
variablePartInteger  
variablePartAddress MSISDN variablePartTime  
variablePartDate  
variablePartPrice  
criteria  
repeatIndicator  
responseRequested  
assignmentID  
SM-PRI --(Note set enabled for direct SMS service) ServiceCentreAddress
* * *
Table 4-35
* * *
From: sendInfoAndCollectReq To: MAP MTForwardShortMessage
userInteractionSessionID
                                                                                                          SM RP DA = IMSI/LMSI from SRI Conf
                                                                                                          SM RP OA = SMS-GMSC Address USED in reply
                                                                                                          SM RP UI = 03.40 SMS-Deliver
                                                                                                          MessageTypeIndicator
                                                                                                          MoreMessagesToSend = RepeatIndicator
                                                                                                          ReplyPath = Set for SendInfoAndCollectReq\
                                                                                                          (see Note)
                                                                                                          StatusReportInd = ResponseRequested
                                                                                                          OrigAddress (application SME)
info (choice)
infoID
infoData Encoded in ShortMessagePDU; DataCoding Scheme,UserDataLength &
UserData
infoAddress
variableInfoSet
variablePartInteger
variablePartAddress
variablePartTime SC Time Stamp
variablePartDate SC Time Stamp
variablePartPrice
criteria
RepeatIndicator = MMS in UI above
ResponseRequested = SRI in UI above
assignmentID
NOTE: SendInfoAndCollectReq requests a reply SMS message, therefore the reply
path shall be enabled.\  
Replies to the message from the handset should be returned to the SMS-G/IWMSC.
* * *
Table 4-36: Scenario 2
* * *
From: sendInfoAndCollectReq To: RequestReportSMSEvent userInteractionSessionID  
info (choice)  
infoID  
infoData  
infoAddress  
variableInfoSet  
criteria  
repeatIndicator  
responseRequested SMSEvent ; Enable an event if a sendInfoAndCollectRes is
needed to confirm message delivered. assignmentID
* * *
Table 4-37
* * *
From: sendInfoAndCollectReq To: FurnishChargingInfoSMS
userInteractionSessionID  
info (choice)  
infoID  
infoData  
infoAddress  
variableInfoSet  
variablePartInteger  
variablePartAddress  
variablePartTime  
variablePartDate  
variablePartPrice FCI Billing Charging Characteristics **criteria**  
repeatIndicator  
responseRequested  
assignmentID
* * *
Table 4-38
* * *
From: sendInfoAndCollectReq To: ConnectSMS userInteractionSessionID  
CallingPartysNumber = gsmSCF Address info (choice)  
infoID  
infoData  
infoAddress  
variableInfoSet  
variablePartInteger  
variablePartAddress DestinationSubscriberNumber variablePartTime  
variablePartDate  
variablePartPrice  
criteria  
**repeatIndicator**  
**responseRequested**  
**assignmentID**  
**SMSCAddress** NOTE: Modification of the SMSCAddress in the connectSMS above
should not influence the reply path, as the parameter in the connectSMS is the
target SMSC for the MO message prior to MT delivery attempt.
* * *
### 4.1.14 sendInfoAndCollectRes
**_sendInfoAndCollectRes_** is an asynchronous method that returns the
information collected to the application.
Figure 4-18: Call Flow for sendInfoAndCollectRes (scenario 1)
Figure 4-19: Call Flow for sendInfoAndCollectRes (scenario 2)
Two alternatives have been identified:
1\. SMS based interaction between the SMS-G/IWMSC and MS (see table 4-39).
2\. CAMEL MO SMS interaction between gsmSSF and gsmSCF (see table 4-40).
Table 4-39: Normal Operation
* * *
Pre-conditions The application has invoked a _sendInfoAndCollectReq_() 1 The
SMS-IWMSC receives a MAP **_MOForwardShortMessage_** message from the MSC 2
The SMS-IWMSC sends an equivalent internal message to the SCS 3 The SCS
invokes the **_sendInfoAndCollectRes_** method to the correct applications
* * *
Table 4-40
+----------------+----------------------------------------------------+ | Pre-conditions | The gsmSCF has previously enabled the SMS-CSI DP | | | triggers\ | | | using the MAP _AnyTimeModification_ for the | | | origination mobile subscriber address | +----------------+----------------------------------------------------+ | 1 | The gsmSCF may have previously requested the | | | gsmSSF to monitor for a particular SMS related | | | event (e.g. SMS_Submitted, SMS_Failure) using | | | the CAP **_RequestReportSMSEvent_** method. | | | | | | This shall result in the **_EventReportSMS_** | | | method being sent to the gsmSCF. | +----------------+----------------------------------------------------+ | 2 | The gsmSCF has previously issued a | | | **_ConnectSMS_** for a previous MO SMS delivery | | | and modified the Calling Parties Number to the | | | address of the gsmSCF so that reply SMS messages | | | addressed to the gsmSCF are considered in response | | | to the original MO SMS. | | | | | | The delivery of an **_InitialDPSMS_** where the | | | destinationSunscriberNumber is the gsmSCF is an | | | indication that the related MO SMS is in response | | | to a prior message delivered as a result of the | | | **sendInfoAndCollectReq**. | +----------------+----------------------------------------------------+ | 3 | The gsmSCF sends an equivalent internal message to | | | the SCS when either **_EventReportSMS_** or | | | **_InitialDPSMS_** are received. | +----------------+----------------------------------------------------+ | 4 | The SCS identified that the messages are in | | | response to a prior **_sendInfoAndCollectReq_** | | | and invokes the **_sendInfoAndCollectRes_** method | +----------------+----------------------------------------------------+
**Post condition**
After the application has been informed of the _sendInfoAndCollectRes_ method.
It shall continue to handle the SMS as outlined in subclause 4.1.5.
Table 4-41: Parameter Mapping (Scenario 1)
* * *
From: MAP MO ForwardShortMessage To: sendInfoAndCollectRes
userInteractionSessionID assignmentID response SMS-SUBMIT PDU Info (only the
User data component is mapped)
* * *
_Table 4-42: Scenario 2_
+--------------------------+-----------------------------------+ | From: CAP EventReportSMS | To: sendInfoAndCollectRes | +--------------------------+-----------------------------------+ | | userInteractionSessionID | +--------------------------+-----------------------------------+ | | assignmentID | +--------------------------+-----------------------------------+ | EventType | response = P_UI_MESSAGE_STORED | | | | | smsSubmitted | | +--------------------------+-----------------------------------+ | EventSpecificInfo | | +--------------------------+-----------------------------------+ | MISC SMS Info | | +--------------------------+-----------------------------------+ | | info | +--------------------------+-----------------------------------+
Table 4-43
* * *
From: initialDPSMS To: _sendInfoAndCollectRes_ userInteractionSessionID
assignmentID response CallingPartyNumber  
DestinationSubscriberNumber  
ServiceKey  
EventType  
IMSI  
LocationInfo in MSC ( C )  
LocationInfor in SGSN ( C )  
Time&Timezone  
TP-ShortMessageSubmissionSpecificInfo info TP-ProtocolIdentifier  
TP-DataCodingScheme  
TP-ValidityPeriod ( C )  
SMSC Address  
NOTE: C = Conditional, supplied if available.
* * *
### 4.1.15 sendInfoAndCollectErr
**_sendInfoAndCollectErr_** is an asynchronous method that indicates that the
request to send information and collect a response was unsuccessful.
Figure 4-20: Call Flow for sendInfoAndCollectErr (scenario 1)
Figure 4-21: Call Flow for sendInfoAndCollectErr (scenario 2)
Figure 4-22: Call Flow for sendInfoAndCollectErr (scenario 3)
Three Alternatives have been identified:
1\. MT SMS based interaction between the SMS-GMSC and MS (see table 4-44).
2\. MO SMS, notification from gsmSSF to gsmSCF of an event previously
requested by a RequestReportSMSEvent (see table 4-45).
3\. MO SMS, dialogue error returned from gsmSSF to gsmSCF in response to prior
message attempt required in relation to a _**sendInfoAndCollectReq** (see
table 4-46)._
Table 4-44: Normal Operation
* * *
Pre-conditions The application has previously invoked the
_sendInfoAndCollectReq_ method 1 As part of the MT SMS delivery dialogue the
SMS-GMSC is returned an error from either the HLR originated
**sendRoutingInfoForSMConf** , or MSC originated **MTForwardSMConf** 2 The
SMS-GMSC sends an equivalent internal message to the SCS 3 The SCS identifies
the correct application and invokes the **_sendInfoAndCollectErr_** method
* * *
Table 4-45
* * *
Pre-conditions The application has previously invoked the
_sendInfoAndCollectReq_ method (see note) 1 The gsmSCF has previously
requested the gsmSSF to monitor for a particular SMS related event (e.g.
SMS_Submitted, SMS_Failure) using the CAP **_RequestReportSMSEvent_** method 2
The gsmSSF detects the SMS event and forwards the CAP **_EventReportSMS_**
message to the gsmSCF 3 The gsmSCF sends an equivalent internal message to the
SCS 4 The SCS identified the correct application that previously requested
notification of the event, and invokes the **_sendInfoAndCollectErr_** method
NOTE: **responseRequested** shall be required in order to request notification
of the subsequent event.
* * *
Table 4-46
* * *
Pre-conditions The application has previously invoked the
_sendInfoAndCollectReq_ method (see note) 1 As a result of the contents of the
**_sendInfoAndCollectReq_** , the gsmSCF has sent one of the following
messages to the gsmSSF, RequestReportSMSEvent, FurnishChargingInfoSMS,
ConnectSMS 2 If any individual message fails, a TCAP dialogue error shall be
returned from gsmSSF to gsmSCF 3 The gsmSCF sends an equivalent internal
message to the SCS 4 The SCS identified the correct application that
previously requested notification of the event, and invokes the
**_sendInfoAndCollectErr_** method 5 Depending on the message in error, the
application may be required to release the SMS processing using the
**_release_** method NOTE: **responseRequested** may or may not be required.
* * *
Table 4-47: Parameter Mapping (Scenario 1)
* * *
From: MAP SendRoutingInfoForSM To: sendInfoAndCollectErr
userInteractionSessionID InvokeID assignmentID UserError error
* * *
Table 4-48
* * *
From: MAP MTForwardSM To: sendInfoAndCollectErr userInteractionSessionID
InvokeID assignmentID UserError error
* * *
Table 4-49: Scenario 2
+--------------------------+---------------------------+ | From: CAP EventReportSMS | To: sendInfoAndCollectErr | +--------------------------+---------------------------+ | | userInteractionSessionID | +--------------------------+---------------------------+ | | assignmentID | +--------------------------+---------------------------+ | EventType | | | | | | smsFailure | | +--------------------------+---------------------------+ | EventSpecificInfo | error | | | | | FailureSpecificInfo | | +--------------------------+---------------------------+ | MISC SMS Info | | +--------------------------+---------------------------+
Table 4-50: Scenario 3
* * *
From: TCAP Return Error To: _sendInfoAndCollectErr_ userInteractionSessionID
assignmentID error error
* * *
### 4.1.16 release
**_release_** is a method that requests that the relationship between the
application and the user interaction object be released. It causes the release
of the used user interaction resources and interrupts any ongoing user
interaction.
Figure 4-23: Call Flow for release
Table 4-51: Normal Operation
Interaction between gsmSSf and gsmSCF as a result of receiving InitialDPSMS.
* * *
Pre-conditions The gsmSSF has previously delivered a InitialDPSMS to the
gsmSCF 1 The application invokes a release 2 The SCS sends an equivalent
internal message to the gsmSCF 3 The gsmSCF sends a CAP **_releaseSMS_** to
the gsmSSF
* * *
Table 4-52: Parameter Mapping
* * *
From: release To: CAP releaseSMS userInteractionSessionID  
Cause
* * *
### 4.1.17 abortActionReq
**_abortActionReq_** is an asynchronous method that aborts a user interaction
operation. This is a method that does not map to SMS.
### 4.1.18 abortActionRes
**_abortActionRes_** is an asynchronous method that confirms that the request
to abort a user interaction operation on a call was successful. This is a
method that does not map to SMS.
### 4.1.19 abortActionErr
**_abortActionErr_** is an asynchronous method that indicates that the request
to abort a user interaction on a call resulted in an error. This is a method
that does not map to SMS.
#