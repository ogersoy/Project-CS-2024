# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
**Structure of the OSA API Mapping (3GPP TR 29.998)**
The present document is part 8 of a multi-part deliverable covering the Open
Service Access (OSA); Application Programming Interface (API) Mapping for OSA.
Table: Overview of the OSA APIs & Protocol Mappings 29.198 & 29.998-family
+-------+-------+-------+-------+-------+-------+-------+-------+ | OSA | OSA | | | | | | | | API | API | | | | | | | | spec | Ma | | | | | | | | ifica | pping | | | | | | | | tions | - | | | | | | | | 29. | 29. | | | | | | | | 198-f | 998-f | | | | | | | | amily | amily | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ove | 29.9 | Ove | | | | | | 98-01 | rview | 98-01 | rview | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | C | * | _Not | | | | | | 98-02 | ommon | 29.99 | A | | | | | | | Data | 8-02_ | pplic | | | | | | | D | | able _| | | | | | | efini | | | | | | | | | tions | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Fram | * |_ Not | | | | | | 98-03 | ework | 29.99 | A | | | | | | | | 8-03 _| pplic | | | | | | | | | able_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * | 2 | 2 | 2 | 2 | **2 | 2 | Ge | | *Call | 9.198 | 9.198 | 9.198 | 9.198 | 9.198 | 9.998 | neric | | Co | -04-1 | -04-2 | -04-3 | -04-4 | -04-5 | -04-1 | Call | | ntrol | | | | M | Conf. | | Co | | (CC) | C | Ge | M | ulti- | CC | | ntrol | | SCF** | ommon | neric | ulti- | media | SCF**| | -- | | | CC | CC | Party | CC | | | CAP | | | data | SCF | CC | SCF | | | ma | | | d | | SCF | | | | pping | | | efini | | | | | | | | | tions | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | |_29 |_ Ge | | | | | | | | .998- | neric | | | | | | | | 04-2 _| Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | INAP | | | | | | | | | map | | | | | | | | | ping_ | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | | _29 |_ Ge | | | | | | | | .998- | neric | | | | | | | | 04-3 _| Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | M | | | | | | | | | egaco | | | | | | | | | map | | | | | | | | | ping_ | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | | 2 | Multi | | | | | | | | 9.998 | party | | | | | | | | -04-4 | Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | ISC | | | | | | | | | ma | | | | | | | | | pping | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | User | 2 | User | | | | | | 98-05 | I | 9.998 | I | | | | | | | ntera | -05-1 | ntera | | | | | | | ction | | ction | | | | | | | SCF | | -- | | | | | | | | | CAP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | _29 |_ User | | | | | | | | .998- | I | | | | | | | | 05-2 _| ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | INAP | | | | | | | | | map | | | | | | | | | ping_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | _29 |_ User | | | | | | | | .998- | I | | | | | | | | 05-3 _| ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | M | | | | | | | | | egaco | | | | | | | | | map | | | | | | | | | ping_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | 2 | User | | | | | | | | 9.998 | I | | | | | | | | -05-4 | ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | SMS | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Mob | 2 | User | | | | | | 98-06 | ility | 9.998 | S | | | | | | | SCF | -06-1 | tatus | | | | | | | | | and | | | | | | | | | User | | | | | | | | | Loc | | | | | | | | | ation | | | | | | | | | -- | | | | | | | | | MAP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | 2 | User | | | | | | | | 9.998 | S | | | | | | | | -06-2 | tatus | | | | | | | | | and | | | | | | | | | User | | | | | | | | | Loc | | | | | | | | | ation | | | | | | | | | -- | | | | | | | | | SIP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ter | * | _Not | | | | | | 98-07 | minal | 29.99 | A | | | | | | | Ca | 8-07_ | pplic | | | | | | | pabil | | able* | | | | | | | ities | | | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Data | **2 | * | | | | | | 98-08 | Se | 9.998 | _Data | | | | | | | ssion | -08_ _| Se | | | | | | | Co | | ssion | | | | | | | ntrol | | Co | | | | | | | SCF | | ntrol | | | | | | | | | -- | | | | | | | | | CAP | | | | | | | | | mapp | | | | | | | | | ing_ _| | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * |_ Ge | * | _Not | | | | | | 29.19 | neric | 29.99 | A | | | | | | 8-09_ | Mess | 8-09 _| pplic | | | | | | | aging | | able_ | | | | | | | SCF _| | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * |_ Co | * | _Not | | | | | | 29.19 | nnect | 29.99 | A | | | | | | 8-10_ | ivity | 8-10 _| pplic | | | | | | | Ma | | able_ | | | | | | | nager | | | | | | | | | SCF _| | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ac | * |_ Not | | | | | | 98-11 | count | 29.99 | A | | | | | | | Manag | 8-11 _| pplic | | | | | | | ement | | able_ | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Cha | * | _Not | | | | | | 98-12 | rging | 29.99 | A | | | | | | | SCF | 8-12_ | pplic | | | | | | | | | able _| | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | P | * |_ Not | | | | | | 98-13 | olicy | 29.99 | A | | | | | | | Manag | 8-13 _| pplic | | | | | | | ement | | able_ | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Pre | * | _Not | | | | | | 98-14 | sence | 29.99 | A | | | | | | | & | 8-14_ | pplic | | | | | | | Av | | able _| | | | | | | ailab | | | | | | | | | ility | | | | | | | | | Manag | | | | | | | | | ement | | | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Multi | * |_ Not | | | | | | 98-15 | Media | 29.99 | A | | | | | | | Mess | 8-15 _| pplic | | | | | | | aging | | able_ | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Se | * | _Not | | | | | | 98-16 | rvice | 29.99 | A | | | | | | | B | 8-16_ | pplic | | | | | | | roker | | able* | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+
# 1 Scope
The present document investigates how the OSA Data Session Control Interface
Class methods defined in 3GPP TS 29.198-8 [5] can be mapped onto CAMEL
Application Part operations and Mobile Application Part operations.\ The
mapping of the OSA API to the CAP and relevant MAP operations is considered
informative, and not normative. An overview of the mapping TR is contained in
the introduction of the present document as well as in 3GPP TR 29.998-1 [10].
The OSA specifications define an architecture that enables application
developers to make use of network functionality through an open standardised
interface, i.e. the OSA APIs. The API specification is contained in the 3GPP
TS 29.198 series of specifications. An overview of these is available in the
introduction of the present document as well as in 3GPP TS 29.198-1 [1]. The
concepts and the functional architecture for the Open Service Access (OSA) are
described by 3GPP TS 23.198 [3]. The requirements for OSA are defined in 3GPP
TS 22.127 [2].
# 2 References
  * References are either specific (identified by date of publication > and/or edition number or version number) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 29.198-1: \"Open Service Access (OSA); Application Programming
Interface (API); Part 1: Overview\".
[2] 3GPP TS 22.127: \"Service Requirement for the Open Services Access (OSA);
Stage 1\".
[3] 3GPP TS 23.198: \"Open Service Access (OSA); Stage 2\".
[4] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[5] 3GPP TS 29.198-8: \"Open Service Access (OSA); Application Programming
Interface (API); Part 8: Data session control\".
[6] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[7] 3GPP TS 29.078: \"Customised Applications for Mobile network Enhanced
Logic (CAMEL); CAMEL Application Part (CAP) specification\".
[8] 3GPP TS 22.101: \"Service Aspects; Service Principles\".
[9] ITU-T Recommendation Q.850: \"Usage of cause and location in the Digital
Subscriber Signalling System No. 1 and the Signalling System No. 7 ISDN User
Part\".
[10] 3GPP TR 29.998-1: \"Open Service Access (OSA); Application Programming
Interface (API) Mapping for OSA; Part 1: General Issues on API Mapping\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TS 29.198-1 [1] apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TS
29.198-1 [1] apply.
# 4 Data Session Control Service CAMEL Call Flows
## 4.1 Data Session Manager
The session manager interface provides the management functions to the data
session service capability features.\ The application programmer can use this
interface to enable or disable data session-related event notifications.
In order to ensure that the mobility events are transparent to the Data
Session SCF, the same gsmSCF address shall be used in the GPRS-CSI for the
detection points: PDP Context Establishment, PDP Context Establishment
Acknowledge and Change of Position.
### 4.1.1 enableDataSessionNotification
**_enableDataSessionNotification_** is used to enable data session-related
notifications to be sent to the application.
Figure 4-1: Call Flow for enableDataSessionNotification
Table 4-1: Normal Operation
* * *
Pre-conditions An agreement is established between the network operator\ and
the service provider for the event notification to be enabled
1 The application invokes the **_enableDataSessionNotification_** method
2 The gsmSCF sends a MAP **_AnyTimeModification_** to the HLR in order to
activate the necessary CAMEL Subscription Information (GPRS-CSI) Note : CAMEL
phase 3 only allows for activation/deactivation of the CSI and not
modification of the contents of the CSIs
* * *
Table 4-2: Parameter Mapping
+-------------------------------------+-------------------------------------+ | From: enableDataSessionNotification | To: MAP AnyTimeModification | +-------------------------------------+-------------------------------------+ | appInterface | | +-------------------------------------+-------------------------------------+ | | | +-------------------------------------+-------------------------------------+ | eventCriteria | GPRS CAMEL Subscription Information | | | | | OriginatingAddress | GPRS-CSI | | | | | | gsmSCF Address | +-------------------------------------+-------------------------------------+ | assignmentID | | +-------------------------------------+-------------------------------------+
### 4.1.2 disableDataSessionNotification
**_disableDataSessionNotification_** is used by the application to disable
data session notifications.
Figure 4-2: Call Flow for disableDataSessionNotification
Table 4-3: Normal Operation
* * *
Pre-conditions An agreement is established between the network operator\ and
the service provider for the event notification to be disabled
1 The application invokes the **_disableDataSessionNotification_** method
2 The gsmSCF sends a MAP **_AnyTimeModification_** to the HLR in order to de-
activate the necessary CAMEL Subscription Information. Note that CAMEL Phase 3
only allows the capability to activate/deactivate CSI and not to modify the
triggering information
* * *
Table 4-4: Parameter Mapping
+--------------------------------------+-------------------------------------+ | From: disableDataSessionNotification | To: MAP AnyTimeModification | +--------------------------------------+-------------------------------------+ | eventCriteria | GPRS CAMEL Subscription Information | | | | | OriginatingAddress | GPRS-CSI | | | | | | gsmSCF Address | +--------------------------------------+-------------------------------------+ | | | +--------------------------------------+-------------------------------------+ | assignmentID | | +--------------------------------------+-------------------------------------+
### 4.1.3 dataSessionEventNotify
**_dataSessionEventNotify_** notifies the application of the arrival of a data
session-related event.
Figure 4-3: Call Flow for dataSessionEventNotify
Table 4-5: Normal Operation
* * *
Pre-conditions Call notifications have been enabled using the
_enableDataSessionNotification_ method\ on the Data Session Manager interface
1 A data session request arrives at the gsmSSF causing initial triggering to
the gsmSCF CAP **_InitialDPGPRS_**
2 The gsmSCF recognizes the need for an API service and passes the triggering
information to the SCS
3 The SCS identifies the application responsible for handling the data session
and invokes the **_dataSessionEventNotify_** method
* * *
Table 4-6: Parameter Mapping
+-------------------------+-----------------------------+ | From: CAP InitialDPGPRS | To: dataSessionlEventNotify | +-------------------------+-----------------------------+ | serviceKey | | +-------------------------+-----------------------------+ | gPRSEventType | | +-------------------------+-----------------------------+ | mSISDN | eventInfo | | | | | accessPointName | OriginatingAddress | | | | | | DestinationAddress | +-------------------------+-----------------------------+ | iMSI | | +-------------------------+-----------------------------+ | timeAndTimeZone | | +-------------------------+-----------------------------+ | gPRSMSClass | | +-------------------------+-----------------------------+ | pDPType | | +-------------------------+-----------------------------+ | qualityOfService | | +-------------------------+-----------------------------+ | routeingAreaIdentity | | +-------------------------+-----------------------------+ | chargeID | | +-------------------------+-----------------------------+ | sGSNCapabilities | | +-------------------------+-----------------------------+ | | assignmentID | +-------------------------+-----------------------------+ | | appInterface | +-------------------------+-----------------------------+
### 4.1.4 dataSessionAborted
**_dataSessionAborted_** indicates to the application that the Data Session
object has aborted or terminated abnormally. No further communication will be
possible between the Data Session object and the application.
Figure 4-4: Call Flow for dataSessionAborted
Table 4-7: Normal Operation
* * *
Pre-conditions  
1 The SCS detect a catastrophic failure in its communication with the gsmSCF 2
The SCS, invokes the **_dataSessionAborted_** method. The data session running
in the network may continue and will not have been affected by this failure
betweeen the gsmSCF and the SCS
* * *
**Parameter Mapping**
None.
### 4.1.5 dataSessionNotificationInterrupted
**_dataSessionlNotificationInterrupted_** indicates to the application that
event notifications will no longer be sent (for example, due to faults
detected).
Figure 4-5: Call Flow for dataSessionNotificationInterruptedNormal Operation
Table 4-8
* * *
Pre-conditions Data session notifications have been enabled using the
_enableNotification_ method\ on the Data Session Manager interface
1 The SCS has detected, or has been informed of, a fault which prevents
further events from being notified
2 The SCS invokes the **_dataSessionNotificationInterrupted_** method
* * *
**Parameter Mapping**
None.
### 4.1.6 dataSessionNotificationContinued
**_dataSessionNotificationContinued_** indicates to the application that all
event notifications will be sent again.
Figure 4-6: Call Flow for dataSessionNotificationContinued
Table 4-9: Normal Operation
* * *
Pre-conditions Data session notifications have been interrupted and
_dataSessionNotificationInterrupted_ method has been invoked 1 The SCS detects
that data session notifications are again possible 2 The SCS invokes the
**_dataSessionNotificationContinued_** method
* * *
**Parameter Mapping**
None.
## 4.2 Data Session
The Data Session interface provides basic methods for applications to control
data sessions.
### 4.2.1 ConnectReq
**_connectReq_** requests the connection of a data session with the
destination party (specified in the parameter TargetAddress). The Data Session
object is not automatically deleted if the destination party disconnects from
the data session. The mapping to **_continueGPRS_** is also possible.
Figure 4-7: Call Flow for connectReq
Table 4-10: Normal Operation
* * *
Pre-conditions The application has been notified of a new data session\ and
the data session object exists
1 The application invokes the **_connectReq_** method
2 The SCS sends an equivalent internal message to the gsmSCF
3 The gsmSCF sends a CAP **_requestReportGPRSEvent_** if the application needs
to be informed about the outcome of the request
4 The gsmSCF sends a CAP **_connectGPRS_** message
* * *
Table 4-11: Parameter Mapping
* * *
From: connectReq To: CAP requestReportGPRSEvent gPRS-ReferenceNumber
dataSessionID  
responseRequested gPRSEvent targetAddress  
pDPID assignmentID
* * *
Table 4-12
* * *
From: connectReq To: CAP connectGPRS dataSessionID  
responseRequested  
targetAddress accessPointName pdpID assignmentID
* * *
### 4.2.2 connectRes
**_connectRes_** indicates that the request to connect a data session with the
destination party was successful, and indicates the response of the
destination party (e.g. connected, disconnected).
Figure 4-8: Call Flow for connectRes
Table 4-13: Normal Operation
* * *
Pre-conditions Data session routing attempted 1 If event reports have been
requested, the gprsSSF sends a CAP **_eventReportGPRS_** to the gsmSCF 2 The
gsmSCF sends an equivalent message to the SCS 3 The SCS invokes the
**_connectRes_** method
* * *
Table 4-14: Parameter Mapping
+----------------------------------+-------------------+ | From: CAP eventReportGPRS | To: connectRes | +----------------------------------+-------------------+ | | **dataSessionID** | +----------------------------------+-------------------+ | **gPRS-ReferenceNumber** | | +----------------------------------+-------------------+ | **gPRSEventType** | **eventReport** | | | | | **miscGPRSInfo** | | | | | | **gPRSEventSpecificInformation** | | +----------------------------------+-------------------+ | **pDPID** | | +----------------------------------+-------------------+
### 4.2.3 connectErr
**_connectErr_** indicates that the request to connect a data session with the
destination party was unsuccessful, e.g. an error detected in the network or
the data session was abandoned.
Figure 4-9: Call Flow for connectErr
Two scenarios are possible:
1\. The gsmSCF receives a message from the gprsSSF indicating an error (see
table 4-15).
2\. The gsmSCF detects there is an error in the message from the SCS (see
table 4-16).
Table 4-15: Normal Operation
* * *
Pre-conditions Data session routing attempted 1 The gprsSSF detects a call
routing failure and sends an appropriate TCAP message returning an error to
the gsmSCF 2 The gsmSCF sends an equivalent message to the SCS 3 The SCS
detects an error with the **_connectReq_** method, or receives a TCAP Return
Error, and invokes the **_connectErr_** method
* * *
Table 4-16
* * *
Pre-conditions Data session routing attempted 1 The gsmSCF detects an error in
the parameters of the internal message from the SCS requesting a
**_connectReq_** 2 The gsmSCF sends an equivalent message to the SCS 3 The SCS
invokes the **_connectErr_** method
* * *
Table 4-17: Parameter Mapping
+-------------------------+-------------------------------+ | From: TCAP Return Error | To: routeCallToDestinationErr | +-------------------------+-------------------------------+ | | dataSessionID | +-------------------------+-------------------------------+ | TC-U-ERROR | errorIndication | | | | | TC-U-REJECT | | +-------------------------+-------------------------------+
### 4.2.4 release
**_release_** requests the release of the data session.
Figure 4-10: Call Flow for release
Table 4-18: Normal Operation
* * *
Pre-conditions Data session is in progress 1 The application invokes the
**_release_** method 2 The SCS sends an equivalent message to the gsmSCF 3 The
gsmSCF invokes the CAP **_ReleaseGPRS_** operation
* * *
Table 4-19: Parameter Mapping
* * *
From: release To: CAP ReleaseGPRS dataSessionID  
gPRS-ReferenceNumber cause gPRSCause pDPID
* * *
### 4.2.5 superviseDataSessionReq
**_superviseDataSessionReq_** is called by the application to supervise a data
session. The application can set a granted data volume for this data session.
If an application calls this function before it calls a connectReq() or a user
interaction function the time measurement will start as soon as the data
session is connected. The Data Session object will exist after the data
session has been terminated if information is required to be sent to the
application at the end of the data session.
Figure 4-11: Call Flow for superviseDataSessionReq
Table 4-20: Normal Operation
* * *
Pre-conditions  
1 The application invokes the **_superviseDataSessionReq_** method 2 The SCS
sends an equivalent internal message to the gsmSCF 3 The gsmSCF sends a CAP
ApplyChargingGPRS message to the gprsSSF
* * *
Table 4-21: Parameter Mapping
+-------------------------------+---------------------------+ | From: superviseDataSessionReq | To: CAP ApplyChargingGPRS | +-------------------------------+---------------------------+ | dataSessionID | | +-------------------------------+---------------------------+ | | gPRS-ReferenceNumber | +-------------------------------+---------------------------+ | treatment | | +-------------------------------+---------------------------+ | bytes | chargingCharacteristics | | | | | | maxTransferedVolume | +-------------------------------+---------------------------+ | | pDPID | +-------------------------------+---------------------------+
### 4.2.6 superviseDataSessionRes
**_superviseDataSessionRes_** is an asynchronous method that reports a data
session supervision event to the application.
Figure 4-12: Call Flow for superviseDataSessionRes
Table 4-22: Normal Operation
* * *
Pre-conditions The application has invoked the _superviseDataSessionReq_
method 1 The gsmSCF receives an CAP **_ApplyChargingReportGPRS_** from the
gprsSSF 2 The gsmSCF sends an equivalent internal message to the SCS 3 The SCS
identifies the correct application and invokes the
**_superviseDataSessionRes_** method
* * *
Table 4-23: Parameter Mapping
+-----------------------------------+-----------------------------+ | From: CAP ApplyChargingReportGPRS | To: superviseDataSessionRes | +-----------------------------------+-----------------------------+ | | dataSessionID | +-----------------------------------+-----------------------------+ | gPRSReferenceNumber | | +-----------------------------------+-----------------------------+ | | report | +-----------------------------------+-----------------------------+ | chargingResult | usedVolume | | | | | transferedVolume | | +-----------------------------------+-----------------------------+ | qualityOfService | | +-----------------------------------+-----------------------------+ | pDPID | | +-----------------------------------+-----------------------------+ | active | | +-----------------------------------+-----------------------------+
### 4.2.7 superviseDataSessionErr
**_superviseDataSessionErr_** is an asynchronous method that reports a data
session supervision error to the application.
Figure 4-13: Call Flow for superviseDataSessionErr
Table 4-24: Normal Operation
* * *
Pre-conditions The application has requested information associated\ with a
call via the _superviseDataSessionReq_ method
1 A data session terminates abnormally and the gprsSSF sends an error in a
TCAP message to the gsmSCF , or aborts the TCAP dialogue
2 The gsmSCF sends an equivalent message to the SCS
3 The SCS identifies the correct applications that requested the data session
information and invokes the **_superviseDataSessionErr_** method
* * *
Table 4-25: Parameter Mapping
+-------------------------+----------------------+ | From: TCAP Return Error | To: superviseCallErr | +-------------------------+----------------------+ | | dataSessionID | +-------------------------+----------------------+ | TC Primitives | error | | | | | TC-U-ABORT | | | | | | TC-P-ABORT | | | | | | TC-NOTICE | | | | | | TC-U-ERROR | | | | | | TC-L-CANCEL | | | | | | TC-U-CANCEL | | | | | | TC-L-REJECT | | | | | | TC-R-REJECT | | | | | | TC-U-REJECT | | +-------------------------+----------------------+
### 4.2.8 dataSessionFaultDetected
**_dataSessionFaultDetected_** indicates to the application that a fault in
the network has been detected which can\'t be communicated by a network event,
e.g. when the user aborts before any establishment method is called by the
application.
The system purges the Data Session object. Therefore, the application has no
further control of data session processing. No report will be forwarded to the
application.
Figure 4-14: Call Flow for dataSessionFaultDetected
Table 4-26: Normal Operation
* * *
Pre-conditions A data session exists and the SCS detects an error.\ No
_connectReq_ method has been invoked yet.
1 The gprsSSF may detect a fault and sends an appropriate dialogue error
message to the gsmSCF
2 The gsmSCF may detect a fault an send an error message to the SCS
3 The SCS detects a fault and invokes the **_dataSessionFaultDetected_**
method
4 The SCS sends an equivalent message to the gsmSCF if appropriate
5 The gsmSCF sends a CAP **_ReleaseGPRS_** if appropriate
* * *
Table 4-27: Parameter Mapping
* * *
From:Dialogue Error To: dataSessionFaultDetected dataSessionID TC_U_ABORT
fault
* * *
### 4.2.9 setAdviceOfCharge
**_setAdviceOfCharge_** is a method that allows the application to determine
the charging information that will be send to the end-users terminal.
Figure 4-15: Call Flow for setAdviceOfCharge
Table 4-28: Normal Operation
* * *
Pre-conditions  
1 The application invokes the **_setAdviceOfCharge_** method 2 The SCS sends
an equivalent internal message to the gsmSCF 3 The gsmSCF sends a CAP
**_SendChargingInformationGPRS_** message to the gprsSSF
* * *
Table 4-29: Parameter Mapping
+-------------------------+--------------------------------------+ | From: setAdviceOfCharge | To: CAP SendChargingInformationGPRS | +-------------------------+--------------------------------------+ | sessionID | | +-------------------------+--------------------------------------+ | aOCInfo: | SCIGPRSBillingChargingCharateristics | | | | | - CurrentCAI | aOCGPRS | | | | | | aOCInitial | +-------------------------+--------------------------------------+ | - NextCAI | SCIGPRSBillingChargingCharateristics | | | | | | aOCGPRS | | | | | | aOCSubsequent | | | | | | cAI-GSM0224 | +-------------------------+--------------------------------------+ | tariffSwitch | SCIGPRSBillingChargingCharateristics | | | | | | aOCGPRS | | | | | | aOCSubsequent | | | | | | tariffSwitchInterval | +-------------------------+--------------------------------------+ | | SCIGPRSBillingChargingCharateristics | | | | | | aOCGPRS | | | | | | pDPID | +-------------------------+--------------------------------------+
### 4.2.10 setDataSessionChargePlan
**_setDataSessionChargePlan_** is a method that allows the application to
include charging information for data sessions in network generated CDR.
Figure 4-16: Call Flow for setDataSessionChargePlan
Table 4-30: Normal Operation
* * *
Pre-conditions  
1 The application invokes the **_setDataSessionChargePlan_** 2 The SCS sends
an equivalent internal message to the gsmSCF 3 The gsmSCF sends a CAP
**_FurnishChargingInformationGPRS_** message to the gprsSSF
* * *
Table 4-31: Parameter Mapping
+--------------------------+----------------------------------------+ | From: setDataSessionPlan | To: CAP FurnishChargingInformationGPRS | +--------------------------+----------------------------------------+ | dataSessionID | | +--------------------------+----------------------------------------+ | dataSessionChargePlan | FCIGPRSBillingChargingCharacteritics | | | | | | fCIBCCCAMELsequence1 | | | | | | freeFormatData | +--------------------------+----------------------------------------+ | | FCIGPRSBillingChargingCharacteritics | | | | | | fCIBCCCAMELsequence1 | | | | | | appendFreeFormatData | +--------------------------+----------------------------------------+ | | FCIGPRSBillingChargingCharacteritics | | | | | | fCIBCCCAMELsequence1 | | | | | | pDPID | +--------------------------+----------------------------------------+
#