# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides a feasibility study for the interworking of
multimedia calls between the IP Multimedia CN Subsystem and CS networks (i.e.
PSTN, ISDN and GSM/UMTS CS networks).
The present document study and outlines different solutions and functionality
required within the MGW to deliver the user plane aspects between IM CN
subsystems and CS networks for support of basic multimedia calls. It also
outlines the solutions and functionality required within the MGCF and SGW to
deliver the control plane aspects between IM CN subsystems and CS networks to
support basic multimedia calls.
The document also studies the MONA interworking impacts, and which parts of
MONA are feasible, or even possible, to interwork.
The user plane interworking necessary to cover the basic multimedia calls is
also outlined and studied.
The different aspects studied for the different scenarios should encompass the
transport protocol, transcoding and signalling issues for negotiation and
mapping of bearer capabilities and QoS information.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 29.163: \"Interworking between the IP Multimedia (IM) Core Network
(CN) subsystem and Circuit Switched (CS) networks\".
[3] 3GPP TS 26.110: \"Codec for circuit switched multimedia telephony service;
General description\"
[4] 3GPP TS 26.111: \"Codec for Circuit switched Multimedia Telephony Service;
Modifications to H.324\".
[5] 3GPP TS 26.235: \"Packet switched conversational multimedia applications;
Default codecs\".
[6] 3GPP TS 26.236: \"Packet switched conversational multimedia applications;
Transport protocols\".
[7] 3GPP TS 26.071: \"AMR Speech Codec; General description\".
[8] 3GPP TS 26.171: \"AMR speech codec, wideband; General description\".
[9] 3GPP TS 23.205: \"Bearer-independent circuit-switched core network; Stage
2\".
[10] 3GPP TS 23.172: \"Technical realization of Circuit Switched (CS)
multimedia service; UDI/RDI fallback and service modification; Stage 2\".
[11] 3GPP TR 23.903: \"Redial solution for voice-video switching\".
[12] ITU-T Recommendation H.324: \"Terminal for low bitrate multimedia
communication\".
[13] ITU-T Recommendation H.223: \"Multiplexing protocol for low bitrate
multimedia communication\", including annexes A to D.
[14] ITU-T Recommendation H.245: \"Control protocol for multimedia
communication\".
[15] ITU-T Recommendation H.261: \"Video codec for audiovisual services at p x
64 kbit/s\".
[16] ITU-T Recommendation H.263: \"Video coding for low bitrate
communication\".
[17] ITU-T Recommendation H.264 (2003): \"Advanced video coding for generic
audiovisual services\" \| ISO/IEC 14496-10:2003: \"Information technology -
Coding of audio-visual objects - Part 10: Advanced Video Coding\".
[18] ITU-T Recommendation G.723.1: \"Dual rate speech coder for multimedia
communications transmitting at 5.3 & 6.3 kbit/s\".
[19] IETF RFC 3261: \"SIP: Session Initiation Protocol\".
[20] IETF RFC 2327: \"SDP: Session Description Protocol\".
[21] IETF RFC 3550 (July 2003): \"RTP: A Transport Protocol for Real-Time
Applications\".
[22] IETF RFC 2429: \"RTP Payload Format for the 1998 Version of ITU-T Rec.
H.263 Video (H.263+)\".
[23] IETF RFC 3016: \"RTP Payload Format for MPEG-4 Audio/Visual Streams\".
[24] IETF RFC 3267: \"**Real-Time Transport Protocol (RTP) Payload Format and
File Storage Format for the Adaptive Multi-Rate (AMR) and Adaptive Multi-Rate
Wideband (AMR-WB) Audio Codecs** \".
[25] IETF RFC 3984: \"RTP Payload Format for H.264 Video\".
[26] ISO/IEC 14496-2 (1999): \"Information technology - Coding of audio-visual
objects - Part 2: Visual\".
[27] IETF RFC 2833: \"RTP Payload for DTMF Digits, Telephony Tones and
Telephony Signals\".
[28] 3GPP TS 29.332: \"Media Gateway Control Function (MGCF) - IM Media
Gateway (IM-MGW); Mn interface\".
[29] ITU-T Recommendation H.248.1: \"Gateway control protocol: Version 3\".
[30] ITU-T Recommendation H.248.12: \"Gateway control protocol: H.248.1
packages for H.323 and H.324 interworking\".
[31] ITU-T Recommendation H.248.20: \"Gateway control protocol: The use of
local and remote descriptors with H.221 and H.223 multiplexing\".
> [32] ITU-T Recommendation H.324 Amendment 1: \"New Annex K \"Media Oriented
> Negotiation Acceleration Procedure\" and associated changes to Annex\".
>
> [33] Void.
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply:
**Interworking Node:** combination of MGCF and IM-MGW
NOTE: The term Interworking Node is used where the worksplit between MGCF and
IM-MGW is left open.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ACP Accelerated H.245 Procedures
BICC Bearer Independent Call Control
CS Circuit Switched
ISUP ISDN User Part
MGCF Media Gateway Control Function
MGW Media GateWay
MONA Media Oriented Negotiation Acceleration
MPC Media Preconfigured Channel
SGW Signalling GateWay
SPC Signalling Preconfigured Channel
# 4 Basic Multimedia calls inter-working between the IMS and CS Networks
scenarios
The Interworking between Circuit switched multimedia telephony service, as
described in 3GPP TS 26.110 [3] and 3GPP TS 26.111 [4], and packet switched
multimedia services, as described in 3GPP TS 26.235 [5] and 3GPP TS 26.236 [6]
is being investigated.
NOTE: The Interworking of other Codecs than listed in this Clause is not
precluded by the Interworking procedures within this specification.
## 4.1 Overview of Relevant CS-Domain Protocols
For a full description, see 3GPP TS 26.110 [3] and 3GPP TS 26.111 [4].
> Call Control: BICC or ISUP. (see 3GPP TS 23.205 [9])\ In addition,
> **\"SCUDIF\"** (see 3GPP TS 23.172 [10])**or \"Redial\"** (see 3GPP TR
> 23.903 [11]) **may be used**
**Multimedia** Protocol **suite: H.324M** (H.324 annex C [12]):
> Codec-Negotiation: H.245 [14] and/or MONA (H.324 Annex K [32]) in‑band
> negotiation
>
> Video-Codec: H.263 [16] mandatory\ _H.261 [15] optional\ MP4V-ES (simple
> video profile level 0) [26] optional_
>
> Speech-Codec: NB-AMR [7] mandatory\ _WB-AMR [8] optional\ G.723.1 [18]
> recommended_
>
> Transport: Multiplexing of Speech, Video, H.245 Signalling and MONA [32]
> within H.223 [13]
{width="6.533333333333333in" height="4.6618055555555555in"}
Figure 4.1.1 Overview of relevant CS-Domain Protocols (from 3GPP TS 26.110
[3])
## 4.2 Overview of Relevant PS-Domain Protocols
For a full description, see 3GPP TS 26.235 [5] and 3GPP TS 26.236 [6]
> Call Control: SIP (RFC 3261 [19]) and SDP (RFC 2327 [20]), out-of-band
> Codec-Negotiation.
>
> Video-Codec: H.263 [16] mandatory\ H.264 [17] optional,\ MP4V-ES (simple
> video profile level 0) optional [26]
>
> Speech-Codec: NB-AMR [7] and WB-AMR [8] mandatory if corresponding sampling
> rates are supported.
>
> Telephony Event media type recommended for DTMF
>
> Transport: RTP (RFC 3550 [21]) streams for speech and video ,
>
> RTP \"Payload\" Formats:\ Speech: Nb-AMR + WB-AMR: IETF RFC 3267 [24]
>
> Telephony Event: RFC 2833 [27]\ Video: H.263: RFC 2429 [22]\ H.264 (AVC):
> RFC 3984 [25]\ MPEG-4: RFC 3016 [23]
NOTE: For a fixed network access to IMS, 3GPP TS 26.235 [5] and 3GPP TS 26.236
[6] are not applicable and other codecs may be encountered.
# 5 Control plane inter-working
Editor\'s Note: Here the scenarios that have been identified as key (can be
all) are studied in detail.
## 5.1 General
In addition to the control plane Interworking between SIP and ISUP or BICC,
interactions between the H.245 signalling or MONA procedures at the CS side
and SIP/SDP signalling are described. How H.245 and MONA related information
(e.g. H.245 messages or extracted information) is communicated between the
MGCF and the IM-MGW is described in clause 7.
MONA procedures and theestablishment of the H.223 multiplexing protocol and
possible subsequent H.245 signalling procedures take place after the set-up
and both-way through-connection of the CS bearer.
## 5.2 Functionalities required in the MGCF for multimedia calls support
In addition to the control plane Inter‑working between SIP and ISUP or BICC,
the MGCF needs to mediate interactions between the H.245 signalling or MONA
procedures at the CS side and SIP/SDP signalling at the IMS side. The
interactions between H.245 signalling or MONA procedures and SIP/SDP
signalling should aim at selecting the same codec for the CS side and the PS
side.
## 5.3 IM CN subsystem originated session
### 5.3.1 Preconditions used at IMS side
#### 5.3.1.1 Interactions between H.245 or MONA and SIP/SDP
Figure 5.3.1.1.1 shows examples of interactions between H.245 or MONA and
SIP/SDP for IM CN subsystem originated session. Most SIP and ISUP or BICC
messages are intentionally omitted, since the SDP may be embedded in various
SIP messages and since the in‑band H.245 Messages are not tightly coupled with
out-of-band ISUP or BICC messages. Examples on how the depicted SDP and H.245
messages may be embedded in an SIP and BICC/ISUP Callflow are given in the
subsequent clauses.
Figure 5.3.1.1.1 assumes that the IMS peer uses the SIP precondition extension
to indicate that preconditions have not yet been met.
Figure 5.3.1.1.1: Interactions between H.245 and SIP/SDP for IM CN subsystem
originated session\ IMS peer indicates unmet local preconditions
Upon receipt of a SIP INVITE request containing speech and video Codecs
(signal 1 in figure 5.3.1.1.1) the Inter‑working Node (consisting of MGCF and
IM-MGW) starts the call set-up for multimedia call at the CS side by sending
an IAM requesting an UDI bearer (signal 2 in figure 5.3.1.1.1).
If SDP local preconditions, which are not yet met, are contained in signal 1,
the Inter‑working node should immediately send an SDP answer to allow for the
IMS-side bearer set-up to progress. The Inter‑working node selects codecs
supported by the IM-MGW and likely to be supported within the CS network and
communicates the selected codecs towards the IMS side within an SDP answer
message (signal 3 in figure 5.3.1.1.1). If theses codecs are contained in the
SDP offer, the Inter‑working Node should select the H.263 codec and may select
other codec from the SDP offer in addition.
The Interworking Node shall engage in an H.223 bearer setup. If the
interworking Node supports MONA (Media Oriented Negotiation Acceleration), it
shall first attempt a MONA Channel establishment method negotiation accoding
to Annex K of ITU-T Recommendation H.324 Annex K [32]. If the interworking
node does not support MONA, it shall use the multiplexing level negotiation
procedures of Annex C of H.324 [12]. If the Interworking Node supports MONA,
but the remote peer does not do so, a fallback to the multiplexing level
negotiation procedures of Annex C of H.324 [12] will occur.
If both the Interworking Node and the remote CS terminal support MONA
procedures, the MONA procedures as per ITU-T Recommendation H.324 Annex K [32]
may be used to replace the H.245 negotiation (signals 5 -- 7) as shown in
figure 5.3.1.1.1.
If MONA procedures are not used, the following applies:
\- After the completion of the H.223 bearer setup at the CS side, the
Inter‑working Node shall send a Terminal Capability Set message describing its
own capabilities (signal 5 in figure 5.3.1.1.1). Unless the Inter‑working Node
supports transcoding, the Inter‑working Node shall only send codecs that have
been offered at the IM CN subsystem side (as received in signal 1 in figure
5.3.1.1.1) within this message.
\- The Interworking Node will receive an H.245 Terminal Capability Set message
describing the supported Codecs at the peer\'s side (signal 6 in figure
5.3.1.1.1).
\- The codecs contained both in the sent and received terminal capability set
messages may be selected at the CS side. The final decision of the selected
codecs at the CS side is taken when the H.245 open logical Channels message
(signal 7 in figure 5.3.1.1.1) is sent or received. The direction of this
message is determined by the H.245 master-slave determination procedure.
If the Inter‑working Node does not transcode, it should indicate the codecs
selected within the H.245 negotiation (signal 8 in figure 5.3.1.1.1) or within
the MONA procedures and enable any media that have previously been put on hold
at the IMS side after the completion of the H.245 negotiation or MONA
procedures.
#### 5.3.1.2 Early media at the CS side through-connected
Not applicable. The early media support is not specified in 3G324M.
##### 5.3.1.2.1 Void
##### 5.3.1.2.2 Void
##### 5.3.1.2.2.1 Void {#void-2 .H6}
##### 5.3.1.2.2.2 Void {#void-3 .H6}
#### 5.3.1.3 Early media at the CS side not through-connected
##### 5.3.1.3.1 BICC with SCUDIF
Figure 5.3.1.3.1.1: Interactions between BICC and SIP/SDP for IM CN subsystem
originated session\ Unmet local SDP preconditions at the IMS side\ Forward
early media not through-connected at Cs side
Figure 5.3.1.3.1.1 shows examples of interactions between BICC and SIP/SDP for
IM CN subsystem originated session. It is assumed that SCUDIF is applied at
the BICC side and the SIP preconditions extension is used at the IMS side.
Furthermore, forward early media are not through-connected at the CS side,
allowing the H.245 negotiation or MONA procedures to progress only after the
CS side BICC or ISUP call establishment is completed.
The same example Callflow is depicted in figures 5.3.1.1.1 and 5.3.1.3.1.1.
\- Signal 3 of figure 5.3.1.1.1 maps to signal 6 of figure 5.3.1.3.1.1.
\- Signal 8 of figure 5.3.1.1.1 maps to signal 18 of figure 5.3.1.3.1.1.
\- Signal 5, 6 and 7 of figure 5.3.1.1.1 are included in box 17 of figure
5.3.1.3.1.1.
If SCUDIF Fallback occurs on the CS side, the APM message (signal 4 in Figure
5.3.1.3.1.1) contains a speech codec as \"Selected Codec\". The MGCF shall
then disable the video \"m-line\" in the first SDP answer in signal 6 in
figure 5.3.1.3.1.1 and complete the call-setup in the same way as for a normal
speech call.
##### 5.3.1.3.2 Non-SCUDIF case (ISUP or BICC without SCUDIF)
##### 5.3.1.3.2.1 Session establishment {#session-establishment .H6}
Figure 5.3.1.3.2.1.1 shows an example of interactions between ISUP or BICC
without SCUDIF and SIP/SDP for IM CN subsystem originated session. It is
assumed that preconditions extension is used at the IMS side. Furthermore,
backward and forward early media are not through-connected at the CS side,
allowing the H.245 negotiation or MONA procedures to progress only after the
CS side call establishment is completed.
Based on the video and audio media request in the incoming SIP INVITE message,
the inter‑working node generates an IAM message with a BCIE indicating UDI and
H.223 & H.245 towards the CS network. After the H.245 or MONA in‑band
negotiation is completed in the CS leg, the interworking node updates the
media in the IM CN leg, if required, to correspond to the H.245 negotiation
results and its own audio coding capabilities, using messages 17 and 18.
Figure 5.3.1.3.2.1.1 Interactions between ISUP or BICC without SCUDIF and\
SIP/SDP for IM CN subsystem originated session\ Unmet local SDP preconditions
at the IMS side\ Backward and Forward early media not through-connected at CS
side
##### 5.3.1.3.2.2 Fallback to speech at session establishment {#fallback-to-
speech-at-session-establishment .H6}
Fallback to speech is described in figure 5.3.1.3.2.2.1. Fallback to speech is
applied, if the called CS terminal or network rejects the video call setup.
When the MGCF receives a REL message as a response to the IAM message with a
video call request, the MGCF releases the CS video call being established, re-
establishes the CS call in a speech only mode sending a new IAM with a speech
BCIE to the CS network and updates the IM CN leg codecs to a audio only codec
(refer to messages 10 and 11, only m=AMR offered in the UPDATE message). Then
the call/session continues as in a speech only case.
If the inter‑working node does not support the fallback, it may release the
session.
Figure 5.3.1.3.2.2.1: Interactions between ISUP or BICC without SCUDIF and\
SIP/SDP for IM CN subsystem originated session\ Preconditions, early media not
through-connected\ Fallback to speech
### 5.3.2 Preconditions not used at IMS side
#### 5.3.2.1 Interactions between H.245 or MONA and SIP/SDP
Figure 5.3.2.1.1 shows examples of interactions between H.245 or MONA and
SIP/SDP for IM CN subsystem originated session. Most SIP and ISUP or BICC
messages are intentionally omitted, since the SDP may be embedded in various
SIP messages and since the in‑band H.245 Messages are not tightly coupled with
out-of-band ISUP or BICC messages. Examples on how the depicted SDP and H.245
messages may be embedded in an SIP and BICC/ISUP Callflow are given in the
subsequent clauses.
Figure 5.3.2.1.1 assumes that the IMS peer does not use the SIP precondition
extension.
Figure 5.3.2.1.1 Interactions between H.245 and SIP/SDP for IM CN subsystem
originated session\ IMS peer does not use SIP preconditions.
Upon receipt of a SIP INVITE request containing speech and video Codecs
(signal 1 in figure 5.3.2.1.1) the Interworking Node (consisting of MGCF and
IM-MGW) starts the call set-up for multimedia call at the CS side by sending
an IAM requesting an UDI bearer (signal 2 in figure 5.3.2.1.1).
If no unmet local SDP preconditions are contained in signal 1, the
Inter‑working node should defer sending an SDP answer until the H.245
negotiation is completed.
The Interworking Node shall engage in an H.223 bearer setup. If the
interworking Node supports MONA (Media Oriented Negotiation Acceleration), it
shall first attempt a MONA Channel establishment method negotiation accoding
to Annex K of ITU-T Recommendation H.324 Annex K [32]. If the interworking
node does not support MONA, it shall use the multiplexing level negotiation
procedures of Annex C of H.324 [12]. If the Interworking Node supports MONA,
but the remote peer does not do so, a fallback to the multiplexing level
negotiation procedures of Annex C of H.324 [12] will occur.
If both the Interworking Node and the remote CS terminal support MONA
procedures, the MONA procedures as per ITU-T Recommendation H.324 Annex K [32]
may be used to replace the H.245 negotiation (signals 4 -- 6) as shown in
figure 5.3.2.1.1.
If MONA procedures are not used, the following applies:
\- After the completion of the H.223 bearer setup at the CS side, the
Inter‑working Node shall send a Terminal Capability Set message describing its
own capabilities (signal 4 in figure 5.3.2.1.1). Unless the Inter‑working Node
supports transcoding, the Inter‑working Node shall only send codecs that have
been offered at the IM CN subsystem side (as received in signal 1 in figure
5.3.2.1.1) within this message.
\- The Inter‑working Node will receive a H.245 Terminal Capability Set message
describing the supported Codecs at the peer\'s side (signal 6 in figure
5.3.2.1.1).
\- The codecs contained both in the sent and received terminal capability set
message may be selected at the CS side. The final decision of the selected
codecs at the CS side is taken when the H.245 open logical Channels message
(signal 7 in figure 5.3.2.1.1) is sent or received. The direction of this
message is determined by the H.245 master-slave determination procedure.
If the Inter‑working Node does not transcode, it shall send an SDP answer
(signal 7 in figure 5.3.2.1.1) indicating the codecs selected within the H.245
negotiation or within the MONA procedures after the completion of the H.245
negotiation or MONA procedures.
#### 5.3.2.2 Early media at the CS side through-connected
Not applicable. The early media support is not specified in 3G324M.
##### 5.3.2.2.1 Void
##### 5.3.2.2.2 Void
##### 5.3.2.2.2.1 Void {#void-6 .H6}
##### 5.3.2.2.2.2 Void {#void-7 .H6}
#### 5.3.2.3 Early media at the CS side not through-connected
##### 5.3.2.3.1 BICC with SCUDIF
Figure 5.3.2.3.1.1: Interactions between BICC and SIP/SDP for IM CN subsystem
originated session\ No SDP preconditions at the IMS side\ Backward and Forward
early media not through-connected at CS side
Figure 5.3.2.3.1.1 shows an example of interactions between BICC and SIP/SDP
for IM CN subsystem originated session. It is assumed that no preconditions
extension is used at the IMS side. Furthermore, backward and forward early
media are not through-connected at the CS side, allowing the H.245 negotiation
or MONA procedures to progress only after the CS side BICC call establishment
is completed.
Based on the video and audio media request in the incoming SIP INVITE message,
the interworking node generates an IAM message with a supported codec list
indicating AMR and MuMe towards the CS network. The CS party accepts the video
call request and the CS network responds with an APM message with the selected
codec indicating MuMe. After the H.245 or MONA inband negotiation is completed
in the CS leg, the interworking node responds to the INVITE message with a 200
OK, message 10, including the codecs agreed on the H.245 or MONA negotiation.
##### 5.3.2.3.2 Non-SCUDIF case (ISUP or BICC without SCUDIF)
##### 5.3.2.3.2.1 Session establishment {#session-establishment-1 .H6}
Figure 5.3.2.3.2.1.1 shows an example of interactions between ISUP or BICC
without SCUDIF and SIP/SDP for IM CN subsystem originated session. It is
assumed that no preconditions extension is used at the IMS side. Furthermore,
backward and forward early media are not through-connected at the CS side,
allowing the H.245 negotiation or MONA procedure to progress only after the CS
side call establishment is completed.
Based on the video and audio media request in the incoming SIP INVITE message,
the inter‑working node generates an IAM message with a BCIE indicating UDI and
H.223 & H.245 towards the CS network. After the H.245 or MONA in‑band
negotiation is completed in the CS leg, the inter‑working node answers the SDP
to select the media in the IM CN leg to correspond to the H.245 or MONA
negotiation results and its own audio coding capabilities by sending the SIP
200 OK (INVITE), which the interworking node has deferred until then.
Figure 5.3.2.3.2.1.1 Interactions between ISUP or BICC without SCUDIF and\
SIP/SDP for IM CN subsystem originated session\ No SDP preconditions at the
IMS side\ Backward and Forward early media not through-connected at CS side
##### 5.3.2.3.2.2 Fallback to speech at session establishment {#fallback-to-
speech-at-session-establishment-1 .H6}
Fallback to speech is described in figure 5.3.2.3.2.2.1. Fallback to speech is
applied, if the called CS terminal or network rejects the video call setup.
When the MGCF receives a REL message as a response to the IAM message with a
video call request, the MGCF releases the CS video call being established, re-
establishes the CS call in a speech only mode sending a new IAM with a speech
BCIE to the CS network. The MGCF accepts only with the speech codec (m=AMR)
from the SDP offer in the INVITE when sending the 200 OK to INVITE, message
11. Then the call/session continues as in a speech only case.
If the inter‑working node does not support the fallback, it may release the
session.
Figure 5.3.2.3.2.2.1 Interactions between ISUP or BICC without SCUDIF and\
SIP/SDP for IM CN subsystem originated session\ No SDP preconditions, early
media not through-connected\ Fallback to speech
## 5.4 CS network originated session
### 5.4.1 Interactions between SIP/SDP and H.245 or MONA
#### 5.4.1.1 Normal Call setup
Figure 5.4.1.1 shows examples of interactions between H.245 or MONA and
SIP/SDP for the CS network originated session. Most SIP and ISUP or BICC
messages are intentionally omitted, since the SDP may be embedded in various
SIP messages and since the in‑band H.245 Messages are not tightly coupled with
out-of-band ISUP or BICC messages. Examples on how the depicted SDP and H.245
messages may be embedded in an SIP and BICC/ISUP Callflow are given in the
subsequent clause.
Figure 5.4.1.1: Interactions between H.245 and SIP/SDP for CS network
originated session
Upon receipt of a IAM request for a multimedia Call (signal 1 in figure
5.4.1.1) the Interworking Node (consisting of MGCF and IM-MGW) starts the call
set-up for multimedia call at the IM CN subsystem side by sending an INVITE
request (signal 2 in figure 5.4.1.1). For the INVITE request, the Interworking
Node selects codecs supported by the IM-MGW and likely to be supported within
the CS Network. The Interworking Node should select the H.263 codec and may
select other codec in addition.
Editor\'s Note: The SDP coding to express that either a combined voice and
video call, or a voice call, or a Clearmode codec, or some other data call is
desired is FFS.
The Interworking Node shall engage in an H.223 bearer setup. If the
interworking Node supports MONA (Media Oriented Negotiation Acceleration), it
shall first attempt a MONA Channel establishment method negotiation accoding
to Annex K of ITU-T Recommendation H.324 Annex K [32]. If the interworking
node does not support MONA, it shall use the multiplexing level negotiation
procedures of Annex C of H.324 [12]. If the Interworking Node supports MONA,
but the remote peer does not do so, a fallback to the multiplexing level
negotiation procedures of Annex C of H.324 [12] will occur.
If both the Interworking Node and the remote CS terminal support MONA
procedures, the MONA procedures as per ITU-T Recommendation H.324 Annex K [32]
may be used to replace the H.245 negotiation (signals 5 - 9) as shown in
figure 5.4.1.1. Furthermore, the SIP codec renegotiation in signals 10 and 11
is then also not applicable.
If MONA procedures are not used, the following applies:
\- After the completion of the H.223 bearer setup at the CS side the
Inter‑working Node will receive a H.245 Terminal Capability Set message
describing the supported Codecs at the peer\'s side (signal 5 in figure
5.4.1.1).
\- Due to information received in a Terminal Capability Set message (signal 5
in figure 5.4.1.1), the Inter‑working node may send an SDP offer at the IMS
side (signal 6 in figure 5.4.1.1), to offer additional codecs supported at the
CS side but not contained in the first SDP offer (signal 2 in figure 5.4.1.1),
or to restrict the selected codecs at the IMS side to codecs which are
available at the CS side.
Editor\'s Note: It is FFS if the addition of codecs not included in previous
SDP exchange has any impacts on IMS procedures, e.g. resource reservation
related procedures.
\- The Interworking Node shall send a Terminal Capability Set message
describing its own capabilities (signal 8 in figure 5.4.1.1). Unless the
Inter‑working Node supports transcoding, the Interworking node shall only send
codecs that are also negotiated at the IM CN subsystem side (as received in
signal 3 in figure 5.4.1.1) within this message. The Interworking Node may
defer sending the Terminal Capability Set message for some time to attempt to
receive the peer\'s Terminal Capability set message and perform a possible
IMS-side codec re-negotiation. However, to avoid blocking situations, the
Interworking Node shall not defer sending the Terminal Capability Set message
for an excessive period of time.
\- The codecs contained both in the sent and received Terminal Capability Set
message may be selected at the CS side. The final decision of the selected
codecs at the CS side is taken when the H.245 open logical Channels message
(signal 9 in figure 5.4.1.1) is sent or received. The direction of this
message is determined by the H.245 master-slave determination procedure.
If the Interworking Node does not transcode, it should indicate the codecs
selected within the H.245 negotiation or within the MONA procedures after the
completion of the H.245 negotiation (signal 10 in figure 5.4.1.1) or MONA
procedures.
#### 5.4.1.2 Call setup if multimedia call can not be recognized in an
unambiguous manner
If the Interworking Node is not able to determine from the information within
the IAM request whether a multimedia call or some other type of data call is
requested (for example, if only TMR=UDI but no BC IE is contained in the IAM),
the Interworking Node may also include appropriate codecs for other possible
types of data call it supports in the INVITE request. If video and audio
codecs are contained in the first SDP answer (signal 3), the Interworking Node
should continue to attempt to set up a multimedia call as desribed in Clause
5.4.1.1. Otherwise, calls are being set up as described in Clause 7.2.3.2 of
TS 29.163 [2] and Clauses 6 and 7 of the present specification are not
applicable.
### 5.4.2 Preconditions used by IMS terminal
#### 5.4.2.1 Early media at the CS side through-connected
Not applicable. The early media support is not specified in 3G324M.
##### 5.4.2.1.1 Void
##### 5.4.2.1.2 Void
#### 5.4.2.2 Early media at the CS side not through-connected
##### 5.4.2.2.1 BICC with SCUDIF
Figure 5.4.2.2.1.1 Interactions between BICC and SIP/SDP for CS network
originated session\ Forward early media on CS side not through-connected\ SIP
Terminal supports preconditions
Figure 5.4.2.2.1.1 shows examples of interactions between BICC and SIP/SDP for
a CS network originated session. It is assumed that SCUDIF is applied at the
BICC side and the SIP preconditions extension is used at the IMS side.
Furthermore, it is assumed that forward early media are not through-connected
at the CS side, allowing that the H.245 or MONA signalling to progresses only
after the CS side call set-up is completed.
The same example Callflow is depicted in figures 5.4.1.1 and 5.4.2.2.1.1.
\- Signal 3 of figure 5.4.1.1 maps to signal 4 of figure 5.4.2.2.1.1.
\- Signal 6 of figure 5.4.1.1 maps to signal 18 of figure 5.4.2.2.1.1.
\- Signal 22 of figure 5.4.1.1 maps to signal 12 of figure 5.4.2.2.1.1.
\- Signal 5, 8 and 9 of figure 5.4.1.2 are included in box 17 of figure
5.4.2.2.1.1.
If signal 4 of figure 5.4.2.2.1.1 only contains a speech codec but no video
codec, the Inter‑working Node shall apply a SCUDIF fallback to speech in the
BICC APM message (signal 5), i.e. it shall use a speech codec as Selected
Codec and exclude the MuMe codec from the available codec list.
##### 5.4.2.2.2 Non-SCUDIF case (ISUP or BICC without SCUDIF)
Figure 5.4.2.2.2.1 shows an example of interactions between ISUP or BICC
without SCUDIF and SIP/SDP for CS network originated session. It is assumed
that preconditions extension is supported by the IMS terminal. Furthermore,
forward and backward early media are not through-connected at the CS side,
allowing the H.245 or MONA negotiation to progress only after the CS side call
establishment is completed.
Based on the UDI and H.223 & H.245 request in the BCIE of the incoming IAM
message, the inter‑working node generates a SIP INVITE message towards the IM
CN subsystem, with a video and audio media in the SDP, message 2.
After the H.245 or MONA in‑band negotiation is completed in the CS leg, the
inter‑working node updates the media in the IM CN leg to correspond to the
H.245 or MONA negotiation results and its own audio coding capabilities, if
required, messages 17 and 18.
Figure 5.4.2.2.2.1 Interactions between ISUP or BICC without SCUDIF and\
SIP/SDP for CS network originated session\ Forward and backward early media
not through-connected at CS side\ SIP Terminal supports preconditions
### 5.4.3 Preconditions not used by IMS terminal
#### 5.4.3.1 Early media at the CS side through-connected
Not applicable. The early media support is not specified in 3G324M.
##### 5.4.3.1.1 Void
##### 5.4.3.1.2 Void
#### 5.4.3.2 Early media at the CS side not through-connected
##### 5.4.3.2.1 BICC with SCUDIF
Figure 5.4.3.2.1.1 Interactions between BICC and SIP/SDP for CS network
originated session\ Forward and backward early media not through-connected at
CS side\ SIP Terminal does not support preconditions
Figure 5.4.3.2.1.1 shows an example of interactions between BICC and SIP/SDP
for CS network originated session. It is assumed that preconditions extension
is not supported by the IMS terminal. Furthermore, forward and backward early
media are not through-connected at the CS side, allowing the H.245 or MONA
negotiation to progress only after the CS side BICC call establishment is
completed.
Based on the incoming IAM message with the supported codec list indicating AMR
and MuMe in order of preference, the interworking node generates a SIP INVITE
message towards the IM CN subsystem, with a video and audio media in the SDP,
message 2. The IMS party may respond to the offer with a provisional response,
and the interworking node sends an APM message with the selected codec
indicating MuMe to the network.
After the H.245 or MONA inband negotiation is completed in the CS leg, the
interworking node updates the media in the IM CN leg to correspond to the
H.245 or MONA negotiation results and its own audio coding capabilities, if
required, messages 16 and 17.
##### 5.4.3.2.2 Non-SCUDIF case (ISUP or BICC without SCUDIF)
Figure 5.4.3.2.2.1 shows an example of interactions between ISUP or BICC
without SCUDIF and SIP/SDP for CS network originated session. It is assumed
that preconditions extension is not supported by the IMS terminal.
Furthermore, forward and backward early media are not through-connected at the
CS side, allowing the H.245 or MONA negotiation to progress only after the CS
side call establishment is completed.
Based on the UDI and H.223 & H.245 request in the BCIE of the incoming IAM
message, the inter‑working node generates a SIP INVITE message towards the IM
CN subsystem, with a video and audio media in the SDP, message 2.
After the H.245 or MONA in‑band negotiation is completed in the CS leg, the
interworking node updates the media in the IM CN leg to correspond to the
H.245 or MONA negotiation results and its own audio coding capabilities, if
required, messages 15 and 16.
Figure 5.4.3.2.2.1 Interactions between ISUP or BICC without SCUDIF and\
SIP/SDP for CS network originated session\ Forward and backward early media
not through-connected at CS side\ SIP Terminal does not support preconditions
### 5.4.4 CS originated - IM CN transit - CS terminated
Figure 5.4.4.1 describes ISUP and SIP/SDP interactions in a CS originated - IM
CN transit - CS terminated case with a clear channel through the IM CN. An
inter‑working node A receives an IAM message with a UDI H.223 & H.245 video
call request (message 1). If the inter‑working node A supports both CS/IMS
video inter‑working and a clearmode codec / clear channel, it may send both
audio and video codecs and a clearmode codec and a UDI & H.223 & H.245 video
indication in the INVITE message towards the IMS (message 2). The message is
received by an inter‑working node B. The inter‑working node B sends an IAM
message with a UDI & H.223 & H.245 video call request to the terminating CS
network (message 3). If the inter‑working node B supports a clearmode codec /
clear channel, it may send a SIP response with a clearmode codec towards the
calling side to indicate that a clear channel can be established between the
IMS inter‑working nodes (message 5). After the called party answers, the
inter‑working node B sends a SIP 200 OK (Invite) with the clearmode codec to
the calling node to indicate that a clear channel can be established (message
11). After the called party has answered the call, either MONA procedures are
performed and the H.223 bearer is established or the H.223 bearer is
established and the H.245 signalling is performed (step 14 in figure 5.4.4.1).
If the inter‑working node A does not support CS-IMS video inter‑working, but
supports a clearmode codec / clear channel, it sends the INVITE message with a
clearmode codec and UDI & H.223 & H.245 indication, but without a video codec,
to allow the establishment of a CS video call through a clear channel. The
inter‑working node A may also send an audio codec (alone or with a clearmode
codec) to allow a fallback to speech. The inter‑working node B either accepts
the clearmode and sends the corresponding IAM message with a UDI & H.223 &
H.245 request (message 3) and SIP response with a clearmode codec (message 5
or 11), or accepts the speech mode and sends the corresponding IAM message
with a speech request (message 3) and SIP response with a speech codec
(messages 5, 11), or rejects the INVITE message if the requested codec(s)
cannot be supported.
Editor\'s Note: The format of the indication of UDI & H.223 & H.245 from
inter‑working node A to inter‑working node B is under study. One possibility
is to use an unregistered SDP attribute (\"a=X‑UDI&H.223&H.245\") but is used
here just as an example. A more general definition may be required or
considered.
Figure 5.4.4.1: ISUP and SIP/SDP interactions in a CS originated - IM CN
transit\ \- CS terminated case with a clear channel through the IM CN
## 5.5 Service change
### 5.5.1 SCUDIF
#### 5.5.1.1 IM CN subsystem originated change
##### 5.5.1.1.1 Change from multimedia to speech
Figure 5.5.1.1.1.1 shows an IM CN subsystem originated modification from
multimedia to speech during an ongoing session when the CS leg supports BICC.
The inter‑working node receives an INVITE message that indicates the dropping
of the video media from the session, message 1. The inter‑working node can
only accept the dropping of the media component and sends a corresponding
codec modification request to the BICC network, message 2, and acknowledges
the INVITE with a 200 OK message. The BICC network indicates a successful
codec modification, message 5.
Figure 5.5.1.1.1.1: IM CN subsystem originated modification\ from multimedia
to speech when the CS leg supports BICC
Editor\'s note: Handling of a case, where a codec is received in BICC
negotiation but not included in the available codec list negotiated
previously, is ffs.
##### 5.5.1.1.2 Change from speech to multimedia
Figure 5.5.1.1.2.1 shows an IM CN subsystem originated modification from
speech to multimedia during an ongoing session when the CS leg supports BICC.
The inter‑working node receives an INVITE message that offers the adding of a
video media to the ongoing speech session, message 1. The inter‑working node
accepts the offer and sends a corresponding codec modification request to the
BICC network, message 2. The BICC network indicates a successful codec
modification, message 3. The inter‑working node acknowledges the INVITE with a
200 OK message after the H.245 or MONA in‑band negotiation in step 4 is
completed.
If the codec modification is not successful in the BICC network, the
inter‑working node responds to the INVITE message with the speech codec in the
200 OK message to retain the speech only session.
Figure 5.5.1.1.2.1: IM CN subsystem originated modification\ from speech to
multimedia when the CS leg supports BICC
#### 5.5.1.2 CS network originated change
##### 5.5.1.2.1 Change from multimedia to speech
Figure 5.5.1.2.1.1 shows a CS network originated modification from multimedia
to speech during an ongoing session when the CS leg supports BICC. The
inter‑working node receives a Modify Codec message that indicates the dropping
of the video media from the session, message 1. The inter‑working node accepts
the dropping of the video component and sends a corresponding INVITE message
to the IM CN subsystem, message 2, and acknowledges the codec modification
request to the BICC network, message 3. The IM CN subsystem acknowledges the
INVITE dropping the video media with a 200 OK, message 4.
Figure 5.5.1.2.1.1: CS network originated modification\ from multimedia to
speech when the CS leg supports BICC
##### 5.5.1.2.2 Change from speech to multimedia
Figure 5.5.1.2.2.1 shows a CS network originated modification from speech to
multimedia during an ongoing session when the CS leg supports BICC. The
inter‑working node receives a Modify Codec message that indicates the adding
of a video media to the ongoing speech session, message 1. The inter‑working
node accepts the offer and sends a corresponding INVITE message to the IM CN
subsystem, message 2. The IM CN subsystem acknowledges the INVITE adding the
video media with a 200 OK, message 3, and acknowledges the codec modification
request to the BICC network, message 4. The inter‑working node may have to
update the codecs, messages 7 and 8, after the H.245 or MONA in‑band
negotiation in step 6.
If the IM CN subsystem does not accept the addition of the video media to the
session, the inter‑working node rejects the modify codec request to retain the
speech only session.
Figure 5.5.1.2.2.1: CS network originated modification\ from speech to
multimedia when the CS leg supports BICC
### 5.5.2 Non-SCUDIF case (ISUP or BICC without SCUDIF)
#### 5.5.2.1 Change from multimedia to speech
Figure 5.5.2.1.1 shows an IM CN subsystem originated modification from
multimedia to speech during an ongoing session when the CS leg supports ISUP
or BICC without SCUDIF. The inter‑working node receives an INVITE message that
indicates the dropping of the video media from the session, message 1. The
inter‑working node can only accept the dropping of the media component and
acknowledges the INVITE with a 200 OK, message 2. There are three alternative
ways to handle the issue:
\- The video component stays on in the CS leg. The inter‑working node may use
the video component to send an announcement to the CS terminal to inform the
user about the change of the end-to-end connection to speech only. Refer to
figure 5.5.2.1.1.
\- The inter‑working node initiates an H.245 in‑band negotiation to close the
video channel.
\- The inter‑working node terminates the session.
Figure 5.5.2.1.1: IM CN subsystem originated modification\ from multimedia to
speech when the CS leg supports ISUP or BICC without SCUDIF
#### 5.5.2.2 Change from speech to multimedia
Figure 5.5.2.2.1 shows an IM CN subsystem originated attempt to change from
speech to multimedia during an ongoing session when the CS leg supports ISUP
or BICC without SCUDIF. The inter‑working node receives an INVITE message that
offers the adding of a video media to the ongoing speech session, message 1.
The inter‑working node turns down the offer and responds to the INVITE message
with the speech codec in the 200 OK message to retain the speech only session,
message 2.
Figure 5.5.2.2.1: IM CN subsystem originated modification\ from speech to
multimedia when the CS leg supports ISUP or BICC without SCUDIF
## 5.6 Call release
### 5.6.1 Call release initiated from the IM CN subsystem side
When the MGCF has received a BYE message (signal 1 in figure 5.6.1.1) from the
IM CN subsystem side, the MGCF may end the H.245 session between the IM-MGW
and the CS network side (signal 3 in figure 5.6.1.1) firstly.
NOTE: A call release using only ISUP/BICC signalling at the CS side proceeds
faster. H.324 terminals can handle situations where they do not receive H.245
call release signalling (see Clause 7.5.2 of ITU-T Recommendation H.324 [12]),
and this scenario also occurs e.g. at loss of coverage or when a node
transporting H.223 transparently releases the call.
The procedure of ending the H.245 session is defined in the clauses 7.2.1.4
and 7.3.3.4. After receiving the BYE message, the MGCF shall also send a 200
OK [BYE] message (signal 2 in figure 5.6.1.1) towards the IM CN subsystem.
After ending the H.245 session, the MGCF shall send a REL message (signal 4 in
figure 5.6.1.1) to the succeeding node. If the IM CN subsystem interworks with
ISUP based CS network, the interworking node shall release the resources for
the IMS side and the CS network side (signal 6 in figure 5.6.1.1) after
sending the REL message. If the IM CN subsystem interworks with BICC based CS
network, the interworking node shall release the resources for the IMS side
and the CS network side (signal 6 in figure 5.6.1.1) upon receiving the RLC
message (signal 5 in figure 5.6.1.1) from the CS network side. The procedures
of releasing the resources for the IMS side and the CS network side are
specified in 3GPP TS 29.163 [2].
Figure 5.6.1.1 shows the message sequence chart for the multimedia call
release initiated from the IM CN subsystem side.
NOTE: Signal 7 is omitted when IM CN subsystem interworks with BICC based CS
network and Signal 5 is omitted when IM CN subsystem interworks with ISUP
based CS network.
Figure 5.6.1.1: Call release initiated from the IM CN subsystem side
### 5.6.2 Call release initiated from the CS network side
If the CS network side initiates the call release, it possibly ends the H.245
session with explicit signalling (signal 1 in figure 5.6.2.1). The CS network
side sends a REL message (signal 2 in figure 5.6.2.1) towards the IM CN
subsystem. The procedure of ending the H.245 session is defined in the clauses
7.2.1.4 and 7.3.3.4.
When the MGCF receives a REL message (signal 2 in figure 5.6.2.1) from the
preceding node, the MGCF sends a BYE message (signal 3 in figure 5.6.2.1) to
the IM CN subsystem. After receiving the REL message, the interworking node
also releases the resources for the IMS side and the CS network side (signal 4
in figure 5.6.2.1). The procedure of the releasing the resources for the IMS
side and the CS network side are specified in 3GPP TS 29.163 [2]. After
completion of resource release, the MGCF sends a RLC message (signal 5 in
figure 5.6.2.1) towards the preceding node. Figure 5.6.2.1 shows the message
sequence chart for the multimedia call release initiated from the CS network
side.
Figure 5.6.2.1: Call release initiated from the CS network side
### 5.6.3 Call release initiated from the interworking node
The interworking node may end the H.245 session between the IM-MGW and the CS
network side (signal 1 in figure 5.6.3.1) firstly. The procedure of ending the
H.245 session is defined in the clauses 7.2.1.4 and 7.3.3.4.
NOTE: A call release using only ISUP/BICC signalling at the CS side proceeds
faster. H.324 terminals can handle situations where they do not receive H.245
call release signalling (see Clause 7.5.2 of ITU-T Recommendation H.324 [12]),
and this scenario also occurs e.g. at loss of coverage or when a node
transporting H.223 transparently releases the call.
To release the call, the MGCF shall send a REL message (signal 2 in figure
5.6.3.1) to the succeeding node on the CS network side. The MGCF shall also
send a BYE message (signal 3 in figure 5.6.3.1) to the IM CN subsystem side.
If the IM CN subsystem interworks with ISUP based CS network, the interworking
node shall release the resources for the IMS side and the CS network side
(signal 5 in figure 5.6.3.1) after sending the REL message. If the IM CN
subsystem interworks with BICC based CS network, the interworking node shall
release the resources for the IMS side and the CS network side upon receiving
the RLC message (signal 4 in figure 5.6.3.1) from the CS network side. The
procedures of releasing the resources for the IMS side and the CS network side
are specified in 3GPP TS 29.163 [2]. Figure 5.6.3.1 shows the message sequence
chart for the multimedia call release initiated from the interworking node.
{width="5.763194444444444in" height="3.7493055555555554in"}
NOTE: Signal 6 is omitted when IM CN subsystem interworks with BICC based CS
network and Signal 4 is omitted when IM CN subsystem interworks with ISUP
based CS network.
Figure 5.6.3.1: Call release initiated from the interworking node
# 6 User plane interworking
## 6.1 Functionalities required in the IM-MGW for multimedia calls support
To enable a multimedia Inter‑working, the IM-MGW needs to support the
reframing of the H.263 video codec and the AMR audio codec between CS
transport and PS transport as a minimum. The IM-MGW may also support the
reframing of other codecs and the transcoding of audio and/or video codecs.
At the CS side, the IM-MGW needs to terminate the H.223 protocol, multiplex /
de-multiplex audio, video and H.245 signalling and support MONA procedures
according to the ITU-T Recommendation H.324 Annex K [32]. How MONA and H.245
related information (e.g. H.245 messages or extracted information) is
communicated between the MGCF and the IM-MGW is described in Clause 7.
# 7 MGCF and IM-MGW interactions
This clause describes extensions to the Mn interface protocol in 3GPP TS
29.332 [28] needed to support the Inter‑working of multimedia calls. ITU-T
Recommendation H.248.1 [29] is used at the Mn interface. Several solution
proposals are compared.
## 7.1 H.248 Context Model
Two H.248 context models to (de-) multiplex H.223 have been proposed, as
depicted in figures 7.1.1 and 7.1.2. In both proposals, H.248 is applied as
described in ITU-T Recommendation H.248.20 [31] to describe the
(de-)multiplexing.
Figure 7.1.1: Proposed H.248 Context Models with separate RTP terminations
Figure 7.1.2: Proposed H.248 Context Model with a combined RTP termination for
audio and video
Editor\'s Note: The proposed context models will be compared in this clause.
### 7.1.1 Context model comparison
This clause compares the advantages with the two different Context models
(using separate RTP terminations versus using a combined RTP termination)
presented in clause 7.1.
#### 7.1.1.1 Context with separate H.248 RTP Terminations (T3 + T4)
The advantages of using a Context with separate H.248 RTP Terminations are:
-
#### 7.1.1.2 Context with combined H.248 RTP Termination (T3)
The advantages of using a Context with combined H.248 RTP Termination are:
\- A Context is usually used to describe a call/session (all Terminations
within a Context belong to the same session). A Termination is usually used to
describe a user/subscriber within that call. A Stream, within a Termination,
is usually used to describe a specific flow for the user/subscriber
represented by the Termination. This structure enables a simple way to take
actions on different levels (session, subscriber or stream).
\- It is possible to add (and remove) a subscriber using a single H.248
Command.
\- It is possible to request for subscriber specific event notifications using
a single event notification request.
\- It is possible to perform subscriber specific audits using a single audit
request.
\- If is possible to perform stream synchronization.
#### 7.1.1.3 Comparison conclusion
No advantage of using separate RTP terminations have been identified.
Therefore the conclusion is to use the Context model using a single RTP
termination for the multimedia interworking.
## 7.2 H.245 Termination at the IM-MGW
> Editor\'s Note: It is FFS if H.248.12 [30] procedures can be applied.
> H.248.12 provides a H.324 Package that controls H.223 multiplexing, and a
> H.245 Package that provides events to notify about incoming H.245 Messages.
> No Signals to trigger outgoing H.245 messages and indicate applicable codecs
> to be sent in H.245 Terminal Capability Set Messages are available.
### 7.2.1 Conveying H.245 related information over the Mn interface
This mechanism requires the IM-MGW to have H.245 functionality, since it
generates H.245 messages (partly based on information received from the MGCF)
and process H.245 messages received from CS.
#### 7.2.1.1 Call establishment procedure
The following information is provided from MGCF towards IM-MGW:
\- Signals to start H.223 and H.245 Negotiations.
\- Request for events in the bullet list below.
\- Signal to provide Codec information to be used in the H.245 capability
signalling.
Requested events from IM_MGW towards MGCF:
\- Notification of H.223 bearer establishment.
\- Codecs received from remote peer as H.245 capabilities.
\- Notification about logical channel assignment at end of H.245 negotiation.
NOTE 1: The Codec information in signal 15 may also be conveyed in signal 6.
Signals 15 and 17 are then omitted.
NOTE 2: Signals 25 and 26 are omitted if the same codec information has
already been provisioned in Signal 4.
NOTE 3: The Context model in figure 7.1.2 is assumed in this call flow. For
context model 7.1.1, signals 3 and 4 would be split into separate H.248
command exchanges for termination T3 and T4, and signals 25 and 26 would also
be split.
Figure 7.1.3: Mn signalling interactions for Proposal 1
The MGCF request terminations towards the CS network (Signal 1 and 2 of figure
7.1.3) and towards the IMS (Signal 3 and 4 of figure 7.1.3). For the
terminations towards the IMS, the MGCF provides an estimate about the
applicable codecs.
In Signal 6 of figure 7.1.3, the MGCF requests that the H.223 stream is
(de-)multiplexed at the MUX termination T2, and that the H.245 control in
H.223 Logical channel 0 is separated. Furthermore, the MGCF requests that the
H.223 and then the H.245 negotiation is started. The MGCF requests to be
notified about H.223 Multiplexing Bearer Establishment (optional), Received
H.245 Capability Information (optional), and selected H.245 Channels
(mandatory).
The IM-MGW starts the H.223 Multiplexing Level Negotiation after CS bearer
establishment (Signal 8 of figure 7.1.3). The MGCF may supervise the
completion of this negotiation with the Notification in Signal 9, e.g. to
progress the CS procedures independently of further notifications (if early
media are not enabled at the CS side) or to detect that no H.324 multimedia
call is established at the CS side.
Upon reception of a H.245 Terminal Capability Set message (Signal 11), the IM-
MGW notifies the MGCF (Signal 12) about the received codec information and
sends an H.245 Acknowledgment message (Signal 14). The IM-MGW shall eliminate
the codecs it does not support from the TCS codec list before notifying the
MGCF, thus avoiding that the MGCF needs to configure information about the IM-
MGW capabilities. The IM-MGW shall add the codecs that it can transcode to the
codecs provided by the IMS side in lower priority.
In Signal 15, the MGCF request the IM-MGW to send a H.245 Terminal Capability
Set message (Signal 16) and provides codec information to be included in the
H.245 Terminal Capability Set message. Multiple Speech and/or video codecs may
be contained in the list. The IM-MGW shall eliminate Codecs it does not
support, thus avoiding that the MGCF needs configured information about the
IM-MGW capabilities. The IM-MGW shall add the codecs that it can transcode to
the codecs provided by the IMS side in lower priority.
The MGCF may defer sending the signal (signal 16) for some time to wait for
codec information from the CS peer\'s Terminal Capability Set message and
perform a possible IMS-side codec re-negotiation. To avoid blocking
situations, the MGCF shall not defer sending the signal for an excessive
period of time. Alternatively, the MGCF may apply this signal already in
combination with a signal to start the H.223 Multiplexing level combination
(in Signal 4, but not depicted in this form in figure 7.1.3).
The IM-MGW performs the H.245 master-slave determination procedure
autonomously. (Signals 11. 14, 16 and 17) This procedure could be combined
with messages used for the H.245 capability exchange. To avoid the CS side
selecting codecs that need transcoding at the IM-MGW, the IM-MGW should aim to
be the master in the H.245 master-slave determination procedure (Signals 9,
12, 14 and 16). For that, the IM-MGW shall set the Terminal Type parameter to
a number larger than 128 in the H.245 Master Slave Determination message.
The codecs contained both in the sent and received terminal capability set
message may be selected at the Cs side. The final decision of the selected
codecs at the CS side is taken with the H.245 open logical Channels procedure
(signals 19 and 20). The direction of the related messages is determined by
the H.245 master-slave determination procedure and may be opposite to what is
depicted in figure 7.1.3.
After the completion of the H.245 open logical channel procedure, the IM-MGW
notifies the MGCF the logical channel numbers, the directions of the logical
channels and the selected codecs (signal 21). When the CS side closes a
logical channel, the IM-MGW shall notify the MGCF the logical channel number
and the direction of the logical channel after the completion of the H.245
close logical channel procedure.
The IM-MGW performs the H.245 multiplex table procedure autonomously.
The MGCF configures the multiplexing termination T2 (signals 21 and 22). If
codec information needs to be changed compared to what has been provisioned in
signal 3, the MGCF also configures T3 with the appropriate video and/or speech
codec(s) (signals 25 and 26).
The call is in the active state.
#### 7.2.1.2 Procedure of H.245 indication message
The IM-MGW shall support the following H.245 indication messages: Function Not
Understood Indication, Function Not Supported Indication, Jitter Indication.
The IM-MGW may support the H.245 User Input Indication message.
##### 7.2.1.2.1 Function Not Understood / Function Not Supported message
The Function Not Understood / Function Not Supported indication message is
used to return error information from the receiver to the sender because the
receiver can not understand the H.245 request, response or command messages
received.
If the IM-MGW receives a Function Not Understood or Function Not Supported
message from the CS side, the IM-MGW may release the call or omit the message.
When the IM-MGW receives a H.245 request, response or command that can not be
understood from the CS side, the IM-MGW shall send a H.245 Function-Not-
Supported indication message to the CS side.
##### 7.2.1.2.2 Jitter Indication message
The Jitter Indication message indicates the amount of jitter, as estimated by
the receive terminal, of a logical channel.
If the IM-MGW receives a Jitter indication message from the CS side, the IM-
MGW may use this information to adjust the bit-rate of the media stream to the
CS side.
##### 7.2.1.2.3 User Input Indication message
The User-Input-Indication message is used to transport the in-band DTMF
information in the H.324 system.
The MGCF and IM-MGW may support transporting the DTMF information both from
the CS side to the IMS side and from the IMS side to the CS side, detecting
the DTMF information from both the CS side and IMS side of the IM-MGW and
notifying to the MGCF, and sending the DTMF information from the MGCF to the
CS side or IMS side of the IM-MGW.
{width="6.69375in" height="6.592361111111111in"}
Figure 7.2.1.2.3.1: Mn procedure for H.245 User Input Indication terminated at
IM-MGW
In signal 1, the MGCF directs the IM-MGW to detect DTMF from the CS-side or
the IMS side of the IM-MGW.
In signal 3, when the IM-MGW receives a H.245 User-Input-Indication message
from the CS side, if the MGCF has requested the IM-MGW to detect DTMF from the
CS side, the IM-MGW gets the DTMF information from the User-Input-Indication
message and notify the MGCF (in signal 4). Otherwise if the IM-MGW has been
configured to convert the DTMF information from CS side to the IMS side
directly, the IM-MGW gets the DTMF information from the User-Input-Indication
message and transport the DTMF information by Telephony event to the IMS side.
In signal 6, the MGCF may direct the IM-MGW to play the DTMF information to
the IMS side.
In signal 9, when the IM-MGW receives DTMF information transported by
Telephony event from the IMS side, if the MGCF has requested the IM-MGW to
detect DTMF from the IMS side, the IM-MGW gets the DTMF information and notify
the MGCF (in signal 10). Otherwise if the IM-MGW has been configured to
convert the DTMF information from the IMS side to the CS side directly, the
IM-MGW transports the DTMF information to the CS side by the
User‑Input‑Indication message. In signal 12, the MGCF may play the DTMF
information to the CS side. In signal 14, the IM‑MGW sends the DTMF
information to the CS side in the User-Input-Indication message.
#### 7.2.1.3 Procedure of H.245 Command message
The IM-MGW shall support the H.245 End Session command message. The IM-MGW may
support the H.245 Flow Control command message.
##### 7.2.1.3.1 Flow control command
The flow control command is used to restrict the upper limit of bit rate of
either a single logical channel or the whole multiplex stream. The IM-MGW may
support the flow control command received from the CS side.
Figure 7.2.1.3.1.1: Mn procedure of Flow control command
In Signal 1, the MGCF requests the IM-MGW to detect the flow control command
from the CS side, and the close logical channel and open logical channel
events. In Signal 3, the IM-MGW receives the Flow Control Command from the CS
side. If the minimum bitrate of the current codec from the IM-MGW to the CS
side is larger than the bitrate requested by the H.245 message, the IM-MGW
shall stop the transmission of the media stream over the logical channel. Then
the IM-MGW may re-select the codec that can satisfy the requested bit-rate
limit. In signal 4, the IM-MGW closes the old logical channel and opens a new
logical channel with new codec to satisfy the bitrate limit in the CS side. In
signal 6, the IM-MGW notifies the closing of the old logical channel and
opening of the new logical channel to the MGCF. In signal 8, the MGCF
indicates the IM-MGW to modify the LCN and codec of the multiplexing
termination. The procedure described by the signal 4, 5, 6, 7, 8 is similar
with the call establishment procedure. In signal 10, the IM-MGW sends flow
control indication message to CS side with the current maximum bit rate. In
signal 11 and 12, if the IMS side supports the new codec of the IM-MGW
selected, the MGCF may re-negotiate the codec with the IMS side by reINVITE
message. In signal 13, the MGCF modifies the codec of IMS termination
according to the re-negotiation result.
If the minimum bitrate of the current codec from the IM-MGW to the CS side is
less than the bitrate requested by the H.245 message, the IM-MGW may modify
the codec property to satisfy the bitrate limit in the CS side.
NOTE: The procedure of handling H.245 flow control command shall be aligned to
the procedure specified by SA4.
##### 7.2.1.3.2 End Session Command
The end session command is used to close the H.245 control channel after all
the logical channels have been closed.
The IM-MGW may send an end session command to the CS side to release a call.
If the IM-MGW receives an end session command from the CS side, the MGCF
(after been notified) shall release the call if the call is in active state.
#### 7.2.1.4 Advantages of H.245 Termination at the IM-MGW and Conveying H.245
related information over the Mn interface
Compared to the proposal to allocate the H.245 Termination at the MGCF and
forward all H.245 messages within H.248 (see Clause 7.3.1.1), the following
advantages have been identified:
The signalling load at the Mn interface is decreased, because:
\- No transport of H.245 Acknowledgment messages is required from MGCF to MGW.
No information from most received Acknowledgment messages needs to be
transported from MGW to MGCF.
\- Not all other H.245 messages need to be forwarded to the MGCF (e.g. Master-
Slave-Determination).
\- Not all parameters of H.245 messages need to be forwarded.
As a consequence, the H.245 negotiation can proceed faster as H.248 transport
related delays are avoided.
The MGCF implementation can be kept simpler.
\- No support of a H.245 stack is required. Only H.245 related information, as
detailed in the beginning of clause 7.2.1.1, needs to be handled.
\- Notification of some H.245 related information, e.g. of Codecs received
from remote peer as H.245 capabilities is optional. For instance, as a first
implementation step, an MGCF that selects only the default codec H.323 can
avoid such a notification. This allows for a phased evolution of the MGCF.
\- An MGCF only sends and receives H.245 related information relevant for
Interworking.
#### 7.2.1.5 Mn procedure for ending the H.245 session
##### 7.2.1.5.1 H.245 session end initiated from the MGCF
When H.245 is terminated at the IM-MGW, the MGCF indicates the IM-MGW to end
the H.245 session (signal 1 in figure 7.2.1.5.1.1). After receiving this
indication from the MGCF, the IM-MGW executes the procedure of ending the
H.245 session specified in the ITU-T Recommendation H.324 [12]. In the process
of ending the H.245 session, the IM‑MGW closes all logic channels for video
firstly, and then the IM-MGW closes all logic channels for audio. When all
logic channels have been closed, the IM-MGW sends a H.245 ESC
(EndSessionCommand) message (signal 5 in figure 7.2.1.5.1.1) towards the CS
network side. Afterwards the CS network side closes all logic channels for
video and audio one by one (signal 6 in figure 7.2.1.5.1.1). When all logic
channels have been closed, the CS network side sends a H.245 ESC message
(signal 7 in figure 7.2.1.5.1.1) towards the IM-MGW.
When the IM-MGW receives the ESC message (signal 7 in figure 7.2.1.5.1.1) from
the CS network side, the IM-MGW notifies the MGCF that the H.245 session has
been ended (signal 8 in figure 7.2.1.5.1.1). Figure 7.2.1.5.1.1 shows the
message sequence chart for H.245 session end initiated from the MGCF.
{width="5.672916666666667in" height="3.779861111111111in"}
Figure 7.2.1.5.1.1: H.245 session end initiated from the MGCF for H.245
termination at the IM-MGW
##### 7.2.1.5.2 H.245 session end initiated from the CS network side
In the case H.245 session end is initiated from the CS network side with H.245
terminated at the IM-MGW, there is no interworking between the MGCF and the
IM-MGW during ending the H.245 session. The procedure of ending the H.245
session is specified in the ITU-T Recommendation H.324 [12].
### 7.2.2 Conveying selected H.245 messages over the Mn interface
This mechanism requires the IM-MGW to have H.245 functionality, since it
generates H.245 messages (partly based on information received from the MGCF)
and process H.245 messages received from CS.
The IM-MGW does not need to be able to process H.245 messages sent over the Mn
interface, but it must be able to understand the H.245 message type.
If the MGCF can dynamically choose which H.245 messages are to be sent over
the Mn interface the IM-MGW must be prepared to process all H.245 messages
(see clause 7.2.1), in case the MGCF does not want to send any H.245 messages
over the Mn interface.
H.245 messages are transported between the MGW and MGCF over the Mn interface
using H.248 Events (MGW‑to‑MGCF direction) and Signals (MGCF-to-MGW
direction). The Events/Signals contains the following information:
\- H.245 message (binary)
The MGCF shall, when requesting the H.245 message event notifications from the
IM-MGW, indicate which H.245 messages it want to receive.
Editor\'s note: In some cases it may not be needed to send the whole H.245
message towards the MGCF, just an indication that a specific H.245 message has
been received.
Editor\'s note: We need to investigate if the MGCF also needs to tell the IM-
MGW which H.245 messages the MGCF intends to generate, so that the IM-MGW does
not generate them itself.
#### 7.2.2.1 Conclusion on this proposal
Due to the double implementation of H.245 in MGCF and IM-MGW and complex logic
for a shared responsibility of H.245 procedure handling between MGCF and IM-
MGW required for this proposal, it was decided not to pursue this proposal
within the TR any further.
### 7.2.3 Mn packages
The following H.248 packages shall be added to Mn:
Editor\'s Note: The H.248 packages needed for the options described in 7.2.1
and 7.2.2 shall be listed here.
## 7.3 H.245 Termination at the MGCF
This mechanism does not require the MGW to have knowledge about H.245 messages
or procedures, since H.245 are forwarded towards the MGCF or CS as binary data
by the IM-MGW. The IM-MGW does not need to understand those H.245 messages
which are defined as properties in different packages.
### 7.3.1 Transport of H.245 messages between the MGCF and IM-MGW
#### 7.3.1.1 Conveying H.245 messages over the Mn interface
H.245 messages are transported between the MGW and MGCF over the Mn interface
using H.248 Events (from the IM‑MGW towards the MGCF) and Signals (from the
MGCF towards the IM-MGW). The Events/Signals contains the following
information:
\- H.245 message (binary).
##### 7.3.1.1.1 From MGCF to IM-MGW
Figure 7.3.1.1.1.1: Mn signalling interactions for sending H.245 message
In Signal 1, when the MGCF requests to send a H.245 message to the CS side,
the MGCF indicates a H.248 signal to the IM-MGW with the complete H.245
message content. In Signal 3, the IM-MGW gets the H.245 message from the H.248
signal, and then sends the message through the H.245 control channel to the CS
side. This signal may be indicated through a H.248 ADD, MOD or SUB command.
##### 7.3.1.1.2 From IM-MGW to MGCF
Figure 7.3.1.1.2.1: Mn signalling interactions for receiving H.245 message
In signal 1, the MGCF requests the IM-MGW to detect the event of receiving
H.245 message from the CS side. In signal 3, when a H.245 message is received
from the CS side at the IM-MGW, the IM-MGW de-multiplexes the H.245 message
from the H.223 stream. In signal 4, the IM-MGW combines the H.245 message with
a H.248 message and notifies the H.248 message to the MGCF, and the MGCF gets
the H.245 message from the H.248 message. The event may be indicated through a
H.248 ADD or MOD command.
#### 7.3.1.2 Conveying H.245 messages using separate SCTP association
A separate SCTP association may be established between the MGCF and the IM-MGW
to transport the H.245 messages. The IM-MGW relays the H.245 message between
the H.223 stream and SCTP association transparently. When a H.245 message is
received for the H.223 stream of CS side, the IM-MGW shall send the H.245
message to the MGCF by SCTP association. And the MGCF shall send all H.245
messages by the SCTP association to the IM-MGW, the IM-MGW multiplex the H.245
message in the H.223 stream and send to CS side.
One SCTP association can be shared by multiple calls. To identify which
session the H.245 message belongs to in the MGCF and IM-MGW, the \"ContextID\"
of the current session shall be transported along with the H.245 message
through the SCTP association.
NOTE: The wrapper protocol for transporting the H.245 messages and its
associated ContextId over the SCTP association was not considered in the end
of this study and any procedures for establishing the SCTP association need to
be defined.
#### 7.3.1.3 Comparison conclusion
It has been concluded that it is not worth the effort to start defining a
wrapper protocol, and the procedures related to it, and that the option is to
use the Mn interface, even though using a separate SCTP association would
decrease the number of H.248 messages sent over Mn. The number of H.248
messages to be carried is also relatively small, and may decrease further once
the H.324m Fast Setup procedure is enabled in 3GPP, why the amount of traffic
would not justify a separate interface for the H.245 messages. The conclusion
is to transport H.245 messages between the MGCF and MGW using the Mn interface
when the H.245 termination is in the MGCF.
### 7.3.2 Mn packages
The following H.248 packages shall potentially be added to Mn:
\- Extended H.324 Package (h324ext).
\- Extended H.245 Indication Package (h245indext).
\- Extended H.245 Command Package (h245comext).
\- Package for transport of H.245 messages between MGCF and IM-MGW (in case
H.245 messages are transported over the Mn interface).
### 7.3.3 Procedure for H.245 termination at the MGCF
#### 7.3.3.1 Call establishment procedure
The following information is provided from MGCF towards IM-MGW:
\- Signal to start H.223 Negotiation.
\- Request for events in the bullet list below.
\- Incoming and outgoing H.223 multiplex table.
Requested events from IM_MGW towards MGCF:
\- Notification of H.223 bearer establishment.
{width="6.844444444444444in" height="8.05in"}
NOTE 1: All H.245 messages (from Signal 11 to Signal 20) are transported
through the IM-MGW between the MGCF and the CS side.
NOTE 2: Signals 23 and 24 are omitted if the same codec information has
already been provisioned in signal 3.
NOTE 3: The Context model in figure 7.1.2 is assumed in this call flow. For
context model 7.1.1, signals 3 and 4 would be split into separate H.248
command exchanges for termination T3 and T4, and signals 23 and 24 would also
be split.
Figure 7.3.3.1.1: Mn signalling interactions for H.245 termination at the MGCF
The MGCF request terminations towards the CS network (Signal 1 and 2 of figure
7.3.3.1.1) and towards the IMS (Signal 3 and 4 of figure7.3.3.1.1). For the
terminations towards the IMS, the MGCF provides an estimate about the
applicable codecs.
In Signal 6 of figure 7.3.3.1.1, the MGCF requests that the H.223 stream is
(de-)multiplexed at the MUX termination T2, and that the H.245 control in
H.223 Logical channel 0 is separated. Furthermore, the MGCF requests that the
H.223 negotiation is started. The MGCF requests to be notified about H.223
Multiplexing Bearer Establishment (optional), and all H.245 messages received
by the IM-MGW are sent to the MGCF (mandatory).
The IM-MGW starts the H.223 Multiplexing Level Negotiation after CS bearer
establishment (Signal 8). The MGCF may supervise the completion of this
negotiation with the Notification in Signal 9, e.g. to progress the CS
procedures independently of further notifications (if early media are not
enabled at the CS side) or to detect that no H.324 multimedia call is
established at the CS side.
Upon reception of a H.245 Terminal Capability Set message (Signal 11), the
MGCF sends a H.245 Acknowledgment message (Signal 12).
The MGCF shall know the H.324 related capabilities of the IM-MGW before
starting the H.245 capability negotiation with the CS side, e.g. through
configuring. The H.245 Terminal Capability Set message (Signal 13) should
include the codecs which are supported by both the IMS side and the IM-MGW,
and the codecs which could be transcoded by the IM-MGW from the codecs
supported by the IMS side.
The MGCF may defer sending the signal (Signal 13) for some time to wait for
codec information from the CS peer\'s Terminal Capability Set message and
perform a possible IMS-side codec re-negotiation. To avoid blocking
situations, the MGCF shall not defer sending the signal for an excessive
period of time.
To avoid the CS side selecting the codecs that need to be transcoded at the
IM-MGW, the MGCF should aim to be the master in the H.245 master-slave
determination procedure (Signals 11, 12, 13 and 14). The IM-MGW shall set the
Terminal Type parameter as a number larger than 128 in the H.245 Master Slave
Determination message. The H.245 master-slave determination procedure could be
combined with the messages used for the H.245 capability exchange.
The codecs contained both in the sent and received terminal capability set
message may be selected at the CS side. The final decision of the selected
codecs at the CS side is taken with the H.245 open logical channel procedure
(Signals 15 and 16).
After the completion of the H.245 multiplex table exchange procedure (Signals
17, 18, 19 and 20), the MGC shall indicate the IM-MGW the contents of the
incoming and outgoing multiplex tables (Signal 21).
The MGCF configures the multiplexing termination T2 (Signals 21 and 22). If
codec information needs to be changed compared to what has been provisioned in
signal 3, the MGCF also configures T3 with the appropriate video and/or speech
codec(s).
The call is in active state.
The above figure reflects that the H.245 messages are terminated in the MGCF.
The H.245 messages are conveyed over the Mn interface (how context is
established, messages, etc) is described in clause 7.3.1.1.
#### 7.3.3.2 Procedure of H.245 indication message
The MGCF shall support the following H.245 indication messages: Function Not
Understood Indication / Function Not Supported Indication, Jitter Indication.
The MGCF may support the H.245 User Input Indication message. All these H.245
messages are conveyed between the MGCF and the CS side through the IM-MGW, as
described in clause 7.3.1.
##### 7.3.3.2.1 Function Not Understood / Function Not Supported message
This indication message is used to return requests, responses and commands
that are not understood back to the transmitter.
If the MGCF receives a Function Not Understood or Function Not Supported
message from the CS side, the MGCF may release the call or omit the message.
If the MGCF receives a H.245 request, response or command that can not be
understood, the MGCF shall send H.245 Function Not Supported indication
message to the CS side.
##### 7.3.3.2.2 Jitter Indication message
The Jitter Indication message is used to indicate the amount of jitter, as
estimated by the receiving terminal, of a logical channel.
{width="6.236805555555556in" height="2.276388888888889in"}
Figure 7.3.3.2.2.1: Mn procedure for H.245 Jitter Indication terminated at the
MGCF
If the MGCF receives a Jitter indication message from the CS side (signal 1),
the MGCF may indicate the IM-MGW the amount of jitter and the logical channel
number (signal 2). The IM-MGW may use this information to adjust the bit-rate
of the media stream to the CS side.
##### 7.3.3.2.3 User Input Indication message
The User-Input-Indication message is used to transport the in-band DTMF
information in the H.324 system.
The MGCF and IM-MGW may support transporting the DTMF information both from
the CS side to the IMS side and from the IMS side to the CS side, detecting
and notifying the DTMF information from both the CS side and the IMS side of
the IM-MGW to the MGCF, and sending the DTMF information from the MGCF to the
CS side or IMS side of the IM-MGW.
{width="6.017361111111111in" height="4.435416666666667in"}
Figure 7.3.3.2.3.1: Mn procedure for H.245 User Input Indication terminated at
MGCF
In signal 1, the MGCF requests the IM-MGW to detect DTMF from the CS-side or
the IMS side of the IM-MGW.
If the MGCF receives a User-Input-indication message from the CS side (signal
3), the MGCF may request the IM‑MGW to send the DTMF information to the IMS
side (signal 4).
If the IM-MGW has been requested to detect DTMF, when the IM-MGW receives DTMF
information transported by Telephony Event from the IMS side (signal 7), the
IM-MGW shall notify the DTMF information to the MGCF (signal 8). Also the MGCF
may send the DTMF information by the H.245 User-Input-Indicate message to the
CS side (signal 10).
#### 7.3.3.3 Procedure of H.245 Command message
The MGCF shall support the End Session command message. The MGCF may support
the Flow Control command message. All these H.245 messages are conveyed
between the MGCF and the CS side by the IM-MGW, as described in clause 7.3.1.
##### 7.3.3.3.1 Flow control command
The flow control command is used to restrict the upper limit of bit rate of
either a single logical channel or the whole multiplex stream. The MGCF may
support the flow control command received from the CS side.
{width="5.896527777777778in" height="4.783333333333333in"}
Figure 7.3.3.3.1.1: Mn procedure of Flow control command
In Signal 1, the MGCF receives the Flow Control Command from the CS side, if
the minimum bitrate of the current codec is larger than the bitrate requested
by the H.245 message, in signal 2, the MGCF indicates the IM-MGW to stop the
transmission of the media stream over the logical channel.
Then the MGCF may re-select the codec that can satisfy the requested bitrate
limit. In signal 4, the MGCF closes the old logical channel and opens a new
logical channel with new codec to satisfy the bitrate limit in the CS side. In
signal 6, the MGCF indicates the IM-MGW to modify the LCN, codec and stream
mode of the multiplexing termination. In signal 8, the MGCF sends flow control
indication message to CS side with the current maximum bitrate. In signal 9
and 10, if the IMS side supports the new codec of the IM-MGW selected, the
MGCF may re-negotiate the codec with the IMS side by reINVITE message. In
signal 11, the MGCF modifies the codec of IMS termination according to the
re‑negotiation result.
If the minimum bitrate of the current codec from the IM-MGW to the CS side is
less than the bitrate requested by the H.245 message, the MGCF may indicate
the IM-MGW to modify the codec property to satisfy the bitrate limit in the CS
side.
NOTE: The procedure of handling H.245 flow control command shall be aligned to
the procedure specified by SA4.
##### 7.3.3.3.2 End Session Command
The end session command is used to close the H.245 control channel after all
the logical channels have been closed.
The MGCF may send an end session command to the CS side through the IM-MGW to
release a call. If the MGCF receives an end session command from the CS side,
it shall release the call if the call is in active state.
#### 7.3.3.4 Advantages of H.245 termination at the MGCF
The following advantages of H.245 termination at the MGCF have been
identified:
1\. There is no need to implement H.245 functionality in the MGWs. The MGW
will only treat the H.245 message as binary data. H.245 functionality will
only be needed in the MGCF.
2\. The H.245 message forwarding by the MGW will be faster, since there is no
need for any encoding/decoding of H.245 messages.
3\. Mn extensions for transporting of \"H.245 related information\" are not
needed.
4\. There are existing deployments where a control node performs interworking
with non-IMS H.323 networks, in which case most H.245 signalling will be
forwarded/received by that control node to/from that H.323 network. The
control node may also implement the MGCF functionality.
#### 7.3.3.5 Mn procedure for ending the H.245 session
The procedure of ending the H.245 session is triggered by the MGCF or by the
CS network side. The procedure of ending the H.245 session is specified in the
ITU-T Recommendation H.324 [12]. All H.245 messages are transported through
the Mn interface over H.248 between the MGCF and the IM-MGW. No other specific
Mn procedure is needed.
## 7.4 Media Oriented Negotiation Acceleration (MONA)
### 7.4.1 Overview
Media Oriented Negotiation Acceleration (MONA), as specified in ITU-T H.324
Amendment 1 [32] provides simplified procedures that allow for a faster call
set-up of a H.324 Multimedia call than standard H.324 procedures, and also
allow for a fallback to standard H.324 procedures if either party does not
support the enhanced procedures.
The support of MONA is optional for an IM-MGW and MGCF supporting multimedia
interworking, as no call failure but only a fallback to standard H.324 setup
procedures will occur if the procedures are not supported.
MONA \"preference message\" signalling is used instead of H.324 Multiplexing
level negotiation. Should standard H.324 Multiplexing level stuffing flags be
received, a fallback to standard H.324 procedures is triggered. The sending of
MONA preference messages is repeated by each MONA capable H.324 terminal until
a reception is acknowledged by the peer. During this phase, two PDU types may
optionally be attached by MONA terminals to these preference messages:
\- Media Preconfigured Channel (MPC) PDUs: MONA defines a small number of
preconfigured H.223 channels for the most widespread audio and video codecs
(AMR, AMR-WB, H.264 MPEG4 and H.263). Media PDUs for these codecs may be
attached to the MONA \"preference message\" during the call setup.
\- Signalling Preconfigured Channel (SPC) PDUs: These PDUs are H.245 generic
request messages with special parameters defined by MONA. These PDUs may also
be attached to MONA preference messages.
According to MONA, each MONA capable terminal shall support at least one of
these PDU types. The MONA capability of the IM-MGW can be audited by the MGCF
.
The MONA preference message exchange in combination with attached MPC or SPC
PDUs may result in the establishment of the desired media channels without
further H.245 signalling. Otherwise, H.245 will be used after the MONA
preference message exchange is acknowledged to negotiate media channels, but
MONA defines some accelerated H.245 procedures (ACP) to speed up these H.245
procedures.
The design of Mn procedures to support MONA is guided by the following
considerations:
\- The H.245 handling should be performed in the MGCF to keep procedures
aligned as far as possible with standard Mn procedures to support H.324
interworking.
\- The MGCF should also control MONA preference message exchange procedures in
order to maintain the agreed architectural work split between MGCF and IM-MGW
in analogy to the H.245 handling.
\- However, the IM-MGW needs to understand the MONA preference messages at
least to a sufficient degree to de-encapsulate the possibly attached MPC and
SBC PDUs.
\- Furthermore, the frequent retransmissions of MONA preference messages
required by MONA procedures are to be performed by the IM-MGW autonomously to
avoid unnecessary load at the Mn interface and the MGCF.
\- Furthermore, for resource reservation at the IM-MGW, it is assumed that the
IM-MGW has knowledge about supported predefined Media Preconfigured Channel
configurations as specified in Clause K.9.2 of H.324 Amendment 1 in order to
limit the amount of information transferred in the Mn interface when
establishing MPC channels. The offered channel resources are reserved by the
IM-MGW.
\- In order to avoid increasing call establishment time when interworking with
legacy terminals and at the same time avoid unnecessary load at the Mn
interface, the MGCF may initiate both MONA and legacy H.245 procedures
simultaneously in parallel. The MGCF shall in this case arm a legacy detection
event with an embedded signal descriptor including the initial legacy H.245
message. The IM-MGW will only send the signal in case a fallback condition to
legacy is detected.
Editor's note: It is FFS whether the mux-level-indication event can be used as
a legacy detection event, and whether it is more feasible than the mechanism
for legacy detection described.
### 7.4.2 Mn Interactions for MONA preference messages
NOTE 1: MONA preference messages are repeated several times. One repetition is
shown for each such message, with the same signal number as the first message.
NOTE 2: The Context model in figure 7.1.2 is assumed in this call flow.
Figure 7.4.2.1: Mn signalling interactions for MONA preference messages
The MGCF shall request terminations towards the CS network (Signal 1 and 2)
and towards the IMS (Signal 3 and 4). For the terminations towards the IMS,
the MGCF provides an estimate about the applicable codecs in the required
information elements \"Local IMS Resources\" (for both \"Reserve IMS
Connection Point\" procedure and \"Reserve IMS Connection Point and Configure
Remote Resources\" procedure) and possibly \"Remote IMS Resources\" (only for
\"Reserve IMS Connection Point and Configure Remote Resources\" procedure).
The MGCF shall request that the H.223 stream is (de-)multiplexed at the MUX
termination T2 (signal 6). Furthermore, the MGCF shall request that MONA
preferences negotiation is started, and shall provision the MONA preferences
to be indicated by the IM-MGW. The MGCF shall encode the MONA preferences as
described in Clause 6 of ITU-T H.324 Amendment 1 [32]. The MGCF shall take the
H.324 related capabilities of the IM-MGW into account in the MONA preferences.
The MGCF can know these capabilities by configuration. The IM-MGW will only
support symmetric codec usage. If several codec alternatives are offered for
MPC, it is the responsibility of the MGCF to ensure that symmetric codecs are
established by not selecting transmit codec until the receive channel has been
opened by MPC media. The MGCF shall also request to be notified about the
reception of the remote MONA preferences and about the completion of the MONA
preference exchange, or an H.245 message on the H.223 control channel. The
MGCF may also initiate standard H.245 signaling in parallel in order to
minimize the time for a legacy interworking fallback. This is done by arming a
legacy detection event including an embedded signal descriptor. The embedded
signal is the intial H.245 message out signal (including H.245 TCS+MSD) to
send in case fallback to legacy interworking is detected. The IM-MGW will only
send the embedded signal in case it detects H.223 related indications of a
legacy interworking as specified in Clause K.7.1.2 in H.324 Amendment 1\. Upon
receiving the legacy detected event, the MGCF continues with standard H.245
call setup procedures waiting for the reception of a remote H.245 TCS as well
as acknowledgements on the sent H.245 TCS+MSD. If the MGCF indicates the
capability to receive SPC PDUs within the MONA preferences, it shall also
request to be notified about incoming SPC PDUs, as detailed in Clause 7.4.4.
If the MGCF indicates the capability to receive any MPC PDUs within the MONA
preferences, it shall also request to be notified about incoming MPC PDUs, as
detailed in Clause 7.4.3.
The IM-MGW shall start sending MONA preference messages after receipt of the
corresponding request from the MGCF and CS bearer establishment (Signal 8).
The IM-MGW shall repeat sending those messages and increment the
acknowledgment bits of sent MONA preference messages when receiving incoming
MONA preference messages according to MONA procedures (signals 8, 10, 14).
After sending at least 10 MONA preference messages, while the IM-MGW continues
to send and receive MONA preference messages, it shall attach MPC or SPC PDUs
if requested to do so by the MGCF as described in Clauses 7.4.3 and 7.4.4,
respectively. If the IM-MGW receives preference messages with an attachment,
it shall inspect the first octet of that attachment that will contain a MUX
code according to table K.15 of ITU-T H.324 Amendment [32] that identifies the
attached PDU as either a MPC PDU of one of the predefined channels or a SPC
PDU. The IM-MGW shall handle the attached MPC or SPC PDUs as described in
Clause 7.4.3 and 7.4.4, respectively.
After sending at least 10 MONA preference messages, the IM-MGW should insert
stuffing flags indicating the multiplexing level received from the MGCF
between MONA preference messages as described in Clause K.7.1.1 of ITU-T H.324
Amendment 1[32].
The IM-MGW shall notify the MGCF when receiving the first incoming MONA
preference message (Signals 11 and 12) and forward the received information.
Subsequent incoming MONA preference message will be identical apart from
possible increments in the acknowledgement bits. The IM-MGW shall not notify
the MGCF about these messages. Upon reception of the notification of a MONA
preference message, the MGCF shall compare the received MONA preferences
message with the preferences message it sent and react as described in Clause
7.1 of ITU-T H.324 Amendment [32].
When receiving an incoming MONA preference message with acknowledgment bits
10, the IM-MGW shall stop sending MONA preference messages and notify the MGCF
about the completion of the MONA preference exchange procedure (signals 16 and
17).
Upon reception of this notification, the MGCF shall check if all desired media
channels have been established. Otherwise the MGCF should use accelerated
H.245 procedures as defined by MONA to set up media channels. Corresponding
H.245 messages shall be transported transparently between the IM-MGW and the
MGCF using the \"Signal H.245 message\" and \"Notify H.245 message\"
procedures defined in 3GPP TS 29.163.
After receiving the notification about the completion of the MONA preference
exchange procedure, and a completion of the possible subsequent accelerated
H.245 setup procedures, the MGCF shall configure the multiplexing termination
T2 by indicating to the IM-MGW the contents of the incoming and outgoing
multiplex tables (Signal 19), and may modify the selected codecs at both the
MUX and the IMS side (signal 21).
### 7.4.3 Mn Interactions for MONA MPCs
NOTE 1: MONA preference messages are repeated several times. One repetition is
shown for each such message, with the same signal number as the first message.
NOTE 2: The Context model in figure 7.1.2 is assumed in this call flow.
Figure 7.4.3.1: Mn interactions for MONA MPCs
If the MGCF indicates the ability to receive any predefined MPCs channel types
in the MONA preferences messages, the MGCF shall request the IM-MGW to report
the channel type of received MPC PDUs (Signal 1).
If the MGCF intends to use MPCs for sending media during the MONA setup, the
MGCF shall request the IM-MGW to send media encoded according to one or
several of the media predefined channel types defined by MONA (signal 3) while
the MONA preference exchange described in Clause 7.4.2 is ongoing. The MGCF
should select channel types for codecs which are supported by both the IMS
side and the IM-MGW, and/or for codecs which could be transcoded by the IM-MGW
from the codecs supported by the IMS side. The MGCF may also configure the MGW
to receive these channels at the same time.
Upon reception of this request, the IM-MGW shall forward any media received
from the IMS side in MPC PDUs of the corresponding predefined channel type
attached to MONA preference messages, transcoding the media if required.
(Signal 5)
If the IM-MGW receives the first MONA preference message with attached MPC PDU
of a given predefined channel type (signal 6), and the MGCF has requested a
notification about such an event, the IM-MGW shall notify the MGCF about the
received channel type (signal 7). The IM-MGW shall not notify the MGCF about
subsequent receptions of MPC PDUs of the same channel type.
Upon reception of such a notification, if the IM-MGW supports the indicated
channel type and has not yet been configured to receive media of that channel
type, and if the MGCF has previously indicated the capability to receive MPCs
of that channel type within MONA preference messages, the MGCF shall configure
the IM-MGW to receive media of that channel type and forward them to the IMS
side. (Signal 9)
### 7.4.4 Mn Interactions for MONA SPCs
#### 7.4.4.1 General
H.245 PDUs for SPC shall be transported between the IM-MGW and MGCF over the
Mn interface using H.248 Events (from the IM‑MGW towards the MGCF) and H.248
Signals (from the MGCF towards the IM-MGW). The Events/Signals shall contain
the following information:
\- H.245 message (binary).
The related procedures are distinct from the procedures in Clause E.4.2.3 of
TS 29.163, since the PDUs are received or sent by the IM-MGW using the SPC,
i.e. as attachment to MONA preference messages.
If the MGCF supports SPCs, it shall comply with the SPC procedures in Clause
K.8 of ITU-T H.324 Amendment 1[32]. The repetition of sending the same SPCs
will be handled by the IM-MGW. When the MGCF receives an acknowledgement from
the CS side it shall request the IM-MGW to stop the repetition sending of the
SPCs,
Within the sent SPC PDUs, the MGCF should include the codecs which are
supported by both the IMS side and the IM-MGW, and the codecs which could be
transcoded by the IM-MGW from the codecs supported by the IMS side.
#### 7.4.4.2 Transport from MGCF to IM-MGW
NOTE 1: MONA preference messages are repeated several times. One repetition is
shown for each such message, with the same signal number as the first message.
NOTE 2: The Context model in figure 7.1.2 is assumed in this call flow.
Figure 7.4.4.2.1: Mn interactions for sending MONA SPCs
In Signal 1, the MGCF requests the IM-MGW to send an H.245 message to the CS
side. To request the IM-MGW to send a H.245 message to the CS side, the MGCF
shall sent an H.248 signal to the IM-MGW with the complete H.245 message
content.
Upon reception of this signal, the IM-MGW shall send the encapsulated H.245
message within the H.248 signal, as attachment to a MONA preference message as
described in Clause K.9.4 of ITU-T H.324 Amendment 1 [32] (signal 3). It
should repeat sending this H.245 message as attachment to subsequent MONA
preference messages.
#### 7.4.4.3 Transport from IM-MGW to MGCF
NOTE 1: MONA preference messages are repeated several times. One repetition is
shown for each such message, with the same signal number as the first message.
NOTE 2: The Context model in figure 7.1.2 is assumed in this call flow.
Figure 7.4.4.2.1: Mn interactions for receiving MONA SPCs
In signal 1, the MGCF requests the IM-MGW to detect received H.245 message
from the CS side in SPC PDUs attached to MONA preference messages and forward
them to the MGCF. To request the IM-MGW to detect and forward these H.245
message, the MGCF shall send a suitable H.248 event to the IM-MGW. The event
may be indicated through an H.248 ADD command.
In signal 3, the IM-MGW receives an H.245 message from the CS side attached as
SPC PDU to a MONA preference message. Upon reception of such an H.245 message
from the CS side, the IM-MGW may check, based on bitwise comparison of the
previously received H.245 message, if it has already forwarded the same H.245
message to the MGCF, in which case the IM-MGW may choose not to forward the
same H.245 message to the MGCF. Otherwise the IM-MGW shall forward the H.245
message to the MGCF within an H.248 Notify command (signal 4).
NOTE: According to H.324 [xx] a MOS requestAck message shall be sent to every
received MOS request. If the IM-MGW chooses, based on the bitwise comparition,
not to forward the received H.245 messae to the MGCF, no MOS requestAck
message will be generated. However, the MGCF will request the IM-MGW to
automatically retransmit the MOS requestAck message generated by the MGCF
itself.
If the IM-MGW does not support forwarding SPC PDUs or has not been requested
by the MGCF to forward these PDUs, it shall discard received SPC PDUs.
### 7.4.5 Mn Interactions for fallback from MONA procedures to standard H.324
setup
NOTE 1: MONA preference messages are repeated several times. One repetition is
shown for each such message, with the same signal number as the first message.
NOTE 2: The Context model in figure 7.1.2 is assumed in this call flow.
Figure 7.4.5.1: Mn signalling interactions for fallback from MONA procedures
to standard H.324 setup
When the MGCF requests that the MONA preferences negotiation is started, the
MGCF may also initiate standard H.245 signalling towards the IM-MGW that shall
only be sent in case the IM-MGW detects legacy interworking. The MGCF arms an
event to detect legacy interworking with an embedded signal descriptor
including an H.245 message out signal. The embedded H.245 signal is the intial
H.245 TCS+MSD signal to send in case fallback to legacy interworking is
detected.. The MGCF shall also request to be notified about a H.245 message on
the H.223 control channel. The MGCF shall also provision a multiplexing level
which will be advertised by the IM-MGW. (Signal 6).
If the IM-MGW detects a legacy interworking condition (signal 9), it shall
stop sending MONA preference messages. The IM-MGW shall engage in normal H.324
multiplexing level negotiations. In case the MGCF armed a legacy detection
event, the embedded H.245 signal shall be sent by the IM-MGW (signal 10). The
legacy detection event is sent to the MGCF (signal 11).
The MGCF shall upon detection of legacy interworking stop MONA procedures and
continue with standard H.245 call set up procedures, as depicted in Figure
E.4.2.4.1 in 3GPP TS 29.163 starting with step 9.
If the IM-MGW receives a normal H.245 message (not depicted), it shall also
forward this message to the MGCF. If the MGCF receives such a H.245 message
during the MONA call setup, and this H.245 message is a normal Terminal
Capability Set message, the MGCF shall also stop MONA procedures and continue
with standard H.245 call set up procedures, as depicted in Figure E.4.2.4.1 in
3GPP TS 29.163 starting with step 9.
# 8 Conclusions and recommendations
This technical report anlyses technical solutions the interworking of
multimedia calls. The procedures within the report will be transferred to TS
29.163 [2].
Control plane interworking procedures are detailed in Clause 5.
In Clause 7, different technical proposals fot the MGCF and IM-MGW
interactions are compared. The following two proposals were considered of
particular interest:
1\. Conveying H.245 related information over the Mn interface, as detailed in
Clause 7.2.1.
2\. H.245 Termination at the MGCF, as detailed in Clauses 7.3, using H.248
events and signals as transport, as detailed in Clause 7.3.1.1.
At plenary CT#35 it was decided that only option 2 is to be transferred to
normative text in the corresponding Technical Specification(s).
#