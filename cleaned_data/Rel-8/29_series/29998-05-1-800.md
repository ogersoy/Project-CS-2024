# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
**Structure of the OSA API Mapping (3GPP TR 29.998)**
The present document is part 5 subpart 1 of a multi-part deliverable covering
the Open Service Access (OSA); Application Programming Interface (API) Mapping
for OSA.
Table: Overview of the OSA APIs & Protocol Mappings 29.198 & 29.998-family
+-------+-------+-------+-------+-------+-------+-------+-------+ | OSA | OSA | | | | | | | | API | API | | | | | | | | spec | Ma | | | | | | | | ifica | pping | | | | | | | | tions | - | | | | | | | | 29. | 29. | | | | | | | | 198-f | 998-f | | | | | | | | amily | amily | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ove | 29.9 | Ove | | | | | | 98-01 | rview | 98-01 | rview | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | C | * | _Not | | | | | | 98-02 | ommon | 29.99 | A | | | | | | | Data | 8-02_ | pplic | | | | | | | D | | able _| | | | | | | efini | | | | | | | | | tions | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Fram | * |_ Not | | | | | | 98-03 | ework | 29.99 | A | | | | | | | | 8-03 _| pplic | | | | | | | | | able_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * | 2 | 2 | 2 | 2 | **2 | 2 | Ge | | *Call | 9.198 | 9.198 | 9.198 | 9.198 | 9.198 | 9.998 | neric | | Co | -04-1 | -04-2 | -04-3 | -04-4 | -04-5 | -04-1 | Call | | ntrol | | | | M | Conf. | | Co | | (CC) | C | Ge | M | ulti- | CC | | ntrol | | SCF** | ommon | neric | ulti- | media | SCF**| | -- | | | CC | CC | Party | CC | | | CAP | | | data | SCF | CC | SCF | | | ma | | | d | | SCF | | | | pping | | | efini | | | | | | | | | tions | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | |_29 |_ Ge | | | | | | | | .998- | neric | | | | | | | | 04-2 _| Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | INAP | | | | | | | | | map | | | | | | | | | ping_ | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | | _29 |_ Ge | | | | | | | | .998- | neric | | | | | | | | 04-3 _| Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | M | | | | | | | | | egaco | | | | | | | | | map | | | | | | | | | ping_ | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | | | | | 2 | Multi | | | | | | | | 9.998 | party | | | | | | | | -04-4 | Call | | | | | | | | | Co | | | | | | | | | ntrol | | | | | | | | | -- | | | | | | | | | ISC | | | | | | | | | ma | | | | | | | | | pping | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | User | **29\. | * | | | | | | 98-05 | I | 998-0 | _User | | | | | | | ntera | 5-1_ _| I | | | | | | | ction | | ntera | | | | | | | SCF | | ction | | | | | | | | | -- | | | | | | | | | CAP | | | | | | | | | mapp | | | | | | | | | ing_ _| | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | |_ 29 | _User | | | | | | | | .998- | I | | | | | | | | 05-2_ | ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | INAP | | | | | | | | | map | | | | | | | | | ping _| | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | |_ 29 | _User | | | | | | | | .998- | I | | | | | | | | 05-3_ | ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | M | | | | | | | | | egaco | | | | | | | | | map | | | | | | | | | ping _| | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | 2 | User | | | | | | | | 9.998 | I | | | | | | | | -05-4 | ntera | | | | | | | | | ction | | | | | | | | | -- | | | | | | | | | SMS | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Mob | 2 | User | | | | | | 98-06 | ility | 9.998 | S | | | | | | | SCF | -06-1 | tatus | | | | | | | | | and | | | | | | | | | User | | | | | | | | | Loc | | | | | | | | | ation | | | | | | | | | -- | | | | | | | | | MAP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | | | 2 | User | | | | | | | | 9.998 | S | | | | | | | | -06-2 | tatus | | | | | | | | | and | | | | | | | | | User | | | | | | | | | Loc | | | | | | | | | ation | | | | | | | | | -- | | | | | | | | | SIP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ter | * |_ Not | | | | | | 98-07 | minal | 29.99 | A | | | | | | | Ca | 8-07 _| pplic | | | | | | | pabil | | able_ | | | | | | | ities | | | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Data | 29.9 | Data | | | | | | 98-08 | Se | 98-08 | Se | | | | | | | ssion | | ssion | | | | | | | Co | | Co | | | | | | | ntrol | | ntrol | | | | | | | SCF | | -- | | | | | | | | | CAP | | | | | | | | | ma | | | | | | | | | pping | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * | _Ge | * |_ Not | | | | | | 29.19 | neric | 29.99 | A | | | | | | 8-09 _| Mess | 8-09_ | pplic | | | | | | | aging | | able _| | | | | | | SCF_ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | * | _Co | * |_ Not | | | | | | 29.19 | nnect | 29.99 | A | | | | | | 8-10 _| ivity | 8-10_ | pplic | | | | | | | Ma | | able _| | | | | | | nager | | | | | | | | | SCF_ | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Ac | * | _Not | | | | | | 98-11 | count | 29.99 | A | | | | | | | Manag | 8-11_ | pplic | | | | | | | ement | | able _| | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Cha | * |_ Not | | | | | | 98-12 | rging | 29.99 | A | | | | | | | SCF | 8-12 _| pplic | | | | | | | | | able_ | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | P | * | _Not | | | | | | 98-13 | olicy | 29.99 | A | | | | | | | Manag | 8-13_ | pplic | | | | | | | ement | | able _| | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Pre | * |_ Not | | | | | | 98-14 | sence | 29.99 | A | | | | | | | & | 8-14 _| pplic | | | | | | | Av | | able_ | | | | | | | ailab | | | | | | | | | ility | | | | | | | | | Manag | | | | | | | | | ement | | | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Multi | * | _Not | | | | | | 98-15 | Media | 29.99 | A | | | | | | | Mess | 8-15_ | pplic | | | | | | | aging | | able _| | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+ | 29.1 | Se | * |_ Not | | | | | | 98-16 | rvice | 29.99 | A | | | | | | | B | 8-16 _| pplic | | | | | | | roker | | able_ | | | | | | | SCF | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+
# 1 Scope
The present document investigates how the OSA User Interaction Interface Class
methods defined in 3GPP TS 29.198‑5 [5] can be mapped onto CAMEL Application
Part operations and Mobile Application Part operations.
The mapping of the OSA API to the CAP and relevant MAP operations is
considered informative, and not normative. An overview of the mapping TR is
contained in the introduction of the present document as well as in 3GPP TR
29.998-1 [10].
The OSA specifications define an architecture that enables application
developers to make use of network functionality through an open standardised
interface, i.e. the OSA APIs. The API specification is contained in the 3GPP
TS 29.198 series of specifications. An overview of these is available in the
introduction of the present document as well as in 3GPP TS 29.198-1 [1]. The
concepts and the functional architecture for the Open Service Access (OSA) are
described by 3GPP TS 23.198 [3]. The requirements for OSA are defined in 3GPP
TS 22.127 [2].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication > and/or edition number or version number) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 29.198-1: \"Open Service Access (OSA); Application Programming
Interface (API); Part 1: Overview\".
[2] 3GPP TS 22.127: \"Service Requirement for the Open Services Access (OSA);
Stage 1\".
[3] 3GPP TS 23.198: \"Open Service Access (OSA); Stage 2\".
[4] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[5] 3GPP TS 29.198-5: \"Open Service Access (OSA); Application Programming
Interface (API); Part 5: Generic user interaction\".
[6] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[7] 3GPP TS 29.078: \"Customised Applications for Mobile network Enhanced
Logic (CAMEL); CAMEL Application Part (CAP) specification\".
[8] 3GPP TS 22.101: \"Service Aspects; Service Principles\".
[9] ITU-T Recommendation Q.850: \"Usage of cause and location in the Digital
Subscriber Signalling System No. 1 and the Signalling System No. 7 ISDN User
Part\".
[10] 3GPP TR 29.998-1: \"Open Service Access (OSA); Application Programming
Interface (API) Mapping for OSA; Part 1: General Issues on API Mapping\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TS 29.198-1 [1] apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TS
29.198-1 [1] apply.
# 4 Generic Message Transfer Service CAMEL Call Flows
## 4.1 User Interaction
The User Interaction interface is used by applications to interact with end
users. The API only supports Call User Interaction.
### 4.1.1 createUI
**_createUI_** is a method that is used to create a new (non call related)
user interaction object.
NOTE: There are no associated CAP call flows.
Figure 4-1: Call Flow for createUI
Table 4-1: Normal Operation
* * *
Pre-conditions The application has been instructed to initiate a non call
related User Interaction 1 The application invokes the **_createUI_** method 2
The SCS creates a new UI object
* * *
**Parameter Mapping**
None.
### 4.1.2 createUICall
**_createUICal_** is a method that is used to create a new call related user
interaction object.
NOTE: There are no associated CAP call flows.
Figure 4-2: Call Flow for createUICall
Table 4-2: Normal Operation
* * *
Pre-conditions The application has been requested to initiate a call related
User Interaction 1 The application invokes the **_createUICall_** method 2 The
SCS creates a new **_UICall_** object
* * *
**Parameter Mapping**
None.
### 4.1.3 enableUINotification
**_enableUINotification_** is a method that enables the reception of a user
initiated user interaction.
Figure 4-3: Call Flow for enableUINotification
Table 4-3: Normal Operation
* * *
Pre-conditions An agreement is established between the network operator\ and
the service provider for the event notification to be enabled
1 The application invokes the **_enableUINotification_** method
2 The SCS stores the request
* * *
**Parameter Mapping**
None.
### 4.1.4 disableUINotification
**_disableUINotification_** is a method that allows the application to remove
notification for UI related actions previously set.
Figure 4-4: Call Flow for disableUINotification
Table 4-4: Normal Operation
* * *
Pre-conditions An agreement is established between the network operator\ and
the service provider for the event notification to be disabled
1 The application invokes the **_disableUINotification_** method
2 The request is disabled in the SCS.
* * *
**Parameter Mapping**
None.
### 4.1.5 userInteractionEventNotify
**_userInteractionEventNotify_** is a method that notifies the application of
a user initiated request for user interaction.
Figure 4-5: Call Flow for userInteractionEventNotify
Table 4-4: Normal Operation
* * *
Pre-conditions  
1 The gsmSCF receives a MAP **_processUnstructuredSS-Request_** message from
the HLR. This operation may be preceded by MAP **_beginSubscriberActivity (see
note)_** 2 The gsmSCF sends an equivalent internal message to the SCS 3 The
SCS identified the correct application that enable the notification request
from the subscriber and invokes the **_userInteractionEventNotify_** method
NOTE: The MAP beginSubscriberActivity is sent in case of MAP version 1.
* * *
Table 4-5: Parameter Mapping
+-------------------------------------+----------------------------------+ | From: processUnstructuredSS-Request | To: _userInteractionEventNotify_ | +-------------------------------------+----------------------------------+ | | ui | +-------------------------------------+----------------------------------+ | | eventInfo (TpCallEventInfo): | +-------------------------------------+----------------------------------+ | msisdn | OriginatingAddress | +-------------------------------------+----------------------------------+ | | DestinationAddress | +-------------------------------------+----------------------------------+ | | ServiceCode | +-------------------------------------+----------------------------------+ | | DataTypeIndication | +-------------------------------------+----------------------------------+ | ussd-DataCodingScheme | DataString | | | | | ussd-String | | +-------------------------------------+----------------------------------+ | | assignmentID | +-------------------------------------+----------------------------------+ | | appInterface (output) | +-------------------------------------+----------------------------------+
### 4.1.6 userInteractionAborted
**_userInteractionAborted_** is a method that indicates to the application
that the User Interaction service instance has terminated or closed
abnormally. No further communication will be possible between the User
Interaction service instance and the application.
Figure 4-6: Call Flow for userInteractionAborted (scenario 1)
Figure 4-7: Call Flow for userInteractionAborted (scenario 2)
**Parameter Mapping**
None.
### 4.1.7 userInteractionNotificationInterrupted
**_userInteractionNotificationInterrupted_** is a method that indicates to the
application that all user interaction event notifications have been
temporarily interrupted.
Figure 4-8: Call Flow for userInteractionNotificationInterrupted
Table 4-6: Normal Operation
* * *
Pre-conditions User interaction event notifications have been enabled using\
the _enableUINotification_ method on the UIManager interface
1 The SCS has detected, or has been informed of, a fault which prevents
further user interaction events from being notified
2 The SCS invokes the **_userInteractionNotificationInterrupted_** method
* * *
**Parameter Mapping**
None.
### 4.1.8 userInteractionNotificationContinued
**_userInteractionNotificationContinued_** is a method that indicates to the
application that user interaction event notifications will again be possible.
Figure 4-9: Call Flow for userInteractionNotificationContinued
Table 4-7: Normal Operation
* * *
Pre-conditions User interaction event notifications have been interrupted\ and
_userInteractionNotificationInterrupted_ method has been invoked
1 The SCS detects that user interaction event notifications are again possible
2 The SCS invokes the **_userInteractionNotificationContinued_** method
* * *
**Parameter Mapping**
None.
### 4.1.9 userInteractionFaultDetected
**_userInteractionFaultDetected_** is a method that indicates to the
application that a fault has been detected in the user interaction. This
method is invoked e.g. if the call has been deassigned.
Figure 4-10: Call Flow for userInteractionFaultDetected (scenario 1)
Figure 4-11: Call Flow for userInteractionFaultDetected (scenario 2)
Three Alternatives have been identified:
1\. USSD based interaction between the MS and the gsmSCF (see table 4-8).
2\. Interaction between a gsmSRF internal to the gsmSSF and the gsmSCF (see
table 4-9).
3\. Interaction between a gsmSRF and the gsmSCF (see table 4-10).
Table 4-8: Normal Operation
* * *
Pre-conditions USSD interaction is in progress and a dialogue is running
between the HLR and gsmSCF 1 The gsmSCF detects or receives an indication that
the there is an error in the user interaction 2 The gsmSCF sends an equivalent
internal message to the SCS 3 The SCS invokes the
**_userInteractionFaultDetected_** method to the appropriate application
* * *
Table 4-9
* * *
Pre-conditions User interaction is in progress between the gsmSRF and the
gsmSCF 1 The gsmSCF detects or receives an indication that there is an error
in the user interaction 2 The gsmSCF sends an equivalent internal message to
the SCS 3 The SCS invokes the **_userInteractionFaultDetected_** method to the
appropriate application
* * *
Table 4-10
* * *
Pre-conditions User interaction is in progress between the gsmSRF and the
gsmSCF 1 The gsmSCF detects or receives an indication that the there is an
error in the user interaction 2 The gsmSCF sends an equivalent internal
message to the SCS 3 The SCS invokes the **_userInteractionFaultDetected_**
method to the appropriate application
* * *
Table 4-11: Parameter Mapping
* * *
From: Dialogue Error To: _userInteractionFaultDetected_
userInteractionIdentifier fault ReturnError
* * *
### 4.1.10 sendInfoReq
**_sendInfoReq_** is an asynchronous method that sends information to the
user.
Figure 4-12: Call Flow for sendInfoReq (scenario 1)
Figure 7-13: Call Flow for sendInfoReq (scenario 2)
Three Alternatives have been identified:
1\. USSD based interaction between the MS and the gsmSCF (see table 4-12).
2\. Interaction between a gsmSRF internal to the gsmSSF and the gsmSCF (see
table 4-13).
3\. Interaction between a gsmSRF internal to the gsmSSF and the gsmSCF (see
table 4-14).
Table 4-12: Normal Operation
* * *
Pre-conditions USSD interaction 1 The application invokes the sendInfo method
2 The SCS sends an equivalent internal message to the gsmSCF 3 The gsmSCF
sends a MAP **_UnstructuredSS-Notify_** message to the HLR. If
processUnstructuredSS-Request was previously received its result component may
be sent containing ussd-DataCodingScheme and ussd-String (see note) NOTE: For
call-related USSD cases, the USSD is sent to the calling party.
* * *
Table 4-13
* * *
Pre-conditions  
1 The application invokes the **_sendInfoReq_** method 2 The SCS sends an
equivalent internal message to the gsmSCF 3 The gsmSCF is aware of a gsmSRF
internal to the gsmSSF. The gsmSCF sends CAP **_ConnectToResource_** , and CAP
**_PlayAnnouncement_** messages the gsmSSF (see note) NOTE: The user
interaction shall apply to all parties connected to the call segment for the
user interactions initiated by the connectToResource and
establishTemporaryConnection operations.
* * *
Table 4-14
* * *
Pre-conditions  
1 The application invokes the **_sendInfoReq_** method 2 The SCS sends an
equivalent internal message to the gsmSCF 3 The gsmSCF is aware of an external
gsmSRF. The gsmSCF sends CAP **_EstablishTemporaryConnection_** message the
gsmSSF 4 On receipt of the CAP **_AssistRequestInstructions_** message from
the gsmSRF, the gsmSCF sends the CAP **_PlayAnnouncement_** message to the
gsmSRF (see note) NOTE: The user interaction shall apply to all parties
connected to the call segment for the user interactions initiated by the
**_connectToResource_** and **_establishTemporaryConnection_** operations.
* * *
Table 4-15: Parameter Mapping
+--------------------------+-------------------------------+ | From: sendInfoReq | To: MAP unstructuredSS-Notify | +--------------------------+-------------------------------+ | userInteractionSessionID | | +--------------------------+-------------------------------+ | info (choice) | | +--------------------------+-------------------------------+ | infoID | | +--------------------------+-------------------------------+ | infoData | ussd-DataCodingScheme | | | | | | ussd-String | +--------------------------+-------------------------------+ | infoAddress | | +--------------------------+-------------------------------+ | variableInfoSet | | +--------------------------+-------------------------------+ | repeatIndicator | | +--------------------------+-------------------------------+ | responseRequested | | +--------------------------+-------------------------------+ | assignmentID | | +--------------------------+-------------------------------+ | | alertingPattern | +--------------------------+-------------------------------+ | | msisdn | +--------------------------+-------------------------------+
Table 4-16
+--------------------------+------------------------------------------+ | From: sendInfoReq | To: CAP PlayAnnouncement | +--------------------------+------------------------------------------+ | userInteractionSessionID | | +--------------------------+------------------------------------------+ | **info (choice)** | InformationToSend (choice) | | | | | **infoID** | inbandInfo | | | | | | messageID (choice) | | | | | | elementaryMessageID | | | | | | text | | | | | | messageContent | | | | | | attributes | | | | | | elementaryMessageIDs | | | | | | variableMessage | | | | | | elementaryMessageID variableParts | | | | | | (sequence of the following choices) | | | | | | integer | | | | | | number | | | | | | time | | | | | | date | | | | | | price | | | | | | numberOfRepetitions | | | | | | duration | | | | | | interval | | | | | | tone | | | | | | toneID | | | | | | duration | +--------------------------+------------------------------------------+ | infoData | | +--------------------------+------------------------------------------+ | infoAddress | | +--------------------------+------------------------------------------+ | variableInfoSet | The contents are directly mapped to | | | variableParts above | +--------------------------+------------------------------------------+ | variablePartInteger | | +--------------------------+------------------------------------------+ | variablePartAddress | | +--------------------------+------------------------------------------+ | variablePartTime | | +--------------------------+------------------------------------------+ | variablePartDate | | +--------------------------+------------------------------------------+ | variablePartPrice | | +--------------------------+------------------------------------------+ | repeatIndicator | This integer value is directly mapped to | | | numberOfRepetitions above | +--------------------------+------------------------------------------+ | | disconnectFromIPForbidden (according to | | | responseRequested) | +--------------------------+------------------------------------------+ | responseRequested | requestAnnouncementComplete | +--------------------------+------------------------------------------+ | assignmentID | | +--------------------------+------------------------------------------+
### 4.1.11 sendInfoRes
**_sendInfoRes_** is an asynchronous method that informs the application about
the start or the completion of a **_sendInfoReq()_**. This response is called
only if the application has requested a response.
Figure 4-14: Call Flow for sendInfoRes (scenario 1)
Figure 4-15: Call Flow for sendInfoRes (scenario 2)
Three Alternatives have been identified:
1\. USSD based interaction between the MS and the gsmSCF (see table 4-17).
2\. Interaction between a gsmSRF internal to the gsmSSF and the gsmSCF (see
table 4-18).
3\. Interaction between a gsmSRF internal to the gsmSSF and the gsmSCF (see
table 4-19).
Table 4-17: Normal Operation
* * *
Pre-conditions The application has previously invoked the _sendInfoReq_
method\ and has requested a notification
1 The gsmSCF receives an MAP unstructured** _SS-Notify acknowledgement_**
message from the HLR
2 The gsmSCF sends an equivalent internal message to the SCS
3 The SCS identifies the correct application and invokes the **_sendInfoRes_**
method
* * *
Table 4-18
* * *
Pre-conditions The application has previously invoked the _sendInfoReq_
method\ and has requested a notification
1 The gsmSCF receives a CAP **_SpecialisedResourceReport_** message from the
gsmSSF indicating that the announcement has been played to the subscriber
2 The gsmSCF sends an equivalent internal message to the SCS
3 The SCS identifies the correct application and invokes the **_sendInfoRes_**
method
* * *
Table 4-19
* * *
Pre-conditions The application has previously invoked the _sendInfoReq_
method\ and has requested a notification
1 The gsmSCF receives a CAP **_SpecialisedResourceReport_** message from the
gsmSRF indicating that the announcement has been played to the subscriber
2 The gsmSCF sends an equivalent internal message to the SCS
3 The SCS identifies the correct application and invokes the **_sendInfoRes_**
method
* * *
Table 4-20: Parameter Mapping
* * *
From: CAP SpecialisedResourceReport To: sendInfoRes userInteractionSessionID
assignmentID response
* * *
### 4.1.12 sendInfoErr
**_sendInfoErr_** is an asynchronous method that indicates that the request to
send information was unsuccessful.
Figure 4-16: Call Flow for sendInfoErr (scenario 1)
Figure 4-17: Call Flow for sendInfoErr (scenario 2)
Table 4-21: Normal Operation
+----------------------------------+----------------------------------+ | Pre-conditions | The application has previously | | | invoked the _sendInfoReq_ method | +----------------------------------+----------------------------------+ | 1 | The gsmSCF receives a message | | | from the either the HLR, the | | | gsmSSF or the gsmSRF indicating | | | an error in the previous | | | **_sendInfoReq_** method. | | | Alternatively the gsmSCF may | | | internal detect that the | | | application has incorrectly sent | | | the information | +----------------------------------+----------------------------------+ | 2 | The gsmSCF sends an equivalent | | | internal message to the SCS | +----------------------------------+----------------------------------+ | 3 | The SCS identifies the correct | | | application and invokes the | | | **_sendInfoErr_** method | +----------------------------------+----------------------------------+ | For: | | | | | | 1. USSD based interaction | | | between the MS and the CSE. | | | | | | 2. Interaction between a gsmSRF | | | internal to the gsmSSF and the | | | CSE. | | | | | | 3. Interaction between a gsmSRF | | | internal to the gsmSSF and the | | | CSE. | | +----------------------------------+----------------------------------+
Table 4-22: Parameter Mapping
* * *
From: TCAP Return Error To: sendInfoErr userInteractionSessionID InvokeID
assignmentID Error error
* * *
### 4.1.13 sendInfoAndCollectReq
**_sendInfoAndCollectReq_** is an asynchronous method that plays an
announcement or sends other information to the user and collects some
information from the user. The announcement usually prompts for a number of
characters (for example, these are digits or text strings such as \"YES\" if
the user's terminal device is a phone).
Figure 4-18: Call Flow for sendInfoAndCollectReq (scenario 1)
Figure 4-19: Call Flow for sendInfoAndCollectReq (scenario 2)
Three Alternatives have been identified:
1\. USSD based interaction between the MS and the gsmSCF (see table 4-23).
2\. Interaction between a gsmSRF internal to the gsmSSF and the gsmSCF (see
table 4-24).
3\. Interaction between a gsmSRF internal to the gsmSSF and the gsmSCF (see
table 4-25).
Table 4-23: Normal Operation
* * *
Pre-conditions USSD interaction 1 The application invokes the
**_sendInfoAndCollectReq_** method 2 The SCS sends an equivalent internal
message to the gsmSCF 3 The gsmSCF sends a MAP **_unstructuredSS-Request
message_**
* * *
Table 4-24
* * *
Pre-conditions  
1 The application invokes the **_sendInfoAndCollectReq_** method 2 The SCS
sends an equivalent internal message to the gsmSCF 3 The gsmSCF is aware of a
gsmSRF internal to the gsmSSF. The gsmSCF sends CAP **_ConnectToResource_**
and **_PromptAndCollectUserInformation_** messages the gsmSSF
* * *
Table 4-25
* * *
Pre-conditions  
1 The application invokes the **_sendInfoAndCollectReq_** method 2 The SCS
sends an equivalent internal message to the gsmSCF 3 The gsmSCF is aware of an
external gsmSRF. The gsmSCF sends CAP **_EstablishTemporaryConnection_** ,
message the gsmSSF 4 On receipt of the CAP **_AssistRequestInstructions_**
message from the gsmSRF, the gsmSCF sends the CAP
**_PromptAndCollectUserInformation_** message to the gsmSRF
* * *
Table 4-26: Parameter Mapping
+-----------------------------+--------------------------------+ | From: sendInfoAndCollectReq | To: MAP unstructuredSS-Request | +-----------------------------+--------------------------------+ | userInteractionSessionID | | +-----------------------------+--------------------------------+ | info (choice) | | +-----------------------------+--------------------------------+ | infoID | | +-----------------------------+--------------------------------+ | infoData | ussd-DataCodingScheme | | | | | | ussd-String | +-----------------------------+--------------------------------+ | infoAddress | | +-----------------------------+--------------------------------+ | variableInfo | | +-----------------------------+--------------------------------+ | criteria | | +-----------------------------+--------------------------------+ | responseRequested | | +-----------------------------+--------------------------------+ | | alertingPattern | +-----------------------------+--------------------------------+ | | msisdn | +-----------------------------+--------------------------------+ | assignmentID | | +-----------------------------+--------------------------------+
Table 4-27
+-----------------------------+---------------------------------------+ | From: sendInfoAndCollectReq | To: CAP | | | PromptAndCollectUserInformation | +-----------------------------+---------------------------------------+ | userInteractionSessionID | | +-----------------------------+---------------------------------------+ | | disconnectFromIPForbidden (always | | | true) | +-----------------------------+---------------------------------------+ | info (choice) | | +-----------------------------+---------------------------------------+ | infoID | InformationToSend (choice) | | | | | | inbandInfo | | | | | | messageID (choice) | | | | | | elementaryMessageID | | | | | | text | | | | | | messageContent | | | | | | attributes | | | | | | elementaryMessageIDs | | | | | | variableMessage | | | | | | elementaryMessageID variableParts | | | | | | (sequence of the following choices) | | | | | | integer | | | | | | number | | | | | | time | | | | | | date | | | | | | price | | | | | | numberOfRepetitions | | | | | | duration | | | | | | interval | | | | | | tone | | | | | | toneID | | | | | | duration | +-----------------------------+---------------------------------------+ | infoData | | +-----------------------------+---------------------------------------+ | infoAddress | | +-----------------------------+---------------------------------------+ | variableInfo | The contents are directly mapped to | | | variableParts above | +-----------------------------+---------------------------------------+ | variablePartInteger | | +-----------------------------+---------------------------------------+ | variablePartAddress | | +-----------------------------+---------------------------------------+ | variablePartTime | | +-----------------------------+---------------------------------------+ | variablePartDate | | +-----------------------------+---------------------------------------+ | variablePartPrice | | +-----------------------------+---------------------------------------+ | criteria | collectedInfo | +-----------------------------+---------------------------------------+ | | collectedDigits | +-----------------------------+---------------------------------------+ | minLength | minimumNbOfDigits | +-----------------------------+---------------------------------------+ | maxLength | maximumNbOfDigits | +-----------------------------+---------------------------------------+ | endSequence | endOfReplyDigit | +-----------------------------+---------------------------------------+ | | cancelDigit | +-----------------------------+---------------------------------------+ | | startDigit | +-----------------------------+---------------------------------------+ | startTimeout | firstDigitTimeOut | +-----------------------------+---------------------------------------+ | interCharTimeout | interDigitTimeOut | +-----------------------------+---------------------------------------+ | | errorTreatment | +-----------------------------+---------------------------------------+ | | interruptableAnnInd | +-----------------------------+---------------------------------------+ | | voiceInformation | +-----------------------------+---------------------------------------+ | | voiceBack | +-----------------------------+---------------------------------------+ | responseRequested | | +-----------------------------+---------------------------------------+ | assignmentID | | +-----------------------------+---------------------------------------+
### 4.1.14 sendInfoAndCollectRes
**_sendInfoAndCollectRes_** is an asynchronous method that returns the
information collected to the application.
Figure 4-20: Call Flow for sendInfoAndCollectRes (scenario 1)
Figure 4-21: Call Flow for sendInfoAndCollectRes (scenario 2)
Two Alternatives have been identified:
1\. USSD based interaction between the MS and the gsmSCF (see table 4-28).
2\. Interaction with an gsmSRF internal to gsmSSF or external (see table
4-29).
Table 4-28: Normal Operation
* * *
Pre-conditions The application has invoked a _sendInfoAndCollectReq_() 1 The
gsmSCF receives a MAP **_UnstructuredSS-Request acknowledgement_** message
from the HLR 2 The gsmSCF sends an equivalent internal message to the SCS 3
The SCS invokes the **_sendInfoAndCollectRes_** method to the correct
applications
* * *
Table 4-29
* * *
Pre-conditions The application has invoked a _sendInfoAndCollectReq_() 1 The
gsmSCF receives a TCAP **ReturnResult** from the gsmSSF or the gsmSRF
depending on whether a direct or indirect gsmSRF is used containing the
Received Information 2 The gsmSCF sends an equivalent internal operation to
the SCS 3 The SCS identifies the correct application instance and invokes the
**_sendinfoAndCollectRes_** method
* * *
Table 4-30: Parameter Mapping
+-----------------------------------------+---------------------------+ | From: MAP unstructuredSS-Request | To: sendInfoAndCollectRes | | acknowledgement | | +-----------------------------------------+---------------------------+ | | userInteractionSessionID | +-----------------------------------------+---------------------------+ | | assignmentID | +-----------------------------------------+---------------------------+ | | **response** | +-----------------------------------------+---------------------------+ | ussd-DataCodingScheme | info | | | | | ussd-String | | +-----------------------------------------+---------------------------+
Table 4-31
* * *
From: TCAP Return Result (Received Information) To: sendInfoAndCollectRes
userInteractionSessionID assignmentID response DigitsResponse info (only the
digits are mapped)
* * *
### 4.1.15 sendInfoAndCollectErr
**_sendInfoAndCollectErr_** is an asynchronous method that indicates that the
request to send information and collect a response was unsuccessful.
Figure 4-22: Call Flow for sendInfoAndCollectErr
Two Alternatives have been identified:
1\. USSD based interaction between the MS and the gsmSCF (see table 4-32).
2\. Interaction with an gsmSRF internal to gsmSSF or external gsmSRF (see
table 4-33).
Table 4-32: Normal Operation
* * *
Pre-conditions The application has invoked a _sendInfoAndCollectReq_() 1 The
gsmSCF detects an error in the **_sendInfoAndCollectReq_** method or receives
a message form the HLR indicating an error that there is an error in
**_sendInfoAndCollectReq_** method 2 The gsmSCF sends an equivalent internal
message to the SCS 3 The SCS invokes the **_sendInfoAndCollectErr_** method to
the correct application
* * *
Table 4-33
* * *
Pre-conditions The application has invoked a _sendInfoAndCollectReq_() 1 The
gsmSCF either detects and error or receives a TCAP **_Error_** from the gsmSSF
or the gsmSRF depending on whether a direct or indirect gsmSRF is used 2 The
gsmSCF sends an equivalent internal operation to the SCS 3 The SCS identifies
the correct application instance and invokes the **_sendInfoAndCollectErr_**
method
* * *
Table 4-34: Parameter Mapping
* * *
**From: TCAP** Return Error To: sendInfoAndCollectErr userInteractionSessionID
assignmentID error error
* * *
### 4.1.16 release
**_release_** is a method that requests that the relationship between the
application and the user interaction object be released. It causes the release
of the used user interaction resources and interrupts any ongoing user
interaction.
Figure 4-23: Call Flow for release
Two Alternatives have been identified:
1\. USSD based interaction.
2\. Interaction with a gsmSRF internal to gsmSSF or external gsmSRF (see table
4-36).
Table 4-35: Normal Operation
* * *
Pre-conditions The gsmSCF has an open dialogue with the HLR 1 The application
invokes a **_release_** 2 The SCS sends an equivalent internal message to the
gsmSCF 3 The gsmSCF sends a TCAP **_Abort_** message to the HLR if appropriate
* * *
Table 4-36
* * *
Pre-conditions The application has previously invoked the
_sendInfoAndCollectErr_.\ The gsmSCF is waiting for a response form the user
1 The application invokes a release
2 The SCS sends an equivalent internal message to the gsmSCF
3 The gsmSCF sends a CAP **_DisconnectForwardConnection_** to the gsmSSF
* * *
Table 4-37: Parameter Mapping
+--------------------------+--------------------+ | From: release | To: Dialogue Error | +--------------------------+--------------------+ | userInteractionSessionID | | +--------------------------+--------------------+ | | TC-U-ABORT | | | | | | TC-P-ABORT | +--------------------------+--------------------+
Table 4-38:
* * *
From: release To: CAP DisconnectForwardConnection userInteractionSessionID
* * *
### 4.1.17 abortActionReq
**_abortActionReq_** is an asynchronous method that aborts a user interaction
operation, e.g. a **_sendInfoReq_** , from the specified call. The call
remains otherwise unaffected. The user interaction call service interrupts the
current action on the specified call.
Figure 4-24: Call Flow for abortActionReq
Table 4-39: Normal Operation
* * *
Pre-conditions The application has previously invoked e.g. the
_sendInfoAndCollectReq_.\ The gsmSCF is waiting for a response form the user
1 The application invokes a **_abortActionReq_**
2 The SCS sends an equivalent internal message to the gsmSCF
3 The gsmSCF sends a CAP **_Cancel_** message to the gsmSSF or the gsmSRF as
appropriate and may send a CAP **_DisconnectForwardConnection_** to the gsmSSF
if appropriate
* * *
Table 4-40: Parameter Mapping
* * *
From: abortActionReq To: CAP Cancel userInteractionSessionID  
assignmentID InvokeID allRequests
* * *
### 4.1.18 abortActionRes
**_abortActionRes_** is an asynchronous method that confirms that the request
to abort a user interaction operation on a call was successful.
Figure 4-25: Call Flow for abortActionRes
There is no equivalent CAP/MAP mapping message.
Table 4-41: Normal Operation
* * *
Pre-conditions The application has previously invoked the _abortActionReq_.\
The gsmSCF has sent the necessary instruction to the gsmSSF or the gsmSRF\ and
is running a timer awaiting for any possible error return message.\ This timer
expires and no errors are returned
2 The gsmSCF determines that the CAP **_Cancel_** operation was successful.
The gsmSCF sends an equivalent internal message to the SCS
3 The SCS invokes the **_abortActionRes_** method to the appropriate
application.
* * *
### 4.1.19 abortActionErr
**_abortActionErr_** is an asynchronous method that indicates that the request
to abort a user interaction on a call resulted in an error.
Figure 4-26: Call Flow for abortActionErr
Table 4-42: Parameter Mapping
* * *
From: TCAP error primitive To: _abortActionErr_ userInteractionSessionID
assignmentID TC-U-ERROR error
* * *
#