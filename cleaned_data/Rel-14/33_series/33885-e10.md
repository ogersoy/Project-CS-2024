# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document contains a study of the security aspects of V2X services
and an evaluation of possible technical solutions needed to support such
services. The Stage 1 requirements for these services are defined in TS 22.185
[2]. Potential stage 2 solutions for V2X Services are being studied in TR
23.785[3].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.185: \"Service requirements for V2X services\".
[3] 3GPP TR 23.785: \"Study on architecture enhancements for LTE support of
V2X services\".
[4] 3GPP TR 22.885: \"Study on LTE support for Vehicle to Everything (V2X)
services\".
[5] Angermeier, Daniel, Alexander Kiening and Frederic Stumpf. "PAL - Privacy
Augmented LTE: A Privacy-Preserving Scheme for Vehicular LTE Communication".
_The Tenth ACM International Workshop on VehiculAr Inter-NETworking, Systems,
and Applications_ _(ACM VANET), 2013_.
[6] ETSI TS 102 940: \"Intelligent Transport Systems (ITS); Security; ITS
communications security architecture and security management\".
[7] 3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network
layer security\".
[8] 3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework
(AF)\".[9] 3GPP TS 23.303: \"Proximity-based Services (ProSe); Stage 2\".
[10] 3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS);
Architecture and functional description\".
[11] 3GPP TS 23.285: \"Architecture enhancements for V2X services, stage 2\".
[12] 3GPP TS 33.303: "Proximity-based Services(ProSe); Security aspects"
[13] 3GPP TS 33.401: \"3GPP System Architecture Evolution; Security
architecture\".
[14] 3GPP TS 33.402: \"3GPP System Architecture Evolution; Security aspects of
non-3GPP accesses\".
[15] IETF RFC 6507: \"Elliptic Curve-Based Certificateless Signatures for
Identity-Based Encryption (ECCSI)\".
[16] IETF RFC 6508: \"Sakai-Kasahara Key Encryption (SAKKE)\".
[17] IETF RFC 6509: \"MIKEY-SAKKE: Sakai-Kasahara Key Encryption in Multimedia
Internet KEYing (MIKEY)\".
[18] IEEE Std.1609.2: \"Wireless Access in Vehicular Environments-Security
Services for Applications and Managements Messages\".
[19] NHTSA, report number DOT HS 812 014: \"Vehicle-to-Vehicle Communications:
Readiness of V2V Technology for Application\"
[20] ETSI TS 102 225: \"Smart Cards; Secured packet structure for UICC based
applications\".
[21] ETSI TS 102 226: \"Smart cards; Remote APDU structure for UICC based
applications\".
[22] 3GPP TS 31.115: \"Secured packet structure for (Universal) Subscriber
Identity Module (U)SIM Toolkit applications\".
[23] 3GPP TS 31.116: \"Remote APDU Structure for (U)SIM Toolkit applications
\".
[24] 3GPP TS 33.222: \"Generic Authentication Architecture (GAA); Access to
network application functions using Hypertext Transfer Protocol over Transport
Layer Security (HTTPS)\".
[25] 3GPP TS 33.220: \"Generic Authentication Architecture (GAA); Generic
Bootstrapping Architecture (GBA)\".
[26] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[27] 3GPP TS 33.223: \"Generic Authentication Architecture (GAA); Generic
Bootstrapping Architecture (GBA) Push function\".
[28] 3GPP TS 23.468: "Group Communication System Enablers for LTE (GCSE_LTE);
Stage 2".
[29] 3GPP TR 33.888: "Study on security issues to support Group Communication
System Enabler (GCSE) for LTE".
[30]
[https://ec.europa.eu/transport/sites/transport/files/themes/its/road/action_plan/doc/c-its-
platform/2016_annexes_to_the_c-
its_platform_final_report_january_2016.zip]{.underline}, European Commission
report on privacy.
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**LTE-V system entity** : A cellular network entity or V2X communication
entity.
**Personally identifiable information (PII):** Any information that (a) can be
used to identify a subscriber to whom such information relates, or (b) is or
might be directly or indirectly linked to a subscriber.
**Pseudonymity** : The condition when the processing of personally
identifiable information (PII) is such the data can no longer be attributed to
a specific subscriber without the use of additional information, as long as
such additional information is kept separately and subject to technical and
organisational measures to ensure non-attribution to an identified or
identifiable subscriber.
The following terms defined in TR 22.885 [4] are used in the present document:
**Road Side Unit**
**V2I Service**
**V2N Service**
**V2P Service**
**V2V Service**
**V2X Service**
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply.\ An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
AS Application Server
CA Certificate Authority
CME Certificate Management Entity
CRL Certificate Revocation List
DSA Digital Signature Algorithm
DSRC Dedicated Short Range Communication
LTE-V LTE V2X
ECIES Elliptic Curve Integrated Encryption Scheme
ECDSA Elliptic Curve DSA
ECCSI Elliptic Curve-based Certificateless Signatures for Identity-based
Encryption
GPS Global Positioning System
ID Identity
ITS Intelligent Transportation System
KMS Key Management System
KMF Key Management Function
> LME Local MBMS Entity
MIKEY Multimedia Internet Keying
OEM Original Equipment manufacturer
PSSME Provider Service Security Management Entity
PDU Protocol Data Unit
PCA Pseudonym Certificate Authority
ProSe Proximity-based Services
> PMK ProSe MIKEY Key
PVT Public Validation Token
PMSI Pseudonymous Mobile Subscriber ID
RSU Road Side Unit
RSK Receiver Secret Key
SAKKE Sakai-Kasahara Key Encryption
SSK Secret Signing Key
SAP Service Access Point
TIMF Temporary Identity Management Function
V2I Vehicle-to-Infrastructure
V2N Vehicle-to-Network
V2P Vehicle-to-Pedestrian
V2V Vehicle-to-Vehicle
V2X Vehicle-to-Everything
VCF V2X Control Function
WAVE Wireless Access in Vehicular Environments
# 4 Overview of V2X Services
## 4.1 Introduction
V2X Service contains three types of vehicular communication services (V2V
(vehicle to vehicle), V2I/N (vehicle to infrastructure/network), and V2P
(vehicle to pedestrian)) for both safety and non-safety aspects. The overall
architecture for V2X services is given in TS 23.285 [11]. The present document
covers security aspect for LTE support for vehicular communication services.
Security issues along with identified threats and security requirements are
described in clause 5 of the present document, while the proposed security
solutions to support V2X services are described in clause 6 of the present
document (which refers back to clause 5 as necessary).
## 4.2 Architecture
The overall architecture for V2X services is described in TS 23.285[11]. Both
LTE-Uu based architecture (e.g. eMBMS) and PC5 based architecture are used for
supporting V2X services, but they may be used by a UE independently for
transmission and reception, e.g. a UE can use eMBMS for reception without
using LTE-Uu for transmission.
### 4.2.1 Architectural Assumptions
\- Both LTE-Uu based architecture (e.g. eMBMS) and PC5 based architecture are
used for supporting V2X services.
\- The LTE-Uu and PC5 based architecture may be used by a UE independently for
transmission and reception, e.g. a UE can use eMBMS for reception without
using LTE-Uu for transmission.
NOTE 1: A UE using LTE-Uu based architecture for V2X communication may receive
V2X message via unicast downlink.
\- Within the context of this study, RSU is viewed as a V2X application
receiving V2X messages via SGi, PC5 or LTE-Uu interface.
\- V2X Application Servers e.g. in different domains can communicate with each
other for the exchange of V2X messages. The interface between V2X Application
Servers and the methods of the exchange of messages between V2X Application
Servers is out of scope of 3GPP.
\- ProSe discovery like feature is not required for V2X Services (TS 23.303
[5] clause 5.3 ProSe Direct Discovery).
NOTE 2: ProSe discovery function can be used by a V2X supporting UE but that
is up to UE implementation.
NOTE 3: In this present document, it is assumed that V2X application can
handle the user authenticity and message integrity. It is SA3 responsibility
to determine if such assumptions are correct.
\- Subject to regional regulations, lawful interception requirements may apply
to V2X Services.
### 4.2.2 PC5 and LTE-Uu based V2X architecture reference model
Figure 4.2.2-1: Non-roaming reference architecture for V2X (PC5 and LTE-Uu
based)
Figure 4.2.2-2: Roaming reference architecture for V2X (PC5 and LTE-Uu based)
The new functions are defined as following:
V2X Control Function: the logical function that is used for network related
actions required for V2X.
The reference points are defined as following:
V1: The reference point between a V2X application and the V2X Application
Server.
V2: This is the reference point between the V2X Application Server and the V2X
Control Function in the operator\'s network. The V2X Application Server may
connect to V2X Control Functions belonging to multiple PLMNs.
V3: This is the reference point between a V2X enabled UE and the V2X Control
Function in the operator\'s network. It is based on the service authorization
and provisioning part of the PC3 reference point defined in clause 5.2 of TS
23.303 [9]. It is applicable to both PC5 based V2X and optionally Uu based
V2X.
V4: The reference point between the HSS and V2X Control Function in the
operator\'s network.
V5: This is the reference point between the V2X Applications.
V6: This is the reference point between V2X Control Functions.
LTE-Uu: This is the reference point between the V2X enabled UE and the
E-UTRAN.
PC5: This is the reference point between the V2X enabled UEs for V2V, V2I, and
V2P Services.
### 4.2.3 eMBMS and LTE-Uu based V2X architecture reference model
Figure 4.2.3-1: Reference architecture for V2X (eMBMS and LTE-Uu based)
The new functions are defined as following:
V2X AS: the logical function that is used for network related actions required
for V2X. It is similar to the GCS AS.
The reference points are defined as following:
VC1: This is the reference point between the V2X AS and the application client
on the UE.
VMB2: This is the reference point between the V2X AS and the BM-SC.
SGmb/SGi-mb/M1/M3: The SGmb/SGi-mb/M1/M3 reference points are internal to the
MBMS system and are defined in TS 23.246 [11].
> LTE-Uu: This is the reference point between the V2X enabled UE and the
> E-UTRAN.
### 4.2.3 Security impact
The architecture reference model of Figure 4.2.2-1 is based on that of ProSe
described in TS 23.303 [9] and where for example the V2X Control Function
plays a similar role as the ProSe Function. Reference points like V3 and V4
are therefore intended to run similar procedures as in ProSe. For example, V3
is used for authorization, configuration and provisioning for the V-UEs; V4 is
used to communicate subscription information. As a consequence, many of the
security requirements and corresponding security mechanisms from TS 33.303
[12] designed initially for ProSe may still be applicable here.
# 5 Security Analysis of V2X
## 5.1 Key Issue #1: V2X Communication Security
### 5.1.1 Key issue details
Many application services make it vital to protect V2X messages from attacks
which may lead to catastrophically wrong decisions/actions in safety critical
conditions. Furthermore, attack actions on V2X messages may mislead the
transport entities to make inefficient decisions, causing safety or efficiency
problems on road and in the transportation management.
### 5.1.2 Security threats
The communication between LTE-V system entities exchanging content in the V2X
context may be forged, replayed, or eavesdropped.
A LTE-V system entity is a V2X communication entity or V2X cellular network
entity, i.e LTE capable modules within vehicles, road side units, modules
carried by pedestrians or MNO network elements that are used for V2X
communication. If not known to the network, an attacker could use an LTE-V
system entity to e.g. upload wrong information for re-distribution to other
system elements.
### 5.1.3 Potential Security requirements
The LTE-V system entities (cellular network entities or V2X communication
entities) should be able to authenticate and verify that the sender of the
received data communications was authorized to send the data.
The transmission of data between different entities (V2X communication
entities or cellular network entities) in the LTE-V system should be integrity
protected.
The transmission of data between different entities (V2X communication
entities or cellular network entities) in the LTE-V system should be protected
from replays.
The transmission of data between two different entities (V2X communication
entities or cellular network entities) in the LTE-V system should be
confidentiality protected if needed for the V2X application.
NOTE: Transmission of data includes but not limited to multicast, broadcast,
unicast, or geocast.
## 5.2 Key Issue #2: Authorization for LTE-V2X Radio Resources
### 5.2.1 Key issue details
In LTE-V2X communication, before a UE starts broadcasting its V2X, it needs to
request radio resources from the E-UTRAN. If not authenticated, malicious
LTE-V2X UEs can attempt to request radio resources, which would lead to an
exhaustion of network radio resources.
### 5.2.2 Security threats
If many malicious UEs may attempt to request radio resources at the same time
from the MNO network, it would lead to an exhaustion of network radio
resources. Legal vehicle UEs cannot get available radio resources for LTE-V2X
communications.
### 5.2.3 Potential Security requirements
The MNO network shall authenticate vehicle UEs when it attached to the LTE-V2X
network.
The MNO network shall check the authorization information of vehicle UEs
before allocating radio resources to it.
## 5.3 Key Issue #3: V2X Entities Secure Environment
### 5.3.1 Key issue details
In order to enable LTE-V2X services, the V2X entities (vehicle UE, UE-type
RSU, eNB-type RSU, pedestrian UE) might require storing security credentials
and other vital information which need to be protected from malicious
modification. In addition, functions to processV2X messages need to be
executed in the V2X entities. Especially, vehicle UE and pedestrian UE
generate V2X messages according to conditions information such as speed,
location, heading, acceleration and other dynamic characteristics provided by
measuring instruments (e.g. speed sensor and GPS). V2X messages processing and
generating also should be protected in a secure environment to guarantee the
integrity and authenticity of V2X messages.
### 5.3.2 Security threats
The possile attacks to the V2X entities (vehicle UE, RSU, pedestrian UE) may
include:
\- In the vehicle UE or pedestrian UE, the attacker may manipulate the
conditions information from measuring instruments, thus generating false V2X
messages or false warnings which may mislead surrounding V2X entities to take
wrong actions and possibly cause accidents.
\- The attacker may manipulate the data processing in V2X entities. As a
result, false V2X messages or false warnings are sent out, which may mislead
surrounding V2X entities to take wrong actions and possibly cause accidents.
\- The attacker may modify the security materials or vital configuration data
in eNB-type RSU, rendering security protection or other functions unavailable.
### 5.3.3 Potential Security requirements
The secure environment should support secure storage of sensitive data, e.g.
long term cryptographic secrets and vital configuration data.
The secure environment should support the execution of sensitive functions,
e.g. protection of user data and the basic steps within protocols which use
long term secrets.
Sensitive data used within the secure environment should not be exposed to
external entities.
The secure environment should optionally check the integrity of the V2X
entity's boot process.
The secure environment should maintain the integrity of its own system and
software.
The secure environment should be protected from illegitimate access (i.e. to
the data that it stores and to the functions that it executes).
Note: These requirements are based on the traditional nodes in scope of 3GPP
e.g. eNB and HeNB etc., and are not addressed.
For V2X services relying on access networks within the scope of TS 33.401[13]
and 3GPP TS 33.402 [14], the 3GPP authentication and key Agreement and
associated subscriber credentials and identities used to access the network
shall reside on UICC within the V2X enabled UE, with the exception from 3GPP
TS 33.402[14] regarding terminals that do not support 3GPP access
capabilities.
## 5.4 Key Issue #4: Local MBMS Entity (LME) -- security of Mv interface
### 5.4.1 Key issue details
In 3GPP TR 23.785[3], one solution proposal for LTE-V2X architecture is that
user plane related MBMS functions (i.e. user plane functions of BM-SC and
MBMS-GW) should be moved closer to RAN to allow the V2X messages to be
distributed to target eNBs without traversing core network nodes. In this
proposal, the control plane remains at the main MBMS nodes, i.e. BM-SC, MBMS-
GW and MME in the core network.
For localizing the MBMS function the Local MBMS Entity (LME) has been
introduced to enable the local delivery of user data. It interfaces with the
V2X application server. It is still open, whether the newly introduced
interface Mv is used to connect LME to BM-SC or MBMS-GW.
Due to the exposed location of the LME the interface Mv should be protected.
### 5.4.2 Security threats
Messages sent from or to the LME may be modified, forged, or replayed.
LME may be masqueraded by an attacker.
### 5.4.3 Potential Security requirements
The Mv interface should be integrity protected and replay protected.
Mutual authentication between the LME and core network entities should be in
place.
Note: confidentiality protection may not be needed due to the nature of
broadcast.
## 5.5 Key Issue #5: V2V/P authority broadcast communication security by UE
for public information announcement over PC5 Interface
### 5.5.1 Key issue details
V2X messages transmission/reception for V2V/P services over PC5 interface pre-
dominantly requires broadcast transmission. Threats and security requirements
on V2V/P message broadcast differ from other V2X services and use cases.
A UE is defined as any UE that is provisioned by organizations to provide
information distribution on V2V/P services. Examples of an UE are pedestrian
UEs and vehicle UEs including normal vehicles and authority vehicles such as
emergency vehicles, law enforcement vehicles, and road construction vehicles
or utility vehicles. UEs are expected to proceed with a registration procedure
to receive authorization for the V2V/P service.
A UE may send periodic broadcast V2V/P messages to inform other UEs in its
proximity regarding vehicle or pedestrian's moving status. In addition, the
V2V/P message could be event-driven to inform nearby vehicles and pedestrians
regarding a specific event. For examples, the data in authority V2V/P
broadcast could describe authority-relevant information, such as law
enforcement vehicle approaching, mandatory road closure, etc.
V2V/P use cases that leverage this type of communication usually require UEs
on vehicles or by pedestrians to make decisions or take actions based on the
locally generated sensing information and data from the received V2V/P
broadcast messages. V2V/P broadcast messages could provide information
complimentary to receiving UE's local sensing data. The expected receivers of
V2V/P broadcast messages are any V2V/P service enabled UEs in the sender's
transmission range. Moreover, when a RSU in the sender's range receives an
event-driven V2V/P message, it may relay this broadcast message to
vehicles/pedestrians in greater distance.
Attacks on V2V/P broadcast message of this type may mislead receiver UE
regarding the current road condition and makes a wrong decision or action. The
authenticity of the received information is expected to be validated. In
addition, the integrity of V2V/P broadcast shall be validated to defend
against forgery. Furthermore, the concern of anonymity or privacy exists.
However, the concern is not severe, because the information is generated by a
normal UE supporting V2V/P service and is intended for public consumption.
Note: Whether privacy issues are considered depend on regional regulatory
requirement and operator policy. In general application layer security can be
used to address potential privacy issues by employing identifiers and
credentials that are not linked to long-term UE or user identifiers. These
credentials would be refreshed periodically.
### 5.5.2 Security threats
Security threats to the use cases that leverage V2V/P broadcast messages
include
\- Maliciously forged or modified V2V/P broadcast input that mislead the
receiving UE to make wrong decision/action
\- Maliciously deleted/delayed V2V/P broadcast input that cause the receiving
UE to fail to take action in time in response to the road condition
\- Maliciously replayed V2V/P broadcast input that cause the receiving UE to
react to non-existing road condition improperly
\- Unintended exposure of V2V/P broadcast input to entities un-authorized for
V2V/P services
Vulnerabilities exposed by V2V/P broadcast communication that can be leveraged
by attackers are the following: message deletion, modification, forgery,
replay, delay, rushing, re-ordering, and medium jamming.
Forged or modified V2V/P broadcast information on road condition is expected
to take priority in local processing and decision making by the receiving UE.
Depending on the situation, the received announcement could come from one or a
few UEs, and may be complimentary to the local sensing, or may be the only
source of information. The risk of data forgery and modification is high and
is the realistic issue to be addressed by V2V/P security communication
solution.
Deleted or delayed V2V/P broadcast information on road condition could lead
the receiving UEs to fail to take action given the current road condition, if
the UE is completely blocked from receiving such warning from all V2V/P UEs in
its proximity (transmission range). Given potential low redundancy of V2V/P
broadcast information on road, the risk of deletion or delay is realistic. The
security solution is expected to at least increase the availability of V2V/P
broadcast information.
Replayed V2V/P broadcast information on road condition in the past leads to
the same consequences as by the information forgery. The risk is significant
to be addressed by the security solution.
Given the V2V/P broadcast data is intended for public distribution and
consumption, the threat of disclosing V2V/P data to unauthorized UEs leads to
very low risk.
Threats on allowing unauthorized UEs to access V2V/P service or use invalid
identity are related as well. In particular, the provisioning of "authority
V2V/P service" shall be protected such that the receiving UE can validate the
sender's authenticity when processing and validating the received information.
### 5.5.3 Potential Security requirements
V2V/P UE shall be authorized to participate in V2V/P service for broadcast
announcement
V2V/P broadcast receiver UE shall be authenticated and authorized to
participate in V2V/P service
Sender of V2V/P broadcast message shall be authenticated as the validated UE
permitted to send the message.
V2V/P broadcast message shall be validated to ensure the content has not been
maliciously modified by any party other than the sender.
Freshness of V2V/P broadcast message shall be ensured so that receiving UE
accepts only freshly generated messages by the authority UE, preventing
against replay attacks.
## 5.6 Key Issue #6: Identity/Credentials Security for V2V/P Services
### 5.6.1 Key issue details
V2X V2V/P UEs are expected to manage their Identity and credentials properly.
Furthermore, V2V/P UEs are expected to use the assigned identities to
participate in the V2V/P communication and applications. The V2V/P UE may have
one or more identities relevant to the subscribed V2V/P services. Compromise
of credential or identity gives attackers tools to impersonate legitimate
V2V/P UEs, forge communication, influence vehicle or pedestrian's decision,
causing information leakage, and even loss of property or human lives. Hence,
it is important to properly register every V2V/P UE with validated identity,
and protect it throughout the lifecycle of identity usage and management.
### 5.6.2 Security Threats
The system of managing and using identities for V2V/P service by UEs could be
vulnerable. The adversary can launch attacks on identities from network and
from the endpoint system.
On the endpoint system, credential provisioning server or UE, the identity
could be stolen and used by adversary to impersonate the UE to participate in
authentication, authorization, or message validation. Furthermore, the stolen
identity of the registration authority allows adversary to create forged
identities (Sybils), and convince UEs to access any identity of adversary's
choice as the registration authority.
On the identity creation and credential provisioning procedure, the failure in
binding unique identity to the UE's secret cryptographic key could lead to
"mis-binding" attack that cause the victim system to access information from
adversary using another UE's true identity.
On the communication medium, the protocol for V2V/PUE authentication or
authorization method could be compromised by the network attacker if the
protocol design fails to bind communicating parties with identities, keys, and
fresh protocol instance. The man-in-the-middle attack is possible that leads
the attacker to impersonate victim UE and participate in V2V/P communication
maliciously.
### 5.6.3 Potential Security requirements
The following are requirements for managing and using UE V2V/P identities for
the purpose of V2V/P broadcast, or authenticated and protected unicast:
V2V/P Credential Provisioning server (e.g., V2X Certification authority, V2X
Key Management Server) shall securely provision credentials for each V2V/P UE,
and bind the credentials with the UE's identity
V2V/P Credential Provisioning server shall protect its secret root key (e.g.,
public/private keys from hardware-based tampering
V2V/P Credential Provisioning server shall make the knowledge of trust anchor
available to all participating V2V/P UEs
V2V/P Control Function (defined in TR 23.785[3]) shall authenticate each V2V/P
UE with its identity and credential before authorizing UE for V2V/P service
V2V/P Control Function shall manage trust anchors to authenticate all
participating V2V/P UEs that needs authentication and authorization for
specific V2V/P services
## 5.7 Key Issue #7: Vehicle UE privacy
### 5.7.1 Key issue details
The LTE-V2X system is expected to provide transport of V2X communications
(V2V, V2I/N, etc.) in order to allow vehicle/road safety applications and
other services such as traveller information dissemination. The effectiveness
of many of the safety services depends on a high participation rate from the
side of the UEs.
All UEs participating can send very frequent data packets that contain
information about their location, speed, direction, etc., as well as
information identifying (on a short-term basis) the source of this data, in
order to allow theV2X application to work (e.g. path prediction). This data is
sent in the clear in order to be readily received by any other UE nearby.
Moreover, the data will contain some identifying information such as signing
certificate.
Privacy or anonymity in the V2X communication environment is a requirement
deemed very important for user adoption of the V2X system. The fear of
"automatic speeding tickets" as well as the tracking of a user whereabouts
over time is legitimate and thus UE and user privacy measures must be designed
into the V2X system from the beginning.
It is also worth noting that in certain environments where the vehicle density
is high (e.g. urban), achieving UE privacy may be more feasible than in less
travelled areas (e.g. rural roads).
TS 22.185[2] provides two generic security requirements [R.5.3-005] and
[R.5.3-006] related to privacy(see clause 5.7.3 on details):
To distinguish between direct communication between vehicles or system
entities (PC5), communication from the system entities to the LTE network
(LTE-Uu), and LTE downlink by eMBMS may be helpful in finding solutions that
also satisfy privacy for each of the interfaces.
Note: The \"do not track\" requirement depends on regional regulatory
requirements and operator policy. Since the MNO naturally needs to work with
e.g. IP addresses as UE's long-term transport layer identity, the system
architecture needs to make sure that unlinkability between V2X data and MNO
transport used data is achieved. TS 23.285 [11] captures the following
solution: "In order to ensure that a vehicle cannot be tracked or identified
by any other vehicles beyond a certain short time-period required by the
application, the source Layer-2 ID must be changed over time."
### 5.7.2 Security threats
The UE supporting V2X applications transmits application layer information
(e.g. about its identity, location, dynamics, and attributes). The direct
relationship between identity and specific data makes it possible for the
adversary to reveal UE's personal details.
The location information in the V2X messages may be used by adversaries to
perform location tracking on a longer term. The location tracking on a shorter
term may not be an attack because it is used to perform path-prediction in
proximity to provide basic service to the driver, e.g. warnings, etc.
The threats can be detailed as following:
_PC5 mode threat_ : A vehicle UE using the PC5 link to send its periodic V2X
messages includes some identifiable information in the application layer data.
Thus, other UEs nearby could collect this data and correlate it to the
location of that UE over time.
_Network attachment threat_ : A vehicle UE that is attached to the network for
V2X purposes (e.g. Uu mode) and that remains in connected is providing the
network with the ability to track the UE. This threat is particularly relevant
to the case when the UE is attaching to the network for V2X service due to
regulatory requirements without the users consent.
_Uu mode threat_ : V2X data that is sent across the network may provide the
V2X application with additional data, e.g. an IP address, that enables the
application to link together more V2X data than is necessary and provide some
tracking of the UE.
A UE using the Uu link to send its periodic V2X messages may need to re-attach
as it moves along a road and comes into the coverage of another eNB. The
network can keep a record of all attach identities and correlate them over
time to the location and speed of the UE as contained in the application-layer
V2X messages, thus tracking the UE at a very granular level.
For both the PC5 and Uu based V2X communication modes, there is a threat that
the UE, user or vehicle permanent identity may be inferred based on the data
transmitted by that vehicle UE over time and space.
### 5.7.3 Security requirements
Privacy requirements [R.5.3-005] and [R.5.3-006] are specified in 3GPP TS
22.185 [2] and repeated here for completeness:
[R.5.3-005] Subject to regional regulatory requirements and/or operator policy
for a V2X application, the 3GPP system shall support pseudonymity and privacy
of a UE using the V2X application, by ensuring that a UE identity cannot be
tracked or identified by any other UE beyond a certain short time-period
required by the V2X application.
[R.5.3-006] Subject to regional regulatory requirements and/or operator policy
for a V2V/V2I application, the 3GPP system shall support pseudonymity and
privacy of a UE in the use of a V2V/V2I application, such that no single party
(operator or third party) can track a UE identity in that region
In addition, the following potential security requirements are proposed:
UE pseudonymity should be provided to conceal personal data from attackers.
The UE identity in the V2X messages should be protected
The content of the data transmitted by a vehicle UE should not lead to the
ability of another V2X entity (UE, network, application server) to identify or
track the sender UE beyond a short time period necessary for the V2X
application.
It shall be possible to prevent the LTE network from using the data gained by
a UE attaching to it for V2X service for purposes of tracking the UE.
The identifiers in the V2X messages should minimize the risk of leaking the UE
or user permanent identities.
## 5.8 Key Issue #8: V2X data source accountability
### 5.8.1 Key issue details
The MNO is going to transfer data that are generated by third parties, e.g.
vehicle data are transferred via the V2X application to E-UTRA(N) and may be
broadcasted again via LTE to other V2X service users.
The MNO is not responsible for the correctness of generated vehicle data.
Though one would hope, that in the first place, the vehicle data provided to
the LTE network is not manipulated or forged, this may not be always the case.
Even though the MNO, as pointed out, is not able to verify the legitimacy of
such application-layer messages, it may still be desirable that the MNO to be
able to identify the sender of V2X messages for data accountability or other
such purposes.
Accountability should therefore be supported at the V2X level.
### 5.8.2 Security threats
There could be circumstances where the source of a V2X message needs to be
identified, and the MNO may not be able to provide such information.
When the operator is a position to provide such a capability, this could be
mis-used to compromise privacy.
Behaviour of a V-UE could have a detrimental impact on the LTE network. If LTE
network operator is unable to identify the V-UE, the operator may be unable to
mitigate this threat.
### 5.8.3 Potential Security requirements
The MNO should be able to identify the sender of a message when required by an
entity (subject to regulatory environment).
The LTE system should provide accounting function on data received from a
resource external to LTE.
Note: Potential privacy requirements are captured in Clause 5.7.3 of the
present document.
## 5.9 Key Issue #9: authentication and authorization
### 5.9.1 Key issue details
V2X messages for V2V/P Services can be exchanged directly or via the E-UTRAN.
Different scenarios are envisioned in 3GPP TR 23.785 [3]:
\- UE is non-roaming or roaming
\- UE is \"served by E-UTRAN\" or \"not served by E-UTRAN\".
\- V2X messages are transferred between two UEs directly
\- V2X messages are transferred via an RSU.
According to 3GPP TS 22.185 [2] RSU in LTE context is a logical entity that
combines V2X application logic with the functionality of an eNB (referred to
as eNB-type RSU) or UE (referred to as UE-type RSU).
In case of eNB-type RSU, V2X messages can be transmitted by the V2X AS unicast
via SGi/Rx over LTE-Uu or broadcast via VC-1 (eMBMS).
In all those cases V2X enabled UEs need to be authenticated and authorized for
the V2X service.
### 5.9.2 Security threats
A UE that is not enabled for V2X may try to access the V2X service.
A UE that is enabled for V2X but not authorized to use any V2X service may try
to access a particular V2X service.
### 5.9.3 Potential Security requirements
UEs with a V2X application should be authenticated and authorized to access
V2X Services.
UEs with a V2X application should be authenticated and authorized to allow the
exchange of V2X messages with other V2X enabled UEs and when communicating
with the network.
Authentication of V2X enabled UEs to access LTE-V2X services should support
the same security mechanisms as defined in TS 33.401[13].
UEs should be authorized to send messages to other UEs.
UEs should be authorized to transfer messages via an RSU.
## 5.10 Key Issue #10: Local V2X application server
### 5.10.1 Key issue details
In existing architecture proposals, the V2X application server may be located
close to the access network for latency improvements. This may bring the V2X
application server in an exposed location.
Moving from one V2X application server to another means to also shift the
security context from one server to another.
### 5.10.2 Security threats
Messages sent between Local V2X application servers may be modified, forged,
or replayed.
Local V2X application server may be impersonated by an attacker.
Messages sent between Local V2X application servers may be wiretapped.
### 5.10.3 Potential Security requirements
The interface between Local V2X application servers should be confidentiality
protected and integrity protected and replay protected.
Mutual authentication between Local V2X application servers should be in
place.
## 5.11 Key Issue #11: Choice of cryptoalgorithm
### 5.11.1 Key issue details
3GPP TS 22.185 [2] specifies requirements on message size, frequency, range,
and speed that shall be met by the V2X system. If security parameters are
added to the payload, these requirements should still be met.
Furthermore, due to lifetime of vehicles it should be possible to update the
crypto(e.g. signature algorithms, key size, curve parameters).
### 5.11.2 Security threats
Radio resources may not be able to cope with the traffic load added by
security.
Many V2X use cases need to serve time requirements. If encryption and
decryption takes too long time, the required range of response time or the
maximum payload may not be met.
Updating of crypto algorithms in the vehicles may result in impact tothe
latency of communication or exceeding the security overhead.
### 5.11.3 Potential Security requirements
LTE V2X system should support cryptographic algorithm to meet the required
response times.
LTE V2X system should be designed so as to meet the requirements in
consideration of the increase of the payload needed for security.
LTE V2X system should be designed so as to allow maintainability of security
parameters such as signature algorithms, key size, curve parameters etc.
## 5.12 Key Issue #12: Credential provisioning for V2X services
### 5.12.1 Key issue details
This key issue is about the provisioning aspect of V2X service layer
credentials, whether in scope of 3GPP and if so, how it is realized.
3GPP TS 21.185 [2] specifies in [R-5.1-002] the following requirement: _A UE
supporting V2X application shall be able to be pre-configured by the 3GPP
network with parameters to be used for the transmission and reception of
messages when not served by E-UTRAN supporting V2X communication._
Thus, at least for this use case, it needs to be detailed what is meant by
"pre-configuration by the 3GPP network" and which 3GPP network entity would
provide it; or, if the pre-configuration is kept outside of 3GPP scope. The
understanding of pre-configuration within this key issue is that the V2X
enabled UE is provided with credentials to be used for the V2X service.
In order to access the V2X application server, the V2X enabled UE needs to
authenticate and be authorized for V2X services via the LTE network. If the
V2X application server is owned by the MNO, a V2X enabled UE could rely on the
LTE credentials getting authorized to V2X service application. If the V2X
application server is operated by a third party, V2X system entities need to
be provided with credentials in advance.
Several options are seen: A V2X enabled UE could rely on the LTE credentials
and receive specific V2X credentials after being authenticated to the LTE
network or use application layer security only, i.e. LTE is only used to
transport the V2X service authentication and authorization request to the V2X
application server after the V2X enabled UE has been authenticated by the LTE
system. LTE V2X could also use subscriber credentials in UICCs, in which case
the provisioning is part of MNO business and not specified by 3GPP. Also
embedded UICCs could be considered, which would allow remote provisioning of
credentials as discussed by GSMA.
This key issue should also explore the ETSI ITS [6] specified way forward of
using PKI. If this approach would be taken in 3GPP as well, certificates need
to be provided and a certificate management needs to be in place. This would
allow separate authentication for access to LTE network from authentication
for using V2X services.
It should be noted that regulatory requirements may request pre-provisioning
V2X UEs with credentials for V2X services.
### 5.12.2 Security threats
If a V2X enabled UE is allowed to access the V2X service without
authentication, the system could be exposed to Denial of Service attacks.
A compromised credential provisioning system could provide manipulated data to
the V2X enabled UE.
### 5.12.3 Potential Security requirements
Any credential provisioning server should be authenticated by the V2X enabled
UE, before allowing the provisioning.
Subscriber credentials exchanged between an authorized V2X application server
in the network and the V2X enabled UE shall be confidentiality protected,
integrity protected and protected from replays.
## 5.13 Key Issue#13: Data communication security between network entities
### 5.13.1 Issue details
Network entities in the LTE-V system will be required to communicate with each
other, e.g. V4 between the V2X Control Function and the HSS (see TR
23.875[3]).
### 5.13.2 Security threats
There are several threats to the communication between network entities
including forged or replayed messages and eavesdropping on the contents of the
message.
### 5.13.3 Security Requirements
The network entities should be able to authenticate the source of the received
data communications from the other network entity that sends the data.
The transmission of data between network entities should be integrity
protected.
The transmission of data between network entities should be confidentiality
protected.
The transmission of data between network entities should be protected from
replays.
## 5.14 Key Issue#14: V2I broadcast communication security over PC5 interface
### 5.14.1 Issue details
As described in TS 22.185[2], Road side unit (RSU) is a stationary
infrastructure entity supporting V2X applications that can exchange messages
with other entities supporting V2X applications. RSU may combine V2X
application logic with the functionality of an eNB (referred to as eNB-type
RSU) or UE (referred to as UE-type RSU).
Authority organizations may deploy UE-type RSUs to periodically broadcast V2I
messages containing authority information such as curve speed limit and
traffic light status. In order to notify more vehicles or pedestrians of
emergency situations, UE-type RSU may relay event-driven V2V/P messages with
its own identity and these messages can also be seen as V2I communication.
Whereas those event-driven V2V/P messages relayed without any processing by
UE-type RSU can be analysed according to subclause 5.5.
Vehicles or pedestrians around the UE-type RSU need to make decisions or take
actions based the authority V2I messages or relayed V2V/P messages with some
additional processing. Attacks on V2I broadcast messages may mislead receiving
UE regarding the current road condition and makes a wrong decision or action.
The authenticity and integrity of V2I messages shall be validated by the
receiving UE. Moreover, the UE-type RSU shall be validated that it has been
authorized by the authority organizations to broadcast V2I messages. The
concern of anonymity or privacy may not exists for RSU.
### 5.14.2 Security threats
Forged/modified/replayed V2I messages misleads the receiving UEs to make wrong
decision or action.
V2I messages transmitted by un-authorized V2X UE(s) can mislead the receiving
UE to make wrong decision or action.
### 5.14.3 Security Requirements
The receiving UE should validate that the UE-type RSU is permitted to send the
V2I message.
UE-type RSU should be authorized by the MNO to broadcast V2I messages over PC5
interface.
V2I broadcast messages should be integrity protected.
V2I broadcast messages should be protected from replays.
## 5.15 Key Issue#15: Security of UE to V2X Control Function interface
### 5.15.1 Issue details
In order to utilise V2X features, the operator (either HPLMN or VPLMN ) needs
to be able to configure the V2X enabled UEs via the V2X Control Function in
the Home PLMN, e.g. the authorization information for a list of PLMNs where
the UE is authorized to perform V2X Direct Communication and information
regarding out-of-coverage operation specified in TR 23.785. It is then crucial
that these data are not prone to manipulation by attackers.
5.15.2 Security threats
An attacker pretending to be V2X Control Function may maliciously configure
the V2X UE with false configuration data, thus causing improper UE operation.
An attacker pretending to be V2X Control Function may maliciously delete the
V2X UE configuration data, rendering the V2X UE unable to operate to use V2X
services.
The V2X Control Function needs to know the identity of the V2X enabled UE that
is requesting configuration information, as otherwise it is not possible to
download correct information to the UE.
An attacker may manipulate the configuration data being transmitted between
the UE and V2X Control Function, thus adversely affecting the V2X
configuration.
An attacker may eavesdrop on transmitted configuration data and further
distribute it to unauthorized parties for improper use.
An attacker may replay an intercepted configuration data thus affecting an
expected configuration state at the V2X enabled and/or V2X Control Function.
An attacker may manipulate the configuration data stored on the V2X UE.
### 5.15.3 Security Requirements
The V2X enabled UE and its HPLMN V2X Control Function should mutually
authenticate each other.
The PC3 interface between the V2X enabled UE and its HPLMN V2X Control
Function should be integrity protected.
The PC3 interface between the V2X enabled UE and its HPLMN V2X Control
Function should be confidentiality protected
The PC3 interface between the V2X enabled UE and its HPLMN V2X Control
Function should be protected from replays
The configuration data should be stored in the V2X UE in an integrity
protected way.
Some configuration data may be required to be stored in the V2X UE in a
confidentiality protected way.
## 5.16 Key Issue #16: Detectability of Malicious LTE-V2X UE Behavior -
achieving trust and confidence in messages
### 5.16.1 Key issue details
A good security solution will prevent sending of false messages by malicious
users or, if this is not possible, at least it should allow the receiving UE
to make a decision whether to trust the message. This prevents that a V2X LTE
UE will process a false warning message.
However, it may not be clear for a UE when receiving a message, whether the
sending UE is malicious or it has just a mal-functioning sensor that led to
this message. Securing the communication only protects against attacks on the
air interface, it does not prevent cases where the UE sends out faulty
messages due to malware, faulty sensors, or on purpose. As a result, a
receiving UE may not be able to tell from the security aspects of a received
message alone whether the content of the message is trustworthy. And so, the
problem that occurs is that a UE that receives for example an imminent crash
warning may take an inappropriate action which may lead to unsafe road
conditions. Consequently, the aim of V2X to improve road safety may not be
achieved. Thus, the key issue should address how a receiving UE could achieve
trust in such a situation.
In short, the following problems need to be addressed:
How does the receiving UE detect and handle false messages due to
\- malware on the UE,
\- sensor failures or
\- being a malicious UE.
These problems cannot be addressed by only securing the communication channel
and so other solutions should be investigated, i.e. how to achieve confidence
or trust in the messages that a UE receives either via broadcast over PC5 or
over eMBMS.
### 5.16.2 Security threats
A V2X UE may be fooled into taking wrong decisions leading to unsafe road
conditions.
Receiving a malicious message may lead the V2X UE to take the wrong action.
### 5.16.3 Security requirements
A V2X UE should have the means to achieve trust or confidence in the messages
received.
## 5.17 Key Issue #17: Securing the communication between V2X AS and LTE
network
## 5.17.1 Key issue details
The V2X application server (V2X AS) communicates with the LTE network via SGi
with S-GW/PGW and via MB2 interface (MB2-U and MB2-C) with BM-SC.
The communication between non-3GPP network entities, i.e. the V2X AS, and the
3GPP network that terminates at a 3GPP network entity needs to be secured.
V2X AS has a similar functionality as GCS AS (3GPP TS 23.468 [28]). Thus,
security threats and requirements as given for GCS AS in the referenced
specification also apply for V2X AS.
If e2e security between AS and UE is assumed for signalling and media plane,
no additional security regarding V2X AS is needed for SGi, as this interface
is not V2X specific.
### 5.17.2 Security threats
The threats on MB2 interface as listed in 3GPP TR 33.888 [29] clause 6.2.2
also apply for V2X AS acting as GCS AS.
Note: Threats on SGi interface are not V2X specific and therefore not
mentioned here.
### 5.17.3 Potential Security requirements
For a V2X Application Server acting as the GCS AS, the security requirements
specified in 3GPP TS 33.246 [10] annex N.0 and annex N.1 shall apply.
No security requirements are given SGi, which is a generic interface and
therefore not specified in the scope of V2X.
# 6 Proposed Solutions
## 6.1 Security for one to many V2X Direct Communication
### 6.1.1 Overview of one to many V2X Direct Communication
The One-to-many V2X direct communication consists of the following procedures
based on TR 23.785[3]:
1\. One-to-many V2X Direct communication transmission over PC5 interface for
broadcast messages
2\. One-to-many V2X Direct communication reception over PC5 interface for
broadcast messages
Security for one-to-many V2X direct communication consists of bearer level
security mechanism which is similar to that of ProSe (specified in TS
33.303[12], subclause 6.2.3).
#### 6.1.1.1 Security flows
##### 6.1.1.1.1 Overview
The protection of one-to-many V2X communication proceeds as shown in the
figure below.
Figure 6.1.1.1.1 -- Overview of Authorisation for V2X communication
0a or 0b: If needed the UE could be configured with any private keys,
associated certificates or root certificate that they may need for contacting
the Temporary ID Management Function to allow the keys to be kept secret from
the operator. If none are provided, then the USIM credentials are used to
protect that interface. The UE may also be pre-configured with the address of
the Temporary ID Management Function.
NOTE 1: The Temporary ID Management Function and V2X KMS or Certification
Authority (CA) are shown as a separate logical entity to allow the network
operator to provision the radio level parameters and a 3^rd^ party, e.g. V2X
service Provider, to have control over provisioning the keys. If such a
separation is not needed then the Temporary ID Management Function and V2X KMS
or Certification Authority may be deployed as parts of the V2X Control
Function.
NOTE 2: The Temporary ID Management Function handles application IDs and has
no impact on 3GPP network layer identities.
1a or 1b: The UE fetches the one-to-many communication parameters from the V2X
Control Function. As part of this procedure the UE gets a list of services
offered by the operators and affiliated service provider and is informed
whether bearer layer security is needed for this service. In addition the UE
may be provided with the address of the Temporary ID Management Function, and
that of V2X CA or KMSs that it uses for obtaining keys for a specified
service.
2a.i or 2b.i: The UE sends the Key Request message to the Temporary ID
Management Function including UE ID, a Service ID (for broadcast services) for
which it wants to fetch security credentials and UE V2X security capabilities
(including the set of V2X security methods the UE supports). In case of UE
security credentials provisioning with certificate, the Key Request message
also includes a self-signed cert issued by the UE (Details are in Clause
6.1.1.1.1.2)
2a.ii or 2b.ii: The Temporary ID Management Function checks whether the
security methods is supported by the UE according to the UE V2X security
capabilities, i.e. whether one the required security methods is included in
the set of V2X security methods the UE supports.
2a.iii or 2b.iii: If the check of step 2a.ii or 2b.ii is successful for a
Service ID, then with the help of V2X Control Function and CA or KMS, the
Temporary ID Management Function completes the processes of Service ID
authorization confirmation and security credential generation. Section
6.x.1.1.1.1 and 6.x.1.1.1.2 describe the detailed protocol message exchanges
for confirming Service ID authorization and provisioning UEs with security
policy and credentials for identity and certification based authentication &
encryption respectively. If the check of step 2a.ii or 2b.ii is failed, then
go to step 2a.iv or 2b.iv directly.
2a.iv or 2b.iv: The Temporary ID Management Function returns the Key Response
message to the UE. If the check of step 2a.ii or 2b.ii is successful for a
Service ID, this message contains Service ID, the selected V2X security method
identifier, and the provisioning security credential / policy. Otherwise, this
message contains an indicator of algorithm support failure as the UE does not
support the required algorithm.
3a or 3b: The UE uses the provisioned security credential / policy to send /
receive protected messages to / from another UE.
###### 6.1.1.1.1.1 UE Security Credential Provisioning with Identity based
Cryptography
The UEs are provisioned with the required credentials (as defined in RFC 6507
[15] and RFC 6508[16) in advance, when the UEs have a secure access to their
Key Management Server (KMS). The KMS, common root of trust for the UEs,
provisions the UEs with a set of credentials for ECCSI and SAKKE schemes.
Upon successful provisioning for ECCSI, each UE will be configured with the
public key of the KMS, and a set of credentials associated with the UE's
identity, which are: Secret Signing Key (SSK) and Public Validation Token
(PVT). The UE may act as a "signer" and "verifier" or just as a "verifier". As
a signer, the UE uses its SSK to sign a message, and when acting as a
verifier, the UE uses the public key of the KMS and the signer's PVT and the
signer's identity to verify the signature.
Upon successful provisioning for SAKKE, each UE will be configured with the
public key of the KMS, and a Receiver Secret Key (RSK) which is associated
with the UE's identity. The sender UE uses the receiver's UE identity
(receiving entity for SAKKE payload) and the public key of the KMS to create
an encrypted SAKKE payload. The receiving UE uses its identity and RSK and the
public key of the KMS to decrypt SAKKE payload.
The public identity of a UE may be encoded in any format that is compatible
with the guidelines provided in RFC 6509 [17]. For example, the public
identity of a UE may be a concatenation of a fixed part (in the form of IMSI,
SIP URI, TEL URI, other user\@domain types of URI, etc.) and a varying part
(in the form of a timestamp - identity credential expiration time).
Note 1: Assignment of a temporary identity is not addressed in this solution.
UE may be configured with multiple sets of identity based credentials (with
different expiration times) for purpose of key refreshment when UE is out of
coverage. Lifetime of identity based credentials will be governed by security
policy. For example, the signing credential may need to be changed every 5
minutes.
In the following protocol, the time slot [TIME, TIME + Duration] is the
validity window of a credential, where Duration is a parameter specified by
the operator according to its global policy. For example, upon receiving a
broadcast message, if the receiving time is out of the time window, then the
UE will discard the message.
Note 2: Solution assumes UE can find out Duration by other means not detailed
in the solution.
Figure 6.1.1.1.1.1 - UE Security Credential Provisioning with Identity based
Cryptography
0.i, 0.ii and 0.iii are the same as 1a, 2a.i and 2a.ii in Clause Error:
Reference source not found.
1\. The Temporary ID Management Function exchanges messages with the V2X
control function to get confirmation that the UE is qualified to be authorized
for this service. If UE is to act as only Verifier, then the Temporary ID
Management Function requires KMS-Pub from V2X KMS, and this procedure goes to
Step 6b directly.
2\. The Temporary ID Management Function sends the SIGN-key Request message,
including TIME which is the starting time of the requested SIGN-key, to V2X
KMS, without UE ID or Service ID.
3\. V2X KMS generates the SIGN-key (i.e., SSK, PVT).
4\. V2X KMS returns (SSK, PVT) to the Temporary ID Management Function.
5\. The Temporary ID Management Function correlates (UE ID, Service ID) with
(KMS-Pub, SSK, PVT, TIME), and stores them in its database.
Note 1: The database of the Temporary ID Management Function is set for
accountability. In other words, it can be used to identify the sender of a
message, by correlating the KMS-Pub and PVT from the message with UE ID, in
case an illegitimate message is transferred. How long the database should keep
these data depends on the operator's policy.
Note 2: This solution does not provide details as to how the control function
verifies that the V2X UE and V2X KMS do not run provisioning process without
being authorized by the control function.
6a. If UE is to act as a Signer and Verifier, the Temporary ID Management
Function sends a response, including identity based key materials as follows:
SSK : Signing Secret Key
PVT : Public Verification Token
TIME: The starting time of the life time of (SSK, PVT)
KMS_Pub : KMS Public Key
KMS_ID : KMS ID
Trusted_KMS_List : Trusted KMS ID & KMS Pub pairs
6b. If UE is to act as only Verifier, the Temporary ID Management Function
sends a response, including identity based key materials as follows:
KMS_Pub : KMS Public Key
KMS_ID : KMS Identity corresponding to the KMS public key
Trusted_KMS_List : Trusted KMS ID & KMS Pub pairs
7\. The Temporary ID Management Function sends a confirmation to the V2X
Control function indicating that UE1 was successfully provisioned with the
credentials for the requested service ID.
Note 3: In the description of ECCSI defined in RFC 6507 [15], there is no
element TIME as defined above but is allowed to be included as part of the
element ID. If TIME is to be defined as a separate element, some modification
to ECCSI in RFC 6507 [15] is necessary. Specifically, the only change of the
ECCSI is as follows: In RFC 6507 [15], HS = hash(G \|\| KPAK \|\| ID \|\|
PVT); in the updated ECCSI, HS = hash(G \|\| KPAK \|\| ID \|\| PVT \|\| TIME).
###### # 6.1.1.1.1.1.1 V2X Data Source Accountability based on Identity based
Cryptography
Upon receiving an illegitimate message, the receiver reports this message to
the network. The network is able to identify the sender's ID as follows:
(1) Extract the sender's PVT from the message.
(2) Look up the PVT in the database maintained by the Temporary ID Management
Function, and identify the UE's permanent ID correlating with it.
(3) Revoke the UE's credentials or take other actions.
###### 6.1.1.1.1.2 UE Security Credential Provisioning with Certificate
The UEs may be provisioned with the required certificate in advance. V2X
certificate represents the certificate holder UE's authority to participate in
authorized V2X communication. For example, the road side unit (RSU) UE holds
certificate that authorize it to send authority broadcast announcement on
road.
Upon successful provisioning of certificate, the UE also receives a set of
trusted root certificates of CAs for authenticating other authorized V2X UEs
during its operation on road.
As depicted in Figure 6.1.1.1.1.2, the protocol for UE security Credential
provisioning using certificate consists of UE generating a self-signed
certificate for the service that wants to be authorized, confirmation by the
V2X Control Function that UE can be authorized for this service by V2X Control
function, and V2X CA delivering UE authorization cert, V2X CA root cert, and
trusted root certs to the UE.
Figure 6.1.1.1.1.2 - UE Security Provisioning with Certificate
0.i, 0.ii and 0.iii are the same as 1a, 2a.i and 2a.ii in Clause Error:
Reference source not found.
1\. V2X CA shall exchange messages with the V2X control function to get
confirmation that the UE is qualified to be authorized for this service.
Note: This solution does not provide details as to how the control function
verifies that the V2X UE and V2X CA do not run provisioning process without
being authorized by the control function.
Note: How the operator controls and verifies the life time of credentials
issued by the V2X CA is outside the scope of this solution.
2\. The Temporary ID Management Function sends the CA Request message to V2X
CA, without UE ID or Service ID.
3\. V2X CA generates a certificate, which is UE1-self-signed-cert signed by
CA.
4\. V2X CA returns (UE1-self-signed-cert signed by CA, CA root Cert, trusted
root certs) to the Temporary ID Management Function.
5\. The Temporary ID Management Function correlates (UE ID, Service ID) with
(UE1-self-signed-cert signed by CA, CA root Cert), and stores them in its
database.
6\. The Temporary ID Management Function sends a response to UE1 that includes
UE1-Cert signed by CA , CA root cert, and a set of root certificates trusted
by the V2X CA, as UE1's trust anchor.
7\. The Temporary ID Management Function sends a confirmation to V2X Control
function indicating the UE1 was successfully provisioned with credentials for
the requested service ID.
###### # 6.1.1.1.1.2.1 V2X Data Source Accountability based on Certificate
Upon receiving an illegitimate message, the receiver reports this message to
the network. The network is able to identify the sender's ID as follows:
(1) Extract the sender's temporary certificate from the message.
(2) Look up the certificate in the database maintained by the Temporary ID
Management Function, and identify the UE's permanent ID correlating with it.
Note: Operator needs to ensure that the database is not misused by the
operator.
(3) Revoke the UE's certificates or take other actions.
###### 6.1.1.1.1.3 UE Security Credential Provisioning and Tracing with
Identity based Cryptography
###### 6.1.1.1.1.3.1 Introduction
To support pseudonymity and privacy of a UE in the use of a V2V/V2I
application, such that no single party (operator or third party) can track a
UE identity in that region, in this solution, we assume that entities such as
V2X Control Function and Temporary Identity Management Function belong to the
operator and KMS belong to a third party. Entities in the operator and KMS
only know part of the user identity information so that none of them can track
the UE in certain region by the information they own. On the other hand,
operator and KMS are able to identify the identity of the UE by combine the
UE's identity information they own.
To use the Identity-based technology for signature generating and verifying
according to RFC 6507, the sender need to be provisioned with a SIGN-Key,
(PVT, SSK), which is generated according to its ID and KMS parameters, and is
also provisioned with the KMS Public Authentication Key (KPAK). The sender can
sign the message with the SSK and KPAK. A verifier need to be provisioned with
the KPAK. The sender can include its ID, PVT together with the data and a
signature generated. A receiver can verify the message with its KPAK and the
received ID, PVT, data and signature.
Note: This solution does not address efficient handling of the revocation of
certificates.
###### 6.1.1.1.1.3.2 Solution Details
###### 6.1.1.1.1.3.2.1 Credential Provisioning
We assumed that UEs is pre-provisioned with the identity, PVT of the Key
Management Server (as defined in RFC 6507 [15]) so that it has the capability
to verify the signature generated by the KMS.
{width="6.684722222222222in" height="3.1756944444444444in"}
Figure 6.1.1.1.1.3.2.1-1 - UE Security Credential Provisioning with Identity
based Cryptography as a signer
a.1. UE is provisioned with the Identity-based public key and parameters of
the KMS, such as ID_KMS, PVT~ID_KMS~, and KPAK according to the RFC 6507[15].
With these received parameters, UE is able to verify the signature generated
by the relative KMS identified by the ID_KMS.
KPAK : KMS Public Authentication Key
KMS_ID : KMS ID
a.2. UE stores the ID_KMS, PVT~ID_KMS~, and KPAK.
1\. UE get authorized with entities such asV2X Control Function or Temporary
Identity Management Function (TIMF).
2\. UE generates public and private key pairs PKx/SKx when UE is act as a
signer.
3\. UE sends a key request (Service ID, PKx) to V2X Control Function.
4\. V2X Control Function correlate PKx with the UE's long term identity such
as IMSI or other identity, and store them in the database.
5\. V2X Control Function establishes a secure channel with KMS which is locate
outside the operator's network.
6\. V2X control function further sends the key request wtih (service ID, PKx)
to the KMS. Note, UE's identity is not included in the message so the KMS does
not know the keys are generated for which UE.
7\. KMS generates Identity-based SIGN-key for the UE according to RFC 6507\.
The keys can be used by V2X application in the UE to sign broadcast messages.
The generated credentials including (PVT, SSK). KMS correlate the PKx with the
PVT and SSK.
SSK : Signing Secret Key
PVT : Public Verification Token
8\. The KMS sends the Key Response message to the V2X Control Function. The
message includes the identity of the KMS and its PVT, and also the PKx, the
encrypt vector (Service ID, PVT, SSK) and also a signature signed over the
message by KMS with its identity-based sign key.
9\. V2X Control Function forwards the Key Response message to the UE.
10\. UE verifies the signature of the received message with ID_KMS, its PVT
and also the KPAK. If the verification procedure returns a success, then the
UE further decrypts the (Service ID, PVT, SSK) from the message.
###### 6.1.1.1.1.3.2.2 Identity Tracing
We assume that there is a Trace Function that can help to determine the long
term identity of a signed message. The steps are as following:
1) Trace Function receives the message, the message including the signer's
PVT. The Trace Function extracts PVT from the message.
2) Trace Function performs service authorization with the KMS.
3) Trace function send the PVT to the KMS.
4) KMS finds the correlated PKx from the database based on PVT.
5) KMS sends back the PKx to the Trace Function.
6) The Trace Function further performs service authorization with V2X CF/TIMF.
7) The Trace Function sends a Trace Request to the V2X CF/TIMF, it includes
the PKx in the messages.
8) The V2X CF/TIMF extracts the PKx from the request and finds the correlated
long term identity of UE based on the PKx.
9) V2X CF/TIMF send Trace_Response to the Trace Function, which contains the
PKx and the long term identity of the UE.
{width="6.506944444444445in" height="3.2729166666666667in"}
Figure 6.1.1.1.1.3.2.2-1 - Identity Tracing Procedure with Message Signed
Pseudonymly
##### 6.1.1.1.2 Secure One to Many V2x Communication
###### 6.1.1.1.2.1 Broadcast Messages Protected by Identity based
Authentication
UEs with V2X authorization with identity based authentication may send signed
broadcast messages. The receiver UE of signed broadcast message, with properly
provisioned with identity based credentials, can verify the signature, and
accept the message content as integrity and origin authenticity protected.
This type of protection is suitable for UEs for RSU and authority vehicles.
Figure 6.1.1.1.2.1 - Broadcast Messages Protected by Identity based
Authentication
1\. UE1 creates a message Message, and signs (Message, time t, PVT, TIME,
KMS_ID) with its SSK, installed during the authorization phase with KMS, where
time t is the time when generating the signature.
2\. Upon receipt of the message, UE2 verifies it as follows.
(1) Verify time t: Check whether the received message is a replayed message.
More specifically, denote the time when receiving the message by time t'. We
require that 0 ms ＜ t'－ t ≤ time-window, which suggests that if t'－ t ＞ time-
window, then the message will be considered as a replayed message, and if t'－
t ≤ 0 ms, then the message will be considered as an invalid message. The value
of time-window depends on the message latency specification.
(2) Verify TIME: Check whether the receiving time is out of the validity
window.
(3) Verify the signature of (Message, time t, PVT, TIME, KMS_ID) using the KMS
Public Key and received PVT. UE2 uses the received KMS-ID to retrieve KMS
public key from its installed \ pairs.
3\. If time t, TIME, and the signature are verified, the message is sent to
the application to be processed.
Note: This solution does not provide details of message format and processing
procedure.
###### 6.1.1.1.2.2 Broadcast Messages Protected by Certificate based
authentication
UEs with no V2X certificate may send broadcast messages without protection.
UEs with V2X authorization certificate may send broadcast messages protected
by signature on the message payload. The receiver UE of signed broadcast
message, with properly provisioned trust anchors, can validate signer's
certificate, verify the signature, and accept the message content as integrity
and origin authenticity protected. This type of protection is suitable for UEs
for RSU and authority vehicles.
Note: This solution does not provide details of message format and processing
procedure.
Figure 6.1.1.1.2.2 - Broadcast Messages exchange protected by Certificate
based Authentication
1\. UE1 signs (Message, time t) with its private key, where time t is the time
when generating the signature, and sends (Message, time t), the signature and
the Cert signed by V2X CA to UE2.
2\. Upon receipt of the message, UE2 verifies it as follows:
(1) Verify time t: Check whether the received message is a replayed message.
More specifically, denote the time when receiving the message by time t'. We
require that 0 ms ＜ t' －t ≤ time-window, which suggests that if t'－t ＞ time-
window, then the message will be considered as a replayed message. The value
of time-window depends on the message latency specification.
(2) Verify the life time of UE1's cert (signed by V2X CA), where the life time
can be found in the data elements of the certificate.
(3) Verify the signature of (Message, time t) using the UE1's cert (signed by
V2X CA).
3\. If time t, the life time of UE1's cert, and the signature are verified,
the message is sent to the application to be processed.
###### # 6.1.1.1.2.2.1 Certificate Format
DataBlob {
Issuer ID: V2X-CA's unique identifier
Issuer: V2X-CA's public key
Subject ID: V2X-UE's unique identifier
Subject: V2X-UE's public key
Algorithm ID
Service ID
Not Before
Not After
Issuer URI
Policy
}
Signature {
sign(Issuer, DataBlob)
}
Note: The above format and data elements of certificate are only an example.
###### # 6.1.1.1.2.2.2 Certificate Refreshment
UEs shall connect to V2X Control Function and Certification authority to
refresh the certificate before its time expiration.
Note: Protocols of certificate refreshment are not described in this solution.
##### 6.1.1.1.3 Security Architecture for V2X (PC5 and LTE-UU based)
\- The VCF (V2X Control Function) is mainly responsible for authentication and
authorization V-UE through HSS on user plane.
\- The TIMF (Temporary ID Management Function) is mainly responsible for
distribute the temporary IDs and credentials to V-UE and V2X data source
accountability.
\- The TIMF could be deployed as one network element with VCF, and they share
the same interface V3.
\- V2X CA could be setup as multilayer CA system. No matter how to structure
the V2X CA in real deployment, they could be simplified as a logical V2X CA in
the security architecture diagram.
\- There are two new reference points introduced:
\- V7: This is the reference points between the TIMF and V2X CA/V2X KMS. Since
the interworking messages on how to enrolment a key pairs from a V2X KMS or
digital certificates from V2X CA are relied on existing and mature commercial
products in industry, it should align with those existing protocols.
\- It is up to V2X Service Operator to choice V2X KMS or V2X CA. But the
message on the V3 interface for enrolment and response for temporary IDs and
credentials from V2X KMS and V2X CA should be unified.
\- V8: This is the reference points between the TIMF and VCF. The TIMF will
forward the authentication request to VCF, and response the temporary ID
request from V-UE only after acquired the successful authentication result
from VCF.
##### 6.1.1.1.4 The Format of PDCP Layer for Protection the Broadcast Messages
###### 6.1.1.1.4.1 PDCP Format for Broadcast Messages Protected by Identity
based Authentication
The parameters TIME, KMS_ID, time, sig are described in clause 6.1.1.1.2.1
"Broadcast Messages Protected by Identity based Authentication".
###### 6.1.1.1.4.2 PDCP Format for Broadcast Messages Protected by Certificate
based Authentication
The parameters sender's certificate, time, sig are described in clause
6.1.1.1.2.2 "Broadcast Messages Protected by Certificate based
authentication".
## 6.2 Solution #2: V2X Communication Security
### 6.2.1 Security requirements addressed
This solution addresses the security requirements given in subclause 5.1:
### 6.2.2 Solution details
There is no stage 2 relevant solution that has been identified in the
TR23.785[3].
The security requirements applicable to V2X communications from the above
section are all satisfiable by employing application-layer security as defined
in other SDOs.
### 6.2.3 Justification for the solution
The data transmission (V2X communications) involve the vehicle UEs sending
periodic broadcast messages, and can occur either on the PC5 interface or on
the Uu interface. The analysis and solutions below apply to both of these
modes of transmission. It is assumed that when the V2X messages go through the
eNB, they are rebroadcasted with their original protection, such that each
receiver UE can employ the same mechanism to evaluate the security of the
received messages. Thus, in effect, the V2X communication is point to
multipoint in a dynamically changing set of vehicle UEs.
**Observation 1** : the V2X communication is point to multipoint in a
dynamically changing set of vehicle UEs.
_Existing LTE security_
We note that the security provided by the LTE system provides credentials for
point to point use, between one UE and the home network (HSS), and therefore
is not applicable to this point to many points, ad-hoc, broadcast type of
communications. Hence, we make the following observation:
**Observation 2** : the LTE UE AS or NAS security is not appropriate to end-
to-end integrity-protect the periodic broadcast V2X messages sent by vehicle
UEs.
_Existing ProSe communications security_
Regarding ProSe security for one-to-many or broadcast group communication, we
find that it is not applicable either. A logical way to envision groups is
based on location or communication/broadcast range. But these groups are
obviously constantly in flux as vehicles drive around. If the group membership
is extended to large regions, then provisioning one single group key weakens
security. The drawbacks of the existing ProSe group communications security
can be summarized as follows:
\- Groups of vehicle UEs cannot easily be defined dynamically, especially when
out of coverage. The vehicle UEs in communication range (or in proximity)
cannot be assumed to be provisioned with key material to enable symmetric key
based message authentication codes.
\- In ProSe communication, any member can derive any other member's ProSe
Traffic Key, making it impossible to guarantee proper identification of the
sender for traceability that the V2X application needs.
This analysis leads to the next observation:
**Observation 3** : The ProSe group communication (one to many or broadcast)
security is not appropriate to end-to-end integrity-protect the periodic
broadcast V2X messages sent by vehicle UEs.
_Is there a need to design V2X communication security at the 3GPP layer?_
We also note that other SDOs have defined mechanisms above the
network/transport layer to meet the requirement for both integrity of data and
anonymity of the sender (i.e., pseudonymity). Both the US and EU standards
refer to the IEEE 1609.2[18] standard, which is an open standard that has been
worked on for the past decade by a panel of security experts, and subject to
open review by any interested parties.
## 6.3 Solution for attach identifier obfuscation for vehicle UE privacy
### 6.3.1 Security requirements addressed
This solution corresponds to the Key Issue #7 \"Vehicle UE privacy \".
### 6.3.2 Solution details
The solution is based on reference [5]. UE identities used for the V2X
communication are managed separately (e.g. by an organizationally distinct
3^rd^ party Server such as a Vehicle OEM) from the existing 3GPP identities,
and are referred to as _PMSIs_ (Pseudonymous Mobile Subscriber IDs). This
solution is summarized below.
{width="6.367361111111111in"
height="2.7402777777777776in"}{width="4.946527777777778in"
height="2.270138888888889in"}
Figure 6.3.2-1: Provisioning of PMSIs
As an initial step, the UE requests authorization for V2X operation from the
home V2X Control Function. This can be done based on the 3GPP identity as
usual, and in consultation with the HSS for the UE subscription.
Note: The roaming, privacy or IMEI and its impact on the network, long term
key provisioning, LI, and charging aspects are not addressed in this solution.
The following characteristics of the entities shown are assumed:
\- The Vehicle-UE can establish a secure end to end link to the 3^rd^ party
Server (e.g., Pseudonym CA or Vehicle OEM). The Vehicle UE also shares
traditional LTE credentials with its MNO.
\- In addition, the MNO shares pool of tickets (certificates) with each
Vehicle-UE, which will be used for authorization of Vehicle-UE during PMSI
distribution from Pseudonym CA to the Vehicle-UE. MNO shares with Pseudonym CA
its pubic key, which is used for verification of tickets.
\- The MNO employs a function that generates (PMSI, Key) pairs for attachment.
Distributes periodic key to all of its v-UEs.
Referring to Figure 6.3.2-1, the cited solution proposes that the MNO
provisions each of its vehicle UEs with a shared (same for all UEs) key,
_K~PERIOD,\ ~_ for the PMSIs, in order to hide the PMSIs from the 3^rd^ party
Server. In the LTE V2X architecture, this could be realized by the V2X Control
Function sending a shared PMSI Key to each of its UE upon authorization
success.
The following steps take place.
1) vUE establishes secure link with its MNO, e.g. V2X Control Function,
requests a temporary (e.g. monthly) key _K~PERIOD~ and tickets (i.e. random id
with signature by MNO)._
2) vUE gets MNO's temp key _K~PERIOD.~_ All vUEs get the same temporary shared
key. Additionally, vUE gets pool of tickets, where a ticket is used for each
request of PMSI subpool to Pseudonym CA.
3) For each Pseudonym CA (PCA), MNO generates many (PMSI, K~PMSI~) pairs,
encrypts each one with _K~PERIOD.\ ~_ MNO sends this megapool and its public
key to verify the signature of tickets to the PCA.
NOTE: (this step can be done in advance of 1,2).
4). vUE establishes a secure link to its PCA, gets PCA K~vUE~. vUE and PCA
establish and end-to-end secure link based on this key. vUE sends a ticket
(i.e. random id with signature by MNO) to PCA. The MNO link (WAN) may be used
as transport.
5). PCA verify the ticket, and if it is valid, PCA selects a subpool of (PMSI,
K~PMSI~) pairs for this IMSI, stores mapping. PCA sends subpool to vUE.
6). vUE decrypts each received (PMSI, K~PMSI~) pair with _K~PERIOD~_
At this point the vUE has several (PMSI, K~PMSI~) pairs that it can use to
attach with. The MNO will know that this PMSI was authorized, but not the IMSI
of the UE.
### 6.3.3 LI support
For LI in a home network, LEA requests tickets and K~PERIOD~ given to target
IMSI or UE to MNO, and then requests encrypted PMSI sub pools given for this
tickets to Pseudonym CA. LEA can now find PMSIs of the target ISMI or UE, and
use this for LI Functions. LEA needs to repeat the same procedure during the
period of LI, because V2X UE will renew the tickets and PMSI sub pools as time
expires. Figure 6.3.z-xx illustrates the steps.
{width="7.095138888888889in" height="1.6694444444444445in"}
Figure 6.3.3-1: PMSI acquisition procedure of LEA for LI
LI in roaming case is supported as follows.
When V2X UE roams into a visited network, it could use existing inter-MME
handover, or roaming procedure for LTE access. After then, V2X UE can request
tickets and PMSI subpool from the new serving network and its affiliated
Pseudonym respectively, as it does in home network. LEA in the visited area
could perform LI as in the home network, without the aid of home network.
Alternatively, to avoid IMSI uses, V2X UE can send V2X tickets (tickets
provided for PMSI subpools in home network) to the serving network, instead of
GUTI or IMSI. Home network information should be included in the request. The
home network discovers IMSIs for tickets, and responds with IMSI and
authentication data to the visited network. After then, the newly serving
network can provide a new ticket, which V2X UE can use to request PMSI
subpools to Pseudonym CA affiliated with the serving network. With new PMSIs
and tickets, LEA in visited network can perform LI on the target V2X UE as in
the home network, without the aid of home network.
> NOTE 1: There is a risk of losing ticket to a fake serving network, and for
> that matter, ticket could be encrypted with K~PERIOD~.
>
> NOTE 2: For the service continuity, in the border area, networks with
> roaming agreements could accept PMSIs from multiple Pseudonym CAs, while V2X
> UE is requesting new PMSIs from a newly serving network and its affiliated
> Pseudonym CA
## 6.4 Data communication security between network entities
### 6.4.1 Security requirements addressed
This solution addresses the security requirements given in subclause 5.Y.
### 6.4.2 Solution details
For all interfaces between network elements,
> TS 33.210 [7] shall be applied to secure signalling messages on the
> reference points unless specified otherwise, and
>
> TS 33.310 [8] may be applied regarding the use of certificates with the
> security mechanisms of TS 33.210 [7] unless specified otherwise in the
> present document.
NOTE: For the case of an interface between two entities in the same security
domain, TS 33.210 [8] does not mandate the protection of the interface by
means of IPsec.
## 6.5 Solution for Vehicle UE privacy from the MNO based on attach data
### 6.5.1 Security requirements addressed
This solution addresses the security requirements given in subclause 5.7:
\"It shall be possible to prevent the LTE network from using the data gained
by a UE attaching to it for V2X service for purposes of tracking the UE. \"
### 6.5.2 Solution details
#### 6.5.2.1 Simultaneous re-attach with new identities
This solution proposes the following measures.
First of all, the UEs should attach using a method of hiding the real UE
identity from MNO. Without such an approach, the MNO would be able to track
the UE based on the identity used to attach.
Ideally to prevent tracking, all UEs should re-attach simultaneously. This has
implication on load for the network and hence it is proposed that all UEs
under an eNB should detach completely and then re-attach at substantially the
same time. The impact on the eNB is a possible delay of the attaching
procedure, causing the UE to not be able to send user data on Uu for a short
while (but the UE can use the direct mode in the meantime).
In addition, the UE should change its app-layer identifier and corresponding
credential) when the UE re-attaches with its new identity.
#### 6.5.2.2 MME Load spreading
Notably the signalling load on MME increases if all UEs try to re-attach at
the same time. However, if all UEs attach simultaneously at each eNB, but at
different times to those under a different/neighbouring eNB, then tracking
mitigation is still achieved but the signalling load on the MME is spread over
time.
As an example, suppose it takes 5 seconds for an eNB to complete all re-attach
procedures of the vehicle UEs it serves. Then there are 60 possible time
boundaries for each eNB to select from when the period is 5 min (300 seconds).
Thus, the load of the MME is only 1/60^th^ than what it could be if all UEs
from all eNBs attach at the same time.
Therefore, it is necessary for all UEs served by an eNB to determine the re-
attach boundary time of when the next re-attach should occur.
#### 6.5.2.3 Re-attach boundary time determination
The re-attach period is one parameter that the UEs need to know. This can be a
system parameter, configured at authorization time, or given by the eNB upon
initial attach.
Another parameter that the UEs need to know is when the next re-attach
boundary time is for this eNB.
Some considerations on the re-attach timing are:
To prevent a UE needing to re-attach too frequently, the UE may ignore a
boundary if it recently re-attached less some specified time ago (e.g., less
than 1 min).
It is presumed that UEs must be running their own clock. The UEs should still
re-attach if the timer goes beyond the 5 minutes period (e.g., at time= 7
minutes). This may happen due to changing cells just before a boundary
occurred at the original cell for example. If the UE performs a detach
procedure before leaving the original cell, and an attach to the new cell,
then if it uses a new attach ID, then the reattach timer at the UE is reset.
The re-attach boundary time should be different amongst the eNBs served by a
given MME. This can be achieved statistically if each eNB self-selects a re-
attach boundary time for its UEs. See Figure 6.5.2.4-1.
There are several options for UEs to obtain the re-attach boundary time for
the eNB they are currently served by.
\- _Option 1_ : Boundary time can be inferred by UEs from a given timing
source and some eNB specific identifying data: e.g., the boundary time can be
a deterministic function of an eNB identifier (e.g. PCI) and the current (UTC)
time in seconds. The time can be obtained normal operation from a SIB, or
perhaps GNSS.
_\- Option 2_ : the eNB can signal the boundary time in a SIB.
_\- Option 3_ : the eNB can give each UE the boundary time upon first attach
procedure, e.g. via RRC signalling.
Figure 6.5.2.4-1: Example of boundary re-attach time difference amongst
neighbouring eNBs
#### 6.5.2.4 Detach and Re-attach triggers
The NAS layer in a UE makes decisions regarding detach and re-attach. Whenever
V2X privacy is enabled, the NAS has two parameters to take into account when
making such a decision:
a) Reattach period
b) Reattach boundary value for the serving eNB
The NAS keeps track of a UE Reattach Timer (second-level is sufficient), which
is reset upon every re-attach procedure. The NAS should also be able to obtain
the current time (second-level accuracy) from the lower layers, and a boundary
value for that eNB, from which it can calculate the time instance at which it
needs to trigger a detach and re-attach.
In summary, the NAS triggers a detach and re-attach whenever
1) The current time value matches a boundary time instance for that eNB, and
the UE Reattach Timer has a large enough value less than the Reattach period
(i.e. a re-attach has not just occurred) or
2) The current UE Reattach Timer has exceeded a certain maximum value (larger
than the Reattach period) for privacy protection.
The NAS triggers a detach and a re-attach, and also the upper layers to do a
change in the upper layers identifiers used for V2X messages.
_Example_
Suppose it takes T~Reattach~ = 5 seconds for an eNB to complete the re-attach
procedures for all UE it serves. Let the re-attach period be 5 minutes,
P~Reattach~ = 300 seconds. There are N = P~Reattach~ / T~Reattach~ possible
boundary values. If the eNB-specific data is taken to be the PCI (which has
504 possible values), then the boundary time can be calculated from the eNB-
specific value ID~eNB~ = PCI mod N. ID~eNB~ could also be self-selected by the
eNB.
In this case, the UEs are to re-attach whenever (CurrentTime - T~Reattach~ ×
ID~eNB~) mod P~Reattach~ = 0.
## 6.6 Solution for Vehicle UE privacy based on data traversing the network
### 6.6.1 Security requirements addressed
This solution addresses the security requirements given in subclause 5.7.:
_The content of the data transmitted by a vehicle UE should not lead to the
ability of another V2X entity (UE, network, application server) to identify
and track the sender UE beyond a short time period necessary for the V2X
application._
### 6.6.2 Solution details
Some V2X applications may require location data to be sent by the UE directly
to the V2X Application Server (AS). As this data is sent across the MNO's
network, it could be used to track the UE if it is sent unencrypted.
If the V2X Application Server is not in the operator domain, then the link
between the UE and V2X AS used for end to end messages should be encrypted, to
provide UE location privacy from the operator, and to protect the UE from any
other entities that might eavesdrop on the path from the UE to the V2X AS. As
the details of the application are out of scope of 3GPP, it is proposed that
any such confidentiality protection is left to the specification of the
application.
In addition, to ensure that it is not possible for the V2X AS to track the UE
based on its application data, the included app layer identities need to be
changed periodically (e.g. every 5 minutes). This is independent of the
measures to obfuscate the attach identities.
When this application data is carried over the operator's network, there will
also be lower layer identities that will need to be changed at the same time,
e.g. IP address or any security parameters between UE and V2X server, so that
the V2X AS cannot link two app layer identities based on the lower layer
parameters used on that link.
**Hence it is proposed that for such V2X applications, when the UE changes its
app-layer identifier it also re-attaches to the network to refresh all the
lower layer identities that will be visible to the V2X AS.**
This could happen by detaching and then re-attaching from the network, PDN
dis-connection/reconnection or some other method to cause a change of IP
address. Whatever method is chosen, the P-GW carrying the V2X traffic needs to
ensure that the network provided UE identities carried in the V2X traffic
cannot be linked with those used the previous times the UE attached (before
the UE tried to change).
NOTE 1: If the V2X AS is local, then it may be beneficial for the UE to change
identities at the same time as other UEs---as in solution 6.5
Note 2: Randomization of the timer is not addressed in this solution.
## 6.7 Solution for authorization and accountability
### 6.7.1 Addressed key issues
The solution addresses the key issues on authorization such as Key issue #2,
#5 and #9 and Key issue #8 on accountability. It builds on the assumption that
the security for V2XLTE is based on reusing solutions from other SDOs. This is
in line with the proposal in Solution #2.
### 6.7.2 Justification of the solution
The solution assumes that security mechanisms from other SDO's such as the
ones described in Annex B and Annex X are used at the application layer. In
these mechanisms V-UE's are required to run an authorization procedure with a
Trusted Traffic Authority (TTA) in order to take the long-term application
credentials into use. Since these credentials are private, the TTA must be
independent from the MNO and therefore neither collocated with a V2X Control
Function nor with a V2X Application Server.
It is reasonable to assume that the above-mentioned authorization from the TTA
needs to be renewed on a regular basis. In fact, there might be several
reasons for which a V-UE could become unauthorized, for example if the vehicle
did not pass certain safety tests during the last check, or if the vehicle is
no longer insured, etc.
In the V2XLTE system, the authorization procedure for the V2X communication,
as specified in the 3GPP TR 23.785[3], is illustrated in Figure 6.2.2-2. It is
based on the service authorization for proximity services specified in the
3GPP TS 23.303[9] under clause 5.2. The procedure relies solely on
subscription information and is fully under the control of the V2X Control
Function.
{width="4.184722222222222in" height="1.8541666666666667in"}
Figure 6.7.2-2: Authorization procedure
The authorization status of a V-UE in the MNO domain is not related to the one
in the TTA domain. To preserve privacy of the V-UE, the long-term certificates
or identifiers used for authorization towards the TTA are not shared with the
MNO. If the MNO would know the status of the V-UE authorization in the TTA
domain, this could bring also advantages, which would be as follows. It
protects the MNO's network from misuse by V-UEs, which are not authorized by
the TTA. This, in turn, helps the MNO network save resources by not allocating
them to V-UEs, unauthorized in the TTA domain, in the first place.
### 6.7.3 Description of the solution
It is proposed that a V-UE is first authorized at a relevant TTA, thus
obtaining some type of evidence that could be used by a V2X Control Function
during the service authorization procedure as shown in Figure 6.7.2-2. More
precisely, the updated authorization flow is illustrated in Figure 6.7.3-1.
Figure 6.7.3-1: New authorization procedure
Step 0: The V-UE attaches to the network and acquire a PDN connection.
Step 1: The V-UE establishes a secure channel to the relevant TTA and runs an
authorization or enrolment procedure. The authorization or enrolment procedure
neither affects the solution nor is in the scope of the solution. Upon a
successful authorization, the V-UE obtains evidence from the TTA, for example
in a form of an access token.
Step 2, 4 and 5: The service authorization with the V2X Control Function
proceeds as defined in the 3GPP TR 23.785 [3] with an addition that the
evidence from the TTA is presented to the V2X Control Function in the HPLMN
and also the possibility that the Control Function communicates directly with
the TTA to validate the evidence (Step 3).
NOTE 1: Step 0 may not be necessary for the TTA authorization when a non-3GPP
access, e.g. WIFI is used.
NOTE 2: Step 3 may not be necessary as the evidence can be self-contained.
Otherwise direct communication between the V2X Control Function and the TTA
cannot be totally precluded as it can be useful for example to propagate
authorization status changes and related information.
In order to propagate revocation information from the TTA domain to the MNO
domain, some form of additional communication would be required between the
TTA domain and the V2X Control function. However, such additional
communication may be avoided if the TTA provides the V-UE with the evidence
that has an expiry time, thus requiring the V-UE to renew the evidence on a
regular basis. Other security requirements might be needed to guarantee the
authenticity, integrity and freshness of the evidence.
Furthermore, it could be required that the evidence is signed by the TTA so
that the V2X Control Function can check its authenticity. In addition, it
could be required that it is protected against replay by including timestamps,
etc.
Finally, it could be required that the TTA authorization evidence is unique
per V-UE. As a result, the evidence binds the V-UE to a specific long-term
certificate in the TTA domain and to a specific subscription in the MNO
domain. For example, this can be used by the MNO to report V-UEs sending
malformed messages to the TTA and can also be used by the TTA to notify the
MNO in case a particular V-UE is no longer authorized.
## 6.8 Security of UE to V2X Control Function interface
### 6.8.1 Security requirements addressed
This solution addresses the security requirements given in subclause 5.15
NOTE: If this solution is accepted in the TS, PC3 security solution as defined
in TS 33.303 [12] should be referenced instead of Annex B.
### 6.8.2 Solution details
#### 6.8.2.1 Security procedures for configuration transfer to the UICC
After deployment of the V2X enabled UE the configuration parameters stored in
the UICC may need to be updated to reflect the changes in the configuration
applied.
In case that configuration data of V2X enabled UE are stored in the UICC, the
UICC OTA mechanism (as specified in ETSI TS 102 225 [20] / TS 102 226 [21] and
3GPP TS 31.115 [22] / TS 31.116 [23]) shall be used to secure the transfer of
the configuration data to be updated in the UICC.
#### 6.8.2.2 Security procedures for data transfer to the UE
This subclause describes procedures for protecting data transfer between UE
and V2X Control Function (called the network function in the below
procedures).
For UE initiated messages, the procedures specified by clause 5.4 of TS 33.222
[24] shall be used with the following addition. The network function may
optionally include an indication in the PSK-identity hint in the
ServerKeyExchange message over the Ua interface to inform the UE of the FQDN
of the BSF with which the UE shall run the bootstrapping procedure over the Ub
interface as specified in TS 33.220 [25] to provide the key material for
establishment of the TLS tunnel. When performing such bootstrapping with the
indicated BSF, the UE and BSF shall use the provided FQDN as the BSF Identity
in all places, e.g. forming the B-TID. If there is no such indication, the UE
shall perform the bootstrapping with the BSF at the address given in TS 23.003
[26].
The UE may also hold a B-TID, Ks and other associated material from
bootstrapping runs with different BSFs simultaneously.
A network function that implements the NAF functionality (cf Annex B.2 or
Annex B.3) shall request USSs from the BSF when requesting the
Ks_(ext/int)_NAF key and the network function shall check in the USS if the
USIM is authorized to be used for V2X services. If the authorization in the
network function fails, then the network function shall release the PSK-TLS
connection with the UE. Otherwise (cf Annex B.4) the retrieval of
authentication vectors and authorization of the V2X UE shall be performed
using the PC4a interface instead of the Zh interface. If the V2X Control
Function does not have a unused Authentication vector associated with the V2X
UE, the V2X Control Function shall request one Authentication Vector from the
HSS over the PC4a interface. V2X Control Function shall always indicate to the
UE, in the Ua message carrying the ServerKeyExchange of the PSK-TLS handshake,
that the Ks_NAF key shall be used to bootstrap the PSK-TLS security on the PC3
interface, by setting the psk_identity_hint field to a static string \"3GPP-
bootstrapping\".
NOTE 1: Annex B describes the possible network options for PC3 security. The
UE behaviour remains the same regardless of the network option used.
NOTE 2: When the termination points of both the Ua and Ub interfaces reside in
the network function then the implementation of the Zn interface is an
operator decision. However, if the operator considers deploying a stand-alone
BSF for use by the network function, then the operator should use the
canonical BSF name from TS 23.003 [26] and the Zn interface should be
available in the network function already from the start although it would
only be used internally to the network function until a stand-alone BSF was
deployed. Otherwise, implementation changes to the network function will
become necessary at the time of introducing the stand-alone BSF.
For network-initiated messages one of the following mechanisms shall be used:
> \- If a PSK TLS connection has been established as a part of a pull message
> and is still available, the available PSK TLS session shall be used.
>
> \- Otherwise, PSK TLS with GBA push based shared key-based mutual
> authentication between the UE and the network function shall be used. GBA
> push is specified in TS 33.223 [27]. The network function (pushNAF) shall
> request USSs from the BSF when requesting a GPI, and the network function
> shall check in the USS if the USIM is authorized to be used for V2X
> services. If the authorization in the network function fails, then the
> network function shall refrain from establish PSK TLS with GBA push.
NOTE 3: If a TLS connection is released, it can only be re-established by the
client, i.e. UE, even though the TLS session including security association
would be alive on both sides. TLS connection, in turn, is dependent on the
underlying TCP connection.
#### 6.8.2.3 Alternative security procedure for data transfer between UE and
V2X Control Function
The V2X control function (VCF) and V-UE could use a share key to do mutual
authentication and establish a secure channel based on PSK TLS. The pre-shared
key could be derived during the AKA procedure when the V-UE attach to the
network through UU interface.
The new key hierarchy based on the 3GPP TS 33.401 [13] is presented as
follows:
Figure 6.8.2.3-1 Key Hierarchy Based on TS 33.401[13]
According to the V2X architecture defined in the TS 23.285 there is no
communication interface between VCF and MME, but VCF could communicate with
HSS through V4 interface, so VCF could acquires key or materials from HSS. The
new branch of key derivation is that, the V-UE and HSS derives a root key KV2X
respectively for V2X service during AKA procedure, and then V-UE and VCF
derive a pre-shared key KPSK from KV2X respectively. The V-UE and VCF could
utilize the KPSK and PSK TLS protocol to perform mutual authentication and
establish a secure channel on user plane.
Note: This solution does not address the case when V-UE is not connected to
the network.
Refer to the key derivation function in TS 33.401 [13], the Kv2x and Kpsk are
derived as follows:
**KV2X Derivation Function:**
When deriving a KV2X from CK, IK and SN id when producing authentication
vectors, and when UE computes KV2X during AKA, the following parameters shall
be used to form the input S to the KDF.
\- FC = 0x20,
\- P0 = SN id,
\- L0 = length of SN id (i.e. 0x00 0x03),
\- P1 = SQN ⊕ AK
\- L1 = length of SQN ⊕ AK (i.e. 0x00 0x06)
_The exclusive or of the Sequence Number (SQN) and the Anonymity Key (AK) is
sent to the UE as a part of the Authentication Token (AUTN), see TS 33.102. If
AK is not used, AK shall be treated in accordance with TS 33.102, i.e. as
000...0._
The SN id consists of MCC and MNC, and shall be encoded as an octet string
according to Figure 6.8.2.3-2.
* * *
8 7 6 5 4 3 2 1  
MCC digit 2 MCC digit 1 octet 1  
MNC digit 3 MCC digit 3 octet 2  
MNC digit 2 MNC digit 1 octet 3
* * *
Figure 6.8.2.3-2 Encoding of SN id as an octet string
The coding of the digits of MCC and MNC shall be done according to TS 24.301
[9].
The input key Key shall be equal to the concatenation CK \|\| IK of CK and IK.
**KPSK Derivation Function:**
When deriving KPSK from KV2X the following parameters shall be used to form
the input S to the KDF.
\- FC = 0x21
\- P0 = Value of the U2C Counter as a non-negative integer
\- L0 = length of the U2C Counter value (i.e. 0x00 0x02)
The input key shall be 256-bit KV2X.
Fig.6.8.2.3-3: KPSK Derivation
**U2C counter maintenance**
The VCF shall associate a 16-bit counter, U2C (V-UE to VCF) counter.
The U2C counter is used when computing the KPSK for the TLS tunnel setup
between V-UE and VCF. The V-UE and the VCF shall treat the U2C counter as a
fresh input of KPSK derivation.
The VCF maintains the value of the U2C counter for duration of the TLS
connection between V-UE and VCF. The V-UE does not need to maintain the U2C
counter after is has computed the KPSK since the VCF provides the V-UE with
the current U2C counter when the V-UE needs to compute a new U2C counter.
The VCF shall initialize the U2C counter to '0' when the KV2X is established
or refreshed. The VCF shall monotonically increment the U2C counter for each
subsequent calculation of the KPSK.
## 6.9 Solution using encrypted IMSI to proven MNO identifying the UE
### 6.9.1 Security requirements addressed
This solution addresses Key Issue #7 \"Vehicle UE privacy \". In particular,
it addresses the requirement to hide the identity of the subscription from the
MNO.
### 6.9.2 Solution details
#### 6.9.2.1 Overview
The proposed solution requires the following three changes from the regular
LTE attachment and authentication.
1\. Encrypting IMSI used at attach: Clearly the UE cannot send its own IMSI in
the clear to the network at Attach Request. The proposal is to encrypt the
IMSI with a key that is itself encrypted with the public key of the HSS and
have this value transparently passed onto the HSS by the MME. The MME knows
which HSS to use either because the presence of the Encrypted IMSI IE or by a
default IMSI value inserted by the UE. The UE gets the public key of the HSS
during the authorisation procedures with the V2X Control Function. A default
IMSI value can be supplied at the same time if needed.
2\. Encrypting the AV: In effect, an AV can be used to identify whether a
particular mobile is receiving the challenge, i.e., a mobile with the correct
subscription will respond with either a RES or an AUTS while the other mobiles
will respond with an authentication failure message. If a network is not to
have the ability to track a UE, then that a network should not have the
ability to determine if a particular subscription is trying to attach to the
network. Furthermore, in the second scenario, when the home operator provides
the AVs to authenticate the UE and is serving the UE, it will be able to bind
the AV to a particular subscription without involving the UE. This is because
the home network's HSS generates the AV and the home network's MME is checking
the authentication of the UE with that AV. The method of encrypting the AVs
involves the UE sending an encryption key along with the encrypted IMSI to HSS
(via the MME) in the attach procedure. The HSS encrypts the AV using this key.
In effect this method binds the AV to a particular attach and hence breaks any
long-term link with the UE's IMSI, i.e. if used in a different attach
procedure the AV will result in an authentication failure.
NOTE 1: The HSS will need to be scaled to deal with the extra load of
decrypting the AV_Key.
Note 2: Potential impact of DoS attacks on the HSS has not been considered.
3\. Providing an IMSI from the HSS to use during attach: The final change is
that the HSS provides the MME with an Attach IMSI to use while the UE is
attached. The supplied IMSI points to the HSS and hence the MME can run all
its procedures as normal using this IMSI.
Two different deployment models are covered as described below.
Note 3: The LI implication for both deployment models has not been considered.
Lawful Intercept can still be performed on the IMSI related to the
subscription provided that the HSS in the first model and the V2X VMNO are
deployed in the same regulatory environment as the serving network. In this
case, a set of Attach IMSI would be decided to be ones that would trigger
interception in the serving network. The HSS could then report an LI event
(for an IMSI that is subject to interception) providing the Attach IMSI that
was assigned to the subject IMSI. In this case, the Attach IMSI would be
chosen so that the MME and other node in serving network would also provide
interception for the relevant events. The LEA could then tie the original IMSI
with interception events in the serving network via the Attach IMSI.
#### 6.9.2.2 HPLMN issuing the V2X subscription
##### 6.9.2.2.1 Details of use case
In this use, a specific HPLMN issued V2X subscription is used to access the
LTE network for the purposes of V2X services that require privacy from the
serving MNO. The HMPLN runs a HSS for these subscriptions and is the home
operator for the subscriptions.
##### 6.9.2.2.2 Attachment flows
The following figure shows the UE attaching to the network for V2X services
that require privacy from the serving operator. After the flows everything
proceeds as normal LTE.
Figure 6.9.2.2.2-1: Attach flows using an encrypted IMSI, V2X MNO subscription
1\. UE is authorised to use V2X service requiring network attachment on V3
interface. UE receives public key of HPLMN's HSS during this process. The UE
and V2X function also agree the method that will be used to encrypt the IMSI
and the AV. The UE may use a regular LTE attach (i.e. sending IMSI) to enable
access to the V2X Control Function.
Note: Recovery in case of attach failure has not been taken into account.
2\. UE generates a fresh AV_Key (that will be used to protect the AV) and
encrypts the AV_Key using the public key of the HPLMN HSS. The IMSI is
encrypted using the AV_Key using the method agreed at step 1.
3\. The UE sends an Attach Request message that includes the encrypted IMSI
(encrypted with the AV_Key) and AV_Key(encrypted with the public key of the
HSS) to the MME. It also include the MCC and MNC of its HPLMN.
4\. MME requests an AV from the HPLMN HSS (using the MCC and MNC received for
the UE to rout the message to the correct HSS). It includes the encrypted IMSI
and AV_Key received in the Attach Request.
5\. HPLMN HSS decrypts the received encrypted AV_Key and then uses this to
decrypt the received encrypted IMSI.
6\. HPLMN HSS generates a new AV for the IMSI
7\. HPLMN HSS protects AV using the provided AV_Key. The encryption is done in
such a way that the AV still has the form RAND, AUTN, XRES and K~ASME~ so it
can be treated as a regular AV by the MME.
8\. HPLMN HSS selects an Attach-IMSI to assign to this attachment and sends
both this Attach-IMSI and protected AV to the MME. The Attach-IMSI has
identical format to a real IMSI and allows the MME to perform all the
functions that require an IMSI when serving the UE. The selected Attach-IMSI
should be different for each attachment of a particular UE
9\. MME stores received Attach-IMSI and uses this for this attachment and
authenticates the UE using received protected AV
10\. UE recovers original RAND and AUTN from ones sent by MME and gets K~ASME~
and RES from the USIM as normal LTE operation. Before using K~ASME~ and RES,
the UE protects them in the same way as HPLMN HSS did.
In addition to the above, the UE never sends its IMEI to the network when
attached for privacy respecting V2X services. The MME should also not request
the IMEI in these cases.
##### 6.9.2.2.3 Encrypting IMSI and AVs
###### 6.9.2.2.3.1 General
To minimize the number of public key cryptography operations, the UE uses the
Public Key to securely carry the AV_Key to the HSS and then the AV_Key to
encrypt the IMSI and the AV.
Note: This solution does not provide details of the encryption.
#### 6.9.2.3 Regular subscription
##### 6.9.2.3.1 Details of use case
In this case a regular subscription can be used. But rather than the serving
MME contacting the HMPLN's HSS, it contacts a V2X VMNO's HSS for all the HSS
functions it needs (exactly as in the first use case above). Unlike the first
use case where the contacted HSS can generate the AVs for the subscriber, the
AVs are fetched from the Home MNO. The V2X VMNO's HSS in effect hides the real
IMSI from the MME and also prevents the UE's HPLM HSS from knowing where the
UE is registering. This V2X VMNO's HSS does this in exactly the same way as
the V2X MNO in the first use case. From a deployment and required changes to
LTE perspectives, the second use case can be seen as a simple extension of the
first case. It is assumed that there is only one V2X VMNO for each serving
network.
##### 6.9.2.3.2 Attachment flows
The following figure shows the UE attaching to the network for V2X services
that require privacy from the operator. After the flows everything proceeds as
normal LTE.
Figure 6.9.2.3.2-1: Attach flows using an encrypted IMSI, regular subscription
The following provides the details of the flow.
1\. Same as 1 in 6.9.2.2.2.1 except it is the public key of the V2X VMNO HSS
that is received
2\. Same as 2 in 6.9.2.2.2.1
3\. The UE sends an Attach Request message that includes the encrypted IMSI
(encrypted with the AV_Key) and AV_Key (encrypted with the public key of the
HSS) to the MME. It also includes the MCC and MNC of its V2X VMNO.
4\. The MME requests an AV from the V2X VMNO HSS (using the MCC and MNC
received for the UE to rout the message to the correct HSS). It includes the
encrypted IMSI and AV_Key received in the Attach Request.
5\. Same as 5 in 6.9.2.2.2.1 except HPLMN is replaced by VMNO
6a. V2X VMNO HSS requests an AV for the IMSI (i.e. it acts like an MME towards
the Home HSS)
6b.Home HSS sends an AV to the V2X VMNO HSS
7\. Same as 7 in 6.9.2.2.2.1 except HPLMN is replaced by VMNO
8\. Same as 8 in 6.9.2.2.2.1 except HPLMN is replaced by VMNO
9\. Same as 9 in 6.9.2.2.2.1
10\. Same as 10 in 6.9.2.2.2.1
#### 6.9.2.4 Changes from legacy LTE
##### 6.9.2.4.1 Changes for V2X MNO subscription
The following provides the list of changes that are required to support the
solution described in subclause 6.9.2.2:
UE impact
Encrypt IMSI and AV_Key with public key of HSS
Include the above in Attach Requests in new IEs
Decrypt RAND and AUTN from Authentication Request message
Encrypt RES and K~ASME~
Never send IMEI when attaching with V2X privacy enabled
MME impact
Receive Encrypted IMSI and AV_Key in Attach Request
Include these in request for AVs to the V2X MNO HSS, which is determined due
to presence of encrypted IMSI IE
Receive Attach-IMSI along with AV
Use Attach-IMSI as the IMSI for this UE
Never request IMEI when UE attaches this way
HSS impact
Receive Encrypted IMSI and AV_Key in the request for AVs
Decrypt IMSI and AV_Key
Protect AV
Generate Attach-IMSI and manage relationship with real IMSI
Include Attach-IMSI with AV response
##### 6.9.2.4.2 Changes for regular subscription
For the regular subscription use case, the changes for the V2X MNO
subscription apply plus the following one:
V2X VMNO's HSS needs to act like an MME to fetch AVs from the UE's HPLMN HSS
In particular, no further changes are needed for the UE, MME and UE's HPLMN
HSS.
### 6.9.3 Evaluation
The use of public key cryptography to protect the AV_Key (and indirectly the
IMSI) in the Attach Request message adds a large information element to that
message.
## 6.10 Solution for communication security with the V2X network entities
### 6.10.1 Addressed key issues
The solution addresses Key issue #1 on V2X communication security (clause
5.1).
### 6.10.2 Justification of the solution
The architecture reference model for V2X is based on that of ProSe where the
different V2X network entities are playing similar roles and thus running
similar procedures as in ProSe. This is reflected in the reference point names
where the numbering (V1, V2, V3...) is consistent with that in the ProSe
reference point names (PC1, PC2, PC3...). Security mechanisms that protect
interfaces like PC2, PC3 and PC4 have been already devised in TS 33.303[12].
Therefore, it is valid to consider similar mechanisms applicable for V2X.
### 6.10.3 Description of the solution
#### 6.10.3.1 Security of the reference point V3 between the V-UE and the V2X
Control Function
It is proposed to reuse the security mechanisms from TS 33.303[12] clause 5.3
where UICC OTA mechanisms are used for configuration transfer to the UICC, and
GBA for the data transfer to the UE.
#### 6.10.3.2 Security of the reference point V2
It is proposed to reuse the mechanisms from TS 33.303[12] clause 5.4.
#### 6.10.3.3 Network domain security
For all interfaces between network entities such as V4 and V6, it is proposed
to reuse the mechanisms from TS 33.303[12] clause 5.2.
## 6.11 Solution #11: V2X Communication Security
### 6.11.1 Security requirements addressed
This solution addresses the security requirements given in subclause 5.17.3.
### 6.11.2 Solution details
The MB2 interface as referenced in 3GPP TS 23.285 [11] and described in detail
in 3GPP TS 23.468 [28] handles the communication between V2X AS and BM-SC for
signalling data (MB2-C) and user data (MB2-U) and shall be protected against
eavesdropping and manipulation of data. V2X AS is an instantiation of the GCS
AS
It is proposed that communication via the V2X MB2 interface shall follow the
security solutions for MB2-C and MB2-U as given in 3GPP TS 33.246 [10] annex
N.2 and annex N.3.
## 6.12 Hiding UE identity from other V2X UEs and the serving network
### 6.12.1 Requirements addressed
This solution addresses the requirement [R.5.3-005] of 3GPP TS 22.185 that a
UE can only be tracked by another UE for a short time period by using
pseudonyms. Further it also secures UE\'s privacy against the visited
operator.
The privacy related security requirements addressed by this solution are also
referenced in section 5.7.3 of this TR.
### 6.12.2 Solution details
#### 6.12.2.1 Overview
A pseudonym is used to hide the UE identity from the visited operator, from
other UEs, and from all network elements of the home operator domain, except
the HSS. The visited operator cannot track a V2X-UE beyond the short time of
pseudonym validity. It is suggested that the home operator manages these
pseudonyms. Only USIM and HSS can map a pseudonym to the real identity.
If the identity also need to be hidden from the home operator, then a third
party would need to manage these pseudonyms and additional communication
between MNO and third party needs to be specified. The latter is out of scope
of the solution.
#### 6.12.2.2 Pseudonym generation, provisioning and usage
It is suggested that the UE should not use its permanent identifier (or at
most once) but a pseudonym in all communication. The same pseudonym should not
be used beyond a short time-period. Therefore, every time the UE attaches to
the network or after a certain time period, the UE will use a new pseudonym.
Further, the application layer ID for using the V2X service should be changed
frequently as well to not allow correlation of pseudonyms via this identity.
The change of application layer ID for using the V2X service is out of focus
in 3GPP, but is required as well to fulfil the requirements as cited in
6.12.1.
The home operator or manufacturer provisions the V2X-UE with an initial
pseudonym, from which the UE creates a new pseudonym after every AKA.
If the UE attaches to the network, the visited operator only knows the
pseudonym and to which home operator to route for the AKA challenge. The
visited operator cannot link the IMSI with the pseudonym. The visited operator
cannot link one pseudonym with the next pseudonym to be used by this
particular UE, because it is built out of information that is only known to
USIM and HSS.
The pseudonym, in the following called P-IMSI, is generated following the
standard IMSI format (MCC, MNC, MSIN), but the MSIN part is replaced by MSPN
(Mobile Station PseudoNym).
Note: For roaming case, cars may be located by MCC, MNC part.
MSPN is computed as follows:
MSPN = Truncate{Convert~Binary-to-Decimal~[f~p~(MSPN~ASSOC~, RAND, K)]}
Where:
[- K]{.underline} is the long-term secret key shared between the USIM and the
AuC;
[- MSPN~ASSOC~]{.underline} is the fixed MSPN value associated with the MSIN
in the subscription database. In computation it is used as the association
constant.
[- RAND]{.underline} is the random challenge selected for the Authentication
Vector,
[- f~p~]{.underline} is the KDF defined for this process,
[- Convert~Binary-to-Decimal~]{.underline} is the process of converting the
result of computation to the Decimal representation, and
[- Truncate]{.underline} is a process that truncates the converted decimal
result to the required 9 or 10 digits of expected MSPN number.
Once MSPN is computed, it is retained by the USIM and the HSS. In the USIM it
will be overwritten with a new computed value with every authentication
procedure, i.e. when the UE receives a new RAND challenge. If the network
requires the mobile for its permanent identifier (IMSI), the V2X-capable UE
will provide the current cashed P-IMSI instead. Only HSS is able to map P-IMSI
to the real IMSI of the subscription.
Since MCC and MNC will stay the same, the information given to the VPLMN by
this so-called Pseudo-IMSI (P-IMSI) is sufficient to route the attach request
to the HPLMN. There is semantically no difference between MSPN and MSIN, thus
P-IMSI is processed by all network nodes like the IMSI.
HSS needs to recognize that a P-IMSI is sent to it by the VPLMN (instead of an
IMSI). Since V2X-UEs will have an indication to be V2X capable as specified in
3GPP TS 23.285, HSS can recognize by this indicator that the received identity
in the attach request must be a P-IMSI. Thus, when the UE attaches to the
visited network, indicating to be a V2X-UE, the HSS will receive from MME of
visited network the Authentication Information Request containing P-IMSI.
HSS does the following:
\- HSS obtains MSPN~N~ from the received P-IMSI and checks the local MSPN
cache for matching the MSPN~N~ value. If HSS locates MSPN~N~ it accesses the
subscription record for the associated IMSI and gains the authentication
vector to be used in AKA challenge.
\- If the subscription policy allows, the returned authentication vector is
used by HSS to compute the next value of MSPN~N+1~. Computation of the new
MSPN is done as described above. The new value should not collide with any
currently stored values in MSPN cache.
Note: Solution does not provide details as to how collision is avoided.
\- HSS returns the Authentication Vector to MME of the visited network.
\- At the same time HSS needs to keep track on the MSPNs:
\- The received MSPN~N~ is set to Current MSPN~CURR~
\- The newly computed MSPN~N+1~ is set to MSPN~NEXT~ and added to the pending
cache in association with related IMSI.
USIM does the following:
\- The pseudonym that has been initially provisioned during manufacturer time
is set to MSPN~N~ and used for initial attach. The initial pseudonym is used
only once.
\- In the following, when USIM receives the AKA Challenge, it will calculate
RES and send an attach response. At the same time USIM will set MSPN~N~ to
MSPN~CURR~. This pseudonym will be used by the serving network for mapping
GUTI and locating the HSS.
\- Further, the RAND that the USIM received in the AKA Challenge is used to
compute the MSPN~NEXT~, which is stored for future attach. In the USIM the
previously stored MSPN~NEXT~ gets overwritten with the newly computed value.
If the USIM receives the request for permanent identity and has received an
AKA Challenge in the past, USIM will return MSPN~NEXT~. Otherwise, MSPN~CURR~
can be returned. If neither MSPN~NEXT~ nor MSPN~CURR~, is available, e.g. if
an earlier AKA Challenge was not successful, HSS returns an error message. As
a last resort, UE could send the MSPN~ASSOC~ back.
If neither MSPN~NEXT~, MSPN~CURR~ nor MSPN~ASSOC~ could be used to successful
attach again to a serving network, it can be assumed there is a problem with
the network that the UE wants to attach to. E.g. it could be a faked base
station not providing the V2X service to the UE. Thus, the UE should not
answer any more after 2 rejects and blacklist this access point. The UE should
report via other channels the possibility of misuse and get initialized with
new parameters.
#### 6.12.2.3 Impact to legacy LTE
Network impact:
As the MSPN in the P-IMSI is not semantically different from the MSIN in IMSI,
all inter-node EPC signalling that typically uses IMSI is expected to use
P-IMSI with no modifications.
USIM impact:
A V2X-capable USIM needs to be introduced for the V2X service, which is
capable in generating and storing the MSPN part for the pseudonym from RAND.
Once the MSPN is computed, it is retained by the USIM, in association with the
MCC and MNC, as the P-IMSI -- the semi-permanent identity associated with the
IMSI.
HSS impact:
HSS needs to be prepared for V2X service usage, thus, maintaining records for
V2X-enabled UEs and generating pseudonyms. A new record is needed for storage
of V2X capabilities per UE. Thus, it can also be used to store MSPN~CURR~,
MSPN~NEXT~ and MSPN~ASSOC~.
#### 6.12.2.4 Evaluation
Advantage of the solution is that there is no new handling by the LTE network
elements in visited and home network needed, only USIM and HSS need to be
adapted to handle a V2X-UE requesting access to the LTE network for using the
V2X service y P-IMSI.
NOTE: The solution does not support LI in VPLMN.
## 6.13 Solution against V2X UE tracking based on PC5 autonomous mode
### 6.13.1 Addressed key issues
This solution addresses KI#7 on Vehicle UE privacy.
### 6.13.2 Justification of the solution
TS 23.285 clause 4.1 describes two modes of operation for V2V/V2I
communication, namely over the PC5 and over LTE-Uu. LTE-Uu can be unicast
and/or MBMS. These two operation modes may be used by a UE independently for
transmission and reception, e.g. a UE can use MBMS for reception without using
LTE-Uu for transmission. A UE may also receive V2X messages via LTE-Uu unicast
downlink.
There are two modes of resource allocation for PC5 (or sidelink)
communication. In the scheduled mode, the eNB allocates resources on a UE
specific basis. In the autonomous mode, UEs choose independently from a pool
of resources allocated on a non-UE specific basis. In such case, the operator
cannot track the UEs based on the allocated radio resources.
Furthermore, PC5 supports both IP and non-IP based communication. TS 23.285
clause 4.5.1 describes that when IP based V2X messages are supported, the UE
auto-configures a link local IPv6 address to be used as the source IP address,
as defined in clause 4.5.3 of TS 23.303. In addition, the UE self-assigns the
Layer-2 ID.
### 6.13.3 Description of the solution
In region where strong privacy rules apply, it is proposed to operate V2V/V2I
communication solely over the P5 interface in autonomous mode. For IP based
communication, it is proposed that the source IP address is randomized and
regularly changed for example as specified in RFC 3041.
In addition, it is proposed that the source Layer-2 ID is randomized and
regularly changed as well. In particular, for IP based communication, both
layer identifiers need to be changed simultaneously.
In case pseudonyms are used in the V2X application layer, it is proposed that
the identifier changes in the underlying transport layers (IP and Layer-2) are
synchronized with the changes of the application pseudonyms.
Note: Use of pseudonyms in the V2X application layer is outside the scope of
3GPP.
### 6.13.4 Evaluation
Void
## 6.14 Providing privacy from serving network by using a dedicated V2X MVNO
### 6.14.1 Addressed key issues
This solution addresses KI#7 on Vehicle UE privacy. It is could be an
alternative in regions where strong privacy rules apply and whenever it is
required to operate V2X communication on the LTE-Uu reference point.
### 6.14.2 Description of the solution
#### 6.14.2.1 Deployment model
It is proposed that a dedicated V2X MVNO is responsible for V2X subscriptions.
This V2X MVNO would operate at least an HSS and a V2X Control Function acting
as the HPLMN for V-UEs which would be then always roaming (See Figure
6.14.2.1-1).
Note: Deployment of V2X MVNO is outside scope of 3GPP.
Figure 6.14.2.1-1: Deployment model for V2X
#### 6.14.2.2 Concealment of the IMSI
For the attachment procedure, it is proposed that the V-UE uses a pseudonym
IMSI (P-IMSI) that is regularly changed. The link between a P-IMSI and the
corresponding IMSI is then supposed to be known only to the V-UE owning that
IMSI and the HSS. At the VPLMN, a successful authentication using a new P-IMSI
would trigger a complete refresh of all the UE specific bearer service
identifiers (e.g. allocated IP address), thus breaking the link to any
previous session run with same V-UE.
In order to minimize the impact on the existing procedure, it is proposed that
the P-IMSI has the same structure as the IMSI so that the MNC and MCC still
designate the V2X MVNO while the remaining part is UE specific.
Note: The P-IMSI management and provisioning mechanisms in V2X MVNOs are out
of scope of 3GPP.
### 6.14.3 Evaluation
NOTE: The solution does not support LI in VPLMN.
### 6\. 15 A Vehicle UE Privacy Protection Framework with Homomorphic
Encryption
#### 6.15.1 Introduction
This proposal aims to address key issue #7 to provide vehicle UE privacy
protection. In TS 22.185, it points out that "Subject to regional regulatory
requirements and/or operator policy for a V2V/V2I application, the 3GPP system
shall support pseudonymity and privacy of a UE in the use of a V2V/V2I
application, such that no single party (operator or third party) can track a
UE identity in that region."
In this proposal, a framework is provided to address the identity privacy
problem when vUE accessing network or broadcasting messages. We utilize a
blinding technique together with homomorphic encryption. In general, the
framework achieves the following properties.
1) MNO generates the (identity, auth.info) pairs, these pairs could be in the
form (PMSI, K~PMSI~) similar to solution #6.3 for vUEs to access to the
network or other forms for vUEs to broadcast messages. MNO will encrypt all
the pairs and share them with PCA.
2) PCA distributes encrypted (identity, auth.info) pairs to UEs, although PCA
knows which UE is requesting identity, he does not know the issued temporary
identities because of the encryption.
3) UE requests MNO to decrypt the blinded encrypted (identity, auth.info)
pairs, MNO will decrypt and only get the blinded plaintexts due to the
homomorphic property of the encryption algorithm. Only UE can recover the
(identity, auth.info) pairs from the blinded plaintexts.
#### 6.15.2 Example of Homomorphic Encryption
In general, an encryption scheme with homomophic property means that one can
operate in the ciphertexts and reflect these operations in the plaintext. Many
encryptions algorithms have homomorphic properties, for example, RSA, ElGamal,
Paillier, etc.
Suppose (e, N) is the RSA public key, and m is the message. Due to RSA
encryption, the ciphertext of m is in the form C = m^e^ mod N. In order to
blind the ciphertext C, a (random) blinding parameter P is chosen (possibly by
UE) and the blinded ciphertext of C is in the form B = P^e^ * C = (Pm)^e^ mod
N. Note that B is a valid ciphertext of Pm, and Pm is a blinded form of m.
Only the holder of blinding parameter P can recover message m from Pm.
Note that RSA encryption is only an example to describe the homomorphic
property. Any other encryption with similar property could be adopted.
Note: How homomorphic encryption property is used is not described in this
solution.
#### 6.15.3 Proposed Framework
Suppose the asymmetric encryption algorithm utilized by MNO has the
homomorphic property.
1) MNO will pre-configure vUE with MNO's public key or certificate, this step
is optional depending on whether the blinding operation needs the public key
or not.
2) MNO generates the identity-auth.info pairs and encrypts them with the
public key. Note that the specific entity in MNO generates these pairs could
be the temporary ID management function. Then, MNO sends a mega-pool of
encrypted identity-auth.info pairs under his own public key to PCA. The
specific format of identity-auth.info pair could be (PMSI, K~PMSI~) as in
solution #6.3 or other form to broadcast messages. This depends on the use
cases and will be described in the next sessions.
3) Note: In this step MNO will build a link between identity and the encrypted
pair. I.e., the MNO could uses an index to find the corresponding encrypted
pair with some identity.
4) vUE and PCA authenticate each other in the application layer and establish
secure channel. The UE uses application layer identity (appID) in this
authentication procedure.
5) vUE sends identity request to PCA and ask for identity-auth.info pairs.
6) PCA chooses (possibly multiple) encrypted identity-auth.info pairs from the
pool. Record corresponding relation of the encrypted pairs and UE appID.
7) PCA sends identity response to vUE together with the chosen encrypted
identity-auth.info pairs.
8) vUE and MNO authenticate with each other in the network layer and establish
secure channel. The UE uses network layer ID in this authentication procedure,
for example, it could be IMSI or old PMSI (requested from PCA).
9) vUE chooses (possible multiple) blinding parameters, and blinds the
encrypted identity-auth.info pair received from PCA.
10) vUE sends decryption request to MNO to ask for decryption for blinded
encrypted identity-auth.info.
11) MNO decrypts the ciphertexts and gets the blinded identity-auth.info
pairs.
12) MNO sends the blinded identity-auth.info pairs to vUE.
13) vUE recovers the plaintexts by using the blind parameters.
NOTE 1: This solution works in single operator network.
Note 2: This solution does not support LI.
Note 3: Fallback case for re-provisioning is not addressed in this solution.
# 7 Conclusion
## 7.1 Conclusion on V2X communication security
The security requirements applicable to V2X communications---namely
authorization verification, integrity and replay protection, confidentiality
-- are all satisfied by employing application-layer security as defined in
other SDOs.
LTE V2X does not mandate V2X communication data confidentiality over PC5, and
it may be provided at the application layer (i.e. out of 3GPP scope).
It is concluded that the will be no normative solution specified for V2X
communication security.
## 7.2 Conclusion on V3 interface security
The normative solution for the V3 interface should be based on the PC3
interface, as in TS 33.303[12] clause 5.3. Namely, for configuration transfer
to the UICC, use UICC OTA mechanisms, for data transfer from the UE use GBA
with TLS-PSK mechanisms, and for data transfer initiated by the V2X Control
Function, use GBA Push mechanisms where there is no secure connection.
## 7.3 Conclusion on the security between network entities
The normative solution for the security for V2X interfaces should be based on
the solutions specified in 6.4 and 6.10 (security between network entities
part).
## 7.4 Interim agreement on PC5 security
Authorization to use V2X communications over the PC5 reference point is under
network control. This authorization is conveyed to the UE via the secured PC3
reference point (cf. TS 23.285[11]).
7.5 Conclusion for privacy of PC5 data transmission
The normative solution for PC5 data transmission should be based on the
solution specified in 6.13.
## 7.6 Agreement on V2X UE authorization security
V2X UE authorization is specified in TS 23.285 [11] and is based on UE
authorization of ProSe. This is based on subscription information in HSS, and
there is no need for additional authorization security, because there are no
other specific V2X services defined (e.g. ProSe direct discovery).
7.7 Conclusion on V2X Entities Secure Environment
For V2X services relying on access networks within the scope of TS 33.401[13],
the 3GPP authentication, key agreement, associated subscriber credentials and
associated subscriber identities used to access the network should reside on
USIM within the V2X enabled UE.
For V2X services relying on access networks within the scope of TS 33.402[14],
the 3GPP authentication, key agreement, associated subscriber credentials and
associated subscriber identities used to access the network should reside on
UICC within the V2X enabled UE, except for terminals that do not support 3GPP
access capabilities and where 3GPP does not specify where the credentials used
with EAP-AKA and EAP-AKA\' reside.
###### ## Annex A (Informative): Overview of IEEE 1609.2 Security Standards
for WAVE
## A.1 DSRC/WAVE
DSRC stands for Dedicated Short Range Communication, which refers to radio
technologies or spectrum providing services for Intelligent Transportation
System (ITS). DSRC has been associated with the term WAVE which stands for
Wireless Access in Vehicular Communication comprising the IEEE 1609 family of
standards and thus the notation DSRC/WAVE. WAVE is the name of a radio
communication system intended to provide interoperable services to
transportation.
## A.2 WAVE standards
The WAVE standard specifies a dual data plane protocol stack sharing a common
stack at the lower link and physical layers. One stack over the standard
internet protocol IPv6 and the other over the WAVE Short Message Protocol
(WSMP), a protocol designed for optimized operations in wireless vehicular
environment. In particular, the WSMP protocol allows application to directly
control physical characteristics such as the channel number and transmitter
power. Figure A.2-1 shows the protocols and their associated standards.
{width="3.848611111111111in" height="2.4902777777777776in"}
Figure A.2-1: WAVE protocol stack and associated standards
## A.3 WAVE security
The IEEE 1609.2[18] standards specify the security services for application
and management messages for WAVE devices. The specified mechanisms are
intended to protect against attacks such as eavesdropping, replay, spoofing or
alteration. They are also designed to respect privacy and not leak personal,
identifying or linkable data to unauthorized parties.
The services and the components within the WAVE security entity shown in
Figure A.2-1 are illustrated in Figure A.3-1. The figure shows as well the
Service Access Points (SAP) for communication within and with the other
entities of the WAVE protocol stack.
{width="3.296527777777778in" height="2.901388888888889in"}
Figure A.3-1: Details of the WAVE security services
The WAVE security services consist of:
\- Security processing services: provide processing services to enable secure
communications comprising secure data and secure WAVE Service Advertisements
(WSA).
\- Security management services: provide certificate management services
through the Certificate Management Entity (CME) and the Provider Service
Security Management Entity (PSSME).
**Security processing services:** The security processing services include
operations such as
\- Signing and/or encryption of Protocol Data Units (PDUs) for transmission
and verification and/or decryption on reception
\- Signing of WSAs for transmission and verification on reception
\- Ensuring access to cryptomaterial such as private and public keys and
certificates, generating certificate requests and processing responses, and
validating Certificate Revocation Lists (CRLs)
The cryptographic mechanisms supported by this standard are the Elliptic Curve
Digital Signature Algorithm (ECDSA) and the Elliptic Curve Integrated
Encryption Scheme (ECIES).
**Security management services:** The CME manages the information that enables
the security processing services entity to determine the validity of the
certificates and the received data. This includes revocation and other status
information of all the stored certificates and the certificates that can be
used as trust anchors.
The PSSME provides the necessary support for higher layer entities that
request to be advertised as secure provider services. In particular, the PSSME
communicates certificates and private keys to the security processing services
in order to sign WSAs.
# Annex B (Informative): Network options for PC3 security
## B.1 General
The present annex describes the network options for securing PC3 and PC8
interfaces, which V3 is similar to.
## B.2 ProSe Function using standalone BSF
The network option for ProSe Function using standalone BSF is described below:
Figure B.2-1: Prose Function using standalone BSF.
This architecture follows the GBA architecture, where the ProSe Function and
the ProSe Key Management Function are acting as a NAF.
## B.3 BSF - ProSe Function/NAF colocation
The network option for ProSe Function using colocated BSF is described below:
Figure B.3-1: BSF -- Prose Function colocation
In this architecture the BSF is colocated with the ProSe Function and the
ProSe Key Management Function acting as a NAF. Zn interface is present between
BSF and ProSe Function and also between BSF and ProSe Key Management Function.
## B.4 ProSe Function with bootstrapping entity
The network option for ProSe Function with bootstrapping entity is described
below:
Figure B.4-1: Prose Function with bootstrapping entity
In this architecture the ProSe Function and the ProSe Key Management Function
are enhanced in the way that the subset of BSF and NAF functionality towards
the UE is reused, specifically the protocols defined for Ub and Ua reference
points. Interfaces Zn and Zh are not used. Functionality of retrieving the
authentication vector in order to support the mutually authenticated key
exchange is the responsibility of the PC4a interface between the ProSe
Function and the HSS, or the PC4a* interface between ProSe Key Management
Function and HSS.
# Annex C (Informative): Overview of existing privacy solution for V2X
The consensus in other SDOs (ETSI [6] and IEEE [18]) is that the security
solution for V2X communication would be based on public key cryptography. The
work is still ongoing to finalize the details of the PKI architecture in
several countries and regions where not only OEMs but also traffic authorities
are involved. For example, in the US, already in 2014 the Department of
Transportation (DOT) issued a report [19] on V2V communication where a
Security Credential Management System (SCMS) serving the purpose is described.
{width="3.7694444444444444in" height="2.6131944444444444in"}
Figure 6.7.2-1: Certificate Authorities
A high level overview of the architecture of SCMS is shown in Figure 6.7.2-1.
In general, there are different types of Certificate Authorities (CA); namely
Root CAs (RCA), Long Term CAs (LTCA) and Pseudonym CAs (PCA) (see Figure
6.7.2-1). An RCA could be for example a national transport administration such
as trafikverket in Sweden. A V-UE is provisioned with a long-term certificate
by an LTCA. An LTCA could be, for example, a car manufacturer. In order to
preserve the privacy of a V-UE, a PCA regularly provisions the V-UE with fresh
short-term pseudonym certificates. A PCA could be, for example, a local
traffic authority, a third party operating and maintaining the infrastructure,
etc. The short-term pseudonym certificates are used to protect the V2X
broadcast messages, thus protecting the system from misuse by unauthorized or
malfunctioning V-UEs and at the same time protecting the privacy of end users
(drivers).
With a long-term certificate, a V-UE has the means to establish a secure
channel with any relevant CA. For getting short-term pseudonym certificates, a
V-UE sends a request, signed with the long-term private key, to the relevant
PCA without disclosing the long-term identifier. The long-term identifier of
the V-UE is encrypted with the public key of the corresponding LTCA. The PCA
receiving the request asks the relevant LTCA for the signature of the V-UE.
This guarantees that a V-UE can neither be tracked by the LTCA alone, nor can
it be identified by the PCA alone. More detailed descriptions can be found in
[6] and [18].
In order for the V-UE long term credentials (certificate) to be taken into use
in the first place, there will be a central trusted entity possibly per
country, or region in a country, or multiple countries, etc. handling the
enrolment and authorization for the V2X communication (ETSI TS 102731). Such
an entity is hereinafter referred to as Trusted Traffic Authority (TTA). V-UEs
are required to run an authorization or enrolment procedure with this entity
for V2X communication using the long term certificates.
# Annex D (Informative): Privacy by regulation
## D.1 Introduction
Privacy requirements on V2X are also motivated on regulatory needs. This Annex
gives an overview about the legal situation (status in July 2016) in various
juristic areas.
Note: Document found in
https://ec.europa.eu/transport/sites/transport/files/themes/its/road/action_plan/doc/c-its-
platform/2016_annexes_to_the_c-its_platform_final_report_january_2016.zip [30]
describes about European Commission's effort in looking into ITS related
privacy aspects. User is not addressed in the present document.
## D.2 Regulatory situation in EU
### D.2.1 GDPR and ePD
The General Data Privacy Regulation (GDPR) and e-Privacy Directive (ePD) as
given by the European Union relate also to telecommunication industry and are
therefore of relevance for V2X.
GDPR is the successor of the Data Protection Directive (DPD) 95/46/EC. GDPR
was formally adopted by the European Parliament and Council and came into
force in May 2016; companies will have 2 years to until the regulation will
start to apply, i.e. 24 May 2018.
The e-Privacy Directive (Directive 2002/58/EC on privacy and electronic
communications) concerns the protection of privacy and personal data in the
electronic communication. The Communication on a Digital Single Market
Strategy for Europe (COM(2015) 192 final) of 6 May 2015 (DSM Communication)
demanded to review theePD once the new EU rules on data protection (i.e. GDPR)
are adopted. This is a currently ongoing process. A review and questionnaire
by the EC (Directorate General for Communications Networks, Content and
Technology) invited citizens, legal entities and public authorities and
responses were to be submitted on 5 July. The intention is that the e-Privacy
Directive particularises and complements the GDPR in future, thus the
questionnaire is related to the interplay between the e-Privacy Directive and
GDPR. Also industry associations such as Digital Europe participate in this
questionnaire, Digital Europe (DE) represents the opinion of the ICT sector by
technology companies and national trade associations. DE allows industry
participation in the development and implementation of EU policies.
Current critic by Digital Europe is that objectives of the ePrivacy Directive
(ePD) are better served by the Data Protection Directive (DPD) and its
successor the General Data Protection Regulation (GDPR), than they are by the
ePD.
Nonetheless, companies would need to follow the GDPR latest in 2018 and, if
not changed in future, the ePD needs to be followed on country-level as well.
### D.2.2 Relevant paragraphs from General Data Protection Regulation (GDPR)
http://ec.europa.eu/justice/data-protection/reform/files/regulation_oj_en.pdf
has the up to date version of the GDPR.
**Article 5** lays down details on the principles relating to processing of
personal data:
\- lawfulness, fairness and transparency
\- purpose limitation
\- data minimization
\- accuracy
\- storage limitation
\- integrity and confidentiality
\- accountability
**Article 7** on "conditions for consent" demands the user to give consent in
processing his personal data, while the MNO (controller) shall be able to
demonstrate that the user (data subject) has given this consent. This consent
can be withdrawn at any time.
### D.2.2 Relevant paragraphs from e-Privacy Directive (ePD)
http://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=CELEX:32002L0058:en:HTML
is the version of the ePrivacy Directive from 2002 (still referring to the
DPD). Main objective is to minimising the processing of personal data and
using anonymous or pseudonymous data where possible. As long as no update of
the ePD is given, this reference stays relevant. Future versions are supposed
to remove the overlap with the new GDPR.
**Article 5 - Confidentiality of the communications**
1\. Member States shall ensure the confidentiality of communications and the
related traffic data by means of a public communications network and publicly
available electronic communications services, through national legislation. In
particular, they shall prohibit listening, tapping, storage or other kinds of
interception or surveillance of communications and the related traffic data by
persons other than users, without the consent of the users concerned, except
when legally authorised to do so in accordance with Article 15(1). This
paragraph shall not prevent technical storage which is necessary for the
conveyance of a communication without prejudice to the principle of
confidentiality.
2\. Paragraph 1 shall not affect any legally authorised recording of
communications and the related traffic data when carried out in the course of
lawful business practice for the purpose of providing evidence of a commercial
transaction or of any other business communication.
3\. Member States shall ensure that the use of electronic communications
networks to store information or to gain access to information stored in the
terminal equipment of a subscriber or user is only allowed on condition that
the subscriber or user concerned is provided with clear and comprehensive
information in accordance with Directive 95/46/EC, inter alia about the
purposes of the processing, and is offered the right to refuse such processing
by the data controller. This shall not prevent any technical storage or access
for the sole purpose of carrying out or facilitating the transmission of a
communication over an electronic communications network, or as strictly
necessary in order to provide an information society service explicitly
requested by the subscriber or user.
> **Article 6 - Traffic data**
1\. Traffic data relating to subscribers and users processed and stored by the
provider of a public communications network or publicly available electronic
communications service must be erased or made anonymous when it is no longer
needed for the purpose of the transmission of a communication without
prejudice to paragraphs 2, 3 and 5 of this Article and Article 15(1).
2\. Traffic data necessary for the purposes of subscriber billing and
interconnection payments may be processed. Such processing is permissible only
up to the end of the period during which the bill may lawfully be challenged
or payment pursued.
3\. For the purpose of marketing electronic communications services or for the
provision of value added services, the provider of a publicly available
electronic communications service may process the data referred to in
paragraph 1 to the extent and for the duration necessary for such services or
marketing, if the subscriber or user to whom the data relate has given his/her
consent. Users or subscribers shall be given the possibility to withdraw their
consent for the processing of traffic data at any time.
4\. The service provider must inform the subscriber or user of the types of
traffic data which are processed and of the duration of such processing for
the purposes mentioned in paragraph 2 and, prior to obtaining consent, for the
purposes mentioned in paragraph 3.
5\. Processing of traffic data, in accordance with paragraphs 1, 2, 3 and 4,
must be restricted to persons acting under the authority of providers of the
public communications networks and publicly available electronic
communications services handling billing or traffic management, customer
enquiries, fraud detection, marketing electronic communications services or
providing a value added service, and must be restricted to what is necessary
for the purposes of such activities.
6\. Paragraphs 1, 2, 3 and 5 shall apply without prejudice to the possibility
for competent bodies to be informed of traffic data in conformity with
applicable legislation with a view to settling disputes, in particular
interconnection or billing disputes.
> **Article 9 - Location data other than traffic data**
1\. Where location data other than traffic data, relating to users or
subscribers of public communications networks or publicly available electronic
communications services, can be processed, such data may only be processed
when they are made anonymous, or with the consent of the users or subscribers
to the extent and for the duration necessary for the provision of a value
added service. The service provider must inform the users or subscribers,
prior to obtaining their consent, of the type of location data other than
traffic data which will be processed, of the purposes and duration of the
processing and whether the data will be transmitted to a third party for the
purpose of providing the value added service. Users or subscribers shall be
given the possibility to withdraw their consent for the processing of location
data other than traffic data at any time.
2\. Where consent of the users or subscribers has been obtained for the
processing of location data other than traffic data, the user or subscriber
must continue to have the possibility, using a simple means and free of
charge, of temporarily refusing the processing of such data for each
connection to the network or for each transmission of a communication.
3\. Processing of location data other than traffic data in accordance with
paragraphs 1 and 2 must be restricted to persons acting under the authority of
the provider of the public communications network or publicly available
communications service or of the third party providing the value added
service, and must be restricted to what is necessary for the purposes of
providing the value added service.
## D.3 Regulatory situation in US
### D.3.0 Introduction
The following is guidance that is expected to become regulation.
### D.3.1 National Highway Traffic Safety Administration (NHTSA)
US Regulation published a comprehensive research report (DOT HS 812 014) on
vehicle-to-vehicle (V2V) communications technology in 2014 including privacy
and security requirements.
US Department of Transportation (DOT), NHTSA agency (National Highway Traffic
Safety Administration) issued in 2014 an Advance Notice of Proposed Rulemaking
(ANPRM) and a comprehensive research report (DOT HS 812 014) on vehicle-to-
vehicle (V2V) communications technology including the Department\'s research
findings in several key areas including technical feasibility, privacy and
security, and preliminary estimates on costs and safety benefits.
For the last 2 years ANPRM was seeking public input on these findings to
support the Department's regulatory work to eventually require V2V devices in
new light vehicles.
NHTSA announced to provide a regulatory mandate \"Federal Motor Vehicle Safety
Standard\", which is based on a V2V safety NPRM.
### D.3.2 Relevant citations from DOT HS 812 014
The following citations are related to security and privacy issues from the
report "Vehicle-to-Vehicle Communications: Readiness of V2V Technology for
Application" (DOT HS 812 014)
\- V2V device certification issues:
\- V2V devices are different from other technologies regulated by NHTSA under
the Federal Motor Vehicle Safety Standards, insofar as part of ensuring their
successful operation (and thus, the safety benefits associated with them)
requires ensuring that they are able to communicate with all other V2V devices
participating in the system.
\- This means that auto manufacturers (and V2V device manufacturers),
attempting to comply with a potential V2V mandate, could have a significant
testing obligation to guarantee interoperability among their own devices and
devices produced by other manufacturers. It is an open question whether
individual companies could meet such an obligation themselves, or whether
independent testing facilities might need to be developed to perform this
function.
\- Based on the current security design, it also is likely that the entity or
entities providing the security management system would require that device
manufacturers comply with interoperability certification requirements to
ensure the reliability of message content.
\- Standing up security and communications systems to support V2V:
\- In order to function safely, a V2V system needs security and communications
infrastructure to enable and ensure the trustworthiness of communication
between vehicles.
\- The source of each message needs to be trusted and message content needs to
be protected from outside interference. In order to create the required
environment of trust, a V2V system must include security infrastructure to
credential each message, as well as a communications network to get security
credentials and related information from vehicles to the entities providing
system security (and vice versa).
\- NHTSA currently anticipates that private entities will create, fund, and
manage the security and communications components of a V2V system. While NHTSA
has identified several potential types of entities, including some specific
entities, which might be interested in participating in a V2V security system,
private entities have not committed to doing so to date.
\- Privacy:
At the outset, readers should understand some very important points about the
V2V system as currently contemplated by NHTSA.
> \- The system will not collect or store any data identifying individuals or
> individual vehicles, nor will it enable the government to do so.
>
> \- There is no data in the safety messages exchanged by vehicles or
> collected by the V2V system that could be used by law enforcement or private
> entities to personally identify a speeding or erratic driver.
>
> \- The system---operated by private entities---will not enable tracking
> through space and time of vehicles linked to specific owners or drivers.
>
> \- Third parties attempting to use the system to track a vehicle would find
> it extremely difficult to do so, particularly in light of far simpler and
> cheaper means available for that purpose.
>
> \- The system will not collect financial information, personal
> communications, or other information linked to individuals.
>
> \- The system will enroll V2V enabled vehicles automatically, without
> collecting any information that identifies specific vehicles or owners.
>
> \- The system will not provide a "pipe" into the vehicle for extracting
> data.
>
> \- The system will enable NHTSA and motor vehicle manufacturers to find lots
> or production runs of potentially defective V2V equipment without use of VIN
> numbers or other information that could identify specific drivers or
> vehicles.
Drivers may be concerned about the possibility that the government or a
private entity could use V2V communications to track their daily activities
and whereabouts. However, as designed, NHTSA is confident that the V2V system
both achieves the agency's safety goals and protects consumer privacy
appropriately.
#