# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
This document contains a study of the security aspects of the Mission-Critical
service. It enhances the security solutions defined for MCPTT in TS 33.179 [3]
to support the common functional architecture (MC_ARCH), enhancements to MCPTT
(eMCPTT), data services (MCData), video services (MCVideo) and migration and
interconnect services with partner systems (MCSMI).
In each case, this study includes an analysis of the threats to the service,
the security requirements to mitigate those threats and an evaluation of
possible technical solutions designed to meet the security requirements of the
service.
Stage 2 aspects of the mission critical services are defined within TS 23.179
[2], TS 23.280 [8], TS 23.281 [9], TS 23.282 [10], TR 23.781 [11], TR 23.782
[12] and TS 33.179 [3]. Stage 1 requirements are defined in TS 22.179 [4], TS
22.280 [5], TS 22.281 [6] and TS 22.282 [7].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.179: \"Functional architecture and information flows to support
mission critical communication services\".
[3] 3GPP TS 33.179: \"Security of Mission Critical Push To Talk (MCPTT) over
LTE\".
[4] 3GPP TS 22.179: \"Mission Critical Push to Talk (MCPTT) over LTE\".
[5] 3GPP TS 22.280: \"Mission Critical Services Common Requirements\".
[6] 3GPP TS 22.281: \"Mission Critical Video over LTE\".
[7] 3GPP TS 22.282: \"Mission Critical Data over LTE\".
[8] 3GPP TS 23.280: \"Common functional architecture to support mission
critical services\".
[9] 3GPP TS 23.281: \"Functional architecture and information flows for
mission critical video\".
[10] 3GPP TS 23.282: \"Functional model and information flows for Mission
Critical Data\".
[11] 3GPP TR 23.781: \"Study into interconnect and migration between MCPTT
systems\".
[12] 3GPP TR 23.782: \"Feasibility Study on Mission Critical Communication
Interworking between LTE and non-LTE LMR systems\".
[13] IETF RFC 7521: \'\'Assertion Framework for OAuth 2.0 Client
Authentication and Authorization Grants\'\'.
[14] IETF RFC 7523: \'\'JSON Web Token (JWT) Profile for OAuth 2.0 Client
Authentication and Authorization Grants\'\'.
[15] IETF RFC 7515: \'\'JSON Web Signature (JWS)\'\'.
[16] IETF Draft draft-ietf-oauth-token-exchange-05: \'\'OAuth 2.0 Token
Exchange\'\', https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-05.
> [17] 3GPP TS 24.380: \"Mission Critical Push To Talk (MCPTT) media plane
> control; Protocol specification\".
>
> [18] 3GPP TS 23.468: \"Group Communication System Enablers for LTE
> (GCSE_LTE)\".
>
> [19] 3GPP TS 23.379 \'\'Functional architecture and information flows to
> support Mission Critical Push To Talk (MCPTT);\'\'
>
> [20] IETF RFC 6509: \'\'MIKEY-SAKKE: Sakai-Kasahara Key Encryption in
> Multimedia Internet KEYing (MIKEY)\'\'.
>
> [21] 3GPP TS 33.180: \'\'Security of the mission critical service\'\'.
>
> [22] RFC 6507: \"Elliptic Curve-Based Certificateless Signatures for
> Identity-Based Encryption (ECCSI)\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**Primary MCPTT System** : MCPTT system where the MCPTT User Profile of an
MCPTT User is defined.
**Partner MCPTT System** : Allied MCPTT system that provides MCPTT Services to
an MCPTT User based on the MCPTT User Profile that is defined in the Primary
MCPTT System of that MCPTT User.
**Security Domain** : A security domain is a group of MCX users who share
common security requirements and policies for their communications. From a
technical perspective, users within a security domain share a KMS and KMS
certificate. MCX users may be members of one or more security domains.
**Home Security Domain** : The MCX user\'s primary security domain.
**External Security Domain** : A security domain that is not the user\'s home
security domain. Secure communications with an external security domain may or
may not be permitted by the home security domain.
**Home KMS:** The KMS that acts as the root of trust of the Home Security
Domain.
**External KMS:** The KMS which acts as the root of trust for a specific
External Security Domain.
**KMS Certificate:** A certificate required to communicate with a security
domain to support identity-based cryptography. This differs from X.509
certificates used for traditional PKI. See Annex D.3.1 within TS 33.179 [3].
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply.\ An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
CA Certificate Authority
CSC Common Services Core
CSK Client-Server Key
CSK-ID Client-Server Key Identifier
DL Downlink
DoS Denial of Service
eMCPTT Enhanced Mission Critical Push-to-Talk
GCS Group Controlling Server
GDK Group Data Key
GDK-ID Group Data Key Identifier
GMK Group Master Key
GMS Group Management Server
IBE Identity-Based Encryption
IdM Identity Management
IdMS Identity Management Server
JSON JavaScript Object Notation
JWS JSON Web Signature
JWT JSON Web Token
KDF Key Derivation Function
KFC Key For Control Signalling
KMS Key Management Server
LI Lawful Interception
MBMS Multimedia Broadcast/Multicast Service
MBSFN Multimedia Broadcast Single Frequency Network
MC Mission Critical
MCCI Mission Critical Communication Interworking
MCData Mission Critical Data
MCPTT Mission Critical Push to Talk
MCSEC Mission Critical SECurity
MCSMI Mission Critical Study on Migration and Interconnect
MCVideo Mission Critical Video
MCX Mission Critical Services
MitM Man-in-the-Middle
MKFC Multicast Key Floor Control
MSCCK MBMS Sub- Channel Control Key
MuSiK Multicast Signalling Key
PCK Private Call Key
PDK Private Data Key
PDK-ID Private Data Key Identifier
PFK Participating Function Key
PKI Public Key Infrastructure
ROC Roll-Over-Counter
RTP Real-Time Transport Protocol
SDS Short Data Services
SPK SIP Protection Key
SRTCP Secure Real-Time Transport Control Protocol
SRTP Secure Real-Time Transport Protocol
SSRC Synchronization Source
TGMK Temporary Group Master Key
TMGI Temporary Mobile Group Identity
UID User Identifier
# 4 Overview of enhanced Mission Critical Services
## 4.1 Introduction
This document is intended to investigate and chose the appropriate security
solutions for the mission critical stage 1 requirements and stage 2
architecture definitions relating to mission critical enhancements for PTT,
Video, Data, Interconnect, Multicast and inter-domain operations. An overview
of the architecture is provided in clause 4.2.
This document addresses the key issues relating to protecting and securing the
information for the above mission critical features and architectures (clause
5), and from the key issues a set of potential security requirements are
derived (clause 6).Clause 7 provides the set of potential security solutions
aimed at providing coverage of the key issues and derived security
requirements, while clause 8 evaluates, draws conclusions, and selects the
appropriate security solutions for normative work.
## 4.2 Architecture
The mission critical architecture consists of a signalling plane, common
services core and an application plane. Figure 4.2-1 shows the functional
model for the signalling plane.
Figure 4.2-1: Signalling plane functional model
The signalling plane functional model shows the major signalling interfaces
associated with the mission critical architecture. The MC service server in
figure 4.2-1 may represent the MCPTT server, the MCVideo server or the MCData
server. Inter-domain signalling traverses the SIP-3 and the HTTP-3 interfaces
and is applicable to each of the MCPTT, MCVideo and MCData services as well.
As the signalling plane functional model is applicable to each of the MCPTT,
MCVideo and MCData services, the existing signalling plane security (for SIP
and HTTP) may be reused regardless of which service is actively transmitting
on the signalling plane.
Figure 4.2-2 shows the functional model for the common services core.
Figure 4.2-2: Common services core functional model
The common services core (CSC) functional model shows the major interfaces
associated with the various mission critical servers and clients. The MC
service server in figure 4.2-2 may represent the MCPTT server, the MCVideo
server or the MCData server, while the MC service client(s) may represent the
MCPTT client, MCVideo client or the MCData client. As the CSC functional model
is applicable to each of the MCPTT, MCVideo and MCData features, it is likely
that the existing security mechanisms may be reused.
The CSC reference points use variations of SIP and HTTP to fulfil the CSC
architecture for the various CSC functional servers (group management servers,
configuration management servers, identity management server key management
server, location management servers, etc). As there are existing solutions for
SIP and HTTP, it is likely that the existing SIP and HTTP protection
mechanisms will be reused.
Figure 4.2-3 shows the existing SIP and HTTP interface protection mechanisms.
Figure 4.2-3: SIP and HTTP security architecture
Protection of the application data itself depends on the service (i.e. MCPTT,
MCVideo or MCData) and the protocols chosen for each service. In this case,
each service may require different and specific security solutions. It is
assumed that MCVideo will reuse the real-time SRTP and SRTCP security
mechanisms while MCData will be dependent upon the protocol chosen by stage 3.
For signalling, it is assumed that MCPTT, MCVideo and MCData will share the
common signalling security architecture previously defined in 33.179 [3],
which uses a CSK to protect application data on the signalling plane.
End to end protection of application specific data from client to client(s)
will be required, as will protection of application specific data from the
client to the MCX server in some cases.
This document will explore the specific security requirements for each service
and address them independently.
# 5 Security analysis of Mission Critical services
## 5.1 General
This clause contains key security issues which impact the mission critical
service.
## 5.2 Cross-service key issues
### 5.2.1 Key Issue #1.1: Denial of service
#### 5.2.1.1 Issue details
An adversary attempts to prevent a valid MCX User or MCX Servcie Group from
obtaining service.
#### 5.2.1.2 Security threats
a) Malicious deregistration of user. The adversary sends registration or
deregistration commands which purport to have originated from the target user,
or manipulates some control interface of the MCX Service.
b) Network flooding. Adversaries create large volumes of traffic to reduce
available capacity and impede communications between users.
c) Misuse of secure disable protocols. Adversary uses a disable protocol to
put user device out of service.
#### 5.2.1.3 Potential security requirements
[MCSEC-1.1-1]: All users of the MCX Service shall be authenticated to prevent
an adversary impersonating a user for the purpose of denial of service.
[MCSEC-1.1-2]: The MCX Service should take measures to detect and mitigate DoS
attacks to minimise the impact on the network and on MCX users.
### 5.2.2 Key Issue #1.2: Data communication security between MCX network
entities
#### 5.2.2.1 Issue details
MCX network entities will be required to communicate with each other. It is
important that this may be performed securely.
#### 5.2.2.2 Security threats
There are several threats to the communication between network entities
including forged or replayed messages and eavesdropping on the contents of the
messages.
#### 5.2.2.3 Potential security requirements
The following requirement serves as a guideline for future normative work:
[MCSEC-1.2-1] A security mechanism shall exist that allows transmission of
data between MCX network entities to be authenticated, confidentiality
protected, integrity protected and protected from replays.
NOTE: UE-to-UE and UE-to-network relays are not considered to be \'network
entities\'.
### 5.2.3 Key Issue #1.3: User impersonation
#### 5.2.3.1 Issue details
An imposter may attempt to impersonate a valid MCX User for the purposes of
fraud, misinformation or eavesdropping.
#### 5.2.3.2 Security threats
a) Impersonation of individual user. Adversary masquerades as a valid system
user, accessing from a UE within the 3GPP network for purposes of fraud,
misdirection etc.
b) Impersonation of group. A group communication is impersonated to misinform
or misdirect group members. The modes of attack may be different depending on
the bearer service in use.
c) Impersonation of MCPTT server. The user is persuaded to connect to a false
MCX Service in order to deny service, manipulate the user etc.
d) Man in the middle attack. An attacker inserts himself between the user and
the MCX Service to intercept information, generate false calls or deny service
to calls, or to modify the security of the service, e.g. force the user to
negotiate a lower security level.
e) Misuse of client terminal. A client terminal is stolen (which may still be
logged on to the service), or illegally loaned, and used to receive or
generate communications whilst purporting to be the valid user. Credentials
could be obtained from a stolen terminal and used to impersonate the valid
user, even after the terminal has been recovered.
#### 5.2.3.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-1.3-1] The MCX User shall be authenticated by the Mission Critical
Application(s).
[MCSEC-1.3-2] A mechanism shall exist that allows the Mission Critical
Application(s) to be authenticated by the MCX User.
[MCSEC-1.3-3] The MCX UE and the MCX Service should enforce the result of the
authentication for the duration of use (e.g. by integrity protection or
implicit authentication by encryption with a key that is derived from the
authentication and is unknown to the adversary).
[MCSEC-1.3-4] The security solution should minimise the impact of a
compromised MCX UE on other MCX UEs.
### 5.2.4 Key Issue #1.4: Manipulation
#### 5.2.4.1 Issue details
An adversary may attempt to manipulate information relating to an MCPTT user
or group.
#### 5.2.4.2 Security threats
a) Falsification of call records. An adversary manages to modify call record
information for purposes of fraud, or to falsify an audit trail.
b) Alteration of configuration. An adversary changes programming information
in the client application, or changes configuration e.g. to change or deny
access permissions in client application or MCPTT server.
c) Hijacking of calls. An adversary takes over a call in progress and replaces
call information from one party with his own, clears the call etc.
#### 5.2.4.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-1.4-1] The Mission Critical Service shall provide a means to ensure
integrity of all user signalling at the application layer.
[MCSEC-1.4-2] The Mission Critical Service shall protect the administrative
and security management parameters from manipulation by individuals who are
not explicitly authorized by the Mission Critical Organization.
### 5.2.5 Key Issue #1.5: Traffic analysis
#### 5.2.5.1 Issue details
MCX Users require their identities to be confidential, and some specialist
users will be particularly sensitive to any form of traffic analysis which
could result in details of their operations or operational roles being
deduced. Additionally recovery of identities and signalling patterns may
reveal information concerning organisational structure, or ongoing operational
activities. Identified users may also become targets for impersonation, or for
denial of service attacks such as jamming.
#### 5.2.5.2 Security threats
a) Matching of user identity with subscriber terminal identity. The user can
be identified by the subscription in use, enabling tracking by non-security
cleared personnel or a skilled adversary intercepting identities sent in clear
at registration or finding a vulnerable point in the network.
b) Identifying highly secure users within user pool. Certain specialist users
have much higher demands for security and are very sensitive to identity and
location, and should not stand out within the greater volume of public safety
users.
c) Identification of group addresses. Group addresses relate to operational
roles, and identification of these allows analysis of user movements and
operational behaviour.
d) Identifying user affiliation to groups. Identification of user affiliation
to groups can provide information on the operational roles of a user at a
particular point of time, and the numbers of affiliations to a group at any
one time provides further information to an adversary.
e) Identification of called or calling numbers. Identification of called or
calling parties of calls made to or from any user both can provide information
about that user\'s current role, and also can expose the identities and roles
of the that other party.
f) Identification of users by consistent use of higher priorities. Some users
may need to consistently use higher priority, for example due to role or
seniority, and may become visible due to this.
#### 5.2.5.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-1.5-1] The Mission Critical Service shall provide a means to support
confidentiality of MCX Service User IDs from all entities outside the Mission
Critical Service.
[MCSEC-1.5-2] The Mission Critical Service shall provide a means to support
confidentiality of MCX Service signalling from all entities outside the
Mission Critical Service.
### 5.2.6 Key Issue #1.6: Privacy of MCX Service identities
#### 5.2.6.1 Issue details
To allow the Mission Critical Service to meet the Stage 1 requirements and
align with the Stage 2, it is expected that each plane operates in an
independent manner, especially when Mission Critical Application and the IMS
core are administered by different parties (Operator (carrier) and PS Agency).
As a consequence of this, each plane should manage on its own behalf:
a) Use of identities. Each plane is therefore responsible for the privacy of
that plane\'s own identities; and
b) Security for that plane. This does not preclude a plane requesting security
services from another plane, but that is a decision made within the plane, as
to whether to use offered security services or mechanisms within the plane
itself.
#### 5.2.6.2 Security threats
The identity usually identifies a UE or user or a client, if that plane\'s own
identities are leaked and exposed to other planes, there will be some security
problems like privacy information exposure, tracing and so on.
#### 5.2.6.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-1.6-1] The MCX Service identities of each plane shall be used within
the corresponding plane and concealed to other planes.
[MCSEC-1.6-2] When required by the MXC Service provider, MCX Service
identities and other MCX Service sensitive information, shall be contained
within the application plane and shall provide a means to support
confidentiality and integrity of the application plane from the SIP signalling
plane.
[MCSEC-1.6-3] When protection of identities and other sensitive application
information is NOT required by the MCX Service provider, the MCX Service
identities and other MCX Service sensitive information, shall remain contained
within the application plane but do not require confidentiality protection.
### 5.2.7 Key issue #1.7: Use of multiple security domains for media security
#### 5.2.7.1 Issue details
In TS 33.179 [3], only one security domain was supported per user, and
communicating between security domains was not defined explicitly. Clearly, it
is not acceptable for all MCX users across different MCX services to be within
a single security domain. To better support multiple MC Services working
together, support for multiple security domains is required. This will also
aid support for interconnection, roaming and interworking.
#### 5.2.7.2 Security threats
The following threats apply to the use of multiple security domains for media
security:
a) Impersonation: An external security domain may pretend to have a user on
the domain that does not use the domain. By doing this in both directions it
would be possible to perform a MitM attack on the connection.
b) Misuse: An external security domain could be used without permission of the
Home Security Domain or the MCX service(s) that support the communication.
This would impact the service(s) ability to effectively manage the user\'s
communications.
#### 5.2.7.3 Potential security requirements
[MCSEC-1.7-1] When using external security domains, the Home Security Domain
shall apply policies which ensure that only trusted external security domains
are used.
[MCSEC-1.7-2] Use of external security domains shall be logged to detect
impersonation and misuse.
[MCSEC-1.7-3] MCX Services shall be able to permit/deny the use of security
domains over their service.
### 5.2.8 Key issue #1.8: Control of use of MBMS within the MC Domain
#### 5.2.8.1 Issue details
The solution for MCPTT currently uses MKFC to encrypt signalling from the
MCPTT Server to the MCPTT client when using MBMS. See clause 9.4.4. of TS
33.179 [3]. The MKFC is distributed from the Group Management Server (GMS).
This key issue considers whether a similar approach could be used within an
MCX system.
As background, use of MBMS is managed by the MCX Server acting as the GCS AS.
The MCX Server uses the MB2 interface to the network operator\'s BM-SC to
activate and deactivate MBMS bearers as required. Hence MBMS is under control
of the MC Domain that uses the MBMS service, with no requirement external MC
Domains for support. In fact, knowledge on the use of MBMS need not be shared
beyond the home MC Domain.
However, it is possible that the GMS is in a different MC Domain to the MCX
Server. This could occur if a group is used across multiple MC Domains.
However, based on the existing security solution, MCX Servers within the home
MC Domain will not be able to use MBMS for group signalling unless the MKFC is
distributed by the GMS. In the case that the GMS is in a different MC Domain
to the MCX Server, control of the use of MBMS is in one domain, and control of
the security of MBMS is in a different domain. If the GMS does not provide the
MKFC, then signalling over MBMS cannot be secured in all domains where that
group is used. This could prevent MBMS from being used, or cause MBMS to be
used insecurely.
This issue does not apply to media content (protected using GMK) as the MCX
Server does not decrypt media content. As a consequence, the MCX Server can
always send media over an MBMS bearer without introducing a security issue.
#### 5.2.8.2 Security threats
MBMS is used insecurely as the MCX Server requires MBMS support but does not
have the MKFC from the GMS.
#### 5.2.8.3 Potential security requirements
[MCSEC-1.8-1] The security of signalling transmitted between the MCX client
and MCX server shall be controlled by the MCX server. As a consequence of this
requirement, the MCX Server shall not require key material from external MC
Domains to enable the use of MBMS.
## 5.3 Key issues on Common Functional Architecture (MC_ARCH)
Editor\'s Note: The Common Functional Architecture was previously known as the
Common Services Core within Rel-13.
### 5.3.1 Key Issue #2.1: Configuration & service access
#### 5.3.1.1 Issue details
In order to use the Mission Critical Application, the Mission Critical Service
needs to configure the Mission Critical UEs to use the service. Furthermore,
in order to allow a MCX User access to user-specific services, the MCX Service
needs to configure the MCX UE with user-profile information.
MCX UE configuration may include application configuration, cryptographic
algorithms, available services (e.g. ProSe), global policies, etc. The MCX
user-profile may include authorisation to use specific services, groups, group
affiliations, the default selected group. The configuration process(es) may be
used to enable or to disable access to Mission Critical Services.
Both these access/configuration processes need to be appropriately secured,
both in terms of authenticating the Mission Critical Service, UE and user and
in terms of ensuring the transfer of data is protected.
#### 5.3.1.2 Security threats
There are several threats to the downloading of configuration data to the UE.
\- An attacker pretending to be the Configuration Management Server may
maliciously configure the MCX UE with false configuration data, thus causing
improper operation of the MCX Application.
\- An attacker pretending to be the Configuration Management Server may
maliciously delete MCX UE configuration or user-profile data, rendering the
MCX Application inoperable.
\- Similarly an attacker pretending to be an MCX UE or MCX User may download
configuration or profile information intended for another UE or user. Such an
attack may allow an escalation of the attacker\'s privileges.
\- An attacker may manipulate or modify the data being transmitted between the
MCX Service and the MCX UE, thus adversely affecting the configuration or
user-profile data.
\- An attacker may eavesdrop on transmitted configuration data or user-profile
data and further distribute it to unauthorized parties for improper use.
\- An attacker may replay intercepted configuration data or user-profile data
thus affecting an expected configuration state at the MCX UE and/or MCX
network entity.
#### 5.3.1.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-2.1-1] The MCX UE and the Configuration Management Server, shall
mutually authenticate each other prior to MCX UE configuration to use the
Mission Critical Service.
[MCSEC-2.1-2] The MCX User and the Mission Critical Service shall mutually
authenticate each other prior to providing the MCX UE with the MCX Service
User Profile and access to user-specific services.
[MCSEC-2.1-3] The transmission of configuration data and user profile data
between the Configuration Management Serverand the MCX UE shall be
confidentiality protected, integrity protected and protected from replays.
### 5.3.2 Key Issue #2.2: Group key management
#### 5.3.2.1 Issue details
An essential part of the Mission Critical Service is to be able to communicate
within a MCX Service Group. To securely use a MCX Service Group a group
security context will need to be established by the Mission Critical Service.
During establishment and distribution of a group security context, it is
essential that the group key material is appropriately protected.
Based upon TS 22.280 [5], there are a variety of ways to create a new group:
  * Group creation via an MCX Administrator -- normal association of a user to a group to allow communication. The MCX Service Group could be a normal group, or a broadcast group, and could support off-network operation.
  * Group creation via \"Group-Regroup\" -- dynamically combining groups. MCX Service Groups may be at different security levels. Groups may be combined by entities other than Administrators (e.g. Dispatchers).
  * Group creation via \"User-Regroup\" -- temporary groups dynamically created by authorised users.
To support these group creation mechanisms, the group key distribution
process(es) needs to be able to support the secure distribution of key
material from a variety of authorised sources, and the ability to re-establish
the security association (rekey) at any time.
#### 5.3.2.2 Security threats
The following threats apply during group key distribution:
\- Interception of group key material. This would enable an attacker to
compromise the communications of the group.
\- Undetected modification of group key material. This would enable an
attacker to deny service to group members or potentially compromise the
communications of the group.
\- Impersonation of a distributor of group key material. This would enable an
attacker to rekey a group and thus compromise communications, or enable the
unauthorised creation/combining of groups.
\- Unauthorised receipt of group key material, e.g. for a group for which the
MCX User is not a member.
\- Unauthorised modification of group key material, e.g. through overwriting
of group key material via an authorised creation of a new group.
\- Failure to update a group security context. Should it not be possible to
update a group security context, the group\'s communications may be vulnerable
in the event a group key is compromised.
\- Failure to revoke a group security context. If it is not possible to revoke
a group security context, MCX UEs may continue to use compromised key material
without knowledge of compromise.
#### 5.3.2.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-2.2-1] Key material for a MCX Service Group shall be integrity and
confidentiality protected for a specific MCX User during distribution from the
MCX Service to MCX UEs.
[MCSEC-2.2-2] Key material for a MCX Service Group shall be authenticated as
coming from a valid, authorised source. The authorised source may be MCX
Administrator or may be another authorised entity (e.g. an authorised user or
dispatcher).
[MCSEC-2.2-3] It shall be possible for authorised entities to dynamically
create and distribute a new group security context at any time. This may be as
part of a group creation process, be due to a periodic update to maintain key
freshness, or due to compromise of group key material.
[MCSEC-2.2-4] The creation of a new group security context (e.g. via User-
Regroup operation) shall not change or compromise an existing group security
context.
[MCSEC-2.2-5] It shall be possible for an authorised, authenticated entity to
revoke and update a group security context from use.
## 5.4 Key issues on push-to-talk enhancements (eMCPTT)
### 5.4.1 Key Issue #3.1: Interception of user traffic
#### 5.4.1.1 Issue details
Traffic and signalling sent to and from UEs is at risk of interception,
compromising information appertaining to on-going operations.
#### 5.4.1.2 Security threats
a) Eavesdropping at air interface. Signalling or traffic information is
recovered by an adversary using a radio receiver. Adversary could be any
member of the public.
b) Eavesdropping in mobile network. Signalling or traffic information is
recovered by an adversary intercepting a link or at a network element in the
mobile network. This could be achieved by non-security cleared personnel, or
by adversary finding vulnerable points in network, e.g. unprotected ground
based network link. It is expected that in most cases mobile networks will not
have undergone a formal government security evaluation.
c) Eavesdropping on connected networks (e.g. non 3GPP networks). Signalling or
traffic information is intercepted whilst routed to or from a user connected
over a non 3GPP network, e.g. WiFi network or line connected user.
d) Man in the middle on connected networks. Signalling or traffic information
is intercepted and altered whilst routed over a non 3GPP network. This could
be achieved by an attacker placing himself between the users or between the
user and the Mission Critical Service. As a consequence, the attacker can
jeopardize ongoing PS operations
#### 5.4.13 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-3.1-1] The Mission Critical Service shall provide a means to support
end to end confidentiality and integrity protection for all media traffic
transmitted between MCX UEs.
### 5.4.2 Key Issue #3.2: Key stream re-use
#### 5.4.2.1 Key issue details
In a group communication multiple group UEs may communicate using a shared
group key. In such a scenario, it is essential that two users do not generate
and use the same key stream, derived from the shared group key. If this were
to happen then compromise of user traffic is possible.
For example, in the particular case where SRTP is used to protect traffic
generated by a UE, with all UEs deriving their key stream from a shared group
key, the key stream for each user needs to be unique. Based on the RFC 3711
[7], key stream uniqueness is achieved by each user picking a random SSRC
(synchronisation source identifier) and actively detecting any collisions.
Were SRTP to be used as implied within the RFC as part of a solution, key
stream re-use would be highly likely, if not certain. For example, it could be
assumed that the ystem should support more than 10000 users in a group, with
each user able to produce 8 communication streams at any one time and be able
to start new communication stream at any time. In this conservative scenario,
as the SSRC is 32 bits long, the probability that two UEs in this group would
have two simultaneous streams with the same SSRCs is 0.53. This is an
unacceptably high probability of compromise. Furthermore, depending on the
length of time a stream lasts, the probability of collision will increase with
each new stream created.
As an additional complication, should two UEs decide to use the same SSRC, it
may be extremely difficult to resolve this collision on the fly.
#### 5.4.2.2 Security threats
Accidentally, or due to a malicious action, the Mission Critical System uses a
key stream that has already been used previously to protect traffic. As a
result of this key stream reuse, it is possible that both traffic streams
could be compromised.
#### 5.4.2.3 Potential security requirements
The following requirement serves as a guideline for future normative work:
[MCSEC-3.2-1] The Mission Critical System shall ensure that key streams are
not reused.
### 5.4.3 Key Issue #3.3: Late entry to group communication
#### 5.4.3.1 Issue details
To allow the Mission Critical Service to meet the Stage 1 requirements, it
needs to be possible for the authorised MCX Users to be able to perform late
entry for a MCX Service Group while communication is on-going. This implies
that an authorised MCX UE is able to obtain all information required to derive
the key stream currently in use to protect the group communication.
For example, in the case of SRTP, this may include the association between a
MCX Service Group and a particular SRTP session, the cryptographic algorithms
in use to protect the session, the SRTP Master Key in use to protect the
session (and any information required to derive the SRTP Master Key), the SRTP
Roll-Over-Counter (ROC) and the SRTP salt (if used).
#### 5.4.3.2 Security threats
The threat in this case is that a MCX User is unable to perform late entry to
a group communication as it is unable to establish the information required to
build the group security context and decrypt the traffic.
#### 5.4.3.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-3.3-1] An authorised MCX User shall be able to obtain the information
necessary to derive the group security context for the MCX Service Group while
a group communication is on-going. As a result, the MCX User shall be able to
listen to the group communication within 350ms. This requirement applies for
both on-network and off-network MCX operation.
### 5.4.4 Key Issue #3.4: Private call confidentiality
#### 5.4.4.1 Issue details
Private calls are used to establish a secure communication path between a pair
of authorised MCX Users. A Private Call may or may not use floor control and
may be setup while the MCX User is operating either on or off-network.
To support private calls, the Mission Critical System requires a mechanism for
establishing end-to-end secure between any pair of MCX Users.
#### 5.4.4.2 Security threats
The following threats apply to private calls:
\- The content of a private call is accessible to unauthorised MCX Users. As a
consequence of this threat, confidential conversations may be compromised, and
user\'s confidence in Private Call functionality may be undermined, pushing
them towards less secure communication mechanisms for private conversations.
\- A private call is replayed or modified within the Mission Critical System.
\- A private call is established by one MCX User appearing to be another MCX
User. As a consequence of this threat, confidential information may be
compromised to an unauthorised user. This threat is particularly serious
should Private calls be used to support Discreet Listening or Ambient
Listening functionality.
\- A pair of users are unable to establish a shared security context and hence
are unable to establish a Private Call.
#### 5.4.4.3 Potential security requirements
The following requirements serve as a guideline for future normative work:
[MCSEC-3.4-1] It shall be possible to establish a unique Private Call security
context between any pair of authorised MCX Users within the Mission Critical
System. The security context shall not be available to other MCX Users,
except, where necessary, authorised monitoring functions (e.g. LI, Discreet
Listening). If the security context is made available to monitoring functions,
appropriate controls and logging shall exist. This requirement applies when
MCX UEs are operating both on-network and off-network.
[MCSEC-3.4-2] The Private Call security context shall provide a means to
provide confidentiality and integrity protection of user traffic, and
authenticate the MCX Users involved in the Private Call.
5.4.5 Key Issue #3.5: MBMS subchannel control message protection
5.4.5.1 Issue details
When MBMS is used, the MCPTT Server generates MBMS subchannel control messages
as described in clause 4.2.3 of TS 24.380 [17]. These messages together with
the RTP media packets and floor control messages are distributed over MBMS
bearers. The MBMS subchannel control messages are for example used to signal
to MCPTT UEs participating in a group call when to switch from unicast to
multicast bearer or vice versa. The format and type of MBMS subchannel control
messages is described in clause 8.4 of TS 24.380 [17].
Currently, only two types of MBMS subchannel control messages are specified,
namely the Map Group to Bearer and the Unmap Group to Bearer messages. The
former is used to signal to MCPTT clients when to move from unicast to MBMS
bearer while the latter signals the move in the other direction.
An MBMS bearer is uniquely identified by a Temporary Mobile Group Identity
(TMGI) and defines a pool of resources on which media packets and floor
control messages for different ongoing group call sessions can be distributed
in parallel. With each MBMS bearer, a general purpose subchannel is
associated. This subchannel is accessible to any UE within the service area of
the MBMS bearer and is used in particular for the distribution of the MBMS
subchannel control messages.
5.4.5.2 Security threats
The MBMS subchannel control messages contain sensitive information such as the
MCPTT Group ID. In TS 33.179 [3] clause 9.3.2, MCPTT Group IDs are classified
as sensitive information to which confidentiality protection may be applied.
In this particular case, an unauthorized UE within the service area of an
active MBMS bearer can listen on the general purpose subchannel and gain
knowledge about the presence in high or low number of agents belonging to a
particular public organization (e.g. police). Such real time knowledge can be
exploited for criminal activities.
A skilful attacker with radio capabilities (e.g. fake eNB) can construct and
broadcast fake MBMS subchannel control messages in order to deceive MCPTT
clients causing them for example to start receiving and rendering the media
and floor control messages via the MBMS bearer while no data is actually being
distributed. The attacker most likely won't be able to make MCPTT clients
blindly switch to MBMS bearers thus disrupting the ongoing session in what
could be considered as a denial of service attack. In fact, depending on the
implementation, the MCPTT client would probably detect that there is no or
fake data on the MBMS bearer. Nevertheless, the MCPTT UE has to go to the
extent of allocating and using some of the radio and processing resources
before detecting that the messages were fake.
5.4.5.3 Potential security requirements
> [MCSEC-3.5-1] The Mission Critical Service shall provide means to support
> confidentiality and integrity protection for the MBMS subchannel control
> messages.
### 5.4.6 Key issue #3.6: Exposure of group identifiers
#### 5.4.6.1 Issue details
The MBMS subchannel control messages contain sensitive information such as the
MCPTT Group ID. In TS 33.179 [3], MCPTT Group IDs are classified as sensitive
information to which confidentiality protection may be applied (clause 9.3.2).
The security mechanism used for the protection of these messages is based on a
key, the MSCCK, that is shared among all the MCPTT clients served by a
specific MCPTT server.
#### 5.4.6.2 Security threats
Any UE within the service area of an active MBMS bearer in possession of the
MSCCK has access to the information provided on the general purpose MBMS
subchannel. The UE can therefore gain knowledge on which groups are active
within the same service area. This could be problematic in cases such as
"police investigating the police" and where it is beneficial and crucial to
hide group related activities from non-member UEs. If the MCPTT Group ID is
not changed or not bound to a particular group call session, then any other UE
within the service area of a bearer who is in possession of the general
purpose protection key can learn about ongoing sessions for any groups even
for groups where the UE doesn't belong.
#### 5.4.6.3 Potential security requirements
[MCSEC-3.6-1] The Mission Critical Service shall provide means to conceal
group identifiers.
Editor's Note: The severity of the exposure of group identifiers to other
clients is FFS. The proposed pseudonym based solutions are vulnerable to
traffic analysis. More precisely, for both solutions, it is possible to link
the messages based on the used pseudonyms. This aspect is slightly better for
solution #x.2 than solution #x.1 where the pseudonyms are further long-lived.
If this issue is to be properly mitigated, then the traffic analysis threat
should be addressed as well. A potential solution would require encrypting the
group identifiers with group specific keys. As this information is sent over a
shared RTCP channel, it would be cumbersome if technically feasible at all to
have such a protection.
## 5.5 Key issues on data communications (MCData)
### 5.5.1 Key issue #4.1: Protection of SDS
#### 5.5.1.1 Issue details
The MCData service shall support a Short Data Service (SDS) capability for
one-to-one, one-to-many, and group communications containing text or binary.
The MCData service shall support messages to be sent over the signalling plane
or the media plane. Both on and off-network is in scope.
TS 22.282 [7] expects that an equivalent level of security will be provided
for SDS as for MCPTT. It states that:
> \"The MCData Service will reuse functions including end-to-end encryption,
> key management, authentication of the sender, etc. defined in [3] in order
> to provide group communications for data services.\"
Additionally, TS 22.280 [5] contains the following requirements which are
applicable to all services:
> \"[R-5.12-008] Subject to regulatory constraints, the MCX Service shall
> provide a means to support confidentiality, message integrity, and source
> authentication for some information exchanges (e.g., MCX Service User
> Profile management, kill commands) that have the potential to disrupt the
> operation of the target MCX UE.\"
>
> \"[R-5.12-009] The MCX Service shall provide a means to support end-to-end
> security for all media traffic transmitted between MCX UEs.\"
>
> \"[R-5.12-010] End-to-end security shall be supported both within and
> without network coverage and regardless of whether the traffic is
> transmitted directly or via the network infrastructure.\"
Consequently, a level of protection for messaging is required that is
equivalent to MCPTT. Moreover, arguably for messaging ensuring authenticity of
the data is more important, as receivers are unable to gain a level of
authentication through recognition.
#### 5.5.1.2 Security threats
The following threats apply to the Short Data Service (SDS):
a) Eavesdropping at air interface. Signalling or traffic information is
recovered by an adversary using a radio receiver. Adversary could be any
member of the public.
b) Eavesdropping in mobile network. Signalling or traffic information is
recovered by an adversary intercepting a link or at a network element in the
mobile network.
c) Eavesdropping on connected networks (e.g. non 3GPP networks). Signalling or
traffic information is intercepted whilst routed to or from a user connected
over a non 3GPP network, e.g. WiFi network or line connected user.
d) Man in the middle on connected networks. Signalling or traffic information
is intercepted and altered whilst routed over a non 3GPP network. This could
be achieved by an attacker placing himself between the users or between the
user and the Mission Critical Service. As a consequence, the attacker can
jeopardize ongoing PS operations.
e) False message transmission. A member of an MCX group may produce a message
pretending to be from another specific member of the MCX group (e.g.
commander). This could cause disruption to on-going PS operations.
#### 5.5.1.3 Potential security requirements
[MCSEC-4.1-1] The Mission Critical Service shall provide a means to support
end-to-end confidentiality and integrity protection for messaging transmitted
between MCX UEs in both media and signalling streams.
[MCSEC-4.1-2] The Mission Critical Service shall provide a means to
authenticate messages in both media and signalling streams.
## 5.6 Key issues on video communications (MCVideo)
### 5.6.1 Key Issue #5.1: Equivalence with MCPTT
#### 5.6.1.1 Issue details
From a security point-of-view, video communications are equivalent to voice
communications, but with a different (video-enabled) codec. Hence the security
requirements on eMCPTT also apply to MCVideo.
Requirements for MCVideo can be found in TS 22.280 [5] and TS 22.281 [6].
Document TS 22.280 [5] provides the security requirements that are common to
all MCX services (MCVideo, MCPTT, and MCData) and therefore should be
addressed here.
#### 5.6.1.2 Security threats
Threats applicable to MCPTT may be applied to MCVideo.
#### 5.6.1.3 Potential security requirements
##### 5.6.1.3.1 General
[MCSEC-5.6-001] The security requirements from clause 5.4 also apply to the
MCVideo service.
##### 5.6.1.3.2 Group key management
[MCSEC-5.6-002] Group key material shall be integrity and confidentiality
protected for a specific MCX User during distribution from the MCX service to
MC UEs.
[MCSEC-5.6-003] Group key material shall be authenticated as coming from a
valid, authorized source. The authorized source may be an MCX Administrator or
may be another authorized entity (e.g. an authorized MCX User or Dispatcher).
[MCSEC-5.6-004] It shall be possible for authorized entities to dynamically
create and distribute a new group security context at any time. This may be as
part of a group creation process, be due to a periodic update to maintain key
freshness, or due to compromise of group key material.
[MCSEC-5.6-005] The creation of a new group security context (e.g. via User-
Regroup operation) shall not change or compromise an existing group security
context.
[MCSEC-5.6-006] It shall be possible for an authorized, authenticated entity
to revoke and update a group security context from use.
##### 5.6.1.3.3 On-network operation
[MCSEC-5.6-007] All users of the MCX service shall be authenticated to prevent
an adversary impersonating a user for the purpose of denial of service.
[MCSEC-5.6-008] The MCX service should take measures to detect and mitigate
DoS attacks to minimize the impact on the network and on MCX users.
[MCSEC-5.6-009] The MCX user shall be authenticated by the MCX application.
[MCSEC-5.6-010] A mechanism shall exist that allows the MCX application to be
authenticated by the MCX user.
[MCSEC-5.6-011] The MCX UE and MCX service should enforce the result of the
authentication for the duration of communications (e.g. by integrity
protection or implicit authentication by encryption with a key that is derived
from the authentication and is unknown to the adversary).
[MCSEC-5.6-012] The security solution should minimize the impact of a
compromised MCXUE on other MCX UEs.
[MCSEC-5.6-013] The MCX Service shall provide a means to ensure integrity of
all MCX user signalling at the application layer.
[MCSEC-5.6-014] The MCX Service shall protect the administrative and security
management parameters from manipulation by individuals who are not explicitly
authorized by the Mission Critical Organization.
[MCSEC-5.6-015] The MCX service shall provide a means to support
confidentiality of MCX user identities from all entities outside the MCX
service.
[MCSEC-5.6-016] The MCX service shall provide a means to support
confidentiality of MCX signalling from all entities outside the MCX service.
[MCSEC-5.6-017] The MCX Service shall provide a means to support end-to-end
confidentiality and integrity protection for all media traffic transmitted
between MCX UEs.
[MCSEC-5.6-018] The MCX Service shall provide a means to support the
confidentiality and integrity protection of location information transmitted
from the MCX UE to the MCX application server.
##### 5.6.1.3.3 Ambient listening
[MCSEC-5.6-019] Specific roles in the organization and shall be identified to
authorize and activate Ambient Listening and privileges shall be assigned to
these roles to activate and register the use of ambient listening.
[MCSEC-5.6-020] The activation of the Ambient Listening functionality shall be
automatically registered by the system and will be stored as an \'event\' by
the system.
[MCSEC-5.6-021] Any decision to activate Ambient Listening, or review of such
a decision, may also be recorded in a suitable incident log unless to do so
would interfere with the purpose for which the functionality is being used
i.e. an investigation tool for evidence gathering in cases of suspected gross
misconduct of staff or evidence gathering in criminal cases. If this is the
case the authorization needs to be recorded elsewhere as appropriate.
[MCSEC-5.6-022] A radio user should be told as soon as possible that they are,
or have been, subject to Ambient Listening and the reason why the
functionality was activated. The fact they have been informed, by whom and
when, should be recorded in a suitable log.
##### 5.6.1.3.3 Data communication between MCVideo network entities
[MCSEC-5.6-023] A security mechanism shall exist that allows transmission of
data between 3GPP MCX network entities to be authenticated, confidentiality
protected, integrity protected and protected from replays.
> NOTE: UE-to-UE and UE-to-network relays are not considered to be \'network
> entities\'.
##### 5.6.1.3.3 Off-network operation
[MCSEC-5.6-024] The MCX service should take measures to detect and mitigate
DoS attacks to minimize the impact to relays and to off-network MCX users.
[MCSEC-5.6-025] The MCX Service shall provide a means to support end-to-end
security for all media traffic transmitted between MCX UEs, including where
relays are used.
[MCSEC-5.6-026] The MCX Service shall provide a means to support the
confidentiality and integrity protection of location information transmitted
from the MCX UE to the MCPTT application server, including where relays are
used.
[MCSEC-5.6-027] MCX off-network UEs shall be explicitly or implicitly
authenticated to each other.
[MCSEC-5.6-028] MCX off-network UEs and MCX relays shall be explicitly or
implicitly authenticated to each other.
[MCSEC-5.6-029] The security solution should minimize the impact of a
compromised MCX UE on other MCX UEs.
[MCSEC-5.6-030] The MCX Service shall provide a means to ensure integrity of
all MCX user signalling at the application layer.
[MCSEC-5.6-031] The MCX service shall provide a means to support
confidentiality of MCX user identities from all entities outside the MCX
service.
[MCSEC-5.6-032] The MCX service shall provide a means to support
confidentiality of MCX signalling from all entities outside the MCX service.
##### 5.6.1.3.3 User authentication and authorisation
[MCSEC-5.6-033] MCX user authentication and authorization shall provide for
the interoperability between different networks and interoperability between
different manufacturers\' clients and servers.
[MCSEC-5.6-034] MCX user authentication and authorization shall satisfy the
requirements for MCX roaming and migration.
[MCSEC-5.6-035] MCX user authentication and authorization shall support all
deployment models listed in TS 23.179 [2]).
[MCSEC-5.6-036] MCX user authentication and authorization shall support
different mechanisms to authenticate the user, e.g. Web SSO, SIP digest, GBA,
biometric identifiers, username+password.
[MCSEC-5.6-037] MCX user authentication and authorization shall provide
efficient support from small MCPTT systems with few users to large scale MCPTT
systems with hundreds of thousands of users.
[MCSEC-5.6-038] MCX user authentication and authorization shall be extensible
to provide authorization for further mission critical services including group
aware services, additional interfaces, etc.
## 5.7 Key issues on migration and interconnect (MCSMI)
### 5.7.1 Key Issue #6.1: Maintaining security during migration and
interconnection
#### 5.7.1.1 Issue details
Migration and interconnect should not reduce the security of the Mission
Critical solution. Hence security requirements defined for other parts of the
service should also apply to in this case.
#### 5.7.1.2 Security threats
Threats applicable to the Mission Critical Service during normal operation may
apply during migration and interconnection.
#### 5.7.1.3 Potential security requirements
[MCSEC-6.1-1] The security requirements from elsewhere in clause 5 also apply
during migration and interconnection.
### 5.7.2 Key issue #6.2: Inter-domain user authentication and authorisation
#### 5.7.2.1 Issue details
Users whose identity is managed by an identity management service in one
domain may need access to interconnect services in a different domain. For
example, a user home to IdM service in domain A may be a member of a group
video service in domain B, a member of a group data service in domain C, and
may engage in individual or group voice service with users in domain D. In
order to support these scenarios, identity management services in different
domains need to support the user authentication and authorisation of visiting
users.
Theft of service, impersonation, and denial of service are possible security
threats for an MCX System that accepts visiting users. To mitigate these
threats, a secure method of authenticating and authorising a visiting user is
needed.
When a user is home to one identity management service, the home identity
management service needs to provide some verifiable credential to the other
identity management services, thereby proving the authenticity of the user.
The partner identity management service must have a method to authenticate and
verify the user before granting the user authorisation to local services,
thereby eliminating the theft of service, impersonation, and denial of service
security threats.
#### 5.7.2.2 Security threats
If users are allowed to access a service in a different domain without user
authentication and authorisation, the following security threats may occur:
a) Theft of service -- an adversary could be granted access to a particular
service without being held financially responsible for that service. This is
especially true if combined with the impersonation threat.
b) Impersonation -- an adversary could falsely present themselves as a
legitimate user without being required to prove their identity, thereby acting
as the legitimate user without their knowledge or consent.
c) Denial of service -- an adversary that is freely granted PTT, data, or
video services without authorisation can access and overload mission critical
resources preventing other authentic mission critical users from using these
service(s). Combined with the impersonation threat, an adversary could act as
a legitimate user and obtain mission critical resources, thereby denying the
resources from other mission critical users.
#### 5.7.2.3 Potential security requirements
The following inter-domain user authentication and authorisation security
requirements address the security threats identified in clause 5.7.2.2 and the
inter-domain authentication and authorisation requirements from TS 22.179 [4].
[MCSEC-6.2-1] All Mission Critical Users shall be authenticated with their
home identity management service prior to authentication or authorisation with
a partner domain.
[MCSEC-6.2-2] An identity management service shall authenticate a visiting
user prior to authorising that user for local service(s).
[MCSEC-6.2-3] A visiting user shall be authorised with the local server(s) at
the partner MCX System before being granted local services.
[MCSEC-6.2-4] A user requiring services at a partner domain shall first
acquire a verifiable credential from the user's primary identity management
service.
[MCSEC-6.2-5] The partner identity management service shall have full and
overruling authorisation control of all visiting users requesting services in
the partner MCX System.
Editor's Note: It is FFS whether an access token revocation method is needed.
# 6 List of potential security requirements
# 6.1 Common services
[MCSEC-1.1-1]: All users of the MCX Service shall be authenticated to prevent
an adversary impersonating a user for the purpose of denial of service.
[MCSEC-1.1-2]: The MCX Service should take measures to detect and mitigate DoS
attacks to minimise the impact on the network and on MCX users.
[MCSEC-1.2-1] A security mechanism shall exist that allows transmission of
data between MCX network entities to be authenticated, confidentiality
protected, integrity protected and protected from replays.
[MCSEC-1.3-1] The MCX User shall be authenticated by the Mission Critical
Application(s).
[MCSEC-1.3-2] A mechanism shall exist that allows the Mission Critical
Application(s) to be authenticated by the MCX User.
[MCSEC-1.3-3] The MCX UE and the MCX Service should enforce the result of the
authentication for the duration of use (e.g. by integrity protection or
implicit authentication by encryption with a key that is derived from the
authentication and is unknown to the adversary).
[MCSEC-1.3-4] The security solution should minimise the impact of a
compromised MCX UE on other MCX UEs.
[MCSEC-1.4-1] The Mission Critical Service shall provide a means to ensure
integrity of all user signalling at the application layer.
[MCSEC-1.4-2] The Mission Critical Service shall protect the administrative
and security management parameters from manipulation by individuals who are
not explicitly authorized by the Mission Critical Organization.
[MCSEC-1.5-1] The Mission Critical Service shall provide a means to support
confidentiality of MCX Service User IDs from all entities outside the Mission
Critical Service.
[MCSEC-1.5-2] The Mission Critical Service shall provide a means to support
confidentiality of MCX Service signalling from all entities outside the
Mission Critical Service.
[MCSEC-1.6-1] The MCX Service identities of each plane shall be used within
the corresponding plane and concealed to other planes.
[MCSEC-1.6-2] When required by the MXC Service provider, MCX Service
identities and other MCX Service sensitive information, shall be contained
within the application plane and shall provide a means to support
confidentiality and integrity of the application plane from the SIP signalling
plane.
[MCSEC-1.6-3] When protection of identities and other sensitive application
information is NOT required by the MCX Service provider, the MCX Service
identities and other MCX Service sensitive information, shall remain contained
within the application plane but do not require confidentiality protection.
[MCSEC-1.7-1] When using external security domains, the Home Security Domain
shall apply policies which ensure that only trusted external security domains
are used.
[MCSEC-1.7-2] Use of external security domains shall be logged to detect
impersonation and misuse.
[MCSEC-1.7-3] MCX Services shall be able to permit/deny the use of security
domains over their service.
[MCSEC-1.8-1] The security of signalling transmitted between the MCX client
and MCX server shall be controlled by the MCX server. As a consequence of this
requirement, the MCX Server shall not require key material from external MC
Domains to enable the use of MBMS.
## 6.2 Common functional architecture
[MCSEC-2.1-1] The MCX UE and the Configuration Management Server, shall
mutually authenticate each other prior to MCX UE configuration to use the
Mission Critical Service.
[MCSEC-2.1-2] The MCX User and the Mission Critical Service shall mutually
authenticate each other prior to providing the MCX UE with the MCX Service
User Profile and access to user-specific services.
[MCSEC-2.1-3] The transmission of configuration data and user profile data
between the Configuration Management Serverand the MCX UE shall be
confidentiality protected, integrity protected and protected from replays.
[MCSEC-2.2-1] Key material for a MCX Service Group shall be integrity and
confidentiality protected for a specific MCX User during distribution from the
MCX Service to MCX UEs.
[MCSEC-2.2-2] Key material for a MCX Service Group shall be authenticated as
coming from a valid, authorised source. The authorised source may be MCX
Administrator or may be another authorised entity (e.g. an authorised user or
dispatcher).
[MCSEC-2.2-3] It shall be possible for authorised entities to dynamically
create and distribute a new group security context at any time. This may be as
part of a group creation process, be due to a periodic update to maintain key
freshness, or due to compromise of group key material.
[MCSEC-2.2-4] The creation of a new group security context (e.g. via User-
Regroup operation) shall not change or compromise an existing group security
context.
[MCSEC-2.2-5] It shall be possible for an authorised, authenticated entity to
revoke and update a group security context from use.
## 6.3 MCPTT enhancements
[MCSEC-3.1-1] The Mission Critical Service shall provide a means to support
end to end confidentiality and integrity protection for all media traffic
transmitted between MCX UEs.
[MCSEC-3.2-1] The Mission Critical System shall ensure that key streams are
not reused.
[MCSEC-3.3-1] An authorised MCX User shall be able to obtain the information
necessary to derive the group security context for the MCX Service Group while
a group communication is on-going. As a result, the MCX User shall be able to
listen to the group communication within 350ms. This requirement applies for
both on-network and off-network MCX operation.
[MCSEC-3.4-1] It shall be possible to establish a unique Private Call security
context between any pair of authorised MCX Users within the Mission Critical
System. The security context shall not be available to other MCX Users,
except, where necessary, authorised monitoring functions (e.g. LI, Discreet
Listening). If the security context is made available to monitoring functions,
appropriate controls and logging shall exist. This requirement applies when
MCX UEs are operating both on-network and off-network.
[MCSEC-3.4-2] The Private Call security context shall provide a means to
provide confidentiality and integrity protection of user traffic, and
authenticate the MCX Users involved in the Private Call.
[MCSEC-3.5-1] The Mission Critical Service shall provide means to support
confidentiality and integrity protection for the MBMS subchannel control
messages.
[MCSEC-3.6-1] The Mission Critical Service shall provide means to conceal
group identifiers.
## 6.4 MCData
[MCSEC-4.1-1] The Mission Critical Service shall provide a means to support
end-to-end confidentiality and integrity protection for messaging transmitted
between MCX UEs in both media and signalling streams.
[MCSEC-4.1-2] The Mission Critical Service shall provide a means to
authenticate messages in both media and signalling streams.
## 6.5 MCVideo
[MCSEC-5.6-001] The security requirements from clause 5.4 also apply to the
MCVideo service.
[MCSEC-5.6-002] Group key material shall be integrity and confidentiality
protected for a specific MCX User during distribution from the MCX service to
MC UEs.
[MCSEC-5.6-003] Group key material shall be authenticated as coming from a
valid, authorized source. The authorized source may be an MCX Administrator or
may be another authorized entity (e.g. an authorized MCX User or Dispatcher).
[MCSEC-5.6-004] It shall be possible for authorized entities to dynamically
create and distribute a new group security context at any time. This may be as
part of a group creation process, be due to a periodic update to maintain key
freshness, or due to compromise of group key material.
[MCSEC-5.6-005] The creation of a new group security context (e.g. via User-
Regroup operation) shall not change or compromise an existing group security
context.
[MCSEC-5.6-006] It shall be possible for an authorized, authenticated entity
to revoke and update a group security context from use.
[MCSEC-5.6-007] All users of the MCX service shall be authenticated to prevent
an adversary impersonating a user for the purpose of denial of service.
[MCSEC-5.6-008] The MCX service should take measures to detect and mitigate
DoS attacks to minimize the impact on the network and on MCX users.
[MCSEC-5.6-009] The MCX user shall be authenticated by the MCX application.
[MCSEC-5.6-010] A mechanism shall exist that allows the MCX application to be
authenticated by the MCX user.
[MCSEC-5.6-011] The MCX UE and MCX service should enforce the result of the
authentication for the duration of communications (e.g. by integrity
protection or implicit authentication by encryption with a key that is derived
from the authentication and is unknown to the adversary).
[MCSEC-5.6-012] The security solution should minimize the impact of a
compromised MCXUE on other MCX UEs.
[MCSEC-5.6-013] The MCX Service shall provide a means to ensure integrity of
all MCX user signalling at the application layer.
[MCSEC-5.6-014] The MCX Service shall protect the administrative and security
management parameters from manipulation by individuals who are not explicitly
authorized by the Mission Critical Organization.
[MCSEC-5.6-015] The MCX service shall provide a means to support
confidentiality of MCX user identities from all entities outside the MCX
service.
[MCSEC-5.6-016] The MCX service shall provide a means to support
confidentiality of MCX signalling from all entities outside the MCX service.
[MCSEC-5.6-017] The MCX Service shall provide a means to support end-to-end
confidentiality and integrity protection for all media traffic transmitted
between MCX UEs.
[MCSEC-5.6-018] The MCX Service shall provide a means to support the
confidentiality and integrity protection of location information transmitted
from the MCX UE to the MCX application server.
[MCSEC-5.6-019] Specific roles in the organization and shall be identified to
authorize and activate Ambient Listening and privileges shall be assigned to
these roles to activate and register the use of ambient listening.
[MCSEC-5.6-020] The activation of the Ambient Listening functionality shall be
automatically registered by the system and will be stored as an \'event\' by
the system.
[MCSEC-5.6-021] Any decision to activate Ambient Listening, or review of such
a decision, may also be recorded in a suitable incident log unless to do so
would interfere with the purpose for which the functionality is being used
i.e. an investigation tool for evidence gathering in cases of suspected gross
misconduct of staff or evidence gathering in criminal cases. If this is the
case the authorization needs to be recorded elsewhere as appropriate.
[MCSEC-5.6-022] A radio user should be told as soon as possible that they are,
or have been, subject to Ambient Listening and the reason why the
functionality was activated. The fact they have been informed, by whom and
when, should be recorded in a suitable log.
[MCSEC-5.6-023] A security mechanism shall exist that allows transmission of
data between 3GPP MCX network entities to be authenticated, confidentiality
protected, integrity protected and protected from replays.
NOTE: UE-to-UE and UE-to-network relays are not considered to be \'network
entities\'.
[MCSEC-5.6-024] The MCX service should take measures to detect and mitigate
DoS attacks to minimize the impact to relays and to off-network MCX users.
[MCSEC-5.6-025] The MCX Service shall provide a means to support end-to-end
security for all media traffic transmitted between MCX UEs, including where
relays are used.
[MCSEC-5.6-026] The MCX Service shall provide a means to support the
confidentiality and integrity protection of location information transmitted
from the MCX UE to the MCPTT application server, including where relays are
used.
[MCSEC-5.6-027] MCX off-network UEs shall be explicitly or implicitly
authenticated to each other.
[MCSEC-5.6-028] MCX off-network UEs and MCX relays shall be explicitly or
implicitly authenticated to each other.
[MCSEC-5.6-029] The security solution should minimize the impact of a
compromised MCX UE on other MCX UEs.
[MCSEC-5.6-030] The MCX Service shall provide a means to ensure integrity of
all MCX user signalling at the application layer.
[MCSEC-5.6-031] The MCX service shall provide a means to support
confidentiality of MCX user identities from all entities outside the MCX
service.
[MCSEC-5.6-032] The MCX service shall provide a means to support
confidentiality of MCX signalling from all entities outside the MCX service.
[MCSEC-5.6-033] MCX user authentication and authorization shall provide for
the interoperability between different networks and interoperability between
different manufacturers\' clients and servers.
[MCSEC-5.6-034] MCX user authentication and authorization shall satisfy the
requirements for MCX roaming and migration.
[MCSEC-5.6-035] MCX user authentication and authorization shall support all
deployment models listed in TS 23.179 [2]).
[MCSEC-5.6-036] MCX user authentication and authorization shall support
different mechanisms to authenticate the user, e.g. Web SSO, SIP digest, GBA,
biometric identifiers, username+password.
[MCSEC-5.6-037] MCX user authentication and authorization shall provide
efficient support from small MCPTT systems with few users to large scale MCPTT
systems with hundreds of thousands of users.
[MCSEC-5.6-038] MCX user authentication and authorization shall be extensible
to provide authorization for further mission critical services including group
aware services, additional interfaces, etc.
## 6.6 Migration and interconnect
[MCSEC-6.1-1] The security requirements from elsewhere in clause 5 also apply
during migration and interconnection.
[MCSEC-6.2-1] All Mission Critical Users shall be authenticated with their
home identity management service prior to authentication or authorisation with
a partner domain.
[MCSEC-6.2-2] An identity management service shall authenticate a visiting
user prior to authorising that user for local service(s).
[MCSEC-6.2-3] A visiting user shall be authorised with the local server(s) at
the partner MCX System before being granted local services.
[MCSEC-6.2-4] A user requiring services at a partner domain shall first
acquire a verifiable credential from the user's primary identity management
service.
[MCSEC-6.2-5] The partner identity management service shall have full and
overruling authorisation control of all visiting users requesting services in
the partner MCX System.
# 7 Potential security solutions
## 7.1 General
This clause contains potential security solutions for consideration for
inclusion in normative work.
## 7.2 Cross-service security solutions
### 7.2.1 Solution #1.1 : KMS Discovery and redirection
#### 7.2.1.1 Overview
In TS 33.179 [3], only one security domain was supported per user, and
solutions for communicating between security domains was not defined
explicitly. To better support multiple MC Services working together, support
for multiple security domains is required. This will also aid support for
interconnection, roaming and interworking.
Using multiple security domains is a requirement for multiple MCX security
applications and hence is a cross service security solution.
#### 7.2.1.2 Motivating security requirements
This solution is intended to provide a means for allowing multiple MCX
Security Domains. Specifically, it meets requirements [MCSEC-1.7-1],
[MCSEC-1.7-2] and [MCSEC-1.7-3].
#### 7.2.1.3 Solution description
##### 7.2.1.3.1 General
Within a home security domain, users may communicate with external security
domains based on the home security domain's policy. Where the home security
domain's policy permits communication, the external KMS certificate of the
external security domain shall be provisioned to the user by the user\'s Home
KMS (the KMS of the home security domain).
Without the KMS certificate of an External KMS, communication with the
corresponding external security domain is not permitted or possible.
##### 7.2.1.3.2 Security procedures for security domain redirection
The following procedures allows for MCX Services to negotiate and inform an
MCX entity about which security domains are acceptable for an MCX session.
Prior to beginning this process, it is assumed that:
\- The initiating user has been provisioned by its Home KMS with some
information on the permitted external security domains, including the KMS
certificate of External KMSs.
\- The terminating user has been provisioned by its Home KMS with some
information on the permitted external security domains, including the KMS
certificate of External KMSs.
A user shall only communicate with its Home KMS. External KMS Certificates
shall be manually loaded onto the Home KMS and distributed to the user as part
of the KMS\'s user key management processes.
The procedure for security domain redirection is shown in Figure 7.2.1.3.2-1.
Figure 7.2.1.3.2-1: Security domain redirection
The procedures in Figure 7.2.1.3.2-1 are now described in detail. Where the
security domains used by the initiating client are acceptable to the MC
Service(s) and terminating client, communication proceeds as normal. However,
where the initiating client uses security domain(s) that are rejected along
the signalling path or by the terminating client, the following procedures
take place:
1\. The initiating client or function initiates a session with a user or
function. Based on policy, the client may assume that the user is within a
particular security domain.
2\. The home application server for the initiating client receives the
request. Under normal conditions the server routes the request on the normal
signalling path. However, the server may perform a lookup to establish the
supported security domain(s) for the terminating user. Should the incorrect
security domain(s) be used (based on local policy or the policies of the
terminating security domain), the server will not forward on the request.
3\. Should the request be forwarded on the normal signalling route other
application servers may receive the request. Under normal conditions the
server routes the request on the normal signalling path. However, the server
may perform a lookup to establish the supported security domain(s) for the
terminating user. Should an unacceptable security domain(s) be used (based on
local policy or the policies of the terminating security domain), the server
shall not forward on the request.
4\. Should the request be forwarded on the normal signalling route to the
terminating client or function, the terminating client may establish that the
security domains used by the initiating client are not permitted. In this
case, the terminating client shall send a \'security domain redirect
response\' message containing permitted security domains.
5\. Either due to a lookup, or due to receiving a \'security domain redirect
response\' message in the signalling path, the application server receives the
request. The server may modify the \'security domain redirect response\'
message based upon local policy of permitted security domains before
forwarding the message down the normal signalling path.
6\. Either due to a lookup, or due to receiving a \'security domain redirect
response\' message in the signalling path, the home application server of the
initiating client receives the request. The server may modify the \'security
domain redirect response\' message based upon local policy of permitted
security domains before forwarding the message to the initiating client.
7\. Due to use of an unpermitted security domain when initiating the
communication, the initiating client receives a \'security domain redirect
response\' message containing zero or more permitted security domains. Based
on policy, the initiating client may choose to reject the offered security
domain(s) and return an error to the user, or accept security domain(s) within
the response. Should security domain(s) be accepted, a new communication may
be setup as normal using the agreed security domains.
A MCX client shall only accept external security domains that have been
permitted by the home security domain and provisioned by the Home KMS. The
Home KMS may also provision policy around the use of external security
domains.
Editor\'s Note: The contents of the \'security domain redirect response\' is
ffs.
Editor\'s Note: The \'security domain redirect response\' should be
authenticated by the responding MCX user/entity.
##### 7.2.1.3.3 Security procedures for security domain lookup
As part of responding to a request to communicate with an MCX user in an
external security domain, the MCX service could perform a \'security domain
lookup\' on the targeted MCX UserID. The response to this lookup will be a
list of security domains which support the target MCX user. Additionally, for
each security domain returned, a list of external security domains that have
been permitted by the will be provided.
The lookup could be either internal to the MCX application server, or to a
centralised service within the MCX system.
##### 7.2.1.3.4 Security Procedures for reporting external security domain use
Domain administrators should only allow users to communicate with trusted
external security domains. Should an external security domain be misused, it
is possible that users could be impersonated within the MCX system (in the
same way that misuse of a CA compromises communications that trust that CA).
To allow such misuse to be detected, and the associated KMS certificates to be
revoked, clients should report the use of external security domains to the
Home KMS.
#### 7.2.1.4 Evaluation against requirements
Editor\'s Note: This clause is intended to describe how the solution meets the
motivating requirements.
### 7.2.2 Solution #1.2 : Distribution of key material to protect signalling
between the MCX Server and the MCX client
#### 7.2.2.1 Overview
The solution defined here allows the MCX Server to \'download\' keys to the
MCX client. This may be used to support:
\- Multicast key distribution (MSCCK/MKFC).
\- Key update (CSK/MSCCK/MKFC).
To allow this key download to be performed, new procedures are defined.
Additionally, the method for uploading CSKs to the MCX Server during a
registration is maintained from TS 33.179 [3].
If this solution is accepted, individual mechanism for distributing keys
described in 33.179 [3] (e.g. for MSCCK and MKFC) will not be required in TS
33.180.
#### 7.2.2.2 Motivating security requirements
The motivating security requirement is [MCSEC-1.8-1]. An additional motivation
is to simplify security procedures where possible (as this generally results
in a more secure system).
#### 7.2.2.3 Solution description
##### 7.2.2.3.1 Introduction
The MCX client and MCX Server require use of a number of signalling channels
for communication. For the MCPTT Server, these are:
\- Uplink signalling over SIP, unicast, MCPTT-1
\- Uplink media signalling over SRTCP, unicast, MCPTT-4
\- Uplink floor control signalling over SRTCP, unicast, MCPTT-4
\- Downlink signalling over SIP, unicast, MCPTT-1
\- Downlink media signalling over SRTCP, unicast, MCPTT-4
\- Downlink media signalling over SRTCP, multicast, MCPTT-9
\- Downlink floor control signalling over SRTCP, unicast, MCPTT-4
\- Downlink floor control signalling over SRTCP, multicast, MCPTT-9
\- Downlink MBMS subchannel control signalling over SRTCP, multicast, MCPTT-6
If the signalling channels for MCVideo and MCData are also included, the list
is much longer.
Each signalling channel between the MCX Server and MCX client requires
confidentiality and integrity protection. To allow the channels to be
protected, key distribution mechanisms are required to distribute the keys
used to protect these channels. Two key distribution mechanism are described
to provide the MCX Server and MCX client to perform the necessary key
distribution procedures to protect signalling:
\- CSK upload via SIP REGISTER or SIP PUBLISH
\- Key download via SIP NOTIFY
These two mechanisms are described in the following subclauses.
##### 7.2.2.3.2 CSK Upload to MCX Server
Key upload allows the \'CSK\' to be uploaded from the MCX client to the MCX
Server. It is only used at registration within a SIP REGISTER or SIP PUBLISH
command. Procedures for \'Key Upload\' are defined within Clause 9.1.3 of TS
33.179 [3].
##### 7.2.2.3.3 Key download from MCX Server
\'Key download\' messages allow keys to be sent from the MCX Server to the MCX
clients. It is used in the following contexts:
\- To provide a Multicast Signalling Key (MuSiK) for the protection of
multicast signalling. MKFC and MSCCK are examples of a MuSiK from TS 33.179
[3].
\- To update an existing key (e.g. CSK or MuSiK)
The MCX Server invokes a \'key download\' procedure to distribute a Multicast
Signalling Key (MuSiK) to a client when:
\- The MCX Server decides to use an MBMS bearer with the MCX client and
existing MuSiKs provided to the client are not suitable for protecting this
signalling. In this case, an MuSiK is distributed to the client to protect
MBMS subchannel control messages.
\- The MCX Server decides to transmit group signalling (e.g. media control or
floor control) over an MBMS bearer to the client, and existing MuSiKs provided
to the client are not suitable for protecting this traffic. In this case, an
MuSiK is distributed to protect this group signalling.
The MCX Server may update an existing key (CSK or MuSiK) at any time. This may
be due to revocation or expiry.
Keys (CSK or MuSiKs) within \'Key download\' messages are distributed
encrypted specifically to a MCX user and signed using an identity representing
the MCX Server. Prior to group key distribution, each MCX UE shall be
provisioned by the KMS with time-limited key material associated with the MCX
User as described in clause 7.2 of 33.179 [3]. The MCX Server shall also be
provisioned by the KMS with key material for an identity which is authorized
to act as an MCX Server.
##### 7.2.2.3.4 Security procedures for key download
The signalling key (CSK or MuSiK) is distributed with a 32-bit key identifier
(CSK-ID or MuSiK-ID) within a MIKEY payload within the SDP content of a SIP
NOTIFY message generated by the MCX Server. This payload is a MIKEY-SAKKE
I_MESSAGE, as defined in IETF RFC 6509 [20], which ensures the
confidentiality, integrity and authenticity of the payload.
The payload is constructed in a similar manner as for private call keys within
TS 33.179 [3]. A CSK/MuSiK is generated along with a CSK-ID/MuSiK-ID. The
difference from private call procedures is that it is signed using (the KMS-
provisioned key associated to) the identity of the MCX Server. The security
processes are summarized in figure 7.2.2.3.4-1.
Figure 7.2.2.3.4-1: Security information within a Key Download message
At the MCPTT UE, the MCPTT Server\'s URI is extracted from the initiator field
(IDRi) of the message. Along with the time, this is used to check the
signature on the message. If valid, the UE extracts and decrypts the
encapsulated key (MuSiK or CSK) using the (KMS-provisioned) user\'s UID key.
The MCPTT UE also extracts key id (MuSiK-ID or CSK-ID). This process is shown
in figure 7.2.2.3.4-2.
Figure 7.2.2.3.4-2: Processing the security content of a Key download message
As a result of this mechanism, the MCX UEs that have received a \'key
download\' message will receive a new signalling key, CSK or MuSiK, identified
by the 4 most significant bits of the key ID.
If the key is a CSK:
\- the MCX UE shall discard any previous CSKs associated with the MCX Server
URI, and
\- the MCX UE shall use the new CSK for uplink signaling with the MCX Server
If the key is a MuSiK:
\- the MCX UE shall store the MuSiK and MuSiK-ID. Upon receipt of multicast
signalling which indicates that the MuSiK has been used via the MuSiK-ID, the
MuSiK shall be used to decrypt the signalling.
Key derivation proceeds as previously described in TS 33.179 [3].
##### 7.2.2.3.5 Key download procedures
The procedures for key download are described in the following
Figure 7.2.2.3.5-1: Procedures for key download
0\. The MCX UE has been provisioned by a KMS with key material associated with
the MCX user. The MCX UE has also registered with an MCX Server. As a
consequence of this registration, the MCX UE has implicitly subscribed to key
download notifications from the MCX Server.
1\. The MCX Server sends a key download message (SIP NOTIFY) to the MCX UE.
The MCX UE extracts the signalling key from the key download message.
2\. Upon successful extraction of the signalling key, the MCX UE returns a key
download success message (200 OK response) to the MCX Server.
#### 7.2.2.4 Evaluation against requirements
This solution meets the requirements within this TR using a simple mechanism
that is consistent with previous approaches within TS 33.179 [3]. It removes
the need for specific procedures to support MKFCs, MSCCKs, and updating CSKs.
It would be straight forward to use this approach to distribute other types of
keys if they are required to support different services, reducing the long-
term complexity of the MC system.
A 'key download message' is an additional signalling message and hence
increases the initial signalling overhead when setting up a multicast bearer.
However, it allows for more flexible key management which reduces signalling
in the following circumstances:
\- Allows an MKFC to be the same key as a MSCCK. This reduces signalling and
key processing as the key need not be sent as both an MKFC and as a MSCCK.
\- Allows multiple multicast bearers to share the same MSCCK without including
that key in every bearer announcement message. This reduces the amount data
transmitted over signalling bearers and the amount of key processing required.
\- Similarly, as UEs change MBSFN areas, this means that a (new or the same)
MSCCK need not be redistributed in the bearer announcement message for the new
area. This reduces the amount data transmitted over signalling bearers and the
amount of key processing required.
\- Allows multiple groups to share the same MKFC. This reduces signalling by
reducing the number of group key distribution messages required.
\- Allows key update of MSCCK without making a new bearer announcement
message. Where the same key is used for multiple bearers/groups, this
significantly reduces the number of messages required to update this key.
In extremis, there could only be a single MKFC/MSCCK for protecting multicast
signalling for all groups and all multicast bearers. This is a natural
approach if the signalling security is only required to protect signalling
from those not part of the MC service, and not for separation within the
service. In this case, this solution results in only one 'key download
message' rather than repeatedly redistributing this key for every group and
every bearer.
In summary, while the 'key download message' is an additional signalling
message, it removes the need to distribute or redistribute keys in other
messages, which will reduce the amount of signalling, data and key processing.
### 7.2.3 Solution #1.3 : Adding KMS security domain details to configuration
data
#### 7.2.3.1 Overview
This solution adds details of the KMS Security Domain to configuration data
used within the mission critical system. This is required to tell the
encrypting entity which KMS is used by the receiving entity, and thus which
security parameters to use for encryption. The information is required to
support MCPTT private call, MCVideo private call, and for group key
distribution. The choice of Security Domain is associated with the user,
specifically the user's MC Service ID (MCPTT ID, MCVideo ID, MCData ID). The
Security Domain could be the Home Security Domain (the same security domain as
the encrypting entity) or an External Security Domain (a different Security
Domain to the encrypting entity).
The distribution of security parameters themselves is already defined.
Security parameters are always distributed by the home KMS over the CSC-8,
CSC-9 or CSC-10 interface. Security parameters are contained within a KMS
Certificate as defined in Annex D.3.1 of TS 33.180 [21].
\- The security parameters for the Home Security Domain are within the KMS
Certificate with \'Role = \"Home\"\'. This is distributed as part of a
\'KMSInit\' response, which provides the UE with the KMS's certificate.
\- The security parameters for an External Security Domain are within a KMS
Certificate with \'Role = \"External\"\'. This is distributed as part of a
\'KMSCertCache\' response, which provides the UE with a set of external
certificates for External Security Domains.
#### 7.2.3.2 Motivating security requirements
The primary motivation is the practical requirement to provide specific data
to allow cross-domain communications. Additionally, the following security
requirement motivates this solution:
[MCSEC-1.7-1] When using external security domains, the Home Security Domain
shall apply policies which ensure that only trusted external security domains
are used.
#### 7.2.3.3 Solution description
##### 7.2.3.3.1 Provisioning security parameters to support external security
domains
The KMS distributes security parameters, known as external KMS Certificates,
to entities in the MC service as required. These entities are the MC Users,
the GMS(s) and MCX Server(s) which require communication with an external
security domain. These entities request external KMS certificates as required
via a \'KMSCertCache\' request from the MC client to the KMS as decribed in
clause 5.2.2.3 of TS 33.180 [21].
Upon receipt of a KMSCertCache request, the KMS shall authenticate the
requesting client. Based upon policy, the KMS shall return only those external
KMS Certificates that the client is permitted to use.
The external KMS Certificates are contained in the response to the
\'KMSCertCache\' response from the KMS to the MC client. On receipt of a
'KMSCertCache' response, the client shall verify signatures within the
response and reject the message should verification fail.
The KMS Certificates within the response shall have the parameter \'Role\' set
to \'External\' to indicate that the certificate belongs to an External
Security Domain. Certificates are identified by the KMS (KMSUri) and a unique
identifier (CertUri) as defined in Annex D.3.1 of TS 33.180 [21]. A (logical)
KMS should only have a single KMS certificate active at any one time (based
upon the KMSUri). Certificates may be updated using the CertURI. Should the
client receive a certificate with a CertURI of an existing certificate, the
client shall replace this existing certificate with the newly provisioned
certificate.
##### 7.2.3.3.2 Identification of External Security Domains
To support multiple security domains, the security domain used by each user is
recorded alongside the user's MC Service ID within configuration parameters in
the MC system. Furthermore, the security domain of the GMS is recorded
alongside the GMS FQDN and the security domain of the MCX Server is recorded
alongside the MCX Server FQDN. Security domains are identified by a unique
identifier, the \'KMSUri\'. Specifically, the following describes the
situations where security domain information is needed:
1) The MCX Server(s) requires knowledge of the security domain (KMSUri) of
users connected to the server.
2.1) On initiating a MCPTT private call, the initiating UE requires knowledge
of the security domain (KMSUri) of the receiving user.
2.2) On receiving a MCPTT private call, the receiving UE requires knowledge of
the security domain (KMSUri) of the initiating user.
3.1) On initiating a MCVideo private call, the initiating UE requires
knowledge of the security domain (KMSUri) of the receiving user.
3.2) On receiving a MCVideo private call, the receiving UE requires knowledge
of the security domain (KMSUri) of the initiating user.
4.1) On initiating a MCData one-to-one SDS or file transfer, the initiating UE
requires knowledge of the security domain (KMSUri) of the receiving user.
4.2) On receiving a MCData one-to-one SDS or file transfer, the receiving UE
requires knowledge of the security domain (KMSUri) of the initiating user.
5) The Group Management Server requires knowledge of the security domain
(KMSUri) of each member of the group.
6) Group members require knowledge of the security domain (KMSUri) of the
group management server.
7) MC users require knowledge of the security domain (KMSUri) of the MCX
Server(s) to which they connect.
NOTE: In most cases, the required security domain will be the Home security
domain, meaning that the required KMSUri will be the user\'s Home KMSUri. It
may be more space efficient to only keep a record where the KMSUri is not the
Home KMSUri.
This information can be added to configuration data or pre-configuration data.
Considering the configuration data already defined, the following are
suggestions of modifications to the configuration database:
1a) Within \'MCPTT user profile data\', Table A.3-1 of TS 23.379: Below
\'MCPTT user identity (MCPTT ID)\', an entry called the \'MCPTT user security
domain\' containing the \'KMSUri\' of the user's security domain.
1b) Within \'MCVideo user profile data\', Table A.3-1 of TS 23.281: Below
\'MCVideo identity (MCVideo ID)\', an entry called the \'MCVideo user security
domain\' containing the \'KMSUri\' of the user's security domain.
1c) Within \'MCData user profile data\' Table A.3-1 of TS 23.282: Below
\'MCData identity (MCData ID)\', an entry called the \'MCData user security
domain\' containing the \'KMSUri\' of the user's security domain.
2) Within \'MCPTT user profile data\', Table A.3-1 of TS 23.379: within the
\'List of user(s) who can be called in private call\', an entry per-user
called the \'MC user security domain\' containing the \'KMSUri\' of the called
user's security domain.
3) Within an equivalent place as (C2) within the MCVideo user profile data for
an MCVideo private call (the appropriate lists do not yet exist within the
user profile data).
4) Within an equivalent place as (C2) within the MCData user profile data for
an MCData SDS message (the appropriate lists do not yet exist within the user
profile data).
5) Within \'Common group configuration data (on and off network)\', Table
A.4-1 of TS 23.280: Within the \'List of group members\', an entry per-user
called the \'MC user security domain\'. The entry shall contain the \'KMSUri\'
of the group member\'s security domain.
6a) Within \'MCPTT user profile data (on-network)\', Table A.3-2 of TS 23.379:
Under \'Application plane server identity information for group management
server where group is defined\', the entry 'group management server security
domain'. The entry shall contain the \'KMSUri\' of the KMS used by the Group
Management Server.
6b) Within \'MCPTT user profile data (off-network)\', Table A.3-3 of TS
23.379: Under \'Application plane server identity information for group
management server where group is defined\', the entry 'group management server
security domain'. The entry shall contain the \'KMSUri\' of the KMS used by
the Group Management Server.
6c) Within \'MCVideo user profile data (on-network)\', Table A.3-2 of TS
23.281: Under \'Application plane server identity information for group
management server where group is defined\', the entry 'group management server
security domain'. The entry shall contain the \'KMSUri\' of the KMS used by
the Group Management Server.
6d) Within \'MCVideo user profile data (off-network)\', Table A.3-3 of TS
23.281: Under \'Application plane server identity information for group
management server where group is defined\', the entry 'group management server
security domain'. The entry shall contain the \'KMSUri\' of the KMS used by
the Group Management Server.
6e) Within \'MCData user profile data (on-network)\', Table A.3-2 of TS
23.282: Under \'Application plane server identity information for group
management server where group is defined\', the entry 'group management server
security domain'. The entry shall contain the \'KMSUri\' of the KMS used by
the Group Management Server.
6f) Within \'MCData user profile data (off-network)\', Table A.3-3 of TS
23.282: Under \'Application plane server identity information for group
management server where group is defined\', the entry 'group management server
security domain'. The entry shall contain the \'KMSUri\' of the KMS used by
the Group Management Server.
7) During pre-configuration of the UE with the FQDN of the MCX Server(s), a
per-server entry providing the \'security domain of the MCX Server\'
containing the 'KMSUri' of the MCX Server.
##### 7.2.3.3.3 Use of Multiple Security Domains
On encrypting to an entity within the MC System using an I_MESSAGE, the client
shall lookup the KMSUri from the appropriate configuration data, then lookup
the appropriate KMS Certificate with that KMSUri from the certificate cache
downloaded from it's home KMS. The security parameters within the KMS
Certificate are used to perform encryption. The KMSUri is added to the
I_MESSAGE within the IDRkmsr field.
Equivalently, when verifying a received I_MESSAGE, the receiving client shall
extract the KMSUri from the I_MESSAGE (if present) and check this matches the
KMSUri from the appropriate configuration data. The client shall then lookup
the appropriate KMS Certificate with that KMSUri from the certificate cache
downloaded from its home KMS. The security parameters within the KMS
Certificate are used to perform verification.
Should a matching certificate not be found, the client may request the
certificate based on the KmsUri from its home KMS using an appropriate
KMSCertCache request.
#### 7.2.3.4 Evaluation against requirements
Requirement [MCSEC-1.7-1] is met by the KMS choosing which external KMS
Certificates will be sent to MCX UEs. Furthermore, the addition of the KMS URI
to configuration parameters allows the home MC System to choose which security
domains are used by its users when communicating externally.
### 7.2.4 Solution #1.4 : Encryption of entire XML signalling content
#### 7.2.4.1 Overview
This solution suggests that in TS 33.180 [21], the entire XML signalling
content should be allowed to be protected.
#### 7.2.4.2 Motivating security requirements
The motivating security requirements are those that require protection of
signalling from those outside the MC Domain. While these are currently met,
the existing solution is non-standard and inefficient which makes use of the
solution less likely to be used, leaving signalling content vulnerable to
attack.
#### 7.2.4.3 Solution description
The restriction on what content may be protected by XMLenc is removed.
Specifically, the following text in TS 33.180 [21] is removed:
> _Confidentiality protection may only be applied to the following identifiers
> and values:_
>
> _\- MCPTT ID_
>
> _\- MCPPT Group ID_
>
> _\- User location information_
>
> _\- Alerts_
>
> _\- Access token_
>
> _\- KMS provisioned key material._
Instead, where required, confidentiality protection may be applied to the
entire XML signalling payload. This removes the need for protecting individual
elements or a bespoke solution for the protection of attributes.
Where encryption is applied, the \'type\' of message is clearly stated within
the EncryptedData payload. This will allow the operator to understand how
their network is being used.
#### 7.2.4.4 Evaluation against requirements
This solution is clearly simpler, more efficient in terms of the quantity of
data, easier to implement and faster to process.
The reason the restriction on confidentiality is currently in place is to
allow the operator the ability to understand how their network is being used
to correctly bill, perform analytics and detect fraud. In particular, it would
allow the operator to check that XML signalling is not being fraudulently used
to tunnel data out of the operator network, potentially at a reduced cost.
By including detailed information within the \'type\' of message (which is not
encrypted), it should be possible for the operator to understand how their
network is being used. By also placing limits on the quantity of encrypted
data, the operator can limit any exposure to fraud.
## 7.3 Security solutions for the Common Functional Architecture (MC_ARCH)
None
## 7.4 Security solutions to enhance push-to-talk (eMCPTT)
### 7.4.1 Solution #3.1 : New bearer specific key for MBMS subchannel control
message protection
#### 7.4.1.1 Overview
This mechanism is based on the introduction of a new key: the MBMS SubChannel
Control Key (MSCCK). Upon the activation of an MBMS bearer, the MCPTT server
generates an MSCCK and distributes it to the MCPTT clients.
#### 7.4.1.2 Motivating security requirements
The solution addresses security requirement [MCSEC-3.5-1].
#### 7.4.1.3 Solution description
The MBMS SubChannel Control Key (MSCCK) is a new key that is used solely for
the protection of the MBMS subchannel control messages. The MSCCK is bearer-
specific. It is created by the MCPTT server upon the activation of an MBMS
bearer and is distributed to all the served MCPTT clients in the bearer
announcement message described in clause 10.10 of TS 23.179 [4].
##### 7.4.1.3.1 MSCCK distribution
Figure 7.4.1.3.1-1 illustrates how the new key is distributed in the procedure
for dynamic MBMS bearer establishment. In the scenario depicted by the figure,
the MCPTT server uses a unicast bearer for communication with the UE on the DL
at the start of the group communication session. When the MCPTT server decides
to use an MBMS bearer for the DL media transmission, the MCPTT server
establishes an MBMS bearer using the procedures defined in 3GPP TS 23.468
[18]. The MCPTT server provides MBMS service description information
associated with MBMS bearer(s), obtained from the BM-SC, to the UE. The UE
starts using the MBMS bearer(s) to receive DL media and stops using the
unicast bearer for the DL media transmission.
Figure 7.4.1.3.1-1: Dynamic MBMS bearer establishment
1\. An MCPTT group call is established.
2\. The downlink data is sent by unicast delivery.
3\. The MCPTT server establishes the MBMS bearer(s) for the group
communication session according to the procedures defined in 3GPP TS 23.468
[18]. The MCPTT server generates a new bearer specific MSCCK. The key has to
be fresh and is bearer specific.
4\. The MCPTT server provides service description information associated with
the MBMS bearer to the UE together with the newly generated MSCCK. The MCPTT
UE obtains the TMGI and the MSCCK from the announcement message. How the key
is transported in the message is described in the following clause.
5\. The MCPTT UE starts monitoring data over MBMS associated with the TMGI,
while in the service area associated with the TMGI.
6\. The MCPTT UE detects that it is able to receive data over MBMS associated
with the TMGI.
7\. The MCPTT client notifies the MCPTT server that it is successfully
receiving the TMGI. MCPTT server stops sending media data over unicast way to
the MCPTT client.
8\. The MCPTT server will send a MapGroupToBearer message over a previously
activated MBMS bearer to all users that will receive the call over an MBMS
bearer. The MapGroupToBearer message includes association information between
the group call and MBMS bearer. The MapGroupToBearer message includes MCPTT
group ID and information about the media stream identifier of the activated
MBMS bearer and may include the identifier (i.e. the TMGI) of the MBMS bearer
broadcasting the call. The message is protected with the MSCCK. The message is
sent over reference point MCPTT-9.
9\. MCPTT server sends the downlink media for the group call over the MBMS.
##### 7.4.1.3.2 MSCCK transport
The MSCCK is distributed encrypted specifically to a user and signed using an
identity representing the MCPTT Server. Prior to group key distribution, each
MCPTT UE within the group shall be provisioned by the MCPTT KMS with time-
limited key material associated with the MCPTT User as described in clause
7.2. The MCPTT Server shall also be provisioned by the MCPTT KMS with key
material for an identity which is authorized to manage MBMS bearers. The MSCCK
is encapsulated in a MIKEY payload in a similar manner to how private call
keys are except that it is signed using the identity of the MCPTT server (see
Figure 7.4.1.3.2-1).
{width="5.239583333333333in" height="3.4875in"}
Figure 7.4.1.3.2-1: Security information within an MBMS bearer announcement
message
#### 7.4.1.4 Evaluation against requirements
The solution fulfils the security requirements it is claiming to address. The
solution incurs an increase in size for some of the signalling messages.
### 7.4.2 Solution #3.2 : MKFC based protection for MBMS subchannel control
messages
#### 7.4.2.1 Overview
The keys already specified in the MCPTT security solution are described in
clause 7.3.3 of TS 33.179 [3]. The solution is based on reusing one of the
group specific keys, namely the MKFC, for the protection of the MBMS
subchannel control messages. The other keys are either user-specific and hence
cannot be used for protection of broadcast data (PCK, CSK); or they have
completely a different purpose and are used on different communication
channels (GMK, SPK).
#### 7.4.2.2 Motivating security requirements
The solution addresses security requirement [MCSEC-3.5-1].
#### 7.4.2.3 Solution description
This mechanism is based on using the MKFC as the protection key for the
generation of the security material of SRTCP. This is because the currently
specified MBMS subchannel control messages are group specific. In fact, each
message includes one (and only one) MCPTT Group ID. Therefore, if a message
containing a particular group ID is protected by the MKFC of that group, then
only the members of the group would be able to decipher and check the
integrity of the message.
#### 7.4.2.4 Evaluation against requirements
The solution fulfils the security requirements it is claiming to address.
On the upside, there is not much needed on the key management side since there
are already procedures for the generation and distribution of the MKFC to
group members. On the downside, using this key for another purpose goes
against the best practises and requires care in order to achieve cryptographic
separation. Furthermore, the mechanism is not future proof. For example, it
would not support new types of messages that are not group specific.
### 7.4.3 Solution #3.3 : New server specific key for MBMS subchannel control
message protection
#### 7.4.3.1 Overview
This mechanism is based on the introduction of two new keys, the Participating
Function Key (PFK) and the MBMS SubChannel Control Key (MSCCK). Upon the
activation of an MBMS bearer, the MCPTT server and the MCPTT clients generate
a bearer specific MSCCK from the PFK and use it for the protection of the
subchannel control message on that particular bearer.
#### 7.4.3.2 Motivating security requirements
The solution addresses security requirement [MCSEC-3.5-1].
#### 7.4.3.3 Solution description
##### 7.4.3.3.1 General
The Participating Function Key (PFK) is a new high level key used for the
derivation of bearer specific MBMS SubChannel Control Keys (MSCCK). The name
of the PFK key is related to the participating MCPTT function, a function in
the MCPTT server from which the MBMS subchannel control messages originate.
##### 7.4.3.3.2 PFK distribution
Initially, the PFK could be provisioned to MCPTT clients alongside other key
material to support end to end security as described in clause 7.2.4 of TS
33.179 [3]. New procedures are still required for the revocation and
provisioning of new keys.
##### 7.4.3.3.3 MSCCK generation
Upon the activation of an MBMS bearer, the MCPTT server derives the MSCCK for
example using bearer specific information such as the TMGI. On the receiver
side, the MCPTT client derives the MSCCK using the same bearer specific
information provided in the bearer announcement message.
> Editor's note: It is ffs if other freshness parameters could be used for the
> MSCCK derivation.
Figure 7.4.3.3.3-1 illustrates how the new key is generated in the procedure
for dynamic MBMS bearer establishment. In the scenario depicted by the figure,
the MCPTT server uses a unicast bearer for communication with the UE on the DL
at the start of the group communication session.
{width="4.792361111111111in" height="4.771527777777778in"}
Figure 7.4.3.3.3-1: Dynamic MBMS bearer establishment
0\. MCPTT clients are provisioned with the PFK
1\. An MCPTT group call is established.
2\. The downlink data is sent by unicast delivery.
3\. The MCPTT server establishes the MBMS bearer(s) for the group
communication session according to the procedures defined in 3GPP TS 23.468
[18]. The MCPTT server derives from the PFK a new bearer specific MSCCK.
4\. The MCPTT server provides service description information associated with
the MBMS bearer to the UE. The MCPTT UE obtains the TMGI and derives the MSCCK
from the pre-provisioned PFK.
5\. The MCPTT UE starts monitoring data over MBMS associated with the TMGI,
while in the service area associated with the TMGI.
6\. The MCPTT UE detects that it is able to receive data over MBMS associated
with the TMGI.
7\. The MCPTT client notifies the MCPTT server that it is successfully
receiving the TMGI. MCPTT server stops sending media data over unicast way to
the MCPTT client.
8\. The MCPTT server will send a MapGroupToBearer message over a previously
activated MBMS bearer to all users that will receive the call over an MBMS
bearer. The MapGroupToBearer message includes association information between
the group call and MBMS bearer. The MapGroupToBearer message includes MCPTT
group ID and information about the media stream identifier of the activated
MBMS bearer and may include the identifier (i.e. the TMGI) of the MBMS bearer
broadcasting the call. The message is protected with the MSCCK. The message is
sent over reference point MCPTT-9.
9\. MCPTT server sends the downlink media for the group call over the MBMS.
#### 7.4.3.4 Evaluation against requirements
The solution fulfils the security requirements it is claiming to address. The
solution requires that the MCPTT server generates and manages security keys, a
functionality that is currently only performed in the KMS and GMS.
One problem with this solution is the revocation of the PFK for example in
case one of the MCPTT clients is compromised. It is not clear how that could
be handled efficiently so that all the clients in possession of the
compromised keys are properly informed and provisioned with a new one. An
additional mechanism is required to make sure that the MCPTT clients regularly
check the status of the current PFK.
### 7.4.4 Solution #3.4 : Key management for Temporary Group Call -- regroup
call
#### 7.4.4.1 Overview
'Temporary Group call -- user regroup' is a new feature in MCPTT, defined in
clause 10.6.2.8 in TS 23.379 [19]. A group is created using a list of users
sent to the MCPTT server, rather than created by a GMS. Consequently, the
existing security mechanisms defined in TS 33.179 [3] for group key management
are not applicable.
To meet the security requirements defined in this document, a new key
management solution is required for 'Temporary Group call -- user regroup'.
This contribution defines a security solution which meets the security
requirements for distribution of group keys.
#### 7.4.4.2 Motivating security requirements
The security requirements are those related to distribution of group keys:
[MCSEC-2.2-1] Key material for a MCX Service Group shall be integrity and
confidentiality protected for a specific MCX User during distribution from the
MCX Service to MCX UEs.
[MCSEC-2.2-2] Key material for a MCX Service Group shall be authenticated as
coming from a valid, authorised source. The authorised source may be MCX
Administrator or may be another authorised entity (e.g. an authorised user or
dispatcher).
[MCSEC-2.2-3] It shall be possible for authorised entities to dynamically
create and distribute a new group security context at any time. This may be as
part of a group creation process, be due to a periodic update to maintain key
freshness, or due to compromise of group key material.
[MCSEC-2.2-4] The creation of a new group security context (e.g. via User-
Regroup operation) shall not change or compromise an existing group security
context.
[MCSEC-2.2-5] It shall be possible for an authorised, authenticated entity to
revoke and update a group security context from use.
#### 7.4.4.3 Solution description
##### 7.4.4.3.1 Introduction
The following procedures define a method for performing key distribution for a
'Temporary Group call -- user regroup' group. From a security point-of-view,
the approach described is to perform a 'private call' key distribution for
each user, but using the same key to create the security context for the
group.
The security procedures described below do not conform to those described in
TS 23.379 [19] clause 10.6.2.8.
##### 7.4.4.3.2 New Group Call Setup Procedures (including security)
Figure 7.4.4.3.2-1 below illustrates the group call setup procedure initiated
by an authorized user.
Figure 7.4.4.3.2-1: Group call setup and key management for temporary group
call -- user regroup
1\. MCPTT client 1 (of an authorized user) initiates the group call by sending
the group call request to the MCPTT server containing a single user id. The
MCPTT client generates a Temporary Group Master Key (TGMK) and encrypts the
TGMK to the receiving user. The encrypted TGMK is attached to the group call
request.
2\. The MCPTT server checks whether the MCPTT client 1 can initiate the group
call.
3\. The MCPTT server implicitly affiliates the client to the group.
4\. The MCPTT server sends the group call request towards the MCPTT client.
The message contains the temporary group indicator. The message also contains
the encrypted TGMK.
5\. The receiving MCPTT client is notified about the incoming group call. The
users verify they are authorized to participate in the temporary group call.
The MCPTT client decrypts and extracts the TGMK.
6\. The receiving MCPTT client accept the group call request and send group
call response to the MCPTT server. This response may contain an
acknowledgement. The conditions for sending acknowledgement may be based on
configuration.
For each additional MCPTT user who is a member of the group:
7\. The initiating MCPTT user sends a 'add group call user' request to the
MCPTT Server indicating the additional MCPTT user id. The initiating client
encrypts the TGMK to the receiving user. The encrypted TGMK is attached to the
'add group call user' request.
8\. Steps 4-6 are repeated by the MCPTT Server for the added MCPTT user.
9\. The MCPTT server sends the group call response to MCPTT client 1 through
the signalling path to inform about successful call establishment.
NOTE: Step 9 can occur at any time following step 6a, and prior to step 8
depending on the conditions to proceed with the call.
10\. MCPTT clients establish media plane and floor control resources. The
MCPTT media plane is protected using the TGMK.
#### 7.4.4.4 Evaluation against requirements
The solution meets the security requirements defined above by reusing the key
distribution mechanisms from private calls to support this type of group call.
The following are advantages of the solution:
\- Maintains the same security properties of other types of call.
\- Previously defined mechanisms may be reused to support this type of call.
\- The call may begin while users are being added to the group.
\- Scales to support a large group, although a delay to call setup is likely
while all group members are each joined to the group individually.
\- Could allow new users to be added after call setup.
The following are disadvantages of the solution:
\- Modifies SA6's call flow. Would require an LS to SA6 and modification of TS
23.379 [19].
\- Introduces additional signalling (depending on number of users added to the
group).
### 7.4.5 Solution #3.5 : Concealment of group identifiers using group
specific pseudonyms
#### 7.4.5.1 Overview
It is proposed to use a group-specific pseudonym instead of the MCPTT Group ID
in the MBMS subchannel control messages. The pseudonym can be generated and
distributed by the GMS to the group members alongside the other group call
protection material such as the GMK. In another option, the group pseudonym
could be generated using the group call protection material such as the GMK
and the MCPTT Group ID.
#### 7.4.5.2 Motivating security requirements
The solution addresses security requirement [MCSEC-3.6-1].
#### 7.4.5.3 Solution description
Two alternatives are described for the generation and distribution of the
group pseudonyms.
##### 7.4.5.3.1 GMS provided pseudonyms - Explicit pseudonyms
For each group, the GMS generates a pseudonym and distribute it alongside the
GMK. As described in clause 7.3.1 of TS 33.179 [3], the GMS constructs a
MIKEY-SAKKE I_MESSAGE containing the necessary information. Figure 7.4.5.3.1-1
below shows the structure of the GMK transport message with an indication on
where the pseudonym could be included.
{width="6.040277777777778in" height="2.7583333333333333in"}
Figure 7.4.5.3.1-1: Payload structure for GMK distribution
The payload is then distributed to the MCPTT clients (members of the group) in
a group notification message as described in TS 33.179 [3] clause 7.3.2.
Figure 7.4.5.3.1-2 illustrates a scenario where the pseudonym is provided in
the payload.
{width="4.59375in" height="2.25625in"}
Figure 7.4.5.3.1-2: Group pseudonym provisioning along GMK
##### 7.4.5.3.2 Implicit pseudonyms
In this option, the group pseudonym is generated using a hash function from
group specific information such as the MCPTT group ID the GMK of the group. In
such case, the pseudonym does not need to be provided by the GMS since each
member is capable of producing it. Figure 7.4.5.3.2-1 illustrates the scenario
where the pseudonym is generated based on the GMK and the MCPTT group ID
provided in the payload of the group notification request message.
{width="4.59375in" height="2.261111111111111in"}
Figure 7.4.5.3.2-1: Generation of the group pseudonym based on information
provided in the GMK payload
#### 7.4.5.4 Evaluation against requirements
The solution satisfies the motivating security requirement.
### 7.4.6 Solution #3.6 : Concealment of group identifiers using session
specific pseudonyms
#### 7.4.6.1 Overview
The solution is based on the introduction of a call session-specific pseudonym
to be used instead of the MCPTT Group ID in the MBMS subchannel control
messages. The pseudonym can be generated and distributed by the MCPTT server
during the call setup procedure.
#### 7.4.6.2 Motivating security requirements
The solution addresses security requirement [MCSEC-3.6-1].
#### 7.4.6.3 Solution description
The pseudonyms are call session specific. The pseudonym is generated and
distributed during the call setup procedures described in TS 23.179 clause
10.6.2.4.1.1 [2]. The generation of the pseudonyms could be left entirely to
the MCPTT server or could be defined based on information available during the
call setup.
One possible scenario could be the following. Upon the reception of a group
call request, the MCPTT server generates a pseudonym and distributes it to the
active group members and the initiating MCPTT client. Figure 7.4.6.3-1
highlights the required additional steps in the call setup procedures.
Figure 7.4.6.3-1: Generation and distribution of the MCPTT Group pseudonym on
the originating side
Another option would be to provide the pseudonym to Partner MCPTT servers as
well so that the pseudonym gets possibly distributed to the MCPTT clients of
the affiliated MCPTT users. In this options the group call setup procedures
are modified as shown in Figure 7.4.6.3-2 and Figure 7.4.6.3-3
Figure 7.4.6.3-2: Generation and distribution of the MCPTT Group pseudonym on
the originating side
Figure 7.4.6.3-3: Distribution of the MCPTT Group pseudonym on the terminating
side
#### 7.4.6.4 Evaluation against requirements
The solution satisfies the motivating security requirement. Compared to
solution #3.5, the current solution has better security properties since
pseudonyms could be randomly changed in each session. Even within the same
session, different pseudonyms could be used depending on how many
participating functions (PFs) are involved.
Within an MCPTT server, the PF is the logical function that serves the clients
and applies user specific handling on the calls. Each PF can also own a
specific MBMS bearer and send media and floor control messages via its own
bearer. In addition, each PF can be in a different MCPTT provider or an MCPTT
provider can own several PFs (e.g. when the MCPTT provider serves a large
number of users).
### 7.4.7 Solution #3.7 : Key management for First-to-answer call
#### 7.4.7.1 Overview
'First-to-answer' call is a new feature in MCPTT, defined in clause 10.15 in
TS 23.379 [1]. A call is requested from many users, but only initiated with
the first of those users to answer. As a consequence, the existing key
distribution procedures for private call will not work in this context.
To meet the security requirements defined in this document, a new key
management solution is required for \'first-to-answer' calls. This
contribution defines a security solution which meets the security requirements
for distribution of private call keys in this context.
#### 7.4.7.2 Motivating security requirements
Related stage 1 MCPTT security requirements are as follows:
[R-5.12-001] The MCX Service shall provide a means to support the
confidentiality and integrity of all user traffic and signalling at the
application layer.
[R-5.12-008] Subject to regulatory constraints, the MCX Service shall provide
a means to support confidentiality, message integrity, and source
authentication for some information exchanges (e.g., MCX Service User Profile
management, kill commands) that have the potential to disrupt the operation of
the target MCX UE.
[R-5.12-009] The MCX Service shall provide a means to support end-to-end
security for all media traffic transmitted between MCX UEs.
[R-5.12-010] End-to-end security shall be supported both within and without
network coverage and regardless of whether the traffic is transmitted directly
or via the network infrastructure.
Derived stage 2 MCPTT security requirements are as follows:
[MCSEC-4.1-1] The Mission Critical Service shall provide a means to support
end-to-end confidentiality and integrity protection for messaging transmitted
between MCX UEs in both media and signalling streams.
[MCSEC-4.1-2] The Mission Critical Service shall provide a means to
authenticate messages in both media and signalling streams.
Additional MCPTT security requirements related to the distribution of private
calls:
[MCSEC-3.4-1] It shall be possible to establish a unique Private Call security
context between any pair of authorised MCX Users within the Mission Critical
System. The security context shall not be available to other MCX Users,
except, where necessary, authorised monitoring functions (e.g. LI, Discreet
Listening). If the security context is made available to monitoring functions,
appropriate controls and logging shall exist. This requirement applies when
MCX UEs are operating both on-network and off-network.
[MCSEC-3.4-2] The Private Call security context shall provide a means to
provide confidentiality and integrity protection of user traffic, and
authenticate the MCX Users involved in the Private Call.
#### 7.4.7.3 Solution description
##### 7.4.7.3.1 Introduction
The following procedures define a method for performing key distribution for a
'first-to-answer\' call. From a security point-of-view, the approach described
is to perform a 'private call' key distribution from the \'answering\' client
to the \'initiating client of the call.
In the First to Answer feature, there are two signalling messages that require
confidentiality and integrity protection. They are the First to Answer Request
and the First to Answer Response.
##### 7.4.7.3.2 First to Answer Request
The First to Answer Request is sent by an initiating UE to the MCPTT server
containing a list of target MCPTT IDs. When required by the MCPTT service
operator, confidentiality and Integrity of the First to Answer Request message
is performed.
When confidentiality and integrity of the First to Answer Request message is
applied, it is per normal signalling protection methods as per clause 6 and
clause 9 of 33.179 [3]. Furthermore, the list of target user identities (MCPTT
IDs) in the First to Answer Request is considered sensitive application
information and therefore when required by the MCPTT service provider, is
confidentiality protected with the CSK or SPK as per clause 9.3 of 33.179 [3].
##### 7.4.7.3.3 First to Answer Response
The First to Answer Response is sent by a target UE in response to a First to
Answer Request. The First to Answer Response contains both a PCK for the
private call and a set of MCPTT IDs corresponding to the initiating and target
UEs. When required by the MCPTT service operator, confidentiality and
Integrity of the First to Answer Response message is performed.
When confidentiality and integrity of the First to Answer Request message is
applied, it is per normal signalling protection methods as per clause 6 and
clause 9 of 33.179 [3]. The list of target user identities (MCPTT IDs) in the
First to Answer Request is considered sensitive application information and
when required by the service provider, is confidentiality protected with the
CSK or SPK as per clause 9.3 of 33.179 [3].
##### 7.4.7.3.4 First-to-answer Call Setup Procedures (including security)
Figure 7.4.7.3.4-1 below illustrates the group call setup procedure initiated
by an authorized user.
Figure 7.4.7.3.4-1: First-to-answer call setup and key management
1 to 6. First-to-answer call signalling occurs as defined in TS 23.379 [1].
7\. MCPTT user **at MCPTT client** 2 accepts the call which causes MCPTT
client 2 to send an MCPTT first-to-answer call response to the MCPTT server.
MCPTT client 2 generates a Private Call Key, PCK, and encapsulates the PCK
(PCK_1) to the user associated with the initiating client, MCPTT client 1. The
PCK is encapsulated using the same mechanism as for a private call
communication. The encapsulated PCK is included with the SDP content of the
response.
8\. The MCPTT server sends an MCPTT first-to-answer call response to MCPTT
client 1 indicating that MCPTT user **at MCPTT client** 2 has accepted the
call, including the accepted media parameters and the encapsulated PCK. MCPTT
client 1 extracts the PCK from the message.
9\. The media plane for communication is established. The media is protected
using the shared PCK.
10\. **MCPTT user at MCPTT client 3 has also accepted the call which causes
MCPTT client 3 to send an MCPTT first-to-answer call response to the MCPTT
server. MCPTT client 3 will also include an encapsulated PCK (PCK_2) in the
response.**
**11\. Since the MCPTT first-to-answer call response from MCPTT client 2 is
already accepted, the MCPTT server sends a MCPTT first-to-answer call cancel
request to MCPTT client 3. The encapsulated PCK provided by MCPTT client 3
(PCK_2) is discarded.**
**12-16.** First-to-answer call signalling occurs as defined in TS 23.379 [1].
#### 7.4.7.4 Evaluation against requirements
The solution meets the security requirements defined above by reusing the key
distribution mechanisms from private calls to support this type of private
call. The security properties from private calls are maintained in this case.
## 7.5 Security solutions for data (MCData)
### 7.5.1 Solution #4.1 : SDS key distribution through signalling channel
#### 7.5.1.1 Overview
MCPTT provided a set of key distribution mechanisms through the SIP signalling
channel. These included distribution of a PCK as part of call setup, and
distribution of a GMK as part of group creation.
This solution proposes that keys for SDS are distributed using the same
mechanisms.
#### 7.5.1.2 Motivating security requirements
This solution is intended to provide part of the mechanism that provides end-
to-end confidentiality, integrity and authentication of SDS messaging,
specifically requirements [MCSEC-4.1-1] and [MCSEC-4.2-2].
#### 7.5.1.3 Solution description
##### 7.5.1.3.1 General
The solution described in the following procedures show how the key
distribution mechanism for MCPTT may be applied directly to the SDS service
##### 7.5.1.3.2 Procedures for one-to-one key distribution for SDS
The procedures in Figure 7.5.1.3.2-1 apply to the flows described in Clause
10.1 of TS 23.282 [10]. The messages used in each flow have different names,
but the request/response flow is equivalent to that shown in the figure.
Figure 7.5.1.3.2-1: One-to-one short data service session
In Figure 7.5.1.3.2-1, Step 2 and 4 result in a SDS request being transported
from the initiating client to the receiving client. This message contains an
encapsulated \'PCK\'. This procedure is equivalent to that described in clause
7.4 of TS 33.179 [3], where the PCK is transported within the \'call setup
request\'.
##### 7.5.1.3.3 Procedures for group key distribution for SDS
Within Clause 7.3 of TS 33.179 [3], a mechanism for distributing a GMK from a
group management server to MCX clients using the signalling channel is
provided. This mechanism is reused without modification to distribute a GMK
for the purpose of SDS.
Editor\'s Note: It is ffs whether a SDS \'GMK\' key may also be used for MCPTT
and/or MCVideo.
Editor\'s Note: It is ffs how keys (PCK, GMK) should be named given the
proposed expansion in their scope.
##### 7.5.1.3.4 Protection of SDS messaging
Once a SDS key has been shared between MCX clients, this key may be used to
provide confidentiality and integrity protection of SDS message(s) between MCX
clients.
Editor\'s Note: The protection mechanism for SDS messages is ffs.
#### 7.5.1.4 Evaluation against requirements
This solution provides a key management mechanism which can meet the
requirements in clause 7.5.1.2. The solution has the following benefits:
\- Reuse of existing security flows from MCPTT.
\- Efficient security mechanism where multiple messages are sent within SDS
session.
However there are the following disadvantages:
\- Complexity: Signalling mechanisms require interaction within both the
signalling layer and media layer.
\- Diversity: Different (but related) flows will need to be defined for every
type of SDS communication.
### 7.5.2 Solution #4.2 : SDS key distribution alongside messages
#### 7.5.2.1 Overview
SDS messages are distributed via both signalling and media channels. In
addition, file transfer may be viewed as another method for distributing
\'messages\' (from a security point-of-view). Consequently, an approach for
protecting a subset of data within MCData is to perform key distribution
alongside the encrypted data. This removes any security dependence on the
signalling path.
#### 7.5.2.2 Motivating security requirements
This solution is intended to provide part of the mechanism that provides end-
to-end confidentiality, integrity and authentication of SDS messaging,
specifically requirements [MCSEC-4.1-1] and [MCSEC-4.1-2].
Procedures in this section may also be applicable to other forms of data
within MCData, such as file distribution.
#### 7.5.2.3 Solution description
##### 7.5.2.3.1 General
The solution described in the following procedures show how key distribution
may be performed by concatenating the the key distribution packets to the
encrypted data itself. This approach was not possible for MCPTT as there was
not space in the media path to perform key distribution, and such an approach
would not have met the late-entry requirement. Neither of these concerns are
an issue for SDS messaging.
##### 7.5.2.3.2 Procedures for protection of data
The approach is that where data is to be protected, key distribution is
performed as part of the data protection procedure. Figure 7.5.2.3.2-1 shows
this approach to key distribution.
Figure 7.5.2.3.2-1: Key distribution alongside the data
Unsecured data content is protected using a data encryption mechanism and a
data protection key. The data protection key is also encapsulated to the
terminating users. The encapsulated key, encrypted data content and a
signature are concatenated to form the secured data message. Importantly, the
secured data message contains within itself all the information required by
the terminating client to decrypt the data and recover the unsecured data
content.
Examples of security protocols where this kind of solution has been used in
the past include S/MIME and XMLSec.
Editor\'s Note: The data encryption mechanism for SDS messages is ffs.
Editor\'s Note: The key encapsulation mechanism for one-to-one and group
communications is ffs.
Editor\'s Note: The encrypted data format is ffs.
#### 7.5.2.4 Evaluation against requirements
This solution provides a key management mechanism which can meet the
requirements in clause 7.5.2.2. The solution has the following benefits:
\- Simplicity: One mechanism can be used to protect a wide variety of traffic.
\- Self-dependent: No requirement on out-of-band signalling.
However, there are the following disadvantages:
\- Overhead: Where multiple messages are sent within a single session, there
is a key distribution overhead as keys are attached to every message.
\- New solution: Does not reuse mechanisms from TS 33.179 [3] (as the
situation differs slightly).
\- Possible network management issues: Should the network need to interact
with a messaging flow (e.g. to redirect), the MC Service could be limited in
its ability to manage the flow without complex message introspection. Clients
would likely need to understand the correct behaviour rather than the network.
Editor\'s Note: How LI will be supported is ffs.
### 7.5.3 Solution #4.3 : MCData SDS protection
#### 7.5.3.1 Overview
The MCData service consists of SDS, file download, IP connectivity and data
streaming. This solution addresses the MCData SDS data service only. MCData
SDS allows transmission of short data messages over both, signalling control
plane and media control plane.
The solution addresses all the procedures defined in TS 23.282 [10]:
\- One-to-one standalone SDS using signalling control plane on-network
\- One-to-one standalone SDS using signalling control plane off-network
\- One-to-one standalone SDS using media plane on-network
\- One-to-one SDS session on-network
\- Group standalone SDS using signalling control plane on-network
\- Group standalone SDS using signalling control plane off-network
\- Group standalone SDS using media plane on-network
\- Group SDS session on-network
As the MCData server will need to have sight of the content of MC Service and
MCData signalling parameters within the SDS, these elements are protected
using the signaling protection mechanisms already defined in clause 6 and
clause 9 of 33.179 [3].
The MCData user payload is end-to-end confidentiality and integrity protected
according to the parameters contained in an end to end security context
provided alongside the SDS. This end-to-end security context can be either a
new key or a key identifier indicating which key has been used to protect the
SDS.
#### 7.5.3.2 Motivating security requirements
Related stage 1 MCData security requirements are as follows:
> [R-5.12-001] The MCX Service shall provide a means to support the
> confidentiality and integrity of all user traffic and signalling at the
> application layer.
>
> [R-5.12-008] Subject to regulatory constraints, the MCX Service shall
> provide a means to support confidentiality, message integrity, and source
> authentication for some information exchanges (e.g., MCX Service User
> Profile management, kill commands) that have the potential to disrupt the
> operation of the target MCX UE.
>
> [R-5.12-009] The MCX Service shall provide a means to support end-to-end
> security for all media traffic transmitted between MCX UEs.
>
> [R-5.12-010] End-to-end security shall be supported both within and without
> network coverage and regardless of whether the traffic is transmitted
> directly or via the network infrastructure.
Derived stage 2 MCData security requirements are as follows:
> [MCSEC-4.1-1] The Mission Critical Service shall provide a means to support
> end-to-end confidentiality and integrity protection for messaging
> transmitted between MCX UEs in both media and signalling streams.
>
> [MCSEC-4.1-2] The Mission Critical Service shall provide a means to
> authenticate messages in both media and signalling streams.
Additional MCData security requirements may be found in clause 5.3.1.3.
#### 7.5.3.3 Solution description
##### 7.5.3.3.1 Key management for one-to-one SDS protection
A private symmetric key PDK (Private Data Key) is used for end to end
protection of one-to-one SDS messages.
The PDK and PDK-ID is distributed within the SDS message and is encapsulated
in a MIKEY-SAKKE message encrypted to the receiving user identity. It is
signed using the source identity's private signing key and the signature is
verified at the destination with the source identity.
Once the PDK is established between the source and destination, SDS exchanges
between this same source and destination may continue to use the same PDK for
subsequent MCData communications by simply providing the PDK-ID in every SDS
message. Alternatively, a new PDK may be generated and distributed to the
destination in every SDS message.
Generation and encapsulation of the PDK is as defined in clause 7.4 of 33.179
[3], similar to the PCK.
##### 7.5.3.3.2 Key management for group SDS protection
A group symmetric key GDK (Group Data Key) associated with the group is used
for end to end protection of group SDS messages.
GDK is distributed in advance by the GMS thanks to the group key distribution
as described in clause 5.2.6 of 33.179 [3].
The identifier of the group key (GDK-ID) is provided in every SDS message sent
to the group.
##### 7.5.3.3.2 SDS protection (group and one-to-one SDS)
The same SDS protection mechanism applies to all the SDS procedures defined in
TS 23.282 [10] (session or standalone mode, group or one-to-one SDS, on-
network or off-network)
The following information is protected in a SDS message:
\- A payload containing **MC Service signalling parameters** : generic mission
critical services signalling elements e.g. MCData Group ID, MCData ID. This
payload is confidentiality protected between the MCData Client and the MCData
server with signalling plane security mechanisms defined in in clause 6 and
clause 9 of 33.179 [3].
\- A payload containing **MCData signalling parameters** : information
elements necessary for identification and management of the MCData SDS
messages e.g. conversation identifiers, session identifiers, transaction
identifiers, disposition requests, date and time, etc... This payload is
confidentiality protected between the MCData Client and the MCData server with
signalling plane security mechanisms (i.e. CSK and SPK) as defined in clause 6
and clause 9 of 33.179 [3].
NOTE: As in TS 33.179 [3], the use of signalling protection is optional and is
used based on the security of the transport layer provided and the trust in
the SIP Core and HTTP Proxy.
\- A payload containing the **End to end security parameters** (i.e.
information specifying the cryptographic elements used to protect the MCData
payload). This payload can be used to either distribute a new PDK or to
provide the key id of the PDK or GCK used for SDS protection. It can contain
either:
\- a MIKEY-SAKKE message containing a PDK which defines a new individual
security context. This is used only in the one-to-one SDS case. This message
is end to end confidentiality and integrity protected using the methods
defined in clause 7.4 of 33.179 [3], or
\- The necessary security parameters used for MCData payload protection when
the protection key (PDK or GDK) has been previously provided. For example, if
MCData is encrypted with XmlEnc, those parameters are the encryption method
and the key identifier of the key used to protect the MCData payload (GDK-ID
for group SDS or PDK-ID for one-to-one SDS). This payload is confidentiality
protected between the MCData Client and the MCData server with signalling
plane security mechanisms (i.e. CSK and SPK) as defined in clause 6 and clause
9 of 33.179 [3].
\- The **MCData payload:** the actual user SDS payload for MCData user or
application consumption. This payload is end to end confidentiality and
integrity protected with the AES-128-GCM algorithm, using either the GDK for
group SDS or the PDK for one-to-one SDS. For example, using XmlEnc as defined
in clause 9.3.4 of 33.179 [3].
> Editor's note: it is assumed that the protection mechanism for SDS is XmlEnc
> but it is subject to modification according to CT1 decision.
The whole content of the SDS message (security context, MC Service signalling
parameters, MC Data signalling parameters and MCData payload) is integrity
protected between the MCData Client and the MCData server with the signalling
plane security mechanisms defined in clause 6 and clause 9 of 33.179 [3].
The scheme shown in Figure 7.5.3.3.2-1 summarizes the SDS protection:
**Figure 7.5.3.3.2-1: Protection of SDS message**
> NOTE: With an end-to-end encrypted message, MCData payload is not readable
> at the MCData servers. MCData servers may store the encrypted MCData
> payload, which can be obtained and decrypted by the authorized entities
> using the appropriate keys.
#### 7.5.3.4 Evaluation against requirements
This solution meets the Stage 1 and Stage 2 security requirements identified
in clause 7.5.3.2 for the confidentiality and integrity protection of the
MCData SDS service in both the signaling and media plane.
### 7.5.4 Solution #4.4 : MCData SDS/FD signalling and payload protection
#### 7.5.4.1 Overview
The MCData service consists of SDS, file download, IP connectivity and data
streaming. This solution addresses the encryption of MCData payloads by
describing a method for protecting TLV messages. These payloads are used
within messages in the MCData SDS data service and file distribution service
to for MCData signalling and data. The solution applies whether the payload is
transferred in the signalling or media plane.
The following TLV payloads have been defined in TS 24.282 [7]:
\- SDS Signalling Payload
\- FD Signalling Payload
\- Data Payload
\- SDS notification message
\- FD notification message
The choice of key, and the key distribution solution is defined elsewhere.
The solution would be used in all the SDS and file distribution procedures
defined in TS 23.282 [10].
#### 7.5.4.2 Motivating security requirements
Related stage 1 MCData security requirements are as follows:
> [R-5.12-001] The MCX Service shall provide a means to support the
> confidentiality and integrity of all user traffic and signalling at the
> application layer.
>
> [R-5.12-008] Subject to regulatory constraints, the MCX Service shall
> provide a means to support confidentiality, message integrity, and source
> authentication for some information exchanges (e.g., MCX Service User
> Profile management, kill commands) that have the potential to disrupt the
> operation of the target MCX UE.
>
> [R-5.12-009] The MCX Service shall provide a means to support end-to-end
> security for all media traffic transmitted between MCX UEs.
>
> [R-5.12-010] End-to-end security shall be supported both within and without
> network coverage and regardless of whether the traffic is transmitted
> directly or via the network infrastructure.
Derived stage 2 MCData security requirements are as follows:
> [MCSEC-4.1-1] The Mission Critical Service shall provide a means to support
> end-to-end confidentiality and integrity protection for messaging
> transmitted between MCX UEs in both media and signalling streams.
>
> [MCSEC-4.1-2] The Mission Critical Service shall provide a means to
> authenticate messages in both media and signalling streams.
Additional MCData security requirements may be found in clause 5.3.1.3.
#### 7.5.4.3 Solution description
##### 7.5.4.3.1 Defined protected MCData payloads
The following protected (encrypted and integrity protected) payloads are
defined for MCData SDS and file distribution:
\- Protected SDS Signalling Payload
\- Protected FD Signalling Payload
\- Protected Data Payload
\- Protected SDS notification message
\- Protected FD notification message
The following authenticated payloads are defined for MCData SDS and file
distribution:
\- Authenticated Data Payload
The following authenticated and protected (encrypted and integrity protected)
payloads are defined for MCData SDS and file distribution:
\- Authenticated and Protected Data Payload
In this case both the procedures for protecting a payload and authenticating a
payload are applied
##### 7.5.4.3.2 Requirements for protected payloads Payload
The prequisites for encryption and integrity protection of a protected payload
is that the MC client(s) or MC server(s) have a shared MCData Payload
Protection Key (DPPK). This shall be the CSK, SPK, MuSiK, GMK or PCK depending
on the payload that will be protected. The DPPK will also have a shared key
identifier, the DPPK-ID. This shall be the CSK-ID, MuSiK-ID, SPK-ID, GMK-ID or
PCK-ID respectively, based upon the type of key used.
##### 7.5.4.3.3 Requirements for authenticated payloads
The prequisites for authentication of an authenticated payload is that the MC
client will have been keyed by a KMS as defined in clause 5.3 of TS 33.180.
##### 7.5.4.3.4 Key derivation for protected payloads
Before protecting an MCData payload, the DPPK is hashed through a KDF (similar
to the process used for XML protection for application signalling), to produce
a MCData Payload Cipher Key (DPCK)
The following parameters shall be used to form the input S to the KDF that is
specified in annex B of 3GPP TS 33.220 [27]. The key used by the KDF shall be
the DPPK:
\- FC = 0xaa, (for MCData Payload Protection),
\- P0 = DPPK-ID.
\- L0 = length of above, expressed in number of bytes (i.e. 0x00 0x17).
The DPPK-ID follow the encoding also specified in annex B of 3GPP TS 33.220
[17].
Where the DPPK is 128-bits, the DPCK shall be 128-bits and hence the 128 least
significant bits of the 256 bits of the KDF output shall be used as the
signalling protection key. Where the DPPK is 256-bits, the output DPCK shall
be 256-bits and hence the entire output of the KDF shall be used.
##### 7.5.4.3.5 Format of protected payloads
All protected payloads shall have the format defined in table 7.5.4.3.5-1:
Table 7.5.4.3.5-1: MCData Protected Payload message content
* * *
Information Element Type/Reference Presence Format Length Message Type Message
type M V 1 Date and Time Date and Time of creation of protected payload
message. M V 5 Payload ID The identifier for the payload. M V 4 Payload
sequence number The sequence number of the protected payload. M V 1 Algorithm
See 7.5.4.3.6 M V 1 IV Initialisation vector (or nonce) for message M V 16
DPPK-ID Key identifier M V 4 Payload Protected Payload (Ciphertext) M TLV-E x
* * *
Where 'Payload' will be the encrypted and integrity-protected payload encoded
in a binary format.
NOTE 1: Date and Time is included as plaintext to allow the MCData server to
order end-to-end protected messages and assess whether end-to-end protected
messages may have expired.
NOTE 2: Payload ID and Payload sequence number allow protected payloads to be
split over multiple SIP messages.
##### 7.5.4.3.6 Encryption of protected payloads
Protection of payloads shall support the following algorithms (cipher suites):
Table 7.5.4.3.6-1: DP_AES_128_GCM algorithm parameters
* * *
Parameter Value/Reference Algorithm ID DP_AES_128_GCM Cipher AEAD_AES_128_GCM
(as defined in RFC 5116) DPCK Key length 128 bits IV length 128 bits AEAD
authentication tag length 128 bits
* * *
Table 7.5.4.3.6-2: DP_AES_256_GCM algorithm parameters
* * *
Parameter Value/Reference Algorithm ID DP_AES_256_GCM Cipher AEAD_AES_256_GCM
(as defined in RFC 5116 [yy]) DPCK Key length 256 bits IV length 256 bits AEAD
authentication tag length 128 bits
* * *
In using the above cipher suites as defined in RFC 5116 [yy], the plaintext,
P, shall be the full original plaintext payload. The associate data (AD) shall
be the Message Type, Date and Time, Algorithm, IV, and DPPK-ID fields within
the MCData Protected Payload message content defined in clause 7.5.4.3.5.
##### 7.5.4.3.7 Authenticated payloads
Authenticated payloads shall have the format defined in table 7.5.4.3.7-1:
Table 7.5.4.3.7-1: MCData Authenticated Payload message content
* * *
Information Element Type/Reference Presence Format Length Original Payload
Original Payload (unchanged) M TLV-E x Signature Based on algorithm M TLV-E x
* * *
The signature shall be on the entire payload excluding the value of the
signature element. However, the type and length of the signature element shall
be included in the signature. The signature value shall be encoded in binary
format.
The ECCSI signature algorithm as defined in RFC 6507 [22] shall be supported
by MC clients.
NOTE: It is assumed that the signer's identity and the signer's KMS is known
prior to distribution of the payload (e.g. due to establishment of the DPPK in
the signalling channel).
#### 7.5.4.4 Evaluation against requirements
This solution meets the Stage 1 and Stage 2 security requirements identified
in clause 7.5.4.2 for the confidentiality, integrity and authentication
protection of the MCData SDS and FD service in both the signalling and media
plane.
### 7.5.5 Solution #4.5 : MCData Key management
#### 7.5.5.1 Overview
Solution #4.4 on MCData payload security requires a MCData Payload Protection
Key (DPPK) to be shared per communication channel between entities using
payload protection.
Key management for MCData follows the same model as MCVideo and MCPTT. Where a
key is used for protection of MCData or MCVideo data, the same type of key
shall be used in the same circumstance for MCData.
#### 7.5.5.2 Motivating security requirements
Security requirements are as defined in Solution #4.4.
#### 7.5.5.3 Solution description
Solution #4.5 on MCData payload security requires a MCData Payload Protection
Key (DPPK) to be shared per communication channel between entities using
payload protection.
Key management for MCData follows the same model as MCVideo and MCPTT. Where a
key is used for protection of MCData or MCVideo data, the same type of key
shall be used in the same circumstance for MCData.
MCData signalling payloads are protected as follows:
\- Unicast MCData signalling payloads between client and server are protected
using the CSK (e.g. the DPPK is the CSK).
\- Multicast MCData signalling payloads from server to client are protected
using a MuSiK (e.g. the DPPK is a MuSiK).
\- MCData signalling payloads between servers are protected using the SPK
(e.g. the DPPK is the SPK).
\- MCData signalling payloads between two offline clients are protected using
a PCK (e.g. the DPPK is the PCK).
\- MCData signalling payloads between a group of offline clients are protected
using a GMK (e.g. the DPPK is the GMK).
MCData data payloads are protected as follows:
\- MCData data payloads end-to-end protected between two online clients are
protected using a PCK (e.g. the DPPK is the PCK).
\- MCData data payloads end-to-end protected between two offline clients are
protected using a PCK (e.g. the DPPK is the PCK).
\- MCData data payloads end-to-end protected between a group of online clients
are protected using a GMK distributed by a GMS (e.g. the DPPK is the GMK).
\- MCData data payloads end-to-end protected between a group of offline
clients are protected using a GMK distributed by a GMS (e.g. the DPPK is the
GMK).
NOTE: The DPPK is not a new type of key, it describes how the MC system\'s
existing key types are used to protect MCData. Consequently, there will be
multiple DPPKs in the MC System depending on the communication channel.
Furthermore, while a PCK and a GMK may both be used as a DPPK to protect
MCData in different channels, the PCK and the GMK should never be the same
key.
#### 7.5.5.4 Evaluation against requirements
This solution meets the Stage 1 and Stage 2 security requirements identified
in clause 7.5.5.2 for the confidentiality, integrity and authentication
protection of the MCData SDS and FD service in both the signaling and media
plane. Where possible, already agreed mechanisms are re-used.
### 7.5.6 Solution #4.6 : MCData key distribution
#### 7.5.6.1 Overview
Solution #4.4 on MCData payload security requires a MCData Payload Protection
Key (DPPK) to be shared between entities using payload protection. Solution
#4.5 requires that the DPPK shall be a CSK, MuSiK, SPK, PCK or GMK.
Key distribution for MCData follows the same model as MCVideo and MCPTT. Key
distribution methodologies for CSK, MuSiK, SPK and GMK are already defined and
are service independent. The key distribution methodology for the PCK to
support MCData reflects that used for MCPTT and MCVideo.
#### 7.5.6.2 Motivating security requirements
Security requirements are as defined in Solution #4.4.
#### 7.5.6.3 Solution description
##### 7.5.6.3.1 General
Solution #4.4 on MCData payload security requires a MCData Payload Protection
Key (DPPK) to be shared between entities using payload protection. Solution
#4.5 requires that the DPPK shall be a CSK, MuSiK, SPK, PCK or GMK.
Key distribution for MCData follows the same model as MCVideo and MCPTT. Key
distribution methodologies for CSK, MuSiK, SPK and GMK are already defined and
are service independent. The key distribution methodology for the PCK to
support MCData reflects that used for MCPTT and MCVideo.
##### 7.5.6.3.2 Distribution of CSK, MuSiK, SPK and GMK
No MCData specific procedures are used for the distribution of the CSK, MuSiK,
SPK and GMK. The procedures defined in TS 33.180 [21] are sufficient to
support the MCData service.
##### 7.5.6.3.3 Distribution of PCK to support one-to-one MCData service
The PCK and PCK-ID is distributed using service-specific signalling. For all
MCData services, SIP signalling is used to establish or send the MCData
communication. The PCK and PCK-ID is distributed within a MIKEY payload
contained within the SDP offer sent from the initiator to the receiver in the
same way as for MCPTT and MCVideo.
This key distribution mechanism applies to the following messages defined in
TS 23.282 [10]:
\- MCData standalone data request
\- MCData session data request
\- MCData FD request
#### 7.5.6.4 Evaluation against requirements
This solution meets the Stage 1 and Stage 2 security requirements identified
in clause 7.5.6.2 for the confidentiality, integrity and authentication
protection of the MCData SDS and FD service in both the signaling and media
plane. Where possible, already agreed mechanisms are re-used.
## 7.6 Security solutions for video (MCVideo)
### 7.6.1 Solution #5.1: Mission critical video (MCVideo)
#### 7.6.1.1 General
This solution addresses security for the MCVideo service including key
management, protected MCVideo private communications, and protected MCVideo
group communications. Requirements for MCVideo can be found in TS 22.280 [5]
and TS 22.281 [6].
#### 7.6.1.2 MCVideo key management functional model
The intent of the common key management functional model is to create a common
architecture for MCX services consistent with the existing PTT key management
functional model already defined in TS 33.179 [3]. As the intent is to create
a common key management functional model, it is proposed that the MCVideo key
management functional model aligns with the MCPTT key management functional
model defined in clauses 7.2 through 7.2.2 of TS 33.179 [3].
#### 7.6.1.3 MCVideo private and group key management
The intent of the common key management architecture for MCX services is that
individual identity based encryption key material assigned to a user will be
used consistently across all MC services to protect the delivery of private
and group communication keys. MCVideo key management for private and group
communications should be architecturally consistent with the existing PTT key
management architecture as already defined in TS 33.179 [3]. Key management
for private keys consists of the initiator randomly generating a session key.
This session key is encrypted and signed using IBE. The protected session key
is then shared with the target of the private communication.
Key management for group keys consists of the GMS generating a group master
key (GMK), encrypting and signing the GMK using IBE, and delivering the GMK to
the members of the group.
With the above in mind, it is proposed that key management for MCVideo align
with the MCPTT key management architecture using IBE as the protection
mechanism for delivering MCVideo private and group communication keys.
#### 7.6.1.4 Protected MCVideo private communications
In MCPTT for a protected private call, a symmetric key is created and passed
to the target device using IBE during call setup. The symmetric key is
subsequently used for SRTP protection of the media throughout the session. The
intent is to reuse this private call structure as part of the common
architecture for MCX protected private communications. MCVideo should follow
the common architecture for protecting private video communications and
therefore it is proposed that MCVideo protected private communications align
with MCPTT protected private communications by using a symmetric key created
and passed to the target device using IBE during video private communications
setup.
#### 7.6.1.5 Protected MCVideo group communications
In MCPTT for a protected group call, a symmetric master key (GMK) is created
and passed by the group home GMS to each group member using IBE. The traffic
key derived from the GMK is subsequently used for SRTP protection of the media
throughout a unicast group session and for inbound SRTP protection of the
media during multicast group communications. The intent is to reuse this group
call structure as part of the common architecture for protected group
communications. MCVideo should follow this architecture for protecting group
video communications and therefore it is proposed that MCVideo protected group
communications align with MCPTT protected group communications by using a
master symmetric key created and distributed by the group home GMS to derived
the group traffic key as defined in clause 7.3 of TS 33.179 [3].
#### 7.6.1.6 Application plane protection for MCVideo
Application plane protection for MCPTT requires private and group application
parameters to be carried in a payload separated from the signalling plane and
protected using a symmetric key. The Client-Server Key (CSK) is used for this
purpose. The intent is to reuse the signalling plane protection schema as the
common architecture for application plane protection. MCVideo should follow
this schema for protecting the application plane, and therefore it is proposed
that MCVideo application plane protection align with MCPTT application plane
protection by using the CSK as defined in clauses 9.1 and 9.3 of 33.179 [3].
#### 7.6.1.7 Floor control protection for MCVideo
Floor control protection for MCPTT requires the creation of a Key for Floor
Control (KFC) derived from the CSK and in the case of multicast, the
distribution of a Multicast Key for Floor Control (MKFC) by the group home
GMS. The intent is to reuse the MCPTT floor control protection schemas as the
common architecture for floor control protection. MCVideo should follow these
schemas for protecting unicast and multicast floor control and therefore it is
proposed that MCVideo floor control protection align with MCPTT floor control
protection by using a KFC and MKFC as defined in clause 9.4 of TS 33.179 [3].
## 7.7 Security solutions for migration and interconnect (MCSMI)
### 7.7.1 Solution #6.1: Inter-Domain Identity Management
#### 7.7.1.1 General
When a MCX User requires service authorisation and the service is in a domain
different from the primary domain of the user, coordination between the
identity management services of the two MCX domains is required. For example,
a MCX User from one domain may be a member of a group, where the group is home
to a different domain.
#### 7.7.2.2 Inter-domain identity management functional model
The inter-domain identity management functional model is shown in Figure
7.7.2.2-1.
Figure 7.7.2.2-1: Functional Model for Inter-Domain MC Identity Management
In figure 7.7.2.2-1, the IdMS located in the primary domain (MCX Domain A) is
the home identity management server for the user. The partner IdMS is located
in a second domain (MCX Domain B) and is home to the group where the primary
user requires access.
The CSC-1 reference point between the UE IdM client and the partner IdM server
endpoints shall be a direct connection and shall be protected with HTTPS
(TLS).
As defined in clause 5.6, an access token is required for user service
authorisation. The same principle applies for inter-domain user service
authorisation in that the user must present an access token issued from the
partner IdMS in MCX Domain B for authorisation to services in MCX Domain B.
In order for the UE to obtain this local access token, a token exchange
procedure with the primary IdM service shall be used to obtain a credential
that identifies the user to the partner IdM service. This credential shall be
an ID token specific to the partner IdM service, signed by the primary IdM
service per IETF RFC 7515 [15]. Upon validation, the partner IdM service shall
provide an access token to the UE specifically scoped for that user. This
access token shall provide the user with authorisation to the service(s) in
the partner domain.
The token exchange profile for accessing the partner MCX identity management
services shall consist of [13] and [14] and shall be implemented as defined in
Annex A.
NOTE: A specific and independent ID token is required for each partner
identity management domain.
#### 7.7.2.3 Inter-domain identity management for interconnect operation
Figure 7.7.2.3-1 shows the message sequence for inter-domain authentication
and authorisation for interconnect operation.
Figure 7.7.2.3-1: Inter-domain user authentication and authorisation
> Steps 0-3: These steps are the same as described in steps 0-3 of Figure
> C.1-1 within Annex C of TS 33.179 [3], and provide the initial network
> access, network security, HTTPS tunnel to IdM server, user authentication,
> IMS authentication, and SIP registration.
>
> Step 4: This step represents the culmination of steps C-1 through C-5 in
> Figure 5.6.1-1 within clause 5.6.1 of TS 33.179 [3], which authorises the
> user for services in the primary domain. As part of this step the UE obtains
> the user's profile, which specifies both local (primary domain) and non-
> local (partner domain) group services.
>
> Step 5: From the user's profile, the UE identifies group service(s) that is
> home to a partner domain. The user profile includes metadata of the group
> service(s) and information about the partner IdMS (i.e. the token endpoint
> host address and the "aud" parameter for use in the token exchange request).
>
> Step 6a: Based on [16], the UE IdM Client performs a HTTP POST (token
> exchange) request to the user's primary IdM Server token endpoint. This
> request consists of the access token obtained in step 3 and information
> about the partner IdMS (i.e. the "aud" parameter obtained from the user
> profile group metadata).
>
> Step 6b: The primary IdM Server token endpoint verifies the access token and
> returns an ID token specific to the partner IdM Server.
>
> Step 7: The UE establishes a secure HTTP tunnel with the partner IdM token
> endpoint using HTTPS.
Editor\'s Note: It is FFS how the TLS tunnel between the visiting user and the
partner systems IdM server is authenticated.
> Step 8a: The UE IdM Client performs a HTTP POST token request to the partner
> IdM token endpoint to exchange the ID token for an access token. The format
> for this message is defined in [14].
>
> Step 8b: The partner IdM Server token endpoint verifies the ID token and
> issues a 200 OK with an access token specific to the user and the user's
> local MC services.
>
> Step 9: For each group membership, the GM client in the UE follows the
> "Retrieve group configurations at the group management client" flow as shown
> in clause 10.1.2 of TS 23.179 [2], presenting an access token in the Get
> group configuration request over HTTP. If the access token is valid, the GMS
> authorises the user for the specific group management service. Completion of
> this step results in the GMS sending the user's group policy information and
> group key information to the GM client. This step is repeated for each
> additional group service that is home to this partner domain.
NOTE: Steps 5--9 are repeated for each partner domain.
## 7.8 Security solutions for interworking between LTE and non-LTE systems
(MCCI)
# 8 Evaluation and conclusion
## 8.1 Evaluation of Solution #1.2: Distribution of key material to protect
signalling
The solution meets the applicable security requirements listed in clause 5.2,
allowing a means to distribute keys for the protection of signalling between
the MC client and a MCX Server. The approach also simplifies the security
procedures already defined in TS 33.179 [3].
It is the only defined solution for updating CSK (which was not defined in TS
33.179 [3]) and meeting requirement [MCSEC-1.8-1] for distribution of MKFC.
For distribution of MSCCK, there are three other solutions: Solution #3.1,
#3.2 and #3.3. Solution #1.2 is effectively an adaptation of solution #3.1 to
distribute the new key within its own channel (rather than within the
multicast bearer announcement message). This should be more efficient over the
lifetime of the service.
Support for the MSCCK and support for distributing the MSCCK (within a bearer
announcement message) should be maintained from TS 33.179 to allow for back-
compatibility. Note, the MSCCK is not used unless required to communicate with
a legacy server or client (as defined by the functionality in TS 33.179 [3]).
In terms of back-compatibility for MKFC functionality, the following shall be
the functionality within the system:
1) The GMS shall not produce MKFCs.
2) The MCPTT PF shall:
a) attempt MuSiK \'key download\' prior to establishing an MBMS bearer. Should
the MuSiK be accepted, multicast signalling shall be protected using the MuSiK
(or another MuSiK/MSCCK subsequently delivered by the server). If the MuSiK is
rejected, only unicast signalling shall be used for MCPTT signalling with the
MC client.
b) reject any MKFCs provided from a GMS.
3) The MC client shall:
a) Support receipt and use of MKFCs (alongside MuSiK and MSCCK).
b) Reject MKFCs received from other MC systems (based upon the GMS identity).
c) Discard previously received MKFCs upon attaching to a new MC system.
Where a MuSiK is established at the same time as a MBMS bearer is established,
MuSiK distribution may be optimised by attaching the MuSiK to a MBMS bearer
announcement message rather than creating a separate \'key download\' message.
The approach applies across the MC services, and is flexible allowing
distribution of future keys for future MC services.
It is recommended that Solution #1.2 is used as the method for distribution
signalling keys to support the mission critical service.
## 8.2 Evaluation of Solution #1.3 : Multiple Security Domains
With respect to the Stage 1 security requirements in 22.280 [5], 22.281 [6]
and the derived security requirements in clause 5.2.7, support is required for
multiple security domains.
Solution #1.3 provides a means for entities within the MC System to store the
security domain (KMS URI) of another entity within the MC System. Without this
capability, a remote lookup would need to be performed every time
communication with an external security domain is required (such as described
in Solution #1.1). This would increase overhead and latency. Solution #1.1 (or
an equivalent approach) may also be required to support user roaming and
migration, but with Solution #1.3, this reduces the frequency of remote
lookups.
Consequently, it is recommended that Solution #1.3 be selected as a method for
supporting multiple security domains. This approach is applicable to all
sevices within the MC System.
## 8.3 Evaluation of Solution #3.7: Key management for first-to-answer call
With respect to the Stage 1 and Stage 2 security requirements identified in
clause 7.4.7.2, solution #3.7 proposes a method to key manage and provide
security for the first-to-call feature.
Solution #3.7 meets the stage 1 and stage 2 requirements in clause 7.4.7.2 by
1) providing a way to establish privacy between only the initiating user and
the first-to-answer responding user, and 2) protecting the session key (PCK)
and MCPTT IDs within the first-to-answer request and first-to-answer response
messages.
It is therefore proposed that solution #3.7 be selected as the first-to-answer
key management and security solution.
## 8.4 Evaluation of Solution #5.1: Mission critical video (MCVideo)
With respect to the Stage 1 MCVideo security requirements in 22.280 [5],
22.281 [6] and the derived security requirements in clause(s) 5.6, MCVideo key
management, MCVideo protected private communications and MCVideo protected
group communications should share a common security architecture with the
other MCX services wherever possible.
Solution #5.1 proposes that all aspects of the MCVideo security architecture
(key management functional model, key distribution, protected private MCVideo
communications, and protected group MCVideo communications) align with the MCX
common architecture (i.e. the MCPTT security architecture) as proposed in
clause 7.6.1.
With alignment to the common MCX security architecture as a goal, and using
the MCPTT security architecture as the baseline, it is recommended that
Solution #5.1 be selected as the way forward for the MCVideo security
architecture as it fully aligns with the MCPTT security architecture and
therefore also aligns with the common MCX security architecture.
## 8.5 Evaluation of Solution #6.1: Inter-Domain Identity Management
With respect to the Stage 1 inter-domain authorisation requirements in clause
6.17.2 of 22.280 [5], solution #6.1 proposes that the OAuth 2.0 token exchange
procedure be used to enable the authentication and authorisation of an MCX
user for services that are home to a partner domain.
Solution #6.1 meets all of the inter-domain authentication and authorisation
requirements specified in clause 6.17.2 of 22.280 [5]. Solution #6.1 provides
a method for an MCX UE to obtain a security token that can be validated by the
partner IdMS that in turn provides an access token to the MCX user. The access
token authorises the MCX user to receive services owned and hosted in the
partner domain.
Solution #6.1 addresses and meets all of the requirements for authentication
and authorisation by the primary IdMS as part of inter-domain communications.
Solution #6.1 also addresses and meets all of the requirements that the
partner system shall be able to authenticate, authorise, and control access to
partner services by visiting MCX UEs.
It is therefore proposed that solution #6.1 be selected as the inter-domain
identity management solution.
## 8.6 Evaluation of Solution #1.4: Encryption of entire XML signalling
content
Supporting encryption of the entire XML signalling content will make the
application signalling solution more usable in real terms, meaning that it is
more likely that application signalling will be protected. This will ensure
the requirements around the protection of signalling are met.
It is therefore proposed that solution #1.4 be supported within TS 33.180.
## 8.7 Evaluation of MCData Solutions
Within MCData there are six proposed solutions: #4.1, #4.2, #4.3, #4.4, #4.5
and #4.6.
#4.1 and #4.2 compare the merits of doing key distribution in the signalling
channel or alongside the media. Based upon the decision by CT to use SIP for
the signalling channel to setup media paths over SIP or MSRP, the natural
choice is to use the signalling channel for key distribution, hence #4.1 is
preferred.
#4.4 simply defines a methodology for protecting MCData payloads and is
independent of the key distribution solution.
#4.3, #4.5 and #4.6 define key distribution and key support mechanisms that
are compatible. #4.3 asserts that separate keys are used for media and
signalling protection, and that the payloads for media and signalling
protection should be protected separately. #4.5 asserts that the keys used for
protection of MCPTT and MCVideo for signalling protection (CSK, MuSiK, MSCCK)
or for media protection (PCK, GMK) should be reused for MCData. #4.6 defines
the means by which keys are distributed. This approach reflects that used for
MCPTT and MCVideo, and hence allows the maximum of existing functionality to
be reused.
In summary, the approach defined across #4.1, #4.3, #4.4, #4.5 and #4.6 shall
be adopted for protection of MCData within TS 33.180. Moreover, #4.4 notes
that the approach for protecting payloads for SIP transport may also be
applied to media transport (MSRP), and hence these five solutions allow for
SDS and FD protection across SIP or media plane.
###### ### Annex A: Token exchange profile for inter-domain identity
management
Editor's note: This annex will contain the token exchange profile for inter-
domain identity management.
#