# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
GSMA has been investigating a new VoLTE roaming architecture option, \"S8 Home
Routed (S8HR)\".
GSMA Product and Services Management Committee (PSMC) has informed 3GPP that
they endorsed S8HR architecture as a candidate for VoLTE roaming under the
assumption that the related issues (inclusive of Lawful Interception,
Emergency Call, SRVCC, and others) will be resolved by 3GPP. S8HR is an
architecture for IMS voice roaming whereby the PGW, PCRF, P-CSCF, ATCF and
ATGW are located in the HPLMN also when the UE is roaming in a VPLMN. One of
the main implications is that S8HR roaming architecture is not using Local
Breakout anymore and therefore the IMS APN is resolved to point to a PGW in
the HPLMN (rather than in the VPLMN).
The S8HR architecture limits existing Lawful Interception solutions based on
3GPP standards in the VPLMN in detecting, retrieving and reporting to Law
Enforcement Agencies targeted roaming IMS communication when obligated to do
so by an intercept request (e.g. lawful authorization or warrant).
Equivalent Lawful Interception services for VoLTE that are directly accessible
at IMS level (as defined in 3GPP TS 33.107 [3]) will have to be specifically
implemented for S8HR in VPLMN potentially requiring new functions, and new
interfaces to be defined.
The proposed solutions will provide in real time the LI services that are
normally directly accessible at IMS level in the VPLMN. The proposed solutions
need to analyse each Inbound Roamer\'s SIP message, in order (when there is an
interception decision) to initiate in real time duplication of CC, generation
in real time of IRI (including CC correlation, Location processing) for
delivery over X2 interface.
The present document studies potential solutions for LI services for S8HR
providing equivalent Lawful Interception services for VoLTE meeting the
requirements defined in TS 33.106 [11] when Confidentiality Protection is not
used (no encryption of SIP messages, and no encryption of RTP flows) on any of
the S8HR bearers, at point of Interception.
NOTE: Although the present document is a Technical Report, it contains a
number of statements expressed through the use of \'shall\' because the
content might lead to potential future specification work. However, as a
Technical Report any such statements cannot be mandatory.
# 1 Scope
The present document studies and identifies the changes to the LI
architecture, function and protocols for inbound roamers in the VPLMN when
S8HR is employed which is equivalent to the LI service level for Local
Breakout (LBO) in the VPLMN for VoLTE services. Covered by the present
document includes:
\- Potential enhancements to the LI service architecture to accommodate the
S8HR roaming architecture in the VPLMN to meet all the current LI regulatory
requirements applicable to voice and other IMS service roaming are considered
and compared.
\- Considerations on maximizing re-use of existing 3GPP defined capabilities
such as PCC is considered.
\- Exploration of the changes that may be needed to TS 33.107 [3] and TS
33.108 [4].
Finally, the present document provides recommendations for proceeding with
implementing the selected approach.
This study item takes into account GSMA related activities.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 24.229: \" IP multimedia call control protocol based on Session
Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".
[3] 3GPP TS 33.107: \"3G security; Lawful interception architecture and
functions\".
[4] 3GPP TS 33.108: \"3G security; Handover interface for Lawful Interception
(LI)\".
[5] 3GPP TR 23.749: \"Study on S8 Home Routing Architecture for VoLTE\".
[6] World Trade Organization S/L/20, \"Fourth Protocol to the General
Agreement on Trade in Services\", 30 April 1996.
[7] WTO Annex 1B, \"General Agreement on Trade in Services\".
[8] 3GPP TS 33.328: \"IP Multimedia Subsystem (IMS) media plane security\".
[9] 3GPP TS 23.203: \"Policy and charging control architecture\".
[10] 3GPP TS 29.274: \"3GPP Evolved Packet System (EPS); Evolved General
Packet Radio Service GPRS) Tunnelling Protocol for Control plane (GTPv2-C);
Stage 3\".
[11] 3GPP TS 33.106 \"3G security; Lawful interception requirements\".
[12] 3GPP TS 23.228 \"IP Multimedia Subsystem (IMS); Stage 2\".
[13] GSMA IR.92 \"IMS Profile for Voice and SMS\".
[14] IETF RFC 3320 \"Signaling Compression (SigComp)\", January 2003.
[15] IETF RFC 4896 \"Signaling Compression (SigComp) Corrections and
Clarifications\", June 2007.
[16] 3GPP TS 33.210 \"3G security; Network Domain Security (NDS); IP network
layer security\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] apply.
## 3.2 Abbreviations
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
BBIFF Bearer Binding Intercept and Forwarding Function
GATS General Agreement on Trade in Services
LBO Local Breakout
LMISF LI Mirror IMS State Function
LPCF LI Policy Control Function
PCC Policy and Charging Control
S8HR S8 Home Routing
SDF Service Data Flow
VoLTE Voice over LTE
WTO World Trade Organization
# 4 Assumptions, architecture requirements and protocol requirements
## 4.1 Assumptions
The following assumptions are used within this study:
1\. LI capabilities adhering to TS 33.108 [4] are already present in the PLMN.
2\. XCAP interception is only performed by the XCAP servers located in the
HPLMN, cf. TS 33.108 clause 7.0 [4].
3\. Confidentiality Protection is not enabled by HPLMN (no Confidentiality
Protection of SIP messages, and no Confidentiality of RTP flows) on any of the
S8HR bearers, at point of Interception: Gm Interface cf. TS 23.228 [12].
4\. For this study, Inbound roamer IMS signalling is expected to be carried
over VoLTE default IMS QCI value: cf. GSMA IR.92 clause 4.3.1 [13].
## 4.2 Architecture and architecture requirements
### 4.2.1 Architecture
The description of the S8HR roaming arrangement is extracted from TR 23.749
[5]:
The architecture for S8HR is given in the figure below. S8HR is the
architecture for roaming of IMS services which use \"well known\" IMS APN
whereby the PGW, PCRF and P-CSCF are located in the HPLMN also when the UE is
roaming in a VPLMN.
Figure 4.2.1.1: Architecture with S8 Home Routed for IMS services via \"well
known\" IMS APN (support for SRVCC or IMS Emergency sessions is not shown
here)
The key features of the architecture are as follows:
\- IMS services are home-routed using \"well known\" IMS APN via S8 interface
similar to other data roaming traffic; signalling and media use same \"well
known\" IMS APN established with the HPMN, each with specific QCI.
\- HPLMN has the full control of the call routing per service logics.
\- The IMS UNI is provided directly between UE and the HPLMN.
\- The VPLMN is not service aware.
\- The VPLMN supports all capabilities to serve VoLTE calls for inbound
subscribers, e.g. IMS voice over PS support indication to the UE, QCI=1 for
voice, QCI=2 for conversational video if the VPLMN support conversational
video, and QCI=5 bearers in EPC and E-UTRAN.
The following are the architecture requirements:
  * For the VPLMN and HPLMN to enable S8HR roaming architecture for VoLTE [4] and conversational Video [5], the following conditions must be fulfilled in EPC and for E-UTRAN access:
> \- The VPLMN must support the following capabilities:
>
> \- Bearer with QCI=5 for IMS signalling traffic;
>
> \- Bearer with QCI=1 for voice media traffic;
>
> \- Bearer with QCI=2 (or non-GBR QCI) for video media traffic if the VPLMN
> supports conversational video;
>
> \- Indication from MME to the UE \"IMS VoPS Supported Indicator =
> supported\";
>
> \- Indication from MME to the HSS \"Homogeneous Support of IMS Voice over
> PS\".
>
> \- The HPLMN must support:
>
> \- Bearer with QCI=5 for IMS signalling traffic;
>
> \- Bearer with QCI=1 for voice media traffic;
>
> \- Bearer with QCI=2 (or non-GBR QCI) for video media traffic if the HPLMN
> supports conversational video.
\- QCI=1, 2 and 5 are supported on the home-routed PDN connection when
roaming.
\- \"Well known\" IMS APN [6] is resolved to a PGW in the HPLMN, i.e. VPLM
address allowed flag set to not allowed.
### 4.2.2 S8HR impact on the 3GPP LI service
Regulations usually require that targeted VoLTE communication be reported at a
specified service (IMS/SIP/RTP) level.
VoLTE LI reporting can be accomplished with LBO roaming arrangements where the
P-CSCF SIP proxy is in the VPLMN able to extract the appropriate SIP events
and is the basis for the current 3GPP LI service defined in TS 33.106 [11], TS
33.107 [3] and TS 33.108 [4].
However as stated in clause 4.2.1, in the S8HR roaming arrangement the VPLMN
is not service aware since the P-CSCF resides in the HPLMN and the IMS UNI
interface merely transits the VPLMN without any proxy or relay function.
The implications of this is that the VPLMN that choses to support S8HR
arrangements will need additional real time capabilities to accomplish the
following for IMS VoLTE inbound roaming service as well as meet applicable LI
regulatory requirements:
  * Identify and isolate the bearers for use by the VoLTE service of all S8HR Inbound Roamers.
  * Extract the IMS VoLTE traffic in the isolated bearers for further analysis.
\- From the extracted isolated IMS VoLTE traffic, analyse the signalling to
identify LI targets, including Non-Local Identity targets, in order to trigger
interception, and to identify and to report the target service events to LEMF.
## 4.3 Functionality comparison
The technical report is limited to observed signalling to and from a visiting
UE. The report gives an indication what limitation are expected.
# 5 Key issues
## 5.1 Key issue #1 -- IMEI targeted LI
### 5.1.1 Description
National regulations may require LI targeting and reporting of communication
by IMEI in addition to other identifiers. So any solution needs to provide the
capability of identifying, retrieving and reporting any communication that is
associated with a targeted IMEI.
### 5.1.2 Architectural requirements
Just as for HPLMN LI and VPLMN LBO LI, IMEI is not directly available in IMS
signalling and content, however, it is indirectly available and therefore when
a target is an IMEI identifier, the IMEI association with private and public
user identities contained in retrieved IMS signalling shall be maintained for
all S8HR based inbound roamers registered in VPLMN. This association can then
be used to retrieve and report the targeted communication.
### 5.1.3 Stage 3 requirements
No S8HR specific stage 3 requirements have been identified.
## 5.2 Key issue #2 --Tel-URI or SIP-URI targeted LI
### 5.2.1 Description
National regulations may require LI targeting and reporting of communication
by E.164 number (Tel-URI or SIP-URI in IMS) in addition to other identifiers.
So any solution needs to provide the capability of identifying, retrieving and
reporting any communication that is associated with a targeted E.164 number
which can appear in the form of both Tel-URI and SIP-URI in IMS signalling.
### 5.2.2 Architectural requirements
Since the Tel-URI or SIP-URI of the target is an essential element of SIP
session establishment (INVITE), identifying, retrieving, and reporting any
communication associated with a targeted E.164 number is straightforward and
already incorporated into TS 33.107 [3] and TS 33.108 [4].
### 5.2.3 Stage 3 requirements
No specific stage 3 requirement is expected.
## 5.3 Key issue #3 -- LI targeted S8 GTP selection criteria
### 5.3.1 Description
When S8HR is deployed, the VPLMN only has direct visibility to GTP tunnels,
not the content of the tunnels. The VPLMN in effect merely is a router of GTP
tunnel packets. So in order to extract the target\'s VoLTE signalling and
media traffic for a lawful interception by the VPLMN when S8HR is deployed,
the VPLMN needs to identify and select which GTP tunnels actually carry IMS
traffic and potentially extract the IMS packet data from the GTP tunnels. IMS
signalling and media is carried over separate GTP tunnels. Furthermore, the
VPLMN needs to be aware of which GTP tunnels carry traffic associated to the
targeted IMS ID.
### 5.3.2 Architectural requirements
1\. VoLTE GTP tunnels for all inbound roamers in a VPLMN when S8HR is deployed
and used for IMS signalling needs to be identifiable and retrievable
separately from all other GTP tunnels used by these inbound roamers.
2\. VoLTE GTP tunnels for all inbound roamers targeted for LI service with
delivery of content when S8HR is deployed and used for IMS media needs to be
identifiable and retrievable separately from all other GTP tunnels used by
these inbound roamers.
3\. This Key Issue assumes that an LI solution for S8HR approach is based on
extracting the packets from IMS Signalling Bearers and Media Bearers.
### 5.3.3 Stage 3 requirements
S8HR VoLTE GTP tunnels shall be detectable by their APN name and by their QCI.
## 5.4 Key Issue #4 -- Obtaining network provided location
### 5.4.1 Description
National regulations may require reporting the UE\'s location at specific
times during a VoLTE call such as at the start of the call, the end of the
call and periodically during the call. The UE provided location in the
P-Access-Network-Info-Header may not be deemed trustworthy by the VPLMN and
IMS NPLI is not generated in the VPLMN, so a VPLMN network provided location
may be used and delivered to the LEA.
### 5.4.2 Architectural requirements
Any solution needs to provide the capability to use any of the network
provided location determination sources currently defined for the VPLMN in the
3GPP LI specifications [3] [4].
### 5.4.3 Stage 3 requirements
No specific stage 3 requirement is expected
## 5.5 Key issue #5 -- Intra-access handover or anchor change impact
### 5.5.1 Description
There are two types of intra-access handovers that may impact LI:
1\. S-GW relocation: S-GW relocation may happen any time the visited network
deems necessary. It is necessary to ensure that the LI system is able to
follow S-GW relocations for targeted IMS sessions and for IMS registrations.
2\. MME relocation: MME relocation may happen any time the visited network
deems necessary. It is necessary to ensure that the LI system is able to
follow MME relocations for targeted IMS sessions and for IMS registrations.
### 5.5.2 Architectural requirements
The S-GW relocation procedure, controlled by the MME, will need to be
enhanced.
### 5.5.3 Stage 3 requirements
GTPv2 (Create Session Request/Response) will need to be enhanced.
NOTE: This requirement impacts the GTPv2 protocol and would need to be
addressed by CT4.
## 5.6 Key issue #6 -- Detecting targeted signalling unknown or unrecognized
by the VPLMN
### 5.6.1 Description
A VPLMN\'s IMS infrastructure is able to recognize and process a particular
set of SIP signalling and signalling elements. By extension, it is assumed
that the VPLMN is able to report these SIP signalling and signalling elements
to LEAs. With S8HR there is the possibility of SIP/IMS signalling and
signalling elements transiting the VPLMN between the UE and HPLMN which is not
supported by the VPLMN\'s IMS/SIP infrastructure. Examples of these signalling
and signalling elements can include:
\- Proprietary extensions to IMS/SIP methods
\- Proprietary information elements in standardized IMS/SIP methods
\- Standardized IMS/SIP methods or headers supported by the HPLMN but not yet
supported or recognized by the VPLMN
\- Unrecognized or unknown SIP methods, syntax, semantics or methods usage.
Applicable IMS and SIP related standards may define certain protocol
conditions that are to be treated as errors and prevent further normal SIP
processing. Applicable IMS and SIP standards may also define the protocol
conditions that are to be ignored if unknown or unrecognized elements are
encountered and passed unmodified to the next IMS/SIP hop. Deliberate use of
IMS and SIP related protocol aspects supported in HPLMN and UEs but not in
VPLMN implementations is dependent on the following conditions:
\- The UE is able to determine the roaming arrangement (LBO or S8HR) deployed
between the VPLMN and HPLMN and act accordingly; or
\- VPLMNs pass any unknown or unrecognized IMS/SIP signalling elements which
are not error conditions to the HPLMN unmodified (LBO deployment).
The VPLMN LI service may need to take these conditions into account by
detecting unknown or unrecognized SIP signalling elements as well as
potentially taking action when detected. It is expected that operator policy
will determine the action to take when one of these conditions is encountered
in an S8HR deployment. This can include, but not limited to:
\- Reporting the unknown or unrecognized SIP signalling elements to the LEA
for analysis.
\- Terminating or redirecting the roaming service according to terms of the
roaming agreement, if any.
\- Logging the unknown or unrecognized SIP signalling elements for further
offline analysis and follow-up.
It is assumed that these conditions could be more likely encountered in S8HR
arrangements than in LBO arrangements since for LBO there are active IMS
network elements in the VPLMN participating in and processing the IMS
signalling flows whereas for S8HR there are no IMS network elements in the
VPLMN participating in or processing the IMS signalling flows.
Sub-clause 5.10 deals specifically with SIP information elements used for
negotiating encryption.
### 5.6.2 Architectural requirements
Any solution needs to provide for VPLMN operator policies to:
\- Specify what constitutes unknown or unrecognized IMS/SIP protocol aspects
from an LI service reporting perspective which otherwise would not cause a
protocol processing exception.
\- Specify what actions to take when an unknown or unrecognized IMS/SIP
protocol aspect is detected.
### 5.6.3 Stage 3 requirements
No specific stage 3 requirement is expected.
## 5.7 Key issue #7 -- Maintaining intra-PLMN and inter-PLMN LI
undetectability
### 5.7.1 Description
Detection of LI activity shall only be made available to authorised users in
their own network.
PLMNs shall not be able to detect LI related activity in any other PLMN.
### 5.7.2 Architectural requirements
Any activity necessary for LI operations but outside the LI domain shall treat
all users equally.
## 5.8 Key issue #8 -- Detecting implicit IMS registrations
### 5.8.1 Description
Several identities may be registered with one registration event by implicit
registrations.
### 5.8.2 Architectural requirements
All public identities registered for a UE shall be available at the VPLMN.
### 5.8.3 Stage 3 requirements
According to TS 24.229 [2], sub-clause 5.4.1.2.2.F, the registered distinct
public user identity and its associated set of implicitly registered public
user identities is sent to UE from S-CSCF in the \"200 (OK)\" message. Thus,
this information is available in the VPLMN.
### 5.8.4 Solution approaches
The VPLMN needs to track both IMS registration requests as well as the
registration responses, in order to be able to make sure all implicitly
registered IMS user identities are tracked.
## 5.9 Key issue #9 -- Retained data
### 5.9.1 Description
Regulatory requirements in the country of the VPLMN may require that the VPLMN
operator to retain data.
Furthermore, regulatory requirements in the country of the VPLMN may require
that the VPLMN operator can generate the retained data without recourse to the
HPLMN. In this case, the HPLMN cannot be relied upon to forward information
for Retained Data purposes to the VPLMN.
Retained Data means that the VPLMN operator needs to have the capability to
record data that is related to the communication traffic (e.g.
location/date/time/duration information, calling and called party identities,
etc.) via VPLMN network nodes., without any reliance on the HPLMN to forward
SIP events or call records
The visited network may be required to store communications metadata for all
users.
NOTE: While Retained Data is not currently in scope of TS 33.107 [3] and TS
33.108 [4], Retained Data sets similar mandatory regulatory on the VPLMN as
for LI, in those countries where it is required.
### 5.9.2 Architectural requirements
All SIP signalling needs to be available at the VPLMN.
### 5.9.3 Stage 3 requirements
The VPLMN needs to be able to provide event records containing required
information to a Retained Data system, which is external to the network nodes
responsible for collection of the information (e.g. LMISF). The node
generating the event records is not responsible for retention of those records
(except for any short term caching prior to transfer to the Retained Data
system).
NOTE: Both the interface from the VPLMN signalling extraction node to Retained
Data system and the format of any event records is out of scope of the present
document.
### 5.9.4 Solution approaches
With accessibility to all SIP signalling the VPLMN will have all relevant data
and can produce the retained data records.
## 5.10 Key issue #10 -- Prevention of unwanted use of confidentiality
mechanisms
### 5.10.1 Description
For VoLTE S8HR Roaming use cases, and to comply with some National
Obligations, the signalling and media flows of roamer-in shall be unencrypted
to allow Lawful Interception and Retained Data operations take place in an
effective manner. To enforce this, a means under control of the VPLMN needs to
be defined to prevent the Roamer-In to use confidentiality mechanisms
(signalling and media) which would result in a VPLMN being out of legal
compliance.
### 5.10.2 Architectural requirements
The VPLMN needs to be aware of all traffic on IMS signalling bearers related
to inbound roamers and able to enforce possible operator\'s policies, such as
tearing down of bearers.
### 5.10.3 Stage 3 requirements
IMS signalling needs to remain limited to SIP.
## 5.11 Key issue #11 -- Non-Local Identity
### 5.11.1 Description
Non-Local Identity interception feature is the ability for a network (e.g. a
VPLMN using S8HR VoLTE Roaming Architecture) to enable interception for a call
from a number (or to a number) when the subscriber being intercepted is not
served by the mentioned network. The network serves a subscriber or a roamer-
in (which possibly is not a target) that is involved in a call to (or from)
the Non-Local Identity target. The LI solution for S8HR for VoLTE needs to
have the capacity to implement Non-Local Identity Interception.
Performing interception for Non-Local Identity may not be an issue when the CC
Interception Triggering function is implemented in a node element that
analyses all SIP messages (CSCF functions).
In the context of S8HR Architecture for VoLTE, for any LI solutions relying on
the CC Interception Trigger function which is not SIP aware, a specific
solution needs to be defined to allow Non-Local Identity Interception.
NOTE: A number is IM Public User Identity (IMPU) or any equivalent routable
identity based on E.164 such as Tel URI or SIP URI.
### 5.11.2 Architectural requirements
No S8HR specific architectural requirements have been identified.
### 5.11.3 Stage 3 requirements
No S8HR specific stage 3 requirements have been identified.
## 5.12 Key issue #12 -- Non-3GPP codec or 3GPP codec in a non-3GPP mode in CC
### 5.12.1 Description
A VoLTE UE can use different types of codecs that can include non-3GPP codecs.
LEAs will have to be prepared in advance to handle in real time codecs used by
a roamer in S8HR as those used by direct customers of the VPLMNs.
a. S8HR roaming will introduce three situations where a user could use in a
visited country a codec (or a codec mode) that could be non-3GPP standard
codec or in a non-3GPP standardized mode of a 3GPP standard codec. These
scenarios are already possible for users of a PLMN in the visited country.
LEMF should be able to decode CC using these codecs as S8HR introduces a
situation where LEAs of the visited country already has to be prepared to
process in real time the intercepted CC as it is the same case than any
national usage;
b. Not already used by VPLMN users in a visited country, HPLMN should provide
directly to the VPLMN specifications in order to let the VPLMN provide
assistance to the LEAs and let the LEMF process any intercepted call in real
time. If no specifications have been provided by the HPLMN, national
regulation may impose VPLMN to terminate any call attempts that haven\'t been
specified in the S8HR roaming agreement;
c. Not already used by VPLMN users in a visited country, but national
regulations impose specific delivery of intercepted calls only based on
national standard or 3GPP specifications, HPLMN should provide directly to the
VPLMN specifications in order to enable transcoding of any intercepted calls
in order to respect national delivery requirements. If no specifications have
been provided by the HPLMN, national regulation may require the VPLMN to
terminate any call attempts that haven\'t been specified in the S8HR roaming
agreement.
### 5.12.2 Architecture requirements
No S8HR specific architectural requirements have been identified.
## 5.13 Key issue #13 -- Start of interception with ongoing VoLTE call
### 5.13.1 Description
There may be a requirement for the Operator to allow start of interception for
an already established VoLTE call in case the warrant is activated while the
target has an ongoing VoLTE call.
### 5.13.2 Architectural requirements
Some information from IMS signaling shall be stored in the VPLMN for possible
later use in case a VoLTE inbound roamer becomes a target during an ongoing
call.
### 5.13.3 Stage 3 requirements
No stage 3 requirements
## 5.14 Key issue #14 -- Correlation of CC with IRI
### 5.14.1 Description
A VoLTE inbound roamer may be involved in multiple IMS sessions at the same
time (e.g. hold). The IRI messages extracted from the IMS Signalling Bearer
packets may be associated with any of those IMS sessions. The RTP media
packets extracted from the Media Bearer may be associated with any of those
IMS sessions. The CC of one IMS session will have to be correlated with the
IRI of the same IMS session. The Figure 5.14.1.1 below illustrates the case:
Figure 5.14.1.1: VoLTE UE with two IMS sessions
In Figure 5.14.1.1, a VoLTE UE of an inbound roamer is involved in two IMS
sessions referred to as IMS Session 1 and IMS Session 2. The IMS signalling
packets for both of those IMS sessions flow through the IMS Signalling Bearer.
The Media packets of both of those IMS sessions flow through the Media Bearer.
For a particular service (e.g., voice), it is assumed that the media
characteristics are the same (e.g. QCI = 1) and hence, the Media packets flow
through the same Media Bearer (as shown).
### 5.14.2 Architectural requirements
1\. It shall be possible to determine the IMS session to which the SIP
messages extracted from the IMS signalling packets corresponds to.
2\. In the same way, it shall be possible to determine the IMS session to
which the media packets extracted from the media bearer correspond to.
3\. It shall be possible to correlate the CC of an IMS session with the IRI of
the same IMS session.
4\. It shall be possible to deliver the IRI and CC using the HI2 and HI3
defined in TS 33.108 [4].
### 5.14.3 Stage 3 requirements
TS 33.108 [4] defines IMS_VoIP_Correlation to support the correlation of IRI
and CC. The S8HR VoLTE IRI messages and VoLTE CC shall be correlated using the
IMS_VoIP_Correlation.
### 5.14.4 Solution approaches
When the target is involved in multiple IMS sessions, the solution should have
a logic that is able to associate the SIP messages with the particular
session. For example, each IMS session can be identified using the Call
Identity header present within the SIP messages. The SIP messages that have
the same Call Identity value will be treated as the SIP messages of a
particular IMS session and hence, will have the same Correlation value.
When an IMS session is established, the media information is exchanged between
the two end points of the media stream (e.g. Target\'s UE and IMS-AGW in
HPLMN) through the SDP offer and answer process. The media packets (i.e., RTP
streams) exchanged between the two end points of the media stream will also
have the same media information.
One method that can be used to establish the correlation between the IRI
messages of an IMS session and the CC associated with that IMS session can be
to compare the media information exchanged in the SDP offer and answer and the
media information present in the media packets. Once the correlation is
determined, the IRI messages and the CC can be made to use the same
Correlation Number.
The GTP-U tunnels (used for IMS Signalling Bearer and Media Bearer) are
expected to use the same IP address and port numbers but have two different
tunnel identifiers. For the S-GW, the information above the GTP layer is just
a pay-load. No processing is done on that information within the S-GW.
Therefore, the solution that has to associate the media packets with the IMS
session should have access to all information to that payload (i.e. above the
GTP-U layer) of both IMS Signalling Bearer and Media Bearer.
## 5.15 Key issue #15 -- Signalling Compression
### 5.15.1 Description
As defined in TS 24.229 [2], clause 8.1, certain IMS services may require the
UE and the P-CSCF to employ compression of SIP messages. TS 24.229 [2],
however, states that for E-UTRAN such a compression may not be required.
Therefore, it is assumed that VoLTE S8HR roaming use-cases do not use the
compression for SIP messages.
However, there is nothing to prevent an E-UTRAN UE initiating compression and
if it does, the P-CSCF will support compression/decompression. Therefore, if
the UE initiates compression, then the VPLMN will need to have the capability
to detect the presence of compression and decompress the messages.
### 5.15.2 Architectural requirements
VPLMN may need to be able to detect when compression is applied to the SIP
messages as described in RFC 3320 [14], RFC 4896 [15] and have the dictionary
so as to decompress the messages.
### 5.15.3 Stage 3 requirements
None.
# 6 Solutions
## 6.1 Solution #1 S-GW/BBIFF based GTP tunnel extraction
### 6.1.1 Description
This solution can be viewed as a combination of two concepts: a LI \"tap\" and
a UNI based IMS/SIP service state machine.
The \"tap\" is a function which passively sits on interfaces, passively
observes all the traffic travelling across the interface and extracts specific
traffic based on specific criteria. It then sends a copy of this extracted
traffic on for further analysis. In the case of this solution, the extraction
will be specific IMS bearers associated with the targeted user\'s VoLTE
bearers. This tap function can either be a standalone network element, or
built into network elements performing other functions (such as S-GW).
The UNI based IMS/SIP service state machine with minimal state will interpret
the extracted UNI signalling traffic to construct its own state machines.
Changes in the UNI state machine will be driven by signalling exchanges
extracted from the bearers. The mirror state machine transitions associated
with LI reportable events will then be reported to the authorized LEA as
existing LI messages.
### 6.1.2 S-GW/BBIFF based GTP tunnel extraction architecture reference model
#### 6.1.2.1 S-GW/BBIFF based GTP tunnel extraction architecture diagram
Figure 6.1.2.1.1: S8HR with S-GW/BBIFF target GTP tunnel extraction
#### 6.1.2.2 Reference points
**Xia:** Reference point between S-GW/BBIFF and LMISF for the delivery of IMS
signalling (Gm extracted from S8 GTP tunnel) messages extracted from IMS
signalling GTP tunnels (S8) for roaming users where S8HR is utilized.
**Xib:** Provides the transfer of GTP tunnel LI extraction rules from the LPCF
to the SG-W/BBIFF. Provides indications from SG-W/BBIFF of GTP tunnel setup or
disconnect meeting LI extraction rules.
**Xic:** Reference point for informing the LPCF by the LMISF of activation and
deactivation of LI for targets operating through S8HR.
**Xid:** Reference point for LMISF-LMISF handover for S-GW/BBIFF relocation.
#### 6.1.2.3 Network elements
##### 6.1.2.3.1 LMISF
LMISF functions include:
\- Receive and process IMS signalling (Gm extracted from the S8 GTP tunnel)
over the Xia reference point
\- Tracking all IMS registrations, re-registrations and de-registrations of
all roaming users operating through S8HR
\- Establish and maintain mapping between LEA requested target identity and
the GTP tunnel identities available in the S-GW/BBIFF.
\- Provide IMS capabilities (IRI) equivalent to those defined in TS 33.107 [3]
and TS 33.108 [4]
\- Inform the LPCF of activation and deactivation of LI on targets roaming
through S8HR.
\- Generation of Communications records for the purpose of Data Retention.
##### 6.1.2.3.2 LPCF
LPCF functions include:
\- Receive from the LMISF indications of activation and deactivation of LI on
targets roaming through S8HR.
\- Directing the S-GW/BBIFF to start or stop extracting and delivering IMS
media in identified GTP tunnels to the DF3 by managing the TFT activation and
deactivation in the S-GW/BBIFF supporting LMISF and active LI.
##### 6.1.2.3.3 S-GW/BBIFF
S-GW/BBIFF functions include:
\- Informing the LMISF of applicable bearer creation, modification and
deletions.
\- Executing the policy rules (TFT) established by the LPCF against S8HR
traffic.
\- Deliver IMS signalling (Gm extracted from the S8 GTP tunnel) over the Xia
reference point.
\- Deliver IMS media (content) extracted from the S8 GTP tunnel over X3 to
DF3.
### 6.1.3 Process Flow for Architectural Approach of Solution #1
The Figure 6.1.3.1 shows the steps to illustrate the process flow as per
solution #1 architecture.
Figure 6.1.3.1: Process Flow of S8HR LI Architecture Approach of baseline
1\. LMISF is provisioned with target information (for Voice Services, it can
be SIP URI, TEL URI or IMEI) from the ADMF.
2\. LPCF instructs the S-GW/BBIFF to notify whenever the IMS Signalling Bearer
for S8HR APN is created (based on GTP-C event), modified, or deleted, and
delivers the packets of all IMS Signalling Bearers established for S8HR APNs
to the LMISF. Here, the LPCF may supply the S8HR APNs to the S-GW/BBIFF.
NOTE 1: This step is independent of target specific LI service operation such
as Step 1.
NOTE 2: When the S-GW/BBIFF notifies the LMISF when an IMS Signalling Bearer
for S8HR APN is created, modified or deleted, it includes the IMSI value
associated with the inbound roamer\'s UE.
3\. S-GW/BBIFF delivers the packets of those IMS Signalling Bearers to the
LMISF. As such, S-GW/BBIFF has no idea whether the packets of an IMS
Signalling Bearer are related to target or not. It simply delivers all
packets.
NOTE 3: This step is independent of target specific LI service operation such
as Step 1.
4\. The LMISF looks for the SIP message within those packets and examines the
SIP headers that carry the calling party identity and called party identity to
verify whether any of those match with the target Identity stored locally. If
the SIP message corresponds to a target, then LMISF delivers the SIP message
to the DF2.
5\. The DF2 will generate and deliver the IRI to the LEMF as per TS 33.108
[4].
6\. The LMISF then informs the LPCF about the identity of the IMS Signalling
Bearer that is being intercepted.
7\. LPCF instructs the S-GW/BBIFF to deliver the packets of the Media Bearer
linked to that IMS Signalling Bearer to DF3.
8\. S-GW/BBIFF delivers the Media packets to the DF3. The S-GW/BBIFF knows the
Media packets which are related to an IMS Signalling Bearer, but does not know
which Media packet is related to which IMS session in the event target is
involved in multiple sessions.
9\. DF3 generates and delivers the CC as per TS 33.108 [4] to the LEMF.
The Figure 6.1.3.2 below illustrates the above steps in a flow diagram format.
.
Figure 6.1.3.2: Flow diagram illustrating the process steps (architectural
approach of solution #1)
In order to correlate the CC with IRI, LMISF may have to supply the
Correlation Number to the S-GW/BBIFF (through the LPCF) and S-GW/BBIFF
includes that Correlation Number while delivering the media packets to the
DF3. When a target is involved in multiple IMS sessions, this approach may be
used if the LI requirement is to use the same Correlation Number for all IMS
sessions and the associated media packets. Otherwise, either the S-GW/BBIFF
will have to analyse the media packets or the enhanced architecture (solution
#2) as shown in clause 6.2 will have to be used to have a correct correlation
of CC with the IRI. If the former approach is used, then LMISF may have to
send the media information to the S-GW/BBIFF (via LPCF) and this may involve
sending of multiple events.
The figure 6.1.3.3 shows the steps when an intercept is deactivated during a
VoIP session.
Figure 6.1.3.3: Flow diagram illustrating the process steps during intercept
stop procedures during a VoIP call.
### 6.1.4 Call Flow for architectural approach of Solution #1
Figure 6.1.4.1 provides a call flow to illustrate LI functions in the VPLMN
and HPLMN. The call flow indicates the interception of SIP signalling messages
and media at the beginning of a call origination from the target UE when S8HR
based approach is used as the VoLTE roaming architecture.
In the illustration shown below, it is assumed that both VPLMN and HPLMN have
separate independent lawful interception authorization.
Figure 6.1.4.1: Call flow in VPLMN (S8HR) and HPLMN for Solution #1
In HPLMN, the S-CSCF (optionally, the P-CSCF) after inspecting and determining
that the IMS session involves a target, delivers IRI messages via DF2 to the
LEMF with the Correlation Number C1. The P-CSCF sends the CC Intercept Trigger
that contains the Correlation Number C1 to the P-GW during the call
establishment. The P-GW delivers the CC via DF3 to the LEMF using the
Correlation Number C1.
In the VPLMN, the LMISF, after inspecting and determining that the IMS
Signalling packets involve target, delivers IRI messages via DF2 to the LEMF
with the Correlation Number D1. LMISF informs the LPCF that the particular IMS
Signalling Bearer is intercepted along with the Correlation Number D1. The
S-GW/BBIFF delivers the CC to the DF3 along with the Correlation Number D1.
DF2 delivers the IRI to LEMF and DF3 delivers the CC to the LEMF.
NOTE 1: LMISF will have to supply the media information to the S-GW/BBIFF (via
LPCF) and to supply the media information, multiple notifications from LMISF
to S-GW/BBIFF (via LPCF) may be required (since the necessary media
information may not be available in one SIP messages).
NOTE 2: When LBO approach is used as the roaming architecture, the
interception in the VPLMN is performed similar to the way the interception is
done at the HPLMN with P-CSCF (instead of S-CSCF) after inspecting and
determining that the IMS session involves a target, would deliver the IRI
messages to the LEMF via DF2.
### 6.1.5 Solution approach to key issues
#### 6.1.5.1 Approach to key issue #1 -- IMEI targeted LI
##### 6.1.5.1.1 General
Using solution #1, two different options are possible:
\- detection of target IMEI in the LMISF and
\- detection of target IMEI in the S-GW/BBIFF.
##### 6.1.5.1.2 Option 1: Detection of Target IMEI communication in LMISF
The following summarizes the key steps of this approach:
1\. The S-GW/BBIFF provides LMISF with bearers carrying IMS signalling over
Xia reference point for all inbound roamers where S8HR is deployed.
NOTE: S-GW/BBIFF also notifies the LMISF whenever an IMS Signalling Bearer for
S8HR APN is created, modified or deleted. This will allow the LMISF to know
the IMSI value associated with the inbound roamer\'s UE
2\. The LMISF maintains any changes in IMEI to private user identity or public
user identity associations signalled in the retrieved IMS signalling bearers.
3\. LMISF receives over X1_1 interface the request to activate interception
based on an IMEI.
4\. LMISF retrieves the IMEI from the associations established in step 1.
5\. If there are no associations matching the targeted IMEI, the LMISF will
arm a trigger on IMEI association changes that match the targeted IMEI.
6\. If and when an association matching the IMEI is found or triggered, then
LI on the associated identity (e.g. public user identity) is activated.
7\. Any further changes in the targeted IMEI association such as
disassociation will trigger a corresponding change to any LI on the associated
identity from step 6.
8\. Any detected and retrieved communication matching the associated identity
from step 6 on a VoLTE call, the LMISF provides the corresponding SIP messages
for the VoLTE call being intercepted to the DF2 over X2 interface.
9\. In addition, the LMISF provides the identity association information over
Xic interface to the LPCF. This can include the case where an additional
bearer for content may be established and require LI reporting.
10\. The LPCF then indicates to the S-GW/BBIFF to start interception of media
(content) for the call. The S-GW/BBIFF extracts the media stream packets for
the given bearer and provides it to the DF3 over X3 interface.
11\. If LMISF receives the request to stop interception for a target IMEI over
X1_1, the LMISF:
a. stops reporting IRI for the target to DF2 over the X2 reference point, and
b provides the information over Xic interface to the LPCF to stop intercepting
media (content) for the target.
12\. The LPCF then indicates to the S-GW/BBIFF to stop interception of media
(content) for the call. The S-GW/BBIFF stops extracting the media for the
given bearer.
13\. The LMISF needs to be able to provide the status of CC interception in
response to an interrogation query from the ADMF via an X1_1 interface.
##### 6.1.5.1.3 Option 2: Detection of IMEI at S-GW/BBIFF
Xib is used by the S-GW/BBIFF to inform the LPCF of the presence of a target
(e.g. establishment of IMS bearer(s)). The LPCF then configures the S-GW/BBIFF
to deliver traffic to DF3. This option assumes that the VPLMN retrieves the
IMEI during the LTE (re-)attach procedure such as for EIR based fraud
detection and prevention.
The following summarizes the key steps of this approach:
1\. LMISF receives over the X1_1 interface the request to activate
interception for a target IMEI.
2\. The LMISF provides the target IMEI to the LPCF over the Xic interface
without any association identity as required for option 1.
3\. The LPCF then indicates the IMEI to the S-GW/BBIFF to start interception
of any bearers associated with the IMEI that are used for IMS (signalling
and/or content) along with directions for where to deliver each bearer.
4\. The S-GW/BBIFF then delivers (under LPCF direction) the signalling bearers
to the LMISF for service processing and for delivery to DF2 over the X2
interface and the media bearers to the DF3 over the X3 interface.
NOTE: Correlation between IRI and CC is not specifically addressed. However,
the LEMF or a combined DF2/3 supporting both the LMISF and S-GW would have
sufficient information based on IP Addresses, Timestamps and User Identities
to perform correlation.
#### 6.1.5.2 Approach to key issue #2 -- Tel-URI or SIP-URI targeted LI
Since use of TEL-URI or SIP-URI is the essential element of SIP identifying
the calling and called parties, the methods used for identifying, retrieving,
and reporting any communication associated with a targeted E.164 number can
reuse the methods used for the LI service in the HPLMN as well as the LI
service where LBO roaming is deployed in the VPLMN.
The following summarizes the key steps of solution #1\'s approach:
1\. The S-GW/BBIFF provides the LMISF with all S8HR bearers carrying IMS
signalling over the Xia reference point.
NOTE: S-GW/BBIFF also notifies the LMISF whenever an IMS Signalling Bearer for
S8HR APN is created, modified or deleted. This will allow the LMISF to know
the IMSI value associated with the inbound roamer\'s UE
2\. The LMISF receives over X1_1 interface the request to activate
interception for a target Tel-URI/SIP-URI.
3\. When a call is established involving the target, the LMISF retrieves the
Tel-URI/SIP-URI used for the VoLTE call from the IMS signalling retrieved from
the signalling bearers received over Xia reference point.
4\. In case of matching between the Tel-URI/SIP-URI provided as target and the
Tel-URI/SIP-URI retrieved for the VoLTE call, the LMISF provides the SIP
messages for the VoLTE call being intercepted to the DF2 over X2 reference
point.
5\. In the case of CC interception, the LMISF triggers the LPCF, via Xic to
initiate cc delivery via X3 to the DF3.
6\. If CC is to be provided as part of the LI service, the LPCF then indicates
to the S-GW/BBIFF to start interception of media (content) for the call. The
S-GW/BBIFF extracts the media stream packets for the given bearer and provides
it to the DF3 over X3 reference point.
7\. If LMISF receives a request to stop interception for a target Tel-URI/SIP-
URI, the LMISF stops reporting IRI for VoLTE calls for that target to DF2 over
the X2 reference point and provides the information over the Xic reference
point to the LPCF to stop delivering extracted CC to DF3 over the X3 reference
point for the target.
8\. The LPCF then indicates to the S-GW/BBIFF to stop delivering all the media
(content) for the target. The S-GW/BBIFF stops extracting the media for all
the given bearers associated with the target.
#### 6.1.5.3 Approach to key issue #3 -- LI targeted S8 GTP selection criteria
For any particular inbound roamer where S8HR is deployed, the S8HR VoLTE
bearers are always established to a dedicated IMS APN only used for VoLTE
traffic. For roaming purposes, the form of the FQDN of the APN is
standardized. Further distinction of the VoLTE signalling bearers\' GTP
tunnels and voice traffic GTP bearers can be distinguished by their QCI
values, which are detailed in TR 23.749 [5].
The LMISF shall receive all S8HR IMS signalling extracted from signalling
bearer GTP-U tunnels for all inbound roamers where S8HR is deployed. In
addition, the LMISF shall maintain and track all IMS registrations, de-
registrations and re-registrations. Furthermore, the LMISF shall be informed
of all IMS GTP-U tunnel tear downs, and shall keep a mapping of IMS identities
to GTP-U tunnel ID. The LMISF shall trigger LI on applicable IMS Sessions when
LI is activated for a target based on an IMS identity.
The following summarizes the key steps of solution #1\'s approach:
1\. The S-GW/BBIFF checks every GTP-C session management message to see if any
P-GW FQDN matches HPLMNs where S8HR is deployed and the APN is an IMS
standardized APN.
2\. If there is a match, then the S-GW/BBIFF checks the Bearer Level QOS to
distinguish the IMS signalling bearers from the IMS media (content) bearers.
3\. For VoLTE (IMS) signalling bearers, the following steps occur:
a. The S-GW/BBIFF sends an indication to the LMISF over the Xia reference
point that an IMS signalling bearer (GTP session) has been created, modified
or deleted along with both the bearer identity (e.g. TEID) as well as the
associated IMSI.
b. The LIMSF handles the IMS signalling delivered from the S-GW/BBIFF over Xia
as follows:
i. If there is no active LI service targeting the user, then the LMISF retains
SIP registration (registrar function) state changes. The stored registrations
will include any observed identity associations between IMS public user
identities, private user identities, IMSIs and IMEIs that are available either
in related SIP signalling or related EPC signalling in the VPLMN.
ii. If there is an active LI service targeting the user based on the stored
identity associations from step 3di, then the LIMSF reports on the IMS/SIP
events to the DF2 over the X2 reference point as occurs at present in the LI
service.
iii. When CC interception is required, notifies the LPCF about the bearer
identity of the IMS Signalling Bearer so as to instruct the S-GW/BBIFF to
deliver the media packets of the GTP bearer linked to the IMS Signalling
Bearer.
4\. For VoLTE (IMS) media/content bearers, the following steps occur:
a. As described in step 3biii, when the LMISF detects that SIP messages belong
to a target and content is to be delivered to the LEA, then the LMISF will
send a notification to the LPCF via the Xic reference point with the bearer
identity of the IMS signalling bearer.
b. The LPCF sends to the S-GW/BBIFF a TFT rule to activate extraction and
delivery of a copy of the media traffic on the bearers linked to the IMS
Signalling Bearer to the DF3 over X3.
c. The S-GW/BBIFF starts the delivery of RTP media (content) extracted from
the GTP IMS media tunnels to the DF3 via the X3 reference point based on the
TFT rules from step 4b.
NOTE: Solution #1 does not define what needs to be extracted from the media
bearers in DF 3 -- in essence the bearer identities, which may be IP
port/address pairs, the RTP media flow identities within the bearer tunnels,
which may be the inner IP port/address pairs, along with the correlation
identifier to include in the DF3 delivery to LEAs for the usual DF2/DF3
correlation.
#### 6.1.5.4 Approach to key issue #4 - Obtaining network provided location
##### 6.1.5.4.1 Obtaining location
The LMISF has to obtain the target\'s location from other network elements in
the VPLMN for a targeted inbound roaming user. In the following clauses,
example flows are highlighted showing the application to the S8HR LI service
network elements.
##### 6.1.5.4.2 MME provided location
The following summarizes the key steps when the source of network provided
location is the MME:
1\. The MME includes user location information in Modify Bearer Request
messages sent to S-GW/BBIFF at least for all inbound roaming users.
2\. The S-GW/BBIFF forwards this information to LMISF via the Xia reference
point.
3\. The LMISF retains the updated user location information for all registered
inbound roaming users where S8HR is deployed.
4\. The LMISF retrieves the stored location information and delivers it to the
DF2 via the X2 reference point with the appropriate call state event report.
##### 6.1.5.4.3 LCS provided location
In this approach the target\'s location is obtained by means of the Lawful
Access Location Services (LALS) currently under development in 3GPP Release
13/14 (see TS 33.107 [3], clause 19).
#### 6.1.5.5 Approach to key issue #5 - Intra-access handover or anchor change
impact
##### 6.1.5.5.1 General
When S-GW relocation occurs, the information about the IMS signalling
interception points may have to be transferred from the old S-GW to the new
S-GW.
a. Scenario 1: Multiple LMISFs
In case of S-GW relocation, the LMISF may change as well. If the IMS session
is started let\'s say under SGW1, the LMISF1, based on the analysis of the IMS
bearer is able to recover SIP signalling and may start sending intercepted SIP
messages over X2. If at time t1, the target moves to S-GW2, LMISF2 will start
receiving the bearer from the S-GW2 but at that point in time LMISF2 needs to
recover IMS related information, which LMISF2 didn\'t receive when the VoLTE
call was started.
\- A new interface/reference point is needed between LMISFs to allow the
transfer of IMS information retrieved from LMISF1 to LMISF2 in case a S-GW
relocation occurs.
\- The S-GW relocation procedure, controlled by the MME shall be enhanced. In
case an S-GW relocation occurs, the MME, which is in charge to control the
whole S-GW relocation, will provide the S-GW2 with LMISF1 address, so allowing
LMISF2 to contact LMISF1 over the new interface and retrieve the needed
information.
\- The MME shall store the LMISF address as part of the UE context. This will
also solve issues related to possible MME relocation indicated in clause
5.5.1.
NOTE 1: SA2 S-GW relocation and MME change procedures may require enhancements
to support these requirements.
b. Scenario 2: Centralized LMISF
In case of S-GW relocation, the LMISF will not change. The new S-GW shall
interface the same LMISF by using the Xia interface.
NOTE 2: Which scenario is applicable is a network implementation option.
##### 6.1.5.5.2 Scenario 1: Multiple LMISFs
1\. When the UE connects to the EPC network, the MME shall store the LMISF
address, provided by the S-GW, as part of the UE context.
2\. The LMISF1 and LMISF2 addresses shall be provided in the GTPv2 signalling
used during S-GW relocation or MME change as follows:
a. The LMISF1 addresses shall be provided to the new S-GW (S-GW2) in the GTPv2
Create Session Request signalling.
b. The S-GW2 shall provide the LMISF1 address to the LMISF2.
3\. LMISF2 shall retrieve the IMS information over a new inter-LMISF interface
and inform S-GW2\'s LPCF of the required policies.
4\. S-GW2 then continues with bearer modification procedure towards PDN-GW.
This will allow LI functionality to not miss any traffic.
5\. S-GW2 includes LMISF2 address in Create Session Response.
##### 6.1.5.5.3 Scenario 2: Centralized LMISF
1\. After the S-GW relocation, the new S-GW will start sending IMS related
bearers to the LMISF.
#### 6.1.5.6 Approach to key issue #6 - Detecting targeted signalling unknown
or unrecognized by the VPLMN
The following summarizes the key steps of this approach:
1\. The LMISF provides the VPLMN operator policy function for detecting
unknown or unrecognized IMS/SIP protocol aspects not otherwise given IMS/SIP
error treatment for any policy action which alter, log or terminate the voice
service by the VPLMN.
2\. The LMISF initiates the action specified by operator policy when an
unknown or unrecognized IMS/SIP protocol aspect is detected and not otherwise
given an IMS/SIP error treatment. This can include but not limited to OAM&P
element interaction for offline actions, and/or initiate PCC controls to
terminate any IMS sessions for the user.
3\. For any operator policy of reporting unknown or unrecognized IMS/SIP
protocol aspects to the LEA, the DF2 is responsible for this reporting.
#### 6.1.5.7 Approach to key issue #7 -- Maintaining intra-PLMN and inter-PLMN
LI undetectability
Maintenance of intra-PLMN and inter-PLMN LI undetectability is inherent to the
chosen architectural solution approach based on the following key points:
\- The LI solution is not dependent on the signalling information only
available at the other PLMN.
\- The LI solution is not dependent on the LI solution implemented in other
PLMNs.
\- The LI solution does not modify the operation and performance of services
offered in the HPLMN, VPLMN or other PLMNs (e.g. in the PLMN that handles the
far end party of the call).
\- The LI solution does not alter the packets sent to, or received from the
call participants.
\- The LI information can be made to be restricted to the authorized
personnel.
In other words, the LI solution studied for S8HR adheres to the security
requirements specified in TS 33.107 [3].
#### 6.1.5.8 Approach to key issue #8 --Detecting implicit IMS registrations
All public identities registered for a UE will be available at the LMISF.
According to 24.229 [2], sub-clause 5.4.1.2.2.F, the registered distinct
public user identity and its associated set of implicitly registered public
user identities is sent to UE from S-CSCF in the \"200 (OK)\" message. Thus,
this information is available in the LMISF.
The LMISF tracks both IMS registration requests as well as the registration
responses, in order to be able to make sure all implicitly registered IMS user
identities are tracked.
#### 6.1.5.9 Approach to key issue #9 -- Retained Data
All SIP signalling shall be available at the LMISF.
All SIP signalling are stored, and hence, have all relevant data and can
produce the retained data records.
#### 6.1.5.10 Approach to key Issue # 10 - Prevention of unwanted use of
confidentiality mechanisms
LMISF receives a copy of all traffic the IMS signalling bearers belonging to
all inbound roamers. Security of IMS signalling relies on IPsec, with an IKE
key exchange, which is performed over the IMS signalling bearer. Since the
LMISF will need to extract all of the IMS signalling bearer for the entire
duration it is established, the algorithm negotiation is available to the
LMISF, thus the LMISF can detect whether an algorithm with confidentiality
protection has been selected. LMISF informs LPCF, which then acts according to
VPLMN policy, which is enforced by S-GW/BBIFF. Possible VPLMN policies may be
termination of offending SDF or reporting of the policy violation to
authorities or OAM.
If the LMISF detects non-SIP traffic on the signalling bearer, this may be due
to non-standard SIP signalling traffic or the IMS signalling bearer being used
for non-standard traffic. As this may be considered a billing problem in the
VPLMN, there may already be PCRF rules to prevent this kind of traffic. Thus,
it is a configuration option in the VPLMN whether the LMISF informs the LPCF,
which then acts according to VPLMN policy, which is enforced by S-GW/BBIFF.
Possible VPLMN policies may be termination of offending SDF or reporting of
the policy violation to authorities or OAM.
LMISF is also aware of SIP IEs used for setting up media plane security, i.e.
a crypto information element in the SDP offer, cf. TS33.328 [8]. If the LMISF
detects such IEs proposing confidentiality protection be established, LMISF
informs LPCF, which then acts according to VPLMN policy, which is enforced by
S-GW/BBIFF. Possible VPLMN policies may be termination of offending SDF or
reporting of the policy violation to authorities or OAM.
#### 6.1.5.11 Approach to key Issue # 11 -- Non-Local Identity
The LMISF when evaluating a SIP message for target identity is able to
identify the target based on a Non-Local Identity using the capabilities
similar to those capabilities of other LI nodes defined in TS 33.107 [3].
#### 6.1.5.12 Approach to key issue #12 -- Non-3GPP codec or 3GPP codec in a
non-3GPP mode in CC
The following summarizes the key steps of this approach:
1\. The LMISF provides the operator policy function for non-3GPP codec or 3GPP
codec in a non-3GPP mode in CC.
2\. The LMISF initiates the action specified by operator policy when a
non-3GPP codec or 3GPP codec in a non-3GPP mode is detected in the SIP session
establishment codec negotiation (SDP). The operator policy actions can include
but not limited to OAM&P element interaction for offline actions, reporting
the elements to the LEA and/or initiate PCC controls to terminate any IMS
sessions for the user.
#### 6.1.5.13 Approach to key issue #13 -- Start of interception with ongoing
VoLTE call
The LMISF shall store some IMS information retrieved at setup and during the
session, as the P-CSCF is required to do in case of LBO, as specified in 3GPP
TS 33.107 (clause 7A.3.1) [3], hence the LMISF needs to get the GTP-U related
to the S8HR IMS signalling bearer for all VoLTE inbound roamers even if they
are not target of interception. In case LI is activated for an inbound roamer
over X1_1 interface (thus becoming a target), the LMISF shall check to see
whether any VoLTE call is active on that target; in such case, LI shall start
for the ongoing VoLTE call.
Information to be stored by the LMISF and events to be reported over X2
interface are the same as for a CSCF, as specified in 3GPP TS 33.107 (clause
7A.3.1) [3].
#### 6.1.5.14 Approach to key issue #14 - Correlation of CC with IRI
This is handled in Solution #2 with Enhanced Architecture in clause 6.2.6.1.
#### 6.1.5.15 Approach to key issue #15 - Signalling Compression
The S-GW/BBIFF delivers all the packets from the IMS Signalling Bearer
associated with the S8HR APN (i.e. for inbound roamers) to the LMISF
independent of any compression.
If LMISF detects compression (as defined in RFC 3320 [14] and RFC 4896 [15])
of the IMS signalling traffic, then it decompresses the SIP messages (as
defined in clause 8 of TS 24.229 [2]) and follows the steps used to process
the uncompressed SIP messages.
### 6.1.6 Impacts on existing nodes and interfaces
The following impact is foreseen for solution #1:
S-GW will need to implement BBIFF (so to implement Xia and Xib interfaces). As
with all implemented functionality, the performance impact of this is an
implementation and deployment issue.
If S-GW relocation is supported for inbound roamers, then S10 and S11 are
affected. Therefore, S-GW and MME will have to implement an extension that
allows transport of LMISF address and tunnel endpoint ID. This is not required
if the LMISF address is implicitly known (e.g. only one LMISF is deployed).
Bearer teardown due to encryption or use of unsupported codecs may have an
impact on S-GW, as this capability needs to be implemented, if PCC is not
present already.
## 6.2 Solution #2 - Enhanced Architecture
### 6.2.1 Enhanced Architecture Reference Model
Figure 6.2.1.1: S8HR with S-GW/BBIFF target GTP tunnel extraction (enhanced
model)
### 6.2.2 Reference points
**Xia:** Reference point between S-GW/BBIFF and LMISF for the delivery of IMS
signalling (Gm extracted from S8 GTP tunnel) messages extracted from IMS
signalling GTP tunnels (S8) for roaming users where S8HR is utilized. Also for
delivery of the media packets associated with the IMS signalling GTP tunnels
that are intercepted.
**Xib:** Provides the transfer of GTP tunnel LI extraction rules from the LPCF
to the S-GW/BBIFF. Provides indications from S-GW/BBIFF of GTP tunnel setup or
disconnect meeting LI extraction rules.
**Xic:** Reference point for informing the LPCF by the LMISF of activation and
deactivation of LI for targets operating through S8HR.
**Xid:** Reference point for LMISF-LMISF handover for S-GW/BBIFF relocation.
### 6.2.3 Network elements
#### 6.2.3.1 LMISF
LMISF functions include:
\- Receive and process IMS signalling (Gm extracted from the S8 GTP tunnel)
over the Xia reference point. Also, receive and process the media packets
(from the S8 GTP tunnel associated with the intercepted S8 GTP tunnel of IMS
signalling).
\- Tracking all IMS registrations, re-registrations and de-registrations of
all roaming users operating through S8HR
\- Establish and maintain mapping between LEA requested target identity and
the GTP tunnel identities available in the S-GW/BBIFF.
\- Provide IMS capabilities (IRI) equivalent to those defined in TS 33.107 [3]
and TS 33.108 [4]
\- Provide the CC delivery equivalent to those defined in TS 33.107 [3] and TS
33.108 [4].
\- Inform the LPCF with the tunnel id information of the IMS signalling bearer
that is being intercepted targets roaming through S8HR.
\- Generation of Communications records for the purpose of Data Retention.
#### 6.2.3.2 LPCF
LPCF functions include:
\- Receive from the LMISF indications of IMS signalling bearer tunnel id
information that is being intercepted on targets roaming through S8HR.
\- Directing the S-GW/BBIFF to deliver the IMS media in identified GTP tunnels
to LMISF.
#### 6.2.3.3 S-GW/BBIFF
S-GW/BBIFF functions include:
\- Executing the policy rules established by the LPCF against S8HR traffic.
\- Deliver IMS signalling (Gm extracted from the S8 GTP tunnel) over the Xia
reference point.
\- Deliver IMS media (content) extracted from the S8 GTP tunnel over Xia to
LMISF.
### 6.2.4 Process Flow for Enhanced Architectural Approach
The Figure 6.2.4.1 shows the steps to illustrate the process flow as per
enhanced architectural approach:
Figure 6.2.4.1: Process Flow of S8HR LI enhanced Architecture Approach
1\. LMISF is provisioned with target information (for Voice Services, it can
be SIP URI, TEL URI or IMEI) from the ADMF.
2\. LPCF instructs the S-GW/BBIFF to notify whenever the IMS Signalling Bearer
for S8HR APN is created (based on GTP-C event), modified, or deleted, and
delivers the packets of all IMS Signalling Bearers established for S8HR APNs
(Access Point Names) to the LMISF. Here, the LPCF may supply the S8HR APNs to
the S-GW/BBIFF.
NOTE 1: This step is independent of target specific LI service operation such
as Step 1.
NOTE 2: When the S-GW/BBIFF notifies the LMISF when an IMS Signalling Bearer
for S8HR APN is created, modified or deleted, it includes the IMSI value
associated with the inbound roamer\'s UE. 3. S-GW/BBIFF delivers the packets
of those IMS Signalling Bearers to the LMISF. As such, S-GW/BBIFF has no idea
whether the packets of an IMS Signalling Bearer are related to a target or
not. It simply delivers all packets.
NOTE 3: This step is independent of target specific LI service operation such
as Step 1.
4\. The LMISF looks for the SIP message within those packets delivered by the
S-GW/BBIFF and examines the SIP headers that carry the calling party identity
and called party identity to verify whether any of those match with the
Intercept Subject Identity stored locally. If the SIP message corresponds to a
target, then the LMISF delivers the SIP message to the DF2.
5\. The DF2 will generate and deliver the IRI to the LEMF as per TS 33.108
[4].
6\. The LMISF then informs the LPCF about the identity of the IMS Signalling
Bearer that is being intercepted.
7\. LPCF instructs the S-GW/BBIFF to deliver the packets of the Media Bearers
linked to that IMS Signalling Bearer to LMISF.
8\. S-GW/BBIFF delivers the Media packets to the LMISF. The S-GW/BBIFF knows
the Media packets which are related to an IMS Signalling Bearer, but does not
know which Media packet is related to which IMS session in the event target is
involved in multiple sessions. In this approach, S-GW/BBIFF need not know that
association.
9\. LMISF looks at the Media packets that it receives and examines the IP
address and the port number associated with the RTP stream. Then LMISF will
determine the associated IMS session comparing the IP address/port number of
the RTP stream with the similar information from the IMS session. LMISF
delivers the Media packets to DF3 along with the Correlation Number it has
used while delivering the SIP messages to DF2.
10\. DF3 generates and delivers the CC as per TS 33.108 [4] to the LEMF.
The Figure 6.2.4.2 below illustrates the above steps in a flow diagram format.
Figure 6.2.4.2: Flow diagram illustrating the process steps per enhanced
Architectural Approach
The LMISF will be able to correlate the CC with the IRI since it receives both
media packets and the IMS signalling packets.
The figure 6.2.4.3 shows the steps when an intercept is deactivated during a
VoIP session.
Figure **6**.2.4.3: Flow diagram illustrating the process steps during
intercept stop procedures during a VoIP call
In this flow, since both IMS signalling packets and the media packets are
delivered to the LMISF, the LMISF will stop generation of IRI and CC
immediately after it detects that the interception is deactivated.
### 6.2.5 Call Flow for enhanced architectural approach
Figure 6.2.5.1 provides a call flow to illustrate LI functions in the VPLMN
and HPLMN. The call flow indicates the interception of SIP signalling messages
and media at the beginning of a call origination from the target UE when S8HR
based approach is used as the VoLTE roaming architecture.
In the illustration shown below, it is assumed that both VPLMN and HPLMN have
separate independent lawful interception authorization.
Figure 6.2.5.1: Call flow in VPLMN (S8HR) and HPLMN with enhanced
architectural approach
In HPLMN, the S-CSCF (optionally, the P-CSCF) after inspecting and determining
that the IMS session involves a target, delivers IRI messages via DF2 to the
LEMF with the Correlation Number C1. The P-CSCF sends the CC Intercept Trigger
that contains the Correlation Number C1 to the P-GW during the call
establishment. The P-GW delivers the CC via DF3 to the LEMF using the
Correlation Number C1.
In the VPLMN, the LMISF, after inspecting and determining that the IMS
Signalling packets involve target, delivers IRI messages via DF2 to the LEMF
with the Correlation Number D1. When the Media packets are received from the
S-GW/BBIFF, the LMISF delivers the CC via DF3 to the LEMF with the same
Correlation Number D1.
NOTE: When LBO approach is used as the roaming architecture, the interception
in the VPLMN is performed similar to the way the interception is done at the
HPLMN with P-CSCF (instead of S-CSCF) after inspecting and determining that
the IMS session involves a target, would deliver the IRI messages to the LEMF
via DF2.
### 6.2.6 Solution approach to key issues
#### 6.2.6.1 Approach to key issue #14 - Correlation of CC with IRI
##### 6.2.6.1.1 Description
A target is identified using SIP URI, TEL URI or IMEI. Not all SIP messages
carry these identities. The LMISF will have the logic to determine the
subsequent SIP messages that correspond to the same target. When a target is
involved in multiple IMS sessions, the LMISF will have the logic to associate
and correlate the SIP messages that are related to an IMS session. For
example, the SIP messages that have the same Call Identity value can be
treated as the SIP messages of a particular IMS session and hence, when
reported to the LEMF (via DF2) can have the same Correlation Number.
LMISF will also examine the SIP messages that carry the SDP offer and answer
to determine the media information related to an IMS session.
When an IMS session is established, the media information is exchanged between
the two end points of the media stream (e.g. Target\'s UE and IMS-AGW in
HPLMN) through the SDP offer and answer process. The combination of IP address
of the end point (e.g. UE and IMS AGW) and UDP port numbers used to transport
the RTP and RTCP are part of this SDP offer and answer along with other things
like Codec information. The media packets (i.e. RTP streams) exchanged between
the two end points of the media use those IP addresses and the port numbers
(assigned for RTP).
One method that can be used to establish the correlation is to use the IP
addresses and the UDP port numbers exchanged within the SDP offer and answer
process and compare them with the IP addresses and UDP port numbers of the
media packets to establish an association between the IMS session and the
media.
In other words, the IP address and UDP port numbers associated with a media
packet when compared with the IP address and UDP port numbers exchanged in the
SDP offer and answer, one can determine to which IMS session a media packet
corresponds to. Once that determination is made, these parameters may be used
to establish a correlation.
To avoid the impact of making the S-GW/BBIFF from examining every packet of an
intercepted media bearer, the solution proposed here will make the S-GW/BBIFF
to deliver the media packets also to the LMISF. In other words, S-GW/BBIFF
will always deliver the packets (IMS signalling and the media packets as per
the policy established by the LPCF) to the same destination LMISF.
When S-GW/BBIFF is asked to deliver the packets from the IMS Signalling
Bearers to LMISF, it delivers everything above the GTP-U layer. S-GW/BBIFF
does not look into the IMS packets above the GTP-U layer. Similarly, when the
S-GW/BBIFF is asked to deliver the packets from the Media Bearer to the LMISF,
it delivers everything above the GTP-U layer. It does not look into the Media
packets above the GTP-U layer. However, the BBIFF knows that the Media Bearer
and the IMS Signalling Bearer are related through the GTP protocol concepts
defined in 3GPP TS 29.274 [10].
The LMISF will generate a Correlation Number and include that Correlation
Number while delivering the SIP messages to the DF2. When the media packets
are received, LMISF will examine the Media packets to determine which IMS
session, the Media packets are related to. Once determined, the LMISF will
deliver the Media packets to the DF3 along with the Correlation Number
previously stored against the IMS session.
##### 6.2.6.1.2 Impacts on existing nodes, interfaces and functionality
The solution identified here does not introduce any new impacts to the network
nodes within the VPLMN. The overall architecture (shown in clause 4) will have
to be modified as shown in Figure 6.2.6.1.2.1 below:
Figure 6.2.6.1.2.1: Architectural Change required to support correlation of
IRI and CC
##### 6.2.6.1.3 Solution evaluation
Based on the above modified architectural change, the S-GW/BBIFF will always
deliver the packets (IMS signalling and media packets as per the policy
established by the LPCF) to the same destination LMISF. The LMISF will examine
each media packets as well to determine the IMS session to which the media
packets correspond to. The LMISF that way will deliver the IRI to DF2 and CC
to DF3.
In addition, solving the problem of Correlation issue, this modified
architecture has the following additional advantages:
1\. S-GW/BBIFF delivers the packets from both IMS Signalling Bearer and Media
Bearer to same destination (i.e. LMISF) in contrast to the approach where the
packets from the IMS Signalling Bearer are delivered to LMISF and packets from
the Media Bearer are delivered to DF3. Delivering to one destination instead
of two can be viewed as a simplification to the concept.
2\. With the proposed solution, the LMISF will have the X2 and X3 interfaces
to DF2 and DF3 respectively. One can make sure that LMISF (being new
functional entity) takes the burden of ensuring that the information delivered
over X2 and X3 are in the same format as used for other VoIP scenarios (e.g.
non-roaming, LBO case). This will ensure that the DF2 and DF3 used for other
VoIP call scenarios can be re-used with S8HR as well.
3\. Unlike the HI2 interface requirements defined in the TS 33.108 [4], the US
LI regulations require to map the SIP messages to call state events such as
\"Origination\", \"TerminationAttempt\", \"Answer\", \"Release\" etc.. While
in most of the LI implementations, the DF2 provides the required mapping,
there are certain IRI events that are closely coupled with the CC. A few
examples are: the sending of CCOpen when the CC delivery begins, the sending
of CCClose when the CC delivery ends, collecting the post-cut through DTMF
digits from the content of target and reporting those digits using the message
DialedDigitExtraction. With Media packets available, the LMISF will be able to
generate those events rather easily.
4, There is no need to extract the media information (e.g. SDP information)
from the SIP signalling messages and deliver the same to the S-GW/BBIFF via
LPCF.
#### 6.2.6.2 Approach to key issue #1 through key issue #13 and key issue #15
The approaches to key issue #1 through key issue #3 are the same as shown in
clause 6.1.5 except for the following differences:
\- LPCF instructs the S-GW/BBIFF to deliver the media packets to the LMISF.
\- S-GW/BBIFF delivers the media packets to the LMISF.
\- LMISF delivers the CC to the DF3 over X3.
The approaches to key issue #4 through key issue #13 and to key issue #15 with
Solution #2 architecture are the same as shown in clause 6.1.5.
### 6.2.7 Impacts on existing nodes and interfaces
The following impact is foreseen for solution #2:
S-GW will need to implement BBIFF (so to implement Xia and Xib interfaces). As
with all implemented functionality, the performance impact of this is an
implementation and deployment issue.
If S-GW relocation is supported for inbound roamers, then S10 and S11 are
affected. Therefore, S-GW and MME will have to implement an extension that
allows transport of LMISF address and tunnel endpoint ID. This is not required
if the LMISF address is implicitly known (e.g. only one LMISF is deployed).
Bearer teardown due to encryption or use of unsupported codecs may have an
impact on S-GW, as this capability needs to be implemented, if PCC is not
present already.
## 6.3 Solution #3 - Data forwarding from HPLMN
### 6.3.1 Description
This solution addresses key issue #9.
The following steps are performed for every call if required by the roaming
agreement between VPLMN and HPLMN:
\- The P-CSCF in the home network extracts data to be retained from SIP
signalling related to the call establishment (e.g. Called and Calling Party,
and type of communication (e.g. voice call, video call, messaging session)).
\- The P-CSCF provides these data to the PCRF via the Rx interface (see 3GPP
TS 23.203 [9]), for instance within a new transparent container, as part of
the service information related to the call being established.
\- The PCRF forwards these data to the P-GW via the Gx interface, or to the
BBERF via the Gxx interface (see 3GPP TS 23.203), for instance within the same
transparent container, as part of the policy and charging information related
to the call being established. (Both PCRF and P-GW or BBERF are home network
nodes.)
\- The P-GW forwards the data, for instance within the same transparent
container, in GTP (see 3GPP TS 29.274 [10]) via the S8 interface to the S-GW
in the VPLMN as part of the signalling to establish a bearer for the call
being established. Alternatively, the BBERF forwards the data, for instance
within the same transparent container, via PMIP to the S-GW.
\- The S-GW/BBIFF stores this data, i.e. provides data retention capabilities.
The S-GW/BBIFF can also add further data related to the radio bearer, for
instance the location of mobile communication equipment, to the data to be
retained. Alternatively, the S-GW/BBIFF forwards this data to the LMISF that
stores it for retention purposes.
This is further detailed in the call flow in figure 6.3.1.1 below.
Figure 6.3.1.1: Call Flow for data forwarding from the HPLMN
1\. The P-CSCF receives a SIP INVITE request. (For a mobile originated call,
the INVITE is received from the served UE. For a mobile terminated call, the
INVITE is received from the remote peer.) Within the INVITE request, the
called party is designated via the Request URI, for a mobile terminating call
the calling party is designated via the P-Asserted-Identity header field, and
the SDP offer contains information about the desired media that can be used to
derive the type of the communication. For a mobile originating call, the
P-CSCF has knowledge about the identity of the served UE acting as caller and
inserts the P-Asserted-Identity.
2\. The P-CSCF extracts information about the media for the service
information, information about the calling and called parties and the type of
the communication (e.g. voice call) and records the time.
3\. The P-CSCF forwards the SIP INVITE request.
4\. The P-CSCF receives a SIP message containing the SDP answer.
5\. The P-CSCF extracts further service information from the SDP answer.
6\. The P-CSCF sends a Diameter AA-Request containing the extracted service
information to the PCRF. The P-CSCF also adds the calling and called party and
the type of the communication. The P-CSCF uses a transparent container to
encapsulate this added information.
7\. The P-CSCF forwards the SIP message containing the SDP answer.
8\. Upon reception of message 6, the PCRF derives PCC rules from the service
information and sends them in a Diameter RA-Request to the P-GW. The PCRF also
adds the transparent container to the RAR. The transparent container is added
to a PCC rule derived from the service information to achieve that the P-GW
will add this information to the bearer corresponding to the PCC rule in step
9.
9\. The P-GW inspects the PCC rule and decides that a dedicated bearer is
required for the media. It sends a GTP \"Create Bearer Request\" message to
set up the bearer. The P-GW may also find that a suitable bearer towards the
served UE already exists, but will then need to modify the bearer to provide
information towards the served UE where to send media and will then send a GTP
\"Modify Bearer Request\" message (not depicted). The P-GW also adds the
transparent container to the GTP message.
10\. The S-GW/BBIFF receives the GTP message. The S-GW/BBIFF extracts the
contained calling and called party and the type of the communication from the
received transparent container. The S-GW/BBIFF records the time when it
receives the GTP message. The S-GW/BBIFF stores this information and possibly
adds additional information about the location (e.g. cell ID) and the type
and/or identity of the mobile equipment that the S-GW can obtain from other
nodes in the radio access network. The S-GW/BBIFF can alternatively forward
this information to the LMISF for storage.
11\. When the call is being terminated, the P-CSCF will receive a SIP \"BYE\"
message.
12\. The P-CSCF sends a Diameter ST-Request to the PCRF.
13\. The P-CSCF forwards the SIP BYE.
14\. Upon reception of message 12, the PCRF derives PCC rule(s) to be removed
from the service information and sends a request to remove those PCC rule(s)
in a Diameter RA-Request to the P-GW.
15\. The P-GW inspects the PCC rule(s) to be removed and decides that the
dedicated bearer for the media needs to be terminated. It sends a GTP \"Delete
Bearer Request\" message to terminate that bearer. The P-GW may also decide to
retain that bearer towards the served UE for other media, but will then need
to modify the bearer to provide information towards the served UE where to
send media and will then send a GTP \"Modify Bearer Request\" message (not
depicted).
16\. The S-GW receives the GTP message. The S-GW/BBIFF records the time when
it received the GTP message and calculates the duration of the call by
comparing the time with the time stored in step 10. The S-GW/BBIFF stores this
information. The S-GW/BBIFF can alternatively forward this information to the
LMISF for storage.
### 6.3.2 Impacts on Existing Nodes, Interfaces and Functionality
The P-CSCF in the home network extracts data to be retained from SIP
signalling related to the call establishment (e.g. Called and Calling party,
and type of communication (e.g. voice call, video call, messaging session) and
provides this data to the PCRF via the Rx interface (see 3GPP TS 23.203 [9]),
for instance within a new transparent container, as part of the service
information related to the call being established.
The PCRF forwards this data to the P-GW via the Gx interface, or to the BBERF
via the Gxx interface (see 3GPP TS 23.203).
The P-GW forwards the data, for instance within the same transparent
container, in GTP (see 3GPP TS 29.274 [10]) via the S8 interface to the S-GW
in the VPLMN as part of the signalling to establish a bearer for the call
being established. Alternatively, the BBERF forwards the data, for instance
within the same transparent container, via PMIP to the S-GW.
The S-GW/BBIFF stores this data, i.e. provides data retention capabilities.
The S-GW/BBIFF can also add further data related to the radio bearer, for
instance the location of mobile communication equipment, to the data to be
retained. Alternatively, the S-GW/BBIFF forwards this data to the LMISF that
stores it for retention purposes.
## 6.4 Solution #4 Retained Data Solution supporting ETSI and VPLMN control
requirements
### 6.4.1 Description
#### 6.4.1.1 Networks supporting VPLMN S8HR LI
This solution fully addresses Key Issue #9 for deployment scenarios where the
VPLMN has implemented S8HR LI solutions in clauses 6.1 or 6.2.
{width="3.229861111111111in" height="0.75in"}
Figure 6.4.1.1.1: Simplified Retained Data Architecture
Assuming that all SIP signalling for all inbound S8HR VoLTE users is provided
to the LMISF by the BBIFF, then the LMISF has all the basic information
required to generate event records for Retained Data purposes.
Figure 6.4.1.1.1 represents a simplified representation of Retained Data
Architecture. The LMISF provides Retained Data Events to the Retained Data
System via the X_RD interface. Both the Retained Data System and X_RD are out
of scope of the present document.
For all UEs, for each S8HR communication, the LMISF needs to be able to
generate an event record associated with the start and end of the
communication. In addition, where required by national regulations, additional
event records may need to be created as a result of modification or changes
during the communication. The LMISF can either generate specific records for
Retained Data purposes or re-use the X2 event records format used for LI
purposes on a separate interface X_RD.
The Retained Data System is generally responsible managing which specific data
elements (e.g. Calling Party ID, Called Party ID and Location information)
present in the event records generated by the LMISF for Retained Data
purposes, are required and is responsible for discarding any excess
information. Where a national regulation requires the LMISF to minimise data
present in event records prior to passing to the Retained Data system, that
filtering is out of scope 3GPP. Similarly, the Retained Data System is
responsible for any correlation between S8HR event records and VPLMN access
service records. The Retained Data system should have sufficient information
to achieve correlation based on the timestamps, IP addresses and media bearer
IDs available in the SIP signalling and access level records at the S-GW.
#### 6.4.1.2 Networks not supporting VPLMN S8HR LI
Where a network is not required to provide VPLMN S8HR LI based on solutions in
clause 6.1 or 6.2 (e.g. no LI regulatory requirement), the LMISF will not be
present and therefore cannot provide DR functionality in clause 6.4.1.1. In
this scenario there are three possible solutions:
a) The solutions in clause 6.1 or 6.2 are implemented solely to support
Retained Data requirements. In this scenario X2 / HI2 and CC triggering
functionality would not be applicable as they are not required for Retained
Data purposes.
b) Implement a proprietary Retained Data event record generation capability.
c) If the LMISF is not available and (b) is impractical, then the VPLMN would
need to rely on the HPLMN to forward call records for all subscribers.
For (b) to be possible the HPLMN and VPLMN would have to agree to disable
confidentiality protection as per the VPLMN S8HR LI requirements to allow
access to the SIP. However, the proprietary functionality required to provide
Retained Data for S8HR in the VPLMN would result in functions nearly identical
to the S-GW/BBIFF and LMISF.
### 6.4.2 Impacts on existing nodes, interfaces and functionality
In the case of the basic solution described in 6.4.1.1, there are no
standardisation impacts on existing 3GPP nodes or interfaces beyond those
required by S8HR LI solutions in clauses 6.1 or 6.2.
### 6.4.3 Solution evaluation
The solution in 6.4.1.1 requires that the VPLMN has implemented the LMISF,
S-GW/BBIFF and LPCF due to LI obligations. Where a CSP is obligated to comply
with Retained Data obligations only, the LI solutions in clauses 6.1 and 6.2
would not generally be available, unless implemented in a cut down form
specifically for Retained Data purposes.
NOTE: Implementing the LMISF, S-GW/BBIFF and LPCF in a reduced form purely for
Retained Data purposes is out of scope of the present document.
Sub-clause 6.4.1.2 option (c) does not allow the VPLMN to fulfil regulatory
retained data obligations without reliance on the HPLMN to provide complete
and accurate records. Therefore, the solution in sub-clause 6.4.1.2 (c) while
technically implementable would not on its own meet regulatory requirements
for national security or evidentially.
# 7 S8HR Deployment Considerations
## 7.1 General
This clause highlights a number of deployment factors that the HPLMN and VPLMN
need to take into account to minimise the security impacts of S8HR LI and
solution complexity.
## 7.2 HPLMN aspects
### 7.2.1 P-CSCF Confidentiality Disabling
In the case that the P-CSCF and/or S-CSCF are not explicitly aware of which
access network is serving the UE, the following applies.
\- Since S8HR LI in the VPLMN requires that IMS confidentiality protection is
switched off, it can only be switched off for a whole P-CSCF or S-CSCF and not
for individual UEs in specific VPLMNs. To reduce the impact, it is recommended
that the HPLMN dedicate 1 or more P-CSCFs specifically to support S8HR VPLMNs
which require S8HR VPLMN LI support. Therefore, confidentiality can be
reliably switched off only for UEs in applicable VPLMNs.
\- It may be possible to implicitly pass access network details or other
information to the P-CSCF so that it can determine the Serving PLMN but this
is not directly supported by 3GPP standards.
### 7.2.2 Integrity Protection
While it is necessary to disable confidentiality protection of IMS signalling
between the UE and P-CSCF in order to allow the VPLMN to process SIP
signalling for LI purposes, there is no requirement to disable all IMS
security. IMS Integrity protection should be enabled to minimise the impact of
disabling confidentiality protection.
### 7.2.3 S8 Interface Security
While it is necessary to disable confidentiality protection of IMS signalling
between the UE and P-CSCF in order to allow the VPLMN to process SIP
signalling for LI purposes, it is only required that the SIP is decrypted at
the S-GW so that the BBIFF and LMISF can process SIP signalling.
To minimise the security impact, the HPLMN and VPLMN should ensure that the S8
interface between the S-GW in the VPLMN and the P-GW in the HPLMN is protected
using Za mechanisms defined in TS 33.210 [16] (or equivalent protection).
## 7.3 VPLMN aspects
### 7.3.1 S-GW and LMISF simplification
As discussed in Key Issue 5 in clause 5.5, the S8HR VPLMN LI solution can be
based on multiple LMISFs and/or multiple S-GWs. S8HR VPLMN LI will require
that the S-GW supports the necessary logical interface to the BBIFF to allow
the BBIFF to extract appropriate media bearers containing SIP signalling. To
simplify the extraction at the BBIFF the VPLMN should consider using 1 or more
dedicated S-GWs.
Furthermore, Key Issue 5 also highlights that while S8HR LI solutions need to
be able handle the possibility of S-GW relocation, doing so in a deployment
scenario will add significant complexity to the LMISF functionality required
to track and correlate such relocations. It is therefore strongly recommended
that either a single S-GW is used for all S8HR communications or if a
deployment has multiple S-GWs, that the S-GW remains constant for the entire
duration of any communication.
In order to support correlation, all SIP records for a single communication
need to be correlated by the LMISF. X2 IRI messages generated by the LMISF
need to be correlated with access level X2/X3 messages from S-GW/MME. It is
therefore recommended that the a single LMISF is used for all S-GWs to ensure
simple reliable correlation, especially in S-GW mobility scenarios.
### 7.3.2 RAN and Core Network Security
The VPLMN should ensure that RAN security is enabled and that a strong
algorithm is always used. Ideally the VPLMN should also encrypt the links
between the VPLMN nodes which carry SIP signalling bearers using IPsec or
similar mechanisms.
This ensures that the exposure of IMS signalling is limited to the core
network of the VPLMN.
### 7.3.3 Deployment Design: network delays and performance of implemented
solution
For deployment of S8HR LI solution, required level of performance (e.g. LMISF
capability to process in real time all information received on Xia, to
generate in real time IRI on X2 interface) will have to be established before
deployments.
In addition to the identification of processing delays, introduced by LMISF,
deployment and design will have to be made carefully by CSP, to take in
account network/transmission delays to prevent possible situations where start
of communication of targeted call occurs before instruction of duplication of
Content of Communication is received. This is true especially for single LMISF
serving multiple S-GWs scenario, and for Non-Local Identity use case where
decision to trigger the duplication of CC can only be made by analysing each
identity in SIP messages of all Inbound Roamers.
Therefore, it is recommended that the LMISF and LPCF are physically collocated
with any S-GW they serve.
NOTE: The timing problems exist in similar form for dynamic PCC.
# 8 Overall evaluation
## 8.1 Evaluation of S8HR LI Solutions
### 8.1.1 LI solution evaluation overview
The TR identifies two solutions for S8HR LI.
\- Solution #1: S-GW/BBIFF based GTP tunnel extraction
\- Solution #2: Enhanced Architecture
The following clauses evaluate Solution #1 and Solution #2 against the Key
Issues described in clause 5.
### 8.1.2 Evaluation of Key Issues
#### 8.1.2.1 Key Issue #1: IMEI targeted LI
The Solution #1 and Solution #2 using the method where target IMEI is detected
in LMISF address the Key Issue #1.
The option where the target IMEI is detected in the S-GW/BBIFF does not
address the Key Issue #1. That is because the S-GW/BBIFF will have to deliver
the IMS signalling packets to the LMISF even if the IMEI is not detected as a
target for the following reason:
A SIP URI or TEL URI can be the target.
Since the IMS signalling packets have to be delivered all the time for all
inbound roamers with S8HR, there is no real use of having an option where
S-GW/BBIFF would detect the IMEI as a target.
#### 8.1.2.2 Key Issue #2: Tel-URI or SIP-URI targeted LI
The Solution #1 and Solution #2 address the Key Issue #2.
#### 8.1.2.3 Key Issue #3: LI targeted S8 GTP selection criteria
The Solution #1 and Solution #2 address the Key Issue #3.
#### 8.1.2.4 Key Issue #4: Obtaining network provided location
The Solution #1 and Solution #2 address the Key Issue #4.
#### 8.1.2.5 Key Issue #5: Intra-access handover or anchor change impact
The Solution #1 and Solution #2 address the Key Issue #5.
However, both Solution #1 and Solution #2 require additional standardization
work on S10 and S11 reference points. With single LMISF, the changes to the
S-GW relocation procedures (i.e. impacts to S10 and S11 reference points) can
be avoided. The solution can be further simplified with the deployment of
statically assigned S-GWs for S8HR purpose, as described in clause 7.3.1.
#### 8.1.2.6 Key Issue #6: Detecting targeted signalling unknown or
unrecognized by the VPLMN
The Solution #1 and Solution #2 describe the capabilities for detecting and,
when detected, enforcing operator policy when problem described under Key
Issue #6 is encountered. Therefore, the Solution #1 and Solution #2 can
address Key Issue #6.
#### 8.1.2.7 Key Issue #7: Maintaining intra-PLMN and inter-PLMN LI
undetectability
The Solution #1 and Solution #2 address the Key Issue #7.
This Key Issue falls more under an operational aspect rather than an LI issue
itself.
#### 8.1.2.8 Key Issue #8: Detecting implicit IMS registrations
The Solution #1 and Solution #2 address the Key Issue #8.
#### 8.1.2.9 Key Issue #9: Retained Data
The Key Issue #9 does not apply to lawful interception (see clause 8.3).
#### 8.1.2.10 Key Issue #10: Prevention of unwanted use of confidentiality
mechanisms
The Solution #1 and Solution #2 address the Key Issue #10 with a method that
achieves the prevention by detecting the presence of confidentiality
protection and therefore, prevention by subsequent policy enforcement.
#### 8.1.2.11 Key Issue #11: Non-local Identity
The Solution #1 and Solution #2 address the Key Issue #11.
#### 8.1.2.12 Key Issue #12: Non-3GPP codec or 3GPP codec in a non-3GPP mode
in CC
The Solution #1 and Solution #2 address the Key Issue #12 with a method that
achieves the prevention by detecting the presence of non-3GPP codec or 3GPP
codec in a non-3GPP mode and therefore, prevention by subsequent policy
enforcement.
#### 8.1.2.13 Key Issue #13: Start of interception with ongoing VoLTE call
The Solution #1 and Solution #2 address the Key Issue #13.
#### 8.1.2.14 Key Issue #14: Correlation of CC with IRI
The Solution #2 addresses the Key Issue #14 in providing CC correlation with
IRI for VoLTE.
The Solution #1 does not address the Key Issue #14 in providing a method where
the correlation is done by the VPLMN. Instead, with the entire Media packets
(including the IP address and the port numbers) are sent to the LEMF, the LEMF
can examine and correlate the IRI with the CC. This approach does not meet the
normal LEA requirement for correlating CC with IRI.
#### 8.1.2.15 Key Issue #15: Signalling Compression
The Solution #1 and Solution #2 address the Key Issue #15.
## 8.2 Evaluation of Retained Data Solutions
### 8.2.1 Solution #4
Based on Key Issue #9 in clause 5.9, and Retained Data solution in clause 6.4,
S8HR can address basic Retained Data regulatory requirements in the VPLMN
providing the S8HR VPLMN LI capabilities have been deployed.
Where the S8HR VPLMN LI capabilities are not available then the VPLMN would
need to implement equivalent proprietary capabilities although this would rely
on SIP confidentiality protection being switch off as for LI requirements.
However, the ability to comply with Retained Data regulations is limited to
that information which can be obtained by the LMISF from SIP messages passing
through the S-GW. Since this will only include messages between the UE and
P-CSCF, not all information will be available can be obtained compared to a
non-roaming HPLMN single network usage scenario. Through combination with
access level information in the VPLMN, the VPLMN should be able to comply with
national Retained Data Regulations.
### 8.2.2 Solution #3
The potential solution #3 in clause 6.3 has a number of major drawbacks
compared to the approach in 6.4. Solution #3 does not meet the requirement
that the VPLMN is in absolute control of Retained Data without reliance on the
HPLMN. Regulation applicable to the HPLMN may restrict sending information to
the VPLMN which is not required as part of the basic communication call flow.
Solution #3 requires the HPLMN to send all SIP messages back to the VPLMN. To
do this requires upgrading all of the nodes in the VPLMN and HPLMN which are
required to handle this traffic. Furthermore, it has to be assumed that the UE
to P-CSCF signalling is protected by IMS confidentiality protection in this
scenario. Forwarding the SIP messages back to the S-GW in the VPLMN would have
significant security implications and may cause a significant risk to User
Privacy. The proposed signalling routing has not been evaluated by 3GPP SA3
for transferring such information securely and breaks the IMS domain
independence model. It is also unclear how this would work with Network
Slicing or CUPS scenarios being discussed in SA2.
Solution #3 would also require significant additional work in CT groups to
ensure that this solution would work reliably in transnational, multi-vendor,
multi-operator deployment scenarios.
Solution #3 assumes that the S-GW / BBIFF or LMISF would store all SIP
messages potentially for 2 or more years. Storing the raw SIP would result in
significantly more information being stored than is allowed by most national
regulations and does not address correlation for Retained Data purposes
between S8HR and VPLMN/access layer services. Additionally, the storage of
such data at the S-GW/LMISF would have significant security and functionality
impacts on existing deployments.
## 8.3 Evaluation Summary
The following table 8.3.1 compares each of the Key issues in the three
solutions studied by providing references to the clauses where the solution
approaches are described.
* * *
Table 8.3.1: Key issue evaluation summary Key Issue Solution #1 Solution #2
Solution #3 Solution #4  
# Description  
1 IMEI based interception Addressed Addressed Not applicable Not applicable 2
SIP URI/TEL URI based interception Addressed Addressed Not applicable Not
applicable 3 S8 GTP selection criteria Addressed Addressed Not applicable Not
applicable 4 Obtaining Network Provided Location Addressed Addressed Not
applicable Not applicable 5 Intra-access handover or anchor change Addressed
Addressed Not applicable Not applicable 6 Detecting unknown target signalling
Addressed Addressed Not applicable Not applicable 7 Intra/inter-PLMN
undetectability Addressed Addressed Not applicable Not applicable 8 Detecting
implicit IMS registrations Addressed Addressed Not applicable Not applicable 9
Retained Data Not Applicable Not Applicable Partially addressed Addressed 10
Prevention of confidentiality protection usage Addressed Addressed Not
applicable Not applicable 11 Non-local Identity Addressed Addressed Not
applicable Not applicable 12 Non-3GPP codec or 3GPP codec in a non-3GPP mode
Addressed Addressed Not applicable Not applicable 13 Start of interception of
an ongoing call Addressed Addressed Not applicable Not applicable 14
Correlation of CC with IRI Partially addressed Addressed Not applicable Not
applicable 15 SIP signalling compression Addressed Addressed Not applicable
Not applicable
* * *
# 9 Conclusions
## 9.1 Overall Conclusion
Based on future normative implementation of solutions identified in the
present document in TS 33.107 [3] and TS 33.108 [4], S8HR can comply with
Lawful Interception regulatory requirements in countries where national
regulations require a VoLTE service LI capability in the VPLMN. However, this
is reliant on the HPLMN agreeing to disabled VoLTE confidentiality protection
for all VPLMN inbound S8HR VoLTE roamers. In addition, normative changes may
be required in other 3GPP specifications to cover specific scenarios as
discussed in clause 7.
The TR has identified how misconfiguration of IMS confidentiality protection
enabled for VoLTE communications can be detected. The TR has not fully
addressed prevention of encryption but once detected the VPLMN is able to take
appropriate action (e.g. drop media bearers at S-GW/BBIFF and enforcement
action via GSMA roaming agreement).
While S8HR LI solutions in the VPLMN are not able to fully replicate all
capabilities available in an HPLMN non-roaming LI scenario, no significant
gaps have been identified which would prevent deployment of S8HR.
Supplementary services triggered in the HPLMN and identity mappings performed
by the S-CSCF or HSS are potential limitations. However, this is directly
comparable with VoLTE LBO LI capabilities and largely comparable with legacy
CS domain voice LI roaming capabilities.
## 9.2 LI Solution Conclusion
Based on the evaluation in clause 8, Solution #2 is the best solution
identified in the present document to allow a CSP to achieve compliance with
national LI regulations. It is recommended that solution #2 is developed into
normative standards, carefully considering performance issues identified in
clause 7.3.3.
Solution #1 may also be considered for normative standardisation, noting that
it is not able to fully address CC to IRI correlation requirements, following
full standardisation of solution #2.
## 9.3 Retained Data Conclusions
Based on re-use of the basic S8HR VPLMN LI solutions identified in the present
document, S8HR can adequately address Retained Data requirements. However,
GSMA needs to ensure that Roaming Agreements specifically address Retained
Data support in an equivalent way to Lawful Interception (e.g. ensuring
Confidentiality of VoLTE SIP messages is disabled).
###### ### Annex A: GATS BTS potential impact on LI for S8HR
# A.1 Introduction
This Annex provides information related to any national regulations that
require S8HR type services to be licensed under local regulation according to
their provisions under GATS for Basic Telecommunication Services [6].
# A.2 Background
The World Trade Organization is an international body dealing with the rules
of trade between nations. Between 1994 and 1997 WTO members negotiated terms
for Basic Telecommunications Services. This resulted in an \"Annex on
Telecommunication\" under the General Agreement on Trade in Services Annex 1B
(GATS) [7].
Many of the signatory nations now have licensing procedures in place to allow
foreign carriers to offer Basic Telecommunication Services. The key
distinction between roaming arrangements, and GATS Basic Telecommunication
Service, is where control and routing of the telecommunications service takes
place. Once licensed as a foreign carrier, it is regulated in that country,
and usually it will be obligated to meet applicable local national laws. This
may include providing Lawful Interception facilities in that country. Further
this localized Lawful Interception facilities usually needs to be operated or
controlled by a local entity such as subsidiary or partner.
###### ### Annex B: Lawful Interception scenarios with S8HR
# B.1 Originating calls
In this illustration, S8HR approach is used as the roaming architecture for
VoLTE. No IMS network nodes in VPLMN are involved in the handling of calls
originated by the roaming subscriber. The call is terminated at another IMS
network.
In the illustration both visited CSP and Home CSP are served with intercept
orders on that subscriber. In other words, the roaming subscriber is a target
in the VPLMN and in the HPLMN under two independent intercept orders.
Figure B.1.1: S8HR approach for Roaming, interception in VPLMN and HPLMN
In the HPLMN, the S-CSCF or AS provides the IRI interception. The P-CSCF may
optionally provide the IRI interception. The IP-CAN (GGSN/PDN-GW) or IMS-AGW
provides the CC interception. Which of the two nodes provides the CC
interception is dependent on the deployment scenario. In either case, the
P-CSCF sends the CC intercept trigger to the node that performs the CC
interception.
The current 3GPP LI specifications define that the IRI interception is done at
S-CSCF and optionally at the P-CSCF. The CC interception is done at the GGSN
or PDN-GW or IMS-AGW or TrGW or the IM-MGW or the MRF depending on the
deployment and the call scenario. However, none of the nodes mentioned here
are involved in the VPLMN for the handling of the call originated by the
target. Therefore, new LI functionalities will have to be defined to address
this case, for which the confidentiality mechanisms (signalling and media)
shall not be used. The figure B.1.1 shows that the IRI and CC interception is
done in part of the IP-CAN that belongs to the VPLMN, but how exactly it is
done requires some analysis.
NOTE: With S8HR approach, at the originating end, all calls follow the same
signalling and media path.
# B.2 Terminating calls
In this illustration, S8HR approach is used as the roaming architecture for
VoLTE. No IMS network nodes in VPLMN are involved in the handling of calls
terminated to the roaming subscriber. As in the previous case the call is
originated from another IMS network.
In the illustration, both visited CSP and Home CSP are served with intercept
orders on that subscriber. In other words, the roaming subscriber is a target
in the VPLMN and in the HPLMN under two independent intercept orders.
Figure B.2.1: S8HR approach for Roaming, interception in VPLMN and HPLMN
In the HPLMN, the S-CSCF or AS provides the IRI interception. The P-CSCF may
optionally provide the IRI interception. The IP-CAN (GGSN/PDN-GW) or IMS-AGW
provides the CC interception. Which of the two provide the interception is
dependent on the deployment scenario. In either case, the P-CSCF sends the CC
intercept trigger to the node that performs the CC interception.
The current 3GPP LI specifications define that the IRI interception is done at
S-CSCF and optionally at the P-CSCF in the HPLMN. The CC interception is done
at the GGSN or PDN-GW or IMS-AGW or TrGW or the IM-MGW or the MRF depending on
the deployment and the call scenario. However, none of the nodes mentioned
here are involved in the VPLMN for the handling of the call terminated to the
target. Therefore, new LI functionalities will have to be defined to address
this case, for which confidentiality mechanisms (signalling and media) shall
not be used. The figure B.2.1 shows that the IRI and CC interception is done
in the part of the IP-CAN that belongs to the VPLMN, but how exactly it is
done requires some analysis.
NOTE: With S8HR approach, at the terminating end, all calls follow the same
signalling and media path.
#