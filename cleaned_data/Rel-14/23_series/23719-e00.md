# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
**The objective of this Technical Report is to study and specify potential
modifications to the ICS architecture in order to enable all services to be
controlled via IMS rather than via CS legacy mechanisms (single service
domain), for all subscribers of a network and also for inbound roamers.**
As part of Release 8, 3GPP developed the concept of IMS Centralized Services
which was then further extended in Release 9. While the goal of ICS was to
enable an operator to provide communication services (such that all services
and service control are centralized based on IMS mechanisms) on a per-
subscriber basis, it has however not seen widespread deployment, as support of
both domains is still necessary.
To achieve the goal of fully centralizing services and service control in the
IMS domain, network based solutions will be studied that address the key
issues and architectural assumptions defined in this document. In addition,
these potential s**olutions will be evaluated against the existing mechanisms
available in 3GPP technical specifications, before deciding whether to make
changes to the relevant technical specifications.**
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
> [1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
>
> [2] 3GPP TS 22.101: \"Service aspects; Service principles \".
>
> [3] 3GPP TS 23.292: \"Multimedia Subsystem (IMS) centralized services\".
>
> [4] 3GPP TS 24.292: \"IP Multimedia (IM) Core Network (CN) subsystem
> Centralized Services (ICS)\".
>
> [4] GSMA PRD IR.64: \"IMS Service Centralization and Continuity
> Guidelines\".
>
> [5] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification\".
>
> [6] 3GPP TR 23.883: \"Study on enhancements to IMS Centralized Services
> (ICS)\".
>
> [7] 3GPP TR 23.892: \" IP Multimedia Subsystem (IMS) centralized services\".
>
> [8] 3GPP TS 23.236: \"Intra-domain connection of Radio Access Network (RAN)
> nodes to multiple Core Network (CN) nodes\".
>
> [9] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
>
> [10] 3GPP TS 23.002: \"Network architecture\".
>
> [11] 3GPP TS 23.335: \"User Data Convergence (UDC); Technical realization
> and information flows; Stage 2\".
>
> [12] 3GPP TS 29.335: \"User Data Convergence (UDC); User Data Repository
> Access Protocol over the Ud interface; Stage 3\".
>
> [13] 3GPP TS 23.237: \"IP Multimedia Subsystem (IMS) Service Continuity\".
>
> [14] 3GPP TS 23.216: \"Single Radio Voice Call Continuity (SRVCC); Stage
> 2\".
>
> [15] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
>
> [16] 3GPP TS 23.278: \"Customised Applications for Mobile network Enhanced
> Logic (CAMEL) Phase 4; Stage 2; IM CN Interworking\".
>
> [17] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**SeDoC Enhanced Network:** A network which supports the features or functions
required for SeDoC
**ICS Enhanced Network:** A network that supports ICS but does not support
SeDoC.
**Non-Enhanced Network:** A network that supports neither ICS nor SeDoC.
**ICS UE:** A UE which supports the I1 Interface.
**Non-ICS Enhanced UE:** A UE which does not support the I1 interface.
NOTE: here is no such term as a \"SeDoC enhanced UE\" as SeDoC is assumed to
not require any UE changes.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
B2BUA Back to Back User Agent
CS Circuit Switched
eMSC enhanced MSC
ICS IMS Centralized Services
IMS IP Multimedia Subsystem
IP Internet Protocol
SeDoC Service Domain Centralization
TAS Telecom Application Server
# 4 Architectural Assumptions
The following architectural assumptions are valid to all potential solutions:
\- There shall not be any impacts to the UE or the Access Networks.
\- There shall be no changes to TS 24.008 [5] to support SeDoC.
\- Where possible SS7 based interfaces should be replaced with IP based
interfaces (e.g. SIP/Diameter).
\- A network enhanced for SeDoC shall support UEs enhanced for ICS and non-ICS
enhanced UEs.
\- The network enhanced for SeDoC shall not impact other networks interacting
with it (e.g. roaming partners).
# 5 Key Issues
## 5.1 Key Issue 1 - Transition to Single Service Profile in IMS
### 5.1.1 Description
Current solutions for IP based voice services require the network to support
two types of service profiles for different users, an IMS based profile for
services supported in an MMtel TAS (for IMS enhanced users) and a HLR based
profile for legacy services (for non-IMS enhanced users). Even with ICS
enhanced networks there is still need to support both user profiles (for
different segments of users); although ICS enhanced subscribers use the IMS
profile for the MSC services simulated in the IMS domain, there are still some
circumstances that require the use of the HLR profile. Careful configuration
and management is needed to ensure customer service profiles remain consistent
between the two domains even if both profiles are not expected to be used
simultaneously.
Unless a single service profile is used for all users (in the IMS domain),
simplification of the network implementation (and hence reduction in
operational costs) will not be possible.
### 5.1.2 Architectural Requirements
The following architectural requirements are defined:
\- Service profile for all users shall be in the IMS domain only.
\- Service logic execution for all users shall be in the IMS domain only.
\- Applicable CS data as defined in TS 22.101 [2] clause 22.4 shall be
supported by the SeDoC architecture.
## 5.2 Key Issue 2 - Emergency Calls Routed via IMS Service Domain
### 5.2.1 Description
Currently in networks supporting CS voice services and IMS voice services the
routing of emergency calls and services are partly implemented by the legacy
CS assets of a network, and partly by the IMS assets of the network. Full
centralization of the service domain cannot be realized if emergency services
continue to require support in the legacy CS functional elements. ICS moved
the routing logic for normal calls into the IMS domain, therefore the routing
logic for emergency calls should also be performed by the IMS domain.
In addition to the transfer of routing logic into the IMS domain, the
solutions will also need to maintain legacy interfaces and signalling at the
edge of the network to emergency service providers, and any interworking
necessary.
### 5.2.2 Architectural Requirements
The following architectural requirements are defined:
\- Emergency calls made by CS devices and IMS devices will be supported.
\- Emergency calls made by CS devices will use the routing logic in the IMS
domain of the serving PLMN.
\- Legacy bearer and signalling interfaces to emergency service providers
shall be maintained.
### 5.2.3 Architectural Assumptions
The following architectural assumption are defined:
\- For handling eCall MSD in a TS 12 call, it is expected that the PSAP will
use inband eCall modem for MSD transfer as defined in the interworking
requirements in TS 22.101 [2]. The network node (MSC/IMS) is to transfer the
MSD data in an end to end fashion, UE to PSAP, in the form generated by the
UE.
\- PSAP is given an indication that the incoming call is an eCall as required
in TS 22.101 [2].
## 5.3 Key Issue 3 - Inbound Roamers from non-Enhanced Networks
### 5.3.1 Description
It is anticipated that implementation of SeDoC across networks will be
orthogonal, and hence networks that implement SeDoC ahead of their roaming
partners will have subscribers roaming onto their network that utilize legacy
profiles. Networks that support SeDoC will need to address the needs and
expectations of these legacy users, and their respective HPLMN\'s.
### 5.3.2 Architectural Requirements
The following architectural requirements are defined:
\- No special UE functionality shall be required to enable a UE from a HPLMN
not enhanced to support SeDoC to roam onto a network enhanced to support
SeDoC.
\- From the perspective of a HPLMN not supporting SeDoC the SeDoC enhanced
network shall appear as a non-enhanced VPLMN.
## 5.4 Key Issue 4 - Outbound Roamers to non-Enhanced Networks
### 5.4.1 Description
It is anticipated that implementation of SeDoC across networks will be
orthogonal, and hence networks that implement SeDoC ahead of their roaming
partners will have their own subscribers roaming networks that utilize legacy
profiles. Networks that support SeDoC will need to address the needs and
expectations of their users, and the respective VPLMN\'s they roam onto.
### 5.4.2 Architectural Requirements
The following architectural requirements are defined:
\- No special UE functionality shall be required to enable a UE from a HPLMN
enhanced to support SeDoC to roam onto a network not enhanced to support
SeDoC.
\- From the perspective of a VPLMN not supporting SeDoC the SeDoC enhanced
network shall appear as a non-enhanced HPLMN.
## 5.5 Key Issue 5 - Registration and Authentication
### 5.5.1 Description
In the ICS specified in TS 23.292 [3], after the eMSC makes successful CS
registration, it initiates the IMS registration on behalf of the UE. The IMS
does not perform authentication because the eMSC indicates that the CS
authentication has done.
In the SeDoC network, one of Architectural Assumptions is \"Where possible SS7
based interfaces should be replaced with IP based interfaces (e.g.
SIP/Diameter)\".
The key issue studies how to provide Registration and Authentication of CS UE
in SeDoC.
### 5.5.2 Architectural Requirements
The following architectural requirement is following:
\- No special UE functionality shall be required.
# 6 Solutions
## 6.1 Solution 1: Supporting inbound roamer with ICS Interworking Function
### 6.1.1 Overview
This solution addresses key issue #3.
This solution targets the key issue where the VPLMN is fully supporting IMS
and SeDoC but the HPLMN of the roamed in user does not support IMS or ICS. The
basic enhancement is to provide VLR services towards the HLR in the HPLMN in
an interworking function, which has the role of a centralized VLR, replacing
MAP with Diameter in the MSC - Interworking Function communication.
The architecture would look similar to the normal ICS architecture with the
difference that the ICS Interworking Function is shared by all SeDoC-MSCs to
support inbound roamers without IMS roaming agreement. The inbound roamers
will have a temporary IMS subscription for the VPLMN, all services are
executed in the VPLMN.
CAMEL can be supported by collocating the IP Multimedia Service Switching
Function (IM SSF) with the AS in the VPLMN. The IM SSF and can retrieve the
CAMEL Subscription Information (CSI) from the ICS IWF at the time of the
Attach of the UE. The IM SSF will perform the normal CAMEL requests to the
gsmSCF in the HPLMN as specified in TS 23.278 [16].
Figure 6.1.1-1: Reference Architecture with ICS IWF
The ICS Interworking Function (ICS IWF) has the following tasks to support
inbound roamers:
\- role as VLR towards HLR
\- role as HSS towards AS in VPLMN for local IMS registration, i.e. ICS IWF
needs to convert the CS subscription profile and service settings into an IMS
profile to be used in the VPLMN
\- role as HSS for S-CSCF for local IMS registration of the ICS MSC.The SeDoC
MSC Server needs to be enhanced to support the legacy VLR communication for CS
authentication/authorization with Diameter. Further it needs to store the
paging area information for MT call procedure.
In order to support this functionality, 3 new reference points are introduced
in above architecture:
I4: based on Cx, authentication parameters can be provided in a similar way as
S-CSCF -- HSS communication
Sh\' based on Sh, functionality similar to the procedures of AS --HSS
communication
ISC\' based on ISC, functionality similar to the S-CSCF -- AS communication
### 6.1.2 Attach Procedure for inbound roamer
Figure 6.1.2-1: Attach procedure to support inbound roamer
1\. The UE sends a Location Update Request message to the MSC-Server and
includes its IMSI and the LAI.
2\. The MSC detects based on the IMSI that the UE does not belong to the own
network and is an inbound roamer. The MSC contacts the ICS IWF, sending a
Diameter Authentication Request, including the IMSI.
3\. The ICS IWF behaves like a VLR towards the HPLMN HLR of the inbound
roaming UE. The ICS IWF sends an Authentication Parameter Request with the
IMSI of the UE.
4\. The HPLMN HLR provides back the Authentication Info with the IMSI, Kc,
RAND and SRES parameters.
5\. The ICS IWF provides the Diameter Authentication Info Request with the
RAND parameter to the MSC-Server.
6\. The MSC-Server sends an Authentication Request with the RAND value to the
UE.
7\. The UE computes the SRES and provides it back to the MSC-Server in the
Authentication Response.
8\. The MSC-Server provides the SRES value to the ISC IWF in the sending a
Diameter Authentication Request, including the IMSI.
9\. The ICS IWF compares the SRES and generates a TMSI and allocates a IMRN
instead of a MSRN for the UE.
10\. The ICS IWF acts as a VLR, and sends an Update Location towards the HLR
of the HPLMN.
11\. The HLR replies with the Insert Subscriber Data message according to
normal VLR-HLR procedures. The MAP Insert Subscriber Data contains the CSI
according to TS 29.002 [17].
12\. The ICS IWF converts the CS subscription profile into an IMS subscription
profile that can be downloaded to the S-CSCF at time of IMS registration. The
ICS IWF may also convert the CS Service Settings. For invoking other AS(s),
the ICS IWF generates the corresponding iFC(s).
13\. The ICS IWF sends the Kc, TMSI and ICS-flag = true to the MSC Server in
the Diameter response. The MSC -Server provides the TMSI to the UE and starts
the ciphering with Kc, which is not shown in this flow.
14\. The ISC IWF sends the Subscriber Data Insert Acknowledgement to the
HLR/HSS and receives the Location Update Accept message which is send to the
MSC-Server and further to the UE.
15\. The MSC Server constructs an IMS identity for the UE based on the
available information e.g. a tel-URI from the MSISDN, etc.
16\. The MSC Server performs IMS Registration and sends a SIP REGISTER to the
I/S-CSCF.
17\. The I/S-CSCF detect the inbound roamer and select the ICS IWF to perform
the Cx operations. The ICS IWF, acting as a HSS towards the CSCFs. The S-CSCF
downloads the subscriber profile from the ICS IWF including the iFC(s).
18\. The S-CSCF sends the 200 OK back to the MSC-Server.
19\. The S-CSCF performs 3rd party registrations according to the iFC(s) to
notify the AS that the MSC Sever is registered.
20\. The AS subscribes to notifications and subscription downloads data needed
for providing the service from the ICS IWF, acting as a HSS, with a User Data
Request (UDR) / User Data Answer (UDA). The ICS IWF provides the CSI to the
AS, which is then further processed by the IM SSF.
## 6.2 Solution 2: Supporting outbound roamer with an ICS Interworking
Function
### 6.2.1 Overview
This solution addresses key issue #4.
This solution targets the key issue where the HPLMN is fully supporting IMS
and SeDoC but the VPLMN of the outbound roaming user does not support IMS or
ICS. The basic enhancement is to provide HLR services towards the VLR in the
VPLMN in an interworking function.
The architecture is depicted in the following figure:
Figure 6.2.1-1: Architecture for SeDoC outbound roamers support
The ICS Interworking Function (ICS IWF) has the following tasks to support
outbound roamers:
\- role as HLR towards VLR
\- role as AS towards HSS in HPLMN for 3rd party IMS registration to enable
terminating session routing to the VPLMN.
\- translates IMS service and subscription profile to a CS service and
subscription profile
\- B2BUA capabilities for 3rd party IMS registration to enable terminating
session routing
In order to support this functionality, 4 new reference points are introduced
in above architecture:
D reference point for VLR-HLR procedures (authentication, authorization etc.)
E reference point for inter MSC signalling procedures (call setup etc.)
Cx\' based on Cx, authentication parameters can be provided in a similar way
as S-CSCF -- HSS communication
ISC\' based on ISC, functionality similar to the procedures of S-CSCF -- AS
communication
Sh\' based on Sh, functionality similar to the procedures of AS --HSS
communication
### 6.2.2 Attach Procedure for SeDoC outbound roamer
Figure 6.2.2-1: Procedure for SeDoC outbound roamers support
1\. The UE sends a Location Update Request message to the MSC-Server in the
VPLMN and includes its IMSI and the LAI.
2\. The MSC detects based on the IMSI that the UE does not belong to the own
network and is an inbound roamer. The MSC contacts the ICS IWF, acting as a
HLR of the HPLMN, indicating that CS authentication is required with a
Authentication Parameter Request.
3\. The ICS IWF acts like an AS and contacts the HSS, sending a Diameter
Authentication Request, including the IMSI.
4\. The HPLMN HSS provides back the Authentication Info with the IMSI, Kc,
RAND and SRES parameters. Depending on authentication vector provided by the
HSS, the ICS IWF has to map it to a CS authentication vector.
5\. The ICS IWF (acting as HLR to the MSC-Server) provides the Authentication
Info parameters to the MSC-Server. The MSC-Server stores the parameters and
triggers the CS authentication procedure as specified.
6\. The MSC-Server sends an Authentication Request with the RAND value to the
UE.
7\. The UE computes the SRES and provides it back to the MSC-Server in the
Authentication Response.
8\. The MSC-Server sends an Update Location Request with the IMSI to the ICS-
IWF, acting as the HLR of the HPLMN.
9\. The ICS IWF acts like an AS and contacts the HSS, sending a Diameter User
Data Request, including the IMSI.
10\. The ICS IWF retrieves the subscription profile and service settings from
the HSS in a Diameter User Data Answer.
11\. The ICS IWF stores the subscriber data and maps the IMS subscription
profile and service settings into a CS profile with CS settings.
12\. The ICS IWF replies with the Insert Subscriber Data message according to
normal VLR-HLR procedures.
13\. The MSC Server starts ciphering according to normal procedures.
14\. The MSC-Server provides a Location Update Accept message to the UE
according to the normal procedures.
15\. The MSC-Server exchanges the Subscriber Data Insert Acknowledgement and
Location Update Acknowledgement according to normal VLR-HLR procedures.
16\. The ICS IWF constructs an IMS identity for the UE based on the available
information similar to an ICS MSC Server and performs a 3rd party registration
to IMS in the HPLMN in order to enable terminating session redirection to the
VPLMN.
### 6.2.3 Terminating session setup to outbound roaming UE
For terminating session, the incoming session in the HPLMN will be routed to
the ICS IWF, which registered to IMS as B2BUA and then simply translates the
SIP message into a CS call message and forwards it to the MSC-Sever in the
VPLMN.
Figure 6.2.3-1: Terminating call setup procedure to outbound roaming UE
The SIP INVITE is routed from the MO UE A to the ICS-IWF, which acts as a
B2BUA and selects the VPLMN from where the outbound roaming UE registered. The
ICS-IWF translates the SIP INVITE into a CS call setup which is sent to the
outbound roaming UE. The outbound roaming UE acknowledges the CS Call Setup
towards the ICS-IWF, which is translating it into a 200 OK SIP message.
## 6.3 Solution 3: Re-using the existing ICS mechanism for Outbound Roamers to
non-SeDoC Networks
### 6.3.1 Description
This solution addresses key issue #4.
For the outbound roamer to non-SeDoC network, the solution in the TS 23.292
[3] is applied.
When the visiting network is enhanced for ICS, the Registration procedure
shall follow the procedure specified in TS 23.292 [3] clause 7.2.1. The MO
shall follow the procedure specified in TS 23.292 [3] clause 7.3.2.1.2. The MT
shall follow the procedure specified in TS 23.292 [3] clause 7.4.2.1.2. The
Supplementary service invocation shall follow the procedure specified in TS
23.292 [3] clause 7.6.2.
Editor\'s note: It is FFS whether the scenario when the UE roaming to ICS
network needs to be addressed.
When the visiting network isa non-enhanced network, the MSC/VLR in the VPLMN
will make the CS registration to the HLR. The MO shall follow the procedure
specified in TS 23.292 [3] clause 7.3.2.1.3. The MT shall follow the procedure
specified in TS 23.292 [3] clause 7.4.2.1.3. The Supplementary service
invocation shall follow the procedure specified in TS 23.292 [3] clause 7.6.3.
### 6.3.2 Impacts on existing nodes and functionality
The HSS shall have MAP interface with MSC in the VPLMN, and maintain CS
authentication data.
### 6.3.3 Solution Evaluation
## 6.4 Solution 4: Emergency Calls Routed via IMS Service Domain
### 6.4.1 Overview
This solution addresses key issue #2.
The ICS MSC-Server and the SeDoC MSC Server shall be able to detect the
Emergency Call setup based on the CS Setup Indication. The ICS MSC Server
already is able to transfer CS calls into IMS sessions, but needs to be able
to support some P-CSCF capabilities in case of emergency call.
\- Detection of non-UE detectable emergency calls
\- Map the eCall specific CS signalling information to IMS eCall information
\- Allow IMS Emergency calls also when the UE is not registered with the IMS
or does not have sufficient credentials
\- In the case that UE is not already IMS registered, it shall perform a
registration for the support of emergency services (emergency registration).
\- Forwarding of the emergency call request to E CSCF in the same network
\- Since the MSC-Server is the mobility management entity of the CS UE, it can
provide location information and can include it already in the request to the
E-CSCF.
\- IMS Emergency Registration in order to enable the call back from the PSAP
and, if available, priority mechanism for the media traffic in the core
network (implementation dependent).
The following figure shows the basic architecture to support emergency
sessions in the VPLMN for the inbound roaming UE.
Figure 6.4.1-1: Basic architecture for Emergency Call support
As a summary the ICS MSC-Server main impact is to support detection of the CS
Emergency Setup, the procedures of the P-CSCF in case of emergency according
to TS 23.167 [15] and a new interface towards the E-CSCF.
## 6.5 Solution 5: MSC Server enhanced for SeDoC to support registration and
authentication for non-roaming UEs
### 6.5.1 Description
This solution addresses key issue #5.
In ICS, the IMS does not perform authentication because the MSC Server
enhanced for ICS indicates that the CS authentication has been done after the
successful CS registration.
In the SeDoC network, one of Architectural Assumptions is \"Where possible SS7
based interfaces should be replaced with IP based interfaces (e.g.
SIP/Diameter)\".
This solution introduces an MSC Server enhanced for SeDoC for the key issue 5
on Registration and Authentication.
The main function of MSC Server enhanced for SeDoC is:
\- Processes the user-network signalling received over the CS access (e.g.
A/Iu) for interworking with IMS SIP and vice versa, especially the
authentication vector mapping.
Other functions are similar with the MSC Server enhanced for ICS, e.g.
Controls the MGW functions described in TS 23.002 [10] to enable the
interworking between CS access and RTP bearers.
In this solution, the IMS will perform authentication procedure as normal IMS
registration.
Figure 6.5.1-1: Procedure for registration using MSC Server enhanced for SeDoC
1\. The UE sends a Location Update Request towards the MSC Server enhanced for
SeDoC.
2-3. Upon receipt of location update request, MSC Server enhanced for SeDoC
performs standard identity request if needed.
4\. The MSC Server enhanced for SeDoC decides to initiate IMS registration for
this subscriber and derives a domain name from the subscriber\'s identity
(e.g. IMSI) and discovers the address of the appropriate I-CSCF/IBCF.
5-7. The I-CSCF verifies that the incoming REGISTER origins from a trusted MSC
Server (in the same way it would check that a normal REGISTER origins from a
trusted P-CSCF). The I‑CSCF initiates standard procedures for S‑CSCF
location/allocation and forwards the REGISTER to S-CSCF.
8-9. The S-CSCF identifies the REGISTER as being from the MSC Server enhanced
for SeDoC.
During these procedures, authentication parameters for a given subscriber will
be carried. The parameters either contains Authentication Triplets (Rand,
Sres, Kc) or Authentication Quintuplets (Rand, Xres, Ck, Ik, Autn), for GSM
subscriber or UMTS subscriber accordingly.
10-11. The S‑CSCF sends a SIP 401 i.e. an authentication challenge towards the
UE including the challenge RAND, the authentication token AUTN, and also the
integrity key IK and the cipher key CK, or the challenge RAND and the Kc to
MSC Server enhanced for SeDoC.
12\. Upon receipt of 401 from IMS, MSC Server enhanced for SeDoC initiates the
authentication procedure by transferring an AUTHENTICATION REQUEST message
across the radio interface. The AUTHENTICATION REQUEST message contains the
parameters necessary to calculate the response parameters.
Editor\'s note: Details on how authentication parameters to be sent at step 12
generated from those received in step 11, and on the difference between 2G and
3G authentication are FFS.
Editor\'s note: Whether there is any UE impact is FFS.
13\. The UE processes the challenge information and sends back an
AUTHENTICATION RESPONSE message to the network.
14\. The MSC Server enhanced for SeDoC should send REGISTER with
authentication result (XRES/SRES) to I-CSCF.
15-21. I‑CSCF forwards the authentication response to the S‑CSCF. Upon
receiving the message, the S‑CSCF check the authentication response sent by
the UE. If the user has been successfully authenticated, the S‑CSCF sends 200
OK to MSC Server enhanced for SeDoC via I-CSCF.
22\. On receiving a 200 (OK) response to the REGISTER request, the MSC Server
enhanced for SeDoC sends Location Update Accept towards the UE.
### 6.5.2 Impacts on existing nodes and functionality
The MSC Server will be upgraded or replaced to support the
registration/authentication procedure.
### 6.5.3 Solution Evaluation
## 6.6 Solution 6: Re-using the existing mechanism for Roamers to non-Enhanced
Networks
### 6.6.1 Description
This solution addresses key issue #3.
To minimize the impact on the VPLMN (SeDoC), one possible solution is
isolating the impact only on the small part of the network. The architecture
is show as following.
Figure 6.6.1-1: Reference Architecture for Inbound Roamer
In the SeDoC network, there are few MSCs which are legacy MSC. These MSCs
build up a MSC pool, which cover the full area and provide the CS service to
the Inbound Roamers.
When the UE is roaming to the SeDoC network, the RNC/BSC selects the MSC in
the pool according to the IMSI of UE when the UE initially attach to the
network. In other case, the RNC/BSC selects the MSC according to the TMSI as
Specified in TS 23.236 [8]. The interfaces between MSC in the pool of SeDoc
network and HPLMN are legacy interfaces.
For the registration, MO and MT, there is no difference with the existing
procedure.
### 6.6.2 Impacts on existing nodes and functionality
The RNC/BSC selects the MSC in the pool according to the IMSI/TMSI of UE.
### 6.6.3 Solution Evaluation
The advantage is that, this makes the SeDoC network and procedure much simple.
It does not require upgrading all the eMSC.
## 6.7 Solution 7: Control Layer ICS Interworking Function for Outbound
Roamers
### 6.7.1 Description
#### 6.7.1.1 Overview
This solution addresses key issue #4.
This solution introduces an optional node to the HPLMN network that provides
interworking between the MSC/VLR of a VPLMN network not supporting ICS
enhancements and a HPLMN that only provides subscription profile information
in the HSS. By doing this the HPLMN does not need to support a duplicate HLR
profile for its ICS subscribers for when they potentially roam into non-IMS
VPLMNs.
#### 6.7.1.2 Solution Architecture
Figure 6.7.1.2: ICS interworking architecture for outbound roamers on non-
ICS/IMS networks
MSC Server
The MSC Server in this diagram is a MSC Server that has not received any ICS
enhancements as described in TS 23.292 [3]. If the MSC server supports ICS
enhancements existing ICS functions apply.
ICS-IWF:
Provides control layer interworking between a roaming subscribers HSS (in the
HPLMN) and the MSC-S in the VPLMN. Towards the HSS the ICS-IWF provides a
subset of the functions and services of an IMS network related to ICS, and
towards the MSC-Server it provides a subset of the functions of a HLR. In
addition the ICS-IWF provides any required protocol translation between the
networks of the HPLMN and VPLMN.
Reference points
C\' -> Identical to C except terminates at ICS-IWF instead of HLR
D\' -> Identical to D except terminates at ICS-IWF instead of HLR
Cx\' -> Identical to Cx except terminates at ICS-IWF instead of CSCF
Sh\' -> Identical to Sh except terminates at ICS-IWF instead of IMS-AS
Mg\' -> Identical to MG except terminates at ICS-IWF instead of CSCF
#### 6.7.1.3 Procedures
##### 6.7.1.3.1 Registration
1\. MSC-S initiates existing CS registration procedures, with a clarification
that instead of routing these messages to HLR the HPLMN routes these to the
ICS-IWF.
2\. ICS-IWF performs existing IMS registration (performing as a CSCF/AS) and
downloads mmtel service profile from HSS. The ICS-IWF translates mmtel profile
to SS service profile, and creates and stores a HLR equivalent profile. In
addition the ICS-IWF will act as a S-CSCF for further signalling interactions
(e.g. session establishment).
NOTE 1: If necessary the ICS-IWF includes an applicable CAMEL profile in the
SS service profile created above.
3\. ICS-IWF completes existing CS registration procedures with MSC-S (with
ICS-IWF performing as the HLR).
NOTE 2: The above is a simplification of Steps 1-15 of the procedure described
in Figure 6.2.2-1 (Procedure for SeDoC outbound roamers support) from Solution
2. Instead of performing step 16 of this procedure the ICS-IWF performs the
functions of the S-CSCF.
##### 6.7.1.3.2 Authentication
Steps 1-15 of procedure described in Figure 6.2.2-1 (Procedure for SeDoC
outbound roamers support) from Solution 2 are re-used by this solution to
authenticate the user.
##### 6.7.1.3.3 Mobile Originating Call Procedure
No change from existing procedures for CS (all call services for visiting UE
performed by MSC in VPLMN).
##### 6.7.1.3.4 Mobile Terminating Call Procedure
Figure 6.7.1.3: Terminating call setup to outbound roaming UE
1\. SIP INVITE from originating device routed to I-CSCF for Roaming UE-B\'s
home network
2\. I-CSCF performs normal call terminating behaviour and sends INVITE to ICS-
IWF (which is acting as S-CSCF for UE-B).
3\. ICS-IWF realizes UE-B is roaming, and recalls MSC-S address from
registration. ICS-IWF requests roaming number using standard PRN procedure.
4\. ICS-IWF receives MSRN from MSC-S in VPLMN.
5\. ICS-IWF identifies MSRN is associated with external network (BGCF
interaction not shown) - ICS-IWF initiates normal external routing by sending
SIP INVITE to MGCF (PSTN interworking)
6\. MGCF performs ISUP/SIP call setup (IAM or INVITE) with MSC-S in VPLMN
using normal procedures
7\. MSC-S performs normal CS mobile terminating call procedures with UE-B in
VPLMN.
8-12. Normal Acknowledge/200 OK responses to successful establishment of media
connection with terminating UE.
NOTE: This procedure utilizes existing ICS procedures to establish call setup
to a device in a CS network, including CAMEL triggers as defined in TS 23.292
[3].
### 6.7.2 Impacts on existing nodes and functionality
MSC Server
No Impact
HSS
Needs to support Cx\' and Sh\' interfaces.
MGCF
Needs to support Mg\' interface.
### 6.7.3 Solution Evaluation
Editor\'s note: Evaluation of this solution is FFS.
## 6.8 Solution 8: Registration and authentication for non-roaming UEs
### 6.8.1 Description
This solution addresses key issue #5.
The solution is based on the call flow for the inbound roaming support
solution, where there is a clear separation of the CS authentication and the
IMS registration, since the IMS registration from the MSC-Server does not
require any challenge/response. And only makes sense to be executed if the UE
itself is able to authenticate on the CS leg towards the MSC-Server.
The ICS-IWF is providing the VLR role and sends the CS authentication vector
to the MSC-Server and authenticates the corresponding response from the UE.
The HSS needs to be enhanced for communicating with the ICS-IWF.
Figure 6.8.1-1: Registration & Authentication procedure for non-roaming UE
1\. The UE sends a Location Update Request message to the MSC-Server.
2\. The MSC contacts the ICS IWF, sending a Diameter Authentication Request,
including the IMSI.
3\. The ICS IWF sends an Diameter Authentication Parameter Request with the
IMSI of the UE.
4\. The HSS provides back the Diameter Authentication Info with the IMSI, Kc,
RAND and SRES parameters.
5\. The ICS IWF provides the Diameter Authentication Info Request with the
RAND parameter to the MSC-Server.
6\. The MSC-Server sends an Authentication Request with the RAND value to the
UE.
7\. The UE computes the SRES and provides it back to the MSC-Server in the
Authentication Response.
8\. The MSC-Server provides the SRES value to the ISC IWF by sending a
Diameter Authentication Request, including the IMSI.
9\. The ICS IWF compares the SRES and generates a TMSI and allocates a IMRN
instead of a MSRN for the UE. The ICS IWF performs Update Location towards the
HSS.
10\. The ICS IWF sends the Kc, TMSI and ICS-flag = true to the MSC Server in
the Diameter response. The MSC -Server provides the TMSI to the UE and starts
the ciphering with Kc, which is not shown in this flow.
11\. The ISC IWF sends the Location Update Accept message which is send to the
MSC-Server in a Diameter message and further to the UE.
12\. The MSC Server constructs an IMS identity for the UE based on the
available information e.g. a tel-URI from the MSISDN etc.
13\. The MSC Server performs IMS Registration and sends a SIP REGISTER to the
I/S-CSCF.
14\. The I/S-CSCF perform the Cx operations. The S-CSCF downloads the
subscriber profile from the HSS including the iFC(s).
15\. The S-CSCF sends the 200 OK back to the MSC-Server
16\. The S-CSCF performs 3rd party registrations according to the iFC(s) to
notify the AS that the MSC Sever is registered.
17\. The AS subscribes to notifications and subscription downloads data needed
for providing the service from the HSS, with a User Data Request (UDR) / User
Data Answer (UDA).
## 6.9 Solution 9: Support of Single Service Profile in IMS
### 6.9.1 Description
This solution addresses key issue #1.
The Single Service Profile in IMS can be achieved by combining the different
solutions of the different key issues supporting the ICS-IWF.
For the normal, non-roaming case (Solution 8), the service profile is located
in the IMS, the AS is responsible to execute the services according to the
subscription profile, similar to ICS, with the main difference that the CS
authentication of the UE is separated and moved from MAP to Diameter.
For the case of supporting inbound roamer without IMS/ICS/SeDoc support, the
local AS in the VPLMN is also responsible to execute the services. The inbound
roamer retrieves a temporary IMS subscription at the MSC-Server. The ICS-IWF
has the role of the VLR to the HLR and retrieves the CS subscription data. The
ICS-IWF translates the CS service settings into IMS service settings and
generates the corresponding iFC(s). The ICS-IWF acts like a HSS for the
temporary IMS subscription for this inbound roaming UE and provides the IMS
subscriber profile including iFC(s) to the S-CSCF at time of the MSC-Server
registration. It further provides the relevant service data to the AS, which
can then execute the service.
For the case of outbound roaming into a legacy network without any
IMS/ICS/SeDoc support, the service profile is kept in the HSS, but the ICS-IWF
converts the IMS service settings into a CS service profile which is further
provided to the local MSC-Server. The local MSC-Server in the VPLMN will
execute the services in CS.
## 6.10 Solution 10: MSC Server enhanced for SeDoC registration and
authentication for inbound roaming UEs
### 6.10.1 Description
This solution addresses key issue #5 and is basis for key issue #3.
This solution is based on solution 5 and adds Authentication flow for inbound
roamers.
The main difference to solution 5 is that for inbound roamers the registration
flow goes through an ICS IWF that acts as a HSS towards the I-CSCF and S-CSCF
in the VPLMN and as a VLR towards the HPLMN HLR.
In this solution, the IMS will perform authentication procedure as normal IMS
registration.
{width="6.534027777777778in" height="4.267361111111111in"}
Figure 6.10.1-1: Procedure for registration of an inbound roamer using MSC
Server enhanced for SeDoC
1\. The UE sends a Location Update Request towards the MSC Server enhanced for
SeDoC.
2\. Upon receipt of location update request, MSC Server enhanced for SeDoC
performs standard identity request if needed
3\. The MSC Server enhanced for SeDoC decides to initiate IMS registration for
this subscriber, i.e. constructs an IMS identity for the UE based on the
available information e.g. a tel-URI from the MSISDN etc. , derives a domain
name from the subscriber\'s identity (e.g. IMSI) , discovers the address of
the appropriate I-CSCF/IBCF.and sends a SIP REGISTER to that I-CSCF with a
private and temporary Public User Identity derived from the subscriber\'s IMSI
as well as an InstanceID. The REGISTER also contains information indicating
the capabilities (e.g. media types) supported and characteristics of the MSC
Server as a SIP User Agent Client, the access type, location and the network
identifier.
4\. The I-CSCF verifies that the incoming REGISTER origins from a trusted MSC
Server (in the same way it would check that a normal REGISTER origins from a
trusted P-CSCF). Based on local configuration and information provided in the
REGISTER request the I‑CSCF sends the Cx-Query/Cx-Select-Pull information flow
to the ICS IWF (Public User Identity, Private User Identity, network
identifier).
5\. The Cx-Query Resp/Cx-Select-Pull Resp is sent from the ICS-IWF to the
I‑CSCF. It contains the S‑CSCF name, if it is known by the ICS-IWF, or the
S‑CSCF capabilities, if it is necessary to select a new S‑CSCF. When
capabilities are returned, the I‑CSCF shall construct a name from the
capabilities returned.
6\. The I‑CSCF forwards the REGISTER to S-CSCF. The S-CSCF identifies the
REGISTER as being from the MSC Server enhanced for SeDoC.
7\. The S-CSCF requests the authentication info from the ICS IWF acting as
HSS.
8-9. The ICS-IWF acting as VLR provides back the Authentication Info with the
IMSI, Kc, RAND and SRES parameters from the HPLMN HLR/HSS. Depending on
authentication vector provided by the HLR/HSS, the ICS IWF has to map it to a
CS authentication vector. The ICS IWF retrieves the service profile via the D
interface, i.e. it behaves like a VLR towards the HPLMN HLR by performing an
Update Location Procedure and creates a temporary record (subscription
profile) in the ICS IWF. For invoking other AS(s), the ICS IWF generates the
corresponding iFC(s).
10\. During these procedures, authentication parameters for a given subscriber
will be carried. The parameters either contains Authentication Triplets (Rand,
Sres, Kc) or Authentication Quintuplets (Rand, Xres, Ck, Ik, Autn), for GSM
subscriber or UMTS subscriber accordingly.
11\. The S‑CSCF sends a SIP 401 i.e. an authentication challenge towards the
UE including the challenge RAND, the authentication token AUTN, and also the
integrity key IK and the cipher key CK, or the challenge RAND and the Kc to
MSC Server enhanced for SeDoC.
12\. Upon receipt of 401 from IMS, MSC Server enhanced for SeDoC initiates the
authentication procedure by transferring an AUTHENTICATION REQUEST message
across the radio interface. The AUTHENTICATION REQUEST message contains the
parameters necessary to calculate the response parameters. The UE processes
the challenge information and sends back an AUTHENTICATION RESPONSE message to
the network.
13\. The MSC Server enhanced for SeDoC should send REGISTER with
authentication result (XRES/SRES) to I-CSCF.
14-17. I‑CSCF forwards the authentication response to the S‑CSCF. Upon
receiving the message, the S‑CSCF check the authentication response sent by
the UE. If the user has been successfully authenticated, the S‑CSCF sends 200
OK to MSC Server enhanced for SeDoC via I-CSCF.
18\. On receiving a 200 (OK) response to the REGISTER request, the MSC Server
enhanced for SeDoC sends Location Update Accept towards the UE.
### 6.10.2 Impacts on existing nodes and functionality
HSS
\- No impact.
Legacy GSM MSC, MSC-Server
\- replaced by MSC Server enhanced for SeDoC (after migration phase).
I/S-CSCF
\- Local configuration to route inbound roamer requests to ICS IWF.
### 6.10.3 Solution Evaluation
This solution enables the use of IMS-Core procedures without any changes.
## 6.11 Solution 11: MSC Server enhanced for SeDoC
### 6.11.1 Overview
This solution addresses key issue #1, #3 and #4.
The basic principles of this solution are that 2G/3G CS access is mapped to
IMS and PS access uses \"native\" IMS (VoLTE) but there is a single service
domain for both accesses in IMS. The user profile is solely provided by IMS
domain.
Figure 6.11.1-1: Services for PS access and CS access in HPLMN IMS
For the migration phase the SeDoC enabled network operator is required to
provide legacy support for inbound roamers as shown in figure 6.11.1-2.
Figure 6.11.1-2: Services for Inbound roamers provided in VPLMN IMS
Long term target is that the service for inbound roamer be provided by the
HPLMN, i.e. the VPLMN IMS-GWs (IBCFs) would relay towards home IMS service
infrastructure as shown in figure 6.11.1-3.
Figure 6.11.1-3: Services for Inbound roamers provided in HPLMN IMS
#### 6.11.2 SeDoC Architecture
The basic principles described in previous clause require the introduction of
a CS access to IMS gateway function (MSC Server enhanced for SeDoC ) and an
interworking fucntion (ICS IWF) to the SeDoC architecture. The MSC Server
enhanced for SeDoC maps GSM Access procedures to IMS procedures but does not
store User Profile Data, i.e. the VLR functionality is extracted and is placed
for own users into the HSS and for inbound roamer into an ICS-IWF. By doing
this the internal IMS architecture does not need to introduce new interfaces.
NOTE: A similar architecture was already discussed in 3GPP during the
development of TR 23.892 [7]. It should be noted that the way the architecture
and protocols are specified, the functionality of the gateway can be extracted
from an MSC Server and deployed as a separate network element.
{width="6.534027777777778in" height="2.720138888888889in"}
Figure 6.11.2-1: SeDoC functional architecture
NOTE: Does only show the principle architecture, i.e. it does not show all
interfaces.
#### 6.11.2.1 Reference points
##### 6.11.2.1.1 Reference Point MSC Server enhanced for SeDoC - CSCF (I2\'
Reference Point)
The I2\' reference point is based on I2 functionality similar to the
procedures of P-CSCF - X-CSCF communication. It is used to route session
control signalling between the MSC Server enhanced for SeDoC and the IMS, as
defined in TS 23.292 [3] and in TS 23.237 [13]. Additionally it supports the
combined authentication/registration procedure as speicified in this TR
solution 5.
I2\' is used to support the following features:
\- An MSC Server enhanced for ICS and SRVCC, as defined in TS 23.292 [3], TS
23.216 [14] and TS 23.237 [13].
##### 6.11.2.1.2 Reference Point MSC Server enhanced for SeDoC - TAS (I3\'
Reference Point)
The I3\' is used between the MSC Server enhanced for ICS and the TAS to
interwork CS signalling and communication service setting procedures, as
defined in TS 23.292 [3].
##### 6.11.2.1.3 Reference Point ICS-IWF - CSCF (Cx\' Reference Point)
The Cx\' reference point is based on Cx functionality similar to the
procedures of S-CSCF -- HSS communication. It supports information transfer
between CSCF and HSS.
The main procedures that require information transfer between CSCF and HSS
are:
1) Procedures related to Serving CSCF assignment
2) Procedures related to routing information retrieval from HSS to CSCF
3) Procedures related to authorisation (e.g. checking of roaming agreement)
4) Procedures related to authentication: transfer of security parameters of
the subscriber between HSS and CSCF
5) Procedures related to filter control: transfer of filter parameters of the
subscriber from HSS to CSCF
Further information on the Cx reference point is provided in TS 23.228 [9].
#### 6.11.2.2 MSC Server enhanced for SeDoC Features
The MSC Server enhanced for SeDoC terminates CS Access and maps it to
respective IMS procedures.
At high level the MSC Server enhanced for SeDoC performs the following
functionality on the control plane:
\- towards the UE:
\- terminates the A (GERAN) and Iu-cs interfaces (UTRAN) when the UE accesses
via a CS RAT.
\- towards the IP Multimedia Subsystem:
\- Terminates the I2 interface to the x-CSCF.
\- Terminates I3 to the Telephony Application Server.
\- towards legacy networks:
\- terminates the G and E interface towards MSC Servers.
\- terminates ISUP signalling towards PSTN.
On the media plane the MSC Server enhanced for SeDoC controls Mc to the Media
gateway.
A graphical representation of the MSC Server enhanced for SeDoC is shown in
Figure 1.
**Main differences to MSC Server enhanced for ICS**
The MSC Server enhanced for SeDoC is based on the MSC Server enhanced for ICS,
associated MGW as defined in TS 23.292 [3], TS 23.216 [14] and TS 23.237 [13]
with the following amendments.
**Call control solely done in IMS**
Call Control (CC) functionality is essentially required only for the A/Iu-cs
side of the MSC Server enhanced for SeDoC. Some local call control i.e.to
treat \"non UE detected emergency call\" (Germany: 110) as emergency call and.
route to E-CSCF is required. Remaining Call Control functionaliy is done by
IMS in the same way as for PS calls. Therefore the MSC Server enhanced for
SeDoC behaves as P-CSCF/ATCF from viewpoint of I/S/E-CSCF, SCC-AS and MSC.
Radio Resource Management (RR) and Mobility Management (MM) remain unchanged.
**No VLR functionality**
MSC Server enhanced for SeDoC does not include VLR functionality, i.e. there
is also no D-Interface to the HLR. User Service Profile data and user service
profile (i.e. identity, supplementary services) are handled in the IMS domain
only. MSC Server enhanced for SeDoC just need to store user data related to
radio access and RR/MM/CC procedures (e.g. IMSI, IMEI, TMSI, etc.).
**Mapping of CS procedures to IMS procedures**
The MSC Server enhanced for SeDoC terminates CS Access and maps it to
respective IMS procedures.
**Call Control procedures**
Call Control procedures from the mobile CS user interface (A, Iu) are mapped
towards IMS interface, i.e. I2 (SIP) towards IMS core in order to support the
mapping of:
\- MOC & MTC based on A/Iu to respective IMS procedures
\- SMS-MO & SMS-MT based on A/Iu to respective IMS/IP-SM procedures
**Supplementary Services Management procedures**
Supplementary Services Management procedures from the mobile CS user interface
(A, Iu) are mapped towards IMS interfaces, i.e. I3-IF (Ut, XCAP) towards IMS
MMTEL AS.
**Mobility and Authentication procedures**
Basic Mobility and Authentication procedures from the mobile CS user interface
(A, Iu) are mapped to appropriate procedures towards IMS core (CS network
attach (LUP) / IMS registration; Authentication). For Authentication the MSC
Server enhanced for SeDoC processes the user-network signalling received over
the CS access for interworking with IMS SIP and vice versa, especially the
authentication vector mapping.. For details refer to solution 5.
**Mapping of IMS procedures to CS procedures**
IMS specific procedures that need to be mapped to appropriate GSM procedures
are:
\- early media (uni/bi-directional through-connect of media path).
\- multiple early dialogues (due to forking on remote side (e.g. MSIM
scenario):
\- i.e. MSC Server enhanced for SeDoC serving the originating user needs to
map multiple early SIP dialogues to one GSM dialogue towards the GSM device.
SRVCC is supported as specified for GSM MSC (TS 23.216 [14]), i.e. via Sv
Interface to MME and via I2 Interface to ATCF. Reverse SRVCC is supported as
specified for GSM MSC (TS 23.216 [14]).
CSFB support for Voice and SMS over SGs interface to MME, in case of combined
attach to EPC and CS (via SGs), the MSC Server enhanced for SeDoC needs to
interact with the IMS core similar as for CS attached voice terminals (e.g.
map Location Update to IMS Registration, etc.)
**Procedures which can be handled without IMS interaction**
Various MSC-Server procedures which can be handled without IMS interaction
remain within the MSC Server enhanced for SeDoC. This includes e.g. handover
to/from other MSC Server enhanced for SeDoC or VMSC (original MSC Server
enhanced for SeDoC remains anchor after handover).
**SMS support considerations**
In order to properly support SMS a SIP based replacement for MAP based SMS
alerting procedures (reachability check) is needed, i.e. to set \"not
reachable\" flag in case of unsuccessful SMS-MT and re-register if user is
reachable again.
Upon unsuccessful SMS-MT delivery (no response from terminal) the MSC Server
enhanced for SeDoC needs to activate a \"Not Reachable\" (NR) flag (similar to
GSM MSC). In case of \"NR flag = TRUE\" and receipt of any message from the
terminal, the MSC Server enhanced for SeDoC needs to re-register towards IMS-
Core.
In case of unsuccessful SMS-MT to an attached user, the IP-SM-GW shall not
initiate supervision in packet core network (Sh request to HSS).
After unsuccessful SMS-MT delivery, the IP-SM-GW sets a \"Not Reachable\"
flag. Due to this flag a re-registration (and other messages received from the
terminal) will trigger the standard retry mechanisms.
**Location**
MSC Server enhanced for SeDoC provides with PANI header the network provided
location information according to cell-id received from radio access network
(RAN). This information may be used by applications to differentiate between
2/3G Access via MSC Server enhanced for SeDoC and 4G Access via P-CSCF.
**CS Data support**
CS Data is used analogously to a voice call: A data terminal equipment (modem)
establishes a connection to another terminal (modem). The connection setup is
controlled by the IMS Core, the data stream can be transported transparently
with already available codecs (e.g., \"clear mode\"/G7.11).
#### 6.11.2.3 MSC Server enhanced for SeDoC Call Flows
##### 6.11.2.3.1 Authentication/Registration for own users not roaming
##### For authentication/Registration flow for own users not roaming please
refer to solution 5 in this TR.
##### 6.11.2.3.2 Originating session for own users not roaming
Session origination for own users is according to TS 23.292 [3] clause
7.3.2.1.2 Origination using I2 reference point.
##### 6.11.2.3.3 Terminating session for own users not roaming
Session termination for own users is according to TS 23.292 [3] clause
7.4.2.1.2 Termination using I2 reference point.
##### 6.11.2.3.4 SMS-MO for own users not roaming
{width="6.291666666666667in" height="3.448611111111111in"}
Figure 6.11.2.3.4 SMS-MO for own users not roaming
1) UE submits the standard CS Short Message to the MSC Server enhanced for
SeDoC.
2) MSC Server enhanced for SeDoC encapsulates the Short Message (SMS-SUBMIT,
SC Address) and submits it to the S-CSCF using an appropriate SIP method.
3) S-CSCF forwards the encapsulated Short Message (SMS- SUBMIT, SC Address) to
IP-SM-GW (AS) based on stored iFC.
4) IP-SM-GW (AS) acknowledges the SIP message.
5) SIP message acknowledge is forwarded by S-CSCF to MSC Server enhanced for
SeDoC.
6) The IP-SM-GW performs service authorization based on the stored subscriber
data. The IP SM GW checks whether the subscriber is authorised to use the
short message service. The IP-SM-GW (AS) extracts the Short Message (SMS-
SUBMIT) and forwards it towards the SMS-SC (SC Address) using standard MAP or
Diameter based (SGd/Gdd) signalling (as described in TS 23.040 [XX]).
7) The SMS-SC sends a Submit report (SMS-SUBMIT REPORT) to IP-SM-GW (AS) (see
TS 23.040 [XX]).
8) IP-SM-GW (AS) sends the Submit report to S-CSCF, encapsulated in an
appropriate SIP request.
9) The S-CSCF sends the encapsulated Submit report to the MSC Server enhanced
for SeDoC.
10) MSC Server enhanced for SeDoC sends the Submit report to the UE.
11) The MSC Server enhanced for SeDoC acknowledges the SIP request.
12) The S-CSCF acknowledges the SIP request.
##### 6.11.2.3.4 Supplementary Service Execution -- Call forwarding
unconditional
{width="6.215972222222222in" height="4.800694444444445in"}
Figure 6.11.3.4.1: Call forwarding unconditional
User B has activated the CFU service.
1\. UE A initiates a standard CS call setup containing the B-party number.
2\. The MSC Server an INVITE to the S-CSCF with the Request URI set to the
B-party number.
3\. The S‑CSCF performs standard service control execution procedures. The
URI-B is subscribed to the CFU service. Filter criteria direct the S-CSCF to
send theINVITE to the AS.
4\. Based on the service profile the AS executes the call forwarding
unconditional logic. An initial INVITE request including URI-C as destination
is sent back to the S-CSCF..
5\. S-CSCF looks up to the HSS to identify the location of User-C
6\. -7. The communication is routed towards User-C
8.-13. The OK response is sent back to the User-A.
### 6.11.3 SeDoCArchitecture for Inbound Roamers
For the migration phase the SeDoC enabled network operator is required to
provide legacy support for inbound roamers. The architecture proposed in this
solution is for the SeDoC enabled visited network to emulate a VLR and
allocate to the inbound CS roaming subscriber a temporary IMS identity so that
they can also be served by the IMS domain.
CAMEL can be supported by collocating the IP Multimedia Service Switching
Function (IM SSF) with the AS. The IM SSF retrieves the CAMEL Subscription
Information (CSI) from the ICS IWF at the time of the Attach of the UE. The IM
SSF would perform the normal CAMEL requests to the gsmSCF in the HPLMN as
specified in TS 23.278 [16].
The detailed architecture diagram is depicted in Figure 6.11.3-1:
{width="6.534027777777778in" height="3.3666666666666667in"}
Figure 6.11.3.1: SeDoC Architecture for inbound roamer support
#### 6.11.3.1 IMS Centralized Services Interworking Function (ICS-IWF)
Features
The ICS-IWF is necessary to support roaming sceanrios. Therefore it acts as a:
\- HSS towards the I-CSCF and S-CSCF in the VPLMN and as a VLR towards the
HPLMN HLR and is mainly necessary to support roaming sceanrios. It performs
the following functionality:
\- Towards the I-CSCF
\- terminates the Cx\' interface
\- Towards the S-CSCF
\- terminates the Cx\' interface
\- Towards HPLMN HLR for inbound roamer during migration phase
\- Terminates the C interface
The ICS-IWF provides the several roles:
\- role as VLR towards HPLMN HLR, i.e. in course of registration the ICS-IWF
retrieves the user profile from HPLMN and creates a temporary user profile.
The temporary user profile may be updated due to MAP ISD or deleted due to MAP
Cancel or IMS de-registration or IMS registration time out.
\- role as HSS towards the S-CSCF in VPLMN for local IMS registration.
\- role as HLR towards VLR.
\- role as AS towards HSS in VPLMN for 3rd party IMS registration to enable
terminating session routing to the VPLMN.
#### 6.11.3.2 Supplementary Services Management for Inbound roamers
For Inbound roamers the SS Management procedures are mapped as depicted below.
Figure 6.11.3.2 Supplementary services management for inbound roamers
#### 6.11.3.3 MSC Server enhanced for SeDoC Call Flows for Inbound roamer
##### 6.11.3.3.1 Authentication/Registration for Inbound roamers
##### This section provides authentication/registration flows for different
network configurations.
###### 6.11.3.3.1.1 Authentication/Registration for inbound roamer in a SeDoC
enhanced network
For details on Authentication and Registration of an Inbound Roamer by the
SeDoC architecture please refer to solution 10.
###### 6.11.3.3.1.2 Authentication/Registration for ICS inbound roamer in a
SeDoC enhanced network
{width="6.691666666666666in" height="7.885416666666667in"}
Figure 6.11.3.3.1.2: Access procedure for ICS inbound roamer in a SeDoC
enhanced network
1 -7. Same as steps as in solution 5 of this TR.
8\. The S-CSCF identifies the REGISTER as being from the MSC Server enhanced
for SeDoC. The S-CSCF requests the authentication info from the ICS IWF which
acts as a HSS towards the S-CSCF.
9-13. The ICS-IWF acting as VLR provides back the Authentication Info
parameters from the HPLMN HLR/HSS. The parameters either contains
Authentication Triplets (Rand, Sres, Kc) or Authentication Quintuplets (Rand,
Xres, Ck, Ik, Autn), for GSM subscriber or UMTS subscriber accordingly. The
ICS IWF retrieves the service profile via the D interface, i.e. it behaves
like a VLR towards the HPLMN HLR by performing an Update Location Procedure.
The ICS IWF creates a temporary record (subscription profile), selects the in
the ICS IWF. For invoking other AS(s), the ICS IWF generates the corresponding
iFC(s).
14-26. Same as steps 10.-22.in solution 5 of this TR.
##### 6.11.3.3.2 Originating session for Inbound roamer
The Origination session for inbound roamers is very similar to the Origination
using I2 reference point as described in section 7.3.2.1.2 in TS 23.292 [3]
with the difference that the S-CSCF and AS is located in the HPLMN.
##### 6.11.3.3.3 Terminating session for Inbound roamer
UEs which have been successfully registered in IMS by the MSC Server have a
registration binding at the S‑CSCF containing the MSC Server as the contact
address.
The SCC AS shall be inserted in the IMS session path using the terminating
iFC. The SCC AS performs T-ADS for selection of an access and returns
information to assist with S‑CSCF selection of a registered contact address.
When the T-ADS function selects the MSC Server enhanced for SeDoC, the SCC AS
directs the IMS terminating session towards the contact address of the MSC
Server.
On receipt of the session initiation message, the MSC Server enhanced for ICS
shall perform the necessary interworking between the I2 reference point and CS
signalling (e.g. as described in TS 24.008 [5]). The MSC Server shall also
control a CS-MGW using the Mc reference point to perform the necessary
interworking between RTP bearers on the Mb reference point and CS access
bearers and adds the User Location Information (e.g. CGI or SAI) and/or UE
Time Zone Information to the response to the session initiation.
The SCC AS selects to breakout an incoming session to the CS domain in case UE
is registered in IMS as being attached to the CS network at an MSC Server
enhanced for SeDoC. In this case, terminating iFC forwards the call to the SCC
AS.
{width="6.697222222222222in" height="4.1722222222222225in"}
Figure 6.11.3.3.3: IMS Termination via CS Access for for inbound roamer
1\. The UE A originates a call in the CS domain to party-B according to
standard origination procedures.
2\. The GMSC sends a Send Routing Information (SRI) request to the HLR.
3.-4. The HLR fetches a MSRN from the ICS-IWF acting as VLR by a Provide
Roaming Number (PRN) request/response sequence.
5\. The HLR forward the MSRN in the SRI Res. message.
6\. The GMSC sets up the call towards the MGCF of the VPLMN with the received
MSRN.
7\. The MGCF initiates an INVITE towards the I‑CSCF in the home IMS of the
originating user.
8.-9. The I-CSCF retrieves the address assigned to the SeDoC user from the
ICS-IWF. For the LIR the I-CSCF uses the called party from the INVITE which is
the MSRN. The IWF has assigned this MSRN according to the called user (MSISDN)
(step 3,4) and has stored the relation MSISDN/MSRN.
10\. The I‑CSCF routes the INVITE to the S‑CSCF.
11\. The S‑CSCF performs standard service control execution procedures. Filter
criteria direct the S‑CSCF to send the INVITE to the SCC AS.
12\. The SCC AS performs terminating access domain selection. The SCC AS
chooses the CS access network and the MSC Server contact address, amongst the
registered contact addresses for the UE B, for the setup of the media. The SCC
AS establishes a new session by sending an INVITE to the UE B via the S‑CSCF.
13\. The S‑CSCF forwards the INVITE to the MSC Server based on the contact
address stored during registration, using standard IMS procedures.
14\. The MSC Server sends a Setup message to the UE B.
##### 6.11.3.3.4 Call flow including IN
This call flow show the scenario where an inbound roamer is an IN user.
{width="6.695138888888889in" height="3.029166666666667in"}
Figure 6.11.3.3.4: Call Flow including IN
During registration the ICF-IWF retrieves the service profile of UE A which
includes CAMEL subscription information (CSI), the S-CSCF the iFCs to include
the IM-SSF AS and the IM-SSF retrieves the CSI via Sh interface from the ICS-
IWF during the 3party-registration procedure.
1\. UE A initiates a standard CS call setup containing the B-party number.
2\. The MSC Server an INVITE to the S-CSCF with the Request URI set to the
B-party number.
3\. The S‑CSCF performs standard service control execution procedures. Filter
criteria direct the S-CSCF to send the INVITE to the IM-SSF AS.
4\. Based on the CSI the IM-SSF AS triggers a CAP IDP with B-party number to
the gsmSCF.
5\. The IN service logic is executed and it decides to forward the call to the
C-party number and returns CAP CONNECT message to the IM-SSF AS.
6\. The IM-SSF AS translates the CAP message to an INVITE towards the C-party
number.
7\. The S‑CSCF forwards the INVITE according to standard procedures.
#### 6.11.3.4 MSC Server enhanced for SeDoC Call Flows for Outbound roamer
##### 6.11.3.4.1 Authentication/Registration for outbound roamer in a SeDoC
enhanced network
{width="6.696527777777778in" height="7.129861111111111in"}
Figure 6.11.3.4.1: Authentication/Registration for outbound roamer in a SeDoC
enhanced network
1.-22. The flow description is according to Solution 5 in this TR.
##### 6.11.2.3.2 Originating session for own users roaming (outbound roamer)
Session origination for own users is according to 23.292 [3] clause 7.3.2.1.2
Origination using I2 reference point.
##### 6.11.2.3.3 Terminating session for own users roaming (outbound roamer)
Session termination for own users is according to TS 23.292 [3] clause
7.4.2.1.2 Termination using I2 reference point.
### 6.11.4 Impacts on existing nodes and functionality
GSM HLR
\- obsolete for domestic use (after migration phase),
\- no impact for outbound roaming.
HSS
\- No impact.
Legacy GSM MSC, MSC-Server
\- replaced by MSC Server enhanced for SeDoC (after migration phase).
CS-MGW
\- no impact.
I/S/E-CSCF, BGCF
\- Support of new use cases:
\- re-registration for SeDoC user without authentication.
MGCF
\- no impact.
MMTEL/SCC AS
Editor\'s note: Impact to MMTEL/SCC is FFS
### 6.11.5 Solution Evaluation
Editor\'s note: Evaluation of this solution is FFS.
# 7 Void
# 8 Conclusions
It is concluded for Key Issue #2, that Solution #4 be adopted for inclusion in
the overall SeDoC solution, and that normative work update the ICS and IMS
Emergency call specifications to reflect the solution, as well as update the
eCall specifications to reflect the architectural assumptions of key issue #2.
It is concluded for Key Issue #5, that Solution #5 be adopted for inclusion in
the overall SeDoC solution.
It is concluded that the overall SeDoC solution be captured in an informative
Annex to the ICS specifications, except for the SeDoC
Registration/Authentication procedure, which will be described in normative
text.
\- It is concluded for Key Issue #1, that the portions of solution #11 not
related to outbound roaming are adopted for inclusion in the overall SeDoC
solution.
\- It is concluded for Key Issue #3, that the portions of Solutions #10 and
#11 related to outbound roaming are adopted for inclusion in the overall SeDoC
solution.
\- It is concluded for Key Issue #4, that the portions of Solution 10 related
to inbound roaming be adopted for inclusion in the overall SeDoC solution.
#