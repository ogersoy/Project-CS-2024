# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document contains the definition of the LTE Positioning Protocol
(LPP).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 36.305: \"Stage 2 functional specification of User Equipment (UE)
positioning in E-UTRAN\".
[3] 3GPP TS 23.271: \"Functional stage 2 description of Location Services
(LCS)\".
[4] IS-GPS-200, Revision D, Navstar GPS Space Segment/Navigation User
Interfaces, March 7^th^, 2006.
[5] IS-GPS-705, Navstar GPS Space Segment/User Segment L5 Interfaces,
September 22, 2005.
[6] IS-GPS-800, Navstar GPS Space Segment/User Segment L1C Interfaces,
September 4, 2008.
[7] IS-QZSS, Quasi Zenith Satellite System Navigation Service Interface
Specifications for QZSS, Ver.1.1, July 31, 2009.
[8] Galileo OS Signal in Space ICD (OS SIS ICD), Issue 1.2, February 2014,
European Union.
[9] Global Navigation Satellite System GLONASS Interface Control Document,
Version 5.1, 2008.
[10] Specification for the Wide Area Augmentation System (WAAS), US Department
of Transportation, Federal Aviation Administration, DTFA01-96-C-00025, 2001.
[11] RTCM-SC104, RTCM Recommended Standards for Differential GNSS Service
(v.2.3), August 20, 2001.
[12] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
\"Radio Resource Control (RRC); Protocol specification\".
[13] 3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol Specification\".
[14] 3GPP TS 44.031: \"Location Services (LCS); Mobile Station (MS) - Serving
Mobile Location Centre (SMLC) Radio Resource LCS Protocol (RRLP)\".
[15] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
[16] 3GPP TS 36.211: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical Channels and Modulation\".
[17] 3GPP TS 36.214: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical layer -- Measurements\".
[18] 3GPP TS 36.133: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Requirements for support of radio resource management\".
[19] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[20] OMA-TS-LPPe-V1_0, LPP Extensions Specification, Open Mobile Alliance.
[21] 3GPP TS 36.101: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) radio transmission and reception\".
[22] ITU-T Recommendation X.691 (07/2002) \"Information technology - ASN.1
encoding rules: Specification of Packed Encoding Rules (PER)\" (Same as the
ISO/IEC International Standard 8825-2).
[23] BDS-SIS-ICD-2.0: \"BeiDou Navigation Satellite System Signal In Space
Interface Control Document Open Service Signal (Version 2.0)\", December 2013.
[24] ATIS-0500027: \"Recommendations for Establishing Wide Scale Indoor
Location Performance\", May 2015.
[25] Bluetooth Special Interest Group: \"Bluetooth Core Specification v4.2\",
December 2014.
[26] IEEE 802.11, Part 11: \"Wireless LAN Medium Access Control (MAC) and
Physical Layer (PHY) Specifications\".
[27] IETF RFC 6225, \"Dynamic Host Configuration Protocol Options for
Coordinate-Based Location Configuration Information\", July 2011.
[28] 3GPP TS 36.213: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical layer procedures\".
[29] \"Earth Gravitational Model 96 (EGM96)\", National Geospatial-
Intelligence Agency, NASA.
# 3 Definitions and Abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
[1], [2] and [3] apply. Other definitions are provided below.
**Anchor carrier:** In NB-IoT, a carrier where the UE assumes that
NPSS/NSSS/NPBCH/SIB-NB are transmitted.
**Location Server:** a physical or logical entity (e.g., E-SMLC or SUPL SLP)
that manages positioning for a target device by obtaining measurements and
other location information from one or more positioning units and providing
assistance data to positioning units to help determine this. A Location Server
may also compute or verify the final location estimate.
**NB-IoT:** NB-IoT allows access to network services via E-UTRA with a channel
bandwidth limited to 200 kHz.
**Reference Source:** a physical entity or part of a physical entity that
provides signals (e.g., RF, acoustic, infra-red) that can be measured (e.g.,
by a Target Device) in order to obtain the location of a Target Device.
**Target Device:** the device that is being positioned (e.g., UE or SUPL SET).
**Transmission Point (TP):** A **set of geographically co-located transmit
antennas for one cell, part of one cell or one PRS-only TP.** Transmission
Points can include base station (eNodeB) antennas, remote radio heads, a
remote antenna of a base station, an antenna of a PRS-only TP, etc. One cell
can be formed by one or multiple transmission points. For a homogeneous
deployment, each transmission point may correspond to one cell.
**Observed Time Difference Of Arrival (OTDOA):** The time interval that is
observed by a target device between the reception of downlink signals from two
different TPs. If a signal from TP 1 is received at the moment _t~1~_ , and a
signal from TP 2 is received at the moment _t~2~_ , the OTDOA is _t~2~_ \--
_t~1~_.
**PRS-only TP** : A TP which only transmits PRS signals for PRS-based TBS
positioning and is not associated with a cell.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply.
ADR Accumulated Delta-Range
A‑GNSS Assisted‑GNSS
AP Access Point
ARFCN Absolute Radio Frequency Channel Number
BDS BeiDou Navigation Satellite System
BSSID Basic Service Set Identifier
BTS Base Transceiver Station (GERAN)
CID Cell-ID (positioning method)
CNAV Civil Navigation
CRS Cell-specific Reference Signals
ECEF Earth-Centered, Earth-Fixed
ECGI Evolved Cell Global Identifier
ECI Earth-Centered-Inertial
E‑CID Enhanced Cell-ID (positioning method)
EGNOS European Geostationary Navigation Overlay Service
E-SMLC Enhanced Serving Mobile Location Centre
E-UTRAN Evolved Universal Terrestrial Radio Access Network
EOP Earth Orientation Parameters
EPDU External Protocol Data Unit
FDMA Frequency Division Multiple Access
FEC Forward Error Correction
FTA Fine Time Assistance
GAGAN GPS Aided Geo Augmented Navigation
GLONASS GLObal\'naya NAvigatsionnaya Sputnikovaya Sistema (Engl.: Global
Navigation Satellite System)
GNSS Global Navigation Satellite System
GPS Global Positioning System
ICD Interface Control Document
IOD Issue of Data
IS Interface Specification
LLA Latitude Longitude Altitude
LPP LTE Positioning Protocol
LPPa LTE Positioning Protocol Annex
LSB Least Significant Bit
MBS Metropolitan Beacon System
MO-LR Mobile Originated Location Request
MSAS Multi-functional Satellite Augmentation System
MSB Most Significant Bit
msd mean solar day
MT-LR Mobile Terminated Location Request
NAV Navigation
NB-IoT NarrowBand Internet of Things
NICT National Institute of Information and Communications Technology
NI-LR Network Induced Location Request
NPRS Narrowband Positioning Reference Signals
NRSRP Narrowband Reference Signal Received Power
NRSRQ Narrowband Reference Signal Received Quality
NTSC National Time Service Center of Chinese Academy of Sciences
OTDOA Observed Time Difference Of Arrival
PDU Protocol Data Unit
PRB Physical Resource Block
PRC Pseudo‑Range Correction
PRS Positioning Reference Signals
PZ-90 Parametry Zemli 1990 Goda -- Parameters of the Earth Year 1990
QZS Quasi Zenith Satellite
QZSS Quasi-Zenith Satellite System
QZST Quasi-Zenith System Time
RF Radio Frequency
RRC Range‑Rate Correction
> Radio Resource Control
RSRP Reference Signal Received Power
RSRQ Reference Signal Received Quality
RSTD Reference Signal Time Difference
RTT Round Trip Time
RU Russia
SBAS Space Based Augmentation System
SET SUPL Enabled Terminal
SFN System Frame Number
SLP SUPL Location Platform
SSID Service Set Identifier
SUPL Secure User Plane Location
SV Space Vehicle
TB Terrestrial Beacon
TBS Terrestrial Beacon System
TLM Telemetry
TOD Time Of Day
TOW Time Of Week
TP Transmission Point
UDRE User Differential Range Error
ULP User Plane Location Protocol
USNO US Naval Observatory
UT1 Universal Time No.1
UTC Coordinated Universal Time
WAAS Wide Area Augmentation System
WGS‑84 World Geodetic System 1984
WLAN Wireless Local Area Network
# 4 Functionality of Protocol
## 4.1 General
### 4.1.1 LPP Configuration
LPP is used point-to-point between a location server (E-SMLC or SLP) and a
target device (UE or SET) in order to position the target device using
position-related measurements obtained by one or more reference sources.
Figure 4.1.1-1 shows the configuration as applied to the control- and user-
plane location solutions for E-UTRAN (as defined in [2] and [3]).
NB-IoT is a non-backward compatible variant of E-UTRAN supporting a reduced
set of functionalities. In this specification, procedures and messages
specified for the UE equally apply to the UE in NB-IoT.
Figure 4.1.1-1: LPP Configuration for Control- and User-Plane Positioning in
E-UTRAN
### 4.1.2 LPP Sessions and Transactions
An LPP session is used between a Location Server and the target device in
order to obtain location related measurements or a location estimate or to
transfer assistance data. A single LPP session is used to support a single
location request (e.g., for a single MT-LR, MO-LR or NI-LR). Multiple LPP
sessions can be used between the same endpoints to support multiple different
location requests (as required by [3]). Each LPP session comprises one or more
LPP transactions, with each LPP transaction performing a single operation
(capability exchange, assistance data transfer, or location information
transfer). In E-UTRAN the LPP transactions are realized as LPP procedures. The
instigator of an LPP session will always instigate the first LPP transaction,
but subsequent transactions may be instigated by either end. LPP transactions
within a session may occur serially or in parallel. LPP transactions are
indicated at the LPP protocol level with a transaction ID in order to
associate messages with one another (e.g., request and response).
Messages within a transaction are linked by a common transaction identifier.
### 4.1.3 LPP Position Methods
Internal LPP positioning methods and associated signalling content are defined
in this specification.
This version of the specification defines OTDOA, A-GNSS, E-CID, Barometric
Sensor, TBS, WLAN, and Bluetooth positioning methods.
### 4.1.4 LPP Messages
Each LPP transaction involves the exchange of one or more LPP messages between
the location server and the target device. The general format of an LPP
message consists of a set of common fields followed by a body. The body (which
may be empty) contains information specific to a particular message type. Each
message type contains information specific to one or more positioning methods
and/or information common to all positioning methods.
The common fields are as follows:
* * *
Field **Role** Transaction ID Identify messages belonging to the same
transaction Transaction End Flag Indicate when a transaction (e.g. one with
periodic responses) has ended **Sequence Number** **Enable detection of a
duplicate LPP message at a receiver** Acknowledgement Enable an
acknowledgement to be requested and/or returned for any LPP message
* * *
NOTE: Use of the Transaction ID and Transaction End fields conform to the
procedures in clause 5 and are independent of the means used to transport LPP
messages (e.g., whether using a NAS MO-LR Request, NAS Generic Transport or
user-plane solution).
The following message types are defined:
\- Request Capabilities;
\- Provide Capabilities;
\- Request Assistance Data;
\- Provide Assistance Data;
\- Request Location Information;
\- Provide Location Information;
\- Abort;
\- Error.
## 4.2 Common LPP Session Procedure
The purpose of this procedure is to support an LPP session comprising a
sequence of LPP transactions. The procedure is described in Figure 4.2-1.
Figure 4.2-1 LPP Session Procedure
1\. Endpoint A, which may be either the target or the server, initiates an LPP
session by sending an LPP message for an initial LPP transaction _j_ to the
other endpoint B (which has an opposite role to A).
2\. Endpoints A and B may exchange further messages to continue the
transaction started in step 1.
3\. Either endpoint may instigate further transactions by sending additional
LPP messages.
4\. A session is terminated by a final transaction _N_ in which LPP messages
will be exchanged between the two endpoints.
Within each transaction, all constituent messages shall contain the same
transaction identifier. The last message sent in each transaction shall have
the IE _endTransaction_ set to TRUE. Transactions that occur in parallel shall
use different transaction IDs; transaction IDs for completed transactions may
be reused at any time after the final message of the previous transaction with
the same ID is known to have been received.
## 4.3 LPP Transport
### 4.3.1 Transport Layer Requirements
LPP requires reliable, in-sequence delivery of LPP messages from the
underlying transport layers. This section describes the transport capabilities
that are available within LPP. A UE implementing LPP for the control-plane
solution shall support LPP reliable transport (including all three of
duplicate detection, acknowledgement, and retransmission).
LPP reliable transport functionality is not used in the user-plane solution.
The following requirements in subclauses 4.3.2, 4.3.3, and 4.3.4 for LPP
reliable transport apply only when the capability is supported.
### 4.3.2 LPP Duplicate Detection
A sender shall include a sequence number in all LPP messages sent for a
particular location session. The sequence number shall be distinct for
different LPP messages sent in the same direction in the same location session
(e.g., may start at zero in the first LPP message and increase monotonically
in each succeeding LPP message). Sequence numbers used in the uplink and
downlink are independent (e.g., can be the same).
A receiver shall record the most recent received sequence number for each
location session. If a message is received carrying the same sequence number
as that last received for the associated location session, it shall be
discarded. Otherwise (i.e., if the sequence number is different or if no
sequence number was previously received or if no sequence number is included),
the message shall be processed.
Sending and receiving sequence numbers shall be deleted in a server when the
associated location session is terminated and shall be deleted in a target
device when there has been no activity for a particular location session for
10 minutes.
NOTE: For LPP control-plane use, a target device can be aware of a location
session from information provided at the NAS level for downlink transport of
an LPP message.
### 4.3.3 LPP Acknowledgement
#### 4.3.3.1 General
Each LPP message may carry an acknowledgement request and/or an
acknowledgement indicator. A LPP message including an acknowledgement request
(i.e., that include the IE _ackRequested_ set to TRUE) shall also include a
sequence number. Upon reception of an LPP message which includes the IE
_ackRequested_ set to TRUE, a receiver returns an LPP message with an
acknowledgement response (i.e., that includes the _ackIndicator_ IE set to the
same sequence number of the message being acknowledged). An acknowledgement
response may contain no LPP message body (in which case only the sequence
number being acknowledged is significant); alternatively, the acknowledgement
may be sent in an LPP message along with an LPP message body. An
acknowledgement is returned for each received LPP message that requested an
acknowledgement including any duplicate(s). Once a sender receives an
acknowledgement for an LPP message, and provided any included sequence number
is matching, it is permitted to send the next LPP message. No message
reordering is needed at the receiver since this stop-and-wait method of
sending ensures that messages normally arrive in the correct order.
When an LPP message is transported via a NAS MO-LR request, the message does
not request an acknowledgement.
#### 4.3.3.2 Procedure related to Acknowledgement
Figure 4.3.3.2-1 shows the procedure related to acknowledgement.
Figure 4.3.3.2-1: LPP Acknowledgement procedure
1\. Endpoint A sends an LPP message _N_ to Endpoint B which includes the IE
_ackRequested_ set to TRUE and a sequence number.
2\. If LPP message _N_ is received and Endpoint B is able to decode the
_ackRequested_ value and sequence number, Endpoint B shall return an
acknowledgement for message _N_. The acknowledgement shall contain the IE
_ackIndicator_ set to the same sequence number as that in message _N_.
3\. When the acknowledgement for LPP message _N_ is received and provided the
included _ackIndicator_ IE matches the sequence number sent in message _N_ ,
Endpoint A sends the next LPP message _N+1_ to Endpoint B when this message is
available.
### 4.3.4 LPP Retransmission
#### 4.3.4.1 General
This capability builds on the acknowledgement and duplicate detection
capabilities. When an LPP message which requires acknowledgement is sent and
not acknowledged, it is resent by the sender following a timeout period up to
three times. If still unacknowledged after that, the sender aborts all LPP
activity for the associated session. The timeout period is determined by the
sender implementation but shall not be less than a minimum value of 250ms.
In addition, for NB-IoT the timeout period may be determined by the sender
implementation based on e.g., the coverage level of the UE.
#### 4.3.4.2 Procedure related to Retransmission
Figure 4.3.4.2-1 shows the procedure related to retransmission when combined
with acknowledgement and duplicate detection.
Figure 4.3.4.2-1: LPP Retransmission procedure
1\. Endpoint A sends an LPP message _N_ to Endpoint B for a particular
location session and includes a request for acknowledgement along with a
sequence number.
2\. If LPP message _N_ is received and Endpoint B is able to decode the
_ackRequested_ value and sequence number (regardless of whether the message
body can be correctly decoded), Endpoint B shall return an acknowledgement for
message _N_. If the acknowledgement is received by Endpoint A (such that the
acknowledged message can be identified and sequence numbers are matching),
Endpoint A skips steps 3 and 4.
3\. If the acknowledgement in step 2 is not received after a timeout period,
Endpoint A shall retransmit LPP message _N_ and shall include the same
sequence number as in step 1.
4\. If LPP message _N_ in step 3 is received and Endpoint B is able to decode
the _ackRequested_ value and sequence number (regardless of whether the
message body can be correctly decoded and whether or not the message is
considered a duplicate), Endpoint B shall return an acknowledgement. Steps 3
may be repeated one or more times if the acknowledgement in step 4 is not
received after a timeout period by Endpoint A. If the acknowledgement in step
4 is still not received after sending three retransmissions, Endpoint A shall
abort all procedures and activity associated with LPP support for the
particular location session.
5\. Once an acknowledgement in step 2 or step 4 is received, Endpoint A sends
the next LPP message _N+1_ for the location session to Endpoint B when this
message is available.
### 4.3.5 LPP Message Segmentation
An LPP message body may be sent in several shorter LPP messages instead of one
long LPP message to deliver a large amount of information (e.g., in case the
LPP message size exceeds the maximum message size supported by lower layers).
When a sender employs LPP message segmentation, the sender shall include the
IE _SegmentationInfo_ in each LPP message segment. The sender shall indicate
in all but the final message segment that more messages are on the way.
When a receiver receives an LPP message indicating that more messages are on
the way, the receiver may store the LPP message. If the receiver receives a
subsequent LPP message for the same session and transaction ID, the receiver
shall assume that the new LPP message continues the segmentation of the
earlier message and may store the new message if the new message indicates
that more messages are on the way. If the new message indicates that no more
messages are on the way, the receiver shall assume that message segmentation
is complete and shall process the new message and any stored message segments
for the same session and transaction ID.
The reliable transport rules specified in sub-clause 4.3.2, 4.3.3, and 4.3.4
apply to each individual LPP message segment, independently of the value of
the IE _SegmentationInfo_.
The rules for setting the common fields of the LPP message specified in sub-
clause 4.1.4 (Transaction ID, Transaction End Flag, Sequence Number,
Acknowledgment) apply to each individual LPP message segment, independently of
the value of the IE _SegmentationInfo_.
Figure 4.3.5-1: LPP Message Segmentation procedure
1\. Endpoint A sends an LPP message to Endpoint B for a particular location
session and includes the IE _SegmentationInfo_ set to _moreMessagesOnTheWay_
to indicate that this is one of many LPP message segments used to deliver the
entire LPP message body.
2 Endpoint A may send one or more additional LPP messages to Endpoint B with
the IE _SegmentationInfo_ set to _moreMessagesOnTheWay_ to continue delivering
the segmented LPP message _._
3\. Endpoint A sends the final LPP message segment to Endpoint B and includes
the IE _SegmentationInfo_ set to _noMoreMessages_ to indicate that this is the
final LPP message segment. Endpoint B assumes that the complete LPP message
body has been received.
# 5 LPP Procedures
## 5.1 Procedures related to capability transfer
The purpose of the procedures that are grouped together in this section is to
enable the transfer of capabilities from the target device to the server.
Capabilities in this context refer to positioning and protocol capabilities
related to LPP and the positioning methods supported by LPP.
These procedures instantiate the Capability Transfer transaction from 3GPP TS
36.305 [2].
### 5.1.1 Capability Transfer procedure
The Capability Transfer procedure is shown in Figure 5.1.1-1.
Figure 5.1.1-1: LPP Capability Transfer procedure
1\. The server sends a _RequestCapabilities_ message to the target. The server
may indicate the types of capability needed.
2\. The target responds with a _ProvideCapabilities_ message to the server.
The capabilities shall correspond to any capability types specified in step 1.
This message shall include the _endTransaction_ IE set to TRUE.
### 5.1.2 Capability Indication procedure
The Capability Indication procedure allows the target to provide unsolicited
capabilities to the server and is shown in Figure 5.1.2-1.
Figure 5.1.2-1: LPP Capability Indication procedure
1\. The target sends a _ProvideCapabilities_ message to the server. This
message shall include the _endTransaction_ IE set to TRUE.
### 5.1.3 Reception of LPP Request Capabilities
Upon receiving a _RequestCapabilities_ message, the target device shall
generate a _ProvideCapabilities_ message as a response.
The target device shall:
1> for each positioning method for which a request for capabilities is
included in the message:
2> if the target device supports this positioning method:
3> include the capabilities of the device for that supported positioning
method in the response message;
1> set the IE _LPP-TransactionID_ in the response message to the same value as
the IE _LPP-TransactionID_ in the received message;
1> deliver the response message to lower layers for transmission.
### 5.1.4 Transmission of LPP Provide Capabilities
When triggered to transmit a _ProvideCapabilities_ message, the target device
shall:
1> for each positioning method whose capabilities are to be indicated:
2> set the corresponding IE to include the device\'s capabilities;
2> if OTDOA capabilities are to be indicated:
3> include the IE _supportedBandListEUTRA_ ;
1> deliver the response to lower layers for transmission.
## 5.2 Procedures related to Assistance Data Transfer
The purpose of the procedures in this section is to enable the target to
request assistance data from the server to assist in positioning, and to
enable the server to transfer assistance data to the target in the absence of
a request.
These procedures instantiate the Assistance Data Transfer transaction from
3GPP TS 36.305 [2].
### 5.2.1 Assistance Data Transfer procedure
The Assistance Data Transfer procedure is shown in Figure 5.2.1-1.
Figure 5.2.1-1: LPP Assistance data transfer procedure
1\. The target sends a _RequestAssistanceData_ message to the server.
2\. The server responds with a _ProvideAssistanceData_ message to the target
containing assistance data. The transferred assistance data should match or be
a subset of the assistance data requested in step 1. The server may also
provide any not requested information that it considers useful to the target.
If step 3 does not occur, this message shall set the _endTransaction_ IE to
TRUE.
3\. The server may transmit one or more additional _ProvideAssistanceData_
messages to the target containing further assistance data. The transferred
assistance data should match or be a subset of the assistance data requested
in step 1. The server may also provide any not requested information that it
considers useful to the target. The last message shall include the
_endTransaction_ IE set to TRUE.
### 5.2.2 Assistance Data Delivery procedure
The Assistance Data Delivery procedure allows the server to provide
unsolicited assistance data to the target and is shown in Figure 5.2.2-1.
Figure 5.2.2-1: LPP Assistance data transfer procedure
1\. The server sends a _ProvideAssistanceData_ message to the target
containing assistance data. If step 2 does not occur, this message shall set
the _endTransaction_ IE to TRUE.
2\. The server may transmit one or more additional _ProvideAssistanceData_
messages to the target containing additional assistance data. The last message
shall include the _endTransaction_ IE set to TRUE.
### 5.2.3 Transmission of LPP Request Assistance Data
When triggered to transmit a _RequestAssistanceData_ message, the target
device shall:
1> set the IEs for the positioning-method-specific request for assistance data
to request the data indicated by upper layers.
### 5.2.4 Reception of LPP Provide Assistance Data
Upon receiving a _ProvideAssistanceData_ message, the target device shall:
1> for each positioning method contained in the message:
2> deliver the related assistance data to upper layers.
## 5.3 Procedures related to Location Information Transfer
The purpose of the procedures in this section is to enable the server to
request location measurement data and/or a location estimate from the target,
and to enable the target to transfer location measurement data and/or a
location estimate to a server in the absence of a request.
These procedures instantiate the Location Information Transfer transaction in
3GPP TS 36.305 [2].
NOTE: The service layer (e.g. NAS or OMA SUPL ULP) would be used to transfer
information associated with a location request from a target to a server (MO-
LR).
### 5.3.1 Location Information Transfer procedure
The Location Information Transfer procedure is shown in Figure 5.3.1-1.
Figure 5.3.1-1: LPP Location Information transfer procedure
1\. The server sends a _RequestLocationInformation_ message to the target to
request location information, indicating the type of location information
needed and potentially the associated QoS.
2\. The target sends a _ProvideLocationInformation_ message to the server to
transfer location information. The location information transferred should
match or be a subset of the location information requested in step 1 unless
the server explicitly allows additional location information. If step 3 does
not occur, this message shall set the _endTransaction_ IE to TRUE.
3\. If requested in step 1, the target sends additional
_ProvideLocationInformation_ messages to the server to transfer location
information. The location information transferred should match or be a subset
of the location information requested in step 1 unless the server explicitly
allows additional location information. The last message shall include the
_endTransaction_ IE set to TRUE.
### 5.3.2 Location Information Delivery procedure
The Location Information Delivery allows the target to provide unsolicited
location information to the server. The procedure is shown in Figure 5.3.2-1.
Figure 5.3.2-1: LPP Location Information Delivery procedure
1\. The target sends a _ProvideLocationInformation_ message to the server to
transfer location information. If step 2 does not occur, this message shall
set the _endTransaction_ IE to TRUE.
2\. The target may send one or more additional _ProvideLocationInformation_
messages to the server containing additional location information data. The
last message shall include the _endTransaction_ IE set to TRUE.
### 5.3.3 Reception of Request Location Information
Upon receiving a _RequestLocationInformation_ message, the target device
shall:
1> if the requested information is compatible with the target device
capabilities and configuration:
2> include the requested information in a _ProvideLocationInformation_
message;
2> set the IE _LPP-TransactionID_ in the response to the same value as the IE
_LPP-TransactionID_ in the received message;
2> deliver the _ProvideLocationInformation_ message to lower layers for
transmission.
1> otherwise:
2> if one or more positioning methods are included that the target device does
not support:
3> continue to process the message as if it contained only information for the
supported positioning methods;
3> handle the signaling content of the unsupported positioning methods by LPP
error detection as in 5.4.3.
### 5.3.4 Transmission of Provide Location Information
When triggered to transmit _ProvideLocationInformation_ message, the target
device shall:
1> for each positioning method contained in the message:
2> set the corresponding IE to include the available location information;
1> deliver the response to lower layers for transmission.
## 5.4 Error Handling Procedures
### 5.4.1 General
This sub-clause describes how a receiving entity (target device or location
server) behaves in cases when it receives erroneous or unexpected data or
detects that certain data are missing.
### 5.4.2 Procedures related to Error Indication
Figure 5.4.2-1 shows the Error indication procedure.
Figure 5.4.2-1: LPP Error Indication procedure
1\. Endpoint A sends an LPP message to Endpoint B.
2\. Endpoint B determines that the LPP message in step 1 contains an error.
Endpoint B returns an _Error_ message to Endpoint A indicating the error or
errors and discards the message in step 1. If Endpoint B is able to determine
that the erroneous LPP message in step 1 is an LPP Error or Abort Message,
Endpoint B discards the message in step 1 without returning an _Error_ message
to Endpoint A.
### 5.4.3 LPP Error Detection
Upon receiving any LPP message, the receiving entity shall attempt to decode
the message and verify the presence of any errors and:
1> if decoding errors are encountered:
2> if the receiver can not determine that the received message is an LPP
_Error_ or _Abort_ message:
3> return an LPP _Error_ message to the sender and include the received _LPP-
TransactionID_ , if this was decoded, and type of error;
3> if the receiver can determine the session and the _LPP-TransactionID_ and
the received message includes the IE _SegmentationInfo_ and the receiver has
previously stored message segments for this session and _LPP-TransactionID_ :
4> discard all stored LPP message segments for this session and _LPP-
TransactionID_ ;
3> discard the received message and stop the error detection procedure;
1> if the message is a duplicate of a previously received message:
2> discard the message and stop the error detection procedure;
1> if the _LPP-TransactionID_ matches the _LPP-TransactionID_ for a procedure
that is still ongoing for the same session and the message type is invalid for
the current state of the procedure:
2> abort the ongoing procedure;
2> return an LPP _Error_ message to the sender and include the received
transaction ID and type of error;
2> if the message includes the IE _SegmentationInfo_ and the receiver has
previously stored message segments for this session and _LPP-TransactionID_ :
3> discard all stored LPP message segments for this session and _LPP-
TransactionID;_
2> discard the message and stop the error detection procedure;
1> if the message includes the IE _SegmentationInfo_ :
2> if the receiver has previously stored LPP message segments for this session
and _LPP-TransactionID_ :
> 3> if the received message type is different to the stored message type:
>
> 4> return an LPP _Error_ message to the sender and include the received
> transaction ID and type of error;
>
> 4> discard the message and all stored LPP message segments for this session
> and _LPP-TransactionID_ and stop the error detection procedure;
2> if the IE _SegmentationInfo_ has the value _moreMessagesOnTheWay_ :
3> store the received message;
> NOTE: As an implementation option, the receiver of an LPP Provide Assistance
> Data or LPP Provide Location Information message may process the received
> message segment instead of storing the message.
2> if the IE _SegmentationInfo_ has the value _noMoreMessages_ :
3> continue error detection for the received message and any stored LPP
message segments for this session and _LPP-TransactionID_ ;
1> if the message type is an LPP _RequestCapabilities_ and some of the
requested information is not supported:
2> return any information that can be provided in a normal response.
1> if the message type is an LPP _RequestAssistanceData_ or
_RequestLocationInformation_ and some or all of the requested information is
not supported:
2> return any information that can be provided in a normal response, which
includes indications on other information that is not supported.
### 5.4.4 Reception of an LPP Error Message
Upon receiving an _Error_ message, a device shall:
1> abort any ongoing procedure associated with the _LPP-TransactionID_ if
included in the received message.
The device may:
1> restart the aborted procedure taking into consideration the returned error
information.
## 5.5 Abort Procedure
### 5.5.1 General
The purpose of the abort procedure is to allow the target device or location
server to abort an ongoing procedure due to some unexpected event (e.g.,
cancellation of a location request by an LCS client). It can also be used to
stop an ongoing procedure (e.g., periodic location reporting from the target
device).
### 5.5.2 Procedures related to Abort
Figure 5.5.2-1 shows the Abort procedure.
Figure 5.5.2-1: LPP Abort procedure
1\. A procedure P is ongoing between endpoints A and B.
2\. Endpoint A determines that the procedure must be aborted and sends an
_Abort_ message to Endpoint B carrying the transaction ID for procedure P.
Endpoint B aborts procedure P.
### 5.5.3 Reception of an LPP Abort Message
Upon receiving an _Abort_ message, a device shall:
1> abort any ongoing procedure associated with the transaction ID indicated in
the message.
# 6 Information Element Abstract Syntax Definition
## 6.1 General
The contents of each LPP message is specified in sub-clause 6.2 using ASN.1 to
specify the message syntax and using tables when needed to provide further
detailed information about the fields specified in the message syntax.
The ASN.1 in this section uses the same format and coding conventions as
described in Annex A of [12].
Transfer syntax for LPP messages is derived from their ASN.1 definitions by
use of Basic Packed Encoding Rules (BASIC-PER), Unaligned Variant, as
specified in ITU-T Rec. X.691 [22]. The encoded LPP message always contains a
multiple of 8 bits.
Transfer syntax for LPP IEs is derived from their ASN.1 definitions by use of
Basic Packed Encoding Rules (BASIC-PER), Unaligned Variant, as specified in
ITU-T Rec. X.691 [22]. The encoded LPP IE always contains a multiple of 8
bits. This applies when a single LPP IE is encoded as the basic production,
i.e. for other purposes than encoding the LPP IE within an LPP message.
The need for fields to be present in a message or an abstract type, i.e., the
ASN.1 fields that are specified as OPTIONAL in the abstract notation (ASN.1),
is specified by means of comment text tags attached to the OPTIONAL statement
in the abstract syntax. The meaning of each tag is specified in table 6.1-1.
These tags are used in the downlink (server to target) direction only.
Table 6.1-1: Meaning of abbreviations used to specify the need for fields to
be present
+---------------------+-----------------------------------------------+ | Abbreviation | Meaning | +---------------------+-----------------------------------------------+ | Cond _conditionTag_ | _Conditionally present_ | | | | | | A field for which the need is specified by | | | means of conditions. For each _conditionTag_ , | | | the need is specified in a tabular form | | | following the ASN.1 segment. In case, | | | according to the conditions, a field is not | | | present, the target takes no action and where | | | applicable shall continue to use the existing | | | value (and/or the associated functionality) | | | unless explicitly stated otherwise in the | | | description of the field itself. | +---------------------+-----------------------------------------------+ | Need OP | _Optionally present_ | | | | | | A field that is optional to signal. For | | | downlink messages, the target is not required | | | to take any special action on absence of the | | | field beyond what is specified in the | | | procedural text or the field description | | | table following the ASN.1 segment. The target | | | behaviour on absence should be captured | | | either in the procedural text or in the field | | | description. | +---------------------+-----------------------------------------------+ | Need ON | _Optionally present, No action_ | | | | | | A field that is optional to signal. _If the | | | message is received by the_ target _, and_ in | | | case the field is absent, the target takes no | | | action and where applicable shall continue to | | | use the existing value (and/or the associated | | | functionality). | +---------------------+-----------------------------------------------+ | Need OR | _Optionally present, Release_ | | | | | | A field that is optional to signal. _If the | | | message is received by the_ target _, and_ in | | | case the field is absent, the target shall | | | discontinue/ stop using/ delete any existing | | | value (and/ or the associated functionality). | +---------------------+-----------------------------------------------+
When specifying information elements which are to be represented by BIT
STRINGs, if not otherwise specifically stated in the field description of the
concerned IE or elsewhere, the following principle applies with regards to the
ordering of bits:
\- The first bit (leftmost bit) contains the most significant bit (MSB);
\- the last bit (rightmost bit) contains the least significant bit (LSB).
## 6.2 LPP PDU Structure
#### _\-- LPP-PDU-Definitions_
This ASN.1 segment is the start of the LPP PDU definitions.
\-- ASN1START
LPP-PDU-Definitions {
itu-t (0) identified-organization (4) etsi (0) mobileDomain (0)
eps-Access (21) modules (3) lpp (7) version1 (1) lpp-PDU-Definitions (1) }
DEFINITIONS AUTOMATIC TAGS ::=
BEGIN
\-- ASN1STOP
#### _\-- LPP-Message_
The _LPP-Message_ provides the complete set of information for an invocation
or response pertaining to an LPP transaction.
\-- ASN1START
LPP-Message ::= SEQUENCE {
transactionID LPP-TransactionID OPTIONAL, -- Need ON
endTransaction BOOLEAN,
sequenceNumber SequenceNumber OPTIONAL, -- Need ON
acknowledgement Acknowledgement OPTIONAL, -- Need ON
lpp-MessageBody LPP-MessageBody OPTIONAL -- Need ON
}
SequenceNumber ::= INTEGER (0..255)
Acknowledgement ::= SEQUENCE {
ackRequested BOOLEAN,
ackIndicator SequenceNumber OPTIONAL
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_LPP-Message_ field descriptions** | +----------------------------------------------------------------------+ | **_transactionID_** | | | | This field is omitted if an _lpp-MessageBody_ is not present (i.e. | | in an LPP message sent only to acknowledge a previously received | | message) or if it is not available to the transmitting entity (e.g., | | in an _LPP-Error_ message triggered by a message that could not be | | parsed). If present, this field shall be ignored at a receiver in an | | LPP message for which the _lpp-MessageBody_ is not present. | +----------------------------------------------------------------------+ | **_endTransaction_** | | | | This field indicates whether an LPP message is the last message | | carrying an _lpp-MessageBody_ in a transaction (TRUE) or not last | | (FALSE). When LPP message segmentation is used, only the final LPP | | message segment may indicate the end of the transaction. | +----------------------------------------------------------------------+ | **_sequenceNumber_** | | | | This field may be included when LPP operates over the control plane | | and an _lpp-MessageBody_ is included but shall be omitted otherwise. | +----------------------------------------------------------------------+ | **_acknowledgement_** | | | | This field is included in an LPP acknowledgement and in any LPP | | message requesting an acknowledgement when LPP operates over the | | control plane and is omitted otherwise. | +----------------------------------------------------------------------+ | **_ackRequested_** | | | | This field indicates whether an LPP acknowledgement is requested | | (TRUE) or not (FALSE). A value of TRUE may only be included when an | | _lpp-MessageBody_ is included. | +----------------------------------------------------------------------+ | **_ackIndicator_** | | | | This field indicates the sequence number of the message being | | acknowledged. | +----------------------------------------------------------------------+ | **_lpp-MessageBody_** | | | | This field may be omitted in case the message is sent only to | | acknowledge a previously received message. | +----------------------------------------------------------------------+
#### _\-- LPP-MessageBody_
The _LPP-MessageBody_ identifies the type of an LPP message and contains all
LPP information specifically associated with that type.
\-- ASN1START
LPP-MessageBody ::= CHOICE {
c1 CHOICE {
requestCapabilities RequestCapabilities,
provideCapabilities ProvideCapabilities,
requestAssistanceData RequestAssistanceData,
provideAssistanceData ProvideAssistanceData,
requestLocationInformation RequestLocationInformation,
provideLocationInformation ProvideLocationInformation,
abort Abort,
error Error,
spare7 NULL, spare6 NULL, spare5 NULL, spare4 NULL,
spare3 NULL, spare2 NULL, spare1 NULL, spare0 NULL
},
messageClassExtension SEQUENCE {}
}
\-- ASN1STOP
#### _\-- LPP-TransactionID_
The _LPP-TransactionID_ identifies a particular LPP transaction and the
initiator of the transaction.
\-- ASN1START
LPP-TransactionID ::= SEQUENCE {
initiator Initiator,
transactionNumber TransactionNumber,
...
}
Initiator ::= ENUMERATED {
locationServer,
targetDevice,
...
}
TransactionNumber ::= INTEGER (0..255)
\-- ASN1STOP
## 6.3 Message Body IEs
#### \-- _RequestCapabilities_
The _RequestCapabilities_ message body in a LPP message is used by the
location server to request the target device capability information for LPP
and the supported individual positioning methods.
\-- ASN1START
RequestCapabilities ::= SEQUENCE {
criticalExtensions CHOICE {
c1 CHOICE {
requestCapabilities-r9 RequestCapabilities-r9-IEs,
spare3 NULL, spare2 NULL, spare1 NULL
},
criticalExtensionsFuture SEQUENCE {}
}
}
RequestCapabilities-r9-IEs ::= SEQUENCE {
commonIEsRequestCapabilities CommonIEsRequestCapabilities OPTIONAL, -- Need ON
a-gnss-RequestCapabilities A-GNSS-RequestCapabilities OPTIONAL, -- Need ON
otdoa-RequestCapabilities OTDOA-RequestCapabilities OPTIONAL, -- Need ON
ecid-RequestCapabilities ECID-RequestCapabilities OPTIONAL, -- Need ON
epdu-RequestCapabilities EPDU-Sequence OPTIONAL, -- Need ON
...,
[[ sensor-RequestCapabilities-r13 Sensor-RequestCapabilities-r13 OPTIONAL, --
Need ON
tbs-RequestCapabilities-r13 TBS-RequestCapabilities-r13 OPTIONAL, -- Need ON
wlan-RequestCapabilities-r13 WLAN-RequestCapabilities-r13 OPTIONAL, -- Need ON
bt-RequestCapabilities-r13 BT-RequestCapabilities-r13 OPTIONAL -- Need ON
]]
}
\-- ASN1STOP
#### \-- _ProvideCapabilities_
The _ProvideCapabilities_ message body in a LPP message indicates the LPP
capabilities of the target device to the location server.
\-- ASN1START
ProvideCapabilities ::= SEQUENCE {
criticalExtensions CHOICE {
c1 CHOICE {
provideCapabilities-r9 ProvideCapabilities-r9-IEs,
spare3 NULL, spare2 NULL, spare1 NULL
},
criticalExtensionsFuture SEQUENCE {}
}
}
ProvideCapabilities-r9-IEs ::= SEQUENCE {
commonIEsProvideCapabilities CommonIEsProvideCapabilities OPTIONAL,
a-gnss-ProvideCapabilities A-GNSS-ProvideCapabilities OPTIONAL,
otdoa-ProvideCapabilities OTDOA-ProvideCapabilities OPTIONAL,
ecid-ProvideCapabilities ECID-ProvideCapabilities OPTIONAL,
epdu-ProvideCapabilities EPDU-Sequence OPTIONAL,
...,
[[ sensor-ProvideCapabilities-r13 Sensor-ProvideCapabilities-r13 OPTIONAL,
tbs-ProvideCapabilities-r13 TBS-ProvideCapabilities-r13 OPTIONAL,
wlan-ProvideCapabilities-r13 WLAN-ProvideCapabilities-r13 OPTIONAL,
bt-ProvideCapabilities-r13 BT-ProvideCapabilities-r13 OPTIONAL
]]
}
\-- ASN1STOP
#### \-- _RequestAssistanceData_
The _RequestAssistanceData_ message body in a LPP message is used by the
target device to request assistance data from the location server.
\-- ASN1START
RequestAssistanceData ::= SEQUENCE {
criticalExtensions CHOICE {
c1 CHOICE {
requestAssistanceData-r9 RequestAssistanceData-r9-IEs,
spare3 NULL, spare2 NULL, spare1 NULL
},
criticalExtensionsFuture SEQUENCE {}
}
}
RequestAssistanceData-r9-IEs ::= SEQUENCE {
commonIEsRequestAssistanceData CommonIEsRequestAssistanceData OPTIONAL,
a-gnss-RequestAssistanceData A-GNSS-RequestAssistanceData OPTIONAL,
otdoa-RequestAssistanceData OTDOA-RequestAssistanceData OPTIONAL,
epdu-RequestAssistanceData EPDU-Sequence OPTIONAL,
...,
[[ sensor-RequestAssistanceData-r14
Sensor-RequestAssistanceData-r14 OPTIONAL,
tbs-RequestAssistanceData-r14 TBS-RequestAssistanceData-r14 OPTIONAL,
wlan-RequestAssistanceData-r14 WLAN-RequestAssistanceData-r14 OPTIONAL
]]
}
\-- ASN1STOP
#### \-- _ProvideAssistanceData_
The _ProvideAssistanceData_ message body in a LPP message is used by the
location server to provide assistance data to the target device either in
response to a request from the target device or in an unsolicited manner.
\-- ASN1START
ProvideAssistanceData ::= SEQUENCE {
criticalExtensions CHOICE {
c1 CHOICE {
provideAssistanceData-r9 ProvideAssistanceData-r9-IEs,
spare3 NULL, spare2 NULL, spare1 NULL
},
criticalExtensionsFuture SEQUENCE {}
}
}
ProvideAssistanceData-r9-IEs ::= SEQUENCE {
commonIEsProvideAssistanceData CommonIEsProvideAssistanceData OPTIONAL, \--
Need ON
a-gnss-ProvideAssistanceData A-GNSS-ProvideAssistanceData OPTIONAL, -- Need ON
otdoa-ProvideAssistanceData OTDOA-ProvideAssistanceData OPTIONAL, -- Need ON
epdu-Provide-Assistance-Data EPDU-Sequence OPTIONAL, -- Need ON
...,
[[
sensor-ProvideAssistanceData-r14 Sensor-ProvideAssistanceData-r14 OPTIONAL, --
Need ON
tbs-ProvideAssistanceData-r14 TBS-ProvideAssistanceData-r14 OPTIONAL, \-- Need
ON
wlan-ProvideAssistanceData-r14 WLAN-ProvideAssistanceData-r14 OPTIONAL \--
Need ON
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_ProvideAssistanceData field descriptions_** | +----------------------------------------------------------------------+ | **_commonIEsProvideAssistanceData_** | | | | This IE is provided for future extensibility and should not be | | included in this version of the protocol. | +----------------------------------------------------------------------+
#### \-- _RequestLocationInformation_
The _RequestLocationInformation_ message body in a LPP message is used by the
location server to request positioning measurements or a position estimate
from the target device.
\-- ASN1START
RequestLocationInformation ::= SEQUENCE {
criticalExtensions CHOICE {
c1 CHOICE {
requestLocationInformation-r9 RequestLocationInformation-r9-IEs,
spare3 NULL, spare2 NULL, spare1 NULL
},
criticalExtensionsFuture SEQUENCE {}
}
}
RequestLocationInformation-r9-IEs ::= SEQUENCE {
commonIEsRequestLocationInformation
CommonIEsRequestLocationInformation OPTIONAL, -- Need ON
a-gnss-RequestLocationInformation A-GNSS-RequestLocationInformation OPTIONAL,
-- Need ON
otdoa-RequestLocationInformation OTDOA-RequestLocationInformation OPTIONAL, --
Need ON
ecid-RequestLocationInformation ECID-RequestLocationInformation OPTIONAL, --
Need ON
epdu-RequestLocationInformation EPDU-Sequence OPTIONAL, -- Need ON
...,
[[
sensor-RequestLocationInformation-r13
Sensor-RequestLocationInformation-r13
OPTIONAL, -- Need ON
tbs-RequestLocationInformation-r13 TBS-RequestLocationInformation-r13
OPTIONAL, -- Need ON
wlan-RequestLocationInformation-r13 WLAN-RequestLocationInformation-r13
OPTIONAL, -- Need ON
bt-RequestLocationInformation-r13 BT-RequestLocationInformation-r13 OPTIONAL
-- Need ON
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _RequestLocationInformation field descriptions_ | +----------------------------------------------------------------------+ | **_commonIEsRequestLocationInformation_** | | | | This field specifies the location information type requested by the | | location server and optionally other configuration information | | associated with the requested location information. This field | | should always be included in this version of the protocol. | +----------------------------------------------------------------------+
#### \-- _ProvideLocationInformation_
The _ProvideLocationInformation_ message body in a LPP message is used by the
target device to provide positioning measurements or position estimates to the
location server.
\-- ASN1START
ProvideLocationInformation ::= SEQUENCE {
criticalExtensions CHOICE {
c1 CHOICE {
provideLocationInformation-r9 ProvideLocationInformation-r9-IEs,
spare3 NULL, spare2 NULL, spare1 NULL
},
criticalExtensionsFuture SEQUENCE {}
}
}
ProvideLocationInformation-r9-IEs ::= SEQUENCE {
commonIEsProvideLocationInformation
CommonIEsProvideLocationInformation OPTIONAL,
a-gnss-ProvideLocationInformation A-GNSS-ProvideLocationInformation OPTIONAL,
otdoa-ProvideLocationInformation OTDOA-ProvideLocationInformation OPTIONAL,
ecid-ProvideLocationInformation ECID-ProvideLocationInformation OPTIONAL,
epdu-ProvideLocationInformation EPDU-Sequence OPTIONAL,
...,
[[
sensor-ProvideLocationInformation-r13
Sensor-ProvideLocationInformation-r13
OPTIONAL,
tbs-ProvideLocationInformation-r13 TBS-ProvideLocationInformation-r13
OPTIONAL,
wlan-ProvideLocationInformation-r13 WLAN-ProvideLocationInformation-r13
OPTIONAL,
bt-ProvideLocationInformation-r13 BT-ProvideLocationInformation-r13 OPTIONAL
]]
}
\-- ASN1STOP
#### _\-- Abort_
The _Abort_ message body in a LPP message carries a request to abort an
ongoing LPP procedure.
\-- ASN1START
Abort ::= SEQUENCE {
criticalExtensions CHOICE {
c1 CHOICE {
abort-r9 Abort-r9-IEs,
spare3 NULL, spare2 NULL, spare1 NULL
},
criticalExtensionsFuture SEQUENCE {}
}
}
Abort-r9-IEs ::= SEQUENCE {
commonIEsAbort CommonIEsAbort OPTIONAL, -- Need ON
...,
epdu-Abort EPDU-Sequence OPTIONAL -- Need ON
}
\-- ASN1STOP
#### _\-- Error_
The _Error_ message body in a LPP message carries information concerning a LPP
message that was received with errors.
\-- ASN1START
Error ::= CHOICE {
error-r9 Error-r9-IEs,
criticalExtensionsFuture SEQUENCE {}
}
Error-r9-IEs ::= SEQUENCE {
commonIEsError CommonIEsError OPTIONAL, -- Need ON
...,
epdu-Error EPDU-Sequence OPTIONAL -- Need ON
}
\-- ASN1STOP
## 6.4 Common IEs
Common IEs comprise IEs that are applicable to more than one LPP positioning
method.
### 6.4.1 Common Lower-Level IEs
#### \-- _AccessTypes_
The IE _AccessTypes_ is used to indicate several cellular access types using a
bit map.
\-- ASN1START
AccessTypes ::= SEQUENCE {
accessTypes BIT STRING { eutra (0),
utra (1),
gsm (2),
nb-iot (3) } (SIZE (1..8)),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _AccessTypes field descriptions_ | +----------------------------------------------------------------------+ | **_accessTypes_** | | | | This field specifies the cellular access type(s). This is | | represented by a bit string, with a one‑value at the bit position | | means the particular access type is addressed; a zero‑value means | | not addressed. | +----------------------------------------------------------------------+
#### _\--_ _ARFCN-ValueEUTRA_
The IEs _ARFCN-ValueEUTRA and ARFCN-ValueEUTRA-v9a0_ are _used to indicate the
ARFCN of the E-UTRA carrier frequency, as defined in [12]._
\-- ASN1START
ARFCN-ValueEUTRA ::= INTEGER (0..maxEARFCN)
ARFCN-ValueEUTRA-v9a0 ::= INTEGER (maxEARFCN-Plus1..maxEARFCN2)
ARFCN-ValueEUTRA-r14 ::= INTEGER (0..maxEARFCN2)
maxEARFCN INTEGER ::= 65535 -- Maximum value of EUTRA carrier frequency
maxEARFCN-Plus1 INTEGER ::= 65536 -- Lowest value extended EARFCN range
maxEARFCN2 INTEGER ::= 262143 -- Highest value extended EARFCN range
\-- ASN1STOP
NOTE: For fields using the original value range, as defined by IE _ARFCN-
ValueEUTRA_ i.e. without suffix, value _maxEARFCN_ indicates that the E-UTRA
carrier frequency is indicated by means of an extension.
#### _\-- ARFCN-ValueUTRA_
The IE _ARFCN-ValueUTRA is used to indicate the ARFCN of the UTRA carrier
frequency, as defined in [13]._
\-- ASN1START
ARFCN-ValueUTRA ::= INTEGER (0..16383)
\-- ASN1STOP
#### \-- _CarrierFreq-NB_
The IE _CarrierFreq-NB_ is used to provide the NB-IoT carrier frequency, as
defined in TS 36.101 [21].
\-- ASN1START
CarrierFreq-NB-r14 ::= SEQUENCE {
carrierFreq-r14 ARFCN-ValueEUTRA-r14,
carrierFreqOffset-r14 CarrierFreqOffsetNB-r14 OPTIONAL,
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _CarrierFreq-NB field descriptions_ | +----------------------------------------------------------------------+ | **_carrierFreq_** | | | | This field specifies the ARFCN applicable for the NB-IoT carrier | | frequency as defined in TS 36.101 [21, Table 5.7.3-1]. | +----------------------------------------------------------------------+ | **_carrierFreqOffset_** | | | | This field specifies the offset of the NB-IoT channel number to | | EARFCN as defined in TS 36.101 [21]. | +----------------------------------------------------------------------+
\-- _CarrierFreqOffsetNB_
The IE _CarrierFreqOffsetNB_ is used to provide the offset of the NB-IoT
channel number to EARFCN of a NB-IoT carrier.
\-- ASN1START
CarrierFreqOffsetNB-r14 ::= ENUMERATED {
v-10, v-9, v-8, v-7, v-6, v-5, v-4, v-3, v-2, v-1, v-0dot5,
v0, v1, v2, v3, v4, v5, v6, v7, v8, v9
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _CarrierFreqOffsetNB field descriptions_ | +----------------------------------------------------------------------+ | **_CarrierFreqOffsetNB_** | | | | This field specifies the offset of the NB-IoT channel number to | | EARFCN as defined in TS 36.101 [21]. Value v-10 means -10, v-9 | | means -9, and so on. | +----------------------------------------------------------------------+
#### _\-- CellGlobalIdEUTRA-AndUTRA_
The IE _CellGlobalIdEUTRA-AndUTRA_ specifies the global Cell Identifier for
E‑UTRA or UTRA, the globally unique identity of a cell in E‑UTRA or UTRA.
\-- ASN1START
CellGlobalIdEUTRA-AndUTRA ::= SEQUENCE {
plmn-Identity SEQUENCE {
mcc SEQUENCE (SIZE (3)) OF INTEGER (0..9),
mnc SEQUENCE (SIZE (2..3)) OF INTEGER (0..9)
},
cellIdentity CHOICE {
eutra BIT STRING (SIZE (28)),
utra BIT STRING (SIZE (32))
},
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_CellGlobalIdEUTRA-AndUTRA field descriptions_** | +----------------------------------------------------------------------+ | **_plmn-Identity_** | | | | This field identifies the PLMN of the cell as defined in [12]. | +----------------------------------------------------------------------+ | **_cellIdentity_** | | | | This field defines the identity of the cell within the context of | | the PLMN as defined in [12] and [13]. The size of the bit string | | allows for the 32-bit extended UTRAN cell ID; in case the cell ID is | | shorter, the first bits of the string are set to 0. | +----------------------------------------------------------------------+
#### _\-- CellGlobalIdGERAN_
The IE _CellGlobalIdGERAN_ specifies the global Cell Identifier for GERAN, the
globally unique identity of a cell in GERAN.
\-- ASN1START
CellGlobalIdGERAN ::= SEQUENCE {
plmn-Identity SEQUENCE {
mcc SEQUENCE (SIZE (3)) OF INTEGER (0..9),
mnc SEQUENCE (SIZE (2..3)) OF INTEGER (0..9)
},
locationAreaCode BIT STRING (SIZE (16)),
cellIdentity BIT STRING (SIZE (16)),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_CellGlobalIdGERAN field descriptions_** | +----------------------------------------------------------------------+ | **_plmn-Identity_** | | | | This field identifies the PLMN of the cell. | +----------------------------------------------------------------------+ | **_locationAreaCode_** | | | | This field is a fixed length code identifying the location area | | within a PLMN. | +----------------------------------------------------------------------+ | **_cellIdentity_** | | | | This field specifies the cell Identifier which is unique within the | | context of the GERAN location area. | +----------------------------------------------------------------------+
#### _\-- ECGI_
The IE _ECGI_ specifies the Evolved Cell Global Identifier (ECGI), the
globally unique identity of a cell in E-UTRA [12].
NOTE: The IE _ECGI_ is also used for NB-IoT access.
\-- ASN1START
ECGI ::= SEQUENCE {
mcc SEQUENCE (SIZE (3)) OF INTEGER (0..9),
mnc SEQUENCE (SIZE (2..3)) OF INTEGER (0..9),
cellidentity BIT STRING (SIZE (28))
}
\-- ASN1STOP
#### _\-- Ellipsoid-Point_
The IE _Ellipsoid-Point_ is used to describe a geographic shape as defined in
3GPP TS 23.032 [15].
\-- ASN1START
Ellipsoid-Point ::= SEQUENCE {
latitudeSign ENUMERATED {north, south},
degreesLatitude INTEGER (0..8388607), -- 23 bit field
degreesLongitude INTEGER (-8388608..8388607) -- 24 bit field
}
\-- ASN1STOP
#### _\-- Ellipsoid-PointWithUncertaintyCircle_
The IE _Ellipsoid-PointWithUncertaintyCircle_ is used to describe a geographic
shape as defined in 3GPP TS 23.032 [15].
\-- ASN1START
Ellipsoid-PointWithUncertaintyCircle ::= SEQUENCE {
latitudeSign ENUMERATED {north, south},
degreesLatitude INTEGER (0..8388607), -- 23 bit field
degreesLongitude INTEGER (-8388608..8388607), -- 24 bit field
uncertainty INTEGER (0..127)
}
\-- ASN1STOP
#### _\-- EllipsoidPointWithUncertaintyEllipse_
The IE _EllipsoidPointWithUncertaintyEllipse_ is used to describe a geographic
shape as defined in 3GPP TS 23.032 [15].
\-- ASN1START
EllipsoidPointWithUncertaintyEllipse ::= SEQUENCE {
latitudeSign ENUMERATED {north, south},
degreesLatitude INTEGER (0..8388607), -- 23 bit field
degreesLongitude INTEGER (-8388608..8388607), -- 24 bit field
uncertaintySemiMajor INTEGER (0..127),
uncertaintySemiMinor INTEGER (0..127),
orientationMajorAxis INTEGER (0..179),
confidence INTEGER (0..100)
}
\-- ASN1STOP
#### _\-- EllipsoidPointWithAltitude_
The IE _EllipsoidPointWithAltitude_ is used to describe a geographic shape as
defined in 3GPP TS 23.032 [15].
\-- ASN1START
EllipsoidPointWithAltitude ::= SEQUENCE {
latitudeSign ENUMERATED {north, south},
degreesLatitude INTEGER (0..8388607), -- 23 bit field
degreesLongitude INTEGER (-8388608..8388607), -- 24 bit field
altitudeDirection ENUMERATED {height, depth},
altitude INTEGER (0..32767) -- 15 bit field
}
\-- ASN1STOP
#### _\-- EllipsoidPointWithAltitudeAndUncertaintyEllipsoid_
The IE _EllipsoidPointWithAltitudeAndUncertaintyEllipsoid_ is used to describe
a geographic shape as defined in 3GPP TS 23.032 [15].
\-- ASN1START
EllipsoidPointWithAltitudeAndUncertaintyEllipsoid ::= SEQUENCE {
latitudeSign ENUMERATED {north, south},
degreesLatitude INTEGER (0..8388607), -- 23 bit field
degreesLongitude INTEGER (-8388608..8388607), -- 24 bit field
altitudeDirection ENUMERATED {height, depth},
altitude INTEGER (0..32767), -- 15 bit field
uncertaintySemiMajor INTEGER (0..127),
uncertaintySemiMinor INTEGER (0..127),
orientationMajorAxis INTEGER (0..179),
uncertaintyAltitude INTEGER (0..127),
confidence INTEGER (0..100)
}
\-- ASN1STOP
#### _\-- EllipsoidArc_
The IE _EllipsoidArc_ is used to describe a geographic shape as defined in
3GPP TS 23.032 [15].
\-- ASN1START
EllipsoidArc ::= SEQUENCE {
latitudeSign ENUMERATED {north, south},
degreesLatitude INTEGER (0..8388607), -- 23 bit field
degreesLongitude INTEGER (-8388608..8388607), -- 24 bit field
innerRadius INTEGER (0..65535), -- 16 bit field,
uncertaintyRadius INTEGER (0..127),
offsetAngle INTEGER (0..179),
includedAngle INTEGER (0..179),
confidence INTEGER (0..100)
}
\-- ASN1STOP
#### _\-- EPDU-Sequence_
The _EPDU-Sequence_ contains IEs that are defined externally to LPP by other
organizations.
\-- ASN1START
EPDU-Sequence ::= SEQUENCE (SIZE (1..maxEPDU)) OF EPDU
maxEPDU INTEGER ::= 16
EPDU ::= SEQUENCE {
ePDU-Identifier EPDU-Identifier,
ePDU-Body EPDU-Body
}
EPDU-Identifier ::= SEQUENCE {
ePDU-ID EPDU-ID,
ePDU-Name EPDU-Name OPTIONAL,
...
}
EPDU-ID ::= INTEGER (1..256)
EPDU-Name ::= VisibleString (SIZE (1..32))
EPDU-Body ::= OCTET STRING
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_EPDU-Sequence field descriptions_** | +----------------------------------------------------------------------+ | **_EPDU-ID_** | | | | This field provides a unique integer ID for the externally defined | | positioning method. Its value is assigned to the external entity | | that defines the EPDU. See table External PDU Identifier Definition | | for a list of external PDU identifiers defined in this version of | | the specification. | +----------------------------------------------------------------------+ | **_EPDU-Name_** | | | | **This field provides an optional character encoding which can be | | used to provide a quasi-unique name for an external PDU -- e.g., by | | containing the name of the defining organization and/or the name of | | the associated public or proprietary standard for the EPDU.** | +----------------------------------------------------------------------+ | **_EPDU-Body_** | | | | **The content and encoding of this field are defined externally to | | LPP.** | +----------------------------------------------------------------------+
External PDU Identifier Definition
* * *
EPDU-ID EPDU Defining entity Method name Reference 1 OMA LOC OMA LPP
extensions (LPPe) OMA-TS-LPPe-V1_0 [20]
* * *
#### _\-- HorizontalVelocity_
The IE _HorizontalVelocity_ is used to describe a velocity shape as defined in
3GPP TS 23.032 [15].
\-- ASN1START
HorizontalVelocity ::= SEQUENCE {
bearing INTEGER(0..359),
horizontalSpeed INTEGER(0..2047)
}
\-- ASN1STOP
#### _\-- HorizontalWithVerticalVelocity_
The IE _HorizontalWithVerticalVelocity_ is used to describe a velocity shape
as defined in 3GPP TS 23.032 [15].
\-- ASN1START
HorizontalWithVerticalVelocity ::= SEQUENCE {
bearing INTEGER(0..359),
horizontalSpeed INTEGER(0..2047),
verticalDirection ENUMERATED{upward, downward},
verticalSpeed INTEGER(0..255)
}
\-- ASN1STOP
#### _\-- HorizontalVelocityWithUncertainty_
The IE _HorizontalVelocityWithUncertainty_ is used to describe a velocity
shape as defined in 3GPP TS 23.032 [15].
\-- ASN1START
HorizontalVelocityWithUncertainty ::= SEQUENCE {
bearing INTEGER(0..359),
horizontalSpeed INTEGER(0..2047),
uncertaintySpeed INTEGER(0..255)
}
\-- ASN1STOP
#### _\-- HorizontalWithVerticalVelocityAndUncertainty_
The IE _HorizontalWithVerticalVelocityAndUncertainty_ is used to describe a
velocity shape as defined in 3GPP TS 23.032 [15].
\-- ASN1START
HorizontalWithVerticalVelocityAndUncertainty ::= SEQUENCE {
bearing INTEGER(0..359),
horizontalSpeed INTEGER(0..2047),
verticalDirection ENUMERATED{upward, downward},
verticalSpeed INTEGER(0..255),
horizontalUncertaintySpeed INTEGER(0..255),
verticalUncertaintySpeed INTEGER(0..255)
}
\-- ASN1STOP
#### _\-- LocationCoordinateTypes_
The IE _LocationCoordinateTypes_ defines a list of possible geographic shapes
as defined in 3GPP TS 23.032 [15].
\-- ASN1START
LocationCoordinateTypes ::= SEQUENCE {
ellipsoidPoint BOOLEAN,
ellipsoidPointWithUncertaintyCircle BOOLEAN,
ellipsoidPointWithUncertaintyEllipse BOOLEAN,
polygon BOOLEAN,
ellipsoidPointWithAltitude BOOLEAN,
ellipsoidPointWithAltitudeAndUncertaintyEllipsoid BOOLEAN,
ellipsoidArc BOOLEAN,
...
}
\-- ASN1STOP
#### _\-- Polygon_
The IE _Polygon_ is used to describe a geographic shape as defined in 3GPP TS
23.032 [15].
\-- ASN1START
Polygon ::= SEQUENCE (SIZE (3..15)) OF PolygonPoints
PolygonPoints ::= SEQUENCE {
latitudeSign ENUMERATED {north, south},
degreesLatitude INTEGER (0..8388607), -- 23 bit field
degreesLongitude INTEGER (-8388608..8388607) -- 24 bit field
}
\-- ASN1STOP
#### _\-- PositioningModes_
The IE _PositioningModes_ is used to indicate several positioning modes using
a bit map.
\-- ASN1START
PositioningModes ::= SEQUENCE {
posModes BIT STRING { standalone (0),
ue-based (1),
ue-assisted (2) } (SIZE (1..8)),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _PositioningModes field descriptions_ | +----------------------------------------------------------------------+ | **_posModes_** | | | | This field specifies the positioning mode(s). This is represented by | | a bit string, with a one‑value at the bit position means the | | particular positioning mode is addressed; a zero‑value means not | | addressed. | +----------------------------------------------------------------------+
#### \-- _SegmentationInfo_
The IE _SegmentationInfo_ is used by a sender to indicate that LPP message
segmentation is used, as specified in sub‑clause 4.3.5.
\-- ASN1START
SegmentationInfo-r14 ::= ENUMERATED { noMoreMessages, moreMessagesOnTheWay }
\-- ASN1STOP
+----------------------------------------------------------------------+ | _SegmentationInfo field descriptions_ | +----------------------------------------------------------------------+ | **_SegmentationInfo_** | | | | _noMoreMessages_ indicates that this is the only or last LPP message | | segment used to deliver the entire message body. | | | | _moreMessagesOnTheWay_ indicates that this is one of multiple LPP | | message segments used to deliver the entire message body. | +----------------------------------------------------------------------+
#### _\-- VelocityTypes_
The IE _VelocityTypes_ defines a list of possible velocity shapes as defined
in 3GPP TS 23.032 [15].
\-- ASN1START
VelocityTypes ::= SEQUENCE {
horizontalVelocity BOOLEAN,
horizontalWithVerticalVelocity BOOLEAN,
horizontalVelocityWithUncertainty BOOLEAN,
horizontalWithVerticalVelocityAndUncertainty BOOLEAN,
...
}
\-- ASN1STOP
### 6.4.2 Common Positioning
#### \-- _CommonIEsRequestCapabilities_
The _CommonIEsRequestCapabilities_ carries common IEs for a Request
Capabilities LPP message Type.
\-- ASN1START
CommonIEsRequestCapabilities ::= SEQUENCE {
...,
[[
lpp-message-segmentation-req-r14 BIT STRING { serverToTarget (0),
targetToServer (1) } OPTIONAL -- Need ON
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _CommonIEsRequestCapabilities field descriptions_ | +----------------------------------------------------------------------+ | **_lpp-message-segmentation-req_** | | | | This field, if present, indicates that the target device is | | requested to provide its LPP message segmentation capabilities.\ | | If bit 0 is set to value 1, it indicates that the server is able to | | send segmented LPP messages to the target device; if bit 0 is set to | | value 0 it indicates that the server is not able to send segmented | | LPP messages to the target device. | | | | If bit 1 is set to value 1, it indicates that the server is able to | | receive segmented LPP messages from the target device; if bit 1 is | | set to value 0 it indicates that the server is not able to receive | | segmented LPP messages from the target device. | +----------------------------------------------------------------------+
#### \-- _CommonIEsProvideCapabilities_
The _CommonIEsProvideCapabilities_ carries common IEs for a Provide
Capabilities LPP message Type.
\-- ASN1START
CommonIEsProvideCapabilities ::= SEQUENCE {
...,
[[
segmentationInfo-r14 SegmentationInfo-r14 OPTIONAL, -- Cond Segmentation
lpp-message-segmentation-r14 BIT STRING { serverToTarget (0),
targetToServer (1) } OPTIONAL
]]
}
\-- ASN1STOP
* * *
Conditional presence Explanation _Segmentation_ This field is optionally
present, need OP, if _lpp-message-segmentation-req_ has been received from the
location server with bit 1 (_targetToServer_) set to value 1. The field shall
be omitted if _lpp‑message‑segmentation-req_ has not been received in this
location session, or has been received with bit 1 (_targetToServer_) set to
value 0.
* * *
+----------------------------------------------------------------------+ | _CommonIEsProvideCapabilities field descriptions_ | +----------------------------------------------------------------------+ | **_segmentationInfo_** | | | | **This field indicates whether this** _ProvideCapabilities_ | | **message is one of many segments** , as specified in sub-clause | | 4.3.5. | +----------------------------------------------------------------------+ | **_lpp-message-segmentation_** | | | | This field, if present, indicates the target device\'s LPP message | | segmentation capabilities.\ | | If bit 0 is set to value 1, it indicates that the target device | | supports receiving segmented LPP messages; if bit 0 is set to value | | 0 it indicates that the target device does not support receiving | | segmented LPP messages. | | | | If bit 1 is set to value 1, it indicates that the target device | | supports sending segmented LPP messages; if bit 1 is set to value 0 | | it indicates that the target device does not support sending | | segmented LPP messages. | +----------------------------------------------------------------------+
#### \-- _CommonIEsRequestAssistanceData_
The _CommonIEsRequestAssistanceData_ carries common IEs for a Request
Assistance Data LPP message Type.
\-- ASN1START
CommonIEsRequestAssistanceData ::= SEQUENCE {
primaryCellID ECGI OPTIONAL, -- Cond EUTRA
...,
[[
segmentationInfo-r14 SegmentationInfo-r14 OPTIONAL -- Cond Segmentation
]]
}
\-- ASN1STOP
* * *
Conditional presence Explanation _EUTRA_ The field is mandatory present for
E-UTRA or NB-IoT access. The field shall be omitted for non-EUTRA and non-NB-
IoT user plane support. _Segmentation_ This field is optionally present, need
OP, if _lpp-message-segmentation-req_ has been received from the location
server with bit 1 (_targetToServer_) set to value 1. The field shall be
omitted if _lpp‑message‑segmentation-req_ has not been received in this
location session, or has been received with bit 1 (_targetToServer_) set to
value 0.
* * *
+----------------------------------------------------------------------+ | _CommonIEsRequestAssistanceData field descriptions_ | +----------------------------------------------------------------------+ | **_primaryCellID_** | | | | This parameter identifies the current primary cell for the target | | device. | +----------------------------------------------------------------------+ | **_segmentationInfo_** | | | | **This field indicates whether this _RequestAssistanceData_ message | | is one of many segments, as specified in sub-clause 4.3.5.** | +----------------------------------------------------------------------+
#### \-- _CommonIEsProvideAssistanceData_
The _CommonIEsProvideAssistanceData_ carries common IEs for a Provide
Assistance Data LPP message Type.
\-- ASN1START
CommonIEsProvideAssistanceData ::= SEQUENCE {
...,
[[
segmentationInfo-r14 SegmentationInfo-r14 OPTIONAL -- Need ON
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _CommonIEsRequestAssistanceData field descriptions_ | +----------------------------------------------------------------------+ | **_segmentationInfo_** | | | | **This field indicates whether this _ProvideAssistanceData_ message | | is one of many segments**, as specified in sub-clause 4.3.5**.** | +----------------------------------------------------------------------+
#### \-- _CommonIEsRequestLocationInformation_
The _CommonIEsRequestLocationInformation_ carries common IEs for a Request
Location Information LPP message Type.
\-- ASN1START
CommonIEsRequestLocationInformation ::= SEQUENCE {
locationInformationType LocationInformationType,
triggeredReporting TriggeredReportingCriteria OPTIONAL, -- Cond ECID
periodicalReporting PeriodicalReportingCriteria OPTIONAL, -- Need ON
additionalInformation AdditionalInformation OPTIONAL, -- Need ON
qos QoS OPTIONAL, -- Need ON
environment Environment OPTIONAL, -- Need ON
locationCoordinateTypes LocationCoordinateTypes OPTIONAL, -- Need ON
velocityTypes VelocityTypes OPTIONAL, -- Need ON
...,
[[
messageSizeLimitNB-r14 MessageSizeLimitNB-r14 OPTIONAL -- Need ON
]],
[[
segmentationInfo-r14 SegmentationInfo-r14 OPTIONAL -- Need ON
]]
}
LocationInformationType ::= ENUMERATED {
locationEstimateRequired,
locationMeasurementsRequired,
locationEstimatePreferred,
locationMeasurementsPreferred,
...
}
PeriodicalReportingCriteria ::= SEQUENCE {
reportingAmount ENUMERATED {
ra1, ra2, ra4, ra8, ra16, ra32,
ra64, ra-Infinity
} DEFAULT ra-Infinity,
reportingInterval ENUMERATED {
noPeriodicalReporting, ri0-25,
ri0-5, ri1, ri2, ri4, ri8, ri16, ri32, ri64
}
}
TriggeredReportingCriteria ::= SEQUENCE {
cellChange BOOLEAN,
reportingDuration ReportingDuration,
...
}
ReportingDuration ::= INTEGER (0..255)
AdditionalInformation ::= ENUMERATED {
onlyReturnInformationRequested,
mayReturnAditionalInformation,
...
}
QoS ::= SEQUENCE {
horizontalAccuracy HorizontalAccuracy OPTIONAL, -- Need ON
verticalCoordinateRequest BOOLEAN,
verticalAccuracy VerticalAccuracy OPTIONAL, -- Need ON
responseTime ResponseTime OPTIONAL, -- Need ON
velocityRequest BOOLEAN,
...,
[[ responseTimeNB-r14 ResponseTimeNB-r14 OPTIONAL -- Need ON
]]
}
HorizontalAccuracy ::= SEQUENCE {
accuracy INTEGER(0..127),
confidence INTEGER(0..100),
...
}
VerticalAccuracy ::= SEQUENCE {
accuracy INTEGER(0..127),
confidence INTEGER(0..100),
...
}
ResponseTime ::= SEQUENCE {
time INTEGER (1..128),
...,
[[ responseTimeEarlyFix-r12 INTEGER (1..128) OPTIONAL -- Need ON
]]
}
ResponseTimeNB-r14 ::= SEQUENCE {
timeNB-r14 INTEGER (1..512),
responseTimeEarlyFixNB-r14 INTEGER (1..512) OPTIONAL, -- Need ON
...
}
Environment ::= ENUMERATED {
badArea,
notBadArea,
mixedArea,
...
}
MessageSizeLimitNB-r14 ::= SEQUENCE {
measurementLimit-r14 INTEGER (1..512) OPTIONAL, -- Need ON
...
}
\-- ASN1STOP
* * *
Conditional presence Explanation _ECID_ The field is optionally present, need
ON, if ECID is requested. Otherwise it is not present.
* * *
+----------------------------------------------------------------------+ | _CommonIEsRequestLocationInformation field descriptions_ | +----------------------------------------------------------------------+ | **_locationInformationType_** | | | | This IE indicates whether the server requires a location estimate or | | measurements. For \'_locationEstimateRequired_ \', the target device | | shall return a location estimate if possible, or indicate a location | | error if not possible. For \'_locationMeasurementsRequired_ \', the | | target device shall return measurements if possible, or indicate a | | location error if not possible. For \'_locationEstimatePreferred_ \', | | the target device shall return a location estimate if possible, but | | may also or instead return measurements for any requested position | | methods for which a location estimate is not possible. For | | \'_locationMeasurementsPreferred_ \', the target device shall return | | location measurements if possible, but may also or instead return a | | location estimate for any requested position methods for which | | return of location measurements is not possible. | +----------------------------------------------------------------------+ | **_triggeredReporting_** | | | | **This IE indicates that triggered reporting is requested and | | comprises the following subfields:** | | | | - **_cellChange_** : If this field is set to TRUE, the target device | | provides requested location information each time the primary cell | | has changed. | | | | - **_reportingDuration_** : Maximum duration of triggered reporting | | in seconds. A value of zero is interpreted to mean an unlimited | | (i.e. \"infinite\") duration. The target device should continue | | triggered reporting for the _reportingDuration_ or until an LPP | | _Abort_ or _LPP Error_ message is received. | | | | The **_triggeredReporting_** field should not be included by the | | location server and shall be ignored by the target device if the | | _periodicalReporting_ IE or _responseTime_ IE or _responseTimeNB_ IE | | is included in _CommonIEsRequestLocationInformation._ | +----------------------------------------------------------------------+ | **_periodicalReporting_** | | | | **This IE indicates that periodic reporting is requested and | | comprises the following subfields:** | | | | - **_reportingAmount_** indicates the number of periodic location | | information reports requested. Enumerated values correspond to 1, 2, | | 4, 8, 16, 32, 64, or infinite/indefinite number of reports. If the | | _reportingAmount_ is \'_infinite/indefinite\'_ , the target device | | shou-ld continue periodic reporting until an LPP _Abort_ message is | | received. The value \'_ra1_ \' shall not be used by a sender. | | | | - **_reportingInterval_** indicates the interval between location | | information reports and the response time requirement for the first | | location information report. Enumerated values ri0-25, ri0-5, ri1, | | ri2, ri4, ri8, ri16, ri32, ri64 correspond to reporting intervals of | | 1, 2, 4, 8, 10, 16, 20, 32, and 64 seconds, respectively. | | Measurement reports containing no measurements or no location | | estimate are required when a _reportingInterval_ expires before a | | target device is able to obtain new measurements or obtain a new | | location estimate. The value \'_noPeriodicalReporting_ \' shall not | | be used by a sender. | +----------------------------------------------------------------------+ | **_additionalInformation_** | | | | **This IE indicates whether a target device is allowed to return | | additional information to that requested. If this IE indicates | | \'_onlyReturnInformationRequested\'_then the target device shall | | not return any additional information to that requested by the | | server. If this IE indicates \'_ mayReturnAdditionalInformation\'_| | then the target device may return additional information to that | | requested by the server. If a location estimate is returned, any | | additional information is restricted to that associated with a | | location estimate (e.g. might include velocity if velocity was not | | requested but cannot include measurements). If measurements are | | returned, any additional information is restricted to additional | | measurements (e.g. might include E-CID measurements if A-GNSS | | measurements were requested but not E-CID measurements)._ * | +----------------------------------------------------------------------+ | _**qos** _| | | |_ *This IE indicates the quality of service and comprises a number of | | sub-fields. In the case of measurements, some of the sub-fields | | apply to the location estimate that could be obtained by the server | | from the measurements provided by the target device assuming that | | the measurements are the only sources of error. Fields are as | | follows:** | | | | - **_horizontalAccuracy_** indicates the maximum horizontal error | | in the location estimate at an indicated confidence level. The | | \'_accuracy_ \' corresponds to the encoded uncertainty as defined in | | 3GPP TS 23.032 [15] and \'_confidence_ \' corresponds to confidence | | as defined in 3GPP TS 23.032 [15]. | | | | - **_verticalCoordinateRequest_** indicates whether a vertical | | coordinate is required (TRUE) or not (FALSE) | | | | - **_verticalAccuracy_** indicates the maximum vertical error in | | the location estimate at an indicated confidence level and is only | | applicable when a vertical coordinate is requested. The | | \'_accuracy_ \' corresponds to the encoded uncertainty altitude as | | defined in 3GPP TS 23.032 [15] and \'_confidence_ \' corresponds to | | confidence as defined in 3GPP TS 23.032 [15]. | | | | - **_responseTime_** | | | | - **_time_** indicates the maximum response time as measured | | between receipt of the _RequestLocationInformation_ and transmission | | of a _ProvideLocationInformation_. This is given as an integer | | number of seconds between 1 and 128. If the _periodicalReporting_ IE | | is included in _CommonIEsRequestLocationInformation_ , this field | | should not be included by the location server and shall be ignored | | by the target device (if included). | | | | - **_responseTimeEarlyFix_ indicates the maximum response time** as | | measured between receipt of the _RequestLocationInformation_ and | | transmission of a _ProvideLocationInformation_ containing early | | location measurements or an early location estimate. This is given | | as an integer number of seconds between 1 and 128. When this IE is | | included, a target should send a _ProvideLocationInformation_ (or | | more than one _ProvideLocationInformation_ if location information | | will not fit into a single message) containing early location | | information according to the **_responseTimeEarlyFix_ IE and a | | subsequent** _ProvideLocationInformation_ (or more than one | | _ProvideLocationInformation_ if location information will not fit | | into a single message) **containing final location information | | according to the _time _IE. A target shall omit sending a | |_ ProvideLocationInformation _if the early location information is | | not available at the expiration of the time value in the | |_ responseTimeEarlyFix _IE. A server should set the | |_ responseTimeEarlyFix _IE to a value less than that for the_ time _| | IE. A target shall ignore the_ responseTimeEarlyFix _IE if its value | | is not less than that for the_ time _IE._ * | | | | - _**velocityRequest** _indicates whether velocity (or measurements | | related to velocity) is requested (TRUE) or not (FALSE). | | | | -_** responseTimeNB\ | | **_If the_ periodicalReporting _IE or_ responseTime _IE is included | | in_ CommonIEsRequestLocationInformation*, this field should not be | | included by the location server and shall be ignored by the target | | device (if included). | | | | - **_timeNB_**indicates the maximum response time as measured | | between receipt of the _RequestLocationInformation _and transmission | | of a_ ProvideLocationInformation*. This is given as an integer | | number of seconds between 1 and 512. | | | | - _**responseTimeEarlyFixNB** _indicates the maximum response time | | as measured between receipt of the_ RequestLocationInformation _and | | transmission of a_ ProvideLocationInformation _containing early | | location measurements or an early location estimate. This is given | | as an integer number of seconds between 1 and 512. When this IE is | | included, a target should send a_ ProvideLocationInformation _(or | | more than one_ ProvideLocationInformation _if location information | | will not fit into a single message) containing early location | | information according to the_ responseTimeEarlyFixNB _IE and a | | subsequent_ ProvideLocationInformation _(or more than one | |_ ProvideLocationInformation _if location information will not fit | | into a single message) containing final location information | | according to the_ timeNB _IE. A target shall omit sending a | |_ ProvideLocationInformation _if the early location information is | | not available at the expiration of the time value in the | |_ responseTimeEarlyFixNB _IE. A server should set the | |_ responseTimeEarlyFixNB _IE to a value less than that for the | |_ timeNB _IE. A target shall ignore the_ responseTimeEarlyFixNB _IE | | if its value is not less than that for the_ timeNB _IE. | | | | All QoS requirements shall be obtained by the target device to the | | degree possible but it is permitted to return a response that does | | not fulfill all QoS requirements if some were not attainable. The | | single exception is_ time* **and _timeNB_**which shall always be | | fulfilled -- even if that means not fulfilling other QoS | | requirements. | | | |** A target device supporting NB-IoT access shall support the**| |_responseTimeNB _IE_.* | +----------------------------------------------------------------------+ | _**environment** _| | | |_ *This field provides the target device with information about | | expected multipath and non line of sight (NLOS) in the current area. | | The following values are defined:** | | | | - badArea: possibly heavy multipath and NLOS conditions (e.g. bad | | urban or urban). | | | | - notBadArea: no or light multipath and usually LOS conditions | | (e.g. suburban or rural). | | | | - mixedArea: environment that is mixed or not defined. | | | | **If this field is absent, a default value of \'mixedArea\' | | applies.** | +----------------------------------------------------------------------+ | **_locationCoordinateTypes_** | | | | **This field provides a list of the types of location estimate that | | the target device may return when a location estimate is obtained by | | the target.** | +----------------------------------------------------------------------+ | **_velocityTypes_** | | | | **This fields provides a list of the types of velocity estimate that | | the target device may return when a velocity estimate is obtained by | | the target.** | +----------------------------------------------------------------------+ | **_messageSizeLimitNB_** | | | | **This field provides an octet limit on the amount of location | | information a target device can return.** | | | | - **_measurementLimit_** indicates the maximum amount of location | | information the target device should return in response to the | | _RequestLocationInformation_ message received from the location | | server.**\ | |** The limit applies to the overall size of the LPP message at LPP | | level (LPP Provide Location Information), and is specified in steps | | of 100 octets. The message size limit is then given by the value | | provided in _measurementLimit_ times 100 octets. | +----------------------------------------------------------------------+ | **_segmentationInfo_** | | | | **This field indicates whether this _RequestLocationInformation_ | | message is one of many segments, as specified in sub‑clause 4.3.5** | +----------------------------------------------------------------------+
#### \-- _CommonIEsProvideLocationInformation_
The _CommonIEsProvideLocationInformation_ carries common IEs for a Provide
Location Information LPP message Type.
\-- ASN1START
CommonIEsProvideLocationInformation ::= SEQUENCE {
locationEstimate LocationCoordinates OPTIONAL,
velocityEstimate Velocity OPTIONAL,
locationError LocationError OPTIONAL,
...,
[[ earlyFixReport-r12 EarlyFixReport-r12 OPTIONAL
]],
[[ locationSource-r13 LocationSource-r13 OPTIONAL,
locationTimestamp-r13 UTCTime OPTIONAL
]],
[[
segmentationInfo-r14 SegmentationInfo-r14 OPTIONAL -- Cond Segmentation
]]
}
LocationCoordinates ::= CHOICE {
ellipsoidPoint Ellipsoid-Point,
ellipsoidPointWithUncertaintyCircle Ellipsoid-PointWithUncertaintyCircle,
ellipsoidPointWithUncertaintyEllipse EllipsoidPointWithUncertaintyEllipse,
polygon Polygon,
ellipsoidPointWithAltitude EllipsoidPointWithAltitude,
ellipsoidPointWithAltitudeAndUncertaintyEllipsoid
EllipsoidPointWithAltitudeAndUncertaintyEllipsoid,
ellipsoidArc EllipsoidArc,
...
}
Velocity ::= CHOICE {
horizontalVelocity HorizontalVelocity,
horizontalWithVerticalVelocity HorizontalWithVerticalVelocity,
horizontalVelocityWithUncertainty HorizontalVelocityWithUncertainty,
horizontalWithVerticalVelocityAndUncertainty
HorizontalWithVerticalVelocityAndUncertainty,
...
}
LocationError ::= SEQUENCE {
locationfailurecause LocationFailureCause,
...
}
LocationFailureCause ::= ENUMERATED {
undefined,
requestedMethodNotSupported,
positionMethodFailure,
periodicLocationMeasurementsNotAvailable,
...
}
EarlyFixReport-r12 ::= ENUMERATED {
noMoreMessages,
moreMessagesOnTheWay
}
LocationSource-r13 ::= BIT STRING { a-gnss (0),
wlan (1),
bt (2),
tbs (3),
sensor (4) } (SIZE(1..16))
\-- ASN1STOP
* * *
Conditional presence Explanation _Segmentation_ This field is optionally
present, need OP, if _lpp-message-segmentation-req_ has been received from the
location server with bit 1 (_targetToServer_) set to value 1. The field shall
be omitted if _lpp‑message‑segmentation-req_ has not been received in this
location session, or has been received with bit 1 (_targetToServer_) set to
value 0.
* * *
+----------------------------------------------------------------------+ | _CommonIEsProvideLocationInformation field descriptions_ | +----------------------------------------------------------------------+ | **_locationEstimate_** | | | | This field provides a location estimate using one of the geographic | | shapes defined in 3GPP TS 23.032 [15]. Coding of the values of the | | various fields internal to each geographic shape follow the rules in | | [15]. The conditions for including this field are defined for the | | _locationInformationType_ field in a Request Location Information | | message. | +----------------------------------------------------------------------+ | **_velocityEstimate_** | | | | This field provides a velocity estimate using one of the velocity | | shapes defined in 3GPP TS 23.032 [15]. Coding of the values of the | | various fields internal to each velocity shape follow the rules in | | [15]. | +----------------------------------------------------------------------+ | **_locationError_** | | | | **This field shall be included if and only if a location estimate | | and measurements are not included in the LPP PDU. The field includes | | information concerning the reason for the lack of location | | information. The** _LocationFailureCause_ | | \'_periodicLocationMeasurementsNotAvailable_ \' shall be used by the | | target device if periodic location reporting was requested, but no | | measurements or location estimate are available when _the | | reportingInterval_ expired. | +----------------------------------------------------------------------+ | **_earlyFixReport_** | | | | This field shall be included if and only if the | | _ProvideLocationInformation_ message contains early location | | measurements or an early location estimate. The target device shall | | set the values of this field as follows: | | | | - noMoreMessages: This is the only or last | | _ProvideLocationInformation_ message used to deliver the entire set | | of early location information. | | | | - moreMessagesOnTheWay: This is one of multiple | | _ProvideLocationInformation_ messages used to deliver the entire set | | of early location information (if early location information will | | not fit into a single message). | | | | If this field is included, the IE _SegmentationInfo_ shall not be | | included. | +----------------------------------------------------------------------+ | **_locationSource_** | | | | This field provides the source positioning technology for the | | location estimate. NOTE: In this version of the specification, the | | entry \'tbs\' is used only for TBS positioning based on MBS signals. | +----------------------------------------------------------------------+ | **_locationTimestamp_** | | | | This field provides the UTC time when the location estimate is valid | | and should take the form of _YYMMDDhhmmssZ_. | +----------------------------------------------------------------------+ | **_segmentationInfo_** | | | | This field indicates whether this _ProvideLocationInformation_ | | message is one of many segments, as specified in sub‑clause 4.3.5 | +----------------------------------------------------------------------+
#### _\-- CommonIEsAbort_
The _CommonIEsAbort_ carries common IEs for an Abort LPP message Type.
\-- ASN1START
CommonIEsAbort ::= SEQUENCE {
abortCause ENUMERATED {
undefined,
stopPeriodicReporting,
targetDeviceAbort,
networkAbort,
...
}
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _CommonIEsAbort field descriptions_ | +----------------------------------------------------------------------+ | _abortCause_ | | | | This IE defines the request to abort an ongoing procedure. The abort | | cause \'_stopPeriodicReporting_ \' should be used by the location | | server to stop any ongoing location reporting configured as | | _periodicalReporting_ or _triggeredReporting_ in the | | _CommonIEsRequestLocationInformation_. | +----------------------------------------------------------------------+
#### \-- _CommonIEsError_
The _CommonIEsError_ carries common IEs for an Error LPP message Type.
\-- ASN1START
CommonIEsError ::= SEQUENCE {
errorCause ENUMERATED {
undefined,
lppMessageHeaderError,
lppMessageBodyError,
epduError,
incorrectDataValue,
...,
lppSegmentationError-v1450
}
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _CommonIEsError field descriptions_ | +----------------------------------------------------------------------+ | _errorCause_ | | | | This IE defines the cause for an error. \'_lppMessageHeaderError_ \', | | \'_lppMessageBodyError_ \' and \'_epduError_ \' is used if a receiver | | is able to detect a coding error in the LPP header (i.e., in the | | common fields), LPP message body or in an EPDU, respectively. | | \'_lppSegmentationError_ \' is used if a receiver detects an error in | | LPP message segmentation. | +----------------------------------------------------------------------+
## 6.5 Positioning Method IEs
### 6.5.1 OTDOA Positioning
This subclause defines the information elements for downlink OTDOA
positioning, which includes TBS positioning based on PRS signals [2].
#### 6.5.1.1 OTDOA Assistance Data
#### \-- _OTDOA-ProvideAssistanceData_
The IE _OTDOA-ProvideAssistanceData_ is used by the location server to provide
assistance data to enable UE‑assisted downlink OTDOA. It may also be used to
provide OTDOA positioning specific error reason.
Throughout Section 6.5.1, \"assistance data reference cell\" refers to the
cell defined by the IE _OTDOA-ReferenceCellInfo_ and \"NB-IoT assistance data
reference cell\" refers to the cell defined by the IE _OTDOA-
ReferenceCellInfoNB_ (see section 6.5.1.2). \"RSTD reference cell\" applies
only in Section 6.5.1.5.
If both IEs, _OTDOA-ReferenceCellInfo_ and _OTDOA-ReferenceCellInfoNB_ are
included in _OTDOA‑ProvideAssistanceData_ , the assistance data reference cell
and NB-IoT assistance data reference cell correspond to the same cell, and the
target device may assume that PRS and NPRS antenna ports are quasi co-located,
as defined in [16].
Throughout Section 6.5.1, the term \"cell\" refers to \"transmission point
(TP)\", unless distinguished in the field description.
NOTE 1: The location server should include at least one cell for which the SFN
can be obtained by the target device, e.g. the serving cell, in the assistance
data, either as the assistance data reference cell or in the neighbour cell
list. Otherwise the target device will be unable to perform the OTDOA
measurement and the positioning operation will fail.
NOTE 2: Due to support of cells containing multiple TPs and PRS-only TPs not
associated with cells, the term \"cell\" as used in section 6.5.1 may not
always correspond to a cell for the E-UTRAN.
NOTE 3: For NB-IoT access, due to support of NPRS on multiple carriers, the
term \"cell\" as used in section 6.5.1 refers to the anchor carrier, unless
otherwise stated.
\-- ASN1START
OTDOA-ProvideAssistanceData ::= SEQUENCE {
otdoa-ReferenceCellInfo OTDOA-ReferenceCellInfo OPTIONAL, -- Need ON
otdoa-NeighbourCellInfo OTDOA-NeighbourCellInfoList OPTIONAL, -- Need ON
otdoa-Error OTDOA-Error OPTIONAL, -- Need ON
...,
[[
otdoa-ReferenceCellInfoNB-r14 OTDOA-ReferenceCellInfoNB-r14 OPTIONAL, \-- Need
ON
otdoa-NeighbourCellInfoNB-r14 OTDOA-NeighbourCellInfoListNB-r14 OPTIONAL \--
Need ON
]]
}
\-- ASN1STOP
#### 6.5.1.2 OTDOA Assistance Data Elements
#### \-- _OTDOA-ReferenceCellInfo_
The IE _OTDOA-ReferenceCellInfo_ is used by the location server to provide
assistance data reference cell information for OTDOA assistance data. The slot
number offsets and expected RSTDs in _OTDOA-NeighbourCellInfoList_ are
provided relative to the cell defined by this IE. If _earfcnRef_ of this
assistance data reference cell is different from that of the serving cell, the
LPP layer shall inform lower layers to start performing inter-frequency RSTD
measurements with this cell and provide to lower layers the information about
this assistance data reference cell, e.g. EARFCN and PRS positioning occasion
information.
NOTE: The location server should always include the PRS configuration of the
assistance data reference and neighbour cells. Otherwise the UE may not meet
the accuracy requirements as defined in [18].
\-- ASN1START
OTDOA-ReferenceCellInfo ::= SEQUENCE {
physCellId INTEGER (0..503),
cellGlobalId ECGI OPTIONAL, -- Need ON
earfcnRef ARFCN-ValueEUTRA OPTIONAL, -- Cond NotSameAsServ0
antennaPortConfig ENUMERATED {ports1-or-2, ports4, ... }
OPTIONAL, -- Cond NotSameAsServ1
cpLength ENUMERATED { normal, extended, ... },
prsInfo PRS-Info OPTIONAL, -- Cond PRS
...,
[[ earfcnRef-v9a0 ARFCN-ValueEUTRA-v9a0 OPTIONAL -- Cond NotSameAsServ2
]],
[[ tpId-r14 INTEGER (0..4095) OPTIONAL, -- Need ON
cpLengthCRS-r14 ENUMERATED { normal, extended, ... }
OPTIONAL, -- Cond CRS
sameMBSFNconfigRef-r14 BOOLEAN OPTIONAL, -- Need ON
dlBandwidth-r14 ENUMERATED {n6, n15, n25, n50, n75, n100}
OPTIONAL, -- Cond NotSameAsServ3
addPRSconfigRef-r14 SEQUENCE (SIZE (1..maxAddPRSconfig-r14)) OF PRS-Info
OPTIONAL -- Need ON
]]
}
maxAddPRSconfig-r14 INTEGER ::= 2
\-- ASN1STOP
* * *
Conditional presence Explanation _NotSameAsServ0_ This field is absent if
_earfcnRef-v9a0_ is present. Otherwise, the field is mandatory present if the
EARFCN of the OTDOA assistance data reference cell is not the same as the
EARFCN of the target devices\' current primary cell. _NotSameAsServ1_ The
field is mandatory present if the **_antenna port configuration_** of the
OTDOA assistance data reference cell is not the same as the **_antenna port
configuration_** of the target devices\' current primary cell.
_NotSameAsServ2_ The field is absent if _earfcnRef_ is present. Otherwise, the
field is mandatory present if the EARFCN of the OTDOA assistance data
reference cell is not the same as the EARFCN of the target devices\' current
primary cell. _PRS_ The field is mandatory present if positioning reference
signals are available in the assistance data reference cell [16]; otherwise it
is not present. _CRS_ The field is optionally present, need ON, if **_prsInfo
is present_**. Otherwise it is not present. _NotSameAsServ3_ The field is
mandatory present if the downlink bandwidth configuration of the assistance
data reference cell is not the same as the downlink bandwidth configuration of
the target devices\' current primary cell and if PRS frequency hopping is used
in the assistance data reference cell [16]; otherwise it is not present.
* * *
+----------------------------------------------------------------------+ | _OTDOA-ReferenceCellInfo field descriptions_ | +----------------------------------------------------------------------+ | **_physCellId_** | | | | This field specifies the physical cell identity of the assistance | | data reference cell, as defined in [12]. | +----------------------------------------------------------------------+ | **_cellGlobalId_** | | | | This field specifies the ECGI, the globally unique identity of a | | cell in E-UTRA, of the assistance data reference cell, as defined in | | [12]. The server should include this field if it considers that it | | is needed to resolve ambiguity in the cell indicated by | | _physCellId_. | +----------------------------------------------------------------------+ | **_earfcnRef_** | | | | This field specifies the EARFCN of the assistance data reference | | cell. | +----------------------------------------------------------------------+ | **_antennaPortConfig_** | | | | This field specifies whether 1 (or 2) antenna port(s) or 4 antenna | | ports for cell specific reference signals (CRS) are used in the | | assistance data reference cell. | +----------------------------------------------------------------------+ | **_cpLength_** | | | | **_This field specifies the cyclic prefix length of the assistance | | data reference cell PRS if the prsInfo field is present, otherwise | | this field specifies the cyclic prefix length of the assistance data | | reference cell CRS._** | +----------------------------------------------------------------------+ | **_prsInfo_** | | | | **_This field specifies the first PRS configuration of the | | assistance data reference cell._** | +----------------------------------------------------------------------+ | **_tpId_** | | | | This field specifies an identity of the transmission point. This | | field together with the _physCellId_ and/or _prsID_ may be used to | | identify the transmission point in case the same physical cell ID is | | shared by multiple transmission points. | +----------------------------------------------------------------------+ | **_cpLengthCRS_** | | | | **_This field specifies the cyclic prefix length of the assistance | | data reference cell CRS. If this field is present, the target device | | may assume_** the CRS and PRS antenna ports of the assistance data | | reference cell are quasi co-located (as defined in [16]). | +----------------------------------------------------------------------+ | **_sameMBSFNconfigRef_** | | | | This field indicates whether the MBSFN subframe configuration of the | | assistance data reference cell is the same as the current primary | | cell of the target device. TRUE means the same, and FALSE means not | | the same. | +----------------------------------------------------------------------+ | **_dlBandwidth_** | | | | **_This field specifies the downlink bandwidth configuration of the | | assistance data reference cell, N~RB~ in downlink, see TS 36.101 | | [21, table 5.6-1]. Enumerated value n6 corresponds to 6 resource | | blocks, n15 to 15 resource blocks and so on._** | +----------------------------------------------------------------------+ | **_addPRSconfigRef_** | | | | **_This field specifies the additional (second and possibly third) | | PRS configuration(s) of the assistance data reference cell._** | +----------------------------------------------------------------------+
#### \-- _PRS-Info_
The IE _PRS-Info_ provides the information related to the configuration of PRS
in a cell.
\-- ASN1START
PRS-Info ::= SEQUENCE {
prs-Bandwidth ENUMERATED { n6, n15, n25, n50, n75, n100, ... },
prs-ConfigurationIndex INTEGER (0..4095),
numDL-Frames ENUMERATED {sf-1, sf-2, sf-4, sf-6, ..., sf-add-v1420},
...,
prs-MutingInfo-r9 CHOICE {
po2-r9 BIT STRING (SIZE(2)),
po4-r9 BIT STRING (SIZE(4)),
po8-r9 BIT STRING (SIZE(8)),
po16-r9 BIT STRING (SIZE(16)),
...,
po32-v1420 BIT STRING (SIZE(32)),
po64-v1420 BIT STRING (SIZE(64)),
po128-v1420 BIT STRING (SIZE(128)),
po256-v1420 BIT STRING (SIZE(256)),
po512-v1420 BIT STRING (SIZE(512)),
po1024-v1420 BIT STRING (SIZE(1024))
} OPTIONAL, -- Need OP
[[ prsID-r14 INTEGER (0..4095) OPTIONAL, -- Need ON
add-numDL-Frames-r14 INTEGER (1..160) OPTIONAL, -- Cond sf-add
prsOccGroupLen-r14 ENUMERATED {g2, g4, g8, g16, g32, g64, g128,... }
OPTIONAL, -- Cond Occ-Grp
prsHoppingInfo-r14 CHOICE {
nb2-r14 INTEGER (0.. maxAvailNarrowBands-Minus1-r14),
nb4-r14 SEQUENCE (SIZE (3))
OF INTEGER (0.. maxAvailNarrowBands-Minus1-r14)
} OPTIONAL -- Cond PRS-FH
]]
}
maxAvailNarrowBands-Minus1-r14 INTEGER ::= 15 -- Maximum number of narrowbands
minus 1
\-- ASN1STOP
* * *
Conditional presence Explanation _sf-add_ The field is mandatory present if
the _numDL-Frames_ field has the value \'_sf-add_ \'; otherwise it is not
present. _Occ-Grp_ The field is mandatory present if a PRS occasion group is
configured; otherwise it is not present. _PRS-FH_ The field is mandatory
present if frequency hopping is used for PRS; otherwise it is not present.
* * *
+----------------------------------------------------------------------+ | _PRS-Info field descriptions_ | +----------------------------------------------------------------------+ | **_prs-Bandwidth_** | | | | This field specifies the bandwidth that is used to configure the | | positioning reference signals on. Enumerated values are specified in | | number of resource blocks (n6 corresponds to 6 resource blocks, n15 | | to 15 resource blocks and so on) and define 1.4, 3, 5, 10, 15 and 20 | | MHz bandwidth. | +----------------------------------------------------------------------+ | **_prs-ConfigurationIndex_** | | | | **_This field specfies the positioning reference signals | | configuration index I~PRS~ as defined in [16]._** | +----------------------------------------------------------------------+ | **_numDL-Frames_** | | | | **_This field specifies the number of consecutive downlink subframes | | N~PRS~ with positioning reference signals, as defined in [16]. | | Enumerated values define 1, 2, 4, or 6 consecutive downlink | | subframes. The value sf-add indicates that N~PRS~ is provided in the | | field_ _add-numDL-Frames._ | +----------------------------------------------------------------------+ | **_prs-MutingInfo_**| | | | This field specifies the PRS muting configuration of the cell. The | | PRS muting configuration is defined by a periodic PRS muting | | sequence with periodicity T** _~REP~_**where T** _~REP~_**, counted | | in the number of PRS occasion groups [18], can be 2, 4, 8, 16, 32, | | 64, 128, 256, 512, or 1024 which is also the length of the selected | | bit string that represents this PRS muting sequence. If a bit in the | | PRS muting sequence is set to \"0\", then the PRS is muted in all | | the PRS occasions in the corresponding PRS occasion group. A PRS | | occasion group comprises one or more PRS occasions as indicated by | |_prsOccGroupLen*. Each PRS occasion comprises_** N~PRS\ ~**_downlink | | positioning subframes as defined in [16]. The first bit of the PRS | | muting sequence corresponds to the first PRS occasion group that | | starts after the beginning of the assistance data reference cell | | SFN=0. The sequence is valid for all subframes after the target | | device has received the_ prs-MutingInfo _. If this field is not | | present the target device may assume that the PRS muting is not in | | use for the cell. | | | | When the SFN of the assistance data reference cell is not known to | | the UE and_ prs-MutingInfo _is provided for a cell in the | |_ OTDOA-NeighbourCellInfoList* IE, the UE may assume no PRS is | | transmitted by that cell. | | | | When the UE receives a T~REP~-bit muting pattern together with a PRS | | periodicity T~PRS~ for the same cell which exceeds 10240 subframes | | (i.e., T~REP~ × T~PRS~ > 10240 subframes), the UE shall assume an | | n-bit muting pattern based on the first n‑bits, where n = | | 10240/T~PRS~. | +----------------------------------------------------------------------+ | **_prsID_**| | | |**_This field specifies the PRS-ID as defined in [16]._**| +----------------------------------------------------------------------+ |**_add-numDL-Frames_**| | | |**_This field specifies the number of consecutive downlink subframes | | N~PRS~ with positioning reference signals, as defined in [16]. | | Integer values define 1, 2, 3, ..., 160 consecutive downlink | | subframes._**| +----------------------------------------------------------------------+ |**_prsOccGroupLen_**| | | |**_This field specifies the PRS occasion group length, defined as | | the number of consecutive PRS occasions comprising a PRS occasion | | group. Each PRS occasion of the PRS occasion group consists of | | numDL-Frames or add-numDL-Frames consecutive downlink subframes with | | positioning reference signals. Enumerated values define 2, 4, 8, 16, | | 32, 64 or 128 consecutive PRS occasions. If omitted, the PRS | | occasion group length is 1. The product of the PRS periodicity | | T_PRS from the prs-ConfigurationIndex and the PRS occasion group | | length cannot exceed 1280._**| +----------------------------------------------------------------------+ |**_prsHoppingInfo_**| | | |**_This field specifies the PRS frequency hopping configuration | | [16]. The choice nb2 indicates hopping between 2 narrowbands; the | | choice nb4 indicates hopping between 4 narrowbands. The first PRS | | positioning occasion of the first PRS occasion group that starts | | after the beginning of SFN=0 of the assistance data reference cell | | is located at the centre of the system bandwidth. The frequency band | | of each subsequent PRS occasion is indicated by nb2 or nb4, | | respectively, which defines the narrowband index_**| | $n_{\text{NB}}$**_as specified in TS 36.211 [16]. If this field is | | absent, no PRS frequency hopping is used._ ** | +----------------------------------------------------------------------+
#### \-- _OTDOA-NeighbourCellInfoList_
The IE _OTDOA-NeighbourCellInfoList_ is used by the location server to provide
neighbour cell information for OTDOA assistance data. If the target device is
not capable of supporting additional neighbour cells (as indicated by the
absence of the IE _additionalNeighbourCellInfoList_ in _OTDOA-
ProvideCapabilities_), the set of cells in the _OTDOA-NeighbourCellInfoList_
is grouped per frequency layer and in the decreasing order of priority for
measurement to be performed by the target device, with the first cell in the
list being the highest priority for measurement and with the same _earfcn_ not
appearing in more than one instance of _OTDOA‑NeighbourFreqInfo_.
If the target device is capable of supporting additional neighbour cells (as
indicated by the presence of the IE _additionalNeighbourCellInfoList_ in
_OTDOA-ProvideCapabilities_)_,_ the list may contain all cells (up to 3x24
cells) belonging to the same frequency layer or cells from different frequency
layers with the first cell in the list still being the highest priority for
measurement.
The prioritization of the cells in the list is left to server implementation.
The target device should provide the available measurements in the same order
as provided by the server.
If inter-frequency neighbour cells are included in _OTDOA-
NeighbourCellInfoList_ , where an inter-frequency is a E-UTRA frequency which
is different from the E-UTRA serving cell frequency, the LPP layer shall
inform lower layers to start performing inter-frequency RSTD measurements for
these neighbour cells and also provide to lower layers the information about
these neighbour cells, e.g. EARFCN and PRS positioning occasion information.
\-- ASN1START
OTDOA-NeighbourCellInfoList ::= SEQUENCE (SIZE (1..maxFreqLayers)) OF OTDOA-
NeighbourFreqInfo
OTDOA-NeighbourFreqInfo ::= SEQUENCE (SIZE (1..24)) OF OTDOA-
NeighbourCellInfoElement
OTDOA-NeighbourCellInfoElement ::= SEQUENCE {
physCellId INTEGER (0..503),
cellGlobalId ECGI OPTIONAL, -- Need ON
earfcn ARFCN-ValueEUTRA OPTIONAL, -- Cond NotSameAsRef0
cpLength ENUMERATED {normal, extended, ...}
OPTIONAL, -- Cond NotSameAsRef1
prsInfo PRS-Info OPTIONAL, -- Cond NotSameAsRef2
antennaPortConfig ENUMERATED {ports-1-or-2, ports-4, ...}
OPTIONAL, -- Cond NotsameAsRef3
slotNumberOffset INTEGER (0..19) OPTIONAL, -- Cond NotSameAsRef4
prs-SubframeOffset INTEGER (0..1279) OPTIONAL, -- Cond InterFreq
expectedRSTD INTEGER (0..16383),
expectedRSTD-Uncertainty INTEGER (0..1023),
...,
[[ earfcn-v9a0 ARFCN-ValueEUTRA-v9a0 OPTIONAL -- Cond NotSameAsRef5
]],
[[ tpId-r14 INTEGER (0..4095) OPTIONAL, -- Need ON
prs-only-tp-r14 ENUMERATED { true } OPTIONAL, -- Cond TBS
cpLengthCRS-r14 ENUMERATED { normal, extended, ... }
OPTIONAL, -- Cond CRS
sameMBSFNconfigNeighbour-r14 BOOLEAN OPTIONAL, -- Need ON
dlBandwidth-r14 ENUMERATED {n6, n15, n25, n50, n75, n100}
OPTIONAL, -- Cond NotSameAsRef6
addPRSconfigNeighbour-r14 SEQUENCE (SIZE (1..maxAddPRSconfig-r14)) OF
Add-PRSconfigNeighbourElement-r14
OPTIONAL -- Need ON
]]
}
Add-PRSconfigNeighbourElement-r14 ::= SEQUENCE {
add-prsInfo-r14 PRS-Info OPTIONAL, -- Cond NotSameAsRef7
...
}
maxFreqLayers INTEGER ::= 3
\-- ASN1STOP
* * *
Conditional presence Explanation _NotsameAsRef0_ The field is absent if
_earfcn-v9a0_ is present. If earfcn-v9a0 is not present, the field is
mandatory present **if the EARFCN is not the same as for the assistance data
reference cell** ; otherwise it is not present. _NotsameAsRef1_ The field is
mandatory present **if the cyclic prefix length is not the same as for the
assistance data reference cell** ; otherwise it is not present.
_NotsameAsRef2_ The field is mandatory present **if the first PRS
configuration is not the same as for the assistance data reference cell** ;
otherwise it is not present. _NotsameAsRef3_ The field is mandatory present
**if the antenna port configuration is not the same as for the assistance data
reference cell** ; otherwise it is not present. _NotsameAsRef4_ The field is
mandatory present **if the slot timing is not the same as for the assistance
data reference cell** ; otherwise it is not present. _NotSameAsRef5_ The field
is absent if _earfcn_ is present. If _earfcn_ is not present, the field is
mandatory present **if the EARFCN is not the same as for the assistance data
reference cell** ; otherwise it is not present. _InterFreq_ The field is
optionally present, need OP, if the EARFCN is not the same as for the
assistance data reference cell; otherwise it is not present. _TBS_ The field
is mandatory present if the _OTDOA-NeighbourCellInfoElement_ is provided for a
PRS-only TP; otherwise it is not present. _CRS_ The field is optionally
present, need ON, if **_prsInfo is present_**. Otherwise it is not present.
_NotSameAsRef6_ The field is mandatory present if PRS frequency hopping is
used on this neighbour cell [16] and if the downlink bandwidth configuration
is not the same as for the assistance data reference cell; otherwise it is not
present. _NotSameAsRef7_ The field is mandatory present if any instance of the
additional PRS configurations of _addPRSconfigNeighbour_ is not the same as
the corresponding instance of the additional PRS configuration of the
_addPRSconfigRef_ for the assistance data reference cell; otherwise it is not
present.
* * *
+----------------------------------------------------------------------+ | _OTDOA-NeighbourCellInfoList field descriptions_ | +----------------------------------------------------------------------+ | **_physCellId_** | | | | This field specifies the physical cell identity of the neighbour | | cell, as defined in [12]. | +----------------------------------------------------------------------+ | **_cellGlobalId_** | | | | This field specifies the ECGI, the globally unique identity of a | | cell in E-UTRA, of the neighbour cell, as defined in [12]. The | | server should provide this field if it considers that it is needed | | to resolve any ambiguity in the cell identified by _physCellId_. | +----------------------------------------------------------------------+ | **_earfcn_** | | | | This field specifies the EARFCN of the neighbour cell. | +----------------------------------------------------------------------+ | **_cpLength_** | | | | **_This field specifies the cyclic prefix length of the neigbour | | cell PRS if PRS are present in this neighbour cell, otherwise this | | field specifies the cyclic prefix length of CRS in this neighbour | | cell._** | +----------------------------------------------------------------------+ | **_prsInfo_** | | | | **_This field specifies the first PRS configuration of the neighbour | | cell._** | | | | **_When_** the EARFCN of the neighbour cell is the same as for the | | assistance data reference cell, **_t_** he target device may assume | | that each PRS positioning occasion in the neighbour cell at least | | partially overlaps with a PRS positioning occasion in the assistance | | data reference cell where the maximum offset between the transmitted | | PRS positioning occasions may be assumed to not exceed half a | | subframe. | | | | When the EARFCN of the neighbour cell is the same as for the | | assistance data reference cell, the target may assume that this cell | | has the same PRS periodicity (T~PRS~) as the assistance data | | reference cell. | +----------------------------------------------------------------------+ | **_antennaPortConfig_** | | | | This field specifies whether 1 (or 2) antenna port(s) or 4 antenna | | ports for cell specific reference signals are used. | +----------------------------------------------------------------------+ | **_slotNumberOffset_** | | | | This field specifies the slot number offset at the transmitter | | between this cell and the assistance data reference cell. | | | | The _slotNumberOffset_ together with the current slot number of the | | assistance data reference cell may be used to calculate the current | | slot number of this cell which may further be used to generate the | | CRS sequence by the target device. The offset corresponds to the | | number of full slots counted from the beginning of a radio frame of | | the assistance data reference cell to the beginning of the closest | | subsequent radio frame of this cell. If this field is absent, the | | slot timing is the same as for the assistance data reference cell. | +----------------------------------------------------------------------+ | **_prs-SubframeOffset_** | | | | This field specifies the offset between the first PRS subframe of | | the first PRS occasion group of the first PRS configuration in the | | assistance data reference cell on the reference carrier frequency | | layer and the first PRS subframe in the closest subsequent PRS | | occasion group of the PRS configuration with the longest PRS | | occasion group periodicity (NOTE) of this cell on the other carrier | | frequency layer. The value is given in number of full sub-frames. If | | the EARFCN is not the same as for the assistance data reference cell | | and the field is not present but PRS are available on this cell, the | | receiver shall consider the PRS subframe offset for this cell to be | | 0. | +----------------------------------------------------------------------+ | **_expectedRSTD_** | | | | If PRS is transmitted: | | | | This field indicates the RSTD value that the target device is | | expected to measure between this cell and the assistance data | | reference cell. The _expectedRSTD_ field takes into account the | | expected propagation time difference as well as transmit time | | difference of PRS positioning occasions between the two cells. The | | RSTD value can be negative and is calculated as | | (_expectedRSTD_ -8192). The resolution is 3×T~s~, with | | T~s~=1/(15000*2048) seconds. | | | | If PRS is not transmitted: | | | | This field indicates the RSTD value that the target device is | | expected to measure between this cell and the assistance data | | reference cell. The expectedRSTD field takes into account the | | expected propagation time difference as well as transmit time | | difference between the two cells. The RSTD value can be negative and | | is calculated as (expectedRSTD-8192). The resolution is 3´T~s~, with | | T~s~=1/(15000*2048) seconds. | +----------------------------------------------------------------------+ | **_expectedRSTD-Uncertainty_** | | | | If PRS is transmitted: | | | | This field indicates the uncertainty in _expectedRSTD_ value** _._** | | The uncertainty is related to the location server\'s a‑priori | | estimation of the target device location. The _expectedRSTD_ and | | _expectedRSTD-Uncertainty_ together define the search window for the | | target device. | | | | The scale factor of the _expectedRSTD-Uncertainty_ field is 3×T~s~, | | with T~s~=1/(15000*2048) seconds. | | | | The target device may assume that the beginning of the PRS occasion | | group of the PRS configuration with the longest PRS occasion group | | periodicity (NOTE) of the neighbour cell is received within the | | search window of size | | | | [_− expectedRSTD-Uncertainty_ ×3×T~s~_, | | expectedRSTD-Uncertainty_ ×3×T~s~] centered at | | | | T~REF~ _+_ 1 millisecond×N + _(expectedRSTD−_ 8192) ×3×T~s~, where | | T~REF~ is the reception time of the beginning of the first PRS | | occasion group of the first PRS configuration of the assistance data | | reference cell at the target device antenna connector, N = 0 when | | the EARFCN of the neighbour cell is equal to that of the assistance | | data reference cell, and N = _prs-SubframeOffset_ otherwise. | | | | If PRS is not transmitted: | | | | This field indicates the uncertainty in _expectedRSTD_ value** _._** | | The uncertainty is related to the location server\'s a‑priori | | estimation of the target device location. The _expectedRSTD_ and | | _expectedRSTD-Uncertainty_ together define the search window for the | | target device. The scale factor of the _expectedRSTD-Uncertainty_ | | field is 3×T~s~, with T~s~=1/(15000*2048) seconds. | | | | If T~x~ is the reception time of the beginning of the subframe X of | | the assistance data reference cell at the target device antenna | | connector, the target device may assume that the beginning of the | | closest subframe of this neighbour cell to subframe X is received | | within the search window of size [_− | | expectedRSTD-Uncertainty_ ×3×T~s~_, | | expectedRSTD-Uncertainty_ ×3×T~s~] centered at T~x~ + | | _(expectedRSTD−_ 8192) ×3×T~s~, | +----------------------------------------------------------------------+ | **_tpId_** | | | | This field specifies an identity of the transmission point. This | | field together with the _physCellId_ and/or _prsID_ may be used to | | identify the transmission point in case the same physical cell ID is | | shared by multiple transmission points. | +----------------------------------------------------------------------+ | **_prs-only-tp_** | | | | This field, if present, indicates that the | | _OTDOA-NeighbourCellInfoElement_ is provided for a PRS-only TP. | | | | For the purpose of RSTD measurements from a PRS-only TP, the target | | device shall not assume any other signals or physical channels are | | present other than PRS [28]. | | | | For the purpose of RSTD measurements from a PRS-only TP, the target | | device shall use the _physCellId_ only for PRS generation, and only | | if no PRS-ID is provided for this TP. | +----------------------------------------------------------------------+ | **_cpLengthCRS_** | | | | **_This field specifies the cyclic prefix length of_** this | | assistance data neighbour cell **_CRS. If this field is present, the | | target device may assume_** the CRS and PRS antenna ports of this | | assistance data neighbour cell are quasi co-located (as defined in | | [16]). | +----------------------------------------------------------------------+ | **_sameMBSFNconfigNeighbour_** | | | | This field indicates whether the MBSFN subframe configuration of the | | neighbour cell is the same as the current primary cell of the target | | device. TRUE means the same, and FALSE means not the same. | +----------------------------------------------------------------------+ | **_dlBandwidth_** | | | | This field specifies the downlink bandwidth configuration of the | | neighbour cell, N~RB~ in downlink, see TS 36.101 [21, table | | 5.6-1]. Enumerated value n6 corresponds to 6 resource blocks, n15 | | to 15 resource blocks and so on. | +----------------------------------------------------------------------+ | **_addPRSconfigNeighbour_** | | | | This field specifies the additional (second and possibly third) PRS | | configuration(s) of the neighbour cell. When the EARFCN of the | | neighbour cell is the same as for the assistance data reference | | cell, the target device may assume that each PRS positioning | | occasion in each instance of _addPRSconfigNeighbour_ in the | | neighbour cell at least partially overlaps with a PRS positioning | | occasion of the same instance of _addPRSconfigRef_ in the assistance | | data reference cell where the maximum offset between the transmitted | | PRS positioning occasions may be assumed to not exceed half a | | subframe. | | | | When the EARFCN of the neighbour cell is the same as for the | | assistance data reference cell, the target may assume that each | | instance of _addPRSconfigNeighbour_ of this cell has the same PRS | | periodicity (T~PRS~) as the corresponding instance of | | _addPRSconfigRef_ of the assistance data reference cell. | +----------------------------------------------------------------------+
NOTE: If this cell has more than one PRS configuration with equal longest PRS
occasion group periodicity (i.e., PRS occasion group length times T~PRS~), the
first such configuration is referenced. In order to avoid ambiguity for
frequency hopping, a PRS occasion group should contain at least 2 PRS
occasions with hopping between 2 narrowbands and at least 4 PRS occasions with
hopping between 4 narrowbands.
#### \-- _OTDOA-ReferenceCellInfoNB_
The IE _OTDOA-ReferenceCellInfoNB_ is used by the location server to provide
NB-IoT assistance data reference cell information for OTDOA assistance data.
\-- ASN1START
OTDOA-ReferenceCellInfoNB-r14 ::= SEQUENCE {
physCellIdNB-r14 INTEGER (0..503) OPTIONAL, -- Cond NoPRS-AD1
cellGlobalIdNB-r14 ECGI OPTIONAL, -- Cond NoPRS-AD2
carrierFreqRef-r14 CarrierFreq-NB-r14 OPTIONAL, -- Cond NotSameAsServ1
earfcn-r14 ARFCN-ValueEUTRA-r14 OPTIONAL, -- Cond Inband
eutra-NumCRS-Ports-r14 ENUMERATED {ports1-or-2, ports4}
OPTIONAL, -- Cond NoPRS-AD3
otdoa-SIB1-NB-repetitions-r14 ENUMERATED { r4, r8, r16 } OPTIONAL, -- Cond
NotSameAsServ2
nprsInfo-r14 PRS-Info-NB-r14 OPTIONAL, -- Cond NPRS-Type1
...,
[[
nprsInfo-Type2-v1470 PRS-Info-NB-r14 OPTIONAL -- Cond NPRS-Type2
]]
}
\-- ASN1STOP
* * *
Conditional presence Explanation _NoPRS-AD1_ This field is mandatory present
if the _OTDOA-ReferenceCellInfo_ IE is not included in
_OTDOA‑ProvideAssistanceData,_ or if the _OTDOA-ReferenceCellInfo_ IE is
included in _OTDOA‑ProvideAssistanceData_ and the narrowband physical layer
cell identity is not the same as the physical cell identity provided in
_OTDOA-ReferenceCellInfo_ IE. Otherwise it is not present. _NoPRS-AD2_ This
field is optionally present, need ON, if the _OTDOA-ReferenceCellInfo_ IE is
not included in _OTDOA‑ProvideAssistanceData,_ or if the _OTDOA-
ReferenceCellInfo_ IE is included in _OTDOA‑ProvideAssistanceData_ and the
global cell identity is not the same as provided in _OTDOA-ReferenceCellInfo_
IE. _NotSameAsServ1_ This field is mandatory present if the carrier frequency
of the NB-IoT assistance data reference cell is not the same as the carrier
frequency of the target devices\' current serving NB-IoT cell. Otherwise it is
not present. _Inband_ This field is mandatory present, if the NPRS is
configured within the LTE spectrum allocation (inband deployment). Otherwise
it is not present. _NoPRS-AD3_ This field is mandatory present if the _OTDOA-
ReferenceCellInfo_ IE is not included in _OTDOA‑ProvideAssistanceData_ and if
the NB-IoT assistance data reference cell is deployed within the LTE spectrum
allocation (inband deployment)_._ Otherwise it is not present.
_NotSameAsServ2_ This field is mandatory present, if NPRS configuration Part B
only is configured on the NB-IoT assistance data reference cell, and if the
repetition number of SIB1-NB of the NB‑IoT assistance data reference cell is
not the same as the repetition number of SIB1‑NB of the target devices\'
current serving NB-IoT cell. Otherwise it is not present. _NPRS-Type1_ The
field is mandatory present if Type 1 narrowband positioning reference signals
are available in the assistance data reference cell [16]; otherwise it is not
present. _NPRS-Type2_ The field is mandatory present if Type 2 narrowband
positioning reference signals are available in the assistance data reference
cell [16]; otherwise it is not present.
* * *
+----------------------------------------------------------------------+ | _OTDOA-ReferenceCellInfoNB field descriptions_ | +----------------------------------------------------------------------+ | **_physCellIdNB_** | | | | This field specifies the narrowband physical layer cell identity of | | the NB-IoT assistance data reference cell, as defined in [12]. If | | this field is absent and if the _OTDOA-ReferenceCellInfo_ IE is | | included in _OTDOA‑ProvideAssistanceData_ the narrowband physical | | layer cell identity is the same as the _physCellId_ provided in | | _OTDOA‑ReferenceCellInfo_ IE. | +----------------------------------------------------------------------+ | **_cellGlobalIdNB_** | | | | This field specifies the global cell identity of the NB-IoT | | assistance data reference cell, as defined in [12]. If this field | | is absent and if the _OTDOA-ReferenceCellInfo_ IE with | | _cellGlobalId_ is included in _OTDOA‑ProvideAssistanceData,_ the | | global cell identity is the same as provided in | | _OTDOA‑ReferenceCellInfo_ IE _._ | +----------------------------------------------------------------------+ | **_carrierFreqRef_** | | | | This field specifies the carrier frequency of the NB-IoT assistance | | data reference cell. | +----------------------------------------------------------------------+ | **_earfcn_** | | | | This field specifies the EARFCN of the E-UTRAN frequency, in which | | the NB-IoT cell is deployed. | +----------------------------------------------------------------------+ | **_eutra-NumCRS-Ports_** | | | | This field specifies whether 1 (or 2) antenna port(s) or 4 antenna | | ports for cell specific reference signals (CRS) are used in the | | NB-IoT assistance data reference cell. If this field is absent and | | if the _OTDOA-ReferenceCellInfo_ IE is included in | | _OTDOA‑ProvideAssistanceData_ , the number of CRS antenna ports is | | the same as provided in _OTDOA‑ReferenceCellInfo_ IE. | +----------------------------------------------------------------------+ | **_otdoa-SIB1-NB-repetitions_** | | | | This field specifies the repetition number of SIB1-NB of the NB-IoT | | assistance data reference cell. Enumerated values r4 correspond to 4 | | repetions, r8 to 8 repetitions, and r16 to 16 repetions. | | | | Note, when NPRS configuration Part B only is configured on the | | NB-IoT assistance data reference cell (i.e., anchor carrier), | | _nprs-NumSF_ does also count/include subframes containing NPSS, | | NSSS, NPBCH, or SIB1-NB, but the UE can assume that no NPRS are | | transmitted in these subframes [16]. | +----------------------------------------------------------------------+ | **_nprsInfo_** | | | | **_This field specifies the Type 1 NPRS [16] configuration of | | the_** NB-IoT **_assistance data reference cell._** | | | | **_When the target device receives this field with | | operationModeInfoNPRS set to value \'standalone\', the target device | | shall assume no NPRS are transmitted on that NB-IoT carrier._** | +----------------------------------------------------------------------+ | **_nprsInfo-Type2_** | | | | This field specifies the Type 2 NPRS [16] configuration of the | | NB-IoT assistance data reference cell. | +----------------------------------------------------------------------+
#### \-- _PRS-Info-NB_
The IE _PRS-Info-NB_ provides the information related to the configuration of
NPRS in a cell. If _PRS-Info-NB_ includes configurations for multiple NPRS
carrier frequencies, the target device may assume the antenna ports for the
NPRS carrier are quasi co-located, as defined in [16].
\-- ASN1START
PRS-Info-NB-r14 ::= SEQUENCE (SIZE (1..maxCarrier-r14)) OF NPRS-Info-r14
NPRS-Info-r14 ::= SEQUENCE {
operationModeInfoNPRS-r14 ENUMERATED { inband, standalone },
nprs-carrier-r14 CarrierFreq-NB-r14 OPTIONAL, -- Cond Standalone/Guardband
nprsSequenceInfo-r14 INTEGER (0..174) OPTIONAL, -- Cond Inband
nprsID-r14 INTEGER (0..4095) OPTIONAL, -- Cond NPRS-ID
partA-r14 SEQUENCE {
nprsBitmap-r14 CHOICE {
subframePattern10-r14 BIT STRING (SIZE (10)),
subframePattern40-r14 BIT STRING (SIZE (40))
},
nprs-MutingInfoA-r14 CHOICE {
po2-r14 BIT STRING (SIZE(2)),
po4-r14 BIT STRING (SIZE(4)),
po8-r14 BIT STRING (SIZE(8)),
po16-r14 BIT STRING (SIZE(16)),
...
} OPTIONAL, -- Cond MutingA
...
} OPTIONAL, -- Cond PartA
partB-r14 SEQUENCE {
nprs-Period-r14 ENUMERATED { ms160, ms320, ms640, ms1280, ... },
nprs-startSF-r14 ENUMERATED { zero, one-eighth, two-eighths, three-eighths,
four-eighths, five-eighths, six-eighths,
seven-eighths, ...},
nprs-NumSF-r14 ENUMERATED { sf10, sf20, sf40, sf80, sf160, sf320,
sf640, sf1280, ...},
nprs-MutingInfoB-r14 CHOICE {
po2-r14 BIT STRING (SIZE(2)),
po4-r14 BIT STRING (SIZE(4)),
po8-r14 BIT STRING (SIZE(8)),
po16-r14 BIT STRING (SIZE(16)),
...
} OPTIONAL, -- Cond MutingB
...
} OPTIONAL, -- Cond PartB
...
}
maxCarrier-r14 INTEGER ::= 5
\-- ASN1STOP
+------------------------+--------------------------------------------+ | _Conditional presence_ | _Explanation_ | +------------------------+--------------------------------------------+ | _Standalone/Guardband_ | This field is mandatory present, if the | | | NPRS is configured in standalone or | | | guardband operation mode. Otherwise it is | | | not present. | +------------------------+--------------------------------------------+ | _Inband_ | This field is mandatory present, if the | | | NPRS is configured within the LTE spectrum | | | allocation (inband deployment) and the LTE | | | carrier frequency is not provided in the | | | assistance data. Otherwise it is not | | | present. | +------------------------+--------------------------------------------+ | _NPRS-ID_ | The field is mandatory present, if the | | | NPRS is generated based on the NPRS-ID | | | [16], different from the PCI. Otherwise | | | the field is not present. | +------------------------+--------------------------------------------+ | _MutingA_ | The field is mandatory present, if muting | | | is used for the NPRS Part A configuration. | | | Otherwise the field is not present. | +------------------------+--------------------------------------------+ | _PartA_ | The field is mandatory present, if NPRS is | | | configured based on a bitmap of subframes | | | which are not NB-IoT DL subframes (i.e., | | | invalid DL subframes) (Part A | | | configuration). Otherwise the field is not | | | present. | +------------------------+--------------------------------------------+ | _MutingB_ | The field is mandatory present, if muting | | | is used for the NPRS Part B configuration. | | | Otherwise the field is not present. | +------------------------+--------------------------------------------+ | _PartB_ | The field is mandatory present, if NPRS is | | | configured based on a NPRS period, a NPRS | | | subframe offset, and a number of | | | consecutive NPRS downlink subframes per | | | positioning occasion (Part B | | | configuration). Otherwise the field is not | | | present. | | | | | | If NPRS configuration Part A and Part B | | | are both configured, then a subframe | | | contains NPRS if both configurations | | | indicate that it contains NPRS. | +------------------------+--------------------------------------------+
+----------------------------------------------------------------------+ | _PRS-Info-NB field descriptions_ | +----------------------------------------------------------------------+ | **_operationModeInfoNPRS_** | | | | This field specifies the operation mode of the NPRS carrier. The | | value \'standalone\' indicates standalone or guardband operation | | mode. | +----------------------------------------------------------------------+ | **_nprs-carrier_** | | | | This field specifies the NB-IoT carrier frequency for the NPRS. | +----------------------------------------------------------------------+ | **_nprsSequenceInfo_** | | | | This field specifies the index of the PRB containing the NPRS as | | defined in the table _nprsSequenceInfo_ to E‑UTRA PRB index relation | | below. | +----------------------------------------------------------------------+ | **_nprsID_** | | | | **_This field specifies the NPRS-ID as defined in [16]._** | +----------------------------------------------------------------------+ | **_subframePattern10, subframePattern40_** | | | | **_This field specifies the NPRS subframe Part A configuration over | | 10ms or 40ms. Subframes not containing NPRS are indicated with value | | \'0\' in the bitmap; subframes containing NPRS are indicated with | | value \'1\' in the bitmap. The first/leftmost bit corresponds to the | | subframe #0 of the radio frame satisfying SFN mod x = 0, where x is | | the size of the bit string divided by 10._** | +----------------------------------------------------------------------+ | **_nprs-MutingInfoA_** | | | | This field specifies the NPRS muting configuration of the NB-IoT | | carrier Part A configuration. The NPRS muting configuration is | | defined by a periodic NPRS muting sequence with periodicity | | T** _~REP~_** where T** _~REP~_** , counted in the number of NPRS | | positioning occasions, can be 2, 4, 8, or 16 which is also the | | length of the selected bit string that represents this NPRS muting | | sequence. If a bit in the NPRS muting sequence is set to \'0\', then | | the NPRS is muted in the corresponding NPRS positioning occasion. A | | NPRS positioning occasion for Part A comprises one radio frame | | (i.e., 10 subframes). The first** _/leftmost_** bit of the NPRS | | muting sequence corresponds to the first NPRS positioning occasion | | that starts after the beginning of the NB-IoT assistance data | | reference cell SFN=0. The sequence is valid for all subframes after | | the target device has received the _nprs-MutingInfoA_. | | | | When the SFN of the NB-IoT assistance data reference cell is not | | known to the target device and _nprs-MutingInfoA_ is provided for a | | cell in the _OTDOA-NeighbourCellInfoListNB_ IE, the target device | | may assume no NPRS is transmitted by that cell. | +----------------------------------------------------------------------+ | **_nprs-Period_** | | | | **_This field specifies the NPRS occasion period T~NPRS~ [16]. | | Enumerated values correspond to_** 160ms, 320ms, 640ms, and 1280ms. | +----------------------------------------------------------------------+ | **_nprs-startSF_** | | | | **_This field specifies the subframe offset_** | | $\alpha_{\text{NPRS}}$ [16]. Enumerated values correspond to α of | | 0, 1/8, 2/8, 3/8, 4/8, 5/8, 6/8, or 7/8** _._** | +----------------------------------------------------------------------+ | **_nprs-NumSF_** | | | | **_This field specifies the number of consecutive downlink subframes | | N~NPRS~ in one NPRS positioning occasion [16]. Enumerated values | | correspond to 10, 20, 40, 80, 160, 320, 640, and 1280 subframes._** | | | | **_When the target device receives a nprs-NumSF which exceeds the | | nprs-Period (i.e., N~NPRS~ > T~NPRS~), the target device may | | assume_** no NPRS is transmitted by that cell. | +----------------------------------------------------------------------+ | **_nprs-MutingInfoB_** | | | | This field specifies the NPRS muting configuration of the NB-IoT | | carrier Part B configuration. The NPRS muting configuration is | | defined by a periodic NPRS muting sequence with periodicity | | T** _~REP~_** where T** _~REP~_** , counted in the number of NPRS | | positioning occasions, can be 2, 4, 8, or 16 which is also the | | length of the selected bit string that represents this NPRS muting | | sequence. If a bit in the NPRS muting sequence is set to \'0\', then | | the NPRS is muted in the corresponding NPRS positioning occasion. A | | NPRS positioning occasion for Part B comprises **_N~NPRS~ | | consecutive_** downlink positioning subframes, where N~NPRS~ is | | given by the _nprs-NumSF_ field. The first** _/leftmost_** bit of the | | NPRS muting sequence corresponds to the first NPRS positioning | | occasion that starts after the beginning of the NB-IoT assistance | | data reference cell SFN=0. The sequence is valid for all subframes | | after the target device has received the _nprs‑MutingInfoB_. | | | | When the SFN of the NB-IoT assistance data reference cell is not | | known to the UE and _nprs-MutingInfoB_ is provided for a cell in the | | _OTDOA-NeighbourCellInfoListNB_ IE, the target device may assume no | | NPRS is transmitted by that cell. | | | | When the UE receives a T~REP~-bit muting pattern together with a | | NPRS periodicity T~NPRS~ for the same carrier which exceeds 10240 | | subframes (i.e., T~REP~ × T~NPRS~ > 10240 subframes), the target | | device shall assume an n-bit muting pattern based on the first n | | bits, where n = 10240/T~NPRS~. | +----------------------------------------------------------------------+
_nprsSequenceInfo_ to E‑UTRA PRB index relation
* * *
_nprsSequenceInfo_ E-UTRA PRB index $n_{\text{PRB}}^{'}$for odd number of
$N_{\text{RB}}^{\text{DL}}$[16] _nprsSequenceInfo_ E-UTRA PRB index
$n_{\text{PRB}}^{'}$for even number of $N_{\text{RB}}^{\text{DL}}$[16] 0 - 74
-37, -36, ..., 37 75 -- 174 -50, -49, ..., 49
* * *
NOTE: Based on the above relation, in inband deployment, the carrier frequency
of the NPRS carrier (_f_ ~NB-IoT~) can be calculated as follows:
> {width="4.4840277777777775in" height="0.925in"}
>
> where _f_ ~EUTRA~ is derived from _earfcn_ according to TS 36.101 [21,
> 5.7.3].
#### \-- _OTDOA-NeighbourCellInfoListNB_
The IE _OTDOA-NeighbourCellInfoListNB_ is used by the location server to
provide NB-IoT neighbour cell information for OTDOA assistance data.
\-- ASN1START
OTDOA-NeighbourCellInfoListNB-r14 ::= SEQUENCE (SIZE (1..maxCells-r14)) OF
OTDOA-NeighbourCellInfoNB-r14
OTDOA-NeighbourCellInfoNB-r14 ::= SEQUENCE {
physCellIdNB-r14 INTEGER (0..503) OPTIONAL, -- Cond NoPRS-AD1
cellGlobalIdNB-r14 ECGI OPTIONAL, -- Cond NoPRS-AD2
carrierFreq-r14 CarrierFreq-NB-r14 OPTIONAL, -- Cond NotSameAsRef1
earfcn-r14 ARFCN-ValueEUTRA-r14 OPTIONAL, -- Cond Inband
eutra-NumCRS-Ports-r14 ENUMERATED {ports-1-or-2, ports-4, ...}
OPTIONAL, -- Cond NotsameAsRef2
otdoa-SIB1-NB-repetitions-r14 ENUMERATED { r4, r8, r16 }
OPTIONAL, -- Cond NotSameAsRef3
nprsInfo-r14 PRS-Info-NB-r14 OPTIONAL, -- Cond NotsameAsRef4
nprs-slotNumberOffset-r14 INTEGER (0..19) OPTIONAL, -- Cond NotsameAsRef5
nprs-SFN-Offset-r14 INTEGER (0..63) OPTIONAL, -- Cond NotsameAsRef6
nprs-SubframeOffset-r14 INTEGER (0..1279) OPTIONAL, -- Need OP
expectedRSTD-r14 INTEGER (0..16383) OPTIONAL, -- Cond NoPRS-AD3
expectedRSTD-Uncertainty-r14 INTEGER (0..1023) OPTIONAL, -- Cond NoPRS-AD3
prsNeighbourCellIndex-r14 INTEGER (1..72) OPTIONAL, -- Cond PRS-AD
...,
[[
nprsInfo-Type2-v1470 PRS-Info-NB-r14 OPTIONAL -- Cond NotSameAsRef4
]]
}
maxCells-r14 INTEGER ::= 72
\-- ASN1STOP
* * *
Conditional presence Explanation _NoPRS-AD1_ This field is mandatory present
if the _OTDOA-NeighbourCellInfoList_ IE is not included in
_OTDOA‑ProvideAssistanceData,_ or if the _OTDOA-NeighbourCellInfoList_ IE is
included in _OTDOA‑ProvideAssistanceData_ and the narrowband physical layer
cell identity of this cell is not the same as the physical cell identity of
the corresponding cell (as indicated by _prsNeighbourCellIndex_) in
_OTDOA‑NeighbourCellInfoList_ IE. _NoPRS-AD2_ This field is optionally
present, need ON, if the _OTDOA-NeighbourCellInfoList_ IE is not included in
_OTDOA‑ProvideAssistanceData,_ or if the _OTDOA-NeighbourCellInfoList_ IE is
included in _OTDOA‑ProvideAssistanceData_ and the global cell identity of this
cell is not the same as for the corresponding cell (as indicated by
_prsNeighbourCellIndex_) in _OTDOA‑NeighbourCellInfoList_ IE. _Inband_ This
field is mandatory present, if the NPRS is configured within the LTE spectrum
allocation (inband deployment). Otherwise it is not present. _NotSameAsRef1_
The field is mandatory present **if the** carrier frequency **is not the same
as for the NB-IoT assistance data reference cell** ; otherwise it is not
present. _NotSameAsRef2_ The field is mandatory present if this cell is
deployed within the LTE spectrum allocation (inband deployment) and **if the
number of** E-UTRA CRS antenna ports **is not the same as for the NB-IoT
assistance data reference cell** ; otherwise it is not present.
_NotSameAsRef3_ This field is mandatory present if NPRS configuration Part B
only is configured on this neighbour cell, and if the repetition number of
SIB1-NB of this neighbor cell is not the same as the repetition number of
SIB1‑NB of the NB-IoT assistance data reference cell. Otherwise it is not
present. _NotSameAsRef4_ The field is mandatory present, if the NPRS
configuration is not the same as for the NB‑IoT assistance data reference
cell; otherwise it is not present. _NotSameAsRef5_ The field is mandatory
present **if the slot timing is not the same as for the NB-IoT assistance data
reference cell** ; otherwise it is not present. _NotSameAsRef6_ The field is
mandatory present **if the frame timing is not the same as for the NB-IoT
assistance data reference cell** ; otherwise it is not present. _NoPRS-AD3_
This field is mandatory present if the _OTDOA-NeighbourCellInfoList_ IE is not
included in _OTDOA‑ProvideAssistanceData,_ or if the _OTDOA-
NeighbourCellInfoList_ IE is included in _OTDOA‑ProvideAssistanceData_ and
_prsNeighbourCellIndex_ is absent for this cell. _PRS-AD_ This field is
optionally present, need OP, if the _OTDOA-NeighbourCellInfoList_ IE is
included in _OTDOA‑ProvideAssistanceData_ ; otherwise it is not present.
* * *
+----------------------------------------------------------------------+ | _OTDOA-NeighbourCellInfoListNB field descriptions_ | +----------------------------------------------------------------------+ | **_physCellIdNB_** | | | | This field specifies the narrowband physical cell identity of the | | NB-IoT neighbour cell, as defined in [12]. If this field is absent | | and if the _OTDOA-NeighbourCellInfoList_ IE is included in | | _OTDOA‑ProvideAssistanceData_ the narrowband physical layer cell | | identity is the same as the _physCellId_ provided for the | | corresponding cell (as indicated by _prsNeighbourCellIndex_) in | | _OTDOA‑NeighbourCellInfoList_ IE. | +----------------------------------------------------------------------+ | **_cellGlobalIdNB_** | | | | This field specifies the global cell ID of the NB-IoT neighbour | | cell, as defined in [12]. If this field is absent and if the | | _OTDOA‑NeighbourCellInfoList_ IE with _cellGlobalId_ is included in | | _OTDOA‑ProvideAssistanceData,_ the global cell identity of the | | NB-IoT neighbour cell is the same as provided for the corresponding | | cell (as indicated by _prsNeighbourCellIndex_) in | | _OTDOA‑NeighbourCellInfoList_ IE _._ | +----------------------------------------------------------------------+ | **_carrierFreq_** | | | | This field specifies the carrier frequency of the NB-IoT neighbour | | cell. | +----------------------------------------------------------------------+ | **_earfcn_** | | | | This field specifies the EARFCN of the E-UTRAN frequency, in which | | the NB-IoT cell is deployed. | +----------------------------------------------------------------------+ | **_eutra-NumCRS-Ports_** | | | | This field specifies whether 1 (or 2) antenna port(s) or 4 antenna | | ports for cell specific reference signals are used. | +----------------------------------------------------------------------+ | **_otdoa-SIB1-NB-repetitions_** | | | | This field specifies the repetition number of SIB1-NB of the | | neighbour cell. Enumerated values r4 correspond to 4 repetions, r8 | | to 8 repetitions, and r16 to 16 repetions. | | | | Note, when NPRS configuration Part B only is configured on this | | NB-IoT neighbour cell (i.e., anchor carrier), _nprs-NumSF_ does also | | count/include subframes containing NPSS, NSSS, NPBCH, or SIB1-NB, | | but the UE can assume that no NPRS are transmitted in these | | subframes [16]. | +----------------------------------------------------------------------+ | **_nprsInfo_** | | | | **_This field specifies the Type 1 NPRS [16] configuration of the | | NB-IoT neighbour cell._** | | | | **_When_** the carrier frequency of the NB-IoT neighbour cell is the | | same as for the NB-IoT assistance data reference cell, **_t_** he | | target device may assume that each NPRS positioning occasion for | | each NPRS carrier frequency in the neighbour cell at least partially | | overlaps with a NPRS positioning occasion for each NPRS carrier | | frequency in the NB-IoT assistance data reference cell where the | | maximum offset between the transmitted NPRS positioning occasions | | may be assumed to not exceed half a subframe. | | | | When the carrier frequency of the neighbour cell is the same as for | | the NB-IoT assistance data reference cell, and NPRS configuration | | Part B is configured, the target may assume that this cell has the | | same NPRS periodicity (T~NPRS~) as the assistance data reference | | cell for each NPRS carrier frequency. | | | | **_When the target device receives this field with | | operationModeInfoNPRS set to value \'standalone\', the target device | | shall assume no NPRS are transmitted on that NB-IoT carrier._** | +----------------------------------------------------------------------+ | **_nprs-slotNumberOffset_** | | | | This field specifies the slot number offset at the transmitter | | between this cell and the NB-IoT assistance data reference cell. The | | offset corresponds to the number of full slots counted from the | | beginning of a radio frame of the NB-IoT assistance data reference | | cell to the beginning of the closest subsequent radio frame of this | | cell. If this field is absent, the slot timing is the same as for | | the NB-IoT assistance data reference cell. | +----------------------------------------------------------------------+ | **_nprs-SFN-Offset_** | | | | This field specifies the SFN offset (modulo 64) at the transmitter | | between this cell and the NB-IoT assistance data reference cell. The | | offset corresponds to the number of full radio frames counted from | | the beginning of a radio frame #0 of the NB‑IoT assistance data | | reference cell to the beginning of the closest subsequent radio | | frame #0 of this cell. | | | | The UE may use this field together with the _nprs-slotNumberOffset_ | | and _otdoa-SIB1-NB-repetitions_ to determine the SIB1-NB subframes | | of this neighbour cell. | +----------------------------------------------------------------------+ | **_nprs-SubframeOffset_** | | | | This field specifies the offset between the first NPRS subframe in | | the NB-IoT assistance data reference cell (NOTE 1) and the first | | NPRS subframe in the closest subsequent NPRS positioning occasion of | | the NPRS carrier with the longest NPRS periodicity of this cell | | (NOTE 2). The value is given in number of full sub-frames. If this | | field is not present, the receiver shall consider the NPRS subframe | | offset to be 0. | +----------------------------------------------------------------------+ | **_expectedRSTD_** | | | | This field indicates the RSTD value that the target device is | | expected to measure between this cell and the NB-IoT assistance data | | reference cell. The _expectedRSTD_ field takes into account the | | expected propagation time difference as well as transmit time | | difference of NPRS positioning occasions between the two cells. The | | RSTD value can be negative and is calculated as | | (_expectedRSTD_ -8192). The resolution is 3×T~s~, with | | T~s~=1/(15000*2048) seconds. | | | | If this field is absent and if the _OTDOA-NeighbourCellInfoList_ IE | | is included in _OTDOA‑ProvideAssistanceData_ , the expected RSTD is | | the same as provided in _OTDOA-NeighbourCellInfoList_ IE for the | | corresponding cell (as indicated by _prsNeighbourCellIndex_). | +----------------------------------------------------------------------+ | **_expectedRSTD-Uncertainty_** | | | | This field indicates the uncertainty in _expectedRSTD_ value** _._** | | The uncertainty is related to the location server\'s a‑priori | | estimation of the target device location. The _expectedRSTD_ and | | _expectedRSTD-Uncertainty_ together define the search window for the | | target device. | | | | The scale factor of the _expectedRSTD-Uncertainty_ field is 3×T~s~, | | with T~s~=1/(15000*2048) seconds. | | | | If this field is absent and if the _OTDOA-NeighbourCellInfoList_ IE | | is included in _OTDOA‑ProvideAssistanceData_ , the expected RSTD | | uncertainty is the same as provided in _OTDOA-NeighbourCellInfoList_ | | IE for the corresponding cell (as indicated by | | _prsNeighbourCellIndex_). | | | | The target device may assume that the beginning of the NPRS | | positioning occasion of the NPRS carrier with the longest NPRS | | periodicity of the neighbour cell (NOTE 2) is received within the | | search window of size [_−expectedRSTD-Uncertainty_ ×3×T~s~_, | | expectedRSTD-Uncertainty_ ×3×T~s~] centered at | | | | T~REF~ _+_ 1 millisecond×N + _(expectedRSTD−_ 8192) ×3×T~s~, where | | T~REF~ is the reception time of the beginning of the NPRS | | positioning occasion of the NB-IoT assistance data reference cell | | (NOTE 1) at the target device antenna connector, and N = | | _nprs‑SubframeOffset_. | +----------------------------------------------------------------------+ | **_prsNeighbourCellIndex_** | | | | This field contains an index of the entry in IE | | _OTDOA-NeighbourCellInfoList_. Value 1 corresponds to the first cell | | in _OTDOA-NeighbourCellInfoList,_ value 2 to the second, and so on. | | If this field is absent, and if the _OTDOA‑NeighbourCellInfoList_ IE | | is included in _OTDOA‑ProvideAssistanceData,_ it means there is no | | corresponding cell in _OTDOA-NeighbourCellInfoList_ IE for this | | cell. | | | | The target device may assume the antenna ports of the PRS of the | | cell indicated by _prsNeighbourCellIndex_ and the NPRS of this cell | | are quasi co-located, as defined in [16]. | +----------------------------------------------------------------------+ | **_nprsInfo-Type2_** | | | | This field specifies the Type 2 NPRS [16] configuration of the | | NB-IoT neighbour cell. | +----------------------------------------------------------------------+
NOTE 1: If the NB-IoT assistance data reference cell (i.e., anchor carrier)
has no NPRS configured, the first NPRS carrier in _PRS-Info-NB_ is referenced.
NOTE 2: \"Cell\" in this context may not necessarily be the anchor carrier. If
this \"cell\" has more than one NPRS carrier with equal longest periodicity,
the first such NPRS carrier in _PRS-Info-NB_ is referenced. The length of a
NPRS positioning occasion for Part A in this context is the length of the
_nprsBitmap_ bit string.
#### 6.5.1.3 OTDOA Assistance Data Request
#### \-- _OTDOA-RequestAssistanceData_
The IE _OTDOA-RequestAssistanceData_ is used by the target device to request
assistance data from a location server.
\-- ASN1START
OTDOA-RequestAssistanceData ::= SEQUENCE {
physCellId INTEGER (0..503),
...,
[[
adType-r14 BIT STRING { prs (0), nprs (1) } (SIZE (1..8)) OPTIONAL
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _OTDOA-RequestAssistanceData field descriptions_ | +----------------------------------------------------------------------+ | **_physCellId_** | | | | This field specifies the physical cell identity of the current | | primary cell of the target device. | +----------------------------------------------------------------------+ | **_adType_** | | | | This field specifies the assistance data requested. This is | | represented by a bit string, with a one-value at the bit position | | means the particular assistance data is requested; a zero-value | | means not requested. | | | | Bit 0 indicates that PRS assistance data are requested, bit 1 | | indicates that NPRS assistance data are requested. | +----------------------------------------------------------------------+
#### 6.5.1.4 OTDOA Location Information
#### \-- _OTDOA-ProvideLocationInformation_
The IE _OTDOA-ProvideLocationInformation_ is used by the target device to
provide OTDOA location measurements to the location server. It may also be
used to provide OTDOA positioning specific error reason.
\-- ASN1START
OTDOA-ProvideLocationInformation ::= SEQUENCE {
otdoaSignalMeasurementInformation OTDOA-SignalMeasurementInformation OPTIONAL,
otdoa-Error OTDOA-Error OPTIONAL,
...,
[[
otdoaSignalMeasurementInformation-NB-r14 OTDOA-SignalMeasurementInformation-
NB-r14 OPTIONAL
]]
}
\-- ASN1STOP
#### 6.5.1.5 OTDOA Location Information Elements
#### \-- _OTDOA-SignalMeasurementInformation_
The IE _OTDOA-SignalMeasurementInformation_ is used by the target device to
provide RSTD measurements to the location server. The RSTD measurements are
provided for a neighbour cell and the RSTD reference cell, both of which are
provided in the IE _OTDOA-ProvideAssistanceData._ The RSTD reference cell may
or may not be the same as the assistance data reference cell provided in
_OTDOA-ReferenceCellInfo_ or _OTDOA-ReferenceCellInfoNB_. If the target device
stops reporting inter-frequency RSTD measurements, where the inter-frequency
RSTD measurement is an OTDOA RSTD measurement with at least one cell on a
frequency different from the serving cell frequency, the LPP layer shall
inform lower layers that inter-frequency RSTD measurements are stopped.
NOTE 1: If there are more than 24 _NeighbourMeasurementElement_ to be sent,
the target device may send them in multiple _ProvideLocationInformation_
messages, as described under sub-clause 5.3.
NOTE 2: If NPRS/PRS antenna ports are quasi co-located, the target device
provides a single RSTD measurement for the quasi co-located antenna ports of
NPRS/PRS.
\-- ASN1START
OTDOA-SignalMeasurementInformation ::= SEQUENCE {
systemFrameNumber BIT STRING (SIZE (10)),
physCellIdRef INTEGER (0..503),
cellGlobalIdRef ECGI OPTIONAL,
earfcnRef ARFCN-ValueEUTRA OPTIONAL, -- Cond NotSameAsRef0
referenceQuality OTDOA-MeasQuality OPTIONAL,
neighbourMeasurementList NeighbourMeasurementList,
...,
[[ earfcnRef-v9a0 ARFCN-ValueEUTRA-v9a0 OPTIONAL -- Cond NotSameAsRef1
]],
[[ tpIdRef-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer0
prsIdRef-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer1
additionalPathsRef-r14
AdditionalPathList-r14 OPTIONAL,
nprsIdRef-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer2
carrierFreqOffsetNB-Ref-r14
CarrierFreqOffsetNB-r14 OPTIONAL, -- Cond NB-IoT
hyperSFN-r14 BIT STRING (SIZE (10)) OPTIONAL -- Cond H-SFN
]]
}
NeighbourMeasurementList ::= SEQUENCE (SIZE(1..24)) OF
NeighbourMeasurementElement
NeighbourMeasurementElement ::= SEQUENCE {
physCellIdNeighbour INTEGER (0..503),
cellGlobalIdNeighbour ECGI OPTIONAL,
earfcnNeighbour ARFCN-ValueEUTRA OPTIONAL, -- Cond NotSameAsRef2
rstd INTEGER (0..12711),
rstd-Quality OTDOA-MeasQuality,
...,
[[ earfcnNeighbour-v9a0 ARFCN-ValueEUTRA-v9a0 OPTIONAL -- Cond NotSameAsRef3
]],
[[ tpIdNeighbour-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer0
prsIdNeighbour-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer1
delta-rstd-r14 INTEGER (0..5) OPTIONAL,
additionalPathsNeighbour-r14
AdditionalPathList-r14 OPTIONAL,
nprsIdNeighbour-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer2
carrierFreqOffsetNB-Neighbour-r14
CarrierFreqOffsetNB-r14 OPTIONAL -- Cond NB-IoT
]]
}
AdditionalPathList-r14 ::= SEQUENCE (SIZE(1..maxPaths-r14)) OF
AdditionalPath-r14
maxPaths-r14 INTEGER ::= 2
\-- ASN1STOP
* * *
Conditional presence Explanation _NotSameAsRef0_ The field is absent if the
corresponding _earfcnRef-v9a0_ is present. Otherwise, the target device shall
include this field if the EARFCN of the RSTD reference cell is not the same as
the EARFCN of the assistance data reference cell provided in the OTDOA
assistance data. _NotSameAsRef1_ The field is absent if the corresponding
_earfcnRef_ is present. Otherwise, the target device shall include this field
if the EARFCN of the RSTD reference cell is not the same as the EARFCN of the
assistance data reference cell provided in the OTDOA assistance data.
_NotSameAsRef2_ The field is absent if the corresponding
_earfcnNeighbour-v9a0_ is present. Otherwise, the target device shall include
this field if the EARFCN of this neighbour cell is not the same as the
_earfcnRef_ for the RSTD reference cell. _NotSameAsRef3_ The field is absent
if the corresponding _earfcnNeighbour_ is present. Otherwise, the target
device shall include this field if the EARFCN of this neighbour cell is not
the same as the _earfcnRef_ for the RSTD reference cell. _ProvidedByServer0_
The target device shall include this field if a _tpId_ for this transmission
point is included in the _OTDOA-ProvideAssistanceData._ Otherwise the field is
absent. _ProvidedByServer1_ The target device shall include this field if a
_prsID_ for this transmission point is included in the _OTDOA-
ProvideAssistanceData._ Otherwise the field is absent. _ProvidedByServer2_ The
target device shall include this field if an _nprsID_ for this cell is
included in the _OTDOA-ProvideAssistanceData_ and if this **_cell is a NB-IoT
only cell (without associated LTE PRS cell)__._ Otherwise the field is absent.
_NB-IoT_ The target device shall include this field if **_the cell is a NB-IoT
only cell (without associated LTE PRS cell)___. Otherwise the field is
absent._ H-SFN_ The target device shall include this field if it was able to
determine a hyper SFN of the RSTD reference cell.
* * *
+----------------------------------------------------------------------+ | _OTDOA-SignalMeasurementInformation field descriptions_ | +----------------------------------------------------------------------+ | **_systemFrameNumber_** | | | | This field specifies the SFN of the RSTD reference cell containing | | the starting subframe of the PRS or NPRS positioning occasion if PRS | | or NPRS are available on the RSTD reference cell, or subframe of the | | CRS for RSTD measurements if PRS and NPRS are not available on the | | RSTD reference cell during which the most recent neighbour cell RSTD | | measurement was performed. | | | | In case of more than a single PRS configuration on the RSTD | | reference cell, the first PRS configuration is referenced. | +----------------------------------------------------------------------+ | **_physCellIdRef_** | | | | This field specifies the physical cell identity of the RSTD | | reference cell. | +----------------------------------------------------------------------+ | **_cellGlobalIdRef_** | | | | This field specifies the ECGI, the globally unique identity of a | | cell in E-UTRA, of the RSTD reference cell. The target shall provide | | this IE if it knows the ECGI of the RSTD reference cell. | +----------------------------------------------------------------------+ | **_earfcnRef_** | | | | This field specifies the EARFCN of the RSTD reference cell. | +----------------------------------------------------------------------+ | **_referenceQuality_** | | | | This field specifies the target device\'s best estimate of the | | quality of the TOA measurement from the RSTD reference cell, | | T~SubframeRxRef~, where T~SubframeRxRef~ is the time of arrival of | | the signal from the RSTD reference cell. | +----------------------------------------------------------------------+ | **_neighbourMeasurementList_** | | | | **_This list contains the measured RSTD values for neighbour cells | | together with the RSTD reference cell, along with quality for each | | measurement._** | +----------------------------------------------------------------------+ | **_tpIdRef_** | | | | This field specifies the transmission point ID of the RSTD reference | | cell. | +----------------------------------------------------------------------+ | **_prsIdRef_** | | | | This field specifies the PRS-ID of the first PRS configuration of | | the RSTD reference cell. | +----------------------------------------------------------------------+ | **_additionalPathsRef_** | | | | This field specifies one or more additional detected path timing | | values for the RSTD reference cell, relative to the path timing used | | for determining the _rstd_ value. If this field was requested but is | | not included, it means the UE did not detect any additional path | | timing values. | +----------------------------------------------------------------------+ | **_nprsIdRef_** | | | | This field specifies the NPRS-ID of the RSTD reference cell. | +----------------------------------------------------------------------+ | **_carrierFreqOffsetNB-Ref_** | | | | This field specifies the offset of the NB-IoT channel number to | | EARFCN given by _earfcnRef_ as defined in TS 36.101 [21]. | +----------------------------------------------------------------------+ | **_hyperSFN_** | | | | This field specifies the hyper SFN as defined in [12] of the RSTD | | reference cell for the _systemFrameNumber_. | +----------------------------------------------------------------------+ | **_physCellIdNeighbour_** | | | | This field specifies the physical cell identity of the neighbour | | cell for which the RSTDs are provided. | +----------------------------------------------------------------------+ | **_cellGlobalIdNeighbour_** | | | | This field specifies the ECGI, the globally unique identity of a | | cell in E-UTRA, of the neighbour cell for which the RSTDs are | | provided. The target device shall provide this IE if it was able to | | determine the ECGI of the neighbour cell at the time of measurement. | +----------------------------------------------------------------------+ | **_earfcnNeighbour_** | | | | This field specifies the EARFCN of the neighbour cell used for the | | RSTD measurements. | +----------------------------------------------------------------------+ | **_rstd_** | | | | This field specifies the relative timing difference between this | | neighbour cell and the RSTD reference cell, as defined in [17]. | | Mapping of the measured quantity is defined as in [18] subclause | | 9.1.10.3. | +----------------------------------------------------------------------+ | **_rstd-Quality_** | | | | This field specifies the target device\'s best estimate of the | | quality of the measured _rstd_. | +----------------------------------------------------------------------+ | **_tpIdNeighbour_** | | | | This field specifies the transmission point ID for the neighbour | | cell for which the RSTDs are provided. | +----------------------------------------------------------------------+ | **_prsIdNeighbour_** | | | | This field specifies the PRS-ID of the first PRS configuration of | | the neighbour cell for which the RSTDs are provided. | +----------------------------------------------------------------------+ | **_delta-rstd_** | | | | This field specifies the higher-resolution RSTD ∆~RSTD~ as defined | | in [18] subclause 9.1.10.4. Mapping of the measured quantity is | | defined as in [18] subclause 9.1.10.4. | +----------------------------------------------------------------------+ | **_additionalPathsNeighbour_** | | | | This field specifies one or more additional detected path timing | | values for the neighbour cell, relative to the path timing used for | | determining the _rstd_ value. If this field was requested but is not | | included, it means the UE did not detect any additional path timing | | values. | +----------------------------------------------------------------------+ | **_nprsIdNeighbour_** | | | | This field specifies the NPRS-ID of the neighbour cell for which the | | RSTDs are provided. | +----------------------------------------------------------------------+ | **_carrierFreqOffsetNB-Neighbour_** | | | | This field specifies the offset of the NB-IoT channel number to | | EARFCN given by _earfcnNeighbour_ as defined in TS 36.101 [21]. | +----------------------------------------------------------------------+
#### \-- _OTDOA-SignalMeasurementInformation-NB_
The IE _OTDOA-SignalMeasurementInformation-NB_ is used by the target device to
provide RSTD measurements to the location server. The RSTD measurements are
provided for a neighbour cell and the RSTD reference cell, both of which are
provided in the IE _OTDOA-ProvideAssistanceData._ The RSTD reference cell may
or may not be the same as the assistance data reference cell provided in
_OTDOA-ReferenceCellInfo_ or _OTDOA-ReferenceCellInfoNB_. If the target device
stops reporting inter-frequency RSTD measurements, where the inter-frequency
RSTD measurement is an OTDOA RSTD measurement with at least one cell on a
frequency different from the serving cell frequency, the LPP layer shall
inform lower layers that inter-frequency RSTD measurements are stopped.
NOTE 1: If there are more than 24 _NeighbourMeasurementElement-NB_ to be sent,
the target device may send them in multiple _ProvideLocationInformation_
messages, as described under sub-clause 5.3.
NOTE 2: If NPRS/PRS antenna ports are quasi co-located, the target device
provides a single RSTD measurement for the quasi co-located antenna ports of
NPRS/PRS.
\-- ASN1START
OTDOA-SignalMeasurementInformation-NB-r14 ::= SEQUENCE {
systemFrameNumber-r14 BIT STRING (SIZE (10)),
physCellIdRef-r14 INTEGER (0..503),
cellGlobalIdRef-r14 ECGI OPTIONAL,
earfcnRef-r14 ARFCN-ValueEUTRA-r14 OPTIONAL, -- Cond NotSameAsRef0
referenceQuality-r14 OTDOA-MeasQuality OPTIONAL,
neighbourMeasurementList-r14 NeighbourMeasurementList-NB-r14,
tpIdRef-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer0
prsIdRef-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer1
additionalPathsRef-r14 AdditionalPathList-r14 OPTIONAL,
nprsIdRef-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer2
carrierFreqOffsetNB-Ref-r14 CarrierFreqOffsetNB-r14 OPTIONAL, -- Cond NB-IoT
hyperSFN-r14 BIT STRING (SIZE (10)) OPTIONAL, -- Cond H-SFN
...
}
NeighbourMeasurementList-NB-r14 ::= SEQUENCE (SIZE(1..24)) OF
NeighbourMeasurementElement-NB-r14
NeighbourMeasurementElement-NB-r14 ::= SEQUENCE {
physCellIdNeighbour-r14 INTEGER (0..503),
cellGlobalIdNeighbour-r14 ECGI OPTIONAL,
earfcnNeighbour-r14 ARFCN-ValueEUTRA-r14 OPTIONAL, -- Cond NotSameAsRef2
rstd-r14 INTEGER (0..12711),
rstd-Quality-r14 OTDOA-MeasQuality,
tpIdNeighbour-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer0
prsIdNeighbour-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer1
delta-rstd-r14 INTEGER (0..5) OPTIONAL,
additionalPathsNeighbour-r14
AdditionalPathList-r14 OPTIONAL,
nprsIdNeighbour-r14 INTEGER (0..4095) OPTIONAL, -- Cond ProvidedByServer2
carrierFreqOffsetNB-Neighbour-r14
CarrierFreqOffsetNB-r14 OPTIONAL, -- Cond NB-IoT
...
}
\-- ASN1STOP
* * *
Conditional presence Explanation _NotSameAsRef0_ The target device shall
include this field if the EARFCN of the RSTD reference cell is not the same as
the EARFCN of the assistance data reference cell provided in the OTDOA
assistance data. _NotSameAsRef2_ The target device shall include this field if
the EARFCN of this neighbour cell is not the same as the _earfcnRef_ for the
RSTD reference cell. _ProvidedByServer0_ The target device shall include this
field if a _tpId_ for this transmission point is included in the _OTDOA-
ProvideAssistanceData._ Otherwise the field is absent. _ProvidedByServer1_ The
target device shall include this field if a _prsID_ for this transmission
point is included in the _OTDOA-ProvideAssistanceData._ Otherwise the field is
absent. _ProvidedByServer2_ The target device shall include this field if an
_nprsID_ for this cell is included in the _OTDOA-ProvideAssistanceData_ and if
this **_cell is a NB-IoT only cell (without associated LTE PRS cell)__._
Otherwise the field is absent. _NB-IoT_ The target device shall include this
field if **_the cell is a NB-IoT only cell (without associated LTE PRS
cell)___. Otherwise the field is absent._ H-SFN_ The target device shall
include this field if it was able to determine a hyper SFN of the RSTD
reference cell.
* * *
+----------------------------------------------------------------------+ | _OTDOA-SignalMeasurementInformation-NB field descriptions_ | +----------------------------------------------------------------------+ | **_systemFrameNumber_** | | | | This field specifies the SFN of the RSTD reference cell containing | | the starting subframe of the PRS or NPRS positioning occasion if PRS | | or NPRS are available on the RSTD reference cell, or subframe of the | | CRS for RSTD measurements if PRS and NPRS are not available on the | | RSTD reference cell during which the most recent neighbour cell RSTD | | measurement was performed. | | | | In case of more than a single PRS configuration on the RSTD | | reference cell, the first PRS configuration is referenced. | +----------------------------------------------------------------------+ | **_physCellIdRef_** | | | | This field specifies the physical cell identity of the RSTD | | reference cell. | +----------------------------------------------------------------------+ | **_cellGlobalIdRef_** | | | | This field specifies the ECGI, the globally unique identity of a | | cell in E-UTRA, of the RSTD reference cell. The target shall provide | | this IE if it knows the ECGI of the RSTD reference cell. | +----------------------------------------------------------------------+ | **_earfcnRef_** | | | | This field specifies the EARFCN of the RSTD reference cell. | +----------------------------------------------------------------------+ | **_referenceQuality_** | | | | This field specifies the target device\'s best estimate of the | | quality of the TOA measurement from the RSTD reference cell, | | T~SubframeRxRef~, where T~SubframeRxRef~ is the time of arrival of | | the signal from the RSTD reference cell. | +----------------------------------------------------------------------+ | **_neighbourMeasurementList_** | | | | **_This list contains the measured RSTD values for neighbour cells | | together with the RSTD reference cell, along with quality for each | | measurement._** | +----------------------------------------------------------------------+ | **_tpIdRef_** | | | | This field specifies the transmission point ID of the RSTD reference | | cell. | +----------------------------------------------------------------------+ | **_prsIdRef_** | | | | This field specifies the PRS-ID of the first PRS configuration of | | the RSTD reference cell. | +----------------------------------------------------------------------+ | **_additionalPathsRef_** | | | | This field specifies one or more additional detected path timing | | values for the RSTD reference cell, relative to the path timing used | | for determining the _rstd_ value. If this field was requested but is | | not included, it means the UE did not detect any additional path | | timing values. | +----------------------------------------------------------------------+ | **_nprsIdRef_** | | | | This field specifies the NPRS-ID of the RSTD reference cell. | +----------------------------------------------------------------------+ | **_carrierFreqOffsetNB-Ref_** | | | | This field specifies the offset of the NB-IoT channel number to | | EARFCN given by _earfcnRef_ as defined in TS 36.101 [21]. | +----------------------------------------------------------------------+ | **_hyperSFN_** | | | | This field specifies the hyper SFN as defined in [12] of the RSTD | | reference cell for the _systemFrameNumber_. | +----------------------------------------------------------------------+ | **_physCellIdNeighbour_** | | | | This field specifies the physical cell identity of the neighbour | | cell for which the RSTDs are provided. | +----------------------------------------------------------------------+ | **_cellGlobalIdNeighbour_** | | | | This field specifies the ECGI, the globally unique identity of a | | cell in E-UTRA, of the neighbour cell for which the RSTDs are | | provided. The target device shall provide this IE if it was able to | | determine the ECGI of the neighbour cell at the time of measurement. | +----------------------------------------------------------------------+ | **_earfcnNeighbour_** | | | | This field specifies the EARFCN of the neighbour cell used for the | | RSTD measurements. | +----------------------------------------------------------------------+ | **_rstd_** | | | | This field specifies the relative timing difference between this | | neighbour cell and the RSTD reference cell, as defined in [17]. | | Mapping of the measured quantity is defined as in [18] subclause | | 9.1.10.3. | +----------------------------------------------------------------------+ | **_rstd-Quality_** | | | | This field specifies the target device\'s best estimate of the | | quality of the measured _rstd_. | +----------------------------------------------------------------------+ | **_tpIdNeighbour_** | | | | This field specifies the transmission point ID for the neighbour | | cell for which the RSTDs are provided. | +----------------------------------------------------------------------+ | **_prsIdNeighbour_** | | | | This field specifies the PRS-ID of the first PRS configuration of | | the neighbour cell for which the RSTDs are provided. | +----------------------------------------------------------------------+ | **_delta-rstd_** | | | | This field specifies the higher-resolution RSTD ∆~RSTD~ as defined | | in [18] subclause 9.1.10.4. Mapping of the measured quantity is | | defined as in [18] subclause 9.1.10.4. | +----------------------------------------------------------------------+ | **_additionalPathsNeighbour_** | | | | This field specifies one or more additional detected path timing | | values for the neighbour cell, relative to the path timing used for | | determining the _rstd_ value. If this field was requested but is not | | included, it means the UE did not detect any additional path timing | | values. | +----------------------------------------------------------------------+ | **_nprsIdNeighbour_** | | | | This field specifies the NPRS-ID of the neighbour cell for which the | | RSTDs are provided. | +----------------------------------------------------------------------+ | **_carrierFreqOffsetNB-Neighbour_** | | | | This field specifies the offset of the NB-IoT channel number to | | EARFCN given by _earfcnNeighbour_ as defined in TS 36.101 [21]. | +----------------------------------------------------------------------+
#### \-- _OTDOA-MeasQuality_
\-- ASN1START
OTDOA-MeasQuality ::= SEQUENCE {
error-Resolution BIT STRING (SIZE (2)),
error-Value BIT STRING (SIZE (5)),
error-NumSamples BIT STRING (SIZE (3)) OPTIONAL,
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _OTDOA-MeasQuality field descriptions_ | +----------------------------------------------------------------------+ | **_error-Resolution_** | | | | This field specifies the resolution R used in _error-Value_ field. | | The encoding on two bits is as follows: | | | | \'00\' 5 meters | | | | \'01\' 10 meters | | | | \'10\' 20 meters | | | | \'11\' 30 meters. | +----------------------------------------------------------------------+ | **_error-Value_** | | | | This field specifies the target device\'s best estimate of the | | uncertainty of the OTDOA (or TOA) measurement. | | | | The encoding on five bits is as follows: | | | | \'00000\' 0 to (R*1-1) meters | | | | \'00001\' R*1 to (R*2-1) meters | | | | \'00010\' R*2 to (R*3-1) meters | | | | ... | | | | \'11111\' R*31 meters or more; | | | | where R is the resolution defined by _error-Resolution_ field. | | | | E.g., R=20 m corresponds to 0-19 m, 20-39 m,...,620+ m. | +----------------------------------------------------------------------+ | **_error-NumSamples_** | | | | If the _error-Value_ field provides the sample uncertainty of the | | OTDOA (or TOA) measurement, this field specifies how many | | measurements have been used by the target device to determine this | | (i.e., sample size). Following 3 bit encoding is used: | | | | \'000\' Not the baseline metric | | | | \'001\' 5-9 | | | | \'010\' 10-14 | | | | \'011\' 15-24 | | | | \'100\' 25-34 | | | | \'101\' 35-44 | | | | \'110\' 45-54 | | | | \'111\' 55 or more. | | | | In case of the value \'000\', the _error-Value_ field contains the | | target device\'s best estimate of the uncertainty of the OTDOA (or | | TOA) measurement not based on the baseline metric. E.g., other | | measurements such as signal-to-noise-ratio or signal strength can be | | utilized to estimate the _error-Value._ | | | | If this field is absent, the value of this field is \'000\'. | +----------------------------------------------------------------------+
#### \-- _AdditionalPath_
The IE _AdditionalPath_ is used by the target device to provide information
about additional paths in association to the RSTD measurements in the form of
a relative time difference and a quality value. The additional path
_relativeTimeDifference_ is the detected path timing relative to the detected
path timing used for the _rstd_ value [17], and each additional path can be
associated with a quality value _path-Quality._
\-- ASN1START
AdditionalPath-r14 ::= SEQUENCE {
relativeTimeDifference-r14 INTEGER (-256..255),
path-Quality-r14 OTDOA-MeasQuality OPTIONAL,
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _AdditionalPath field descriptions_ | +----------------------------------------------------------------------+ | **_relativeTimeDifference_** | | | | This field specifies the additional detected path timing relative to | | the detected path timing used for the rstd value in units of 0.5 Ts, | | with Ts=1/(15000*2048) seconds. A positive value indicates that the | | particular path is later in time than the detected path used for | | RSTD; a negative value indicates that the particular path is earlier | | in time than the detected path used for RSTD. | +----------------------------------------------------------------------+ | **_path-Quality_** | | | | This field specifies the target device\'s best estimate of the | | quality of the detected timing of the additional path. | +----------------------------------------------------------------------+
#### 6.5.1.6 OTDOA Location Information Request
#### \-- _OTDOA-RequestLocationInformation_
The IE _OTDOA-RequestLocationInformation_ is used by the location server to
request OTDOA location measurements from a target device. Details of the
required measurements (e.g. details of assistance data reference cell and
neighbour cells) are conveyed in the _OTDOA-ProvideAssistanceData_ IE in a
separate Provide Assistance Data message.
\-- ASN1START
OTDOA-RequestLocationInformation ::= SEQUENCE {
assistanceAvailability BOOLEAN,
...,
[[
multipathRSTD-r14 ENUMERATED { requested } OPTIONAL, -- Need ON
maxNoOfRSTDmeas-r14 INTEGER (1..32) OPTIONAL -- Need ON
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _OTDOA-RequestLocationInformation field descriptions_ | +----------------------------------------------------------------------+ | **_assistanceAvailability_** | | | | This field indicates whether the target device may request | | additional OTDOA assistance data from the server. TRUE means allowed | | and FALSE means not allowed. | +----------------------------------------------------------------------+ | **_multipathRSTD_** | | | | This field, if present, indicates that the target device is | | requested to report additional detected path timing information per | | RSTD reference and neighbour cell. | +----------------------------------------------------------------------+ | **_maxNoOfRSTDmeas_** | | | | This field, if present, indicates the maximum number of | | _NeighbourMeasurementElement_ fields (i.e., RSTD measurements) the | | target device can provide in _OTDOA-SignalMeasurementInformation_. | +----------------------------------------------------------------------+
#### 6.5.1.7 OTDOA Capability Information
#### \-- _OTDOA-ProvideCapabilities_
The IE _OTDOA-ProvideCapabilities_ is used by the target device to indicate
its capability to support OTDOA and to provide its OTDOA positioning
capabilities to the location server.
\-- ASN1START
OTDOA-ProvideCapabilities ::= SEQUENCE {
otdoa-Mode BIT STRING { ue-assisted (0),
ue-assisted-NB-r14 (1) } (SIZE (1..8)),
...,
supportedBandListEUTRA SEQUENCE (SIZE (1..maxBands)) OF SupportedBandEUTRA
OPTIONAL,
supportedBandListEUTRA-v9a0 SEQUENCE (SIZE (1..maxBands)) OF
SupportedBandEUTRA-v9a0
OPTIONAL,
interFreqRSTDmeasurement-r10 ENUMERATED { supported } OPTIONAL,
additionalNeighbourCellInfoList-r10 ENUMERATED { supported } OPTIONAL,
prs-id-r14 ENUMERATED { supported } OPTIONAL,
tp-separation-via-muting-r14 ENUMERATED { supported } OPTIONAL,
additional-prs-config-r14 ENUMERATED { supported } OPTIONAL,
prs-based-tbs-r14 ENUMERATED { supported } OPTIONAL,
additionalPathsReport-r14 ENUMERATED { supported } OPTIONAL,
densePrsConfig-r14 ENUMERATED { supported } OPTIONAL,
maxSupportedPrsBandwidth-r14 ENUMERATED { n6, n15, n25, n50, n75, n100, ...}
OPTIONAL,
prsOccGroup-r14 ENUMERATED { supported } OPTIONAL,
prsFrequencyHopping-r14 ENUMERATED { supported } OPTIONAL,
maxSupportedPrsConfigs-r14 ENUMERATED { c2, c3 } OPTIONAL,
periodicalReporting-r14 ENUMERATED { supported } OPTIONAL,
multiPrbNprs-r14 ENUMERATED { supported } OPTIONAL,
idleStateForMeasurements-r14 ENUMERATED { required } OPTIONAL,
numberOfRXantennas-r14 ENUMERATED { rx1, ... } OPTIONAL
}
maxBands INTEGER ::= 64
SupportedBandEUTRA ::= SEQUENCE {
bandEUTRA INTEGER (1..maxFBI)
}
SupportedBandEUTRA-v9a0 ::= SEQUENCE {
bandEUTRA-v9a0 INTEGER (maxFBI-Plus1..maxFBI2) OPTIONAL
}
maxFBI INTEGER ::= 64 -- Maximum value of frequency band indicator
maxFBI-Plus1 INTEGER ::= 65 -- lowest value extended FBI range
maxFBI2 INTEGER ::= 256 -- highest value extended FBI range
\-- ASN1STOP
+----------------------------------------------------------------------+ | _OTDOA-ProvideCapabilities_ field descriptions | +----------------------------------------------------------------------+ | **_otdoa-Mode_** | | | | **This field specifies the OTDOA mode(s) supported by the target | | device. This is represented by a bit string, with a one value at the | | bit position means the particular OTDOA mode is supported; a zero | | value means not supported. A zero-value in all bit positions in the | | bit string means OTDOA positioning method is not supported by the | | target device.** | | | | **ue-assisted: Bit 0 indicates that the target device supports | | UE-assisted OTDOA and LTE PRS.** | | | | **ue-assisted-NB: Bit 1 indicates that the target device supports | | UE-assisted OTDOA and NB-IoT NPRS.** | +----------------------------------------------------------------------+ | **_SupportedBandEUTRA_** | | | | This field specifies the frequency bands for which the target device | | supports RSTD measurements. One entry corresponding to each | | supported E‑UTRA band **_as defined in TS 36.101 [21]. In case the | | target device includes bandEUTRA-v9a0, the target device shall set | | the corresponding entry of bandEUTRA (i.e. without suffix) to | | maxFBI._** | +----------------------------------------------------------------------+ | **_interFreqRSTDmeasurement_** | | | | **This field, if present, indicates that the target device supports | | inter-frequency RSTD measurements within and between the frequency | | bands indicated in _SupportedBandEUTRA _._ * | +----------------------------------------------------------------------+ | _**additionalNeighbourCellInfoList** _| | | | This field, if present, indicates that the target device supports up | | to 3×24_ OTDOA-NeighbourCellInfoElement _in | |_ OTDOA‑NeighbourCellInfoList _in_ OTDOA-ProvideAssistanceData _| | without any restriction for the_ earfcn _in each | |_ OTDOA-NeighbourCellInfoElement* as specified in subclause 6.5.1.2. | +----------------------------------------------------------------------+ | **_prs-id_**| | | | This field, if present, indicates that the target device supports | | PRS generation based on the PRS-ID as specified in [16] and | | support for TP-ID in _OTDOA-ReferenceCellInfo _and | |_ OTDOA-NeighbourCellInfoList*. | +----------------------------------------------------------------------+ | _**tp-separation-via-muting** _| | | | This field, if present, indicates that the target device supports | | RSTD measurements for cells which have associated transmission | | points (e.g., Remote Radio Heads) within the cell coverage and where | | these associated transmission points have the same physical cell | | identity as the associated cell, and where these transmission points | | are identified via a different muting pattern. The field also | | indicates support for TP-ID in_ OTDOA-ReferenceCellInfo _and | |_ OTDOA‑NeighbourCellInfoList*. | +----------------------------------------------------------------------+ | **_additional-prs-config_**| | | | This field, if present, indicates that the target device supports | | additional PRS configurations. The additional PRS configuration in | |_PRS-Info _IE comprise: | | | | - support for_ prs-ConfigurationIndex* > 2399;\ | | - support for _**N~PRS~ values in addition to 1, 2, 4 and 6 | | (**add-numDL-Frames in PRS-Info);_| | | | - support for muting bit string lengths > 16 bits. | +----------------------------------------------------------------------+ | _**prs-based-tbs** _| | | | This field, if present, indicates that the target device supports | | RSTD measurements for PRS-only TPs. | +----------------------------------------------------------------------+ |_** additionalPathsReport** _| | | | This field, if present, indicates that the target device supports | | reporting of timing information for additional detected paths for | | RSTD reference and each neighbour cell. | +----------------------------------------------------------------------+ |_** densePrsConfig** _| | | | This field, if present, indicates that the target device supports a | | subset of the additional PRS configurations associated with | | capability_ additional-prs-config _which comprises: | | | | - support for_ prs-ConfigurationIndex _ > 2404; | | | | - support for N~PRS~ values of 10, 20, 40, 80 and 160 (in addition | | to 1, 2, 4 and 6). | | | | In case _additional-prs-config* is present, this field is not | | present. | +----------------------------------------------------------------------+ | **_maxSupportedPrsBandwidth_**| | | | This field, if present, indicates the maximum PRS bandwidth | | supported by the target device. Enumerated value n6 corresponds to 6 | | resource blocks, n15 to 15 resource blocks and so on. If this field | | is not present, the target device is assumed to support the PRS | | bandwidth associated with the target device type, which for LTE | | devices including Cat-M1/M2 is 100 resource blocks and for NB-IoT | | devices is 1 resource block. | +----------------------------------------------------------------------+ |**_prsOccGroup_**| | | | This field, if present, indicates that the target device supports | | PRS occasion groups, which implies that each bit of a configured | | muting pattern applies per PRS occasion group. | +----------------------------------------------------------------------+ |**_prsFrequencyHopping_**| | | | This field, if present, indicates that the target device supports | | PRS occasion frequency hopping, as specified in [16]. | +----------------------------------------------------------------------+ |**_maxSupportedPrsConfigs_**| | | | This field, if present, indicates that the target device supports | | multiple PRS configurations per cell. Enumerated value c2 indicates | | support for up to 2 configurations; c3 indicates support for up to 3 | | configurations. | +----------------------------------------------------------------------+ |**_periodicalReporting_**| | | | This field, if present, indicates that the target device supports | |_periodicalReporting _of RSTD measurements_._If this field is | | absent, the location server may assume that the target device does | | not support_ periodicalReporting _in | |_ CommonIEsRequestLocationInformation*. | +----------------------------------------------------------------------+ | _**multiPrbNprs** _| | | | This field, if present, indicates that the target device supports | | NPRS configuration in more than one resource block (i.e., | |_ maxCarrier _in_ PRS-Info-NB* greater 1). | +----------------------------------------------------------------------+ | **_idleStateForMeasurements_**| | | | This field, if present, indicates that the target device requires | | idle state to perform RSTD measurements. | +----------------------------------------------------------------------+ |**_numberOfRXantennas_ ** | | | | This field is not applicable to NB-IoT devices. | | | | This field, if present, indicates the number of UE downlink receive | | antennas for RSTD measurements (see 3GPP TS 36.133 [18]). | | Enumerated value rx1 indicates a single antenna receiver. If this | | field is absent, the target device is assumed to support two RX | | antennas for RSTD measurements. | +----------------------------------------------------------------------+
#### 6.5.1.8 OTDOA Capability Information Request
#### \-- _OTDOA-RequestCapabilities_
The IE _OTDOA-RequestCapabilities_ is used by the location server to request
the capability of the target device to support OTDOA and to request OTDOA
positioning capabilities from a target device.
\-- ASN1START
OTDOA-RequestCapabilities ::= SEQUENCE {
...
}
\-- ASN1STOP
#### 6.5.1.9 OTDOA Error Elements
#### \-- _OTDOA-Error_
The IE _OTDOA-Error_ is used by the location server or target device to
provide OTDOA error reasons to the target device or location server,
respectively.
\-- ASN1START
OTDOA-Error ::= CHOICE {
locationServerErrorCauses OTDOA-LocationServerErrorCauses,
targetDeviceErrorCauses OTDOA-TargetDeviceErrorCauses,
...
}
\-- ASN1STOP
#### \-- _OTDOA-LocationServerErrorCauses_
The IE _OTDOA-LocationServerErrorCauses_ is used by the location server to
provide OTDOA error reasons to the target device.
\-- ASN1START
OTDOA-LocationServerErrorCauses ::= SEQUENCE {
cause ENUMERATED { undefined,
assistanceDataNotSupportedByServer,
assistanceDataSupportedButCurrentlyNotAvailableByServer,
...
},
...
}
\-- ASN1STOP
#### \-- _OTDOA-TargetDeviceErrorCauses_
The IE _OTDOA-TargetDeviceErrorCauses_ is used by the target device to provide
OTDOA error reasons to the location server.
\-- ASN1START
OTDOA-TargetDeviceErrorCauses ::= SEQUENCE {
cause ENUMERATED { undefined,
assistance-data-missing,
unableToMeasureReferenceCell,
unableToMeasureAnyNeighbourCell,
attemptedButUnableToMeasureSomeNeighbourCells,
...
},
...
}
\-- ASN1STOP
### 6.5.2 A-GNSS Positioning
#### 6.5.2.1 GNSS Assistance Data
#### \-- _A-GNSS-ProvideAssistanceData_
The IE _A-GNSS-ProvideAssistanceData_ is used by the location server to
provide assistance data to enable UE‑based and UE‑assisted A‑GNSS. It may also
be used to provide GNSS positioning specific error reasons.
\-- ASN1START
A-GNSS-ProvideAssistanceData ::= SEQUENCE {
gnss-CommonAssistData GNSS-CommonAssistData OPTIONAL, -- Need ON
gnss-GenericAssistData GNSS-GenericAssistData OPTIONAL, -- Need ON
gnss-Error A-GNSS-Error OPTIONAL, -- Need ON
...
}
\-- ASN1STOP
#### \-- _GNSS-CommonAssistData_
The IE _GNSS-CommonAssistData_ is used by the location server to provide
assistance data which can be used for any GNSS (e.g., GPS, Galileo, GLONASS,
BDS, etc.).
\-- ASN1START
GNSS-CommonAssistData ::= SEQUENCE {
gnss-ReferenceTime GNSS-ReferenceTime OPTIONAL, -- Need ON
gnss-ReferenceLocation GNSS-ReferenceLocation OPTIONAL, -- Need ON
gnss-IonosphericModel GNSS-IonosphericModel OPTIONAL, -- Need ON
gnss-EarthOrientationParameters GNSS-EarthOrientationParameters OPTIONAL, --
Need ON
...
}
\-- ASN1STOP
#### \-- _GNSS-GenericAssistData_
The IE _GNSS-GenericAssistData_ is used by the location server to provide
assistance data for a specific GNSS (e.g., GPS, Galileo, GLONASS, BDS, etc.).
The specific GNSS for which the provided assistance data are applicable is
indicated by the IE _GNSS‑ID_ and (if applicable) by the IE _SBAS‑ID_.
Assistance for up to 16 GNSSs can be provided.
\-- ASN1START
GNSS-GenericAssistData ::= SEQUENCE (SIZE (1..16)) OF GNSS-
GenericAssistDataElement
GNSS-GenericAssistDataElement ::= SEQUENCE {
gnss-ID GNSS-ID,
sbas-ID SBAS-ID OPTIONAL, -- Cond GNSS-ID-SBAS
gnss-TimeModels GNSS-TimeModelList OPTIONAL, -- Need ON
gnss-DifferentialCorrections GNSS-DifferentialCorrections OPTIONAL, -- Need ON
gnss-NavigationModel GNSS-NavigationModel OPTIONAL, -- Need ON
gnss-RealTimeIntegrity GNSS-RealTimeIntegrity OPTIONAL, -- Need ON
gnss-DataBitAssistance GNSS-DataBitAssistance OPTIONAL, -- Need ON
gnss-AcquisitionAssistance GNSS-AcquisitionAssistance OPTIONAL, -- Need ON
gnss-Almanac GNSS-Almanac OPTIONAL, -- Need ON
gnss-UTC-Model GNSS-UTC-Model OPTIONAL, -- Need ON
gnss-AuxiliaryInformation GNSS-AuxiliaryInformation OPTIONAL, -- Need ON
...,
[[
bds-DifferentialCorrections-r12
BDS-DifferentialCorrections-r12 OPTIONAL, -- Cond GNSS-ID-BDS
bds-GridModel-r12 BDS-GridModelParameter-r12 OPTIONAL -- Cond GNSS-ID-BDS
]]
}
\-- ASN1STOP
* * *
Conditional presence Explanation _GNSS‑ID‑SBAS_ The field is mandatory present
**if the _GNSS‑ID _=_ sbas_**; otherwise it is not present. _GNSS‑ID‑BDS_ The
field may be present if the _GNSS‑ID_ = _bds_ ; otherwise it is not present.
* * *
#### 6.5.2.2 GNSS Assistance Data Elements
#### \-- _GNSS-ReferenceTime_
The IE _GNSS-ReferenceTime_ is used by the location server to provide the GNSS
specific system time with uncertainty and the relationship between GNSS system
time and network air-interface timing of the eNodeB/NodeB/BTS transmission in
the reference cell.
If the IE _networkTime_ is present, the IEs _gnss-SystemTime_ and
_networkTime_ provide a valid relationship between GNSS system time and air-
interface network time, as seen at the approximate location of the target
device, i.e. the propagation delay from the the eNodeB/NodeB/BTS to the target
device shall be compensated for by the location server. Depending on
implementation, the relation between GNSS system time and air-interface
network time may have varying accuracy. The uncertainty of this timing
relation is provided in the IE _referenceTimeUnc_. If the propagation delay
from the eNodeB/NodeB/BTS to the target device is not accurately known, the
location server shall use the best available approximation of the propagation
delay and take the corresponding delay uncertainty into account in the
calculation of the IE _referenceTimeUnc_.
If the IE _networkTime_ is not present, the IE _gnssSystemTime_ is an estimate
of current GNSS system time at time of reception of the IE _GNSS-
ReferenceTime_ by the target device. The location server should achieve an
accuracy of +/- 3 seconds for this estimate including allowing for the
transmission delay between the location server and the target device. Note
that the target device should further compensate _gnss-SystemTime_ for the
time between the reception of _GNSS-ReferenceTime_ and the time when the
_gnss-SystemTime_ is used.
The location server shall provide a value for the _gnss-TimeID_ only for GNSSs
supported by the target device.
The IE _GNSS-ReferenceTimeForOneCell_ can be provided multiple times (up to
16) to provide fine time assistance for several (neighbour) cells.
\-- ASN1START
GNSS-ReferenceTime ::= SEQUENCE {
gnss-SystemTime GNSS-SystemTime,
referenceTimeUnc INTEGER (0..127) OPTIONAL, -- Cond noFTA
gnss-ReferenceTimeForCells SEQUENCE (SIZE (1..16)) OF
GNSS-ReferenceTimeForOneCell OPTIONAL, -- Need ON
...
}
GNSS-ReferenceTimeForOneCell ::= SEQUENCE {
networkTime NetworkTime,
referenceTimeUnc INTEGER (0..127),
bsAlign ENUMERATED {true} OPTIONAL,
...
}
\-- ASN1STOP
* * *
Conditional presence Explanation _noFTA_ The field may be present if _gnss-
ReferenceTimeForCells_ is absent; otherwise it is not present.
* * *
+----------------------------------------------------------------------+ | _GNSS-ReferenceTime field descriptions_ | +----------------------------------------------------------------------+ | **_gnss-SystemTime_** | | | | This field provides the specific GNSS system time. | +----------------------------------------------------------------------+ | **_networkTime_** | | | | This field specifies the cellular network time at the epoch | | corresponding to _gnss-SystemTime._ | +----------------------------------------------------------------------+ | **_referenceTimeUnc_** | | | | This field provides the accuracy of the relation between | | _gnssSystemTime_ and _networkTime_ time if IE _networkTime_ is | | provided. When IE _networkTime_ is not provided, this field can be | | included to provide the accuracy of the provided _gnssSystemTime_. | | | | If GNSS TOD is the given GNSS time, then the true GNSS time, | | corresponding to the provided network time as observed at the target | | device location, lies in the interval [GNSS TOD - | | _referenceTimeUnc_ , GNSS TOD + _referenceTimeUnc_]. | | | | The uncertainty _r_ , expressed in microseconds, is mapped to a | | number _K_ , with the following formula: | | | | _r_ = C*(((1+x)^K^)-1) | | | | with C = 0.5 and x = 0.14. To encode any higher value of uncertainty | | than that corresponding in the above formula to K=127, the same | | value, K=127, shall also be used. The uncertainty is then coded on 7 | | bits, as the binary encoding of K. Example values for the | | _referenceTimeUnc_ Format: see table K to uncertainty relation | | below. | +----------------------------------------------------------------------+ | **_bsAlign_** | | | | This flag, if present, indicates that the transmission timings of | | all cells sharing, depending on the RAT, the same carrier frequency | | and Tracking Area/Location Area/Routing Area as the cell indicated, | | are frame aligned. This information allows the target device to | | derive the GNSS - cellular time relation for any of these cells | | based on the timing relation information provided in | | _GNSS-ReferenceTime_. The flag should be set consistently in all | | these cells. This flag does not guarantee SFN alignment. | +----------------------------------------------------------------------+
K to uncertainty relation
* * *
Value of K Value of uncertainty 0 0 nanoseconds 1 70 nanoseconds 2 149.8
nanoseconds \- - 50 349.62 microseconds \- - 127 ≥ 8.43 seconds
* * *
#### \-- _GNSS-SystemTime_
\-- ASN1START
GNSS-SystemTime ::= SEQUENCE {
gnss-TimeID GNSS-ID,
gnss-DayNumber INTEGER (0..32767),
gnss-TimeOfDay INTEGER (0..86399),
gnss-TimeOfDayFrac-msec INTEGER (0..999) OPTIONAL, -- Need ON
notificationOfLeapSecond BIT STRING (SIZE(2)) OPTIONAL, -- Cond gnss-TimeID-
glonass
gps-TOW-Assist GPS-TOW-Assist OPTIONAL, -- Cond gnss-TimeID-gps
...
}
\-- ASN1STOP
* * *
Conditional presence Explanation _gnss-TimeID-glonass_ The field may be
present if _gnss-TimeID_ =`glonass\'; otherwise it is not present. _gnss-
TimeID-gps_ The field may be present if _gnss-TimeID_ =`gps\'; otherwise it is
not present.
* * *
+----------------------------------------------------------------------+ | _GNSS-SystemTime field descriptions_ | +----------------------------------------------------------------------+ | **_gnss-TimeID_** | | | | This field specifies the GNSS for which the _GNSS-SystemTime_ is | | provided. | +----------------------------------------------------------------------+ | **_gnss-DayNumber_** | | | | This field specifies the sequential number of days (with day count | | starting at 0) from the origin of the GNSS System Time as follows: | | | | GPS, QZSS, SBAS -- Days from January 6^th^ 1980 00:00:00 UTC (USNO); | | | | Galileo -- Days from Galileo System Time (GST) start epoch, defined | | as 13 seconds before midnight between 21^st^ August and 22^nd^ | | August 1999; i.e., GST was equal to 13 seconds at August 22^nd^ 1999 | | 00:00:00 UTC; | | | | GLONASS -- Days from December 31^st^ 1995 21:00:00 UTC (SU), which | | is local UTC Moscow | | | | January 1^st^ 1996 00:00:00, defined as UTC(SU) + 3 hours in [9]; | | | | BDS -- Days from January 1^st^ 2006 00:00:00 UTC (NTSC). | +----------------------------------------------------------------------+ | **_gnss-TimeOfDay_** | | | | This field specifies the integer number of seconds from the GNSS day | | change. | +----------------------------------------------------------------------+ | **_gnss-TimeOfDayFrac-msec_** | | | | This field specifies the fractional part of the _gnssTimeOfDay_ | | field in 1‑milli‑seconds resolution. The total GNSS TOD is | | _gnss-TimeOfDay + gnssTimeOfDayFrac-msec._ | +----------------------------------------------------------------------+ | **_notificationOfLeapSecond_** | | | | This field specifies the notification of forthcoming leap second | | correction, as defined by parameter KP in [9, Table 4.7]. | +----------------------------------------------------------------------+ | **_gps-TOW-Assist_** | | | | This field contains several fields in the Telemetry (TLM) Word and | | Handover Word (HOW) that are currently being broadcast by the | | respective GPS satellites. Combining this information with GPS TOW | | enables the target device to know the entire 1.2-second (60-bit) | | pattern of TLM and HOW that is transmitted at the start of each | | six-second NAV subframe by the particular GPS satellite. | +----------------------------------------------------------------------+
#### \-- _GPS-TOW-Assist_
\-- ASN1START
GPS-TOW-Assist ::= SEQUENCE (SIZE(1..64)) OF GPS-TOW-AssistElement
GPS-TOW-AssistElement ::= SEQUENCE {
satelliteID INTEGER (1..64),
tlmWord INTEGER (0..16383),
antiSpoof INTEGER (0..1),
alert INTEGER (0..1),
tlmRsvdBits INTEGER (0..3),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _GPS-TOW-Assist field descriptions_ | +----------------------------------------------------------------------+ | **_satelliteID_** | | | | This field identifies the satellite for which the _GPS-TOW-Assist_ | | is applicable. This field is identical to the GPS PRN Signal No. | | defined in [4]. | +----------------------------------------------------------------------+ | **_tlmWord_** | | | | This field contains a 14-bit value representing the Telemetry | | Message (TLM) being broadcast by the GPS satellite identified by the | | particular _satelliteID_ , with the MSB occurring first in the | | satellite transmission, as defined in [4]. | +----------------------------------------------------------------------+ | **_antiSpoof_** | | | | This field contains the Anti-Spoof flag that is being broadcast by | | the GPS satellite identified by _satelliteID_ , as defined in [4]. | +----------------------------------------------------------------------+ | **_alert_** | | | | This field contains the Alert flag that is being broadcast by the | | GPS satellite identified by _satelliteID_ , as defined in [4]. | +----------------------------------------------------------------------+ | **_tlmRsvdBits_** | | | | This field contains the two reserved bits in the TLM Word being | | broadcast by the GPS satellite identified by _satelliteID_ , with the | | MSB occurring first in the satellite transmission, as defined in | | [4]. | +----------------------------------------------------------------------+
#### \-- _NetworkTime_
\-- ASN1START
NetworkTime ::= SEQUENCE {
secondsFromFrameStructureStart INTEGER(0..12533),
fractionalSecondsFromFrameStructureStart INTEGER(0..3999999),
frameDrift INTEGER (-64..63) OPTIONAL, -- Cond GNSSsynch
cellID CHOICE {
eUTRA SEQUENCE {
physCellId INTEGER (0..503),
cellGlobalIdEUTRA CellGlobalIdEUTRA-AndUTRA OPTIONAL, -- Need ON
earfcn ARFCN-ValueEUTRA,
...,
[[ earfcn-v9a0 ARFCN-ValueEUTRA-v9a0 OPTIONAL -- Cond EARFCN-max
]]
},
uTRA SEQUENCE {
mode CHOICE {
fdd SEQUENCE {
primary-CPICH-Info INTEGER (0..511),
...
},
tdd SEQUENCE {
cellParameters INTEGER (0..127),
...
}
},
cellGlobalIdUTRA CellGlobalIdEUTRA-AndUTRA OPTIONAL, -- Need ON
uarfcn ARFCN-ValueUTRA,
...
},
gSM SEQUENCE {
bcchCarrier INTEGER (0..1023),
bsic INTEGER (0..63),
cellGlobalIdGERAN CellGlobalIdGERAN OPTIONAL, -- Need ON
...
},
...,
nBIoT-r14 SEQUENCE {
nbPhysCellId-r14 INTEGER (0..503),
nbCellGlobalId-r14 ECGI OPTIONAL, -- Need ON
nbCarrierFreq-r14 CarrierFreq-NB-r14,
...
}
},
...
}
\-- ASN1STOP
* * *
Conditional presence Explanation _EARFCN-max_ The field is mandatory present
if the corresponding _earfcn_ (i.e. without suffix) is set to _maxEARFCN_.
Otherwise the field is not present. _GNSSsynch_ The field is present and set
to 0 if _NetworkTime_ is synchronized to _gnss-SystemTime_ ; otherwise the
field is optionally present, need OR.
* * *
+----------------------------------------------------------------------+ | _NetworkTime field descriptions_ | +----------------------------------------------------------------------+ | **_secondsFromFrameStructureStart_** | | | | This field specifies the number of seconds from the beginning of the | | longest frame structure in the corresponding air interface. | | | | In case of E-UTRA, the SFN cycle length is 10.24 seconds. | | | | In case of UTRA, the SFN cycle length is 40.96 seconds. | | | | In case of GSM, the hyperfame length is 12533.76 seconds. | | | | In case of NB-IoT, the Hyper-SFN cycle lengths is 10485.76 seconds. | +----------------------------------------------------------------------+ | **_fractionalSecondsFromFrameStructureStart_** | | | | This field specifies the fractional part of the | | _secondsFromFrameStructureStart_ in 250 ns resolution. | | | | The total time since the particular frame structure start is | | _secondsFromFrameStructureStart + | | fractionalSecondsFromFrameStructureStart_ | +----------------------------------------------------------------------+ | **_frameDrift_** | | | | _This field specifies the drift rate of the GNSS‑network time | | relation with scale factor 2^-30^ seconds/second, in the range from | | ‑5.9605e-8 to +5.8673e-8 sec/sec._ | +----------------------------------------------------------------------+ | **_cellID_** | | | | This field specifies the cell for which the GNSS--network time | | relation is provided. | +----------------------------------------------------------------------+ | **_physCellId_** | | | | This field specifies the physical cell identity of the reference | | cell (E-UTRA), as defined in [12], for which the GNSS network time | | relation is provided. | +----------------------------------------------------------------------+ | **_cellGlobalIdEUTRA_** | | | | This field specifies the Evolved Cell Global Identifier (ECGI), the | | globally unique identity of a cell in E-UTRA, of the reference cell | | for the GNSS‑network time relation, as defined in [12]. | +----------------------------------------------------------------------+ | **_earfcn_** | | | | **This field specifies E-ARFCN of the reference cell for the | | GNSS‑network time relation (E-UTRA). In case the server includes | |_earfcn-v9a0 _, the server shall set the corresponding_ earfcn _(i.e. | | without suffix) to_ maxEARFCN _._ * | +----------------------------------------------------------------------+ | _**primary-CPICH-Info** _| | | | This field specifies the physical cell identity of the reference | | cell (UTRA) for the GNSS‑network time relation, as defined in | | [13]. | +----------------------------------------------------------------------+ |_** cellParameters** _| | | | This field specifies the physical cell identity of the reference | | cell (UTRA) for the GNSS‑network time relation, as defined in | | [13]. | +----------------------------------------------------------------------+ |_** cellGlobalIdUTRA** _| | | | The filed specifies the global UTRAN Cell Identifier, the globally | | unique identity of a cell in UTRA, of the reference cell for the | | GNSS‑network time relation, as defined in [13]. | +----------------------------------------------------------------------+ |_** uarfcn** _| | | | This field specifies ARFCN of the reference cell for the | | GNSS‑network time relation (UTRA). | +----------------------------------------------------------------------+ |_** bcchCarrier** _| | | | This field specifies the absolute GSM RF channel number of the BCCH | | of the reference base station (GERAN) for the GNSS‑network time | | relation, as defined in [14]. | +----------------------------------------------------------------------+ |_** bsic** _| | | | This field specifies the Base Station Identity Code of the reference | | base station (GERAN) for the GNSS‑network time relation, as defined | | in [14]. | +----------------------------------------------------------------------+ |_** cellGlobalIdGERAN** _| | | | This field specifies the Cell Global Identification (CGI), the | | globally unique identity of a cell in GERAN, of the reference base | | station for the GNSS‑network time relation. | +----------------------------------------------------------------------+ |_** nbPhysCellId** _| | | | This field specifies the narrowband physical layer cell identity of | | the NB-IoT reference cell, as defined in [12], for which the GNSS | | network time relation is provided. | +----------------------------------------------------------------------+ |_** nbCellGlobalId** _| | | | This field specifies the global cell identifier of the NB-IoT | | reference cell for which the GNSS‑network time relation is provided, | | as defined in [12]. | +----------------------------------------------------------------------+ |_** nbCarrierFreq*** | | | | This field specifies the carrier frequency of the NB-IoT reference | | cell for which the GNSS‑network time relation is provided. | +----------------------------------------------------------------------+
#### \-- _GNSS-ReferenceLocation_
The IE _GNSS-ReferenceLocation_ is used by the location server to provide the
target device with a‑priori knowledge of its location in order to improve GNSS
receiver performance. The IE _GNSS-ReferenceLocation_ is provided in WGS‑84
reference system.
\-- ASN1START
GNSS-ReferenceLocation ::= SEQUENCE {
threeDlocation EllipsoidPointWithAltitudeAndUncertaintyEllipsoid,
...
}
\-- ASN1STOP
#### \-- _GNSS-IonosphericModel_
The IE _GNSS-IonosphericModel_ is used by the location server to provide
parameters to model the propagation delay of the GNSS signals through the
ionosphere. Proper use of these fields allows a single‑frequency GNSS receiver
to remove parts of the ionospheric delay from the pseudorange measurements.
Two Ionospheric Models are supported: The Klobuchar model as defined in [4],
and the NeQuick model as defined in [8].
\-- ASN1START
GNSS-IonosphericModel ::= SEQUENCE {
klobucharModel KlobucharModelParameter OPTIONAL, -- Need ON
neQuickModel NeQuickModelParameter OPTIONAL, -- Need ON
...
}
\-- ASN1STOP
#### \-- _KlobucharModelParameter_
\-- ASN1START
KlobucharModelParameter ::= SEQUENCE {
dataID BIT STRING (SIZE (2)),
alfa0 INTEGER (-128..127),
alfa1 INTEGER (-128..127),
alfa2 INTEGER (-128..127),
alfa3 INTEGER (-128..127),
beta0 INTEGER (-128..127),
beta1 INTEGER (-128..127),
beta2 INTEGER (-128..127),
beta3 INTEGER (-128..127),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _KlobucharModelParamater field descriptions_ | +----------------------------------------------------------------------+ | **_dataID_** | | | | **When _dataID _has the value \'11\' it indicates that the | | parameters have been generated by QZSS, and the parameters have been | | specialized and are applicable within the area defined in [7]. | | When_ dataID _has the value \'01\' it indicates that the parameters | | have been generated by BDS, and UE shall use these parameters | | according to the description given in 5.2.4.7 in [23]. When | |_ dataID _has the value \'00\' it indicates the parameters are | | applicable worldwide [4,7]. All other values for_ dataID _are | | reserved._ * | +----------------------------------------------------------------------+ | _**alpha0** _| | | | This field specifies the α~0~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^-30^ seconds. | +----------------------------------------------------------------------+ |_** alpha1** _| | | | This field specifies the α~1~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^-27^ seconds/semi-circle. | +----------------------------------------------------------------------+ |_** alpha2** _| | | | This field specifies the α~2~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^-24^ seconds/semi-circle^2^. | +----------------------------------------------------------------------+ |_** alpha3** _| | | | This field specifies the α~3~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^-24^ seconds/semi-circle^3^. | +----------------------------------------------------------------------+ |_** beta0** _| | | | This field specifies the β~0~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^11^ seconds. | +----------------------------------------------------------------------+ |_** beta1** _| | | | This field specifies the β~1~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^14^ seconds/semi-circle. | +----------------------------------------------------------------------+ |_** beta2** _| | | | This field specifies the β~2~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^16^ seconds/semi-circle^2^. | +----------------------------------------------------------------------+ |_** beta3*** | | | | This field specifies the β~3~ parameter of the Klobuchar model, as | | specified in [4], [23]. | | | | Scale factor 2^16^ seconds/semi-circle^3^. | +----------------------------------------------------------------------+
#### \-- _NeQuickModelParameter_
\-- ASN1START
NeQuickModelParameter ::= SEQUENCE {
ai0 INTEGER (0..2047),
ai1 INTEGER (-1024..1023),
ai2 INTEGER (-8192..8191),
ionoStormFlag1 INTEGER (0..1) OPTIONAL, -- Need OP
ionoStormFlag2 INTEGER (0..1) OPTIONAL, -- Need OP
ionoStormFlag3 INTEGER (0..1) OPTIONAL, -- Need OP
ionoStormFlag4 INTEGER (0..1) OPTIONAL, -- Need OP
ionoStormFlag5 INTEGER (0..1) OPTIONAL, -- Need OP
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _NeQuickModelParameter field descriptions_ | +----------------------------------------------------------------------+ | **_ai0_** | | | | Effective Ionisation Level 1^st^ order parameter. | | | | Scale factor 2^-2^ Solar Flux Units (SFUs), [8] section 5.1.6. | +----------------------------------------------------------------------+ | **_ai1_** | | | | Effective Ionisation Level 2^nd^ order parameter. | | | | Scale factor 2^-8^ Solar Flux Units/degree, [8] section 5.1.6. | +----------------------------------------------------------------------+ | **_ai2_** | | | | Effective Ionisation Level 3^rd^ order parameter. | | | | Scale factor 2^-15^ Solar Flux Units/degree^2^, [8] section 5.1.6. | +----------------------------------------------------------------------+ | **_ionoStormFlag1, ionoStormFlag2, ionoStormFlag3, ionoStormFlag4, | | ionoStormFlag5_** | | | | These fields specify the ionosphere disturbance flags (1,...,5) for | | five different regions as described in [8], section 5.1.6. If the | | ionosphere disturbance flag for a region is not present the target | | device shall treat the ionosphere disturbance condition as unknown. | +----------------------------------------------------------------------+
#### \-- _GNSS-EarthOrientationParameters_
The IE _GNSS-EarthOrientationParameters_ is used by the location server to
provide parameters to construct the ECEF and ECI coordinate transformation as
defined in [4]. The IE _GNSS-EarthOrientationParameters_ indicates the
relationship between the Earth\'s rotational axis and WGS-84 reference system.
\-- ASN1START
GNSS-EarthOrientationParameters ::= SEQUENCE {
teop INTEGER (0..65535),
pmX INTEGER (-1048576..1048575),
pmXdot INTEGER (-16384..16383),
pmY INTEGER (-1048576..1048575),
pmYdot INTEGER (-16384..16383),
deltaUT1 INTEGER (-1073741824..1073741823),
deltaUT1dot INTEGER (-262144..262143),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _GNSS-EarthOrientationParameters field descriptions_ | +----------------------------------------------------------------------+ | **_teop_** | | | | This field specifies the EOP data reference time in seconds, as | | specified in [4]. | | | | Scale factor 2^4^ seconds. | +----------------------------------------------------------------------+ | **_pmX_** | | | | **_This field specifies the_** X-axis polar motion value at | | reference time in arc-seconds, as specified in [4]. | | | | Scale factor 2^-20^ arc-seconds. | +----------------------------------------------------------------------+ | **_pmXdot_** | | | | This field specifies the X-axis polar motion drift at reference time | | in arc-seconds/day, as specified in [4]. | | | | Scale factor 2^-21^ arc-seconds/day. | +----------------------------------------------------------------------+ | **_pmY_** | | | | This field specifies the Y-axis polar motion value at reference time | | in arc-seconds, as specified in [4]. | | | | Scale factor 2^-20^ arc-seconds. | +----------------------------------------------------------------------+ | **_pmYdot_** | | | | This field specifies the Y-axis polar motion drift at reference time | | in arc-seconds/day, as specified in [4]. | | | | Scale factor 2^-21^ arc-seconds/day. | +----------------------------------------------------------------------+ | **_deltaUT1_** | | | | This field specifies the UT1-UTC difference at reference time in | | seconds, as specified in [4]. | | | | Scale factor 2^-24^ seconds. | +----------------------------------------------------------------------+ | **_deltaUT1dot_** | | | | This field specifies the Rate of UT1-UTC difference at reference | | time in seconds/day, as specified in [4]. | | | | Scale factor 2^-25^ seconds/day. | +----------------------------------------------------------------------+
#### \-- _GNSS-TimeModelList_
The IE _GNSS-TimeModelList_ is used by the location server to provide the
GNSS‑GNSS system time offset between the GNSS system time indicated by IE
_GNSS‑ID_ in IE _GNSS-GenericAssistDataElement_ to the GNSS system time
indicated by IE _gnss-TO-ID_. Several _GNSS-TimeModelElement_ IEs can be
included with different _gnss-TO-ID_ fields. The location server should
provide a _GNSS-TimeModelList_ for the same _GNSS-ID_ as the _gnss-TimeID_ in
IE _GNSS-SystemTime_ in _GNSS-ReferenceTime_ assistance. If the location
server does not provide a _GNSS-TimeModelList_ for the same _GNSS-ID_ as the
_gnss-TimeID_ in IE _GNSS-SystemTime_ in _GNSS-ReferenceTime_ assistance the
target device assumes _tA1_ and _tA2_ are equal to zero.
\-- ASN1START
GNSS-TimeModelList ::= SEQUENCE (SIZE (1..15)) OF GNSS-TimeModelElement
GNSS-TimeModelElement ::= SEQUENCE {
gnss-TimeModelRefTime INTEGER (0..65535),
tA0 INTEGER (-67108864..67108863),
tA1 INTEGER (-4096..4095) OPTIONAL, -- Need ON
tA2 INTEGER (-64..63) OPTIONAL, -- Need ON
gnss-TO-ID INTEGER (1..15),
weekNumber INTEGER (0..8191) OPTIONAL, -- Need ON
deltaT INTEGER (-128..127) OPTIONAL, -- Need ON
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _GNSS-TimeModelElement field descriptions_ | +----------------------------------------------------------------------+ | **_gnss-TimeModelRefTime_** | | | | This field specifies the reference time of week for | | _GNSS-TimeModelElement_ and it is given in GNSS specific system | | time. | | | | Scale factor 2^4^ seconds. | +----------------------------------------------------------------------+ | **_tA0_** | | | | This field specifies the bias coefficient of the | | _GNSS-TimeModelElement_. | | | | Scale factor 2^-35^ seconds. | +----------------------------------------------------------------------+ | **_tA1_** | | | | This field specifies the drift coefficient of the | | _GNSS-TimeModelElement._ | | | | Scale factor of 2^-51^ seconds/second. | +----------------------------------------------------------------------+ | **_tA2_** | | | | This field specifies the drift rate correction coefficient of the | | _GNSS-TimeModelElement._ | | | | Scale factor of 2^-68^ seconds/second^2^. | +----------------------------------------------------------------------+ | **_gnss-TO-ID_** | | | | This field specifies the GNSS system time of the GNSS for which the | | _GNSS-TimeModelElement_ is applicable. _GNSS-TimeModelElement_ | | contains parameters to convert GNSS system time from the system | | indicated by _GNSS‑ID_ to GNSS system time indicated by | | _gnss-TO-ID_. The conversion is defined in [4,5,6]. See table of | | gnss-TO-ID to Indication relation below. NOTE. | +----------------------------------------------------------------------+ | **_weekNumber_** | | | | This field specifies the reference week of the GNSS-TimeModelElement | | given in GNSS specific system time. The location server should | | include this field, if _tA1_ or _tA2_ is included. | | | | Scale factor 1 week. | +----------------------------------------------------------------------+ | **_deltaT_** | | | | This field specifies the integer number of seconds of the GNSS-GNSS | | time offset provided in the _GNSS-TimeModelElement._ | | | | Scale factor 1 second. | +----------------------------------------------------------------------+
gnss-TO-ID to Indication relation
* * *
Value of _gnss-TO-ID_ Indication 1 GPS 2 Galileo 3 QZSS 4 GLONASS 5 BDS 6-15
reserved
* * *
> NOTE: The time relationship between the system time indicated by _GNSS-ID_
> and system time indicated by _gnss‑TO-ID_ is given by the following
> equation:\ \ t~GNSS~ = t~E~ - ( A~0GGTO~ + A~1GGTO~ (t~E~ - t~GGTO~ + 604800
> (WN - WN~GGTO~)) + A~2GGTO~ (t~E~ - t~GGTO~ +\ 604800 (WN - WN~GGTO~))^2^ )\
> \ where\ \ t~GNSS~ is the system time of week for the GNSS indicated by
> _gnss-TO-ID_.\ t~E~ is the system time of week for the GNSS indicated by
> _GNSS-ID_.\ WN is the week number of the GNSS system time indicated by
> _GNSS-ID_ corresponding to the t~E~.\ t~GGTO~ is the system time of week for
> the time model data in the GNSS time indicated by _GNSS-ID\ * and given by
> the_ gnss‑TimeModelRefTime _field.\ WN~GGTO~ is the week number for the time
> model data in the GNSS time indicated by_ GNSS-ID\ * corresponding to the
> t~GGTO~ and given by the _weekNumber_ field.\ A~0GGTO~ is given by the _tA0_
> field.\ A~1GGTO~ is given by the _tA1_ field.\ A~2GGTO~ is given by the
> _tA2_ field.\ \ If the _tA1_ and _tA2_ are not included in the _GNSS-
> TimeModelElement_ , the target device assumes A~1GGTO~ and A~2GGTO~ are
> equal to zero.
The GNSS system times in the IE _GNSS-TimeModelList_ and used in the equation
above are all given in Time of Week (TOW) and Week Number (WN) in the indicted
GNSS specific system time. For conversion between TOW/WN and Day Number/Time
of Day (_gnss-DayNumber_ /_gnss-TimeOfDay_) a GNSS week consists of 7 days
since the origin of the particular GNSS System time (with the week number
count starting at 0), and a day consists of 86400 seconds.
#### \-- _GNSS-DifferentialCorrections_
The IE _GNSS-DifferentialCorrections_ is used by the location server to
provide differential GNSS corrections to the target device for a specific
GNSS. Differential corrections can be provided for up to 3 signals per GNSS.
\-- ASN1START
GNSS-DifferentialCorrections ::= SEQUENCE {
dgnss-RefTime INTEGER (0..3599),
dgnss-SgnTypeList DGNSS-SgnTypeList,
...
}
DGNSS-SgnTypeList ::= SEQUENCE (SIZE (1..3)) OF DGNSS-SgnTypeElement
DGNSS-SgnTypeElement ::= SEQUENCE {
gnss-SignalID GNSS-SignalID,
gnss-StatusHealth INTEGER (0..7),
dgnss-SatList DGNSS-SatList,
...
}
DGNSS-SatList ::= SEQUENCE (SIZE (1..64)) OF DGNSS-CorrectionsElement
DGNSS-CorrectionsElement ::= SEQUENCE {
svID SV-ID,
iod BIT STRING (SIZE(11)),
udre INTEGER (0..3),
pseudoRangeCor INTEGER (-2047..2047),
rangeRateCor INTEGER (-127..127),
udreGrowthRate INTEGER (0..7) OPTIONAL, -- Need ON
udreValidityTime INTEGER (0..7) OPTIONAL, -- Need ON
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | _GNSS-DifferentialCorrections field descriptions_ | +----------------------------------------------------------------------+ | **_dgnss-RefTime_** | | | | This field specifies the time for which the DGNSS corrections are | | valid, modulo 1 hour. _dgnss-RefTime_ is given in GNSS specific | | system time. | | | | Scale factor 1‑second. | +----------------------------------------------------------------------+ | **_dgnss-SgnTypeList_** | | | | This list includes differential correction data for different GNSS | | signal types, identified by _GNSS-SignalID_. | +----------------------------------------------------------------------+ | **_gnss-StatusHealth_** | | | | This field specifies the status of the differential corrections. The | | values of this field and their respective meanings are defined as in | | table _gnss-StatusHealth Value_ to Indication relation below. | | | | The first six values in this field indicate valid differential | | corrections. When using the values described below, the \"UDRE Scale | | Factor\" value is applied to the UDRE values contained in the | | element. The purpose is to indicate an estimate in the amount of | | error in the corrections. | | | | The value \"110\" indicates that the source of the differential | | corrections (e.g., reference station or external DGNSS network) is | | currently not being monitored. The value \"111\" indicates that the | | corrections provided by the source are invalid, as judged by the | | source. | +----------------------------------------------------------------------+ | **_dgnss-SatList_** | | | | **_This list includes differential correction data for different | | GNSS satellites, identified by_ * SV-ID**.**_| +----------------------------------------------------------------------+ |_** iod** _| | | | This field specifies the Issue of Data field which contains the | | identity for the_ GNSS-NavigationModel.* | +----------------------------------------------------------------------+ | **_udre_**| | | | This field provides an estimate of the uncertainty (1-σ) in the | | corrections for the particular satellite. The value in this field | | shall be multiplied by the UDRE Scale Factor in the | |_gnss-StatusHealth _field to determine the final UDRE estimate for | | the particular satellite. The meanings of the values for this field | | are shown in the table_ udre Value* to Indication relation below. | +----------------------------------------------------------------------+ | _**pseudoRangeCor** _| | | | This field specifies the correction to the pseudorange for the | | particular satellite at_ dgnss-RefTime _, t~0~. The value of this | | field is given in meters and the scale factor is 0.32 meters in the | | range of ±655.04 meters. The method of calculating this field is | | described in [11]. | | | | If the location server has received a request for GNSS assistance | | data from a target device which included a request for the GNSS | | Navigation Model and DGNSS, the location server shall determine, for | | each satellite, if the navigation model stored by the target device | | is still suitable for use with DGNSS corrections and if so and if | | DGNSS corrections are supported the location server should send | | DGNSS corrections without including the GNSS Navigation Model. | | | | The_ iod _value sent for a satellite shall always be the IOD value | | that corresponds to the navigation model for which the pseudo-range | | corrections are applicable. | | | | The target device shall only use the_ pseudoRangeCor _value when the | | IOD value received matches its available navigation model. | | | | Pseudo-range corrections are provided with respect to GNSS specific | | geodetic datum (e.g., PZ-90.02 if_ GNSS‑ID* indicates GLONASS). | | | | Scale factor 0.32 meters. | +----------------------------------------------------------------------+ | **_rangeRateCor_**| | | | This field specifies the rate-of-change of the pseudorange | | correction for the particular satellite, using the satellite | | ephemeris and clock corrections identified by the _iod _field. The | | value of this field is given in meters per second and the resolution | | is 0.032 meters/sec in the range of ±4.064 meters/sec. For some time | | t~1~ > t~0~, the corrections for _iod _are estimated by | | | | PRC(t~1~, IOD) = PRC(t~0~, IOD) + RRC(t~0~,IOD)⋅(t~1~ - t~0~) , | | | | and the target device uses this to correct the pseudorange it | | measures at t~1~, PR~m~(t~1~,IOD), by | | | | PR(t~1~, IOD) = PR~m~(t~1~, IOD) + PRC(t~1~, IOD) . | | | | The location server shall always send the RRC value that corresponds | | to the PRC value that it sends. The target device shall only use the | | RRC value when the_ iod* value received matches its available | | navigation model. | | | | Scale factor 0.032 meters/second. | +----------------------------------------------------------------------+ | _**udreGrowthRate** _| | | | This field provides an estimate of the growth rate of uncertainty | | (1-σ) in the corrections for the particular satellite identified by | |_ SV-ID _. The estimated UDRE at time value specified in the | |_ udreValidityTime t~1~_is calculated as follows: | | | | UDRE(_ t~0~_+_ t~1~_) = UDRE(_ t~0~_) ×_ udreGrowthRate ,_| | | | where_ t~0~_is the DGNSS Reference Time_ dgnss-RefTime _for which | | the corrections are valid,_ t~1~_is the_ udreValidityTime _| | | | field, UDRE(_ t~0~_) is the value of the_ udre _field, and | |_ udreGrowthRate _field is the factor as shown in the table Value of | |_ udreGrowthRate* to Indication relation below. | +----------------------------------------------------------------------+ | **_udreValidityTime_ __| | | | This field specifies the time when the_ udreGrowthRate_ field | | applies and is included if _udreGrowthRate_ is included. The meaning | | of the values for this field is as shown in the table Value of | | _udreValidityTime_ to Indication relation below. | +----------------------------------------------------------------------+
_gnss-StatusHealth_ Value to Indication relation
* * *
**_gnss-StatusHealth Value_** Indication 000 UDRE Scale Factor = 1.0 001 UDRE
Scale Factor = 0.75 010 UDRE Scale Factor = 0.5 011 UDRE Scale Factor = 0.3
100 UDRE Scale Factor = 0.2 101 UDRE Scale Factor = 0.1 110 Reference Station
Transmission Not Monitored 111 Data is invalid - disregard
* * *
_udre Value_ to Indication relation
* * *
_udre_ Value Indication 00 UDRE ≤ 1.0 m 01 1.0 m \ 43m
* * *
Bit to Polarity Indication relation
* * *
Value Polarity Indication 0 Data Direct, carrier phase not continuous 1 Data
Inverted, carrier phase not continuous 2 Data Direct, carrier phase continuous
3 Data Inverted, carrier phase continuous
* * *
floating-point representation
* * *
Index Mantissa Exponent Floating-Point value, x~i~ Pseudorange value, P 0 000
000 0.5 P \ rssi: AP signal strength at the target | | > | | > rtt: Round Trip Time between target and AP | +----------------------------------------------------------------------+ | **_wlan-AP-AD-Supported_** \ | | This field specifies the WLAN AP assistance data supported by the | | target device. This is represented by a bit string, with a\ | | one-value at the bit position means the particular assistance data | | is supported; a zero-value means not supported. A zero-value in all | | bit positions or absence of this field means no assistance data is | | supported. The following bits are assigned for the indicated | | assistance data. | | | | ap-identifier: WLAN AP identity information | | | | ap-location: WLAN AP location information | +----------------------------------------------------------------------+ | **_periodicalReportingSupported_** | | | | **_This field, if present, specifies the positioning modes for which | | the target device supports periodicalReporting. This is represented | | by a bit string, with a one value at the bit position means | | periodicalReporting for the positioning mode is supported; a zero | | value means not supported. If this field is absent, the location | | server may assume that the target device does not support | | periodicalReporting in CommonIEsRequestLocationInformation._** | +----------------------------------------------------------------------+ | **_idleStateForMeasurements_** | | | | This field, if present, indicates that the target device requires | | idle state to perform WLAN measurements. | +----------------------------------------------------------------------+
#### 6.5.6.5 WLAN Capability Information Request
#### _\--_ _WLAN-RequestCapabilities_
The IE _WLAN-RequestCapabilities_ is used by the location server to request
WLAN positioning capabilities information from a target device.
\-- ASN1START
WLAN-RequestCapabilities-r13 ::= SEQUENCE {
...
}
\-- ASN1STOP
#### 6.5.6.6 WLAN Error Elements
#### _\--_ _WLAN-Error_
The IE _WLAN-Error_ is used by the location server or target device to provide
error reasons for WLAN positioning to the target device or location server,
respectively.
\-- ASN1START
WLAN-Error-r13 ::= CHOICE {
locationServerErrorCauses-r13 WLAN-LocationServerErrorCauses-r13,
targetDeviceErrorCauses-r13 WLAN-TargetDeviceErrorCauses-r13,
...
}
\-- ASN1STOP
#### _\--_ _WLAN-LocationServerErrorCauses_
The IE _WLAN-LocationServerErrorCauses_ is used by the location server to
provide error reasons for WLAN positioning to the target device.
\-- ASN1START
WLAN-LocationServerErrorCauses-r13 ::= SEQUENCE {
cause-r13 ENUMERATED {undefined,
...,
requestedADNotAvailable-v1420,
notAllrequestedADAvailable-v1420
},
...,
[[ apLocationDataUnavailable-r14 NULL OPTIONAL -- Need ON
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_WLAN-LocationServerErrorCauses_ field descriptions** | +----------------------------------------------------------------------+ | **_cause_** | | | | **_This field provides a WLAN AP specific error cause for the server | | applicable to provision of assistance data. If the cause value is | | \'requestedADNotAvailable\', none of the requested assistance data | | could be provided and no further information needs to be included. | | If the cause value is \'notAllRequestedADAvailable\', the server was | | able to provide some but not all requested WLAN AP assistance data. | | In this case, the server should include any of the specific error | | indications as applicable. Note that inclusion of these fields is | | applicable when some of the associated information can be provided | | for some WLAN APs but not for all WLAN APs._** | +----------------------------------------------------------------------+
#### _\--_ _WLAN-TargetDeviceErrorCauses_
The IE _WLAN-TargetDeviceErrorCauses_ is used by the target device to provide
error reasons for WLAN positioning to the location server.
\-- ASN1START
WLAN-TargetDeviceErrorCauses-r13 ::= SEQUENCE {
cause-r13 ENUMERATED {undefined,
requestedMeasurementsNotAvailable,
notAllrequestedMeasurementsPossible,
...
},
wlan-AP-RSSI-MeasurementNotPossible-r13 NULL OPTIONAL,
wlan-AP-RTT-MeasurementNotPossible-r13 NULL OPTIONAL,
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_WLAN-TargetDeviceErrorCauses_** field descriptions | +----------------------------------------------------------------------+ | **_cause_** | | | | This field provides a WLAN specific error cause. If the cause value | | is \'notAllRequestedMeasurementsPossible\', the target device was | | not able to provide all requested WLAN measurements (but may be able | | to provide some measurements). In this case, the target device | | should include any of the _wlan‑AP‑RSSI‑MeasurementNotPossible_ , or | | _wlan‑AP‑RTT‑MeasurementNotPossible_ fields, as applicable. | +----------------------------------------------------------------------+
6.5.6.7 WLAN Assistance Data
_\--_ _WLAN-ProvideAssistanceData_
The IE _WLAN-ProvideAssistanceData_ is used by the location server to provide
assistance data to enable UE‑based and UE-assisted WLAN positioning. It may
also be used to provide WLAN positioning specific error reason.
\-- ASN1START
WLAN-ProvideAssistanceData-r14 ::= SEQUENCE {
wlan-DataSet-r14 SEQUENCE (SIZE (1..maxWLAN-DataSets-r14)) OF WLAN-DataSet-r14
OPTIONAL, -- Need ON
wlan-Error-r14 WLAN-Error-r13 OPTIONAL, -- Need ON
...
}
maxWLAN-DataSets-r14 INTEGER ::= 8
\-- ASN1STOP
* * *
**_WLAN-ProvideAssistanceData field descriptions_**
**_wlan-DataSet_** \ This field provides data for sets of WLAN APs.
**_wlan-Error_** \ This field provides error information and may be included
when a Provide Assistance Data is sent in response to a Request Assistance
Data. It is allowed to include both a _wlan-DataSet_ field and a _wlan-Error_
field (e.g. when only some requested WLAN assistance data is provided).
* * *
6.5.6.8 WLAN Assistance Data Elements
\-- _WLAN-DataSet_
The IE _WLAN-DataSet_ is used by the location server to provide WLAN AP
information for one set of WLAN APs.
\-- ASN1START
WLAN-DataSet-r14 ::= SEQUENCE {
wlan-AP-List-r14 SEQUENCE (SIZE (1..maxWLAN-AP-r14)) OF WLAN-AP-Data-r14,
supportedChannels-11a-r14 SupportedChannels-11a-r14 OPTIONAL, -- Need ON
supportedChannels-11bg-r14 SupportedChannels-11bg-r14 OPTIONAL, -- Need ON
...
}
SupportedChannels-11a-r14 ::= SEQUENCE {
ch34-r14 BOOLEAN,
ch36-r14 BOOLEAN,
ch38-r14 BOOLEAN,
ch40-r14 BOOLEAN,
ch42-r14 BOOLEAN,
ch44-r14 BOOLEAN,
ch46-r14 BOOLEAN,
ch48-r14 BOOLEAN,
ch52-r14 BOOLEAN,
ch56-r14 BOOLEAN,
ch60-r14 BOOLEAN,
ch64-r14 BOOLEAN,
ch149-r14 BOOLEAN,
ch153-r14 BOOLEAN,
ch157-r14 BOOLEAN,
ch161-r14 BOOLEAN
}
SupportedChannels-11bg-r14 ::= SEQUENCE {
ch1-r14 BOOLEAN,
ch2-r14 BOOLEAN,
ch3-r14 BOOLEAN,
ch4-r14 BOOLEAN,
ch5-r14 BOOLEAN,
ch6-r14 BOOLEAN,
ch7-r14 BOOLEAN,
ch8-r14 BOOLEAN,
ch9-r14 BOOLEAN,
ch10-r14 BOOLEAN,
ch11-r14 BOOLEAN,
ch12-r14 BOOLEAN,
ch13-r14 BOOLEAN,
ch14-r14 BOOLEAN
}
maxWLAN-AP-r14 INTEGER ::= 128
\-- ASN1STOP
* * *
**_WLAN-DataSet field descriptions_**
**_wlan-AP-List_** \ This field provides information for WLAN APs in the data
set.
**_supportedChannels-11a_** \ This field defines the superset of all channels
supported by all WLAN APs in the data set of type 801.11a (5GHz band).
**_supportedChannels-11bg_** \ This field defines the superset of all channels
supported by all WLAN APs in the data set of type 801.11b or\ 802.11g (2.4 GHz
band).
* * *
\-- _WLAN-AP-Data_
The IE _WLAN-AP-Data_ is used by the location server to provide information
for one WLAN AP as part of WLAN AP assistance data.
\-- ASN1START
WLAN-AP-Data-r14 ::= SEQUENCE {
wlan-AP-Identifier-r14 WLAN-AP-Identifier-r13,
wlan-AP-Location-r14 WLAN-AP-Location-r14 OPTIONAL, -- Need ON
...
}
WLAN-AP-Location-r14 ::= SEQUENCE {
locationDataLCI-r14 LocationDataLCI-r14,
...
}
LocationDataLCI-r14 ::= SEQUENCE {
latitudeUncertainty-r14 BIT STRING (SIZE (6)),
latitude-r14 BIT STRING (SIZE (34)),
longitudeUncertainty-r14 BIT STRING (SIZE (6)),
longitude-r14 BIT STRING (SIZE (34)),
altitudeUncertainty-r14 BIT STRING (SIZE (6)) OPTIONAL, -- Need ON
altitude-r14 BIT STRING (SIZE (30)) OPTIONAL, -- Need ON
datum-r14 BIT STRING (SIZE (8)),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_WLAN-AP-Data field descriptions_** | +----------------------------------------------------------------------+ | **_wlan-AP-Location_** | | | | > \- **_locationDataLCI_** | | > | | > This field provides the location of the WLAN AP in the form of | | > Location Configuration Information (LCI) defined in [27] and | | > includes the following subfields: | | > | | > _latitudeUncertainty_ : 6-bits quantifying the amount of | | > uncertainty in latitude. A value of 0 is reserved to indicate that | | > the uncertainty is unknown; values greater than 34 are reserved. | | > Its relation with the corresponding value in degrees is expressed | | > with the following formula:\ | | > _latitudeUncertainty_ = 8 - ceil(log2(uncertainty in degrees)) | | > | | > _latitude_ : A 34-bits fixed point value consisting of 9-bits of | | > integer and 25-bits of fraction indicating the Latitude (+/- 90 | | > degrees) of the AP. | | > | | > _longitudeUncertainty:_ 6-bits quantifying the amount of | | > uncertainty in longitude. A value of 0 is reserved to indicate | | > that the uncertainty is unknown; values greater than 34 are | | > reserved. Its relation with the corresponding value in degrees is | | > expressed with the following formula:_\ | | > longitudeUncertainty = 8 - ceil(log2(uncertainty in degrees))_ | | > | | > _longitude:_ A 34-bits fixed point value consisting of 9-bits of | | > integer and 25-bits of fraction indicating the Longitude (+/- 180 | | > degrees) of the AP. | | > | | > _altitudeUncertainty:_ 6-bits value quantifying the amount of | | > uncertainty in the altitude value. A value of 0 is reserved to | | > indicate that the uncertainty is unknown; values greater than 30 | | > are reserved. Its relation with the corresponding value in meters | | > is expressed with the following formula:_\ | | > altitudeUncertainty = 21 - ceil(log2( uncertainty in meters))_ | | > | | > _altitude:_ A 30-bit fixed point value consisting of 22-bits of | | > integer and 8-bits of fraction indicating the altitude of the AP | | > in meters. | | > | | > _datum: 3-bits indicating the map datum used for the coordinates. | | > Defined codes are:\ | | > 1: World Geodetic System 1984 (WGS-84)\ | | > 2: North American Datum 1983 (NAD-83) with North American Vertical | | > Datum 1988 (NAVD-88)\ | | > 3: North American Datum 1983 (NAD-83) with Mean Lower Low Water | | > (MLLW) vertical datu_m. | +----------------------------------------------------------------------+
6.5.6.9 WLAN Assistance Data Request
_\--_ _WLAN-RequestAssistanceData_
The IE _WLAN-RequestAssistanceData_ is used by the target device to request
WLAN assistance data from a location server.
\-- ASN1START
WLAN-RequestAssistanceData-r14 ::= SEQUENCE {
requestedAD-r14 BIT STRING { ap-identifier (0),
ap-location (1)} (SIZE (1..8)),
visibleAPs-r14 SEQUENCE (SIZE (1..maxVisibleAPs-r14)) OF WLAN-AP-
Identifier-r13 OPTIONAL,
wlan-AP-StoredData-r14 SEQUENCE (SIZE (1..maxKnownAPs-r14)) OF WLAN-AP-
Identifier-r13 OPTIONAL,
...
}
maxVisibleAPs-r14 INTEGER ::= 32
maxKnownAPs-r14 INTEGER ::= 2048
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_WLAN-RequestAssistanceData field descriptions_** | +----------------------------------------------------------------------+ | **_requestedAD_** \ | | This field specifies the WLAN AP assistance data requested. This is | | represented by a bit string, with a one-value at the bit position | | means the particular assistance data is requested; a zero-value | | means not requested. The following assistance data types are | | included: | | | | > ap-identifier: WLAN AP identity information\ | | > ap-location: WLAN AP location information | +----------------------------------------------------------------------+ | **_visibleAPs_** \ | | This field enables a target to indicate to a server the identities | | of currently visible WLAN APs. This may assist a server to provide | | assistance data for WLAN APs nearby to the target. A target shall | | provide visible APs in order of received signal strength with the AP | | with the highest signal strength provided first. | +----------------------------------------------------------------------+ | **_wlan-AP-StoredData_** \ | | This field enables a target to indicate to a server the identities | | of WLAN APs for which the target has stored assistance data received | | previously from the server. This may enable the server to avoid | | resending data for the same APs. | +----------------------------------------------------------------------+
### 6.5.7 Bluetooth-based Positioning
#### 6.5.7.1 Bluetooth Location Information
#### _\--_ _BT-ProvideLocationInformation_
The IE _BT-ProvideLocationInformation_ is used by the target device to provide
measurements for one or more Bluetooth beacons to the location server. It may
also be used to provide Bluetooth positioning specific error reason.
\-- ASN1START
BT-ProvideLocationInformation-r13 ::= SEQUENCE {
bt-MeasurementInformation-r13 BT-MeasurementInformation-r13 OPTIONAL,
bt-Error-r13 BT-Error-r13 OPTIONAL,
...
}
\-- ASN1STOP
#### 6.5.7.2 Bluetooth Location Information Elements
#### _\--_ _BT-MeasurementInformation_
\-- ASN1START
BT-MeasurementInformation-r13 ::= SEQUENCE {
measurementReferenceTime-r13 UTCTime OPTIONAL,
bt-MeasurementList-r13 BT-MeasurementList-r13 OPTIONAL,
...
}
BT-MeasurementList-r13 ::= SEQUENCE (SIZE(1..maxBT-Beacon-r13)) OF BT-
MeasurementElement-r13
BT-MeasurementElement-r13 ::= SEQUENCE {
btAddr-r13 BIT STRING (SIZE (48)),
rssi-r13 INTEGER (-128..127) OPTIONAL,
...
}
maxBT-Beacon-r13 INTEGER ::= 32
\-- ASN1STOP
+----------------------------------------------------------------------+ | _BT-MeasurementInformation field descriptions_ | +----------------------------------------------------------------------+ | **_measurementReferenceTime_** | | | | This field provides the UTC time when the Bluetooth measurements are | | performed and should take the form of _YYMMDDhhmmssZ_. | +----------------------------------------------------------------------+ | **_bt-MeasurementList_** | | | | **_This field provides the Bluetooth measurements for up to 32 | | Bluetooth beacons._** | +----------------------------------------------------------------------+ | **_btAddr_** | | | | This field specifies the Bluetooth public address of the Bluetooth | | beacon [25]. | +----------------------------------------------------------------------+ | **_rssi_** | | | | This field provides the beacon received signal strength indicator | | (RSSI) in dBm. | +----------------------------------------------------------------------+
#### 6.5.7.3 Bluetooth Location Information Request
#### _\--_ _BT-RequestLocationInformation_
The IE _BT-RequestLocationInformation_ is used by the location server to
request Bluetooth measurements from a target device.
\-- ASN1START
BT-RequestLocationInformation-r13 ::= SEQUENCE {
requestedMeasurements-r13 BIT STRING {
rssi (0)} (SIZE(1..8)),
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_BT-RequestLocationInformation_** field descriptions | +----------------------------------------------------------------------+ | **_requestedMeasurements_** | | | | This field specifies the Bluetooth measurements requested. This is | | represented by a bit string, with a one‑value at the bit position | | means the particular measurement is requested; a zero‑value means | | not requested. The following measurement requests can be included. | | | | rssi: Bluetooth beacon signal strength at the target | +----------------------------------------------------------------------+
#### 6.5.7.4 Bluetooth Capability Information
#### _\--_ _BT-ProvideCapabilities_
The IE _BT-ProvideCapabilites_ is used by the target device to provide its
capabilities for Bluetooth positioning to the location server.
\-- ASN1START
BT-ProvideCapabilities-r13 ::= SEQUENCE {
bt-Modes-r13 BIT STRING { standalone (0),
ue-assisted (1)} (SIZE (1..8)),
bt-MeasSupported-r13 BIT STRING { rssi-r13 (0)} (SIZE (1..8)),
...,
[[
idleStateForMeasurements-r14
ENUMERATED { required } OPTIONAL,
periodicalReportingSupported-r14
PositioningModes OPTIONAL
]]
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_BT-ProvideCapabilities_** field descriptions | +----------------------------------------------------------------------+ | **_bt-Modes_** | | | | This field specifies the Bluetooth mode(s) supported by the target | | device. This is represented by a bit string, with a one value at the | | bit position means the Bluetooth mode is supported; a zero value | | means not supported. | +----------------------------------------------------------------------+ | **_bt-MeasSupported_** | | | | This field specifies the Bluetooth measurements supported by the | | target device. This is represented by a bit string, with a one‑value | | at the bit position means the particular measurement is supported; a | | zero‑value means not supported. A zero-value in all bit positions in | | the bit string means only the basic Bluetooth positioning method is | | supported by the target device which is reporting of the Bluetooth | | beacon identity. The following bits are assigned for the indicated | | measurements. | | | | > rssi: Bluetooth beacon signal strength at the target device | +----------------------------------------------------------------------+ | **_idleStateForMeasurements_** | | | | This field, if present, indicates that the target device requires | | idle state to perform BT measurements. | +----------------------------------------------------------------------+ | **_periodicalReportingSupported_** | | | | **_This field, if present, specifies the positioning modes for which | | the target device supports periodicalReporting. This is represented | | by a bit string, with a one value at the bit position means | | periodicalReporting for the positioning mode is supported; a zero | | value means not supported._** If this field is absent, the location | | server may assume that the target device does not support | | _periodicalReporting_ in _CommonIEsRequestLocationInformation_. | +----------------------------------------------------------------------+
#### 6.5.7.5 Bluetooth Capability Information Request
#### _\--_ _BT-RequestCapabilities_
The IE _BT-RequestCapabilities_ is used by the location server to request
Bluetooth positioning capabilities from a target device.
\-- ASN1START
BT-RequestCapabilities-r13 ::= SEQUENCE {
...
}
\-- ASN1STOP
#### 6.5.7.6 BT Error Elements
#### _\--_ _BT-Error_
The IE _BT-Error_ is used by the location server or target device to provide
error reasons for Bluetooth positioning to the target device or location
server, respectively.
\-- ASN1START
BT-Error-r13 ::= CHOICE {
locationServerErrorCauses-r13 BT-LocationServerErrorCauses-r13,
targetDeviceErrorCauses-r13 BT-TargetDeviceErrorCauses-r13,
...
}
\-- ASN1STOP
#### _\--_ _BT-LocationServerErrorCauses_
The IE _BT-LocationServerErrorCauses_ is used by the location server to
provide error reasons for Bluetooth positioning to the target device.
\-- ASN1START
BT-LocationServerErrorCauses-r13 ::= SEQUENCE {
cause-r13 ENUMERATED {undefined, ...},
...
}
\-- ASN1STOP
#### \-- _BT-TargetDeviceErrorCauses_
The IE _BT-TargetDeviceErrorCauses_ is used by the target device to provide
error reasons for Bluetooth positioning to the location server.
\-- ASN1START
BT-TargetDeviceErrorCauses-r13 ::= SEQUENCE {
cause-r13 ENUMERATED {undefined,
requestedMeasurementsNotAvailable,
notAllrequestedMeasurementsPossible,
...
},
bt-Beacon-rssiMeasurementNotPossible-r13 NULL OPTIONAL,
...
}
\-- ASN1STOP
+----------------------------------------------------------------------+ | **_BT-TargetDeviceErrorCauses_** field descriptions | +----------------------------------------------------------------------+ | **_cause_** | | | | This field provides a Bluetooth specific error cause. If the cause | | value is \'notAllRequestedMeasurementsPossible\', the target device | | was not able to provide all requested Bluetooth measurements (but | | may be able to provide some measurements). In this case, the target | | device should include _bt-Beacon-rssiMeasurementNotPossible_ field. | +----------------------------------------------------------------------+
#### _\-- End of LPP-PDU-Definitions_
\-- ASN1START
END
\-- ASN1STOP
#