# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
A new type of physical layer is proposed for the GSM/EDGE Radio Access Network
(GERAN): the flexible layer one (FLO). The main advantage of FLO is that the
configuration of the physical layer (e.g. channel coding and interleaving) is
specified at call setup. This means that the support of new services such as
IP Multimedia Subsystem (IMS) services can be handled smoothly without having
to specify new coding schemes in each release.
Through several enhancements such as reduced granularity and flexible
interleaving, the radio bearers offered by FLO would not only fulfil the IMS
requirements in terms of flexibility and performance, but also greatly improve
the link level performance of real-time IMS services compared to GERAN Release
5.
The objective of this TR is to provide an overview of FLO, its architecture
and study the impacts it has on the GERAN radio protocol stack.
# 1 Scope
The present document provides an overview of the flexible layer one, its
architecture and studies the impacts it has on the GERAN radio protocol stack.
The present document specifies functions, procedures and information which
apply to GERAN Iu mode. However, functionality related to GERAN Iu mode is
neither maintained nor enhanced.
# 2 References
The following documents contain provisions, which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
  * 3GPP TR 21.905: "Vocabulary for 3GPP Specifications".
  * 3GPP TS 22.101, "Service Principles".
  * 3GPP TS 22.228, "Service requirements for the IP Multimedia Core Network Subsystem".
  * 3GPP TS 23.107, "QoS Concept and Architecture".
  * 3GPP TS 23.228, "IP Multimedia Subsystem".
  * 3GPP TS 25.201, "Physical layer - General description".
  * 3GPP TS 25.212, "Multiplexing and channel coding (FDD)".
  * 3GPP TS 25.331, "RRC Protocol Specification".
  * 3GPP TS 32.201, "Specification of the 3GPP Confidentiality and Integrity Algorithms".
  * 3GPP TS 44.018: "Radio Resource Control protocol".
  * 3GPP TS 44.118, Release 11: "Radio Resource Control protocol, Iu mode".
  * 3GPP TS 44.060: "Radio Link Control/Medium Access Control protocol".
  * 3GPP TS 44.160, Release 11: "Radio Link Control/Medium Access Control protocol, Iu mode".
  * 3GPP TS 45.002: "Multiplexing and multiple access on the radio path".
  * 3GPP TS 45.003: "Channel Coding".
  * 3GPP TS 45.005: "Radio transmission and reception".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
apply.
**Active Transport Channel** : a transport channel is active during a TTI if
it carries a transport block.
**Dynamic attributes** : for one transport channel, the values of the dynamic
attributes are different among transport formats. They are configured by Layer
3 and can change on a TTI basis under the control of the MAC sublayer.
**Empty Transport Format** : a transport format such that no transport block
is carried over the transport channel (i.e. the transport channel is
inactive).
**Empty Transport Format Combination** : a transport format combination that
is made up only of empty transport formats.
**Inactive Transport Channel** : a transport channel is inactive during a TTI
if it does not carry a transport block (i.e. the transport block size is
zero).
**Radio Frame** : The result of applying rate matching to a transport block
along with its associated CRC that have first been channel encoded.
**Radio Packet** : The set of one or more radio frames together with the
applicable coded TFCI that form the volume of payload that can be transmitted
on a basic physical subchannel for any given TTI.
**Semi-static attributes** : for one transport channel, the values of the
semi-static attributes are common to all transport formats. They are
configured by Layer 3 and can only be changed by Layer 3 signalling.
**Transport Block** : block exchanged on a transport channel between the
physical layer and the MAC sublayer.
**Transport Channel** : SAP between the physical layer and the MAC sublayer.
**Transport Format** : configuration of a transport channel, including for
instance channel coding, CRC size, etc.
**Transport Format Combination** : allowed combination of transport format(s)
of the different transport channels that are multiplexed together on a basic
physical subchannel.
**Transport Format Combination Indicator** : layer one header that indicates
the transport format combination that has been selected for each radio packet.
**Transport Format Combination Set** : set of allowed transport format
combinations on a basic physical subchannel.
**Transport Format Indicator** : index identifying a particular transport
format within the transport format set.
**Transport Format Set** : set of all transport formats defined for a
particular transport channel.
**Transmission Time Interval** : rate at which transport blocks are exchanged
between the physical layer and the MAC sublayer on a transport channel.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ADCH Associated Dedicated CHannel
CCTrCH Coded Composite Transport CHannel
CDCH Control-plane Dedicated CHannel
CTFC _Calculated Transport Format Combinations_
_DCH_ Dedicated CHannel
FLO Flexible Layer One
GERAN GSM/EDGE Radio Access Network
IMS IP Multimedia Subsystem
MAC Medium Access Control
QoS Quality of Service
PDU Protocol Data Unit
RAN Radio Access Network
RLC Radio Link Control
RRC Radio Resource Control
RT Real Time
SDU Service Data Unit
SAP Service Access Point
TB Transport Block
TBF Temporary Block Flow
TF Transport Format
TFI Temporary block Flow Identity
TFS Transport Format Set
TFIN Transport Format INdicator
TFC Transport Format Combination
TFCI Transport Format Combination Indicator
TFCS Transport Format Combination Set
TrCH Transport Channel
TTI Transmission Time Interval
UDCH User-plane Dedicated CHannel
UTRAN Universal Terrestrial Radio Access Network
Other abbreviations used in the present document are listed in 3GPP TR 21.905.
# 4 Motivation
The need for a flexible layer one for the Release 6 of GERAN is driven by the
introduction of IMS services. For an efficient support of IMS services,
requirements are set on the radio bearer service of the RAN (see 3GPP TS
22.101, 3GPP TS 22.228, 3GPP TS 23.228 and 3GPP TS 23.107):
\- the radio bearers should be flexible enough to efficiently deploy any IP
multimedia applications;
\- the radio bearers should allow the transport of several flows in parallel
(e.g. text and video);
\- the radio bearers should satisfy the user in a spectral efficient manner;
\- the radio bearer should support the UMTS QoS concept and architecture.
So as to fulfil these requirements in an efficient manner, a flexible layer
one is needed. Thanks to the flexible layer one optimised support of real time
IMS services is made possible in GERAN.
# 5 Requirements
The flexible layer one should:
\- fulfil most of the IMS requirements in terms of radio bearer service
attributes;
\- support the multiplexing of parallel flows on to a basic physical
subchannel;
\- provide an optimisation of spectral efficiency through the support of
different interleaving depths, unequal error protection/detection, reduced
channel coding rate granularity and support of 8PSK and GMSK modulations;
\- provide an efficient support of real time IMS services;
\- be applicable to both modes of operation: _A/Gb mode_ and _Iu mode_ ;
\- minimize the impacts on the radio protocols;
\- minimize the overhead introduced by the radio protocol stack;
\- not introduce an unfeasible number of test configurations;
\- be future proof;
\- within reason, be compatible with legacy transceiver implementations.
# 6 Overview of FLO
## 6.1 General
In GERAN Release 5, the MAC sublayer is responsible for the mapping between
the logical channels (traffic or control channels) and the basic physical
channels (see 3GPP TS 45.002). The logical channels are the channels the
physical layer offers to the MAC sublayer. Until now these logical channels
and the mapping to the basic physical channel have been fully specified in
3GPP TS 45.002.
A different approach has been taken in UTRAN, where instead of providing
logical channels the physical layer offers Transport Channels (TrCH), which
can be used by the MAC sublayer (see 3GPP TS 25.201). A transport channel is
used to transmit one data flow with a given QoS over the radio interface. A
number of transport channels can be active at the same time and multiplexed at
the physical layer. The transport channels are configured at call setup by the
network.
With FLO, the concept of transport channels used in UTRAN can be reused in
GERAN i.e. the physical layer offers one or several transport channels to the
MAC sublayer.
## 6.2 Principles of FLO
With FLO, the physical layer of GERAN offers one or several transport channels
to the MAC sublayer. Each of these transport channels can carry one data flow
providing a certain Quality of Service (QoS). A number of transport channels
can be multiplexed and sent on the same basic physical subchannel at the same
time.
The configuration of a transport channel i.e. the number of input bits,
channel coding, interleaving etc. is denoted the Transport Format (TF). As in
UTRAN, a number of different transport formats can be associated to one
transport channel. The configuration of the transport formats is completely
controlled by the RAN and signalled to the MS at call setup. In both the MS
and the BTS, the transport formats are used to configure the encoder and
decoder units. When configuring a transport format, the RAN can choose between
a number of predefined CRC lengths and block lengths.
On transport channels, transport blocks (TB) are exchanged between the MAC
sublayer and the physical layer on a transmission time interval (TTI) basis.
For each TTI a transport format is chosen and indicated through the transport
format indicator (TFIN). In other words, the TFIN tells which transport format
to use for that particular transport block on that particular TrCH during that
particular TTI. When a transport channel is inactive, the transport format
with a transport block size of zero (empty transport format) is selected.
Only a limited number of combinations of the transport formats of the
different TrCHs are allowed. A valid combination is called a Transport Format
Combination (TFC). The set of valid TFCs on a basic physical subchannel is
called the Transport Format Combination Set (TFCS). The TFCS is signalled
through the Calculated Transport Format Combinations (CTFC).
In order to decode the received sequence the receiver needs to know the active
TFC for a radio packet. This information is transmitted in the Transport
Format Combination Indicator (TFCI) field. This field is basically a layer 1
header and has the same function as the stealing bits in GSM. Each of the TFC
within a TFCS are assigned a unique TFCI value and when a radio packet is
received this is the first to be decoded by the receiver. From the decoded
TFCI value the transport formats for the different transport channels are
known and the actual decoding can start.
In case of multislot operation, there shall be one FLO instance for each basic
physical subchannel. Each FLO instance is configured independently by Layer 3
and as a result gets its own TFCS. The number of allocated basic physical
subchannels depends on the multislot capabilities of the MS.
## 6.3 Evolution from Release 5
In GERAN Release 5, logical channels are offered by the physical layer to the
MAC sublayer. With FLO, transport channels are offered by the physical layer
to the MAC sublayer.
In GERAN Release 5, speech frames, RLC/MAC blocks, data frames and blocks of
info bits are exchanged on logical channels between the physical layer and the
MAC sublayer. With FLO, transport blocks are exchanged on transport channels
between the physical layer and the MAC sublayer.
In GERAN Release 5, a fixed set of coding schemes are standardized for each
logical channel in 3GPP TS 45.003. With FLO, transport formats are configured
at call setup for each transport channel.
In GERAN Release 5, only one logical channel can be sent per radio block. With
FLO, the transport format combinations allow a number of transport channels to
be multiplexed within the same radio block.
In GERAN Release 5, the coding scheme and/or the content of the radio block is
indicated by the stealing bits. With FLO, the TFC and thereby the active
transport formats of the TrCHs is indicated by the TFCI.
## 6.4 Limitations
The following assumptions are made in order to limit the complexity of FLO:
\- FLO shall be used on dedicated channels only, maintaining the 26-multiframe
structure for which the SACCH shall be treated as a separate logical channel
based on Release 5 format;
\- All TrCHs shall use the same TTI: the same length as in GSM/GPRS of Release
5, i.e. 20ms;
\- FLO shall provide at most 8 transport channels per basic physical
subchannel;
\- FLO shall support a maximum of 4 active transport channels per radio packet
per basic physical subchannel;
\- The size of the TFCI shall be limited to 5 bits, allowing a maximum of 32
different TFCs per basic physical subchannel;
\- A maximum of 32 different TFs is allowed per TrCH;
\- One RLC PDU cannot be mapped across multiple basic physical subchannels.
## 6.5 Protocol architecture
### 6.5.1 Iu mode
Figure 1 below illustrates the protocol architecture in conjunction with FLO
in _Iu_ _mode_ :
{width="3.6152777777777776in" height="3.7534722222222223in"}
Figure 1: Protocol Architecture for FLO in _Iu mode_
The physical layer offers transport channels to the MAC sublayer. MAC is
responsible for mapping temporary block flows (see 3GPP TS 44.160 [13]) on
appropriate transport channels.
One type of transport channel is introduced: Dedicated CHannel (DCH). A DCH is
a unidirectional channel dedicated to one MS used in uplink or downlink. A
mobile station may have one or more TrCHs of type DCH active at the same time.
### 6.5.2 A/Gb mode
Text will be added when FLO concepts for A/Gb mode have stabilized.
### 6.5.3 TBF configuration principles
Each TBF is mapped to 1 transport channel per each timeslot assigned to the
TBF (see subclause 6.4) for sending RLC data blocks. When a TBF is assigned
multiple timeslots, the transport channels used by the TBF shall be configured
with the same Transport Format Set. RLC/MAC control blocks are transmitted
using the signalling TFC.
On a timeslot, several TBFs may be multiplexed onto the same transport
channel. In this case, the receiver identifies which TBF a transport block
belongs to by means of the TFI field or a radio bearer identifier.
# 7 Layer 1 for FLO
The architecture of FLO is depicted in the Figure 2 below. A one-step
interleaving has been assumed. This implies that all TrCHs on one basic
physical subchannel have the same interleaving depth.
Figure 2: FLO Architecture
## 7.1 CRC Attachment
Error Detection is provided on each transport block through a cyclic
redundancy check (CRC). The size of the CRC to be used is fixed on each TrCH
and configured by Layer 3 (semi static attribute of the transport format): 0,
6, 12 or 18 bits. Code blocks are output from the CRC attachment. The entire
transport block is used to calculate the parity bits. The parity bits are
generated by one of the following cyclic generator polynomials, and appended
to the transport block:
\- gCRC18(D) = D^18^ + D^17^ + D^14^ + D^13^ + D^11^ + D^10^ + D^8^ + D^7^ +
D^6^ + D^3^ + D^2^ + 1 as in SACCH/TP
\- gCRC12(D) = D^12^ + D^11^ + D^10^ + D^8^ + D^5^ + D^4^ + 1 as in GPRS
\- gCRC6(D) = D^6^ + D^5^ + D^3^ + D^2^ + D + 1 as in TCH/AFS
The resulting upper limits for the residual bit error rate (RBER), listed in
Table 1 below, fulfil the QoS requirements specified in 3GPP TS 23.107.
Table 1: RBER
* * *
CRC Size RBER 6 bits 2.10^-2^ 12 bits 2.10^-4^ 18 bits 4.10^-6^
* * *
## 7.2 Channel Coding
After CRC attachment, the code blocks are processed through channel coding,
producing encoded blocks.
Only one type of coding is proposed for use in Release 6, the same 1/3
convolutional code of constraint length 7 as in EGPRS, defined by the
following polynomials (see 3GPP TS 45.003):
G4 = 1 + D^2^ + D^3^ + D^5^ + D^6^
G7 = 1 + D + D^2^ + D^3^ + D^6^
G5 = 1 + D + D^4^ + D^6^
## 7.3 Rate Matching
The rate matching is the core of FLO. In rate matching, bits of an encoded
block on a transport channel are repeated or punctured. Since the block size
is a dynamic attribute, the number of bits on a transport channel can vary
between different transmission times. When it happens, bits are repeated or
punctured to ensure that the total bit rate after TrCH multiplexing is
identical to the total channel bit rate of the allocated basic physical
subchannel.
When only one transport channel is active at a time, the coding rate only
depends on the transport block size and on the available channel bandwidth.
But when more than one transport channel is active, the coding rate also
depends on the rate matching attributes associated to each transport channel.
The rate-matching attribute is used to calculate the number of bits to be
repeated or punctured for each transport channel.
Higher layers assign the rate matching attribute for each transport channel.
This attribute is semi-static and can only be changed through higher layer
signalling. The rate matching attributes define priorities between the coded
bits of different transport channels. The higher the rate matching attribute
is, the more important the coded bits are. By setting different rate matching
attributes to different transport channels, the effective coding rate (as a
result of puncturing or repeating bits of an encoded block) of the transport
channels can be adjusted.
Outputs from the rate matching are called radio frames. For every radio packet
the rate matching produces one radio frame per encoded block, i.e. per TrCH.
The rate matching algorithm for GERAN is based on the UTRAN one defined in
3GPP TS 25.212. A few simplifications are made since there is no spreading
factor, nor compressed mode, nor special cases such as turbo codes and
therefore many parameters of the UTRAN algorithm can be fixed either to 0 or 1
in GERAN.
Notation used:
> $\left\lfloor x \right\rfloor$ Round _x_ towards -∞, i.e. integer such that
> $x - 1 
> $\left| x \right|$ Absolute value of _x._
>
> _I_ Number of TrCHs in the coded composite transport channel (CCTrCH).
>
> $N_{\text{data}}$ Total number of bits that are available in a radio packet
> for the CCTrCH _._
>
> $N_{i,j}$ Number of bits in an encoded block before rate matching on TrCH
> _i_ with transport format combination _j_.
>
> $\text{ΔN}_{i,j}$ If positive, $\text{ΔN}_{i,j}$ denotes the number of bits
> that have to be repeated in an encoded block on TrCH _i_ with transport
> format combination _j_ in order to produce a radio frame.
>
> If negative,$\text{ΔN}_{i,j}$ denotes the number of bits that have to be
> punctured in an encoded block on TrCH _i_ with transport format combination
> _j_ in order to produce a radio frame.
>
> If null, no bits have to be punctured nor repeated, i.e. the rate matching
> is transparent and the content of the radio frame is identical to the
> content of the encoded block on TrCH _i_ with transport format combination
> _j_.
>
> $\text{RM}_{i}$ Semi-static rate matching attribute for transport channel
> _i_.
>
> _e~ini~_ Initial value of variable _e_ in the rate matching pattern
> determination algorithm.
>
> _e~plus~_ Increment of variable _e_ in the rate matching pattern
> determination algorithm.
>
> _e~minus~_ Decrement value of variable _[e]{.underline}_ in the rate
> matching pattern determination algorithm.
>
> $Z_{i,j}$ Intermediate calculation variable.
>
> _R_ Redundancy pattern index used for retransmissions of signalling
> transport blocks on half rate channels (see subclause 7.5). In all other
> cases _R_ = 0.
For each radio packet using transport format combination _j_ , the number of
bits to be repeated or punctured ∆ _N~i,j~_ within one encoded block for each
TrCH _i_ is calculated with the following equations:
$Z_{i,j} = \left\lfloor \frac{\left( \sum_{m = 1}^{i}\text{RM}_{m} \times
N_{m,j} \right) \times N_{\text{data}}}{\sum_{m = 1}^{I}\text{RM}_{m} \times
N_{m,j}} \right\rfloor$ for all _i_ = 1 ... _I_
$\text{ΔN}_{i,j} = Z_{i,j} - Z_{i - 1,j} - N_{i,j}$ for all _i_ = 1 ... _I_
For the calculation of the rate matching pattern of each TrCH _i_ the
following relations are defined:
_e~plus~_ = $2 \times N_{i,j}$
_e~minus~_ = $2 \times \left| \text{ΔN}_{i,j} \right|$
if $\text{ΔN}_{i,j}$ \ 0 -- repetition is to be performed
_e_ = _e~ini~_ \-- initial error between current and desired puncturing ratio
_m_ = 1 -- index of current bit
do while $m \leq N_{i,j}$ -- for each bit of the encoded block of TrCH _i_
_e_ = _e_ \-- _e_ ~minus~ -- update error
do while $e \leq 0$ -- check if bit number _m_ should be repeated
repeat bit b~i,m~ -- repeat bit
_e_ = _e_ \+ _e~plus~_ \-- update error
end do
_m_ = _m_ \+ 1 -- next bit
end do
else -- $\text{ΔN}_{i,j}$ = 0
do nothing -- no repetition nor puncturing
end if.
## 7.4 Transport Channel Multiplexing
For every radio packet to be transmitted, one radio frame from each active
TrCH is delivered to the TrCH multiplexing. These radio frames are serially
multiplexed to form a CCTrCH. The order in which each radio frame is
multiplexed is determined by the number of the associated TrCH (which is
assigned during TrCH configuration).
## 7.4a Inband signalling bits
In the downlink direction, inband signalling bits (used to control the TFC
selection algorithm in the MS, see subclause 8.5) are attached at the
beginning of the CCTrCH.
The inband signalling bits are used to transmit a TFCI sequence. The number of
coded inband signalling bits in each radio packet is equal to the size of the
coded uplink TFCI. For each channel type, its value is derived from the size
of the uncoded uplink TFCI (which is dependent on the number of TFCs in the
uplink TFCS) following the rules in subclause 7.5.
## 7.5 Transport Format Combination Identifier (TFCI)
The size of the TFCI depends on the number of TFCs needed. The smaller this
is, the shorter the TFCI is in order to minimize the overhead over the radio
interface. The size of the TFCI is however limited to a maximum of 5 bits,
allowing a maximum of 32 different transport format combinations on the same
basic physical subchannel. In other words, for a single connection (without
reconfiguration) it is proposed to have a maximum of 32 different channel
coding and/or multiplexing possibilities at a time.
For the coding of the TFCI, simple block codes can be used, as already used
for the stealing bits and the USF in 3GPP TS 45.003.
On GMSK full rate channels and 8PSK half rate channels, the coding of the TFCI
shall be as follows (see Annex A):
\- 1 bit TFCI shall be encoded to 8 bits;
\- 2 bits TFCI shall be encoded to 16 bits;
\- 3 bits TFCI shall be encoded to 24 bits;
\- 4 bits TFCI shall be encoded to 28 bits;
\- 5 bits TFCI shall be encoded to 36 bits.
On 8PSK full rate channels, the coding of the TFCI shall be obtained by
repetition of the coding defined for GMSK full rate channels (see Annex A):
\- 1 bit TFCI shall be encoded to 16 bits (2 times 8 bits);
\- 2 bits TFCI shall be encoded to 32 bits (2 times 16 bits);
\- 3 bits TFCI shall be encoded to 48 bits (2 times 24 bits);
\- 4 bits TFCI shall be encoded to 56 bits (2 times 28 bits);
\- 5 bits TFCI shall be encoded to 72 bits (2 times 36 bits).
On GMSK half rate channels, the coding of the TFCI shall be obtained by using
only the middle segment of the coding defined for GMSK full rate channels (see
Annex A):
\- 1 bit TFCI shall be encoded to 4 bits;
\- 2 bits TFCI shall be encoded to 8 bits;
\- 3 bits TFCI shall be encoded to 12 bits;
\- 4 bits TFCI shall be encoded to 14 bits;
\- 5 bits TFCI shall be encoded to 18 bits.
The coded TFCI is then attached at the beginning of the CCTrCH (and, in the
downlink direction, before the inband signalling bits) before interleaving.
## 7.6 Interleaving
The coded TFCI and the CCTrCH are interleaved together on bursts. The
interleaving can be either block diagonal or block rectangular and is
configured at call set-up. The interleaving is based on the following
equations:
for _k_ = 0,1,2, ..._K_ -1
$b = k\text{mod}D$
for block diagonal interleaving:
> if _a_ > 1 then $s = \text{int}\left\lbrack
> \frac{k}{\frac{N_{\text{radio}}}{a}} \right\rbrack$
else _s_ = 0
for block rectangular interleaving:
if _a_ > 1 then$s = \text{int}\left\lbrack
\frac{k}{\frac{N_{\text{radio}}}{a}} \right\rbrack$
else _s_ = 0
where:
_j_ is the position of the bit _k_ within the burst _b_ ;
_D_ is the interleaving depth in bursts;
_J_ is the burst size in bits;
_K_ is the size of the radio packet in bits (_K_ = _N~radio~_);
_M_ is the size of the radio packet in bursts (_M_ = _K_ / _J_ );
_GCD_(_m_ ,_n_) is the greatest common divisor of _m_ and _n_.
On 8PSK channels, bit swapping for the coded bits of the TFCI is applied: for
every bit _k_ belonging to the coded TFCI for which _j_ (the position of the
bit _k_ within the burst _b_) verifies $(j + 1)\text{mod}3 = 0$ (i.e. the
coded bit of the TFCI is to be mapped on a weak bit of the 8PSK symbol), the
following swap is performed:
if $(\text{cpt}\text{mod}2 = 0)$ the bit _k_ is swapped with bit _k +_ 80
else the bit _k_ is swapped with bit _K_ \- 80 +_k_
where
> _cpt_ is a counter of the swapped bits. The value of _cpt_ is set to zero
> before swapping and incremented by 1 after every swapped bit. For the first
> swapped bit _cpt_ = 0, for the second swapped bit _cpt_ = 1 and so on.
On full rate GMSK channels _K_ = 464 and _J_ = 116. On full rate 8PSK
channels, _K_ = 1392 and _J_ = 348.
On half rate GMSK channels, _K_ = 232 and _J_ = 116. On half rate 8PSK
channels, _K_ = 696 and _J_ = 348.
For diagonal interleaving over 40 ms (used on full rate channels), _D_ = 8\.
The result of the interleaving is then a distribution of the reordered bits
over 8 bursts, using the even numbered position of the first 4 bursts and the
odd positions of the last 4 bursts.
For diagonal interleaving over 40 ms (used on half rate channels), _D_ = 4\.
The result of the interleaving is then a distribution of the reordered bits
over 4 blocks, using the even numbered position of the first 2 bursts and the
odd positions of the last 2 bursts.
For diagonal interleaving over 60 ms (used on full rate channels), _D_ = 12\.
The result of the interleaving is then a distribution of the reordered bits
over 12 bursts, allocating one third of the bits to each of three consecutive
radio packets.
For diagonal interleaving over 60 ms (used on half rate channels), _D_ = 6\.
The result of the interleaving is then a distribution of the reordered bits
over 6 bursts, allocating one third of the bits to each of three consecutive
radio packets.
For block rectangular interleaving over 20 ms (used on full rate channels),
_D_ = 4. The result is the combination of the first 4 bursts with the 4 last
bursts of the result of a block diagonal interleaving over 2× _D_ bursts:
block 0 and block 4, block 1 and block 5, block 2 and block 6, block 3 and
block 7.
Block diagonal interleaving over 60 ms shall be used for 8PSK modulation only.
## 7.7 Signalling on HR Channels
For seamless handovers between full rate and half rate channels the link level
performance of associated signalling must be similar for the two channel
modes. Consequently the coding rate of associated signalling on half rate
channels must be equal to the coding rate of associated signalling on full
rate channels. This is achieved in GSM/EDGE by increasing the interleaving
depth of FACCH on half rate channels: twice the interleaving depth of TCH/H
(see 3GPP TS 45.003). As a result the performance of FACCH/H is very similar
to the performance of FACCH/F (see 3GPP TS 45.005).
With the one step interleaving architecture, all TrCHs on one basic physical
subchannel have the same interleaving depth. It is therefore not possible to
apply the same mechanism as in GSM/EDGE on CDCH and ADCH. Instead the MAC
layer shall send the same transport block twice in a row. Since coded bits of
the same transport block can be found in two consecutive radio packets, the
effect is as if the interleaving depth was twice the interleaving used for one
radio packet. In rate matching, a different value of _R_ is used for the radio
packets. The value of _R_ to be used by the encoder is given by the TDMA frame
number of the first burst carrying coded bits for that radio packet, and table
7.7 below. For instance, if the first coded bits of the signalling radio
packet are sent on TDMA frame 0, the value of _R_ to be used by the encoder is
0. If the first coded bits are sent on TDMA frame 4, the value of _R_ to be
used is 1. Because radio packets are sent on a 20ms basis, the two consecutive
signalling radio packets never use the same value of _R_.
Table 7.7: _R_ and TDMA frame number modulo 26
* * *
TDMA frame number _R_ 0, 1, 2, 3 0 4, 5, 6, 7 1 8, 9, 10, 11 0 13, 14, 15, 16
1 17, 18, 19, 20 0 21, 22, 23, 24 1
* * *
# 8 Layer 2 for FLO
## 8.1 Protocol architecture in _Iu mode_
### 8.1.1 General
The MAC sublayer offers TBFs for the transfer of RLC data between peer RLC
entities.
One type of TrCH is offered by FLO to the MAC sublayer, DCH, as defined in
subclause 6.5.
Three different DCHs are introduced, namely CDCH (Control-plane DCH), UDCH
(User-plane DCH) and ADCH (Associated DCH). While CDCH and UDCH are used
exclusively for transmission of RLC/MAC blocks for data transfer, ADCH is used
exclusively for transmission of RLC/MAC control blocks. CDCH and UDCH shall
use the TFC for signalling as defined in sub-clause 9.5.
NOTE: CDCH, UDCH and ADCH naming convention is introduced in order to allow
for an easier stage 3 definition of RLC and MAC protocols (e.g. "ADCH" to
replace "PACCH", and "UDCH" to replace "PDTCH", on DBPSCH)
{width="3.0652777777777778in" height="3.426388888888889in"}
Figure 3: Logical Channels and Transport Channels
On a transport channel, a transport block is the basic unit of traffic
exchanged between the MAC sublayer and the physical layer.
A transport block consists of a MAC PDU i.e. RLC/MAC block, as shown in Figure
4. The structure of an RLC/MAC block is defined in subclause 8.3.1.
Figure 4: Transport Block structure
The number of bits in a transport block is the transport block size.
### 8.1.2 RLC protocol
FLO allows for transmission of RLC information in RLC acknowledged mode, RLC
unacknowledged mode and RLC transparent mode.
The functions and services provided by the RLC protocol are defined in 3GPP TS
44.160 [13]. No new functions or services are needed to support FLO.
RLC blocks are transferred between two peer RLC entities at a maximum rate of
one RLC block per TTI, per timeslot.
### 8.1.3 MAC protocol
The MAC sublayer allows the transmission over the physical layer with FLO of
upper layer PDUs from one mobile station on dedicated basic physical
subchannel(s). MAC does not allow for operation on shared basic physical
subchannel using FLO.
The specific functions provided by the MAC protocol when FLO is used are
listed below:
\- **Mapping between TBFs and transport channels.** The MAC is responsible for
mapping of **TBF**(s) onto the appropriate transport channel(s).
**-** **Selection of the appropriate transport format per transport channel.**
The MAC is responsible for selecting the appropriate transport format for each
transport channel within the transport format set configured by RRC for each
transport channel so that the resulting transport format combination on the
coded composite transport channel belongs to the transport format combination
set configured by RRC.
**\- Priority handling between data flows of one MS.**
Other functions provided by the MAC protocol when FLO is used are listed in
3GPP TS 44.160 [13].
## 8.2 Protocol architecture in _A/Gb mode_
Text will be added when FLO concepts for A/Gb mode have stabilized.
## 8.3 RLC/MAC block structure
### 8.3.1 General
An RLC/MAC block consists of either an RLC/MAC block for data transfer or an
RLC/MAC block for control message transfer.
In non-transparent RLC mode, the structure of an RLC/MAC block for data
transfer consists of an RLC/MAC header and an RLC data block.
* * *
RLC/MAC block  
RLC/MAC header RLC data block
* * *
Figure 5: RLC/MAC block structure for data transfer in NT-RLC
In transparent RLC mode, the structure of an RLC/MAC block for data transfer
consists of an RLC data block.
* * *
RLC/MAC block RLC data block
* * *
Figure 6: RLC/MAC block structure for data transfer in T-RLC
The structure of an RLC/MAC block for control message transfer consists of a
MAC header and an RLC/MAC control block.
* * *
RLC/MAC block  
MAC header RLC/MAC control block
* * *
Figure 7: RLC/MAC block structure for control message transfer
### 8.3.2 RLC/MAC blocks for control message transfer
#### 8.3.2.1 Downlink RLC/MAC control block format
* * *
Bit  
8 7 6 5 4 3 2 1  
PT P S RBSN RTI Octet 1  
Control message content Octet 2  
.  
.  
.  
Octet N=23
* * *
Figure 8: Downlink RLC/MAC control block together with its MAC header
#### 8.3.2.2 Uplink RLC/MAC control block format
* * *
Bit  
8 7 6 5 4 3 2 1  
PT P Octet 1  
Control message content Octet 2  
.  
.  
.  
Octet N=23
* * *
Figure 9: Uplink RLC/MAC control block together with its MAC header
### 8.3.3 RLC/MAC blocks for data transfer
#### 8.3.3.1 Downlink RLC/MAC block for data transfer
##### 8.3.3.1.1 RLC unacknowledged mode
* * *
Bit  
8 7 6 5 4 3 2 1  
PT TFI (=RB Id) P BSN Octet 1  
BSN E Length Indicator Octet 2  
Length Indicator E ... Octet 3  
... E Length Indicator ...  
Length Indicator E Octet M  
RLC data Octet M + 1  
.  
.  
.  
Octet N (see note)
* * *
NOTE: the RLC data may contain a non-integer number of octets.
Figure 10: RLC/MAC block for data transfer in RLC unacknowledged mode
##### 8.3.3.1.2 RLC acknowledged mode
* * *
Bit  
8 7 6 5 4 3 2 1  
PT TFI (=RB Id) P BSN Octet 1  
BSN SPB Octet 2  
SPB E Length Indicator (LI) Octet 3  
LI E ...  
... E Length Indicator (LI)  
LI E Octet M  
RLC data Octet M+1  
.  
.  
.  
Octet N (see note)
* * *
NOTE: the RLC data may contain a non-integer number of octets.
Figure 11: Downlink RLC/MAC block for data transfer in RLC acknowledged mode
##### 8.3.3.1.3 RLC transparent mode
* * *
Bit  
8 7 6 5 4 3 2 1  
RLC data Octet 1  
.  
.  
.  
Octet N (see note)
* * *
NOTE: the RLC data may contain a non-integer number of octets. N≥1.
Figure 12: Downlink RLC/MAC block for data transfer in RLC transparent mode
#### 8.3.3.2 Uplink RLC/MAC block for data transfer
##### 8.3.3.2.1 RLC unacknowledged mode
The uplink RLC/MAC block format for data transfer in RLC unacknowledged mode
is the same as for downlink, as described in subclause 8.3.3.1.1.
##### 8.3.3.2.2 RLC acknowledged mode
* * *
Bit  
8 7 6 5 4 3 2 1  
PT TFI (=RB Id) P BSN Octet 1  
BSN SPB Octet 2  
SPB SI E Length Indicator Octet 3  
Length Indicator E ...  
... E Length Indicator  
Length Indicator E Octet M  
RLC data Octet M+1  
.  
.  
.  
Octet N (see note)
* * *
NOTE: the RLC data may contain a non-integer number of octets
Figure 13: Uplink RLC/MAC block for data transfer in RLC acknowledged mode
##### 8.3.3.2.3 RLC transparent mode
* * *
Bit  
8 7 6 5 4 3 2 1  
RLC data Octet 1  
.  
.  
.  
Octet N (see note)
* * *
NOTE: the RLC data may contain a non-integer number of octets. N≥1
Figure 14: Uplink RLC/MAC block for data transfer in RLC transparent mode
## 8.4 Ciphering in _Iu mode_
### 8.4.1 General
Ciphering is provided following the same principles as when FLO is not used.
The ciphering function is performed either in the RLC sublayer or in the MAC
sublayer according to the following rules:
\- The RLC sublayer is responsible for ciphering/deciphering RLC data blocks
in case of non-transparent RLC mode (unacknowledged or acknowledged);
\- The MAC sublayer is responsible for ciphering/deciphering user data in case
of transparent RLC mode. It is also responsible for ciphering/deciphering some
RLC/MAC control messages as specified in 3GPP TS 44.160 [13].
The ciphering function uses the ciphering algorithm f8 specified in 3GPP TS
35.201.
### 8.4.2 Parameters settings
#### 8.4.2.1 RLC non-transparent mode
Table 2 defines how to set the input parameters to the ciphering algorithm.
Table 2: Input parameters to the ciphering algorithm
+----------+----------+----------+----------+----------+----------+ | Input | Size in | Settings | | | | | pa | bits | | | | | | rameters | | | | | | +----------+----------+----------+----------+----------+----------+ | | | RLC Mode | Unack | Ack | | +----------+----------+----------+----------+----------+----------+ | Count | 32 | MSB | HFN | _27 |_ 23 | | | | | | bits _| bits_ | | | | | | | | | | | | | _0...13 |_ 0... | | | | | | 4217727 _| 8388607_ | +----------+----------+----------+----------+----------+----------+ | | | | RBid | 1 bit | | | | | | i | | | | | | | ndicator | _1_ | | | | | | | (RBid | | | | | | | av | | | | | | | ailable) | | +----------+----------+----------+----------+----------+----------+ | | | LSB | BSN | _4 bits_ | _8 bits_ | | | | | | | | | | | | | _0...15_ | * | | | | | | | 0...255 _| +----------+----------+----------+----------+----------+----------+ | D | 1 | | D | 1 bit | | | irection | | | irection | | | | | | | |_ 0 _| | | | | | | (uplink) | | | | | | | | | | | | | |_ 1 _| | | | | | | (d | | | | | | | ownlink) | | +----------+----------+----------+----------+----------+----------+ | Bearer | 5 | | RBid | 5 bits | | | | | | | | | | | | | |_ 0...31 _| | +----------+----------+----------+----------+----------+----------+ | Length | 11 | | Length | 11 bits | | | | | | in bits | | | | | | | of the |_ 0 | | | | | | plain | ...1370* | | | | | | data to | | | | | | | cipher | | | +----------+----------+----------+----------+----------+----------+
NOTE: these parameters are the same as for DCCH and TCH TBF modes, except the
maximum length, which is higher.
#### 8.4.2.2 RLC transparent mode
3GPP TS 44.160 [13] defines how to set the input parameters to the ciphering
algorithm.
#### 8.4.2.3 RLC/MAC control messages
3GPP TS 44.160 [13] defines how to set the input parameters to the ciphering
algorithm.
## 8.5 TFC Selection
### 8.5.1 TFC selection in the uplink
The selection of the TFC to be used in the uplink during each TTI is under the
control of the MAC Layer in the MS. The MS should select a TFC according not
only to the data available to be sent and the priority of the flows to which
the data belongs, but also to the conditions of the radio channel. The
conditions of the radio channel in the uplink are known only to the network,
so the network should provide information to the MS to assist in the decision.
The algorithm for the selection of the TFC to be used in the uplink is as
follows:
1\. When defining the TFCS, the TFCs are ranked according to the radio
conditions or signal quality required to achieved a specified quality of
service (e.g. the higher the TFCI, the better the quality of the radio link
required); this could be characterised, for example, in terms of RXLEV, BEP,
the BLER on the different transport channels, or other parameters.
2\. The ranking is communicated to the MS at call set-up by means of the order
in which they are signalled in the assignment message: the TFCs are signalled
in the assignment message in increasing order of quality of the link required.
3\. Based on the measurement performed by the BSS, the network determines
periodically within a call the "highest TFC" that, with the current radio
conditions, would meet the quality of service criteria.
4\. The network signals the "highest TFC" to the MS by transmitting in the
downlink the value of the TFCI (within the TFCS defined for the uplink)
corresponding to the highest TFC that the MS is allowed to select in the
uplink. The network sends this TFCI, encoded as defined in subclause 7.5,
using the inband signalling bits of a downlink radio packet (see subclause
7.4a). One coded TFCI is transmitted in every radio packet. In case of
multislot operation, as the TFCS could be different on different timeslots,
the "highest TFC" needs to be signalled separately for each timeslot.
5\. The MS is allowed to use only TFCs whose TFCI is lower than or equal to
the TFCI indicated by the network and that have not been restricted by higher
layer signalling (see sub-clause 9.3). The set of these TFCs is called "valid
TFCs". The MS selects the particular TFC to be used for transmission in the
uplink from the set of valid TFCs, according to the rules given below.
Every TTI, the MS selects the TFC within the set of valid TFCs using the
following rules (see 3GPP TS 25.321):
> 1\. No other TFC shall allow the transmission of more highest priority data
> than the chosen TFC.
>
> 2\. No other TFC shall allow the transmission of more data from the next
> lower priority TBFs. Apply this criterion recursively for the remaining
> priority levels.
### 8.5.2 TFC selection in the downlink
The selection of the TFC to be used in the downlink during each TTI is under
the control of the MAC Layer in the network. The network should select a TFC
according not only to the data available to be sent and the priority of the
flows to which the data belongs, but also to the conditions of the radio
channel.
To determine the conditions of the radio channel on the downlink, the network
may utilise the measurement report sent by the MS every 480ms, or if Enhanced
Power Control (EPC) is supported, the measurement report sent by the MS every
120ms when in EPC mode.
## 8.6 Ciphering in _A/Gb mode_
Ciphering of FLO channels follows the same principles as when FLO is not used.
When FLO is used in the PS domain, ciphering is provided for LLC PDUs and is
performed by the SGSN following the same principles as ciphering in
GPRS/EGPRS.
# 9 Layer 3 for FLO
## 9.1 In _Iu mode_
The RRC layer is responsible for the setup, reconfiguration and release of the
TrCH(s). The RRC procedures affected by the introduction of FLO are RB control
procedures and RRC Connection Mobility procedures.
The following RRC messages are impacted by the introduction of FLO: RADIO
BEARER SETUP, RADIO BEARER RECONFIGURATION, RADIO BEARER RELEASE and CELL
UPDATE CONFIRM. New procedures to reconfigure only the transport channels are
considered to be introduced in GERAN _Iu mode_ : Transport Channel
Reconfiguration procedures. Additionally Radio Bearer Reconfiguration
procedures could reconfigure either RB parameters or transport channels or
physical parameters or all, if needed. If only TrCH(s) need to be reconfigured
it is ffs whether Transport Channel Reconfiguration procedures could be
introduced as a subset of the Reconfiguration procedures. Transport Channel
Reconfiguration procedures cannot be used for modifying the physical
parameters.
## 9.2 In A/Gb mode
Text will be added when FLO concepts for A/Gb mode have stabilized.
## 9.3 Transport and physical channel configuration
When setting up a new connection, Layer 3 indicates to the lower layers the
following parameters to configure the physical layer, the MAC sublayer and the
RLC sublayer:
\- The transport channel identity (TrCH Id) and transport format set for each
transport channel;
\- The transport format combination set (TFCS) through CTFC (see subclause
9.4) together with the modulation parameter (GMSK and 8PSK, or 8PSK only);
\- Semi-static parameters for the configuration of the basic physical
subchannel (see Table 3): channel mode (FR or HR), modulation (GMSK and/or
8PSK), interleaving (20ms rectangular, 40ms diagonal or 60ms diagonal) and
number of TrCHs.
To configure the transport format set, Layer 3 provides to the lower layers
the following parameters for each transport channel:
\- The semi-static attributes (see Table 4): CRC size (0, 6, 12, or 18 bits)
and the rate matching attribute (1 to 256). Semi-static attributes are common
to all transport formats for one transport channel;
\- For each transport format, the dynamic attributes (see Table 5): TB size (1
to 1370 bits).
In order to address inactive transport channels in TFC(s), the first transport
format of every TrCH is configured by default with the empty transport format.
These default transport formats need not be signalled.
Each Layer 3 message that can set up or reconfigure TrCH(s) has to provide the
mentioned information to the lower layers. When releasing a TrCH, only the
TrCH Ids are signalled.
Table 3: Basic physical subchannel parameters indicated by Layer 3
+--------------+------------------+------------------------------------------+ | Parameter | Range/Value | Comments | +--------------+------------------+------------------------------------------+ | Mode | FR or HR | Two channel modes | +--------------+------------------+------------------------------------------+ | Modulation | GMSK and/or 8PSK | Two modulation types | +--------------+------------------+------------------------------------------+ | Interleaving | 20ms rectangular | 60ms interleaving for 8PSK channels only | | | | | | | 40ms diagonal | | | | | | | | 60ms diagonal | | +--------------+------------------+------------------------------------------+
Table 4: Semi-static attributes indicated by Layer 3 for each TrCH
* * *
Parameter Range/Value Comments CRC size 0,6, 12 or 18 Four CRC sizes Rate
matching attribute 1...256 Same range as in UTRAN
* * *
Table 5: Dynamic attributes indicated by Layer 3 for each TF
* * *
Parameter Range/Value Comments TB size 1...1370 Maximum obtained with 8PSK FR
channel
* * *
The transport channels and the transport format combination set may be
configured independently in the uplink and the downlink. Also, if the MS is
configured to use multiple timeslots, the transport channels and the transport
format combination set may be configured independently for each timeslot.
In the transport format combination set, it shall be specified whether each
transport format combination can be used with both GMSK and 8PSK modulations
or with 8PSK modulation only. The modulation parameter is signalled in the
layer 3 message with the CTFC for each TFC. Only transport format combinations
that are allowed for the modulation configured for the DBPSCH may be active
within the TFCS. At handover certain TFCs may be automatically restricted
(implicitly), or they may be reconfigured by the network.
When configuring or reconfiguring the TFCS, Layer 3 can optionally include
transport format combination subset information to restrict the transport
format combinations within the TFCS that can be used. This information could
be in the form of a "minimum allowed transport format combination index", an
"allowed transport format combination list", a "non-allowed transport format
combination list" or other to be defined.
When reconfiguring the transport channels or the TFCS, an incremental
reconfiguration will be possible, i.e. it will be possible to signal only the
parameters of the transport channels or the TFCs that are added, modified or
deleted. After the reconfiguration, the configuration is still consistent. For
example, when releasing a transport channel, all the TFCs that use that
transport channel shall also be removed from the TFCS.
If the size of the TFCI needs to be changed when reconfiguring the TFCS of a
DBPSCH, that DBPSCH shall be ordered to a new DBPSCH. A new DBPSCH is a
DBPSCH, which is not currently allocated to the MS.
When releasing a connection, no specific FLO information is signalled by Layer
3.
## 9.4 Calculated Transport Format Combination
### 9.4.1 Definition
The CTFCs are used to signal the transport format combination set. Every
possible transport format combination is uniquely identified by one CTFC,
including transport format combinations, which are not members of the
transport format combination set.
Two formulas are used to define the CTFC (see 3GPP TS 25.331). Let _I_ be the
number of transport channels that are included in the transport format
combination. Each transport channel TrCH _~i~_ , _i_ = 1, 2,..., _I_ , has
_L~i~_ transport formats, i.e. the transport format indicator _TFIN~i~_ can
take _L~i~_ values, $\text{TFIN}_{i} \in \left{
0,1,2,\text{.}\text{.}\text{.},L_{i} - 1 \right}$. For each transport channel,
the transport format such that _TFIN~i~_ = 0 is the empty transport format.
_Define_ $P_{i} = \prod_{j = 0}^{i - 1}L_{j}$_, where i = 1, 2, ..., I, and
L~0~ = 1_
Let _TFC_(_TFIN~1~_ , _TFIN~2~_ , ..., _TFIN~I~)_ be the transport format
combination for which TrCH _~1~_ has transport format _TFIN~1~_ , TrCH~2~ has
transport format _TFIN~2~_ , etc. The corresponding _CTFC_(_TFIN~1~_ ,
_TFIN~2~_ , ..., _TFIN~I~_) is then computed as:
The transport format combination such that CTFC = 0 is the empty transport
format combination.
After computing the CTFC value for all allowed transport format combinations
(a CTFC is defined for all transport format combinations, but it is only
necessary to compute the CTFC for the allowed transport format combinations),
the CTFCs are signalled in order. The TFCIs are then assigned in the same
order, i.e. the first TFC signalled by its CTFC will correspond to TFCI = 0,
the next corresponds to TFCI = 1, etc.
In a Layer 3 signalling message, the CTFC values are encoded using a variable
size field, the size of which is the same for all values and depends on the
highest value to be signalled. The possible sizes are: 2 bits, 4 bits, 6 bits,
8 bits, 12 bits and 16 bits. The size of the fields is signalled in the Layer
3 message.
### 9.4.2 Example
In this section, CTFC is elaborated by an example: circuit switched AMR over
FLO. For the support of AMR, three transport channels need to be configured:
\- TrCH~1~ for class A bits and inband bits;
\- TrCH~2~ for class B bits;
\- TrCH~3~ for signalling.
Figure 15 below depicts the proposed TFCS for this AMR example.
{width="4.790277777777778in" height="3.4118055555555555in"}
Figure 15: TFCS Example.
Six TFCs are configured. The first TFC is used for signalling where 184 bits
are sent on TrCH~3~ only. Then the active codec set contains 4 AMR modes (12.2
kbit/s, 7.95 kbit/s, 5.90 kbit/s and 4.75 kbit/s) requiring 4 different TFCs.
Additionally one TFC is needed for SID_UPDATE and SID_FIRST where 41 bits are
sent on TrCH~1~ only. For each transport channel, the number of transport
format(s) required is therefore:
\- 5 transport formats for TrCH~1~ (0, 41, 57, 77, 83); _L~1~_ = 5
\- 5 transport formats for TrCH~2~ (0, 56, 63, 84, 163); _L~2~_ = 5
\- 2 transport formats for TrCH~3~ (0, 184); _L~3~_ = 2
The _P~i~_ values can then be calculated for each transport format:
\- _P~1~_ = _L~0~_ = 1;
\- _P~2~_ = _L~0~_ × _L~1~_ = 1 × 5 = 5;
\- _P~3~_ = _L~0~_ × _L~1~_ × _L~2~_ = 1 × 5 × 5 = 25.
And for the CTFCs the values are:
\- _CTFC_(0, 0, 1) = (0×1) + (0×5) + (1×25) = 25. -- TFC~1~ for Signalling
\- _CTFC_(1, 0, 0) = (1×1) + (0×5) + (0×25) = 1; -- TFC~2~ for SID_UPDATE and
SID_FIRST
\- _CTFC_(1, 1, 0) = (1×1) + (1×5) + (0×25) = 6; -- TFC~3~ for AMR 4.75 kbit/s
\- _CTFC_(2, 2, 0) = (2×1) + (2×5) + (0×25) = 12; -- TFC~4~ for AMR 5.90
kbit/s
\- _CTFC_(3, 3, 0) = (3×1) + (3×5) + (0×25) = 18; -- TFC~5~ for AMR 7.95
kbit/s
\- _CTFC_(4, 4, 0) = (4×1) + (4×5) + (0×25) = 24; -- TFC~6~ for AMR 12.2
kbit/s
## 9.5 TFC for Signalling
Reliable transport of signalling messages (control plane messages and RLC/MAC
control messages) must be available throughout the radio access network and
even in adverse channel conditions. That is the reason why the protection of
signalling has been traditionally strong in GSM: CS1 coding has been used
always for consistent performance in every cell, in every network (see 3GPP TS
45.003). With the flexibility offered by FLO, arises the possibility of
changing the protection for signalling. It also becomes possible to multiplex
signalling with other radio bearers. While this kind of flexibility is desired
for the user plane, it should be avoided for the control plane as it might
lead to inconsistent performance throughout the network (e.g. handover
commands not available in some areas). For consistent performance, the
configuration of the signalling shall be fixed. The first TFC, for which the
TFCI=0, shall be used for sending signalling messages and in that TFC only the
transport channel carrying the transport blocks of the signalling is active
with the following transport format:
\- 184 bits transport blocks;
\- 18 bits CRC;
\- 256 for the RMA.
NOTE: the value of the RMA does not matter since there is only one active
TrCH.
This is depicted for instance on Figure 15 where TFC number 1 is reserved for
the transport channel carrying signalling.
## 9.6 TBF configuration
When setting up a new TBF or reconfiguring an existing TBF, Layer 3 provides
the following parameters to configure the MAC sublayer:
\- for each TBF, the transport channel(s) and associated transport format set
on to which the TBF is mapped (by means of the TrCH Id).
NOTE: As all the TBFs are mapped also to the transport channel used for
signalling information, this does not need to be signalled.
# 10 Testing of FLO
Since FLO has several degrees of freedom when configuring transport channels,
a complete test of every single possible configuration is not feasible.
However similarly as in GSM/EDGE, testing of the implementation can be done
through validation of performance requirements, as implementation errors
directly translate into loss in terms of performance. That is, for instance an
incorrect implementation of interleaving would mean poor performance. Testing
of FLO shall therefore be done using a set of predefined radio bearers in
conjunction with performance requirements. A correct implementation of FLO
will fulfil the performance requirements of the predefined radio bearers. In
other words, when performance requirements of the predefined radio bearers are
met, it validates the implementation of FLO and ensures that it can support
any possible configuration that fits within the limitations of section 6.4.
# 11 Impact on Specifications
The affected specifications by the introduction of FLO are:
\- 3GPP TS 43.051: "GSM/EDGE Radio Access Network (GERAN) overall description;
Stage 2".
\- 3GPP TS 44.004: "Layer 1 - General Requirements".
\- 3GPP TS 44.018: "Radio Resource Control protocol".
\- 3GPP TS 44.118: "Radio Resource Control protocol, Iu mode" [11].
\- 3GPP TS 44.060: "Radio Link Control/Medium Access Control protocol".
\- 3GPP TS 44.160: "Radio Link Control/Medium Access Control protocol, Iu
mode" [13].
\- 3GPP TS 45.001, "Physical Layer on the Radio Path (General Description)".
\- 3GPP TS 45.002: "Multiplexing and multiple access on the radio path".
\- 3GPP TS 45.003: "Channel coding".
\- 3GPP TS 45.005, "Radio transmission and reception".
\- 3GPP TS 45.008, "Radio subsystem link control".
\- 3GPP TS 51.010, "Mobile Station (MS) conformance specification"
\- 3GPP TS 51.021, "GSM radio aspects base station system equipment
specification".
###### ## Annex A (informative): Block Codes for the TFCI
Table A.1: Coding 5/36
* * *
TFCI Coded TFCI 0,0,0,0,0
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
0,0,0,0,1
1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0
0,0,0,1,0
1,1,1,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,0,1,1,0,0,1
0,0,0,1,1
1,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,0,1,1,0,0
0,0,1,0,0
1,1,0,1,1,0,0,0,1,1,1,1,0,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1
0,0,1,0,1
1,1,0,1,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,0,1,0,0,1,0
0,0,1,1,0
1,1,0,0,1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1
0,0,1,1,1
1,1,0,0,0,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,0,1,1,0,1,0,0
0,1,0,0,0
1,0,1,1,1,0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0
0,1,0,0,1
1,0,1,1,0,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1
0,1,0,1,0
1,0,1,0,1,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,1,1,0,0,1,1,1,0,0,1,1,0
0,1,0,1,1
1,0,1,0,0,1,1,0,0,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,0,1,1,0,0,0,1,1,0,0,1,1
0,1,1,0,0
1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0
0,1,1,0,1
1,0,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,1,1,0,1
0,1,1,1,0
1,0,0,0,1,0,1,1,1,1,0,0,1,0,1,1,0,0,0,0,1,0,1,1,0,0,0,0,1,0,0,1,1,1,1,0
0,1,1,1,1
1,0,0,0,0,0,0,1,0,1,1,0,0,0,0,1,1,0,1,0,0,0,0,1,1,0,1,0,0,1,0,0,1,0,1,1
1,0,0,0,0
0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1
1,0,0,0,1
0,1,1,1,0,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
1,0,0,1,0
0,1,1,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1
1,0,0,1,1
0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,1,0,0,1,1,0,0
1,0,1,0,0
0,1,0,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,0,0,0,0,0,0,0,1,1,1
1,0,1,0,1
0,1,0,1,0,1,0,1,1,0,1,0,0,1,1,0,1,0,0,1,0,0,0,1,0,1,1,0,1,1,0,1,0,0,1,0
1,0,1,1,0
0,1,0,0,1,0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,1,1,1,1,0,1,1,0,0,0,0,1
1,0,1,1,1
0,1,0,0,0,0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,0,1,1,0,1,0,0
1,1,0,0,0
0,0,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,1,0,0,1
0,0,1,1,0,1,0,1,0,1,0,1,1,0,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,1,0,1,0,1,0,1
1,1,0,1,0
0,0,1,0,1,0,1,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,1,1,0,1,1,0,0,1,1,0
1,1,0,1,1
0,0,1,0,0,0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,1,0,0,1,1
1,1,1,0,0
0,0,0,1,1,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,0
1,1,1,0,1
0,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,1,0,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,1,0,1
1,1,1,1,0
0,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0,0,1,1,1,1,0
1,1,1,1,1
0,0,0,0,0,1,1,0,1,0,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,1,0,0,1,0,1,1
* * *
Table A.2: Coding 4/28
* * *
TFCI Coded TFCI 0,0,0,0
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 0,0,0,1
1,1,1,1,1,0,1,0,0,1,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0 0,0,1,0
1,1,1,0,0,1,0,1,0,0,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1,1,0,0 0,0,1,1
1,1,1,0,0,0,0,0,1,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1 0,1,0,0
1,0,0,1,1,1,0,1,1,0,0,0,1,0,0,1,0,0,1,1,0,0,1,1,0,0,1,1 0,1,0,1
1,0,0,1,0,0,1,1,0,0,1,0,0,1,1,1,0,0,1,1,0,0,0,0,1,1,0,0 0,1,1,0
1,0,0,0,1,0,0,0,1,1,1,1,0,1,0,1,0,0,0,0,1,1,1,1,0,0,0,0 0,1,1,1
1,0,0,0,0,1,1,0,0,1,0,1,1,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1 1,0,0,0
0,1,0,1,1,1,0,0,0,0,0,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0 1,0,0,1
0,1,0,1,0,0,1,0,1,0,1,1,1,0,0,0,1,0,1,0,1,0,0,1,0,1,0,1 1,0,1,0
0,1,0,0,1,0,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,0,1,0,0,1 1,0,1,1
0,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,1,0,0,1,0,1,0,1,0,1,1,0 1,1,0,0
0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0,1,1,0,0,1,1,0,0,1,1,0 1,1,0,1
0,0,1,1,0,0,0,1,0,1,0,1,1,1,0,0,0,1,1,0,0,1,0,1,1,0,0,1 1,1,1,0
0,0,1,0,1,1,1,0,0,0,1,0,1,1,0,0,0,1,0,1,1,0,1,0,0,1,0,1 1,1,1,1
0,0,1,0,1,0,1,1,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0
* * *
Table A.3: Coding 3/24
* * *
TFCI Coded TFCI 0,0,0 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 0,0,1
1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1 0,1,0
1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,0,0 0,1,1
1,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0 1,0,0
0,1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0 1,0,1
0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,0,1,0,1,0 1,1,0
0,0,1,1,0,0,1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,0,0,1 1,1,1
0,0,1,0,1,1,0,0,0,1,0,1,1,0,0,0,1,0,1,1,0,0,0,1
* * *
Table A.4: Coding 2/16
* * *
TFCI Coded TFCI 0,0 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 0,1
1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1 1,0 0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0 1,1
0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0
* * *
Table A.5: Coding 1/8
* * *
TFCI Coded TFCI 0 1,1,1,1,1,1,1,1 1 0,0,0,0,0,0,0,0
* * *
###### ## Annex B (informative): Header fields
## B.1 Payload Type (PT) field
The Payload Type (PT) field indicates the type of data contained in the
remainder of the RLC/MAC block. It is encoded as shown below.
Table B.1: Payload Type (PT) field
* * *
Bit PT: Payload Type 0 RLC Data Block 1 RLC/MAC Control block
* * *
## B.2 Polling (P) bit
The Polling (P) bit indicates whether or not the transmitter is polling for
acknowledgement. When included in an RLC/MAC block for data transfer, it also
allows the reporting of link quality measurements. It is encoded as shown
below.
Table B.2: Polling (P) bit
* * *
Bit P: Polling bit 0 No polling 1 Polling required
* * *
## B.3 Segmentation (S) bit
The segmentation (S) bit indicates whether or not the RLC/MAC control block is
a segment of an RLC/MAC control message. It is encoded as shown below.
Table B.3: Segmentation (S) bit
* * *
Bit S: Segmentation bit 0 The RLC/MAC control block contains an entire RLC/MAC
control message 1 The RLC/MAC control block contains a segment of an RLC/MAC
control message
* * *
## B.4 Reduced Block Sequence Number (RBSN) bit
The Reduced Block Sequence Number (RBSN) bit carries the sequence number of
the RLC/MAC control blocks. The RBSN bit is encoded as a binary number with
range 0 to 1. The RBSN bit is included if and only if the S bit is set.
## B.5 Radio Transaction Identifier (RTI) field
The Radio Transaction Identifier (RTI) field is used to group the RLC/MAC
control blocks that make up an RLC/MAC control message and identifies the
segmented control message sequence with which the RLC/MAC control block is
associated. The RTI field is 2 bits in length with range 0 to 3. The RTI field
is present if and only if the S bit is set.
## B.6 Temporary Flow Identity (TFI) field
The Temporary Flow Identity (TFI) field identifies the Temporary Block Flow
(TBF) to which the RLC data block belongs. It is 5 bits in length and encoded
as a binary number with range 0 to 31. The TFI shall equal the Radio Bearer
identity (RB Id) of the radio bearer to which the RLC data block belongs.
## B.7 Block Sequence Number (BSN) field
### B.7.1 General
The Block Sequence Number (BSN) field carries the sequence absolute Block
Sequence Number (BSN\') modulo Sequence Number Space (SNS) of each RLC data
block within the TBF.
### B.7.2 RLC unacknowledged mode
The BSN size is 4 bits, covering a SNS of 16.
### B.7.3 RLC acknowledged mode
The BSN size is 8 bits, covering a SNS of 256.
## B.8 Split Block Indicator (SPB) field
The Split Block indicator (SPB) field is used to indicate whether a data block
that is retransmitted has been resegmented (e.g. due to switch from 8-PSK to
GMSK modulation). It allows for splitting RLC data over two radio blocks.
Whether it is needed to consider finer segmentation is FFS. It is encoded as
shown below.
Table B.4: Split Block Indicator (SPB) field
+-----+-------------------------------------------+ | Bit | SPB: Split Block Indicator field | | | | | 2 1 | | +-----+-------------------------------------------+ | 0 0 | No retransmission | +-----+-------------------------------------------+ | 0 1 | Reserved | +-----+-------------------------------------------+ | 1 0 | Retransmission (first part of the block) | +-----+-------------------------------------------+ | 1 1 | Retransmission (second part of the block) | +-----+-------------------------------------------+
## B.9 Stall Indicator (SI) field
The Stall Indicator (SI) field indicates whether the mobile station\'s RLC
transmit window is stalled or not. It is encoded as shown below.
Table B.5: Stall Indicator (SI) field
* * *
Bit SI: Stall Indicator field 0 MS RLC Transmit window is not stalled 1 MS RLC
Transmit window is stalled
* * *
## B.10 Extension (E) bit
The Extension (E) bit indicates the presence of an optional octet in the RLC
data block header. It is encoded as shown below.
Table B.6: Extension (E) bit
* * *
Bit E: Extension bit 0 Extension octet follows immediately 1 No extension
octet follows
* * *
## B.11 Length Indicator (LI) field
The Length Indicator is used to delimit upper layer PDUs within the RLC data
block. It is defined as the LI field in EGPRS TBF mode.
#