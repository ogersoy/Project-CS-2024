# Foreword
This Technical Specification (TS) has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes multiplexing, channel coding and interleaving
for UTRA Physical Layer TDD mode.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TS 25.202: \"UE capabilities\".
[2] 3GPP TS 25.211: \"Transport channels and physical channels (FDD)\".
[3] 3GPP TS 25.212: \"Multiplexing and channel coding (FDD)\".
[4] 3GPP TS 25.213: \"Spreading and modulation (FDD)\".
[5] 3GPP TS 25.214: \"Physical layer procedures (FDD)\".
[6] 3GPP TS 25.215: \"Physical layer -- Measurements (FDD)\".
[7] 3GPP TS 25.221: \"Transport channels and physical channels (TDD)\".
[9] 3GPP TS 25.223: \"Spreading and modulation (TDD)\".
[10] 3GPP TS 25.224: \"Physical layer procedures (TDD)\".
[11] 3GPP TS 25.225: \"Measurements\".
[12] 3GPP TS 25.331: \"RRC Protocol Specification\".
[13] 3GPP TS 25.308: \"High Speed Downlink Packet Access (HSDPA): Overall
description (stage 2)\".
[14] ITU-T Recommendation X.691 (12/97) \"Information technology - ASN.1
encoding rules: Specification of Packed Encoding Rules (PER)\".
[15] 3GPP TS 25.321: "Medium Access Control (MAC) protocol specification"
[16] 3GPP TS 25.302: "Services provided by the physical layer"
[17] 3GPP TS 25.306: "UE Radio Access Capabilities"
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
apply.
**TrCH number:** The transport channel number identifies a TrCH in the context
of L1. The L3 transport channel identity (TrCH ID) maps onto the L1 transport
channel number. The mapping between the transport channel number and the TrCH
ID is as follows: TrCH 1 corresponds to the TrCH with the lowest TrCH ID, TrCH
2 corresponds to the TrCH with the next lowest TrCH ID and so on.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
_x_ round towards _∞_ , i.e. integer such that _x ≤ x \  \
ARQ Automatic Repeat on Request
BCH Broadcast Channel
BER Bit Error Rate
BS Base Station
BSS Base Station Subsystem
CBR Constant Bit Rate
CCCH Common Control Channel
CCTrCH Coded Composite Transport Channel
CDMA Code Division Multiple Access
CFN Connection Frame Number
CQI Channel Quality Indicator
CRC Cyclic Redundancy Check
DCA Dynamic Channel Allocation
DCCH Dedicated Control Channel
DCH Dedicated Channel
DL Downlink
DRX Discontinuous Reception
DSCH Downlink Shared Channel
DTX Discontinuous Transmission
E-AGCH E-DCH Absolute Grant Channel
ECSN E-AGCH Cyclic Sequence Number
E-DCH Enhanced Dedicated Channel
E-HICH E-DCH Hybrid ARQ Indicator Channel
E-PUCH E-DCH Physical Uplink Channel
E-RUCCH E-DCH Random Access Uplink Control Channel
E-TFCI E-DCH Transport Format Combination Indicator
E-UCCH E-DCH Uplink Control Channel
FACH Forward Access Channel
FDD Frequency Division Duplex
FDMA Frequency Division Multiple Access
FEC Forward Error Control
FER Frame Error Rate
GF Galois Field
HARQ Hybrid Automatic Repeat reQuest
HS-DSCH High Speed Downlink Shared Channel
HS-PDSCH High Speed Physical Downlink Shared Channel
HS-SCCH Shared Control Channel for HS-DSCH
HS-SICH Shared Information Channel for HS-DSCH
IMB Integrated Mobile Broadcast
JD Joint Detection
L1 Layer 1
L2 Layer 2
LLC Logical Link Control
MA Multiple Access
MAC Medium Access Control
MBSFN MBMS over a Single Frequency Network
MICH MBMS Indicator Channel
MIMO single user Multiple Input Multiple Output
MS Mobile Station
MT Mobile Terminated
> MU-MIMO Multi-User Multiple Input Multiple Output
NRT Non-Real Time
OVSF Orthogonal Variable Spreading Factor
PC Power Control
PCCC Parallel Concatenated Convolutional Code
PICH Paging Indicator Channel
PCH Paging Channel
PhCH Physical Channel
PI Paging Indicator (value calculated by higher layers)
PLCCH Physical Layer Common Control Channel
P~q~ Paging Indicator (indicator set by physical layer)
QoS Quality of Service
QPSK Quaternary Phase Shift Keying
RACH Random Access Channel
RF Radio Frequency
RLC Radio Link Control
RMF Recommended Modulation Format
RRC Radio Resource Control
RRM Radio Resource Management
RSC Recursive Systematic Convolutional Coder
RSN Retransmission Sequence Number
RT Real Time
RTBS Recommended Transport Block Size
RU Resource Unit
RV Redundancy Version
SCCC Serial Concatenated Convolutional Code
SCH Synchronization Channel
SNR Signal to Noise Ratio
TCH Traffic channel
TDD Time Division Duplex
TDMA Time Division Multiple Access
TFC Transport Format Combination
TFCI Transport Format Combination Indicator
TFRI Transport Format Resource Indicator
TPC Transmit Power Control
TrBk Transport Block
TrCH Transport Channel
TTI Transmission Time Interval
UE User Equipment
UL Uplink
UMTS Universal Mobile Telecommunications System
USCH Uplink Shared Channel
UTRA UMTS Terrestrial Radio Access
VBR Variable Bit Rate
# 4 Multiplexing, channel coding and interleaving for the 1.28 Mcps, 3.84 Mcps
and 7.68 Mcps options
In the case of the 3.84 Mcps option, clause 4 applies only for non-MBSFN-IMB
operation. Multiplexing, channel coding and interleaving for 3.84 Mcps MBSFN
IMB operation is described in sub-clause 5.
## 4.1 General
Data stream from/to MAC and higher layers (Transport block / Transport block
set) is encoded/decoded to offer transport services over the radio
transmission link. Channel coding scheme is a combination of error detection,
error correcting (including rate matching), and interleaving and transport
channels mapping onto/splitting from physical channels.
In the UTRA-TDD mode for the 1.28 Mcps, 3.84 Mcps and 7.68 Mcps options, the
total number of basic physical channels (a certain time slot one spreading
code on a certain carrier frequency) per frame is given by the maximum number
of time slots and the maximum number of CDMA codes per time slot.
## 4.2 General coding/multiplexing of TrCHs
This section only applies to the transport channels: DCH, RACH, DSCH, USCH,
BCH, FACH and PCH. Other transport channels which do not use the general
method are described separately below.
Figure 1 illustrates the overall concept of transport-channel coding and
multiplexing. Data arrives to the coding/multiplexing unit in form of
transport block sets, once every transmission time interval. The transmission
time interval is transport-channel specific from the set {5 ms^(*1)^, 10 ms,
20 ms, 40 ms, 80 ms}.
Note: ^(*1)^ may be applied for PRACH for 1.28 Mcps TDD
The following coding/multiplexing steps can be identified:
\- add CRC to each transport block (see subclause 4.2.1);
\- TrBk concatenation / Code block segmentation (see subclause 4.2.2);
\- channel coding (see subclause 4.2.3) ;
\- radio frame size equalization (see subclause 4.2.4);
\- interleaving (two steps, see subclauses 4.2.5 and 4.2.11 );
\- radio frame segmentation (see subclause 4.2.6);
\- rate matching (see subclause 4.2.7);
\- multiplexing of transport channels (see subclause 4.2.8);
\- bit scrambling (see subclause 4.2.9);
\- physical channel segmentation (see subclause 4.2.10);
\- sub-frame segmentation(see subclause 4.2.11A only for 1.28Mcps TDD)
\- mapping to physical channels (see subclause 4.2.12).
The coding/multiplexing steps for uplink and downlink are shown in figures 1
and 1A.
Figure 1: Transport channel multiplexing structure for uplink and downlink for
3.84Mcps and 7.68 Mcps TDD
Figure 1A: Transport channel multiplexing structure for uplink and downlink of
1.28Mcps TDD
Primarily, transport channels are multiplexed as described above, i.e. into
one data stream mapped on one or several physical channels. However, an
alternative way of multiplexing services is to use multiple CCTrCHs (Coded
Composite Transport Channels), which corresponds to having several parallel
multiplexing chains as in figures 1 and 1A, resulting in several data streams,
each mapped to one or several physical channels.
### 4.2.1 CRC attachment
Error detection is provided on transport blocks through a Cyclic Redundancy
Check (CRC). The size of the CRC is 24, 16, 12, 8 or 0 bits and it is
signalled from higher layers what CRC size that should be used for each
transport channel.
#### 4.2.1.1 CRC calculation
The entire transport block is used to calculate the CRC parity bits for each
transport block. The parity bits are generated by one of the following cyclic
generator polynomials:
g~CRC24~(_D_) = _D_ ^24^ + _D_ ^23^ + _D_ ^6^ + _D_ ^5^ + _D_ \+ 1
g~CRC16~(_D_) = _D_ ^16^ + _D_ ^12^ + _D_ ^5^ + 1
g~CRC12~(_D_) = _D_ ^12^ + _D_ ^11^ + _D_ ^3^ + _D_ ^2^ + _D_ \+ 1
g~CRC8~(_D_) = _D_ ^8^ + _D_ ^7^ + _D_ ^4^ + _D_ ^3^ + _D_ \+ 1
Denote the bits in a transport block delivered to layer 1 by
{width="1.5138888888888888in" height="0.2638888888888889in"}, and the parity
bits by {width="1.5138888888888888in" height="0.2638888888888889in"}. _A~i~_
is the size of a transport block of TrCH _i, m_ is the transport block number,
and _L~i~_ is the number of parity bits. _L~i~_ can take the values 24, 16,
12, 8, or 0 depending on what is signalled from higher layers.
The encoding is performed in a systematic form, which means that in GF(2), the
polynomial:
{width="5.375in" height="0.2777777777777778in"}
yields a remainder equal to 0 when divided by g~CRC24~(_D_), polynomial:
{width="5.166666666666667in" height="0.2777777777777778in"}
yields a remainder equal to 0 when divided by g~CRC16~(_D_), polynomial:
{width="5.277777777777778in" height="0.2777777777777778in"}
yields a remainder equal to 0 when divided by g~CRC12~(_D_) and the
polynomial:
{width="4.888888888888889in" height="0.2777777777777778in"}
yields a remainder equal to 0 when divided by g~CRC8~(_D_).
If no transport blocks are input to the CRC calculation (_M~i\ ~_ = 0), no CRC
attachment shall be done. If transport blocks are input to the CRC calculation
(_M~i\ ~_ ≠ 0) and the size of a transport block is zero (_A~i\ ~_ = 0), CRC
shall be attached, i.e. all parity bits equal to zero.
#### 4.2.1.2 Relation between input and output of the CRC attachment block
The bits after CRC attachment are denoted by {width="1.3888888888888888in"
height="0.2638888888888889in"}, where _B~i~_ = _A~i~_ \+ _L~i~_. The relation
between _a~imk~_ and _b~imk~_ is:
{width="0.6805555555555556in" height="0.25in"} _k_ = 1, 2, 3, ..., _A~i~_
{width="1.3055555555555556in" height="0.2638888888888889in"} _k_ = _A~i~_ \+
1, _A~i~_ \+ 2, _A~i~_ \+ 3, ..., _A~i~_ \+ _L~i~_
### 4.2.2 Transport block concatenation and code block segmentation
All transport blocks in a TTI are serially concatenated. If the number of bits
in a TTI is larger than the maximum size of a code block, then code block
segmentation is performed after the concatenation of the transport blocks. The
maximum size of the code blocks depends on whether convolutional, turbo coding
or no coding is used for the TrCH.
#### 4.2.2.1 Concatenation of transport blocks
The bits input to the transport block concatenation are denoted by
{width="1.3888888888888888in" height="0.2638888888888889in"} where _i_ is the
TrCH number, _m_ is the transport block number, and _B~i~_ is the number of
bits in each block (including CRC). The number of transport blocks on TrCH _i_
is denoted by _M~i~_. The bits after concatenation are denoted by
{width="1.1666666666666667in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _X~i~=M~i~B~i~_. They are defined by the following relations:
{width="0.5965277777777778in" height="0.25in"} _k =_ 1, 2 _, ..., B~i~_
{width="0.9166666666666666in" height="0.2638888888888889in"} _k = B~i~_ _+_ 1
_, B~i~_ _+_ 2 _, ...,_ 2 _B~i~_
{width="0.9583333333333334in" height="0.2638888888888889in"} _k =_ 2 _B~i~_
_+_ 1, 2 _B~i~_ _+_ 2 _, ...,_ 3 _B~i~_
{width="0.19375in" height="9.652777777777778e-2in"}
{width="1.3194444444444444in" height="0.2638888888888889in"} _k =_ (_M~i~_ \--
1)_B~i~_ _+_ 1 _,_ (_M~i~_ \-- 1)_B~i~_ _+_ 2 _, ..., M~i~B~i~_
#### 4.2.2.2 Code block segmentation
Segmentation of the bit sequence from transport block concatenation is
performed if _X~i~ >Z_. The code blocks after segmentation are of the same
size. The number of code blocks on TrCH _i_ is denoted by _C~i~_. If the
number of bits input to the segmentation, _X~i~_ , is not a multiple of _C~i~_
, filler bits are added to the beginning of the first block. If turbo coding
is selected and _X~i~_ \ _K_ Number of bits input to Turbo code internal interleaver
>
> _R_ Number of rows of rectangular matrix
>
> _C_ Number of columns of rectangular matrix
>
> _p_ Prime number
>
> _v_ Primitive root
>
> {width="0.9722222222222222in" height="0.2638888888888889in"} Base sequence
> for intra-row permutation
>
> _q~i~_ Minimum prime integers
>
> _r~i~_ Permuted prime integers
>
> {width="0.9722222222222222in" height="0.3055555555555556in"} Inter-row
> permutation pattern
>
> {width="1.0694444444444444in" height="0.3333333333333333in"} Intra-row
> permutation pattern of _i_ -th row
>
> _i_ Index of row number of rectangular matrix
>
> _j_ Index of column number of rectangular matrix
>
> _k_ Index of bit sequence
###### 4.2.3.2.3.1 Bits-input to rectangular matrix with padding
The bit sequence {width="1.0416666666666667in" height="0.25in"} input to the
Turbo code internal interleaver is written into the rectangular matrix as
follows.
(1) Determine the number of rows of the rectangular matrix, _R_ , such that:
{width="2.888888888888889in" height="0.6666666666666666in"}.
The rows of rectangular matrix are numbered 0, 1, ..., _R_ \- 1 from top to
bottom.
(2) Determine the prime number to be used in the intra-permutation, _p_ , and
the number of columns of rectangular matrix, _C_ , such that:
if (481 {width="0.1388888888888889in" height="0.16666666666666666in"} _K_
{width="0.1388888888888889in" height="0.16666666666666666in"} 530) then
_p = 53_ and _C_ = _p_.
else
Find minimum prime number _p_ from table 2 such that
{width="0.875in" height="0.20833333333333334in"},
and determine _C_ such that
{width="2.3194444444444446in" height="0.6527777777777778in"}.
end if
The columns of rectangular matrix are numbered 0, 1, ..., _C_ \- 1 from left
to right.
Table 2: List of prime number _p_ and associated primitive root _v_
* * *
_p_ _v_ _p_ _v_ _p_ _v_ _p_ _v_ _p_ _v_ 7 3 47 5 101 2 157 5 223 3 11 2 53 2
103 5 163 2 227 2 13 2 59 2 107 2 167 5 229 6 17 3 61 2 109 6 173 2 233 3 19 2
67 2 113 3 179 2 239 7 23 5 71 7 127 3 181 2 241 7 29 2 73 5 131 2 191 19 251
6 31 3 79 3 137 3 193 5 257 3 37 2 83 2 139 2 197 2  
41 6 89 3 149 2 199 3  
43 3 97 5 151 6 211 2
* * *
(3) Write the input bit sequence {width="1.0416666666666667in"
height="0.25in"} into the _R_ {width="0.125in"
height="0.1388888888888889in"}_C_ rectangular matrix row by row starting with
bit _y_ ~1~ in column 0 of row 0:
{width="2.7222222222222223in" height="0.875in"}.
> where _y_ ~k~ = _x_ ~k~ for _k_ = 1, 2, ..., _K_ and if _R_{width="0.125in"
> height="0.1388888888888889in"}_C_{width="0.125in" height="0.125in"}_K_ , the
> dummy bits are padded such that {width="0.6111111111111112in"
> height="0.20833333333333334in"} for _k_ = _K_ \+ 1, _K_ \+ 2, ...,
> _R_{width="0.125in" height="0.1388888888888889in"}_C_. These dummy bits are
> pruned away from the output of the rectangular matrix after intra-row and
> inter-row permutations.
##### 4.2.3.2.3.2 Intra-row and inter-row permutations {#intra-row-and-inter-
row-permutations .H6}
After the bits-input to the _R_{width="0.125in"
height="0.1388888888888889in"}_C_ rectangular matrix, the intra-row and inter-
row permutations for the _R_{width="0.125in" height="0.1388888888888889in"}_C_
rectangular matrix are performed stepwise by using the following algorithm
with steps (1) -- (6).
(1) Select a primitive root _v_ from table 2 in section 4.2.3.2.3.1, which is
indicated on the right side of the prime number _p_.
(2) Construct the base sequence {width="0.9722222222222222in"
height="0.2638888888888889in"} for intra-row permutation as:
{width="1.4583333333333333in" height="0.20833333333333334in"}, _j_ = 1, 2,...
(_p_ \- 2), and _s_(0) = 1.
(3) Assign _q_ ~0~ = 1 to be the first prime integer in the sequence
{width="0.8333333333333334in" height="0.2638888888888889in"}, and determine
the prime integer _q~i~_ in the sequence {width="0.8333333333333334in"
height="0.2638888888888889in"} to be a least prime integer such that
g.c.d(_q~i~_ , _p_ \- 1) = 1, _q~i~_ > 6, and _q~i~_ > _q_ ~(_i_ \ -\ 1)~ for
each _i_ = 1, 2, ..., _R_ \-- 1. Here g.c.d. is greatest common divisor.
(4) Permute the sequence {width="0.8333333333333334in"
height="0.2638888888888889in"} to make the sequence
{width="0.8055555555555556in" height="0.2638888888888889in"} such that
_r~T~_ ~(_i_)~ = _q~i~_ , _i_ = 0, 1, .... , _R_ \- 1,
> where {width="0.9722222222222222in" height="0.3055555555555556in"} is the
> inter-row permutation pattern defined as the one of the four kind of
> patterns, which are shown in table 3, depending on the number of input bits
> _K_.
Table 3: Inter-row permutation patterns for Turbo code internal interleaver
+-----------------------+--------------------+-----------------------+ | Number of input bits | Number of rows _R_ | Inter-row permutation | | | | patterns | | _K_ | | | | | | \ | +-----------------------+--------------------+-----------------------+ | (40{width="0.125in" | | | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.152 | | | | 7777777777778in"}159) | | | +-----------------------+--------------------+-----------------------+ | (160{width="0.125in" | | 3, 2, 1, 0> | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.152 | | | | 7777777777778in"}200) | | | | or | | | | (481{width="0.125in" | | | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.152 | | | | 7777777777778in"}530) | | | +-----------------------+--------------------+-----------------------+ | ( | 20 | \ | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.1527 | | | | 777777777778in"}2480) | | | | or | | | | ( | | | | 3161{width="0.125in" | | | | height=" | | | | 0.1527777777777778in" | | | | }_K_{width="0.125in" | | | | height="0.1527 | | | | 777777777778in"}3210) | | | +-----------------------+--------------------+-----------------------+ | _K_ = any other value | 20 | \ | +-----------------------+--------------------+-----------------------+
(5) Perform the _i_ -th (_i_ = 0,1, ..., _R_ \- 1) intra-row permutation as:
if (_C_ = _p_) then
{width="1.6388888888888888in" height="0.20833333333333334in"}, _j_ = 0, 1,
..., (_p_ \- 2), and _U~i~_(_p_ \- 1) = 0,
where _U~i~(j)_ is the original bit position of _j-_ th permuted bit of _i_
-th row.
end if
if (C = _p_ \+ 1) then
{width="1.6388888888888888in" height="0.20833333333333334in"}, _j_ = 0, 1,
..., (_p_ \- 2). _U~i~_(_p_ \- 1) = 0, and _U~i~_(_p_) = _p_ ,
where _U~i~_(_j_) is the original bit position of _j_ -th permuted bit of _i_
-th row, and
if (_K_ _=R_{width="0.125in" height="0.1388888888888889in"}_C_) then
Exhange _U~R-1~_(_p_) with _U~R-1~_(_0_).
end if
end if
if (_C_ _=_ _p_ _-_ 1) then
{width="1.8194444444444444in" height="0.20833333333333334in"}, _j_ =0, 1, ...,
(_p_ \- 2),
where _U~i~(j)_ is the original bit position of _j_ -th permuted bit of _i_
-th row.
end if
(6) Perform the inter-row permutation for the rectangular matrix based on the
pattern {width="0.9722222222222222in" height="0.3055555555555556in"},
where _T_(_i_) is the original row position of the _i_ -th permuted row.
##### 4.2.3.2.3.3 Bits-output from rectangular matrix with pruning {#bits-
output-from-rectangular-matrix-with-pruning .H6}
After intra-row and inter-row permutations, the bits of the permuted
rectangular matrix are denoted by _y_ \'_~k~_ :
{width="2.3194444444444446in" height="0.875in"}
The output of the Turbo code internal interleaver is the bit sequence read out
column by column from the intra-row and inter-row permuted _R_
{width="0.125in" height="0.125in"} _C_ rectangular matrix starting with bit
_y_ \'~1~ in row 0 of column 0 and ending with bit _y_ \'_~CR~_ in row _R_ \-
1 of column _C_ \- 1. The output is pruned by deleting dummy bits that were
padded to the input of the rectangular matrix before intra-row and inter row
permutations, i.e. bits _y_ \'_~k~_ that corresponds to bits _y~k~_ with _k >
K_ are removed from the output. The bits output from Turbo code internal
interleaver are denoted by _x_ \'~1~, _x_ \'~2~, ..., _x_ \'_~K~_ , where _x_
\'~1~ corresponds to the bit _y_ \'_~k~_ with smallest index _k_ after
pruning, _x_ \'~2~ to the bit _y_ \'_~k~_ with second smallest index _k_ after
pruning, and so on. The number of bits output from Turbo code internal
interleaver is _K_ and the total number of pruned bits is:
_R_{width="0.125in" height="0.1388888888888889in"}_C -- K_.
#### 4.2.3.3 Concatenation of encoded blocks
After the channel coding for each code block, if _C~i~_ is greater than 1, the
encoded blocks are serially concatenated so that the block with lowest index
_r_ is output first from the channel coding block, otherwise the encoded block
is output from channel coding block as it is. The bits output are denoted by
{width="1.125in" height="0.2638888888888889in"}, where _i_ is the TrCH number
and _E~i~_ = _C~i~Y~i~_. The output bits are defined by the following
relations:
{width="0.625in" height="0.25in"} _k =_ 1, 2 _, ..., Y~i~_
{width="0.9166666666666666in" height="0.2638888888888889in"} _k = Y~i~_ _+_ 1
_, Y~i~_ _+_ 2 _, ...,_ 2 _Y~i~_
{width="0.9722222222222222in" height="0.2638888888888889in"} _k =_ 2 _Y~i~_
_+_ 1, 2 _Y~i~_ _+_ 2 _, ...,_ 3 _Y~i~_
{width="0.19375in" height="9.652777777777778e-2in"}
{width="1.2361111111111112in" height="0.2638888888888889in"} _k =_ (_C~i~_ \-
1)_Y~i~_ _+_ 1 _,_ (_C~i~_ \- 1)_Y~i~_ _+_ 2 _, ..., C~i~Y~i~_
If no code blocks are input to the channel coding (_C~i~_ = 0), no bits shall
be output from the channel coding, i.e. _E~i~_ = 0.
### 4.2.4 Radio frame size equalisation
Radio frame size equalisation is padding the input bit sequence in order to
ensure that the output can be segmented in _F~i~_ data segments of same size
as described in the subclause 4.2.6.
The input bit sequence to the radio frame size equalisation is denoted
by{width="1.1527777777777777in" height="0.2638888888888889in"}, where _i_ is
TrCH number and _E~i~_ the number of bits. The output bit sequence is denoted
by{width="1.0416666666666667in" height="0.2638888888888889in"}, where _T~i~_
is the number of bits. The output bit sequence is derived as follows:
_t~ik~_ = _c~ik~_ ~,~ for k = 1... _E~i~_ and
_t~ik~_ = {0 , 1} for k= _E~i~_ +1... _T~i~_ , if _E~i~_ \ R1 = _X~i~_ _/_ C1.
The rows of the matrix are numbered 0, 1, ..., R1 - 1 from top to bottom.
3) write the input bit sequence into the R1 {width="0.125in"
height="0.1388888888888889in"} C1 matrix row by row starting with bit
{width="0.2361111111111111in" height="0.2638888888888889in"} in column 0 of
row 0 and ending with bit {width="0.5416666666666666in"
height="0.2638888888888889in"} in column C1 - 1 of row R1 -- 1:
{width="3.6527777777777777in" height="1.0277777777777777in"}
4) Perform the inter-column permutation for the matrix based on the pattern
{width="1.2916666666666667in" height="0.3055555555555556in"} shown in table 4,
where P1~C1~(_j_) is the original column position of the _j_ -th permuted
column. After permutation of the columns, the bits are denoted by _y~i,k~_ :
{width="2.9305555555555554in" height="1.0277777777777777in"}
5) Read the output bit sequence {width="1.5833333333333333in"
height="0.2638888888888889in"} of the block interleaver column by column from
the inter-column permuted R1 {width="0.125in" height="0.1388888888888889in"}
C1 matrix. Bit {width="0.2361111111111111in" height="0.2638888888888889in"}
corresponds to row 0 of column 0 and bit {width="0.5555555555555556in"
height="0.2638888888888889in"} corresponds to row R1 - 1 of column C1 - 1.
Table 4 Inter-column permutation patterns for 1st interleaving
* * *
TTI Number of columns C1 Inter-column permutation patterns \ 5ms^(*1)^, 10 ms 1 \ 20 ms 2 \ 40 ms 4
\ 80 ms 8 \
* * *
^(*1)^ can be used for PRACH for 1.28 Mcps TDD
#### 4.2.5.1 Relation between input and output of 1^st^ interleaving
The bits input to the 1^st^ interleaving are denoted by
{width="1.1527777777777777in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _T~i~_ the number of bits. Hence, _x~i,k~_ _=_ _t~i,k~_ and
_X~i~_ _=_ _T~i~_.
The bits output from the 1^st^ interleaving are denoted by
{width="1.3333333333333333in" height="0.2638888888888889in"}, and _d~i,k~_ =
_y~i,k~_.
### 4.2.6 Radio frame segmentation
When the transmission time interval is longer than 10 ms, the input bit
sequence is segmented and mapped onto consecutive _F~i~_ radio frames.
Following radio frame size equalisation the input bit sequence length is
guaranteed to be an integer multiple of _F~i~_.
The input bit sequence is denoted by {width="1.1666666666666667in"
height="0.2638888888888889in"} where _i_ is the TrCH number and _X~i~_ is the
number bits. The _F~i~_ output bit sequences per TTI are denoted by
{width="1.6666666666666667in" height="0.2638888888888889in"}where _n~i~_ is
the radio frame number in current TTI and _Y~i~_ is the number of bits per
radio frame for TrCH _i_. The output sequences are defined as follows:
{width="0.3333333333333333in" height="0.2638888888888889in"}=
{width="0.7083333333333334in" height="0.2638888888888889in"}, _n~i~_ =
1..._F~i~_ , _k_ = 1..._Y~i~_
where
_Y~i~_ = (_X~i~_ / _F~i~_) is the number of bits per segment.
The _n~i~_ \--th segment is mapped to the _n~i~_ \--th radio frame of the
transmission time interval.
The input bit sequence to the radio frame segmentation is denoted by
{width="1.2361111111111112in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _T~i~_ the number of bits. Hence, _x~ik~ = d~ik~_ and _X~i~ =
T~i~_.
The output bit sequence corresponding to radio frame _n~i~_ is denoted by
{width="1.125in" height="0.2638888888888889in"}, where _i_ is the TrCH number
and _N~i~_ is the number of bits. Hence, {width="0.7083333333333334in"
height="0.2638888888888889in"}and _N~i~ = Y~i~_.
### 4.2.7 Rate matching
Rate matching means that bits on a TrCH are repeated or punctured. Higher
layers assign a rate-matching attribute for each TrCH. This attribute is semi-
static and can only be changed through higher layer signalling. The rate-
matching attribute is used when the number of bits to be repeated or punctured
is calculated.
The number of bits on a TrCH can vary between different transmission time
intervals. When the number of bits between different transmission time
intervals is changed, bits are repeated to ensure that the total bit rate
after TrCH multiplexing is identical to the total channel bit rate of the
allocated physical channels.
If no bits are input to the rate matching for all TrCHs within a CCTrCH, the
rate matching shall output no bits for all TrCHs within the CCTrCH.
Notation used in subclause 4.2.7 and subclauses:
_N~ij~_ : Number of bits in a radio frame before rate matching on TrCH _i_
with transport format combination _j_.
> {width="0.3576388888888889in" height="0.24375in"} : If positive -- number of
> bits to be repeated in each radio frame on TrCH _i_ with transport format
> combination j.
>
> If negative -- number of bits to be punctured in each radio frame on TrCH
> _i_ with transport format combination _j_.
_RM~i~_ : Semi-static rate matching attribute for TrCH _i_. Signalled from
higher layers.
> _PL_ : Puncturing limit. This value limits the amount of puncturing that can
> be applied in order to minimise the number of physical channels. Signalled
> from higher layers. The allowed puncturing in % is actually equal to
> (1-PL)*100.
>
> _N~data,j~_ : Total number of bits that are available for a CCTrCH in a
> radio frame with transport format combination j.
_P_ : number of physical channels used in the current frame.
_P~max~_ : maximum number of physical channels allocated for a CCTrCH.
_U~p~_ : Number of data bits in the physical channel p with p = 1...P during a
radio frame.
_I_ : Number of TrCHs in a CCTrCH.
_Z~ij~_ : Intermediate calculation variable.
_F~i~_ : Number of radio frames in the transmission time interval of TrCH _i_.
_n~i~_ : Radio frame number in the transmission time interval of TrCH _i_ (_0
≤ n~i~ \  _q_ : Average puncturing or repetition distance(normalised to only show the
> remaining rate matching on top of an integer number of repetitions).
>
> _P1~F~(n~i~)_ : The column permutation function of the 1^st^ interleaver, P1
> _~F~_(x) is the original position of column with number x after permutation.
> P1 is defined on table 4 of section 4.2.5 (note that P1~F~ self-inverse).
S[n] : The shift of the puncturing or repetition pattern for radio frame n~i~
when {width="0.8465277777777778in" height="0.2534722222222222in"}.
_TF~i~_(_j_) : Transport format of TrCH i for the transport format combination
j.
_TFS_(_i_) : The set of transport format indexes _l_ for TrCH i.
e~ini~ : Initial value of variable e in the rate matching pattern
determination algorithm of subclause 4.2.7.3.
_e~plus~_ : Increment of variable _e_ in the rate matching pattern
determination algorithm of subclause 4.2.7.3.
_e~minus~_ : Decrement of variable _e_ in the rate matching pattern
determination algorithm of subclause 4.2.7.3.
_b_ : Indicates systematic and parity bits.
_b_ =1: Systematic bit. _X(t)_ in subclause 4.2.3.2.1.
_b_ =2: 1^st^ parity bit (from the upper Turbo constituent encoder). _Y(t)_ in
subclause 4.2.3.2.1.
> _b_ =3: 2^nd^ parity bit (from the lower Turbo constituent encoder).
> _Y\'(t)_ in subclause 4.2.3.2.1.
Note: when the TTI is 5msec for 1.28Mcps, the above notation refers to a sub-
frame rather than a radio frame. In this case, _F~i~_ = 1 and _n~i~_ = 0.
#### 4.2.7.1 Determination of rate matching parameters
The following relations, defined for all TFC _j_ , are used when calculating
the rate matching pattern:
{width="0.5555555555555556in" height="0.2638888888888889in"}
{width="2.4805555555555556in" height="0.9423611111111111in"} for all i = 1 ...
_I_ (1)
{width="1.69375in" height="0.2638888888888889in"} for all i = 1 ... _I_
Puncturing can be used to minimise the required transmission capacity. The
maximum amount of puncturing that can be applied is 1-PL, PL is signalled from
higher layers. The possible values for N~data~ depend on the number of
physical channels P~max~ , allocated to the respective CCTrCH, and on their
characteristics (spreading factor, length of midamble and TFCI code word,
usage of TPC and multiframe structure), which is given in [7].
For each physical channel an individual minimum spreading factor _Sp~min~_ is
transmitted by means of the higher layers. Denote the number of data bits in
each physical channel by _U~p,Sp~_ , where _p_ _indicates_ the sequence number
_1≤ p≤ P~max~_ and _Sp_ indicates the spreading factor of this physical
channel: _Sp_ takes the possible values {_16, 8, 4, 2, 1_} for 1.28Mcps TDD
and 3.84Mcps TDD, _Sp_ takes the possible values {32, _16, 8, 4, 2, 1_} for
7.68Mcps TDD. The index _p_ is described in section 4.2.12 with the following
modifications: spreading factor (_Q_) is replaced by the minimum spreading
factor _Sp~min~_ and _k_ is replaced by the channelization code index at _Q=
Sp~min~_. Then, for _N~data~_ one of the following values in ascending order
can be chosen:
{width="3.3930555555555557in" height="0.2326388888888889in"}
Optionally, if indicated by higher layers for the UL the UE shall vary the
spreading factor autonomously, so that _N~data~_ is one of the following
values in ascending order:
{width="6.605555555555555in" height="0.2326388888888889in"}
N~data,\ j~ for the transport format combination j is determined by executing
the following algorithm:
SET1 = { N~data~ such that {width="3.307638888888889in"
height="0.5513888888888889in"} is non negative }
N~data,\ j~ = min SET1
The number of bits to be repeated or punctured, ∆ _N~i,j~_ , within one radio
frame (one sub-frame when the TTI is 5msec) for each TrCH i is calculated with
the relations given at the beginning of this subclause for all possible
transport format combinations j and selected every radio frame (sub-frame).
The number of physical channels corresponding to N~data,\ j,~ shall be denoted
by P.
If ∆ _N~i,j~_ = 0 then the output data of the rate matching is the same as the
input data and the rate matching algorithm of subclause 4.2.7.3 does not need
to be executed.
Otherwise, the rate matching pattern is calculated with the algorithm
described in subclause 4.2.7.3. For this algorithm the parameters e~ini~,
e~plus~, e~minus~, and _X~i~_ are needed, which are calculated according to
the equations in subclauses 4.2.7.1.1 and 4.2.7.1.2.
##### 4.2.7.1.1 Uncoded and convolutionally encoded TrCHs
a = 2
∆N~i~ = ∆N~i,j~
X~i~ = N~i,j~
R = ∆ _N~i~_ ~,_j_ ~ mod _N~i~_ ~,_j_ ~ -- note: in this context ∆ _N~i~_
~,_j_ ~ mod _N~i~_ ~,_j_ ~ is in the range of 0 to _N~i,j~_ -1 i.e. -1 mod 10
= 9.
if R ≠ 0 and 2×R ≤ _N~i,j~_
then q =  _N~i,j~_ / _R_ 
else
q =  _N~i,j~_ / (_R_ \- _N~i,j~_)
endif
NOTE 1: q is a signed quantity.
If q is even
then q\' = q + gcd(q, _F~i~_) / _F~i~_ \-- where gcd (q, _F~i~_) means
greatest common divisor of q and _F~i~_
NOTE 2: q\' is not an integer, but a multiple of 1/8.
else
q\' = q
endif
for x = 0 to _F~i~_ -1
S[x×q\' mod _F~i~_] = (x*q\' div _F~i~_)
end for
_e~ini~_ = (a × S[P1 _~Fi~_(_n~i~_)] × \|∆ _N~i~_ \| + 1) mod (a × _N~i,j~_)
_e~plus~_ = a × _X~i~_
e~minus~ = a × \|∆N~i~\|
puncturing for ∆ _N~i~_ \_0,
the parameters in subclause 4.2.7.1.1 are used.
If puncturing is to be performed, the parameters below shall be used. Index
_b_ is used to indicate systematic (_b_ =1), 1^st^ parity (_b_ =2), and 2^nd^
parity bit (_b_ =3).
a = 2 when _b_ =2
a = 1 when _b_ =3
{width="1.7222222222222223in" height="0.5277777777777778in"}
If {width="0.2916666666666667in" height="0.2222222222222222in"} is calculated
as 0 for _b_ =2 or _b_ =3, then the following procedure and the rate matching
algorithm of subclause 4.2.7.3 don\'t need to be performed for the
corresponding parity bit stream.
X~i~ = N~i,j~ /3 ,
q = X~i~ /\|∆N~i~\| 
if(q{width="0.1388888888888889in" height="0.16666666666666666in"}2)
for _r=_ 0 to _F~i~_ -1
S[(3× _r_ +b-1) mod _F~i~_] = _r_ mod 2;
end for
else
if q is even
then q′ = q -- _gcd(_ q _,_ _F~i~_)/ _F~i~_ \-- where _gcd (_ q _, F~i~)_
means greatest common divisor of q and _F~i~_
NOTE: q′ is not an integer, but a multiple of 1/8.
else q′ _=_ q
endif
for _x_ =0 to _F~i~_ \--1
r =  _x_ ×q\' mod _F~i~_ ;
S[(3×r+b-1) mod _F~i~_] =  _x_ ×q′ div _F~i~_ ;
endfor
endif
For each radio frame, the rate-matching pattern is calculated with the
algorithm in subclause 4.2.7.3, where:
_X~i~_ is as above,
_e~ini~_ = (a×S[P1 _F~i~_ (_n~i~_)]×⋅\|∆ _N~i~_ \| + _X~i~_) mod (a×X~i~), if
_e~ini~_ = 0 then _e~ini~_ = a× _X~i~_
_e~plus~_ = a× _X~i~_
_e~minus~_ = a×\|∆ _N~i~_ \|
#### 4.2.7.2 Bit separation and collection for rate matching
The systematic bits of turbo encoded TrCHs shall not be punctured, the other
bits may be punctured. The systematic bits, first parity bits, and second
parity bits in the bit sequence input to the rate matching block are therefore
separated into three sequences.
The first sequence contains:
\- All of the systematic bits that are from turbo encoded TrCHs.
\- From 0 to 2 first and/or second parity bits that are from turbo encoded
TrCHs. These bits come into the first sequence when the total number of bits
in a block after radio frame segmentation is not a multiple of three.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The second sequence contains:
\- All of the first parity bits that are from turbo encoded TrCHs, except
those that go into the first sequence when the total number of bits is not a
multiple of three.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The third sequence contains:
\- All of the second parity bits that are from turbo encoded TrCHs, except
those that go into the first sequence when the total number of bits is not a
multiple of three.
\- Some of the systematic, first parity and second parity bits that are for
trellis termination.
The second and third sequences shall be of equal length, whereas the first
sequence can contain from 0 to 2 more bits. Puncturing is applied only to the
second and third sequences.
The bit separation function is transparent for uncoded TrCHs, convolutionally
encoded TrCHs, and for turbo encoded TrCHs with repetition. The bit separation
and bit collection are illustrated in figures 4 and 5.
{width="5.865972222222222in" height="3.077777777777778in"}
Figure 4: Puncturing of turbo encoded TrCHs
{width="6.274305555555555in" height="2.986111111111111in"}
Figure 5: Rate matching for uncoded TrCHs, convolutionally encoded TrCHs,\ and
for turbo encoded TrCHs with repetition
The bit separation is dependent on the 1^st^ interleaving and offsets are used
to define the separation for different TTIs. _b_ indicates the three sequences
defined in this section, with _b_ =1 indicating the first sequence, _b_ = 2
the second one, and _b_ = 3 the third one.
The offsets _α~b~_ for these sequences are listed in table 5.
Table 5: TTI dependent offset needed for bit separation
* * *
TTI (ms) _α_ ~1~ _α_ ~2~ _α_ ~3~ 5, 10, 40 0 1 2 20, 80 0 2 1
* * *
The bit separation is different for different radio frames in the TTI. A
second offset is therefore needed. The radio frame number for TrCH _i_ is
denoted by _n~i~_. and the offset by {width="0.25in"
height="0.2638888888888889in"}.
Table 6: Radio frame dependent offset needed for bit separation
* * *
TTI (ms) _β_ ~0~ _β_ ~1~ _β_ ~2~ _β_ ~3~ _β_ ~4~ _β_ ~5~ _β_ ~6~ _β_ ~7~ 5, 10
0 NA NA NA NA NA NA NA 20 0 1 NA NA NA NA NA NA 40 0 1 2 0 NA NA NA NA 80 0 1
2 0 1 2 0 1
* * *
##### 4.2.7.2.1 Bit separation
The bits input to the rate matching are denoted by
{width="1.2638888888888888in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _N~i~_ is the number of bits input to the rate matching block.
Note that the transport format combination number _j_ for simplicity has been
left out in the bit numbering, i.e. _N~i~_ =_N~ij~_. The bits after separation
are denoted by {width="1.625in" height="0.2638888888888889in"}. For turbo
encoded TrCHs with puncturing, _b_ indicates the three sequences defined in
section 4.2.7.2, with _b_ =1 indicating the first sequence, and so forth. For
all other cases _b_ is defined to be 1. _X~i~_ is the number of bits in each
separated bit sequence. The relation between _e~i,k~_ and _x~b,i,k~_ is given
below.
For turbo encoded TrCHs with puncturing:
{width="1.6805555555555556in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _X~i~ X~i~ =_  _N~i~_ /3
{width="1.44375in" height="0.2638888888888889in"} _k_ = 1, ..., _N~i~_ mod 3
Note: When (_N~i~_ mod 3) = 0 this row is not needed.
{width="1.7222222222222223in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~_ =  _N~i~_ /3
{width="1.7083333333333333in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~_ =  _N~i~_ /3
For uncoded TrCHs, convolutionally encoded TrCHs, and turbo encoded TrCHs with
repetition:
{width="0.6805555555555556in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _X~i~_ _X~i~ = N~i~_
##### 4.2.7.2.2 Bit collection
The bits _x~b,i,k~_ are input to the rate matching algorithm described in
subclause 4.2.7.3. The bits output from the rate matching algorithm are
denoted {width="1.6388888888888888in" height="0.2638888888888889in"}.
Bit collection is the inverse function of the separation. The bits after
collection are denoted by {width="1.5694444444444444in"
height="0.2638888888888889in"}. After bit collection, the bits indicated as
punctured are removed and the bits are then denoted by
{width="1.3055555555555556in" height="0.2638888888888889in"}, where _i_ is the
TrCH number and _V~i~_ = _N~i,j~_ +∆ _N~i,j~_. The relations between
_y~b,i,k~,_ _z~b,i,k~_ , and _f~i,k~_ are given below.
For turbo encoded TrCHs with puncturing (_Y~i~=X~i~_):
{width="1.7083333333333333in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _Y~I~_
{width="1.4583333333333333in" height="0.2638888888888889in"} _k_ = 1, ...,
_N~i~_ mod 3 Note: When (_N~i~_ mod 3) = 0 this row is not needed.
{width="1.7361111111111112in" height="0.2916666666666667in"} _k_ = 1, 2, 3,
..., _Y~i~_
{width="1.75in" height="0.2916666666666667in"} _k_ = 1, 2, 3, ..., _Y~i~_
After the bit collection, bits _z~i,k~_ with value _δ_ , where
_δ[∉]{.underline}_{0, 1}, are removed from the bit sequence. Bit _f~i,~_ ~1~
corresponds to the bit _z~i,k~_ with smallest index _k_ after puncturing, bit
_f~i,~_ ~2~ corresponds to the bit _z~i,k~_ with second smallest index _k_
after puncturing, and so on.
For uncoded TrCHs, convolutionally encoded TrCHs, and turbo encoded TrCHs with
repetition:
{width="0.7083333333333334in" height="0.2638888888888889in"} _k_ = 1, 2, 3,
..., _Y~i~_
When repetition is used, _f~i,k~_ =_z~i,k~_ and _Y~i~_ =_V~i~_.
When puncturing is used, _Y~i~_ =_X~i~_ and bits _z~i,k~_ with value _δ_ ,
where _δ∉_{0, 1}, are removed from the bit sequence. Bit _f~i,~_ ~1~
corresponds to the bit _z~i,k~_ with smallest index _k_ after puncturing, bit
_f~i,~_ ~2~ corresponds to the bit _z~i,k~_ with second smallest index _k_
after puncturing, and so on.
#### 4.2.7.3 Rate matching pattern determination
The bits input to the rate matching are denoted by
{width="1.3194444444444444in" height="0.2638888888888889in"}, where _i_ is the
TrCH and _X_ ~i~ is the parameter given in subclauses 4.2.7.1.1 and 4.2.7.1.2
_._
NOTE: The transport format combination number j for simplicity has been left
out in the bit numbering.
The rate matching rule is as follows:
if puncturing is to be performed
_e_ = _e~ini~_ \-- initial error between current and desired puncturing ratio
m = 1 -- index of current bit
do while m \ where {width="0.5277777777777778in" height="0.25in"} for _k_ = 1, 2, ...,
> _U_ and if R2 × C2 > _U_ , the dummy bits are padded such that
> {width="0.20833333333333334in" height="0.25in"} = 0 or 1 for _k_ = _U_ \+ 1,
> _U_ \+ 2, ..., R2 × C2. These dummy bits are pruned away from the output of
> the matrix after the inter-column permutation.
(4) Perform the inter-column permutation for the matrix based on the pattern
{width="1.19375in" height="0.3055555555555556in"} that is shown in table 7,
where P~2~(_j_) is the original column position of the _j_ -th permuted
column. After permutation of the columns, the bits are denoted by
{width="0.2361111111111111in" height="0.25in"}.
{width="2.8465277777777778in" height="1.0277777777777777in"}
(5) The output of the block interleaver is the bit sequence read out column by
column from the inter-column permuted R2 {width="0.125in"
height="0.1388888888888889in"} C2 matrix. The output is pruned by deleting
dummy bits that were padded to the input of the matrix before the inter-column
permutation, i.e. bits {width="0.2361111111111111in" height="0.25in"} that
corresponds to bits {width="0.20833333333333334in" height="0.25in"} with _k_ >
_U_ are removed from the output. The bits at the output of the block
interleaver are denoted by $z_{1},z_{2},\ldots,z_{U}$, where _z_ ~1~
corresponds to the bit {width="0.2361111111111111in" height="0.25in"} with
smallest index _k_ after pruning, _z_ ~2~ to the bit
{width="0.2361111111111111in" height="0.25in"} with second smallest index _k_
after pruning, and so on.
The bits $z_{1},z_{2},\ldots,z_{U}$ shall be segmented as follows:
$u_{1,k} = z_{k}$ _k =_ 1, 2 , ..., _U~1~_
$u_{2,k} = z_{(k + U_{1})}$ _k =_ 1, 2 , ..., _U~2~_
...
$u_{P,k} = z_{(k + U_{1} + \ldots + U_{P - 1})}$ _k =_ 1, 2 , ..., _U~P~_
> The bits after frame related 2^nd^ interleaving are denoted by
> $v_{t,1},v_{t,2},\text{.}\text{.}\text{.},v_{t,U_{t}}$, where _t_ refers to
> the timeslot sequence number and _U~t~ is the number of bits transmitted in
> this timeslot during the respective radio frame._
>
> Let _T_ be the number of time slots in a CCTrCH during the respective radio
> frame (where for 1.28Mcps TDD, the respective radio frame includes subframes
> 1 and 2), and $t = 1,\ldots,T$. The physical layer shall assign the time
> slot sequence number _t_ in ascending order of the allocated time slots in
> the CCTrCH in the respective radio frame. In time slot _t, R~t~ refers to
> the number of physical channels within the respective time slot_ and $r =
> 1,\ldots,R_{t}$. _The relation between r and t and the physical channel
> sequence number p as detailed in 4.2.12.1 is given by:_
>
> _Defining the relation u~t,r,k\ ~_ = _u~p,k~ and denoting_ $U_{\text{tr}}$
> _as the number of bits for physical channel r in time slot t, the relation
> between v~t,k~ and u~t,r,k~ is given below:_
$v_{t,k}\ = \ u_{t,1,k}$ _k =_ 1, 2 , ..., $U_{t1}$
$v_{t,(k + U_{t1})}\ = \ u_{t,2,k}$ _k =_ 1, 2 , ..., $U_{t2}$
...
$v_{t,(k + U_{t1} + \ \text{.}\text{.}\text{.}\ + U_{t\left( R_{t} - 1
\right)})}\ = \ u_{t,R_{t},k}$ _k =_ 1, 2 , ..., $U_{\text{tR}_{t}}$
#### 4.2.11.2 Timeslot related 2^nd^ interleaving
In case of timeslot related 2^nd^ interleaving, the bits input to the block
interleaver are denoted by {width="1.3194444444444444in"
height="0.2638888888888889in"}, where _t_ is the timeslot sequence number, and
_U~t~_ is the number of bits transmitted in this timeslot during the
respective radio frame.
Let _T_ be the number of time slots in a CCTrCH during the respective radio
frame (where for 1.28Mcps TDD, the respective radio frame includes subframes 1
and 2), and$t = 1,\ldots,T$. The physical layer shall assign the time slot
sequence number _t_ in ascending order of the allocated time slots in the
CCTrCH in the respective radio frame. In timeslot _t,_ _R~t~_ refers to the
number of physical channels within the respective timeslot and $r =
1,\ldots,R_{t}$. _The relation between r and t and the physical channel
sequence number p as detailed in 4.2.12.1 is given by:_
_Defining the relation u~t,r,k\ ~_ = _u~p,k~ and denoting_ $U_{\text{tr}}$ _as
the number of bits for physical channel r in time slot t, the relation between
x~t,k~ and u~t,r,k~ is given below_ :
{width="0.69375in" height="0.2638888888888889in"} _k =_ 1, 2 , ...,
{width="0.2222222222222222in" height="0.20833333333333334in"}
{width="0.9722222222222222in" height="0.2638888888888889in"} _k =_ 1, 2 , ...,
{width="0.2361111111111111in" height="0.20833333333333334in"}
...
$x_{t,(k + U_{t1} + \ \text{.}\text{.}\text{.}\ + U_{t\left( R_{t} - 1
\right)})}\ = \ u_{t,R_{t},k}$ _k =_ 1, 2 , ..., $U_{\text{tR}_{t}}$
The following steps have to be performed for each timeslot _t_ , on which the
respective CCTrCH is mapped:
(1) Assign C2 _=_ 30 to be the number of columns of the matrix. The columns of
the matrix are numbered 0, 1, 2, ..., C2 - 1 from left to right.
(2) Determine the number of rows of the matrix, R2, by finding minimum integer
R2 such that:
_U~t~_ ≤ R2 × C2.
The rows of rectangular matrix are numbered 0, 1, 2, ..., R2 - 1 from top to
bottom.
(3) Write the input bit sequence {width="1.3194444444444444in"
height="0.2638888888888889in"} into the R2 {width="0.125in"
height="0.1388888888888889in"} C2 matrix row by row starting with bit
{width="0.25in" height="0.2638888888888889in"} in column 0 of row 0:
{width="3.75in" height="1.0277777777777777in"}
> where {width="0.6527777777777778in" height="0.2638888888888889in"} for _k_ =
> 1, 2, ..., _U~t~_ and if R2 × C2 > _U~t~_ , the dummy bits are padded such
> that {width="0.2638888888888889in" height="0.2638888888888889in"} = 0 or 1
> for _k_ = _U~t~_ \+ 1, _U~t~_ \+ 2, ..., R2 × C2. These dummy bits are
> pruned away from the output of the matrix after the inter-column
> permutation.
(4) Perform the inter-column permutation for the matrix based on the pattern
{width="1.2083333333333333in" height="0.3055555555555556in"} that is shown in
table 7, where P2(_j_) is the original column position of the _j_ -th permuted
column. After permutation of the columns, the bits are denoted by
{width="0.3055555555555556in" height="0.2638888888888889in"}.
{width="3.0965277777777778in" height="1.0277777777777777in"}
(5) The output of the block interleaver is the bit sequence read out column by
column from the inter-column permuted R2 {width="0.125in"
height="0.1388888888888889in"} C2 matrix. The output is pruned by deleting
dummy bits that were padded to the input of the matrix before the inter-column
permutation, i.e. bits {width="0.3055555555555556in"
height="0.2638888888888889in"} that corresponds to bits
{width="0.2638888888888889in" height="0.2638888888888889in"} with _k > U~t~_
are removed from the output. The bits after time slot 2^nd^ interleaving are
denoted by {width="1.0138888888888888in" height="0.2638888888888889in"}, where
_v~t,~_ ~1~ corresponds to the bit {width="0.3055555555555556in"
height="0.2638888888888889in"} with smallest index _k_ after pruning, _v~t,~_
~2~ to the bit {width="0.3055555555555556in" height="0.2638888888888889in"}
with second smallest index _k_ after pruning, and so on.
Table 7 Inter-column permutation pattern for 2nd interleaving
+----------------------+----------------------------------------------+ | Number of Columns C2 | Inter-column permutation pattern | | | | | | \ | +----------------------+----------------------------------------------+ | 30 | \ | +----------------------+----------------------------------------------+
### 4.2.11A Sub-frame segmentation for the 1.28 Mcps option
In the 1.28Mcps TDD, it is needed to add a sub-frame segmentation unit between
2nd interleaving unit and physical channel mapping unit when the TTI of the
CCTrCh is greater than 5msec. In this case, the operation of rate-matching
guarantees that the size of bit streams is an even number and can be
subdivided into 2 sub-frames. The transport channel multiplexing structure for
uplink and downlink is shown in figure 1A.
The input to the sub-frame segmentation unit is segmented into timeslot
chunks, where each timeslot chunk contains all of the bits that are to be
transmitted in a given timeslot position in both of the sub-frames.
The input bit sequence is denoted by {width="1.1666666666666667in"
height="0.2638888888888889in"} where i is the timeslot number and X~i~ is the
number of bits transmitted in timeslot i in a radio frame. The two output bit
sequences per radio frame are denoted by _y~i,n,1~, y~i,n,2~, y~i,n,3~, ...,
y~i,n,Yi~_ where n is the sub-frame number in current radio frame and Y~i~ is
the number of bits per sub-frame for timeslot i. The output sequences are
defined as follows:
$y_{i,n,k}$= $x_{i,((n - 1)\text{.}Y_{i}) + k}$, n = 1 or 2, k = 1...Y~i~
where
Y~i~ = (X~i~ / 2) is the number of bits in timeslot i per sub-frame,
{width="0.20833333333333334in" height="0.25in"} is the k^th^ bit of the input
bit sequence and
$y_{i,n,k}$is the k^th^ bit of the output bit sequence corresponding to the
n^th^ sub-frame
### 4.2.12 Physical channel mapping
#### 4.2.12.1 Physical channel mapping for the 3.84 Mcps and 7.68Mcps options
The PhCH for both uplink and downlink is defined in [7]. The bits after
physical channel mapping are denoted by {width="1.25in"
height="0.2777777777777778in"}, where _p_ is the PhCH number corresponding to
the sequence number _1≤ p≤ P_ of this physical channel as detailed below,
_U~p~_ is the number of bits in one radio frame for the respective PhCH, and
_P≤_. _P~max~_. The bits w _~p,k~_ are mapped to the PhCHs so that the bits
for each PhCH are transmitted over the air in ascending order with respect to
_k_.
The physical layer shall assign the physical channel sequence number _p_ to
the physical channels of the CCTrCH in the respective radio frame, treating
each allocated timeslot in ascending order. If within a timeslot there are
multiple physical channels they shall first be ordered in ascending order of
the spreading factor (_Q_) and subsequently by channelisation code index
(_k_), as shown in [9].
The mapping of the bits $v_{t,1},v_{t,2},\text{.}\text{.}\text{.},v_{t,U_{t}}$
is performed like block interleaving, writing the bits into columns, but a
PhCH with an odd number is filled in forward order, whereas a PhCH with an
even number is filled in reverse order.
The mapping scheme, as described in the following subclause, shall be applied
individually for each timeslot _t_ used in the current frame. Therefore, the
bits {width="0.9861111111111112in" height="0.2638888888888889in"} are assigned
to the bits of the physical channels {width="1.94375in"
height="0.2916666666666667in"} in each timeslot.
In uplink there are at most two codes allocated (P≤2). If there is only one
code, the same mapping as for downlink is applied. Denote SF1 and SF2 the
spreading factors used for code 1 and 2, respectively. For the number of
consecutive bits to assign per code bs _~k~_ the following rule is applied:
if
SF1 >= SF2 then bs~1~ = 1 ; bs~2~ = SF1/SF2 ;
else
SF2 > SF1 then bs~1~ = SF2/SF1; bs~2~ = 1 ;
end if
In the downlink case bs~p~ is 1 for all physical channels.
##### 4.2.12.1.1 Mapping scheme
Notation used in this subclause:
_P_ ~t~: number of physical channels for timeslot t , _P~t~_ = 1..2 for uplink
; _P~t~_ = 1...16 for downlink for 1.28Mcps TDD and 3.84Mcps TDD, _P~t~_ =
1...32 for 7.68Mcps TDD
_U~t,p~_ : capacity in bits for the physical channel p in timeslot t
_U~t.~_ : total number of bits to be assigned for timeslot t
bs~p~: number of consecutive bits to assign per code
for downlink all bs~p~ = 1
for uplink if SF1 >= SF2 then bs~1~ = 1 ; bs~2~ = SF1/SF2 ;
if SF2 > SF1 then bs~1~ = SF2/SF1; bs~2~ = 1 ;
fb~p~: number of already written bits for each code
pos: intermediate calculation variable
for p=1 to _P_ ~t~ -- reset number of already written bits for every physical
channel
fb~p~ = 0
end for
p = 1 -- start with PhCH #1
for k=1 to _U~t.~_
do while (fb~p~ == _U~t,p~_) -- physical channel filled up already ?
p = (p mod P~t~) + 1;
end do
if (p mod 2) == 0
pos = _U~t,p~_ \- fb~p~ -- reverse order
else
pos = fb~p~ + 1 -- forward order
endif
_w_ ~t,p,pos~ = _v_ ~t,k~ -- assignment
fb~p~ = fb~p~ + 1 -- Increment number of already written bits
if (fb~p~ mod bs~p~) == 0 -- Conditional change to the next physical channel
p = (p mod P~t~) + 1;
end if
end for
#### 4.2.12.2 Physical channel mapping for the 1.28 Mcps option
The bit streams from the sub-frame segmentation unit are mapped onto code
channels of time slots in sub-frames.
The bits after physical channel mapping are denoted by , where p is the PhCH
number and Up is the number of bits in one sub-frame for the respective PhCH.
The bits wpk are mapped to the PhCHs so that the bits for each PhCH are
transmitted over the air in ascending order with respect to k.
The mapping of the bits y~t,n,1~, y~t,n,2,~ y~t,n,3,\ ...,~ y~t,n,Ut~ is
performed like block interleaving, writing the bits into columns, but a PhCH
with an odd number is filled in forward order, were as a PhCH with an even
number is filled in reverse order.
The mapping scheme, as described in the following subclause, shall be applied
individually for each timeslot t used in the current subframe. Therefore, the
bits y~t,n,1~, y~t,n,2,~ y~t,n,3,\ ...,~ y~t,n,Ut~ are assigned to the bits of
the physical channels {width="1.69375in" height="0.25in"} in each timeslot.
In uplink there are at most two codes allocated (P≤2). If there is only one
code, the same mapping as for downlink is applied. Denote SF1 and SF2 the
spreading factors used for code 1 and 2, respectively. For the number of
consecutive bits to assign per code bsk the following rule is applied:
if
SF1 >= SF2 then bs~1~ = 1 ; bs~2~ = SF1/SF2 ;
else
SF2 > SF1 then bs~1~ = SF2/SF1; bs~2~ = 1 ;
end if
In the downlink case bs~p~ is 1 for all physical channels.
##### 4.2.12.2.1 Mapping scheme
Notation used in this subclause:
P ~t~: number of physical channels for timeslot t , P~t~ = 1..2 for uplink ;
P~t~ = 1...16 for downlink
U~tp~: capacity in bits for the physical channel p in timeslot t in the
current sub-frame
U~t~.: total number of bits to be assigned for timeslot t in the current sub-
frame
n = index of the current sub-frame (1 or 2)
bs~p~: number of consecutive bits to assign per code
for downlink all bs~p~ = 1
for uplink if SF1 >= SF2 then bs~1~ = 1 ; bs~2~ = SF1/SF2 ;
if SF2 > SF1 then bs~1~ = SF2/SF1; bs~2~ = 1 ;
fb~p~: number of already written bits for each code
pos: intermediate calculation variable
for p=1 to P ~t~ -- reset number of already written bits for every physical
channel
fb~p~ = 0
end for
p = 1 -- start with PhCH #1
for k=1 to U~t~.
do while (fb~p~ == U~t,p~) -- physical channel filled up already ?
p = (p mod P ~t~) + 1 ;
end do
if (p mod 2) == 0
pos = U~t,p~ - fb~p~ -- reverse order
else
pos = fb~p~ + 1 -- forward order
end if
w~tp,pos~ =y~t,n,k~ -- assignment
fb~p~ = fb~p~ + 1 -- Increment number of already written bits
If (fb~p~ mod bs~p~) == 0 -- Conditional change to the next physical channel
p = (p mod P t) + 1 ;
end if
end for
### 4.2.13 Multiplexing of different transport channels onto one CCTrCH, and
mapping of one CCTrCH onto physical channels
Different transport channels can be encoded and multiplexed together into one
Coded Composite Transport Channel (CCTrCH). The following rules shall apply to
the different transport channels which are part of the same CCTrCH:
1) Transport channels multiplexed into one CCTrCh shall have co-ordinated
timings. When the TFCS of a CCTrCH is changed because one or more transport
channels are added to the CCTrCH or reconfigured within the CCTrCH, or removed
from the CCTrCH, the change may only be made at the start of a radio frame
with CFN fulfilling the relation
> CFN mod F~max~ = 0,
>
> where F~max~ denotes the maximum number of radio frames within the
> transmission time intervals of all transport channels which are multiplexed
> into the same CCTrCH, including any transport channels _i_ which are added
> reconfigured or have been removed, and CFN denotes the connection frame
> number of the first radio frame of the changed CCTrCH.
>
> After addition or reconfiguration of a transport channel _i_ within a
> CCTrCH, the TTI of transport channel _i_ may only start in radio frames with
> CFN fulfilling the relation
>
> CFN~i~ mod F~i~ = 0.
2) Different CCTrCHs cannot be mapped onto the same physical channel.
3) One CCTrCH shall be mapped onto one or several physical channels.
4) Dedicated Transport channels and common transport channels cannot be
multiplexed into the same CCTrCH.
5) For the common transport channels, only the FACH and PCH may belong to the
same CCTrCH.
6) Each CCTrCH carrying a BCH shall carry only one BCH and shall not carry any
other Transport Channel.
7) Each CCTrCH carrying a RACH shall carry only one RACH and shall not carry
any other Transport Channel.
Hence, there are two types of CCTrCH.
CCTrCH of dedicated type, corresponding to the result of coding and
multiplexing of one or several DCH.
CCTrCH of common type, corresponding to the result of the coding and
multiplexing of a common channel, i.e. RACH and USCH in the uplink and DSCH,
BCH, FACH or PCH in the downlink, respectively.
Transmission of TFCI is possible for CCTrCH containing Transport Channels of:
\- dedicated type;
\- USCH type;
\- DSCH type;
\- FACH and/or PCH type.
#### 4.2.13.1 Allowed CCTrCH combinations for one UE
##### 4.2.13.1.1 Allowed CCTrCH combinations on the uplink
The following CCTrCH combinations for one UE are allowed, also simultaneously:
1) several CCTrCH of dedicated type;
2) several CCTrCH of common type.
##### 4.2.13.1.2 Allowed CCTrCH combinations on the downlink
The following CCTrCH combinations for one UE are allowed, also simultaneously:
3) several CCTrCH of dedicated type;
4) several CCTrCH of common type.
### 4.2.14 Transport format detection
Transport format detection can be performed both with and without Transport
Format Combination Indicator (TFCI). If a TFCI is transmitted, the receiver
detects the transport format combination from the TFCI. When no TFCI is
transmitted, so called blind transport format detection may be used, i.e. the
receiver side uses the possible transport format combinations as a priori
information.
#### 4.2.14.1 Blind transport format detection
Blind Transport Format Detection is optional both in the UE and the UTRAN.
Therefore, for all CCTrCH a TFCI shall be transmitted, including the
possibility of a TFCI code word length zero, if only one TFC is defined.
#### 4.2.14.2 Explicit transport format detection based on TFCI
##### 4.2.14.2.1 Transport Format Combination Indicator (TFCI)
The Transport Format Combination Indicator (TFCI) informs the receiver of the
transport format combination of the CCTrCHs. As soon as the TFCI is detected,
the transport format combination, and hence the individual transport
channels\' transport formats are known, and decoding of the transport channels
can be performed.
## 4.3 Coding for layer 1 control for the 3.84 Mcps and 7.68Mcps TDD options
### 4.3.1 Coding of transport format combination indicator (TFCI)
Encoding of the TFCI depends on its length. If there are 6-10 bits of TFCI the
channel encoding is done as described in subclause 4.3.1.1. Also specific
coding of less than 6 bits is possible as explained in subclause 4.3.1.2.
#### 4.3.1.1 Coding of long TFCI lengths
The TFCI is encoded using a (32, 10) sub-code of the second order Reed-Muller
code. The coding procedure is as shown in figure 6.
{width="4.759722222222222in" height="0.7951388888888888in"}
Figure 6: Channel coding of the TFCI bits
If the TFCI consists of less than 10 bits, it is padded with zeros to 10 bits,
by setting the most significant bits to zero. TFCI is encoded by the (32,10)
sub-code of second order Reed-Muller code. The code words of the (32,10) sub-
code of second order Reed-Muller code are linear combination of some among 10
basis sequences. The basis sequences are as follows in table 8.
Table 8: Basis sequences for (32,10) TFCI code
* * *
I M~i,0~ M~i,1~ M~i,2~ M~i,3~ M~I,4~ M~i,5~ M~i,6~ M~i,7~ M~i,8~ M~i,9~ 0 1 0
0 0 0 1 0 0 0 0 1 0 1 0 0 0 1 1 0 0 0 2 1 1 0 0 0 1 0 0 0 1 3 0 0 1 0 0 1 1 0
1 1 4 1 0 1 0 0 1 0 0 0 1 5 0 1 1 0 0 1 0 0 1 0 6 1 1 1 0 0 1 0 1 0 0 7 0 0 0
1 0 1 0 1 1 0 8 1 0 0 1 0 1 1 1 1 0 9 0 1 0 1 0 1 1 0 1 1 10 1 1 0 1 0 1 0 0 1
1 11 0 0 1 1 0 1 0 1 1 0 12 1 0 1 1 0 1 0 1 0 1 13 0 1 1 1 0 1 1 0 0 1 14 1 1
1 1 0 1 1 1 1 1 15 1 0 0 0 1 1 1 1 0 0 16 0 1 0 0 1 1 1 1 0 1 17 1 1 0 0 1 1 1
0 1 0 18 0 0 1 0 1 1 0 1 1 1 19 1 0 1 0 1 1 0 1 0 1 20 0 1 1 0 1 1 0 0 1 1 21
1 1 1 0 1 1 0 1 1 1 22 0 0 0 1 1 1 0 1 0 0 23 1 0 0 1 1 1 1 1 0 1 24 0 1 0 1 1
1 1 0 1 0 25 1 1 0 1 1 1 1 0 0 1 26 0 0 1 1 1 1 0 0 1 0 27 1 0 1 1 1 1 1 1 0 0
28 0 1 1 1 1 1 1 1 1 0 29 1 1 1 1 1 1 1 1 1 1 30 0 0 0 0 0 1 0 0 0 0 31 0 0 0
0 1 1 1 0 0 0
* * *
The TFCI bits a~0~ , a~1~ , a~2~ , a~3~ , a~4~ , a~5~ , a~6~ , a~7~ , a~8~ ,
a~9~ (where a~0~ is LSB and a~9~ is MSB) shall correspond to the TFC index
(expressed in unsigned binary form) defined by the RRC layer to reference the
TFC of the CCTrCH in the associated radio frame.
The output TFCI code word bits b~i~ are given by:
{width="1.8055555555555556in" height="0.4722222222222222in"}
where _i_ = 0,...,31. N~TFCI\ code\ word~ = 32.
#### 4.3.1.2 Coding of short TFCI lengths
##### 4.3.1.2.1 Coding very short TFCIs by repetition
If the number of TFCI bits is 1 or 2, then repetition will be used for coding.
In this case each bit is repeated to a total of 4 times giving 4-bit
transmission (N~TFCI\ code\ word~ =4) for a single TFCI bit and 8-bit
transmission (N~TFCI\ code\ word~ =8) for 2 TFCI bits. The TFCI bit(s) a~0~
(or a~0~ and a~1~ where a~0~ is the LSB) shall correspond to the TFC index
(expressed in unsigned binary form) defined by the RRC layer to reference the
TFC of the CCTrCH in the associated radio frame.
In the case of N~TFCI\ code\ word~=4, the TFCI codeword {b~0~, b~1~, b~2~,
b~3~} is equal to the sequence {a~0~, a~0~, a~0~, a~0~}.
In the case of N~TFCI\ code\ word~=8, the TFCI codeword {b~0~, b~1~, ... ,
b~7~} is equal to the sequence {a~0~, a~1~, a~0~, a~1~, a~0~, a~1~, a~0~,
a~1~}.
##### 4.3.1.2.2 Coding short TFCIs using bi-orthogonal codes
If the number of TFCI bits is in the range 3 to 5 the TFCI is encoded using a
(16, 5) bi-orthogonal (or first order Reed-Muller) code. The coding procedure
is as shown in figure 7.
{width="4.759722222222222in" height="0.7951388888888888in"}
Figure 7: Channel coding of short length TFCI bits
If the TFCI consists of less than 5 bits, it is padded with zeros to 5 bits,
by setting the most significant bits to zero. The code words of the (16,5) bi-
orthogonal code are linear combinations of 5 basis sequences as defined in
table 9.
Table 9: Basis sequences for (16,5) TFCI code
* * *
i M~i,0~ M~i,1~ M~i,2~ M~i,3~ M~i,4~ 0 1 0 0 0 1 1 0 1 0 0 1 2 1 1 0 0 1 3 0 0
1 0 1 4 1 0 1 0 1 5 0 1 1 0 1 6 1 1 1 0 1 7 0 0 0 1 1 8 1 0 0 1 1 9 0 1 0 1 1
10 1 1 0 1 1 11 0 0 1 1 1 12 1 0 1 1 1 13 0 1 1 1 1 14 1 1 1 1 1 15 0 0 0 0 1
* * *
The TFCI bits a~0~ , a~1~ , a~2~ , a~3~ , a~4~ (where a~0~ is LSB and a~4~ is
MSB) shall correspond to the TFC index (expressed in unsigned binary form)
defined by the RRC layer to reference the TFC of the CCTrCH in the associated
radio frame.
The output code word bits b~j~ are given by:
{width="1.8055555555555556in" height="0.4722222222222222in"}
where _i_ = 0,...,15. N~TFCI\ code\ word~ = 16.
#### 4.3.1.3 Mapping of TFCI code word
The mapping of the TFCI code word to the TFCI bit positions in a timeslot
shall be as follows.
Denote the number of bits in the TFCI code word by N~TFCI\ code\ word~, denote
the TFCI code word bits by b~k~ where k=0... N~TFCI\ code\ word~ -1.
{width="3.5756944444444443in" height="1.4006944444444445in"}
Figure 8: Mapping of TFCI code word bits to timeslot
The locations of the first and second parts of the TFCI code word in the
timeslot is defined in [7].
If the shortest transmission time interval of any constituent TrCH is at least
20 ms the successive TFCI code words in the frames in the TTI shall be
identical. If TFCI is transmitted on multiple timeslots in a frame each
timeslot shall have the same TFCI code word.
### 4.3.2 Coding and Bit Scrambling of the Paging Indicator
The paging indicator P~q~, _q_ = 0, ..., _N_ ~PI~-1, P _~q~_ ∈ {0, 1} is an
identifier to instruct the UE whether there is a paging message for the groups
of mobiles that are associated to the PI, calculated by higher layers, and the
associated paging indicator P~q~. The length L~PI~ of the paging indicator is
L~PI~=2, L~PI~=4 or L~PI~=8 symbols. _N_ ~PIB~ = 2*_N_ ~PI~*_L_ ~PI~ bits are
used for the paging indicator transmission in one radio frame. The mapping of
the paging indicators to the bits _e~i~_ , _i_ = 1, ..., _N_ ~PIB~ is shown in
table 10.
Table 10: Mapping of the paging indicator
* * *
P~q~ Bits {_e_ ~2Lpi*q+1~, _e_ ~2Lpi*q+2~, ... ,_e_ ~2Lpi*(q+1)~ } Meaning 0
{0, 0, ..., 0} There is no necessity to receive the PCH 1 {1, 1, ..., 1} There
is the necessity to receive the PCH
* * *
If the number _S_ of bits in one radio frame available for the PICH is bigger
than the number _N_ ~PIB~ of bits used for the transmission of paging
indicators, the sequence _e_ = {_e_ ~1~, _e_ ~2~, ..., _e_ ~NPIB~} is extended
by _S_ -_N_ ~PIB~ bits that are set to zero, resulting in a sequence _h_ =
{_h_ ~1~, _h_ ~2~, ..., _h~S~_}:
The bits _h~k~_ , _k_ = 1, ..., _S_ on the PICH then undergo bit scrambling as
defined in section 4.2.9.
The bits _s~k~_ , _k_ = 1, ..., S output from the bit scrambler are then
transmitted over the air as shown in [7].
### 4.3.3 Coding and Bit Scrambling of the MBMS Notification Indicator
The MBMS notification indicator N~q~, _q_ = 0, ..., _N_ ~n~-1, N~q~ ∈ {0, 1},
is an identifier to instruct UEs whether there is an MBMS notification
indication for the groups of MBMS services that are associated to the NI,
calculated by higher layers, and the associated MBMS notification indicator
N~q~. The length L~NI~ of the MBMS notification indicator is L~NI~=2, L~NI~=4
or L~NI~=8 symbols. _N_ ~NIB~ = 2*_N_ ~n~*_L_ ~NI~ bits are used for the MBMS
notification indicator transmission in one MICH. The mapping of the MBMS
notification indicators to the bits _e~i~_ , _i_ = 1, ..., _N_ ~NIB~ is shown
in table 10A.
Table 10A: Mapping of the MBMS notification indicator
* * *
N~q~ Bits {_e_ ~2Lni*q+1~, _e_ ~2Lni*q+2~, ... ,_e_ ~2Lni*(q+1)~ } 0 {0, 0,
..., 0} 1 {1, 1, ..., 1}
* * *
If the number _S_ of bits available for the MICH is bigger than the number _N_
~NIB~ of bits used for the transmission of MBMS notification indicators, the
sequence _e_ = {_e_ ~1~, _e_ ~2~, ..., _e_ ~NNIB~} is extended by _S_ -_N_
~NIB~ bits that are set to zero, resulting in a sequence _h_ = {_h_ ~1~, _h_
~2~, ..., _h~S~_}:
The bits _h~k~_ , _k_ = 1, ..., _S_ on the MICH then undergo bit scrambling as
defined in section 4.2.9.
The bits _s~k~_ , _k_ = 1, ..., S output from the bit scrambler are then
transmitted over the air as shown in [7].
## 4.4 Coding for layer 1 control for the 1.28 Mcps option
### 4.4.1 Coding of transport format combination indicator (TFCI) for QPSK and
16QAM
The coding of TFCI for 1.28Mcps TDD is same as that of 3.84Mcps TDD.cf.[4.3.1
\'Coding of transport format combination indicator\'].
#### 4.4.1.1 Mapping of TFCI code word
Denote the number of bits in the TFCI code word by N~TFCI\ code\ word~, and
denote the TFCI code word bits by b~k~, where k = 0, ..., N~TFCI\ code\ word~
-1
When the number of bits in the TFCI code word is 8, 16, 32, the mapping of the
TFCI code word to the TFCI bit positions shall be as follows:
{width="5.093055555555556in" height="1.854861111111111in"}
Figure 9: Mapping of TFCI code word bits to TFCI position in 1.28 Mcps TDD
option,\ where N = N~TFCI\ code\ word~.
For MBSFN transmissions with 16QAM, the coded bits _b~k~_ , are mapped to the
transmitted TFCI bits according to the following two group formulas:
Formula a, mapping onto the outer-corners of the 16QAM constellation
_d~4k~_ = _b_ ~2k~ _,_
_d~4k+1~_ = _b~2k~_ ~+1~ ,
_d~4k+2~_ = _1,_
_d~4k+3~_ = _1,_
Formula b, mapping onto the inner-corners of the 16QAM constellation
_d~4k~_ = _b_ ~2k~ _,_
_d~4k+1~_ = _b~2k~_ ~+1~ ,
_d~4k+2~_ =_0,_
_d~4k+3~_ = _0,_
The 1^st^, the 3^rd^, the 5^th^ and the 7^th^ part of TFCI code word will use
the Mapping Formula a, and the 2^nd^, the 4^th^, the 6^th^ and the 8^th^ part
of TFCI code word will use the Mapping Formula b. As the TTI of S-CCPCH is
40ms or 80ms, the TFCI bits will be repeated with a period of 20ms frame. In
the second 20ms frame, the 1^st^, the 3^rd^, the 5^th^ and the 7^th^ part of
TFCI code word will use the Mapping Formula b, and the 2^nd^, the 4^th^, the
6^th^ and 8^th^ part of TFCI code word will use the Mapping Formula a, and so
on for the consecutive frames. The mapping of the TFCI code word to the TFCI
bit positions shall be as follows:
Figure 9A: Mapping of TFCI code word bits to TFCI position in 1.28 Mcps TDD
option for downlink MBSFN, where N = N~TFCI\ code\ word~.
When the number of bits of the TFCI code word is 4 , then the TFCI code word
is equally divided into two parts for the consecutive two subframe and mapped
onto the end of the first data field in each of the consecutive subframes.The
mapping for N~TFCI\ code\ word~ =4 is shown in figure 10:
{width="4.263194444444444in" height="2.4756944444444446in"}
Figure 10: Mapping of TFCI code word bits to TFCI position in 1.28 Mcps TDD
option,\ when N~TFCI\ code\ word.~=4
The location of the 1st to 4th parts of the TFCI code word in the timeslot is
defined in [7].
If the shortest transmission time interval of any constituent TrCH is at least
20 ms, then successive TFCI code words in the frames within the TTI shall be
identical. If a TFCI is transmitted on multiple timeslots in a frame each
timeslot shall have the same TFCI code word.
### 4.4.2 Coding of transport format combination indicator (TFCI) for 8PSK
Encoding of TFCI bits depends on the number of them and the modulation in use.
When 2 Mcps service is transmitted, 8PSK modulation is applied in 1.28 Mcps
TDD option. The encoding scheme for TFCI when the number of bits are 6 -- 10,
and less than 6 bits is described in section 4.4.2.1 and 4.4.2.2,
respectively.
#### 4.4.2.1 Coding of long TFCI lengths
When the number of TFCI bits is 6 -- 10, the TFCI bits are encoded by using a
(64,10) sub-code of the second order Reed-Muller code, then 16 bits out of 64
bits are punctured (Puncturing positions are 0, 4, 8, 13, 16, 20, 27, 31, 34,
38, 41, 44, 50, 54, 57, 61^st^ bits). The coding procedure is shown in Figure
11.
{width="5.513194444444444in" height="2.2736111111111112in"}
Figure 11: Channel coding of long TFCI bits for 8PSK
If the TFCI consists of less than 10 bits, it is padded with zeros to 10 bits,
by setting the most significant bits to zero. The code words of the punctured
(48,10) sub-code of the second order Reed-Muller codes are linear combination
of 10 basis sequences. The basis sequences are shown in Table 11.
Table 11: Basis sequences for (48,10) TFCI code
* * *
I M~i,0~ M~i,1~ M~i,2~ M~i,3~ M~I,4~ M~i,5~ M~i,6~ M~I,7~ M~I,8~ M~i,9~ 0 1 0
0 0 0 0 1 0 1 0 1 0 1 0 0 0 0 1 1 0 0 2 1 1 0 0 0 0 1 1 0 1 3 1 0 1 0 0 0 1 1
1 0 4 0 1 1 0 0 0 1 0 1 0 5 1 1 1 0 0 0 1 1 1 0 6 1 0 0 1 0 0 1 1 1 1 7 0 1 0
1 0 0 1 1 0 1 8 1 1 0 1 0 0 1 0 1 0 9 0 0 1 1 0 0 1 1 0 0 10 0 1 1 1 0 0 1 1 0
1 11 1 1 1 1 0 0 1 1 1 1 12 1 0 0 0 1 0 1 0 1 1 13 0 1 0 0 1 0 1 1 1 0 14 1 1
0 0 1 0 1 0 0 1 15 1 0 1 0 1 0 1 0 1 1 16 0 1 1 0 1 0 1 1 0 0 17 1 1 1 0 1 0 1
1 1 0 18 0 0 0 1 1 0 1 0 0 1 19 1 0 0 1 1 0 1 0 1 1 20 0 1 0 1 1 0 1 0 1 0 21
0 0 1 1 1 0 1 0 1 0 22 1 0 1 1 1 0 1 1 0 1 23 0 1 1 1 1 0 1 1 1 0 24 0 0 0 0 0
1 1 1 0 1 25 1 0 0 0 0 1 1 1 1 0 26 1 1 0 0 0 1 1 1 1 1 27 0 0 1 0 0 1 1 0 1 1
28 1 0 1 0 0 1 1 1 0 1 29 1 1 1 0 0 1 1 0 1 1 30 0 0 0 1 0 1 1 0 0 1 31 0 1 0
1 0 1 1 0 0 1 32 1 1 0 1 0 1 1 1 1 1 33 1 0 1 1 0 1 1 0 0 1 34 0 1 1 1 0 1 1 1
1 0 35 1 1 1 1 0 1 1 1 0 1 36 0 0 0 0 1 1 1 1 1 0 37 1 0 0 0 1 1 1 0 1 1 38 1
1 0 0 1 1 1 1 1 1 39 0 0 1 0 1 1 1 1 0 0 40 1 0 1 0 1 1 1 1 0 0 41 1 1 1 0 1 1
1 1 1 1 42 0 0 0 1 1 1 1 1 1 1 43 0 1 0 1 1 1 1 0 1 0 44 1 1 0 1 1 1 1 0 1 0
45 0 0 1 1 1 1 1 0 1 1 46 0 1 1 1 1 1 1 0 0 1 47 1 1 1 1 1 1 1 1 0 0
* * *
Let\'s define the TFCI bits as a~0~ , a~1~ , a~2~ , a~3~ , a~4~ , a~5~ , a~6~
, a~7~ , a~8~ , a~9~, where a~0~ is the LSB and a~9~ is the MSB. The TFCI bits
shall correspond to the TFC index (expressed in unsigned binary form) defined
by the RRC layer to reference the TFC of the CCTrCH in the associated radio
frame.
The output TFCI code word bits b~i~ are given by:
{width="1.8055555555555556in" height="0.4722222222222222in"}
where i=0...47. N~TFCI\ code\ word~ =48.
#### 4.4.2.2 Coding of short TFCI lengths
##### 4.4.2.2.1 Coding very short TFCIs by repetition
When the number of TFCI bits is 1 or 2, then repetition will be used for the
coding. In this case, each bit is repeated to a total of 6 times giving 6-bit
transmission (N~TFCI\ code\ word~ = 6) for a single TFCI bit and 12-bit
transmission (N~TFCI\ code\ word~ = 12) for 2 TFCI bits. The TFCI bit(s) a~0~
(or a~0~ and a~1~ where a~0~ is the LSB) shall correspond to the TFC index
(expressed in unsigned binary form) defined by the RRC layer to reference the
TFC of the CCTrCH in the associated radio frame.
In the case of N~TFCI\ code\ word~=6, the TFCI codeword {b~0~, b~1~, b~2~,
b~3~, b~4~, b~5~} is equal to the sequence {a~0~, a~0~, a~0~, a~0~, a~0~,
a~0~}.
In the case of N~TFCI\ code\ word~=12, the TFCI codeword {b~0~, b~1~, ... ,
b~11~} is equal to the sequence {a~0~, a~1~, a~0~, a~1~, a~0~, a~1~, a~0~,
a~1~, a~0~, a~1~, a~0~, a~1~}.
##### 4.4.2.2.2 Coding short TFCIs using bi-orthogonal codes
If the number of TFCI bits is in the range of 3 to 5, the TFCI bits are
encoded using a (32,5) first order Reed-Muller code, then 8 bits out of 32
bits are punctured (Puncturing positions are 0, 1, 2, 3, 4, 5, 6, 7^th^ bits).
The coding procedure is shown in Figure 12.
{width="5.569444444444445in" height="2.4652777777777777in"}
Figure 12: Channel coding of short TFCI bits for 8PSK
If the TFCI consists of less than 5 bits, it is padded with zeros to 5 bits,
by setting the most significant bits to zero. The code words of the punctured
(32,5) first order Reed-Muller codes are linear combination of 5 basis
sequences shown in Table 12.
Table 12: Basis sequences for (24,5) TFCI code
* * *
I M~i,0~ M~i,1~ M~i,2~ M~i,3~ M~i,4~ 0 0 0 0 1 0 1 1 0 0 1 0 2 0 1 0 1 0 3 1 1
0 1 0 4 0 0 1 1 0 5 1 0 1 1 0 6 0 1 1 1 0 7 1 1 1 1 0 8 0 0 0 0 1 9 1 0 0 0 1
10 0 1 0 0 1 11 1 1 0 0 1 12 0 0 1 0 1 13 1 0 1 0 1 14 0 1 1 0 1 15 1 1 1 0 1
16 0 0 0 1 1 17 1 0 0 1 1 18 0 1 0 1 1 19 1 1 0 1 1 20 0 0 1 1 1 21 1 0 1 1 1
22 0 1 1 1 1 23 1 1 1 1 1
* * *
Let\'s define the TFCI bits as a~0~ , a~1~ , a~2~ , a~3~ , a~4~, where a~0~ is
the LSB and a~4~ is the MSB. The TFCI bits shall correspond to the TFC index
(expressed in unsigned binary form) defined by the RRC layer to reference the
TFC of the CCTrCH in the associated radio frame.
The output code word bits b~i~ are given by:
{width="1.7638888888888888in" height="0.4722222222222222in"}
where i=0...23. N~TFCI\ code\ word~ =24.
#### 4.4.2.3 Mapping of TFCI code word
Denote the number of bits in the TFCI code word by N~TFCI\ code\ word~, and
denote the TFCI code word bits by b~k~, where k = 0, ..., N~TFCI\ code\ word~
-1.
When the number of bits in the TFCI code word is 12, 24 or 48, the mapping of
the TFCI code word to the TFCI bit positions in a time slot shall be as
follows.
{width="5.093055555555556in" height="1.8645833333333333in"}
Figure 13: Mapping of TFCI code word bits to timeslot in 1.28 Mcps TDD
option,\ where N = N~TFCI\ code\ word~.
When the number of bits in the TFCI code word is 6, the TFCI code word is
equally divided into two parts for the consecutive two sub-frames and mapped
onto the first data field in each of the consecutive sub-frames. The mapping
of the TFCI code word to the TFCI bit positions in a time slot shall be as
shown in figure 14.
{width="5.35625in" height="1.9680555555555554in"}
Figure 14: Mapping of TFCI code word bits to timeslot in 1.28 Mcps TDD option
when N~TFCI\ code\ word~ = 6
The location of the 1st to 4th parts of the TFCI code word in the timeslot is
defined in [7].
### 4.4.3 Coding and Bit Scrambling of the Paging Indicator
The paging indicator P~q~, _q_ = 0, ..., _N_ ~PI~-1, P _~q~_ ∈ {0, 1} is an
identifier to instruct the UE whether there is a paging message for the groups
of mobiles that are associated to the PI, calculated by higher layers, and the
associated paging indicator P~q~. The length L~PI~ of the paging indicator is
L~PI~=2, L~PI~=4 or L~PI~=8 symbols. _N_ ~PIB~ = 2*_N_ ~PI~*_L_ ~PI~ bits are
used for the paging indicator transmission in one radio frame. The mapping of
the paging indicators to the bits _e~i~_ , _i_ = 1, ..., _N_ ~PIB~ is shown in
table 13.
Table 13: Mapping of the paging indicator
* * *
P~q~ Bits {_e_ ~2LPI*q+1~, _e_ ~2LPI*q+2~, ... ,_e_ ~2LPI*(q+1)~ } Meaning 0
{0, 0, ..., 0} There is no necessity to receive the PCH 1 {1, 1, ..., 1} There
is the necessity to receive the PCH
* * *
If the number _S_ of bits in one radio frame available for the PICH is bigger
than the number _N_ ~PIB~ of bits used for the transmission of paging
indicators, the sequence _e_ = {_e_ ~1~, _e_ ~2~, ..., _e_ ~NPIB~} is extended
by _S_ -_N_ ~PIB~ bits that are set to zero, resulting in a sequence _h_ =
{_h_ ~1~, _h_ ~2~, ..., _h~S~_}:
The bits _h~k~_ , _k_ = 1, ..., _S_ on the PICH then undergo bit scrambling as
defined in section 4.2.9.
The bits _s~k~_ , _k_ = 1, ..., S output from the bit scrambler are then
transmitted over the air as shown in [7].
### 4.4.4 Coding of the Fast Physical Access Channel (FPACH) information bits
The FPACH burst is composed by 32 information bits which are block coded and
convolutional coded, and then delivered in one sub-frame as follows:
1\. The 32 information bits are protected by 8 parity bits for error detection
as described in sub-clause 4.2.1.1.
2\. Convolutional code with constraint length 9 and coding rate ½ is applied
as described in sub-clause 4.2.3.1. The size of data block c(k) after
convolutional encoder is 96 bits.
3\. To adjust the size of the data block c(k) to the size of the FPACH burst,
8 bits are punctured as described in sub-clause 4.2.7 with the following
clarifications:
\- N _~i;j~_ =96 is the number of bits in a radio sub-frame before rate
matching
\- ∆N _~i,,j~_ = -8 is the number of bits to punctured in a radio sub-frame
\- e~ini~ = a x N _~ij~_
The 88 bits after rate matching are then delivered to the intra-frame
interleaving.
4\. The bits in input to the interleaving unit are denoted as {x(0), ...,
x(87)}. The coded bits are block rectangular interleaved according to the
following rule: the input is written row by row, the output is read column by
column.
{width="2.2916666666666665in" height="1.0in"}
Hence, the interleaved sequence is denoted by y (i) and are given by:
y(0), y(1), ..., y(87)=x(0), x(8), ...,x(80),x(1), ..., x(87).
### 4.4.5 Coding and Bit Scrambling of the MBMS Notification Indicator
The MBMS notification indicator N~q~, _q_ = 0, ..., _N_ ~n~-1, N _~q~_ ∈ {0,
1} is an identifier to instruct the UE whether there is an MBMS notification
indication for the groups of MBMS services that are associated to the NI,
calculated by higher layers, and the associated MBMS notification indicator
N~q~. The length L~NI~ of the MBMS notification indicator is L~NI~=2, L~NI~=4
or L~NI~=8 symbols. _N_ ~NIB~ = 2*_N_ ~n~*_L_ ~NI~ bits are used for the MBMS
notification indicator transmission in one MICH. The mapping of the MBMS
notification indicators to the bits _e~i~_ , _i_ = 1, ..., _N_ ~NIB~ is shown
in table 13A.
Table 13A: Mapping of the MBMS notification indicator
* * *
N~q~ Bits {_e_ ~2LNI*q+1~, _e_ ~2LNI*q+2~, ... ,_e_ ~2LNI*(q+1)~ } 0 {0, 0,
..., 0} 1 {1, 1, ..., 1}
* * *
If the number _S_ of bits available for the MICH is bigger than the number _N_
~NIB~ of bits used for the transmission of MBMS notification indicators, the
sequence _e_ = {_e_ ~1~, _e_ ~2~, ..., _e_ ~NNIB~} is extended by _S_ -_N_
~NIB~ bits that are set to zero, resulting in a sequence _h_ = {_h_ ~1~, _h_
~2~, ..., _h~S~_}:
The bits _h~k~_ , _k_ = 1, ..., _S_ on the MICH then undergo bit scrambling as
defined in section 4.2.9.
The bits _s~k~_ , _k_ = 1, ..., S output from the bit scrambler are then
transmitted over the air as shown in [7].
### 4.4.6 Coding of PLCCH
The PLCCH is a Node-B terminated channel used to carry dedicated (UE-specific)
TPC and SS information to multiple UEs. Each TPC/SS command pair for a given
UE is mapped to 3 bits as shown in table 13B.
Table 13B: Mapping of the TPC/SS pair
* * *
3-bit TPC/SS command (MSB on left) TPC command SS command 000 'DOWN' 'DOWN'
100 'UP' 'DOWN' 011 'DOWN' 'UP' 111 'UP' 'UP' 001 'DOWN' 'Do Nothing' 101 'UP'
'Do Nothing'
* * *
Let _I=14_ be the number of TPC/SS command pairs that can be carried by a
single PLCCH. The 3 bits corresponding to the _i^th^_ TPC/SS command pair (
_i=1...I_ ), are denoted {$Β_{0}^{i}$, $Β_{1}^{i}$, $Β_{2}^{i}$} where
$Β_{0}^{i}$ is the MSB.
The bit sequence corresponding to the _I=14_ TPC/SS command pairs is denoted
$\alpha_{k}$ (_k = 0,1,2,...41_). $Β_{n}^{i}$ (_n=0,1,2_) is mapped to
$\alpha_{k}$ such that:
The PLCCH burst is composed of 44 information bits {_b~plcch~(0),
b~plcch~(1),...,b~plcch~(43)_} which are repetition coded, and then delivered
in one sub-frame as follows:
1\. _b~plcch~(m)=_ $\alpha_{m}$ (_for m=0,1,...41_) and _b~plcch~(m) = 0_
(_for m=42,43_)
2\. Repetition coding with code rate ½ is applied to the sequence
{_b~plcch~(0),...,b~plcch~(43)_} in order to form the sequence {_x(0), x(1),
x(2), x(3),..., x(86), x(87)_}. The size of the data block after the
repetition encoder is 88 bits. The encoded codeword {_x(0), x(1), x(2),
x(3),...,x(86), x(87)_} is equal to {_b~plcch~ (0), b~plcch~ (0), b~plcch~
(1), b~plcch~ (1),...,b~plcch~ (43), b~plcch~ (43)_}_._
3\. The bits output from the repetition encoder {_x(0), ..., x(87)_} are input
to an interleaving unit. The coded bits are block rectangular interleaved
according to the following rule: the input is written row by row, the output
is read column by column.
{width="2.2916666666666665in" height="1.0in"}
Hence, the interleaved sequence is denoted by _y(i)_ and is given by:
y(0), y(1), ..., y(87) = x(0), x(8), ..., x(80), x(1), ..., x(87).
The bit sequence y(0), y(1), ... y(87) is mapped to the PLCCH burst in order
of bit index, with the lowest bit index being the first bit (in time) to be
transmitted.
## 4.5 Coding for HS-DSCH
Figure 15 illustrates the overall concept of transport-channel coding for HS-
DSCH. Data arrives at the coding unit in the form of one transport block once
every TTI. The TTI is 5 ms for 1.28 Mcps TDD and 10 ms for 3.84 Mcps TDD /
7.68Mcps TDD.
For 1.28 Mcps TDD, in the case of multiple-frequency transmission in one TTI,
a number of transport blocks arrive at the coding unit, in which the number of
transport blocks equals the number of frequencies used. Each transport block
for each frequency shall be coded separately as the following coding step.
For 1.28Mcps TDD, in the case of MIMO dual stream transmission in one TTI, two
transport blocks arrive at the coding unit. Each transport block for each data
stream shall be coded separately as the following coding step.
The following coding steps for HS-DSCH can be identified:
\- add CRC to each transport block (see subclause 4.5.1);
\- code block segmentation (see subclause 4.5.2);
\- channel coding (see subclause 4.5.3);
\- hybrid ARQ (see subclause 4.5.4);
\- bit scrambling (see subclause 4.5.5);
\- interleaving for HS-DSCH (see subclause 4.5.6);
\- constellation re-arrangement for 16QAM and 64QAM (see subclause 4.5.7);
\- mapping to physical channels (see subclause 4.5.8).
The coding steps for HS-DSCH are shown in figure 15.
Figure 15: Coding chain for HS-DSCH
In the following the number of transport blocks is always one. When
referencing non HS-DSCH formulae which are used in correspondence with HS-DSCH
formulae the convention is used that transport block subscripts may be omitted
(e.g. X~i~ when i is always 1 may be written X).
### 4.5.1 CRC attachment for HS-DSCH
A CRC of size 24 bits is calculated and added per HS-DSCH TTI. The CRC
polynomial is defined in 4.2.1.1 with the following specific parameters: _i_ =
1, _L~1~_ = 24 bits.
### 4.5.2 Code block segmentation for HS-DSCH
Code block segmentation for the HS-DSCH transport channel shall be done with
the general method described in 4.2.2.2 above with the following specific
parameters.
There will only be one transport block, _i_ = 1. The bits _b~im1~, b~im2~,
b~im3~,...b~imB~_ input to the block are mapped to the bits _x~i1~, x~i2~,
x~i3~,...x~iX1~_ directly. It follows that _X~1~_ = _B_. Note that the bits
_x_ referenced here refer only to the internals of the code block segmentation
function. The output bits from the code block segmentation function are
_o~ir1~, o~ir2~, o~ir3~,...o~irK~_.
The value of Z = 5114 for turbo coding shall be used.
### 4.5.3 Channel coding for HS-DSCH
Channel coding for the HS-DSCH transport channel shall be done with the
general method described in 4.2.3 above with the following specific
parameters.
There will be a maximum of one transport block, _i_ = 1. The rate 1/3 turbo
coding shall be used.
### 4.5.4 Hybrid ARQ for HS-DSCH
The hybrid ARQ functionality matches the number of bits at the output of the
channel coder to the total number of bits of the HS-PDSCH set to which the HS-
DSCH is mapped. The hybrid ARQ functionality is controlled by the redundancy
version (RV) parameters. The exact set of bits at the output of the hybrid ARQ
functionality depends on the number of input bits, the number of output bits,
and the RV parameters.
The hybrid ARQ functionality consists of two rate-matching stages and a
virtual buffer as shown in the figure below.
The first rate matching stage matches the number of input bits to the virtual
IR buffer, information about which is provided by higher layers. Note that, if
the number of input bits does not exceed the virtual IR buffering capability,
the first rate-matching stage is transparent.
The second rate matching stage matches the number of bits after first rate
matching stage to the number of physical channel bits available in the HS-
PDSCH set in the TTI.
Figure 16: HS-DSCH hybrid ARQ functionality
#### 4.5.4.1 HARQ bit separation
The HARQ bit separation function shall be performed in the same way as bit
separation for turbo encoded TrCHs in 4.2.7.2 above.
#### 4.5.4.2 HARQ First Rate Matching Stage
HARQ first stage rate matching for the HS-DSCH transport channel shall be done
with the general method described in 4.2.7.1.2 above with the following
specific parameters.
The maximum number of soft channel bits available in the virtual IR buffer is
N~IR~ which is signalled from higher layers for each HARQ process. The number
of coded bits in a TTI before rate matching is N^TTI^ this is deduced from
information signalled from higher layers and parameters signalled on the HS-
SCCH for each TTI. Note that HARQ processing and physical layer storage occurs
independently for each HARQ process currently active.
If N~IR~ is greater than or equal to N^TTI^ (i.e. all coded bits of the
corresponding TTI can be stored) the first rate matching stage shall be
transparent. This can, for example, be achieved by setting _e~minus~_ = 0.
Note that no repetition is performed.
If N~IR~ is smaller than N^TTI^ the parity bit streams are punctured as in
4.2.7.1.2 above by setting the rate matching parameter
$\text{ΔN}_{\text{il}}^{\text{TTI}} = N_{\text{IR}} - N^{\text{TTI}}$where the
subscripts i and l refer to transport channel and transport format in the
referenced sub-clause. Note the negative value is expected when the rate
matching implements puncturing. Bits selected for puncturing which appear as δ
in the algorithm in 4.2.7 above shall be discarded and not counted in the
totals for the streams through the virtual IR buffer.
#### 4.5.4.3 HARQ Second Rate Matching Stage
HARQ second stage rate matching for the HS-DSCH transport channel shall be
done with the general method described in 4.2.7.3 above with the following
specific parameters. Bits selected for puncturing which appear as _δ_ in the
algorithm in 4.2.7.3 above shall be discarded and are not counted in the
streams towards the bit collection.
The parameters of the second rate matching stage depend on the value of the RV
parameters s and r. The parameter s can take the value 0 or 1 to distinguish
between transmissions that prioritise systematic bits (s = 1) and non
systematic bits (s = 0). The parameter r (range 0 to _r~max~-1_) changes the
initial error variable _e~ini~_ in the case of puncturing. In case of
repetition both parameters _r_ and _s_ change the initial error variable
_e~ini~_. The parameters X~i~, e~plus~ and e~minus~ are calculated as per
table 14below.
Denote the number of bits before second rate matching as _N~sys~_ for the
systematic bits, _N~p1~_ for the parity 1 bits, and _N~p2~_ for the parity 2
bits, respectively. For the HS-DSCH, denote the number of timeslots used as
_T_ , the number of codes per timeslot as _C_ and the number of bits available
in timeslot _t_ as _U~t~_ , where _U~t~_ = $\sum_{p = 1}^{C}U_{t,p}$ and
$U_{t,p}$ is the number of bits available in physical channel $p$ of timeslot
_t_ as defined in [7]. _N~data~_ is the number of bits available to the HS-
DSCH in one TTI and is defined as $N_{\text{data}} = \sum_{t = 1}^{T}U_{t}$.
The rate matching parameters are determined as follows.
For $N_{\text{data}} \leq N_{\text{sys}} + N_{p1} + N_{p2}$, puncturing is
performed in the second rate matching stage. The number of transmitted
systematic bits in a transmission is $N_{t,\text{sys}} = \text{min}\left{
N_{\text{sys}},N_{\text{data}} \right}$ for a transmission that prioritises
systematic bits and $N_{t,\text{sys}} = \text{max}\left{ N_{\text{data}} -
\left( N_{p1} + N_{p2} \right),0 \right}$ for a transmission that prioritises
non systematic bits.
For $N_{\text{data}} > N_{\text{sys}} + N_{p1} + N_{p2}$ repetition is
performed in the second rate matching stage. A similar repetition rate in all
bit streams is achieved by setting the number of transmitted systematic bits
to $N_{t,\text{sys}} = \left\lfloor N_{\text{sys}} \cdot
\frac{N_{\text{data}}}{N_{\text{sys}} + 2N_{p1}} \right\rfloor$.
The number of parity bits in a transmission is: $N_{t,p1} = \left\lfloor
\frac{N_{\text{data}} - N_{t,\text{sys}}}{2} \right\rfloor$ and $N_{t,p2} =
\left\lceil \frac{N_{\text{data}} - N_{t,\text{sys}}}{2} \right\rceil$ for the
parity 1 and parity 2 bits, respectively.
Table 14 below summarizes the resulting parameter choice for the second rate
matching stage.
Table 14: Parameters for HARQ second rate matching
* * *
                *X~i~*   *e~plus~*   *e~minus~*
Systematic\  
RM S
Parity 1\  
RM P1_2
Parity 2\  
RM P2_2
* * *
The rate matching parameter _e~ini~_ is calculated for each bit stream
according to the RV parameters r and s using
$e_{\text{ini}}(r) = \left{ \left( X_{i} - \left\lfloor \frac{r \cdot
e_{\text{plus}}}{r_{\text{max}}} \right\rfloor - 1 \right)\
\text{mod}e_{\text{plus}} \right} + 1$ in the case of puncturing,
i.e.,$N_{\text{data}} \leq N_{\text{sys}} + N_{p1} + N_{p2}$, and
$e_{\text{ini}}(r) = \left{ \left( X_{i} - \left\lfloor (s + 2 \cdot r\frac{)
\cdot e_{\text{plus}}}{(}2 \cdot r_{\text{max}}) \right\rfloor - 1 \right)\
\text{mod}e_{\text{plus}} \right} + 1$ for repetition, i.e.,$N_{\text{data}} >
N_{\text{sys}} + N_{p1} + N_{p2}$.
Where and is the total number of redundancy versions allowed by varying as
defined in 4.6.1.4.
Note that r~max~ varies depending on the modulation mode, i.e. for 16QAM and
64QAM _r~max~_ = 2 and for QPSK _r~max~_ = 4.
Note: For the modulo operation the following clarification is used: the value
of (x mod y) is strictly in the range of 0 to _y_ -1 (i.e. -1 mod 10 = 9).
#### 4.5.4.4 HARQ bit collection
The HARQ bit collection is achieved using a rectangular interleaver of size .
The number of rows and columns are determined from:
$N_{\text{row}} = 6$ for 64QAM
$N_{\text{row}} = 4$ for 16QAM
$N_{\text{row}} = 2$ for QPSK
$N_{\text{col}} = \frac{N_{\text{data}}}{N_{\text{row}}}$
where _N~data~_ is used as defined in 4.5.4.3 above.
Data is written into the interleaver column by column, and read out of the
interleaver column by column, starting from the first column.
_N~t,sys~_ is the number of transmitted systematic bits. Intermediate values
_N~r~_ and _N~c~_ are calculated using:
$N_{r} = \left\lfloor \frac{N_{t,\text{sys}}}{N_{\text{col}}} \right\rfloor$
and $N_{c} = N_{t,\text{sys}} - N_{r} \cdot N_{\text{col}}$.
If _N~c\ ~_ = 0 and _N~r~_ > 0, the systematic bits are written into rows
1..._N~r~_.
Otherwise systematic bits are written into rows 1..._N~r~+1_ in the first
_N~c~_ columns and, if _N~r\ ~_ > 0, also into rows 1..._N~r~_ in the
remaining _N~col~-N~c~_ columns.
The remaining space is filled with parity bits. The parity bits are written
column wise into the remaining rows of the respective columns. Parity 1 and 2
bits are written in alternating order, starting with a parity 2 bit in the
first available column with the lowest index number.
In the case of 64QAM for each column the bits are read out of the interleaver
in the order row1, row2, row3, row4, row 5, row6. In the case of 16QAM for
each column the bits are read out of the interleaver in the order row 1, row
2, row 3, row 4. In the case of QPSK for each column the bits are read out of
the interleaver in the order row1, row2.
### 4.5.5 Bit scrambling
The bit scrambling for HS-DSCH shall be done with the general method described
in subclause 4.2.9.
### 4.5.6 Interleaving for HS-DSCH
The interleaving for TDD is done over all bits in the TTI, as shown in figure
17 when QPSK modulation is being used for the HS-DSCH, and figure 18 when
16-QAM modulation is being used, and figure 18a when 64QAM modulation is being
used. The bits input to the block interleaver are denoted by _s~1~, s~2~,
s~3~, ..., s~R~_ , where _R_ is the number of bits in one TTI.
Figure 17: Interleaver structure for HS-DSCH with QPSK modulation
For QPSK, the interleaver is a block interleaver and consists of bits input to
a matrix with padding, the inter-column permutation for the matrix and bits
output from the matrix with pruning. The output bit sequence from the block
interleaver is derived as follows:
(1) The number of columns of the matrix is 30. The columns of the matrix are
numbered 0, 1, 2, ..., 29 from left to right.
(2) Determine the number of rows of the matrix, _R2_ , by finding minimum
integer _R2_ such that _R_ ≤ 30 × _R2_. The rows of rectangular matrix are
numbered 0, 1, 2, ..., _R2_ \-- 1 from top to bottom.
> (3) Write the input bit sequence _s~1~, s~2~, s~3~, ..., s~R~_ into the _R2_
> × 30 matrix row by row starting with bit _y~1~_ in column 0 of row 0:
$\begin{bmatrix} y_{1} & y_{2} & y_{3} & \text{.}\text{.}\text{.} &
y_{\text{30}} \ y_{\text{31}} & y_{\text{32}} & y_{\text{33}} &
\text{.}\text{.}\text{.} & y_{\text{60}} \ \vdots & \vdots & \vdots & & \vdots
\ y_{\text{30} \cdot (R2 - 1) + 1} & y_{\text{30} \cdot (R2 - 1) + 2} &
y_{\text{30} \cdot (R2 - 1) + 3} & \text{.}\text{.}\text{.} & y_{\text{30}
\cdot R2} \ \end{bmatrix}$
> where _y~k~ = s~k~_ for _k_ = 1, 2, ..., _R_ and, if _R_ \ bits are inserted for _k_ = _R_ +1, _R_ +2, ..., 30× _R2_. These dummy bits
> are pruned away from the output of the matrix after the inter-column
> permutation.
(4) Perform the inter-column permutation for the matrix based on the pattern
$\left\langle P2(j) \right\rangle_{j \in \left{
0,1,\text{.}\text{.}\text{.},\text{29} \right}}$ that is shown in Table 7,
where P2(_j_) is the original column position of the _j_ -th permuted column.
After permutation of the columns, the bits are denoted by _y'~k~_.
$\begin{bmatrix} y'_{1} & y'_{R2 + 1} & y'_{2 \cdot R2 + 1} &
\text{.}\text{.}\text{.} & y'_{\text{29} \cdot R2 + 1} \ y'_{2} & y'_{R2 + 2}
& y'_{2 \cdot R2 + 2} & \text{.}\text{.}\text{.} & y'_{\text{29} \cdot R2 + 2}
\ \vdots & \vdots & \vdots & & \vdots \ y'_{R2} & y'_{2 \cdot R2} & y'_{3
\cdot R2} & \text{.}\text{.}\text{.} & y'_{\text{30} \cdot R2} \
\end{bmatrix}$
(5) The output of the block interleaver is the bit sequence read out column by
column from the inter-column permuted _R2_ ×30 matrix. The output is pruned by
deleting dummy bits that were padded to the input of the matrix before the
inter-column permutation, i.e. bits _y'~k~_ that corresponds to bits _y~k~_
with _k > R_ are removed from the output. The bits after interleaving are
denoted by _v~1~, v~2~, v~3~, ..., v~R~_ , where _v~1~_ corresponds to the bit
_y'~k~_ with smallest index _k_ after pruning, _v~2~_ to the bit _y'~k~_ with
second smallest index _k_ after pruning, and so on.
Figure 18: Interleaver structure for HS-DSCH with 16-QAM modulation
For 16QAM, a second identical interleaver operates in parallel to the first.
For both interleavers, _R2_ is chosen to be the minimum integer that satisfies
_R_ ≤ 60 × _R2._ The output bits from the bit scrambling operation are divided
pairwise between the interleavers: bits _s~k~_ and _s~k+1~_ go to the first
interleaver and bits _s~k+2~_ and _s~k+3~_ go to the second interleaver, where
_k_ mod 4 = 1. Bits are collected pairwise from the interleavers: bits _v~k~_
and _v~k+1~_ are obtained from the first interleaver and bits _v~k+2~_ and
_v~k+3~_ are obtained from the second interleaver, where again k mod 4 = 1.
Figure 18a: Interleaver structure for HS-DSCH with 64-QAM modulation
The interleaving for TDD is done over all bits in the TTI, as shown in figure
18a when 64QAM modulation is being used for the HS-DSCH. The bits input to the
block interleaver are denoted by _s~1~, s~2~, s~3~, ..., s~R~_ , where _R_ is
the number of bits in one TTI.
For 64QAM, two identical interleavers operate in parallel to the first. For
all interleavers, _R2_ is chosen to be the minimum integer that satisfies _R_
≤ 90 × _R2._ The output bits from the bit scrambling operation are divided
into three parts of different interleavers: bits _s~k~_ and _s~k+1~_ go to the
first interleaver, bits _s~k+2~_ and _s~k+3~_ go to the second interleaver and
bits _s~k+4~_ and _s~k+5~_ go to the third interleaver, where _k_ mod 6 = 1.
Bits are collected accordingly from the interleavers: bits _v~k~_ and _v~k+1~_
are obtained from the first interleaver, bits _v~k+2~_ and _v~k+3~_ are
obtained from the second interleaver and bits _v~k+4~_ and _v~k+5~_ are
obtained from the third interleaver, where again k mod 6 = 1.
### 4.5.7 Constellation re-arrangement for 16 QAM and 64 QAM
This function only applies to 16 QAM modulated bits. In case of QPSK it is
transparent.
The following table 15 describes the operations that produce the different
rearrangements.
The bits of the input sequence are mapped in groups of 4 so that _v~k~,
v~k+1~, v~k+2~, v~k+3~_ are used, where k mod 4 = 1.
Table 15: Constellation re-arrangement for 16 QAM
+----------------------+---------------------+----------------------+ | Constellation | Output bit sequence | Operation | | version | | | | | | | | parameter _b_ | | | +----------------------+---------------------+----------------------+ | 0 | | None | +----------------------+---------------------+----------------------+ | 1 | | Swapping MSBs with | | | | LSBs | +----------------------+---------------------+----------------------+ | 2 | | Inversion of the | | | | logical values of | | | | LSBs | +----------------------+---------------------+----------------------+ | 3 | | Swapping MSBs with | | | | LSBs, and inversion | | | | of the logical | | | | values of LSBs | +----------------------+---------------------+----------------------+
The output bit sequences from the table above map to the output bits in groups
of 4, i.e. _r~k~, r~k+1~, r~k+2~, r~k+3~_ , where k mod 4 = 1.
The following table 15a describes the operations that produce the different
rearrangements of 64 QAM.
The bits of the input sequence are mapped in groups of 6 so that _v~k~,
v~k+1~, v~k+2~, v~k+3~, v~k+4~, v~k+5~_ are used, where k mod 6 = 1.
Table 15a: Constellation re-arrangement for 64 QAM
+----------------------+----------------------+----------------------+ | Constellation | Output bit sequence | Operation | | version | | | | | | | | parameter _b_ | | | +----------------------+----------------------+----------------------+ | 0 | | None | +----------------------+----------------------+----------------------+ | 1 | $v_{ | Swapping MSBs and | | | k + 4}v_{k + 5}$$\ov | LSBs. Inversion of | | | erline{v}\overline{v | Middle SBs | | | _{k + 3}}vv_{k + 1}$ | | +----------------------+----------------------+----------------------+ | 2 | $v_{ | Left circular shift | | | k + 2}v_{k + 3}$$\ov | of pair of SBs. | | | erline{v}\overline{v | Inversion of Middle | | | _{k + 5}}vv_{k + 1}$ | SBs | +----------------------+----------------------+----------------------+ | 3 | $vv_{k | Inversion of Middle | | | + 1}$$\overline{v}\ | SBs | | | overline{v_{k + 3}}$ | | | | $v_{k + 4}v_{k + 5}$ | | +----------------------+----------------------+----------------------+
The output bit sequences from the table above map to the output bits in groups
of 6, i.e. _r~k~, r~k+1~, r~k+2~, r~k+3~, r~k+4~, r~k+5~_ , where k mod 6 = 1.
### 4.5.8 Physical channel mapping for HS-DSCH
The HS-PDSCH is defined in [7]. The bits input to the physical channel mapping
are denoted by _r~1~_ , _r~2~_ , ..., _r~R~_ , where _R_ is the number of
physical channel bits in the allocation for the current TTI. These bits are
mapped to the physical channel bits, {_w~t,p,j~_ : _t_ = 1, 2, ..., _T_ ; _p_
= 1, 2, ..., _C_ ; _j_ = 1, 2, ..., _U~t,p~_}, where _t_ is the timeslot
index, _T_ is the number of timeslots in the allocation message, _p_ is the
physical channel index, _C_ is the number of codes per timeslot in the
allocation message, _j_ is the physical channel bit index and _U~t,p~_ is the
number of bits for the physical channel p in timeslot t. The timeslot index,
_t_ , increases with increasing timeslot number; the physical channel index,
_p_ , increases with increasing channelisation code index, and the physical
channel bit index, _j_ , increases with increasing physical channel bit
position in time. If TS0 is included in the allocation message, TS0 has the
maximum timeslot index while the timeslot index of any other timeslot
increases with increasing timeslot number.
The bits _r~k~_ shall be mapped to the PhCHs according to the following rule :
Define {_y~t,k~_ : _k_ = 1, 2, ..., $\sum_{p = 1}^{C}U_{t,p}$} to be the set
of bits to be transmitted in timeslot _t_ as follows :
$y_{1,k} = r_{k}$ for _k_ = 1, 2, ..., $\sum_{p = 1}^{C}U_{1,p}$
$y_{2,k} = r_{k + \sum_{p = 1}^{C}U_{1,p}}$ for _k_ = 1, 2, ..., $\sum_{p =
1}^{C}U_{2,p}$
...
$y_{T,k} = r_{k + \sum_{t = 1}^{T - 1}{\sum_{p = 1}^{C}U_{t,p}}}$ for _k_ = 1,
2, ..., $\sum_{p = 1}^{C}U_{T,p}$
When the modulation level applied to the physical channels is 16- QAM :
The physical channel _p_ used to transmit the _k_ ^th^ bit in the sequence
_y~t,k~_ is :
if (k \ If _p_ is odd then :
$w_{t,p,j} = y_{t,k}$ where$j = 4 \cdot \left\lfloor \frac{k - U_{\text{t,1}}
\cdot C - 1}{4 \cdot (C - 1)} \right\rfloor + (k - U_{\text{t,1}} \cdot C -
1)\text{mod}4 + U_{\text{t,1}} + 1$
If _p_ is even then :
$w_{t,p,j} = y_{t,k}$ where$j = U_{t,p} - 4 \cdot \left\lfloor \frac{k -
U_{\text{t,1}} \cdot C - 1}{4 \cdot (C - 1)} \right\rfloor - 3 -
U_{\text{t,1}} + (k - U_{\text{t,1}}C - 1)\text{mod}4$
Otherwise, when the modulation level applied to the physical channels is QPSK
:
The physical channel _p_ used to transmit the _k_ ^th^ bit in the sequence
_y~t,k~_ is :
if (k \ HS-SCCH type 1 may be used when the following two conditions are both true:
\- the UE is not configured in MIMO mode, and
\- the variable HS_DSCH_SPS_STATUS is TRUE.
In this section, the terms "HS-SCCH" and "HS-SCCH type 1" are used
interchangeably.
The following information, provided by higher layers, is transmitted by means
of the HS-SCCH physical channel.
For 1.28 Mcps TDD, in the case of multi-frequency HS-DSCH transmission in one
TTI, HS-PDSCH on each frequency shall be configured with associated HS-SCCH(s)
which is coded and multiplexed as following.
\- Channelisation-code-set information (_q_ bits where _q_ = 8 for 1.28Mcps
TDD / 3.84Mcps TDD and _q_ = 10 for 7.68Mcps TDD)): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,\ q~_
\- Time slot information (_n_ bits where _n_ = 5 for 1.28 Mcps TDD and _n_ =
13 for 3.84 Mcps TDD / 7.68Mcps TDD):\ _x~ts,1~, x~ts,2~, ..., x~ts,n~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- Transport-block size information (m bits where m = 6 for 1.28 Mcps TDD and
m = 9 for 3.84 Mcps TDD / 7.68Mcps TDD):\ _x~tbs,1~, x~tbs,2~, ..., x~tbs,m~_
\- Hybrid-ARQ process information (3 bits): _x~hap,1~, x~hap,2~, x~hap,3~_
\- Redundancy version information (3 bits): _x~rv,1~, x~rv,2~,x~rv,3~_
\- New data indicator (1 bit): _x~nd,1~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
For an HS-SCCH order type A for 1.28Mcps TDD,
\- x~ccs,1~, x~ccs,2~, ..., x~ccs,\ q~ are reserved
_\- x~ts,1~, x~ts,2~, ..., x~ts,n~_ shall be set to '00000'
\- x~ms,1~, _x~tbs,1~, x~tbs,2~ shall be set to_ x~odt,1~, x~odt,2~, x~odt,3~
_\- x~tbs,3~, x~tbs,4~, ..., x~tbs,m~_ , x~hap,1~, x~hap,2~, x~hap,3~
,x~rv,1~, x~rv,2~,x~rv,3~ ,x~nd,1~, x~hcsn,1~, x~hcsn,2~, x~hcsn,3~ _are
reserved_
_where x~odt,1~, x~odt,2~, x~odt,3~ are defined in subclause 4.6A._
The following coding/multiplexing steps can be identified:
\- multiplexing of HS-SCCH information (see subclause 4.6.2)
\- CRC attachment (see subclause 4.6.3);
\- channel coding (see subclause 4.6.4);
\- rate matching (see subclause 4.6.5);
\- interleaving for HS-SCCH (see subclause 4.6.6);
\- mapping to physical channels (see subclauses 4.6.7 and 4.6.8).
The general coding/multiplexing flow is shown in Figure 19.
Figure 19 Coding and Multiplexing for HS-SCCH
### 4.6.1 HS-SCCH information field mapping
#### 4.6.1.1 Channelisation code set information mapping
#### 4.6.1.1.1 1.28Mcps TDD and 3.84Mcps TDD
HS-PDSCH channelisation codes are allocated contiguously from a signalled
start code to a signalled stop code, and the allocation includes both the
start and stop code. The start code _k~start~_ is signalled by the bits
_x~ccs,1~, x~ccs,2,~ x~ccs,3~, x~ccs,4~_ and the stop code _k~stop~_ by the
bits _x~ccs,5~, x~ccs,6,~ x~ccs,7~, x~ccs,8~_. The mapping in Table 16 below
applies.
Table 16: Channelisation code set information mapping for 1.28Mcps and
3.84Mcps TDD
* * *
_k~start~_ _x~ccs,1~_ _x~ccs,2~_ _x~ccs,3~_ _x~ccs,4~_ _k~stop~_ _x~ccs,5~_
_x~ccs,6~_ _x~ccs,7~_ _x~ccs,8~_ 1 0 0 0 0 1 0 0 0 0 2 0 0 0 1 2 0 0 0 1 3 0 0
1 0 3 0 0 1 0 4 0 0 1 1 4 0 0 1 1 5 0 1 0 0 5 0 1 0 0 6 0 1 0 1 6 0 1 0 1 7 0
1 1 0 7 0 1 1 0 8 0 1 1 1 8 0 1 1 1 9 1 0 0 0 9 1 0 0 0 10 1 0 0 1 10 1 0 0 1
11 1 0 1 0 11 1 0 1 0 12 1 0 1 1 12 1 0 1 1 13 1 1 0 0 13 1 1 0 0 14 1 1 0 1
14 1 1 0 1 15 1 1 1 0 15 1 1 1 0 16 1 1 1 1 16 1 1 1 1
* * *
If a value of _k~start~_ = 16 and _k~stop~_ = 1 is signalled, a spreading
factor of SF=1 shall be used for the HS-PDSCH resources. Other than this case,
_k~start~_ > _k~stop~_ shall be treated as an error by the UE.
If NON_RECTANGULAR_Resource_ ALLOCATION_STATUS is FALSE, HS-PDSCH
channelization codes of all the allocated timeslots are indicated by
channelisation-code-set information field.
If NON_RECTANGULAR_Resource_ ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is not configured via higher layer signalling,
the specific timeslot refers to the timeslot with the maximal timeslot index
among all the timeslots scheduled to the UE and HS-PDSCH channelisation codes
of the specific timeslot is indicated by channelisation-code set information
field. The HS-PDSCH channelisation codes of timeslot 0 are signalled via
higher layer signalling if timeslot 0 is scheduled to the UE. The HS-PDSCH
channelisation codes of other scheduled timeslots are predefined, i.e. the
entire resource of each timeslot is scheduled to the UE with SF=1.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is configured via higher layer signalling, HS-
PDSCH channelisation codes in the specific timeslot is indicated by
channelisation-code set information field. The HS-PDSCH channelisation codes
of other scheduled timeslots are predefined, i.e. the entire resource of the
timeslot is scheduled to the UE with SF=1.
##### 4.6.1.1.2 7.68Mcps TDD
HS-PDSCH channelisation codes are allocated contiguously from a signalled
start code to a signalled stop code, and the allocation includes both the
start and stop code. The start code _k~start~_ is signalled by the bits
_x~ccs,1~, x~ccs,2,~ x~ccs,3~, x~ccs,4~, x~ccs,5~_ and the stop code _k~stop~_
by the bits _x~ccs,6~, x~ccs,7,~ x~ccs,8~, x~ccs,9~, x~ccs,10~_. The mapping
in Table 16A below applies.
Table 16A: Channelisation code set information mapping for 7.68Mcps TDD
* * *
_k~start~_ _x~ccs,1~_ _x~ccs,2~_ _x~ccs,3~_ _x~ccs,4~_ _x~ccs,5~_ _k~stop~_
_x~ccs,6~_ _x~ccs,7~_ _x~ccs,8~_ _x~ccs,9~_ _x~ccs,10~_ 1 0 0 0 0 0 1 0 0 0 0
0 2 0 0 0 0 1 2 0 0 0 0 1 3 0 0 0 1 0 3 0 0 0 1 0 4 0 0 0 1 1 4 0 0 0 1 1 5 0
0 1 0 0 5 0 0 1 0 0 6 0 0 1 0 1 6 0 0 1 0 1 7 0 0 1 1 0 7 0 0 1 1 0 8 0 0 1 1
1 8 0 0 1 1 1 9 0 1 0 0 0 9 0 1 0 0 0 10 0 1 0 0 1 10 0 1 0 0 1 11 0 1 0 1 0
11 0 1 0 1 0 12 0 1 0 1 1 12 0 1 0 1 1 13 0 1 1 0 0 13 0 1 1 0 0 14 0 1 1 0 1
14 0 1 1 0 1 15 0 1 1 1 0 15 0 1 1 1 0 16 0 1 1 1 1 16 0 1 1 1 1 17 1 0 0 0 0
17 1 0 0 0 0 18 1 0 0 0 1 18 1 0 0 0 1 19 1 0 0 1 0 19 1 0 0 1 0 20 1 0 0 1 1
20 1 0 0 1 1 21 1 0 1 0 0 21 1 0 1 0 0 22 1 0 1 0 1 22 1 0 1 0 1 23 1 0 1 1 0
23 1 0 1 1 0 24 1 0 1 1 1 24 1 0 1 1 1 25 1 1 0 0 0 25 1 1 0 0 0 26 1 1 0 0 1
26 1 1 0 0 1 27 1 1 0 1 0 27 1 1 0 1 0 28 1 1 0 1 1 28 1 1 0 1 1 29 1 1 1 0 0
29 1 1 1 0 0 30 1 1 1 0 1 30 1 1 1 0 1 31 1 1 1 1 0 31 1 1 1 1 0 32 1 1 1 1 1
32 1 1 1 1 1
* * *
If a value of _k~start~_ = 32 and _k~stop~_ = 1 is signalled, a spreading
factor of SF=1 shall be used for the HS-PDSCH resources. Other than this case,
_k~start~_ > _k~stop~_ shall be treated as an error by the UE.
#### 4.6.1.2 Timeslot information mapping
##### 4.6.1.2.1 1.28 Mcps TDD
For 1.28 Mcps, the timeslots to be used for HS-PDSCH resources are signalled
by the bits _x~ts,1~, x~ts,2~, ..., x~ts,5~_ , where bit _x~ts,n~_ carries the
information for timeslot n+1. Timeslot 1 cannot be used for HS-DSCH resources.
If the signalling bit is set (i.e. equal to 1), then the corresponding
timeslot shall be used for HS-PDSCH resources. Otherwise, the timeslot shall
not be used. If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is FALSE, all used
timeslots shall use the same channelisation code set, as signalled by the
channelisation code set information bits. Otherwise, the used timeslots may
use different channelization code sets as described in 4.6.1.1.1.
When indicated by the higher layer that Timeslot 0 can be used for HS-PDSCH,
bit _x~ts,1~_ carries the information for timeslot 0. If _x~ts,1~_ is set
(i.e. equal to 1), Timeslot 0 shall be used for HS-PDSCH resource. Otherwise,
Timeslot 0 shall not be used.
##### 4.6.1.2.2 3.84 Mcps TDD and 7.68Mcps TDD
For 3.84 Mcps, the timeslots to be used for HS-PDSCH resources are signalled
by the bits _x~ts,1~, x~ts,2~, ..., x~ts,13~_ , where bit _x~ts,n~_ carries
the information for the n^th^ available timeslot for HS-PDSCH resources, where
the order of the timeslots available for HS-PDSCH resources shall be the same
as the order of the 15 time slots within each frame with the following two
slots removed:
\- The slot containing the P-CCPCH
\- The first slot in a frame containing the PRACH
If the P-CCPCH and/or PRACH are assigned to some, but not all frames, then the
corresponding time slots shall remain unavailable for these frames as well..
If the bit is set (i.e. equal to 1), then the corresponding timeslot shall be
used for HS-PDSCH resources. Otherwise, the timeslot shall not be used. All
used timeslots shall use the same channelisation code set, as signalled by the
channelisation code set information bits.
#### 4.6.1.3 Modulation scheme information mapping
The modulation scheme to be used by the HS-PDSCH resources shall be signalled
by bit _x~ms,1~_. If 64QAM is not supported by the UE, the mapping scheme in
Table 17 shall apply.
Table 17: Modulation scheme information mapping
* * *
_x~ms~_ ~,1~ Modulation Scheme 0 QPSK 1 16-QAM
* * *
If 64QAM is supported by the UE, the mapping scheme in Table 17a shall apply.
Table 17a: Modulation scheme information mapping
* * *
_x~ms~_ ~,1~ Modulation Scheme 0 QPSK or 64QAM 1 16-QAM
* * *
The method of determining the modulation scheme by UE with 64QAM capability is
as following:
If _x~ms,1~_ = 1, then modulation scheme is 16QAM;
Else if _x~ms,1~_ = 0, then
Step 1, UE first calculates the physical resource bearer capability and the
transmission bit rate. The physical resource bearer capability is the maximum
bit rate at which RAN can transmit with the physical resources assigned in HS-
SCCH and the QPSK modulation. The physical resource bearer capability can be
calculated by the channelization-code-set information and time slot
information of HS-SCCH.
The transmission bit rate is the bit rate to which the transport-block size
indicated in HS-SCCH corresponds.
Step 2, if the physical resource bearer capability multiplied by R is less
than the transmission bit rate, and R belongs to [0, 1],
> then modulation scheme is 64QAM;
else modulation scheme is QPSK.
Note: According to the simulation results the value of the transmission bit
rate divided by the physical resource bearer capability according to 64QAM
should be more than 1/3, where the value of R is equal to 1.
If 64QAM is configured by UE, the method of determining recommended modulation
scheme by NodeB can be similar to 64QAM indication in HS-SCCH. The details
are:
If _x~ms,1~_ =1, NodeB should determine the recommended modulation scheme as
16QAM,
Else if _x~ms,1~_ =0, NodeB calculates the physical resource bearer capability
assigned in HS-SCCH corresponding to RMF and RTBS in HS-SICH, and calculates
the transmission bit rate according to the RTBS in HS-SICH, and then
determines whether the recommended modulation scheme is 64QAM or QPSK.
#### 4.6.1.4 Redundancy and constellation version information mapping
The redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are mapped jointly to produce the value X~rv~. X~rv~ is
alternatively represented as the sequence x~rv,1~, x~rv,2~, x~rv,3~ where
x~rv,1~ is the MSB. This is done according to the following tables according
to the modulation mode used:
Table 18: RV mapping for 16 QAM and 64 QAM
* * *
X~rv~ (value) s r b 0 1 0 0 1 0 0 0 2 1 1 1 3 0 1 1 4 1 0 1 5 1 0 2 6 1 0 3 7
1 1 0
* * *
Table 19: RV mapping for QPSK
* * *
X~rv~ (value) s r 0 1 0 1 0 0 2 1 1 3 0 1 4 1 2 5 0 2 6 1 3 7 0 3
* * *
#### 4.6.1.5 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number is mapped such that _x~hcsn,1~ corresponds
to the MSB and x~hcsn,3~ to the LSB._
#### 4.6.1.6 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
#### 4.6.1.7 HARQ process identifier mapping
The hybrid-ARQ process information _x~hap,1~, x~hap,2~, x~hap,3~_ is unsigned
binary representation of the HARQ process identifier where _x~hap,1~_ is MSB.
#### 4.6.1.8 Transport block size index mapping
The transport-block size information _x~tbs,1~, x~tbs,2~, ..., x~tbs,m\ ~_ is
unsigned binary representation of the transport block size index where
_x~tbs,1~_ is MSB.
### 4.6.2 Multiplexing of HS-SCCH information
The information carried on the HS-SCCH is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule :
### 4.6.3 CRC attachment for HS-SCCH
From the sequence of bits $a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$a 16 bit
CRC is calculated according to Section 4.2.1.1. This gives a sequence of bits
$y_{1},y_{2},\text{.}\text{.}\text{.}y_{\text{16}}$ where
$y_{k} = p_{\text{im}\left( \text{17} - k \right)}$ k = 1,2,...16
This latter sequence of bits is then masked with the UE identity and appended
to the sequence of bits $a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$. The bits
at the output of the CRC attachment block is the sequence of bits
$b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, where
$b_{i} = a_{i}$ _i=1,2,...,A_
$b_{i} = \left( y_{i - A} + x_{\text{ue},i - A} \right)\text{mod}2$
_i=A+1...B_
### 4.6.4 Channel coding for HS-SCCH
Channel coding for the HS-SCCH shall be done with the general method described
in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH.
### 4.6.5 Rate matching for HS-SCCH
Rate matching for HS-SCCH shall be done with the general method described in
4.2.7.
### 4.6.6 Interleaving for HS-SCCH
Interleaving for HS-SCCH shall be done with the general method described in
4.2.11.1.
### 4.6.7 Physical Channel Segmentation for HS-SCCH
Physical channel segmentation for HS-SCCH shall be done with the general
method described in 4.2.10. For 1.28 Mcps TDD, the HS-SCCH consists of two
physical channels HS-SCCH1 and HS-SCCH2; for 3.84 Mcps TDD and 7.68Mcps TDD
the HS-SCCH only uses one physical channel, see [7].
### 4.6.8 Physical channel mapping for HS-SCCH
Physical channel mapping for the HS-SCCH shall be done with the general method
described in subclause 4.2.12.
## 4.6A Coding/Multiplexing for HS-SCCH orders type A
HS-SCCH orders type A are commands sent to the UE using HS-SCCH. No HS-PDSCH
is associated with HS-SCCH orders.
For 1.28 Mcps TDD, HS-SCCH order type A may be used when any of the following
conditions is true:
\- HS_DSCH_RECEPTION_CELL_FACH_STATE is TRUE;
\- CONTROL_CHANNEL_DRX_STATUS is TRUE, and UE is not configured in MIMO mode;
\- CONTROL_CHANNEL_DRX_STATUS is TRUE, and UE is configured in MIMO mode while
the variable MIMO SF mode for HS-PDSCH dual stream is SF1
\- the variable HS_DSCH_SPS_STATUS is TRUE, and UE is not configured in MIMO
mode;
\- the variable HS_DSCH_SPS_STATUS is TRUE, and UE is configured in MIMO mode
while the variable MIMO SF mode for HS-PDSCH dual stream is SF1.
The following information is transmitted by means of the HS-SCCH order type A
physical channel.
\- Order type (3 bits): _x~odt,1~, x~odt,2~, x~odt,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The coding for HS-SCCH orders type A is specified in subclause 4.6.
### 4.6A.1 HS-SCCH orders type A information field mapping
#### 4.6A.1.1 Order type mapping
If _x~odt,1~, x~odt,2~, x~odt,3~_ = _'000'_ , then the HS-SCCH order is an
uplink synchronization establishment order when UE is in CELL_FACH or CELL_PCH
state.
If _x~odt,1~, x~odt,2~, x~odt,3~_ = '_001_ ', then the HS-SCCH order is an
order to release the allocated semi-persistent HS-PDSCH resources when UE is
in CELL_DCH state.
If _x~odt,1~, x~odt,2~, x~odt,3~_ = '_010_ ', then the HS-SCCH order is DRX
Activation order when UE is in CELL_DCH state.
If _x~odt,1~, x~odt,2~, x~odt,3~_ = '_011_ ', then the HS-SCCH order is DRX
De-activation order when UE is in CELL_DCH state.
#### 4.6A.1.2 UE identity mapping
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
## 4.6B Coding/Multiplexing for HS-SCCH type 2 (1.28 Mcps TDD only)
HS-SCCH shall be of type 2 when any of the following conditions is met:
\- the variable HS_DSCH_SPS_STATUS is TRUE, and UE is not configured in MIMO
mode;
\- the variable HS_DSCH_SPS_STATUS is TRUE, and UE is configured in MIMO mode
while the variable MIMO SF mode for HS-PDSCH dual stream is SF1.
HS-SCCH type 2 is used to allocate semi-persistent HS-PDSCH resources for the
initial transmissions. The following information is transmitted by means of
the HS-SCCH type 2 physical channels.
\- Type flag 1 (2 bits): _x~flag1,1~_ , _x~flag1,2~_
\- Resource repetition pattern index (2bits): _x~rrpi,1~_ , _x~rrpi,2~_
\- Type flag 2 (2 bits): _x~flag2,1~_ , _x~flag2,2~_
\- Transport-block size information (2 bits): _x~tbs,1~, x~tbs,2~_
\- Time slot information (5bits): _x~ts,1~, x~ts,2~, ..., x~ts,5~_
\- Channelisation-code-set information (6 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,\ 6~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- HS-SICH indicator (2bits): _x~HI,1~_ , _x~HI,2~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
\- Redundancy and constellation version (0 bit): X~rv~ _=0_ (see subclause
4.6.1.4)
\- Reserved (5 bits): _x~res,1~_ , _x~res,2~_ ,_..._ , _x~res,5~_
For an HS-SCCH order type A,
\- x~flag1,1~, x~flag1,2~, x~rrpi,1~, x~rrpi,2~ , x~flag2,1~, x~flag2,2~,
_x~tbs,1~, x~tbs,2~_ are reserved
_\- x~ts,1~, x~ts,2~, ..., x~ts,5~_ shall be set to '00000'
\- x~ccs,1~, _x~ccs,2~, x~ccs,3~ shall be set to_ x~odt,1~, x~odt,2~, x~odt,3~
\- x~ccs,4~, _x~ccs,5~, x~ccs,6~_ , x~ms,1~, x~HI,1~, x~HI,2~, x~hcsn,1~,
x~hcsn,2~, x~hcsn,3~, x~res,1~, x~res,2~, x~res,3~ , x~res,4,~ x~res,5~ _are
reserved_
_where x~odt,1~, x~odt,2~, x~odt,3~ are defined in subclause 4.6A._
The following coding/multiplexing steps for HS-SCCH type 2 can be identified:
\- multiplexing of HS-SCCH type 2 information (see subclause 4.6B.2)
\- CRC attachment for HS-SCCH type 2 (see subclause 4.6B.3);
\- channel coding for HS-SCCH type 2 (see subclause 4.6B.4);
\- rate matching for HS-SCCH type 2 (see subclause 4.6B.5);
\- interleaving for HS-SCCH type 2 (see subclause 4.6B.6);
\- mapping to physical channels for HS-SCCH type 2 (see subclauses 4.6B.7 and
4.6B.8).
The general coding/multiplexing flow for HS-SCCH type 2 is shown in Figure
19A.
Figure 19A: Coding and Multiplexing for HS-SCCH type 2
### 4.6B.1 HS-SCCH type 2 information field mapping
#### 4.6B.1.1 Type flag 1 mapping
The type flag 1 _x~flag1,1~, x~flag1,2~_ are mapped such that _x~flag1,1~_
=_'1'_ corresponds to the MSB and _x~flag1,2~_ =_'1'_ to the LSB. The type
flag 1 is used to distinguish HS-SCCH type 2 from other types.
#### 4.6B.1.2 Resource repetition pattern index mapping
The resource repetition pattern index _x~rrpi,1~_ , _x~rrpi,2~_ is the
unsigned binary representation of a reference to one of repetition patterns of
the assigned semi-persistent HS-PDSCH resources configured by higher layers.
The resource repetition pattern index _x~rrpi,1~_ , _x~rrpi,2~_ are mapped
such that _x~rrpi,1~_ corresponds to the MSB and _x~rrpi,2~_ to the LSB. The
mapping of _x~rrpi,1~ x~rrpi,2~ ='00'_ is not used.
* * *
x~rrpi,1~, x~rrpi,2~ **Resource repetition** pattern **index as signalled in
the variable HS_DSCH_SPS_PARAMS[12]** '01' 1^st^ entry '10' 2^nd^ entry '11'
3^rd^ entry
* * *
#### 4.6B.1.3 Type flag 2 mapping
The type flag 2 _x~flag2,1~, x~flag2,2~_ are mapped such that _x~flag2,1~_
=_'1'_ corresponds to the MSB and _x~flag2,2~_ =_'0'_ to the LSB. The type
flag 2 is used to distinguish HS-SCCH type 2 from other types.
#### 4.6B.1.4 Transport block size index mapping
The transport-block size information _x~tbs,1~, x~tbs,2~_ is the unsigned
binary representation of a reference to one of the four Transport-block sizes
configured by higher layers.
* * *
x~tbs,1~, x~tbs,2~ **Transport Block size as signalled in the variable
HS_DSCH_SPS_PARAMS[12]** '00' 1^st^ entry '01' 2^nd^ entry '10' 3^rd^ entry
'11' 4^th^ entry
* * *
#### 4.6B.1.5 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6B.1.6 Channelisation code set information mapping
HS-PDSCH channelisation codes are allocated contiguously from a signalled
start code to a signalled stop code, and the allocation includes both the
start and stop code. The start code _k~start~_ is signalled by the bits
_x~ccs,1~, x~ccs,2,~ x~ccs,3~_ and the stop code _k~stop~_ by the bits
_x~ccs,4,~ x~ccs,5~, x~ccs,6~_. The mapping in Table 16B below applies.
If a value of _k~start~_ = 9 and _k~stop~_ = 6 is signalled, a spreading
factor of SF=1 shall be used for the HS-PDSCH resources. Other than this case,
_k~start~_ > _k~stop~_ are not used.
Table 16B: Channelisation code set information mapping
* * *
_k~start~_ _x~ccs,1~_ _x~ccs,2~_ _x~ccs,3~_ _k~stop~_ _x~ccs,4~_ _x~ccs,5~_
_x~ccs,6~_ 1 0 0 0 2 0 0 0 3 0 0 1 4 0 0 1 5 0 1 0 6 0 1 0 7 0 1 1 8 0 1 1 9 1
0 0 10 1 0 0 11 1 0 1 12 1 0 1 13 1 1 0 14 1 1 0 15 1 1 1 16 1 1 1
* * *
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is FALSE, HS-PDSCH
channelization codes of all the allocated timeslots are indicated by
channelisation-code-set information field.
If NON_RECTANGULAR_Resource_ ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is not configured via higher layer signalling,
the specific timeslot refers to the timeslot with the maximal timeslot index
among all the timeslots scheduled to the UE and HS-PDSCH channelisation codes
of the specific timeslot is indicated by channelisation-code set information
field. The HS-PDSCH channelisation codes of timeslot 0 are signalled via
higher layer signalling if timeslot 0 is scheduled to the UE. The HS-PDSCH
channelisation codes of other scheduled timeslots are predefined, i.e. the
entire resource of each timeslot is scheduled to the UE with SF=1.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is configured via higher layer signalling, HS-
PDSCH channelisation codes in the specific timeslot is indicated by
channelisation-code set information field. The HS-PDSCH channelisation codes
of other scheduled timeslots are predefined, i.e. the entire resource of the
timeslot is scheduled to the UE with SF=1.
#### 4.6B.1.7 Modulation scheme information mapping
The mapping of the modulation scheme information _x~ms,1~_ is performed
according to table 17 in section 4.6.1.3.
#### 4.6B.1.8 HS-SICH indicator mapping
The HS-SICH indicator consists of 2 bits used to indicate the UE which HS-SICH
will be used to convey the CQI and the acknowledgement indicator for the
received data on the semi-persistent HS-PDSCH resources. The bits _x~HI,1~,
x~HI,2~_ are mapped such that _x~HI,1~_ corresponds to the MSB and _x~HI,2~_
to the LSB.
* * *
x~HI,1~, x~HI,2~ **HS-SICH indicator as signalled in the variable
HS_DSCH_SPS_PARAMS[12]** '00' 1^st^ entry '01' 2^nd^ entry '10' 3^rd^ entry
'11' 4^th^ entry
* * *
#### 4.6B.1.9 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number _x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_ is mapped
such that _x~hcsn,1~ corresponds to the MSB and x~hcsn,3~ to the LSB._
#### 4.6B.1.10 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
### 4.6B.2 Multiplexing of HS-SCCH type 2 information
The information carried on the HS-SCCH type 2 is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule :
### 4.6B.3 CRC attachment for HS-SCCH type 2
The sequence of bits $b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, is
calculated according to subclause 4.6.3.
### 4.6B.4 Channel coding for HS-SCCH type 2
Channel coding for the HS-SCCH type 2 shall be done with the general method
described in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH type 2.
### 4.6B.5 Rate matching for HS-SCCH type 2
Rate matching for HS-SCCH type 2 shall be done with the general method
described in 4.6.5.
### 4.6B.6 Interleaving for HS-SCCH type 2
Interleaving for HS-SCCH type 2 shall be done with the general method
described in 4.2.11.1.
### 4.6B.7 Physical Channel Segmentation for HS-SCCH type 2
Physical channel segmentation for HS-SCCH type 2 shall be done with the
general method described in 4.2.10. The HS-SCCH consists of two physical
channels HS-SCCH1 and HS-SCCH2.
### 4.6B.8 Physical channel mapping for HS-SCCH type 2
Physical channel mapping for the HS-SCCH type 2 shall be done with the general
method described in subclause 4.2.12.
## 4.6C Coding/Multiplexing for HS-SCCH type 3 (1.28 Mcps TDD only)
HS-SCCH shall be of type 3 when any of the following conditions is met:
\- the variable HS_DSCH_SPS_STATUS is TRUE, and UE is not configured in MIMO
mode;
\- the variable HS_DSCH_SPS_STATUS is TRUE, and UE is configured in MIMO mode
while the variable MIMO SF mode for HS-PDSCH dual stream is SF1.
HS-SCCH type 3 is used to allocate one subframe HS-PDSCH resources for
retransmissions of HS-DSCH semi-persistent scheduling operation. The following
information is transmitted by means of the HS-SCCH type 3 physical channels.
\- Type flag 1 (2 bits): _x~flag1,1~_ , _x~flag1,2~_
\- Resource repetition pattern index (2bits): _x~rrpi,1~_ , _x~rrpi,2~_
\- Type flag 2 (2 bits): _x~flag2,1~_ , _x~flag2,2~_
\- Transport-block size information (2 bits): _x~tbs,1~, x~tbs,2~_
\- Time slot information (5bits): _x~ts,1~, x~ts,2~, ..., x~ts,5~_
\- Channelisation-code-set information (6 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,\ 6~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- Redundancy version information (2 bits): _x~rv,1~, x~rv,2~_
\- Pointer to the previous transmission (4 bits): _x~ptr,1~, x~ptr,2~,
x~ptr,3,~ x~ptr,4~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- Reserved (1 bit): _x~res,1~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The following coding/multiplexing steps for HS-SCCH type 3 can be identified:
\- multiplexing of HS-SCCH type 3 information (see subclause 4.6C.2)
\- CRC attachment for HS-SCCH type 3 (see subclause 4.6C.3);
\- channel coding for HS-SCCH type 3 (see subclause 4.6C.4);
\- rate matching for HS-SCCH type 3 (see subclause 4.6C.5);
\- interleaving for HS-SCCH type 3 (see subclause 4.6C.6);
\- mapping to physical channels for HS-SCCH type 3 (see subclauses 4.6C.7 and
4.6C.8).
The general coding/multiplexing flow for HS-SCCH type 3 is shown in Figure
19B.
Figure 19B: Coding and Multiplexing for HS-SCCH type 3
### 4.6C.1 HS-SCCH type 3 information field mapping
#### 4.6C.1.1 Type flag 1 mapping
The type flag 1 _x~flag1,1~, x~flag1,2~_ are mapped such that _x~flag1,1~_
=_'1'_ corresponds to the MSB and _x~flag1,2~_ =_'1'_ to the LSB. The type
flag 1 is used to distinguish HS-SCCH type 3 from other types.
#### 4.6C.1.2 Resource repetition pattern index mapping
The resource repetition pattern index _x~rrpi,1~_ , _x~rrpi,2~_ are mapped
such that _x~rrpi,1~_ corresponds to the MSB and _x~rrpi,2~_ to the LSB. The
mapping _x~rrpi,1,~ x~rrpi,2~_ =_'00'_ is used to indicate one subframe HS-
PDSCH resources assigned for retransmissions of semi-persistent scheduling
operation.
#### 4.6C.1.3 Type flag 2 mapping
The type flag 2 _x~flag2,1~, x~flag2,2~_ are mapped such that _x~flag2,1~_
=_'1'_ corresponds to the MSB and _x~flag2,2~_ =_'0'_ to the LSB. The type
flag 2 is used to distinguish HS-SCCH type 3 from other types.
#### 4.6C.1.4 Transport block size index mapping
The transport-block size information _x~tbs,1~, x~tbs,2~_ is the unsigned
binary representation of a reference to one of the four Transport-block sizes
configured by higher layers. The mapping is performed according to section
4.6B.1.4.
#### 4.6C.1.5 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6C.1.6 Channelisation code set information mapping
The mapping of the channelisation code set information _x~ccs,1~, x~ccs,2,~
x~ccs,3,~ x~ccs,4~, x~ccs,5,~ x~ccs,6~_ is performed according to section
4.6B.1.6.
#### 4.6C.1.7 Modulation scheme information mapping
The mapping of the modulation scheme information _x~ms,1~_ is performed
according to table 17 in section 4.6.1.3.
#### 4.6C.1.8 Redundancy version information mapping
The redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are mapped jointly to produce the value X~rv~. X~rv~ is
alternatively represented as the sequence _x~rv,1~, x~rv,2~_ where _x~rv,1~_
is the MSB. This is done according to the following tables according to the
modulation mode used.
Table 18A: RV mapping for 16QAM and 64QAM
* * *
**X~rv~ (value)** **_N~sys~_ / _N~data~_ \ _k~stop~_ are not used.
Table 24A: Special default midamble pattern mapping
* * *
_Special default Mid-amble pattern_ _x~mpi,1~_ _x~mpi,2~_ pattern 1A 0 0
pattern 1B 0 1 pattern 2A 1 0 pattern 2B 1 1
* * *
Table 24B: Channelisation code set information mapping
* * *
_k~start~_ _x~ccs,3~_ _x~ccs,4~_ _k~stop~_ _x~ccs,5~_ _x~ccs,6~_ 1 0 0 4 0 0 5
0 1 8 0 1 9 1 0 12 1 0 13 1 1 16 1 1
* * *
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is FALSE, HS-PDSCH
channelization codes of all the allocated timeslots are indicated by
channelisation-code-set information field.
If NON_RECTANGULAR_Resource_ ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is not configured via higher layer signalling,
the specific timeslot refers to the timeslot with the maximal timeslot index
among all the timeslots scheduled to the UE and HS-PDSCH channelisation codes
of the specific timeslot is indicated by channelisation-code set information
field. The HS-PDSCH channelisation codes of timeslot 0 are signalled via
higher layer signalling if timeslot 0 is scheduled to the UE. The HS-PDSCH
channelisation codes of other scheduled timeslots are predefined, i.e. the
entire resource of each timeslot is scheduled to the UE with SF=1.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is configured via higher layer signalling, HS-
PDSCH channelisation codes in the specific timeslot is indicated by
channelisation-code set information field. The HS-PDSCH channelisation codes
of other scheduled timeslots are predefined, i.e. the entire resource of the
timeslot is scheduled to the UE with SF=1.
#### 4.6D.1.4 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6D.1.5 Modulation scheme information mapping
The mapping of the modulation scheme information _x~ms,1~_ is performed
according to section 4.6.1.3.
#### 4.6D.1.6 Transport block size index mapping
The transport-block size information _x~tbs,1~, x~tbs,2~, ..., x~tbs,6~_ is
the unsigned binary representation of the transport block size index where
_x~tbs,1~_ is MSB. The mapping is performed according to section 4.6.1.8.
#### 4.6D.1.7 HARQ process identifier mapping
The hybrid-ARQ process information _x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~_ is
unsigned binary representation of the HARQ process identifier where _x~hap,1~_
is MSB.
#### 4.6D.1.8 Redundancy version information mapping
The redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are mapped jointly to produce the value X~rv~. X~rv~ is
alternatively represented as the sequence _x~rv,1~, x~rv,2~_ where _x~rv,1~_
is the MSB. The mapping is performed according to section 4.6C.1.8. If X~rv~
=0, the UE shall treat the corresponding transport block as an initial
transmission.
#### 4.6D.1.9 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number _x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_ is mapped
such that _x~hcsn,1~ corresponds to the MSB and x~hcsn,3~ to the LSB._
#### 4.6D.1.10 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
#### 4.6D.1.11 Midamble allocation scheme flag
When the midamble allocation scheme flag bit _x~flag,1~_ ='0', the default
midamble allocation scheme is used. Otherwise when the midamble allocation
scheme flag bit _x~flag,1~_ ='1', the special default midamble allocation
scheme with four patterns is used.
### 4.6D.2 Multiplexing of HS-SCCH type 4 information
The information carried on the HS-SCCH type 4 is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule :
### 4.6D.3 CRC attachment for HS-SCCH type 4
The sequence of bits $b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, is
calculated according to subclause 4.6.3.
### 4.6D.4 Channel coding for HS-SCCH type 4
Channel coding for the HS-SCCH type 4 shall be done with the general method
described in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH type 4.
### 4.6D.5 Rate matching for HS-SCCH type 4
Rate matching for HS-SCCH type 4 shall be done with the general method
described in 4.6.5.
### 4.6D.6 Interleaving for HS-SCCH type 4
Interleaving for HS-SCCH type 4 shall be done with the general method
described in 4.2.11.1.
### 4.6D.7 Physical Channel Segmentation for HS-SCCH type 4
Physical channel segmentation for HS-SCCH type 4 shall be done with the
general method described in 4.2.10. The HS-SCCH consists of two physical
channels HS-SCCH1 and HS-SCCH2.
### 4.6D.8 Physical channel mapping for HS-SCCH type 4
Physical channel mapping for the HS-SCCH type 4 shall be done with the general
method described in subclause 4.2.12.
## 4.6E Coding/Multiplexing for HS-SCCH type 5 (1.28 Mcps TDD only)
HS-SCCH shall be of type 5 when the following two conditions are both true:
\- the UE is configured in MIMO mode, and
\- the variable MIMO SF mode for HS-PDSCH dual stream is SF1.
HS-SCCH type 5 is used for dual stream transmission in MIMO mode. The
following information is transmitted by means of the HS-SCCH type 5 physical
channels.
\- Type flag 1(1 bit): _x~flag1,1~_
\- Modulation scheme information for stream 2 (1 bit): _x~ms2,1~_
\- Transport-block size offset information for stream 2 (5 bits): _x~tbs2,1~,
x~tbs2,2~, ..., x~tbs2,5~_
\- Type flag 2 (1 bit): _x~flag2,1~_
\- Time slot information (5bits): _x~ts,1~, x~ts,2~, ..., x~ts,5~_
\- Transport-block size information for stream 1 (6 bits): _x~tbs1,1~,
x~tbs1,2~, ..., x~tbs1,6~_
\- Modulation scheme information for stream 1 (1 bit): _x~ms1,1~_
\- Hybrid-ARQ process information (3 bits): _x~hap,1~, x~hap,2~, x~hap,3~_
\- Redundancy version information for stream 1 (2 bits): _x~rv1,1~, x~rv1,2~_
\- Redundancy version information for stream 2 (2 bits): _x~rv2,1~, x~rv2,2~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The following coding/multiplexing steps for HS-SCCH type 5 can be identified:
\- multiplexing of HS-SCCH type 5 information (see subclause 4.6E.2)
\- CRC attachment for HS-SCCH type 5 (see subclause 4.6E.3);
\- channel coding for HS-SCCH type 5 (see subclause 4.6E.4);
\- rate matching for HS-SCCH type 5 (see subclause 4.6E.5);
\- interleaving for HS-SCCH type 5 (see subclause 4.6E.6);
\- mapping to physical channels for HS-SCCH type 5 (see subclauses 4.6E.7 and
4.6E.8).
The general coding/multiplexing flow for HS-SCCH type 5 is shown in Figure
19D.
Figure 19D: Coding and Multiplexing for HS-SCCH type 5
### 4.6E.1 HS-SCCH type 5 information field mapping
#### 4.6E.1.1 Type flag 1 mapping
The type flag 1 bit _x~flag1,1~_ is mapped as _x~flag1,1~_ =_'1'_. The type
flag 1 is used to distinguish HS-SCCH type 5 from other types.
#### 4.6E.1.2 Type flag 2 mapping
The type flag 2 bits _x~flag2,1~_ is mapped as _x~flag2,1~_ =_'0'_. The type
flag 2 is used to distinguish HS-SCCH type 5 from other types.
#### 4.6E.1.3 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6E.1.4 Modulation scheme information mapping
The mapping of the modulation scheme information for each stream (_x~ms1,1~_
for stream 1 or _x~ms2,1~_ for stream 2 ) is performed according to section
4.6.1.3.
#### 4.6E.1.5 Transport block size offset information mapping
The transport-block size offset information for stream 2 _x~tbs2,1~,
x~tbs2,2~, ..., x~tbs2,5\ ~_ is the unsigned binary representation of the
transport block size index offset for the stream 2 where _x~tbs2,1~_ is MSB.
The transport-block size offset for the stream 2 subtracted from the
transport-block size for the stream 1 gives the transport-block size for
stream 2.
#### 4.6E.1.6 Transport block size index mapping
The transport-block size information for stream 1 _x~tbs1,1~, x~tbs1,2~, ...,
x~tbs1,6\ ~_ is the unsigned binary representation of the transport block size
index where _x~tbs,1~_ is MSB. The mapping is performed according to section
4.6.1.8.
#### 4.6E.1.7 HARQ process identifier mapping
The hybrid-ARQ process information _x~hap,1~, x~hap,2~, x~hap,3~_ is unsigned
binary representation of the HARQ process identifier $\text{HAP}_{1}$ for
stream 1 where _x~hap,1~_ is MSB. The HARQ process identifier for stream 2 is
$\text{HAP}_{1} + N_{\text{proc}}/2$, where _N~proc~_ is the number of HARQ
processes configured by higher layers.
#### 4.6E.1.8 Redundancy version information mapping
The redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are mapped jointly to produce the value X~rv~. X~rv1~ is
alternatively represented as the sequence for stream 1 _x~rv1,1~, x~rv1,2~_
where _x~rv1,1~_ is the MSB. X~rv2~ is alternatively represented as the
sequence for stream 2 _x~rv2,1~, x~rv2,2~_ where _x~rv2,1~_ is the MSB. The
mapping of the redundancy version for each stream is performed according to
section 4.6C.1.8. If X~rv1~= 0 or X~rv2~ = 0, the UE shall treat the
corresponding transport block as an initial transmission.
#### 4.6E.1.9 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number _x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_ is mapped
such that _x~hcsn,1~ corresponds to the MSB and x~hcsn,3~ to the LSB._
#### 4.6E.1.10 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
### 4.6E.2 Multiplexing of HS-SCCH type 5 information
The information carried on the HS-SCCH type 5 is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule :
### 4.6E.3 CRC attachment for HS-SCCH type 5
The sequence of bits $b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, is
calculated according to subclause 4.6.3.
### 4.6E.4 Channel coding for HS-SCCH type 5
Channel coding for the HS-SCCH type 5 shall be done with the general method
described in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH type 5.
### 4.6E.5 Rate matching for HS-SCCH type 5
Rate matching for HS-SCCH type 5 shall be done with the general method
described in 4.6.5.
### 4.6E.6 Interleaving for HS-SCCH type 5
Interleaving for HS-SCCH type 5 shall be done with the general method
described in 4.2.11.1.
### 4.6E.7 Physical Channel Segmentation for HS-SCCH type 5
Physical channel segmentation for HS-SCCH type 5 shall be done with the
general method described in 4.2.10. The HS-SCCH consists of two physical
channels HS-SCCH1 and HS-SCCH2.
### 4.6E.8 Physical channel mapping for HS-SCCH type 5
Physical channel mapping for the HS-SCCH type 5 shall be done with the general
method described in subclause 4.2.12.
## 4.6F Coding/Multiplexing for HS-SCCH type 6 (1.28 Mcps TDD only)
HS-SCCH shall be of type 6 when the following two conditions are both met:
\- the variable HS_DSCH_SPS_STATUS is TRUE, and
\- UE is configured in MIMO mode while the variable MIMO SF mode for HS-PDSCH
dual stream is SF1/SF16.
HS-SCCH type 6 is used to allocate semi-persistent HS-PDSCH resources for the
initial transmissions. The following information is transmitted by means of
the HS-SCCH type 6 physical channels.
\- Type flag (3 bits): _x~flag,1~_ , _x~flag,2~_ , _x~flag,3~_
\- Channelisation-code-set information (8 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,\ 8~_
\- Time slot information (5bits): _x~ts,1~, x~ts,2~, ..., x~ts,5~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- Resource repetition pattern index (2bits): _x~rrpi,1~_ , _x~rrpi,2~_
\- Transport-block size information (2 bits): _x~tbs,1~, x~tbs,2~_
\- HS-SICH indicator (2bits): _x~HI,1~_ , _x~HI,2~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- Reserved (8 bits): _x~res,1,~ x~res,2,...,~ x~res,8~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
\- Redundancy and constellation version (0 bit ): X~rv~ _=0_ (see 4.6.1.4)
For an HS-SCCH order type B,
\- x~flag,1~, x~flag,2~, x~flag,3~, x~ccs,1~, _x~ccs,2~, x~ccs,3~_ , x~ccs,4~,
_x~ccs,5~, x~ccs,6~_ , x~ccs,7~, _x~ccs,8~_ are reserved
_\- x~ts,1~, x~ts,2~, ..., x~ts,5~_ shall be set to '00000'
\- x~ms,1~, x~rrpi,1~, x~rrpi,2~ _shall be set to_ x~odt,1~, x~odt,2~,
x~odt,3~
_\- x~tbs,1~, x~tbs,2~_ , x~HI,1~, x~HI,2~, , x~hcsn,1~, x~hcsn,2~, x~hcsn,3~,
x~res,1,~ x~res,2,~ x~res,3,~ x~res,4,~ x~res,5,~ x~res,6,~ x~res,7,~ x~res,8~
_are reserved_
_where x~odt,1~, x~odt,2~, x~odt,3~ are defined in subclause 4.6J._
The following coding/multiplexing steps for HS-SCCH type 6 can be identified:
\- multiplexing of HS-SCCH type 6 information (see subclause 4.6F.2)
\- CRC attachment for HS-SCCH type 6 (see subclause 4.6F.3);
\- channel coding for HS-SCCH type 6 (see subclause 4.6F.4);
\- rate matching for HS-SCCH type 6 (see subclause 4.6F.5);
\- interleaving for HS-SCCH type 6 (see subclause 4.6F.6);
\- mapping to physical channels for HS-SCCH type 6 (see subclauses 4.6F.7 and
4.6F.8).
The general coding/multiplexing flow for HS-SCCH type 6 is shown in Figure
19E.
Figure 19E: Coding and Multiplexing for HS-SCCH type 6
### 4.6F.1 HS-SCCH type 6 information field mapping
#### 4.6F.1.1 Type flag mapping
The type flag _x~flag,1~, x~flag,2~, x~flag,3~_ are mapped such that
_x~flag,1~_ =_'1'_ corresponds to the MSB and _x~flag,3~_ =_'0'_ to the LSB.
The bit _x~flag,2~_ is reserved. The type flag is used to distinguish HS-SCCH
type 6 from other types.
#### 4.6F.1.2 Channelisation code set information mapping
The mapping of the channelisation code set information _x~ccs,1~, x~ccs,2,~
x~ccs,3,~ x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,7,~ x~ccs,8~_ is performed
according to section 4.6.1.1.1.
#### 4.6F.1.3 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6F.1.4 Modulation scheme information mapping
The mapping of the modulation scheme information _x~ms,1~_ is performed
according to table 17 in section 4.6.1.3.
#### 4.6F.1.5 Resource repetition pattern index mapping
The mapping of the resource repetition pattern index _x~rrpi,1~_ , _x~rrpi,2~_
is performed according to section 4.6B.1.2.
#### 4.6F.1.6 Transport block size index mapping
The mapping of the transport-block size information _x~tbs,1~, x~tbs,2~_ is
performed according to section 4.6B.1.4.
#### 4.6F.1.7 HS-SICH indicator mapping
The mapping of the HS-SICH indicator _x~HI,1~, x~HI,2~_ is performed according
to section 4.6B.1.9.
#### 4.6F.1.8 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number _x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_ is mapped
such that _x~hcsn,1~ corresponds to the MSB and x~hcsn,3~ to the LSB._
#### 4.6F.1.9 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
### 4.6F.2 Multiplexing of HS-SCCH type 6 information
The information carried on the HS-SCCH type 6 is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule :
### 4.6F.3 CRC attachment for HS-SCCH type 6
The sequence of bits $b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, is
calculated according to subclause 4.6.3.
### 4.6F.4 Channel coding for HS-SCCH type 6
Channel coding for the HS-SCCH type 6 shall be done with the general method
described in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH type 6.
### 4.6F.5 Rate matching for HS-SCCH type 6
Rate matching for HS-SCCH type 6 shall be done with the general method
described in 4.6.5.
### 4.6F.6 Interleaving for HS-SCCH type 6
Interleaving for HS-SCCH type 6 shall be done with the general method
described in 4.2.11.1.
### 4.6F.7 Physical Channel Segmentation for HS-SCCH type 6
Physical channel segmentation for HS-SCCH type 6 shall be done with the
general method described in 4.2.10. The HS-SCCH consists of two physical
channels HS-SCCH1 and HS-SCCH2.
### 4.6F.8 Physical channel mapping for HS-SCCH type 6
Physical channel mapping for the HS-SCCH type 6 shall be done with the general
method described in subclause 4.2.12.
## 4.6G Coding/Multiplexing for HS-SCCH type 7 (1.28 Mcps TDD only)
HS-SCCH shall be of type 7 when the following two conditions are both met:
\- the variable HS_DSCH_SPS_STATUS is TRUE, and
\- UE is configured in MIMO mode while the variable MIMO SF mode for HS-PDSCH
dual stream is SF1/SF16.
HS-SCCH type 7 is used to allocate one subframe HS-PDSCH resources for
retransmissions of HS-DSCH semi-persistent scheduling operation. The following
information is transmitted by means of the HS-SCCH type 7 physical channels.
\- Type flag (3 bits): _x~flag,1~_ , _x~flag,2~_ , _x~flag,3~_
\- Channelisation-code-set information (8 bits): _x~ccs,1~, x~ccs,2~, ...,
x~ccs,\ 8~_
\- Time slot information (5bits): _x~ts,1~, x~ts,2~, ..., x~ts,5~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- Resource repetition pattern index (2bits): _x~rrpi,1~_ , _x~rrpi,2~_
\- Transport-block size information (2 bits): _x~tbs,1~, x~tbs,2~_
\- Redundancy version information (2 bits): _x~rv,1~, x~rv,2~_
\- Pointer to the previous transmission (4 bits): _x~ptr,1~, x~ptr,2~,
x~ptr,3,~ x~ptr,4~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- Reserved (4 bits): _x~res,1,~ x~res,2,~ x~res,3,~ x~res,4,~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The following coding/multiplexing steps for HS-SCCH type 7 can be identified:
\- multiplexing of HS-SCCH type 7 information (see subclause 4.6G.2)
\- CRC attachment for HS-SCCH type 7 (see subclause 4.6G.3);
\- channel coding for HS-SCCH type 7 (see subclause 4.6G.4);
\- rate matching for HS-SCCH type 7 (see subclause 4.6G.5);
\- interleaving for HS-SCCH type 7 (see subclause 4.6G.6);
\- mapping to physical channels for HS-SCCH type 7 (see subclauses 4.6G.7 and
4.6G.8).
The general coding/multiplexing flow for HS-SCCH type 7 is shown in Figure
19F.
Figure 19F: Coding and Multiplexing for HS-SCCH type 7
### 4.6G.1 HS-SCCH type 7 information field mapping
#### 4.6G.1.1 Type flag mapping
The type flag _x~flag,1~, x~flag,2~, x~flag,3~_ are mapped such that
_x~flag,1~_ =_'1'_ corresponds to the MSB and _x~flag,3~_ =_'0'_ to the LSB.
The bit _x~flag,2~_ is reserved. The type flag is used to distinguish HS-SCCH
type 7 from other types.
#### 4.6G.1.2 Channelisation code set information mapping
The mapping of the channelisation code set information _x~ccs,1~, x~ccs,2,~
x~ccs,3,~ x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,7,~ x~ccs,8~_ is performed
according to section 4.6.1.1.1.
#### 4.6G.1.3 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6G.1.4 Modulation scheme information mapping
The mapping of the modulation scheme information _x~ms,1~_ is performed
according to table 17 in section 4.6.1.3.
#### 4.6G.1.5 Resource repetition pattern index mapping
The mapping of the resource repetition pattern index bits _x~rrpi,1~_ ,
_x~rrpi,2~_ is performed according to section 4.6C.1.2.
#### 4.6G.1.6 Transport block size index mapping
The mapping of the transport-block size information _x~tbs,1~, x~tbs,2~_ is
performed according to section 4.6B.1.4.
#### 4.6G.1.7 Redundancy version information mapping
The mapping of the redundancy version _x~rv,1~, x~rv,2~_ is performed
according to section 4.6C.1.8.
#### 4.6G.1.8 Pointer to the previous transmission mapping
The mapping of the pointer to the previous transmission _x~ptr,1~, x~ptr,2~,
x~ptr,3~_ is performed according to section 4.6C.1.9.
#### 4.6G.1.9 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number _x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_ is mapped
such that _x~hcsn,1~ corresponds to the MSB and x~hcsn,3~ to the LSB._
#### 4.6G.1.10 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
### 4.6G.2 Multiplexing of HS-SCCH type 7 information
The information carried on the HS-SCCH type 7 is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule :
### 4.6G.3 CRC attachment for HS-SCCH type 7
The sequence of bits $b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, is
calculated according to subclause 4.6.3.
### 4.6G.4 Channel coding for HS-SCCH type 7
Channel coding for the HS-SCCH type 7 shall be done with the general method
described in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH type 7.
### 4.6G.5 Rate matching for HS-SCCH type 7
Rate matching for HS-SCCH type 7 shall be done with the general method
described in 4.6.5.
### 4.6G.6 Interleaving for HS-SCCH type 7
Interleaving for HS-SCCH type 7 shall be done with the general method
described in 4.2.11.1.
### 4.6G.7 Physical Channel Segmentation for HS-SCCH type 7
Physical channel segmentation for HS-SCCH type 7 shall be done with the
general method described in 4.2.10. The HS-SCCH consists of two physical
channels HS-SCCH1 and HS-SCCH2.
### 4.6G.8 Physical channel mapping for HS-SCCH type 7
Physical channel mapping for the HS-SCCH type 7 shall be done with the general
method described in subclause 4.2.12.
## 4.6H Coding/Multiplexing for HS-SCCH type 8 (1.28 Mcps TDD only)
HS-SCCH shall be of type 8 when any of the following conditions is met:
\- The UE is configured in MIMO mode, and the variable MIMO SF mode for HS-
PDSCH dual stream is SF1/SF16.
\- The UE is configured in MU-MIMO mode, and the UE is configured in MIMO mode
with the variable MIMO SF mode for HS-PDSCH dual stream being SF1/SF16.
HS-SCCH type 8 is used for single stream transmission in MIMO mode or in MU-
MIMO mode. The following information is transmitted by means of the HS-SCCH
type 8 physical channels.
\- Channelisation-code-set information (4 bits): _x~ccs,1~, x~ccs,2~...,
x~ccs,4~_
\- Transport-block size information (6 bits ): _x~tbs,1~, x~tbs,2~, ...,
x~tbs,6~_
\- Modulation scheme information (1 bit): _x~ms,1~_
\- Time slot information (5bits): _x~ts,1~, x~ts,2~, ..., x~ts,5~_
\- Redundancy version information (2 bits): _x~rv,1~, x~rv,2~_
\- Type flag 1 (6 bits): _x~flag1,1,~ x~flag1,2,~ x~flag1,3,~ x~flag1,4,~
x~flag1,5,~ x~flag1,6,~_
\- Field flag 2 (1 bit): _x~flag2,1~_
\- Special Information (2 bits): _x~info,1~, x~info,2~_
\- Hybrid-ARQ process information (4 bits): _x~hap,1~, x~hap,2~, x~hap,3,~
x~hap,4,~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The following coding/multiplexing steps for HS-SCCH type 8 can be identified:
\- multiplexing of HS-SCCH type 8 information (see subclause 4.6H.2)
\- CRC attachment for HS-SCCH type 8 (see subclause 4.6H.3);
\- channel coding for HS-SCCH type 8 (see subclause 4.6H.4);
\- rate matching for HS-SCCH type 8 (see subclause 4.6H.5);
\- interleaving for HS-SCCH type 8 (see subclause 4.6H.6);
\- mapping to physical channels for HS-SCCH type 8 (see subclauses 4.6H.7 and
4.6H.8).
The general coding/multiplexing flow for HS-SCCH type 8 is shown in Figure
19G.
Figure 19G: Coding and Multiplexing for HS-SCCH type 8
### 4.6H.1 HS-SCCH type 8 information field mapping
#### 4.6H.1.1 Channelisation code set information mapping
HS-PDSCH channelisation codes are allocated contiguously from a signalled
start code to a signalled stop code, and the allocation includes both the
start and stop code.
If the field flag _x~flag2,1~_ =_'0'_ , the special information _x~info,1~,
x~info,2~_ are comprised of the channelisation code set extended information
_x~ccs,5~, x~ccs,6~_ and _x~info,1~_ = _x~ccs,5~_ , _x~info,2~_ = _x~ccs,6~_.
The start code _k~start~_ is signalled by the bits _x~ccs,1~, x~ccs,2,~
x~ccs,5~_ and the stop code _k~stop~_ by the bits _x~ccs,3,~ x~ccs,4~,
x~ccs,6~_. The mapping in Table 16Ba below applies.
If a value of _k~start~_ = 5 and _k~stop~_ = 2 is signalled, a spreading
factor of SF=1 shall be used for the HS-PDSCH resources. Other than this case,
_k~start~_ > _k~stop~_ are not used.
If the field flag _x~flag2,1~_ =_'1'_ , the bits _x~info,1~, x~info,2~_ are
comprised of the special default midamble pattern indicator (_x~mpi,1~,
x~mpi,2~_) and _x~info,1~= x~mpi,1~ and x~info,2~= x~mpi,2~_. The mapping in
Table 16Bb below applies. The start code _k~start~_ is signalled by the bits
_x~ccs,1~, x~ccs,2~_ and the stop code _k~stop~_ by the bits _x~ccs,3,~
x~ccs,4~_. The mapping in Table 16Bc below applies.
If a value of _k~start~_ =13 and _k~stop~_ = 4 is signalled, a spreading
factor of SF=1 shall be used for the HS-PDSCH resources. Other than this case,
_k~start~_ > _k~stop~_ are not used
Table 16Ba: Channelisation code set information mapping
* * *
_k~start~_ _x~ccs,1~_ _x~ccs,2~_ _x~ccs,5~_ _k~stop~_ _x~ccs,3~_ _x~ccs,4~_
_x~ccs,6~_ 1 0 0 0 2 0 0 0 3 0 0 1 4 0 0 1 5 0 1 0 6 0 1 0 7 0 1 1 8 0 1 1 9 1
0 0 10 1 0 0 11 1 0 1 12 1 0 1 13 1 1 0 14 1 1 0 15 1 1 1 16 1 1 1
* * *
Table 16Bb: Special default midamble pattern mapping
* * *
_Special default Mid-amble pattern_ _x~mpi,1~_ _x~mpi,2~_ pattern 1A 0 0
pattern 1B 0 1 pattern 2A 1 0 pattern 2B 1 1
* * *
Table 16Bc: Channelisation code set information mapping
* * *
_k~start~_ _x~ccs,1~_ _x~ccs,2~_ _k~stop~_ _x~ccs,3~_ _x~ccs,4~_ 1 0 0 4 0 0 5
0 1 8 0 1 9 1 0 12 1 0 13 1 1 16 1 1
* * *
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is FALSE, HS-PDSCH
channelization codes of all the allocated timeslots are indicated by
channelisation-code-set information field.
If NON_RECTANGULAR_Resource_ ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is not configured via higher layer signalling,
the specific timeslot refers to the timeslot with the maximal timeslot index
among all the timeslots scheduled to the UE and HS-PDSCH channelisation codes
of the specific timeslot is indicated by channelisation-code set information
field. The HS-PDSCH channelisation codes of timeslot 0 are signalled via
higher layer signalling if timeslot 0 is scheduled to the UE. The HS-PDSCH
channelisation codes of other scheduled timeslots are predefined, i.e. the
entire resource of each timeslot is scheduled to the UE with SF=1.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is configured via higher layer signalling, HS-
PDSCH channelisation codes in the specific timeslot is indicated by
channelisation-code set information field. The HS-PDSCH channelisation codes
of other scheduled timeslots are predefined, i.e. the entire resource of the
timeslot is scheduled to the UE with SF=1.
#### 4.6H.1.2 Transport block size index mapping
The transport-block size information _x~tbs,1~, x~tbs,2~, ..., x~tbs,6\ ~_ is
the unsigned binary representation of the transport block size index where
_x~tbs,1~_ is MSB. The mapping is performed according to section 4.6.1.8.
#### 4.6H.1.3 Modulation scheme information mapping
The mapping of the modulation scheme information _x~ms,1~_ is performed
according to section 4.6.1.3.
#### 4.6H.1.4 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6H.1.5 Redundancy version information mapping
The redundancy version (RV) parameters _r_ , _s_ and constellation version
parameter _b_ are mapped jointly to produce the value X~rv~. X~rv~ is
alternatively represented as the sequence _x~rv,1~, x~rv,2~_ where _x~rv,1~_
is the MSB. The mapping is performed according to section 4.6C.1.8. If X~rv~
=0, the UE shall treat the corresponding transport block as an initial
transmission.
#### 4.6H.1.6 Type flag mapping
The type flag _x~flag1,1,~ x~flag1,2,~ x~flag1,3,~ x~flag1,4,~ x~flag1,5,~
x~flag1,6~_ is mapped as _'000000'_. The type flag is used to distinguish HS-
SCCH type 8 from other types.
#### 4.6H.1.7 Field flag mapping
The field flag is used to distinguish the mapping of special information
_x~info,1~, x~info,2~_.
If _x~flag2,1~_ =_'0'_ , the special information _x~,info,1~, x~info,2~_ are
comprised of the channelisation code set extended information _x~ccs,5~,
x~ccs,6~_ and _x~info,1~_ = _x~ccs,5~_ , _x~info,2~_ = _x~ccs,6~_.
If _x~flag2,1~_ =_'1'_ , the special information _x~,info,1~, x~info,2~_ are
comprised of the special default midamble pattern indicator (_x~mpi,1~,
x~mpi,2~_).
#### 4.6H.1.8 Special Information mapping
The special information _x~,info,1~, x~info,2~_ is mapped such that
_x~,info,1~_ corresponds to the MSB and _x~info,2~_ to the LSB.
If _x~flag2,1~_ =_'0'_ , the special information _x~,info,1~, x~info,2~_ are
comprised of the channelisation code set extended information _x~ccs,5~,
x~ccs,6~_ and _x~info,1~_ = _x~ccs,5~_ , _x~info,2~_ = _x~ccs,6~_.
If _x~flag2,1~_ =_'1'_ , the special information _x~,info,1~, x~info,2~_ are
comprised of the special default midamble pattern indicator (_x~mpi,1~,
x~mpi,2~_).
#### 4.6H.1.9 HARQ process identifier mapping
The hybrid-ARQ process information _x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~_ is
unsigned binary representation of the HARQ process identifier where _x~hap,1~_
is MSB.
#### 4.6H.1.10 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number _x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_ is mapped
such that _x~hcsn,1~ corresponds to the MSB and x~hcsn,3~ to the LSB._
#### 4.6H.1.11 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
### 4.6H.2 Multiplexing of HS-SCCH type 8 information
The information carried on the HS-SCCH type 8 is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule:
### 4.6H.3 CRC attachment for HS-SCCH type 8
The sequence of bits $b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, is
calculated according to subclause 4.6.3.
### 4.6H.4 Channel coding for HS-SCCH type 8
Channel coding for the HS-SCCH type 8 shall be done with the general method
described in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH type 8.
### 4.6H.5 Rate matching for HS-SCCH type 8
Rate matching for HS-SCCH type 8 shall be done with the general method
described in 4.6.5.
### 4.6H.6 Interleaving for HS-SCCH type 8
Interleaving for HS-SCCH type 8 shall be done with the general method
described in 4.2.11.1.
### 4.6H.7 Physical Channel Segmentation for HS-SCCH type 8
Physical channel segmentation for HS-SCCH type 8 shall be done with the
general method described in 4.2.10. The HS-SCCH consists of two physical
channels HS-SCCH1 and HS-SCCH2.
### 4.6H.8 Physical channel mapping for HS-SCCH type 8
Physical channel mapping for the HS-SCCH type 8 shall be done with the general
method described in subclause 4.2.12.
## 4.6I Coding/Multiplexing for HS-SCCH type 9 (1.28 Mcps TDD only)
HS-SCCH shall be of type 9 when the following conditions are true:
\- the UE is configured in MIMO mode, and
\- the variable MIMO SF mode for HS-PDSCH dual stream is SF1/SF16.
HS-SCCH type 9 is used for dual stream transmission in MIMO mode. The
following information is transmitted by means of the HS-SCCH type 9 physical
channels.
\- Channelisation-code-set information (4 bits): _x~ccs,1~, x~ccs,2~...,
x~ccs,4~_
\- Transport-block size information for stream 1 (6 bits): _x~tbs1,1~,
x~tbs1,2~, ..., x~tbs1,6~_
\- Modulation scheme information for stream 1 (1 bit): _x~ms1,1~_
\- Time slot information (5bits): _x~ts,1~, x~ts,2~, ..., x~ts,5~_
\- Redundancy version information for stream 1 (2 bits): _x~rv1,1~, x~rv1,2~_
\- Transport-block size information for stream 2 (6 bits): _x~tbs2,1~,
x~tbs2,2~, ..., x~tbs2,6~_
\- Modulation scheme information for stream 2 (1 bit): _x~ms2,1~_
\- Redundancy version information for stream 2 (2 bits): _x~rv2,1~, x~rv2,2~_
\- Hybrid-ARQ process information (4 bits): _x~hap,1~, x~hap,2~, x~hap,3,~
x~hap,4,~_
_\- HS-SCCH cyclic sequence number (3 bits): x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The following coding/multiplexing steps for HS-SCCH type 9 can be identified:
\- multiplexing of HS-SCCH type 9 information (see subclause 4.6I.2)
\- CRC attachment for HS-SCCH type 9 (see subclause 4.6I.3);
\- channel coding for HS-SCCH type 9 (see subclause 4.6I.4);
\- rate matching for HS-SCCH type 9 (see subclause 4.6I.5);
\- interleaving for HS-SCCH type 9 (see subclause 4.6I.6);
\- mapping to physical channels for HS-SCCH type 9 (see subclauses 4.6I.7 and
4.6I.8).
The general coding/multiplexing flow for HS-SCCH type 9 is shown in Figure
19H.
Figure 19H: Coding and Multiplexing for HS-SCCH type 9
### 4.6I.1 HS-SCCH type 9 information field mapping
#### 4.6I.1.1 Channelisation code set information mapping
HS-PDSCH channelisation codes are allocated contiguously from a signalled
start code to a signalled stop code, and the allocation includes both the
start and stop code. The start code _k~start~_ is signalled by the bits
_x~ccs,1~, x~ccs,2~_ and the stop code _k~stop~_ by the bits _x~ccs,3,~
x~ccs,4~_. The mapping in Table 16 C below applies.
If a value of _k~start~_ = 5 and _k~stop~_ = 4 is signalled, a spreading
factor of SF=1 shall be used for the HS-PDSCH resources. Other than this case,
_k~start~_ > _k~stop~_ are not used.
Table 16C: Channelisation code set information mapping
* * *
_k~start~_ _x~ccs,1~_ _x~ccs,2~_ _k~stop~_ _x~ccs,3~_ _x~ccs,4~_ 1 0 0 4 0 0 5
0 1 8 0 1 9 1 0 12 1 0 13 1 1 16 1 1
* * *
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is FALSE, HS-PDSCH
channelization codes of all the allocated timeslots are indicated by
channelisation-code-set information field.
If NON_RECTANGULAR_Resource_ ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is not configured via higher layer signalling,
the specific timeslot refers to the timeslot with the maximal timeslot index
among all the timeslots scheduled to the UE and HS-PDSCH channelisation codes
of the specific timeslot is indicated by channelisation-code set information
field. The HS-PDSCH channelisation codes of timeslot 0 are signalled via
higher layer signalling if timeslot 0 is scheduled to the UE. The HS-PDSCH
channelisation codes of other scheduled timeslots are predefined, i.e. the
entire resource of each timeslot is scheduled to the UE with SF=1.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is configured via higher layer signalling, HS-
PDSCH channelisation codes in the specific timeslot is indicated by
channelisation-code set information field. The HS-PDSCH channelisation codes
of other scheduled timeslots are predefined, i.e. the entire resource of the
timeslot is scheduled to the UE with SF=1.
#### 4.6I.1.2 Transport block size offset information mapping
The transport-block size information for stream 1 _x~tbs1,1~, x~tbs1,2~, ...,
x~tbs1,6~_ is the unsigned binary representation of the transport block size
index where _x~tbs1,1~_ is MSB. The mapping is performed according to section
4.6.1.8.
The transport-block size information for stream 2 _x~tbs2,1~, x~tbs2,2~, ...,
x~tbs2,6\ ~_ is the unsigned binary representation of the transport block size
index where _x~tbs2,1~_ is MSB. The mapping is performed according to section
4.6.1.8.
#### 4.6I.1.3 Modulation scheme information mapping
The mapping of the modulation scheme information for each stream (_x~ms1,1~_
for stream 1 or _x~ms2,1~_ for stream 2 ) is performed according to section
4.6.1.3.
#### 4.6I.1.4 Timeslot information mapping
The mapping of the time slot information _x~ts,1~, x~ts,2~, ... x~ts,5~_ is
performed according to section 4.6.1.2.1.
#### 4.6I.1.5 Redundancy version information mapping
The mapping of the redundancy version for each stream ( _x~rv1,1~, x~rv1,2~_
for stream 1 and _x~rv2,1~, x~rv2,2~_ for stream 2 ) is performed according to
section 4.6E.1.8.
#### 4.6I.1.6 HARQ process identifier mapping
The hybrid-ARQ process information _x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~_ is
unsigned binary representation of the HARQ process identifier where _x~hap,1~_
is MSB.
For dual stream transmission, two transport blocks are transmitted on the
associated HS-PDSCH(s), and the mapping relationship between the hybrid-ARQ
processes and the transport blocks is such that when the HARQ-process with
identifier $\text{HAP}_{1}$is mapped to the transport block on stream 1, the
HARQ-process with the identifier given by $\left( \text{HAP}_{1} +
N_{\text{proc}}/2 \right)\text{mod}\left( N_{\text{proc}} \right)$ shall be
mapped to the transport block on stream 2, where _N~proc~_ is the number of
HARQ processes configured by higher layers.
#### 4.6I.1.9 HS-SCCH cyclic sequence number
The HS-SCCH cyclic sequence number _x~hcsn,1~, x~hcsn,2~, x~hcsn,3~_ is mapped
such that _x~hcsn,1~ corresponds to the MSB and x~hcsn,3~ to the LSB._
#### 4.6I.1.10 UE identity
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
### 4.6I.2 Multiplexing of HS-SCCH type 9 information
The information carried on the HS-SCCH type 9 is multiplexed onto the bits
$a_{1},a_{2},\text{.}\text{.}\text{.}a_{A}$according to the following rule :
### 4.6I.3 CRC attachment for HS-SCCH type 9
The sequence of bits $b_{1},b_{2},\text{.}\text{.}\text{.}b_{B}$, is
calculated according to subclause 4.6.3.
### 4.6I.4 Channel coding for HS-SCCH type 9
Channel coding for the HS-SCCH type 9 shall be done with the general method
described in 4.2.3 with the following specific parameters:
The rate 1/3 convolutional coding shall be used for HS-SCCH type 9.
### 4.6I.5 Rate matching for HS-SCCH type 9
Rate matching for HS-SCCH type 9 shall be done with the general method
described in 4.6.5.
### 4.6I.6 Interleaving for HS-SCCH type 9
Interleaving for HS-SCCH type 9 shall be done with the general method
described in 4.2.11.1.
### 4.6I.7 Physical Channel Segmentation for HS-SCCH type 9
Physical channel segmentation for HS-SCCH type 9 shall be done with the
general method described in 4.2.10. The HS-SCCH consists of two physical
channels HS-SCCH1 and HS-SCCH2.
### 4.6I.8 Physical channel mapping for HS-SCCH type 9
Physical channel mapping for the HS-SCCH type 9 shall be done with the general
method described in subclause 4.2.12.
## 4.6J Coding/Multiplexing for HS-SCCH orders type B (1.28Mcps TDD only)
HS-SCCH orders type B are commands sent to the UE using HS-SCCH. No HS-PDSCH
is associated with HS-SCCH orders.
HS-SCCH order type B may be used when any of the following two conditions is
met:
\- CONTROL_CHANNEL_DRX_STATUS is TRUE and UE is configured in MIMO mode while
the variable MIMO SF mode for HS-PDSCH dual stream is SF1/SF16;
\- The variable HS_DSCH_SPS_STATUS is TRUE, and UE is configured in MIMO mode
while the variable MIMO SF mode for HS-PDSCH dual stream is SF1/SF16.
The following information is transmitted by means of the HS-SCCH order type B
physical channel.
\- Order type (3 bits): _x~odt,1~, x~odt,2~, x~odt,3~_
\- UE identity (16 bits): _x~ue,1~, x~ue,2~, ..., x~ue,16~_
The coding for HS-SCCH orders type B is specified in subclause 4.6F.
### 4.6J.1 HS-SCCH orders type B information field mapping
#### 4.6J.1.1 Order type mapping
If _x~odt,1~, x~odt,2~, x~odt,3~_ = _'001'_ , then the HS-SCCH order is an
order to release the allocated semi-persistent HS-PDSCH resources when UE is
in CELL_DCH state.
If _x~odt,1~, x~odt,2~, x~odt,3~_ = _'010'_ , then the HS-SCCH order is DRX
Activation order when UE is in CELL_DCH state.
If _x~odt,1~, x~odt,2~, x~odt,3~_ = _'011'_ , then the HS-SCCH order is DRX
De-activation order when UE is in CELL_DCH state.
#### 4.6J.1.2 UE identity mapping
_The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined in
[12]._ This is mapped such that _x~ue,1~ corresponds to the MSB and x~ue,16~
to the LSB_ , cf. [14]_._
## 4.7 Coding for HS-SICH
The following information, provided by higher layers, is transmitted by means
of the HS-SICH physical channel.
For 1.28 Mcps TDD, HS-SICH type 1 is not used for dual stream transmission
when UE is configured in MIMO mode.
In this section, the terms "HS-SICH" and "HS-SICH type 1" are used
interchangeably.
For 1.28 Mcps TDD, in the case of multi-frequency HS-DSCH transmission in one
TTI, HS-PDSCH on each frequency shall be configured with associated HS-SICH(s)
which is coded as following.
\- Recommended Modulation Format (RMF) (1 bit): _x~rmf,1~_
\- Recommended Transport-block size (RTBS) (n bits where n = 6 for 1.28 Mcps
TDD and n = 9 for 3.84 Mcps TDD and 7.68Mcps TDD): _x~tbs,1~, x~tbs,2~, ...,
x~tbs,n~_
\- Hybrid-ARQ information ACK/NACK (1 bit): _x~an,1~_
The following coding/multiplexing steps can be identified:
\- separate coding of RMF, RTBS and ACK/NACK (see subclause 4.7.2);
\- multiplexing of HS-SICH information (see subclause 4.7.3);
\- interleaving for HS-SICH (see subclause 4.7.4);
\- mapping to physical channels (see subclause 4.7.5).
The general coding/multiplexing flow is shown in the figure 20.
Figure 20: Coding and multiplexing for HS-SICH
### 4.7.1 HS-SICH information field mapping
#### 4.7.1.1 RMF information mapping
The RMF information bit, _x~rmf,1~_ , shall be mapped according to the mapping
specified in subclause 4.6.1.3.
#### 4.7.1.2 RTBS information mapping
The RTBS information bits, _x~tbs,1~, x~tbs,2~, ..., x~tbs,n~_ , shall be
mapped according to the same mapping as is used for the transport block size
information bits in subclause 4.6. This mapping is defined by higher layers
[12].
#### 4.7.1.3 ACK/NACK information mapping
The ACK/NACK information bit _x~an,1~_ shall be mapped according to the
mapping given in Table 20 below.
Table 20: ACK/NACK information mapping
* * *
ACK/NACK _x~an,1~_ ACK 1 NACK 0
* * *
### 4.7.2 Coding for HS-SICH
#### 4.7.2.1 Field Coding of ACK/NACK
The ACK/NACK bit _x~an,1\ ~_ shall be repetition coded to 36 bits. The coded
bits are defined as $c_{1}\text{.}\text{.}\text{.}c_{\text{36}}$.
#### 4.7.2.2 Field Coding of CQI
##### 4.7.2.2.1 Field Coding of CQI for 1.28 Mcps TDD
The quality information consists of Recommended Transport Block Size (RTBS)
and Recommended Modulation Format (RMF) fields. The 6 bits of the RTBS field
are coded to 32 bits using a (32, 6) 1^st^ order Reed-Muller code. The coding
procedure is as shown in figure 21.
Figure 21: Field coding of RTBS information bits
The coding uses a subset basis sequences as the TFCI coder as described in
subclause 4.3.1.1. The basis sequences that are used for RTBS coding are as
follows in table 21.
Table 21: Basis sequences for (32,6) RTBS code
* * *
i M~i,0~ M~i,1~ M~i,2~ M~i,3~ M~i,4~ M~i,5~ 0 1 0 0 0 0 1 1 0 1 0 0 0 1 2 1 1
0 0 0 1 3 0 0 1 0 0 1 4 1 0 1 0 0 1 5 0 1 1 0 0 1 6 1 1 1 0 0 1 7 0 0 0 1 0 1
8 1 0 0 1 0 1 9 0 1 0 1 0 1 10 1 1 0 1 0 1 11 0 0 1 1 0 1 12 1 0 1 1 0 1 13 0
1 1 1 0 1 14 1 1 1 1 0 1 15 1 0 0 0 1 1 16 0 1 0 0 1 1 17 1 1 0 0 1 1 18 0 0 1
0 1 1 19 1 0 1 0 1 1 20 0 1 1 0 1 1 21 1 1 1 0 1 1 22 0 0 0 1 1 1 23 1 0 0 1 1
1 24 0 1 0 1 1 1 25 1 1 0 1 1 1 26 0 0 1 1 1 1 27 1 0 1 1 1 1 28 0 1 1 1 1 1
29 1 1 1 1 1 1 30 0 0 0 0 0 1 31 0 0 0 0 1 1
* * *
The output RTBS code word bits {z~i~ : i = 1, ... , 32} are given by:
The RMF bit _x~rmf,1~_ is repetition coded to 16 bits to produce the bits .
$z_{\text{33}},z_{\text{34}},\text{.}\text{.}\text{.},z_{n_{{}_{\text{CQI}}}}$
where _n~CQI~_ = 48.
##### 4.7.2.2.2 Field Coding of CQI for 3.84 Mcps TDD and 7.68Mcps TDD
RTBS and RMF bits are multiplexed onto the bits
$y_{1},y_{2}\text{.}\text{.}\text{.}y_{\text{10}}$according to the following
rule :
The bits $y_{1},y_{2}\text{.}\text{.}\text{.}y_{\text{10}}$are coded to
produce the bits _w~1~,w~2~,...w~32~_ using a (32,10) sub-code of the second
order Reed-Muller code as defined in subclause 4.3.1.1..
The bits _w~1~,w~2~,...w~32~_ are used to produce the CQI bits
$z_{1},z_{2}\text{.}\text{.}\text{.}z_{n_{\text{CQI}}}$ using a (4,1)
repetition code, where _n~CQI~=128_ , such that:
_z~n~, z~n+32~, z~n+64~, z~n+96~ = w~n~ n=1...32_
### 4.7.3 Multiplexing of HS-SICH information fields
The CQI bits $z_{1},z_{2}\text{.}\text{.}\text{.}z_{n_{\text{CQI}}}$are
multiplexed with the repetition coded ACK/NACK bits
$c_{1}\text{.}\text{.}\text{.}c_{\text{36}}$ to produce the bits
$d_{1},d_{2}\text{.}\text{.}\text{.}d_{U}$where $U$ is the number of physical
channel bits carried by HS-SICH, according to the following rule.:
### 4.7.4 Interleaver for HS-SICH
Interleaver for HS-SICH shall be done with the general method described in
4.2.11.1.
### 4.7.5 Physical channel mapping for HS-SICH
Physical channel mapping for HS-SICH shall be done with the general method
described in 4.2.12.
## 4.7A Coding for HS-SICH type 2 (1.28 Mcps TDD only)
HS-SICH type 2 is used for dual stream transmission when UE is configured in
MIMO mode.
The following information, provided by higher layers, is transmitted by means
of the HS-SICH type 2 physical channels.
\- Recommended Modulation Format (RMF) for stream 1 (1 bit): _x~rmf1,1~_
\- Recommended Modulation Format (RMF) for stream 2 (1 bit): _x~rmf2,1~_
\- Recommended Transport-block size (RTBS) for stream 1 (n=6 bits):
_x~tbs1,1~, x~tbs1,2~, ..., x~tbs1,n~_
\- Recommended Transport-block size (RTBS) for stream 2 (n=6 bits):
_x~tbs2,1~, x~tbs2,2~, ..., x~tbs2,n~_
\- Hybrid-ARQ information ACK/NACK for stream 1 (1 bit): _x~an1,1~_
\- Hybrid-ARQ information ACK/NACK for stream 2 (1 bit): _x~an2,1~_
The following coding/multiplexing steps can be identified:
\- separate coding of RMF, RTBS and ACK/NACK (see subclause 4.7A.2);
\- multiplexing of HS-SICH information (see subclause 4.7A.3);
\- interleaving for HS-SICH (see subclause 4.7A.4);
\- mapping to physical channels (see subclause 4.7A.5).
The general coding/multiplexing flow for HS-SICH type 2 is shown in the figure
20A.
Figure 20A: Coding and multiplexing for HS-SICH type 2
### 4.7A.1 HS-SICH type 2 information field mapping
#### 4.7A.1.1 RMF information mapping
The RMF information bit for each stream, _x~rmf1,1~_ for stream 1 or
_x~rmf2,1~_ for stream 2, shall be mapped according to the mapping given in
subclause 4.7.1.1 respectively.
#### 4.7A.1.2 RTBS information mapping
The RTBS information bits for each stream , _x~tbs1,1~, x~tbs1,2~, ...,
x~tbs1,n\ ~_ for stream 1 or _x~tbs2,1~, x~tbs2,2~, ..., x~tbs2,n~_ for stream
2, shall be mapped according to the mapping given in subclause 4.7.1.2
respectively.
#### 4.7A.1.3 ACK/NACK information mapping
The ACK/NACK information bit for each stream, _x~an1,1~_ for stream 1 or
_x~an2,1~_ for stream 2, shall be mapped according to the mapping given in
subclause 4.7.1.3 respectively.
### 4.7A.2 Coding for HS-SICH type 2
#### 4.7A.2.1 Field Coding of ACK/NACK
The ACK/NACK bit for stream 1, _x~an1,1\ ~_ , shall be repetition coded to 36
bits. The coded bits are defined as
$c_{1,1}\text{.}\text{.}\text{.}c_{1,\text{36}}$.
The ACK/NACK bit for stream 2, _x~an2,1\ ~_ , shall be repetition coded to 36
bits. The coded bits are defined as
$c_{2,1}\text{.}\text{.}\text{.}c_{2,\text{36}}$.
#### 4.7A.2.2 Field Coding of CQI
The quality information for each stream consists of Recommended Transport
Block Size (RTBS) and Recommended Modulation Format (RMF) fields. The 6 bits
of the RTBS field for each stream are coded to 32 bits using a (32, 6) 1^st^
order Reed-Muller code respectively. The coding procedure for each stream is
performed according to section 4.7.2.2 shown in figure 21A and figure 21B.
Figure 21A: Field coding of RTBS information bits for stream 1
Figure 21B: Field coding of RTBS information bits for stream 2
The RMF bit for stream 1, _x~rmf1,1~_ , is repetition coded to 16 bits to
produce the bits .
$z_{1,\text{33}},z_{1,\text{34}},\text{.}\text{.}\text{.},z_{{1,n}_{{}_{\text{CQI}}}}$
where _n~CQI~_ = 48.
The RMF bit for steam 2, _x~rmf2,1~ ,_ is repetition coded to 16 bits to
produce the bits .
$z_{2,\text{33}},z_{2,\text{34}},\text{.}\text{.}\text{.},z_{{2,n}_{{}_{\text{CQI}}}}$
where _n~CQI~_ = 48.
### 4.7A.3 Multiplexing of HS-SICH type 2 information fields
The CQI bits for each stream,
$z_{1,1},z_{1,2}\text{.}\text{.}\text{.}z_{1,n_{\text{CQI}}}$
or$z_{2,1},z_{2,2}\text{.}\text{.}\text{.}z_{2,n_{\text{CQI}}}$, are
multiplexed with the repetition coded ACK/NACK bits for each stream,
$c_{1,1}\text{.}\text{.}\text{.}c_{1,\text{36}}$ or
$c_{2,1}\text{.}\text{.}\text{.}c_{2,\text{36}}$, to produce the bits
$d_{1},d_{2}\text{.}\text{.}\text{.}d_{U}$where $U$is the number of physical
channel bits carried by HS-SICH, according to the following rule:
### 4.7A.4 Interleaver for HS-SICH type 2
Interleaver for HS-SICH shall be done with the general method described in
4.2.11.1.
### 4.7A.5 Physical channel mapping for HS-SICH type 2
Physical channel mapping for HS-SICH shall be done with the general method
described in 4.2.12.
## 4.8 Coding for E‑DCH
Figure 22 shows the processing structure for the E‑DCH transport channel
mapped onto a separate CCTrCH. Data arrives to the coding unit in form of a
maximum of one transport block once every transmission time interval (TTI). A
10ms TTI is used for E-DCH for 3.84Mcps and 7.68Mcps TDD whilst for 1.28Mcps
TDD, a TTI of 5ms will be used.
For 1.28Mcps TDD multi-carrier E-DCH transmission, a number of transport
blocks may arrive at the coding unit in one TTI, where the number of the
transport blocks equals to the number of the scheduled E-DCH carriers. Each
transport block for each scheduled E-DCH carrier shall be coded separately.
The following coding steps for E-DCH on one carrier can be identified:
\- add CRC to each transport block (see subclause 4.8.1);
\- code block segmentation (see subclause 4.8.2);
\- channel coding (see subclause 4.8.3);
\- hybrid ARQ (see subclause 4.8.4);
\- bit scrambling (see subclause 4.8.5);
\- interleaving for E-DCH (see subclause 4.8.6);
\- constellation re-arrangement for 16QAM (see subclause 4.8.7);
\- mapping to physical channels (see subclause 4.8.8).
Figure 22. Coding chain for E-DCH
In the following the number of transport blocks is always one. When
referencing non E-DCH formulae which are used in correspondence with E-DCH
formulae the convention is used that transport block subscripts may be omitted
(e.g. X~i~ when i is always 1 may be written X).
### 4.8.1 CRC attachment for E-DCH
CRC attachment for the E-DCH transport channel shall be performed according to
the general method described in 4.2.1 above with the following specific
parameters.
The CRC length shall always be _L~1~_ =24 bits.
### 4.8.2 Code block segmentation for E-DCH
Code block segmentation for the E-DCH transport channel shall be performed
according to the general method described in 4.2.2.2 with the following
specific parameters.
There is a maximum of one transport block. The bits
$b_{\text{im}1},b_{\text{im}2},b_{\text{im}3},\text{.}\text{.}\text{.},b_{\text{imB}_{i}}$
input to the block are mapped to the bits
$x_{i1},x_{i2},x_{i3},\text{.}\text{.}\text{.},x_{\text{iX}_{i}}$ directly. It
follows that _X~i~_ = _B~i~_. Note that the bits _x_ referenced here refer
only to the internals of the code block segmentation function. The output bits
from the code block segmentation function are _o~ir1~_ , _o~ir2~_ , _o~ir3~_ ,
..., _o~irK~_.
The value of _Z_ = 5114 for turbo coding shall be used.
### 4.8.3 Channel coding for E-DCH
Channel coding for the E-DCH transport channel shall be performed according to
the general method described in section 4.2.3 above with the following
specific parameters.
There is a maximum of one transport block, _i_ =1. The rate 1/3 turbo coding
shall be used.
### 4.8.4 Physical layer HARQ functionality and rate matching for E-DCH
The hybrid ARQ functionality matches the number of bits at the output of the
channel coder to the total number of bits of the E-PUCH set to which the E-DCH
transport channel is mapped. The hybrid ARQ functionality is controlled by the
redundancy version (RV) parameters.
Figure 23: E‑DCH hybrid ARQ functionality
#### 4.8.4.1 Determination of SF, modulation and number of physical channels
The SF, modulation type and number of E-PUCHs in the E-PUCH set is determined
by higher layers (see [15]). These correspond to a value of _N~e,data,j~_.
#### 4.8.4.2 HARQ bit separation
The HARQ bit separation function shall be performed in the same way as bit
separation for turbo encoded TrCHs with puncturing in 4.2.7.2.1 above.
#### 4.8.4.3 HARQ Rate Matching Stage
The hybrid ARQ rate matching for the E-DCH transport channel shall be done
with the general method described in 4.2.7.3 with the following specific
parameters.
The parameters of the rate matching stage depend on the value of the RV
parameters _s_ and _r_. The _s_ and _r_ combinations corresponding to each RV
allowed for the E-DCH are listed in table 22 below.
Table 22: RV for E-DCH
* * *
E-DCH RV Index _s_ _r_ 0 1 0 1 0 0 2 1 1 3 0 1
* * *
The parameter _e~plus~_ , _e~minus~_ and _e~ini~_ are calculated with the
general method described in 4.5.4.3 above. The following parameters are used
as input:
_N~sys~_ = _N~p1~_ = _N~p2~_ = _N~e,j~_ /3
_N~data~_ = _N~e,data,j~_
_r~max~_ = 2 (for both QPSK and 16-QAM)
#### 4.8.4.4 HARQ bit collection
HARQ bit collection for E-DCH shall be performed according to the general
method described for HS-DSCH in subclause 4.5.4.4.
### 4.8.5 Bit scrambling
The bit scrambling for E-DCH shall be performed in accordance with the general
method described in subclause 4.2.9.
### 4.8.6 Interleaving for E-DCH
Interlevaing for E-DCH shall be performed in accordance with the general
method described for HS-DSCH in subclause 4.5.6.
### 4.8.7 Constellation re-arrangement for 16 QAM
Constellation rearrangement shall be performed in the case of 16-QAM in
accordance with the general method described for HS-DSCH in subclause 4.5.7.
For QPSK this function is transparent.
For 3.84Mcps and 7.68Mcps, the constellation version parameter _b_ is
associated with the E-DCH RV index as shown in table 23 below.
Table 23: Mapping of RV to constellation rearrangement parameter _b_ for E-DCH
(3.84Mcps and 7.68Mcps options)
* * *
E-DCH RV Index _b_ 0 0 1 1 2 2 3 3
* * *
For 1.28Mcps option, the constellation version parameter _b_ is associated
with the retransmission sequence number (RSN). The mapping between RSN and b
parameters for constellation re-arrangement is listed in table 25A in
subclause 4.9.2.1.2.
### 4.8.8 Physical channel mapping for E-DCH
The E-PUCH is defined in [7]. The bits input to the physical channel mapping
are denoted by _r~1~_ , _r~2~_ , ..., _r~R~_ , where _R= N~e,data,j~_ and is
the number of physical channel data bits to be transmitted in the current TTI.
These bits are mapped to the physical channel bits, {_w~t,k~_ : _t_ = 1, 2,
..., _T_ ; and _k_ = 1, 2, ..., _U~t~_}, where _t_ is the timeslot index, _T_
is the number of timeslots in the allocation message _, k_ is the physical
channel bit index and _U~t~_ is the number of bits in the E-PUCH physical
channel in timeslot _t_. The timeslot index, _t_ , increases with increasing
timeslot number and the physical channel bit index, _k_ , increases with
increasing physical channel bit position in time.
The bits _r~1~_ , _r~2~_ , ..., _r~R~_ shall be mapped to the physical channel
bits _w~t,k~_ according to the following rule :
$w_{1,k} = r_{k}$ for _k_ = 1, 2, ..., _U~1~_
$w_{2,k} = r_{k + U_{1}}$ for _k_ = 1, 2, ..., _U~2~_
...
$w_{T,k} = r_{k + \sum_{t = 1}^{T - 1}U_{t}}$ for _k_ = 1, 2, ..., _U~T~_
## 4.9 Coding for E‑UCCH
### 4.9.1 Coding for E-UCCH for the 3.84Mcps and 7.68Mcps TDD options
E-UCCH is coded in two parts, E-UCCH part 1 and E-UCCH part 2. Both parts of
the E-UCCH are transmitted on the E-PUCH (see [7]).
The following information is transmitted by means of E-UCCH part 1:
\- E-TFCI information: _x~tfci,1~_ , _x~tfci,2~_ , ..., _x~tfci,7~_
The following information is transmitted by means of E-UCCH part 2:
\- Retransmission sequence number (RSN): _x~rsn,1~_ , _x~rsn,2~_
\- HARQ process ID (HARQ_ID): _x~harq,1~_ , _x~harq,2~_
#### 4.9.1.1 Overview
Figure 24 below illustrates the overall coding chain for E-UCCH.
Figure 24: Coding chain for E‑UCCH parts 1 and 2
#### 4.9.1.2 E‑UCCH part 1
##### 4.9.1.2.1 Information field mapping of E‑TFCI
The E‑TFCI is mapped such that _x~tfci,1~ corresponds to the MSB._
##### 4.9.1.2.2 Channel coding for E-UCCH part 1
The E-TFCI bits
$x_{\text{tfci},1},x_{\text{tfci},2},\text{.}\text{.}\text{.},x_{\text{tfci},7}$are
zero-padded and coded to produce the bits _y~0~, y~1~,...y~31~_ using a
(32,10) sub-code of the second order Reed-Muller code as defined in subclause
4.3.1.1. Bits
$x_{\text{tfci},1},x_{\text{tfci},2},\text{.}\text{.}\text{.},x_{\text{tfci},7}$
correspond to bits $a_{6},a_{5},\text{.}\text{.}\text{.},a_{0}$ of subclause
4.3.1.1, and bits $a_{9},a_{8},a_{7}$ of subclause 4.3.1.1 are set to zero.
##### 4.9.1.2.3 Physical channel mapping for E‑UCCH part 1
E-UCCH part 1 is described in [7]. The sequence of bits _y~0~_ , _y~1~_ , ...,
_y~31~_ output from the E-UCCH part 1 channel coding is mapped to the E-UCCH
part 1 indicator field of each E-PUCH of the E-DCH TTI configured to carry
E-UCCH. The bits _y~i~_ {_i=0,1,...31_} are mapped in an identical manner to
that described for TFCI in subclause 4.3.1.3 such that they are transmitted
over the air in ascending order with respect to _i_.
#### 4.9.1.3 E‑UCCH part 2
##### 4.9.1.3.1 Information field mapping of retransmission sequence number
To indicate the redundancy version (RV) of each HARQ transmission and to
assist the Node B soft buffer management a two bit retransmission sequence
number (RSN) is signalled from the UE to the Node B. The Node B can avoid soft
buffer corruption by flushing the soft buffer associated to one HARQ process
in case the last received RSN for that HARQ process is incompatible with the
current one.
The RSN is set by higher layers as described in [15]. For a given HARQ
process, once the maximum RSN value of 3 is reached, the RSN alternates
between the values of 2 and 3 for any further retransmissions. The RSN thus
follows the pattern 0,1,2,3,2,3,2,3,2,3,... The RSN is transmitted by the
physical layer in E-UCCH part 2.
The bits (_x~rsn,1~, x~rsn,2~_) of the RSN field of E-UCCH part 2 are mapped
such that _x~rsn,1~ corresponds to the MSB of the RSN and x~rsn,2~ corresponds
to the LSB of the RSN._
The applied E-DCH RV index specifying the used RV (_s_ and _r_ parameter) and
in the case of 16-QAM, also the used constellation rearrangement parameter
(_b_) both depend only on the values of RSN, and on _N~sys~_ / _N~e,data,j~_
as shown in table 25 below.
Table 25: Relation between RSN value and E-DCH RV Index
* * *
**RSN Value** _N~sys~_ / _N~e,data,j~_ **\  x~ag,k~ = x~pg,k~ k=1, 2, .., 5
>
> x~ag,k~ = x~c,k-5~ k=6, 7, ..., 11
>
> x~ag,k~ = x~t,k-11~ k=12, ..., 11+n~TRRI~
>
> x~ag,k~ = x~e,k-11-nTRRI~ k=12+n~TRRI~, ..., 14+n~TRRI~
>
> x~ag,k~ = x~r,k-14-nTRRI~ k=15+n~TRRI~, ..., 17+n~TRRI~ {if resource
> duration indicator present}
### 4.10.3 CRC attachment
The E-RNTI (_x~id,1~, x~id,2~, ..., x~id,16~)_ is the E‑DCH Radio Network
Identifier defined in [12]. It is mapped such that _x~id,1\ ~_ corresponds to
the MSB.
From the sequence of bits _x~ag,1~_ , _x~ag,2~_ , ..., _x~ag,w~_ a 16 bit CRC
is calculated according to section 4.2.1.1. This gives the sequence of bits
_c~1~_ , _c~2~_ , ..., _c~16~_ where:
$c_{k} = p_{\text{im}(\text{17} - k)}$ _k=1,2,...,16_
This sequence of bits is then masked with _x~id,1~, x~id,2~, ..., x~id,16~_
and appended to the sequence of bits _x~ag,1~_ , _x~ag,2~_ , ..., _x~ag,w~_ to
form the sequence of bits _y~1~_ , _y~2~_ , ..., _y~w+16~ where_
_y~i~=x~ag,i~ i=1,2, ...,w_
_y~i~=(c~i-w~ + x~id~,~i-w~) mod 2 i=w+1, ..., w+16_
### 4.10.4 Channel Coding
1/3 rate convolutional channel coding is applied to the sequence _y~1~,
y~2~,..., y~w+16~_ in accordance with section 4.2.3.1, resulting in the
sequence of bits _z~1~_ , _z~2~_ , ..., _z~3(w+24)~_.
### 4.10.5 Rate Matching
Rate matching is applied to the input sequence _z~1~_ , _z~2~_ , ...,
_z~3(w+24)~ to_ obtain the output sequence _r~1~_ , _r~2~_ , ..., _r~U~,_
where U = 242 for burst type 1 and U = 274 for burst type 2 for 3.84Mcps and
7.68Mcps options while U=172 for 1.28Mcps option.
### 4.10.6 Interleaving
Interleaving is performed as per section 4.2.11.1 (frame-related 2^nd^
interleaving).
### 4.10.7 Physical Channel Segmentation
Physical channel segmentation is performed as per section 4.2.10. For 1.28Mcps
TDD, the E-AGCH consists of two physical channels E-AGCH1 and E-AGCH2,whereas
for 3.84Mcps and 7.68Mcps TDD the E-AGCH only uses one physical channel,
see[7].Note that physical channel segmentation is transparent when only one
physical channel exists
### 4.10.8 Physical Channel Mapping
Physical channel mapping is performed as per section 4.2.12.
## 4.10A Coding for E-AGCH type 2 (1.28Mcps TDD only)
For the 1.28 Mcps TDD, E-AGCH type 2 is used when any of the following
conditions is met:
\- the variable E_DCH_SPS_STATUS =TRUE for a UE (as defined in [12]).
\- the UE is configured in MU-MIMO mode.
The E-AGCH type 2 carries the following fields multiplexed into _w_ bits
_x~ag,1~, x~ag,2~, ... x~ag,w~_ and _w_ is 30 bits.
\- Absolute grant (power) value (_x~pg,1~, x~pg,2~, ... x~pg,5~_) {5 bits}
\- Code resource related information (_x~c,1~, x~c,2~, ... x~c,Nc~_), {N~c~=4
bits }
\- Timeslot resource related information (_x~t,1~, x~t,2~, ... x~t,nTRRI~_),
{n~TRRI~ =5bits}
\- E-AGCH Cyclic Sequence Number (ECSN) (_x~e,1~, x~e,2~, x~e,3~_) (3 bits)
\- Field flag (_x~flag,1~, x~flag,2~_) {2 bits}
\- Special information 1 (_x~,info1,1~, x~info1,2~_) {2 bits}
\- Special information 2 (_x~,info2,1~, x~info2,2~, x~,info2,3~, x~info2,4~,
x~,info2,5,~_) {5 bits}
\- E-UCCH Number Indicator (x~ENI,1~,x~ENI,2~, x~ENI,3~) {3 bits}
\- Reserved (_x~res,1~_) {1 bit}
For an E-AGCH order,
\- x~pg,1~, x~pg,2~, x~pg,3~, x~pg,4~, x~pg,5~ , x~c,1~, x~c,2~, x~c,3~,
x~c,Nc~ are reserved
\- x~t,1~, x~t,2~, ... x~t,nTRRI~ shall be set to '00000'
\- x~e,1~, x~e,2~, x~e,3~ _shall be set to_ x~odt,1~, x~odt,2~, x~odt,3~
\- x~flag,1~, x~flag,2,~ x~,info1,1~, x~info1,2~_,_ x~,info2,1~, x~info2,2~,
x~,info2,3~, x~info2,4~, x~,info2,5,~_,_ x~ENI,1~,x~ENI,2~, x~ENI,3~_,_
x~res,1~_are reserved_
_where x~odt,1~, x~odt,2~, x~odt,3~ are defined in subclause 4.10B._
Figure 25A illustrates the overall coding chain for the E-AGCH type 2.
Figure 25A-- TrCH processing of E-AGCH type2
### 4.10A.1 E-AGCH type 2 Information Field Mapping
#### 4.10A.1.1 Mapping of the Absolute Grant (Power) Value
The mapping of the absolution grant (power) value (_x~pg,1~,
x~pg,2~,...x~pg,5~_) is performed as per section 4.10.1.1.
#### 4.10A.1.2 Mapping of the Code Resource Related Information
The code resource related information (_x~c,1~, x~c,2~,...x~c,Nc~_) indicates
which node on the OVSF code tree has been allocated and is represented by
_N~c~_ bits where _N~c~_ =4. The mapping between the allocated OVSF and the
enumerated node 0...14 on the OVSF code tree is as given in table 27, in which
channelisation code "_i"_ with spreading factor _"Q"_ is denoted as
_C~i~^(Q)^_. _x~c,1~_ corresponds to the MSB of the enumerated node.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is FALSE, the OVSF code of all
the allocated timeslots is indicated by Code Resource Related Information
field.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is not configured via higher layer signalling,
the specific timeslot refers to the timeslot closest to the timeslot in which
HS-SICH and/or UL DPCH is allocated among all the uplink timeslot scheduled to
the UE. The OVSF code of the specific timeslot is indicated by Code Resource
Related Information field. The OVSF code of other scheduled timeslots is
predefined, i.e. node 0.
If NON_RECTANGULAR_RESOURCE_ALLOCATION_STATUS is TRUE and non-rectangular
resource specific timeslot set is configured via higher layer signalling, the
OVSF code in the specific timeslot is indicated by Code Resource Related
Information field. The OVSF code of other scheduled timeslots is predefined,
i.e. node 0.
#### 4.10A.1.3 Mapping of the Timeslot Resource Related Information
The mapping of the timeslot resource related information (_x~t,1~, x~t,2~, ...
x~t,nTRRI~_) is performed as per section 4.10.1.3.
#### 4.10A.1.4 Mapping of the E-AGCH Cyclic Sequence Number (ECSN)
The mapping of E-AGCH cyclic sequence number (_x~e,1~, x~e,2~, x~e,3~_) is
performed as per section 4.10.1.4.
#### 4.10A.1.5 Mapping of the Field Flag
The field flag is used to distinguish the mapping of special information 1 and
special information 2. The bits (_x~flag,1~, x~flag,2~_) are mapped such that
_x~flag,1~_ corresponds to the MSB and _x~flag,2~_ to the LSB.
If _x~flag,1,~ x~flag,2~_ =_'00'_ , the special information 1(_x~,info1,1~,
x~info1,2~_) are comprised of the E-HICH indicator(_x~EI,1~, x~EI,2~_) and the
special information 2 (_x~,info2,1~, x~info2,2~, x~,info2,3~, x~info2,4~,
x~,info2,5,~_) are comprised of the resource duration indicator (_x~r,1~,
x~r,2~, x~r,3~_) and _x~info2,4~, x~,info2,5\ ~_ are reserved.
If _x~flag,1,~ x~flag,2~_ =_'01'_ , the special information 1 (_x~,info1,1~,
x~info1,2~_) are comprised of the resource repetition pattern index
(_x~rrpi,1~_ , _x~rrpi,2~_ ) and the special information 2 (_x~,info2,1~,
x~info2,2~, x~,info2,3~, x~info2,4~, x~,info2,5,~_) are reserved.
If _x~flag,1,~ x~flag,2~_ =_'10'_ , the special default midamble allocation is
used. The special information 1 (_x~,info1,1~, x~info1,2~_) are comprised of
the E-HICH indicator (_x~EI,1~, x~EI,2~_) and the special information 2
(_x~,info2,1~, x~info2,2~, x~,info2,3~, x~info2,4~, x~,info2,5,~_) are
comprised of the resource duration indicator (_x~r,1~, x~r,2~, x~r,3~_) and
the special default midamble pattern indicator (_x~mpi,1~, x~mpi,2~_).
_x~flag,1,~ x~flag,2~_ =_'11'_ is reserved.
#### 4.10A.1.6 Mapping of the Special Information 1
The special information 1 (_x~,info1,1~, x~info1,2~_) is mapped such that
_x~,info1,1~_ corresponds to the MSB and _x~info1,2~_ to the LSB.
If the special information 1 are comprised of the E-HICH indicator (_x~EI,1~,
x~EI,2~_), then _x~,info1,1~_ = _x~EI,1~_ and _x~info1,2~_ = _x~EI,2~_. And
the mapping of the E-HICH indicator is performed as per section 4.10.1.6.
If the special information 1 are comprised of the resource repetition pattern
index (_x~rrpi,1~_ , _x~rrpi,2~_ ), then _x~,info1,1~_ = _x~rrpi,1~_ and
_x~info1,2~_ = _x~rrpi,2~_. The resource repetition pattern index _x~rrpi,1~_
, _x~rrpi,2~_ is the unsigned binary representation of a reference to one of
repetition patterns of the assigned semi-persistent E-PUCH resources
configured by higher layers. The resource repetition pattern index _x~rrpi,1~_
, _x~rrpi,2~_ are mapped such that _x~rrpi,1~_ corresponds to the MSB and
_x~rrpi,2~_ to the LSB. And if _x~rrpi,1~ x~rrpi,2~ ='00',_ one subframe
E-PUCH resource is assigned.
* * *
x~rrpi,1~, x~rrpi,2~ **Resource repetition pattern index as signalled in the
variable E_DCH _SPS_PARAMS[12]** '01' 1^st^ entry '10' 2^nd^ entry '11' 3^rd^
entry
* * *
#### 4.10A.1.7 Mapping of the Special Information 2
The special information 2 (_x~,info2,1~, x~info2,2~, x~,info2,3~, x~info2,4~,
x~,info2,5,~_) is mapped such that _x~,info2,1~_ corresponds to the MSB and
_x~info2,5~_ to the LSB.
If the special information 2 (_x~,info2,1~, x~info2,2~, x~,info2,3~,
x~info2,4~, x~,info2,5,~_) are comprised of the resource duration indicator
(_x~r,1~, x~r,2~,x~r,3~_) and _x~info2,4~, x~,info2,5\ ~_ are reserved. Then
_x~,info2,1~_ = _x~r,1~_ , _x~,info2,2~_ = _x~r,2~_ and _x~,info2,3~_ =
_x~r,3~_.
The mapping of the resource duration indicator is performed as per section
4.10.1.5.
If the special information 2 (_x~,info2,1~, x~info2,2~, x~,info2,3~,
x~info2,4~, x~,info2,5,~_) are comprised of the resource duration indicator
(_x~r,1~, x~r,2~, x~r,3~_) and the special default midamble pattern indicator
(_x~mpi,1~, x~mpi,2~_), then _x~,info2,1~_ = _x~r,1~_ , _x~,info2,2~_ =
_x~r,2~_ , _x~,info2,3~_ = _x~r,3~_ , _x~,info2,4~_ = _x~mpi,1~_ and
_x~,info2,5~_ = _x~mpi,2~_. The mapping in Table 25A below applies.
Table 25A: Special default midamble pattern mapping
* * *
_Special default Mid-amble pattern_ _x~mpi,1~_ _x~mpi,2~_ pattern 1A 0 0
pattern 1B 0 1 pattern 2A 1 0 pattern 2B 1 1
* * *
#### 4.10A.1.8 Mapping of the E-UCCH Number Indicator
The mapping of E-UCCH number indicator (_x~ENI,1~, x~ENI,2~_ , _x~ENI,3~_) is
performed as per section of 4.10.1.7.
### 4.10A.2 Field Multiplexing of E-AGCH type 2
The absolute grant (power) value, code resource related information, timeslot
resource related information, ECSN, field flag, special information 1, special
information 2 and E-UCCH number indicator are multiplexed together to give a
sequence of bits _x~ag,1~, x~ag,2~, ..., x~ag,w~_ where:
x~ag,k~ = x~pg,k~ k=1, 2, .., 5
x~ag,k~ = x~c,k-5~ k=6, 7, ..., 9
x~ag,k~ = x~t,k-9~ k=10,11, ..., 14
x~ag,k~ = x~e,k-14~ k=15,16,17
x~ag,k~ = x~flag,k-17~ k=18,19
x~ag,k~ = x~info1,k-19~ k=20,21
x~ag,k~ = x~info2,k-21~ k=22,23,...,26
x~ag,k~ = x~ENI,k-26~ k=27,28,29
x~ag,k~ = x~res,k-29~ k=30
### 4.10A.3 CRC attachment for E-AGCH type 2
The E-RNTI (_x~id,1~, x~id,2~, ..., x~id,16~)_ is the E‑DCH Radio Network
Identifier defined in [12]. It is mapped such that _x~id,1\ ~_ corresponds to
the MSB.
The sequence of bits _y~1~, y~2~, ..., y~w+16~_ , is calculated according to
section 4.10.3.
### 4.10A.4 Channel Coding for E-AGCH type 2
Channel coding is performed as per section 4.10.4.
### 4.10A.5 Rate Matching for E-AGCH type 2
Rate matching is performed as per section 4.10.5.
### 4.10A.6 Interleaving for E-AGCH type 2
Interleaving is performed as per section 4.10.6.
### 4.10A.7 Physical Channel Segmentation for E-AGCH type 2
Physical channel segmentation is performed as per section 4.10.7.
### 4.10A.8 Physical Channel Mapping for E-AGCH type 2
Physical channel mapping is performed as per section 4.10.8.
## 4.10B Coding for E-AGCH orders
E-AGCH orders are commands sent to the UE using E-AGCH. No E-PUCH resources
grants are associated with E-AGCH orders.
The following information is transmitted by means of the E-AGCH order physical
channel.
\- Order type (3 bits): _x~odt,1~, x~odt,2~, x~odt,3~_
\- UE identity (16 bits): _x~id,1~, x~id,2~, ..., x~id,16~_
The coding for E-AGCH orders is specified in subclause 4.10A.
### 4.10B.1 E-AGCH orders information field mapping
#### 4.10B.1.1 Order type mapping
If _x~odt,1~, x~odt,2~, x~odt,3~_ = '_000_ ', then the E-AGCH order is an
order to release the allocated semi-persistent E-PUCH resources when UE is in
CELL_DCH state.
#### 4.10B.1.2 UE identity mapping
The E-RNTI (_x~id,1~, x~id,2~, ..., x~id,16~)_ is the E‑DCH Radio Network
Identifier defined in [12]. It is mapped such that _x~id,1\ ~_ corresponds to
the MSB.
## 4.11 Coding for E-HICH ACK/NACK
### 4.11.1 Coding for E-HICH ACK/NACK for the 3.84Mcps and 7.68Mcps options
#### 4.11.1.1 Overview
The ACK/NACK is transmitted on the E‑HICH as described in [7].
The value of a binary HARQ acknowledgement indicator for user _h_ is denoted
"a~h~" and may assume the value 0 or 1. The value of the indicator is mapped
as shown in table 28.
Table 28 -- Mapping of HARQ acknowledgement indicator
* * *
Command HARQ acknowledgement indicator value (a~h~) NACK 0 ACK 1
* * *
A HARQ acknowledgement indicator is mapped to one of 240 signature sequences
of length 240 bits and represented by the bit sequence b~h,0~, b~h,1~, ...,
b~h,239~ for the _h^th^_ acknowledgement indicator. The signature sequence
number "r" is selected as described in [7].
The signature sequence b~h,0~, b~h,1~, ..., b~h,239~ is constructed via coding
of a~h~ followed by bit scrambling. Spare bits are inserted during the
physical channel mapping stage to produce the output sequence d~h,0~, d~h,1~,
..., d~h,U,~.
#### 4.11.1.2 Coding of the HARQ acknowledgement indicator
Bit a~h~ is used to form the sequence s~2,v~ (v=0,1,...,239) via a two-stage
serialised binary spreading process as shown in figure 26.
Figure 26
The output of the first spreading stage is $s_{1,k} = a_{h} \oplus C_{1,i,k}$
, where _k=0, 1, 2,..., 19_.
The output of the second spreading stage is $s_{2,v} = s_{1,w} \oplus
C_{2,j,m}$ , where _v=0, 1,..., 239_ and where $w = \left\lfloor
\frac{v}{\text{12}} \right\rfloor$ and, $m = v\ \text{mod}\ \text{12}$.
The binary sequences selected for the first (C~1,i,k~) and second (C~2,j,m~)
spreading operations are derived as a function of the HARQ acknowledgement
sequence number _r_ (see [7]) such that:
The first orthogonal sequence set (C~1,i,k~) is given by table 29 and the
second orthogonal sequence set (C~2,j,m~) is given by table 30.
Table 29 -- Primary code sequences for HARQ acknowledgement indicator
* * *
**k** **0** **1** **2** **3** **4** **5** **6** **7** **8** **9** **10**
**11** **12** **13** **14** **15** **16** **17** **18** **19** **C~1,0,k~** 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 **C~1,1,k~** 1 0 0 1 1 0 0 0 0 1 0 1 0 1
1 1 1 0 0 1 **C~1,2,k~** 1 0 1 1 0 0 0 0 1 0 1 0 1 1 1 1 0 0 1 0 **C~1,3,k~**
1 1 1 0 0 0 0 1 0 1 0 1 1 1 1 0 0 1 0 0 **C~1,4,k~** 1 1 0 0 0 0 1 0 1 0 1 1 1
1 0 0 1 0 0 1 **C~1,5,k~** 1 0 0 0 0 1 0 1 0 1 1 1 1 0 0 1 0 0 1 1
**C~1,6,k~** 1 0 0 0 1 0 1 0 1 1 1 1 0 0 1 0 0 1 1 0 **C~1,7,k~** 1 0 0 1 0 1
0 1 1 1 1 0 0 1 0 0 1 1 0 0 **C~1,8,k~** 1 0 1 0 1 0 1 1 1 1 0 0 1 0 0 1 1 0 0
0 **C~1,9,k~** 1 1 0 1 0 1 1 1 1 0 0 1 0 0 1 1 0 0 0 0 **C~1,10,k~** 1 0 1 0 1
1 1 1 0 0 1 0 0 1 1 0 0 0 0 1 **C~1,11,k~** 1 1 0 1 1 1 1 0 0 1 0 0 1 1 0 0 0
0 1 0 **C~1,12,k~** 1 0 1 1 1 1 0 0 1 0 0 1 1 0 0 0 0 1 0 1 **C~1,13,k~** 1 1
1 1 1 0 0 1 0 0 1 1 0 0 0 0 1 0 1 0 **C~1,14,k~** 1 1 1 1 0 0 1 0 0 1 1 0 0 0
0 1 0 1 0 1 **C~1,15,k~** 1 1 1 0 0 1 0 0 1 1 0 0 0 0 1 0 1 0 1 1
**C~1,16,k~** 1 1 0 0 1 0 0 1 1 0 0 0 0 1 0 1 0 1 1 1 **C~1,17,k~** 1 0 0 1 0
0 1 1 0 0 0 0 1 0 1 0 1 1 1 1 **C~1,18,k~** 1 0 1 0 0 1 1 0 0 0 0 1 0 1 0 1 1
1 1 0 **C~1,19,k~** 1 1 0 0 1 1 0 0 0 0 1 0 1 0 1 1 1 1 0 0
* * *
Table 30 -- Secondary code sequences for HARQ acknowledgement indicator
* * *
**m** **0** **1** **2** **3** **4** **5** **6** **7** **8** **9** **10**
**11** **C~2,0,m~** 1 1 1 1 1 1 1 1 1 1 1 1 **C~2,1,m~** 1 0 1 0 1 1 1 0 0 0 1
0 **C~2,2,m~** 0 1 1 0 1 0 0 0 1 1 1 0 **C~2,3,m~** 1 1 0 0 1 0 1 1 1 0 0 0
**C~2,4,m~** 1 0 1 0 0 1 0 1 1 1 0 0 **C~2,5,m~** 0 1 1 0 1 1 0 1 0 0 0 1
**C~2,6,m~** 0 1 1 1 0 1 1 0 1 0 0 0 **C~2,7,m~** 0 0 1 1 1 0 1 1 0 1 0 0
**C~2,8,m~** 1 1 1 0 0 0 1 0 0 1 0 1 **C~2,9,m~** 0 0 0 0 1 1 1 0 1 1 0 1
**C~2,10,m~** 0 1 0 0 0 1 1 1 0 1 1 0 **C~2,11,m~** 1 1 0 1 1 1 0 0 0 1 0 0
* * *
#### 4.11.1.3 Bit scrambling of the E-HICH
The bit sequence b~h,0,~b~h,1~,...,b~h,239~ is formed by applying bit
scrambling (as defined in subclause 4.2.9) to the sequence s~2,v~.
#### 4.11.1.4 Physical channel mapping of the E-HICH
The bit sequence b~h,0,~b~h,1~,...,b~h,239~ is segmented into two halves,
b~h,0,~, ..., b~h,119~, and b~h,120,~...,b~h,239~. A sequence of U spare bits
z~u~ (_u=0...U-1_) are inserted between the first and second half of the
sequence to form:
d~h~ = {b~h,0~, b~h,1~, ... , b~h,119~, z~0~, z~1~, ... z~U-1~, b~h,120~,
b~h,121~, ... , b~h,239~}
U is equal to 4 or 36 dependant on the burst type (see [7]). The spare bit
sequence z~u~ is not defined.
### 4.11.2 Coding for E-HICH for the1.28Mcps option only
#### 4.11.2.1 Overview
The scheduled and non-Scheduled transmissions on different E‑HICHs are
described in [7]. The acknowledgement indicators for the E-DCH semi-persistent
scheduling operation can be transmitted on the same E-HICH carrying indicators
for scheduled traffic or the E-HICH carrying indicators for non-scheduled
traffic as described in [7].
For 1.28Mcps TDD multi-carrier E-DCH transmission, the acknowledgement
indicators for the E-PUCH on one carrier is associated with the E-HICHs on the
same carrier. The E-HICHs on the different carriers are coded independently.
The value of a binary HARQ acknowledgement indicator for user _h_ is denoted
"a~h~" and may assume the value 0 or 1. The value of the indicator is mapped
as same as that of 3.84Mcps shown in subclause 4.11.1.1.
Construction of the bit sequence for the _h_ ^th^ acknowledgement indicator is
achieved via a spreading process using an orthogonal sequence which is the row
of an orthogonal matrix of order 80. This orthogonal matrix (C~80~) is
Kronecker tensor product of one Hadamard matrix of order 20 (C~20~) and
another Hadamard matrix of order 4 (C~4~),
is Kronecker tensor product. (note: Kronecker product is not commutative, i.e.
). The element "0" in Hadamard C~20~ and C~4~ shall be replaced by "-1" before
the Kronecker tensor product operation. And after the operation the elements
"-1" in C~80~ should be converted back into "0".
These two Hadamard matrices are given by table 31 and table 32.
Table 31: Hadamard matrix of order 4
* * *
m 0 1 2 3 C~4,0,m~ 1 1 1 1 C~4,1,m~ 1 0 1 0 C~4,2,m~ 1 1 0 0 C~4,3,m~ 0 1 1 0
* * *
[]{.underline}
Table 32: Hadamard matrix of order 20
* * *
k 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 C~20,0,k~ 1 0 0 0 0 1 0 0
0 0 1 1 0 0 1 1 0 1 1 0 C~20,1,k~ 0 1 0 0 0 0 1 0 0 0 1 1 1 0 0 0 1 0 1 1
C~20,2,k~ 0 0 1 0 0 0 0 1 0 0 0 1 1 1 0 1 0 1 0 1 C~20,3,k~ 0 0 0 1 0 0 0 0 1
0 0 0 1 1 1 1 1 0 1 0 C~20,4,k~ 0 0 0 0 1 0 0 0 0 1 1 0 0 1 1 0 1 1 0 1
C~20,5,k~ 0 1 1 1 1 1 0 0 0 0 0 1 0 0 1 1 1 0 0 1 C~20,6,k~ 1 0 1 1 1 0 1 0 0
0 1 0 1 0 0 1 1 1 0 0 C~20,7,k~ 1 1 0 1 1 0 0 1 0 0 0 1 0 1 0 0 1 1 1 0
C~20,8,k~ 1 1 1 0 1 0 0 0 1 0 0 0 1 0 1 0 0 1 1 1 C~20,9,k~ 1 1 1 1 0 0 0 0 0
1 1 0 0 1 0 1 0 0 1 1 C~20,10,k~ 0 0 1 1 0 1 0 1 1 0 1 0 0 0 0 0 1 1 1 1
C~20,11,k~ 0 0 0 1 1 0 1 0 1 1 0 1 0 0 0 1 0 1 1 1 C~20,12,k~ 1 0 0 0 1 1 0 1
0 1 0 0 1 0 0 1 1 0 1 1 C~20,13,k~ 1 1 0 0 0 1 1 0 1 0 0 0 0 1 0 1 1 1 0 1
C~20,14,k~ 0 1 1 0 0 0 1 1 0 1 0 0 0 0 1 1 1 1 1 0 C~20,15,k~ 0 1 0 0 1 0 0 1
1 0 1 0 0 0 0 1 0 0 0 0 C~20,16,k~ 1 0 1 0 0 0 0 0 1 1 0 1 0 0 0 0 1 0 0 0
C~20,17,k~ 0 1 0 1 0 1 0 0 0 1 0 0 1 0 0 0 0 1 0 0 C~20,18,k~ 0 0 1 0 1 1 1 0
0 0 0 0 0 1 0 0 0 0 1 0 C~20,19,k~ 1 0 0 1 0 0 1 1 0 0 0 0 0 0 1 0 0 0 0 1
* * *
The binary orthogonal sequence (C~80,r,n~) used for spreading operation is
selected from the r^th^ row of the orthogonal matrix of order 80 (C~80~). A
HARQ acknowledgement indicator is synchronously linked with the E-DCH TTI
transmission to which it relates. There is thus a one-to-one association
between an E-DCH TTI transmission and its respective HARQ acknowledgement
indicator.
#### 4.11.2.2 Coding of the HARQ acknowledgement indicator and TPC/SS
For scheduled transmissions, E-HICHs carry HARQ acknowledgement indicators
only.
When the special default midamble allocation scheme is not used for E-PUCH, a
logical allocation resource tag ID "r" (r=0, 1, 2,..., 79) is calculated first
for the E-DCH resource allocation associated with the HARQ acknowledgement
indicator.
where:
t~0~ is the last (highest-numbered) allocated timeslot (1,2,..,5)
q~0~ is the lowest-numbered channelisation code index allocated in timeslot
t~0~ (1,2,..., Q~0~)
Q~0~ is the spreading factor of the lowest-numbered channelisation code index
allocated in timeslot t~0~
When the special default midamble allocation scheme is used for E-PUCH, a
logical allocation resource tag ID "r" (r=0, 1, 2,..., 79) is calculated first
associated with the HARQ acknowledgement indicator.
where:
t~0~, q~0~ and Q~0~ have the same definition as above .
Offset is decided by the special default midamble pattern indicator on E-AGCH
and the mapping in Table33 below applies.
Table 33: Offset mapping table
* * *
**_offset_** _x~mpi,1~_ _x~mpi,2~_ 0 0 0 1 0 1 2 1 0 3 1 1
* * *
The logical resource tag ID r is then mapped to a physical allocation resource
tag ID r\',
$r' = P(r,\text{SFN}\text{',}\text{MidambleCode})$,
where _P_ is a permutation function depends on the logical signature index _r_
, system sub-frame number SFN' of E-HICH and the cell specific basic midamble
code sequence. A 7-tap linear feedback shift register (LFSR) is used to
generate pseudo-random numbers which are then used to generate the pseudo-
random permutation _P_. The generator polynomial of the 7-tap LFSR is $g(x) =
1 + x^{3} + x^{7}$, as shown in Figure 27.
Figure 27: Structure of PN register
The pseudo-random permutation is generated according to the following
procedures:
1\. Initialization
(a) Initialize _M_ = 80, initialize _P_ as _P_(_m_) = _m_ , _m_ = 0, 1, ...,
_M_ -1;
(b) Initialize _N_ = 7;
(c) Initialize PN register with seed _s_ , where _s_ = LSB(SFN',
_[N]{.underline}_)⊕LSB(MidambleCode, _N_) and s~6~, s~5~, ... s~0~ are put
into the register in the order as shown in figure 27;
(d) Initialize _i_ = 0.
2\. Repeat the following steps while _i_ \ _M_ \-- _i_ \-- 1, set _k_ = _k_ \-- (_M_ \-- _i_);
(d) Swap the _i_ -th and the (_k_ +_[i]{.underline}_)-th element of _P_ ,
i.e., tmp = _P_(_i_), _P_(_i_) = _P_(_k_ +_i_), _P_(_k_ +_i_) = tmp;
(e) Increment _i_ by 1.
where "LSB(_x_ , _n_)" means the right most n bits of _x_ , "⊕" means modulo 2
addition, and the first output bit from the PN register is the MSB, while the
final output bit is the LSB . The resulting _P_ is the output permutation and
the physical signature sequence index is given by $r' = P(r)$.
The output of the spreading stage is equal to $b_{h,n} =
a_{h}\text{ΘC}_{\text{80},r\text{',}n}$, where n=0,1,...,79 and $\Theta$ is
the Xor operation.
For Non-Scheduled transmissions and E-DCH semi-persistent scheduling
operation,, E-HICHs carry HARQ acknowledgement indicators and TPC/SS commands.
The 80 orthogonal sequences are divided into 20 groups while each group
includes 4 sequences of contiguous logical resource tag ID. The mapping
between the logical resource tag ID and the physical tag ID is same as
scheduled transmissions. Each non-scheduled user is assigned one group by
higher layer to indicate the HARQ acknowledgement indicator and TPC/SS
command. The first one of the four sequences is used for the acknowledgement
indicator's spreading operation and one of the other three is used to indicate
TPC/SS command implicitly. The mapping relations between them are described in
[7].
The HARQ acknowledgement indicator is spread by the assigned orthogonal
sequence (C~80,s',n~), where s\' is the physical resource tag ID. The output
of the spreading stage is equal to$c_{h,n} =
a_{h}\text{ΘC}_{\text{80},s\text{',}n}$, where n=0,1,...,79. The sequence
chosen to indicate TPC/SS command is denoted as "e~h,n~", $e_{h,n} =
p_{h}\text{ΘC}_{\text{80},t\text{',}n}$, where $p_{h}$ is the same as the
parameter B defined in [7].
#### 4.11.2.3 Bit scrambling and Physical channel mapping of the E-HICH
For scheduled transmission, the bit sequence b~h,0,~b~h,1~,...,b~h,79~ is
segmented into two halves, b~h,0,~, ..., b~h,39~, and b~h,40,~...,b~h,79~. 8
spare bits z~u~ (_u=0...7_) are inserted between the first and second half of
the sequence to form:
d~h~ = {b~h,0~, b~h,1~, ... , b~h,39~, z~0~, z~1~, ... z~7~, b~h,40~, b~h,41~,
... , b~h,79~}
The spare bit sequence z~u~ is not defined.For Non-Scheduled transmission, the
corresponding output bit sequences are:
d~h1~ = {c~h,0~, c~h,1~, ... , c~h,39~, z~0~, z~1~, ... z~7~, c~h,40~,
c~h,41~, ... , c~h,79~}
d~h2~ = {e~h,0~, e~h,1~, ... , e~h,39~, z~0~, z~1~, ... z~7~, e~h,40~,
e~h,41~, ... , e~h,79~}
Then the corresponding bit sequence d~h~ or d~h1~/d~h2~ is formed by applying
bit scrambling (as defined in subclause 4.2.9) to the sequence s~h,n~ or
s~h1,n~/s~h2,n~, n= 0,1,...,87.
## 4.12 Coding for E-RUCCH
For 1.28Mcps TDD, E-RUCCH supports both a 5ms and a 10ms TTI. For 3.84Mcps and
7.68Mcps TDD, E-RUCCH supports a TTI of 10ms only. The sequence of 39
information bits to be transmitted on one E-RUCCH as supplied by higher layers
is defined as bits $x_{e - \text{rucch},1},a_{e -
\text{rucch},2},\text{.}\text{.}\text{.}a_{e - \text{rucch},\text{39}}$.
The following processing steps (in sequential order) are defined for E-RUCCH:
\- CRC attachment
\- Channel coding
\- Rate matching
\- Bit scrambling
\- Frame related 2^nd^ interleaving
\- Mapping to physical channels
### 4.12.1 CRC attachment for E-RUCCH
From the sequence of A~i~=39 bits ($x_{e - \text{rucch},1},a_{e -
\text{rucch},2},\text{.}\text{.}\text{.}a_{e - \text{rucch},\text{39}}$) a CRC
of length L~i~=16 is appended according to Section 4.2.1.1. The bits output
from CRC attachment are denoted b~im,k~, where _k=1,2,3, ... A~i~+L~i~_ and
_A~i~_ = 39
For 3.84Mcps and 7.68Mcps TDD, each parity bit b~im,k~ , (where
_k=A~i~+1,A~i~+2, ... A~i~+L~i~_) is then XOR'd with 1 such that its polarity
is reversed.
### 4.12.2 Channel coding for E-RUCCH
1/3 rate convolutional channel coding is applied to the sequence _b~1~_ ,
_b~2~_ , ..., _b~im,k~_ in accordance with section 4.2.3.1, resulting in the
sequence of bits _z~1~_ , _z~2~_ , ..., _z~3(k+8)~_.
### 4.12.3 Rate matching for E-RUCCH
Rate matching for E-RUCCH shall be applied to the input sequence _z~1~_ ,
_z~2~_ , ..., _z~3(k+8)~ to_ obtain the output sequence _r~1~_ , _r~2~_ , ...,
_r~U~_ , where U = 176 for 1.28Mcps and U= 232 for 3.84Mcps and 7.68Mcps TDD,
according to the general method described in subclause 4.2.7.
### 4.12.4 Bit scrambling for E-RUCCH
Bit scrambling for E-RUCCH shall be performed in accordance with the general
method described in subclause 4.2.9.
### 4.12.5 Interleaving for E-RUCCH
Frame-related 2^nd^ interleaving for E-RUCCH shall be performed in accordance
with the general method described in subclause 4.2.11.1.
### 4.12.6 Physical channel mapping for E-RUCCH
Physical channel mapping for the E-RUCCH shall be performed in accordance with
the general method described in subclause 4.2.12.1.
# 5 Multiplexing, channel coding and interleaving for the 3.84 Mcps MBSFN IMB
option
## 5.1 General
Data streams from/to MAC and higher layers (Transport block / Transport block
set) are encoded/decoded to offer transport services over the radio
transmission link. The channel coding scheme is a combination of error
detection, error correcting, rate matching, interleaving and the mapping of
transport channels onto physical channels.
## 5.2 General coding/multiplexing of TrCHs
This section only applies to the transport channels BCH and FACH.
Data arrives to the coding/multiplexing unit in form of transport block sets
once every transmission time interval. The transmission time interval is
transport-channel specific from the set {10 ms, 20 ms, 40 ms, 80 ms}. An
overview of the coding/multiplexing steps applicable to MBSFN IMB is shown in
figure 2 of subclause 4.2 in [3].
### 5.2.1 CRC attachment
Error detection is provided on transport blocks through a Cyclic Redundancy
Check (CRC). CRC attachment shall be performed in accordance with the general
method described in subclause 4.2.1 of [3].
### 5.2.2 Transport block concatenation and code block segmentation
Transport blocks, with attached CRCs, are concatenated and segmentated into
code blocks. Transport block concatenation and code block segmentation shall
be performed in accordance with the general method described in subclause
4.2.2 of [3].
### 5.2.3 Channel coding
Code blocks are delivered to the channel coding. Channel coding shall be
performed in accordance with the general method described in subclause 4.2.3
of [3]. The following restrictions apply:
\- Convolutional coding shall be applied to FACH transport channel mapped on
S-CCPCH frame type 1 only.
\- Turbo coding shall be applied to FACH transport channels mapped on S-CCPCH
frame type 2 only.
### 5.2.4 1^st^ Interleaving
First interleaving shall be performed in accordance with the general methods
described in subclause 4.2.5 of [3].
### 5.2.5 Radio frame segmentation
Radio frame segmentation shall be performed in accordance with the general
method described in subclause 4.2.6 of [3].
### 5.2.6 Rate matching
Rate matching shall be performed in accordance with the general method
described in subclause 4.2.7 of [3], in which the downlink description is only
relevant. Only flexible positions of TrCHs are supported for the MBSFN IMB
option.
For S-CCPCH frame type 2, the number of bits available to the CCTrCH in one
radio frame using _P_ physical channels is defined as _N~data,*\ ~_ = 3×
_N~data~_ ~1~_\+ (P-1)_ ×3× _N'~data~_ ~1~, where _N~data~_ ~1~ is defined in
[2] and _N'~data~_ ~1~ is the data size of the corresponding slot format with
zero TFCI bits.
### 5.2.7 TrCH multiplexing
Transport channel multiplexing shall be performed in accordance with the
general method described in subclause 4.2.8 of [3].
### 5.2.8 Insertion of discontinuous transmission (DTX) indication bits
DTX is used to fill up the radio frame with bits. The DTX indication bits
inserted in this step shall be placed at the end of the radio frame,
corresponding to flexible positions of TrCHs in the radio frame [3]. Note that
the DTX indication bits will be distributed over all slots after 2^nd^
interleaving.
The bits input to the DTX insertion block are denoted
by{width="0.9305555555555556in" height="0.25in"}, where _S_ is the number of
bits from TrCH multiplexing. The bits output from the DTX insertion block are
denoted by$w_{1},w_{2},w_{3},\ldots,w_{W}$and defined by the following
relations:
{width="0.5138888888888888in" height="0.25in"} _k =_ 1, 2, 3 _,_ ..._,S_
{width="0.5in" height="0.25in"} _k = S_ +1 _, S_ +2 _, S_ +3 _,_ ..._,W_
where DTX indication bits are denoted by _δ_. Note that bits _w~k~_ are three
valued and that _W_ = _N~data,*~_.
### 5.2.9 Physical channel segmentation
For the 3.84 Mcps MBSFN IMB option, physical channel segmentation is
applicable to S-CCPCH frame type 2 only.
When more than one PhCH is used, physical channel segmentation divides the
bits among the different PhCHs. The bits input to the physical channel
segmentation are denoted by$w_{1},w_{2},w_{3},\ldots,w_{W}$, where _W_ is the
number of bits input to the physical channel segmentation block. The number of
PhCHs is denoted by _P._
The bits after physical channel segmentation are
denoted{width="1.4722222222222223in" height="0.2777777777777778in"}, where _p_
is PhCH number and _U~p~_ is the number of bits in one radio frame of the
_p^th^_ PhCH. The relation between _w~k~_ and _u~p,k~_ is given below.
Bits on first PhCH after physical channel segmentation:
$u_{1,k} = w_{k}$ _k =_ 1, 2 , ..., _U~1~_
Bits on second PhCH after physical channel segmentation:
$u_{2,k} = w_{(k + U_{1})}$ _k =_ 1, 2 , ..., _U~2~_
...
Bits on the _P^th^_ PhCH after physical channel segmentation:
$u_{P,k} = w_{(k + U_{1} + \ldots + U_{P - 1})}$ _k =_ 1, 2 , ..., _U~P~_
The number of bits _U~p\ ~_ in one radio frame of the _p^th^_ PhCH is 3×
_N~data~_ ~1~ for _p=1_ and 3× _N'~data~_ ~1~ for _p = 2,3,_..._, P_ , where
_N~data~_ ~1~ is defined in [2] and _N'~data~_ ~1~ is the data size of the
corresponding slot format with zero TFCI bits.
### 5.2.10 2^nd^ Interleaving
Second interleaving is performed in accordance with the general method
described in section 4.2.11 of [3]. For S-CCPCH frame type 2, 2^nd^
interleaving is performed per physical channel of the CCTrCH.
### 5.2.11 Physical channel mapping
Physical channel mapping shall be performed in accordance with the general
method described in subclause 4.2.12 in [3], in which the downlink description
is only relevant.
### 5.2.12 Restrictions on different types of CCTrCHs
Restrictions on the different types of CCTrCHs are described in general terms
in [16]. In this subclause those restrictions are given with layer 1 notation.
#### 5.2.12.1 Broadcast channel (BCH)
The restrictions of subclause 4.2.13.6 of [3] apply.
#### 5.2.12.2 Forward access channel (FACH)
\- The maximum value of the number of TrCHs _I_ in a CCTrCH and the maximum
value of the number of transport blocks _M~i~_ on each transport channel are
given from the UE capability class.
\- Only one Secondary CCPCH frame type 1 is used per CCTrCH.
\- The maximum number of Secondary CCPCHs of frame type 2 used per CCTrCH is
defined in [17].
### 5.2.13 Multiplexing of different TrCHs into one CCTrCH, and mapping of one
CCTrCH onto physical channels
Multiplexing of different transport channels into one coded composite
transport channel shall be performed in accordance with the general method
described in 4.2.14 of [3].
## 5.3 Transport format detection
For MBSFN IMB operations, the transport format combination is signalled using
the TFCI field of an S-CCPCH slot and only TFCI based detection shall be used.
### 5.3.1 Transport format detection based on TFCI
When a TFCI is available, then TFCI based detection shall be applicable to all
TrCHs within the CCTrCH. The TFCI informs the receiver about the transport
format combination of the CCTrCHs. As soon as the TFCI is detected, the
transport format combination, and hence the transport formats of the
individual transport channels are known.
### 5.3.2 Coding of Transport-Format-Combination Indicator (TFCI)
The number of TFCI bits to be encoded per CCTrCH shall always be within the
range 1 to 5. These bits shall be encoded according to the general method of
subclause 4.3.1.2.2 to produce 16 encoded bits b0 to b15. This procedure is
valid also for the case where the number of TFCI bits to be encoded is less
than 3.
### 5.3.3 Mapping of TFCI words
#### 5.3.3.1 Mapping of TFCI bits for Secondary CCPCH
The 16 encoded TFCI bits are directly mapped to the S-CCPCH slots of the radio
frame. Within a slot the bit with lower index is transmitted before the bit
with higher index. The coded bits _b~k~_ , are mapped to the transmitted TFCI
bits _d~k~_ , according to the following formula:
_d~k~_ = _b~k~_ ~mod\ 16~
For S-CCPCH frame type 1, _k_ = 0, 1, 2, ..., 29. For S-CCPCH frame type 2
using QPSK data modulation, _k_ = 0, 1, 2, ..., 47 whilst for S-CCPCH frame
type 2 using 16-QAM data modulation, _k_ = 0, 1, 2, ..., 23.
The set of TFCI bits _d~k~_ shall be modulated as defined in [9] and mapped to
slots of the radio frame such that they are transmitted in ascending order of
_k_.
#