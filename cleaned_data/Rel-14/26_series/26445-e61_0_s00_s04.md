# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document is a detailed description of the signal processing
algorithms of the Enhanced Voice Services coder.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 26.441: \"Codec for Enhanced Voice Services (EVS); General
Overview\".
[3] 3GPP TS 26.442: \"Codec for Enhanced Voice Services (EVS); ANSI C code
(fixed-point)\".
[4] 3GPP TS 26.444: \"Codec for Enhanced Voice Services (EVS); Test
Sequences\".
[5] 3GPP TS 26.446: \"Codec for Enhanced Voice Services (EVS); AMR-WB Backward
Compatible Functions\".
[6] 3GPP TS 26.447: \"Codec for Enhanced Voice Services (EVS); Error
Concealment of Lost Packets\".
[7] 3GPP TS 26.448: \"Codec for Enhanced Voice Services (EVS); Jitter Buffer
Management\".
[8] 3GPP TS 26.173: \"ANSI-C code for the Adaptive Multi Rate - Wideband (AMR-
WB) speech codec\".
[9] 3GPP TS 26.190: \"Speech codec speech processing functions; Adaptive
Multi-Rate - Wideband (AMR-WB) speech codec; Transcoding functions\".
[10] 3GPP TS 26.103: \"Speech codec list for GSM and UMTS\".
[11] 3GPP TS 26.290: \"Extended AMR Wideband codec; Transcoding functions\".
[12] 3GPP TS 26.401: \"General audio codec audio processing functions;
Enhanced aacPlus general audio codec; General description\".
[13] 3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia Telephony;
Media handling and interaction\".
[14] 3GPP TS 22.105: \"Services and Service capabilities\".
[15] IETF RFC 4867 (2007): \"RTP Payload Format and File Storage Format for
the Adaptive Multi-Rate (AMR) and Adaptive Multi-Rate Wideband (AMR-WB) Audio
Codecs\", J. Sjoberg, M. Westerlund, A. Lakaniemi and Q. Xie.
[16] IEEE Transactions on Acoustic, Speech and Signals Processing, Vol. 2,
April, pp. 9-12 (1993): "Immittance spectral pairs (ISP) for speech
encoding",Bistritz, Y., and Peller, S.
[17] IEEE Journal on Selected Areas in Communications, Vol. 6, No. 2,
February, pp. 314-323 (1988): \"Transform Coding of Audio Signals Using
Perceptual Noise Criteria\", Johnston, J.D.
[18] IEEE Transactions on Acoustic, Speech and Signals Processing, Vol. 34,
No. 6, December, pp. 1419 1426 (1986): \"The computation of line spectral
frequencies using Chebyshev polynomials\", Kabal, P., and Ramachandran, R.P.
[19] IEEE Proceedings of International Conference on Acoustics, Speech and
Signal Processing, March-April, pp. 4001-4004 (2008): \"Transition mode coding
for source controlled CELP codecs", Eksler, V., and Jelínek, M.
[20] 3GPP2 C.S0014-B, (2006) "Enhanced Variable Rate Codec, Speech Service 3
Option 3 and 68 for Wideband Spread Spectrum 4 Digital Systems.\"
[21] Speech and Audio Processing for Coding, Enhancement and Recognition,
Springer (2014): Recent Speech Coding Technologies and Standards\", Sinder,
D., Varga, I., Krishnan, V. Rajendran, V, and Villette, S.
[22] Proceedings of EUSIPCO (2002): \"LSF quantization with multiple scale
lattice VQ for transmission over noisy channels\", Vasilache, A. and Tabus, I.
[23] Proceedings of INTERSPEECH (2013): "Computationally efficient objective
function for algebraic codebook optimization in ACELP", Bäckström, T.
[24] Proceedings of INTERSPEECH (2012): \"Enumerative algebraic coding for
ACELP\", Bäckström, T.
[25] ITU-T Recommendation G.718 Amendment 2 (2010): \"New Annex B on
Superwideband scalable extension for ITU-T G.718 and corrections to main body
fixed-point C-code and description text.\"
[26] Signal Processing, no. 82, pp 563-586 (2002): \"Multiple-scale leader-
lattice VQ with application to LSF quantization\", Vasilache, A. and Tabus, I.
[27] IETF RFC 4566 (2006): \"SDP: Session Description Protocol\", M. Handley,
V. Jacobson and C. Perkins.
[28] IETF RFC 3264 (2002): \"An Offer/Answer Model with the Session
Description Protocol (SDP)\", J. Rosenberg and H. Schulzrinne.
[29] IETF RFC 5939 (2010): \"Session Description Protocol (SDP) Capability
Negotiation\", F. Andreasen.
[30] IETF RFC 3550 (2003): \"RTP: A Transport Protocol for Real-Time
Applications\", H. Schulzrinne, S. Casner, R. Frederick and V. Jacobson.
[31] IETF RFC 0768 (1980): \"User Datagram Protocol\", J. Postel.
[32] ITU-T Recommendation G.722 Amendment 1 (2010): \"7 kHz audio-coding
within 64 kbit/s: New Annex B with superwideband embedded extension.\"
[33] ITU-T Recommendation G.720.1 (2010): \"Generic sound activity detector.\"
[34] American Mathematical Society, (2002): \"Numerical Analysis: Mathematics
of Scientific Computing\", Kincaid, D. and Cheney, W.
[35] ITU-T Recommendation G.722.2 (2003): \"Wideband coding of speech at
around 16 kbit/s using Adaptive Multi-Rate Wideband (AMR-WB).\"
[36] 3GPP TS 26.201: \"Speech codec speech processing functions; Adaptive
Multi-Rate - Wideband (AMR-WB) speech codec; Frame structure\".
[37] 3GPP TS 26.171: \"Speech codec speech processing functions; Adaptive
Multi-Rate - Wideband (AMR-WB) speech codec; General description\".
[38] IETF RFC 3551 (2003): \"RTP Profile for Audio and Video Conferences with
Minimal Control\", H. Schulzrinne and S. Casner.
[39] 3GPP TS 26.103: \"Speech codec list for GSM and UMTS\"
[40] 3GPP TS 26.244: \"3GPP file format (3GP)\".
[41] IETF RFC 3839 (2004): \"MIME Type Registrations for 3rd Generation
Partnership Project (3GPP) Multimedia files\", R. Castagno and D. Singer.
[42] IEEE Transactions on Information Theory, Vol. 37, no. 6, Nov., pp.
1551-1566 (1991): \"Trellis Coded Vector Quantization\", T.R. Fischer, M.W.
Marcellin, and M. Wang.
[43] 3GPP TS 26.443: \"Codec for Enhanced Voice Services (EVS); ANSI C code
(floating-point)\"
# 3 Definitions, abbreviations and mathematical expressions
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**frame:** an array of audio samples spanning 20ms time duration.
**EVS codec** : The EVS codec includes two operational modes: EVS Primary
operational mode (EVS Primary mode) and EVS AMR-WB Inter-Operable modes (EVS
AMR-WB IO mode). When using the EVS AMR-WB IO mode the speech frames are
bitstream interoperable with the AMR-WB codec [9]. Frames generated by an EVS
AMR-WB IO mode encoder can be decoded by an AMR-WB decoder, without the need
for transcoding. Likewise, frames generated by an AMR-WB encoder can be
decoded by an EVS AMR-WB IO mode decoder, without the need for transcoding.
**EVS Primary mode:** Includes 11 bit-rates for fixed-rate or multi-rate
operation; 1 average bit-rate for variable bit-rate operation; and 1 bit-rate
for SID (3GPP TS 26.441 [2]). The EVS Primary mode can encode narrowband,
wideband, super-wideband and fullband signals. None of these bit-rates are
interoperable with the AMR-WB codec.
**EVS AMR-WB IO mode:** Includes 9 codec modes and SID. All are bitstream
interoperable with the AMR-WB codec (3GPP TS 26.171 ‎[37‎]).
**Operational mode:** Used for the EVS codec to distinguish between EVS
Primary mode and EVS AMR-WB IO mode.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
> ACELP Algebraic Code-Excited Linear Prediction
>
> AMR Adaptive Multi Rate (codec)
>
> AMR-NB Adaptive Multi Rate Narrowband (codec) -- Also referred to as AMR
>
> AMR-WB Adaptive Multi Rate Wideband (codec)
>
> AR Auto-Regressive
>
> AVQ Algebraic Vector Quantization
>
> CELP Code-Excited Linear Prediction
>
> CLDFB Complex Low Delay Filter Bank
>
> CMR Codec Mode Request
>
> CNG Comfort Noise Generator
>
> DCT Discrete Cosine Transformation
>
> DFT Discrete Fourier Transform
>
> DTX Discontinuous Transmission
>
> EFR Enhanced Full Rate (codec)
>
> EVS Enhanced Voice Services
>
> FB Fullband
>
> FCB Fixed Codebook
>
> FEC Frame Erasure Concealment
>
> FFT Fast Fourier Transform
>
> FIR Finite Impulse Response
>
> FT Frame Type
>
> GC Generic Coding
>
> HF High Frequency
>
> HP High Pass
>
> IIR Infinite Impulse Response
>
> IP Internet Protocol
>
> ISF Immittance Spectral Frequency
>
> ISP Immittance Spectral Pair
>
> ISPP Interleaved Single-Pulse Permutation
>
> JBM Jitter Buffer Management
>
> LD Low Delay
>
> LP Linear Prediction
>
> LPF Low Pass Filter
>
> LSB Least Significant Bit
>
> LSF Line Spectral Frequency
>
> LSP Line Spectral Pair
>
> LTP Long-Term Prediction
>
> MA Moving Average
>
> MDCT Modified Discrete Cosine Transform
>
> MRLVQ Multi-Rate Lattice Vector Quantization
>
> MSB Most Significant Bit
>
> MSVQ Multi-Stage Vector Quantization
>
> MTSI Multimedia Telephony Service for IMS
>
> NB Narrowband
>
> OL Open-Loop
>
> PCPRS Path-Choose Pulse Replacement Search
>
> PS Packet Switched
>
> PSTN Public Switched Telephone Network
>
> QMF Quadrature Mirror Filter (See also CLDFB)
>
> SAD Signal Activity Detection
>
> SDP Session Description Protocol
>
> SID Silence Insertion Descriptor
>
> SNR Signal-to-Noise Ratio
>
> SWB Super Wideband
>
> TC Transition Coding
>
> ToC Table of Contents
>
> UC Unvoiced Coding
>
> VC Voiced Coding
>
> VMR-WB Variable Rate Multimode Wideband
>
> VQ Vector Quantization
>
> WB Wideband
>
> WMOPS Weighted Millions of Operations Per Second
## 3.3 Mathematical Expressions
For the purposes of the present document, the following conventions apply to
mathematical expressions:
$\left\lfloor x \right\rfloor$ indicates the largest integer less than or
equal to _x_ : $\left\lfloor 1\text{.}1 \right\rfloor = 1$, $\left\lfloor
1\text{.}0 \right\rfloor = 1$ and $\left\lfloor - 1\text{.}1 \right\rfloor = -
2$;
$\left\lceil x \right\rceil$ indicates the smallest integer greater than or
equal to _x_ : $\left\lceil 1\text{.}1 \right\rceil = 2$, $\left\lceil
2\text{.}0 \right\rceil = 2$ and $\left\lceil - 1\text{.}1 \right\rceil = - 1$
\|_x_ \| indicates the absolute value of _x_ : \|17\| = 17, \|--17\| = 17;
min(_x_ ~0~,..._x_ ~N--1~) indicates the minimum of _x_ ~0~,..., _x_ ~N--1~, N
being the number of components;
max(_x_ ~0~,..._x_ ~N--1~) indicates the maximum of _x_ ~0~, ..., _x_ ~N--1~;
$\text{sgn}(x)$ $\begin{matrix} \left{ 1,\text{if\ }x \geq \ 0, \middle|
\right.\ \ \end{matrix}$
**A** ^T^ indicates the transpose of matrix **A** ;
$x\text{mod}y$ indicates the remainder after dividing x by y: $x\text{mod}y =
x - \left( y\left\lfloor \frac{x}{y} \right\rfloor \right)$ ;
round(_x_) is traditional rounding: round(_x_) = $\text{sgn}(x) \cdot
\left\lfloor |x|\ + \ 0\text{.}5 \right\rfloor$ ;
exp(_x_) is equivalent to _e_ ^x^ where _e_ is the base of the natural
algorithm;
$\sum_{}^{}{}$ indicates summation;
$\prod_{}^{}{}$ indicates product;
Unless otherwise specified, log(_x_) denotes logarithm at base 10 throughout
this Recommendation.
# 4 General description of the coder
## 4.1 Introduction
The present document is a detailed description of the signal processing
algorithms of the Enhanced Voice Services coder. The detailed mapping from
20ms input blocks of audio samples in 16 bit uniform PCM format to encoded
blocks of bits and from encoded blocks of bits to output blocks of
reconstructed audio samples is explained. Four sampling rates are supported; 8
000, 16 000, 32 000 and 48 000 samples/s and the bit rates for the encoded bit
stream of may be 5.9, 7.2, 8.0, 9.6, 13.2, 16.4, 24.4, 32.0, 48.0, 64.0, 96.0
or 128.0 kbit/s. An AMR-WB Interoperable mode is also provided which operates
at bit rates for the encoded bit stream of 6.6, 8.85, 12.65, 14.25, 15.85,
18.25, 19.85, 23.05 or 23.85 kbit/s.
The procedure of this document is mandatory for implementation in all network
entities and User Equipment (UE)s supporting the EVS coder.
The present document does not describe the ANSI-C code of this procedure. For
a description of the reference fixed-point ANSI C code specifications, see
[3]; for a description of the reference floating-point ANSI C code
specification see [43].
In the case of discrepancy between the procedure described in the present
document and its ANSI-C code specifications contained in [3] the procedure
defined by the [3] prevails. In the case of discrepancy between the procedure
described in the present document and its ANSI-C code specifications contained
in [43] the procedure defined by [43] prevails.
## 4.2 Input/output sampling rate
The encoder can accept fullband (FB), superwideband (SWB), wideband (WB) or
narrow-band (NB) signals sampled at 48, 32, 16 or 8 kHz. Similarly, the
decoder output can be 48, 32, 16 or 8 kHz, FB, SWB, WB or NB.
## 4.3 Codec delay
The input signal is processed using 20 ms frames. The codec delay depends on
the output sampling rate. For WB, SWB and FB output (i.e. output sampling rate
> 8 kHz) the overall algorithmic delay is 32 ms. It consists of one 20 ms
frame, 0.9375 ms delay of input resampling filters on the encoder-side, 8.75
ms for the encoder look-ahead, and 2.3125 ms delay of time-domain bandwidth
extension on the decoder-side. For 8 kHz decoder output the decoder delay is
reduced to 1.25 ms needed for resampling using a complex low-delay filterbank,
resulting in 30.9375 ms overall algorithmic delay.
## 4.4 Coder overview
The EVS codec employs a hybrid coding scheme combining linear predictive (LP)
coding techniques based upon ACELP (Algebraic Code Excited Linear Prediction),
predominantly for speech signals, with a transform coding method, for generic
content, as well as inactive signal coding in conjunction with VAD/DTX/CNG
(Voice Activity Detection/Discontinuous Transmission/ Comfort Noise
Generation) operation. The EVS codec is capable of switching between these
different coding modes without artefacts.
The EVS codec supports 5.9kbps narrowband and wideband variable bit rate (VBR)
operation based upon the ACELP coding paradigm which also provides the AMR-WB
interoperable encoding and decoding. In addition to perceptually optimized
waveform matching, the codec utilizes parametric representations of certain
frequency ranges. These parametric representations constitute coded bandwidth
extensions or noise filling strategies.
The decoder generates the signal parameters represented by the indices
transmitted in the bit-stream. For the bandwidth extension and noise fill
regions estimates from the coded regions are used in addition to the decoded
parametric data to generate the signals for these frequency regions.
The description of the coding algorithm of this Specification is made in terms
of bit-exact, fixed-point mathematical operations. The ANSI C code described
in [3], which constitutes an integral part of this Specification, reflects
this bit-exact, fixed-point descriptive approach. The mathematical
descriptions of the encoder (clause 5), and decoder (clause 6), can be
implemented in different ways, possibly leading to a codec implementation not
complying with this Specification. Therefore, the algorithm description of the
ANSI C code of [3] shall take precedence over the mathematical descriptions of
clauses 5 and 6 whenever discrepancies are found. A non-exhaustive set of test
signals that can be used with the ANSI C code are available described in [4].
### 4.4.1 Encoder overview
Figure 1 represents a high-level overview of the encoder. The signal
resampling block corrects mismatches between the sampling frequency and the
signal bandwidth command line parameter that is specified on the command line
or through a file containing a bandwidth switching profile as explained in TS
26.442 and TS 26.443. For the case that the signal bandwidth is lower than
half the input sampling frequency, the signal is decimated to a the lowest
possible sampling rate out of the set of (8, 16, 32 kHz) that is larger than
twice the signal bandwidth.
{width="5.5055555555555555in" height="2.9277777777777776in"}
Figure 2: Encoder overview
The signal analysis determines which of three possible encoder strategies to
employ: LP based coding (ACELP), frequency domain encoding and inactive coding
(CNG). In some operational modes the signal analysis step includes a closed
loop decision to determine which encoding method will result in the lowest
distortion. Further parameters derived in the signal analysis aid the
operation of these coding blocks and some of the analysis parameters, such as
the coding strategy to be employed, are encoded into the bit-stream. In each
of the coding blocks the signal analysis is further refined to obtain
parameters relevant for the particular coding block.
The signal analysis and sub-sequent decision of the coding mode is performed
independently for each 20ms frame and the switching between different modes is
possible on a frame-by-frame basis. In the switching instance parameters are
exchanged between the coding modes to ensure that the switching is as seamless
as possible and closed-loop methods are sometimes employed in this case. In
addition, switching between different bandwidths and/or bit-rates (including
both the EVS Primary mode and the EVS AMR-WB IO mode) is possible on frame
boundaries.
The signal analysis and all other blocks have full access to the command line
parameters such as bit-rate, sampling rate, signal bandwidth, DTX activation
as signalling information.
#### 4.4.1.1 Linear Prediction Based Operation
The input signal is split into high frequency band and low frequency band
paths; where the cut-off frequency between these two bands is determined from
the operational mode (bandwidth and bit-rate) of the codec.
The linear-prediction coefficient estimation is performed for every 20ms
frame. Within a frame, several interpolation points are established depending
upon the bitrate and the optimum interpolation is transmitted to the decoder.
The linear-prediction residual is further analysed and quantized using
different quantization schemes dependent upon the nature of the residual. For
the 5.9kbps VBR operation additional low-rate coding modes at rates conforming
to the design constraints are employed.
The high-frequency portion of the signal is represented with several different
parametric representations. The parameters used for this representation vary
as a function of the bit-rate and the residual quantization strategy. The
transmitted parameters include some or all of spectral envelope, energy
information and temporal evolution information.
The LP based core can be configured so that both the linear prediction
coefficients and the residual quantization are interoperable with the AMR-WB
decoder. For this purpose the configuration of the LP coefficient estimation,
parametric HF representation and the residual quantization is similar to those
of AMR-WB. For the AMR-WB interoperable operation modes, identical codebooks
to the AMR-WB quantizers are used.
{width="5.572222222222222in" height="2.709722222222222in"}
Figure 3: Linear prediction based operation including parametric HF
representation
#### 4.4.1.2 Frequency Domain Operation
For the frequency domain coding the encoding block can be envisaged as being
separated into a control layer and a signal processing layer. The control
layer performs signal analysis to derive several control and configuration
parameters for the signal processing layer. The time-to-frequency
transformation is based on the Modified Discrete Cosine Transform (MDCT) and
provides adaptive time-frequency resolution. The control layer derives
measures of the time distribution of the signal energy in a frame and controls
the transform.
The MDCT coefficients are quantized using a variety of direct and parametric
representations depending upon bit rate signal type and operating mode.
{width="5.800694444444445in" height="2.422222222222222in"}
Figure 4: Frequency domain encoder
#### 4.4.1.3 Inactive Signal coding
When the codec is operated in DTX on mode the signal classifier depicted in
Figure 1 selects the discontinuous transmission (DTX) mode for frames that are
determined to consist of background noise. For these frames a low-rate
parametric representation of the signal is transmitted no more frequently than
every 8 frames (160ms).
The low-rate parametric representation is used in the decoder for comfort
noise generation (CNG) and includes parameters describing the frequency
envelope of the background signal, energy parameters describing the overall
energy and its time evolution.
#### 4.4.1.4 Source Controlled VBR Coding
VBR coding describes a method that assigns different number of bits to a
speech frame in the coded domain depending on the characteristics of the input
speech signal [20] [21]. This method is often called source-controlled coding
as well. Typically, a source-controlled coder encodes speech at different bit
rates depending on how the current frame is classified, e.g., voiced,
unvoiced, transient, or silence. Note that DTX operation can be combined with
VBR coders in the same way as with Fixed Rate (FR) coders; the VBR operation
is related to active speech segments.
The VBR solution provides narrowband and wideband coding using the bit rates
2.8, 7.2 and 8.0 kbps and produces an average bit rate at 5.9 kbps.
Due to the finer bit allocation, in comparison to Fixed Rate (FR) coding, VBR
offers the advantage of a better speech quality at the same average active bit
rate than FR coding at the given bit rate. The benefits of VBR can be
exploited if the transmission network supports the transmission of speech
frames (packets) of variable size, such as in LTE and UMTS networks.
### 4.4.2 Decoder overview
The decoder receives all quantized parameters and generates a synthesized
signal. Thus, for the majority of encoder operations it represents the inverse
of the quantized value to index operations.
For the AMR-WB interoperable operation the index lookup is performed using the
AMR-WB codebooks and the decoder is configured to generate an improved
synthesized signal from the AMR-WB bitstream.
#### 4.4.2.1 Parametric Signal Representation Decoding (Bandwidth Extension)
In addition to the generation of signal components specifically represented by
the transmitted indices, the decoder performs estimates of signal regions
where the transmitted signal representation is incomplete, i.e. for the
parametric signal representations and noise fill as well as blind bandwidth
extension in some cases.
#### 4.4.2.2 Frame loss concealment
The EVS codec includes frame loss concealment algorithms [21]. For all coding
modes an extrapolation algorithm is in place that estimates the signal in a
lost frame. For the LP based core this estimation operates on the last
received residual and LP coefficients. For the frequency domain core in some
cases the last received MDCT coefficients are extrapolated and in addition the
resulting time domain signal is guaranteed to give a smooth time evolution
from the last received frame into the missing frames.
Once the frame loss is recovered, i.e., the first good frame is received the
codec memory is updated and frame boundary mismatches towards the last lost
frame are minimized.
For situations of sustained frame loss the signal is either faded to
background noise or its energy is reduced and finally muted when no reasonable
extrapolation can be assumed.
The EVS codec also includes the "channel aware" mode, which may be employed
for improved performance under packet loss conditions in a VoIP system. In the
channel aware mode, partial copies (secondary frames) of the current speech
frame are piggybacked on future speech frames (primary frames), without any
increase in the total bit rate for the primary and secondary frames. If the
current frame is lost, then its partial copy can be retrieved by polling the
de-jitter buffer to enable faster and improved recovery from the packet loss.
### 4.4.3 DTX/CNG operation
The codec is equipped with a signal activity detection (SAD) algorithm for
classifying each input frame as active or inactive. It supports a
discontinuous transmission (DTX) operation in which the comfort noise
generation (CNG) module is used to approximate and update the statistics of
the background noise at a variable bit rate. Thus, the transmission rate
during inactive signal periods is variable and depends on the estimated level
of the background noise. By default in the command line the transmission rate
of CNG update is fixed to 8 frames. However, the CNG update rate can also be
set to another fixed value or a variable rate by means of a command line
parameter; when the transmission rate during inactive signal periods is
variable, it depends on the estimated level of the background noise.
#### 4.4.3.1 Inactive Signal coding
When the codec is operated in DTX on mode the signal classifier depicted in
Figure 1 selects the discontinuous transmission (DTX) mode for frames that are
determined to consist of background noise. For these frames a low-rate
parametric representation of the signal is transmitted no more frequently than
every 8 frames (160ms).
The low-rate parametric representation is used in the decoder for comfort
noise generation (CNG) and includes parameters describing the frequency
envelope of the background signal, energy parameters describing the overall
energy and its time evolution.
### 4.4.4 AMR-WB-interoperable option
As mentioned previously, EVS can operate in a mode which is fully
interoperable with the AMR-WB codec bitstream.
### 4.4.5 Channel-Aware Mode
EVS offers partial redundancy [21] based error robust channel aware mode at
13.2 kbps for both wideband and super-wideband audio bandwidths.
In a VoIP system, packets arrive at the decoder with random jitters in their
arrival time. Packets may also arrive out of order at the decoder. Since the
decoder expects to be fed a speech packet every 20 ms to output speech samples
in periodic blocks, a de-jitter buffer is required to absorb the jitter in the
packet arrival time. The channel aware mode combines the presence of a de-
jitter buffer with partial redundancy coding of a current frame which gets
piggy backed onto a future frame. At the receiver, the de-jitter buffer is
polled to check if a partial redundant copy of the current lost frame is
available in any of the future frames. If present, the partial redundant
information is used to synthesize the lost frame which offers significant
quality improvements under low to high FER conditions. Source control is used
to determine which frames of input can best be coded at a reduced frame rate
(called primary frames) to accommodate the attachment of redundancy without
altering the total packet size. In this way, the channel aware mode includes
redundancy in a constant-bit-rate channel (13.2 kbps).
4.5 Organization of the rest of the Technical Standard