# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document is part of a series of Technical Specifications (TSs)
that specify charging functionality and charging management in GSM/UMTS
networks. The GSM/UMTS core network charging architecture and principles are
specified in TS 32.240 [1], which provides an umbrella for other charging
management TSs that specify:
\- the content of the CDRs per domain and subsystem (offline charging);
\- the content of real-time charging messages per domain / subsystem (online
charging);
\- the functionality of online and offline charging for those domains and
subsystems;
\- the interfaces that are used in the charging framework to transfer the
charging information (i.e. CDRs or charging events)
The complete document structure for these TSs is defined in TS 32.240 [1].
The present document specifies the Offline and Online Charging for MultiMedia
Telephony (MMTel) service and supplementary services, based on the functional
description of MMTel in TS 22.173 [200]. Charging for the following
supplementary services is specified:
\- Communications Diversion (CDIV);
\- Communication Hold (HOLD);
\- CONFerence (CONF);
\- Message Waiting Indication (MWI);
\- Originating Identity Presentation (OIP) / Originating Identity Restriction
(OIR);
\- Terminating Identity Presentation (TIP) / Terminating Identity Restriction
(TIR);
\- Call Barring (CB);
\- Explicit Call Transfer (ECT);
\- Communication Wait (CW);
\- Completion of Communications to Busy Subscriber (CCBS);
\- Completion of Communications by No Reply (CCNR);
\- Malicious Communication Identification (MCID);
\- Customized Alerting Tone (CAT);
\- Closed User Group (CUG);
\- Personal Network Management (PNM);
\- Customized Ringing Signal (CRS);
\- Reverse Charging;
\- Advice of Charge (AoC).
Charging of these supplementary services is performed at the respective MMTel
AS. The MMTel charging aspects are an extension of the basic IMS charging
capabilities as specified in the TS 32.260 [20].
This charging description includes the offline and online charging
architecture and scenarios specific to the MMTel, as well as the mapping of
the common 3GPP charging architecture specified in TS 32.240 [1] onto the
MMTel. It further specifies the structure and content of the CDRs for offline
charging, and the charging events for online charging.
The present document is related to other 3GPP charging TSs as follows:
\- The common 3GPP charging architecture is specified in TS 32.240 [1];
\- The common IMS charging principles are specified in the TS 32.260 [20].
\- The parameters, abstract syntax and encoding rules for these CDR types are
specified in TS 32.298 [51].
\- A transaction based mechanism for the transfer of CDRs within the network
is specified in TS 32.295 [54].
\- The file based mechanism used to transfer the CDRs from the network to the
operator\'s Billing Domain (e.g. the billing system or a mediation device) is
specified in TS 32.297 [52].
\- The 3GPP Diameter application that is used for MMTel offline and online
charging is specified in\ TS 32.299 [50].
All references, abbreviations, definitions, descriptions, principles and
requirements, used in the present document, that are common across 3GPP TSs,
are defined in the 3GPP Vocabulary, TR 21.905 [100]. Those that are common
across charging management in GSM/UMTS domains or subsystems are provided in
the umbrella document TS 32.240 [1]. Finally, those items that are specific to
the present document are defined exclusively in the present document.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TS 32.240: \"Telecommunication management; charging management;
charging architecture and principles\".
[2] - [19] Void
[20] 3GPP TS 32.260: \"Telecommunication management; Charging management; IP
Multimedia Subsystem (IMS) charging\".
[21] - [40] Void.
[41] 3GPP TS 32.281: \"Telecommunication management; Charging management;
Announcement service\".
[42] - [49] Void.
[50] 3GPP TS 32.299: \"Telecommunication management; Charging management;
Diameter charging application\".
[51] 3GPP TS 32.298: \"Telecommunication management; Charging management;
Charging Data Record (CDR) parameter description\".
[52] 3GPP TS 32.297: \"Telecommunication management; Charging management;
Charging Data Record (CDR) file format and transfer\".
[53] 3GPP TS 32.296: \"Telecommunication management; Charging management;
Online Charging System (OCS) applications and interfaces\".
[54] 3GPP TS 32.295: \"Telecommunication management; Charging management;
Charging Data Record (CDR) transfer\".
[55] - [68] Void.
[69] 3GPP TS 32.280: \"Telecommunication management; Charging management;
Advice of Charge (AoC) service\".
[70] - [99] Void.
[100] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[101] 3GPP TS 22.101: \"Service aspects; Service principles\".
[102] 3GPP TS 22.115: \"Service aspects; Charging and billing\".
[103] 3GPP TS 23.002: \"Network architecture\".
[104] - [199] Void.
[200] 3GPP TS 22.173: \"IP Multimedia Core Network Subsystem (IMS) Multimedia
Telephony Service and supplementary services; Stage 1\".
[201] 3GPP TS 24.173: \"IMS Multimedia telephony communication service and
supplementary services; Stage 3 \".
[202] 3GPP TS 24.604: \"Communication Diversion (CDIV) using IP Multimedia
(IM) Core Network (CN) subsystem; Protocol specification\".
[203] 3GPP TS 24.605: \"Conference (CONF) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[204] 3GPP TS 24.606: \"Message Waiting Indication (MWI) using IP Multimedia
(IM) Core Network (CN) subsystem; Protocol specification\".
[205] 3GPP TS 24.607: \"Originating Identification Presentation (OIP) and
Originating Identification Restriction (OIR) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[206] 3GPP TS 24.608: \"Terminating Identification Presentation (TIP) and
Terminating Identification Restriction (TIR)using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[207] 3GPP TS 24.610: \"Communication HOLD (HOLD) using IP Multimedia (IM)
Core Network (CN) subsystem; Protocol specification\".
[208] 3GPP TS 24.611: \"Anonymous Communication Rejection (ACR) and
Communication Barring (CB)using IP Multimedia (IM) Core Network (CN)
subsystem; Protocol specification\".
[209] 3GPP TS 24.615: \"Communication Waiting (CW) using IP Multimedia (IM)
Core Network (CN) subsystem; Protocol specification\".
[210] 3GPP TS 24.616: \"Malicious Communication Identification (MCID) using IP
Multimedia (IM) Core Network (CN) subsystem; Protocol specification\".
[211] 3GPP TS 24.623: \"Extensible Markup Language (XML) Configuration Access
Protocol (XCAP) over the Ut interface for Manipulating Simulation Services\".
[212] 3GPP TS 24.629: \"Explicit Communication Transfer (ECT) using IP
Multimedia (IM) Core Network (CN) subsystem; Protocol specification\".
[213] 3GPP TS 24.642: \"Completion of Communications to Busy Subscriber (CCBS)
and Completion of Communications by No Reply (CCNR) using IP Multimedia (IM)
Core Network (CN) subsystem; Protocol specification\".
[214] 3GPP TS 24.647: \"Advice Of Charge (AOC) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[215] 3GPP TS 24.654: \"Closed User Group (CUG) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification\".
[216] 3GPP TS 24.239: \"Flexible Alerting (FA) using IP Multimedia (IM) Core
Network (CN) subsystem, Protocol specification\".
[217] 3GPP TS 24.182: \"IP Multimedia Subsystem (IMS) Customized Alerting
Tones (CAT); Protocol specification\".
[218] 3GPP TS 23.259: \"Personal Network Management (PNM); Procedures and
information flows; Stage 2\".
> [219] 3GPP TS 24.183: \"IP Multimedia Subsystem (IMS) Customized Ringing
> Signal CRS); Protocol specification\".
>
> [220] 3GPP TS 24.147: \"Conferencing using the IP Multimedia (IM) Core
> Network (CN) subsystem; Stage 3\".
[221] 3GPP TS 24.228: \"Signalling flows for the IP multimedia call control
based on Session Initiation Protocol (SIP) and Session Description Protocol
(SDP); Stage 3\".
[222] - [401] Void.
[402] IETF RFC 4006 (2005): \"Diameter Credit-Control Application\".
[403] - [499] Void.
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [100], TS 32.240 [1] apply.
## 3.2 Symbols
For the purposes of the present document, the following symbols applies:
Bi Reference point for the CDR file transfer from the IMS CGF to the BD.
Ga Reference point for CDR transfer between a CDF and CGF.
Rf Offline Charging Reference Point between an IMS Network Entity or an AS and
CDF
Ro Online Charging Reference Point between an AS or MRFC and IMS-GWF and the
OCS
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations defined in TR
21.905 [100], TS 32.240 [1] and the following apply:
3PCC Third Party Call Control
3PTY Three-Party
AoC Advice of Charge
CAT Customized Alerting Tone
CB Communication session Barring
CCBS Completion of Communication sessions to Busy Subscriber
CCNR Completion of Communications on No Reply
CD Communication Deflection
CDIV Communication DIVersion
CFB Communication Forwarding Busy
CFU Communication Forwarding Unconditional
CFNL Communication Forwarding on Not Logged-in
CFNR Communication Forwarding No Reply
CFNRc Communication Forwarding on Subscriber Not Reachable
CFUDB Communication Forwarding User Determined Busy
CONF CONFerence
CUG Closed User Group
CW Communication Waiting
ECT Explicit Communication Transfer
FA Flexible Alerting
HOLD Communication HOLD
ICB Incoming Communication Barring
MCID Malicious Communication Identification
MMTel MultiMedia Telephony
MWI Message Waiting Indication
NDUB Network Determined User Busy
OCB Outgoing Communication Barring
OIP Originating Identity Presentation
OIR Originating Identity Restriction
PNM Personal Network Management
CRS Customized Ringing Signal
TIP Terminating Identity Presentation
TIR Terminating Identity Restriction
URN Uniform Resource Name
# 4 Architecture considerations
## 4.1 High level MMTel architecture
Figure 4.1.1 depicts the IMS reference architecture, as described in TS 23.002
[103], with \"colorized\" AS as entity involved in MMTel service and
supplementary services charging described in the present document.
Figure 4.1.1: Entities involved in MMTel service charging in IMS logical
architecture
The AS provides the application level network functionality for MMTel service
and supplementary services, whereas the overall IMS Network provides the basic
IMS capabilities supporting MMTel service.
## 4.2 MMTel offline charging architecture
Figure 4.2.1 depicts the MMTel offline charging architecture.
Figure 4.2.1: MMTel offline charging architecture
This MMtel offline charging architecture is based on the IMS offline charging
architecture described in TS 32.260 [20], with service CTFs supporting MMtel
specific service charging, interfacing the CDF through the Rf reference point.
The CTFs considered in the MMTel offline charging architecture reside in the
Application level network functionality providing MMTel service and
supplementary services.
The CTFs related to charging for the IMS basic capabilities supporting MMTel
service, are described in TS 32.260 [20], and reside in the set of IMS Nodes
(S-CSCF, MRFC...) reflected in IMS offline architecture.
## 4.3 MMTel online charging architecture
The architecture for MMTel online charging is described in figure 4.3.1..
Figure 4.3.1: MMTel online charging architecture
This MMtel online charging architecture is based on the IMS online charging
architecture described in TS 32.260 [20], with service CTFs supporting MMtel
specific service charging, interfacing the OCS through the Ro reference point.
The CTFs considered in the MMTel online charging architecture reside in the
Application level network functionality providing MMTel service and
supplementary services.
The CTFs related to charging for the IMS basic capabilities supporting MMTel
service, are described in TS 32.260 [20], and reside in the set of IMS Nodes
(S-CSCF, MRFC...) reflected in IMS online architecture.
# 5 MMTel charging principles and scenarios
## 5.0 Introduction
There are a variety of multimedia telephony supplementary services implemented
at different IMS nodes. All the services should support subscription based
charging, and some also consumption based charging. The subscription based
charging is out of the scope of the present document.
Table 5.0.1 summarizes which of the services are applicable for offline and
online charging.
Table 5.0.1: Relevance of the services for offline and online charging
* * *
Supplementary services Offline Charging Online Charging OIP X - OIR X - TIP X
- TIR X - CW X - HOLD X - CB X - MWI X - CONF X X CCBS X - CCNR X - CDIV X X
ECT X X FA X X MCID X - CAT X - CUG X X PNM X - CRS X - AoC X -
* * *
## 5.1 MMTel charging principles
### 5.1.0 Introduction
The MMTel charging encompasses the Multimedia telephony service (e.g.
multimedia conversational communications between two or more users, with
speech as a typical usage, and also others combinations of media) together
with the associated supplementary services charging aspects.
Every Supplementary services described in TS 22.173 [200] are subject to be
involved in MMTel charging function description.
MMTel service and supplementary services charging function focuses on charging
information provided by the CTFs supporting MMtel specific service charging:
calling user identification, called user identification, media component
characteristics and usage (speech only, speech with other component,
add/retrieve components..), supplementary services applied. It enables to
apply different flexible charging based on supplementary service type and
options.
All the CTFs supporting MMtel specific service charging (AS) pertain to IMS
domain, and as explained in TS 32.260 [20], it is possible to correlate
session/transaction related charging data generated from these different Nodes
(AS), and others IMS Nodes involved in the session used for MMTel service
handling , based on IMS Charging Identifier (ICID).
For AS(s) providing MMTel specific service and supplementary services, the
\"OneChargingSession\" option, as described in TS 32.260 [20] can be applied,
when acting as a B2BUA with IMS Charging Identifier (ICID) preserved between
dialogs.
### 5.1.1 Supplementary services invocation
#### 5.1.1.1 OIP charging
The Originating Identification Presentation (OIP) service provides the
terminating user with the possibility of receiving trusted (i.e.
networkâ€‘provided) identity information in order to identify the originating
user.
The charging of the OIP subscribers is measured by the MMTel AS handling OIP
in offline charging only.
#### 5.1.1.2 OIR charging
The Originating Identification Restriction (OIR) service is a service offered
to the originating user. It restricts presentation of the originating user\'s
identity information to the terminating user.
The charging of the OIR subscribers is measured by the MMTel AS handling OIR
in offline charging only.
#### 5.1.1.3 TIP charging
The **Terminating Identification Presentation** (**TIP)** service provides the
originating party with the possibility of receiving trusted information in
order to identify the terminating party.
The charging of the TIP subscribers is measured by the MMTel AS handling TIP
in offline charging only.
#### 5.1.1.4 TIR charging
The **Terminating Identification Restriction (TIR)** is a service offered to
the terminating party which enables the terminating party to prevent
presentation of the terminating identity information to originating party.
The charging of the TIP subscribers is measured by the MMTel AS handling TIR
in offline charging only.
#### 5.1.1.5 HOLD charging
The Communication Hold supplementary service enables a user to suspend the
media stream(s) of an established IP multimedia session, and resume the media
stream(s) at a later time.
The charged parties may be any of the Hold parties. These roles are:
\- Calling Party;
**\- Called Party;**
Editor\'s note: When one of the parties originates a new call to a third party
and the new call overbooks the bearer resource reserved by the held call,
overbooking may be taken into account in charging. The solution for that is
FFS.
#### 5.1.1.6 CB charging
The **Communication Barring (CB)** service offers the following services:
\- The Incoming Communications Barring (ICB) is a service that rejects
incoming communications that fulfil certain provisioned or configured
conditions on behalf of the terminating user.
\- The Anonymous Communication Rejection **(ACR)** is a particular case of the
ICB service, that allows barring of incoming communications from an anonymous
originator on behalf of the terminating user.
\- The **Outgoing Communication Barring (OCB)** is a service that rejects
outgoing communications that fulfil certain provisioned or configured
conditions on behalf of the originating user.
The charging of the CB subscribers is measured by the MMTel AS handling CB in
offline charging only.
#### 5.1.1.7 CDIV charging
The **Communications Diversion (CDIV)** services enables the diverting user,
to divert the communications addressed to the diverting user to another
destination.
There are three actors active in a CDIV service of one diversion with the
following roles:
\- Diverting user; the party that initiates the diversion of an incoming
communication;
\- Originating user; the party which has initiated the communication and that
stays in the communication which is diverted;
\- Diverted to user;
In case there is another diversion, the user that was first the diverting user
(user B), is the originating user in the second diversion. The diverted to
user of the first diversion (user C) is the diverting user of the second
diversion.
The charging of the diverting user for the B-C leg is measured by the MMTel AS
handling the CDIV service, i.e. by the MMTel AS of the diverting user (user
B). For the diverting user a separate charging dialog (online and/or offline
charging) is needed. Charging of the originating and the terminating user
(user C) is done in alignment with the TS 32.260 [20].
Typically the diverting user is charged for the forwarded leg (B-C leg),
however, normal roaming charging principles apply for the diverted to user
also in case of communication diversion. If there is another diversion, the
user that performs the second diversion (user C) is charged (typically) for
the new forwarded leg (C-D leg).
Charging at the S-CSCF is done in alignment with the TS 32.260 [20] but the
S-CSCF has no knowledge of the CDIV service.
#### 5.1.1.8 CW charging
The Communication Waiting (CW) service enables the application server to
indicate to the subscriber, that there is at least one new communication is
requested, and that no resources are available for that incoming
communication. The user has then the choice of accepting, rejecting or
ignoring the incoming communication. The maximum number of communications that
may be waiting is a service provider option. If the current number of
communications waiting is equal to the maximum, then any new attempted
incoming communication request shall be rejected with a busy cause.
The charging of the CW subscribers is measured by the MMTel AS handling CW in
offline charging only.
#### 5.1.1.9 ECT charging
The Explicit Communication Transfer (ECT) service provides a party involved in
a communication to transfer that communication to a third party.
There are three actors active in a transfer, they are acting in the following
roles:
\- Transferor: the party that initiates the transfer of the active
communication that it has with the Transferee;
\- Transferee: the party which stays in the communication which is
transferred;
\- transfer target: the party which the communication is transferred to and
which replaces the Transferor in the communication.
The charging of the Transferor is measured by the MMTel AS handling the ECT
service for the Transferor.\ The charging of the Transferee is measured by the
MMTel AS handling the ECT service for the Transferee.
#### 5.1.1.10 MWI charging
The Message Waiting Indication (MWI) service enables the application server to
indicate to the subscriber, that there is at least one message waiting. The
indication is delivered to the subscriber\'s UE after successful subscription
to the MWI service as described in the present document.
The charging of the MWI subscribers is measured by the MMTel AS handling MWI
in offline charging only.
#### 5.1.1.11 CONF charging
The **Conference (CONF)** service enables a user to participate in and control
a simultaneous communication involving a number of users.
CONF Charging for the conference owner could be based on:
\- establishment of the conference;
\- number of participants;
\- duration.
CONF Charging for the conference participants could be based on:
\- duration.
The charging of the conference owners and participants is measured by the SIP
AS and MRFC handling conference service. For each participant (call leg) a
separate charging dialog (online and/or offline charging) at the SIP AS is
needed.
#### 5.1.1.12 CCBS charging
The Completion of Communication to Busy Subscriber (CCBS) service enables user
A, encountering a busy destination B, to have the communication completed
without the user having to manually initiate a new communication attempt when
the destination B becomes not busy.
When user A requests the CCBS supplementary service, the network monitors for
destination B becoming free again.
When destination B becomes free again, the network waits a short time in order
to allow the resources to be re-used for originating a communication. If the
resources are not re-used by destination B within this time, the network
automatically recalls user A.
When user A accepts the CCBS recall, the network automatically generates a
CCBS call to destination B.
The charging of the CCBS suscribers is measured by the MMTel AS handling CCBS
in offline charging only.
#### 5.1.1.13 CCNR charging
The Completion of Communications on No Reply (CCNR) service enables user A,
encountering a destination B which does not answer the communication (No
Reply), to have the communication completed without the user having to
manually initiate a new communication attempt when the destination becomes not
busy after having initiated and completed a new communication.
When user A encounters a destination B which does not answer the communication
(No Reply), user A can request the CCNR supplementary service.
When user A requests the CCNR supplementary service, the network monitors for
destination B becoming not busy after having initiated and completed a new
communication.
When destination B becomes not busy after having initiated and completed a new
communication, the network waits a short time (as defined by the destination B
idle guard timer) in order to allow the resources to be reused for originating
a communication. If the resources are not reused by destination B within this
time, the network automatically recalls user A.
When user A accepts the CCNR recall, then the network automatically generates
a CCNR call to destination B.
The charging of the CCNR suscribers is measured by the MMTel AS handling CCNR
in offline charging only.
#### 5.1.1.14 FA charging
Flexible Alerting (FA) causes a call to a \"Pilot Identity\" to branch the
call into several legs to alert several termination addresses (FA group
members) simultaneously.\ Additional calls may be delivered to the FA Pilot
Identity at any time.\ The first leg to be answered is connected to the
calling party. The other call legs are abandoned.
The FA group, identified by the \"Pilot Identity\" consists of a list of FA
group members alerted through their the public addressable identity.
The charging of the \"Pilot Identity\" is measured by the MMTel AS handling
Flexible Alerting for the \"Pilot Identity\".
#### 5.1.1.15 MCID charging
The Malicious Communication Identification (MCID) service enables an incoming
communication to be identified as malicious and registered.
The Network shall register the communication related information (such as
Terminating Identity Information, Originator Identity Information, Local Time
and Date...), which shall be kept under Network Operator\'s control (i.e not
available to the terminating entity nor the originating entity).
This service has two modes: permanent mode and temporary mode. The permanent
mode is active for all incoming communications, and the temporary mode is
active only for the incoming communications declared by the served user.
The MCID service can be invoked during the active phase of the communication,
or after the active phase for a limited period (but never after communication
termination) by the served user, or, automatically invoked during the alerting
phase.
The charging of the MCID subscriber is measured by the MMTel AS handling MCID
service for the called subscriber in offline charging only.
#### 5.1.1.16 CAT charging
The Customized Alerting Tone Service (CAT) service is an operator specific
service by which an operator enables the subscriber to customize the alerting
tone which is played to the calling party.
The charging of the CAT subscriber is measured by the MMTel AS handling CAT
service for the called subscriber, in offline charging only.
#### 5.1.1.17 CUG charging
The Closed User Group (CUG) service enables users to form groups of members,
whose communication profile is restricted for incoming and outgoing
communications. Members of a specific CUG can communicate among themselves but
not, in general, with users outside the group.
Specific CUG members can have additional capabilities that allow them to
initiate outgoing communications to users outside the group, and/or to accept
incoming communications from users outside the group. Specific CUG members can
have additional restrictions that prevent outgoing communications to other
members of the CUG, or prevent incoming communications from other members of
the CUG.
A specific user may be a member of one or more CUGs.
The charging of the CUG subscribers is measured by the MMTel AS handling CUG
service for offline and online charging.
#### 5.1.1.18 PNM charging
The Personal Network Management (PNM) service allows a user to manage his UEs
in regard to terminating services according to preferences set by the user,
capabilities and availabilities of devices. Charging for the \"PN UE
redirection\" functionality of the defined PNM service, is considered in the
scope of MMTel supplementary service charging, and applies to the active UE
the terminating services are delivered to.
The charging of the PNM subscribers is measured by the MMTel AS handling PNM
in offline charging only.
#### 5.1.1.19 CRS charging
The Customized Ringing Signal (CRS) service is an operator specific service by
which an operator enables the subscriber to customize the ringing signal which
is played to the called party.
The charging of the CRS subscriber is measured by the MMTel AS handling CRS
service for the called or the calling subscriber, in offline charging only.
#### 5.1.1.20 Reverse charging
The Reverse charging at communication set up time service allows the
terminating party to be charged for the entire communication. The service,
requested by the originating party at communication set up time, is explicitly
indicated to the terminating party so he can accept or deny the reverse charge
communication request.
Editor\'s Note: There is no stage 3 description for Reverse Charging in this
Release: FFS.
#### 5.1.1.21 AoC charging
The Advice of Charge (AoC) service allows the served user to be provided with
MMTel service charging information related to:
\- AoC at communication set-up time (AoC-S);
\- AoC during the communication (AoC-D);
\- AoC at the end of the communication (AoC-E).
The AoC related charging information provided by the MMTel AS is applicable in
offline charging only.
### 5.1.2 Supplementary services management by the user
When an IMS supplementary service control can be provided to the UE as a
subscription option, every action performed by the user for this service
(Provision/Withdrawal, Registration/Erasure, Activation/Deactivation,
interrogation) may be subject to produce charging information, but this aspect
is out of the scope of the present document.
### 5.1.3 OCS-provided announcements for MMTel service
During an online charging session from an AS providing MMTel service and
supplementary services, the OCS may utilize the Announcement service specified
in TS 32.281 [41] to request this AS to render video or audio announcements to
a subscriber involved in the MMTel service/supplementary services.
Further details on announcements interaction with MMTel supplementary services
are specified in clause 5.3.2.1
## 5.2 MMTel offline charging scenarios
5.2.1 Basic principles
The MMTel offline charging functionality is based on the CTFs reporting
accounting information, by sending Diameter _Charging Data Requests_ Charging
Data Request [start, interim, stop and event] to the CDF.
The circumstances on which the Diameter client uses Charging Data
Request[start, interim and stop], or Charging Data Request[Event] depend on
the supplementary service type and is determined for each of them. Further
details are specified in clause 5.2.2.
These Diameter Charging Data Request triggers may be configured in such a way
several MMTel supplementary services can be regrouped. Providing this
flexibility allows to improve situations where several MMTel supplementary
services are handled within the same AS for complying with interactions
requirements associated to these MMTel supplementary services.
### 5.2.2 Diameter message flows
#### 5.2.2.0 Introduction
The flows described in the present document specify the charging
communications between the different CTF entities and the charging functions
for different charging scenarios. The SIP messages and Diameter transactions
associated with these charging scenarios are shown primarily for general
information and to illustrate the charging triggers.\ They are not intended to
be exhaustive of all the SIP message flows discussed in TS 24.228 [221] and
they depend on the Diameter Charging Data Requests triggers configured by the
operator.
Although each MMTel supplementary service is described by separated flows
illustrating the dedicated trigger(s) for this MMTel supplementary service,
the Diameter Charging Data Request triggers (as stated in 5.2.1), may be
configured with several MMtel supplementary services information.
#### 5.2.2.1 Message flows - Successful cases and scenarios
##### 5.2.2.1.0 **Introduction**
Following message flows are defined in TS 32.260 [20], and can be re-used for
charging the basic multimedia telephony capabilities:
\- Session Establishment - IMS Origination;
\- Session Establishment- IMS Termination;
\- Mid-Session Procedures;
\- Session Release - Mobile Initiated.
##### 5.2.2.1.1 **Originating Identification Presentation (OIP) charging**
Figure 5.2.2.1.1.1 shows the Diameter transactions that are required between
AS and CDF, which implements the OIP service, and CDF after service execution.
Figure 5.2.2.1.1.1: Message sequence chart for offline charging of OIP service
##### 5.2.2.1.2 Originating Identification Restriction (OIR) **charging**
Figure 5.2.2.1.2.1 shows the Diameter transactions that are required between
AS and CDF, which implements the OIR service, and CDF after service execution.
Figure 5.2.2.1.2.1: Message sequence chart for offline charging of OIR service
##### 5.2.2.1.3 Terminating Identification Presentation (TIP) **charging**
Figure 5.2.2.1.3.1 shows the Diameter transactions that are required between
AS and CDF, which implements the TIP service, and CDF after service execution.
Figure 5.2.2.1.3.1: Message sequence chart for offline charging of TIP service
##### 5.2.2.1.4 Terminating Identification Restriction (TIR) **charging**
Figure 5.2.2.1.4.1 shows the Diameter transactions that are required between
AS and CDF, which implements the TIR service, and CDF after service execution.
Figure 5.2.2.1.4.1: Message sequence chart for offline charging of TIR service
##### 5.2.2.1.5 **Communication Hold** (HOLD) **charging**
Figure 5.2.2.1.5.1 shows the Diameter transactions that are required between
AS which implements the HOLD service, and CDF after service execution. The
involvement of the AS is optional as it is involved to the HOLD service
provision only for announcement purposes.
Figure 5.2.2.1.5.1: Message sequence chart for offline charging of HOLD
service
NOTE: Based on TS 24.610 [207] a scenarion triggerted by Re-Invite is also
possible.
##### 5.2.2.1.6 **Communication Barring** \-- CB (ICB/ACB) **charging**
###### 5.2.2.1.6.1 Communication Barring (CB) -- ICB and Charging Data Request
Figure 5.2.2.1.6.1.1 shows the Diameter transactions that are required between
AS and CDF, which implements the CB service, and CDF after service execution.
**Figure 5.2.2.1.6.1.1: Message sequence chart for offline charging of CB
service**
###### 5.2.2.1.6.2 Communication Barring (CB) -- OCB
Figure 5.2.2.1.6.2.1 shows the Diameter transactions that are required between
AS and CDF, which implements the CB service, and CDF after service execution.
Figure 5.2.2.1.6.2.1: Message sequence chart for offline charging of CB
service
##### 5.2.2.1.7 **Communications Diversion (CDIV)** **charging**
###### 5.2.2.1.7.1 Communications Diversion (CDIV) -- successful establishment
Figure 5.2.2.1.7.1.1 shows the Diameter transactions that are required between
AS,implementing the CDIV service and CDF for a successful communication
forwarding on no reply.
Figure 5.2.2.1.7.1.1 : Message sequence chart for offline charging of CDIV
service - establishment
A communication is requested towards User B, user B has activated the CFNR
1\. SIP INVITE request incoming for User B. Based on the Initial Filter
Criteria (IFC) rules, indicating that User B is subscribed to the CDIV
supplementary services, the communication is forwarded to an AS implementing
AS implementing CDIV. Then SIP INVITE is forwarded to User B.
2\. 180 ringing is sent back from User B.
3\. The non-reply timer in the AS is started .
4\. The timer expires.
5 to 7. The AS implementing the CDIV service performs the Call Forwarding No
Reply logic: release the communication to User B, and forward the call towards
user C (SIP INVITE request including URI-C as destination).
8\. The destination User C party answers and a final response is received.
9\. Upon reception of the final response, the AS implementing the CDIV service
sends a Charging Data Request [Start/Event] to record call forwarding
execution (start of the forwarded leg from User B to User C): basic
communication information are transferred with specific call forwarding
information (service mode= \"CFNR\", associated number = \" user B\" as the
user who invoked the call forwarding).
10\. The CDF acknowledges the reception of the data and opens/creates an AS
CDR to record the forwarded leg from User B to User C.
NOTE : Although only the \"call forwarding on no reply\" case is depicted here
, it serves as a basis for all other call forwarding modes description (Call
Forwarding Unconditional, Call Deflection, Call Forwarding on Busy, Call
Forwarding Not Logged-in ) for Charging Data Request generation : In all these
cases, the AS AS implementing the CDIV service sends a Charging Data Request
[Start] to record call forwarding execution (whatever the mode), when the
final response is received from user-C.
###### 5.2.2.1.7.2 Communications Diversion (CDIV) -- release
Figure 5.2.2.1.7.2.1 shows the Diameter transactions occurring on release of
the previous established communication, initiated by user C.
Figure 5.2.2.1.7.2.1: Message sequence chart for offline charging of CDIV
service -release
1\. User C initiates release of the communication.
2\. At session termination the AS implementing the CDIV service, sends a
Charging Data Request [Stop] to record stop the call for which User B has been
forwarded.\ The AS CDR is closed.
##### 5.2.2.1.8 Communication Waiting (CW) charging
Figure 5.2.2.1.8.1 shows the Diameter transactions that are required between
AS, which implements the CW service and CDF for the callee (subscriber of CW).
Figure 5.2.2.1.8.1: Message sequence chart for offline charging of CW service
1-2. The communication is initiated by UE-A by sending an SIP INVITE request.
The Request URI includes the URI of UE-B. After IFC evaluation in the S-CSCF
the SIP INVITE request is routed to the CW AS.
2a. The AS detects the CW condition and inserts a CW indication into the SIP
INVITE request per procedures.
3-4. The SIP INVITE is routed to UE-B.
5\. UE-B recognizes the CW indication per procedures.
6\. UE-B sends back a 180 (Ringing) response.
6a. Out of scope: user B uses the HOLD service or releases a session in order
to free resources.
7-8. The SIP 180 (Ringing) response is routed back to the AS.
8a. The AS optionally inserts a Alert-Info with a \'CW\' URN into the 180
(Ringing) response.
9-10.The SIP 180 (Ringing) response is routed back to the communication
origin.
9a. The AS may initiate an announcement to the calling user that the
communication is a waiting communication, in accordance with TS 24.628 [4].]
11-14. UE-B sends back a SIP 200 (OK) response to the CW AS and CW AS sends it
to the S-CSCF.
15-17. The CW AS sends a Charging Data Request [Start]/ Charging Data Request
[Event] to CDF, then the CDF opens/creates an AS CDR for the Communication
Waiting with CW indication on the AS CDR and returns Charging Data Response to
the CW AS.
18\. S-CSCF sends back a SIP 200(OK) response to UE-A.
##### 5.2.2.1.9 Explicit Communication transfer (ECT) **charging**
###### 5.2.2.1.9.1 Explicit Communication transfer (ECT): Blind Transfer
Figure 5.2.2.1.9.1.1 and figure 5.2.2.1.9.1.2 show the Diameter transactions
that are required between ASs implementing the ECT service (for the transferor
and for the transferee) and CDF: a successful Blind Transfert from User A to
User C, initiated by User B.
For diagram simplification, only one CDF is shown.
Figure 5.2.2.1.9.1.1: Message sequence chart for offline charging of ECT
service --\ Blind Transfer (part1)
Figure 5.2.2.1.9.1.2: Message sequence chart for offline charging of ECT
service --\ Blind Transfert (part 2)
In this scenario User A is the transferee, User B is the transferor, and User
C is the transfer target.
User A and User B are in an established communication for which, based on the
Initial Filter Criteria (IFC) rules indicating that User B is subscribed to
the ECT supplementary service, the SIP INVITE was forwarded to an AS
implementing ECT (for User A and User B).
User B puts User A on Hold.
1\. User B sends SIP REFER request in the existing A-B dialog, to initiate
transfer User A to User C.
2\. this subsequent request is forwarded to the AS implementing ECT.
3\. AS generates an \"ECT Session Identifier\" replacing User C as the new
destination information, for remaining in the loop, for transferor\'s role.
4\. On SIP REFER receipt, this request is forwarded the AS implementing ECT.
5\. The SIP REFER is accepted by User A, and 202 Accepted is transferred from
User A to User B.
6-9. User B sends SIP BYE for terminating original SIP INVITE with User A,
acknowledged by SIP 200 OK from User A.\ AS B releases the media between User
A and User B which are on hold, then sends a Charging Data Request [Stop] to
record termination of the dialogue between User A and User B.
10\. More signalling between (User A,x-CSCF,AS-A ) and (x-CSCF,AS-B,User B) :
User A sends SIP NOTIFY(100 Trying) associated to the received REFER, and User
B acknowledges by SIP 200 OK..
11\. User A initiates a new session by sending an SIP INVITE request with
\"ECT Session Identifier\".
12\. AS implementing the ECT service correlates this SIP INVITE to the initial
session to be transferred and replaces \"ECT Session Identifier\" with User C
for creating an SIP INVITE towards UE-C.
13 The destination User C party answers and a final response is received.
14\. Upon reception of the final response, the AS implementing the ECT service
for the transferor, sends a Charging Data Request [Start] to record Transfer
execution.
15\. The CDF acknowledges the reception of the data and opens/creates an AS
CDR.
16\. Upon reception of the final response, the AS implementing the ECT service
for the transferee, sends a Charging Data Request [Start] to record User A is
transferred, with specific indicator of whether the transferee was engaged in
an originating call or in a terminating call before the transfer execution.
17\. The CDF acknowledges the reception of the data and opens/creates an AS
CDR.
NOTE 1: The \"Consultative transfer\" scenario mainly differs from the \"Blind
transfer\" on the transfer establishment phase : when User B has put User A on
Hold, User B establishes a communication towards User C and puts User C on
Hold, then User B initiates the SIP REFER for the transfer triggering. The
Charging Data Request [Start] for recording Transfer execution occurs at the
same steps for both scenarios: on the final response associated to SIP INVITE
towards User C for the transferor and for the transferee.
NOTE 2: The \"Assured transfer\" scenario mainly differs from the \"Blind
transfer\" on the transfer establishment phase: User B may include an Expires
header field in the Refer-To URI of the SIP REFER request when initiating
transfer. If User B has not received a SIP NOTIFY request indicating the end
of the transfer operation within the duration of the Expires header allow or
received a SIP NOTIFY indicating that the Assured transfer attempt failed,
User B may request to terminate the transfer attempt by sending a SIP REFER
request in the original communications dialog. Then User B may decide to
retrieve the original communication by sending a SIP re-INVITE message in the
original SIP dialog.\ A Charging Data Request [Event] when the termination SIP
NOTIFY is send out.\ A Charging Data Request [Interim] when the retrieving SIP
re-INVITE is sent out.
###### 5.2.2.1.9.2 Explicit Communication transfer (ECT): Release
Figure 5.2.2.1.9.2.1 shows the Diameter transactions that are required between
ASs implementing the ECT service (for the transferor and for the transferee)
and CDF: release from User A, after a successful Blind Transfer from User A to
User C, initiated by User B.
Figure 5.2.2.1.9.2.1: Message sequence chart for offline charging of ECT
service -- Release
1\. User A initiates release of the communication.
2-3. At session termination the AS implementing the ECT service for the
transferee, sends a Charging Data Request [Stop] to record stop the call for
which User A has been transferred.
4-5. At session termination the AS implementing the ECT service for the
transferor, sends a Charging Data Request [Stop] to record stop the call
transferred by User B. The AS CDR is closed.
##### 5.2.2.1.10 Message Waiting Indication (MWI) charging
Figure 5.2.2.1.10.1 shows the Diameter transactions that are required between
AS (MWI), which implements the MWI service and CDF.
Figure 5.2.2.1.10.1: Message sequence chart for offline charging of MWI
service
1-6. UE subscribes to AS (MWI) and the AS (MWI) returns SIP 200 OK.
> 7-10. The AS (MWI) sends SIP NOTIFY request to S-CSCF and the subscriber UE
> acknowledges the SIP NOTIFY request.
11-13. The AS (MWI) sends Charging Data Request [Event] message to CDF, CDF
creates an AS CDR and returns Charging Data Responseto the AS (MWI).
##### 5.2.2.1.11 Conderence (CONF) Charging
##### 5.2.2.1.11.0 Introduction
During a conference, the user could create the conference, join a conference,
invite another user to the conference and leave the conference, according to
TS 24.605 [203]. The following subclauses respectively show the Diameter
transactions that are required between AS, which implements the CONF service
and CDF corresponding different conference scenarios.
###### 5.2.2.1.11.1 CONF charging -- user creating a conference
{width="6.691666666666666in" height="6.29375in"}
Figure 5.2.2.1.11.1.1 : Message sequence chart for offline charging of CONF
service -\ User creating a conference
1-2. The communication is initiated by UE#1 by sending an SIP INVITE request
to S-CSCF. And S-CSCF sends back 100 Trying reponse to inform UE#1 to wait for
a while because the request is being treated.
3-4. S-CSCF transfers SIP INVITE request from UE#1 to CONF AS and the CONF AS
sends back 100 Trying response to inform S-CSCF to wait for a while because
the request is being treated.
5\. The CONF AS allocates the conference URI.
6-16. After the media resource negociation process, the CONF AS sends back SIP
200 OK response.
17-19. The CONF AS sends Charging Data Request [Start]/Charging Data Request
[Event] to CDF, then the CDF opens/creates an AS CDR for the conference with
CONF indication on the AS CDR and returns Charging Data Response to the CONF
AS.
###### 5.2.2.1.11.2 CONF charging -- user joining a conference
5.2.2.1.11.2.1 shows the Diameter transactions that are required between AS,
which implements the CONF service and CDF corresponding to the conference
scenario: user joining a conference.
Figure 5.2.2.1.11.2.1: CONF charging -- user joining a conference
1-2. The conference has already been created. UE#1 sends an SIP INVITE request
to S-CSCF in order to join in the conference. And S-CSCF sends back SIP 100
Trying reponse to inform UE#1 to wait for a while because the request is being
treated.
3-4. S-CSCF transfers SIP INVITE request from UE#1 to CONF AS and the CONF AS
sends back SIP 100 Trying response to inform S-CSCF to wait for a while
because the request is being treated.
5-15. After the media resource negociation process, the CONF AS sends back SIP
200 OK response.
16-18. The CONF AS sends Charging Data Request [Interim/Event] to CDF, CDF
updates or creates an AS CDR for the conference and returns Charging Data
Response to the CONF AS.
###### 5.2.2.1.11.3 CONF charging -- user inviting another user to a
conference
Figure: 5.2.2.1.11.3.1 shows the Diameter transactions that are required
between AS, which implements the CONF service and CDF corresponding to the
conference scenario: user being invited into a conference.
Figure5.2.2.1.11.3.1: CONF charging -- user inviting another user to a
conference
1-2. The conference has already been created. UE#1 sends a SIP REFER request
to S-CSCF in order to invite UE#2 into the conference.
3-4. The CONF AS sends back 202 Accepted response to UE#1 via some related NEs
like S-CSCF to indicate that he has received the SIP REFER request
successfully.
5-6. The CONF AS sends a SIP NOTIFY request corresponding the SIP REFER
request to UE#1.
7-8. UE#1 sends back SIP 200 OK reponse to the CONF AS.
9-10. The CONF AS sends an SIP INVITE request to UE#2 in order to invite him
into the conference. And UE#2 sends back SIP 200 OK response to the CONF AS.
11-13. The CONF AS sends Charging Data Request [Interim/Event] to CDF, CDF
updates or creates an AS CDR for the conference and returns Charging Data
Response to the CONF AS.
###### 5.2.2.1.11.4 CONF charging -- user leaving a conference
Figure: 5.2.2.1.11.4.1 shows the Diameter transactions that are required
between AS, which implements the CONF service and CDF corresponding to the
conference scenario: user leaving a conference.
Figure: 5.2.2.1.11.4.1: CONF charging -- user leaving a conference
1-2. The conference has already been created. UE#1 sends a SIP BYE request to
the CONF AS in order to quit the conference.
3-5. The CONF AS sends Charging Data Request [Interim/Event] to CDF, CDF
updates or creates an AS CDR for the conference and renturns Charging Data
Response to the CONF AS. Conference termination should refer to the
description of clause 5.3.2.7 in TS 24.147 [220], e.g. if there is not any
conference policy and the last online conference user quits the conference
could be considered as the conference termination, when the last online
conference user quits the conference (sends a SIP BYE request to the CONF AS),
the CONF AS sends Charging Data Request [Stop/Event] to CDF, CDF stops or
creates an AS CDR for the conference and returns Charging Data Response to the
CONF AS.
6-7. The CONF AS sends back SIP 200 OK response to UE#1.
8-10. The CONF AS sends a SIP NOTIFY request to other conference participants
that UE#1 has quitted the conference.
11-12. Other conference participants send back SIP 200 OK response to the CONF
AS.
###### 5.2.2.1.11.5 Three-Party (3PTY) charging -- successful establishment
Figure 5.2.2.1.11.5.1 shows the Diameter transactions that are required
between AS, which implements the 3PTY service and CDF corresponding to the
3PTY scenario: 3PTY service successful establishment.
Figure 5.2.2.1.11.5.1: Three-Party (3PTY) charging -- successful establishment
1\. UE-A and UE-B has established communication. UE-A puts UE-B on hold before
invoking the 3-Way Calling with UE-C.
2-4. UE-A establishes a call with UE-C following normal call setup procedure
and gets UE-C\'s permission to start the 3-Way Calling.
5\. UE-A sends an SIP INVITE request to the 3PTY AS to establish a 3PTY
session.
6-7. The 3PTY AS sends a SIP 200 OK response and receives an ACK request from
UE-A.
8-9. UE-A sends a SIP REFER request to UE-B with the Refer-To header set to
the address of the 3PTY AS; UE-B accepts the SIP REFER request.
10-11. UE-B sends a SIP NOTIFY request to UE-A to indicate that UE-B is acting
on the SIP REFER request.
12\. UE-B sends an SIP INVITE request to the 3PTY AS to join the 3PTY session.
13-14. The 3PTY AS sends a SIP 200 OK response to UE-B and receives an ACK
request.
15-16. UE-B sends a SIP NOTIFY request to UE-A to indicate that it has
finished action required by the SIP REFER request.
17-18. UE-A sends a SIP BYE request to terminate the call between UE-A and
UE-B.
19-20. Repeats step 8 to 18 on UE-Aand UE-C to terminate the call between UE-A
and UE-C.
21-23. 3PTY AS sends an Charging Data Request [Start/Interim/Event] to CDF,
CDF opens or updates or create an 3PTY AS CDR for the 3PTY service and returns
Charging Data Response to the 3PTY AS.
###### 5.2.2.1.11.6 Three-Party (3PTY) charging -- release
Figure 5.2.2.1.11.6.1 shows the Diameter transactions that are required
between AS, which implements the 3PTY service and CDF corresponding to the
3PTY scenario: release the 3PTY service.
Figure 5.2.2.1.11.6.1: Three-Party (3PTY) charging -- release
1\. The 3PTY has already been established. UE-A sends a SIP BYE request to the
3PTY AS in order to release from the 3PTY service.
2-4. At session termination 3PTY AS, sends an _Accounting-Request
[Stop/Event]_ to CDF, CDF stops or creates an AS CDR for the 3PTY service and
returns _Accounting Answer_ to the 3PTY AS.
5\. The 3PTY AS sends back SIP 200 OK response to UE-A.
6\. The 3PTY AS sends a SIP NOTIFY request to other participants that 3PTY
service has released.
##### 5.2.2.1.12 CCBS charging
Figure 5.2.2.1.12.1 shows the Diameter transactions that are required between
AS and CDF, which implements the CCBS service, and CDF after service
execution.
Figure 5.2.2.1.12.1 : Message sequence chart for offline charging of CCBS
service
1-5) The communication is initiated by UE-A by sending an SIP INVITE request.
6) UE-B answers with a SIP 486 (Busy Here) response. The SIP 486 (Busy Here)
response is routed back to the terminating AS.
7-8) The terminating AS inserts a Call-Info header field in the SIP 486 (Busy
Here) response. The Call-Info header field contains the URI of the terminating
AS with an \"m\" header field parameter set to \"BS\" (busy subscriber). It
further includes a \"purpose\" header field parameters set to \"call-
completion\". The SIP 486 (Busy Here) response is routed back to the
originating AS.
9-10) The originating AS sends back a SIP 183 (Session Progress) response to
UE-A and initiates IVR procedures.\ User A is informed that CCBS is possible.
User A activates CCBS.
11-14) The originating AS subscribes for the call-completion event package.
The terminating AS accepts the subscription and starts busy state supervision
procedures on the callee.
15-17) The terminating AS sends a notification to the originating AS.
18-20) The originating AS sends Charging Data Request [Event] to CDF, then the
CDF creates an AS CDR for the CCBS service subscriber with CCBS indication on
the AS CDR and returns Charging Data Response to the originating AS.
21) After confirmation of the notification the originating AS starts
announcements procedures informing about the activation of CCBS.
22-23) The originating AS forwards the SIP 486 (Busy Here) response to UE-A.
24-27) When UE-B becomes available, the terminating AS sends a SIP NOTIFY
request to the originating AS,
28-29) The originating AS starts the CCBS recall by sending an SIP INVITE
request to UE-B. In order to mark the SIP INVITE request as a prioritized
request for call-completion, the originating AS adds the \"m\" SIP URI
parameter with the value \'BS\' to the Request-URI.
##### 5.2.2.1.13 CCNR charging
Figure 5.2.2.1.13.1 shows the Diameter transactions that are required between
AS and CDF, which implements the CCNR service, and CDF after service
execution.
Figure 5.2.2.1.13.1: Message sequence chart for offline charging of CCNR
service
1-5. The communication is initiated by UE-A by sending an SIP INVITE request.
6\. UE-B answers with a 180 (Ringing) response. The 180 (Ringing) response is
routed back to the terminating AS.
7-8. The terminating AS inserts a Call-Info header field in the 180 (Ringing)
response. The Call-Info header field will contain the URI of the terminating
AS with a \"m\" header field parameter set to \"NR\" (no reply). It further
includes a \"purpose\" header field parameter set to \"call-completion\". The
180 (Ringing) response is routed back to the originating AS.
9-10. The originating AS removes the Call-Info header field, forwards the 180
(Ringing) response to UE-A and initiates IVR procedures. User A is informed
that CCNR is possible. User A activates CCNR.
11-14. The originating AS subscribes for the call-completion event package.
The terminating AS accepts the subscription and starts activity supervision
procedures on the callee.
15-17. The terminating AS sends a notification to the originating AS,.
18-20. The originating AS sends Charging Data Request [Event] to CDF, then the
CDF creates an AS CDR for the CCNR service subscriber with CCNR indication on
the AS CDR and returns Charging Data Response to the originating AS.
21\. After confirmation of the notification the originating AS starts
announcements procedures informing about the activation of CCNR.
##### 5.2.2.1.14 Flexible Alerting (FA)
###### 5.2.2.1.14.1 Flexible Alerting (FA) - establishment
Figure 5.2.2.1.14.1.1 shows the Diameter transactions that are required
between AS, implementing the FA service and CDF, with answer from one of FA
group members.
Figure 5.2.2.1.14.1.1: Message sequence chart for offline charging of FA
service - Answered
UE-B and UE-C are FA group members of the FA group identified by the \"Pilot
Identity\".
A communication is requested from UE-A towards the \"Pilot Identity\".
1\. SIP INVITE request incoming for \"Pilot Identity\". Based on the Initial
Filter Criteria (IFC), indicating the request must be forwarded to an AS
implementing FA for this \"Pilot Identiry\".
2\. The AS implementing FA maps the Pilot Identity to the list of FA group
members: UE-B and UE-C, and forwards SIP INVITE to all FA members.
3 to 4. SIP INVITE forwarded towards UE-B and alerting phase signalling occurs
with UE-A.
5 to 6. SIP INVITE forwarded towards UE-C and alerting phase signalling occurs
with UE-A.
7\. UE-C answers.
8 to 10. Upon reception of the SIP 200 OK answer from UE-C, AS implementing
the FA service:
\- Sends Charging Data Request [Start] with FA MMTel supplementary service
indication.\ The CDF creates an AS CDR and returns Charging Data Response to
the AS.
\- Sends SIP CANCEL to other FA group member being alerted, UE-B.
###### 5.2.2.1.14.2 Flexible Alerting (FA) -- call release
Figure 5.2.2.1.14.2.1 shows the Diameter transactions that are required
between AS, implementing the FA service and CDF, when previous successfully
established call is released.
Figure 5.2.2.1.14.2.1: Message sequence chart for offline charging of FA
service - Release
1\. UEC initiates release of the communication.
2 to 3. At session termination the AS implementing the FA service, sends
Charging Data Request [Stop] and the AS CDR is closed.
##### 5.2.2.1.15 Malicious Communication Identification (MCID)
Figure 5.2.2.1.15.1 shows the Diameter transactions that are required between
AS implementing the MCID service and CDF for a successful MCID delivery for
permanent mode or temporary mode.
Figure 5.2.2.1.15.1: Message sequence chart for offline charging of MCID
service
A communication is requested towards User B, and User B is subscribed to MCID
service.
1\. SIP INVITE request incoming for User B. Based on the Initial Filter
Criteria (IFC) rules, indicating that User B is subscribed to the MCID
supplementary services, the communication is forwarded to an AS implementing
MCID.
2-4. In case of MCID temporary mode, AS stores relevant data temporarily, in
case permanent mode AS registers the data and sends Accounting-Request [Event]
to record invocation of MCID, acknowledged by the CDF when AS CDR is
created.Then SIP INVITE is forwarded to User B.
5\. SIP 200 OK answer received from User B.
6\. Further SIP signalling for communication establishment, or mid-
communication take place, before SIP BYE from User-B.
7-10. Upon reception of SIP re-INVITE from User-B, indicating temporary MCID
request, AS registers the data previously stored and sends Charging Data
Request[Event/interim] message to CDF to record invocation of MCID, the CDF
creates/updates AS CDR and returns Charging Data Response.
##### 5.2.2.1.16 Customized Alerting Tone (CAT)
Although CAT Supplementary services may be delivered according to different
models (CAT forking, CAT early session, CAT Gateway) as described in TS 24.182
[217], only one scenario is depicted here, and serves as a basis for CAT
charging description, as the same principle applies.
Figure 5.2.2.1.16.1 shows the Diameter transactions that are required between
AS implementing the CAT service and CDF for a successful communication
establishment with CAT delivery.
Figure 5.2.2.1.16.1: Message sequence chart for offline charging of CAT
service delivery
A communication is requested towards User B, user B has subscribed to CAT
service.
1\. SIP INVITE request incoming for User B. Based on the Initial Filter
Criteria (IFC) rules, indicating that User B is subscribed to the CAT
supplementary service, the communication is forwarded to an AS implementing
CAT.
2\. The AS proceeds to CAT resources reservation and forwards SIP INVITE
towards User B..
3\. 180 ringing is sent back from User B.
4\. The AS sends a reliable 183 (session progress) response to User A with
codecs to be used for CAT., acknowledged by PRACK from User A.
5 to 7. Upon acknowledgment from User A (SIP PRACK), the AS starts CAT media
playing (alerting tone), and sends SIP 200 OK response to SIP PRACK towards
User A.
8 to 11. Upon SIP 200 OK answer received from User B, AS stops CAT media
playing (alerting tone), and sends a Charging Data Request [Start/Event]
message to CDF, CDF opens/creates an AS CDR and returns Charging Data
Response.
NOTE: The same following principle applies for all others CAT delivery
scenarii:\ a Charging Data Request [Start] is sent from AS to record beginning
of alerting tone playing, and Charging Data Request[Stop] is sent to record
end of alerting tone playing.
##### 5.2.2.1.17 Closed User Group (CUG)
###### 5.2.2.1.17.1 Closed User Group (CUG): Originating
Figure 5.2.2.1.17.1.1 shows the Diameter transactions that are required
between AS implementing the CUG service and CDF for a successful originating
communication from User-A CUG member.
Figure 5.2.2.1.17.1.1: Message sequence chart for offline charging of CUG
service - originating call
User-A is subscribed to CUG service. and initiates a communication towards
User B.
1\. User-A initiates a communication towards User B sending SIP INVITE
request. Based on the Initial Filter Criteria (IFC) rules, indicating that
User A is subscribed to the CUG supplementary service, the communication is
forwarded to an AS implementing CUG.
2\. AS performs checks from the request received regarding User A CUG
subscription profile, and determines the CUG-communication is allowed for CUG
member User-A towards User-B : AS forwards SIP INVITE towards User-B with CUG
information included.
NOTE: In case the result from AS checks indicates non-CUG communication
behaviour (for CUG communication with outgoing access...), CUG information is
not included, and non-CUG communication charging applies.
3\. SIP signalling for communication establishment.
4-6. SIP 200 OK answer received from User B, and AS sends Charging Data
Request [Start/Event] message to CDF to record start of the CUG-communication
for User A CUG member. The CDF opens/creates an AS CDR and returns Charging
Data Response
###### 5.2.2.1.17.2 Closed User Group (CUG): Terminating
Figure 5.2.2.1.17.2.1 shows the Diameter transactions that are required
between AS implementing the CUG service and CDF for a successful terminating
communication towards User-B CUG member.
Figure 5.2.2.1.17.2.1: Message sequence chart for offline charging of CUG
service - terminating call
User-B is subscribed to CUG service.
1\. incoming SIP INVITE request towards User-B. Based on the Initial Filter
Criteria (IFC) rules, indicating that User B is subscribed to the CUG
supplementary services, the communication is forwarded to an AS implementing
CUG.
2\. AS performs checks from the request received regarding User B CUG
subscription profile, and determines the CUG-communication is allowed for CUG
member User-B from User A: AS forwards SIP INVITE towards User-B.
NOTE: In case the result from AS checks indicates non-CUG communication
behaviour (incoming access from non-CUG member...), non-CUG communication
charging applies.
3\. SIP signalling for communication establishment.
4-6. SIP 200 OK answer received from User B, and AS sends Charging Data
Request [Start/Event] message to CDF to record start of the CUG-communication
for User B CUG member. The CDF opens/creates an AS CDR and returns Charging
Data Response.
##### 5.2.2.1.18 Personal Network Management (PNM)
Figure 5.2.2.1.18.1 shows the Diameter transactions that are required between
AS implementing the PNM service and CDF for a successful \"PN UE redirection\"
for a terminating communication, as described in TS 23.259 [218].
.
Figure 5.2.2.1.18.1: Message sequence chart for offline charging of \"PNM-
redirection\" service
1\. Incoming SIP INVITE request for UE-1 of User B. Based on the Initial
Filter Criteria (IFC) rules, for UE-1, the communication is forwarded to the
AS implementing PNM. From PN-user\'s PN configuration, the PNM AS determines
the initial request is to be redirected to the default UE of the PN, i.e. to
the UE-2.
2\. SIP INVITE is forwarded towards UE-2.
3\. Based on the Initial Filter Criteria (IFC) rules, for UE-2, the
communication is forwarded to the AS implementing PNM.
4\. From PN-user\'s PN configuration, the PNM AS determines the initial
request is to be sent to the default UE of the PN, i.e. to the UE-2. SIP
INVITE is forwarded towards UE-2.
5\. The destination UE-2 party answers and a final response is received.
6\. Upon reception of the final response, the AS implementing the PNM service
sends Charging Data Request [Start] to record \"PN UE redirection\" execution
to CDF.
7\. The CDF acknowledges the reception of the data and opens/creates an AS
CDR.
##### 5.2.2.1.19 Customized Ringing Signal (CRS)
Although CRS Supplementary services may be delivered according to different
models (download and play model, DTMF...) as described in TS 24.183 [219],
only one scenario is depicted here, and serves as a basis for CRS charging
description, as the same principle applies.
Figure 5.2.2.1.19.1 shows the Diameter transactions that are required between
AS implementing the CRS service and CDF for a successful communication
establishment with CRS delivery.
**Figure 5.2.2.1.19.1: Message sequence chart for offline charging of \"CRS\"
service delivery**
A communication is requested towards User B, user B has subscribed to CRS
service.
1\. SIP INVITE request incoming for User B. Based on the Initial Filter
Criteria (IFC) rules, indicating that User B is subscribed to the CRS
supplementary service, the communication is forwarded to an AS implementing
CRS. The INVITE is forwarded towards User B.
2\. SIP 180 ringing is sent back from User B.
3 to 4. Upon acknowledgment from User A (SIP PRACK), the AS reserves CRS
media, and forwards PRACK towards User B.
5-6. Upon SIP 200 OK(SIP PRACK acknowledgment) from User B, the AS starts CRS
media playing, and forwards SIP 200 OK towards User A.
7-10. Upon SIP 200 OK answer received from User B, the AS stops CRS media
playing, and sends Charging Data Request [Start/Event] message to CDF, CDF
opens/creates an AS CDR and returns Charging Data Response. The AS forwards
SIP 200 OK towards User A.
NOTE: The same following principle applies for all others CRS delivery
scenarii:\ a Charging Data Request [Start/Event] is sent from AS to record CRS
service delivery.
##### 5.2.2.1.20 Advice of Charge (AoC)
The information flows showing the transactions between AS implementing the AoC
service and CDF for AoC-S, AoC-D and AoC-E are described in TS 32.280 [69].
### 5.2.3 GTP\' record transfer flows
As in IMS offline charging, GTP\' is not used between CDF and CGF for MMTel
offline charging, because CDF and CGF are combined into CCF (see clause 4.2).
NOTE: Vendors may nevertheless implement a separate CDF and CGF for MMTel
offline charging.\ In this case, it is recommended that the approach chosen
conforms to the principles and protocol applications specified in TS 32.295
[54].
### 5.2.4 B~I~ CDR file transfer
For further details on the Bi protocol application refer to TS 32.297 [52].
## 5.3 MMTel online charging scenarios
### 5.3.1 Basic principles
Online charging of MMTel services is done according to the general principles
of Diameter Credit-Control Applications (Debit / Reserve Units Response) as
specified in TS 32.299 [50].
The CTFs implementing the MMTel online charging functionality may apply:
\- Immediate Event Charging (IEC) with Debit Units Request [Event] generated,
or
\- Event Charging with Unit Reservation (ECUR), or Session Charging with Unit
Reservation (SCUR), both with Reserve Units Request [Initial or Termination]
generated.
The circumstances on which IEC, ECUR or SCUR are applied, depend on the MMTel
supplementary service and/or operator\'s policy. Further details are specified
in clause 5.3.2.
### 5.3.2 Diameter message flows
#### 5.3.2.0 Diameter message flows
The flows described in the present document specify the charging
communications between the different CTF entities and the charging functions
for different online charging scenarios. The SIP messages and Diameter
transactions associated with these online charging scenarios are shown
primarily for general information and to illustrate the charging triggers.
They are not intended to be exhaustive of all the SIP message flows discussed
in TS 24.228 [221] and they depend on the Diameter Debit / Reserve Units
Request triggers configured by the operator.
Each MMTel supplementary service is described by specific flows illustrating
the dedicated trigger(s) for this MMTel supplementary service.
Following message flows are defined in TS 32.260 [20], and can be re-used for
charging the basic multimedia telephony capabilities:
\- Successful Session Establishment;
\- Successful Session Establishment with Early Media Negotiation;
\- Mid-Session Procedures;
\- Session Release.
For OCS-provided announcement service during online charging session from the
AS providing MMTel service for Session charging with Unit Reservation (SCUR),
the message flows defined in TS 32.281 [41] apply.
#### 5.3.2.1 Message flows - Successful cases and scenarios
##### 5.3.2.1.0 Interaction with IMS-GWF
As an MMTel principle, when online charging has to be applied for an MMTel
supplementary service, and the trigger list includes IMS-GWF together with
MMTel AS (implementing the MMTel supplementary service), filter criteria
should be configured to have the MMTel AS triggered before IMS-GWF, in order
to prevent improper charging.
Figure 5.3.2.1.0.1 shows the Diameter transactions that are required between
MMTel AS, IMS-GWF and OCS, when online charging is applied for MMTel
supplementary service.
Figure 5.3.2.1.0.1: Message sequence chart for online charging -- IMS-GWF,
MMTel AS and OCS
1\. User-A initiates a session by sending SIP INVITE request. Based on the
Initial Filter Criteria (IFC) rules, indicating that User A is subscribed to
the MMTel supplementary service X, the communication is forwarded to an AS
implementing this service.
2-3. As \"online charging\" is activated for User A, the AS sends a Reserve
Units Request [Initial, service X, ICID] to the OCS for requesting units for
the X supplementary service. The OCS grants units in the Reserve Units
Response response for this request.\ The AS forwards SIP INVITE via the
S-CSCF.
4\. As \"online charging\" is activated for User A, IMS-GWF is triggered by
the S-CSCF, and IMS-GWF sends a Reserve Units Request [Initial, ICID] to the
OCS for requesting units for the session identified by ICID.
5-6. The OCS detects this request is within a session for which there is
already an ongoing online Credit-Control Diameter session (same ICID). Based
on operator policy the OCS can use either Credit_Control_not_applicable to
supersede online charging in S-CSCF or grant appropriate service units (GSU).
##### 5.3.2.1.1 Communications Diversion (CDIV)
###### 5.3.2.1.1.1 Communications Diversion (CDIV) -- successful establishment
Figure 5.3.2.1.1.1.1 shows the Diameter transactions that are required between
AS implementing the CDIV service and OCS, when online charging is applied to a
successful CFU communication.
Figure 5.3.2.1.1.1.1: Message sequence chart for online charging of CDIV
service - establishment
A communication is requested towards User B: CFU and online-based charging
activated for user B.
1\. SIP INVITE request incoming for User B. Based on the iFC, indicating that
User B is subscribed to the CDIV supplementary service, the communication is
forwarded to AS implementing CDIV, where CFU is detected.
2\. As the subscriber is \"online charging\", the AS sends a Reserve Units
Request [Initial, service CDIV, ICID..] to the OCS for requesting units for
the CDIV (CFU) supplementary service.
3\. The OCS grants units in the Reserve Units Response response for this
request.
4\. The CDIV (CFU) can now be delivered: a SIP INVITE is sent towards user C
via the S-CSCF. Any potential announcements to be played to the served party,
provided by the OCS within the Reserve Units Response [Initial] , shall be
discarded due to CDIV.
5-6. On answer from User-C (SIP 200 OK), the AS sends a Reserve Units Request
[Update, USU] with possible already used units and requests new units to
continue.
7\. New units are granted via Reserve Units Response and the SIP 200 OK is
propagated. Any potential announcements to be played to the served party,
provided by the OCS within the Reserve Units Response, shall be discarded due
to CDIV.
###### 5.3.2.1.1.2 Communications Diversion (CDIV) -- release
Figure 5.3.2.1.1.2.1 shows the Diameter transactions occurring on release of
the previous established communication, initiated by user C:
Figure 5.3.2.1.1.2.1: Message sequence chart for offline charging of CDIV
service -release
1\. User C initiates release of the communication.
2\. At session termination the AS implementing the CDIV service, sends a Debit
Units Request [Terminate, used service units] for ending Credit-Control.
##### 5.3.2.1.2 Flexible Alerting (FA)
Figure 5.3.2.1.2.1 shows the Diameter transactions that are required between
AS implementing the FA service and OCS, when online charging is applied to a
successful FA communication.
Figure 5.3.2.1.2.1: Message sequence chart for online charging of FA service
UE-B and UE-C are FA group members of the FA group identified by the \"Pilot
Identity\".
A communication is requested from UE-A towards the \"Pilot Identity\".
1\. SIP INVITE request incoming for \"Pilot Identity\". Based on the Initial
Filter Criteria (IFC), indicating the request must be forwarded to an AS
implementing FA for this \"Pilot Identity\".
2\. As \"online charging\" is activated for the \"Pilot Identity\", the AS
implementing FA has to initiate parallel SIP INVITE towards each of FA group
members.
3\. For FA member User B, the AS sends a Reserve Units Request [Initial,
service FA, ICID-B] to the OCS for requesting units for the FA supplementary
service.
4\. The OCS grants units in the Reserve Units Response response for this
request.
5\. SIP INVITE is sent towards User B via the S-CSCF.
6\. Alerting phase signalling occurs with UE-A.
7\. A parallel (from step 3 to step 6) scenario occurs towards User-C with
session identified by ICID-C.
8-9. Upon reception of the SIP 200 OK answer from UE-C, AS sends SIP CANCEL to
other FA group member being alerted (UE-B).
10\. More signalling for SIP CANCEL transactions.
11-13. When the last SIP CANCEL transaction is terminated, AS sends a Reserve
Units Request [Update, USU] with possible already used units, and requests new
units to continue the communication between User A and User C.
14\. New units are granted via Reserve Units Response.
15\. SIP 200 OK is propagated towards User A.
During AS FA supplementary service execution and interaction with OCS,
announcements to be played to the served party may be provided by the OCS
within Reserve Units Responses [Initial/Update]. Announcement procedures
handling by the AS are those specified in TS 32.281 [41].
##### 5.3.2.1.3 Closed User Group (CUG)
###### 5.3.2.1.3.1 Closed User Group (CUG): Originating
Figure 5.3.2.1.3.1.1 shows the Diameter transactions that are required between
AS implementing the CUG service and OCS, when online charging is applied to a
successful originating communication from User-A CUG member.
Figure 5.3.2.1.3.1.1: Message sequence chart for online charging of CUG
service - originating call
User-A is subscribed to CUG service, and initiates a communication towards
User B.
1\. User-A initiates a communication towards User B sending SIP INVITE
request. Based on the Initial Filter Criteria (IFC) rules, indicating that
User A is subscribed to the CUG supplementary service, the communication is
forwarded to an AS implementing CUG.
2\. AS performs checks from the request received regarding User A CUG
subscription profile, and determines the CUG-communication is allowed for CUG
member User-A towards User-B.
3-4. As \"online charging\" is activated for User A, the AS sends a Reserve
Units Request [Initial, service CUG, ICID] to the OCS for requesting units for
the CUG supplementary service. The OCS grants units in the Reserve Units
Response response for this request.\ The AS forwards SIP INVITE via the S-CSCF
towards User-B with CUG information included.
NOTE: In case the result from AS checks indicates non-CUG communication
behaviour (for CUG communication with outgoing access...), non-CUG
communication charging applies, and CUG information is not included in the
forwarded SIP INVITE.
5\. SIP signalling for communication establishment.
6-8. SIP 200 OK answer received from User B, and AS sends a Reserve Units
Request [Update, USU] with possible already used units, and requests new units
to continue the CUG communication between User A and User B. New units are
granted via Reserve Units Response, and SIP 200 OK is propagated towards User
A.
During AS CUG supplementary service execution and interaction with OCS,
announcements to be played to the served party may be provided by the OCS
within Reserve Units Responses [Initial/Update]. Announcement procedures
handling by the AS are those specified in TS 32.281 [41].
###### 5.3.2.1.3.2 Closed User Group (CUG): Terminating
Figure 5.3.2.1.3.2.1 shows the Diameter transactions that are required between
AS implementing the CUG service and OCS, when online charging is applied to a
successful terminating communication towards User-B CUG member.
Figure 5.3.2.1.3.2.1: Message sequence chart for online charging of CUG
service - terminating call
User-B is subscribed to CUG service.
1\. Incoming SIP INVITE request with CUG information towards User-B.Based on
the Initial Filter Criteria (IFC) rules, indicating that User B is subscribed
to the CUG supplementary services, the communication is forwarded to an AS
implementing CUG.
2\. AS performs checks from the request received regarding User B CUG
subscription profile, and determines the CUG-communication is allowed for CUG
member User-B from User A.
3-4. As \"online charging\" is activated for User B, the AS sends a Reserve
Units Request [Initial, service CUG, ICID] to the OCS for requesting units for
the CUG supplementary service.The OCS grants units in the Reserve Units
Response response for this request. The AS forwards SIP INVITE via the S-CSCF
towards User-B.
NOTE: In case the result from AS checks indicates non-CUG communication
behaviour (incoming access from non-CUG member...), non-CUG communication
charging applies.
5\. SIP signalling for communication establishment.
6-8. SIP 200 OK answer received from User B, and AS sends a Reserve Units
Request [Update, USU] with possible already used units, and requests new units
to continue the CUG communication between User B and User A. New units are
granted via Reserve Units Response, and SIP 200 OK is propagated towards User
A.
During AS CUG supplementary service execution and interaction with OCS,
announcements to be played to the served party may be provided by the OCS
within Reserve Units Responses [Initial/Update]. Announcement procedures
handling by the AS are those specified in TS 32.281 [41].
##### 5.3.2.1.4 Conference (CONF)
###### 5.3.2.1.4.0 Introduction
Figure 5.3.2.1.4.1.1 to figure 5.3.2.1.4.5.1 show the Diameter transactions
that are required between AS implementing the CONF service and OCS, when
online charging is applied to different conference scenarios.
For CONF service, two different set of scenarios are provided for illustrating
the situation where ECUR or SCUR apply, depending on operator\'s policy.
###### 5.3.2.1.4.1 CONF -- user creating a conference - ECUR mode
Figure 5.3.2.1.4.1.1: Message sequence chart for online charging of CONF
service- User creating a conference - ECUR mode
1\. User-A initiates a conference by sending an SIP INVITE request to S-CSCF.
Based on the Initial Filter Criteria (IFC) rules, indicating that User A is
subscribed to the CONF supplementary service, the communication is forwarded
to an AS implementing CONF.
2\. The CONF AS allocates the conference resource.
3-4. As \"online charging\" is activated, the AS sends a Reserve Units Request
[Initial, service CONF, creation] to the OCS for requesting units for the CONF
supplementary service creation.\ The OCS grants units in the Reserve Units
Response response for this request.
5\. Media resource negociation process.
6-7. The AS (CONF) sends a SIP 200 OK response replied by SIP ACK from UE-A.
8-9. On successful service delivery, AS (CONF) sends Reserve Units Request
[Terminate, USU] for ending Credit-Control, with granted units used for CONF
creation.
###### 5.3.2.1.4.2 CONF -- user creating a conference - SCUR mode
Figure 5.3.2.1.4.2.1: Message sequence chart for online charging of CONF
service- User creating a conference - SCUR mode
1\. User-A initiates a conference by sending an SIP INVITE request to S-CSCF.
Based on the Initial Filter Criteria (IFC) rules, indicating that User A is
subscribed to the CONF supplementary service, the communication is forwarded
to an AS implementing CONF.
2\. The CONF AS allocates the conference resource.
3-4. As \"online charging\" is activated, the AS sends a Reserve Units Request
[Initial, service CONF, creation] to the OCS for requesting units for the CONF
supplementary service creation.\ The OCS grants units in the Reserve Units
Response response for this request.
5\. Media resource negociation process.
6-7. The AS (CONF) sends a SIP 200 OK response replied by ACK from UE-A.
8-9. As CONF charging is based on duration or other CONF parameters, from
start of the service on step 7), new units are subsequently requested by
sending Reserve Units Request [Update, USU]with already used units, for
continuing the service when new CONF parameters or values are provided.
During AS CONF supplementary service execution and interaction with OCS,
announcements to be played to the served party may be provided by the OCS
within Reserve Units Responses [Initial/Update]. Announcement procedures
handling by the AS are those specified in TS 32.281 [41].
###### 5.3.2.1.4.3 CONF -- user joining a conference (SCUR mode)
Figure 5.3.2.1.4.3.1: Message sequence chart for online charging of CONF
service- User joining a conference - SCUR mode
1\. The conference has already been created by User A. User-B sends an SIP
INVITE request to S-CSCF in order to join in the conference identified by the
conference URI. The communication is forwarded to AS addressed by conference
URI.
2\. Media resource negociation process for adding UE-B to the conference.
3-4. The AS (CONF) sends a SIP 200 OK response replied by SIP ACK from UE-B.
5-6. This step applies for SCUR mode, when \"Nb of participants\" is needed
for the \"online charging\" running for this conference: the AS (CONF) sends a
Reserve Units Request [Update, USU]) with possible already used units, for
requesting new units with new number of participants. The OCS grants units in
the Reserve Units Response response for this request.
The OCS may provide announcements to be played to the served party UE-A within
Reserve Units Response [Update]. Announcement procedures handling by the AS
are those specified in TS 32.281 [41].
##### 5.3.2.1.4.4 CONF -- user inviting another user to a conference (SCUR
mode) {#conf-user-inviting-another-user-to-a-conference-scur-mode .H6}
Figure 5.3.2.1.4.4.1: Message sequence chart for online charging of CONF
service - user inviting another user to a conference -- SCUR mode
1\. The conference has already been created by User A. User A sends aSIP REFER
request to S-CSCF with the conference URI in order to invite User B into the
conference. The communication is forwarded to the AS addressed by conference
URI.
2-4. Sequence between UE-A and AS (CONF) to proceed the SIP REFER (accept, SIP
NOTIFY...).
5\. User B is invited to the Conference by SIP INVITE from AS (CONF).
6\. Media resource negociation process for adding UE-B to the conference.
7-8. UE-B sends SIP 200 OK response when he joins the conf, replied by ACK
from AS (CONF).
9-10. This step applies for SCUR mode, when \"Nb of participants\" is needed
for the \"online charging\" running for this conference: the AS (CONF) sends a
Reserve Units Request [Update, USU] with possible already used units, for
requesting new units with new number of participants. The OCS grants units in
the Reserve Units Response response for this request.
The OCS may provide announcements to be played to the served party UE-A within
Reserve Units Response [Update]. Announcement procedures handling by the AS
are those specified in TS 32.281 [41].
##### 5.3.2.1.4.5 CONF -- user leaving a conference (SCUR mode) {#conf-user-
leaving-a-conference-scur-mode .H6}
Figure 5.3.2.1.4.5.1: Message sequence chart for online charging of CONF
service - user leaving a conference SCUR mode
1\. The conference has already been created. User B sends a SIP BYE request
request to the AS (CONF) in order to quit the conference.The communication is
forwarded to the AS addressed by conference URI.
2-3. This step applies for SCUR mode:
\- In case \"Nb of participants\" is needed for the \"online charging\"
running for this conference, and UE-B leaving does not cause conference
termination: the AS (CONF) sends a Reserve Units Request [Update, USU] with
possible already used units, for requesting new units with new number of
participants. The OCS grants units in the Reserve Units Response response for
this request.
\- In case UE-B leaving does cause conference termination, the AS(CONF) sends
a Reserve Units Request [Terminate, USU] with used units, for ending Credit-
Control.
4\. The AS (CONF) sends back SIP 200 OK response to UE-B.
5-6. The AS (CONF) sends a SIP NOTIFY request to UE-B for unsubscribe UE-B to
conf event package, replied by SIP 200 OK from UE-B.
7\. This step does not apply if conference has terminated:\ Other conference
participants are Notified UE-B has quit the conference.
###### 5.3.2.1.4.6 CONF (3PTY) -- successful establishment
Figure 5.3.2.1.4.6.1 shows the Diameter transactions that are required between
AS implementing the CONF (3PTY) service and OCS, when online charging is
applied to a successful 3PTY conference scenario.
Figure 5.3.2.1.4.6.1: Message sequence chart for online charging of CONF
(3PTY) service - establishment
1\. UE-A and UE-B have established communication. UE-A puts UE-B on
hold.Before invoking the 3-Way Calling UE-A establishes a communication with
UE-C.
2\. UE-A sends an SIP INVITE request to the AS (CONF) to establish a 3PTY
session.
3-4. As \"online charging\" is activated, the AS (CONF) sends a Reserve Units
Request [Initial, service CONF (3PTY)] to the OCS for requesting units for the
service.The OCS grants units in the Reserve Units Response response for this
request.
5-6. The AS (CONF) sends a SIP 200 OK response replied by SIP ACK from UE-A.
7\. UE-A sends a SIP REFER request to UE-B with the Refer-To header set to the
address of the AS (CONF).
8\. Sequence for 3PTY establishment:
\- SIP REFER sequence (accept, SIP NOTIFY...) between UE-B and UE-A.
\- SIP INVITE from UE-B sequence for joining
\- Original communication UE-A UE-B sequence termination
\- SIP REFER sequence (accept, SIP NOTIFY...) between UE-A and UE-C.
9-11. SIP INVITE from UE-C sequence for joining the CONF (3PTY)
12-13. In case ECUR mode applies to CONF (3PTY) Charging, on SIP ACK receipt,
AS (CONF) sends Reserve Units Request [Terminate, USU] for ending Credit-
Control, with granted units used for 3PTYcreation.\ \ In case SCUR mode
applies to CONF (3PTY) charging (charging to be based on duration or other
parameters), from ACK receipt, new units are subsequently requested by sending
Reserve Units Request [Update, USU] with already used units, for continuing
the service when new CONF parameters or values have are provided.
14\. Original communication UE-A UE-C sequence termination, occuring at any
time from step 11.
During AS CONF (3PTY) supplementary service execution and interaction with
OCS, announcements to be played to the served party may be provided by the OCS
within Reserve Units Responses [Initial/Update]. Announcement procedures
handling by the AS are those specified in TS 32.281 [41].
##### 5.3.2.1.5 Explicit Communication transfer (ECT)
###### 5.3.2.1.5.0 Introduction
Figure 5.3.2.1.5.1.1 and figure 5.3.2.1.5.1.2 show the Diameter transactions
that are required between ASimplementing the ECT service and OCS, when online
charging is applied to a successful Blind Transfert from User A to User C,
initiated by User B.
For diagram simplification, only one OCS is shown.
###### 5.3.2.1.5.1 Explicit Communication transfer (ECT): Blind Transfer with
sending SIP REFER
Figure 5.3.2.1.5.1.1: Message sequence chart for online charging of ECT
service establishment -- Blind Transfer (part 1)
Figure 5.3.2.1.5.1.2: Message sequence chart for online charging of ECT
service establishment -- Blind Transfer (part 2)
In this scenario User A is the transferee, User B is the transferor, and User
C is the transfer target.
User A and User B are in an established communication, User B puts User A on
Hold.
1\. User B sends SIP REFER request in the existing A-B dialog, to initiate
transfer User A to User C. Based on the iFC, indicating that User B is
subscribed to the ECT supplementary service, the communication is forwarded to
AS implementing ECT.
2-3. As \"online charging\" is activated, the AS sends a Reserve Units Request
[Initial, service ECT] to the OCS for requesting units for the ECT
supplementary service. The OCS grants units in the Reserve Units Response
response for this request. The AS generates an \"ECT Session Identifier\"
replacing User C as the new destination information and forwards SIP REFER
towards User A. Any potential announcements to be played to the transferor,
provided by the OCS within the Reserve Units Response [Initial], and
subsequent Reserve Units Responses [Update], shall be discarded due to ECT.
4-5. As \"online charging\" is activated for User A, the AS sends a Reserve
Units Request [Initial, service ECT] to the OCS for requesting units for the
ECT supplementary service for the transferee. The OCS grants units in the
Reserve Units Response response for this request. The AS forwards SIP REFER
towards User-A. Any potential announcements to be played to the transferee,
provided by the OCS within the Reserve Units Response [Initial], shall be
discarded due to ECT.
6\. More signalling between (User A, x-CSCF, AS-A) and (x-CSCF, AS-B,User B)
for SIP REFER acceptation sequence and terminating previous media between User
A and User B.
7\. User A initiates a new session by sending an SIP INVITE request with \"ECT
Session Identifier\".
8-9. AS implementing the ECT service for the transferee correlates this SIP
INVITE to the transfer being processed, and new units are requested by sending
Reserve Units Request [Update, USU] with already used units, for continuing
the service. The AS forwards SIP INVITE request. Any potential announcements
to be played to the transferee may be provided by the OCS within Reserve Units
Responses [Update]. Announcement procedures handling by the AS are those
specified in TS 32.281 [41].
10-11. AS implementing the ECT service for the transferor correlates this SIP
INVITE to the initial session to be transferred and new units are requested by
sending Reserve Units Request [Update, USU] with already used units, for
continuing the service, prior to forwarding SIP INVITE towards UE-C.
12\. The destination User C party answers, and a final response is received.
13-14. On transfer execution, the AS sends a Reserve Units Request [Update,
USU] with possible already used units and requests new units for transferor to
continue.
15-16. On transfer execution, the AS sends a Reserve Units Request [Update,
USU] with possible already used units and requests new units for transferee to
continue.
NOTE 1: For \"Consultative Transfer\" scenario, the same steps apply for
interactions with OCS for transferee and transferor: Reserve Units Request
[Initial] on SIP REFER initiating, intermediate Reserve Units Request [Update]
for more units on SIP INVITE for new session, and Reserve Units Request
[Update] for more units on transfer execution when User C answers.
NOTE 2: For \"Assured Transfer\" scenario, the same steps apply for
interactions with OCS for transferee and transferor: Reserve Units Request
[Initial] on SIP REFER initiating, intermediate Reserve Units Request [Update]
for more units on SIP INVITE for new session, and Reserve Units Request
[Update] for more units on transfer execution when User C answers.Besides,
Reserve Units Request [Terminate] on transferring timeout or failure, and
Reserve Units Request [Update] for more units on original dialog retrievemet.
###### 5.3.2.1.5.2 Explicit Communication transfer (ECT): Blind Transfer with
3PCC
Figure 5.3.2.1.5.2.1: Message sequence chart for online charging of ECT
service establishment -- Blind Transfer with 3PCC
In this scenario User A is the transferee, User B is the transferor, and User
C is the transfer target, and the User B\'s AS acts as a 3PCC (Third Party
Call Control) initiating B2BUA:
User A and User B are in an established communication, User B puts User A on
Hold.
1\. User B sends SIP REFER request in the existing A-B dialog, to initiate
transfer User A to User C. Based on the iFC, indicating that User B is
subscribed to the ECT supplementary service, the communication is forwarded to
AS implementing ECT in a 3PCC mode.
2-3. As \"online charging\" is activated, the AS sends a Reserve Units Request
[Initial, service ECT] to the OCS for requesting units for the ECT
supplementary service. The OCS grants units in the Reserve Units Response
response for this request. Any potential announcements to be played to the
transferor, provided by the OCS within the Reserve Units Response [Initial],
and subsequent Reserve Units Responses [Update], shall be discarded due to
ECT.
4-5. AS B performs the SIP REFER procedure with User B, and sends SIP INVITE
towards User C.
6-8. On Provisionnal response from User C, the AS sends a Reserve Units
Request [Update, USU] with possible already used units and requests new units
for transferor to continue.
9\. AS B sends SIP Re-INVITE towards User A on existing dialog. From User A
side, the basic SIP RE-INVITE procedure applies (ECT service not invoked).
10-13. On SIP 200 OK response from User A, the AS sends a Reserve Units
Request [Update, USU] with possible already used units and requests new units
for transferor to continue, and sends ACK back to User A.
14-16. On SIP 200 OK response from User C, the AS sends a Reserve Units
Request [Update, USU] with possible already used units and requests new units
for transferred communication to continue.
###### 5.3.2.1.5.3 Explicit Communication transfer (ECT): Release
Figure 5.3.2.1.5.3.1 shows the Diameter transactions that are required between
ASs implementing the ECT service for the transferor and for the transferee,
and OCS: release from User A, after a successful Blind Transfer from User A to
User C, initiated by User B.
Figure 5.3.2.1.5.3.1: Message sequence chart for offline charging of ECT
service -- release
1\. User A initiates release of the communication.
2-3. At session termination the AS implementing the ECT service for the
transferee, sends a Reserve Units Request [Terminate, USU] with used units,
for ending Credit-Control.
4-5. At session termination the AS implementing the ECT service for the
transferor, sends a Reserve Units Request [Terminate, USU] with used units,
for ending Credit-Control.
NOTE: For \"Blind Transfer with 3PCC\" release scenario, only interactions
between AS-B and OCS apply for ECT service.
#### 5\. 3.2.2 Message flows - error cases and scenarios
Error cases and scenarios for SIP related procedures and Diameter related
procedures used for MMTel service and Supplementary services charging are
defined in TS 32.260 [20].
# 6 Definition of charging information
## 6.1 Data description for MMTel offline charging
### 6.1.1 Rf message contents
#### 6.1.1.0 Introduction
For offline charging, the different service CTFs supporting MMtel specific
service charging generate accounting information transferred to the CDF using
the Diameter accounting application, as described in TS 32.299 [50].
The _Charging Data Request_ and _Charging Data Response_ are used _for this
MMTel service offline charging, as described in TS 32.260 [20]._
This clause describes the different fields used in the Charging Data messages
and the category in the tables are used according to the charging data
configuration defined in clause 5.4 of TS 32.240 [1].
#### 6.1.1.1 Charging Data Request message description
The generic _Charging Data Request message described in TS 32.260_ [20] _used
for MMTel offline charging is_ enhanced with specific MMTel service
information.
Table 6.1.1.1.1 illustrates the overall _Charging Data Request_ message as
used for MMTel offline charging.
Table 6.1.1.1.1: Charging Data Request message contents
* * *
Information Element Category Description See _Charging Data-Request_ message
fields described in TS 32.260 [20]  
Service Information O~M~ This field holds the MMTel specific parameter and is
described in clause 6.3.
* * *
NOTE: Detailed descriptions of the fields are provided in TS 32.299 [50].
#### 6.1.1.2 Charging Data Response message description
The generic _Charging Data Response message described in TS 32.260_ [20] _is
used for MMTel offline charging._
### 6.1.2 GTP\' message contents
Not applicable. Refer to sclause 5.2.3 for further information.
### 6.1.3 CDR description on the Bi interface
#### 6.1.3.1 CDR field type
The MMTel CDR content and format description is based on _TS 32.260_ [20] AS-
CDR description, enhanced with specific MMTel service information.
The content of MMTel CDR type is defined in the table in clause 6.1.3.3. The
field definition includes the field name, category and description. The
category in the tables are used according to the charging data configuration
defined in clause 5.4 of TS 32.240 [1]. The detailed field descriptions are
provided in TS 32.298 [51].
The CDF provides the CDRs at the Bi interface in the format and encoding
described in TS 32.298 [51]. Additional CDR formats and contents may be
available at the interface to the billing system to meet the requirements of
the billing system, these are outside of the scope of standardization.
#### 6.1.3.2 CDR triggers
Accounting information for MMTel services charging is transferred from the
CTFs supporting MMtel service charging to the CDF, using Charging Data Request
start, interim stop or Event messages, depending on MMTel service behaviour
(detailed in clause 5.2.2). Within the CDF, the CDRs triggering follows the
same principle as described for SIP sessions in _TS 32.260_ [20]_: MMTel CDR
is opened upon_ reception of a Charging Data Request [start] message, closed
_upon_ reception of a Charging Data Request [stop] message, updated _upon_
reception of a Charging Data Request [Interim], and created _upon_ reception
of a Charging Data Request [event].
#### 6.1.3.3 MMTel-AS CDR content
The MMTel CDR content and format description is based on _TS 32.260_ [20] AS-
CDR description, enhanced with specific MMTel information.
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.3.1 : Charging data of MMTel CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | See Charging Data of AS | | | | CDR described in TS 32.260 | | | | [20]. | | | +----------------------------+----------+----------------------------+ | MMTel information | O~C~ | This field includes a list | | | | of MMTel supplementary | | | | services which may occur | | | | within the same AS. | | | | | | | | The MMTel supplementary | | | | services related | | | | informations are described | | | | in clause 6.3.1.2. | +----------------------------+----------+----------------------------+
## 6.2 Data description for MMTel online charging
### 6.2.1 Ro message contents
#### 6.2.1.0 Introduction
For online charging, the different service CTFs supporting MMTel specific
service charging, generate debit and reserve units information transferred to
the OCF. For this purpose, MMTel online charging utilises the _Debit Units_
and _Reserve Units_ procedure specified in the Debit / Reserve Units operation
in TS 32.299 [50].
The _Debit / Reserve Units Request_ and _Debit / Reserve Units Response_
messages are used _for this MMTel service online charging, as described in TS
32.260 [20] and t_ he category in the tables are used according to the
charging data configuration defined in clause 5.4 of TS 32.240 [1]_._
#### 6.2.1.1 Debit / Reserve Units Request message
The generic _Debit / Reserve Units Request_ _message described in TS 32.260_
[20]_, used for MMTel online charging is_ enhanced with specific MMTel service
information.
Table 6.2.1.1.1 illustrates the overall _Debit / Reserve Units Request_
message as used for MMTel online charging.
Table 6.2.1.1.1: Debit / Reserve Units Request message contents
* * *
Information Element Category Description See _Debit / Reserve Units Request_
message fields described in TS 32.260 [20]_._  
Service Information O~M~ This field holds the MMTel specific parameter and is
described in clause 6.3.
* * *
NOTE: Detailed descriptions of the fields are provided in TS 32.299 [50].
#### 6.2.1.2 Debit / Reserve Units Response message
The generic _Debit / Reserve Units Response_ _message described in TS 32.260_
[20] _is used for MMTel online charging._
## 6.3 MMTel charging specific parameters
### 6.3.1 Definition of MMTel charging information
#### 6.3.1.0 Introduction
The MMTel Information parameter used for MMTel charging is provided in the
Service Information parameter.
#### 6.3.1.1 MMTel charging information assignment for Service Information
The components in the Service Information that are use for MMTel charging can
be found in table 6.3.1.1.1.
Table 6.3.1.1.1: Service Information used for MMTel charging
* * *
Information Element Category Description
Service Information OM A set of fields hold the 3GPP specific parameter\ as
defined in TS 32.299 [50].
Subscription Id OM Used as defined in TS 32.260 [20].
IMS Information OC The details are defined in TS 32.260 [20].
PS Information O~C~ The details are defined in TS 32.260 [20].
MMTel Information OM This field holds a set of MMTel services with theirs
specific parameters.\ The details are defined in clause 6.3.1.2.
* * *
#### 6.3.1.2 Definition of the MMTel Information
MMTel specific charging information is provided within the MMTel Information,
and the detailed structure of the MMTel Information can be found in table
6.3.1.2.1
Table 6.3.1.2.1 : Structure of the MMTel Information
+----------------------------+----------+----------------------------+ | Information Element | Category | Description | +----------------------------+----------+----------------------------+ | Supplementary Service | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one supplementary service. | | | | It can be present multiple | | | | times as necessary to | | | | present the parallel | | | | activity of the different | | | | supplementary services. | +----------------------------+----------+----------------------------+ | > Service Type | O~M~ | This field holds the type | | | | of the Supplementary | | | | Service, i.e. OIP, OIR, | | | | TIP, TIR, CW, HOLD, CB, | | | | MWI, CONF, CDIV, ECT, FA, | | | | MCID, CAT, CUG, PNM, CRS, | | | | AoC. | +----------------------------+----------+----------------------------+ | > Service Mode | O~C~ | This field holds the mode | | | | of specific Service Type, | | | | i.e. for CB: ACR, ICB, OC, | | | | Bfor CDIV: CFU, CFB, CFNR, | | | | CFNRc, CFNL, CFUDB and for | | | | CONF: 3PTY, AoC-S, AoC-D, | | | | AoC-E. | +----------------------------+----------+----------------------------+ | > Number of diversions | O~C~ | This field holds the | | | | number of diversions for | | | | CDIV. | +----------------------------+----------+----------------------------+ | > Associated party address | O~C~ | This field holds | | | | additional party | | | | identification needed for | | | | the service charging, i.e. | | | | for CDIV the \"forwarding | | | | party\", for ECT the | | | | \"transferor\", for FA the | | | | \"Pilot Identity\", for | | | | 3PTY the \"Initiator | | | | party\". | +----------------------------+----------+----------------------------+ | > Service id | O~C~ | This field holds the | | | | conference ID for CONF | | | | supplementary service | +----------------------------+----------+----------------------------+ | > Change Time | O~C~ | This field holds the time | | | | of the requested action | | | | indicated in the | | | | \"Participant Action | | | | Type\" during the CONF | | | | supplementary service. It | | | | provides the time stamps | | | | for the CONF supplementary | | | | service parameters | | | | reporting. | | | | | | | | When the action is set to | | | | \"CREATE\", this field | | | | indicates the start time | | | | of the CONF supplementary | | | | service. | | | | | | | | When the action is set to | | | | \"QUIT\" and Number Of | | | | Participants holds the | | | | value \"0\", this field | | | | indicates the end time of | | | | the CONF supplementary | | | | service. | +----------------------------+----------+----------------------------+ | > Number Of Participants | O~C~ | This field holds the | | | | number of parties who are | | | | currently attached to the | | | | Conference at the time | | | | stamped indicated in the | | | | \"Change Time\", for the | | | | CONF supplementary | | | | service. | +----------------------------+----------+----------------------------+ | > Participant Action Type | O~C~ | This field holds the | | | | participant action type | | | | for CONF supplementary | | | | service (CREATE_CONF, | | | | JOIN_CONF, INVITE_CONF, | | | | QUIT_CONF) at the time | | | | stamped indicated in the | | | | \"Change Time\". | +----------------------------+----------+----------------------------+ | > CUG Information | O~C~ | This field holds the CUG | | | | information conveyed by | | | | the Network and identifies | | | | the CUG-communication : it | | | | is the \"CUG Interlock | | | | Code\" . | +----------------------------+----------+----------------------------+ | > AoC information | O~C~ | This field holds the AoC | | | | related Charging | | | | information conveyed to | | | | CDF, as defined in TS | | | | 32.280 [69 | | | | | | | | Since AoC information may | | | | be sent more than once | | | | (e.g for AoC-S), this | | | | field may be multiple. | +----------------------------+----------+----------------------------+
#### 6.3.1.3 Support of MMTel Information in MMTel offline charging
In table 6.3.1.3.1, the supported Operation Types for Service Type field
within the MMTel Information on the Rf interface are presented. The other
MMTel Information fields are not detailed.
The supported Operation Types for Service Information fields, used in the
Charging Data Request and Charging Data Response messages for MMTel charging,
other than MMTel Information fields, are described in TS 32.260 [20].
Operation Types for Service Type, encompasses the various situations, where
the basic MMTel service Charging Data Request messages are sent from:
\- a separate entity (another AS or S-CSCF), than the AS implementing the
supplementary service;
\- the same AS.
Each service may be reported through a dedicated Charging Data Request Message
or combined Charging Data Request Messages (regrouped supplementary services
or with basic MMTel service).
Table 6.3.1.3.1: Supported values for Service Type in MMTel Information
+-------------------------------------------------------+---------+ | Information Element | | +-------------------------------------------------------+---------+ | Node Type | AS | +-------------------------------------------------------+---------+ | Supported Operation Types | S/I/S/E | +-------------------------------------------------------+---------+ | | | +-------------------------------------------------------+---------+ | > Service Type | | +-------------------------------------------------------+---------+ | OIP (see note 1) | SISE | +-------------------------------------------------------+---------+ | OIR | SISE | +-------------------------------------------------------+---------+ | TIP | SISE | +-------------------------------------------------------+---------+ | TIR (see note 2) | SISE | +-------------------------------------------------------+---------+ | CW | SISE | +-------------------------------------------------------+---------+ | HOLD (see note 3) | SISE | +-------------------------------------------------------+---------+ | CB (see note 2) | ---E | +-------------------------------------------------------+---------+ | MWI | ---E | +-------------------------------------------------------+---------+ | CAT | SISE | +-------------------------------------------------------+---------+ | CCBS | SISE | +-------------------------------------------------------+---------+ | CCNR | SISE | +-------------------------------------------------------+---------+ | CONF | SISE | +-------------------------------------------------------+---------+ | CDIV | SISE | +-------------------------------------------------------+---------+ | ECT | SISE | +-------------------------------------------------------+---------+ | FA | SISE | +-------------------------------------------------------+---------+ | MCID | SISE | +-------------------------------------------------------+---------+ | CUG | SISE | +-------------------------------------------------------+---------+ | PNM | SISE | +-------------------------------------------------------+---------+ | CRS | SISE | +-------------------------------------------------------+---------+ | AoC | SISE | +-------------------------------------------------------+---------+ | NOTE 1: Only present at terminating side. | | | | | | NOTE 2: Terminating side service. | | | | | | NOTE 3: AS may be involved for announcement purposes. | | +-------------------------------------------------------+---------+
#### 6.3.1.4 Support of MMTel Information in MMTel online charging
In table 6.3.1.4.1 the basic structure of the supported fields within the
MMTel Information in the Debit and Reserve Units Request for IMS online
charging on the Ro interface are presented. The Operation types are listed in
the following order: I (initial)/U (update)/T (terminate)/E (event).
Therefore, when all Operation types are possible it is marked as IUTE. If only
some Operation types are allowed for a node, only the appropriate letters are
used (i.e. IUT or E) as indicated in the table heading. The omission of an
Operation type for a particular field is marked with \"-\" (i.e. IU-E). Also,
when an entire filed is not allowed in a node the entire cell is marked as
\"-\".
Table 6.3.1.4.1: Supported values in Debit / Reserve Units Request message
MMTel Information
+------------------------------------------+---------+ | Information Element | | +------------------------------------------+---------+ | Node Type | AS | +------------------------------------------+---------+ | Supported Operation Types | I/U/T/E | +------------------------------------------+---------+ | | | +------------------------------------------+---------+ | > Service Type | | +------------------------------------------+---------+ | OIP (see note) | - | +------------------------------------------+---------+ | OIR (see note) | - | +------------------------------------------+---------+ | TIP (see note) | - | +------------------------------------------+---------+ | TIR (see note) | - | +------------------------------------------+---------+ | CW (see note) | - | +------------------------------------------+---------+ | HOLD (see note) | - | +------------------------------------------+---------+ | CB (see note) | - | +------------------------------------------+---------+ | MWI (see note) | - | +------------------------------------------+---------+ | CAT (see note) | - | +------------------------------------------+---------+ | CCBS (see note) | - | +------------------------------------------+---------+ | CCNR (see note) | - | +------------------------------------------+---------+ | CONF | IUTE | +------------------------------------------+---------+ | CDIV | IUT- | +------------------------------------------+---------+ | ECT | IUT- | +------------------------------------------+---------+ | MCID (see note) | - | +------------------------------------------+---------+ | PNM (see note) | - | +------------------------------------------+---------+ | FA | IUT- | +------------------------------------------+---------+ | CUG | IUT- | +------------------------------------------+---------+ | CRS (see note) | - | +------------------------------------------+---------+ | AoC (see note) | - | +------------------------------------------+---------+ | NOTE: Only reported in offline charging. | | +------------------------------------------+---------+
###### ## Annex A (informative): Bibliography
This Annex is a placeholder for documents which are not explicitly cited in
this specification.
#