# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides the stage 3 specification of the Nu reference
point. The functional requirements and the stage 2 specifications of the Nu
reference point are specified in 3GPP TS 23.682 [2]. The Nu reference point
lies between the Packet Flow Description Function (PFDF) and the Service
Capability Exposure Function (SCEF).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
with packet data networks and applications\".
[3] 3GPP TS 23.203: \"Policy and charging control architecture\".
[4] 3GPP TS 29.213: \"Policy and Charging Control signalling flows and QoS
parameter mapping\".
[5] 3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network
layer security\".
[6] IETF RFC 2818: \"HTTP Over TLS\".
[7] IETF RFC 793: \"Transmission Control Protocol\".
[8] Void.
[9] 3GPP TS 29.251: \"**Gw and Gwn reference points for sponsored data
connectivity** \".
[10] IETF RFC 3986: \"Uniform Resource Identifier (URI): Generic Syntax\".
[11] IETF RFC 7159: \"The JavaScript Object Notation (JSON) Data Interchange
Format\".
[12] IETF draft-newton-json-content-rules-09: \"A Language for Rules
Describing JSON Content\".
NOTE: This individual draft will not further progress in IETF. It is available
from the following link: https://www.ietf.org/archive/id/draft-newton-json-
content-rules-09.txt.
[13] IETF RFC 7230: \"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax
and Routing\".
[14] IETF RFC 7231: \"Hypertext Transfer Protocol (HTTP/1.1): Semantics and
Content\".
[15] IETF RFC 7232: \"Hypertext Transfer Protocol (HTTP/1.1): Conditional
Requests\".
[16] IETF RFC 7233: \"Hypertext Transfer Protocol (HTTP/1.1): Range
Requests\".
[17] IETF RFC 7234: \"Hypertext Transfer Protocol (HTTP/1.1): Caching\".
[18] IETF RFC 7235: \"Hypertext Transfer Protocol (HTTP/1.1):
Authentication\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**Packet Flow Description (PFD):** A set of information enabling the detection
of application traffic provided by a 3^rd^ party service provider (from 3GPP
TS 23.203 [3]).
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in 3GPP
TR 21.905 [1].
JSON JavaScript Object Notation
PCEF Policy and Charging Enforcement Function
PFD Packet Flow Description
PFDF Packet Flow Description Function
SCEF Service Capability Exposure Function
TDF Traffic Detection Function
# 4 Nu reference point
## 4.1 Overview
The Nu reference point is located between the Packet Flow Description Function
(PFDF) and the Service Capability Exposure Function (SCEF). The Nu reference
point is used for provisioning of PFDs from the SCEF to the PFDF and reporting
the result of the PFD Management from the PFDF to the SCEF.
The stage 2 level requirements for the Nu reference point are defined in 3GPP
TS 23.682 [2].
## 4.2 Nu reference model
The Nu reference point is defined between the SCEF and the PFDF. The
relationships between the different functional entities involved are depicted
in figure 4.2.1. The overall PCC architecture is depicted in subclause 3a of
3GPP TS 29.213 [4].
Figure 4.2.1: Nu reference model
## 4.3 Functional elements
### 4.3.1 PFDF
The PFDF (Packet Flow Description Function) is a functional element which
receives and manages the PFDs associated to application identifier (s) from
the SCEF via the Nu reference point.
The PFDF provisions PFDs for the corresponding application identifier (s) to
the PCEF/TDF as defined in 3GPP TS 23.203 [3] and 3GPP TS 29.251 [9].
### 4.3.2 SCEF
The SCEF (Service Capability Exposure Function) is a functional element which
provides means to securely expose the services and capabilities provided by
the 3GPP network interfaces.
The SCEF shall support the management of PFDs provided by the 3^rd^ party
SCS/AS. The SCEF may provision the PFDs to the PFDF via the Nu reference
point.
## 4.4 Procedures over Nu reference point
### 4.4.1 Management of PFD
The PFDs associated with application identifier (s) may be created, updated or
removed in the PFDF by the third party SCS/AS via the SCEF as defined in 3GPP
TS 23.682 [2].
If the SCEF receives one or more sets of PFDs for external application
identifier (s) provisioned by the third party SCS/AS, which is authorized to
perform the management of PFDs based on operator policies, the SCEF shall:
\- If the external application identifier(s) is different from the application
identifier(s) known at the PFDF, translate the external application
identifier(s) to the application identifier(s) known at the PFDF; and
\- may check if the allowed delay satisfies the required SLA against the
minimum allowed delay as defined in 3GPP TS 23.682 [2]; and
\- send an HTTP POST message to the PFDF including the provisioned PFD changes
for the the application identifier (s) within the body of the HTTP POST as
described in subclause 5.3.5.2.
NOTE 1: It is up to operator configuration whether to use different external
application identifiers that require a mapping to application identifiers
known at the PFDF. The external application identifier can be the same as the
application identifier known at the PFDF.
Upon receipt of the HTTP request for the provisioning operation from the SCEF,
the PFDF shall perform the following steps:
\- If an allowed delay is received for an application identifier, for Pull
mode as defined in 3GPP TS 29.251 [9], the PFDF shall compare the allowed
delay with the configured caching time which is:
\- a caching time value configured for that application identifier; or
\- the default caching time value if no caching time value is configured for
that application identifier.
\- Then if the PFDF cannot ensure the PCEF/TDF will pull the PFDs in time
(i.e. allowed delay is shorter than the caching time), the PFDF shall within
the HTTP response send a failure reason and that caching time value used in
the comparison and may still store (create/update/remove) the PFDs for this
application identifier.
NOTE 2: In the Combination mode as defined in 3GPP TS 29.251 [9], the PFDF can
check the received allowed delay against the caching time but will always
store (create/update/remove) the PFDs.
\- In the Pull mode as defined in 3GPP TS 29.251 [9], for the application
identifier(s) without the need to send failure reason; or in the Push or
Combination mode as defined in 3GPP TS 29.251 [9], for received application
identifier(s), the PFDF shall:
\- delete all the PFD(s) for the application identifier(s) where the removal-
flag is also provided and set to true;
\- update the existing PFD(s) if a new PFD(s) with the same PFD identifier(s)
is received , add new PFD(s) if the new PFD(s) with a new PFD identifier(s) is
received, and/or delete an existing PFD(s) if the same PFD identifier(s)
without any content is received, where the partial-flag is also provided and
set to true;
\- remove existing PFD(s) (if available) and install the new PFD(s) for the
corresponding PFD identifier(s) whereno flag is provided;
\- acknowledge the HTTP POST message by sending a corresponding HTTP response
with the appropriate status code as defined in subclause 5.3.2. If the POST
operation was successful for at least one application identifier, the PFDF
shall respond with an HTTP 200 OK status code.
# 5 Nu protocol
## 5.1 Introduction
The following layers of the protocol stack for the Nu reference point between
the SCEF and the PFDF are described in subclauses:
\- IETF RFC 793 [7] provides the communication service at the transport layer.
\- An optional communication security layer can be added between the transport
and the application delivery layer (see subclause 6).
\- The application delivery layer provides the transport of the specific
application communication data using IETF RFC 7230 [13], IETF RFC 7231 [14],
IETF RFC 7232 [15], IETF RFC 7233 [16], IETF RFC 7234 [17] and IETF RFC 7235
[18].
> \- The specific application communication layer constitutes the transport of
> the JSON content type.
Figure 5.1.1 illustrates the protocol stack of the RESTful Nu reference point.
> Figure 5.1.1: Protocol stack of the RESTful Nu reference point
## 5.2 Transport layer
HTTP is layered over TCP, which provides a reliable transport.
For provisioning of PFDs from the SCEF to the PFDF, the SCEF acts as an HTTP
client and the PFDF acts as an HTTP server. As a result, the SCEF shall
initiate a TCP connection with the PFDF.
## 5.3 Application delivery layer
### 5.3.1 General
The application delivery layer shall use RESTful HTTP.
The application delivery layer provides provisioning of the PFDs by the SCEF.
If the SCEF needs to provision PFDs for a set of application identifier(s)
(creation/update/deletion) to the PFDF, the SCEF shall send an HTTP POST
message.
### 5.3.2 HTTP status codes
The HTTP status codes for the REST-based Nu interface are specified in the
IETF RFC 7231 [14].
### 5.3.3 Methods
Methods indicate to the server what action has to be performed. Every HTTP
request message has a method.
The HTTP POST method is used by the SCEF to provision PFDs for a set of
application identifiers. The request URI defines the address responsible for
the management of the PFDs provisioning as a controller resource.Every HTTP
request results in a response message that comes back with a status code and
further information in its body, if required. The HTTP request initiator waits
for this response before initiating a further request.
### 5.3.4 Resources and URI design
The URI design shall be based on the structure defined in IETF RFC 3986 [10]:
scheme \":\" hier-part [ \"?\" query ] [ \"#\" fragment ]\ hier-part = \"//\"
authority path-abempty\ / path-absolute\ / path-rootless\ / path-empty
The scheme may be HTTP or HTTPS for the Nu interface. Within a scheme the
definition of names shall follow the rules of HTTP URIs. Host and port are the
main parts of the authority. The path element identifies the resources.
For the Nu interface, the following required parts of the URI shall be used as
follows:
scheme: The application delivery layer protocol \"http\" or \"https\".
authority: It includes the server address and optionally a port as follows:
host [\":\" port]
path-absolute: The path-absolute should have the following ABNF: \"/\" mainapp
\"/\" mainresource. In this release:
\"mainapp" is \"nuapplication\".
\"mainresource\" is \"provisioning\".
The PFDs management (associating/disassociating PFDs with application
identifiers) in PFDF is a controller resource that is responsible for
processing requests that provisioning a set of changes for more than one set
of PFDs for corresponding application identifiers atomically.
An example of the URI to identify the controller resource is
http://pfdfserver.example.com/nuapplication/provisioning.
NOTE: A different path can be used when the Resource URI is preconfigured in
the SCEF.
### 5.3.5 HTTP request/response formats
#### 5.3.5.1 General
The PFDs provisioning procedure is performed through HTTP transactions
consisting of a request initiated by the SCEF and answered by the PFDF.
Table 5.3.5.1-1 summarizes the content of the requests and responses. More
detailed information is specified in the corresponding subclauses as indicated
in the table.
Table 5.3.5.1-1: Nu requests/response summary table
+----------+----------+----------+----------+----------+----------+ | Method | Resource | Clause | Request | I | Response | | | URI's | Defined | body | nitiator | body | | | path | | | | | +----------+----------+----------+----------+----------+----------+ | POST | /nu | 5.3.5.2 | Conte | SCEF | Su | | | applicat | | nt-Type: | | ccessful | | | ion/prov | | applicat | | r | | | isioning | | ion/json | | esponse: | | | | | | | The PFDF | | | (NOTE 1) | | The SCEF | | may | | | | | shall | | include | | | | | include | | infor | | | | | PFDs | | mational | | | | | content | | data in | | | | | as | | the body | | | | | sociated | | of the | | | | | with | | response | | | | | app | | in | | | | | lication | | Annex A. | | | | | ident | | | | | | | ifier(s) | | | | | | | using | | | | | | | the | | | | | | | schema | | | | | | | defined | | | | | | | in | | | | | | | Annex A. | | | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | A | | | | | | | d | | | | | | | ifferent | | | | | | | path | | | | | | | from | | | | | | | /nu | | | | | | | applicat | | | | | | | ion/prov | | | | | | | isioning | | | | | | | may be | | | | | | | used | | | | | | | when it | | | | | | | is | | | | | | | co | | | | | | | nfigured | | | | | | | in the | | | | | | | SCEF. In | | | | | | | that | | | | | | | case the | | | | | | | \"path\" | | | | | | | part set | | | | | | | in the | | | | | | | d | | | | | | | ifferent | | | | | | | methods | | | | | | | should | | | | | | | use the | | | | | | | co | | | | | | | nfigured | | | | | | | one. | | | | | | +----------+----------+----------+----------+----------+----------+
#### 5.3.5.2 POST /nuapplication/provisioning
The provisioning of the PFDs shall be performed by the SCEF by using the POST
method as follows:
\- The request URI formatted as defined in subclause 5.3.4 with the \"path\"
part set to: /nuapplication/provisioning.
\- The Content-Type header field set to \"application/json\"
\- The body of the message encoded in JSON format as defined in Annex A. The
body shall include
\- for the PFD(s) creation for a new application identifier, a new application
identifier and its full list of PFD(s) to be created;
\- for the PFD(s) full update for an existing application identifier, the
existing application identifier and its new full list of PFD(s)
\- for the PFD(s) partial update for an existing application identifier, the
existing application identifier, partial update indication and
\- new PFD(s) with new PFD identifier(s) to add new PFD(s),
\- new PFD(s) with existing PFD identifier(s) to update existing PFD(s),
and/or
\- the existing PFD identifier(s) without any content to remove the existing
PFD(s);
\- for the PFD(s) removal for an existing application identifier, the existing
application identifier and the removal indication.
Upon receipt of the HTTP POST request, the PFDF shall respond to the SCEF
indicating whether the provisioning was successful or not using one of the
HTTP status codes as defined in subclause 5.3.2. If the provisioning was
accepted, the PFDF shall respond with an HTTP 200 OK status code if no
resource is created, or an HTTP 201 Created status code if one or more
resources are created. If the allowed delay is too short according to the
criteria in subclause 4.4.1, the PFDF shall respond with an HTTP 200 OK status
code and additional information in the body of the response indicating failure
reason \"too short allowed delay\" and the value of caching time as defined in
Annex A. If the provisioning was rejected, the PFDF shall indicate the reason
using an appropriate HTTP status code as defined in subclause 5.3.2 and
optionally additional information in the body of the response as defined in
Annex A.
Below is an example of an HTTP POST and a corresponding successful response:
POST /nuapplication/provisioning HTTP/1.1
Host: pfdfserver.example.com
Content-Type: application/json
Content-Length: ...
[
{
\"application-identifier\":\"test-application-1\",
\"removal-flag\":true
},
{
\"application-identifier\":\"test-application-2\",
\"allowed-delay\":600,
\"pfds\":[
{
\"pfd-identifier\":\"pfd1\",
\"flow-descriptions\":[
\"permit in ip from 10.68.28.39 80 to any\"
]
},
{
\"pfd-identifier\":\"pfd2\",
\"urls\":[
\"\^http://test.example.com(/\\\S*)?\$\"
]
}
]
},
{
\"application-identifier\":\"test-application-3\",
\"partial-flag\":true,
\"pfds\":[
{
\"pfd-identifier\":\"pfd3\",
\"urls\":[
\"\^http://test.example2.net(/\\\S*)?\$\"
]
},
{
\"pfd-identifier\":\"pfd4\"
}
]
}
]
Here is an example of a successful response:
HTTP/1.1 200 OK
Date: Mon, 7 May 2012 16:00:00 GMT
Server: pfdfserver.example.com
Content-Type: application/json
{
\"success-message\": \"Notification was processed successfully.\",
}
## 5.4 Specific application communication
### 5.4.1 General
Specific application communication represents the presentation of application
data structures by transforming data into the form that the application
accepts. It establishes the context between application-layer entities.
NOTE: This release only supports the content type JSON.
### 5.4.2 Content type
The body of HTTP messages shall be in JSON format. The content of the JSON
text is defined in subclause 5.4.3 and Annex A.
The MIME media type that shall be used within the Content-Type header field is
\"application/json\" as defined in IETF RFC 7159 [11].
### 5.4.3 JSON provisioning fields
#### 5.4.3.1 General
Table 5.4.3.1-1 describes the JSON provisioning fields used within the body of
the HTTP messages representing the PFDs information associated with an
application identifier. The table includes the information about the name of
the field and the type of the fields.
Table 5.4.3.1-1: Nu Provisioning JSON fields
+------------------+------------------+------------------+----------+ | | | | | +------------------+------------------+------------------+----------+ | Field Name | Clause defined | JSON Value Type | JCR Type | | | | (NOTE 1) | | | | | | (NOTE 2) | +------------------+------------------+------------------+----------+ | applic | 3GPP | string | string | | ation-identifier | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | allowed-delay | 3GPP | number | uint64 | | | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | pfds | 3GPP | array | array | | | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | pfd-identifier | 3GPP | string | string | | | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | f | 3GPP | array | array | | low-descriptions | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | urls | 3GPP | array | array | | | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | domain-names | 3GPP | array | array | | | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | removal-flag | 3GPP | boolean | boolean | | (NOTE 3) | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | partial-flag | 3GPP | boolean | boolean | | (NOTE 3) | TS 29.251 [9] | | | +------------------+------------------+------------------+----------+ | NOTE 1: The | | | | | basic JSON value | | | | | types are | | | | | defined in | | | | | IETF | | | | | RFC 7159 [11]. | | | | | | | | | | NOTE 2: The JCR | | | | | types are | | | | | defined in | | | | | IETF draft-n | | | | | ewton-json-conte | | | | | nt-rules [12]. | | | | | | | | | | NOTE 3: Only one | | | | | of the | | | | | removal-flag and | | | | | the partial-flag | | | | | for the | | | | | application | | | | | identifier shall | | | | | be set to true. | | | | +------------------+------------------+------------------+----------+
### 5.4.4 Void
### 5.4.5 JSON errors and informational response fields
#### 5.4.5.1 General
Table 5.4.4.1-1 describes the JSON fields defined for the errors and
informational responses including their types and the field names.
Table 5.4.5.1-1: JSON fields for errors and informational response
+----------------+----------------+----------------+----------------+ | | | | | +----------------+----------------+----------------+----------------+ | Field Name | Subclause | JSON Value | JCR Type (NOTE | | | defined | Type (NOTE 1) | 2) | +----------------+----------------+----------------+----------------+ | errors | 3GPP T | array | array | | | S 29.251 [9] | | | | | (NOTE 4) | | | +----------------+----------------+----------------+----------------+ | error-type | 3GPP T | string | \ | | | S 29.251 [9] | | "application\" | | | (NOTE 4) | | | | | | | \"interface\" | | | | | | | | | | \"server\" | | | | | | | | | | \"other\" | | | | | | | | | | (NOTE 3) | +----------------+----------------+----------------+----------------+ | error-message | 3GPP T | string | string | | | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | error-tag | 3GPP T | string | string | | | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | error-path | 3GPP T | string | string | | | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | error-info | 3GPP T | object | object | | | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | s | 3GPP T | string | string | | uccess-message | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | success-path | 3GPP T | string | string | | | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | success-info | 3GPP T | object | object | | | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | NOTE 1: The | | | | | basic JSON | | | | | value types | | | | | are defined in | | | | | IETF RF | | | | | C 7159 [11]. | | | | | | | | | | NOTE 2: The | | | | | JCR types are | | | | | defined in | | | | | IE | | | | | TF draft-newto | | | | | n-json-content | | | | | -rules [12]. | | | | | | | | | | NOTE 3: The | | | | | quoted strings | | | | | for a string | | | | | type. | | | | | | | | | | NOTE 4: The | | | | | error is sent | | | | | from the PFDF | | | | | to the SCEF. | | | | +----------------+----------------+----------------+----------------+
### 5.4.6 JSON report fields
#### 5.4.6.1 General
Table 5.4.6.1-1 describes the JSON fields defined for the report information
objects which are included in the error-info field.
Table 5.4.6.1-1: JSON fields for Report from the PFDF
+----------------+----------------+----------------+----------------+ | | | | | +----------------+----------------+----------------+----------------+ | Field Name | Subclause | JSON Value | JCR Type (NOTE | | | defined | Type (NOTE 1) | 2) | +----------------+----------------+----------------+----------------+ | pfd-reports | 5.4.6.2 | array | array | +----------------+----------------+----------------+----------------+ | a | 5.4.6.3 | array | array | | pplication-ids | | | | +----------------+----------------+----------------+----------------+ | pf | 3 | string | string | | d-failure-code | GPP TS 29.251 | | | | | [9] (NOTE 3) | | | +----------------+----------------+----------------+----------------+ | caching-time | 3GPP T | number | uint64 | | | S 29.251 [9] | | | +----------------+----------------+----------------+----------------+ | NOTE 1: The | | | | | basic JSON | | | | | value types | | | | | are defined in | | | | | IETF RF | | | | | C 7159 [11]. | | | | | | | | | | NOTE 2: The | | | | | JCR types are | | | | | defined in | | | | | IE | | | | | TF draft-newto | | | | | n-json-content | | | | | -rules [12]. | | | | | | | | | | NOTE 3: The | | | | | additional | | | | | failure reason | | | | | for Nu is | | | | | \"T | | | | | OO_SHORT_ALL | | | | | OWED_DELAY\". | | | | +----------------+----------------+----------------+----------------+
#### 5.4.6.2 pfd-reports
The pfd-reports field is of type array and it contains a list of pfds reports.
The pdf-reports field can be used in an HTTP response to report failures in
the installation/modification of PFDs. In this case, it shall be provided as a
sub field of the error-info field.
Multiple pfd report instances shall be provided within the pfd-reports field
if different pfd-failure-code values are applicable within the same HTTP
response.
caching-time field is included if the pfd-failure-code is set to the value
\"TOO_SHORT_ALLOWED_DELAY\".
A report instance shall contain application-ids and pfd-failure-code fields.
The JCR format for the pfd-reports is:
\$pfd-reports = \"pfd-reports\" : [
{ \$application-ids,
\$pfd-failure-code,
\$caching-time,
} +
]
#### 5.4.6.3 application-ids
The application-ids field is of type array of string, and contains one or more
application identifiers to which the PFDs belong.
## 5.5 PFDF discovery
The PFDF URI may be pre-configured on the SCEF.
The SCEF may select the PFDF by this configuration.
# 6 Secure communication
Either the NDS/IP network layer security defined in 3GPP TS 33.210 [5] or HTTP
over TLS as defined in IETF RFC 2818 [6] should be used to secure
communication over the REST based Nu interface.
###### ## Annex A (informative): JSON Schema
# A.1 Provisioning schema
This subclause defines the JSON schema for the body of HTTP request providing
the provisioned PFDs. The schema is based on IETF draft-newton-json-content-
rules [12] and is defined below:
# jcr-version 0.7
# ruleset-id 3gpp.nuapplication.provisioning
; JCR representing the PFDs provisioning data
\$provisioning-root = @{root}{
\$ application-identifier,
\$removal-flag ?,
\$partial-flag ?,
\$allowed-delay ?,
\$pfds ?
}
; An array list of the PFDs for multiple application identifiers
\$pfds-array-root = @{root} [ \$provisioning-root * ]
; The detected application traffic identifier for the PFDs
\$application-identifier = \"application-identifier\" : string
; The allowed delay time for the PFDs deployment
\$allowed-delay = \"allowed-delay\" : uint64
; The PFDs associated with the same application identifier
\$pfds = \"pfds\" : [ \$pfd * ]
; The PFD content
\$pfd = {
\$pfd-identifier,
( \$flow-descriptions \| \$urls \| \$domain-names \| // : any) ?
}
; The PFD identifier
\$pfd-identifier = \"pfd-identifier\" : string
; The flow descriptions
\$flow-descriptions = \"flow-descriptions\" : [ string + ]
; The url matching expressions
\$urls = \"urls\" : [ string + ]
; The domain name match criteria
\$domain-names = \"domain-names\" : [ string + ]
; A flag indicates whether this is a removal or not
\$removal-flag = \"removal-flag\" : boolean
; A flag indicates whether this is a partial update or not
\$partial-flag = \"partial-flag\" : boolean
# A.2 Error and Informational response schema
This subclause defines the JSON schema for the body of HTTP responses in case
of errors or success. The schema is based on IETF draft-newton-json-content-
rules [12] and is defined below:
# jcr-version 0.7
# ruleset-id 3gpp.nuapplication.info
; A JCR for the error/successful response body
; Errors information
\$errors-root = @{root} { \$errors }
; Success information
\$success-root = @{root} {
\$success-message,
\$success-path ?,
\$success-info ?
}
; Resource fields definitions
; The list of errors returned in responses sent by the PCEF/TDF
\$errors = \"errors\" : [
{
\$error-type,
\$error-message,
\$error-tag ?,
\$error-path ?,
\$error-info ?
} +
]
; The error type for an error. It can be one of \'application\',
\'interface\', \'server\' and \'other\'.
\$error-type = \"error-type\" : ( \"application\" \| \"interface\" \|
\"server\" \| \"other\" )
; The error text message
\$error-message = \"error-message\" : string
; The error tag for a specific error
\$error-tag = \"error-tag\" : string
; A JSON pointer path to the error resource
\$error-path = \"error-path\" : string
; Any additional information for the error
\$error-info = \"error-info\" : {
\$pfd-reports ?,
// : any *
}
; Report fields definitions
; The list of pfd reports sent to the SCEF
\$pfd-reports = \"pfd-reports\" : [
{
\$application-ids,
\$pfd-failure-code,
\$caching-time
} +
]
; The application identifiers for the PFDs
\$application-ids = \"application-ids\" : [string+]
; The string format for the pfd failure code
\$pfd-failure-code =: (
\"MALFUNCTION\" \|
\"RESOURCES_LIMITATION\" \|
\"TOO_SHORT_ALLOWED_DELAY\" \|
\"OTHER_REASON\"
)
; The caching time for the PFDs
\$caching-time = \"caching-time\" : uint64
; The successful text message
\$success-message = \"success-message\" : string
; A JSON pointer path to the success resource
\$success-path = \"success-path\" : string
; Any additional information for the success.
\$success-info = \"success-info\" : { // : any *}
###### ## Annex B (informative): Call Flows
# B.1 General
This annex describes the procedures for the interactions between the PFDF and
the SCEF.
# B.2 Provisioning of PFDs
This subclause describes the signalling flow for the Provisioning of PFDs.
Figure B.2.1: Provisioning of PFDs
1\. The SCEF sends the HTTP POST to the PFDF to indicate the creation,
modification or deletion of PFDs for one or more application identifier(s)
including the parameters defined in subclause 5.3.5.2.
2\. The PFDF sends the HTTP 200 OK response to the SCEF including the
parameters defined in subclause 5.3.5.2.
#