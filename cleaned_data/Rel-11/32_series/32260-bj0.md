# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document is part of a series of documents that specify charging
functionality and charging management in GSM/UMTS networks. The GSM/UMTS core
network charging architecture and principles are specified in document TS
32.240 [1], which provides an umbrella for other charging management documents
that specify:
\- the content of the CDRs per domain and subsystem (offline charging),
\- the content of real-time charging events per domain / subsystem (online
charging);
\- the functionality of online and offline charging for those domains and
subsystems;
\- the interfaces that are used in the charging framework to transfer the
charging information (i.e. CDRs or charging events)
The complete document structure for these TSs is defined in TS 32.240 [1].
The present document specifies the Offline and Online Charging description for
the IP Multimedia Subsystem (IMS), based on the functional descriptions of the
IMS in 3GPP TS 23.228 [200]. This charging description includes the offline
and online charging architecture and scenarios specific to IMS, as well as the
mapping of common 3GPP charging architecture specified in TS 32.240 [1] onto
IMS. It further specifies the structure and content of the CDRs for offline
charging, and the charging events for online charging. The present document is
related to other 3GPP charging TSs as follows:
\- The common 3GPP charging architecture is specified in TS 32.240 [1];
\- The parameters, abstract syntax and encoding rules for these CDR types are
specified in TS 32.298 [51].
\- A transaction based mechanism for the transfer of CDRs within the network
is specified in TS 32.295 [54].
\- The file based mechanism used to transfer the CDRs from the network to the
operator's billing domain (e.g. the billing system or a mediation device) is
specified in TS 32.297 [52].
\- The 3GPP Diameter application that is used for IMS offline and online
charging is specified in TS 32.299 [50].
All terms, definitions and abbreviations used in the present document, that
are common across 3GPP TSs, are defined in the 3GPP Vocabulary, TR 21.905
[100]. Those that are common across charging management in GSM/UMTS domains,
services or subsystems are provided in the umbrella document TS 32.240 [1] and
are copied into clause 3 of the present document for ease of reading. Finally,
those items that are specific to the present document are defined exclusively
in the present document.
Furthermore, requirements that govern the charging work are specified in 3GPP
TS 22.115 [101].
# 2 References
The following documents contain provisions, which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TS 32.240: \"Telecommunication management; Charging management;
Charging architecture and principles\".
[2] 3GPP TS 32.250: \"Telecommunication management; Charging management;
Circuit Switched (CS) domain charging\".
[3] - [10] Void.
[11] 3GPP TS 32.251: \"Telecommunication management; Charging management;
Packet Switched (PS) domain charging\".
[12] - [34] Void.
[35] 3GPP TS 32.275: \"Telecommunication management; Charging management;
MultiMedia Telephony (MMTel) charging\".
[36] 3GPP TS 32.280: \" Telecommunication management; Charging management;
Advice of Charge (AoC) service\".
[37] - [49] Void.
[50] 3GPP TS 32.299: \"Telecommunication management; Charging management;
Diameter charging application
[51] 3GPP TS 32.298: \"Telecommunication management; Charging management;
Charging Data Record (CDR) parameter description
[52] 3GPP TS 32.297: \"Telecommunication management; Charging management;
Charging Data Records (CDR) file format and transfer
[53] Void.
[54] 3GPP TS 32.295: \"Telecommunication management; Charging management;
Charging Data Record (CDR) transfer\".
[55]- [99] Void.
[100] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[101] 3GPP TS 22.115: \"Service aspects; Charging and billing\".
[102] Void.
[103] 3GPP TS 23.002: \"Network Architecture\".
[104] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[105]- [199] Void.
[200] 3GPP TS 22.228: \"IMS Stage 1\".
[201] 3GPP TS 23.228: \"Functional stage 2 description of IMS\".
[202] 3GPP TS 24.228: \"Signalling flows for the IP multimedia call control
based on SIP and SDP, Stage 3"
[203] 3GPP TS 23.218: \"IP Multimedia (IM) session handling; IM call model;
Stage 2\".
[204] 3GPP TS 24.229: \"Internet Protocol (IP) multimedia call control
protocol based on Session Initiation Protocol (SIP) and Session Description
Protocol (SDP); Stage 3\".
[205] 3GPP TS 29.229: \"Cx and Dx Interfaces based on the Diameter protocol;
Protocol Details\".
[206] 3GPP TS 29.658: \"SIP Transfer of IP Multimedia Service Tariff
Information\".
[207] 3GPP TS 33.203 \"3G security; Access security for IP-based services\"
[208] 3GPP TS 33.210 \"3G security; Network Domain Security (NDS); IP network
layer security\"
[209] 3GPP TS 33.310\" Network Domain Security (NDS); Authentication Framework
(AF) \"
[210] 3GPP TS 24.292: \"IP Multimedia (IM) Core Network (CN) subsystem
Centralized Services (ICS); Stage 3\".
[211] 3GPP TS 29.079: \"Optimal Media Routeing within the IP Multimedia
Subsystem;Stage 3\".
[212] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
[213] 3GPP TS 23.203: \"Policy and Charging Control architecture\".
[214] 3GPP TS 29.214: "Policy and Charging Control over Rx reference point".
[215] 3GPP TS 29.328: \"IP Multimedia (IM) Subsystem Sh Interface; Signalling
flows and message contents\".
[216]- [218] Void.
[219] 3GPP TS 23.292: \"IP Multimedia Subsystem (IMS) centralized services;
Stage 2\".
[220] - [299] Void.
[300] - [399] Void.
[400] Void.
[401] IETF RFC 3588 (2003): "Diameter Base Protocol\".
[402] IETF RFC 4006: "Diameter Credit Control Application\".
[403] IETF RFC 2806: \"**URLs for Telephone Calls** \".
[404] IETF RFC 3261: \"**SIP: Session Initiation Protocol** \".
[405] IETF RFC 2486: \"**The Network Access Identifier** \".
[406] RFC 7315 (January 2014): \"Private Header (P-Header) Extensions to the
Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project
(3GPP)\".
[407] 3GPP TS 23.237: \" IP Multimedia Subsystem (IMS) Service Continuity;
Stage 2\".
[408] 3GPP TS 24.237: \" IP Multimedia Subsystem (IMS) Service Continuity;
Stage 3\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
given in 3GPP TR 21.905 [50], 3GPP TS 32.240 [1], and the following apply:
**billing:** function whereby CDRs generated by the charging function are
transformed into bills requiring payment.
**Billing Domain:** Part of the operator network, which is outside the core
network that receives and processes charging information from the core network
charging functions. It includes functions that can provide billing mediation
and billing end applications.
**CDR field Categories:** the CDR fields are defined in the present document.
They are divided into the following categories:
**\- Mandatory:** field that shall be present in the CDR.
**\- Conditional:** field that shall be present in a CDR if certain conditions
are met.
**\- Operator Provisionable: Mandatory:** A field that operators have
provisioned to be included in the CDR for all conditions.
**\- Operator Provisionable: Conditional:** A field that operators have
provisioned to be included in the CDR if certain conditions are met.
**charged party:** user involved in a chargeable event that has to pay parts
or the whole charges of the chargeable event, or a third party paying the
charges caused by one or all users involved in the chargeable event, or a
network operator.
**charging:** function whereby information related to a chargeable event is
formatted and transferred in order to make it possible to determine usage for
which the charged party may be billed.
**Charging Data Record (CDR):** record generated by a network element for the
purpose of billing a subscriber for the provided service. It includes fields
identifying the user, the session and the network elements as well as
information on the network resources and services used to support a subscriber
session. In the traditional circuit domain, CDR has been used to denote \"Call
Detail Record\", which is subsumed by \"Charging Data Record\" hereafter.
**charging function:** entity inside the core network domain, subsystem or
service that is involved in charging for that domain, subsystem or service.
**offline charging:** charging mechanism where charging information **does
not** affect, in real-time, the service rendered
**online charging:** charging mechanism where charging information can affect,
in real-time, the service rendered and therefore a direct interaction of the
charging mechanism with session/service control is required
**partial CDR:** CDR that provides information on part of a subscriber
session. A long session may be covered by several partial CDRs. Two formats
are considered for Partial CDRs. One that contains all of the necessary
fields; the second has a reduced format.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
Bi Reference point for the CDR file transfer from the IMS CGF to the BD.
Ga Reference point for CDR transfer between a CDF and CGF.
Rf Offline Charging Reference Point between an IMS Network Entity or an AS and
CDF
Ro Online Charging Reference Point between an AS or MRFC and IMS-GWF and the
OCS
## 3.3 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ABNF Augmented Backus-Naur Form
ACA Accounting Answer
ACR Accounting Request
AS Application Server
ATCF Access Transfer Control Function
ATGW Access Transfer Gateway
AVP Attribute Value Pair
B2BUA Back-to-Back User Agent
BGCF Breakout Gateway Control Function
BS Billing System
CCA Credit Control Answer
CCF Charging Collection Function
CCR Credit Control Request
CDF Charging Data Function
CDIV Communication Diversion
CDR Charging Data Record
CGF Charging Gateway Function
CONF Conference
CPCF Content Provider Charging Function
CSCF Call Session Control Function (I-Interrogating; P-Proxy; and S-Serving)
EATF Emergency Access Transfer Function
ECF Event Charging Function
ECUR Event Charging with Unit Reservation
IBCF Interconnect Border Control Function
IEC Immediate Event Charging
IMS IP Multimedia Subsystem
IMS-AGW IMS Access Media Gateway
IMS-ALG IMS - Application Level Gateway
IMS-GWF IMS Gateway Function
IOI Inter Operator Identifier
ISC IMS Service Control
MGCF Media Gateway Control Function
MMTel MultiMedia Telephony
MRFC Media Resource Function Controller
NNI Network to Network Interface
MRFP Multimedia Resource Function Processor
NetLoc Network provided Location information
OCS Online Charging System
OMR Optimal Media Routing
RTTI Real-time Transfer of Tariff Information
SCCF Subscriber Content Charging Function
SCUR Session Charging with Unit Reservation
SDP Session Description Protocol
SIP Session Initiation Protocol
TIP Terminating Identity Presentation
TIR Terminating Identity Restriction
TRF Transit and Roaming Function
TrGW Transition GateWay
UA User Agent
UE User Equipment
VCC Voice Call Continuity
VDN VCC Domain transfer Number
# 4 Architecture Considerations
## 4.1 High level IP Multimedia Subsystem (IMS) architecture
Figure 4.1 depicts the logical IMS architecture, as described in 3GPP TS
23.002 [103]
Figure 4.1: IMS logical architecture
## 4.2 IMS offline charging architecture
The architecture for IMS offline charging is described in the following
figure. The Rf interface is described in clause 6.1.1 and Bi in clause 6.1.2.
Figure 4.2: IMS offline charging architecture
## 4.3 IMS online charging architecture
The architecture for IMS online charging is described in the following figure.
The Ro interface is described in clause 6.2 and ISC in TS 23.228 [201].
Figure 4.3: IMS online charging Architecture
# 5 Charging Principles
## 5.1 IMS Charging Principles
The IMS network elements shall maintain the integrity of all received or
created charging-related information when forwarding the information to the
offline and online charging systems, whatever the length of the value of any
particular parameter is. For example, the IMS Charging Identifier (ICID) may
be generated by one IMS network element (e.g. the P-CSCF) and forwarded to
another IMS network element (e.g. the S-CSCF). Both may generate charging
information and ensure that the data integrity is maintained, in order to make
possible correlation based on the ICID.
### 5.1.1 IMS Charging applicability
The AS and MRFC are able to distinguish whether to apply offline or online
charging, i.e. whether to send charging information over the Rf interface to
the CDF or over the Ro interface to the OCS, which includes ECF and SCF as
described in chapter 4.3 (or to use both). The decision of which interface to
use is based on the information (CDF and/or OCS address) the AS/MRFC receives
in the SIP signalling and the system configuration as provisioned by the
operator. If the AS/MRFC only receive the CDF address and do not receive an
OCS address then they use only the Rf interface. If only the OCS address was
provided then they use only the Ro interface. In cases where both CDF and OCS
addresses are provided it is possible to use both interfaces simultaneously.
However, operators may overrule the addresses received via the SIP signalling
and use their own configured rules instead. Operators may configure locally on
the AS/MRFC an OCS and/or CDF address. The choice of whether the IMS network
elements use locally configured addresses or the addresses received by SIP
signalling, and the decision on which interface(s) to use, is left for
operator configuration.
All other IMS network elements (S-CSCF, P-CSCF, I-CSCF, BGCF, IBCF, and MGCF)
apply offline charging via the Rf interface using the CDF address as received
via SIP signalling or the locally configured CDF address in the IMS network
element. The S-CSCF supports online charging using:
\- the ISC interface, i.e. if the application server addressed over ISC is the
IMS Gateway Function, or
\- the Ro interface directly instead of the ISC, if the IMS Gateway Function
is integrated within the S-CSCF.
The offline and online charging function addresses transferred in SIP
signalling are encoded in the P-Charging-Function-Addresses as defined in TS
24.229 [204] and RFC7315 [406]. The P-Charging-Function-Addresses header
contains the following parameters: CCF (i.e. CDF) and ECF (i.e. OCS).
### 5.1.2 IMS Charging Correlation
#### 5.1.2.1 Basic Principles for IMS Domain Correlation
The IMS charging correlation information is encoded in the SIP P-Charging-
Vector header as defined in the following sub clauses. The P-Charging-Vector
header contains the following parameters: ICID, access network charging
identifier and IOI.
General correlation mechanisms are defined in TS 32.240 [1], and further
details about the usage of P-Charging-Vector are defined in TS 24.229 [204],
TS 24.292 [210], and RFC 7315 [406].
The enhanced MSC server for ICS charging in this specification refers the MSC
server which performs IMS registration, as defined in TS 23.292 [219]. The
enhanced MSC server for SRVCC charging in this specification refers the MSC
server defined in TS 24.237 [408].
#### 5.1.2.2 IMS Charging Identifier (ICID)
The IMS domain correlation is based on IMS Charging Identifier (ICID) shared
between IMS network elements involved with the same session/transaction. With
ICID it is possible to correlate session/transaction related charging data
generated in different IMS elements (i.e. x-CSCFs, ASs'). The ICID is included
in all SIP methods, if the P-Charging-Vector header is present, and
transferred through originating and terminating side nodes, except to UE.
The value of the ICID parameter is identical with the \'icid-value\' parameter
defined in TS 24.229 [204]. The \'icid-value\' is a mandatory part of the
P-Charging-Vector and coded as a text-based UTF-8 charset (as are all SIP
messages). For further information regarding the composition and usage of the
P-Charging-Vector refer to [204] and RFC 7315 [406].
The ICID value is globally unique across all 3GPP IMS networks for a time
period of at least one month, implying that neither the node that generated
this ICID nor any other IMS network element reuse this value before the
uniqueness period expires. The one month minimum uniqueness period counts from
the time of release of the ICID, i.e. the ICID value no longer being used.
This can be achieved by using node specific information, e.g. high-granularity
time information and / or topology / location information. The exact method
how to achieve the uniqueness requirement is an implementation issue.
At each SIP session unrelated method, both initial and subsequent (e.g.,
REGISTER, NOTIFY, MESSAGE etc.), a new, session unrelated ICID is generated at
the first IMS network element that processes the method. This ICID value is
contained in the SIP request and response of that SIP transaction and must be
valid for the duration of the transaction.
At each SIP session establishment a new, session specific ICID is generated at
the first IMS network element that processes the session-initiating SIP INVITE
message. Enhanced MSC server will generate an ICID for ICS and SRVCC
originated calls as described in TS 24.229 [204]. This ICID is then used in
all subsequent SIP messages for that session (e.g., 200 OK, (re-)INVITE, BYE
etc.) until the session is terminated.
#### 5.1.2.2A Related ICID
During the process of SRVCC access transfer, the Enhanced MSC server or the
P-CSCF generates an ICID for the target access leg. For the purpose of
charging correlation between the source access leg and the target access leg
when the user is roaming the SCC AS and the ATCF includes the ICID used on the
source access leg as the Related ICID for the target access leg as described
in TS 24.229 [204]. This Related ICID is sent in the 1xx and 2xx responses to
the initial INVITE as described in TS 24.237 [408].
#### 5.1.2.3 Access network charging identifier
The access network charging identifier is the media flow level data shared
among the IMS network elements for one side of the session (either the
originating or terminating side). This information is used to correlate the
access network charging data with the IMS charging data. The access network is
identified by bearer specific correlation identifier, e.g. for Packet Switched
Access (GGSN address and PDP context Identifier) or Fixed Broadband Access
(Multimedia Charging Identifier). The access network charging identifier is
populated in the P-Charging-Vector using the access-network-charging-info
parameter. For further information regarding the composition and usage of the
access-network-charging-info parameter refer to TS 24.229[204] and RFC 7315
[406].
#### 5.1.2.4 Inter Operator Identifier (IOI)
The IOI identifies originating, terminating and transit networks involved in a
session/transaction. The IOI may be generated from each side of
session/transaction to identify the home networks associated with each side.
The orig-ioi and term-ioi parameters of P-Charging-Vector represent the
originating and terminating operator identifiers.
For interconnection scenarios in multi operator environments where one or more
transit operators are between the originating and terminating operator, a list
of Transit IOI values may occur additionally to identify involved transit
operators. Due to operator policy, a transit operator may also hide his
identity by adding a void value. Addition and deletion of transit IOI values
are operator configurable. For further information regarding the composition
and usage of the parameters refer to TS 24.229[204], TS 24.292 [210], and IETF
RFC 7315 [406].
NOTE: No transit networks are expected between the S-CSCF and a 3^rd^ party
application server triggered by the initial filter criteria in the S-CSCF.
#### 5.1.2.5 Void
#### 5.1.2.6 IMS visited network identifier
The IMS visited network identifier identifies the visited network involved in
a session/transaction. The IMS visited network identifier is available in the
SIP P-Visited-Network-ID header of the REGISTER and should be used for all
charging events associated with the user.
### 5.1.3 SDP handling
SDP information on SIP can have two different meanings; SDP offer or SDP
answer. This is captured in the charging information by a SDP-type parameter
that indicates if the SDP Media Component is an SDP offer or SDP answer. SDP
offers can be sent by either the calling or called party and the Media
Initiator Flag identifies who sent the first SDP offer in a SDP negotiation.
SDP can be negotiated more than once in an SIP INVITE or RE-INVITE dialog.
Each occurrence of the List of SDP Media Components in the corresponding CDRs
may include either SDP offer or SDP answer. For the first negotiation, the SDP
answer defines which media are used in the session, therefore it shall be
recorded in case of successful session setup. Additionally the corresponding
SDP offer may be recorded. In case of unsuccessful session setup the SDP offer
may be recorded, if available.
When session re-negotiations occur, multiple occurrences of List of SDP Media
Components may be used to include a series of SDP negotiations in which each
occurrence holds an SDP offer or SDP answer as for the first SDP negotiation.
### 5.1.4 Trigger conditions
This chapter contains the details for trigger conditions listed in table
5.2.1.1 for Offline Charging messages (ACR) and 5.3.1.1 for Online Charging
messages (CCR) triggered by SIP Methods or ISUP Messages for all IMS nodes
except for MRFC and AS.
The I-CSCF and BGCF, which need not be present in the signalling path for
subsequent requests after the first SIP INVITE, do not support session based
charging using ACR [Start, Interim, and Stop]. In these (and only in these)
IMS network elements, successful session set-up completion triggers ACR
[Event]. Use of session based charging when the I-CSCF or the BGCF is call
stateful is not described in this release.
The initial registration, user-initiated reregistration, and user-initiated
de-registration chargeable events relate to SIP REGISTER to trigger ACR
[Event]/CCRs, while network-initiated deregistration event relates to SIP
NOTIFY to trigger ACR [Event]/CCRs provided that subscription to registration
events has been applied (see TS 24.229 [204]).
If at the time when the SIP 200 OK is received only the SDP offer is
available, the CTF may trigger ACR [Start] immediately (subsequent SIP ACK
containing the SDP answer triggers ACR [Interim]) or may trigger ACR [Start]
once the SIP ACK has been received. The precise behaviour shall depend on
operator policy.
### 5.1.5 IMS support of real-time tariff transfer
The TS 29.658 [206] describes the Real-time Transfer of Tariff Information
(RTTI) in SIP. The RTTI may be supported for the requested service (e.g.
tariff information of a value added service residing in the called network or
in a specific Application Server).
According to the procedures described in the TS 29.658 [206], tariff
information may be included in the content body of the following SIP messages:
1xx provisional response or 200 OK at session setup, mid-dialog requests or
responses. The following IMS network elements, IBCF, MGCF, S-CSCF and AS may
pass tariff information and record the tariff information in the corresponding
CDRs for IMS offline charging. For online charging, the AS and the IMS-GWF may
send charging information related to the content body of RTTI message over Ro
interface to the OCS.
The following security mechanisms shall be used for RTTI:
\- IBCF shall accept RTTI information only from trusted IMS networks and
filter out RTTI information from non trusted IMS networks.
\- If RTTI information has to be sent over unsecure domain networks, the
security of the domains interconnection shall rely on Network Domain Security
specifications: TS 33.210 [208] and TS 33.310 [209].
\- The S-CSCF responsible for the handling of RTTI messages shall follow the
common IMS security specification TS 33.203 [207] to protect against malicious
UE that try to bypass the P-CSCF.
### 5.1.6 Served user identification
Subscriber Identifier is an Information Element used in both online and
offline charging information to identify the served user for the specific leg
of an IMS session. A list of Subscription Id(s) for IMS CDR shall contain the
Public user Id(s) for the served user.
In the case when the served user is obtained from the P-Header P-Served-User
(can be available in P-CSCF, S-CSCF and AS) then it shall also be used as
Subscription-Id in both online and offline charging.
### 5.1.7 Single Charging session from AS/ATCF acting as B2BUA
When a session-initiating SIP INVITE message is received by an AS/ATCF, this
AS/ATCF, per application logic needs, acting as a B2BUA, may decide IMS
Charging Identifier (ICID) for the outgoing dialog to be the same as received
or different.
In case the same IMS Charging Identifier (ICID) is preserved between incoming
and outgoing dialog by the AS/ATCF acting as a B2BUA, a single charging
session for both dialogs can be created by this AS/ATCF. This option, refered-
to as "OneChargingSession" in the different descriptions, is applicable per
Operator configuration.
### 5.1.8 Charging support for Roaming Architecture for Voice over IMS with
Local Breakout
The Roaming Architecture for Voice over IMS with Local Breakout is described
in the TS 23.228 [201]. The corresponding Charging principles are defined in
the TS 32.240 [1]. In the present document, charging support for the Transit
and Roaming Function (TRF) requisite for Roaming Architecture for Voice over
IMS with Local Breakout is rendered by presuming collocation or standalone.
Figure 5.1.7 shows an example for possible signalling and media flows in a
Roaming Architecture for Voice over IMS with Local Breakout.
{width="6.689583333333333in" height="4.215972222222222in"}
Figure 5.1.7: Signalling and media flows in a Roaming Architecture for Voice
over IMS with Local Breakout (Example)
### 5.1.9 Charging support for Network provided Location information
The Network provided Location information (NetLoc) is described in the TS
23.228 [201] and for emergency service request using PCC-based solutions for
the UE location in mobile networks in TS 23.167 [212]. In some scenarios, an
AS can also detect emergency service and obtain the UE location using HSS-
based solutions in TS 23.167 [212].
Based on operator policies and the availability of the user location
information and/or UE Time Zone from the access network, the solution ensures
that relevant SIP messages contain the correct or up to date information about
the user location information, and/or UE Time Zone provided by the access
network and currently used by the UE.
For the 3GPP access networks, the Pâ€‘CSCF can retrieve user location
information and/or UE Time Zone related to the access network currently used
by the UE using PCC mechanisms, as specified in TS 23.203 [213] and TS 29.214
[214] In some scenarios, an AS can also obtain location information using HSS-
based solutions in TS 29.328 [215].
For fixed networks, the P-CSCF is aware of the network provided location
information through signalling with the NASS.
As specified in TS 24.229 [204], clause 7.2A.4.3, the network provided
location information is transported in the SIP P-Access-Network-Info header
with an "np" parameter and indicates details of where the UE is currently
located (i.e., SAI, TAI, RAI, CGI, ECGI or access-specific user location
information) as defined in TS 23.228 [214].
In the defined CDRs, the network provided location information for 3GPP
accesses is directly available in the User Location Info field. For non-3GPP
accesses, the network provided location information should be available in the
Access Network Information field..
### 5.1.9a Charging support for IMS transit scenarios
The IMS transit network scenarios are described in the TS 23.228 [201] and may
require additional functionalities provided by the IMS transit functions. When
residing in a stand-alone entity, the IMS Transit Functions may apply offline
charging. Applicable fields for the IMS transit functions are in table
6.3.2.1.
### 5.1.10 Charging support for TRF
In order to support traffic for the Roaming Architecture for Voice over IMS
with Local Breakout, IMS Transit Functions are enhanced with additional
routeing functionality, both combined in a Transit and Roaming Function (TRF)
and defined in TS 23.228 [201]. Depending on the transit operator
configuration, these functions might reside in a stand-alone entity or be
collocated with an existing IMS Network Element.
When residing in a stand-alone entity, the TRF may apply offline charging.
When collocated with an existing IMS Network Element, charging information for
the TRF is combined with charging information of the corresponding IMS Network
Element. Applicable fields are in table 6.3.2.1.
## 5.2 IMS Offline Charging Principles
### 5.2.1 Basic Principles
The offline charging functionality is based on the IMS network nodes reporting
accounting information upon reception of various SIP methods or ISUP messages,
as most of the accounting relevant information is contained in these messages.
This reporting is achieved by sending Diameter _Accounting Requests_ (ACR)
[start, interim, stop and event] from the IMS network elements to the CDF.
The Diameter client uses ACR start, interim and stop in procedures related to
successful SIP sessions. It uses ACR events for unsuccessful SIP sessions and
for session unrelated procedures. Further details are specified in the tables
below and in clause 5.2.2.
It is operator configurable in the nodes for which SIP method or ISUP messages
an _Accounting Request_ is sent. Table 5.2.1.1 describes all possible ACRs
that might be sent from a Pâ€‘CSCF, Iâ€‘CSCF, S-CSCF, IBCF, MGCF or BGCF. A list
of node specific ACRs, along with the AVPs to be included are detailed in TS
32.299 [50].
The ACRs to be sent from a MRFC are described in table 5.2.1.2.
It is configurable for the operators to enable or disable the generation of an
ACR message by the IMS node in response to a particular \"triggering SIP
method /ISUP message\".
Table 5.2.1.1: Accounting Request messages triggered by SIP Methods or ISUP
Messages\ for all IMS nodes except for MRFC and AS
* * *
Diameter message Triggering SIP Method /ISUP message
ACR [Start] SIP 2xx acknowledging an initial SIP INVITE
                     SIP ACK acknowledging an initial SIP INVITE
                     ISUP:ANM (applicable for the MGCF)
ACR [Interim] SIP 2xx acknowledging a SIP\ RE-INVITE or SIP UPDATE [e.g.
change in media components]
                     SIP ACK acknowledging an initial SIP INVITE orÂ a SIP RE-INVITE
                     Expiration of AVP \[Acct-Interim-Interval\]
                     SIP 1xx provisional response, mid-dialog requests, mid-dialog responses and SIP INFO embedding RTTI XML body (applicable for the S-CSCF and IBCF).
                     ISUP charging ASE (applicable for the MGCF).
                     SIP Response (4xx, 5xx or 6xx), indicating an unsuccessful SIP RE-INVITE or SIP UPDATE
ACR [Stop] SIP BYE message (both normal and abnormal session termination
cases)
                     ISUP:REL (applicable for the MGCF)
ACR [Event] SIP 2xx acknowledging non-session related SIP messages, which are:
                     SIP NOTIFY
                     SIP MESSAGE
                     SIP REGISTER
                     SIP SUBSCRIBE
                     SIP PUBLISH
                     SIP REFER
                     SIP 2xx acknowledging an initial SIP INVITE (BGCF only)
                     SIP Final/Redirection Response 3xx
                     SIP Final Response (4xx, 5xx or 6xx), indicating an unsuccessful SIP session set-up
                     SIP Final Response (4xx, 5xx or 6xx), indicating an unsuccessful session-unrelated procedure
                     SIP CANCEL, indicating abortion of a SIP session set-up
                     I-CSCF completing a Cx Query that was issued in response to a SIP INVITE
* * *
Table 5.2.1.2: Accounting Request messages triggered by SIP Methods for the
MRFC
+----------------------------------+----------------------------------+ | Diameter message | Triggering SIP Method | +----------------------------------+----------------------------------+ | ACR [Start] | SIP 2xx acknowledging an SIP | | | INVITE for initiating a | | | multimedia ad hoc conferencing | | | session | +----------------------------------+----------------------------------+ | ACR [Interim] | SIP ACK acknowledging a SIP | | | INVITE to connect an UE to the | | | conferencing session | +----------------------------------+----------------------------------+ | | SIP REINVITE (see Note 1) | +----------------------------------+----------------------------------+ | | SIP BYE (see Note 2) | +----------------------------------+----------------------------------+ | | Expiration of AVP | | | [Acct-Interim-Interval] | +----------------------------------+----------------------------------+ | ACR [Stop] | SIP BYE message (see Note 3) | +----------------------------------+----------------------------------+ | | SIP CANCEL (see Note 3) | +----------------------------------+----------------------------------+ | | SIP Final Response with error | | | codes 4xx, 5xx or 6xx indicating | | | termination of an ongoing | | | session (see Note 3) | +----------------------------------+----------------------------------+ | NOTE 1: This trigger only | | | applies to a user joining an | | | ongoing conferencing session | | | | | | NOTE 2: This trigger only | | | applies to a user leaving an | | | ongoing conferencing session | | | | | | NOTE 3: This trigger only | | | applies if this causes the | | | ongoing conferencing session to | | | terminate | | +----------------------------------+----------------------------------+
### 5.2.2 Diameter message flows and types
The flows described in the present document specify the charging
communications between IMS entities and the charging functions for different
charging scenarios. The SIP messages and Diameter transactions associated with
these charging scenarios are shown primarily for general information and to
illustrate the charging triggers. They are not intended to be exhaustive of
all the SIP message flows discussed in TS 24.228 [200] and they depend on the
Diameter Accounting Requests triggers configured by the operator.
#### 5.2.2.1 Message Flows - Successful Cases and Scenarios
##### 5.2.2.1.1 Session Establishment - Mobile Origination
The following figure shows the Diameter transactions that are required between
CSCF and CDF during session establishment originated by a UE.
##### Scenario 1: Successful Session Establishment {#scenario-1-successful-
session-establishment .H6}
Figure 5.2.2.1.1-1: Message Sequence Chart for Session Establishment (Mobile
Origination)
1\. The session is initiated.
2\. The destination party answers and a final response are received.
3\. Upon reception of the final response, the S-CSCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating START_RECORD to record
start of a user session and start of a media component in the S-CSCF CDR.
4\. The CDF acknowledges the reception of the data and opens an S-CSCF CDR.
5\. Same as 3, but for P-CSCF.
6\. Same as 4, but creating a P-CSCF CDR.
##### Scenario 2: Successful Session Establishment with late SDP Answer (SIP
200 OK triggering ACR) {#scenario-2-successful-session-establishment-with-
late-sdp-answer-sip-200-ok-triggering-acr .H6}
The following figure shows the Diameter transactions that are required between
CSCF and CDF during session establishment originated by a UE.
Figure 5.2.2.1.1-2: Message Sequence Chart for Session Establishment\ (SIP 200
OK triggering ACR) - Mobile Origination
1\. The session is initiated.
2\. The destination party answers and a response are received.
3\. Upon reception of the SIP 200 OK, the S-CSCF sends an _Accounting-Request_
with\ _Accounting-Record-Type_ indicating START_RECORD to record start of a
user session and start of a media component in the S-CSCF CDR.
4\. The CDF acknowledges the reception of the data and opens an S-CSCF CDR.
5\. Same as 3, but for P-CSCF.
6\. Same as 4, but creating a P-CSCF CDR.
7\. - 11. These steps are identical to steps 3. -7. of scenario 2 described in
clause 5.2.2.1.3.
##### Scenario 3: Successful Session Establishment with late SDP Answer (SIP
ACK triggering ACR) {#scenario-3-successful-session-establishment-with-late-
sdp-answer-sip-ack-triggering-acr .H6}
The following figure shows the Diameter transactions that are required between
CSCF and CDF during session establishment originated by a UE.
Figure 5.2.2.1.1-3: Message Sequence Chart for Session Establishment\ (SIP ACK
triggering ACR) - Mobile Origination
1\. The session is initiated.
2\. The destination party answers and a final response are received. If the
final response includes a SDP offer only, then the CSCF shall wait for the SIP
ACK.
3\. The SIP ACK including the SDP answer is received.
4\. Upon reception of the SIP ACK, the P-CSCF sends an _Accounting-Request_
with\ _Accounting-Record-Type_ indicating START_RECORD to record start of a
user session and start of a media component in the P-CSCF CDR.
5\. The CDF acknowledges the reception of the data and opens an P-CSCF CDR.
6\. Same as 4, but for S-CSCF.
7\. Same as 5, but creating a S-CSCF CDR.
##### 5.2.2.1.2 Session Establishment - Mobile Termination
The following figure shows the Diameter transactions that are required between
CSCF and CDF during a session establishment that is terminated to a mobile.
The I-CSCF is only involved in the INVITE transaction.
Figure 5.2.2.1.2-1: Message Sequence Chart for Session Establishment (Mobile
Termination)
1\. The session is initiated.
2\. Upon completing a Cx query the I-CSCF sends an _Accounting Request_ with
the\ _Accounting-Record-Type_ set to EVENT.
3\. The CDF acknowledges the data received and creates an I-CSCF CDR.
4\. The destination party answers and a final response are sent.
5\. - 8. These steps are identical to the corresponding steps described in
clause 5.2.2.1.1.
##### 5.2.2.1.3 Mid-Session Procedures
The following figure shows the Diameter transactions that are required between
CSCF and CDF when a UE generates a SIP (reâ€‘)iNVITE or SIP UPDATE in mid-
session, e.g. in order to modify media component(s), or when the hold and
resume procedure is executed.
##### Scenario 1: Mid-Session Procedures {#scenario-1-mid-session-procedures
.H6}
Figure 5.2.2.1.3-1: Message Sequence Chart for Media Modification
1\. Modified media information is received from the subscriber.
2\. The destination party acknowledges the media modification.
3\. At modification of a media, the S-CSCF sends _Accounting-Request_ with
_Accounting-Record-Type_ indicating INTERIM_RECORD to record modification of a
media component in the S-CSCF CDR.
4\. The CDF acknowledges the reception of the data and updates the S-CSCF CDR.
5\. Same as 3, but for P-CSCF.
6\. Same as 4, updating the P-CSCF CDR.
##### Scenario 2 : Mid-Session Procedures with Late SDP Answer (SIP ACK
triggering ACR) {#scenario-2-mid-session-procedures-with-late-sdp-answer-sip-
ack-triggering-acr .H6}
The following figure shows the Diameter transactions that are required between
CSCF and CDF when a UE generates a SIP (reâ€‘)iNVITE or SIP UPDATE in mid-
session, e.g. in order to modify media component(s), or when the hold and
resume procedure is executed.
Figure 5.2.2.1.3-2: Message Sequence Chart for Media Modification (SIP ACK
triggering ACR)
1\. The UE generates a SIP reâ€‘iNVITE or SIP UPDATE in mid-session.
2\. The destination party replies with a response including a SDP offer. If
the final response includes a SDP offer only, then the CSCF shall wait for the
SIP ACK.
3\. The SIP ACK including the SDP answer is received.
4\. At modification of a media, the P-CSCF sends _Accounting-Request_ with
_Accounting-Record-Type_ indicating INTERIM_RECORD to record modification of a
media component in the P-CSCF CDR.
5\. The CDF acknowledges the reception of the data and updates the P-CSCF CDR.
6\. Same as 4, but for S-CSCF.
7\. Same as 5, updating the S-CSCF CDR.
##### 5.2.2.1.4 Session Release - Mobile Initiated
The following figure shows the Diameter transactions that are required between
CSCF and CDF for a session release that is initiated by the UE.
Figure 5.2.2.1.4-1: Message Sequence Chart for Session Release
1\. The session is released.
2\. At session termination the P-CSCF sends _Accounting-Request_ with
_Accounting-Record-Type_ indicating STOP_RECORD to record stop of a session
and stop of a media component in the\ P-CSCF CDR.
3\. The CDF acknowledges the reception of the data and closes the P-CSCF CDR.
4\. Same as 2, but for S-CSCF.
5\. Same as 3, closing the S-CSCF CDR.
6\. The release is acknowledged.
##### 5.2.2.1.5 Session-Unrelated Procedures
The following figure shows the Diameter transactions that are required between
CSCF and CDF for session-unrelated IMS procedures, i.e. those that relate to
the Diameter ACR [event], as listed in Table 5.2.1.1.
Figure 5.2.2.1.5-1: Message Sequence Chart for Session-Unrelated Procedure
1\. The P-CSCF receives a \"SIP Request\" (e.g. SUBSCRIBE) from the
subscriber.
2\. The \"SIP Request\" is acknowledged by the \"SIP Response\" as follows:
\- in the successful case, a 200 OK message is returned;
\- in case of failure an appropriate SIP error message is returned.
Depending on the used SIP method, there might be additional signalling between
steps 1 and 2.
3\. After the completion of the procedure, the S-CSCF sends _Accounting-
Request_ with _Accounting-Record-Type_ indicating EVENT_RECORD to record
transaction specific information in the\ S-CSCF CDR.
4\. The CDF acknowledges the reception of the data and produces an S-CSCF CDR.
5\. Same as 3, but for P-CSCF.
6\. Same as 4, creating a P-CSCF CDR.
##### 5.2.2.1.6 Session Establishment - PSTN Initiated
The following figure shows the Diameter transactions that are required between
MGCF and CDF during session establishment initiated from the PSTN side.
Figure 5.2.2.1.6-1: Message Sequence Chart for Session Establishment (PSTN
Initiated)
1\. The session is originated from the PSTN.
2\. The session setup is triggered in the IMS.
3\. The destination party answers and a final response are received.
4\. MGCF forwards an answer message to the PSTN.
5\. Upon reception of the final response, the MGCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating START_RECORD to record
start of a user session and start of a media component in the MGCF CDR.
6\. The CDF acknowledges the reception of the data and opens a MGCF CDR.
##### 5.2.2.1.7 Session Establishment - IMS Initiated
The following figure shows the Diameter transactions that are required between
BGCF, MGCF and CDF during session establishment initiated from the IMS side.
Figure 5.2.2.1.7-1: Message Sequence Chart for Session Establishment (IMS
Initiated)
1\. The session is originated from the IMS.
2\. A session towards PSTN is established.
3\. The destination party answers and an answer message are received.
4\. A final response message is sent to the session originator.
5\. Upon reception of the answer message, the MGCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating START_RECORD to record
start of a user session and start of a media component in the MGCF CDR.
6\. The CDF acknowledges the reception of the data and opens a MGCF CDR.
7\. Upon reception of the 200 OK message, the BGCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating EVENT_RECORD to record
start of a user session and start of a media component in the BGCF CDR.
8\. The CDF acknowledges the reception of the data and creates a BGCF CDR.
##### 5.2.2.1.8 Session Release - PSTN initiated
The following figure shows the Diameter transactions that are required between
MGCF and CDF during a PSTN initiated session release.
Figure 5.2.2.1.8-1: Message Sequence Chart for Session Release (PSTN
initiated)
1\. The session release is initiated from PSTN.
2\. Session release continues within IMS.
3\. The reception of the release message is acknowledged.
4\. Upon reception of the release message, the MGCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating STOP_RECORD to record stop
of a session in the MGCF CDR.
5\. The CDF acknowledges the reception of the data and closes the MGCF CDR.
##### 5.2.2.1.9 Session Release - IMS Initiated
The following figure shows the Diameter transactions that are required between
MGCF and CDF during a IMS initiated session release.
Figure 5.2.2.1.9-1: Message Sequence Chart for Session Release (IMS initiated)
1\. The session release is initiated from the IMS side.
2\. A release message is sent towards PSTN.
3\. The acknowledgement of the release message is received from PSTN.
4\. Upon reception of the BYE message the MGCF sends an _Accounting Request_
with _Accounting Record Type_ indicating STOP_RECORD to record stop of a
session in the MGCF CDR.
5\. The CDF acknowledges the reception of the data and closes the MGCF CDR.
##### 5.2.2.1.10 Multi-Party Call
The following figure shows the establishment of an ad hoc conference
(multiparty call). An AS (acting as B2BUA) performs third party call control
with the MRFC, where the S-CSCF is in the signalling path. The Application
Server that is in control of the ad hoc conference is aware of the MRFC
capabilities. Note that only accounting information sent from the MRFC is
shown in detail in the figure. The SIP messages are for illustrative purpose
only.
Figure 5.2.2.1.10-1: Message Sequence Chart for Multi-party Call Establishment
in MRFC
1\. Sessions exist between UE-1 and UE-2, and between UE-1 and UE-3. A request
is received from UE-1for putting all parties together to a multi-party call.
2\. - 3. Request and acknowledgement to initiate multi-party call. MRFC
assigns a conference-ID that is used by the AS in subsequent interactions with
the MRFC in INVITE messages connecting other endpoints (see TS 23.228 [201]).
Path establishment between AS and MRFC for UE-2.
4\. At start of session establishment the MRFC sends an _Accounting-Request_
with _Accounting-Record-Type_ indicating START_RECORD to record start of
multi-party call in the MRFC CDR
5\. The CDF acknowledges the reception of the data and creates the MRFC CDR.
\'Calling Party Address\', \'Service Request Time Stamp\', \'Service ID\'
(holding the conference-ID) etc. are included in the MRFC CDR
6 - 7. Path establishment between UE-2 and AS. Same ICID is used as for the
path between AS and MRFC for UE-2 (step 2. - 3.).
8 Acknowledgement of path between AS and MRFC for UE-2.
9\. The MRFC may send an _Accounting-Request_ with _Accounting-Record-Type_
indicating INTERIM_RECORD to report that UE-2 has been connected to the multi-
party call.
10\. The CDF acknowledges the reception of the data and includes UE-2 in the
field \'Application Provided Called Parties\' of the MRFC CDR.
11\. Acknowledgement of path between AS and UE-2. Now a path between UE-2 and
MRFP via AS is established.
12 --13.. Request and acknowledgement to establish path between AS and MRFC
for UE-3.
14\. -15. Path establishment between UE-3 and AS. Same ICID is used as for the
path between AS and MRFC for UE-3 (step 12. - 13.).
16\. Acknowledgement of path between AS and MRFC for UE-3.
17\. The MRFC may send an _Accounting-Request_ with _Accounting-Record-Type_
indicating INTERIM_RECORD to report that UE-3 has been connected to the multi-
party call.
18\. The CDF acknowledges the reception of the data and includes UE-3 in a new
field \'Application Provided Called Parties\' of the MRFC CDR.
19\. Acknowledgement of path between AS and UE-3.
20 - 21. Request and acknowledgement to establish path between AS and MRFC for
UE-1. Same ICID is used as for the path between UE-1 and AS (step 1.).
22 - 23. Request for multi-party conference with UE-2 and UE-3 is acknowledged
to UE 1. Implicit acknowledgement of path UE-1 to AS.
24\. Acknowledgement of path between AS and MRFC for UE-1.
25\. The MRFC may send an _Accounting-Request_ with _Accounting-Record-Type_
indicating INTERIM_RECORD to report that UE-1 has been connected to the multi-
party call.
26\. The CDF acknowledges the reception of the data and includes the field
\'Service Delivery Start Time Stamp\' into the MRFC CDR.
27 --28. UE-1 acknowledges the multi-party call session establishment.
NOTE: It is in the responsibility of the AS to terminate the sessions existing
at the beginning of the multi-party call establishment between UE-1 and UE-2
and between UE-1 and UE-3 (see step 1.) in case of successful multi-party call
establishment. This is not shown in the diagram above.
##### 5.2.2.1.11 AS Related Procedures - AS Acting as a Redirect Server
Application servers may support a multitude of services which are not
specified in 3GPP standards. Therefore it is not possible to standardise
charging flows and procedures for those services. However, for all such
services, the AS may apply either event charging, where ACR [event] messages
are generated, or Session Charging, using ACR [start, stop and interim]. The
following clauses depict one example for each of the two scenarios. The first
procedure, AS acting as a redirect server, depicts the \"event\" case, while
the second procedure, AS acting as a voice mail server, depicts the
\"session\" case.
The following figure shows the case where an Application Server acts as a
redirect server. In the figure below, UE-1 sets up a session towards UE-2 but
due to Call Forwarding functionality located in the AS, a new number (to UE-3)
is returned to UE-1. Finally UE-1 sets up the session towards UE-3.
Figure 5.2.2.1.11-1: Message Sequence Chart for AS Acting as a Redirect Server
1\. Sessions initiated by UE-1 towards UE-2.
2\. - 3. Response indicating that session should be redirected towards another
number (UE-3).
4\. After successful service execution, the AS sends _Accounting-Request_
with\ _Accounting-Record-Type_ indicating EVENT_RECORD to record service
specific information in the AS CDR.
5\. The CDF acknowledges the reception of the data and creates the AS CDR.
6-7. Response indicating that session should be redirected towards another
number (UE-3).
8\. Session is initiated by UE-1 towards UE-3.
##### 5.2.2.1.12 AS Related Procedures - AS Acting as a Voice Mail Server
The following figure shows the case where an Application Server acts as a
Voice Mail Server. S-CSCF invokes the AS acting as Voice Mail Server according
to procedure as defined in TS 23.218 [203].
Figure 5.2.2.1.12-1: Message Sequence Chart for AS acting as a Mail Server
1\. AS receives the INVITE from the S-CSCF.
2\. AS acknowledges the initiated Voice Mail session by issuing a 200 OK in
response to the INVITE.
3\. AS sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of a voice mail session.
4\. The CDF acknowledges the reception of the _Accounting-Request_ with
_Accounting-Record-Type_ indicating START_RECORD and opens a AS CDR.
5\. Voice mail session release is initiated.
6\. Upon reception of release message AS sends an _Accounting-Request_ with
_Accounting-Record-Type_ indicating STOP_RECORD to record stop of a session in
the AS CDR.
7\. The CDF acknowledges the reception of the data and closes the AS CDR.
##### 5.2.2.1.13 AS Related Procedures - AS Acting as a SCC AS
The charging requirements for IMS service continuity are specified in TS
23.237 [407].
Alternative "OneChargingSession"option is also reflected in the different
flows description, i.e a single charging session from SCC AS.
###### 5.2.2.1.13.1 UE originating call (PS only or CS only)
In this flow, Call-ID #1 is for access leg and Call-ID #2 is for remote leg.
Figure 5.2.2.1.13.1-1: Message Sequence Chart UE originating call
1\. The SCC session is initiated (an INVITE for IMS, a Call Setup for CS).
2\. After processing at CS/PS intermediate nodes, the resulting INVITE is sent
to the Sâ€‘CSCF
3\. The S-CSCF validates the service profile, and invokes any appropriate
service logic required for this user.
4\. The S-CSCF forwards the INVITE request message to the SCC AS, according to
the service origination logic defined by initial Filter Criteria (iFC) in the
subscriber profile of the HSS.
5\. The SCC call is anchored at the SCC AS in the home IMS Domain upon
reception of the SIP Invite (Call-ID# 1).
6-7. The S-CSCF forwards the INVITE request message to the terminating network
(Call-ID #2).
8\. The response 200 OK is transmitted to the S-CSCF in the Originating
network.
9\. Upon reception of the final response, the S-CSCF in the originating
network sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record SCC call routing and start of a user session/media
component in the S-CSCF CDR.
10-11. The CDF from the Originating network opens a S-CSCF CDR related to the
Remote leg and acknowledges the reception of the data.
12\. Same as 8 but for SCC AS (Remote leg)
13\. Same as 9 but for the SCC AS (Remote leg)
14-15. Same as 10-11 but opening a SCC AS CDR related to the Remote leg
> 13-14a-15 Alternatively, when "OneChargingSession", the SCC AS sends an
> _Accounting-Request_ with _Accounting-Record-Type_ indicating START_RECORD
> to record SCC call routing and start of a user session/media components in
> the SCC AS CDR for the IMS session (ICID) with access leg and remote leg.
> The CDF opens a SCC AS CDR related to the IMS session, and acknowledges the
> reception of the data.
16\. Same as 8 but for S-CSCF AS (Access leg)
17\. Same as 9 but for the SCC AS (Access leg) .
18-19. Same as 10-11 but opening a SCC AS CDR (Access leg) .
> .Steps 17 to 19 are not applicable for the "OneChargingSession" option.
20\. Same as 9 but for the S-CSCF (Access leg)
21-22. Same as 10-11 but opening a S-CSCF CDR (Access leg)
23\. The final response to SIP Invite (Call ID #1) is transmitted.
24\. The session is set up with CS or PS media.
For IMS Emergency session over PS, the same flow applies in the UE serving
Network, between the E-CSCF (instead of S-CSCF) and the EATF (Emergency Access
Transfer Function, instead of SCC AS), with E-CSCF and EATF CDRs opened for
access and remote legs.
EATF (acting as a B2BUA) performs third party call control and is considered
as an AS for the charging description.
###### 5.2.2.1.13.2 UE originating call (PS and CS combined origination)
In this flow, Call-ID #1 is for PS access leg, Call-ID #1\' for CS access leg
and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.2-1: Message Sequence Chart UE originating call
1\. UEâ€‘1 wants to initiate a multimedia session with UEâ€‘2 with speech
components carried on CS bearers and non-speech components carried on PS
bearers. Therefore the multimedia session is split into two parts, each one
corresponding to a separate access leg. UEâ€‘1 initiates the establishment of
the first access leg by sending an INVITE request with non-speech media
components. The INVITE contains STI information indicating that a second
access leg (with the speech component) will be originated from the CS domain.
2\. The Sâ€‘CSCF executes any service logic as appropriate.
3\. The Sâ€‘CSCF sends the INVITE to the SCC AS. The SCC AS identifies that this
access leg has to be correlated to a subsequent access leg based on the STI
information in the INVITE.
4\. UEâ€‘1 request to set up call with CS bearer. The called party number is set
to an identifier such as a PSI DN, which is used to indicate to the SCC AS
that this access leg is to be combined with a PS leg. The DN is either
statically configured on the UE or assigned to the UE by the network upon IMS
Registration.
5\. After processing at ICS/Interworking nodes, the resulting INVITE is sent
to the Sâ€‘CSCF.
6\. The Sâ€‘CSCF executes any service logic as appropriate.
7\. The Sâ€‘CSCF sends the INVITE to the SCC AS. The SCC AS identifies that this
CS leg has to be correlated to a PS leg based on the iFC in the INVITE.
8\. After the SCC AS receives both the INVITE requests in step 3 and in step
7, the SCC AS identifies that they are part of the same multimedia session and
combines the two access legs of the session by checking the caller\'s identity
and anchor the combined session.
9-10. The SCC AS sends INVITE to the remote end point for combined session
establishment.
11\. The 200 OK response is transmitted to the S-CSCF in the Originating
network.
12\. Upon reception of the final response, the S-CSCF in the originating
network sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record SCC call routing and start of a user session/media
component in the S-CSCF CDR.
13-14. The CDF from the Originating network opens an S-CSCF CDR related to the
Remote leg and acknowledges the reception of the data.
15\. Same as 11 but for SCC AS (Remote leg)
16\. Same as 12 but for the SCC AS (Remote leg)
17-18. Same as 13-14 but opening a SCC AS CDR related to the Remote leg
16-17a-18 Alternatively, when "OneChargingSession", the SCC AS sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating START_RECORD to
record start of the SCC AS CDR for the IMS session (ICID) with the CS access
leg, PS access leg and the Remote leg. The CDF opens a SCC AS CDR related to
the IMS session, and acknowledges the reception of the data.
19\. Same as 11 but for S-CSCF (Access leg)
20\. Same as 12 but for the SCC AS (Access leg)
21-22. Same as 13-14 but opening a SCC AS CDR for the PS access leg.
> Steps 20 to 22 are not applicable for the "OneChargingSession" option.
23\. Same as 12 but for the S-CSCF (Access leg)
24-25. Same as 13-14 but opening a S-CSCF CDR for the PS access leg.
26\. Same as 11 but for S-CSCF AS (Access leg).
27\. Same as 12 but for the SCC AS (Access leg).
28-29. Same as 13-14 but opening a SCC AS CDR for the CS access leg.
> Steps 27 to 29 are not applicable for the "OneChargingSession" option.
29\. Same as 12 but for the S-CSCF (Access leg)
30-31. Same as 13-14 but opening a S-CSCF CDR for the CS access leg.
32\. The final 200 OK response is sent to the UE #1
33\. The 200 OK response is sent to the ICS intermediate nodes.
34\. The completion of the CS call bearer is done.
###### 5.2.2.1.13.3 UE terminating call (PS only or CS only)
In this flow, Call-ID #1 is for PS access leg and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.3-1: Message Sequence Chart UE terminating call
1\. The SCC session is initiated by UE #2 sending an INVITE to S-CSCF.
2\. The S-CSCF validates the service profile, and invokes any appropriate
service logic required for this user.
3\. The S-CSCF forwards the INVITE request message to the SCC AS, according to
the service origination logic defined by initial Filter Criteria (iFC) in the
subscriber profile of the HSS.
4\. The SCC call is anchored at the SCC AS in the home IMS Domain upon
reception of the SIP Invite (Call ID #2).
5-6-7. The S-CSCF forwards the INVITE request message to the terminating
network (Call ID #1). After processing at CS/PS intermediate nodes, the
resulting message is sent to UE #1.
8\. The response 200 OK is transmitted to CS/PS intermediate nodes.
9\. After processing at CS/PS intermediate nodes, the 200 OK message is sent
to S-CSCF.
10\. Upon reception of the final response, the S-CSCF in the originating
network sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record SCC call routing and start of a user session/media
component in the S-CSCF CDR.
11-12. The CDF from the Originating network opens an S-CSCF CDR related to the
Access leg and acknowledges the reception of the data.
13\. Same as 9 but for SCC AS (Access leg)
14\. Same as 10 but for the SCC AS (Access leg)
15-16. Same as 11-12 but opening a SCC AS CDR related to the Access leg
14-15a-16 Alternatively, when "OneChargingSession", the SCC AS sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating START_RECORD to
record SCC call routing and start of a user session/media components in the
SCC AS CDR for the IMS session (ICID) with access leg and remote leg. The CDF
opens a SCC AS CDR related to the IMS session and acknowledges the reception
of the data.
17\. Same as 9 but for SCC AS (Remote leg)
18\. Same as 10 but for the SCC AS (Remote leg) .
19-20. Same as 11-12 but opening a SCC AS CDR (Remote leg).
Steps 18 to 20 are not applicable for the "OneChargingSession" option.
21\. Same as 10 but for the S-CSCF (Remote leg)
22-23. Same as 11-12 but opening a S-CSCF CDR (Remote leg)
24\. The final response to SIP Invite (Call ID #2) is transmitted.
###### 5.2.2.1.13.4 UE terminating call (PS and CS combined origination)
In this flow, Call-ID #1 is for PS access leg, Call-ID #1\' for CS access leg
and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.4-1: Message Sequence Chart UE terminating call
1\. UEâ€‘2 sends INVITE to UEâ€‘1 to establish a session with both speech and non-
speech components.
2\. The Sâ€‘CSCF executes any service logic as appropriate.
3\. The Sâ€‘CSCF sends the INVITE to the SCC AS. The SCC AS identifies that this
access leg has to be correlated to a subsequent access leg based on the ST
information in the INVITE.
4\. The session is anchored at the SCC AS. Based on operator policy and on
information indicating that UEâ€‘1 is accessible over both the PS and CS
domains, the SCC AS decides to split the session over PS and CS domains. This
behaviour is similar to the behaviour of a CSI AS specified in TS 23.279.
5\~6. The SCC AS sends INVITE for the non-speech part of the session. The
INVITE contains STI information indicating that the speech component will be
established from the CS domain.
7\~8. The SCC AS sends INVITE for the speech part of the session and the
Sâ€‘CSCF forwards the INVITE to the ICS/Interworking nodes.
9\. The ICS/Interworking nodes set up call to UEâ€‘1 with CS bearer.
10\~18. A 200 OK response is sent to the S-CSCF. The speech and non-speech
part of the session is established.
11\. Upon reception of the response, the S-CSCF in the originating network
sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record SCC call routing and start of a user session/media
component in the S-CSCF CDR.
12-13. The CDF from the Originating network opens an S-CSCF CDR related to the
PS Access leg and acknowledges the reception of the data.
14\. Same as 10 but for SCC AS (Access leg)
15\. Same as 11 but for the SCC AS (Access leg)
16-17. Same as 12-13 but opening a SCC AS CDR related to the PS Access leg.
> 15-16a-17 Alternatively, when "OneChargingSession", the SCC AS sends an
> _Accounting-Request_ with _Accounting-Record-Type_ indicating START_RECORD
> to record start of the SCC AS CDR for the IMS session (ICID) with the PS
> access leg and the Remote leg. The CDF opens the SCC AS CDR related to the
> IMS session and acknowledges the reception of the data.
19\. Upon reception of the response, the S-CSCF in the originating network
sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record SCC call routing and start of a user session/media
component in the S-CSCF CDR.
20-21. The CDF from the Originating network opens an S-CSCF CDR related to the
CS Access leg and acknowledges the reception of the data.
22\. Same as 10 but for SCC AS (Access leg)
23\. Same as 11 but for the SCC AS (Access leg)
24-25. Same as 12-13 but opening a SCC AS CDR related to the CS Access leg.
23-24a-25 Alternatively, when "OneChargingSession", the SCC AS sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of the SCC AS CDR for the IMS session (ICID) with the
CS access leg. The CDF updates the SCC AS CDR related to the IMS session and
acknowledges the reception of the data.
26\. Same as 10 but for S-CSCF (Remote leg)
27\. Same as 11 but for the SCC AS (Remote leg)
28-29. Same as 12-13 but opening a SCC AS CDR for the Remote leg.
> Steps 27 to 29 are not applicable for the "OneChargingSession" option.
30\. Same as 11 but for the S-CSCF (Remote leg)
31-32. Same as 12-13 but opening a S-CSCF CDR for the Remote leg.
33\. The 200 OK response is sent to the UE #2.
###### 5.2.2.1.13.5 Session transfer from PS to CS
In this flow, Call-ID #1 is for PS access leg, Call-ID #1\' for CS access leg
and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.5-1: Message Sequence Chart UE Domain Transfer PS access to
CS access
The user is engaged in an active multimedia session with UEâ€‘2 viaPS access.
1-2. UEâ€‘1 originates a multimedia call in the CS domain including the STN
information to request the real time media transfer to CS access.
3\. The ICS intermediate Nodes convert the request into IMS SIP format and
then forward the converted request to the Sâ€‘CSCF.
4\. The Sâ€‘CSCF invokes the SCC Application as the first Application Server of
any Application Servers that need to remain in the path of the call after
session transfer.
5\. The Sâ€‘CSCF forwards the INVITE to the SCC Application over the ISC
interface.
6 The SCC AS analyses the INVITE to derive that the INVITE is a request to
transfer a multimedia session with video and voice media components to the PS
domain..
7-9. The SCC AS sends a re-INVITE to the Remote UE to update the media
components of the previous dialog. Remote UE answers by a 200 OK message.
10-12. At Remote Leg update the S-CSCF in the originating network sends
Accounting-Request with Accounting-Record-Type indicating INTERIM_RECORD to
record update of a session in the S-CSCF CDR.
13\. The S-CSCF answers to the INVITE message in 7.
14-16. At Remote Leg update the SCC AS sends Accounting-Request with
Accounting-Record-Type indicating INTERIM_RECORD to record update of a session
in the SCC AS CDR.
14-15a-16. Alternatively, when "OneChargingSession", the SCC AS sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of SCC AS CDR for the IMS session (ICID) with the new
legs configuration (Remote leg and new CS access leg).The CDF updates the SCC
AS CDR related to the IMS session and acknowledges the reception of the data.
17\. The SCC AS answers to the INVITE message in 5.18-20. Upon generation of
the 200 OK response, the SCC AS in the home IMS of the originating SCC user
sends an _Accounting-Request_ with Accounting-Record-Type indicating
START_RECORD to record start of a user session in the SCC AS-CDR for Call-ID
#1\'. The CDF from the originating network opens an AS CDR and acknowledges
the reception of the data.
> Steps 18 to 20 are not applicable for the "OneChargingSession" option.
21-23. Upon generation of the 200 OK response, the S-CSCF in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the S-CSCF-
CDR for Call-ID #1\'.. The CDF from the originating network opens an S-CSCF
CDR and acknowledges the reception of the data.
24\. The 200 OK response is sent by the S-CSCF.
25\. The 200 OK response is converted by the ICS/Interworking nodes in CS
format.
26-28. The UE #1 acknowledges by sending an ACK message to the SCC AS.
29-31. The SCC Application sends BYE request to release the old access leg.
32-34. At session termination the SCC AS sends _Accounting-Request_ with
_Accounting-Record-Type_ indicating STOP_RECORD to record stop of a session
and stop of a media component in the SCC AS CDR. This CDR may be generated
with special handling. One example of special handling is to zero rate the IMS
resource usage for the Access leg establishment.
> Steps 32 to 34 are not applicable for the "OneChargingSession" option.
35-37. The S-CSCF in the originating network sends Accounting-Request with
Accounting-Record-Type indicating STOP_RECORD for closing the S-CSCF CDR
related to the initial Access leg. This CDR may be generated with special
handling. One example of special handling is to zero rate the IMS resource
usage for Access leg establishment. This can be performed using the
correlation mechanism with the SCC AS CDR for Access leg.
38-40. The UE-1 acknowledges the release of old access leg.
###### 5.2.2.1.13.6 Session transfer from CS to PS
In this flow, Call-ID #1 is for PS access leg, Call-ID #1\' for CS access leg
and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.6-1: Message Sequence Chart UE Domain Transfer CS access to
PS access
The user is engaged in an active multimedia session with UEâ€‘2 via CS access.
1\. UE-1 originates a call in the PS domain including the STI to request the
multimedia session transfer to PS access in conjunction with CS access.
2\. The session establishment request is routed to the S-CSCF by the P-CSCF.
3\. The Sâ€‘CSCF invokes the SCC Application as the first Application Server of
any Application Servers that need to remain in the path of the call after
session transfer.
4\. The Sâ€‘CSCF forwards the INVITE to the SCC Application over the ISC
interface.
5\. The SCC Application analyses the INVITE to derive that the INVITE is a
request to transfer a multimedia session with video and voice media components
to the PS domain.
6-8. The SCC AS sends a re-INVITE to the Remote UE to update the media
components of the previous dialog. Remote UE answers by a 200 OK message.
9-11. At Access Leg update the S-CSCF in the originating network sends
Accounting-Request with Accounting-Record-Type indicating INTERIM_RECORD to
record update of a session in the S-CSCF CDR.
12\. The S-CSCF answers to the INVITE message in 6.
13-15. At Access Leg update the SCC AS sends Accounting-Request with
Accounting-Record-Type indicating INTERIM_RECORD to record update of a session
in the SCC AS CDR.
13-14a-15. Alternatively, when "OneChargingSession", the SCC AS sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of SCC AS CDR for the IMS session (ICID) with the new
legs configuration (Remote leg and new PS access leg).The CDF updates the SCC
AS CDR related to the IMS session and acknowledges the reception of the data.
16\. The SCC AS answers to the INVITE message in 4.
17-19. Upon generation of the final response, the SCC AS in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the SCC AS-
CDR. The CDF from the originating network opens an AS CDR and acknowledges the
reception of the data.
> Steps 17 to 19 are not applicable for the "OneChargingSession" option.
20-22. Upon generation of the final response, the S-CSCF in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the S-CSCF-
CDR. The CDF from the originating network opens an S-CSCF CDR and acknowledges
the reception of the data.
23\. The S-CSCF answers to the INVITE message in 2.
24-25. The 200 OK is acknowledged.
26-28. The SCC Application sends BYE request to release the old access leg.
29-31 The SCC AS sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the SCC AS CDR related to the original
Access leg. The CDF updates the SCC AS CDR related to the IMS session and
acknowledges the reception of the data
> Steps 29 to 31 are not applicable for the "OneChargingSession" option.
32-34. The S-CSCF sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the S-CSCF CDR related to the original
Access leg. This CDR may be generated with special handling. One example of
special handling is to zero rate the IMS resource usage for Access leg
establishment. This can be performed using the correlation mechanism with the
SCC AS CDR for Access leg.
35-37 The UE-1 acknowledges the release of old access leg.
###### 5.2.2.1.13.7 Session transfer from PS to (CS+PS)
In this flow, Call-ID #1 is for PS2 access leg, Call-ID #1\' for PS1 access
leg, Call-ID #1\" for CS access leg and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.7-1: Message Sequence Chart UE Domain Transfer PS2 access to
PS1 and CS access.
1-2. UE-1 originates a call in the PS1 domain including the STI to request the
multimedia session transfer to PS1 access in conjunction with CS access.
3\. The session establishment request is routed to the S-CSCF by the P-CSCF.
4\. The S-CSCF invokes the SCC Application as the first Application Server of
any Application Servers that need to remain in the path of the call after
session transfer.
5\. The S-CSCF forwards the INVITE to the SCC Application over the ISC
interface.
6\. The SCC Application analyses the STI and decides to wait for the session
transfer request in CS access.
7\. UE-1 origins a CS call including STN to indicate to the network that this
is a session transfer request.
8\. The ICS intermediate Nodes convert the request into IMS SIP format and
then forward the converted request to the S-CSCF.
9\. The S-CSCF forwards the INVITE to the SCC Application over the ISC
interface.
10\. The SCC Application correlates the two requests and decides to update the
Remote leg.
11-13. The SCC AS sends a re-INVITE to the Remote UE to modify the media
components of the existing dialog identified in the REFER request. The re-
INVITE proposes new SDP parameters based on the parameters received from UE-2
in step 6 When the Remote UE receives the new media parameters, it returns an
answer and starts the reception/transmission of these media components.
14-16. At Access Leg update the S-CSCF in the originating network sends
Accounting-Request with Accounting-Record-Type indicating INTERIM_RECORD to
record update of a session in the S-CSCF CDR.
17\. The S-CSCF answers to the INVITE message in 11.
18-20. At Access Leg update the SCC AS sends Accounting-Request with
Accounting-Record-Type indicating INTERIM_RECORD to record update of a session
in the SCC AS CDR
18-19a-20. Alternatively, when "OneChargingSession", the SCC AS sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of SCC AS CDR for the IMS session (ICID) with the new
PS access leg, new CS access leg and Remote leg. The CDF updates the SCC AS
CDR related to the IMS session and acknowledges the reception of the data..
21\. The S-CSCF answers to the INVITE message in 5.
22-24. Upon generation of the final response, the SCC AS in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the SCC AS-
CDR for Call-ID #1\' . The CDF from the originating network opens an AS CDR
and acknowledges the reception of the data.
> Steps 22 to 24 are not applicable for the "OneChargingSession" option.
25-27. Upon generation of the final response, the S-CSCF in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the S-CSCF-
CDR for Call-ID #1\'. The CDF from the originating network opens an S-CSCF CDR
and acknowledges the reception of the data.
28-29. The S-CSCF accepts session continuity message from the Remote UE by
sending a 200 OK response (for the PS1 INVITE message).
30-32. UE-1 sends an ACK response to the SCC AS.
33\. The S-CSCF answers to the INVITE message in 9.
34-36. Upon generation of the final response, the SCC AS in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the SCC AS-
CDR for Call-ID #1\". The CDF from the originating network opens an AS CDR and
acknowledges the reception of the data.
Steps 34 to 36 are not applicable for the "OneChargingSession" option.
37-39. Upon generation of the final response, the S-CSCF in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the S-CSCF-
CDR for Call-ID #1\". The CDF from the originating network opens an S-CSCF CDR
and acknowledges the reception of the data.
40-41. The S-CSCF accepts session continuity message from the Remote UE by
sending a 200 OK response (for the CS INVITE message).
42-44. UE-1 sends an ACK response to the S-CSCF.
45\. Once acknowledgment has been received for the both leg, the ACK message
is sent to the remote UE.
46-48. The SCC Application initiates to release the old access leg
49-51. The SCC AS sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the SCC AS CDR related to the original
Access leg. The CDF updates the SCC AS CDR related to the IMS session and
acknowledges the reception of the data
> Steps 49 to 51 are not applicable for the "OneChargingSession" option.
52-54. The S-CSCF sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the S-CSCF CDR related to the original
Access leg. This CDR may be generated with special handling. One example of
special handling is to zero rate the IMS resource usage for Access leg
establishment. This can be performed using the correlation mechanism with the
SCC AS CDR for Access leg.
55-56. The UE answers by a 200 OK message to the S-CSCF.
57\. The S-CSCF sends a 200 OK message to the SCC AS the releasing of the old
access leg.
###### 5.2.2.1.13.8 Session transfer from (CS+PS) to PS
In this flow, Call-ID #1 is for PS2 access leg, Call-ID #1\' for CS access
leg, Call-ID #1\" for PS1 access leg and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.8-1: Message Sequence Chart UE Domain Transfer PS2 access
and CS access to PS1 access
1-2. UE-1 originates a call in the PS1 domain including the STI to request the
multimedia session transfer to PS1 access.
3\. The session establishment request is routed to the S-CSCF by the P-CSCF.
4\. The S-CSCF invokes the SCC Application as the first Application Server of
any Application Servers that need to remain in the path of the call after
session transfer.
5\. The S-CSCF forwards the INVITE to the SCC Application over the ISC
interface.
6\. The SCC Application analyses the STI and decides to update the Remote leg.
7-9. The SCC AS sends a re-INVITE to the Remote UE to modify the media
components of the existing dialog identified in the REFER request. The re-
INVITE proposes new SDP parameters based on the parameters received from UE-2
in step 6 When the Remote UE receives the new media parameters, it returns an
answer and starts the reception/transmission of these media components.
10-12. At Access Leg update the S-CSCF in the originating network sends
Accounting-Request with Accounting-Record-Type indicating INTERIM_RECORD to
record update of a session in the S-CSCF CDR.
13\. The S-CSCF answers to the INVITE message in 7.
14-16. At Access Leg update the SCC AS sends Accounting-Request with
Accounting-Record-Type indicating INTERIM_RECORD to record update of a session
in the SCC AS CDR
14-15a-16. Alternatively, when "OneChargingSession", the SCC AS sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of SCC AS CDR for the IMS session (ICID) with remote
leg and new PS access leg. The CDF updates the SCC AS CDR related to the IMS
session and acknowledges the reception of the data..
17\. The SCC AS answers to the INVITE message in 5.
18-20. Upon generation of the final response, the SCC AS in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the SCC AS-
CDR. The CDF from the originating network opens an AS CDR and acknowledges the
reception of the data
Steps 18 to 19 are not applicable for the "OneChargingSession" option.
21-23. Upon generation of the final response, the S-CSCF in the home IMS of
the originating SCC user sends an _Accounting-Request_ with Accounting-Record-
Type indicating START_RECORD to record start of a user session in the S-CSCF-
CDR. The CDF from the originating network opens an S-CSCF CDR and acknowledges
the reception of the data.
24\. The S-CSCF answers to the INVITE message in 3.
25 The 200 OK message is sent to UE #1.
26-30. UE-1 sends an ACK response to the S-CSCF. The ACK message is sent to
the remote UE.
31-33. The source Access Leg 2(which is one of the Access Legs previously
established over PS2) is released by the SCC Application in this example,
however the UEâ€‘1 may initiate to release the source Access Leg 2.
34-36. The SCC AS sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the SCC AS CDR related to the original
Access leg. The CDF updates the SCC AS CDR related to the IMS session and
acknowledges the reception of the data
> Steps 34 to 36 are not applicable for the "OneChargingSession" option.
37-39. The S-CSCF sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the S-CSCF CDR related to the original PS
Access leg. This CDR may be generated with special handling. One example of
special handling is to zero rate the IMS resource usage for Access leg
establishment. This can be performed using the correlation mechanism with the
SCC AS CDR for PS Access leg.
40-42. The UE-1 answers to the BYE message in 33.
43-45. The SCC Application initiates to release the old access leg via CS
access in this example, however the UEâ€‘1 may initiate to release the source
Access Leg.
46-48. The SCC AS sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the SCC AS CDR related to the original CS
Access leg. The CDF updates the SCC AS CDR related to the IMS session and
acknowledges the reception of the data
> Steps 46 to 48 are not applicable for the "OneChargingSession" option.
49-51. The S-CSCF sends Accounting-Request with Accounting-Record-Type
indicating STOP_RECORD for closing the S-CSCF CDR related to the original CS
Access leg. This CDR may be generated with special handling. One example of
special handling is to zero rate the IMS resource usage for Access leg
establishment. This can be performed using the correlation mechanism with the
SCC AS CDR for CS Access leg.
52-54. The UE-1 answers to the BYE message in 43.
###### 5.2.2.1.13.9 IMS Emergency Session transfer from PS to CS
In this flow, Call-ID #1 is for PS access leg, Call-ID #1\' for CS access leg
and Call-ID #2 for remote leg.
Figure 5.2.2.1.13.9-1: Message Sequence Chart UE Domain Transfer PS access to
CS access for IMS emergency session.
1-2. UE originates an IMS emergency session transfer towards EATF via I-CSCF.
3\. From the received INVITE analysis, the EATF derives a request for transfer
of the existing IMS emergency session to the CS domain, and proceeds with
switch of access leg communicating with the Remote Leg from Old PS Access Leg
to new CS Access Leg.
4-5. The EATF performs the Remote Leg update by sending the SIP re-INVITE
request towards the remote end vie E-CSCF.
6-8 Upon receipt of the 200 OK response, the E-CSCF sends an _Accounting-
Request_ with Accounting-Record-Type indicating INTERIM_RECORD to record
update of the E-CSCF CDR for remote leg Call-ID #2.
9-11 Upon receipt of the 200 OK response, the EATF sends an _Accounting-
Request_ with Accounting-Record-Type indicating START_RECORD to record start
of an EATF CDR for new access leg Call-ID #1'. Alternatively, when
"OneChargingSession", the EATF sends an _Accounting-Request_ with _Accounting-
Record-Type_ indicating INTERIM_RECORD to record modification of EATF CDR for
the IMS session (ICID) with new CS access leg. The CDF updates the EATR CDR
related to the IMS session and acknowledges the reception of the data.
12-14 Upon receipt of the 200 OK response, the I-CSCF sends an _Accounting-
Request_ with Accounting-Record-Type indicating EVENT_RECORD to create an
I-CSCF CDR for new access leg Call-ID #1'.
15\. The 200 OK response is sent towards the UE via ICS/Interworking nodes.
16-17 Upon release of old access leg, the EATF sends an _Accounting-Request_
with Accounting-Record-Type indicating STOP_RECORD to record stop of the EATF
CDR for old access leg Call-ID #1.
> Steps 16 to 17 are not applicable for the "OneChargingSession" option.
18-19 Upon release of old access leg, the E-CSCF sends an _Accounting-Request_
with Accounting-Record-Type indicating STOP_RECORD to record stop of the
E-CSCF CDR for old access leg Call-ID #1.
EATF (acting as a B2BUA) performs third party call control and is considered
as an AS for the charging description.
##### 5.2.2.1.14 Initiating Alternate Charged Party Call
The following figure shows the case where a call with an alternate charged
party is successfully initiated.
Figure5.2.2.1.14-1: Successful Initiation of Alternate Party Charging
  1. The AS receives a SIP Invite.
```{=html}
``` 1\. After determining that Alternate Charged Party is supported, the AS
initiates an Invite with an \"Alternate Party Identity\" for charging. The
method for determination of the alternate charged party includes accessing
subscriber data and doing a security assessment.
  1. The terminating side issues a 200 OK (Answer), to AS.
  2. The AS sends a 200 OK.
  3. The AS sends an accounting request to the CDF.
  4. The CDF opens a CDR with the Subscription-ID for the Alternate Charged Party and sends an accounting answer to the AS.
  5. The session is established.
##### 5.2.2.1.15 Session Establishment via IBCF to S-CSCF - IMS Initiated
The following figure shows the Diameter transactions that are required between
IBCF, S-CSCF and CDF in each IMS network during session establishment.
Figure 5.2.2.1.15-1: Message Sequence Chart for IMS Initiated Session
Establishment via IBCF
1\. The session is originated in Home IMS A, and an INVITE is sent through to
Home IMS B via IBCFs.
2\. All of the IMS network entities respond with successful 200 OK to the
Invite.
3\. Upon reception of the answer message, the IBCFs send an _Accounting-
Request_ with\ _Accounting-Record-Type_ to the CDF in each IMS indicating
START_RECORD to record start of a user session and start of a media component
in the IBCF and CDRs.
4 The CDF in each IMS acknowledges the reception of the data and opens an IBCF
CDR
5\. Upon reception of the answer message, the S-CSCFs send an _Accounting-
Request_ with\ _Accounting-Record-Type_ to the CDF in each IMS indicating
START_RECORD to record start of a user session and start of a media component
in the and S-CSCF.
6 The CDF in each IMS acknowledges the reception of the data and opens an
S-CSCF CDR.
7\. The session is established.
##### 5.2.2.1.16 AS Related Procedures - AS Acting as a MMTel AS.
For details on charging at AS acting as an MMTel server, providing service
such as CDIV, CONF and TIP/TIR, see the TS 32.275 [35].
##### 5.2.2.1.17 Session Establishment via IBCF to a third party AS providing
tariff information in real time (RTTI)
The following figure shows the Diameter transactions that are required between
S-CSCF, IBCF and CDF, in each IMS network, during session establishment. It
represents a charging interconnect scenario where the third party AS (located
in another network) provides e.g. value-added service and real time tariff
information according to TS 29.658 [206].
Editor\'s Note: The interconnect scenario between IMS network and PSTN
(involving MGCF rather than IBCF) is FFS.
Figure 5.2.2.1.17-1: Message Sequence Chart for IMS Initiated Session
Establishment with a 3^rd^ party AS providing real-time tariff information
(RTTI)
1\. The session is initiated.
2\. The destination (third party AS) answers with successful 200OK to the
INVITE. The third party AS includes a real time tariff information within the
200OK response.
3\. Upon reception of the final response, the S-CSCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating START_RECORD to record
start of a user session and start of a media component in the S-CSCF.
4 The CDF in each IMS network acknowledges the reception of the data and opens
an S-CSCF CDR.
5\. Upon reception of the 200 OK message, the IBCFs send an _Accounting-
Request_ with\ _Accounting-Record-Type_ to the CDF in each IMS indicating
START_RECORD to record start of a user session and start of a media component
in the IBCF.
6 The CDF in each IMS acknowledges the reception of the data and opens an IBCF
CDR.
##### 5.2.2.1.18 Third party AS providing tariff information in real time
(RTTI) during the session
The following figure shows the Diameter transactions that are required between
S-CSCF, IBCF and CDF, in each IMS network, when a third party AS (located in
another network) involved in the session provides e.g. value-added service and
real time tariff information according to TS 29.658 [206] during the session.
Figure 5.2.2.1.18-1: Message Sequence Chart for third party AS providing
tariff information in real time (RTTI) during the session
1\. The third party AS includes an RTTI within a SIP INFO and sends the
message to the originating party.
2\. Upon reception of the INFO embedding RTTI, the S-CSCF sends an
_Accounting-Request_ with\ _Accounting-Record-Type_ indicating INTERIM_RECORD
to record tariff information in the CDR.
3\. The CDF acknowledges the reception of the data and updates the S-CSCF CDR.
4 Upon reception of the INFO embedding RTTI, the IBCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating INTERIM_RECORD to record
tariff information in the CDR.
5\. The CDF acknowledges the reception of the data and updates the IBCF-CDR.
6\. Upon reception of the INFO embedding RTTI, the IBCF sends an _Accounting-
Request_ with\ _Accounting-Record-Type_ indicating INTERIM_RECORD to record
tariff information in the CDR.
7\. The CDF acknowledges the reception of the data and updates the IBCF-CDR.
8\. Upon reception of the INFO embedding RTTI, the S-CSCF sends an
_Accounting-Request_ with\ _Accounting-Record-Type_ indicating INTERIM_RECORD
to record tariff information in the CDR.
9\. The CDF acknowledges the reception of the data and updates the S-CSCF CDR.
##### 5.2.2.1.19 Support of Optimal Media Routing (OMR)
Optimal Media Routing (OMR) relies on IMS-ALG function enhancement, used by
some IMS Nodes as described in TS 23.228 [201] Annex Q, when performing media
functions at transport level such as firewall or NAT, or application level
such as transcoding. The purpose of optimal media routing (OMR) is to identify
and remove unnecessary media functions from the media path for each media
stream associated to a session. The OMR procedures are applicable to the
following IMS entities having IMS-ALG function used in a B2BUA mode:
  * P-CSCF for support of NAT for signalling and media (with IMS-ALG/IMS-AGW model as described in TS 23.228 [201]) Annex G)
  * IBCF for border Control Functions towards other IMS/SIP Networks (with IBCF/TrGW model as described in TS 23.228 [201] Annex I)
  * Any AS performing as a B2BUA controlling media resources
Although the different TS 23.228 [201] scenarios mainly address the IBCF/TrGW,
they are also applicable to P-CSCF/ IMS-AGW, except for transcoding function
which relates to IBCF only. Consequently, in the different flows, the "GW"
stands for TrGW or IMS-AGW, according to the situation.
The following flows focus on one IMS Node behaviour, embedding such IMS-ALG
function supporting OMR, when involved in some of OMR scenarios described in
TS 23.228 [201] Annex Q.
Each media line of the same session can be applied with separate OMR decision
(i.e different optimised paths), however, for simplification, only one media
is assumed in the following call flows.
In the Figure, the "Originating side" may be an Originating UA or another IMS-
ALG in the same IMS Network, or another IMS Network, and the "Destination
side" may be a Terminating UA or another IMS-ALG in the same IMS Network, or
another IMS Network.
###### 5.2.2.1.19.1 IMS-ALG Related Procedures for OMR -- Session
establishment and IMS-ALG bypasses its local GW
The following figure shows the session establishment with SDP offer/answer
exchange from Originating side towards a Destination side, traversing an IMS
Network Node including IMS-ALG function supporting OMR, and OMR results in
IMS-ALG bypasses its local GW.
Figure 5.2.2.1.19.1-1: Message Sequence Chart for Session establishment with
IMS-ALG supporting OMR and IMS-ALG bypasses its local GW due to OMR process.
1\. IMS-ALG receives an INVITE with SDP offer-inc (call-ID#-inc) from
Originating side, containing the transport address allocated in realm R1 by
the Originating side for the media on incoming leg, and potential OMR
information from prior user plane segments.
2\. IMS-ALG determines the outgoing IP realm (R2) is different from the
incoming IP realm (R1) and interacts with a GW in order to allocate a local
transport address for the media on outgoing leg, in realm R2.
3\. IMS-ALG generates INVITE towards Destination side (call-ID#-out), with a
new SDP offer-out including such local transport address, and also OMR
extensions (for the segment locally handled, along with those received from
prior user plane segments) for further OMR decisions.
4\. The destination side answers with 200 OK and SDP answer-out, with the
transport address allocated by the destination side for the media on outgoing
leg, as result of OMR processing (based on OMR information provided in step
3). This transport address is in realm R1, thus identifying the local GW to be
bypassed (i.e same IP realm as in step 1), and also identifying use of a
different IP realm from the default one (i.e R2).
5\. The Local GW is de-allocated (release of resource allocated in step 2 in
realm R2).
6\. IMS-ALG forwards the SDP answer-inc for the media on incoming leg, with
this transport address received in step 4.
7\. IMS-ALG sends _Accounting-Request_ with _Accounting-Record-Type_
indicating START_RECORD to record start of session with "Local GW Not
Inserted" and "IP realm Not Default"" indications for the media.
8-9. The CDF opens a session CDR for the IMS Node and acknowledges the
reception of the data.
10\. A user plane connection is now established in realm R1 without GW
insertion for the media.
###### 5.2.2.1.19.2 IMS-ALG Related Procedures for OMR -- Session
establishment and alternate IP realm is selected
The following figure shows the session establishment with SDP offer/answer
exchange from Originating side towards Destination side, traversing an IMS
Network Node including IMS-ALG function supporting OMR, and OMR results in
alternate IP realm selection (i.e not the default IP realm) for the media.
Figure 5.2.2.1.19.2-1: Message Sequence Chart for Session establishment with
IMS-ALG supporting OMR, and alternate realm is selected due to OMR process.
1\. IMS-ALG receives an INVITE with SDP offer-inc (call-ID#-inc) from
Originating side, containing the transport address allocated in realm R1 by
the Originating side for the media on incoming leg, and potential OMR
information from prior user plane segments.
2\. IMS-ALG determines the outgoing IP realm (R2) is different from the
incoming IP realm (R1) and interacts with a GW1 in order to allocate a local
transport address for the media on outgoing leg, in realm R2. IMS-ALG
additionally interacts with GW2 in order to allocate an alternate local
transport address for the media in realm R3.
3\. IMS-ALG generates INVITE towards Destination side (call-ID#-out), with a
new SDP offer-out including such local transport addresses, and also OMR
extensions (for the segment locally handled, along with those received from
prior user plane segments) for further OMR decisions.
4\. The destination side answers with 200 OK and SDP answer-out, with the
transport address allocated by the destination side for the media on outgoing
leg, as result of OMR processing (based on OMR information provided in step
3).This transport address is in realm R3, thus identifying the local GW2 to be
retained, and also identifying use of a different IP realm from the default
one (i.e R2).
5\. The GW1 is de-allocated (release of resource allocated in step 2 for realm
R2), and interaction occurs with GW2 to maintain the user plane connection via
R3.
6\. IMS-ALG1 forwards the SDP answer-inc, with the transport address allocated
by the GW2 in realm R1, for the media on incoming leg.
7\. IMS-ALG sends _Accounting-Request_ with _Accounting-Record-Type_
indicating START_RECORD to record start of session with "Local GW Inserted"
and "IP realm Not Default" indications for the media.
8-9. The CDF opens a session CDR for the IMS Node and acknowledges the
reception of the data.
10a-b. A user plane connection is now established in realm R1 up to the GW2,
and in realm R3 from the GW2 for the media.
###### 5.2.2.1.19.3 IMS-ALG Related Procedures for OMR -- Mid-session
procedure
The following figure shows a scenario when a new SDP offer/answer exchange due
to UE generating a SIP (reâ€‘)iNVITE or SIP UPDATE in mid-session in order to
add a media component , and the OMR procedures is processed for this new
media, with same situation as in 5.2.2.1.19.1 (IMS-ALG bypasses its local GW).
This scenario also applies for situations where a (reâ€‘)iNVITE or a SIP UPDATE
is issued for updating a media and the OMR procedures is processed again,
changing the established media path.
F**igure 5.2.2.1.19.3-1: Message Sequence Chart for mid-session procedure with
IMS-ALG supporting OMR, IMS-ALG bypasses its GW due to OMR process for the
added media.**
The same steps described in chapter 5.2.2.1.19.1 apply, with following
exceptions:
1 and 3: a Re-INVITE instead of INVITE
7\. IMS-ALG sends _Accounting-Request_ with _Accounting-Record-Type_
indicating INTERIM_RECORD to record update of session with "Local GW Not
Inserted" and "IP realm Not Default" indications for the media.
8-9. The CDF updates the session CDR for the IMS Node and acknowledges the
reception of the data.
###### 5.2.2.1.19.4 IMS-ALG Related Procedures for OMR -- transcoding
As described in TS 23.228 [201] Annex Q, transcoding is also part of OMR
process.
The following flows show session establishment with SDP offer/answer exchange
from Originating side towards a Destination side, traversing an IMS Network
Node including IMS-ALG function supporting OMR with transcoder inserted by
this IMS Node.
Although transcoding aspect is part of the same SDP Offer/Answer different
exchanges described in sub-clause 5.2.2.1.19.1 to sub-clause 5.2.2.1.19.3,
therefore combined in OMR process, it is reflected here through dedicated
flows for simplification.
These procedures apply to IBCF/TrGW only.
###### # 5.2.2.1.19.4.1 IMS-ALG Related Procedures for OMR -- transcoder
provided by IMS-ALG
The following flow describes the situation where IMS-ALG allocates a
transcoder for offering an additional transcoding option, and this transcoder
is selected.
Figure 5.2.2.1.19.4.1-1: Message Sequence Chart for Session establishment with
transcoder offered by IMS-ALG is inserted.
1\. IMS-ALG receives an INVITE with SDP offer-inc (call-ID#-inc) from
Originating side, containing a codec-list-inc in the SDP offer, and potential
OMR information from prior user plane segments based on an Operator's
configuration.
2\. IMS-ALG interacts with TrGW for transcoder allocation for the purpose of
offering an additional codec "codec-out".
3\. IMS-ALG generates INVITE towards Destination side (call-ID#-out), the SDP
offer-out containing the new codec-list-out (i.e codec-list-inc enriched with
"codec-out"), and also OMR extensions (for transcoding options associated to
different segments).
4\. The destination side answers with 200 OK and SDP answer-out with the
selected codec which is the additional one offered by IMS-ALG (i.e codec-out).
5\. Interaction occurs with TrGW for media configuration with codec-out for
the outgoing leg and with codec-inc for the incoming leg (codec-inc is
selected by IBCF from the codec-list-inc received in step 1).
6\. IMS-ALG forwards the SDP answer-inc for the incoming leg, with this codec-
inc.
7\. IMS-ALG sends _Accounting-Request_ with _Accounting-Record-Type_
indicating START_RECORD to record start of session with "Transcoder Inserted"
indication for the media.
8-9. The CDF opens a session CDR for the IMS Node and acknowledges the
reception of the data.
###### # 5.2.2.1.19.4.2 IMS-ALG Related Procedures for OMR -- transcoder
offered by IMS-ALG but not selected
The following flow describes the situation where IMS-ALG allocates a
transcoder for offering an additional transcoding option, and this transcoder
is not selected.
Figure 5.2.2.1.19.4.2-1: Message Sequence Chart for Session establishment with
transcoder offered by IMS-ALG is not selected.
1\. IMS-ALG receives an INVITE with SDP offer-inc (call-ID#-inc) from
Originating side, containing a codec-list-inc in the SDP offer, and potential
OMR information from prior user plane segments, based on an Operator's
configuration.
2\. IMS-ALG interacts with TrGW for transcoder allocation for the purpose of
offering additional codec "codec-out".
3\. IMS-ALG generates INVITE towards Destination side (call-ID#-out), the SDP
offer-out containing the new codec-list-out (i.e codec-list-inc enriched with
"codec-out"), and also OMR extensions (for transcoding options associated to
different segments).
4\. The destination side answers with 200 OK and SDP answer-out with the
selected codec (codec-inc), belonging to the codec-list-inc received in step 1
(original offer).
5\. Therefore, transcoding is not needed, and TrGW is de-allocated.
6\. IMS-ALG forwards the SDP answer-inc for the incoming leg, with this codec-
inc.
7\. IMS-ALG sends _Accounting-Request_ with _Accounting-Record-Type_
indicating START_RECORD to record start of session with "Transcoder Not
Inserted" indication for the media.
8-9. The CDF opens a session CDR for the IMS Node and acknowledges the
reception of the data.
##### 5.2.2.1.20 AS acting as a B2BUA -- Single Charging session
The following figure shows the case where an Application Server acts as a
B2BUA, and a single offline charging session is created for the established
dialogs ("OneChargingSession" option)
Figure 5.2.2.1.20-1: Message Sequence Chart for AS acting as a B2BUA with
single Charging session
1\. AS receives the INVITE from Incoming side (Call-ID#inc) containing ICID.
2\. AS acting as a B2BUA generates INVITE towards Outgoing side (Call-ID#out)
with the same ICID as received in step 1.
3\. 200 OK is received in response to the INVITE (Call-ID#out).
4\. 200 OK is sent in response to the INVITE (Call-ID#inc).
5\. AS sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of a session, provided with ICID and information
associated to both Call-ID#inc and Call-ID#out.
6\. The CDF acknowledges the reception of the _Accounting-Request_ with
_Accounting-Record-Type_ indicating START_RECORD and opens a AS CDR.
7\. AS receives a mid-session (e.g. in order to modify media component(s)) Re-
INVITE or UPDATE from Incoming side (Call-ID#inc) for the IMS session (ICID).
8\. AS generates Re-INVITE or UPDATE towards Outgoing side (Call-ID#out)
9-10. AS sends 200 OK (Call-ID#inc) towards Incoming side, when 200 OK (Call-
ID#out) response is received from Outgoing side.
11\. AS sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
INTERIM_RECORD to record changes associated to Call-ID#inc or/and Call-ID#out
(e.g changed media component(s)) in the AS CDR for the IMS session (ICID).
12\. The CDF acknowledges the reception of the data and updates the AS CDR.
13\. AS receives BYE from Incoming side (Call-ID#inc)
14\. AS sends BYE towards Outgoing side (Call-ID#out)
15\. AS sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
STOP_RECORD to record stop of a session in the AS CDR for the IMS session
(ICID).
16\. The CDF acknowledges the reception of the data and closes the AS CDR.
17-18. AS sends 200 OK(Call-ID#inc) towards Incoming side, when 200 OK (Call-
ID#out) response is received from Outgoing side.
##### 5.2.2.1.21 Session Establishment for Roaming Architecture for Voice over
IMS with Local Breakout
The following figure shows the Diameter transactions initiated by the P-CSCF,
S-CSCF, IBCF, and Transit and Roaming Function towards the CDF that are
required for a Roaming Architecture for Voice over IMS with Local Breakout in
each IMS network during session establishment. This example pertains to the
flow in Annex M.3.1.3 in TS 23.228 [201] in which loopback and OMR procedures
are applied between the Visited Network and the Home Network serving UE A.
Figure 5.2.2.1.21-1: Message Sequence Chart for Roaming Architecture for Voice
over IMS with Local Breakout with "VPLMN routing" and TRF
1\. The session initiation is acknowledged by the 200 OK by the termination
side and received by the IBCF in the Visited Network A.
1a. IBCF sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of session with "Local GW Inserted" indication
and with information on the non-roaming NNI 5 used for interconnection towards
the terminating network.
1b. The CDF acknowledges the reception of the data and opens an IBCF CDR.
2\. The Visited Network A TRF performs the loopback procedure and the session
acknowledgement is routed towards the Home network through an IBCF .
2a. Transit and Roaming Function sends _Accounting-Request_ with _Accounting-
Record-Type_ indicating START_RECORD to record start of session and indicating
loopback routing from the roaming NNI.
2b. The CDF acknowledges the reception of the data and opens a TRF CDR.
2c. IBCF sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of session with "Local GW Not Inserted"
indication and with information on the roaming NNI 4 interconnecting to the
intermediate network for the loopback path.
2d. The CDF acknowledges the reception of the data and opens an IBCF CDR.
2e. IBCF sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of session with "Local GW Not Inserted"
indication and with information on the roaming NNI 3 interconnecting to the
intermediate network for the loopback path.
2f. The CDF acknowledges the reception of the data and opens an IBCF CDR.
3\. The S-CSCF in the Home Network A routes the session acknowledgement
towards the Visited Network A through an IBCF.
3a. S-CSCF sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of session and indicating loopback routing to the
roaming NNI.
3b. The CDF acknowledges the reception of the data and opens an IBCF CDR.
3c. IBCF sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of session with "Local GW Not Inserted"
indication and with information on the roaming NNI 2 interconnecting to the
intermediate network for the non-loopback path.
3d. The CDF acknowledges the reception of the data and opens an IBCF CDR.
3e. IBCF sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of session with "Local GW Not Inserted"
indication and with information on the roaming NNI 1 interconnecting to the
intermediate network for the non-loopback path.
3f. The CDF acknowledges the reception of the data and opens an IBCF CDR.
3g. P-CSCF sends _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of session.
3h. The CDF acknowledges the reception of the data and opens an IBCF CDR.
##### 5.2.2.1.22 Service Continuity using ATCF
Service Continuity using ATCF is specified in TS 23.237 [407].
Alternative "OneChargingSession"option is also reflected in the different
flows description, i.e a single charging session from ATCF.
###### 5.2.2.1.22.1 UE originating call (CS only) through ATCF
In this flow, Call-ID #1 is for serving leg and Call-ID #2 is for home leg of
CS access leg.
Figure 5.2.2.1.22.1-1: Message Sequence Chart UE originating call (CS only)
through ATCF
1\. The SCC session is initiatedby UE#1 sending a Call Setup.
2\. After processing at CS/PS intermediate nodes, the resulting INVITE goes
through the ATCF in the UE#1 serving network.
3\. The ATCF may decide whether to anchor the media session, and allocate if
needed, ATGW resources to it.
4\. The ATCF create an INVITE request message and send it to the UE#1 Home
Network SCC AS
5\. The call setup proceeds and is routed to the remote UE-2
6-7. On response 200 OK from the remote UE#2, response 200 OK is transmitted
to UE#1 serving network
8\. Upon reception of the final response, the ATCF sends an _Accounting-
Request_ with _Accounting-Record-Type_ indicating START_RECORD to record start
of a user session/media component in the ATCF CDR for the IMS session.
9-10. The CDF from the Serving network opens an ATCF CDR for the home leg
(Call-ID#2) and acknowledges the reception of the data.
9a-10. Alternatively, when "OneChargingSession", the CDF opens an ATCF CDR
related to the IMS session, with serving leg and home leg, and acknowledges
the reception of the data.
11-12. The final response to SIP Invite (Call ID #1) is transmitted.
13-15. Same as 8-9-10 but opening a ATCF CDR for the serving leg (Call-ID#1)
> Steps 13 to 15 are not applicable for the "OneChargingSession" option.
###### 5.2.2.1.22.1A UE originating call (PS only) through ATCF
Figure 5.2.2.1.22.1A -1: Message Sequence Chart UE originating call (PS only)
through ATCF
1\. The SCC session is initiated by UE#1 sending an INVITE.
2\. After processing at P-CSCF, the resulting INVITE goes through the ATCF in
the UE#1 Visited Network.
3\. The ATCF may decide whether to anchor the media session, and allocate if
needed, ATGW resources to it.
4\. The ATCF forwards the INVITE request message to the UE#1 Home Network SCC
AS.
5\. The call setup proceeds and is routed to the remote UE#2.
6-7 On response 200 OK from the remote UE#2, response 200 OK is transmitted to
UE#1 Visited Network.
8\. Upon reception of the final response, the ATCF sends an _Accounting-
Request_ with _Accounting-Record-Type_ indicating START_RECORD to record start
of a user session/media component in the ATCF CDR for the IMS session.
9-10. The CDF from UE#1 Visited Network opens an ATCF CDR and acknowledges the
reception of the data.
11-12. The final response to SIP Invite is transmitted.
###### 5.2.2.1.22.2 UE terminating call (CS only) through ATCF
In this flow, Call-ID #1 is for serving leg and Call-ID #2 is for home leg.
Figure 5.2.2.1.22.2-1: Message Sequence Chart UE terminating call (CS only)
through ATCF
1\. The SCC session is initiated by UE #2 sending an INVITE towards UE-1
2\. The call setup proceeds and is routed to the UE-1
3\. The ATCF may decide whether to anchor the media session, and allocate if
needed, ATGW resources to it.
4\. The ATCF create an INVITE request message and send it to the CS/PS
intermediate nodes.
5\. After processing at CS/PS intermediate nodes, the resulting message is
sent to UE #1.
6\. The response is transmitted to CS/PS intermediate nodes.
7\. After processing at CS/PS intermediate nodes, the 200 OK message is sent
to ATCF.
8\. Upon reception of the final response, the ATCF in the terminating network
sends an _Accounting-Request_ with _Accounting-Record-Type_ indicating
START_RECORD to record start of a user session/media component in the ATCF
CDR.
9-10. The CDF from the Terminating serving network opens an ATCF CDR for the
serving leg (Call ID #1) and acknowledges the reception of the data.
9a-10 Alternatively, when "OneChargingSession", the CDF opens a ATCF CDR
related to the IMS session (ICID) with serving leg and home leg, and
acknowledges the reception of the data.
11-12. The final response to SIP Invite (Call ID #2) is transmitted.
13-15. Same as 8-9-10 but for the home leg (Call ID #2).
> Steps 13 to 15 are not applicable for the "OneChargingSession" option.
###### 5.2.2.1.22.2A UE terminating call (PS only) through ATCF
Figure 5.2.2.1.22.2A-1: Message Sequence Chart UE terminating call (PS only)
through ATCF
1\. The SCC session is initiated by UE #2 sending an INVITE towards UE#1.
2\. The call setup proceeds and is routed to the UE#1.
3\. The ATCF may decide whether to anchor the media session, and allocate if
needed, ATGW resources to it.
4\. The ATCF forwards the INVITE request message to the P-CSCF.
5\. After processing at P-CSCF, the resulting message is sent to UE #1.
6\. The response is transmitted to P-CSCF.
7\. After processing at P-CSCF, the 200 OK is sent to ATCF.
8\. Upon reception of the final response, the ATCF sends an _Accounting-
Request_ with _Accounting-Record-Type_ indicating START_RECORD to record start
of a user session/media component in the ATCF CDR.
9-10. The CDF from UE#1 Visited Network opens an ATCF CDR and acknowledges the
reception of the data.
11-12. The final response to SIP Invite is transmitted.
###### 5.2.2.1.22.3 UE session transfer PS to CS using ATCF
In this flow, Call-ID #1 is for PS access leg, Call-ID #1\' for serving leg of
CS access leg and Call-ID #2\' for home leg of CS access leg.
Figure 5.2.2.1.22.3-1: Message Sequence Chart UE session transfer PS to CS
using ATCF
1\. UE has an ongoing session under PS with media anchored in ATGW, and
interactions between UE, RAN, MME/SGSN and MSC take place for session transfer
to CS.
2\. MSC server sends the resulting INVITE towards the ATCF in the UE#1 serving
network.
3\. The media session is anchored in ATGW: the ATCF updates the ATGW with new
CS access leg resource.
4\. The ATCF sends 200 OK answer to MSC server for switching the media path.
5-7. the ATCF sends an _Accounting-Request_ with _Accounting-Record-Type_
indicating START_RECORD to record start of a user session/media component in
the ATCF CDR for the serving leg of new CS access leg.
5-6a-7. Alternatively, when "OneChargingSession", the ATCF sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of the ATCF CDR with the serving leg of new CS access
leg. The CDF updates ATCF CDR related to the IMS session, with new serving
leg, and acknowledges the reception of the data.
8\. ACK from MSC server to ATCF
9\. The ATCF creates and sends a SIP INVITE request via a new dialog to the
SCC AS for indicating the transfer has taken place.
10\. The SCC AS sends a 200 OK confirmation response to the ATCF containing
SDP answer stored during the original session establishment procedure.
11-13. The ATCF sends an _Accounting-Request_ with _Accounting-Record-Type_
indicating START _RECORD to record start of a user session/media component in
the ATCF CDR for home leg of new CS access leg.
11-12a-13 Alternatively, when "OneChargingSession", the ATCF sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of the ATCF CDR with the home leg of new CS access leg.
The CDF updates ATCF CDR related to the IMS session, with new home leg, and
acknowledges the reception of the data.
14\. The ACTF acknowledges the 200 OK.
15, 19-20 The SCC AS terminates the old PS access leg, by sending a SIP BYE
request.
16-18. The ATCF sends an _Accounting-Request_ with _Accounting-Record-Type_
indicating STOP_RECORD to close the ATCF CDR for the old PS access leg
(conducted for both serving and home leg of the old PS access leg if flow
5.2.2.1.22.4 precedes for the same session).
> Steps 16 to 18 are not applicable for the "OneChargingSession" option.
###### 5.2.2.1.22.4 UE session transfer CS to PS using ATCF
In this flow, Call-ID#1 for serving leg of old CS access leg and Call-ID#2 for
home leg of old CS access leg, Call-ID#1\' is for serving leg of new PS access
leg, and Call-ID#2\' is for home leg of new PS access leg.
Figure 5.2.2.1.22.4-1: Message Sequence Chart UE session transfer CS to PS
using ATCF
1\. UE has an ongoing session under CS with media anchored in ATGW, and
interactions between UE, RAN, MME/SGSN and MSC take place for session transfer
to PS.
2\. Transfer preparation procedure between MSC server and ATCF, the MSC
interacts with UE for handover.
3\. The MSC server sends a SIP INFO request containing a session transfer
preparation to the ATCF to instruct the ATCF that media should be switched to
the new access leg.
4\. The ATCF sends 200 OK answer to MSC server for switching the media path..
5-6. UE A sends an SIP INVITE request towards the ATCF to move the session
control to the PS access.
7,11. The ATCF sends a 200 OK response to the UE.
8-10. The ATCF sends an _Accounting-Request_ with _Accounting-Record-Type_
indicating START_RECORD to record start of a user session in the ATCF CDR for
the serving leg of the new PS access leg.
8-9a -10. Alternatively, when "OneChargingSession", the ATCF sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of the ATCF CDR with the serving leg of new PS access
leg. The CDF updates ATCF CDR related to the IMS session, with new serving
leg, and acknowledges the reception of the data.
12-13. UE acknowledges the 200 OK.
14\. The ATCF creates and sends a SIP INVITE request via a new dialog to the
SCC AS for indicating the transfer has taken place.
15\. The SCC AS sends a 200 OK confirmation response to the ATCF containing
SDP answer stored during the original session establishment procedure.
16-18. The ATCF sends an _Accounting-Request_ with _Accounting-Record-Type_
indicating START_RECORD to record start of a user session in the ATCF CDR for
the home leg of the new PS access leg.
16-17a -18. Alternatively, when "OneChargingSession", the ATCF sends an
_Accounting-Request_ with _Accounting-Record-Type_ indicating INTERIM_RECORD
to record modification of the ATCF CDR with the home leg of new PS access leg.
The CDF updates ATCF CDR related to the IMS session, with new home leg, and
acknowledges the reception of the data.
20, 27 The SCC AS terminates the old CS access leg, by sending a SIP BYE
request.
21-23. The ATCF sends an _Accounting-Request_ with _Accounting-Record-Type_
indicating STOP_RECORD to close the ATCF CDR for the serving leg of old CS
access leg.
24-26. The ATCF sends an _Accounting-Request_ with _Accounting-Record-Type_
indicating STOP_RECORD to close the ATCF CDR for the home leg of old CS access
leg.
> Steps 21 to 26 are not applicable for the "OneChargingSession" option.
#### 5.2.2.2 Message Flows - Error Cases and Scenarios
This clause describes various error cases and how these should be handled. The
error cases are grouped into the following categories:
â€¢ Failure in SIP related procedures:
\- Session Related error scenarios;
\- Session Unrelated error scenarios.
â€¢ Errors in Diameter (Accounting) related procedures.
##### 5.2.2.2.1 Session Related SIP procedures- Reception of SIP error
messages
A SIP session is closed abnormally by the reception of a BYE message
indicating the reason for such termination.
In this case, an ACR [stop] message that includes an appropriate error
indication is sent.
##### 5.2.2.2.2 Session Related SIP procedures - SIP session failure
All nodes involved in the SIP session are expected to exercise some kind of
session supervision. In case a node detects an error in the SIP session, such
as a timeout or the occurrence of an invalid SIP message that results in the
inability to maintain the session, this IMS node will generate a BYE message
towards both ends of the connection.
The node that sent the BYE to trigger session termination identifies the cause
of the failure in the ACR [stop] towards the CDF. All other nodes, i.e. those
that receive the BYE, are not aware of an error, and therefore they treat this
situation as any normal SIP session termination.
##### 5.2.2.2.3 Session Unrelated SIP procedures
As described in clause 5.1.2.1.2, a session unrelated SIP procedure may either
be completed with the reception of a 200OK, or a SIP error message. If the
latter occurs, i.e. there is a failure in the procedure, the ACR [event] sent
towards the CDF includes an appropriate error indication.
##### 5.2.2.2.4 CDF connection failure
When the connection towards the primary CDF is broken, the process of sending
accounting information should continue towards a secondary CDF (if such a CDF
is configured). For further CDF connection failure functionality, see clause
\"_Transport Failure Detection_ \" in IETF RFC 3588 [401].
If no CDF is reachable the network element may buffer the generated accounting
data in non-volatile memory. Once the CDF connection is working again, all
accounting messages stored in the buffer is sent to the CDF, in the order they
were stored in the buffer.
##### 5.2.2.2.5 No reply from CDF
In case an IMS node does not receive an ACA in reply to an ACR, it may repeat
the ACR message. The waiting time until a repetition is sent, and the maximum
number of repetitions are both configurable by the operator. When the maximum
number of repetitions is reached and still no ACA reply has been received, the
IMS node executes the CDF connection failure procedure as specified above.
If retransmitted ACRs are sent, they are marked with the T-flag as described
in IETF RFC 3588 [401] , in order to allow duplicate detection in the CDF, as
specified in the next clause.
##### 5.2.2.2.6 Duplicate detection
A Diameter client marks possible duplicate request messages (e.g.
retransmission due to the link failover process) with the T-flag as described
in IETF RFC 3588 [401].
If the CDF receives a message that is marked as retransmitted and this message
was already received, then it discards the duplicate message. However, if the
original of the re-transmitted message was not yet received, it is the
information in the marked message that is taken into account when generating
the CDR. The CDRs are marked if information from duplicated message(s) is
used.
##### 5.2.2.2.7 CDF detected failure
The CDF closes a CDR when it detects that expected Diameter ACRs for a
particular SIP session have not been received for a period of time. The exact
behaviour of the CDF is operator configurable.
### 5.2.3 CDR generation
Editor's Note: FFS
### 5.2.4 GTP' record transfer flows
GTP' is not used between CDF and CGF for IMS offline charging because CDF and
CGF are combined into CCF (see clause 4.2).
NOTE: Vendors may nevertheless implement a separate CDF and CGF for IMS
offline charging. In this case, it is recommended that the approach chosen
conforms to the principles and protocol applications specified in TS 32.295
[54].
### 5.2.5 Bi CDR file transfer
The CGF will receive charging events from each AS involved in a SIP dialog.
This may result in multiple CDRs, some of these CDRs may be redundant for
billing purposes. When preparing these CDRs for the BD, the CGF may elect not
to send some CDRs or may perform consolidation before transfer based on the
operator\'s configuration.
## 5.3 IMS Online Charging Scenarios
### 5.3.1 Basic Principles
IMS online charging uses the Credit Control application that is specified in
TS 32.299 [50].
Three cases for online charging are distinguished:
â€¢ Immediate Event Charging (IEC); and
â€¢ event charging with unit reservation (ECUR), and
  * Session Charging with Unit Reservation (SCUR)
Both stage 2 and stage 3 mechanisms for the three cases for online charging
are detailed in TS 32.299 [50].
In the case of Immediate Event Charging (IEC), granting units to the IMS
network element is performed in a single operation that also includes the
deduction of the corresponding monetary units from the subscriber\'s account.
The charging process is controlled by the corresponding credit control request
which is sent for a given credit control event.
In contrast, Event Charging with Unit Reservation (ECUR) also includes the
process of requesting, reserving, releasing and returning unused units for
events. The deduction of the corresponding monetary units then occurs upon
conclusion of the ECUR transaction. In this case, the credit control request
is used to control the credit control session.
Session Charging with Unit Reservation (SCUR) is used for credit control of
sessions. SCUR also includes the process of requesting, reserving, releasing
and returning unused units for sessions, and the deduction of the
corresponding monetary units. During a SIP session there can be repeated
execution of unit reservation and debit operations as specified in TS 32.299
[50].
The IMS network element may apply IEC, where CCR event messages are generated,
or ECUR, using CCR Initial, and Termination or SCUR. The decision whether to
apply IEC, ECUR or SCUR is based on the service and/or operator\'s policy.
The CTF uses CCR Initial, Update, Terminate in procedures related to
successful SIP sessions. It uses CCR events (Event or Initial, Terminate
depending on whether IEC or ECUR/SCUR applies) for unsuccessful SIP sessions
and for session unrelated procedures. Further details are specified in the
tables below.
It is operator configurable in the nodes for which SIP method a _Credit
Control Request_ is sent. The table below describes all possible CCRs that
might be sent from an IMS GWF or an MRFC or an application server.
It is configurable for the operators to enable or disable the generation of a
CCR message by the IMS node in response to a particular \"triggering SIP
method\".
Table 5.3.1.1: Credit Control Request messages triggered by SIP Methods for
IMS-GWF or AS
* * *
Diameter message Triggering SIP Method CCR [Initial] SIP INVITE (SCUR) SIP
NOTIFY (ECUR) SIP MESSAGE (ECUR) SIP REGISTER (ECUR) SIP SUBSCRIBE (ECUR) SIP
REFER (ECUR) SIP PUBLISH (ECUR) CCR [Update] SIP 2xx acknowledging a SIP
INVITE, RE-INVITE or SIP UPDATE [e.g. change in media components] (SCUR) RE-
INVITE or SIP UPDATE [e.g. change in media components] (SCUR) Expiration of
quota, Validity time expiry or other authorization triggers (quota threshold
reached, ...). (SCUR) Any SIP message (except those triggering a CCR INITIAL
or those not covered by the above triggers for CCR UPDATE) conveying a SDP
offer or its associated SDP answer before SIP session establishment (SCUR) SIP
1xx provisional response, mid-dialog requests, mid-dialog responses and SIP
INFO embedding RTTI XML body SIP Response (4xx, 5xx or 6xx), indicating an
unsuccessful SIP RE-INVITE or SIP UPDATE (SCUR) CCR [Terminate] SIP BYE
message (both normal and abnormal session termination cases) (SCUR) SIP 2xx
acknowledging non-session related SIP messages (ECUR) Aborting a SIP session
set-up procedure, using an internal trigger, or a SIP CANCEL.(SCUR/ECUR)
Deregistration (see NOTE) (SCUR/ECUR) SIP Final/Redirection Response 3xx
(SCUR/ECUR) SIP Final Response (4xx, 5xx or 6xx), indicating an unsuccessful
SIP session set-up procedure (SCUR) SIP Final Response (4xx, 5xx or 6xx),
indicating an unsuccessful session-unrelated procedure (ECUR) CCR [Event] SIP
NOTIFY (IEC) SIP MESSAGE (IEC) SIP REGISTER (IEC) SIP SUBSCRIBE (IEC) SIP
REFER (IEC) SIP PUBLISH (IEC) SIP Final Response (4xx, 5xx or 6xx), indicating
an unsuccessful session-unrelated procedure (IEC)
* * *
Table 5.3.1.2: Credit Control Request messages triggered by SIP Methods for
MRFC
* * *
Diameter message Triggering SIP Method CCR [Initial] SIP INVITE(SCUR) for
initiating a multimedia ad hoc conferencing session CCR [Update] SIP RE-INVITE
or SIP UPDATE[e.g. change in media components](SCUR) SIP BYE message
Expiration of quota, Validity time expiry or other authorization triggers
(quota threshold reached, ...). (SCUR) CCR [Terminate] SIP BYE message(both
normal and abnormal session termination cases)(SCUR) SIP Final Response with
error codes 4xx, 5xx or 6xx indicating termination of an ongoing session(SCUR)
SIP CANCEL(SCUR)
* * *
### 5.3.2 Diameter Message Flows and Types
This clause describes the message flows for the event charging procedures on
the Ro interface. The IMS functions providing online charging _via_ the Ro
interface are the S-CSCF with IMS GWF, the AS and the MRFC.
NOTE: The following subclauses only show the scenarios of the S-CSCF with IMS-
GWF case and the AS case. The scenarios of the MRFC are FFS.
#### 5.3.2.1 Immediate Event Charging (IEC)
This clause provides the details of the \"Debit Units\" operation specified in
TS 32.299 [50].
##### 5.3.2.1.1 Message Flows - Successful Cases and Scenarios
###### 5.3.2.1.1.1 IEC -- Debit Units Operation
The transactions that are required on the Ro interface in order to perform IEC
with Debit Units operations are carried out as described in TS 32.299 [50]
where "CTF" refers to IMS network element. The Debit Units operation may
alternatively be carried out prior to, concurrently with or after
service/content delivery. the IMS network element must ensure that the
requested service execution is successful, when this scenario is used.
Editor's Note: Must be aligned with TS 32.299 [50].
###### 5.3.2.1.1.2 Scenarios
The following figure shows the Diameter credit control transactions that are
required between the IMS-GWF/AS and the OCS for session-unrelated IMS
procedures, i.e. those that relate to the CCR [event], as listed in Table
5.3.1.
SIP messages and Diameter transactions associated with these charging
scenarios are shown primarily for general information and to illustrate the
charging triggers. They are not intended to be exhaustive and depend on the
Diameter Credit Control Requests triggers configured by the operator.
##### **Scenario 1: Successful session unrelated case**
{#scenario-1-successful-session-unrelated-case .H6}
NOTE: The Debit Units operation is carried out prior to service/content
delivery.
1) A session unrelated SIP Request (e.g. SUBSCRIBE) is received in the S-CSCF.
The S-CSCF forwards this request to the IMS-GWF/AS.
2) The IMS-GWF/AS sends a Debit Unit Request (CC-Request-Type=EVENT_REQUEST)
to the OCS, requesting units in order to provide the service.
3) The OCS sends the Debit Unit Response to acknowledge the Debit Unit
Request, granting the requested units.
4) The IMS-GWF/AS and the S-CSCF forward the SIP Request.
Figure 5.3.2.1.1.2-1 : Message Sequence Chart for Session-Unrelated Procedure
##### 5.3.2.1.2 Message Flows - Error Cases and Scenarios
This clause describes various error cases and how these should be handled.
The failure handling behaviour is locally configurable in the IMS network
element. If the _Direct-Debiting-Failure-Handling_ AVP is not used, the
locally configured values are used instead.
###### 5.3.2.1.2.1 Reception of SIP Error Messages
If SIP errors in SIP response (4xx, 5xx or 6xx) occur during service delivery,
as defined in TS 24.228 [202] and TS 23.218 [203], it is up to the IMS network
element to determine to what extent the service was delivered before the error
occurred and act appropriately with respect to charging. This may imply that
no units at all (or no more units) are debited.
###### 5.3.2.1.2.2 Debit Units Operation Failure
This case comprises situations where either no, or an erroneous response, is
received from the OCS. The "no response" case is detected by the IMS network
element when the connection supervision timer Tx expires (IETF RFC 4006 [402])
before a response _Credit-Control-Answer_ (CCA) is received. The case of
receiving an erroneous response implies that the IMS network element receives
a _Credit-Control-Answer_ (CCA), which it is unable to process, while Tx is
running. The failure handling complies with the failure procedures for
\"Direct Debiting\" scenario described in IETF RFC 4006 [402].
###### 5.3.2.1.2.3 Duplicate Detection
The detection of duplicate request is needed and must be enabled. To speed up
and simplify as much as possible the duplicate detection, the all-against-all
record checking should be avoided and just those records marked as potential
duplicates need to be checked against other received requests (within a
reasonable time window) by the receiver entity.
The IMS network element marks the request messages that are retransmitted
after a link failover as possible duplicates with the T-flag as described in
[201]. For optimized performance, uniqueness checking against other received
requests is only necessary for those records marked with the T-flag received
within a reasonable time window. This focused check is based on the inspection
of the _Session-Id_ and _CC-Request-Number_ AVP pairs.
#### 5.3.2.2 Event Charging with Unit Reservation (ECUR) and Session Charging
with Unit Reservation (SCUR)
This clause provides the details of the \"Reserve Units\" and \"Debit Units\"
operation specified in TS 32.299 [50].
##### 5.3.2.2.1 Message Flows - Successful Cases and Scenarios
###### 5.3.2.2.1.1 ECUR and SCUR - Reserve Units and Debit Units Operations
The transactions that are required on the Ro interface in order to perform
ECUR/SCUR with Reserve Units and Debit Units operations is carried out as
described in TS 32.299 [50] where "CTF" refers to an IMS network element.
Multiple replications of both of these operations are possible.
###### 5.3.2.2.1.2 Expiration of Reservation Validity
This clause defines how reserved units are returned, if not used, within a
reasonable time. It should be possible that both, reservation and SIP sessions
are cancelled or only the reservation is cancelled without removing the SIP
session.
###### 5.3.2.2.1.3 Scenarios
The following figure shows the Diameter credit control transactions that are
required between the IMS-GWF/AS and the OCS for session-related and session-
unrelated IMS procedures.
The SIP messages and Diameter transactions associated with these charging
scenarios are shown primarily for general information and to illustrate the
charging triggers. They are not intended to be exhaustive and they depend on
the Diameter Credit Control Requests triggers configured by the operator.
###### # 5.3.2.2.1.3.1 Session Related Procedures (SCUR)
**Scenario 1: Successful Session Establishment**
The following figure shows the Diameter credit control transactions that are
required in the IMS-GWF/AS during a SIP session establishment.
1) An initial SIP Invite Request is received in the S-CSCF. This request is
forwarded to the IMS-GWF/AS.
2) The IMS-GWF/AS sends a Reserve Unit Request (CC-Request-Type
=INITIAL_REQUEST) to the OCS requesting service units. The online credit
control session is initiated.
3) The OCS grants units in the Reserve Unit Response.
4) The IMS-GWF/AS and S-CSCF forward the initial INVITE.
5) A final response is received in the IMS-GWF/AS.
6) If the trigger is active, the 200 OK answer triggers a Reserve Unit Request
(CC-Request-Type =UPDATE_REQUEST) in the IMS-GWF/AS in order to update the
credit control session. New service units are requested. Also the used service
units (if any) are reported.
7) The OCS sends the Reserve Unit Response to acknowledge the Reserve Unit
Request. New service units are granted.
8) The final answer is forwarded.
    Figure 5.3.2.2.1.3.1-1: Message Sequence Chart for Successful
    Session Establishment
**Scenario 2 : Successful Session Establishment with Early Media Negotiation**
The following figure shows the Diameter transactions that are required in the
IMS-GWF/AS during a SIP session establishment in which SDP negotiation is
completed before a final response to the initial INVITE is exchanged.
1) An initial SDP offer is conveyed in a SIP INVITE message. The SIP INVITE
message received in the S-CSCF is forwarded to the IMS-GWF/AS.
2) In this example, the SDP offer is conveyed in a SIP request which implies
the start of the online session towards the OCS. The IMS-GWF/AS sends a
Reserve Unit Request (CC-Request-Type =INITIAL_REQUEST) to the OCS requesting
service units. The online credit control session is initiated.
3) The OCS grants units in the Reserve Unit Response.
4) The IMS-GWF/AS and S-CSCF forward the SIP Request conveying the SDP offer.
5) A non-final SIP message (e.g. a provisional reliable response) conveying an
SDP answer is received in the IMS-GWF/AS.
6) The received SDP answer triggers a Reserve Unit Request (CC-Request-Type
=UPDATE_REQUEST) in order to update the credit control session. New service
units are requested. Also the used service units (if any) are reported.
7) The OCS sends the Reserve Unit Response to acknowledge the Reserve Unit
Request. New service units are granted.
8) The SDP answer is forwarded.
Figure 5.3.2.2.1.3.1-2 : Message Sequence Chart for Session Establishment with
Early Media Negotiation
**Scenario 3 : Mid-Session Procedures**
The figure shows the Diameter transactions that are required in the IMS-GWF/AS
when receiving a SIP Re-iNVITE in mid-session, e.g. in order to modify media
component(s), or when the hold and resume procedure is executed.
1) A SIP RE-INVITE request is received in the S-CSCF. This request is
forwarded to the IMS-GWF/AS.
2) Upon receiving the SIP RE-INVITE request, the IMS-GWF/AS sends a Reserve
Unit Request (CC-Request-Type = UPDATE_REQUEST) to update the previously
initiated credit control session. New service units are requested. The used
service units (if any) are also reported.
3) The OCS grants new service units in the Reserve Unit Response.
4) The RE-INVITE request is forwarded.
5) The RE-INVITE request is acknowledged with a 200 OK.
6) If the trigger is active, the IMS-GWF/AS sends a Reserve Unit Request (CC-
Request-Type =UPDATE_REQUEST) to the OCS to update the credit control session.
New service units are requested. The used service units (if any) are also
reported.
7) The OCS grants new service units in the Reserve Unit Response.
8) The 200 OK message is forwarded.
    Figure 5.3.2.2.1.3.1-3 : Message Sequence Chart for Mid-Session
    Procedures
**Scenario 4: Session Release**
The following figure shows the Diameter transactions that are required in the
IMS-GWF/AS for a session release scenario.
1) A SIP session is released by sending a SIP BYE message. The S-CSCF forwards
this message to the IMS-GWF/AS.
2) Upon receiving the BYE message, the IMS-GWF/AS forwards the SIP BYE request
to the UE.
3) In case there is an ongoing online control session, the IMS-GWF/AS sends a
Reserve Unit Request (CC-Request-Type =TERMINATION_REQUEST) reporting the used
granted units.
4) The OCS sends a Reserve Unit Response. The online credit control session is
terminated.
5) The final answer to the Bye message is forwarded.
    Figure 5.3.2.2.1.3.1-4 : Message Sequence Chart for Session Release.
**Scenario 5: Successful Session Establishment with reception of RTTI
message**
The following figure shows the Diameter credit control transactions that are
required in the IMS-GWF/AS during a SIP session establishment when RTTI
message is received embedded in the SIP 200 OK.
1) An initial SIP Invite Request is received in the S-CSCF. This request is
forwarded to the IMS-GWF/AS.
2) The IMS-GWF/AS sends a Reserve Unit Request (CC-Request-Type
=INITIAL_REQUEST) to the OCS requesting service units. The online credit
control session is initiated.
3) The OCS grants units in the Reserve Unit Response.
4) The IMS-GWF/AS and S-CSCF forward the initial INVITE.
5) A final response is received in the IMS-GWF/AS, which embeds a RTTI XML
body.
6) If the trigger is active, the 200 OK answer triggers a Reserve Unit Request
(CC-Request-Type =UPDATE_REQUEST) in the IMS-GWF/AS in order to update the
credit control session and take into account the RTTI XML body within the SIP
200 OK (see NOTE). New service units are requested. Also the used service
units (if any) are reported.
7) The OCS sends the Reserve Unit Response to acknowledge the Reserve Unit
Request. New service units are granted.
8) The final answer is forwarded.
NOTE: The mapping of RTTI XML body on Tariff Information structure is
described in TS 32.280 [36].
Figure 5.3.2.2.1.3.1-5: Message Sequence Chart for Successful Session
Establishment with reception of RTTI message
###### # 5.3.2.2.1.3.2 Session Unrelated Procedures (ECUR)
**Scenario 1: Successful session unrelated procedure**
The following figure shows the Diameter transactions that are required in the
IMS-GWF/AS for a session unrelated procedure.
1) A session unrelated SIP Request (e.g. SUBSCRIBE) is received in the S-CSCF.
The S-CSCF forwards this request to the IMS-GWF/AS.
2) The IMS-GWF/AS sends a Reserve Unit Request (CC-Request-Type =
INITIAL_REQUEST) to initiate a credit control session. Service units are
requested to the OCS.
3) The OCS grants service units in the Reserve Unit Response.
4) The IMS-GWF/AS and the S-CSCF forward the SIP Request
5) Depending on the used SIP method, there might be additional signalling
between steps 4 and 5.
6) The SIP Request is acknowledged by a SIP Response.
7) The IMS-GWF/AS sends a Reserve Unit Request (CC-Request-
Type=TERMINATION_REQUEST) to the OCS. It also reports the used granted units.
8) The OCS sends a Reserve Unit Response to acknowledge the Reserve Unit
Request. The online credit control session is terminated.
9) The IMS-GWF/AS and S-CSCF forward the SIP Response.
Figure 5.3.2.2.1.3.2-1: Message Sequence Chart for Session-Unrelated
Procedures
##### 5.3.2.2.2 Message Flows - Error Cases and Scenarios
This clause describes various error cases and how these should be handled.
The failure handling behaviour is locally configurable in the IMS network
element. If _Credit-Control-Failure-Handling_ AVP is not used, the locally
configured values are used instead.
###### 5.3.2.2.2.1 Reception of SIP Error Messages
If SIP errors occur during service delivery, as defined in [202] and [203], it
is up to the IMS network element to determine to what extent the service was
delivered before the error occurred and act appropriately with respect to
charging. This may imply that no units at all (or no more units) are reserved
or debited.
###### 5.3.2.2.2.2 Reserve Units and Debit Units Operation Failure
This case comprises of OCS connection failure, and/or receiving error
responses from the OCS.
The IMS network element detects an OCS connection failure when the timer Tx
expires (IETF RFC 4006 [402]) or a transport failure is detected as defined in
IETF RFC 3588 [401]. The OCS also has the capability to detect failures when
the timer Ts (IETF RFC 3588 [401]) expires. The OCS should indicate the cause
of failure by setting the appropriate result code as defined in IETF RFC 3588
[401] and IETF RFC 4006 [402]. In any case, the failure handling of IMS
network element and OCS complies with the failure procedures for session based
credit control scenario described in IETF RFC 4006 [402].
###### 5.3.2.2.2.3 Duplicate Detection
For credit control duplicate detection is performed only for possible
duplicate event requests related to IEC as mentioned in clause 5.3.2.1.2.3, as
retransmission of ECUR/SCUR related credit control requests is not allowed.
###### 5.3.2.2.2.4 Aborted Session Setup
If a trigger occurs during session establishment to release a session during
the establishment procedure, the IMS Network Element shall initiate procedures
to cancel the session establishment as defined in TS 24.229 [204].\ On
completion of the cancellation procedure, the IMS Network Element shall close
the credit-control session (for SCUR and ECUR) indicating an appropriate cause
code.
#### 5.3.2.3 IMS Service Termination by OCS
Annex B describes several scenarios related to IMS service termination.
NOTE: The annex B only shows the scenario of the S-CSCF with IMS-GWF case.
For IMS session related scenarios charged by means of SCUR in the IMS-GWF,
Service Termination shall imply the rejection of a request for IMS session
establishment or the release of an established session that is possibly
associated to an online Diameter Charging Session.
For IMS session unrelated scenarios charged by means of ECUR in the IMS-GWF,
Service Termination shall imply the rejection of the SIP method triggering the
Reserve Unit Request as defined in TS 32.299 [50].
For IMS session unrelated scenarios charged by means of IEC prior to
service/content delivery in the IMS-GWF, Service Termination shall imply the
rejection of the SIP method triggering the Debit Unit Request as defined in TS
32.299 [50].
##### 5.3.2.3.1 Triggers on Ro interface which imply the termination of the
IMS service
The procedures in Ro interface which may trigger the IMS Service termination
are the following:
\- Reception of an unsuccessful Operation Result different from
DIAMETER_CREDIT_CONTROL_NOT_APPLICABLE (TS32.299 [50]) in the Debit and
Reserve Unit Response message.
\- Reception of an unsuccessful Result Code different from
DIAMETER_CREDIT_CONTROL_NOT_APPLICABLE (TS32.299 [50]) within the Multiple
Unit Operation in the Debit and Reserve Unit Response message when only one
instance of the Multiple Unit Operation field is used.
\- Execution of the Termination Action procedure as defined in TS32.299 [50]
when only one instance of the Multiple Unit Operation field is used.
\- Execution of the Failure Handling Procedures when the Failure Action is set
to 'Terminate' or 'Retry & Terminate'.
\- Reception in the IMS-GWF of an Abort-Session-Request Message from OCS.
In case either a Final-Unit-Indication or an erroneous Result-Code at Multiple
Unit Operation level trigger the IMS service termination and the charging is
based on ECUR or SCUR, the IMS-GWF shall close the Diameter online session by
sending a Debit Units and Reserve Units operation of Type 'Termination'.
Refer to TS 32.299 [50] for a detailed description of these procedures.
##### 5.3.2.3.2 Indication to the UE of the reason for IMS service release
As a result of Service Termination triggering in IMS-GWF, the IMS service
shall be denied to end-users. The network should provide an indication to UEs
of the reason the service has been released or rejected. The procedure shall
depend on:
\- The charged party.
The network should provide UEs with an indication of the reason the service
has been released or rejected. However, this reason shall depend on whether
the UE is the charged party or not. The premise is that only the charged party
should know that the IMS service is being rejected / released because of OCS
interaction.
\- IMS specific protocol issues as defined in TS 24.229 [204].
a) The IMS-GWF generates a non-2xx final SIP response as a result of the IMS
Service Termination procedure:
In this scenario, the Response Code of the SIP response shall indicate the
server understood the request but is refusing to fulfil it and that this
request should not be repeated. The SIP response may include additional
information about the cause to reject/release the IMS service. The presence of
this additional error information in the response shall be operator
configurable.
The additional information included in the SIP response may contain a SIP URI.
The UE may treat the SIP URI as if it were a Contact in a redirect and
generate a new INVITE, resulting, for example, in a recorded announcement
session being established.
b) The IMS-GWF generates a SIP request (e.g. SIP BYE or SIP CANCEL) as a
result of the IMS Service Termination procedure:
In this scenario, the IMS-GWF may include a 'Reason' field in the request
which provides additional information about the cause to reject/release the
IMS service. The presence of this additional information in the request shall
be operator configurable.
> In both scenarios, it shall also be operator configurable both per SIP
> Method and per Originating/Terminating side, the content of the additional
> error information sent to the UEs. This error information shall also be
> configurable based on the procedure in Ro interface which has triggered the
> release/rejection of the IMS service according to clause 5.3.2.3.1. In
> particular when the Service Termination is triggered by the reception of an
> unsuccessful Operation Result (different from
> DIAMETER_CREDIT_CONTROL_NOT_APPLICABLE as defined in TS 32.299 [50]) in the
> Debit and Reserve Unit Response message or the reception of an unsuccessful
> Result Code (different from DIAMETER_CREDIT_CONTROL_NOT_APPLICABLE as
> defined in TS 32.299 [50]) within the Multiple Unit Operation in the Debit
> and Reserve Unit Response message, the additional error information/reason
> shall also be configurable based on the Result Code received through Ro
> interface.
# 6 Definition of charging information
## 6.1 Data description for IMS offline charging
### 6.1.1 Rf Message contents
The IMS nodes generate accounting information that can be transferred from the
CTF to the CDF. For this purpose, IMS offline charging utilises the _Charging
Data Transfer_ that is specified in the 3GPP accounting application described
in TS 32.299 [50].
The _Charging Data Transfe_ r operation employs the _Charging Data Request_
and _Charging Data Response_ messages. The following table describes the use
of these messages for offline charging.
Table 6.1.1: Offline Charging Messages Reference Table
* * *
Command-Name Source Destination _Charging Data Request_ S-CSCF, I-CSCF,
P-CSCF, MRFC, MGCF, BGCF, IBCF, AS, E-CSCF, TF, TRF, ATCF CDF _Charging Data
Response_ CDF S-CSCF, I-CSCF, P-CSCF, MRFC, MGCF, BGCF, IBCF, AS, E-CSCF, TF,
TRF, ATCF
* * *
#### 6.1.1.1 Charging Data-Request Message
The following table illustrates the basic structure of a Diameter _Charging
Data-Request_ message as used for IMS offline charging.
Table 6.1.1.1: Charging Data Request Message Contents
* * *
Field Category Description Session Identifier M Described in 32.299 [50]
Originator Host M Described in 32.299 [50] Originator Domain M Described in
32.299 [50] Destination Domain M Described in 32.299 [50] Operation Type M
Described in 32.299 [50] Operation Number M Described in 32.299 [50] Operation
Identifier O~M~ The field corresponds to the unique operation identification.
User Name O~C~ This field contains the Private User Identity defined in TS
23.003 [104]. Destination Host O~C~ Described in 32.299 [50] Operation
Interval O~C~ TBD Origination State O~C~ TBD Origination Timestamp O~C~ This
field contains the time when the operation is requested. Proxy Information
O~C~ This field contains the parameter of the proxy. Route Information O~C~
This field contains the parameter of the route. Operation Token O~M~ This
field identifies the domain, subsystem, or service and release. Service
Information O~M~ This field holds the 3GPP specific IMS parameter, described
in 6.3.
* * *
#### 6.1.1.2 Charging Data Response Message
The following table illustrates the basic structure of a Diameter _Charging
Data Response_ message as used for IMS offline charging.
Table 6.1.1.2: Charging Data Response Message Contents
* * *
Field Category Description Session Identifier M This field identifies the
operation session. Operation Result M This field identifies the result of the
operation. Originator Host M This field contains the identification of the
source point of the operation and the realm of the operation originator.
Originator Domain M This field contains the realm of the operation originator.
Operation Type M This field defines the transfer type: event for event based
charging and start, interim, stop for session based charging. Operation Number
M This field contains the sequence number of the transferred messages.
Operation Identifier O~M~ The field corresponds to the unique operation
identification. User Name O~C~ The field contains the Private User Identity
defined in TS 23.003 [104].. Operation Interval O~C~ TBD Origination State
O~C~ TBD Origination Timestamp O~C~ This field contains the time when the
operation is requested. Proxy Information O~C~ This field contains the
parameter of the proxy.
* * *
### 6.1.2 GTP' message contents
Not applicable. Refer to subclause 5.2.4 for further information.
### 6.1.3 CDR Description on the Bi Interface
#### 6.1.3.1 CDR Field Types
The following Standard CDR content and format are considered:
S-CSCF-CDR generated based on information from the S-CSCF
I-CSCF-CDR generated based on information from the I-CSCF
P-CSCF-CDR generated based on information from the P-CSCF
BGCF-CDR generated based on information from the BGCF
IBCF-CDR generated based on information from the IBCF
MGCF-CDR generated based on information from the MGCF
MRFC-CDR generated based on information from the MRFC
AS-CDR generated based on information from the AS
E-CSCF-CDR generated based on information from the E-CSCF
TF-CDR generated based on information from the IMS Transit Functions
TRF-CDR generated based on information from the TRF
ATCF-CDR generated based on information from the ATCF
The content of each CDR type is defined in the tables in clauses 6.1.3.3 to
6.1.3.11. For each CDR type the field definition includes the field name,
category and description. The detailed field descriptions are provided in TS
32.298 [51].
Editor's Note: Equipment vendors shall be able to provide all of the fields
listed in the CDR content table in order to claim compliance with the present
document. However, since CDR processing and transport consume network
resources, operators may opt to eliminate some of the fields that are not
essential for their operation.
Editors note: Rephrase the above paragraph and ref. to 32.240
The CDF provides the CDRs at the Bi interface in the format and encoding
described in TS 32.298 [51]. Additional CDR formats and contents may be
available at the interface to the billing system to meet the requirements of
the billing system, these are outside of the scope of 3GPP standardisation.
#### 6.1.3.2 CDR Triggers
##### 6.1.3.2.1 Session related CDRs
Reflecting the usage of multimedia sessions IMS CDRs are generated by the CDF
on a per session level. In the scope of the present document the term
\"session\" refers always to a SIP session. The coherent media components are
reflected inside the session CDRs with a media component container comprising
of all the information necessary for the description of a media component.
Accounting information for SIP sessions is transferred from the CTF involved
in the session to the CDF using Charging Data Request start, interim and stop
messages. A session CDR is opened in the CDF upon reception of a Charging Data
Request [start] message. Partial CDRs may be generated upon reception of a
Charging Data Request [interim] message, which is sent by the network entity
towards the CDF due to a session modification procedure (i.e. change in
media). Session CDRs are updated, or partial CDRs are generated upon reception
of a Charging Data Request [Interim] message, which is sent by the network
entity due to expiration of the Charging Data Interim Interval. The CDF closes
the final session CDR upon reception of a Charging Data Request [stop]
message, which indicates that the SIP session is terminated. Further details
on triggers for the generation of IMS CDRs are specified in [1].
Accounting information for unsuccessful session set-up attempts may be sent by
the CTF to the CDF employing the Charging Data Request [event] message. The
behaviour of the CDF upon receiving Charging Data Request [event] messages is
specified in clause 6.1.3.2.2.
##### 6.1.3.2.2 Session unrelated CDRs
To reflect chargeable events not directly related to a session the CDF may
generate CDRs upon the occurrence of session unrelated SIP procedures, such as
registration respectively de-registration events. Accounting information for
SIP session-unrelated procedures is transferred from the IMS nodes involved in
the procedure to the CDF using Charging Data Request [event] messages. Session
unrelated CDRs are created in the CDF in a \"one-off\" action based on the
information contained in the Charging Data Request [event] message. One
session unrelated CDR is created in the CDF for each Charging Data Request
[event] message received, whereas the creation of partial CDRs is not
applicable for session unrelated CDRs. The cases for which the IMS nodes send
Charging Data Request [event] messages are listed per SIP procedure in table
5.2.1.1 and table 5.2.1.2.
Further details on triggers for the generation of IMS CDRs are specified in
clause 5.2.2.
#### 6.1.3.3 S-CSCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.3: Charging Data of S-CSCF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the S-CSCF is | | | | serving the Originating or | | | | the Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. In | | | | the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include one item with the | | | | value "unknown". | +----------------------------+----------+----------------------------+ | List of Associated URI | O~C~ | The list of non-barred | | | | public user identities | | | | (SIP URIs and/or TEL URIs) | | | | associated to the public | | | | user identity under | | | | registration. | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | For SIP transactions, | | | | except for registration, | | | | this field holds the | | | | address of the party | | | | (Public User ID or Public | | | | Service ID) to whom the | | | | SIP transaction is posted. | | | | | | | | For registration | | | | transactions, this field | | | | holds the Public User ID | | | | under registration. | +----------------------------+----------+----------------------------+ | Requested Party Address | O~C~ | For SIP transactions this | | | | field holds the address of | | | | the party (Public User ID | | | | or Public Service ID) to | | | | whom the SIP transaction | | | | was originally posted. | | | | | | | | This field is only present | | | | if different from the | | | | Called Party Address | | | | parameter. | +----------------------------+----------+----------------------------+ | Number Portability routing | O~C~ | This field includes | | information | | information on number | | | | portability after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network. | +----------------------------+----------+----------------------------+ | Carrier Select routing | O~C~ | This field includes | | information | | information on carrier | | | | select after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network. | +----------------------------+----------+----------------------------+ | List of Called Asserted | O~C~ | The address or addresses | | Identity | | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response. | +----------------------------+----------+----------------------------+ | Private User ID | O~C~ | This field holds the | | | | private user identity of | | | | the served party defined | | | | in TS 23.003 [104] , if | | | | available _._ | +----------------------------+----------+----------------------------+ | List of Subscription Id | O~M~ | Holds the public user | | | | identities of the served | | | | user | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp, which | | | | indicates the time at | | | | which the service was | | | | requested. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | This a grouped CDR field | | Information | | containing the fields: | | | | "Application Server | | | | Involved" and "Application | | | | Provided Called Parties". | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | Holds the ASs (if any) | | Involved | | identified by the SIP | | | | URIs. | +----------------------------+----------+----------------------------+ | Application Provided | O~C~ | Holds a list of the Called | | Called Parties | | party address(es), if the | | | | address(es) are determined | | | | by an AS (SIP URI, | | | | E.164...). | +----------------------------+----------+----------------------------+ | Status | Oc | Holds the abnormal status | | | | information of specific | | | | ASs (if any) when AS(s) | | | | respond 4xx/5xx or time | | | | out to S-CSCF during an | | | | IMS session. | +----------------------------+----------+----------------------------+ | List of Inter Operator | O~C~ | Holds the identification | | Identifiers | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | P-Charging-Vector header. | | | | This grouped field may | | | | occur several times in one | | | | CDR. | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. This | | | | field may occur several | | | | times in one CDR. Each | | | | occurrence represents | | | | transit IOI values | | | | received from the path | | | | inbound to or outbound | | | | from the S-CSCF. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by S-CSCF. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | GGSN Address | O~C~ | This parameter holds the | | | | control plane IP address | | | | of the GGSN that handles | | | | one or more media | | | | component(s) of an IMS | | | | session. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are: | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of one SIP | | | | P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | This field contains the | | ID | | IMS communication service | | | | identifier if received in | | | | the P-Asserted-Service | | | | header in the SIP request. | +----------------------------+----------+----------------------------+ | Online Charging Flag | O~C~ | This field indicates the | | | | Online Charging Request | | | | was sent based on the | | | | provided ECF address from | | | | the SIP P-header | | | | "P-Cha | | | | rging-Function-Addresses". | | | | | | | | NOTE: No proof that online | | | | charging action has been | | | | taken | +----------------------------+----------+----------------------------+ | Real Time Tariff | O~C~ | This field holds the | | Information | | tariff/add-on charge | | | | received. | +----------------------------+----------+----------------------------+ | User Location Info | O~C~ | This field contains the | | | | network provided location | | | | information for 3GPP | | | | accesses, if available. | +----------------------------+----------+----------------------------+ | MS Time Zone | O~C~ | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | NNI Information | Oc | This grouped field holds | | | | information about the NNI | | | | used for interconnection | | | | and roaming on the | | | | loopback routing path. It | | | | is present only if "VPLMN | | | | routing" is applied in a | | | | Roaming Architecture for | | | | Voice over IMS with Local | | | | breakout. | +----------------------------+----------+----------------------------+ | NNI Type | Oc | This field indicates usage | | | | of the roaming NNI for | | | | loopback routing, i.e | | | | S-CSCF performed the | | | | loopback decision. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | IMS Emergency Indication | O~C~ | This field indicates the | | | | registration is an | | | | emergency registration or | | | | the IMS session is an IMS | | | | emergency session, and is | | | | present only for emergency | | | | cases. | +----------------------------+----------+----------------------------+ | IMS Visited Network | O~C~ | Contains the information | | Identifier | | from the SIP | | | | P-Visited-Network-ID | | | | header received in a | | | | REGISTER request. | +----------------------------+----------+----------------------------+ | SIP Route header received | O~C~ | Contains the information | | | | in the topmost route | | | | header in a received | | | | initial SIP INVITE or | | | | non-session related SIP | | | | MESSAGE request prior to | | | | triggering of any | | | | application servers. This | | | | field is present only for | | | | requests from the served | | | | user. | +----------------------------+----------+----------------------------+ | SIP Route header | O~C~ | Contains the information | | transmitted | | in the route header | | | | representing the | | | | destination in a | | | | transmitted initial SIP | | | | INVITE or non-session | | | | related SIP MESSAGE | | | | request following | | | | triggering of all | | | | application servers. This | | | | field is present for | | | | requests toward the served | | | | user and for requests from | | | | the served user when | | | | "VPLMN routing" is applied | | | | in a Roaming Architecture | | | | for Voice over IMS with | | | | Local breakout. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
#### 6.1.3.4 P-CSCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.4: Charging Data of P-CSCF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR. | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the P-CSCF is | | | | serving the Originating or | | | | the Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address (Public User | | Address | | ID or Public Service ID) | | | | of the party requesting a | | | | service or initiating a | | | | session. In the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include one item with the | | | | value "unknown" | | | | | | | | Note: For P-CSCF, only one | | | | address is present | +----------------------------+----------+----------------------------+ | List of Associated URI | O~C~ | The list of non-barred | | | | public user identities | | | | (SIP URIs and/or TEL URIs) | | | | associated to the public | | | | user identity under | | | | registration. | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | In the context of an | | | | end-to-end SIP transaction | | | | this field holds the | | | | address of the party | | | | (Public User ID) to whom | | | | the SIP transaction is | | | | posted. For emergency | | | | calls, this parameter | | | | could contain an URN. | +----------------------------+----------+----------------------------+ | **List of Called Asserted |** O~C~**|** The address or addresses | | Identity**| | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response.** | +----------------------------+----------+----------------------------+ | Served Party IP Address | O~M~ | This field contains the IP | | | | address of either the | | | | calling or called party, | | | | depending on whether the | | | | P-CSCF is in touch with | | | | the calling or called | | | | network. | +----------------------------+----------+----------------------------+ | Private User ID | **O~C~** | This field holds the | | | | private user identity of | | | | the served party defined | | | | in TS 23.003 [104], if | | | | available. | +----------------------------+----------+----------------------------+ | List of Subscription Id | O~M~ | Holds the public user | | | | identities of the served | | | | user. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp, which | | | | indicates the time at | | | | which the service was | | | | requested. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. | | | | Present with Charging Data | | | | Request [Stop]. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Inter Operator Identifiers | O~C~ | Holds the identification | | | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | _P-Charging-Vector | | | | header._ | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by this node. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | Related IMS Charging | O~C~ | This parameter holds the | | Identifier | | Related IMS charging | | | | identifier when the | | | | session is the target | | | | access leg in an SRVCC CS | | | | to PS handover. The | | | | Related IMS charging | | | | identifier contains the | | | | IMS charging identifier as | | | | generated by the Enhanced | | | | MSC server. | +----------------------------+----------+----------------------------+ | Related IMS Charging | O~C~ | This parameter holds the | | Identifier Generation Node | | identifier of the Enhanced | | | | MSC server that generated | | | | the Related IMS charging | | | | identifier. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). This | | | | parameter corresponds to | | | | SIP Request Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. This | | | | parameter corresponds to | | | | SDP-Media-Name. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | | | | This parameter corresponds | | | | to SDP-Media-Description. | +----------------------------+----------+----------------------------+ | Local GW Inserted | O~C~ | This field indicates | | Indication | | whether the local IMS-AGW | | | | is inserted or not, for | | | | the media component | | | | included in SDP answer, if | | | | available. | +----------------------------+----------+----------------------------+ | IP realm Default | O~C~ | This field indicates | | Indication | | whether the User Plane IP | | | | realm associated to the | | | | media component included | | | | in SDP answer, is the | | | | Default IP realm or not, | | | | if available. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | GGSN Address | O~C~ | This parameter holds the | | | | control plane IP address | | | | of the GGSN that handles | | | | one or more media | | | | component(s) of a IMS | | | | session. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are: | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of one SIP | | | | P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | This field contains the | | ID | | IMS communication service | | | | identifier if received in | | | | the P-Asserted-Service | | | | header in the SIP request | | | | when the P-CSCF is serving | | | | the Terminating party or | | | | the topmost occurrence of | | | | the \"+g.3gpp.icsi-ref\" | | | | header field parameter of | | | | the Feature-Caps header in | | | | the SIP response when the | | | | P-CSCF is serving the | | | | Originating party. | +----------------------------+----------+----------------------------+ | IMS Application Reference | O~C~ | This field contains the | | ID | | IMS application reference | | | | identifier if received in | | | | the SIP request. | +----------------------------+----------+----------------------------+ | User Location Info | OC | This field contains the | | | | network provided location | | | | information for 3GPP | | | | accesses, if available.. | +----------------------------+----------+----------------------------+ | MS Time Zone | OC | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | IMS Emergency Indication | O~C~ | This field indicates the | | | | registration is an | | | | emergency registration or | | | | the IMS session is an IMS | | | | emergency session, and is | | | | present only for emergency | | | | cases. | +----------------------------+----------+----------------------------+ | IMS Visited Network | O~C~ | Contains the information | | Identifier | | from the SIP | | | | P-Visited-Network-ID | | | | header sent in a REGISTER | | | | request. | +----------------------------+----------+----------------------------+ | SIP Route header received | O~C~ | Contains the information | | | | in the topmost route | | | | header in a received | | | | initial SIP INVITE or | | | | non-session related SIP | | | | MESSAGE request. This | | | | field is used for SIP | | | | requests toward the served | | | | user. | +----------------------------+----------+----------------------------+ | SIP Route header | O~C~ | Contains the information | | transmitted | | in the route header | | | | representing the | | | | destination in a | | | | transmitted initial SIP | | | | INVITE or non-session | | | | related SIP MESSAGE | | | | request. This field is | | | | used for SIP requests from | | | | the served user. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
> Editor's Note: The SIP parameter from which the IMS Application Reference ID
> (IARI) is to be extracted requires further investigation in CT1. A mechanism
> to identify the IARI in use is ffs.
#### 6.1.3.5 I-CSCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.5: Charging Data of I-CSCF CDR
* * *
Field Category Description Record Type M Identifies the type of record. The
parameter is derived from the Node functionality parameter. Retransmission
O~C~ This parameter, when present, indicates that information from
retransmitted Charging Data Requests has been used in this CDR SIP Method O~C~
Specifies the SIP-method for which the CDR is generated. Only available in
session unrelated cases. Event O~C~ This field identifies the SIP event
package to which the SIP request is referred. Expires Information O~C~ This
field indicates the validity time of either the SIP message or its content,
depending on the SIP method. Role of node O~M~ This field indicates whether
the I-CSCF is serving the Originating or the Terminating party. Node Address
O~M~ This item holds the address of the node providing the information for the
CDR. This may either be the IP address or the FQDN of the IMS node generating
the accounting data. Session ID O~M~ The Session identification. For a SIP
session the Session-ID contains the SIP Call ID as defined in the Session
Initiation Protocol RFC 3261 [404]. Session Priority O~C~ The field contains
the priority of the session. List Of Calling Party Address O~M~ The address or
addresses (Public User ID or Public Service ID) of the party requesting a
service or initiating a session. In the case of no P-Asserted-Identify is
known, this list shall include one item with the value "unknown". List of
Associated URI O~C~ The list of non-barred public user identities (SIP URIs
and/or TEL URIs) associated to the public user identity under registration.
Called Party Address O~M~ In the context of an end-to-end SIP transaction this
field holds the address of the party (Public User ID) to whom the SIP
transaction is posted. **Number Portability routing information** **O~C~**
**This field includes information on number portability after DNS/ENUM request
from S-CSCF in the calling user's home network.** **Carrier Select routing
information** **O~C~** **This field includes information on carrier select
after DNS/ENUM request from S-CSCF in the calling user's home network.**
Service Request Time Stamp O~M~ This field contains the time stamp, which
indicates the time at which the service was requested. This parameter
corresponds to SIP Request Timestamp. Present with Charging Data Request
[Event]. Service Request Time Stamp Fraction O~M~ This parameter contains the
milliseconds fraction in relation to the Service Request Time Stamp. Inter
Operator Identifiers O~C~ Holds the identification of the home network
(originating and terminating) if exchanged via SIP signalling, as recorded in
the _P-Charging-Vector header._ Originating IOI O~C~ This parameter
corresponds to Orig-IOI header of the P-Charging-Vector defined in TS 24.229
[204]. Terminating IOI O~C~ This parameter corresponds to Term-IOI header of
the P-Charging-Vector defined in TS 24.229 [204]. Local Record Sequence Number
O~M~ This field includes a unique record number created by this node. The
number is allocated sequentially for each partial CDR (or whole CDR) including
all CDR types. The number is unique within the CDF. Cause For Record Closing
O~M~ This field contains a reason for the close of the CDR. Incomplete CDR
Indication O~C~ This field provides additional diagnostics when the CDF
detects missing Charging Data Requests. S-CSCF Information O~C~ This field
contains Information related to the serving CSCF, e.g. the S-CSCF capabilities
upon registration event or the S-CSCF address upon the session establishment
event. IMS Charging Identifier O~M~ This parameter holds the IMS charging
identifier (ICID) as generated by the IMS node for the SIP session. Service
Reason Return Code O~M~ This parameter provides the returned SIP status code
for the service request for the successful and failure case, Access Network
Information O~C~ This field contains the content of one SIP P-header
"P-Access-Network-Info" if available. Service Context Id O~M~ Holds the
context information to which the CDR belongs. The information is obtained from
the Operation Token of the Charging Data Request message. User Location Info
O~C~ This field contains the network provided location information for 3GPP
accesses, if available.. MS Time Zone O~C~ This field indicates the offset
between universal time and local time in steps of 15 minutes of where the MS
currently resides. From Address O~M~ Contains the information from the SIP
From header. IMS Emergency Indication O~C~ This field indicates the
registration is an emergency registration, and is present only for emergency
registrations. SIP Route header transmitted O~C~ Contains the information in
the route header representing the destination in a transmitted initial SIP
INVITE or non-session related SIP MESSAGE request. Record Extensions O~C~ A
set of operator/manufacturer specific extensions to the record, conditioned
upon existence of an extension.
* * *
#### 6.1.3.6 MRFC CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.6: Charging Data of MRFC CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR. | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Service ID | O~M~ | This field identifies the | | | | service the MRFC is | | | | hosting. For conferences | | | | the conference ID is used | | | | here. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. In | | | | the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include a one item with | | | | the value "unknown". | +----------------------------+----------+----------------------------+ | Called Party Address | O~C~ | For SIP transactions, | | | | except for registration, | | | | this field holds the | | | | address of the party | | | | (Public User ID or Public | | | | Service ID) to whom the | | | | SIP transaction is posted. | | | | | | | | For registration | | | | transactions, this field | | | | holds the Public User ID | | | | under registration. | +----------------------------+----------+----------------------------+ | Requested Party Address | O~C~ | For SIP transactions this | | | | field holds the address of | | | | the party (Public User ID | | | | or Public Service ID) to | | | | whom the SIP transaction | | | | was originally posted. | | | | | | | | This field is only present | | | | if different from the | | | | Called Party Address | | | | parameter. | +----------------------------+----------+----------------------------+ | List of Called Asserted | O~C~ | The address or addresses | | Identity | | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response. | +----------------------------+----------+----------------------------+ | List of Subscription Id | O~M~ | Holds the public user | | | | identities of the served | | | | user | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp which indicates | | | | the time at which the | | | | service was requested. | | | | This parameter corresponds | | | | to SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. This | | | | parameter corresponds to | | | | SIP Response Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [EVENT]. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. This | | | | parameter corresponds to | | | | SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Stop]. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | This is a grouped CDR | | Information | | field containing the | | | | fields: "Application | | | | Server Involved" and | | | | "Application Provided | | | | Called Parties". | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | Holds the ASs (if any) | | Involved | | identified by the SIP | | | | URIs. | +----------------------------+----------+----------------------------+ | Application Provided | O~C~ | Holds a list of the Called | | Called Parties | | party address(es), if the | | | | address(es) are determined | | | | by an AS (SIP URI, | | | | E.164...). | +----------------------------+----------+----------------------------+ | Inter Operator Identifiers | O~C~ | Holds the identification | | | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | _P-Charging-Vector | | | | header._ | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by this node. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). This | | | | parameter corresponds to | | | | SIP Request Timestamp in | | | | the Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | the time of the response | | | | to the SIP Request | | | | (usually a 200 OK). This | | | | parameter corresponds to | | | | SIP Response Timestamp In | | | | the Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. This | | | | parameter corresponds to | | | | SDP-Media-Name. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | GGSN Address | O~C~ | This parameter holds the | | | | control plane IP address | | | | of the GGSN that handles | | | | one or more media | | | | component(s) of a IMS | | | | session. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of one SIP | | | | P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | Online Charging Flag | O~C~ | This field indicates the | | | | Online Charging Request | | | | was sent based on the | | | | provided ECF address from | | | | the SIP P-header | | | | "P-Cha | | | | rging-Function-Addresses". | | | | | | | | NOTE: No proof that online | | | | charging action has been | | | | taken | +----------------------------+----------+----------------------------+ | User Location Info | O~C~ | This field contains the | | | | network provided location | | | | information for 3GPP | | | | accesses, if available.. | +----------------------------+----------+----------------------------+ | MS Time Zone | O~C~ | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
#### 6.1.3.7 MGCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.7: Charging Data of MGCF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the MGCF is | | | | serving the Originating or | | | | the Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. In | | | | the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include a one item with | | | | the value "unknown". | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | In the context of an | | | | end-to-end SIP transaction | | | | this field holds the | | | | address of the party | | | | (Public User ID) to whom | | | | the SIP transaction is | | | | posted. | +----------------------------+----------+----------------------------+ | **Number Portability |** O~C~**|** This field includes | | routing information**| | information on number | | | | portability after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network.** | +----------------------------+----------+----------------------------+ | **Carrier Select routing |** O~C~**|** This field includes | | information**| | information on carrier | | | | select after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network.** | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp which indicates | | | | the time at which the | | | | service was requested. | | | | This parameter corresponds | | | | to SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. This | | | | parameter corresponds to | | | | SIP Response Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. This | | | | parameter corresponds to | | | | SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Stop]. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Inter Operator Identifiers | O~C~ | Holds the identification | | | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | _P-Charging-Vector | | | | header._ | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by this node. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). This | | | | parameter corresponds to | | | | SIP Request Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. This | | | | parameter corresponds to | | | | SDP-Media-Name. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case. | +----------------------------+----------+----------------------------+ | Trunk Group ID | O~M~ | Contains the outgoing | | Incoming/Outgoing | | trunk group ID for an | | | | outgoing session/call or | | | | the incoming trunk group | | | | ID for an incoming | | | | session/call. | +----------------------------+----------+----------------------------+ | Bearer Service | O~M~ | Holds the used bearer | | | | service for the PSTN leg. | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of the SIP | | | | P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | Real Time Tariff | Oc | This field holds the | | Information | | tariff/add-on charge | | | | received. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
#### 6.1.3.8 BGCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.8: Charging Data of BGCF CDR
* * *
Field Category Description Record Type M Identifies the type of record. The
parameter is derived from the Node functionality parameter. Retransmission
O~C~ This parameter, when present, indicates that information from
retransmitted Charging Data Requests has been used in this CDR. SIP Method
O~C~ Specifies the SIP-method for which the CDR is generated. Only available
in session unrelated cases. Event O~C~ This field identifies the SIP event
package to which the SIP request is referred. Expires Information O~C~ This
field indicates the validity time of either the SIP message or its content,
depending on the SIP method. Role of node O~M~ This field indicates whether
the BGCF is serving the Originating or the Terminating party. Node Address
O~M~ This item holds the address of the node providing the information for the
CDR. This may either be the IP address or the FQDN of the IMS node generating
the accounting data. Session ID O~M~ The Session identification. For a SIP
session the Session-ID contains the SIP Call ID as defined in the Session
Initiation Protocol RFC 3261 [404]. Session Priority O~C~ The field contains
the priority of the session. List Of Calling Party Address O~M~ The address or
addresses (Public User ID or Public Service ID) of the party requesting a
service or initiating a session. In the case of no P-Asserted-Identify is
known, this list shall include a one item with the value "unknown". Called
Party Address O~M~ In the context of an end-to-end SIP transaction this field
holds the address of the party (Public User ID) to whom the SIP transaction is
posted. **Number Portability routing information** **O~C~** **This field
includes information on number portability after DNS/ENUM request from S-CSCF
in the calling user's home network.** **Carrier Select routing information**
**O~C~** **This field includes information on carrier select after DNS/ENUM
request from S-CSCF in the calling user's home network.** Service Request Time
Stamp O~M~ This field contains the time stamp which indicates the time at
which the service was requested. This parameter corresponds to SIP Request
Timestamp. Present with Charging Data Request [Start] and Charging Data
Request [Event]. Service Request Time Stamp Fraction O~M~ This parameter
contains the milliseconds fraction in relation to the Service Request Time
Stamp. Service Delivery Start Time Stamp O~M~ This field holds the time stamp
reflecting either: successful session set-up, a delivery unrelated service, an
unsuccessful session set-up and an unsuccessful session unrelated request.
This parameter corresponds to SIP Response Timestamp. Present with Charging
Data Request [Start] and Charging Data Request [Event]. Service Delivery Start
Time Stamp Fraction O~M~ This parameter contains the milliseconds fraction in
relation to the Service Delivery Start Time Stamp. Service Delivery End Time
Stamp O~C~ This field records the time at which the service delivery was
terminated. It is Present only in SIP session related case. This parameter
corresponds to SIP Request Timestamp. Present with Charging Data Request
[Stop]. Service Delivery End Time Stamp Fraction O~C~ This parameter contains
the milliseconds fraction in relation to the Service Delivery End Time Stamp.
Record Opening Time O~C~ A time stamp reflecting the time the CDF opened this
record. Present only in SIP session related case. Record Closure Time O~M~ A
Time stamp reflecting the time the CDF closed the record Inter Operator
Identifiers O~C~ Holds the identification of the home network (originating and
terminating) if exchanged via SIP signalling, as recorded in the _P-Charging-
Vector header._ Originating IOI O~C~ This parameter corresponds to Orig-IOI
header of the P-Charging-Vector defined in TS 24.229 [204]. Terminating IOI
O~C~ This parameter corresponds to Term-IOI header of the P-Charging-Vector
defined in TS 24.229 [204]. Transit IOI List Oc This parameter corresponds to
Transit-IOI List of the P-Charging-Vector defined in TS 24.229 [204]. Local
Record Sequence Number O~M~ This field includes a unique record number created
by this node. The number is allocated sequentially for each partial CDR (or
whole CDR) including all CDR types. The number is unique within the CDF.
Record Sequence Number O~C~ This field contains a running sequence number
employed to link the partial records generated by the CDF for a particular
session. Cause For Record Closing O~M~ This field contains a reason for the
close of the CDR. Incomplete CDR Indication O~C~ This field provides
additional diagnostics when the CDF detects missing Charging Data Requests.
IMS Charging Identifier O~M~ This parameter holds the IMS charging identifier
(ICID) as generated by the IMS node for the SIP session. Service Reason Return
Code O~M~ This parameter provides the returned SIP status code for the service
request for the successful and failure case, Access Network Information O~C~
This field contains the content of the SIP P-header "P-Access-Network-Info" if
available. Service Context Id O~M~ Holds the context information to which the
CDR belongs. The information is obtained from the Operation Token of the
Charging Data Request message. From Address O~M~ Contains the information from
the SIP From header. Record Extensions O~C~ A set of operator/manufacturer
specific extensions to the record, conditioned upon existence of an extension.
NNI Information Oc This grouped field holds information about the NNI used for
interconnection and roaming on the loopback routing path. It is present only
if RAVEL "VPLMN routing" is applied. NNI Type Oc This field indicates usage of
the roaming NNI for loopback routing, i.e BGCF performed the loopback
decision.
* * *
#### 6.1.3.9 SIP AS CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.9: Charging Data of AS CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the AS is serving | | | | the Originating or the | | | | Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. When the AS | | | | acts as B2BUA, the | | | | incoming session is | | | | identified , except for | | | | the "OneChargingSession" | | | | option, where it contains | | | | either the incoming or | | | | outgoing dialog SIP Call | | | | Id involved during IMS | | | | session setup. | +----------------------------+----------+----------------------------+ | Outgoing Session ID | O~C~ | When the AS acts as B2BUA, | | | | the outgoing session is | | | | identified by the Outgoing | | | | Session ID which contains | | | | the SIP Call ID (as | | | | defined in the RFC 3261 | | | | [404]). This field is | | | | not used for the | | | | "OneChargingSession" | | | | option | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. In | | | | the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include a one item with | | | | the value "unknown". | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | For SIP transactions, | | | | except for registration, | | | | this field holds the | | | | address of the party | | | | (Public User ID or Public | | | | Service ID) to whom the | | | | SIP transaction is posted. | | | | | | | | For registration | | | | transactions, this field | | | | holds the Public User ID | | | | under registration. | +----------------------------+----------+----------------------------+ | **Number Portability |** O~C~**|** This field includes | | routing information**| | information on number | | | | portability after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network.** | +----------------------------+----------+----------------------------+ | **Carrier Select routing |** O~C~**|** This field includes | | information**| | information on carrier | | | | select after DNS/ENUM | | | | request from S-CSCF in the | | | | calling user's home | | | | network.** | +----------------------------+----------+----------------------------+ | Alternate Charged Party | O~C~ | The address of an | | Address | | alternate party that is | | | | identified by the AS at | | | | session initiation, and is | | | | charged in place of the | | | | calling party. | +----------------------------+----------+----------------------------+ | List of Requested Party | O~C~ | This field is a list of | | Address | | Requested Party Address. | | | | | | | | Each occurrence contains: | | | | | | | | For SIP transactions ,the | | | | address of the party | | | | (Public User ID or Public | | | | Service ID) to whom the | | | | SIP transaction was | | | | originally posted. | | | | | | | | For PS to CS transfer, the | | | | Session Transfer Number | | | | for Single Radio Voice | | | | Call Continuity (STN-SR) | | | | as described in TS 23.237 | | | | [407]. | | | | | | | | For CS to PS transfer, the | | | | Session Transfer | | | | Identifier for CS to PS | | | | Single Radio Voice Call | | | | Continuity (STI-rSR) as | | | | described in TS 23.237 | | | | [407]. | | | | | | | | This field is only present | | | | if different from the | | | | Called Party Address | | | | parameter. | +----------------------------+----------+----------------------------+ | Private User ID | O~C~ | This field holds the | | | | private user identity of | | | | the served party defined | | | | in TS 23.003 [104], if | | | | available. | +----------------------------+----------+----------------------------+ | List of Subscription Id | O~M~ | Holds the public user | | | | identities of the served | | | | user | +----------------------------+----------+----------------------------+ | List of Called Asserted | O~C~ | The address or addresses | | Identity | | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp which indicates | | | | the time at which the | | | | service was requested. | | | | This parameter corresponds | | | | to SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. This | | | | parameter corresponds to | | | | SIP Response Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. This | | | | parameter corresponds to | | | | SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Stop]. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Inter Operator Identifiers | O~C~ | Holds the identification | | | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | _P-Charging-Vector | | | | header._ | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204] .This | | | | field may occur several | | | | times in one CDR. Each | | | | occurrence represents | | | | transit IOI values | | | | received from the path | | | | inbound to or outbound | | | | from the S-CSCF. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by this node. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | | | | | | | | When the AS acts as B2BUA | | | | and "OneChargingSession" | | | | option applies, only SDP | | | | media components received | | | | by the AS are included, | | | | i.e those generated by the | | | | AS are not included. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). This | | | | parameter corresponds to | | | | SIP Request Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | GGSN Address | O~C~ | This parameter holds the | | | | control plane IP address | | | | of the GGSN that handles | | | | one or more media | | | | component(s) of a IMS | | | | session. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | Service Specific Info | O~C~ | This is a grouped field | | | | that contains service | | | | specific data if and as | | | | provided by an Application | | | | Server. It may occur | | | | several times in one CDR. | +----------------------------+----------+----------------------------+ | Service Specific Data | O~M~ | This sub-field of Service | | | | Specific Data holds the | | | | value of the Service | | | | Specific Data. | +----------------------------+----------+----------------------------+ | Service Specific Type | O~M~ | This sub-field of Service | | | | Specific Data holds the | | | | type of the Service | | | | Specific Data. | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are : | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of the first | | | | available SIP P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | List of Access Transfer | O~C~ | This field is a list of | | Information | | grouped field describing | | | | the subsequent CS to PS or | | | | PS to CS session | | | | transfers. | | | | | | | | Each other occurence | | | | comprises sub-fields | | | | describing the session | | | | transfer performed. | +----------------------------+----------+----------------------------+ | > Access Transfer Type | O~C~ | This field contains | | | | indication about the | | | | access transfer performed: | | | | CS to PS, or PS to CS.This | | | | field is present only when | | | | transfer occurred. | +----------------------------+----------+----------------------------+ | > Access Network | O~C~ | This field holds the | | > Information | | content of one SIP | | | | P-header | | | | "P-Access-Network-Info" | | | | from the INVITE requesting | | | | the transfer, if | | | | available. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | This field contains the | | ID | | IMS communication service | | | | identifier if received in | | | | the P-Asserted-Service | | | | header in the SIP request. | +----------------------------+----------+----------------------------+ | Online Charging Flag | O~C~ | This field indicates the | | | | Online Charging Request | | | | was sent based on the | | | | provided ECF address from | | | | the SIP P-header | | | | "P-Cha | | | | rging-Function-Addresses". | | | | | | | | NOTE: No proof that online | | | | charging action has been | | | | taken | +----------------------------+----------+----------------------------+ | Real Time Tariff | Oc | This field holds the | | Information | | tariff/add-on charge | | | | received. | +----------------------------+----------+----------------------------+ | Initial IMS Charging | Oc | This parameter holds the | | Identifier | | Initial IMS charging | | | | identifier (ICID) as | | | | generated by the IMS node | | | | for the initial SIP | | | | session created for IMS | | | | service continuity. | | | | | | | | This field is not used for | | | | the "OneChargingSession" | | | | option. | +----------------------------+----------+----------------------------+ | User Location Info | O~C~ | This field indicates | | | | contains the network | | | | provided location | | | | information for 3GPP | | | | accesses, if available.. | +----------------------------+----------+----------------------------+ | MS Time Zone | O~C~ | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | IMS Visited Network | O~C~ | Contains the information | | Identifier | | from the SIP | | | | P-Visited-Network-ID | | | | header received in a | | | | REGISTER request. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+ | TAD Identifier | O~C~ | This field indicates the | | | | type of access network (CS | | | | or PS) through which the | | | | session shall be | | | | terminated. | +----------------------------+----------+----------------------------+
#### 6.1.3.10 IBCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.10: Charging Data of IBCF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR. | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the IBCF is | | | | serving the Originating or | | | | the Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. In | | | | the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include a one item with | | | | the value "unknown". | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | In the context of an | | | | end-to-end SIP transaction | | | | this field holds the | | | | address of the party | | | | (Public User ID) to whom | | | | the SIP transaction is | | | | posted. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp which indicates | | | | the time at which the | | | | service was requested. | | | | This parameter corresponds | | | | to SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. This | | | | parameter corresponds to | | | | SIP Response Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. This | | | | parameter corresponds to | | | | SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Stop]. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record | +----------------------------+----------+----------------------------+ | Inter Operator Identifiers | O~C~ | Holds the identification | | | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | _P-Charging-Vector | | | | header._ | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by this node. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). This | | | | parameter corresponds to | | | | SIP Request Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Local GW Inserted | O~C~ | This field indicates | | Indication | | whether the local TrGW is | | | | inserted or not, for the | | | | media component included | | | | in SDP answer, if | | | | available. | +----------------------------+----------+----------------------------+ | IP Realm Default | O~C~ | This field indicates | | Indication | | whether the User Plane IP | | | | realm associated to the | | | | media component included | | | | in SDP answer, is the | | | | Default IP realm or not, | | | | if available. | +----------------------------+----------+----------------------------+ | Transcoder Inserted | O~C~ | This field indicates | | Indication | | whether a transcoder is | | | | inserted or not, for the | | | | media component included | | | | in the SDP answer, if | | | | available. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are : | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of one SIP | | | | P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | This field contains the | | ID | | identifier for the type of | | | | communication service the | | | | IMS is currently providing | | | | for the session if | | | | received in the | | | | P-Asserted-Service header | | | | in the SIP request when | | | | the IBCF is downstream | | | | from the Sâ€‘CSCF serving | | | | the Originating party or | | | | the topmost occurrence of | | | | the \"+g.3gpp.icsi-ref\" | | | | header field parameter of | | | | the Feature-Caps header in | | | | the SIP response when the | | | | IBCF is upstream from the | | | | S-CSCF serving the | | | | Originating party. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | Real Time Tariff | Oc | This field holds the | | Information | | tariff/add-on charge | | | | received. | +----------------------------+----------+----------------------------+ | User Location Info | O~C~ | This field indicates | | | | contains the network | | | | provided location | | | | information for 3GPP | | | | accesses, if available.. | +----------------------------+----------+----------------------------+ | MS Time Zone | O~C~ | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | NNI Information | Oc | This grouped field | | | | comprising several | | | | sub-fields holds | | | | information about the NNI | | | | used for interconnection | | | | and roaming. This field | | | | may occur more than once | | | | in a CDR e.g. when routing | | | | capability in support of | | | | transit is collocated with | | | | the IBCF. | +----------------------------+----------+----------------------------+ | Session Direction | Oc | This field indicates | | | | whether the NNI is used | | | | for an inbound or outbound | | | | service request on the | | | | control plane in case of | | | | interconnection and | | | | roaming. | +----------------------------+----------+----------------------------+ | NNI Type | Oc | This field indicates | | | | whether the type of used | | | | NNI is non-roaming, | | | | roaming with loopback | | | | routing, or roaming | | | | without loopback routing. | +----------------------------+----------+----------------------------+ | Relationship Mode | Oc | This field indicates | | | | whether the other | | | | functional entity (contact | | | | point of the neighbouring | | | | network) is regarded as | | | | part of the same trust | | | | domain. | +----------------------------+----------+----------------------------+ | Neighbour Node Address | Oc | This field holds the | | | | control plane IP address | | | | of the neighbouring | | | | network contact point that | | | | handles the service | | | | request in case of | | | | interconnection and | | | | roaming. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | SIP Route header received | O~C~ | Contains the information | | | | in the topmost route | | | | header in a received | | | | initial SIP INVITE or | | | | non-session related SIP | | | | MESSAGE request. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+ | TAD Identifier | O~C~ | This field indicates the | | | | type of access network (CS | | | | or PS) through which the | | | | session shall be | | | | terminated. | +----------------------------+----------+----------------------------+
#### 6.1.3.11 E-CSCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.11: Charging Data of E-CSCF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the E-CSCF is | | | | serving the Originating or | | | | the Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. In | | | | case no | | | | P-Asserted-Identity is | | | | known, this list shall | | | | include one item with the | | | | value "unknown". | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | For SIP transactions, this | | | | field holds the address of | | | | the party (Public User ID | | | | or Public Service ID) to | | | | whom the SIP transaction | | | | is posted. It could be in | | | | the format of a SIP URI, a | | | | TEL URI or a URN | +----------------------------+----------+----------------------------+ | Requested Party Address | O~C~ | For SIP transactions this | | | | field holds the address of | | | | the party (Public User ID | | | | or Public Service ID) to | | | | whom the SIP transaction | | | | was originally posted. It | | | | could be in the format of | | | | a SIP URI, a TEL URI or a | | | | URN. | | | | | | | | This field is only present | | | | if different from the | | | | Called Party Address | | | | parameter. | +----------------------------+----------+----------------------------+ | List of Called Asserted | **O~C~** | The address or addresses | | Identity | | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response. | +----------------------------+----------+----------------------------+ | List of Subscription Id | O~C~ | Holds the public user | | | | identities of the served | | | | user | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp, which | | | | indicates the time at | | | | which the service was | | | | requested. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | This a grouped CDR field | | Information | | containing the fields: | | | | "Application Server | | | | Involved" and "Application | | | | Provided Called Parties". | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | Holds the ASs (if any) | | Involved | | identified by the SIP | | | | URIs. | +----------------------------+----------+----------------------------+ | Application Provided | O~C~ | Holds a list of the Called | | Called Parties | | party address(es), if the | | | | address(es) are determined | | | | by an AS (SIP URI, | | | | E.164...). | +----------------------------+----------+----------------------------+ | List of Inter Operator | O~C~ | Holds the identification | | Identifiers | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | P-Charging-Vector header. | | | | This grouped field may | | | | occur several times in one | | | | CDR. | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by E-CSCF. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | GGSN Address | O~C~ | This parameter holds the | | | | control plane IP address | | | | of the GGSN that handles | | | | one or more media | | | | component(s) of an IMS | | | | session. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are: | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of one SIP | | | | P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | This field contains the | | ID | | IMS communication service | | | | identifier if received in | | | | the P-Asserted-Service | | | | header in the SIP request. | +----------------------------+----------+----------------------------+ | User Location Info | O~C~ | This field contains the | | | | network provided location | | | | information for 3GPP | | | | accesses, if available.. | +----------------------------+----------+----------------------------+ | MS Time Zone | O~C~ | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
#### 6.1.3.12 TRF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.12: Charging Data of TRF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR. | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the TRF is serving | | | | the Originating or the | | | | Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | In the context of an | | | | end-to-end SIP transaction | | | | this field holds the | | | | address of the party | | | | (Public User ID) to whom | | | | the SIP transaction is | | | | posted. | +----------------------------+----------+----------------------------+ | **List of Called Asserted |** O~C~**|** The address or addresses | | Identity**| | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response.** | +----------------------------+----------+----------------------------+ | Requested Party Address | O~C~ | For SIP transactions this | | | | field holds the address of | | | | the party (Public User ID | | | | or Public Service ID) to | | | | whom the SIP transaction | | | | was originally posted. | | | | | | | | This field is only present | | | | if different from the | | | | Called Party Address | | | | parameter. | +----------------------------+----------+----------------------------+ | List of Subscription Id | O~C~ | Holds the public user | | | | identities of the served | | | | user. | +----------------------------+----------+----------------------------+ | Number Portability routing | O~C~ | This field includes | | information | | information on number | | | | portability after DNS/ENUM | | | | request from the TRF. | +----------------------------+----------+----------------------------+ | Carrier Select routing | O~C~ | This field includes | | information | | information on number | | | | portability after DNS/ENUM | | | | request from the TRF. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp which indicates | | | | the time at which the | | | | service was requested. | | | | This parameter corresponds | | | | to SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. This | | | | parameter corresponds to | | | | SIP Response Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. This | | | | parameter corresponds to | | | | SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Stop]. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | This a grouped CDR field | | Information | | containing the fields: | | | | "Application Server | | | | Involved" and "Application | | | | Provided Called Parties". | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | Holds the ASs (if any) | | Involved | | identified by the SIP | | | | URIs. | +----------------------------+----------+----------------------------+ | Application Provided | O~C~ | Holds a list of the Called | | Called Parties | | party address(es), if the | | | | address(es) are determined | | | | by an AS (SIP URI, | | | | E.164...). | +----------------------------+----------+----------------------------+ | Inter Operator Identifiers | O~C~ | Holds the identification | | | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | _P-Charging-Vector | | | | header._ This grouped | | | | field may occur several | | | | times in one CDR. | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. This | | | | field may occur several | | | | times in one CDR. Each | | | | occurrence represents | | | | transit IOI values | | | | received from the path | | | | inbound to or outbound | | | | from the TRF. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by this node. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). This | | | | parameter corresponds to | | | | SIP Request Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are : | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | Contains the identifier | | Id | | for the type of | | | | communication service the | | | | IMS is currently providing | | | | for the session. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | User Location Info | O~C~ | This field contains the | | | | network provided location | | | | information for 3GPP | | | | accesses, if available.. | +----------------------------+----------+----------------------------+ | MS Time Zone | O~C~ | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | NNI Information | Oc | This grouped field | | | | comprising several | | | | sub-fields holds | | | | information about the NNI | | | | used for interconnection | | | | and roaming. This field | | | | may occur more than once | | | | in a CDR e.g. when routing | | | | capability in support of | | | | transit is collocated with | | | | the TRF. | +----------------------------+----------+----------------------------+ | NNI Type | Oc | This field indicates | | | | whether the type of used | | | | NNI is non-roaming, | | | | roaming with loopback | | | | routing, or roaming | | | | without loopback routing. | +----------------------------+----------+----------------------------+ | SIP Route header received | O~C~ | Contains the information | | | | in the topmost route | | | | header in a received | | | | initial SIP INVITE or | | | | non-session related SIP | | | | MESSAGE request. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
#### 6.1.3.13 ATCF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.13: Charging Data of ATCF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~M~ | This field indicates | | | | whether the ATCF is | | | | serving the Originating or | | | | the Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. When the | | | | ATCF acts as B2BUA, the | | | | incoming session is | | | | identified , except for | | | | the "OneChargingSession" | | | | option, where it contains | | | | either the incoming or | | | | outgoing dialog SIP Call | | | | Id involved during IMS | | | | session setup. | +----------------------------+----------+----------------------------+ | Outgoing Session ID | O~C~ | When the ATCF acts as | | | | B2BUA, the outgoing | | | | session is identified by | | | | the Outgoing Session ID | | | | which contains the SIP | | | | Call ID (as defined in the | | | | RFC 3261 [404]). This | | | | field is not used for the | | | | \"OneChargingSession \" | | | | option | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID, Correlation | | | | MSISDN) of the party | | | | requesting a service or | | | | initiating a session. In | | | | the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include one item with the | | | | value "unknown". | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | For SIP transactions, | | | | except for registration, | | | | this field holds the | | | | address of the party | | | | (Public User ID or Public | | | | Service ID) to whom the | | | | SIP transaction is posted. | | | | | | | | For registration | | | | transactions, this field | | | | holds the Public User ID | | | | under registration. | +----------------------------+----------+----------------------------+ | List of Requested Party | O~C~ | This field is a list of | | Address | | Requested Party Address. | | | | | | | | Each occurrence contains: | | | | | | | | For SIP transactions, the | | | | address of the party | | | | (Public User ID or Public | | | | Service ID) to whom the | | | | SIP transaction was | | | | originally posted. | | | | | | | | For PS to CS transfer, the | | | | Session Transfer Number | | | | for Single Radio Voice | | | | Call Continuity (STN-SR) | | | | as described in TS 23.237 | | | | [407]. | | | | | | | | For CS to PS transfer, the | | | | Session Transfer | | | | Identifier for CS to PS | | | | Single Radio Voice Call | | | | Continuity (STI-rSR) as | | | | described in TS 23.237 | | | | [407]. | +----------------------------+----------+----------------------------+ | Private User ID | O~C~ | This field holds the | | | | private user identity of | | | | the served party defined | | | | in TS 23.003 [104], if | | | | available. | +----------------------------+----------+----------------------------+ | List of Subscription Id | O~M~ | Holds the public user | | | | identities of the served | | | | user | +----------------------------+----------+----------------------------+ | List of Called Asserted | O~C~ | The address or addresses | | Identity | | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp which indicates | | | | the time at which the | | | | service was requested. | | | | This parameter corresponds | | | | to SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. This | | | | parameter corresponds to | | | | SIP Response Timestamp. | | | | Present with Charging Data | | | | Request [Start] and | | | | Charging Data Request | | | | [Event]. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. This | | | | parameter corresponds to | | | | SIP Request Timestamp. | | | | Present with Charging Data | | | | Request [Stop]. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Inter Operator Identifiers | O~C~ | Holds the identification | | | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | _P-Charging-Vector | | | | header._ | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by this node. The | | | | number is allocated | | | | sequentially for each | | | | partial CDR (or whole CDR) | | | | including all CDR types. | | | | The number is unique | | | | within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | | | | | | | | When the ATCF acts as | | | | B2BUA and | | | | "OneChargingSession" | | | | option applies, only SDP | | | | media components received | | | | by the ATCF are included, | | | | i.e those generated by the | | | | ATCF are not included. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). This | | | | parameter corresponds to | | | | SIP Request Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. This | | | | parameter corresponds to | | | | SIP Response Timestamp in | | | | Charging Data Request | | | | [Interim]. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Access Correlation ID | O~C~ | This parameter holds the | | | | charging identifier from | | | | the access network, | | | | consisting of either GPRS | | | | charging ID (GCID) which | | | | is generated by the GGSN | | | | for a GPRS PDP context, | | | | Charging Id which is | | | | generated by P-GW for | | | | IP-CAN bearer or the | | | | Access Network Charging | | | | Identifier Value which is | | | | generated by another type | | | | of access network. | | | | | | | | It is present only if | | | | received from the access | | | | network when PCC | | | | architecture is | | | | implemented. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | GGSN Address | O~C~ | This parameter holds the | | | | control plane IP address | | | | of the GGSN that handles | | | | one or more media | | | | component(s) of a IMS | | | | session. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are : | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | Access Network Information | O~C~ | This field contains the | | | | content of the first | | | | available SIP P-header | | | | "P-Access-Network-Info" if | | | | available. | +----------------------------+----------+----------------------------+ | List of Access Transfer | O~C~ | This field is a list of | | Information | | grouped field describing | | | | the subsequent CS to PS or | | | | PS to CS session | | | | transfers. | | | | | | | | Each other occurence | | | | comprises sub-fields | | | | describing the session | | | | transfer performed. | +----------------------------+----------+----------------------------+ | > Access Transfer Type | O~C~ | This field contains | | | | indication about the | | | | access transfer performed: | | | | CS to PS, or PS to CS.This | | | | field is present only when | | | | transfer occurred. | +----------------------------+----------+----------------------------+ | > Access Network | O~C~ | This field holds the | | > Information | | content of one SIP | | | | P-header | | | | "P-Access-Network-Info" | | | | from the INVITE requesting | | | | the transfer, if | | | | available. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | This field contains the | | ID | | IMS communication service | | | | identifier if received in | | | | the P-Asserted-Service | | | | header in the SIP request | | | | when the ATCF is | | | | downstream from the Sâ€‘CSCF | | | | serving the Originating | | | | party or the topmost | | | | occurrence of the | | | | \"+g.3gpp.icsi-ref\" | | | | header field parameter of | | | | the Feature-Caps header in | | | | the SIP response when the | | | | ATCF is upstream from the | | | | Sâ€‘CSCF serving the | | | | Originating party. | +----------------------------+----------+----------------------------+ | Initial IMS Charging | O~C~ | This parameter holds the | | Identifier | | Initial IMS charging | | | | identifier (ICID) as | | | | generated by the IMS node | | | | for the initial SIP | | | | session created for IMS | | | | service continuity. | | | | | | | | This field is not used for | | | | the "OneChargingSession" | | | | option. | +----------------------------+----------+----------------------------+ | User Location Info | O~C~ | This field contains the | | | | network provided location | | | | information for 3GPP | | | | accesses, if available.. | +----------------------------+----------+----------------------------+ | MS Time Zone | O~C~ | This field indicates the | | | | offset between universal | | | | time and local time in | | | | steps of 15 minutes of | | | | where the MS currently | | | | resides. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | SIP Route header received | O~C~ | Contains the information | | | | in the topmost route | | | | header in a received | | | | initial SIP INVITE or | | | | non-session related SIP | | | | MESSAGE request. | +----------------------------+----------+----------------------------+ | SIP Route header | O~C~ | Contains the information | | transmitted | | in the route header | | | | representing the | | | | destination in a | | | | transmitted SIP INVITE or | | | | non-session related SIP | | | | MESSAGE request. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
NOTE: ATCF collocated with P-CSCF or IBCF applies combined offline charging
with applicable fields described in table 6.3.2.1
#### 6.1.3.14 TF CDR Content
The detailed description of the field is provided in TS 32.298 [51].
Table 6.1.3.14: Charging Data of TF CDR
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Record Type | M | Identifies the type of | | | | record. The parameter is | | | | derived from the Node | | | | functionality parameter. | +----------------------------+----------+----------------------------+ | Retransmission | O~C~ | This parameter, when | | | | present, indicates that | | | | information from | | | | retransmitted Charging | | | | Data Requests has been | | | | used in this CDR | +----------------------------+----------+----------------------------+ | SIP Method | O~C~ | Specifies the SIP-method | | | | for which the CDR is | | | | generated. Only available | | | | in session unrelated | | | | cases. | +----------------------------+----------+----------------------------+ | Event | O~C~ | This field identifies the | | | | SIP event package to which | | | | the SIP request is | | | | referred. | +----------------------------+----------+----------------------------+ | Expires Information | O~C~ | This field indicates the | | | | validity time of either | | | | the SIP message or its | | | | content, depending on the | | | | SIP method. | +----------------------------+----------+----------------------------+ | Role of node | O~C~ | This field indicates | | | | whether the Transit | | | | Functions are serving the | | | | Originating or the | | | | Terminating party. | +----------------------------+----------+----------------------------+ | Node Address | O~M~ | This item holds the | | | | address of the node | | | | providing the information | | | | for the CDR. This may | | | | either be the IP address | | | | or the FQDN of the IMS | | | | node generating the | | | | accounting data. | +----------------------------+----------+----------------------------+ | Session ID | O~M~ | The Session | | | | identification. For a SIP | | | | session the Session-ID | | | | contains the SIP Call ID | | | | as defined in the Session | | | | Initiation Protocol RFC | | | | 3261 [404]. | +----------------------------+----------+----------------------------+ | Session Priority | O~C~ | The field contains the | | | | priority of the session. | +----------------------------+----------+----------------------------+ | List Of Calling Party | O~M~ | The address or addresses | | Address | | (Public User ID or Public | | | | Service ID) of the party | | | | requesting a service or | | | | initiating a session. In | | | | the case of no | | | | P-Asserted-Identify is | | | | known, this list shall | | | | include one item with the | | | | value "unknown". | +----------------------------+----------+----------------------------+ | Called Party Address | O~M~ | For SIP transactions, | | | | except for registration, | | | | this field holds the | | | | address of the party | | | | (Public User ID or Public | | | | Service ID) to whom the | | | | SIP transaction is posted. | | | | | | | | For registration | | | | transactions, this field | | | | holds the Public User ID | | | | under registration. | +----------------------------+----------+----------------------------+ | Requested Party Address | O~C~ | For SIP transactions this | | | | field holds the address of | | | | the party (Public User ID | | | | or Public Service ID) to | | | | whom the SIP transaction | | | | was originally posted. | | | | | | | | This field is only present | | | | if different from the | | | | Called Party Address | | | | parameter. | +----------------------------+----------+----------------------------+ | List of Called Asserted | O~C~ | The address or addresses | | Identity | | of the final asserted | | | | identities. Present if the | | | | final asserted identities | | | | are available in the SIP | | | | 2xx response. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This field contains the | | | | time stamp, which | | | | indicates the time at | | | | which the service was | | | | requested. | +----------------------------+----------+----------------------------+ | Service Request Time Stamp | O~M~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Request Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This field holds the time | | Time Stamp | | stamp reflecting either: | | | | successful session set-up, | | | | a delivery unrelated | | | | service, an unsuccessful | | | | session set-up and an | | | | unsuccessful session | | | | unrelated request. | +----------------------------+----------+----------------------------+ | Service Delivery Start | O~M~ | This parameter contains | | Time Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery Start Time Stamp. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This field records the | | Stamp | | time at which the service | | | | delivery was terminated. | | | | It is Present only in SIP | | | | session related case. | +----------------------------+----------+----------------------------+ | Service Delivery End Time | O~C~ | This parameter contains | | Stamp Fraction | | the milliseconds fraction | | | | in relation to the Service | | | | Delivery End Time Stamp. | +----------------------------+----------+----------------------------+ | Record Opening Time | O~C~ | A time stamp reflecting | | | | the time the CDF opened | | | | this record. Present only | | | | in SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | Record Closure Time | O~M~ | A Time stamp reflecting | | | | the time the CDF closed | | | | the record. | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | This a grouped CDR field | | Information | | containing the fields: | | | | "Application Server | | | | Involved" and "Application | | | | Provided Called Parties", | | | | to cover the case of | | | | transit network providing | | | | IMS application services. | +----------------------------+----------+----------------------------+ | Application Servers | O~C~ | Holds the ASs (if any) | | Involved | | identified by the SIP | | | | URIs. | +----------------------------+----------+----------------------------+ | Application Provided | O~C~ | Holds a list of the Called | | Called Parties | | party address(es), if the | | | | address(es) are determined | | | | by an AS (SIP URI, | | | | E.164...). | +----------------------------+----------+----------------------------+ | List of Inter Operator | O~C~ | Holds the identification | | Identifiers | | of the home network | | | | (originating and | | | | terminating) if exchanged | | | | via SIP signalling, as | | | | recorded in the | | | | P-Charging-Vector header. | | | | This grouped field may | | | | occur several times in one | | | | CDR. | +----------------------------+----------+----------------------------+ | Originating IOI | O~C~ | This parameter corresponds | | | | to Orig-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Terminating IOI | O~C~ | This parameter corresponds | | | | to Term-IOI header of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. | +----------------------------+----------+----------------------------+ | Transit IOI List | Oc | This parameter corresponds | | | | to Transit-IOI List of the | | | | P-Charging-Vector defined | | | | in TS 24.229 [204]. This | | | | field may occur several | | | | times in one CDR. Each | | | | occurrence represents | | | | transit IOI values | | | | received from the path | | | | inbound to or outbound | | | | from the TF, including the | | | | own Transit IOI. | +----------------------------+----------+----------------------------+ | Local Record Sequence | O~M~ | This field includes a | | Number | | unique record number | | | | created by the Transit | | | | Functions. The number is | | | | allocated sequentially for | | | | each partial CDR (or whole | | | | CDR) including all CDR | | | | types. The number is | | | | unique within the CDF. | +----------------------------+----------+----------------------------+ | Record Sequence Number | O~C~ | This field contains a | | | | running sequence number | | | | employed to link the | | | | partial records generated | | | | by the CDF for a | | | | particular session. | +----------------------------+----------+----------------------------+ | Cause For Record Closing | O~M~ | This field contains a | | | | reason for the close of | | | | the CDR. | +----------------------------+----------+----------------------------+ | Incomplete CDR Indication | O~C~ | This field provides | | | | additional diagnostics | | | | when the CDF detects | | | | missing Charging Data | | | | Requests. | +----------------------------+----------+----------------------------+ | IMS Charging Identifier | O~M~ | This parameter holds the | | | | IMS charging identifier | | | | (ICID) as generated by the | | | | IMS node for the SIP | | | | session. | +----------------------------+----------+----------------------------+ | List of Early SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | This field shall not be | | | | present if no media | | | | components are set to | | | | active before the final | | | | SIP session answer to the | | | | initial SIP Invite is | | | | received. | | | | | | | | This field can be present | | | | in either session or event | | | | CDRs. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of SDP data exchanged in | | | | the above mentioned | | | | scenario, if available. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SDP Offer Timestamp | O~M~ | This parameter contains | | | | the time of the SIP | | | | Request which conveys the | | | | SDP offer. | +----------------------------+----------+----------------------------+ | SDP Answer Timestamp | O~M~ | This parameter contains | | | | the time of the response | | | | to the SIP Request which | | | | conveys the SDP answer. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | List of SDP Media | O~C~ | This is a grouped field | | Components | | which may occur several | | | | times in one CDR. | | | | | | | | The field is present only | | | | in a SIP session related | | | | case. | +----------------------------+----------+----------------------------+ | SDP Session Description | O~C~ | Holds the Session portion | | | | of the SDP data exchanged | | | | between the User Agents if | | | | available in the SIP | | | | transaction. | +----------------------------+----------+----------------------------+ | SDP Type | O~M~ | This parameter indicates | | | | if the SDP media component | | | | is an SDP offer or SDP | | | | answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | | | the time of the SIP | | | | Request (usually a | | | | (Re)Invite). | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | | | appropriately the time of | | | | 200 OK acknowledging an | | | | INVITE or of ACK including | | | | an SDP answer. | +----------------------------+----------+----------------------------+ | SIP Request Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Request Timestamp. | +----------------------------+----------+----------------------------+ | SIP Response Timestamp | O~C~ | This parameter contains | | Fraction | | the milliseconds fraction | | | | in relation to the SIP | | | | Response Timestamp. | +----------------------------+----------+----------------------------+ | SDP Media Components | O~M~ | This is a grouped field | | | | comprising several | | | | sub-fields associated with | | | | one media component. Since | | | | several media components | | | | may exist for a session in | | | | parallel these sub-fields | | | | may occur several times. | +----------------------------+----------+----------------------------+ | SDP Media Name | O~M~ | This field holds the name | | | | of the media as available | | | | in the SDP data. | +----------------------------+----------+----------------------------+ | SDP Media Description | O~M~ | This field holds the | | | | attributes of the media as | | | | available in the SDP data. | +----------------------------+----------+----------------------------+ | Media Initiator flag | O~C~ | This field indicates if | | | | the called party has | | | | requested the session | | | | modification and it is | | | | present only if the | | | | initiator was the called | | | | party. | +----------------------------+----------+----------------------------+ | Service Reason Return Code | O~M~ | This parameter provides | | | | the returned SIP status | | | | code for the service | | | | request for the successful | | | | and failure case, | +----------------------------+----------+----------------------------+ | List of Message Bodies | O~C~ | This grouped field | | | | comprising several | | | | sub-fields describing the | | | | data that may be conveyed | | | | end-to-end in the body of | | | | a SIP message. Since | | | | several message bodies may | | | | be exchanged via | | | | SIP-signalling, this | | | | grouped field may occur | | | | several times. | +----------------------------+----------+----------------------------+ | Content-Type | O~M~ | This sub-field of Message | | | | Bodies holds the MIME type | | | | of the message body, | | | | Examples are: | | | | application/zip, | | | | image/gif, audio/mpeg, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Disposition | O~C~ | This sub-field of Message | | | | Bodies holds the content | | | | disposition of the message | | | | body inside the SIP | | | | signalling, | | | | Content-disposition header | | | | field equal to "render", | | | | indicates that "the body | | | | part should be displayed | | | | or otherwise rendered to | | | | the user". Content | | | | disposition values are: | | | | session, render, inline, | | | | icon, alert, attachment, | | | | etc. | +----------------------------+----------+----------------------------+ | Content-Length | O~M~ | This sub-field of Message | | | | Bodies holds the size of | | | | the data of a message body | | | | in bytes. | +----------------------------+----------+----------------------------+ | Originator | O~C~ | This sub-field of the | | | | \"List of Message Bodies\" | | | | indicates the originating | | | | party of the message body. | +----------------------------+----------+----------------------------+ | Service Context Id | O~M~ | Holds the context | | | | information to which the | | | | CDR belongs. The | | | | information is obtained | | | | from the Operation Token | | | | of the Charging Data | | | | Request message. | +----------------------------+----------+----------------------------+ | IMS Communication Service | O~C~ | This field contains the | | ID | | IMS communication service | | | | identifier if received in | | | | the P-Asserted-Service | | | | header in the SIP request. | +----------------------------+----------+----------------------------+ | NNI Information | O~C~ | This grouped field holds | | | | information about the NNI | | | | used for interconnection | | | | and roaming on the | | | | loopback routing path. It | | | | is present only if "VPLMN | | | | routing" is applied in a | | | | Roaming Architecture for | | | | Voice over IMS with Local | | | | breakout. | +----------------------------+----------+----------------------------+ | NNI Type | O~C~ | This field indicates usage | | | | of the roaming NNI for | | | | loopback routing, i.e | | | | S-CSCF performed the | | | | loopback decision. | +----------------------------+----------+----------------------------+ | From Address | O~M~ | Contains the information | | | | from the SIP From header. | +----------------------------+----------+----------------------------+ | SIP Route header received | O~C~ | Contains the information | | | | in the topmost route | | | | header in a received | | | | initial SIP INVITE or | | | | non-session related SIP | | | | MESSAGE request prior to | | | | triggering of any | | | | application servers. | +----------------------------+----------+----------------------------+ | SIP Route header | O~C~ | Contains the information | | transmitted | | in the route header | | | | representing the | | | | destination in a | | | | transmitted initial SIP | | | | INVITE or non-session | | | | related SIP MESSAGE | | | | request following | | | | triggering of all | | | | application servers. | +----------------------------+----------+----------------------------+ | Record Extensions | O~C~ | A set of | | | | operator/manufacturer | | | | specific extensions to the | | | | record, conditioned upon | | | | existence of an extension. | +----------------------------+----------+----------------------------+
> Editor's note: More investigation on parameters occurrence should be worked
> out.
## 6.2 Data description for IMS online charging
### 6.2.1 Ro message contents
The IMS nodes generate debit and reserve units information that can be
transferred from the CTF to the OCF. For this purpose, IMS online charging
utilises the _Debit Units and Reserve Units_ procedure that is specified in
the 3GPP debit unit operation in TS 32.299 [50].
The _Debit and reserve units_ procedure employs the _Debit and Reserve Units
Request_ and _Debit and Reserve Units Response_ messages. Table 6.2.1
describes the use of these messages in IMS online charging.
Table 6.2.1: Online Charging Messages Reference Table
* * *
Command-Name Source Destination Debit and Reserve Units Request MRFC, AS, IMS-
GWF OCS Debit and Reserve Units Response OCS MRFC, AS, IMS-GWF
* * *
#### 6.2.1.1 Debit and Reserve Units Request Message
Table 6.2.1.1 illustrates the basic structure of a _Debit and Reserve Units
Request_ message from the CTF in MRFC and AS and the IMS-GWF as used for IMS
online charging.
Table 6.2.1.1: Debit and reserve units Request Message Contents
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Session Identifier | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Originator Host | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Originator Domain | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Destination Domain | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Identifier | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Token | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Type | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Number | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Destination Host | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | User Name | O~C~ | The field contains the | | | | Private User Identity | | | | defined in TS 23.003 | | | | [104]. | +----------------------------+----------+----------------------------+ | Origination State | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Origination Timestamp | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Subscriber Identifier | O~M~ | This field contains the | | | | identification of the | | | | mobile subscriber (i.e. | | | | MSISDN or SIP-URI) that | | | | uses the requested | | | | service. | +----------------------------+----------+----------------------------+ | Termination Cause | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Requested Action | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Multiple Operation | O~M~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Multiple Unit Operation | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Subscriber Equipment | O~C~ | Described in 32.299 [50] | | Number | | | +----------------------------+----------+----------------------------+ | Proxy Information | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Route Information | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Service Information | O~M~ | This field holts | | | | additional 3GPP service | | | | specific parameter: | | | | | | | | > \- IMS Information, | | | | > | | | | > \- PS Information | +----------------------------+----------+----------------------------+ | Extended Information | O~C~ | This field holds the | | | | network/manufacturer | | | | specific extensions. | +----------------------------+----------+----------------------------+
#### 6.2.1.2 Debit and Reserve Units Response Message
Table 6.2.1.2 illustrates the basic structure of a Debit and Reserve Units
Response message as used for IMS charging. This message is always used by the
OCS as specified below, independent of the receiving IMS node and the
operation type that is being replied to.
Table 6.2.1.2: Debit and Reserve Units Response Message Contents for MRFC, AS
and IMS-GWF
+----------------------------+----------+----------------------------+ | Field | Category | Description | +----------------------------+----------+----------------------------+ | Session Identifier | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Result | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Originator Host | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Originator Domain | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Identifier | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Type | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Number | M | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Failover | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Multiple Unit Operation | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Operation Failure Action | O~C~ | Described in 32.299 | | | | [50]. This field defines | | | | the operation if a failure | | | | has occurred at the OCS | | | | for SCUR and ECUR. | +----------------------------+----------+----------------------------+ | Operation Event Failure | O~C~ | Described in 32.299 | | Action | | [50]. This field defines | | | | the operation if a failure | | | | has occurred at the OCS | | | | for IEC. | +----------------------------+----------+----------------------------+ | Redirection Host | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Redirection Host Usage | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Redirection Cache Time | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Proxy Information | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Route Information | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Failed parameter | O~C~ | Described in 32.299 [50] | +----------------------------+----------+----------------------------+ | Service Information | O~C~ | This field holts | | | | additional 3GPP service | | | | specific parameter: | | | | | | | | > \- IMS Information, | | | | > | | | | > \- PS Information | +----------------------------+----------+----------------------------+ | Extended Information | O~C~ | This field holds the | | | | network/manufacturer | | | | specific extensions. | +----------------------------+----------+----------------------------+
## 6.3 IMS Charging Specific Parameters
### 6.3.1 Definition of IMS charging information
The IMS Information parameter used for IMS charging is provided in the Service
Information parameter.
#### 6.3.1.1 IMS charging information assignment for Service Information
The components in the Service Information that are use for IMS charging can be
found in Table 6.3.1.1.
Table 6.3.1.1: Service Information used for IMS Charging
+-------------------+----------+-------------------+---------------+ | Field | Category | Description | Provided | | | | | | | | | | by IMS NE | +-------------------+----------+-------------------+---------------+ | Service | O~M~ | This is a | All | | Information | | structured field | | | | | and holds the | | | | | 3GPP specific | | | | | parameter as | | | | | defined in | | | | | TS 32.299 [50]. | | | | | For IMS Charging | | | | | the IMS | | | | | Information is | | | | | used. | | +-------------------+----------+-------------------+---------------+ | Subscriber | O~M~ | Described in TS | Not in IBCF, | | Identifier | | 32.299 [50] and | | | | | contains the | I-CSCF, MGCF, | | | | Public User | | | | | Id | BGCF, TF | | | | entity/Identities | | +-------------------+----------+-------------------+---------------+ | IMS Information | O~M~ | This is a | All | | | | structured field | | | | | and holds the IMS | | | | | specific | | | | | parameters. The | | | | | details are | | | | | defined in clause | | | | | 6.3.1.2. | | +-------------------+----------+-------------------+---------------+ | PS Information | O~C~ | This is a | Not in | | | | structured field | | | | | and holds PS | MGCF, | | | | specific | | | | | parameters. The | BGCF | | | | complete | | | | | structure is | | | | | defined in TS | | | | | 32.251 [11]. | | +-------------------+----------+-------------------+---------------+ | > GGSN Address | O~C~ | This field holds | Not in | | | | the IP-address of | | | | | the GGSN that | I-CSCF, MGCF, | | | | generated the | | | | | GPRS Charging ID, | BGCF, | | | | as described in | | | | | [1]. | IBCF | +-------------------+----------+-------------------+---------------+ | > User Location | OC | This field | Not in | | > Info | | contains the | | | | | network provided | MGCF, | | | | location | | | | | information for | BGCF, TF | | | | 3GPP accesses, if | | | | | available. | | +-------------------+----------+-------------------+---------------+ | > MS Time Zone | OC | This field | Not in | | | | indicates the | | | | | offset between | MGCF, | | | | universal time | | | | | and local time in | BGCF,TF | | | | steps of 15 | | | | | minutes of where | | | | | the MS currently | | | | | resides. | | +-------------------+----------+-------------------+---------------+
#### 6.3.1.2 Definition of the IMS Information
IMS specific charging information is provided within the IMS Information. The
fields of the IMS Information which are differently covered in several IMS
network nodes are indicated by the node specific type.
The detailed structure of the IMS Information can be found in table 6.3.1.2.
Table 6.3.1.2: Structure of the IMS Information
+------------------+----------+------------------+------------------+ | Field | Category | Description | Provided | | | | | | | | | | by IMS NE | +------------------+----------+------------------+------------------+ | Event Type | O~C~ | This field holds | All | | | | the SIP Method, | | | | | the content of | | | | | the SIP "Event" | | | | | header and the | | | | | content of the | | | | | SIP "expires" | | | | | header when | | | | | present in the | | | | | SIP request. | | +------------------+----------+------------------+------------------+ | Node | M | This field | All | | Functionality | | contains the | | | | | function of the | | | | | node. | | +------------------+----------+------------------+------------------+ | Role of Node | O~M~ | This field | Not in MRFC | | | | specifies | | | | | whether the IMS | | | | | node is serving | | | | | the Originating | | | | | or the | | | | | Terminating | | | | | party. | | +------------------+----------+------------------+------------------+ | User Session ID | O~M~ | This field holds | All | | | | the session | | | | | identifier. For | | | | | a SIP session | | | | | the _Session-ID_ | | | | | contains the SIP | | | | | Call ID. When | | | | | the AS acts as | | | | | B2BUA, the | | | | | incoming session | | | | | is identified. | | +------------------+----------+------------------+------------------+ | Outgoing Session | O~C~ | When the AS acts | AS only | | ID | | as B2BUA, the | | | | | outgoing side | | | | | session is | | | | | identified by | | | | | the Outgoing | | | | | Session ID which | | | | | contains the SIP | | | | | Call ID. | | +------------------+----------+------------------+------------------+ | Session Priority | O~C~ | This field | All | | | | contains the | | | | | priority of the | | | | | session. | | +------------------+----------+------------------+------------------+ | Calling Party | O~M~ | This field holds | All | | Address | | the address (SIP | | | | | URI or TEL | | | | | URI)URI of the | | | | | party (Public | | | | | User Identity or | | | | | Public Service | | | | | Identity) | | | | | initiating a | | | | | session or | | | | | requesting a | | | | | service. | | +------------------+----------+------------------+------------------+ | Called Party | O~M~ | For SIP | All | | Address | | transactions, | | | | | except for | | | | | registration, | | | | | this field holds | | | | | the address of | | | | | the party | | | | | (Public User ID | | | | | or Public | | | | | Service ID) to | | | | | whom the SIP | | | | | transaction is | | | | | posted. | | | | | | | | | | For registration | | | | | transactions, | | | | | this field holds | | | | | the Public User | | | | | ID under | | | | | registration. | | +------------------+----------+------------------+------------------+ | Number | **O~C~** | **This field | S-CSCF, I-CSCF, | | Portability | | includes | AS, MGCF, BGCF | | routing | | information on | | | information | | number | | | | | portability | | | | | after DNS/ENUM | | | | | request from IMS | | | | | node in the | | | | | calling user's | | | | | home network.** | | +------------------+----------+------------------+------------------+ | Carrier Select | **O~C~** | **This field | S-CSCF, I-CSCF, | | routing | | includes | AS, MGCF, BGCF | | information | | information on | | | | | carrier select | | | | | after DNS/ENUM | | | | | request from IMS | | | | | node in the | | | | | calling user's | | | | | home network.** | | +------------------+----------+------------------+------------------+ | Alternate | **O~C~** | The address of | AS only | | Charged Party | | an alternate | | | Address | | party that is | | | | | identified by | | | | | the AS at | | | | | session | | | | | initiation, and | | | | | is charged in | | | | | place of the | | | | | calling party. | | +------------------+----------+------------------+------------------+ | Requested Party | O~C~ | For SIP | S-CSCF, P-CSCF, | | Address | | transactions | E-CSCF, and | | | | this field | AS/MRFC, TF, | | | | initially holds | TRF, ATCF | | | | the address of | | | | | the party | | | | | (Public User ID | | | | | or Public | | | | | Service ID) to | | | | | whom the SIP | | | | | transaction was | | | | | originally | | | | | posted. | | | | | | | | | | Subsequently, | | | | | this field holds | | | | | addresses | | | | | related to | | | | | session transfer | | | | | if available: | | | | | | | | | | For PS to CS | | | | | transfer, the | | | | | Session Transfer | | | | | Number for | | | | | Single Radio | | | | | Voice Call | | | | | Continuity | | | | | (STN-SR) as | | | | | described in TS | | | | | 23.237 [407]. | | | | | | | | | | For CS to PS | | | | | transfer, the | | | | | Session Transfer | | | | | Identifier for | | | | | CS to PS Single | | | | | Radio Voice Call | | | | | Continuity | | | | | (STI-rSR) as | | | | | described in TS | | | | | 23.237 [407].\ | | | | | This field is | | | | | only present if | | | | | different from | | | | | the Called Party | | | | | Address | | | | | parameter. | | +------------------+----------+------------------+------------------+ | Called Asserted | O~C~ | The address of | S-CSCF, E-CSCF | | Identity | | the final | and AS/MRFC, TF, | | | | asserted | TRF, ATCF | | | | identity. | | | | | Present if the | | | | | final asserted | | | | | identity is | | | | | available in the | | | | | SIP 2xx | | | | | response. | | +------------------+----------+------------------+------------------+ | Associated URI | O~C~ | This field holds | S-CSCF, P-CSCF, | | | | a non-barred | | | | | public user | I-CSCF, IBCF | | | | identity (SIP | | | | | URI or TEL URI) | | | | | associated to | | | | | the public user | | | | | identity under | | | | | registration and | | | | | is present for | | | | | registration | | | | | transactions. | | +------------------+----------+------------------+------------------+ | Time Stamps | O~C~ | This field holds | All | | | | the time of the | | | | | SIP REQUEST and | | | | | the time of the | | | | | response to the | | | | | SIP REQUEST. | | +------------------+----------+------------------+------------------+ | Application | O~C~ | This field holds | S-CSCF, E-CSCF, | | Server | | the SIP URI(s) | and MRFC, TF, | | Information | | of the AS(s) | TRF | | | | addressed during | | | | | the session and | | | | | the called party | | | | | number (SIP URI, | | | | | E.164), if an | | | | | application | | | | | server | | | | | determines it. | | +------------------+----------+------------------+------------------+ | Inter Operator | O~C~ | This field holds | All | | Identifier | | the | | | | | identification | | | | | of the network | | | | | neighbours | | | | | (originating and | | | | | terminating) as | | | | | exchanged via | | | | | SIP signalling | | | | | if available. | | | | | This field may | | | | | occur several | | | | | times. | | +------------------+----------+------------------+------------------+ | IMS Charging | O~M~ | This field holds | All | | Identifier | | the IMS Charging | | | | | Identifier | | | | | (ICID) as | | | | | generated by a | | | | | IMS node for a | | | | | SIP session. | | +------------------+----------+------------------+------------------+ | Related IMS | O~C~ | This field holds | P-CSCF | | Charging | | the Related IMS | | | Identifier | | charging | | | | | identifier when | | | | | the session is | | | | | the target | | | | | access leg in an | | | | | SRVCC CS to PS | | | | | handover. The | | | | | Related IMS | | | | | charging | | | | | identifier | | | | | contains the IMS | | | | | charging | | | | | identifier as | | | | | generated by the | | | | | Enhanced MSC | | | | | server. | | +------------------+----------+------------------+------------------+ | Related IMS | O~C~ | This field holds | P-CSCF | | Charging | | the identifier | | | Identifier | | of the Enhanced | | | Generation Node | | MSC server that | | | | | generated the | | | | | Related IMS | | | | | charging | | | | | identifier. | | +------------------+----------+------------------+------------------+ | Transit IOI List | O~C~ | This field holds | S-CSCF, P-CSCF, | | | | the | MRFC, MGCF, | | | | identification | BGCF, SIP AS, | | | | of the involved | IBCF, TF and TRF | | | | transit networks | | | | | as exchanged via | | | | | SIP signalling | | | | | if available. | | | | | This field may | | | | | occur several | | | | | times. When | | | | | received from | | | | | the AS, each | | | | | occurrence of | | | | | this field | | | | | represents | | | | | transit networks | | | | | inbound to or | | | | | outbound from | | | | | the S-CSCF. | | +------------------+----------+------------------+------------------+ | Early Media | O~C~ | This field holds | Not in I-CSCF, | | Description | | session and | BGCF | | | | media parameters | | | | | related to media | | | | | components set | | | | | to active during | | | | | the SIP session | | | | | establishment | | | | | and before a | | | | | final successful | | | | | or unsuccessful | | | | | SIP answer to | | | | | the initial SIP | | | | | INVITE request | | | | | is received. | | | | | Once a media | | | | | component is set | | | | | to active, | | | | | subsequent | | | | | status changes | | | | | shall be | | | | | registered. | | | | | Since several | | | | | SDP negotiations | | | | | may occur during | | | | | the SIP session | | | | | establishment, | | | | | this field may | | | | | occur several | | | | | times. | | +------------------+----------+------------------+------------------+ | SDP Session | O~C~ | This field holds | Not in | | Description | | the content of | | | | | an | I-CSCF, BGCF | | | | \" | | | | | attribute-line\" | | | | | (i=, c=, b=, k=, | | | | | a=, etc.) | | | | | related to a | | | | | session. | | +------------------+----------+------------------+------------------+ | SDP Media | O~C~ | This is a | Not in | | Component | | grouped field | | | | | comprising | I-CSCF, BGCF | | | | several | | | | | sub-fields | | | | | associated with | | | | | one media | | | | | component. Since | | | | | several media | | | | | components may | | | | | exist for a | | | | | session in | | | | | parallel these | | | | | sub-fields may | | | | | occur several | | | | | times. | | +------------------+----------+------------------+------------------+ | Served Party IP | O~C~ | This field holds | P-CSCF | | Address | | the IP address | | | | | of either the | | | | | calling or | | | | | called party, | | | | | depending on | | | | | whether the | | | | | P-CSCF is in | | | | | touch with the | | | | | calling or the | | | | | called party. | | +------------------+----------+------------------+------------------+ | Server | O~C~ | This field | I-CSCF | | Capabilities | | contains the | | | | | server | | | | | capabilities as | | | | | described in | | | | | 3GPP TS 29.229 | | | | | [205]. | | +------------------+----------+------------------+------------------+ | Trunk Group ID | O~C~ | This field | MGCF | | | | identifies the | | | | | incoming and | | | | | outgoing PSTN | | | | | legs. | | +------------------+----------+------------------+------------------+ | Bearer Service | O~C~ | This field holds | MGCF | | | | the used bearer | | | | | service for the | | | | | PSTN leg. | | +------------------+----------+------------------+------------------+ | Service Id | O~C~ | This field | MRFC | | | | identifies the | | | | | service the MRFC | | | | | is hosting. For | | | | | conferences the | | | | | conference ID is | | | | | used as the | | | | | value of this | | | | | parameter. | | +------------------+----------+------------------+------------------+ | Service Specific | O~C~ | This field | AS | | Info | | contains service | | | | | specific data if | | | | | and as provided | | | | | by an | | | | | Application | | | | | Server. | | +------------------+----------+------------------+------------------+ | Message Bodies | O~C~ | This field holds | P-CSCF, S-CSCF, | | | | information | E-CSCF, MGCF, | | | | about the | IBCF, ATCF and | | | | Message body, | AS | | | | Content-Type, | | | | | Content-Length, | | | | | Con | | | | | tent-Disposition | | | | | and Originator | | | | | if available. | | +------------------+----------+------------------+------------------+ | Access Network | O~C~ | This field | Not in TF nor | | Information | | contains the | TRF | | | | content of one | | | | | P-header | | | | | P-Acce | | | | | ss-Network-Info, | | | | | if available. | | +------------------+----------+------------------+------------------+ | Access Transfer | O~C~ | This field | AS and ATCF | | Information | | contains | | | | | information | | | | | related to the | | | | | CS to PS or PS | | | | | to CS session | | | | | transfer. | | +------------------+----------+------------------+------------------+ | IMS | O~C~ | This field | S-CSCF, P-CSCF, | | Communication | | contains the IMS | E-CSCF, IBCF, | | Service ID | | communication | ATCF, TRF and AS | | | | service | | | | | identifier if | | | | | received in the | | | | | P- | | | | | Asserted-Service | | | | | header in the | | | | | SIP request for | | | | | all applicable | | | | | IMS nodes | | | | | downstream from | | | | | the Sâ€‘CSCF | | | | | serving the | | | | | Originating | | | | | party This field | | | | | contains the IMS | | | | | communication | | | | | service | | | | | identifier if | | | | | received in the | | | | | \"+g.3gpp.ics | | | | | i-ref\" header | | | | | field parameter | | | | | of the | | | | | Feature-Caps | | | | | header in the | | | | | SIP response for | | | | | all applicable | | | | | IMS nodes | | | | | upstream from | | | | | the Sâ€‘CSCF | | | | | serving the | | | | | Originating | | | | | party.. | | +------------------+----------+------------------+------------------+ | IMS Application | O~C~ | This field | P-CSCF | | Reference ID | | contains the IMS | | | | | application | | | | | reference | | | | | identifier if | | | | | received in the | | | | | SIP request. | | +------------------+----------+------------------+------------------+ | Cause Code | O~C~ | This field | All | | | | contains the | | | | | cause value. | | +------------------+----------+------------------+------------------+ | Real Time Tariff | O~C~ | This field holds | S-CSCF, IBCF, | | Information | | the | MGCF, AS | | | | tariff/add-on | | | | | charge received. | | +------------------+----------+------------------+------------------+ | Online Charging | O~C~ | This field | S-CSCF and | | Flag | | indicates the | AS/MRFC | | | | Online Charging | | | | | Request was sent | | | | | based on the | | | | | provided ECF | | | | | address from the | | | | | SIP P-header | | | | | "P-Charging-Func | | | | | tion-Addresses". | | | | | | | | | | NOTE: No proof | | | | | that online | | | | | charging action | | | | | has been taken | | +------------------+----------+------------------+------------------+ | Account | O~C~ | This field | OCS | | Expiration | | indicates the | | | | | subscriber | | | | | account | | | | | expiration date | | | | | and time of day. | | +------------------+----------+------------------+------------------+ | Initial IMS | O~C~ | This field holds | AS and ATCF | | Charging | | the Initial IMS | | | Identifier | | charging | | | | | identifier | | | | | (ICID) as | | | | | generated by the | | | | | IMS node for the | | | | | initial SIP | | | | | session created | | | | | for IMS service | | | | | continuity. | | +------------------+----------+------------------+------------------+ | NNI Information | O~C~ | This field holds | S-CSCF, BGCF,\ | | | | information | IBCF, TF, TRF | | | | about the NNI | | | | | used for | | | | | interconnection | | | | | and roaming. | | +------------------+----------+------------------+------------------+ | From Address | O~M~ | Contains the | All | | | | information from | | | | | the SIP From | | | | | header. | | +------------------+----------+------------------+------------------+ | IMS Emergency | O~C~ | This field | P-CSCF, S-CSCF, | | Indication | | indicates the | I-CSCF | | | | registration is | | | | | an emergency | | | | | registration or | | | | | the IMS session | | | | | is an IMS | | | | | emergency | | | | | session | | +------------------+----------+------------------+------------------+ | IMS Visited | O~C~ | Contains the | P-CSCF, S-CSCF, | | Network | | information from | and AS | | Information | | the SIP | | | | | P-Vi | | | | | sited-Network-ID | | | | | header. | | +------------------+----------+------------------+------------------+ | SIP Route header | O~C~ | Contains the | P-CSCF, S-CSCF, | | received | | information in | IBCF, TRF, ATCF, | | | | the topmost | TF | | | | route header in | | | | | a received | | | | | initial SIP | | | | | INVITE or | | | | | non-session | | | | | related SIP | | | | | MESSAGE request. | | +------------------+----------+------------------+------------------+ | SIP Route header | O~C~ | Contains the | P-CSCF, S-CSCF, | | transmitted | | information in | I-CSCF, ATCF, TF | | | | the route header | | | | | representing the | | | | | destination in a | | | | | transmitted | | | | | initial SIP | | | | | INVITE or | | | | | non-session | | | | | related SIP | | | | | MESSAGE request. | | +------------------+----------+------------------+------------------+
### 6.3.2 Detailed Message Format for offline charging
The following chapter specifies per Operation Type the charging data that are
sent by each of the IMS network elements for:
  * IMS session and IMS event (S/I/S/E)
  * S-CSCF, E-CSCF, P-CSCF, MGFC, AS, IBCF, TRF, ATCF, TF
  * IMS session only (S/I/S)
  * MRFC
  * IMS event only (E)
  * I-CSCF, BGCF
The Operation Types are listed in the following order: S (start)/I (interim)/S
(stop)/E (event). Therefore, when all Operation Types are possible it is
marked as SISE. If only some Operation Types are allowed for a node, only the
appropriate letters are used (i.e. SIS or E) as indicated in the table
heading. The omission of an Operation Type for a particular field is marked
with \"-\" (i.e. SI-E). Also, when an entire field is not allowed in a node
the entire cell is marked as \"-\".
Table 6.3.2.1 illustrates the basic structure of the supported fields in the
Charging Data Request message for IMS offline charging.
Table 6.3.2.1: Supported fields in _Charging Data Request_ Message
Field | Node Type | S-CSCF | E-CSCF | P-CSCF | I-CSCF | MRFC | MGCF | BGCF | AS | IBCF | TF | TRF | ATCF  
---|---|---|---|---|---|---|---|---|---|---|---|---|---  
Supported Operation Types | S/I/S/E | S/I/S/E | S/I/S/E | E | S/I/S | S/I/S/E | E | S/I/S/E | S/I/S/E | S/I/S/E | S/I/S/E | **S/I/S/E** |   
Session Identifier | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Originator Node | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Originator Domain | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Destination Domain | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Operation Type | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Operation Number | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Operation Identifier | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
User Name (see note 1) | SISE | - | SISE | - | - | - | - | SISE | - | - | - | SISE |   
Destination Host | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Operation Interval | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Origination State | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Origination Timestamp | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Proxy Information | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Route Information | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Operation Token | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Subscriber Identifier | SISE | SISE | SISE | - | SIS | - | - | SISE | - | - | SISE | SISE |   
**Service Information with PS and IMS Information** |  |  |  |  |  |  |  |  |  |  |  |  |   
Event Type | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Role of Node | SISE | SISE | SISE | E | \--- | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Node Functionality | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
User Session Id | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Outgoing Session ID | - | - | - | - | - | - | - | SISE | - | - | - | - |   
Session Priority | S--E | S--E | S--E | E | S-- | S--E | E | S--E | S--E | S--E | S--E | S--E |   
Calling Party Address | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Called Party Address | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Number Portability routing information | S--E | - | - | E | - | S--E | E | S--E | - | S--E | S--E | - |   
Carrier Select routing information | S--E | - | - | E | - | S--E | E | S--E | - | S--E | S--E | - |   
Alternate Charged Party Address | - | - | - | - | - | - | - | S--- | - | - | - | - |   
Requested Party Address | S--E | S--E | - | - | S-- | - | - | SISE | - | S--E | S--E | SISE |   
Called Asserted Identity | S--E | S--E | S--E | - | S-- | - | - | S--E | - | S--E | S--E | S--E |   
Associated URI  
(see note 5) | \---E | - | \---E | E | - | - | - | - | \---E | - | - | - |   
Time stamps  
(see note 3) | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Application server Information  
(see note 1) | SISE | SISE | - | - | SIS | - | - | - | - | SISE | SISE | - |   
Inter Operator Identifiers  
(see note 1) | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Transit IOI List  
(see note 1) | SISE | - | SISE | - | SIS | SISE | E | SISE | SISE | SISE | SISE | - |   
IMS Charging Identifier | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE | SISE | SISE |   
Related IMS Charging Identifier | - | - | SISE | - | - | - | - | - | - | - | - | - |   
Related IMS Charging Identifier Generation Node | - | - | SISE | - | - | - | - | - | - | - | - | - |   
Early Media Description  
(see note 4) | S--E | S--E | S--E | - | S-- | S--E | - | S--E | S--E | S--E | S--E | S--E |   
SDP Session Description | SI- E | SI- E | SI- E | - | SI- E | SI- E | - | SI- E | SI- E | SI- E | SI- E | SI- E |   
SDP Media Component  
(see note 4) | SI- E | SI- E | SI- E | - | SI- E | SI- E | - | SI- E | SI- E | SI- E | SI- E | SI- E |   
GGSN Address | SI-- | SI-- | SI-- | - | SI-- | SI-- | - | SI-- | - | - | - | SI-- |   
User Location Info | SISE | SISE | SISE | E | SIS | - | - | SISE | SISE | - | SISE | SISE |   
MS Time Zone | SISE | SISE | SISE | E | SIS | - | - | SISE | SISE | - | SISE | SISE |   
Served Party  
(see note 1) | - | - | SISE | - | - | - | - | - | - | - | - | - |   
Server Capabilities (see note 1) | - | - | - | E | - | - | - | - | - | - | - | - |   
Trunk Group ID  
(see note 1) | - | - | - | - | - | SISE | - | - | - | - | - | - |   
Bearer Service  
(see note 1) | - | - | - | - | - | SISE | - | - | - | - | - | - |   
Service Id  
(see note 1) | - | - | - | - | SIS | - | - | - | - | - | - | - |   
Service Specific Info (see note 1) | - | - | - | - | - | - | - | SISE | - | - | - | - |   
Message Bodies (see note 2) | SISE | SISE | SISE | - | - | SISE | - | SISE | SISE | SISE | SISE | SISE |   
Cause Code | \--SE | \--SE | \--SE | E | \--S | \--SE | E | \--SE | \--SE | \--SE | \--SE | \--SE |   
Access Network Information | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | - | - | SISE |   
IMS Communication Service ID | S--E | S--E | S--E | - | - | - | - | S--E | S--E | S--E | S--E | S--E |   
IMS Application Reference ID | - | - | S--E | - | - | - | - | - | - | - | - | - |   
Real Time Tariff Information | SI-E | - | - | - | - | SI-E | - | SI-E | SI-E | - | - | - |   
Initial IMS Charging Identifier | - | - | - | - | - | - | - | SISE | - | - | - | SISE |   
NNI Information | S--E | - | S--E | - | - | - | - | E | S--E | S--E | S--E | - |   
From Address | SISE | SISE | SISE | E | SIS | SISE | E | SISE | SISE | SISE |  | SISE |   
Access Transfer Information | - | - | - | - | - | - | - | -ISE | - | - | - | -ISE |   
IMS Emergency Indication | SISE | - | SISE | E | - | - | - | - | - | - | - | - |   
IMS Visited Network Identifier (see note 1) | SISE | - | SISE | - | - | - | - | SISE | - | - | - | - |   
Route Header Received | S--E | - | S--E | E | - | - | - | - | S--E | S--E | S--E | S--E |   
Route Header Transmitted | S--E | - | S--E | E | - | - | - | - | - | S--E | - | S--E |   
TAD Identifier | - | - | - | - | - | - | - | S--- | - | - | - | - |   
NOTE 1: Only present if available in the CTF of the IMS node. NOTE 2: Present only if Messages Bodies is included in the SIP message that triggered the Charging Data Request. NOTE 3: Only present if ACR is triggered on a SIP message (e.g. SIP INVITE, SIP UPDATE). NOTE 4: To be determined for presence in IBCF. NOTE 5: Only present if ACR is triggered on SIP REGISTER 200 OK. |  |  |  |  |  |  |  |  |  |  |  |  |   
Table 6.3.2.2 illustrates the basic structure of the supported fields in the
Charging Data Response message for IMS offline charging.
Table 6.3.2.2: Supported fields in _Charging Data Response_ Message
* * *
Field **Node Type** S-CSCF E-CSCF P-CSCF I-CSCF MRFC MGCF BGCF AS IBCF TRF
ATCF Supported Operation Types S/I/S/E S/I/S/E S/I/S/E E S/I/S S/I/S/E E
S/I/S/E S/I/S/E S/I/S/E S/I/S/E Session Identifier SISE SISE SISE E SIS SISE E
SISE SISE SISE SISE  
Originator Node SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Originator Domain SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Destination Domain SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Operation Type SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Operation Number SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Operation Identifier SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
User Name SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Operation Interval SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Origination State SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Origination Timestamp SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Proxy Information SISE SISE SISE E SIS SISE E SISE SISE SISE SISE  
Route Information SISE SISE SISE E SIS SISE E SISE SISE SISE SISE
* * *
### 6.3.3 Detailed Message Format for online charging
The following table specifies per Operation type the charging data that are
sent by each of the IMS network elements for:
  * IMS session and IMS event (I/U/T/E)
```{=html}
``` \- IMS-GWF, AS
```{=html}
``` \- IMS session only (I/U/T)
```{=html}
``` \- MRFC
The Operation types are listed in the following order: I (initial)/U
(update)/T (terminate)/E (event). Therefore, when all Operation types are
possible it is marked as IUTE. If only some Operation types are allowed for a
node, only the appropriate letters are used (i.e. IUT or E) as indicated in
the table heading. The omission of an Operation type for a particular field is
marked with \"-\" (i.e. IU-E). Also, when an entire filed is not allowed in a
node the entire cell is marked as \"-\".
Note that not for all structured fields the individual field members are
listed in the table. Detailed descriptions of the fields are provided in TS
32.299 [50].
Table 6.3.3.1 illustrates the basic structure of the supported fields in the
Debit and Reserve Units Request for IMS online charging.
Table 6.3.3.1: Supported fields in _Debit and Reserve Units Request_ Message
+-------------------+-----------------+---------+--------+---------+ | Field | **Node Type** | IMS-GWF | MRFC | AS | +-------------------+-----------------+---------+--------+---------+ | | Supported | I/U/T/E | I/U/T | I/U/T/E | | | | | | | | | Operation Types | | | | +-------------------+-----------------+---------+--------+---------+ | Session | IUTE | IUT | IUTE | | | Identifier | | | | | +-------------------+-----------------+---------+--------+---------+ | Originator Host | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Originator Domain | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Destination | IUTE | IUT | IUTE | | | Domain | | | | | +-------------------+-----------------+---------+--------+---------+ | Operation | IUTE | IUT | IUTE | | | Identifier | | | | | +-------------------+-----------------+---------+--------+---------+ | Operation Token | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Operation Type | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Operation Number | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Destination Host | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | User Name | IUTE | - | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Origination State | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Origination | IUTE | IUT | IUTE | | | Timestamp | | | | | +-------------------+-----------------+---------+--------+---------+ | Subscriber | IUTE | IUT | IUTE | | | Identifier | | | | | +-------------------+-----------------+---------+--------+---------+ | Termination Cause | ---T- | ---T | ---T- | | +-------------------+-----------------+---------+--------+---------+ | Requested Action | ---E | - | ---E | | +-------------------+-----------------+---------+--------+---------+ | Multiple | IUTE | IUT | IUTE | | | Operation | | | | | +-------------------+-----------------+---------+--------+---------+ | Multiple Unit | IUTE | IUT | IUTE | | | Operation | | | | | +-------------------+-----------------+---------+--------+---------+ | Service Units | IU-E | IU- | IU-E | | | Requested | | | | | +-------------------+-----------------+---------+--------+---------+ | Service Units | -UT- | -UT | -UT- | | | Used | | | | | +-------------------+-----------------+---------+--------+---------+ | Subscriber | IUTE | IUT | IUTE | | | Equipment Number | | | | | +-------------------+-----------------+---------+--------+---------+ | Proxy Information | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Route Information | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Extended | IUTE | IUT | IUTE | | | Information | | | | | +-------------------+-----------------+---------+--------+---------+ | **Service | | | | | | Information with | | | | | | PS and IMS | | | | | | Information** | | | | | +-------------------+-----------------+---------+--------+---------+ | Event Type | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Role Of Node | IUTE | --- | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Node | IUTE | IUT | IUTE | | | Functionality | | | | | +-------------------+-----------------+---------+--------+---------+ | User Session Id | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Outgoing Session | - | - | IUTE | | | ID | | | | | +-------------------+-----------------+---------+--------+---------+ | Session Priority | I--E | I-- | I--E | | +-------------------+-----------------+---------+--------+---------+ | Calling Party | IUTE | IUT | IUTE | | | Address | | | | | +-------------------+-----------------+---------+--------+---------+ | Called Party | IUTE | IUT | IUTE | | | Address | | | | | +-------------------+-----------------+---------+--------+---------+ | **Number | I--E | - | I--E | | | Portability | | | | | | routing | | | | | | information** | | | | | +-------------------+-----------------+---------+--------+---------+ | **Carrier Select | I--E | - | I--E | | | routing | | | | | | information** | | | | | +-------------------+-----------------+---------+--------+---------+ | Requested Party | I--E | I-- | I--E | | | Address | | | | | +-------------------+-----------------+---------+--------+---------+ | Called Asserted | -U-E | -U- | -U-E | | | Identity | | | | | +-------------------+-----------------+---------+--------+---------+ | Associated URI | ---E | - | - | | +-------------------+-----------------+---------+--------+---------+ | Application | IUTE | IUT | - | | | Server | | | | | | Information | | | | | +-------------------+-----------------+---------+--------+---------+ | Inter Operator | IUTE | IUT | IUTE | | | Identifier | | | | | +-------------------+-----------------+---------+--------+---------+ | Transit IOI List | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | IMS Charging | IUTE | IUT | IUTE | | | Identifier | | | | | +-------------------+-----------------+---------+--------+---------+ | SDP Session | IU-- | IU- | IU-- | | | Description | | | | | +-------------------+-----------------+---------+--------+---------+ | SDP Media | IU-- | IU- | IU-- | | | Component | | | | | +-------------------+-----------------+---------+--------+---------+ | GGSN Address | IU-- | IU- | IU-- | | +-------------------+-----------------+---------+--------+---------+ | User Location | IUTE | IUT | IUTE | | | Info | | | | | +-------------------+-----------------+---------+--------+---------+ | MS Time Zone | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Served Party | - | - | - | | +-------------------+-----------------+---------+--------+---------+ | Server | - | - | - | | | Capabilities | | | | | +-------------------+-----------------+---------+--------+---------+ | Trunk Group ID | - | - | - | | +-------------------+-----------------+---------+--------+---------+ | Bearer Service | - | - | - | | +-------------------+-----------------+---------+--------+---------+ | Service Id | - | IUT | - | | +-------------------+-----------------+---------+--------+---------+ | Service Specific | - | - | - | | | Info | | | | | +-------------------+-----------------+---------+--------+---------+ | Messages Bodies | IUTE | - | IUTE | | +-------------------+-----------------+---------+--------+---------+ | Cause Code | --TE | --T | --TE | | +-------------------+-----------------+---------+--------+---------+ | Access Network | IUTE | IUT | IUTE | | | Information | | | | | +-------------------+-----------------+---------+--------+---------+ | IMS Communication | I--E | - | I---E | | | Service ID | | | | | +-------------------+-----------------+---------+--------+---------+ | Tariff | -U-- | - | -U-- | | | Information | | | | | +-------------------+-----------------+---------+--------+---------+ | Initial IMS | - | - | IUTE | | | Charging | | | | | | Identifier | | | | | +-------------------+-----------------+---------+--------+---------+ | From Address | IUTE | IUT | IUTE | | +-------------------+-----------------+---------+--------+---------+ | IMS Emergency | - | - | - | | | Indication | | | | | +-------------------+-----------------+---------+--------+---------+ | IMS Visited | IUTE | - | IUTE | | | Network | | | | | | Identification | | | | | +-------------------+-----------------+---------+--------+---------+ | Route Header | - | - | - | | | Received | | | | | +-------------------+-----------------+---------+--------+---------+ | Route Header | - | - | - | | | Transmitted | | | | | +-------------------+-----------------+---------+--------+---------+
Table 6.3.3.2 illustrates the basic structure of the supported fields in the
Debit and Reserve Units Response for IMS online charging.
Table 6.3.3.2: Supported fields in _Debit and Reserve Units Response_ Message
+--------------------+-----------------+---------+-------+---------+ | Field | **Node Type** | IMS-GWF | MRFC | AS | +--------------------+-----------------+---------+-------+---------+ | | Supported | I/U/T/E | I/U/T | I/U/T/E | | | | | | | | | Operation Types | | | | +--------------------+-----------------+---------+-------+---------+ | Session Identifier | IUTE | IUT | IUTE | | +--------------------+-----------------+---------+-------+---------+ | Operation Result | IUTE | IUT | IUTE | | +--------------------+-----------------+---------+-------+---------+ | Originator Host | IUTE | IUT | IUTE | | +--------------------+-----------------+---------+-------+---------+ | Originator Domain | IUTE | IUT | IUTE | | +--------------------+-----------------+---------+-------+---------+ | Operation | IUTE | IUT | IUTE | | | Identifier | | | | | +--------------------+-----------------+---------+-------+---------+ | Operation Type | IUTE | IUT | IUTE | | +--------------------+-----------------+---------+-------+---------+ | Operation Number | IUTE | IUT | IUTE | | +--------------------+-----------------+---------+-------+---------+ | Operation Failover | IUTE | IUT | IUTE | | +--------------------+-----------------+---------+-------+---------+ | Multiple Unit | IUTE | IUT | IUTE | | | Operation | | | | | +--------------------+-----------------+---------+-------+---------+ | Operation Failure | - | - | - | | | Action | | | | | +--------------------+-----------------+---------+-------+---------+ | Redirection Host | - | - | - | | +--------------------+-----------------+---------+-------+---------+ | Redirection Host | - | - | - | | | Usage | | | | | +--------------------+-----------------+---------+-------+---------+ | Redirection Cache | - | - | - | | | Time | | | | | +--------------------+-----------------+---------+-------+---------+ | Proxy Information | - | - | - | | +--------------------+-----------------+---------+-------+---------+ | Route Information | - | - | - | | +--------------------+-----------------+---------+-------+---------+ | Failed parameter | - | - | - | | +--------------------+-----------------+---------+-------+---------+ | Extended | IUTE | IUT | IUTE | | | Information | | | | | +--------------------+-----------------+---------+-------+---------+ | **Service | | | | | | Information with | | | | | | IMS Information** | | | | | +--------------------+-----------------+---------+-------+---------+ | Account Expiration | - | - | IUTE | | +--------------------+-----------------+---------+-------+---------+
### 6.3.4 Formal IMS charging parameter description
#### 6.3.4.1 IMS charging information for CDRs
The detailed definitions, abstract syntax and encoding of the IMS CDR
parameters are specified in TS 32.298 [51].
#### 6.3.4.2 IMS charging information for charging events
The detailed charging event parameter definitions are specified in 3GPP TS
32.299 [50].
###### ## Annex A (informative): Bibliography
**a) The 3GPP charging specifications**
\- 3GPP TS 32.252: \"Telecommunication management; Charging management;
Wireless Local Area Network (WLAN) charging\".
\- 3GPP TS 32.270: \"Telecommunication management; Charging management;
Multimedia Messaging Service (MMS) charging\".
\- 3GPP TS 32.271: \"Telecommunication management; Charging management;
Location Services (LCS) charging\".
\- 3GPP TS 32.296: \"Telecommunication management; Charging management; Online
Charging System (OCS) applications and interfaces\".
**b) Common 3GPP specifications**
\- 3GPP TS 22.101: \"Service aspects; Service Principles\".
\- 3GPP TS 22.115 \"Service aspects; Charging and Billing\".
\- 3GPP TS 23.003: \"Numbering, addressing and identification\".
\- 3GPP TS 27.001: \"General on Terminal Adaptation Functions (TAF) for Mobile
Stations (MS)\".
**c) other Domain and Service specific 3GPP / ETSI specifications**
-
**d) Relevant ITU Recommendations**
\- ITU-T Recommendation D.93: \"Charging and accounting in the international
land mobile telephone service (provided via cellular radio systems)\".
\- ITU-T Recommendation E.164: \"The international public telecommunication
numbering plan\".
\- ITU-T Recommendation Q.767: \"Application of the ISDN user part of CCITT
signalling System No.7 for international ISDN interconnections\".
\- ITU-T Recommendation X.25: \"Interface between Data Terminal Equipment
(DTE) and Data Circuit-terminating Equipment (DCE) for terminals operating in
the packet mode and connected to public data networks by dedicated circuit\".
\- ITU-T Recommendation X.121: \"International numbering plan for public data
networks\".
**e) Relevant IETF RFCs**
\- IETF RFC 959 (1985): \"File Transfer Protocol\".
###### ## Annex B (informative): Message Flows for Service Termination by OCS
This annex describes several scenarios related to IMS service termination in
IMS-GWF.
SIP messages and Diameter transactions associated with these charging
scenarios are shown primarily to illustrate the service termination
procedures. They are not intended to be exhaustive and depend on the Diameter
Credit Control Requests triggers configured by the operator. The triggers for
sending Debit and Reserve Unit Requests from the IMS-GWF to the OCS are
defined according to table 5.3.1.
## B.1 Scenario 1 - Session Related (SCUR): Service Termination on reception
of an initial SIP INVITE Request
Figure B.1.1 : Service Termination triggered by an initial SIP Request
## B.2 Scenario 2 - Session Related (SCUR): Service Termination triggered
after an early SIP Dialog is established
Figure B.2.1: Service Termination triggered by the 200OK response to the
initial INVITE
Figure B.2.2 : Service Termination triggered by an UPDATE request within an
early SIP dialog
Figure B.2.3 : Service Termination triggered by the 200OK to an UPDATE request
within an early SIP dialog
## B.3 Scenario 3 - Session Related (SCUR): Service Termination triggered
after a confirmed SIP Dialog is established
Figure B.3.1 : Service Termination triggered by a re-INVITE request within a
confirmed SIP dialog
Figure B.3.2: Service Termination triggered by the 200OK response to a re-
INVITE request within a confirmed SIP dialog
Figure B.3.3 : Service Termination triggered by the Charging Application
procedures as defined in TS 32.299 [50] within a confirmed SIP dialog
## B.4 Scenario 4 - Session Unrelated (ECUR): Service Termination on reception
of an initial SIP non-INVITE Request
Figure B.4.1 : Service Termination triggered by the reception of a non-INVITE
SIP request
## B.5 Scenario 5 - Session Unrelated (IEC): Service Termination on reception
of an initial SIP non-INVITE Request
Figure B.5.1 : Service Termination triggered by the reception of a non-INVITE
SIP request
#