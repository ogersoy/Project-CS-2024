# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
CS Fallback in the Evolved Packet System (EPS) enables the provisioning of CS-
domain services (e.g. voice call, Location Services (LCS) or supplementary
services) by reuse of CS infrastructure when the UE is served by E-UTRAN.
Additionally, SMS delivery via the CS core network is realized without CS
fallback.
The present document specifies the procedures and the SGs Application Part
(SGsAP) messages used on the SGs interface between the Mobility Management
Entity (MME) in the EPS and the Visitor Location Register (VLR), to allow
location management coordination and to relay certain messages related to GSM
circuit switched services over the EPS system.
The present document also specifies the use of Stream Control Transmission
Protocol (SCTP) for the transport of SGsAP messages.
The present document is applicable to the MME in the EPS and to the VLR. The
functional split between the MME and the VLR is defined in 3GPP TS 23.272 [7].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.101: \"Service aspects; Service principles\".
[3] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[4] 3GPP TS 23.007: \"Restoration procedures\".
[5] 3GPP TS 23.018: \"Basic call handling; Technical realization\".
[5AA] 3GPP TS 23.078: \"Customised Applications for Mobile network Enhanced
Logic (CAMEL) Phase 4; Stage 2\".
[5A] 3GPP TS 23.081: \"Line identification supplementary services\".
[5B] 3GPP TS 23.082: \"Call Forwarding (CF) supplementary services\".
[6] Void.
[6A] 3GPP TS 23.236: \"Intra-domain connection of Radio Access Network (RAN)
nodes to multiple Core Network (CN) nodes\".
[7] 3GPP TS 23.272: \"Circuit Switched Fallback in Evolved Packet System;
Stage 2\".
[7A] 3GPP TS 23.251: \"Network Sharing; Architecture and Functional
Description\".
[8] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core
network protocols; Stage 3\".
[9] 3GPP TS 24.010: \"Supplementary services specification; General aspects\".
[10] 3GPP TS 24.011: \"Point-to-Point (PP) Short Message Service (SMS) support
on mobile radio interface\".
[11] 3GPP TS 24.030: \"Location Services (LCS); Supplementary service
operations; Stage 3\".
[12] 3GPP TS 24.081: \"Line Identification Supplementary Services - Stage 3\".
[13] 3GPP TS 24.082: \"Call Forwarding (CF) supplementary services; Stage 3\".
[14] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[15] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[15A] 3GPP TS 29.011: \"Signalling interworking for supplementary services\".
[16] 3GPP TS 29.018: \"Serving GPRS Support Node (SGSN) - Visitors Location
Register (VLR) Gs interface layer 3 specification\".
[17] 3GPP TS 29.272: \"MME and SGSN Related Interfaces Based on Diameter
Protocol\".
[17A] 3GPP TS 29.274: \"3GPP Evolved Packet System (EPS); Evolved General
Packet Radio Service (GPRS) Tunnelling Protocol for Control plane (GTPv2-C);
Stage 3\".
[17B] 3GPP TS 32.250: \"Telecommunication management; Charging management;
Circuit Switched (CS) domain charging\".
[18] 3GPP TS 32.422: \"Telecommunication management; Subscriber and equipment
trace; Trace control and configuration management (CM)\".
[19] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC) protocol specification\".
[20] IETF RFC 791 (September 1981): \"Internet Protocol\".
[21] Void.
[22] IETF RFC 2460 (December 1998): \"Internet Protocol, Version 6 (IPv6)
Specification\".
[23] IETF RFC 4960 (September 2007): \"Stream Control Transmission Protocol\".
[24] 3GPP TS 22.067: \"enhanced Multi Level Precedence and Pre-emption service
(eMLPP); Stage 1\".
[25] 3GPP TS 23.067: \" enhanced Multi-Level Precedence and Pre-emption
service (eMLPP); Stage 2\".
[26] 3GPP TS 23.216: \"Single Radio Voice Call Continuity; Stage 2\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] apply. Additionally the following definitions of 3GPP TS
24.301 [14] apply:
**Non-EPS services**
**SMS only**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.272 [7] apply:
**CS fallback**
**SMS over SGs**
**SMS in MME**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.251 [7A] apply:
> **Common PLMN**
**Gateway core network (GWCN)**
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
LCS Location Services
MME Mobility Management Entity
NEAF Non-EPS Alert Flag
SCTP Stream Control Transmission Protocol
SGsAP SGs Application Part
SMS Short Message Service
PSI Provide Subscriber Information
# 4 Description of the SGs association between a VLR and an MME
## 4.1 General
CS fallback function and SMS delivery via the CS core network is realized by
reusing Gs interface mechanisms as defined in 3GPP TS 29.018 [16] on the
interface between the MME in the EPS and the VLR. This interface is called SGs
interface.
NOTE: Within this specification, the term VLR refers to MSC/VLR or MSC
Server/VLR.
The SGs interface connects the databases in the VLR and the MME. The
procedures described in the present document are used to co-ordinate the
location information of UEs that are IMSI attached to both EPS and non-EPS
services. The SGs interface is also used to convey some circuit switched
related procedures via the MME.
The basis for the interworking between a VLR and an MME is the existence of a
SGs association between those entities per UE. The SGs association is
applicable to UEs which are configured to use CS fallback and SMS over SGs, or
SMS over SGs only. The SGs association is not applicable if the subscriber
data indicates that the subscription is for packet only. The SGs association
is also not applicable if the MME is registered for SMS for the UE as
specified in 3GPP TS 23.272 [7].
The behaviour of the VLR and the MME entities related to the SGs interface are
defined by the state of the SGs association for a UE. Individual SGs
association states are maintained at both the VLR and the MME for each UE.
## 4.2 SGs association at the VLR
### 4.2.1 General
The states associated to the SGs interface in the VLR are specified in
subclause 4.2.2 and the state diagram at the VLR is shown in figure 4.2.2.1.
The state diagram does not include the message error handling specified in
clause 7.
### 4.2.2 States at the VLR
SGs-NULL
> There is no SGs association with an MME for the UE and therefore the VLR
> considers that the UE is IMSI detached for EPS services. In this state no
> SGsAP-MM-INFORMATION-REQUEST messages are sent to the MME. The VLR may
> initiate paging on the SGs interface if the \"Confirmed by Radio Contact\"
> restoration indicator in the VLR is set to \"false\" (see 3GPP TS 23.007
> [4]). Any message from the MME is ignored except SGsAP-LOCATION-UPDATE-
> REQUEST, SGsAP-IMSI-DETACH-INDICATION and SGsAP-EPS-DETACH-INDICATION.
LA-UPDATE-PRESENT
> The VLR has received an SGsAP-LOCATION-UPDATE-REQUEST message from the MME.
> In this state, the VLR may be waiting for the outcome of the Update Location
> procedure from the HSS, if the IMSI is not known in the VLR. For UEs which
> are configured to use CS fallback and SMS over SGs, or SMS over SGs only,
> the VLR sends SGsAP-PAGING-REQUEST messages via the SGs interface.
SGs-ASSOCIATED
> The VLR considers that the UE is attached to both EPS and non-EPS services.
> For UEs which are configured to use CS fallback and SMS over SGs, or SMS
> over SGs only, the VLR sends SGsAP-PAGING-REQUEST messages via the SGs
> interface. The VLR can perform the MM information procedure.
NOTE: Receipt of an SGsAP-RESET-INDICATION message from the MME may change or
not the state of the SGs interface of all the associations associated to the
restarted MME, see subclause 5.8.3.
Figure 4.2.2.1: State diagram at the VLR
## 4.3 SGs association at the MME
### 4.3.1 General
The MM context variables associated to the SGs interface in the MME are
specified in subclause 4.3.2 and states associated to the SGs interface in the
MME are specified in subclause 4.3.3. The state diagram at the MME is shown in
figure 4.3.3.1. The state diagram does not include the message error handling
specified in clause 7.
### 4.3.2 MM context variables at the MME
VLR-Reliable:
> Boolean set to \"false\" when the MME has received a reset indication from
> the VLR. The MME may request the UE, upon reception of the next tracking
> area update (periodic or combined) procedure, to re-attach to non-EPS
> services if the UE is still IMSI attached to non-EPS services.
> Alternatively, the MME may, upon reception of a periodic or combined
> tracking area update request from a UE that is still attached for non-EPS
> services, perform immediately the location update for non-EPS services
> procedure.
MME-Reset:
> Boolean set to \"true\" when the MME restarts after a failure. The \"MME-
> Reset\" restoration indicator is unique within an MME and it applies to all
> the MM contexts stored in the MME.
### 4.3.3 States at the MME
SGs-NULL
> There is no SGs association with a VLR for the UE and therefore the MME
> considers that the UE is IMSI detached for non-EPS services. In this state
> the MME accepts SGsAP-PAGING-REQUEST messages to UEs only if the \"MME-
> Reset\" restoration indicator in the MME is set to \"true\".
LA-UPDATE-REQUESTED
> The MME has sent an SGsAP-LOCATION-UPDATE-REQUEST message to the VLR. In
> this state the MME waits for the outcome of the Update Location for non-EPS
> services procedure at the VLR before sending the response to the UE. In this
> state the MME accepts SGsAP-PAGING-REQUEST messages.
SGs-ASSOCIATED
> The MME stores an SGs association for the UE. In this state the MME performs
> the location update for non-EPS services procedure towards the VLR, e.g.
> when the location area is changed. All conditions describing when to trigger
> the location update for non-EPS services procedure are listed in subclause
> 5.2.2.2.
NOTE: A normal attach request or attach request for emergency bearer services
causes the same state transition as a normal tracking area update request.
Figure 4.3.3.1: State diagram at the MME
### 4.3.4 State transitions in the MME without SGsAP signaling
If it is required by network configuration or operator policy, the MME shall
change the state of the SGs association to SGs-NULL if the following
conditions are fulfilled:
\- the MME receives an EXTENDED SERVICE REQUEST message with service type set
to \"mobile originating CS fallback emergency call or 1xCS fallback emergency
call\";
\- the state of the SGs association is not SGs-NULL; and
\- the MME determines that the UE is not available for PS services at the
target RAT as described in 3GPP TS 23.272 [7].
# 5 Procedures for SGs
## 5.1 Paging for non-EPS services procedure
### 5.1.1 General description
This procedure is used by the VLR to send an SGsAP-PAGING-REQUEST message to a
UE. This procedure applies to UEs that are simultaneously attached for EPS
services and non-EPS services, or for EPS services and SMS only.
### 5.1.2 Procedures in the VLR
#### 5.1.2.1 General
The VLR shall handle the timers, queuing and retransmission for sending the
SGsAP-PAGING-REQUEST message on the SGs interface in the same way that it
handles the sending of a PAGING message on the A or Iu interface.
#### 5.1.2.2 Paging Initiation
When a VLR has to page a UE, the VLR shall check whether the VLR has a SGs
association for that UE. The VLR sends SGsAP-PAGING-REQUEST messages to the
MME if the MME is in service and the state of the SGs association for the UE
is in any of the following states:
\- SGs-ASSOCIATED;
\- LA-UPDATE-PRESENT or
\- SGs-NULL and the \"Confirmed by Radio Contact\" restoration indicator is
set to \"false\".
If the VLR detects that the MME serving the UE is no longer in service and the
VLR supports MT CS services delivery via an alternative MME in the MME pool as
defined in 3GPP TS 23.007 [4], the VLR shall send the SGs-PAGING-REQUEST
message to one alternative MME in the same MME pool. The VLR shall set the CS
restoration indicator in the Additional paging indicators information element.
NOTE 1: The VLR can detect that an MME is no longer in service if there are no
SCTP associations in service with that MME.
The sending of the SGsAP-PAGING-REQUEST message does not change the state of
the SGs association with the MME.
If the \"Confirmed by Radio Contact\" restoration indicator is set to
\"true\", the VLR shall include the Location area identifier information
element into the SGsAP-PAGING-REQUEST message, otherwise (i.e. after a VLR
failure), the VLR shall not include the Location area identifier information
element. When sending the SGsAP-PAGING-REQUEST message, the VLR shall start
timer Ts5.
If the state of the SGs association is SGs-NULL and the \"Confirmed by Radio
Contact\" restoration indicator is set to \"false\", the VLR shall also
perform a search procedure as specified in 3GPP TS 23.018 [5].
In this message, the VLR includes the Service indicator information element
which will be used to indicate the type of CS service. If the SGs paging
request is sent as a result of reception of Provide Subscriber Information
Request message, the VLR sets the Service indicator information element to
either \"SMS indicator\" or \"CS call indicator\" as specified in subclause
7.2.3.5 of 3GPP TS 23.018 [5]. For SMS, SMS indicator is used. For all the
other CS services, CS call indicator is used.
If the network supports CSFB priority call handling (see 3GPP TS 23.272 [7])
and the call was received with an eMLPP priority level indication (see 3GPP TS
24.008 [8], 3GPP TS 22.067 [24] and 3GPP TS 23.067 [25]), the VLR shall
include the value of the received priority level indication in the eMLPP
priority information element in the SGsAP-PAGING-REQUEST message.
If the Calling Line Identification of the service (see 3GPP TS 24.081 [12]) is
available in the VLR, the VLR may include the CLI information element in the
SGsAP-PAGING-REQUEST message. The conditions specified in 3GPP TS 23.081 [5A]
and 3GPP TS 29.011 [15A] apply also here.
If the paging is due to a NW-initiated Call Independent SS procedure as
defined in 3GPP TS 24.010 [9], the VLR may include the SS code in the SGsAP-
PAGING-REQUEST message as defined in 3GPP TS 29.002 [15].
NOTE 2: The SS code used by the VLR does not link to a specific supplementary
service. The VLR can use any SS code defined in 3GPP TS 29.002 [15], in the
SGsAP-PAGING-REQUEST message.
If the paging is due to a Mobile Terminated Location Request as defined in
3GPP TS 24.030 [11], the VLR shall include LCS indicator in the SGsAP-PAGING-
REQUEST message. Additionally, the VLR may include LCS client identity as
defined in 3GPP TS 29.002 [15] in the SGsAP-PAGING-REQUEST message.
While domain specific access control of the PS domain is ongoing, the VLR
shall be configured to send paging messages on both the SGs and the A/Iu
interface. The VLR may apply implementation specific rules for sending the
paging on the A/Iu interface; e.g. paging on the A/Iu interface may be limited
to cases when the UE does not respond to a first paging on SGs interface.
#### 5.1.2.3 Paging Response
The VLR stops the paging procedure on expiry of timer Ts5 or on receipt of a
SGsAP-SERVICE-REQUEST message from the MME.
NOTE 1: On receipt of an SCCP connection establishment containing the Initial
L3 message from the UE via the A or Iu interface, the VLR stops the paging
procedure if ongoing, see 3GPP TS 24.008 [8].
Upon receiving the SGsAP-SERVICE-REQUEST message with the UE EMM mode
information element indicating \"EMM-CONNECTED\", if Call Forwarding on No
Reply (CFNRy) is activated for the subscriber, the VLR shall start the CFNRy
timer as specified in 3GPP TS 23.082 [5B].
If the paging response is received via the A or Iu interface from a location
area which differs from the one stored in the VLR, the VLR shall move the SGs
association to the SGs-NULL state after the UE has been authenticated
successfully.
NOTE 2: UE sends this paging response as a result of receiving paging request
with IMSI and with CN domain indicator set to \"CS\" (see 3GPP TS 24.301
[14]).
#### 5.1.2.4 Paging Failure
On receipt of an SGsAP-PAGING-REJECT message before the timer Ts5 expires, the
VLR stops timer Ts5. If the SGs cause information element in the SGsAP-PAGING-
REJECT message does not indicate \"Mobile terminating CS fallback call
rejected by the user\", the SGs association is moved to the SGs-NULL state and
within this state the SGs association is marked with the contents of the SGs
cause information element. If the SGs cause information element in the SGsAP-
PAGING-REJECT message indicates \"IMSI detached for EPS services\" the VLR
shall send the paging message on the A/Iu interface. If the SGs cause
information element indicates \"Mobile terminating CS fallback call rejected
by the user\", the SGs association state shall not be changed.
When the VLR receives the SGsAP-PAGING-REJECT message with the SGs cause
information element indicating \"Mobile terminating CS fallback call rejected
by the user\", the VLR shall trigger User Determined User Busy (UDUB) as
specified in 3GPP TS 24.082 [13].
#### 5.1.2.5 UE unreachable
On receipt of an SGsAP-UE-UNREACHABLE message before the timer Ts5 expires,
the VLR stops timer Ts5, and the paging procedure for that paging request
towards the MME is stopped. The state of the SGs association at the VLR is
unchanged.
NOTE 1: A/Iu paging can be ongoing.
NOTE 2: If the VLR considers the paging procedure completed, and no response
from the UE has been received, and CFNRc has been configured and activated for
the terminating UE, the VLR applies the equivalent handling as for Call
Forwarding on Not Reachable, as specified in 3GPP TS 23.082 [5B] and 3GPP TS
29.011 [15A].
### 5.1.3 Procedures in the MME
#### 5.1.3.1 General
The MME accepts SGsAP-PAGING-REQUEST messages in any state of the SGs
association. In the SGs-NULL state, the MME accepts SGsAP-PAGING-REQUEST
messages only if:
\- the \"MME-Reset\" restoration indicator is set to \"true\"; or
\- the MME supports MT CS services delivery via an alternative MME in the MME
pool as defined in 3GPP TS 23.007 [4] and the CS restoration indicator is set
in the Additional paging indicators information element in the SGs-PAGING-
REQUEST message.
When a MME receives a SGsAP-PAGING-REQUEST message from a VLR, the MME shall
first check if the UE is known by the MME. The handling of the paging request
depends on the state of the SGs association, the EMM context variables at the
MME, and the Service indicator information element in the SGsAP-PAGING-REQUEST
message. The MME shall process the paging request and subsequent SGs
procedures related to this request preferentially compared to other normal
procedures if the SGsAP-PAGING-REQUEST message includes the eMLPP priority
information element and if the MME determines the CS call has high priority
based on the received value in the eMLPP priority information element (see
3GPP TS 23.272 [7]).
If the Service indicator information element in the SGsAP-PAGING-REQUEST
message indicates \"CS call indicator\", the MME shall handle the paging
request as follows:
a) If the UE is known:
\- if the UE is considered to be IMSI attached for EPS services and \"SMS
only\", the MME shall return an SGsAP-PAGING-REJECT message to the VLR
indicating in the SGs cause information element \"Mobile terminating CS
fallback call rejected by the user\";
\- if the UE is considered to be IMSI attached for EPS and non-EPS services
(i.e. the SGs association is not in the state SGs-NULL), the MME shall page
the UE based on the location information stored in the MME, i.e. in all
tracking areas of the stored list. If the SGsAP-PAGING-REQUEST message does
not include the Location area identifier information element, the MME may set
the \"VLR-Reliable\" MM context variable to \"false\". If ISR is activated,
and in addition the SGsAP-PAGING-REQUEST message does not include the Location
area identifier or the \"VLR-Reliable\" MM context variable in the MME is set
to \"false\", then the MME shall send Detach Notification (Local Detach)
message to the associated SGSN;
\- if the MME detects that the UE currently has an EPS bearer context with
QCI=1 and the MME determines that SRVCC (as specified in 3GPP TS 23.216 [26])
is not supported in the network or it determines that the UE does not support
SRVCC, MME shall return SGsAP-PAGING-REJECT message to that VLR with SGs cause
information element \"Mobile terminating CS fallback call rejected by the
user\";
\- if the UE is marked as IMSI detached for EPS services or IMSI (implicitly
or explicitly) detached for non-EPS services (i.e. the state of the SGs
association is SGs-NULL):
\- if the UE is in the EMM-DEREGISTERED state (see 3GPP TS 24.301 [14]) and if
the MME supports MT CS services delivery via an alternative MME in the MME
pool and the CS restoration indicator is set in the SGsAP-PAGING-REQUEST
message, the MME shall send the paging request with the location information
provided by the VLR, regardless of the value of the \"MME-Reset\" indicator.
If no such location information is provided, the MME may either page the UE in
all the tracking areas served by that MME or in the tracking areas served by
the MME and by the VLR, or reject the paging request per operator policy;
\- otherwise, the MME shall return an SGsAP-PAGING-REJECT message to that VLR
indicating in the SGs cause information element the detach circumstance
(\"IMSI detached for EPS services\", \"IMSI detached for non-EPS services\" or
\"IMSI implicitly detached for non-EPS services\");
\- if the UE is marked as unreachable, indicated by Paging Proceed Flag set to
\"false\", and the ISR is not activated, the MME shall return an SGsAP-UE-
UNREACHABLE message to that VLR indicating in the SGs cause information
element \"UE unreachable\". The state of the SGs association does not change
at the MME; or
\- if the UE is marked as unreachable, indicated by Paging Proceed Flag set to
\"false\", and the ISR is activated, the MME shall not return an SGsAP-UE-
UNREACHABLE message to that VLR. If the SGsAP-PAGING-REQUEST message does not
include the Location area identifier or the \"VLR-Reliable\" MM context
variable in the MME is set to \"false\", then the MME shall send Detach
Notification (Local Detach) message to the associated SGSN; Otherwise the MME
shall forward the paging request to the associated SGSN, as described in 3GPP
TS 29.274 [17A].
b) If the UE is not known and the \"MME-Reset\" restoration indicator at the
MME is set to \"false\" and if:
\- the MME does not support MT CS services delivery via an alternative MME in
the MME pool; or
\- the MME supports MT CS services delivery via an alternative MME in the MME
pool and the CS restoration indicator is not set in the SGsAP-PAGING-REQUEST
message;
the MME shall handle the paging request as follows:
\- the MME shall return an SGsAP-PAGING-REJECT message to that VLR indicating
in the SGs cause information element \"IMSI unknown\".
c) If the UE is not known and if:
\- the \"MME-Reset\" restoration indicator at the MME is set to \"true\"; or
\- the MME supports MT CS services delivery via an alternative MME in the MME
pool and the CS restoration indicator is set in the SGsAP-PAGING-REQUEST
message;
the MME shall handle the paging request as follows:
\- if the MME only supports \"SMS only\", the MME shall return an SGsAP-
PAGING-REJECT message to the VLR indicating in the SGs cause information
element \"Mobile terminating CS fallback call rejected by the user\";
\- if the SGsAP-PAGING-REQUEST message includes the Location area identifier
information element, the MME shall page the UE in all the tracking areas
served by the MME that can be mapped to the location area indicated in the
Location area identifier information element; or
\- if the SGsAP-PAGING-REQUEST message does not include the Location area
identifier information element, the MME may page in all the tracking areas
served by the MME, or the tracking areas served by the MME and by the VLR or
reject the paging request per operator policy..
If the Service indicator information element in the SGsAP-PAGING-REQUEST
message indicates \"SMS indicator\", the MME shall handle the paging request
as follows:
a) If the UE is known:
\- if the UE is considered to be IMSI attached for EPS and non-EPS services or
IMSI attached for EPS services and \"SMS only\", the MME shall page the UE
based on the location information stored in the MME. If the SGsAP-PAGING-
REQUEST message does not include the Location area identifier information
element, the MME may set the \"VLR-Reliable\" MM context variable to
\"false\"; or
NOTE 2: If location area identifier information element is included in the
SGsAP-PAGING-REQUEST, it is not used in paging the UE.
\- if the UE is marked as IMSI detached for EPS services or IMSI (implicitly
or explicitly) detached for non-EPS services, or as unreachable, the MME shall
proceed as specified for the case when the service indicator indicates \"CS
call indicator\".
b) If the UE is not known and the \"MME-Reset\" restoration indicator at the
MME is set to \"false\" and if:
\- the MME does not support MT CS services delivery via an alternative MME in
the MME pool; or
\- the MME supports MT CS services delivery via an alternative MME in the MME
pool and the CS restoration indicator is not set in the SGsAP-PAGING-REQUEST
message;
the MME shall handle the paging request as follows:
\- the MME shall return an SGsAP-PAGING-REJECT message to that VLR indicating
in the SGs cause information element \"IMSI unknown\".
c) If the UE is not known and if:
\- the \"MME-Reset\" restoration indicator at the MME is set to \"true\"; or
\- the MME supports MT CS services delivery via an alternative MME in the MME
pool and the CS restoration indicator is set in the SGsAP-PAGING-REQUEST
message;
the MME shall handle the paging request as follows:
> \- if the SGsAP-PAGING-REQUEST message includes the Location area identifier
> information element, the MME shall page the UE in all the tracking areas
> served by the MME that can be mapped to the location area indicated in the
> Location area identifier information element; or
>
> \- if the SGsAP-PAGING-REQUEST message does not include the Location area
> identifier information element, the MME may page in all the tracking areas
> served by the MME, or the tracking areas served by the MME and by the VLR or
> reject the paging request per operator policy.
#### 5.1.3.2 Procedure when no NAS signalling connection exists
If the Service indicator information element in the SGsAP-PAGING-REQUEST
message indicates \"CS call indicator\" and the MME accepts the paging
request, the MME shall proceed as follows:
\- If the SGsAP-PAGING-REQUEST message includes the Location area identifier
and the \"VLR-Reliable\" MM context variable in the MME is set to \"true\":
\- if the UE is considered to be IMSI attached for EPS and non-EPS services,
the MME pages the UE with CN domain indicator set to \"CS\".
if
\- the SGsAP-PAGING-REQUEST message includes the IMSI without TMSI and the
location area stored in the MME is the same as the one received in the SGsAP-
PAGING-REQUEST message and S-TMSI can be retrieved, and the operator\'s policy
allows the use of S-TMSI as paging address; or
NOTE: The operator\'s policy is related to MSC pool in target RAT.
\- the SGsAP-PAGING-REQUEST message includes the TMSI and the location area
stored in the MME is the same as the one received in the SGsAP-PAGING-REQUEST
message;
then the MME uses the S-TMSI as paging address at the radio interface; else
the MME uses the IMSI; and
\- if the UE is not known, or is marked as IMSI detached for EPS services or
IMSI (implicitly or explicitly) detached for non-EPS services, the MME pages
the UE with IMSI and CN domain indicator set to \"PS\".
\- If the SGsAP-PAGING-REQUEST message does not include the Location area
identifier, or the \"VLR-Reliable\" MM context variable in the MME is set to
\"false\":
\- if the UE is considered to be IMSI attached for EPS and non-EPS services,
the MME uses IMSI as a paging address at the radio interface and CN domain
indicator set to \"CS\". When the MME receives the paging response from the
UE, the MME requests the UE to re-attach for non-EPS services; otherwise, the
MME takes action as described in subclause 5.12.2 and 3GPP TS 24.301 [14],
subclause 5.6.1; and
\- if the UE is not known, or is marked as IMSI detached for EPS services or
IMSI (implicitly or explicitly) detached for non-EPS services, the MME pages
the UE with IMSI with CN domain indicator set to \"PS\" to force the UE to re-
attach to EPS and non-EPS services as described in 3GPP TS 24.301 [14].
If the Service indicator information element in the SGsAP-PAGING-REQUEST
message indicates \"SMS indicator\" and the MME accepts the paging request,
the MME shall proceed as follows:
\- If the SGsAP-PAGING-REQUEST message includes the Location area identifier
and the \"VLR-Reliable\" MM context variable in the MME is set to \"true\":
\- if the UE is considered to be IMSI attached for EPS and non-EPS services or
IMSI attached for EPS services and \"SMS only\", the MME shall use the S-TMSI
as paging address at the radio interface with CN domain indicator set to
\"PS\". The MME takes action as described in 3GPP TS 24.301 [14], subclause
5.6.2.4; and
\- if the UE is not known, or is marked as IMSI detached for EPS services or
IMSI (implicitly or explicitly) detached for non-EPS services, the MME pages
the UE with IMSI as paging address at the radio interface with CN domain
indicator set to \"PS\". The MME takes action as described in 3GPP TS 24.301
[14], subclause 5.6.2.4.
\- If the SGsAP-PAGING-REQUEST message does not include the Location area
identifier information element or the \"VLR-Reliable\" MM context variable is
set to \"false\":
\- if the UE is considered to be IMSI attached for EPS and non-EPS services or
IMSI attached for EPS services and for \"SMS only\", the MME uses S-TMSI as
paging address at the radio interface with CN domain indicator set to \"PS\".
When the MME receives the paging response from the UE, the MME requests the UE
to re-attach for non-EPS services as specified in 3GPP TS 24.301 [14]; and
\- if the UE is not known, or is marked as IMSI detached for EPS services or
IMSI (implicitly or explicitly) detached for non-EPS services, the MME pages
the UE with IMSI with CN domain indicator set to \"PS\" to force the UE to re-
attach to EPS and non-EPS services as described in 3GPP TS 24.301 [14].
Independent of the Service indicator information element, if the MME has
activated Idle mode Signalling Reduction for the UE, the MME shall forward the
paging request to the associated SGSN, as described in 3GPP TS 29.274 [17A].
Independent of the Service indicator information element, the MME shall not
retransmit the paging message to the UE. Additionally, if the MME has
activated Idle mode Signalling Reduction for the UE, the MME shall not
retransmit the paging request to the associated SGSN.
#### 5.1.3.3 Procedure when a NAS signalling connection exists
If the Service indicator information element in the SGsAP-PAGING-REQUEST
message indicates \"CS call indicator\" and the MME accepts the paging
request, the MME shall proceed as follows:
\- The MME requests the UE to re-attach for non-EPS services as specified in
3GPP TS 24.301 [14] if:
\- the SGsAP-PAGING-REQUEST message does not include the Location area
identifier, or the \"VLR-Reliable\" MM context variable in the MME is set to
\"false\"; and
\- the CS domain uses TMSI allocation; and
\- otherwise, the MME sends the CS SERVICE NOTIFICATION message to the UE
through the NAS signalling connection, including the CS service related
parameters (CLI, SS code, LCS indicator and LCS client identity), received
from the VLR.
NOTE: The information whether the CS domain uses TMSI allocation can be made
available via administration.
If the Service indicator information element in the SGsAP-PAGING-REQUEST
message indicates \"SMS indicator\" and the MME accepts the paging request,
the MME shall proceed as follows:
\- If the Location area identifier information element is not included in the
SGsAP-PAGING-REQUEST message or the \"VLR-Reliable\" MM context variable is
set to \"false\", the MME requests the UE to re-attach for non-EPS services as
specified in 3GPP TS 24.301 [14]; and
\- otherwise, the MME need not take any action towards the UE.
## 5.2 Location update for non-EPS services procedure
### 5.2.1 General description
The location update for non-EPS services procedure is a general procedure used
by UEs which are configured to use CS fallback and SMS over SGs, or SMS over
SGs only. This procedure is not performed if:
\- the subscriber data indicates that the subscription is for packet only; or
\- the MME is registered for SMS for the UE (see 3GPP TS 23.272 [7]).
NOTE: For the cases specified above, the registration with a VLR is not
required and the MME does not initiate the location update for non-EPS
services procedure.
This procedure allows UEs and the network to perform:
\- combined IMSI attach for EPS and non-EPS services or for SMS only;
\- IMSI attach for non-EPS services or for SMS only if the UE is already IMSI
attached for EPS services;
\- normal location update procedure to the VLR if the UE is IMSI attached for
both EPS and non-EPS services, or for SMS only; or
\- allocation of new TMSI to an UE.
The location update for non-EPS services procedure in the SGs interface is
always started as a consequence of a direct action from the UE. The combined
attach and tracking area update procedures are further specified in 3GPP TS
23.272 [7] and 3GPP TS 24.301 [14].
When a UE is IMSI attached for EPS and non-EPS services, the VLR shall stop
any implicit detach timer. Instead the MME uses the \"Paging Proceed Flag\" to
determine the likely availability of the UE to the network. Upon reception of
the periodic Tracking Area Update message, the MME does not report to the VLR,
and the MME shall not change the state of the SGs association. When the UE
performs a detach only for EPS services or the MME performs an implicit detach
for EPS services, and the VLR\'s implicit detach timer is not already running,
the EPS detach indication to the VLR shall cause the VLR\'s implicit detach
timer to be restarted from its initial value.
If the MME performs an implicit detach for both EPS and non-EPS services, then
the MME shall send to the VLR an SGsAP-IMSI-DETACH-INDICATION message with
cause \"Implicit network initiated IMSI detach from EPS and non-EPS
services\", as further described in subclause 5.6 (the implicit IMSI detach
message indicates that the UE is unavailable for both EPS and non-EPS
services).
### 5.2.2 Procedures in the MME
#### 5.2.2.1 General
The location update for non-EPS services procedure is initiated with a
combined attach or a combined tracking area update procedure. On receipt of an
ATTACH REQUEST message or a TRACKING AREA UPDATE REQUEST message from the UE,
the MME handles the EPS related request as specified in 3GPP TS 24.301 [14].
When the MME receives the Update Location Answer message containing
subscription data from the HSS, the MME determines whether it needs to perform
location update for non-EPS services procedure. For the cases identified
below, if the MME is configured with ability not to perform registrations with
a VLR for the UE, the MME sends response message to the UE without starting
the location update for non-EPS services procedure:
\- if the Network Access Mode (NAM) subscription data indicates that the
subscription is for packet only (see 3GPP TS 29.272 [17]); or
\- if the Network Access Mode (NAM) subscription data indicates that the
subscription is for packet and circuit (see 3GPP TS 29.272 [17]) and the MME
is registered for SMS as specified in annex C of 3GPP TS 23.272 [7] for this
UE.
NOTE 1: When the MME supports both SMS in MME feature and SMS over SGs,
depending on UE capability and/or network configuration and/or "PS and SMS
only" subscription, it can be preferred to provide SMS services via SMS in MME
to avoid the VLR registration.
Otherwise, the MME shall start the location update for non-EPS services
procedure and shall wait for the outcome of both location update procedures
towards the VLR and the HSS before sending the response message to the UE.
NOTE 2: When the combined attach or tracking area update procedure is for both
EPS services and non-EPS services and the MME is not registered for SMS for
the UE (see 3GPP TS 23.272 [7]) and the UE has \"PS and SMS only\"
subscription, the MME starts the location update for non-EPS services
procedure for SMS over SGs only.
#### 5.2.2.2 Location update initiation
If timer Ts6-1 is not running, the MME shall start the location update for
non-EPS services procedure when it receives from the UE:
\- an attach request indicating combined EPS/IMSI attach;
\- a combined tracking area update request indicating Combined TA/LA updating
with IMSI attach;
\- a combined tracking area update request and the MME detects that the LAI
has changed;
\- a combined tracking area update request and the state of the SGs
association is SGs-NULL; or
\- a combined tracking area update request and the MME serving the UE has
changed.
If timer Ts6-1 is not running, the MME may start the location update for non-
EPS services procedure when it receives from the UE:
\- a combined tracking area update request or a periodic tracking area update
, if the MM context variable \"VLR-Reliable\" for the UE is set to \"false\"
(see subclause 5.7.3).
If multiple PLMNs are available for the CS domain, the MME shall select a PLMN
for CS domain as specified in 3GPP TS 23.272 [7]. If the MME cannot select any
PLMN for CS domain for the UE, the MME informs the UE that the CS domain is
not available.
The MME shall determine the new location area identification as follows:
\- if the MME received a combined attach request or combined tracking area
update request from the UE with an indication for \"SMS only\", or the network
only supports \"SMS only\" or the network only has a few VLRs that support SGs
interface, the MME may allocate a default location area identification
specifically configured for that case;
\- else the MME derives the location area identification from the current
tracking area identity where the UE is located. For this the MME may take any
access restrictions provided by the HSS into account, if the network is using
separate location areas for GERAN and UTRAN cells.
The MME shall derive the VLR name from the location area identification which
was determined. For networks supporting the feature \'Intra Domain Connection
of RAN Nodes to Multiple CN Nodes\', the VLR number is derived as described in
3GPP TS 23.236 [6A].The MME shall include the location area identification in
the new location area identifier information element in the SGsAP-LOCATION-
UPDATE-REQUEST message.
NOTE 1: The selection of the VLR in the MME follows the same rule as the
selection of the VLR in the SGSN, as defined in 3GPP TS 23.236 [6A].
In networks supporting the feature \'Intra Domain Connection of RAN Nodes to
Multiple CN Nodes\' (3GPP TS 23.236 [6A]), if the TMSI based NRI container is
not received from the UE, and the MME determines that the serving VLR of the
UE is changed, the MME shall include in the Old location area identifier a
specific LAI value which is not broadcasted in the network and not associated
with any VLR.
NOTE 2: The MME determines that the serving VLR of the UE is changed when the
Gs association changes from one serving VLR to a different one, or based on
implementation dependent criteria.
NOTE 3: When the VLR receives the SGsAP-LOCATION-UPDATE-REQUEST message with
the specific LAI value, the VLR retrieves the MM context of the UE from the
HLR.
In networks supporting the feature \"Intra Domain Connection of RAN Nodes to
Multiple CN Nodes\" as defined in 3GPP TS 23.236 [6A], the MME shall support
load re-distribution of UEs to another VLR than the current one. When the MME
receives a periodic tracking area update request or a combined tracking area
update request, the MME shall check whether for this UE there is a SGs
association to a VLR for which load re-distribution has been initiated in the
MME by O&M. If this is the case, the MME derives the new VLR name as described
in 3GPP TS 23.236 [6A]. The MME shall then send the SGsAP-LOCATION-UPDATE-
REQUEST message to the new selected VLR.
If the VLR is configured for gateway core network (GWCN), the MME shall select
a CS domain operator as specified in 3GPP TS 23.272 [7] and proceed as
follows:
\- If the preferred RAT of the selected CS domain operator is GERAN and the UE
does not support GERAN network sharing (see 3GPP TS 24.008 [8], subclause
10.5.5.12), the MME shall include the selected CS domain operator in the
selected CS domain operator information element, and the common PLMN in the
new location area identifier information element in the SGsAP-LOCATION-UPDATE-
REQUEST message; or
\- If only common PLMN ID and no multiple PLMN IDs are provided in CS domain
for selection by the UE (see 3GPP TS 23.251 [7A], subclause 4.2.3.1), the MME
shall include the selected CS domain operator in the selected CS domain
operator information element, and the common PLMN in the new location area
identifier information element in the SGsAP-LOCATION-UPDATE-REQUEST message.
If multiple PLMN IDs are provided in CS domain for selection by the UE and the
UE supports GERAN network sharing (see 3GPP TS 24.008 [8], subclause
10.5.5.12), the MME shall include the selected PLMN for CS domain in the new
location area identifier information element as specified in 3GPP TS 23.251
[7A].
The SGsAP-LOCATION-UPDATE-REQUEST message includes the type of location update
performed by the UE in the EPS location update type information element. If
the UE has performed a combined attach or a combined tracking area update
indicating \"combined TA/LA updating with IMSI attach\", the MME indicates
\"IMSI attach\", otherwise the MME indicates \"Normal location update\".
The MME shall include the TMSI status in the SGsAP-LOCATION-UPDATE-REQUEST
message if the UE indicates in the ATTACH REQUEST or the TRACKING AREA UPDATE
REQUEST message that it has no valid TMSI available. The MME shall also
include the old location area identifier in the SGsAP-LOCATION-UPDATE-REQUEST
message if the UE included the old location area identification in the ATTACH
REQUEST or TRACKING AREA UPDATE REQUEST message.
The MME shall include the TMSI based NRI container in the SGsAP-LOCATION-
UPDATE-REQUEST message if received from the UE.
If the MME supports the \"Automatic Device Detection\" (see 3GPP TS 22.101
[2]) or the \"Trace for Management Based Activation/Deactivation\" (see 3GPP
TS 32.422 [18]), the MME shall include the IMEISV in the SGsAP-LOCATION-
UPDATE-REQUEST message.
The MME shall add the UE\'s current TAI and E-CGI to the SGsAP-LOCATION-
UPDATE-REQUEST message.
When the MME sends the SGsAP-LOCATION-UPDATE-REQUEST, the MME shall start
timer Ts6-1.
If timer Ts6-1 is running and the MME receives from the UE:
\- an attach request indicating combined EPS/IMSI attach; or
\- a combined tracking area update with or without IMSI attach.
Then:
\- if the LAI determined by the MME is the same as in the outstanding request,
the MME shall not process this new request and shall wait for the VLR response
to the ongoing procedure;
\- if the LAI determined by the MME is different but the VLR name is the same
as for previous LAI, any response from the VLR to the outstanding request is
ignored, the MME shall stop and reset timer Ts6-1 and the MME shall start the
location update for non-EPS services procedure; or
\- if the LAI determined by the MME is different and the VLR name is different
as for previous LAI, any response from the previously addressed VLR to the
outstanding request is ignored, the MME shall stop and reset timer Ts6-1, and
the MME shall start the location update for non-EPS services procedure.
When the MME receives from the UE a tracking area update request and the MME
serving the UE has changed, the MME shall stop and reset timer Ts6-1.
#### 5.2.2.3 Location update response
If the MME receives an SGsAP-LOCATION-UPDATE-ACCEPT message from the VLR, the
MME shall stop timer Ts6-1 and:
\- move the state of the SGs association to SGs-ASSOCIATED;
\- set the MM context variable \"VLR-Reliable\" to \"true\"; and
\- indicate to the UE the acceptance of the VLR to the location update
procedure. The message sent to the UE includes the Location Area Identity (see
3GPP TS 24.301 [14]).
The MME shall wait for the outcome of the location update for non-EPS services
procedure towards the VLR before sending a response to location update
procedure to the UE. When the MME receives an SGsAP-LOCATION-UPDATE-REJECT
message from the VLR, it will map the reject cause received to the appropriate
reject cause as specified in 3GPP TS 24.301 [14], and report this reject cause
to the UE.
If the VLR included the Mobile identity information element in the SGsAP-
LOCATION-UPDATE-ACCEPT message, the MME shall relay the information received
to the UE. If the Mobile identity information element contains a new TMSI,
this will cause the UE to perform a TMSI reallocation procedure. In this case,
the MME shall send to the VLR the SGsAP-TMSI-REALLOCATION-COMPLETE message
when the MME receives the ATTACH COMPLETE or the TRACKING AREA UPDATE COMPLETE
message from the UE. If the Mobile identity information element contains an
IMSI, this will cause the UE to deallocate its TMSI.
#### 5.2.2.4 Location update failure
If the MME receives an SGsAP-LOCATION-UPDATE-REJECT message from the VLR, the
MME
\- shall stop timer Ts6-1;
\- shall move the state of the SGs association to SGs-NULL; and
\- indicates to the UE the rejection of the Location Update procedure by the
VLR as specified in 3GPP TS 24.301 [14]. The Reject cause value sent by the
VLR shall be mapped to the appropriate reject cause as specified in 3GPP TS
24.301 [14], and the latter is forwarded to the UE.
#### 5.2.2.5 Abnormal cases
If timer Ts6-1 expires, the MME shall abort the Location Update for non-EPS
service procedure and indicate this to the UE with the Reject cause value
\'MSC temporarily not reachable\'. The state of the SGs association to the VLR
shall be SGs-NULL.
If the MME receives an SGsAP-LOCATION-UPDATE-ACCEPT message and timer Ts6-1 is
not running then:
\- if timer Ts8 is running (see subclause 5.4), the message shall be ignored;
\- if timer Ts9 is running (see subclause 5.5), the message shall be ignored;
or
\- if timers Ts8 and Ts9 are not running:
\- if the state of the SGs association to the VLR is SGs-ASSOCIATED, the
message shall be ignored; or
\- if the state of the SGs association to the VLR is different than SGs-
ASSOCIATED, the message shall be treated as a message incompatible with the
protocol state of the MME (see subclause 7.3).
### 5.2.3 Procedures in the VLR
#### 5.2.3.1 General
When a VLR receives an SGsAP-LOCATION-UPDATE-REQUEST message, the VLR checks
whether the IMSI is known. If the IMSI is not known, the VLR retrieves the MM
context of the UE from the HSS.
In networks supporting the feature \'Intra Domain Connection of RAN Nodes to
Multiple CN Nodes\' (3GPP TS 23.236 [6A]), if the TMSI based NRI container is
received in the SGsAP-LOCATION-UPDATE-REQUEST message, the VLR derives the NRI
value. If the NRI value is not allocated by the VLR, the VLR retrieves the MM
context of the UE from the HSS.
When the VLR is configured for gateway core network (GWCN), the VLR shall
select the serving CS domain operator as follows:
\- If the selected CS domain operator information element is received in the
SGsAP-LOCATION-UPDATE-REQUEST message, the VLR shall select the serving CS
domain operator as specified in the selected CS domain operator information
element;
\- If the selected CS domain operator information element is not received in
the SGsAP-LOCATION-UPDATE-REQUEST message and the PLMN ID included in the new
location area identifier information element identifies a CS domain operator,
the VLR shall select the serving CS domain operator as specified in the new
location area identifier information element;
\- Otherwise, the VLR selects the serving CS domain operator based on local
policies.
#### 5.2.3.2 Location update response
If the location update is accepted by the VLR and, if necessary, by the HSS,
the VLR shall:
\- move the SGs association to the SGs-ASSOCIATED state;
\- set the \"Confirmed by Radio Contact\" restoration indicator to \"true\";
\- update the SGs association by storing the MME address included in SGsAP-
LOCATION-UPDATE-REQUEST message; and
\- send an SGsAP-LOCATION-UPDATE-ACCEPT message to the sending MME. This
message includes the location area identifier received in the New location
area identifier information element in the previous SGsAP-LOCATION-UPDATE-
REQUEST message.
After the VLR has updated the SGs association, if Ts5 is still running for a
MT service for this UE, the VLR shall repeat SGs Paging Request towards the
updated SGs association.
#### 5.2.3.3 Location update failure
If the location update is rejected by the VLR, the VLR shall:
\- send an SGsAP-LOCATION-UPDATE-REJECT message to the MME with the
appropriate reject cause as indicated in 3GPP TS 24.008 [8] and shall indicate
to the MME the Location area identifier received in the corresponding SGsAP-
LOCATION-UPDATE-REQUEST message; and
\- move the SGs association to SGs-NULL.
#### 5.2.3.4 TMSI reallocation procedure
If the VLR decides to allocate a new TMSI to the UE, the VLR shall include the
new TMSI in the SGsAP-LOCATION-UPDATE-ACCEPT message. After sending the SGsAP-
LOCATION-UPDATE-ACCEPT message with a new TMSI the VLR shall start timer
Ts6-2. If the VLR decides to deallocate the TMSI of the UE, the VLR shall
include the IMSI of the UE in the SGsAP-LOCATION-UPDATE-ACCEPT message.
Upon receipt of the SGsAP-TMSI-REALLOCATION-COMPLETE message, the VLR shall
stop the timer Ts6-2 and consider the new TMSI as valid.
If the IMSI was sent to the UE, the VLR considers the old TMSI as deleted.
If no SGsAP-TMSI-REALLOCATION-COMPLETE message is received by the VLR before
the timer Ts6-2 expires, the VLR shall abort the TMSI reallocation procedure.
The VLR shall consider the old TMSI occupied until the new TMSI is used in a
subsequent A/Iu message, or for an implementation dependent time. The outcome
of the TMSI reallocation procedure does not change the state of the SGs
association. The VLR uses the IMSI or a TMSI, either the new TMSI or the old
TMSI if available, for paging.
NOTE: Whether the new TMSI or old TMSI is used in the SGs paging request does
not impact the paging procedure or UE response.
#### 5.2.3.5 Abnormal cases
The following abnormal cases can be identified:
i) MM signalling via A or Iu interface
> If the VLR receives a Location Update request or an IMSI detach indication
> from the UE by the A or Iu interface when the state of the SGs association
> in the VLR is not SGs-NULL, the VLR shall move the state of the SGs
> association to SGs-NULL.
ii) Additional Location Update Request
> If the state of the SGs association in the VLR is LA-UPDATE PRESENT and an
> SGsAP-LOCATION-UPDATE-REQUEST message is received, then:
\- if the message is from the same MME and indicates the same New location
area identifier information element as the outstanding location update
request, then the VLR shall ignore this additional SGsAP-LOCATION-UPDATE-
REQUEST message;
\- if the message is from the same MME but indicates a different New location
area identifier information element to the outstanding location update
request, then the VLR shall treat this additional SGsAP-LOCATION-UPDATE-
REQUEST message and the VLR shall not send any response to the previous SGsAP-
LOCATION-UPDATE-REQUEST message; or
\- if the message is from a different MME (indicating either the same or
different New location area identifier information element) to the outstanding
location update request, then the VLR shall treat this additional SGsAP-
LOCATION-UPDATE-REQUEST message and the VLR shall not send any response to the
previous SGsAP-LOCATION-UPDATE-REQUEST message.
iii) Detach signalling from the MME
> If the state of the SGs association in the VLR is LA-UPDATE PRESENT and
> either an SGsAP-EPS-DETACH-INDICATION or an SGsAP-IMSI-DETACH-INDICATION
> message is received, then the VLR shall abandon the Location Update for non-
> EPS services procedure (neither an SGsAP-LOCATION-UPDATE-ACCEPT nor an
> SGsAP-LOCATION-UPDATE-REJECT messages is sent) and the further actions
> described in subclauses 5.4 or 5.5 or 5.6 are followed.
iv) Signalling via Gs interface
> If the VLR receives for a UE a BSSAP+-LOCATION-UPDATE-REQUEST message (as
> defined in 3GPP TS 29.018 [16]) from an SGSN when the state of the SGs
> association for this UE in the VLR is not SGs-NULL, the VLR shall move the
> state of the SGs association to SGs-NULL.
v) New Location Update Request during TMSI reallocation procedure
If the VLR receives an SGsAP-LOCATION-UPDATE-REQUEST message while Ts6-2 is
running, the VLR shall stop timer Ts6-2, abort the TMSI reallocation procedure
and proceed with the new location update for non-EPS services procedure. If
the VLR needs to page the MS during the new location update for non-EPS
services procedure, the VLR uses the IMSI or the new TMSI from the aborted
TMSI reallocation procedure for paging.
vi) Reset signalling from the MME
If the state of the SGs association in the VLR is LA-UPDATE PRESENT and an
SGsAP-RESET-INDICATION message is received from the MME, then the VLR shall
abandon the Location Update for non-EPS services procedure (neither an SGsAP-
LOCATION-UPDATE-ACCEPT nor an SGsAP-LOCATION-UPDATE-REJECT messages is sent)
and the further actions described in subclause 5.8 are followed.
## 5.3 Non-EPS alert procedure
### 5.3.1 General description
This procedure is used by the VLR to request from an MME an indication when
any signalling activity from the UE is detected. This procedure can be invoked
at any time by the VLR. The MME shall acknowledge the SGsAP-ALERT-REQUEST
message.
### 5.3.2 Procedures in the VLR
#### 5.3.2.1 Alert Initiation
The VLR may start the Non-EPS alert procedure at any time. When the VLR wants
to request from an MME that further activity from a UE is reported by the MME,
the VLR shall send an SGsAP-ALERT-REQUEST message to that MME. The VLR starts
timer Ts7 when the SGsAP-ALERT-REQUEST message is sent.
#### 5.3.2.2 Alert Response
When an SGsAP-ALERT-ACK message is received, the VLR shall stop the timer Ts7.
The state of the SGs association is not changed.
#### 5.3.2.3 Alert Failure
If an SGsAP-ALERT-REJECT message is received, the VLR shall stop the timer
Ts7, move the state of the SGs association to SGs-NULL and within this state
the SGs association is marked with the contents of the SGs cause information
element.
#### 5.3.2.4 Alert Indication
The VLR shall not change the state of the SGs association upon reception of an
SGsAP-UE-ACTIVITY-INDICATION message.
#### 5.3.2.5 Abnormal cases
If no SGsAP-ALERT-ACK message is received before the timer Ts7 expires, the
VLR shall retransmit the SGsAP-ALERT-REQUEST message a maximum of Ns7 times.
NOTE: If no SGsAP-ALERT-ACK message is received after that, a report is made
to the O&M system. The state of the SGs association is not changed.
### 5.3.3 Procedures in the MME
#### 5.3.3.1 Alert response
The MME may receive an SGsAP-ALERT-REQUEST message in any state of the SGs
association. Upon receipt of an SGsAP-ALERT-REQUEST message from the VLR and
if the IMSI is known in the MME, the MME shall reply with an SGsAP-ALERT-ACK
message and set the NEAF. If the MME has activated Idle mode Signaling
Reduction for the UE, the MME shall send an Alert MME Notification message to
the associated SGSN, as described in 3GPP TS 29.274 [17A], except for the
conditions specified in subclause 8.2.5c of 3GPP TS 23.272 [7].
#### 5.3.3.2 Alert failure
If an SGsAP-ALERT-REQUEST message is received for an IMSI that is unknown at
the MME, the MME shall return an SGsAP-ALERT-REJECT message to the VLR
indicating the SGs cause information element value \"IMSI unknown\".
#### 5.3.3.3 Alert indication
The MME shall report to the VLR upon detection of any activity in E-UTRAN
(either signalling or, indirectly detected via S-GW, data transfer) from the
UE if the NEAF is set. If the MME detects EPS signalling that leads to a
procedure towards the VLR, the MME shall follow this procedure and reset the
NEAF. If the MME detects activity that does not lead to any procedure towards
the VLR, the MME shall send an SGsAP-UE-ACTIVITY-INDICATION message towards
the VLR and reset the NEAF. Upon receipt of a UE Activity Notification message
from the SGSN, the MME shall reply with a UE Activity Acknowledge message,
send an SGsAP-UE-ACTIVITY-INDICATION message to the VLR and reset the NEAF
flag.
## 5.4 Explicit IMSI detach from EPS services
### 5.4.1 General description
This procedure is used by the MME to indicate to the VLR that the UE has been
detached from EPS services and therefore the SGs association between the MME
and the VLR has to be deactivated. This procedure only applies to UEs which
are not in the SGs-NULL state at the MME. The procedures specified in this
subclause apply to EPS detach indication initiated by the UE or by the network
as specified in 3GPP TS 24.301 [14].
The procedure is also used by the MME to indicate to the VLR when a combined
tracking area update procedure has been rejected by the MME, except when the
MME performs the NAS level mobility management congestion control as specified
in 3GPP TS 24.301 [14], or the MME receives the Detach Notification from the
SGSN, as described in 3GPP TS 29.274 [17A], when Idle mode Signalling
Reduction is activated.
The procedure is also used by the MME to indicate to the VLR when a periodic
tracking area update procedure has been rejected by the MME, except when the
MME performs the NAS level mobility management congestion control as specified
in 3GPP TS 24.301 [14], for a UE for which an SGs association exists.
The Explicit IMSI detach from EPS services procedure aborts any other ongoing
procedure related to this UE on the SGs interface in the MME and in the VLR.
### 5.4.2 Procedures in the MME
#### 5.4.2.1 Explicit EPS detach initiation
The MME shall send an SGsAP-EPS-DETACH-INDICATION message to a VLR if:
\- the MME receives a detach for EPS from the UE;
\- the MME performs network initiated EPS detach procedure;
\- the combined tracking area update procedure is rejected by the MME, except
when the MME performs the NAS level mobility management congestion control as
specified in 3GPP TS 24.301 [14];
\- the periodic tracking area update procedure is rejected by the MME, except
when the MME performs the NAS level mobility management congestion control as
specified in 3GPP TS 24.301 [14], for a UE for which an SGs association
exists; or
\- the MME receives a Detach Notification from the SGSN with the Detach type
indicating \"PS Detach\".
If the MME receives a Detach Request from a UE or Detach Notification from an
SGSN and the state of the SGs association to a VLR for that UE is not SGs-
NULL, the MME shall check the detach type indicated in the Detach Request
message or the detach type indicated in the Detach Notification message. If
the UE has indicated EPS detach the MME shall send an SGsAP-EPS-DETACH-
INDICATION message to the VLR indicating \"UE initiated IMSI detach from EPS
services\".
If the MME performs a network initiated detach procedure and the state of the
SGs association to a VLR for that UE is not SGs-NULL, the MME shall send an
SGsAP-EPS-DETACH-INDICATION message to the VLR indicating \"Network initiated
IMSI detach from EPS services\".
If the combined or periodic tracking area update procedure is rejected at the
MME, except when the MME performs the NAS level mobility management congestion
control as specified in 3GPP TS 24.301 [14], for a UE with an SGs association
state different from SGs-NULL, the MME shall send an SGsAP-EPS-DETACH-
INDICATION to the VLR indicating \"EPS services not allowed\".
After sending of the SGsAP-EPS-DETACH-INDICATION message, the MME shall move
the state of the SGs association to SGs-NULL. The MME shall start timer Ts8
upon transmission of the SGsAP-EPS-DETACH-INDICATION message and the MME shall
stop and reset timer Ts6-1 if running.
#### 5.4.2.2 Explicit EPS detach response
If the MME receives an SGsAP-EPS-DETACH-ACK message from the VLR, the MME
shall stop timer Ts8. If a confirmation of the detach needs to be sent to the
UE, the MME shall not wait for the reception of the SGsAP-EPS-DETACH-ACK
message to send such confirmation.
#### 5.4.2.3 Abnormal cases
If no SGsAP-EPS-DETACH-ACK message is received by the MME in response to a
previous SGsAP-EPS-DETACH-INDICATION message before timer Ts8 expires, the MME
shall repeat the SGsAP-EPS-DETACH-INDICATION message a maximum of Ns8 times.
NOTE: If no SGsAP-EPS-DETACH-ACK message is received after that, a report is
made to the O&M system. The state of the SGs association during the
acknowledgement procedure remains SGs-NULL.
### 5.4.3 Procedures in the VLR
When a VLR receives an SGsAP-EPS-DETACH-INDICATION message, the VLR shall send
an SGsAP-EPS-DETACH-ACK message to the sending MME. The VLR shall check the
MME name indicated in the SGsAP-EPS-DETACH-INDICATION message. If the received
MME name is not changed comparing to the MME name stored in the VLR, the VLR
shall move the state of the SGs association for the UE from any state to SGs-
NULL and marks the SGs association as \"detached for EPS services\".
Otherwise, the VLR shall not change the state of the SGs association.
If the VLR's implicit detach timer is not running then the VLR shall set and
restart the implicit detach timer upon reception of an SGsAP-EPS-DETACH-
INDICATION message. If the VLR's implicit detach timer is running (the state
of the SGs association was already SGs-NULL) then the reception of an SGsAP-
EPS-DETACH-INDICATION message shall not affect VLR's implicit detach timer.
## 5.5 Explicit IMSI detach from non-EPS services
### 5.5.1 General description
This procedure is used by the MME to indicate to the VLR that the UE has
performed IMSI detach from non-EPS services and therefore the SGs association
between the MME and the VLR has to be deactivated. This procedure applies only
to UEs for which there is a SGs association at the MME. The procedures
specified in this subclause apply only to IMSI detach request, combined IMSI
and EPS detach requests from the UE or Detach Notification message from an
SGSN.
The explicit IMSI detach from non-EPS services procedure aborts any other
ongoing procedure related to this UE on the SGs interface in the MME and in
the VLR.
In order to ensure that the VLR and the UE are synchronized as to which paging
channel to use for any of the subsequent paging events, the MME shall attempt
to inform the VLR about the detach event by using a retry scheme if the
initial delivery of the SGsAP-IMSI-DETACH-INDICATION message fails.
### 5.5.2 Procedures in the MME
#### 5.5.2.1 Explicit IMSI detach initiation
When an MME receives a Detach Request from a UE for which an SGs association
exists, the MME shall check the detach type indicated. If the UE is indicating
IMSI detach or combined EPS/IMSI detach, the MME shall send an SGsAP-IMSI-
DETACH-INDICATION message to the VLR indicating \"Explicit UE initiated IMSI
detach from non-EPS services\" or \"Combined UE initiated IMSI detach from EPS
and non-EPS services\".
When an MME receives a Detach Notification message for a UE from an SGSN and
an SGs association for the UE exists, the MME shall check the cause and detach
type indicated. If the cause is indicating \"IMSI Detach only\", the MME shall
send an SGsAP-IMSI-DETACH-INDICATION message to the VLR indicating \"Explicit
UE initiated IMSI detach from non-EPS services\". If the cause is indicating
\"Complete Detach\" and detach type is indicating \"Combined PS/CS Detach\" as
specified in 3GPP TS 29.274 [17A], the MME shall send an SGsAP-IMSI-DETACH-
INDICATION message to the VLR indicating \"Combined UE initiated IMSI detach
from EPS and non-EPS services\".
After the sending of the SGsAP-IMSI-DETACH-INDICATION message to the VLR, the
MME shall move the state of the SGs association to SGs-NULL. The MME shall
start timer Ts9 upon transmission of the SGsAP-IMSI-DETACH-INDICATION message
and the MME shall stop and reset timer Ts6-1, if running.
#### 5.5.2.2 Explicit IMSI detach response
If the MME receives an SGsAP-IMSI-DETACH-ACK message from the VLR, the MME
shall stop timer Ts9. If the detach type received from the UE indicated IMSI
only detach or combined EPS/IMSI detach not due to switch off, the MME shall
wait for the reception of the SGsAP-IMSI-DETACH-ACK message before sending the
confirmation of the detach to the UE.
#### 5.5.2.3 Abnormal cases
The following abnormal cases can be identified:
i) no SGsAP-IMSI-DETACH-ACK received for a detach with switch off
> If the MME sent an SGsAP-IMSI-DETACH-INDICATION message for a combined IMSI
> and EPS detach due to switch off and timer Ts9 expires, the MME shall repeat
> the SGsAP-IMSI-DETACH-INDICATION message a maximum of Ns9 times.
ii) no SGsAP-IMSI-DETACH-ACK received for a detach with no switch off
> If the MME sent an SGsAP-IMSI-DETACH-INDICATION message for an IMSI only
> detach or a combined IMSI and EPS detach not due to switch off and timer Ts9
> expires, the MME shall repeat the SGsAP-IMSI-DETACH-INDICATION message a
> maximum of Ns9 times. If no SGsAP-IMSI-DETACH-ACK is received after that the
> MME shall send the confirmation of the detach to the UE.
### 5.5.3 Procedures in the VLR
When a VLR receives an SGsAP-IMSI-DETACH-INDICATION message, the VLR shall
send an SGsAP-IMSI-DETACH-ACK message to the sending MME.
The VLR shall check the MME name indicated in the SGsAP-IMSI-DETACH-INDICATION
message. If the received MME name is not changed comparing to the MME name
stored in the VLR, the VLR shall move the state of the SGs association for the
UE from any state to SGs-NULL. If the SGsAP-IMSI-DETACH-INDICATION message
indicated \"Explicit UE initiated IMSI detach from non-EPS services\", the VLR
marks the SGs association as \"IMSI detached for non-EPS services\". If the
SGsAP-IMSI-DETACH-INDICATION message indicated \"Combined UE initiated IMSI
detach from EPS and non-EPS services\", the VLR marks the SGs association as
\"IMSI detached for EPS and non-EPS services\". The VLR shall mark the UE as
detached.
If the received MME name is different from the MME name stored in the VLR, the
VLR shall not change the state of the SGs association.
## 5.6 Implicit IMSI detach from non-EPS services
### 5.6.1 General description
This procedure is used by the MME to indicate when an internal MME timer
mechanism has caused the MME to delete the EMM context of an UE or mark its
EMM context as detached. This procedure only applies to UEs for which there is
an SGs association at the MME.
The implicit IMSI detach from non-EPS services procedure aborts any other
ongoing procedure related to this UE on the SGs interface in the MME and in
the VLR.
In order to ensure that the VLR and the UE are synchronized as to which paging
channel to use for any of the subsequent paging events the MME shall attempt
to inform the VLR about the detach event by using a retry scheme if the
initial delivery of the SGsAP-IMSI-DETACH-INDICATION message fails.
### 5.6.2 Procedures in the MME
When the implicit IMSI detach from non-EPS services procedure is started for a
UE by the above mentioned internal MME timer mechanism, the MME shall send an
SGsAP-IMSI-DETACH-INDICATION message to the VLR indicating \"Implicit network
initiated IMSI detach from EPS and non-EPS services\".
After the sending of the SGsAP-IMSI-DETACH-INDICATION message, the MME shall
move the state of the SGs association to SGs-NULL. The MME shall start timer
Ts10 upon transmission of the SGsAP-IMSI-DETACH-INDICATION message.
If the MME receives an SGsAP-IMSI-DETACH-ACK message from the VLR, the MME
shall stop timer Ts10.
If no SGsAP-IMSI-DETACH-ACK message is received by the MME to a previous
SGsAP-IMSI-DETACH-INDICATION message before timer Ts10 expires, the MME shall
repeat the SGsAP-IMSI-DETACH-INDICATION message a maximum of Ns10 times. The
state of the SGs association during the acknowledgement procedure remains SGs-
NULL.
### 5.6.3 Procedures in the VLR
When a VLR receives the SGsAP-IMSI-DETACH-INDICATION message, the VLR shall
send an SGsAP-IMSI-DETACH-ACK message to the sending MME.
The VLR shall check the MME name indicated in the SGsAP-IMSI-DETACH-INDICATION
message. If the received MME name is not changed comparing to the MME name
stored in the VLR and the state of the SGs association is not SGs-NULL, the
VLR proceeds as follows:
\- The VLR shall move the state of the SGs association for the UE to SGs-NULL.
If the VLR does not have a signalling connection for the UE, the VLR shall
mark the UE as detached. Additionally, the VLR marks the SGs association as
\"IMSI implicitly detached for EPS and non-EPS services\".
If the received MME name is different from the MME name stored in the VLR, the
VLR shall not change the state of the SGs association.
## 5.7 VLR failure procedure
### 5.7.1 General description
This procedure is used by the VLR to inform the MMEs with an SGs association
about the recovery from an internal failure that has affected the SGs
association with the MMEs when the VLR fails with restart.
NOTE: The VLR recovery procedure is handled in such a way that the signalling
load on the VLR and MMEs does not create any overload problem.
This procedure is also used by the MMEs with an SGs association to a failed
VLR in the VLR pool to perform the restoration for CS services for the
affected UEs when the VLR fails without restart or fails for a long duration.
### 5.7.2 Procedures in the VLR
#### 5.7.2.1 VLR Reset Initiation
In the event of a failure at the VLR which has resulted in the loss of the SGs
association information for some UEs, the VLR shall move from any state to the
SGs-NULL state for these UEs. The VLR shall also set the \"Confirmed by Radio
Contact\" restoration indicator to \"false\" (see 3GPP TS 23.007 [4]) for
affected UEs. The VLR shall not send any SGsAP-MM-INFORMATION-REQUEST messages
to UEs with the SGs association in the SGs-NULL state.
When the VLR restarts, the VLR shall send an SGsAP-RESET-INDICATION message to
all the MMEs connected to the VLR by the SGs interface. This message indicates
to the MME that for the UEs with an SGs association to that VLR, the SGs
association is no longer reliable. The VLR shall also start a separate timer
Ts11 for each MME.
#### 5.7.2.2 VLR Reset Response
Upon receipt of an SGsAP-RESET-ACK message from an MME, the VLR shall stop the
timer Ts11 for that MME.
#### 5.7.2.3 Abnormal cases
If the VLR does not receive an SGsAP-RESET-ACK message from that MME before
the timer Ts11 expires, the VLR shall retransmit the SGsAP-RESET-INDICATION
message. The retransmission is repeated a maximum of Ns11 times.
NOTE: If no SGsAP-RESET-ACK is received after that a report is made to the O&M
system.
### 5.7.3 Procedures in the MME
#### 5.7.3.1 VLR fails with restart
Upon receipt of an SGsAP-RESET-INDICATION message from the VLR, the MME is
informed that all the SGs associations with that VLR for all the UEs
registered in the MME are no longer reliable because the VLR has lost
information about the state of the UEs and during the failure the VLR might
have missed signalling messages. The MME shall set the \"VLR-Reliable\" MM
context variable to \"false\". The detach procedures for deleting the SGs
association are still applicable (see subclauses 5.4, 5.5 and 5.6). If the
\"VLR-Reliable\" MM context variable is set to \"false\", upon reception of a
combined tracking area update request or a periodic tracking area update
request from the UE that is attached for non-EPS service, the MME may requests
the UE to re-attach for non-EPS services as specified in 3GPP TS 24.301 [14],
or may alternatively immediately perform the location update for non-EPS
services procedure towards the VLR as described in subclause 5.2.
The MME sends an SGsAP-RESET-ACK message to the VLR.
#### 5.7.3.2 VLR fails without restart
If the MME detects that the VLR serving the UE is no longer in service and the
MME supports restoration for CS services via an alternative VLR as defined in
3GPP TS 23.007 [4], upon reception of a combined tracking area update request
or a periodic tracking area update request from the UE that is attached to the
VLR not in service, the MME may:
\- request the UE to re-attach for non-EPS services as specified in 3GPP TS
24.301 [14] and then select an alternative VLR that is in service for the UE
during the subsequent combined tracking area update procedure, before
performing the location update for non-EPS services procedure towards the
selected VLR as described in subclause 5.2; or
\- select an alternative VLR that is in service for the UE and immediately
perform the location update for non-EPS services procedure towards the
selected VLR as described in subclause 5.2.
NOTE: How an MME detects that a VLR is no longer in service is implemention
dependent.
## 5.8 MME failure procedure
### 5.8.1 General description
This procedure is used by the MME to inform the associated VLRs about the
recovery from an internal failure that has affected the SGs association with
the VLRs.
NOTE: The MME recovery procedure is handled in such a way that the signalling
load on the MME and VLRs does not create any overload problem.
### 5.8.2 Procedures in the MME
#### 5.8.2.1 MME Reset Initiation
In the event of a failure at the MME which has resulted in the loss of the SGs
association information on some UEs, the MME shall move from any state to the
SGs-NULL state for these affected UEs. The MME shall also set the \"MME-
Reset\" MM context variable to \"true\" and start the timer Ts12-1. When the
timer Ts12-1 expires the \"MME-Reset\" MM context variable is set to
\"false\".
The MME may send an SGsAP-RESET-INDICATION message to all the VLRs connected
to the MME by SGs interfaces. The SGsAP-RESET-INDICATION message indicates to
the VLR that all the SGs associations with that particular MME for all the UEs
registered in the VLR are no longer reliable. The normal procedures for
updating the SGs association are still applicable (see subclauses 5.2, 5.4,
5.5 and 5.6). The MME shall also start a separate timer Ts12-2 for each VLR.
If the MME does not send an SGsAP-RESET-INDICATION message, the MME shall move
from any state to the SGs-NULL state only for the associations of the UEs
affected by the loss of VLR association information.
NOTE: The option to not send any SGsAP-RESET-INDICATION message to all the
VLRs connected to the MME by SGs interfaces reduces subsequent paging
signalling initiated by VLRs by avoiding a complete search of the UE on the
entire VLR area.
#### 5.8.2.2 MME Reset Response
Upon receipt of an SGsAP-RESET-ACK message, the MME shall stop the timer
Ts12-2 for that VLR.
#### 5.8.2.3 Abnormal cases
If the MME does not receive an SGsAP-RESET-ACK message from that VLR before
the timer Ts12-2 expires, the MME shall retransmit the SGsAP-RESET-INDICATION
message. The retransmission is repeated a maximum of Ns12 times.
NOTE: If no SGsAP-RESET-ACK is received after that a report is made to the O&M
system.
### 5.8.3 Procedures in the VLR
Upon receipt of an SGsAP-RESET-INDICATION message from the MME, the VLR is
informed that all the SGs associations with that MME for all the UEs
registered in the MME are no longer reliable because the MME has lost
information about the state of the UEs for that VLR and during the failure the
MME might have missed signalling messages. The VLR shall either:
\- set the \"Confirmed by Radio Contact\" restoration indicator to \"false\"
in all the SGs associations containing the restarted MME and set the state of
all the SGs associations containing the restarted MME to the SGs-NULL state;
or
\- keep the \'Confirmed by Radio Contact\' restoration indication and the
state of all the SGs associations containing the restarted MME unchanged.
NOTE: The option to not set the \'Confirmed by Radio Contact\' restoration
indicator to \'false\' in all the associations containing the restarted MME
reduces subsequent paging signalling the VLR can initiate by avoiding a
complete search of the UE on the entire VLR area.
The VLR shall then send an SGsAP-RESET-ACK message to the MME.
If the \"Confirmed by Radio Contact\" restoration indicator is \"false\" the
VLR may send paging messages on both the SGs and the A/Iu interface.
## 5.9 HSS failure
### 5.9.1 General description
This subclause describes the MME behaviour towards the VLR as a consequence of
an HSS reset.
In the case of an HSS failure, the HSS informs the associated MMEs about the
recovery from an internal failure that has affected the SGs association with
the MMEs according to the HSS reset procedure specified in 3GPP TS **29.272**
**[17]**.
This information is used in the MME to trigger the VLR to perform a location
update towards the HSS in order to restore the HSS subscriber data.
### 5.9.2 Procedures in the MME
Upon receipt of a HSS reset indication from the HSS, the MME shall set the
NEAF for all registered UEs in the MME for which a valid SGs association with
a VLR exists.
Upon detection of any signalling activity from the UE, the MME shall report to
the VLR if the NEAF, as defined in subclause 5.3.3, is set for this UE. If the
MME detects signalling that leads to a procedure towards the VLR, the MME
shall follow this procedure and reset the NEAF. If the MME detects activity
that does not lead to any procedure towards the VLR, the MME shall send an
SGsAP-UE-ACTIVITY-INDICATION message towards the VLR and reset the NEAF. The
MME may delay sending the activity indication for a maximum operator-
configuration depending time period to avoid high signalling load.
## 5.10 MM information procedure
### 5.10.1 General description
The MM information procedure is performed between the VLR and the MME via the
SGs interface if the target UE for the MM information procedure is IMSI
attached to both EPS and non-EPS services (i.e. the state of the SGs
association is SGs-ASSOCIATED). The outcome of the MM Information procedure
does not change the state of the SGs association at the VLR or MME.
### 5.10.2 Procedures in the VLR
If for the target UE for the MM information procedure the state of the SGs
association in the VLR is SGs-ASSOCIATED, the VLR may initiate the MM
information procedure by transferring an SGsAP-MM-INFORMATION-REQUEST message
to the MME.
### 5.10.3 Procedures in the MME
If an SGsAP-MM-INFORMATION-REQUEST message is received for a UE for which
there exists an SGs association at the MME, dependent on operator preference
the MME shall either:
1) check and update the contents of the received MM information information
element. The MME then sends the resultant contents of the MM information
information element to the UE indicated in the SGsAP-MM-INFORMATION-REQUEST
message, using an EMM INFORMATION message as defined in 3GPP TS 24.301 [14];
or
2) discard the SGsAP-MM-INFORMATION-REQUEST message. In this case the MME can
send an EMM INFORMATION message as defined in 3GPP TS 24.301 [14] to the UE,
with contents generated locally by the MME.
The MME should avoid sending both EMM INFORMATION messages according to option
1 and EMM INFORMATION messages according to option 2 to the same UE.
NOTE 1: Sending messages according to option 1 and option 2 to the same UE can
result in short-time changes of the network name or the local time displayed
by the UE.
For option 1) the MME checks and updates the contents of the MM information
information element as follows:
a) If LSA Identity has been included in the MM information, the MME shall
discard the LSA Identity;
b) If the network spans more than one time zone, the MME shall handle the
time-related parameters as follows:
\- if Network Daylight Saving Time has been included in the MM information,
then the MME shall discard the Network Daylight Saving Time;
\- if Local Time Zone has been included in the MM information, then the MME
shall replace the Local Time Zone with the Local Time Zone applicable for this
UE. In addition, if the local time zone in the MME has been adjusted for
daylight saving time, the MME shall indicate this by including the value used
for adjustment in Network Daylight Saving Time IE in the MM information;
\- if Universal time and local time zone has been included in the MM
information, then the MME shall replace it with the Universal time and local
time zone applicable for this UE. In addition, if the local time zone in the
MME has been adjusted for daylight saving time, the MME shall indicate this by
including the value used for adjustment in Network Daylight Saving Time IE in
the MM information;
NOTE 2: For the determination of the number of time zones, both CS and PS
domain are taken into account.
c) If the network name, i.e. Full name for network or Short name for network
or both, has been included by the VLR in the MM information information
element, then dependent on operator preference and other information, e.g. the
IMSI of the subscriber, the MME may
\- replace the network name received from the VLR with a different network
name;
\- remove the network name from the MM information information element; or
\- keep the network name received from the VLR unchanged.
NOTE 3: The network name received from the VLR can be different from the
network name provided by the MME, e.g. if multiple PLMNs are available for the
CS domain.
## 5.11 Procedure for tunnelling of NAS messages
### 5.11.1 General description
The tunnelling of NAS messages procedure is used to encapsulate the NAS
messages exchanged between the UE and the VLR. This procedure can be used by
either the VLR or the MME depending on the direction of the NAS message. The
two procedures are identified as uplink unitdata, in the direction from the
MME to the VLR, and downlink unitdata in the direction from the VLR to the
MME.
### 5.11.2 Uplink unitdata procedure
#### 5.11.2.1 Procedures in the MME
When the MME receives an Uplink NAS Transport message (see 3GPP TS 24.301
[14]) from a UE, the MME shall copy the value part of the NAS message
container information element to the value part of the NAS message container
information element of the SGsAP-UPLINK-UNITDATA message and send the SGsAP-
UPLINK-UNITDATA message to the VLR if the \"VLR-Reliable\" MM context variable
is not set to \"false\". If the \"VLR-Reliable\" MM context variable is set to
\"false\", the MME requests the UE to re-attach for non-EPS services as
specified in 3GPP TS 24.301 [14].
In order to permit the VLR to create an accurate charging record, the MME
shall add the IMEISV, the UE Time Zone, the Mobile Station Classmark 2, and
the UE's current TAI and E-CGI to the SGsAP-UPLINK-UNITDATA message.
#### 5.11.2.2 Procedures in the VLR
##### 5.11.2.2.1 General description
Upon reception of an SGsAP-UPLINK-UNITDATA, the VLR shall extract the NAS
message container information element and treat the value part of this
information element according to the procedures defined in 3GPP TS 24.011
[10].
Other parameters in the message may be used as specified in 3GPP TS 32.250
[17B] and 3GPP TS 23.078 [5AA].
##### 5.11.2.2.2 Abnormal cases
The following abnormal cases can be identified:
i) subscriber data does not exist or is not confirmed by HLR
If the VLR receives an SGsAP-UPLINK-UNITDATA message from the MME for a UE for
which subscriber data does not exist or is not confirmed by HLR, then the VLR
shall ignore the received message, and return an SGsAP-RELEASE-REQUEST message
to the MME with an SGs cause information element indicating \"IMSI unknown\".
ii) subscriber data exists, but there is no SGs association for the UE at the
VLR
If the VLR receives an SGsAP-UPLINK-UNITDATA message from the MME for a UE for
which no SGs association exists, then the VLR shall ignore the received
message, and return an SGsAP-RELEASE-REQUEST message to the MME with an SGs
cause information element indicating \"IMSI detached for non-EPS services\".
#### 5.11.2.3 Void
### 5.11.3 Downlink unitdata procedure
#### 5.11.3.1 Procedures in the VLR
When the VLR needs to send a NAS message to the UE, the VLR shall first verify
whether or not it has an SGs association for the UE. If the state of the SGs
association for the UE is SGs-ASSOCIATED and LA-UPDATE-PRESENT, then the VLR
continues with the procedure. The VLR shall build and encapsulate the NAS
message into the value part of the NAS message container information element
of an SGsAP-DOWNLINK-UNITDATA message and send the SGsAP-DOWNLINK-UNITDATA
message to the MME.
#### 5.11.3.2 Procedures in the MME
##### 5.11.3.2.1 General description
Upon reception of an SGsAP-DOWNLINK-UNITDATA message, the MME shall copy the
value part of the NAS message container information element to the value part
of the NAS message container information element of a Downlink NAS Transport
message (see 3GPP TS 24.301 [14]) and send the Downlink NAS Transport message
to the UE.
##### 5.11.3.2.2 Abnormal cases
The following abnormal cases can be identified:
i) subscriber data does not exist or is not confirmed by HSS
If the MME receives an SGsAP-DOWNLINK-UNITDATA message from the VLR for a UE
for which subscriber data does not exist or is not confirmed by HSS, then the
MME shall ignore the received message.
ii) subscriber data exists, but there is no SGs association for the UE at the
MME
If the MME receives an SGsAP-DOWNLINK-UNITDATA message from the VLR for a UE
for which there is no SGs association, then the MME shall ignore the received
message.
#### 5.11.3.3 Void
### 5.11.4 Release procedure
When the VLR determines that there are no more NAS messages to be exchanged
between the VLR and the UE, or when a further exchange of NAS messages for the
specified UE is not possible due to an error, the VLR shall send the SGsAP-
RELEASE-REQUEST message to the MME, including the IMSI of the UE for which
there are no more NAS messages to be tunnelled.
NOTE: For the SMS transport, the VLR can send the SGsAP-RELEASE-REQUEST
message when the SMS transaction is complete (reception of a CP-ACK message
for the MO case, sending of a CP-ACK message for the MT case), upon reception
of a CP-ERROR message, abort of SMS transaction by upper layers, or upon some
error cases such as TC1 expiry, no SGs association for the UE or IMSI unknown.
Upon receipt of an SGsAP-RELEASE-REQUEST message with an SGs cause information
element indicating \"IMSI unknown\" or \"IMSI detached for non-EPS services\",
the MME shall set the \"VLR-Reliable\" MM context variable to \"false\". In
addition, the MME requests the UE to re-attach for non-EPS services as
specified in 3GPP TS 24.301 [14].
## 5.12 Service request procedure
### 5.12.1 General description
After the reception of an SGsAP-PAGING-REQUEST message from the VLR, the MME
will use this procedure to indicate to the VLR that a NAS signalling
connection exists between the UE and the MME. The procedure can be invoked, by
the MME, either upon reception of a Service Request message from the UE or
directly after receiving the SGsAP-PAGING-REQUEST message from the VLR, based
on the UE's EMM mode.
### 5.12.2 Procedures in the MME
When receiving the SGsAP-PAGING-REQUEST message, the MME shall first take
action as described in subclause 5.1.3 and check whether the UE, for which the
paging is sent, is in EMM-IDLE or EMM-CONNECTED mode.
If the MME accepts the paging request, the MME shall proceed as follows:
\- If the UE was in EMM-CONNECTED mode, the MME creates and sends an SGsAP-
SERVICE-REQUEST message to the VLR based on the conditions specified in 3GPP
TS 23.272 [7]. If the UE subsequently rejects the CS fallback call, the MME
shall send the SGsAP-PAGING-REJECT message to the VLR with the SGs cause
information element indicating \"Mobile terminating CS fallback call rejected
by the user\"; or
\- If the UE was in EMM-IDLE mode, the MME shall send the SGsAP-SERVICE-
REQUEST message to the VLR when the UE enters EMM-CONNECTED mode.
The MME shall set the service indicator in the SGsAP-SERVICE-REQUEST message
equal to what was received in the SGsAP-PAGING-REQUEST message. Additionally,
in order to permit the VLR to create an accurate charging record, the MME
shall add the IMEISV, the UE Time Zone, the Mobile Station Classmark 2, and
the UE\'s current TAI and E-CGI to the SGsAP-SERVICE-REQUEST message.
### 5.12.3 Procedures in the VLR
Upon reception of the SGsAP-SERVICE-REQUEST message, the VLR shall stop Timer
Ts5 and consider the paging procedure as successful. If the paging procedure
is for SMS, the VLR shall then start the delivery of the SMS message(s)
according to the subclause 5.11.3.1. If the paging procedure with the Service
indicator information element indicating \"SMS Indicator\" was triggered upon
reception of a Provide Subscriber Information Request message, the VLR can
return an SGs AP-RELEASE-REQUEST message to the MME as specified in subclause
7.2.3.5 of 3GPP TS 23.018 [5].
Other parameters in the message may be used as specified in 3GPP TS 32.250
[17B] and 3GPP TS 23.078 [5AA].
## 5.13 Service abort procedure
### 5.13.1 General description
This procedure can be invoked by the VLR to abort a mobile terminating CS
fallback call during call establishment. The procedure applies to UEs that are
simultaneously attached for EPS services and non-EPS services, but not to UEs
attached for EPS services and SMS only.
### 5.13.2 Procedures in the VLR
If the VLR decides to abort a mobile terminating CS fallback call for which it
has sent an SGsAP-PAGING-REQUEST message to the MME, and the VLR has not
received an SCCP connection establishment containing the Initial L3 message
from the UE via the A or Iu interface, the VLR shall send the SGsAP-SERVICE-
ABORT-REQUEST message to the MME. The state of the SGs association is not
changed.
### 5.13.3 Procedures in the MME
When the MME receives the SGsAP-SERVICE-ABORT-REQUEST message from the VLR,
the MME shall set the Call Cancelled Flag to \"true\".
If the MME receives an EXTENDED SERVICE REQUEST message from the UE with
Service type set to \"mobile terminating CS fallback or 1xCS fallback\" and
CSFB response set to \"CS fallback accepted by the UE\" and the Call Cancelled
Flag is set to \"true\", the MME shall set the Call Cancelled Flag to
\"false\" and will reject the CS fallback call as specified in 3GPP TS 24.301
[14].
If the Call Cancelled Flag is set to \"true\", the MME shall set the Call
Cancelled Flag to \"false\":
\- upon reception of the EXTENDED SERVICE REQUEST message from the UE with
Service type set to a value other than \"mobile terminating CS fallback or
1xCS fallback\" or CSFB response set to a value other than \"CS fallback
accepted by the UE\"; or
\- upon reception of a new SGsAP-PAGING-REQUEST message from the VLR.
When the MME receives the SGsAP-SERVICE-ABORT-REQUEST message after the UE has
accepted the CS fallback call, the MME shall discard the SGsAP-SERVICE-ABORT-
REQUEST message. The state of the SGs association is not changed.
## 5.14 Implicit IMSI detach from EPS services
### 5.14.1 General description
This procedure is used by the MME to indicate when an internal MME timer
mechanism has caused the MME to delete the EMM context of an UE or mark its
EMM context as detached. This procedure only applies to UEs for which there is
an SGs association at the MME and the network operating in NMO I and
supporting ISR.
The implicit IMSI detach from EPS services procedure aborts any other ongoing
procedure related to this UE on the SGs interface in the MME and in the VLR.
In order to ensure that the VLR and the UE are synchronized as to which paging
channel to use for any of the subsequent paging events the MME shall attempt
to inform the VLR about the detach event by using a retry scheme if the
initial delivery of the SGsAP-EPS-DETACH-INDICATION message fails.
### 5.14.2 Procedures in the MME
When the implicit IMSI detach from EPS services procedure is started for a UE
by the above mentioned internal MME timer mechanism, the MME shall send an
SGsAP-EPS-DETACH-INDICATION message to the VLR indicating \"Network initiated
IMSI detach from EPS services\".
After the sending of the SGsAP-EPS-DETACH-INDICATION message, the MME shall
move the state of the SGs association to SGs-NULL. The MME shall start timer
Ts13 upon transmission of the SGsAP-EPS-DETACH-INDICATION message.
If no SGsAP-EPS-DETACH-ACK message is received by the MME to a previous SGsAP-
EPS-DETACH-INDICATION message before timer Ts13 expires, the MME shall repeat
the SGsAP-EPS-DETACH-INDICATION message a maximum of Ns10 times. The state of
the SGs association during the acknowledgement procedure remains SGs-NULL.
### 5.14.3 Procedures in the VLR
When a VLR receives an SGsAP-EPS-DETACH-INDICATION message, the VLR shall
perform the procedures described in subclause 5.4.3.
## 5.15 Void
## 5.16 Procedure for MO CSFB indication
### 5.16.1 General description
If the network is configured to support the return to the last used E-UTRAN
PLMN after CS fallback as specified in 3GPP TS 23.272 [7], this procedure is
used to indicate to the VLR that the UE initiated a service request for MO CS
fallback.
### 5.16.2 Procedures in the MME
If the MME is configured to support the return to the last used E-UTRAN PLMN
after CS fallback, upon reception of an EXTENDED SERVICE REQUEST message (see
3GPP TS 24.301 [14]) from the UE with Service type set to \"mobile originating
CS fallback or 1xCS fallback\" or \"mobile originating CS fallback emergency
call or 1xCS fallback emergency call\" from the UE, the MME shall send the
SGsAP-MO-CSFB-INDICATION message to the VLR.
### 5.16.3 Procedures in the VLR
If the VLR is configured to support the return to the last used E-UTRAN PLMN
after CS fallback, upon reception of an SGsAP-MO-CSFB-INDICATION, the VLR
shall start timer Ts15 to supervise the success of the UE fallback.
If an SCCP connection establishment containing the Initial L3 message is
received from the UE via the A or Iu interface, the VLR shall stop timer Ts15
and apply specific handling related to the return to the last used E-UTRAN
PLMN after CS fallback.
Upon expiry of Ts15, the VLR considers the MO CSFB to have failed and does not
apply specific handling related to support of the return to the last used
E-UTRAN PLMN after CS fallback.
# 6 SGs transport
## 6.1 General
This subclause specifies the standards for signalling transport to be used
across SGs interface. SGs interface is a logical interface between the MME and
the VLR. All the SGsAP messages described in the present document require an
SCTP association between the MME and the VLR.
## 6.2 IP layer
The MME and the VLR shall support IPv6 (see IETF RFC 2460 [22]) and/or IPv4
(see IETF RFC 791 [20]).
The IP layer of SGs only supports point-to-point transmission for delivering
SGsAP messages.
## 6.3 Transport layer
SCTP (see IETF RFC 4960 [23]) shall be supported as the transport layer of
SGsAP messages.
Semi-permanent SCTP associations shall be established between the MME and VLR,
i.e. the SCTP associations shall remain up under normal circumstances.
Transport network redundancy can be achieved by SCTP multi-homing between two
end-points, of which one or both is assigned with multiple IP addresses. SCTP
end-points shall support a multi-homed remote SCTP end-point. For SCTP
endpoint redundancy, an SCTP endpoint (in the MME or VLR) may send an INIT, at
any time for an already established SCTP association, which the other SCTP
endpoint shall handle as defined in IETF RFC 4960 [23].
MME and VLR shall support a configuration with a single SCTP association per
MME/VLR pair. Configurations with multiple SCTP endpoints per MME/VLR pair may
be supported.
NOTE: If multiple SCTP endpoints are configured and several SCTP associations
are established between the MME/VLR pair, whether the VLR and the MME send and
receive SGsAP messages via same or different SCTP associations for a given UE
is up to implementation.
Within the SCTP association established between one MME and one VLR, both MME
and VLR shall reserve several stream identifiers, based on the INIT message
exchange for the sole use of SGsAP procedures.
The MME shall establish the SCTP association.
The registered port number for SGsAP is 29118.
The payload protocol identifier to be used for SGsAP is 0.
# 7 Error handling
## 7.1 General
This subclause specifies procedures for the handling of unknown, unforeseen,
and erroneous protocol data by the receiving entity (i.e. the MME or the VLR).
These procedures are called \"error handling procedures\", but in addition to
providing recovery mechanisms for error situations, they define a
compatibility mechanism for future extensions of the protocol.
In this subclause, the following terminology is used:
\- an information element is defined to be syntactically incorrect in a
message if it contains at least one value defined as \"reserved\", or if its
value part violates coding rules. However, it is not a syntactical error that
an information element indicates in its Length Indicator a greater length than
defined in the relevant subclause; and
\- a message is defined to have semantically incorrect contents if it contains
information which, possibly dependant on the state of the receiver, is in
contradiction to the resources of the receiver and/or to the procedural part
of current specification.
When a receiving entity detects the need to send an SGsAP-STATUS message (see
errors detailed below), the entity shall copy the IMSI information element
value (if included) of the incorrect message to the IMSI information element
of the SGsAP-STATUS message. The message in error is also included in the
SGsAP-STATUS message. Both the receiving and the sending entity shall abandon
the procedure related to the incorrect message and return to the state from
where the procedure related to the incorrect message was started.
An SGsAP-STATUS message shall not be sent in response to a received SGsAP-
STATUS message.
Both the receiving and the sending entity shall inform the O&M entity upon
sending or receiving an SGsAP-STATUS message.
The next subclauses shall be applied in order of precedence.
## 7.2 Message too short
When the receiving entity receives a message that is too short to contain a
complete message type information element, the receiving entity shall ignore
that message.
## 7.3 Unknown or unforeseen message type
The entity receiving a message with a message type not defined or not
implemented shall ignore the message. The receiving entity shall return an
SGsAP-STATUS message with the SGs cause information element set to \"message
unknown\" and the Erroneous message information element containing the
received message.
The entity receiving a message that is not compatible with the protocol state
shall return an SGsAP-STATUS message with the SGs cause information element
set to \"message not compatible with the protocol state\" and the erroneous
message.
The entity receiving a message that is not defined to be received by that
entity (i.e. the message is sent in the wrong direction) shall treat the
message as unknown message and shall ignore the message. The entity shall
return an SGsAP-STATUS message with the SGs cause information element set to
\"message unknown\" and the Erroneous message information element containing
the received message.
## 7.4 Missing mandatory information element
When the receiving entity diagnoses a \"missing mandatory information
element\" error, the receiving entity shall ignore the message and return an
SGsAP-STATUS message with the SGs cause information element set to \"missing
mandatory information element\" and shall return the Erroneous message
information element containing the received message.
## 7.5 Information elements unknown or unforeseen in the message
The receiving entity shall ignore all information elements unknown or
unforeseen in a message.
## 7.6 Out of sequence information elements
The receiving entity shall ignore all information elements that are out of
sequence.
## 7.7 Repeated information elements
If an information element with format T, TV, or TLV is repeated in a message
in which repetition of the information element is not specified, the receiving
entity shall only handle the contents of the information element appearing
first and shall ignore all subsequent repetitions of the information element.
When repetition of information elements is specified, the receiving entity
shall only handle the contents of specified repeated information elements. If
the limit on repetition of information elements is exceeded, the receiving
entity shall handle the contents of information elements appearing first up to
the limit of repetitions and shall ignore all subsequent repetitions of the
information element.
## 7.8 Syntactically incorrect mandatory information element.
On receipt of a message which contains a syntactically incorrect mandatory
information element, the receiver shall ignore the message and return an
SGsAP-STATUS message with the SGs cause information element set to \"invalid
mandatory information\" and shall return the Erroneous message information
element containing the received message.
## 7.9 Syntactically incorrect optional information elements
The receiving entity shall treat all optional information elements that are
syntactically incorrect in a message as not present in the message.
## 7.10 Conditional information element errors
When the entity receiving a message diagnoses a \"missing conditional
information element\" error or an \"unexpected conditional information
element\" error or when it receives a message containing at least one
syntactically incorrect conditional information element which is required to
be present in the message, the receiving entity shall ignore the message and
return an SGsAP-STATUS message with the SGs cause information element set to
\"conditional information element error\" and shall return the Erroneous
message information element containing the received message.
When the entity receives a message containing a syntactically incorrect
conditional information element which is not required to be present in the
message, nor required to be absent in the message, then the receiving entity
shall ignore that information element.
## 7.11 Information elements with semantically incorrect contents
When an information element with semantically incorrect contents is received,
the foreseen reactions of the procedural part of the present specification are
performed.
If however no such reactions are specified, the receiving entity shall ignore
that information element and treat the rest of the message. If, because this
information element was ignored, the rest of the message can no longer be
handled then the receiving entity shall return an SGsAP-STATUS message with
the SGs cause information element set to \"semantically incorrect message\"
and shall return the Erroneous message information element containing the
received message.
# 8 Message functional definitions and contents
## 8.1 SGsAP-ALERT-ACK message
This message is sent by the MME to the VLR to acknowledge a previous SGsAP-
ALERT-REQUEST message. Table 8.1.1 shows the content of the SGsAP-ALERT-ACK
message.
Table 8.1.1: SGsAP-ALERT-ACK message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
* * *
## 8.2 SGsAP-ALERT-REJECT message
This message is sent from the MME to the VLR to indicate that the MME could
not identify the IMSI indicated in the SGsAP-ALERT-REQUEST message. Table
8.2.1 shows the content of the SGsAP-ALERT-REJECT message.
Table 8.2.1: SGsAP-ALERT-REJECT message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
SGs Cause SGs cause\ M TLV 3 9.4.18
* * *
## 8.3 SGsAP-ALERT-REQUEST message
This message is sent by the VLR to the MME to request an indication when the
next activity of a UE is detected. Table 8.3.1 shows the content of the SGsAP-
ALERT-REQUEST message.
Table 8.3.1: SGsAP-ALERT-REQUEST message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
* * *
## 8.4 SGsAP-DOWNLINK-UNITDATA message
This message is sent from the VLR to the MME to transparently relay a NAS
message, from the VLR, to the UE. Table 8.4.1 shows the content of the SGsAP-
DOWNLINK-UNITDATA message.
Table 8.4.1: SGsAP-DOWNLINK-UNITDATA message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
NAS message container NAS message container\ M TLV 4-253 9.4.15
* * *
## 8.5 SGsAP-EPS-DETACH-ACK message
This message is sent by the VLR to the MME to acknowledge a previous SGsAP-
EPS-DETACH-INDICATION message. Table 8.5.1 shows the content of the SGsAP-EPS-
DETACH-ACK message.
Table 8.5.1: SGsAP-EPS-DETACH-ACK message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
* * *
## 8.6 SGsAP-EPS-DETACH-INDICATION message
This message is sent by the MME to the VLR to indicate an EPS detach performed
from the UE or the MME. The type of detach is indicated in the IMSI detach
from EPS service type information element. Table 8.6.1 shows the content of
the SGsAP-EPS-DETACH-INDICATION message.
Table 8.6.1: SGsAP-EPS-DETACH-INDICATION message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
MME name MME name\ M TLV 57 9.4.13
IMSI detach from EPS service type IMSI detach from EPS service type\ M TLV 3
9.4.7
* * *
## 8.7 SGsAP-IMSI-DETACH-ACK message
This message is sent by the VLR to the MME to acknowledge a previous SGsAP-
IMSI-DETACH-INDICATION message. Table 8.7.1 shows the content of the SGsAP-
IMSI-DETACH-ACK message.
Table 8.7.1: SGsAP-IMSI-DETACH-ACK message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
* * *
## 8.8 SGsAP-IMSI-DETACH-INDICATION message
This message is sent by the MME to the VLR to indicate an IMSI detach
performed from the UE. The type of detach is indicated in the IMSI detach from
non-EPS service type information element. Table 8.8.1 shows the content of the
SGsAP-IMSI-DETACH-INDICATION message.
Table 8.8.1: SGsAP-IMSI-DETACH-INDICATION message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
MME name MME name\ M TLV 57 9.4.13
IMSI Detach from non-EPS service type IMSI detach from non-EPS service type\ M
TLV 3 9.4.8
* * *
## 8.9 SGsAP-LOCATION-UPDATE-ACCEPT message
### 8.9.1 Message definition
This message is sent by the VLR to the MME to indicate that update or IMSI
attach in the VLR has been completed. Table 8.9.1.1 shows the content of the
SGsAP-LOCATION-UPDATE-ACCEPT message.
Table 8.9.1.1: SGsAP-LOCATION-UPDATE-ACCEPT message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
Location area identifier Location area identifier\ M TLV 7 9.4.11
New TMSI, or IMSI Mobile identity\ O TLV 6-10 9.4.14
* * *
### 8.9.2 New TMSI, or IMSI
This information element represents the identity to be used for (and then by)
the UE.
If this information element is an IMSI, then the UE is not allocated any TMSI
(and deletes any TMSI accordingly). If this information element is a TMSI,
then the UE will use this TMSI as the new temporary identity (the UE deletes
its old TMSI and stores the new TMSI). If neither a TMSI nor an IMSI are
included in this information element, the old TMSI, if any available, will be
kept.
## 8.10 SGsAP-LOCATION-UPDATE-REJECT message
### 8.10.1 Message definition
This message is sent by the VLR to the MME to indicate that location update or
IMSI attach has failed. Table 8.10.1 shows the content of the SGsAP-LOCATION-
UPDATE-REJECT message.
Table 8.10.1: SGsAP-LOCATION-UPDATE-REJECT message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
Reject cause Reject cause\ M TLV 3 9.4.16
Location area identifier Location area identifier\ O TLV 7 9.4.11
* * *
### 8.10.2 Location area identifier
The VLR shall include this information element.
## 8.11 SGsAP-LOCATION-UPDATE-REQUEST message
### 8.11.1 Message definition
This message is sent by the MME to the VLR either to request update of its
location file (normal update) or to request IMSI attach. Table 8.11.1.1 shows
the content of the SGsAP-LOCATION-UPDATE-REQUEST message.
Table 8.11.1.1: SGsAP-LOCATION-UPDATE-REQUEST message content
+-------------------+-------------------+----------+--------+--------+ | Information | Type/Reference | Presence | Format | Length | | element | | | | | +-------------------+-------------------+----------+--------+--------+ | Message type | Message type\ | M | V | 1 | | | 9.2 | | | | +-------------------+-------------------+----------+--------+--------+ | IMSI | IMSI\ | M | TLV | 6-10 | | | 9.4.6 | | | | +-------------------+-------------------+----------+--------+--------+ | MME name | MME name\ | M | TLV | 57 | | | 9.4.13 | | | | +-------------------+-------------------+----------+--------+--------+ | EPS location | EPS location | M | TLV | 3 | | update type | update type\ | | | | | | 9.4.2 | | | | +-------------------+-------------------+----------+--------+--------+ | New location area | Location area | M | TLV | 7 | | identifier | identifier\ | | | | | | 9.4.11 | | | | +-------------------+-------------------+----------+--------+--------+ | Old location area | Location area | O | TLV | 7 | | identifier | identifier\ | | | | | | 9.4.11 | | | | +-------------------+-------------------+----------+--------+--------+ | TMSI status | TMSI status\ | O | TLV | 3 | | | 9.4.21 | | | | +-------------------+-------------------+----------+--------+--------+ | IMEISV | IMEISV\ | O | TLV | 10 | | | 9.4.5 | | | | +-------------------+-------------------+----------+--------+--------+ | TAI | Tracking Area | O | TLV | 7 | | | Identity\ | | | | | | 9.4.21a | | | | +-------------------+-------------------+----------+--------+--------+ | E-CGI | E-UTRAN Cell | O | TLV | 9 | | | Global Identity\ | | | | | | 9.4.3a | | | | +-------------------+-------------------+----------+--------+--------+ | TMSI based NRI | TMSI based NRI | O | TLV | 4 | | container | container\ | | | | | | 9.4.26 | | | | +-------------------+-------------------+----------+--------+--------+ | Selected CS | Selected CS | O | TLV | 5 | | domain operator | domain operator | | | | | | | | | | | | 9.4.27 | | | | +-------------------+-------------------+----------+--------+--------+
### 8.11.2 Old location area identifier
The MME shall include this information element if the UE included the old
location area information in the ATTACH REQUEST or TRACKING AREA UPDATE
REQUEST message.
### 8.11.3 TMSI status
The MME shall include this information element if the TMSI status received in
the ATTACH REQUEST or TRACKING AREA UPDATING REQUEST message from the UE
indicates that no valid TMSI is available in the UE.
### 8.11.4 IMEISV
The MME shall include this information element if the MME supports the
\"Automatic Device Detection\" or the \"Trace for Management Based
Activation/Deactivation\".
### 8.11.5 TAI
If the TAI is available in the MME, the MME shall include this information
element.
### 8.11.6 E-CGI
If the E-CGI is available in the MME, the MME shall include this information
element.
### 8.11.7 TMSI based NRI container
This information element shall be included if the TMSI based NRI container has
been received in the ATTACH REQUEST or TRACKING AREA UPDATING REQUEST message
from the UE.
### 8.11.8 Selected CS domain operator
This information element shall be included if the network is configured to
support gateway core network (GWCN) for CS domain, the preferred RAT of the
selected PLMN for CS fallback is GERAN, and the UE does not support GERAN
network sharing.
## 8.12 SGsAP-MM-INFORMATION-REQUEST
This message is sent by the VLR to the MME to provide the UE with subscriber
specific information. Table 8.12.1 shows the content of the SGsAP-MM-
INFORMATION-REQUEST message.
Table 8.12.1: SGsAP-MM-INFORMATION-REQUEST message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
MM information MM information\ M TLV 3-n 9.4.12
* * *
## 8.13 SGsAP-PAGING-REJECT message
This message is sent from the MME to the VLR to indicate that the delivery of
a previous SGsAP-PAGING-REQUEST message has failed. Table 8.13.1 shows the
content of the SGsAP-PAGING-REJECT message.
Table 8.13.1: SGsAP-PAGING-REJECT message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
SGs Cause SGs Cause\ M TLV 3 9.4.18
* * *
## 8.14 SGsAP-PAGING-REQUEST message
### 8.14.1 Message definition
This message is sent from the VLR to the MME and contains sufficient
information to allow the paging message to be transmitted by the correct cells
at the correct time. Table 8.14.1.1 shows the content of the SGsAP-PAGING-
REQUEST message.
Table 8.14.1.1: SGsAP-PAGING-REQUEST message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
VLR name VLR name\ M TLV 3-n 9.4.22
Service indicator Service indicator\ M TLV 3 9.4.17
TMSI TMSI\ O TLV 6 9.4.20
CLI CLI\ O TLV 3-14 9.4.1
Location area identifier Location area identifier\ O TLV 7 9.4.11
Global CN-Id Global CN-Id\ O TLV 7 9.4.4
SS code SS code\ O TLV 3 9.4.19
LCS indicator LCS indicator\ O TLV 3 9.4.10
LCS client identity LCS client identity\ O TLV 3-n 9.4.9
Channel needed Channel needed\ O TLV 3 9.4.23
eMLPP Priority eMLPP Priority\ O TLV 3 9.4.24
Additional paging indicators Additional paging indicators\ O TLV 3 9.4.25
* * *
### 8.14.2 TMSI
This element is omitted in the exceptional case where paging with IMSI is
performed.
### 8.14.3 CLI
If the Calling Line Identification is available in the VLR, the VLR shall
include this information element.
### 8.14.4 Location area identifier
The VLR shall include this information element if the \"Confirmed by Radio
Contact\" restoration indicator is set to \"true\".
### 8.14.5 Global CN-Id
If the network supports the Intra Domain Connection of RAN Nodes to multiple
CN Nodes functionality, the VLR shall include this information element when
the VLR initiates paging by IMSI, via the SGs interface.
### 8.14.6 SS code
The VLR shall include this information element if paging is due to a NW-
initiated Call Independent SS procedure (see 3GPP TS 24.010 [9]).
### 8.14.7 LCS indicator
The VLR shall include this information element if the paging is due to a
Mobile Terminated Location Request (see 3GPP TS 24.030 [11]).
### 8.14.8 LCS client identity
The VLR may include this information element if the paging is due to a Mobile
Terminated Location Request (see 3GPP TS 24.030 [11]). If the paging is due to
emergency positioning, then VLR should include this information element.
### 8.14.9 Channel needed
This information element shall be included if the VLR intends to indicate
which channel the UE should use.
### 8.14.10 eMLPP priority
This information element shall be included if the VLR supports CSFB priority
call handling and the call was received with eMLPP priority level indication.
### 8.14.11 Additional paging indicators
This information element shall be included if additional paging information
e.g. CS restoration indicator needs to be passed to the MME.
## 8.15 SGsAP-RESET-ACK message
### 8.15.1 Message definition
This message is sent from the MME or the VLR to acknowledge a previous SGsAP-
RESET-INDICATION message. This message indicates that all the SGs associations
to the VLR or the MME have been marked as invalid.
The sending entity (either MME or VLR) includes its identity in the form of a
name in the SGsAP-RESET-ACK message. Table 8.15.1.1 shows the content of the
SGsAP-RESET-ACK message.
Table 8.15.1.1: SGsAP-RESET-ACK message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
MME name MME name\ C TLV 57 9.4.13
VLR name VLR name\ C TLV 3-n 9.4.22
* * *
### 8.15.2 MME name
If the MME is the sending entity, then the MME shall indicate its identity by
including its MME name information element. Otherwise (i.e. if the VLR is the
sending entity), then the VLR shall not include the MME name information
element.
### 8.15.3 VLR name
If the VLR is the sending entity, then the VLR shall indicate its identity by
including its VLR name information element. Otherwise (i.e. if the MME is the
sending entity), then MME shall not include the VLR name information element.
## 8.16 SGsAP-RESET-INDICATION message
### 8.16.1 Message definition
This message is sent from the VLR to the MME to indicate that a failure in the
VLR has occurred and all the SGs associations to the VLR are be marked as
invalid.
This message is also sent from the MME to the VLR to indicate that a failure
in the MME has occurred and all the SGs associations to the MME are be marked
as invalid.
The sending entity (either MME or VLR) includes its identity in the SGsAP-
RESET-INDICATION message. Table 8.16.1.1 shows the content of the SGsAP-RESET-
INDICATION message.
Table 8.16.1.1: SGsAP-RESET-INDICATION message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
MME name MME name\ C TLV 57 9.4.13
VLR name VLR name\ C TLV 3-n 9.4.22
* * *
### 8.16.2 MME name
If the MME is the sending entity, then the MME shall indicate its identity by
including its MME name information element. Otherwise (i.e. if the VLR is the
sending entity), then the VLR shall not include the MME name information
element.
### 8.16.3 VLR name
If the VLR is the sending entity, then the VLR shall indicate its identity by
including its VLR name information element. Otherwise (i.e. if the MME is the
sending entity), then the MME shall not include the VLR name information
element.
## 8.17 SGsAP-SERVICE-REQUEST message
### 8.17.1 Message definition
This message is sent from the MME to the VLR as a response to a previously
received SGsAP-PAGING-REQUEST message to indicate the existence of a NAS
signalling connection between the UE and the MME or to indicate to the VLR
that the NAS signalling connection has been established after the paging
procedure. Table 8.17.1 shows the content of the SGsAP-SERVICE-REQUEST
message.
Table 8.17.1: SGsAP-SERVICE-REQUEST message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.1
IMSI IMSI\ M TLV 6-10 9.4.6
Service indicator Service indicator\ M TLV 3 9.4.17
IMEISV IMEISV\ O TLV 10 9.4.5
UE Time Zone UE Time Zone\ O TLV 3 9.4.21b
Mobile Station Classmark 2 Mobile Station Classmark 2\ O TLV 5 9.4.14a
TAI Tracking Area Identity\ O TLV 7 9.4.21a
E-CGI E-UTRAN Cell Global Identity\ O TLV 9 9.4.3a
UE EMM Mode UE EMM mode\ O TLV 3 9.4.21c
* * *
### 8.17.2 IMEISV
If the IMEISV is available in the MME, the MME shall include this information
element.
### 8.17.3 UE Time Zone
If the UE Time Zone is available in the MME, the MME shall include this
information element.
### 8.17.4 Mobile Station Classmark 2
If the Mobile Station Classmark 2 is available in the MME, the MME shall
include this information element.
### 8.17.5 TAI
If the TAI is available in the MME, the MME shall include this information
element.
### 8.17.6 E-CGI
If the E-CGI is available in the MME, the MME shall include this information
element.
### 8.17.7 UE EMM Mode
The MME shall include this information element. This information element
indicates the EMM mode of the UE when the SGsAP-PAGING-REQUEST message was
received by the MME.
## 8.18 SGsAP-STATUS message
### 8.18.1 Message definition
This message is sent by both the VLR and the MME to indicate an error. The
contents of SGsAP-STATUS message are shown in table 8.18.1.1.
Table 8.18.1.1: SGsAP-STATUS message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ O TLV 6-10 9.4.6
SGs cause SGs cause\ M TLV 3 9.4.18
Erroneous message Erroneous message\ M TLV 3-n 9.4.3
* * *
### 8.18.2 IMSI
The MME shall include this information element if the IMSI is present in the
erroneous message.
## 8.19 SGsAP-TMSI-REALLOCATION-COMPLETE message
This message is sent by the MME to the VLR to indicate that TMSI reallocation
on the UE has been successfully completed. Table 8.19.1 shows the content of
the SGsAP-TMSI-REALLOCATION-COMPLETE message.
Table 8.19.1: SGsAP-TMSI-REALLOCATION-COMPLETE message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
* * *
## 8.20 SGsAP-UE-ACTIVITY-INDICATION message
This message is sent by the MME to the VLR to indicate that activity from a UE
has been detected. Table 8.20.1 shows the content of the SGsAP-UE-ACTIVITY-
INDICATION message.
Table 8.20.1: SGsAP-UE-ACTIVITY-INDICATION message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
* * *
## 8.21 SGsAP-UE-UNREACHABLE message
This message is sent from the MME to the VLR to indicate that, for example,
paging could not be performed because the UE is marked as unreachable at the
MME. Table 8.21.1 shows the content of the SGsAP-UE-UNREACHABLE message.
Table 8.21.1: SGsAP-UE-UNREACHABLE message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
SGs cause SGs cause\ M TLV 3 9.4.18
* * *
## 8.22 SGsAP-UPLINK-UNITDATA message
### 8.22.1 Message definition
This message is sent from the MME to the VLR to transparently convey a NAS
message, from the UE, to the VLR. Table 8.22.1 shows the content of the SGsAP-
UPLINK-UNITDATA message.
Table 8.22.1: SGsAP-UPLINK-UNITDATA message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
NAS message container NAS message container\ M TLV 4-253 9.4.15
IMEISV IMEISV\ O TLV 10 9.4.5
UE Time Zone UE Time Zone\ O TLV 3 9.4.21b
Mobile Station Classmark 2 Mobile Station Classmark 2\ O TLV 5 9.4.14a
TAI Tracking Area Identity\ O TLV 7 9.4.21a
E-CGI E-UTRAN Cell Global Identity\ O TLV 9 9.4.3a
* * *
### 8.22.2 IMEISV
If the IMEISV is available in the MME, the MME shall include this information
element.
### 8.22.3 UE Time Zone
If the UE Time Zone is available in the MME, the MME shall include this
information element.
### 8.22.4 Mobile Station Classmark 2
If the Mobile Station Classmark 2 is available in the MME, the MME shall
include this information element.
### 8.22.5 TAI
If the TAI is available in the MME, the MME shall include this information
element.
### 8.22.6 E-CGI
If the E-CGI is available in the MME, the MME shall include this information
element.
## 8.23 SGsAP-RELEASE-REQUEST message
### 8.23.1 Message definition
This message is sent by the VLR to the MME when the VLR determines that there
are no more NAS messages to be exchanged between the VLR and the UE, or when a
further exchange of NAS messages for the specified UE is not possible due to
an error. Table 8.23.1 shows the content of the SGsAP-RELEASE-REQUEST message.
Table 8.23.1: SGsAP-RELEASE-REQUEST message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.2
IMSI IMSI\ M TLV 6-10 9.4.6
SGs cause SGs cause\ O TLV 3 9.4.18
* * *
### 8.23.2 SGs Cause
The VLR shall include the SGs Cause to indicate an error.
## 8.24 SGsAP-SERVICE-ABORT-REQUEST message
### 8.24.1 Message definition
This message is sent from the VLR to the MME to abort a mobile terminating CS
fallback call during call establishment. Table 8.24.1.1 shows the content of
the SGsAP-SERVICE-ABORT-REQUEST message.
Table 8.24.1.1: SGsAP-SERVICE-ABORT-REQUEST message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.1
IMSI IMSI\ M TLV 6-10 9.4.6
* * *
## 8.25 SGsAP-MO-CSFB-INDICATION message
### 8.25.1 Message definition
If the network is configured to support the return to the last used E-UTRAN
PLMN after CS fallback, this message is sent from the MME to the VLR to
indicate to the VLR that the UE initiated a service request for MO CS
fallback. Table 8.25.1 shows the content of the SGsAP-MO-CSFB-INDICATION
message.
Table 8.25.1: SGsAP-MO-CSFB-INDICATION message content
* * *
Information element Type/Reference Presence Format Length
Message type Message type\ M V 1 9.1
IMSI IMSI\ M LV 6-10 9.4.6
TAI Tracking Area Identity\ O TLV 7 9.4.21a
E-CGI E-UTRAN Cell Global Identity\ O TLV 9 9.4.3a
* * *
### 8.25.2 TAI
If the TAI is available in the MME, the MME shall include this information
element.
### 8.25.3 E-CGI
If the E-CGI is available in the MME, the MME shall include this information
element.
# 9 Information element coding
## 9.1 Overview
This clause specifies the coding of the information elements used in by the
SGsAP protocol.
The spare bits in the coding of an information element shall be set to zero by
the sender and shall be ignored by the receiver.
All unassigned codes (whether omitted or explicitely _Unassigned_ in the text)
shall be treated as unknown (see clause 7).
## 9.2 Message type
Message type uniquely identifies the message being sent. It is a single octet
information element, mandatory in all messages. Table 9.2.1 defines the value
part of the Message type information element.
Table 9.2.1: Message type information element
+-----------------+------------------------------------------------+-----------+ | 8 7 6 5 4 3 2 1 | Message type | Reference | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 0 0 0 0 | Unassigned: treated as an unknown Message type | 7 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 0 0 0 1 | SGsAP-PAGING-REQUEST | 8.14 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 0 0 1 0 | SGsAP-PAGING-REJECT | 8.13 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 0 0 1 1 | Unassigned: treated as an unknown Message type | 7 | | | | | | to | | | | | | | | 0 0 0 0 0 1 0 1 | | | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 0 1 1 0 | SGsAP-SERVICE-REQUEST | 8.17 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 0 1 1 1 | SGsAP-DOWNLINK-UNITDATA | 8.4 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 0 0 0 | SGsAP-UPLINK-UNITDATA | 8.22 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 0 0 1 | SGsAP-LOCATION-UPDATE-REQUEST | 8.11 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 0 1 0 | SGsAP-LOCATION-UPDATE-ACCEPT | 8.9 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 0 1 1 | SGsAP-LOCATION-UPDATE-REJECT | 8.10 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 1 0 0 | SGsAP-TMSI-REALLOCATION-COMPLETE | 8.19 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 1 0 1 | SGsAP-ALERT-REQUEST | 8.3 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 1 1 0 | SGsAP-ALERT-ACK | 8.1 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 0 1 1 1 1 | SGsAP-ALERT-REJECT | 8.2 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 0 0 0 | SGsAP-UE-ACTIVITY-INDICATION | 8.20 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 0 0 1 | SGsAP-EPS-DETACH-INDICATION | 8.6 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 0 1 0 | SGsAP-EPS-DETACH-ACK | 8.5 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 0 1 1 | SGsAP-IMSI-DETACH-INDICATION | 8.8 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 1 0 0 | SGsAP-IMSI-DETACH-ACK | 8.7 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 1 0 1 | SGsAP-RESET-INDICATION | 8.16 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 1 1 0 | SGsAP-RESET-ACK | 8.15 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 0 1 1 1 | SGsAP-SERVICE-ABORT-REQUEST | 8.24 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 0 0 0 | SGsAP-MO-CSFB-INDICATION | 8.25 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 0 0 1 | Unassigned: treated as an unknown Message type | 7 | | | | | | to | | | | | | | | 0 0 0 1 1 0 0 1 | | | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 0 1 0 | SGsAP-MM-INFORMATION-REQUEST | 8.12 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 0 1 1 | SGsAP-RELEASE-REQUEST | 8.23 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 1 0 0 | Unassigned: treated as an unknown Message type | 7 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 1 0 1 | SGsAP-STATUS | 8.18 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 1 1 0 | Unassigned: treated as an unknown Message type | 7 | +-----------------+------------------------------------------------+-----------+ | 0 0 0 1 1 1 1 1 | SGsAP-UE-UNREACHABLE | 8.21 | +-----------------+------------------------------------------------+-----------+
## 9.3 Information element identifiers
The next list shows the coding of the information element identifiers used in
the present document. Table 9.3.1 shows the values assigned for the
information element identifiers.
Table 9.3.1: Information element identifier coding
* * *
8 7 6 5 4 3 2 1 Information element Reference 0 0 0 0 0 0 0 1 IMSI 9.4.6 0 0 0
0 0 0 1 0 VLR name 9.4.22 0 0 0 0 0 0 1 1 TMSI 9.4.20 0 0 0 0 0 1 0 0 Location
area identifier 9.4.11 0 0 0 0 0 1 0 1 Channel Needed 9.4.23 0 0 0 0 0 1 1 0
eMLPP Priority 9.4.24 0 0 0 0 0 1 1 1 TMSI status 9.4.21 0 0 0 0 1 0 0 0 SGs
cause 9.4.18 0 0 0 0 1 0 0 1 MME name 9.4.13 0 0 0 0 1 0 1 0 EPS location
update type 9.4.2 0 0 0 0 1 0 1 1 _Global CN-Id_ 9.4.4 0 0 0 0 1 1 1 0 Mobile
identity 9.4.14 0 0 0 0 1 1 1 1 Reject cause 9.4.16 0 0 0 1 0 0 0 0 IMSI
detach from EPS service type 9.4.7 0 0 0 1 0 0 0 1 IMSI detach from non-EPS
service type 9.4.8 0 0 0 1 0 1 0 1 IMEISV 9.4.5 0 0 0 1 0 1 1 0 NAS message
container 9.4.15 0 0 0 1 0 1 1 1 MM information 9.4.12 0 0 0 1 1 0 1 1
Erroneous message 9.4.3 0 0 0 1 1 1 0 0 CLI 9.4.1 0 0 0 1 1 1 0 1 LCS client
identity 9.4.9 0 0 0 1 1 1 1 0 LCS indicator 9.4.10 0 0 0 1 1 1 1 1 SS code
9.4.19 0 0 1 0 0 0 0 0 Service indicator 9.4.17 0 0 1 0 0 0 0 1 UE Time Zone
9.4.21b 0 0 1 0 0 0 1 0 Mobile Station Classmark 2 9.4.14a 0 0 1 0 0 0 1 1
Tracking Area Identity 9.4.21a 0 0 1 0 0 1 0 0 E-UTRAN Cell Global Identity
9.4.3a 0 0 1 0 0 1 0 1 UE EMM mode 9.4.21c 0 0 1 0 0 1 1 0 Additional paging
indicators 9.4.25 0 0 1 0 0 1 1 1 TMSI based NRI container 9.4.26
* * *
## 9.3a Length indicator
The length indicator of the information elements consists of one octet and
contains the binary encoding of the number of octets of the value part in the
information elements.
## 9.4 Information elements
### 9.4.1 CLI
This information element is used to represent calling line identification for
the terminating call received in the CS domain. The CLI information element is
coded as shown in figure 9.4.1.1.
+----------+---------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +----------+---------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +----------+---------------------+---+---+---+---+---+---+---+ | Octet 2 | Length indicator | | | | | | | | +----------+---------------------+---+---+---+---+---+---+---+ | Octet 3 | Octets 3 to 14 | | | | | | | | | | contain the value | | | | | | | | | To | part of the Calling | | | | | | | | | | party BCD number | | | | | | | | | Octet 14 | information element | | | | | | | | | | defined in | | | | | | | | | | subclause 10.5.4.9 | | | | | | | | | | of | | | | | | | | | | 3 | | | | | | | | | | GPP TS 24.008 [8] | | | | | | | | | | (octets 3 to 14, | | | | | | | | | | i.e. not including | | | | | | | | | | 3GPP TS 24.008 IEI | | | | | | | | | | and 3GPP TS 24.008 | | | | | | | | | | length indicator) | | | | | | | | +----------+---------------------+---+---+---+---+---+---+---+
Figure 9.4.1.1: Calling Line Identification information element
### 9.4.2 EPS location update type
The purpose of the EPS location update type information element is to indicate
to the VLR whether an IMSI attach or a normal location update has been
performed by the UE. The EPS location update type information element is coded
as shown in figure 9.4.2.1 and table 9.4.2.1.
* * *
            8                                7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 EPS location update type value
* * *
Figure 9.4.2.1: EPS location update type information element
Table 9.4.2.1: EPS location update type information element value part
+----------------------------------------------------------------------+ | EPS location update type value (octet 3) | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Shall not be sent in this version of the protocol. | | If received, shall be treated as \'00000010\' | | | | 0 0 0 0 0 0 0 1 IMSI attach | | | | 0 0 0 0 0 0 1 0 Normal location update | | | | 0 0 0 0 0 0 1 1 | | | | to Shall not be sent in this version of the protocol. If received, | | shall be treated as \'00000010\' | | | | 1 1 1 1 1 1 1 1 | +----------------------------------------------------------------------+
### 9.4.3 Erroneous message
See subclause 18.4.5 in 3GPP TS 29.018 [16].
### 9.4.3a E-UTRAN Cell Global Identity
The E-UTRAN Cell Global Identity information element indicates the UE\'s
current E-UTRAN Cell Global Identity. The E-UTRAN Cell Global Identity
information element is coded as shown in figure 9.4.3a.1.
+---------+---------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 2 | Length indicator | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 3 | The coding of the | | | | | | | | | | E-UTRAN Cell Global | | | | | | | | | - | Identity value is | | | | | | | | | | according to ECGI | | | | | | | | | Octet 9 | field information | | | | | | | | | | element as | | | | | | | | | | specified in | | | | | | | | | | subclause 8.21.5 of | | | | | | | | | | 3GP | | | | | | | | | | P TS 29.274 [17A] | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+
Figure 9.4.3a.1: E-UTRAN Cell Global Identity information element
### 9.4.4 Global CN-Id
See subclause 18.4.27 in 3GPP TS 29.018 [16].
### 9.4.5 IMEISV
See subclause 18.4.9 in 3GPP TS 29.018 [16].
### 9.4.6 IMSI
See subclause 18.4.10 in 3GPP TS 29.018 [16].
### 9.4.7 IMSI detach from EPS service type
The IMSI detach from EPS service type information element indicates from MME
to VLR the particular type of IMSI detach from EPS. The IMSI detach from EPS
service type information element is coded as shown in figure 9.4.7.1 and table
9.4.7.1.
* * *
            8                                         7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 IMSI detach from EPS service type value
* * *
Figure 9.4.7.1: IMSI detach from EPS service type information element
Table 9.4.7.1: IMSI detach from EPS service type information element value
+-------------------------------------------------------------------------+ | IMSI detach from EPS service type value (octet 3) | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Interpreted as reserved in this version of the protocol | | | | 0 0 0 0 0 0 0 1 Network initiated IMSI detach from EPS services | | | | 0 0 0 0 0 0 1 0 UE initiated IMSI detach from EPS services | | | | 0 0 0 0 0 0 1 1 EPS services not allowed | | | | 0 0 0 0 0 1 0 0 | | | | to Interpreted as reserved in this version of the protocol | | | | 1 1 1 1 1 1 1 1 | +-------------------------------------------------------------------------+
### 9.4.8 IMSI detach from non-EPS service type
The IMSI detach from non-EPS service type information element indicates from
MME to VLR the particular type of IMSI detach from non-EPS. The IMSI detach
from non-EPS service type information element is coded as shown in figure
9.4.8.1 and table 9.4.8.1.
* * *
            8                                             7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 IMSI detach from non-EPS service type value
* * *
Figure 9.4.8.1: IMSI detach from non-EPS service type information element
Table 9.4.8.1: IMSI detach from non-EPS service type information element value
+----------------------------------------------------------------------+ | IMSI detach from non-EPS service type value (octet 3) | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Interpreted as reserved in this version of the | | protocol | | | | 0 0 0 0 0 0 0 1 Explicit UE initiated IMSI detach from non-EPS | | services | | | | 0 0 0 0 0 0 1 0 Combined UE initiated IMSI detach from EPS and | | non-EPS services | | | | 0 0 0 0 0 0 1 1 Implicit network initiated IMSI detach from EPS and | | non-EPS services | | | | 0 0 0 0 0 1 0 0 | | | | to Interpreted as reserved in this version of the protocol | | | | 1 1 1 1 1 1 1 1 | +----------------------------------------------------------------------+
### 9.4.9 LCS client identity
The LCS client identity information element is a compound parameter and
comprises information related to the client of a LCS request. The LCS client
identity information element is coded as shown in figure 9.4.9.1.
+---------+---------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 2 | Length indicator | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 3 | The coding of the | | | | | | | | | | LCS client identity | | | | | | | | | to | value is according | | | | | | | | | | to LCS-ClientID as | | | | | | | | | Octet n | specified in | | | | | | | | | | subclause 17.7.13 | | | | | | | | | | of | | | | | | | | | | 3G | | | | | | | | | | PP TS 29.002 [15] | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+
Figure 9.4.9.1: LCS client identity information element
### 9.4.10 LCS indicator
The LCS indicator information element indicates that the origin of the message
is due to a LCS request and the type of this request. The LCS indicator
information element is coded as shown in figure 9.4.10.1 and table 9.4.10.1.
* * *
            8                     7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 LCS indicator value
* * *
Figure 9.4.10.1: LCS indicator information element
Table 9.4.10.1: LCS indicator value
+----------------------------------------------------------------------+ | LCS indicator | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Normal, unspecified in this version of the protocol. | | | | 0 0 0 0 0 0 0 1 MT-LR | | | | 0 0 0 0 0 0 1 0 | | | | to Normal, unspecified in this version of the protocol | | | | 1 1 1 1 1 1 1 1 | +----------------------------------------------------------------------+
### 9.4.11 Location area identifier
This element uniquely identifies one Location Area. The Location area
identifier information element is coded as shown in figure 9.4.11.1.
+---------+---------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 2 | Length Indicator | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 3 | Octets 3 to 7 | | | | | | | | | | contain the value | | | | | | | | | - | part of the | | | | | | | | | | Location area | | | | | | | | | Octer 7 | identification | | | | | | | | | | information element | | | | | | | | | | defined in | | | | | | | | | | 3 | | | | | | | | | | GPP TS 24.008 [8] | | | | | | | | | | (starting with | | | | | | | | | | octet 2, i.e. not | | | | | | | | | | including | | | | | | | | | | 3GPP TS 24.008 IEI) | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+
Figure 9.4.11.1: Location area identifier information element
### 9.4.12 MM information
The MM information information element is a TLV information element that
encapsulates the user information that the MME forwards to the UE. For the
coding see subclause 18.4.16 in 3GPP TS 29.018 [16].
### 9.4.13 MME name
The MME name information element specifies the MME name and is coded as shown
in figure 9.4.13.1. Octets 3 through 57 contain MME node FQDN as specified in
subclause 19.4.2.4 of 3GPP TS 23.003 [3]. The contents of octets 3 through 57
shall be coded as a fully qualified domain name (FQDN) as specified in
subclause 19.4.2.1 of 3GPP TS 23.003 [3]. The value part of the MME name
information element (not including IEI and length indicator) shall have a
length of 55 octets.
+-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | Octet 2 | Length Indicator | | | | | | | | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | Octet 3 | Length field of the 1st label of the MME Name | | | | | | | | | | | | | | | | | | | Octet 4 | Leftmost character of the 1st label of the MME name | | | | | | | | | | | | | | | | | | | Octet 5 | - | | | | | | | | | | | | | | | | | | | Octet m | Length field of the i-th label of the MME Name | | | | | | | | | | | | | | | | | | | Octet m+1 | Leftmost character of the i-th label of the MME name | | | | | | | | | | | | | | | | | | | Octet m+2 | - | | | | | | | | | | | | | | | | | | | - | Rightmost character of the last label of the MME Name | | | | | | | | | | | | | | | | | | | Octet 57 | | | | | | | | | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+
Figure 9.4.13.1: MME name information element
### 9.4.14 Mobile identity
See subclause 18.4.17 in 3GPP TS 29.018 [16].
### 9.4.14a Mobile Station Classmark 2
With the exception of the IEI, the contents are specified in subclause
10.5.1.6 in 3GPP TS 24.008 [8].
### 9.4.15 NAS message container
This information element is used to encapsulate the SMS messages transferred
between the VLR and the MME. The NAS message container information element is
coded as shown in figure 9.4.15.1.
+-----------+---------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +-----------+---------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +-----------+---------------------+---+---+---+---+---+---+---+ | Octet 2 | Length indicator | | | | | | | | +-----------+---------------------+---+---+---+---+---+---+---+ | Octet 3 | Octets 3 to 253 | | | | | | | | | | contain the SMS | | | | | | | | | to | message (i.e. | | | | | | | | | | CPâ€‘DATA, CPâ€‘ACK or | | | | | | | | | Octet 253 | CPâ€‘ERROR) as | | | | | | | | | | defined in | | | | | | | | | | subclause 7.2 of | | | | | | | | | | 3G | | | | | | | | | | PP TS 24.011 [10] | | | | | | | | +-----------+---------------------+---+---+---+---+---+---+---+
Figure 9.4.15.1: NAS message container information element
### 9.4.16 Reject cause
See subclause 18.4.21 in 3GPP TS 29.018 [16].
### 9.4.17 Service indicator
This information element indicates the type of the CS service (e.g. voice
call, Short Message Service). The Service indicator information element is
coded as shown in figure 9.4.17.1 and table 9.4.17.1.
* * *
            8                         7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 Service indicator value
* * *
Figure 9.4.17.1: Service indicator information element
Table 9.4.17.1: Service indicator value
+----------------------------------------------------------------------+ | Service indicator | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Shall not be sent in this version of the protocol. | | If received, shall be treated as \'00000001\' | | | | 0 0 0 0 0 0 0 1 CS call indicator | | | | 0 0 0 0 0 0 1 0 SMS indicator | | | | 0 0 0 0 0 0 1 1 | | | | to Shall not be sent in this version of the protocol. If received, | | shall be treated as \'00000001\' | | | | 1 1 1 1 1 1 1 1 | +----------------------------------------------------------------------+
### 9.4.18 SGs cause
The purpose of the SGs cause information element is to indicate an error to
the receiving entity. This could be a protocol data error, to indicate to the
VLR the reason why a paging procedure could not be performed or to indicate to
the VLR that the mobile terminating CS fallback call has been rejected by the
user. The SGs cause information element is coded as shown in figure 9.4.18.1
and table 9.4.18.1.
* * *
            8                  7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 SGs cause value
* * *
Figure 9.4.18.1: SGs cause information element
Table 9.4.18.1: SGs cause information element value part
+----------------------------------------------------------------------+ | SGs cause value (octet 3) | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Normal, unspecified in this version of the protocol. | | | | 0 0 0 0 0 0 0 1 IMSI detached for EPS services | | | | 0 0 0 0 0 0 1 0 IMSI detached for EPS and non-EPS services | | | | 0 0 0 0 0 0 1 1 IMSI unknown | | | | 0 0 0 0 0 1 0 0 IMSI detached for non-EPS services | | | | 0 0 0 0 0 1 0 1 IMSI implicitly detached for non-EPS services | | | | 0 0 0 0 0 1 1 0 UE unreachable | | | | 0 0 0 0 0 1 1 1 Message not compatible with the protocol state | | | | 0 0 0 0 1 0 0 0 Missing mandatory information element | | | | 0 0 0 0 1 0 0 1 Invalid mandatory information | | | | 0 0 0 0 1 0 1 0 Conditional information element error | | | | 0 0 0 0 1 0 1 1 Semantically incorrect message | | | | 0 0 0 0 1 1 0 0 Message unknown | | | | 0 0 0 0 1 1 0 1 Mobile terminating CS fallback call rejected by the | | user | | | | 0 0 0 0 1 1 1 0 | | | | to Normal, unspecified in this version of the protocol | | | | 1 1 1 1 1 1 1 1 | +----------------------------------------------------------------------+ | NOTE: \"_Normal, unspecified_ \" has the same meaning than in | | 3GPP TS 24.008 [8], informative Annex H (UMTS specific cause | | values for call control). It is used to report a normal event, and | | should not be interpreted as syntactically incorrect nor unknown if | | received. | +----------------------------------------------------------------------+
### 9.4.19 SS code
The SS code information element is used to represent the code identifying a
single supplementary service, a group of supplementary services, or all
supplementary services. The SS code information element is coded as shown in
figure 9.4.19.1.
* * *
            8                                                                                                                   7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 The coding of the SS code value is according to SS-Code as specified
in subclause 17.7.5 of 3GPP TS 29.002 [15]
* * *
Figure 9.4.19.1: SS code information element
### 9.4.20 TMSI
See subclause 18.4.23 in 3GPP TS 29.018 [16].
### 9.4.21 TMSI status
See subclause 18.4.24 in 3GPP TS 29.018 [16].
### 9.4.21a Tracking Area Identity
This element uniquely identifies one Tracking Area. The Tracking Area Identity
information element is coded as shown in figure 9.4.21a.1.
+---------+---------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 2 | Length indicator | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 3 | Octets 3 to 7 | | | | | | | | | | contain the value | | | | | | | | | - | part of the | | | | | | | | | | Tracking Area | | | | | | | | | Octet 7 | Identity | | | | | | | | | | information element | | | | | | | | | | defined in | | | | | | | | | | 3G | | | | | | | | | | PP TS 24.301 [14] | | | | | | | | | | (starting with | | | | | | | | | | octet 2, i.e. not | | | | | | | | | | including | | | | | | | | | | 3GPP TS 24.301 IEI) | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+
Figure 9.4.21a.1: Tracking Area Identity information element
### 9.4.21b UE Time Zone
This element identifies the offset between universal time and local time in
steps of 15 minutes. The UE Time Zone information element is coded as shown in
figure 9.4.21b.1.
* * *
            8                                                                                                                                                                                                         7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 The coding of the UE Time Zone value is according to value part of the
Time Zone information element as specified in subclause 10.5.3.8 of 3GPP TS
24.008 [8] (i.e. not including 3GPP TS 24.008 IEI)
* * *
Figure 9.4.21b.1: UE Time Zone information element
### 9.4.21c UE EMM mode
The UE EMM mode information element is used by MME to indicate to the VLR the
EMM mode of the UE upon reception of the SGsAP-PAGING-REQUEST message. The UE
EMM mode information element is coded as shown in figure 9.4.21c.1 and table
9.4.21c.1.
* * *
            8                   7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 UE EMM mode value
* * *
Figure 9.4.21c.1: UE EMM mode information element
Table 9.4.21c.1: UE EMM mode value
+------------------------------------------------------------+ | UE EMM mode value (octet 3) | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 EMM-IDLE | | | | 0 0 0 0 0 0 0 1 EMM-CONNECTED | | | | 0 0 0 0 0 0 1 0 | | | | to Interpreted as reserved in this version of the protocol | | | | 1 1 1 1 1 1 1 1 | +------------------------------------------------------------+
### 9.4.22 VLR name
The VLR name information element specifies the VLR name and is coded as shown
in figure 9.4.22.1. The contents of octets 3 through n shall be coded as a
fully qualified domain name (FQDN) as specified in 3GPP TS 23.003 [3].
NOTE: In earlier releases of this specification, the coding of VLR Name was
not clear. Implementations based on earlier releases that encode VLR Name as a
string with labels separated by dot can exist.
+-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | Octet 2 | Length Indicator | | | | | | | | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+ | Octet 3 | Length field of the 1st label of the VLR Name | | | | | | | | | | | | | | | | | | | Octet 4 | Leftmost character of the 1st label of the VLR name | | | | | | | | | | | | | | | | | | | Octet 5 | - | | | | | | | | | | | | | | | | | | | Octet m | Length field of the i-th label of the VLR Name | | | | | | | | | | | | | | | | | | | Octet m+1 | Leftmost character of the i-th label of the VLR name | | | | | | | | | | | | | | | | | | | Octet m+2 | - | | | | | | | | | | | | | | | | | | | - | Rightmost character of the last label of the VLR Name | | | | | | | | | | | | | | | | | | | Octet n | | | | | | | | | +-----------+-------------------------------------------------------+---+---+---+---+---+---+---+
Figure 9.4.22.1: VLR name information element
### 9.4.23 Channel needed
See subclause 18.4.2 in 3GPP TS 29.018 [16].
### 9.4.24 eMLPP priority
See subclause 18.4.4 in 3GPP TS 29.018 [16].
### 9.4.25 Additional paging indicators
The Additional paging indicators information element provides additional
information during the paging procedure. The Additional paging indicators
information element is coded as shown in figure 9.4.25.1 and table 9.4.25.1.
The Additional paging indicators is a type 4 information element with a length
of 3 octets.
* * *
            8                  7   6   5   4   3   2   1
Octet 1 IEI  
Octet 2 Length indicator  
Octet 3 0 0 0 0 0 0 0 CSRI Spare
* * *
Figure 9.4.25.1: Additional paging indicators information element
Table 9.4.25.1: Additional paging indicators value
+------------------------------------------------------------------+ | Additional paging indicators value (octet 3, bit 1) | | | | Bits | | | | 1 | | | | 0 CS restoration indicator (CSRI) is not set | | | | 1 CS restoration indicator (CSRI) is set | | | | Bits 8 to 2 of octet 3 are spare and shall be all coded as zero. | +------------------------------------------------------------------+
### 9.4.26 TMSI based NRI container
See subclause 18.4.28 in 3GPP TS 29.018 [16].
### 9.4.27 Selected CS domain operator
The selected CS domain operator information element indicates the CS domain
operator selected by the MME when CS domain is configured for gateway core
network (GWCN), the preferred RAT of the selected PLMN for CS fallback is
GERAN, and the UE does not support GERAN network sharing. The selected CS
domain operator information element is coded as shown in figure 9.4.27.1.
+---------+---------------------+---+---+---+---+---+---+---+ | | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 1 | IEI | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 2 | Length indicator | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+ | Octet 3 | Coded as octets 2 | | | | | | | | | | to 4 of the | | | | | | | | | - | Location Area | | | | | | | | | | Identification IE, | | | | | | | | | Octet 5 | defined in 3GPP TS | | | | | | | | | | 24.008 [8] (not | | | | | | | | | | including 3GPP TS | | | | | | | | | | 24.008 IEI and | | | | | | | | | | LAC). | | | | | | | | +---------+---------------------+---+---+---+---+---+---+---+
Figure 9.4.27.1: Selected CS domain operator information element
# 10 List of system variables
## 10.1 Timers
This subclause lists the management timers specified for the operation of the
SGsAP protocol. All the implementation shall support the range of values
specified in table 10.1.1 or table 10.1.2 as appropriate. The specific value
of the timers is under the control of the operator.
Table 10.1.1: Management timers -- MME side
* * *
Timer name Default value Timer range Granularity Notes Relation to other
timers Ts6-1 - 10 s to 90 s 1 s Guards the Location Update procedure. It is
expected to take a value greater than 2 times the maximum transmission time in
the SGs interface, plus the supervision timer of the Update Location procedure
(as defined in 3GPP TS 29.002 [15]) Ts8 4 s 1s to 30 s 1 s Guards the Explicit
IMSI detach from EPS services procedure. None. Ts9 4 s 1-30 s 1 s Guards the
Explicit IMSI detach from non-EPS services procedure. None. Ts10 4 s 1-30 s 1
s Guards the Implicit IMSI detach from non-EPS services procedure. None.
Ts12-1 - 8 - 60x384+8 s 1 min Controls the resetting of the \'MME-Reset\'
variable. It is expected to take a value greater than the longest periodic
tracking area update timer running on the MME, plus the transmission delay on
the radio interface. Ts12-2 4 s 1-120 s 1 s Guards the MME reset procedure.
There is one Ts12-2 timer per VLR for which the MME has a SGs association.
None. Ts13 4 s 1-30 s 1 s Guards the Implicit IMSI detach from EPS services
procedure. None. NOTE: The Default value is the recommended value.
* * *
Table 10.1.2: Management timers -- VLR side
+----------+----------+----------+----------+----------+----------+ | Timer | Default | Timer | Gra | Notes | Relation | | name | value | range | nularity | | to other | | | | | | | timers | +----------+----------+----------+----------+----------+----------+ | Ts5 | - | 2 s to | 100 ms | Guards | Value is | | | | 20 s | | the | co | | | | | | Paging | rrelated | | | | | | p | to | | | | | | rocedure | paging | | | | | | at the | cycle. | | | | | | VLR. | The | | | | | | | default | | | | | | | is set | | | | | | | a | | | | | | | ccording | | | | | | | to | | | | | | | maximum | | | | | | | paging | | | | | | | cycle | | | | | | | s | | | | | | | upported | | | | | | | by the | | | | | | | MME | | | | | | | ( | | | | | | | operator | | | | | | | choice) | | | | | | | as | | | | | | | defined | | | | | | | in | | | | | | | 3GPP T | | | | | | | S 36.331 | | | | | | | [19]. | +----------+----------+----------+----------+----------+----------+ | Ts6-2 | 40 s | 5 s to | 1 s | Guards | It is | | | | 60 s | | the TMSI | expected | | | | | | real | to take | | | | | | location | a value | | | | | | pr | greater | | | | | | ocedure. | than 2 | | | | | | | times | | | | | | | the | | | | | | | maximum | | | | | | | tran | | | | | | | smission | | | | | | | time in | | | | | | | the SGs | | | | | | | in | | | | | | | terface, | | | | | | | plus 4 | | | | | | | times | | | | | | | T3450 | | | | | | | (as | | | | | | | defined | | | | | | | in | | | | | | | 3GPP T | | | | | | | S 24.301 | | | | | | | [14]) | +----------+----------+----------+----------+----------+----------+ | Ts7 | 4 s | 1 s to | 1 s | Guards | None. | | | | 30 s | | the | | | | | | | Non-EPS | | | | | | | alert | | | | | | | pr | | | | | | | ocedure. | | +----------+----------+----------+----------+----------+----------+ | Ts11 | 4 s | 1-120 s | 1 s | Guards | None. | | | | | | the VLR | | | | | | | reset | | | | | | | pr | | | | | | | ocedure. | | | | | | | There is | | | | | | | one Ts11 | | | | | | | timer | | | | | | | per MME | | | | | | | for | | | | | | | which | | | | | | | the VLR | | | | | | | has a | | | | | | | SGs | | | | | | | asso | | | | | | | ciation. | | +----------+----------+----------+----------+----------+----------+ | Ts15 | - | 1 s to | 1 s | Guards | None. | | | | 20 s | | the MO | | | | | (NOTE 2) | | UE | | | | | | | fallback | | | | | | | p | | | | | | | rocedure | | | | | | | to | | | | | | | UTR | | | | | | | AN/GERAN | | | | | | | when the | | | | | | | network | | | | | | | is | | | | | | | co | | | | | | | nfigured | | | | | | | to | | | | | | | support | | | | | | | the | | | | | | | return | | | | | | | to the | | | | | | | last | | | | | | | used | | | | | | | E-UTRAN | | | | | | | PLMN | | | | | | | after CS | | | | | | | fallback | | +----------+----------+----------+----------+----------+----------+ | NOTE 1: | | | | | | | The | | | | | | | Default | | | | | | | value is | | | | | | | the | | | | | | | rec | | | | | | | ommended | | | | | | | value. | | | | | | | | | | | | | | NOTE 2: | | | | | | | If a too | | | | | | | small | | | | | | | value is | | | | | | | con | | | | | | | figured, | | | | | | | the | | | | | | | timer | | | | | | | can | | | | | | | expire | | | | | | | before a | | | | | | | su | | | | | | | ccessful | | | | | | | fallback | | | | | | | to | | | | | | | UTR | | | | | | | AN/GERAN | | | | | | | occurs. | | | | | | +----------+----------+----------+----------+----------+----------+
## 10.2 Retry counters
This subclause lists the management retry counters specified for the operation
of the SGsAP protocol. The values in table 10.2.1 and table 10.2.2 are
recommended values.
Table 10.2.1: Management retry counters -- VLR side
* * *
Retry counter name Retry value Ns7 2 Ns11 2
* * *
Table 10.2.2: Management retry counters -- MME side
* * *
Retry counter name Retry value Ns8 2 Ns9 2 Ns10 2 Ns12 2
* * *
#