# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document studies the security aspects of System Improvements for
Machine Type Communication. In particular, the goals of this document are:
\- To identify and analyze the threats to the MTC system within the scope of
the service requirements, functionality and use cases as specified in TS
22.368.
\- To identify possible security and privacy impacts induced by the system
architecture improvement for machine type communications based on TR 23.888.
\- To determine possible security requirements based on the analysis above and
describe the possible solutions to meet those requirements.
Machine-type communication aspects of (x)SIMs and/or new models for the
management of (x)SIM are out of scope of the present document.
> Editor Notes: Need to check which specifications are in scope of current
> SIMTC WID and need to update the scope with relevant TS and TR.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
> [2] 3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network
> layer security\".
[3] 3GPP TS 23.060 (v a.2.0): \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[4] 3GPP TS 23.401 (v a.2.1): \"General Packet Radio Service (GPRS)
enhancements for Evolved Universal Terrestrial Radio Access Network (E-UTRAN)
access\".
[5] 3GPP TS 24.368 (v 1.0.1): \"Non-Access Stratum (NAS) configuration
Management Object (MO)\".
[6] 3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework
(AF)\".
[7] Open Mobile Alliance OMA-TS-DM_Protocol V1.3: \" OMA Device Management
Protocol\". http://www.openmobilealliance.org/
[8] Open Mobile Alliance OMA-TS-DM_Security V1.3: \" Device Management
Security \". URL: http://www.openmobilealliance.org/
[9] 3GPP TS 22.368: \"Service requirements for Machine-Type Communications
(MTC); Stage 1\".
[10] 3GPP TR 23.888: \"System improvements for Machine-Type Communications
(MTC)\".
[11] 3GPP TS 43.020: \"Security related network functions\".
[12] 3GPP TS 33.102: \"3G security; Security architecture\".
[13] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security
architecture\".
[14] 3GPP TS 33.234: \"3G security; Wireless Local Area Network (WLAN)
interworking security\".
[15] 3GPP TS 33.402: \"3GPP System Architecture Evolution (SAE); Security
aspects of non-3GPP accesses\".
[16] 3GPP TS 33.203: \"3G security; Access security for IP-based services\".
[17] ETSI TS 102 225: \"Smart Cards; Secured packet structure for UICC based
applications (Release 9)
[18] ETSI TS 102 226: \"Smart cards; Remote APDU structure for UICC based
applications (Release 6)\"
[19] 3GPP TS 31.115: \"Remote APDU Structure for (U)SIM Toolkit
applications\".
[20] 3GPP TS 31.116: \"Remote APDU Structure for (Universal) Subscriber
Identity Module (U)SIM Toolkit applications\".
[21] 3GPP TS 33.220: \"Generic Authentication Architecture (GAA); Generic
Bootstrapping Architecture (GBA)\".
[22] 3GPP TS 33.223: \"Generic Authentication Architecture (GAA); Generic
Bootstrapping Architecture (GBA) Push function\".
[23] 3GPP TS 23.682: "Architecture Enhancements to facilitate communications
with Packet Data Networks and Applications".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**MTC Device:** A MTC Device is a UE equipped for Machine Type Communication,
which communicates through a PLMN with MTC Server(s) and/or other MTC
Device(s) [9].
**MTC UE authentication:** this is authentication of a MTC Device using GSM
AKA, UMTS AKA, EPS AKA, EAP-AKA, or EAP-AKA\' as defined in TSs 43.020 [11],
33.102 [12], 33.401[13], 33.234 [14], or 33.402 [15].
**MTC IMS authentication:** this is authentication of the MTC Device as an IMS
UE by the IMS core as defined in TS 33.203 [16]. The need for such a form of
authentication in the context of MTC is yet to be determined.
**MTC ME authentication:** this is authentication of the platform in the sense
of device authentication as used in TS 33.320. The need for such a form of
authentication in the context of MTC is yet to be determined, and, if needed,
the appropriate mechanism would still have to be selected.
**MTC application authentication:** this is authentication between the MTC
application on the MTC Device and the corresponding application on the MTC
server.
NOTE: MTC application authentication is transparent to the 3GPP network (GSM,
3G, or EPS) and therefore out of scope of 3GPP. However, it is ffs to which
extent key management mechanisms supporting MTC application authentication are
within the scope of 3GPP.
**MTC 3GPP access confidentiality / integrity:** this is the feature provided
by the confidentiality / integrity mechanisms defined for interfaces between
the UE and the 3GPP network in TSs 43.020 [11], 33.102 [12], 33.401 [13],
33.234 [14], or 33.402 [15] including any possible enhancements for MTC
purposes.
**MTC IMS access confidentiality / integrity:** this is the feature provided
by the confidentiality / integrity mechanisms defined for interfaces between
the UE and the IMS core in TS 33.203 [16] including any possible enhancements
for MTC purposes.
**MTC IMS media plane confidentiality / integrity:** this is the feature
provided by the confidentiality / integrity mechanisms in TS 33.328 including
any possible enhancements for MTC purposes.
**MTC application confidentiality / integrity:** this is a feature provided by
confidentiality / integrity mechanisms used at the MTC application layer.
NOTE: MTC application confidentiality / integrity is out of scope of 3GPP.
**MTC Security GW:** Function entity in the operator's security domain,
terminating security association(s) for the external interface link between
the network and the MTC server.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
MTC Machine-Type Communications
# 4 Overview of Security Architecture
_Editor\'s note: This section is intended to provide the high-level SIMTC
security architecture to support the objectives of the WID_
The MTC security architecture described in Figure 1 is based on the system
architecture (Non-Roaming Architecture) given in TR 23.888 [10] and is given
here for helping to analyse the threats in the following clause.
Figure 1: Potential high level security architecture for MTC Architecture for
3GPP Architecture for Machine-Type Communication
Editor's Note: The termination point of security in the terminal side is FFS,
i.e. whether it will be in the UE or in the MTC application.
The following defines one potential high level security architecture for MTC
Non-Roaming Architecture. Three different areas are defined. When analysing
the security aspects of the key issues it should be considered to which
area(s) the key issues is impacting. It should also be noted that the analysed
key issues could be related to more than one area, e.g. A and B.
> Editor\'s note: It is FFS whether single architecture can meet the
> requirements of all key issues.
>
> Editor\'s note: The security architecture needs further refinement.
A) Security for MTC communication between the MTC Device and 3GPP network can
be further divided to:
A1) Security for MTC communication between the MTC Device and RAN.
A2) Security for MTC communication between the MTC Device and NAS.
A3-a) Security for MTC communication between the MTC Device and MTC-IWF (for
3GPP access).
A3-b) Security for MTC communication between the MTC Device and ePDG (for
non-3GPP access).
> Editor's Note: A3-b is currently FFS.
B) Security for MTC communication between the 3GPP network and an entity
outside the 3GPP network can be further divided to:
B1) Security for MTC communication between the MTC server and 3GPP network in
indirect deployment model. This can be further divided into security aspects
when the MTC server is within the 3GPP network and when it is outside the 3GPP
network.
B2) Security for MTC communication between the MTC application and 3GPP
network in direct deployment model.
> Editor's Note: B2 is currently FFS.
The communication between MTC server and MTC application is out of 3GPP scope.
C) Security for MTC communication between the an entity outside the 3GPP
network and MTC Device can be further divided to:.
C1) Security for MTC communication between the MTC server and MTC Device in
indirect deployment model.
C2) Security for MTC communication between the MTC application and MTC Device
in direct deployment model.
> Editor's Note: C2 is currently FFS.
NOTE: The entity MTC server used in the present document corresponds to the
entity Services Capability Server (SCS) used in TS 23.682 [23].
# 5 Description of envisioned security issues for Machine Type Communication
_Editor\'s note: This clause is intended to provide an overview of the
security issues which arise from the use cases and functionalities specified
by TS 22.368 [9] and TR 23.888 [10]. Also this clause is intended for the
derivation of appropriate security requirements and the description of
required solutions regarding the security architecture._
## 5.1 Key Issue 1 - Device triggering
### 5.1.1 Issue Details
_Editor\'s Note: This clause is intended to provide details of the security
issues with the MTC features specified in the SA1/SA2 TS/TR, explanation of
the assumptions and potential impact to the network and devices._
Device triggering issues are defined in TR 23.888 [10], clause 5.8. Several
use cases should be considered in this TR as follows:
\- A MTC Device receives a trigger indication when it is in detached state.
Note: The security of offline Device triggering is deferred to later release
and not considered for Release 11.
\- A MTC Device receives a trigger indication when it is in attached state and
the MTC Device has no PDP context/PDN connection.
\- A MTC Device receives a trigger indication when it is in attached state and
the MTC Device has a PDP context/PDN connection.
Note: The security of Device triggering is covered in key issue-Device
triggering and key issue-external interface security. In Device triggering key
issue, only the security of trigger indication transferred from PLMN to MTC
Device is considered. The security of trigger indication transferred form MTC
server to the PLMN is considered in the key issue-external interface security.
### 5.1.2 Threats
_Editor\'s Note: This clause is intended to capture the relevant threats and
impacts of the issue detailed above._
False network attack: When a MTC Device is in detached state, the attacker can
impersonate a network to send a trigger indication to the MTC Device.
Although there are existing mechanisms in the current network to prevent a MTC
Device to connect to a false network, there is still an issue. MTC Devices are
different from normal UEs such that they may need to operate for a long time
by using a single battery supply without recharging. False network triggering
can awaken a MTC Device and waste its power. So the false network attack is
more serious for MTC Devices compared to non-MTC communications and therefore
we need to improve the network to deal with this security threat.
By means of sending fake triggering messages, an attacker can also obtain
information on whether a particular MTC Device is at that particular location
at that point in time. If the MTC Device can be linked to an individual, this
may have privacy implications.
Tamper attack: The trigger indication may contain the IP@ (or FQDN) and/or TCP
(or UDP) port of the application server that the MTC Device has to contact. If
the IP@ (or FQDN) and/or TCP (or UDP) port of the application server is
tampered by the attacker, the MTC Device may establish the PDN connection to
the wrong MTC server or be rejected by the MTC server. It will cause that MTC
Device is unable to communicate with the correct MTC server and it will also
waste the MTC Device's power consumption.
When the SMS is used to trigger MTC Devices, SMS spam could be exploited by
the attackers to send fake trigger indication. Although the human holding a
normal UE can make his own judgment, the fake trigger indication sent in SMS
spam could be a serious attack on the unattended MTC Devices and will lead to
battery draining (particularly for the devices with limited power supply).
Moreover the fake trigger indication sent in SMS will cause MTC Devices trying
to access the network and lead to the waste of network resources.
User Plane based triggering would be more prone to tampering and fake
triggering attacks if application layer integrity solution is not employed, as
there is no integrity and replay protection provided to the user plane traffic
on the (radio) access link by the core network.
Tracking MTC Devices: The 3GPP network has to keep track of the location of
the MTC Device in order to sent the Device trigger to it. Some types of MTC
Device can be linked to an individual. Contrary to normal UE, MTC Device are
often not under the control of the particular individual (i.e. can not turn it
off). As such, the individual has no control over their privacy with respect
to location information tracking by the network.
### 5.1.3 Security Requirements
_Editor\'s Note: This clause is intended to capture the security requirements
for solving the key issue. The requirements are mapped to the relevant
threats._
It may not be possible to totally prevent an MTC Device from receiving a
trigger indication from a fake network. Therefore it should be studied further
whether the device trigger could be protected so that the impact of fake
device triggers to the battery lifetime and unauthorized tracking of the MTC
Device would be minimized.
The system should provide a mechanism such that only trigger indications
received from authorized network entities(e.g. MTC Server, MTC Application,
entities acting as a SME) will lead to triggering of MTC Devices.
Upon receiving a trigger indication from a source that is not an authorised
network entity, the network should be able to provide the details of the
source (e.g. address) to the MTC User.
The system should provide a mechanism to the MTC User to provide a set of
authorized network entities.
It has to be ensured that an MTC Device responds only to genuine trigger
messages.
The system should ensure that only authentic triggers will be conveyed to the
UEs used for MTC. For 3G/LTE system, trigger indication should be integrity
protected.
The system should also provide a mechanism that doesn\'t require continues
tracking of location information of the MTC Device by the network. This
prevents privacy implications for those MTC Devices that can be linked to an
individual and are not under the direct control of the particular individual.
#### 5.1.3.1 SMS based triggering
When the trigger indication is sent in SMS via MTC~sms~, the SMS-SC/IP-SM-GW)
may verify the source of the triggering SMS targeting on unattended MTC
Devices to ensure the SMS is from an authorized source.
When the trigger indication is received via MTC~sp~ and sent as MT-SMS to SMS-
SC/IP-SM-GW and T4, MTC-IWF should verify the source of trigger request and
ensure the integrity of the received trigger request, if it's sent from
outside the 3GPP network. When SMS-SC/IP-SM-GW receives MT-SMS from MTC-IWF
over T4 interface, it knows the short message is for MTC purpose and can be
trusted.
SMS-SC is required to distinguish ordinary short messages from short messages
for triggering unattended MTC Devices and act accordingly (e.g selectively
block).
> Editor's Note : It is FFS how the SMS-SC/IP-SM-GW can distinguish ordinary
> short messages from short messages for triggering unattended MTC Devices
> received over MTCsms interface.
>
> Editor's Note : other suitable network elements for source authorization
> checking are FFS.
>
> Editor's Note : The system should provide a mechanism to ensure that only
> intended trigger indications will be conveyed to the MTC Devices.
#### 5.1.3.2 NAS Signalling based triggering
When the trigger indication is sent in NAS signalling to SGSN/MME via MTC~sp~
and T5a/T5b, MTC-IWF should verify the source of trigger request and ensure
the integrity of the received trigger request, if it's sent from outside the
3GPP network.
#### 5.1.3.3 User Plane based triggering
The UP based triggering message should be integrity and replay protected. The
UP based triggering message may be confidentiality protected.
## 5.2 Key Issue 2 - Secure Connection
### 5.2.1 Issue Details
\- The MTC Feature Secure Connection is intended for use with MTC Devices that
require a secure connection between the MTC Device and MTC Server.
\- In the context of MTC Feature Secure connection SA1 has stated the
following (S3-100412):
\- _The intention of the MTC Feature Secure Connection is to use the security
features of the UICC to enable an exchange of security keys between the MTC
Device and MTC Server. The actual encryption of data between the MTC Device
and MTC Server would happen at application layer and be out of scope of 3GPP
specifications._
\- In TS 22.368 [9] the requirement on secure connection is stated as follows:
> _The network operator shall be able to efficiently provide network security
> for connection between MTC Server and MTC Devices even when some of the
> devices are roaming i.e. connected via a VPLMN._
>
> Editor\'s Note: It needs to be decided that network efficiency should be a
> general security requirement for all SIMTC issues.
\- The actual usage of the security keys for securing the application level
functionality (including encryption of data as indicated above) between MTC
Device and MTC Server is out of scope of 3GPP specifications.
\- Also other mechanisms can be used to provide security between the MTC
Device and MTC Server but they are regarded to be outside the context of the
MTC Secure Connection feature and therefore out of scope of 3GPP
specifications.
### 5.2.2 Threats
### 5.2.3 Security Requirements
Any 3GPP defined key management mechanisms for secure connection between the
MTC Device and the MTC Server should use UICC.
## 5.3 Key Issue 3 - Reject message without integrity protection
### 5.3.1 Issue Details
In the overload situation, the MM/GMM/EMM reject cause values such as \"IMSI
unknown in HLR\"; \"illegal ME\"; and \"PLMN not allowed\" could be wrongly
sent \"in panic\" by an overloaded (V)PLMN.
It\'s unrealistic for SGSN/MME to get authentication vector from the HSS,
perform a successful AKA with the MTC Device, then perform the security mode
command procedure for integrity protection and encryption. So the MM/GMM/EMM
Reject message will be sent to the MTC Device without with integrity
protection.
### 5.3.2 Threats
If the Reject message is sent without integrity protected, any false base
station can fake the MM/GMM/EMM reject cause values such as \"IMSI unknown in
HLR\", \"illegal ME\", or \"PLMN not allowed\" in the Reject message as a
denial of service attack to the MTC Devices and the network.
### 5.3.3 Security Requirements
A security mechanism is needed to prevent the DoS attack.
## 5.4 Key Issue 4 - Congestion Control
### 5.4.1 Issue Details
In order to combat signalling congestion, network nodes should be able to
reject or prevent attach or connection requests. The challenge is to block the
traffic of the particular UE(s) used for MTC that is causing the congestion,
without restricting non-MTC traffic or traffic from other MTC Devices that are
not causing a problem. SA2 has designed several solutions for it. The aim of
these solutions is when the network finds that the UE used for MTC that will
cause congestion or the UE is a low priority MTC Device, it will reject the
connection request. So the UE can use e.g. a low access priority indicator or
delay tolerant access.
### 5.4.2 Threats
When requesting access to the mobile network, a UE should provide its
currently enabled indicators to the network. There exist security threats if
the indicators are sent without any protection. The attackers can tamper with
the low access priority indicators or delay tolerant access to the normal
state to let many MTC Devices connect when the network setup congestion
control mechanism. The problem is serious since nowadays congestion is the
most urgent issue that operators face. Vice versa, if an attacker adds a fake
low access priority indicator or delay tolerant access in the request sent by
normal UEs, the service of normal UEs (esp. some VIP users) will be
maliciously degraded.
### 5.4.3 Security requirements
The low access priority indicator should be integrity-protected according to
the rules in TS 33.102 [12], TS 33.401 [13], TS 23.060[3] and TS 23.401[4].
## 5.5 Key Issue 5 -- External Interface Security
### 5.5.1 Issue Details
There are two scenarios of MTC Devices communication with MTC server(s)
illustrated in TS 22.368 [9], MTC Server(s) controlled by the network operator
or MTC Server(s) not controlled by the operator. The interface between MTC
Server and CN may be over an insecure link. Communication between the MTC
Server and the CN for common and specific services (such as Device Triggering,
MTC Monitoring) are carried on this insecure link. Attack on the communication
between MTC Server and CN may cause false activities either to the MTC Server,
MTC Device or to the 3GPP network or privacy sensitive information such as
identities may be eavesdropped, which may lead to serious problems.
### 5.5.2 Threats
For example the following threats are identified for external interface
security:
**_For Device Triggering:_**
The network triggers MTC Devices to initiate communication with the MTC Server
based on a trigger indication sent from the MTC Server. This will open a
chance for an attacker, especially when the MTC server is outside the operator
domain.
The attacker can impersonate the MTC server to send a false trigger indication
to the network, and then the network is utilized by the attacker to trigger
the corresponding UE(s) used for MTC. This will cause false decision on the
MTC Device which may lead to the waste of the MTC Device's power consumption
and even a DOS attack to the network, as a large number of MTC Devices are
triggered and required authentication at the same time. Thus the attackers can
manipulate this to achieve their attack target.
An authorized MTC server may not have full control over a MTC Device and thus
certain triggers from such MTC server to the MTC Device might not be allowed.
If such MTC server inadvertently triggers the MTC Device with incorrect
trigger then it can cause crucial damage to MTC Device, for example MTC Device
triggered for software update by a MTC server which is not authorized to do
so.
The attacker can eavesdrop privacy sensitive information such as MTC Device
identities on the external interface.
**_For MTC Monitoring:_**
Note: The security of Monitoring is deferred to later release and not
considered for Release 11.
In clause 7.2.8 of TR 22.368 [9] four monitoring events are defined:
Behavior which is not aligned with activated MTC Feature(s)
Change in the point of attachment
Change of the association between the UE and the UICC
Loss of connectivity
Upon the detection of the above events, the network provides a warning
notification to the MTC Server. Then the MTC User will execute the appropriate
measure according to the detected event. If an attacker impersonates a network
to send a fake monitoring warning notification to the MTC Server, the MTC
Server can reject to provide service to the MTC Device or it will cause wrong
decision such as initiating false triggering procedure.
**_Analysis of device identity privacy issues_**
The attacker can eavesdrop privacy sensitive information such as MTC Device
identities on the external interface.
SA2 is discussing what device identifier that should be used between a MTC
Service Provider and the network, see e.g. SA2 TR 23.888 V1.1.0 clause 6.38
(or the original agreed pCR in S2-111220) [10], where two types of
identifiers, IMSI and a ISSI, are considered. Using these identifiers between
an external MTC Service Provider may introduce privacy issues.
Using IMSI for network external identification purposes should, as is noted in
S2-111220, of course as usual be avoided. Far reaching measures has for
example been taken to avoid exposing the IMSI over radio interfaces by
introducing temporary identifiers (TMSI, P-TMSI, S-TMSI, GUTI etc.).
The ISSI (International Service provider Subscription Identifier) is
introduced as an alternative having a number of desired features.
One particular security advantage of use of ISSI compared to IMSI is that it
would allow a network to easily check that a MTC Server is authorized to issue
a request towards a particular device as this is clear from the service
provider ID included in the identifier. Using IMSI the network would have to
rely on information about device and Service provider association stored in
the HSS. Note that the need to contact the HSS to get assurance that the
Service provider is authorized for contacting a MTC Device could be used to
implement a DoS attack towards the Network/HSS. A prerequisite is of course
that the network configured for MTC can securely authenticate the MTC server
issuing a request.
Still, intercept of event reports or commands and responses sent over the
external interface may reveal security/privacy sensitive information; it all
depends on the information sent to or from the MTC Device. But sometimes just
understanding that a MTC Device reports something, an event is trapped by the
network or that a device is being triggered may have security/privacy
consequences. However, it is easy to stop such leakage of security/privacy
sensitive information by requiring that the communication between an external
MTC Service Provider and the Network is confidentiality protected. As pointed
out above it also has to be integrity protected so use of TLS or IPSec would
solve this issue.
### 5.5.3 Security requirements
Editor\'s Note: The administrative burden of maintaining such lists for
authorization information within the 3GPP needs further study.
When the MTC Server is located outside the 3GPP operator domain, the following
security requirements apply:
The 3GPP network and the MTC Server should be able to mutually authenticate
each other.
The 3GPP network should be able to determine whether the MTC server is
authorized to send control plane requests.
The 3GPP network should be able to determine that the MTC server is authorized
to send the given trigger to the given MTC Device.
The signalling messages between the3GPP network and the MTC Server should be
integrity protected.
The signalling messages between the3GPP network and the MTC Server should be
confidentiality protected.
The level of security of the protection should not be lower than in the case
when the MTC server is within the operator domain.
Security measures shall be applied to MTC reference points when communication
extends beyond the boundary of the 3GPP system unless physical security is
available.
Ensure the privacy of the 3GPP user, in particular the 3GPP private user
identity (IMSI/IMPI)
The mobile network shall provide security mechanisms that can be used to (cf.
TR 23.888 [10]):
  * ensure that an MTC Server can only communicate with certain MTC Devices;
  * ensure that only authorized PDN entities can communicate with the MTC Devices;
  * ensure that a MTC Device can only communicate with the MTC Server(s) of its subscriber, and that communication with any other entity is not possible.
MTC Security GW could be used between the MTC server and the core network as
the first point of entry into a secure operator network. The MTC Security GW
can be an independent node or colocated with an intermediate node (e.g. MTC
IWF).
> Editor\'s Note: The above requirement needs to be revisited as the level of
> security is not clear enough.
>
> Editor\'s Note: The specific node in the 3GPP network side of the interface
> is FFS.
>
> Eiditor Note: Requirement, "It shall be possible to provide secure and
> encrypted communication between PLMN and MTC Server" is reported in TR
> 23.888. It is FFS to detail this requirement.
## 5.6 Key Issues 6 -- Restricting the USIM to specific MEs/MTC Devices
### 5.6.1 Issues Details
The issue that led to the need to restrict the USIM to specific MTC MEs is
illustrated in a use case "Access control with billing plan" in Annex A of TS
22.368.
**Access Control with billing plan Use Case**
In some configurations, it may be necessary to restrict the access of a UICC
that is dedicated to be used only with machine type modules associated with a
specific billing plan. It should be possible to associate a list of UICC to a
list of terminal identity such as IMEISV so that if the UICC is used in
another terminal type, the access will be refused. See the following
configuration:
{width="4.7027777777777775in" height="3.873611111111111in"}
Figure 2: Access Control with billing plan
The restriction can be enforced by a one USIM to one MTC Device binding or a
one USIM to many MTC Device binding. It is the operator that shall be able to
enforce the restriction.
### 5.6.2 Threats
The following threat has been identified for this key issue:
\- An attacker moves a UICC to a different device in order to use a
subscription to get network access for himself, e.g. the attacker may try to
insert a UICC with low data rate subscription, dedicated to MTC MEs, into a
smartphone in order to download large files.
### 5.6.3 Security Requirements
In clause 7.1.1 of TS 22.368 [9] specifies the requirement to restrict the use
of a USIM to specific MEs/MTC Devices.
## 5.7 Key Issue 7 -- Privacy concern
### 5.7.1 Issue Details
Some types of MTC Devices can be linked to an individual. Contrary to UEs,
these MTC Devices are often not under the direct control of the particular
individual (i.e. can not turn it off) and may be controlled by an other party.
Therefore it is necessary to investigate privacy in the context of Machine
Type Communication.
In 3GPP network layer, there are many types of sensitive information. When we
analyse the privacy threats, it is necessary to distinguish privacy sensitive
information from other sensitive data. In the context of MTC, identity
information and location information can be considered privacy sensitive
information.
Different parties could invade an individual\'s privacy due to excessive
and/or unauthorised monitoring of privacy sensitive information.
### 5.7.2 Threats
Privacy breach due to (unnecessary) collection of location information of an
MTC Device that can be linked to an individual.
Privacy sensitive information sent by a MTC device which is not allowed to do
so.
Privacy sensitive information requested by or sent towards a MTC server which
is not allowed to do so.
### 5.7.3 Security Requirements
  * It should be possible to prevent tracking of location information for some types of MTC Device.
  * Network should be able to verify whether a message contains any privacy sensitive information.
  * Network should be able to perform authorization check of (a) MTC device which is sending privacy sensitive information and (b) of MTC server which is requesting / is receiving the privacy sensitive information.
  * Privacy sensistive information transmitted to MTC server via network should be protected.
> Editor's Note: The last three requirements above are FFS. It needs to be
> clarified why the network should be able to verify if a message contains
> privacy sensitive information, and what an authorization check in network
> helps if a device or MTC server has already sent privacy sensitive
> information.
# 6 General Security Requirement
_Editor\'s note: Contributions to this section should be aligned with
agreements achieved in the security requirements sub-clauses of individual Key
Issues._
Network should be able to perform access control for MTC Device accessing
network, e.g, based on MTC Device feature and/or subscription type.
> Editor\'s Note: The meaning of \"access control\" (only authorization or
> authentication and authorization) need to be clarified.
The system security improvement over 3GPP network security should consider
lower power consumption for MTC Devices.
> Editor\'s Note: Further re-wording of the above requirement need to be
> considered
# 7 Solution Description
_Editor\'s Note: This section is intended to describe solutions which fulfil
the security requirements listed for each key issues. This section should
describe the different solution alternatives in more detail for the key
security issues. For technical measures this would include functional entities
and information flow._
## 7.1 Solution 1 - Triggering
### 7.1.1 General Description
_Editor\'s Note: This section is intended to describe solutions which fulfil
the security requirements for the key issue._
The 3GPP network should keep a list of MTC servers authorized to send trigger
to a given MTC Device and the type of trigger the MTC server is authorized to
send. The list should contain identity of the MTC Device, MTC server identity
and the related allowed triggering. This way, for each trigger, the 3GPP
network can verify if the MTC server is allowed to send trigger and whether
the trigger is authorized. Clause 5.1.3 describes how authorization is
performed at different interfaces.
Editor\'s note: Mapping of the device to the device classes is FFS.
### 7.1.2 For offline Device Triggering:
Note: The security of offline Device triggering is deferred to later release
and not considered for Release 11.
**Solution 1** , If the MTC Device is in detached state, the MTC Device should
be able to validate the network identity when it receives a trigger
indication.
The MTC Device should store a temporary identifier of the network it has last
attached. The identifier is known to the network side. The network sends the
identifier it knows as part of the trigger indication to the MTC Device. When
the MTC Device receives a trigger indication, it should compare the network
identity from the received indication and the identity it has stored.
If the two network identities match, the MTC Device accepts the trigger
indication. Otherwise, the trigger indication is abandoned. When the MTC
Device has been successfully triggered, the temporary identifier should be
discarded and replaced by a new temporary network identifier which is also
known to the network.
> Editor\'s note: How to securely bind the temporary identity to the trigger
> message is FFS.
>
> Editor's note: There is no valid temporary identifier in the initial state,
> i.e. when the MTC Device first time attach to the network, this situation
> needs to be considered.
**Solution 2** , If the MTC Device is in detached state, the network should
protect the trigger indication message by using the last security context
stored in the network and the MTC Device.
The MTC Device should store the last security context shared with the attached
network. The trigger indication should be protected, at least for integrity
(and may be for confidentiality too), by the last shared security context.
Only a network that has a valid stored shared security context could generate
a valid trigger indication message, and only the MTC Device which has stored a
valid security context would be able to validate (i.e., verify integrity
and/or decrypt) the trigger indication from the trigger indication message
protected by the same security context. If validation of the trigger
indication is successful, the network is considered valid by the MTC Device,
and would accept the indication. Otherwise, the network is considered invalid,
and the trigger indication is abandoned. After the MTC Device has been
successfully triggered, a new security context is established and stored at
both the MTC Device and the network, to be used to protect (on the network
side) and validate (on the device side) a new trigger indication the next
time.
> Editor\'s Note: There may be multiple solutions. It is FFS if a new security
> context is needed.
#### 7.1.2.1 Impacts on existing nodes or functionality
For solution 1, a MTC Device/UE should store the last attached network
identity. When it receives a triggering indication, it should compare the
network identity from the present indication and the stored identity.
For solution 2, a MTC Device/UE and network entities should store the last
security context used when the MTC Device/UE was attached in the network.
### 7.1.3 For online Device Triggering
For the concluded solutions (solutions in TR23.888 v1.6.0 section 7.2.2 and
solutions in TS 23.682 v0.1.0 annex A)), the current UMTS and LTE access
security mechanisms (after the security mechanism is activated) can be used to
protect the trigger indication on the radio access interface. The current
mechanisms do not ensure that the trigger came from an authorized source.
But in GSM/GPRS network or for user plane based trigger, the trigger
indication can only be confidentiality protected using the current security
mechanism on the radio access interface.
For UP based triggering, the trigger can only be confidentiality protected
using the current access security mechanism on the radio access interface.
In GSM/GPRS network, the trigger can only be confidentiality protected using
the current security mechanism on the radio access interface.
In case of GSM/GPRS network or UMTS network using SIM authentication, there is
no protection against false triggering on the radio access network.
> Editor\'s Note: For any new SA2 solution on device triggering, SA3 need to
> do security analysis.
**Solution 1: Triggering via NAS signalling**
The main Device triggering mechanisms currently being considered in SA2 TR
23.888 [10] are triggering via NAS signalling (e.g. a new information element
in an existing NAS message or a new NAS message) and triggering via SMS. The
SMS trigger may possibly also be sent from the network to the MTC Device using
NAS as a transport. In this case, current NAS security mechanisms can be used
to solve the security issue. After NAS SMC, NAS security is activated. All NAS
signaling messages should be integrity-protected according to TS 33.401 [13],
and therefore current LTE security mechanisms ensure that the trigger
indication is not tampered with. In this case the SMS trigger will also
benefit from the integrity protection of NAS signalling in LTE.
Source verification needs to be considered which in this context is understood
to mean that the MTC Device can verify that the source of the trigger is a
valid MTC server. This could be achieved in the following way
MTC Device trusts the 3GPP network sending the NAS integrity protected
trigger. In this case the MTC Device could be configured with identities of
trusted 3GPP networks. (Somewhat analogically as trusted non3GPP access
networks can be configured in the UE in TS 33.402.) In this context trusted
3GPP network would mean networks which have a secured interface from the MTC
server to the 3GPP network, and which are trusted to ensure that only trigger
indications received from authorized MTC Servers will lead to triggering of
MTC Devices "belonging" to that MTC server.
When the MTC Device then receives a NAS integrity protected trigger, it can,
after verifying NAS integrity protection, check whether the 3GPP network is
trusted in the sense as described above. If it is, the trigger can be
accepted. If there is no NAS integrity protection of the trigger or if the
3GPP network is not trusted, the MTC Device could discard the trigger or
alternatively look deeper into the trigger if end-to-end protection was
applied.
> Editor\'s Note: It is FFS how the network elements can distinguish ordinary
> short messages from short messages for triggering unattended MTC Devices
>
> Editor\'s Note: The applicability of this solution in roaming cases is FFS.
>
> Editor\'s Note: It is FFS if both of the following cases or only one of them
> are possible, i.e. that the device trusts the home network always to have
> the external interface in place or whether the device cannot always trust
> the home network to have the external interface in place.
>
> Editor\'s Note: The above solution is intended for LTE, it is FFS how to
> protect trigger indication in GSM/UMTS.
>
> Editor\'s note: The benefits of the proposed solution should be weighed
> against the cost of increased battery consumption.
An alternative approach is that the MTC server could trigger the MTC Device
through a GBA-push process via NAS signalling.
**Solution 2: Solution for fake SMS triggering from normal UE in the same
network as MTC device**
The fake triggering SMS can be blocked on the network side. As instructed in
the following figure, the SMS-SC can receive short message from MTC Server via
Tsms interface (as shown by the green line) or T4 interface (as shown by the
blue line) or from SMS-IWMSC (as shown by the red line).
This solution is to block any SMS to MTC device that comes from SMS-GMSC
Figure 7.1.1-X Triggering short message delivery
When SMS-SC receives short message from MTC Server via Tsms, the current
external interface security can check whether the MTC Server is authorized to
send the trigger to the MTC device. If it is, the SMS-SC continues to send the
short message. When SMS-SC receives short message which is forwarded by MTC-
IWF via T4 interface, the SMS-SC considered T4 interface is trusted and
continues to send the short message. Because the MTC-IWF can authenticate with
MTC server and ensure that only the authorized MTC Server triggers the MTC
device according functionality of MTC-IWF defined in TR23.888 and external
interface security solution defined in TR33.868. When the SMS-SC receives
short message from SMS-IWMSC, it forwards the short message to SMS-GMSC
following normal SMS procedure but with a check indication. Then SMS-GMSC
forwards the target UE's identifier in the short message to HLR/HSS and
obtains serving MSC/SGSN routing information for the target UE from HLR/HSS.
After HLR/HSS receives the target UE's identifier, it inquries the
corresponding subscription data and checks whether the target UE is MTC device
based on the target UE's identifier and inqury result. If the target UE is MTC
device, HLR/HSS sends inquiry result or reject indication to the SMS-GMSC/IP-
SM-GW and SMS procedure terminates. If the target UE is not MTC device,
HLR/HSS sends inquiry result or confirm indication to the SMS-GMSC/IP-SM-GW
and SMS procedure continues.
> Editor Notes 1: To get clarification from SA2, whether it is possible for
> the HSS to distinguish the target device is a normal UE or MTC devices.
>
> Editor Note 2: It is FFS, whether this solution can be combined with home
> network routing as defined in TR 23.840 so that SMSs from external networks
> towards MTC devices can also be blocked.
**Solution 3: Solutions protecting SMS triggering**
[Network based SMS payload filtering]{.underline}
Protection against SMS spoofing can be provided if the HPLMN implements home
network routing for SMS (TR 23.840) and implements filters in the home network
SMS infrastructure to ensure that MTC trigger SMSs can only be sent from an
authorised whitelist of senders. This approach requires that the SMS
infrastructure can filter based on payload contents for all SMS from untrusted
sources.
[MTC device based SMSC whitelisting]{.underline}
In the absence of SMS home routing, an MTC device could be configured to only
accept MTC triggers from whitelisted HPLMN SMSCs. Assuming SMS filtering at
these whitelisted HPLMN SMSCs then this could protect against the most basic
form of SMS spoofing. Challenges with this solution are how to provision and
maintain the SMSC whitelist on the MTC device and the SMS filtering at the
whitelisted HPLMN SMSCs .
[Source authentication]{.underline}
Even home network routed SMS combined with SMS payload filtering is vulnerable
to attacks where network internal nodes or network signalling links are
compromised. If such attacks need to be mitigated, or if home network routing
is not provided, then some form of cryptographic protection of MTC triggers is
needed between the MTC server and the MTC device. Two possible approaches are
listed below:
  * **(U)SIM application toolkit security** : In this approach the trigger message is protected at the MTC server and sent directly to a (U)SIM application toolkit on the (U)SIM according to TS 23.048. If the message is authenticated by the (U)SIM (based on a pre-shared symmetric key), then the (U)SIM can forward the message to the UE for processing. With this method, MTC devices would need to be pre-provisioned to only act on triggering messages that have been verified by the (U)SIM application toolkit security mechanism.
Editor's Note: It is for further study whether USIM application toolkit
security can be used when the MTC server is outside the operator's domain.
  * **GBA push (either GBA_ME or GBA_U based)** : In this approach GBA_Push, as specified in TS 33.223, is used to secure the trigger message between the MTC server and the MTC device. Compared to the (U)SIM application toolkit approach, a new pre-shared symmetric key is not needed -- instead the MTC device can establish the GBA_Push keys by leveraging the existing AKA credentials that are used for network access security. With this method, MTC devices would need to be pre-provisioned to only act on triggering messages that have been verified using GBA push.
**Solution 4: Triggering via User plane:**
> SA2 is considering solutions related to User plane based trigger delivery
> [TR 23.888 v1.6.0]. In order to prevent sending fake trigger message through
> the radio access link, the trigger message could be protected using the AS
> security mechanisms (User Plane confidentiality protection). UP based
> triggering messages could be confidentiality protected according to TS
> 33.401 [13] for LTE and according to TS 33.102 [12] for 3G, and therefore
> current LTE and 3G security mechanisms can ensure that the trigger
> indication is confidentiality protected.
>
> When the trigger indication is sent in user plane, the MTC Server/ MTC
> application on the MTC user domain should apply end-to-end integrity and
> replay protection and the MTC application on the MTC Device should verify
> the source of the trigger and ensure the integrity of the received trigger
> request. The mechanism to verify the integrity of the trigger message by the
> MTC application is out of scope of this specification.
>
> The MTC device should discard the trigger if it is not end to end integrity
> and replay protected by the MTC server.
#### 7.1.3.1 Impacts on existing nodes or functionality
### 7.1.4 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
The following provides an evaluation of Device Triggering mechanisms on each
interface. It does not take into account possible end to end protection of DT.
**External interface:**
_T4 solution_ : Trigger indication is sent over Tsp from MTC server to MTC-
IWF. Requirements exist in current SA3 TR 33.868 that MTC-IWF should verify
the integrity of the device trigger and that it is sent by an authorized
source. This could be achieved with the help of the MTC-SEG. Checking a
received device trigger that has come over the T4 to SMSC should not be a
problem as MTC-IWF and SMSC are within the same operator.\ \ Additionally, the
MTC server may send a device trigger over Tsms to SMSC. This poses the problem
identified in TR 33.868 "_SMS-SC is required to distinguish ordinary short
messages from short messages for triggering unattended MTC Device/UEs and act
accordingly (e.g selectively block)._ " One possibility to distinguish is to
use a dedicated SMS application port (User Data Header Port, cf. 23.040) for
trigger SMSs. The SMS application port is conveyed all the way to the UE, and
it can be used by the intermediate nodes as well as the MTC device to
distinguish ordinary short messages from short messages for triggering. The
SMSC should then check incoming SMSs and accept device trigger SMSs only from
authorized MTC servers. This approach requires that the SMS infrastructure can
filter based on payload contents for all SMS from untrusted sources. This
could be achieved with the help of the MTC-SEG.
_T5 solution_ : Tsp interface is the same for T4 solution and T5 solution.
Therefore the same considerations apply.
_UP solution:_ Trigger UP message is sent over Gi/SGi from MTC server to
GGSN/PGW. This seems to pose a requirement that the GGSN/PGW would need to
filter out unauthorized triggers. This could be achieved by only allowing
traffic to the UE from an authorized MTC server (which is assumed not to send
false triggers) Alternatively achieving the requirement would require that
trigger UP messages can be distinguished from other user plane data messages
over Gi/SGi, and the GGSN/PGW would need to possibly check all incoming
traffic over Gi/SGi and filter out unauthorized trigger UP messages. The
latter seems a major task to do.
**Interface between home and serving network:**
_T4 solution_ : The trigger SMS is sent from SMSC as follows: to MME via MSC
in LTE, to SGSN in PS UTRAN, to SGSN in GPRS. This also poses the problem that
the serving network node is required to distinguish ordinary short messages
from short messages for triggering unattended MTC Device/UEs and act
accordingly (e.g selectively block). Also here, one possibility to distinguish
is to use a dedicated SMS application port (User Data Header Port, cf. 23.040)
for trigger SMSs. The SMS application port is conveyed all the way to the UE,
and it can be used by the intermediate nodes as well as the MTC device to
distinguish ordinary short messages from short messages for triggering. The
MME/SGSN in the serving network should then check incoming SMSs and accept
device trigger SMSs only from an authorized source (e.g. SMSC) in the HPLMN.
Checking a received device trigger SMSM should not be a problem when MME/SGSN
and SMSC are within the same operator. This approach requires that the SMS
infrastructure can filter based on payload contents for all SMS from untrusted
sources.
It seems additional measures may be needed in case of roaming to do the check.
One possible solution is that trigger SMSs are always sent home routed via a
dedicated SMSC. Then the MME/SGSN node, when it receives a trigger SMS,
contacts the UEs HSS to get information about whether the trigger SMS was sent
by an authorized source in the HPLMN. If the received information from the HSS
matches the source information in the trigger SMS, the trigger SMS is
forwarded to the UE. The requested information could include, e.g. address of
the authorized SMSC, information if there is an outstanding trigger SMS for
the UE, or the even the reference number of the trigger SMS.
_T5 solution_ : SA2 is discussing two options: Device trigger can be sent over
T5 as an SMS or as a generic signaling message. In case of SMS the same
considerations apply as for T4 solution above with the exception that the
source node is MTC-IWF and not SMSC. In case of generic signaling message is
used it seems that "additional" checking is not needed when the trigger
message is sent as a generic signaling message as it can be regarded as a
normal signalling message and existing protection mechanisms for signalling
messages should apply.
_UP solution:_ Trigger UP message is sent from GGSN/PGW to SGSN/SGW. If
filtering was not done at the GGSN/PGW, this would require that trigger UP
messages can be distinguished from other user plane data messages at SGSN/SGW,
and the SGSN/SGW would need to possibly check all incoming traffic and filter
out unauthorized trigger UP messages. This seems a major task to do.
**Radio interface:**
_T4 solution_ : Device trigger is sent as MT SMS. MT SMS in control plane is
integrity protected in LTE and UTRAN but not in GERAN. MT IP-SMS (if
applicable) does not provide integrity protection in any network.
_T5 solution_ : Device trigger is sent as MT SMS or a NAS message (SA2 is
discussing two options). In case MT SMS the same considerations as for T4
solution apply. In case of a NAS transport, NAS message in control plane is
integrity protected in LTE and UTRAN but not in GERAN.
_UP solution_ : Device trigger is sent over user plane. Integrity protection
is not provided for user plane in any RAN.
The evaluation of the solutions is as following:
  * **Triggering via NAS signalling**
> It has 3 benefits to use this solution, first, both NAS signalling messages
> and SMS messages over NAS signalling can be integrity-protected. Secondly,
> core network can verify MTC server and MTC device/UE can verify and trust
> core network after authentication. As a result, the trusted source
> verification can be achieved by the MTC Device/UE based on core network
> verification. Thirdly, it re uses the current existing mechanism to provide
> this protection and does not need to deploy new security elements etc. In a
> word, this solution is simply and secure.
  * **GBA Push based approach**
> For this solutin, the benefit is the mutual authentication between the MTC
> Device/UE and the MTC Server can be achieved. But it has the following
> problem:
  * The specific BSF Server for SIMTC needs to be deployed in the > operator's network. Currently, some operator does not deploy the > BSF Server.
## 7.2 Solution 2 -- Secure Connection
### 7.2.1 General Description
GBA, as specified in TS 33.220 [21], is used to bootstrap authentication and
key agreement for application security based on the 3GPP AKA mechanism. It can
be used to establish the end-to-end security and provide different security
levels based on detailed requirements.
GBA Push, as specified in TS 33.223 [22], can be used for key establishing
between an MTC Device and an MTC server. Under SIMTC scenario, MTC Device acts
as UE which generates a NAF key derived from the bootstrap key Ks, and MTC
server acts as NAF which received the NAF key from the BSF. Then MTC Device
and MTC server can set up secure connection based on this shared NAF key.
### 7.2.2 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
## 7.3 Solution 3 -- Congestion Control
### 7.3.1 General Description
CN mechanism for congestion control:
If the UE has valid security context, then the Attach Request and LAU/RAU/TAU
request should be integrity protected.
However, attach request and TAU request can not be protected, when the MTC
Device does not have a valid security context, e.g. when MTC Device connects
to the network for the first time.
In UMTS case, initial L3 messages could not be integrity protected since they
are sent before security on air interface is activated. Attach Request and
LAU/RAU request could not be integrity protected if they are sent as initial
L3 messages.
In GSM/GPRS case, integrity protection is not provided. Attach Request and
LAU/RAU request could not be integrity protected. In addition, Attach Request
and LAU/RAU request could not be ciphered either if they are sent as initial
L3 messages.
> Editor's note: In case that Attach Request and LAU/RAU/TAU request could not
> be protected by the current mechanism, security solutions for congestion
> control are FFS.
RAN mechanism for congestion control:
In UMTS/LTE case, RRC connection request is sent via SRB0 before security
activated. Neither integrity protection nor ciphering applies for SRB0. In
GSM/GPRS case, integrity protection is not provided. The "delay tolerant
access" in the RRC connection request can not be integrity protected.
Also when the network rejects the RRC connection request (due to overload
condition), the RRC connection reject message which carries extended wait
timer is neither integrity protection nor ciphered.
### 7.3.2 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
## 7.4 Solution 4 -- External Interface Security
### 7.4.1 General Description
External interface is an interface that connects a network entity inside 3GPP
network with another entity outside the 3GPP network. Therefore, the interface
specified in MTC architecture in TS 23.682 [23] and need to be considered here
includes:
  1. Tsp interface between MTC-IWF and SCS.
  2. Gi/SGi interfaces between GGSN/P-GW and AS and between GGSN/P-GW and SCS.
  3. Tsms interface between SMS-SC/GMSC/IWMSC and SME.
NOTE 1: SME covers the SMS functionality of SCS.
#### 7.4.1.1 MTC Server outside the operator domain
When the MTC Server is located outside the operator domain, the interface
between the core network and the MTC Server may be protected using mechanisms
like NDS/IP [2]. As the MTC server is located outside the operator domain it
may not be possible to mandate the use of NDS/IP but the exact protection
mechanism may be based on the agreements between the 3GPP network and MTC
server.
Functional entity MTC Security GW may be used to authentication and
authorization the MTC servers and to secure the external interfaces as shown
in the Figure 3
Figure 3 Security GW exists between the MTC server and the network entity
Thus the MTC Security GW within the MTC-IWF can perform access control
functionality of MTCsp interface to prevent the unauthorized MTC server from
accessing to the core network. It can authenticate with MTC server on behalf
of the 3GPP network. Similarly a separate Security GW may be used between MTC
Server and SMS-SC/IP-SM-GW/GGSN/P-GW to perform access control functionality
of MTCsms and Gi/SGi interface to prevent the unauthorized MTC server from
accessing to the core network.
After successful mutual authentication between the MTC server and the MTC
security GW, the MTC security GW connects the MTC server to the operator's
security domain. Any connection between the MTC server and the core network is
protected through the MTC security GW. End-to-end security protection should
be used for protection between the MTC server and the MTC security GW.
Security protection is required between the MTC security GW and the MTC server
placed outside the Operator's secure domain. Security protection should be
used for any communication between the entities. Communication between the MTC
server and the MTC security GW should be confidentiality, integrity and replay
protected. The NDS/IP security mechanism [2] or proprietary security mechanism
is used for mutual authentication and to protect the communication between the
MTC security GW and the MTC server.
Any unauthenticated traffic from the MTC server should be filtered out at the
MTC security GW.
The MTC Security GW within the MTC-IWF can restrict the trigger request coming
from the unauthorized MTC Servers to prevent the unauthorized MTC servers
triggering the MTC Device based on the association between the MTC server and
MTC Device. When one MTC server needs to communication with a MTC Device, it
sends trigger request information to the MTC Security GW, and the MTC server
identity and MTC Device identity should be included in the request information
or an authenticated identity of its group membership. When the request is
received, the MTC Security GW should verify that if the MTC server is
associated with the MTC Device. If MTC server is associated with the MTC
Device, that means the MTC server required to trigger the MTC Device of its
kind, then triggering indication will be send to the MTC Device. Other wise,
the MTC Security GW should reject the trigger request.
> Editor's Note: It is FFS, how and where the information is store for all the
> association between the MTC server and MTC devices.
#### 7.4.1.2 MTC Server inside the operator domain
When the MTC Server is located inside the operator domain, NDS/IP is mandatory
to implement and optional to use.
### 7.4.2 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
## 7.5 Solution 5 -- Restricting the USIM to specific MEs/MTC Devices
### 7.5.1 General Description
Several mechanisms exist to address this issue.
> Editor's Note: To consider the standard platform security robustness
> requirements for securely storing the private key is FFS
#### 7.5.1.1 User Equipment-based pairings
CT6 discussed and considered three User Equipment-based mechanisms to restrict
the use of UICC to specific MTC MEs, confer CT6 contribution C6-110182:
  * Secure Channel pairing
  * USAT application pairing
  * PIN verification pairing
```{=html}
``` \- **Pairing 1: Secure Channel pairing**
A secure channel pairing is successful when an Application-to-Application
"Secured APDU" secure channel is completed as described in ETSI TS 102 484.
CT6 mechanism proposes the use of pre-shared key (PSK) to establish the secure
channel.
TS 102 484 defines also a key agreement based on certificate exchange to
establish the key material for the Master SA of the Application-to-Application
"Secured APDU" secure channel, the key material results from a certificate-
based TLS handshake. This key agreement based on certificate exchange is used
in Rel-10 Relay Node security to define certificate-based secure channel
between the Relay Node and the UICC, as described in TS 33.401. Consequently,
the use of a key agreement based on certificate exchange, as decribed in ETSI
TS 102 484, is considered in this analysis as a possible solution to restrict
the USIM to specific MEs/MTC Devices. To ease the reading of this analysis,
the Application-to-Application "Secured APDU" secure channel with a pre-shared
key is named PSK-based secure channel, and Application-to-Application "Secured
APDU" secure channel with key agreement based on certificate exchanged is
named certificate-based secure channel.
SA1 allows restricting the use of a USIM to one MTC ME or many MTC MEs.
  * In case of PSK-based secure channel, the same pre-shared key should > be provisioned in the USIM and in one or several authorized MTC > MEs to allow the use of a USIM to one MTC ME or a group of MTC > MEs.
  * In case of certificate-based secure channel, it may be needed to > reinforce the one-to-one or one-to-multiple binding by means of > MTC ME identity check if the root certificate used to verify the > MTC ME certificate is not dedicated to the list of authorized MTC > MEs for this USIM . In this case, the USIM stores in a dedicated > file (EF~IMEISV~) the list of authorized IMEI(SV) values or > IMEI(SV) ranges of values to which the USIM is bound. During > certificate verification the USIM checks that the IMEI(SV) > received in MTC ME certificate matches the value or the range of > values the UICC is configured with. The file of IMEI(SV) value or > range of values to which the USIM is bound is described in CT6 > contribution for USAT application pairing, this file can be > updated by means of Over-The-Air mechanism.
The file EF~pairing~ stores the status of the last pairing check performed by
the UICC. The UICC checks the combination of USIM and MTC ME and sets the
status flag to "OK" in case of successful pairing chek. The UICC also stores
in the file EF~pairing~ the IME(SV) value of the MTC ME. In case of
unsuccessful pairing check, the USIM sets the status flag to "KO" and stores
in the file EF~pairing~ the IME(SV) value of the unauthorized MTC ME.
The status flag of pairing check (with value "OK or "KO") stored in the file
EF~pairing~ can be read by any terminal hosting the UICC. But, the IMEI(SV)
value stored in the file EF~pairing~ is protected by ADM right, only the
operator can retrieve this information. The information stored in the file
EF~pairing~ provide a mechanism to detect change of association between
between a USIM and a MTC ME. The information stored in the file ~EFpairing~
can be read out locally by the maintenance persons.
UICC OTA mechanism (as specified in 3GPP TS 31.115 [19] / TS 31116 [20] and
ETSI TS 102 225 [17] and TS 102 226 [18]) is used to update the file EF
~IMEISV~ stored in the USIM. This mechanism provides dynamic management of the
pairing to change the allowed combinations of USIM and MTC ME(s) by addind or
removing authorized IMEI(SV) values or IMEI(SV) ranges the file EF ~IMEISV~.
The MTC ME stores a certificate where the subject name is the IMEI(SV) value.
This certificate is signed by operator or vendor. To verify the MTC ME
certificate, the UICC stores the associated root certificate corresponding to
the operator or vendor who signed the MTC ME certificates.
The provisioning of certificates and pre-shared key can be performed during
personalization phase of the MTC ME or the UICC. Provisioning during
personalization phase is out of scope.
For UICC into the field it is possible to change the pre-shared key or root
certificates stored in the UISM by means of UICC OTA as specified in 3GPP TS
31.115 [19] / TS 31116 [20] and ETSI TS 102 225 [17] and TS 102 226 [18]. The
USIM could store several root certificatse in the file dedicated to the
storage of root certificates used to verify the combination of USIM and MTC
ME.
For MTC ME into the field it is possible to modify the pre-shared key or
certificate stored in the MTC ME by means of OMA DM.
> Editor's Note: It is FFS Whether certificate is a vendor certificate or
> operator certificate.
  * **Pairing_2: USAT application pairing**
USAT application pairing is successful when the IMEI or IMEISV retrieved from
the terminal matches the value or the range of values the UICC is configured
with. USAT application pairing fails if the terminal does not support USAT
command PROVIDE LOCAL INFORMATION. After a UICC reset, the USIM shall have its
PIN in a blocked state before USIM application selection. The PIN is unblocked
and disabled after a successfull USAT application pairing. An MTC Device
supporting USAT application pairing shall proceed to Profile download as
specified in 31.111 [12]. The USIM shall immediately send a proactive command
PROVIDE LOCAL INFORMATION requesting the MTC Device's IMEI(SV). The MTC Device
shall then send the TERMINAL RESPONSE with its IMEI(SV) before starting USIM
initialisation procedure.
The file [EF]{.underline}~IMEISV~ stores the IMEI(SV) or range of value to
which the USIM is bound.
The file EF~pairing~ stores the status of the last pairing check performed by
the UICC. The UICC checks the combination of USIM and MTC ME and sets the
status flag to "OK" in case of successful pairing chek. The UICC also stores
in the file EF~pairing~ the IME(SV) value of the MTC ME. In case of
unsuccessful pairing check, the USIM sets the status flag to "KO" and stores
in the file EF~pairing~ the IME(SV) value of the unauthorized MTC ME.
The status flag of pairing check (with value "OK or "KO") stored in the file
EF~pairing~ can be read by any terminal hosting the UICC. But, the IMEI(SV)
value stored in the file EF~pairing~ is protected by ADM right, only the
operator can retrieve this information. The information stored in the file
EF~pairing~ provide a mechanism to detect change of association between
between a USIM and a MTC ME. The information stored in the file ~EFpairing~
can be read out locally by the maintenance persons.
UICC OTA mechanism (as specified in 3GPP TS 31.115 [19] / TS 31116 [20] and
ETSI TS 102 225 [17] and TS 102 226 [18]) is used to update the file EF
~IMEISV~ stored in the USIM. This mechanism provides dynamic management of the
pairing to change the allowed combinations of USIM and MTC ME(s) by addind or
removing authorized IMEI(SV) values or IMEI(SV) ranges the file EF ~IMEISV~.
  * **Pairing_3: PIN presentation pairing**
By having the PIN enabled and the MTC Device provisioned with the PIN value,
it is possible to restrict the usage of the USIM to this MTC Device and
therefore prevent unauthorized use of the USIM in another equipment. This
mechanism can be used in conjunction with the USAT application pairing as an
additional measure.
The file EF~pairing~ stores the status of the last pairing check performed by
the UICC. The UICC checks the combination of USIM and MTC ME and sets the
status flag to "OK" in case of successful pairing chek. In case of
unsuccessful pairing check, the USIM sets the status flag to "KO".
The status flag of pairing check (with value "OK or "KO") stored in the file
EF~pairing~ can be read by any terminal hosting the UICC. The information
stored in the file EF~pairing~ provide a mechanism to detect change of
association between between a USIM and a MTC ME. The information stored in the
file ~EFpairing~ can be read out locally by the maintenance persons.
The PIN value in the USIM could be change by UICC OTA mechanism. All specific
MTC MEs authorized to be used with this USIM should be updated with the new
PIN value, e.g. by means of OMA DM.
#### 7.5.1.2 Network based pairings
##### 7.5.1.2.1 IMSI-IMEI binding in HSS
###### 7.5.1.2.1.1 General
In order to secure that only authorized combinations of USIMs and MEs are
used, the HSS holds a list of authorized combinations of IMEI(SV)s per IMSI.
If an authorized IMSI/IMEI combination is detected by the HSS, the HSS shall
accept the registration from the UE. If an unauthorized IMSI/IMEI combination
is detected by the HSS, the operator should be notified and should then be
able to take any further appropriate action, e.g. automatically denying access
to the network by rejecting the Location Update procedure.
###### 7.5.1.2.1.2 Procedure
Figure 7.5.1.2.1.2-1 shows how the HSS can check if the IMSI/IMEI pair is
authorised.
In GERAN/UTRAN, the ADD (Automatic Device Detection) feature is optional to
support in SGSN/MSC. If this feature is supported and enabled in the SGSN/MSC,
the SGSN/MSC shall request the IMEI(SV) from the UE and provide the IMSI-
IMEI(SV) pair to the HSS when the SGSN/MSC has detected that the IMEI(SV) has
changed in the SGSN/MSC or the IMEI(SV) is new for the IMSI.
In LTE, the ADD feature is mandatory to support in the MME. When this feature
is enabled in the MME, the MME shall request the IMEI(SV) from the UE and
provide the IMSI-IMEI(SV) pair to the HSS when the MME has detected that the
IMEI(SV) has changed in the MME or the IMEI(SV) is new for the IMSI.
This solution requires the ADD feature to be supported and enabled in
SGSN/MME/MSC. Additionally the HSS/HLR needs to verify if an IMSI/IMEI pair is
allowed.
Using ADD for requesting IMEI(SV) from the UE is commonly used in networks
today to detect when a user has purchased a new UE so that e.g. appropriate
MMS and internet access settings can be sent to user's new UE.
Using this legacy feature also enables the HSS/HLR in the home network to
check if the IMSI-IMEI(SV) pair received from the SGSN/MME/MSC is authorized.
If there is a need to change authorized combinations of IMSI/IMEI (e.g. due to
billing plan change), only the HSS/HLR needs to be updated, There is no need
to update other entities.
It should be noted that the list of authorized IMEI(SV)/IMSI pairs can be
stored and the checking can also be performed in another node than HSS/HLR,
e.g. a server connected to the HSS/HLR, It is however believed that HSS/HLR is
the natural place to do the checking.
**Figure 7.5.1.2.1.2-1: Solution for IMSI/IMEI in HSS**
The following is a description of the steps in figure 7.5.1.2.1.2-1.
Step 1: The authorized IMEI(SV) lists per IMSI are pre-configured in the
HSS/HLR
Step 2: ADD function is supported and enabled in MME/SGSN/MSC.
Step 3: This is the normal Attach procedure as described in TS 24.008 and TS
24.301.
Step 4: This is the normal UMTS/EPS AKA procedure as described in TS 24.008
and TS 24.301.
> In PS GERAN/PS UTRAN only: the IMEI request from the network can take place
> in this procedure.
>
> In PS UTRAN, the security may not be enabled when AKA procedure is
> initiated, and the network can also request the IMEI from the UE after
> integrity protection and encryption has been enabled e.g. in step 6.
>
> In PS GERAN, integrity protection is not supported, and encryption may not
> be enabled when AKA procedure is initiated. The network can request the IMEI
> from the UE after encryption is enabled e.g. in step 6.
Step 5: In LTE only: This is the normal NAS Security Mode Command procedure as
described in TS 24.301. The IMEI request/response can take place in this
procedure in an integrity protected way.
Step 6: In GERAN/UTRAN/LTE: This is the normal Identification procedure where
the IMEI request/response can take place as described in TS 24.008 and TS
24.301.
> In LTE: according to TS 33.401 the UE shall provide its IMEI(SV) to the
> network if the network asks for it in an integrity protected request.
> According TS 33.401 the IMEI(SV) should be encrypted.
>
> In UTRAN: The network can request the IMEI(SV) from the UE in this procedure
> once the integrity protection and encryption is enabled.
>
> In GERAN integrity protection is not supported. The GERAN network can
> request the IMEI(SV) from the UE in this procedure once the encryption is
> enabled.
Step 7. This is the normal Update Location procedure as described in TS
23.012. The SGSN/MME/MSC includes the IMEI(SV) and IMSI in the Update Location
message to the HSS/HLR.
Step 8: The HSS/HLR checks whether the IMSI/IMEI(SV) pair is authorized
according to the preconfigured lists. If the pair is not authorized in the
HSS/HLR, the network operator is notified and may then take any appropriate
action, e.g. the HSS/HLR may reject the Location Update procedure.
#### 7.5.1.3 Network based method : Enhanced AKA authentication
##### 7.5.1.3.1 General
Two network based solution variants for restricting the USIM to certain
MEs/MTC devices are provided. The variants are similar and only differ in how
the network decides that the key used to authenticate the device is the
correct one. Both solutions are based on enhancing the AKA procedure that runs
between the MTC Device and core network (see subclause 7.5.1.3.2) and use the
same basic flows for initial attach and re-authentication (see subclause 7.5.
1.3.3). Both solution variants also rely on the HSS/HLR checking that an
IMSI/IMEI pair is authorised to attach to the network. The difference between
the two solution variants are provided in subclause 7.5.1.3.4).
##### 7.5.1.3.2 Enhanced AKA authentication
The existing AKA authentication procedure is enhanced to also perform device
authentication that works in conjunction with the standard AKA authentication.
Providing device authentication requires that the device has been provisioned
with a _device_root_key_ that can be used to send encrypted traffic to the
device and that is uniquely associated to the IMEI of the device. The
_device_root_key_ is a public key of the device. A secure part of the device
stores the sensitive device keys such as the private key and performs all
cryptographic operations that make use of these sensitive keys.
The device authentication can be run either in parallel with the AKA
procedures by adding new IEs to the AKA messages or can run separately by
enhancing other NAS or in a new message (which is preferred is a stage 3
decision). The latter case allows the IMEI to be sent only after the security
has been established and helps preserve the privacy of the IMEI.
Whenever a Core Network Node (CNN), e.g. SGSN in UTRAN/GERAN or MME in
E-UTRAN, wishes to perform device authentication, it creates a
_device_challenge_ and sends it to the device in a relevant NAS message. The
device computes the _device_response_ and returns it to the network in a
response NAS message. This allows the CNN to authenticate the device.
In addition, a root key, K~Device~, for a particular access, e.g. a key that
takes on the role of CK and IK in UTRAN or K~ASME~ in E-UTRAN, can be
calculated from the device authentication. The calculation of K~Device~
includes using K~Root~, the root key calculated from the concurrent AKA run or
previous AKA run, if there is one, and hence K~Device~ is derived based on
keys resulting from both the normal AKA run and the device authentication.
The calculation of _device_challenge_ , _device_response_ and _K~Device~_ are
as follows:
> _device_challenge_ = _E~device_root_key~ (device_temp_key)_ ,
> _network_nonce_
where _E~K~(data)_ means _data_ encrypted with key _K_ , and _network_nonce_
is a 128-bit random number chosen by the network. The _device_temp_key_ is a
256-bit random number chosen by the network.
Both the MTC Device and CNN keep _device_temp_key_ while it has the security
context that has a _K~Device~_ that was derived from it. This means that
_E~device_root_key~ (device_temp_key)_ is optional to send in the case that
the CNN knows the current security context being used by the MTC Device has a
_K~Device~_ as root key and hence the MTC Device has a _device_temp_key_
stored and the CNN is willing to re-use that key.
_device_response_ is calculated as
> _device_response_ = _device_nonce_ , _device_res_
where _device_nonce_ is a 128-bit random number (e.g., 128 bits) chosen by the
device; and _device_res_ is a 128-bit number that is calculated as follows:
> _device_res_ = KDF (_device_temp_key_ , _network_nonce_ \|\| _device_nonce_)
where KDF is a suitable pseudo-random function _._
Finally, the calculation of _K~Device~_ is as follows:
> _K~Device~_ = KDF (_device_temp_key_ \|\|_K~Root~_ , _network nonce_ \|\|
> _device_nonce_)
where _K~Root~_ is the key(s) freshly generated from a standard AKA
authentication or the key(s) previously generated before the CNN initiates the
device authentication.
A security context that has been created using enhanced AKA shall be kept in
the ME and not stored on the UICC.
##### 7.5.1.3.3 High-Level flows for the proposed method
###### 7.5.1.3.3.1 General
The following subclauses contain attachment and re-authentication flows for
the method at a high-level. The flows do not illustrate actual message but
rather logical steps (except the device authentication step in each flow). The
flows apply to both the proposed solution variants and are common for the
different access networks (i.e., GERAN, UTRAN and E-UTRAN). The details of
steps 2 and 3 of the attachment flow are provided in subclause 7.5.1.3.4. for
each of the proposed solutions.
###### 7.5.1.3.3.2 Attachment flow
Figure 7.5.1.3.3.2-1 shows how an MTC Device can attach to a network with the
addition of a device authentication step. The flow represents the most general
case of attachment where the network holds no useful information about the UE
from any previous connections.
{width="6.502083333333333in" height="3.390972222222222in"}
**Figure 7.5.1.3.3.2-1: Attachment flow**
The following is a description of the steps in figure 7.5.1.3.3.2-1.
Step 1: This is the normal messages for the access network except that the CNN
informs the HSS/HLR that it is capable of performing device authentication for
the MTC Device and the HSS/HLR informs the CNN that device authentication is
needed.
> Note: The HSS/HLR could hold the latest requested IMEI for each IMSI and
> provide this in Step 1. For second or subsequent attachments of a
> subscription, the HSS/CNN provides the CNN with the IMEI and challenge data.
> This would remove the need for step 3 in these cases. Whether the
> optimisation is necessary is FFS.
Steps 2: This step is solution dependent but only requires a change from
standard behaviour in the case of solution that requires a device certificate
from the MTC Device. It should also be noted that for some access network, the
IMEI request/response may happen in the same messages that are used for step
1.
Step 3: This step is solution variant specific; however in all variants, the
CNN gets the HSS to check the whether the current IMSI/IMEI pair is authorised
to access the network and also fetches any required device authentication data
from the HSS.
Note: For variant 1, steps 3 and 4 can be performed in either order or
simultaneously.
Step 4a: The CNN sends the device challenge to the MTC Device. The _(e)KSI_ ,
the normal key identifier, is sent by the CNN to indicate it wants the MTC
Device to create a security context with _K~Device~_ as its root key. The
_device_challenge_ always contain _network_nonce_ but only contains
_E~device_root_key~ (device_temp_key)_ if the CNN wants to change
_device_temp_key_ as described in subclause 7.5.1.3.2.
Step 4b: As _(e)KSI_ was included in step 4a, the MTC Device establishes a
security context with _K~Device~_ as its root key
Step 4c: The MTC Device responds to the CNN with _device_response_ that
contains both _device_nonce_ and _device_res_ (see subclause 7.5.1.3.2).
Step 4d: The CNN checks _device_res_ is the expected value and establish a new
security context if step 4a included _(e)KSI_.
Step 5: The CNN shall take any new security context into use before any user
plane data is carried over the network. The attach procedure is completed.
###### 7.5.1.3.3.3 Re-authentication flow
Figure 7.5.1.3.3.3-1 shows how to re-authenticate with device authentication.
{width="6.502777777777778in" height="3.279861111111111in"}
**Figure 7.5.1.3.3.3-1: Re-authentication flow**
The following is a description of the steps in figure 7.5.1.3.3.3-1.
Step 1: The CNN retrieves any needed authentication information from the
HSS/HLR, e.g. an AKA authentication vector.
Steps 2a to 2d: The same as steps 4a to 4d in subclause 7.5.1.3.3.2.
Step 3: The CNN shall take the new security context into use before any user
plane data is carried over the network.
###### 7.5.1.3.3.4 Context transfer at handover, idle mobility and attach
Figure 7.5.1.3.3.4-1 shows the changes required to the legacy procedures
between CN that transfer the UE's context at handover, idle mobility and
attach when enhanced AKA is used. The difference is that if the context that
is sent by the old CNN is one for a UE that requires enhanced AKA, then the
old CNN includes some additional fields in the context transfer.
{width="6.502083333333333in" height="2.8965277777777776in"}
**Figure 7.5.1.3.3.4-1: Context transfer between CNNs**
The following is a description of the steps in figure 7.5.1.3.3.4-1.
Step 1: If the context passed in a message to transfer context between CNNs is
for a UE that requires enhanced AKA, then the old CNN passes the new CNN the
following information; an indication that the UE requires enhanced AKA, IMEI
and Device public key. In addition if the old CNN passes a UE security
context, it shall also pass an indication that the security context is a
device based oneand the _device_temp_key._
##### 7.5.1.3.4 Differences between the solution variants
###### 7.5.1.3.4.1 General
The following subclauses describe the different solution and in particular
step 2 and 3 in those different solutions.
###### 7.5.1.3.4.2 Variant 1: HSS/HLR provides the root certificate
In this solution, the HSS/HLR needs to be provisioned (or have access to a
database) with the IMSI/IMEI pairs that are authorised for use and the
associated root certificate that has been used to sign the MTC Device's
certificate. The following describes steps 2 and 3 for this solution.
Step 2: The CNN requests and receives the UE's certificate from the MTC
Device.
Step 3: The CNN sends IMSI and IMEI pair of the MTC Device to the HSS/ HLR and
also requests the root certificate related to that IMEI. Note that the request
for root certificate can be skipped if the CNN has a local copy of the root
certificate associated with the received IMEI. The HSS/HLR checks that
IMSI/IMEI pair is authorised to attach to the network and if so returns
authorisation success and the root certificate to the CNN (if requested by the
CNN). The CNN uses the root certificate to check the UE's certificate is valid
and hence gets the public key of the MTC Device from the UE's certificate and
is able to perform device authentication of the MTC Device.
A particular IMSI/IMEI pair is revoked by removing it from the HSS or
associated database. A particular device is revoked by removing all the
IMSI/IMEI pairs that relate to that device.
###### 7.5.1.3.4.3 Variant 2: HSS/HLR provides the UE's public key
In this solution, the HSS/HLR needs to be provisioned (or have access to a
database) with the IMSI/IMEI pairs that are authorised for use and the public
key of the MTC Device. The following describes steps 2 and 3 for this
solution.
Step 2: There is no change from the current standard behaviour.
Step 3: The CNN sends IMSI and IMEI pair to the HSS/ HLR and also requests the
public key related to that IMEI from the HSS/HLR. The HSS/HLR checks that
IMSI/IMEI pair is authorised and if so returns the public key associated with
the IMEI to the CNN. The CNN uses the received public key to perform device
authentication of the MTC Device.
A particular IMSI/IMEI pair is revoked by removing it from the HSS or
associated database. A particular device is revoked by removing all the
IMSI/IMEI pairs that relate to that device.
### 7.5.2 Evaluation
> Editor's Note: Denial of Service and resource exhaust attacks needs to be
> taken in to account.
#### 7.5.2.1 User Equipment-based pairings
  * **Secure Channel pairing**
```{=html}
``` \- The Secure Channel pairing prevents the connection of not-authorized >
MTC device to the network. When the UICC detects its presence in a > not-
authorized MTC device (not-authorized MTC ME or a non-MTC ME), > the MTC
device stops working. The network operator or MTC > application user has no
information why the MTC device has stopped > working.
  * The exchanges to perform the secure channel pairing are only between > the UICC and the MTC ME. The pairing does not require any > additional signalling on the network.
  * When the USIM detects its presence in not- authorized MTC device, > the network resources are not consumed since the MTC device does > not try to connect to the network.
    * There is no signalling (e.g. for attach procedure, mutual authentication between the MTC device and the network), no authentication vector consumption.
  * To establish the secure channel, a mutual authentication is > performed between the USIM and the MTC ME.
  * After the secure channel establishment, all the data exchanged > between the USIM and the MTC ME are protected.
  * A secure environment is required in the terminal part of the MTC > Device for the secure channel establishment.
  * This solution create extra cost per MTC ME and per UICC and the UICC > should support secure channel or TLS
  * Secure channel pairing is the mechanism already selected and > specified for Rel-10 Relay Node security to guaranty one-to-one > binding between a USIM and a RN.
  * Fulfills the SA1 requirement on restrict the use of a USIM to > specific MEs/MTC Devices and fulfils the requirement that operator > shall be able to enforce the restriction.
    * The UICC is under the control of the operator. The USIM checks if the combination of USIM and MTC ME is authorized and the list of authorized IMEI(SV) values or IMEI(SV) ranges stored on the USIM can be modified by the operator thanks to UICC OTA mechanism. In this way the operator can control the restriction of USIM to specific MTC MEs.
  * Fulfills the SA1 requirement for monitoring that the system shall > provide mechanisms to detect change of the association between the > MTC ME and the UICC.
    * The information stored in the file EF~pairing~ provides a mechanism to detect change of association between a USIM and a MTC ME. The information stored in the file EF~pairing~ can be read out locally by the maintenance persons.
  * In case of operator change, i.e. when a new UICC from a new operator > is inserted to a MTC device on the field, this solution does not > provide a mechanism how to install the new shared secret or > certificate in the MTC device needed for the secure channel.
  * In case the UICC needs to be moved from an MTC device to a new MTC > device which is on the field, the IMEI and shared secret or > certificate need to be updated on the UICC when the UICC is still > hosted by the old MTC device.. If the old MTC device is no longer > allowed to be associated to the UICC, then the old IMEI value > should be removed from the UICCC when the UICC is hosted by the > new MTC device.
  * In case of certificate based secure channel, the certificate in the > MTC device cannot in the general case be operator certificate > since the operator is not always known at manufacturing time of > MTC ME. In this case the UICC needs to be updated with the root > certificate of the ME vendor when the MTC device is taken into > use.
[]{.underline}
  * **USAT application pairing**
```{=html}
``` \- The USAT application pairing prevents the connection of > not-
authorized MTC device to the network. When the UICC detects > its presence in
a not-authorized MTC device (not-authorized MTC ME > or a non-MTC ME), the MTC
device stops working. The network > operator or MTC application user has no
information why the MTC > device has stopped working.
  * The data exchange to perform the USAT application pairing is > performed only between the UICC and the MTC ME. The pairing does > not require any additional signalling on the network.
  * When the USIM detects its presence in not authorized MTC device, the > network resources are not consumed since the MTC device does not > try to connect to the network.
    * There is no signalling (e.g. for attach procedure, mutual authentication between the MTC device and the network), no authentication vector consumption.
  * The security of the pairing depends on how secure the MTC ME is. The > security requirements that it should not be possible to modify the > IMEI already exist today (see [12] and [13]). There is no > mechanism available to verify the integrity of the IMEI whether it > is modified or not by the entity which enforce the paring.
  * There are existing methods today with which the IMEI may be modified > in the storage and also during transmissions.
  * Exchange of IMEI value between the ME and the UICC is not integrity > protected and encrypted.
  * Fulfills the SA1 requirement on restrict the use of a USIM to > specific MEs/MTC Devices and fulfils the requirement that operator > shall be able to enforce the restriction.
    * The UICC is under the control of the operator. The USIM checks if the combination of USIM and MTC ME is authorized and the list of authorized IMEI(SV) values or IMEI(SV) ranges stored on the USIM can be modified by the operator thanks to UICC OTA mechanism. In this way the operator can control the restriction of USIM to specific MTC MEs.
  * Fulfills the SA1 requirement for monitoring that the system shall > provide mechanisms to detect change of the association between the > MTC ME and the UICC.
    * The information stored in the file EF~pairing~ provides a mechanism to detect change of association between between a USIM and a MTC ME. The information stored in the file EF~pairing~ can be read out locally by the maintenance persons.
  * The MTC ME should support the USAT functionality
  * In case the UICC needs to be moved from an MTC device to a new MTC > device which is on the field, the IMEI needs to be updated on the > UICC when the UICC is still hosted by the old MTC device. If the > old MTC device is no longer allowed to be associated to the UICC, > then the old IMEI value should be removed from the UICCC when the > UICC is hosted by the new MTC device.
```{=html}
``` \- **PIN verification pairing**
```{=html}
``` \- The PIN verification pairing prevents the connection of > not-
authorized MTC device to the network. When the UICC detects > its presence in
a not-authorized MTC device (not-authorized MTC ME > or a non-MTC ME), the MTC
device stops working. The network > operator or MTC application user has no
information why the MTC > device has stopped working.
  * The exchanges to perform the PIN verification pairing are only > between the UICC and the MTC ME. The pairing does not require any > additional signalling on the network.
  * When the USIM detects its presence in not authorized MTC device, the > network resources are not consumed since the MTC device does not > try to connect to the network.
    * There is no signalling (e.g. for attach procedure, mutual authentication between the MTC device and the network), no authentication vector consumption.
  * PIN verification pairing could rely on existing PIN verification > command already available on MTC device. But the PIN value should > be stored in the MTC ME.
  * The provisioning of PIN value in the MTC ME for pairing purpose is a > new feature since the existing PIN verification is a user > authentication without storage of PIN value in the ME. A secure > environment is required in MTC ME for the storage of PIN value.
  * The storage of PIN value in the MTC ME for pairing purpose requires > a method to provision or personalize the PIN value in the MTC ME, > which can be realized via off-line provisioning or remotely, e.g. > sending PIN to UICC though OTA and to device via OMA DM..
  * The entropy of the PIN secret is low, thus is subject to brute force > attacks
  * The security of the pairing depends on how secure the MTC ME is.
  * PIN value is sent in clear on the interface between the MTC ME and > the UICC, which makes it possible for an attacker to wire-tap on > the interface and find out the PIN. This risk can partially be > mitigated by the operator, e.g. the operator can change the PIN > frequently.
  * Fulfills the SA1 requirement on restrict the use of a USIM to > specific MEs/MTC Devices and fulfils the requirement that operator > shall be able to enforce the restriction.
    * The UICC is under the control of the operator. The USIM checks if the combination of USIM and MTC ME is authorized and the list of authorized IMEI(SV) values or IMEI(SV) ranges stored on the USIM can be modified by the operator thanks to UICC OTA mechanism. In this way the operator can control the restriction of USIM to specific MTC MEs.
  * Fulfills the SA1 requirement for monitoring that the system shall > provide mechanisms to detect change of the association between the > MTC ME and the UICC.
  * The information stored in the file ~EFpairing~ provides a mechanism > to detect change of association between between a USIM and a MTC > ME. The information stored in the file ~EFpairing~ can be read out > locally by the maintenance persons.
  * In case of UE-based pairings, the network operator is not able to > detect unauthorized combinations of IMSI/IMEI or attempts to use > such combinations.
  * PIN can be changed soon on the spot whenever the UICC is inserted to > other MTC device, which can be used to manage the solution if an > MTC device that holds the PIN for several UICCs is considered > compromised, i.e. the operator believes all the PINs are known to > an attacker. PIN can be changed on the spot, if there is an > interface available in the MTC device for PIN change, otherwise it > is not possible. Also one or more MTC devices to be visited to > change the PIN.
**[Conclusion]{.underline}**
  * Pairing methods using Secure Channel , USAT mechanisms are based on > existing 3GPP and ETSI standards,
  * All UE-based pairing methods prevent MTC UE with not-authorized > binding association from connection to the network and, as > consequence, from consumption of signalling and network resources.
  * Among the User Equipment-based pairings, the Secure Channel pairing > offers the highest level of security and reliability to restrict > the use of a USIM to specific MEs/MTC Devices
  * The PIN verification pairing mechanism can be used to restrict the > USIM to specific MEs/MTC Devices. It has comparatively simple > implementation, and reliability to restrict the use of a USIM to > specific MEs/MTC Devices although there are some risks (e.g. only > the USIM authenticates the MEs/MTC Devices, PIN is low-entropy > secret and sent in the clear), but they can partially be avoided > by the operator.
#### 7.5.2.2 Network based pairings
##### 7.5.2.2.1 IMSI-IMEI binding in HSS
  * Fulfills the SA1 requirement on restrict the use of a USIM to > specific MEs/MTC Devices and fulfils the requirement that operator > shall be able to enforce the restriction.
  * Fulfills the SA1 requirement for monitoring that the system shall > provide mechanisms to detect change of the association between the > MTC ME and the UICC.
  * The network operator is able to directly detect if unauthorized > combination of IMSI/IMEI is taken into use, and may then take any > appropriate action in the network as e.g. trigger an alarm in the > HSS.
  * Signalling procedures for the network request of IMEI or IMEISV from > the MTC Device are already in place in 3GPP specifications for > GERAN, UTRAN and E-UTRAN. But the current HSS/HLR does not support > this new pairing function.This solution requires the ADD > (Automatic Device Detection) feature to be supported and enabled > in the SGSN/MME/MSC. Using ADD for requesting IMEI(SV) from the UE > is commonly used in networks today to detect when a user has > purchased a new UE so that e.g. appropriate MMS and internet > access settings can be sent to user's new UE. Therefore in many > cases the solution does not add signaling load in the network.
  * As ADD is already defined and in use in many networks, the cost and > complexity has been largely covered in those networks. > Additionally the HSS/HLR needs to do IMSI/IMEI pair checking which > is considered to be reasonably low effort and simple task > comparing to what the HSS is already doing at an Attach.
  * For the reasons above, the solution is not regarded to add DoS or > resource exhaustion attack possibilities.
  * The solution requires no new functionality on the UE.
  * The operator can use their current UICCs
  * According to existing security requirements in E-UTRAN (since > Rel-8), the MTC Device shall provide its equipment identifier IMEI > or IMEISV to the network, only if the network asks for it in an > integrity-protected request.
  * According to existing security requirements in E-UTRAN (since > Rel-8), the MTC Device shall integrity protect the IMEI or IMEISV > on the air interface to the network.
  * The security of the IMEI/IMEISV in the MTC ME depends on how secure > the MTC ME is. Already today there exist security requirements > that it should not be possible to modify the IMEI (see [12] and > [13]).
  * This binding mechanism needs to be implemented in the network even > though it is not be used for all MTC devices.
  * All MTC UEs, including the ones with not-authorized binding, need to > be authenticated by the network and consume HSS capacity.
  * This solution enables network operator to remotely detect the > binding.
  * There are some network signalling impacts.
  * If there is a need to change authorized combinations of IMSI/IMEI > (e.g. due to billing plan change), only the information in the > HSS/HLR needs to be updated, There is no need to update any other > entities.
    * Therefore there is neither need for additional signalling nor need for developing solutions for updating the authorized combinations of IMSI/IMEI in network-based pairings.
**[Conclusion:]{.underline}**
  * The network operator is able to detect and reject unauthorized > combinations of IMSI/IMEI in the HSS and take appropriate action > thereby fulfilling the SA1 requirements.
  * The needed functionally for the network to request IMEI or IMEISV > from the MTC UE as part of ADD is already in place in 3GPP > specifications and commonly used in networks. Additionally the > HSS/HLR needs to do IMSI/IMEI pair checking which is considered to > be reasonably low effort and simple task comparing to what the HSS > is already doing at an Attach.
  * Most of the functionalities needed is already available, new > mechanism is needed in HSS for binding method.
  * MTC UEs with not-authorized binding combination equally consume > signalling and network resources.
  * Dynamic management of allowed IMSI/IMEI pairs in concentrated on one > point, the HSS/HLR. If there is a need to change authorized > combinations of IMSI/IMEI (e.g. due to billing plan change), only > information in the HSS/HLR nodes needs to be updated, There is no > need to update any other entities.
  * This does not prevent the usage of IMEI in the tampered UE where the > IMEI can be modified.
##### 7.7.2.2.2 Enhanced AKA
  * The network operator is able to directly detect if unauthorised > combination of IMSI/IMEI is taken into use, and may then take any > appropriate action in the network.
  * If there is a need to change authorised combinations of IMSI/IMEI > (e.g. due to billing plan change), only the authorised > combinations in the HSS/HLR need to be updated,
  * The operator can use their current UICCs
  * Changes to the current signalling that need to be standardised are > required between the core network and MTC devices and between core > network nodes for this solution
  * A secure environment is required in MTC ME for the storage of > certificate/private key.
  * The security of the IMEI/IMEISV in the MTC ME is ensured by > additional authentication executed after AKA authentication that > also provides keys to protect the traffic sent between MTC device > and network.
  * This binding mechanism shall be implemented in the network ~~e~~ven > though it is not be used for all MTC devices.
  * All MTC UEs, including the ones with not-authorized binding, shall > be authenticated by the network and consume HSS capacity.
  * These also enables network operator to detect the binding.
**[Conclusion:]{.underline}**
  * Fulfills the SA1 requirement on restrict the use of a USIM to > specific MEs/MTC Devices and fulfils the requirement that operator > shall be able to enforce the restriction.
  * Fulfills the SA1 requirement for monitoring that the system shall > provide mechanisms to detect change of the association between the > MTC ME and the UICC.
  * The solution only needs to change authorized combinations of > IMSI/IMEI in the HSS/HLR
  * The solution introduces some signalling changes between network > entities and the MTC device for the AKA enhancement that are not > yet standardised.
  * New mechanism is needed in HSS for binding method.
  * MTC UEs with not-authorized binding combination equally consume > signalling and network resources.
  * This method prevents usage of IMEI in the tampered UE where the IMEI > can be modified.
## 7.6 Solution 6 - Privacy Concern
### 7.6.1 General Description
MTC Devices may be detached from the network when not communicating to prevent
unnecessary collection of location information by the network. Hence the MTC
Device will not perform mobility management procedures. Only when the MTC
Device is triggered or when a given requirement is reached and the MTC Device
needs to transmit data to the MTC application, it will reconnect to the
network.
The detach procedure can be either initiated by the MTC device or by the
network. Furthermore, one can distinguish whether the MTC Device or the
network has control over the enforcement of the location privacy mechanism.
The MTC Device may need to provide an ability that allows its user to set the
transmission privacy configuration. The MTC Device may need to provide an
ability to transmit location tracking information in emergency case.
> Editor Note: How to trigger the detached MTC Device is FFS in SA2
#### 7.6.1.1 MTC Device based method
> The MTC Device will detach from the network after a certain period of
> inactivity in communication. The period may be configurable on the MTC
> Device by its user.
>
> Editor Note: Detaching after certain period of time is not sufficed for
> tracking protection
#### 7.6.1.2 Network based method
> Editor Note: Network based method is FFS
### 7.6.2 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
> Editors Note: Additional security for privacy configurability, visibility
> and security for overriding of user-set privacy configuration, for emergency
> transmission is FFS.
# 8 Conclusions
_Editor\'s Note: This section is intended to list conclusions that have been
agreed during the course of the work item activities._
# 9 Impacts to normative specifications
_Editor\'s Note: This section is intended to capture the impacts to normative
specifications within the responsibility of SA3. It can be used as a
placeholder to document agreements until a set of normative CRs can be
generated for the selected solutions(s)._
## 9.1 General
###### ### Annex A (informative): Key Issues - Solutions Mapping
The below table provides mapping of the identified key issue and the candidate
solutions considered in this document and also the corresponding Rel-11
Building Block the key issue belongs to.
+----------------+----------------+----------------+----------------+ | **Feature** | * | **Candidate |** Area**| | | *Corresponding | Solution(s)** | | | | Rel-11 | | **(_cf. | | | Building | | section 4_)** | | | Block** | | | +----------------+----------------+----------------+----------------+ | 1. Device | Reachability | Solution 1 - | A and B | | triggering | Aspects (TS | Triggering | | | | 22.368, 7.1.2) | | | +----------------+----------------+----------------+----------------+ | 2. Secure | Secure | Solution 2 -- | C | | Connection | Connection and | Secure | | | | Privacy (TS | Connection | | | | 22.368, | | | | | 7.2.10). | | | +----------------+----------------+----------------+----------------+ | 3. Reject | Reachability | | A | | message | Aspects (TS | | | | without | 22.368, 7.1.2) | | | | integrity | | | | | protection | | | | +----------------+----------------+----------------+----------------+ | 4. Congestion | Reachability | Solution 3 -- | A | | Control | Aspects (TS | Congestion | | | | 22.368, 7.1.1) | Control | | +----------------+----------------+----------------+----------------+ | 5. External | Reachability | Solution 4 -- | B | | Interface | Aspects (TS | External | | | Security | 22.368, 7.1.1) | Interface | | | | | Security | | +----------------+----------------+----------------+----------------+ | 6. | Reachability | Solution 5 -- | A | | Restricting | Aspects (TS | Restricting | | | the UICC to | 22.368, 7.1.1) | the USIM to | | | specific | | specific | | | ME/MTC Device | | MEs/MTC Device | | +----------------+----------------+----------------+----------------+ | 7. Privacy | Secure | Solution 6 -- | A, B and C | | Concern | Connection and | Privacy | | | | Privacy | Concern | | +----------------+----------------+----------------+----------------+
###### ### Annex B: Rel-11 Non-prioritise Key Issues and Solutions
## B.1 Key Issue 1 - Group Based Optimization
### B.1.1 Issue Details
SA2 has defined the group optimization in the 5.1 of TR 23.888 [10]. MTC
Devices can be grouped together for the control, management or charging
facilities etc. to meet the need of operators. The network resource could be
saved by using group based optimization when the number of MTC Devices is
large. The MTC Devices within the same group can be in the same area and/or
have the same MTC features attributed and/or belong to the same MTC user,
which provides the flexibility to allocate a group. Moreover, each of the MTC
Devices is visible from the network perspective.
Group based optimization may include many optimizations, e.g. group based
charging, group based singling saving and so on. As group based addressing can
significantly reduce the overhead of network resource, it may be required to
protect group messages. The requirements and solutions for group based
protection need to be studied further.
For the MTC Devices in one group, each may need to communicate with the
network individually so an independent session key for each device may be
needed.
> Editor\'s Note: Individual session key establishment per MTC Device in the
> group need to be considered and studied further.
### B.1.2 Threats
An attacker can impersonate a MTC Device belonging to a particular MTC group
to get information. Therefore a mechanism should be provided to prevent such
attacks.
### B.1.3 Security Requirements
A MTC Group is a group of MTC Devices that can be in the same area and/or have
the same MTC Features attributed and/or belong to the same MTC user. MTC Group
should be identified uniquely across 3GPP networks.
> Editor notes: It should be studied further, to what extent group based
> protection and management can be used to save network resource and improve
> efficiency.
There should be a mechanism by which an MTC Device can be verified as a
legitimate member of an MTC Group.
## B.2 Key Issue 2 -Time controlled
### B.2.1 Issue Details
Time controlled is one of the MTC features. The point of this feature aims at
how to restrict MTC Device's access to the network and avoid unnecessary
network load outside these pre-defined time periods. Three terminologies are
used in this feature, i.e. grant time interval, forbidden time interval,
communication window. The home network operator may restrict altering the time
period e.g. to avoid traffic when the MTC server is in maintenance by means of
a \'forbidden time interval\'. Typically, an MTC User agrees with an operator
on a predefined time period for a group of MTC Devices. The time in which
access is permitted is termed a \'grant time interval.\' For many
applications, individual MTC Devices do not need the total duration of this
predefined time period to communicate with the MTC Server. Typically a 5-10
minutes \'communication window\' is sufficient for an individual MTC Device.
### B.2.2 Threats
There are several solutions in TR 23.888 [10] to handle this feature. These
so-called time interval and time window can be defined/randomized by both MTC
Device and MTC server in TR 23.888 [10] solutions. There exist security
threats if the intervals and time window are sent to MTC Device without any
protection. The attackers can change time interval/window to limit or extend
the time. MTC Device will not have enough time to finish the job when time
interval/window is limited. The MTC Device will extend online time to do its
job repeatedly and waste its power and thus it will cause network congestion
when time interval/window is tampered to extend. Moreover, MTC users may be
charged more according to TR 23.888 [10] when MTC Device exchanges signalling
or sends and receives data outside of defined time intervals.
### B.2.3 Security requirements
Time interval and communication window should be integrity-protected when sent
to MTC Device.
> Editor\'s Note: It is ffs if other protection (e.g. confidentiality) is
> required.
## B.3 Key Issue 3 -- Low Mobility
### B.3.1 Issue Details
Low mobility MTC Devices do not move, move infrequently, or move only within a
certain region as defined in TS 22.368 [9] and TR 23.888 [10].
Service requirements of low mobility MTC Devices are described in clause 7.2.1
of TS 22.368 [9] as follows:
\"- The home network operator should be able to change the frequency of
mobility management procedures or simplify mobility management per MTC
Devices.
\- The network operator should be able to define the frequency of location
updates performed by the MTC Device.\"
When the MTC Device moves, there is a solution in TR 23.888 [10] that \"the
SGSN/MME detects the moving and pages within the new area which is reported by
RAN or by the MTC Device explicitly.\"
### B.3.2 Threats
Threat 1: There can be security risks if the incorrect location information is
reported to the network.
## B.4 Solution 1 -- Time Controlled
### B.4.1 General Description
With regard to different scenarios of inform messages in solutions of TR
23.888 [10], current mechanisms can be used to solve the issue:
NAS protection
Time interval and communication window can be sent in the NAS to inform the
MTC Device of the length of interval/window. After NAS SMC, security is setup
for protection. All NAS signalling messages should be integrity-protected
according to TS 33.401 [13], and therefore current LTE mechanisms ensure that
the time interval/window can not be tampered. For GSM and UMTS, SA2 has not
defined any solutions yet. But the time interval/window should be protected in
this case as well.
> Editor\'s Note:It is FFS how to protect time interval/window in GSM/UMTS
> when SA2 figures out GSM/UMTS solutions for time controlled feature.
Application level protection
Another potential solution is that time interval/window is sent by MTC server
via application level data. Current mechanism, e.g. GBA push which is defined
in TS 33.223 [22], can be used to protect the data sent from MTC server. Or
some application security mechanism can also be used. However, these solutions
are out of 3GPP scope.
> Editor\'s Note: It is FFS whether there is any other solution for this
> feature- time controlled.
### B.4.2 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
## B.5 Key Issue 4 -- Security of Small Data Transmission
### B.5.1 Issue Details
The MTC feature Small Data Transmissions requirements are defined in TS 22.368
[9], clause 7.2.5:
\- The system should support transmissions of small amounts of data with
minimal network impact (e.g. signalling overhead, network resources, delay for
reallocation).
\- Before transmission of small amount of data, the MTC Device may be attached
or detached to/from the network.
\- The definition of a small amount of data should be configurable per
subscription or by network operator policy
This document will consider the issue when the MTC Device is detached and no
security context between the MTC Device and the core network is available.
> Editor\'s Note: Further inputs are needed from SA2 on this issue
### B.5.2 Threats
Proposals for "small data transmission" allow M2M devices to arbitrary create
NAS content and traffic. Using NAS for SMS transport was designed as a stop-
gap solution in Rel-8 with the goal of eventual deployment of of IMS-based
SMS. What is being proposed now will standardize overloading of NAS, strictly
control protocol, with what is effectively UP content. Such content will be
generated by potentially hundreds of millions devices, creating an environment
for a DOS attack on MME.
There may be no pre-established NAS security context in transfer data via
optimised SMS solution. Thus the small data transmission can not be protected
by valide security context and can be easily tampered or intercepted by the
attacker. Sometimes small data is sensitive and important because it may be
related to emergency event or commerce.Once it is tampered or intercepted, the
consequence can be serious.
### B.5.3 Security requirements
The small data transmission using small data encapsulation in the NAS payload
have to be protected against overloading attack on MME for EPS.
> Editor's note: How to provide NAS DOS protection for small data transfer is
> FFS. Dedicated MME can be considered as one option.
The small data should be integrity protected (for 3G/LTE system) and may be
confidentiality protected.
> Editor's note: How to provide confidentiality and integrity protection for
> small data transfer should be studied when there is no pre-established
> security context.
## B.6 Key Issue 5 - MTC Monitoring
### B.6.1 Issue Details
As discussed in TR 23.888 (clause 5.10.1) [10], MTC Devices may be deployed in
locations with high risk, e.g. possibility of theft of the communication
module. There are MTC Devices that should not move from an authorized
location, or should only move in an authorized area. For those MTC Devices, it
is desirable that the network detects and reports events (including location)
caused by those devices that may result, for example, from theft of the
communication module. If such an event is detected, the network might be
configured to perform special actions.
### B.6.2 Threats
In the case of an MTC application where the MTC Device should not move from an
authorized location, or should only move in an authorized area (e.g. within a
home), there could be security risks if the device is operated from an
unauthorized location (e.g. as a result of theft of the communication module).
For example, a water metering used in user A\'s home to record user A\'s water
usage should be fixed in user A\'s home. If it is moved to another place like
B\'s home without permission, it could potentially be used to report user B\'s
water usage against user A\'s account. The primary method to mitigate this
attack should be to bind the identity and authentication of the MTC Device to
the specific user\'s water meter. Detecting or preventing a change in location
of the MTC Device could be a useful secondary security mechanism.
Another example is fire monitor in the building. When a fire monitor is moved
to another place, wrong location information will be sent to the fire
monitoring server if there is a fire. In this case detecting change of the
location of the MTC Device would be a useful feature.
For those MTC Devices that can be linked to an individual, MTC Monitoring
could cause an invasion of privacy. In particularly, if MTC Monitoring is
applied to MTC Devices that should not be monitored.
### B.6.3 Security Requirements
It is required for the network to provide a location management mechanism for
MTC Devices that should not move from an authorized location, or should only
move in an authorized area to detect if the device has been moved to an
unauthorized location.
The network should be able to prevent MTC monitoring to be activated for those
devices that should or are not monitored by the network.
## B.7 Key Issues 6 - Security of MTC device Configuration
### B.7.1 Issues Details
Different MTC Devices configuration options were introduced in stage 2 to
avoid/alleviate congestion and overload in the network, in particular to
control the network access from low priority MTC Devices (i.e. delay
tolerant).
There are two potential approaches for delivering the configuration commands
to the MTC Devices.
One approach is using OMA device management (OMA DM) and the other is using
UICC OTA (as specified in ETSI TS 102 225 [17] / TS 102 226 [18] and 3GPP TS
31.115 [19] / TS 31.116 [20]). The OMA DM approach only applies to the
terminal part of the MTC Device (MTC ME). Respectively, UICC OTA is applied to
UICC part of the MTC Device.
### B.7.2 Threats
> Editor\'s note: Further contributions are needed to identify the threats.
Without security protection, the configuration options will face MitM attack
when it\'s provisioned to the MTC Devices.
### B.7.3 Security Requirements
**[OMA DM case]{.underline}**
TS 24.368 (V1.0.1) [5] has defined the Management Object (MO) and possible
leaf objects to represent the MTC Devices configuration options. They should
be stored securely in the MTC Devices. In case of configuration options stored
in the MTC ME:
The DM server should be authenticated by the MTC MEs.
The MTC MEs may be authenticated by the DM server.
OMA DM messages should be integrity-protected.
**[UICC OTA case]{.underline}**
There are different security levels for OTA message protection. In the scope
of the configuration of UICC in MTC Device:
  * The OTA server should be authenticated by the UICC.
  * The UICC may be authenticated by the OTA server.
  * UICC OTA messages should be integrity-protected.
  * UICC OTA messages should be confidentiality -protected.
> Editor\'s note: It is FFS whether secure channel is needed to convey
> configuration info from UICC to the MTC ME.
## B.8 Solution 2 - MTC device Configuration
### B.8.1 General Description
> Editor\'s note: Further contributions are needed.
#### B.8.1.1 ME Configuration
OMA DM security, as specified in [7] and [8], contains a number of options,
where some are not needed for the purposes of this document and others are
required. OMA DM security is therefore profiled in this clause as:
  * The MTC Devices should have a root certificate to authenticate the DM server.
  * The root certificate needs to be provided to the MTC Devices in a secure manner.
  * The root certificate should be securely stored.
> Editor\'s note: It is FFS how to securely store the certificate
  * The DM server and the MTC Devices should support and use TLS according to the profile specified in Annex E of TS 33.310 [6].
To verify the validation of the DM service certificate one can consider either
OCSP or the use of a secure real time clock in the MTC Device for expiry
checking of the DM server certificate. The choice of which one to be used by
the MTC Device may depend on the usage characteristics (e.g. how often
checking occurs). If a secure real time clock in the MTC Device is used, then
the DM server certificate shall have a short validity time in order to be
refreshed in time. If the DM server certificate has expired but has not been
revoked, the OCSP server will not reply with certificate verification failure.
Possible ways to overcome this are that expired DM server certificates are
also revoked or that the MTC Device sends a nonce to the OCSP server who then
replies with correct time and the MTC Device can make the certificate
verification itself.
> Note: For devices identified as requiring additional security, the use of
> secure real time clock may be provided by means of a secured environment
> logically defined within the MTC Device. Such a secured environment should
> protect the real time clock from external attacks and tampering, and may
> additionally be utilized for secure storage of the DM server certificate.
>
> Editor's note: The cost of implementing secure environment should be
> considered
>
> Editor's note: The secure real time clock is FFS.
>
> Editor's Note: it is FFS how short is sufficiently short for the DM
> certificate validity duration.
#### B.8.1.2 UICC Configuration
UICC OTA is specified in ETSI TS 102 225 [17] / TS 102 226 [18] and 3GPP TS
31.115 [19] / TS 31.116 [20].
In the scope of MTC configuration the security requirements are met using SPI
configuration for secured packets transmission, as described in 3GPP TS 31.115
[19] referencing ETSI 102 225 [17], or using PSK-TLS as described in 3GPP TS
31.116 [20] referencing ETSI 102 225 [17] for secured messages based on HTTPS.
### B.8.2 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
## B.9 Solution 3 -- Location Management
### B.9.1 General Description
The requirement mentioned in clause 5.6.3 of this document, can be met as
follows.
MTC Device reports the location identifiers. Network entity (e.g. SGSN/MME)
should store the pre-defined location identifier and be able to verify the
location identifier by comparing these two identifiers.
When the MTC Device moves; a network entity (e.g. MSC/SGSN/MME) receives new
location information which is reported by RAN or by the MTC Device explicitly
and detects if it is different from pre-configured location information. Then
the network entity can confirm that the MTC Device has moved to other area and
will send a warning message to the MTC server, which can then take further
action.
> Editor\'s Note: Multiple solutions are being considered in SA2 about which
> network entity detects and reports unauthorized movements.
>
> Editor\'s Note: Granularity of above mentioned location identifiers and the
> resulting impact on the ability of the solutions to meet the requirements,
> as well as possible other solutions (e.g., solutions relying on network
> reporting) are ffs.
#### B.9.1.1 Impacts on existing nodes or functionality
A network entity should be able to store the pre-configured location
information of MTC Device with low mobility feature.
A network entity should be able to send warning to MTC server that MTC Device
is not in the authorized location/area.
### B.9.2 Evaluation
_Editor\'s note: This section contains evaluation (possibly including cost and
benefit trade-off analysis) of candidate solutions enumerated in the preceding
General Description subsections._
#