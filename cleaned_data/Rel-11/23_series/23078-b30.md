# Foreword
This Technical Specification (TS) has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The present document specifies the stage 2 description for the fourth phase
(see 3GPP TS 22.078 [6]) of the Customized Applications for Mobile network
Enhanced Logic (CAMEL) feature within the 3GPP system.
The contents of present document are subject to continuing work within the TSG
and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will then be re-released by the TSG with
an identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the stage 2 description for the fourth phase
(see 3GPP TS 22.078 [6]) of the Customized Applications for Mobile network
Enhanced Logic (CAMEL) feature which provides the mechanisms to support
services of operators which are not covered by standardized services even when
roaming outside the HPLMN.
The CAMEL feature is a network feature and not a supplementary service. It is
a tool to help the network operator to provide the subscribers with the
operator specific services even when roaming outside the HPLMN.
In the present document, the GSM Service Control Function (gsmSCF) is treated
as being part of the HPLMN. The regulatory environment in some countries may
require the possibility that the gsmSCF and the HPLMN are controlled by
different operators, and the gsmSCF and the HPLMN are therefore distinct
entities.
The fourth phase of the CAMEL feature supports, in addition to the third phase
of the CAMEL:
\- Interactions with Optimal Routing;
\- Call Party Handling;
\- DTMF Mid call procedure for Mobile Originated and Mobile Terminating calls;
\- Inclusion of flexible tone injection;
\- Provision of location information of called subscriber;
\- Provide location information during ongoing call;
\- CAMEL control over MT SMS;
\- Notification of GPRS mobility management to CSE;
\- Inclusion of ODB data in Any Time Modification;
\- Enhancement of Any Time Interrogation and Provide Subscriber Information
for PS Domain;
\- Mobile Number Portability database interrogation;
\- Criteria for the provision of location information during ongoing call;
\- Enhanced Dialled Services;
\- Enhancement to Establish Temporary Connection;
  * CAMEL control of trunk originated calls.
CAMEL applicability to IP-based multimedia services is introduced in the
fourth phase of the CAMEL. It is specified in 3GPP TS 23.278 [29].
CAMEL is not applicable to Emergency Setup (TS 12), i.e. if an Emergency call
is requested, then the gsmSSF shall not be invoked.
The mechanism described in the present document addresses especially the need
for information exchange between the VPLMN or IPLMN and the HPLMN for support
of operator specific services. Any user procedures for the control of operator
specific services are outside the scope of the present document. Subscribers
who have subscribed to operator specific services and therefore need the
functional support of the CAMEL feature shall be marked in the HPLMN and
VPLMN. In case a subscriber is marked to need CAMEL support, the appropriate
procedures which provide the necessary information to the VPLMN or the HPLMN
are invoked. It is possible for the HPLMN to instruct the VPLMN or IPLMN to
interact with a gsmSCF which is controlled by the HPLMN.
The specification of operator specific services is outside the scope of the
present document.
## 1.1 Support of partial implementation of CAMEL phase 4
A functional entity (VMSC, GMSC or SGSN) may support the complete CAMEL phase
4 functionality or, as a network option, it may support the complete CAMEL
phase 3 functionality and a partial implementation of CAMEL phase 4.
If a functional entity supports any part of CAMEL phase 4, then the HLR is
informed of the CAMEL phase 4 CSIs supported. An SGSN may also indicate
support of the Provide Subscriber Information IF. To indicate support of a
specific CSI, a functional entity shall have the ability to trigger on any
initial service event possible for that CSI.
If a VMSC or GMSC supports any of the CAMEL phase 4 circuit switched CSIs
(O‑CSI, D‑CSI, T‑CSI or VT‑CSI), then the gsmSCF is informed of the CAMEL
phase 4 circuit switched functionalities offered. The gsmSCF shall not send
information flows or parameters that conflict with the functionalities offered
by the VMSC or GMSC.
If a CAMEL subscriber attempts to register in a VMSC or SGSN which supports at
least one CAMEL phase 4 CSI or the enhancement of Provide Subscriber
Information IF, then the VMSC or SGSN indicates in the registration request to
the HLR the phase of CAMEL which the VMSC or SGSN supports (at least phase 4).
In addition, the VMSC or SGSN indicates which CAMEL phase 4 CSIs may be
downloaded. An SGSN may also indicate support of the Provide Subscriber
Information IF.
If a GMSC supports at least one CAMEL phase 4 CSI, then the GMSC indicates in
the Send Routeing Info to the HLR the phase of CAMEL which the GMSC supports
(at least phase 4). In addition, the GMSC indicates which CAMEL phase 4 CSIs
may be downloaded.
If a VMSC/gsmSSF or GMSC/gsmSSF initiates contact with the gsmSCF using the
Initial DP IF, or acknowledges a gsmSCF initiated contact using the Initiate
Call Attempt ack IF, then the VMSC/gsmSSF or GMSC/gsmSSF indicates in the IF
the CAMEL phase 4 functionalities offered to the gsmSCF.
If a VLR initiates contact with the gsmSCF using a Mobility Management Event
Notification IF, then the VLR or SGSN indicates in the IF the functionalities
offered to the gsmSCF.
### 1.1.1 CAMEL Phase 4 CSIs
A network entity may indicate to the HLR an offer of support for the following
CAMEL phase 4 CSIs:
\- CAMEL phase 4 O‑CSI;
\- CAMEL phase 4 D‑CSI;
\- CAMEL phase 4 T‑CSI;
\- CAMEL phase 4 VT‑CSI;
\- CAMEL phase 4 MT‑SMS‑CSI;
\- CAMEL phase 4 MG‑CSI;
CAMEL control of trunk originated calls;
  * Reporting of additional dialled digits.
An SGSN may also indicate support of the CAMEL phase 4 Provide Subscriber
Information IF.
A functional entity (VMSC, GMSC or SGSN) may offer the CSIs in any combination
applicable for this entity. A functional entity shall indicate to the HLR all
the CSIs it offers. The HLR may ignore the offer of the supported CSIs if they
are not applicable for the sending entity, but it shall not reject the
operation in this case.
### 1.1.2 CAMEL Phase 4 Functionalities
The CAMEL phase 4 functionalities which may be offered to the gsmSCF are the
following:
\- Creating additional parties in a call, Creating a new call (Initiate Call
Attempt);
\- Placing an individual call party on hold or moving an individual call party
to Call Segment 1, when Call Segment 1 does not exist (Split Leg);
\- Connecting an individual call party to the group (Move Leg);
\- Releasing an individual call party (Disconnect Leg);
\- Indication of the release of a call party or call segment (Entity
Released);
\- Enhancements for subscriber interactions with the gsmSCF (Disconnect
Forward Connection With Argument);
\- Inclusion of flexible tone injection (Play Tone);
\- DTMF Mid call procedure for MO and VT calls (DP O_Mid_Call, DP T_Mid_Call);
\- Provision of Charge Indicator at answer DP (Charge Indicator at DP
O_Answer, DP T_Answer);
\- Support of Alerting DP (DP O_Term_Seized, DP Call_Accepted);
\- Provision of location information of subscriber at alerting DP (Location
information at DP O_Term_Seized, DP Call_Accepted);
\- Provision of location information during an ongoing call (DP
O_Change_Of_Position, DP T_Change_Of_Position);
\- Interactions with Basic Optimal Routeing (Basic OR Interrogation Requested
in Connect and Continue With Argument, Route Not Permitted in DP O_Abandon);
\- Warning tone enhancements (Burstlist for Audible Indicator);
\- Enhancements of Call Forwarding indication (Forwarding Destination Number);
\- Criteria for the provision of location information during ongoing call
(Criteria for DP O_Change_Of_Position and DP T_Change_Of_Position);
\- Subscribed Enhanced Dialled services (see description below);
\- Serving Network Enhanced Dialled Services (see description below);
\- SCUDIF notification during active phase of the call (DP O_Service_Change
and T_Service_Change) ; and
Collection of additional dialled digits (Arming CollectedInfo DP as EDP-R).
For the Subscribed Enhanced Dialled Services and Serving Network Enhanced
Dialled Services, the following information flows apply in addition to the
information flows allowed at TDP Analysed_Information since CAMEL phase 3:
Apply Charging, Call Information Request, Cancel (all requests) and Request
Report BCSM Event together with their acknowledgements and reportings. In
addition, all the other offered CAMEL phase 4 functionalities apply also to
the enhanced dialled services.
A functional entity (VMSC or GMSC) may offer the functionalities in any
combination applicable for this entity and applicable to the offered CSIs.
A functional entity (VMSC or GMSC) shall indicate to the gsmSCF all the
functionallities it offers.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document._
[1] 3GPP TR 21.905: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Vocabulary for 3GPP
Specifications\".
[2] 3GPP TS 22.004: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; General on supplementary \".
[3] 3GPP TS 22.024: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Description of Charge Advice
Information (CAI)\".
[4] 3GPP TS 22.041: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Operator Determined Barring
(ODB)\".
[5] 3GPP TS 22.071: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Location Services (LCS);
Service description, Stage 1\".
[6] 3GPP TS 22.078: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Customised Applications for
Mobile network Enhanced Logic (CAMEL); Service description, Stage 1\".
[7] 3GPP TS 23.003: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Numbering, addressing and identification\".
[8] 3GPP TS 23.008: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Organization of subscriber data\".
[9] 3GPP TS 23.011: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Technical realization of Supplementary
Services\".
[10] 3GPP TS 23.012: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Location management procedures\".
[11] 3GPP TS 23.015: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Technical realization of Operator Determined
Barring (ODB)\".
[12] 3GPP TS 23.018: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Basic call handling; Technical
realization\".
[13] 3GPP TS 23.032: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Universal Geographical Area Description
(GAD)\".
[14] 3GPP TS 23.040: \"3rd Generation Partnership Project; Technical
Specification Group Terminals; Technical realization of the Short Message
Service (SMS)\".
[15] 3GPP TS 23.060: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; General Packet Radio Service
(GPRS); Service description; Stage 2\".
[16] 3GPP TS 23.072: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Call Deflection (CD) Supplementary Service;
Stage 2\".
[17] 3GPP TS 23.066: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Support of Mobile Number Portability (MNP);
Technical realization; Stage 2\".
[18] 3GPP TS 23.073: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Support of Localised Service Area (SoLSA);
Stage 2\".
[19] 3GPP TS 23.079: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Support of Optimal Routeing (SOR); Technical
realization\".
[20] 3GPP TS 23.082: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Call Forwarding (CF) supplementary services;
Stage 2\".
[21] 3GPP TS 23.084: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Multi Party (MPTY) supplementary service;
Stage 2\".
[22] 3GPP TS 23.085: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Closed User Group (CUG) supplementary
service; Stage 2\".
[23] 3GPP TS 23.088: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Call Barring (CB) Supplementary Services;
Stage 2\".
[24] 3GPP TS 23.090: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Unstructured Supplementary Service Data
(USSD); Stage 2\".
[25] 3GPP TS 23.091: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Explicit Call Transfer (ECT) supplementary
service; Stage 2\".
[26] 3GPP TS 23.093: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Technical realization of Completion of Calls
to Busy Subscriber (CCBS); Stage 2\".
[27] 3GPP TS 23.172: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Technical realization of Circuit Switched
(CS) multimedia service; UDI/RDI fallback and service modification; Stage 2\".
[28] 3GPP TS 23.271: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Functional stage 2
description of LCS\".
[29] 3GPP TS 23.278: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Customised Applications for Mobile network
Enhanced Logic (CAMEL) - IP Multimedia System (IMS) interworking; Stage 2\".
[30] 3GPP TS 24.008: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Mobile radio interface layer 3
specification; Core Network Protocols; Stage 3\".
[31] 3GPP TS 24.011: "3rd Generation Partnership Project; Technical
Specification Group Core Network; Point - to - Point (PP) Short Message
Service (SMS); support on mobile radio interface".
[32] 3GPP TS 25.305: \"3rd Generation Partnership Project; Technical
Specification Group Radio Access Network; Stage 2 Functional Specification of
UE Positioning in UTRAN\".
[33] 3GPP TS 25.413: \"3rd Generation Partnership Project; Technical
Specification Group Radio Access Network; UTRAN Iu interface RANAP
signalling\".
[34] 3GPP TS 29.002: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Mobile Application Part (MAP)
specification\".
[35] 3GPP TS 29.007: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; General requirements on interworking between
the Public Land Mobile Network (PLMN) and the Integrated Services Digital
Network (ISDN) or Public Switched Telephone Network (PSTN)\".
[36] 3GPP TS 29.078: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; Customised Applications for Mobile network
Enhanced Logic (CAMEL) Phase 4 CAMEL Application Part (CAP) specification\".
[37] 3GPP TS 32.250: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Telecommunication Management;
Charging management; Circuit Switched (CS) domain charging\".
[38] 3GPP TS 32.251: \"3rd Generation Partnership Project; Technical
Specification Group Services and System Aspects; Telecommunication Management;
Charging management; Packet Switched (PS) domain charging\".
[39] 3GPP TS 48.008: \"3rd Generation Partnership Project; Technical
Specification Group GSM EDGE Radio Access Network; Mobile-services Switching
Centre - Base Station System (MSC - BSS) interface; Layer 3 specification\".
[40] ETSI EN 300 356-1 (V3.2.2): \"Integrated Services Digital Network (ISDN);
Signalling System No.7; ISDN User Part (ISUP) version 3 for the international
interface; Part 1: Basic services[ITU‑T Recommendations Q.761 to Q.764 (1997),
modified]\".
[41] ETSI EN 301 070-1 (V1.2.2): \"Integrated Services Digital Network (ISDN);
Signalling System No.7; ISDN User Part (ISUP) version 3 interactions with the
Intelligent Network Application Part (INAP); Part 1: Protocol specification
[ITU‑T Recommendation Q.1600 (1997), modified]\".
[42] GSM TR 03.47: \"Example protocol stacks for interconnecting; Service
Centre(s) (SC) and Mobile-services Switching Centre(s) (MSC)\".
[43] ITU‑T Recommendation Q.763, December 1999: \"Signalling System No. 7 -
ISDN user part formats and codes\".
[44] ITU‑T Recommendation Q.1224, September 1997: \"Distributed Functional
Plane for Intelligent Network Capability Set 2\".
[45] 3GPP TS 23.087: \"3rd Generation Partnership Project; Technical
Specification Group Core Network; User-to-User Signalling (UUS) Supplementary
Service - Stage 2\".
[46] 3GPP TS 43.059: \"3rd Generation Partnership Project; Technical
Specification Group GSM/EDGE Radio Access Network; Functional stage 2
description of Location Services (LCS) in GERAN\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
apply:
**Basic Call State Model (BCSM):** BCSM provides a high-level model of GMSC-
or MSC/VLR-activities required to establish and maintain communication paths
for users. As such, it identifies a set of basic call activities in a GMSC or
MSC/VLR and shows how these activities are joined together to process a basic
call.
**Call Control Function (CCF):** CCF is the Call Control Function in the
network that provides call/service processing and control (see ITU‑T
Recommendation Q.1224 [44]).
**Call Party Handling (CPH) Information Flow:** Any of the Disconnect Leg,
Move Leg or Split Leg information flows.
**Call Segment:** A call segment contains one or more legs that are controlled
by the same CS_gsmSSF instance. The call parties in the same call segment can
communicate with each other (using a conference bridge if necessary). Call
segments are identified by a number, eg. CSID1 is the call segment with id
number 1.
**Call Segment Association (CSA):** A CSA contains one or more call segments.
Legs can be moved between call segments within the CSA. There is a single CAP
dialogue between the CSA and the gsmSCF.
**Detection Points (DP):** points in processing at which notifications (to the
service logic) can occur and transfer of control (to the gsmSCF) is possible
are called Detection Points (DPs).
**Dialled Service CAMEL Subscription Information (D‑CSI):** D‑CSI identifies
the subscriber as having originating CAMEL dialled services.
**Forwarding MSC:** MSC which is either an MSC invoking a standardized Call
Forwarding supplementary service or Call Deflection supplementary service; or
an MSC invoking a CAMEL based call forwarding service.
**Gateway MLC (GMLC):** functional entity that allows external LCS Clients to
request real-time information about a Mobile Station. The information that can
be requested from the GMLC is:
\- location of Mobile Station
See 3GPP TS 23.271 [28] and 3GPP TS 25.305 [32] or 3GPP TS 43.059 [46] for
information on the GMLC.
**Geodetic Information:** information defining the location of a mobile
station, coded according to ITU‑T Recommendation Q.763 [43]. The derivation of
this information from other information defining the location of a mobile
station is a network operator option. If an entity derives the geodetic
information it shall also provide the equivalent geographical information.
**Geographical Information:** information defining the location of a mobile
station, coded according to 3GPP TS 23.032 [13].
**GPRS CAMEL Subscription Information (GPRS** ‑**CSI):** GPRS‑CSI identifies
the subscriber as having GPRS CAMEL services.
**GPRS Dialogue:** A dialogue between the gprsSSF and the gsmSCF. A single
GPRS Dialogue may consist of one or more TCAP dialogues. Only one TCAP
dialogue shall exists at one point in time for one gprsDialogue.
**GPRS Service Switching Function (gprsSSF):** functional entity that
interfaces the SGSN to the gsmSCF. The concept of the gprsSSF is derived from
the IN SSF, but uses different triggering mechanisms because of the nature of
the mobile network.
**GPRS Session:** GPRS session starts when the GPRS subscriber attaches to the
GPRS data network. It ends when the GPRS subscriber detaches from the GPRS
data network.
**GSM Service Control Function (gsmSCF):** functional entity that contains the
CAMEL service logic to implement OSS. It interfaces with the gsmSSF, the
gsmSRF, the GMLC and the HLR.
**GSM Service Switching Function (gsmSSF):** functional entity that interfaces
the MSC or GMSC to the gsmSCF. The concept of the gsmSSF is derived from the
IN SSF, but uses different triggering mechanisms because of the nature of the
mobile network.
**GSM Specialised Resource Function (gsmSRF):** functional entity which
provides various specialized resources. It interfaces with the gsmSCF and with
the MSC. This entity is defined in ITU‑T Recommendation Q.1224 [44] with
variations defined in the present document.
**Inter-connecting MSC:** MSC which provides CAMEL support for incoming trunk
calls.
**Location Information:** indicates the location of the Mobile Station. The
provision of location information is independent of the MS status. As part of
the location information, an indication of the age of this information may be
delivered.
**Mobile Originating Short Message Service CAMEL Subscription Information
(MO** ‑**SMS** ‑**CSI):** MO‑SMS‑CSI identifies the subscriber as having MO
SMS CAMEL services. MO‑SMS‑CSI (CAMEL Phase 4) is identical to SMS‑CSI (CAMEL
Phase 3).
**Mobile Station State:** similar to **Subscriber State** , but associated
only with a Mobile Station, not with a subscriber.
**Mobile Terminating Short Message Service CAMEL Subscription Information
(MT** ‑**SMS** ‑**CSI):** MT‑SMS‑CSI identifies the subscriber as having MT
SMS CAMEL services.
**Mobility Management event CAMEL Subscription Information (M** ‑**CSI)** :
M‑CSI identifies the subscriber as having Mobility Management event
notification CAMEL services.
**Mobility Management event GPRS CAMEL Subscription Information (MG**
‑**CSI)** : MG‑CSI identifies the GPRS subscriber as having Mobility
Management event notification CAMEL services.
**NA (North American):** prefix attached to certain information items used by
North American PLMNs in connection with routing a call to a preferred or
dialled long distance carrier.
**Network CAMEL Service Information (N** ‑**CSI)** : N‑CSI identifies services
offered on a per-network basis by the serving PLMN operator for all
subscribers.
**Originating Basic Call State Model (O** ‑**BCSM):** originating half of the
BCSM. The O‑BCSM corresponds to that portion of the BCSM associated with the
originating party.
**Originating CAMEL Subscription Information (O** ‑**CSI):** O‑CSI identifies
the subscriber as having originating CAMEL services.
**Point In Association (PIA):** PIAs identify MSC/VLR or SGSN activities
associated with one or more basic association/connection states of interest to
OSS service logic instances.
**Point In Call (PIC):** PICs identify MSC/VLR (GMSC) activities associated
with one or more basic call/connection states of interest to OSS service logic
instances.
**Service Key:** Service Key identifies to the gsmSCF the service logic. The
Service Key is administered by the HPLMN, and is passed transparently by the
VPLMN/IPLMN to the gsmSCF. The Service Key is a part of the
T/O/VT/D/GPRS/SMS/M‑CSI.
**Serving MLC** : functional entity that performs location information
retrieval.
**Short Message Control Protocol (SM-CP)** : Protocol between the MSC or SGSN
and the MS. This protocol, which is specified in 3GPP TS 24.011 [31], is used
to carry RPDU elements between the MSC or SGSN and the MS.
**Short Message Service Centre (SMSC):** also abbreviation SC is used for
SMSC.
**Subscriber State:** see 3GPP TS 22.078 [6].
**Supplementary Service Notification CAMEL Subscription Information (SS**
‑**CSI)** : SS‑CSI identifies the subscriber as having supplementary service
invocation notification CAMEL services.
**Terminating Basic Call State Model (T** ‑**BCSM):** terminating half of the
BCSM. The T‑BCSM corresponds to that portion of the BCSM associated with the
terminating party.
**Terminating CAMEL Subscription Information (in the GMSC) (T** ‑**CSI):**
T‑CSI identifies the subscriber as having terminating CAMEL services in the
GMSC.
**Translation Information Flag (TIF** ‑**CSI)** : TIF‑CSI is a flag in the
CAMEL subscriber data which indicates that when the subscriber registers a
forwarded-to number, that the HLR shall not attempt to perform any
translation, number format checks, prohibited FTN checks, call barring checks.
**Trunk Originated CAMEL Service Information (TO-CSI):** TO-CSI identifies
services offered by the PLMN operator to all incoming calls on a specific MSC
trunk.
**USSD CAMEL Subscription Information (U** ‑**CSI)** : U‑CSI identifies a set
of subscriber specific mappings from a USSD service code to a gsmSCF address.
**USSD General CAMEL Service Information (UG** ‑**CSI)** : UG‑CSI globally
identifies a set of mappings from a USSD service code to a gsmSCF address. The
global mapping applies to all HPLMN subscribers. If, for a particular service
code, both U‑CSI and UG‑CSI are applicable then the U‑CSI shall take
precedence.
**VMSC Terminating CAMEL Subscription Information (VT** ‑**CSI):** VT‑CSI
identifies the subscriber as having terminating CAMEL services in the VMSC.
## 3.2 Abbreviations
Abbreviations used in the present document are listed in 3GPP TR 21.905 [1].
For the purposes of the present document, the following abbreviations apply:
BCSM Basic Call State Model
CAMEL Customized Applications for Mobile network Enhanced Logic
CPH Call Party Handling
CS Call Segment
CS Circuit Switched
CSA Call Segment Association
CSG Closed Subscriber Group
CSID Call Segment (followed by an identification Number e.g. CSID1)
DP Detection Point
DTN Deflected To Number
D‑CSI Dialled Services CAMEL Subscription Information
EDP Event Detection Point
EDS Enhanced Dialled Services
FTN Forwarded To Number
GMLC Gateway MLC
GMSC Gateway MSC
GPRS General Packet Radio Service
gprsSSF GPRS Service Switching Function
GPRS‑CSI GPRS CAMEL Subscription Information
gsmSCF GSM Service Control Function
gsmSRF GSM Specialised Resource Function
gsmSSF GSM Service Switching Function
HLR Home Location Register
HPLMN Home PLMN
ICA Initiate Call Attempt
IE Information Element
IF Information Flow
IP Intelligent Peripheral
IPLMN Interrogating PLMN
LCS Location Services
LSA Localised Service Area
M‑CSI Mobility Management event Notification CAMEL Subscription Information
MF Mobile Forwarding
MG‑CSI Mobility Management event Notification GPRS CAMEL Subscription
Information
MLC Mobile Location Centre
MNP Mobile Number Portability
MNP SRF Mobile Number Portability Signalling Relay Function
MO Mobile Originating
MO‑SMS‑CSI Mobile Originated Short Message Service CAMEL Subscription
Information
MSC Mobile service Switching Centre
MT Mobile Terminating
MT Mobile Terminating in GMSC
MT‑SMS‑CSI Mobile Terminating Short Message Service CAMEL Subscription
Information
N‑CSI Network CAMEL Service Information
NA North American
NNI Network Node Interface
O‑BCSM Originating Basic Call State Model
O‑CSI Originating CAMEL Subscription Information
ODB Operator Determined Barring
OR Optimal Routeing
OSS Operator Specific Service
PDP Packet Data Protocol
PIC Point In Call
PLMN Public Land Mobile Network
SGSN Serving GPRS Support Node
SLPI Service Logic Program Instance
SM Short Message
SM-CP Short Message Control Protocol
SMF Service Management Function
SMLC Serving MLC
SMRSE Short Message Relay Service Element
SMS Short Message Service
SMSC Short Message Service Centre
SMS‑CSI Short Message Service CAMEL Subscription Information
SS‑CSI Supplementary Service Notification CAMEL Subscription Information
T‑BCSM Terminating Basic Call State Model
T‑CSI Terminating CAMEL Subscription Information (in the GMSC)
TDP Trigger Detection Point
TO-CSI Trunk Originated CAMEL Service Information
TPDU Transfer Protocol Data Unit
TIF‑CSI Translation Information Flag
U‑CSI USSD CAMEL Subscription Information
UG‑CSI USSD General CAMEL Service Information
UNI User Network Interface
VLR Visitor Location Register
VPLMN Visited PLMN
VT Mobile Terminating in VMSC
VT‑CSI VMSC Terminating CAMEL Subscription Information
# 4 Circuit switched Call Control
## 4.1 Architecture
### 4.1.1 Functional Entities used for CAMEL
This subclause describes the functional architecture needed to support CAMEL.
Also the additions needed to the basic functionality are described. Figure 4.1
shows the functional entities involved in calls requiring CAMEL support. The
architecture is applicable to the forth phase of CAMEL.
{width="5.761111111111111in" height="3.7625in"}
Figure 4.1: Functional architecture for support of CAMEL
**HLR:** For subscribers requiring CAMEL support, the HLR stores the
information relevant to the current subscription regarding O‑CSI, D‑CSI,
T‑CSI, VT‑CSI and TIF‑CSI. The O‑CSI is sent to the VLR at Location Update, on
data restoration or if the O‑CSI is updated by administrative action. The
D‑CSI is sent to the VLR at Location Update, on data restoration or if the
D‑CSI is updated by administrative action. The VT‑CSI is sent to the VLR at
Location Update, on data restoration or if the VT‑CSI is updated by
administrative action. The TIF‑CSI is sent to the VLR at Location Update, on
data restoration or if the TIF‑CSI is updated by administrative action. The
O/D/T‑CSI is sent to the GMSC when the HLR responds to a request for routeing
information.
**GMSC:** When processing the calls for subscribers requiring CAMEL support,
the GMSC receives an O/D/T‑CSI from the HLR, indicating the GMSC to request
instructions from the gsmSSF. The GMSC monitors on request the call states
(events) and informs the gsmSSF of these states during processing, enabling
the gsmSSF to control the execution of the call in the GMSC.
**MSC:** When processing the calls for subscribers requiring CAMEL support,
the MSC receives an O‑CSI and / or D‑CSI and / or VT‑CSI from the VLR
indicating the MSC to request instructions from the gsmSSF. The MSC monitors
on request the call states (events) and informs the gsmSSF of these states
during processing, enabling the gsmSSF to control the execution of the call in
the MSC.
**VLR:** The VLR stores the O‑CSI, D‑CSI, VT‑CSI and TIF‑CSI as a part of the
subscriber data for subscribers roaming in the VLR area.
**gsmSSF: see subclause 3.1.**
**gsmSCF: see subclause 3.1.**
**gsmSRF: see subclause 3.1.**
### 4.1.2 Interfaces defined for CAMEL
This subclause describes the different interfaces applicable to CAMEL. It
specifies on a high level the functions specific to CAMEL.
#### 4.1.2.1 HLR - VLR interface
This interface is used to send the CAMEL related subscriber data to the
visited PLMN and for provision of MSRN. The interface is also used to retrieve
subscriber status and location information of the mobile subscriber or to
indicate suppression of announcement for a CAMEL service.
#### 4.1.2.2 GMSC - HLR interface
This interface is used at terminating calls to exchange routeing information,
subscriber status, location information, subscription information and
suppression of announcements. The CAMEL related subscriber data that is passed
to the IPLMN is sent over this interface.
#### 4.1.2.3 GMSC - gsmSSF interface
This is an internal interface. The interface is described in the present
document to make it easier to understand the handling of DPs (arming/disarming
of DPs, DP processing etc.).
#### 4.1.2.4 gsmSSF - gsmSCF interface
This interface is used by the gsmSCF to control a call in a certain gsmSSF and
to request the gsmSSF to establish a connection with a gsmSRF. Relationships
on this interface are opened as a result of the gsmSSF sending a request for
instructions to the gsmSCF or opened as a result of the gsmSCF sending a
request to the gsmSSF to initiate a new call.
#### 4.1.2.5 MSC - gsmSSF interface
This is an internal interface. The interface is described in the present
document to make it easier to understand the handling of DPs (arming/disarming
of DPs, DP processing etc.).
#### 4.1.2.6 gsmSCF - HLR interface
This interface is used by the gsmSCF to request information from the HLR. As a
network operator option the HLR may refuse to provide the information
requested by the gsmSCF.
#### 4.1.2.7 gsmSCF - gsmSRF interface
This interface is used by the gsmSCF to instruct the gsmSRF to play
tones/announcements to the users.
#### 4.1.2.8 GMSC - MSC interface
This interface is used to transfer control of a call from a VMSC back to a
GMSC for optimal routeing.
## 4.2 Detection Points (DPs)
### 4.2.1 Definition and description
Certain basic call events may be visible to the GSM Service Control Function
(gsmSCF). The DPs are the points in call at which these events are detected.
The DPs for Mobile Originated Calls and Mobile Terminated Calls are described
in subclauses 4.4.2 and 4.4.3.
A DP can be armed in order to notify the gsmSCF that the DP was encountered,
and potentially to allow the gsmSCF to influence subsequent handling of the
call. If the DP is not armed, the processing entity continues the processing
without gsmSCF involvement.
Three different types of DPs are identified:
\- Trigger Detection Point - Request (TDP‑R).
This detection point is statically armed and initiates a CAMEL control
relationship when encountered and there is no existing relationship due to the
same CSI. Processing is suspended when the DP is encountered.
\- Event Detection Point - Request (EDP‑R).
This detection point is dynamically armed within the context of a CAMEL
control relationship. Processing is suspended when encountering the DP and the
gsmSSF waits for instructions from the gsmSCF.
\- Event Detection Point - Notification (EDP‑N).
This detection point is dynamically armed within the context of a CAMEL
control relationship. Processing is not suspended when encountering the DP.
The DPs are characterized in the following subclauses.
#### 4.2.1.1 Arming/disarming mechanism
A DP may be statically armed or dynamically armed.
The following arming rules apply:
\- A DP for mobile terminating call handling is statically armed in the GMSC
as a result of T‑CSI delivery from the HLR. A DP for mobile terminating call
handling is statically armed in the VMSC as a result of VT‑CSI delivery from
the VLR. A DP for forwarding leg handling is statically armed in the GMSC as
result of O‑CSI and/or D‑CSI delivery from the HLR. A DP for mobile
originating call or forwarded leg handling is statically armed in the VMSC as
a result of O‑CSI and/or D‑CSI delivery from the VLR.
\- A DP is dynamically armed by the gsmSCF within the context of a CAMEL
control relationship (between the gsmSSF and the gsmSCF).
\- A Request Report BCSM Event information flow for a detection point for a
leg overwrites any previous Request Report BCSM Event information flow for
that detection point for that leg.
The following disarming rules apply:
\- A statically armed DP is disarmed when the O‑CSI, D‑CSI, T‑CSI or VT‑CSI
that caused the DP to be statically armed is withdrawn in the HLR. Only TDP‑Rs
can be disarmed using this mechanism.
\- If an armed EDP is met, then it is disarmed.
\- If an EDP is met that causes the release of the related leg, then all EDPs
related to that leg are disarmed.
\- If a call is released, then all EDPs related to that call are disarmed.
\- If an EDP is met, then other EDPs are disarmed, in accordance with the
implicit disarming rule table (see subclause 4.4.4).
\- If an EDP is armed, it can be explicitly disarmed by the gsmSCF by means of
the Request Report BCSM Event information flow.
#### 4.2.1.2 Criteria
Criteria are the conditions that must be met in order for the gsmSSF to
request instructions from the gsmSCF.
##### 4.2.1.2.1 Criteria at DP Collected_Info
The criteria for a mobile originating call are checked in the originating MSC.
The criteria for a mobile forwarded call are checked in the forwarding MSC.
For early forwarded calls in the GMSC, the HLR may decide not to include the
DP Collected_Info trigger criteria in the subscriber data sent to the GMSC if
the trigger criteria for the call are not met.
For optimally routed late forwarded calls, the MSC may decide not to include
the DP Collected_Info trigger criteria in the Resume Call Handling information
flow sent to the GMSC, if the trigger criteria for the call are not met.
The following criteria are applicable for DP Collected_Info:
\- Destination number triggering criterion: The HLR may store a list of up to
10 destination numbers and/or up to 3 number lengths. There is no restriction
on the nature of address. There is no restriction on the numbering plan
indicator. This criterion may be defined to be either \"enabling\" or
\"inhibiting\".
\- Basic service triggering criterion: The HLR may store a list of up to 5
basic service codes, each of which may represent an individual basic service
or a basic service group. Compound basic service group codes, as defined in
3GPP TS 29.002 [34], are not allowed for conditional triggering. This list is
a triggering list.
\- Forwarding triggering criterion: The HLR may store an indicator that
triggering shall occur only for a call which has been subject to the Call
Forwarding supplementary service, Call Deflection supplementary service or
CAMEL call forwarding. This criterion may be defined to be either \"enabling\"
or \"inhibiting\".
For MO calls, triggering at DP Collected_Info shall be strictly based on the
number received over the access network.\ No service selection information,
such as ∗ and # digits, or carrier selection information, dialled by the
subscriber, shall be removed from the number before conditional triggering
check takes place.
For MF calls at the VMSC, triggering at DP Collected_Info shall be strictly
based on the number received over the access network (the Deflected-to-Number
in the case of Call Deflection), the Forwarded-to-Number retained in the VLR
or the Destination Routing Address received in the Connect information flow
from the gsmSCF during a Terminating CAMEL Service at the VMSC.\ No service
selection information or carrier selection information shall be removed from
the number before conditional triggering check takes place.
For MF calls at the GMSC, triggering at DP Collected_Info shall be strictly
based on the Forwarded-to-Number received from HLR, on the Destination Routing
Address received in the Connect information flow from the gsmSCF during a
Terminating CAMEL Service or on the Forwarded-to-Number received in the Resume
Call Handling information flow.\ No service selection information or carrier
selection information shall be removed from the number before conditional
triggering check takes place.
One or more DP criteria may be applicable. All applicable triggering criteria
must be satisfied before the dialogue is established with the gsmSCF.
If the destination number triggering criterion is enabling, then the gsmSSF
may establish a dialogue with the gsmSCF if:
\- the destination number matches one of the destination number strings
defined in the list, or
\- the length of the destination number matches one of the destination number
lengths defined in the list.
In this test the destination number matches one of the destination number
strings in the list if:
\- the nature of address of destination number is the same as the nature of
address of the destination number string (The numbering plan indicator is not
compared);
\- the destination number is at least as long as the destination number string
in the list, and
\- all the digits in the destination number string in the list match the
leading digits of the destination number.
If the destination number triggering criterion is inhibiting, then the gsmSSF
may establish a dialogue with the gsmSCF if:
\- the destination number does not match any of the destination number strings
defined in the list, and
\- the length of the destination number does not match any of the destination
number lengths defined in the list.
In this test the destination number matches one of the destination number
strings in the list if:
\- the nature of address of the destination number is the same as the nature
of address of the destination number string (The numbering plan indicator is
not compared);
\- the destination number is at least as long as the destination number string
in the list, and
\- all the digits in the destination number string in the list match the
leading digits of the destination number.
The basic service triggering criterion is met if the basic service for the
call matches a stored individual basic service code or is a member of the
group defined by a stored basic service group code. For a SCUDIF call (see
3GPP TS 23.172 [27]), the basic service triggering criterion is met if one or
both the preferred basic service and the less preferred basic service for the
call match a stored individual basic service code or is a member of the group
defined by a stored basic service group code. For the purpose of this
paragraph a general bearer service is a member of the corresponding bearer
service group.
If the forwarding triggering criterion is enabling, then the gsmSSF may
establish a dialogue with the gsmSCF only if the call has been subject to
CAMEL call forwarding or the Call Forwarding supplementary service. If the
forwarding triggering criterion is inhibiting, then the gsmSSF may establish a
dialogue with the gsmSCF only if the call has not been subject to CAMEL call
forwarding or the Call Forwarding supplementary service.
##### 4.2.1.2.2 Criteria at DP Analysed_Information
###### 4.2.1.2.2.1 General
The criteria for a mobile originating call are checked in the originating MSC.
The criteria for a mobile forwarded call are checked in the forwarding MSC.
For early forwarded calls in the GMSC, the HLR shall always include the
trigger criteria in the subscriber data sent to the GMSC because that the HLR
can not check the criteria applicable at DP Analysed_Info, since the number
that the criteria check shall be based on, may be modified by a Mobile
Terminating or Mobile Forwarding Service Logic for this call.
For optimally routed late forwarded calls, the MSC shall always include the
trigger criteria in the Resume Call Handling information flow sent to the GMSC
because the MSC can not check the criteria applicable at DP Analysed_Info,
since the number that the criteria check shall be based on, may be modified by
a Mobile Terminating or Mobile Forwarding Service Logic for this call.
The following criteria are applicable for DP Analysed_Information:
\- Destination number triggering criterion: The HLR may store a list of up to
10 destination numbers. There is no restriction on the nature of address.
There is no restriction on the numbering plan indicator.
NOTE: The order in which the destination number criteria are checked in the
MSC or GMSC is not determined. Hence, overlapping destination number criteria
(e.g. use of \"0800\" and \"0800123\" for two different services) should be
avoided, because they lead to unpredictable behaviour (i.e. either service
might be triggered).
For MO calls, triggering at DP Analysed_Info shall be based on the called
party number received over the access network or the Destination Routing
Address in the Connect information flow from the gsmSCF during a Mobile
Originating CAMEL Service.
For MF calls at the VMSC, triggering at DP Analysed_Info shall be based on the
number received over the access network (the Deflected-to-Number in the case
of Call Deflection), the Forwarded-to-Number retained in the VLR, or the
Destination Routing Address in the Connect information flow from the gsmSCF
during a Mobile Terminated or Mobile Forwarded CAMEL Service.
For MF calls at the GMSC, triggering at DP Analysed_Info shall be based on the
Forwarded-to-Number received from the HLR, on the Destination Routing Address
received in the Connect information flow from gsmSCF during a Mobile
Terminated or Mobile Forwarded CAMEL Service, or on the Forwarded-to-Number
received in the Resume Call Handling information flow.
For NP calls, triggering at DP Analysed_Info shall be based on the number
received from gsmSCF. An NP call that is created in the VMSC or GMSC of the
served subscriber may be subject to D‑CSI service and N‑CSI service. An NP
call that is created in an MSC other than the VMSC or GMSC of the served
subscriber, may be subject to N‑CSI service.
For NC calls, triggering at DP Analysed_Info shall be based on the number
received from the gsmSCF. An NC call may be subject to N‑CSI service.
###### 4.2.1.2.2.2 Removal of information significant to the serving entity
In order to decide whether triggering shall take place, the trigger criteria
need to be compared with the address information. Before the comparison takes
place the following information shall be removed from the destination address
information:
\- Operator specific service selection information that is recognised and
treated locally in the serving entity. This shall not lead to a change of the
type of number indicator of the address information.
\- Carrier selection information. If the removal of carrier selection
information also removes international or national (trunk) prefixes (depending
on regulatory requirements), then the type of number indicator of the address
information shall be changed to \"international number\" or \"national
(significant) number\" respectively. Otherwise the type of number indicator
shall remain unchanged.
The address information in a subsequent Initial DP information flow at DP
Analysed_Info shall not contain the removed information, however in the
further call handling the serving entity shall invoke the requested services
(e.g. carrier selection).
###### 4.2.1.2.2.3 Number comparison
The following procedure shall be performed for the comparison of the
destination number triggering criterion and the address information in the
given order.
1\. The numbering plan indicators of the destination number triggering
criterion and the destination number are ignored.
2\. The type of number/nature of address indicators of the destination number
triggering criterion and the destination number are compared. If there is a
match of the type of number indicator, then the check shall be performed by
comparing the digits as defined in step 6. If there is no match of the type of
number the comparison procedure shall continue as follows.
3\. If either or both of the address information and destination number
triggering criterion includes a types of number/nature of address indicator
other than \"unknown\", \"national (significant) number\" or \"international
number\" then the destination number does not match the destination number
triggering criterion. Otherwise the comparison procedure shall continue as
follows.
4\. If there is a number (address information or destination number triggering
criterion) with type of number/nature of address \"unknown\" this number shall
be translated based on the numbering plan of the serving entity in either of
the following ways:
\- if the leading digits refer to an international prefix then those digits
shall be removed and the type of number/nature of address shall be set to
\"international number\".
\- if the leading digits refer to a national (trunk) prefix then those digits
shall be removed and the type of number/nature of address shall be set to
\"national (significant) number\".
> If the leading digits refer neither to an international prefix nor to a
> national (trunk) prefix, then the destination number does not match the
> destination number triggering criterion.
>
> If there is a match of the type of number/nature of address indicator after
> this number modification, then the check shall be performed by comparing the
> digits as defined in step 6, otherwise the comparison procedure shall
> continue as follows.
5\. If the type of number/nature of address of the address information or of
the destination number triggering criterion is \"national (significant)
number\" this number shall be translated based on the numbering plan of the
serving entity to international format by adding the country code of the
serving entity to the number string. After this modification the destination
number triggering criterion and the destination number shall be in
international format and shall be checked by comparing the digits as defined
in step 6.
6 If the number of digits in the address information are compared with the
number of digits in the destination number triggering criterion, then there is
a match if:
> \- the destination number is at least as long as the destination number
> string of the destination number triggering criterion, and
>
> \- all the digits in the destination number string of the destination number
> triggering criterion match the leading digits of the destination number.
The check described in this subclause shall be repeated for every number
contained in the destination number triggering criterion of the D‑CSI until
there is a match DP Analysed_Info is triggered, or until all the destination
numbers have been checked without a match. In the latter case DP Analysed_Info
is not triggered.
The procedures for the destination number triggering criterion check for N‑CSI
are network specific.
The modifications of the address information described in this subclause shall
only be done for comparison purposes, i.e. they shall not affect the format of
the destination address information sent in the Initial DP information flow.
##### 4.2.1.2.3 Criteria at DP Route_Select_Failure
The HLR may store a list of up to 5 cause values.
The criteria for a mobile originating call are checked in the originating MSC.
The criteria for a mobile forwarded call are checked in the forwarding MSC.
For early forwarded calls in the GMSC, the HLR shall always include the
trigger criteria in the subscriber data sent to the GMSC because the cause
code received from ISUP is used in the trigger criteria check. The cause code
is not known at the time of sending the O‑CSI to the GMSC.
For optimally routed late forwarded calls, the MSC shall always include the
trigger criteria in the Resume Call Handling information flow sent to the GMSC
because the cause code received from ISUP is used in the trigger criteria
check. The cause code is not known at the time of sending the O‑CSI to the
GMSC.
The following criteria are applicable for DP Route_Select_Failure:
\- Release cause code.
The trigger criteria are met if the cause code received from ISUP is equal to
at least one of the cause codes in the trigger criteria list. For the purpose
of trigger criteria check, the MSC performing the triggering check shall use
the \"cause value\" field of the ISUP \"cause indicators\" parameter, as
defined in ITU‑T Recommendation Q.763 [43].
If an O‑BCSM was already invoked and there is a relationship with the gsmSCF
at that moment, then no additional relationship shall be initiated.
##### 4.2.1.2.4 Criteria at DP Terminating_Attempt_Authorised
The HLR may store a list of up to 5 basic service codes, each of which may
represent an individual basic service or a basic service group. Compound basic
service group codes, as defined in 3GPP TS 29.002 [34], are not allowed for
conditional triggering. This list is a triggering list.
The criteria for DP Terminating_Attempt_Authorised are checked in the HLR for
the GMSC or in the VLR for the MSC. The HLR shall only include T‑CSI in the
CAMEL subscription information sent to the GMSC if the criteria are met. The
VLR shall only include VT‑CSI in the CAMEL subscription information sent to
the MSC if the criteria are met.
The basic service criterion is met if the basic service for the call matches a
stored individual basic service code or is a member of the group defined by a
stored basic service group code. For a SCUDIF call (see 3GPP TS 23.172 [27]),
the basic service triggering criterion is met if one or both the preferred
basic service and the less preferred basic service for the call match a stored
individual basic service code or is a member of the group defined by a stored
basic service group code.For the purpose of this paragraph a general bearer
service is a member of the corresponding bearer service group.
##### 4.2.1.2.5 Criteria at DP T_Busy and T_No_Answer
The HLR may store a list of up to 5 cause values.
The criteria for a mobile terminating call are checked in the GMSC or in MSC.
For mobile terminating calls in the GMSC, the HLR shall include the trigger
criteria in the subscriber data sent to the GMSC because the cause code
received from ISUP is used in the trigger criteria check. The cause code is
not known at the time of sending the T‑CSI to the GMSC.\ If the Send Routeing
Info ack information flow includes the Not Reachable FTN, then the HLR may
decide not to include the trigger criteria, if the HLR has identified that
T‑CSI includes DP T_Busy with cause code Not Reachable.
If the Send Routeing Info ack information flow includes the Not Reachable FTN
and also T‑CSI, including DP T_Busy with cause code, then the not reachable
condition shall be mapped to an ISUP release code, which shall be used for the
triggering check.
For Mobile terminating calls in the VMSC, the trigger criteria are received in
the VT‑CSI from the HLR in the Insert Subscriber Data information flow. The
triggering is based on the ISUP release cause code (call set up result).
The following criteria are applicable for DP T_Busy and DP T_No_Answer:
\- Release cause code.
If the cause code is received from ISUP, then the trigger criteria are met if
the cause code is equal to at least one of the cause codes in the trigger
criteria list. For this check, the MSC shall use the \"cause value\" field of
the ISUP \"cause indicators\" parameter, as defined in ITU‑T Recommendation
Q.763 [43].
If the cause code is received from MAP, then the trigger criteria are met if
the cause code is equal to at least one of the cause codes in the trigger
criteria list. For this check, the MSC shall use the cause values as defined
in table 4.1.
If the trigger criteria are satisfied, then the corresponding Service Logic
shall be invoked.\ If a T‑BCSM was already invoked and there is a relationship
with the gsmSCF at that moment, then no additional relationship shall be
initiated.
When the Resume Call Handling information flow is received in the GMSC and the
subscriber has T‑CSI then the forwarding reason in the Resume Call Handling
information flow shall be used to perform the trigger criteria check for DP
T_Busy or DP T_No_Answer. If a match is found, then the corresponding Service
Logic shall be invoked.\ If a T‑BCSM was already invoked and there is a
relationship with the gsmSCF at that moment, then no additional relationship
shall be initiated.
Table 4.1: Mapping of Send Info For Incoming Call (SIFIC) ack, Send Routeing
Info ack (SRI ack) or Resume Call Handling (RCH) to ISUP release causes for
triggering criteria check
* * *
SIFIC ack / SRI ack / RCH \"forwarding reason\" ISUP release cause number ISUP
release cause name MS not reachable 20 Subscriber absent MS Busy 17 User busy
Call deflection (note) 21 Call rejected No reply 19 No answer from user (user
alerted) NOTE: Call Deflection is used only in the Resume Call Handling
information flow, and in the VMSC. The same code point in the Send Routeing
Info ack indicates CFU. However, the CFU invocation in the GMSC triggers the
Terminating_Attempt_Authorised DP; thus the reason code mapping is not needed
in the CFU case.
* * *
#### 4.2.1.3 Relationship
If an armed DP is encountered, the gsmSSF provides an information flow via the
already established relationship with the gsmSCF.
A relationship between the gsmSSF and the gsmSCF for the purpose of operator
specific service processing is considered to be a CAMEL relationship. There
are two types of CAMEL relationships:
\- A CAMEL control relationship if the gsmSCF is able to influence the call
processing via the relationship.
\- A CAMEL monitor relationship if the gsmSCF is not able to influence the
call processing via the relationship.
### 4.2.2 DP processing rules
The gsmSSF shall apply the following set of rules during DP processing to
ensure a single point of control:
\- EDPs are disarmed by the gsmSSF as they are encountered and reported to the
gsmSCF, when the occurrence of another EDP causes the implicit disarming of
the EDP or when the leg clears.
\- A control relationship persists as long as there is 1 or more EDP‑R armed
for this portion of the call or if the Process CS_gsmSSF is in any state
except Monitoring or Idle.
\- A control relationship changes to a monitor relationship if the control
relationship does not persist and:
\- 1 or more EDP‑N is armed, or
\- 1 or more Call information Report is outstanding, or
\- an Apply Charging Report is outstanding.
\- If a control relationship does not persist and does not change to a monitor
relationship then the relationship terminates. A monitor relationship
terminates if there are neither EDP‑Ns armed nor reports outstanding or if the
call clears.
## 4.3 Description of CAMEL Subscriber Data
### 4.3.1 Originating CAMEL Subscription Information (O‑CSI)
This subclause defines the contents of the Originating CAMEL Subscription
Information.
#### 4.3.1.1 TDP List
The TDP List indicates on which detection point triggering shall take place.
The following trigger detection points are possible: DP Collected_Info and DP
Route_Select_Failure.
#### 4.3.1.2 gsmSCF address
The gsmSCF address indicates the address to be used to access the gsmSCF for a
particular subscriber. The address shall be an E.164 number to be used for
routeing. Different gsmSCF addresses may be associated with different TDPs.
#### 4.3.1.3 Service Key
The Service Key indicates to the gsmSCF the service logic to be used.
Different Service Keys may be associated with different TDPs.
#### 4.3.1.4 Default Call Handling
The Default Call Handling indicates whether the call shall be released or
continued as requested if there is an error in the gsmSSF to gsmSCF dialogue
or if the call is subject to call gapping in the gsmSSF. A default call
handling shall be associated with each Service Key.
#### 4.3.1.5 DP criteria
The DP criteria indicate whether the gsmSSF shall request instructions from
the gsmSCF.
#### 4.3.1.6 CAMEL Capability Handling
CAMEL Capability Handling indicates the phase of CAMEL which is requested by
the gsmSCF for the service.
The HLR shall not include in a CSI which it sends to a VLR or GMSC any data
for a CAMEL phase later than that which the CAMEL capability handling
indicates. E.g. if the CAMEL Capability Handling indicates CAMEL phase 1 then
the HLR shall not send triggering criteria to the VLR. Different CSIs may
contain different values of CAMEL Capability Handling.
NOTE: If CAMEL is not supported or if a lower phase of CAMEL is supported in
the VLR, the HLR can decide on a subscriber basis to apply ODB, perform normal
call handling or perform operator specific handling (eventually support of a
lower version of CSI).
#### 4.3.1.7 CSI state
The CSI state indicates whether the O‑CSI is active or not.
#### 4.3.1.8 Notification flag
The notification flag indicates whether the change of the O‑CSI shall trigger
Notification on Change of Subscriber Data.
### 4.3.2 Dialled Service CAMEL Subscription Information (D‑CSI)
This subclause defines the contents of the Dialled Service CAMEL Subscription
Information.
#### 4.3.2.1 DP criteria
The DP criteria indicate whether the gsmSSF shall request instructions from
the gsmSCF.
#### 4.3.2.2 gsmSCF address
The gsmSCF address indicates the address to be used to access the gsmSCF for a
particular subscriber. The address shall be an E.164 number to be used for
routeing. A gsmSCF address shall be associated with each DP criterion.
#### 4.3.2.3 Service Key
The Service Key identifies to the gsmSCF the service logic to be used. A
Service Key shall be associated with each DP criteria.
#### 4.3.2.4 Default Call Handling
The Default Call Handling indicates whether the call shall be released or
continued as requested if there is an error in the gsmSSF to gsmSCF dialogue
or if the call is submitted to call gapping in the gsmSSF. A default call
handling shall be associated with each DP criteria.
#### 4.3.2.5 CAMEL Capability Handling
CAMEL Capability Handling indicates the phase of CAMEL which is requested by
the gsmSCF for the service.
NOTE: If CAMEL is not supported or if a lower phase of CAMEL is supported in
the VLR, the HLR can decide on a subscriber basis to apply ODB, perform normal
call handling or perform operator specific handling (eventually support of a
lower version of CSI).
#### 4.3.2.6 CSI state
The CSI state indicates whether the D‑CSI is active or not.
#### 4.3.2.7 Notification flag
The notification flag indicates whether changes of the D‑CSI shall trigger the
Notification on Change of Subscriber Data.
### 4.3.3 Network CAMEL Service Information (N‑CSI)
The N‑CSI identifies services offered on a per-network basis by the serving
PLMN operator for all subscribers and, if applicable, for all incoming trunk
originated calls. This CSI shall be stored in the MSC.
### 4.3.4 Translation Information Flag CAMEL Subscription Information
(TIF‑CSI)
#### 4.3.4.1 Translation Information Flag
The TIF‑CSI in the CAMEL Subscriber data indicates,
\- when the subscriber registers a forwarded-to number, that the HLR shall not
attempt to perform any translation, number format checks, prohibited FTN
checks or call barring checks. (see 3GPP TS 23.082 [20]).
\- when the subscriber invokes the Call Deflection supplementary service, that
the VLR shall not attempt to perform any translation, number format checks,
prohibited DTN checks, call barring checks. (see 3GPP TS 23.072 [16]).
#### 4.3.4.2 Notification flag
The notification flag indicates whether the change of the TIF‑CSI shall
trigger Notification on Change of Subscriber Data or not.
### 4.3.5 Terminating CAMEL Subscription Information (in the GMSC) (T‑CSI)
This subclause defines the contents of the Terminating CAMEL Subscription
Information.
#### 4.3.5.1 TDP List
The TDP List indicates on which detection point triggering shall take place.
The following trigger detection points are possible: DP
Terminating_Attempt_Authorised, DP T_Busy, and DP T_No_Answer.
#### 4.3.5.2 gsmSCF address
The gsmSCF address indicates the address to be used to access the gsmSCF for a
particular subscriber. The address shall be an E.164 number to be used for
routeing. Different gsmSCF addresses may be associated with different TDPs.
#### 4.3.5.3 Service Key
The Service Key indicates to the gsmSCF the service logic to be used.
Different Service Keys may be associated with different TDPs.
#### 4.3.5.4 Default Call Handling
The Default Call Handling indicates whether the call shall be released or
continued as requested if there is an error in the gsmSSF to gsmSCF dialogue
or if the call is subject to call gapping in the gsmSSF. A default call
handling shall be associated with each Service Key.
#### 4.3.5.5 DP criteria
The DP criteria indicate whether the gsmSSF shall request instructions from
the gsmSCF.
#### 4.3.5.6 CAMEL Capability Handling
CAMEL Capability Handling indicates the phase of CAMEL which is requested by
the gsmSCF for the service.
The HLR shall not include in a CSI which it sends to a GMSC any data for a
CAMEL phase later than that which the CAMEL capability handling indicates.
Different CSIs may contain different values of CAMEL Capability Handling.
NOTE: If CAMEL is not supported or if a lower phase of CAMEL is supported in
the GMSC, the HLR can decide on a subscriber basis to apply ODB, perform
normal call handling or perform operator specific handling (e.g. support of a
lower version of CSI).
#### 4.3.5.7 CSI state
The CSI state indicates whether the T‑CSI is active or not.
#### 4.3.5.8 Notification flag
The notification flag indicates whether the change of the T‑CSI shall trigger
Notification on Change of Subscriber Data or not.
### 4.3.6 VMSC Terminating CAMEL Subscription Information (VT‑CSI)
This subclause defines the contents of the Terminating CAMEL Subscription
Information for the VMSC.
#### 4.3.6.1 TDP List
The TDP List indicates on which detection point triggering shall take place.
The following trigger detection points are possible: DP
Terminating_Attempt_Authorised, DP T_Busy, and DP T_No_Answer.
#### 4.3.6.2 gsmSCF address
The gsmSCF address indicates the address to be used to access the gsmSCF for a
particular subscriber. The address shall be an E.164 number to be used for
routeing. Different gsmSCF addresses may be associated with different TDPs.
#### 4.3.6.3 Service Key
The Service Key indicates to the gsmSCF the service logic to be used.
Different Service Keys may be associated with different TDPs.
#### 4.3.6.4 Default Call Handling
The Default Call Handling indicates whether the call shall be released or
continued as requested if there is an error in the gsmSSF to gsmSCF dialogue
or if the call is subject to call gapping in the gsmSSF. A default call
handling shall be associated with each Service Key.
#### 4.3.6.5 DP criteria
The DP criteria indicate whether the gsmSSF shall request the gsmSCF for
instructions.
#### 4.3.6.6 CAMEL Capability Handling
CAMEL Capability Handling indicates the phase of CAMEL which is requested by
the gsmSCF for the service.
The HLR shall not include in a CSI which it sends to a VLR any data for a
CAMEL phase later than that which the CAMEL capability handling indicates.
NOTE: If CAMEL is not supported or if a lower phase of CAMEL is supported in
the VLR, the HLR can decide on a subscriber basis to apply ODB, perform normal
call handling or perform operator specific handling (eventually support of a
lower version of CSI).
#### 4.3.6.7 CSI state
The CSI state indicates whether the VT‑CSI is active or not.
#### 4.3.6.8 Notification flag
The notification flag indicates whether the change of the VT‑CSI shall trigger
Notification on Change of Subscriber Data or not.
### 4.3.7 Other CAMEL data
#### 4.3.7.1 Location information/Subscriber state Interrogation
This data indicates whether additional subscriber information shall be sent to
the GMSC as part of the terminating call handling.
\- an indication that the HLR shall send the location information of the
called subscriber.
\- an indication that the HLR shall send the subscriber state of the called
subscriber.
#### 4.3.7.2 gsmSCF address list for CSI
The gsmSCF address list for CSI indicates a list of gsmSCF addresses to which
Notification on Change of Subscriber Data is to be sent. This list is common
to all CSI.
### 4.3.8 Trunk Originated CAMEL Service Information (TO-CSI)
The TO‑CSI identifies services offered on a MSC basis by the serving PLMN
operator for all incoming calls on a specific MSC trunk. This CSI shall be
stored in the MSC. The contents of the TO-CSI is outside the scope of this
specification.
When processing trunk originating calls requiring CAMEL support, the TO-CSI
informs the MSC to request instructions from the gsmSSF. The MSC monitors on
request the call states (events) and informs the gsmSSF of these states during
processing, enabling the gsmSSF to control the execution of the call in the
MSC.
Certain basic call events may be visible to the GSM Service Control Function
(gsmSCF). The DPs are the points in call at which these events are detected.
The DPs for Trunk Originated Calls are described in subclauses 4.4.2.
Dynamic arming/ disarming rules for TO calls are specified in subclause
4.2.1.1. Static arming/ disarming of DP Collected_Info for TO calls shall use
the following rules:
\- A DP for trunk originating call is statically armed in the MSC as a result
of TO‑CSI for the specific MSC trunk.
  * A statically armed DP is disarmed when the TO‑CSI that caused the DP > to be statically armed is withdrawn from the MSC.
TDP Criteria may be defined for the case when collection of dialled digits has
been performed. Criteria may be based on the contents and/ or length of the
dialled number, basic service, call type or other information at the
discretion of the network operator, however this is outside the scope of this
specification.
DP processing rules for TO calls are defined in subclause 4.2.2.
## 4.4 Description of CAMEL BCSMs
### 4.4.1 General Handling
The BCSM is used to describe the actions in an MSC or GMSC or VMSC during
originating, forwarded or terminating calls.
The BCSM identifies the points in basic call processing when Operator Specific
Service (OSS) logic instances (accessed through the gsmSCF) are permitted to
interact with basic call control capabilities.
Figure 4.2 shows the components that have been identified to describe a BCSM.
{width="1.28125in" height="1.2291666666666667in"}
Figure 4.2: BCSM Components
### 4.4.2 Originating Basic Call State Model (O‑BCSM)
#### 4.4.2.1 Description of O‑BCSM
The O‑BCSM is used to describe the actions in an MSC during originating (MSC)
, forwarded (MSC or GMSC) and trunk originating (MSC) calls.
When encountering a DP the O‑BCSM processing is suspended at the DP and the
MSC or GMSC indicates this to the gsmSSF which determines what action, if any,
shall be taken if the DP is armed. For gsmSCF initiated new calls the O‑BCSM
is initially suspended at DP Collected_Info.
NOTE: The DP O_Busy also includes the \'not reachable\' case.
Figure 4.3: Originating BCSM for CAMEL
The table below defines the different DPs which apply to mobile originating
and forwarded calls and trunk originating calls.
Table 4.2: Description of O‑BCSM DPs in the MSC
+----------------------+----------------------+----------------------+ | CAMEL Detection | DP Type | Description: | | Point: | | | +----------------------+----------------------+----------------------+ | DP Collected_Info | TDP‑R, EDP-R (note | Indication that the | | | 7) | O‑CSI is analysed, | | | | the gsmSCF has | | | | initiated a call | | | | attempt (in this | | | | case the DP is | | | | neither triggered | | | | nor reported) or | | | | additional digits | | | | have been collected. | +----------------------+----------------------+----------------------+ | DP A | TDP‑R (note 2) | Availability of | | nalysed_Information | | routeing address and | | | | nature of address. | +----------------------+----------------------+----------------------+ | DP Ro | TDP‑R (note 3), | Indication that the | | ute_Select_Failure | EDP‑N, EDP‑R | call establishment | | | | failed. | +----------------------+----------------------+----------------------+ | DP O_Busy | EDP‑N, EDP‑R | Indication that: | | | | | | | | - a busy indication | | | | is received from the | | | | terminating party, | | | | | | | | - a not reachable | | | | event is determined | | | | from a cause IE in | | | | the ISUP Release | | | | message. | +----------------------+----------------------+----------------------+ | DP O_No_Answer | EDP‑N, EDP‑R | Indication that: | | | | | | | | - an application | | | | timer associated | | | | with the | | | | O_No_Answer DP | | | | expires, | | | | | | | | - a no answer event | | | | is determined from a | | | | cause IE in the ISUP | | | | Release message. | +----------------------+----------------------+----------------------+ | DP O_Term_Seized | EDP‑N, EDP‑R | Indication that the | | | | called party is | | | | being alerted. | +----------------------+----------------------+----------------------+ | DP O_Answer | EDP‑N, EDP‑R | Indication that the | | | | call is accepted and | | | | answered by the | | | | terminating party. | +----------------------+----------------------+----------------------+ | DP O_Mid_Call | EDP‑N, EDP‑R | Indication that a | | | | service/service | | | | feature indication | | | | is received from the | | | | originating party | | | | (DTMF - note 4, | | | | note 5). | +----------------------+----------------------+----------------------+ | DP O_ | EDP‑N | Indication that the | | Change_Of_Position | | originating party | | | | has changed position | | | | (note 6). | +----------------------+----------------------+----------------------+ | DP O_Disconnect | EDP‑N, EDP‑R | A disconnect | | | | indication is | | | | received from the | | | | originating party or | | | | from the terminating | | | | party. | +----------------------+----------------------+----------------------+ | DP O_Abandon | EDP‑N, EDP‑R | Indication that a | | | | disconnect | | | | indication is | | | | received from the | | | | originating party | | | | during the call | | | | establishment | | | | procedure. | +----------------------+----------------------+----------------------+ | D | EDP‑N | Indication that the | | P O_Service_Change | | bearer service has | | | | changed. | +----------------------+----------------------+----------------------+ | NOTE 1: The DPs are | | | | defined in ITU‑T | | | | Recommendation | | | | Q.1224 [44]. | | | | | | | | NOTE 2: For TDP‑R | | | | A | | | | nalysed_Information | | | | new relationship to | | | | gsmSCF is opened. | | | | | | | | NOTE 3: | | | | DP Ro | | | | ute_Select_Failure | | | | shall be reported as | | | | TDP‑R when there is | | | | no relationship to | | | | gsmSCF. If a | | | | relationship to | | | | gsmSCF is already | | | | open, it shall be | | | | reported as EDP‑R or | | | | EDP‑N if armed so. | | | | DP | | | | Ro | | | | ute_Select_Failure | | | | cannot be armed as | | | | TDP-R for Trunk | | | | Originating Calls. | | | | | | | | NOTE 4: DTMF is only | | | | applicable for the | | | | Mobile Originating | | | | or Trunk Originating | | | | Call in the VMSC. | | | | DTMF is not | | | | applicable at the | | | | O_Alerting PIC. | | | | | | | | NOTE 5: Call | | | | Processing is | | | | suspended at | | | | DP O_Mid_Call if a | | | | Call Party Handling | | | | information flow is | | | | handled. However, | | | | the DP is not | | | | reported. | | | | | | | | NOTE 6: | | | | DP O_ | | | | Change_Of_Position | | | | is applicable only | | | | for the Mobile | | | | Originating Call in | | | | the VMSC. | | | | | | | | NOTE 7: DP | | | | Collected_Info as a | | | | EDP-R is applicable | | | | only for Trunk | | | | Originating Calls. | | | +----------------------+----------------------+----------------------+
##### 4.4.2.1.1 Description of the call model (PICs)
This subclause describes the call model for originating and forwarded calls.
For each PIC a description can be found of the entry events, functions and
exit events.
It should be noted that although the names used for PICs match those used in
ITU‑T Recommendation Q.1224 [44] the specific descriptions differ.
###### 4.4.2.1.1.1 O_Null & Authorise_Origination_Attempt_Collect_Info
Entry events:
\- Disconnection and clearing of a previous call (DP O_Disconnect) or default
handling of exceptions by gsmSSF/(G)MSC completed.
\- Abandon event is reported from Analyse_Information or Routing and Alerting
PIC.
\- Exception event is reported.
  * gsmSCF requests additional digits (DP CollectedInfo or DP > AnalysedInfo).
Actions:
If entry event is 'gsmSCF requests additional digits' then MSC starts
collecting additional digits.
Otherwise:
\- Interface is idled.
\- Mobile Originating call:
\- SETUP information flow containing the dialled number is received from MS,
preceeding call leg or originating exchange.
\- The supplementary service \"barring of all outgoing calls\" is checked and
invoked if necessary.
\- The ODB category \"barring of all outgoing calls\" is checked and ODB is
invoked if necessary.
NOTE: the ODB category \"barring of all outgoing calls when roaming\" causes
the HLR to send the category \"barring of all outgoing call\" if the VLR is
not in the HPLMN.
> \- CUG checks done in the originating MSC/VLR are performed.
\- Information being analysed e.g. O-CSI is analysed.
  * Trunk Originating call:
\- The initial information flow containing the complete dialled number or an
initial information package/ dialling string is received from the trunk
interface.
\- Any operator specific service checks done in the originating MSC are
performed.
\- Information being analysed e.g., TO‑CSI is analysed.
Exit events:
If entry event was 'gsmSCF requests additional digits' then:
  * Additional digits collected.
  * Inter-digit timer expires
  * An exception condition is encountered. For example, collection of > additional digits fails due to a lack of switch resources (e.g. no > digit receivers are available) or calling party abandons call.
Otherwise:
\- Originating CSI is analysed.
  * Trunk Originating CSI is analysed.
\- An exception condition is encountered. For this PIC, if the call encounters
one of these exceptions during the PIC processing, the exception event is not
visible because there is no corresponding DP. Example exception condition:
Calling party abandons call.
###### 4.4.2.1.1.2 Analyse_Information
Entry events:
\- Originating CSI is analysed. (DP Collected Info).
  * Trunk Originating CSI is analysed (DP Collected Info).
  * Additional digits collected (DP Collected Info) in trunk originated > call.
\- The gsmSCF has initiated a call attempt (DP Collected_Info). In this case
the DP has neither been triggered nor has it been reported.
\- New routeing information is received when the Busy event (DP O_Busy), Route
Select Failure event (DP Route_Select_Failure), Not Reachable event (DP
O_Busy) or No Answer event (DP O_No_Answer) is reported from the Routing and
Alerting PIC.
\- New routeing information is received when the Disconnect event is reported
from the O_Active PIC.
Actions:
\- Compare the called party number with the dialled services information.
Exit events:
\- Availability of routeing address and nature of address. (DP
Analysed_Information).
\- An exception condition is encountered (e.g. invalid number); this leads to
the O_Exception PIC.
\- The calling party abandons the call; this leads to the O_Abandon DP.
###### 4.4.2.1.1.3 Routing
Entry events:
\- Availability of routeing address and nature of address. (DP
Analysed_Information).
Actions:
\- Information is being analysed and/or translated according to dialling plan
to determine routeing address.
\- Routeing address being interpreted.
\- Mobile Originating or forwarded call: Outgoing barring services and ODB
categories not already applied are checked and invoked if necessary.
  * Trunk Originating call: Any operator specific service checks in the > originating MSC are performed.
Exit events:
\- An alerting indication (ISUP ACM) is received from the terminating party;
this leads to the O_Term_Seized DP.
  * The attempt to select the route for the call fails; this leads to > the Route_Select_Failure DP.
  * A busy indication is received from the terminating party; this leads > to the O_Busy DP.
  * A not reachable indication is received from the terminating party; > this leads to the O_Busy DP.
  * A no reply indication is received from the terminating party or a no > reply condition is determined at the MSC/ gsmSSF; this leads to > the O_No_Answer DP
  * An indication is received from the terminating half BCSM that the > call is accepted and answered by the terminating party; this leads > to O_Answer DP.
  * The calling party abandons the call' this leads to the O_Abandon > DP.
\- An exception condition is encountered; this leads to the O_Exception PIC.
###### 4.4.2.1.1.4 O_Alerting
Entry events:
\- Called Party is being alerted (DP O_Term_Seized).
\- Continue is received in O_Mid_Call DP.
Actions:
\- Call is being processed by the terminating half BCSM. Waiting for
indication from terminating half BCSM that the call has been answered by
terminating party.
\- Send a notification to the gsmSCF if the originating party changes position
and DP O_Change_Of_Position is armed.
Exit events:
\- An indication is received from the terminating half BCSM that the call is
accepted and answered by the terminating party; this leads to the O_Answer DP.
\- A route select failure indication is received from the terminating party;
this leads to the Route_Select_Failure DP.
\- A busy indication is received from the terminating party; this leads to the
O_Busy DP.
\- A not reachable indication is received from the terminating party; this
leads to the O_Busy DP.
\- A no reply indication is received from the terminating party or a no reply
condition is determined at the MSC/ gsmSSF; this leads to the O_No_Answer DP.
\- The calling party abandons the call; this leads to the O_Abandon DP.
\- An exception condition is encountered; this leads to the O_Exception PIC.
###### 4.4.2.1.1.5 O_Active
Entry events:
\- Indication from the terminating half BCSM that the call is accepted and
answered by the terminating party. (DP O_Answer)
\- Continue is received in O_Mid_Call DP.
Actions:
\- Connection established between originating party and terminating party.
Call supervision is provided.
\- Send a notification to the gsmSCF if the originating party changes position
and DP O_Change_Of_Position is armed.
\- Send a notification to the gsmSCF if the bearer is changed due to the
SCUDIF and DP O_Service_Change is armed.
\- Call release is awaited.
Exit events:
\- A service/service feature request is received from the originating party
(DTMF) or DP O_Mid_Call is used for Call Party Handling (DP O_Mid_Call).
\- A disconnection indication is received from the originating party, or
received from the terminating party via the terminating half BCSM (DP
O_Disconnect).
\- An exception condition is encountered.
###### 4.4.2.1.1.6 O_Exception
Entry events:
\- An exception condition is encountered. In addition to specific examples
listed above, exception events include any type of failure, which means that
the normal exit events for a PIC can not be met.
Actions:
\- Default handling of the exception condition is being provided. This
includes general actions necessary to ensure that no resources remain
inappropriately allocated such as:
\- If any relationship exists between the gsmSSF and the gsmSCF, the gsmSSF
shall send an error information flow closing the relationships and indicating
that any outstanding call handling instructions will not run to completion.
\- The (G)MSC/gsmSSF should make use of vendor-specific procedures to ensure
release of resources within the (G)MSC/gsmSSF, so that line, trunk and other
resources are made available for new calls.
Exit events:
\- Default handling of the exception condition by gsmSSF/(G)MSC completed.
### 4.4.3 Terminating Basic Call State Model (T‑BCSM)
#### 4.4.3.1 Description of T‑BCSM
The T‑BCSM is used to describe the actions in a GMSC and in a VMSC during
terminating calls.
When encountering a DP the T‑BCSM processing is suspended at the DP and the
GMSC or VMSC indicates this to the gsmSSF which determines what action, if
any, shall be taken if the DP is armed.
{width="5.197916666666667in" height="5.322916666666667in"}
Figure 4.4: T‑BCSM in the GMSC or VMSC
In the table below the different DPs (in the T‑BCSM) are described.
Table 4.3: Description of T‑BCSM DPs in the GMSC or VMSC
+----------------------+----------------------+----------------------+ | CAMEL Detection | DP Type | Description: | | Point: | | | +----------------------+----------------------+----------------------+ | DP Ter | TDP‑R | Indication that the | | minating_Attempt_\ | | T‑CSI / VT‑CSI is | | Authorised | | analysed. | +----------------------+----------------------+----------------------+ | DP T_Busy | TDP‑R (note 2), | Indication that: | | | EDP‑N, EDP‑R | | | | | - a busy indication | | | | is received from the | | | | destination | | | | exchange, | | | | | | | | - Busy event is | | | | determined in the | | | | visited MSC, | | | | | | | | - Not reachable or | | | | call establishment | | | | failure event is | | | | determined from the | | | | HLR response or upon | | | | a cause IE in the | | | | ISUP Release | | | | message. | +----------------------+----------------------+----------------------+ | DP T_No_Answer | TDP‑R (note 2), | Indication that: | | | EDP‑N, EDP‑R | | | | | - an application | | | | timer associated | | | | with the | | | | T_No_Answer DP | | | | expires | | | | | | | | - a no answer event | | | | is determined from a | | | | cause IE in the ISUP | | | | Release message. | +----------------------+----------------------+----------------------+ | DP Call_Accepted | EDP‑N, EDP‑R | Indication that the | | | | called party is | | | | being alerted. | +----------------------+----------------------+----------------------+ | DP T_Answer | EDP‑N, EDP‑R | Call is accepted and | | | | answered by | | | | terminating party. | +----------------------+----------------------+----------------------+ | DP T_Mid_Call | EDP‑N, EDP‑R | Indication that a | | | | service/service | | | | feature is received | | | | from the terminating | | | | party (DTMF - | | | | note 3, note 4). | +----------------------+----------------------+----------------------+ | DP T_ | EDP‑N | Indication that the | | Change_Of_Position | | terminating party | | | | has changed position | | | | (note 5). | +----------------------+----------------------+----------------------+ | DP T_Disconnect | EDP‑N, EDP‑R | A disconnect | | | | indication is | | | | received from the | | | | terminating party or | | | | from the originating | | | | party. | +----------------------+----------------------+----------------------+ | DP T_Abandon | EDP‑N, EDP‑R | A disconnect | | | | indication is | | | | received from the | | | | originating party | | | | during the call | | | | establishment | | | | procedure. | +----------------------+----------------------+----------------------+ | D | EDP‑N | Indication that the | | P T_Service_Change | | bearer service has | | | | changed. | +----------------------+----------------------+----------------------+ | NOTE 1: The DPs are | | | | defined in ITU‑T | | | | Recommendation | | | | Q.1224 [44]. | | | | | | | | NOTE 2: | | | | DP T_No_Answer and | | | | DP T_Busy shall be | | | | reported as TDP‑R | | | | when there is no | | | | relationship to | | | | gsmSCF. If a | | | | relationship to | | | | gsmSCF is already | | | | open, it shall be | | | | reported as EDP‑R or | | | | EDP‑N if armed so. | | | | | | | | NOTE 3: DTMF is only | | | | applicable for the | | | | VMSC but not for the | | | | GMSC. DTMF is not | | | | applicable at the | | | | T_Alerting PIC. | | | | | | | | NOTE 4: Call | | | | Processing is | | | | suspended at | | | | DP T_Mid_Call if a | | | | Call Party Handling | | | | information flow is | | | | handled. However, | | | | the DP is not | | | | reported. | | | | | | | | NOTE 5: | | | | DP T_ | | | | Change_Of_Position | | | | is applicable only | | | | for the Mobile | | | | Terminating Call in | | | | the VMSC. | | | +----------------------+----------------------+----------------------+
##### 4.4.3.1.1 Description of the call model (PICs)
This subclause describes the call model for terminating calls in the GMSC and
in the VMSC. For each PIC a description can be found of the entry events,
functions, information available and exit events.
It should be noted that although the names used for PICs match those used in
ITU‑T Recommendation Q.1224 [44] the specific descriptions differ.
###### 4.4.3.1.1.1 T_Null
Entry events:
\- Disconnection and clearing of a previous call (DP T_Disconnect) or default
handling of exceptions by gsmSSF/GMSC or VMSC completed.
\- Abandon event is reported from Terminating Call Handling PIC.
\- Exception event is reported.
Actions:
\- Interface is idled.
\- If ISUP Initial Address Message is received, the appropriate information is
analysed.
\- If the T‑BCSM is in the GMSC, a Send Routeing Info information flow is sent
to the HLR.
\- If the T‑BCSM is in the VMSC, a Send Info For Incoming Call information
flow is sent to the VLR.
\- If the T‑BCSM is in the GMSC:
\- The supplementary services \"barring of all incoming calls\" and \"barring
of incoming calls when roaming\" are checked in the HLR and invoked if
necessary.
\- The ODB categories \"barring of all incoming calls\" and \"barring of
incoming calls when roaming\" are checked in the HLR and ODB is invoked if
necessary.
\- The supplementary service \"CUG\" is checked in the HLR and invoked if
necessary.
\- T‑CSI/VT‑CSI is received and analysed.
Exit events:
\- Response is received from HLR or VLR and terminating CSI (if available) is
analysed.
\- An exception condition is encountered. For this PIC, if the call encounters
one of these exceptions during the PIC processing, the exception event is not
visible because there is no corresponding DP.
Example exception condition is:
\- The calling party abandons call.
###### 4.4.3.1.1.2 Terminating Call Handling
Entry events:
\- Response is received from HLR or VLR and terminating CSI (if available) is
analysed (DP Terminating_Attempt_Authorised).
\- New routeing information is received when a Busy or not reachable event (DP
T_Busy) or a No Answer event (DP T_No_Answer) is reported from the Terminating
Call Handling PIC.
\- New routeing information is received when a Disconnect event is reported
from the T_Active PIC.
NOTE: The HLR may use MAP signalling to indicate to the GMSC before the call
is extended to the destination VMSC that the terminating party is not
reachable, or the destination VMSC may use telephony signalling to indicate to
the GMSC after the call has been extended to the destination VMSC that the
terminating party is not reachable.
Actions:
\- The response from the HLR or VLR is analysed.
\- Routeing address and call type are interpreted. The next route or
terminating access is selected.
\- The Call Forwarding supplementary service is invoked if necessary.
Exit events:
\- The call is accepted and answered by terminating party; this leads to the
T_Answer DP.
\- An indication is received that the called party is being alerted; this
leads to the Call_Accepted DP.
\- An exception condition is encountered; this leads to the T_Exception PIC.
Example exception conditions: the call setup to the MSC or GMSC was not
successful.
\- The calling party abandons the call; this leads to the T_Abandon DP.
\- The terminating access is busy in the VMSC or a busy indication is received
from the destination exchange in the GMSC; this leads to the T_Busy DP.
\- A not reachable event detected or failure of attempt to select the route
for the terminating leg in the GMSC fails or the MS cannot be reached in the
VMSC; this leads to the T_Busy DP.
\- The no reply timer expires; this leads to the T_No_Answer DP.
###### 4.4.3.1.1.3 T_Alerting
Entry events:
\- Called party is being alerted (DP Call_Accepted)
\- Continue is received in T_Mid_Call DP.
Actions:
\- Waiting for the call to be answered by terminating party.
\- The Call Forwarding supplementary service is invoked if necessary.
\- Send a notification to the gsmSCF if the terminating party changes position
and DP T_Change_Of_Position is armed.
Exit events:
\- The call is accepted and answered by terminating party; this leads to the
T_Answer DP.
\- An exception condition is encountered; this leads to the T_Exception PIC.
Example exception conditions: the call setup to the MSC or GMSC was not
successful.
\- The calling party abandons the call; this leads to the T_Abandon DP.
\- A busy indication (UDUB) is received from the destination exchange; this
leads to the T_Busy DP.
\- A not reachable event is detected or the attempt to select the route for
the terminating leg in the GMSC fails or the MS cannot be reached in the VMSC;
this leads to the T_Busy DP.
\- The no reply timer expires; this leads to the T_No_Answer DP.
\- A Call Party Handling information flow is executed; this leads to the
T_Mid_Call DP.
###### 4.4.3.1.1.4 T_Active
Entry events:
\- Indication that the call is accepted and answered by the terminating party.
(DP T_Answer).
\- Continue is received in T_Mid_Call DP.
Actions:
\- Connection established between originating party and terminating party.
Call supervision is being provided.
\- Send a notification to the gsmSCF if the terminating party changes position
and DP T_Change_Of_Position is armed.
\- Send a notification to the gsmSCF if the bearer is changed due to the
SCUDIF and DP T_Service_Change is armed.
\- Wait for call release.
Exit events:
\- A disconnection indication is received from the terminating party, or
received from the originating party via the originating half BCSM; this leads
to the T_Disconnect DP.
\- An exception condition is encountered. In addition to the specific examples
listed above, exception events include any type of failure that means that the
normal exit events for a PIC cannot be met.
\- A service/service feature request is received from the called party (DTMF)
or a Call Party Handling information flow is executed; this leads to the
T_Mid_Call DP.
###### 4.4.3.1.1.5 T_Exception
Entry events:
\- An exception condition is encountered. In addition to the specific examples
listed above, exception events include any type of failure, which means that
the normal exit events for PIC cannot be met.
Actions:
\- Default handling of the exception condition is being provided. This
includes general actions necessary to ensure that no resources remain
inappropriately allocated such as:
\- If any relationship exists between the gsmSSF and the gsmSCF, the gsmSSF
shall send an error information flow closing the relationships and indicating
that any outstanding call handling instructions will not run to completion.
\- The GMSC or VMSC / gsmSSF should make use of vendor-specific procedures to
ensure release of resources within the GMSC or VMSC / gsmSSF, so that line,
trunk and other resources are made available for new calls.
Exit events:
\- Default handling of the exception condition by gsmSSF/GMSC is completed.
### 4.4.4 Rules for Implicit Disarming of Event Detection Points
The tables below give the rules for implicit disarming of event detection
points.
Implicit EDP disarming rules are specified in the tables below for Originating
BCSM and Terminating BCSM respectively. Each table specifies which EDP\'s
shall be disarmed (i.e. MonitorMode set to Transparent) if/when each EDP is
encountered, irrespective of the EDP\'s Monitor Mode (Transparent, Notify And
Continue, or Request).
When EDPs armed with MonitorMode \'Request\' (EDP‑Rs) are encountered, any
implicit EDP disarming shall take place before reporting the EDP and
transiting the gsmSSF to the Waiting_For_Instruction state (if not already
suspended in the Waiting_For_Instruction state).
If the BCSM has encountered DP O/T_Answer then an originator release must be
detected as a DP O/T_Disconnect.
The table entry \'X\' means that if the DP is encountered (independently of
arming and reporting to the gsmSCF) the marked DP is implicitly disarmed.
It shall be possible to rearm explicitly an implicitly disarmed DP, e.g. for
follow on call.
Table 4.4: Implicit disarmed DPs in the O‑BCSM
* * *
Encountered DP Implicit disarmed DPs  
Collected_Info Route_Select_Failure O_Busy O_No_Answer O_Answer O_Mid_Call Leg
1 O_Disconnect Leg 1 O_Disconnect any other Leg O_Abandon O_Term_Seized
O_Change_Of_Position O_Service_Change Collected_Info X  
Route_Select_Failure X X X X X X  
O_Busy X X X X X X  
O_No_Answer X X X X X X  
O_Answer X X X X X X  
O_Mid_Call Leg 1 (note 1) X  
O_Disconnect Leg 1 X X X X X O_Disconnect any other Leg X X X X X X  
O_Abandon X X X X X X O_Term_Seized X  
O_Change_Of_Position (note 1) X  
O_Service_Change (note 1) X Note 1 If the Automatic Rearm IE was present in
the Request Report BCSM Event information flow for the O_Change_Of_Position
DP, O_Service_Change or the O_Mid_Call DP and armed as EDP‑N, then the DP
shall be automatically rearmed by the gsmSSF when it is encountered.
* * *
Table 4.5: Implicit disarmed DPs in the T‑BCSM
* * *
Encountered DP Implicit disarmed DPs  
T_Busy T_No_Answer T_Answer T_Mid_Call Leg 2 T_Disconnect Leg 1 T_Disconnect
Leg 2 T_Abandon Call_Accepted T_Change_Of_Position T_Service_Change T_Busy X X
X X X X X X T_No_Answer X X X X X X X X T_Answer X X X X X  
T_Mid_Call Leg 2 (note 1) X  
T_Disconnect Leg 1 X X  
T_Disconnect Leg 2 X X X X X X X X T_Abandon X X  
Call_Accepted X  
T_Change_Of_Position (note 1) X  
T_Service_Change (note 1) X Note 1 If the Automatic Rearm IE was present in
the Request Report BCSM Event information flow for the T_Change_Of_Position
DP, T_Service_Change or the T_Mid_Call DP and armed as EDP‑N, then the DP
shall be automatically rearmed by the gsmSSF when it is encountered.
* * *
### 4.4.5 BCSM Modelling of Call Scenarios
This subclause describes how the BCSMs defined above are used to model CS call
scenarios. For each scenario the used and unused BCSMs involved in the call
are shown.
In some cases these models may have an allocation to physical nodes different
from that shown. However, the physical separation of the logical functions
shown shall not impact the modelling. This subclause describes the call
scenarios without optimal routeing. If optimal routeing is invoked then the
physical configurations may be different from those shown, but the modelling
is not changed.
CAMEL may be applied simultaneously and independently for each subscriber
involved in a call. This is not shown in these scenarios.
Subscribers other than those being served by CAMEL may be either PSTN
subscribers, other subscribers or any other addressable subscriber.
#### 4.4.5.1 Mobile Originated Call
For the call from A to B, an instance of the O‑BCSM will be created in the MSC
(labelled \"O(A‑B)\"). If the A‑party has an active O‑CSI or D‑CSI, or the MSC
has an active N‑CSI, and the trigger criteria, if present, are fulfilled, then
a CAMEL control relationship with gsmSCF(1) shall be established.
{width="4.111111111111111in" height="2.792361111111111in"}
Figure 4.5: BCSM Scenario for Mobile Originated Call
#### 4.4.5.2 Mobile Terminated Call at the GMSC or VMSC
For the call from A to B, an instance of the T‑BCSM will be created in the
GMSC (labelled \"T(A‑B)\") and an instance of the T‑BCSM will be created in
the VMSC (labelled \"T(A‑B)\").\ If the B‑party has an active T‑CSI in the
GMSC and the trigger criteria, if present, are fulfilled, then a CAMEL control
relationship between the GMSC and the gsmSCF(1) shall be established. If the
B‑party has an active VT‑CSI in the VMSC and the trigger criteria, if present,
are fulfilled, then a CAMEL control relationship between the VMSC and the
gsmSCF(2) shall be established.
The relationships with gsmSCF (1) and gsmSCF(2) may exist simultaneously. The
two gsmSCF endpoints of the relationships are treated independently.
The nodes gsmSCF (1) and gsmSCF (2) may be the same or different entities.
{width="6.0in" height="2.5972222222222223in"}
Figure 4.6: BCSM Scenario for Mobile Terminated Calls at the GMSC or VMSC
#### 4.4.5.3 Call Forwarding at the GMSC or VMSC
If the B‑party has an active T‑CSI in the GMSC or VT‑CSI in the VMSC and the
trigger criteria, if present, are fulfilled, then a CAMEL control relationship
between the GMSC or VMSC and the gsmSCF(1) shall be established.
Following processing at the GMSC or VMSC the call will be extended to the VMSC
serving the B‑party. This VMSC may be physically integrated with the GMSC.
A new call leg to a \"C\" party shall be created if:
\- a Call Forwarding supplementary service or Call Deflection supplementary
service forwards the call to C. An instance of the O‑BCSM O(B‑C) will be
created for the forwarding leg. If the B‑party has an active O‑CSI or D‑CSI in
the GMSC or VMSC, or the GMSC or VMSC has an active N‑CSI, and the trigger
criteria, if present, are fulfilled, then a CAMEL control relationship between
the GMSC or VMSC and the gsmSCF(2) shall be established. If the GMSC or VMSC
receives the \'Suppress O-CSI\' parameter, then O‑CSI shall not be used for
the forwarding leg or deflecting leg; or
\- a CAMEL service in a control relationship with T(A‑B) performs a CAMEL-
based call forwarding by using a Connect information flow. An instance of the
O‑BCSM O(B‑C) will be created for the forwarding leg. If the B‑party has an
active O‑CSI or D‑CSI in the GMSC or VMSC, or the GMSC or VMSC has an active
N‑CSI, and the trigger criteria, if present, are fulfilled, then a CAMEL
control relationship between the GMSC or VMSC and the gsmSCF(2) shall be
established. The O‑CSI shall be used for the forwarding leg only if the last
Connect information flow includes the \"O‑CSI applicable\" flag.
The relationship with gsmSCF (1) and the relationship with gsmSCF(2) may exist
simultaneously. The two relationships are treated independently at the GMSC.
The instance of the BCSM T(A‑B) and the instance of the BCSM O(B‑C) are linked
by an internal interface which is assumed to behave in a similar way to an
ISUP interface.
The nodes gsmSCF (1) and gsmSCF (2) may be the same or different physical
entities.
{width="6.0in" height="2.595833333333333in"}
Figure 4.7: BCSM Scenario for Call Forwarding at the GMSC or VMSC
#### 4.4.5.4 gsmSCF Initiated Call
When the gsmSCF wishes to originate a new call, the gsmSCF establishes
communication with the network using CAP signalling. When the gsmSCF wishes to
originate a new leg within an existing call, the gsmSCF uses the already
established communication with the gsmSSF. It sends an Initiate Call Attempt
information flow which shall contain the address of the called party.
Afterwards the gsmSCF shall instruct the gsmSSF to continue with the call
processing. The MSC constructs an ISUP Initial Address Message using the
parameters received from the gsmSCF and sends it to the destination exchange.
The O‑BCSM for the gsmSCF initiated call to B (labelled \"O(M‑B)\") is invoked
on request of the gsmSCF. A control relationship with gsmSCF (1) is created
for the initiation of a new call.
NOTE: The term ISUP is used to denote UNI or NNI signalling system used in a
given network.
{width="3.1527777777777777in" height="2.790277777777778in"}
Figure 4.8: BCSM Scenario for gsmSCF Initiated New Call
#### 4.4.5.5 Trunk Originated Call
For the call from A to B, an instance of the O‑BCSM will be created in the MSC
(labelled \"O(A‑B)\"). If the MSC has an active TO‑CSI for the trunk on which
the call has originated, or an active N-CSI, and the trigger criteria (if
present) are fulfilled, then a CAMEL control relationship with gsmSCF(1) shall
be established.
Figure 4.4.5.5.1: BCSM Scenario for Trunk Originated Call
### 4.4.6 Leg Handling
A call may consist of several call parties with each party connected to the
call, e.g. there may be a calling party and several called parties.
From a call handling point of view it is necessary to distinguish between a
leg, which is a concept internal to the call handling model, and a connection,
which is the external link to the party. A connection to the call party will
be set up using telephony (e.g. ISUP) or radio access signalling. The outgoing
leg already exists when the connection is set up. On the other hand, if a
connection is released, e.g. because the destination user is busy, the leg
still exists, and the gsmSCF can send a Connect Information Flow to connect
this leg to another call party.
#### 4.4.6.1 Leg is created
For the purposes of the formal description, one or more legs are created in
the following cases:
\- When a call is to be established, i.e. when an incoming Setup or ISUP IAM
is being handled or when a call is to be forwarded, the incoming leg (leg1)
and the outgoing leg (leg2) are created before the first CS_gsmSSF process is
invoked for that call in this MSC. In particular, this applies before the Call
Control Function (CCF) sends DP_Collected_Info (for originating, forwarded or
deflected calls) or DP_Terminating_Attempt_Authorised (for terminating calls)
to the CS_gsmSSF process;
\- When the CS_gsmSSF process receives an Initiate Call Attempt Information
Flow, an outgoing leg is created.
#### 4.4.6.2 Leg continues to exist
For the purposes of the formal description, a leg continues to exist in the
following cases:
\- The CCF sends any DP to the CS_gsmSSF the leg will continue to exist at
least until the CS_gsmSSF instructs the CCF to continue its processing for the
leg;
\- A connection to a called party is not successful and the gsmSCF sends a new
Connect Information Flow for that leg;
\- A called party releases her connection and the gsmSCF sends a new Connect
Information Flow for that leg;
\- The CS_gsmSSF processes either of the Call Party Handling Information Flows
Move Leg and Split Leg;
#### 4.4.6.3 Leg is released
Before a leg is released the corresponding connection is released. All
outstanding reports for the leg are sent to the gsmSCF and the corresponding
call records are closed.
For the purposes of the formal description, a leg ceases to exist when any of
the following events occurs:
\- The calling party releases the connection, the CCF sends a DP to the
CS_gsmSSF and the CCF receives Int_Continue or Int_Continue_With_Argument from
the CS_gsmSSF process;
\- A connection to a called party is not successful (DPs Route_Select_Failure,
O_Busy, O_No_Answer, T_Busy and T_No_Answer), the CCF sends a DP to the
CS_gsmSSF and the CCF does not receive Int_Connect for that outgoing leg from
the CS_gsmSSF;
\- The called party releases her connection, the CCF sends a DP to the
CS_gsmSSF and the CCF does not receive Int_Connect for that outgoing leg from
the CS_gsmSSF;
\- The CCF receives Int_Disconnect_Leg from the CS_gsmSSF;
\- The timer Tcp expires for a leg and the condition \"Release if duration
exceeded\" is true for that leg;
\- The CCF receives Int_Release_Call from the CS_gsmSSF.
If a call is released, either on instruction from the CS_gsmSSF or on normal
call handling without any CAMEL interaction, then all legs involved in the
call cease to exist.
#### 4.4.6.4 Leg is moved
A leg can be moved from one call segment (source call segment) to another call
segment (target call segment) as a result of a Move Leg or Split Leg
information flow. When the CSA_gsmSSF receives a Split Leg Information Flow it
creates a new call segment and moves the specified leg into this call segment.
When the CSA_gsmSSF receives a Move Leg Information Flow it moves the
specified leg into call segment 1.
A leg is no longer contained in the source call segment when the source
CS_gsmSSF receives Int_Export_Leg_ack from the CCF.
A leg is contained in the target call segment when the target CS_gsmSSF
receives Int_Import_Leg_ack from the CCF.
## 4.5 Procedures for CAMEL
The SDLs in the present document illustrate how CAMEL modifies the normal call
handling. They do not attempt to show all the details of call handling in
nodes that support CAMEL. Relevant parts of 3GPP TS 23.018 [12] apply in
addition to these SDLs. For example, some inputs leading to unsuccessful call
attempts are not shown on these diagrams - corresponding clauses in 3GPP TS
23.018 [12] apply.
Note that in some SDL processes and procedures the Release information flow
may be sent on both an access interface and an inter-switch interface. If the
message is sent on a UNI, its effect is the same as a Release transaction
information flow.
The text in this clause is a supplement to the definition in the SDL diagrams;
it does not duplicate the information in the SDL diagrams.
### 4.5.1 Overall SDL architecture
The following mapping from the SDL procedures to the Intelligent Network
concepts apply:
+-----------------+------------------------+------------------------+ | SDL process | Description | SDL process | | | | specification | +-----------------+------------------------+------------------------+ | CSA_gsmSSF | Call Segment | 3GPP TS 23.078 | | | Association (CSA). The | | | | CSA SDL process | | | | distributes the CAP | | | | operations to the | | | | appropriate Call | | | | Segment(s). | | +-----------------+------------------------+------------------------+ | CS_gsmSSF | Call Segment (CS). | 3GPP TS 23.078 | | | Controls one or more | | | | BCSMs. | | +-----------------+------------------------+------------------------+ | OCH_MSC | O‑BCSM in VMSC for | 3GPP TS 23.018 | | | Mobile Originating | | | | call controlling both | | | | Leg 1 and Leg 2. | | | | | | | | If CAP Disconnect | | | | Leg (leg 2) is | | | | received at the | | | | initial detection | | | | point | | | | (Collected_Info), | | | | then the call is not | | | | routed to the | | | | destination and the | | | | process calls the | | | | procedure | | | | CAMEL_OCH_LEG1_MSC | | | | to control Leg 1. | | | | | | | | If Answer is received, | | | | the process spawns the | | | | child process | | | | CAMEL_OCH_LEG2_MSC | | | | to control Leg 2 and | | | | calls the procedure | | | | CAMEL_OCH_LEG1_MSC | | | | to control Leg 1. The | | | | handling of the legs | | | | after answer is | | | | completely separate. | | +-----------------+------------------------+------------------------+ | MT_GMSC | T‑BCSM in the GMSC | 3GPP TS 23.018 | | | controlling both Leg 1 | | | | and Leg 2. | | | | | | | | If CAP Disconnect | | | | Leg (leg 2) is | | | | received at the | | | | initial detection | | | | point | | | | (Terminating\ | | | | _Attempt_Authorised), | | | | then the call is not | | | | routed to the | | | | destination and the | | | | process spawns the | | | | child process | | | | CAMEL_MT_LEG1_GMSC | | | | to control Leg 1. The | | | | process MT_GMSC | | | | terminates. | | | | | | | | If Answer is received, | | | | the process spawns the | | | | child process | | | | CAMEL_MT_LEG1_GMSC | | | | to control Leg 1 and | | | | calls the procedure | | | | CAMEL_MT_LEG2_GMSC | | | | to control Leg 2. The | | | | handling of the legs | | | | after answer is | | | | completely separate. | | +-----------------+------------------------+------------------------+ | MT_CF_MSC | O‑BCSM in the | 3GPP TS 23.018 | | | redirecting MSC for | | | | Call Forwarding | | | | supplementary service, | | | | or Call Deflection | | | | supplementary service, | | | | or for CAMEL-based | | | | call forwarding. This | | | | process controls both | | | | Leg 1 and Leg 2. | | | | | | | | If CAP Disconnect | | | | Leg (leg 2) is | | | | received at the | | | | initial detection | | | | point | | | | (Collected_Info), | | | | then the call is not | | | | routed to the | | | | destination and the | | | | process calls the | | | | procedure | | | | CA | | | | MEL_MT_CF_LEG1_MSC | | | | to control Leg 1. | | | | | | | | If Answer is received, | | | | the process spawns the | | | | child process | | | | CA | | | | MEL_MT_CF_LEG2_MSC | | | | to control Leg 2 and | | | | calls the procedure | | | | CA | | | | MEL_MT_CF_LEG1_MSC | | | | to control Leg 1. The | | | | handling of the legs | | | | after answer is | | | | completely separate. | | +-----------------+------------------------+------------------------+ | ICH_MSC | T‑BCSM in the VMSC | 3GPP TS 23.018 | | | controlling both Leg 1 | | | | and Leg 2. | | | | | | | | If CAP Disconnect | | | | Leg (leg 2) is | | | | received at the | | | | initial detection | | | | point | | | | (Terminating\ | | | | _Attempt_Authorised), | | | | then the call is not | | | | routed to the | | | | destination and the | | | | process spawns the | | | | child process | | | | CAMEL_ICH_LEG1_MSC | | | | to control Leg 1. The | | | | process ICH_MSC | | | | terminates. | | | | | | | | If Answer is received, | | | | the process spawns the | | | | child process | | | | CAMEL_ICH_LEG1_MSC | | | | to control Leg 1 and | | | | calls the procedure | | | | CAMEL_ICH_LEG2_MSC | | | | to control Leg 2. The | | | | handling of the legs | | | | after answer is | | | | completely separate. | | +-----------------+------------------------+------------------------+ | TO_MSC | O-BCSM in the | 3GPP TS 23.018 | | | inter-connecting MSC | | | | for trunk originated | | | | calls. This process | | | | controls both Leg 1 | | | | and Leg 2. | | | | | | | | If CAP Disconnect | | | | Leg (leg 2) is | | | | received at the | | | | initial detection | | | | point | | | | (Collected_Info), | | | | then the call is not | | | | routed to the | | | | destination and the | | | | process calls the | | | | procedure | | | | CAMEL_TOC_LEG1_MSC | | | | to control Leg 1. | | | | | | | | If Answer is received, | | | | the process spawns the | | | | child process | | | | CA | | | | MEL_MT_CF_LEG2_MSC | | | | to control Leg 2 and | | | | calls the procedure | | | | CAMEL_TOC_LEG1_MSC | | | | to control Leg 1. The | | | | handling of the legs | | | | after answer is | | | | completely separate. | | +-----------------+------------------------+------------------------+ | Assisting_MSC | The process in the MSC | 3GPP TS 23.078 | | | to handle an assist | | | | request. | | +-----------------+------------------------+------------------------+ | CAMEL_ICA_MSC | O‑BCSM for gsmSCF | 3GPP TS 23.078 | | | initiated new call, or | | | | for new party set-up. | | | | This process controls | | | | the new leg. | | +-----------------+------------------------+------------------------+
The following general rules apply:
1 There is only one CSA per CAP dialogue.
2 The CSA controls one or more Call Segments.
3 A Call Segment controls one or more BCSMs. Due to Call Party Handling, legs
may be moved from one Call Segment to another and new Call Segments may be
created. When legs are moved they take their properties with them, i.e. armed
EDPs and pending reports.
4 Legs are not moved between BCSMs.
5 The active legs in the same Call Segment have a voice connection. They hear
each other and the same in-band tone and announcements. The following
exceptions exist:
\- Apply Charging IF: the warning tone associated with the Apply Charging IF
is played to a single call party in the Call Segment.
\- Play Tone IF: the flexible tone from the Play Tone IF may be played to a
single call party in the Call Segment.
The following diagrams shows the overall architecture for the SDL diagrams.
{width="5.917361111111111in" height="3.5694444444444446in"}
Figure 4.9-1: Outgoing case (gsmSSF relay)
{width="5.917361111111111in" height="3.5694444444444446in"}
Figure 4.9-2: Outgoing case (direct path gsmSCF to gsmSRF or assist with
relay)
{width="5.917361111111111in" height="3.5694444444444446in"}
Figure 4.9-3: Terminating GMSC case (gsmSSF relay)
{width="5.917361111111111in" height="3.5694444444444446in"}
Figure 4.9-4: Terminating GMSC case (direct path gsmSCF to gsmSRF or assist
with relay)
{width="5.917361111111111in" height="3.5694444444444446in"}
NOTE: The ICH_MSC may also be connected via an A interface to the terminating
Mobile Station.
Figure 4.9-5: Terminating VMSC case (gsmSSF relay)
{width="5.903472222222222in" height="3.5694444444444446in"}
NOTE: The ICH_MSC may also be connected via an A interface to the terminating
Mobile Station
Figure 4.9-6: Terminating VMSC case (direct path gsmSCF to gsmSRF or assist
with relay)
{width="5.917361111111111in" height="3.5694444444444446in"}
Figure 4.9-7: Assisting case
{width="5.917361111111111in" height="3.5694444444444446in"}
Figure 4.9-8: gsmSCF initiated call case (gsmSSF relay)
{width="5.997222222222222in" height="4.134722222222222in"}
Figure 4.9-9: Trunk Originating case (gsmSSF relay)
### 4.5.2 Handling of mobile originated calls
#### 4.5.2.1 Handling of mobile originated calls in the originating MSC
The functional behaviour of the originating VMSC is specified in 3GPP TS
23.018 [12]. The procedures specific to CAMEL are specified in this subclause:
\- Procedure CAMEL_OCH_MSC_INIT;
\- Procedure CAMEL_MO_Dialled_Services;
\- Procedure CAMEL_OCH_MSC_ALERTING;
\- Procedure CAMEL_OCH_MSC_ANSWER;
\- Procedure CAMEL_OCH_MSC1;
\- Procedure CAMEL_OCH_MSC2;
\- Procedure CAMEL_OCH_MSC_DISC1;
\- Procedure CAMEL_OCH_MSC_DISC2;
\- Procedure CAMEL_OCH_MSC_DISC3;
\- Procedure CAMEL_OCH_MSC_DISC4;
\- Procedure CAMEL_Disconnect_CTR_SRF;
\- Procedure CAMEL_OCH_ETC;
\- Procedure CAMEL_OCH_CTR;
\- Procedure CAMEL_Start_TNRy;
\- Procedure CAMEL_Stop_TNRy;
\- Procedure CAMEL_Store_Destination_Address;
\- Procedure CAMEL_Modify_CUG_Info;
\- Procedure CAMEL_N_CSI_CHECK_MSC;
\- Procedure CAMEL_OCH_LEG1_MSC;
\- Procedure CHECK_DIGIT_STRING_MSC;
\- Process CAMEL_OCH_LEG2_MSC;
\- Process CAMEL_OCH_RECONNECT_MSC;
\- Procedure CAMEL_EXPORT_LEG_MSC;
\- Process CAMEL_O_CHANGE_OF_POSITION_MSC;
\- Procedure CAMEL_O_SCUDIF_MSC.
NOTE: Procedure CAMEL_OCH_MSC_DISC3 applies to CAMEL Phase 1 only.
The procedure Send_Access_Connect_If_Required is specified in 3GPP TS 23.018
[12].
The procedure CAMEL_OCH_LEG1_MSC supervises the originating party only. The
process CAMEL_OCH_LEG2_MSC supervises the terminating party only. Hence,
signals from the BSS are received by the procedure CAMEL_OCH_LEG1_MSC and
signals from the destination exchange are received by the process
CAMEL_OCH_LEG2_MSC.
The following paragraphs give details on the behaviour of the MSC in the
procedures CAMEL_OCH_MSC_INIT, CAMEL_OCH_ETC, CAMEL_OCH_ANSWER and
CAMEL_Store_Destination_Address.
##### 4.5.2.1.1 Actions of the MSC on receipt of Int_Error
The MSC checks the default Call Handling parameter in the relevant CSI.
If the default call handling is release call, a Release is sent to the MS and
an Abort to the VLR. The MSC then releases all call resources and the
procedure CAMEL_OCH_MSC_INIT ends.
If the default call handling is continue call, the MSC continues processing
without CAMEL support. It sends Send_Info_For_Ougoing_Call to the VLR and
waits in state Wait_For_MO_Call_Result.
##### 4.5.2.1.2 Actions of the MSC on receipt of Int_Continue
The MSC continues processing without any modification of call parameters. At
DP Analysed_Information it sends Send Info For Ougoing Call information flow
to the VLR and waits in state Wait_For_MO_Call_Result.
##### 4.5.2.1.3 Actions of the MSC on receipt of Int_Continue_With_Argument
The MSC continues processing with modified call parameters. The MSC shall
replace the call parameters by the information received in the
Int_Continue_With_Argument signal. Call parameters which are not included in
the Int_Continue_With_Argument signal are unchanged.
Signalling limitations or regulatory requirements may require the Calling
Partys Category, Generic Number, Original Called Party Number and Redirecting
Party ID to be ignored or modified.
##### 4.5.2.1.4 Actions of the MSC on receipt of Int_Connect
The MSC continues processing with modified call parameters. The MSC shall
transparently modify the call parameters with the received information. The
MSC then sends a PROGRESS message to the MS. Call parameters which are not
included in the Int_Connect signal are unchanged.
Signalling limitations or regulatory requirements may require the Calling
Partys Category, Generic Number, Original Called Party Number and Redirecting
Party ID to be ignored or modified.
The network signalling system shall indicate that this is an internal network
number.
At DP Collected_Information the MSC sets the O‑CSI suppression parameter. If
D‑CSI and N‑CSI are not present, the MSC sends a Send Info For Outgoing Call
to the VLR and waits in state Wait_For_MO_Call_Result.
At DP Analysed_Information it sets the D‑CSI suppression parameter, sends a
Send Info For Outgoing Call to the VLR and waits in state
Wait_For_MO_Call_Result.
##### 4.5.2.1.5 Actions of the MSC on receipt of Int_Release_Call
A Release is sent to the MS, an abort to the VLR and a Release is sent to the
destination exchange. The release cause received in the Int_Release_Call
signal is used. The MSC then releases all call resources and the procedure
CAMEL_OCH_MSC_INIT ends.
##### 4.5.2.1.6 Actions of the MSC on receipt of Int_Disconnect_Leg (Leg 2)
If the MSC receives Int_Disconnect_Leg (Leg 2) signal from the gsmSSF, in
response to an Initial DP information flow, the MSC will continue the handling
of the calling party (Leg1) without routeing the call to a destination.
##### 4.5.2.1.7 Actions of the MSC on receipt of Int_Apply_Warning_Tone
This section applies to all call cases. The MSC will play a tone to the
indicated leg or call segment.
The following special cases exist when there is already an existing tone to a
leg or call segment:
1 If the MSC is playing a tone to a leg and the Int_Apply_Warning_Tone
instructs the MSC to play a tone for another leg (in the same or a different
call segment), then the tones will be played independently;
2 The tones for different call segments are independent;
3 If the MSC is playing a tone to a leg and the Int_Apply_Warning_Tone
instructs the MSC to play another tone for that leg, then the MSC will stop
the existing tone and the latter tone will be played for that leg.
4 If the MSC is playing a tone to a call segment and the
Int_Apply_Warning_Tone instructs the MSC to play another tone for that call
segment, then the MSC will stop the existing tone and the latter tone will be
played for that call segment.
5 If the MSC is playing a tone for the call segment and the
Int_Apply_Warning_Tone instructs the MSC to play another tone for a leg in
that call segment, then the particular leg shall hear (as an MSC option)
either:
a The latter tone only, or
b Two tones. As an MSC option, the two tones may be played in parallel or in a
sequence.
> The other leg(s) shall keep hearing the (old) call segment tone.
6 If the MSC is playing a tone for a leg and the Int_Apply_Warning_Tone
instructs the MSC to play another tone for that call segment, then the
particular leg shall either hear (as an MSC option):
a The latter tone only, or
b Two tones. As an MSC option, the two tones may be played in parallel or in a
sequence.
> The other leg(s) shall start hearing the new call segment tone.
##### 4.5.2.1.8 Action of the MSC in procedure CAMEL_OCH_MSC_ANSWER
If the MSC received a destination address from the GMSC in the ISUP Answer or
Connect Message, the MSC relays the destination address to the gsmSSF in the
Int_DP_O_Answer signal.
NOTE 1: The sending of e-parameters by the gsmSCF after receiving the
DP_O_Answer indication may be to late.
NOTE 2: If the MO call is not subject to Basic OR, then the destination
address is generated by the MSC. If the MO call is subject to Basic OR, the
MSC will receive a destination address from the GMSC in the ISUP Answer or
Connect Message.
##### 4.5.2.1.9 Action of the MSC in procedure CAMEL_OCH_ETC
In procedure CAMEL_OCH_ETC (sheet 2) the MSC will remain in the
Wait_For_Assisting_Answer state until it receives an ISUP Answer Message (ANM)
or timeout occurs. This is to ensure that a call record is always generated
for every successful establishment of a temporary connection to a gsmSRF,
especially in the case where the connection is between PLMNs.
NOTE: This means that it may not be possible to access an SRF which does not
generate an ISUP Answer Message (ANM).
If a Progress Message is sent towards the MS the progress indicator shall
indicate \"In Band Information\".
##### 4.5.2.1.10 Procedure CAMEL_OCH_LEG1_MSC
The Int_DTMF_Digit_Received information flow is received from an internal
process in the MSC that receives DTMF signalling from the MS. The handling of
the internal process that receives DTMF signalling is out of scope of the
present document. The playing of the received DTMF tones to the other parties
in the call segment is out of scope of the present document.
##### 4.5.2.1.11 Process CAMEL_O_CHANGE_OF_POSITION_MSC
The signals HANDOVER COMPLETE and HANDOVER PERFORMED are specified in 3GPP TS
48.008 [39]. Signals RELOCATION REQUEST ACKNOWLEDGE, LOCATION REPORT and
LOCATION REPORTING COMMAND are specified in 3GPP TS 25.413 [33].
##### 4.5.2.1.12 Procedure CAMEL_Start_TNRy
The recommended value range in the gsmSSF for the default TNRy timer for CAMEL
handling is 10 seconds to 3 minutes.
The CSE provided TNRy value is applied only once per outgoing leg. The
decision \"TNRy received?\" decision box goes to \"No\" branch if the TNRy
duration has been used for once and no new timer value has been received since
previous call of this procedure.
The task box \"Cancel TNRy received\" ensures that the gsmSCF provided timer
is applied only once per call leg. The task box prevents the use of previously
received timer value from the gsmSCF in subsequent calls (e.g. as in the case
of a follow-on call).
For example: The gsmSCF arms O_No_Answer EDP and also sent a TNRy timer
duration. The call fails and EDP O_No_Answer is reported to the gsmSCF. The
gsmSCF sends a Connect (i.e. follow-on call), and also arms EDP O_No_Answer,
but this time, with no TNRy timer duration included. The gsmSSF does not use
the TNRy timer previously provided by the gsmSCF. Instead, the network's
default TNRy timer is used if available for the follow-on call.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.10-1: Procedure CAMEL_OCH_MSC_INIT (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.10-2: Procedure CAMEL_OCH_MSC_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.10-3: Procedure CAMEL_OCH_MSC_INIT (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.10-4: Procedure CAMEL_OCH_MSC_INIT (sheet 4)
{width="6.692361111111111in" height="8.579166666666667in"}
Figure 4.11-1: Procedure CAMEL_MO_Dialled_Services (sheet 1)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.11-2: Procedure CAMEL_MO_Dialled_Services (sheet 2)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.11-3: Procedure CAMEL_MO_Dialled_Services (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.12-1: Procedure CAMEL_SDS_MO_Init (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.12-2: Procedure CAMEL_SDS_MO_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.12-3: Procedure CAMEL_SDS_MO_INIT (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.12-4: Procedure CAMEL_SDS_MO_INIT (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.13-1: Procedure CAMEL_NDS_MO_INIT (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.13-2: Procedure CAMEL_NDS_MO_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.13-3: Procedure CAMEL_NDS_MO_INIT (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.13-4: Procedure CAMEL_NDS_MO_INIT (sheet 4)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.14-1: Procedure CAMEL_OCH_MSC_ALERTING (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.14-2: Procedure CAMEL_OCH_MSC_ALERTING (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.14-3: Procedure CAMEL_OCH_MSC_ALERTING (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.15-1: Procedure CAMEL_OCH_MSC_ANSWER (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.15-2: Procedure CAMEL_OCH_ANSWER (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.15-3: Procedure CAMEL_OCH_ANSWER (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.16-1: Procedure CAMEL_OCH_MSC1 (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.16-2: Procedure CAMEL_OCH_MSC1 (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.16-3: Procedure CAMEL_OCH_MSC1 (sheet 3)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.17-1: Procedure CAMEL_OCH_MSC2 (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.17-2: Procedure CAMEL_OCH_MSC2 (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.17-3: Procedure CAMEL_OCH_MSC2 (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.18-1: Procedure CAMEL_OCH_MSC_DISC1 (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.19-1: Procedure CAMEL_OCH_MSC_DISC2 (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.19-2: Procedure CAMEL_OCH_MSC_DISC2 (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.20-1: Procedure CAMEL_OCH_MSC_DISC3 (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.21-1: Procedure CAMEL_OCH_MSC_DISC4 (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.22-1: Procedure CAMEL_Disconnect_CTR_SRF (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.23-1: Procedure CAMEL_OCH_ETC (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.23-2: Procedure CAMEL_OCH_ETC (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.23-3: Procedure CAMEL_OCH_ETC (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.23-4: Procedure CAMEL_OCH_ETC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.24-1: Procedure CAMEL_OCH_CTR (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.24-2: Procedure CAMEL_OCH_CTR (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.24-3: Procedure CAMEL_OCH_CTR (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.24-4: Procedure CAMEL_OCH_CTR (sheet 4)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.24-5: Procedure CAMEL_OCH_CTR (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.25-1: Procedure CAMEL_Start_TNRy (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.26-1: Procedure CAMEL_Stop_TNRy (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.27-1: Procedure CAMEL_Store_Destination_Address (sheet 1)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.28-1: Procedure CAMEL_Modify_CUG_Info (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.29-1: Procedure CAMEL_N_CSI_CHECK_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-1: Procedure CAMEL_OCH_LEG1_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-2: Procedure CAMEL_OCH_LEG1_MSC (sheet 2)
{width="6.691666666666666in" height="9.040277777777778in"}
Figure 4.30-3: Procedure CAMEL_OCH_LEG1_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-4: Procedure CAMEL_OCH_LEG1_MSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-5: Procedure CAMEL_OCH_LEG1_MSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-6: Procedure CAMEL_OCH_LEG1_MSC (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-7: Procedure CAMEL_OCH_LEG1_MSC (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-8: Procedure CAMEL_OCH_LEG1_MSC (sheet 8)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-9: Procedure CAMEL_OCH_LEG1_MSC (sheet 9)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-10: Procedure CAMEL_OCH_LEG1_MSC (sheet 10)
{width="6.29375in" height="8.134722222222223in"}
Figure 4.30-11: Procedure CAMEL_OCH_LEG1_MSC (sheet 11)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-12: Procedure CAMEL_OCH_LEG1_MSC (sheet 12)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.30-13: Procedure CAMEL_OCH_LEG1_MSC (sheet 13)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.31-1: Procedure CHECK_DIGIT_STRING_MSC (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.32-1: Process CAMEL_OCH_LEG2_MSC (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.32-2: Process CAMEL_OCH_LEG2_MSC (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-1: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-2: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-3: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-4: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 4)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-5: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 5)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-6: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 6)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-7: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 7)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-8: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 8)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.33-9: Procedure CAMEL_OCH_RECONNECT_MSC (sheet 9)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.34-1: Procedure CAMEL_EXPORT_LEG_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.34-2: Procedure CAMEL_EXPORT_LEG_MSC (sheet 2)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.35-1: Process CAMEL_CHANGE_OF_POSITION_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.36-1: Process CAMEL_O_CHANGE_OF_POSITION_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.36-2: Process CAMEL_O_CHANGE_OF_POSITION_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.37-1: Procedure Check_Criteria_Change_Of_Position (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.38-1: Procedure CAMEL_O_SCUDIF_MSC (sheet 1)
#### 4.5.2.2 Handling of mobile originating calls in the originating VLR
The functional behaviour of the originating VLR is specified in 3GPP TS 23.018
[12]. The procedure specific to CAMEL are specified in this subclause:
\- Procedure CAMEL_OCH_VLR;
\- Process CAMEL_Reconnected_Call_VLR.
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.39-1: Procedure CAMEL_OCH_VLR (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.40-1: Process CAMEL_Reconnected_Call_VLR (sheet 1)
### 4.5.3 Retrieval of routeing information
#### 4.5.3.1 Retrieval of routeing information in the GMSC
The functional behaviour of the GMSC is specified in 3GPP TS 23.018 [12]. The
procedures specific to CAMEL are specified in this subclause:
\- Procedure CAMEL_Set_ORA_Parameters;
\- Procedure CAMEL_MT_GMSC_INIT;
\- Procedure CAMEL_MT_MSC_ALERTING;
\- Procedure CAMEL_MT_GMSC_ANSWER;
\- Procedure CAMEL_MT_GMSC_DISC1;
\- Procedure CAMEL_MT_GMSC_DISC2;
\- Procedure CAMEL_MT_GMSC_DISC3;
\- Procedure CAMEL_MT_GMSC_DISC4;
\- Procedure CAMEL_MT_GMSC_DISC5;
\- Procedure CAMEL_MT_GMSC_DISC6;
\- Procedure CAMEL_MT_CTR;
\- Procedure CAMEL_MT_ETC;
\- Procedure CAMEL_Start_TNRy;
\- Procedure CAMEL_Stop_TNRy;
\- Procedure CAMEL_MT_GMSC_Notify_CF;
\- Procedure CAMEL_MT_LEG2_GMSC;
\- Process CAMEL_MT_LEG1_GMSC;
\- Procedure CAMEL_MT_RECONNECT_GMSC;
\- Procedure CAMEL_T_SCUDIF_MSC.
NOTE: Procedure CAMEL_MT_GMSC_DISC3 applies to CAMEL Phase 1 only.
The procedure Send_ACM_If_Required is specified in 3GPP TS 23.018 [12].
The procedure CAMEL_MT_LEG2_GMSC supervises the terminating party only. The
process CAMEL_MT_LEG1_GMSC supervises the originating party only. Hence,
signals from the destination exchange are received by the procedure
CAMEL_MT_LEG2_GMSC and signals from the originating exchange are received by
the process CAMEL_MT_LEG1_GMSC.
The following paragraphs give details on the behaviour of the GMSC in the
procedure CAMEL_MT_GMSC_INIT.
##### 4.5.3.1.1 Action of the GMSC on receipt of Int_Release_Call
An ISUP Release message is sent to the originating exchange and resources are
released.
##### 4.5.3.1.2 Action of the GMSC on receipt of Int_Error
The GMSC checks the default call handling parameter in the T‑CSI.
If the default call handling is release call, an ISUP Release message is sent
to the originating exchange. The MSC then releases all call resources and the
procedure CAMEL_MT_GMSC_INIT returns result=fail.
If the default call handling is continue call, the MSC continues call handling
without CAMEL support.
##### 4.5.3.1.3 Action of the GMSC on receipt of Int_Continue
If an FTN has been stored then the information received from the HLR is used
to overwrite the corresponding call parameters. Note that the MSISDN is
replaced by the FTN as the called party number. The redirection counter is
incremented.
If no FTN has been stored then a Send Routeing Info information flow including
a T‑CSI suppression parameter is sent to the HLR. The Send Routing Info
information flow includes an indication of which CAMEL Phases are supported by
the GMSC/gsmSSF.
##### 4.5.3.1.4 Action of the GMSC on receipt of Int_Continue_With_Argument
If an FTN has been stored then the information received from the HLR is used
to overwrite the corresponding call parameters. The MSISDN is replaced by the
FTN as the called party number. The redirection counter is incremented.
If no FTN has been stored then a Send Routeing Info information flow including
a T‑CSI suppression parameter is sent to the HLR. The Send Routing Info
information flow includes an indication of which CAMEL phases are supported by
the GMSC/gsmSSF.
The MSC shall replace the call parameters by the information received in the
Int_Continue_With_Argument signal. Call parameters which are not included in
the Int_Continue_With_Argument message are unchanged.
Signalling limitations or regulatory requirements may require the Calling
Partys Category, Generic Number, Original Called Party Number and Redirecting
Party ID to be ignored or modified.
##### 4.5.3.1.5 Action of the GMSC on receipt of Int_Connect
If the Destination Number received from the gsmSCF (via the gsmSSF) is the
same as the ISUP called party number, i.e. the MSISDN, the following
parameters, if received, are used to overwrite the corresponding ISUP
parameters (for mapping see 3GPP TS 29.078 [36]): Calling Partys Category and
Generic Number. If received, the Announcement Suppression Indicator is stored.
The further processing is described in subclause 4.5.3.1.3 with the addition
that the Announcement Suppression indicator, if stored, is sent to the HLR in
the Send Routeing Info message.
If:
\- the Destination Number received from the gsmSCF (via the gsmSSF) is not the
same as the stored ISUP called party number, i.e. the MSISDN, and
\- a CUG active indication was received from the HLR, and
\- CUG information was received in the ISUP IAM for the incoming call;
then an exception event is reported to the process CS_gsmSSF, an ISUP Release
Message is sent to the originating exchange. The MSC then releases all call
resources and the procedure CAMEL_MT_GMSC_INIT returns result=fail.
Otherwise the following parameters, if received, are used to overwrite the
corresponding ISUP parameters (for mapping see 3GPP TS 29.078 [36]):
Destination Number, Calling Partys Category, Generic Number, Original Called
Party ID, Redirecting Party ID and Redirection Information. Call parameters
that are not included in the Int_Connect signal are unchanged.
As a network operator option loop prevention mechanisms may cause the
redirection information to be ignored or modified (e.g., if the Redirection
counter has been decreased).
Signalling limitations or regulatory requirements may require the Calling
Partys Category, Generic Number, Original Called Party Number and Redirecting
Party ID to be ignored or modified.
The network signalling system shall indicate that this is an internal network
number.
##### 4.5.3.1.6 Action of the GMSC on receipt of Send_Routeing_Info Negative
Response (in state Wait_For_Routeing_Info_2)
An exception event is reported to the process CS_gsmSSF. If the Announcement
Suppression indicator has been received from the gsmSCF (via the gsmSSF) any
announcements or tones shall be suppressed.
##### 4.5.3.1.7 Action of the GMSC on receipt of Send_Routeing_Info ack with
MSRN (in state Wait_For_Routeing_Info_2)
An ISUP IAM with the MSRN as the called party number is constructed.
##### 4.5.3.1.8 Action of the GMSC on receipt of Send_Routeing_Info ack with
FTN (in state Wait_For_Routeing_Info_2)
The information received from the HLR is used to overwrite the corresponding
call parameters (for details see 3GPP TS 23.018 [12]). The redirection counter
is incremented.
##### 4.5.3.1.9 Action of the GMSC on receipt of Send_Routeing_Info ack with
O‑CSI and/or D‑CSI and FTN (at state Wait_For_Routeing_Info_2)
The information received from the HLR is used to overwrite corresponding call
parameters. The redirection counter is incremented. The Called Party Number is
set to the FTN. The O‑CSI and/or D‑CSI is stored.
##### 4.5.3.1.10 Action of the GMSC in procedure CAMEL_MT_ETC
In the procedure CAMEL_MT_ETC (sheet 2) the GMSC will remain in the
Wait_For_Assiting_Answer state until it receives an ISUP Answer Message (ANM)
or timeout occurs. This is to ensure that a call record is always generated
for every successful establishment of a temporary connection to a gsmSRF,
especially in the case where the connection is between PLMNs.
NOTE: This means that it may not be possible to access an SRF which does not
generate an ISUP Answer Message (ANM).
If a Progress Message is sent towards the MS the progress indicator shall
indicate \"In Band Information\".
##### 4.5.3.1.11 Action of the GMSC in procedure CAMEL_MT_GMSC_Notify_CF
The Forwarding reason is taken from the Send Routeing Info ack information
flow (for early call forwarding) or the Resume Call Handling information flow
(for Optimal Routeing of Late Call Forwarding).
The Int_DP_T_No_Answer signal and Int_DP_T_Busy signal include a parameter to
indicate that the call has encountered conditional call forwarding. The gsmSSF
will transfer this parameter to the Event Report BCSM information flow which
it sends to the gsmSCF.
##### 4.5.3.1.12 Action of the MSC on receipt of Int_Disconnect_Leg (Leg 2)
If the MSC receives Int_Disconnect_Leg (Leg 2) signal from the gsmSSF, in
response to an Initial DP information flow, the MSC will continue the handling
of the calling party (Leg1) without routeing the call to a destination.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.41-1: Procedure CAMEL_Set_ORA_Parameters (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.42-1: Procedure CAMEL_MT_GMSC_INIT (sheet 1)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.42-2: Procedure CAMEL_MT_GMSC_INIT (sheet 2)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.42-3: Procedure CAMEL_MT_GMSC_INIT (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.42-4: Procedure CAMEL_MT_GMSC_INIT (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.42-5: Procedure CAMEL_MT_GMSC_INIT (sheet 5)
{width="6.6506944444444445in" height="8.595833333333333in"}
Figure 4.42-6: Procedure CAMEL_MT_GMSC_INIT (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.42-7: Procedure CAMEL_MT_GMSC_INIT (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.42-8: Procedure CAMEL_MT_GMSC_INIT (sheet 8)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.43-1: Procedure CAMEL_MT_MSC_ALERTING (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.43-2: Procedure CAMEL_MT_MSC_ALERTING (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.43-3: Procedure CAMEL_MT_MSC_ALERTING (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.44-1: Procedure CAMEL_MT_GMSC_ANSWER (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.44-2: Procedure CAMEL_MT_GMSC_ANSWER (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.44-3: Procedure CAMEL_MT_GMSC_ANSWER (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.45-1: Procedure CAMEL_MT_GMSC_DISC1 (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.46-1: Procedure CAMEL_MT_GMSC_DISC2 (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.46-2: Procedure CAMEL_MT_GMSC_DISC2 (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.47-1: Procedure CAMEL_MT_GMSC_DISC3 (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.48-1: Procedure CAMEL_MT_GMSC_DISC4 (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.48-2: Procedure CAMEL_MT_GMSC_DISC4 (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.48-3: Procedure CAMEL_MT_GMSC_DISC4 (sheet 3)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.49-1: Procedure CAMEL_MT_GMSC_DISC5 (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.49-2: Procedure CAMEL_MT_GMSC_DISC5 (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.49-3: Procedure CAMEL_MT_GMSC_DISC5 (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.50-1: Procedure CAMEL_MT_GMSC_DISC6 (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.51-1: Procedure CAMEL_MT_ETC (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.51-2: Procedure CAMEL_MT_ETC (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.51-3: Procedure CAMEL_MT_ETC (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.51-4: Procedure CAMEL_MT_ETC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.52-1: Procedure CAMEL_MT_CTR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.52-2: Procedure CAMEL_MT_CTR (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.52-3: Procedure CAMEL_MT_CTR (sheet 3)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.52-4: Procedure CAMEL_MT_CTR (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.52-5: Procedure CAMEL_MT_CTR (sheet 5)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.53-1: Procedure CAMEL_MT_GMSC_Notify_CF (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.53-2: Procedure CAMEL_MT_GMSC_Notify_CF (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.54-1: Procedure CAMEL_MT_LEG2_GMSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.54-2: Procedure CAMEL_MT_LEG2_GMSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.54-3: Procedure CAMEL_MT_LEG2_GMSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.55-1: Process CAMEL_MT_LEG1_GMSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.55-2: Process CAMEL_MT_LEG1_GMSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.55-3: Process CAMEL_MT_LEG1_GMSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.55-4: Process CAMEL_MT_LEG1_GMSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.55-5: Process CAMEL_MT_LEG1_GMSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.56-1: Procedure CAMEL_MT_RECONNECT_GMSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.56-2: Procedure CAMEL_MT_RECONNECT_GMSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.56-3: Procedure CAMEL_MT_RECONNECT_GMSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.56-4: Procedure CAMEL_MT_RECONNECT_GMSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.56-5: Procedure CAMEL_MT_RECONNECT_GMSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.56-6: Procedure CAMEL_MT_RECONNECT_GMSC (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.56-7: Procedure CAMEL_MT_RECONNECT_GMSC (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.57-1: Procedure CAMEL_T_SCUDIF_MSC (sheet 1)
#### 4.5.3.2 Retrieval of routeing information in the HLR
The functional behaviour of the HLR is specified in 3GPP TS 23.018 [12]. The
procedures specific to CAMEL are specified in this subclause:
\- Procedure CAMEL_HLR_INIT;
\- Procedure CAMEL_CSI_Check_HLR;
\- Procedure CAMEL_O_CSI_CHECK_HLR;
\- Procedure CAMEL_D_CSI_CHECK_HLR;
\- Procedure CAMEL_T_CSI_CHECK_HLR;
> \- Procedure CAMEL_CHECK_SII2_CDTI.
The procedure CAMEL_Provide_Subscriber_Info is specified in subclause 4.5.9.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.58-1: Procedure CAMEL_HLR_INIT (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.58-2: Procedure CAMEL_HLR_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.59-1: Procedure CAMEL_CSI_Check_HLR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.60-1: Procedure CAMEL_O_CSI_CHECK_HLR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.61-1: Procedure CAMEL_D_CSI_CHECK_HLR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.62-1: Procedure CAMEL_T_CSI_CHECK_HLR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.63-1: Procedure CAMEL_CHECK_SII2_CDTI (sheet 1)
#### 4.5.3.3 Handling of provide roaming number request in the VLR
The functional behaviour of the VLR is specified in 3GPP TS 23.018 [12]. The
procedure specific to CAMEL is specified in this subclause:
\- Procedure CAMEL_SET_SOA.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.64-1: Procedure CAMEL_SET_SOA (sheet 1)
### 4.5.4 Handling of mobile terminating calls
#### 4.5.4.1 Handling of mobile terminating calls in the terminating VMSC
The functional behaviour of the terminating VMSC is specified in 3GPP TS
23.018 [12].
The behaviour specific to CAMEL is:
\- the inclusion of the O‑CSI and/or D‑CSI parameter in the Perform Call
Forwarding information flow sent to the process MT_CF_MSC if O‑CSI and/or
D‑CSI was received in the Send Info For Incoming Call ack information flow;
\- the requirement to suppress the connection of announcements or tones if the
VLR includes the suppression of announcements parameter in the Send Info For
Incoming Call negative response information flow.
The processes and procedures specific to CAMEL are specified in this
subclause:
\- Procedure CAMEL_ICH_VLR;
\- Procedure CAMEL_O_CSI_Check_VLR;
\- Procedure CAMEL_D_CSI_Check_VLR;
\- Procedure CAMEL_VT_CSI_Check_VLR;
\- Procedure CAMEL_ICH_MSC_INIT;
\- Procedure CAMEL_MT_VMSC_Notify_CF;
\- Procedure CAMEL_ICH_LEG2_MSC;
\- Procedure CAMEL_ICH_LEG2_CF_MSC;
\- Process CAMEL_ICH_LEG1_MSC;
\- Procedure CAMEL_ICH_RECONNECT_MSC;
\- Process CAMEL_T_CHANGE_OF_POSITION_MSC.
The procedure CAMEL_ICH_LEG2_MSC supervises the terminating party only. The
procedure CAMEL_ICH_LEG2_CF_MSC supervises the forwarded-to party only. The
process CAMEL_ICH_LEG1_MSC supervises the originating party only. Hence,
signals from the BSS are received by the procedure CAMEL_ICH_LEG2_MSC, signals
from the destination exchange are received by the procedure
CAMEL_ICH_LEG2_CF_MSC and signals from the originating exchange are received
by the process CAMEL_ICH_LEG1_MSC.
##### 4.5.4.1.1 Action of the VMSC in procedure CAMEL_MT_VMSC_Notify_CF
The Forwarding reason is taken from the Complete Call information flow from
the VLR.
The Int_DP_T_No_Answer signal and Int_DP_T_Busy signal include a parameter to
indicate that the call has encountered conditional call forwarding. The gsmSSF
will transfer this parameter to the Event Report BCSM information flow which
it sends to the gsmSCF.
##### 4.5.4.1.2 Action of MSC on receipt of Int_Disconnect_Leg (Leg 2)
If the MSC receives Int_Disconnect_Leg (Leg 2) signal from the gsmSSF, in
response to an Initial DP information flow, the MSC will continue the handling
of the calling party (Leg1) without routeing the call to a destination.
##### 4.5.4.1.3 Procedure CAMEL_ICH_LEG2_MSC
The Int_DTMF_Digit_Received information flow is received from an internal
process in the MSC that receives DTMF signalling from the MS. The handling of
the internal process that receives DTMF signalling is out of scope of the
present document. The playing of the received DTMF tones to the other parties
in the call segment is out of scope of the present document.
##### 4.5.4.1.4 Process CAMEL_T_CHANGE_OF_POSITION_MSC
The signals HANDOVER COMPLETE and HANDOVER PERFORMED are specified in 3GPP TS
48.008 [39]. Signals RELOCATION REQUEST ACKNOWLEDGE, LOCATION REPORT and
LOCATION REPORTING COMMAND are specified in 3GPP TS 25.413 [33].
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.65-1: Procedure CAMEL_ICH_VLR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.66-1: Procedure CAMEL_O_CSI_Check_VLR (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.67-1: Procedure CAMEL_D_CSI_Check_VLR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.68-1: Procedure CAMEL_VT_CSI_Check_VLR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.69-1: Procedure CAMEL_ICH_MSC_INIT (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.69-2: Procedure CAMEL_ICH_MSC_INIT (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.69-3: Procedure CAMEL_ICH_MSC_INIT (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.69-4: Procedure CAMEL_ICH_MSC_INIT (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.69-5: Procedure CAMEL_ICH_MSC_INIT (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.70-1: Procedure CAMEL_MT_VMSC_Notify_CF (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.70-2: Procedure CAMEL_MT_VMSC_Notify_CF (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-1: Procedure CAMEL_ICH_LEG2_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-2: Procedure CAMEL_ICH_LEG2_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-3: Procedure CAMEL_ICH_LEG2_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-4: Procedure CAMEL_ICH_LEG2_MSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-5: Procedure CAMEL_ICH_LEG2_MSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-6: Procedure CAMEL_ICH_LEG2_MSC (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-7: Procedure CAMEL_ICH_LEG2_MSC (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-8: Procedure CAMEL_ICH_LEG2_MSC (sheet 8)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.71-9: Procedure CAMEL_ICH_LEG2_MSC (sheet 9)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.72-1: Process CAMEL_ICH_LEG2_CF_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.72-2: Process CAMEL_ICH_LEG2_CF_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.73-1: Process CAMEL_ICH_LEG1_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.73-2: Process CAMEL_ICH_LEG1_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.73-3: Process CAMEL_ICH_LEG1_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.73-4: Process CAMEL_ICH_LEG1_MSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.73-5: Process CAMEL_ICH_LEG1_MSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.74-1: Procedure CAMEL_ICH_RECONNECT_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.74-2: Procedure CAMEL_ICH_RECONNECT_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.74-3: Procedure CAMEL_ICH_RECONNECT_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.74-4: Procedure CAMEL_ICH_RECONNECT_MSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.74-5: Procedure CAMEL_ICH_RECONNECT_MSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.74-6: Procedure CAMEL_ICH_RECONNECT_MSC (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.74-7: Procedure CAMEL_ICH_RECONNECT_MSC (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.75-1: Process CAMEL_T_CHANGE_OF_POSITION_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.75-2: Procedure CAMEL_T_CHANGE_OF_POSITION_MSC (sheet 2)
#### 4.5.4.2 Handling of mobile terminating calls in the VLR
The functional behaviour of the terminating VLR is specified in 3GPP TS 23.018
[12]. The process specific to CAMEL is specified in this subclause:
\- Process Reconnected_MT_Call_VLR.
The behaviour specific to CAMEL is:
\- the inclusion of the O‑CSI and/or D‑CSI parameter in the Send Info For
Incoming Call ack information flow if the call is to be forwarded and O‑CSI
and/or D‑CSI is included in the subscriber data for that subscriber in the
VLR;
\- the inclusion of the suppression of announcements parameter in the Send
Info For Incoming Call negative response information flow if it was received
in the Provide Roaming Number information flow from the HLR.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.76-1: Process Reconnected_MT_Call_VLR (sheet 1)
### 4.5.5 Handling of forwarded calls
The handling of forwarded calls in the GMSC or the terminating VMSC is
specified in 3GPP TS 23.018 [12]. The processes and procedures specific to
CAMEL are specified in this subclause.
\- Procedure CAMEL_Check_ORLCF_VMSC;
\- Procedure CAMEL_CF_MSC_INIT;
\- Procedure CAMEL_CF_MSC_ALERTING;
\- Procedure CAMEL_CF_MSC_ANSWER;
\- Procedure CAMEL_CF_ETC;
\- Procedure CAMEL_CF_CTR;
\- Procedure CAMEL_MT_CF_LEG1_MSC;
\- Process CAMEL_MT_CF_LEG2_MSC;
\- Procedure CAMEL_MF_RECONNECT_MSC.
The procedure CAMEL_MT_CF_LEG1_MSC supervises the originating party only. The
process CAMEL_MT_CF_LEG2_MSC supervises the forwarding-to party only. Hence,
signals from the originating exchange are received by the procedure
CAMEL_MT_CF_LEG1_MSC and signals from the destination exchange are received by
the process CAMEL_MT_CF_LEG2_MSC.
A mobile terminated call can be forwarded either in the GMSC (indicated by
provision of Forwarded-To-Number from the HLR or gsmSCF) or in the MSC
(indicated by provision of Forwarded-To-Number from the VLR).
#### 4.5.5.1 Procedure CAMEL_CF_MSC_INIT: handling of
Int_Continue_With_Argument
The received parameters are used to overwrite the corresponding ISUP
parameters (for mapping see 3GPP TS 29.078 [36]). Call parameters which are
not included in the Int_Continue_With_Argument signal are unchanged.
Signalling limitations or regulatory requirements may require the Calling
Partys Category, Generic Number, Original Called Party Number and Redirecting
Party ID to be ignored or modified.
#### 4.5.5.2 Procedure CAMEL_CF_MSC_INIT: handling of Int_Connect
The received parameters are used to overwrite the corresponding ISUP
parameters (for mapping see 3GPP TS 29.078 [36]. Call parameters which are not
included in the Int_Connect signal are unchanged.
As a network operator option, loop prevention mechanisms may cause the
redirection information to be ignored or modified (e.g., if the Redirection
counter has been decreased).
Signalling limitations or regulatory requirements may require the Calling
Partys Category, Generic Number, Original Called Party Number and Redirecting
Party ID to be ignored or modified.
The network signalling system shall indicate that this is an internal network
number.
#### 4.5.5.3 Procedure CAMEL_CF_MSC_INIT: handling of Int_Disconnect_Leg (Leg
2)
If the MSC receives Int_Disconnect_Leg (Leg 2) signal from the gsmSSF, in
response to an Initial DP information flow, the MSC will continue the handling
of the calling party (Leg1) without routeing the call to a destination.
#### 4.5.5.4 Action of the MSC in procedure CAMEL_CF_MSC_ANSWER
If the MSC received a destination address from the GMSC in the ISUP Answer or
ISUP Connect Message then the MSC relays the destination address to the gsmSSF
in the Int_DP_O_Answer signal.
#### 4.5.5.5 Action of the MSC in procedure CAMEL_CF_ETC
In procedure CAMEL_CF_ETC (sheet 2) the GMSC or terminating VMSC will remain
in the Wait_For_Assisting_Answer state until it receives an ISUP Answer
Message (ANM) or timeout occurs. This is to ensure that a call record is
always generated for every successful establishment of a temporary connection
to a gsmSRF, especially in the case where the connection is between PLMNs.
NOTE: This means that it may not be possible to access an SRF which does not
generate an ISUP Answer Message (ANM).
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.77-1: Procedure CAMEL_Check_ORLCF_VMSC (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.77-2: Procedure CAMEL_Check_ORLCF_VMSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.78-1: Procedure CAMEL_CF_Dialled_Services (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.79-1: Procedure CAMEL_CF_MSC_INIT (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.79-2: Procedure CAMEL_CF_MSC_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.79-3: Procedure CAMEL_CF_MSC_INIT (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.79-4: Procedure CAMEL_CF_MSC_INIT (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.80-1: Procedure CAMEL_SDS_CF_INIT (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.80-2: Procedure CAMEL_SDS_CF_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.80-3: Procedure CAMEL_SDS_CF_INIT (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.80-4: Procedure CAMEL_SDS_CF_INIT (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.81-1: Procedure CAMEL_NDS_CF_INIT (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.81-2: Procedure CAMEL_NDS_CF_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.81-3: Procedure CAMEL_NDS_CF_INIT (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.81-4: Procedure CAMEL_NDS_CF_INIT (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.82-1: Procedure CAMEL_CF_MSC_ALERTING (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.82-2: Procedure CAMEL_CF_MSC_ALERTING (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.82-3: Procedure CAMEL_CF_MSC_ALERTING (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.83-1: Procedure CAMEL_CF_MSC_ANSWER (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.83-2: Procedure CAMEL_CF_MSC_ANSWER (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.83-3: Procedure CAMEL_CF_MSC_ANSWER (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.84-1: Procedure CAMEL_CF_ETC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.84-2: Procedure CAMEL_CF_ETC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.84-3: Procedure CAMEL_CF_ETC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.84-4: Procedure CAMEL_CF_ETC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.85-1: Procedure CAMEL_CF_CTR (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.85-2: Procedure CAMEL_CF_CTR (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.85-3: Procedure CAMEL_CF_CTR (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.85-4: Procedure CAMEL_CF_CTR (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.85-5: Procedure CAMEL_CF_CTR (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.86-1: Procedure CAMEL_MT_CF_LEG1_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.86-2: Procedure CAMEL_MT_CF_LEG1_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.86-3: Procedure CAMEL_MT_CF_LEG1_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.86-4: Procedure CAMEL_MT_CF_LEG1_MSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.86-5: Procedure CAMEL_MT_CF_LEG1_MSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.86-6: Procedure CAMEL_MT_CF_LEG1_MSC (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.86-7: Procedure CAMEL_MT_CF_LEG1_MSC (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.87-1: Process CAMEL_MT_CF_LEG2_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.87-2: Process CAMEL_MT_CF_LEG2_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.88-1: Procedure CAMEL_MF_RECONNECT_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.88-2: Procedure CAMEL_MF_RECONNECT_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.88-3: Procedure CAMEL_MF_RECONNECT_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.88-4: Procedure CAMEL_MF_RECONNECT_MSC (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.88-5: Procedure CAMEL_MF_RECONNECT_MSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.88-6: Procedure CAMEL_MF_RECONNECT_MSC (sheet 6)
### 4.5.6 Handling of gsmSCF initiated calls
#### 4.5.6.1 Handling of gsmSCF initiated calls in the MSC
Handling of gsmSCF initiated calls in the MSC involves the following process
and procedures:
\- Process CAMEL_ICA_MSC;
\- Procedure CAMEL_ICA_MSC_ALERTING;
\- Procedure CAMEL_ICA_MSC_ANSWER;
\- Procedure CAMEL_ICA_MSC1;
\- Procedure CAMEL_ICA_MSC2;
\- Procedure CAMEL_ICA_Dialled_Services.
The Process CAMEL_ ICA_MSC handles both gsmSCF initiated new calls and gsmSCF
initiated new parties.
The following paragraphs give details on the behaviour of the MSC in the
process CAMEL_ICA_MSC.
##### 4.5.6.1.1 Actions of the MSC on receipt of Int_Error
The process CAMEL_ICA_MSC returns to idle.
##### 4.5.6.1.2 Actions of the MSC on receipt of Int_Continue
The MSC continues processing without any modification of call parameters.
##### 4.5.6.1.3 Actions of the MSC on receipt of Int_Continue_With_Argument
The MSC continues processing with modification of call parameters.
##### 4.5.6.1.4 Actions of the MSC on receipt of Int_Disconnect_Leg
A Release is sent to the destination exchange if required. The release cause
received in the Int_Disconnect_Leg signal is used. The process CAMEL_ICA_MSC
returns to idle.
##### 4.5.6.1.5 Actions of the MSC on receipt of Int_Release_Call
A Release is sent to the destination exchange if required. The release cause
received in the Int_Release_Call signal is used. The MSC then releases all
call resources and the process CAMEL_ ICA_MSC returns to idle.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.89-1: Process CAMEL_ICA_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.89-2: Process CAMEL_ICA_MSC (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.89-3: Process CAMEL_ICA_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.89-4: Process CAMEL_ICA_MSC (sheet 4)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.89-5: Process CAMEL_ICA_MSC (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.89-6: Process CAMEL_ICA_MSC (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.89-7: Process CAMEL_ICA_MSC (sheet 7)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.89-8: Process CAMEL_ICA_MSC (sheet 8)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.89-9: Process CAMEL_ICA_MSC (sheet 9)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.90-1: Procedure CAMEL_ICA_MSC_ALERTING (sheet 1)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.90-2: Process CAMEL_ICA_MSC_ALERTING (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.90-3: Process CAMEL_ICA_MSC_ALERTING (sheet 3)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.91-1: Procedure CAMEL_ICA_MSC_ANSWER (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.91-2: Process CAMEL_ICA_MSC_ANSWER (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.91-3: Process CAMEL_ICA_MSC_ANSWER (sheet 3)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.92-1: Procedure CAMEL_ICA_MSC1 (sheet 1)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.93-1: Procedure CAMEL_ICA_MSC2 (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.94-1: Procedure CAMEL_ICA_Dialled_Services (sheet 1)
#### 4.5.6.2 Handling of gsmSCF initiated calls in the VLR
Handling of gsmSCF initiated calls in the VLR involves the following process
and procedures:
\- Process CAMEL_ICA_VLR.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.95-1: Process CAMEL_ICA_VLR (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.95-2: Process CAMEL_ICA_VLR (sheet 2)
### 4.5.7 Handling of mobile calls in the gsmSSF
Handling of mobile calls in the gsmSSF involves the following processes and
procedures:
\- Process CS_gsmSSF;
\- Procedures and process Check_Criteria;
\- Procedure Connect_To_Resource;
\- Procedure Handle_AC;
\- Procedure Handle_ACR;
\- Procedure Handle_CIR;
\- Procedure Handle_CIR_leg;
\- Procedure Complete_FCI_record;
\- Procedure Complete_all_FCI_records;
\- Procedure Handle_SCI;
\- Process CSA_gsmSSF;
\- Procedure Handle_O_Answer;
\- Procedure Handle_T_Answer.
The detailed error handling for the process CS_gsmSSF and the associated
procedures is specified in 3GPP TS 29.078 ([36]).
#### 4.5.7.1 Call duration control
##### 4.5.7.1.1 Information flow for call duration control
The following diagram shows the handling of the different timers that are used
in the process CS_gsmSSF and in the procedures Handle_AC, Handle_ACR,
Handle_CIR. Timers Tssf, Tcp, Tsw, Tw and DELTA are defined in the process
CS_gsmSSF.
{width="3.5840277777777776in" height="3.6791666666666667in"}
Figure 4.96: Information flow for call control duration
The following diagram shows an example of the handling of call duration
control for CPH configurations.
{width="6.690972222222222in" height="8.74375in"}
Figure 4.96a: Information flow for call control duration in CPH configurations
##### 4.5.7.1.2 Audible indicators for call duration control
The gsmSCF may instruct the gsmSSF to play either a fixed sequence of tones or
a variable sequence of tones with the Apply Charging information flow. The
gsmSCF may also instruct the gsmSSF to play a variable sequence of tones with
the Play Tone information flow.
For the case of the fixed sequence of tones, the gsmSSF shall play a single
sequence of three tones. The duration of each of the tones shall be 200
milliseconds with an intertone interval of 200 milliseconds. This shall be
played 30 seconds before the end of a call period. For the case of a variable
sequence of tones, or a burst list, the gsmSCF shall indicate the number of
tones per burst, the number of bursts to be played, the tone duration,
interval between the tones and the interval between the bursts. In addition,
the gsmSCF shall indicate in the Apply Charging information flow, the warning
time before call period expiry at which the playing of the burst list shall
start. Figure 4.97 provides a graphical representation of the variable burst
list in the case where there are three tones per burst and three bursts in the
burst list. The Warning Period in figure 4.97 applies to the Apply Charging
information flow only.
{width="6.0in" height="2.1527777777777777in"}
Figure 4.97: Representation of burst list
#### 4.5.7.2 The gsmSCF control of e‑values
##### 4.5.7.2.1 Procedure Handle_SCI
There are independent Tariff Switch Timers for the control of the call
duration Tsw(pty) and for the gsmSCF control of e‑values Tsw(SCI). The gsmSCF
control of e‑values is via the Send Charging Information information flow.
The following terminology has been used for e‑parameters:
\- Applicable and in use. The set of e‑parameters is currently applicable in
the MSC and the set has been sent to the MS.
\- Applicable but waiting. The set of e‑parameters is currently applicable in
the MSC but the set has not yet been sent to the MS.
\- Applicable but not in use. The set of e‑parameters is currently applicable
in the MSC but it cannot be sent to the MS, e.g. because the Advice of Charge
supplementary service is not subscribed.
\- Stored. The set of e‑parameters is not yet applicable. The stored set of
e‑parameters becomes applicable when a tariff switch occurs.
The table below defines the actions of the Procedure Handle_SCI.
Table 4.6: Handling of SCI in the gsmSSF
+---------+---------+---------+---------+---------+---------+---------+ | r | Primary | Se | | | | | | eceived | d | condary | | | | | | T | ialogue | d | | | | | | sw(SCI) | (note | ialogue | | | | | | and set | 1) | (not | | | | | | of | | e 2, 8) | | | | | | e‑par | | | | | | | | ameters | | | | | | | | in the | | | | | | | | SCI | | | | | | | | info | | | | | | | | rmation | | | | | | | | flow | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | | no | active | | | | | | | active | call / | | | | | | | call / | SRF | | | | | | | SRF | con | | | | | | | con | nection | | | | | | | nection | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | | T | T | T | T | | | | | sw(SCI) | sw(SCI) | sw(SCI) | sw(SCI) | | | | | not | running | not | running | | | | | running | and | running | and | | | | | and no | e‑par | and no | e‑par | | | | | e‑par | ameters | e‑par | ameters | | | | | ameters | stored | ameters | stored | | | | | stored | | stored | | | | +---------+---------+---------+---------+---------+---------+---------+ | T | 1 set | send | stop | send | stop | send | | sw(SCI) | | 1st set | Ts | 1st set | Ts | 1st set | | not | | to MSC | w(SCI); | to MSC | w(SCI); | to MSC | | r | | | discard | | discard | | | eceived | | | stored | | stored | | | | | | set;\ | | set;\ | | | | | | send | | send | | | | | | 1st set | | 1st set | | | | | | to MSC | | to MSC | | +---------+---------+---------+---------+---------+---------+---------+ | T | 2 sets | ** | ** | ** | ** | ** | | sw(SCI) | | error**| error** | error**| error** | error**| | not | | | | | | | | r | | | | | | | | eceived | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | T | 1 set | ** | ** | store | stop | ** | | sw(SCI) | | error** | error**| 1st | Ts | error** | | r | | | | set;\ | w(SCI); | | | eceived | | | | start | discard | | | | | | | T | stored | | | | | | | sw(SCI) | set;\ | | | | | | | | store | | | | | | | | 1st | | | | | | | | set;\ | | | | | | | | start | | | | | | | | new | | | | | | | | T | | | | | | | | sw(SCI) | | +---------+---------+---------+---------+---------+---------+---------+ | T | 2 sets | send | stop | ** | ** | send | | sw(SCI) | | 1st set | Ts | error**| error** | 1st set | | r | | to | w(SCI); | | | to | | eceived | | MSC,\ | discard | | | MSC;\ | | | | store | stored | | | store | | | | 2nd | set;\ | | | 2nd | | | | set;\ | send | | | set;\ | | | | start | 1st set | | | start | | | | T | to | | | T | | | | sw(SCI) | MSC;\ | | | sw(SCI) | | | | | store | | | | | | | | 2nd | | | | | | | | set;\ | | | | | | | | start | | | | | | | | new | | | | | | | | T | | | | | | | | sw(SCI) | | | | +---------+---------+---------+---------+---------+---------+---------+ | NOTE 1: | | | | | | | | Primary | | | | | | | | di | | | | | | | | alogue: | | | | | | | | The | | | | | | | | primary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | is | | | | | | | | in | | | | | | | | itiated | | | | | | | | due to | | | | | | | | TDP Co | | | | | | | | llected | | | | | | | | _Info, | | | | | | | | TDP A | | | | | | | | nalysed | | | | | | | | _Infor | | | | | | | | mation, | | | | | | | | or | | | | | | | | TDP Ro | | | | | | | | ute_Se | | | | | | | | lect_F | | | | | | | | ailure, | | | | | | | | TD | | | | | | | | P Termi | | | | | | | | nating\ | | | | | | | | _Attemp | | | | | | | | t_Auth | | | | | | | | orised, | | | | | | | | TDP | | | | | | | | T_Busy | | | | | | | | or TDP | | | | | | | | T_No_ | | | | | | | | Answer. | | | | | | | | A | | | | | | | | d | | | | | | | | ialogue | | | | | | | | in | | | | | | | | itiated | | | | | | | | due to | | | | | | | | TDP | | | | | | | | Analyse | | | | | | | | d_Info | | | | | | | | rmation | | | | | | | | is only | | | | | | | | the | | | | | | | | primary | | | | | | | | di | | | | | | | | alogue, | | | | | | | | if | | | | | | | | there | | | | | | | | is no | | | | | | | | ongoing | | | | | | | | d | | | | | | | | ialogue | | | | | | | | due to | | | | | | | | TDP | | | | | | | | Co | | | | | | | | llected | | | | | | | | _Info. | | | | | | | | | | | | | | | | NOTE 2: | | | | | | | | Se | | | | | | | | condary | | | | | | | | di | | | | | | | | alogue: | | | | | | | | The | | | | | | | | se | | | | | | | | condary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | is | | | | | | | | in | | | | | | | | itiated | | | | | | | | due to | | | | | | | | TDP A | | | | | | | | nalysed | | | | | | | | _Infor | | | | | | | | mation. | | | | | | | | | | | | | | | | NOTE 3: | | | | | | | | The | | | | | | | | co | | | | | | | | ndition | | | | | | | | \ | | | | | | | | "active | | | | | | | | call / | | | | | | | | SRF | | | | | | | | conne | | | | | | | | ction\" | | | | | | | | is true | | | | | | | | if | | | | | | | | there | | | | | | | | is at | | | | | | | | least | | | | | | | | one | | | | | | | | active | | | | | | | | leg in | | | | | | | | this | | | | | | | | call | | | | | | | | (CSA) | | | | | | | | or if | | | | | | | | an SRF | | | | | | | | is | | | | | | | | co | | | | | | | | nnected | | | | | | | | to a | | | | | | | | Call | | | | | | | | Segment | | | | | | | | in this | | | | | | | | CSA. | | | | | | | | I | | | | | | | | ncoming | | | | | | | | legs | | | | | | | | are | | | | | | | | active | | | | | | | | after | | | | | | | | an | | | | | | | | answer | | | | | | | | is sent | | | | | | | | and | | | | | | | | before | | | | | | | | the leg | | | | | | | | begins | | | | | | | | to | | | | | | | | r | | | | | | | | elease. | | | | | | | | O | | | | | | | | utgoing | | | | | | | | legs | | | | | | | | are | | | | | | | | active | | | | | | | | after | | | | | | | | an | | | | | | | | answer | | | | | | | | is | | | | | | | | r | | | | | | | | eceived | | | | | | | | and | | | | | | | | before | | | | | | | | the leg | | | | | | | | is | | | | | | | | begins | | | | | | | | to | | | | | | | | r | | | | | | | | elease. | | | | | | | | | | | | | | | | NOTE 4: | | | | | | | | If the | | | | | | | | gsmSSF | | | | | | | | sends a | | | | | | | | set of | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | to the | | | | | | | | MSC | | | | | | | | this | | | | | | | | will | | | | | | | | ov | | | | | | | | erwrite | | | | | | | | the | | | | | | | | current | | | | | | | | set of | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | in the | | | | | | | | MSC, if | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | are | | | | | | | | app | | | | | | | | licable | | | | | | | | in the | | | | | | | | MSC. | | | | | | | | | | | | | | | | NOTE 5: | | | | | | | | The MSC | | | | | | | | shall | | | | | | | | store | | | | | | | | the | | | | | | | | r | | | | | | | | eceived | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | to be | | | | | | | | sent | | | | | | | | subse | | | | | | | | quently | | | | | | | | to the | | | | | | | | MS. The | | | | | | | | MSC | | | | | | | | shall | | | | | | | | send | | | | | | | | these | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | to the | | | | | | | | MS in a | | | | | | | | Connect | | | | | | | | message | | | | | | | | or in a | | | | | | | | F | | | | | | | | acility | | | | | | | | m | | | | | | | | essage. | | | | | | | | | | | | | | | | NOTE 6: | | | | | | | | Se | | | | | | | | condary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | gsmSCF | | | | | | | | can | | | | | | | | only | | | | | | | | give | | | | | | | | e‑ | | | | | | | | paramet | | | | | | | | er(s)/T | | | | | | | | sw(SCI) | | | | | | | | when | | | | | | | | they | | | | | | | | have | | | | | | | | not | | | | | | | | pre | | | | | | | | viously | | | | | | | | been | | | | | | | | p | | | | | | | | rovided | | | | | | | | by the | | | | | | | | primary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | gsmSCF. | | | | | | | | After | | | | | | | | se | | | | | | | | condary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | gsmSCF | | | | | | | | gives | | | | | | | | e‑param | | | | | | | | eter(s) | | | | | | | | / | | | | | | | | Ts | | | | | | | | w(SCI), | | | | | | | | Primary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | gsmSCF | | | | | | | | shall | | | | | | | | not | | | | | | | | give | | | | | | | | further | | | | | | | | on-line | | | | | | | | c | | | | | | | | harging | | | | | | | | instr | | | | | | | | uctions | | | | | | | | (i.e. | | | | | | | | Send | | | | | | | | C | | | | | | | | harging | | | | | | | | Inform | | | | | | | | ation). | | | | | | | | | | | | | | | | For | | | | | | | | D‑CSI, | | | | | | | | this is | | | | | | | | ensured | | | | | | | | by | | | | | | | | service | | | | | | | | subsc | | | | | | | | ription | | | | | | | | rest | | | | | | | | riction | | | | | | | | by a | | | | | | | | home | | | | | | | | network | | | | | | | | op | | | | | | | | erator. | | | | | | | | For | | | | | | | | N‑CSI, | | | | | | | | this is | | | | | | | | ensured | | | | | | | | by a | | | | | | | | roaming | | | | | | | | ag | | | | | | | | reement | | | | | | | | between | | | | | | | | the | | | | | | | | home | | | | | | | | network | | | | | | | | o | | | | | | | | perator | | | | | | | | and the | | | | | | | | visited | | | | | | | | network | | | | | | | | o | | | | | | | | perator | | | | | | | | or is | | | | | | | | only | | | | | | | | app | | | | | | | | licable | | | | | | | | within | | | | | | | | a home | | | | | | | | n | | | | | | | | etwork. | | | | | | | | | | | | | | | | NOTE 7: | | | | | | | | When a | | | | | | | | gsmSCF | | | | | | | | relat | | | | | | | | ionship | | | | | | | | is | | | | | | | | closed | | | | | | | | then | | | | | | | | the | | | | | | | | * | | | | | | | | stored _| | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | given | | | | | | | | by that | | | | | | | | d | | | | | | | | ialogue | | | | | | | | are | | | | | | | | dis | | | | | | | | carded. | | | | | | | | Any | | | | | | | | Tariff | | | | | | | | Switch | | | | | | | | timer | | | | | | | | (Ts | | | | | | | | w(SCI)) | | | | | | | | is also | | | | | | | | stopped | | | | | | | | when | | | | | | | | the | | | | | | | | gsmSCF | | | | | | | | relat | | | | | | | | ionship | | | | | | | | is | | | | | | | | closed. | | | | | | | | If the | | | | | | | | gsmSCF | | | | | | | | has | | | | | | | | given | | | | | | | | any | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | which | | | | | | | | are not | | | | | | | | * | | | | | | | | stored_ | | | | | | | | but | | | | | | | | which | | | | | | | | are | | | | | | | | app | | | | | | | | licable | | | | | | | | (reg | | | | | | | | ardless | | | | | | | | of | | | | | | | | whether | | | | | | | | they | | | | | | | | are | | | | | | | | _app | | | | | | | | licable | | | | | | | | and in | | | | | | | | use_ , | | | | | | | | _app | | | | | | | | licable | | | | | | | | but | | | | | | | | wa | | | | | | | | iting,_ | | | | | | | | or | | | | | | | | _app | | | | | | | | licable | | | | | | | | but not | | | | | | | | in | | | | | | | | use_) | | | | | | | | when | | | | | | | | the | | | | | | | | gsmSCF | | | | | | | | relat | | | | | | | | ionship | | | | | | | | is | | | | | | | | closed, | | | | | | | | those | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | are | | | | | | | | also | | | | | | | | valid | | | | | | | | after | | | | | | | | the | | | | | | | | gsmSCF | | | | | | | | relat | | | | | | | | ionship | | | | | | | | is | | | | | | | | closed. | | | | | | | | If any | | | | | | | | sub | | | | | | | | sequent | | | | | | | | CAP | | | | | | | | di | | | | | | | | alogues | | | | | | | | give | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | those | | | | | | | | new | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | shall | | | | | | | | ov | | | | | | | | erwrite | | | | | | | | the | | | | | | | | app | | | | | | | | licable | | | | | | | | e‑par | | | | | | | | ameters | | | | | | | | given | | | | | | | | by the | | | | | | | | pr | | | | | | | | eceding | | | | | | | | CAP | | | | | | | | dia | | | | | | | | logues. | | | | | | | | | | | | | | | | NOTE 8: | | | | | | | | The | | | | | | | | se | | | | | | | | condary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | is not | | | | | | | | app | | | | | | | | licable | | | | | | | | to VT | | | | | | | | calls. | | | | | | | | | | | | | | | | NOTE 9: | | | | | | | | Service | | | | | | | | Logic | | | | | | | | de | | | | | | | | signers | | | | | | | | shall | | | | | | | | take | | | | | | | | care | | | | | | | | when | | | | | | | | using | | | | | | | | SCI in | | | | | | | | both | | | | | | | | primary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | and | | | | | | | | se | | | | | | | | condary | | | | | | | | di | | | | | | | | alogue, | | | | | | | | if | | | | | | | | these | | | | | | | | di | | | | | | | | alogues | | | | | | | | use | | | | | | | | di | | | | | | | | fferent | | | | | | | | v | | | | | | | | ersions | | | | | | | | of | | | | | | | | CAMEL. | | | | | | | | In such | | | | | | | | a case | | | | | | | | it is | | | | | | | | e.g _._ | | | | | | | | p | | | | | | | | ossible | | | | | | | | that a | | | | | | | | Tariff | | | | | | | | Switch | | | | | | | | timer | | | | | | | | ( | | | | | | | | Tsw(SCI | | | | | | | | )) info | | | | | | | | rmation | | | | | | | | r | | | | | | | | eceived | | | | | | | | in the | | | | | | | | primary | | | | | | | | d | | | | | | | | ialogue | | | | | | | | is | | | | | | | | over | | | | | | | | written | | | | | | | | by a | | | | | | | | Tariff | | | | | | | | Switch | | | | | | | | timer | | | | | | | | (Ts | | | | | | | | w(SCI)) | | | | | | | | info | | | | | | | | rmation | | | | | | | | r | | | | | | | | eceived | | | | | | | | in the | | | | | | | | se | | | | | | | | condary | | | | | | | | di | | | | | | | | alogue. | | | | | | | +---------+---------+---------+---------+---------+---------+---------+
##### 4.5.7.2.2 Process Tsw_For_SCI
The process Tsw_For_SCI exists per call. That is there is one process instance
per CSA. The Tariff Switch Timers for the gsmSCF control of e‑values Tsw(SCI).
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.98-1: Process Tsw_For_SCI (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.98-2: Process Tsw_For_SCI (sheet 2)
#### 4.5.7.3 Behaviour of the gsmSSF in the process CS_gsmSSF
The following paragraphs give details on the behaviour of the gsmSSF in the
process CS_gsmSSF.
##### 4.5.7.3.1 Actions of the gsmSSF on receipt of
CAP_Request_Report_BCSM_Event (in the state Waiting_For_Instructions)
The process CS_gsmSSF arms the requested EDP, if the arming rules are
fulfilled and returns to the state Waiting_For_Instructions.
The gsmSCF may request EDPs for any one or more of Answer, Busy, No Answer,
Abandon, Route Select Failure and Disconnect event for a party in the call.
##### 4.5.7.3.2 Actions of the gsmSSF on receipt of CAP_Continue (in the state
Waiting_For_Instructions)
An Int_Continue signal is sent to instruct the GMSC or MSC to continue the
call set-up with the original call parameters.
##### 4.5.7.3.3 Actions of the gsmSSF on receipt of CAP_Release_Call (in the
state Monitoring)
When a control relationship exists between the gsmSCF and gsmSSF (at least one
EDP‑R is armed), the gsmSCF may spontaneously instruct the gsmSSF to release
the call at any time using the Release Call information flow. The Release Call
information flow shall not be sent from the gsmSCF if only monitor
relationship exists between the gsmSSF and the gsmSCF.
##### 4.5.7.3.4 Actions of the gsmSSF on receipt of Int_DP_T_Busy or
Int_DP_T_No_Answer including the parameter Call Forwarded (in the state
Monitoring)
If the handling of Int_DP_T_Busy signal or Int_DP_T_No_Answer signal including
the parameter Call Forwarded leads to the gsmSSF sending a
CAP_Event_Report_BCSM to the gsmSCF, the gsmSSF shall include the parameter
Call Forwarded in the Event Specific Information BCSM.
#### 4.5.7.4 Outstanding Request Counter and Rules for CAMEL
In the following the rules on handling of the \'outstanding requests\'
variables in the process CS_gsmSSF are given. They are storing the number of
required resumptions.
1) There shall be one outstanding requests variable ORC_Leg (legID) per leg to
handle TDP‑R and EDP‑R reports and ICA.
2) In addition there shall be one outstanding requests variable ORC_CS (CSID)
per call segment to handle the CPH IFs.
3) A leg will only be resumed if the ORC_Leg (legID) variable for this leg and
the ORC_CS (CSID) for the call segment containing the leg are 0.
4) Events that cause the suspension of the call processing are signalling
events armed as TDP‑Rs or EDP‑Rs, or the processing of a CPH IF (Disconnect
Leg, Split Leg or Move Leg) or Initiate Call Attempt sent by the gsmSCF.
a) For TDP‑R or EDP‑R events the number of required resumptions relative to
the associated leg will be incremented by 1. For TDP-R, the associated leg is
always leg 2.
b) For CPH IFs the number of required resumptions per call segment will be set
to one if it is still 0. Otherwise the number of resumptions remains
unchanged. For Split Leg the number of required resumptions for each of the
source call segment and the target call segment will be set to one if it is
still 0
c) For ICA the number of required resumptions relative to the associated leg
will be set to 1.
5) In addition the CS_gsmSSF stores information about the events (DP with the
associated leg, CPH) that require resumption and keep track of the order of
events for TDP‑Rs and EDP‑Rs for each leg . The order of resumptions for a leg
shall be the order in which the suspension events occured for that leg.
6) For DP event resumption Continue with Argument with legID or Continue are
valid. If not otherwise stated below, for each received resumption the number
of required resumption for that leg will be decremented by 1 if it was a valid
resumption for the event that has to be handled first. Decrementing of the
outstanding requests variables does not go below 0.
7) For CPH resumption Continue with Argument with CSID is valid. On receipt of
the resumption the number of required resumptions for that call segment will
be set to 0.
8) For ICA resumption Continue with Argument with LegId is valid. On receipt
of the resumption the number of required resumptions for that Leg will be set
to 0.
9) If Continue with Argument with neither LegID nor CSID is received, then the
number of resumptions required for the leg that was reported will be
decremented by 1. If reporting is performed on more than one leg, then the
related leg will be selected following the sequence of the reporting.
10) If Continue is received, then the number of resumptions required for the
leg that was reported will be decremented by 1. If reporting is performed on
more than one leg, then the related leg will be selected following the
sequence of the reporting.
11) The processing of a Connect with a LegID causes the number of required
resumptions for that leg to be decremented by 1. The processing of a Connect
without a LegID causes the number of resumptions for the LegID = 2 to be set
to 0.
12) The processing of Tssf expiry and of TC Abort causes the number of
resumptions required to be set to 0 and the call processing to be resumed. All
stored resumption events are discarded.
13) On receipt of a Disconnect Leg the number of resumptions required for the
corresponding leg is set to 0.
14) If Release Call is used, nothing needs to be resumed.
#### 4.5.7.5 Process CS_gsmSSF and procedures
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-1: Process CS_gsmSSF (sheet 1)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-2: Process CS_gsmSSF (sheet 2)
{width="6.574305555555555in" height="8.490972222222222in"}
Figure 4.99-3: Process CS_gsmSSF (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-4: Process CS_gsmSSF (sheet 4)
{width="6.002777777777778in" height="6.727777777777778in"}
Figure 4.99-5: Process CS_gsmSSF (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-6: Process CS_gsmSSF (sheet 6)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-7: Process CS_gsmSSF (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-8: Process CS_gsmSSF (sheet 8)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-9: Process CS_gsmSSF (sheet 9)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-10: Process CS_gsmSSF (sheet 10)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-11: Process CS_gsmSSF (sheet 11)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-12: Process CS_gsmSSF (sheet 12)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-13: Process CS_gsmSSF (sheet 13)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-14: Process CS_gsmSSF (sheet 14)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-15: Process CS_gsmSSF (sheet 15)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.99-16: Process CS_gsmSSF (sheet 16)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.99-17: Process CS_gsmSSF (sheet 17)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.99-18: Process CS_gsmSSF (sheet 18)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.99-19: Process CS_gsmSSF (sheet 19)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-20: Process CS_gsmSSF (sheet 20)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-21: Process CS_gsmSSF (sheet 21)
{width="5.996527777777778in" height="6.996527777777778in"}
Figure 4.99-21A: Process CS_gsmSSF (sheet 21A)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-22: Process CS_gsmSSF (sheet 22)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-23: Process CS_gsmSSF (sheet 23)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-24: Process CS_gsmSSF (sheet 24)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-25: Process CS_gsmSSF (sheet 25)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-26: Process CS_gsmSSF (sheet 26)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-27: Process CS_gsmSSF (sheet 27)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-28: Process CS_gsmSSF (sheet 28)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.99-29: Process CS_gsmSSF (sheet 29)
{width="5.752083333333333in" height="6.956944444444445in"}
Figure 4.99-29a: Process CS_gsmSSF (sheet 29a)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-30: Process CS_gsmSSF (sheet 30)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-31: Process CS_gsmSSF (sheet 31)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-32: Process CS_gsmSSF (sheet 32)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-33: Process CS_gsmSSF (sheet 33)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-34: Process CS_gsmSSF (sheet 34)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-35: Process CS_gsmSSF (sheet 35)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-36: Process CS_gsmSSF (sheet 36)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-37: Process CS_gsmSSF (sheet 37)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-38: Process CS_gsmSSF (sheet 38)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-39: Process CS_gsmSSF (sheet 39)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-40: Process CS_gsmSSF (sheet 40)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-41: Process CS_gsmSSF (sheet 41)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-42: Process CS_gsmSSF (sheet 42)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-43: Process CS_gsmSSF (sheet 43)
Figure 4.99-44: Process CS_gsmSSF (sheet 44)
Figure 4.99-45: Process CS_gsmSSF (sheet 45)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-46: Process CS_gsmSSF (sheet 46)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-47: Process CS_gsmSSF (sheet 47)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-48: Process CS_gsmSSF (sheet 48)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-49: Process CS_gsmSSF (sheet 49)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-50: Process CS_gsmSSF (sheet 50)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-51: Process CS_gsmSSF (sheet 51)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-52: Process CS_gsmSSF (sheet 52)
{width="6.690972222222222in" height="8.539583333333333in"}
Figure 4.99-53: Process CS_gsmSSF (sheet 53)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-54: Process CS_gsmSSF (sheet 54)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-55: Process CS_gsmSSF (sheet 55)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-56: Process CS_gsmSSF (sheet 56)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-57: Process CS_gsmSSF (sheet 57)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-58: Process CS_gsmSSF (sheet 58)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-59: Process CS_gsmSSF (sheet 59)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-60: Process CS_gsmSSF (sheet 60)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.99-61: Process CS_gsmSSF (sheet 61)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.99-62: Process CS_gsmSSF (sheet 62)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.100-1: Procedure Check_Criteria_Collected_Info (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.101-1: Procedure Check_Criteria_Analysed_Info (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.102-1: Procedure Check_Criteria_Unsuccessful (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.103-1: Procedure Connect_To_Resource (sheet 1)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.104-1: Procedure Handle_AC (sheet 1)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.105-1: Procedure Handle_ACR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.106-1: Procedure Handle_CIR (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.107-1: Procedure Handle_CIR_leg (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.108-1: Procedure Complete_FCI_record (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.109-1: Procedure Complete_all_FCI_records (sheet 1)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.110-1: Procedure Handle_O_Answer (sheet 1)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.111-1: Procedure Handle_T_Answer (sheet 1)
{width="6.689583333333333in" height="8.57013888888889in"}
Figure 4.112-1: Procedure UpdateSignalling (sheet 1)
#### 4.5.7.6 Process gsmSSF_SSME_FSM and procedures
One process is instantiated for each Call Gap information flow received from a
gsmSCF.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.113-1: Process gsm_SSME_SSF (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.113-2: Process gsm_SSME_SSF (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
NOTE: CG Int and CG Reject internal variables are initiated with False value.
Figure 4.114-1: Procedure Store_Call_Gap_Criteria (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.115-1: Procedure Check_Gap_Criteria (sheet 1)
{width="5.995833333333334in" height="7.708333333333333in"}
Figure 4.115A-1: Procedure Check_Criteria_for_TOC (sheet 1)
#### 4.5.7.7 Process CSA_gsmSSF and procedures
The call gap information flow can only be received for an opened transaction
between the CSA_gsmSSF and the gsmSCF.
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-1: Process CSA_gsmSSF (sheet 1)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-2: Process CSA_gsmSSF (sheet 2)
{width="6.695138888888889in" height="7.918055555555555in"}
Figure 4.116-3: Process CSA_gsmSSF (sheet 3)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-4: Process CSA_gsmSSF (sheet 4)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-5: Process CSA_gsmSSF (sheet 5)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-6: Process CSA_gsmSSF (sheet 6)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-7: Process CSA_gsmSSF (sheet 7)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-8: Process CSA_gsmSSF (sheet 8)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-9: Process CSA_gsmSSF (sheet 9)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-10: Process CSA_gsmSSF (sheet 10)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-11: Process CSA_gsmSSF (sheet 11)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-12: Process CSA_gsmSSF (sheet 12)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-13: Process CSA_gsmSSF (sheet 13)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-14: Process CSA_gsmSSF (sheet 14)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-15: Process CSA_gsmSSF (sheet 15)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-16: Process CSA_gsmSSF (sheet 16)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-17: Process CSA_gsmSSF (sheet 17)
{width="5.752083333333333in" height="7.4375in"}
Figure 4.116-18: Process CSA_gsmSSF (sheet 18)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.116-19: Process CSA_gsmSSF (sheet 19)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-20: Process CSA_gsmSSF (sheet 20)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.116-21: Process CSA_gsmSSF (sheet 21)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-22: Process CSA_gsmSSF (sheet 22)
{width="6.665277777777778in" height="8.613888888888889in"}
Figure 4.116-23: Process CSA_gsmSSF (sheet 23)
### 4.5.8 Assisting case
Assisting case involves the following processes:
\- CAMEL_Assisting_MSC,
\- Assisting_gsmSSF.
The detailed error handling for these 2 processes is specified in 3GPP TS
29.078 [36].
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.117-1: Process CAMEL_Assisting_MSC (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.117-2: Process CAMEL_Assisting_MSC (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.117-3: Process CAMEL_Assisting_MSC (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.118-1: Process Assisting_gsmSSF (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.118-2: Process Assisting_gsmSSF (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.118-3: Process Assisting_gsmSSF (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.118-4: Process Assisting_gsmSSF (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.118-5: Process Assisting_gsmSSF (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 4.118-6: Process Assisting_gsmSSF (sheet 6)
### 4.5.9 Procedure CAMEL_Provide_Subscriber_Info
The procedure CAMEL_Provide_Subscriber_Info is called either during Retrieval
of routeing information in the HLR or as a result of reception of the Any Time
Interrogation information flow from the gsmSCF.
The HLR sends a Provide Subscriber Info information flow to the VLR or SGSN
dependent on the setting of the parameter \"requested domain\" received from
the calling process.
If the VLR or SGSN returns a Provide Subscriber Info ack information flow,
then the HLR uses the received information to set the Subscriber Info to be
returned to the calling process.
As a network option, the HLR may use the information received from the VLR,
such as Cell Id, Location Area Id or Service Area Id, to derive the Location
Number and/or Geographical Information. The HLR may use the information
received from the SGSN, such as Cell Id, Location Area Id, Service Area Id or
Routeing Area Identity, to derive the Location Number and/or Geographical
Information. This mapping is network-specific and outside the scope of the
present document.
NOTE: The handling in the VLR of Provide Subscriber Info is defined in 3GPP TS
23.018 [12]. The handling in the SGSN of Provide Subscriber Info is defined in
clause 11.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.119-1: Procedure CAMEL_Provide_Subscriber_Info (sheet 1)
{width="6.690972222222222in" height="8.647916666666667in"}
Figure 4.119-2: Procedure CAMEL_Provide_Subscriber_Info (sheet 2)
### 4.5.10 CAMEL specific handling of location updating and data restoration
When requesting a location update or data restoration the VLR shall indicate
to the HLR which CAMEL phases it supports and which CAMEL phase 4 CSIs can be
downloaded.
The HLR may then send CAMEL subscription data to the VLR or, if some different
handling is required, data for substitute handling. The CAMEL subscription
data sent by the HLR shall comply with the indication of supported CAMEL
phases and supported CAMEL phase 4 CSIs as received from the VLR.
When the location update has been completed, the MSC/VLR in which the
subscriber is registered after the location update shall check the M‑CSI. If a
Mobility Management notification to the gsmSCF is required for this
subscriber, then the MSC/VLR shall send the notification to the gsmSCF.
Refer to subclause 9.2.1 for a description of M‑CSI and the conditions under
which a notification shall be sent.
### 4.5.11 Cross phase compatibility
To avoid a case by case fallback between the gsmSSF and the gsmSCF, the gsmSSF
shall use the CAP phase corresponding to the CAMEL phase negotiated on the
HLR-VLR interface when it opens a dialogue with the gsmSCF. The HLR-VLR
negotiation of CAMEL phase is per subscriber.
### 4.5.12 Handling of North American Carrier Information
The following procedures apply only when the HPLMN of the CAMEL subscriber and
either the VPLMN (for a mobile originated or forwarded call) or the IPLMN (for
a mobile terminated call or forwarded call) are both North American. A gsmSCF
may then provide the gsmSSF with any of the following North American (NA)
carrier related information items.
\- NA Carrier Information;
\- NA Originating Line Information;
\- NA Charge Number.
A gsmSSF shall use the received information items both to select any long
distance carrier needed for the call and to provide certain information needed
by this carrier. Any required information items not received shall be
defaulted to those that would normally apply to the call in the absence of an
interaction with a gsmSCF.
If any NA information item received from the gsmSCF is found to be invalid,
the gsmSSF may either, as an operator option, release the call or behave as if
the invalid information item had not been sent.
If the carrier specified in the Carrier parameter is not supported in the
VPLMN or IPLMN, the gsmSSF may either, as an operator option, release the call
or substitute for the unsupported carrier a preferred carrier of the VPLMN or
IPLMN.
Support of the NA Originating Line Information and Charge Number parameters is
an operator option in a VPLMN based on roaming agreements with the operators
of other PLMNs, A gsmSSF may ignore these items when received from certain or
all gsmSCFs located in other PLMNs and replace them with the corresponding
default items for an MO, MF, MT or VT call.
### 4.5.13 Handling of trunk originated calls
The handling of trunk originated calls in the inter-connecting MSC is
specified in 3GPP TS 23.018 [12] subclause 7.5. The processes and procedures
specific to CAMEL are specified in this subclause.
  * Procedure CAMEL_TOC_Dialled_Services;
\- Procedure CAMEL_TOC_MSC_INIT;
  * Procedure CAMEL_NDS_TOC_INIT;
  * Procedure CAMEL_TOC_LEG1_MSC.
The procedure CAMEL_TOC_LEG1_MSC supervises the originating party only. The
process CAMEL_MT_CF_LEG2_MSC supervises the called-to party only. Hence,
signals from the originating exchange are received by the procedure
CAMEL_TOC_LEG1_MSC and signals from the destination exchange are received by
the process CAMEL_MT_CF_LEG2_MSC.
#### 4.5.13.1 Procedure CAMEL_TOC_Dialled_Services
Void
#### 4.5.13.2 Procedure CAMEL_TOC_MSC_INIT
Sheet 1: Decision "First procedure call": The procedure call formal parameter
(FPAR) values "First" or "NotFirst" indicate whether the gsmSSF instance has
been invoked for this call at the Collected_Information DP.
  * First_ The gsmSSF has not been invoked.
  * NotFirst: The gsmSSF has been invoked earlier and the gsmSSF is waiting for additional digits. The gsmSSF may not have triggered a CAP dialogue to gsmSCF.
#### 4.5.13.3 Procedure CAMEL_NDS_TOC_INIT
Sheet 1: Decision "First procedure call": The procedure call formal parameter
(FPAR) values "First" or "NotFirst" indicate whether the gsmSSF instance has
been invoked for this call at Analysed_Information DP. The dialled services
invoke a different instance of gsmSSF than at the Collected_Information DP.
  * First_ The gsmSSF has not been invoked.
  * NotFirst: The gsmSSF has been invoked earlier and the gsmSSF is waiting for additional digits. The gsmSSF may not have triggered a CAP dialogue to gsmSCF.
#### 4.5.13.4 Procedure CAMEL_TOC_LEG1_MSC
Void
{width="5.993055555555555in" height="7.543055555555555in"}
Figure 4.119A-1: Procedure CAMEL_TOC_Dialled_Services (sheet 1)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119B-1: Procedure CAMEL_TOC_MSC_INIT (sheet 1)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119B-2: Procedure CAMEL_TOC_MSC_INIT (sheet 2)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119B-3: Procedure CAMEL_TOC_MSC_INIT (sheet 3)
{width="5.992361111111111in" height="7.247916666666667in"}
Figure 4.119B-4: Procedure CAMEL_TOC_MSC_INIT (sheet 4)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119B-5: Procedure CAMEL_TOC_MSC_INIT (sheet 5)
{width="6.691666666666666in" height="8.09375in"}
Figure 4.119B-6: Procedure CAMEL_TOC_MSC_INIT (sheet 6)
{width="6.691666666666666in" height="8.09375in"}
Figure 4.119B-7: Procedure CAMEL_TOC_MSC_INIT (sheet 7)
{width="6.654861111111111in" height="8.595833333333333in"}
Figure 4.119C-1: Procedure CAMEL_NDS_TOC_INIT (sheet 1)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119C-2: Procedure CAMEL_NDS_TOC_INIT (sheet 2)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119C-3: Procedure CAMEL_NDS_TOC_INIT (sheet 3)
{width="5.992361111111111in" height="7.247916666666667in"}
Figure 4.119C-4: Procedure CAMEL_NDS_TOC_INIT (sheet 4)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119C-5: Procedure CAMEL_NDS_TOC_INIT (sheet 5)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119D-1: Procedure CAMEL_TOC_LEG1_MSC (sheet 1)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119D-2: Procedure CAMEL_TOC_LEG1_MSC (sheet 2)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119D-3: Procedure CAMEL_TOC_LEG1_MSC (sheet 3)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119D-4: Procedure CAMEL_TOC_LEG1_MSC (sheet 4)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119D-5: Procedure CAMEL_TOC_LEG1_MSC (sheet 5)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119D-6: Procedure CAMEL_TOC_LEG1_MSC (sheet 6)
{width="5.997916666666667in" height="7.752083333333333in"}
Figure 4.119D-7: Procedure CAMEL_TOC_LEG1_MSC (sheet 7)
## 4.6 Description of information flows
This clause contains the detailed description of the information flows used by
CAMEL for Circuit Switched call control.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Specific conditions (S), mutually Exclusive (E), Optional (O) or not
applicable (-) for each different traffic case applicable to the following
CSI:
\- MO Mobile Originating call in the VMSC (O‑CSI, D‑CSI or N‑CSI dialogue);
\- MF Mobile Forwarded call in the VMSC or the GMSC as in figure 4.7 (O‑CSI,
D‑CSI or N‑CSI dialogue);
\- MT Mobile Terminating call in the GMSC (T‑CSI dialogue);
\- VT Mobile Terminating call in the VMSC (VT‑CSI dialogue);
\- NC gsmSCF initiated new call;
\- NP gsmSCF initiated new party in an existing call;
  * TO Trunk Originating call in the MSC (TO-CSI or N-CSI dialogue).
If the IEs in one table apply in all the possible cases listed above or no
distinction is needed, then the IEs are marked in the \"Status\" column.
An \'M\' IE shall always be included for the corresponding traffic case. A
\'C\' IE shall be included if the sending entity has the necessary information
to populate the IE. The conditions for the inclusion of an \'S\' IE are shown
in the \'Description\' column of the definition table. When a set of \'E\' IEs
is shown in the definition of an Information Flow or compound IE, only one of
those IEs may be included. An \'O\' IE may be included or omitted as required
by the service logic. A \'‑\' IE shall always be omitted for the corresponding
traffic case. This categorization is a functional classification, i.e. it
defines the requirements for the stage 2 information. it is not a stage 3
classification to be used for the ASN.1 syntax of the protocol.
The distinction between MO, MF, MT, VT, NC, NP and TO calls is not applicable
to all Information Flows.
The following principles apply for the handling of the IEs by the receiving
entity:
\- The gsmSSF shall functionally support all IEs which can be sent to it.
\- The gsmSCF may silently discard any IE which it does not functionally
support.
\- The gsmSRF shall return an error if it does not functionally support an IE
which it receives.
\- The HLR may silently discard any IE which it does not functionally support.
Details of errors and exceptions to these rules are specified in are specified
in 3GPP TS 29.078 [36].
### 4.6.1 gsmSSF to gsmSCF information flows
#### 4.6.1.1 Activity Test ack
##### 4.6.1.1.1 Description
This IF is the response to the Activity Test.
##### 4.6.1.1.2 Information Elements
This IF contains no information elements.
#### 4.6.1.2 Apply Charging Report
##### 4.6.1.2.1 Description
This IF is used by the gsmSSF to report to the gsmSCF the information
requested in the Apply Charging IF.
##### 4.6.1.2.2 Information Elements
* * *
Information element name Status Description Call Result M This IE contains the
charging information provided by the gsmSSF.
* * *
Call Result contains the following information elements:
* * *
Information element name Status Description Time Duration Charging Result M
This IE is described in a table below.
* * *
Time Duration Charging Result contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Time Information | M | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Party To Charge | M | This IE is received in the | | | | related Apply Charging IF | | | | to correlate the result to | | | | the request. This IE shall | | | | be a copy of the | | | | corresponding IE received | | | | in the Apply Charging IF. | +-----------------------------+--------+-----------------------------+ | ACh Charging Address | M | This IE identifies the call | | | | party to which the Apply | | | | Charging Report IF applies. | | | | | | | | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Leg Active | M | This IE indicates whether | | | | the call leg is active or | | | | not. When the ACR is sent | | | | because of a change in CPH | | | | configuration | | | | legActive=FALSE shall be | | | | used. | +-----------------------------+--------+-----------------------------+ | Call Leg Released At Tcp | S | This IE is an indication | | Expiry | | that the gsmSSF has | | | | released the call leg or | | | | the Temporary Connection or | | | | SRF Connection, due to Tcp | | | | expiry. | | | | | | | | It shall be present when | | | | Apply Charging Report is | | | | sent due to Tcp expiry and | | | | the gsmSSF has released the | | | | call leg or the Temporary | | | | Connection or SRF | | | | Connection (because | | | | \'Release If Duration | | | | Exceeded\' was present in | | | | the Apply Charging IF). | | | | | | | | In all other cases, this IE | | | | shall be absent. | +-----------------------------+--------+-----------------------------+
Time Information contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Time If No Tariff Switch | S,E | This IE shall be present if | | | | no tariff switch has | | | | occurred since the | | | | reception of the first | | | | Apply Charging IF for the | | | | connection to the Called | | | | Party, the Temporary | | | | Connection, or the gsmSRF | | | | connection, otherwise it | | | | shall be absent. | | | | | | | | If Answer was detected for | | | | the connection to the | | | | Called Party, the Temporary | | | | Connection or the gsmSRF | | | | connection, then the | | | | elapsed time since | | | | detection of Answer shall | | | | be reported. | | | | | | | | For a change in a CPH | | | | configuration the | | | | particular time when the | | | | legs in a CS are connected | | | | shall be taken as Answer. | | | | | | | | If answer was not detected, | | | | it shall be set to \"0\". | +--------------------------+--------+-----------------------------+ | Time If Tariff Switch | S,E | This IE shall be present if | | | | a tariff switch has | | | | occurred since the | | | | reception of the first | | | | Apply Charging IF for the | | | | connection to the Called | | | | Party, the Temporary | | | | Connection, or the gsmSRF | | | | connection, otherwise it | | | | shall be absent. | +--------------------------+--------+-----------------------------+
ACh Charging Address contains the following information elements:
* * *
Information element name Status Description Leg ID E This IE indicates that
the Apply Charging Report IF applies to the specified leg. SRF Connection E
This IE indicates that the Apply Charging Report IF applies to the Temporary
Connection or SRF Connection
* * *
#### 4.6.1.3 Call Information Report
##### 4.6.1.3.1 Description
This IF is used to send specific call information for a single call party to
the gsmSCF as requested by the gsmSCF in a previous Call Information Request
IF.
##### 4.6.1.3.2 Information Elements
* * *
Information element name Status Description Requested Information List M This
IE specifies the requested information. Leg ID M This IE indicates the party
in the call for which information shall be collected.
* * *
#### 4.6.1.4 Disconnect Leg ack
##### 4.6.1.4.1 Description
This IF is the successful response to the Disconnect Leg IF.
##### 4.6.1.4.2 Information Elements
This IF contains no information elements.
#### 4.6.1.5 Entity Released
##### 4.6.1.5.1 Description
This IF is used to inform the gsmSCF about the release of a logical entity (CS
or BCSM) caused by exception or errors. It is sent by the CSA FSM if this
information cannot be conveyed within an TC_ABORT or TC_END because the TC
dialogue has to be kept because of other existing logical entities (CS or
BCSM) in this CSA which are not affected by this error/exception. This IF is
not sent if the last CS was released.
The IF Entity Released is not used if the release of the entity can be
reported through other IFs, e.g. Event Report BCSM, Call Information Report.
##### 4.6.1.5.2 Information Elements
* * *
Information element name Status Description CS Failure E This IE indicates
that an CS has been released. BCSM Failure E This IE indicates that a leg has
been released.
* * *
CS Failure contains the following information elements:
* * *
Information element name Status Description Call Segment ID M This IE
identifies the released CS. Cause C This IE indicates the cause for releasing
the CS. The Cause may be used by the gsmSCF to decide how to continue the call
handling.
* * *
BCSM Failure contains the following information elements:
* * *
Information element name Status Description Leg ID M This IE identifies the
released leg. Cause C This IE indicates the cause for releasing the leg. The
cause may be used by the gsmSCF to decide handling.
* * *
#### 4.6.1.6 Event Report BCSM
##### 4.6.1.6.1 Description
This IF is used to notify the gsmSCF of a call-related event (i.e. BCSM events
as answer and disconnect) previously requested by the gsmSCF in a Request
Report BCSM Event IF.
##### 4.6.1.6.2 Information Elements
* * *
Information element name MO MF MT VT NC NP TO Description Event Type BCSM M M
M M M M M This IE specifies the type of event that is reported. Event Specific
Information BCSM C C C C C C C This IE indicates the call related information
specific to the event. Leg ID M M M M M M M This IE indicates the party in the
call for which the event is reported. Misc Call Info M M M M M M M This IE
indicates the DP type.
* * *
If the Event Type BCSM IE contains either O_Answer or T_Answer, then the Event
Specific Information BCSM IE contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Destination | M | M | M | M | M | M | M | This IE | | Address | | | | | | | | specifies the | | | | | | | | | | destination | | | | | | | | | | address for the | | | | | | | | | | call leg. | | | | | | | | | | | | | | | | | | | | The | | | | | | | | | | * | | | | | | | | | | NatureOfAddress | | | | | | | | | | indicator _may | | | | | | | | | | contain a | | | | | | | | | | na | | | | | | | | | | tional-specific | | | | | | | | | | value. For some | | | | | | | | | | na | | | | | | | | | | tional-specific | | | | | | | | | | * | | | | | | | | | | NatureOfAddress | | | | | | | | | | indicator_ | | | | | | | | | | values the | | | | | | | | | | length of the | | | | | | | | | | digit part of | | | | | | | | | | destination | | | | | | | | | | address may be | | | | | | | | | | zero. | +-----------------+----+----+----+----+----+----+----+-----------------+ | OR | - | C | C | - | - | - | - | This IE | | | | | | | | | | indicates that | | | | | | | | | | the call was | | | | | | | | | | subject to | | | | | | | | | | basic Optimal | | | | | | | | | | Routeing as | | | | | | | | | | specified in | | | | | | | | | | 3GPP | | | | | | | | | | TS | | | | | | | | | | 23.079 [19]. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Forwarded Call | - | M | C | C | - | - | - | This IE | | | | | | | | | | indicates that | | | | | | | | | | the call has | | | | | | | | | | been subject to | | | | | | | | | | a Call | | | | | | | | | | Forwarding | | | | | | | | | | supplementary | | | | | | | | | | service. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Charge | S | S | S | S | S | S | S | This IE | | Indicator | | | | | | | | specifies the | | | | | | | | | | value which | | | | | | | | | | will be stored | | | | | | | | | | in the Call | | | | | | | | | | Data Record. | | | | | | | | | | See ITU‑T | | | | | | | | | | Recommendation | | | | | | | | | | Q.763 [43]. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Ext‑Basic | S | S | S | S | - | - | S | This IE is used | | Service Code | | | | | | | | for SCUDIF | | | | | | | | | | calls. | | | | | | | | | | | | | | | | | | | | It indicates | | | | | | | | | | the type of | | | | | | | | | | basic service, | | | | | | | | | | i.e. | | | | | | | | | | teleservice or | | | | | | | | | | bearer service. | | | | | | | | | | It indicates | | | | | | | | | | the service | | | | | | | | | | active at | | | | | | | | | | answer for the | | | | | | | | | | SCUDIF call (as | | | | | | | | | | defined in 3GPP | | | | | | | | | | TS | | | | | | | | | | 23.172 [27]). | +-----------------+----+----+----+----+----+----+----+-----------------+ | Ext‑Basic | S | S | S | S | - | - | S | This IE is used | | Service Code 2 | | | | | | | | for SCUDIF | | | | | | | | | | calls. | | | | | | | | | | | | | | | | | | | | It indicates | | | | | | | | | | the type of | | | | | | | | | | basic service, | | | | | | | | | | i.e. | | | | | | | | | | teleservice or | | | | | | | | | | bearer service. | | | | | | | | | | It indicates | | | | | | | | | | the service | | | | | | | | | | which is not | | | | | | | | | | active at | | | | | | | | | | answer for the | | | | | | | | | | SCUDIF call (as | | | | | | | | | | defined in 3GPP | | | | | | | | | | TS | | | | | | | | | | 23.172 [27]). | | | | | | | | | | | | | | | | | | | | It shall be | | | | | | | | | | present if the | | | | | | | | | | negotiation of | | | | | | | | | | the SCUDIF | | | | | | | | | | services | | | | | | | | | | resulted in | | | | | | | | | | both basic | | | | | | | | | | services for | | | | | | | | | | the SCUDIF | | | | | | | | | | call. Otherwise | | | | | | | | | | shall be | | | | | | | | | | absent. | +-----------------+----+----+----+----+----+----+----+-----------------+
If the Event Type BCSM IE contains either O_Mid_Call or T_Mid_Call, then the
Event Specific Information BCSM IE contains the following information element:
* * *
Information element name MO MF MT VT NC NP TO Description Midcall Info M - - M
- - M This IE is described in a table below.
* * *
MidCall Info contains the following information elements:
+----------------+-----+----+----+-----+----+----+-----+----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +----------------+-----+----+----+-----+----+----+-----+----------------+ | DTMF Digits | S,E | - | - | S,E | - | - | S,E | This IE | | Completed | | | | | | | | contains the | | | | | | | | | | detected | | | | | | | | | | mid-call | | | | | | | | | | digits. | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | be present | | | | | | | | | | when | | | | | | | | | | triggering | | | | | | | | | | takes place | | | | | | | | | | after the | | | | | | | | | | minimum number | | | | | | | | | | of digits has | | | | | | | | | | been detected. | +----------------+-----+----+----+-----+----+----+-----+----------------+ | DTMF Digits | S,E | - | - | S,E | - | - | S,E | This IE | | Timeout | | | | | | | | contains the | | | | | | | | | | detected | | | | | | | | | | mid-call | | | | | | | | | | digits. | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | be present | | | | | | | | | | when | | | | | | | | | | triggering | | | | | | | | | | takes place | | | | | | | | | | before the | | | | | | | | | | minimum number | | | | | | | | | | of digits has | | | | | | | | | | been detected. | +----------------+-----+----+----+-----+----+----+-----+----------------+
If the Event Type BCSM IE contains one of Route_Select_Failure, O_Busy,
O_Disconnect or T_Disconnect, then the Event Specific Information BCSM IE
contains the following information element:
* * *
Information element name MO MF MT VT NC NP TO Description Cause C C C C C C C
This IE indicates the cause.
* * *
If the Event Type BCSM IE contains T_Busy, then the Event Specific Information
BCSM IE contains the following information elements:
+----------------+----+----+----+----+----+----+----------------+ | Information | MO | MF | MT | VT | NC | NP | Description | | element name | | | | | | | | +----------------+----+----+----+----+----+----+----------------+ | Cause | - | - | C | C | - | - | This IE | | | | | | | | | indicates the | | | | | | | | | cause. | +----------------+----+----+----+----+----+----+----------------+ | Call forwarded | - | - | C | C | - | - | This IE | | | | | | | | | indicates that | | | | | | | | | the call may | | | | | | | | | be forwarded | | | | | | | | | by the | | | | | | | | | appropriate | | | | | | | | | Call | | | | | | | | | Forwarding | | | | | | | | | supplementary | | | | | | | | | service or | | | | | | | | | Call | | | | | | | | | Deflection | | | | | | | | | supplementary | | | | | | | | | service. | | | | | | | | | | | | | | | | | | If T_Busy is | | | | | | | | | reported from | | | | | | | | | the GMSC, then | | | | | | | | | this IE shall | | | | | | | | | be present in | | | | | | | | | the following | | | | | | | | | cases: | | | | | | | | | | | | | | | | | | - The event | | | | | | | | | is triggered | | | | | | | | | by the | | | | | | | | | reception of | | | | | | | | | an FTN in the | | | | | | | | | 2^nd^ Send | | | | | | | | | Routeing Info | | | | | | | | | ack from the | | | | | | | | | HLR; | | | | | | | | | | | | | | | | | | - The event | | | | | | | | | is triggered | | | | | | | | | by the | | | | | | | | | reception of | | | | | | | | | the Resume | | | | | | | | | Call Handling | | | | | | | | | information | | | | | | | | | flow from the | | | | | | | | | VMSC. | | | | | | | | | | | | | | | | | | If T_Busy is | | | | | | | | | reported from | | | | | | | | | the VMSC, then | | | | | | | | | this IE shall | | | | | | | | | be present in | | | | | | | | | the following | | | | | | | | | cases: | | | | | | | | | | | | | | | | | | - The event | | | | | | | | | is triggered | | | | | | | | | by the | | | | | | | | | invocation of | | | | | | | | | conditional | | | | | | | | | call | | | | | | | | | forwarding | | | | | | | | | (Busy or | | | | | | | | | No | | | | | | | | | t_Reachable); | | | | | | | | | | | | | | | | | | - The event | | | | | | | | | notification | | | | | | | | | is triggered | | | | | | | | | by the | | | | | | | | | invocation of | | | | | | | | | Call | | | | | | | | | Deflection. | +----------------+----+----+----+----+----+----+----------------+ | Route Not | - | - | S | - | - | - | This IE | | permitted | | | | | | | indicates that | | | | | | | | | the further | | | | | | | | | call setup | | | | | | | | | will not take | | | | | | | | | place in this | | | | | | | | | GMSC due to | | | | | | | | | the rules of | | | | | | | | | basic optimal | | | | | | | | | routeing. See | | | | | | | | | 3GPP | | | | | | | | | TS | | | | | | | | | 23.079 [19]. | +----------------+----+----+----+----+----+----+----------------+ | Forwarding | - | - | C | C | - | - | This IE | | Destination | | | | | | | contains the | | Number | | | | | | | Forwa | | | | | | | | | rded-to-Number | | | | | | | | | or the | | | | | | | | | Deflec | | | | | | | | | ted-to-Number. | | | | | | | | | It shall be | | | | | | | | | present if the | | | | | | | | | Call Forwarded | | | | | | | | | IE is present. | | | | | | | | | Otherwise, it | | | | | | | | | shall be | | | | | | | | | absent. | +----------------+----+----+----+----+----+----+----------------+
If the Event Type BCSM IE contains T_No_Answer, then the Event Specific
Information BCSM IE contains the following information elements:
+----------------+----+----+----+----+----+----+----------------+ | Information | MO | MF | MT | VT | NC | NP | Description | | element name | | | | | | | | +----------------+----+----+----+----+----+----+----------------+ | Call Forwarded | - | - | C | C | - | - | This IE | | | | | | | | | indicates that | | | | | | | | | the call may | | | | | | | | | be forwarded | | | | | | | | | by the | | | | | | | | | appropriate | | | | | | | | | Call | | | | | | | | | Forwarding | | | | | | | | | supplementary | | | | | | | | | service. | | | | | | | | | | | | | | | | | | If | | | | | | | | | T_No_Answer | | | | | | | | | is reported | | | | | | | | | from the GMSC, | | | | | | | | | then this IE | | | | | | | | | shall be | | | | | | | | | present in the | | | | | | | | | following | | | | | | | | | cases: | | | | | | | | | | | | | | | | | | - The event | | | | | | | | | is triggered | | | | | | | | | by the | | | | | | | | | reception of | | | | | | | | | the Resume | | | | | | | | | Call Handling | | | | | | | | | information | | | | | | | | | flow from the | | | | | | | | | VMSC. | | | | | | | | | | | | | | | | | | If the | | | | | | | | | T_No_Answer | | | | | | | | | is reported | | | | | | | | | from the VMSC, | | | | | | | | | then this IE | | | | | | | | | shall be | | | | | | | | | present in the | | | | | | | | | following | | | | | | | | | cases: | | | | | | | | | | | | | | | | | | - The event | | | | | | | | | is triggered | | | | | | | | | by the | | | | | | | | | invocation of | | | | | | | | | conditional | | | | | | | | | call | | | | | | | | | forwarding | | | | | | | | | (No_Answer). | +----------------+----+----+----+----+----+----+----------------+ | Forwarding | - | - | C | C | - | - | This IE | | Destination | | | | | | | contains the | | Number | | | | | | | Forwa | | | | | | | | | rded-to-Number | | | | | | | | | or the | | | | | | | | | Deflec | | | | | | | | | ted-to-Number. | | | | | | | | | It shall be | | | | | | | | | present if the | | | | | | | | | Call Forwarded | | | | | | | | | IE is present. | | | | | | | | | Otherwise, it | | | | | | | | | shall be | | | | | | | | | absent. | +----------------+----+----+----+----+----+----+----------------+
If the Event Type BCSM IE contains Call_Accepted or O_Term_Seized, then the
Event Specific Information BCSM IE contains the following information
elements:
* * *
Information element name MO MF MT VT NC NP TO Description Location Information
C - - C - - - See subclause 4.6.1.8 with VLR Number IE as "- (not
applicable)".
* * *
NOTE If gsmSCF does not arm DP O_Change_Of_Position, then the Location
Information reported at DP O_Term_Seized may be the same as the Location
Information reported at DP Collected_Information, even when the subscriber has
changed location between DP Collected Information and DP O_Term_Seized.
If the Event Type BCSM IE contains O_Change_Of_Position or
T_Change_Of_Position, then the Event Specific Information BCSM IE contains the
following information elements:
+----------------+----+----+----+----+----+----+----------------+ | Information | MO | MF | MT | VT | NC | NP | Description | | element name | | | | | | | | +----------------+----+----+----+----+----+----+----------------+ | Location | C | - | - | C | - | - | See | | Information | | | | | | | sub | | | | | | | | | clause 4.6.1.8 | | | | | | | | | with VLR | | | | | | | | | Number IE as | | | | | | | | | "- (not | | | | | | | | | applicable)". | +----------------+----+----+----+----+----+----+----------------+ | Met DP | S | - | - | S | - | - | This IE is | | Criteria List | | | | | | | described in a | | | | | | | | | table below. | | | | | | | | | | | | | | | | | | It carries the | | | | | | | | | list of | | | | | | | | | criteria that | | | | | | | | | were triggered | | | | | | | | | and met for | | | | | | | | | the reporting | | | | | | | | | of the change | | | | | | | | | of position | | | | | | | | | event. | | | | | | | | | | | | | | | | | | It shall be | | | | | | | | | present if | | | | | | | | | change of | | | | | | | | | position | | | | | | | | | control info | | | | | | | | | was received | | | | | | | | | in the | | | | | | | | | request. | +----------------+----+----+----+----+----+----+----------------+
Met DP Criteria List contains a list of up to 10 instances of the following
information element:
* * *
Information element name MO MF MT VT NC NP Description Met DP Criterion M - -
M - - Each Met DP Criterion IE is one of the 6 possibilities indicated in the
table below. If multiple instances of the Met DP Criterion IE have the same
value, this is not an error.
* * *
Each instance of the Met DP Criterion IE contains one of the following
information elements:
* * *
Information element name MO MF MT VT NC NP Description Cell Global ID E - - E
- - This IE indicates that the mobile station performed handover across the
boundary of the cell specified in this IE. Furthermore it indicates whether
the handover was into or out of the cell. Service Area ID E - - E - - This IE
indicates that the mobile station performed handover across the boundary of
the service area specified in this IE. Furthermore it indicates whether the
handover was into or out of the service area. Location Area ID E - - E - -
This IE indicates that the mobile station performed handover across the
boundary of the location area specified in this IE. Furthermore it indicates
whether the handover was into or out of the location area. Inter‑System
Handover E - - E - - This IE indicates that the mobile station performed
inter‑system handover. Furthermore it indicates whether the handover was from
GSM to UMTS or from UMTS to GSM. Inter‑PLMN Handover E - - E - - This IE
indicates that the mobile station performed inter‑PLMN handover. Inter‑MSC
Handover E - - E - - This IE indicates that the mobile station performed
inter‑MSC handover.
* * *
If the Event Type BCSM IE contains O_Abandon, then the Event Specific
Information BCSM IE contains the following information elements:
* * *
Information element name MO MF MT VT NC NP TO Description Route Not Permitted
- S - - - - - This IE indicates that the further call setup will not take
place in this MSC due to the rules of basic optimal routeing. See 3GPP TS
23.079 [19].
* * *
If the Event Type BCSM IE contains one of O_Service_Change or
T_Service_Change, then the Event Specific Information BCSM IE contains the
following information elements:
* * *
Information element name MO MF MT VT NC NP TO Description Ext‑Basic Service
Code M M M M - - M This IE indicates the new basic service code after a
successful bearer service modification. Nature of Service Change C C C C - - C
This IE indicates the nature of the service change (User initiated service
change or network initiated service change). Shall be present if available.
Initiator of Service Change M M M M - - M This IE indicates the initiator of
the service change (A side or B side)
* * *
If the Event Type BCSM IE contains O_No_Answer, then the Event Specific
Information BCSM IE is not included.
If the Event Type BCSM IE contains Collected_Info, then the Event Specific
Information BCSM IE contains the following information elements:
+--------------------------+----+-------------------------------+ | Information element name | TO | Description | +--------------------------+----+-------------------------------+ | Called Party Number | M | The contents of the Called | | | | Party Number parameter are as | | | | follows: | | | | | | | | - Nature of address | | | | indicator -- set to the | | | | same value as the Called | | | | Party Number parameter | | | | sent in InitialDP: | | | | | | | | - Numbering plan indicator | | | | -- set to the same value | | | | as the Called Party | | | | Number parameter sent in | | | | InitialDP; | | | | | | | | - Address signals: | | | | | | | | - If 'N' relevant | | | | digits, or more, have | | | | been collected and | | | | the end of pulsing | | | | signal (ST) has not | | | | been received, then | | | | all relevant digits | | | | shall be reported | | | | plus a filler digit, | | | | if necessary (note 1) | | | | | | | | - If the end of pulsing | | | | signal (ST) has been | | | | received then all | | | | relevant digits shall | | | | be reported, plus the | | | | end of pulsing signal | | | | and a filler digit, | | | | if necessary (note 1) | | | | | | | | - If the inter-digit | | | | timer expires in the | | | | MSC then all relevant | | | | digits shall be | | | | reported plus a | | | | filler digit, if | | | | necessary (notes 1 & | | | | 2). | | | | | | | | Note 1: The relevant digits | | | | are the digits originally | | | | reported in InitialDP plus | | | | any additional relevant | | | | digits collected as a result | | | | of the CollectInformation | | | | operation(s). | | | | | | | | Note 2: If the inter-digit | | | | timer expires before any | | | | additional relevant digits | | | | have been collected then the | | | | digits reported are the same | | | | as those previously reported | | | | in InitialDP or | | | | EventReportBCSM. | | | | | | | | Note 3: Some dialled digits | | | | may not be relevant for | | | | reporting. Relevant digits | | | | are determined by operator | | | | defined rules in the MSC, | | | | e.g. operator specific | | | | service selection information | | | | may not be reported. The MSC/ | | | | gsmSSF compares 'N' against | | | | the digits to be reported. | | | | | | | | - | +--------------------------+----+-------------------------------+
#### 4.6.1.7 Initiate Call Attempt ack
##### 4.6.1.7.1 Description
This IF is the successful response to the Initiate Call Attempt IF.
##### 4.6.1.7.2 Information Elements
+----------------------------+----+----+----------------------------+ | Information element name | NC | NP | Description | +----------------------------+----+----+----------------------------+ | Supported CAMEL Phases | M | M | This IE indicates the | | | | | CAMEL Phases supported. | +----------------------------+----+----+----------------------------+ | Offered CAMEL4 | M | M | This IE is described in | | Functionalities | | | subclause 4.6.1.8. | | | | | | | | | | This IE indicates the | | | | | CAMEL phase 4 | | | | | functionalities offered. | +----------------------------+----+----+----------------------------+ | Release Call Argument | O | - | This IE indicates whether | | Extension Allowed | | | the gsmSCF is allowed to | | | | | use network specific IE in | | | | | the Release Call IF. | +----------------------------+----+----+----------------------------+
#### 4.6.1.8 Initial DP
##### 4.6.1.8.1 Description
This IF is generated by the gsmSSF when a trigger is detected at a DP in the
BCSM, to request instructions from the gsmSCF.
##### 4.6.1.8.2 Information Elements
(Note: IEs in the NC columns in this IF may need further study.)
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Additional | C | C | C | C | - | C | C | This IE | | Calling Party | | | | | | | | contains the | | Number | | | | | | | | calling party | | | | | | | | | | number provided | | | | | | | | | | by the access | | | | | | | | | | signalling | | | | | | | | | | system of the | | | | | | | | | | calling user or | | | | | | | | | | received from | | | | | | | | | | the gsmSCF due | | | | | | | | | | to the previous | | | | | | | | | | CAMEL | | | | | | | | | | processing. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Called Party | C | M | M | M | - | M | M | This IE | | Number | | | | | | | | contains the | | | | | | | | | | number used to | | | | | | | | | | identify the | | | | | | | | | | called party in | | | | | | | | | | the forward | | | | | | | | | | direction. | | | | | | | | | | | | | | | | | | | | For MO and MF | | | | | | | | | | calls this IE | | | | | | | | | | is used in the | | | | | | | | | | case of TDP | | | | | | | | | | Route_ | | | | | | | | | | Select_Failure | | | | | | | | | | (this is the | | | | | | | | | | destination | | | | | | | | | | number used to | | | | | | | | | | route the call) | | | | | | | | | | and in the case | | | | | | | | | | of TDP Busy and | | | | | | | | | | TDP No Reply | | | | | | | | | | (this is the | | | | | | | | | | MSISDN when the | | | | | | | | | | destination | | | | | | | | | | number used for | | | | | | | | | | the call is an | | | | | | | | | | MSRN, or in the | | | | | | | | | | case of | | | | | | | | | | unsuccessful | | | | | | | | | | call | | | | | | | | | | establishment | | | | | | | | | | received from | | | | | | | | | | the HLR via the | | | | | | | | | | MAP interface, | | | | | | | | | | otherwise it is | | | | | | | | | | the number used | | | | | | | | | | to route the | | | | | | | | | | call). | | | | | | | | | | | | | | | | | | | | For VT calls | | | | | | | | | | when there is | | | | | | | | | | no forwarding | | | | | | | | | | pending this is | | | | | | | | | | the MSISDN | | | | | | | | | | received in the | | | | | | | | | | Provide Roaming | | | | | | | | | | Number; if the | | | | | | | | | | MSISDN is not | | | | | | | | | | available, the | | | | | | | | | | basic MSISDN is | | | | | | | | | | used. | | | | | | | | | | | | | | | | | | | | For the MT and | | | | | | | | | | VT call case | | | | | | | | | | when there is | | | | | | | | | | call forwarding | | | | | | | | | | or call | | | | | | | | | | deflection | | | | | | | | | | pending, this | | | | | | | | | | is the MSISDN, | | | | | | | | | | i.e. not the | | | | | | | | | | forwarded-to or | | | | | | | | | | deflected-to | | | | | | | | | | number. | | | | | | | | | | | | | | | | | | | | If the Initial | | | | | | | | | | DP IF is sent | | | | | | | | | | at TDP | | | | | | | | | | Route_ | | | | | | | | | | Select_Failure | | | | | | | | | | or TDP | | | | | | | | | | Analys | | | | | | | | | | ed_Information | | | | | | | | | | then the | | | | | | | | | | * | | | | | | | | | | NatureOfAddress | | | | | | | | | | indicator _may | | | | | | | | | | contain a | | | | | | | | | | na | | | | | | | | | | tional-specific | | | | | | | | | | value. For some | | | | | | | | | | na | | | | | | | | | | tional-specific | | | | | | | | | | * | | | | | | | | | | NatureOfAddress | | | | | | | | | | indicator_ | | | | | | | | | | values the | | | | | | | | | | length of the | | | | | | | | | | digit part of | | | | | | | | | | the destination | | | | | | | | | | address may be | | | | | | | | | | zero. | | | | | | | | | | | | | | | | | | | | For TO calls | | | | | | | | | | this IE is used | | | | | | | | | | to identify the | | | | | | | | | | called party in | | | | | | | | | | the forward | | | | | | | | | | direction. It | | | | | | | | | | is used in the | | | | | | | | | | case of TDP | | | | | | | | | | Collect | | | | | | | | | | ed_Information | | | | | | | | | | and TDP | | | | | | | | | | Analyse | | | | | | | | | | d_Information. | | | | | | | | | | The number | | | | | | | | | | contained in | | | | | | | | | | this IE shall | | | | | | | | | | be the relevant | | | | | | | | | | digits, for | | | | | | | | | | reporting | | | | | | | | | | purposes, of | | | | | | | | | | the number | | | | | | | | | | received in the | | | | | | | | | | telephony | | | | | | | | | | signalling | | | | | | | | | | system call | | | | | | | | | | establishment | | | | | | | | | | message (e.g. | | | | | | | | | | ISUP IAM). The | | | | | | | | | | number may or | | | | | | | | | | may not include | | | | | | | | | | the end of | | | | | | | | | | pulsing signal | | | | | | | | | | (ST). | +-----------------+----+----+----+----+----+----+----+-----------------+ | Called Party | C | - | - | - | - | - | - | This IE | | BCD Number | | | | | | | | contains the | | | | | | | | | | number used to | | | | | | | | | | identify the | | | | | | | | | | called party in | | | | | | | | | | the forward | | | | | | | | | | direction. It | | | | | | | | | | is used for an | | | | | | | | | | MO call in all | | | | | | | | | | cases except in | | | | | | | | | | the case of TDP | | | | | | | | | | Route_S | | | | | | | | | | elect_Failure. | | | | | | | | | | | | | | | | | | | | For the TDP | | | | | | | | | | Collecte | | | | | | | | | | d_Information, | | | | | | | | | | the number | | | | | | | | | | contained in | | | | | | | | | | this IE shall | | | | | | | | | | be identical to | | | | | | | | | | the number | | | | | | | | | | received over | | | | | | | | | | the access | | | | | | | | | | network. It may | | | | | | | | | | e.g. include | | | | | | | | | | service | | | | | | | | | | selection | | | | | | | | | | information, | | | | | | | | | | such as ∗ and | | | | | | | | | | # digits, or | | | | | | | | | | carrier | | | | | | | | | | selection | | | | | | | | | | information | | | | | | | | | | dialled by the | | | | | | | | | | subscriber. | | | | | | | | | | | | | | | | | | | | For the TDP | | | | | | | | | | Analyse | | | | | | | | | | d_Information, | | | | | | | | | | the number | | | | | | | | | | contained in | | | | | | | | | | this IE shall | | | | | | | | | | be the dialled | | | | | | | | | | number received | | | | | | | | | | over the | | | | | | | | | | network access | | | | | | | | | | or received | | | | | | | | | | from a gsmSCF | | | | | | | | | | in a Connect | | | | | | | | | | IF, Service | | | | | | | | | | selection | | | | | | | | | | information, | | | | | | | | | | such as * and | | | | | | | | | | # digits may | | | | | | | | | | be present (see | | | | | | | | | | subcla | | | | | | | | | | use 4.2.1.2.2); | | | | | | | | | | carrier | | | | | | | | | | selection | | | | | | | | | | information | | | | | | | | | | dialled by the | | | | | | | | | | subscriber is | | | | | | | | | | not present. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Calling Party | M | C | C | C | - | C | C | This IE carries | | Number | | | | | | | | the calling | | | | | | | | | | party number to | | | | | | | | | | identify the | | | | | | | | | | calling party | | | | | | | | | | or the origin | | | | | | | | | | of the call. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Calling Partys | M | C | C | C | - | C | C | This IE | | Category | | | | | | | | indicates the | | | | | | | | | | type of calling | | | | | | | | | | party (e.g., | | | | | | | | | | operator, pay | | | | | | | | | | phone, ordinary | | | | | | | | | | subscriber). | +-----------------+----+----+----+----+----+----+----+-----------------+ | CallGap | C | C | C | C | - | C | C | This IE | | Encountered | | | | | | | | indicates the | | | | | | | | | | type of gapping | | | | | | | | | | which has been | | | | | | | | | | applied to the | | | | | | | | | | related call. | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | be present only | | | | | | | | | | if a call | | | | | | | | | | gapping context | | | | | | | | | | is applicable | | | | | | | | | | to the Initial | | | | | | | | | | DP IF. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Call Reference | M | M | M | M | - | M | M | This IE may be | | Number | | | | | | | | used by the | | | | | | | | | | gsmSCF for | | | | | | | | | | inclusion in a | | | | | | | | | | network | | | | | | | | | | optional gsmSCF | | | | | | | | | | call record. It | | | | | | | | | | has to be | | | | | | | | | | coupled with | | | | | | | | | | the identity of | | | | | | | | | | the MSC which | | | | | | | | | | allocated it in | | | | | | | | | | order to define | | | | | | | | | | unambiguously | | | | | | | | | | the identity of | | | | | | | | | | the call. | | | | | | | | | | | | | | | | | | | | For MO calls, | | | | | | | | | | the call | | | | | | | | | | reference | | | | | | | | | | number is set | | | | | | | | | | by the serving | | | | | | | | | | VMSC and | | | | | | | | | | included in the | | | | | | | | | | MO call record. | | | | | | | | | | | | | | | | | | | | For MT calls, | | | | | | | | | | the call | | | | | | | | | | reference | | | | | | | | | | number is set | | | | | | | | | | by the GMSC and | | | | | | | | | | included in the | | | | | | | | | | RCF call record | | | | | | | | | | in the GMSC and | | | | | | | | | | in the MT call | | | | | | | | | | record in the | | | | | | | | | | terminating | | | | | | | | | | MSC. | | | | | | | | | | | | | | | | | | | | For VT calls, | | | | | | | | | | the call | | | | | | | | | | reference | | | | | | | | | | number is set | | | | | | | | | | by the GMSC and | | | | | | | | | | included in the | | | | | | | | | | RCF call record | | | | | | | | | | in the GMSC and | | | | | | | | | | in the MT call | | | | | | | | | | record in the | | | | | | | | | | terminating | | | | | | | | | | MSC. | | | | | | | | | | | | | | | | | | | | For MF calls, | | | | | | | | | | the call | | | | | | | | | | reference | | | | | | | | | | number is set | | | | | | | | | | by the GMSC and | | | | | | | | | | included in the | | | | | | | | | | CF record in | | | | | | | | | | the forwarding | | | | | | | | | | MSC. | | | | | | | | | | | | | | | | | | | | For the setting | | | | | | | | | | of the Call | | | | | | | | | | Reference | | | | | | | | | | Number for NP | | | | | | | | | | calls, see the | | | | | | | | | | corresponding | | | | | | | | | | call case above | | | | | | | | | | (MO, MT, VT or | | | | | | | | | | MF). | | | | | | | | | | | | | | | | | | | | For TO calls, | | | | | | | | | | the call | | | | | | | | | | reference | | | | | | | | | | number is set | | | | | | | | | | by the | | | | | | | | | | i | | | | | | | | | | nter-connecting | | | | | | | | | | MSC. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Cause | C | C | C | C | - | - | - | This IE | | | | | | | | | | indicates the | | | | | | | | | | cause specific | | | | | | | | | | to the armed | | | | | | | | | | BCSM DP event. | | | | | | | | | | This IE is | | | | | | | | | | applicable to | | | | | | | | | | DP Route_ | | | | | | | | | | Select_Failure | | | | | | | | | | and DP T_Busy. | | | | | | | | | | The cause may | | | | | | | | | | be used by the | | | | | | | | | | gsmSCF to | | | | | | | | | | decide how to | | | | | | | | | | continue the | | | | | | | | | | call handling. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Event Type BCSM | M | M | M | M | - | M | M | This IE | | | | | | | | | | indicates the | | | | | | | | | | armed BCSM DP | | | | | | | | | | event, | | | | | | | | | | resulting in | | | | | | | | | | the Initial DP | | | | | | | | | | IF. For the TO | | | | | | | | | | traffic case | | | | | | | | | | this will be | | | | | | | | | | 'Collec | | | | | | | | | | tedInformation' | | | | | | | | | | or | | | | | | | | | | 'Analys | | | | | | | | | | edInformation'. | +-----------------+----+----+----+----+----+----+----+-----------------+ | IMSI | M | M | M | M | - | S | - | This IE | | | | | | | | | | identifies the | | | | | | | | | | mobile | | | | | | | | | | subscriber. | | | | | | | | | | | | | | | | | | | | For the NP | | | | | | | | | | case, the IMSI | | | | | | | | | | is mandatory if | | | | | | | | | | the new party | | | | | | | | | | is initiated in | | | | | | | | | | an MO, MF, MT, | | | | | | | | | | or VT call, | | | | | | | | | | otherwise it | | | | | | | | | | shall be | | | | | | | | | | absent. | +-----------------+----+----+----+----+----+----+----+-----------------+ | IP SSP | C | C | C | C | - | C | C | This IE | | Capabilities | | | | | | | | indicates which | | | | | | | | | | SRF resources | | | | | | | | | | are supported | | | | | | | | | | within the | | | | | | | | | | gsmSSF and are | | | | | | | | | | available. If | | | | | | | | | | this IE is | | | | | | | | | | absent, it | | | | | | | | | | indicates that | | | | | | | | | | no gsmSRF is | | | | | | | | | | attached and | | | | | | | | | | available. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Location | M | - | C | M | - | - | - | This IE is | | Information | | | | | | | | described in a | | | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Location Number | M | C | C | C | - | - | C | For mobile | | | | | | | | | | originated | | | | | | | | | | calls this IE | | | | | | | | | | represents the | | | | | | | | | | location of the | | | | | | | | | | calling party. | | | | | | | | | | For all other | | | | | | | | | | call scenarios | | | | | | | | | | this IE | | | | | | | | | | contains the | | | | | | | | | | location number | | | | | | | | | | received in the | | | | | | | | | | incoming ISUP | | | | | | | | | | signalling. | +-----------------+----+----+----+----+----+----+----+-----------------+ | MSC Address | M | M | M | M | - | M | M | For MO calls, | | | | | | | | | | the MSC Address | | | | | | | | | | carries the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the serving | | | | | | | | | | VMSC. | | | | | | | | | | | | | | | | | | | | For MT calls, | | | | | | | | | | the MSC Address | | | | | | | | | | carries the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the GMSC. | | | | | | | | | | | | | | | | | | | | For VT calls, | | | | | | | | | | the MSC Address | | | | | | | | | | carries the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the serving | | | | | | | | | | VMSC. | | | | | | | | | | | | | | | | | | | | For MF calls, | | | | | | | | | | the MSC Address | | | | | | | | | | carries the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the | | | | | | | | | | forwarding MSC. | | | | | | | | | | | | | | | | | | | | For NP case, | | | | | | | | | | see the | | | | | | | | | | corresponding | | | | | | | | | | call case above | | | | | | | | | | (MO, MT, VT or | | | | | | | | | | MF). | | | | | | | | | | | | | | | | | | | | For TO calls, | | | | | | | | | | the MSC Address | | | | | | | | | | carries the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the | | | | | | | | | | i | | | | | | | | | | nter-connecting | | | | | | | | | | MSC. | +-----------------+----+----+----+----+----+----+----+-----------------+ | GMSC Address | - | M | - | M | - | S | - | For MF calls, | | | | | | | | | | the GMSC | | | | | | | | | | Address carries | | | | | | | | | | the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the GMSC. | | | | | | | | | | | | | | | | | | | | For VT calls, | | | | | | | | | | the GMSC | | | | | | | | | | Address carries | | | | | | | | | | the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the GMSC. | | | | | | | | | | | | | | | | | | | | For NP calls, | | | | | | | | | | the GMSC | | | | | | | | | | Address is | | | | | | | | | | mandatory if | | | | | | | | | | the new party | | | | | | | | | | is initiated in | | | | | | | | | | an MF call or | | | | | | | | | | in a VT call, | | | | | | | | | | otherwise it | | | | | | | | | | shall be | | | | | | | | | | absent. The | | | | | | | | | | GMSC Address | | | | | | | | | | carries the | | | | | | | | | | international | | | | | | | | | | E.164 address | | | | | | | | | | of the GMSC. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | S | S | S | S | - | S | S | This IE is | | | | | | | | | | described in a | | | | | | | | | | table below. | | | | | | | | | | | | | | | | | | | | This IE may be | | | | | | | | | | present when | | | | | | | | | | the VPLMN and | | | | | | | | | | the HPLMN of | | | | | | | | | | the subscriber | | | | | | | | | | are both North | | | | | | | | | | American. | | | | | | | | | | | | | | | | | | | | For MO calls, | | | | | | | | | | this IE shall | | | | | | | | | | identify any | | | | | | | | | | carrier that | | | | | | | | | | was explicitly | | | | | | | | | | selected by the | | | | | | | | | | calling | | | | | | | | | | subscriber. If | | | | | | | | | | no carrier was | | | | | | | | | | explicitly | | | | | | | | | | selected, this | | | | | | | | | | IE shall | | | | | | | | | | contain the | | | | | | | | | | calling | | | | | | | | | | subscriber\'s | | | | | | | | | | subscribed | | | | | | | | | | carrier. | | | | | | | | | | | | | | | | | | | | For MT and VT | | | | | | | | | | calls, the IE | | | | | | | | | | shall contain | | | | | | | | | | the carrier | | | | | | | | | | subscribed to | | | | | | | | | | by the called | | | | | | | | | | subscriber. | | | | | | | | | | | | | | | | | | | | For MF calls, | | | | | | | | | | the IE shall | | | | | | | | | | contain the | | | | | | | | | | carrier | | | | | | | | | | subscribed to | | | | | | | | | | by the | | | | | | | | | | forwarding | | | | | | | | | | subscriber. | | | | | | | | | | | | | | | | | | | | For TO calls, | | | | | | | | | | this IE shall | | | | | | | | | | identify any | | | | | | | | | | carrier that | | | | | | | | | | was explicitly | | | | | | | | | | selected by the | | | | | | | | | | calling party | | | | | | | | | | or redirecting | | | | | | | | | | party, as | | | | | | | | | | received from | | | | | | | | | | the telephony | | | | | | | | | | signalling | | | | | | | | | | system (e.g. | | | | | | | | | | ISUP IAM). | +-----------------+----+----+----+----+----+----+----+-----------------+ | Original Called | C | C | C | C | - | - | C | This IE carries | | Party ID | | | | | | | | the dialled | | | | | | | | | | digits if the | | | | | | | | | | call has met | | | | | | | | | | call forwarding | | | | | | | | | | on the route to | | | | | | | | | | the gsmSSF. | | | | | | | | | | This IE shall | | | | | | | | | | also be sent if | | | | | | | | | | it was received | | | | | | | | | | from the gsmSCF | | | | | | | | | | due to previous | | | | | | | | | | CAMEL | | | | | | | | | | processing. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Redirecting | C | C | C | C | - | - | C | This IE | | Party ID | | | | | | | | indicates the | | | | | | | | | | directory | | | | | | | | | | number the call | | | | | | | | | | was redirected | | | | | | | | | | from. This IE | | | | | | | | | | shall also be | | | | | | | | | | sent if it was | | | | | | | | | | received from | | | | | | | | | | the gsmSCF due | | | | | | | | | | to previous | | | | | | | | | | CAMEL | | | | | | | | | | processing. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Redirection | C | C | C | C | - | - | C | This IE | | Information | | | | | | | | contains | | | | | | | | | | forwarding | | | | | | | | | | related | | | | | | | | | | information, | | | | | | | | | | such as the | | | | | | | | | | redirection | | | | | | | | | | counter. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Service Key | M | M | M | M | - | M | M | This IE | | | | | | | | | | indicates to | | | | | | | | | | the gsmSCF the | | | | | | | | | | requested CAMEL | | | | | | | | | | Service. It is | | | | | | | | | | used to address | | | | | | | | | | the required | | | | | | | | | | application | | | | | | | | | | within the | | | | | | | | | | gsmSCF. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Subscriber | - | - | C | C | - | - | - | This IE | | State | | | | | | | | indicates the | | | | | | | | | | status of the | | | | | | | | | | MS. The states | | | | | | | | | | are: | | | | | | | | | | | | | | | | | | | | - CAMEL Busy: | | | | | | | | | | The MS is | | | | | | | | | | engaged on a | | | | | | | | | | transaction for | | | | | | | | | | a mobile | | | | | | | | | | originating or | | | | | | | | | | terminated | | | | | | | | | | c | | | | | | | | | | ircuit-switched | | | | | | | | | | call. | | | | | | | | | | | | | | | | | | | | - Network | | | | | | | | | | Determined Not | | | | | | | | | | Reachable: The | | | | | | | | | | network can | | | | | | | | | | determine from | | | | | | | | | | its internal | | | | | | | | | | data that the | | | | | | | | | | MS is not | | | | | | | | | | reachable. | | | | | | | | | | | | | | | | | | | | - Assumed | | | | | | | | | | Idle: The state | | | | | | | | | | of the MS is | | | | | | | | | | neither \"CAMEL | | | | | | | | | | Busy\" nor | | | | | | | | | | \"Network | | | | | | | | | | Determined Not | | | | | | | | | | Reachable\". | | | | | | | | | | | | | | | | | | | | - Not provided | | | | | | | | | | from VLR. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Time And | M | M | M | M | - | M | M | This IE | | Timezone | | | | | | | | contains the | | | | | | | | | | time that the | | | | | | | | | | gsmSSF was | | | | | | | | | | triggered, and | | | | | | | | | | the time zone | | | | | | | | | | in which gsmSSF | | | | | | | | | | resides. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Call Forwarding | - | - | C | C | - | - | - | If the Initial | | SS Pending | | | | | | | | DP IF is sent | | | | | | | | | | from the GMSC, | | | | | | | | | | then this IE | | | | | | | | | | shall be | | | | | | | | | | present in the | | | | | | | | | | following | | | | | | | | | | cases: | | | | | | | | | | | | | | | | | | | | - The GMSC has | | | | | | | | | | received an FTN | | | | | | | | | | in the 1st Send | | | | | | | | | | Routeing Info | | | | | | | | | | ack IF from the | | | | | | | | | | HLR. | | | | | | | | | | | | | | | | | | | | - The GMSC has | | | | | | | | | | received an FTN | | | | | | | | | | in the 2nd Send | | | | | | | | | | Routeing Info | | | | | | | | | | ack IF from the | | | | | | | | | | HLR and no | | | | | | | | | | relationship | | | | | | | | | | with the gsmSCF | | | | | | | | | | exists at that | | | | | | | | | | moment. | | | | | | | | | | | | | | | | | | | | - The GMSC has | | | | | | | | | | received the | | | | | | | | | | Resume Call | | | | | | | | | | Handling IF | | | | | | | | | | from the VMSC | | | | | | | | | | and no | | | | | | | | | | relationship | | | | | | | | | | with the gsmSCF | | | | | | | | | | exists at that | | | | | | | | | | moment. | | | | | | | | | | | | | | | | | | | | If the Initial | | | | | | | | | | DP IF is sent | | | | | | | | | | from the VMSC, | | | | | | | | | | then this IE | | | | | | | | | | shall be | | | | | | | | | | present in the | | | | | | | | | | following | | | | | | | | | | cases: | | | | | | | | | | | | | | | | | | | | - Conditional | | | | | | | | | | call forwarding | | | | | | | | | | is invoked and | | | | | | | | | | no relationship | | | | | | | | | | with the gsmSCF | | | | | | | | | | exists at that | | | | | | | | | | moment. | | | | | | | | | | | | | | | | | | | | - Call | | | | | | | | | | Deflection is | | | | | | | | | | invoked and no | | | | | | | | | | relationship | | | | | | | | | | with the gsmSCF | | | | | | | | | | exists at that | | | | | | | | | | moment. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Forwarding | - | - | C | C | - | - | - | This IE | | Destination | | | | | | | | contains the | | Number | | | | | | | | Forw | | | | | | | | | | arded-to-Number | | | | | | | | | | or the | | | | | | | | | | Defle | | | | | | | | | | cted-to-Number. | | | | | | | | | | It shall be | | | | | | | | | | present if the | | | | | | | | | | Call Forwarding | | | | | | | | | | SS Pending IE | | | | | | | | | | is present, | | | | | | | | | | otherwise it | | | | | | | | | | shall be | | | | | | | | | | absent. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Service | C | C | C | C | - | C | C | The IE is | | Interaction | | | | | | | | described in a | | Indicators Two | | | | | | | | table below. | | | | | | | | | | | | | | | | | | | | This IE is | | | | | | | | | | present if it | | | | | | | | | | is received in | | | | | | | | | | the ISUP | | | | | | | | | | message or due | | | | | | | | | | to previous | | | | | | | | | | CAMEL | | | | | | | | | | processing. | +-----------------+----+----+----+----+----+----+----+-----------------+ | CUG Index | C | - | - | - | - | C | - | See 3GPP | | | | | | | | | | T | | | | | | | | | | S 23.085 [22] | | | | | | | | | | for details of | | | | | | | | | | this IE. | +-----------------+----+----+----+----+----+----+----+-----------------+ | CUG Interlock | C | C | C | C | - | C | C | This IE shall | | Code | | | | | | | | be set | | | | | | | | | | according to | | | | | | | | | | 3GPP | | | | | | | | | | T | | | | | | | | | | S 23.085 [22] | | | | | | | | | | unless modified | | | | | | | | | | by the gsmSCF | | | | | | | | | | via the Connect | | | | | | | | | | or Continue | | | | | | | | | | With Argument | | | | | | | | | | IFs. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Outgoing Access | C | C | C | C | - | C | C | This IE shall | | Indicator | | | | | | | | be set | | | | | | | | | | according to | | | | | | | | | | the 3GPP | | | | | | | | | | T | | | | | | | | | | S 23.085 [22] | | | | | | | | | | unless modified | | | | | | | | | | by the gsmSCF | | | | | | | | | | via the Connect | | | | | | | | | | or Continue | | | | | | | | | | With Argument | | | | | | | | | | IFs. | +-----------------+----+----+----+----+----+----+----+-----------------+ | MS Classmark 2 | C | - | - | - | - | - | - | This IE | | | | | | | | | | contains the MS | | | | | | | | | | classmark 2, | | | | | | | | | | which is sent | | | | | | | | | | by the MS when | | | | | | | | | | it requests | | | | | | | | | | access to setup | | | | | | | | | | the MO call or | | | | | | | | | | responds to | | | | | | | | | | paging in the | | | | | | | | | | CS domain. | +-----------------+----+----+----+----+----+----+----+-----------------+ | IMEI (with | C | - | - | - | - | - | - | This IE | | software | | | | | | | | contains the | | version) | | | | | | | | IMEISV (as | | | | | | | | | | defined in 3GPP | | | | | | | | | | T | | | | | | | | | | S 23.003 [7]) | | | | | | | | | | of the ME in | | | | | | | | | | use by the | | | | | | | | | | served | | | | | | | | | | subscriber. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Supported CAMEL | M | M | M | M | M | M | M | This IE | | Phases | | | | | | | | indicates the | | | | | | | | | | CAMEL Phases | | | | | | | | | | supported by | | | | | | | | | | the GMSC or the | | | | | | | | | | VMSC. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Offered CAMEL4 | M | M | M | M | M | M | M | This IE is | | Functionalities | | | | | | | | described in a | | | | | | | | | | table below. | | | | | | | | | | | | | | | | | | | | This IE | | | | | | | | | | indicates the | | | | | | | | | | CAMEL phase 4 | | | | | | | | | | functionalities | | | | | | | | | | offered by the | | | | | | | | | | GMSC or the | | | | | | | | | | VMSC. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Bearer | M | C | C | C | - | C | C | This IE | | Capability | | | | | | | | indicates the | | | | | | | | | | bearer | | | | | | | | | | capability | | | | | | | | | | connection to | | | | | | | | | | the user. For a | | | | | | | | | | SCUDIF call (as | | | | | | | | | | defined in 3GPP | | | | | | | | | | TS 23.172 | | | | | | | | | | [27] this IE | | | | | | | | | | indicates the | | | | | | | | | | Bearer | | | | | | | | | | Capability of | | | | | | | | | | the preferred | | | | | | | | | | service. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Bearer | C | C | C | C | - | - | C | This IE | | Capability 2 | | | | | | | | indicates the | | | | | | | | | | bearer | | | | | | | | | | capability of | | | | | | | | | | the less | | | | | | | | | | preferred | | | | | | | | | | service for a | | | | | | | | | | SCUDIF call. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Ext-Basic | C | C | C | C | - | C | C | This IE | | Service Code | | | | | | | | indicates the | | | | | | | | | | basic service, | | | | | | | | | | i.e. | | | | | | | | | | teleservice or | | | | | | | | | | bearer service. | | | | | | | | | | For a SCUDIF | | | | | | | | | | call this IE | | | | | | | | | | indicates the | | | | | | | | | | basic service | | | | | | | | | | of the | | | | | | | | | | preferred | | | | | | | | | | service | +-----------------+----+----+----+----+----+----+----+-----------------+ | Ext-Basic | C | C | C | C | - | - | C | This IE | | Service Code 2 | | | | | | | | indicates the | | | | | | | | | | basic service | | | | | | | | | | of the less | | | | | | | | | | preferred | | | | | | | | | | service for a | | | | | | | | | | SCUDIF call. | +-----------------+----+----+----+----+----+----+----+-----------------+ | High Layer | C | C | C | C | - | C | C | This IE | | Compatibility | | | | | | | | indicates the | | | | | | | | | | high layer | | | | | | | | | | compatibility, | | | | | | | | | | which will be | | | | | | | | | | used to | | | | | | | | | | determine the | | | | | | | | | | I | | | | | | | | | | SDN-teleservice | | | | | | | | | | of a connected | | | | | | | | | | ISDN terminal. | | | | | | | | | | For a SCUDIF | | | | | | | | | | call this IE | | | | | | | | | | indicates the | | | | | | | | | | high layer | | | | | | | | | | compatibility | | | | | | | | | | of the | | | | | | | | | | preferred | | | | | | | | | | service. | +-----------------+----+----+----+----+----+----+----+-----------------+ | High Layer | C | C | C | C | - | C | C | This IE | | Compatibility 2 | | | | | | | | indicates the | | | | | | | | | | high layer | | | | | | | | | | compatibility | | | | | | | | | | of the less | | | | | | | | | | preferred | | | | | | | | | | service for a | | | | | | | | | | SCUDIF call. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Low Layer | C | C | C | C | - | C | C | This IE | | Compatibility | | | | | | | | indicates the | | | | | | | | | | low layer | | | | | | | | | | compatibility, | | | | | | | | | | which will be | | | | | | | | | | used to | | | | | | | | | | determine the | | | | | | | | | | ISDN bearer | | | | | | | | | | capability of a | | | | | | | | | | connected ISDN | | | | | | | | | | terminal. For a | | | | | | | | | | SCUDIF call | | | | | | | | | | this IE | | | | | | | | | | indicates the | | | | | | | | | | Low Layer | | | | | | | | | | Compatibility | | | | | | | | | | of the | | | | | | | | | | preferred | | | | | | | | | | service. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Low Layer | C | C | C | C | - | C | C | This IE | | Compatibility 2 | | | | | | | | indicates the | | | | | | | | | | low layer | | | | | | | | | | compatibility | | | | | | | | | | of the less | | | | | | | | | | preferred | | | | | | | | | | service for a | | | | | | | | | | SCUDIF call. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Enhanced | S | S | - | - | S | S | S | This IE | | Dialled | | | | | | | | indicates that | | Services | | | | | | | | the gsmSCF may | | Allowed | | | | | | | | use the | | | | | | | | | | Enhanced | | | | | | | | | | Dialled | | | | | | | | | | Services (EDS). | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | be included if | | | | | | | | | | and only if all | | | | | | | | | | of following | | | | | | | | | | four conditions | | | | | | | | | | are fulfilled: | | | | | | | | | | | | | | | | | | | | - this IF is | | | | | | | | | | sent due to | | | | | | | | | | triggering on | | | | | | | | | | DP | | | | | | | | | | Analyse | | | | | | | | | | d_Information; | | | | | | | | | | and | | | | | | | | | | | | | | | | | | | | - the EDS | | | | | | | | | | functionality | | | | | | | | | | is offered for | | | | | | | | | | this call (as | | | | | | | | | | indicated in | | | | | | | | | | the Offered | | | | | | | | | | CAMEL4 | | | | | | | | | | Fu | | | | | | | | | | nctionalities); | | | | | | | | | | and | | | | | | | | | | | | | | | | | | | | - there is no | | | | | | | | | | more than one | | | | | | | | | | outgoing leg | | | | | | | | | | within this | | | | | | | | | | call; and | | | | | | | | | | | | | | | | | | | | - there is no | | | | | | | | | | other CAMEL | | | | | | | | | | dialogue active | | | | | | | | | | for the leg for | | | | | | | | | | which this IF | | | | | | | | | | is sent. | +-----------------+----+----+----+----+----+----+----+-----------------+ | User-to-User | O | O | O | O | - | - | O | This IE may be | | Service | | | | | | | | sent if it is | | activation | | | | | | | | received in a | | request | | | | | | | | call control | | | | | | | | | | message. See | | | | | | | | | | 3GPP TS 23.087 | | | | | | | | | | [45], 3GPP TS | | | | | | | | | | 24.008 [30], | | | | | | | | | | and ETSI | | | | | | | | | | EN 3 | | | | | | | | | | 00 356‑1 [40] | | | | | | | | | | for details of | | | | | | | | | | this IE. | +-----------------+----+----+----+----+----+----+----+-----------------+ | User-to-User | O | O | O | O | - | - | O | This IE may be | | Information | | | | | | | | sent if it is | | | | | | | | | | received in a | | | | | | | | | | call control | | | | | | | | | | message. See | | | | | | | | | | 3GPP TS 23.087 | | | | | | | | | | [45], 3GPP TS | | | | | | | | | | 24.008 [30], | | | | | | | | | | and ETSI | | | | | | | | | | EN 3 | | | | | | | | | | 00 356‑1 [40] | | | | | | | | | | for details of | | | | | | | | | | this IE. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Collect | - | - | - | - | - | - | S | This IE | | Information | | | | | | | | indicates | | Allowed | | | | | | | | whether the | | | | | | | | | | gsmSCF is | | | | | | | | | | allowed to use | | | | | | | | | | Collect | | | | | | | | | | Information for | | | | | | | | | | the armed BCSM | | | | | | | | | | DP event. This | | | | | | | | | | IE shall only | | | | | | | | | | be included | | | | | | | | | | when the armed | | | | | | | | | | BCSM DP event | | | | | | | | | | is | | | | | | | | | | 'Collec | | | | | | | | | | tedInformation' | | | | | | | | | | or | | | | | | | | | | 'Analys | | | | | | | | | | edInformation'. | | | | | | | | | | | | | | | | | | | | Note: This IE | | | | | | | | | | shall only be | | | | | | | | | | included for | | | | | | | | | | the | | | | | | | | | | 'Analy | | | | | | | | | | sedInformation' | | | | | | | | | | BCSM DP event | | | | | | | | | | if the | | | | | | | | | | 'Enhanced | | | | | | | | | | Dialled | | | | | | | | | | Services | | | | | | | | | | Allowed' IE is | | | | | | | | | | also present. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Release Call | O | O | O | O | - | O | O | This IE | | Argument | | | | | | | | indicates | | Extension | | | | | | | | whether the | | Allowed | | | | | | | | gsmSCF is | | | | | | | | | | allowed to use | | | | | | | | | | network | | | | | | | | | | specific IE in | | | | | | | | | | the Release | | | | | | | | | | Call IF. | +-----------------+----+----+----+----+----+----+----+-----------------+
Offered CAMEL4 Functionalities contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Initiate Call Attempt | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Initiate Call | | | | Attempt IF. | +-----------------------------+--------+-----------------------------+ | Split Leg | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Split Leg IF. | +-----------------------------+--------+-----------------------------+ | Move Leg | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Move Leg IF. | +-----------------------------+--------+-----------------------------+ | Disconnect Leg | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Disconnect Leg | | | | IF. | +-----------------------------+--------+-----------------------------+ | Entity Released | S | This IE indicates that the | | | | gsmSSF will send to the | | | | gsmSCF the Entity Released | | | | IF, when appropriate. | +-----------------------------+--------+-----------------------------+ | DFC With Argument | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Disconnect | | | | Forward Connection With | | | | Argument IF. | +-----------------------------+--------+-----------------------------+ | Play Tone | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Play Tone IF. | +-----------------------------+--------+-----------------------------+ | DTMF Mid Call | S | This IE indicates that the | | | | gsmSCF may instruct the | | | | gsmSSF to arm the | | | | O_MidCall or T_MidCall | | | | DP. The gsmSCF may instruct | | | | the gsmSSF to automatically | | | | re-arm the DP, when | | | | encountered. | +-----------------------------+--------+-----------------------------+ | Charging Indicator | S | This IE indicates that the | | | | Charge Indicator IE may be | | | | present in the Event Report | | | | BCSM IF reporting the | | | | O_Answer or T_Answer DP. | +-----------------------------+--------+-----------------------------+ | Alerting DP | S | This IE indicates that the | | | | gsmSCF may instruct the | | | | gsmSSF to arm the | | | | O_Term_Seized or | | | | Call_Accepted DP. | +-----------------------------+--------+-----------------------------+ | Location At Alerting | S | This IE indicates that the | | | | Location Information IE | | | | shall be present (if | | | | available) in the Event | | | | Report BCSM IF reporting | | | | the O_Term_Seized or | | | | Call_Accepted DP. | +-----------------------------+--------+-----------------------------+ | Change Of Position DP | S | This IE indicates that the | | | | gsmSCF may instruct the | | | | gsmSSF to arm the | | | | O_Change_Of_Position or | | | | T_Change_Of_Position | | | | DPs. The gsmSCF may | | | | instruct the gsmSSF to | | | | automatically re-arm the | | | | DP, when encountered. | +-----------------------------+--------+-----------------------------+ | OR Interactions | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Basic OR | | | | Interrogation Requested IE | | | | in the Connect or Continue | | | | With Argument IF. | | | | | | | | This IE indicates that the | | | | Route Not Permitted IE may | | | | be present in the Event | | | | Report BCSM IF reporting | | | | the O_Abandon DP. | +-----------------------------+--------+-----------------------------+ | Warning Tone Enhancements | S | This IE indicates that the | | | | gsmSCF may send to the | | | | gsmSSF the Burstlist IE | | | | (within the Audible | | | | Indicator IE) in an Apply | | | | Charging IF. | +-----------------------------+--------+-----------------------------+ | CF Enhancements | S | This IE indicates that the | | | | Forwarding Destination | | | | Number IE may be present in | | | | the Event Report BCSM IF | | | | reporting the T_Busy or | | | | T_No_Answer DP. | +-----------------------------+--------+-----------------------------+ | Criteria for Change Of | S | This IE indicates that the | | Position DP | | gsmSCF may send to the | | | | gsmSSF in the Request | | | | Report BCSM Event IF | | | | criteria for reporting the | | | | report of | | | | O_Change_Of_Position or | | | | T_Change_Of_Position. | +-----------------------------+--------+-----------------------------+ | Subscribed Enhanced Dialled | S | This IE indicates that | | Services | | Subscribed Enhanced Dialled | | | | Services is offered. | +-----------------------------+--------+-----------------------------+ | Serving Network Enhanced | S | This IE indicates that | | Dialled Services | | Serving Network Enhanced | | | | Dialled Services is | | | | offered. | +-----------------------------+--------+-----------------------------+ | Service Change DP | S | This IE indicates that the | | | | gsmSCF may instruct the | | | | gsmSSF to arm the | | | | O_Service_Change or | | | | T_Service_Change DPs. The | | | | gsmSCF may instruct the | | | | gsmSSF to automatically | | | | re-arm the DP, when | | | | encountered. | +-----------------------------+--------+-----------------------------+ | Collect Information | S | This IE indicates that the | | | | gsmSCF may instruct the | | | | gsmSSF to arm the | | | | CollectedInfo EDP and order | | | | the MSC to collect a | | | | specific number of | | | | additional dialled digits. | +-----------------------------+--------+-----------------------------+
Location Information is defined in 3GPP TS 23.018 [12]. The following
differences apply:
+--------------+-----+----+-----+-----+----+----+--------------+ | Information | MO | MF | MT | VT | NC | NP | Description | | element name | | | | | | | | +--------------+-----+----+-----+-----+----+----+--------------+ | Location | - | - | C | C | - | - | See 3GPP | | Number | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Service area | C,E | - | C,E | C,E | - | - | See 3GPP | | ID | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Cell ID | C,E | - | C,E | C,E | - | - | See 3GPP | | | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Geographical | C | - | C | C | - | - | See 3GPP | | information | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Geodetic | C | - | C | C | - | - | See 3GPP | | information | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | VLR number | M | - | C | M | - | - | See 3GPP | | | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Age Of | M | - | C | C | - | - | See 3GPP | | location | | | | | | | TS 23 | | information | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Current | - | - | - | - | - | - | Not | | Location | | | | | | | applicable | | Retrieved | | | | | | | | +--------------+-----+----+-----+-----+----+----+--------------+ | Location | C,E | - | C,E | C,E | - | - | See 3GPP | | area ID | | | | | | | TS 2 | | | | | | | | | 3.003 [7]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Selected LSA | S | - | S | S | - | - | This IE | | Identity | | | | | | | indicates | | | | | | | | | the LSA | | | | | | | | | identity | | | | | | | | | associated | | | | | | | | | with the | | | | | | | | | current | | | | | | | | | position of | | | | | | | | | the MS. It | | | | | | | | | shall be | | | | | | | | | present if | | | | | | | | | the LSA ID | | | | | | | | | in the | | | | | | | | | subscriber | | | | | | | | | data matches | | | | | | | | | the LSA ID | | | | | | | | | of the | | | | | | | | | current | | | | | | | | | cell. In the | | | | | | | | | case of | | | | | | | | | multiple | | | | | | | | | matches the | | | | | | | | | LSA ID with | | | | | | | | | the highest | | | | | | | | | priority | | | | | | | | | shall be | | | | | | | | | present. See | | | | | | | | | 3GPP | | | | | | | | | TS 23 | | | | | | | | | .073 [18]. | | | | | | | | | | | | | | | | | | This IE | | | | | | | | | shall be | | | | | | | | | present if | | | | | | | | | available | | | | | | | | | and SoLSA is | | | | | | | | | supported, | | | | | | | | | otherwise it | | | | | | | | | shall be | | | | | | | | | absent. | +--------------+-----+----+-----+-----+----+----+--------------+ | User CSG | C | - | C | - | - | - | See 3GPP TS | | Information | | | | | | | 23.060 | | | | | | | | | [15]. | +--------------+-----+----+-----+-----+----+----+--------------+ | E-UTRAN Cell | - | - | C,E | - | - | - | See 3GPP | | ID | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+ | Tracking | - | - | C,E | - | - | - | See 3GPP | | area ID | | | | | | | TS 23 | | | | | | | | | .018 [12]. | +--------------+-----+----+-----+-----+----+----+--------------+
Carrier contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | M | M | M | M | - | M | M | This IE | | Identification | | | | | | | | uniquely | | Code | | | | | | | | identifies a | | | | | | | | | | North American | | | | | | | | | | long distance | | | | | | | | | | carrier. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | M | M | M | M | - | M | M | This IE | | Selection | | | | | | | | indicates the | | Information | | | | | | | | way the carrier | | | | | | | | | | was selected, | | | | | | | | | | i.e.: | | | | | | | | | | | | | | | | | | | | - dialled | | | | | | | | | | | | | | | | | | | | - subscribed | +-----------------+----+----+----+----+----+----+----+-----------------+
Service Interaction Indicators Two contains the following information
elements:
* * *
Information element name MO MF MT VT NC NP TO Description Forward Service
Interaction Indicator C C C C - C C This IE is described in a table below.
HOLD Treatment Indicator C - - C - C - This IE indicates whether the CAMEL
subscriber can invoke HOLD for the call. CW Treatment Indicator C - - C - C -
This IE indicates whether CW can be applied for a call to the CAMEL subscriber
whilst this call is ongoing. ECT Treatment Indicator C - - C - C - This IE
indicates whether the call leg can become part of an ECT call initiated by the
CAMEL subscriber.
* * *
Forward Service Interaction Indicator contains the following information
elements:
* * *
Information element name MO MF MT VT NC NP TO Description Conference Treatment
Indicator C C C C - C C This IE indicates whether the call leg can become part
of a MPTY call initiated by the called subscriber. Call Diversion Treatment
Indicator C C C C - C C This IE indicates whether the call can be forwarded
using the Call Forwarding or Call Deflection supplementary services.
* * *
#### 4.6.1.9 Move Leg ack
##### 4.6.1.9.1 Description
This IF is the successful response to the Move Leg IF.
##### 4.6.1.9.2 Information Elements
This IF contains no information elements.
#### 4.6.1.10 Split Leg ack
##### 4.6.1.10.1 Description
This IF is the successful response to the Split Leg IF.
##### 4.6.1.10.2 Information Elements
This IF contains no information elements.
### 4.6.2 gsmSCF to gsmSSF information flows
#### 4.6.2.1 Activity Test
##### 4.6.2.1.1 Description
This IF is used to check for the continued existence of a relationship between
the gsmSCF and gsmSSF. If the relationship is still in existence, then the
gsmSSF will respond. If no reply is received, then the gsmSCF will assume that
the gsmSSF has failed in some way and will take appropriate action.
##### 4.6.2.1.2 Information Elements
This IF contains no information elements.
#### 4.6.2.2 Apply Charging
##### 4.6.2.2.1 Description
This IF is used to instruct the gsmSSF to apply charging mechanisms to control
the call duration.
##### 4.6.2.2.2 Information Elements
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | ACh Billing | M | M | M | M | M | M | M | This IE | | Charging | | | | | | | | specifies the | | Characteristics | | | | | | | | charging | | | | | | | | | | related | | | | | | | | | | information to | | | | | | | | | | be provided by | | | | | | | | | | the gsmSSF and | | | | | | | | | | the conditions | | | | | | | | | | on which this | | | | | | | | | | information has | | | | | | | | | | to be provided | | | | | | | | | | back to the | | | | | | | | | | gsmSCF. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Party To Charge | M | M | M | M | M | M | M | This IE shall | | | | | | | | | | be reflected in | | | | | | | | | | the | | | | | | | | | | corresponding | | | | | | | | | | IE of the Apply | | | | | | | | | | Charging Report | | | | | | | | | | IF. This IE has | | | | | | | | | | no effect on | | | | | | | | | | the charging | | | | | | | | | | procedures in | | | | | | | | | | the MSC. | +-----------------+----+----+----+----+----+----+----+-----------------+ | ACh Charging | M | M | M | M | M | M | M | This IE | | Address | | | | | | | | identifies the | | | | | | | | | | call party to | | | | | | | | | | which the Apply | | | | | | | | | | Charging IF | | | | | | | | | | applies. | | | | | | | | | | | | | | | | | | | | This IE is | | | | | | | | | | described in a | | | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+
ACh Billing Charging Characteristics contains the following information
element:
* * *
Information element name MO MF MT VT NC NP TO Description Time Duration
Charging M M M M M M M This IE is described in a table below.
* * *
Time Duration Charging contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Max Call Period | M | M | M | M | M | M | M | This IE | | Duration | | | | | | | | indicates the | | | | | | | | | | maximum call | | | | | | | | | | period duration | | | | | | | | | | timer. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Tariff Switch | O | O | O | O | O | O | O | This IE | | Interval | | | | | | | | indicates the | | | | | | | | | | tariff switch | | | | | | | | | | time until the | | | | | | | | | | next tariff | | | | | | | | | | switch applies | | | | | | | | | | for this call | | | | | | | | | | leg. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Release If | O | O | O | O | O | O | O | This IE | | Duration | | | | | | | | indicates that | | Exceeded | | | | | | | | the call leg, | | | | | | | | | | SRF connection | | | | | | | | | | or Temporary | | | | | | | | | | connection | | | | | | | | | | shall be | | | | | | | | | | released when | | | | | | | | | | the Max call | | | | | | | | | | Period Duration | | | | | | | | | | expires. The | | | | | | | | | | cause used in | | | | | | | | | | the Release IF | | | | | | | | | | shall be | | | | | | | | | | \"normal | | | | | | | | | | unspecified\". | | | | | | | | | | | | | | | | | | | | The default | | | | | | | | | | handling is to | | | | | | | | | | continue the | | | | | | | | | | call. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Audible | O | - | O | O | O | O | O | This IE is | | Indicator | | | | | | | | described in a | | | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+
Audible Indicator IE contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Tone | E | - | E | E | E | E | E | This IE | | | | | | | | | | indicates that | | | | | | | | | | a fixed | | | | | | | | | | sequence of | | | | | | | | | | tones shall be | | | | | | | | | | played to the | | | | | | | | | | CAMEL | | | | | | | | | | subscriber. In | | | | | | | | | | the NC case, | | | | | | | | | | the first party | | | | | | | | | | created will | | | | | | | | | | receive the | | | | | | | | | | warning tone. | | | | | | | | | | In the TO case | | | | | | | | | | the calling | | | | | | | | | | party will | | | | | | | | | | receive the | | | | | | | | | | warning tone. | | | | | | | | | | If present, | | | | | | | | | | this IE | | | | | | | | | | indicates that | | | | | | | | | | 30 seconds | | | | | | | | | | before the Max | | | | | | | | | | Call Period | | | | | | | | | | Duration timer | | | | | | | | | | expires, a | | | | | | | | | | fixed sequence | | | | | | | | | | of tones | | | | | | | | | | consisting of 3 | | | | | | | | | | tones of 900 | | | | | | | | | | Hz, with a 200 | | | | | | | | | | milliseconds | | | | | | | | | | tone duration | | | | | | | | | | and a 200 | | | | | | | | | | milliseconds | | | | | | | | | | intertone | | | | | | | | | | duration shall | | | | | | | | | | be played. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Burstlist | E | - | E | E | E | E | E | This IE is | | | | | | | | | | described in | | | | | | | | | | the table | | | | | | | | | | below. | | | | | | | | | | | | | | | | | | | | This IE | | | | | | | | | | indicates a | | | | | | | | | | variable | | | | | | | | | | sequence of | | | | | | | | | | bursts that | | | | | | | | | | shall be played | | | | | | | | | | during the call | | | | | | | | | | period to the | | | | | | | | | | CAMEL | | | | | | | | | | subscriber. In | | | | | | | | | | the NC case, | | | | | | | | | | the first party | | | | | | | | | | created will | | | | | | | | | | receive the | | | | | | | | | | warning tone. | | | | | | | | | | In the TO case | | | | | | | | | | the calling | | | | | | | | | | party will | | | | | | | | | | receive the | | | | | | | | | | warning tone. | +-----------------+----+----+----+----+----+----+----+-----------------+
Burstlist IE contains the following information elements:
* * *
Information element name Status Description Warning Period M This IE indicates
the time, before the Max Call Period Duration timer expires, when the Play
Burst List IE shall start. Number Of Bursts M This IE indicates the number of
bursts to be played. There may be up to three bursts. Burst Interval M This IE
indicates the time interval between successive bursts. Number Of Tones In
Burst M This IE indicates the number of tones to be played in each burst.
There may be up to three tones per burst. The tone is fixed to 900 Hz. Tone
Duration M This IE indicates the duration of a tone in a burst. Tone Interval
M This IE indicates the time interval between successive tones in a burst.
* * *
NOTE Service logic designers should note that the total duration of the Burst
List should not exceed the WarningPeriod IE, otherwise an incomplete Burst
List will be played to the served party.
ACh Charging Address contains the following information elements:
* * *
Information element name MO MF MT VT NC NP TO Description Leg ID E E E E E E E
This IE indicates that the Apply Charging IF applies to the specified leg. SRF
Connection E E E E E E E This IE indicates that the Apply Charging IF applies
to the Temporary Connection or SRF Connection
* * *
#### 4.6.2.3 Call Gap
##### 4.6.2.3.1 Description
This IF is used to activate/modify/remove a call gap mechanism in the gsmSSF.
The call gap mechanism is used to reduce the rate at which specific service
requests are sent to a gsmSCF.
A Call Gap IF can only be sent on an opened dialogue between a gsmSCF and a
gsmSSF.
It is possible to have several call gapping conditions applicable to the same
gsmSSF (i.e. each conditions was activated for a defined Service (identified
by the service Key) by a defined gsmSCF (identified by the gsmSCF address).
##### 4.6.2.3.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gap Criteria | M | This IE specifies the | | | | criteria for a call to be | | | | subject to call gapping. | +--------------------------+--------+-----------------------------+ | Gap Indicators | M | This IE indicates the | | | | gapping characteristics. | +--------------------------+--------+-----------------------------+ | Control Type | O | This IE indicates the | | | | reason for activating call | | | | gapping. | | | | | | | | The value \"gsmSCF | | | | Overloaded\" indicates that | | | | an automatic congestion | | | | detection and control | | | | mechanism in the gsmSCF has | | | | detected a congestion | | | | situation. | | | | | | | | The value \"Manually | | | | Initiated\" indicates that | | | | the service and/or | | | | network/service management | | | | centre has detected a | | | | congestion situation, or | | | | any other situation that | | | | requires manually initiated | | | | controls. | | | | | | | | The Control Type \"Manually | | | | Initiated\" will have | | | | priority over a \"gsmSCF | | | | Overloaded\" call gap. | | | | | | | | Note that Non-IN controlled | | | | traffic control mechanism | | | | can also apply to an | | | | exchange with the gsmSSF | | | | functionality. As the | | | | non-IN controlled traffic | | | | control is within the MSC, | | | | this traffic control has | | | | implicit priority over the | | | | IN controlled traffic | | | | control. The non-IN | | | | controlled traffic control | | | | may also have some | | | | influence on the IN call. | | | | Therefore it is recommended | | | | to take measures to | | | | coordinate several traffic | | | | control mechanisms. The | | | | non-IN controlled traffic | | | | control and co-ordination | | | | of several traffic control | | | | mechanisms are out of the | | | | scope of the present | | | | document. | +--------------------------+--------+-----------------------------+ | Gap Treatment | O | This IE indicates how calls | | | | that were rejected due to | | | | the call gapping condition | | | | and have Default Call | | | | Handling as \"Release | | | | Call\" shall be treated. | +--------------------------+--------+-----------------------------+
Gap Criteria contains one of the following information elements:
* * *
Information element name Status Description Basic Gap Criteria O,E This IE is
a choice of various basic criteria. Compound Gap Criteria O,E This IE is a
choice of various criteria including a gsmSCF ID.
* * *
Compound Gap Criteria contains the following information elements:
* * *
Information element name Status Description Basic Gap Criteria M This IE is a
choice of various criteria. gsmSCF ID O This IE contains the address of the
gsmSCF which initiated the Call Gapping.
* * *
Basic Gap Criteria contains one of the following information elements:
* * *
Information element name Status Description Called Address O,E This IE
contains a string of digits. For each call attempt where the leading digits of
the dialled number match this specific value, the call gapping treatment shall
be applied to the call. Service O,E This IE contains a service key value. For
each call attempt where the service key match this specific value, the call
gapping treatment shall be applied to the call. Called Address And Service O,E
This IE contains a specific string of digits and a service key value. For each
call attempt where the leading digits of the dialled number and the service
key of a call match these specific values, the call gapping treatment shall be
applied to the call. Calling Address And Service O,E This IE contains a
specific string of digits and a service key value. For each call attempt where
the leading digits of the calling party number and the service key match these
specific values, the call gapping treatment shall be applied to the call.
* * *
Gap Indicators contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Duration | M | This IE specifies the total | | | | time interval during which | | | | call gapping for the | | | | specified gap criteria will | | | | be active. | | | | | | | | A duration of 0 indicates | | | | that gapping is to be | | | | removed. | | | | | | | | A duration of -2 indicates | | | | a network specific | | | | duration. | | | | | | | | Other values indicate the | | | | duration in seconds. | +--------------------------+--------+-----------------------------+ | Interval | M | This IE specifies the | | | | minimum time between calls | | | | being allowed through. | | | | | | | | An interval of 0 indicates | | | | that calls meeting the gap | | | | criteria are not to be | | | | rejected. | | | | | | | | An interval of -1 indicates | | | | that all calls meeting the | | | | gap criteria are to be | | | | rejected. | | | | | | | | Other values indicate the | | | | interval in milliseconds. | +--------------------------+--------+-----------------------------+
Gap Treatment contains one of the following elements:
* * *
Information element name Status Description Information To Send O,E This IE
indicates an announcement or a tone to be sent to the calling party. At the
tone or announcement, the call shall be released. Release Cause O,E If the
call is to be released, this IE indicates the specific cause value to be sent
in the Release IF. See ETSI EN 300 356‑1 [40] for the coding.
* * *
Information To Send contains one of the following elements:
* * *
Information element name Status Description In-band Info O,E This IE specifies
the in-band information to be sent. Tone O,E This IE specifies a tone to be
sent to the end-user.
* * *
In-band Info contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Message ID | M | This IE is described in a | | | | table below. | | | | | | | | This IE indicates the | | | | message(s) to be sent. | +--------------------------+--------+-----------------------------+ | Message Duration | O | This parameter indicates | | | | the maximum time in seconds | | | | that the message shall be | | | | played/repeated. ZERO | | | | indicates endless | | | | repetition. | +--------------------------+--------+-----------------------------+
Message Id contains the following element:
* * *
Information element name Status Description Elementary Message ID O This IE
indicates a single announcement.
* * *
#### 4.6.2.4 Call Information Request
##### 4.6.2.4.1 Description
This IF is used to request the gsmSSF to record specific information about a
single call party and report it to the gsmSCF (with a Call Information Report
IF).
##### 4.6.2.4.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Requested Information Type | M | This IE is described in a | | List | | table below. | | | | | | | | This IE specifies a list of | | | | specific items of | | | | information which are | | | | requested. | +-----------------------------+--------+-----------------------------+ | Leg ID | M | This IE indicates the party | | | | in the call for which the | | | | information shall be | | | | collected. | +-----------------------------+--------+-----------------------------+
Requested Information Type List contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Call Attempt Elapsed Time | O | This IE indicates that the | | | | Call Attempt Elapsed Time | | | | is requested in the Call | | | | Information Report. | | | | | | | | Call Attempt Elapsed Time | | | | is the duration between the | | | | end of the CAMEL processing | | | | initiating call setup | | | | (Connect, Continue or | | | | Continue With Argument IF) | | | | and the received answer | | | | indication from the called | | | | party side. | | | | | | | | For the Calling Party, the | | | | value of Call Attempt | | | | Elapsed Time in the Call | | | | Information Report shall be | | | | set to 0. | +-----------------------------+--------+-----------------------------+ | Call Stop Time | O | This IE indicates that the | | | | Call Stop Time is requested | | | | in the Call Information | | | | Report. | | | | | | | | Call Stop Time is the time | | | | stamp when the connection | | | | is released. | +-----------------------------+--------+-----------------------------+ | Call Connected Elapsed Time | O | This IE indicates that the | | | | Call Connected Elapsed Time | | | | is requested in the Call | | | | Information Report. | | | | | | | | Call Connected Elapsed Time | | | | is the duration between the | | | | received answer indication | | | | from the called party side | | | | and the release of the | | | | connection. | | | | | | | | For a Calling Party, it | | | | indicates the duration | | | | between the sending of the | | | | Initial DP IF and the | | | | release of that party. | +-----------------------------+--------+-----------------------------+ | Release Cause | O | This IE indicates that the | | | | Release Cause for the call | | | | party is requested in the | | | | Call Information Report. | +-----------------------------+--------+-----------------------------+
#### 4.6.2.5 Cancel
##### 4.6.2.5.1 Description
This IF is used by the gsmSCF to request the gsmSSF to cancel all EDPs and
reports.
##### 4.6.2.5.2 Information Elements
* * *
Information element name Status Description All Requests M This IE indicates
that all active requests for the Event Report BCSM, Apply Charging Report and
Call Information Report IFs shall be cancelled.
* * *
#### 4.6.2.5A Collect Information
##### 4.6.2.5A.1 Description
This IF is used to instruct the gsmSSF to collect additional dialled digits
from the calling party and report them to the gsmSCF. The use of this
operation is only appropriate for a call which has not yet left the set-up
phase.
NOTE: It is advisable to avoid the use of gsmSCF-initiated user interaction
while additional digits are being collected. Interaction with a Specialised
Resource Function (SRF) may result in an ACM being sent to the originating
node which will prevent any further dialled digits being sent.
NOTE: If the gsmSCF sends CAP Connect before the dialling is complete then no
further digits can be collected from the calling party.
##### 4.6.2.5A.2 Information Elements
This IF contains no information elements.
#### 4.6.2.6 Connect
##### 4.6.2.6.1 Description
This IF is used to request the gsmSSF to perform the call processing actions
to route a call to a specific destination. To do so, the gsmSSF may use
destination information from the calling party and existing call set-up
information depending on the information provided by the gsmSCF.
The gsmSCF shall not send this IF when there is a CSA with a single call
segment which includes only leg 1.
##### 4.6.2.6.2 Information Elements
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Alerting | - | - | O | O | - | - | - | This IE | | Pattern | | | | | | | | indicates the | | | | | | | | | | kind of | | | | | | | | | | Alerting | | | | | | | | | | Pattern to be | | | | | | | | | | applied. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Calling Partys | O | O | O | O | O | O | O | This IE | | Category | | | | | | | | indicates the | | | | | | | | | | type of calling | | | | | | | | | | party (e.g., | | | | | | | | | | operator, pay | | | | | | | | | | phone, ordinary | | | | | | | | | | subscriber). | +-----------------+----+----+----+----+----+----+----+-----------------+ | Destination | M | M | M | M | M | M | M | This IE | | Routing Address | | | | | | | | contains the | | | | | | | | | | called party | | | | | | | | | | number towards | | | | | | | | | | which the call | | | | | | | | | | is to be | | | | | | | | | | routed. | | | | | | | | | | | | | | | | | | | | The | | | | | | | | | | NatureOfAddress | | | | | | | | | | indicator may | | | | | | | | | | contain a | | | | | | | | | | na | | | | | | | | | | tional-specific | | | | | | | | | | value. For some | | | | | | | | | | na | | | | | | | | | | tional-specific | | | | | | | | | | * | | | | | | | | | | NatureOfAddress | | | | | | | | | | indicator _| | | | | | | | | | values the | | | | | | | | | | length of the | | | | | | | | | | digit part of | | | | | | | | | | the destination | | | | | | | | | | address may be | | | | | | | | | | zero. The | | | | | | | | | | gsmSCF may use | | | | | | | | | | na | | | | | | | | | | tional-specific | | | | | | | | | | * | | | | | | | | | | NatureOfAddress | | | | | | | | | | indicator_ | | | | | | | | | | values of the | | | | | | | | | | gsmSSF country. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Generic Number | O | O | O | O | O | O | O | This IE | | | | | | | | | | contains the | | | | | | | | | | generic number. | | | | | | | | | | Its used to | | | | | | | | | | convey the | | | | | | | | | | additional | | | | | | | | | | calling party | | | | | | | | | | number, which | | | | | | | | | | e.g. could be | | | | | | | | | | used to modify | | | | | | | | | | the calling | | | | | | | | | | line ID | | | | | | | | | | presented to | | | | | | | | | | the called | | | | | | | | | | user. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | O | O | O | O | O | O | O | This IE is | | | | | | | | | | described in a | | | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+ | NA Originating | O | O | O | O | O | O | O | This IE | | Line | | | | | | | | identifies the | | Information | | | | | | | | type of number | | | | | | | | | | in the Charge | | | | | | | | | | Number (e.g. | | | | | | | | | | subscriber | | | | | | | | | | versus PLMN | | | | | | | | | | operator | | | | | | | | | | number). | +-----------------+----+----+----+----+----+----+----+-----------------+ | Charge Number | O | O | O | O | O | O | O | This IE | | | | | | | | | | identifies the | | | | | | | | | | chargeable | | | | | | | | | | number for the | | | | | | | | | | usage of a | | | | | | | | | | North American | | | | | | | | | | carrier. | +-----------------+----+----+----+----+----+----+----+-----------------+ | O‑CSI | - | - | O | O | - | - | - | This IE | | Applicable | | | | | | | | indicates that | | | | | | | | | | the O‑CSI, if | | | | | | | | | | present shall | | | | | | | | | | be applied on | | | | | | | | | | the outgoing | | | | | | | | | | leg. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Suppress N-CSI | - | - | - | - | - | - | O | This IE | | | | | | | | | | indicates that | | | | | | | | | | N‑CSI, if | | | | | | | | | | present, shall | | | | | | | | | | be suppressed | | | | | | | | | | for the trunk | | | | | | | | | | originated | | | | | | | | | | call. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Original Called | O | O | O | O | O | O | O | This IE carries | | Party ID | | | | | | | | the dialled | | | | | | | | | | digits if the | | | | | | | | | | call has met | | | | | | | | | | call forwarding | | | | | | | | | | on route to the | | | | | | | | | | gsmSSF or is | | | | | | | | | | forwarded by | | | | | | | | | | the gsmSCF. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Leg To Be | S | S | S | S | S | S | S | This IE | | Connected | | | | | | | | indicates the | | | | | | | | | | leg to which | | | | | | | | | | the Connect IF | | | | | | | | | | applies. | | | | | | | | | | | | | | | | | | | | The gsmSCF | | | | | | | | | | shall include | | | | | | | | | | this IE if: | | | | | | | | | | | | | | | | | | | | - The CSA has | | | | | | | | | | more than one | | | | | | | | | | call segment, | | | | | | | | | | or | | | | | | | | | | | | | | | | | | | | - The CSA has | | | | | | | | | | a single call | | | | | | | | | | segment, which | | | | | | | | | | contains: | | | | | | | | | | | | | | | | | | | | > \- one leg, | | | | | | | | | | > which is not | | | | | | | | | | > leg 2; or | | | | | | | | | | > | | | | | | | | | | > \- two legs, | | | | | | | | | | > which are not | | | | | | | | | | > leg 1 and | | | | | | | | | | > leg 2, or | | | | | | | | | | > | | | | | | | | | | > \- more than | | | | | | | | | | > two legs. | | | | | | | | | | | | | | | | | | | | Otherwise this | | | | | | | | | | IE may be | | | | | | | | | | present or | | | | | | | | | | absent as | | | | | | | | | | required by the | | | | | | | | | | service logic. | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | not indicate | | | | | | | | | | leg1. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Redirecting | O | O | O | O | O | O | O | This IE | | Party ID | | | | | | | | indicates the | | | | | | | | | | directory | | | | | | | | | | number the call | | | | | | | | | | was redirected | | | | | | | | | | from. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Redirection | O | O | O | O | O | O | O | This IE | | Information | | | | | | | | contains | | | | | | | | | | forwarding | | | | | | | | | | related | | | | | | | | | | information, | | | | | | | | | | such as | | | | | | | | | | redirecting | | | | | | | | | | counter. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Suppression Of | - | - | O | O | O | O | - | This IE | | Announcements | | | | | | | | indicates that | | | | | | | | | | announcements | | | | | | | | | | or tones | | | | | | | | | | generated as a | | | | | | | | | | result of | | | | | | | | | | unsuccessful | | | | | | | | | | call | | | | | | | | | | establishment | | | | | | | | | | shall be | | | | | | | | | | suppressed. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Service | O | O | O | O | O | O | O | This IE is | | Interaction | | | | | | | | described in a | | Indicators Two | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+ | CUG Interlock | O | O | O | O | O | O | O | See 3GPP | | Code | | | | | | | | T | | | | | | | | | | S 23.085 [22] | | | | | | | | | | for details of | | | | | | | | | | this IE. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Outgoing Access | O | O | O | O | O | O | O | See 3GPP | | Indicator | | | | | | | | T | | | | | | | | | | S 23.085 [22] | | | | | | | | | | for details of | | | | | | | | | | this IE. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Basic OR | O | O | - | - | O | O | O | This IE | | interrogation | | | | | | | | indicates that | | requested | | | | | | | | a Basic Optimal | | | | | | | | | | Routeing | | | | | | | | | | interrogation | | | | | | | | | | is requested | | | | | | | | | | for the call. | | | | | | | | | | If Basic | | | | | | | | | | Optimal | | | | | | | | | | Routeing is | | | | | | | | | | successful, | | | | | | | | | | this will be | | | | | | | | | | reported to the | | | | | | | | | | gsmSCF in the | | | | | | | | | | Answer event | | | | | | | | | | report. | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | be ignored if | | | | | | | | | | the VMSC | | | | | | | | | | associated with | | | | | | | | | | the gsmSSF does | | | | | | | | | | not support | | | | | | | | | | Basic Optimal | | | | | | | | | | Routeing. | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | be ignored if | | | | | | | | | | it is received | | | | | | | | | | in a gsmSSF | | | | | | | | | | which is | | | | | | | | | | handling the MF | | | | | | | | | | call case in | | | | | | | | | | the GMSC | | | | | | | | | | function of the | | | | | | | | | | forwarding | | | | | | | | | | subscriber. | +-----------------+----+----+----+----+----+----+----+-----------------+
Carrier contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | M | M | M | M | M | M | M | This IE | | Identification | | | | | | | | uniquely | | Code | | | | | | | | identifies a | | | | | | | | | | North American | | | | | | | | | | long distance | | | | | | | | | | carrier. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | M | M | M | M | M | M | M | This IE | | Selection | | | | | | | | indicates the | | Information | | | | | | | | way the carrier | | | | | | | | | | was selected | | | | | | | | | | e.g.: | | | | | | | | | | | | | | | | | | | | - dialled; | | | | | | | | | | | | | | | | | | | | - subscribed. | +-----------------+----+----+----+----+----+----+----+-----------------+
Service Interaction Indicators Two contains the following information
elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Forward Service | O | O | O | O | O | O | O | This IE is | | Interaction | | | | | | | | described in a | | Indicator | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Backward | O | O | O | O | - | - | O | This IE is | | Service | | | | | | | | described in a | | Interaction | | | | | | | | table below. | | Indicator | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | HOLD Treatment | O | - | - | O | - | - | - | This IE allows | | Indicator | | | | | | | | the gsmSCF to | | | | | | | | | | disallow the | | | | | | | | | | invocation of | | | | | | | | | | HOLD by the | | | | | | | | | | CAMEL | | | | | | | | | | subscriber. | +-----------------+----+----+----+----+----+----+----+-----------------+ | CW Treatment | O | - | - | O | - | - | - | This IE allows | | Indicator | | | | | | | | the gsmSCF to | | | | | | | | | | disallow the | | | | | | | | | | invocation of | | | | | | | | | | CW for a call | | | | | | | | | | to the CAMEL | | | | | | | | | | subscriber | | | | | | | | | | whilst this | | | | | | | | | | call is | | | | | | | | | | ongoing. | +-----------------+----+----+----+----+----+----+----+-----------------+ | ECT Treatment | O | - | - | O | - | - | - | This IE allows | | Indicator | | | | | | | | the gsmSCF to | | | | | | | | | | disallow the | | | | | | | | | | call leg to | | | | | | | | | | become part of | | | | | | | | | | an ECT call | | | | | | | | | | initiated by | | | | | | | | | | the CAMEL | | | | | | | | | | subscriber. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Connected | O | O | O | O | - | - | O | This IE | | number | | | | | | | | indicates the | | treatment | | | | | | | | treatment of | | indicator | | | | | | | | the connected | | | | | | | | | | number at the | | | | | | | | | | originating | | | | | | | | | | side. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Non-CUG Call | O | O | O | O | O | O | O | This IE | | | | | | | | | | indicates that | | | | | | | | | | no parameters | | | | | | | | | | for CUG should | | | | | | | | | | be used for the | | | | | | | | | | call (i.e. the | | | | | | | | | | call should be | | | | | | | | | | a non-CUG | | | | | | | | | | call). | | | | | | | | | | | | | | | | | | | | Shall be absent | | | | | | | | | | if one or more | | | | | | | | | | of CUG | | | | | | | | | | Interlock Code | | | | | | | | | | and Outgoing | | | | | | | | | | Access | | | | | | | | | | Indicator is | | | | | | | | | | present in the | | | | | | | | | | IF. | +-----------------+----+----+----+----+----+----+----+-----------------+
Forward Service Interaction Indicator contains the following information
elements:
* * *
Information element name MO MF MT VT NC NP TO Description Conference Treatment
Indicator O O O O O - O This IE allows the gsmSCF to disallow the call leg to
become part of a MPTY call initiated by the CAMEL subscriber. Call Diversion
Treatment Indicator O O O O O - O This IE allows the gsmSCF to disallow the
Call Forwarding or Call Deflection supplementary services for this call.
Calling Party Restriction Indicator O O O O O O O This IE allows the gsmSCF to
mark the CLI as Restricted for the call.
* * *
Backward Service Interaction Indicator contains the following information
elements:
* * *
Information element name MO MF MT VT NC NP TO Description Conference Treatment
Indicator O O O O - O O This IE allows the gsmSCF to disallow the call leg to
become part of a MPTY call initiated by the calling subscriber. Call
Completion Treatment Indicator O O O O - O O This IE allows the gsmSCF to
disallow a CCBS request to be made for the call. See also 3GPP TS 23.093 [26]
for description.
* * *
#### 4.6.2.7 Connect To Resource
##### 4.6.2.7.1 Description
This IF is used to connect a call from the gsmSSF to a gsmSRF.
##### 4.6.2.7.2 Information Elements
* * *
Information element name Status Description Resource Address M This IE
indicates the address of the gsmSRF to which the connection shall be
established. It is described in a table below. Service Interaction Indicators
Two O This IE indicates whether or not a bothway through connection is
required between the call segment and the calling party. When there is no
calling party connected to the call segment, then the gsmSSF shall ignore this
IE, if received. The handling when this IE is not present is defined in ETSI
EN 301 070‑1 ([41]). Call Segment ID M This IE indicates the call segment to
be connected to the resource. The subsequent user interaction shall apply to
all parties connected to the call segment.
* * *
Resource Address contains the following information elements:
* * *
Information element name Status Description IP Routing Address E This IE
indicates the routeing address to set up a connection between the call segment
and the gsmSRF. None E This IE indicates that the call segment shall be
connected to a predefined gsmSRF.
* * *
#### 4.6.2.8 Continue
##### 4.6.2.8.1 Description
This IF requests the gsmSSF to proceed with call processing at the DP at which
it previously suspended call processing to await gsmSCF instructions. The
gsmSSF completes DP processing, and continues basic call processing (i.e.
proceeds to the next point in call in the BCSM) without substituting new data
from the gsmSCF.
The gsmSCF may send this operation only when there is a CSA with a single call
segment which includes:
\- only leg 1, or
\- only leg 2, or
\- leg 1 and leg 2 but no other legs.
##### 4.6.2.8.2 Information Elements
This IF contains no information elements.
#### 4.6.2.9 Continue With Argument
##### 4.6.2.9.1 Description
This IF requests the gsmSSF to continue the call processing with modified
information at the DP at which it previously suspended call processing to
await gsmSCF instructions or to continue call processing after a Call Party
Handling IF was received. The gsmSSF completes DP processing if necessary, and
continues basic call processing (i.e. proceeds to the next point in call in
the BCSM) with the modified call setup information as received from the
gsmSCF.
This IF may also be used to continue call processing after an Initiate Call
Attempt IF and Call Party Handling IF.
The gsmSCF can send modified call information at DP Collected_Info and at DP
Analysed_Info, as listed in the MO and MF columns in subclause 4.6.2.9.2.
The gsmSCF can send modified call information at DP
Termination_Attempt_Authorised, as listed in the MT and VT columns in
subclause 4.6.2.9.2.
The gsmSCF can send modified call information immediately after sending an
Initiate Call Attempt IF, as listed in the NC and NP columns in subclause
4.6.2.9.2.
The gsmSCF can send modified call information at DP Collected_Info and at
DP_Analysed_Info, as listed in the TO column in subclause 4.6.2.9.2.
In all other cases, Continue With Argument shall contain no other IE than Leg
ID or Call Segment ID.
When this IF is used to resume the processing of an Initiate Call Attempt IF,
then a Leg ID shall be included and Call Segment ID shall be absent.
When this IF is used to resume the processing of a Call Party Handling IF,
then a Call Segment ID shall be included and Leg ID shall be absent.
When this IF is used to resume processing after an EDP-R or TDP-R, then a Leg
ID shall be included and Call Segment ID shall be absent. The following
exception exists: if this IF is used to resume processing after an EDP‑R or
TDP‑R in one of the following scenarios:
\- the CSA has one Call Segment only, which includes leg 1 only;
\- the CSA has one Call Segment only, which includes leg 2 only;
\- the CSA has one Call Segment only, which includes leg 1 and leg 2, but no
other legs;
then, the Leg ID may be present or absent, as required by the Service Logic.
##### 4.6.2.9.2 Information Elements
+--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Alerting | - | - | O | O | O | - | - | This IE | | Pattern | | | | | | | | indicates | | | | | | | | | | the kind of | | | | | | | | | | Alerting | | | | | | | | | | Pattern to | | | | | | | | | | be applied. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Calling | O | O | O | O | O | O | O | This IE | | Partys | | | | | | | | indicates | | Category | | | | | | | | the type of | | | | | | | | | | calling | | | | | | | | | | party (e.g., | | | | | | | | | | operator, | | | | | | | | | | pay phone, | | | | | | | | | | ordinary | | | | | | | | | | subscriber). | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Generic | O | O | O | O | O | O | O | This IE | | Number | | | | | | | | contains the | | | | | | | | | | generic | | | | | | | | | | number. It | | | | | | | | | | is used to | | | | | | | | | | convey the | | | | | | | | | | additional | | | | | | | | | | calling | | | | | | | | | | party | | | | | | | | | | number, | | | | | | | | | | which e.g. | | | | | | | | | | could be | | | | | | | | | | used to | | | | | | | | | | modify the | | | | | | | | | | calling line | | | | | | | | | | ID presented | | | | | | | | | | to the | | | | | | | | | | called user. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Carrier | O | O | O | O | O | O | O | This IE is | | | | | | | | | | described in | | | | | | | | | | a table | | | | | | | | | | below. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | NA | O | O | O | O | O | O | O | This IE | | Originating | | | | | | | | identifies | | Line | | | | | | | | the type of | | Information | | | | | | | | number in | | | | | | | | | | the Charge | | | | | | | | | | Number (e.g. | | | | | | | | | | subscriber | | | | | | | | | | versus PLMN | | | | | | | | | | operator | | | | | | | | | | number). | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Charge | O | O | O | O | O | O | O | This IE | | Number | | | | | | | | identifies | | | | | | | | | | the | | | | | | | | | | chargeable | | | | | | | | | | number for | | | | | | | | | | the usage of | | | | | | | | | | a North | | | | | | | | | | American | | | | | | | | | | carrier. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Suppression | - | - | O | O | O | O | - | This IE | | Of | | | | | | | | indicates | | A | | | | | | | | that | | nnouncements | | | | | | | | a | | | | | | | | | | nnouncements | | | | | | | | | | or tones | | | | | | | | | | generated as | | | | | | | | | | a result of | | | | | | | | | | unsuccessful | | | | | | | | | | call | | | | | | | | | | e | | | | | | | | | | stablishment | | | | | | | | | | shall be | | | | | | | | | | suppressed. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Service | O | O | O | O | O | O | O | This IE is | | Interaction | | | | | | | | described in | | Indicators | | | | | | | | a table | | Two | | | | | | | | below. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | CUG | O | O | - | - | O | O | O | See 3GPP | | Interlock | | | | | | | | TS 2 | | Code | | | | | | | | 3.085 [22] | | | | | | | | | | for details | | | | | | | | | | of this IE. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Outgoing | O | O | - | - | O | O | O | See 3GPP | | Access | | | | | | | | TS 2 | | Indicator | | | | | | | | 3.085 [22] | | | | | | | | | | for details | | | | | | | | | | of this IE. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Basic OR | O | O | - | - | O | O,S | O | This IE | | I | | | | | | | | indicates | | nterrogation | | | | | | | | that a Basic | | Requested | | | | | | | | Optimal | | | | | | | | | | Routeing | | | | | | | | | | i | | | | | | | | | | nterrogation | | | | | | | | | | is requested | | | | | | | | | | for the | | | | | | | | | | call. If | | | | | | | | | | Basic | | | | | | | | | | Optimal | | | | | | | | | | Routeing is | | | | | | | | | | successful, | | | | | | | | | | this will be | | | | | | | | | | reported to | | | | | | | | | | the gsmSCF | | | | | | | | | | in the | | | | | | | | | | Answer event | | | | | | | | | | report. | | | | | | | | | | | | | | | | | | | | This IE | | | | | | | | | | shall be | | | | | | | | | | ignored if | | | | | | | | | | the VMSC | | | | | | | | | | associated | | | | | | | | | | with the | | | | | | | | | | gsmSSF does | | | | | | | | | | not support | | | | | | | | | | Basic | | | | | | | | | | Optimal | | | | | | | | | | Routeing. | | | | | | | | | | | | | | | | | | | | This IE | | | | | | | | | | shall be | | | | | | | | | | ignored if | | | | | | | | | | it is | | | | | | | | | | received in | | | | | | | | | | a gsmSSF | | | | | | | | | | which is | | | | | | | | | | handling the | | | | | | | | | | MF call case | | | | | | | | | | in the GMSC | | | | | | | | | | function of | | | | | | | | | | the | | | | | | | | | | forwarding | | | | | | | | | | subscriber. | | | | | | | | | | | | | | | | | | | | For an NP | | | | | | | | | | call leg, | | | | | | | | | | this IE can | | | | | | | | | | only be | | | | | | | | | | included if | | | | | | | | | | the original | | | | | | | | | | call was an | | | | | | | | | | MO or NC | | | | | | | | | | call. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Leg ID | O,E | O,E | O,E | O,E | O,E | O,E | O,E | This IE | | | | | | | | | | indicates | | | | | | | | | | the party | | | | | | | | | | for which | | | | | | | | | | call | | | | | | | | | | processing | | | | | | | | | | is to be | | | | | | | | | | resumed. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Call Segment | O,E | O,E | O,E | O,E | O,E | O,E | O,E | This IE | | ID | | | | | | | | indicates | | | | | | | | | | the call | | | | | | | | | | segment for | | | | | | | | | | which call | | | | | | | | | | processing | | | | | | | | | | is to be | | | | | | | | | | resumed. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Suppress | - | - | O | O | - | - | - | This IE | | O‑CSI | | | | | | | | indicates | | | | | | | | | | that O‑CSI | | | | | | | | | | shall be | | | | | | | | | | suppressed | | | | | | | | | | for the | | | | | | | | | | forwarding | | | | | | | | | | leg or | | | | | | | | | | deflecting | | | | | | | | | | leg. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Suppress | - | - | - | - | - | O | - | This IE | | D‑CSI | | | | | | | | indicates | | | | | | | | | | that D‑CSI | | | | | | | | | | shall be | | | | | | | | | | suppressed | | | | | | | | | | for the new | | | | | | | | | | call leg. | | | | | | | | | | This IE can | | | | | | | | | | only be | | | | | | | | | | included if | | | | | | | | | | this IE is | | | | | | | | | | sent to the | | | | | | | | | | VMSC or GMSC | | | | | | | | | | of the CAMEL | | | | | | | | | | subscriber. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Suppress | - | - | - | - | O | O | O | This IE | | N‑CSI | | | | | | | | indicates | | | | | | | | | | that N‑CSI | | | | | | | | | | shall be | | | | | | | | | | suppressed | | | | | | | | | | for the new | | | | | | | | | | call leg or | | | | | | | | | | trunk | | | | | | | | | | originated | | | | | | | | | | call. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+ | Suppress | - | - | - | - | - | O | - | This IE | | Outgoing | | | | | | | | indicates | | Call Barring | | | | | | | | that | | | | | | | | | | Outgoing | | | | | | | | | | Call | | | | | | | | | | Barrings for | | | | | | | | | | the created | | | | | | | | | | leg shall be | | | | | | | | | | suppressed. | | | | | | | | | | This IE can | | | | | | | | | | only be | | | | | | | | | | included if | | | | | | | | | | the Initiate | | | | | | | | | | Call Attempt | | | | | | | | | | IF is sent | | | | | | | | | | to the VMSC | | | | | | | | | | of the CAMEL | | | | | | | | | | subscriber. | +--------------+-----+-----+-----+-----+-----+-----+-----+--------------+
Carrier contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | M | M | M | M | M | M | M | This IE | | Identification | | | | | | | | uniquely | | Code | | | | | | | | identifies a | | | | | | | | | | North American | | | | | | | | | | long distance | | | | | | | | | | carrier. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Carrier | M | M | M | M | M | M | M | This IE | | Selection | | | | | | | | indicates the | | Information | | | | | | | | way the carrier | | | | | | | | | | was selected, | | | | | | | | | | i.e.: | | | | | | | | | | | | | | | | | | | | - dialled | | | | | | | | | | | | | | | | | | | | - subscribed | +-----------------+----+----+----+----+----+----+----+-----------------+
Service Interaction Indicators Two contains the following information
elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Forward Service | O | O | O | O | O | O | O | This IE is | | Interaction | | | | | | | | described in a | | Indicator | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Backward | O | O | O | O | - | - | O | This IE is | | Service | | | | | | | | described in a | | Interaction | | | | | | | | table below. | | Indicator | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | HOLD Treatment | O | - | - | O | - | - | - | This IE allows | | Indicator | | | | | | | | the gsmSCF to | | | | | | | | | | disallow the | | | | | | | | | | invocation of | | | | | | | | | | HOLD by the | | | | | | | | | | CAMEL | | | | | | | | | | subscriber. | +-----------------+----+----+----+----+----+----+----+-----------------+ | CW Treatment | O | - | - | O | - | - | - | This IE allows | | Indicator | | | | | | | | the gsmSCF to | | | | | | | | | | disallow the | | | | | | | | | | invocation of | | | | | | | | | | CW for a call | | | | | | | | | | to the CAMEL | | | | | | | | | | subscriber | | | | | | | | | | whilst this | | | | | | | | | | call is | | | | | | | | | | ongoing. | +-----------------+----+----+----+----+----+----+----+-----------------+ | ECT Treatment | O | - | - | O | - | - | - | This IE allows | | Indicator | | | | | | | | the gsmSCF to | | | | | | | | | | disallow the | | | | | | | | | | call leg to | | | | | | | | | | become part of | | | | | | | | | | an ECT call | | | | | | | | | | initiated by | | | | | | | | | | the CAMEL | | | | | | | | | | subscriber. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Connected | O | O | O | O | - | - | - | This IE | | Number | | | | | | | | indicates the | | Treatment | | | | | | | | treatment of | | Indicator | | | | | | | | the connected | | | | | | | | | | number at the | | | | | | | | | | originating | | | | | | | | | | side. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Non-CUG Call | O | O | - | - | - | O | O | This IE | | | | | | | | | | indicates that | | | | | | | | | | no parameters | | | | | | | | | | for CUG should | | | | | | | | | | be used for the | | | | | | | | | | call (i.e. the | | | | | | | | | | call should be | | | | | | | | | | a non-CUG | | | | | | | | | | call). | | | | | | | | | | | | | | | | | | | | This IE shall | | | | | | | | | | be absent if | | | | | | | | | | one or more of | | | | | | | | | | CUG Interlock | | | | | | | | | | Code and | | | | | | | | | | Outgoing Access | | | | | | | | | | Indicator are | | | | | | | | | | present in the | | | | | | | | | | IF. | +-----------------+----+----+----+----+----+----+----+-----------------+
Forward Service Interaction Indicator contains the following information
elements:
* * *
Information element name MO MF MT VT NC NP TO Description Conference Treatment
Indicator O O O O O O O This IE indicates whether the call leg can become part
of a MPTY call initiated by the called subscriber. Call Diversion Treatment
Indicator O O O O O O O This IE indicates whether the call can be forwarded
using the Call Forwarding or Call Deflection supplementary services. Calling
Party Restriction Indicator O O O O O O O This IE allows the gsmSCF to mark
the CLI as Restricted for the call.
* * *
Backward Service Interaction Indicator contains the following information
elements:
* * *
Information element name MO MF MT VT NC NP TO Description Conference Treatment
Indicator O O O O - - O This IE indicates if the call leg can become part of a
MPTY call initiated by the calling subscriber. Call Completion Treatment
Indicator O O O O - - O This IE indicates whether a CCBS request can be made
for the call. See also 3GPP TS 23.093 [26] for description.
* * *
#### 4.6.2.10 Disconnect Forward Connection
##### 4.6.2.10.1 Description
This IF is used:
\- to disconnect a connection with a gsmSRF previously established with a
Connect To Resource IF;
\- to disconnect an initiating gsmSSF from an assisting gsmSSF and its
associated gsmSRF. The IF is sent to the initiating gsmSSF.
##### 4.6.2.10.2 Information Elements
This IF contains no information elements.
#### 4.6.2.11 Disconnect Forward Connection With Argument
##### 4.6.2.11.1 Description
This IF is used in the following two cases:
1) To clear a connection to a gsmSRF: This IF is used to explicitly disconnect
a connection to a resource (gsmSRF) established previously with a Connect To
Resource or an Establish Temporary Connection IF. It is used for a forward
disconnection from the gsmSSF.
2) To clear a connection to an assisting SSF: This IF is sent to the non-
assisting SSF of a pair of SSFs involved in an assist procedure. It is used to
disconnect the temporary connection between the initiating SSF and the
assisting SSF.
##### 4.6.2.11.2 Information Elements
* * *
Information element name Status Description Call Segment ID M This IE
indicates the call segment in the call to be disconnected from the resource or
the temporary connection.
* * *
#### 4.6.2.12 Disconnect Leg
##### 4.6.2.12.1 Description
This IF is used to request the gsmSSF to release a specific leg associated
with the call at any phase. All other legs in this call are retained. If the
last leg of the call segment is disconnected, then the call segment is
deleted.
##### 4.6.2.12.2 Information Elements
* * *
Information element name Status Description Leg To Be Released M This IE
indicates the party in the call to be released. Release Cause O This IE
indicates to the gsmSSF the reason for releasing the identified party. This
may be used by the MSC or GMSC for generating specific tones to the party to
be released or to fill in the \"cause\" IE in the Release IF.
* * *
#### 4.6.2.13 Establish Temporary Connection
##### 4.6.2.13.1 Description
This IF is used to create a connection between an initiating gsmSSF and an
assisting gsmSSF as a part of the assist procedure. It can also be used to
create a connection between a gsmSSF and a gsmSRF.
##### 4.6.2.13.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Assisting SSP IP Routing | M | This IE indicates the | | Address | | destination address of the | | | | gsmSRF or assisting gsmSSF | | | | for the assist procedure. | | | | As a network operator | | | | option, the Assisting | | | | gsmSSF IP Routing Address | | | | may contain embedded within | | | | it, a \"Correlation ID\" | | | | and \"gsmSCF ID\", but only | | | | if \"Correlation ID\" and | | | | \"gsmSCF ID\" are not | | | | specified separately. | +-----------------------------+--------+-----------------------------+ | Correlation ID | O | This IE is used for: | | | | | | | | - the correlation of | | | | dialogues from the | | | | initiating gsmSSF-> gsmSCF | | | | with dialogues from gsmSRF | | | | -> gsmSCF; | | | | | | | | - the correlation of | | | | dialogues from the | | | | initiating gsmSSF-> gsmSCF | | | | with dialogues from | | | | assisting gsmSSF -> | | | | gsmSCF. | +-----------------------------+--------+-----------------------------+ | Carrier | O | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | NA Originating Line | O | This IE identifies the type | | Information | | of number in the Charge | | | | Number (e.g. subscriber | | | | versus PLMN operator | | | | number). | +-----------------------------+--------+-----------------------------+ | Charge Number | O | This IE identifies the | | | | chargeable number for the | | | | usage of a North American | | | | carrier. | +-----------------------------+--------+-----------------------------+ | gsmSCF ID | O | This IE indicates the | | | | gsmSCF identifier. | +-----------------------------+--------+-----------------------------+ | Service Interaction | O | This IE indicates whether | | Indicators Two | | or not a bothway through | | | | connection is required | | | | between the call segment | | | | and the calling party. When | | | | there is no calling party | | | | connected to the call | | | | segment, then the gsmSSF | | | | shall ignore this IE, if | | | | received. The handling when | | | | this IE is not present is | | | | defined in ETSI | | | | EN 301 070‑1 [41]. | +-----------------------------+--------+-----------------------------+ | Call Segment ID | M | This IE indicates the call | | | | segment to be connected to | | | | the resource. The | | | | subsequent user interaction | | | | shall apply to all parties | | | | connected to the call | | | | segment. | +-----------------------------+--------+-----------------------------+ | Original Called Party ID | O | This IE may be used to | | | | identify the original | | | | called party. If present, | | | | it shall be included in the | | | | ISUP IAM for the Temporary | | | | Connection. Support of this | | | | IE in the gsmSSF is an | | | | implementation option. | +-----------------------------+--------+-----------------------------+ | Calling Party Number | O | This IE may be used to | | | | identify the calling party. | | | | If present, it shall be | | | | included in the ISUP IAM | | | | for the Temporary | | | | Connection. Support of this | | | | IE in the gsmSSF is an | | | | implementation option. | +-----------------------------+--------+-----------------------------+
Carrier contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Carrier Identification Code | M | This IE uniquely identifies | | | | a North American long | | | | distance carrier. | +-----------------------------+--------+-----------------------------+ | Carrier Selection | M | This IE indicates the way | | Information | | the carrier was selected, | | | | i.e.: | | | | | | | | - dialled; | | | | | | | | - subscribed. | +-----------------------------+--------+-----------------------------+
#### 4.6.2.14 Furnish Charging Information
##### 4.6.2.14.1 Description
This IF is used to request the gsmSSF to include call related information in
the CAMEL specific logical call record. The logical call record is created
when the Furnish Charging Information IF is received and a logical call record
for that leg does not exist. For modelling purposes the logical call record is
buffered in the gsmSSF. The gsmSSF completes logical call records as defined
in the SDLs. Once the logical call record is completed, then the free format
data are moved to the corresponding CDR and the logical call record is
deleted.
The gsmSCF can send multiple concatenated Furnish Charging Information IFs per
leg for completion. The total maximum of free format data is 160 octets per
leg. The 160 octets may be sent in one or more FCI IFs. If there are
incomplete free format data and new Furnish Charging Information IF(s) is/are
received to overwrite the non-completed data, then the non-complete data are
discarded and the gsmSCF can send another 160 octets per leg. The SDLs of the
present document define when logical call records are completed. After the
completion the gsmSCF can send another 160 octets of the free format data in
one or more Furnish Charging Information IFs for the called leg.
##### 4.6.2.14.2 Information Elements
* * *
Information element name Status Description FCI Billing Charging
Characteristics M This IE is described in a table below.
* * *
FCI Billing Charging Characteristics contains the following information
element:
* * *
Information element name Status Description FCIBCCCAMEL Sequence 1 M This IE
is described in a table below.
* * *
FCIBCCCAMEL Sequence 1 contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Free Format Data | M | This IE contains the free | | | | format data to be inserted | | | | in the CAMEL logical call | | | | record. | +--------------------------+--------+-----------------------------+ | Party To Charge | M | This IE indicates the party | | | | for whom a CAMEL logical | | | | call record will be | | | | created. | +--------------------------+--------+-----------------------------+ | Append Free Format Data | O | This IE indicates that the | | | | gsmSSF shall append the | | | | free format data to the | | | | logical call record. | | | | | | | | - If this IE is present | | | | and indicates \"Append\", | | | | the gsmSSF shall append the | | | | free format data received | | | | in this IF to the free | | | | format data already present | | | | in the logical call record | | | | for that leg of the call. | | | | | | | | - If this IE is absent or | | | | indicates \"Overwrite\", | | | | then the gsmSSF shall | | | | overwrite all free format | | | | data already present in the | | | | logical call record for | | | | that leg of the call, by | | | | the free format data | | | | received in this IF. | | | | | | | | If no logical call record | | | | exists for that leg of the | | | | call, then the gsmSSF shall | | | | ignore this IE. | +--------------------------+--------+-----------------------------+
#### 4.6.2.15 Initiate Call Attempt
##### 4.6.2.15.1 Description
This IF is used to request the gsmSSF to create a new party in an existing
call (NP), or to create a completely new call (NC). The created leg is an
originating call. The address information provided by the gsmSCF is used.
##### 4.6.2.15.2 Information Elements
+----------------------------+----+----+----------------------------+ | Information element name | NC | NP | Description | +----------------------------+----+----+----------------------------+ | Destination Routeing | M | M | This IE contains the | | Address | | | called party number | | | | | towards which the call is | | | | | to be routed. | | | | | | | | | | For calls to an MS this | | | | | can e.g. be (but shall not | | | | | be limited to) the MSISDN | | | | | (for routeing via a GMSC) | | | | | or the MSRN received from | | | | | the HLR (for routeing | | | | | direct to the VMSC). | +----------------------------+----+----+----------------------------+ | Calling Party Number | M | - | This IE identifies which | | | | | number shall be regarded | | | | | as the calling party for | | | | | the created call. | +----------------------------+----+----+----------------------------+ | Leg To Be Created | M | M | This IE indicates the | | | | | legID to be assigned to | | | | | the newly created party. | | | | | The leg ID shall be 3 or | | | | | higher. | +----------------------------+----+----+----------------------------+ | New Call Segment | M | M | This IE indicates the CS | | | | | ID to be assigned to the | | | | | newly created call | | | | | segment. | +----------------------------+----+----+----------------------------+ | Call Reference Number | M | - | This IE may be used by the | | | | | gsmSCF for inclusion in a | | | | | network optional gsmSCF | | | | | call record. The call | | | | | reference number is | | | | | included by the MSC in the | | | | | call record. | +----------------------------+----+----+----------------------------+ | gsmSCF Address | M | - | This IE contains the | | | | | address of the gsmSCF | | | | | which initiated the new | | | | | call. | | | | | | | | | | This IE is required for a | | | | | unique Call Reference. | +----------------------------+----+----+----------------------------+ | Suppress T‑CSI | O | O | This IE indicates that | | | | | T‑CSI shall be suppressed | | | | | on the terminating leg. | +----------------------------+----+----+----------------------------+
#### 4.6.2.16 Move Leg
##### 4.6.2.16.1 Description
This IF requests the gsmSSF to move a leg to CSID1. After the move the source
call segment is deleted.
> In moving the specified leg, the conditions of the leg: the armed EDPs, the
> Stored e‑parameters, the Non-completed CAMEL logical call records, and the
> Call Information Report pending, are also applied for the same leg after the
> move.
##### 4.6.2.16.2 Information Elements
* * *
Information element name Status Description Leg ID To Move M This IE indicates
the leg that shall be moved.
* * *
#### 4.6.2.17 Play Tone
##### 4.6.2.17.1 Description
This IF is used to play a variable sequence of tones to a particular leg or
call segment using the MSC\'s tone generator. Refer to subclause 4.5.7.1.2 for
a graphical representation of the variable sequence of tones.
In order to avoid tone bursts being played in close succession to the same
party or group of parties, the gsmSCF is responsible for careful use of this
IF especially when warning tones have been scheduled using the Apply Charging
IF.
##### 4.6.4.17.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Leg or Call Segment | M | This IE is described in a | | | | table below. | | | | | | | | This IE indicates the leg | | | | or call segment. | +--------------------------+--------+-----------------------------+ | Burst List | M | This IE is described in a | | | | table below. | | | | | | | | This IE indicates a | | | | variable sequence of | | | | bursts. | +--------------------------+--------+-----------------------------+
Leg or Call Segment contains the following information elements:
* * *
Information element name Status Description Call Segment ID E This IE
indicates the call segment to which tones shall be played. Leg ID E This IE
indicates the leg to which tones shall be played.
* * *
Burst List contains the following information elements:
* * *
Information element name Status Description Number of bursts M This IE
indicates the number of bursts to be played. There may be up to three bursts.
Burst interval M This IE indicates the time interval between successive
bursts. Number of tones in burst M This IE indicates the number of tones to be
played in each burst. There may be up to three tones per burst. The tone is
fixed to 900 Hz. Tone Duration M This IE indicates the duration of each tone
in a burst. Tone Interval M This IE indicates the time interval between
successive tones in a burst.
* * *
#### 4.6.2.18 Release Call
##### 4.6.2.18.1 Description
This IF is used by the gsmSCF to tear down an existing call at any phase of
the call for all parties involved in the call.
##### 4.6.2.18.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Release Cause | E | This IE indicates the | | | | Release Cause for the call. | | | | This may be used by the MSC | | | | or GMSC for generating | | | | specific tones to the | | | | different parties in the | | | | call or to fill in the | | | | \"cause\" in the Release | | | | IF. | +-----------------------------+--------+-----------------------------+ | Release Cause With | E | This IE indicates the | | Extensions | | Release Cause for the call. | | | | This may be used by the MSC | | | | or GMSC for generating | | | | specific tones to the | | | | different parties in the | | | | call or to fill in the | | | | \"cause\" in the Release | | | | IF. | | | | | | | | This IE may include | | | | additional network specific | | | | IE. It may be used by the | | | | gsmSCF only if the Initial | | | | DP IF or ICA Ack contained | | | | the 'Release Call Argument | | | | Extension Allowed' IE. | +-----------------------------+--------+-----------------------------+
#### 4.6.2.19 Request Report BCSM Event
##### 4.6.2.19.1 Description
This IF is used to request the gsmSSF to monitor for a call-related event,
then send a notification back to the gsmSCF when the event is detected (see
Event Report BCSM).
##### 4.6.2.19.2 Information Elements
* * *
Information element name MO MF MT VT NC NP TO Description BCSM Event M M M M M
M M This IE specifies the event or events for which a report is requested.
* * *
BCSM Event contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Event type | M | M | M | M | M | M | M | This IE | | | | | | | | | | specifies the | | | | | | | | | | type of event | | | | | | | | | | for which a | | | | | | | | | | report is | | | | | | | | | | requested. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Leg ID | C | C | C | C | C | M | C | This IE | | | | | | | | | | indicates the | | | | | | | | | | party in the | | | | | | | | | | call for which | | | | | | | | | | the event shall | | | | | | | | | | be armed or | | | | | | | | | | disarmed. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Monitor Mode | M | M | M | M | M | M | M | If this IE is | | | | | | | | | | \"interrupted\" | | | | | | | | | | then the event | | | | | | | | | | shall be | | | | | | | | | | reported as a | | | | | | | | | | request, if | | | | | | | | | | this IE is | | | | | | | | | | \"notify and | | | | | | | | | | continue\" then | | | | | | | | | | the event shall | | | | | | | | | | be reported as | | | | | | | | | | a notification, | | | | | | | | | | if this IE is | | | | | | | | | | \"transparent\" | | | | | | | | | | then the event | | | | | | | | | | shall not be | | | | | | | | | | reported. | +-----------------+----+----+----+----+----+----+----+-----------------+ | DP Specific | O | O | O | O | O | O | O | This IE is | | Criteria | | | | | | | | described in a | | | | | | | | | | table below. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Automatic Rearm | O | O | O | O | - | - | O | This IE | | | | | | | | | | indicates that | | | | | | | | | | the detection | | | | | | | | | | point shall be | | | | | | | | | | automatically | | | | | | | | | | rearmed by the | | | | | | | | | | gsmSSF when it | | | | | | | | | | is encountered. | | | | | | | | | | This IE may be | | | | | | | | | | present only if | | | | | | | | | | the Event Type | | | | | | | | | | is | | | | | | | | | | O_Mid_Call, | | | | | | | | | | T_Mid_Call, | | | | | | | | | | O_Change | | | | | | | | | | _Of_Position, | | | | | | | | | | T_Change | | | | | | | | | | _Of_Position, | | | | | | | | | | O_ | | | | | | | | | | Service_Change | | | | | | | | | | or | | | | | | | | | | T_ | | | | | | | | | | Service_Change | | | | | | | | | | and the Monitor | | | | | | | | | | Mode is | | | | | | | | | | \"notify and | | | | | | | | | | continue\". | | | | | | | | | | | | | | | | | | | | The MF and MT | | | | | | | | | | cases apply for | | | | | | | | | | O_ | | | | | | | | | | Service_Change | | | | | | | | | | or | | | | | | | | | | T_ | | | | | | | | | | Service_Change | | | | | | | | | | DPs only. | | | | | | | | | | | | | | | | | | | | The TO case | | | | | | | | | | applies for | | | | | | | | | | O_Mid_Call | | | | | | | | | | and | | | | | | | | | | O_ | | | | | | | | | | Service_Change | | | | | | | | | | DPs only. | +-----------------+----+----+----+----+----+----+----+-----------------+
DP Specific Criteria contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Application | O | O | O | O | O | O | O | This IE carries | | Timer | | | | | | | | additional | | | | | | | | | | timer duration | | | | | | | | | | information | | | | | | | | | | (timer values | | | | | | | | | | for No_Answer | | | | | | | | | | event) required | | | | | | | | | | for arming the | | | | | | | | | | No_Answer EDPs | | | | | | | | | | in the gsmSSF. | | | | | | | | | | The TNRy timer | | | | | | | | | | (value defined | | | | | | | | | | between | | | | | | | | | | 10 seconds and | | | | | | | | | | 40 seconds) | | | | | | | | | | shall be | | | | | | | | | | shorter than | | | | | | | | | | the network no | | | | | | | | | | answer timer. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Mid Call | O | - | - | O | - | - | O | This IE is | | Control Info | | | | | | | | described in a | | | | | | | | | | table below. | | | | | | | | | | | | | | | | | | | | This IE carries | | | | | | | | | | the criterion | | | | | | | | | | for the | | | | | | | | | | detection and | | | | | | | | | | reporting of | | | | | | | | | | the mid-call | | | | | | | | | | event. If this | | | | | | | | | | IE is absent, | | | | | | | | | | then mid-call | | | | | | | | | | triggering | | | | | | | | | | shall take | | | | | | | | | | place when the | | | | | | | | | | first digit has | | | | | | | | | | been entered by | | | | | | | | | | the user. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Change of | O | - | - | O | - | - | - | This IE is | | Position | | | | | | | | described in a | | Control Info | | | | | | | | table below. It | | | | | | | | | | carries the | | | | | | | | | | list of | | | | | | | | | | criteria for | | | | | | | | | | the reporting | | | | | | | | | | of the change | | | | | | | | | | of position | | | | | | | | | | event. If the | | | | | | | | | | DP Specific | | | | | | | | | | Criteria IE is | | | | | | | | | | absent, then | | | | | | | | | | the criteria | | | | | | | | | | for any change | | | | | | | | | | of position | | | | | | | | | | shall be | | | | | | | | | | regarded as | | | | | | | | | | fulfilled. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Number of | - | - | - | - | - | - | O | This IE | | Digits | | | | | | | | indicates the | | | | | | | | | | number of | | | | | | | | | | additional | | | | | | | | | | digits | | | | | | | | | | requested by | | | | | | | | | | the gsmSCF to | | | | | | | | | | be collected by | | | | | | | | | | the gsmSSF | | | | | | | | | | before the | | | | | | | | | | CollectedInfo | | | | | | | | | | event is | | | | | | | | | | reported, | | | | | | | | | | excluding the | | | | | | | | | | digits reported | | | | | | | | | | already. It | | | | | | | | | | excludes the | | | | | | | | | | end of pulsing | | | | | | | | | | signal (ST) | +-----------------+----+----+----+----+----+----+----+-----------------+ | Inter Digit | - | - | - | - | - | - | O | This IE carries | | Timeout | | | | | | | | additional | | | | | | | | | | timer duration | | | | | | | | | | information | | | | | | | | | | required for | | | | | | | | | | arming the | | | | | | | | | | CollectedInfo | | | | | | | | | | event in the | | | | | | | | | | gsmSSF. The IE | | | | | | | | | | indicates the | | | | | | | | | | maximum | | | | | | | | | | duration | | | | | | | | | | allowed between | | | | | | | | | | receipt of | | | | | | | | | | successive | | | | | | | | | | digits from the | | | | | | | | | | calling party. | | | | | | | | | | The Inter Digit | | | | | | | | | | timer value | | | | | | | | | | shall be | | | | | | | | | | shorter than | | | | | | | | | | the network | | | | | | | | | | inter-digit | | | | | | | | | | timer. | | | | | | | | | | | | | | | | | | | | The MSC/ gsmSSF | | | | | | | | | | shall use the | | | | | | | | | | network | | | | | | | | | | inter-digit | | | | | | | | | | timer duration | | | | | | | | | | as the default | | | | | | | | | | duration. If | | | | | | | | | | one or more | | | | | | | | | | Col | | | | | | | | | | lectInformation | | | | | | | | | | operations are | | | | | | | | | | received in a | | | | | | | | | | call then the | | | | | | | | | | latest received | | | | | | | | | | value | | | | | | | | | | overwrites the | | | | | | | | | | previous value. | | | | | | | | | | If the latest | | | | | | | | | | Col | | | | | | | | | | lectInformation | | | | | | | | | | does not | | | | | | | | | | include this IE | | | | | | | | | | then the | | | | | | | | | | previous value | | | | | | | | | | applies. | +-----------------+----+----+----+----+----+----+----+-----------------+ | NOTE If a | | | | | | | | | | Request Report | | | | | | | | | | BCSM Event | | | | | | | | | | information | | | | | | | | | | flow overwrites | | | | | | | | | | previous | | | | | | | | | | Request Report | | | | | | | | | | BCSM Event | | | | | | | | | | information | | | | | | | | | | flow which | | | | | | | | | | contained | | | | | | | | | | Application | | | | | | | | | | Timer IE for | | | | | | | | | | No_Answer DP, | | | | | | | | | | the behaviour | | | | | | | | | | of the gsmSSF | | | | | | | | | | is | | | | | | | | | | unpredictable. | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+
Mid Call Control Info contains the following information elements:
+-----------------+----+----+----+----+----+----+----+-----------------+ | Information | MO | MF | MT | VT | NC | NP | TO | Description | | element name | | | | | | | | | +-----------------+----+----+----+----+----+----+----+-----------------+ | Minimum Number | M | - | - | M | - | - | M | This IE | | Of Digits | | | | | | | | indicates the | | | | | | | | | | minimum number | | | | | | | | | | of digits to be | | | | | | | | | | collected. The | | | | | | | | | | value of this | | | | | | | | | | IE includes the | | | | | | | | | | length of the | | | | | | | | | | Start digit | | | | | | | | | | string, if | | | | | | | | | | present, and | | | | | | | | | | the length of | | | | | | | | | | the End of | | | | | | | | | | reply digit | | | | | | | | | | string, if | | | | | | | | | | present. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Maximum Number | M | - | - | M | - | - | M | This IE | | Of Digits | | | | | | | | indicates the | | | | | | | | | | maximum number | | | | | | | | | | of digits to be | | | | | | | | | | collected. The | | | | | | | | | | value of this | | | | | | | | | | IE includes the | | | | | | | | | | length of the | | | | | | | | | | Start digit | | | | | | | | | | string, if | | | | | | | | | | present, and | | | | | | | | | | the length of | | | | | | | | | | the End of | | | | | | | | | | reply digit | | | | | | | | | | string, if | | | | | | | | | | present. | | | | | | | | | | | | | | | | | | | | If triggering | | | | | | | | | | takes place due | | | | | | | | | | to the | | | | | | | | | | detection of | | | | | | | | | | the maximum | | | | | | | | | | number of | | | | | | | | | | digits and the | | | | | | | | | | End of reply | | | | | | | | | | digit string, | | | | | | | | | | if present, is | | | | | | | | | | partially | | | | | | | | | | detected, then | | | | | | | | | | the partially | | | | | | | | | | detected End of | | | | | | | | | | reply digit | | | | | | | | | | string shall be | | | | | | | | | | included in the | | | | | | | | | | digit string to | | | | | | | | | | be reported to | | | | | | | | | | the gsmSCF. | +-----------------+----+----+----+----+----+----+----+-----------------+ | End of Reply | O | - | - | O | - | - | O | This IE, if | | Digit String | | | | | | | | present, | | | | | | | | | | indicates the | | | | | | | | | | digit string | | | | | | | | | | that denotes | | | | | | | | | | the end of the | | | | | | | | | | digits to be | | | | | | | | | | collected. | | | | | | | | | | | | | | | | | | | | If triggering | | | | | | | | | | takes place due | | | | | | | | | | to the | | | | | | | | | | detection of | | | | | | | | | | the End of | | | | | | | | | | reply digit | | | | | | | | | | string, then | | | | | | | | | | this string | | | | | | | | | | shall be | | | | | | | | | | included in the | | | | | | | | | | digit string to | | | | | | | | | | be reported to | | | | | | | | | | the gsmSCF. | | | | | | | | | | | | | | | | | | | | If the | | | | | | | | | | interdigit | | | | | | | | | | timeout expires | | | | | | | | | | when the Start | | | | | | | | | | Digit String, | | | | | | | | | | if present, is | | | | | | | | | | complete and | | | | | | | | | | the Minimum | | | | | | | | | | Number Of | | | | | | | | | | Digits has been | | | | | | | | | | detected and | | | | | | | | | | the End Digit | | | | | | | | | | String, if | | | | | | | | | | present, has | | | | | | | | | | been partially | | | | | | | | | | detected then | | | | | | | | | | triggering | | | | | | | | | | shall take | | | | | | | | | | place. The | | | | | | | | | | partially | | | | | | | | | | detected End Of | | | | | | | | | | Reply Digit | | | | | | | | | | String shall be | | | | | | | | | | included in the | | | | | | | | | | string to be | | | | | | | | | | reported to the | | | | | | | | | | gsmSCF. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Cancel Digit | O | - | - | O | - | - | O | This IE, if | | String | | | | | | | | present, | | | | | | | | | | indicates the | | | | | | | | | | digit string | | | | | | | | | | that indicates | | | | | | | | | | that the input | | | | | | | | | | shall be erased | | | | | | | | | | and that digit | | | | | | | | | | collection, | | | | | | | | | | including the | | | | | | | | | | start digit | | | | | | | | | | string, if | | | | | | | | | | present, shall | | | | | | | | | | start afresh. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Start Digit | O | - | - | O | - | - | O | This IE, if | | String | | | | | | | | present, | | | | | | | | | | indicates the | | | | | | | | | | digit string | | | | | | | | | | that denotes | | | | | | | | | | the start of | | | | | | | | | | the digits to | | | | | | | | | | be collected. | | | | | | | | | | | | | | | | | | | | If this IE is | | | | | | | | | | absent, then | | | | | | | | | | the first digit | | | | | | | | | | entered forms | | | | | | | | | | part of the | | | | | | | | | | digits to be | | | | | | | | | | collected. | | | | | | | | | | | | | | | | | | | | When triggering | | | | | | | | | | takes place, | | | | | | | | | | then the Start | | | | | | | | | | digit string | | | | | | | | | | shall be | | | | | | | | | | included in the | | | | | | | | | | digit string to | | | | | | | | | | be reported to | | | | | | | | | | the gsmSCF. | +-----------------+----+----+----+----+----+----+----+-----------------+ | Inter Digit | M | - | - | M | - | - | M | This IE | | Timeout | | | | | | | | indicates the | | | | | | | | | | maximum | | | | | | | | | | duration | | | | | | | | | | allowed between | | | | | | | | | | receipt of | | | | | | | | | | successive | | | | | | | | | | digits from the | | | | | | | | | | MS. For the TO | | | | | | | | | | case, this IE | | | | | | | | | | indicates the | | | | | | | | | | maximum | | | | | | | | | | duration | | | | | | | | | | allowed between | | | | | | | | | | receipt of | | | | | | | | | | successive | | | | | | | | | | digits from the | | | | | | | | | | calling party. | +-----------------+----+----+----+----+----+----+----+-----------------+
Change of Position Control Info contains a list of up to 10 instances of the
following information element:
* * *
Information element name MO MF MT VT NC NP Description Change Of Location M -
- M - - Each Change Of Location IE is one of the 6 possibilities indicated in
the table below. If multiple instances of the Change Of Location IE have the
same value, this is not an error.
* * *
Each instance of the Change Of Location IE contains one of the following
information elements:
* * *
Information element name MO MF MT VT NC NP Description Cell Global ID O,E - -
O,E - - This IE indicates that the criteria are fulfilled if the mobile
station performs handover across the boundary of the cell specified in this
IE, i.e. handover into or out of the cell. Service Area ID O,E - - O,E - -
This IE indicates that the criteria are fulfilled if the mobile station
performs handover across the boundary of the service area specified in this
IE, i.e. handover into or out of the service area. Location Area ID O,E - -
O,E - - This IE indicates that the criteria are fulfilled if the mobile
station performs handover across the boundary of the location area specified
in this IE, i.e. handover into or out of the location area. Inter-System
Handover O,E - - O,E - - This IE indicates that the criteria are fulfilled if
the mobile station performs inter-system handover. Inter-PLMN Handover O,E - -
O,E - - This IE indicates that the criteria are fulfilled if the mobile
station performs inter-PLMN handover. Inter-MSC Handover O,E - - O,E - - This
IE indicates that the criteria are fulfilled if the mobile station performs
inter-MSC handover.
* * *
#### 4.6.2.20 Reset Timer
##### 4.6.2.20.1 Description
This IF is used to reset a timer.
##### 4.6.2.20.2 Information Elements
* * *
Information element name Status Description Timer Value M This IE specifies
the value to which the indicated timer shall be set. Timer ID O This IE
indicates which timer shall be reset. It shall be set to \'Tssf\'. Call
Segment ID M This IE indicates for which Call Segment in the gsmSSF the timer
shall be reset.
* * *
#### 4.6.2.21 Send Charging Information
##### 4.6.2.21.1 Description
This IF is used to send e‑parameters from the gsmSCF to the gsmSSF. If Charge
Advice Information (CAI) is received from the gsmSCF, it shall replace the CAI
which would be generated by the MSC and inhibit any further generation of CAI
by the MSC. Further processing of the CAI by the MSC shall be in accordance
with the Advice of Charge supplementary service. If the subscriber is not
provisioned with the Advice of Charge supplementary service or if the VPLMN
does not support this service, then no e‑parameters shall be sent to the MS
and no error due to this fact shall be sent back to the gsmSCF.
The IF is only used in the MO case or in the VT case.
NOTE: If CAI is received from the gsmSCF after charge information has been
generated by the MSC and sent to the MS, the behaviour of the service may be
unpredictable or incorrect; the service designer should therefore ensure that
the first set of CAI is sent to the gsmSSF before charge information is sent
to the MS.
##### 4.6.2.21.2 Information Elements
* * *
Information element name MO MF MT VT NC NP Description SCI Billing Charging
Characteristics M - - M - - This IE defines the Advice Of Charge related
information to be provided to the Mobile Station. Leg ID M - - M - - This IE
indicates the leg to which the charging information shall be sent.
* * *
SCI Billing Charging Characteristics contains the following information
elements:
+---------------+-----+----+----+-----+----+----+---------------+ | Information | MO | MF | MT | VT | NC | NP | Description | | element name | | | | | | | | +---------------+-----+----+----+-----+----+----+---------------+ | AoC After | S,E | - | - | S,E | - | - | This IE is | | Answer | | | | | | | described in | | | | | | | | | a table | | | | | | | | | below. | | | | | | | | | | | | | | | | | | This IE is | | | | | | | | | present after | | | | | | | | | an Answer | | | | | | | | | event has | | | | | | | | | been detected | | | | | | | | | from the | | | | | | | | | called party, | | | | | | | | | the current | | | | | | | | | connected SRF | | | | | | | | | or the | | | | | | | | | temporary | | | | | | | | | connection. | +---------------+-----+----+----+-----+----+----+---------------+ | AoC Before | S,E | - | - | S,E | - | - | This IE is | | Answer | | | | | | | described in | | | | | | | | | a table | | | | | | | | | below. | | | | | | | | | | | | | | | | | | This IE is | | | | | | | | | present | | | | | | | | | before an | | | | | | | | | Answer event | | | | | | | | | has been | | | | | | | | | detected from | | | | | | | | | the called | | | | | | | | | party, the | | | | | | | | | current | | | | | | | | | connected SRF | | | | | | | | | or the | | | | | | | | | temporary | | | | | | | | | connection. | +---------------+-----+----+----+-----+----+----+---------------+
AoC Before Answer contains the following information elements:
* * *
Information element name MO MF MT VT NC NP Description AoC Initial M - - M - -
This IE contains CAI elements as defined in 3GPP TS 22.024 [3]. AoC Subsequent
O - - O - - This IE is described in a table below.
* * *
AoC Subsequent contains the following information elements:
* * *
Information element name MO MF MT VT NC NP Description CAI Elements M - - M -
- This IE contains CAI elements as defined in 3GPP TS 22.024 [3]. Tariff
Switch Interval O - - O - - This IE indicates the tariff switch time until the
next tariff switch applies.
* * *
AoC After Answer contains the following information elements:
* * *
Information element name MO MF MT VT NC NP Description CAI Elements M - - M -
- This IE contains CAI elements as defined in 3GPP TS 22.024 [3]. Tariff
Switch Interval O - - O - - This IE indicates the tariff switch time until the
next tariff switch applies.
* * *
#### 4.6.2.22 Split Leg
##### 4.6.2.22.1 Description
This IF is used to request the gsmSSF to separate a leg from CSID1 and move it
to a new call segment.
If CSID1 does not exist, then this IF is used to request the gsmSSF to move a
leg into a newly created CSID1.
> In splitting the specified leg, the conditions of the leg: the armed EDPs,
> the Stored e‑parameters, the Non-completed CAMEL logical call records, and
> the Call Information Report pending, are also applied for the same leg after
> split.
##### 4.6.2.22.2 Information Elements
* * *
Information element name Status Description Leg To Be Split M This IE
indicates the leg in the call to be split. New Call Segment M This IE
indicates the Call Segment ID to be assigned to the new call segment.
* * *
### 4.6.3 Optional (Service logic dependent) gsmSCF to gsmSRF information
flows
#### 4.6.3.1 Activity Test
##### 4.6.3.1.1 Description
This IF is used to check for the continued existence of a relationship between
the gsmSCF and gsmSRF. If the relationship is still in existence, then the
gsmSRF will respond. If no reply is received, then the gsmSCF will assume that
the gsmSRF has failed in some way and will take the appropriate action.
##### 4.6.3.1.2 Information Elements
This IF contains no information elements.
#### 4.6.3.2 Cancel
##### 4.6.3.2.1 Description
This IF is used by the gsmSCF to request the gsmSRF to cancel a correlated
previous IF.
##### 4.6.3.2.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Invoke ID | E | This IE specifies the IF to | | | | be cancelled. This IE may | | | | be used when the Cancel IF | | | | is used in a single call | | | | segment CSA or when the | | | | Cancel IF is sent by the | | | | gsmSCF to an Intelligent | | | | Peripheral. | +--------------------------+--------+-----------------------------+ | Call Segment To Cancel | E | This IE may be used when | | | | the Cancel IF is used in a | | | | single call segment CSA or | | | | in a multi call segment | | | | CSA. This IE is described | | | | in a table below. | | | | | | | | This IE shall not be used | | | | when the Cancel IF is sent | | | | by the gsmSCF to an | | | | Intelligent Peripheral. | +--------------------------+--------+-----------------------------+
Call Segment To Cancel contains the following information elements:
* * *
Information element name Status Description Invoke ID M This IE specifies the
IF to be cancelled. Call Segment ID M This IE specifies to which call segment
the cancellation of the user interaction IF shall apply.
* * *
#### 4.6.3.3 Play Announcement
##### 4.6.3.3.1 Description
This IF is used for inband interaction.
##### 4.6.3.3.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Information To Send | M | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Disconnect From IP | M | This IE indicates whether | | Forbidden | | or not the gsmSRF may be | | | | disconnected from the user | | | | when all information has | | | | been sent. | +-----------------------------+--------+-----------------------------+ | Request Announcement | M | This IE indicates whether | | Complete Notification | | or not a Specialized | | | | Resource Report shall be | | | | sent to the gsmSCF when all | | | | information has been sent. | +-----------------------------+--------+-----------------------------+ | Request Announcement | M | This IE indicates whether | | Started Notification | | or not a Specialized | | | | Resource Report shall be | | | | sent to the gsmSCF when the | | | | first announcement or tone | | | | starts. | +-----------------------------+--------+-----------------------------+ | Call Segment ID | S | This IE indicates the call | | | | segment to which the user | | | | interaction shall apply. | | | | | | | | This IE shall be absent if | | | | this IF is sent by the | | | | gsmSCF to an Intelligent | | | | Peripheral. | +-----------------------------+--------+-----------------------------+
Information To Send contains the following information elements:
* * *
Information element name Status Description Inband Info E This IE is described
in a table below. Tone E This IE is described in a table below.
* * *
Inband Info contains the following information elements:
* * *
Information element name Status Description Message ID M This IE is described
in a table below. Number Of Repetitions M This IE indicates the maximum number
of times the message shall be sent to the end-user. Duration O This IE
indicates the maximum duration time in seconds that the message shall be
played/repeated. Zero indicates endless repetition. Interval O This IE
indicates the time interval in seconds between two repetitions.
* * *
Message ID contains the following information elements:
* * *
Information element name Status Description Elementary Message ID E This IE
indicates a single announcement Text E This IE indicates a text to be sent.
The text shall be transformed to inband information (speech) by the gsmSRF.
Elementary Message IDs E This IE indicates a sequence of announcements
Variable Message E This IE indicates an announcement with one or more variable
parts.
* * *
Tone contains the following information elements:
* * *
Information element name Status Description Tone ID M This IE indicates the
tone to be sent. Duration O This IE indicates the maximum duration in seconds
that the message shall be played/repeated. Zero indicates endless repetition.
* * *
#### 4.6.3.4 Prompt And Collect User Information
##### 4.6.3.4.1 Description
This IF is used to interact with a call party in order to collect information.
##### 4.6.3.4.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Collected Info | M | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Information To Send | O | This IE is described in | | | | subclause 4.6.3.3.2. | | | | | | | | This IE indicates an | | | | announcement or a tone to | | | | be sent to the end user by | | | | the gsmSRF. | +-----------------------------+--------+-----------------------------+ | Disconnect From IP | M | This IE indicates whether | | Forbidden | | the gsmSRF may be | | | | disconnected from the user | | | | when all information has | | | | been sent. | +-----------------------------+--------+-----------------------------+ | Request Announcement | M | This IE indicates whether | | Started Notification | | or not a Specialized | | | | Resource Report shall be | | | | sent to the gsmSCF when the | | | | first announcement or tone | | | | starts. | +-----------------------------+--------+-----------------------------+ | Call Segment ID | S | This IE indicates the call | | | | segment to which the user | | | | interaction shall apply. | | | | | | | | This IE shall be absent if | | | | this IF is sent by the | | | | gsmSCF to an Intelligent | | | | Peripheral. | +-----------------------------+--------+-----------------------------+
Collected Info contains the following information element:
* * *
Information element name Status Description Collected Digits M This IE is
described in a table below.
* * *
Collected Digits contains the following information elements:
* * *
Information element name Status Description Minimum Number Of Digits M This IE
indicates the minimum number of valid digits to be collected. The value of
this IE includes the length of the Start digit string, if present, and the
length of the End of reply digit string, if present. Maximum Number Of Digits
M This IE specifies the maximum number of valid digits to be collected. The
value of this IE includes the length of the Start digit string, if present,
and the length of the End of reply digit string, if present. End Of Reply
Digit O This IE indicates the digit(s) used to signal the end of input. Cancel
Digit O If this IE is present then the cancel digit can be entered by the user
to request a possible retry. Start Digit O If this IE is present then the
start digit(s) indicates the start of the valid digits to be collected. First
Digit Time Out O If this IE is present then the first digit shall be received
before the expiration of the first digit timer expiration. Inter Digit Time
Out O If this IE is present then any subsequent valid or invalid digit shall
be received by the gsmSRF before the inter digit timer expires. Error
Treatment O This IE indicates what specific action shall be taken by the
gsmSRF in the event of error conditions occurring. Interruptable Ann Ind O If
this IE is set to TRUE (default value) then the announcement is interrupted
after the first valid or invalid digit received by the gsmSRF. If this IE is
present and explicitly set to FALSE then the announcement will not be
interrupted after the first digit is received by the gsmSRF. Voice Information
O If this IE is set to FALSE (default value) then all valid or invalid digits
are entered by DTMF. If this IE is set to TRUE then the calling user is
required to provide all valid or invalid information by speech. Voice Back O
If this IE is set to FALSE (default value) then no voice back information is
given by the gsmSRF. If this IE is set to TRUE then the valid input digits
received by the gsmSRF will be announced back to the calling user immediately
after the end of input is received.
* * *
### 4.6.4 gsmSRF to gsmSCF information flows
#### 4.6.4.1 Activity Test ack
##### 4.6.4.1.1 Description
This IF is the response to the Activity Test.
##### 4.6.4.1.2 Information Elements
This IF contains no information elements.
#### 4.6.4.2 Assist Request Instructions
##### 4.6.4.2.1 Description
This IF is sent to the gsmSCF by a gsmSSF which is acting as the assisting
gsmSSF or by a gsmSRF.
##### 4.6.4.2.2 Information Elements
* * *
Information element name Status Description Correlation ID M This IE is used
to associate the Assist Request Instructions IF from an assisting gsmSSF or by
a gsmSRF with the Initial DP IF from the initiating gsmSSF. IP SSP
Capabilities M This IE indicates which SRF resources are attached, available
and supported within the MSC where the gsmSSF resides or the IP in which the
gsmSRF resides.
* * *
#### 4.6.4.3 Prompt And Collect User Information ack
##### 4.6.4.3.1 Description
This IF is used by the gsmSRF to indicate the result of a Prompt And Collect
User Information IF.
##### 4.6.4.3.2 Information Elements
* * *
Information element name Status Description Digits Response C This IE
indicates the digit sequence received from the end user.
* * *
#### 4.6.4.4 Specialized Resource Report
##### 4.6.4.4.1 Description
This IF is used when a Specialized Resource Report was requested in a Play
Announcement IF or in a Prompt and Collect User Information IF.
##### 4.6.4.4.2 Information Elements
* * *
Information element name Status Description All Announcements Complete E This
IE indicates that all the announcements and tones are complete. First
Announcement Started E This IE indicates that the first announcement or tone
has started.
* * *
### 4.6.5 gsmSCF to Assisting SSF information flows
#### 4.6.5.1 Activity Test
##### 4.6.5.1.1 Description
This IF is used to check for the continued existence of a relationship between
the gsmSCF and assistSSF. If the relationship is still in existence, then the
assistSSF will respond. If no reply is received, then the gsmSCF will assume
that the assistSSF has failed in some way and will take the appropriate
action.
##### 4.6.5.1.2 Information Elements
This IF contains no information elements.
#### 4.6.5.2 Cancel
##### 4.6.5.2.1 Description
This IF is used by the gsmSCF to request the assisting gsmSSF to cancel a
correlated previous IF.
##### 4.6.5.2.2 Information Elements
* * *
Information element name Status Description Invoke ID M This IE specifies the
IF to be cancelled.
* * *
#### 4.6.5.3 Connect To Resource
##### 4.6.5.3.1 Description
This IF is described in subclause 4.6.2.7. The following difference applies:
\- The Call Segment ID information element is not used.
#### 4.6.5.4 Disconnect Forward Connection
##### 4.6.5.4.1 Description
This IF is used to disconnect a connection with a gsmSRF previously
established with a Connect To Resource IF.
##### 4.6.5.4.2 Information Elements
This IF contains no information elements.
#### 4.6.5.5 Play Announcement
##### 4.6.5.5.1 Description
This IF is described in subclause 4.6.3.3. The following difference applies:
\- The Call Segment ID information element is not used.
#### 4.6.5.6 Prompt And Collect User Information
##### 4.6.5.6.1 Description
This IF is described in subclause 4.6.3.4. The following difference applies:
\- The Call Segment ID information element is not used.
#### 4.6.5.7 Reset Timer
##### 4.6.5.7.1 Description
This IF is described in subclause 4.6.2.20. The following difference applies:
\- The Call Segment ID information element is not used.
### 4.6.6 Assisting SSF to gsmSCF information flows
#### 4.6.6.1 Activity Test ack
##### 4.6.6.1.1 Description
This IF is the response to the Activity Test.
##### 4.6.6.1.2 Information Elements
This IF contains no information elements.
#### 4.6.6.2 Assist Request Instructions
##### 4.6.6.2.1 Description
This IF is described in subclause 4.6.4.2.
#### 4.6.6.3 Prompt And Collect User Information ack (received information)
##### 4.6.6.3.1 Description
This IF is described in subclause 4.6.4.3.
#### 4.6.6.4 Specialized Resource Report
##### 4.6.6.4.1 Description
This IF is described in subclause 4.6.4.4.
### 4.6.7 HLR to VLR information flows
#### 4.6.7.1 Delete Subscriber Data
##### 4.6.7.1.1 Description
This IF is used by an HLR to delete CAMEL subscription data from a VLR. It is
specified in 3GPP TS 29.002 [34].
##### 4.6.7.1.2 Information Elements
The Delete Subscriber Data IF contains the following CAMEL specific
information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | CAMEL Subscription Info | O,E | This IE identifies that all | | Withdraw | | CSIs shall be deleted from | | | | the subscriber data in the | | | | VLR. | +-----------------------------+--------+-----------------------------+ | Specific CSI Withdraw | O,E | This IE indicates that one | | | | or more specific elements | | | | of CAMEL Subscription Info | | | | shall be deleted from the | | | | VLR. | | | | | | | | The specific elements of | | | | CAMEL Subscription Info | | | | which may be deleted are: | | | | | | | | - O‑CSI with TDP criteria | | | | for O‑CSI; | | | | | | | | - TIF‑CSI; | | | | | | | | - D‑CSI; | | | | | | | | - VT‑CSI with TDP criteria | | | | for VT‑CSI. | | | | | | | | This IE should not be | | | | present when CAMEL | | | | Subscription Info Withdraw | | | | is present. | +-----------------------------+--------+-----------------------------+
#### 4.6.7.2 Insert Subscriber Data
##### 4.6.7.2.1 Description
This IF is used by an HLR to update a VLR with certain subscriber data. This
IF is specified in 3GPP TS 29.002 [34].
##### 4.6.7.2.2 Information Elements
Insert Subscriber Data contains the following CAMEL specific information
elements for circuit switched call control:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | O‑CSI | O | This IE is described in a | | | | table below. | | | | | | | | This IE identifies the | | | | subscriber as having | | | | originating CAMEL services. | +--------------------------+--------+-----------------------------+ | D‑CSI | O | This IE is described in a | | | | table below. | | | | | | | | This IE identifies the | | | | subscriber as having | | | | originating CAMEL dialled | | | | services. | +--------------------------+--------+-----------------------------+ | VT‑CSI | O | This IE is described in a | | | | table below. | | | | | | | | This IE identifies the | | | | subscriber as having | | | | terminating CAMEL services | | | | in the VMSC. | +--------------------------+--------+-----------------------------+ | TIF‑CSI | O | See 3GPP TS 23.072 [16]. | +--------------------------+--------+-----------------------------+
O‑CSI contains the following information elements:
* * *
Information element name Status Description gsmSCF Address M This IE is
described in subclause 4.3.1 Service Key M This IE is described in subclause
4.3.1. Default Call Handling M This IE is described in subclause 4.3.1. TDP
List M This IE is described in subclause 4.3.1. DP Criteria O This IE is
described in subclause 4.3.1. CAMEL Capability Handling C This IE is described
in subclause 4.3.1. If this IE is absent, this indicates that CAMEL phase 1
support is requested.
* * *
D‑CSI contains the following information elements:
* * *
Information element name Status Description gsmSCF Address M This IE is
described in subclause 4.3.2. Service Key M This IE is described in subclause
4.3.2. Default Call Handling M This IE is described in subclause 4.3.2. DP
Criteria M This IE is described in subclause 4.3.2. CAMEL Capability Handling
M This IE is described in subclause 4.3.2. The CAMEL Capability Handling shall
indicate CAMEL phase 3 or higher.
* * *
VT‑CSI contains the following information elements:
* * *
Information element name Status Description gsmSCF Address M This IE is
described in subclause 4.3.6. Service Key M This IE is described in subclause
4.3.6. Default Call Handling M This IE is described in subclause 4.3.6. TDP
List M This IE is described in subclause 4.3.6. DP Criteria O This IE is
described in subclause 4.3.6. CAMEL Capability Handling M This IE is described
in subclause 4.3.6. The CAMEL Capability Handling shall indicate CAMEL phase 3
or higher.
* * *
#### 4.6.7.3 Provide Subscriber Info
##### 4.6.7.3.1 Description
This IF is described in TS 23.018 [12]; it is used by the HLR to request
information (any one or more of subscriber state, subscriber location, IMEI &
software version and MS classmark information for the CS domain) from the VLR
at any time.
#### 4.6.7.4 Provide Roaming Number
##### 4.6.7.4.1 Description
This IF is specified in 3GPP TS 23.018 [12]; it is used by the HLR to request
a roaming number from the VLR.
##### 4.6.7.4.2 Information Elements
Provide Roaming Number contains the following CAMEL specific information
elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Suppression Of | S | This IE indicates that | | Announcements | | announcements or tones | | | | generated as a result of | | | | unsuccessful call | | | | establishment shall be | | | | suppressed. It shall be | | | | present if the HLR received | | | | it in the Send Routeing | | | | Info IF. | +-----------------------------+--------+-----------------------------+ | Call Reference Number | M | This IE carries the Call | | | | Reference Number provided | | | | by the GMSC or the gsmSCF | | | | in the Send Routeing Info | | | | IF. | +-----------------------------+--------+-----------------------------+ | GMSC Or gsmSCF Address | M | This IE is the E.164 | | | | address of the GMSC for an | | | | MT call or the E.164 | | | | address of the gsmSCF for a | | | | gsmSCF initiated call. | +-----------------------------+--------+-----------------------------+ | Alerting Pattern | S | This IE indicates the kind | | | | of Alerting Pattern to be | | | | applied. It shall be | | | | present if the HLR received | | | | it from the GMSC or the | | | | gsmSCF in the Send Routeing | | | | Info IF. | +-----------------------------+--------+-----------------------------+ | Supported CAMEL Phases in | S | This IE indicates the CAMEL | | Interrogating Node | | Phases supported in the | | | | GMSC or the gsmSCF. It | | | | shall be present if the HLR | | | | received it from the GMSC | | | | or the gsmSCF in the Send | | | | Routeing Info. | +-----------------------------+--------+-----------------------------+ | Offered CAMEL4 CSIs in | S | This IE indicates the CAMEL | | Interrogating Node | | phase 4 CSIs offered in the | | | | GMSC or the gsmSCF. It | | | | shall be present if the HLR | | | | received it from the GMSC | | | | or the gsmSCF in the Send | | | | Routeing Info. | | | | | | | | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Suppress VT‑CSI | S | This IE indicates that | | | | VT‑CSI shall be suppressed | | | | for the called party. This | | | | IE shall be present if the | | | | HLR received it in the Send | | | | Routeing Info IF. | +-----------------------------+--------+-----------------------------+ | OR not Supported In GMSC | S | This IE indicates that the | | | | VMSC should not attempt to | | | | invoke Optimal Routeing of | | | | late call forwarding. It | | | | shall be present if this IF | | | | was triggered by a Send | | | | Routeing IF for a gsmSCF | | | | initiated call. | +-----------------------------+--------+-----------------------------+
Offered CAMEL4 CSIs in Interrogating Node contains the following information
elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI. It shall be present if the HLR received it from
the GMSC or the gsmSCF in the Send Routeing Info. D‑CSI S This IE indicates
the offer of CAMEL phase 4 D‑CSI. It shall be present if the HLR received it
from the GMSC or the gsmSCF in the Send Routeing Info. T‑CSI S This IE
indicates the offer of CAMEL phase 4 T‑CSI. It shall be present if the HLR
received it from the GMSC or the gsmSCF in the Send Routeing Info.
* * *
### 4.6.8 VLR to HLR information flows
#### 4.6.8.1 Insert Subscriber Data ack
##### 4.6.8.1.1 Description
This IF is used by the VLR to indicate to the HLR the result of the Insert
Subscriber Data IF. It is specified in 3GPP TS 29.002 [34].
##### 4.6.8.1.2 Information Elements
Insert Subscriber Data ack contains the following CAMEL specific information
elements:
* * *
Information element name Status Description Supported CAMEL Phases S This IE
identifies which CAMEL phases are supported by the VMSC/VLR. It shall be
present when a CSI has been included in the Insert Subscriber Data IF. Offered
CAMEL4 CSIs S This IE indicates the CAMEL phase 4 CSIs offered in the
VMSC/VLR. It shall be present if a CSI has been included in the Insert
Subscriber Data IF and the "Supported CAMEL Phases" IE indicates support of
CAMEL phase 4.
* * *
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI. D‑CSI S This IE indicates the offer of CAMEL
phase 4 D‑CSI. VT‑CSI S This IE indicates the offer of CAMEL phase 4 VT‑CSI.
MT‑SMS‑CSI S This IE indicates the offer of CAMEL phase 4 MT‑SMS‑CSI.
* * *
#### 4.6.8.2 Provide Subscriber Info ack
##### 4.6.8.2.1 Description
This IF is described in TS 23.018 [12]; it is used by the VLR to provide the
requested information to the HLR.
#### 4.6.8.3 Update Location
##### 4.6.8.3.1 Description
This IF is used by the VLR to provide information about supported CAMEL phases
to the HLR.
##### 4.6.8.3.2 Information Elements
Update Location contains the following CAMEL specific information element:
* * *
Information element name Status Description Supported CAMEL Phases S This IE
indicates which phases of CAMEL are supported. It shall be present if a CAMEL
phase higher than phase 1 is supported. Otherwise may be absent. Offered
CAMEL4 CSIs S This IE indicates the CAMEL phase 4 CSIs offered in the
VMSC/VLR. It shall be present if the \"Supported CAMEL Phases\" IE indicates
support of CAMEL phase 4.
* * *
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI. D‑CSI S This IE indicates the offer of CAMEL
phase 4 D‑CSI. VT‑CSI S This IE indicates the offer of CAMEL phase 4 VT‑CSI.
MT‑SMS‑CSI S This IE indicates the offer of CAMEL phase 4 MT‑SMS‑CSI.
* * *
#### 4.6.8.4 Restore Data
##### 4.6.8.4.1 Description
This IF is used by the VLR to provide the information about supported CAMEL
phases to the HLR.
##### 4.6.8.4.2 Information Elements
Restore Data contains the following CAMEL specific information element:
* * *
Information element name Status Description Supported CAMEL Phases S This IE
indicates which phases of CAMEL are supported. It shall be present if a CAMEL
phase higher than phase 1 is supported. Otherwise may be absent. Offered
CAMEL4 CSIs S This IE indicates the CAMEL phase 4 CSIs offered in the
VMSC/VLR. It shall be present if the \"Supported CAMEL Phases\" IE indicates
support of CAMEL phase 4.
* * *
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI D‑CSI S This IE indicates the offer of CAMEL
phase 4 D‑CSI VT‑CSI S This IE indicates the offer of CAMEL phase 4 VT‑CSI
MT‑SMS‑CSI S This IE indicates the offer of CAMEL phase 4 MT‑SMS‑CSI
* * *
### 4.6.9 HLR to GMSC information flows
#### 4.6.9.1 Send Routeing Info ack
##### 4.6.9.1.1 Description
This IF is specified in 3GPP TS 23.018 [12]; it is used by the HLR to transfer
the requested routeing information to the GMSC.
##### 4.6.9.1.2 Information Elements
Send Routeing Info ack contains the following CAMEL specific information
elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Location Information | C | This IE indicates the | | | | location of the served | | | | subscriber. | +-----------------------------+--------+-----------------------------+ | O‑CSI | S | O‑CSI is defined in | | | | subclause 4.3.1. | | | | | | | | This IE identifies the | | | | subscriber as having | | | | originating CAMEL services. | | | | | | | | It shall be present if | | | | O‑CSI is active, and CFU or | | | | CFNRc has been invoked, or | | | | if both O‑CSI and T‑CSI are | | | | active. | +-----------------------------+--------+-----------------------------+ | D‑CSI | S | D‑CSI is defined in | | | | subclause 4.3.2. | | | | | | | | This IE identifies the | | | | subscriber as having | | | | originating CAMEL dialled | | | | services. | | | | | | | | It shall be present if | | | | D‑CSI is active, and CFU or | | | | CFNRc has been invoked, or | | | | if both D‑CSI and T‑CSI are | | | | active. | +-----------------------------+--------+-----------------------------+ | Subscriber State | C | This IE indicates the state | | | | of the MS. The possible | | | | values of the IE are: | | | | | | | | - CAMEL Busy: The VLR has | | | | indicated that the MS is | | | | engaged in a transaction | | | | for a mobile originating or | | | | terminated circuit-switched | | | | call. | | | | | | | | - Network Determined Not | | | | Reachable: The HLR or VLR | | | | has indicated that the | | | | network can determine from | | | | its internal data that the | | | | MS is not reachable. | | | | | | | | - Assumed Idle: The VLR | | | | has indicated that the | | | | state of the MS is neither | | | | \"CAMEL Busy\" nor | | | | \"Network Determined Not | | | | Reachable\". | | | | | | | | - Not Provided From VLR: | | | | The VLR did not provide any | | | | information on subscriber | | | | state even though it was | | | | requested. | +-----------------------------+--------+-----------------------------+ | T‑CSI | S | This IE is described in a | | | | table below. | | | | | | | | This IE identifies the | | | | subscriber as having | | | | terminating CAMEL services. | | | | | | | | It shall be present if | | | | T‑CSI is active and no | | | | Suppress T‑CSI indicator is | | | | present in the Send | | | | Routeing Info IF. | +-----------------------------+--------+-----------------------------+ | Basic Service Code | C | This IE indicates the type | | | | of basic service, i.e. | | | | teleservice or bearer | | | | service. | +-----------------------------+--------+-----------------------------+ | CUG Subscription Flag | S | This IE indicates if the | | | | called party has a CUG | | | | subscription. It shall be | | | | present only if the T‑CSI | | | | is active and included in | | | | the Send Routing | | | | Information ack IF. | +-----------------------------+--------+-----------------------------+ | Supported CAMEL Phases In | S | This IE indicates the | | VMSC | | supported CAMEL phases of | | | | the VLR. It shall be | | | | present if known by the | | | | HLR, otherwise it shall be | | | | absent. | +-----------------------------+--------+-----------------------------+ | Offered CAMEL4 CSIs In VMSC | S | This IE indicates the CAMEL | | | | phase 4 CSIs offered in the | | | | VMSC. It shall be present | | | | if known by the HLR, | | | | otherwise it shall be | | | | absent. | +-----------------------------+--------+-----------------------------+ | VMSC Address | M | This IE indicates the E.164 | | | | address of the VMSC in | | | | whose area the B subscriber | | | | is currently registered. | +-----------------------------+--------+-----------------------------+
Location Information is defined in 3GPP TS 23.018 [12]. The following
differences apply:
* * *
Information element name Status Description Service area ID C,E See 3GPP TS
23.018 [12]. Cell ID C,E See 3GPP TS 23.018 [12]. VLR Number C See 3GPP TS
23.018 [12]. The HLR shall include the internally stored VLR Number. Current
Location Retrieved - Not applicable Location area ID C,E See 3GPP TS 23.003
[7]. Selected LSA Identity S This IE indicates the LSA identity associated
with the current position of the MS. Shall be present if the LSA ID in the
subscriber data matches the LSA ID of the current cell. If there are multiple
matches the LSA ID with the highest priority shall be sent. See 3GPP TS 23.073
[18]. E-UTRAN Cell ID C,E See 3GPP TS 23.018 [12]. Tracking area ID C,E See
3GPP TS 23.018 [12].
* * *
T‑CSI contains the following information elements:
* * *
Information element name Status Description gsmSCF Address M This IE is
described in subclause 4.3.5. Service Key M This IE is described in subclause
4.3.5. Default Call Handling M This IE is described in subclause 4.3.5. TDP
List M This IE is described in subclause 4.3.5. DP Criteria S This IE is
described in subclause 4.3.5. The HLR shall send only the criteria associated
with DP T_Busy or DP T_No_Answer, if available. CAMEL Capability Handling C
This IE is described in subclause 4.3.5. If this IE is absent then this
indicates that CAMEL phase 1 support is requested.
* * *
Offered CAMEL4 CSIs In VMSC contains the following information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI. It shall be present if known by the HLR,
otherwise it shall be absent. D‑CSI S This IE indicates the offer of CAMEL
phase 4 D‑CSI. It shall be present if known by the HLR, otherwise it shall be
absent. VT‑CSI S This IE indicates the offer of CAMEL phase 4 VT‑CSI. It shall
be present if known by the HLR, otherwise it shall be absent. MT‑SMS‑CSI S
This IE indicates the offer of CAMEL phase 4 MT‑SMS‑CSI. It shall be present
if known by the HLR, otherwise it shall be absent.
* * *
### 4.6.10 GMSC to HLR information flows
#### 4.6.10.1 Send Routeing Info
##### 4.6.10.1.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used to request information
from the HLR to route an MT call.
##### 4.6.10.1.2 Information Elements
Send Routeing Info contains the following CAMEL specific information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Alerting Pattern | S | This IE indicates the kind | | | | of Alerting Pattern to be | | | | applied. It shall be | | | | present if it was received | | | | from the gsmSCF or set by | | | | the gsmSSF. | +-----------------------------+--------+-----------------------------+ | Suppression Of Announcement | S | This IE indicates that | | | | announcements or tones | | | | generated as a result of | | | | unsuccessful call setup | | | | shall be suppressed. | | | | | | | | It shall be present in the | | | | interrogation if available, | | | | i.e. when it has been | | | | received from the gsmSCF. | +-----------------------------+--------+-----------------------------+ | Suppress T‑CSI | S | This IE indicates that | | | | T‑CSI shall be suppressed. | | | | | | | | It shall always be present | | | | in the second interrogation | | | | or if it was received from | | | | the gsmSCF due to an | | | | Initiate Call Attempt IF. | +-----------------------------+--------+-----------------------------+ | Supported CAMEL Phases | M | This IE lists the supported | | | | CAMEL phases in the GMSC. | +-----------------------------+--------+-----------------------------+ | Offered CAMEL4 CSIs | M | This IE indicates the CAMEL | | | | phase 4 CSIs offered in the | | | | GMSC. | | | | | | | | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Call Reference Number | M | This IE carries the Call | | | | Reference Number allocated | | | | for the call by the GMSC. | | | | | | | | It shall be allocated once | | | | per call and present in | | | | both first and second | | | | interrogations. | +-----------------------------+--------+-----------------------------+ | GMSC Address | M | This IE is the E.164 | | | | address of the GMSC. | +-----------------------------+--------+-----------------------------+ | Call Diversion Treatment | S | This IE indicates whether | | Indicator | | or not the call can be | | | | forwarded using the Call | | | | Forwarding or Call | | | | Deflection supplementary | | | | services. | | | | | | | | It shall be present if it | | | | was received within Forward | | | | Service Interaction | | | | Indicator in Service | | | | Interaction Indicators Two | | | | from the ISUP Initial | | | | Address Message or previous | | | | CAMEL processing. | +-----------------------------+--------+-----------------------------+
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI. D‑CSI S This IE indicates the offer of CAMEL
phase 4 D‑CSI. T‑CSI S This IE indicates the offer of CAMEL phase 4 T‑CSI.
* * *
### 4.6.11 VMSC to GMSC information flows
#### 4.6.11.1 Resume Call Handling
##### 4.6.11.1.1 Description
This IF is described in 3GPP TS 23.079 [19], it is used to request the GMSC to
take over handling the call so that it can be forwarded from the GMSC.
##### 4.6.11.1.2 Information Elements
Resume Call Handling contains the following CAMEL specific information
elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | O‑CSI | S | This IE indicates that | | | | CAMEL handling applies for | | | | an optimally routed late | | | | forwarded call. | | | | | | | | This IE shall be present if | | | | CAMEL handling applies; | | | | otherwise it shall be | | | | absent. | | | | | | | | Trigger criteria for | | | | DP Collected_Information, | | | | if present, shall be | | | | omitted from this IF. | | | | | | | | Trigger criteria for | | | | DP Route_Select_Failure, | | | | if present, shall be | | | | included in this IF. | +--------------------------+--------+-----------------------------+ | D‑CSI | S | This IE indicates that | | | | CAMEL handling applies for | | | | an optimally routed late | | | | forwarded call. | | | | | | | | This IE shall be present if | | | | CAMEL handling applies; | | | | otherwise it shall be | | | | absent. | +--------------------------+--------+-----------------------------+
### 4.6.12 MSC to VLR information flows
#### 4.6.12.1 Send Info For ICA
##### 4.6.12.1.1 Description
This IF is used to request the VLR to provide information to handle an
outgoing call leg created by the gsmSCF.
##### 4.6.12.1.2 Information Elements
* * *
Information element name NP Description Called Number M This IE indicates the
E.164 number of the call leg destination. IMSI M This IE is the IMSI of the
served CAMEL subscriber. CUG Index C For the definition of this IE, see 3GPP
TS 23.085 [22]. Suppress Preferential CUG C For the definition of this IE, see
3GPP TS 23.085 [22]. Suppress CUG Outgoing Access C For the definition of this
IE, see 3GPP TS 23.085 [22]. Suppress Outgoing Call Barring C This IE
indicates that outgoing call barrings shall be suppressed for the call leg.
Suppress D‑CSI S This IE indicates that D‑CSI shall be suppressed. It shall
always be present in the second interrogation. N‑CSI Available S This IE
indicates that N‑CSI is available in MSC. It shall be present in the first
interrogation if N‑CSI is available in the MSC. Non‑CUG Call S This IE
indicates that no parameters for CUG should be used for the call. It shall be
present if received from gsmSCF. CUG Interlock Code S For the definition of
this IE, see 3GPP TS 23.085 [22]. It shall be present if received from gsmSCF.
Outgoing Access S For the definition of this IE, see 3GPP TS 23.085 [22]. It
shall be present if received from gsmSCF.
* * *
#### 4.6.12.2 Send Info For Incoming Call
##### 4.6.12.2.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used to request the VLR to
provide information to handle an incoming call.
##### 4.6.12.2.2 Information Elements
Send Info For Incoming Call contains the following CAMEL specific information
elements:
* * *
Information element name Status Description Suppress VT‑CSI S This IE
indicates that VT‑CSI shall be suppressed. It shall never be present in the
first interrogation; it shall always be present in the second interrogation.
Call Diversion Treatment Indicator S This IE indicates whether or not the call
can be forwarded using the Call Forwarding or Call Deflection supplementary
services. It shall be present if received within the Forward Service
Interaction Indicator in the Service Interaction Indicators Two from the IAM
or previous CAMEL processing.
* * *
#### 4.6.12.3 Send Info For MT Reconnected Call
##### 4.6.12.3.1 Description
This IF is used to request the VLR to provide information to handle a
reconnected MT call.
##### 4.6.12.3.2 Information Elements
* * *
Information element name Required Description Called Number M E.164 number of
the call destination.
* * *
#### 4.6.12.4 Send Info For Outgoing Call
##### 4.6.12.4.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used to request the VLR to
provide information to handle an outgoing call.
##### 4.6.12.4.2 Information Elements
Send Info For Outgoing Call contains the following CAMEL specific information
elements:
* * *
Information element name Status Description Suppress O‑CSI S This IE indicates
that O‑CSI shall be suppressed. It shall always be present in the second
interrogation. Suppress D‑CSI S This IE indicates that D‑CSI shall be
suppressed. It shall always be present in the second interrogation. N‑CSI
Available S This IE indicates that N‑CSI is available in MSC. It shall be
present in the first interrogation if N‑CSI is available in the MSC.
* * *
#### 4.6.12.5 Send Info For Reconnected Call
##### 4.6.12.5.1 Description
This IF is used to request the VLR to provide information to handle a
reconnected MO call.
##### 4.6.12.5.2 Information Elements
* * *
Information element name Status Description Called Number M This IE indicates
the E.164 number of the call destination. Bearer Service S,E This IE indicates
the bearer service required for the MO call, derived from the CS bearer
capability information received in the setup request from the MS. One of
bearer service or teleservice shall be present. Teleservice S,E This IE
indicates the teleservice required for the MO call, derived from the CS bearer
capability information received in the setup request from the MS or from the
emergency setup request from the MS. One of bearer service or teleservice
shall be present. CUG Index S For the definition of this IE, see 3GPP TS
23.085 [22]. It shall be present if it was received in the setup request from
the MS. Suppress Preferential CUG S For the definition of this IE, see 3GPP TS
23.085 [22]. It shall be present if it was received in the setup request from
the MS. Suppress CUG Outgoing Access S For the definition of this IE, see 3GPP
TS 23.085 [22]. It shall be present if it was received in the setup request
from the MS. Suppress O‑CSI S This IE indicates that O‑CSI shall be
suppressed. It shall always be present in the second interrogation.
* * *
### 4.6.13 VLR to MSC information flows
#### 4.6.13.1 Complete Call
##### 4.6.13.1.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used to instruct the MSC to
continue the connection of a call.
##### 4.6.13.1.2 Information Elements
Complete Call contains the following CAMEL specific information elements:
* * *
Information element name MO MF MT VT NC NP Description O‑CSI S - - - - - This
IE indicates that CAMEL handling applies for an MO call. It shall be present
in the response to the first interrogation for an MO call if CAMEL handling
applies; otherwise it shall be absent. It shall be absent from the response to
the second interrogation for an MO call. D‑CSI C - - - - C This IE identifies
the subscriber as having originating CAMEL dialled services. Call Reference
Number - - - M - - This IE carries the Call Reference Number provided by the
HLR in the Provide Roaming Number IF. GMSC Address - - - M - - This IE is the
E.164 address of the GMSC.
* * *
#### 4.6.13.2 Continue CAMEL Handling
##### 4.6.13.2.1 Description
This IF is used to instruct the MSC to continue the CAMEL specific handling.
##### 4.6.13.2.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | VT‑CSI | M | This IE identifies the | | | | subscriber as having | | | | terminating CAMEL services | | | | in the VMSC. | +--------------------------+--------+-----------------------------+ | IMSI | M | This IE contains the IMSI | | | | of the B subscriber. | +--------------------------+--------+-----------------------------+ | MSISDN | S | This IE contains the E.164 | | | | number of the B subscriber. | | | | It will be used to create | | | | the redirecting number | | | | presented to the C | | | | subscriber. It shall be | | | | present if the call is to | | | | be forwarded or if it has | | | | been provided by the HLR in | | | | the Provide Roaming Number | | | | IF, otherwise it shall be | | | | absent. | +--------------------------+--------+-----------------------------+ | CUG Interlock | S | For the definition of this | | | | IE, see 3GPP | | | | TS 23.085 [22]. It shall | | | | be present if the VLR has | | | | determined that the | | | | forwarded call is to be | | | | treated as a CUG call in | | | | accordance with the rules | | | | in 3GPP TS 23.085 [22], | | | | otherwise it shall be | | | | absent. | +--------------------------+--------+-----------------------------+ | CUG Outgoing Access | S | For the definition of this | | | | IE, see 3GPP | | | | TS 23.085 [22]. It shall | | | | be present if the VLR has | | | | determined that the | | | | forwarded call is to be | | | | treated as a CUG call with | | | | outgoing access in | | | | accordance with the rules | | | | in 3GPP TS 23.085 [22], | | | | otherwise it shall be | | | | absent. | +--------------------------+--------+-----------------------------+ | Location Information | S | This IE contains the | | | | information to define the | | | | location of the MS: see | | | | definition in 3GPP | | | | TS 23.018 [12]. It shall | | | | be present if location | | | | information was requested | | | | and is available; otherwise | | | | it shall be absent. | +--------------------------+--------+-----------------------------+ | GMSC-Address | M | This IE is the E.164 | | | | address of the GMSC which | | | | was received in the Provide | | | | Roaming Number. | +--------------------------+--------+-----------------------------+ | Call Reference Number | M | This IE carries the Call | | | | Reference Number provided | | | | by the HLR in the Provide | | | | Roaming Number IF. | +--------------------------+--------+-----------------------------+ | ExtBasic Service Code | M | This IE indicates the type | | | | of basic service, i.e. | | | | teleservice or bearer | | | | service. | +--------------------------+--------+-----------------------------+ | Subscriber State | M | This IE indicates the | | | | status of the MS. The | | | | states are: | | | | | | | | - CAMELBusy: The MS is | | | | engaged on a transaction | | | | for a mobile originating or | | | | terminated circuit-switched | | | | call. | | | | | | | | - | | | | Net | | | | workDeterminedNotReachable: | | | | The network can determine | | | | from its internal data that | | | | the MS is not reachable. | | | | | | | | - AssumedIdle: The state | | | | of the MS is neither | | | | \"CAMELBusy\" nor | | | | \"Netwo | | | | rkDeterminedNotReachable\". | +--------------------------+--------+-----------------------------+
#### 4.6.13.3 Process Call Waiting
##### 4.6.13.3.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used to instruct the MSC to
continue the connection of a waiting call.
##### 4.6.13.3.2 Information Elements
Process Call Waiting contains the following CAMEL specific information
elements:
* * *
Information element name Status Description Call Reference Number M This IE
carries the Call Reference Number provided by the HLR in the Provide Roaming
Number IF. GMSC Address M This IE is the E.164 address of the GMSC.
* * *
#### 4.6.13.4 Send Info For ICA negative response
##### 4.6.13.4.1 Description
This IF is used to indicate that the outgoing call leg for which the MSC
requested subscription information shall not be connected.
##### 4.6.13.4.2 Information Elements
The negative response information elements can take the following values:
\- Bearer service not provisioned;
\- Call barred (Operator determined barring);
\- Call barred (Supplementary service barring);
\- CUG reject (Inconsistent access information - index incompatible with basic
service);
\- CUG reject (Inconsistent access information - no CUG selected);
\- CUG reject (Outgoing calls barred within the CUG);
\- CUG reject (Unknown CUG index);
\- Teleservice not provisioned.
#### 4.6.13.5 Send Info For Incoming Call ack
##### 4.6.13.5.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used to indicate that the
incoming call for which the MSC requested subscription information shall be
forwarded.
##### 4.6.13.5.1 Information Elements
Send Info For Incoming Call ack contains the following CAMEL specific
information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates that
originating CAMEL service handling applies for a forwarded call. It shall be
present if originating CAMEL service handling applies; otherwise it shall be
absent. D‑CSI S This IE indicates that originating CAMEL dialled service
handling applies for a forwarded call. It shall be present if originating
CAMEL dialled service handling applies; otherwise it shall be absent.
Suppression Of Announcement S This IE indicates that announcements or tones
generated when the call is forwarded shall be suppressed. It shall be present
if it was received in the Provide Roaming Number for this call. Call Reference
Number M This IE carries the Call Reference Number provided by the HLR in the
Provide Roaming Number IF. GMSC Address M This IE is the E.164 address of the
GMSC. Supported CAMEL Phases S This IE lists the supported CAMEL phases in the
GMSC. It shall be present if the VLR received it from the HLR in the Provide
Roaming Number.
* * *
#### 4.6.13.6 Send Info For Incoming Call negative response
##### 4.6.13.6.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used to indicate that the
incoming call for which the MSC requested subscription information shall not
be connected.
##### 4.6.13.6.2 Information Elements
Send Info For Incoming Call negative response contains the following CAMEL
specific information element which may be attached as an IE to any of the
negative response values defined in 3GPP TS 23.018 [12]:
* * *
Information element name Status Description Suppression Of Announcement S This
IE indicates that announcements or tones generated as a result of unsuccessful
call establishment shall be suppressed. It shall be present if it was received
in the Provide Roaming Number for this call.
* * *
#### 4.6.13.7 Send Info For MT Reconnected Call ack
##### 4.6.13.7.1 Description
This IF is used to instruct the MSC to continue the connection of a
reconnected MT call.
##### 4.6.13.7.2 Information Elements
+--------------------------+----------+----------------------------+ | Information element name | Required | Description | +--------------------------+----------+----------------------------+ | O‑CSI | S | This IE indicates that | | | | originating CAMEL service | | | | handling applies for the | | | | reconnected call. | | | | | | | | It shall be present if | | | | originating CAMEL service | | | | handling applies; | | | | otherwise it shall be | | | | absent. | +--------------------------+----------+----------------------------+ | D‑CSI | S | This IE indicates that | | | | originating CAMEL dialled | | | | service handling applies | | | | for the reconnected call. | | | | | | | | It shall be present if | | | | originating CAMEL dialled | | | | service handling applies; | | | | otherwise it shall be | | | | absent. | +--------------------------+----------+----------------------------+
#### 4.6.13.8 Send Info For MT Reconnected Call negative response
##### 4.6.13.8.1 Description
This IF is used to indicate that the reconnected MT call for which the MSC
requested subscription information shall not be connected.
##### 4.6.13.8.2 Information Elements
The negative response information element can take the following value:
\- CUG reject
#### 4.6.13.9 Send Info For Reconnected Call ack
##### 4.6.13.9.1 Description
This IF is used to instruct the MSC to continue the connection of a
reconnected MO call.
##### 4.6.13.9.2 Information Elements
Send Info For Reconnected Call ack does not contain any information elements.
#### 4.6.13.10 Send Info For Reconnected Call negative response
##### 4.6.13.10.1 Description
This IF is used to indicate that the reconnected MO call for which the MSC
requested subscription information shall not be connected.
##### 4.6.13.10.2 Information Elements
The negative response information element can take the following value:
\- Call barred (Operator determined barring);
\- Call barred (Supplementary service barring).
### 4.6.14 Internal MSC information flows
#### 4.6.14.1 Perform Call Forwarding ack
##### 4.6.14.1.1 Description
This IF is defined in 3GPP TS 23.018 [12]; it is used to inform the MSC that
Call Forwarding is taking place.
##### 4.6.14.1.2 Information Elements
Perform Call Forwarding ack is defined in 3GPP TS 23.018 [12]. The following
differences apply:
* * *
Information element name Status Description Forwarded-to Number M If the
Forwarded-to Number is not available due to CAMEL handling (a Disconnect Leg
IF has been received for Leg 2), then the MSC shall populate this parameter
with a dummy number.
* * *
### 4.6.15 gsmSCF to HLR information flows
#### 4.6.15.1 Send Routeing Info
##### 4.6.15.1.1 Description
This IF is defined in 3GPP TS 23.018 [12] and subclause 4.6.10.1; it is used
to request information from the HLR to route a gsmSCF initiated call.
Refer to 3GPP TS 29.007 [35] for the usage of ISDN BC, ISDN LLC, ISDN HLC and
MSISDN for the selection of the PLMN Basic Service.
##### 4.6.15.1.2 Information Elements
Send Routeing Info from the gsmSCF contains the following information
elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | MSISDN | M | This IE indicates the | | | | MSISDN of the called | | | | subscriber. | +-----------------------------+--------+-----------------------------+ | Alerting Pattern | O | This IE indicates the kind | | | | of Alerting Pattern to be | | | | applied. | +-----------------------------+--------+-----------------------------+ | CUG Interlock | O | For the definition of this | | | | IE, see 3GPP | | | | TS 23.085 [22]. | +-----------------------------+--------+-----------------------------+ | CUG Outgoing Access | O | For the definition of this | | | | IE, see 3GPP | | | | TS 23.085 [22]. | +-----------------------------+--------+-----------------------------+ | Suppression Of Announcement | O | This IE indicates that | | | | announcements or tones | | | | generated as a result of | | | | unsuccessful call | | | | establishment shall be | | | | suppressed. | +-----------------------------+--------+-----------------------------+ | Suppress T‑CSI | M | This IE indicates that | | | | CAMEL subscription | | | | information should not be | | | | returned in the first Send | | | | Routeing Info ack (to avoid | | | | the need for a second | | | | interrogation). | +-----------------------------+--------+-----------------------------+ | Supported CAMEL Phases | M | This IE indicates the CAMEL | | | | Phases supported by the | | | | gsmSCF. | +-----------------------------+--------+-----------------------------+ | Offered CAMEL4 CSIs | S | This IE indicates the CAMEL | | | | phase 4 CSIs offered by the | | | | gsmSCF. This IE shall be | | | | present when the Supported | | | | CAMEL Phases IE indicates | | | | support of CAMEL Phase 4. | | | | | | | | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Call Reference Number | M | This IE carries the Call | | | | Reference Number allocated | | | | for the call by the gsmSCF. | +-----------------------------+--------+-----------------------------+ | GMSC Or gsmSCF Address | M | This IE is the E.164 | | | | address of the gsmSCF. | +-----------------------------+--------+-----------------------------+ | Call Diversion Treatment | O | This IE indicates whether | | Indicator | | or not the call is allowed | | | | to be forwarded on behalf | | | | of the called party using | | | | the Call Forwarding | | | | supplementary service. | +-----------------------------+--------+-----------------------------+ | Pre-paging Supported | S | This IE shall be present if | | | | the gsmSCF supports | | | | pre-paging, otherwise it | | | | shall be absent. | +-----------------------------+--------+-----------------------------+ | Interrogation Type | M | This IE shall contain the | | | | value \"Basic Call\". | +-----------------------------+--------+-----------------------------+ | Long FTN Supported | O | This IE indicates that the | | | | gsmSCF supports Long | | | | Forwarded to Numbers. | +-----------------------------+--------+-----------------------------+ | gsmSCF Initiated Call | M | This IE indicates that the | | | | IF was originated by a | | | | gsmSCF. | +-----------------------------+--------+-----------------------------+ | Suppress Incoming Call | O | This IE indicates that | | Barring | | Incoming Call Barrings | | | | shall be suppressed for the | | | | called party. | +-----------------------------+--------+-----------------------------+ | Suppress VT‑CSI | O | This IE indicates that | | | | VT‑CSI shall be suppressed. | +-----------------------------+--------+-----------------------------+ | ISDN BC | O | ISDN bearer capability. See | | | | 3GPP TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | ISDN LLC | O | ISDN lower layer | | | | compatibility. See 3GPP | | | | TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | ISDN HLC | O | ISDN higher layer | | | | compatibility. See 3GPP | | | | TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | Suppress MT SS | O | This IE indicates the MT | | | | supplementary services that | | | | shall be suppressed for the | | | | called party. | +-----------------------------+--------+-----------------------------+
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI. D‑CSI S This IE indicates the offer of CAMEL
phase 4 D‑CSI. T‑CSI S This IE indicates the offer of CAMEL phase 4 T‑CSI.
* * *
### 4.6.16 HLR to gsmSCF information flows
#### 4.6.16.1 Send Routeing Info ack
##### 4.6.16.1.1 Description
This IF is described in subclause 4.6.9.1; it is used by the HLR to transfer
the requested routeing information to the gsmSCF.
#### 4.6.16.2 Send Routeing Info negative response
##### 4.6.16.2.1 Description
This IF is described in 3GPP TS 23.018 [12]; it is used by the HLR to indicate
that the routeing information is not available.
## 4.7 Interaction with supplementary services
When the gsmSCF initiates a call to a subscriber, the gsmSCF can indicate to
the HLR the MT supplementary services that shall be suppressed for this call.
### 4.7.1 Line identification
For a call subject to CAMEL control, the gsmSCF shall have the option to send
the Calling Party Restriction Indicator to the gsmSSF. This information
element will be sent to the MSC and shall indicate whether the CLI
Presentation Indicator present in the Calling Party Number shall be set by
CAMEL action to Restricted.
### 4.7.2 Call forwarding services
#### 4.7.2.1 Registration of Call Forwarding
The functional behaviour for the registration of the Call Forwarding
supplementary service is defined in 3GPP TS 23.082 [20]. The procedure
specific to CAMEL is defined in this subclause:
\- CAMEL_Check_CF_Interaction.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 4.120-1: Procedure CAMEL_Check_CF_Interaction (sheet 1)
#### 4.7.2.2 Invocation of Call Forwarding
The functional behaviour for the invocation of the Call Forwarding
supplementary service is defined in 3GPP TS 23.018 [12] and 3GPP TS 23.082
[20]. The following additional requirements apply.
When Call Forwarding is invoked for a CAMEL subscriber with O‑CSI, the gsmSSF
shall send the FTN to the gsmSCF in the format in which it was received from
the HLR. When Call Forwarding is invoked for a CAMEL subscriber with D‑CSI or
if an N‑CSI is present in the forwarding MSC, then the FTN shall be treated as
defined in subclause 4.2.1.2.2.
If the Service Interaction Indicators Two parameter was included in the
Initial Address Message, the Continue With Argument information flow or the
Connect message, the appropriate indicator shall be applied for the forwarded
call.
An HLR shall not send an FTN which is not in international format to a GMSC
which does not support CAMEL phase 2, i.e. if the HLR is handling a request
from a GMSC for routeing information and the forwarded-to number is registered
in a format other than international, the service logic in the HLR shall
behave as if the call forwarding is provisioned but not registered.
#### 4.7.2.3 Invocation of Call Deflection
The functional behaviour for the invocation of the Call Deflection
supplementary service is defined in 3GPP TS 23.018 [12] and 3GPP TS 23.072
[16]. The following additional requirements apply.
When Call Deflection is invoked by a CAMEL subscriber with O‑CSI, the gsmSSF
shall send the DTN to the gsmSCF in the format in which it was received from
the MS. When Call Deflection is invoked by a CAMEL subscriber with D‑CSI or if
a N‑CSI is present in the VMSC, then the DTN shall be treated as defined in
subclause 4.2.1.2.2.
If the Service Interaction Indicators Two parameter was included in the
Initial Address Message, the Continue With Argument information flow or the
Connect information flow, the appropriate indicator shall be applied for the
deflected call.
### 4.7.3 Call Barring services
When a CAMEL subscriber with O‑CSI and TIF‑CSI attempts to activate a
conditional call barring service (BOIC,BOIC-exHC), the HLR shall not check the
interactions with call forwarding.
When the gsmSCF initiates a call to a subscriber, the gsmSCF can indicate to
the HLR that incoming call barrings shall be suppressed for this call.
When the gsmSCF creates an additional call leg in an existing call, the gsmSCF
can indicate to the VLR (via the gsmSSF and MSC) that outgoing call barrings
shall be suppressed for this call leg.
### 4.7.4 Closed User Group
For a CUG subscriber with CAMEL services:
\- The HLR shall store (and transfer to the VLR) the necessary subscriber data
to ensure that the served subscriber is not unnecessarily prevented by CUG
constraints from originating calls.
\- The HLR shall store the necessary subscriber data to ensure that the served
subscriber is not unnecessarily prevented by CUG constraints from receiving
calls.
For an MO, MF or TO call, the CUG information for that call shall be sent to
the gsmSCF in the Initial DP information flow.
If the gsmSCF returns a Continue information flow, the call shall continue
with the original CUG information unchanged.
If the gsmSCF returns a Connect or Continue With Argument information flow,
the CUG handling in table 4.7 applies.
Table 4.7: CUG handling on receipt of Connect or Continue With Argument for an
MO, MF or TO call
+----------------------------------+----------------------------------+ | CUG parameters in information | Handling | | flow | | +----------------------------------+----------------------------------+ | Non-CUG call (note 1) | Remove CUG information for the | | | call and continue as a non-CUG | | | call | +----------------------------------+----------------------------------+ | CUG information (note 2) | Call shall continue with | | | modified CUG information | +----------------------------------+----------------------------------+ | No CUG information | Call shall continue with | | | original CUG information | +----------------------------------+----------------------------------+ | NOTE 1: Received in Service | | | Interaction Indicators Two IE. | | | | | | NOTE 2: CUG information consists | | | of at least one of CUG Interlock | | | Code and Outgoing Access | | | Indicator. | | +----------------------------------+----------------------------------+
For an MT call which is to be routed to the terminating subscriber, the CUG
information shall be extracted from the Send Routeing Information ack and sent
to the gsmSCF in the Initial DP, but the gsmSCF shall not have the ability to
change the CUG information for the call.
For an VT call which is to be routed to the terminating subscriber, the CUG
information shall be extracted from the incoming ISUP IAM and sent to the
gsmSCF in the Initial DP, but the gsmSCF shall not have the ability to change
the CUG information for the call.
For an MT or VT call which is subject to CAMEL forwarding, the gsmSCF shall
return a Connect information flow and the CUG handling in table 4.7 applies.
# 5 USSD to/from gsmSCF
## 5.1 Architecture
### 5.1.1 Functional Entities used for CAMEL
This subclause describes the functional architecture needed to support CAMEL
handling of USSD to/from gsmSCF. The functional model of USSD in an HLR that
supports CAMEL is shown in figure 5.1. The phase 2 USSD handler is defined in
3GPP TS 23.090 [24]. Phase 1 USSD information flows may be relayed from the
HLR to the gsmSCF. CAMEL introduces a \"CAMEL USSD application\" which is
invoked by the USSD handler. The CAMEL USSD functional entities and
application behaviour is specified in this subclause.
{width="5.6090277777777775in" height="2.81875in"}
Figure 5.1: Handling of USSD to and from a CAMEL subscriber
**HLR:** The HLR stores for subscribers requiring CAMEL support the
information relevant to the current subscription regarding U‑CSI. The UG‑CSI
is stored as global data applicable to all subscribers. The U‑CSI and the
UG‑CSI are stored in the HLR only.
**gsmSCF: see subclause 3.1.**
### 5.1.2 Interfaces defined for CAMEL
This subclause describes the different interfaces applicable to CAMEL. It
specifies on a high level the functions specific to CAMEL.
#### 5.1.2.1 gsmSCF - HLR interface
This interface is used for USSD information flows, both for gsmSCF-initiated
dialogues and MS-initiated dialogues (relayed via HLR). It is a network
operator option whether to support or not USSD information flows on this
interface.
## 5.2 Description of CAMEL Subscriber Data
### 5.2.1 USSD CAMEL Subscription Information (U‑CSI)
The subscription information specified in this subclause is for information
only.
This subclause defines the contents of the USSD CAMEL Subscription Information
(U‑CSI). The U‑CSI consists of a list of pairs of the following two
parameters.
#### 5.2.1.1 Service Code
Service code for a specific application in a gsmSCF which interacts with the
user by USSD.
#### 5.2.1.2 gsmSCF address
Address to be used to access the gsmSCF for a particular subscriber and a
particular service code. The address shall be an E.164 number to be used for
routeing.
## 5.3 Content of the USSD General CAMEL Service Information (UG‑CSI)
The service information specified in this subclause is for information only.
This subclause defines the contents of the USSD General CAMEL Service
Information (UG‑CSI). The allocation of the UG‑CSI is independent from a
particular subscriber.
The UG‑CSI consists of a list of pairs of the following two parameters.
### 5.3.1 Service Code
Service code for a specific application in a gsmSCF which interacts with the
user by USSD.
### 5.3.2 gsmSCF address
Address to be used to access the gsmSCF for a particular service code. The
address shall be an E.164 number to be used for routeing.
## 5.4 Procedures
### 5.4.1 MS Initiated USSD
For the behaviour of the USSD handler in HLR when receiving a MS initiated
USSD see 3GPP TS 23.090 [24].
When the USSD handler has determined that the service code present in the
received USSD does not indicate that an USSD application in the HLR shall be
invoked it shall route the USSD to the USSD application specific for CAMEL,
i.e. the CAMEL USSD application.
The procedure at the CAMEL USSD application at the HLR is implementation
dependent. The following text describes a recommended procedure.
The CAMEL USSD application shall check the U‑CSI data assigned to the specific
subscriber. If the service code is present in the U‑CSI the USSD is routed to
the gsmSCF given by the gsmSCF address stored against the service code in the
U‑CSI.
If the service code is not present in the U‑CSI (or the subscriber does not
have U‑CSI defined) then the CAMEL USSD application shall check the UG‑CSI
data assigned to the HLR. If the service code is present in the UG‑CSI then
the USSD is routed to the gsmSCF given by the gsmSCF address stored against
the service code in the UG‑CSI.
If the service code is not present in U‑CSI or UG‑CSI an error (unknown
application) is returned to the USSD handler.
### 5.4.2 gsmSCF Initiated USSD
The HLR may at any time receive a USSD information flow from the gsmSCF. If
the subscriber can be contacted, the HLR shall set up a transaction to the VLR
and forward the information flow unchanged. Any further information exchange
between the gsmSCF and MSC shall be transparent to the VLR and the HLR. When
one transaction is released, the HLR shall release the other. If an error is
received from the MSC, the VLR shall release the transaction to the HLR and
the HLR shall release the transaction to the gsmSCF.
## 5.5 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for USSD handling.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Specific conditions (S) or Optional (O) in the \"Status\" column.
An \'M\' IE shall always be included. A \'C\' IE shall be included if the
sending entity has the necessary information to populate the IE. The
conditions for the inclusion of an \'S\' IE are shown in the \'Description\'
column of the definition table. An \'O\' IE may be included or omitted as
required by the service logic. This categorization is a functional
classification, i.e. it defines the requirements for the stage 2 information.
It is not a stage 3 classification to be used for the ASN.1 syntax of the
protocol.
The following principles apply for the handling of the IEs by the receiving
entity:
\- The gsmSCF may silently discard any IE which it does not functionally
support.
\- The HLR shall return an error if it does not functionally support an IE
which it receives.
Details of errors and exceptions to these rules are specified in are specified
in 3GPP TS 29.002 [34].
### 5.5.1 gsmSCF to HLR information flows
#### 5.5.1.1 Unstructured SS Request
##### 5.5.1.1.1 Description
This IF is used for the gsmSCF to request data from the MS via the HLR.
##### 5.5.1.1.2 Information Elements
* * *
Information element name Status Description USSD String M This IE contains the
string that will be sent to the MS. Data Coding Scheme M This IE indicates the
characteristics of the USSD string. IMSI S,E This IE identifies the subscriber
for which the information is requested. It shall be present if this IF is the
first IF in a USSD dialogue, otherwise it shall be absent. MSISDN S,E This IE
identifies the subscriber for which the information is requested. It shall be
present if this IF is the first IF in a USSD dialogue, otherwise it shall be
absent. Alerting Pattern O This IE indicates an alerting pattern to be sent to
the MS.
* * *
#### 5.5.1.2 Unstructured SS Notify
##### 5.5.1.2.1 Description
This IF is used for the gsmSCF to send data to the MS via the HLR.
##### 5.5.1.2.2 Information Elements
* * *
Information element name Status Description USSD String M This IE contains the
string that will be sent to the MS. Data Coding Scheme M This IE indicates the
characteristics of the USSD string. IMSI S,E This IE identifies the subscriber
for which the information is requested. It shall be present if this IF is the
first IF in a USSD dialogue, otherwise it shall be absent. MSISDN S,E This IE
identifies the subscriber for which the information is requested. It shall be
present if this IF is the first IF in a USSD dialogue, otherwise it shall be
absent. Alerting Pattern O This IE indicates an alerting pattern to be sent to
the MS.
* * *
#### 5.5.1.3 Process Unstructured SS Data ack
##### 5.5.1.3.1 Description
This IF is used for the gsmSCF to send the response to the MS via the HLR for
the MS initiated IF.
##### 5.5.1.3.2 Information Elements
The following information element is required:
* * *
Information element name Status Description SS User Data C This IE contains
the string that will be sent to the MS.
* * *
#### 5.5.1.4 Process Unstructured SS Request ack
##### 5.5.1.4.1 Description
This IF is used for the gsmSCF to send the response to the MS via the HLR for
the MS initiated IF.
##### 5.5.1.4.2 Information Elements
* * *
Information element name Status Description USSD String S This IE contains the
string that will be sent to the MS. It shall be present if the Data Coding
Scheme is present; otherwise it shall be absent. Data Coding Scheme S This IE
indicates the characteristics of the USSD string. It shall be present if the
Data Coding Scheme is present; otherwise it shall be absent.
* * *
### 5.5.2 HLR to gsmSCF information flows
#### 5.5.2.1 Unstructured SS Request ack
##### 5.5.2.1.1 Description
This IF is used for the MS to send to the gsmSCF via the HLR for the gsmSCF
initiated IF.
##### 5.5.2.1.2 Information Elements
* * *
Information element name Status Description USSD String C This IE contains the
string that will be sent to the gsmSCF. It shall be present if the Data Coding
Scheme is present; otherwise it shall be absent. Data Coding Scheme C This IE
indicates the characteristics of the USSD string. It shall be present if the
Data Coding Scheme is present; otherwise it shall be absent.
* * *
#### 5.5.2.2 Unstructured SS Notify ack
##### 5.5.2.2.1 Description
This IF is used for the MS to via the HLR acknowledge to the gsmSCF that the
notification was received.
##### 5.5.2.2.2 Information Elements
This IE contains no information element.
#### 5.5.2.3 Process Unstructured SS Data
##### 5.5.2.3.1 Description
This IF is used for the MS to request data from gsmSCF via the HLR.
##### 5.5.2.3.2 Information Elements
* * *
Information element name Status Description SS User Data M This IE contains
the string that was received from the MS.
* * *
#### 5.5.2.4 Process Unstructured SS Request
##### 5.5.2.4.1 Description
This IF is used for the MS to request data from the gsmSCF via the HLR.
##### 5.5.2.4.2 Information Elements
+---------------------------+--------+-----------------------------+ | Information element name | Status | Description | +---------------------------+--------+-----------------------------+ | USSD String | M | This IE contains the string | | | | that will be sent to the | | | | gsmSCF, including the | | | | Service Code. | +---------------------------+--------+-----------------------------+ | Data Coding Scheme | M | This IE indicates the | | | | characteristics of the USSD | | | | string | +---------------------------+--------+-----------------------------+ | IMSI | M | This IE identifies the | | | | subscriber. | +---------------------------+--------+-----------------------------+ | MSISDN | S | This IE contains the basic | | | | MSISDN of the subscriber | | | | who has requested the USSD | | | | IF. This IE is used as an | | | | operator option. | +---------------------------+--------+-----------------------------+ | Originating Entity Number | M | This IE identifies the | | | | functional entity | | | | initiating the information | | | | flow. | | | | | | | | In this case, this shall be | | | | the address of the HLR. | +---------------------------+--------+-----------------------------+
#### 5.5.2.5 Begin Subscriber Activity
##### 5.5.2.5.1 Description
This IF is used by the HLR to start subscriber activity towards the gsmSCF for
USSD purposes.
##### 5.5.2.5.2 Information Elements
+---------------------------+--------+-----------------------------+ | Information element name | Status | Description | +---------------------------+--------+-----------------------------+ | IMSI | M | This IE identifies the | | | | subscriber. | +---------------------------+--------+-----------------------------+ | Originating Entity Number | M | This IE identifies the | | | | functional entity | | | | initiating the subscriber | | | | activity. | | | | | | | | In this case, this shall be | | | | the address of the HLR. | +---------------------------+--------+-----------------------------+
# 6 GPRS interworking
## 6.1 Architecture
### 6.1.1 Functional Entities used for CAMEL
This subclause describes the functional architecture needed to support GPRS
interworking for CAMEL. Figure 6.1 shows the functional entities involved in a
GPRS session requiring CAMEL support. The architecture is applicable to the
third phase of CAMEL or higher.
{width="6.0in" height="3.3194444444444446in"}
Figure 6.1: Functional architecture for support of CAMEL
**HLR:** For subscribers requiring CAMEL support, the HLR stores the
information relevant to the current subscription GPRS‑CSI.
**SGSN:** When processing GPRS Attach requests or Inter-SGSN Routeing Area
Updates for subscribers requiring CAMEL support, the SGSN receives a GPRS‑CSI
from the HLR, indicating the SGSN to request instructions from the gprsSSF.
The SGSN monitors on request the GPRS events and informs the gprsSSF of these
events during processing, enabling the gprsSSF to control the execution of the
GPRS session or individual PDP contexts in the SGSN.
**gprsSSF: see subclause 3.1.**
**gsmSCF: see subclause 3.1.**
### 6.1.2 Interfaces defined for CAMEL
#### 6.1.2.1 SGSN - gprsSSF interface
This is an internal interface. The interface is described in the present
document to make it easier to understand the handling of DPs (arming/disarming
of DPs, DP processing etc.).
#### 6.1.2.2 gprsSSF - gsmSCF interface
This interface is used by the gsmSCF to control a GPRS session or individual
PDP Context in a certain gprsSSF. GPRS dialogues between the gprsSSF and the
gsmSCF on this interface are opened as a result of the gprsSSF sending a
request for instructions to the gsmSCF. A GPRS dialogue is composed of a
sequence of TC dialogues linked together by the same reference. The GPRS
dialogue handler allows the TC dialogue handling.
#### 6.1.2.3 HLR - SGSN interface
This interface is used to send CAMEL related subscriber data to a visited GPRS
network, e.g. GPRS‑CSI.
## 6.2 Detection Points (DPs)
### 6.2.1 Definition and description
GPRS events may be made visible to the gsmSCF. The DPs are the points in
association at which these events are detected. The DPs for GPRS Session and
PDP Context are described in subclause 6.4.2 and subclause 6.4.3.
A DP can be armed in order to notify the gsmSCF that the GPRS event was
encountered, and to allow the gsmSCF to influence subsequent handling of the
GPRS Session, or the PDP Context. If the DP is not armed, the processing
entity continues the processing without gsmSCF involvement at this DP.
Three different types of DPs are identified:
\- Trigger Detection Point-Request (TDP‑R): This detection point is statically
armed and may initiate a CAMEL control relationship. This CAMEL control
relationship is within a new GPRS dialogue. When the GPRS event is encountered
and reported, processing is suspended.
\- Event Detection Point- Request (EDP‑R): This detection point is dynamically
armed within the context of a CAMEL control relationship. When the GPRS event
is encountered, and reported, processing is suspended and the gprsSSF waits
for instructions from the gsmSCF.
\- Event Detection Point-Notification (EDP‑N): This detection point is
dynamically armed within the context of a CAMEL control relationship. When the
GPRS event is encountered and reported, processing is not suspended.
Arming/disarming mechanism:
A DP may be statically armed or dynamically armed. The following arming rules
apply:
\- DPs for GPRS Session and PDP Context are statically armed as a result of
the GPRS‑CSI analysis in the SGSN.
\- DPs may be dynamically armed by the gsmSCF within the context of a CAMEL
control relationship. In scenario 1 which is described in the subclause
6.4.4.1, PDP context related DPs may be armed as generic DP or as non-generic
DP.
The following disarming rules apply:
\- A statically armed DP is disarmed when the GPRS‑CSI is withdrawn in the
HLR. Only TDP‑Rs can be disarmed using this mechanism.
\- If the GPRS Session is released, then all EDPs related to the GPRS Session
are disarmed.
\- If a PDP context is released, then all non-generically armed EDPs related
to that PDP context are disarmed.
\- If a non-generically armed EDP is met, then EDPs for the GPRS Session or
that PDP Context are disarmed, in accordance with the implicit disarming rule
(see subclause 6.4.6).
\- Armed EDPs may be explicitly disarmed by the gsmSCF by means of the Request
Report BCSM Event information flow.
### 6.2.2 Relationship, DP processing rules and GPRS dialogue
A relationship between the State Models (in the gprsSSF) and the gsmSCF for
the purpose of operator specific service processing is considered to be a
CAMEL relationship. There are two types of CAMEL relationships: monitor
relationship and control relationship.
\- A CAMEL control relationship: the gsmSCF is able to influence the GPRS
Session/PDP Context via the relationship for the given state model.
\- A CAMEL monitor relationship: the gsmSCF is not able to influence the GPRS
Session/PDP Context via the relationship for the given state model.
A control relationship persists as long as there is one or more EDP‑R armed
for this instance of the state model, or if the gprsSSF is in the state
Waiting For Instruction for this instance of state model.
A control relationship changes to a monitor relationship if the conditions for
a control relationship are no longer fulfilled and one or more EDP‑N is armed
or one or more Apply Charging Report GPRS is outstanding for this instance of
the state model. If no EDP‑Ns are armed and no Apply Charging Reports GPRS are
outstanding for this instance of the state model, the relationship terminates.
A GPRS dialogue exists between gprsSSF and gsmSCF if at least one of the
following conditions is fulfilled:
\- There is at least one EDP armed,
\- At least one report is pending,
\- gprsSSF is in state Waiting_For_Instructions.
## 6.3 Description of CAMEL Subscriber Data
### 6.3.1 GPRS CAMEL Subscription Information (GPRS‑CSI)
This subclause defines the contents of the GPRS CAMEL Subscription
Information.
#### 6.3.1.1 gsmSCF Address
Address to be used to access the gsmSCF for a particular subscriber. The
address shall be an E.164 number to be used for routeing.
#### 6.3.1.2 Service Key
The Service Key identifies to the gsmSCF the service logic that shall apply.
#### 6.3.1.3 Default GPRS Handling
The Default GPRS Handling indicates whether the GPRS session or PDP context
shall be released or continued as requested in case of error in the gprsSSF to
gsmSCF dialogue.
#### 6.3.1.4 TDP List
The TDP List indicates on which detection point triggering shall take place.
#### 6.3.1.5 CAMEL Capability Handling
CAMEL Capability Handling indicates the phase of CAMEL which is asked by the
gsmSCF for the service.
#### 6.3.1.6 CSI state
The CSI state indicates whether the GPRS‑CSI is active or not.
#### 6.3.1.7 Notification flag
The notification flag indicates whether the change of the GPRS‑CSI shall
trigger Notification on Change of Subscriber Data or not.
### 6.3.2 gsmSCF address list for CSI
The gsmSCF address list contains a list of gsmSCF addresses to which
Notification on Change of Subscriber Data is to be sent. This list is common
to all CSI.
## 6.4 Description of CAMEL State Models
GPRS can support multiple PDP contexts simultaneously for an attached
subscriber, requiring the behaviour of a GPRS session to be modelled by two
state models, one for the attach/detach procedures (GPRS Attach/Detach State
Model) and the other for modelling individual PDP Contexts (GPRS PDP Context
State Model).
### 6.4.1 General Handling
The GPRS State Model is used to describe the actions in an SGSN during
processing of a GPRS session or PDP Contexts.
The GPRS State Model identifies the points in basic GPRS processing when
Operator Specific Service (OSS) logic instances (accessed through the gsmSCF)
are permitted to interact with basic GPRS control capabilities.
Figure 6.2shows the components that have been identified to describe a GPRS
State Model.
{width="1.3743055555555554in" height="1.5965277777777778in"}
Figure 6.2: GPRS State Model Components
### 6.4.2 GPRS Attach/Detach State Model
The GPRS Attach/Detach State Model is used to model the behaviour of the GPRS
attach/detach procedures.
When encountering a DP the Attach/Detach State Model processing is suspended
at the DP and the SGSN indicates this to the gprsSSF which determines what
action, if any, shall be taken in case the DP is armed.
{width="4.834027777777778in" height="3.236111111111111in"}
Figure 6.3: GPRS Attach/Detach State Model
Table 6.1: Description of GPRS Attach/Detach DPs in the SGSN
+------------------------+------------------+------------------------+ | CAMEL Detection Point | DP Type | Description | +------------------------+------------------+------------------------+ | DP Attach | TDP‑R | A request to attach is | | | | received. | +------------------------+------------------+------------------------+ | DP Change of Position | TDP‑R^1)^, EDP‑N | Routeing Area Update | | GPRS Session | | is accepted. | +------------------------+------------------+------------------------+ | DP Detach | EDP‑N, EDP‑R | A detach request is | | | | received either from | | | | the MS, the SGSN or a | | | | \'Cancel Location\' | | | | received from HLR or | | | | Inter SGSN Routeing | | | | update occurred in the | | | | old SGSN. | +------------------------+------------------+------------------------+ | Note 1: Change of | | | | Position GPRS Session | | | | is reported as TDP‑R | | | | in the case of | | | | Inter‑SGSN Routeing | | | | Area Update (provided | | | | that this DP is | | | | statically armed in | | | | GPRS‑CSI). | | | | | | | | Change of Position | | | | GPRS Session is | | | | reported as EDP‑N in | | | | the case of Intra‑SGSN | | | | Routeing Area Update | | | | (provided that this DP | | | | is dynamically armed | | | | by the Service Logic). | | | +------------------------+------------------+------------------------+
#### 6.4.2.1 Description of the Attach/Detach model (PIAs)
This subclause describes the model for the attach and detach a GPRS session in
the SGSN. For each PIA a description can be found of the entry events, actions
and exit events.
##### 6.4.2.1.1 Detached
Entry events:
\- Detach (user or network initiated) and clearing of a previous GPRS session.
\- Processing of exceptional conditions.
Actions:
\- Interface is idled.
\- Attach request is received from MS containing the IMSI/P-TMSI and the type
of attach requested and, the identity of the MS is established (IMSI) (DP
Attach), or Inter-SGSN Routeing Area Update Request is accepted (DP Change of
Position GPRS Session).
\- Information being analyzed, e.g. GPRS‑CSI is analyzed.
Exit events:
\- GPRS‑CSI is analyzed (DP Attach or DP Change of Position GPRS Session).
##### 6.4.2.1.2 Attached
Entry events:
\- GPRS‑CSI is analyzed (DP Attach).
Actions:
\- MM contexts are established at the MS and the SGSN.
Exit events:
\- A GPRS Detach request is received from the MS or from the network (DP
Detach).
\- Intra-SGSN Routeing Area Update is accepted (DP Change of Position GPRS
Session).
\- An exception is encountered.
The GPRS Attach/Detach State Model shall only have one or more GPRS PDP
Context State Models associated with it when in the Attached state. A GPRS PDP
Context State Model cannot exist without its associated GPRS Attach/Detach
State Model being in the Attached state. Closure of the GPRS Attach/Detach
State Model via a detach will result in the idling of all associated GPRS PDP
Context State Models and the release of the associated GPRS PDP Contexts.
It shall not be necessary to trigger a relationship from the GPRS
Attach/Detach State Model to the gsmSCF in order for triggering to occur in an
associated GPRS PDP Context State Model. However, in this latter case a GPRS
Attach/Detach State Model shall still exist at the SGSN. This is so that CSE-
initiated detach events sent within a given GPRS PDP Context relationship
shall result in the GPRS Attach/Detach State Model transiting to the Detached
state. As noted above, in this state no PDP Contexts can exist and so all
associated GPRS PDP Context State Models will transit to state Idle.
### 6.4.3 GPRS PDP Context State Model
The GPRS PDP Context State Model is used to model the behaviour for the GPRS
PDP Context procedures. There is one PDP Context State Model per GPRS PDP
context.
When encountering a DP the PDP Context State Model processing is suspended at
the DP and the SGSN indicates this to the gprsSSF which determines what
action, if any, shall be taken in case the DP is armed.
{width="4.80625in" height="4.723611111111111in"}
Figure 6.4: GPRS PDP Context State Model
Table 6.2: Description of GPRS PDP Context DPs in the SGSN
+----------------------+----------------------+----------------------+ | CAMEL Detection | DP Type | Description | | Point | | | +----------------------+----------------------+----------------------+ | DP PDP Context | TDP‑R^1)^, EDP‑R, | Activate PDP Context | | Establishment | EDP‑N | request is received | | | | from the MS. | +----------------------+----------------------+----------------------+ | DP PDP Context | TDP‑R^2)^, EDP‑R, | Create PDP Context | | Establishment | EDP‑N | response is received | | Acknowledgement | | from the GGSN. | +----------------------+----------------------+----------------------+ | DP PDP Context | EDP‑N, EDP‑R | Deactivate PDP | | Disconnection | | Context Request is | | | | received from the | | | | MS, Delete PDP | | | | Context request is | | | | received from the | | | | GGSN. Inter SGSN | | | | Routeing update | | | | occurred in old | | | | SGSN. | +----------------------+----------------------+----------------------+ | DP Change of | TDP‑R^3)^, EDP‑N, | Routeing Area Update | | Position Context | EDP‑R | is accepted. | +----------------------+----------------------+----------------------+ | NOTE 1: The PDP | | | | Context | | | | Establishment shall | | | | be reported as TDP‑R | | | | (provided that this | | | | DP is statically | | | | armed in GPRS‑CSI) | | | | if there is no | | | | relationship with | | | | the gsmSCF. If there | | | | is a relationship | | | | with the gsmSCF it | | | | shall be reported as | | | | EDP‑R or EDP‑N if | | | | armed so. | | | | | | | | NOTE 2: The PDP | | | | Context | | | | Establishment | | | | Acknowledgement | | | | shall be reported as | | | | TDP‑R (provided that | | | | this DP is | | | | statically armed in | | | | GPRS‑CSI) if there | | | | is no relationship | | | | with gsmSCF. If | | | | there is a | | | | relationship with | | | | the gsmSCF, it shall | | | | be reported as EDP‑R | | | | or EDP‑N if armed | | | | so. | | | | | | | | NOTE 3: Change of | | | | Position Context is | | | | reported as TDP-R in | | | | the case of | | | | Inter-SGSN Routeing | | | | Area Update | | | | (provided that this | | | | DP is statically | | | | armed in GPRS‑CSI) | | | | if there is no | | | | relationship with | | | | the gsmSCF. | | | | | | | | Change of Position | | | | Context is reported | | | | as EDP‑N or EDP‑R in | | | | the case of | | | | Inter-SGSN Routeing | | | | Area Update | | | | (provided that this | | | | DP is armed as | | | | generic EDP) if | | | | there is a | | | | relationship with | | | | the gsmSCF. | | | | | | | | Change of Position | | | | Context is reported | | | | as EDP‑N in the case | | | | of Intra-SGSN | | | | Routeing Area Update | | | | (provided that this | | | | DP is dynamically | | | | armed by the Service | | | | Logic). | | | +----------------------+----------------------+----------------------+
#### 6.4.3.1 Description of the PDP Context model (PIAs)
This subclause describes the model for PDP Context State Model in the SGSN.
For each PIA a description can be found of the entry events, actions and exit
events.
##### 6.4.3.1.1 Idle
Entry events:
\- Deactivation (user or network initiated) and clearing of a previous PDP
Context.
\- Processing of exceptional conditions.
Actions:
\- Interface is idled.
\- Activate PDP Context request is received from MS (containing NSAPI, PDP
Type, PDP Address, Access Point Name, QoS Requested, PDP Configuration
Options), or Inter-SGSN Routeing Area Update is accepted (DP Change of
Position Context).
\- Information being analyzed, e.g. GPRS‑CSI is analyzed.
Exit events:
\- GPRS‑CSI is analyzed (DP PDP Context Establishment or DP Change of Position
Context, new SGSN).
##### 6.4.3.1.2 PDP Context Setup
Entry events:
\- GPRS‑CSI is analyzed (DP PDP Context Establishment).
Actions:
\- APN and GGSN selection procedure is performed for a primary PDP context as
specified in Annex A of 3GPP TS 23.060 [15]. APN and GGSN selection procedure
is not performed for a secondary PDP context.
\- Access Point Name is verified against the subscription. If the gsmSCF has
provided an Access Point Name then the Access Point Name provided by the
gsmSCF is checked against the subscription. For details refer to 3GPP TS
23.060 [15] Annex A.
\- The operator determined barring category \"Barring of all Packet Oriented
Services \" is checked and invoked if necessary.
\- The operator determined barring category \"Barring of Packet Oriented
Services from access points that are within the HPLMN whilst the subscriber is
roaming in a VPLMN\" is checked and invoked if necessary.
\- The operator determined barring category \"Barring of Packet Oriented
Services from access points that are within the roamed to VPLMN\" is checked
and invoked if necessary.
\- The SGSN ensures that an already active PDP context is not reactivated.
\- GGSN address is derived from the Access Point Name by interrogation of a
DNS. The Access Point Name consists of a Network Identifier and an Operator
Identifier.
\- Create PDP Context Request is sent to the GGSN.
Exit events:
\- Create PDP Context Response is received from the GGSN (DP PDP Context
Establishment Acknowledgement).
\- An exception is encountered.
##### 6.4.3.1.3 PDP Context Established
Entry events:
\- GPRS‑CSI is analyzed (DP PDP Context Establishment Acknowledgement or DP
Change of Position Context).
Actions:
\- PDP context is established at the MS and the SGSN.
Exit events:
\- Deactivation of the PDP Context is received from the MS or the GGSN, or is
due to an inter SGSN routing area update (DP PDP Context Disconnection, old
SGSN).
\- Intra-SGSN Routeing Area Update Request is received from the MS (DP Change
of Position Context).
\- Inter-SGSN Routeing Area Update (DP Change of Position Context, new SGSN).
\- An exception is encountered.
##### 6.4.3.1.4 Change of Position Context
Entry events:
\- Inter SGSN Routing Area update accepted (new SGSN).
\- Intra SGSN Routeing Area update request received from the MS.
Actions:
\- PDP Context (containing NSAPI, PDP Type, PDP Address, Access Point Name,
QoS Requested, PDP Configuration Options) is reestablished in case of Inter-
SGSN Routeing Area update accepted (new SGSN).
\- Intra SGSN Routeing Area updated.
Exit events:
\- reestablishement of the PDP context at the new SGSN and return to PDP
context established in case of inter SGSN Routeing Area update accepted in new
SGSN (PIA PDP context established).
\- Routeing Area update completed in case of intra SGSN Routeing Area update
(PIA PDP context established).
### 6.4.4 GPRS CAMEL Scenarios
Two different scenarios are applicable for CAMEL control of GPRS.
**Scenario 1** :\ Scenario 1 allows CAMEL control of the GPRS session and of
multiple PDP contexts related to this session within a single GPRS dialogue.
**Scenario 2** :\ Scenario 2 allows CAMEL control of single PDP contexts.
Multiple PDP contexts are controlled in this scenario via multiple GPRS
dialogues.
Scenario 1 and scenario 2 are mutually exclusive, i.e. it is not possible to
use both for one GPRS session at the same time in one SGSN. A GPRS session is
involved in GPRS CAMEL at one moment in time either by using scenario 1 or by
using possible multiple instances of scenario 2. GPRS sessions in different
SGSNs are independent from a CAMEL perspective.
#### 6.4.4.1 GPRS CAMEL Scenario 1
Scenario 1 allows CAMEL control of the GPRS session and of multiple PDP
contexts related to this session within a single GPRS dialogue (Session
dialogue).
{width="5.597916666666666in" height="2.3041666666666667in"}
Figure 6.5: GPRS CAMEL Scenario 1
A GPRS dialogue in scenario 1 always consists of one GPRS Attach/Detach State
Model and optionally of additional multiple GPRS PDP Context State Models
related to the Attach/Detach State Model for the GPRS session. There is at
most one GPRS Attach/Detach State Model per non idle GPRS session in one SGSN
and at most one PDP Context State Model per active GPRS PDP context in one
SGSN. The various PDP Context State Models are treated independently of each
other.
The GPRS dialogue and the relationship between the GPRS Attach/Detach State
Model and the gsmSCF are always initiated using the TDPs of the GPRS
Attach/Detach State Model.
The gsmSCf requests further control or monitoring of individual GPRS PDP
contexts using the Request Report GPRS Event information flow. To be informed
about new individual PDP contexts the gsmSCF arms the DP \'PDP Context
Establishment\' or the DP \'PDP Context Establishment Acknowledgement\'
generically, i.e. without a PDP ID, as an EDP. To be informed about the handed
over PDP contexts the gsmSCF arms the DP \'Change of Position Context\'
generically as an EDP‑N or EDP‑R.
Each GPRS PDP context is identified by a PDP ID. The PDP ID is assigned by the
SGSN during PDP context establishment. The PDP ID is unique within one GPRS
dialogue. The Request Report GPRS Event information flows to control new or
handed over PDP contexts do not include a PDP ID. There is no \'PDP ID\'
related to the GPRS Attach/Detach State Model.
The PDP Id is reported to the gsmSCF in the first event notification for that
PDP context.
#### 6.4.4.2 GPRS CAMEL Scenario 2
Scenario 2 allows CAMEL control of single PDP contexts. Multiple PDP contexts
are controlled in this scenario via multiple GPRS dialogues (PDP Context
dialogues).
{width="5.406944444444444in" height="2.3020833333333335in"}
Figure 6.6: GPRS CAMEL Scenario 2
A GPRS dialogue in scenario 2 consists of a single GPRS PDP Context State
Model. There is no GPRS Attach/Detach State Model involved in this scenario.
There is at most one PDP Context State Model per active GPRS PDP context in
one SGSN.
There might be multiple GPRS dialogues in scenarios 2 for one GPRS session,
each of the dialogues controlling a single GPRS PDP context. The various GPRS
dialogues are independent of each other.
The GPRS dialogue and the relationship between the GPRS PDP Context State
Model and the gsmSCF are always initiated using the TDPs for the GPRS PDP
Context State Model.
Control of further individual GPRS PDP contexts in the same GPRS dialogue as
in scenario 1 is not possible. There are no PDP IDs in this scenario.
### 6.4.5 SGSN Routeing Area Update
#### 6.4.5.1 Intra-SGSN Routeing Area Update
Intra-SGSN Routeing Area Update will be detected via the DP \'Change of
Position GPRS Session\' for the session using the GPRS Attach/Detach State
Model and via the DPs \'Change of Position Context\' for the individual PDP
contexts using the GPRS PDP Context State Models.
It will be reported via an EDP‑N if the necessary EDP‑N is armed.
#### 6.4.5.2 Inter-SGSN Routeing Area Update
Inter-SGSN Routeing Area Update from the old SGSN to the new SGSN will be
detected via the DP \'Change of Position GPRS Session\' for the session using
the GPRS Attach/Detach State Model and via the DPs \'Change of Position
Context\' using the GPRS PDP Context State Models for the individual PDP
contexts which have been handed over.
Scenario 1:
Inter-SGSN Routeing Area Update from the old SGSN to the new SGSN will be
detected in the new SGSN via the DP \'Change of Position GPRS Session\' for
the session using the GPRS Attach/Detach State Model and in the new SGSN via
the DPs \'Change of Position Context\' using the GPRS PDP Context State Models
for the individual PDP contexts which have been handed over.
In this scenario the DP \'Change of Position GPRS Session\' is armed as a
TDP‑R. If the Routeing Area Update is accepted the gprsSSF reports this TDP‑R
to the gsmSCF using the Initial DP GPRS information flow. To be informed about
new PDP contexts the gsmSCF arms the DP \'PDP Context Establishment\' or the
DP \'PDP Context Establishment Acknowledgement\' generically as EDP‑R or
EDP‑N. The DPs \'Change of Position Context\' for the PDP contexts which have
been handed over will be reported with all necessary information to the gsmSCF
when the gprsSSF is continued, i.e. it is not longer waiting for instructions.
Contexts which are not continued in the new SGSN are not reported. The EDPs
for new PDP contexts are reported as usual.
The Detach in the old SGSN is reported to the gsmSCF, provided this event is
armed. All outstanding reports in the old SGSN are sent to the gsmSCF and all
open CDRs are closed.
Scenario 2:
Inter-SGSN Routeing Area Update from the old SGSN to the new SGSN will be
detected in the new SGSN via the DPs \'Change of Position Context\' using the
GPRS PDP Context State Models for the individual PDP contexts which have been
handed over.
In this scenario the DP \'Change of Position Context\' is armed as TDP‑R. If
the Routeing Area Update is accepted the gprsSSF reports these TDP‑Rs PDP
contexts which have been handed over to the gsmSCF using the Initial DP GPRS
information flows in multiple GPRS dialogues.
The PDP Context Disconnection in the old SGSN is reported to the gsmSCF,
provided this event is armed. All outstanding reports in the old SGSN are sent
to the gsmSCF and the open CDR is closed.
### 6.4.6 Rules for Implicit Disarming of Detection Points
The two tables below give the rules for implicit disarming of event detection
points.
Implicit EDP disarming rules are specified for the Attach/Detach State Model
and PDP Context State Model. The tables specify which EDP\'s shall be disarmed
(i.e. MonitorMode set to Transparent) if/when each EDP is encountered,
irrespective of the EDP\'s MonitorMode (Transparent, NotifyAndContinue, or
Request).
EDPs which are armed generically for GPRS PDP Context State Models shall only
be implicitly disarmed at the end of the GPRS dialogue. Explicit disarming is
possible.
When EDP\'s are armed with MonitorMode \'Request\' (EDP‑Rs) are encountered,
any implicit EDP disarming shall take place before reporting the EDP and
transiting the gprsSSF to the WFI state (if not already suspended in the WFI
state).
The table entry \'X\' means that if one DP occurs (independently of arming and
reporting to the gsmSCF) the marked one is implicitly disarmed. It shall be
possible to rearm explicitly an implicitly disarmed DP.
Table 6.3: Implicit disarming rules for Scenario 1 (the rules apply for non-
generically armed DPs)
* * *
Encountered DP Implicit disarmed DPs  
Change of Position GPRS Session Change of Position Context Detach PDP Context
Establishment PDP Context Establishment Acknowledgement PDP Context
Disconnection Change of Position GPRS Session  
Change of Position Context  
Detach X X X X X X PDP Context Establishment  
PDP Context Establishment Acknowledgement X  
PDP Context Disconnection X X X
* * *
Table 6.4: Implicit disarming rules for Scenario 2 (the rules apply for non-
generically armed DPs)
* * *
Encountered DP Implicit disarmed DPs  
Change of Position Context PDP Context Establishment Acknowledgement PDP
Context Disconnection PDP Context Establishment Acknowledgement X  
PDP Context Disconnection X X X Change of Position Context
* * *
## 6.5 Procedures for CAMEL GPRS
### 6.5.1 Overall SDL Architecture
{width="5.999305555555556in" height="3.5701388888888888in"}
Figure 6.7: Architecture for CAMEL/GPRS interworking
### 6.5.2 Handling GPRS in the SGSN
The functional behaviour of the SGSN is specified in 3GPP TS 23.060 [15]. The
procedures specific to CAMEL are specified in this subclause:
\- Procedure CAMEL_GPRS_Attach;
\- Procedure CAMEL_GPRS_Detach;
\- Procedure CAMEL_GPRS_Routeing_Area_Update_Session;
\- Procedure CAMEL_GPRS_Routeing_Area_Update_Context;
\- Procedure CAMEL_GPRS_PDP_Context_Establishment;
\- Procedure CAMEL_GPRS_Create_PDP_Context_Establishment_Acknowledgement;
\- Procedure CAMEL_GPRS_Change_Of_QoS;
\- Procedure CAMEL_GPRS_PDP_Context_Disconnection.
#### 6.5.2.1 Actions of the SGSN on receipt of Int_Error
The SGSN checks the default GPRS Handling parameter in GPRS‑CSI.
If the default GPRS handling is release, a Detach indication is sent to the
MS. The SGSN then releases all resources and the invoked CAMEL procedure ends.
If the default GPRS handling is continue, the SGSN continues processing
without CAMEL support.
#### 6.5.2.2 Actions of the SGSN on receipt of Int_Continue
The SGSN continues processing without any modification of GPRS parameters.
#### 6.5.2.3 Handling of GPRS Attach/Detach
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.8-1: Procedure CAMEL_GPRS_Attach (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.8-2: Procedure CAMEL_GPRS_Attach (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.9-1: Procedure CAMEL_GPRS_Detach (sheet 1)
#### 6.5.2.4 Handling of GPRS Routeing Area Update
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.10-1: Procedure CAMEL_GPRS_Routeing_Area_Update_Session (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.10-2: Procedure CAMEL_GPRS_Routeing_Area_Update_Session (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.11-1: Procedure CAMEL_GPRS_Routeing_Area_Update_Context (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.11-2: Procedure CAMEL_GPRS_Routeing_Area_Update_Context (sheet 2)
#### 6.5.2.5 Handling of PDP Context establishment and deactivation
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.12-1: Procedure CAMEL_GPRS_PDP_Context_Establishment (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.12-2: Procedure CAMEL_GPRS_PDP_Context_Establishment (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.13-1: Procedure CAMEL_GPRS_PDP_Context_Establishment_Acknowledgement
(sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.13-2: Procedure CAMEL_GPRS_PDP_Context_Establishment_Acknowledgement
(sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.14-1: Procedure CAMEL_GPRS_Change_Of_QoS (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.15-1: Procedure CAMEL_GPRS_PDP_Context_Disconnection (sheet 1)
### 6.5.3 Handling GPRS in the gprsSSF
#### 6.5.3.1 Process GPRS_SSF
A relationship exists between the gsmSCF and the Attach/Detach State Model
and/or between the gsmSCF and every PDP Context State Model. The relationship
may be in controlling or monitoring mode. When a Continue GPRS, Connect GPRS
or Request Report GPRS Event information flow is received, then the
relationship between the gsmSCF and the Attach/Detach State Model, and between
the gsmSCF and a PDP Context State Model may be downgraded from controlling to
monitoring.
When Tssf expires, the CAMEL procedures that are waiting for an instruction
from the gsmSCF shall receive an Int_Error signal. The Default GPRS Handling
parameter determines the subsequent action of those CAMEL procedures.
If the Default GPRS Handling parameter is set to \'Release\', then:
\- if the GPRS Dialogue is controlling a GPRS Session, then the gprsSSF shall
release the entire GPRS Session;
\- if the GPRS Dialogue is controlling a single PDP Context, then the gprsSSF
shall release the PDP Context.
The task box \'Open GPRS Dialogue\' comprises all the tasks that are required
for starting a GPRS dialogue. This includes, amongst others, the allocation of
a GPRS Reference Number and the allocation of resources. The task box
\'Terminate GPRS Dialogue\' comprises all the tasks that are required for
closing a GPRS dialogue.
#### 6.5.3.2 Process GPRS_Dialogue_Handler
When process gprsSSF sends a TC_End request primitive to process
GPRS_Dialogue_Handler, then the corresponding TC_End TC Message shall be sent
to the gsmSCF only when the following conditions have been fulfilled:
\- The gprsSSF has processed all information flows that the gprsSSF has
received from the gsmSCF.
\- No information flows remain to be sent from the gprsSSF to the gsmSCF.
\- The gprsSSF is not waiting for a Result or Error component for any
information flows that the gprsSSF has sent to the gsmSCF.
#### 6.5.3.3 Procedure Handle_AC_GPRS
Procedure Handle_AC_GPRS is called from process gprsSSF with the following
input parameters:
\- \'Session\'. The Apply Charging GPRS procedure shall be executed for the
Session
\- \'PDP Id\'. The Apply Charging GPRS procedure shall be executed for the
indicated PDP Context.
Sheet 3 in procedure Handle_AC_GPRS contains a check for the PDP Context
duration (Tcp(PDP Id)) and PDP Context volume (Vc(PDP Id)). If the PDP Context
delta timer (Dcp(PDP Id)) is equal to or larger than the duration threshold
received in the Apply Charging GPRS operation or the PDP Context delta counter
(Dc(PDP Id)) is equal to or larger than the volume threshold received in the
Apply Charging GPRS operation, then the gprsSSF shall generate an internal
signal to trigger the sending of an Apply Charging Report GPRS.
If a QoS change has occurred prior to receiving Apply Charging GPRS but after
the sending Apply Charging Report GPRS, then the gprsSSF shall generate an
internal signal to trigger the sending of an Apply Charging Report GPRS,
including the negotiated QoS.
#### 6.5.3.4 Procedure Handle_ACR_GPRS
Procedure Handle_ACR_GPRS is called from process gprsSSF with the following
input parameters:
\- \'Session\'. The Apply Charging Report GPRS procedure shall be executed for
the Session. This procedure checks if a Session Period report is pending and
if so, sends this report to the gsmSCF.
\- \'PDP Id\'. The Apply Charging Report GPRS procedure shall be executed for
the indicated PDP Context. This procedure checks if a Context Volume report is
pending and if so, sends this report to the gsmSCF. The procedure then checks
if a Context Period is pending and if so, sends this report to the gsmSCF.
\- \'Session + PDPs\'. The Apply Charging Report GPRS procedure shall be
executed for the Session and all PDP Contexts. The sequence of checking the
reports shall be as follows:
1) The procedure checks the pending Volume and Period reports for each PDP
Context.
2) The procedure then checks the pending Period report for the Session.
When a PDP Context Volume counter or PDP context Period timer expires or an
Apply Charging GPRS is received when QoS change report is pending, then the
procedure Apply Charging Report GPRS procedure is called with the PDP Id as
input parameter. The procedure will then check both reports for that PDP
Context.
#### 6.5.3.5 Procedure Complete_FCI_Record_GPRS
Procedure Complete_FCI_Record_GPRS is called from process gprsSSF with the
following input parameters:
\- \'Session\'. The Complete_FCI_Record_GPRS procedure shall be executed for
the Session.
\- \'PDP Id\'. The Complete_FCI_Record_GPRS procedure shall be executed for
the indicated PDP Context.
\- \'Session + PDPs\'. The Complete_FCI_Record_GPRS procedure shall be
executed for the Session and all PDP Contexts.
#### 6.5.3.6 Procedure Handle_SCI_GPRS
For terminology see subclause 4.5.7.2.1.
The gsmSCF may send e‑parameters to the Session and to individual PDP
Contexts.
When e‑parameters are sent for the Session, the SGSN will forward these
e‑parameters directly to the Mobile Station.
When e‑parameters are sent for a PDP Context and that PDP Context is not yet
acknowledged (= active), then the SGSN shall retain these parameters (pending
parameters). These parameters will be sent to the Mobile Station when the PDP
Context is acknowledged.
The gsmSCF may send two sets of e‑parameters and a Tariff Switch for the
Session or a PDP Context. The first set of e‑parameters shall be sent to the
SGSN and the second set of e‑parameters shall be stored. This second set of
e‑parameters shall be sent to the SGSN when the tariff switch expires.
When the Tariff Switch for the Session expires, then the stored e‑parameters
for the Session shall be sent to the SGSN.
When the Tariff Switch for a PDP Context expires before that PDP Context is
acknowledged, then the pending e‑parameters for that PDP Context shall be
replaced by the stored e‑parameters for that PDP Context.
The stored e‑parameters for that PDP Context shall be discarded.
When the Tariff Switch for a PDP Context expires after that PDP Context has
been acknowledged, then the stored e‑parameters for that PDP Context shall be
sent to the SGSN.
##### 6.5.3.6.1 Handling of SCI_GPRS for the Session
1) Precondition: no Tsw running for the Session:
if 1 set of e‑parameters received --> send e‑parameters to the SGSN;
if 2 sets of e‑parameters received --> error;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> send 1^st^ set of
e‑parameters to the SGSN/start Tsw (Session)/store 2^nd^ set of e‑parameters.
2) Precondition: Tsw running for the Session and no e‑parameters stored for
the Session:
if 1 set of e‑parameters received --> error;
if 2 sets of e‑parameters received --> send 1^st^ set of e‑parameters to the
SGSN/store 2^nd^ set of e‑parameters;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> error.
3) Precondition: Tsw running for the Session and e‑parameters stored for the
Session:
if 1 set of e‑parameters received --> error;
if 2 sets of e‑parameters received --> error;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> error.
##### 6.5.3.6.2 Handling of SCI_GPRS for a PDP Context
1) Precondition: before a PDP Context Establishment Acknowledgement event is
detected and no Tsw running for this PDP Context:
if 1 set of e‑parameters received --> send e‑parameters to the SGSN;
if 2 sets of e‑parameters received --> error;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> send 1^st^ set of
e‑parameters to the SGSN/start Tsw(PDP Id)/store 2^nd^ set of e‑parameters;
2) Precondition: before a PDP Context Establishment Acknowledgement event is
detected and Tsw running for this PDP Context and no e‑parameters stored for
this PDP Context:
if 1 set of e‑parameters received --> error;
if 2 sets of e‑parameters received --> send 1st set of e‑parameters to the
SGSN/store 2^nd^ set of e‑parameters;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> error.
3) Precondition: before a PDP Context Establishment Acknowledgement event is
detected and Tsw running for this PDP Context and e‑parameters stored for this
PDP Context:
if 1 set of e‑parameters received --> error;
if 2 sets of e‑parameters received --> error;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> error.
4) Precondition: after a PDP Context Establishment Acknowledgement event is
detected and no Tsw running for this PDP Context:
if 1 set of e‑parameters received --> send e‑parameters to the SGSN;
if 2 sets of e‑parameters received --> error;
if 1 set of e‑parameters and Tariff Switch received --> start Tsw(PDP
Id)/store e‑parameters;
if 2 sets of e‑parameters and Tariff Switch received --> send 1^st^ set of
e‑parameters to the SGSN/start Tsw(PDP Id)/store 2^nd^ set of e‑parameters.
5) Precondition: after a PDP Context Establishment Acknowledgement event is
detected and Tsw running for this PDP Context and no e‑parameters stored for
this PDP Context;
if 1 set of e‑parameters received --> store e‑parameters;
if 2 sets of e‑parameters received --> send 1^st^ set of e‑parameters to the
SGSN/store 2^nd^ set of e‑parameters;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> error.
6) Precondition: after a PDP Context Establishment Acknowledgement event is
detected and Tsw running for this PDP Context and e‑parameters stored for this
PDP Context:
if 1 set of e‑parameters received --> error;
if 2 sets of e‑parameters received --> error;
if 1 set of e‑parameters and Tariff Switch received --> error;
if 2 sets of e‑parameters and Tariff Switch received --> error.
#### 6.5.3.7 Procedure Handle_PDP_Acknowledgement
Procedure Handle_PDP_Acknowledgement is called when an event occurs that may
signal the activation (= Acknowledgement) of a PDP Context. The event signal
is passed on to the Handle_PDP_Acknowledgement procedure.
#### 6.5.3.8 GPRS duration and volume control
##### 6.5.3.8.1 Examples of information flows for GPRS session and PDP context
control
{width="5.93125in" height="3.8618055555555557in"}
Figure 6.16-1: Example of information flows for GPRS session duration at GPRS
attach and change of position session
{width="5.93125in" height="3.8618055555555557in"}
Figure 6.16-2: Example of information flows for PDP context duration control
at context activation and change of position context
{width="5.93125in" height="3.8618055555555557in"}
Figure 6.16-3: Example of information flows for PDP context volume control at
context activation and change of position context
{width="6.0in" height="4.472916666666666in"}
Note1: Vc threshold reached, Tcp is stopped.
Note2: Tcp time out, Vc is stopped.
Figure 6.16-4: Example of information flows for PDP context volume and
duration control at context activation and change of position context
These figures 6.16-1 to 6.16-4show examples of handling of the timers that are
used in the process gprsSSF and in the procedures Handle_AC_GPRS and
Handle_ACR_GPRS.
Duration timers (Tsp for the GPRS session and one Tcp for each PDP context)
are used if the charging is on duration of the GPRS session or a PDP context.
Tariff Switch Timers (Tsw(Session) for the GPRS session and one Tsw(PDP Id)
for each PDP context) define the start point of a new Tariff. Tsw(Session) is
used for charging on duration. Tsw(PDP Id) is used for both methods of
charging: duration charging and volume charging. If a PDP context is charged
on duration and volume, only one Tsw(PDP Id) timer will be accepted from the
gsmSCF for that PDP context.
Delta timers measure the response time of the gsmSCF after an Apply Charging
Report GPRS information flow:
\- Dsp for the GPRS session; this delta timer is used for GPRS session period
timing.
\- Dcp for each PDP context; these delta timers are used for PDP context
period timing.
\- Dc for each PDP context; these delta counters are used for PDP context
volume counting.
After the sending of Apply Charging Report GPRS, the gsmSCF may reply either
with:
\- Apply Charging GPRS, if the gsmSCF sends a new duration because of the
expiration of the previous period or because of QOS change.
\- Release GPRS, if the gsmSCF decides to release the GPRS session or PDP
context.
For a more detailed example of the handling of the Apply Charging GPRS and
Apply Charging Report GPRS information flows, see Annex A.
##### 6.5.3.8.2 TC guard timer
###### 6.5.3.8.2.1 General
When the gprsSSF sends an Apply Charging Report GPRS information flow to the
gsmSCF, with SessionActive or ContextActive variable set to TRUE, then the
gprsSSF shall start the TC guard timer. The gprsSSF shall also mark for the
Session or PDP Context for which the Apply Charging Report GPRS was sent, that
a corresponding Apply Charging GPRS information flow from the gsmSCF is
expected.
When the gprsSSF receives an Apply Charging GPRS information flow or a Release
GPRS information flow, then the \'Waiting-for-AC\' marking(s) for the Session
or PDP Context shall be removed. The gprsSSF shall then check if the TC guard
timer shall be stopped (task box \'Check TC guard timer\'). The TC guard timer
shall be stopped if there are no more Apply Charging GPRS information flows
expected for the Session and all PDP Contexts.
When an event occurs that results in the termination of a PDP Context, then
the \'Waiting-for-AC\' markings for that PDP Context shall be removed. The
gprsSSF shall then check if the TC guard timer shall be stopped (task box
\'Check TC guard timer\'). The TC guard timer shall be stopped if there are no
more Apply Charging GPRS information flows expected for the Session and all
PDP Contexts.
When the TC guard timer expires in state Monitoring, then the gprsSSF shall
close the TC dialogue, provided that all conditions for closing the TC
dialogue are fulfilled, i.e. there are no information flow results expected
from the gsmSCF, no information flows or errors to be sent to the gsmSCF and
no information flows from the gsmSCF received and waiting to be processed.
When the TC guard timer expires in state Waiting_for_Instructions, then no
action shall be taken.
Service Designers should note that there may be additional timer(s) in the
gprsSSF to supervise the response from the gsmSCF on the Apply Charging Report
GPRS procedure. As a result of this, if the gsmSCF does not send an Apply
Charging GPRS, Release GPRS or Cancel GPRS in response to an Apply Charging
Report GPRS when the gprsSSF is awaiting such response, then service behaviour
may be unpredictable.
###### 6.5.3.8.2.2 Check TC guard timer
This clause describes the actions to be taken in the task box \'Check TC guard
timer\'.
The tasks to be executed in the \'Check TC guard timer\' box depend on the
event that resulted in execution of the task box.
###### # 6.5.3.8.2.2.1 Apply Charging GPRS
If \'Check guard timer\' is executed as a result of an Apply Charging GPRS
information flow from the gsmSCF, then the appropriate \'Waiting-for-AC\'
marker shall be removed, depending on the information received in the Apply
Charging GPRS information flow:
\- if the Apply Charging GPRS information flow carries a Session Time
threshold, then the Session-Period \'Waiting-for-AC\' marker shall be removed.
\- if the Apply Charging GPRS information flow carries a PDP Context Volume
threshold, then the PDP Context-Volume \'Waiting-for-AC\' marker shall be
removed.
\- if the Apply Charging GPRS information flow carries a PDP Context Time
threshold, then the PDP Context -Period \'Waiting-for-AC\' marker shall be
removed.
The gprsSSF then checks if there is any \'Waiting-for-AC\' marker for the
Session or any PDP Context. If there is no \'Waiting-for-AC\' marker
remaining, then the TC guard timer shall be stopped.
###### # 6.5.3.8.2.2.2 Release GPRS
If \'Check TC guard timer\' is executed as a result of a Release GPRS
information flow from the gsmSCF, then the appropriate \'Waiting-for-AC\'
markers shall be removed, depending on the information received in the Release
GPRS information flow:
\- if the Release GPRS information flow is for the Session, then the Session
\'Waiting-for-AC\' markers shall be removed.
\- if the Release GPRS information flow is for the PDP Context, then the PDP
Context \'Waiting-for-AC\' markers shall be removed.
The gprsSSF then checks if there is any \'Waiting-for-AC\' marker for the
Session or any PDP Context. If there is no \'Waiting-for-AC\' marker
remaining, then the TC guard timer shall be stopped.
###### # 6.5.3.8.2.2.3 PDP Context Disconnect
If \'Check TC guard timer\' is executed as a result of a PDP Context
Disconnect signal from the SGSN, then the \'Waiting-for-AC\' markers for that
PDP Context shall be removed.
The gprsSSF then checks if there is any \'Waiting-for-AC\' marker for the
Session or any PDP Context. If there is no \'Waiting-for-AC\' marker
remaining, then the TC guard timer shall be stopped.
#### 6.5.3.9 SDL diagrams for process GPRS_SSF and procedures
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-1: Process GPRS_SSF (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-2: Process GPRS_SSF (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-3: Process GPRS_SSF (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-4: Process GPRS_SSF (sheet 4)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-5: Process GPRS_SSF (sheet 5)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-6: Process GPRS_SSF (sheet 6)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-7: Process GPRS_SSF (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-8: Process GPRS_SSF (sheet 8)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-9: Process GPRS_SSF (sheet 9)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-10: Process GPRS_SSF (sheet 10)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-11: Process GPRS_SSF (sheet 11)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-12: Process GPRS_SSF (sheet 12)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-13: Process GPRS_SSF (sheet 13)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-14: Process GPRS_SSF (sheet 14)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-15: Process GPRS_SSF (sheet 15)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-16: Process GPRS_SSF (sheet 16)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-17: Process GPRS_SSF (sheet 17)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-18: Process GPRS_SSF (sheet 18)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-19: Process GPRS_SSF (sheet 19)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-20: Process GPRS_SSF (sheet 20)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-21: Process GPRS_SSF (sheet 21)
{width="6.690277777777778in" height="8.63125in"}
Figure 6.17-22: Process GPRS_SSF (sheet 22)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.17-23: Process GPRS_SSF (sheet 23)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.18-1: Process GPRS_Dialogue_Handler (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.18-2: Process GPRS_Dialogue_Handler (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.18-3: Process GPRS_Dialogue_Handler (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.19-1: Procedure Handle_AC_GPRS (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.19-2: Procedure Handle_AC_GPRS (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.19-3: Procedure Handle_AC_GPRS (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.20-1: Procedure Handle_ACR_GPRS (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.20-2: Procedure Handle_ACR_GPRS (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.21-1: Procedure Handle_FCI_GPRS (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.22-1: Procedure Complete_FCI_Record_GPRS (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.23-1: Procedure Handle_SCI_GPRS (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.23-2: Procedure Handle_SCI_GPRS (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.23-3: Procedure Handle_SCI_GPRS (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 6.24-1: Procedure Handle_PDP_Acknowledgement (sheet 1)
## 6.6 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for GPRS control.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Specific conditions (S) or Optional (O) in the \"Status\" column.
An \'M\' IE shall always be included. A \'C\' IE shall be included if the
sending entity has the necessary information to populate the IE. The
conditions for the inclusion of an \'S\' IE are shown in the \'Description\'
column of the definition table. An \'O\' IE may be included or omitted as
required by the service logic. This categorization is a functional
classification, i.e. it defines the requirements for the stage 2 information.
It is not a stage 3 classification to be used for the ASN.1 syntax of the
protocol.
Details of errors and exceptions to these rules are specified in 3GPP TS
29.002 [34] and TS 29.078 [36].
### 6.6.1 gprsSSF to gsmSCF Information Flows
#### 6.6.1.1 Activity Test GPRS ack
##### 6.6.1.1.1 Description
This IF is the response to the Activity Test GPRS.
##### 6.6.1.1.2 Information Elements
This IF contains no information elements.
#### 6.6.1.2 Apply Charging Report GPRS
##### 6.6.1.2.1 Description
This IF is used by the gprsSSF to report to the gsmSCF the information
requested in the Apply Charging GPRS IF. In addition, this IF is used to
notify the gsmSCF of changes in QoS. Note that there are several possible QoS
profiles defined by the combinations of the different QoS attributes as
defined in 3GPP TS 23.060 [15]. A PLMN may only support and charge on a
limited subset of those QoS. It is recommended that changes in QoS are only
reported in Apply Charging Report GPRS for those QoS profiles.
##### 6.6.1.2.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +--------------------------+--------+-----------------------------+ | Charging Result | M | This IE contains the | | | | charging information for | | | | the PDP provided by the | | | | gprsSSF. It is a choice | | | | between elapsed time and | | | | data volume. | +--------------------------+--------+-----------------------------+ | Quality Of Service | C | This IE is described in a | | | | table below. | +--------------------------+--------+-----------------------------+ | Active | M | This IE indicates if the | | | | GPRS session or PDP context | | | | is still established, or if | | | | it has been detached or | | | | deactivated. | +--------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Apply Charging Report | | | | GPRS applies to the GPRS | | | | Session. If this IE is | | | | present in the IF, then the | | | | Apply Charging Report GPRS | | | | applies to the indicated | | | | PDP Context. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+ | Charging Roll Over | C | This IE indicates which | | | | parameter(s) of the | | | | Charging Result have | | | | overflowed. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +--------------------------+--------+-----------------------------+
Quality of Service contains the following information element:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Negotiated QoS | C | This IE identifies the QoS | | | | which was negotiated | | | | between the user, the SGSN | | | | and the GGSN, as a result | | | | of a \'Modify PDP Context\' | | | | request. | | | | | | | | This IE shall be included | | | | only if sending of the | | | | Apply Charging Report GPRS | | | | was triggered by a change | | | | in Quality of Service. | | | | | | | | This IE shall contain the | | | | negotiated QoS as on the | | | | time of sending the Apply | | | | Charging Report GPRS. | +--------------------------+--------+-----------------------------+ | Negotiated QoS Extension | S | This IE contains a | | | | supplement to the | | | | Negotiated QoS. It shall be | | | | present if the Negotiated | | | | QoS IE is present and one | | | | or more of the following | | | | was negotiated between the | | | | MS, the SGSN and the GGSN: | | | | | | | | - Source Statistics | | | | Descriptor; | | | | | | | | - Signalling Indication; | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +--------------------------+--------+-----------------------------+
#### 6.6.1.3 Entity Released GPRS
##### 6.6.1.3.1 Description
This IF is used by the gprsSSF to inform the gsmSCF at any phase that a GPRS
Session has been detached or a PDP Context has been disconnected without
reporting any EDP.
##### 6.6.1.3.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +--------------------------+--------+-----------------------------+ | GPRS Cause | M | This IE contains the Cause | | | | value indicating the reason | | | | for the GPRS Session Detach | | | | event or the PDP Context | | | | Disconnection event. | +--------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Entity Released GPRS | | | | applies to the GPRS | | | | Session. If this IE is | | | | present in the IF, then the | | | | Entity Released GPRS | | | | applies to the indicated | | | | PDP Context. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
#### 6.6.1.4 Event Report GPRS
##### 6.6.1.4.1 Description
This IF is used to notify the gsmSCF of a GPRS event previously requested by
the gsmSCF in a Request Report GPRS Event IF.
##### 6.6.1.4.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +-----------------------------+--------+-----------------------------+ | GPRS Event Type | M | This IE specifies the type | | | | of event that is reported. | +-----------------------------+--------+-----------------------------+ | Misc GPRS Info | M | This IE indicates the DP | | | | type (EDP‑N or EDP‑R). | +-----------------------------+--------+-----------------------------+ | GPRS Event Specific | M | This IE is described in a | | Information | | table below. | | | | | | | | This IE contains | | | | information specific to the | | | | reported event. | +-----------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Event Report GPRS | | | | applies to the GPRS | | | | Session. If this IE is | | | | present in the IF, then the | | | | Event Report GPRS applies | | | | to the indicated PDP | | | | Context. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +-----------------------------+--------+-----------------------------+
If the _GPRS Event Type_ contains DP Change of Position GPRS Session, then the
GPRS Event Specific Information IE contains the following information
elements:
* * *
Information element name Status Description Location Information In SGSN M See
subclause 7.6.1.2.2.
* * *
If the _GPRS Event Type_ contains DP Change of Position Context, then the GPRS
Event Specific Information IE contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Access Point Name | S | This IE identifies the | | | | Access Point Name to which | | | | the MS is connected. | | | | | | | | It shall be present, if | | | | available, at inter-SGSN | | | | routing area update. | | | | | | | | It shall be absent at | | | | intra-SGSN routing area | | | | update. | +-----------------------------+--------+-----------------------------+ | Charging ID | S | This IE contains the | | | | Charging ID received from | | | | the GGSN for the PDP | | | | context. | | | | | | | | It shall be present, if | | | | available, at inter-SGSN | | | | routing area update. | | | | | | | | It shall be absent at | | | | intra-SGSN routing area | | | | update. | +-----------------------------+--------+-----------------------------+ | Location Information In | M | See subclause 7.6.1.2.2. | | SGSN | | | +-----------------------------+--------+-----------------------------+ | End User Address | S | See subclause 6.6.1.5.2. | | | | | | | | It shall be present, if | | | | available, at inter-SGSN | | | | routing area update. | | | | | | | | It shall be absent at | | | | intra-SGSN routing area | | | | update. | +-----------------------------+--------+-----------------------------+ | Quality Of Service | S | This IE is described in a | | | | table below. | | | | | | | | It shall be present, if | | | | available, at inter-SGSN | | | | routing area update. | | | | | | | | It shall be absent at | | | | intra-SGSN routing area | | | | update. | +-----------------------------+--------+-----------------------------+ | Time And Time Zone | S | This IE contains the time | | | | that the gprsSSF met the | | | | detection point, and the | | | | time zone the gprsSSF | | | | resides in. | | | | | | | | It shall be present, if | | | | available, at inter-SGSN | | | | routing area update. | | | | | | | | It shall be absent at | | | | intra-SGSN routing area | | | | update. | +-----------------------------+--------+-----------------------------+ | GGSN Address | S | This IE contains the GGSN | | | | address for control plane | | | | to which the MS is | | | | connected, see 3GPP | | | | TS 23.003 [7]. | | | | | | | | The SGSN shall report the | | | | GGSN address in the same IP | | | | version as in the S‑CDR. | | | | See 3GPP TS 32.251 [38]. | | | | | | | | It shall be present, if | | | | available, at inter-SGSN | | | | routing area update. | | | | | | | | It shall be absent at | | | | intra-SGSN routing area | | | | update. | +-----------------------------+--------+-----------------------------+
If the _GPRS Event Type_ contains DP Detach or DP PDP context disconnection,
then the GPRS Event Specific Information IE contains the following information
elements:
* * *
Information element name Status Description Initiating Entity M This IE
identifies the entity that has initiated the disconnection or detachment.
Routeing Area Update C This IE indicates that the Detach or Disconnection is
due to inter-SGSN routeing area update.
* * *
If the _GPRS Event Type_ contains DP PDP context establishment, then the GPRS
Event Specific Information IE contains the following information elements:
* * *
Information element name Status Description Access Point Name C This IE
identifies the Access Point Name the MS has requested to connect to. End User
Address C See subclause 6.6.1.5.2. Quality Of Service M This IE is described
in a table below. Location Information In SGSN M See subclause 7.6.1.2.2. Time
And Time Zone M This IE contains the time that the gprsSSF met the detection
point, and the time zone the gprsSSF resides in. PDP Initiation Type M This IE
indicates whether a PDP context was established as a result of a network-
initiated request or as a result of a subscriber request. Secondary PDP
Context C This IE indicates that the PDP context activation was requested for
a secondary PDP context. See 3GPP TS 23.060 [15].
* * *
If the _GPRS Event Type_ contains DP PDP context establishment
acknowledgement, then the GPRS Event Specific Information IE contains the
following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Access Point Name | M | This IE identifies the | | | | Access Point Name to which | | | | the MS is connected. | +-----------------------------+--------+-----------------------------+ | Charging ID | M | This IE contains the | | | | Charging ID received from | | | | the GGSN for the PDP | | | | context. | +-----------------------------+--------+-----------------------------+ | End User Address | M | See subclause 6.6.1.5.2. | +-----------------------------+--------+-----------------------------+ | Quality Of Service | M | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Location Information In | M | See subclause 7.6.1.2.2. | | SGSN | | | +-----------------------------+--------+-----------------------------+ | Time And Time Zone | M | This IE contains the time | | | | that the gprsSSF met the | | | | detection point, and the | | | | time zone the gprsSSF | | | | resides in. | +-----------------------------+--------+-----------------------------+ | GGSN Address | M | This IE contains the GGSN | | | | address for control plane | | | | to which the MS is | | | | connected, see 3GPP | | | | TS 23.003 [7]. | | | | | | | | The SGSN shall report the | | | | GGSN address in the same IP | | | | version as in the S‑CDR. | | | | See 3GPP TS 32.251 [38]. | +-----------------------------+--------+-----------------------------+
Quality of Service contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Requested QoS | C | This IE identifies the QoS | | | | requested by the subscriber | | | | for the PDP Context. It | | | | shall be included if the | | | | EventReportGPRS is sent at | | | | PDP Context Establishment, | | | | at PDP Context | | | | Establishment | | | | Acknowledgement and at | | | | Change of Position Context. | +--------------------------+--------+-----------------------------+ | Subscribed QoS | C | This IE identifies the | | | | subscribed QoS. It shall be | | | | included if the | | | | EventReportGPRS is sent at | | | | PDP Context Establishment, | | | | at PDP Context | | | | Establishment | | | | Acknowledgement and at | | | | Change of Position Context. | +--------------------------+--------+-----------------------------+ | Negotiated QoS | C | This IE identifies the QoS | | | | which was negotiated | | | | between the user, the SGSN | | | | and the GGSN. It shall be | | | | included if the | | | | EventReportGPRS is sent at | | | | PDP Context Establishment | | | | Acknowledgement and at | | | | Change of Position Context. | +--------------------------+--------+-----------------------------+ | Requested QoS Extension | S | This IE contains a | | | | supplement to the Requested | | | | QoS IE. It shall be present | | | | if the Requested QoS IE is | | | | present and the MS | | | | requested one or more of | | | | the following for the PDP | | | | context: | | | | | | | | - Source Statistics | | | | Descriptor; | | | | | | | | - Signalling Indication; | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +--------------------------+--------+-----------------------------+ | Subscribed QoS Extension | S | This IE contains a | | | | supplement to the | | | | Subscribed QoS IE. It shall | | | | be present if the Subsribed | | | | QoS IE is present and one | | | | or more of the following is | | | | part of the subscription | | | | profile in the HLR: | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +--------------------------+--------+-----------------------------+ | Negotiated QoS Extension | S | This IE contains a | | | | supplement to the | | | | Negotiated QoS. It shall be | | | | present if the Negotiated | | | | QoS IE is present and one | | | | or more of the following | | | | was negotiated between the | | | | MS, the SGSN and the GGSN: | | | | | | | | - Source Statistics | | | | Descriptor; | | | | | | | | - Signalling Indication; | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +--------------------------+--------+-----------------------------+
#### 6.6.1.5 Initial DP GPRS
##### 6.6.1.5.1 Description
This IF is generated by the gprsSSF when a trigger is detected at a DP in the
GPRS state models, to request instructions from the gsmSCF.
##### 6.6.1.5.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Gprs Reference Number | M | This IE consists of a | | | | number assigned by the | | | | gprsSSF. It is used for | | | | TCAP dialogue segmentation. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +-----------------------------+--------+-----------------------------+ | ServiceKey | M | This IE indicates to the | | | | gsmSCF the requested CAMEL | | | | Service. It is used to | | | | address the required | | | | application/SLP within the | | | | gsmSCF. | +-----------------------------+--------+-----------------------------+ | GPRS Event Type | M | This IE indicates the armed | | | | GPRS DP event resulting in | | | | the Initial DP IF. | +-----------------------------+--------+-----------------------------+ | MSISDN | M | This IE contains the basic | | | | MSISDN of the MS. | +-----------------------------+--------+-----------------------------+ | IMSI | M | This IE identifies the | | | | mobile subscriber. | +-----------------------------+--------+-----------------------------+ | Time and Time zone | M | This IE contains the time | | | | that the gprsSSF was | | | | triggered, and the time | | | | zone in which the gprsSSF | | | | resides. | +-----------------------------+--------+-----------------------------+ | GPRS MS Class | C | This IE contains the MS | | | | network and radio access | | | | capabilities. | +-----------------------------+--------+-----------------------------+ | End User Address | C | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Quality of Service | C | This IE is described in a | | | | table below. | +-----------------------------+--------+-----------------------------+ | Access Point Name | C | This IE identifies the | | | | Access Point Name: | | | | | | | | - At DP Change Of Position | | | | Context contains the | | | | selected APN. | | | | | | | | - AT DP PDP Context | | | | Establishment contains the | | | | APN which the MS has | | | | requested. | | | | | | | | - AT DP PDP Context | | | | Establishment | | | | Acknowledgement contains | | | | the selected APN. | +-----------------------------+--------+-----------------------------+ | Charging ID | C | This IE contains the | | | | Charging ID received from | | | | the GGSN for the PDP | | | | context. | +-----------------------------+--------+-----------------------------+ | SGSN Capabilities | C | This IE specifies the | | | | capabilities of the SGSN to | | | | support the CAMEL | | | | interworking, e.g. support | | | | of Advice of Charge. | +-----------------------------+--------+-----------------------------+ | Location Information in | M | This IE is described in | | SGSN | | subclause 7.6.1.2.2. | +-----------------------------+--------+-----------------------------+ | PDP Initiation Type | C | This IE indicates whether a | | | | PDP context was established | | | | as a result of a | | | | network-initiated request | | | | or as a result of a | | | | subscriber request. | +-----------------------------+--------+-----------------------------+ | GGSN Address | C | This IE contains the GGSN | | | | address for control plane | | | | to which the MS is | | | | connected, see 3GPP | | | | TS 23.003 [7]. | | | | | | | | The SGSN shall report the | | | | GGSN address in the same IP | | | | version as in the S‑CDR. | | | | See 3GPP TS 32.251 [38]. | +-----------------------------+--------+-----------------------------+ | Secondary PDP context | C | This IE indicates that the | | | | PDP context activation was | | | | requested for a secondary | | | | PDP context. See 3GPP | | | | TS 23.060 [15]. | | | | | | | | This IE is not sent if this | | | | IF is initiated at DP | | | | Change of Position Context. | +-----------------------------+--------+-----------------------------+ | IMEI (with software | C | This IE contains the IMEISV | | version) | | (as defined in 3GPP | | | | TS 23.003 [7]) of the ME | | | | in use by the served | | | | subscriber. | +-----------------------------+--------+-----------------------------+
Quality of Service contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Requested QoS | C | This IE identifies the QoS | | | | requested by the subscriber | | | | for a new PDP Context. It | | | | shall be included if the | | | | InitialDPGPRS is sent at | | | | PDP Context Establishment, | | | | at PDP Context | | | | Establishment | | | | Acknowledgement and at | | | | Change of Position Context. | +--------------------------+--------+-----------------------------+ | Subscribed QoS | C | This IE identifies the | | | | subscribed QoS. It shall be | | | | included if the | | | | InitialDPGPRS is sent at | | | | PDP Context Establishment, | | | | at PDP Context | | | | Establishment | | | | Acknowledgement and at | | | | Change of Position Context. | +--------------------------+--------+-----------------------------+ | Negotiated QoS | C | This IE identifies the QoS | | | | which was negotiated | | | | between the user, the SGSN | | | | and the GGSN. It shall be | | | | included if the Initial DP | | | | GPRS is sent at PDP Context | | | | Establishment | | | | Acknowledgement and at | | | | Change of Position Context. | +--------------------------+--------+-----------------------------+ | Requested QoS Extension | S | This IE contains a | | | | supplement to the Requested | | | | QoS IE. It shall be present | | | | if the Requested QoS IE is | | | | present and the MS | | | | requested one or more of | | | | the following for the PDP | | | | context: | | | | | | | | - Source Statistics | | | | Descriptor; | | | | | | | | - Signalling Indication; | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +--------------------------+--------+-----------------------------+ | Subscribed QoS Extension | S | This IE contains a | | | | supplement to the | | | | Subscribed QoS IE. It shall | | | | be present if the Subsribed | | | | QoS IE is present and one | | | | or more of the following is | | | | part of the subscription | | | | profile in the HLR: | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +--------------------------+--------+-----------------------------+ | Negotiated QoS Extension | S | This IE contains a | | | | supplement to the | | | | Negotiated QoS. It shall be | | | | present if the Negotiated | | | | QoS IE is present and one | | | | or more of the following | | | | was negotiated between the | | | | MS, the SGSN and the GGSN: | | | | | | | | - Source Statistics | | | | Descriptor; | | | | | | | | - Signalling Indication; | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +--------------------------+--------+-----------------------------+
End User Address shall be populated as follows:
\- At DP Change Of Position Context in an Inter-SGSN Routeing Area Update:
Initial DP GPRS and EventReportGPRS contain the selected value;
\- At DP PDP Context Establishment: Initial DP GPRS and Event Report GPRS
contain the value which the MS has requested;
\- At DP PDP Context Establishment Acknowledgement: Initial DP GPRS and Event
Report GPRS contain the selected value. Note that the PDP Address is not
always available at this DP.
For details see 3GPP TS 23.060 [15].
End User Address contains the following information elements:
* * *
Information element name Status Description PDP Type Organization C This IE
identifies the PDP Type Organisation (e.g. IETF). PDP Type Number C This IE
identifies the PDP type, e.g. IPv4 or IPv6. PDP Address C This IE identifies
the address of the subscriber for a new PDP Context.
* * *
### 6.6.2 gsmSCF to gprsSSF Information Flows
#### 6.6.2.1 Activity Test GPRS
##### 6.6.2.1.1 Description
This IF is used to check for the continued existence of a relationship between
the gsmSCF and gprsSSF. If the relationship is still in existence, then the
gprsSSF will respond. If no reply is received, then the gsmSCF will assume
that the gprsSSF has failed in some way and will take the appropriate action.
##### 6.6.2.1.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +--------------------------+--------+-----------------------------+
#### 6.6.2.2 Apply Charging GPRS
##### 6.6.2.2.1 Description
This IF is used for interacting from the gsmSCF with the gprsSSF charging
mechanisms to control the charging of a GPRS session or a PDP Context.
##### 6.6.2.2.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +--------------------------+--------+-----------------------------+ | Charging Characteristics | M | This IE specifies the | | | | charging related | | | | information to be provided | | | | by the gprsSSF and the | | | | conditions on which this | | | | information has to be | | | | provided back to the | | | | gsmSCF. It is a choice | | | | between granted volume and | | | | granted time for the data | | | | transfer. | | | | | | | | Time charging may be | | | | applied to GPRS Session or | | | | PDP Contexts; volume | | | | charging may be applied to | | | | PDP Context only. | +--------------------------+--------+-----------------------------+ | Tariff Switch Interval | O | This information element | | | | specifies the time until | | | | the next tariff switch | | | | occurrence. | +--------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Apply Charging GPRS | | | | applies to the GPRS | | | | Session. If this IE is | | | | present in the IF, then the | | | | Apply Charging GPRS applies | | | | to the indicated PDP | | | | Context. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
#### 6.6.2.3 Apply Charging Report GPRS ack
##### 6.6.2.3.1 Description
This IF is the response to the Apply Charging Report GPRS.
##### 6.6.2.3.2 Information Elements
This IF contains no information elements.
#### 6.6.2.4 Cancel GPRS
##### 6.6.2.4.1 Description
This IF is used by the gsmSCF to request the gprsSSF to cancel all EDPs and
reports.
##### 6.6.2.4.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | | | | | | | | Refer to 3GPP | | | | TS 29.078 [36] for the | | | | usage of this element. | +--------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | all pending reports of the | | | | GPRS Session and all | | | | pending reports of the PDP | | | | Contexts shall be cancelled | | | | and all armed events of the | | | | GPRS Session, all armed | | | | events of the PDP Contexts | | | | and all generically armed | | | | events shall be disarmed. | | | | If this IE is present in | | | | the IF, then all pending | | | | reports of the indicated | | | | PDP Context shall be | | | | cancelled and all armed | | | | events of the indicated PDP | | | | Context shall be disarmed. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
#### 6.6.2.5 Connect GPRS
##### 6.6.2.5.1 Description
This IF is used by the gsmSCF to request the gprsSSF to modify the APN used
when establishing a PDP Context. This IF shall not be used for a secondary PDP
context or for a network initiated PDP context.
##### 6.6.2.5.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Access Point Name | M | This IE contains the Access | | | | Point Name (APN) to be used | | | | when establishing the PDP | | | | Context. The gsmSCF should | | | | provide an APN which is | | | | allowed by the served | | | | subscriber\'s subscription. | | | | The APN provided by the | | | | gsmSCF is used for | | | | selecting the primary PDP | | | | context as specified in | | | | 3GPP TS 23.060 [15]. The | | | | gsmSCF provided APN may | | | | consist of Network Identity | | | | (NI) only, or Network | | | | Identity and Operator | | | | Identity (OI). The APN | | | | provided by the gsmSCF | | | | replaces entirely the APN | | | | requested by the MS. If the | | | | gsmSCF does not provide OI | | | | in APN then the SGSN | | | | selects the OI independent | | | | of MS. | +--------------------------+--------+-----------------------------+ | PDP Id | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: There shall | | | | always be this IE present | | | | in this IF. This IE | | | | indicates the PDP Context | | | | to which the Connect GPRS | | | | applies. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
#### 6.6.2.6 Continue GPRS
##### 6.6.2.6.1 Description
This information flow requests the gprsSSF to proceed with processing at the
DP at which it previously suspended processing to await gsmSCF instructions.
The gprsSSF completes DP processing, and continues processing (i.e. proceeds
to the next point in the Attach/Detach State Model or PDP Context State Model)
without substituting new data from the gsmSCF.
##### 6.6.2.6.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Continue GPRS applies | | | | to the GPRS Session. If | | | | this IE is present in the | | | | IF, then the Continue GPRS | | | | applies to the indicated | | | | PDP Context. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
#### 6.6.2.7 Entity Released GPRS ack
##### 6.6.2.7.1 Description
This IF is the response to the Entity Released GPRS.
##### 6.6.2.7.2 Information Elements
This IF contains no information elements.
#### 6.6.2.8 Event Report GPRS ack
##### 6.6.2.8.1 Description
This IF is the response to the Event Report GPRS.
##### 6.6.2.8.2 Information Elements
This IF contains no information elements.
#### 6.6.2.9 Furnish Charging Information GPRS
##### 6.6.2.9.1 Description
This IF is used to request the gprsSSF to include information in the CAMEL
specific logical call record.
The logical call record is created when FCI-GPRS is received and a logical
call record for that state model does not exist. For modelling purposes the
logical call record is buffered in the gprsSSF. The gprsSSF completes logical
call records as defined in the SDLs. Once the logical call record is
completed, then its free format data are moved to the corresponding CDR and
the logical call record is deleted.
In the SGSN there is a separate Logical call record for the attach/detach
state model and for each PDP context.
The CSE can send multiple concatenated FCIs per Logical Call Record for
completion. The total maximum of free format data is 160 octets per Logical
Call Record. The 160 octets may be sent in one or more FCI IF. If there is
incomplete free format data and one or more new FCI IFs is/are received to
overwrite the incomplete data, then the incomplete data are discarded and the
gsmSCF can send another 160 octets per CDR.
##### 6.6.2.9.2 Information Elements
* * *
Information element name Status Description Gprs Reference Number C This IE
consists of a number assigned by the gprsSSF and a number assigned by the
gsmSCF. It is used for TCAP dialogue segmentation. FCI GPRS Billing Charging
Characteristics M This IE is described in a table below.
* * *
FCI GPRS Billing Charging Characteristics contains the following information:
* * *
Information element name Status Description FCIBCCCAMEL Sequence 1 M This IE
is described in a table below.
* * *
FCIBCCCAMEL Sequence 1 contains the following information:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Free Format Data | M | This IE contains free | | | | format data to be inserted | | | | in the CAMEL logical call | | | | record. | +--------------------------+--------+-----------------------------+ | Append Free Format Data | O | This IE indicates that the | | | | gprsSSF shall append the | | | | free format data to the | | | | Logical call record. In the | | | | SGSN there is a separate | | | | Logical call record for the | | | | attach/detach state model | | | | and for each PDP context. | | | | | | | | - If this IE is present | | | | indicating \"Append\", the | | | | gprsSSF shall append the | | | | free format data received | | | | in this IF to the free | | | | format data already present | | | | in the Logical call record | | | | for that GPRS session or | | | | PDP Context. | | | | | | | | - If this IE is absent or | | | | indicates \"Overwrite\", | | | | then the gprsSSF shall | | | | overwrite all free format | | | | data already present in the | | | | Logical call record for | | | | that GPRS session or PDP | | | | Context, by the free format | | | | data received in this IF. | | | | | | | | If no Logical call record | | | | exists yet for that GPRS | | | | session or PDP Context, | | | | then the gprsSSF shall | | | | ignore this IE. | +--------------------------+--------+-----------------------------+ | PDP Id | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Furnish Charging | | | | Information GPRS applies to | | | | the GPRS Session. If this | | | | IE is present in the IF, | | | | then the Furnish Charging | | | | Information GPRS applies to | | | | the indicated PDP Context. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
#### 6.6.2.10 Release GPRS
##### 6.6.2.10.1 Description
This IF is used by the gsmSCF to tear down an existing GPRS session or PDP
Context at any time.
##### 6.6.2.10.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | +--------------------------+--------+-----------------------------+ | GPRS Cause | M | This IE contains the Cause | | | | value indicating the reason | | | | for releasing the GPRS | | | | session or PDP context. | +--------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Release GPRS applies to | | | | the GPRS Session, in which | | | | case the GPRS Session and | | | | all PDP Contexts shall be | | | | released. If this IE is | | | | present in the IF, then the | | | | Release GPRS applies to the | | | | indicated PDP Context, in | | | | which case the indicated | | | | PDP Context shall be | | | | released. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
#### 6.6.2.11 Request Report GPRS Event
##### 6.6.2.11.1 Description
This IF is used to request the gprsSSF to monitor for an event and send a
notification back to the gsmSCF when the event is detected (see Event Report
GPRS IF).
##### 6.6.2.11.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Gprs Reference Number | C | This IE consists of a | | | | number assigned by the | | | | gprsSSF and a number | | | | assigned by the gsmSCF. It | | | | is used for TCAP dialogue | | | | segmentation. | +--------------------------+--------+-----------------------------+ | GPRS Event | M | This IE specifies the event | | | | or events of which a report | | | | is requested. | +--------------------------+--------+-----------------------------+ | PDP ID | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IF is | | | | used to arm an event | | | | related to the GPRS | | | | Session, then this IF shall | | | | not include this IE. If | | | | this IF is used to arm an | | | | event related to a specific | | | | PDP Context, then this IF | | | | shall include this IE for | | | | that PDP Context. If this | | | | IF is used to generically | | | | arm a PDP Context related | | | | event, then this IF shall | | | | not include this IE. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
GPRS Event contains the following information elements:
* * *
Information element name Status Description GPRS Event type M This IE
specifies the type of event of which a report is requested. Monitor Mode M
This IE indicates how the event shall be reported.
* * *
#### 6.6.2.12 Reset Timer GPRS
##### 6.6.2.12.1 Description
This IF is used to refresh the gprsSSF timer.
##### 6.6.2.12.2 Information Elements
* * *
Information element name Status Description Gprs Reference Number C This IE
consists of a number assigned by the gprsSSF and a number assigned by the
gsmSCF. It is used for TCAP dialogue segmentation. Timer ID M This IE
specifies the default value for the Tssf timer. Timer Value M This IE
specifies the value to which the timer Tssf shall be set.
* * *
#### 6.6.2.13 Send Charging Information GPRS
##### 6.6.2.13.1 Description
This IF is used to send e‑parameters from the gsmSCF to the gprsSSF. If charge
advice information is received from the gsmSCF, it shall replace the charge
advice information which would be generated by the SGSN and inhibit any
further generation of CAI by the SGSN. Further processing of the charge advice
information by the SGSN shall be in accordance with the Advice of Charge
supplementary service.
If the SGSN supports Advice of Charge, then the gsmSCF may use this IF to send
e‑parameters to the gprsSSF. However, if the subscriber is not provisioned
with the Advice of Charge supplementary service, then no e‑parameters shall be
sent to the MS and no error due to this fact shall be sent back to the gsmSCF.
If the SGSN does not support Advice of Charge, then the gsmSCF shall not send
e‑parameters to the gprsSSF.
The SGSN\'s support of Advice of Charge is indicated in the Initial DP GPRS
IF.
NOTE: If charge advice information is received from the gsmSCF after charge
information has been generated by the SGSN and sent to the MS, the behaviour
of the service may be unpredictable or incorrect; the service designer should
therefore ensure that the first set of charge advice information is sent to
the gprsSSF before charge information is sent to the to the MS.
##### 6.6.2.13.2 Information Elements
* * *
Information element name Status Description Gprs Reference Number C This IE
consists of a number assigned by the gprsSSF and a number assigned by the
gsmSCF. It is used for TCAP dialogue segmentation. SCI GPRS Billing
ChargingCharacteristics M This IE defines the Advice Of Charge related
information to be provided to the Mobile Station, if supported by the SGSN.
* * *
GPRS SCI Billing Charging Characteristics contains the following information
elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | AOC GPRS | M | This IE is present after an | | | | Activate PDP Context Accept | | | | or Attach Accept has been | | | | received from the SGSN. | | | | This IE defines the Advice | | | | Of Charge related | | | | information to be provided | | | | to the Mobile Station, if | | | | supported by the SGSN. | +--------------------------+--------+-----------------------------+ | PDP Id | C | This IE identifies the PDP | | | | Context to which the IF | | | | applies. | | | | | | | | Scenario 1: If this IE is | | | | not present in the IF, then | | | | the Send Charging | | | | Information GPRS applies to | | | | the GPRS Session. If this | | | | IE is present in the IF, | | | | then the Send Charging | | | | Information GPRS applies to | | | | the indicated PDP Context. | | | | | | | | Scenario 2: This IE is not | | | | used in the IF. | +--------------------------+--------+-----------------------------+
AOC GPRS contains the following information elements:
* * *
Information element name Status Description AOC Initial M This IE contains CAI
elements as defined in 3GPP TS 22.024 [3]. AOC Subsequent O This IE is
described in a table below.
* * *
AOC Subsequent contains the following information elements:
* * *
Information element name Status Description CAI Elements M This IE contains
CAI elements as defined in 3GPP TS 22.024 [3]. Tariff Switch Interval O This
IE indicates the tariff switch time until the next tariff switch applies.
* * *
### 6.6.3 HLR to SGSN Information Flows
#### 6.6.3.1 Delete Subscriber Data
##### 6.6.3.1.1 Description
This IF is used by the HLR to delete CAMEL subscription data from an SGSN. It
is specified in 3GPP TS 29.002 [34].
##### 6.6.3.1.2 Information Elements
The Delete Subscriber Data IF contains the following CAMEL specific
information elements:
* * *
Information element name Status Description CAMEL Subscription Info Withdraw O
This IE identifies that all CSIs shall be deleted from the subscriber data in
SGSN. Specific CSI Withdraw O This IE is used to indicate that only GPRS‑CSI
shall be deleted from the SGSN. This IE should not be present when CAMEL
Subscription Info Withdraw is present.
* * *
#### 6.6.3.2 Insert Subscriber Data
##### 6.6.3.2.1 Description
This IF is specified in 3GPP TS 29.002 [34] and used by the HLR to insert
subscriber data in the SGSN.
##### 6.6.3.2.2 Information Elements
Insert Subscriber Data contains the following CAMEL specific information
element:
* * *
Information element name Status Description GPRS‑CSI O This IE identifies the
subscriber as having CAMEL GPRS services.
* * *
GPRS‑CSI contains the following information elements:
* * *
Information element name Status Description GsmSCF Address M See subclause
6.3.1.1. Service Key M See subclause 6.3.1.2. Default Session Handling M See
subclause 6.3.1.3. TDP List M See subclause 6.3.1.4. CAMEL Capability Handling
M See subclause 6.3.1.5.
* * *
### 6.6.4 SGSN to HLR Information Flows
#### 6.6.4.1 Insert Subscriber Data ack
##### 6.6.4.1.1 Description
This IF is used by the SGSN to indicate to the HLR the result of the Insert
Subscriber Data IF. It is specified in 3GPP TS 29.002 [34].
##### 6.6.4.1.2 Information Elements
Insert Subscriber Data ack contains the following CAMEL specific information
elements:
* * *
Information element name Status Description Supported CAMEL Phases S This IE
identifies which CAMEL phases are supported by the SGSN. It shall be present
when a CSI has been included in the Insert Subscriber Data IF. Offered CAMEL4
CSIs S This IE indicates the CAMEL phase 4 CSIs offered in the SGSN. It shall
be present if a CSI has been included in the Insert Subscriber Data IF.
* * *
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description MT‑SMS‑CSI S This IE indicates the
offer of CAMEL phase 4 MT‑SMS‑CSI. It shall be present if a CSI has been
included in the Insert Subscriber Data IF. MG‑CSI S This IE indicates the
offer of CAMEL phase 4 MG‑CSI. It shall be present if a CSI has been included
in the Insert Subscriber Data IF. PSI Enhancements S This IE indicates the
offer of CAMEL phase 4 Enhancements of Provide Subscriber Information.
* * *
#### 6.6.4.2 Update GPRS Location
##### 6.6.4.2.1 Description
This IF is used by the SGSN to indicate to the HLR the CAMEL phases supported
by the SGSN. It is specified in 3GPP TS 29.002 [34].
##### 6.6.4.2.2 Information Elements
Update GPRS location contains the following CAMEL specific information
element:
* * *
Information element name Status Description Supported CAMEL Phases S This IE
identifies which CAMEL phases are supported by the SGSN. The SGSN may indicate
support of CAMEL phase 3 or higher. It shall be present when the SGSN supports
CAMEL. Offered CAMEL4 CSIs This IE indicates the CAMEL phase 4 CSIs offered in
the SGSN. It shall be present if the \"Supported CAMEL Phases\" IE indicates
support of CAMEL phase 4.
* * *
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description MT‑SMS‑CSI S This IE indicates the
offer of CAMEL phase 4 MT‑SMS‑CSI. MG‑CSI S This IE indicates the offer of
CAMEL phase 4 MG‑CSI. PSI Enhancements S This IE indicates the offer of CAMEL
phase 4 Enhancements of Provide Subscriber Information.
* * *
# 7 Short Message Services
## 7.1 Architecture
### 7.1.1 Functional Entities used for CAMEL
This subclause describes the functional architecture needed to support Mobile
Originating Short Message Service (MO SMS) and Mobile Terminating Short
Message Service (MT SMS) interworking for CAMEL. Figures 7.1-1 and 7.1-2 show
the functional entities involved in MO SMS or MT SMS requiring CAMEL support.
Further details of the architecture needed to support Mobile Originating Short
Message Service (MO SMS) and Mobile Terminating Short Message Service (MT SMS)
are given in 3GPP TS 23.040 [14].
{width="6.69375in" height="3.7375in"}
Figure 7.1-1: Functional architecture for support of CAMEL control of MSC
switched MO and MT SMS
{width="6.695138888888889in" height="3.642361111111111in"}
Figure 7.1-2: Functional architecture for support of CAMEL control of SGSN
switched MO and MT SMS
**HLR:** The HLR stores MO‑SMS‑CSI and/or MT‑SMS‑CSI. MO‑SMS‑CSI contains
subscription information for subscribers that require CAMEL support of MO SMS.
MT‑SMS‑CSI contains subscription information for subscribers that require
CAMEL support of MT SMS. One or both of MO‑SMS‑CSI and MT‑SMS‑CSI are
transferred to the VLR or to the SGSN on Location Update and Restore Data or
when MO‑SMS‑CSI or MT‑SMS‑CSI has changed.
**VLR:** The VLR receives the MO‑SMS‑CSI and MT‑SMS‑CSI for the subscriber
from the HLR. MO‑SMS‑CSI and MT‑SMS‑CSI are used by the MSC to determine
whether a Service Logic shall be invoked for an MO SMS submission or MT SMS
delivery.
**MSC:** The MSC receives MO‑SMS‑CSI and MT‑SMS‑CSI from the VLR and uses this
to determine whether a Service Logic shall be invoked for an MO SMS submission
or MT SMS delivery.
**SGSN:** The SGSN receives the MO‑SMS‑CSI and MT‑SMS‑CSI for the subscriber
from the HLR. The SGSN uses the MO‑SMS‑CSI and MT‑SMS‑CSI to determine whether
a Service Logic shall be invoked for an MO SMS submission or MT SMS delivery.
**gprsSSF: see subclause 3.1.**
**gsmSSF: see subclause 3.1.**
**gsmSCF: see subclause 3.1.**
**SMSC:** The Short Message Service Centre accepts messages submitted by an MS
or other MO short message entity, stores them and delivers them to the
destination MS or other MT short message entity.
**SMS-GMSC:** The Short Message Service Gateway MSC receives short messages
from the SMSC, interrogates the HLR for routeing information to deliver each
short message and forwards each short message to the serving node (MSC or
SGSN) for delivery to the destination MS. The SMS-GMSC may be physically
integrated with the SMSC or with the MSC for the destination subscriber.
**SMS-IWMSC:** The Short Message Service InterWorking MSC terminates the MAP
signalling from the MSC or the SGSN for MO short message submission, and
transfers the short message to the SMSC, The SMS-IWMSC may be physically
integrated with the SMSC or with the MSC for the originating subscriber.
### 7.1.2 Interfaces defined for CAMEL
#### 7.1.2.1 HLR - VLR interface
This interface is used to send CAMEL related subscriber data (MO‑SMS‑CSI and
MT‑SMS‑CSI) to a visited MSC/VLR or to remove CAMEL related subscriber data
from a visited MSC/VLR.
#### 7.1.2.2 HLR - SGSN interface
This interface is used to send CAMEL related subscriber data (MO‑SMS‑CSI and
MT‑SMS‑CSI) to a visited SGSN or to remove CAMEL related subscriber data from
a visited SGSN.
#### 7.1.2.3 gsmSSF - gsmSCF interface
This interface is used by the gsmSCF to control the handling of MO SMS and MT
SMS in the MSC. A relationship on this interface is opened as a result of the
gsmSSF sending a request for instructions to the gsmSCF.
#### 7.1.2.4 gprsSSF - gsmSCF interface
This interface is used by the gsmSCF to control the handling of MO SMS and MT
SMS in the SGSN. A relationship on this interface is opened as a result of the
gprsSSF sending a request for instructions to the gsmSCF.
#### 7.1.2.5 MSC - gsmSSF interface
This is an internal interface. The interface is described in the present
document to make it easier to understand the handling of DPs (arming/disarming
of DPs, DP processing etc.).
#### 7.1.2.6 SGSN - gprsSSF interface
This is an internal interface. The interface is described in the present
document to make it easier to understand the handling of DPs (arming/disarming
of DPs, DP processing etc.).
#### 7.1.2.7 MSC - VLR interface
This is an internal interface. The interface is described in the present
document to make it easier to understand the internal information flow within
the MSC/VLR.
#### 7.1.2.8 MSC - SMSC interface
This interface is used by the MSC to submit a SM to the SMSC and to deliver a
SM to the MSC.
#### 7.1.2.9 SGSN - SMSC interface
This interface is used by the SGSN to submit a SM to the SMSC and to deliver a
SM to the SGSN.
## 7.2 Detection Points (DPs)
For the general handling of the DPs, see subclause 4.2.
### 7.2.1 Criteria at DP SMS Delivery Request
The HLR may store a criterion that indicates when triggering shall take place.
The criterion for DP SMS_Delivery_Request consists of a list of TPDU types.
Refer to 3GPP TS 23.040 [14] for the available TPDU types. When the TPDU type
of the Short Message is present in the list of TPDU types, then triggering
shall take place. Otherwise, triggering shall not take place.
If no criterion is defined for a subscriber, then triggering shall take place
regardless of the TPDU type of the Short Message.
## 7.3 Description of CAMEL Subscriber Data
Note: CAMEL Phase 3 specifies SMS‑CSI for MO SMS CAMEL Services. CAMEL Phase 4
specifies MO‑SMS‑CSI for MO SMS CAMEL Services and MT‑SMS‑CSI for MT SMS CAMEL
Services. SMS‑CSI and MO‑SMS‑CSI are, however, syntactically and functionally
identical.
### 7.3.1 Mobile Originating Short Message Service CAMEL Subscription
Information (MO‑SMS‑CSI)
This subclause defines the contents of the Short Message Service CAMEL
Subscription Information.
#### 7.3.1.1 gsmSCF address
Address to be used to access the gsmSCF for a particular subscriber. The
address shall be an E.164 number to be used for routeing.
#### 7.3.1.2 Service Key
The Service Key identifies to the gsmSCF the service logic.
#### 7.3.1.3 Default SMS Handling
The Default SMS Handling indicates whether the Short Message submission shall
be released or continued as requested in the case of error in the dialogue
between gsmSCF and gsmSSF or gprsSSF.
#### 7.3.1.4 TDP List
The TDP List indicates on which detection point triggering shall take place.
For MO‑SMS‑CSI only DP SMS_Collected_Info is used.
#### 7.3.1.5 CAMEL Capability Handling
CAMEL Capability Handling indicates the phase of CAMEL which is asked by the
gsmSCF for the service. This parameter shall be set to CAMEL Phase 3
#### 7.3.1.6 CSI state
The CSI state indicates whether the MO‑SMS‑CSI is active or not.
#### 7.3.1.7 Notification flag
The notification flag indicates whether the change of the MO‑SMS‑CSI shall
trigger Notification on Change of Subscriber Data or not.
### 7.3.2 Mobile Terminating Short Message Service CAMEL Subscription
Information (MT‑SMS‑CSI)
This subclause defines the contents of the Mobile Terminating Short Message
Service CAMEL Subscription Information.
#### 7.3.2.1 gsmSCF address
Address to be used to access the gsmSCF for a particular subscriber. The
address shall be an E.164 number to be used for routeing.
#### 7.3.2.2 Service Key
The Service Key identifies to the gsmSCF the service logic.
#### 7.3.2.3 Default SMS Handling
The Default SMS Handling indicates whether the Short Message delivery shall be
released or continued as requested in the case of error in the dialogue
between gsmSCF and gsmSSF or gprsSSF.
#### 7.3.2.4 TDP List
The TDP List indicates on which detection point triggering shall take place.
For MT‑SMS‑CSI only DP SMS_Delivery_Request is used.
#### 7.3.2.5 DP criteria
The DP criteria indicate whether the SMS_SSF shall request the gsmSCF for
instructions.
#### 7.3.2.6 CAMEL Capability Handling
CAMEL Capability Handling indicates the phase of CAMEL which is asked by the
gsmSCF for the service. This parameter shall be set to CAMEL Phase 4.
#### 7.3.2.7 CSI state
The CSI state indicates whether the MT‑SMS‑CSI is active or not.
#### 7.3.2.8 Notification flag
The notification flag indicates whether the change of the MT‑SMS‑CSI shall
trigger Notification on Change of Subscriber Data or not.
### 7.3.3 gsmSCF address list for CSI
The gsmSCF address list indicates a list of gsmSCF addresses to which
Notification on Change of Subscriber Data is to be sent. This list is common
to all CSI\'s.
## 7.4 Description of SMS State Models
### 7.4.1 General Handling
See subclause 4.4.1.
The State Model for MO SMS handling contains Points in Association (PIA\'s)
instead of Points in Call (PIC\'s).
### 7.4.2 Mobile Originating SMS State Models
#### 7.4.2.1 Description of MO SMS state model
The MO SMS state model is used to describe the actions in an MSC and in a SGSN
during Mobile Originating SMS.
{width="4.8590277777777775in" height="3.375in"}
Figure 7.2: MO SMS State Model
Table 7.1: Description of MO SMS DPs in the MSC and SGSN
* * *
CAMEL Detection Point DP Type Description DP SMS_Collected_Info TDP‑R
Indication that the MO‑SMS‑CSI is analysed and a mobile originated short
message is received. DP O_SMS_Failure EDP‑N, EDP‑R Indication that the SM
submission to the Short Message Service Centre failed DP O_SMS_Submitted
EDP‑N, EDP‑R Indication that the SM has been successfully submitted to the
Short Message Service Centre.
* * *
##### 7.4.2.1.1 Description of the MO SMS state model (PIAs)
This subclause describes the state model for originating SMS transfer. For
each PIA a description can be found of the entry events, actions and exit
events.
###### 7.4.2.1.1.1 SMS Null & Start & Authorize
Entry events:
\- Previous MO SMS transfer to the SMSC completed (DP O_SMS_Submitted).
\- Exception event is reported.
Actions:
\- Interface is idled.
\- Authentication.
\- Ciphering.
\- MO SMS subscription check.
\- RP-MO-DATA message containing the User Data and the SMSC address is
received from MS.
\- The supplementary service \"barring of all outgoing calls\" is checked and
invoked if necessary.
\- The ODB category \"barring of all outgoing calls\" is checked and ODB is
invoked if necessary.
Exit events:
\- MO‑SMS‑CSI is analysed.
\- An exception condition is encountered.
###### 7.4.2.1.1.2 SMS Analyse & Routing
Entry events:
\- MO‑SMS‑CSI is analysed (DP SMS_Collected_Info).
Actions:
\- Information being analysed and/or translated to determine routeing address
of the SMSC.
\- Outgoing barring services and ODB categories not already applied are
checked and invoked if necessary. If any of the barring services or ODB
categories prevents the submission of the MO‑SMS, then the MSC or SGSN shall
generate the \"O_SMS_Failure\" event. The cause code to be used in that case
shall be \"sM‑DeliveryFailure\".
\- The short message is sent to the SMSC.
Exit events:
\- Acknowledge from the SMSC is received. (DP O_SMS_submitted).
A positive acknowledgement is sent to the MS.
\- An exception condition is encountered - this leads to the SMS_Exception
PIA.
A negative acknowledgement is sent to the MS.
\- Attempt to select the route for the SMS fails (DP O_SMS_Failure).
A negative acknowledgement is sent to the MS.
\- Negative acknowledgement from the SMSC is received (DP O_SMS_Failure).
A negative acknowledgement is sent to the MS.
###### 7.4.2.1.1.3 SMS_Exception
Entry events:
\- An exception condition is encountered. In addition to specific examples
listed above, exception events include any type of failure, which means that
the normal exit events for a PIA cannot be met.
Actions:
\- Default handling of the exception condition is applied. This includes
general actions necessary to ensure that no resources remain inappropriately
allocated such as:
\- If a relationship exists between the gsmSCF and gsmSSF or gprsSSF send an
error information flow closing the relationship and indicating that any
outstanding Short Message handling instructions will not run to completion.
\- The MSC/gsmSSF or SGSN/gprsSSF shall make use of vendor-specific procedures
to ensure release of internal resources.
Exit events:
\- Default handling of the exception condition by MSC/gsmSSF or SGSN/gprsSSF
completed.
### 7.4.3 Mobile Terminating SMS State Model
#### 7.4.3.1 Description of MT SMS state model
The MT SMS state model is used to describe the actions in an MSC and in a SGSN
during Mobile Terminating SMS.
{width="4.861805555555556in" height="3.375in"}
Figure 7.3: MT SMS State Model
Table 7.2: Description of MT SMS DPs in the MSC and SGSN
* * *
CAMEL Detection Point DP Type Description DP SMS_Delivery_Request TDP‑R
Indication that the MT‑SMS‑CSI is analysed and a mobile terminating short
message or status report is received. DP T_SMS_Failure EDP‑N, EDP‑R Indication
that the SM delivery to the Mobile Station has failed DP T_SMS_Delivered
EDP‑N, EDP‑R Indication that the SM has been successfully delivered to the
Mobile Station.
* * *
##### 7.4.3.1.1 Description of the MT SMS state model (PIAs)
This subclause describes the state model for terminating SMS transfer. For
each PIA a description can be found of the entry events, actions and exit
events.
###### 7.4.3.1.1.1 SMS Null & Start & Authorize
Entry events:
\- MAP-MT-FORWARD-SHORT-MESSAGE message is received from SMS-GMSC.
\- Previous MT SMS transfer to the MS completed (DP T_SMS_Delivered).
\- Exception event is reported.
Actions:
\- Interface is idled.
\- MT SMS subscription check.
\- MT‑SMS‑CSI is received from the VLR (in the MSC only).
Exit events:
\- MT‑SMS‑CSI is analysed.
\- An exception condition is encountered.
###### 7.4.3.1.1.2 SMS Delivery
Entry events:
\- MT‑SMS‑CSI is analysed. (DP SMS_Delivery_Request).
Actions:
\- Subscriber paging is performed, if required.
\- The short message is delivered to the MS.
Exit events:
\- Acknowledge from the MS is received. (DP T_SMS_Delivered).
> A positive acknowledgement is sent to the SMSC.
\- An exception condition is encountered - this leads to the SMS_Exception
PIA.
> A negative acknowledgement is sent to the SMSC.
\- Negative acknowledgement from the MS is received (DP T_SMS_Failure).
> A negative acknowledgement is sent to the SMSC.
###### 7.4.3.1.1.3 SMS_Exception
Entry events:
\- An exception condition is encountered. In addition to specific examples
listed above, exception events include any type of failure, which means that
the normal exit events for a PIA cannot be met.
Actions:
\- Default handling of the exception condition is applied. This includes
general actions necessary to ensure that no resources remain inappropriately
allocated such as:
\- If a relationship exists between the gsmSCF and gsmSSF or gprsSSF send an
error information flow closing the relationship and indicating that any
outstanding Short Message handling instructions will not run to completion.
\- The MSC/gsmSSF or SGSN/gprsSSF shall make use of vendor-specific procedures
to ensure release of internal resources.
Exit events:
\- Default handling of the exception condition by MSC/gsmSSF or SGSN/gprsSSF
completed.
## 7.5 Procedures for CAMEL SMS
### 7.5.1 Functional architecture for CAMEL MO SMS services
{width="5.834027777777778in" height="4.5993055555555555in"}
Note 1: The functional entities depicted by means of dark shaded boxes in the
figure 7.4 are not affected by CAMEL interaction with MO‑SMS.
Note 2: The Relay Protocol between the MS and the MSC or SGSN is described in
3GPP TS 24.011 [31]. The Relay Protocol between the MSC or SGSN and the SMS-
GMSC is described in 3GPP TS 29.002 [34]. The Relay Protocol between the SMS-
GMSC and the SMSC is not standardised. Examples of this protocol are described
in GSM TR 03.47 [42].
Figure 7.4: MO SMS via MSC or SGSN
### 7.5.2 Handling of mobile originating SMS
#### 7.5.2.1 Handling of mobile originating SMS in the originating MSC or SGSN
The functional behaviour of the originating MSC or SGSN is specified in 3GPP
TS 29.002 [34] and 3GPP TS 23.060 [15]. The procedures specific to CAMEL are
specified in this subclause:
\- Procedure CAMEL_O_SMS_INIT;
\- Procedure CAMEL_O_SMS_SUBMITTED;
\- Procedure CAMEL_O_SMS_FAILURE.
A CAMEL Service may be invoked for the following Mobile Originated short
message types:
\- Short Message Submission (TPDU type = SMS-SUBMIT)
\- Short Message Command (TPDU type = SMS-COMMAND)
Refer to 3GPP TS 23.040 [14] for a description of the various TPDU types and
to 3GPP TS 24.011 [31] for a description of the protocol elements of the Short
Message Relay Layer (RPDUs).
##### 7.5.2.1.1 Actions of the MSC or SGSN on receipt of Int_Error
The MSC or SGSN checks the default SMS Handling parameter in MO‑SMS‑CSI.
If the default SMS handling is \'releaseTransaction\', a A_RP_ERROR is sent to
the MS. The MSC or SGSN then releases all resources and the procedure
CAMEL_O_SMS_INIT ends.
If the default SMS handling is \'continueTransaction\', the MSC or SGSN
continues processing without CAMEL support.
##### 7.5.2.1.2 Actions of the MSC or SGSN on receipt of Int_Continue_SMS
The MSC or SGSN continues processing with modified SM parameters. The MSC or
SGSN shall transparently modify the SMS parameters with the received
information. Parameters which are not included in the Int_Continue_SMS signal
are unchanged.
##### 7.5.2.1.3 Actions of the MSC or SGSN on receipt of Int_Connect_SMS
The MSC or SGSN continues processing with modified SM parameters. The MSC or
SGSN shall transparently modify the SMS parameters with the received
information. Barring is checked with the modified parameters. Parameters which
are not included in the Int_Connect_SMS signal are unchanged.
##### 7.5.2.1.4 Actions of the MSC or SGSN on receipt of Int_Release_SMS
A_RP_ERROR is sent to the MS and the Short Message is deleted. The SMS cause
received in the Int_Release_SMS signal is used. The MSC or SGSN then releases
all resources and the procedure CAMEL_O_SMS_INIT ends.
##### 7.5.2.1.5 Allocation of SMS Reference Number
During the CAMEL handling of a Mobile Originated Short Message, the MSC or
SGSN shall allocate an SMS Reference Number. This SMS Reference Number shall
be placed in the SMS-MO Call Detail Record, together with the MSC Address or
SGSN Number. This SMS Reference Number shall also be sent to the gsmSCF in the
Initial DP SMS Information Flow, together with the MSC Address or SGSN Number.
The combination of SMS Reference Number and MSC Address or SGSN Number forms a
globally unique pair. This pair may be used for correlation of CDRs produced
in the MSC or SGSN with CDRs produced in the gsmSCF.
An SMS Reference Number shall be generated and placed in the SMS-MO Call
Detail Record, for every Short Message, including the case when a Short
Message forms part of a set of concatenated Short Messages.
#### 7.5.2.2 Handling of A_MM_Release and A_LLC_Release
If the radio link with the subscriber is lost during the handling of a CAMEL
procedure in the MSC or SGSN, then the MSC or SGSN sends signal
A_MM_Release_ind or A_LLC_Release_ind to that procedure. This results in the
termination of that CAMEL procedure. (Refer to 3GPP TS 29.002 [34] for
details.)
#### 7.5.2.3 Handling of time-out from SMSC
If the MSC or SGSN does not receive a confirmation from the SMSC after
submission of a Short Message, then the MSC or SGSN calls procedure
CAMEL_O_SMS_FAILURE. (Refer to 3GPP TS 29.002 [34] for details.)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.5-1: Procedure CAMEL_O_SMS_INIT (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.5-2: Procedure CAMEL_O_SMS_INIT (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.5-3: Procedure CAMEL_O_SMS_INIT (sheet 3)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.6-1: Procedure CAMEL_O_SMS_SUBMITTED (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.7-1: Procedure CAMEL_O_SMS_FAILURE (sheet 1)
#### 7.5.2.4 Handling of mobile originating SMS in the VLR
The functional behaviour of the VLR is specified in 3GPP TS 29.002 [34] The
handling specific to CAMEL is specified in the following procedure:
\- Procedure CAMEL_MO_SMS_VLR.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.8-1: Procedure CAMEL_MO_SMS_VLR (sheet 1)
### 7.5.3 Functional architecture for CAMEL MT SMS services
{width="5.834027777777778in" height="4.788888888888889in"}
Note 1: The functional entities depicted by means of dark shaded boxes in the
figure 7.9 are not affected by CAMEL interaction with MT-SMS.
Note 2: The Relay Protocol between the MS and the MSC or SGSN is described in
3GPP TS 24.011 [31]. The Relay Protocol between the MSC or SGSN and the SMS-
GMSC is described in 3GPP TS 29.002 [34]. The Relay Protocol between the SMS-
GMSC and the SMSC is not standardised. Examples of this protocol are described
in GSM TR 03.47 [42].
Figure 7.9: MT SMS via MSC or SGSN
### 7.5.4 Handling of mobile terminating SMS
#### 7.5.4.1 Handling of mobile terminating SMS in the terminating MSC or SGSN
A CAMEL Service may be invoked for the following Mobile Terminated short
message types:
\- Short Message Delivery (TPDU type = SMS-DELIVER)
\- Short Message Status Report (TPDU type = SMS-STATUS-REPORT)
Refer to 3GPP TS 23.040 [14] for a description of the various TPDU types and
to 3GPP TS 24.011 [31] for a description of the protocol elements of the Short
Message Relay Layer (RPDUs).
The functional behaviour of the terminating MSC or SGSN is specified in 3GPP
TS 29.002 [34]. The procedures specific to CAMEL are specified in the
following subclauses:
##### 7.5.4.1.1 Procedure CAMEL_T_SMS_INIT;
This procedure is called when a Short Message delivery attempt is received
from the SMS-GMSC. If MT‑SMS‑CSI is present for the subscriber, then the
SMS_SSF shall be invoked. Otherwise, the Short Message delivery attempt
proceeds without CAMEL.
When the SMS_SSF is invoked and the SMS_SSF has requested the gsmSCF for
instructions, the MSC or SGSN may receive the following responses from the
SMS_SSF:
\- Int_Continue_SMS
> The gsmSCF has indicated that SM delivery may proceed. It may have supplied
> the SMS_SSF with a modified Calling Party Number. This Calling Party Number
> shall replace the TP-Originating-Address in the SMS-DELIVER TPDU.
\- Int_Release_SMS
> The gsmSCF has force-released SM delivery. The RP Cause received from the
> gsmSCF shall be conveyed to the SMS-GMSC in the RP-Cause component, in the
> RP-ERROR RPDU.
\- Int_Error
> A Tssf time-out or an internal SMS_SSF error has occurred; the SM has not
> been forwarded to the Mobile Station. If Default SMS Handling equals
> \'Continue\', the SM delivery proceeds. Otherwise, SM delivery shall be
> aborted. In the latter case, the RP-Cause component, in the RP-ERROR RPDU
> shall be set to EquipmentProtocolError, in accordance with 3GPP TS 29.002
> [34].
##### 7.5.4.1.2 Procedure CAMEL_T_SMS_DELIVERED
This procedure is called when the MSC or SGSN has detected that delivery of
the SM to the Mobile Station has succeeded. No event specific information is
sent to the gsmSCF.
When Short Message delivery attempt success has been reported to the gsmSCF,
then the MSC or SGSN may receive the following responses from the SMS_SSF:
\- Int_Continue_SMS
> The event was reported to the gsmSCF in interrupt mode. The gsmSCF has
> concluded CAMEL processing and has terminated the Service Logic.
\- Int_Continue
> The event was not reported to the gsmSCF or was reported in notification
> mode.
\- Int_Error
> A Tssf time-out has occurred.
In all the above cases, the SM processing in the MSC or SGSN continues.
##### 7.5.4.1.3 Procedure CAMEL_T_SMS_FAILURE
This procedure is called when the MSC or SGSN has detected that delivery of
the SM to the Mobile Station has failed. If the delivery failure is due to RP-
ERROR RPDU received from the MS, then the MT SMS Cause in the event report to
the gsmSCF shall be set to the RP-Cause component in the RP-ERROR-RPDU.
Otherwise, if the delivery failure is due to internal failure in the MSC or
SGSN, CP-ERROR from MS or time-out from the MS, then the MT SMS Cause in the
event report to the gsmSCF shall be set to \"Protocol error, unspecified\", as
defined in 3GPP TS 24.011 [31].
When Short Message delivery attempt failure has been reported to the gsmSCF,
then the MSC or SGSN may receive the following responses from the SMS_SSF:
\- Int_Continue_SMS
> The event was reported to the gsmSCF in interrupt mode. The gsmSCF has
> concluded CAMEL processing and has terminated the Service Logic.
\- Int_Continue
> The event was not reported to the gsmSCF or was reported in notification
> mode.
>
> \- Int_Error
>
> A Tssf time-out has occurred.
In all the above cases, the SM processing in the MSC or SGSN continues.
##### 7.5.4.1.4 Allocation of SMS Reference Number
During the CAMEL handling of a Mobile Terminating Short Message, the MSC or
SGSN shall allocate an SMS Reference Number. This SMS Reference Number shall
be placed in the SMS-MT Call Detail Record, together with the MSC Address or
SGSN Number. This SMS Reference Number shall also be sent to the gsmSCF in the
Initial DP SMS Information Flow, together with the MSC Address or SGSN Number.
The combination of SMS Reference Number and MSC Address or SGSN Number forms a
globally unique pair. This pair may be used for correlation of CDRs produced
in the MSC or SGSN with CDRs produced in the gsmSCF.
An SMS Reference Number shall be generated and placed in the SMS-MT Call
Detail Record, for every Short Message, including the case when a Short
Message forms part of a set of concatenated Short Messages.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.10-1: Procedure CAMEL_T_SMS_INIT (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.10-2: Procedure CAMEL_T_SMS_INIT (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.11-1: Procedure CAMEL_T_SMS_FAILURE (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.12-1: Procedure CAMEL_T_SMS_DELIVERED (sheet 1)
#### 7.5.4.2 Handling of mobile terminating SMS in the VLR
The functional behaviour of the VLR is specified in 3GPP TS 29.002 [34]. The
handling specific to CAMEL is specified in the following procedure:
\- Procedure CAMEL_MT_SMS_VLR.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.13-1: Procedure CAMEL_MT_SMS_VLR (sheet 1)
#### 7.5.4.3 CAMEL subscription check for mobile terminating SMS in the SGSN
The functional behaviour of the SGSN for delivery of MT shrt message is
specified in 3GPP TS 29.002 [34]. The procedure for checking CAMEL capability
and subscription information is specified in the following procedure:
\- Procedure CAMEL_MT_SMS_SGSN.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.14-1: Procedure CAMEL_MT_SMS_SGSN (sheet 1)
### 7.5.5 Handling of mobile originating and mobile terminating SMS in the
gsmSSF or gprsSSF
#### 7.5.5.1 Process SMS_SSF
Sheet 1 The Int_Invoke SMS_SSF signal dictates which TDP shall be armed. For a
Mobile Originated SMS service, the SMS_Collected_Info TDP shall be armed. For
a Mobile Terminated SMS service, the SMS_Delivery_Request TDP shall be armed.
Sheet 2 The Int_SMS_Failure signal may be received only for a MO-SMS service.
It is received when a MS detach event occurs before the SMS_SSF is invoked.
Sheet 3 The SMSC Address and Destination Subscriber Number may be received in
CAP ConnectSMS only for a MO-SMS service.
Sheet 4: For a MO-SMS service, the following events may be armed or disarmed:
O_SMS_Submission, O_SMS_Failure. For a MT-SMS service, the following events
may be armed or disarmed: T_SMS_Delivery, T_SMS_Failure.
Sheet 5: For a MO-SMS service, the gsmSCF may place free-format charging data
in the \'MOSMSRecord\' CDR (in the MSC) or in the S-SMO-CDR (in the SGSN).
> For a MT-SMS service, the gsmSCF may place free-format charging data in the
> \'MTSMSRecord\' (in the MSC) or in the S-SMT-CDR (in the SGSN).
Refer to 3GPP TS 32.250 [37] and 3GPP TS 32.251 [38] for a description of
these CDR types.
Sheet 6: The Int_SMS_Failure signal in state Waiting_For_Instructions may be
received for a MO-SMS service only. It is received when a MS detach event
occurs before the gsmSCF has given instruction to continue SM processing.
Sheet 7: When the SM submission or failure event occurs, both MO-SMS events
shall be disarmed.
> When the SM delivery or failure event occurs, both MT-SMS events shall be
> disarmed.
#### 7.5.5.2 Process Complete_SMS_FCI_Record
Sheet 1: For a MO-SMS service, the \'MOSMSRecord\' or \'S-SMO-CDR\' shall be
closed. For a MT-SMS service, the \'MTSMSRecord\' or \'S-SMT-CDR\' shall be
closed.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.15-1: Process SMS_SSF (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.15-2: Process SMS_SSF (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.15-3: Process SMS_SSF (sheet 3)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.15-4: Process SMS_SSF (sheet 4)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.15-5: Process SMS_SSF (sheet 5)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.15-6: Process SMS_SSF (sheet 6)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.15-7: Process SMS_SSF (sheet 7)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 7.16-1: Procedure Check_Criteria_SMS_Delivery_Request (Sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 7.17-1: Procedure Complete_SMS_FCI_record (sheet 1)
## 7.6 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for SMS control.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Optional (O), Specific conditions (S), mutually Exclusive (E), or not
applicable (-) for each different traffic case: Mobile Originating SMS (MO)
and Mobile Terminating SMS (MT). If the IEs in one table apply in both the MO
and MT cases, then the IEs are marked in the \"Status\" column.
An \'M\' IE shall always be included. A \'C\' IE shall be included if the
sending entity has the necessary information to populate the IE. The
conditions for the inclusion of an \'S\' IE are shown in the \'Description\'
column of the definition table. When a set of \'E\' IEs is shown in the
definition of an Information Flow or compound IE, only one of those IEs may be
included. An \'O\' IE may be included or omitted as required by the service
logic. A \'‑\' IE shall always be omitted. This categorization is a functional
classification, i.e. it defines the requirements for the stage 2 information.
It is not a stage 3 classification to be used for the ASN.1 syntax of the
protocol.
The distinction between MO and MT SMS applies only to the Information Flows
between the gsmSCF and the gsmSSF or gprsSSF.
Details of errors and exceptions to these rules are specified in 3GPP TS
29.002 [34], TS 29.078 [36].
### 7.6.1 gsmSSF or gprsSSF to gsmSCF information flows
#### 7.6.1.1 Event Report SMS
##### 7.6.1.1.1 Description
This IF is used to notify the gsmSCF of an event previously requested by the
gsmSCF in a Request Report SMS Event IF.
##### 7.6.1.1.2 Information Elements
* * *
Information element name MO MT Description Event Type M M This IE specifies
the type of event that is reported. Event Specific Information C C This IE
indicates the SMS related information specific to the event. Misc SMS Info M M
This IE indicates the DP type.
* * *
If the Event Type IE indicates O_SMS_Failure, then the Event Specific
Information contains the following information element:
* * *
Information element name MO MT Description MO_SMS Cause M - This IE indicates
the reason of submission failure.
* * *
If the Event Type IE indicates T_SMS_Failure, then the Event Specific
Information contains the following information elements:
* * *
Information element name MO MT Description MT_SMS Cause - M This IE indicates
the reason of delivery failure.
* * *
If the Event Type IE indicates O_SMS_Submitted or T_SMS_Delivered, then no
Event Specific Information shall be sent to the gsmSCF.
#### 7.6.1.2 Initial DP SMS
##### 7.6.1.2.1 Description
This IF is generated by the gsmSSF or gprsSSF when a trigger is detected at a
DP in the state model, to request instructions from the gsmSCF.
##### 7.6.1.2.2 Information Elements
+----------------------------+----+----+----------------------------+ | Information element name | MO | MT | Description | +----------------------------+----+----+----------------------------+ | Destination Subscriber | M | - | This IE contains a number | | Number | | | to identify the | | | | | Destination short message | | | | | entity. The Destination | | | | | Subscriber Number shall be | | | | | retrieved from the | | | | | TP-Destination-Address in | | | | | the SMS-SUBMIT TPDU or the | | | | | SMS-COMMAND TPDU. | +----------------------------+----+----+----------------------------+ | Called Party Number | - | M | This IE contains a number | | | | | to identify the subscriber | | | | | for whom the Short Message | | | | | is destined. The Called | | | | | Party Number shall be the | | | | | MSISDN of the served | | | | | subscriber. | +----------------------------+----+----+----------------------------+ | Calling Party Number | M | C | For MO SMS: | | | | | | | | | | This IE contains a number | | | | | to identify the subscriber | | | | | who requests the SM | | | | | submission. The Calling | | | | | Party Number shall be the | | | | | MSISDN of the served | | | | | subscriber. | | | | | | | | | | For MT SMS: | | | | | | | | | | This IE contains the | | | | | address of the submitter | | | | | of the short message. For | | | | | SMS-DELIVER TPDU, the | | | | | Calling Party Number shall | | | | | be retrieved from the | | | | | TP-Originating-Address in | | | | | the SMS-DELIVER TPDU. For | | | | | SMS-STATUS-REPORT TPDU, | | | | | this element shall not be | | | | | included in this IF. | +----------------------------+----+----+----------------------------+ | Event Type | M | M | This IE indicates the | | | | | armed event resulting in | | | | | the Initial DP SMS IF. | +----------------------------+----+----+----------------------------+ | IMSI | M | M | This IE identifies the | | | | | mobile subscriber. | +----------------------------+----+----+----------------------------+ | Location Information In | C | C | This IE is described in a | | MSC | | | table below. | +----------------------------+----+----+----------------------------+ | Location Information In | C | C | This IE is described in a | | SGSN | | | table below. | +----------------------------+----+----+----------------------------+ | Service Key | M | M | This IE indicates to the | | | | | gsmSCF the requested CAMEL | | | | | Service. It is used to | | | | | address the required | | | | | application/SLP within the | | | | | gsmSCF. | +----------------------------+----+----+----------------------------+ | Time And Timezone | M | M | This IE contains the time | | | | | that the gsmSSF or gprsSSF | | | | | was triggered, and the | | | | | time zone the gsmSSF or | | | | | gprsSSF resides in. | +----------------------------+----+----+----------------------------+ | TP Short Message Specific | M | M | This IE contains the first | | Information | | | octet of the applicable | | | | | TPDU. | | | | | | | | | | For SMS-SUBMIT, the | | | | | following elements may be | | | | | included: | | | | | | | | | | - Message Type Indicator | | | | | | | | | | - Reject Duplicates | | | | | | | | | | - Validity Period Format | | | | | | | | | | - Status Report Request | | | | | | | | | | - User Data Header | | | | | Indicator | | | | | | | | | | - Reply Path | | | | | | | | | | For SMS-COMMAND, the | | | | | following elements may be | | | | | included: | | | | | | | | | | - Message Type Indicator | | | | | | | | | | - User Data Header | | | | | Indicator | | | | | | | | | | - Status Report Request | | | | | | | | | | For SMS-DELIVER, the | | | | | following elements may be | | | | | included: | | | | | | | | | | - Message Type Indicator | | | | | | | | | | - More Messages to Send | | | | | | | | | | - Status Report | | | | | Indication | | | | | | | | | | - User Data Header | | | | | Indicator | | | | | | | | | | - Reply Path | | | | | | | | | | For SMS-STATUS-REPORT, the | | | | | following elements may be | | | | | included: | | | | | | | | | | - Message Type Indicator | | | | | | | | | | - More Messages to Send | | | | | | | | | | - Status Report Qualifier | | | | | | | | | | - User Data Header | | | | | Indicator | | | | | | | | | | Refer to 3GPP | | | | | TS 23.040 [14] for an | | | | | indication of which | | | | | elements of this 1^st^ | | | | | octet are Mandatory and | | | | | which elements are | | | | | Conditional. | +----------------------------+----+----+----------------------------+ | TP Protocol Identifier | M | C | This IE indicates the | | | | | protocol used above | | | | | SM-Transfer Layer. | | | | | | | | | | The TP Protocol Identifier | | | | | shall be retrieved from | | | | | the applicable TPDU. | | | | | | | | | | For SMS-STATUS-REPORT, the | | | | | sending of this IE is | | | | | Conditional, depending on | | | | | its presence in the | | | | | SMS-STATUS-REPORT TPDU. | +----------------------------+----+----+----------------------------+ | TP Data Coding Scheme | C | C | This IE indicates the data | | | | | coding scheme of the | | | | | TP‑User Data field, and | | | | | may indicate a message | | | | | class. The message class | | | | | may indicate e.g. the | | | | | originator of the Short | | | | | Message. | | | | | | | | | | The TP Data Coding Scheme | | | | | shall be retrieved from | | | | | the applicable TPDU. | | | | | | | | | | For SMS-COMMAND, this IE | | | | | shall not be included in | | | | | this IF. | +----------------------------+----+----+----------------------------+ | TP Validity Period | S | - | This IE indicates the | | | | | length of the validity | | | | | period or the absolute | | | | | time of the validity | | | | | period termination. This | | | | | IE is used only for the | | | | | SMS-SUBMIT TPDU. | | | | | | | | | | The TP Validity Period, if | | | | | available, shall be | | | | | retrieved from the | | | | | SMS-SUBMIT TPDU. | | | | | | | | | | For other TPDU, this IE | | | | | shall not be included in | | | | | this IF. | +----------------------------+----+----+----------------------------+ | SMSC Address | M | M | For MO SMS: | | | | | | | | | | This IE defines the | | | | | address of the SMSC to | | | | | which the MO short message | | | | | is intended to be | | | | | submitted. It shall be | | | | | retrieved from the | | | | | RP-Destination-Address in | | | | | the RP-MO-DATA RPDU. | | | | | | | | | | For MT SMS: | | | | | | | | | | This IE identifies the | | | | | address of the SMSC from | | | | | which the MT short message | | | | | is originating. It shall | | | | | be retrieved from the | | | | | RP-Originating-Address in | | | | | the RP-MT-DATA RPDU. | +----------------------------+----+----+----------------------------+ | SMS Reference Number | M | M | This IE carries the SMS | | | | | Reference Number. This | | | | | Reference Number is | | | | | allocated by the MSC or | | | | | SGSN that processes the | | | | | Short Message. It may be | | | | | used by the gsmSCF for | | | | | inclusion in a gsmSCF SMS | | | | | record. | +----------------------------+----+----+----------------------------+ | MSC Address | S | S | This IE carries the E.164 | | | | | MSC Address. This IE shall | | | | | be present if the Short | | | | | Message processing takes | | | | | place in an MSC. Otherwise | | | | | shall be absent. | +----------------------------+----+----+----------------------------+ | SGSN Number | S | S | This IE carries the Global | | | | | Title of the SGSN. See | | | | | 3GPP TS 23.060 [15]. | | | | | This IE shall be present | | | | | if the Short Message | | | | | processing takes place in | | | | | an SGSN. Otherwise shall | | | | | be absent. | +----------------------------+----+----+----------------------------+ | GPRS MS Class | C | - | This IE contains the MS | | | | | network and radio access | | | | | capabilities if the short | | | | | message is being | | | | | transferred through an | | | | | SGSN. | +----------------------------+----+----+----------------------------+ | MS Classmark 2 | C | - | This IE contains the MS | | | | | classmark 2 if the short | | | | | message is being | | | | | transferred through an | | | | | MSC. | +----------------------------+----+----+----------------------------+ | IMEI (with software | C | - | This IE contains the | | version) | | | IMEISV (as defined in 3GPP | | | | | TS 23.003 [7]) of the ME | | | | | in use by the served | | | | | subscriber. | +----------------------------+----+----+----------------------------+ | Note: Refer to 3GPP | | | | | TS 23.040 [14] for a | | | | | description and encoding | | | | | of the various TP-DUs and | | | | | RP-DUs. | | | | +----------------------------+----+----+----------------------------+
Location Information in MSC is based on the Location Information IE defined in
3GPP TS 23.018 [12]. The following differences apply:
+---------------------------+-----+-----+---------------------------+ | Information element name | MO | MT | Description | +---------------------------+-----+-----+---------------------------+ | Service area ID | C,E | C,E | See 3GPP | | | | | TS 23.018 [12]. | +---------------------------+-----+-----+---------------------------+ | Cell ID | C,E | C,E | See 3GPP | | | | | TS 23.018 [12]. | +---------------------------+-----+-----+---------------------------+ | Location area ID | C,E | C,E | See 3GPP | | | | | TS 23.018 [12]. | +---------------------------+-----+-----+---------------------------+ | VLR number | M | M | See 3GPP | | | | | TS 23.018 [12]. | +---------------------------+-----+-----+---------------------------+ | Age of location | - | M | See 3GPP | | information | | | TS 23.018 [12]. | +---------------------------+-----+-----+---------------------------+ | Current Location | - | - | Not applicable | | Retrieved | | | | +---------------------------+-----+-----+---------------------------+ | Selected LSA Identity | S | S | This IE is applicable | | | | | only if SoLSA is | | | | | supported by the MSC. | | | | | | | | | | This IE indicates the LSA | | | | | identity associated with | | | | | the current position of | | | | | the MS. It shall be shall | | | | | be present if the LSA ID | | | | | in the subscriber data | | | | | matches the LSA ID of the | | | | | current cell. In the case | | | | | of multiple matches the | | | | | LSA ID with the highest | | | | | priority shall be | | | | | present. See 3GPP | | | | | TS 23.073 [18]. | +---------------------------+-----+-----+---------------------------+ | User CSG Information | C | C | See 3GPP TS 23.060 | | | | | [15]. | +---------------------------+-----+-----+---------------------------+ | E-UTRAN Cell ID | C,E | C,E | See 3GPP | | | | | TS 23.018 [12]. | +---------------------------+-----+-----+---------------------------+ | Tracking area ID | C,E | C,E | See 3GPP | | | | | TS 23.018 [12]. | +---------------------------+-----+-----+---------------------------+
Location Information in SGSN is based on the Location Information For GPRS IE
defined in the subclause 11.3.6.1.2. The following differences and
clarifications apply:
* * *
Information element name MO MT Description Service area ID C,E C,E See 3GPP TS
23.018 [12]. Cell ID C,E C,E See 3GPP TS 23.018 [12]. Location area ID C,E C,E
See 3GPP TS 23.018 [12]. Routeing area ID C C See 3GPP TS 23.003 [7].
Geographical information C C See 3GPP TS 23.032 [13]. Geodetic information - -
Not applicable Age of location information - - Not applicable Current Location
Retrieved - - Not applicable User CSG Information C C See 3GPP TS 23.060 [15].
* * *
### 7.6.2 gsmSCF to gsmSSF or gprsSSF information flows
#### 7.6.2.1 Connect SMS
##### 7.6.2.1.1 Description
This IF is used to request the gsmSSF or gprsSSF to perform the actions to
route the Short Message to a specific destination (for MO SMS) or to deliver
the Short Message to the MS (for MT SMS).
##### 7.6.2.1.2 Information Elements
+----------------------------+----+----+----------------------------+ | Information element name | MO | MT | Description | +----------------------------+----+----+----------------------------+ | Calling Partys Number | O | O | This IE indicates the | | | | | subscriber who sent the | | | | | SMS; possibly changed by | | | | | the gsmSCF. | | | | | | | | | | If the Short Message type | | | | | is SMS-SUBMIT or | | | | | SMS-COMMAND, then this IE, | | | | | if present, it shall | | | | | replace the | | | | | RP-Originating-Address in | | | | | the RP-MO-DATA RPDU | | | | | (CHOICE set to MSISDN). | | | | | | | | | | If the Short Message type | | | | | is SMS-DELIVER, then this | | | | | IE, if present, shall | | | | | replace the | | | | | TP-Originating-Address in | | | | | the SMS-DELIVER TPDU. | | | | | | | | | | If the Short Message type | | | | | is SMS-STATUS-REPORT, then | | | | | this IE, if present, shall | | | | | be ignored. | +----------------------------+----+----+----------------------------+ | Destination Subscriber | O | - | This IE identifies the | | Number | | | Destination short message | | | | | entity; possibly changed | | | | | by the gsmSCF. | | | | | | | | | | This IE, if present, shall | | | | | replace the | | | | | TP-Destination-Address in | | | | | the SMS-SUBMIT TPDU or | | | | | SMS-COMMAND-TPDU. | +----------------------------+----+----+----------------------------+ | SMSC Address | O | - | This IE indicates the SMSC | | | | | address to which the MO | | | | | short message shall be | | | | | submitted; possibly | | | | | changed by the gsmSCF. | | | | | | | | | | This IE, if present, shall | | | | | replace the | | | | | RP-Destination-Address in | | | | | the RP-MO-DATA RPDU | | | | | (CHOICE set to | | | | | serviceCentreAddressDA). | +----------------------------+----+----+----------------------------+
#### 7.6.2.2 Continue SMS
##### 7.6.2.2.1 Description
This information flow requests the gsmSSF or gprsSSF to proceed normally. The
gsmSSF or gprsSSF completes DP processing, and continues with the SMS
handling.
##### 7.6.2.2.2 Information Elements
This IF contains no information elements.
#### 7.6.2.3 Furnish Charging Information SMS
##### 7.6.2.3.1 Description
This IF is used to request the gsmSSF or gprsSSF to include information in the
CAMEL specific logical MO SMS or MT SMS record.
The logical call record is created when FCI-SMS is received and a logical call
record for that short message does not exist. For modelling purposes the
logical call record is buffered in the gsmSSF or gprsSSF. The gsmSSF or
gprsSSF completes logical call records as defined in the SDLs. Once the
logical call record is completed, then its free format data are moved to the
corresponding CDR and the logical call record is deleted.
The gsmSCF can send multiple concatenated FCIs per Short Message for
completion. The total maximum of free format data is 160 octets per SM. The
160 octets may be sent in one or more FCI IFs. If there are incomplete free
format data and new FCI IFs is/are received to overwrite the incomplete data,
then the incomplete data are discarded and the gsmSCF can send another 160
octets per SM.
##### 7.6.2.3.2 Information Elements
* * *
Information element name MO MT Description FCI Billing Charging
Characteristics M M This IE is described in a table below.
* * *
FCI Billing Charging Characteristics contains the following information
element:
* * *
Information element name MO MT Description FCIBCCCAMEL Sequence 1 M M This IE
is described in a table below.
* * *
FCIBCCCAMEL Sequence 1 contains the following information elements:
+--------------------------+----+----+----------------------------+ | Information element name | MO | MT | Description | +--------------------------+----+----+----------------------------+ | Free Format Data | M | M | This IE contains free | | | | | format data to be inserted | | | | | in the CAMEL logical call | | | | | record. | +--------------------------+----+----+----------------------------+ | Append Free Format Data | O | O | This IE indicates that the | | | | | gsmSSF or gprsSSF shall | | | | | append the free format | | | | | data to the Logical MO SMS | | | | | or MT SMS record. | | | | | | | | | | - If this IE is present | | | | | indicating \"Append\", the | | | | | gsmSSF or gprsSSF shall | | | | | append the free format | | | | | data received in this IF | | | | | to the free format data | | | | | already present in the | | | | | Logical MO SMS or MT SMS | | | | | record. | | | | | | | | | | - If this IE is absent or | | | | | indicates \"Overwrite\", | | | | | then the gsmSSF shall | | | | | overwrite all free format | | | | | data already present in | | | | | the Logical MO SMS or MT | | | | | SMS record, by the free | | | | | format data received in | | | | | this IF. | | | | | | | | | | If no Logical MO SMS or MT | | | | | SMS record exists yet, | | | | | then the gsmSSF or gprsSSF | | | | | shall ignore this IE. | +--------------------------+----+----+----------------------------+
#### 7.6.2.4 Release SMS
##### 7.6.2.4.1 Description
This IF is used to tear down by the gsmSCF an existing SMS transfer.
##### 7.6.2.4.2 Information Elements
+--------------------------+----+----+----------------------------+ | Information element name | MO | MT | Description | +--------------------------+----+----+----------------------------+ | RP Cause | M | M | SMS Cause. Indicates the | | | | | SMS specific cause of the | | | | | release. The cause is | | | | | reported to the MS (in the | | | | | case of MO SMS) or SMSC | | | | | (in the case of MT SMS). | | | | | | | | | | For MO SMS, the RP Cause | | | | | value shall be used to set | | | | | the RP-Cause in the | | | | | RP-ERROR RPDU sent to the | | | | | MS. 3GPP TS 24.011 [31] | | | | | specifies which RP-Cause | | | | | values may be sent to the | | | | | MS. | | | | | | | | | | For MT SMS, the RP Cause | | | | | value shall be used to set | | | | | the RP-Cause in the | | | | | RP-ERROR RPDU sent to the | | | | | SMSC. 3GPP | | | | | TS 29.002 [34] specifies | | | | | which RP-Cause values may | | | | | be sent to the SMSC. | +--------------------------+----+----+----------------------------+
#### 7.6.2.5 Request Report SMS Event
##### 7.6.2.5.1 Description
This IF is used to request the gsmSSF or gprsSSF to monitor for an event and
to send a notification to the gsmSCF when the event is detected (see Event
Report SMS IF).
##### 7.6.2.5.2 Information Elements
* * *
Information element name MO MT Description SMS Event M M This IE specifies the
event or events of which a report is requested.
* * *
SMS Event contains the following information elements:
* * *
Information element name MO MT Description Event Type M M This IE specifies
the type of event of which a report is requested. Monitor Mode M M This IE
indicates how the event shall be reported.
* * *
#### 7.6.2.6 Reset Timer SMS
##### 7.6.2.6.1 Description
This IF is used to refresh a gsmSSF or gprsSSF timer.
##### 7.6.2.6.2 Information Elements
* * *
Information element name MO MT Description Timer Value M M This IE specifies
the value to which the indicated timer shall be set. Timer ID O O This IE
indicates which timer shall be reset. It shall be set to \'Tssf\'.
* * *
### 7.6.3 HLR to VLR or SGSN information flows
#### 7.6.3.1 Delete Subscriber Data
##### 7.6.3.1.1 Description
This IF is used by the HLR to delete CAMEL subscription data from a VLR or
SGSN. It is specified in 3GPP TS 29.002 [34]
##### 7.6.3.1.2 Information Elements
The Delete Subscriber Data IF contains the following CAMEL specific
information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | CAMEL Subscription Info | O | This IE identifies that all | | Withdraw | | CSIs shall be deleted from | | | | the subscriber data in VLR | | | | or SGSN. | +-----------------------------+--------+-----------------------------+ | Specific CSI Withdraw | O | This IE is used to indicate | | | | that only MO‑SMS‑CSI or | | | | MT‑SMS‑CSI shall be deleted | | | | from the VLR or SGSN. | | | | | | | | This IE should not be | | | | present when CAMEL | | | | Subscription Info Withdraw | | | | is present. | +-----------------------------+--------+-----------------------------+
#### 7.6.3.2 Insert Subscriber Data
##### 7.6.3.2.1 Description
This IF is used by the HLR to insert subscriber data in the VLR or SGSN. It is
specified in 3GPP TS 29.002 [34].
##### 7.6.3.2.2 Information Elements
The Insert Subscriber Data contains the following CAMEL specific information
elements:
* * *
Information element name Status Description MO‑SMS‑CSI O This IE identifies
the subscriber as having MO SMS CAMEL services. MT‑SMS‑CSI O This IE
identifies the subscriber as having MT SMS CAMEL services.
* * *
MO‑SMS‑CSI contains the following information elements:
+---------------------------+--------+-----------------------------+ | Information element name | Status | Description | +---------------------------+--------+-----------------------------+ | gsmSCF Address | M | See subclause 7.3.1.1. | +---------------------------+--------+-----------------------------+ | Service Key | M | See subclause 7.3.1.2. | +---------------------------+--------+-----------------------------+ | Default SMS Handling | M | See subclause 7.3.1.3. | +---------------------------+--------+-----------------------------+ | CAMEL Capability Handling | M | See subclause 7.3.1.5. | +---------------------------+--------+-----------------------------+ | SMS Triggers | M | See subclause 7.3.1.4. | | | | | | | | It includes the following | | | | trigger: | | | | SMS_Collected_Info | +---------------------------+--------+-----------------------------+
MT‑SMS‑CSI contains the following information elements:
+---------------------------+--------+-----------------------------+ | Information element name | Status | Description | +---------------------------+--------+-----------------------------+ | gsmSCF Address | M | See subclause 7.3.2.1. | +---------------------------+--------+-----------------------------+ | Service Key | M | See subclause 7.3.2.2. | +---------------------------+--------+-----------------------------+ | Default SMS Handling | M | See subclause 7.3.2.3. | +---------------------------+--------+-----------------------------+ | CAMEL Capability Handling | M | See subclause 7.3.2.6. | +---------------------------+--------+-----------------------------+ | SMS Triggers | M | See subclause 7.3.2.4. | | | | | | | | It includes the following | | | | trigger: | | | | SMS_Delivery_Request. | +---------------------------+--------+-----------------------------+ | SMS Trigger Criteria | C | See subclause 7.3.2.5. | +---------------------------+--------+-----------------------------+
### 7.6.4 VLR or SGSN to HLR information flows
#### 7.6.4.1 Insert Subscriber Data ack
See subclause 4.6.8.1. This information flow is sent by the VLR.
#### 7.6.4.2 Update Location
See subclause 4.6.8.3.
#### 7.6.4.3 Update GPRS Location
##### 7.6.4.3.1 Description
This IF is used by the SGSN to indicate to the HLR the CAMEL phases and CAMEL
phase 4 CSIs offered by the SGSN. It is specified in 3GPP TS 29.002 [34].
##### 7.6.4.3.2 Information Elements
Update GPRS location contains the following CAMEL specific information
element:
* * *
Information element name Status Description Supported CAMEL Phases S This IE
indicates which CAMEL phases are supported by the SGSN. The SGSN may indicate
support of CAMEL phase 3 or higher. It shall be present when the SGSN supports
CAMEL. Offered CAMEL4 CSIs S This IE indicates the CAMEL phase 4 CSIs offered
in the SGSN. It shall be present if the \"Supported CAMEL Phases\" IE contains
support of CAMEL phase 4.
* * *
Offered CAMEL4 CSIs contains the following information elements:
* * *
Information element name Status Description MT‑SMS‑CSI S This IE indicates the
offer of CAMEL phase 4 MT‑SMS‑CSI
* * *
### 7.6.5 VLR to MSC Information Flows
#### 7.6.5.1 Continue CAMEL SMS Handling
##### 7.6.5.1.1 Description
This IF is used to instruct the MSC to continue the CAMEL specific handling.
##### 7.6.5.1.2 Information Elements
* * *
Information element name Status Description MT‑SMS‑CSI M This IE contains the
CAMEL Subscription Information for MT SMS. IMSI M IMSI of the served
subscriber. MSISDN M MSISDN of the served subscriber.
* * *
#### 7.6.5.2 Send Info For MO SMS ack
##### 7.6.5.2.1 Description
This IF is used to transport MO SMS related subscription data from the VLR to
the MSC. It is specified in 3GPP TS 29.002 [34].
##### 7.6.5.2.2 Information Elements
* * *
Information element name Status Description MO‑SMS‑CSI C This IE contains the
CAMEL Subscription Information for MO SMS. ODB Data C This IE contains ODB
data. This information is used to apply ODB for a reconnected Short Message,
if needed. CB SS Data C This IE contains CB SS data. This information is used
to apply CB for a reconnected Short Message, if needed.
* * *
### 7.6.6 MSC to VLR Information Flows
#### 7.6.6.1 Send Info For MT SMS
##### 7.6.6.1.1 Description
This IF is described in 3GPP TS 29.002 [34]; it is used to request the VLR to
provide information to handle an MT SMS.
##### 7.6.6.1.2 Information Elements
Send Info For MT SMS contains the following CAMEL specific information
element:
* * *
Information element name Status Description Suppress MT‑SMS‑CSI S This IE
indicates to the VLR that it shall not return MT‑SMS‑CSI to the MSC. This IE
shall not be present in the first interrogation; it shall be present in the
second interrogation.
* * *
# 8 SS Notifications
## 8.1 Architecture
### 8.1.1 Functional Entities used for CAMEL
This subclause describes the functional architecture needed to support
Supplementary Service (SS) Notifications. Figure 8.1 shows the functional
entities involved in sending SS Notifications. The architecture is applicable
to the third phase of CAMEL or higher.
{width="5.766666666666667in" height="2.1951388888888888in"}
Figure 8.1: Functional architecture for support of SS Notifications
**HLR:** For subscribers requiring CAMEL support, the HLR stores the
information relevant to the current subscription regarding SS‑CSI. The SS‑CSI
is sent to the VLR at Location Update, on Data Restoration or if the SS‑CSI is
updated by administrative action. When processing an invocation of the CCBS
supplementary service, the HLR shall send a notification of the invocation of
the supplementary service to the gsmSCF if required by the SS‑CSI.
**MSC:** When processing an invocation of any of the supplementary services
ECT, CD and MPTY, the MSC may receive an SS‑CSI from the VLR, indicating that
a notification of the invocation of the supplementary service shall be sent to
the gsmSCF.
**VLR:** The VLR stores the SS‑CSI as a part of the subscriber data for
subscribers roaming in the VLR area.
**gsmSCF:** The gsmSCF receives the SS Invocation Notification from the MSC or
HLR.
### 8.1.2 Interfaces defined for SS Notifications
This subclause describes the different interfaces applicable to SS
Notifications. It specifies on a high level the functions specific to SS
Notifications.
#### 8.1.2.1 MSC - gsmSCF interface
This interface is used by the MSC to send supplementary service invocation
notifications to the gsmSCF. The SS invocations that can be notified to the
gsmSCF via this interface are Call Deflection (CD), Explicit Call Transfer
(ECT) and Multi Party (MPTY).
#### 8.1.2.2 HLR - gsmSCF interface
This interface is used by the HLR to send supplementary service invocation
notifications to the gsmSCF. The SS invocation that can be notified to the
gsmSCF via this interface is Call Completion to Busy Subscriber (CCBS).
#### 8.1.2.3 VLR - MSC interface
This interface is used by the VLR to transfer SS‑CSI to the MSC.
#### 8.1.2.4 HLR-VLR interface
This interface is used by the HLR to send the SS‑CSI to the VLR or to remove
SS‑CSI from the VLR.
## 8.2 Description of CAMEL Subscriber Data
### 8.2.1 Supplementary Service Invocation Notification CAMEL Subscription
Information (SS‑CSI)
This subclause defines the contents of the Supplementary Service Invocation
Notification CAMEL Subscription Information (SS‑CSI).
#### 8.2.1.1 Notification criteria
This data indicates for which supplementary services notifications shall be
sent. The supplementary services which may be indicated are ECT, CD, CCBS and
MPTY.
#### 8.2.1.2 gsmSCF address
Address to be used to access the gsmSCF for a particular subscriber. The
address shall be an E.164 number to be used for routeing.
#### 8.2.1.3 CSI state
The CSI state indicates whether the SS‑CSI is active or not.
#### 8.2.1.4 Notification flag
The notification flag indicates whether the change of the SS‑CSI shall trigger
Notification on Change of Subscriber Data or not.
### 8.2.2 gsmSCF address list for CSI
The gsmSCF address list indicates a list of gsmSCF addresses to which
Notification on Change of Subscriber Data is to be sent. This list is common
to all CSI.
## 8.3 Procedures for CAMEL
### 8.3.1 Handling of Supplementary Service Invocation Notification
At the invocation of any of the services ECT, CD and MPTY the VLR checks
whether the criteria for sending a notification are fulfilled, i.e. whether
the subscriber is provisioned with the SS‑CSI and the particular invoked
supplementary service is marked in the SS‑CSI. If this is the case a
notification is sent to the gsmSCF given by the gsmSCF address contained in
the SS‑CSI. The processing of the particular SS invocation is not suspended.
If the notification criteria are not fulfilled the processing of the
particular supplementary service continues unchanged and no notification is
sent.
The sending of the notification is independent of call related CAMEL
processing, i.e. processing indicated by O/D/T/VT‑CSI.
On invocation of ECT, the VLR shall include the SS‑CSI in the Invoke ECT
response message (see Process MAF027 in 3GPP TS 23.091 [25]) to the MSC if
applicable for ECT.
On invocation of MPTY, the VLR shall include the SS‑CSI in the Process MPTY
message (see Process MPTY_MAF026 in 3GPP TS 23.084 [21]) to the MSC if
applicable for MPTY.
On invocation of CD, the VLR shall include the SS‑CSI in the Send Info For
Incoming Call ack information flow to the MSC if applicable to CD (see 3GPP TS
23.072 [16]).
When a subscriber activates a CCBS request, the HLR checks whether the
criteria for sending a notification are fulfilled, i.e. whether
\- The subscriber is provisioned with an active SS‑CSI, and
\- CCBS is marked in the SS‑CSI.
If the criteria are fulfilled, a notification is immediately sent to the
gsmSCF given by the gsmSCF address contained in the SS‑CSI and the processing
of the CCBS request continues. Whenever the state of the CCBS request changes
(see 3GPP TS 23.093 [26]), an additional notification is immediately sent to
the gsmSCF and the processing of the CCBS request continues.
If the criteria are not fulfilled, the processing of the CCBS request
continues unchanged and no notifications are sent.
At the invocation of the CCBS supplementary service, the HLR checks whether
the criteria for sending a notification are fulfilled, i.e. whether the
subscriber is provisioned with the SS‑CSI and the particular invoked
supplementary service is marked in the SS‑CSI. If this is the case, a
notification is sent to the gsmSCF given by the gsmSCF address contained in
the SS‑CSI. The processing of the SS invocation is not suspended. If the
notification criteria are not fulfilled the processing of the particular
supplementary service continues unchanged and no notification are sent.
## 8.4 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for notification of Supplementary Service invocation.
Each Information Element (IE) is marked as Mandatory (M), Specific conditions
(S) or Optional (O) in the \"Status\" column.
An \'M\' IE shall always be included. The conditions for the inclusion of an
\'S\' IE are shown in the \'Description\' column of the definition table. An
\'O\' IE may be included or omitted as required by the service logic. This
categorization is a functional classification, i.e. it defines the
requirements for the stage 2 information. It is not a stage 3 classification
to be used for the ASN.1 syntax of the protocol.
The following principles apply for the handling of the IEs by the receiving
entity:
\- The gsmSCF may silently discard any IE which it does not functionally
support.
Details of errors and exceptions to these rules are specified in are specified
in 3GPP TS 29.002 [34].
### 8.4.1 MSC to gsmSCF information flows
#### 8.4.1.1 SS Invocation Notification
##### 8.4.1.1.1 Description
This IF is generated by the MSC when it shall notify the gsmSCF of a
supplementary service invocation.
##### 8.4.1.1.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Notification Event | M | This IE indicates the | | | | supplementary service | | | | invocation, resulting in | | | | the SS Invocation | | | | Notification IF. Only the | | | | following supplementary | | | | services are allowed: | | | | Explicit Call Transfer, | | | | Call Deflection, Multi | | | | Party. | +-----------------------------+--------+-----------------------------+ | Notification Event Specific | S | In the case of ECT, the | | Information | | sending entity shall | | | | include the called party | | | | for each call originated by | | | | the subscriber and relevant | | | | to the ECT invocation. | | | | Note: the subscriber may | | | | have originated zero, one | | | | or two calls relevant to | | | | the ECT service. | | | | | | | | In the case of CD, the | | | | deflected to number shall | | | | be included in this IE. | | | | | | | | In the case of MPTY, this | | | | IE shall be omitted. | +-----------------------------+--------+-----------------------------+ | IMSI | M | This IE identifies the | | | | mobile subscriber who has | | | | invoked the supplementary | | | | service to be notified. | +-----------------------------+--------+-----------------------------+ | MSISDN | M | This IE identifies the | | | | mobile subscriber who has | | | | invoked the supplementary | | | | service to be notified. | +-----------------------------+--------+-----------------------------+
### 8.4.2 HLR to VLR information flows
#### 8.4.2.1 Delete Subscriber Data
##### 8.4.2.1.1 Description
This IF is used by the HLR to delete CAMEL subscription data from a VLR. Ii is
specified in 3GPP TS 29.002 [34].
##### 8.4.2.1.2 Information Elements
The Delete Subscriber Data IF contains the following CAMEL specific
information elements for SS Notifications:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | CAMEL Subscription Info | O | This IE identifies that all | | Withdraw | | CSIs shall be deleted from | | | | the subscriber data in the | | | | VLR. | +-----------------------------+--------+-----------------------------+ | Specific CSI Withdraw | O | This IE is used to indicate | | | | that only SS‑CSI shall be | | | | deleted from the VLR. | | | | | | | | This IE should not be | | | | present when CAMEL | | | | Subscription Info Withdraw | | | | is present. | +-----------------------------+--------+-----------------------------+
#### 8.4.2.2 Insert Subscriber Data
##### 8.4.2.2.1 Description
This IF is used by an HLR to update a VLR with certain subscriber data. This
IF is specified in 3GPP TS 29.002 [34].
##### 8.4.2.2.2 Information Elements
The Insert Subscriber Data contains the following CAMEL specific information
element for SS Notifications:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS‑CSI | O | This IE is described in | | | | subclause 8.2.1. | | | | | | | | This IE identifies the | | | | subscriber as having | | | | supplementary service | | | | invocation notification | | | | services. It contains the | | | | Notification Criteria and | | | | gsmSCFAddress. | | | | | | | | When SS‑CSI is sent to the | | | | VLR, it shall not contain a | | | | marking for CCBS. | +--------------------------+--------+-----------------------------+
### 8.4.3 HLR to gsmSCF information flows
#### 8.4.3.1 SS Invocation Notification
This IF is generated by the HLR when it shall notify the gsmSCF of a
supplementary service invocation.
##### 8.4.3.1.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Notification Event | M | This IE indicates the | | | | supplementary service | | | | invocation, resulting in | | | | the SS Invocation | | | | Notification IF. | | | | | | | | Only the following | | | | supplementary services are | | | | allowed: Completion of | | | | Calls to Busy Subscriber | +--------------------------+--------+-----------------------------+ | IMSI | M | This IE identifies the | | | | mobile subscriber who has | | | | invoked the supplementary | | | | service to be notified. | +--------------------------+--------+-----------------------------+ | MSISDN | M | This IE identifies the | | | | mobile subscriber who has | | | | invoked the supplementary | | | | service to be notified. | +--------------------------+--------+-----------------------------+ | B-Number | M | This IE indicates the | | | | destination address of the | | | | CCBS request. | +--------------------------+--------+-----------------------------+ | CCBS Request State | M | This IE identifies the | | | | current state of the CCBS | | | | request. It can be one of: | | | | | | | | - Request; | | | | | | | | - Recall; | | | | | | | | - Active; | | | | | | | | - Completed; | | | | | | | | - Suspended; | | | | | | | | - Frozen; | | | | | | | | - Deleted. | +--------------------------+--------+-----------------------------+
### 8.4.4 VLR to MSC information flows
#### 8.4.4.1 Invoke SS result
##### 8.4.4.1.1 Description
This IF is used by the VLR to send SS‑CSI to the MSC. This IF is specified in
3GPP TS 29.002 [34].
##### 8.4.4.1.2 Information Elements
The Invoke SS result contains the following CAMEL specific information element
for SS Notifications:
* * *
Information element name Status Description SS‑CSI C This IE is included when
it is available in the VLR and either ECT or MPTY has been successfully
invoked and that supplementary service has been marked for notification.
* * *
#### 8.4.4.2 Send Info For Incoming Call ack
##### 8.4.4.2.1 Description
This IF is used by the VLR to send SS‑CSI to the MSC. This IF is specified in
3GPP TS 23.018 [12].
##### 8.4.4.2.2 Information Elements
The Send Info For Incoming Call ack contains the following CAMEL specific
information elements for SS Notifications:
* * *
Information element name Status Description SS‑CSI S This IE is included when
it is available in the VLR and CD has been successfully invoked and that
supplementary service has been marked for notification.
* * *
# 9 Mobility Management
## 9.1 Architecture
### 9.1.1 Functional Entities used for CAMEL
This subclause describes the functional architecture required to support
Mobility Management in CAMEL. Figures 9.1-1 and 9.1-2 show the functional
entities involved in CAMEL support of Mobility Management. The architecture in
the figure 9.1-1 is applicable to the third phase of CAMEL or higher and the
architecture in the figure 9.1-2 is applicable to the fourth phase of CAMEL.
{width="3.845833333333333in" height="2.5555555555555554in"}
Figure 9.1-1: Functional architecture for CS subscriber support of CAMEL
{width="3.845833333333333in" height="2.5555555555555554in"}
Figure 9.1-2: Functional architecture for GPRS subscriber support of CAMEL
**gsmSCF: see subclause 3.1.**
**HLR:** The HLR contains Mobility management CAMEL Subscription Information
(M‑CSI) for those CS subscribers that require CAMEL control of Mobility
Management events and Mobility management GPRS CAMEL Subscription Information
(MG‑CSI) for those GPRS subscribers that require CAMEL control of Mobility
Management events. M‑CSI is sent to the VLR during the Location Update and
Restore Data procedures or when M‑CSI is modified in the HLR. The M‑CSI is
deleted in the VLR with the Delete Subscriber Data procedure. MG‑CSI is sent
to the SGSN during the GPRS Location Updating procedure or when MG‑CSI is
modified in the HLR. The MG‑CSI is deleted in the SGSN with the Delete
Subscriber Data procedure.
**MS:** Mobile Station.
**MSC: see subclause 4.1.**
**VLR:** After having completed a Mobility Management event from a CS
subscriber, the VLR may find it necessary to send a notification to the
gsmSCF. The content of M‑CSI indicates which Mobility Management events shall
be reported to the gsmSCF.
**SGSN:** After having completed a Mobility Management event from a GPRS
subscriber, the SGSN may find it necessary to send a notification to the
gsmSCF. The content of MG‑CSI indicates which Mobility Management events shall
be reported to the gsmSCF.
### 9.1.2 Interfaces defined for CAMEL
This subclause describes the different interfaces applicable to CAMEL control
of Mobility Management events. It specifies on a high level the functions
specific to CAMEL.
#### 9.1.2.2 VLR - gsmSCF interface
This interface is used by the VLR to send Mobility Management event
notifications to the gsmSCF. When processing a mobility management event, the
VLR may find it necessary to send a notification to the gsmSCF, depending on
the presence of M‑CSI for the subscriber and the contents of M‑CSI.
#### 9.1.2.3 SGSN - gsmSCF interface
This interface is used by the SGSN to send Mobility Management event
notifications to the gsmSCF. When processing a mobility management event, the
SGSN may find it necessary to send a notification to the gsmSCF, depending on
the presence of MG‑CSI for the subscriber and the contents of MG‑CSI.
## 9.2 Description of CAMEL Subscriber Data
### 9.2.1 Mobility Management CAMEL Subscription Information (M‑CSI)
This subclause specifies the contents of the Mobility Management CAMEL
Subscription Information (M‑CSI).
#### 9.2.1.1 Mobility Management Triggers
This data indicates which Mobility Management events shall result in a
notification to the gsmSCF. One or more events may be marked per subscriber.
These events are:
\- Location update in the same VLR service area.
\- Location update to another VLR service area.
\- IMSI attach.
\- MS initiated IMSI detach (explicit detach).
\- Network initiated IMSI detach (implicit detach).
#### 9.2.1.2 gsmSCF address
This is the address of the gsmSCF where the Mobility Management event
notification shall be sent to. The gsmSCF address is in E.164 format.
#### 9.2.1.3 Service Key
The Service Key is included in the notification information flow to the
gsmSCF. It indicates to the gsmSCF which Service Logic shall be applied.
#### 9.2.1.4 CSI state
The CSI state indicates whether the M‑CSI is active or not.
#### 9.2.1.5 Notification flag
The notification flag indicates whether the change of the M‑CSI shall trigger
Notification on Change of Subscriber Data or not.
### 9.2.2 Mobility Management for GPRS CAMEL Subscription Information (MG‑CSI)
This subclause specifies the contents of the Mobility Management for GPRS
CAMEL Subscription Information (MG‑CSI).
#### 9.2.2.1 Mobility Management Triggers
This data indicates which Mobility Management events shall result in a
notification to the gsmSCF. One or more events may be marked per subscriber.
These events are:
\- Routeing area update of MS to a different SGSN service area (update from
mew SGSN);
\- Routeing area update of MS to a different SGSN service area (disconnect by
detach);
\- Routeing area update of MS within the same SGSN service area;
\- GPRS attach (e.g. MS switched on, successful routeing area update after
network initiated transfer to \"MS not reachable for paging\");
\- MS-initiated GPRS detach (e.g. MS switched off);
\- Network-initiated GPRS detach.
\- Network-initiated transfer to the \"not reachable for paging\" state (the
network has not received a periodic routeing area update from the MS and
assumes that the MS is unreachable).
#### 9.2.2.2 gsmSCF address
This is the address of the gsmSCF where the Mobility Management event
notification shall be sent to. The gsmSCF address is in E.164 format.
#### 9.2.2.3 Service Key
The Service Key is included in the notification information flow to the
gsmSCF. It indicates to the gsmSCF which Service Logic shall be applied.
#### 9.2.2.4 CSI state
The CSI state indicates whether the MG‑CSI is active or not.
#### 9.2.2.5 Notification flag
The notification flag indicates whether the change of the MG‑CSI shall trigger
Notification on Change of Subscriber Data or not.
### 9.2.3 gsmSCF address list for CSI
The gsmSCF address list indicates the gsmSCF addresses to which Notification
on Change of Subscriber Data shall be sent. This list is common to all CSI.
## 9.3 Procedures for Mobility management
### 9.3.1 Procedures for Mobility management for CS subscriber
The different procedures for Mobility Management are shown in Figures 9.2-1 to
9.2-5.
Figure 9.2-1: Location Update within a single VLR Service Area. (The VLR
Service area may be in the HPLMN or in the VPLMN.);
Figure 9.2-2: Location Update from one VLR Service Area to another VLR Service
Area. (Both VLR Service Areas are in the HPLMN or in the same VPLMN.);
Figure 9.2-3: Location Update from one PLMN to another PLMN;
\- update from HPLMN to VPLMN;
\- update from VPLMN to HPLMN;
\- update from one VPLMN to another VPLMN.
Figure 9.2-4: IMSI Detach (in HPLMN or in VPLMN);
\- explicit detach (the MS has been switched off by the subscriber);
\- implicit detach (the network has not received a periodic paging update from
the MS and assumes that the MS is switched off or unreachable).
Figure 9.2-5: IMSI Attach (in HPLMN or in VPLMN);
\- attach (the MS has been switched on by the subscriber - subscription data
is still available in the VLR, no location update is needed).
{width="3.9451388888888888in" height="2.027083333333333in"}
Figure 9.2-1: Location Update within a single VLR Service Area
{width="5.139583333333333in" height="1.94375in"}
Figure 9.2-2: Location Update from one VLR Service Area to another VLR Service
Area
{width="5.139583333333333in" height="1.94375in"}
Figure 9.2-3: Location Update from one PLMN to another PLMN
{width="3.80625in" height="2.19375in"}
Figure 9.2-4: IMSI Detach (implicit/explicit)
{width="3.917361111111111in" height="2.027083333333333in"}
Figure 9.2-5: IMSI Attach
When a Mobility Management Event has taken place and the processing has been
completed, then the VLR may find it necessary to send a notification to the
gsmSCF. The processing of the Mobility Management event in the VLR is not
suspended by the sending of the notification nor is it in any way affected by
the notification.
The sending of a Mobility Management notification to gsmSCF is independent of
other CAMEL subscription data for a subscriber. E.g. a subscriber may have
M‑CSI without O‑CSI or VT‑CSI.
The sending of a Mobility Management event notification is subscription based.
Refer to subclause 9.2.1 for a description of M‑CSI and the different Mobility
Management events that may lead to a notification to the gsmSCF.
#### 9.3.1.1 Procedure descriptions
##### 9.3.1.1.1 Procedure Set_Notification_Type
This procedure is called from process Update_Location_VLR in 3GPP TS 23.012
[10]. It checks the information element \'Location Update Type\', which the
VLR receives from the MSC via MAP_UPDATE_LOCATION_AREA service. This element
identifies the type of Location Update requested by the mobile station.
The possible values of this parameter are specified in 3GPP TS 24.008 [30].
The type of Location Update that was requested by the mobile station
determines which Mobility Management notification information flow shall be
sent to the gsmSCF.
The values \'Periodic Updating\' and \'Reserved\' shall not lead to a Mobility
Management notification to the gsmSCF.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 9.-1a: Procedure Set_Notification_Type (sheet 1)
##### 9.3.1.1.2 Procedure Notify_gsmSCF
This procedure is called from the process \'Update_Location_Area_VLR\' and
process \'Detach_IMSI_VLR\' in 3GPP TS 23.012 [10]. It is also called from the
process \'Update_Location_VLR\' in 3GPP TS 29.002 [34].
The calling process passes on the variable \'Notify\' to the procedure
\'Notify_gsmSCF\'. This variable indicates which Mobility Management
notification may be necessary to be sent to the gsmSCF. If this variable has a
value NULL, then no notification shall be sent to the gsmSCF.
If a notification may be necessary to be sent to the gsmSCF, then the
procedure checks the presence of M‑CSI.
\- If M‑CSI is present and the Mobility Management event indicated in the
variable \'Notify\' is marked in M‑CSI, then a notification shall be sent to
the gsmSCF.
\- If M‑CSI is not present or the Mobility Management event indicated in the
variable \'Notify\' is not marked in M‑CSI, then no notification shall be sent
to the gsmSCF.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 9.3-1: Procedure Notify_gsmSCF (sheet 1)
### 9.3.2 Procedures for Mobility management for GPRS subscriber
The different procedures for Mobility Management are shown in figures 9.4-1 to
9.4-5.
{width="3.9451388888888888in" height="2.0277777777777777in"}
Figure 9.4-1: Routeing Area Update within SGSN Service Area
{width="5.136111111111111in" height="1.917361111111111in"}
Figure 9.4-2: Routeing Area Update from one SGSN Service Area to another SGSN
Service Area
{width="5.136111111111111in" height="1.917361111111111in"}
Figure 9.4-3: Routeing Area Update from one PLMN to another PLMN
{width="3.917361111111111in" height="2.027083333333333in"}
Figure 9.4-4: Attach of MS
{width="3.80625in" height="2.19375in"}
Figure 9.4-5: GPRS detach
When a Mobility Management Event has taken place and the processing has been
completed, then the SGSN may have to send a notification to the gsmSCF.
The sending of a Mobility Management notification to gsmSCF is independent of
other CAMEL subscription data for a subscriber. E.g. a subscriber may have
MG‑CSI without GPRS‑CSI.
The sending of a Mobility Management event notification is subscription based.
Refer to subclause 9.2.2 for a description of MG‑CSI and the different
Mobility Management events that may lead to a notification to the gsmSCF.
#### 9.3.2.1 Procedure CAMEL_PS_Notification
This procedure is called from processes in 3GPP TS 23.060 [15]. When this
procedure is called, it checks the presence of MG‑CSI. If there is no MG‑CSI,
then no notification is sent to the gsmSCF.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 9.5-1: Procedure CAMEL_PS_Notification (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 9.6-1: Procedure Set_PS_Notification_Type (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 9.7-1: Procedure Notify_PS_gsmSCF (sheet 1)
## 9.4 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for Mobility Management control.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Specific conditions (S), mutually Exclusive (E), Optional (O) or not
applicable (-) for each different entity involved: VLR (VLR) and SGSN (SGSN)
where distinction is applicable. If the IEs in one table apply in both VLR and
SGSN, then the IEs are marked in the \"Status\" column.
An \'M\' IE shall always be included. A \'C\' IE shall be included if the
sending entity has the necessary information to populate the IE. The
conditions for the inclusion of an \'S\' IE are shown in the \'Description\'
column of the definition table. When a set of \'E\' IEs is shown in the
definition of an Information Flow or compound IE, only one of those IEs may be
included. An \'O\' IE may be included or omitted as required by the service
logic. A \'‑\' IE shall always be omitted. This categorization is a functional
classification, i.e. it defines the requirements for the stage 2 information.
It is not a stage 3 classification to be used for the ASN.1 syntax of the
protocol.
The following principles apply for the handling of the IEs by the receiving
entity:
\- The gsmSCF may silently discard any IE which it does not functionally
support;
\- The VLR shall functionally support all IEs which can be sent to it;
\- The SGSN shall functionally support all IEs which can be sent to it.
### 9.4.1 VLR or SGSN to gsmSCF information flows
#### 9.4.1.1 Mobility Management event Notification
##### 9.4.1.1.1 Description
This IF is generated by the VLR or SGSN to notify the gsmSCF of a Mobility
Management event.
##### 9.4.1.1.2 Information Elements
+--------------------------+-----+------+--------------------------+ | Information element name | VLR | SGSN | Description | +--------------------------+-----+------+--------------------------+ | Event Met | M | M | This IE indicates the | | | | | type of Mobility | | | | | Management event that | | | | | lead to the | | | | | notification. Refer to | | | | | subclause 9.2.1.1 for | | | | | the CS subscriber and | | | | | subclause 9.2.2.1 for | | | | | the GPRS subscriber. | +--------------------------+-----+------+--------------------------+ | Service Key | M | M | This IE indicates the | | | | | Service Logic that the | | | | | gsmSCF shall apply. | +--------------------------+-----+------+--------------------------+ | IMSI | M | M | This IE identifies the | | | | | mobile subscriber to | | | | | whom the Mobility Event | | | | | applies. | +--------------------------+-----+------+--------------------------+ | Basic MSISDN | M | M | This IE identifies the | | | | | mobile subscriber to | | | | | whom the Mobility Event | | | | | applies. | +--------------------------+-----+------+--------------------------+ | Location Information for | C | - | This IE is described in | | CS subscriber | | | a table below. | | | | | | | | | | This IE indicates the | | | | | current location of the | | | | | MS. | +--------------------------+-----+------+--------------------------+ | Location Information for | - | C | This IE indicates the | | GPRS subscriber | | | current location of the | | | | | MS which is equivalent | | | | | to the location info | | | | | SGSN IE in | | | | | subclause 7.6.1.2. | +--------------------------+-----+------+--------------------------+ | Supported CAMEL Phases | M | M | This IE indicates the | | | | | CAMEL Phases that are | | | | | supported by the sending | | | | | entity (VMSC/VLR or | | | | | SGSN) in which the MS is | | | | | registered after the | | | | | mobility management | | | | | event. | +--------------------------+-----+------+--------------------------+ | Offered CAMEL4 | M | - | This IE is described in | | Functionalities | | | subclause 4.6.1.8. | | | | | | | | | | It indicates the CAMEL | | | | | phase 4 functionalities | | | | | offered by the VMSC/VLR. | +--------------------------+-----+------+--------------------------+
Location Information for CS subscriber is defined in 3GPP TS 23.018 [12]. The
following differences apply:
* * *
Information element name Status Description Service area ID C,E See 3GPP TS
23.018 [12]. Cell ID C,E See 3GPP TS 23.018 [12]. VLR Number M See 3GPP TS
23.018 [12]. Current Location Retrieved - Not applicable Location area ID C,E
See 3GPP TS 23.003 [7]. Selected LSA Identity S This IE indicates the LSA
identity associated with the current position of the MS. It shall be present
if the LSA ID in the subscriber data matches the LSA ID of the current cell.
In the case of multiple matches the LSA ID with the highest priority it shall
be present. See 3GPP TS 23.073 [18]. User CSG Information C See 3GPP TS 23.060
[15]. E-UTRAN Cell ID C,E See 3GPP TS 23.018 [12]. Tracking area ID C,E See
3GPP TS 23.018 [12].
* * *
### 9.4.2 SGSN to HLR information flows
#### 9.4.2.1 Update GPRS Location
See subclause 6.6.4.2.
### 9.4.3 VLR to HLR information flows
#### 9.4.3.1 Update Location
See subclause 4.6.8.3.
#### 9.4.3.2 Restore Data
See subclause 4.6.8.4.
### 9.4.4 HLR to VLR or SGSN information flows
#### 9.4.4.1 Delete Subscriber Data
##### 9.4.4.1.1 Description
This IF is used by an HLR to delete CAMEL subscription data from a VLR or
SGSN. It is specified in 3GPP TS 29.002 [34].
##### 9.4.4.1.2 Information Elements
The Delete Subscriber Data IF contains the following CAMEL specific
information elements for Mobility Management:
* * *
Information element name VLR SGSN Description CAMEL Subscription Info Withdraw
O O This IE identifies that all CSIs shall be deleted from the subscriber data
in VLR or SGSN. Specific CSI Withdraw O O This IE is used to indicate that
only M‑CSI or MG‑CSI shall be deleted from the VLR or SGSN respectively. It
should not be present when CAMEL Subscription Info Withdraw is present.
* * *
#### 9.4.4.2 Insert Subscriber Data
##### 9.4.4.2.1 Description
This IF is used by an HLR to update a VLR or SGSN with certain subscriber
data. This IF is specified in 3GPP TS 29.002 [34].
##### 9.4.4.2.2 Information Elements
Insert Subscriber Data contains the following CAMEL specific information
elements for Mobility Management:
* * *
Information element name VLR SGSN Description M‑CSI O - This IE identifies the
CS subscriber as having mobility management notification services. It contains
the events that shall be reported, the gsmSCF Address and the Service Key.
MG‑CSI - O This IE identifies the GPRS subscriber as having mobility
management notification services. It contains the events that shall be
reported, the gsmSCF Address and the Service Key.
* * *
M‑CSI contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | GsmSCF Address | M | This IE is described in | | | | subclause 9.2.1. | +-----------------------------+--------+-----------------------------+ | Service Key | M | This IE is described in | | | | subclause 9.2.1. | +-----------------------------+--------+-----------------------------+ | Mobility Management | M | This IE indicates which | | Triggers | | Mobility Management events | | | | shall be reported to the | | | | gsmSCF. It shall contain | | | | one or more of the | | | | following elements: | | | | | | | | - Location update in the | | | | same VLR service area | | | | | | | | - Location update to | | | | another VLR service area | | | | | | | | - IMSI attach | | | | | | | | - MS initiated IMSI detach | | | | (explicit detach) | | | | | | | | - Network initiated IMSI | | | | detach (implicit detach) | +-----------------------------+--------+-----------------------------+
MG‑CSI contains the following information elements:
* * *
Information element name Status Description GsmSCF Address M This IE is
described in subclause 9.2.2. Service Key M This IE is described in subclause
9.2.2. Mobility Management Triggers M This IE is described in subclause 9.2.2.
* * *
# 10 Control and interrogation of subscription data
Support of the procedures described in this clause in CAMEL Phase 4 is a
network operator option.
## 10.1 Architecture
### 10.1.1 Functional Entities used for CAMEL
This subclause describes the functional architecture required to support
control and interrogation of subscription data. Figure 10.1 shows the
functional entities involved in CAMEL support of control and interrogation of
subscription data.
{width="5.611805555555556in" height="0.9159722222222222in"}
Figure 10.1: Functional architecture for support of control and interrogation
of subscription data
**gsmSCF: see subclause 3.1.**
**HLR:** The HLR may provide an interface to the gsmSCF for the Any Time
Subscription Interrogation and Any Time Modification procedures. The gsmSCF
may provide an interface to the HLR for the Notify Subscriber Data Change
procedure.
### 10.1.2 Interfaces defined for CAMEL
This subclause describes the interface applicable to CAMEL control of
subscription data. It specifies on a high level the functions specific to
CAMEL.
#### 10.1.2.1 gsmSCF - HLR
This interface is used by the gsmSCF to interrogate or modify information in
the HLR. As a network operator option, the HLR may refuse to provide or modify
the information requested by the gsmSCF. This interface is also used by the
HLR to notify the gsmSCF of a change of subscriber data.
## 10.2 Procedures for CAMEL
### 10.2.1 Any Time Subscription Interrogation
Handling of Any Time Interrogation for Subscription Information Retrieval
involves the following process:
> \- CAMEL_ATSI_HLR.
If an OSS needs the Subscription Information, the gsmSCF initiates a
transaction to the HLR by sending an Any Time Subscription Interrogation
Request.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.2-1: Process CAMEL_ATSI_HLR (sheet 1)
Figure 10.2-2: Process CAMEL_ATSI_HLR (sheet 2)
### 10.2.2 Any Time Modification
Handling of Any Time Modification involves the following process:
> \- CAMEL_ATM_HLR.
The following procedures are involved:
\- ATM_Modify_Data\ This procedure checks which data shall be modified and
calls the appropriate data modification procedure.
\- ATM_Modify_CSI_Data\ If the CSI indicated in the ATM request is not
available in the HLR, then an error is returned.\ Otherwise, the CSI state
and/or Notification-to-CSE flag are set as instructed with the ATM request.
\- ATM_Modify_CF_Data\ When only the SS-code and (optionally) a Basic Service
code are present in the ATM request, then all Call Forwarding data belonging
to this SS code and basic service code is erased, the associated
notificationToCSE flag is unchanged and the SS-Status is amended according to
the state transition model defined in 3GPP TS 23.082 [20].\ Otherwise, the
behaviour is as follows:
\- If a valid SS state is present in the ATM request, then an SS state
transition is performed.
\- If a valid FTN, FTN sub address or No Reply Condition Time is present in
the ATM request, then the indicated variable is modified.
\- Before modification of CF data (SS state changed to \'registered\', insert
or change of FTN), the interaction checks between CF and ODB and between CF
and CB shall be performed as described in 3GPP TS 23.015 [11] and TS 23.082
[20] respectively. The CF data shall only be modified if the changed new CF
data does not conflict with the existing ODB or CB entries.
\- If an instruction to modify the notification-to-CSE flag is present in the
ATM request, then the notification-to-CSE flag is modified.
\- If the modification is partially successful (e.g. succeeds for one Basic
Service but fails for another Basic Service), then the operation is partially
accepted by the HLR. The accepted changes are made in the HLR and the changed
data is sent in the ATM acknowledgement.
\- ATM_Modify_CB_Data\ When only the SS-code and (optionally) a Basic Service
code are present in the ATM request, then all Call Barring belonging to this
SS code and basic service code is deactivated, the associated
notificationToCSE flag is unchanged and the SS-Status is amended according to
the state transition model defined in 3GPP TS 23.088 [23].\ Otherwise, the
behaviour is as follows:
\- If a valid SS state is present in the ATM request, then an SS state
transition is performed.
\- Before modification of CB data (SS state), the interaction checks between
CF and CB shall be performed as described in 3GPP TS 23.088 [23]. The CB data
shall only be modified if the changed new CB data does not conflict with the
existing CF entries.
\- If a valid Password or \'Wrong password attempt counter\' is present in the
ATM request, then the indicated variable is modified.
\- If an instruction to modify the notification-to-CSE flag is present in the
ATM request, then the notification-to-CSE flag is modified.
\- ATM_Modify_ODB_Data
\- If ODB data is not present in the ATM request, then it is assumed that the
ODB data is not modified. When present, the modification is done by
overwriting the existing ODB data.
\- If an instruction to modify the notification-to-CSE flag is present in the
ATM request, then the notification-to-CSE flag is modified.
\- If the modification is partially successful (e.g. succeeds for one Basic
Service but fails for another Basic Service), then the operation is partially
accepted by the HLR. The accepted changes are made in the HLR and the changed
data is sent in the ATM acknowledgement.
\- ATM_Modify_IP-SM-GW_Data
\- If Modification Instruction is \"activate\", the IP-SM-GW address is stored
if not already pre-configured in the HLR and the process
Subscriber_Present_HLR is invoked (see 3GPP TS 23.012 [10]).
\- If Modification Instruction is \"deactivate\" and there is no IP-SM-GW
address pre-configured in the HLR, the stored IP-SM-GW address is deleted.
  * ATM_Modify_CW_Data
```{=html}
``` \- If a valid SS-status is present in the ATM request, then all Call
Waiting state is changed accordingly,
  * If an instruction to modify the notification-to-CSE flag is present in the ATM request, then the notification-to-CSE flag is modified.
```{=html}
``` \- ATM_Modify_CH_Data
```{=html}
``` \- If a valid SS-status is present in the ATM request, then all Call Hold
state is changed accordingly,
  * If an instruction to modify the notification-to-CSE flag is present in the ATM request, then the notification-to-CSE flag is modified.
```{=html}
``` \- ATM_Modify_ECT_Data
```{=html}
``` \- If a valid SS-status is present in the ATM request, then all Explicit
Call Transfer state is changed accordingly,
  * If an instruction to modify the notification-to-CSE flag is present in the ATM request, then the notification-to-CSE flag is modified.
```{=html}
``` \- ATM_Modify_CLIP_Data
```{=html}
``` \- If a valid SS-status is present in the ATM request, then all Calling
Line Identification Presentation state is changed accordingly,
  * If the Override Category is present, the Override Category is change accordingly.
  * If an instruction to modify the notification-to-CSE flag is present in the ATM request, then the notification-to-CSE flag is modified.
```{=html}
``` \- ATM_Modify_CLIR_Data
```{=html}
``` \- If a valid SS-status is present in the ATM request, then all Calling
Line Identification Restriction Waiting state is changed accordingly,
  * If the Override Category is present, the CLIR Restriction Option is change accordingly.
  * If an instruction to modify the notification-to-CSE flag is present in the ATM request, then the notification-to-CSE flag is modified.
After having executed the Any Time Modification instruction from the gsmSCF,
the HLR calls the procedure CAMEL_NSDC_HLR, which sends notifications to
gsmSCF(s), if required.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.3-1: Process CAMEL_ATM_HLR (sheet 1)
Figure 10.4-1: Procedure ATM_Modify_Data (sheet 1)
Figure 10.4-2: Procedure ATM_Modify_Data (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.5-1: Procedure ATM_Modify_CSI_Data (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.6-1: Procedure ATM_Modify_CF_Data (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.6-2: Procedure ATM_Modify_CF_Data (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.7-1: Procedure ATM_Modify_CB_Data (sheet 1)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.7-2: Procedure ATM_Modify_CB_Data (sheet 2)
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.8-1: Procedure ATM_Modify_ODB_Data (sheet 1)
{width="6.691666666666666in" height="8.111805555555556in"}
Figure 10.9-1: Procedure ATM_Modify_IP-SM-GW_Data (sheet 1)
Figure 10.10-1: Procedure ATM_Modify_CH_Data (sheet 1)
Figure 10.11-1: Procedure ATM_Modify_CW_Data (sheet 1)
Figure 10.12-1: Procedure ATM_Modify_ECT_Data (sheet 1)
Figure 10.13-1: Procedure ATM_Modify_CLIP_Data (sheet 1)
Figure 10.14-1: Procedure ATM_Modify_CLIR_Data (sheet 1)
### 10.2.3 Notify Subscriber Data Change
Changes of CSI, Call Forwarding data, Call Barring data, Call Waiting data,
Call Hold data, Explicit Call transfer data, Calling line Identification
Presentation data, Calling line Identification Restriction data or ODB data
shall be notified only if the corresponding data is marked with the
Notification-to-CSE flag.
The HLR maintains a list of gsmSCF address(es) for Call Forwarding Data, Call
Barring Data, ODB, Call Waiting data, Call Hold data, Explicit Call transfer
data, Calling line Identification Presentation data, Calling line
Identification Restriction data and CSI. When any of these items has been
modified, a notification shall be sent to each gsmSCF in the corresponding
list.
The sending of a notification to the gsmSCF may be triggered by the following
processes:
\- subscriber data change by administrative procedure;
\- subscriber data changed by subscriber;
\- subscriber data changed by Any Time Modification request from gsmSCF;
\- subscriber data changed due to a change of other subscriber data;
\- subscriber data change due to Location Update.
When a change of subscriber data is requested by Any Time Modification, Any
Time Modification acknowlegement is returned to the requesting gsmSCF
confirming the status of the altered data. Separate Notifications of
subscriber data change shall also be returned to the requesting gsmSCF for
each other piece of altered data, but these shall not contain the requested
change.
Each gsmSCF shall be notified only once. Multiple occurrence of gsmSCF Address
in these lists shall not lead to multiple notification.
Handling of Notify Subscriber Data Change involves the following procedure:
> \- CAMEL_NSDC_HLR.
If a change of subscriber data needs to be notified to the gsmSCF, then the
HLR initiates a transaction to the gsmSCF by sending Notify Subscriber Data
Change information flow.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 10.9-1: Procedure CAMEL_NSDC_HLR (sheet 1)
## 10.3 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for control and interrogation of subscription data.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Specific conditions (S), mutually Exclusive (E) or Optional (O) in the
\"Status\" column.
An \'M\' IE shall always be included. A \'C\' IE shall be included if the
sending entity has the necessary information to populate the IE. The
conditions for the inclusion of an \'S\' IE are shown in the \'Description\'
column of the definition table. An \'O\' IE may be included or omitted as
required by the service logic. This categorization is a functional
classification, i.e. it defines the requirements for the stage 2 information.
It is not a stage 3 classification to be used for the ASN.1 syntax of the
protocol.
The following principles apply for the handling of the IEs by the receiving
entity:
\- The gsmSCF and the IP-SM-GW may silently discard any IE which it does not
functionally support.
> \- The HLR shall return an error if it does not functionally support an IE
> which it receives.
Details of errors and exceptions to these rules are specified in 3GPP TS
29.002 [34].
### 10.3.1 gsmSCF to HLR information flows
#### 10.3.1.1 Any Time Modification Request
##### 10.3.1.1.1 Description
This IF is used to modify information in the HLR at any time.
##### 10.3.1.1.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | gsmSCF Address | M | This IE indicates the | | | | address of the | | | | interrogating gsmSCF. The | | | | gsmSCF Address shall be in | | | | international E.164 format. | +-----------------------------+--------+-----------------------------+ | Subscriber Identity | M | This IE identifies the | | | | subscriber for which the | | | | information is requested. | | | | The identity shall be | | | | either: | | | | | | | | - IMSI, or | | | | | | | | - MSISDN | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Call Forwarding SS Data | | table below. | | | | | | | | This IE indicates the data | | | | of Call Forwarding data to | | | | be modified. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Call Barring SS Data | | table below. | | | | | | | | This IE indicates the data | | | | of call barring data to be | | | | modified. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Operator Determined Barring | | table below. | | Data | | | | | | This IE indicates the data | | | | of operator determined | | | | barring data to be used. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | CAMEL Subscription | | table below. | | Information | | | | | | This IE indicates the | | | | Modification Request for | | | | CAMEL Subscription | | | | Information. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Call Waiting SS Data | | table below. | | | | | | | | This IE indicates the data | | | | of Call Waiting data to be | | | | modified. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Call Hold SS Data | | table below. | | | | | | | | This IE indicates the data | | | | of Call Hold data to be | | | | modified. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Calling Line Identification | | table below. | | Presentation SS Data | | | | | | This IE indicates the data | | | | of Calling Line | | | | Identification Presentation | | | | data to be modified. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Calling Line Identification | | table below. | | Restriction SS Data | | | | | | This IE indicates the data | | | | of Calling Line | | | | Identification Restriction | | | | data to be modified. | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | Explicit Call Transfer SS | | table below. | | Data | | | | | | This IE indicates the data | | | | of Explicit Call Transfer | | | | data to be modified. | +-----------------------------+--------+-----------------------------+
Modification Request For Call Forwarding SS Data contains the following
information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Code | M | This IE indicates Call | | | | Forwarding supplementary | | | | service as defined in 3GPP | | | | TS 22.004 [2]. Due to a | | | | restriction of the Any Time | | | | Modification | | | | acknowledgement IF, only | | | | the following supplementary | | | | service codes are allowed | | | | for this IE; | | | | | | | | - call forwarding | | | | unconditional; | | | | | | | | - call forwarding on | | | | mobile subscriber busy; | | | | | | | | - call forwarding on no | | | | reply; | | | | | | | | - call forwarding on | | | | mobile subscriber not | | | | reachable. | +--------------------------+--------+-----------------------------+ | Basic Service | O | See 3GPP TS 29.002 [34]. | +--------------------------+--------+-----------------------------+ | SS Status | O | See 3GPP TS 23.011 [9]. | | | | Provisioning and withdrawal | | | | are not allowed for the | | | | gsmSCF. | +--------------------------+--------+-----------------------------+ | Forwarded-to Number | O | See 3GPP TS 23.082 [20]. | +--------------------------+--------+-----------------------------+ | Forwarded-to Subaddress | O | See 3GPP TS 29.002 [34]. | +--------------------------+--------+-----------------------------+ | No Reply Condition Time | O | See 3GPP TS 23.082 [20]. | +--------------------------+--------+-----------------------------+ | Modify Notification Flag | O | This IE contains an | | | | instruction to activate or | | | | de-activate the | | | | Notification-to-CSE flag. | +--------------------------+--------+-----------------------------+
Modification Request For Call Barring SS Data contains the following
information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | SS Code | M | This IE indicates Call | | | | Barring supplementary | | | | service as defined in 3GPP | | | | TS 22.004 [2]. Due to a | | | | restriction of the Any Time | | | | Modification | | | | acknowledgement IF, only | | | | the following supplementary | | | | service codes are allowed | | | | for this IE; | | | | | | | | - barring of all outgoing | | | | calls; | | | | | | | | - barring of outgoing | | | | international calls; | | | | | | | | - barring of outgoing | | | | international calls except | | | | those directed to the home | | | | PLMN; | | | | | | | | - barring of all incoming | | | | calls; | | | | | | | | - barring of incoming | | | | calls when roaming outside | | | | home PLMN Country. | +-----------------------------+--------+-----------------------------+ | Basic Service | O | See 3GPP TS 29.002 [34]. | +-----------------------------+--------+-----------------------------+ | SS Status | O | See 3GPP TS 23.011 [9]. | | | | Provisioning and withdrawal | | | | are not allowed for the | | | | gsmSCF. | +-----------------------------+--------+-----------------------------+ | Password | O | See 3GPP TS 23.011 [9]. | +-----------------------------+--------+-----------------------------+ | Wrong password attempts | O | See 3GPP TS 23.011 [9]. | | counter | | | +-----------------------------+--------+-----------------------------+ | Modify Notification Flag | O | This IE contains an | | | | instruction to activate or | | | | de-activate the | | | | Notification-to-CSE flag. | +-----------------------------+--------+-----------------------------+
Modification Request For Operator Determined Barring Data contains the
following information elements:
* * *
Information element name Status Description ODB data O This IE contains ODB
General Data and ODB HPLMN Specific Data to be imposed by this IF. Modify
Notification Flag O This IE contains an instruction to activate or de-activate
the Notification-to-CSE flag.
* * *
Modification Request For CAMEL Subscription Information contains the following
information elements:
* * *
Information element name Status Description Requested CSI M This IE indicates
which CSI shall be modified. Only one CSI may be changed in one ATM Request.
Modify Notification Flag O This IE contains an instruction to activate or de-
activate the Notification-to-CSE flag. Modify CSI State O This IE contains an
instruction to activate or de-activate the CSI.
* * *
Modification Request For Explicit Call Transfer Data contains the following
information elements:
* * *
Information element name Status Description SS Status O See 3GPP TS 23.011
[9]. Modify Notification Flag O This IE contains an instruction to activate or
de-activate the Notification-to-CSE flag.
* * *
Modification Request For Call Hold Data contains the following information
elements:
* * *
Information element name Status Description SS Status O See 3GPP TS 23.011
[9]. Modify Notification Flag O This IE contains an instruction to activate or
de-activate the Notification-to-CSE flag.
* * *
Modification Request For Call Waiting Data contains the following information
elements:
* * *
Information element name Status Description SS Status O See 3GPP TS 23.011
[9]. Modify Notification Flag O This IE contains an instruction to activate or
de-activate the Notification-to-CSE flag.
* * *
Modification Request For Calling Line Identification Presentation Data
contains the following information elements:
* * *
Information element name Status Description SS Status O See 3GPP TS 23.011
[9]. Override Category O See 3GPP TS 23.011 [9]. Modify Notification Flag O
This IE contains an instruction to activate or de-activate the Notification-
to-CSE flag.
* * *
Modification Request For Calling Line Identification Restriction Data contains
the following information elements:
* * *
Information element name Status Description SS Status O See 3GPP TS 23.011
[9]. CLI Restriction Option O See 3GPP TS 23.011 [9]. Modify Notification Flag
O This IE contains an instruction to activate or de-activate the Notification-
to-CSE flag.
* * *
#### 10.3.1.2 Any Time Subscription Interrogation Request
##### 10.3.1.2.1 Description
This IF is used to request subscription information from the HLR at any time.
##### 10.3.1.2.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | GsmSCF Address | M | This IE indicates the | | | | address of the | | | | interrogating gsmSCF. The | | | | gsmSCF Address shall be in | | | | international E.164 format. | +--------------------------+--------+-----------------------------+ | Requested Info | M | This IE indicates the type | | | | of subscriber information | | | | being requested: | | | | | | | | This shall consist of one | | | | or more of the following | | | | list: | | | | | | | | - supplementary service; | | | | this information is | | | | described in a table below, | | | | | | | | - Operator Determined | | | | Barring; | | | | | | | | - CAMEL Subscription | | | | Information; this | | | | information is described in | | | | a table below, | | | | | | | | - supported CAMEL phases | | | | in VLR; | | | | | | | | - supported CAMEL phases | | | | in SGSN; | | | | | | | | - MSISDNs and Basic | | | | Service Codes associated | | | | with the Subscriber | | | | Identity. | | | | | | | | - CSG Subscription Data, | | | | see 3GPP TS 29.002 [34]; | | | | | | | | - Call Waiting SS Data see | | | | 3GPP TS 29.002[34]; | | | | | | | | - Call Hold SS Data see | | | | 3GPP TS 29.002[34]; | | | | | | | | - Explicit Call Transfer | | | | Data see 3GPP TS | | | | 29.002[34]; | | | | | | | | - Calling Line | | | | Identification | | | | Presentattion Data see 3GPP | | | | TS 29.002[34]; | | | | | | | | - Calling Line | | | | Identification Restriction | | | | Data see 3GPP TS | | | | 29.002[34]. | +--------------------------+--------+-----------------------------+ | Subscriber Identity | M | This IE identifies the | | | | subscriber for which the | | | | information is requested. | | | | The identity shall be | | | | either: | | | | | | | | - IMSI, or | | | | | | | | - MSISDN. | +--------------------------+--------+-----------------------------+
Supplementary service contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Code | M | This IE indicates a | | | | supplementary service as | | | | defined in 3GPP | | | | TS 22.004 [2]. | | | | | | | | Due to a restriction of the | | | | Any Time Subscription | | | | Interrogation | | | | acknowledgement IF, only | | | | the following supplementary | | | | service codes are allowed | | | | for this IE; | | | | | | | | - call forwarding | | | | unconditional; | | | | | | | | - call forwarding on | | | | mobile subscriber busy; | | | | | | | | - call forwarding on no | | | | reply; | | | | | | | | - call forwarding on | | | | mobile subscriber not | | | | reachable; | | | | | | | | - barring of all outgoing | | | | calls; | | | | | | | | - barring of outgoing | | | | international calls; | | | | | | | | - barring of outgoing | | | | international calls except | | | | those directed to the home | | | | PLMN; | | | | | | | | - barring of all incoming | | | | calls; | | | | | | | | - barring of incoming | | | | calls when roaming outside | | | | home PLMN Country. | +--------------------------+--------+-----------------------------+ | Basic Service | O | See 3GPP TS 29.002 [34]. | +--------------------------+--------+-----------------------------+
CAMEL subscription information shall contain one of the following information
elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | CAMEL Subscription Info | S,E | This IE indicates which | | | | CAMEL Subscription | | | | Information is requested. | | | | It shall be one of the | | | | following elements: | | | | | | | | O‑CSI/T‑CSI/ | | | | VT‑CSI/TIF‑CSI/GPRS‑CSI/MO‑ | | | | SMS‑CSI/SS‑CSI/M‑CSI/D‑CSI. | +-----------------------------+--------+-----------------------------+ | Additional Requested CAMEL | S,E | This IE indicates which | | Subscription Info | | CAMEL Subscription | | | | Information is requested. | | | | It shall be one of the | | | | following elements: | | | | | | | | MT‑SMS‑CSI/ MG‑CSI. | +-----------------------------+--------+-----------------------------+
#### 10.3.1.3 Notify Subscriber Data Change response
##### 10.3.1.3.1 Description
This IF is used by the gsmSCF to respond to the HLR of the change of
subscriber data notify.
##### 10.3.1.3.2 Information Elements
This IF contains no information elements.
### 10.3.2 HLR to gsmSCF information flows
#### 10.3.2.1 Any Time Modification ack
##### 10.3.2.1.1 Description
This IF is used by the HLR to provide the modified information to the gsmSCF.
##### 10.3.2.1.2 Information Elements
* * *
Information element name Status Description Call Forwarding SS Data S This IE
is described in a table below. It shall be present if it was modified. Call
Barring SS Data S This IE is described in a table below. It shall be present
if it was modified. Operator Determined Barring Information S This IE is
described in a table below. It shall be present if it was modified. CAMEL
Subscription Information S This IE is described in a table below. It shall be
present if it was modified. Call Waiting SS Data S This IE is described in a
table below. It shall be present if it was modified. Call Hold SS Data S This
IE is described in a table below. It shall be present if it was modified.
Calling Line Identification Presentation SS Data S This IE is described in a
table below. It shall be present if it was modified. Calling Line
Identification Restriction SS Data S This IE is described in a table below. It
shall be present if it was modified. Explicit Call Transfer SS Data S This IE
is described in a table below. It shall be present if it was modified.
* * *
Call Forwarding SS Data contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Code | S | This IE indicates Call | | | | Forwarding supplementary | | | | service as defined in 3GPP | | | | TS 22.004 [2]. | | | | | | | | Only the SS code for which | | | | the modification applies is | | | | sent. | +--------------------------+--------+-----------------------------+ | Forwarding Feature List | S | This IE is described in a | | | | table below. | | | | | | | | If a Forwarding Feature | | | | List item is modified then | | | | all applicable fields | | | | within the item shall be | | | | sent. All modified | | | | Forwarding Feature List | | | | items shall be returned. | +--------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | S | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of Call Forwarding | | | | SS data. | | | | | | | | The IE shall be sent if it | | | | was modified. | +--------------------------+--------+-----------------------------+
Forwarding Feature List contains 1 to 32 items of the following information
elements:
* * *
Information element name Status Description Basic Service C See 3GPP TS 29.002
[34]. SS Status C See 3GPP TS 23.011 [9]. Forwarded-to Number C See 3GPP TS
23.082 [20]. Forwarded-to Subaddress C See 3GPP TS 29.002 [34]. Subscription
Options C See 3GPP TS 23.082 [20]. No Reply Condition Timer C See 3GPP TS
23.082 [20].
* * *
Call Barring SS Data contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | SS Code | S | This IE indicates Call | | | | Barring supplementary | | | | service as defined in 3GPP | | | | TS 22.004 [2]. | | | | | | | | Only the SS code for which | | | | the modification applies is | | | | sent. | +-----------------------------+--------+-----------------------------+ | Call Barring Feature List | S | This IE is described in a | | | | table below. | | | | | | | | If a Call Barring Feature | | | | List item is modified then | | | | all applicable fields | | | | within the item shall be | | | | sent. All modified Call | | | | Barring Feature List items | | | | shall be returned. | +-----------------------------+--------+-----------------------------+ | Password | S | See 3GPP TS 23.011 [9]. | | | | | | | | The IE shall be sent if it | | | | was modified. | +-----------------------------+--------+-----------------------------+ | Wrong Password Attempts | S | See 3GPP TS 23.011 [9]. | | Counter | | | | | | The IE shall be sent if it | | | | was modified. | +-----------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | S | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of Call Barring SS | | | | data. | | | | | | | | The IE shall be sent if it | | | | was modified. | +-----------------------------+--------+-----------------------------+
Call Barring Feature List contains 1 to 32 items of the following information
elements:
* * *
Information element name Status Description Basic Service C See 3GPP TS 29.002
[34]. SS Status C See 3GPP TS 23.011 [9].
* * *
Operator Determined Barring Information contains the following information
elements:
* * *
Information element name Status Description ODB Data C See subclause 10.3.2.3
Notification-to-CSE Flag C This IE indicates whether the gsmSCF is notified of
a change of ODB data.
* * *
CAMEL Subscription Information contains the following information elements:
* * *
Information element name Status Description O‑CSI S See subclause 4.3.1. It
shall be present if it was modified. D‑CSI S See subclause 4.3.2. It shall be
present if it was modified. T‑CSI S See subclause 4.3.5. It shall be present
if it was modified. VT‑CSI S See subclause 4.3.6. It shall be present if it
was modified. TIF‑CSI S See subclause 4.3.4. It shall be present if it was
modified. GPRS‑CSI S See subclause 6.3.1. It shall be present if it was
modified. MO‑SMS‑CSI S See subclause 7.3.1. It shall be present if it was
modified. MT‑SMS‑CSI S See subclause 7.3.2. It shall be present if it was
modified. SS‑CSI S See subclause 8.2.1. It shall be present if it was
modified. M‑CSI S See subclause 9.2.1. It shall be present if it was modified.
MG‑CSI S See subclause 9.2.2. It shall be present if it was modified.
* * *
Explicit Call Transfer Data contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Status | S | It shall be present if it | | | | was modified. | +--------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | S | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of Explicit Call | | | | Transfer SS data. | | | | | | | | The IE shall be sent if it | | | | was modified. | +--------------------------+--------+-----------------------------+
Call Hold Data contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Status | S | It shall be present if it | | | | was modified | +--------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | S | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of Call Hold SS | | | | data. | | | | | | | | The IE shall be sent if it | | | | was modified. | +--------------------------+--------+-----------------------------+
Call Waiting Data contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Status | S | It shall be present if it | | | | was modified | +--------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | S | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of Call Waiting SS | | | | data. | | | | | | | | The IE shall be sent if it | | | | was modified. | +--------------------------+--------+-----------------------------+
Calling Line Identification Presentation Data contains the following
information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Status | S | It shall be present if it | | | | was modified | +--------------------------+--------+-----------------------------+ | Override Category | S | It shall be present if it | | | | was modified | +--------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | S | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of Calling Line | | | | Identification Presentation | | | | SS data. | | | | | | | | The IE shall be sent if it | | | | was modified. | +--------------------------+--------+-----------------------------+
Calling Line Identification Restriction Data contains the following
information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | SS Status | S | It shall be present if it | | | | was modified | +--------------------------+--------+-----------------------------+ | CLI Restriction Option | S | It shall be present if it | | | | was modified | +--------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | S | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of Calling Line | | | | Identification Restriction | | | | SS data. | | | | | | | | The IE shall be sent if it | | | | was modified. | +--------------------------+--------+-----------------------------+
#### 10.3.2.2 Any Time Subscription Interrogation ack
##### 10.3.2.2.1 Description
This IF is used by the HLR to provide the requested subscription information
to the gsmSCF.
##### 10.3.2.2.2 Information Elements
* * *
Information element name Status Description Call Forwarding SS Data C This IE
is described in a table below. Call Barring SS Data C This IE is described in
a table below. Operator Determined Barring Data C This IE is described in a
table below. CAMEL Subscription Information C This IE is described in a table
below. Supported CAMEL Phases In VLR C This IE indicates the CAMEL phase
supported in the VLR. Offered CAMEL4 CSIs In VLR S This IE indicates the CAMEL
phase 4 CSIs offered in the VMSC/VLR. It shall be present if the \"Supported
CAMEL Phases In VLR\" IE indicates CAMEL phase 4. Supported CAMEL Phases In
SGSN C This IE indicates the CAMEL phase supported in the SGSN. Offered CAMEL4
CSIs In SGSN S This IE indicates the CAMEL phase 4 CSIs offered in the SGSN.
It shall be present if the \"Supported CAMEL Phases In SGSN\" IE indicates
support of CAMEL phase 4. MSISDN-BS-List C This IE indicates the subscriber's
MSISDN(s) and their associated Basic Service Codes. (Note) Call Waiting SS
Data C This IE is described in a table below. Call Hold SS Data C This IE is
described in a table below. Calling Line Identification Presentation SS Data C
This IE is described in a table below. Calling Line Identification Restriction
SS Data C This IE is described in a table below. Explicit Call Transfer SS
Data C This IE is described in a table below. NOTE: The BASIC MSISDN is always
first in the list.
* * *
Call Forwarding SS Data contains the following information elements:
* * *
Information element name Status Description Forwarding Feature List C This IE
is described in a table below Notification-to-CSE Flag C This IE indicates
whether the gsmSCF is notified of a change of Call Forwarding SS data.
* * *
Forwarding Feature List contains 1 to 32 items of the following information
elements:
* * *
Information element name Status Description Basic Service C See 3GPP TS 29.002
[34]. SS Status C See 3GPP TS 23.011 [9]. Forwarded-to Number C See 3GPP TS
23.082 [20]. Forwarded-to Subaddress C See 3GPP TS 29.002 [34]. Subscription
Options C See 3GPP TS 23.082 [20]. No Reply Condition Time C See 3GPP TS
23.082 [20].
* * *
Call Barring SS Data contains the following information elements:
* * *
Information element name Status Description Call Barring Feature List C This
IE is described in a table below. Password C See 3GPP TS 23.011 [9]. Wrong
Password Attempts Counter C See 3GPP TS 23.011 [9]. Notification-to-CSE Flag C
This IE indicates whether the gsmSCF is notified of a change of Call Barring
SS data.
* * *
Call Barring Feature List contains 1 to 32 items of the following information
elements:
* * *
Information element name Status Description Basic Service C See 3GPP TS 29.002
[34]. SS Status C See 3GPP TS 23.011 [9].
* * *
Operator Determined Barring Bata contains the following information elements:
* * *
Information element name Status Description ODB General Data C This IE
indicates the set of subscribers features that the network operator or the
service provider can regulate. ODB HPLMN Specific Data C This IE indicates the
set of subscribers features that the network operator or the service provider
can regulate only when the subscriber is registered in the HPLMN.
Notification-to-CSE Flag C This IE indicates whether the gsmSCF is notified of
a change of ODB data.
* * *
CAMEL Subscription Information contains the following information elements:
* * *
Information element name Status Description O‑CSI C See subclause 4.3.1. D‑CSI
C See subclause 4.3.2. T‑CSI C See subclause 4.3.5. VT‑CSI C See subclause
4.3.6. TIF‑CSI C See subclause 4.3.4. GPRS‑CSI C See subclause 6.3.1.
MO‑SMS‑CSI C See subclause 7.3.1. MT‑SMS‑CSI C See subclause 7.3.2. SS‑CSI C
See subclause 8.2.1. M‑CSI C See subclause 9.2.1. MG‑CSI C See subclause
9.2.2.
* * *
Offered CAMEL4 CSIs in VLR contains the following information elements:
* * *
Information element name Status Description O‑CSI S This IE indicates the
offer of CAMEL phase 4 O‑CSI D‑CSI S This IE indicates the offer of CAMEL
phase 4 D‑CSI VT‑CSI S This IE indicates the offer of CAMEL phase 4 VT‑CSI
MT‑SMS‑CSI S This IE indicates the offer of CAMEL phase 4 MT‑SMS‑CSI
* * *
Offered CAMEL4 CSIs in SGSN contains the following information elements:
* * *
Information element name Status Description MT‑SMS‑CSI S This IE indicates the
offer of CAMEL phase 4 MT‑SMS‑CSI MG‑CSI S This IE indicates the offer of
CAMEL phase 4 MG‑CSI PSI Enhancements S This IE indicates the offer of CAMEL
phase 4 Enhancement of Provide Subscriber Information
* * *
Explicit Call Transfer Data contains the following information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was requested by the gsmSCF Notification-to-CSE Flag C This IE indicates
whether the gsmSCF is notified of a change of Explicit Call Transfer SS data.
* * *
Call Hold Data contains the following information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was requested by the gsmSCF Notification-to-CSE Flag C This IE indicates
whether the gsmSCF is notified of a change of Call Hold SS data.
* * *
Call Waiting Data contains the following information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was requested by the gsmSCF Notification-to-CSE Flag C This IE indicates
whether the gsmSCF is notified of a change of Call Waiting SS data.
* * *
Calling Line Identification Presentation Data contains the following
information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was requested by the gsmSCF Override Category C It shall be present if it
was requested by the gsmSCF Notification-to-CSE Flag C This IE indicates
whether the gsmSCF is notified of a change of Calling Line Identification
Presentation SS data.
* * *
Calling Line Identification Restriction Data contains the following
information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was requested by the gsmSCF CLI Restriction Option C It shall be present if
it was requested by the gsmSCF Notification-to-CSE Flag C This IE indicates
whether the gsmSCF is notified of a change of C Calling Line Identification
Restriction SS data.
* * *
#### 10.3.2.3 Notify Subscriber Data Change
##### 10.3.2.3.1 Description
This IF is used by the HLR to notify to the gsmSCF of the change of subscriber
data. This IF is sent at each time subscriber data is changed.
##### 10.3.2.3.2 Information Elements
* * *
Information element name Status Description IMSI M The IMSI is used to
identify the subscriber. MSISDN M The MSISDN is used to identify the
subscriber. Call Forwarding SS Data C This IE is described in a table below.
Call Barring SS Data C This IE is described in a table below. Operator
Determined Barring Data C This IE is described in a table below. CAMEL
Subscription Information C This IE is described in a table below. CSG
Subscription Data C See 3GPP TS 29.002 [34]. It shall be present if it was
modified. Call Waiting SS Data C This IE is described in a table below. Call
Hold SS Data C This IE is described in a table below. Calling Line
Identification Presentation SS Data C This IE is described in a table below.
Calling Line Identification Restriction SS Data C This IE is described in a
table below. Explicit Call Transfer SS Data C This IE is described in a table
below.
* * *
Call Forwarding SS data contains the following information elements:
* * *
Information element name Status Description SS Code C This IE indicates Call
Forwarding supplementary service as defined in 3GPP TS 22.004 [2]. Forwarding
Feature List C This IE is described in a table below. Notification-to-CSE Flag
C This IE indicates whether the gsmSCF is notified of a change of Call
Forwarding SS data.
* * *
Forwarding Feature List contains 1 to 32 items of the following information
elements:
* * *
Information element name Status Description Basic Service C See 3GPP TS 29.002
[34]. Compound basic service codes can also be used in this IF if the
subscriber has used a compound code when modifying the SS (e.g. all bearer
services compound code). SS Status C See 3GPP TS 23.011 [9]. Forwarded-to
Number C See 3GPP TS 23.082 [20]. Forwarded-to Subaddress C See 3GPP TS 29.002
[34]. Subscription Options C See 3GPP TS 23.082 [20]. No Reply Condition Timer
C See 3GPP TS 23.082 [20].
* * *
Call Barring SS data contains the following information elements:
* * *
Information element name Status Description SS Code C This IE indicates Call
Barring supplementary service as defined in 3GPP TS 22.004 [2]. Call Barring
Feature List C This IE is described in a table below. Password C See 3GPP TS
23.011 [9]. Wrong Password Attempts Counter C See 3GPP TS 23.011 [9].
Notification-to-CSE Flag C This IE indicates whether the gsmSCF is notified of
a change of Call Barring SS data.
* * *
Call Barring Feature List contains 1 to 32 items of the following information
elements:
* * *
Information element name Status Description Basic Service C See 3GPP TS 29.002
[34]. Compound basic service codes can also be used in this IF if the
subscriber has used a compound code when modifying the SS (e.g. all bearer
services compound code). SS Status C See 3GPP TS 23.011 [9].
* * *
Operator Determined Barring Data contains the following information elements:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | ODB General Data | C | This IE indicates the set | | | | of subscribers features | | | | that the network operator | | | | or the service provider can | | | | regulate. | | | | | | | | When the ODB general data | | | | is removed for the | | | | subscriber, this IE | | | | indicates that the set of | | | | subscribers features is | | | | empty. | +--------------------------+--------+-----------------------------+ | ODB HPLMN Specific Data | C | This IE indicates the set | | | | of subscribers features | | | | that the network operator | | | | or the service provider can | | | | regulate only when the | | | | subscriber is registered in | | | | the HPLMN. | | | | | | | | When the ODB HPLMN specific | | | | data is removed for the | | | | subscriber, this IE | | | | indicates that the set of | | | | subscribers features is | | | | empty. | +--------------------------+--------+-----------------------------+ | Notification-to-CSE Flag | C | This IE indicates whether | | | | the gsmSCF is notified of a | | | | change of ODB data. | +--------------------------+--------+-----------------------------+
CAMEL Subscription Information contains the following information elements:
+---------------------------+--------+-----------------------------+ | Information element name | Status | Description | +---------------------------+--------+-----------------------------+ | O‑CSI | S | See subclause 4.3.1. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | D‑CSI | S | See subclause 4.3.2. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | T‑CSI | S | See subclause 4.3.5. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | VT‑CSI | S | See subclause 4.3.6. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | TIF‑CSI | S | See subclause 4.3.4. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | GPRS‑CSI | S | See subclause 6.3.1. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | MO‑SMS‑CSI | S | See subclause 7.3.1. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | MT‑SMS‑CSI | S | See subclause 7.3.2. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | SS‑CSI | S | See subclause 8.2.1. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | M‑CSI | S | See subclause 9.2.1. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | MG‑CSI | S | See subclause 9.2.2. It | | | | shall be present if it was | | | | modified. | +---------------------------+--------+-----------------------------+ | Specific CSI Deleted List | S | This IE indicates that one | | | | or more specific elements | | | | of CAMEL Subscription | | | | Information have been | | | | deleted from the HLR. It | | | | shall indicate any of the | | | | following; | | | | | | | | - O‑CSI (with TDP criteria | | | | for O‑CSI); | | | | | | | | - T‑CSI (with TDP criteria | | | | for T‑CSI); | | | | | | | | - TIF‑CSI; | | | | | | | | - D‑CSI; | | | | | | | | - VT‑CSI with TDP criteria | | | | for VT‑CSI; | | | | | | | | - GPRS‑CSI; | | | | | | | | - MO‑SMS‑CSI; | | | | | | | | - MT‑SMS‑CSI with TDP | | | | criteria for MT‑SMS‑CSI; | | | | | | | | - SS‑CSI; | | | | | | | | - M‑CSI; | | | | | | | | - MG‑CSI. | | | | | | | | This IE shall be present if | | | | CSI is/are deleted. | +---------------------------+--------+-----------------------------+
Explicit Call Transfer Data contains the following information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was modified Notification-to-CSE Flag C This IE indicates whether the
gsmSCF is notified of a change of Explicit Call Transfer SS data.
* * *
Call Hold Data contains the following information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was modified Notification-to-CSE Flag C This IE indicates whether the
gsmSCF is notified of a change of Call Hold SS data.
* * *
Call Waiting Data contains the following information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was modified Notification-to-CSE Flag C This IE indicates whether the
gsmSCF is notified of a change of Call Waiting SS data.
* * *
Calling Line Identification Presentation Data contains the following
information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was modified Override Category C It shall be present if it was modified
Notification-to-CSE Flag C This IE indicates whether the gsmSCF is notified of
a change of Calling Line Identification Presentation SS data.
* * *
Calling Line Identification Restriction Data contains the following
information elements:
* * *
Information element name Status Description SS Status C It shall be present if
it was modified CLI Restriction Option C It shall be present if it was
modified Notification-to-CSE Flag C This IE indicates whether the gsmSCF is
notified of a change of C Calling Line Identification Restriction SS data.
* * *
### 10.3.3 IP-SM-GW to HLR information flows
#### 10.3.3.1 Any Time Modification Request
##### 10.3.3.1.1 Description
This IF is used to register the IP-SM-GW for a subscriber in the HLR.
##### 10.3.3.1.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | IP-SM-GW Address | M | This IE indicates the | | | | address of the | | | | interrogating IP-SM-GW. The | | | | IP-SM-GW Address shall be | | | | in international E.164 | | | | format. | +-----------------------------+--------+-----------------------------+ | Subscriber Identity | M | This IE identifies the | | | | subscriber for which the | | | | information is requested. | | | | The identity shall be | | | | either: | | | | | | | | - IMSI, or | | | | | | | | - MSISDN | +-----------------------------+--------+-----------------------------+ | Modification Request For | E | This IE is described in a | | IP-SM-GW Data | | table below. | | | | | | | | This IE indicates the | | | | IP-SM-GW data to be | | | | modified. | +-----------------------------+--------+-----------------------------+
Modification Request For IP-SM-GW Data contains the following information
elements:
* * *
Information element name Status Description Modify Registration Flag M This IE
contains an instruction to register or de-register the IP-SM-GW.
* * *
### 10.3.4 HLR to IP-SM-GW information flows
#### 10.3.4.1 Any Time Modification ack
##### 10.3.4.1.1 Description
This IF is used by the HLR to acknowledge the registration or deregistration
for a subscriber of the IP-SM-GW to the IP-SM-GW.
##### 10.3.4.1.2 Information Elements
This IF contains no information elements.
# 11 Subscriber Location and State retrieval
Support of the procedures described in this clause in CAMEL Phase 4 is a
network operator option.
## 11.1 Architecture
### 11.1.1 Functional Entities used for CAMEL
This subclause describes procedures for the retrieval of subscriber location
and subscriber state information. Location Services is only supported in CAMEL
Phase 3 and higher.
1) The gsmSCF may request location information of a mobile station from the
GMLC via Location Services. The information flow of Location Services is
described in 3GPP TS 23.271 [28] and 25. 305 [32]. Figure 11.1-1 indicates the
functional entities involved in the procedures for the retrieval of location
information via location services.
2) The gsmSCF may request any of location information, subscriber state
information, IMEI and MS Class of a mobile station from the HLR. Any of
location information, subscriber state information, IMEI and MS Class may be
requested either from the circuit switched or the packet switched domain.
> If any of location information, subscriber state information, IMEI and MS
> Class is requested by the gsmSCF, then the HLR may retrieve this information
> via the Provide Subscriber Information procedure from either the MSC/VLR or
> the SGSN. This procedure is defined in subclause 4.5.9 of the present
> document.
>
> The interface for the provision of subscriber location and state information
> between HLR and MSC/VLR is described in 3GPP TS 23.018 [12]. The interface
> for the provision of subscriber location and state information between HLR
> and SGSN is described in this chapter. Figure 11.1-2 indicates the
> functional entities involved in the procedures for the retrieval of location
> information and/or subscriber state information from the circuit switched or
> packet switched domain.
{width="5.625694444444444in" height="2.027083333333333in"}
Figure 11.1-1: Functional architecture for CAMEL Support of Location Services
{width="3.834722222222222in" height="3.2777777777777777in"}
Figure 11.1-2: Functional architecture for Any Time Interrogation
**gsmSCF: see subclause 3.1.**
**GMLC:** A functional entity that allows external LCS Clients to request
real-time information about a Mobile Station. The information that can be
requested from the GMLC is the location of the mobile station**.**
HLR: see subclause 4.1.
MSC/VLR: see subclause 4.1.
SGSN: see subclause 6.1.1. The SGSN stores location and state information for
each subscriber. Upon request this information is provided to the HLR.
The information flows between the GMLC and functional entities other than the
gsmSCF, have not been indicated in the functional architecture shown in
figures 11.1. These information flows are outside the scope of the present
document.
### 11.1.2 Interfaces defined for CAMEL
This subclause describes the interfaces applicable to CAMEL. It specifies on a
high level the functions specific to CAMEL.
#### 11.1.2.1 gsmSCF - GMLC interface
This interface is used by the gsmSCF to request information (Mobile Station
location) from the GMLC at any time.
#### 11.1.2.2 GMLC - gsmSCF interface
This interface is used by the GMLC to return the requested information (Mobile
Station location) to the gsmSCF as requested by the gsmSCF via the Any Time
Interrogation procedure.
#### 11.1.2.3 gsmSCF - HLR
This interface is used by the gsmSCF to interrogate the HLR. As a network
operator option, the HLR may refuse to provide the information requested by
the gsmSCF.
#### 11.1.2.4 HLR - gsmSCF
This interface is used by the HLR to return the requested information to the
gsmSCF as requested by the gsmSCF via the Any Time Interrogation procedure.
#### 11.1.2.5 HLR - SGSN
This interface is used by the HLR to request information from the SGSN.
#### 11.1.2.5 SGSN - HLR
This interface is used by the SGSN to return the requested information to the
HLR.
## 11.2 Procedures for CAMEL
### 11.2.1 Location Services
Handling of Any Time Interrogation to obtain Location Information involves the
following process:
\- CAMEL_ATI_GMLC.
If an OSS needs to retrieve the active location of a Mobile Station, the
gsmSCF initiates a transaction to the GMLC by sending a Any Time Interrogation
Request.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 11.2-1: Process CAMEL_ATI_GMLC (sheet 1)
### 11.2.2 Any Time Interrogation
Handling of Any Time Interrogation to obtain Subscriber State and Location
Information involves the following process:
> \- CAMEL_ATI_HLR.
If an OSS needs the Subscriber State and/or the Location Information, the
gsmSCF initiates a transaction to the HLR by sending an Any_Time_Interrogation
Request.
{width="6.691666666666666in" height="8.64861111111111in"}
Figure 11.3-1: Process CAMEL_ATI_HLR (sheet 1)
### 11.2.3 Provide Subscriber Information in the SGSN
The provision of Subscriber State and Location Information involves the
following process and procedures:
\- CAMEL_Provide_Subscriber_Info_SGSN;
\- CAMEL_Active_Info_Retrieval_SGSN;
\- Retrieve_GPRS_MS_Class_If_Required;
\- Retrieve_IMEI_If_Required.
#### 11.2.3.1 Procedure CAMEL_Provide_Subscriber_Info_SGSN
If the SGSN receives a Provide Subscriber Info request, it performs procedures
to obtain the requested information.
The test \"Active retrieval required\" takes the \"Yes\" exit if any one or
more of current location, GPRS MS class or IMEI is indicated in the Provide
Subscriber Info request.
#### 11.2.3.2 Procedure CAMEL_Active_Info_Retrieval_SGSN
If the SGSN data show that the MS is in the \"Iu Connected\" state (i.e. it
has an Iu connection established), the SGSN performs the Location Reporting
Control procedure (Direct report) which is defined in 3GPP TS 25.413 [33].
The test \"Report on change of service area\" takes the \"Yes\" exit if the
SGSN has performed the Location Reporting Control procedure with the Request
Type IE set to \"Change of service area\".
If the SGSN data show that the MS is in the \"A/Gb Ready\" state (i.e. it is
transferring packet data over an A/Gb access connection) then the currently
stored location information is up to date, and no further action is required.
{width="5.752083333333333in" height="7.4375in"}
Figure 11.4-1: Process CAMEL_Provide_Subscriber_Info_SGSN (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 11.5-1: Procedure CAMEL_Active_Info_Retrieval_SGSN (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 11.5-2: Procedure CAMEL_Active_Info_Retrieval_SGSN (sheet 2)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 11.6-1: Procedure Retrieve_GPRS_MS_Class_If_Required (sheet 1)
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 11.7-1: Procedure Retrieve_IMEI_If_Required (sheet 1)
## 11.3 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for the retrieval of information about the location and state of a
subscriber.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Specific conditions (S), mutually Exclusive (E) or not applicable (-) in the
\"Status\" column.
An \'M\' IE shall always be included. A \'C\' IE shall be included if the
sending entity has the necessary information to populate the IE. The
conditions for the inclusion of an \'S\' IE are shown in the \'Description\'
column of the definition table. When a set of \'E\' IEs is shown in the
definition of an Information Flow or compound IE, only one of those IEs may be
included. A \'‑\' IE shall always be omitted. This categorization is a
functional classification, i.e. it defines the requirements for the stage 2
information. It is not a stage 3 classification to be used for the ASN.1
syntax of the protocol.
The following principles apply for the handling of the IEs by the receiving
entity:
\- The gsmSCF may silently discard any IE which it does not functionally
support.
\- The GMLC shall return an error if it does not functionally support an IE
which it receives.
Details of errors and exceptions to these rules are specified in 3GPP TS
29.002 [34].
### 11.3.1 gsmSCF to GMLC information flows
#### 11.3.1.1 Any Time Interrogation Request
##### 11.3.1.1.1 Description
This IF is used to request information (Mobile Station location) from the
GMLC.
##### 11.3.1.1.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | gsmSCF Address | M | This IE indicates the | | | | address of the | | | | interrogating gsmSCF. The | | | | gsmSCF Address shall be in | | | | international E.164 format. | +--------------------------+--------+-----------------------------+ | Requested Info | M | This IE indicates the type | | | | of information that is | | | | requested. It shall have | | | | the following value: | | | | | | | | - Mobile Station location | +--------------------------+--------+-----------------------------+ | Mobile Station Identity | M | This IE identifies the | | | | Mobile Station of which the | | | | information is requested. | | | | The identity shall be | | | | either: | | | | | | | | - IMSI, or | | | | | | | | - MSISDN | +--------------------------+--------+-----------------------------+
### 11.3.2 GMLC to gsmSCF information flows
#### 11.3.2.1 Any Time Interrogation ack
##### 11.3.2.1.1 Description
This IF is used by the GMLC to provide the requested information to the
gsmSCF.
##### 11.3.2.1.2 Information Elements
* * *
Information element name Status Description Location Information C This IE
indicates the location of the Mobile Station.
* * *
Location Information is defined in 3GPP TS 23.018 [12]. The following
differences apply:
* * *
Information element name Status Description Location number - Not applicable
Service area ID - Not applicable Cell ID - Not applicable Geographical
information C See 3GPP TS 23.032 [13]. The GMLC receives Extended Geographical
Information from the MSC. The Extended Geographical Information shall be
converted to the Geographical Information by the GMLC. VLR number - Not
applicable Current Location Retrieved - Not applicable MSC number C The GMLC
receives the MSC number from the HLR in the SendRoutingInfoForLCS MAP message.
SGSN number C The GMLC receives the SGSN number from the HLR in the
SendRoutingInfoForLCS MAP message. User CSG Information C See 3GPP TS 23.060
[15].
* * *
### 11.3.3 gsmSCF to HLR information flows
#### 11.3.3.1 Any Time Interrogation Request
##### 11.3.3.1.1 Description
This IF is used to request information (any one or more of subscriber state,
subscriber location, IMEI (with software version) and MS classmark information
for the requested domain) from the HLR at any time.
##### 11.3.3.1.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | Subscriber Identity | M | This IE identifies the | | | | subscriber for which the | | | | information is requested. | | | | The identity shall be | | | | either: | | | | | | | | - IMSI, or | | | | | | | | - MSISDN. | +--------------------------+--------+-----------------------------+ | Requested Info | M | This IE indicates the type | | | | of subscriber information | | | | being requested. This IE is | | | | described in a table below. | +--------------------------+--------+-----------------------------+ | gsmSCF Address | M | This IE indicates the | | | | address of the | | | | interrogating gsmSCF. The | | | | gsmSCF Address shall be in | | | | international E.164 format. | +--------------------------+--------+-----------------------------+
Requested Info contains the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Location Information | O | This IE indicates that the | | | | Location Information is | | | | requested. | +-----------------------------+--------+-----------------------------+ | Subscriber State | O | This IE indicates that the | | | | Subscriber State is | | | | requested. | +-----------------------------+--------+-----------------------------+ | Current Location | O,S | This IE indicates that the | | | | Current Location is | | | | requested. This IE shall | | | | not be present if Location | | | | Information is not present | | | | in Requested Info. | +-----------------------------+--------+-----------------------------+ | Location Information in EPS | O,S | This IE indicates by its | | Supported | | presence that Location | | | | Information in EPS is | | | | supported. This IE should | | | | be present if Location | | | | Information is present in | | | | Requested Info and Location | | | | Information in EPS is | | | | supported. This IE shall | | | | not be present if Location | | | | Information is not present | | | | in Requested Info. | +-----------------------------+--------+-----------------------------+ | Requested Domain | M | This IE indicates for which | | | | domain the subscriber info | | | | is requested. It shall be | | | | one of the following: | | | | | | | | - circuit switched domain; | | | | | | | | - packet switched domain. | +-----------------------------+--------+-----------------------------+ | IMEI (with software | O | This IE indicates that the | | version) | | IMEI (with software | | | | version) is requested. | +-----------------------------+--------+-----------------------------+ | MS class mark information | O | This IE indicates that the | | for the requested domain | | MS classmark information | | | | for the indicated domain is | | | | requested. | +-----------------------------+--------+-----------------------------+
Requested Info shall contain one or more of the following information
elements:
\- Location Information;
\- Subscriber State;
\- IMEI (with software version);
\- MS classmark information for the requested domain.
### 11.3.4 HLR to gsmSCF information flows
#### 11.3.4.1 Any Time Interrogation ack
##### 11.3.4.1.1 Description
This IF is used by the HLR to provide the requested subscriber location and/or
subscriber state information to the gsmSCF.
##### 11.3.4.1.2 Information Elements
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Location Information | C, E1 | This IE indicates the | | | | location of the served | | | | subscriber in the MSC/VLR. | | | | It shall be present only if | | | | requested by the gsmSCF. | +-----------------------------+--------+-----------------------------+ | Location Information For | C, E1 | This IE indicates the | | GPRS | | location of the served | | | | subscriber in the SGSN. It | | | | shall be present only if | | | | requested by the gsmSCF. | +-----------------------------+--------+-----------------------------+ | Subscriber State | S, E2 | This IE indicates the state | | | | of the MS in the CS domain. | | | | It shall be present only if | | | | requested by the gsmSCF. | | | | The possible values of the | | | | IE are: | | | | | | | | - CAMELBusy: The VLR has | | | | indicated that the MS is | | | | engaged in a transaction | | | | for a mobile originating or | | | | terminated circuit-switched | | | | call. | | | | | | | | - | | | | Net | | | | workDeterminedNotReachable: | | | | The HLR or VLR has | | | | indicated that the network | | | | can determine from its | | | | internal data that the MS | | | | is not reachable. | | | | | | | | - AssumedIdle: The VLR has | | | | indicated that the state of | | | | the MS is neither | | | | \"CAMELBusy\" nor | | | | \"Netwo | | | | rkDeterminedNotReachable\". | | | | | | | | - NotProvidedFromVLR: The | | | | VLR did not provide any | | | | information on subscriber | | | | state even though it was | | | | requested. | +-----------------------------+--------+-----------------------------+ | PS Domain Subscriber State | S, E2 | This IE indicates the state | | | | of the MS in the PS Domain. | | | | It shall be present only if | | | | requested by the gsmSCF. | | | | The possible values of the | | | | IE are: | | | | | | | | - Detached (see | | | | subclause 11.3.5.1). | | | | | | | | - CAMEL attached, MS not | | | | reachable for paging (see | | | | subclause 11.3.5.1). | | | | | | | | - CAMEL attached, MS may | | | | be reachable for paging | | | | (see subclause 11.3.5.1). | | | | | | | | - CAMEL PDP active, MS not | | | | reachable for paging (see | | | | subclause 11.3.5.1). | | | | | | | | - CAMEL PDP active, MS may | | | | be reachable for paging | | | | (see subclause 11.3.5.1). | | | | | | | | - Not provided from SGSN: | | | | The SGSN does not support | | | | Provide Subscriber Info or | | | | it did not provide any | | | | information on subscriber | | | | state even though it was | | | | requested. | | | | | | | | - | | | | Net | | | | workDeterminedNotReachable: | | | | The HLR has indicated that | | | | the network can determine | | | | from its internal data that | | | | the MS is not reachable. | +-----------------------------+--------+-----------------------------+ | PDP Context Information | C | This IE indicates the PDP | | List | | context information (see | | | | the table in | | | | subclause 11.3.5.1) for | | | | each PDP context which is | | | | active for the MS. It shall | | | | be present if the PS domain | | | | Subscriber State has the | | | | value \"CAMEL PDP active, | | | | MS not reachable for | | | | paging" or "CAMEL PDP | | | | active, MS may be reachable | | | | for paging\"; otherwise it | | | | shall be absent. | +-----------------------------+--------+-----------------------------+ | IMEI (with software | C | This IE contains the IMEISV | | version) | | (as defined in 3GPP | | | | TS 23.003 [7]) of the ME | | | | in use by the served | | | | subscriber. It shall be | | | | present only if requested | | | | by the gsmSCF. | +-----------------------------+--------+-----------------------------+ | MS Classmark 2 | C | This IE contains the MS | | | | classmark 2, which is | | | | returned by the MS when it | | | | responds to paging in the | | | | CS domain. It shall be | | | | present only if requested | | | | by the gsmSCF. | +-----------------------------+--------+-----------------------------+ | GPRS MS Class | C | This IE contains the MS | | | | network and radio access | | | | capabilities. It shall be | | | | present only if requested | | | | by the gsmSCF. | +-----------------------------+--------+-----------------------------+
Location Information is defined in 3GPP TS 23.018 [12]. The following
differences apply:
* * *
Information element name Status Description Service area ID C,E See 3GPP TS
23.018 [12]. Cell ID C,E See 3GPP TS 23.018 [12]. VLR Number C See 3GPP TS
23.018 [12]. The HLR shall include the internally stored VLR Number. Location
area ID C,E See 3GPP TS 23.003 [7]. Selected LSA Identity C This IE indicates
the LSA identity associated with the current position of the MS. It shall be
present if the LSA ID in the subscriber data matches the LSA ID of the current
cell. In the case of multiple matches the LSA Id with the highest priority it
shall be present. See 3GPP TS 23.073 [18]. MSC number C E.164 number which
identifies the VMSC in whose area the subscriber is currently registered. See
3GPP TS 23.003 [7]. If the HLR receives the MSC number from the VLR in the
Provide Subscriber Info ack IF then the HLR shall ignore the MSC number. User
CSG Information C See 3GPP TS 23.060 [15]. E-UTRAN Cell ID C, E See 3GPP TS
23.018 [12]. Tracking area ID C, E See 3GPP TS 23.018 [12].
* * *
Location Information for GPRS is defined in the subclause 11.3.6.1.2. The
following differences apply:
* * *
Information element name Status Description SGSN Number C See subclause
11.3.6.1.2. The HLR shall include the internally stored SGSN Number.
* * *
### 11.3.5 HLR to SGSN information flows
#### 11.3.5.1 Provide Subscriber Info
##### 11.3.5.1.1 Description
This IF is used by the HLR to request information (subscriber state and/or
location) from the SGSN at any time.
##### 11.3.5.1.2 Information Elements
This IF is defined in 3GPP TS 23.018 [12]. The following differences apply:
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | LMSI | - | Not applicable. | +--------------------------+--------+-----------------------------+ | Requested Info | M | This IE indicates which of | | | | the following information | | | | the HLR requires: | | | | | | | | - Subscriber location; | | | | | | | | - Subscriber state; | | | | | | | | - Current location; | | | | | | | | - IMEI & Software version; | | | | | | | | - GPRS MS classmark | | | | information. | +--------------------------+--------+-----------------------------+
### 11.3.6 SGSN to HLR information flows
#### 11.3.6.1 Provide Subscriber Info ack
##### 11.3.6.1.1 Description
This IF is used by the SGSN to provide the requested subscriber location
and/or subscriber state information to the HLR.
##### 11.3.6.1.2 Information Elements
This IF is defined in 3GPP TS 23.018 [12]. The following differences apply:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Subscriber State | - | Not applicable. | +-----------------------------+--------+-----------------------------+ | PS domain Subscriber State | C | This IE indicates the | | | | status of the MS in the PS | | | | Domain. It shall be present | | | | only if requested by the | | | | HLR. The possible values of | | | | the IE are: | | | | | | | | - Detached: The SGSN has | | | | determined from its | | | | internal data that the MS | | | | is not attached to the | | | | network. | | | | | | | | - CAMEL attached, MS not | | | | reachable for paging: The | | | | SGSN has determined from | | | | its internal data that the | | | | MS is attached to the | | | | network, but there is no | | | | PDP Context active, and the | | | | MS is not reachable for | | | | paging. | | | | | | | | - CAMEL attached, MS may | | | | be reachable for paging: | | | | The SGSN has determined | | | | from its internal data that | | | | the MS is attached to the | | | | network, but there is no | | | | PDP Context active; the | | | | SGSN has not determined | | | | from its internal data that | | | | the MS is not reachable for | | | | paging. | | | | | | | | - CAMEL PDP active, MS not | | | | reachable for paging: The | | | | SGSN has determined from | | | | its internal data that the | | | | MS is attached to the | | | | network there is at least | | | | on PDP context active, and | | | | the MS not reachable for | | | | paging. | | | | | | | | - CAMEL PDP active, MS may | | | | be reachable for paging: | | | | The SGSN has determined | | | | from its internal data that | | | | the MS is attached to the | | | | network and there is at | | | | least one PDP context | | | | active; the SGSN has not | | | | determined from its | | | | internal data that the MS | | | | is not reachable for | | | | paging. | +-----------------------------+--------+-----------------------------+ | PDP Context Information | S | This IE is described in a | | List | | table below. | | | | | | | | This IE indicates the PDP | | | | context information for | | | | each PDP context which is | | | | active for the MS. | | | | | | | | It shall be present if the | | | | PS domain Subscriber State | | | | has the value \"CAMEL PDP | | | | active, MS not reachable | | | | for paging" or "CAMEL PDP | | | | active MS may be reachable | | | | for paging\"; otherwise it | | | | shall be absent. | +-----------------------------+--------+-----------------------------+ | Location Information For | C | This IE is described in a | | GPRS | | table below. | | | | | | | | It indicates the location | | | | of the MS. | | | | | | | | It shall be present only if | | | | requested by the HLR. | +-----------------------------+--------+-----------------------------+ | IMEI (with software | C | This IE contains the IMEI & | | version) | | software version of the ME | | | | in use by the served | | | | subscriber. It shall be | | | | present only if requested | | | | by the HLR. | +-----------------------------+--------+-----------------------------+ | GPRS MS Class | C | This IE contains the MS | | | | network and radio access | | | | capabilities. It shall be | | | | present only if requested | | | | by the HLR. | +-----------------------------+--------+-----------------------------+
PDP Context Information includes the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | PDP Context Identifier | M | Index of the PDP context. | +-----------------------------+--------+-----------------------------+ | PDP State | C | Packet data protocol state, | | | | INACTIVE or ACTIVE. | +-----------------------------+--------+-----------------------------+ | PDP Type | C | PDP type, e.g., PPP or IP. | +-----------------------------+--------+-----------------------------+ | PDP Address | C | PDP address, e.g., an IP | | | | address. | +-----------------------------+--------+-----------------------------+ | APN Subscribed | C | The APN received from the | | | | HLR. | +-----------------------------+--------+-----------------------------+ | APN in Use | C | The APN currently used. | +-----------------------------+--------+-----------------------------+ | NSAPI | C | Network layer Service | | | | Access Point Identifier. | +-----------------------------+--------+-----------------------------+ | TI | C | Transaction Identifier. | +-----------------------------+--------+-----------------------------+ | TEID for Gn/Gp | C | Tunnel Endpoint Identifier | | | | for the Gn and Gp | | | | interfaces. | +-----------------------------+--------+-----------------------------+ | TEID for Iu | C | Tunnel Endpoint Identifier | | | | for the Iu interface. | +-----------------------------+--------+-----------------------------+ | GGSN Address in Use | C | The IP address of the GGSN | | | | currently used. | | | | | | | | The SGSN shall report the | | | | GGSN address in the same IP | | | | version as in the S‑CDR. | | | | See 3GPP TS 32.251 [38]. | +-----------------------------+--------+-----------------------------+ | Subscribed QoS | C | The quality of service | | | | profile subscribed. | +-----------------------------+--------+-----------------------------+ | Requested QoS | C | The quality of service | | | | profile requested. | +-----------------------------+--------+-----------------------------+ | Negotiated QoS | C | The quality of service | | | | profile negotiated. | +-----------------------------+--------+-----------------------------+ | Charging ID | C | Charging identifier, | | | | identifies charging records | | | | generated by SGSN and GGSN. | +-----------------------------+--------+-----------------------------+ | PDP Context Charging | C | The charging | | Characteristics | | characteristics of this PDP | | | | context, e.g., normal, | | | | prepaid, flat-rate, and/or | | | | hot billing. | +-----------------------------+--------+-----------------------------+ | RNC Address In Use | C | The IP address of the RNC | | | | currently used. | +-----------------------------+--------+-----------------------------+ | Requested QoS Extension | S | This IE contains a | | | | supplement to the Requested | | | | QoS IE. It shall be present | | | | if the Requested QoS IE is | | | | present and the MS | | | | requested one or more of | | | | the following for the PDP | | | | context: | | | | | | | | - Source Statistics | | | | Descriptor; | | | | | | | | - Signalling Indication; | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +-----------------------------+--------+-----------------------------+ | Subscribed QoS Extension | S | This IE contains a | | | | supplement to the | | | | Subscribed QoS IE. It shall | | | | be present if the Subsribed | | | | QoS IE is present and one | | | | or more of the following is | | | | part of the subscription | | | | profile in the HLR: | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +-----------------------------+--------+-----------------------------+ | Negotiated QoS Extension | S | This IE contains a | | | | supplement to the | | | | Negotiated QoS. It shall be | | | | present if the Negotiated | | | | QoS IE is present and one | | | | or more of the following | | | | was negotiated between the | | | | MS, the SGSN and the GGSN: | | | | | | | | - Source Statistics | | | | Descriptor; | | | | | | | | - Signalling Indication; | | | | | | | | - Maximum bit rate for | | | | downlink (extended); | | | | | | | | - Guaranteed bit rate for | | | | downlink (extended). | | | | | | | | Otherwise, it shall be | | | | absent. | +-----------------------------+--------+-----------------------------+
Location Information For GPRS includes the following information elements:
+-----------------------------+--------+-----------------------------+ | Information element name | Status | Description | +-----------------------------+--------+-----------------------------+ | Service area ID | C,E | See 3GPP TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | Cell ID | C,E | See 3GPP TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | Location area ID | C,E | See 3GPP TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | Routeing area ID | C | See 3GPP TS 23.003 [7]. | +-----------------------------+--------+-----------------------------+ | Geographical information | C | See 3GPP TS 23.032 [13]. | +-----------------------------+--------+-----------------------------+ | Geodetic information | C | See ITU‑T Q.763 [43]. | +-----------------------------+--------+-----------------------------+ | Age of location information | C | See 3GPP TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | Current Location Retrieved | C | See 3GPP TS 23.018 [12]. | +-----------------------------+--------+-----------------------------+ | SGSN number | M | Global Title of the SGSN. | | | | See 3GPP TS 23.060 [15]. | +-----------------------------+--------+-----------------------------+ | Selected LSA Identity | C | This IE is applicable only | | | | if SoLSA is supported by | | | | the SGSN. | | | | | | | | This IE indicates the LSA | | | | identity associated with | | | | the current position of the | | | | MS. It shall be present if | | | | the LSA ID in the | | | | subscriber data matches the | | | | LSA ID of the current cell. | | | | In the case of multiple | | | | matches the LSA ID with the | | | | highest priority it shall | | | | be present. See 3GPP | | | | TS 23.073 [18] | +-----------------------------+--------+-----------------------------+ | User CSG Information | C | See 3GPP TS 23.060 [15]. | +-----------------------------+--------+-----------------------------+
# 12 Subscriber Mobile Number Portability status retrieval
Support of the procedures described in this clause in CAMEL Phase 4 is a
network operator option.
## 12.1 Architecture
### 12.1.1 Functional Entities used for CAMEL
This clause describes procedures for the retrieval of subscriber Mobile Number
Portability (MNP) information.
The gsmSCF may request subscriber MNP information of a mobile station from the
MNP Signalling Relay Function (MNP SRF).
Figure 12.1 indicates the functional entities involved in the procedures for
the retrieval of MNP information.
{width="4.739583333333333in" height="1.7916666666666667in"}
Figure 12.1: Functional architecture for CAMEL Support of providing MNP
information
**gsmSCF: see subclause 3.1.**
**MNP SRF:** A functional entity that supports the mobile number portability
of a mobile station, which is described in 3GPP TS 23.066 [17].
**Recipient Network:** Network that receives the number in the porting
process. This network becomes the subscription network when the porting
process is complete. See 3GPP TS 23.066 [17].
**Number Range Holder Network:** Network to which the number range containing
the ported number has been allocated. See 3GPP TS 23.066 [17].
### 12.1.2 Interfaces defined for CAMEL
This subclause describes the interfaces applicable to CAMEL. It specifies on a
high level the functions specific to CAMEL.
#### 12.1.2.1 gsmSCF - MNP SRF interface
This interface is used by the gsmSCF to request MNP information from the MNP
SRF at any time.
#### 12.1.2.2 MNP SRF - gsmSCF interface
This interface is used by the MNP SRF to return the requested MNP information
to the gsmSCF, as requested by the gsmSCF via the Any Time Interrogation
procedure.
### 12.2 Procedures for CAMEL
### 12.2.1 Provide MNP Information
#### 12.2.1.1 CAMEL_Provide_MNP_Info with ATI
The process for providing MNP information with Any Time Interrogation (ATI) is
the following:
\- CAMEL_ATI_MNP.
Sheet 1: Details of the task box "Query Number Portability Database" may be
obtained from 3GPP TS 23.066 [17]. The task box returns an indication whether
the MSISDN is known or not.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure 12.2-1: Process CAMEL_ATI_MNP (sheet 1)
## 12.3 Description of information flows
This subclause contains the detailed description of the information flows used
by CAMEL for the retrieval of MNP information about a subscriber.
Each Information Element (IE) is marked as Mandatory (M), Conditional (C),
Specific conditions (S), mutually Exclusive (E) or not applicable (-).
An \'M\' IE shall always be included. A \'C\' IE shall be included if the
sending entity has the necessary information to populate the IE. The
conditions for the inclusion of an \'S\' IE are shown in the \'Description\'
column of the definition table. When a set of \'E\' IEs is shown in the
definition of an Information Flow or compound IE, only one of those IEs may be
included. A \'-\' IE shall always be omitted. This categorization is a
functional classification, i.e. it defines the requirements for the stage 2
information. It is not a stage 3 classification to be used for the ASN.1
syntax of the protocol.
The following principles apply for the handling of the IEs by the receiving
entity:
\- The gsmSCF may silently discard any IE which it does not functionally
support.
\- The MNP SRF shall return an error if it does not functionally support an IE
which it receives.
Details of errors and exceptions to these rules are specified in 3GPP TS
29.002 [34].
### 12.3.1 gsmSCF to MNP SRF information flows
#### 12.3.1.1 Any Time Interrogation Request
##### 12.3.1.1.1 Description
This IF is used by the gsmSCF to request the MNP information for subscribers
from the MNP SRF at any time.
##### 12.3.1.1.2 Information Elements
+--------------------------+--------+-----------------------------+ | Information element name | Status | Description | +--------------------------+--------+-----------------------------+ | gsmSCF Address | M | This IE indicates the | | | | address of the | | | | interrogating gsmSCF. The | | | | gsmSCF Address shall be in | | | | international E.164 format. | +--------------------------+--------+-----------------------------+ | Requested Info | M | This IE indicates the type | | | | of subscriber information | | | | that is requested. It shall | | | | have the following value: | | | | | | | | - MNP Requested Info. | +--------------------------+--------+-----------------------------+ | Subscriber Identity | M | This IE identifies the | | | | subscriber for which the | | | | information is requested. | | | | The identity shall be: | | | | | | | | - MSISDN. | +--------------------------+--------+-----------------------------+
### 12.3.2 MNP SRF to gsmSCF information flows
#### 12.3.2.1 Any Time Interrogation ack
##### 12.3.2.1.1 Description
This IF is used by the MNP SRF to provide the requested MNP information for
the subscriber to the gsmSCF.
##### 12.3.2.1.2 Information Elements
* * *
Information element name Status Description MNP Information Result M This IE
contains the MNP information for the subscriber. It is described in a table
below.
* * *
MNP Information Result contains the following information:
+---------------------------+--------+-----------------------------+ | Information element name | Status | Description | +---------------------------+--------+-----------------------------+ | Routeing Number | C | This IE shall be present, | | | | if requested by the gsmSCF. | | | | Refer to 3GPP | | | | TS 23.066 [17]. | +---------------------------+--------+-----------------------------+ | IMSI | C | This IE shall be present, | | | | if requested by the gsmSCF. | | | | Refer to 3GPP | | | | TS 23.066 [17]. | +---------------------------+--------+-----------------------------+ | MSISDN | C | This IE shall be present, | | | | if requested by the gsmSCF. | | | | Refer to 3GPP | | | | TS 23.066 [17]. | +---------------------------+--------+-----------------------------+ | Number Portability Status | C | This IE shall be present, | | | | if requested by the gsmSCF. | | | | It may have one of the | | | | following values: | | | | | | | | - Not Known To Be Ported; | | | | | | | | - Own Number PortedOut; | | | | | | | | - Foreign Number Ported | | | | To Foreign Network; | | | | | | | | - Own Number Not Ported | | | | Out; | | | | | | | | - Foreign Number Ported | | | | In. | | | | | | | | Refer to 3GPP | | | | TS 23.066 [17]. | +---------------------------+--------+-----------------------------+
###### ## Annex A (informative): Handling of Apply Charging GPRS and Apply
Charging Report GPRS
This Annex provides an example to demonstrate the handling of Apply Charging
GPRS and Apply Charging Report GPRS.
{width="6.732638888888889in" height="8.70138888888889in"}
Figure A.1: Example of Handling of Apply Charging GPRS and Apply Charging
Report GPRS
In Figure A.1, data volumes transferred for the active PDP context are listed
on the left-hand side of diagram. The following is a description of the
example:
a) Apply Charging GPRS threshold set to 2000, no tariff switch timer set.
b) After 2000 units of data have been transferred, an Apply Charging Report
GPRS is sent to the gsmSCF.
c) The gsmSCF sends another Apply Charging GPRS with a 2000 unit threshold.
d) After 2000 units of data have been transferred, an Apply Charging Report
GPRS is sent to the gsmSCF.
e) Another threshold (2000) is set by the gsmSCF in Apply Charging GPRS, and a
tariff switch timer is set.
f) After 2000 units have been transferred, Apply Charging Report GPRS is sent
to the gsmSCF, as a tariff switch timer has expired since the last Apply
Charging GPRS, values for volumeTariffSwitchInterval and Volume transferred
since the tariff switch are sent. The gsmSCF stores the value
volumeTariffSwitchInterval.
g) The gsmSCF sends another Apply Charging GPRS with a 2000 unit threshold.
h) After 2000 units of data have been transferred, an Apply Charging Report
GPRS is sent to the gsmSCF.
i) Apply Charging GPRS sets a tariff switch timer, which does not expire
before the next Apply Charging Report GPRS.
j) A change in QoS is reported so Apply Charging Report GPRS is returned to
the gsmSCF containing VolumeIfNoTariffSwitch as no tariff switch has occurred
since the last Apply Charging Report GPRS. The gsmSCF should store this value
if the volume of data transferred at each QoS level is to be calculated. The
Tsw sent in the previous Apply Charging GPRS is stopped. In this example the
tariff switch timer (Tsw) does not expire before this QoS change. If Tsw had
expired the Apply Charging Report GPRS would report the
volumeTariffSwitchInterval in the normal way.
k) An Apply Charging GPRS is sent giving a new threshold. This threshold is
service logic dependent and does not rely on any previous value sent. In the
example it is \'previous threshold - volume transferred since last threshold
was set\'.
l) The VolumeSinceLastTariffSwitch is reported in the Apply Charging Report
GPRS. Note: this includes data transferred before and after the QoS change.
m) Note that a tariff switch timer is set and expires.
n) A final Apply Charging Report GPRS is returned containing the data volume
transferred since the last tariff switch, and also the total volume
transferred at the previous tariff.
The calculations made by the gsmSCF in this example are:
a) Total Data Volume Transferred in this example: Total of all
volumeTariffSwitchInterval received + final volumeSinceLastTariff switch is
(5500 + 5000) + 1500 = 12000 units of data
b) Data Volume transferred for each tariff: (periods separated by Tsw in
figure A.1)
\- 1st Tariff: taken from Apply Charging Report GPRS (signal f))
volumeTariffSwitchInterval = 5500 units of data
\- 2nd Tariff: taken from Apply Charging Report GPRS (signal n))
volumeTariffSwitchInterval = 5000 units of data
\- 3rd Tariff: taken from VolumeSinceLastTariffSwitch (signal n))
volumeTariffSwitchInterval = 1500 units of data
c) Data Volume Transferred at each QoS level (One QoS Change Occurs in figure
A.1)
\- 1st QoS level (up to signal 10): All volumeTariffSwitchIntervals + final
VolumeSinceLastTariffSwitch at QoS change is 5500 + 3200 = 8700 units of data.
\- 2nd QoS level (from signal 10 onwards): (Value of first
VolumeTariffSwitchInterval received after QoS change - VolumeNoTariffSwitch
Received directly after QoS change ) + Volume transferred since this tariff
switch is (5000-3200) + 1500 = 3300 units of data.
Note: The volume reported to the gsmSCF in an Apply Charging Report GPRS may
exceed the threshold sent in the previous Apply Charging GPRS, e.g. if the
delta timer exceeds the threshold received in the subsequent Apply Charging
GPRS or a data packet is transferred causing the threshold to be exceeded.
#