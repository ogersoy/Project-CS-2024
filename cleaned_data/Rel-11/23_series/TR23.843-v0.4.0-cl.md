# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document investigates core network overload scenarios and
potential general handling solutions, in particular:
  1. Identify and document events that have occurred and caused network > disturbances, also the possible scenarios that have high > possibility for occurrence in the3GPP network, which may result in > overload for core network entities. Such scenarios/events may > include HLR/HSS overload by RNC restart, and > misbehaving/3GPP-non-compliant mobiles causing unpredictable > system response ,
  2. Analyse the criticality of the scenarios and determine whether it is > required to take actions for the identified scenarios
  3. Study ways to mitigate and eliminate overload scenarios that are > identified to be critical.
  4. This study will focus on core network control plane overload > aspects. User plane overload aspects may be considered at a later > stage if deemed necessary.
The information provided about the HSS/HLR overload will serve as a starting
basis for the study. All currently deployed 3GPP networks should be covered in
the study, including LTE
The study should avoid overlap with other parallel activities within 3GPP, in
such situations close cooperation with the specific WG needs to be maintained.
During the study, if potential security threats such as denial of service
attack scenarios are identified, SA WG3 must then be informed to take
appropriate measures.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 41.001: \"GSM Release specifications\".
[3] 3GPP TS 23.116: "Super-Charger technical realization".
[4] IETF RFC 3588: "Diameter Base Protocol"
[5] 3GPP TS 23.401: \"GPRS Enhancements for E-UTRAN Access\".
[6] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[7] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core
Network Protocols; Stage 3\".
[8] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [x] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[x].
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[x] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [x].
# 4 Scenarios and problem analysis for core network overload
## 4.1 General
The following clauses describe and analyse scenarios which may cause overload
of core network entities due to high signalling load caused by, e.g.
  1. Flood of registrations caused by special mobility events
     * Mass of mobile users attempting simultaneously to perform > registration procedures such as Attach or location updating. > Examples are scenarios where a train or bus is crossing > LAI/RAI boarders, or a big plane arrives at an airport.
> NOTE: These scenarios and potential solutions may be similar to those that
> were addressed by the former "Registration in Densely-Populated Area (RED)"
> work item which are documented in TR 23.880..
  1. Frequent RAT-reselection due to scattered 3G/4G coverage
     * Frequent loss of broadband coverage may potentially cause > extremely frequent intersystem change activities by e.g. smart > phones.
  2. Flood of registrations after O&M operations
     * Restart of RAN nodes (i.e. RNC and BSC) may cause a massive > number of registration attempts, depending on the behaviour of > the base stations controlled by the restarted RAN nodes. This > is discussed in more detail in sub-clause 4.2
     * Restart or failure of CN nodes which handle mobility management > (MSC server/VLR, SGSN, MME)
> NOTE: A related study item dealing with CN node failures in EPC is performed
> by CT4. The work is documented in TR 23.857.
  1. Flood of resource allocation requests for mobile originating services
     * Massive number of mobile users attempt simultaneously to > initiate signalling procedure in order to allocate resources > for mobile originating services, such as establishing bearers.
  2. Flood of mobile terminated events
     * A massive number of mobile terminated events simultaneously for specific users belonging to specific HLR/HSS (e.g. sending SMS to say Happy New Year in China Spring Festival) may cause excessive signalling load within the PLMN.
     * A massive number of mobile terminated events simultaneously causing signalling towards the same SGSN/MME where a large number of receiving users are located (e.g. content pushed to every member of push type services) may cause excessive signalling load within the PLMN.
## 4.2 Scenario 1: Overlaid RATs and failure of RAN node
NOTE: While the following description focuses on GSM and UMTS, it may also be
applicable to other combinations of RATs.
Many geographic areas are now covered by more than one radio technology (e.g.
GSM and UMTS) and many of the customers in those areas have devices that
support both GSM and UMTS.
Typically the GSM/UMTS cells are configured with (release 99) neighbour
cell/cell reselection information that 'push' GSM/UMTS devices to UMTS
whenever there is [reasonable] UMTS coverage. In Release 8, the adoption of
"absolute priorities" for RAT re-selection, seems to mean that the
GSM/UMTS/LTE device will change to the highest priority RAT whenever it has
even minimal quality coverage of that RAT.
It seems that when some RNCs restart, they issue commands to the NodeBs that
cause the NodeBs to themselves restart and/or to do 'something' to their
control channels (e.g. perhaps to set the cell as "barred", or, to stop
transmitting any power on the pilot channel ?) . In turn, it appears that this
disruption of the control channels cause the mobiles to perform cell
reselection. If all the NodeBs are in a similar, restarting, situation then
the mobiles move to GSM.
Typically the GSM cells are in a different Routing Area and frequently a
different Location Area to the 3G cells. Hence the mobile performs an LA and
RA update. While camped on the GSM cells, the received neighbour cell
information and cell reselection parameters encourage the mobiles to keep
looking for UMTS cells. So, within seconds of the UMTS cells completing their
restarts, the mobiles return to UMTS and perform another RA and LA update.
This can be the cause of a huge surge in Mobility Management signalling that
can damage MSCs/SGSNs and/or HLRs.
Note that currently the behaviour of GSM BSCs upon restart may be less of an
issue. This is because, IF their BCCHs are switched off upon BSC restart, the
2G-only devices have no other RAT to select to, and, any GSM/UMTS/LTE devices
will probably be already camped on UMTS/LTE if there is any coverage.
## 4.3 Scenario 2: CN overload due to flood of registrations and mobility
management events
An HLR/HSS or core network node may be overloaded due to registration and
mobility management events such as a massive number of Attach and default
bearer requests in a short period of time. This may be triggered, for example,
when a large number of M2M devices try to re-Attach as a result of failure of
a core network node.
Attach (including CS LAU with IMSI attach) procedure and TAU/RAU/LAU
procedures are typical registration messages from 3GPP network perspective.
During Attach procedure (including CS LAU with IMSI attach) over GERAN/UTRAN
access, the SGSN, MSC/VLR and HLR/HSS may be overloaded due to a massive
amount of registration related signalling. Sustained high levels of
registration signalling can prevent the network from recovering gracefully.
Similarly, during Attach procedure over E-UTRAN access, the MME and HLR/HSS
may be overloaded due to a massive amount of registration related signalling.
Sustained high volume of Attach requests can prevent the network from
recovering gracefully. In addition, the S-GW/P-GW may also become overloaded
due to a flood of default bearer establishment signalling.
During registration procedure over non-3GPP access, the S-GW/P-GW and HLR/HSS
(i.e. 3GPP node) may be overloaded due to massive amount of registered related
signalling. Other non-3GPP related nodes (e.g. ePDG) are not discussed in this
TR.
## 4.4 Scenario 3: CN overload due to flood of resource allocation for mobile
originating services
When massive numbers of mobile users attempt simultaneously to initiate mobile
originating services (e.g. to establish an application session), UEs signal to
allocate resources in core and serving networks, (e.g. Service Request
procedure, UE requested PDN connectivity procedure). This massive number of
requests may be triggered, for example during a catastrophic event.
During the process of setting up an application session, the UE may start
signalling for establishing a dedicated bearer. This results in signalling to
establish a bearer between SGSN/GGSN or MME/S-GW/P-GW. When a massive number
of such signalling requests need to be handled in a short period of time, it
may overload the network nodes.
## 5 Scenario 4: CN overload due to flood of mobile terminated events
When a massive number of users attempts to initiate mobile terminating
services simultaneously for specific users belonging to specific HLR/HSS, it
causes an excessive signalling load within the network, e.g. to query for the
routing information for next hop from the specific HLR/HSS. Similarly some
automatic information services or advertisements by SMS or IP based calling
servers/services could cause excessive load. In such cases, the HLR/HSS gets
possibly overloaded due to massive number of queries.
For a typical mobile terminated service (e.g. SMS), a high level sequence is
as follows:
1) Service request arrives at PLMN's gateway server [SMSC, G-MSC, IMS IP-SM-
GW]. Server starts to process the request;
2) Gateway server queries HSS/HLR for profile/ routing information.
3) Gateway server performs any required processing and forwards the service to
the serving network entity.
Step 2 in the sequence above can contribute to high load at the HLR/HSS when a
massive number of requests for profile/ routing information have to be
processed in a short period of time.
Push like services and applications generate mobile terminated datas
triggering signaling requests in the core network. Routing the IP packet data
that is destined to mobile terminals may trigger SGSN or MME to initiate
Paging followed by Service Request procedures. When a massive number of such
mobile terminated signaling requests need to be handled by the same SGSN/MME
in a short period of time, it may overload network nodes that handle these
requests.
# 5 Architecture Principles
The study should follow the principles as defined below:
  1. Already specified overload control means as well as tools available to manage or handle the overload scenarios should be examined and preferred, if they are adequate, and these should be improved if possible, or if deemed necessary.
  2. General overload handling solutions that work regardless of the cause are preferred.
  3. The study will focus initially on providing a solution that does not require UE modifications. However the study does not preclude the possibility for improving UE behaviour.
# 6 Solutions and function flow descriptions
## 6.1 Improved Control of user registration attempts
### 6.1.1 Introduction
This section addresses solutions which provide improved control of user
registration attempts in order to avoid unnecessary load of core network
entities involved in mobility management, i.e. MSC/VLR, SGSN, MME and HSS/HLR,
e.g.:
  * Flexible network control of Attach and location updating procedures > (LAU, RAU, TAU) to avoid overload of core network nodes,
  * Avoiding frequent RAT reselection when ISR is not applicable.
The solution space includes,
  * existing concepts, such as:
```{=html}
``` \- control of UE inter RAT-activities of the UE by appropriate setting >
of parameters impacting inter-RAT cell selection/reselection
  * selective RA update procedure
  * deployment of ISR functionality
```{=html}
``` \- improvements to existing concepts and new concepts, such as, e.g.:
```{=html}
``` \- additional cause values in registration reject messages indicating >
core network overload
  * overload control functionality developed under the NIMTC work item
### 6.1.2 Solution 1: Optimizing the periodic LAU/RAU/TAU signalling
In Rel-10, TS23.401/23.060 has specified mechanism for optimising the
LAU/RAU/TAU signalling. The following solution describes how this mechanism
can be used to improve the core network load conditions.
To prevent network from overload caused by unnecessary periodic LAU/RAU/TAU
signalling, Core network entity, i.e. SGSN/MME, based on operator policy
and/or subscription information received from HSS, may generate a longer
periodic update timer, i.e. periodic LAU/RAU/TAU timer, for some specific UE,
e.g. UE configured for MTC, and allocate it to the UE. Such UE then would not
initiate too frequent a periodic update procedure which helps to reduce the
interacting with core network entity and thus the possibility core network
entity falls into overload.
### 6.1.3 Solution 2: NAS Reject solution
When the core network entity (e.g. MSC/VLR, SGSN and MME) is overloaded or
detects other core network entity overload (e.g. HLR/HSS), it rejects the NAS
request for registration attempt (e.g. Attach Request, LAU Request, RAU
Request, TAU Request). Dedicated cause value, as specified in TS 24.008 [7] or
TS 24.301 [8], is included in the reject message indicating core network
overload.
Editor's Note: If the core network entity (e.g. MSC/VLR, SGSN and MME) needs
to know other core network entity (e.g. HLR/HSS) overload status is FFS.
A back-off time can also be included in the NAS reject message to defer the UE
to initiate NAS request again, e.g. as specified in TS 23.401 [5] and TS
23.060 [6] for APN based congestion control.
The GPRS Attach and RAU reject messages specified in TS 24.008 [7] (and R'97
specification 04.08) already carry a timer T3302 that may be suitable for this
purpose.
This NAS rejection solution can be applied to manage overload as a result of
flood of resource allocation for mobile originating services specified in
section 4.4.
### 6.1.4 Ideas for RAN node restart CN overload prevention
With the possible exception of O&M specifications, the following mechanisms
are believed to be achievable with the existing 3GPP specifications.
When performing RNC/(e)NodeB restarts:
a) use Access Class Barring bits on the (e) NodeB rather than Cell Barring.
This is because ACB shall not trigger cell reselection while Cell Barring
shall trigger reselection.
b) do not restart all the nodeBs/UMTS cells at the same time. By staggering
the time of nodeB restarts, most mobiles will perform intra-UMTS cell
reselection and remain in the same LA/RA, rather than performing inter-RAT
cell reselection.
c) do NOT use GSM features that dynamically allocate extra SDCCH signalling
channels. This is because GSM radio interface signalling channel congestion
can be used to slow down the rate at which mobiles update to 2G.
This is particularly useful as, until 4 (CS domain) / 5 (PS domain) failed GSM
access attempts, the mobile's temporary 3G core network IDs and registered 3G
LA/RA are not deleted, thus, a return to 3G during this period does not lead
to any update to the 3G nodes.
d) activate ACB on GSM cells while performing a UMTS restart in that
geographic area. (This can delay the 2G LA/RA update and hence avoid the
deletion of the UMTS temporary IDs and registered LAI/RAI).
e) on UMTS cells activate ACB for "mobility management events" while
performing a GSM or LTE restart in that geographic area. . (This can delay the
3G LA/RA update and hence avoid the deletion of the other RAT's temporary IDs
and registered LAI/RAI).
f) configure GSM cells/BSC to reject/delay/ignore Channel Request messages
that indicate mobility management events, (This can delay the 2G LA/RA update
and hence avoid the deletion of the UMTS temporary IDs and registered
LAI/RAI).
g) configure GSM cells/BSC, to locally (from within the BSS) return Location
Update Reject messages (e.g. with a cause value indicating "search for other
LAs in this PLMN") .
### 6.1.5 Signalling Load Reduction for TAU/RAU caused by UE mobility across
mobility management entities
During the TAU/RAU procedure, the new MME/SGSN needs to send Update Location
message to the HSS/HLR and retrieve the subscription data from the HSS/HLR.
Frequent TAU/RAU may cause HSS/HLR or core network to be overloaded. For the
2G/3G system, one way of decreasing the Update Location message from the SGSN
to the HSS/HLR is to increase the geographical coverage of the RAI, however
this method will increase the signaling load of Paging in the radio interface,
and there is no good method to avoid/suppress the Ping-Pong RAU between the
borders of two RAIs/SGSNs/SGSN Pools. In the LTE system, the target MME
includes the last visited TAI in the new TAI list allocated to the UE during
the TAU procedure, and the Ping-Pong TAU within the same MME or the same MME
pool can be avoided. The MME can dynamically change the TAI items of the TAI
list assigned to the UE according to the mode of UE, e.g. if the UE moves
quickly, a large TAI list is assigned to the UE. The TAU procedure is
decreased and the Update Location message from the MME to the HSS is also
decreased accordingly. However there is also no good method to avoid/suppress
the Ping-Pong TAU between the border of two MMEs/MME Pools.
Combining a 2G SGSN and a 3G SGSN to one combined 2G/3G-SGSN and one RAI
shared by the 2G and 3G RAT is defined in TS 23.060 to avoid/suppress the RAU
procedure when the UE in IDLE state moves between 2G and 3G system. This
technology is the basic idea of the ISR function defined in the TS 23.401. ISR
was designed to reduce the required inter-RAT TAU/RAU of the UE which moves
between the border of S4-GSN and MME. To support ISR feature, one enhancement
was introduced that HSS records the current MME/S4-SGSN and previous
S4-SGSN/MME and will not execute Cancel Location procedures with previous
S4-SGSN/MME, when receiving Update Location request from new S4-SGSN/MME even
the HSS does not know whether the ISR is activated to the UE. The HSS also
needs to send Insert Subscriber Data to both serving and previous
S4-SGSNs/MMEs to keep their Subscriber Data up to date. When UE moves between
serving and previous S4-SGSN/MME, its TAU/RAU signalling load can be saved a
lot, since Update Location procedures are not required.
The feature of two CN nodes registration in the HSS/HLR was designed for ISR
support so far, and not applicable to the following UE mobility scenarios with
no ISR support, 1) MME \ MME; 2) MME \ Gn/Gp SGSN; 3) S4 SGSN \
S4 SGSN; 4) Gn/Gp SGSN \ Gn/Gp SGSN; 5) S4 SGSN \ Gn/Gp SGSN.
But more benefits on signalling load reduction can be expected, if the feature
of two CN nodes registration in the HSS/HLR can be extended to these
scenarios, especially in case of Ping-Pong mobility happens simultaneously,
which may increase the signalling load dramatically. See Figure 6.1.x.1.
Figure 6.1.5.1 Optimized RAU/TAU Procedures
With this solution,
  * When serving SGSN/MME sends Update Location Request to HSS, the previous SGSN/MME will also be notified to HSS. HSS records both Serving and Previous SGSNs/MMEs for this UE, but will not send Cancel Location Request to Previous SGSN/MME, since UE may move back in a short period time in case of Ping-Pong mobility;
  * Without executing Cancel Location to previous SGSN/MME, the Subscriber Data of this UE in both Serving and Previous SGSNs/MMEs shall be updated simultaneously by HSS, if HSS needs to do so, to guarantee both Subscriber Data in both nodes are up to date;
  * Every time receiving Update Location Request, HSS will use the Serving and Previous SGSNs/MMEs of this latest Update Location Request to update its local stored Serving and Previous SGSNs/MMEs, and send the Cancel Location Request to outdated local stored SGSNs/MMEs.
  * The TAU/RAU procedure is performed without sending Update Location message from the two SGSNs/MMEs to the HSS/HLR if the two SGSNs/MMEs are registered in the HSS/HLR.
Since HSS rarely updates subscriber data actively, but the Update Location is
executed per TAU/RAU procedure, signalling load to both HSS and MME/SGSN will
be saved a lot, especially in case of UE mobility Ping-Pong scenario.
## 6.2 Solutions targeting at HSS/HLR overload prevention
### 6.2.1 Introduction
This section addresses solutions aiming to prevent HSS/HLR overload, e.g:
  * minimizing HSS/HLR interrogations in registration procedures,
  * optimization of HSS/HLR message content,
  * mechanisms to enable core network nodes (MSC/VLR, SGSN, MME) to obtain information on HSS/HLR load status.
The solution space includes,
  * existing concepts, such as:
```{=html}
``` \- provision of Super-Charger functionality as defined in TS 23.116 [3]
  * overload protection function for HSS using Diameter (see e.g. RFC 3588 [4])
  * avoidance of unnecessary authentication procedures
```{=html}
``` \- new concepts, such as, e.g.:
    -   potential optimizations in user profile download from HSSload
        > indicators in messages sent by the HSS/HLR
#### 6.2.1.1 Evaluation of Core Network Signalling in case of HLR/HSS overload
Generally, when the HLR/HSS detects overload, it discards the received
messages (e.g. due to local buffer overflow), complete parts of the incoming
dialogs, or rejects the request optionally with overload indication.
This section intends to analyze most of all the procedures related with
HLR/HSS and capture the solutions/behaviours targeting at procedure handling
in case of HLR/HSS overload. The procedures below apply to both MAP and
Diameter application signalling.
Update Location Procedure
This procedure is used by the MME/SGSN/MSC to update location information in
the HLR/HSS and download subscription profile from the HLR/HSS.
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
However, in some network scenarios, a lot of UEs register to the mobile
network simultaneously, which makes it necessary for the HLR/HSS to process a
lot of Update Location Request messages at the same time and cause HLR/HSS
overload. This should be resolved, using solutions developed and evaluated in
section 6.2, e.g. providing overload indication to MME/SGSN/MSC.
If the HLR/HSS receives Update Location Request message when it is overloaded,
it may ignore it, e.g. due to local buffer overflow. The MME/SGSN/MSC could
delay the registration for this UE and the subsequent arriving UE (e.g. reject
the attach request for certain periods) based on, e.g. the overload indication
received before, or local configuration. It should be noted that following a
timeout in SGSN/MME, the UE will retry the request requiring a new update
location procedure or further throttling at SGSN/MME. These aspects should be
addressed in the solutions developed and evaluated in section 6.1 and 6.2.
Cancel Location Procedure
This procedure is used by the HLR/HSS to delete a subscriber record from the
MME/SGSN/MSC.
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
If it is executed when the HLR/HSS is overloaded, the HLR/HSS can delay the
process for some UEs. This is normal handling in case of HLR/HSS overload, and
there is no problem for the core network.
Purge UE Procedure
This procedure is used by the MME/SGSN/MSC to indicate to the HLR/HSS that the
subscriber's profile has been deleted in the MME/SGSN/MSC.
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
If the HLR/HSS receives the Purge message when it is overloaded, it may ignore
it, e.g. due to local buffer overflow. In this case, the MME/SGSN/MSC could
resend the Purge message later based on implementation solution. There is no
problem for the core network.
Insert Subscriber Data Procedure
This procedure is mainly used by the HLR/HSS to download subscription profile
to the MME/SGSN/MSC during the Update Location procedure or due to
subscription update.
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
If there are a large number of such concurrent updates, the HLR/HSS is able to
control the sequence of execution, e.g. controlling the message rate to
outbound buffers such that it does not cause HLR/HSS overload.
If it is executed when the HLR/HSS is overloaded, the HLR/HSS can delay the
process for certain UEs. This is the normal handling in case of HLR/HSS
overload, and there is no problem for the core network.
Delete Subscriber Data Procedure
This procedure is mainly used by the HLR/HSS to remove some or data of the
HLR/HSS user profile stored in the MME/SGSN/MSC.
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
If there are a large number of such concurrent updates, the HLR/HSS is able to
control the sequence of execution, e.g. controlling the message rate to
outbound buffers such that it does not cause HLR/HSS overload.
If it is executed when the HLR/HSS is overloaded, the HLR/HSS can delay the
process for certain UEs. This is the normal handling in case of HLR/HSS
overload, and there is no problem for the core network.
Authentication Procedure
This procedure is used by the MME/SGSN/MSC to request the authentication
information from the HLR/HSS. It is common to be executed as part of UE
registration procedure (e.g. Attach procedure).
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
However, in some network scenarios, a lot of UEs register to the mobile
network simultaneously, which makes it necessary for the HLR/HSS to process a
lot of Authentication Request messages at the same time during such
registration procedures, causing HLR/HSS overload. It should be resolved, and
the solutions are developed and evaluated in the section 6.2, e.g. providing
overload indication to the MME/SGSN/MSC.
If the HLR/HSS receives the Authentication Request message when it is
overloaded, it may ignore it, e.g. due to local buffer overflow. In this case,
the MME/SGSN/MSC could reject the request for this UE (due to failure of
authentication in time) and the subsequent arriving UE (e.g. reject the attach
request for certain periods) based on, e.g. the overload indication received
before, or local configuration. This should be addressed in the solutions
developed and evaluated in section 6.1 and 6.2.
Fault Recovery (Reset) Procedure
This procedure is used by the HLR/HSS, after a restart, to indicate to the MME
and SGSN that a failure has occurred.
It will not cause HLR/HSS overload as it is sent by the HLR/HSS and the
MME/SGSN/MSC will not trigger new Update Location procedure to the HLR/HSS
immediately.
This procedure will not occur when the HLR/HSS is overload as it is executed
after a restart.
Notification Procedure
This procedure is mainly used by the MME/SGSN/MSC to notify the HLR/HSS about
the terminal information, APN-PGW pair, UE reachable or memory capacity and
etc.
Normally, this procedure is performed per UE and it will not cause HLR/HSS
overload.
If the HLR/HSS receives the Notify Request message when it is overloaded, it
may ignore it, e.g. due to local buffer overflow. In this case, the
MME/SGSN/MSC could resend the Notify Request message later based on
implementation. There is no problem for the core network in most of the cases,
e.g. for updating the terminal information, or updating the UE reachable or
memory capacity, as they are not so urgent.
But there is a risk of breaking the seamless handover between 3GPP and
non-3GPP if the MME fails to update the APN-PGW pair in time because it is
possible that the UE performs handover before the MME succeeds to update the
pair. So this problem should be resolved.
T-ADS Query Procedure
This procedure is for domain selection for mobile terminated voice and SMS
procedure as defined in TS 23.221.
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
If a lot of MT services for T-ADS arrive simultaneously, T-ADS could check the
buffer information for redundant requests in order to reduce the signalling
towards the HLR/HSS. If such MT services are for different UE, it couldcause
server overload (e.g. T-ADS, and HLR/HSS and etc). In this case, the T-ADS
could terminate the mobile terminated service.
If the HLR/HSS receives the T-ADS Request when it is overloaded, it may ignore
it, e.g. due to local buffer overflow. In this case, the T-ADS could select a
target domain, e.g. based on default configuration, or terminate the mobile
terminated service. The normal procedure, however is to retry the T-ADS
request.
Sending Routing Information Procedure
This procedure is for mobile terminated services (e.g. MT SMS, MT LCS, etc).
Normally, this procedure is performed per UE and will not cause HLR/HSS
overload.
If a lot of MT services for routing query arrive simultaneously, especially
from different senders for different UEs, it could cause HLR/HSS overload. In
this case, the sender could terminate the mobile terminated service.
If the HLR/HSS receives the routing query request when it is overloaded, it
may ignore it, e.g. due to local buffer overflow. If the sender resends the
request, the service is terminated, and the problem of overload is alleviated.
### 6.2.2 Solution 1: Optimizing subscription data download from HSS
The risk of overload on HSS/HLR interfaces is partially due to the fact that
the size of messages sent from HSS/HLR to Core Network nodes (SGSN, MME,
MSC/VLR) which include subscription data, is increasing with every release of
the specifications.
When the MAP protocol is used, e.g. on the Gr interface, the bare size of
certain MAP information elements (e.g. _InsertSubscriberDataArg_ in the Insert
Subscriber Data (ISD) message), causes message segmentation by the MAP layer.
MAP segmentation requires acknowledgements for each message segment (see TS
29.002). This further increases the load on MAP-based HSS/HLR interfaces.
Subscription data consists of following three types of information:
  * user identities (e.g. IMSI, MSISDN),
  * dynamic data (e.g. SGSN number, SGSN address, MNRG),
  * static data (e.g. APN subscriptions, ODB).
Static subscription data is highly duplicated among the individual user
subscriptions. Even big network operators with more than 500 million
subscribers typically offer less than 100 different tariffs. However,
subscriptions for the same tariff type usually share the same static
subscription data for all corresponding users.
The duplication property of static subscription data can be utilized by
introducing the concept of Subscription Profile IDs on HSS/HLR interfaces.
The Subscription Profile ID serves as an identifier of a corresponding record
of static subscription data stored in CN nodes (SGSN, MME and MSC/VLR) and in
HLR/HSS. It can be used in messages indicating subscriber data from the
HLR/HSS to the CN nodes instead of providing the entire data record itself.
Editor's note: The details of employing the Subscription Profile ID in the
Insert Subscriber Data procedure are FFS. It needs to be studied further if
there could be risks that subscription records stored in HLR/HSS and CN node
can get unsynchronized.
### 6.2.3 Solution 2: HLR/HSS Overload Notification
Current HLR load control mechanisms use SS7 / MAP mechanisms for throttling
traffic per IMSI. HLRs discard messages for MAP operations taking into account
the priority of their application context, according to the overload control
for MAP entities. However, prioritization is per MAP operation, e.g. the
Update Location procedure has higher priority than Purge procedure, and the
HLR may discard the Purge handling but process the Update Location procedure
in case of overload.
For Diameter, load control mechanisms used are overload signal (3004
DIAMETER_TOO_BUSY) and message discards. These mechanisms are useful to handle
transient HSS server overload by load balancing or discarding. However, no
feedback is provided to the Diameter clients (SGSN, MME, MSC) to throttle
traffic to the HSS to handle a sustained overload condition.
For both MAP and Diameter application, request throttling is applied per IMSI
only and this is not sufficient to handle sustained HLR/HSS server overload.
In addition, when the HLR/HSS has to handle a lot of Update Location
procedures at the same time, e.g. thousands of UEs register into the network
simultaneously; current mechanisms do not provide feedback to clients to slow
down traffic. With retry mechanism in MME/SGSN/MSC for Update Location
procedure (e.g. TC timer for MAP), the overload situation in the HLR/HSS will
be worse if the HLR/HSS just discards messages in case of overload according
to current principles. In this case, it will be better if the HLR/HSS can
provide overload indication so that the MME/SGSN/MSC could reduce the Update
Location request to the overload HLR/HSS.
This solution is limited to addressing overload due to signalling on Diameter
based interfaces to HSS and MAP based interfaces to HLR. Network nodes like
MME and SGSN can use feedback from HSS/HLR overload notification to limit
overloading the HSS/HLR. This can be coupled with existing mechanisms in the
core network to limit overall load in the system.\ NOTE: Overload of the
IP/SS7 transport network itself is not addressed here. This is handled by SCTP
flow control for Diameter/SIGTRAN and TCAP/SCCP for SS7 networks.
When the HLR/HSS detects overload, it could provide the overload indication as
follows:
  * The HLR/HSS includes an overload indication in each response message to the MME/SGSN/MSC, e.g. Update Location Accept, Update Location Reject or Authentication Answer message. This overload indication is not a per IMSI indication.
  * Alternatively, the HLR/HSS sends a dedicated Overload Notification message to the MME/SGSN/MSC which has ongoing message exchange with the HLR/HSS (e.g. ongoing dialog for Update Location procedure).
Editor's Note: This alternative could be valid for MAP, but not for diameter.
In diameter, adding a new command to an existing application implies defining
a completely new application, which should be out of the question. So, the
only alternative would be adding optional IEs indicating the overload status
inside existing messages.
  * List of HLR/HSS Ids could also be provided together with the overload indication, so that the MME/SGSN/MSC can reduce the registration only for those UEs whose IMSI leading digits are equal to one of these HLR/HSS Ids.
Editor's Note: if the IMSI corresponds to another (Home) PLMN how the VPLMN
may associate a "List of HLR/HSS Ids" with "IMSI leading digits equal to one
of these HLR/HSS Ids" is to be clarified (when an HPLMN opens a new IMSI range
or adds a new HSS/HLR, this HPLMN operator should NOT have to warn all its
roaming VPLMN partners).
  * A back-off timer could also be provided by the HLR/HSS.
Editor's Note: It is FFS how the receiving node (MME/SGSN/MSC/VLR) stops the
overload notification mechanism
This solution is mainly for the Update Location dialogue. In other words, the
HLR/HSS can process other requests (e.g. Notify Request for update APN-PDN GW
pair) without overload indication, or discard requests.
Editor's Note: In Diameter, Update Location and Notify are two different
messages; but not in MAP. The Notify Request message, as defined by SA2, has
been implemented in MAP with the existing MAP Update Location message. So it
may not be straightforward for the HLR/HSS to discard one and not the other
based only in the type of message.
The above mechanism can also be applied in a node internal manner without
HSS/HLR triggering based on implementation specific mechanism.
Editor's Note: It is FFS how the MME/SGSN/MSC handles the UE registration
request in this scenario.
### 6.2.4 Solution 3: Prevent HLR/HSS from overload due to RAT-reselection in
PS domain
#### 6.2.4.1 General
When inter RAT Routeing Area Update procedure or inter RAT Tracking Area
Update procedure is performed as described in TS 23.060[6] and TS 23.401[5],
the HSS/HLR will send the Cancel Location Message to the old SGSN/MME to
delete the MM contexts and PDP/EPS bearer contexts for the UE and send the
whole Subscription data to the new SGSN/MME.
In the scenario of frequent RAT-reselection due to scattered 3G/4G or 2G/3G
coverage, the HSS will frequently send almost same Subscription data to the
same SGSN or MME, which brings the risk of overload on HSS/HLR interfaces.
For this scenario, the HSS/HLR can generate a Timer according to the network
condition, i.e. frequent RAT-reselection is detected, and sends it to the old
SGSN/MME within the Cancel Location Message and then the SGSN/MME will not
delete the stored MM contexts and PDP/EPS bearer contexts for the UE before
Timer expires.
If the UE enters again into the coverage of the old SGSN/MME and the old
SGSN/MME determine that the Timer is still running, the old SGSN/MME will
include an indication in Update Location message to inform HLR/HSS that the
original MM contexts and PDP/EPS bearer contexts for the UE is still
available. So the HLR/HSS will not send the Subscription data to the old
SGSN/MME anymore and the old SGSN/MME will perform the Location Update
procedure according to the original MM contexts and PDP/EPS bearer contexts.
#### 6.2.4.2 Evaluation
This solution is different from the now existing Super-charge mechanism in TS
23.116, and can be regarded as the enhancement of it: In Super-charge
mechanism, the MM contexts and PDP/EPS bearer contexts might be stored
permanently in SGSN/MME once the procedure is triggered, and that would bring
additional burden to the SGSN/MME. However in this solution, the stored MM
contexts and PDP/EPS bearer contexts in SGSN/MME would be deleted when the
timer is expired. Alternatively, this timer may also be internally configured
in the SGSN/MME.
There is no strong relation between ISR and this solution: In ISR, UE needs to
attach both in SGSN and MME, and when UE moves between the SGSN and MME, it
does not need to initiate location update procedure. Paging should also be
done both in the SGSN and MME. However, in this contribution, HLR/HSS knows
exactly where the UE is, i.e. in SGSN or MME. Only when UE moves between
SGSN/MME(s), the old SGSN or MME can keep the stored MM contexts and PDP/EPS
bearer contexts until the timer expired.
## 6.3 Solution: Optimizing control of mobile terminated services by CN node
For the scenario where massive number of small downlink data to IDLE UEs, in
order to avoid massive Paging message impacts to the network, the mechanism of
optimizing the handling of abnormal conditions in UE triggered Service Request
procedure (specified in TS23.401 section 5.3.4.2) can be used to reduce the
rate of Downlink Data Notifications to MME.
On receiving massive number of Downlink Data Notifications from Serving GW,
the MME determines that the rate of the events has become significantly high
and that its load exceeds the operator configured threshold. The MME indicates
"Delay Downlink Packet Notification Request" with parameter D to the Serving
GW. The Serving GW uses this delay value to reduce the rate of sending
Downlink Data Notification messages. As a result the rate of Paging triggers
will be reduced.
# 7 Conclusions
#