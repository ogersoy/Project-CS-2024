# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
In the context of support of roaming for voice over IMS, the GSM Association
has decided that local breakout in the visited network will be needed (see
GSMA PRD IR.65 [6]). This is because local breakout can be regarded as one
cornerstone to allow the replication of the charging principles on which CS
roaming is based on. However there are several other aspects that need to be
considered e.g. the split/bundling of user and control plane, capturing of SDP
information needed to generate charging records, to make such principles
applicable to voice over IMS roaming.
This study item will therefore investigate solutions for the provision of
voice over IMS in roaming scenarios that facilitate the realization of a
charging model that replicates the principles of CS model.
It will be studied whether changes to the core 3GPP specifications are needed
and if so which ones. The study will focus on IMS layer and not EPC aspects.
As some of the aspects of the roaming are outside the scope of 3GPP (e.g.
decision to anchor media or control plane, interaction with carrier networks,
roaming agreements) this study will be performed in close cooperation with the
GSM Association which may provide additional requirements and guidance during
its development.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.002: \"Network Architecture\".
[3] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
[4] 3GPP TS 23.079: \"Support of Optimal Routeing (SOR); Technical
Realization\".
[5] 3GPP TS 23.066: \"Support of Mobile Number Portability (MNP); Technical
realization; Stage 2\".
[6] GSMA PRD IR.65: \"IMS Roaming and Interworking Guidelines\", version 4.0,
GSM Association.
[7] IETF RFC 4904 (June 2007): \"Representing Trunk Groups in tel/sip Uniform
Resource Identifiers (URIs)\".
[8] 3GPP TS 24.229: \"IP multimedia call control protocol based on Session
Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".
[9] 3GPP TS 23.216: \"Single Radio Voice Call Continuity (SRVCC); Stage 2\".
[10] 3GPP TS 23.237: \"IP Multimedia Subsystem (IMS) Service Continuity: Stage
2\".
[11] 3GPP TS 23.292: \"IP Multimedia Subsystem (IMS) centralized services;
Stage 2\".
[12] 3GPP TR 23.885: \"Feasibility Study of Single Radio Voice Call Continuity
(SRVCC) from UTRAN/GERAN to E-UTRAN/HSPA; Stage 2\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] apply.
# 4 Requirements
Editor\'s note: Requirements in this section are subject to be updated
according to input provided by the GSMA.
## 4.1 Service control requirements
The solution shall:
\- Ensure that the service control is performed by the HPLMN (e.g. to cater
for the case where the destination address is modified). The service control
is retained by the HPLMN also in the case where the destination network is the
same as the VPLMN where the roaming user is.
\- Allow to reach a user whose number has been ported to a different PLMN
using the same resolution mechanism adopted by the VPLMN for their own users.
NOTE: The implementation of number portability, TS 23.066 [5], may be
different depending on the country.
It shall be possible, based on roaming agreements, to provide the signalling
breakout of the IMS voice call from the VPLMN.
## 4.2 VPLMN requirements
The solution will be such as to allow the VPLMN to support outgoing voice over
IMS calls from inbound roamers:
\- towards any kind of destination network, i.e. CS (e.g. GSM, UMTS, ISDN,
POTS) or PS (e.g. TISPAN, 3GPP IMS) network;
\- using any kind of interconnection it might require, i.e. legacy CS (e.g.
ISUP, SIP-I) or PS (e.g. IPX, direct connection) interconnection.
The solution will be such as to allow supporting incoming voice over IMS calls
to outbound roamers:
\- from any kind of originating network, i.e. CS (e.g. GSM, UMTS, ISDN, POTS)
or PS (e.g. TISPAN, 3GPP IMS) network;
\- using service aware interconnection.
The solution will be such to allow the VPLMN to provide the anchor
functionality close to where the call is originated from, and the VPLMN shall
be able to steer the selection of anchor function by providing the HPLMN with
a reference to the preferred anchor function. If the VPLMN does not provide
the anchor functionality address the HPLMN shall use the default address for
the VPLMN.
## 4.3 SRVCC requirements
The solution shall be compatible with the use of SRVCC as specified in TS
23.216 [9] and TS 23.237 [10], including when ATCF enhancements are used.
The application of a Single Radio VCC procedure to the roaming UE shall not
result in changes in the user charging.
## 4.4 Media plane considerations
The solution should consider the case where the HPLMN requests the user plane
to be anchored in the HPLMN.
In order not to contravene the existing interconnection model, the media plane
shall not be routed without the associated signalling through intermediate
carrier networks.
The solution should consider the cases where voice over IMS is provided with
CS media, using one of the following procedures:
\- \"Origination using I2 reference point\" (see TS 23.292 [11]);
\- \"Termination using I2 reference point\" (see TS 23.292 [11]);
\- \"Termination to non ICS UE not registered in IMS\" (see TS 23.292 [11]);
\- any procedure for \"PS - CS Access Transfer\" specified in TS 23.237 [10]
clause 6.3.2.1;
\- any procedure for \"PS - PS in conjunction with PS - CS Access Transfer\"
specified in TS 23.237 [10] clause 6.3.2.3.
### 4.4.1 Optimal Routing
The solution shall be such as to permit the application of Optimal Media
Routing as specified in TS 23.002 [2] and TS 23.228 [3]. This is in line with
GSM where the support of optimal routing (TS 23.079 [4]) is optional.
## 4.5 Charging Records considerations
For those solutions which rely on routing the session set up signalling back
to the originating VPLMN once the session has been processed by the HPLMN, the
VPLMN needs to be able to produce easily a complete Call record. Correlation
is needed between the two signalling flows, namely VPLMN to HPLMN and HPLMN to
VPLMN.
The VPLMN-provided charging record may indicate whether a signalling loopback
has been executed (indicating that such CDR was produced as a result of
returning the session set up signalling only back to the originated VPLMN) or
not.
# 4A Reference Architecture
Figure 4A-1: Reference Architecture
# 5 Solutions Alternatives for Originating Sessions
## 5.1 CS Copy Cat model based on V-CSCF
### 5.1.1 Reference Architecture
Figure 5.1-1 provides an alternative IMS Voice roaming architecture using a
V-CSCF functionality that provides the VPLMN call routing. This functionality
required to route the call back through the VPLMN, correlated the call legs,
and provide dynamic routing in the VPLMN to any breakout point (IP or PSTN
interconnects).
Figure 5.1-1: IMS Voice Roaming architecture alternative
NOTE: The V-CSCF can be functionality within existing functional entities
(e.g. P-CSCF, BGCF, or IBCF), or potentially combined with Transit
functionality.
### 5.1.2 Functional Entities
#### 5.1.2.1 V-CSCF
The V-CSCF includes functionality to:
\- Perform CDR generation.
\- Provide calling party termination routing functionality.
\- Provide breakout points to any type of interconnect network (CS/PSTN or
IMS).
\- Provide breakout for both E.164 numbers and SIP URIs.
NOTE: The V-CSCF can be considered as functionality within existing functional
entities (e.g. P-CSCF, BGCF, or IBCF) or potentially combined with Transit
functionality.
The solution will be such to allow the VPLMN to provide the V-CSCF close to
where the call is originated from, and the VPLMN shall be able to steer the
selection of V-CSCF by providing the HPLMN with a reference to the preferred
V-CSCF.
#### 5.1.2.2 IBCF
An IBCF supporting Optimal Media Routing (see TS 23.228 [3] Annex Q) is used
at each of the roaming interconnects.
### 5.1.3 Procedures and Flows
#### 5.1.3.1 Registration procedures
The procedures of TS 23.228 [3] apply.
#### 5.1.3.2 Session origination procedures with VPLMN routing
The clause describes the procedures when an originated flow is routed back
from the originating HPLMN to the originating VPLMN for onward routing
decision. For simplicity of the drawings, only one intermediate network is
shown, and only the originating side routing. The termination routing is
expected to follow the procedures of TS 23.228 [3].
NOTE: The charging aspects for the different call legs need to be addressed,
but is left for SA WG5.
Figure 5.1.3.2-1: Session Origination flow with VPLMN routing
The following steps are performed:
1\. The UE initiates a session towards the remote end, and forwards it to the
P-CSCF.
2\. The P-CSCF performs normal handling of the INVITE, with the additional
procedure of adding the address of the V-CSCF to the INVITE (this could be a
FQDN pointing to one or more physical functions). The INVITE is forwarded
toward the home network (IBCF next hop).
3\. The IBCF adds additional OMR information to allow short cut of media for
the HPLMN tromboning prior forwarding the message to the intermediate network.
4\. The intermediate network applies OMR procedures as required, prior
forwarding to the originating HPLMN.
5\. The IBCF in the HPLMN applies the OMR procedures as required, and forwards
the INVITE to the S-CSCF.
6\. The S-CSCF performs service invocation.
7\. The S-CSCF performs routing decision and based on that the UE is roaming,
and a roaming agreement for VPLNM call routing is in place and home routing is
not required, the S-CSCF decides to route back to the VPLMN for onward call
routing. It routes the session back to the VPLMN based on the V-CSCF address
received in the INVITE (added by the VPLMN in step 2). If the VPLMN does not
provide the anchor functionality address the HPLMN shall use a default derived
address for the VPLMN V-CSCF.
8\. The IBCF applies the OMR procedures as required, and forwards the INVITE
to the intermediate network.
9\. The intermediate network applies OMR procedures as required, prior
forwarding to the VPLMN.
10\. When receiving the INVITE, the IBCF will apply OMR procedures (and will
detect that a media loop is now available within the VPLMN). The IBCF forwards
the INVITE towards the V-CSCF.
11\. The V-CSCF will perform calling party number routing using the same
mechanisms as used for the S-CSCF. If required, the call may be routed through
a BGCF for further number analysis if not available in ENUM. The V-CSCF
forwards the INVITE towards the remote end (i.e., towards IBCF or MGCF). When
forwarding to an IBCF, the V-CSCF ensures by means of signalling that media is
anchored in the VPLMN.
NOTE: In case the called user is an IMS user of the VPLMN- the call will be
routed directly to the terminating side, (i.e., I-CSCF of the VPLMN) without
traversing an MGCF/IBCF.
12\. The MGCF/IBCF performs normal call routing procedures to route towards
the remote network/end.
13\. Provisional responses may be received. At this time, the OMR shortcut
within the VPLMN will be found and established.
14-15. A final response is received from the terminating side, and forwarded
towards the V-CSCF.
15\. The V-CSCF generates needed CDRs, and will route back the 200 OK towards
the HPLMN. The V-CSCF will also include an indication \"call is routed via
VPLMN\" in the 200 OK.
16-19. The 200 OK is routed back towards the S-CSCF. OMR procedures are
applied, and CDR generation performed.
20\. The S-CSCF forwards the 200 OK with the indication \"call is routed via
VPLMN\".
21-24. The 200 OK is forwarded back to the UE.
At this point, the signalling path will be established via the HPLMN, and back
to the VPLMN. The media path will remain in the VPLMN and send out directly
together with signalling towards the terminating network.
The above procedures will also work:
\- for an originating session for (v)SRVCC that use ATCF enhancements. In such
case, an ATCF is included in the signalling path at step 2.
\- for an originating sessions that uses CS media with MSC Server enhanced for
ICS. In such case, the INVITE in step 1 is replaced by a CS call setup, and
the P-CSCF is replaced by the MSC Server enhanced for ICS. The MSC Server
enhanced for ICS will need to provide the V-CSCF. As an alternative, the
V-CSCF address can be provided by an IBCF.
\- for an originating session that uses CS media with MSC Server enhanced for
ICS and ATCF, for SRVCC to E‑UTRAN/HSPA (see TR 23.885 [12]). In such case,
the INVITE in step 1 is replaced by a CS call setup, and the P‑CSCF is
replaced by the MSC Server enhanced for ICS and the ATCF. The MSC Server
enhanced for ICS or the ATCF will need to provide the V-CSCF address. As an
alternative, the V-CSCF address can be provided by an IBCF.
The same applies to the procedures described in clauses 5.1.3.3, 5.1.3.4 and
5.1.3.5.
#### 5.1.3.3 VPLMN originating call routing with CS breakout in VPLMN
The signalling flow in the figure below illustrates a scenario in which an
originated flow is routed back from the originating HPLMN to the originating
VPLMN for onward routing decision. For simplicity of the drawings, only one
intermediate network is shown. The V-CSCF is shown as separate logical entity,
but can be collocated with, e.g. CSCF, BGCF, IBCF. Originating call routing in
the V-CSCF results in a breakout to the CS domain in VPLMN-A.
Figure 5.1.3.3-1: VPLMN originating call routing with CS breakout in VPLMN
The following steps are performed:
1-10. These steps are done in accordance to clause 5.1.3.2.
11\. The V-CSCF will perform calling party number routing using the same
mechanisms as used for the S-CSCF. Address resolution determines that the call
is to be broken out to the CS domain in the local PLMN. The V-CSCF forwards
the INVITE towards an MGCF.
NOTE: The V-CSCF may instead forward the INVITE to a BGCF, which will
determine the need for CS breakout and then route towards an MGCF.
12\. The MGCF interworks SIP to CS domain signalling and performs normal call
routing procedures to route towards the remote end.
13\. Call progress and answer indications are interworked by the MGCF.
#### 5.1.3.4 VPLMN originating call routing with CS breakout in Destination
PLMN
The signalling flow in the figure below illustrates a scenario in which an
originated flow is routed back from the originating HPLMN to the originating
VPLMN for onward routing decision. For simplicity of the drawings, only one
intermediate network is shown. The V-CSCF is shown as separate logical entity,
but can be collocated with, e.g. CSCF, BGCF, IBCF. Originating call routing in
the V-CSCF results in a breakout to the CS domain in the HPLMN/VPLMN of the
called CS UE.
Figure 5.1.3.4-1: VPLMN originating call routing with CS breakout in
Destination PLMN
The following steps are performed:
1-11. These steps are done in accordance to clause 5.1.3.2.
12-13. These steps are handled as a terminating interconnection case in
accordance to existing procedures. Breakout to the PSTN occurs in the IPX
network as close to the destination as possible. The intermediate network
forwards the INVITE towards an MGCF in the Destination PLMN.
14\. The MGCF interworks SIP to CS domain signalling and performs normal call
routing procedures to route towards the remote end.
15\. Call progress and answer indications are interworked by the MGCF.
#### 5.1.3.5 Home routing procedures
##### 5.1.3.5.1 CS copy cat model for home routing
The clause describes the procedures when an originated flow is routed back
from the originating HPLMN to the originating VPLMN for onward routing
decision. In this scenario, the terminating party will be in the HPLMN (i.e.
this will be an originating request to another HPLMN subscriber).
For simplicity of the drawings, only one intermediate network is shown. The
V-CSCF is shown as separate logical entity, but can be collocated with e.g.
either CSCF, BGCF, or IBCF.
Figure 5.1.3.5-1: Session Origination flow for Copy cat model with HPLMN
routing
The following steps are performed:
1-11. These steps are done in accordance to clause 5.1.3.2.
12-14. These steps are handled as a terminating interconnection case in
accordance to existing procedures. The terminating S-CSCF receives the
incoming INVITE and processes it according to standard procedures.
15\. This step is done in accordance to clause 5.1.3.2.
16-28. During the final responses, the media path will be confirmed. Due to
the use of the OMR procedures for the initial signalling tromboning to the
home network, the media will be routed to the home network following the
terminating call leg path (step 11-14), and the charged accordingly.
##### 5.1.3.5.2 Home routing without involving V-CSCF
The clause describes the procedures of an optimized copy cat model, when the
home network decides to handle the call termination routing by itself (e.g.
when the calling party is in the same network) and not to involve the V-CSCF
in the VPLMN.
Figure 5.1.3.5-2: Session Origination flow with HPLMN routing without
involving V-CSCF
The following steps are performed:
1-6. These steps are done in accordance to clause 5.1.3.2.
7\. The S-CSCF will check if VPLMN routing should be performed. In this
example, the calling party number is within its own domain, and the policy is
such that it decides to have home routing of the call and not return the call
to the VPLMN for onward routing.
8\. Provisional responses may be provided.
9-14. The final response is provided back.
14\. When the P-CSCF receives the 200 OK, the P-CSCF, having detected that no
indication \"call is routed via VPLMN\" is present, will apply the CDR
generation to allow TAP records to be generated (as in this case, the V‑CSCF
is not in the path to be able to produce such for the settlement).
NOTE: The absence of the indication \"call is routed via VPLMN\" is not a
guarantee for the VPLMN that \"Home routing without involving V-CSCF\" is
used, because this indication is conveyed through the HPLMN and the HPLMN is
therefore able to remove it. For example, a HPLMN could fraudulently remove
this indication in order to pay to the VPLMN the price of a home-routed call
while the HPLMN has actually routed the signalling back to the VPLMN as
described in clause 5.1.3.2. In order to detect avoid this, additional means
could be required, e.g., the VPLMN correlates the CDRs generated by the P-CSCF
and by the V-CSCF, the VPLMN ensuring that when home routing is applied, the
IBCFs are anchoring traffic on the first call leg, etc.
##### 5.1.3.5.3 CS copy cat model for home routing using Home Routing AS
The clause describes the procedures when during originating service execution
in the Home network an originated flow is routed back from the originating
HPLMN to the originating VPLMN for home routing of both s. In this scenario,
the terminating party will be in the HPLMN (i.e., this will be an originating
request to another HPLMN subscriber).
For simplicity of the drawings, only one intermediate network is shown. The
V-CSCF is shown as separate logical entity, but can be collocated with, e.g.
either CSCF, BGCF, or IBCF.
Figure 5.1.3.5-3: Session Origination flow for Copy cat model with HPLMN
routing
The following steps are performed:
1-5. These steps are done in accordance to clause 5.1.3.2.
6\. As part of the service invocation and based on installed Filter Criteria
the S-CSCF send the INVITE to the Home Routing AS.
7\. The Home routing AS checks that the UE is roaming and that a roaming
agreement for VPLMN call routing is in place and decides that that the call
shall be home routed. It saves the content of the request URI in the Invite
message, replaces it with a Routing Number, adds in charging information, the
HPLMN id as the ORIG-IOI, and routes the session back to the VPLMN based on
the V-CSCF address received in the INVITE (added by the VPLMN in step 2).
8-11. This step is done in accordance to clause 5.1.3.2.
12-15. These steps are handled as a terminating interconnection case in
accordance with existing procedures.
The I-CSCF in the Home network recognizes that the Request URI contains a
routing number and follows standards procedures for a call towards a PSI, and
sends the INVITE to the Home routing AS.
NOTE: As part of step 11 and 12, the V-CSCF will instruct the IBCF to anchor
the media and \"disable\" OMR, ensuring that the media will follow the
signalling to the home network. The HPLMN will also ensure that OMR is not
applied on the roaming leg if OMR has been disabled by the VPLMN.
16 The Home Routing AS replaces the content of the Request URI and the
charging info with what was received from the S-CSCF in step 7, and follows
standard procedures to return the INVITE to the S-CSCF in accordance with
standard procedures. The Home Routing AS omits the address of the VPLMN V-CSCF
in the INVITE.
17\. The S-CSCF continues the originating service invocation.
18\. The S-CSCF checks if VPLMN routing should be performed, but as no V-CSCF
address is included in the INVITE message, it decides that routing shall be
done directly to the destination.
19 Provisional responses may be provided.
20-36. During the final responses, the media path will be confirmed. Due to
the use of the OMR procedures for the initial signalling tromboning to the
home network and the Home routing AS, the media will be routed to the home
network following the second call leg path (steps 11-18), and the charged
accordingly.
## 5.2 Transit routing via VPLMN
### 5.2.1 General
After handling an originating request and before making a final routing
decision, the S-CSCF can invoke a Transit Routing Function (TRF) based on
local policy. This local policy uses configuration data for each roaming
partner. The Transit Routing Function is defined in clause 5.19 of TS 23.228
[3], where it is also described as simply a \"transit function\". The acronym
\"TRF\" is defined here for convenience. Based on the Request URI, VPLMN
identity, and local policy, the TRF can forward the request to the IMS peering
access point of the VPLMN. The TRF in the HPLMN can use ENUM/DNS and/or BGCF
routing information to help determine whether routing of the signalling back
to the VPLMN is required by local policy for a particular Request URI. The IMS
peering access point in the VPLMN invokes the TRF in the VPLMN. The TRF in the
VPLMN applies VPLMN routing procedures to determine subsequent handling of the
call.
The S-CSCF determines the VPLMN identity from the P-Visited-Network-ID header
received during the registration procedure.
The HPLMN includes a loopback indicator when forwarding the request back to
the VPLMN so that the VPLMN can identify that the transit request originated
in the VPLMN.
The TRF in the HPLMN can be co-located with the BGCF when local policy
requires access to BGCF routing data to determine if the request is to be
routed back to the VPLMN. Otherwise the TRF in the HPLMN can be co-located
with the S-CSCF.
The TRF in the VPLMN can be co-located with the I-CSCF.
NOTE 1: It is assumed that Optimal Media Routing (OMR) is applied to the
signalling between the VPLMN and the HPLMN to avoid anchoring media in the
HPLMN. IBCFs on the signalling paths between the VPLMN and HPLMN must support
OMR.
NOTE 2: It is assumed with this and any other option requiring routing of
signalling back to the VPLMN that any required media resources are allocated
within the VPLMN to avoid tromboning media through the HPLMN.
NOTE 3: Charging aspects remain to be addressed by SA WG5.
### 5.2.2 Architecture impacts
This alternative has no architecture impacts. TRF, S-CSCF, I-CSCF, BGCF and/or
IBCF procedures are augmented to support related use cases.
### 5.2.3 Example use cases
#### 5.2.3.1 Transit routing via VPLMN after successful ENUM/DNS resolution
Figure 5.2.3.1-1 shows an example use case of the transit routing of an
originating request via VPLMN after successful ENUM/DNS resolution. In this
use case, the HPLMN forwards the request to the VPLMN upon identifying the use
case and subsequent routing is performed within the VPLMN. Other scenarios are
possible where the HPLMN selects to not forward the request to the VPLMN,
where the VPLMN chooses to forward the request to its own I-CSCF for routing
to a VPLMN subscriber, or where the VPLMN fails to resolve the Request URI
using ENUM/DNS and applies CS breakout procedures. These other use cases are
not shown.
NOTE 1: The TRFs in the figure are shown as standalone entities for clarity
but are expected to be co-located with existing functional entities.
NOTE 2: Intermediate networks can be inserted in the paths between the PLMNs
but are not shown in the figure and do not change the flow.
Figure 5.2.3.1-1: Transit routing via VPLMN after successful ENUM/DNS
resolution - example use case
#### 5.2.3.2 Transit routing via VPLMN for CS breakout
Figure 5.2.3.2-1 shows an example use case of the transit routing of an
originating request via VPLMN for CS breakout. In this use case, the HPLMN
forwards the request to the VPLMN upon identifying the CS breakout case and
the CS breakout is performed within the VPLMN. Other scenarios are possible
where the HPLMN selects to not forward the request to the VPLMN, where the
VPLMN chooses to forward the request to another network for CS breakout, or
where the VPLMN successfully applies local ENUM/DNS procedures to route the
request. These other use cases are not shown.
NOTE 1: The TRFs in the figure are shown as standalone entities for clarity
but are expected to be co-located with existing functional entities.
NOTE 2: Intermediate networks can be inserted in the paths between the VPLMN
and HPLMN but are not shown in the figure and do not change the flow.
Figure 5.2.3.2-1: Transit routing via VPLMN for CS breakout - example use case
### 5.2.4 Session origination procedures
#### 5.2.4.1 Session origination procedure for transit routing via VPLMN
This clause describes the session origination procedure for transit routing
via the VPLMN. The HPLMN determines when to invoke this procedure. The
procedure describes the case where the destination network is reached via IMS
routing from the VPLMN, but is also applicable to all types and locations of
destination networks, e.g. CS breakout and VPLMN as destination network.
Figure 5.2.4-1: Session origination procedure for transit routing via VPLMN
1-2. Following normal procedures, the roaming UE sends an INVITE request to
the P-CSCF, which is then forwarded to the first IBCF in the VPLMN before
exiting the network. The P-CSCF forwards the request to an IBCF that allows
TrGW bypass using OMR. The INVITE request (or a subsequent message) can
include UE location information.
3\. This first IBCF in the VPLMN allocates a TrGW for the media and follows
standard OMR procedures when forwarding the INVITE request to allow this TrGW
to be bypassed if the INVITE request later returns to the VPLMN and no other
intermediate nodes anchor the media before the request returns.
4-5. The intermediate network and the first IBCF in the HPLMN forward the
INVITE request to the S-CSCF. Nodes in the intermediate network and the first
IBCF in the HPLMN support OMR and allow their TrGWs to be bypassed.
6\. The S-CSCF invokes application servers as necessary to perform service
control and then invokes a TRF that performs a modified routing procedure. The
TRF decides to route the INVITE request back to the VPLMN based on a
combination of local policy, the identity of the visited network, whether any
needed MRF resources are available in the VPLMN, whether needed MRF resources
are to be allocated only within the VPLMN, and whether routing information
associated with the Request URI is received either from ENUM or the BGCF.
NOTE: If this TRF is not co-located with the S-CSCF then the request forwarded
from the S-CSCF to the TRF includes the visited network identity.
7\. The TRF derives the I-CSCF address in the VPLMN from the visited network
identity, and forwards the request towards the I-CSCF in the VPLMN. The TRF
includes in the INVITE request a loopback indicator to inform the VPLMN that
this request is being routed back to the VPLMN for transit routing. The TRF
retains the UE location information in the INVITE request if it is available.
The TRF forwards the request to an IBCF that allows TrGW bypass using OMR.
8-9. The second IBCF in the HPLMN and the intermediate network forward the
INVITE request towards the I-CSCF in the VPLMN. Nodes in the intermediate
network support OMR and allow their TrGWs (if any) to be bypassed.
10\. The second IBCF in the VPLMN receives the INVITE request, notes that the
SDP includes an alternative media address within the VPLMN that allows bypass
of allocated TrGWs, applies OMR to signal removal of any TrGWs allocated
between the VPLMN and HPLMN, and forwards the request to the I-CSCF.
11\. Based on local policy and the presence of the loopback indicator in the
request, the I-CSCF invokes the TRF to route the INVITE request toward the
destination network according to the Request URI based on ENUM or BGCF
information. The called party information is included in the Request URI.
12\. In this flow, ENUM returns the domain of an external network and the
request is routed towards the destination network via the third IBCF in the
VPLMN. The TRF forwards the request to an IBCF that anchors media. If UE
location information is available in the INVITE request, the TRF can select an
IBCF close to the point of call origination.
13\. The third IBCF in the VPLMN allocates a TrGW for the media when
forwarding the INVITE request towards the destination network. Intermediate
nodes on the path to the destination network are not shown. The destination
network also anchors media before forwarding outside of its network to prevent
any further application of OMR on the path from the VPLMN.
14\. During subsequent session establishment signalling, OMR information
passed back through the IBCFs and intermediate networks between the VPLMN and
HPLMN cause them to release any allocated TrGWs. The end-to-end media flow is
established from the UE through the third IBCF/TrGW in the VPLMN toward the
destination network. If necessary for charging purposes, the P-CSCF can derive
the called party information from the history-info header received in a
response to the INVITE request.
The above procedure will also work:
\- for an originating session for (v)SRVCC that use ATCF enhancements; in such
case, an ATCF is included in the signalling path at step 2;
\- for an originating sessions that uses CS media with MSC Server enhanced for
ICS; in such case, the INVITE in step 1 is replaced by a CS call setup, and
the P-CSCF is replaced by the MSC Server enhanced for ICS;
\- for an originating session that uses CS media with MSC Server enhanced for
ICS and ATCF, for SRVCC to E‑UTRAN/HSPA (see TR 23.885 [12]). In such case,
the INVITE in step 1 is replaced by a CS call setup, and the P‑CSCF is
replaced by the MSC Server enhanced for ICS and the ATCF.
#### 5.2.4.2 Session origination procedure for home routing
This clause describes the session origination procedure for home routing. The
HPLMN determines when to invoke this procedure. The procedure describes the
standard IMS routing case where the destination network is reached via IMS
routing from the HPLMN, but is also applicable to all types and locations of
destination networks, e.g., CS breakout and HPLMN as destination network.
Figure 5.2.4.2-1: Session origination procedure for home routing
1-2. Following normal procedures, the roaming UE sends an INVITE request to
the P-CSCF, which is then forwarded to the IBCF in the VPLMN before exiting
the network. The P-CSCF forwards the request to an IBCF.
3\. The IBCF in the VPLMN allocates a TrGW for the media and follows OMR
procedures or not when forwarding the INVITE request.
4-5. The intermediate network and the first IBCF in the HPLMN forward the
INVITE request to the S-CSCF. Nodes in the intermediate network and the IBCF
in the HPLMN may support OMR and may allow their TrGWs to be bypassed.
6\. The S-CSCF invokes application servers as necessary to perform service
control and then invokes a TRF. The TRF decides to perform standard IMS
routing procedures after deciding not to route the INVITE request back to the
VPLMN.
7\. The TRF performs standard IMS routing procedures to forward the request
towards the destination network.
8\. During subsequent session establishment signalling, all allocated TrGWs on
the media path are retained. The end-to-end media flow is established from the
UE through the IBCF/TrGWs toward the destination network, and may include
additional media resources not shown. If necessary for charging purposes, the
P-CSCF can derive the called party information from the history-info header
received in a response to the INVITE request.
## 5.3 Transit function in the visited network
### 5.3.1 General
Procedures described in this clause use only existing mechanisms, the transit
function, to route the SIP session requests back to the visited network. These
solutions do not require architecture change, new functionality or new
reference point is not introduced.
If it is required to differentiate scenario when the transit function is used
for route-back from other transit function scenarios the originating visited
network may assign an additional URL for the (network entity hosting the)
transit function, so the call case can be identified.
### 5.3.2 Alternative A - configuration based route-back
#### 5.3.2.1 Description
The procedure described in this clause assumes that originating home network
support additional routing capabilities (i.e. transit functions) and based on
roaming agreements with originating visited network the originating home
network routes originating requests to a transit function of the originating
visited network.
Figure 5.3.2.1-1: Configuration based route-back
1) P-CSCF receives an originating request from the roaming UE.
2) P-CSCF forwards the request to S-CSCF applying standard routing procedures.
3) After triggering originating services for the served user (not shown in the
figure), the S-CSCF detects that the request is received from a user roaming
in visited A network, and according to internal logic and interconnect
agreements (see clause 5.3.2.2) the S-CSCF applies additional routing
capabilities to forward the request to a transit function in the originating
visited network or perform normal home routing.
NOTE 1: Alternatively, the last originating service can be a \"route-back
service\" that will act as UAS towards the S-CSCF, and simply forwards the
request back to the originating visited network.
4) Transit function in the originating visited network forward the request
towards the terminating home network (either directly, or using transit
functions of other networks).
NOTE 2: The rest of the request routing and responses are not shown.
The above procedure will also work:
\- for an originating session for (v)SRVCC that use ATCF enhancements; in such
case, an ATCF is included in the signalling path between P-CSCF and IBCF;
\- for an originating sessions that uses CS media with MSC Server enhanced for
ICS; in such case, the P-CSCF is replaced by the MSC Server enhanced for ICS;
\- for an originating session that uses CS media with MSC Server enhanced for
ICS and ATCF, for SRVCC to E‑UTRAN/HSPA (see TR 23.885 [12]). In such case,
the P-CSCF is replaced by the MSC Server enhanced for ICS and the ATCF.
#### 5.3.2.2 Routing back to visited network
There are multiple choices how to route back to the visited network, this
clause just provides some ideas for better understanding:
Each visited operator may provide a re-routing address (e.g. trf.csp.com) as
part of a Service Level Agreement (SLA). The re-routing addresses may be
either stored in local configuration data in HPLMN or in a DNS data base
(either configured by the VPLMN or the HPLMN). Once the home network receives
a request it uses that address for routing back (i.e. S-CSCF adds the address
to the top-most route header).
The home network may use the PANI header or uses the P-Visited-Network id
information from IMS registration to select the proper re-routing address
(either via a DNS query or taken from local configuration data).
In general this works quite similar as the local number call re-routing where
the home network needs to route the call back to the visited network where the
local service is provided.
#### 5.3.2.3 Evaluation
**Pro**
\- Simple, no additional requirement for existing functions.
\- if ongoing transit charging work in CT WG1 / SA WG5 fulfils all RAVEL
requirements, then there is no need to standardize anything.
\- With recent IPXS changes (service triggering in transit network) transit
function will not limit the functionalities the originating visited network
may need to perform.
**Con**
\- None.
### 5.3.3 Alternative B - Route-back triggered by the visited network
#### 5.3.3.1 Description
The procedure described in this clause assumes that originating visited
network changes the originating request to trigger routing the originating
request back to the visited network. Assuming that no service in the
originating home network performs 3pcc and changes the originating request
completely, as a consequence of change in the originating visited network
normal SIP routing procedures will cause the request to return to the
originating visited network.
Figure 5.3.3.1-1: Route-back triggered by visited network
1) P-CSCF receives an originating request from the roaming UE.
2) According to local policy the P-CSCF forwards the request towards the
originating home network via an IBCF.
NOTE 1: It can be assumed that IBCF is used during registration as well, so
P-CSCF only applies standard routing procedures.
3) Based on local policy the IBCF adds its own address as the last entry to
the route of the request. It also includes a token to the route entry to
enable the correlation of the current request and the request returning from
the originating home network.
NOTE 2: Alternatively, the IBCF adds SIP Trunk Group Parameters (see RFC 4904
[7] and clause 5.3.3.2) to indicate desired \"re-entry\" function.
4) After executing the services (not shown in the figure) the IBCF URI with
the token is left in the route, so the S-CSCF will route the request according
to that (see step 11 in 5.4.3.2 of TS 24.229 [8]) back to the originating
visited network or decides to perform normal home routing.
NOTE 3: Whether or not the routing procedures above are in line with existing
procedures described in TS 24.229 [8] is under the responsibility of Stage 3.
NOTE 4: The usage of trunk group parameter would guarantee that request
termination procedure in S-CSCF routes the request back to the originating
visited network.
5) Transit function in the visited network forward the request towards the
terminating home network (either directly, or using transit functions of other
networks).
NOTE 5: The rest of the request routing and responses are not shown.
The above procedure will also work:
\- for an originating session for (v)SRVCC that use ATCF enhancements; in such
case, an ATCF is included in the signalling path between P-CSCF and IBCF;
\- for an originating sessions that uses CS media with MSC Server enhanced for
ICS; in such case, the P-CSCF is replaced by the MSC Server enhanced for ICS;
\- for an originating session that uses CS media with MSC Server enhanced for
ICS and ATCF, for SRVCC to E‑UTRAN/HSPA (see TR 23.885 [12]). In such case,
the P-CSCF is replaced by the MSC Server enhanced for ICS and the ATCF.
\- The solution allows the VPLMN to provide the anchor functionality close to
where the call is originated from, and the VPLMN is able to steer the
selection of anchor function by providing the HPLMN with a reference to the
preferred anchor function. If the VPLMN does not provide the anchor
functionality address the HPLMN uses the default address for the VPLMN.
#### 5.3.3.2 Routing back by using SIP Trunk Group Parameters
One option of dynamic re-routing back to the visited network is the use of SIP
trunk group parameters as described by RFC 4904 [7].
Hereby adds the visited network (P-CSCF or IBCF) Trunk Group Parameters to the
R-URI which indicates the desired \"re-entry\" function.
For example as follows:
INVITE sip:B-Party;tgrp=CGR2;trunk-context=Realm6\@operator.net SIP/2.0
Table 5.3.3.2-1
* * *
Home network Trunk group Trunk-Context Home1.net CGR1 Realm5 Home2.net CGR2
Realm6
* * *
##### 5.3.3.2.1 Session origination procedure for routing via VPLMN
This clause describes the session origination procedure for routing via the
VPLMN. The VPLMN adds trunk parameters which support routing back to VPLMN.
But still it is up to the HPLMN to determine whether the call is routed back
to VPLMN or normal home routing is performed.
Figure 5.3.3.2.1-1: Session origination procedure for routing via VPLMN
1\. The roaming UE sends an INVITE request to the P-CSCF.
2\. P-CSCF forwards the INVITE to the visited IBCF.
3\. The Visited IBCF checks the route header and finds HPLMN domain name
within the last entry. The visited IBCF adds preconfigured trunk parameters
indicating its own realm and context to the R-URI. The visited IBCF applies
OMR procedures to indicate that it can remove TrGWs. It may allocate a TrGW
and insert its address into the SDP.
4\. Visited IBCF sends INVITE to IBCF in HPLMN, potentially via intermediate
networks. The IBCF in HPLMN applies OMR procedures to indicate that it can
remove its TrGWs. It may allocate a TrGW and insert its address into SDP.
5\. The IBCF in HPLMN forwards the INVITE via I-CSCF to S-CSCF in HPLMN.
6\. The S-CSCF performs normal service control and invokes application servers
as necessary. The S-CSCF learns from the presence of the trunk parameters in
the INVITE that a routeing back to the visited network is possible. Based on
local policy the S-CSCF decides to route the call back via the VPLMN and
starts a routine to handle the received trunk info. It inserts two additional
Route headers for the home IBCF and the visited IBCF into the message based on
the provided trunk groups from the visited IBCF. Otherwise, if local policy
indicates that normal home routing is applied the S-CSCF removes the trunk
info and routes the call towards the terminating network as described in
section 5.3.3.2.2.
7\. The S-CSCF sends the INVITE to the topmost route header target, i.e. to
the home IBCF. Using OMR procedures, the home IBCF determines that its TrGW is
not required, and de-allocates a possibly previously allocated TrGW.
8\. The home IBCF checks the topmost Route header which is the visited IBCF
inserted by the S-CSCF before and identifies the visited PLMN as target peer
network. The home IBCF routes the INVITE to the visited IBCF, potentially via
intermediate networks.
9\. The visited IBCF finds a trunk parameters present which means that
routeing via VPLMN is selected. Using OMR procedures, the visited IBCF
determines that its TrGW is not required, and de-allocates a possibly
previously allocated TrGW. The visited IBCF forwards INVITE towards a TRF
(unless TRF functionality is included in the IBCF).
10\. Based on the request URI, the TRF routes the request towards the
terminating network (via visited IBCF).
11\. Completion of session establishment.
##### 5.3.3.2.2 Session origination procedure for home routing
This clause describes the session origination procedure for home routing. The
HPLMN determines when to invoke this procedure. The VPLMN just adds trunk
parameters for potential routing back but does not make a decision whether the
call is routed via VPLMN or if normal home routing is applied.
Figure 5.3.3.2.2-1: Session origination procedure for home routing
1.-6. Same as for routing via VPLMN as described in section 5.3.3.2.1.
7\. The S-CSCF sends the INVITE towards the terminating network.
8\. Completion of session establishment.
#### 5.3.3.3 Evaluation
**Pro**
\- Visited A network is in control.
\- Originating visited network can correlate the \"start\" leg with the
loopback leg.
\- Loopback is possible even if a routing B2BUA AS splits the dialog and the
P-CSCF used for call setup is not visible in signalling.
**Con**
\- change in routing procedures if done in P-CSCF (doing it in visited IBCF
instead of P-CSCF could be better, manipulating Route in IBCF can be
considered as an NNI policy).
\- Visited A network is in control: does not allow originating home network to
apply IMS home routing.
## 5.4 IMS home routing
### 5.4.1 General
There are two primary use cases for home routing of originating requests in
the CS domain:
1\. Forced routing to HPLMN application via CAMEL origination trigger.
2\. Originating request to another HPLMN subscriber.
Other use cases are possible based on HPLMN policy, such as digit translation
via CAMEL, but these appear to be covered by other scenarios described in this
technical report.
In this alternative, IMS routing remains unchanged for these use cases.
The only information required for the forced routing use case 1 is that the
call is routed to the HPLMN for handling. No further information is available
in the CS case compared to standard IMS home routing.
Use case 2 could be treated as a case of transit routing via VPLMN back to the
HPLMN but this is unnecessarily wasteful. The information required in the
VPLMN for proper charging reconciliation is the Request URI translated by the
HPLMN, as made available in the history-info header. It is unnecessary for the
VPLMN to make a second routing decision regarding how to reach the HPLMN since
it already did that the first time it routed the originating request to the
HPLMN.
### 5.4.2 Architecture impacts
This alternative has no architecture impacts. IMS routing procedures remain
unchanged. The history-info header provides to the VPLMN the Request URI
translated by the HPLMN as required for charging in some use cases.
### 5.4.3 Example home routing use cases
#### 5.4.3.1 Forced routing to HPLMN
Figure 5.4.3.1-1 shows an example home routing use case where the HPLMN forces
routing from the VPLMN to the HPLMN for service delivery and subsequent
routing. No new information is needed in the VPLMN that is not already
available in standard IMS signalling during standard IMS routing.
NOTE: Intermediate networks can be inserted in the paths between the PLMNs but
are not shown in the figure and do not change the flow.
Figure 5.4.3.1-1: Forced home routing - example use case
#### 5.4.3.2 Routing to another HPLMN subscriber
Figure 5.4.3.2-1 shows an example home routing use case where the originating
request is destined for another HPLMN subscriber. The VPLMN derives the
Request URI translated by the HPLMN via the SIP history-info header for
charging purposes.
NOTE: Intermediate networks can be inserted in the paths between the PLMNs but
are not shown in the figure and do not change the flow.
Figure 5.4.3.2-1: Home routing to another HPLMN subscriber - example use case
# 5A Solutions Alternatives for Terminating Sessions
## 5A.1 Use of IBCF and removal of OMR attributes
In order to ensure that, for terminating sessions to roaming users, the media
plane is not routed to the VPLMN serving the terminating user without
associated signalling (e.g. directly from the originating VPLMN to the
terminating VPLMN), the terminating HPLMN uses IBCFs and TrGWs at the boundary
of its network to anchor the media plane. When S-CSCF of the terminating user
routes a terminating session request to another network, it ensures by means
of signalling that OMR procedures are not used towards the next network and
forwards the request to an IBCF, that then anchors the media plane in a TrGW.
NOTE: This prevents OMR (Optimal Media Routing) to be applied on the
terminating side of the session, but does not prevent OMR to be applied on the
originating side.
# 6 Alternatives Assessment and Conclusions
## 6.1 Assessment
### 6.1.1 General
### 6.1.2 Specific Criteria
Table 6.1.2-1
+-------------+-------------+-------------+-------------+-------------+ | | Solution | Solution | Solution | Solution | | | 5.1 | 5.2 | 5.3A | 5.3B | +-------------+-------------+-------------+-------------+-------------+ | Name | V-CSCF | TRF | Transit | Transit | | | | (Transit | Function | Function | | | | and Routing | | | | | | Function). | | | +-------------+-------------+-------------+-------------+-------------+ | Placement | Proposed to | TRF as an | Extends | Extends | | of | be part of | extension | existing | existing | | fu | existing | of current | Transit | Transit | | nctionality | function | transit | Function in | Function in | | | (e.g., CSCF | function in | VPLMN. | VPLMN. | | | or BGCF) or | VPLMN. | | | | | to be | Recommended | Placement | Placement | | | combined | to be | of Transit | of Transit | | | with the | located | function in | function in | | | Transit | with | VPLMN is | VPLMN is | | | fun | I-CSCF. | left open. | left open. | | | ctionality. | | | | | | | TRF in | | | | | Placement | HPLMN | | | | | not | invoked for | | | | | concluded. | routing | | | | | | after | | | | | | S-CSCF | | | | | | (/BGCF). | | | | | | | | | | | | Placement | | | | | | of TRF in | | | | | | HPLMN | | | | | | recommended | | | | | | to be with | | | | | | S-CSCF or | | | | | | BGCF. | | | +-------------+-------------+-------------+-------------+-------------+ | Diff | Explicit | Explicit | No specific | No specific | | erentiation | procedures | indicator | procedures | procedures | | of traffic | to separate | from HPLMN | defined in | defined in | | cases | the roaming | to VPLMN | basic | basic | | | loopback | (TRF) to | procedures. | procedures. | | | from other | separate | | | | | traffic | the roaming | Dedicated | Dedicated | | | cases. | loopback | URI | URI | | | | from other | proposed as | proposed as | | | | traffic | an option | an option | | | | cases. | to provide | to provide | | | | | explicit | explicit | | | | | diffe | diffe | | | | | rentiation. | rentiation. | +-------------+-------------+-------------+-------------+-------------+ | Home | S-CSCF | TRF & | S-CSCF | S-CSCF | | network | | S-CSCF / | | | | impact | | BGCF | | | +-------------+-------------+-------------+-------------+-------------+ | VPLMN | VPLMN | Anchor | Anchor | VPLMN | | routing | provide | address | address | provide | | based on | address to | derived or | derived or | address to | | co | anchor | configured | configured | anchor | | nfiguration | | | | | | or explicit | | | | | | indication | | | | | +-------------+-------------+-------------+-------------+-------------+
### 6.1.3 Home Routing
Table 6.1.3-1
+-------------------+-------------------+-------------------+-----+ | | Solution 5.4.2 & | Solution | ... | | | Solution | 5.1.3.5.1 (CS | | | | 5.1.3.5.2 (Direct | Copy cat) | | | | home routing) | | | +-------------------+-------------------+-------------------+-----+ | Charging | Charging will be | Same type of | | | considerations | treated | charging | | | | differently | principles can | | | | between VPLMN | apply both for | | | | routing and Home | VPLMN routing and | | | | routing. | home routing. | | | | | | | | | Signaling and | Media is only | | | | media will be | charged together | | | | traversing on the | with the second | | | | first call leg | call leg from | | | | between VPLMN and | VPLMN to the | | | | HPLMN. This is | HPLMN. | | | | different from | | | | | the VPLMN routing | | | | | where only | | | | | signaling will be | | | | | sent on the first | | | | | call leg. | | | +-------------------+-------------------+-------------------+-----+ | Signaling delay | - | Introduces a | | | | | signaling delay | | | | | in call setup | | | | | compared to | | | | | Solution 5.4.2 & | | | | | S | | | | | olution 5.1.3.5.2 | | | | | due to tromboning | | | | | to VPLMN. | | +-------------------+-------------------+-------------------+-----+ | Other Impacts | - | As a result of | | | | | the additional | | | | | signaling, the | | | | | procedure can | | | | | increase the risk | | | | | of call failure. | | +-------------------+-------------------+-------------------+-----+
## 6.2 Conclusions
The following high-level principles are proposed to be followed:
\- The P/S-CSCF/Anchor and other nodes performing routing procedures in
different networks can control the application of OMR procedures by indicating
in the signalling whether an IBCF/TrGW should apply OMR or not.
\- In order to allow scenarios where the media is not routed through the
originating HPLMN, IBCFs handling incoming requests to the network should
support OMR and allow bypass of TrGWs. Anchoring of media can be controlled
via outgoing IBCFs.
\- The HPLMN decides whether to perform the loopback procedure based on local
policy and on knowledge of the support of the procedure in the VPLMN.
\- When home routing is used, the VPLMN will be provided with enough
information to determine that home routing has been applied (or not been
applied). Example of such stage 3 solutions could be to derive the called
party information from the history-info header, if available, or by use of
explicit indication (or lack of it).
\- If local policy requires access to BGCF routing data to make the loopback
decision for a particular INVITE request, then the loopback decision should be
performed in the BGCF. Else it should be performed in the S‑CSCF.
\- The VPLMN Signalling Anchor performs onward routing towards the terminating
network by selecting appropriate breakout point (CS/PSTN or IMS).
\- The VPLMN Signalling Anchor can use originating UE location information to
select a nearby breakout point for media anchoring.
\- The VPLMN can provide the HPLMN with a reference to the preferred
signalling anchor function to steer the selection of the anchor function. If
the VPLMN does not provide the Signalling Anchor functionality address then
the HPLMN uses the default derived address for the VPLMN.
\- The Signalling Anchor function is proposed to be specified as an addition
to the Transit function. The name of the Transit function may need to be
extended to reflect that it also includes roaming Signalling Anchor as part of
it, but is left for the normative phase to find appropriate terminology.
\- When the HPLMN operator wishes to route the call rather than delegating to
the VPLMN, the principles of forced home routing by the HPLMN will be applied.
The signalling and media will be traversing on the first call leg between the
VPLMN and the HPLMN.
###### ### Annex A: CS voice Charging and interconnection principle - high
level description
# A.1 General Business Logic
Figure A.1-1 depicts a generalized CS voice roaming scenario where the calling
party (UE_A) is roaming in a visited network (VPLMN_A) and where also the
destination (UE_B) is roaming. It should be noted however that the same
charging and interconnection principles remain valid also when the destination
is not roaming or is a fixed network (PSTN). Considering that for voice over
IMS the application server executing the service is in the home network, the
closest CS call case is that where a camel interaction between the Visited
network where the calling party is and the home network of the calling party
exists.
Figure A.1-1: Generic routing of media plane and control plane for a CS voice
call
From charging and interconnection principles point of view the scenario
depicted in Figure A.1-1 contains of 4 fully independent business
transactions:
a) Roaming relation between Home A and Visited A (regulated by the respective
roaming contract).
b) Interconnect relation between Visited A and Home B (regulated by
interconnect agreements, typically cascaded through one or more carriers).
c) Interconnect relation between Home B and Visited B (regulated by
interconnect agreements, typically cascaded through one or more carriers).
d) Roaming relation between Home B and Visited B (regulated by the respective
roaming contract).
NOTE: Home B and Visited B also have a roaming relation (Roaming Contract).
However, in this scenario the roaming relation is irrelevant and remains in
the background in regard to the applied business transactions.
It is important to respect the commercial independence of all business
entities involved in the above scenario. In CS those 3 transactions are
independent also from a technical point of view. From a commercial point of
view it is virtually impossible to agree obligations in one contractual
relation that are predetermined by technical decisions linked to another
contractual relationship.
The billing of User A is subject to operator policies and therefore it is not
further discussed in this paper.
# A.2 Payment flows
Figure A.2-1 shows relevant money flows relevant for interconnection call
originated by a user (UE A), whilst roaming in a visited network (VPLM A)
calling a subscriber (UA B) of HPLM B who is roaming in VPLMN B. The Figure
A.2-1 illustrates the four business relations described in the previous
section.
Figure A.2-1: Cascade billing for interconnect and roaming charging for a CS
voice call with both calling party and called party roaming outside their home
PLMN
The three important aspects to keep in mind are:
1\. The charging levied by VPLMN A is towards the HPLMN of UE_A is a function
of the destination number dialled by UE_A. However, if the HPLMN of UE_A, via
CAMEL interaction, modifies to the destination number, the inter-operator
charging is based on the actual destination conveyed by the \"CAMEL
Destination number\".
2\. The parties involved in carrying the call, be them IPX carrier, mobile
operator or transit network apply the so called \"cascade billing\" so that
each node charges the node from where it receives the traffic and is charged
by the node to which the traffic is sent (\"termination fee\" principle). This
\"termination fee\" principle is based on actual termination of the media, not
based in signalling traffic. There are two distinct sets of termination fees,
one set covers the transport of media from VPLMN A to HPLM B, the other for
the transport of media from HPLMN B to VPLMN B.
3\. Charging must be deterministic.
## A.2.1 Deterministic charging
From aspect 1. in clause A.2, it can be deduced that the VPLMN_A, for the
purpose of charging, does not need to be aware of any further redirection of
the call performed by the destination network. Anyway it is not granted
whether VPLMN_A will be informed about redirections invoked due to call
forwarding or any other service in the course of the further call set-up. In
this context it is important to ensure that charging remains deterministic
(aspect 3.). VPLMN_A (and UE_A) should only be charged according to the
Interconnect relation between VPLMN_A and HPLMN_B. If the HPLMN_B decides to
redirect the call (e.g. due to roaming, call redirection, answer phone), this
should be the sole responsibility of HPLMN_B.
## A.2.2 IPX Voice Hubbing
Mobile operators generally only have direct connection to a handful of
destination networks, so they rely on the carrier services. For the purpose of
packet voice interconnect the GSMA has specified the IPX and IPX Voice
Hubbing. IPX Voice Hubbing will be provided by carriers and is necessary to
support interconnection with the several hundreds of possible destinations.
The IPX cloud is created by a number of international IPX networks. The IPX
specification has defined 3 levels of involvement of the IPX provider in the
connection of a voice call:
\- Pure Transport (simple IP connectivity, non-service aware).
\- Service Hub (here IPX Voice Hubbing).
\- Service Transit (special case for direct Interconnection with service
awareness, which is less relevant in this context).
In both the Service Transit and Service Hub cases the IPX provider is aware of
the type of service being handled, thus enabling the application of cascading
responsibilities (e.g. for billing, SLAs, fault clearing, etc.). When both
signalling and media planes transverse the same IPX network, such network is
commonly referred to as IPX Proxy.
# A.3 Accounting principles
## A.3.1 GSMA roaming business model
The GSMA roaming business model for CS calls between home and visited PLMN,
relies on the sum of two separate type of transactions: interconnection
accounting and roaming accounting.
The interconnection accounting is applied between direct interconnection
partners. When multiple interconnection partners are involved in the
communication between the originating network and the destination, then
chained accounting applies, however each element of the chain only calculates
the accounting fees levied to the subsequent node of the chain and incurred
from the previous node.
Interconnection accounting is based on sum counters which record the following
information:
\- interconnection partner (as derived from the physical address of the
connection);
\- direction of the traffic;
\- tariff time;
\- service;
\- whether signalling or media is carried;
\- destination (normally grouped in logical sets of zones).
Unlike interconnection accounting, the roaming accounting is a fee levied by
the VPLMN to the HPLMN for serving a roaming user. The roaming accounting is
based on Transfer Account Procedure (TAP) records defined by the GSM
Association and are specific to the identity of the roaming user. Mobile
originated calls TAP records requires the charging destination, the address
which is used to route the call to the remote network (which may or may not be
the dialled number).
## A.3.2 Application of GSMA roaming business model to IMS: no home routing
The call flow in Figure A.3.2-1 summarizes how the current GSMA roaming
business model applies to IMS under the assumption that a signalling loopback
without media (from VPLMN A to HPLMN A then back to VPLMN A) is executed (see
alternatives in clause 6).
Figure A.3.2-1: Interconnection and Roaming Accounting for IMS call
1\. The UE generates a mobile originated call with a dialled string which
forms the Request URI and sends it to the P-CSCF in the visited network (Local
breakout).
2\. The P-CSCF creates a CDR where the served party is UE A and destination
address is HPLMN A (last address from ROUTE header.
3\. The IBCF uses the IPX provider 1 to reach HPLMN A. It updates the sum
counter with the parameters: accounting peer = IPX1; direction = OUT; media=
Null; destination = HPLMN A. It also includes in the counter the tariff time
and service as appropriate. Upon receiving the MOC signalling, IPX1 updates
its sum counter for interconnection with values accounting peer = VPLMN A;
direction = IN; media= Null; destination = HPLMN A.
4\. IPX1 forwards the signalling to the IBCF in HPLMN A updating the sum
counter for outbound traffic towards HPLMN A. On turn HPLMN A updates the sum
counter for inbound traffic from IPX1. The Application Server in HPLMN A
executes the service logic (e.g. modifies the destination address) and returns
the modified signalling to the VPLMN A.
NOTE 1: For the sake of simplicity only one IPX provider is assumed between
VPLMN A and HPLMN A. In the more general case the interconnection may require
several hops.
5\. The HPLMN A routes the signalling back to the VPLMN A via IPX1. Both HPLMN
A and IPX 1 update their respective sum counters appropriately.
NOTE 2: For the sake of simplicity the same IPX provider is used in the
forward and reverse direction between PLMNs, however in the more general case
different IPX providers may be used. See also note 1.
6\. IPX 1 forwards the traffic to VPLMN A and both these entities update their
sum counters as appropriate. The IPX1 sum counter will for example be updated
as follows: accounting peer = VPLMN A; direction = OUT; media = null;
destination HPLMN A (last address from ROUTE header). On turn the VPLMN A will
update the sum counter with the following values: accounting peer = IPX 1;
direction = IN; media = Null; destination HPLMN A.
7\. In VPLMN A the signalling is routed to the anchor point . This entity now
has all the information needed to route the call to the destination and
creates a CDR where served party = P-Asserted Identity of A; media = yes;
destination = request URI.
Editor\'s note: Depending on the physical location of the anchor point, the
media may not be anchored at step 7. If this has an impact on information
needed in CDRs to levy roaming charges is FFS.
8\. The signalling is routed to the destination network, the first step being
the IBCF of VPLMN A (see note 2).
9\. The IBCF sends the signalling to the destination network (assumed here to
be HPLMN B) via a different IPX (IPX2). Both VPLMN A and IPX2 update their sum
counters. The sum counter in VPLMN A will now read: Accounting peer = IPX2;
direction = OUT; Media = yes; Destination = HPLMN B (as per the Request URI).
IPX2 sum counter is updated as follows: accounting peer = VPLMN A; direction =
IN; media = yes; Destination = HPLMN B (as per the Request URI).
10\. IPX2 now relays the signalling and media to HPLMN B. Both these entities
update their sum counters for interconnection accordingly.
11\. In the most generic case it can be assumed that the destination is also
roaming in VPLMN B. Therefore, once the HPLMN B has calculated the routing of
the call and determined that the signalling and media need to be routed to
VPLMN B, it contacts IPX3 (see NOTE 2). Both HPLMN B and IPX3 update their sum
counters. HPLMN B counter will read: accounting peer = IPX3; direction OUT;
media = yes; destination = last address from ROUTE, that is VPLMN B. IPX3 sum
counter on turn will be updated so that: accounting peer = HPLMN B; direction
IN; media = yes; destination = last address from ROUTE (VPLMN B).
12\. IPX3 routes media and signalling to the IBCF of VPLMN B set up to receive
incoming traffic. The sum counters of IPX3 and VPLMN B are updated.
13\. In VPLMN B the IBCF passes the signalling P-CSCF (the media has reached
the IBGW and will be delivered to the UE) which generates a CDR for the mobile
terminated call containing the served UE identity.
14\. P-CSCF completes the signalling path to UE B.
As described above interconnection charges are settled using the sum counters
that have been updated in steps 3, 4, 5, 6, 9, 10, 11 and 12. It should be
noted however that depending on operators agreements there may be no charging
when only signalling is carried, or simply decide not to use an IPX at all
(steps 3, 4, 5 and 6 in the above flow).
Roaming charges are instead based on the CDR generated by the anchor point at
step 7 (HPLMN A will compensate VPLMN A based on this record) and by the
P-CSCF of VPLMN B at step 13 (HPLMN B will compensate VPLMN B based on this
record).
## A.3.3 Application of GSMA roaming business model to IMS: home routing
This technical report documents two mechanisms to allow the HPLMN of the
subscriber to force the media to be routed to the destination by the HPLMN.
The first mechanism still relies on the signalling to loopback to the VPLMN
anchor point, but modifying in the HPLMN call processing the destination
address so that the media is sent to the HPLMN rather than to the intended
destination. In this case there is no change to the interconnection and
roaming accounting described in clause A.3.2. This option also does not
require further standardization compared to what is needed to set up a normal
(non home routed) call.
The second mechanism to perform home routing is simply to establish the media
path immediately from the I-BGF in VPLMN to the HPLMN so that there is no need
for the HPLMN to return the signalling to the VPLMN neither to invoke OMR
procedures. As for the interconnection accounting, this will be easily
managed, however whereas in the non home routed calls case and first mechanism
the TAP record exchanged between VPLMN and HPLMN can be based on the CDR
produced by the anchor point, in this case such network function is not
invoked therefore the TAP record needs to rely on the CDR generated by the
P-CSCF.
NOTE: A possible method for the billing system to determine whether the P-CSCF
or the anchor point CDR should be used is to indicate in the P-CSCF CDR
whether OMR has been applied or not.
###### ### Annex B: Recommendations for the Convergent Interconnection
# B.1 Convergent Interconnection
As mobile operators are in many circumstances using the same interconnection
providers that are used for fixed broadband access, the 3GPP system should
allow, for interconnection between PLMNs, to use the same inter-connection
infrastructure which is used between Fixed Broadband Access networks.
The 3GPP system ensures that interconnection hubs can serve transit traffic
between any type of IMS network in parallel (as for today's legacy CS
Interconnection).
The 3GPP system provides sufficient information by means of signalling
parameters to the interconnection hub to allow the interconnection provider to
determine, on a per session basis the correct traffic handling, i.e. there
will be no stateful context within an interconnection hub regardless of
whether it is deployed as interconnection hub for mobile or fixed broadband
access.
The routing mechanisms and associated signalling parameters ensures that
interconnection partners can apply distance based accounting unambiguously.
#