# Foreword
This Technical Specification (TS) has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The present document specifies Information element mapping between Mobile
Station - Base Station System (MS ‑ BSS) and Base Station System \- Mobile-
services Switching Centre (BSS - MSC) Signalling procedures and the Mobile
Application Part (MAP) within the digital cellular telecommunications system.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The scope of the present document is:
i) to provide a detailed specification for the interworking between
information elements contained in layer 3 messages sent on the MS-MSC
interface (Call Control and Mobility Management parts of 3GPP TS 24.008 [4])
and parameters contained in MAP services sent over the MSC-VLR interface (3GPP
TS 29.002 [9]) where the MSC acts as a transparent relay of information;
> ii) to provide a detailed specification for the interworking between
> information elements contained in BSSMAP messages sent on the BSC-MSC
> interface (3GPP TS 48.008 [12]) and parameters contained in MAP services
> sent over the MSC-VLR interface (3GPP TS 29.002 [9]) where the MSC acts as a
> transparent relay of information;
>
> iii) to provide a detailed specification for the interworking between
> information elements contained in BSSMAP messages (3GPP TS 48.008 [12]) and
> RANAP ((3GPP TS 25.413 [7]);
iv) to provide a detailed specification for the interworking as in i) and ii)
above when the MSC also processes the information;
v) to provide a detailed specification for the interworking between
information elements contained in layer 3 messages sent on the MS-SGSN
interface (GPRS mobility part of 3GPP TS 24.008 [4]) and parameters contained
in MAP services sent over the SGSN-HLR interface (3GPP TS 29.002 [9]);
vi) to provide a detailed specification for the interworking between
information elements contained in RANAP messages sent on the SGSN-RNC
interface (3GPP TS 25.413 [7]) and parameters contained in S1AP messages sent
on the MME-eNodeB interface (3GPP TS 36.413 [21]);
vii) to provide a detailed specification for the interworking of information
elements contained in BSSMAP messages (3GPP TS 48.008 [12]) or RANAP messages
(3GPP TS 25.413 [7]) during SRVCC handovers.
Interworking for supplementary services is given in 3GPP TS 29.011 [11].
Interworking for the short message service is given in 3GPP TS 23.040 [3] and
3GPP TS 24.011 [6]. Interworking between the call control signalling of 3GPP
TS 24.008 [4] and the PSTN/ISDN is given in GSM 09.03 [13], 3GPP TS 29.007
[10] and 3GPP TS 49.008 [14]. Interworking between the \'A\' and \'E\'
interfaces for inter-MSC handover signalling is given in 3GPP TS 29.007 [10]
and 3GPP TS 49.008 [14].
## 1.1 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
```{=html}
``` \- For a non-specific reference, the latest version applies. In the > case
of a reference to a 3GPP document (including a GSM document), > a non-specific
reference implicitly refers to the latest version > of that document _in the
same Release as the present document_.
[1] 3GPP TS 21.905: \"3G Vocabulary\".
[2] 3GPP TS 23.009: \"Handover procedures\".
[3] 3GPP TS 23.040: \"Technical realization of the Short Message Service (SMS)
Point to Point (PP)\".
[4] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core
Network Protocols-Stage 3\".
[5] 3GPP TS 24.010: \"Mobile radio interface layer 3 Supplementary services
specification - General aspects\".
[6] 3GPP TSº24.011: \"Point-to-Point (PP) Short Message Service (SMS) support
on mobile radio interface\".
[7] 3GPP TS 25.413: \"Iu interface RANAP signalling\".
[8] 3GPP TS 27.001: \" General on Terminal Adaptation Functions (TAF) for
Mobile Stations (MS)\".
[9] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[10] 3GPP TS 29.007: \"General requirements on interworking between the Public
Land Mobile Network (PLMN) and the Integrated Services Digital Network (ISDN)
or Public Switched Telephone Network (PSTN)\".
[11] 3GPP TS 29.011: \"Digital cellular telecommunications system (Phase 2+);
Signalling interworking for supplementary services\".
[12] 3GPP TS 48.008: \" Mobile Switching Centre ‑ Base Station System (MSC -
BSS) interface Layer 3 specification\".
[13] GSM 09.03: \"Digital cellular telecommunications system (Phase 2+);
Signalling requirements on interworking between the Integrated Services
Digital Network (ISDN) or Public Switched Telephone Network (PSTN) and the
Public Land Mobile Network (PLMN)\".
[14] 3GPP TS 49.008: \"Digital cellular telecommunications system (Phase 2+);
Application of the Base Station System Application Part (BSSAP) on the
E-interface\".
[15] 3GPP TS 29.108: \"Application of the Radio Access Network Application
Part (RANAP) on the E-interface\"
[16] 3GPP TS 23.271: \"Functional stage 2 description of LCS\"
[17] 3GPP TS 43.051: \"Technical Specification Group GSM/EDGE; Radio Access
Network; Overall description - Stage 2\".
[18] 3GPP TS 23.012: \"Location management procedures\".
[19] Void.
[20] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS)\".
[21] 3GPP TS 36.413: \"Evolved Universal Terrestrial Radio Access Network
E-UTRAN); S1 Application Protocol (S1AP)\".
[22] 3GPP TS 23.401: \" General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access \".
[23] 3GPP TS 29.060: \"GPRS Tunnelling Protocol (GTP) across the Gn and Gp
interface\".
[24] 3GPP TS 48.018: \" Base Station System (BSS) -Serving GPRS Support Node
(SGSN); BSS GPRS Protocol (BSSGP)\".
[25] 3GPP TS 29.280: \"3GPP EPS Sv interface (MME to MSC) for SRVCC\".
## 1.2 Abbreviations
Abbreviations used in the present document are listed in 3GPP TS 21.905.
## 1.3 Definitions
The following terms are used in this Technical Specification:
**A/Gb mode** : mode of operation of the MS when connected to the Core Network
via GERAN and the A and/or Gb interfaces. Throughout this specification the
term GSM refers to GERAN A/Gb mode _._
**Iu mode** : mode of operation of the MS when connected to the Core Network
via GERAN or UTRAN and the Iu interface. Throughout this specification the
term UMTS refers to UTRAN or GERAN Iu mode.
# 2 Classification of interworking cases
## 2.1 Transparent procedures
The following MSC procedures require transparent mapping of access protocol
information elements into MAP parameters and vice versa (see 3GPP TS 29.002
[9] for definitions and the use of the procedures):
  * location update;
  * forward new TMSI;
  * provide IMSI;
  * obtain IMEI;
  * check IMEI;
  * authenticate;
  * trace subscriber activity.
## 2.2 Non-transparent procedures
Procedures in this class require processing in the MSC and information element
mapping. These procedures include those related to:
\- outgoing call set-up;
\- incoming call set-up;
\- handover;
  * cipher mode setting;
  * location services.
# 3 Interworking in the MSC, Transparent case
## 3.1 General
When the MSC receives a forward message from the BSS (possibly forwarded
transparently from the MS), it will invoke the desired MAP service and
establish a cross reference between the BSSAP procedure and the MAP procedure
in order to return the result of the operation to the BSS (which may forward
it transparently to the MS. The cross reference is deleted when the MSC
terminates the MAP procedure.
Positive or negative results of the MAP procedure are returned in the
appropriate BSSAP message.
The parameters of the forward BSSAP message are mapped by a one-to-one mapping
into the parameters of the MAP service. However, in some cases parameters
received on the radio path may be suppressed at the MSC because they are
related to another protocol entity, e.g. information related to RR-management
may be included in MM-management messages. Similarly, parameters received in
the (positive) MAP service response are mapped one-to-one into parameters of
the corresponding backward BSSAP message.
A negative outcome, as carried in various MAP services (MAP specific service
response, MAP_U_ABORT, MAP_P_ABORT, MAP_NOTICE and premature MAP_CLOSE, see
3GPP TS 29.002 [9] for definitions) is mapped into a cause value in the
required backward BSSAP message. In this case several negative results of MAP
may be mapped into the same BSSAP cause value, i.e. without discrimination
between these negative results.
NOTE: For O & M purposes, the MAP procedure entity in the MSC may require a
more detailed overview of negative results than the MS.
These principles are illustrated in figure 1.
24.008 (48.008) MAP service
forward message request
\------------> \----------->
+-----------+ +---------+
\|information\| \|parameter\|
\| element \| \| \|
+-----------+ one-to-one +---------+
+----->\-------------------------------->\----+
mapping
MAP service
positive ack response
\ parameter 1 \|
\| information element 2 \ parameter 2 \|
\--------┼-------------------------------------------------┼-----
Positive\| MSC to MS/BSS VLR to MSC \|
result \| message name positive response \|
\| information element 1 \ parameter 1 \|
\| information element 2 \ parameter 2 \|
\--------┼-------------------------------------------------┼-----
Negative\| MSC to MS/BSS VLR to MSC \|
result \| message name negative response \|
\| cause 1 \ cause 1 \|
\| cause 2 \ cause 2 \|
\| cause 3 \ MAP_U/P_ABORT \|
\| cause 3 \ MAP_NOTICE \|
\| cause 3 \ MAP_CLOSE \|
\--------┴-------------------------------------------------┴-----
Equivalent mapping principles apply for operations invoked by the VLR towards
the BSS/MS. However, negative results are generally not received from the
BSS/MS but are generated in the MSC. Therefore, for such operations the
interworking for negative results is not normally shown.
## 3.2 Routeing area updating
\---------------------------------------------------------------
\| 24.008 29.002 \|Notes
\--------┼------------------------------------------------┼-----
Forward \| GMM (ROUTEING AREA MAP_UPDATE_GPRS _ \|
message \| UPDATE REQUEST) LOCATION request \|
\| \|
\| MS classmark 1 - \|
\| MS classmark 4 - \|
\| GPRS Ciphering - \|
\| key seq number \|
\| Mobile station IMSI \|
\| identity \|
\| Old routeing area - \|
\| identification \|
\--------┼------------------------------------------------┼-----
Positive\| GMM (ROUTEING AREA MAP_UPDATE_GPRS \|
results \| UPDATE ACCEPT) LOCATION response \|
\| \|
\| Routeing area - \|
\| identification \|
\| Mobile station - \| 1
\| identity \|
\| C Mobile station - \| 2
\| C Reject: IMSI unknown - \| 3
\| in HLR \|
\| C Reject: MSC temporarily - \| 4
\| not reacheable \|
\--------┼------------------------------------------------┼-----
Negative\| GMM (ROUTEING AREA MAP_UPDATE_GPRS \|
results \| UPDATE REJECT) LOCATION response \|
\| \|
\| Network failure - \| 5
\| GPRS services Unknown HLR \|
\| not allowed in \|
\| this PLMN \|
\| GPRS services Unknown subscriber \| 6
\| not allowed (no GPRS subscription) \|
\| GPRS services and Unknown subscriber \| 7
\| non GPRS services (IMSI unknown) \|
\| not allowed \|
\| C GPRS services Unknown subscriber \| 8
\| not allowed (no GPRS subscription) \|
\| C GPRS services and Unknown subscriber \| 9
\| non-GPRS services (IMSI unknown) \|
\| not allowed \|
\| MS identity cannot - \| 10
\| be derived by \|
\| the network \|
\| Roaming not allowed: \|
\| GPRS services not PLMN not allowed \|
│ allowed in this │
│ PLMN │
\| LA not allowed - \| 14
\| Roaming not allowed - \|
\| in this LA \|
\| No Suitable cells in - \| 11
\| location area \|
\| GPRS services not Operator \|
\| allowed in this determined barring\|
│ PLMN │
\| GPRS services not - \| 12
\| allowed in this \|
\| PLMN \|
\| C GPRS services not - \| 12
\| allowed in this \|
\| PLMN \|
\| Additional roaming \|
\| not allowed: \| 13
\| No Suitable cells in Supported RAT Types\|
\| location area not allowed \|
\| Illegal MS - \|
\| Illegal ME - \|
\| Network failure System Failure \|
\| Network failure Unexpected data value\|
\| Network failure MAP_U/P_ABORT \|
\| Network failure MAP_NOTICE \|
\| Network failure MAP_CLOSE \|
\--------┴------------------------------------------------┴-----
NOTE 1: The mobile station identity is inserted by the SGSN if the SGSN wants
to deallocate or re-allocate a P-TMSI. If the SGSN wants to deallocate the
P-TMSI it shall include the IMSI. If the SGSN wants to re-allocate the P-TMSI
it shall include the new P-TMSI. If a P-TMSI is included, the MS shall respond
with a ROUTEING AREA UPDATE COMPLETE message.
NOTE 2: The mobile station identity is inserted by the SGSN if it is received
in a BSSAP+ LOCATION UPDATE ACCEPT message from the VLR. If a TMSI is
included, the MS shall respond with a ROUTEING AREA UPDATE COMPLETE message.
Only used in the Combined Routeing and Location Area procedure.
NOTE 3: This reject cause is inserted on the positive response by the SGSN if
the SGSN receives a BSSAP+ LOCATION UPDATE REJECT message from the VLR
indicating in the reject cause IMSI unknown in HLR. Only used in the Combined
Routeing and Location Area procedure.
NOTE 4: This reject cause is inserted on the positive response by the SGSN if
the SGSN does not receive any response from the VLR to a previous BSSAP+
LOCATION UPDATE REQUEST message. Only used in the Combined Routeing and
Location Area procedure.
NOTE 5: The Unknown RA error is only generated as a result of incorrect
information being inserted by the BSS.
NOTE 6: The HLR shall send Unknown subscriber with diagnostic value No GPRS
subscription if the HLR indicates that there is an error in the type of
subscription (i.e. SGSN requests service for a non-GPRS only subscriber). The
HLR may also send this error in the MAP SEND AUTHENTICATION INFO RESPONSE
message.
NOTE 7: The HLR shall send Unknown subscriber with diagnostic value IMSI
unknown if the HLR indicates that the IMSI provided by the SGSN is unknown.
NOTE 8: The HLR shall send Unknown subscriber with diagnostic value No GPRS
subscription if the HLR indicates that there is an error in the type of
subscription (i.e. SGSN requests service for a non-GPRS only subscriber). Used
in the Combined Routeing and Location Area procedure. The HLR may also send
this error in the MAP SEND AUTHENTICATION INFO RESPONSE message.
NOTE 9: This reject cause is inserted if the SGSN receives a MAP GPRS UPDATE
LOCATION negative response message indicating IMSI unknown. Used in the
Combined Routeing and Location Area procedure.
NOTE 10: This reject cause is inserted if the SGSN does not receive any
response from the old SGSN to a previous SGSN CONTEXT REQUEST message.
NOTE 11: The \"No Suitable cells in location area\" error is generated when
the MS has access to only part of the PLMN e.g. due to Administrative
Restriction of Subscribers\' Access, but where there may also be suitable
location areas available. The MS retries on another location area. The
recommended cause due to Administrative Restriction of Subscriber\"s Access is
\"No Suitable Cells in Location Area\", but cause \"Roaming Not Allowed in
this LA\" may also be used, based on operator configuration.
NOTE 12: This reject cause is inserted if the SGSN receives in MAP INSERT
SUBSCRIBER DATA message an indication of Roaming restricted in SGSN due to
unsupported feature.
NOTE 13: Other reject causes than \"no Suitable cells in location area\" can
be used (e.g. \"Roaming not allowed in this location area\").
NOTE 14: The cause \"LA not allowed\" shall be sent only if the HLR indicates
that due to subscription to a \"regionally restricted service\" the MS is not
allowed to operate in the location area.
## 3.3 Authentication
The message flow for the authentication procedure is shown in figure 2.
MS MSC VLR
MAP_AUTHENTICATE request
AUTHENTICATION REQUEST \ MAP_AUTHENTICATE response
\---------------------------------->
or
MAP_U/P_ABORT
\---------------------------------->
Figure 2: Authentication operation
The MSC can only act on a MAP_AUTHENTICATE request if an RR connection exists
with the MS. If such a connection does not exist, the MSC shall terminate the
MAP procedure with a MAP_U_ABORT. The same applies if the MS does not respond
to an AUTHENTICATION REQUEST message.
\---------------------------------------------------------------
\| 24.008 29.002 \|Notes
\--------┼------------------------------------------------┼-----
Forward \| AUTHENTICATION REQUEST MAP_AUTHENTICATE \|
message \| request \|
\| \|
\| RAND RAND \|
\| \|
\| Ciphering key seq CKSN \|
\| number \|
\--------┼------------------------------------------------┼-----
Backward\| AUTHENTICATION REQUEST MAP_AUTHENTICATE \|
result \| response \|
\| \|
\| SRES SRES \|
\--------┴------------------------------------------------┴-----
If the SRES parameter does not match the value stored in the VLR, then the
ongoing MAP procedure shall be terminated with a cause \'illegal subscriber\'.
This shall cause the MSC to send an AUTHENTICATION REJECT message.
## 3.4 Retrieval of the IMSI from the MS
The VLR may request open identification of an MS with a MAP_PROVIDE_IMSI
request.
The mapping of information elements is as follows:
\---------------------------------------------------------------
\| 24.008 29.002 \|Notes
\--------┼------------------------------------------------┼-----
Forward \| IDENTITY REQUEST MAP_PROVIDE_IMSI \|
message \| request \|
\| Identity type \|
\| set to: IMSI \| 1
\--------┼------------------------------------------------┼-----
Backward\| IDENTITY RESPONSE MAP_PROVIDE_IMSI \|
result \| Mobile Identity (IMSI) response \|
\--------┴------------------------------------------------┴-----
NOTE 1: The INVOKE does not carry any parameters. The identity type is
inferred from the invoke name.
The MSC shall return a MAP_PROVIDE_IMSI response with user error \"absent
subscriber\" if:
\- there is no RR connection with the MS when the MAP service request is
received;
\- there is no response from the MS.
## 3.5 Reallocation of TMSI
This operation is invoked by the VLR. The MAP_FORWARD_NEW_TMSI request
contains the new TMSI which is forwarded to the MS in the TMSI REALLOCATION
COMMAND. When the MS acknowledges the receipt of the new TMSI, the MSC will
return a MAP_FORWARD_NEW_TMSI response to the VLR.
If there is no radio connection to the MS when the MSC receives the MAP
service request, the MSC shall ignore the message.
\---------------------------------------------------------------
\| 24.008 29.002 \|Notes
\--------┼------------------------------------------------┼-----
Forward \| TMSI REALLOCATION MAP_FORWARD_NEW_TMSI \|
message \| COMMAND request \|
\| \|
\| Mobile identity TMSI \|
\| \|
\| Location area \|
\| identification - \|
\--------┼------------------------------------------------┼-----
Backward\| TMSI REALLOCATION MAP_FORWARD_NEW_TMSI \|
result \| COMPLETE response \|
\--------┴------------------------------------------------┴-----
## 3.6 Retrieval of the IMEI from the MS
The VLR may use the MAP_OBTAIN_IMEI service to request the MS to supply its
IMEI , or may use the MAP_CHECK_IMEI service to request the MSC to check the
MS\'s IMEI. For either MAP service the BSSAP signalling is the same.
The mapping of information elements is as follows:
\---------------------------------------------------------------
\| 24.008 29.002 \|Notes
\--------┼------------------------------------------------┼-----
Forward \| (MAP_CHECK_IMEI request \|
message \| IDENTITY REQUEST ( or \|
\| (MAP_OBTAIN_IMEI request \|
\| Identity type \|
\| set to: IMEI \| 1
\--------┼------------------------------------------------┼-----
Backward\| (MAP_CHECK_IMEI response \|
result \| IDENTITY RESPONSE ( or \|
\| (MAP_OBTAIN_IMEI response \|
\| \|
\| Mobile Identity IMEI \| 2
\| (IMEI) \|
\--------┴------------------------------------------------┴-----
NOTE 1: The MAP service request does not carry any parameters. The identity
type is inferred from the service name.
NOTE 2: If the MAP_CHECK_IMEI service was used, the MSC also returns the
equipment status to the VLR in the MAP_CHECK_IMEI response, after a successful
dialogue with the EIR using the IMEI received from the MS.
The MSC shall terminate the MAP dialogue with the VLR using a MAP_U_ABORT if:
\- there is no RR connection with the MS when the MAP service request is
received;
\- there is no response from the MS.
NOTE: The MSC can also obtain the IMEI from a phase 2 MS by including
appropriate information in the BSSMAP Cipher Mode Command.
## 3.7 Tracing subscriber activity
The VLR may request the MSC and/or BSS to record data about the current
transaction with an MS.
\---------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼------------------------------------------------┼-----
Forward \| MSC INVOKE TRACE MAP_TRACE_SUBSCRIBER_ \|
message \| ACTIVITY request \|
\| \|
\| Trace type Trace type \|
\| TriggerId - \|
\| Trace reference Trace reference \|
\| TransactionId - \|
\| Mobile identity(IMSI) IMSI \| 1
\| Mobile identity(IMEI) IMEI \| 1
\| OMCId OMCId \|
\--------┼------------------------------------------------┼-----
Backward\| none none \|
result \| \|
\--------┴------------------------------------------------┴-----
NOTE 1: The VLR may provide either an IMSI or IMEI, but not both.
## 3.8 Location update
\---------------------------------------------------------------
\| 24.008 29.002 \|Notes
\--------┼------------------------------------------------┼-----
Forward \| MM (LOCATION UPDATING MAP_UPDATE_LOCATION_ \|
message \| REQUEST) request \|
\| \|
\| Location area id - \|
\| Mobile identity IMSI \|
\| Mobile station \|
\| classmark 1 - \|
\| Mobile station \|
\| classmark 2 - \|
\| Ciphering key - \|
\| seq number \|
\| Location update - \|
\| type \|
\--------┼------------------------------------------------┼-----
Positive\| MM (LOCATION MAP_UPDATE_LOCATION \|
results \| UPDATING ACCEPT) response \|
\| \|
\| Location area identity - \|
\| Mobile identity - \|
\| Follow on proceed - \|
\--------┼------------------------------------------------┼-----
Negative\| MM (LOCATION MAP_UPDATE_LOCATION \|
results \| UPDATING REJECT) response \|
\| \|
\| IMSI unknown in HLR Unknown subscriber \| 1
\| Roaming not allowed: \|
\| PLMN not allowed PLMN not allowed \|
\| LA not allowed - \| 3
\| Roaming not - \|
\| allowed in this LA \|
\| No Suitable cells in - \|
\| location area \|
\| PLMN not allowed Operator \|
\| determined barring\|
\| Additional roaming \|
\| not allowed: \|
\| No Suitable cells in Supported RAT Types\| 2
\| location area not allowed \|
\| Illegal MS - \|
\| Illegal ME - \|
\| Network failure System Failure \|
\| Network failure Unexpected data value\|
\| Network failure MAP_U/P_ABORT \|
\| Network failure MAP_NOTICE \|
\| Network failure MAP_CLOSE \|
\--------┴------------------------------------------------┴-----
NOTE 1 The HLR shall also send this error if there is an error in the type of
subscription (i.e. VLR requests service for a GPRS only subscriber).
NOTE 2: Other reject causes than \"no Suitable cells in location area\" can be
used (e.g. \"Roaming not allowed in this location area\").
NOTE 3 The VLR shall return the cause \"LA not allowed\" only if the HLR
indicates that due to subscription to a \"regionally restricted service\" the
MS is not allowed to operate in the location area.
If the VLR finds out that the access is denied due to Administrative
Restriction of Subscribers\" Access based on subscription info received from
HLR, VLR will send negative response to the MSC. The MSC will map the received
cause using following mapping table:
\---------------------------------------------------------------
\| 24.008 \|Notes
\--------┼------------------------------------------------┼-----
Negative\| MM (LOCATION UPDATE_LOCATION \| 1
results \| UPDATING REJECT) AREA response \|
\| \|
\| PLMN not allowed PLMN not allowed \|
\| Roaming not National Roaming \|
\| allowed in this LA not allowed \|
\| No Suitable cells in RAT not allowed \|
\| location area \|
NOTE 1 The UPDATE LOCATION AREA response refers to the internal interface used
between VLR and MSC (see 3GPP TS 23.012 [18]).
# 4 Interworking in the MSC, Non-transparent cases
## 4.1 General
For interworking other than the mapping of information fields, see 3GPP TS
49.008 [14].
## 4.2 Outgoing call set-up (MS originating call)
Figure 3 shows those elements of a call set-up sequence which require
interworking between BSSAP and MAP. BSSAP messages which do not require
interworking with MAP are not shown.
MS MSC VLR
CM SERVICE REQUEST
\-----------------------> MAP_PROCESS_ACCESS_REQUEST request
\---------------------------------->
+--------------------------+
\| Possibly \|
\| identification procedure/\|
\| authentication procedure \|
+--------------------------+
MAP_SET_CIPHERING_MODE request
\
MAP_FORWARD_NEW_TMSI request
TMSI REALLOCATION COMMAND \ MAP_FORWARD_NEW_TMSI response
\---------------------------------->
MAP_PROCESS_ACCESS_REQUEST response
CM SERVICE REJECT \ MAP_SEND_INFO_FOR_OUTGOING_CALL
\---------------------------------->
request
MAP_COMPLETE_CALL request
CALL PROCEEDING \ MAP_SEARCH_FOR_MS response (Note 2)
\---------------------------------->
MAP_PROCESS_ACCESS_REQUEST request
\---------------------------------->
+--------------------------+
\| Possibly \|
\| authentication procedure \|
+--------------------------+
MAP_SET_CIPHERING_MODE request
\
MAP_FORWARD_NEW_TMSI request
TMSI REALLOCATION COMMAND \ MAP_FORWARD_NEW_TMSI response
\---------------------------------->
MAP_COMPLETE_CALL request
SETUP \ need to be forwarded to the target radio access network and the > encapsulated protocol is the same as the protocol used at the > interface between the target MSC and the target radio access > network.
2\. The parameters shall be added to be carried in a MAP message
\- when they need to be forwarded to the target radio access network and the
encapsulated protocol is different from the protocol used at the interface
between the target MSC and the target radio access network;
\- when they are required by the target MSC, but not to be forwarded to the
target radio access network; or
  * when they are required by the target MSC for subsequent procedures
and they cannot be derived from the message encapsulated in the AN-APDU.
### 4.5.1 Basic Inter-MSC Handover
When a Mobile Station is handed over between two MSCs, the establishment of a
connection between them (described in 3GPP TS 23.009 [2]) requires
interworking between A-Interface and E-Interface.
The signalling at initiation, execution, completion of the Basic Inter-MSC
handover procedure is shown in figures 5 to 10 with both possible positive or
negative outcomes.
Additionally figures 5b and 5c show the possible interworking when trace
related messages are transparently transferred on the E-Interface at Basic
Inter-MSC Handover initiation.
BSS-A MSC-A MSC-B
\| \| \|
\|HANDOVER \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request \| \|Possible Alloc. \|
\| \| \| \|of a handover \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|------------------>\|
Figure 5a: Signalling for Basic Inter-MSC Handover initiation (no trace
related messages transferred)
BSS-A MSC-A MSC-B
\|BSC INVOKE TRACE \|
\|-------------->\| \|
\| \| \|
\|HANDOVER \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request(*) \| \|Possible Alloc. \|
\| \| \| \|of a handover \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \|BSC INVOKE TRACE \|
\| \| \|---------------->(**)
Figure 5b: Signalling for Basic Inter-MSC Handover initiation (BSC invoke
trace message transferred)
(*): In that case, HANDOVER REQUEST and BSC INVOKE TRACE messages are included
within the AN-APDU parameter.
(**): BSC INVOKE TRACE is forwarded to BSS-B if supported by MSC-B.
BSS-A MSC-A MSC-B
\| (*) \|
\|HANDOVER \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request(**) \| \|Possible Alloc. \|
\| \| \| \|of a handover \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \|MSC INVOKE TRACE \|
\| \| \|--------------->(***)
Figure 5c: Signalling for Basic Inter-MSC Handover initiation (MSC invoke
trace message transferred)
(*): Tracing invocation has been received from VLR.
(**): In that case, HANDOVER REQUEST and MSC INVOKE TRACE messages are
included within the AN-APDU parameter.
(***): MSC INVOKE TRACE is forwarded to BSS-B if supported by MSC-B.
Possible Positive outcomes:
a) successful radio resources allocation and handover number allocation (if
performed):
BSS-A MSC-A MSC-B BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|\\| \| \|
\|FAILURE \| \| \|
\| \|MAP U -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|CLEAR COMMAND \|
\| \| \|------------------>\|
\| \| \| \|
Figure 7: Signalling for Basic Inter-MSC Handover execution (Negative
outcomes)
NOTE: Possible rejection of the handover because of the negative outcome of
MAP or BSSMAP procedure.
BSS-A MSC-A MSC-B BSS-B
\| \| \| \|
\| \| \|HANDOVER COMPLETE \|
\| \| \|\\| \|
\| \| response \|CLEAR COMMAND \|
\| \| \|------------------>\|
\| \| \| (Note 1) \|
Figure 9: Signalling for Basic Inter-MSC Handover completion (Positive
outcome)
Negative outcome
BSS-A MSC-A MSC-B BSS-B
\| \| \| \|
\| \| MAP U/P -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|CLEAR COMMAND \|
\| \| \|------------------>\|
\| \| \| \|
Figure 10: Signalling for Basic Inter-MSC Handover completion (Negative
outcome)
NOTE: From interworking between MAP and BSSMAP point of view.
The handover procedure is normally triggered by BSS-A by sending a HANDOVER
REQUIRED message on A‑Interface to MSC-A. The invocation of the Basic Inter-
MSC handover procedure is performed and controlled by MSC-A. The sending of
the MAP Prepare-Handover request to MSC-B is triggered in MSC-A upon receipt
of the HANDOVER REQUIRED message. For compatibility reason, the cell identity
of the cell where the call is to be handed over in MSC-B area, provided in the
HANDOVER REQUIRED message, is mapped into targetCellId MAP parameter and the
HANDOVER REQUEST message is encapsulated in the AN-APDU MAP parameter of the
Prepare-Handover MAP request. MSC-B can invoke another operation towards the
VLR-B (allocation of the handover number described in 3GPP TS 29.002 [9]).
Additionally, if tracing activity has been invoked, the trace related messages
can be transferred on the E-Interface encapsulated in the AN-APDU MAP
parameter of the Prepare-Handover Request. If transferred, one complete trace
related message at a time shall be included in the AN-APDU MAP parameter after
the HANDOVER REQUEST message.
The interworking between Prepare Handover and HANDOVER REQUIRED is as follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| HANDOVER REQUIRED MAP PREPARE HANDOVER request\|
message \| \|
\| -ho-NumberNotRequired\| 1
\| BSSMAP information -targetCellId \|
\| elements -AN-APDU( \| 2
\| HANDOVER REQUEST, \|
\| BSC INVOKE TRACE \| 3
\| or MSC INVOKE TRACE) \|
\--------┼-------------------------------------------------┼-----
Positive\| MAP PREPARE HANDOVER response\|
result \| \| 4
\| -handover number \|
\| -AN-APDU( \|
\| QUEUING INDICATION \|
\| or HANDOVER REQUEST\|
\| ACKNOWLEDGE or \|
\| HANDOVER FAILURE) \|
\--------┼-------------------------------------------------┼-----
Negative\| HANDOVER REQUIRED REJECT MAP PREPARE HANDOVER\| 5
result \| \|
\| equipment failure System Failure \|
\| equipment failure No Handover Number \|
\| available \|
\| equipment failure UnexpectedDataValue\|
\| equipment failure Data Missing \|
\| \|
\| equipment failure MAP CLOSE \|
\| equipment failure MAP U/P -ABORT \|
\| \|
NOTE 1: The ho-NumberNotRequired parameter is included by MSC-A, when MSC-A
decides not to use any circuit connection with MSC-B. No handover number shall
be present in the positive result. Any negative response from MSC-B shall not
be due to handover number allocation problem.
NOTE 2: The process performed on the BSSMAP information elements received in
the HANDOVER REQUIRED message is described in the GSM Recommendation 3GPP TS
48.008 [12].
NOTE 3: The process performed on the BSSMAP information elements received in
the MSC or BSC INVOKE TRACE message is described in subclause 4.5.6.6.
NOTE 4: The response to the Prepare-Handover request can include in its AN-
APDU parameter, identifying the GSM-08.06 protocol, either a BSSMAP QUEUING
INDICATION, or a BSSMAP HANDOVER REQUEST ACKNOWLEDGE or a BSSMAP HANDOVER
FAILURE.
In the first case, MSC-A shall wait for the radio resources allocation
response from MSC-B, transmitted to MSC-A as described in subclause 4.5.4.
In the second case, the positive result triggers in MSC-A the sending on
A-Interface of the HANDOVER COMMAND.
In the third case, the positive result triggers in MSC-A one of the following:
\- another handover attempt is initiated by MSC-A;
\- optionally the sending of the HANDOVER REQUIRED REJECT.
(The possible sending of the HANDOVER REQUIRED REJECT message upon receipt of
the HANDOVER FAILURE is out of the scope of 3GPP TS 29.010 and lies in 3GPP TS
48.008 [12]).
NOTE 5: The possible sending of the HANDOVER REQUIRED REJECT message is
described in 3GPP TS 48.008 [12].
The interworking between Send End Signal and HANDOVER COMPLETE in MSC-B is as
follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| HANDOVER COMPLETE MAP SEND END SIGNAL request \|
message \| \|
\| -AN-APDU( \|
\| HANDOVER COMPLETE)\|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| CLEAR COMMAND MAP SEND END SIGNAL response\|
result \| -Call Control release \| 1
\--------┼-------------------------------------------------┼-----
Negative\| CLEAR COMMAND \|
result \| -Call Control release MAP CLOSE \| 2
\| -Call Control release MAP U/P -ABORT \|
\| \|
NOTE 1: The positive empty result triggers the clearing of the Radio Resources
on the A-Interface and the release of the SCCP connection between MSC-B and
BSS-B. If a circuit connection is used between MSC-A and MSC-B, the \'Call
Control release\' clearing cause shall only be given to BSS-B when MSC-B has
received a clearing indication on its circuit connection with MSC-A.
NOTE 2: The abortion of the dialogue or the rejection of the component
triggers in MSC-B the clearing of its circuit connection with MSC-A, if any,
of the Radio Resources on the A-Interface and the release of the SCCP
connection between MSC-B and BSS-B.
The interworking between Send End Signal and CLEAR COMMAND in MSC-A is as
follows:
\----------------------------------------------------------------
\| 29.002 48.008 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| MAP SEND END SIGNAL CLEAR COMMAND \|
message \| response \|
\| -AN-APDU( - Handover \|
\| HANDOVER COMPLETE) Successful \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
The interworking between HANDOVER FAILURE in case of reversion to old channel
of the MS and User Abort in MSC-A is as follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| HANDOVER FAILURE MAP U -ABORT \|
message \| \|
\| - Reversion to old \|
\| channel \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
### 4.5.2 Subsequent Inter-MSC Handover back to MSC-A
When a Mobile Station is being handed over back to MSC-A, the procedure
(described in 3GPP TS 23.009 [2]) requires interworking between A-Interface
and E-Interface.
The signalling at initiation, execution and completion of the Subsequent
Inter-MSC handover procedure is shown in figures 11 to 15.
BSS-A MSC-B MSC-A
\| \| \|
\|HANDOVER \| \|
\|-------------->\|MAP PREPARE SUBSEQUENT \|
\|REQUIRED \|------------------------>\|
\| \|HANDOVER request \|
\| \| \| BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|------------------>\|
Figure 11: Signalling for Subsequent Inter-MSC Handover back to MSC-A
initiation
Possible Positive outcomes:
a) successful radio resources allocation:
BSS-A MSC-B MSC-A BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|\\|MAP SEND END SIGNAL \| \|
\|COMPLETE \|------------------------>\| \|
\| \| response \| \|
\| \| \|CLEAR COMMAND \|
\| \| \|------------------>\|
Figure 14: Signalling for Subsequent Inter-MSC Handover back to MSC-A
completion\ (Successful completion of the procedure)
NOTE: Positive outcome case shown in figure 9.
BSS-B MSC-A MSC-B BSS-A
\| \| \| \|
\|HANDOVER \| \| \|
\|-------------->\|MAP SEND END SIGNAL \| \|
\|COMPLETE \|------------------------>\| \|
\| \| response \| \|
\| \| \| \|
\| \|MAP U/P -ABORT \| \|
\| \|\\|
\| \| \|(Note 1) \|
Figure 15: Signalling for Subsequent Inter-MSC Handover back to MSC-A
completion (Unsuccessful completion of the procedure)
NOTE 1: Abnormal end of the procedure which triggers the clearing of all
resources in MSC-B.
The interworking between Prepare Subsequent Handover and HANDOVER REQUIRED is
as follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \|HANDOVER REQUIRED MAP PREPARE SUBSEQUENT HANDOVER\|
message \| request \| 1
\| \|
\| -target MSC number \|
\| BSSMAP information -targetCellId \|
\| elements -AN-APDU( \|
\| HANDOVER REQUEST) \|
\--------┼-------------------------------------------------┼-----
Positive\|HANDOVER REQUIRED MAP PREPARE SUBSEQUENT HANDOVER\|
result \| response \| 2
\| -AN-APDU( \|
\| QUEUING INDICATION \|
\| or HANDOVER REQUEST\|
\| ACKNOWLEDGE or \|
\| HANDOVER FAILURE) \|
\--------┼-------------------------------------------------┼-----
Negative\| HANDOVER REQUIRED REJECT MAP PREPARE SUBSEQUENT\| 3
result \| HANDOVER response \|
\| equipment failure Unknown MSC \|
\| equipment failure Subsequent Handover\|
\| Failure \|
\| equipment failure UnexpectedDataValue\|
\| equipment failure Data Missing \|
\| \|
\| CLEAR COMMAND \|
\| \|
\| equipment failure MAP CLOSE \|
\| equipment failure MAP U/P -ABORT \|
\| \|
NOTE 1: The processing performed on the BSSMAP information elements received
in the HANDOVER REQUIRED message is out of the scope of the present document.
The target MSC number is provided to MSC-A by MSC-B based on the information
received from BSS-B.
NOTE 2: The response to the Prepare-Subsequent-Handover request can include in
its AN-APDU parameter, identifying the GSM-0806 protocol, either a BSSMAP
QUEUING INDICATION, or a BSSMAP HANDOVER REQUEST ACKNOWLEDGE or a BSSMAP
HANDOVER FAILURE.
In the first case, MSC-B shall wait for the radio resources allocation
response from MSC-A, transmitted to MSC-B as described in subclause 4.5.4.
In the second case, the positive result triggers in MSC-B the sending on
A‑Interface of the HANDOVER COMMAND.
In the third case, the positive result triggers in MSC-B one of the following:
\- another handover attempt is initiated by MSC-B;
\- optionally the sending of the HANDOVER REQUIRED REJECT.
(The possible sending of the HANDOVER REQUIRED REJECT message upon receipt of
the HANDOVER FAILURE is out of the scope of 3GPP TS 29.010 and lies in 3GPP TS
48.008 [12]).
NOTE 3: The possible sending of the HANDOVER REQUIRED REJECT message is
described in 3GPP TS 48.008 [12].
The interworking between Send End Signal Result and HANDOVER COMPLETE in MSC-A
is as follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| HANDOVER COMPLETE MAP SEND END SIGNAL \|
message \| response \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| MAP U/P -ABORT \| 1
\| \|
NOTE 1: The abortion of the dialogue ends the handover procedure with MSC-B.
### 4.5.3 Subsequent Inter-MSC Handover to third MSC
When a Mobile Station is being handed over to a third MSC, the procedure
(described in 3GPP TS 23.009 [2]) does require one specific interworking case
in MSC-A (figure 20) between E-Interface from MSC-B and E-Interface from
MSC-B\' other than the combination of the ones described in the subclause
4.5.1 and 4.5.2.
BSS-A MSC-B MSC-A MSC-B\'
\| \| \| \|
\|HANDOVER \| \| \|
\|----------->\|MAP PREPARE SUSEQUENT \| \|
\|REQUIRED \|--------------------->\| \|
\| \|HANDOVER request \|MAP PREPARE \|
\| \| \|--------------->\|
\| \| \|HANDOVER request\|
\| \| \| \|+-------+
\| \| \| \|\|Possib.\|
\| \| \| \|\|Alloc. \|
\| \| \| \|\|of ho. \|
\| \| \| \|\|number \|
\| \| \| \|\| VLR-B \|
\| \| \| \|+-------+
\| \| \| \| BSS-B\'
\| \| \| \| \|
\| \| \| \|HANDOVER \|
\| \| \| \|-------->\|
\| \| \| \|REQUEST \|
\| \| \| \|
Figure 16: Signalling for Subsequent Inter-MSC Handover to third MSC (MSC-B\')
initiation
Possible Positive outcomes:
a) successful radio resources allocation:
BSS-A MSC-B MSC-A MSC-B\'
\| \| \| \|
\| \| \| \| BSS-B\'
\| \| \| \| \|
\| \| \| \|HANDOVER \|
\| \| \| \|\\| \| \| \|
\|FAILURE \|MAP PROCESS ACCESS \| \| \|
\| \|--------------------->\| \| \|
\| \|SIGNALLING request (Note 1) \| \|
\| \| \| \| \|
\| \| \|MAP U -ABORT \| \|
\| \| \|--------------->\| \|
\| \| \| \|CLEAR \|
\| \| \| \|-------->\|
\| \| \| \|COMMAND \|
\| \| \| \| \|
Figure 20: Signalling for Subsequent Inter-MSC Handover to third MSC (MSC-B\')
completion (Unsuccessful completion of the procedure)
NOTE 1: Specific interworking case detailed below.
The specific interworking case in MSC-A compared to the subclauses 4.5.1 and
4.5.2 occurs between HANDOVER FAILURE encapsulated in a Process Access
Signalling from MSC-B and the abortion of the dialogue with MSC-B\' in the
case of a reversion to old channel of the MS:
\----------------------------------------------------------------
\| 29.002 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| MAP PROCESS-SIGNALLING \|
message \| request \|
\| \|
\| -AN-APDU( MAP U -ABORT \| 1
\| HANDOVER FAILURE) \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| MAP U/P -ABORT \| 2
\| \|
NOTE 1: The abortion of the dialogue triggers in MSC-B\' the clearing of the
circuit connection with MSC-A, if any, and of the Resources between MSC-B\'
and BSS-B\'.The abortion of the dialogue ends the handover procedure with
MSC-B\'.
NOTE 2: The abortion of the dialogue ends the handover procedure with MSC-B.
### 4.5.4 BSSAP Messages transfer on E-Interface
The following mapping applies to the encapsulation performed in MSC-A.
\----------------------------------------------------------------
\| 24.008/48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| BSSAP messages MAP FORWARD ACCESS SIGNALLING\|
message \| request \| 1
\| \|
\| -AN-APDU (BSSAP messages) \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \| 2
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| MAP CLOSE \|
\| MAP U/P -ABORT \|
\| \|
NOTE 1: Complete BSSAP messages to be sent on MSC-B - BSS-B interface (BSSMAP
or DTAP messages) are embedded into the AN-APDU parameter (see Annex A of 3GPP
TS 48.008 [12] for the description of the set of BSSMAP messages).
NOTE 2: The Return Result does not apply. If MSC-B returns a message, this
message will arrive in an Invoke: Process Access Signalling.
The following mapping applies to the encapsulation performed in MSC-B.
\----------------------------------------------------------------
\| 24.008/48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| BSSAP messages MAP PROCESS ACCESS SIGNALLING\|
message \| request \| 1
\| \|
\| -AN-APDU (BSSAP messages)\|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \| 2
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| MAP CLOSE \|
\| CLEAR COMMAND \|
\| \|
\| equipment failure MAP U/P -ABORT \| 3
\| \|
NOTE 1: Complete BSSAP messages to be sent to MSC-A (BSSMAP or DTAP messages)
are embedded into the AN-APDU parameter (see 3GPP TS 49.008 [14] for the
description of the set of BSSMAP messages).
NOTE 2: The Return Result does not apply. If MSC-A returns a message, this
message will arrive in an Invoke: Forward Access Signalling.
NOTE 3: The abortion of the dialogue triggers the clearing of the circuit
connection with MSC-A, if any, of the Radio Resources on the A-Interface and
the release of the SCCP connection between MSC-B and BSS-B. The clearing of
the Radio Resources (the clearing indication received from BSS-B is
transmitted to MSC‑A) or the loss of the SCCP connection between MSC-B and
BSS-B, triggers in MSC-B the abortion of the dialogue on the E-Interface and
the clearing of the circuit connection with MSC-A, if any.
### 4.5.5 Processing in MSC-B, and information transfer on E-interface
The following parameters require processing (e.g. to store the parameter, to
internally generate the parameter) in MSC‑B. The relevant BSSMAP procedures
are mentioned to ease the comprehension, their detailed description is the
scope of 3GPP TS 48.008 [12]. Each BSSMAP message listed in 3GPP TS 49.008
[14] being transferred on E-interface shall use the mechanisms given in
subclause 4.5.4 and is described in 3GPP TS 48.008 [12].
For intra-MSC-B handover/relocation and security interworking , after inter-
MSC handover from GSM to GSM, the 3G_MSC-B needs additional information to be
able to perform security mode and integrity protection procedures. These RANAP
informations are transferred between MSC-A and 3G-MSC-B in MAP messages,
defined in 3GPP TS 29.002 [9].
For subsequent handover/relocation, after inter-MSC handover from GSM to GSM,
the 3G_MSC-B needs additional information to be able to perform service
handover procedures. The relevant information is transferred between MSC-A and
3G-MSC-B in MAP messages, defined in 3GPP TS 29.002 [9].
For subsequent handover/relocation, after inter-MSC handover from GSM to GSM,
the 3G_MSC-B needs additional information to be able to forward access rights
information in the context of Shared Network to the RAN. The relevant
information is transferred between MSC-A and 3G-MSC-B in MAP messages, defined
in 3GPP TS 29.002 [9].
#### 4.5.5.1 Encryption Information
A sequence of possible encryption algorithms can be sent to a BSS in Cipher
Mode Command or Handover Request. The BSS chooses one of the listed algorithms
and reports this back to the MSC in Cipher Mode Complete or Handover Request
Acknowledge respectively.
MSC-B shall remove algorithms not allowed by MSC-B from the list of algorithms
received from MSC-A before forwarding it to the BSS. The modified list of
algorithms, the ciphering key and the chosen algorithm shall be stored by
MSC-B, and the chosen value sent to MSC-A.
Transfer of Information:
If ciphering has not been performed before Inter-MSC Handover, this will be
controlled by MSC-A after the completion of Inter-MSC Handover.
Ciphering control towards MSC-B:
If Ciphering has been performed before Inter-MSC Handover:
\- in the Handover Request BSSMAP message (information included).
The Handover Request Acknowledge should in this case contain the indication of
the chosen algorithm.
If Ciphering has NOT been performed before Inter-MSC Handover:
\- in the Cipher Mode Command procedure between MSC-A and MSC-B.
If the encryption algorithm is changed at an intra-BSS handover in BSS-B this
must be reported to MSC-A in:
\- the BSSMAP Handover Performed procedure.
If the encryption algorithm is changed at an intra-MSC handover in MSC-B this
must be reported to MSC-A in:
\- the BSSMAP Handover Performed procedure which shall be initiated by MSC-B
on reception from BSS-B of the Handover Complete message (the information
being previously received in the Handover Request Acknowledge message).
Note also that the chosen encryption value may be contained in the BSSMAP
Assignment Complete message. This may happen if the encryption value changes
e.g. at a second assignment during a call (e.g. from TCH to SDCCH).
#### 4.5.5.2 Channel Type
Assignment Request and Handover Request (BSSMAP) may give the BSS a choice, in
the same way as the Encryption Algorithm above. Depending on the Channel Type
Info, the chosen channel may have impact on subsequent handovers, internal in
MSC-B and inter-MSC controlled by MSC-A. Some values in channel Type Info
indicate that if a particular channel once has been chosen, the same type must
be used for the rest of the call.
The Channel Type, and the characteristics of the chosen channel shall be
stored by MSC-B, and the Chosen Channel and/or Speech Version information
elements transferred to MSC-A.
Transfer of Information:
Independently of the type of resource (Signalling only (e.g. SDCCH) or TCH)
assigned to the MS, the Channel Type Information is transferred to MSC-B in:
\- the Handover Request BSSMAP message, and the Chosen Channel and/or Speech
Version should be reported back to MSC-A in the Handover Request Acknowledge.
If a new type of resource is to be assigned after Inter-MSC Handover, this can
be made with:
\- the BSSMAP Assignment procedure between MSC-A and MSC-B (Chosen Channel
and/or Speech Version in Assignment Complete).
If the Channel Type (the chosen channel and/or chosen speech version) is
changed at an intra-BSS handover in BSS-B this must be reported to MSC-A in:
\- the BSSMAP Handover Performed procedure.
If the Channel Type (the chosen channel or chosen speech version) is changed
at an intra-MSC handover in MSC-B this must be reported to MSC-A in:
\- the BSSMAP Handover Performed procedure which shall be initiated by MSC-B
on reception from BSS-B of the Handover Complete message (the information
being previously received in the Handover Request Acknowledge message).
#### 4.5.5.3 Classmark
This information shall be stored by MSC-B and might be received either from
MSC-A, or from the MS when the MS initiates a Classmark Update.
Transfer of Information due to Classmark received from MSC-A:
This information shall be stored by MSC-B and is received:
\- in the Handover Request BSSMAP message.
If a new type of resource is to be assigned after Inter-MSC Handover,
Classmark Information MAY be included:
\- in the BSSMAP Assignment procedure.
Transfer of Information, due to \"Classmark Signalling Procedures\".
This information shall be stored by MSC-B and can be received:
\- Due to a classmark update, either requested from MSC-A (Classmark Request,
Classmark Update), or an MS-Initiated Classmark Update.
This can be carried out either with:
\- the BSSMAP Classmark procedure(s).
Apart from these cases there is the \"odd\" case where a Classmark Update can
be received during an Inter-MSC Handover by MSC-B, i.e. before the MS has
moved to the new channel controlled by MSC-B. This can be made with
transparent transfer of BSSMAP Classmark Update.
#### 4.5.5.4 Downlink DTX-Flag
The parameter shall be stored by MSC-B to be used at internal Handover in
MSC-B.
Transfer of Information:
Received by MSC-B from MSC-A in either:
If the MS has already been assigned to a TCH for speech before the Inter-MSC
Handover, the DTX-flag should be sent in:
\- the Handover Request BSSMAP message;
(if the type of resource is not TCH for speech, the DTX-flag shall not be
included).
If a new assignment to a TCH for speech after an Inter-MSC Handover is to be
performed, this can be made with:
\- the BSSMAP Assignment procedure.
#### 4.5.5.5 Priority
The parameter shall be stored by MSC-B and is received according to below:
Transfer of Information:
Received by MSC-B from MSC-A in:
\- the Handover Request BSSMAP message.
If a change is needed after an Inter-MSC Handover with:
\- the BSSMAP Assignment procedure.
#### 4.5.5.6 MSC/BSC-Invoke Trace Information Elements
The process to be performed by MSC-B on the information elements of the MSC or
BSC Invoke Trace BSSMAP messages is left for further study.
#### 4.5.5.7 LSA Identifier List
The parameter shall be stored by MSC-B and is received according to below:
Transfer of Information:
Received by MSC-B from MSC-A in:
\- the Handover Request BSSMAP message.
If a change is needed after an Inter-MSC Handover with:
  * the LSA Information BSSMAP message.
#### 4.5.5.8 Selected UMTS Algorithm
After inter-MSC handover, the 3G_MSC-B can perform intra-MSC GSM to UMTS
handover. A sequence of possible encryption and integrity protection
algorithms, received from the 3G_MSC-A, can be sent to an RNS in Relocation
Request or in Security Mode Command in case of cipher mode setting after
intra.MSC-B handover from GSM to UMTS. The RNS chooses one of the listed
algorithms and reports this back to the 3G_MSC in Relocation Request
Acknowledge or Security Mode Complete respectively. The MSC-B provides the
Selected UMTS algorithm information to the MSC-A. The Selected UMTS algorithms
IE in the MAP Process Access Signalling Request message refers to the Chosen
Integrity Protection Algorithm and Chosen Encryption Algorithm, defined in
RANAP specification 3GPP TS 25.413 [7]
The selected algorithm shall be stored by 3G_MSC-B, and sent to 3G_MSC-A.
Transfer of Information:
If ciphering has not been performed before Inter-MSC Handover, this will be
controlled by 3G_MSC-A after the completion of Inter-MSC Handover and possibly
after intra-MSC-B handover from GSM to UMTS. In both cases Selected UMTS
algorithm information is received by 3G_MSC-A from 3G_MSC-B in:
  * The Process Access Signalling Request MAP message.
#### 4.5.5.9 Allowed UMTS Algorithms
In case of GSM-subscriber, the Integrity Protection Information and UMTS
Encryption Information are not transferred to the MSC-B during inter-MSC
handover. Allowed UMTS algorithms is UMTS information that is required in
RANAP Relocation Request and RANAP Security Mode Command, and shall be
provided by 3G_MSC-A. 3G_MSC-B needs this information in case of an intra-MSC
GSM to UMTS handover and in subsequent security mode setting, after an inter-
MSC handover. Therefore 3G_MSC-A must provide this information in case of an
inter-MSC GSM to GSM handover. The Allowed UMTS algorithms IE in the MAP
Prepare Handover and in the MAP Forward Access Signalling Request messages
refers to the Permitted Integrity Protection Algorithms in Integrity
Protection Information and Permitted Encryption Algorithms in Encryption
Information, defined in RANAP specification 3GPP TS 25.413 [7].
Allowed UMTS algorithms shall be stored by 3G_MSC-B.
Transfer of information:
If ciphering has not been performed before Inter-MSC Handover, this will be
controlled by 3G_MSC-A after the completion of Inter-MSC Handover.
Ciphering control towards 3G_MSC-B:
If Ciphering has been performed before Inter-MSC Handover:
  * The Prepare Handover Request MAP message.
If Ciphering has NOT been performed before Inter-MSC Handover:
  * The Forward Access Signalling Request MAP message.
#### 4.5.5.10 BSSMAP Service Handover
This information shall be stored by 3G_MSC-B and sent to a BSS in Handover
Request, when 3G_MSC-B performs handover to GSM.
Transfer of information:
The BSSMAP Service Handover information is transferred to 3G_MSC-B in:
  * the Handover Request BSSMAP message.
If a new assignment of a TCH after an inter-MSC handover is to be performed,
the BSSMAP Service Handover information is transferred to 3G_MSC-B in:
  * the BSSMAP Assignment procedure.
#### 4.5.5.11 RANAP Service Handover
This information shall be stored by 3G_MSC-B and sent to an RNS in Relocation
Request, when 3G_MSC-B performs relocation or handover to UMTS.
Transfer of information:
The RANAP Service Handover information is transferred to 3G_MSC-B in:
  * the Prepare Handover Request MAP message.
If a new assignment of a Radio Access Bearer after an inter-MSC handover is to
be performed, the information is transferred to 3G_MSC-B in:
  * the Forward Access Signalling Request MAP message
> and sent by 3G_MSC-B to the RNS in RAB Assignment Request.
#### 4.5.5.12 SNA Access Information
This information shall be stored by 3G_MSC-B and sent to an RNS in the
Relocation Request message when 3G_MSC-B performs handover to UMTS.
Transfer of information:
The SNA Access Information is transferred to 3G_MSC-B in:
  * the Handover Request BSSMAP message.
#### 4.5.5.13 UESBI
This information shall be stored by 3G_MSC-B and sent to an RNS in Relocation
Request, when 3G_MSC-B performs relocation or handover to UMTS.
Transfer of information:
The UESBI information is transferred to 3G_MSC-B in:
  * the Prepare Handover Request MAP message.
#### 4.5.5.14 Alternative Channel Type
This information shall be stored by 3G_MSC-B and from this information
3G_MSC-B shall generate Alternative RAB Parameters Value IE sent to an RNS in
Relocation Request, when 3G_MSC-B performs relocation or handover to UMTS.
Transfer of information:
The Alternative Channel Type information is transferred to 3G_MSC-B in:
> \- the Prepare Handover Request MAP message.
If a new assignment of a Radio Access Bearer after an inter-MSC handover is to
be performed, the information is transferred to 3G_MSC-B in:
> \- the Forward Access Signalling Request MAP message.
#### 4.5.5.15 Trace parameters
This information shall be stored by 3G_MSC-B and 3G_MSC-B shall use this
information for trace activation for MSC-S, MGW, RNC or BSC.
Transfer of information:
The Trace Parameter List information for MSC-S, MGW and RNC tracing is
transferred to 3G_MSC-B in:
> \- the Prepare Handover Request MAP message.
The Trace Reference and Trace Type information for BSC tracing is transferred
to 3G_MSC-B in:
> \- the MSC Invoke Trace BSSMAP message.
### 4.5.6 Overview of the Technical Specifications GSM interworking for the
Inter-MSC Handover
╔══════════════════════════════════════════════════════════════════════════════════════════════════╗
║ **[PSTN/ISDN]{.underline}** ║
║ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ ║
║ ▒ +---------------+ ▒ ║
║ ==============▒====== \| ============= \| =============== ▒ ║
║ **[PLMN]{.underline}** ▒ \| \| ▒ ║
║ ▒ V V ▒ ║
║ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ ▒ ║
║ ▒ **BSS-A** **MSC-A** **MSC-B** **BSS-B** ▒ **MS** ║
║ ▒ ▒ ║
║ ▒ +-------+ ▒ +-------+ ║
║ ▒ \| C M \| 24.008 (Note) ▒ \| C M \| ║
║ ▒ +-------\|\+-------\| ║
║ ▒ ░░░░░░░░░░░░░░░ \| M M \| ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▒ \| M M \| ║
║ ▒ ░+------+48.008 +-------\|48.008+-------+ 48.008 +-------+ ░▒ +-------\| ║
║ ▒ ░\| R R \|\\| R R \|\\| R R \|\\| R R \| ░▒ \| R R
\| ║
║ ▒ ░+------+ +-------+ (Note)+-------+ +-------+ ░▒ +-------+ ║
║ ▒ ░ Λ Λ Λ Λ ░▒ ║
║ ▒ ░ \| \| 29.010 \| \| ░▒ Note: Subset of 48.008 ║
║ ▒ ░ \| V V \| ░▒ procedures as described ║
║ ▒ ░ \|+-----+ 29.002+-----+\| ░▒ in the TS 3GPP TS 48.008. ║
║ ▒ ░ \|\|MAP/E\|\\|MAP/E\|\| ░▒ ║
║ ▒ ░ \|+-----+ +-----+\| 23.009░▒ ║
║ ▒ ░░░░░░░░░░░░░░░░ \| ░░░░░░░░░░░░░░░░░░░ \| ░░░░░░░░░░░░░░░░░░░▒ Remark:
The A-bis interface and ║
║ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ V ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ V ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ the link
layer ║
║ +-----------------------+ protocols being out of ║
║ \| T C A P \| the scope of this ║
║ +-----------------------+ Specification are not ║
║ +------------------------------------------------------+ shown here. ║
║ \| S C C P \| ║
║ +------------------------------------------------------+ ║
║ +------------------------------------------------------+ ║
║ \| M T P \| ║
║ +------------------------------------------------------+ ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════╝
## 4.6 Inter-MSC Handover (UMTS to GSM)
The general principles of the handover procedures are given in 3GPP TS 23.009
[2]. 3GPP TS 29.010 gives the necessary information for interworking between
the 3GPP TS 25.413 [7] RANAP protocol, GSM handover procedures and the 3GPP TS
29.002 [9] MAP protocol. The RANAP protocol is used between the RNS and the
3G-MSC.
The following three principles apply for the Inter-MSC handover UMTS to GSM:
The BSSMAP parameters required for Inter-MSC handover UMTS to GSM are
generated as in GSM.
Received BSSMAP parameters, e.g. cause code or Handover command, are mapped to
the appropriate RANAP parameters, e.g. cause code transparent container to
source RNS.
When new parameters need to be added for transfer on the E-interface, the
principles stated in the beginning of subclause 4.5 shall be followed.
### 4.6.1 Basic Inter-MSC Handover
When a Mobile Station is handed over between two MSCs, the establishment of a
connection between them (described in 3GPP TS 23.009 [2]) requires
interworking between A-Interface and E-Interface.
The signalling at initiation, execution, completion of the Basic Inter-MSC
handover procedure is shown in figures 21 to 26 with both possible positive or
negative outcomes.
Additionally figure 21b shows the possible interworking when the trace related
message is transparently transferred on the E-Interface at Basic Inter-MSC
Handover initiation.
RNS-A 3G-MSC-A MSC-B
\| \| \|
\|RELOCATION \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request \| \|Possible Alloc. \|
\| \| \| \|of a handover \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|------------------>\|
Figure 21a: Signalling for Basic Inter-MSC Handover initiation (no trace
related messages transferred)
RNS-A 3G-MSC-A MSC-B
\| (*) \|
\|RELOCATION \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request(**) \| \|Possible Alloc. \|
\| \| \| \|of a handover \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \|MSC INVOKE TRACE \|
\| \| \|--------------->(***)
Figure 21b: Signalling for Basic Inter-MSC Handover initiation (MSC invoke
trace message transferred)
(*): Tracing invocation has been received from VLR.
(**): In that case, HANDOVER REQUEST and MSC INVOKE TRACE messages are
included within the AN-APDU parameter.
(***): MSC INVOKE TRACE is forwarded to BSS-B if supported by MSC-B.
Possible Positive outcomes:
a) successful radio resources allocation and handover number allocation (if
performed):
RNS-A 3G-MSC-A MSC-B BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|\\| \| \|
\|CANCEL \| \| \|
\| \|MAP U -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|CLEAR COMMAND \|
\| \| \|------------------>\|
\|RELOCATION \| \| \|
\|\\| \|
\| \| response \|CLEAR COMMAND \|
\| \| \|------------------>\|
\| \| \| (Note 2) \|
Figure 25: Signalling for Basic Inter-MSC Handover completion (Positive
outcome)
Negative outcome:
RNS-A 3G-MSC-A MSC-B BSS-B
\| \| \| \|
\| \| MAP U/P -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|CLEAR COMMAND \|
\| \| \|------------------>\|
\| \| \| \|
Figure 26: Signalling for Basic Inter-MSC Handover completion (Negative
outcome)
NOTE 2: From interworking between MAP and BSSMAP point of view, when the call
is released.
The handover procedure is normally triggered by RNS-A by sending a RELOCATION
REQUIRED message on Iu-Interface to 3G-MSC-A. The invocation of the Basic
Inter-MSC handover procedure is performed and controlled by 3G-MSC-A. The
sending of the MAP Prepare-Handover request to MSC-B is triggered in 3G-MSC-A
upon receipt of the RELOCATION REQUIRED message. For compatibility reason, the
cell identity of the cell where the call is to be handed over in MSC-B area,
provided in the RELOCATION REQUIRED message, is mapped into targetCellId MAP
parameter and the HANDOVER REQUEST message is encapsulated in the AN-APDU MAP
parameter of the Prepare‑Handover MAP request. MSC-B can invoke another
operation towards the VLR-B (allocation of the handover number described in
3GPP TS 29.002 [9]).
Additionally, if tracing activity has been invoked, the trace related message
can be transferred on the E-Interface encapsulated in the AN-APDU MAP
parameter of the Prepare-Handover Request. If transferred, one complete trace
related message at a time shall be included in the AN-APDU MAP parameter after
the HANDOVER REQUEST message.
The interworking between Prepare Handover and RELOCATION REQUIRED is as
follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION REQUIRED MAP PREPARE HANDOVER request\|
message \| \|
\| -ho-NumberNotRequired\| 1
\| RANAP information -targetCellId \|
\| elements -AN-APDU( \| 2
\| HANDOVER REQUEST, \|
\| \|
\| MSC INVOKE TRACE) \|
\--------┼-------------------------------------------------┼-----
Positive\| RELOCATION CMD MAP PREPARE HANDOVER response\|
result \| \| 3
\| -handover number \|
\| -AN-APDU( \|
\| QUEUING INDICATION \|
\| or HANDOVER REQUEST\|
\| ACKNOWLEDGE) \|
\| \|
\--------┼-------------------------------------------------┼-----
Negative\| RELOCATION PREP FAILURE MAP PREPARE HANDOVER\| 4
result \| \|
\| Relocation failure in System Failure \|
\| target RNC/CN or target system \|
\|\" No Handover Number \|
\| available \|
\|\" UnexpectedDataValue\|
\|\" Data Missing \|
\| \|
\|\" MAP CLOSE \|
\|\" MAP U/P -ABORT \|
\| \|
NOTE 1: The BSSMAP information elements are already stored in 3G-MSC.
> The ho-NumberNotRequired parameter is included by 3G-MSC-A, when 3G-MSC-A
> decides not to use any circuit connection with MSC-B. No handover number
> shall be present in the positive result. Any negative response from MSC-B
> shall not be due to handover number allocation problem.
NOTE 2: The process performed on the RANAP information elements received in
the RELOCATION REQUIRED message is described in the 3GPP TS 25.413 [7].
NOTE 3: The response to the Prepare-Handover request can include in its AN-
APDU parameter, identifying the 3GPP TS 48.006 protocol, either a BSSMAP
QUEUING INDICATION, or a BSSMAP HANDOVER REQUEST ACKNOWLEDGE.
In the first case, 3G-MSC-A shall wait for the radio resources allocation
response from MSC-B, transmitted to 3G-MSC-A as described in subclause 4.5.4.
In the second case, the positive result triggers in 3G-MSC-A the sending on
Iu-Interface of the RELOCATION CMD.
In the third case, the positive result triggers in 3G-MSC-A.
NOTE 4: The possible sending of the RELOCATION PREP FAILURE message is
described in the 3G 25.413.
> (The possible sending of the RELOCATION PREP FAILURE message upon receipt of
> the HANDOVER FAILURE is out of the scope of the 3GPP TS 29.010 and lies in
> the 3GPP TS 25.413 [7]).
The interworking between Send End Signal and HANDOVER COMPLETE in MSC-B is as
follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| HANDOVER COMPLETE MAP SEND END SIGNAL request \|
message \| \|
\| -AN-APDU( \|
\| HANDOVER COMPLETE)\|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| CLEAR COMMAND MAP SEND END SIGNAL response\|
result \| -Call Control release \| 1
\--------┼-------------------------------------------------┼-----
Negative\| CLEAR COMMAND \|
result \| -Call Control release MAP CLOSE \| 2
\| -Call Control release MAP U/P -ABORT \|
\| \|
NOTE 1: The positive empty result triggers the clearing of the Radio Resources
on the A-Interface and the release of the SCCP connection between MSC-B and
BSS-B. If a circuit connection is used between 3G_MSC-A and MSC-B, the \'Call
Control release\' clearing cause shall only be given to BSS-B when MSC-B has
received a clearing indication on its circuit connection with 3G_MSC-A.
NOTE 2: The abortion of the dialogue or the rejection of the component
triggers in MSC-B the clearing of its circuit connection with 3G_MSC-A, if
any, of the Radio Resources on the A-Interface and the release of the SCCP
connection between MSC-B and BSS-B.
The interworking between Send End Signal and IU RELEASE COMMAND in 3G_MSC-A is
as follows:
\----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| MAP SEND END SIGNAL IU RELEASE COMMAND \|
message \| response \|
\| -AN-APDU(HANDOVER COMPLETE) \|
\| Successful Relocation \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
The interworking between RELOCATION CANCEL in case of reversion to old channel
of the UE and User Abort in 3G-MSC-A is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION CANCEL MAP U -ABORT \|
message \| \|
\| -Relocation cancelled \|
\--------┼-------------------------------------------------┼-----
Positive\| RELOCATION CANCEL ACKNOWLEDGEMENT \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
### 4.6.2 Subsequent Inter-MSC Handover from 3G-MSC-B back to MSC-A
When a Mobile Station is being handed over back to MSC-A, the procedure
(described in TS 23.009) requires interworking between A-Interface, Iu-
interface and E-Interface.
The signalling at initiation, execution and completion of the Subsequent
Inter-MSC handover procedure is shown in figures 27 to 31.
RNS-A 3G-MSC-B MSC-A
\| \| \|
\|RELOCATION \| \|
\|-------------->\|MAP PREPARE SUBSEQUENT \|
\|REQUIRED \|------------------------>\|
\| \|HANDOVER request \|
\| \| \| BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|------------------>\|
Figure 27: Signalling for Subsequent Inter-MSC Handover back to MSC-A
initiation
Possible Positive outcomes:
a) successful radio resources allocation:
RNS-A 3G-MSC-B MSC-A BSS-B
\| \| \| \|
\| \| \|HANDOVER REQUEST \|
\| \| \|\\|MAP SEND END SIGNAL \| \|
\|COMPLETE \|------------------------>\| \|
\| \| response \| \|
\| \| \|Iu RELEASE COMMAND \|
\| \| \|------------------>\|
Figure 30: Signalling for Subsequent Inter-MSC Handover back to MSC-A
completion\ (Successful completion of the procedure)
NOTE: Positive outcome case shown in figure 9.
BSS-B MSC-A 3G-MSC-B RNS-A
\| \| \| \|
\|HANDOVER \| \| \|
\|-------------->\|MAP SEND END SIGNAL \| \|
\|COMPLETE \|------------------------>\| \|
\| \| response \| \|
\| \| \| \|
\| \|MAP U/P -ABORT \| \|
\| \|\\|
\| \| \|(Note 1) \|
Figure 31: Signalling for Subsequent Inter-MSC Handover back to MSC-A
completion (Unsuccessful completion of the procedure)
NOTE 1: Abnormal end of the procedure which triggers the clearing of all
resources in 3G-MSC-B.
The interworking between Prepare Subsequent Handover and RELOCATION REQUIRED
is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \|REL. REQUIRED MAP PREPARE SUBSEQUENT HANDOVER\|
message \| request \|
\| \|
\| -target MSC number \|
\| -targetCellId \|
\| -AN-APDU( \|
\| HANDOVER REQUEST) \|
\| \|
\| \|
\| RANAP information BSSMAP information \|
\| elements: elements: \|
\| \|
\| MS Classmark 2 CM2 \|
\| Source Id Cell Id (serving) \|
\| Target Id Cell Id (target) \|
\| Cause Cause \|1
\| MS Classmark 3 CM3 \|
\| \|
\| info stored/generated \|
\| in/by 3G-MSC-B: \|
\| Message Type \|
\| Channel Type \|
\| Speech version \|
\| Priority \|
\| Interference Band \|
\| to be used \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\|RELOCATION CMD. MAP PREPARE SUBSEQUENT HANDOVER\|
result \| response \| 2
\| -AN-APDU( \|
\| QUEUING INDICATION \|
\| or HANDOVER REQUEST\|
\| ACKNOWLEDGE or \|
\| HANDOVER FAILURE) \|
\| \|
\| RANAP information BSSMAP information \|
\| elements: elements: \|
\| L3 information L3 information \|
\| \|
\| \|
\| \|
\--------┼-------------------------------------------------┼-----
Negative\| REL. PREP. FAILURE MAP PREPARE SUBSEQUENT\| 3
result \| HANDOVER response \|
\| Relocation Failure in Target CN/RNC or Target System Unknown MSC \|
\| Relocation Failure in Target CN/RNC or Target System Subsequent Handover \|
\| Failure \|
\| Relocation Failure in Target CN/RNC or Target System
\| \|
UnexpectedDataValue \|
\| Relocation Failure in Target CN/RNC or Target System Data Missing \|
\| \|
\| Iu RELEASE COMMAND \|
\| \|
\| Relocation Cancelled MAP CLOSE \|
\| Relocation Cancelled MAP U/P -ABORT \|
\| \|
NOTE 1: The mapping of cause code values between BSSMAP and RANAP is FFS.
NOTE 2: The response to the Prepare-Subsequent-Handover request can include in
its AN-APDU parameter, identifying the 3GPP TS 48.006 protocol, a BSSMAP
QUEUING INDICATION, or a BSSMAP HANDOVER REQUEST ACKNOWLEDGE or a BSSMAP
HANDOVER FAILURE.
In the first case, 3G-MSC-B shall wait for the radio resources allocation
response from MSC-A, transmitted to 3G-MSC-B as described in subclause 4.5.4.
In the second case, the positive result triggers in 3GMSC-B the sending on
Iu‑Interface of the RELOCATION COMMAND.
In the third case, the positive result triggers in 3G-MSC-B the sending of the
RELOCATION PREPARATION FAILURE.
NOTE 3: The possible sending of the RELOCATION PREPARATION FAILURE message is
described in 3GPP TS 25.413 [7].
The interworking between Send End Signal Result and HANDOVER COMPLETE in MSC-A
is as follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| HANDOVER COMPLETE MAP SEND END SIGNAL \|
message \| response \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| MAP U/P -ABORT \| 1
\| \|
NOTE: The abortion of the dialogue ends the handover procedure with 3G-MSC-B.
### 4.6.3 Subsequent Inter-MSC Handover to third MSC
When a Mobile Station is being handed over to a third MSC, the procedure
(described in 3GPP TS 23.009 [2]) does require one specific interworking case
in MSC-A between E-Interface from 3G-MSC-B and E-Interface from MSC-B\' other
than the combination of the ones described in subclauses 4.6.1 and 4.6.2.
RNS-A 3G-MSC-B MSC-A MSC-B\'
\| \| \| \|
\|RELOCATION \| \| \|
\|----------->\|MAP PREPARE SUBSEQUENT\| \|
\|REQUIRED \|--------------------->\| \|
\| \|HANDOVER request \|MAP PREPARE \|
\| \| \|--------------->\|
\| \| \|HANDOVER request\|
\| \| \| \|+-------+
\| \| \| \|\|Possib.\|
\| \| \| \|\|Alloc. \|
\| \| \| \|\|of ho. \|
\| \| \| \|\|number \|
\| \| \| \|\| VLR-B \|
\| \| \| \|+-------+
\| \| \| \| BSS-B\'
\| \| \| \| \|
\| \| \| \|HANDOVER \|
\| \| \| \|-------->\|
\| \| \| \|REQUEST \|
\| \| \| \|
Figure 32: Signalling for Subsequent Inter-MSC Handover to third MSC (MSC-B\')
initiation
Possible Positive outcomes:
a) successful radio resources allocation:
RNS-A 3G-MSC-B MSC-A MSC-B\'
\| \| \| \|
\| \| \| \| BSS-B\'
\| \| \| \| \|
\| \| \| \|HANDOVER \|
\| \| \| \|\\| \| \| \|
\|CANCEL \|MAP PROCESS ACCESS \| \| \|
\| \|--------------------->\| \| \|
\| \|SIGNALLING request (Note 1) \| \|
\| \| \| \| \|
\| \| \|MAP U -ABORT \| \|
\| \| \|--------------->\| \|
\| \| \| \|CLEAR \|
\| \| \| \|-------->\|
\| \| \| \|COMMAND \|
\|RELOCATION \| \| \| \|
\|\\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request \| \|Possible Alloc. \|
\| \| \| \|of a handover \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|------------------>\|
Figure 37a: Signalling for Basic Inter-MSC Handover initiation (no trace
related messages transferred)
BSS-A MSC-A 3G-MSC-B
\| (*) \|
\|HANDOVER \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request (**) \| \|Possible Alloc. \|
\| \| \| \|of a handover \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \|CN INVOKE TRACE \|
\| \| \|--------------->(***)
Figure 37b: Signalling for Basic Inter-MSC Handover initiation (CN invoke
trace message transferred)
(*): Tracing invocation has been received from VLR.
(**): In that case, HANDOVER REQUEST and MSC INVOKE TRACE messages are
included within the AN-apdu parameter.
(***): CN INVOKE TRACE is forwarded to RNS-B if supported by 3G_MSC-B.
Possible Positive outcomes: successful radio resources allocation and handover
number allocation (if performed):
BSS-A MSC-A 3G-MSC-B RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|\\|
\| \| \|CONTROL \|
\| \| MAP PREPARE HANDOVER \| \|
\| \|\\| \| \|
\|FAILURE \| \| \|
\| \|MAP U -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|IU RELEASE COMMAND \|
\| \| \|------------------>\|
Figure 39: Signalling for Basic Inter-MSC Handover execution (Negative
outcomes)
NOTE 1: Possible rejection of the handover because of the negative outcome of
MAP or RANAP procedure.
BSS-A MSC-A 3G-MSC-B RNS-B
\| \| \| \|
\| \| \|RELOCATION COMPLETE\|
\| \| \|\\| \|
\| \| response \|IU RELEASE COMMAND \|
\| \| \|------------------>\|
\| \| \| (Note 2) \|
Figure 41: Signalling for Basic Inter-MSC Handover completion (Positive
outcome)
Negative outcome:
BSS-A MSC-A 3G-MSC-B RNS-B
\| \| \| \|
\| \| MAP U/P -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|IU RELEASE COMMAND \|
\| \| \|------------------>\|
\| \| \| \|
Figure 42: Signalling for Basic Inter-MSC Handover completion (Negative
outcome)
NOTE 2: From interworking between MAP and RANAP point of view, when the call
is released.
BSS-A MSC-A 3G-MSC-B RNS-B
\| \| \| \|
\| \| \|LOCATION REPORT \|
\| \| \|\\|MAP PREPARE SUBSEQUENT \|
\|REQUIRED \|------------------------>\|
\| \|HANDOVER request \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|------------------>\|
Figure 43: Signalling for Subsequent Inter-MSC Handover back to 3G_MSC-A
initiation
Possible Positive outcomes: successful radio resources allocation:
BSS-A MSC-B 3G-MSC-A RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|\\| \| \|
\|FAILURE \|MAP PROCESS ACCESS \| \|
\| \|------------------------>\| \|
\| \| SIGNALLING request \|IU RELEASE COMMAND \|
\| \| \|------------------>\|
\| \| \| \|
Figure 45: Signalling for Subsequent Inter-MSC Handover back to 3G_MSC-A
execution\ (Negative outcome)
NOTE 1: Possible rejection of the handover because of the negative outcome of
MAP or BSSMAP procedure.
RNS-B 3G-MSC-A MSC-B BSS-A
\| \| \| \|
\|RELOCATION \| \| \|
\|-------------->\|MAP SEND END SIGNAL \| \|
\|COMPLETE \|------------------------>\| \|
\| \| response \| \|
\| \| \|CLEAR COMMAND \|
\| \| \|------------------>\|
Figure 46: Signalling for Subsequent Inter-MSC Handover back to 3G_MSC-A
completion\ (Successful completion of the procedure)
NOTE: Positive outcome case shown in figure 41.
RNS-B 3G-MSC-A MSC-B BSS-A
\| \| \| \|
\| \|MAP U/P -ABORT \| \|
\| \|\\|
\| \| \|(Note 1) \|
Figure 47: Signalling for Subsequent Inter-MSC Handover back to 3G_MSC-A
completion (Unsuccessful completion of the procedure)
NOTE 1: Abnormal end of the procedure that triggers the clearing of all
resources in MSC-B.
The interworking between Prepare Subsequent Handover and HANDOVER REQUIRED is
as follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \|HANDOVER REQUIRED MAP PREPARE SUBSEQUENT HANDOVER\|
message \| request \| 1
\| \|
\| -target MSC number \|
\| BSSMAP information -target RNC Id \|
\| elements -an-APDU( \|
\| HANDOVER REQUEST) \|
\| GERAN classmark -GERAN classmark \| 4
\--------┼-------------------------------------------------┼-----
Positive\|HANDOVER REQUIRED MAP PREPARE SUBSEQUENT HANDOVER\|
result \| response \| 2
\| -an-APDU( \|
\| HANDOVER REQUEST \|
\| ACKNOWLEDGE or \|
\| HANDOVER FAILURE) \|
\--------┼-------------------------------------------------┼-----
Negative\| HANDOVER REQUIRED REJECT MAP PREPARE SUBSEQUENT\| 3
result \| HANDOVER response \|
\| equipment failure Unknown MSC \|
\| equipment failure Subsequent Handover\|
\| Failure \|
\| equipment failure UnexpectedDataValue\|
\| equipment failure Data Missing \|
\| \|
\| CLEAR COMMAND \|
\| \|
\| equipment failure MAP CLOSE \|
\| equipment failure MAP U/P -ABORT \|
\| \|
NOTE 1: The processing performed on the BSSMAP information elements received
in the HANDOVER REQUIRED message is out of the scope of the present document.
The target MSC number is provided to 3G_MSC-A by MSC-B based on the
information received from RNS-B.
NOTE 2: The response to the Prepare-Subsequent-Handover request can include in
its an-APDU parameter, identifying the 3GPP TS 48.006 protocol, either a
BSSMAP HANDOVER REQUEST ACKNOWLEDGE or a BSSMAP HANDOVER FAILURE.
In the first case, the positive result triggers in MSC-B the sending on
A‑Interface of the HANDOVER COMMAND.
In the second case, the positive result triggers in MSC-B optionally the
sending of the HANDOVER REQUIRED REJECT.
(The possible sending of the HANDOVER REQUIRED REJECT message upon receipt of
the HANDOVER FAILURE is out of the scope of 3GPP TS 29.010 and lies in 3GPP TS
48.008 [12]).
NOTE 3: The possible sending of the HANDOVER REQUIRED REJECT message is
described in 3GPP TS 48.008 [12].
NOTE 4: If the GERAN Classmark was not received with the HANDOVER REQUIRED
message initiating the handover, MSC-B shall include any previously received
GERAN Classmark. See 3GPP TS 43.051 [17].
The interworking between Prepare Subsequent Handover and RELOCATION REQUEST in
3G_MSC-A is as follows:
\----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| MAP PREPARE SUB HANDOVER RELOCATION REQUEST \|
message \| request \|
\| -ho-NumberNotRequired \|
\| -target RNC ID \|
\| -an-APDU( \|
\| HANDOVER REQUEST, \|
\| MSC INVOKE TRACE) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| Cause Cause \|
\| sRNC to tRNC container sRNC to tRNC container\|
\| \|
\| info stored/generated \|
\| in/by 3G_MSC-A: \|
\| CN domain indicator \|
\| RAB parameters \|
\| Permanent NAS UE id \|
\| Encryption info \|
\| Integrity protection \|
\| info \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| MAP PREPARE SUB HANDOVER RELOCATION REQUEST ACK\|
result \| response \|
\| -an-APDU( \|
\| HANDOVER REQUEST ACK) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| Layer 3 info tRNC to sRNC container\|
\| \|
\--------┼-------------------------------------------------┼-----
Negative\| MAP SUB PREPARE HANDOVER RELOCATION FAILURE \|
result \| response \|
\| -an-APDU( \|
\| HANDOVER FAILURE) \|
\| \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| GERAN classmark GERAN classmark \| 1
\| \|
NOTE 1: If a handover to GERAN Iu-mode failed, the target RNS may include a
GERAN classmark in the RELOCATION FAILURE message. See 3GPP TS 43.051 [17].
The interworking between HANDOVER FAILURE and MAP Process Signalling Request
in 3G_MSC-B is as follows:
\----------------------------------------------------------------
\| 48.008 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| HANDOVER FAILURE MAP PROCESS-SIGNALLING \|
message \| request \|
\| -an-APDU( \|
\| HANDOVER FAILURE) \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
\| \|
The interworking between Send End Signal Response and RELOCATION COMPLETE in
3G_MSC-A is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION COMPLETE MAP SEND END SIGNAL \|
message \| response \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| MAP U/P -ABORT \| 1
\| \|
NOTE 1: The abortion of the dialogue ends the handover procedure with MSC-B.
### 4.7.3 Subsequent Inter-MSC Handover to third MSC
When a Mobile Station is being handed over to a third MSC, the procedure
(described in 3GPP TS 23.009 [2]) does require one specific interworking case
in MSC-A (figure 49) between E-Interface from MSC-B and E-Interface from
3G_MSC‑B\' other than the combination of the ones described in the subclause
4.5.1 and 4.7.2.
BSS-A MSC-B MSC-A 3G-MSC-B\'
\| \| \| \|
\|HANDOVER \| \| \|
\|----------->\|MAP PREPARE SUBSEQUENT\| \|
\|REQUIRED \|--------------------->\| \|
\| \|HANDOVER request \|MAP PREPARE \|
\| \| \|--------------->\|
\| \| \|HANDOVER request\|
\| \| \| \|+-------+
\| \| \| \|\|Possib.\|
\| \| \| \|\|Alloc. \|
\| \| \| \|\|of ho. \|
\| \| \| \|\|number \|
\| \| \| \|\| VLR-B \|
\| \| \| \|+-------+
\| \| \| \| RNS-B\'
\| \| \| \| \|
\| \| \| \|RELOCATION
\| \| \| \|-------->\|
\| \| \| \|REQUEST \|
\| \| \| \|
Figure 45: Signalling for Subsequent Inter-MSC Handover to third MSC
(3G_MSC-B\') initiation
Possible Positive outcomes: successful radio resources allocation:
BSS-A MSC-B MSC-A 3G-MSC-B\'
\| \| \| \|
\| \| \| \| RNS-B\'
\| \| \| \| \|
\| \| \| \|RELOCATION
\| \| \| \|\\|
\| \| \| \|REPORTING\|
\| \| \| \|CONTROL \|
\| \| \| \| \|
\| \| \|MAP PREPARE HANDOVER \|
\| \| \|\\| \| \| \|
\|FAILURE \|MAP PROCESS ACCESS \| \| \|
\| \|--------------------->\| \| \|
\| \|SIGNALLING request (Note 1) \| \|
\| \| \| \| \|
\| \| \|MAP U -ABORT \| \|
\| \| \|--------------->\| \|
\| \| \| \|IU RELEASE
\| \| \| \|-------->\|
\| \| \| \|COMMAND \|
\| \| \| \| \|
Figure 49: Signalling for Subsequent Inter-MSC Handover to third MSC
(3G_MSC-B\') completion (Unsuccessful completion of the procedure)
NOTE: Specific interworking case detailed below.
BSS-A MSC-A 3G-MSC-B\' RNS-B\'
\| \| \| \|
\| \| \|LOCATION REPORT \|
\| \| \|\ If Ciphering has been performed before Inter-MSC Handover, Selected UMTS
> algorithm information is received by 3G_MSC-A from 3G_MSC-B in:
  * The Prepare Handover Response MAP message.
> If Ciphering has NOT been performed before Inter-MSC Handover, Selected UMTS
> algorithm information is received by 3G_MSC-A from 3G_MSC-B in:
  * The Process Access Signalling Request MAP message.
#### 4.7.5.7 Allowed UMTS Algorithms
In case of GSM-subscriber, the Integrity Protection Information and UMTS
Encryption Information are not transferred to the MSC-B during inter-MSC
handover from GSM to UMTS. Allowed UMTS algorithms is UMTS information that is
required in RANAP Relocation Request and RANAP Security Mode Command, and
shall be provided by 3G_MSC-A. 3G_MSC-B needs this information in case of an
inter-MSC GSM to UMTS handover and in subsequent security mode setting, after
an inter-MSC GSM to UMTS handover. Therefore 3G_MSC-A must provide this
information in case of an inter-MSC GSM to UMTS handover. The Allowed UMTS
algorithms IE in the MAP Prepare Handover and in the MAP Forward Access
Signalling Request messages refers to the Permitted Integrity Protection
Algorithms in Integrity Protection Information and Permitted Encryption
Algorithms in Encryption Information, defined in RANAP specification 3GPP TS
25.413 [7].
Allowed UMTS algorithms shall be stored by 3G_MSC-B.
Transfer of information:
If ciphering has not been performed before Inter-MSC Handover, this will be
controlled by 3G_MSC-A after the completion of Inter-MSC Handover.
Ciphering control towards 3G_MSC-B:
If Ciphering has been performed before Inter-MSC Handover:
  * The Prepare Handover Request MAP message.
If Ciphering has NOT been performed before Inter-MSC Handover:
  * The Forward Access Signalling Request MAP message.
#### 4.7.5.8 BSSMAP Service Handover
This information shall be stored by 3G_MSC-B and sent to a BSS in Handover
Request, when 3G_MSC-B performs handover to GSM.
Transfer of information:
The BSSMAP Service Handover information is transferred to 3G_MSC-B in:
  * the Handover Request BSSMAP message.
If a new assignment of a TCH after an inter-MSC handover is to be performed,
the BSSMAP Service Handover information is transferred to 3G_MSC-B in:
  * the BSSMAP Assignment procedure.
#### 4.7.5.9 RANAP Service Handover
This information shall be stored by 3G_MSC-B and sent to an RNS in Relocation
Request during the basic inter-MSC handover or when 3G_MSC-B performs a
subsequent relocation or handover to UMTS.
Transfer of information:
The RANAP Service Handover information is transferred to 3G_MSC-B in:
  * the Prepare Handover Request MAP message.
If a new assignment of a Radio Access Bearer after an inter-MSC handover is to
be performed, the information is transferred to 3G_MSC-B in:
  * the Forward Access Signalling Request MAP message
> and sent by 3G_MSC-B to the RNS in RAB Assignment Request.
#### 4.7.5.10 GERAN Classmark
The GERAN Classmark shall be stored by 3G_MSC-B and can be received from
MSC-A, from the serving BSS or serving RNS, or from the target RNS. The GERAN
Classmark shall be used together with other parameters, e.g. the Channel Type,
for selecting a service and for generating RAB parameters for handover to
GERAN Iu-mode, subsequent relocation or handover to GERAN Iu-mode, and RAB
(re-)assignment when the MS is in GERAN Iu-mode.
Transfer of Information due to GERAN Classmark received from MSC-A:
Received by 3G_MSC-B in:
\- the Prepare Handover Request MAP message.
Transfer of Information due to GERAN Classmark received from the serving BSS
or serving RNS:
Received by 3G_MSC-B in:
  * the Handover Required BSSMAP message;
  * the Relocation Required RANAP message;
  * the Initial UE RANAP message; or
  * the RAB Assignment Response RANAP message.
Transfer of Information due to GERAN Classmark received from the target RNS:
Received by 3G_MSC-B in:
  * the Relocation Failure RANAP message.
#### 4.7.5.11 SNA Access Information
This information shall be stored by 3G_MSC-B and sent to an RNS in the
Relocation Request message when 3G_MSC-B performs handover to UMTS.
Transfer of information:
The SNA Access Information is transferred to 3G_MSC-B in:
  * the Handover Request BSSMAP message.
#### 4.7.5.12 UESBI
This information shall be stored by 3G_MSC-B and sent to an RNS in Relocation
Request during the basic inter-MSC handover or when 3G_MSC-B performs a
subsequent relocation or handover to UMTS.
Transfer of information:
The UESBI information is transferred to 3G_MSC-B in:
  * the Prepare Handover Request MAP message.
#### 4.7.5.13 Alternative Channel Type
This information shall be stored by 3G_MSC-B and from this information
3G_MSC-B shall generate Alternative RAB Parameters Value IE sent to an RNS in
Relocation Request, when 3G_MSC-B performs relocation or handover to UMTS.
Transfer of information:
The Alternative Channel Type information is transferred to 3G_MSC-B in:
  * the Prepare Handover Request MAP message.
If a new assignment of a Radio Access Bearer after an inter-MSC handover is to
be performed, the information is transferred to 3G_MSC-B in:
  * the Forward Access Signalling Request MAP message.
#### 4.7.5.14 Trace parameters
This information shall be stored by 3G_MSC-B and 3G_MSC-B shall use this
information for trace activation for MSC-S, MGW, RNC or BSC.
Transfer of information:
The Trace Parameter List information for MSC-S, MGW and RNC tracing is
transferred to 3G_MSC-B in:
> \- the Prepare Handover Request MAP message.
The Trace Reference and Trace Type information for BSC tracing is transferred
to 3G_MSC-B in:
> \- the MSC Invoke Trace BSSMAP message.
### 4.7.6 Cause Code Mapping
When a Mobile Station is handed over between GSM and UMTS, a mapping of the
cause codes used in the BSSMAP and the RANAP protocols is needed. The mapping
described here is applicable to the BSSMAP protocol even when used inside MAP
in the E-interface.
The mapping between the cause codes received in BSSMAP Handover Required and
the cause codes sent in RANAP Relocation Request is as follows:
\----------------------------------------------------------------
48.008 25.413 \|Notes
\-------------------------------------------------------┼--------
HANDOVER REQUIRED RELOCATION REQUEST \|
\|
-Better Cell -Relocation Desirable \|
for Radio Reasons \|
\|
-Directed retry -Directed retry \|
-Distance -Time critical reloc. \|
-Downlink quality -Time critical reloc. \|
-Downlink strength -Time critical reloc. \|
-O and M intervention -O and M intervention \|
-Preemption -RAB pre-empted \|
-Response to MSC invocation -Network Optimisation \|
-Switch circuit pool \| 1
-Traffic -Resource Optimisation \|
Relocation \|
-Uplink quality -Time critical reloc. \|
-Uplink strength -Time critical reloc. \|
-Reduce Load in -Reduce Load in \|
serving cell serving cell \|
-Any other value -Relocation Desirable \|
For Radio Reasons \|
NOTE 1: Cause code not used at inter-system handover.
The mapping between the cause codes received in BSSMAP Handover Request and
the cause codes sent in RANAP Relocation Request is as follows (the mapping is
only used for the MAP-E interface):
\----------------------------------------------------------------
48.008 25.413 \|Notes
\-------------------------------------------------------┼--------
HANDOVER REQUEST RELOCATION REQUEST \|
\|
-Better Cell -Relocation Desirable \|
for Radio Reasons \|
\|
-Directed retry - Directed retry \|
-Distance -Time critical reloc. \|
-Downlink quality -Time critical reloc. \|
-Downlink strength -Time critical reloc. \|
-O and M intervention -O and M intervention \|
-Preemption -RAB pre-empted \|
-Response to MSC invocation -Network Optimisation \|
-Switch circuit pool \| 1
-Traffic -Resource Optimisation \|
Relocation \|
-Uplink quality -Time critical reloc. \|
-Uplink strength -Time critical reloc. \|
-Reduce Load in -Reduce Load in \|
serving cell serving cell \|
-Any other value -Relocation Desirable \|
For Radio Reasons \|
NOTE 1: Cause code not used at inter-system handover.
The mapping between the cause codes received in BSSMAP Handover Failure and
the cause codes sent in RANAP Iu Release Command is as follows:
\----------------------------------------------------------------
48.008 25.413 \|Notes
\-------------------------------------------------------┼--------
HANDOVER FAILURE IU RELEASE COMMAND \|
\|
-Ciphering algorithm not \| 2
supported \|
-Circuit pool mismatch \| 1
-Equipment failure -Relocation cancelled \|
-Invalid message contents -Abstract Syntax Error \|
-No radio resource available \| 2
-O and M intervention -O and M intervention \|
-Radio interface failure, -Relocation cancelled \|
reversion to old channel \|
-Radio interface message -Relocation cancelled \|
failure \|
-Requested speech version \| 2
unavailable \|
-Requested terrestrial \| 2
resource unavailable \|
-Requested transcoding/rate \| 2
adaption unavailable \|
-Switch circuit pool \| 1
-Terrestrial circuit already -Relocation cancelled \|
allocated \|
-Any other value -Relocation cancelled \|
NOTE 1: Cause code not used at inter-system handover.
NOTE 2: Cause code not applicable to this traffic case.
The mapping between the cause codes received in RANAP Relocation Failure and
the cause codes sent in BSSMAP Handover Failure is as follows (this mapping is
only used for the MAP-E interface):
\----------------------------------------------------------------
25.413 48.008 \|Notes
\-------------------------------------------------------┼--------
RELOCATION FAILURE HANDOVER FAILURE \|
\|
-GERAN Iu-mode failure -GERAN Iu-mode failure \|
-Traffic load in the target -Traffic load in the \|
cell higher than in the target cell higher \|
source cell than in the source \|
cell \|
-Any other value -No radio resource \|
available \|
The mapping between the cause codes received in RANAP Relocation Failure and
the cause codes sent in BSSMAP Handover Required Reject is as follows:
\----------------------------------------------------------------
25.413 48.008 \|Notes
\-------------------------------------------------------┼--------
RELOCATION FAILURE HANDOVER REQUIRED REJECT \|
\|
-GERAN Iu-mode failure -GERAN Iu-mode failure \|
-Incoming Relocation -Incoming Relocation \|
Not Supported Due To Not Supported Due To \|
PUESBINE Feature PUESBINE Feature \|
-Traffic load in the target -Traffic load in the \|
cell higher than in the target cell higher \|
source cell than in the source \|
cell \|
-Any other value -No radio resource \|
available \|
The mapping between the RANAP and the BSSMAP assignment messages is used in
the MAP-E interface. RANAP RAB Assignment Response with successful result is
mapped to BSSMAP Assignment Complete; RANAP RAB Assignment Response with
unsuccessful result is mapped to BSSMAP Assignment Failure. The mapping
between the cause codes received in RANAP RAB Assignment Response and the
cause codes sent in BSSMAP Assignment Failure is as follows (this mapping is
only used for the MAP-E interface):
\----------------------------------------------------------------
25.413 48.008 \|Notes
\-------------------------------------------------------┼--------
RAB ASSIGNMENT RESPONSE ASSIGNMENT FAILURE \|
\|
-Requested traffic class not --No radio resource \|
available available \|
-Invalid RAB parameters value --Invalid msg. contents \|
-Requested max bit rate not --No radio resource \|
available available \|
-Requested max bit rate for DL --No radio resource \|
not available available \|
-Requested max bit rate for UL --No radio resource \|
not available available \|
-Requested guaranteed bit rate --No radio resource \|
not available available \|
-Requested guaranteed bit rate --No radio resource \|
for DL not available available \|
-Requested guaranteed bit rate --No radio resource \|
for UL not available available \|
-Requested transfer delay not --No radio resource \|
achievable available \|
-Invalid RAB param. combination--Invalid msg. contents \|
-Condition violation for SDU --Invalid msg. contents \|
parameters \|
-Condition violation for --Invalid msg. contents \|
traffic handling priority \|
-Condition violation for --Invalid msg. contents \|
guaranteed bit rate \|
-User plane not supported --No radio resource \|
available \|
-Iu UP failure --Equipment failure \|
-Tqueuing expiry --Radio interface message\|
failure \|
-Invalid RAB id --Invalid msg. contents \|
-Request superseeded --No radio resource \|
available \|
-Relocation triggered -Relocation triggered \|
-GERAN Iu-mode failure -GERAN Iu-mode failure \|
-Any other value --Radio interface message\|
failure \|
The mapping between the cause codes received in RANAP Security Mode Reject and
the cause codes sent in BSSMAP Cipher Mode Reject is as follows (this mapping
is only used for the MAP-E interface):
\----------------------------------------------------------------
25.413 48.008 \|Notes
\-------------------------------------------------------┼--------
SECURITY MODE REJECT CIPHER MODE REJECT \|
\|
-Requested ciphering and/or --Ciphering algorithm \|
integrity protection not supported \|
algorithms not supported \|
-Failure in the radio --Radio interface message\|
interface procedure failure \|
-Change of ciphering and/or -Invalid msg. contents \|
integrity protection is \|
not supported \|
-Relocation triggered -Relocation triggered \|
-Any other value --Radio interface message\|
failure \|
The mapping between the cause codes received in RANAP Location Report and the
cause codes sent in BSSMAP Handover Performed is as follows (this mapping is
only used for the MAP-E interface):
\----------------------------------------------------------------
25.413 48.008 \|Notes
\-------------------------------------------------------┼--------
LOCATION REPORT HANDOVER PERFORMED \|
\|
-User restriction start ind. --O&M intervention \|
-User restriction start ind. --O&M intervention \|
-Requested report type not \| 1
supported \|
-Any other value -Better cell \|
NOTE 1: In this case, no Handover Performed is sent.
The mapping between the cause codes received in RANAP Iu Release Request and
the cause codes sent in BSSMAP Clear Request is as follows:
\----------------------------------------------------------------
25.413 48.008 \|Notes
\-------------------------------------------------------┼--------
IU RELEASE REQUEST CLEAR REQUEST \|
\|
-O and M intervention -O and M intervention \|
-Unspecified failure -Equipment failure \|
-Repeated integrity checking -Invalid message \|
failure contents \|
-Release due to UE generated -Call control \|
signalling connection release \|
-Radio connection with UE lost --Radio interface \|
failure \|
-Access restricted due -Access restricted due \|
to shared networks to shared networks \|
-Any other value -No radio resource \|
available \|
## 4.8 Inter-MSC Relocation
The general principles of the relocation procedures are given in Technical
Specification TS 23.009. TS 29.010 gives the necessary information for
interworking between the TS 25.413 relocation protocol and the TS 29.002 MAP
protocol.
For intra UMTS handovers, RANAP is carried over the MAP-E interface instead of
BSSAP. Please refer to 3GPP TS 29.108 [15].
When new parameters need to be added for transfer on the E-interface, the
principles stated in the beginning of subclause 4.5 shall be followed.
### 4.8.1 Basic Inter-MSC Relocation
When a Mobile Station is relocated between two MSCs, the establishment of a
connection between them (described in TS 23.009) requires interworking between
Iu-Interface and E-Interface.
The signalling at initiation, execution and completion of the Basic Inter-MSC
relocation procedure is shown in figures 50 to 54 with both possible positive
or negative outcomes.
Additionally figure 50b shows the possible interworking when trace related
messages are transparently transferred on the E-Interface at Basic Inter-MSC
Relocation initiation.
RNS-A 3G-MSC-A 3G-MSC-B
\| \| \|
\|RELOCATION \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request \| \|Possible Alloc. \|
\| \| \| \|of a relocation\|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|------------------>\|
Figure 50a: Signalling for Basic Inter-MSC Relocation initiation (no trace
related messages transferred)
RNS-A 3G-MSC-A 3G-MSC-B
\| (*) \|
\|RELOCATION \| \|
\|-------------->\|MAP PREPARE HANDOVER \|
\|REQUIRED \|------------------------>\| +----------------+
\| \|request (**) \| \|Possible Alloc. \|
\| \| \| \|of a relocation \|
\| \| \| \|no. in the VLR-B\|
\| \| \| +----------------+
\| \| \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \|CN INVOKE TRACE \|
\| \| \|--------------->(***)
Figure 50b: Signalling for Basic Inter-MSC Relocation initiation (CN invoke
trace message transferred)
(*): Tracing invocation has been received from VLR.
(**): In that case, RELOCATION REQUEST and CN INVOKE TRACE messages are
included within the AN-apdu parameter.
(***): CN INVOKE TRACE is forwarded to RNS-B if supported by 3G_MSC-B.
Possible Positive outcomes: successful radio resources allocation and
relocation numbers allocation (if performed):
RNS-A 3G-MSC-A 3G-MSC-B RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|\\| \|
\| \| \| \|
b) radio resources allocation failure:
RNS-A 3G-MSC-A 3G-MSC-B RNS-B
\| \| \| \|
\| \| \|RELOCATION FAILURE \|
\| \| \|\\| \| \|
\|CANCEL \| \| \|
\| \|MAP U -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|IU RELEASE COMMAND \|
\|RELOCATION \| \|------------------>\|
\|\\| \|
\| \| response \|IU RELEASE COMMAND \|
\| \| \|------------------>\|
\| \| \| (Note 1) \|
Figure 53: Signalling for Basic Inter-MSC Relocation completion (Positive
outcome)
NOTE: From interworking between MAP and RANAP point of view.
Negative outcome:
RNS-A 3G-MSC-A 3G-MSC-B RNS-B
\| \| \| \|
\| \| MAP U/P -ABORT \| \|
\| \|------------------------>\| \|
\| \| \|IU RELEASE COMMAND \|
\| \| \|------------------>\|
\| \| \| \|
Figure 54: Signalling for Basic Inter-MSC Relocation completion (Negative
outcome)
The relocation procedure is normally triggered by RNS-A by sending a
RELOCATION REQUIRED message on Iu-Interface to 3G_MSC-A. The invocation of the
Basic Inter-MSC relocation procedure is performed and controlled by 3G_MSC-A.
The sending of the MAP Prepare-Handover request to 3G_MSC-B is triggered in
3G_MSC-A upon receipt of the RELOCATION REQUIRED message. The identity of the
target RNC where the call is to be handed over in 3G_MSC-B area, provided in
the RELOCATION REQUIRED message, is mapped to the target RNC Id MAP parameter
and the RELOCATION REQUEST message is encapsulated in the an-APDU MAP
parameter of the Prepare-Handover MAP request. 3G_MSC-B can invoke another
operation towards the VLR-B (allocation of the relocation numbers described in
3GPP TS 29.002 [9]).
Additionally, if tracing activity has been invoked, the trace related messages
can be transferred on the E-Interface encapsulated in the an-APDU MAP
parameter of the Prepare-Handover Request. If transferred, one complete trace
related message at a time shall be included in the an-APDU MAP parameter after
the RELOCATION REQUEST message.
The interworking between Prepare Handover and RELOCATION REQUIRED is as
follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION REQUIRED MAP PREPARE HANDOVER request\|
message \| \|
\| -ho-NumberNotRequired\| 1
\| -target RNC Id \|
\| RANAP information -Radio Resource Info \|
\| elements -an-APDU( \|
\| RELOCATION REQUEST, \| 2
\| CN INVOKE TRACE) \|
\| GERAN classmark -GERAN classmark \| 4
\--------┼-------------------------------------------------┼-----
Positive\| MAP PREPARE HANDOVER response \|
result \| \| 3
\| -relocation numbers \|
\| -an-APDU( \|
\| RELOCATION COMMAND RELOCATION REQUEST \|
\| ACKNOWLEDGE \|
\| or \|
\| RELOCATION PREP FAILURE RELOCATION FAILURE)\|
\| \|
\--------┼-------------------------------------------------┼-----
Negative\| RELOCATION PREP FAILURE MAP PREPARE HANDOVER\|
result \| \|
\| Unspecified failure System Failure \|
\| Unspecified failure No Handover Number \|
\| available \|
\| Unspecified failure UnexpectedDataValue\|
\| Unspecified failure Data Missing \|
\| \|
\| Unspecified failure MAP CLOSE \|
\| Unspecified failure MAP U/P -ABORT \|
\| \|
NOTE 1: The RANAP information elements are already stored in 3G_MSC.
> The ho-NumberNotRequired parameter is included by 3G_MSC-A, when 3G_MSC-A
> decides not to use any circuit connection with 3G_MSC-B. No relocation
> numbers shall be present in the positive result. Any negative response from
> 3G_MSC-B shall not be due to relocation number allocation problem.
NOTE 2: The process performed on the RANAP information elements received in
the RELOCATION REQUIRED message is described in the 3GPP TS 25.413 [7].
NOTE 3: The response to the Prepare-Handover request can include in its an-
APDU parameter, identifying the 3GPP TS 25.413 [7] protocol, either a RANAP
RELOCATION REQUEST ACKNOWLEDGE or a RANAP RELOCATION FAILURE.
In the first case, the positive result triggers in 3G_MSC-A the sending on Iu-
Interface of the RELOCATION CMD.
In the second case, the positive result triggers in 3G_MSC-A the sending of
the RELOCATION PREP FAILURE.
NOTE 4: If the GERAN Classmark was not received with the RELOCATION REQUIRED
message initiating the relocation, 3G_MSC-A shall include any previously
received GERAN Classmark. See 3GPP TS 43.051 [17].
The interworking between Send End Signal and RELOCATION COMPLETE in 3G_MSC-B
is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION COMPLETE MAP SEND END SIGNAL request \|
message \| \|
\| -an-APDU( \|
\| RELOCATION COMPL) \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| IU RELEASE COMMAND MAP SEND END SIGNAL response\|
result \| -Normal release \| 1
\--------┼-------------------------------------------------┼-----
Negative\| IU RELEASE COMMAND \|
result \| -Normal release MAP CLOSE \| 2
\| -Normal release MAP U/P -ABORT \|
\| \|
NOTE 1: The positive empty result triggers the clearing of the Radio Resources
on the Iu-Interface and the release of the SCCP connection between 3G_MSC-B
and RNS-B. If a circuit connection is used between 3G_MSC-A and 3G_MSC-B, the
\'Normal release\' clearing cause shall only be given to RNS-B when 3G_MSC-B
has received a clearing indication on its circuit connection with 3G_MSC-A.
NOTE 2: The abortion of the dialogue or the rejection of the component
triggers in 3G_MSC-B the clearing of its circuit connection with 3G_MSC-A, if
any, of the Radio Resources on the Iu-Interface and the release of the SCCP
connection between 3G_MSC-B and RNS-B.
The interworking between Send End Signal and IU RELEASE COMMAND in 3G_MSC-A is
as follows:
\----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| MAP SEND END SIGNAL IU RELEASE COMMAND \|
message \| request \|
\| -an-APDU( - Successful \|
\| RELOCATION COMPLETE) Relocation \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
The interworking between RELOCATION CANCEL in case of relocation cancelled and
User Abort in 3G-MSC-A is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION CANCEL MAP U -ABORT \|
message \| \|
\| - Relocation \|
\| cancelled \|
\--------┼-------------------------------------------------┼-----
Positive\| RELOCATION CANCEL ACKNOWLEDGEMENT \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
### 4.8.2 Subsequent Inter-MSC Relocation back to 3G_MSC-A
When a Mobile Station is being relocated back to 3G_MSC-A, the procedure
(described in TS 23.009) requires interworking between Iu-Interface and
E-Interface.
The signalling at initiation, execution and completion of the Subsequent
Inter-MSC relocation procedure is shown in figures 55 to 59.
RNS-A 3G-MSC-B 3G-MSC-A
\| \| \|
\|RELOCATION \| \|
\|-------------->\|MAP PREPARE SUBSEQUENT \|
\|REQUIRED \|------------------------>\|
\| \|HANDOVER request \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|------------------>\|
Figure 55: Signalling for Subsequent Inter-MSC Relocation back to 3G_MSC-A
initiation
Possible Positive outcomes: successful radio resources allocation:
RNS-A 3G-MSC-B 3G-MSC-A RNS-B
\| \| \| \|
\| \| \|RELOCATION REQUEST \|
\| \| \|\\| \| \|
\|CANCEL \|MAP PROCESS ACCESS \| \|
\| \|------------------------>\| \|
\| \| SIGNALLING request \|IU RELEASE COMMAND \|
\| \| \|------------------>\|
\| \| \|IU RELEASE COMPLETE\|
\| \| \|\\|
\| \| \|(Note 1) \|
Figure 59: Signalling for Subsequent Inter-MSC Relocation back to 3G_MSC-A
completion (Unsuccessful completion of the procedure)
NOTE: Abnormal end of the procedure that triggers the clearing of all
resources in 3G_MSC-B.
The interworking between Prepare Subsequent Handover and RELOCATION REQUIRED
is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \|REL. REQUIRED MAP PREPARE SUBSEQUENT HANDOVER\|
message \| request \|
\| \|
\| -target MSC number \|
\| -target RNC Id \|
\| RANAP information -an-APDU( \| 1
\| elements RELOCATION REQ) \|
\| \|
\| GERAN classmark -GERAN classmark \| 3
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| MAP PREPARE SUBSEQUENT HANDOVER\|
result \| response \| 2
\| -an-APDU( \|
\|RELOCATION CMD. RELOCATION REQUEST \|
\| ACKNOWLEDGE \|
\| or \|
\|RELOCATION PREP FAILURE RELOCATION FAILURE)\|
\| \|
\--------┼-------------------------------------------------┼-----
Negative\| REL. PREP. FAILURE MAP PREPARE SUBSEQUENT\|
result \| HANDOVER response \|
\| Unspecified failure Unknown MSC \|
\| Unspecified failure Subsequent Handover\|
\| Failure \|
\| Unspecified failure UnexpectedDataValue\|
\| Unspecified failure Data Missing \|
\| \|
\| Iu RELEASE COMMAND MAP CLOSE \|
\| MAP U/P --ABORT \|
\| Unspecified failure \|
\| Unspecified failure \|
\| \|
NOTE 1: The processing performed on the RANAP information elements received in
the RELOCATION REQUIRED message is out of the scope of the present document.
The target MSC number is provided to 3G_MSC-A by 3G_MSB-B based on the
information received from RNS-B.
NOTE 2: The response to the Prepare-Subsequent-Handover request can include in
its an-APDU parameter, identifying the 3GPP TS 25.413 [7] protocol, a RANAP
RELOCATION REQUEST ACKNOWLEDGE or a RANAP RELOCATION FAILURE.
NOTE 3: If the GERAN Classmark was not received with the RELOCATION REQUIRED
message initiating the relocation, MSC-B shall include any previously received
GERAN Classmark. See 3GPP TS 43.051 [17].
In the first case, the positive result triggers in 3G_MSC-B the sending on
Iu‑Interface of the RELOCATION COMMAND.
In the second case, the positive result triggers in 3G_MSC-B the sending of
the RELOCATION PREPARATION FAILURE.
The interworking between RELOCATION CANCEL and MAP Process Signalling Request
in 3G_MSC-A is as follows:
\----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| MAP PROCESS-SIGNALLING IU RELEASE COMMAND \|
message \| request \|
\| -an-APDU( \|
\| RELOCATION CANCEL) \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| MAP FORWARD-SIGNALLING IU RELEASE COMPLETE\|
result \| request \|
\| -an-APDU( \|
\| RELOCATION CANCEL ACK) \|
\| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
\| \|
The interworking between RELOCATION CANCEL and MAP Process Signalling Request
in 3G_MSC-B is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION CANCEL MAP PROCESS-SIGNALLING \|
message \| request \|
\| -an-APDU( \|
\| RELOCATION CANCEL) \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| RELOCATION CANCEL ACK MAP FORWARD-SIGNALLING \|
result \| request \|
\| -an-APDU( \|
\| RELOCATION CANCEL ACK)\|
\| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| \|
\| \|
The interworking between Send End Signal Result and RELOCATION COMPLETE in
3G_MSC-A is as follows:
\----------------------------------------------------------------
\| 25.413 29.002 \|Notes
\--------┼-------------------------------------------------┼-----
Forward \| RELOCATION COMPLETE MAP SEND END SIGNAL \|
message \| response \|
\| \|
\--------┼-------------------------------------------------┼-----
Positive\| \|
result \| \|
\--------┼-------------------------------------------------┼-----
Negative\| \|
result \| MAP U/P -ABORT \| 1
NOTE: The abortion of the dialogue ends the relocation procedure with
3G_MSC-B.
### 4.8.3 Subsequent Inter-MSC Relocation to third MSC
When a Mobile Station is being relocated to a third MSC, the procedure
(described in 3GPP TS 23.009 [2]) does require one specific interworking case
in 3G_MSC-A (figure 64) between E-Interface from 3G_MSC-B and E-Interface from
3G_MSC-B\' other than the combination of the ones described in the subclause
4.8.1 and 4.8.2.
RNS-A 3G-MSC-B 3G-MSC-A 3G-MSC-B\'
\| \| \| \|
\|RELOCATION \| \| \|
\|----------->\|MAP PREPARE SUBSEQUENT\| \|
\|REQUIRED \|--------------------->\| \|
\| \|HANDOVER request \|MAP PREPARE \|
\| \| \|--------------->\|
\| \| \|HANDOVER request\|
\| \| \| \|+-------+
\| \| \| \|\|Possib.\|
\| \| \| \|\|Alloc. \|
\| \| \| \|\|of relo\|
\| \| \| \|\|number \|
\| \| \| \|\| VLR-B \|
\| \| \| \|+-------+
\| \| \| \| RNS-B\'
\| \| \| \| \|
\| \| \| \|RELOCATION
\| \| \| \|-------->\|
\| \| \| \|REQUEST \|
\| \| \| \| \|
Figure 60: Signalling for Subsequent Inter-MSC Relocation to third MSC
(3G_MSC-B\') initiation
Possible Positive outcomes: successful radio resources allocation:
RNS-A 3G-MSC-B 3G-MSC-A 3G-MSC-B\'
\| \| \| \|
\| \| \| \| RNS-B\'
\| \| \| \| \|
\| \| \| \|RELOCATION
\| \| \| \|\\| \| \| \|
\|CANCEL \|MAP PROCESS ACCESS \| \| \|
\| \|--------------------->\| \| \|
\| \|SIGNALLING request (Note 1) \| \|
\| \| \| \| \|
\| \| \|MAP U -ABORT \| \|
\| \| \|--------------->\| \|
\| \|MAP FORWARD ACCESS \| \|IU RELEASE
\| \|\\|
\|RELOCATION \| SIGNALLING request \| \|COMMAND \|
\|\ If Ciphering has been performed before Inter-MSC Relocation, Selected GSM
> algorithm information is received by 3G_MSC-A from 3G_MSC-B in:
  * The Handover Performed BSSMAP message.
If Ciphering has NOT been performed before Intra-MSC-B handover from UMTS to
GSM after Inter-MSC Relocation, Selected GSM algorithm information is received
by 3G_MSC-A from 3G_MSC-B in:
  * The Process Access Signalling Request MAP message.
#### 4.8.5.6 Allowed GSM Algorithms
Allowed GSM algorithms is GSM information that is required in BSSMAP Handover
Request and BSSMAP Cipher Mode Command, and shall be provided by 3G_MSC-A.
3G_MSC-B needs this information in case of an intra-MSC UMTS to GSM handover
and in subsequent ciphering mode setting, after an inter-MSC relocation.
Therefore 3G_MSC-A must provide this information in case of an inter-MSC
relocation. The Allowed GSM algorithms IE in the MAP Prepare Handover and in
the MAP Forward Access Signalling Request messages refers to the Algorithm
identifier octet in the Permitted Algorithms GSM information.
Allowed GSM algorithms shall be stored by 3G_MSC-B.
Transfer of information:
If ciphering has not been performed before Inter-MSC Relocation, this will be
controlled by 3G_MSC-A after the completion of Inter-MSC Relocation.
Ciphering control towards 3G_MSC-B:
If Ciphering has been performed before Inter-MSC Relocation:
  * The Prepare Handover Request MAP message.
If Ciphering has NOT been performed before Inter-MSC Relocation:
  * The Forward Access Signalling Request MAP message.
#### 4.8.5.7 Chosen Channel
BSSMAP Assignment Request may give the BSS some freedom in the selection of
radio resource (for instance channel rate selection, speech version selection
etc.). Chosen Channel and/or Speech Version is reported back to 3G_MSC-B in
BSSMAP Assignment Complete. The Chosen Radio Resource Information IE in the
MAP Prepare Handover Response and Process Access Signalling Request messages
refers to the Chosen Channel and/or Speech Version GSM information.
The Channel Type and the characteristics of the chosen channel shall be stored
by 3G_MSC-B, and the Chosen Channel and/or Speech Version information elements
shall be transferred to MSC-A or 3G_MSC-A.
Transfer of information:
Received by MSC-A or 3G_MSC-A from 3G_MSC-B in:
  * The Prepare Handover Response MAP message
  * The Process Access Signalling request MAP message
#### 4.8.5.8 BSSMAP Service Handover
This information shall be stored by 3G_MSC-B and sent to a BSS in Handover
Request, when 3G_MSC-B performs handover to GSM.
Transfer of information:
The BSSMAP Service Handover information is transferred to 3G_MSC-B in:
  * the Prepare Handover Request MAP message.
If a new assignment of a TCH after an inter-MSC relocation is to be performed,
the BSSMAP Service Handover information is transferred to 3G_MSC-B in:
  * the Forward Access Signalling Request MAP message
> and sent by 3G_MSC-B to the BSS in the Assignment Request BSSMAP message.
#### 4.8.5.9 RANAP Service Handover
This information shall be stored by 3G_MSC-B and sent to an RNS in Relocation
Request during the basic inter-MSC relocation or when 3G_MSC-B performs a
subsequent intra-MSC relocation or handover to UMTS.
Transfer of information:
The RANAP Service Handover information is transferred to 3G_MSC-B in:
  * the Relocation Request RANAP message.
If a new assignment of a Radio Access Bearer after an inter-MSC relocation is
to be performed, the information is transferred to 3G_MSC-B in:
  * the RANAP RAB Assignment procedure.
#### 4.8.5.10 GERAN Classmark
The GERAN Classmark shall be stored by 3G_MSC-B and can be received from
MSC-A, from the serving BSS or serving RNS, or from the target RNS. The GERAN
Classmark shall be used together with other parameters, e.g. the Channel Type,
for selecting a service and for generating RAB parameters for relocation to
GERAN Iu-mode, subsequent relocation or handover to GERAN Iu-mode, and RAB
(re-)assignment when the MS is in GERAN Iu-mode.
Transfer of Information due to GERAN Classmark received from MSC-A:
Received by 3G_MSC-B in:
\- the Prepare Handover Request MAP message.
Transfer of Information due to GERAN Classmark received from the serving RNS:
Received by 3G_MSC-B in:
  * the Handover Required BSSMAP message;
  * the Relocation Required RANAP message;
  * the Initial UE RANAP message; or
  * the RAB Assignment Response RANAP message.
Transfer of Information due to GERAN Classmark received from the target RNS:
Received by 3G_MSC-B in:
  * the Relocation Failure RANAP message.
#### 4.8.5.11 SNA Access Information
This information shall be stored by 3G_MSC-B and sent to an RNS in the
Relocation Request message when 3G_MSC-B performs handover to UMTS.
Transfer of information:
The SNA Access Information is transferred to 3G_MSC-B in:
  * the Relocation Request RANAP message encapsulated in the Prepare Handover request MAP message.
#### 4.8.5.12 UESBI
This information shall be stored by 3G_MSC-B and sent to an RNS in Relocation
Request during the basic inter-MSC relocation or when 3G_MSC-B performs a
subsequent intra-MSC relocation or handover to UMTS.
Transfer of information:
The UESBI information is transferred to 3G_MSC-B in:
  * the Relocation Request RANAP message.
#### 4.8.5.13 Alternative RAB Parameters Value
This information shall be stored by 3G_MSC-B and sent to an RNS in Relocation
Request during the basic inter-MSC relocation or when 3G_MSC-B performs a
subsequent intra-MSC relocation or handover to UMTS.
Transfer of information:
The Alternative RAB Parameters Value information is transferred to 3G_MSC-B
in:
  * the Relocation Request RANAP message.
If an assignment of a Radio Access Bearer after an inter-MSC relocation is to
be performed, the information is transferred to 3G_MSC-B in:
  * the RAB Assignment Request RANAP message.
#### 4.8.5.14 Trace parameters
This information shall be stored by 3G_MSC-B and 3G_MSC-B shall use this
information for trace activation for MSC-S, MGW, RNC or BSC.
Transfer of information:
The Trace Parameter List information for MSC-S, MGW and BSC tracing is
transferred to 3G_MSC-B in:
> \- the Prepare Handover Request MAP message.
The Trace Propagation Parameter information for RNC tracing is transferred to
3G_MSC-B in:
> \- the CN Invoke Trace RANAP message.
### 4.8.6 Overview of the Technical Specifications 3GPP interworking for the
Inter-MSC Relocation
╔══════════════════════════════════════════════════════════════════════════════════════════════════╗
║ **[PSTN/ISDN]{.underline}** ║
║ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ ║
║ ▒ +---------------+ ▒ ║
║ ==============▒====== \| ============= \| =============== ▒ ║
║ **[UMTS]{.underline}** ▒ \| \| ▒ ║
║ ▒ V V ▒ ║
║ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ ▒ ║
║ ▒ **RNS-A** **3G-MSC-A** **3G-MSC-B** **RNS-B** ▒ **MS** ║
║ ▒ ▒ ║
║ ▒ +-------+ ▒ +-------+ ║
║ ▒ \| C M \| 24.008 ▒ \| C M \| ║
║ ▒ +-------\|\+-------\| ║
║ ▒ ░░░░░░░░░░░░░░░ \| M M \| ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▒ \| M M \| ║
║ ▒ ░+------+25.413 +-------\| 25.413+-------+ 25.413+-------+ ░▒ +-------\| ║
║ ▒ ░\| R R \|\\| R R \|\\| R R \|\\| R R \| ░▒ \| R R
\| ║
║ ▒ ░+------+ +-------+ +-------+ +-------+ ░▒ +-------+ ║
║ ▒ ░ Λ Λ Λ Λ ░▒ ║
║ ▒ ░ \| \| 29.010 \| \| ░▒ ║
║ ▒ ░ \| V V \| ░▒ ║
║ ▒ ░ \|+-----+ 29.002+-----+\| ░▒ ║
║ ▒ ░ \|\|MAP/E\|\\|MAP/E\|\| ░▒ ║
║ ▒ ░ \|+-----+ +-----+\| 23.009░▒ ║
║ ▒ ░░░░░░░░░░░░░░░░ \| ░░░░░░░░░░░░░░░░░░░ \| ░░░░░░░░░░░░░░░░░░░▒ Remark:
The RRC interface and ║
║ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ V ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ V ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ the link
layer ║
║ +-----------------------+ protocols being out of ║
║ \| T C A P \| the scope of this ║
║ +-----------------------+ Specification are not ║
║ +------------------------------------------------------+ shown here. ║
║ \| S C C P \| ║
║ +------------------------------------------------------+ ║
║ +------------------------------------------------------+ ║
║ \| M T P \| ║
║ +------------------------------------------------------+ ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════╝
## 4.9 Location Services
The general principles of the location services procedures are given in
Technical Specification 3GPP TS 23.271 [16].
3GPP TS 29.010 gives the necessary information for interworking between the
3GPP TS 25.413 [7] RANAP protocol and the 3GPP TS 48.008 [12] BSSMAP protocol.
The interworking is necessary for positioning requests issued after a
completed GSM to UMTS inter system handover. BSSMAP messages carried by MAP
over the E-interface must be mapped by the non-anchor 3G-MSC into the
corresponding RANAP messages to be sent over the Iu-interface and vice versa.
For Inter-MSC GSM to GSM Handover and Inter-MSC UMTS to UMTS SRNS Relocation
no mapping between the 3GPP TS 25.413 [7] RANAP protocol and the 3GPP TS
48.008 [12] BSSMAP protocol is necessary, but only the interworking with the
MAP protocol over the E-interface needs to be described.
### 4.9.1 Completed Location Acquisition
#### 4.9.1.1 Inter-MSC Handover (GSM to GSM)
After a successful Inter-MSC handover, any positioning request received by the
anchor MSC via the MAP message Provide Subscriber Location triggers the BSSMAP
procedure Location Acquisition described in 3GPP TS 48.008 [12]. For handover
this procedure is executed according to GSM 3GPP TS 49.008 [14] with the
anchor MSC playing the role of the MSC and the non anchor MSC playing the role
of the BSS.
The needed BSSMAP signalling is sent over the E-interface encapsulated in the
MAP messages Process Access Signalling and Forward Access Signalling.
At the non anchor MSC the BSSMAP messages received from the anchor MSC are
forwarded to the BSS, and the BSSMAP messages received from the BSS are sent
over the E-interface to the anchor MSC.
The signalling for a completed Location Acquisition procedure is shown in
figures 65a.
GMLC MSC-A MSC-B
\| \| \|
\|MAP PROVIDE \| \|
\|SUBSCRIBER \| \|
\|LOCATION \| \|
\|-------------->\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| PERFORM LOCATION \|
\| \| REQUEST) \|
\| \| \|
\| \| \| BSS-B
\| \| \| \| \| \| \| \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \| PERFORM LOCATION \|
\| \| \| REQUEST \|
\| \| \| \|
\| \| \| \|
\| \| \| +-----------+
\| \| \| \|Positioning\|
\| \| \| \| is \|
\| \| \| \| performed \|
\| \| \| +-----------+
\| \| \| \|
\| \| \| \| \| \| \| \|
\| \| \|\\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| PERFORM LOCATION \|
\| \| REQUEST) \|
\| \| \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|LOCATION REPORTING \|
\| \| \| CONTROL \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \| +-----------+
\| \| \| \|Positioning\|
\| \| \| \| is \|
\| \| \| \| performed \|
\| \| \| +-----------+
\| \| \| \|
\| \| \|LOCATION REPORT \|
\| \| \|\Current Geographic >Event = Direct \|
\| Location >Report Area = \|
\| Geo. Coord. \|
\| \|
\| Cell Identifier ---- \|
\| Classmark Inf. Type3 ---- \|
\| LCS Client Type ---- \|
\| Chosen Channel ---- \|
\| LCS Priority ---- \|
\| LCS QoS Request Type \|
\| >Horizontal Accuracy >Accuracy Code \|
\| \|
\| GPS Assistance Data ---- \|
\| APDU ---- \|
\| \|
\--------┼-------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. LOCATION REPORT \|
\| request \|
\| -an-APDU( \|
\| PERFORM LOCATION RESPONSE) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| \|
\| Location Estimate Area Identity \|
\| >Geographical Area \|
\| Positioning Data ---- \|
\| Deciphering Keys ---- \|
\| LCS Cause Cause \|
\| ---- Request Type \|
\| \|
\| \|
NOTE 1: All other Location Type possibilities are not supported by UMTS
positioning
After the inter-MSC GSM to UMTS handover, the 3G MSC-B can perform intra-MSC
UMTS to GSM handover. Any positioning request received by the anchor MSC after
completion of the intra-MSC UMTS to GSM handover is handled as for Inter-MSC
Handover GSM to GSM (see section 4.9.1.1).
#### 4.9.1.3 Inter-MSC Handover (UMTS to GSM)
After a successful Inter-MSC UMTS to GSM inter system handover, any
positioning request received by the anchor 3G-MSC via the MAP message Provide
Subscriber Location triggers the BSSMAP procedure Location Acquisition
described in 3GPP TS 48.008 [12]. For handover this procedure is executed
according to 3GPP TS 49.008 [14] with the anchor 3G-MSC playing the role of
the 3G-MSC and the non anchor MSC playing the role of the BSS.
The needed BSSMAP signalling is sent over the E-interface encapsulated in the
MAP messages Process Access Signalling and Forward Access Signalling.
At the non anchor MSC the BSSMAP messages received from the anchor 3G-MSC are
forwarded to the BSS, and the BSSMAP messages received from the BSS are sent
over the E-interface to the anchor 3G-MSC.
The signalling for a completed Location Acquisition procedure is shown in
figures 65c.
GMLC 3G-MSC-A MSC-B
\| \| \|
\|MAP PROVIDE \| \|
\|SUBSCRIBER \| \|
\|LOCATION \| \|
\|-------------->\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| PERFORM LOCATION \|
\| \| REQUEST) \|
\| \| \|
\| \| \| BSS-B
\| \| \| \| \| \| \| \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \| PERFORM LOCATION \|
\| \| \| REQUEST \|
\| \| \| \|
\| \| \| \|
\| \| \| +-----------+
\| \| \| \|Positioning\|
\| \| \| \| is \|
\| \| \| \| performed \|
\| \| \| +-----------+
\| \| \| \|
\| \| \| \| \| \| \| \|
\| \| \|\\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| LOCATION REPORTING \|
\| \| CONTROL) \|
\| \| \|
\| \| \| RNS-B
\| \| \| \| \| \| \| \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \|LOCATION REPORTING \|
\| \| \| CONTROL \|
\| \| \| \|
\| \| \| \|
\| \| \| +-----------+
\| \| \| \|Positioning\|
\| \| \| \| is \|
\| \| \| \| performed \|
\| \| \| +-----------+
\| \| \| \|
\| \| \| \| \| \| \| \|
\| \| \|\\|MAP FORWARD ACCESS \| | | | | \| \| SIGNALLING \| | | | | \| \|------------------------>\| | | | | \| \| -an-APDU( \| | | | | \| \| LOCATION REPORTING \| | | | | \| \| CONTROL) \| | | | | \| \| \| | | | | \| \| \| BSS-B | | | | \| \| \| \| \| \| \| \| | | | | \| \| \|------------------>\| | | | | \| \| \| \| | | | | \| \| \|PERFORM LOCATION \| | | | | \| \| \| REQUEST \| | | | | \| \| \| \| | | | | \| \| \| \| | | | | \| \| \| +-----------+ | | | | \| \| \| \|Positioning\| | | | | \| \| \| \| is \| | | | | \| \| \| \| performed \| | | | | \| \| \| +-----------+ | | | | \| \| \| \| | | | | \| \| \| \| \| \| \| \| | | | | \| \| \|\Event = Direct >Current Geographic \| | | | | \| >Report Area = Location \| | | | | \| Geo. Coord. \| | | | | \| \| | | | | \| Request Type LCS QoS \| | | | | \| >Accuracy Code >Horizontal Accuracy \| | | | | \| \| | | | | --------┼-------------------\ | | ------------------------------┼----- | | | | Result \| MAP PROCESS ACCESS SIG. PERFORM LOCATION \| | | | | \| request RESPONSE \| | | | | \| -an-APDU( \| | | | | \| LOCATION REPORT) \| | | | | \| \| | | | | \| RANAP information BSSMAP information \| | | | | \| elements: elements: \| | | | | \| \| | | | | \| Area Identity Location Estimate \| | | | | \| >Geographical Area \| | | | | \| \| | | | | \| Cause LCS Cause \| | | | | \| Request Type ---- \| | | | | \| \| | +----------------------------------------------------------------------+
### 4.9.2 Cause Code Mapping
#### 4.9.2.1 Inter-MSC Handover (GSM to GSM)
When a mobile station is handed over from GSM to GSM, no mapping of cause
codes is required. The MSC shall use the cause codes specified in 3GPP TS
48.008 [12].
After the inter-MSC handover, the MSC-B can perform intra-MSC GSM to UMTS
handover. A mapping of the cause codes used in the RANAP and the BSSMAP
protocols is needed after completion of the intra-MSC GSM to UMTS handover and
is the same as for Inter-MSC Handover GSM to UMTS (see section 4.9.2.2)..
#### 4.9.2.2 Inter-MSC Handover (GSM to UMTS)
When a Mobile Station is handed over between GSM and UMTS, a mapping of the
cause codes used in the RANAP and the BSSMAP protocols is needed. The mapping
described here is applicable to the BSSMAP protocol even when used inside MAP
in the E-interface.
The mapping between the cause codes received in RANAP Location Report and the
LCS cause codes sent in BSSMAP Perform Location Response is as follows:
\----------------------------------------------------------------
25.413 48.008 \|Notes
\-------------------------------------------------------┼--------
LOCATION REPORT PERFORM LOCATION RESPONSE \|
\|
\- Requested Report Type - Position method failure\|
not Supported \|
\- Requested Information - Position method failure\|
not Available \|
\- all other cause codes - System Failure \|
After the inter-MSC GSM to UMTS handover, the 3G MSC-B can perform intra-MSC
UMTS to GSM handover. No mapping of cause codes is required after completion
of the intra-MSC UMTS to GSM handover as for Inter-MSC Handover GSM to GSM
(see section 4.9.2.1).
#### 4.9.2.3 Inter-MSC Handover (UMTS to GSM)
When a mobile station is handed over from UMTS to GSM, no mapping of cause
codes is required. The 3G-MSC shall use the cause codes specified in 3GPP TS
48.008 [12].
After the inter-MSC UMTS to GSM handover, the 3G MSC-B can perform intra-MSC
GSM to UMTS handover. A mapping of the cause codes used in the RANAP and the
BSSMAP protocols is needed after completion of the intra-MSC GSM to UMTS
handover and is the same as for Inter-MSC Handover GSM to UMTS (see section
4.9.2.2)...
#### 4.9.2.4 Inter-MSC SRNS Relocation
When a mobile station is handed over from UMTS to UMTS, no mapping of cause
codes is required. Both 3G-MSCs shall use the cause codes specified in TS
25.413.
After the inter-MSC SRNS Relocation, the 3G MSC-B can perform intra-MSC UMTS
to GSM handover. A mapping of the cause codes used in the RANAP and the BSSMAP
protocols is needed after completion of the intra-MSC UMTS to GSM handover.
The mapping between the cause codes received in BSSMAP Perform Location
Response and the LCS cause codes sent in RANAP Location Report is as follows:
+----------------------------------------------------------------------+ | -----------------------------\ | | ----------------------------------- | | | | 48.008 25.413 \|Notes | | | | ----------------------------\ | | ---------------------------┼-------- | | | | PERFORM LOCATION RESPONSE LOCATION REPORT \| | | | | \| | | | | - Position method failure - Requested Report Type \| | | | | not Supported \| | | | | - System Failure - Unspecified Failure \| | | | | - Protocol Error - Unspecified Failure \| | | | | - Data missing - Unspecified Failure \| | | | | in position request \| | | | | - Unexpected data value - Unspecified Failure \| | | | | in position request \| | | | | - Target MS Unreachable - Unspecified Failure \| | | | | - Location request aborted - Unspecified Failure \| | | | | - Facility not supported - Requested Report Type \| | | | | not Supported \| | | | | - Inter-BSC Handover Ongoing - Unspecified Failure \| | | | | - Intra-BSC - Unspecified Failure \| | | | | Handover Complete \| | | | | - Congestion - Unspecified Failure \| | | | | - Unspecified - Unspecified Failure \| | +----------------------------------------------------------------------+
### 4.9.3 Aborted Location Acquisition
#### 4.9.3.1 Inter-MSC Handover (GSM to GSM)
When for any reason the on going location acquisition procedure needs to be
aborted, the anchor MSC sends the BSSMAP message Perform Location Abort over
the E-interface.
Figure 66a shows the signalling for an aborted Location Acquisition procedure.
GMLC MSC-A MSC-B
\| \| \|
\|MAP PROVIDE \| \|
\|SUBSCRIBER \| \|
\|LOCATION \| \|
\|-------------->\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| PERFORM LOCATION \|
\| \| REQUEST) \|
\| \| \|
\| \| \| BSS-B
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \|-------------------->\|
\| \| \| \|
\| \| \| PERFORM LOCATION \|
\| \| \| REQUEST)\|
\| \| \| \|
\| \| \| \|
\| \|MAP FORWARD ACCESS \| \|
\| \| SIGNALLING \| \|
\| \|------------------------>\| \|
\| \| -an-APDU( \| \|
\| \| PERFORM LOCATION ABORT)\| \|
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \|-------------------->\|
\| \| \| \|
\| \| \| PERFORM LOCATION \|
\| \| \| ABORT \| \| \| \| \|
\| \| \|\\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| PERFORM LOCATION \|
\| \| REQUEST) \|
\| \| \|
\| \| \| RNS-B
\| \| \| \|
\| \| \|LOCATION REPORTING \|
\| \| \| CONTROL \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \| \|
\| \|MAP FORWARD ACCESS \| \|
\| \| SIGNALLING \| \|
\| \|------------------------>\| \|
\| \| -an-APDU( \| \|
\| \| PERFORM LOCATION ABORT)\| \|
\| \| \| \|
\| \| \| \|
\| \| \|LOCATION REPORTING \|
\| \| \| CONTROL \|
\| \| \|------------------>\|
\| \| \| \|
\| \| \| \|
\| \| \|LOCATION REPORT \|
\| \| \| \|
\| \| \|\Event = Stop \|
\| >Report Area = \|
\| Geo. Coord. \|
\| \|
\| \|
\--------┼-------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. LOCATION REPORT \|
\| request \| 1
\| -an-APDU( \|
\| PERFORM LOCATION RESPONSE) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| ---- \|
\| LCS Cause Cause \|
\| ---- \|
\| \|
NOTE 1: PERFORM LOCATION RESPONSE with LCS cause shall be generated by
3G-MSC-B.
After the inter-MSC GSM to UMTS handover, the 3G MSC-B can perform intra-MSC
UMTS to GSM handover. A positioning request that needs to be aborted by the
anchor MSC after completion of the intra-MSC UMTS to GSM handover is handled
as for Inter-MSC Handover GSM to GSM (see section 4.9.3.1).
#### 4.9.3.3 Inter-MSC Handover (UMTS to GSM)
When for any reason the on going location acquisition procedure needs to be
aborted, the anchor 3G-MSC sends the BSSMAP message Perform Location Abort
over the E-interface.
Figure 66c shows the signalling for an aborted Location Acquisition procedure.
GMLC 3G-MSC-A MSC-B
\| \| \|
\|MAP PROVIDE \| \|
\|SUBSCRIBER \| \|
\|LOCATION \| \|
\|-------------->\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| PERFORM LOCATION \|
\| \| REQUEST) \|
\| \| \|
\| \| \| BSS-B
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \|-------------------->\|
\| \| \| \|
\| \| \| PERFORM LOCATION \|
\| \| \| REQUEST)\|
\| \| \| \|
\| \| \| \|
\| \|MAP FORWARD ACCESS \| \|
\| \| SIGNALLING \| \|
\| \|------------------------>\| \|
\| \| -an-APDU( \| \|
\| \| PERFORM LOCATION ABORT)\| \|
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \|-------------------->\|
\| \| \| \|
\| \| \| PERFORM LOCATION \|
\| \| \| ABORT \|
\| \| \| \|
\| \| \|\\|MAP FORWARD ACCESS \|
\| \| SIGNALLING \|
\| \|------------------------>\|
\| \| -an-APDU( \|
\| \| LOCATION REPORTING \|
\| \| CONTROL) \|
\| \| \|
\| \| \| RNS-B
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \|-------------------->\|
\| \| \| \|
\| \| \| LOCATION REPORTING \|
\| \| \| CONTROL \|
\| \| \| \|
\| \| \| \|
\| \|MAP FORWARD ACCESS \| \|
\| \| SIGNALLING \| \|
\| \|------------------------>\| \|
\| \| -an-APDU( \| \|
\| \| LOCATION REPORTING \| \|
\| \| CONTROL = STOP) \| \|
\| \| \| \|
\| \| \| \|
\| \| \| \|
\| \| \|-------------------->\|
\| \| \| \|
\| \| \| LOCATION REPORTING \|
\| \| \| CONTROL = \| \| \| \| STOP DIRECT \|
\| \| \| \|
\| \| \|\\|MAP FORWARD ACCESS \| | | | | \| \| SIGNALLING \| | | | | \| \|------------------------>\| | | | | \| \| -an-APDU( \| | | | | \| \| LOCATION REPORTING \| | | | | \| \| CONTROL) \| | | | | \| \| \| | | | | \| \| \| BSS-B | | | | \| \| \| \| \| \| \| \| | | | | \| \| \|------------------>\| | | | | \| \| \| \| | | | | \| \| \|PERFORM LOCATION \| | | | | \| \| \| ABORT \| | | | | \| \| \| \| | | | | \| \| \| \| | | | | \| \| \| \| | | | | \| \| \|\Event = Stop Direct > Location request \| | | | | \| >Report Area = aborted \| | | | | \| Geo. Coord. \| | | | | \| \| | | | | --------┼-------------------\ | | ------------------------------┼----- | | | | Result \| MAP PROCESS ACCESS SIG. PERFORM LOCATION \| | | | | \| request RESPONSE \| | | | | \| -an-APDU( \| | | | | \| LOCATION REPORT) \| | | | | \| \| | | | | \| RANAP information BSSMAP information \| | | | | \| elements: elements: \| | | | | \| \| | | | | \| Cause LCS Cause \| | | | | \| >Unspecified > Location request \| | | | | \| Failure aborted \| | | | | \| \| | +----------------------------------------------------------------------+
### 4.9.4 Request of Assistance Data or De-ciphering Keys: Successful Case
#### 4.9.4.1 Inter-MSC Handover (GSM to GSM)
After a successful Inter-MSC handover, any request of Assistance Data or De-
ciphering keys received by the non anchor MSC via the DTAP message LCS-MOLR is
forwarded to the anchor MSC by encapsulating the DTAP message into the MAP
messages Process Access Signalling. The anchor MSC triggers the BSSMAP
procedure Location Acquisition described in 3G TS 48.008. For handover this
procedure is executed according to 3G TS 49.008 with the anchor MSC playing
the role of the MSC and the non anchor MSC playing the role of the BSS.
The needed BSSMAP signalling is sent over the E-interface encapsulated in the
MAP messages Process Access Signalling and Forward Access Signalling.
At the non anchor MSC the BSSMAP messages received from the anchor MSC are
forwarded to the BSS, and the BSSMAP messages received from the BSS are sent
over the E-interface to the anchor MSC.
Once the BSSMAP procedure has been completed, the anchor MSC sends the DTAP
message LCS-MOLR Response encapsulated in the MAP message Forward Access
Signalling to the non anchor MSC, which relays it to the MS.
The signalling for a completed request of Assistance Data or De-ciphering Keys
is shown in figures 67a.
MSC-A MSC-B MS
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| PERFORM LOCATION \| \|
\| REQUEST) \| BSS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| PERFORM LOCATION \| \|
\| \| REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to MS \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 67a: Signalling for the request of Assistance Data or De-ciphering Keys
After the inter-MSC handover, the MSC-B can perform intra-MSC GSM to UMTS
handover. Any request for Assistance Data or De-ciphering keys received after
completion of the intra-MSC GSM to UMTS handover is handled as for Inter-MSC
Handover GSM to UMTS (see section 4.9.4.2).
#### 4.9.4.2 Inter-MSC Handover (GSM to UMTS)
After a successful Inter-MSC GSM to UMTS inter system handover, any request of
Assistance Data or De-ciphering keys received by the non-anchor 3G MSC via the
DTAP message LCS-MOLR is forwarded to the anchor MSC by encapsulating the DTAP
message into the MAP messages Process Access Signalling. The anchor MSC
triggers the BSSMAP procedure Location Acquisition described in 3G TS 48.008.
For handover this procedure is executed according to 3G TS 49.008 with the
anchor MSC playing the role of the MSC and the non anchor 3G MSC playing the
role of the BSS.
The needed BSSMAP signalling is sent over the E-interface encapsulated in the
MAP messages Process Access Signalling and Forward Access Signalling.
At the non-anchor 3G MSC the received BSSMAP messages are mapped into the
corresponding RANAP messages to be sent to the RNS, and the received RANAP
messages are mapped into the corresponding BSSMAP messages to be sent over the
E-interface to the anchor MSC.
Once the BSSMAP procedure has been completed, the anchor MSC sends the DTAP
message LCS-MOLR Response encapsulated in the MAP message Forward Access
Signalling to the non anchor 3G MSC, which relays it to the UE.
The signalling for a completed request of Assistance Data or De-ciphering Keys
is shown in figures 67b.
MSC-A 3G MSC-B UE
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| PERFORM LOCATION \| \|
\| REQUEST) \| RNS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \|LOCATION RELATED \| \|
\| \| DATA REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to UE \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 67b: Signalling for the request of Assistance Data or De-ciphering Keys
When the UE requires the delivery of Assistance Data for the GPS Assisted
positioning method, the interworking between the BSSMAP messages encapsulated
in MAP and the RANAP messages is as follows:
\-----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| MAP FORWARD ACCESS SIG. LOCATION RELATED \|
message \| request DATA REQUEST \|
\| \|
\| -an-APDU( \|
\| PERFORM LOCATION REQUEST) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| Location Type. Requested Location \|
\| Location.Information Related Data Type \|
\| > location assistance >Dedicated Assistance \|
\| info for target MS Data for Assisted GPS\|
\| Location Type. \|
\| Positioning Method \| 1
\| > Assisted GPS \|
\| \|
\| \|
\| GPS Assistance Data Requested GPS \|
\| Assistance Data \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. LOCATION RELATED \|
\| request DATA RESPONSE \|
\| -an-APDU( \|
\| PERFORM LOCATION RESPONSE) \|
\| \|
\| BSSMAP information RANAP information \| 2
\| elements: elements: \|
\| \|
\| \|
\| \|
\| \|
NOTE 1: All other Positioning Method possibilities are not supported by UMTS
when Location Information is \"location assistance information for the target
MS\".
NOTE 2: The absence of the Cause IE in the RANAP message Location Related Data
Response is an indication that the requested assistance data has been
successfully delivered to the UE..
If the UE requires the delivery of Assistance Data for an UMTS specific
method, then the anchor MSC cannot forward the request to the non anchor 3G
MSC, and replies with the error \"System\"to the LCS-MOLR message.
If the anchor MSC sends a request for assistance data for a GSM specific
method in BSSMAP Perform Location Request encapsulated in MAP Forward Access
Signalling, then the non anchor 3G MSC replies immediately by generating and
encapsulating BSSMAP Perform Location Response with Cause \"System Failure\"
in MAP Process Access Signalling. This traffic case can happen if an LCS-MOLR
had been received in the anchor MSC before the initiation of the handover
procedure.
When the UE requires the delivery of De-ciphering Keys for the GPS Assisted
positioning method, the interworking between the BSSMAP messages encapsulated
in MAP and the RANAP messages is as follows:
\-----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| MAP FORWARD ACCESS SIG. LOCATION RELATED \|
message \| request DATA REQUEST \|
\| \|
\| -an-APDU( \|
\| PERFORM LOCATION REQUEST) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| Location Type. Requested Location \|
\| Location.Information Related Data Type \|
\| > deciphering keys > Deciphering Keys \|
\| for broadcast for Assisted GPS \|
\| assistance data \|
\| for the target MS \|
\| Location Type. \|
\| Positioning Method \| 1
\| > Assisted GPS \|
\| \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. LOCATION RELATED \|
\| request DATA RESPONSE \|
\| -an-APDU( \|
\| PERFORM LOCATION RESPONSE) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| Deciphering Keys Broadcast Assistance \|
\| Data Deciphering Keys\|
\| \|
\| \|
\| \|
NOTE 1: All other Positioning Method possibilities are not supported by UMTS
when Location Information is \"deciphering keys for broadcast assistance data
for the target MS\".
If the UE requires the delivery of De-ciphering Keys for an UMTS specific
method, then the anchor MSC cannot forward the request to the non anchor 3G
MSC, and replies with the error \"System\"to the LCS-MOLR message.
If the anchor MSC sends a request for De-ciphering Keys for a GSM specific
method in BSSMAP Perform Location Request encapsulated in MAP Forward Access
Signalling, then the non anchor 3G MSC replies immediately by generating and
encapsulating BSSMAP Perform Location Response with Cause \"System Failure\"
in MAP Process Access Signalling. This traffic case can happen if an LCS-MOLR
had been received in the anchor MSC before the initiation of the handover
procedure.
After the inter-MSC GSM to UMTS handover, the 3G MSC-B can perform intra-MSC
UMTS to GSM handover. Any request for Assistance Data or De-ciphering keys
received after completion of the intra-MSC UMTS to GSM handover is handled as
for Inter-MSC Handover GSM to GSM (see section 4.9.4.1).
#### 4.9.4.3 Inter-MSC Handover (UMTS to GSM)
After a successful Inter-MSC UMTS to GSM inter system handover, any request of
Assistance Data or De-ciphering keys received by the non-anchor MSC via the
DTAP message LCS-MOLR is forwarded to the anchor 3G MSC by encapsulating the
DTAP message into the MAP messages Process Access Signalling. The anchor 3G
MSC triggers the BSSMAP procedure Location Acquisition described in 3G TS
48.008. For handover this procedure is executed according to 3G TS 49.008 with
the anchor 3G MSC playing the role of the MSC and the non-anchor MSC playing
the role of the BSS.
The needed BSSMAP signalling is sent over the E-interface encapsulated in the
MAP messages Process Access Signalling and Forward Access Signalling.
At the non-anchor MSC the BSSMAP messages received from the anchor 3G MSC are
forwarded to the BSS, and the BSSMAP messages received from the BSS are sent
over the E-interface to the anchor 3G MSC.
Once the BSSMAP procedure has been completed, the anchor 3G MSC sends the DTAP
message LCS-MOLR Response encapsulated in the MAP message Forward Access
Signalling to the non-anchor MSC, which relays it to the UE.
The signalling for a completed request of Assistance Data or De-ciphering Keys
is shown in figures 67c.
3G MSC-A MSC-B MS
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| PERFORM LOCATION \| \|
\| REQUEST) \| BSS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| PERFORM LOCATION \| \|
\| \| REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to MS \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 67c: Signalling for the request of Assistance Data or De-ciphering Keys
After the inter-MSC UMTS to GSM handover, the 3G MSC-B can perform intra-MSC
GSM to UMTS handover. Any request for Assistance Data or De-ciphering keys
received after completion of the intra-MSC GSM to UMTS handover is handled as
for Inter-MSC Handover GSM to UMTS (see section 4.9.4.2)..
#### 4.9.4.4 Inter-MSC SRNS Relocation
After a successful Inter-MSC SRNS Relocation , any request of Assistance Data
or De-ciphering keys received by the non anchor 3G MSC via the DTAP message
LCS-MOLR is forwarded to the anchor 3G MSC by encapsulating the DTAP message
into the MAP messages Process Access Signalling. The anchor 3G MSC triggers
the RANAP procedure Location Related Data described in TS 25.413. For handover
this procedure is executed according to 23.009 with the anchor 3G-MSC playing
the role of the 3G-MSC and the non anchor 3G-MSC playing the role of the RNS.
The needed RANAP signalling is sent over the E-interface encapsulated in the
MAP messages Process Access Signalling and Forward Access Signalling.
At the non anchor 3G MSC the RANAP messages received from the anchor 3G MSC
are forwarded to the RNS, and the RANAP messages received from the RNS are
sent over the E-interface to the anchor 3G MSC.
Once the RANAP procedure has been completed, the anchor 3G MSC sends the DTAP
message LCS-MOLR Response encapsulated in the MAP message Forward Access
Signalling to the non anchor 3G MSC, which relays it to the UE.
The signalling for a completed request of Assistance Data or De-ciphering Keys
is shown in figures 67d.
3G MSC-A 3G MSC-B UE
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LOCATION RELATED \| \|
\| DATA REQUEST) \| RNS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| LOCATION RELATED \| \|
\| \| DATA REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to UE \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 67d: Signalling for the request of Assistance Data or De-ciphering Keys
After the inter-MSC SRNS Relocation, the 3G MSC-B can perform intra-MSC UMTS
to GSM handover. Any request for Assistance Data or De-ciphering keys received
after completion of the intra-MSC UMTS to GSM requires that at the non anchor
3G MSC the received RANAP messages are mapped into the corresponding BSSMAP
messages to be sent to the BSS, and the received BSSMAP messages are mapped
into the corresponding RANAP messages to be sent over the E-interface to the
anchor 3G-MSC. The signalling for a completed request of Assistance Data or
De-ciphering Keys in this traffic case is shown in figures 67e.
3G MSC-A 3G MSC-B UE
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LOCATION RELATED \| \|
\| DATA REQUEST) \| BSS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| PERFORM LOCATION \| \|
\| \| REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to MS \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 67e: Signalling for the request of Assistance Data or De-ciphering Keys
When the UE requires the delivery of Assistance Data for the GPS Assisted
positioning method, the interworking between the RANAP messages encapsulated
in MAP and the BSSMAP messages is as follows:
\-----------------------------------------------------------------
\| 29.002 48.008 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| MAP FORWARD ACCESS SIG. PERFORM LOCATION \|
message \| request REQUEST \|
\| \|
\| -an-APDU( \|
\| LOCATION RELATED \|
\| DATA REQUEST) \|
\| \|
\| RANAP information BSSMAP information \|
\| elements: elements: \|
\| \|
\| Requested Location Location Type. \|
\| Related Data Type Location Information \|
\| > Dedicated Assistance > location assistance \| 1
\| Data for Assisted info for target MS \|
\| GPS Location Type. \|
\| Positioning Method \|
\| > Assisted GPS \|
\| \|
\| Requested GPS GPS Assistance Data \|
\| Assistance Data \|
\| \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. PERFORM LOCATION \|
\| request RESPONSE \|
\| -an-APDU( \|
\| LOCATION RELATED \|
\| DATA RESPONSE) \|
\| \|
\| RANAP information BSSMAP information \| 2
\| elements: elements: \|
\| \|
\| \|
\| \|
\| \|
NOTE 1: All other Positioning Method possibilities are not supported by GSM
when Location Information is \"deciphering keys for broadcast assistance data
for the target MS\".
NOTE 2: The absence of the Cause IE in the BSSMAP message Perform Location
Response is an indicatioin that the requested assistance data has been
successfully delivered to the UE..
If the UE requires the delivery of Assistance Data for a GSM specific method,
then the anchor 3G-MSC cannot forward the request to the non anchor 3G MSC,
and replies with the error \"System\"to the LCS-MOLR message.
If the anchor 3G MSC sends a request for Assistance Data for an UMTS specific
method in RANAP Location Related Data Request encapsulated in MAP Forward
Access Signalling, then the non anchor 3G MSC replies immediately by
generating and encapsulating RANAP Location Related Data Failure with Cause
\"Unspecified Failure\" in MAP Process Access Signalling. This traffic case
can happen if an LCS-MOLR had been received in the anchor MSC before the
initiation of the intra-MSC handover procedure.
When the UE requires the delivery of De-ciphering Keys for the GPS Assisted
positioning method, the interworking between the RANAP messages encapsulated
in MAP and the BSSMAP messages is as follows:
\-----------------------------------------------------------------
\| 29.002 48.008 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| MAP FORWARD ACCESS SIG. PERFORM LOCATION \|
message \| request REQUEST \|
\| \|
\| -an-APDU( \|
\| LOCATION RELATED \|
\| DATA REQUEST) \|
\| \|
\| RANAP information BSSMAP information \|
\| elements: elements: \|
\| \|
\| Requested Location Location Type. \|
\| Related Data Type Location Information \|
\| > Deciphering Keys > deciphering keys \| 1
\| for Assisted GPS for broadcast \|
\| assistance data \|
\| for the target MS \|
\| Location Type. \|
\| Positioning Method \|
\| > Assisted GPS \|
\| \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. PERFORM LOCATION \|
\| request RESPONSE \|
\| -an-APDU( \|
\| LOCATION RELATED \|
\| DATA RESPONSE) \|
\| \|
\| RANAP information BSSMAP information \|
\| elements: elements: \|
\| \|
\| Broadcast Assistance Deciphering Keys \|
\| Data Deciphering Keys \|
\| \|
\| \|
\| \|
NOTE 1: All other Positioning Method possibilities are not supported by GSM
when Location Information is \"deciphering keys for broadcast assistance data
for the target MS\".
If the UE requires the delivery of De-ciphering Keys for a GSM specific
method, then the anchor 3G-MSC cannot forward the request to the non anchor 3G
MSC, and replies with the error \"System\"to the LCS-MOLR message.
If the anchor 3G MSC sends a request for De-ciphering Keys for an UMTS
specific method in RANAP Location Related Data Request encapsulated in MAP
Forward Access Signalling, then the non anchor 3G MSC replies immediately by
generating and encapsulating RANAP Location Related Data Failure with Cause
\"Unspecified Failure\" in MAP Process Access Signalling. This traffic case
can happen if an LCS-MOLR had been received in the anchor MSC before the
initiation of the intra-MSC handover procedure.
### 4.9.5 Request of Assistance Data or De-ciphering Keys: Failure Case
#### 4.9.5.1 Inter-MSC Handover (GSM to GSM)
After a successful Inter-MSC handover, any request of Assistance Data or De-
ciphering keys received by the non anchor MSC via the DTAP message LCS-MOLR is
handled as described in section 4.9.4.1.
If the request fails, either because the BSS-B cannot return the requested De-
ciphering Keys to the anchor MSC or cannot deliver the required Assistance
Data to the MS, the signalling is the same as for the successful case and is
shown in figure 67a.
After the inter-MSC handover, the MSC-B can perform intra-MSC GSM to UMTS
handover. Any request for Assistance Data or De-ciphering keys received after
completion of the intra-MSC GSM to UMTS handover is handled as for Inter-MSC
Handover GSM to UMTS (see section 4.9.4.2).
If the request fails the signalling is the same as for the failure case for
Inter-MSC Handover GSM to UMTS (see section 4.9.5.2)
#### 4.9.5.2 Inter-MSC Handover (GSM to UMTS)
After a successful Inter-MSC GSM to UMTS handover, any request of Assistance
Data or De-ciphering keys received by the non anchor 3G MSC via the DTAP
message LCS-MOLR is handled as described in section 4.9.4.2.
If the request fails, either because BSS-B cannot return the requested De-
ciphering Keys to the anchor MSC or because BSS‑B cannot deliver the required
Assistance Data to the MS, the signalling is as shown in figure 68a.
MSC-A 3G MSC-B UE
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| PERFORM LOCATION \| \|
\| REQUEST) \| RNS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \|LOCATION RELATED \| \|
\| \| DATA REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to UE \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 68a: Signalling for a failed request of Assistance Data or De-ciphering
Keys
When the delivery to the UE of Assistance Data for the GPS Assisted
positioning method fails, the interworking between the BSSMAP messages
encapsulated in MAP and the RANAP messages is as follows:
\-----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| \|
message \| \"For the forward messages please refer to the \|
\| corresponding table in section 4.9.4.2\" \|
\| \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. LOCATION RELATED \|
\| request DATA FAILURE \|
\| -an-APDU( \|
\| PERFORM LOCATION RESPONSE) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| LCS Cause Cause \|
\| > System Failure > Dedicated Assistance\|
\| Data Not Available \|
\| \|
\| \|
When the RNS-B cannot satisfy the request for De-ciphering Keys, the
interworking between the BSSMAP messages encapsulated in MAP and the RANAP
messages is as follows:
\-----------------------------------------------------------------
\| 29.002 25.413 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| \|
message \| \"For the forward messages please refer to the \|
\| corresponding table in section 4.9.4.2\" \|
\| \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. LOCATION RELATED \|
\| request DATA FAILURE \|
\| -an-APDU( \|
\| PERFORM LOCATION RESPONSE) \|
\| \|
\| BSSMAP information RANAP information \|
\| elements: elements: \|
\| \|
\| LCS Cause Cause \|
\| > System Failure > Deciphering Keys \|
\| Not Available \|
\| \|
After the inter-MSC GSM to UMTS handover, the 3G MSC-B can perform intra-MSC
UMTS to GSM handover. Any request for Assistance Data or De-ciphering keys
received after completion of the intra-MSC UMTS to GSM handover is handled as
for Inter-MSC Handover GSM to GSM (see section 4.9.4.1).
If the request fails the signalling is the same as for the failure case for
Inter-MSC Handover GSM to GSM (see section 4.9.5.1)
#### 4.9.5.3 Inter-MSC Handover (UMTS to GSM)
After a successful Inter-MSC UMTS to GSM handover, any request of Assistance
Data or De-ciphering keys received by the non anchor MSC via the DTAP message
LCS-MOLR is handled as described in section 4.9.4.3.
If the request fails, either because the BSS-B cannot return the requested De-
ciphering Keys to the anchor 3G MSC or BSS‑B cannot deliver the required
Assistance Data to the MS, the signalling is the same as for the successful
case and is shown in figure 67c.
After the inter-MSC UMTS to GSM handover, the 3G MSC-B can perform intra-MSC
GSM to UMTS handover. Any request for Assistance Data or De-ciphering keys
received after completion of the intra-MSC GSM to UMTS handover is handled as
for Inter-MSC Handover GSM to UMTS (see section 4.9.4.2)..
If the request fails the signalling is the same as for the failure case for
Inter-MSC Handover GSM to UMTS (see section 4.9.5.2)
#### 4.9.5.4 Inter-MSC SRNS Relocation
After a successful Inter-MSC SRNS Relocation , any request of Assistance Data
or De-ciphering keys received by the non anchor 3G MSC via the DTAP message
LCS-MOLR is handled as described in section 4.9.4.4.
If the request fails, either because the RNS-B cannot return the requested De-
ciphering Keys to the anchor 3G MSC or RNS‑B cannot deliver the required
Assistance Data to the MS, the signalling is shown in figure 68b.
3G MSC-A 3G MSC-B UE
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LOCATION RELATED \| \|
\| DATA REQUEST) \| RNS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| LOCATION RELATED \| \|
\| \| DATA REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to UE \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 68b: Signalling for the request of Assistance Data or De-ciphering Keys
After the inter-MSC SRNS Relocation, the 3G MSC-B can perform intra-MSC UMTS
to GSM handover. Any request for Assistance Data or De-ciphering keys received
after completion of the intra-MSC UMTS to GSM requires that at the non anchor
3G MSC the received RANAP messages are mapped into the corresponding BSSMAP
messages to be sent to the BSS, and the received BSSMAP messages are mapped
into the corresponding RANAP messages to be sent over the E-interface to the
anchor 3G-MSC.
If the request fails, either because the BSS-B cannot return the requested De-
ciphering Keys to the anchor 3G MSC or BSS‑B cannot deliver the required
Assistance Data to the MS, the signalling is as shown in figure 68c.
3G MSC-A 3G MSC-B UE
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LOCATION RELATED \| \|
\| DATA REQUEST) \| BSS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| PERFORM LOCATION \| \|
\| \| REQUEST \| \|
\| \| \| \|
\| \| +------------------------+
\| \| \| If Assistance Data were\|
\| \| \| requested then \|
\| \| \| Delivery of Assistance \|
\| \| \| Data to MS \|
\| \| +------------------------+
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 68c: Signalling for the request of Assistance Data or De-ciphering Keys
After the inter-MSC SRNS Relocation, the 3G MSC-B can perform intra-MSC UMTS
to GSM handover. Any request for Assistance Data or De-ciphering keys received
after completion of the intra-MSC UMTS to GSM requires that at the non anchor
3G MSC the received RANAP messages are mapped into the corresponding BSSMAP
messages to be sent to the BSS, and the received BSSMAP messages are mapped
into the corresponding RANAP messages to be sent over the E-interface to the
anchor 3G-MSC.
When the UE requires the delivery of Assistance Data for the GPS Assisted
positioning method, the interworking between the RANAP messages encapsulated
in MAP and the BSSMAP messages is as follows:
\-----------------------------------------------------------------
\| 29.002 48.008 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| \|
message \| \"For the forward messages please refer to the \|
\| corresponding table in section 4.9.4.4\" \|
\| \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. PERFORM LOCATION \|
\| request RESPONSE \|
\| -an-APDU( \|
\| LOCATION RELATED \|
\| DATA FAILURE) \|
\| \|
\| RANAP information BSSMAP information \|
\| elements: elements: \|
\| \|
\| Cause LCS Cause \|
\| > Dedicated Assistance > \ \|
\| Data Not Available \|
\| \|
When the UE requires the delivery of De-ciphering Keys for the GPS Assisted
positioning method, the interworking between the RANAP messages encapsulated
in MAP and the BSSMAP messages is as follows:
\-----------------------------------------------------------------
\| 29.002 48.008 \|Notes
\--------┼--------------------------------------------------┼-----
Forward \| \|
message \| \"For the forward messages please refer to the \|
\| corresponding table in section 4.9.4.4\" \|
\| \|
\--------┼--------------------------------------------------┼-----
Result \| MAP PROCESS ACCESS SIG. PERFORM LOCATION \|
\| request RESPONSE \|
\| -an-APDU( \|
\| LOCATION RELATED \|
\| DATA FAILURE) \|
\| \|
\| RANAP information BSSMAP information \|
\| elements: elements: \|
\| \|
\| Cause LCS Cause \|
\| > Deciphering Keys > \ \|
\| Not Available \|
### 4.9.6 Abort of Request of Assistance Data or De-ciphering Keys:
#### 4.9.6.1 Inter-MSC Handover (GSM to GSM)
After a successful Inter-MSC handover, any request of Assistance Data or De-
ciphering keys received by the non anchor MSC via the DTAP message LCS-MOLR is
handled as described in section 4.9.4.1.
If the request is aborted by the anchor MSC the signalling is as shown in
figure 69a.
MSC-A MSC-B MS
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| PERFORM LOCATION \| \|
\| REQUEST) \| BSS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| PERFORM LOCATION \| \|
\| \| REQUEST \| \|
\| \| \| \|
\|MAP FORWARD ACCESS \| \| \|
\| SIGNALLING \| \| \|
\|-------------------->\| \| \|
\| -an-APDU( \| \| \|
\| PERFORM LOCATION \| \| \|
\| ABORT) \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \| PERFORM LOCATION \| \|
\| \| ABORT \| \|
\| \| \| \|
\| \|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 69a: Signalling for the abortion of a request for Assistance Data or
De-ciphering Keys
After the inter-MSC handover, the MSC-B can perform intra-MSC GSM to UMTS
handover. Any request for Assistance Data or De-ciphering keys received after
completion of the intra-MSC GSM to UMTS handover is handled as for Inter-MSC
Handover GSM to UMTS (see section 4.9.4.2).
If the request is aborted the signalling is the same as for the abortion case
for Inter-MSC Handover GSM to UMTS (see section 4.9.6.2)
#### 4.9.6.2 Inter-MSC Handover (GSM to UMTS)
After a successful Inter-MSC GSM to UMTS handover, any request of Assistance
Data or De-ciphering keys received by the non anchor MSC via the DTAP message
LCS-MOLR is handled as described in section 4.9.4.1.
If the request is aborted by the anchor MSC the signalling is as shown in
figure 69b.
MSC-A 3G MSC-B UE
\| \| \|
\| \| \|
\| \| \|
\| \| LCS-MOLR \|
\| \|\\| \|
\| -an-APDU( \| \|
\| PERFORM LOCATION \| \|
\| REQUEST) \| RNS-B \|
\| \| \|
\| \| \| \|
\| \|----------------->\| \|
\| \| \| \|
\| \|LOCATION RELATED \| \|
\| \| DATA REQUEST \| \|
\| \| \| \|
\| \| \| \|
\|MAP FORWARD ACCESS \| \| \|
\| SIGNALLING \| \| \|
\|-------------------->\| \| \|
\| -an-APDU( \| \| \|
\| PERFORM LOCATION \| \| \|
\| ABORT) \| \| \|
\| \| \| \|
\| \| \| \|
\|MAP PROCESS ACCESS \| \| \|
\| SIGNALLING \| \| \|
\|\\| \|
\| -an-APDU( \| \|
\| LCS-MOLR Response) \| \|
\| \| \|
\| \| LCS-MOLR Response \|
\| \|-------------------------------------->\|
\| \| \|
Figure 69b: Signalling for the abortion of the request for Assistance Data or
De-ciphering Keys
There\"s no interworking between the BSSMAP Perform Location Abort and any
RANAP message since it is not possible to abort a request for Assistance Data
or De-ciphering Keys with RANAP. The BSSMAP message Perform Location Response
is generated by the non-anchor 3G MSC.
After the inter-MSC GSM to UMTS handover, the 3G MSC-B can perform intra-MSC
UMTS to GSM handover. Any request for Assistance Data or De-ciphering keys
received after completion of the intra-MSC UMTS to GSM handover is handled as
for Inter-MSC Handover GSM to GSM (see section 4.9.4.1).
If the request is aborted the signalling is the same as for the abortion case
for Inter-MSC Handover GSM to GSM (see section 4.9.6.1)
#### 4.9.6.3 Inter-MSC Handover (UMTS to GSM)
After a successful Inter-MSC UMTS to GSM handover, any request of Assistance
Data or De-ciphering keys received by the non anchor MSC via the DTAP message
LCS-MOLR is handled as described in section 4.9.4.3.
If the request is aborted by the anchor 3G MSC the signalling is the same as
for the abortion for Inter-MSC GSM to GSM handover abd is shown in figure 69a.
After the inter-MSC UMTS to GSM handover, the 3G MSC-B can perform intra-MSC
GSM to UMTS handover. Any request for Assistance Data or De-ciphering keys
received after completion of the intra-MSC GSM to UMTS handover is handled as
for Inter-MSC Handover GSM to UMTS (see section 4.9.4.2)..
If the request is aborted the signalling is the same as for the abortion case
for Inter-MSC Handover GSM to UMTS (see section 4.9.6.2)
#### 4.9.6.4 Inter-MSC SRNS Relocation
After a successful Inter-MSC SRNS Relocation , any request of Assistance Data
or De-ciphering keys received by the non anchor 3G MSC via the DTAP message
LCS-MOLR is handled as described in section 4.9.4.4.
The request cannot be aborted by the 3G anchor MSC since RANAP does not
support abortion of a request for Assistance Data or De-Ciphering Keys.
## 4.10 Single Radio Voice Call Continuity (SRVCC)
### 4.10.1 General
The general principles of the SRVCC handover procedures are specified in 3GPP
TS 23.009 [2]. This clause provides a detailed specification for the
interworking performed by the MSC Server enhanced for SRVCC. It defines in
particular the encoding of RANAP and BSSMAP cause values to avoid different
encodings in different implementations.
### 4.10.2 SRVCC Handover from UTRAN (HSPA) to GERAN
**Encoding of the cause code sent in BSSMAP Handover Request:**
When it receives the SRVCC PS to CS Request message from the SGSN (see 3GPP TS
29.280 [25]), the MSC Server enhanced for SRVCC shall set the BSSMAP Cause to
the value \'Uplink quality\' in the Handover Request message.
### 4.10.3 SRVCC Handover from UTRAN (HSPA) to UTRAN
**Encoding of the cause code sent in RANAP Relocation Request:**
When it receives the SRVCC PS to CS Request message from the SGSN (see 3GPP TS
29.280 [y]), the MSC Server enhanced for SRVCC shall set the RANAP Cause to
the value \'Time critical Relocation \' in the Relocation Request message.
### 4.10.4 SRVCC Handover from E-UTRAN to GERAN
**Encoding of the cause code sent in BSSMAP Handover Request:**
When it receives the SRVCC PS to CS Request message from the MME (see 3GPP TS
29.280 [25]), the MSC Server enhanced for SRVCC shall set the BSSMAP Cause to
the value \'Uplink quality\' in the Handover Request message.
### 4.10.5 SRVCC Handover from E-UTRAN to UTRAN
**Encoding of the cause code sent in RANAP Relocation Request:**
When it receives the SRVCC PS to CS Request message from the MME (see 3GPP TS
29.280 [25]), the MSC Server enhanced for SRVCC shall set the RANAP Cause to
the value \'Time critical Relocation \' in the Relocation Request message.
# 5 Interworking in the MME
## 5.1 General
This subclause provides a detailed specification for the interworking
performed by the MME.
## 5.2 Void
## 5.3 Interworking between RANAP protocol messages and S1AP protocol messages
This subclause defines a mapping of RANAP and S1AP cause values used in
connection with inter RAT Handover to avoid different mappings in different
implementations.
**Inter RAT Handover from UTRAN to LTE:**
Table 5.3.1 defines a cause value mapping performed by the MME when the MME
receives the Forward Relocation Request message from the S4-SGSN.
Table 5.3.1: Cause value mapping from RANAP Cause to S1AP Cause
* * *
25.413 [7] 36.413 [21]  
RELOCATION REQUIRED (RANAP Cause) HANDOVER REQUEST (S1AP Cause)  
Group Value Group Value Radio Network Layer Cause Time critical Relocation
Radio Network Layer Cause Time critical handover Radio Network Layer Cause
Resource Optimisation Relocation Radio Network Layer Cause Resource
optimisation handover Radio Network Layer Cause Reduce Load in Serving Cell
Radio Network Layer Cause Reduce load in serving cell Any other value Radio
Network Layer Cause Handover Desirable for Radio Reasons
* * *
**For inter RAT handover from UTRAN served by Gn/Gp-SGSN to LTE,** the MME
maps the RANAP cause in the GTPv1 Forward Relocation Request message to an
S1AP cause as per Table 5.3.1. The MME sends this S1AP cause in the S1AP
Handover Request message to the eNodeB.
**For inter RAT handover from UTRAN served by Gn/Gp-SGSN to LTE, if the
handover fails in the LTE access, the MME maps the S1AP cause in the S1AP
Handover Failure message to a RANAP cause by using the mapping in Table 6.2.1.
The MME uses the RANAP cause in the GTPv1 Forward Relocation Response message
to the Gn/Gp-SGSN.**
**Inter RAT Handover from LTE to UTRAN:**
The table 5.3.2 defines a cause value mapping performed by the MME when the
MME receives the Forward Relocation Response message from the S4-SGSN. This
mapping is only needed if the inter RAT Handover failed in UTRAN.
Table 5.3.2: Cause value mapping from RANAP Cause to S1AP Cause for failure
case
* * *
25.413 [7] 36.413 [21]  
RELOCATION FAILURE (RANAP Cause) HANDOVER PREPARATION FAILURE (S1AP Cause)  
Group Value Group Value Radio Network Layer Cause No Radio Resources Available
in Target Cell Radio Network Layer Cause No Radio Resources Available in
Target Cell Radio Network Layer Cause Requested Ciphering and/or Integrity
Protection algorithms not supported Radio Network Layer Cause Encryption
and/or integrity protection algorithms not supported Radio Network Layer Cause
Traffic Load In The Target Cell Higher Than In The Source Cell Radio Network
Layer Cause No Radio Resources Available in Target Cell Miscellaneous Cause
O&M Intervention Miscellaneous Cause O&M Intervention Any other value Radio
Network Layer Cause Handover Failure In Target EPC/eNB Or Target System
* * *
**For inter RAT handover from LTE to UTRAN served by Gn/Gp-SGSN,** the MME
maps **the S1AP cause in S1AP Handover Required message to a RANAP cause by
using the mapping in Table 6.2.2. The MME uses this RANAP cause in the GTPv1
Forward Relocation Request message to the Gn/Gp-SGSN.**
**For inter RAT handover from LTE to UTRAN served by Gn/Gp-SGSN, if the
handover fails in the UTRAN access, the MME maps the RANAP cause received in
the GTPv1 Forward Relocation Response message to an S1AP cause as per Table
5.3.2. The MME sends this S1AP cause in the S1AP Handover Preparation Failure
message to the eNodeB.**
## 5.4 Interworking between BSSGP protocol messages and S1AP protocol messages
This subclause defines a mapping of BSSGP and S1AP cause values used in
connection with inter RAT Handover to avoid different mappings in different
implementations.
**Inter RAT Handover from GERAN to LTE:**
Table 5.4.1 defines a cause value mapping performed by the MME when the MME
receives the GTPv2 Forward Relocation Request message from the S4-SGSN or the
GTPv1 Forward Relocation Request message from Gn/Gp-SGSN (as per Annex D of
3GPP TS 23.401[22]).
NOTE1: The mapping in Table 5.4.1 has been derived based on Table 15.1 in 3GPP
TS 29.060 [23] and Table 5.3.1 in this specification.
Table 5.4.1: Cause value mapping from BSSGP Cause to S1AP Cause
* * *
48.018 [24] 36.413 [21]  
PS HANDOVER REQUIRED (BSSGP Cause) HANDOVER REQUEST (S1AP Cause)  
Value Group Value Uplink quality Radio Network Layer Cause Time critical
handover Uplink strength Radio Network Layer Cause Time critical handover
Downlink quality Radio Network Layer Cause Time critical handover Downlink
strength Radio Network Layer Cause Time critical handover Distance Radio
Network Layer Cause Time critical handover Traffic Radio Network Layer Cause
Resource optimisation handover Cell traffic congestion Radio Network Layer
Cause Reduce load in serving cell Any other value Radio Network Layer Cause
Handover Desirable for Radio Reasons
* * *
**For inter RAT handover from GERAN served by Gn/Gp-SGSN to LTE, if the
handover fails in the LTE access, the MME maps the S1AP cause in S1AP Handover
Failure message to a RANAP cause by using the mapping in Table 6.2.1. The MME
uses the RANAP cause in the GTPv1 Forward Relocation Response message to the
Gn/Gp-SGSN. The Gn-Gp/SGSN maps the RANAP cause to a BSSGP cause as per Table
15.2 in 3GPP TS 29.060** [23] and sends this BSSGP cause in the BSSGP PS
Handover Required Nack message**.**
**Inter RAT Handover from LTE to GERAN:**
Table 5.4.2 defines a cause value mapping performed by the MME when the MME
receives the GTPv2 Forward Relocation Response message from the S4-SGSN or the
GTPv1Forward Relocation Response message from the Gn/Gp-SGSN (as per Annex D
of 3GPP TS 23.401[22]). This mapping is only needed if the inter RAT Handover
failed in GERAN.
NOTE2: The mapping in Table 5.4.2 has been derived based on Table 15.4 in 3GPP
TS 29.060 [23] and Table 5.3.2 in this specification.
Table 5.4.2: Cause value mapping from BSSGP Cause to S1AP Cause for failure
case
+----------------------+----------------------+----------------------+ | 48.018 [24] | 36.413 [21] | | +----------------------+----------------------+----------------------+ | PS HANDOVER REQUEST | HANDOVER PREPARATION | | | NACK | FAILURE | | | | | | | (BSSGP Cause) | (S1AP Cause) | | +----------------------+----------------------+----------------------+ | Value | Group | Value | +----------------------+----------------------+----------------------+ | Cell traffic | Radio Network Layer | No Radio Resources | | congestion | Cause | Available in Target | | | | Cell | +----------------------+----------------------+----------------------+ | O&M intervention | Miscellaneous Cause | O&M Intervention | +----------------------+----------------------+----------------------+ | Any other value | Radio Network Layer | Handover Failure In | | | Cause | Target EPC/eNB Or | | | | Target System | +----------------------+----------------------+----------------------+
**For inter RAT handover from LTE to GERAN served by Gn/Gp-SGSN, the MME maps
the S1AP cause in S1AP Handover Required message to a RANAP cause by using the
mapping in Table 6.2.2. The MME uses the RANAP cause in the GTPv1 Forward
Relocation Request message to the Gn/Gp-SGSN. The Gn-Gp/SGSN maps the RANAP
cause to a BSSGP cause as per Table 15.3 in 3GPP TS 29.060** [23] and sends
this BSSGP cause in the BSSGP PS Handover Request message**.**
# 6 Interworking in the S4-SGSN
## 6.1 General
This subclause provides a detailed specification for the interworking
performed by the S4-SGSN.
## 6.2 Interworking between RANAP protocol messages and S1AP protocol messages
This subclause defines a mapping of RANAP and S1AP cause values used in
connection with inter RAT Handover to avoid different mappings in different
implementations.
**Inter RAT Handover from UTRAN to LTE:**
The table 6.2.1 defines a cause value mapping performed by the S4-SGSN when
the S4-SGSN receives the Forward Relocation Response message from the MME.
This mapping is only needed if the inter RAT Handover failed in LTE.
Table 6.2.1: Cause value mapping from S1AP Cause to RANAP Cause for failure
case
* * *
36.413 [21] 25.413 [7]  
HANDOVER FAILURE (S1AP Cause) RELOCATION PREPARATION FAILURE (RANAP Cause)  
Group Value Group Value Radio Network Layer Cause No Radio Resources Available
in Target Cell Radio Network Layer Cause No Radio Resources Available in
Target Cell Radio Network Layer Cause Encryption and/or integrity protection
algorithms not supported Radio Network Layer Cause Requested Ciphering and/or
Integrity Protection algorithms not supported Miscellaneous Cause O&M
Intervention Miscellaneous Cause O&M Intervention Any other value Radio
Network Layer Cause Relocation Failure in Target CN/RNC or Target System
* * *
**Inter RAT Handover from LTE to UTRAN:**
Table 6.2.2 defines a cause value mapping performed by the S4-SGSN when the
S4-SGSN receives the Forward Relocation Request message from the MME.
**Table 6.2.2: Cause value mapping from S1AP Cause to RANAP Cause**
* * *
36.413 [21] 25.413 [7]  
HANDOVER REQUIRED (S1AP Cause) RELOCATION REQUEST (RANAP Cause)  
Radio Network Layer Cause Handover Desirable for Radio Reasons Radio Network
Layer Cause Relocation Desirable for Radio Reasons Radio Network Layer Cause
Time Critical Handover Radio Network Layer Cause Time critical Relocation
Radio Network Layer Cause Reduce Load in Serving Cell Radio Network Layer
Cause Reduce Load in Serving Cell Any other value Radio Network Layer Cause
Resource Optimized Relocation
* * *
## 6.3 Interworking between BSSGP protocol messages and S1AP protocol messages
This subclause defines a mapping of BSSGP and S1AP cause values used in
connection with inter RAT Handover to avoid different mappings in different
implementations.
**Inter RAT Handover from GERAN to LTE:**
Table 6.3.1 defines a cause value mapping performed by the S4-SGSN when the
S4-SGSN receives the GTPv2 Forward Relocation Response message from the MME.
NOTE1: The mapping in Table 6.3.1 has been derived based on Table 6.2.1 in
this specification and Table 15.2 in 3GPP TS 29.060 [23].
Table 6.3.1: Cause value mapping from S1AP Cause to BSSGP Cause for failure
case
* * *
36.413 [21] 48.018 [24]  
HANDOVER FAILURE (S1AP Cause) PS HANDOVER REQUIRED NACK (BSSGP Cause)  
Group Value Value Radio Network Layer Cause No Radio Resources Available in
Target Cell Cell traffic congestion Radio Network Layer Cause Encryption
and/or integrity protection algorithms not supported Requested ciphering
and/or integrity protection algorithms not supported Miscellaneous Cause O&M
Intervention O&M Intervention Any other value Relocation failure in target
system
* * *
**Inter RAT Handover from LTE to GERAN:**
Table 6.3.2 defines a cause value mapping performed by the S4-SGSN when the
S4-SGSN receives the GTPv2 Forward Relocation Request message from the MME.
NOTE2: The mapping in Table 6.3.2 has been derived based on Table 6.2.2 in
this specification and Table 15.3 in 3GPP TS 29.060 [23].
Table 6.3.2: Cause value mapping from S1AP Cause to BSSGP Cause
* * *
36.413 [21] 48.018 [24]  
HANDOVER REQUIRED (S1AP Cause) PS HANDOVER REQUEST (BSSGP Cause)  
Group Value Value Radio Network Layer Cause Handover Desirable for Radio
Reasons Better cell Radio Network Layer Cause Time Critical Handover Time
critical relocation Radio Network Layer Cause Reduce Load in Serving Cell Cell
traffic congestion Any other value Traffic
* * *
## 6.4 Interworking between BSSGP protocol messages and RANAP protocol
messages
For the mapping of BSSGP and RANAP cause values used in connection with inter
RAT Handover between GERAN and UTRAN, the mapping tables in Section 15 in 3GPP
TS 29.060 [23] applies. The mapping is performed by the target S4-SGSN.
#