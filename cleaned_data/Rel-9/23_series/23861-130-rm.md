# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
Release 8 EPS introduced a multi access 3GPP system where different
heterogeneous access systems are connected to a common core network. However,
in Release 8 EPS, the subscriber cannot communicate using multiple accesses
simultaneously. The subscriber can establish a single PDN connection or
multiple simultaneous PDN connections in Release 8 EPS, but all the traffic
exchanged by the subscriber, regardless of the PDN connection it belongs to,
is routed through the same access system. Similarly, Release 8 introduced
mobility enhancements to the I-WLAN architecture to support session continuity
for any application between 3GPP and I-WLAN accesses. However, also in this
case it is not possible for the subscribers to communicate using 3GPP and
I-WLAN accesses simultaneously.
Devices with multiple interfaces (e.g. 3GPP , WiFi, WiMAX etc.) are becoming
commonly available and the set of applications running in the mobile devices
is diversifying with some applications suited to run over 3GPP access systems
and other applications well suited to run over some other - complementary -
access systems (e.g. ftp transfer via WiFi in parallel to VoIP over LTE).
The scope of this document is to study the scenarios, requirements and
solutions for UEs with multiple interfaces which will simultaneously connect
to 3GPP access and one, and only one, non-3GPP access. Solutions to be studied
include the possibility of dynamically routeing to specific accesses
individual flows generated by the same or different applications belonging to
the same PDN connection. The study of solutions to support routeing of
different PDN connections through different access systems is also in the
scope of this TR. This study item also investigates the mechanisms for
provisioning the UE with operator's policies for multi access PDN connectivity
and flow mobility. This study item doesn't include the scenario where the same
IP flow is routed via different access system simultaneously.
Scenarios and solutions described in this document are applicable
independently of whether IMS or non-IMS applications are used.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".
[3] 3GPP TS 23.327: \"Mobility between 3GPP-WLAN interworking and 3GPP
systems\".
[4] IETF Internet-Draft, draft-ietf-monami6-multiplecoa-11.txt, \"Multiple
Care-of Addresses Registration\", work in progress.
[5] IETF Internet-Draft, draft-ietf-mext-flow-binding-01.txt, \"Flow Bindings
in Mobile IPv6 and Nemo Basic Support\", work in progress.
[6] IETF Internet-Draft, draft-ietf-mext-nemo-v4traversal-07.txt, \"Mobile
IPv6 support for dual stack Hosts and Routers (DSMIPv6)\", work in progress.
[7] 3GPP TS 23.203: \"Policy and Charging Control Architecture\".
[8] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following definitions apply.
**routing filter:** A set of packet flow IP header parameter values/ranges
used to identify IP flows for routing purposes
**routing address** : A routable IP address. In DSMIPv6 this is either the CoA
(visited link case) or the HoA (in home link case)
**routing rule:** The association of routing filter with a routing address
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
# 4 Use cases
## 4.1 Introduction
This subclause describes some scenarios where the UE is connected to the EPS
via different accesses simultaneously, sending and receiving different IP
flows through different accesses.
NOTE: The following use cases are valid in the direction from 3GPP to non-3GPP
accesses and vice versa, even when not explicitly stated.
## 4.2 Use Case 1
Michael is at home where both 3GPP access and a trusted or untrusted non-3GPP
access are available. As an example, the non-3GPP access may be a domestic
WiFi hotspot. Michael is accessing different services with different
characteristics in terms of QoS requirements and bandwidth:
\- a Video Telephony call,
\- a media file synchronization (e.g. a podcast and downloading of a TV
series),
\- a non-conversational video streaming (e.g. IPTV), and
\- a p2p download.
Some of these flows may be from the same application (e.g. the Video Telephony
may be via a virtual private network tunnel). Based on operator's policies,
the user's preferences and the characteristics of the application and the
accesses, the IP flows are routed differently; as an example, the audio media
(conversational voice) of the VT call and the video streaming are routed via
3GPP access, while the video media (conversational video (live streaming)) of
the VT, the p2p download (best effort) and media file synchronization are
routed through the non-3GPP access. The scenario is depicted in Figure 4.1-1.
Figure 4.1-1: Routeing of different IP flows through different accesses
After a while Michael moves out of the home and loses the non-3GPP
connectivity. Triggered by this event, the IP flows need to be moved to the
3GPP access which is the only access available. Figure 4.1-2 shows how the IP
flows are redistributed when the non-3GPP access is no longer available.
Figure 4.1-2: UE moves out from non-3GPP access and the IP flows are moved to
3GPP
Later Michael goes back home, or moves to another location where both 3GPP and
non-3GPP connectivity are available. Triggered by this event, the video media
of the VT, the p2p download and the media file synchronization are moved back
to the non-3GPP access. As a result, the scenario depicted in Figure 4.1-1 is
restored.
## 4.3 Use Case 2
Michael is spending time by hanging out with an online friend via a multimedia
session. They have a VoIP session (conversational voice) combined with video
(conversational video). During the multimedia session Michael browses web
(best effort) and occasionally watches cool video clips (Non conversational
video). Based on the operator policy the VoIP flow and conversational video
are routed via 3GPP access, while the non conversational video and best effort
IP flows are routed via Non 3GPP. At 2am, Michael's device starts ftp file
synchronization with a backup server (best effort) (Figure 4.2-1).
Figure 4.2-1: Splitting of IP flows based on operator's policies
Due to the ftp synchronization, the non 3GPP access becomes congested and the
non conversational video flows are moved to 3GPP access. (Figure 4.2-2)
Figure 4.2-2: Movement of one IP flow due to network congestion
Later as the Http server response time for the web browsing session (best
effort) is detected to have increased, also the best effort web browsing is
moved to 3GPP access. Only the ftp file synchronization is left to Non 3GPP
access (Figure 4.2-3).
Figure 4.2-3: Further movement of IP flows due to network congestion
At 2:15am the ftp synchronization completes and the non conversation video and
Web browsing are moved back to Non 3GPP access (Figure 4.2-4).
Figure 4.2-4: Distribution of IP flows after network congestion is over
# 5 Service requirements
Based on the use cases discussed in the previous clause, the following
potential requirements, applying to both EPS and I-WLAN mobility, can be
identified:
\- Service continuity should be provided when the UE moves from the 3GPP
access to non-3GPP access and vice versa.
\- If the UE is under the coverage of more than one access, including 3GPP and
non-3GPP accesses, it should be possible for the UE to communicate using
multiple accesses simultaneously if the UE is authorized by subscription to
access all of the involved PDNs and all of the involved access networks..
\- It should be possible to select one access when a flow is started and re-
distribute the flows to/from a UE between accesses while connected.
\- It should be possible for the operator to enable and control the
simultaneous usage of multiple accesses.
\- It should be possible to distribute flows to/from a UE between available
accesses based on the characteristics of the flows and the capabilities of the
available accesses, subjected to user\'s preferences and operator\'s policies.
For example, when both 3GPP and non-3GPP accesses are available, flows with
high QoS requirements (e.g. voice) may not be routed through the non-3GPP
access, in order to prevent loss of service.
\- It should be possible for the operator to define policies for the control
of the distribution of IP flows between available accesses. Each policy shall
include a list of preferred accesses and whether the policy may be overridden
by the user\'s preferences.
NOTE: The possibility of manual selection or user override is not precluded.
> These policies may be defined per APN, per IP flow class under any APN or
> per IP flow class under a specific APN. The IP flow class identifies a type
> of service (e.g. IMS voice) or an operator defined aggregation of services.
>
> The policies apply with the following priority order:
  1. Policies per IP flow class under a specific APN.
  2. Policies per IP flow class under any APN.
  3. Policies per APN.
\- Distribution of flows to/from a UE between available accesses based on the
characteristics of the flows and/or the capabilities of the available accesses
should be possible for flows exchanged by both operator controlled (e.g. IMS)
and non operator controlled (e.g. web and mail access) applications/services.
\- It should be possible to move all the flows to/from a UE out of a certain
access in case the UE loses connectivity with that access (e.g. UE moves out
of coverage of a non-3GPP access while maintaining connectivity through the
3GPP access).
\- Re-distribution of flows to/from a UE between accesses may be triggered by
changes to the characteristics of the flows (e.g. QoS requirements) or the
capabilities of the available accesses (e.g. due to network congestion,
mobility event, or UE discovers a new access) during the connection.
Simultaneous active mode of operation is an optional capability for multimode
UEs, which support 3GPP and non 3GPP accesses. UE supporting simultaneous
active mode of operation between one set of technologies may not be capable to
support simultaneous active mode of operation between a different technology
set (e.g. due to radio interference limitations).
# 6 Architectural requirements and assumptions
Editor's Note: This clause will identify the architectural requirements and
assumptions.
## 6.1 Architectural requirements
Multi Access PDN connectivity and IP flow mobility shall be possible both for
EPS and I-WLAN mobility architectures.
The impacts to the existing functionality and to the access systems shall be
minimized.
It should be possible for a multi-radio UE that is able to simultaneously
connect to a given PDN via different access systems, to move individual
service data flows from one radio access technology to another in a seamless
manner (i.e. without unnecessary disturbance of the user experience).
Editors note: This requirements may overlap with the service requirements. It
needs to be clarified.
It should be possible for EPS/I-WLAN mobility to support simultaneous access
to a single PDN via different access networks.
For accesses under control of the home operator, it shall be possible for the
network to detach the UE from the current access network(s) through which the
UE simultaneously accesses the EPC.
## 6.2 Architectural assumptions
Figures 6.2-1 and 6.2-2 show the baseline architecture reference model for
multi access PDN connectivity and IP flow mobility when EPS is deployed in the
non roaming case. Figure 6.2-1 shows the EPS architecture when S2c is used and
the Figure 6.2-2 shows the EPS architecture when S2a or S2b are used. Similar
architectures in the roaming case for both LBO and non-LBO traffic are
available in TS 23.402 [2].
Figure 6.2-1: Non-Roaming Architecture within EPS using S5, S2c
Figure 6.2-2: Non-Roaming Architecture within EPS using S5, S2a, S2b
Figure 6.2-3 shows the baseline architecture reference model for the multi-
access PDN connectivity and IP flow mobility based on the I-WLAN mobility
architecture as specified in TS 23.327 [3].
Figure 6.2-3: Architecture reference model based on I-WLAN mobility (non
roaming)
# 7 Solutions for multi access PDN connectivity and IP flow mobility
Editor's Note: This clause will describe the proposed solutions for the use
cases identified in subclause 4.
## 7.1 IP flow mobility solutions for S2c/H1 (DSMIPv6)
### 7.1.1 Solution A: Routeing filters in DSMIPv6
#### 7.1.1.1 Overview
In Rel-8 _EPS_ and _I-WLAN Mobility_ the granularity of access system
connectivity and inter system mobility is per PDN connection basis. To handle
IP flow mobility the PDN connectivity (i.e. mobility of IP flows within one
single PDN connection) mobility would need to be handled per IP flows. Table
7.1.1-1 indicates the basic required enhancements:
Table 7.1.1-1
* * *
                                                   Rel-8 system   System with IP Flow mobility
**Inter-system mobility** Per UE Per IP flows within PDN connection **PCC
logic & IP-CAN specific PCC signalling** Per IP-CAN Per IP flows within IP-CAN
**ANDSF Inter System Mobility policies** Per UE Per IP flow classes within UE
* * *
NOTE: Even though the S5/S8 GTP signalling is per bearer basis, and the inter-
system mobility signalling is per PDN connection basis, the granularity of the
intersystem mobility in Rel-8 is per UE basis (i.e. the UE moves always all
the entire PDN connections when handing over to one access). Annex A of the TR
presents the enhancements needed to have a PDN connection level inter-system
mobility.
This solution is based on enhancing the inter-system mobility signalling in
order to carry routeing filters. The extensions to DSMIPv6 mobility signalling
needed to carry routeing filters when the UE is connected to multiple accesses
simultaneously are specified in [4] and [5] and are applicable to S2c and H1.
The PCC interactions are optional and applicable only to S2c. In this solution
the functional split between mobility signalling and PCC signalling is kept
the same as in Release 8:
\- Mobility signalling is used to provide routeing information for existing IP
flows.
\- PCC signalling is used to provide SDF level QoS rules to the appropriate
gateways based on the current routeing of IP flows.
The details of the ANDSF enhancements are discussed in sub clause 7.3.
#### 7.1.1.2 DSMIPv6 enhancements
In this solution, when a UE configures different IPv6 global addresses on
multiple accesses, it can register these addresses with the PDNGW/HA as CoAs
using multiple bindings as specified in [4].
To register multiple bindings, the UE generates a Binding ID (BID) for each
CoA and stores the BID in the binding update list. The UE then registers its
CoAs by sending a Binding Update (BU) with a Binding Identifier mobility
option. The BID is included in the Binding Identifier mobility option.
When the PDNGW/HA receives the BU with a Binding Identifier mobility option,
it copies the BID from the mobility option to the corresponding field in the
Binding Cache entry. If there is an existing Binding Cache entry for the MN,
and if the BID in the BU does not match the one with the existing entry, the
HA creates a new Binding Cache entry for the new CoA and BID.
Based on this extension, a typical Binding Cache in PDNGW/HA according to this
specification is shown in Table 7.1.1-2.
NOTE: A BID is only unique for a given HoA, i.e. different mobile nodes can
use the same BID value.
Table 7.1.1-2: Binding Cache in PDNGW/HA supporting multiple CoAs registration
* * *
Home Address Care-of Address Binding ID HoA1 CoA1 BID1 HoA1 CoA2 BID2 ... ...
...
* * *
In order to route IP flows through one access, the UE needs to request to
store routeing filters for that access at the PGW/HA: the UE includes the
\'Flow Identification\' (FID) mobility option in the BU message as defined in
[5]. The routeing filters are unidirectional and can be different for uplink
and downlink traffic.
It is assumed that between UE and the Home Agent function there is always a
default routeing address via which packets not matching any specific routeing
filter are routed.
A typical Binding Cache in PDNGW/HA with routeing filters is shown in Table
7.1.1-3. Note that a FID is only unique for a given HoA, i.e. different PDN
connections can use the same FID value.
Table 7.1.1-3: Binding Cache in PDNGW/HA supporting flow bindings
* * *
Home Address Routeing Address Binding ID Flow ID Routeing Filter HoA1 CoA1
BID1 FID1 Description of IP flows... FID2 Description of IP flows... HoA1 CoA2
BID2 FID3 ...
* * *
#### 7.1.1.3 PCC Enhancements
Rel-8 PCC is designed to handle a single active access connection for each IP-
CAN. PCC enhanced for IP flow mobility must handle multiple simultaneous
access connections for a single IP CAN not only during the handover scenarios.
The main foreseen changes are:
\- Some of the IP-CAN level Gx signalling is enhanced to deliver SDF specific
routeing addresses instead of IP-CAN session specific routeing addresses.
\- PCRF is enhanced with the logic to associate multiple Gxx sessions with a
single Gx session, based on the SDF specific routeing addresses exchanged over
Gx.
The following principles apply for the interactions between routeing and SDFs:
\- PCRF informs PDN GW always when a new SDF is established via Gx (as in
Rel-8);
\- PDN GW keeps PCRF up to date about the current routeing addresses for each
IP flows by providing new and updated routing rules via Gx signaling;
\- PCRF keeps PCC and QoS rules up to date at appropriate gateways based on
the routing rules provided by the PDN GW.
\- When PCRF receives a new request from AF over Rx to establish resources
(i.e. network initiated resource establishment), PCRF checks the current
routing rules (including the default routing rule) to detect where the
respective IP flows will be routed. Based on this check, PCRF provides new or
updated PCC rules and QoS rules to gateways, if appropriate.
####
#### 7.1.1.4 Flows
##### 7.1.1.4.1 General
The flows in this clause are based on the flows specified in TS 23.402 [2].
The flows are applicable also to the I-WLAN mobility architecture: in this
case the PCC interactions are not implemented and the role of the PDN GW is
performed by the Home Agent.
##### 7.1.1.4.2 Addition of one access to the PDN connection
In this scenario, the UE is attached to one access, subsequently attaches to a
second access and starts using both accesses for the same PDN connection. As a
result the UE is simultaneously connected via both accesses and a set of
traffic flows are routed through one access while the remaining traffic flows
are routed through the other access.
Non-roaming, home routed roaming and Local Breakout cases are supported by
this procedure. The AAA proxy and vPCRF are only used in the case of home
routed roaming and Local Breakout. In non-roaming scenarios, the AAA proxy and
vPCRF are not involved.
The optional interaction steps between the gateways and the PCRF in the
procedures only occur if dynamic policy provisioning is deployed in EPC. These
steps are never present when the solution is applied to I-WLAN mobility
architecture as per TS 23.327 [3].
If the UE is first connected to a non-3GPP access using DSMIPv6 and
subsequently connects via a 3GPP access, the PDN GW which supports MAPIM shall
be configured not to send a Binding Revocation Indication message as described
in 3GPP TS 23.402, sub clause 8.4.1.
The below signalling flow shows in particular the case where the UE is first
connected to a 3GPP access which is configured as Home Link, and subsequently
connects via a non-3GPP access using DSMIPv6.
In case the solution is applied to I-WLAN, the Trusted non 3GPP IP Access is
replaced by the PDG, the EUTRAN/MME/SGW by the UTRAN/SGSN/GGSN and the PDN GW
by HA. As mentioned in case of I-WLAN the PCC interactions are not used.
Figure 7.1.2.2-1: Addition of one access to the PDN connection
1\. The UE performs an attach procedure to the 3GPP access as defined in TS
23.401 [8], clause 5.3.2. The UE may start exchanging data through the 3GPP
access.
2\. The UE discovers a non-3GPP access and performs the attach procedure as
per TS 23.402 [2], clause 8.4.2, steps 2-6.
3\. The UE sends a DSMIPv6 Binding Update (HoA, CoA, Lifetime, BID, FID, flow
description) message to the PDN GW including the requested routeing rules via
the FID option with both the routeing filters and the BID (which includes the
routeing address) as specified in draft-ietf-mip6-nemo-v4traversal [6], draft-
ietf-monami6-multiplecoa [4] and draft-ietf-mext-flow-binding [5]. The UE can
include more than one routeing rule by including multiple FID options in the
Binding Update. The DSMIPv6 Binding Update also contains an indication which
indicates that the home link (3GPP access) is still connected and also the BID
options which identify that one binding is associated with the home address
(3GPP access) and the other with the Care-of-Address from the non-3GPP access.
The UE also indicates in the Binding Update which is the default binding where
the PDN GW should route packets not matching any FID.
4\. The PDN GW sends an IP-CAN session modification request to the PCRF. In
this request, the PDN GW provides the updated routeing rules to the PCRF. The
PCRF stores the mapping between each SDF and its routeing address.
5\. Based on the IP-CAN session modification request, the PCRF ensures that
the relevant QoS rules for the SDFs are installed in the target BBERF. This is
done by a GW control session and QoS rules provision procedure as specified in
TS 23.203 [7].
6\. Based on the successful establishment of resources at the BBERF, the PCRF
sends an acknowledgement to the PDN GW, including updated PCC rules if
appropriate.
7\. The PDN GW sends a Binding Acknowledgment (Lifetime, HoA, CoA, BID, FID)
as specified in draft-ietf-mip6-nemo-v4traversal [6], draft-ietf-
monami6-multiplecoa [4] and draft-ietf-mext-flow-binding [5], to indicate
which routeing rules requested by the UE are accepted.
8\. Appropriate 3GPP resource release procedures are executed for those
resources that were moved to the non-3GPP access. This procedure may be
triggered by the PCRF via a GW control session and QoS rules provision
procedure if PMIPv6 is used on S5 and it may be triggered by the PDN GW in
case GTP is used on S5.
##### 7.1.1.4.3 IP flow mobility
In this scenario, a new routeing rule is activated or an existing routeing
rule is modified by the UE in order to move one traffic flow from one access
to another access.
The optional interaction steps between the gateways and the PCRF in the
procedures only occur if dynamic policy provisioning is deployed in EPC. These
steps are never present when the solution is applied to I-WLAN mobility
architecture as per TS 23.327 [3].
In case the solution is applied to I-WLAN, the Trusted non 3GPP IP Access is
replaced by the PDG, the EUTRAN/MME/SGW by the UTRAN/SGSN/GGSN and the PDN GW
by HA. As mentioned in case of I-WLAN the PCC interactions are not used.
Figure 7.1.2.3-1: IP Flow Mobility
1\. The UE is simultaneously connected to a 3GPP and a non-3GPP access based
on the procedures described in clause 7.1.2.2. Based on current routeing rules
some traffic is routed through the 3GPP access and some other traffic through
the non-3GPP access.
2\. The UE sends a Binding Update (HoA, BID, FID) to the PDN GW to install a
new routeing rule or to modify the routeing address of an existing routeing
rule to route the respective traffic (identified by the included FID) through
one particular access (identified by the included BID). In case of new
routeing rule with a new FID option, the UE includes the routeing filter
description.
NOTE: The UE can send the Binding Update either from the 3GPP or from the
non-3GPP access irrespective of which access the IP flow is moved to.
3\. The PDN GW sends an IP-CAN session modification request to the PCRF. In
this request the PDN GW provides the updated routeing rules to the PCRF. The
PCRF stores the updated mapping between routeing addresses and SDFs.
4\. Based on the IP-CAN session modification request, the PCRF ensures that
the relevant QoS rules are installed in the target BBERF. This is done by a GW
control session and QoS rules provision procedure as specified in TS 23.203
[7].
5\. Based on the successful establishment of resources at the BBERF, the PCRF
sends an acknowledgement to the PDN GW, including updated PCC rules if
appropriate.
6\. The PDN GW sends a Binding Acknowledgment (Lifetime, HoA, BID, FID) as
specified in draft-ietf-mip6-nemo-v4traversal [6], draft-ietf-
monami6-multiplecoa [4] and draft-ietf-mext-flow-binding [5], to indicate
which routeing rules requested by the UE are accepted.
7\. Appropriate EPS resource release procedures are executed for those
resources that were moved away from that access. This procedure may be
triggered by the PCRF via a GW control session and QoS rules provision
procedure if PMIPv6 is used on S5 and it may be triggered by the PDN GW in
case GTP is used on S5.
##### 7.1.1.4.4 Removal of one access from the PDN connection
In this scenario, the UE moves all traffic associated with one access to
another access and disconnects from the one access (e.g. due to loss of
coverage or by an explicit detach).
The optional interaction steps between the gateways and the PCRF in the
procedures only occur if dynamic policy provisioning is deployed in EPC. These
steps are never present when the solution is applied to I-WLAN mobility
architecture as per TS 23.327 [3].
In case the solution is applied to I-WLAN, the Trusted non 3GPP IP Access is
replaced by the PDG, the EUTRAN/MME/SGW by the UTRAN/SGSN/GGSN and the PDN GW
by HA. As mentioned in case of I-WLAN the PCC interactions are not used. The
below flow shows the case when the UE disconnects from the non-3GPP access and
remains connected only to the 3GPP access.
Figure 7.1.2.4-1: removal of one access from the PDN connection
The UE is simultaneously connected to a 3GPP and a non-3GPP accesses based on
the procedures described in clause 7.1.2.2. The UE is exchanging some traffic
flows through the 3GPP access and some other traffic flows through the
non-3GPP access. UE detects a condition triggering disconnection from the
non-3GPP access.
1\. The UE sends a Binding Update (HoA, CoA, BID) to the PDN GW to update the
CoA for the BID previously associated with the non-3GPP access. As the 3GPP is
the home link, the CoA included in the Binding Update is set to the HoA. With
this Binding Update the UE requests also to move all traffic flows previously
associated with the non-3GPP access to the 3GPP access.
NOTE: In case the 3GPP is the home link, alternatively the UE may also send a
de-registration Binding Update. If PDN GW does not keep the BID and FID
associated with the non-3GPP access, the UE needs to perform the whole BID and
FID registrations from scratch as soon as it connects to a new non-3GPP access
again.
1\. The PDN GW performs an IP-CAN session modification procedure with the
PCRF. In this modification procedure the PDN GW indicates that a single
routeing address is used for all the SDFs.
2\. The PDN GW updates the Binding Cache and the routeing information and
sends a Binding Acknowledgement (HoA, CoA, BID, Lifetime) to the UE.
3\. Based on the IP-CAN session modification, the PCRF ensures that the
relevant QoS rules are installed in the correct BBERF. This is done by a GW
control session and QoS rules provision procedure as specified in TS 23.203
[7].
4\. Appropriate resource release procedures are executed in the non-3GPP
access.
NOTE: Steps 1-4 are also performed when the UE disconnects from the 3GPP
access.
##### 7.1.1.4.5 Addition of one access for multiple PDN connections to the
same APN
When a UE having multiple PDN connections to the same APN via one access
attaches to a second access, the UE needs to decide which of the multiple PDN
connections the UE has would use both accesses simultaneously.
When the UE having multiple PDN connections to the same APN via 3GPP access
attaches to the non-3GPP access, the UE shall perform DSMIPv6 procedures only
for the PDN connections for which it will use IP flow mobility.
When the UE having multiple PDN connections to the same APN via a non-3GPP
access attaches to the 3GPP access, the UE should only establish the PDN
connections for which it will use IP flow mobility. However, due to the
restriction that the UE cannot indicate which PDN connection is to establish,
the UE shall repeat UE PDN Connectivity Request until the desired PDN
connections have been established and shall perform DSMIPv6 procedures for the
desired PDN connections.
#### 7.1.1.5 Routeing Filters
Routeing filters are a set of parameter values/ranges used to identify one or
more IP flows. The set of parameters that can be included as routeing filters
is the same as the ones that can be included in a Traffic Flow Template (TFT).
## 7.2 IP flow mobility solutions for S2a (PMIPv6)
### 7.2.1 Solution A: Routeing filters in PMIPv6
This solution is based on the same principles of solution A for DSMIPv6 but
PMIPv6 is used instead of DSMIPv6 as mobility protocol.
Due to the different nature of the PMIPv6 protocol, the routeing filters are
provided in the following way:
\- via access specific signalling used to perform attach and PDN connectivity
in 3GPP and non-3GPP accesses from the UE to the SGW/AGW
\- via PMIPv6 signalling from the SGW/AGW and the PDN GW.
Editor\'s Note: It is FFS if enhancements to PMIPv6 signaling is needed to
include the routeing filters or if PCO can be used.
#### 7.2.1.2 Addition of one access to the PDN connection
In this scenario, the UE is attached to one access, subsequently attaches to a
second access and starts using both accesses for the same PDN connection. As a
result the UE is simultaneously connected via both accesses and a set of IP
flows are routed through one access while the remaining IP flows are routed
through the other access.
Non-roaming, home routed roaming and Local Breakout cases are supported by
this procedure. The AAA proxy and vPCRF are only used in the case of home
routed roaming and Local Breakout. In non-roaming scenarios, the AAA proxy and
vPCRF are not involved.
The optional interaction steps between the gateways and the PCRF in the
procedures only occur if dynamic policy provisioning is deployed in EPC.
Figure 7.2.1.2-1: Addition of one access to the PDN connection
  1. The UE is attached to the 3GPP access and is connected to an PDN > connection.
  2. The UE discovers the trusted non-3GPP IP access system and > determines to transfer some IP flows from the currently used 3GPP > Access to the discovered trusted non-3GPP IP access system. The UE > performs access authentication and authorization in the non-3GPP > access system as defined in 3GPP TS 23.402 [2]. As part of this > procedure the AAA server provides the PDN GW identities to the > trusted non-3GPP access system as defined in 3GPP TS 23.402 [2].
  3. After successful authentication and authorization, the L3 attach > procedure for a specific APN is triggered. In this step, the UE > indicates the routing filters for which the IP packets should be > via the non-3GPP access. This information is signalled to the > non-3GPP access.
Editor\'s Note: How this information is actually signalled from the UE to the
access network is FFS.
  1. The Trusted Non-3GPP IP Access initiates a Gateway Control Session > Establishment Procedure with the PCRF as specified in > TS 23.203 [7].
Editor\'s Note: It is FFS whether QoS rules are downloaded to the non-3GPP
access at this point.
  1. The entity in the Trusted non-3GPP IP Access acting as a MAG sends a > Proxy Binding Update message to the PDN GW as defined in 3GPP TS > 23.402 [2]. In addition the Proxy Binding Update indicates the > routing filters provided by the UE.
  2. The PDN GW sends an IP-CAN session modification request to the PCRF. > In this request, the PDN GW provides the updated routing rules to > the PCRF. The PCRF stores the mapping between each SDF and its > routing address.
  3. Based on the IP-CAN session modification, the PCRF ensures that the > relevant QoS rules are installed in the correct BBERFs. This is > done by a GW control session and QoS rules provision procedure as > specified in 3GPP TS 23.203 [7]. This step may include update of > the QoS rules both in the non 3GPP and 3GPP (if any) BBERF.
  4. The PDN GW responds with a PMIP Binding Acknowledgement message to > the Trusted Non-3GPP IP Access.
  5. L3 attach procedure is completed. The IP address assigned to the UE > by the PDN-GW is conveyed to the UE and the indication that the > routing filters have been installed at the PDN GW is provided.
The above flow describes the case where the UE is already attached to a 3GPP
access and then performs the attach procedure to a Trusted non-3GPP access. In
the case the UE is attached to a 3GPP access and connects to an untrusted
non-3GPP access or is attached to a non-3GPP access and then attaches to a
3GPP access, the procedure is conceptually the same.
Editor\'s Note: In the case the UE attaches to 3GPP access as the second
access, it is FFS how the routing rules are provided, if in PCO or in actual
extensions to NAS and PMIPv6 signaling or using any other mechanism. From this
point of view the impacts to the MME and SGW are FFS.
#### 7.2.1.3 IP flow mobility
In this scenario, an IP flow is moved from one access to another access.
Figure 7.2.1.3-1 shows the case where one IP flow is added to the Trusted
non-3GPP IP access. This can be either a new IP flow or an IP flow which was
formerly routed through the 3GPP access.
The optional interaction steps between the gateways and the PCRF in the
procedures only occur if dynamic policy provisioning is deployed in EPC.
Figure 7.2.1.3-1 IP Flow Mobility
  1. The UE is simultaneously connected to a 3GPP and a non-3GPP access > based on the procedures described in subclause 7.2.1.2 The UE is > exchanging some IP flows through the 3GPP access and some other IP > flows through the non-3GPP access.
  2. The UE sends an IP flow mobility trigger to the entity acting as a > MAG in the non-3GPP access including some routing rules. The IP > flows request that the IP flow(s) included in the request is > routed through the non-3GPP access.
Editor\'s Note: It is FFS how the IP flow mobility trigger and the routing
rules are provided to the MAG. Possible solutions include or access specific
signaling.
  1. The MAG in the non-3GPP access sends a Proxy Binding Update to the > PDN GW including the routing rules provided by the UE.
Editor\'s Note: It is FFS how the routing rules are provided in PMIPv6,
whether in PCO or in actual extensions to PMIPv6 signalling.
  1. The PDN GW sends an IP-CAN session modification request to the PCRF. > In this request the PDN GW indicates how the mapping between SDFs > and the accesses has changed.
  2. The PDN GW sends an IP-CAN session modification request to the PCRF. > In this request the PDN GW provides the updated routing rules to > PCRF. The PCRF stores the updated mapping between routing > addresses and SDFs.
  3. The PDN GW sends a Proxy Binding Acknowledgment to indicate that the > request has been accepted.
  4. The MAG sends an acknowledgement to the UE to indicate that the > routing filters request has been accepted.
Editor\'s Note: It is FFS how the IP flow mobility acknowledge is provided to
the UE.
Editor\'s Note: in the case the UE requests to move an IP flow to the 3GPP
access, it is FFS how the routing rules request is provided. Possible
approaches include Router Solicitation, extensions of existing NAS messages or
new NAS messages and PCO extensions. From this point of view the impacts to
the MME and SGW are FFS.
Editor\'s Note: In the case the UE requests to move an IP flow to an untrusted
non-3GPP access, IKEv2 is used to provide the routing rules. The necessary
extensions to IKEv2 are FFS.
#### 7.2.1.4 Detaching from an Access
In this scenario, the UE moves all the IP flows associated with one access to
another access and disconnects from the one access (due to loss of coverage or
by an explicit detach).
The optional interaction steps between the gateways and the PCRF in the
procedures only occur if dynamic policy provisioning is deployed in EPC.
The below flow shows the case when the UE disconnects from the non-3GPP access
and remains connected only to the 3GPP access.
Figure 7.2.1.4-1 Detaching from an Access
The UE is simultaneously connected to a 3GPP and a non-3GPP access based on
the procedures described in subclause 7.2.1.2 The UE is exchanging some IP
flows through the 3GPP access and some other IP flows through the non-3GPP
access. UE detects a condition triggering disconnection from the non-3GPP
access.
If the UE is connected to multiple PDN connections via the access being
detached, the steps 2 to 6 will be performed for each PDN connection.
  1. The triggers either detach or disconnection from a specific PDN by > an access technology specific procedure.
  2. The Trusted Non-3GPP Access Network initiates the Gateway Control > Session Termination Procedure with the PCRF as specified in > TS 23.203 [7].
  3. The MAG sends a Proxy Binding Update to the PDN GW with lifetime set > to 0 indicating the de-registration.
  4. The PDN GW performs an IP-CAN session modification procedure with > the PCRF. In this modification procedure the PDN GW indicates that > a single access is used for all the SDFs.
  5. Based on the IP-CAN session modification, the PCRF ensures that the > relevant QoS rules are installed in the BBERF. This is done by a > GW control session and QoS rules provision procedure as specified > in 3GPP TS 23.203 [7].
  6. The PDN GW updates the routing information and sends a Proxy Binding > Acknowledgement to the MAG.
### 7.2.2 Solution B: IP flow mobility based on PCC for Network Based Mobility
Management Procedures
#### 7.2.2.1 Additional Simultaneous PDN Connectivity over Different Access
In this scenario the UE is attached to one access and has performed PDN
connection establishment to an APN. The UE subsequently performs attach to
another access for the same PDN for the same IP address. The UE shall perform
such simultaneous attach to another access by including multi-access
indication and associated parameters (if any) in the access specific
procedures. The access network shall pass such multi-access related
information to the PDN GW during Attach/PDN connection establishment
procedures. The PDN GW shall maintain multiple bindings for the PDN
connection, one for each of the attached accesses for the UE.
Multi-Access Indication and associated parameters shall be sent by the UE and
the access network in the Rel-8 specified IEs. Multi-Access Indication can be
carried in respective signaling messages either implicitly (e.g., another
enumerated value for the Attach Type IE), or explicitly within the PCO IE. The
choice of the preferred mechanism is FFS. Other multi-access related
parameters (if any) shall be carried in the PCO IE. It is FFS if other multi-
access related parameters can be used as Multi-Access Indication if they are
available.
IP Flow Mobility solution in this clause is based on PCC.
NOTE: This solution is applicable for flows known to the PCRF.
Editor's Note: It is FFS how the flow mapping decisions for UL traffic are
delivered to the UE.
#### 7.2.2.2 Additional access Procedure to the PDN connection
##### 7.2.2.2.1 General
This clause is related to the case that the UE initiates the additional access
to the PDN connection from the second access network when the UE has attached
to the same PDN via the first access network. And the clause includes the
scenario of S2a for non-3GPP access and GTP-based S5/S8 and PMIP-based S5/S8
for 3GPP access.
#### 7.2.2.2 PCC Enhancements
PCC enhanced for IP flow mobility shall be able to handle multiple
simultaneous access connections for a single IP-CAN. The mainly foreseen
enhancements from Rel-8 PCC are:
  1. The PCRF and PCEF should maintain some PCC parameters with access connection granularity instead of IP-CAN connection granularity.
  2. In the case of Network-initiated, the PCRF determines through which access network the SDF shall be routed. The PCRF provides PCC rules including the access network information to the PCEF.
##### 7.2.2.3.2 Additional access to the PDN connection with GTP-based S5 or
S8
The clause is to describe the additional access to the PDN connection from
3GPP access network when the UE has attached to the same PDN via a certain
non-3GPP access network. As a result the UE is simultaneously connected via
both accesses, a set of IP flows are routed through one access while the
remaining IP flows are routed through the other access. The S5/S8 interface in
the EPC is GTP-based.
The call flow is based on the E-UTRAN Attach procedure in TS 23.401, and the
changes and enhancements are shown in this clause.
Non-roaming, home routed roaming and Local Breakout cases are supported by
this procedure. The AAA proxy and vPCRF are only used in the case of home
routed roaming and Local Breakout. In non-roaming scenarios, the AAA proxy and
vPCRF are not involved.
Figure 7.2.2.2.2-1: Additional access to the PDN connection with GTP-based S5
or S8
1\. The UE performs an attach procedure to the EPC using the specific non-3GPP
access system procedure using PMIP-based S2a interface. The UE may start
exchanging data through trusted non-3GPP access.
2\. The UE initiates the Attach procedure by the transmission of an Attach
Request message (PCO) to the eNodeB. PCO is used to transfer parameters
between the UE and the PDN GW, and is sent transparently through the MME and
the Serving GW. PCO here contains a MAPIM indicator, which is used to inform
that the P-GW should establish new GTP tunnel with S-GW while maintaining the
previous PMIPv6 tunnel with non-3GPP access.
The other parameters in this message and the function of the parameters can be
referred to TS 23.401 [8], clause 5.3.2.
The eNodeB forwards the Attach Request message to the MME.
Editor\'s Note: It is FFS whether a new attach type value needs to be defined.
3\. This step can be referred to Steps 3-11 of E-UTRAN Initial Attach as
defined in TS 23.401 [8], clause 5.3.2.1.
4\. The MME selects a Serving GW and allocates an EPS Bearer Identity for the
Default Bearer associated with the UE. Then it sends a Create Default Bearer
Request (Protocol Configuration Options) message to the selected Serving GW.
The details of this step can be referred to TS 23.401 [8], clause 5.3.2.
5\. The Serving GW creates a new entry in its EPS Bearer table and sends a
Create Default Bearer Request (Protocol Configuration Options) message to the
PDN GW indicated by the PDN GW address received in the previous step. The
details of this step can be referred to TS 23.401 [8], clause 5.3.2.
6\. The P-GW sends an IP-CAN session modification request to the PCRF. In this
request, the PDN GW shall include the information of access network, and an
indication of Multi Access.
Editor\'s Note: what is the information of access network and how the Multi
Access is indicated to the PCRF is FFS.
7\. Because the P-GW has received the MAPIM indicator from the PCO, The P GW
creates a new entry in its EPS bearer context table while update the former
binding information with the non-3GPP access network. The new entry allows the
P GW to route corresponding user plane PDUs between the S GW and the packet
data network, and to start charging, and the updated former entry allows the
P-GW to route corresponding user plane PDUs between non-3GPP access and the
PDN.
Editor\'s Note: It is FFS how the PDG GW will route down link packet with the
2 tunnels.
The PDN GW returns a Create Default Bearer Response message to the S-GW.
When the MAPIM Indication is present, the PDN GW does not allocate a new IP
address to the UE, it will set the PDN address to the one that is allocated to
the UE in the non-3GPP access network in the Create Default Bearer Response.
The details of this step can be referred to TS 23.401 [8], clause 5.3.2.
8\. The Serving GW returns a Create Default Bearer Response message to the new
MME. The details of this step can be referred to TS 23.401 [8], clause 5.3.2.
9\. This step can be referred to Steps 17-26 of E-UTRAN Initial Attach as
defined in TS 23.401 [8], clause 5.3.2.
10\. Based on the IP-CAN session modification, the PCRF may provision to the
BBERF in the non 3GPP access with modified QoS rules. This is done by a GW
control session and QoS rules provision procedure as specified in TS 23.203
[7].
Editor\'s Note: It is FFS whether the IP flows can be moved to the 3GPP access
during the above procedure.
##### 7.2.2.3.3 Additional access to the PDN connection with PMIP-based S5 or
S8
The clause is to describe the additional access to the PDN connection from
3GPP access network when the UE has attached to the same PDN via a certain
non-3GPP access network. As a result the UE is simultaneously connected via
both accesses, a set of IP flows are routed through one access while the
remaining IP flows are routed through the other access. The S5/S8 interface in
the EPC is PMIP-based.
The call flow is based on the clause 7.2.2.2.2, and the changes are shown in
this clause.
Non-roaming, home routed roaming and Local Breakout cases are supported by
this procedure. The AAA proxy and vPCRF are only used in the case of home
routed roaming and Local Breakout. In non-roaming scenarios, the AAA proxy and
vPCRF are not involved.
Figure 7.2.2.2.3-1: Additional access to the PDN connection with PMIP-based S5
or S8
1\. The Serving GW initiates the Gateway Control Session Establishment
Procedure with the PCRF, as specified in TS 23.203 [7]. The Sâ€‘GW provides the
information to the PCRF to correctly associate it with the IPâ€‘CAN session to
be established in step 6.
2\. The Serving GW creates a new entry in its EPS Bearer table and sends a PBU
(Protocol Configuration Options) message to the PDN GW. The details of this
step can be referred to TS 23.402 [2], clause 5.2.
3\. The P-GW sends an IP-CAN session modification request to the PCRF. In this
request, the PDN GW shall include the information of access network.
Editor's Note: what is the information of access network is FFS.
4\. Because the P-GW has received the MAPIM indicator from the PCO , the Pâ€‘GW
creates a BCE and update the former binding information with the non-3GPP
access network. The new binding entry allows the Pâ€‘GW to route corresponding
user plane PDUs between the Sâ€‘GW and the packet data network, and to start
charging, and the updated former binding entry allows the P-GW to route
corresponding user plane PDUs between non-3GPP access and the PDN.
Editor's Note: It is FFS how the PDG GW will route down link packet with the 2
tunnels.
The PDN GW returns a PBA message to the Serving GW.
When the MAPIM Indication is present, the PDN GW does not allocate a new IP
address to the UE, it will set the PDN address to the one that is allocated to
the UE in the non-3GPP access network in PBA.
The details of this step can be referred to TS 23.402 [2], clause 5.2.
5\. In case the QoS rules have changed, the PCRF updates the QoS rules at the
S-GW by initiating the GW Control Session Modification Procedure, as specified
in TS 23.203 [7].
Editor's Note: It is FFS whether the IP flows can be moved to the 3GPP access
during the above procedure.
##### 7.2.2.3.4 Additional access to the PDN connection from Trusted non-3GPP
access network with PMIP-based S2a
The clause is to describe the Additional access to the PDN connection from
Trusted non-3GPP access network as a second access network when the UE has
attached to the same PDN via 3GPP access network. As a result the UE is
simultaneously connected via both accesses and a set of IP flows are routed
through one access while the remaining IP flows are routed through the other
access. The S5/S8 interface in the EPC is PMIP-based and the S2a is PMIP-
based.
The call flow is based on the "Initial Attach Procedure with PMIPv6 on S2a and
Anchoring in PDN GW" procedure in TS 23.402, clause 6.2.1, and the changes and
enhancements are shown in this clause.
Non-roaming, home routed roaming and Local Breakout cases are supported by
this procedure. The AAA proxy and vPCRF are only used in the case of home
routed roaming and Local Breakout. In non-roaming scenarios, the AAA proxy and
vPCRF are not involved.
Figure 7.2.2.2.4-1: Additional access to the PDN connection from Trusted
non-3GPP access network with PMIP-based S2a
1\. Refer to 23.402 [2], clause 5.2.
2\. The initial Non-3GPP access specific L2 procedures are performed. These
procedures are Non-3GPP access specific and are outside the scope of 3GPP.
Editor's Note: It is FFS whether a new attach type value needs to be defined.
3\. The EAP authentication procedure is initiated and performed involving the
UE, Trusted Non-3GPP IP Access and the 3GPP AAA Server. The details of this
step can be referred to TS 23.402 [2], clause 6.2.1.
4\. After successful authentication and authorization, the non-3GPP access
specific L3 attach procedure is triggered. And the parameter PCO containing
the MAPIM indicator sent to P-GW is transported in these messages. PCO here
contains a MAPIM indicator, which is used to inform that the P-GW should
establish new PMIP tunnel with non-3GPP access GW while maintaining the
previous tunnel with S-GW.
5\. The Serving GW initiates the Gateway Control Session Establishment
Procedure with the PCRF, as specified in TS 23.203 [7]. The Sâ€‘GW provides the
information to the PCRF to correctly associate it with the IPâ€‘CAN session to
be established in step 6.
6\. The MAG function of Trusted Non-3GPP IP Access sends a Proxy Binding
Update (PCO) message to PDN GW.
7\. The P-GW sends an IP-CAN session modification request to the PCRF. In this
request, the PDN GW shall include the information of access network.
Editor's Note: what is the information of access network is FFS.
8\. Because the P-GW has received the MAPIM indicator from the PCO, so The
P-GW creates a new PMIP tunnel with the non-3GPP access GW while update the
former binding information with the 3GPP access network. The new tunnel allows
the P-GW to route corresponding user plane PDUs between the non-3GPP access GW
and the packet data network, and the updated former entry allows the P-GW to
route corresponding between the user plane PDUs non-3GPP access and the PDN.
Editor's Note: It is FFS how the PDG GW will route down link packet with the 2
tunnels.
The PDN GW returns a PBA message to the Serving GW.
When the MAPIM Indication is present, the PDN GW does not allocate a new IP
address to the UE, it will set the PDN address to the one that is allocated to
the UE in the non-3GPP access network in the PBA.
The details of this step can be referred to TS 23.402 [2], clause 6.2.1.
9\. In case the QoS rules have changed, the PCRF updates the QoS rules at the
S-GW by initiating the GW Control Session Modification Procedure, as specified
in TS 23.203 [7].
10\. L3 attach procedure is completed via non-3GPP access specific trigger. IP
connectivity between the UE and the PDN GW is set for uplink and downlink
directions. At this step the IP address information is provided to the UE.
11\. Based on the IP-CAN session modification, the PCRF may provision to the
BBERF in the S-GW with modified QoS rules. This is done by a GW control
session and QoS rules provision procedure as specified in TS 23.203 [7].
Editor's Note: It is FFS whether the IP flows can be moved to the trusted non
3GPP access network during the above procedure.
#### 7.2.2.4 UE initiated IP flow mobility
##### 7.2.2.4.1 General
This section is related to the case that the UE initiates IP flow mobility
from one access to another when the UE is simultaneously connected to the same
PDN via two access networks. And this section includes the scenario of S2a for
non-3GPP access and GTP-based S5/S8 and PMIP-based S5/S8 for 3GPP access.
Editor\'s Note: This solution assumes that the packet filters provided via
access specific bearer modification procedures are not used only for bearer
selection but are also used to populate the IP stack routing table of the UE
and to perform routing decision between different interfaces. The impacts of
this assumption to the UE implementation are FFS. In this scenario, one or
more IP flows are moved from one access to another access.
Here lists three scenarios for the IP Flow mobility:
Scenario 1: IP flow mobility from trusted non-3GPP access with PMIP based S2a
to 3GPP access with GTP based S5/S8.
Scenario 2: IP flow mobility from trusted non-3GPP access with PMIP based S2a
to 3GPP access with PMIP based S5/S8.
Scenario 3: IP flow mobility from 3GPP access with GTP or PMIP based S5/S8 to
non-3GPP access with PMIP based S2a.
##### 7.2.2.4.2 IP flow mobility from trusted non-3GPP access with PMIP based
S2a to 3GPP access with GTP based S5/S8
For this scenario, firstly, the UE initiates the dedicated bearer request
procedure for the IP flows that need to be moved in the 3GPP access network,
after the dedicated bearer is established/modified, the hPCRF will initiate
the dedicated bearer deactivation/modification procedure in the non-3GPP
access network.
Figure 7.2.2.3.2 IP flow mobility from trusted non-3GPP access with PMIP based
S2a to 3GPP access with GTP based S5/S8
  1. The UE is simultaneously connected to the same PDN via both a 3GPP and a non-3GPP access network. The UE is exchanging some IP flows through the 3GPP access and some other IP flows through the non-3GPP access.
  2. The UE decides to move some IP flows from non-3GPP access to 3GPP access. The UE sends a Request Bearer Resource Modification to the MME and then MME sends the same message to S-GW to request the dedicated bearer allocation to move the IP flow(s) from non-3GPP access network to 3GPP access.
  3. The S-GW sends Request Bearer Resource Modification to the P-GW.
  4. The PDN GW interacts with PCRF using IP-CAN session modification procedure to trigger the appropriate PCC decision. The PCRF checks whether the service requested by UE exists in the non-3GPP access or not. If the service requested by UE exists in the non-3GPP access, and the PCRF allows the movement of this service from non-3GPP access to 3GPP access, then the PCRF triggers dedicated bearer activation/modification in 3GPP access and the dedicated bearer deactivation/modification in non-3GPP access (the dedicated bearer deactivation /modification can be executed after step 8) . If the service requested by UE does not exist in the non-3GPP access, the PCRF will treat this requested service as a new service and initiates the dedicated bearer activation/modification procedure in 3GPP access network only in the 3GPP access network.
  5. The P-GW sends Create Dedicated Bearer Request to the S-GW to trigger the 3GPP access network to allocate the resource for the new service.
  6. Dedicated Bearer Activation Procedure is initiated, which can be referred to Steps 3-10 of TS 23.401, section 5.4.1. During the dedicated bearer activation/modification procedure, the UE is informed which bearer will be used to transport the uplink IP flow(s) that has(have) been moved to the 3GPP access.
Editor's Note: It is FFS how this procedure is performed in case the packet
filters in the default bearer needs to be modified. In particular it is FFS
how additional packet filters are removed when a match-all packet filter is
present.
  1. The Serving GW acknowledges the bearer activation to the PDN GW by sending a Create Dedicated Bearer Response message.
  2. The PDN GW indicates to the PCRF whether the requested PCC decision (QoS policy) could be enforced or not, allowing the completion of IP CAN Session Modification procedure.
  3. The PCRF sends a Gateway Control and QoS Rules Provision to the non-3GPP access network to trigger the dedicated bearer deactivation/modification for the service that has been moved to 3GPP access.
  4. A dedicated bearer deactivation/modification procedure is triggered by the enforcement of the received policy rules, which can be referred to TS 23.402, section 6.6.1.
Editor's Note: It is FFS how this procedure is performed in case the packet
filters in the default bearer needs to be modified. In particular it is FFS
how additional packet filters are removed when a match-all packet filter is
present.
  1. The non-3GPP GW indicates to the PCRF whether the requested QoS Rules Provision could be enforced or not and thus completing the GW Control and QoS Rules Provision procedure started in step 9. Optionally, if all the services has been moved away or deleted in the non-3GPP access network, the non-3GPP access of the PDN connection will be removed after this step.
##### 7.2.2.4.3 IP flow mobility from trusted non-3GPP access with PMIP based
S2a to 3GPP access with PMIP based S5/S8
For this scenario, firstly, the UE initiates the dedicated bearer request
procedure for the IP flows that need to be moved in the 3GPP access network,
after the dedicated bearer is established/modified, the hPCRF will initiate
the dedicated bearer deactivation/modification procedure in the non-3GPP
access network
Figure 7.2.2.3.3 IP flow mobility from trusted non-3GPP access with PMIP based
S2a to 3GPP access with PMIP based S5/S8
A.1 The Serving GW initiates the Gateway Control and QoS Rules Request
Procedure as specified in TS 23.203 [7]. The PCRF checks whether the service
requested by UE exists in the non-3GPP access or not. If the service requested
by UE exists in the non-3GPP access, and the PCRF allows the movement of this
service from non-3GPP access to 3GPP access, then the PCRF triggers dedicated
bearer activation/modification in 3GPP access and the dedicated bearer
deactivation/modification in non-3GPP access (the dedicated bearer
deactivation/modification can be executed after step B.1). If the service
requested by UE does not exist in the non-3GPP access, the PCRF will treat
this requested service as a new service and initiates the dedicated bearer
activation/modification procedure only in the 3GPP access network..
B.1 The Serving GW indicates to the PCRF whether the requested QoS Rules
Provision could be enforced or not thus completing the GW Control and QoS
Rules Provision procedure started in step A.1.
B.2 The PCRF initiates the PCC Rules Provision Procedure as specified in TS
23.203 [7]. The PCRF provides updated PCC rules to the PCEF for enforcement by
means of an PCC Rules Provision procedure specified in TS 23.203 [7].
##### 7.2.2.4.4 IP flow mobility from 3GPP access with GTP or PMIP based S5/S8
to non-3GPP access with PMIP based S2a
For this scenario, firstly, the UE initiates the dedicated bearer request
procedure for the IP flows that need to be moved in the non-3GPP access
network, after the dedicated bearer is established/modified, the hPCRF will
initiate the dedicated bearer deactivation/modification procedure in the
non-3GPP access network.
Figure 7.2.2.3.4 IP flow mobility from 3GPP access with GTP or PMIP based
S5/S8 to non-3GPP access with PMIP based S2a
  1. The UE is simultaneously connected to the same PDN via both a 3GPP > and a non-3GPP access network. The UE is exchanging some IP flows > through the 3GPP access and some other IP flows through the > non-3GPP access.
  2. The UE decides to move some IP flows from 3GPP access to non-3GPP > access, and optionally decides to deactivate some IP flows from > the 3GPP system. The UE initiates the non-3GPP specific Bearer > Resource Modification procedure to move the IP flow(s) from 3GPP > access network to non-3GPP access.
  3. The non-3GPP GW initiates the Gateway Control and QoS Rules Request > Procedure as specified in TS 23.203 [7]. The PCRF checks whether > the service requested by UE exists in the 3GPP access or not. If > the service requested by UE exists in the 3GPP access, and the > PCRF allows the movement of this service from 3GPP access to > non-3GPP access, then the PCRF triggers dedicated bearer > activation/modification in non-3GPP access and the dedicated > bearer deactivation/modification in 3GPP access. If the service > requested by UE does not exist in the 3GPP access, the PCRF will > treat this requested service as a new service and initiates the > dedicated bearer activation/modification procedure only in the > non-3GPP access network.
  4. Dedicated Resource Request Procedure can be referred to > Network-initiated dynamic policy control procedure in Trusted > Non-3GPP IP Access for S2a in section 6.6.1, TS 23.402.
During the dedicated bearer activation/modification procedure, the UE is
informed which bearer will be used to transport the uplink IP flow(s) that
has(have) been moved to the non-3GPP access.
Editor's Note: It is FFS how this procedure is performed in case the packet
filters in the default bearer needs to be modified. In particular it is FFS
how additional packet filters are removed when a match-all packet filter is
present.
Steps 5-7 describe the dedicated bearer deactivation/modification procedures
for the scenario of PMIP based S5/S8 in 3GPP access network, for the GTP based
S5/S8, the procedure can refer to section 5.4.2.1 and 5.4.3 in TS23.401.
  1. The PCRF sends a Gateway Control and QoS Rules Provision to S-GW to > trigger the dedicated bearer deactivation/modification for the > service that moved to non-3GPP access.
  2. Dedicated Bearer deactivation/modification Procedure are described > in TS 23.402 [5], clauses 5.4.4 and clauses 5.4.4.
Editor's Note: It is FFS how this procedure is performed in case the packet
filters in the default bearer needs to be modified. In particular it is FFS
how additional packet filters are removed when a match-all packet filter is
present.
  1. The S-GW indicates to the PCRF whether the requested QoS Rules > Provision could be enforced or not and thus completing the GW > Control and QoS Rules Provision procedure started in step 5.
Optionally, if all the services has been moved away or deleted in the 3GPP
access network, the 3GPP access of the PDN connection will be removed after
this step which can be referred to TS 23.402, section 5.6.2.1
#### 7.2.2.5 UE initiated Removal of one access from the PDN connection
##### 7.2.2.5.1 General
This section is related to the case that the multiple access is removed from
one access network when the UE is simultaneously connected to the same PDN via
more than one access network.
In this scenario, for some reasons, e.g. loss of coverage, or the UE's battery
is in low power, UE will not be able to connect to the P-GW via multiple
accesses and should terminate one access, the UE will remove one access from
the PDN connection. Certainly, if the UE has some services and does not want
to abandon the services in that access, the UE will initiate the IP flow
mobility procedures which can be referred to section 7.2.2.3 firstly, then UE
will operate the procedure of removal of one access from the PDN connection
which is described in this section.
##### 7.2.2.5.2 UE initiated Removal of 3GPP access from the PDN connection
(GTP-based)
In this scenario, the UE removes the 3GPP access and remains connected only to
the non-3GPP access.
Figure 7.2.2.4.2 UE initiated Multiple access Removal from 3GPP access (GTP-
based)
  1. The UE is simultaneously connected to the same PDN via both a 3GPP > and a non-3GPP access network. The UE is exchanging some IP flows > through the 3GPP access and some other IP flows through the > non-3GPP access.
  2. The UE decides to remove the 3GPP access. The UE sends a Detach > Request to the MME and then MME sends the delete bearer request > message to S-GW initiate the removal of 3GPP access procedure.
  3. The S-GW sends delete bearer request to the P-GW to delete the GTP > tunnel with P-GW. The P-GW will find that there is still an access > in non-3GPP access network, so P-GW will only delete the GTP > tunnel with S-GW and still remain the binding with non-3GPP > access, the IP address that is allocated to UE is still valid.
  4. The PDN GW initiates the IP-CAN session modification procedure with > PCRF. The PDN GW shall include the information of access network.
Editor\'s Note: what is the information of access network and how the Multi
Access is indicated to the PCRF is FFS.
  1. The PDN GW acknowledges with Delete Bearer Response.
  2. Detach Procedure can be referred to TS 23.401, section 5.3.8.2 Steps > 3, 11-14.
  3. Because the PCRF has refreshed the PCC policy based on the event > that UE disconnects from 3GPP access, the PCRF sends a Gateway > Control and QoS Rules Provision to the non-3GPP access network to > push the new PCC policy.
  4. Non-3GPP access enforces the new PCC policy.
  5. The non-3GPP GW indicates to the PCRF whether the requested QoS > Policy Rules Provision could be enforced or not and thus > completing the GW Control and QoS Rules Provision procedure > started in step 7
##### 7.2.2.5.3 UE initiated Removal of 3GPP access from the PDN connection
(PMIP-based)
In this scenario, the UE removes the 3GPP access and remains connected only to
the non-3GPP access.
Figure 7.2.2.4.3 UE initiated Multiple access Removal from 3GPP access(PMIP-
based)
A.1 The S-GW initiates the Gateway Control Session Termination Procedure as
specified in TS 23.203 [7].
A.2 The S-GW sends PBU with lifetime=0 to the P-GW to delete the PMIP binding
with P-GW. The P-GW will find that there is still an access in non-3GPP access
network, so P-GW will only delete the binding relationship with S-GW(MAG) and
still remain the binding with non-3GPP access, the IP address that is
allocated to UE is still valid.
A.3 The PDN GW initiates the IP-CAN session modification procedure with PCRF.
The PDN GW shall include the information of access network.
Editor\'s Note: what is the information of access network and how the Multi
Access is indicated to the PCRF is FFS
A.4 The PDN GW responds to the Serving GW with the result of the PDN
connection release with Proxy Binding Update Acknowledgement.
##### 7.2.2.5.4 UE initiated Removal of non-3GPP access from the PDN
connection (S2a PMIP-based)
In this scenario, the UE removes the non-3GPP access and remains connected
only to the 3GPP access.
Figure 7.2.2.4.4 UE initiated Multiple access Removal from non-3GPP access(S2a
PMIP-based)
  1. The UE is simultaneously connected to the same PDN via both a 3GPP > and a non-3GPP access network. The UE is exchanging some IP flows > through the 3GPP access and some other IP flows through the > non-3GPP access.
  2. The UE decides to remove the non-3GPP access. The UE interacts with > non-3GPP access GW to initiate the removal procedure of non-3GPP > access network from the PDN connection.
  3. The BBERF in non-3GPP GW initiates the Gateway Control Session > Termination Procedure with PCRF as specified in TS 23.203 [7].
  4. The non-3GPP GW sends PBU with lifetime=0 to the P-GW to delete the > PMIP binding with P-GW. The P-GW will find that there is still an > access in 3GPP access network, so P-GW will only delete the > binding relationship with non-3GPP MAG and still remain the > binding with 3GPP access, the IP address that is allocated to UE > is still valid.
  5. The PDN GW interacts with PCRF to trigger the appropriate PCC > decision. The PDN GW shall include the information of access > network.
Editor\'s Note: what is the information of access network and how the Multi
Access is indicated to the PCRF is FFS
  1. The PDN GW responds to the Serving GW with the result of the PDN > connection release with Proxy Binding Update Acknowledgement.
  2. Non-3GPP access network operates the specific Detach Procedure which > is out of this scope.
Steps 8-10 describe the policy enforcement procedures for the scenario of PMIP
based S5/S8 in 3GPP access network, for the GTP based S5/S8, the procedure can
refer to section 5.4.3 in TS23.401.
  3. Because the PCRF has refreshed the PCC policy based on the event > that UE disconnects from non-3GPP access, the PCRF sends a Gateway > Control and QoS Rules Provision to the 3GPP access network to push > the new PCC policy.
  4. 3GPP access enforces the new PCC policy.
  5. The S-GW indicates to the PCRF whether the requested QoS Rules > Provision could be enforced or not and thus completing the GW > Control and QoS Rules Provision procedure started in step 8.
#### 7.2.2.6 Network-initiated Dynamic PCC
##### 7.1.1.6.1 Network-initiated Dynamic PCC in non-3GPP access
If dynamic PCC is deployed, the procedure given in Figure 7.1.1.5.1.-1 is used
by the PCRF to provision rules to the Trusted non-3GPP IP access and for the
Trusted non-3GPP IP access to enforce the policy by controlling the resources
and configuration in the trusted non-3GPP access. The access specific
procedure executed in the trusted non-3GPP access is not within the scope of
this specification.
Figure 7.1.1.5.1-1: Network-initiated dynamic policy control procedure
This procedure concerns both the non-roaming and roaming case. In the roaming
case, the vPCRF in the VPLMN forwards messages between the Trusted Non-3GPP IP
Access and the hPCRF in the HPLMN. In the case of Local Breakout, the vPCRF
forwards messages sent between the PDN GW and the hPCRF. In the non-roaming
case, the vPCRF is not involved at all.
The optional interaction steps between the gateways and the PCRF in the
procedures only occur if dynamic policy provisioning is deployed. Otherwise
policy may be statically configured with the gateway.
  1. The UE is attached to the PDN GW via LTE access and trusted non-3GPP access simultaneously.
  2. The PCRF receives the session information of new service, makes the policy decision and determines the IP flow is transfer through trusted non-3GPP access. The PCRF make this decision based on the characteristic of the service, the characteristic of access networks the UE multi attaching and the operator policy.
  3. The PCRF initiates the Gateway Control and QoS Rules Provision Procedure specified in TS 23.203 [7] by sending a message with the QoS rules and Event Trigger information to the Trusted non-3GPP access network.
  4. The Trusted Non-3GPP IP Access enforces the rules provisioned to it, and establish all necessary resources and configuration in the non-3GPP access system, ,for e.g. initiate a dedicated bearer activation, modification or deactivation, if supported. The details of this step are out of the scope of this specification.
Editor's Note: It is FFS how this procedure is performed in case the packet
filters in the default bearer needs to be modified. In particular it is FFS
how additional packet filters are removed when a match-all packet filter is
present.
  1. The Trusted Non-3GPP IP Access responds to the PCRF indicating its ability to enforce the rules provisioned to it in Step 1 and thus completing the GW Control and QoS Rules Provision procedure started in step A.1.
  2. The PCRF initiates the PCC Rules Provision Procedure as specified in TS 23.203 [7]. The PCRF provides updated PCC rules to the PCEF for enforcement by means of an PCC Rules Provision procedure specified in TS 23.203 [7]. In this procedure PCRF shall indicates the PCC Rules are associated with Trusted Non-3GPP Access.
NOTE: Step 6 may occur before step 3 or performed in parallel with steps 3â€‘5
if acknowledgement of resource allocation is not required to update PCC rules
in PCEF. For details please refer to TS 23.203 [7].
##### 7.2.2.6.2 Network-initiated Dynamic PCC in 3GPP access
The procedure is similar to that in clause 7.1.1.5.1
## 7.3 IP flow mobility policies
### 7.3.1 Introduction
The solutions for multi access PDN connectivity and IP flow mobility is
classified to DSMIP based case and PMIP based case. However, there are common
enhancements which are independent of the mobility protocol and can be used
for both DSMIP and PMIP based cases. This sub clause discusses the
enhancements that are needed for providing inter-system mobility policies for
IP flow mobility.
### 7.3.2 ANDSF enhancements
In Rel-8 the ANDSF is used to provide the UE with two sets of information:
\- Access Network Discovery;
\- Inter System Mobility policies.
Some enhancements are required for the inter system mobility policies so that
the operator can control through which access technology IP flows will be
routed.
NOTE 1: The enhancements defined in this subclause are independent of the
mobility protocol used for IP flow mobility.
To enable IP flow level control IP flow class specific inter system mobility
policies are introduced. The inter-system mobility policies provided by the
operator can be defined per APN, per IP flow class under any APN or per IP
flow class under a specific APN. As described in section 5, the policies apply
with the following priority order:
  1. Policies per IP flow class under a specific APN.
  2. Policies per IP flow class under any APN.
  3. Policies per APN.
The IP flow class can be identified either via the media type (e.g. audio) or
the IMS Communication Service Identifier (e.g. MMTEL) for IMS applications or
via the respective 5-tuple (IP source address, IP destination address, source
port, destination port, protocol type) for any type of application. Any
combination of these can also be possible.The 5-tuple can have also wildcard
values in any of the possible fields.
If a given IP flow matches more than one policy, the policy with higher
priority takes precedence. NOTE 2: The policies indicate the list of
prioritized accesses for the class of IP flows. The list includes one or more
accesses as the appropriate access and may include one or more restricted
accesses. For example the ANDSF may indicate that 3GPP is the highest priority
access for a given IP flow class and WiFi is the highest priority access for
another IP flow class.
NOTE 3: There is no intention to define a mechanism for informing the ANDSF
about the IP address(es) and port(s) used by the UE.When establishing the
connection with the ANDSF, the UE indicates to the ANDSF its capability to
support IP flow class specific inter system mobility policies.
Based on the policies provided by the ANDSF, the UE requests to the PDNGW/HA
to route IP flows to the appropriate access.
NOTE 3: The policies provided by the ANDSF do not preclude the UE to request
to route IP flows belonging to the same class of flows through different
accesses depending on their availability. For example, the routing can be
based on the dynamic availability of the access for a given IP flow (e.g.
network congestion as in case of the use case 2 described in subclause 4.2).
Static policies can be configured in the UE if ANDSF is not deployed. How this
is done is out of the scope of this study.
# 8 Evaluation of the Solutions
For S2c and H1 reference points, only the solution described in section 7.1.1
has been proposed. The study of the solution can be considered completed and
no major open issues have been identified. The solution is based on IETF
documents ([4] and [5]) which are mature and close to publication.
# 9 Conclusions
The study on the use cases has been completed by SA1 and service requirements
have been identified.
The study for S2c and H1 reference points can be considered concluded with the
solution in section 7.1.1 being the recommended solution.
###### ### Annex A: Handling of multiple PDN connections
Editor's Note: This clause provides a placeholder for documenting the required
solutions to enable full support for handling multiple PDN connections in
beyond Rel-8 EPC. I.e. solutions solving the following limitation documented
in Rel-8 TS 23.402:
> _TS 23.402, 8.3.0. Clause 4.1.0:_
>
> _\"The full support for connecting an UE simultaneously to the EPC via more
> than one access network is out of the scope of this release of the
> specification. This release supports simultaneous access from more than one
> access network during handover between the access networks._
>
> _NOTE 2: Even though not explicitly supported by this specification, the
> mechanisms specified in this specification can be used to connect a UE in
> parallel to the EPC via 3GPP access network and a Non-3GPP access network
> towards different PDNs.\"_
# A.1 Multiple PDN connections to different APNs
## A.1.1 Basic principles for simultaneous connectivity over multiple accesses
A UE, that is capable of routeing different simultaneously active PDN
connections through different access systems, can do so if the UE is
authorized by subscription to access all of the involved PDNs and all of the
involved access systems.
## A.1.2 Scenarios
The UE may simultaneously connect to different PDNs through different access
systems. The access systems the UE can stay simultaneously connected with may
include one 3GPP RAT, like GERAN, UTRAN or E-UTRAN, and one and only on
non-3GPP access, like WiFi or WiMAX. The following scenarios are supported:
\- Establishment of PDN connections over multiple accesses. The UE opens a new
PDN connection on an access that was previously unused or on one of the
accesses it is already simultaneously connected with.
\- Selective transfer of PDN connections between accesses. Upon inter-system
handover the UE transfers a subset of the active PDN connections from the
source to the target access.
\- Transfer of all PDN connections out of a certain access system. The UE
moves all the active PDN connections from the source to target access, e.g. in
case the UE goes out of the coverage of the source access.
## A.1.3 Architectural principles
The UE selects the access system where to route a specific PDN connection
based on the user preferences and the inter-system mobility policies
statically pre-configured by the operator on the UE or provided by the ANDSF.
The inter-system mobility policies statically pre-configured by the operator
on the UE or provided by the ANDSF may be per APN. As an example, this allows
the operator to indicate to the UE that a certain access system shall be
preferred to another for connecting to a specific APN.
Upon inter-system handover the UE may transfer from the source to the target
access system only a subset of the active PDN connections.
For non-3GPP accesses that support re-connecting the UE to multiple PDNs, when
the UE connects to the non-3GPP access, the non-3GPP access must not reconnect
the UE to all the active PDNs, as indicated by the AAA/HSS during
authentication, if the UE provided an APN upon handover attach in the non-3GPP
access. That is in fact considered an implicit indication that the UE wants to
transfer to the target access only a subset of the active PDN connections.
## A.1.4 Description of the impacts on TS 23.402
For the UE to simultaneously connect to different PDNs through different
access systems the following clarifications should be added to the procedures
specified in TS 23.402 [2]:
\- **4.8: Network Discovery and Selection**
The inter-system mobility policies may be per APN.
\- **4.12: Multiple PDN support**
Exchange of IP traffic to multiple PDNs simultaneously over multiple accesses
is also supported in the EPS. Multiple PDN connections over multiple accesses
can be established to different APNs.
For multiple PDNs over multiple access the following principles apply:
> \- A UE that is detaching from the Evolved Packet System, e.g. a UE that is
> powering off, performs a UE-initiated detach on each of the access systems
> where it has active PDN connections.
>
> \- In order to disconnect from a specific access system, e.g. due to the
> correspondent radio interface being switched off, and preserve all or a
> subset (e.g. based on policies) of the active PDN connections that use that
> access, a UE that is simultaneously connected to multiple accesses should
> not use the UE-initiated detach procedure. The UE should instead transfer
> all or a subset of the active PDN connections out of the access system it is
> disconnecting from.
>
> \- If the UE is simultaneously connected to multiple accesses, a detach
> procedure initiated by the MME, SGSN, trusted non-3GPP access or ePDG, e.g.
> due to administrative reasons or detecting the UE's leaving by, causes the
> UE to be detached only from the access system that is triggering the request
> and causes either the active PDN connections on that access to be
> disconnected or to be handed over by the UE to the other access.
Editor's note: It is FFS how the PDN connections are handed over to the other
access.
> \- If the UE is simultaneously connected to multiple access systems, when
> the user's subscription is removed (or for other operator determined
> reasons), the HSS/AAA initiates a detach procedure on each of the access
> systems where the UE has active PDN connections.
>
> \- Once the MME, or SGSN, receives upon detach the Delete Bearer Response
> from the Serving GW, the MME, or SGSN, shall send a Notify Request to
> indicate that the HSS shall remove the APN and PDN GW identity pairs for
> this UE only for the PDNs routed over 3GPP access.
\- **5.2: Initial E-UTRAN Attach with PMIP-based S5 or S8**
This procedure is also used to establish a PDN connection over E-UTRAN with
PMIP based S5 or S8 when the UE already has active PDN connections over some
non-3GPP access network and wants to establish simultaneous PDN connections
over multiple accesses.
\- **5.6.1: UE requested PDN connectivity with PMIP-based S5 or S8**
This procedure is also used for establishment of new PDN connectivity or for
re-establishment of existing PDN connectivity when UE is transferring PDN
connections from another access to 3GPP access and where active PDN
connections over 3GPP access already exist.
\- **6.2.1: Initial Attach Procedure with PMIPv6 on S2a and Anchoring in PDN
GW**
This procedure is also used to establish a PDN connection over a trusted
non-3GPP access with S2a when the UE already has active PDN connections over a
3GPP access and wants to establish simultaneous PDN connections over multiple
accesses.
\- **6.2.3: Initial Attach procedure with MIPv4 FACoA on S2a and Anchoring in
PDN GW**
This procedure is also used to establish a PDN connection over a trusted
non-3GPP access with MIPv4 FACoA on S2a when the UE already has active PDN
connections over a 3GPP access and wants to establish simultaneous PDN
connections over multiple accesses.
**\- 6.3: Initial Attach Procedure with DSMIPv6 on S2c in Trusted Non-3GPP IP
Access**
This procedure is also used to establish a PDN connection over a trusted
non-3GPP access with DSMIPv6 on S2c when the UE already has active PDN
connections over a 3GPP access and wants to establish simultaneous PDN
connections over multiple accesses.
**\- 6.8.1: UE-initiated Connectivity to Additional PDN with PMIPv6 on S2a**
This procedure is also used for establishment of new PDN connectivity or for
re-establishment of existing PDN connectivity when the UE is transferring PDN
connections from another access to a trusted non-3GPP access with PMIPv6 on
S2a and where active PDN connections over this trusted non-3GPP access already
exist.
This applies to both Non-Roaming, Home Routed Roaming and Local Breakout Case
and Chained PMIP-based S8-S2a Roaming Case.
**\- 6.8.2: UE-initiated Connectivity to Additional PDN with MIPv4 FACoA on
S2a**
These procedures are also used for establishment of new PDN connectivity or
for re-establishment of existing PDN connectivity when the UE is transferring
PDN connections from another access to a trusted non-3GPP access with MIPv4
FACoA on S2a and where active PDN connections over this trusted non-3GPP
access already exist.
**\- 7.2.1: Initial Attach with PMIPv6 on S2b**
This procedure is also used to establish a PDN connection over an untrusted
non-3GPP access with PMIPv6 on S2b when the UE already has active PDN
connections over a 3GPP access and wants to establish simultaneous PDN
connections over multiple accesses.
**\- 7.3: Initial Attach Procedure for S2c in Untrusted Non-3GPP IP Access**
This procedure is also used to establish a PDN connection over an untrusted
non-3GPP access with DSMIPv6 on S2c when the UE already has active PDN
connections over a 3GPP access and wants to establish simultaneous PDN
connections over multiple accesses.
**\- 7.6.1: UE-initiated Connectivity to Additional PDN with PMIPv6 on S2b**
This procedure is also used for establishment of new PDN connectivity or for
re-establishment of existing PDN connectivity when UE is transferring PDN
connections from another access to an untrusted non-3GPP access with PMIPv6 on
S2b and where active PDN connections over this untrusted non-3GPP access
already exist.
**\- 7.6.2: UE-initiated Connectivity to Additional PDN with DSMIPv6 on S2c**
This procedure is also used for establishment of new PDN connectivity or for
re-establishment of existing PDN connectivity when UE is transferring PDN
connections from another access to an untrusted non-3GPP access with DSMIPv6
on S2c and where active PDN connections over this untrusted non-3GPP access
already exists.
**\- 8.1: Common Aspects for Handover without Optimizations for Multiple
PDNs**
The procedures described in this clause can also be used by the UE to handover
a subset of PDN connections from one access to another as well as to transfer
all the PDN connections out of a certain access when UE is connected over
multiple accesses simultaneously.
**\- 8.2.1.1: Handover from Trusted or Untrusted Non-3GPP IP Access to 3GPP
Access on S2a/S2b, General Procedure for GTP based S5/S8 for E-UTRAN Access**
If the UE is connected to both 3GPP access and non-3GPP access before the
handover of PDN connections to 3GPP access is triggered, then the UE shall
skip steps 2 to 16 and only perform step 17 for each PDN connection that is
being transferred from non-3GPP access.
> If the UE is connected only to non-3GPP access before the handover of PDN
> connections to 3GPP access is triggered, then the UE shall perform steps 2
> to 16. In step 3 the UE shall provide the APN corresponding to one of the
> PDN connections that are being transferred from non-3GPP access. The UE
> shall then perform step 17 for each of the remaining PDN connections that
> are being transferred from non-3GPP access.
The UE shall perform step 18 for each PDN connection that is being transferred
from non-3GPP access.
**\- 8.2.1.2: Handover from Trusted or Untrusted Non-3GPP IP Access to 3GPP
Access on S2a/S2b, Using PMIP-based S5/S8**
If the UE is connected to both 3GPP access and non-3GPP access before the
handover of PDN connections to 3GPP access is triggered, then the UE shall
skip steps 2 to 16 and only perform step 17 for each PDN connection that is
being transferred from non-3GPP access.
> If the UE is connected only to non-3GPP access before the handover of PDN
> connections to 3GPP access is triggered, then the UE shall perform steps 2
> to 16. In step 3 the UE shall provide the APN corresponding to one of the
> PDN connections that are being transferred from non-3GPP access. The UE
> shall then perform step 17 for each of the remaining PDN connections that
> are being transferred from non-3GPP access.
The UE shall perform step 18 for each PDN connection that is being transferred
from non-3GPP access.
**\- 8.2.1.3: Handover from Trusted or Untrusted Non-3GPP IP Access to 3GPP
Access on S2a/S2b, General Procedure for GTP-based S5/S8 for UTRAN/GERAN**
If the UE is connected to both 3GPP access and non-3GPP access before the
handover of PDN connections to 3GPP access is triggered, then the UE shall
skip steps 2 to 6.
If the UE is connected only to non-3GPP access before the handover of PDN
connections to 3GPP access is triggered, then the UE shall perform steps 2 to
6.
> The UE shall perform the steps after step 7 for each PDN connection that is
> being transferred from non-3GPP access.
**\- 8.2.1.4: Handover from Trusted or Untrusted Non-3GPP IP Access to 3GPP
Access on S2a/S2b, Using PMIP-based S5/S8**
If the UE is connected to both 3GPP access and non-3GPP access before the
handover of PDN connections to 3GPP access is triggered, then the UE shall
skip steps 2 to 6.
If the UE is connected only to non-3GPP access before the handover of PDN
connections to 3GPP access is triggered, then the UE shall perform steps 2 to
6.
> The UE shall perform the steps after step 7 for each PDN connection that is
> being transferred from non-3GPP access.
**\- 8.2.2: 3GPP Access to Trusted Non-3GPP IP Access Handover with PMIPv6 on
S2a**
If the UE is connected to both 3GPP access and non-3GPP access before the
handover of PDN connections to trusted non-3GPP access is triggered, then the
UE shall skip steps 2 to 10 and only perform step 11 for each PDN connection
that is being transferred from 3GPP access.
If the UE is connected only to 3GPP access before the handover of PDN
connections to trusted non-3GPP access is triggered, then the UE shall perform
steps 2 to 10. In step 4 the UE shall provide an APN corresponding to one of
the PDN connections that are being transferred from 3GPP access. The UE shall
then perform step 11 for each of the remaining PDN connections that are being
transferred from 3GPP access.
The UE shall perform step 12 for each PDN connection that is being transferred
from 3GPP access.
The non-3GPP access shall not attempt to reconnect the UE to multiple PDNs if
the UE provides an APN in step 4, since that is considered an implicit
indication that the UE will establish connectivity with the remaining PDNs
using the UE-initiated procedure.
**\- 8.2.3: E-UTRAN to Untrusted Non-3GPP IP Access Handover with PMIPv6 on
S2b**
If the UE is connected over to 3GPP access and non-3GPP access before the
handover of PDN connections to untrusted non-3GPP access is triggered, then
the UE shall skip step 2.
If the UE is connected only to 3GPP access before the handover of PDN
connections to untrusted non-3GPP access is triggered, then the UE shall
perform step 2.
> The UE shall perform steps 3 to 9 for each PDN connection that is being
> transferred from 3GPP access.
**\- 8.4.1: Trusted or Untrusted Non-3GPP IP Access to 3GPP Access Handover
with DSMIPv6 over S2c**
If UE is connected to both 3GPP access and non-3GPP access before the handover
of PDN connections to 3GPP access is triggered, then the UE shall skip steps 2
to 16 of Figure 8.2.1.1-1 and only perform step 18 of Figure 8.2.1.1-1 for
each PDN connection that is being transfered from non-3GPP access.
If UE is connected only to non-3GPP access before the handover of PDN
connections to 3GPP access is triggered, then the UE shall perform steps 2 to
16 of Figure 8.2.1.1-1. In step 3 the UE shall provide the APN corresponding
to one of the PDN connections that are being transferred from non-3GPP access.
The UE shall then perform step 18 of Figure 8.2.1.1-1 for each of the
remaining PDN connections that are being transferred from non-3GPP access.
The UE shall perform steps 3 and 4 of Figure 8.4.1-1 for each PDN connection
that is being transferred from non-3GPP access.
**\- 8.4.2: 3GPP Access to Trusted Non-3GPP IP Access Handover with DSMIPv6
over S2c**
If the UE is connected to both 3GPP access and non-3GPP access before the
handover of PDN connections to trusted non-3GPP access is triggered, then the
UE shall skip steps 2 to 5.
> If the UE is connected only to 3GPP access before the handover of PDN
> connections to trusted non-3GPP access is triggered, then the UE shall
> perform steps 2 to 5.
The UE shall perform steps 6 to 12 for each PDN connection that is being
transferred from 3GPP access.
**\- 8.4.3: 3GPP Access to Untrusted Non-3GPP IP Access Handover with DSMIPv6
over S2c**
If the UE is connected to both 3GPP access and non-3GPP access before the
handover of PDN connections to untrusted non-3GPP access is triggered, then
the UE shall skip steps 2 to 5.
> If the UE is connected only to 3GPP access before the handover of PDN
> connections to untrusted non-3GPP access is triggered, then the UE shall
> perform steps 2 to 5.
The UE shall perform steps 6 to 12 for each PDN connection that is being
transferred from 3GPP access.
**\- 12: Interactions Between HSS and AAA Server**
A new procedure allowing the HSS/AAA to update the PDN context on the AGW/ePDG
when UE is simultaneously connected over 3GPP and non-3GPP accesses and the UE
adds, or removes, a PDN connection over the 3GPP access shall be added (see
clause A.1.6)
## A.1.5 Description of the impacts on TS 23.401
**\- 5.3.2.1 E-UTRAN Initial Attach**
> This procedure is also used to establish a PDN connection over E-UTRAN with
> GTP based S5 or S8 when the UE already has active PDN connections over some
> non-3GPP access network and wants to establish simultaneous PDN connections
> over multiple accesses.
**\- 5.3.2.2 UTRAN/GERAN Initial Attach**
> This procedure along with PDP context activation is also used to establish a
> PDN connection over UTRAN/GERAN when the UE already has active PDN
> connections over some non-3GPP access network and wants to establish
> simultaneous PDN connections over multiple accesses.
**\- 5.10.2 UE requested PDN connectivity**
> This procedure is used for establishment of new PDN connectivity or for re-
> establishment of existing PDN connectivity when UE is transferring PDN
> connections from another access to 3GPP access with GTP based S5 or S8 and
> where active PDN connections over this 3GPP access already exist.
## A.1.6 PDN GW Identity Notification to AGW/ePDG
In case of initial attach, or UE requested PDN connectivity, in the 3GPP
access, the SGSN/MME updates the HSS with the PDN GW identity of the selected
PDN GW and the APN associated with the UE\'s PDN connection. If a 3GPP AAA
Server is registered in the HSS for the same UE, the HSS provides the updated
APN and PDN GW identity information to the 3GPP AAA Server. If PMIPv6 is used
for establishing connectivity in the non-3GPP access, the 3GPP AAA Server
notifies the changes to the non-3GPP access network. This procedure can be
used for both PDN GW registration and de-registration.
Figure A.1.6-1: PDN GW address notification to AGW/ePDG
1\. The SGSN/MME sends a Notify Request (PDN GW Identity, APN, User Identity)
to the HSS.
2\. The HSS checks that the user is known and that the stored SGSN/MME is the
currently registered SGSN/MME for this same user. If this is successful, the
HSS returns a Notify Response.
3\. Steps 3-4 are only performed if the PDN GW identity information was
successfully modified in the HSS and a 3GPP AAA Server is registered in the
HSS for the same UE. In this case the HSS sends a Provide APN and PGW Identity
message to the 3GPP AAA Server. As a result, if PMIPv6 is used for
establishing connectivity in the non-3GP access, the 3GPP AAA Server updates
the non-3GPP access network with the new APN and PGW Identity data.
4\. The 3GPP AAA Server acknowledges by sending a Provide APN and PGW Identity
Ack message.
Editor's Note: Possible optimizations to minimize the amount of extra
signalling between the HSS and the 3GPP AAA Server are FFS.
###### ### Annex B: Usage of IMS Service Continuity in conjunction with Multi
Access PDN Connectivity
This clause describes how to use IMS Service Continuity, as specified in [x],
in conjunction with Multi Access PDN Connectivity for transferring IMS media
flows between access systems connected to the EPS.
Relying on the extensions specified in Annex A.1, the UE may route multiple
simultaneously active PDN connections to different APNs over different access
systems. The operator has the chance to influence the routeing decisions taken
by the UE providing per APN inter-system mobility policies that can be either
pre-configured on the UE or delivered to the UE by the ANDSF.
As a result, different APNs may use the available access systems, such a 3GPP
access and a set of domestic or public WiFi hotspots, according to different
policies. For example, the operator can set the inter-system mobility policies
so that APN #1 gives higher priority to 3GPP, while APN #2 gives higher
priority to WiFi. This ensures that, if the UE goes under the coverage of a
WiFi hotspot, the PDN connection towards APN #2 is transferred to WiFi, while
the PDN connection towards APN #1 continues to be routed over the 3GPP access.
This mechanism can be exploited by the operator to make sure that different
applications, or IMS media flows, use the available access systems
differently. To that purpose the operator should properly configure on the UE
a set of APN selection policies, that should be used by the UE to select the
APN where a specific application, or IMS media flow, has to be mapped. The APN
selection policies indicate:
\- The preferred APNs to be used for specific application types or IMS media
flows. For example the APN selection policies available on the UE may indicate
that APN #1 is the preferred APN for \"IMS audio\", while APN #2 is the
preferred APN for \"IMS video\".
\- The APN to be used as the default choice for the application types or IMS
media flows for which no specific indications are provided.
The APN selection policies can be either pre-configured on the UE or delivered
to the UE in a more dynamic fashion.
Editor's note: The details of the mechanisms for delivering the APN selection
policies to the UE are FFS.
The foreseen behaviour of the UE is summarized below:
\- The UE selects the APN to be used for routeing a specific application, or
IMS media flow, based on the APN selection policies. In case of an IMS
application, the UE can use IMS Service Continuity to move different IMS media
flows (e.g. audio, video) between different APNs, as indicated by the APN
selection policies. Once IMS SC has been used to transfer the IMS media flow
to the correct APN, there is no more need to trigger IMS SC procedures, since
mobility between access systems is handled by the EPS.
Editor's note: The IMS SC aspects, e.g., how the APN selection policies in the
UE interact with the IMS SC decisions/policies, are FFS.
\- If the APN selection policies indicate that an application, or IMS media
flow, should be mapped to an APN for which the UE has no active PDN
connections, the UE should establish a PDN connection towards the APN
indicated by the APN selection policies. Therefore the UE does not need to
stay permanently connected to all the APNs listed in the APN selection
policies. The UE may disconnect from the unused APNs.
\- The UE routes each APN over the available access systems according to the
inter-system mobility policies.
By properly tuning the inter-system mobility policies and the APN selection
policies, the operator can influence the behaviour of the UE so that specific
applications or IMS media flows are off-loaded to a non-3GPP access, like
WiFi, whenever a non-3GPP access becomes available.
The following tables provide an example of APN selection policies and inter-
system mobility policies. With the policies indicated in the example, if the
UE enters a WiFi hotspot, the audio component of an on-going IMS session
remains on the 3GPP access, while the video flow of the IMS session and any
other application (e.g. browsing, ftp, media synchronization) is transferred
to the WiFi infrastructure.
Table B.1: Example of APN selection policies
* * *
Flow Type Preferred APN IMS audio APN #1 IMS video APN #2 Default APN #2
* * *
Table B.2: Example of inter-system mobility policies
* * *
APN Preferred Access APN #1 3GPP APN #2 WiFi
* * *
The proposed solution has the following characteristics:
\- Using IMS Service Continuity the UE can move the IMS media flows between
APNs at any time and independently of each other. Therefore, for IMS
applications, the UE has the complete freedom of changing the routeing of any
of the active IMS media flows at any time.
\- For non IMS applications, the UE can change the routeing of the entire
traffic aggregate mapped to the same APN. Instead, it is not possible for the
UE to change the routeing of a specific IP flow, while leaving all the others
unaffected.
#