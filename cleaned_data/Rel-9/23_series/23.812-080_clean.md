# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
This clause is optional. If it exists, it is always the second unnumbered
clause.
# Scope
The scope of the technical report is to capture the results of a study into
the feasibility of enhancing IMS network architecture. This report intends to
study the feasibility of enhancing IMS network architecture as follows,
\- Investigating architectural improvements to reduce the complexity of
signalling procedures by reducing the signalling hops, or the number of
options and combinations (by looking at different groupings of combining
existing entities) ;
\- Investigating means to improve system-level load balancing and reliability;
\- Investigating possibilities for reducing configuration workload to save
OPEX.
Backward compatibility with current IMS specifications shall be ensured.
> NOTE: overlap with SA5 and CT4 work need to be monitored.
This report is intended to explore potential architecture improvements and
also provide conclusions on the above aspects with respect to potential future
normative specification work.
There are a number of functions involved in call session setup in IMS network.
Interfaces and interactions between network elements may be a little
complicated and not that efficient. It is deemed beneficial to review the
current IMS architecture including aspects such as the possible optimization
of interfaces/reference points (by looking at different groupings of combining
existing entities), reducing options of solutions for the same issues,
relevancy of certain functions etc.
IMS network service availability largely relies on the reliability of network
entities. If some network elements implementing critical functions (e.g.
S-CSCF, HSS) fail, service availability may be impacted. Moreover network
elements may not be fully utilized because network load may not be well
distributed, e.g. some nodes may be overloaded due to sudden traffic increase,
while others may be under loaded to some extent. Though there are some element
level approaches to solve these problems, some system level solutions should
be studied, for example, the method to distribute load between network
elements in different geographical locations especially when a disaster
happens, such as earthquake.
Network expansion may require significant manual configurations, and the
network maintenance and upgrade may be time-consuming and also may be costly
for operators. Introducing self-organization features may improve the network
intelligence and reduce the efforts of manual configuration.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.060: \" General Packet Radio Service (GPRS); Service
description; Stage 2\".
[3] 3GPP TS 23.228: \" IP Multimedia Subsystem (IMS); Stage 2\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**Load Balancing:** technique to distribute workload evenly across two or more
network nodes implementing the same functions, in order to get optimal
resource utilization.
**Overload Control** : technique to detect and react to the near-congestion
state of a network /node.
**Congestion Control** : a set of actions taken to relieve congestion by
limiting the spread and duration of it. (ITU-T Recommendation I.113,
definition 703).
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
Symbol format
\ \
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
Abbreviation format
\ \
# 4 Analysis of IMS architecture
  * Editors Note: This section analyzes IMS architecture and identifies > some problems from architectural level
## 4.1 Session setup efficiency
### 4.1.1 Problems description
  * Editors Note: This section illustrates standard IMS session setup > flows and identifies the complexity of P/I/S-CSCF interaction.
### 4.1.2 Summary
## 4.2 Load balancing
### 4.2.1 Problems description
  * Editors Note: This section analyzes IMS load balance mechanism (e.g. > P/S/I-CSCF/SLF/HSS) and identifies potential load balance problems > (e.g. how to handle explosive traffic) under IMS architecture.
4.2.1.1 General
Load balancing is an important mechanism in telecommunication networks. In
general, we can adopt DNS technology in IMS to achieve limited load balancing.
However, current DNS cannot coordinate with IMS to achieve real-time and more
dynamic load balancing. Specifically, it is difficult to handle explosive
traffic growth when a part of the IMS network is overloaded. This section
analyzes IMS load balancing mechanisms (e.g. P-CSCF/S-CSCF/I-CSCF/SLF/HSS) and
identifies potential load balancing problems (e.g. how to handle explosive
traffic growth).
4.2.1.2 Analysis of P-CSCF load balancing
Generally, there are three methods used by the UE to discover P-CSCF
addresses:
1) The UE shall request the P‑CSCF address(es) from the GGSN when activating
the PDP context. The GGSN shall send the P‑CSCF address(es) to the UE when
accepting the PDP context activation.
2) Use of DHCP to provide the UE with the domain name and/or IP address of a
P‑CSCF and the address of a DNS that is capable of resolving the P‑CSCF name.
3) The UE may be configured with the fully qualified domain name (FQDN) of a
P-CSCF or its IP address.
As stated above, IMS does not provide any mechanism for load balancing among
P-CSCFs, allowing to direct the UE to a low loaded P-CSCF. 3GPP
specifications, such as TS 23.060 [2], do not explicitly define how a GGSN
obtains a P-CSCF address. Generally, a GGSN may be configured statically with
a P-CSCF address. It is similar to DHCP, where P-CSCF domain names are
configured statically.
Currently, a P-CSCF may reject a registration request from a UE when it is
overloaded. This mechanism may not be sufficient in order to handle explosive
traffic growth or to distribute the load between P-CSCFs.
4.2.1.3 Analysis of S-CSCF load balancing
When a UE initially registers in the IMS, a S‑CSCF shall be assigned to serve
the UE. S‑CSCF assignment is performed by the I‑CSCF, but the S-CSCF selection
policy of the I-CSCF mainly depends on the capabilities, topological
information and the availability of the S-CSCF (See TS 23.228 [3] for
details). The I-CSCF does not have load balancing information related to the
S-CSCFs, which may result in a bad distribution of the load between the S-CSCF
of an IMS network.
When a UE re-registers, the S-CSCF, which was assigned at initial
registration, may no longer be the optimal choice with regard to load balance
and/or availability of alternative S-CSCFs. S-CSCF re-selection may not be
done during re-registration, which may lead to sub-optimal S-CSCF allocations
for a long time period.
4.2.1.4 Analysis of SLF load balancing
The SLF supports HSS address queries for the I-CSCF or S-CSCF when there are
multiple HSSs in an IMS network. In a large-scale network, the SLF may become
a bottleneck of the system.
4.2.1.5 Analysis of HSS load balancing
HSS load balancing involves knowledge of the capacities of different HSS
entities and data storage planning. Because different HSSs have different
capacities, an imbalance of user data storage may result and it is not easy to
guarantee the well-distributed traffic among the HSSs.
4.2.1.6 Analysis of I-CSCF load balancing
Load balancing between I-CSCF entities can be achieved by means of DNS, based
on load balancing algorithms. This capability will not be further
investigated.
## 4.3 Recovery and Load Balancing
### 4.3.1 Problems description
#### 4.3.1.1 General
This section analyzes current IMS Recovery and Load Balancing mechanisms.
#### 4.3.1.2 Analysis of current entity-level redundancy/restoration mechanism
Generally in IMS network, entity-level redundancy mechanism can be used to
survive entity failures without the co-operation with IMS core. This mechanism
uses additional entities and backs up all data locally during running time.
Pre-configuration is done for the pair of the original entity and a backup
one. When the original one breaks down, the backup one will take over its task
at once. This method does not handle the case where both the original entity
and the backup one are both down due to e.g. an earthquake.
#### 4.3.1.3 Analysis of current system-level reselection/restoration
mechanism
Currently, 3GPP CT4 has specified restoration procedures for S-CSCF
restoration in TS 23.380 and is doing additional study on other system-level
IMS restoration in TR 23.820 (e.g. P-CSCF and HSS) to enhance the network
restoration capabilities. These solutions are all based on the reassignment of
a new entity taking over the load from the failed one. However, it is not
specified today how the load status of the new entity could be taken into
account when performing a re-selection. If the load status is not taken into
account during e.g the S-CSCF re-selection process of the restoration
procedures, this could in a worst case scenario result in that the load of the
failed entity is transferred to other entities and those newly selected
entities may get overloaded. The situation may get even worse when a regional
disaster happens, which may cause an explosive traffic load.
### 4.3.2 Summary
As for initial registration and re-registration, a proper S-CSCF load
balancing mechanism may be needed when performing restoration procedures.
S-CSCF restoration is built up in two steps, the I-CSCF procedure of re-
selecting a S-CSCF, and the procedure of restoring the data in the S-CSCF. The
(re-)selection mechanism used for S-CSCF restoration procedures, are basically
the same as the normal S-CSCF selection mechanism for initial registration.
Hence, the restoration procedures could benefit of the S-CSCF (re-)selection
mechanisms being studied in this TR.
## 4.4 Scalability
### 4.4.1 Problems description
  * Editor's Note: This section analyzes IMS scalability mechanism and > identifies potential scalability problems (e.g. how to reduce OPEX > upon SLF/HSS and P/I/S-CSCF expansion).
The network scalability is a critical point for the network expansion ability
and maintenance of an IMS network. The problem of scalability includes several
aspects. How to preserve the efficiency of locating user data is one of them
if the number of subscribers grows a lot.
When the number of subscribers increases continuously, operators usually need
to deploy multiple HSSs that may be distributed geographically. SLF is thus
deployed to handle the selection of multiple HSSs. The size of the SIP URI
based index table in SLF will become bigger and bigger which may as result
cause the inefficiency of addressing the right HSS through querying SLF via Dx
and Dh interface. These inefficiencies may be implementation dependent rather
than standardization related.
Another aspect relates to the synchronization amongst distributed SLFs. If
distributed SLFs are utilized to, e.g. improve the efficiency of locating the
right HSS or handle restoration issues, every time a new HSS equipment is
added to expand the user capacity, all distributed SLFs may have to be
synchronized with the new index information. The larger the user capacity
becomes, the larger the number of SLFs needs to be, and the more time-
consuming the synchronization will be.
### 4.4.2 Summary
# 5 Architecture alternatives
  * Editor's Note: This section aims to come up with solutions from > architecture's point of view to resolve the problems described in > Section 4.
## 5.1 Architecture alternatives for P-CSCF overload redirection
### 5.1.1 P-CSCF redirects to another P-CSCF
#### 5.1.1.1 Description
If overload conditions are detected in P-CSCF it may redirect a UE (which is
trying to perform IMS Registration) to another P-CSCF. Such a network-based
redirect facilitation will aid the UE in finding another P- CSCF in a more
deterministic fashion.
#### 5.1.1.2 Information flow
Fig 5.1-1 shows a information flow where a UE is redirected to another P-CSCF
during IMS registration.
Fig 5.1-1 Information flow for IMS Registration redirection
  1. UE sends a IMS Registration request to P-CSCF -1 that is experiencing overload condition.
  2. P-CSCF -- 1 sends a Registration redirection response with a redirect address of P-CSCF -- 2
> Note: The P-CSCF-2 can be configured in P-CSCF-1;
  1. UE sends IMS registration request to P-CSCF-2.
  2. P-CSCF-2 forwards the registration requests to IMS CN for further processing.
  3. P-CSCF-2 receives successful registration response.
  4. P-CSCF-2 sends successful IMS registration response to the UE .
#### 5.1.1.3 Co-existence with earlier releases
> Editor's Note: This section will analyze how the new solution will impact on
> IMS network. ( e.g. how to interwork and get compatible with IMS earlier
> releases )
### 5.1.2 Using DNS to select another P-CSCF
#### 5.1.2.1 Description
This alternative relies on existing mechanisms to re-select another P-CSCF,
when the P-CSCF to which a UE has requested a registration, is overloaded.
#### 5.1.2.2 Information flow
Fig 5.1-2 shows an information flow where a UE attempts registration with a
P-CSCF, which rejects the registration because of overload, and the UE
subsequently performs a DNS query to obtain the address of another P-CSCF.
Fig 5.1-2 Information flow for IMS Registration redirection
> 1\. UE sends a IMS Registration request to P-CSCF -1 that is experiencing
> overload condition.
>
> 2\. P-CSCF-1 sends a Registration response indicating that it is temporarily
> unavailable
>
> 3\. UE performs a DNS resolution and selects another P-CSCF.
NOTE: P-CSCF Load Balancing as described in clause 5.2.2 may be used to select
a relatively low-loaded P-CSCF
> 4\. UE sends IMS registration request to P-CSCF-2.
>
> 5\. P-CSCF-2 forwards the registration requests to IMS CN for further
> processing.
>
> 6\. P-CSCF-2 receives successful registration response.
>
> 7\. P-CSCF-2 sends successful IMS registration response to the UE .
## 5.2 Architecture alternatives based on Load Detection Function
### 5.2.1 Load Detection Function (LDF)
In order to perform overload detection and resolution and/or load balancing
between P-CSCFs or S-CSCFs, a new function called the Load Detection Function
(LDF) is proposed to monitor and store the load information of all P-CSCFs and
S-CSCFs, (e.g., CPU and Memory Usage, currently supported number of users, or
service related factors). The information can be used for P/S-CSCF selection.
The functions of the LDF include:
  * Monitor and store the load information of network entities( e.g., P-CSCF, S-CSCF) in an operator's domain;
NOTE: Periodic monitoring can be used by the LDF to obtain load information of
network entities; this is particularly applicable when the LDF is used for
Load Balancing. A threshold crossing indication mechanism can be used by the
LDF to obtain load information of P/S-CSCFs, or example, when their load
exceeds a pre-defined threshold. This is particularly applicable when the LDF
is only used for Overload Control.
  * Provide the load information of network entities (e.g., P-CSCF, S-CSCF) to DNS.
  * Provide the load information of other network entities (e.g. P-CSCF/S-CSCF) to a network entity such as a P-CSCF or S-CSCF, in the case of overload control
The figure below illustrates the reference points of the LDF. The LDF monitors
the load of P-CSCF and S-CSCF respectively via Lp and Ls reference points. The
LDF provides load information of the network elements to DNS via Ld interface,
and DNS UPDATE mechanism defined in RFC 2136 can be reused to implement this
functionality (Refer to Annex A). Thus, a P-CSCF can obtain the address of
another P-CSCF in low-load state by performing a DNS query. An I-CSCF can
obtain the load information of relevant S-CSCFs by performing a DNS query.
Fig 5.2-1 LDF Interfaces
NOTE: Considerations need to be made for the redundancy and reliability
mechanisms for the LDF to ensure the availability of the LDF. .
Periodic monitoring of a CSCF\'s load induces an additional workload on this
CSCF. Monitoring shall be designed in such a way that such added workload is
negligible compared to the workload caused by normal operations of the CSCF
such as SIP routing.
Editor\'s Note: The network management related issues should be transferred to
SA5 for discussion. The relation between the LDF based load balancing
mechanism and the existing network management system is for future study.
Editor\'s Note: It is FFS whether or not the LDF should be defined as a
separate logical entity or as a function of the CSCFs.
### P-CSCF load balancing
#### 5.2.2.1 General
In order to achieve load balancing between P-CSCFs, the Load Detection
Function (LDF) is utilized to monitor and store the load information of all
P-CSCFs, e.g., CPU Utilization and Memory Usage.
The P-CSCF load balancing mechanisms implemented by the LDF are:
  * Monitor and store the load information of P-CSCFs. This is achieved either by querying each P-CSCF, or by collecting information reported by the P-CSCFs.
  * Update the load information of P-CSCFs periodically to DNS.
#### 5.2.2.2 Information flow
Fig 5.2-2: Information flow for P-CSCF load balancing
  1. P-CSCF-1, P-CSCF-2 and P-CSCF-3 notify the load information to LDF(e.g. periodically).
  2. LDF updates the load state of the relevant P-CSCFs to DNS at a given interval.
  3. UE initiates an address query for P-CSCF to DNS.
  4. DNS implements a load balancing algorithm and return the address of a relatively low-load P-CSCF-1. If all available LDFs go out of service for some reason, DNS is required to be aware of this failure and fall back to the static P-CSCF assignment mechanism (e.g., round robin) without considering load information.
  5. UE sends IMS registration request to P-CSCF-1.
NOTE: DNS caching may break this load balancing mechanism, if the TTL of DNS
entries is not set to zero or a very small value (e.g. a value that is close
to the load probing period). It is up to the operator to define the TTL of DNS
entries, e.g. by making a trade-off between the cost of extra DNS queries
induced by lowering the TTL, and the benefits provided by this load balancing
mechanism.
#### 5.2.2.3 P-CSCF overload control
##### 5.2.2.3.1 General
In order to achieve overload control between P-CSCFs, the Load Detection
Function (LDF) is utilized to monitor and store the load information of all
P-CSCFs, e.g., CPU Utilization and Memory Usage.
The P-CSCF overload control mechanisms implemented by the LDF are:
  * Monitor and store the load information of P-CSCFs. This is achieved either by querying each P-CSCF, or by collecting information reported by the P-CSCFs.
  * Provide a P-CSCF with the address of a low-load P-CSCF to redirect initial registration.
##### 5.2.2.3.2 Information flow
Fig 5.2-3b: Information flow for P-CSCF overload control
> 1\. P-CSCF-1, P-CSCF-2 and P-CSCF-3 notify the load information to LDF(e.g.
> periodically).
>
> 2\. P-CSCF-1 gets the low-load P-CSCF address, eg. P-CSCF-3.
>
> 3\. P-CSCF-1 receives the initial registration of UE.
>
> 4\. P-CSCF-1 finds that it is in overload condition.
>
> 5\. P-CSCF-1 sends a Registration redirection response with a redirect
> address of P-CSCF-3.
>
> 6\. UE sends IMS registration request to P-CSCF-3.
### 5.2.3 S-CSCF load balancing during initial registration
#### 5.2.3.1 General
The load information of S-CSCFs is beneficial to improve the load balancing
across S-CSCFs. If the load state of S-CSCFs is considered when selecting
S-CSCF during the initial registration, load imbalance amongst S-CSCFs might
be alleviated to some extent and S-CSCFs might be utilized more efficiently.
The LDF (Load Detection Function) could be introduced to help implement S-CSCF
load balancing for certain scenarios.
The following observations can be made:
\- When performing load-balancing for the S-CSCF during initial registration,
it is not only the current traffic load of the S-CSCFs that is of interest,
but the maximum expected load that the registered users will create during
busy hours.
\- Different users imply different expected load on the system at different
periods of times. A business user generates different load than residential
users. A user with only one terminal using MMTEL, will have quite different
behaviour than a user with multiple terminals, using MMTEL, Push-to-talk,
Messaging, IMS based mobile TV, and enabled for ICS/SRVCC/Inter-UE transfer.
NOTE: Different IMS subscriptions may have different load caracteristics (such
as IP PBX). This can be taken into account by the operator by configuring
specific server capabilities in the user profile of users that have specific
characteristics (e.g. to direct IP PBX registrations to S-CSCFs that are
dimensionned to serve IP PBXs).
#### 5.2.3.2 Information flow
Fig 5.3-4 shows an information flow where a relatively low-load S-CSCF is
selected during IMS initial registration.
Fig 5.2-4a: Information flow for S-CSCF Load Balancing at initial registration
  1. The LDF interacts with the S-CSCFs in the same domain to obtain load information of S-CSCFs, and updates the DNS accordingly.. This is achieved either by querying each S-CSCF, or by collecting information reported by the S‑CSCFs.
  2. The I-CSCF receives a IMS registration request from a UE.
  3. The I‑CSCF sends the Cx query to the HSS to find an appropriate S-CSCF.
  4. The I-CSCF receives a Cx response, which contains the server capabilities, from HSS if no S-CSCF is assigned to the user.
  5. In the case where Cx response contains server capabilities, the I-CSCF constructs a domain name from these capabilities, using a deterministic algorithm and local configuration.
  6. The I-CSCF performs a DNS query to resolve the domain name constructed at step 5 or the S-CSCF address received by the HSS at step 4.
  7. The I-CSCF receives a response containing address(es) of preferable S-CSCFs from the LDF.
  8. The I-CSCF sends the IMS registration request to the S-CSCF.
#### 5.2.3.3 S-CSCF overload control
##### 5.2.3.3.1 General
The load information of S-CSCFs is beneficial to improve overload control. If
the load state of S-CSCFs is considered when selecting an S-CSCF during the
initial registration, load imbalance amongst S-CSCFs due to the overload of an
S-CSCF might be alleviated to some extent and S-CSCFs might be utilized more
efficiently. The LDF (Load Detection Function) could be introduced to help
implement S-CSCF overload control for certain scenarios.
The observations in clause 5.2.3.1 are also applicable to overload control.
##### 5.2.3.3.2 Information flow
Fig 5.2-4b: Information flow for S-CSCF Overload Load at initial registration
> 1\. The LDF interacts with the S-CSCFs in the same domain to obtain load
> information of S-CSCFs. This is achieved either by querying each S-CSCF, or
> by collecting information reported by the S‑CSCFs.
>
> 2\. S-CSCF-1 gets a low-load S-CSCF address, eg. S-CSCF-3.
>
> 3\. The I-CSCF sends the IMS initial registration request to the selected
> S-CSCF, i.e. S-CSCF-1.
>
> 4\. S-CSCF-1 finds that it is in overload condition.
>
> Editor's notes: It is FFS whether S-CSCF or I-CSCF should perform the
> overload control.
>
> 5\. S-CSCF-1 sends a Registration redirection response to I-CSCF with a
> redirect address of S-CSCF-3.
>
> 6\. The I-CSCF sends the IMS initial registration request to S-CSCF-3.
### 5.2.4 S-CSCF load balancing during re-registration
Fig 5.2-5 shows an information flow where a more preferable S-CSCF is selected
during IMS re-registration. LDF is involved to offer load information. It's
assumed that S-CSCF re-selection should not impact service continuity. Thus,
S-CSCF re-selection only applies to the registered UEs without ongoing
services.
Fig 5.2-5: Infromation flow for S-CSCF load banlacing at re-registration
  1. LDF interacts with the S-CSCFs in the same domain to obtain dynamic load information of S-CSCFs, and updates the DNS accordingly.
  2. I-CSCF receives a IMS re-registration request from UE.
  3. I-CSCF determines and, if necessary, gets capabilities of S-CSCFs from HSS using step 2-6 of Detection Mechanism 1 (in sub-clause 5.3.3) or step 2-5 of Detection Mechanism 2 (in sub-clause 5.3.4).
  4. In the case where Cx response contains server capabilities, I-CSCF constructs a domain name from these capabilities, using a deterministic algorithm and local configuration.
  5. I-CSCF performs a DNS query to resolve the domain name constructed at step 4 or the S-CSCF address received from the HSS at step 3.
  6. I-CSCF receives a response containing address(es) of preferable S-CSCF(s) from DNS.
  7. The I-CSCF calculates the best suited S-CSCF based on the received capabilities and load information. If the best suited S-CSCF is the currently assigned S-CSCF (S-CSCF 2) or the best suited S-CSCF is currently not available, existing Rel-8 procedure is followed. Otherwise, go to Step 8.
  8. The re-assignment of S-CSCF follows Re-Selection Mechanism 1 (in sub-clause 5.4.1) or Re-Selection Mechanism 2 (in sub-clause 5.4.2)
### 5.2.5 Architecture alternatives for load balancing during S-CSCF
restoration
#### 5.2.5.1 General
Current solution of S-CSCF system-level restoration proposed by CT4 is based
on the reselection of new S-CSCF to take over the load of the failed one. But
the solution doesn't consider the dynamic load status of newly selected
S-CSCF. Thus, the newly selected S-CSCF may get overloaded or even crashed
because of the transferring-in of load from the failed S-CSCF. In order to
solve this problem, LDF can be used to select one or more low-load S-CSCF to
share the redundant load transferred from the failed S-CSCF.
#### 5.2.5.2 Alternative 1: Load balancing during S-CSCF restoration
(originating procedure)
When a S-CSCF fails, a backup S-CSCF will take the place of the disabled one
during an originating procedure as depicted in TS 23.380. That S-CSCF will
download user backup data from HSS that helps continue setting up the session.
A LDF based load balancing mechanism can be used to improve this procedure.
Fig 5.2-6 Information flow for load balancing during S-CSCF restoration
(originating procedure)
  1. LDF interacts with the S-CSCFs in the same domain to obtain dynamic load information of S-CSCFs, and updates the DNS accordingly.
  2. P-CSCF receives an originating SIP request for a user who has registered on S-CSCF-1.
  3. P-CSCF detects S-CSCF-1 is not accessible.
  4. P-CSCF returns a special error to UE and restarts a registration following the procedure in TS 23.380.
  5. I-CSCF determines and, if necessary, gets capabilities of S-CSCFs from HSS using step 2-6 of Detection Mechanism 1 (in sub-clause 5.3.3) or step 2-5 of Detection Mechanism 2 (in sub-clause 5.3.4).
  6. In the case where Cx response contains server capabilities, I-CSCF constructs a domain name from these capabilities, using a deterministic algorithm and local configuration.
  7. I-CSCF performs a DNS query to resolve the domain name constructed at step 5 or the S-CSCF address received from the HSS at step 4.
  8. I-CSCF receives a response containing address(es) of preferable S-CSCF(s) from DNS.
  9. I-CSCF forwards the message to a selected S-CSCF-2 and the nor _mal registration procedure follows._
  10. _UE sends the originating SIP Request again._
#### 5.2.5.3 Load balancing during S-CSCF restoration (terminating procedure)
When a S-CSCF fails, a backup S-CSCF will take the place of the disabled one
during a terminating procedure as depicted in TS 23.380. That S-CSCF will
download user backup data from HSS that helps continue setting up the session.
A LDF based load balancing mechanism can be used to improve this procedure.
This sub-clause describes an alternative that the backup S-CSCF fetches user
backup data one at a time when a session setup request comes.
Fig 5.x-x Information flow for load balancing during S-CSCF restoration
(terminating procedure)
  1. LDF interacts with the S-CSCFs in the same domain to obtain dynamic load information of S-CSCFs, and updates the DNS accordingly.
  2. The registration procedure follows the existing registration procedure where S-CSCF backs up user data in HSS in TS 23.380.
  3. I-CSCF receives a terminating SIP request for a user who has registerred on S-CSCF-1.
  4. I-CSCF sends LIR message to HSS in order to obtain the address of S-CSCF-1. HSS detects S-CSCF-1 is not accessible. I-CSCF receives LIA message, which contains the capability set, from HSS.
  5. In the case where Cx response contains server capabilities, I-CSCF constructs a domain name from these capabilities, using a deterministic algorithm and local configuration.
  6. I-CSCF performs a DNS query to resolve the domain name constructed at step 5 or the S-CSCF address received from the HSS at step 4.
  7. I-CSCF receives a response containing address(es) of preferable S-CSCF(s) from DNS.
  8. I-CSCF selects S-CSCF-2 from the returned S-CSCFs.
  9. I-CSCF forwards the terminating SIP request to S-CSCF-2.
  10. _S-CSCF-2 downloads the user backup data from the HSS._
  11. _S-CSCF-2 forwards the_ terminating SIP request to UE.
  12. _If another_ terminating SIP request comes for another called user, who also used to register on S-CSCF-1, the restoration procedure repeats the steps 3\~11.
## 5.3 Alternative mechanism for S-CSCF load balancing at Initial Registration
This alternative proposes to re-use existing signalling mechanisms, but where
the HSS, with its current information and knowledge, selects the appropriate
S-CSCF based on different information it has. This information could include:
\- Number of current registered user at the S-CSCF
\- Type of provisioned services of each of those users
\- Number of expected terminals each of those user may have
\- Type of user (residential or business)
\- Additional policies and information received from support system (which
could include current status of the S-CSCFs, such as it is under maintenance
and should not be selected etc)
## 5.4 Architectural alternatives to detect whether S-CSCF re-selection may be
desired
### 5.4.1 General
This section describes mechanisms aiming to detect whether a UE is registered
with a sub-optimal S-CSCF due to the fact that the most preferred S-CSCF was
not available (or highly loaded ) during registration and a more optimal
S-CSCF becomes available.
The detection mechanisms do not support a check on whether there are any on-
going dialogs for the subscription, which should not be released by triggering
S-CSCF re-selection. However, this check may be done as part of the re-
selection mechanism as described in section 5.5.
NOTE: Clause 5.4 does not discuss the mechanisms for how the I-CSCF obtains
information (load or availability) from the S-CSCFs to make the decision on
re-selection.
### 5.4.2 Detection mechanism 1
#### 5.4.2.1 Architectural details
This architectural alternative adds additional functionality and signaling
load compared to Rel-8 to the I-CSCF. Message contents of SIP or Cx messages
are not modified.
At UE re-registration, when the I-CSCF receives the currently assigned S-CSCF
name within Cx-UAA, it may decide to check whether the currently assigned
S-CSCF is the most preferred S-CSCF for the UE based on capabilities. If so,
the I-CSCF sends another Cx-UAR command to the HSS, explicitly requesting
capabilities. When receiving the response Cx-UAA from the HSS containing
capabilities, the I-CSCF calculates the best suited S-CSCF based on
capabilities, compares it with the currently assigned S-CSCF, and if
different, checks whether it is available (and not highly loaded).
#### 5.4.2.2 Information flow
1\. -- 3. Existing Rel-8 procedures are followed.
4\. When the I-CSCF receives the current S-CSCF name within Cx-UAA it may
decide to check, based on operator configuration (e.g. always, during the
night), whether the currently assigned S-CSCF is not the preferred S-CSCF. If
I-CSCF decides not to check, existing Rel-8 procedure is followed; re-
selection is not performed. If I-CSCF decides to check; the procedure is
continued with step 5.
5\. I-CSCF explicitly requests capabilities from the HSS by sending a second
Cx-UAR command. Note that parameters in Cx-UAR to explicitly request
capabilities were already defined in Rel-8.
6\. Capabilities are returned from the HSS (existing Rel-8 procedure).
7\. The I-CSCF calculates the best suited S-CSCF based on the received
capabilities. If the best suited S-CSCF is the currently assigned S-CSCF (i.e.
S-CSCF 2) or the best suited S-CSCF is currently not available, existing Rel-8
procedure is followed. If the best suited S-CSCF is different from the
currently assigned S-CSCF and is available, the I-CSCF may take additional
steps towards S-CSCF re-selection. I-CSCF may rely on information provided by
LDF in order to get the load and availability of the S-CSCF.
NOTE 1: This procedure is similar to a procedure documented in TS 29.228[xx],
where the I-CSCF generates a timeout when no response to the SIP Register was
received.
NOTE 2: The described detection mechanism extends the duration of the re-
registration process and the number of messages between the I-CSCF and the
HSS.
### 5.4.3 Detection mechanism 2
#### 5.4.3.1 Architectural details
This architectural alternative adds additional functionality (compared to
Rel-8) to the I-CSCF and the HSS. It extends Message content of Cx-UAR to
allow requesting both together, the current S-CSCF name and the capabilities.
At UE re-registration, when the I-CSCF receives the SIP REGISTER message, the
I-CSCF may decide to check whether the currently assigned S-CSCF (if any) is
the most preferred S-CSCF for the UE based on capabilities. If so, the I-CSCF
sends Cx-UAR command to the HSS, indicating that the HSS, when it returns the
current S-CSCF name shall in addition also return capabilities. When receiving
the response Cx-UAA from the HSS containing the current S-CSCF name and the
capabilities, the I-CSCF calculates the best suited S-CSCF based on the
capabilities, compares it with the currently assigned S-CSCF, and -- if
different -- checks whether it is available (and not highly loaded).
#### 5.4.3.2 Information flow
1\. I-CSCF receives SIP REGISTER.
2\. I-CSCF may determine, based on operator configuration (e.g. always, during
the night), to get capabilities in order to check whether the currently
assigned S-CSCF (if any) is not the preferred S-CSCF. If it decides not to do
so, existing Rel-8 procedure is followed (not shown in the figure); re-
selection will not be done. If it decides to perform the check, the procedure
is continued with step 3.
3\. I-CSCF indicates to the HSS by means of a new parameter within Cx-UAR that
S-CSCF name (if any) and capabilities are requested.
4\. If the HSS does not support the new indication in Cx-UAR, the new
indication is ignored and the HSS follows existing Rel-8 procedure (not shown
in the figure). In this case the I-CSCF may fall back to detection mechanism 1
(see 5.3.3) step 5. Otherwise the procedure is continued with step 5.
5\. HSS returns the currently assigned S-CSCF name (S-CSCF 2) and capabilities
to the I-CSCF.
6\. The I-CSCF calculates the best suited S-CSCF based on the received
capabilities. If the best suited S-CSCF is the currently assigned S-CSCF
(S-CSCF 2) or the best suited S-CSCF is currently not available, existing
Rel-8 procedure is followed (not shown in the figure). If the best suited
S-CSCF is different from the currently assigned S-CSCF and it is available,
the I-CSCF takes additional steps towards S-CSCF re-selection. I-CSCF may rely
on information provided by LDF in order to get the load and availability of
the S-CSCF.
### 5.4.4 Detection mechanism 3
#### 5.4.4.1 Architectural details
This architectural alternative adds additional functionality (compared
toRel-8) to the I-CSCF, the HSS, and the S-CSCF. It extends the functionality
of the SIP REGISTER message sent from I-CSCF to S-CSCF and the Cx-SAR command
sent from S-CSCF to HSS.
NOTE: It is a stage 3 issue as to how the functionality of the SIP REGISTER is
extended.
A preparation step is performed at initial registration; when the I-CSCF
selects a S-CSCF that is not the preferred S-CSCF (e.g. because the preferred
S-CSCF is not available or highly loaded), the I-CSCF indicates to the
selected (but not preferred) S-CSCF that a better S-CSCF may become available
later. The S-CSCF forwards this information with Cx-SAR to the HSS which
stores the information against the current S-CSCF name.
The actual detection step is then triggered by the HSS which - based on the
stored information (\"better S-CSCF may become available\") -- returns current
S-CSCF name and additionally capabilities within Cx-UAA after receiving Cx-UAR
from the I-CSCF. I-CSCF then may calculate the best suited S-CSCF based on
capabilities and checks whether it is available (and not highly loaded).
#### 5.4.4.2 Information flow (preparation step)
1.- 3. Existing Rel-8 procedures are followed.
4\. I-CSCF selects a less preferred S-CSCF (e.g. because the preferred S-CSCF
is mot available or highly loaded).
5\. I-CSCF indicates to the less preferred but selected S-CSCF that a better
S-CSCF may become available later.
6\. -- 13. Existing Rel-8 procedures are followed. Note that in step 11 the
HSS has not yet stored the information that a better S-CSCF may become
available later and therefore does not return capabilities in addition to the
S-CSCF name in step 12 (see 5.3.8 step 4).
14\. Based on the received information in step 5 the S-CSCF forwards this
information in Cx-SAR to the HSS.
15\. The HSS stores the information \"better S-CSCF may become available
later\" against the S-CSCF name.
16.- 18. Existing Rel-8 procedures are followed.
#### 5.4.4.3 Information flow (actual detection step)
1-2. Existing Rel-8 procedures are followed.
3\. The HSS detects that it has stored the information \"better S-CSCF may
become available later\" against the current S-CSCF.
4\. The HSS returns capabilities in addition to the current S-CSCF name to the
I-CSCF.
5\. The I-CSCF, when receiving the current S-CSCF name and in addition also
the capabilities, calculates the best suited S-CSCF based on the received
capabilities. If the best suited S-CSCF is currently not available, existing
Rel-8 procedure is followed (not shown in the figure). If the best suited
S-CSCF is available, the I-CSCF may take additional steps towards S-CSCF re-
selection.
### 5.4.5 Detection Mechanism 4
The detection for need of S-CSCF re-selection is done by either
  * the interaction between the management system and the HSS. No need for interaction with other network functions. Whenever the management system detects that a subscriber needs to be moved, and based on other policies of whether it is appropriate to move the subscriber at that point in time, the management system can initiate the re-selection procedures as proposed in Clause 5.4.3.
  * local configurations and policies in HSS may also result in triggering of re-selection. This could e.g., in the case a UAR command is sent, the HSS checks whether a more \"optimal\" S-CSCF is available based on local configuration. This is then similar to previous alternatives, but with the decision in the HSS rather than the I-CSCF.
## 5.5 Alternatives to re-select the S-CSCF
### 5.5.1 General
The following requirements need to be fulfilled by the S-CSCF reselection
mechanism:
\- It shall be possible for the operator to control the S-CSCF re-selection
mechanism from the operator\'s management system.
\- It shall be possible for the operator to trigger the S-CSCF re-selection
mechanism for a given subscriber at any given time.
\- The S-CSCF re-selection mechanism shall have the means to force re-
selection only when no on-going dialogs/subscriptions exist.
\- For unregistered users, where the S-CSCF has kept the user profile after
de-registration, S-CSCF re-selection may be applied.
### 5.5.2 Re-Selection mechanism 1
This alternative adds additional functionality (compared to Rel-8) to the
I-CSCF, the HSS, and the S-CSCF. In addition it extends the SIP REGISTER
message sent from I-CSCF to S-CSCF and the SIP 480 message sent from S-CSCF to
I-CSCF.
Message contents of messages via Cx are not modified.
When the decision to try S-CSCF re-selection is taken by the I-CSCF the I-CSCF
forwards the SIP REGISTER message to the currently selected S-CSCF. An new
(compared with Rel-8) indication within the REGISTER message asks the S-CSCF
to reject the REGISTER message, if there are no active sessions for the UE (or
any other UE within the user's subscription). If there are no active sessions,
the S-CSCF returns a 480 message to the I-CSCF. I-CSCF then sends a REGISTER
message to the preferred S-CSCF. Existing Rel-8 procedures then results in re-
assignment of the S-CSCF. Active sessions will not be terminated, because
there are no active sessions.
1\. The I-CSCF sends SIP REGISTER with a new indication \"reject if idle\" to
the assigned but less preferred S-CSCF (S-CSCF 2)
2\. The S-CSCF 2 checks whether there are active sessions for any UE of the
subscription. If there are active sessions (not shown in the figure) S-CSCF 2
continues according to existing Rel-8 procedures; S-CSCF re-assignment is not
performed (delayed to next re-registration).
NOTE: If there are any ongoing sessions this procedure does not result in
changing the S-CSCF, this includes for instance instant messaging sessions or
presence subscriptions.
3\. If there are no active sessions, S-CSCF 2 returns a 480 message to the
I-CSCF indicating that S-CSCF re-assignment may be performed.
4\. I-CSCF sends SIP REGISTER to the preferred S-CSCF (S-CSCF 1).
5\. -- 18. Existing Rel-8 procedures are followed and S-CSCF is changed.
### 5.5.3 Re-Selection mechanism 2
NOTE: Re-selection mechanism 2 is similar to re-selection mechanism 1. The
only difference is that with mechanism 2 the S-CSCF de-registers itself from
the HSS, whereas with mechanism 1 the HSS performs de-registration of the
S-CSCF.
This alternative adds additional functionality (compared to Rel-8) to the
I-CSCF, the HSS, and the S-CSCF. In addition it extends the SIP REGISTER
message sent from I-CSCF to S-CSCF and the SIP 480 message sent from S-CSCF to
I-CSCF.
Message contents of messages via Cx are not modified.
When the decision to try S-CSCF re-selection is taken by the I-CSCF the I-CSCF
forwards the SIP REGISTER message to the currently selected S-CSCF. An new
(compared with Rel-8) indication within the REGISTER message asks the S-CSCF
to reject the REGISTER message, if there are no active sessions for the UE (or
any other UE within the user's subscription). If there are no active sessions,
the S-CSCF returns a 480 message to the I-CSCF and de-registers the user by
sending SAR to the HSS. I-CSCF then sends a REGISTER message to the preferred
S-CSCF. Existing Rel-8 procedures then results in re-assignment of the S-CSCF.
Active sessions will not be terminated, because there are no active sessions.
1\. The I-CSCF sends SIP REGISTER with a new indication \"reject if idle\" to
the assigned but less preferred S-CSCF (S-CSCF 2)
2\. The S-CSCF 2 checks whether there are active sessions for any UE of the
subscription. If there are active sessions (not shown in the figure) S-CSCF 2
continues according to existing Rel-8 procedures; S-CSCF re-assignment is not
performed (delayed to next re-registration).
NOTE: If there are any ongoing sessions this procedure does not result in
changing the S-CSCF, this includes for instance instant messaging sessions or
presence subscriptions.
3\. -- 4. If there are no active sessions, S-CSCF 2 de-registers the user.
5\. S-CSCF 2 returns a 480 message to the I-CSCF indicating that S-CSCF re-
assignment shall be performed.
6\. I-CSCF sends SIP REGISTER to the preferred S-CSCF (S-CSCF 1).
7\. -- 18 Existing Rel-8 procedures are followed and S-CSCF is changed.
### 5.5.4 Re-Selection mechanism 3
This alternative proposes to re-use the existing mechanism that allows S-CSCF
re-selection. By using the Administrative de-registration procedure, the
operator can force a subscriber to de-register and perform a new registration
(at which time the subscriber will be allocated to the new S-CSCF).
This procedure can also be done automatically if either the management system
has implemented such function or local policies exist in the HSS that can take
such decision.. The Administrative de-registration procedure can be done at
the time chosen by the operator if needed.
If it is required to do the S-CSCF re-selection when no active dialogs exist,
the current procedures could easily be extended with including such additional
criteria in the administrative de-registration command. In essence, this
implies that the administrative de-registration command over Cx is extended
with an indication that de-registration should only be done if no ongoing
sessions exist. To solve the requirement to optionally allow S-CSCF re-
selection also for un-registered user state in S-CSCF, a user de-assigning
message could similar be sent also during the unregistered state from the HSS
to the S-CSCF currently allocated.
# 6 Assessment
  * Editor's Note: This section will assess all possible solutions and > summarize the benefits and possibly the limitations of each > solution.
## 6.1 Assessment of alternatives for overload control
### 6.1.1 P-CSCF overload control
There are three alternatives for P-CSCF overload control. Alternative 1
documented in subclause 5.1.1 provides an overload control mechanism based on
redirection. With this solution, P-CSCF needs to be enhanced to support
feeding back other preferred P-CSCF(s). The list of backup P-CSCF(s) can
either be pre-configured within each P-CSCF or fetched from LDF, which forms
alternative 3 as documented in subclause 5.2.2.3. With alternative 3, a new
logical function, LDF, should be defined to collect dynamic load information
from P-CSCFs and make appropriate P-CSCFs updated through a new interface.
Alternative 2 documented in subclause 5.1.2 states a DNS re-request mechanism,
which is widely used in existing systems. It also mentions that LDF based
mechanism depicted in subclause 5.2.2 can be used for DNS considering dynamic
load information.
LDF may be co-located with P-CSCF or DNS server, but does not need to be
implemented in a new physical entity.
Table: P-CSCF overload control alternatives.
* * *
Alternatives Impact on P-CSCF Impact on DNS Impact on UE Impact on SIP
protocol Alt 1 in 5.1.1 : overloaded P-CSCF returns the preferred P-CSCF
yes(Preconfigration of alternative P-CSCF and redirect UE to other P-CSCF) no
yes(Perform the registration to the redirected P-CSCF) yes(Protocol extention
for the redirection of P-CSCF) Alt 2 in 5.1.2: DNS returns preferred P-CSCF
yes (only to report load info), if used with LDF no no no Alt 3 in 5.2.2.3:
overloaded P-CSCF queries LDF and returns preferred P-CSCF yes(Report its load
info to LDF and retrieve load info of redirected P-CSCF from LDF and redirect
UE to other P-CSCF) no yes(Perform the registration to the redirected P-CSCF)
yes (Protocol extention for the redirection of P-CSCF)
* * *
### 6.1.2 S-CSCF overload control
Subclause 5.2.3.3 proposes an S-CSCF overload control solution based on LDF,
which is quite similar to that one for P-CSCF overload control.
LDF may be co-located with S-CSCF or DNS server, but does not need to be
implemented in a new physical entity.
If Load Balancing is used from the I-CSCF, this solution is not needed as it
is not likely that an overloaded S-CSCF gets selected.
Table: S-CSCF overload control alternatives
* * *
Alternatives Impact on S-CSCF Impact on DNS Impact on I-CSCF Impact on SIP
protocol Alt in 5.2.3.3: overloaded S-CSCF queries LDF and returns preferred
S-CSCF yes(Report its load info to LDF and retrieve load info of redirected
S-CSCF from LDF, overload judgement and redirect to other S-CSCF) no
yes(redirect to other S-CSCF as required) yes (Protocol extention for the
redirection of S-CSCF)
* * *
## 6.2 Assessment of alternatives for Load Balancing
### 6.2.1 P-CSCF Load Balancing
Subclause 5.2.2.2 gives a LDF based P-CSCF load balancing solution. LDF
collects load information from P-CSCFs as it can do in P-CSCF overload
control.
LDF may be co-located with P-CSCF or DNS server, but does not need to be
implemented in a new physical entity.
Table: P-CSCF load balancing alternatives
* * *
Alternatives Impact on P-CSCF Impact on DNS Impact on UE Impact on SIP
protocol Alt in 5.2.2.2: UE queries DNS to get preferred P-CSCF yes (only to
report load info) no no no
* * *
### 6.2.2 S-CSCF Load Balancing
#### 6.2.2.1 S-CSCF selection during initial registration
The solution documented in subclause 5.2.3.2 provides a LDF based Load
Balancing mechanism for selecting S-CSCF during initial registration. LDF
collects load information from S-CSCFs as it can do in P-CSCF overload control
and load balancing. I-CSCF needs to be enhanced to a construct domain name
from a capabilities list, of S-SCSF capabilities are used. LDF may be co-
located with S-CSCF or DNS server, but does not need to be implemented in a
new physical entity.
Another solution documented in clause 5.3 proposes to re-use existing
signalling mechanisms with the supporting system providing additional policy
and information. This solution may require to specify the interface and
signalling interaction between the supporting system and HSS.
Table: S-CSCF Load Balancing alternatives
* * *
Alternatives Impact on S-CSCF Impact on DNS Impact on I-CSCF Impact on SIP
protocol Impact on HSS Alt1 in 5.2.3.2: I-CSCF constructs domain name yes
(only to report load info) no yes(Construct domain name based on the query
from HSS) no no Alt 2 in 5.3: HSS returns preferred S-CSCF no no no no
yes(Implement optimal S-CSCF selection algothrim based on the information HSS
and the supporting system have)
* * *
#### 6.2.2.2 S-CSCF re-selection during re-registration
There are two issues identified during the study for S-CSCF re-selection
during re-registration. The first issue is to detect whether the S-CSCF re-
selection is required. The other issue is to execute the re-selection.
There are five alternatives to handle the first issue. The assessment of them
is as follows:
Alternative 1 documented in subclause 5.4.2 adds additional functionality and
signaling load (compared to Rel-8) to the I-CSCF. Message contents of SIP or
Cx messages are not modified.
Alternative 2 documented in subclause 5.4.3 adds additional functionality
(compared to Rel-8) to the I-CSCF and the HSS. It extends Message content of
Cx-UAR to allow requesting both together, the current S-CSCF name and the
capabilities.
Alternative 3 documented in subclause 5.4.4 adds additional functionality
(compared toRel-8) to the I-CSCF, the HSS, and the S-CSCF. It extends the
functionality of the SIP REGISTER message sent from I-CSCF to S-CSCF and the
Cx-SAR command sent from S-CSCF to HSS.
Alternative 4 can provide load information via network management system. It
can in such case be treated as LDF is integrated in OSS system.
Alternative 5 documented in subclause 5.2.4 let I-CSCF determine and, if
necessary, gets capabilities of S-CSCFs from HSS like Alternative 1 or
Alternative 2. Besides, I-CSCF needs to be enhanced to construct domain name.
LDF collects load information from S-CSCFs and can be a function of S-CSCF.
Table: S-CSCF re-selection determine alternatives.
* * *
Alternatives Impact on S-CSCF Impact on DNS Impact on I-CSCF Impact on SIP
protocol Impact on HSS Impact on diameter protocol Impact on ongoing sessions
Alt1 in5.4.2: I-CSCF decides the preferred S-CSCF yes(only to report load
info) no yes(Check if the best S-CSCF is selected based on the first UAR/UAA
and send the second UAR to get the S-CSCF capabilities) no no no no Alt 2 in
5.4.3 : I-CSCF queries HSS with S-CSCF name and capabilities yes (only to
report load info) no yes(Send UAR to get the current S-CSCF and capabilities
and decide on the preferred S-CSCF) no yes(Return the current S-CSCF and
capabilities at the same time) yes(UAR/UAA needs to be extended to contain
S-CSCF and capabilities no Alt3 in 5.4.4 : with fallback S-CSCF yes(only to
report load info) no yes(preferred S-CSCF selection and mark the indication of
better S-CSCF in the forwarded REGISTER) yes(REGISTER needs to be extended to
indicate a better S-CSCF is available later) No yes(SAR needs to be extended
to indicate a better S-CSCF might be available later) no Alt4 in 5.4.5 : HSS
based solution yes (only to report load info) no no no yes(HSS may need to
interact with O&M to get the status of S-CSCF) don't know don't know Alt5 in
5.2.4 : I-CSCF constructs Domain name yes(only to report load info) no
yes(Construct domain name based on the query from HSS) no no no no
* * *
Three mechanisms for executing the re-selection are presented in this
document. The assessment is as follows:
Both alternative 1 documented in subclause 5.5.2 and alternative 2 documented
in subclause 5.5.3 will work, no matter taking the load information into
account or not.
Alternative 1 adds additional functionality (compared to Rel-8) to the I-CSCF,
the HSS, and the S-CSCF. In addition it extends the SIP REGISTER message sent
from I-CSCF to S-CSCF and the SIP 480 message sent from S-CSCF to
I-CSCF.Message contents of messages via Cx are not modified.
Alternative 2 adds additional functionality (compared to Rel-8) to the I-CSCF,
the HSS, and the S-CSCF. In addition it extends the SIP REGISTER message sent
from I-CSCF to S-CSCF and the SIP 480 message sent from S-CSCF to
I-CSCF.Message contents of messages via Cx are not modified.
The only difference between the above two alternatives is that in alternative
2 the original S-CSCF deregisters itself from HSS whereas in alternative 1 it
is HSS who deregister S-CSCF. But from S-CSCF re-selection point of view,
these two alternatives are same.
Alternative 3 uses administrative mechanism to deregister S-CSCF. It may
increase the complexity of OSS system if providing a per-user supervising and
load balancing.
Table: S-CSCF re-selection execution alternatives.
* * *
Alternatives Impact on S-CSCF Impact on DNS Impact on I-CSCF Impact on SIP
protocol Impact on HSS Impact on diameter protocol Alt1 in5.5.2: overloaded
S-CSCF returns preferred S-CSCF if there is no active session yes(Send back
480 to I-CSCF if there is no active session) no yes(Registration to the
preferred S-CSCF) yes(REGISTER needs to be extended to indicate a better
S-CSCF is available later) no no Alt2 in5.5.3: overloaded S-CSCF returns
preferred S-CSCF if there is no active session, overloaded S-CSCF de-register
itself yes(Send back 480 to I-CSCF if there is no active session and then de-
register itself no yes (Registration to the preferred S-CSCF) yes(REGISTER
needs to be extended to indicate a better S-CSCF is available later) no no
Alt3 in 5.5.4 : using HSS based solution yes(only to report load info) no no
no yes(to get load information) don't know
* * *
#### 6.2.2.3 S-CSCF Load Balancing during restoration
The alternative documented in subclause 5.2.5 proposes introducing LDF in the
S-CSCF restoration procedure as depicted in TS 23.380. I-CSCF needs to be
enhanced to construct domain name. LDF collects load information from S-CSCFs
and may be co-located with S-CSCF or DNS server.
### 6.2.3 General consideration on Load Balancing
An additional advantage of the LDF-based solutions assessed in 6.1 and 6.2 is
that the LDF architecture is applicable to any entity, even those not
documented in this TR.
# Conclusion
  * Editor's Note: This section will draw a conclusion on the potential > alternative solutions after assessment.
###### ### Annex A(Informative): DNS UPDATE Mechanism
DNS RR (Resource Record) has some attributes (e.g., weight parameter), which
can be used to record network entities' dynamic load information. And RFC 2136
defines an UPDATE message to modify DNS RR. So a new interface could be added
between DNS and LDF and the UPDATE message is used to periodically refresh the
network entities' load state in order to assign a low-load network entity to
the requester.
DNS periodic UPDATE messages might increase the pressure of DNS, and to
relieve the pressure of DNS, the UPDATE interval could be prolonged to a
certain extent and all P-CSCF load information can be batch updated from LDF
to DNS.
Referring to RFC 2136, the UPDATE message can be used to update an existing RR
or a group of RRs periodically. The real-time load information of P-CSCF
detected by LDF can be transmitted to DNS every predefined interval. And the
load message can be encapsulated in additional data of the UPDATE message.
+---------------------+
\| Header \|
+---------------------+
\| Zone \| specifies the zone to be updated
+---------------------+
\| Prerequisite \| RRs or RRsets which must (not) preexist
+---------------------+
\| Update \| RRs or RRsets to be added or deleted
+---------------------+
\| Additional Data \| additional data
The load information contained in the additional data of UPDATE message can
include the following factors:
  * The current CPU and memory usage of P-CSCF;
  * The number of current registered users in P-CSCF;
  * The number of users with active sessions in P-CSCF;
  * The maximum number of registered users in P-CSCF;
And all of the information is indicated by the weight parameter in the SRV RR.
(See RFC 2782)
###### ### Annex B (Informative): IMS Deployment Scenarios
When an operator deploys a core network, no matter whether it is IMS, the
first thing to consider is the geographical distribution of its potential
users. The user distribution is a key factor to influence the arrangement of
the access network, which may in turn have major impact on the deployment of
core network. To make things simple, some other factors, i.e. the provisioning
of the carrier network and the interworking between different types of core
network, are temporally put aside here.
Figure B.1 User Distribution Scenarios
Figure B.1 illustrates four general user distribution scenarios that an
operator may meet while deploying IMS. See the following explanations:
Figure (a) illustrates the scenario that the potential users reside in a large
area with no centralized characteristic；
Figure (b) illustrates the scenario that most of the potential users in a
large area gathering at only one central place while a few users are
dispersed.
Figure (c) illustrates the scenario that most of the potential users in a
large area gathering at more than one central place while a few users are
dispersed.
Figure (d) illustrates the scenario that the potential users are distributed
in a small area.
A certain operator may care for only one or two of the above scenarios.
Different scenarios, together with the operator's own operational
requirements, will decide where the IMS functional entities should be located.
Those logical entities located in the same place can be implemented together
to save CAPEX and OPEX.
**Key Issues for Operators While Deploying IMS**
While deploying IMS, the operators need to take the following issues into
consideration:
  * The geographical positioning of IMS entities;
  * The physical combination of IMS logical functional modules located in the same place, e.g. xCSCF;
  * The organization of user data, which may deduce the positioning and organization of data related entities such as HSS;
  * The organization of service platform, e.g., the positioning and organization of ASs;
  * The interworking of IMS with other core networks, e.g. PLMN/PSTN;
  * The entry to IMS (e.g. GGSN/PDN GW and SBC related issues)..
For each user distribution scenario mentioned above, there may exist one most
suitable solution, or there may exist general solutions for several scenarios
or, ideally, even all scenarios. The last situation, obviously, will direct
the optimization and evolution of IMS.
#