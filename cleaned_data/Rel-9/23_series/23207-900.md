# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides the framework for end-to-end Quality of Service
involving GPRS and complements TS 23.107 [3] which describes the framework for
Quality of Service within UMTS. The end-to-end QoS architecture is provided in
Figure 1. The document describes the interaction between the TE/MT Local
Bearer Service, the GPRS Bearer Service, and the External Bearer Service, and
how these together provide Quality of Service for the End-to-End Service. The
document also describes IP level mechanisms necessary in providing end-to-end
Quality of Service involving GPRS networks, including possible interaction
between the IP level and the GPRS level, as well as the application level and
the IP level.
This document covers different architectural aspects of the end-to-end Quality
of Service concept and architecture with varying level of detail. In general,
other specifications shall be referred to for further details; these other
specifications enable the reader to acquire the full understanding of the end-
to-end Quality of Service concept and architecture. In particular, the stage 2
specification for the PCC architecture is specified in TS 23.203 [21]. The
present document does not contain any requirements for the PCC architecture.
In contrast to the TS 23.107 [3], the present document is only applicable to
GPRS packet switched access services, and includes aspects of interworking to
the IM subsystem as well as PSTN and other networks. The document does not
cover the circuit switched access services.
Figure 1: End-to-End QoS Architecture
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 22.228: \"Service requirements for the Internet Protocol (IP)
multimedia core network subsystem (IMS); Stage 1\".
[2] 3GPP TS 23.002: \"Network Architecture\".
[3] 3GPP TS 23.107: \"QoS Concept and Architecture\".
[4] 3GPP TS 23.228: \"IP Multimedia (IM) Subsystem -- stage 2\".
[4a] Void.
[4b] Void.
[4c] Void.
[5] 3GPP TS 21.905: \"Vocabulary for 3GPP Specifications\".
[6] RFC 2475: \"An Architecture for Differentiated Services (DiffServ)\".
[7] RFC 2753: \"A Framework for Policy-based Admission Control \".
[8] RFC 2748: \"Common Open Policy Service protocol (COPS)\".
[9] RFC 2205: \"Resource ReSerVation Protocol (RSVP)\".
[10] RFC 2209: \"Resource ReSerVation Protocol (RSVP) Message Processing
Rules\".
[11] RFC 2210: \"The use of RSVP with IETF integrated Services\".
[12] RFC 1633: \"Integrated Services in the Internet Architecture: an
Overview\".
[13] RFC 3261: \"SIP: Session Initiation Protocol\".
[14] RFC 2327: \"Session Description Protocol\".
[15] RFC 2998: \"A Framework For Integrated Services Operation Over DiffServ
Networks\".
[16] RFC 2750: \"RSVP Extensions for Policy Control\".
[17] RFC 2474: \"Definition of the Differentiated Services Field (DS Field) in
the IPv4 and IPv6 Headers\".
[18] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[19] 3GPP TS 23.060: \"General Packet Radio Service (GPRS) Service
description; Stage 2\".
[20] 3GPP TS 23.221: \"Architecture requirements\".
[21] 3GPP TS 23.203: \"Policy and Charging Control Architecture\".
[22] 3GPP TS 29.212: \"Policy and Charging Control over Gx reference point\".
[23] 3GPP TS 29.213: \"Policy and Charging Control signalling flows and QoS
parameter mapping\".
[24] 3GPP TS 29.214: \"Policy and Charging Control over Rx reference point\".
# 3 Definitions and Abbreviations
## 3.1 Definitions
**RSVP** : Resource ReSerVation Protocol: The RSVP protocol, RFC 2205 [9], is
used by a host to request specific qualities of service from the network for
particular application data streams or flows. The network responds by
explicitly admitting or rejecting RSVP requests.
**DiffServ** : DiffServ networks classify packets into one of a small number
of aggregated flows or \"classes\", based on the DiffServ codepoint (DSCP) in
the packet\'s IP header. This is known as behaviour aggregate (BA)
classification (RFC 2475 [6]). At each DiffServ router, packets are subjected
to a \"per-hop behaviour\" (PHB), which is invoked by the DSCP (RFC 2474
[17]).
**IntServ** : The integrated services architecture RFC 1633 [12] defined a set
of extensions to the traditional best effort model of the Internet with the
goal of allowing end-to-end QOS to be provided to applications. One of the key
components of the architecture is a set of service definitions; the current
set of services consists of the controlled load and guaranteed services. The
architecture assumes that some explicit setup mechanism is used to convey
information to routers so that they can provide requested services to flows
that require them. While RSVP is the most widely known example of such a setup
mechanism, the IntServ architecture is designed to accommodate other
mechanisms.
**Application Function** : The Application Function (AF) is an element
offering applications that require the control of IP bearer resources . The AF
is capable of communicating with the PCRF to transfer dynamic QoS-related
service information. One example of an AF is the P-CSCF of the IM CN
subsystem.
**AF session** : An AF session is established by an application level
signalling protocol offered by the AF that requires a session set-up with
explicit session description before the use of the service. One example of an
AF session is an IMS session.
**AF session signalling** : AF session signalling is used to control the AF
session. One example of AF session signalling is SIP/SDP.
**Policy control** : The process whereby the Policy and Charging Rules
Function (PCRF) indicates to the Policy and Charging Enforcement Function
(PCEF) how to control the IP-CAN bearer. Policy control includes QoS control
and/or gating control.
## 3.2 Abbreviations
For the purpose of the present document, the following abbreviations apply:
AF Application Function
APN Access Point Name (*)
DiffServ Differentiated Services
DSCP DiffServ Code Point
GERAN GSM/EDGE Radio Access Network (*)
GGSN Gateway GPRS Support Node (*)
HTTP Hypertext Transfer Protocol (*)
IMS IP Multimedia Subsystem
IntServ Integrated Services
LAN Local Area Network
LDP Label Distribution Protocol
MPLS Multiprotocol Label Switching Architecture
PCC Policy and Charging Control
PCEF Policy and Charging Enforcement Function
PHB Per Hop Behaviour
PCRF Policy and Charging Rules Function
RNC Radio Network Controller (*)
SDP Session Description Protocol
SIP Session Initiation Protocol (*)
SNMP Simple Network Management Protocol (*)
TFT Traffic Flow Template (*)
* This abbreviation is covered in 21.905v 4.2.0 [18]
# 4 High Level Requirements for End-to-End IP QoS
## 4.1 End-to-End QoS Negotiation Requirements
\- The UMTS QoS negotiation mechanisms used for providing end-to-end QoS shall
be backward compatible with UMTS Release 1999.
\- The UMTS QoS negotiation mechanisms used for providing end-to-end QoS shall
not make any assumptions about the situation in external networks which are
not within the scope of 3GPP specifications.
\- The UMTS QoS negotiation mechanisms used for providing end-to-end QoS shall
not make any assumptions about application layer signalling protocols.
\- No changes to non-UMTS specific QoS negotiation mechanisms.
\- The UMTS QoS negotiation mechanisms used for providing end-to-end QoS shall
not make any assumptions about applications which may be used on terminal
equipment attached to mobile terminals.
\- Unnecessary signalling complexity and processing complexity in the network
elements as well as the mobile terminal shall be avoided.
\- Unnecessary signalling traffic due to end-to-end QoS negotiation shall be
avoided.
\- Methods for user authentication as well as billing and charging mechanisms
related to the end-to-end QoS negotiation shall be kept as simple as possible.
\- Minimum changes to network architecture and mechanisms due to introduction
of end-to-end QoS negotiation.
\- It shall be possible for an application on the external device to request
end-to-end QoS.
## 4.2 QoS Policy Requirements
\- The UMTS policy mechanisms described in TS 23.060 [19] shall be used for
control of the UMTS bearers.
\- Interaction between UMTS bearer services and IP bearer services shall only
occur at the translation function in the UE and GGSN.
# 5 End-to-End QoS Architecture
## 5.1 QoS Management Functions in the Network
To provide IP QoS end-to-end, it is necessary to manage the QoS within each
domain. An IP BS Manager is used to control the external IP bearer service.
Due to the different techniques used within the IP network, this communicates
to the UMTS BS manager through the Translation function.
At PDP context setup the user shall have access to one of the following
alternatives:
\- Basic GPRS IP connectivity service: The bearer is established according to
the user\'s subscription, local operator\'s IP bearer resource based policy,
local operator\'s admission control function and GPRS roaming agreements. In
this case, IP bearer resource based local policy decisions may be applied to
the bearer.
\- Enhanced GPRS based services: The bearer is used to support an enhanced
application-layer service, such as IM. In this case, policy control decisions
(e.g., authorization and policy based control) are also applied to the bearer.
To enable coordination between events in the application layer and resource
management in the IP bearer layer, a logical element, the Policy and Charging
Rules Function (PCRF), is used as a logical policy decision element. It is
also possible to implement a policy decision element internal to the IP BS
Manager in the GGSN. The IP policy architecture does not mandate the policy
decision point to be external to the GGSN.
Whenever resources not owned or controlled by the UMTS network are required to
provide QoS, it is necessary to interwork with the external network that
controls those resources. Interworking may be realised in a number of ways,
including:
\- signalling along the flow path (e.g. RSVP, LDP).
\- packet marking or labelling along the flow path (e.g. DiffServ, MPLS)
\- interaction between Policy Control and/or Resource Management elements.
\- Service Level Agreements enforced by the border routers between networks.
For the policy control the following should apply:
\- The IP policy framework employed in UMTS should, as far as possible,
conform to IETF \"Internet Standards\". The IETF policy framework may be used
for policy decision, authorization, and control of the IP level functionality,
at both user and network level.
\- There should be separation between the scope and roles of the UMTS policy
mechanisms and the IP policy framework. This is to facilitate separate
evolution of these functions.
### 5.1.1 Description of functions
#### 5.1.1.1 QoS management functions for end-to-end IP QoS in UMTS Network
NOTE: The end-to-end QoS management functions do not cover the cases of a
circuit switched service, or an IP service interworking with an ATM service at
the gateway node.
**IP BS Manager** uses standard IP mechanisms to manage the IP bearer
services. These mechanisms may be different from mechanisms used within the
UMTS, and may have different parameters controlling the service. When
implemented, the IP BS Manager may include the support of DiffServ Edge
Function and the RSVP function. The **Translation/mapping function** provides
the inter-working between the mechanisms and parameters used within the UMTS
bearer service and those used within the IP bearer service, and interacts with
the IP BS Manager. In the GGSN, the IP QoS parameters are mapped into UMTS QoS
parameters, where needed. In the UE, the QoS requirements determined from the
application layer (e.g., SDP) are mapped to either the PDP context parameters
or IP layer parameters (e.g., RSVP).
If an IP BS Manager exists both in the UE and the Gateway node, it is possible
that these IP BS Managers communicate directly with each other by using
relevant signalling protocols.
The required options in the table define the minimum functionality that shall
be supported by the equipment in order to allow multiple network operators to
provide interworking between their networks for end-to-end QoS. Use of the
optional functions listed below, other mechanisms which are not listed (e.g.
over-provisioning), or combinations of these mechanisms are not precluded from
use between operators.
The IP BS Managers in the UE and GGSN provide the set of capabilities for the
IP bearer level as shown in table 1. Provision of the IP BS Manager is
optional in the UE, and required in the GGSN.
Table 1: IP BS Manager capability in the UE and GGSN
* * *
Capability UE GGSN DiffServ Edge Function Optional Required RSVP/IntServ
Optional Optional IP Policy Enforcement Point Optional Required (*)
* * *
(*) Although the capability of IP policy enforcement is required within the
GGSN, the control of IP policy through the GGSN is a network operator choice.
Figure 2 shows the scenario for control of an IP service using IP BS Managers
in both possible locations in the UE and Gateway node. The figure also
indicates the optional communication path between the IP BS Managers in the UE
and the Gateway node.
**Policy and Charging Rules Function (PCRF)** encompasses policy control
decision and flow based charging control functionalities. The PCRF provides
network control regarding the service data flow detection, gating, and QoS
towards the GGSN. The PCRF makes policy control decisions, and communicates
these decisions to the IP BS Manager in the GGSN, which is the Policy and
Charging Enforcement Point (PCEF).
The interface between the PCRF and the Application Function (AF) is the Rx
interface, and is included in the Reference Architecture depicted in TS 23.002
[2].
The interface between the PCRF and GGSN is specified within 3GPP, named Gx
interface, and is included in the Reference Architecture depicted in TS 23.002
[2]. The interface between the PCRF and GGSN supports the transfer of
information and policy decisions between the policy decision point and the IP
BS Manager in the GGSN.
The PCRF makes policy decisions based on input obtained from the AF as well as
from other sources, e.g. operator configuration. The PCRF maps the policy set-
up information received from the AF via the Rx interface into IP QoS
parameters. The PCRF is in the same domain as the GGSN. The AF may either be
in the same network as the PCRF or may be in a different network. In the
particular case of IMS, the AF is the P-CSCF which is in the same network as
the GGSN, as specified in TS 23.221 [20].
**Application Function (AF)** offers services that require the control of IP
bearer resources. The AF maps QoS-related application level parameters (e.g.
SDP) into policy set-up information, and sends this information to the PCRF
via the Rx interface.
#### 5.1.1.2 (void)
#### 5.1.1.3 Interaction to External Networks
Within the UMTS network, there is resource management performed by various
nodes in the admission control decision. The resources considered here are
under the direct control of the UMTS network.
In IP Networks, it is also necessary to perform resource management to ensure
that resources required for a service are available. Where the resources for
the IP Bearer Service to be managed are not owned by the UMTS network, the
resource management of those resources would be performed through an
interaction between the UMTS network and that external network.
In addition, where the UMTS network is also using external IP network
resources as part of the UMTS bearer service (for example for the backbone
bearer service), it may also be necessary to interwork with that network.
The GGSN shall support DiffServ edge functionality. There are a number of
other mechanisms provided to support interoperator interworking, some of which
are given below.
NOTE: This list is not exhaustive. Other options are possible.
\- Signalling along the flow path: In this scenario, resource requirements are
explicitly requested and either granted or rejected through the exchange of
signalling messages between network elements along the path of the IP packet
flow. Signalling may be performed on a per-flow basis (e.g. using end to end
RSVP) or it may be performed for an aggregate set of flows. In the latter
case, it is expected that signalling exchanges would only be required when
there are changes required in the resources allocated to an aggregate set of
flows.
\- Interaction between network management entities: In this scenario, resource
requirements need to be explicitly negotiated and provisioned through network
management entities. The results of this exchange are then enforced in the
border nodes separating DiffServ administrative domains.
\- Service Level Agreements enforced by the border routers between networks:
In this scenario, resources are allocated along the path based on agreements
between the network operators. The border routers along the path flow are
provisioned with the characteristics of the aggregated traffic that is allowed
to flow between systems.
#### 5.1.1.4 Translation/mapping function in the GGSN and the UE
Translation/mapping function interacts with the IP BS Manager and with the
UMTS BS Manager in the GGSN and in the UE. It provides interworking between
the mechanisms and parameters used within the UMTS bearer service and those
used within the IP bearer service.
For policy control, the translation/mapping function in the GGSN maps IP
bearer based policy information into UMTS bearer based policy information.
This mapping is used by the GGSN for policy control over the UMTS network.
### 5.1.2 Allocation of QoS management functions
#### 5.1.2.1 QoS management functions for end-to-end IP QoS
The QoS management functions for controlling the external IP bearer services
and how they relate to the UMTS bearer service QoS management functions are
shown in Figure 2.
Figure 2: QoS management functions for UMTS bearer service in the control
plane and QoS management functions for end-to-end IP QoS
NOTE 1: The dimmed boxes in Figure 2 are clarified in TS 23.107 [3].
NOTE 2: The UE is only shown as a combined element, but it may also consist of
a split TE/MT. Standardization of the interface and operation within a split
UE is outside the scope of this TS.
## 5.2 Capabilities of Functional Elements
This section provides functional descriptions of capabilities in GGSN, UE,
PCRF, and AF.
### 5.2.1 GGSN
This clause provides functional descriptions of capabilities in GGSN. The
capabilities are part of IP BS Manager (see 5.1.1.1) or corresponding user
plane functions. Determination of exactly which functions are required to
support interoperator and multi-vendor aspects are not addressed in this
clause.
The **DiffServ Edge Function** shall be compliant to the IETF specifications
for Differentiated Services (RFC 2475 [6]). The IETF Differentiated Services
architecture will be used to provide QoS for the external bearer service.
Parameters for the DiffServ Edge Function (i.e. classifiers, meters, packet
handling actions) may be statically configured on the GGSN, derived from PDP
Context parameters and/or derived from RSVP signalling.
DiffServ functions configured on the basis of PDP Context parameters consist
of marking user packets. The DSCP to be used is derived from the PDP Context
parameters according to statically configured rules.
Statically configured DiffServ functions may include classifiers, meters,
markers, droppers and shapers acting on uplink traffic.
**Policy and Charging Enforcement Function (PCEF)** controls the user plane
quality of service that is provided including policy-based admission control
that is applied to the bearer and gating control. Policy decisions are either
pushed to or requested by the GGSN via the Gx interface.
Policy-based admission control ensures that the resources that can be used by
a particular set of IP flows are within the \"authorized resources\" specified
via the Gx interface. The authorized resources provide an upper bound on the
resources that can be reserved or allocated for the set of IP flows.
The authorized resources are expressed as a maximum authorized bandwidth and
QoS class. The QoS class identifies a bearer service (which has a set of
bearer service characteristics associated with it). The PCRF generates a
maximum authorized QoS class for the set of IP flows. This information is
mapped by the translation/mapping function in the GGSN to give the authorized
resources for UMTS bearer admission control.
In the user plane, policy enforcement for an individual or a set of IP flows
is defined in terms of a \"gate\" implemented in the GGSN. A gate is part of
the policy enforcement functionality and is controlled by the PCRF through Gx
interface signalling. A gate consists of a packet classifier, and a gate
status (open/closed). When a gate is open, the packets matching the packet
classifier are accepted, and are thus subject to the DiffServ edge treatment
in uplink direction or forwarded in their corresponding PDP context in
downlink direction. When a gate is closed, all of the packets matching the
packet classifier are dropped.
### 5.2.2 UE
This clause provides functional descriptions of capabilities in UE. The
capabilities are part of IP BS Manager (see 5.1.1.1) or corresponding user
plane functions. Determination of exactly which functions are required to
support interoperator and multi-vendor aspects are not addressed in this
clause.
**DiffServ Edge Function** acts as a DiffServ (DS) boundary for the traffic
from applications running on the UE. As specified in RFC 2475 [6], DS boundary
node must be able to apply the appropriate PHB to packets based on the DS code
point. In addition, DS boundary nodes may be required to perform traffic
conditioning functions. When GGSN DiffServ marking is used, the DiffServ edge
function in the UE is not needed.
**RSVP/IntServ Function** provides the capability for the UE to request end-
to-end QoS using RSVP messages as defined in IETF standards. RSVP messages may
also be used by the network to inform the DSCP to be used by the UE. RSVP
messages shall include the authorization token and flow identifier(s) in a
policy data object if the authorization token is available in the UE. RSVP may
be used to trigger PDP context activation/modification. The inter-working
between MT and TE is FFS.
### 5.2.3 Void
### 5.2.3a PCRF
This clause provides high level functional descriptions of PCRF capabilities.
The PCRF makes policy decisions, e.g. based on policy set-up information
obtained from the AF via the Rx interface.
\- The PCRF checks that if the policy set-up information received from the AF
is consistent with operator policies defined in the PCRF.
\- The PCRF authorizes QoS resources (bandwidth, etc.) for the AF session. The
PCRF uses the policy set-up information received from the AF to calculate the
proper authorization. The authorization includes the limits on QoS for the set
of IP flows and restrictions on individual IP flows (e.g. destination address
and port).
\- The PCRF decides if new QoS authorization (bandwidth, etc.) is needed due
to a mid-call media or codec change. The PCRF re-authorizes QoS resources when
the resources requested by the UE for a flow exceeds previous authorization,
or a new flow is added, or when elements of the packet classifier(s) for
authorized flows change.
\- The PCRF provides the policy decision information to the GGSN via the Gx
interface.
\- The PCRF provides gating control decisions controlling the gate for the
authorized media stream.
\- At AF session release, the PCRF revokes the QoS resource authorization for
the AF session.
For further details, see TS 23.203 [21].
### 5.2.4 Application Function (AF)
The Application Function (AF) is an element offering applications that require
the control of IP bearer resources (e.g. UMTS PS domain/GPRS domain
resources). One example of an Application Function is the P-CSCF in the IMS
architecture.
Policy control related functions
\- The AF uses the Rx interface to exchange service based policy set-up
information with the PCRF. This applies both during session establishment, as
well as upon a mid-session modification affecting the media (e.g. addition of
a new media in mid-session).
\- The AF may give instructions to the PCRF defining how the PCRF shall
interact with the PCEF for certain events related to policy control. The AF is
able to give instructions to the PCRF to act on its own, i.e. based on the
service information currently available, for the following events:
\- The authorization of QoS resources for the AF session;
\- The gate control (i.e. whether there is a common gate handling per AF
session or an individual gate handling per AF session component required);
\- The forwarding of transmission resource level events.
For further details, see TS 23.203 [21].
## 5.3 Void
## 5.3aVoid
## 5.3b Gx reference point (PCRF -- GGSN)
The Gx interface is the interface between the PCRF and the GGSN. The Gx
interface allows policy control and QoS information to be \"pushed\" to or
requested by the GGSN from the PCRF. The Gx interface provides information to
support the policy enforcement functions in the GGSN:
\- Control of \"gating\" function in GGSN;
\- UMTS bearer authorization.
For further details, see TS 23.203 [21].
## 5.3c Rx reference point (AF - PCRF)
The Rx interface is the interface between the AF and the PCRF. The Rx
interface is used for policy set-up information exchange and event reporting.
The Rx interface allows service based QoS information needed for QoS
authorization to be exchanged between the AF and the PCRF. This information is
used by the PCRF for policy control decisions.
One PCRF is able to serve more than one AF and one given AF may interact with
a number of PCRFs. On a per-AF-session basis, the AF interacts with only a
single PCRF.
For further details, see TS 23 203 [21].
## 5.4 QoS Parameters
See stage 3 specification TS 29.212 [22].
## 5.5 QoS Parameter Mapping
See stage 3 specification TS 29.213 [23].
# 6 End-to-End QoS Procedures
## 6.1 QoS Procedures in Functional Elements
This section describes the main procedures that are used for the end-to-end
QoS management. These procedures are described in text description for each
involved network elements. The procedures described in this document are meant
to provide a high level description for further Stage 3 work and are not
intended to be exhaustive.
### 6.1.1 Procedures in the GGSN
The QoS procedures in the GGSN are triggered by the QoS signalling messages
from the UE or unsolicited provisioning of PCC rules from the PCRF. The exact
QoS procedures in the GGSN depend on the GGSN and UE QoS capabilities. The
GGSN is required to support DiffServ edge function. Other QoS capabilities
that may be supported at the GGSN are RSVP functions and policy enforcement
functions.
For UEs that do not support RSVP, the GGSN may use the PDP context level
information to configure the DiffServ edge functionality and provide
internetworking between PDP context and backbone IP network. The authorization
token is included in the PDP context activation/modification messages.
For UEs that support RSVP, the GGSN may also support RSVP and use RSVP rather
than the PDP context to control the QoS through the backbone IP network. The
authorization token may be included in the RSVP signalling and the PDP context
activation/modification messages. Alternatively, the RSVP messages may pass
transparently through the GGSN.
For details on PCC functionality in GGSN, see TS 23.203 [21].
### 6.1.2 Procedures in the UE
The QoS procedures in the UE are triggered by the application layer (e.g.,
SIP/SDP) QoS requirements or initiated by the network. The exact QoS
procedures in the UE depend on the UE QoS capabilities.
For UEs that support only UMTS QoS mechanism, the network or the application
QoS requirements will trigger a PDP Context Activation procedure with the
corresponding UMTS QoS parameters. For UEs that support both IP (e.g., IP BS
Manager) and UMTS QoS mechanism, the application QoS requirements are mapped
down to the IP layer QoS parameters. The IP layer parameters are further
mapped down to the PDP context parameters in the UE. For UEs that support
RSVP, the application QoS requirements are mapped down to create an RSVP
session. The UE shall establish a PDP context suitable for support of the RSVP
session.
At the AF session release, the UE shall release all QoS resources allocated
for the AF session.
For details on PCC functionality in the UE, see TS 23.203 [21].
### 6.1.3 Void
### 6.1.3a Procedures in the PCRF
The QoS procedures at the PCRF are triggered by the IP-CAN session
establishment as reported from a PCEF and, for an active IP-CAN session, IP-
CAN session modification or service information from an AF.
When the PCRF receives service information from the AF, the PCRF authorizes
the QoS resources or rejects the service information received from the AF. If
the PCRF rejects the authorization request, the PCRF may indicate in the
response to the AF the service information that could be accepted by the PCRF.
As part of the authorization, the PCRF shall perform the mapping from the
service information conveyed over the Rx interface to the Authorized QoS sent
over the Gx interface.
The authorized QoS is either pushed to or requested by the GGSN via the Gx
interface.
The PCRF makes a final decision to enable the allocated QoS resource for the
authorized IP flows. This may be triggered by an instruction from the AF. QoS
resources may also be enabled at the time they are authorized by the PCRF.
When the AF receives updated session description information, the AF may send
an update for service information to the PCRF. The PCRF decides if a new QoS
authorization is needed and updates the authorization for the session
accordingly. If the PCRF does not accept the service information received from
the AF, the PCRF rejects the update for service information. The PCRF may
indicate in the response to the AF the service information that could be
accepted by the PCRF.
The PCRF revokes the resource authorization based on request from the AF.
For details on the PCC functionality in the PCRF, see TS 23.203 [21].
### 6.1.4 Procedures in the AF
The AF communicates with the PCRF to transfer dynamic session information,
required for PCRF decisions as well as to receive information and
notifications about IP transmission resource level events.
The AF contacts the PCRF when it receives an AF session signalling message
initiating a new AF session:
\- The AF contacts the PCRF that is responsible for the UE.
NOTE: There is one PCRF responsible for the IP-CAN session of the UE. This
implies that for all AF sessions to and from the same UE with the same UE IP
address, the AF(s) interacts with the same PCRF. This also implies that if
different AF sessions of a user are controlled by different AFs, then all
these AFs will interact with the same PCRF. Hence, the bearer authorization of
the PDP Context(s) carrying the media of these AF sessions will be performed
by the same PCRF.
\- The AF generates the information (e.g. service information) conveyed over
the Rx interface from the application specific media description (e.g. SDP
media description).
\- The PCRF uses the service information for the QoS policy set up for the AF
session. During an AF session change, the AF sends an update for service
information to the PCRF based on the new session description information
exchanged within AF session signalling.
The AF orders the PCRF to enable or disable a media to pass through the access
network. The AF may instruct the PCRF to either wait for an explicit command
or enable the media as part of the authorization of the QoS for the media. The
AF may use an explicit command to disable the media e.g. when a media
component of an AF session is put on hold.
At AF session release, the AF revokes any granted resource authorization.
For details on the PCC functionality in the AF, see TS 23.203 [21].
## 6.2 IP Bearer Level / Application Level Binding Mechanism
See TS 23.203 [21].
## 6.3 Session Flow: QoS Interaction Procedures
This section highlights possible additions to the GPRS bearer establishment
procedures specified in TS 23.060 [19] for support of Policy and Charging
Control (PCC). These additional procedures are utilized to provide Policy and
Charging Control for session-based services, e.g. for IMS as described in
Chapter 5: \'IP multimedia subsystem procedures\' of TS 23.228 [4].
For IMS where PCC is not used, the related procedures defined in TS 23.228 [4]
are not applied.
Detailed specification of the additional procedures are given in TS 23.203
[21].
It shall be possible according to operator choice to use solely the GPRS
bearer establishment procedures specified in TS 23.060 [19] without these
additions.
### 6.3.1 Void
### 6.3.2 Resource Reservation Message Flows
#### 6.3.2.1 Void
#### 6.3.2.2 Resource Reservation with IP QoS signalling
Editor\'s note: There is still ongoing work in IETF on new IP QoS signalling
techniques, hence it is not possible to include flows using those new
techniques into this version of the specification. Procedures describing
resource reservation with end-to-end RSVP are described in Annex X.
#### 6.3.2.3 Resource Reservation with IP QoS reservation signalling and
Service-based Local Policy
Editor\'s note: There is still ongoing work in IETF on new IP QoS signalling
techniques, hence it is not possible to include flows using those new
techniques into this version of the specification. Procedures describing
resource reservation with end-to-end RSVP and Service-based Local Policy are
described in Annex X.
#### 6.3.2.4 (void)
### 6.3.3 Void
### 6.3.4 Void
### 6.3.5 Void
### 6.3.6 Void
### 6.3.6a Void
### 6.3.7 Void
### 6.3.8 Void
## 6.4 PDP Context Used for Application Level Signalling Transport
To establish a PDP context for application level signalling, the UE shall be
able to include a signalling flag in PDP context activation procedure. This
indicates to the network the intention of using the PDP context for
application level signalling. The only defined application level signalling
flag in this release is the IM CN subsystem signalling flag. However, the
network may also support other mechanisms that cater for identifying
application level signalling flows within a PDP context, as described in TS
23.228 [4] section 4.2.6.
To establish a PDP context for application level signalling with prioritised
handling over the radio interface, the UE shall be able to set the Signalling
Indication in the QoS IE in the PDP context activation procedure. The
Signalling indication in the QoS IE indicates to the radio and core networks
the requirement for enhanced handling over the radio interface, once it has
been negotiated with the networks.
A request for a general purpose PDP context having the \"signalling
indication\" within the QoS IE may be accepted or downgraded according to
operator policy configured at the GGSN using the usual QoS negotiation
mechanisms described in TS 23.060 [19].
In the case of IMS, the IM CN Signalling Flag in the PCO IE is used to
reference rules and restrictions on the PDP context used for application level
signalling, as described in TS 23.228 [4] section 4.2.6.
The IM CN Signalling Flag and the Signalling indication in the QoS profile
detailed in TS 23.107 [3] may be used independently of each other.
Based on operator policy the \"Signalling Indication\" in the QoS IE may be
allowed only if the \"IM CN Subsystem Signalling\" flag is present in the PCO
IE.
###### ## Annex A (informative): QoS Conceptual Models
# A.1 Introduction
There are many different end-to-end scenarios that may occur from a UE
connected to a UTMS network. The following examples depict how end-to-end QoS
will be delivered for a number of scenarios that are considered to be
significant.
NOTE: Further consideration of scenarios 2 and 3 is not needed for Stage 3
work in the Release 5 timeframe. The normative aspects of scenarios 2 and 3
are considered to be already covered by scenario 1.
In all the scenarios presented below, the network architecture is as shown in
Figure A.1 below.
Figure A.1: Network Architecture for QoS Conceptual Models
NOTES:
\- Although the backbone IP network is shown as a single domain, it may
consist of a number of separate domains.
\- The structure of the Local UE is not specified. It includes cases from a
simple host, to a gateway to a network such as a LAN. If the UE is acting as a
gateway, it is responsible for providing the IP BS Management towards the
extended network.
\- The remote side is shown as a simple host. Other more complex cases on the
remote side such as a private LAN with over-provisioning, or possibly LAN
priority marking, and DiffServ and/or RSVP capable routing elements is not
depicted. It is envisaged however that interworking between the QoS mechanisms
in a more complex remote user side could also be performed with some
similarities to the mechanisms shown at the local side.
The reference point shown at the UE is at the interface to the UE. Within the
UE, the QoS control could be derived from any of the mechanisms that occur
across that reference point, or it could use a different mechanism internally.
Although the scenarios currently identified are mainly using DiffServ in the
backbone IP network (RSVP is indicated as an alternative in scenario 4), it is
not mandated that DiffServ must be used in the backbone IP network. Other
mechanisms, for example, over-provisioning and aggregated RSVP may be used.
# A.2 Scenarios
These scenarios give examples of concatenating QoS mechanisms in different
parts of the network which together can deliver an end-to-end QoS. These
scenarios are not intended to describe the details of the interworking between
the QoS mechanisms.
The different scenarios involve cases with and without service based local
policy. Each scenario describes the applicable cases, possibly by referencing
another scenario. In some scenarios, only one of the cases may be valid (e.g.
scenario 5). Where both cases are covered, they may be described together
identifying the optionality, or separately for clarity of the individual
cases.
The optional authorisation token is associated with the cases involving
service based local policy, and is applicable for IM services. It is an
operator decision whether or not to support service based local policy for IM
services. If service based local policy is not supported, or not applicable
(i.e. not IM service), then the optional authorisation token and application
server at the P-CSCF are not used.
IM services not using service based local policy will typically follow
scenarios 1 to 4. IM services using service based local policy will typically
follow scenarios 3 to 5.
NOTE: Scenario 5 is reserved for the IP multimedia services involving, e.g.,
SIP signalling , IP policy control, and subscription checking.
## A.2.1 Scenario 1
The UE does not provide an IP BS Manager. The end-to-end IP QoS bearer service
towards the remote terminal is controlled from the GGSN.
The scenario assumes that the GGSN supports DiffServ edge functions, and the
backbone IP network is DiffServ enabled.
NOTE: The UE may always include an authorisation token in establishment of the
PDP context. Inclusion of the authorisation token in scenario 1 changes the
QoS mechanisms to be the same as those described in scenario 5\. Therefore,
please refer to scenario 5 if the authorisation token is included.
The application layer (e.g. SIP/SDP) between the end hosts identifies the QoS
requirements. The QoS requirements determined from the application layer (e.g.
TS 23.228 [4] describes interworking from SIP/SDP to QoS requirements) are
mapped down to PDP context parameters in the UE.
In this scenario, the control of the QoS over the UMTS access network (from
the UE to the GGSN) may be performed either from the terminal using the PDP
context signalling, or from the SGSN by subscription data.
The IP QoS for the downlink direction is controlled by the remote terminal up
to the GGSN. The GGSN will apply receiver control DiffServ edge functions and
can reclassify the data (remarking the DiffServ Code Point (DSCP)). This may
affect the QoS applied to the data over the UMTS access (the TFT may use the
DSCP to identify the data to be allocated to the PDP context).
The end-to-end QoS is provided by a local mechanism in the UE, the PDP context
over the UMTS access network, DiffServ through the backbone IP network, and
DiffServ in the remote access network in the scenario shown in the figure
below. The GGSN provides the interworking between the PDP context and the
DiffServ function. However, the interworking may use information about the PDP
context which is established, or be controlled from static profiles, or
dynamically through other means such as proprietary HTTP based mechanisms. The
UE is expected to be responsible for the control of the PDP context, but this
may instead be controlled from the SGSN by subscription.
{width="6.688888888888889in" height="3.841666666666667in"}
Figure A.2: Local UE does not provide IP BS Manager
Notes:
\- The solid horizontal lines indicate the mechanism that is providing QoS for
the flow of data in the direction indicated.
\- The dashed horizontal lines indicate where QoS control information is
passed that is not directly controlling the QoS in that link/domain.
\- The arrows on the horizontal lines indicate nodes that receive information
about QoS from that mechanism, even if that mechanism is not used to control
the QoS over that link/domain.
\- The solid vertical lines indicate interworking between the different
mechanisms.
\- In the figure, the term RAP refers to the Remote Access Point, and RUE is
the Remote UE.
No solid vertical line is shown from DiffServ to PDP flow on the downlink at
the GGSN. The TFT determines the QoS applicable over the UMTS access. However,
the configuration of the TFT may use the DiffServ to select the PDP context to
be applied, so there may be interworking between DiffServ and the PDP Flow via
the TFT filters.
### A.2.2 Scenario 2
The UE performs an IP BS function which enables end-to-end QoS without IP
layer signalling towards the IP BS function in the GGSN, or the remote
terminal.
The scenario assumes that the UE and GGSN support DiffServ edge functions, and
that the backbone IP network is DiffServ enabled.
NOTE: The UE may always include an authorisation token in establishment of the
PDP context. Inclusion of the authorisation token in scenario 2 changes the
QoS mechanisms to be the same as those described in scenario 5\. Therefore,
please refer to scenario 5 if the authorisation token is included.
The application layer (e.g. SIP/SDP) between the end hosts identifies the QoS
needs. The QoS requirements from application layer (e.g. TS 23.228 [4]
describes interworking from SIP/SDP to QoS requirements) are mapped down to
the IP layer. The IP layer service requirements are further mapped down to the
PDP context parameters in the UE.
In this scenario, the control of the QoS over the UMTS access network (from
the UE to the GGSN) may be performed either from the terminal using the PDP
context signalling. Alternatively, subscription data accessed by the SGSN may
override the QoS requested via signalling from the UE (according to the
procedures specified in TS 23.060 [19]).
In this scenario, the terminal supports DiffServ to control the IP QoS through
the backbone IP network.
The IP QoS for the downlink direction is controlled by the remote terminal up
to the GGSN. The PDP context controls the QoS between the GGSN and the UE. The
UE may apply DiffServ edge functions to provide the DiffServ receiver control.
Otherwise, the DiffServ marking from the GGSN will determine the IP QoS
applicable at the UE.
The end-to-end QoS is provided by a local mechanism in the UE, the PDP context
over the UMTS access network, DiffServ through the backbone IP network, and
DiffServ in the remote access network in the scenario shown in the figure
below. The UE provides control of the DiffServ, and therefore determines the
appropriate interworking between the PDP context and DiffServ.
The GGSN DiffServ edge function may overwrite the DSCP received from the UE,
possibly using information regarding the PDP context which is signalled
between the UMTS BS managers and provided through the translation/mapping
function to the IP BS Manager.
Note that DiffServ control at the Remote Host is shown in this example.
However, other mechanisms may be used at the remote end, as demonstrated in
the other scenarios.
Figure A.3: Local UE supports DiffServ
### A.2.3 Scenario 3
The UE performs an IP BS function which enables end-to-end QoS using IP layer
signalling towards the remote end. There is no IP layer signalling between the
IP BS Managers in the UE and the GGSN. However, the GGSN may make use of
information regarding the PDP context which is signalled between the UMTS BS
managers and provided through the translation/mapping function.
This scenario assumes that the UE and GGSN support DiffServ edge functions,
and that the backbone IP network is DiffServ enabled. In addition, the UE
supports RSVP signalling which interworks within the UE to control the
DiffServ.
The application layer (e.g. SIP/SDP) between the end hosts identifies the QoS
requirements. The QoS requirements from application layer (e.g. TS 23.228 [4]
describes interworking from SIP/SDP to QoS requirements) are mapped down to
create an RSVP session. The UE shall establish the PDP context suitable for
support of the RSVP session. The authorisation token from the application
layer when included shall be mapped to the PDP context parameters, and may
also be mapped to the RSVP signalling.
In this scenario, the control of the QoS over the UMTS access network (from
the UE to the GGSN) may be performed either from the terminal using the PDP
context signalling. Alternatively, subscription data accessed by the SGSN may
override the QoS requested via signalling from the UE (according to the
procedures specified in TS 23.060 [19]).
In this scenario, the terminal supports signalling via the RSVP protocol to
control the QoS at the local and remote accesses, and DiffServ to control the
IP QoS through the backbone IP network. The RSVP signalling protocol may be
used for different services. It is expected that only RSVP using the
Integrated Services (IntServ) semantics would be supported, although in the
future, new service definitions and semantics may be introduced. The entities
that are supporting the RSVP signalling should act according to the IETF
specifications for IntServ and IntServ/DiffServ interwork.
The QoS for the wireless access is provided by the PDP context. The UE may
control the wireless QoS through signalling for the PDP context. The
characteristics for the PDP context may be derived from the RSVP signalling
information, or may use other information.
QoS for the IP layer is performed at two levels. The end-to-end QoS is
controlled by the RSVP signalling. Although RSVP signalling can be used end-
to-end in the QoS model, it is not necessarily supported by all intermediate
nodes. Instead, DiffServ is used to provide the QoS throughout the backbone IP
network.
At the UE, the data is also classified for DiffServ. Intermediate QoS domains
may apply QoS according to either the RSVP signalling information or DiffServ
mechanisms. In this scenario, the UE is providing interworking between the
RSVP and DiffServ domains. The GGSN may override the DiffServ setting from the
UE. This GGSN may use information regarding the PDP context in order to select
the appropriate DiffServ setting to apply, as shown in the figure below.
The end-to-end QoS is provided by a local mechanism in the UE, the PDP context
over the UMTS access network, DiffServ through the backbone IP network, and
DiffServ in the remote access network in the scenario shown in the figure
below. The RSVP signalling may control the QoS at both the local and remote
accesses. This function may be used to determine the characteristics for the
PDP context, so the UE may perform the interwork between the RSVP signalling
and PDP context.
The UE provides control of the DiffServ (although this may be overwritten by
the GGSN), and in effect, determines the appropriate interworking between the
PDP context and DiffServ.
Figure A.4: Local UE supports RSVP signalling with IntServ semantics, and
DiffServ;\ without service based policy
The GGSN provides the interworking between the PDP context and the DiffServ
function. The application layer signalling may be processed in the local
network at an application server such as the P-CSCF in the case of SIP
signalling. Interworking between the GGSN and the application layer is shown
as a vertical line where applicable. This interworking is for policy control
and is between the GGSN and the PDF policy function co-located in the P-CSCF,
as shown in the figure below.
Figure A.5: Local UE supports RSVP signalling with IntServ semantics, and
DiffServ;\ where service based policy is applied
### A.2.4 Scenario 4
The UE performs an IP BS function which enables end-to-end QoS using IP layer
signalling towards the remote end. However, the UE relies on this end-to-end
communication being utilised by at least the access point (GGSN) in order to
provide the end-to-end QoS.
This scenario assumes that the UE and GGSN support RSVP signalling which may
control the QoS directly, or interwork with DiffServ. The backbone IP network
is RSVP and/or DiffServ enabled.
The application layer (e.g. SIP/SDP) between the end hosts identifies the QoS
requirements. The QoS requirements from application layer (e.g. TS 23.228 [4]
describes interworking from SIP/SDP to QoS requirements) are mapped down to
create an RSVP session. The UE shall establish the PDP context suitable for
support of the RSVP session. The authorisation token from the application
layer shall be mapped to the PDP context parameters, and may also be mapped to
the RSVP signalling.
In this scenario, the terminal supports signalling via the RSVP protocol to
control the QoS across the end-to-end path. The GGSN also supports the RSVP
signalling, and uses this information rather than the PDP context to control
the QoS through the backbone IP network. The control of the QoS through the
core is expected to be supported through interworking with DiffServ at the
GGSN, although it may optionally be supported by per flow resource
reservation. The RSVP signalling protocol may be used for different services.
It is only expected that only RSVP using the Integrated Services (IntServ)
semantics would be supported, although in the future, new service definitions
and semantics may be introduced. The entities that are supporting the RSVP
signalling may fully support the specifications for IntServ and
IntServ/DiffServ interwork. If not, they are expected to set the break bit.
In this scenario, the control of the QoS over the UMTS access network (from
the UE to the GGSN) may be performed either from the terminal using the PDP
context signalling. Alternatively, subscription data accessed by the SGSN may
override the QoS requested via signalling from the UE (according to the
procedures specified in TS 23.060 [19]).
QoS for the IP layer is performed at two levels. The end-to-end QoS is
controlled by the RSVP signalling. Although RSVP signalling occurs end-to-end
in the QoS model, it is not necessarily supported by all intermediate nodes.
DiffServ is used to provide the QoS throughout the backbone IP network,
although optionally each node may support RSVP signalling and allocation of
resources per flow. An authorisation token may be included in the RSVP
signalling and the PDP context establishment/modification. The GGSN may
authorise the RSVP session and configure the Diffserv classifier
functionality.
The GGSN supports the RSVP signalling and acts as the interworking point
between RSVP and DiffServ. Intermediate QoS domains may apply QoS according to
either the RSVP or DiffServ mechanisms.
The end-to-end QoS is provided by a local mechanism in the UE, the PDP context
over the UMTS access network, DiffServ through the backbone IP network, and
RSVP in the remote access network in the scenario shown in the figure below.
The RSVP signalling may control the QoS at the local access. This function may
be used to determine the characteristics for the PDP context, so the UE may
perform the interwork between RSVP and the PDP context.
Figure A.6: Local UE supports RSVP signalling using IntServ Semantics
### A.2.5 Scenario 5
The UE performs an IP BS function which enables end-to-end QoS without IP
layer signalling and negotiation towards the IP BS function in the GGSN, or
the remote host. The P-CSCF provides the authorization token to the UE during
the SIP session setup process, and the UE provides the authorization token to
the GGSN in the PDP context activation/modification message. The GGSN uses the
authorization token to obtain a policy decision from the P-CSCF(PDF). This is
done via the standardized interface between the PDF and GGSN. Even if the
interface is an open interface where all information elements are
standardized, the actual usage of the information is operator specific.
The scenario assumes that the GGSN support DiffServ edge functions, and that
the backbone IP network is DiffServ enabled.
The application layer (e.g. SIP/SDP) between the end hosts identifies the QoS
needs. The QoS requirements from application layer (e.g. TS 23.228 [4]
describes interworking from SIP/SDP to QoS requirements) are mapped down to
the IP layer and further down to the PDP context parameters in the UE. The
authorisation token from the application layer is included in the PDP context
parameters by the UE.
In this scenario, the control of the QoS over the UMTS access network (from
the UE to the GGSN) may be performed from the terminal using the PDP context
signalling. Alternatively, subscription data accessed by the SGSN may override
the QoS requested via signalling from the UE (according to the procedures
specified in TS 23.060 [19]).
The QoS for the downlink direction is controlled by the remote host from the
remote network to the GGSN. The PDP context controls the UMTS level QoS
between the GGSN and the UE. The QoS in the uplink direction is controlled by
the PDP context up to the GGSN. The GGSN configures the DiffServ Edge function
to interwork with the backbone IP network and control the IP QoS bearer
service towards the remote -host.
The end-to-end QoS is provided by a local mechanism in the UE, the PDP context
over the UMTS access network, DiffServ through the backbone IP network, and
DiffServ in the remote access network. Note that DiffServ control at the
Remote Host is shown in this example. However, other mechanisms may be used at
the remote end, as demonstrated in the other scenarios.
Figure A.7: Local UE provides authorization token in PDP context
activation/modification message and GGSN provides interworking with DiffServ
###### ## Annex B (informative): (void)
###### ## Annex C (informative): Sample Mapping of SDP Descriptions Into QoS
Authorization
The QoS requirement for a session depends on the media and codec information
for the session. Initial session establishment in the IM Subsystem must
determine a common codec (or set of common codecs for multimedia sessions)
that will be used for the session. This is done through an end-to-end message
exchange to determine the complete set of common codecs, and then the session
initiator makes the decision as to the initial set of codecs for the media
flows.
The session initiator includes an SDP in the SIP INVITE message that lists
every codec that the originator is willing to support for this session. When
the message arrives at the destination endpoint, it responds with the subset
that it is also willing to support for the session by selectively accept or
decline those media types in the original list. When multiple media codecs are
listed, the caller and called party\'s media fields must be aligned---that is,
there must be the same number, and they must be listed in the same order. QoS
authorization is performed for this common subset. The P-CSCF(PDF) shall use
the SDP contained in the SIP signalling to calculate the proper authorization.
The authorization shall include limits on IP resources, and restrictions on IP
packet flows, and may include restrictions on IP destinations. These
restrictions are expressed as a data rate and QoS class for the combined set
of IP flows, and a set of filter specs.
The QoS authorization for a session shall include an Authorization-Token,
which shall be assigned by the P-CSCF(PDF). The Authorization-Token shall
contain information that identifies the P-CSCF(PDF) that generated the token.
Each authorized session may include several flow authorizations. Each flow
authorization may include an authorization for one or more flows. The
authorization shall contain the following information:
\- Filter Specs (IP flow 5-tuples that identify the set of flows)
\- Data rate and QoS class that describes the authorized resource for the set
of flows
\- The IP flow 5-tuples includes Source Address, Source Port, Destination
Address, Destination Port and Protocol ID. Note that some fields may be
wildcarded.
A typical SDP description consists of a session-level description (details
that apply to the whole session and all media flows) and the several media-
level descriptions (details that apply to a single media flow). The four
critical components for mapping an SDP description into a QoS authorization
are the media announcements (\"m=\"), the connection data (\"c=\"), the
attributes (\"a=\") and the bandwidth (\"b=\").
The media announcements field contains information about the type of media
session, and is of the form:
m=\ \ \ \
The attributes field contains attributes of the preceding media session, and
is of the form:
a=\\
The connection data field contains information about the media connection, and
is of the form:
c=\ \ \
The optional bandwidth field contains information about the bandwidth
required, and is of the form:
b=\:\
An example SDP description from the session originator in the SIP INVITE
message:
v=0
o=hshieh 2890844526 2890842807 IN IP4 saturn.attws.com
s=-
c=IN IP4 192.141.10.188
t=0 0
b=AS:64
m=audio 29170 RTP/AVP 3 96 97
a=rtpmap:96 G726-32/8000
a=rtpmap:97 AMR
a=fmtp:97 mode-set=0,2,5,7; maxframes=2
m=video 51372 RTP/AVP 34
a=fmtp 34 SQCIF=2/MaxBitRate=500/SAC AP
m=application 32416 udp text_chat
The called party answers the call and returns the following SDP description in
the SIP 183 message:
v=0
o=johndoe 2890844526 2890842807 IN IP4 uranus.solar.com
s=-
c=IN IP4 204.142.180.111
t=0 0
b=AS:64
m=audio 31160 RTP/AVP 3 97
a=rtpmap:97 AMR
a=fmtp:97 mode-set=0,2,5,7; maxframes=2
a=recvonly
m=video 61000 RTP/AVP 31
a=fmtp 34 SQCIF=2/MaxBitRate=500/SAC AP
m=application 33020 udp text_chat
a=sendonly
Upon receiving the above SDP, the originator\'s P-CSCF will authorize QoS
resource for the originator UE with the following media flows:
**A uplink audio flow:**
The following IP 5-tuples identify the flow:
* * *
SrcAddress SrcPort DestAddress DestPort ProtocolID 192.141.10.188 *
204.142.180.111 31160 17
* * *
Since the conversational audio is very sensitive to delay, the maximum QoS
class corresponding to conversational traffic class would be set. The b
parameter is used to determine the maximum authorised data rate.
**An uplink video flow:**
The following IP 5-tuples identify the flow:
* * *
SrcAddress SrcPort DestAddress DestPort ProtocolID 192.141.10.188 *
204.142.180.111 61000 17
* * *
The video flow may be assigned a maximum QoS class corresponding to streaming
traffic class. The b parameter is used to determine the data rate.
**A downlink video flow:**
The following IP 5-tuples identify the flow:
* * *
SrcAddress SrcPort DestAddress DestPort ProtocolID 204.142.180.111 *
192.141.10.188 51372 17
* * *
The video flow may be assigned a maximum QoS class corresponding to streaming
traffic class. The b parameter is used to determine the maximum authorised
data rate.
**A downlink udp flow:**
The following IP 5-tuples identify the flow:
* * *
SrcAddress SrcPort DestAddress DestPort ProtocolID 204.142.180.111 *
192.141.10.188 32416 17
* * *
The udp application flow may be assigned a maximum QoS class corresponding to
interactive. The b parameter is used to determine the data rate.
NOTE: The sample mappings in this section are for illustration purpose only.
The actual mapping of media codec to QoS resource requirement is specified in
TS 29.208 [4b].
###### ## Annex D (informative): Resource reservation and end-to-end RSVP
## D.1 Resource reservation with end-to-end RSVP
For this case, RSVP is added to the GPRS bearer establishment procedures
specified in TS 23.060 [19], with no Service-based local policy.
NOTE: The diagrams in this subsection depict one possible signalling sequence,
however, the alternative signalling sequences below are possible:
\- to trigger the Create PDP Context Request message after the PATH message.
\- to trigger the Create PDP Context Request message after the RESV message.
\- to trigger only one PDP context after all RSVP exchanges have completed.
NOTE: The diagrams in this subsection depict the case when the GGSN is not
RSVP aware, however, the alternative of GGSN being RSVP aware is also
possible.
The following figure is applicable to the Mobile Originating (MO) side.
Figure D.1: MO Resource Reservation with End-to-End RSVP
NOTE: There is no timing relationship between the set of flows for the uplink
(above the line) and the downlink (below the line).
1) The UE sends an Activate (Secondary) PDP Context message to the SGSN with
the UMTS QoS parameters.
2) The SGSN sends the corresponding Create PDP Context message to the GGSN.
3) The GGSN authorizes the PDP context activation request according to the
local operator\'s IP bearer resource based policy, the local operator\'s
admission control function and the GPRS roaming agreements and sends a Create
PDP Context Response message back to the SGSN.
4) RAB setup is done by the RAB Assignment procedure.
5) The SGSN sends an Activate (Secondary) PDP Context Accept message to UE.
6) UE sends an RSVP PATH message to the next hop, through the GGSN. The GGSN
does not process the RSVP PATH message. Alternatively, the GGSN may process
the RSVP PATH message and forward it to the next hop.
7) The UE receives the RSVP RESV message in the downlink direction, through
the GGSN. The GGSN does not process the RSVP RESV message. Alternatively, the
GGSN may process the RSVP RESV message and forward it to the UE.
8) The UE sends a RSVP RESV-CONF message to the next hop. The use of the RESV-
CONF message is optional.
9) The UE receives a RSVP PATH message in the downlink direction, through the
GGSN. The GGSN does not process the RSVP PATH message. Alternatively, the GGSN
may process the incoming RSVP PATH message and forward it to the UE.
10) The UE may send a Modify PDP Context message to the SGSN with the
necessary modification to UMTS QoS parameters according to the received RSVP
PATH message.
11) The SGSN sends the corresponding Update PDP Context Request message to the
GGSN.
12) The GGSN authorizes the PDP context modification according to the local
operator\'s IP bearer resource based policy, the local operator\'s admission
control function and the GPRS roaming agreements and sends an Update PDP
Context Response message back to the SGSN.
13) The radio access bearer modification may be performed by the RAB
Assignment procedure.
14) The SGSN sends a Modify PDP Context Accept message to UE.
15) UE sends the RSVP RESV message to the next hop, through the GGSN. The GGSN
does not process the RSVP RESV message. Alternatively, the GGSN may process
the RSVP RESV message and forward it to the next hop.
16) The UE receives the RSVP RESV-CONF message in the downlink direction. The
use of the RESV-CONF message is optional.
The following figure is applicable to the Mobile Terminating (MT) side. As the
flow is the mirror of the Mobile Originating (MO) side, the step-by-step
description is omitted.
Figure D.2: MT Resource Reservation with End-to-End RSVP
NOTE: There is no timing relationship between the set of flows for the uplink
(above the line) and the downlink (below the line).
## D.2 Resource Reservation with End-to-End RSVP and Service-based Local
Policy
For this case, Service-based Local Policy and RSVP are added to the GPRS
bearer establishment procedures specified in TS 23.060 [19].
NOTE: The diagrams in this subsection depict one possible signalling sequence,
however, the alternative signalling sequences below are possible:
\- to trigger the Create PDP Context Request message after the PATH message.
\- to trigger the Create PDP Context Request message after the RESV message.
\- to trigger only one PDP context after all RSVP exchanges have completed.
NOTE: The diagrams in this subsection depict the case when the GGSN is RSVP
aware, however, the alternative of GGSN not being RSVP aware is also possible.
This section provides the flows for bearer establishment, resource reservation
and policy control with RSVP.
The following figure is applicable to the Mobile Originating (MO) side.
Figure D.3: MO Resource Reservation with End-to-End RSVP and Service-based
Local Policy
NOTE: There is no timing relationship between the set of flows for the uplink
(above the line) and the downlink (below the line).
1) The UE sends an Activate (Secondary) PDP Context message to the SGSN with
the UMTS QoS parameters. The UE includes the Binding Information in the
Activate PDP Context message.
2) The SGSN sends the corresponding Create PDP Context message to the GGSN.
3) The GGSN sends a COPS REQ message with the Binding Information to the PDF
in order to obtain relevant policy information.
4) The PDF sends a COPS DEC message back to the GGSN.
5) The GGSN sends a COPS RPT message back to the PDF.
6) The GGSN maps IP flow based policy information into PDP context based
policy information and uses the PDP context based policy information to accept
the PDP activation request, and sends a Create PDP Context Response message
back to SGSN. The GGSN may cache the policy information.
7) RAB setup is done by the RAB Assignment procedure.
8) The SGSN sends an Activate (Secondary) PDP Context Accept message to UE.
9) UE sends a RSVP PATH message to GGSN. The UE includes the Binding
Information.
NOTE: If the decision was previously cached locally at the GGSN, it may not be
necessary to query the PDF again. Otherwise the GGSN may have to query the
PDF.
10) The GGSN uses the policy information to accept the RSVP PATH message, and
forwards the RSVP PATH message to the next hop.
11) The GGSN receives the RSVP RESV message in the downlink direction.
NOTE: If the decision was previously cached locally at the GGSN, it may not be
necessary to query the PDF again. Otherwise the GGSN may have to query the
PDF.
12) The GGSN uses the policy information to accept the RSVP RESV message, and
forwards the RSVP RESV message to the UE.
13) The UE sends a RSVP RESV-CONF message to the next hop. The use of the
RESV-CONF message is optional.
14) The GGSN receives a RSVP PATH message in the downlink direction.
15) The GGSN forwards the RSVP PATH message to the UE.
16) The UE may send a Modify PDP Context message to the SGSN with the
necessary modification to UMTS QoS parameters according to the received RSVP
PATH message. The UE includes the Binding Information in the Modify PDP
Context message.
17) The SGSN sends the corresponding Update PDP Context message to the GGSN.
NOTE: If the decision was previously cached locally at the GGSN, it may not be
necessary to query the PDF again. Otherwise the GGSN may have to query the
PDF.
18) The GGSN uses the policy information to accept the PDP modification
request, and sends a Update PDP Context Response message back to SGSN.
19) The radio access bearer modification may be performed by the RAB
Assignment procedure.
20) The SGSN sends a Modify PDP Context Accept message to UE.
NOTE: Steps 16 to 20 are optional if the existing PDP context already
satisfies the QoS requirements.
21) The UE sends a RSVP RESV message to the GGSN. The UE includes the Binding
Information in the RSVP RESV message.
NOTE: If the decision was previously cached locally at the GGSN, it may not be
necessary to query the PDF again. Otherwise the GGSN may have to query the
PDF.
22) The GGSN uses the policy information to accept the RSVP RESV message, and
forwards the RSVP RESV message to the next hop.
23) The UE receives the RSVP RESV-CONF message in the downlink direction. The
use of the RESV-CONF message is optional.
The following figure is applicable to the Mobile Terminating (MT) side. As the
flow is the mirror of the Mobile Originating (MO) side, the step-by-step
description is omitted.
Figure D.4: MT Resource Reservation with End-to-End RSVP and Service-based
Local Policy
NOTE: There is no timing relationship between the set of flows for the uplink
(above the line) and the downlink (below the line).
#