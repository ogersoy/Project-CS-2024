# Foreword
This Technical Specification has been produced by the 3GPP.
This specification describes the technical realization of the Call Deflection
supplementary service within the 3GPP system.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of this TS, it will be re-released by the TSG with an identifying
change of release date and an increase in version number as follows:
Version 3.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 Indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the specification;
# 1 Scope
This Technical Specification gives the stage 2 description of the Call
Deflection supplementary service.
# 2 Normative references
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
```{=html}
``` \- For a non-specific reference, the latest version applies. In the > case
of a reference to a 3GPP document (including a GSM document), > a non-specific
reference implicitly refers to the latest version > of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"3GPP Vocabulary\".
[2] 3GPP TS 23.011: \"Technical realization of supplementary services\".
[3] 3GPP TS 23.018: \"Basic call handling; Technical realization\".
[4] 3GPP TS 23.078: \"Customised Applications for Mobile network Enhanced
Logic (CAMEL) Phase 2; Stage 2\"
[5] 3GPP TS 23.079: \"Support of Optimal Routeing (SOR); Technical
realisation\"
[6] 3GPP TS 23.081: \"Line identification supplementary services - Stage 2\".
[7] 3GPP TS 23.085: \"Closed User Group (CUG) supplementary services - Stage
2\".
[8] 3GPP TS 23.091: \"Explicit Call Transfer (ECT) supplementary service -
Stage 2\".
[9] 3GPP TS 23.093: \"Technical Realisation of Completion of Calls to Busy
Subscriber (CCBS)\".
# 3 Definitions and abbreviations
## 3.1 Abbreviations
Abbreviations used in this specification are listed in TR 21.905.
For the purpose of this specification the following abbreviations apply:
CD: Call Deflection
# 4 Information flow
{width="4.990277777777778in" height="5.646527777777778in"}
Figure 4.1: Information flow for Call Deflection
# 5 Messages and their Contents
## 5.1 Messages between the MS and the MSC
### 5.1.1 CD Request
The CD Request message is sent from the MS to MSC direction.
* * *
Information element name Required Description Deflected-to number M Number of
the C subscriber as entered by the served subscriber. Deflected-to subaddress
C Subaddress of the C subscriber; shall be present if it was entered by the
served subscriber; otherwise shall be absent
* * *
### 5.1.2 CD Request ack
The CD Request ack message is sent from the MSC to MS direction. This message
contains no information elements.
### 5.1.3 CD Request negative response
CD Request negative response message is sent from the MSC to MS direction. The
negative response information element can take the following values:
\- service not subscribed;
\- deflected-to number is own number;
\- deflected-to number is a special service code;
\- number invalid;
\- call barred;
\- SS incompatibility;
\- forwarding violation;
\- forwarding failure.
## 5.2 Messages between the MSC and the VLR
### 5.2.1 Process Call Waiting negative response
For the description of the Process Call Waiting negative response message
refer to TS 23.018. The negative response information element can take the
following additional value:
\- Call Deflection.
For the purpose of the CD supplementary service the following additional
information elements for the Process Call Waiting negative response message
are required.
* * *
Information element name Required Description Deflected-to number M Number of
the C subscriber as entered by the served subscriber. Deflected-to subaddress
C Subaddress of the C subscriber; shall be present if it was entered by the
served subscriber; otherwise shall be absent
* * *
### 5.2.2 Complete Call negative response
For the description of the Complete Call negative response message refer to TS
23.018. The negative response information element can take the following
additional value:
\- Call Deflection.
For the purpose of the CD supplementary service the following additional
information elements for the Complete Call negative response message are
required.
* * *
Information element name Required Description Deflected-to number M Number of
the C subscriber as entered by the served subscriber. Deflected-to subaddress
C Subaddress of the C subscriber; shall be present if it was entered by the
served subscriber; otherwise shall be absent
* * *
### 5.2.3 Send Info for Incoming Call negative response
For the description of the Send Info for Incoming Call negative response
message refer to TS 23.018. The negative response information element can take
the following additional values:
\- service not subscribed;
\- deflected-to number is own number;
\- deflected-to number is a special service code;
\- number invalid;
\- call barred.
# 6 Functions of the serving MSC
The functions of the serving MSC are specified in TS 23.018. The procedures
specific to the CD supplementary service are specified in this subclause.
## 6.1 Procedure Handling_CD_MSC
This procedure is called when a CD request is received from the MS.
## 6.2 Procedure CD_Reject
This procedure is called if the CD request was treated unsuccessful in the
VLR.
## 6.3 Procedure CD_Failure
This procedure is called if the CD request was treated unsuccessful in the
serving MSC.
## 6.4 Procedure CD_UUS_Interaction
This procedure is called if the CD request was treated unsuccessful in the
serving MSC due to the interaction with the UUS supplementary service.
## 6.5 Procedure CD_Success
This procedure is called if the CD request was treated successful in the
serving MSC.
## 6.6 Procedure CD_Notify_SS_Invocation
This procedure is called by the procedures CD_OR_Clear and CD_Success to send
notification of the CD invocation to the gsmSCF if required.
The output signal SS Invocation Notify is sent if the SS-CSI was received in
the SIFIC ack. The SS-CSI will only be included in the SIFIC ack if there is a
requirement to notify the gsmSCF that CD has been invoked.
{width="7.143055555555556in" height="8.639583333333333in"}
Figure 6.1: Procedure Handling_CD_MSC
{width="6.767361111111111in" height="8.184722222222222in"}
Figure 6.2: Procedure CD_Reject
{width="6.767361111111111in" height="8.186805555555555in"}
Figure 6.3: Procedure CD_Failure
{width="6.779861111111111in" height="8.219444444444445in"}
Figure 6.4: Procedure CD_UUS_Interaction
Figure 6.5: Procedure CD_Success
{width="6.691666666666666in" height="8.09375in"}
Figure 6.6 Procedure CD_Notify_SS_Invocation
# 7 Functions of the serving VLR
The functions of the serving VLR are specified in TS 23.018. The procedure
specific to the CD supplementary service is specified in this subclause.
## 7.1 Procedure CD_Authorization
This procedure examines the authorization related to Call Deflection.
The procedure CAMEL_Check_CD_Interaction is specific to CAMEL phase 2\. If
CAMEL phase 2 is not supported in the VLR, processing continues from the
\"No\" exit of the test \"Result=Pass?\".
The procedure CAMEL_CHECK_SII2_CDTI is specific to CAMEL Phase 3 or higher. If
CAMEL Phase 3 or higher is not supported in the VLR, processing continues from
the \"Yes\" exit of the test \"Result = Pass?\".
## 7.2 Procedure CAMEL_Check_CD_Interaction
This procedure examines whether a Translation Interaction Flag (TIF-CSI) is
provided for the served subscriber.
{width="6.691666666666666in" height="8.09375in"}
Figure 7.1 (sheet 1): Procedure CD_Authorization
{width="6.779861111111111in" height="8.219444444444445in"}
Figure 7.2: Procedure CAMEL_Check_CD_Interaction
# 8 Interaction with other supplementary services
## 8.1 Line Identification services
If the serving MSC receives an Answer message from the destination C network
after the successful invocation of the call deflection supplementary service,
the process MAF039 of TS 23.081 shall be performed. Refer to Process ICH_MSC
of TS 23.018 for further details.
## 8.2 Call Forwarding services
No impact.
## 8.3 Call Waiting
The MS may send a CD Request message for an incoming waiting call. Refer to
procedure Process_Call_Waiting_MSC of TS 23.018 for further details.
## 8.4 Call Hold
No impact.
## 8.5 Multi Party (MPTY)
No impact.
## 8.6 Closed User Group
The serving VLR shall perform the forwarding CUG authorisation as defined in
TS 23.085 while processing a call deflection request. Refer to Process ICH_VLR
of TS 23.018 for details.
## 8.7 Advice of Charge (AoC)
No impact.
## 8.8 Call Barring Services
If a call deflection request is processed, the serving VLR shall check whether
the requested deflected-to number contradicts active and operative outgoing
barring programs. Refer to Procedure CD_Authorization (figure 6.6) for
details.
## 8.9 Explicit call transfer (ECT)
If in the originating network ECT is invoked (one call answered, the other
alerting), the serving MSC shall map a redirection number parameter received
in the ECT notification into the calling identity parameter of the outgoing
IAM message. Refer to TS 23.091 (Interaction of Call Forwarding on mobile
subscriber busy due to UDUB and explicit call transfer) for details.
## 8.10 Completion of Calls to Busy Subscriber (CCBS)
If a call is deflected to a NDUB destination, the serving MSC shall set the
diagnostic to \"CCBS not possible\" when it releases the call towards the
calling network. Refer to Process ICH_MSC of TS 23.018 for further details.
The serving MSC shall remove the CCBS call Indicator from the IAM message when
deflecting a call.
# 9 Interaction with other network features
## 9.1 Customised Applications for Mobile network Enhanced Logic (CAMEL)
If the served subscriber is provided with a Translation Information Flag (TIF-
CSI) as defined in TS 23.018 the VLR shall neither perform checks regarding
the validity of the deflected-to number nor perform interactions with BOIC and
BOIC-exHC barring programs. Refer to Procedure CD_Authorization for further
details.
## 9.2 Support of Optimal Routeing
The procedures for optimal routeing of late call forwarding shall apply if the
Call Deflection supplementary service is invoked. Refer to TS 23.079 for
further details.
# 10 Information stored in the HLR
The following logical states are applicable for the Call Deflection service
(refer to TS 23.011 for an explanation of the notation):
**[Provisioning State]{.underline} [Registration State]{.underline}
[Activation State]{.underline} [HLR Induction State]{.underline}**
(Not Provisioned, Not Applicable, Not Active, Not Induced)
(Provisioned, Not Applicable, Active and Operative, Not Induced)
The HLR shall store:
\- the logical state of the Call Deflection service (which shall be one of the
valid states listed above) on a per subscriber basis.
\- the subscription option \"notification to the calling party\" on a per
subscriber basis;\ This subscription option takes one of the following
values:\ \- no notification;\ \- notification.
\- the subscription option \"MSISDN of the served subscriber can be presented
to the forwarded-to subscriber\" on a per subscriber basis;\ This subscription
option takes one of the following values:\ \- presentation restricted;\ \-
presentation allowed.
# 11 State transition model
Figure 11.1 shows the successful cases of transition between the applicable
logical states of the Call Deflection service. The state changes are caused by
actions of the service provider.
Note that error cases are not shown in the diagram as they normally do not
cause a state change. Additionally, some successful requests may not cause a
state change and are therefore not shown in the diagram.
{width="5.402083333333334in" height="1.9354166666666666in"}
Figure 11.1: State transition model
# 12 Transfer of information from HLR to VLR
If the provisioning state for the Call Deflection service is \"Provisioned\"
then when the subscriber registers on a VLR the HLR shall send that VLR
information about the logical state of the Call Deflection service In this
case the following additional information shall be sent to the VLR:
\- subscription options \"notification to the calling party\" and \"MSISDN of
the served subscriber can be presented to the forwarded-to subscriber\".
\- Translation Information Flag (TIF-CSI) if contained in the CAMEL subscriber
data of the served subscriber (refer to TS 23.078 for further details).
If the logical state of the Call Deflection service or the value of the
subscription options \"notification to the calling party\" or \"MSISDN of the
served subscriber can be presented to the forwarded-to subscriber\" or the
presence of the Translation Information Flag (TIF-CSI) is changed while a
subscriber is registered on a VLR then the HLR shall inform the VLR of the new
logical state or the new value of the subscription option or the presence of
the Translation Information Flag (TIF-CSI).
# 13 Information stored in the VLR
For the supplementary service Call Deflection the VLR shall store the service
state information, information about the subscription options \"notification
to the calling party\" and \"MSISDN of the served subscriber can be presented
to the forwarded-to subscriber\" and the Translation Information Flag (TIF-
CSI) received from the HLR.
# 14 Handover
Handover will have no impact on the control procedures and the operation of
the service.
#