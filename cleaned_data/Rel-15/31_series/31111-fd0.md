# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document defines the interface between the UICC and the Mobile
Equipment (ME), and mandatory ME procedures, specifically for \"USIM
Application Toolkit\".
The present document refers in its majority to the ETSI TS 102 223 [32], which
describes the generic aspects of application toolkits within the UICC.
USAT is a set of commands and procedures for use during 3GPP network operation
phase, in addition to those defined in TS 31.101 [13].
Specifying the interface is to ensure interoperability between a UICC and an
ME independently of the respective manufacturers and operators.
The present document defines for:
\- the commands;
\- the application protocol;
\- the mandatory requirements on the UICC and ME for each procedure.
The present document does not specify any aspects related to the
administrative management phase. Any internal technical realization of either
the UICC or the ME are only specified where these reflect over the interface.
The present document does not specify any of the security algorithms which may
be used.
For the avoidance of doubt, references to clauses of ETSI TS 102 223 [32]
include all the clauses of that clause, unless specifically mentioned.
The target specification ETSI TS 102 223 [32] contains material that is
outside of the scope of 3GPP requirements and the present document indicates
which parts are in the scope and which are not.
A 3GPP ME may support functionality that is not required by 3GPP, but the
requirements to do so are outside of the scope of 3GPP.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document in the same
Release as the present document.
[1] 3GPP TS 22.002: \"Circuit Bearer Services (BS) supported by a Public Land
Mobile Network (PLMN)\".
[2] 3GPP TS 22.030: \"Man‑Machine Interface (MMI) of the User Equipment
(UE)\".
[3] 3GPP TS 22.042: \"Network Identity and Time Zone (NITZ); Service
description; Stage 1\".
[4] 3GPP TS 23.038: \"Alphabets and language‑specific information\".
[5] 3GPP TS 23.040: \"Technical realization of the Short Message Service
(SMS)\".
[6] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service (CBS)\".
[7] 3GPP TS 23.122: \"Non-Access Stratum functions related to Mobile Station
(MS) in idle mode\".
[8] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
aspects\".
[9] 3GPP TS 24.008: \"Mobile radio interface layer 3 specification; Core
network protocols; Stage 3\".
[10] 3GPP TS 24.011: \"Point‑to‑Point (PP) Short Message Service (SMS) support
on mobile radio interface\".
[11] 3GPP TS 24.080: \"Mobile radio layer 3 supplementary services
specification; Formats and coding\".
[12] 3GPP TS 27.007: \"AT command set for User Equipment (UE)\".
[13] 3GPP TS 31.101: \"UICC-terminal interface; Physical and logical
characteristics\".
[14] 3GPP TS 31.102: \"Characteristics of the USIM application\".
[15] Void.
[16] Void.
[17] Void.
[18] Void.
[19] Void.
[20] Void.
[21] Void.
[22] 3GPP TS 22.001: \"Principles of circuit telecommunication services
supported by a Public Land Mobile Network (PLMN)\".
[23] Void.
[24] Void.
[25] Void.
[26] Void.
[27] 3GPP TS 44.018: \"Mobile radio interface Layer 3 specification; Radio
Resource Control Protocol\".
[28] Void.
[29] Void.
[30] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[31] Void.
> [32] ETSI TS 102 223 V15.2.0: \"Smart Cards; Card Application Toolkit\".
>
> [33] 3GPP TR 21.905: \"Vocabulary for 3GPP specifications\".
>
> [34] 3GPP TS 22.101: \"Service aspects; Service principles\".
[35] 3GPP TS 25.401: \"UTRAN overall description\".
> [36] 3GPP TS 25.413: \"UTRAN Iu interface RANAP signalling\".
>
> [37] 3GPP TS 24.090: \"Unstructured Supplementary Service Data (USSD) -
> Stage 3\".
>
> [38] 3GPP TS 25.331: \"Radio Resource Control (RRC) Protocol
> Specification\".
>
> [39] 3GPP TS 25.133: \"Requirements for support of radio resource
> management\".
>
> [40] Void.
>
> [41] 3GPP TS 31.115: \"Secured packet structure for the (U)SIM Toolkit
> applications\".
[42] 3GPP TS 24.234 Release 12: \"3GPP System to WLAN Interworking; UE to
Network protocols; Stage 3\".
[43] ETSI TS 101 220: \"Smart Cards; ETSI numbering system for
telecommunication application providers \".
[44] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
[45] IEC 61162-1: \"Maritime navigation and radio communication equipment and
systems -- Digital interfaces\".
[46] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
Systems (EPS): Stage 3\".
[47] 3GPP TS 23.203: \"Policy and charging control architecture\".
[48] 3GPP TS 36.401: \"Evolved Universal Terrestrial Radio Access Network
(E-UTRAN); Architecture description\".
[49] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
> [50] 3GPP TS 36.133: \" Evolved Universal Terrestrial Radio Access (E-UTRA);
> Requirements for support of radio resource management\".
[51] 3GPP TS 31.116: \"Remote APDU Structure for (U)SIM Toolkit
applications\".
[52] 3GPP TS 24.229 \"IP multimedia call control protocol based on SIP and
SDP; stage 3\"
[53] IETF RFC 3261: \"SIP: Session Initiation Protocol\".
[54] IETF RFC 3629 (2003): \"UTF-8, a transformation format of ISO 10646\".
[55] IETF RFC 3680 (2004): \"A Session Initiation Protocol (SIP) Event Package
for Registrations\".
[56] **3GPP TS 31.104: \"Characteristics of the Hosting Party Subscription
Identity Module (HPSIM) application\"**
[57] 3GPP TS 32.582: \"Telecommunications management; Home Node B (HNB)
Operations, Administration, Maintenance and Provisioning (OAM&P); Information
model for Type 1 interface HNB to HNB Management System (HMS)\".
[58] 3GPP TS 32.592: \"Telecommunications management; Home Node B (HeNB)
Operations, Administration, Maintenance and Provisioning (OAM&P); Information
model for Type 1 interface HeNB to HeNB Management System (HeMS)\".
[59] 3GPP TS 25.304: \"User Equipment (UE) procedures in idle mode and
procedures for cell reselection in connected mode\".
[60] 3GPP TS 36.304: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) procedures in idle mode\".
[61] 3GPP TS 24.334: \"Proximity-services (ProSe) User Equipment (UE) to ProSe
function protocol aspects; Stage 3\".
[62] 3GPP TS 31.103: \"Characteristics of the IP Multimedia Services Identity
Module (ISIM) application\".
[63] 3GPP TS 24.302: \"Access to the 3GPP Evolved Packet Core (EPC) via
non-3GPP access networks; Stage 3\".
[64] IEEE Std 802.11™-2012: \"Part 11: Wireless LAN Medium Access Control
(MAC) and Physical Layer (PHY) Specifications\".
[65] 3GPP TS 24.341: \"Support of SMS over IP networks; Stage 3\".
[66] 3GPP TS 36.211: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical channels and modulation\".
[67] 3GPP TS 22.011: \"Service accessibility\"
[68] 3GPP TS 24.368: \"Non-Access Stratum (NAS) configuration Management
Object (MO)\"
[69] 3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\"
[70] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
# 3 Definitions, abbreviations and symbols
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
ETSI TS 102 223 [32] clause 3.1 and TR 21.905 [33] apply.
Within the context of the present document, the term \"terminal\" used in ETSI
TS 102 223 [32] refers to the Mobile Equipment (ME).
Within the context of the present document, the term \"NAA\" used in ETSI TS
102 223 [32] refers to the USIM.
Within the context of the present document, the term \"CAT\" used in ETSI TS
102 223 [32] refers to the USAT.
Within the context of the present document, the following terms and
definitions given in 3GPP TS 22.011 [67] apply:
**3GPP PS data off**
**3GPP PS data off exempt service**
## 3.2 Abbreviations
For the purpose of the present document, the abbreviations given in ETSI TS
102 223 [32] and TR 21.905 [33] and the following apply:
5GS 5G System
ADN Abbreviated Dialling Number
BCCH Broacast Control Channel
BSSID Basic Service Set IDentifier
CB Cell Broadcast
CBMID Cell Broadcast Message Identifier
CSG Closed Subscriber Group
DNN Data Network Name
EGPRS EDGE General Packet Radio Service
EPS Evolved Packet System
E-UTRAN Evolved Universal Terrestrial Radio Access Network
FDN Fixed Dialling Number
GGSN Gateway GPRS Support Node
GPRS General Packet Radio Service
GSM Global System for Mobile communications
H(e)NB Home Node B or Home evolved Node B
HESSID Homogenous Extended Service Set Identifier
HPSIM Hosting Party Subscription Identity Module
HSDPA High Speed Downlink Packet Access
IARI IMS Application Reference Identifier
IMPU IMS Public User Identity
MM Multimedia Message
MMS Multimedia Messaging Service
MMI Man Machine Interface
NA No Audio-alerting capability
ND No Display capability
NG-RAN Next Generation -- Radio Access Network
NK No Keypad capability
NL No support of multiple Languages
NR New Radio
NS No Speech-call capability
PDN Packet Data Network
PDP Packet Data Protocol, e.g., Ip or X25 or PPP
PDU Protocol Data Unit
ProSe Proximity-based Services
PS Packet Switched
RFU Reserved for Future Use
SS Supplementary Service
SSC Supplementary Service Control string
SSID Service Set Identifier
USAT USIM Application Toolkit
USIM Universal Subscriber Identity Module
USSD Unstructured Supplementary Service Data
WSID WLAN Specific Identifier
## 3.3 Symbols
For the purposes of the present document, the following symbols apply:
\'0\' to \'9\' and \'A\' to \'F\' The sixteen hexadecimal digits.
# 4 Overview of USAT
The USAT provides mechanisms which allow applications, existing in the UICC,
to interact and operate with any ME which supports the specific mechanism(s)
required by the application.
The following mechanisms have been defined. These mechanisms are dependent
upon the commands and protocols relevant to USAT in TS 31.101 [13].
## 4.1 Profile Download
Profile downloading provides a mechanism for the ME to tell the UICC what it
is capable of.
## 4.2 Proactive UICC
Proactive UICC gives a mechanism whereby the UICC can initiate actions to be
taken by the ME. The supported functions are specified in clause 6.4.
For each command involved in the dialog with the user, a help information may
be available, either for each item of a list of items proposed to the user, or
with each command requesting a response from the user. If a proactive command
involved in the dialog with the user indicates the availability of the help
feature, the support of this feature is optional for the terminal.
## 4.3 Data download to UICC
Data downloading to the UICC uses either dedicated commands (the transport
mechanisms of SMS point-to-point and Cell Broadcast) or the Bearer independent
protocol. Transferral of information over the UICC-ME interface uses the
ENVELOPE command.
## 4.4 Menu selection
See ETSI TS 102 223 [32] clause 4.4.
## 4.5 Call control by USIM
When this service is activated by the USIM, all dialled digit strings,
supplementary service control strings and USSD strings, PDP context
parameters, PDN connection parameters, PDU session establishment parameters or
IMS communications parameters are first passed to a USIM application before
the ME sets up the call, the supplementary service operation or the USSD
operation, establishes the PDP context, the PDN connection, the PDU session or
initiates IMS communications. The ME shall also pass to the USIM application
at the same time its current serving cell. The USIM application has the
ability to allow, bar or modify the call, the supplementary service operation
or, the USSD operation, PDP context activation, PDN connection activation, PDU
session establishment or IMS communication set up by another context
activation. The USIM application also has the ability to replace a call
request, a supplementary service operation or a USSD operation by another call
request or supplementary service operation or USSD operation.
EXAMPLE: A call request can be replaced by a supplementary service operation
or a USSD operation, and vice-versa.
## 4.6 MO Short Message control by USIM
When this service is activated by the USIM, all MO short messages are first
passed to the USIM application before the ME sends the short message. The ME
shall also pass to the USIM application at the same time its current serving
cell. The USIM application shall have the ability to allow the sending, bar
the sending or modify the destination address of the short message before
sending it.
## 4.7 Event download
In addition to the set of events defined in ETSI TS 102 223 [32] clause 4.7,
the following event may also be reported to the UICC:
\- Network Rejection
\- CSG cell selection (if class \"q\" is supported)
\- Incoming IMS Data (if classes \"e\" and \"t\" are supported)
\- IMS Registration (if classes \"e\" and \"t\" are supported)
\- Data Connection Status Change (if class \"e\" is supported)
## 4.8 Security
See ETSI TS 102 223 [32] clause 4.8.
## 4.9 Multiple card
See ETSI TS 102 223 [32] clause 4.9.
## 4.10 Timer Expiration
See ETSI TS 102 223 [32] clause 4.10.
## 4.11 Bearer Independent Protocol
See ETSI TS 102 223 [32] clause 4.11.
## 4.12 Description of the access technology indicator mechanism
See ETSI TS 102 223 [32] clause 4.12.
## 4.13 Description of the network search mode mechanism
See ETSI TS 102 223 [32] clause 4.14.
## 4.14 Geographical location discovery
The proactive command Geographical Location Request and the envelope command
Geographical Location Reporting allows the UICC to request and receive the
current geographical location information from the ME when the ME is equipped
with a positioning feature and it is enabled (e.g. autonomous GPS, Assisted
GPS or Assisted GNSS).
## 4.15 Operation in reduced USAT capable terminals
This specification takes into account terminal types corresponding to the
following capabilities:
\- no display capability
\- no keypad available
\- no audio alerting capability
\- no speech call capability
\- no support of multiple languages.
These terminal types are used to identify which USAT features are not
available for each type of reduced functionality.
Note: Terminal types details are in Annex P.
## 4.16 Tag allocation guidelines
See ETSI TS 102 223 [32] clause 4.13.
## 4.17 USAT over the AT interface
See ETSI TS 102 223 [32] clause 4.16.
## 4.18 USAT facilities provided by eCAT clients
Not required by 3GPP.
## 4.19 Negotiation of Poll Interval
See ETSI TS 102 223 [32] clause 4.18.
## 4.20 ProSe usage information reporting
When the UICC supports the ProSe usage information reporting functionality,
the ProSe-enabled Public Safety UE stores in the UICC the information to
provide information necessary for composing of charging events related to the
ProSe direct communication. The UICC is responsible for communicating those
reports to the ProSe Function CTF (ADF) using BIP mechanism.
# 5 Profile download
## 5.1 Procedure
The profile download instruction is sent by the ME to the UICC as part of the
UICC initialization procedure. The UICC initialization procedure is specified
in TS 31.101 [13]. If class \"s\" is supported, the profile download
instruction is sent also every time the TE accessing USAT functionalities over
the AT interface is connected or disconnected or changes its profile. If the
terminal supports class \"s\" the profile download instruction shall combine
capabilities supported by the MT and the TE according to Annex Q.
If the UICC indicates the support of \"Additional TERMINAL PROFILE after UICC
activation\" in its USIM Service Table, the ME shall handle the profile
download procedure as specified in ETSI TS 102 223 [32] clause 5.1.
If the UICC does not indicate the support of \"Additional TERMINAL PROFILE
after UICC activation\" in its USIM Service Table, the profile download
instruction shall only be sent by the ME to the UICC as part of the UICC
initialization procedure. However, if a USIM initialisation procedure is
performed due to a refresh proactive command, the USIM initialisation
procedure may also include a profile download.
The profile(s) sent by the ME shall state the facilities relevant to USAT that
are supported by the ME.
## 5.2 Structure and coding of TERMINAL PROFILE
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data:
* * *
Description Clause M/O/C Length Profile - M lgth
* * *
\- Profile:
Contents:
\- The list of USAT facilities that are supported by the ME.
Coding:
\- 1 bit is used to code each facility:
\- bit = 1: facility supported by ME.
\- bit = 0: facility not supported by ME.
NOTE: several bits may need to be set to 1 for the support of the same
facility. This is because of backward compatibility with SAT: several options
existed in SAT for a given facility, and they are mandatory in USAT when this
facility is supported.
First byte (Download):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                SMS-PP data download
                                                Cell Broadcast data download
                                                See TS 102 223 \[32\] clause 5.2
                                                Bit = 1 if SMS-PP data download is supported
                                                See TS 102 223 \[32\] clause 5.2
                                                Bit = 1 if Call Control by USIM is supported
                                                Bit = 1 if Call Control by USIM is supported
* * *
Second byte (Other):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                Call Control by USIM
                                                Bit = 1 if Call Control by USIM is supported
                                                MO short message control by USIM
                                                Bit = 1 if Call Control by USIM is supported
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
* * *
Third byte (Proactive UICC):
\- See ETSI TS 102 223 [32] clause 5.2.
Fourth byte (Proactive UICC):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                Proactive UICC: SEND SHORT MESSAGE
                                                Proactive UICC: SEND SS
                                                Proactive UICC: SEND USSD
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                Proactive UICC: PROVIDE LOCAL INFORMATION (NMR) - in 3GPP terms, this indicates support for GERAN
* * *
Fifth byte (Event driven information):
\- See ETSI TS 102 223 [32] clause 5.2.
Sixth byte (Event driven information extensions):
\- See ETSI TS 102 223 [32] clause 5.2.
Seventh byte (Multiple card proactive commands) for class \"a\":
\- See ETSI TS 102 223 [32] clause 5.2.
Eighth byte (Proactive UICC):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                Bit = 1 if Call Control by USIM is supported
* * *
Ninth byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                Proactive UICC: PROVIDE LOCAL INFORMATION (Timing Advance)
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
* * *
Tenth byte (Soft keys support) for class \"d\":
\- See ETSI TS 102 223 [32] clause 5.2.
Eleventh byte: (Soft keys information):
\- See ETSI TS 102 223 [32] clause 5.2.
Twelfth byte (Bearer Independent protocol proactive commands) for class \"e\":
\- See ETSI TS 102 223 [32] clause 5.2.
Thirteenth byte (Bearer Independent protocol supported bearers) for class
\"e\":
\- See ETSI TS 102 223 [32] clause 5.2.
Fourteenth byte: (Screen height):
\- See ETSI TS 102 223 [32] clause 5.2.
Fifteenth byte: (Screen width):
\- See ETSI TS 102 223 [32] clause 5.2.
Sixteenth byte: (Screen effects):
\- See ETSI TS 102 223 [32] clause 5.2.
Seventeenth byte (Bearer independent protocol supported transport
interface/bearers) for class \"e\":
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                E-UTRAN
                                                HSDPA
* * *
Eighteenth byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                CALL CONTROL on GPRS
                                                See TS 102 223 \[32\] clause 5.2
* * *
Nineteenth byte: (reserved for TIA/EIA-136 facilities):
\- See ETSI TS 102 223 [32] clause 5.2.
Twentieth byte: (reserved for TIA/EIA/IS-820 facilities):
\- See ETSI TS 102 223 [32] clause 5.2.
Twenty-first byte (Extended Launch Browser Capability) for class \"c\":
\- See ETSI TS 102 223 [32] clause 5.2.
Twenty second byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Support of UTRAN PS with extended parameters
                                                See TS 102 223 \[32\] clause 5.2
                                                Toolkit-initiated GBA
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
* * *
Twenty third byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                Geographical Location Reporting (if class \"n\" is supported)
                                                See TS 102 223 \[32\] clause 5.2
                                                Proactive UICC: PROVIDE LOCAL INFORMATION (NMR(UTRAN/E-UTRAN))
                                                USSD Data download and application mode (if class \"p\" is supported)
* * *
Twenty fourth byte for class \"i\":
\- See ETSI TS 102 223 [32] clause 5.2.
Twenty-fifth byte (Event driven information extensions):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                Event: I-WLAN Access status (if class \"e\" is supported)
                                                Event: Network Rejection for GERAN/UTRAN
                                                Reserved by ETSI SCP: HCI connectivity event (i.e. class \"m\" is supported)
                                                Event: Network Rejection for E-UTRAN
                                                See TS 102 223 \[32\] clause 5.2
* * *
Twenty-sixth byte (Event driven information extensions):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Event : CSG Cell Selection (if class \"q\" is supported)
                                                Reserved by ETSI SCP: Contactless state request (if class \"r\" is supported
                                                See TS 102 223 \[32\] clause 5.2
* * *
Twenty-seventh byte (Event driven information extensions):
\- See ETSI TS 102 223 [32] clause 5.2.
Twenty-eighth byte (Text attributes):
\- See ETSI TS 102 223 [32] clause 5.2.
Twenty-ninth byte (Text attributes):
\- See ETSI TS 102 223 [32] clause 5.2.
Thirtieth byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                I-WLAN bearer support (if class \"e\" is supported)
                                                Proactive UICC: PROVIDE LOCAL INFORMATION (WSID of the current I-WLAN connection)
                                                TERMINAL APPLICATIONS (i.e. class \"k\" is supported)
                                                \"Steering of Roaming\" REFRESH support
                                                Reserved by ETSI SCP: Proactive UICC command ACTIVATE (i.e class \"l\" is supported)
                                                Proactive UICC: Geographical Location Request (if class \"n\" is supported)
                                                See TS 102 223 \[32\] clause 5.2
                                                \"Steering of Roaming for I-WLAN\" REFRESH support
* * *
Thirty-first byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                Support of CSG cell discovery (if class \"q\" is supported)
                                                See TS 102 223 \[32\] clause 5.2
                                                Communication Control for IMS
                                                See TS 102 223 \[32\] clause 5.2
                                                Support for Incoming IMS Data event (if classes \"e\" and \"t\" are supported)
                                                Support for IMS Registration event (if classes \"e\" and \"t\" are supported)
                                                Reserved by ETSI SCP: Proactive UICC: Profile Container, Envelope Container, COMMAND CONTAINER and ENCAPSULATED SESSION CONTROL (if class \"u\" is supported)
* * *
Thirty-second byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                IMS support (if class \"e\" and \"t\" are supported)
                                                Support of PROVIDE LOCATION INFORMATION, H(e)NB IP address (if class \"v\" is supported)
                                                support of PROVIDE LOCATION INFORMATION, H(e)NB surrounding macrocells (if class \"w\" is supported)
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
* * *
Thirty-third byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                ProSe usage information reporting (used only if class \"e\" is supported)
                                                See TS 102 223 \[32\] clause 5.2
                                                Event: WLAN Access status (if class \"e\" is supported)
                                                WLAN bearer support (if class \"e\" is supported)
                                                Proactive UICC: PROVIDE LOCAL INFORMATION (WLAN identifier of the current WLAN connection)
* * *
Thirty-fourth byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                URI support for SEND SHORT MESSAGE
                                                IMS URI supported for SET UP CALL (if class \"ae\" is supported)
                                                Media Type \"Voice\" supported for SET UP CALL and Call Control by USIM
                                                Media Type \"Video\" supported for SET UP CALL and Call Control by USIM
                                                Proactive UICC: PROVIDE LOCAL INFORMATION (E-UTRAN Timing Advance Information)
                                                See TS 102 223 \[32\] clause 5.2
                                                Extended Rejection Cause Code in Event: Network Rejection for E-UTRAN
                                                See TS 102 223 \[32\] clause 5.2
* * *
Thirty-fifth byte:
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                See TS 102 223 \[32\] clause 5.2
                                                Data Connection Status Change Event support -- PDP Connection
                                                Data Connection Status Change Event support -- PDN Connection
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
                                                See TS 102 223 \[32\] clause 5.2
* * *
Thirty sixth byte:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                Data Connection Status Change Event support -- PDU Connection
                                                Event: Network Rejection for NG-RAN
                                                Non-IP Data Delivery support (if class \"e\" and class \"ai\" are supported)
                                                Reserved for 3GPP (for future usage)
Thirty seventh byte:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                Reserved for 3GPP (for future usage)
Thirty eighth byte:
        b8   b7   b6   b5   b4   b3   b2   b1
* * *
                                                Reserved for 3GPP (for future usage)
Subsequent bytes:
\- See ETSI TS 102 223 [32] clause 5.2.
Response parameters/data:
\- None.
## 5.3 Definition of display parameters in Profile download
See ETSI TS 102 223 [32] clause 5.3.
# 6 Proactive UICC
## 6.1 Introduction
TS 31.101 [13] defines the communication protocols between the ME and the
UICC, and defines a mechanism to transport \"proactive\" commands using these
protocols. Details about how this mechanism is used for USAT are defined in TS
102 223 [32] clause 6.1. The supported proactive commands are specified in
clause 6.4. of the present document.
If the UICC issues an instruction to the ME to initiate a Mobile Originated
transaction (e.g. SEND SMS, SEND SS, SEND USSD or SEND DTMF), then unless
explicitly stated elsewhere in the present document or in TS 31.101 [13], the
content supplied by the UICC for onward transmission by the ME shall not be
altered by the ME.
## 6.2 Identification of ME support
See ETSI TS 102 223 [32] clause 6.2.
## 6.3 General procedure
See ETSI TS 102 223 [32] clause 6.3.
## 6.4 Proactive UICC commands and procedures
### 6.4.1 DISPLAY TEXT
See ETSI TS 102 223 [32] clause 6.4.1.
### 6.4.2 GET INKEY
See ETSI TS 102 223 [32] clause 6.4.2.
### 6.4.3 GET INPUT
See ETSI TS 102 223 [32] clause 6.4.3.
### 6.4.4 MORE TIME
See ETSI TS 102 223 [32] clause 6.4.4.
### 6.4.5 PLAY TONE
See ETSI TS 102 223 [32] clause 6.4.5.
NOTE: Some supervisory tones are optional for mobile equipment (see TS 22.001
[22]).
### 6.4.6 POLL INTERVAL
See ETSI TS 102 223 [32] clause 6.4.6.
### 6.4.7 REFRESH
See ETSI TS 102 223 [32] clause 6.4.7 except for:
\- \"eUICC Profile State Change\" and \"Application Update\" which are not
required by 3GPP;
\- \"3G Session Reset\" and \"Steering of Roaming\" which are defined as
follows.
3G Session Reset:\ This mode causes the ME to reset the 3G session, in
accordance with the 3G session reset procedure defined in TS 31.102 [14].
Subsequently, the ME performs the \"USIM Initialization and File Change
Notification\" procedure and the MM Restart procedure as defined in TS 23.122
[7].
Steering of Roaming:\ This mode triggers a steering of roaming procedure as
defined in TS 23.122 [7] or a steering of roaming for I-WLAN procedure as
defined in TS 24.234 [42].
#### 6.4.7.1 EF~IMSI~ changing procedure
When an EF~IMSI~ is changed via Data Download or a USAT application and a
REFRESH command is issued by the UICC the following rules apply to the UICC
and ME:
\- USIM Initialization. This command shall not be used if an EF~IMSI~ is
changed, as the behaviour of the UE is unpredictable;
\- File Change Notification. This command shall not be used if an EF~IMSI~ is
changed, as the behaviour of the UE is unpredictable;
\- USIM Initialization and File Change Notification. This command shall not be
used if an EF~IMSI~ is changed, as the behaviour of the UE is unpredictable;
\- USIM Initialization and Full File Change Notification. This command shall
not be used if an EF~IMSI~ is changed, as the behaviour of the UE is
unpredictable;
\- UICC Reset. Normal UICC Reset procedure is carried out;
\- USIM Application Reset. Normal USIM Application Reset procedure is carried
out;
\- 3G Session Reset. Normal 3G Session Reset procedure is carried out.
If an EF~IMSI~ is to be updated, neither EF~IMSI~ , EF~PSLOCI~ , EF~EPSLOCI~,
EF~LOCI~, EF~5GS3GPPLOCI~ nor EF~5GSN3GPPLOCI~ shall be updated in the UICC
before the 3G session termination procedure has been completed by the ME.
#### 6.4.7.2 Generic Bootstrapping Procedure Request
If Toolkit-initiated GBA is supported by the ME, as indicated in the TERMINAL
PROFILE, then the following applies:
When the UICC issues a REFRESH command implying a File Change Notification on
EF~GBABP~ (GBA Bootstrapping parameters) under ADF USIM or ADF ISIM the ME
shall perform a GBA bootstrapping procedure (as defined in TS 31.102 [14] or
TS 31.103 [62]).
This procedure applies to REFRESH command only in the following modes: USIM
File Change Notification; USIM Initialization and File Change Notification;
and 3G Session Reset.
#### 6.4.7.3 EF~UICCIARI~ changing procedure
When an EF~UICCIARI~ is changed in either the USIM or the ISIM via Data
Download or a USAT application and a REFRESH command is issued by the UICC the
following rule applies to the ME:
The ME shall read the updated list of IARIs associated with active
applications installed on the UICC and follow the procedures defined in TS
24.229 [52].
#### 6.4.7.4 Steering of roaming and steering of roaming for I-WLAN procedure
The steering of roaming procedures defined in TS 23.122 [7] and in TS 24.234
[42] might take a long time. In order to avoid blocking the Toolkit interface,
the ME shall send the TERMINAL RESPONSE (Command performed successfully)
immediately after starting the steering of roaming procedure, without waiting
for its completion. The ME shall send TERMINAL RESPONSE (ME unable to process
command or other appropriate code) in case it fails to start the steering of
roaming procedure.
#### 6.4.7.5 Steering of roaming via NAS messages
When the ME receives an SOR transparent container, as specified in 3GPP TS
24.501 [70] clause 9.11.3.51, via a REGISTRATION ACCEPT message (see 3GPP TS
23.122 [7] Annex C.2 ) or via a DL NAS TRANSPORT message (see 3GPP TS 23.122
[7] Annex C.3 ), with the indication that the transparent container shall be
forwarded to the USIM using SMS-PP data download, and the integrity check of
the message was successful, the ME shall pass the transparent container to the
USIM by using the procedure for SMS-PP data download via REGISTRATION ACCEPT
or DL NAS TRANSPORT messages as described in clause 7.1.1.1a
#### 6.4.7.6 Routing Indicator Data update via NAS messages
When the ME receives a secure packet in a UE parameters update data set with
UE parameters update data set type set to Routing Indicator update data as
specified in 3GPP TS 24.501 [70] clause 9.11.3.53A, via a DL NAS TRANSPORT
message, and the integrity check of the message was successful, the ME shall
pass the transparent container to the USIM by using the procedure for SMS-PP
data download via DL NAS TRANSPORT messages as described in clause 7.1.1.1a.
Upon successfully processing the Routing Indicator data from the secure packet
on the UICC, the UICC shall issue a File Change Notification REFRESH.
### 6.4.8 SET UP MENU
See ETSI TS 102 223 [32] clause 6.4.8.
### 6.4.9 SELECT ITEM
See ETSI TS 102 223 [32] clause 6.4.9.
### 6.4.10 SEND SHORT MESSAGE
This command requests the ME to send a short message.
Two types are defined in ETSI TS 102 223 [32] clause 6.4.10 and apply as
follows within the context of the present document:
\- a short message to be sent to the network in an SMS-SUBMIT message, or an
SMS-COMMAND message, where the user data can be passed transparently;
\- a short message to be sent to the network in an SMS-SUBMIT message where
the text needs to be packed by the ME.
Where the text has been packed, the text string provided by the UICC shall not
be longer than 160 characters. It shall use the SMS default 7-bit coded
alphabet, packed into 8-bit octets, in accordance with TS 23.038 [4]. The data
coding indication contained in the Data Coding Scheme byte shall be \"default
alphabet\". The text length (which is part of the SMS TPDU) given by the UICC
shall state the number of 7-bit characters in the text string. The command
details shall indicate \"packing not required\".
8-bit data Short Messages may be sent by the UICC. The command shall indicate
packing not required. The data coding indication contained in the Data Coding
Scheme byte shall be \"8 bit\". The string shall not be longer than 140 bytes,
and the length (in SMS TPDU) shall state the number of bytes in the string.
If UCS2 is supported by the ME, 16-bit data Short Messages may be sent by the
UICC. The text string provided by the UICC shall not be longer than 70
characters. It shall use the 16-bit UCS2 alphabet format, in accordance with
TS 23.038 [4]. The text length (which is part of the SMS TPDU) given by the
UICC shall state the number of 16-bit characters in the text string. The
command details shall indicate \"packing not required\".
SMS commands may be sent by the UICC. These shall count as packed text
message. The SMS TPDU from the UICC shall indicate SMS-COMMAND. The command
details shall indicate \"packing not required\".
Where packing by the ME is required, the text string provided by the UICC
shall not be longer than 160 characters. It shall use the SMS default 7-bit
coded alphabet as defined in TS 23.038 [4] with bit 8 set to 0. The text
length given by the UICC shall state the number of characters in the text
string. The ME shall pack the text string and modify the Data Coding Scheme
byte to \"default alphabet\" in accordance with TS 23.038 [4] before
submitting the message to the network.
Optionally, the UICC may include in this command an alpha identifier. See ETSI
TS 102 223 [32] clause 6.4.10 for the use of this alpha identifier.
If the ME is capable of SMS-MO, then it shall send the data as a Short Message
TPDU to the destination address. The ME shall give the result to the UICC
using TERMINAL RESPONSE (indicating successful or unsuccessful transmission of
the Short Message) after receiving an SMS RP-ACK or RP-Error from the network.
If an alpha identifier was provided by the UICC, the ME should not give any
information to the user at the reception of SMS RP-ACK or RP-Error.
If the Short Message TPDU is unsuccessfully received by the network (e.g. the
reception of a CP-ERROR), the ME shall inform the UICC using TERMINAL RESPONSE
(network currently unable to process command). If a null alpha identifier was
provided by the UICC, the ME should not give any information to the user at
the unsuccessful network reception.
### 6.4.11 SEND SS
Upon receiving this command, the ME shall decide if it is able to execute the
command. Examples are given below, but the list is not exhaustive:
\- if the command is rejected because the ME is busy on an SS transaction, the
ME informs the UICC using TERMINAL RESPONSE (ME unable to process command -
currently busy on SS transaction);
\- if the command is rejected because the ME is busy on a USSD transaction,
the ME shall inform the UICC using TERMINAL RESPONSE (ME unable to process
command - currently busy on USSD transaction);
\- if the command is rejected because the ME does not support that
Supplementary Service, the ME informs the UICC using TERMINAL RESPONSE
(Command beyond ME\'s capabilities).
If the ME is able to send the SS request, the ME shall:
\- send the SS request immediately, without need to alert the user first;
\- optionally, the UICC may include in this command an alpha-identifier. The
use of this alpha-identifier by the ME is described below:
\- if the alpha identifier is provided by the UICC and is not a null data
object, the ME shall use it to inform the user. This is also an indication
that the ME should not give any other information to the user on the fact that
the ME is sending a SS request. If an icon is provided by the UICC, the icon
indicated in the command may be used by the ME to inform the user, in addition
to, or instead of the alpha identifier, as indicated with the icon qualifier
(see clause 6.5.4);
\- if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), this is an indication that the ME
should not give any information to the user on the fact that the ME is sending
an SS request;
\- if the alpha identifier is not provided by the UICC, the ME may give
information to the user concerning what is happening.
\- once an SS Return Result message not containing an error has been received
from the network, the ME shall inform the UICC that the command has been
successfully executed, using TERMINAL RESPONSE. This command shall include the
contents of SS Return Result as additional data.\ If a null alpha identifier
was provided by the UICC, the ME should not give any information to the user
at the reception of an SS Return Result message;
\- if the command is rejected because the network cannot support or is not
allowing the Supplementary Service request, the ME informs the UICC using
TERMINAL RESPONSE (SS Return Result error code).\ If a null alpha identifier
was provided by the UICC, the ME should not give any information to the user
at the reception of a SS Return Result message;
\- if the SS request is unsuccessfully received by the network, the ME shall
inform the UICC using TERMINAL RESPONSE (network currently unable to process
command), and not retry to send the request.\ If a null alpha identifier was
provided by the UICC, the ME should not give any information to the user at
the reception of a SS Return Result message.
A terminal of type ND shall ignore any alpha identifier provided together with
this command. The terminal shall respond with \"command performed
successfully\" upon successful completion of the command. A terminal of type
ND shall also ignore any icon provided together with this command. The
terminal shall respond with \"command performed successfully but requested
icon could not be displayed\" upon successful completion of the command.
If the ME supports the Outgoing Call Information service, the ME shall not
store in EF~OCI~ the supplementary service control string sent by the UICC in
this command.
The supplementary service control string included in the SEND SS proactive
command shall not be checked against those of the FDN list, even if the Fixed
Dialling Number service is enabled.
### 6.4.12 SEND USSD
#### 6.4.12.1 MMI Mode
Upon receiving this command, the ME shall decide if it is able to execute the
command. Examples are given below, but the list is not exhaustive:
\- if the command is rejected because the ME is busy on a USSD transaction,
the ME informs the UICC using TERMINAL RESPONSE (ME unable to process command
- currently busy on USSD transaction);
\- if the command is rejected because the ME is busy on a SS transaction, the
ME informs the UICC using TERMINAL RESPONSE (ME unable to process command -
currently busy on SS transaction).
If the ME is able to send the USSD request, the ME shall:
\- send the USSD immediately, without need to alert the user first;
\- optionally, the UICC may include in this command an alpha-identifier. The
use of this alpha-identifier by the ME is described below:
\- if the alpha identifier is provided by the UICC and is not a null data
object, the ME shall use it to inform the user. This is also an indication
that the ME should not give any other information to the user on the fact that
the ME is sending a USSD request. If an icon is provided by the UICC, the icon
indicated in the command may be used by the ME to inform the user, in addition
to, or instead of the alpha identifier, as indicated with the icon qualifier
(see clause 6.5.4);
\- if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), this is an indication that the ME
should not give any information to the user on the fact that the ME is sending
a USSD request;
\- if the alpha identifier is not provided by the UICC, the ME may give
information to the user concerning what is happening.
A terminal of type ND shall ignore any alpha identifier provided together with
this command. The terminal shall respond with \"command performed
successfully\" upon successful completion of the command. A terminal of type
ND shall also ignore any icon provided together with this command. The
terminal shall respond with \"command performed successfully but requested
icon could not be displayed\" upon successful completion of the command.
\- once the USSD transaction is initiated, a dialogue between the network and
the user may occur which involves the MMI of the ME. If an alpha identifier
was initially provided by the UICC, this alpha identifier may be discarded
during this dialogue;
\- once a RELEASE COMPLETE message containing the USSD Return Result message
not containing an error has been received from the network, the ME shall
inform the UICC that the command has been successfully executed, using
TERMINAL RESPONSE. This command shall include the text contained in the USSD
Return Result in a Text String data object. If a null alpha identifier was
provided by the UICC, the ME should not give any information to the user at
the reception of a USSD Return Result message;
\- if the UE clears the transaction by sending a RELEASE COMPLETE upon request
of the user, the ME shall inform the UICC using TERMINAL RESPONSE (USSD
transaction terminated by user);
\- if the USSD operation is rejected because the network cannot support or is
not allowing mobile initiated USSD, the ME informs the UICC using TERMINAL
RESPONSE (USSD Return Result error code). If a null alpha identifier was
provided by the UICC, the ME should not give any information to the user at
the reception of a USSD Return Result message;
\- if the USSD request is unsuccessfully received by the network, the ME shall
inform the UICC using TERMINAL RESPONSE (network currently unable to process
command), and not retry to send the request. If a null alpha identifier was
provided by the UICC, the ME should not give any information to the user at
the reception of a USSD Return Result message.
#### 6.4.12.2 Application Mode
This clause applies if class \"p\" is supported.
A USSD is considered as Application Mode (Send USSD used for the transport of
Data to the network) if the service \"data download via USSD and USSD
application mode\" is allocated and activated in the USIM Service Table (see
TS 31.102 [14]) and the DCS coding within the USSD string TLV is set to 8 bit
data.
Upon receiving this command, the ME shall decide if it is able to execute the
command. Examples are given below, but the list is not exhaustive:
\- if the command is rejected because the ME is busy on a USSD transaction,
the ME informs the UICC using TERMINAL RESPONSE (ME unable to process command
- currently busy on USSD transaction);
\- if the command is rejected because the ME is busy on a SS transaction, the
ME informs the UICC using TERMINAL RESPONSE (ME unable to process command -
currently busy on SS transaction).
If the ME is able to send the USSD request then the ME shall:
> \- send the USSD immediately, without need to alert the user first;
\- optionally, the UICC may include in this command an alpha-identifier. The
use of this alpha-identifier by the ME is described below:
\- if the alpha identifier is provided by the UICC and is not a null data
object, the ME shall use it to inform the user. This is also an indication
that the ME should not give any other information to the user on the fact that
the ME is sending a USSD request. If an icon is provided by the UICC, the icon
indicated in the command may be used by the ME to inform the user, in addition
to, or instead of the alpha identifier, as indicated with the icon qualifier
(see clause 6.5.4);
\- if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), this is an indication that the ME
should not give any information to the user on the fact that the ME is sending
a USSD request;
\- if the alpha identifier is not provided by the UICC, the ME may give
information to the user concerning what is happening.
\- once a FACILITY (including RELEASE COMPLETE) message containing a USSD
Request message has been received from the network, the ME shall inform the
UICC that the network requests more information , using the command ENVELOPE
(USSD Data Download). This command shall include the text contained in the
USSD Request in a Text String data object. If a null alpha identifier was
provided by the UICC, the ME should not give any information to the user at
the reception of a USSD Request message.
A terminal of type ND shall ignore any alpha identifier provided together with
this command. The terminal shall respond with \"command performed
successfully\" upon successful completion of the command. A terminal of type
ND shall also ignore any icon provided together with this command. The
terminal shall respond with \"command performed successfully but requested
icon could not be displayed\" upon successful completion of the command.
### 6.4.13 SET UP CALL
This command is issued by the UICC to request a call set up. The procedure is
defined in ETSI TS 102 223 [32] clause 6.4.13, except when stated otherwise in
the present document.
The UICC may request the use of an automatic redial mechanism according to TS
22.001 [22]
In addition to the rules given in ETSI TS 102 223 [32] clause 6.4.13 the
following applies:
\- If the UICC supplies a number stored in EF~ECC~, this shall not result in
an emergency call.
Upon receiving this command, the ME shall decide if it is able to execute the
command. Examples are given below, but the list is not exhaustive:
\- if the command is rejected because the ME is busy on another call, the ME
informs the UICC using TERMINAL RESPONSE (ME unable to process command -
currently busy on call);
\- if the command is rejected because the ME is busy on a SS transaction, the
ME informs the UICC using TERMINAL RESPONSE (ME unable to process command -
currently busy on SS transaction);
\- if the command is rejected because the ME cannot support Call Hold, or
because the ME does not support the capability configuration parameters
requested by the UICC, the ME informs the UICC using TERMINAL RESPONSE
(Command beyond ME\'s capabilities);
\- if the command is rejected because the network cannot support or is not
allowing Call Hold of a multi party call, the ME informs the UICC using
TERMINAL RESPONSE (SS Return Result error code);
\- if the command is rejected because the network cannot support or is not
allowing Call Hold of a single call, the ME informs the UICC using TERMINAL
RESPONSE (Network currently unable to process command).
If the ME supports the Outgoing Call Information service, the ME shall not
store in EF~OCI~ and in EF~OCT~ the call set-up details (called party number
and associated parameters) sent by the UICC in this command.
### 6.4.14 POLLING OFF
See ETSI TS 102 223 [32] clause 6.4.14.
### 6.4.15 PROVIDE LOCAL INFORMATION
This command requests the ME to send current local information to the UICC. At
present, this information is restricted to:
\- location information: the mobile country code (MCC), mobile network code
(MNC), location area code/tracking area code (LAC/TAC) and cell ID of the
current serving cell;
NOTE: For UTRAN the cell ID returned in terminal response is the last known
cell ID which may not be the current serving cell, when the ME is on a
dedicated channel.
\- the IMEI or IMEISV of the ME;
\- the Network Measurement Results (and the BCCH channel list if connected to
GERAN);
\- the current date, time and time zone;
\- the current ME language setting;
\- the Timing Advance, suitable only for GERAN or for E-UTRAN;
\- the current access technology;
\- the current network search mode;
\- the charge state of the battery (if class \"g\" is supported);
\- the WSID of the current I-WLAN connection;
\- the WLAN identifier of the current WLAN connection;
\- the CSG ID list and corresponding HNB names (if available in the
broadcasted information to the ME) of detected CSG or Hybrid cells in the
Allowed CSG list or the Operator CSG list (if class \"q\" is supported);
\- the H(e)NB IP address. (if class \"v\" is supported);
\- the list of location information for surrounding macrocells (if class \"w\"
is supported).
The above information can be requested only if supported by the ME as
indicated in the TERMINAL PROFILE.
The ME shall return the requested local information within a TERMINAL
RESPONSE.
Where location information or Network Measurement Results has been requested
and no service is currently available, then the ME shall return TERMINAL
RESPONSE (ME currently unable to process command - no service).
Where location information or Network Measurement Results has been requested
and the ME is on limited service (e.g. emergency calls only), the ME shall
return the data requested in the TERMINAL RESPONSE with the general result
(Limited Service).
Where Network Measurement Results has been requested and the ME is connected
to a different access technology to the one requested (e.g. UTRAN Measurement
Qualifier included when ME is connected to a GERAN), then the ME shall return
TERMINAL RESPONSE (ME currently unable to process command - no service).
Network Measurement Results are available on a per access technology basis and
indicated as such in the Terminal Profile.
Network Measurement Results for a GERAN:
> If the NMR are requested and a call is in progress, the value of all the
> returned parameters provided by the ME in the response to the command will
> be valid. The NMR returned when a call is in progress from Mes supporting
> multiband operation, shall be according to the value of the multiband
> reporting parameter as defined in TS 44.018 [27]. If a call is not in
> progress (i.e. ME is in idle mode) some of the returned parameters (e.g.
> RXQUAL) may be invalid. In idle mode, Mes supporting multiband operation
> shall ignore the value of the multiband reporting parameter and the NMR
> returned shall be as defined in TS 44.018 [27] when the multiband reporting
> parameter equals zero.
>
> NOTE 1: When in idle mode, the only information element on which it is
> possible to rely on is the RXLEV-FULL-SERVING-CELL, which contains the value
> of the received signal strength on the BCCH of the current serving cell.
>
> NOTE 2: Network Measurement Results are defined in TS 44.018 [27] as
> Measurement Results.
>
> The BCCH channel list is only available if the ME is connected to a GERAN.
Network Measurement Results for a UTRAN:
> The USIM request for measurement information shall not trigger any
> measurement activities in ME in addition to those requested by UTRAN.
>
> The ME shall only report measurement results that are valid according to the
> current RRC state or the UTRAN configuration requested.
>
> NOTE 3: The returned parameters provided by the ME, in the response to the
> command, are subject to the ME capability, currently used radio
> configuration, current RRC state and the UTRAN configuration requested as
> defined in the TS 25.331 [38].
>
> NOTE 4: Network Measurement Results are defined in TS 25.331 [38] as the
> MEASUREMENT REPORT message.
Network Measurement Results for a E-UTRAN:
> The USIM request for measurement information shall not trigger any
> measurement activities in ME in addition to those requested by E-UTRAN.
>
> The ME shall only report measurement results that are valid according to the
> current RRC state or the E-UTRAN configuration requested.
>
> NOTE 5: The returned parameters provided by the ME, in the response to the
> command, are subject to the ME capability, currently used radio
> configuration, current RRC state and the E-UTRAN configuration requested as
> defined in the TS 36.331 [49].
>
> NOTE 6: Network Measurement Results are defined in TS 36.331 [49] as the
> _MeasurementReport_ message.
The ME shall return the current date and time as set by the user. An ME of
type NK or type ND may return the date and time received from the network with
the NITZ feature (see TS 22.042 [3]), if this is available. If available, the
ME shall also return the time zone known from the network with the NITZ
feature (see TS 22.042 [3]). If the time zone information is not available,
the ME shall return \'FF\' for this element.
If language setting is requested, the ME shall return the currently used
language.
Timing advance is only available if the ME is connected to a GERAN or E-UTRAN.
If the Timing Advance is requested, the ME shall return the timing advance
value that was received from the BTS or eNodeB during the last active
dedicated connection (e.g. for call or SMS). Timing advance is defined for
GERAN in TS 44.018 [27] and for E-UTRAN in 3GPP TS 36.211 [66]. An ME
supporting the Timing Advance feature shall be able to store the last value of
timing advance. In addition to the timing advance value, the ME shall return
its current status (i.e. ME is in idle mode or not) in order for the
application to be aware of potential misinterpretation of the timing advance
value. Caution should be taken if using the Timing Advance value for distance
measurement as reflections from the external environment (buildings etc.) may
affect the accuracy.
If the access technology is requested, the ME shall return the current access
technology that the ME is using.
The WSID or the WLAN identifier is only available if the ME is connected to a
I-WLAN or a WLAN respectively. If the WSID or the WLAN identifier is
requested, the ME shall return the WSID or the WLAN identifier respectively of
the currently connected I-WLAN or a WLAN respectively. Where a WSID or the
WLAN identifier has been requested and no I-WLAN or WLAN respectively is
currently connected, then the ME shall return TERMINAL RESPONSE (ME currently
unable to process command - no service).
When CSG ID list is requested, the ME shall return the CSG ID list and the
corresponding HNB name (if available in the broadcasted information to the
ME). If the CSG ID list has been requested, and the ME is currently not camped
on a CSG or Hybrid cell, the ME shall return TERMINAL RESPONSE (ME currently
not able to process command -- no service).
The proactive command PROVIDE LOCAL INFORMATION -- H(e)NB IP address is issued
on the H(e)NB-HPSIM interface, see TS 31.104 [56].
When the IP address is requested, the H(e)NB shall return the IP address
reported to H(e)MS and/or HNB-GW for location verification based on IP address
(which may be a local IP address). If no such IP address is available to the
H(e)NB, the H(e)NB shall return TERMINAL RESPONSE (ME currently not able to
process command -- no service). If several such IP addresses are available,
the H(e)NB provides all of them to the UICC.
The proactive command PROVIDE LOCAL INFORMATION -- H(e)NB surrounding
macrocell is issued on the H(e)NB-HPSIM interface, see TS 31.104 [56].
When the list of surrounding macrocells is requested, the H(e)NB shall provide
the list of location information for detected macrocells.
\- For the HNB, all cell information contained in: intra-frequency neighbor
list, inter-frequency neighbor list, inter-RAT neighbor list, that are
reported to the HMS, see TS 32.582 [57] sec 6.1.1.
\- For the HeNB, all cell information contained in: LTE cell neighbor list,
UMTS cell neighbor list, GSM cell neighbor list, that are reported to the
HeMS, see TS 32.592 [58] sec 6.1.15.
Location information contains the mobile country code (MCC), mobile network
code (MNC), location area code/tracking area code (LAC/TAC) and cell ID. The
list of surrounding macrocells is provided for all access technologies
supported by the H(e)NB, up to the limit of the TERMINAL RESPONSE APDU command
size.
> Note: the HPSIM request for H(e)NB surrounding macrocell does not trigger a
> network scan; the H(e)NB reports available information to the HPSIM.
### 6.4.16 SET UP EVENT LIST
See ETSI TS 102 223 [32] clause 6.4.16.
### 6.4.17 PERFORM CARD APDU
See ETSI TS 102 223 [32] clause 6.4.17.
### 6.4.18 POWER OFF CARD
See ETSI TS 102 223 [32] clause 6.4.18.
### 6.4.19 POWER ON CARD
See ETSI TS 102 223 [32] clause 6.4.19.
### 6.4.20 GET READER STATUS
See ETSI TS 102 223 [32] clause 6.4.20.
### 6.4.21 TIMER MANAGEMENT
See ETSI TS 102 223 [32] clause 6.4.21.
### 6.4.22 SET UP IDLE MODE TEXT
See ETSI TS 102 223 [32] clause 6.4.22.
### 6.4.23 RUN AT COMMAND
See ETSI TS 102 223 [32] clause 6.4.23.
### 6.4.24 SEND DTMF
See ETSI TS 102 223 [32] clause 6.4.24.
### 6.4.25 LANGUAGE NOTIFICATION
See ETSI TS 102 223 [32] clause 6.4.25.
### 6.4.26 LAUNCH BROWSER
This command is used to request a browser inside a browser-enabled ME to
interpret the content corresponding to a URL. See ETSI TS 102 223 [32] clause
6.4.26.
Upon receiving this command, the ME shall decide if it is able to execute the
command. In addition to the examples given in ETSI TS 102 223 [32] clause
6.4.26 the following example applies:
\- if the command is rejected because the ME is busy on a SS transaction, the
ME informs the UICC using TERMINAL RESPONSE (ME unable to process command - ME
currently unable to process command);
### 6.4.27 OPEN CHANNEL
#### 6.4.27.1 OPEN CHANNEL related to CS bearer
This command is issued by the UICC to request a channel opening. The procedure
is defined in ETSI TS 102 223 [32] clause 6.4.27.1, except when stated
otherwise in the present document.
The UICC may request the use of an automatic reconnection mechanism according
to TS 22.001 [22].
Upon receiving this command, the ME shall decide if it is able to execute the
command. In addition to the examples given in ETSI TS 102 223 [32] clause
6.4.27.1 the following example applies:
\- if the command is rejected because the ME is busy on a SS transaction, the
ME informs the UICC using TERMINAL RESPONSE (ME unable to process command -
currently busy on SS transaction). The operation is aborted.
The \"Bearer description\" provided in the command gives recommended values
for parameters that the ME should use to establish the data link. However if
the ME or network does not support these values, the ME selects the most
appropriate values.
#### 6.4.27.2 OPEN CHANNEL related to GPRS/UTRAN packet service/E-UTRAN/NG-RAN
The procedures defined in ETSI TS 102 223 [32] clause 6.4.27.2 apply,
understanding that:
\- \"packet data service\" means GPRS, UTRAN packet service, E-UTRAN or NG-
RAN,
\- \"activation of packet data service\" means activation of a PDP context or
EPS PDN connection or PDU session.
The UICC provides to the terminal a list of parameters necessary to activate a
packet data service. The UICC has three ways to indicate to the ME the QoS it
requires:
\- either use a Bearer Description called \"Bearer description for GPRS/UTRAN
Packet Service/E-UTRAN\", which is valid for GPRS, UTRAN packet service and
E-UTRAN
\- or use a Bearer Description called \"Bearer description for UTRAN Packet
Service with extended parameters and HSDPA\" which is valid for a UTRAN packet
service, HSDPA and E-UTRAN.
\- or use a Bearer Description called \"Bearer description for E-UTRAN and
mapped UTRAN packet service\", which is valid for UTRAN packet service and
E-UTRAN.
For NG-RAN, Quality of Service parameters are not applicable
Upon receiving this command, the ME shall decide if it is able to execute the
command.
If the 3GPP PS data off status is \"active\", and the UE is not configured
with indication that Bearer Independent Protocol is a 3GPP PS data off exempt
service (see Annex S), then the ME shall send the TERMINAL RESPONSE (ME
currently unable to process command) immediately. The operation is aborted.
In addition to the examples given in ETSI TS 102 223 [32] clause 6.4.27.2 the
following example applies:
\- if the command is rejected because the ME is busy on an SS transaction and
unable to activate a PDP context in parallel with this SS transaction, the ME
informs the UICC using TERMINAL RESPONSE (ME unable to process command -
currently busy on SS transaction). The operation is aborted.
The \"Bearer description\" provided in the command gives recommended values
for parameters that the ME should use to establish the data link. However if
the ME or network does not support these values, the ME selects the most
appropriate values.
If class \"ai\" is supported, the \"Bearer description\" provided in the
command shall indicate a Non-IP PDP Type in order to establish a Non-IP data
link. The UICC shall provide the Network Access Name data object.
#### 6.4.27.3 OPEN CHANNEL related to local bearer
See ETSI TS 102 223 [32] clause 6.4.27.3.
#### 6.4.27.4 OPEN CHANNEL related to Default (network) Bearer
See ETSI TS 102 223 [32] clause 6.4.27.4.
Additionally, if the 3GPP PS data off status is \"active\", and the UE is not
configured with indication that Bearer Independent Protocol is a 3GPP PS data
off exempt service (see Annex S), then the ME shall send the TERMINAL RESPONSE
(ME currently unable to process command) immediately. The operation is
aborted.
If class \"ai\" is supported, the \"Bearer description\" provided in the
command shall indicate Non-IP PDP Type in order to establish a Non-IP data
link. The UICC shall provide the Network Access Name data object.
#### 6.4.27.5 OPEN CHANNEL related to (I-)WLAN bearer
This clause applies if class \"e\" is supported.
Upon receiving this command, the ME shall decide if it is able to execute the
command. The UICC shall indicate whether the ME should establish the link
immediately, in background mode or upon receiving the first transmitted data
(on demand).
The UICC provides to the ME a list of parameters necessary to activate a
(I-)WLAN service.
The ME shall attempt at least one (I-)WLAN service activation.
Upon receiving this command, the ME shall decide if it is able to execute the
command. Examples are given below, but the list is not exhaustive:
\- if immediate or background (I-)WLAN service activation is requested and the
ME is unable to set-up a channel using the exact parameters provided by the
UICC, the ME sets up the channel according to TS 24.234 [42] for a I-WLAN
service activation or according to TS 24.302 [63] for a WLAN service
activation and informs the UICC of the I-WLAN identifier or the WLAN
identifier respectively and the modified parameters using TERMINAL RESPONSE
(Command performed with modification);
\- if immediate (I-)WLAN service activation is requested and the ME is unable
to activate the I-WLAN service with the network using the exact parameters
provided by the UICC, the ME informs the UICC using TERMINAL RESPONSE (Network
currently unable to process command). The operation is aborted;
\- if background mode (I-)WLAN service activation is requested and the ME is
unable to activate the I-WLAN service with the network using the exact
parameters provided by the UICC, the ME informs the UICC using a channel
status event (link not established - no further info). The operation is
aborted;
\- if the command is rejected because the ME has no channel left with the
requested bearer capabilities, the ME informs the UICC using TERMINAL RESPONSE
(Bearer independent protocol error). The operation is aborted;
\- if the user does not accept the channel set-up, the ME informs the UICC
using TERMINAL RESPONSE (User did not accept the proactive command). The
operation is aborted;
\- if the user has indicated the need to end the proactive UICC session, the
ME informs the UICC using TERMINAL RESPONSE (Proactive UICC session terminated
by the user). The operation is aborted;
\- if background mode (I-)WLAN service activation is requested, the ME
allocates buffers, starts activation of (I-)WLAN service, informs the UICC and
reports the channel identifier immediately using TERMINAL RESPONSE (Command
performed successfully). At the end of activation, the ME shall send a channel
status event (link established or link not established - no further info).
The ME shall inform the UICC that the command has been successfully executed
using TERMINAL RESPONSE:
\- if immediate (I-)WLAN service activation is requested, the ME allocates
buffers, activates the (I-)WLAN service and informs the UICC and reports the
channel identifier using TERMINAL RESPONSE (Command performed successfully);
\- if on demand (I-)WLAN service activation is requested, the ME allocates
buffers, informs the UICC and reports the channel identifier using TERMINAL
RESPONSE (Command performed successfully).
If the ME is able to set up the channel on the serving network, the ME shall
then enter the confirmation phase described hereafter; optionally, the UICC
may include in this command an alpha-identifier. The use of this alpha-
identifier by the ME is described below:
\- if the alpha identifier is provided by the UICC and is not a null data
object, the ME shall use it during the user confirmation phase. This is also
an indication that the ME should not give any other information to the user
during the user confirmation phase. If an icon is provided by the UICC, the
icon indicated in the command may be used by the terminal to inform the user,
in addition to, or instead of the alpha identifier, as indicated with the icon
qualifier (see clause 6.5.4);
\- if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), this is an indication that the ME
should not give any information to the user or ask for user confirmation;
\- if the alpha identifier is not provided by the UICC, the ME may give
information to the user;
A terminal of type ND shall ignore any alpha identifier provided together with
this command. The terminal shall respond with \"command performed
successfully\" upon successful completion of the command. A terminal of type
ND shall also ignore any icon provided together with this command. The
terminal shall respond with \"command performed successfully but requested
icon could not be displayed\" upon successful completion of the command.
\- if the user doesn\'t reject the channel, the ME shall then set up a
channel. A terminal of type NK or type ND may not alert the user and may open
the channel without explicit confirmation by the user;
\- if the user does not accept the channel or rejects the channel, then the ME
informs the UICC using TERMINAL RESPONSE (user did not accept the proactive
command). The operation is aborted;
\- if the user has indicated the need to end the proactive UICC session, the
ME shall send a TERMINAL RESPONSE with (Proactive UICC session terminated by
the user) result value;
\- optionally, during packet data service activation, the ME can give some
audible or display indication concerning what is happening;
\- if the user stops the (I-)WLAN service activation attempt before a result
is received from the network, the ME informs the UICC using TERMINAL RESPONSE
(user cleared down call before connection or network release).
#### 6.4.27.6 OPEN CHANNEL related to Terminal Server Mode
See ETSI TS 102 223 [32] clause 6.4.27.6.
#### 6.4.27.7 OPEN CHANNEL related to UICC Server Mode
See ETSI TS 102 223 [32] clause 6.4.27.5.
#### 6.4.27.8 OPEN CHANNEL for IMS
The following applies if classes \"e\" and \"t\" are supported.
After a successful registration to IMS specified in TS 24.229 [52] and after
the ME has informed the UICC of this successful registration, the UICC may
attempt to open a channel to communicate with the IMS.
The UICC will include in the OPEN CHANNEL for IMS command the IARI
representing an active application installed on the UICC. This IARI shall be
known to the ME and populated in the EF~UICCIARI~ as specified in TS 31.102
[14].
The ME shall encapsulate all subsequent SIP _communications intended for the
IMS application running on the UICC_. The ME shall decapsulate all subsequent
message _s received from the IMS application running on the UICC_. Once the
_application is no longer available for SIP communications_ the UICC shall
send the CLOSE CHANNEL command for the current channel ID.
If network conditions changed after a successful IMS registration, upon
receiving this command, the ME shall decide if it is able to execute the
command. If the ME is unable to process the command (the list is not
exhaustive)
\- if the command is unable to proceed due to the absence of an active IMS
PDP/PDN context, the ME shall inform the UICC using the TERMINAL RESPONSE
(network currently unable to process command) upon receipt of this failure
cause, the UICC shall wait until the next IMS registration event before
sending another OPEN CHANNEL for IMS command to the ME.
\- if the command is unable to proceed due to the inability to contact IMS,
the ME shall inform the UICC using the TERMINAL RESPONSE (network currently
unable to process command) upon receipt of this failure cause, the UICC shall
wait until the next IMS registration event before sending another OPEN CHANNEL
for IMS command to the ME.
\- If the command is unable to proceed because there is no channel available,
the ME shall inform the UICC using the TERMINAL RESPONSE (Bearer Independent
Protocol error - no channel available).
The ME shall inform the UICC that the command has been successfully executed
using TERMINAL RESPONSE (Command performed successfully)
### 6.4.28 CLOSE CHANNEL
ETSI TS 102 223 [32] clause 6.4.28 applies, with the following addition.
In case of OPEN CHANNEL for IMS, the UICC shall send a CLOSE CHANNEL command
to close the BIP channel at the end of the SIP dialog.
### 6.4.29 RECEIVE DATA
See ETSI TS 102 223 [32] clause 6.4.29.
### 6.4.30 SEND DATA
See ETSI TS 102 223 [32] clause 6.4.30.
### 6.4.31 GET CHANNEL STATUS
See ETSI TS 102 223 [32] clause 6.4.31.
### 6.4.32 SERVICE SEARCH
See ETSI TS 102 223 [32] clause 6.4.32.
### 6.4.33 GET SERVICE INFORMATION
See ETSI TS 102 223 [32] clause 6.4.33.
### 6.4.34 DECLARE SERVICE
See ETSI TS 102 223 [32] clause 6.4.34.
### 6.4.35 RETRIEVE MULTIMEDIA MESSAGE
See ETSI TS 102 223 [32] clause 6.4.37.
### 6.4.36 SUBMIT MULTIMEDIA MESSAGE
See ETSI TS 102 223 [32] clause 6.4.38.
### 6.4.37 DISPLAY MULTIMEDIA MESSAGE
See ETSI TS 102 223 [32] clause 6.4.39.
### 6.4.38 SET FRAMES
See ETSI TS 102 223 [32] clause 6.4.35.
### 6.4.39 GET FRAME STATUS
See ETSI TS 102 223 [32] clause 6.4.36.
### 6.4.40 Geographical Location Request
This clause applies if class \"n\" is supported.
This command requests an ME that is equipped with a positioning feature to
report the location information of the ME within a specified quality of
service.
As the determination of the geographical location information may take some
time, the geographical location information report is sent by the ME to the
UICC using the command ENVELOPE (Geographical Location Reporting). The ME
reporting can be performed either in the format of GAD shapes defined in TS
23.032 [44] or in the format of NMEA sentences defined in IEC 61162-1 [45].
The horizontal coordinates represent the minimum set of information to be sent
to the UICC (i.e. latitude and longitude). The UICC may request additional
geographical location information (i.e. vertical coordinate and velocity). The
UICC may request a preferred quality of service (e.g. preferred accuracy,
preferred maximum response time). However if the ME does not support the
requested preferred parameters, the ME selects the most appropriate quality of
service parameters.
Upon receiving this command, the ME shall decide if it is able to execute the
command. Examples are given below, but the list is not exhaustive:
\- if the command is rejected because the ME is not equipped with a
positioning feature, the ME informs the UICC using TERMINAL RESPONSE (Command
beyond ME\'s capabilities);
\- if the command is rejected because the ME is currently unable to get the
location information (e.g. due to lack of GPS coverage or due to a deactivated
GPS receiver), the ME shall inform the UICC using TERMINAL RESPONSE (ME
currently unable to process command);
If the ME is able to attempt to retrieve the geographical location
information, the ME shall:
\- inform the UICC that the command has been successfully executed, using
TERMINAL RESPONSE.
> \- once the requested location information is available, the ME shall send
> this information to the UICC using the command ENVELOPE (Geographical
> Location Reporting).
\- optionally, the UICC may include in this command an alpha-identifier. The
use of this alpha-identifier by the ME is described below:
\- if the alpha identifier is provided by the UICC and is not a null data
object, the ME shall use it to inform the user. This is also an indication
that the ME should not give any other information to the user on the fact that
the ME is processing the location information request for the UICC. If an icon
is provided by the UICC, the icon indicated in the command may be used by the
ME to inform the user, in addition to, or instead of the alpha identifier, as
indicated with the icon qualifier (see clause 6.5.4);
\- if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), this is an indication that the ME
should not give any information to the user on the fact that the ME is
determining the location information for the UICC;
> A terminal of type ND shall ignore any alpha identifier provided together
> with this command. The terminal shall respond with \"command performed
> successfully\" upon successful completion of the command. A terminal of type
> ND shall also ignore any icon provided together with this command. The
> terminal shall respond with \"command performed successfully but requested
> icon could not be displayed\" upon successful completion of the command.
>
> \- if the alpha identifier is not provided by the UICC, the ME may give
> information to the user concerning what is happening.
If the ME receives a \"Geographical Location Request\" command during the
processing of a previous \"Geographical Location Request\" command (i.e. after
the reception of a location request and before sending the \"Geographical
Location Reporting\" ENVELOPE command), the latest location request shall be
ignored.
### 6.4.41 ACTIVATE
Not required by 3GPP.
### 6.4.42 CONTACTLESS STATE CHANGED
Not required by 3GPP.
### 6.4.43 COMMAND CONTAINER
Not required by 3GPP.
### 6.4.44 ENCAPSULATED SESSION CONTROL
Not required by 3GPP.
## 6.5 Common elements in proactive UICC commands
See ETSI TS 102 223 [32] clause 6.5.
### 6.5.1 Command number
See ETSI TS 102 223 [32] clause 6.5.1.
### 6.5.2 Device identities
See ETSI TS 102 223 [32] clause 6.5.2.
### 6.5.3 Alpha identifier
See ETSI TS 102 223 [32] clause 6.5.3.
### 6.5.4 Icon identifiers
The display of icons is optional for the terminal on a per command basis, see
ETSI TS 102 223 [32] clause 6.5.4.
### 6.5.5 Text attribute
See ETSI TS 102 223 [32] clause 6.5.5.
### 6.5.6 Frame identifier
See ETSI TS 102 223 [32] clause 6.5.6.
## 6.6 Structure of proactive UICC commands
The general structure of proactive UICC commands using TLV objects is
described in annex C.
### 6.6.1 DISPLAY TEXT
See ETSI TS 102 223 [32] clause 6.6.1.
### 6.6.2 GET INKEY
See ETSI TS 102 223 [32] clause 6.6.2.
### 6.6.3 GET INPUT
See ETSI TS 102 223 [32] clause 6.6.3.
### 6.6.4 MORE TIME
See ETSI TS 102 223 [32] clause 6.6.4.
### 6.6.5 PLAY TONE
See ETSI TS 102 223 [32] clause 6.6.5.
### 6.6.6 POLL INTERVAL
See ETSI TS 102 223 [32] clause 6.6.6.
### 6.6.7 SET-UP MENU
See ETSI TS 102 223 [32] clause 6.6.7.
### 6.6.8 SELECT ITEM
See ETSI TS 102 223 [32] clause 6.6.8.
### 6.6.9 SEND SHORT MESSAGE
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C+D+E+F+G+H) - M Y 1 or 2 Command details 8.6 M Y A Device
identities 8.7 M Y B Alpha identifier 8.2 O N C Address data object 1 8.1 or
8.108 O N D SMS TPDU (SMS-SUBMIT or SMS-COMMAND) 8.13 M Y E Icon identifier
8.31 O N F Text attribute 8.70 C N G Frame Identifier 8.82 O N H Address data
object 2 8.108 C N I
* * *
The address data object holds the RP_Destination_Address of the Service
Centre. If no RP_Destination_Address is transferred, then the ME shall insert
the default Service Centre address.
The address data object 1 may optionally hold the Public Service Identity of
the SM-SC in URI format that the ME shall use to submit the SMS over IP as
defined in 3GPP TS 24.341 [65].
In case Address data object 1 holds a Public Service Identity, the address
data object 2 shall be present and holds the URI of the receiver of the short
message. If the address data object 2 is present, the ME shall use the address
data object 2 to submit the SMS over IP as defined in 3GPP TS 24.341 [65]
clause 5.3.1.4.2.
When Address data object 2 is present, the UICC shall set the
TP_Destination_Address field in the SMS TPDU to the dummy MSISDN value as
specified in 24.341 [65].
The Text attribute applies to the Alpha Identifier. It may be present only if
the Alpha Identifier is present.
### 6.6.10 SEND SS
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C+D+E+F+G) - M Y 1 or 2 Command details 8.6 M Y A Device
identities 8.7 M Y B Alpha identifier 8.2 O N C SS string 8.14 M Y D Icon
identifier 8.31 O N E Text attribute 8.70 C N F Frame Identifier 8.82 O N G
* * *
The Text attribute applies to the Alpha Identifier. It may be present only if
the Alpha Identifier is present.
### 6.6.11 SEND USSD
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C+D+E+F+G) - M Y 1 or 2 Command details 8.6 M Y A Device
identities 8.7 M Y B Alpha identifier 8.2 O N C USSD String 8.17 M Y D Icon
identifier 8.31 O N E Text attribute 8.70 C N F Frame Identifier 8.82 O N G
* * *
The Text attribute applies to the Alpha Identifier. It may be present only if
the Alpha Identifier is present.
### 6.6.12 SET UP CALL
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C+D+E+F+G+H+I+J+K+L+M+N) - M Y 1 or 2 Command details 8.6 M Y A
Device identities 8.7 M Y B Alpha identifier (user confirmation phase) 8.2 O N
C Address or IMS URI 8.1 or 8.108 M Y D Capability configuration parameters
8.4 O N E Subaddress 8.3 O N F Duration 8.8 O N G Icon identifier (user
confirmation phase) 8.31 O N H Alpha identifier (call set up phase) 8.2 O N I
Icon identifier (call set up phase) 8.31 O N J Text Attribute (user
confirmation phase) 8.72 C N K Text Attribute (call set up phase) 8.72 C N L
Frame Identifier 8.80 O N M Media Type 8.132 O N N
* * *
If the capability configuration parameters are not present, the ME shall
assume the call is a speech call.
If the subaddress is not present, the ME shall not provide a called party
subaddress to the network.
If the duration is not present, the UICC imposes no restrictions on the ME of
the maximum duration of redials.
The Text Attribute (user confirmation phase) applies to the Alpha Identifier
(user confirmation phase). The Text Attribute (call set up phase) applies to
the Alpha identifier (call set up call phase). One Text Attribute may be
present only if at least one Alpha Identifier is present. Both Text Attributes
may be present only if both Alpha Identifiers are present. If only one Text
Attribute data object is present, it shall apply to the first or unique Alpha
identifier present in the command.
The IMS URI data object holds the SIP URI or tel URI, as defined in TS 24.229
[52], of the called party (if class \"ae\" is supported).
When the Media Type data object is present, it indicates the type of media the
ME shall use, if supported by the ME to set up the communication. If the ME is
unable to set up the call as requested, it shall return an error code
reflecting the cause of the error. For example, in case of failure due to
network constraints, the error code \"Access Technology unable to process
command\" shall be used.
### 6.6.13 REFRESH
For all REFRESH modes except \"Steering of Roaming\", see ETSI TS 102 223 [32]
clause 6.6.13.
For \"Steering of Roaming\":
+----------------------+--------+----------------+-----+--------+ | Description | Clause | M/O/C | Min | Length | +----------------------+--------+----------------+-----+--------+ | Proactive UICC | 9.2 | M | Y | 1 | | command Tag | | | | | +----------------------+--------+----------------+-----+--------+ | Length | - | M | Y | 1 or 2 | | (A+B+C+D+E+F+G+H) | | | | | +----------------------+--------+----------------+-----+--------+ | Command details | 8.6 | M | Y | A | +----------------------+--------+----------------+-----+--------+ | Device identities | 8.7 | M | Y | B | +----------------------+--------+----------------+-----+--------+ | Alpha identifier | 8.2 | O | N | C | +----------------------+--------+----------------+-----+--------+ | Icon identifier | 8.31 | O | N | D | +----------------------+--------+----------------+-----+--------+ | Text Attribute | 8.70 | C | N | E | +----------------------+--------+----------------+-----+--------+ | Frame Identifier | 8.82 | O | N | F | +----------------------+--------+----------------+-----+--------+ | PLMNwAcT List | 8.90 | C (see Note 1) | N | G | +----------------------+--------+----------------+-----+--------+ | PLMN List | 8.97 | C (see Note 2) | N | H | +----------------------+--------+----------------+-----+--------+ | Note 1: This | | | | | | parameter is | | | | | | required in case of | | | | | | steering of roaming | | | | | | (according to | | | | | | TS 23.122 [7]). | | | | | | | | | | | | Note 2: This | | | | | | parameter is | | | | | | required in case of | | | | | | steering of roaming | | | | | | for I-WLAN | | | | | | (according to | | | | | | TS 24.234 [42]). | | | | | +----------------------+--------+----------------+-----+--------+
The Text attribute applies to the Alpha Identifier. It may be present only if
the Alpha Identifier is present.
### 6.6.14 POLLING OFF
See ETSI TS 102 223 [32] clause 6.6.14.
### 6.6.15 PROVIDE LOCAL INFORMATION
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C) - M Y 1 or 2 Command details 8.6 M Y A Device Identities 8.7 M
Y B UTRAN/E-UTRAN Measurement Qualifier 8.73 C N C
* * *
UTRAN/E-UTRAN Measurement Qualifier: This data object applies when the Command
Qualifier in Command details is set to indicate \"Network Measurement
results\". It shall be included to indicate to the ME that \"Network
Measurement Results for a UTRAN\" or \"Network Measurement Results for a
E-UTRAN\" is required. It shall be excluded to indicate to the ME that
\"Network Measurement Results for a GERAN\" is required. It shall only be
included/excluded if the ME has indicated that it supports the implied access
technology via the respective Terminal Profile setting.
### 6.6.16 SET UP EVENT LIST
See ETSI TS 102 223 [32] clause 6.6.16.
### 6.6.17 PERFORM CARD APDU
See ETSI TS 102 223 [32] clause 6.6.17.
### 6.6.18 POWER OFF CARD
See ETSI TS 102 223 [32] clause 6.6.18.
### 6.6.19 POWER ON CARD
See ETSI TS 102 223 [32] clause 6.6.19.
### 6.6.20 GET READER STATUS
See ETSI TS 102 223 [32] clause 6.6.20.
### 6.6.21 TIMER MANAGEMENT
See ETSI TS 102 223 [32] clause 6.6.21.
### 6.6.22 SET UP IDLE MODE TEXT
See ETSI TS 102 223 [32] clause 6.6.22.
### 6.6.23 RUN AT COMMAND
See ETSI TS 102 223 [32] clause 6.6.23.
### 6.6.24 SEND DTMF COMMAND
See ETSI TS 102 223 [32] clause 6.6.24.
### 6.6.25 LANGUAGE NOTIFICATION
See ETSI TS 102 223 [32] clause 6.6.25.
### 6.6.26 LAUNCH BROWSER
See ETSI TS 102 223 [32] clause 6.6.26.
### 6.6.27 OPEN CHANNEL
The structure of the OPEN CHANNEL command is defined in ETSI TS 102 223 [32]
clause 6.6.27. , with the addition of the following:
#### 6.6.27.1 OPEN CHANNEL related to (I-)WLAN Bearer
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C+D+E+F+G+H+I+J+K+L) - M Y 1 or 2 Command details 8.6 M Y A Device
identities 8.7 M Y B Alpha identifier 8.2 O N C Icon identifier 8.31 O N D
Bearer description 8.52 M Y E Buffer size 8.55 M Y F I-WLAN Identifier 8.83 O
N G Other address (local address) 8.58 O N H UICC/terminal interface transport
level 8.59 O N I Data destination address 8.58 C Y J Text Attribute 8.72 C N K
Frame Identifier 8.82 O N L
* * *
When OPEN CHANNEL is related to I-WLAN bearer:
\- The I-WLAN Identifier may be requested.
\- If the parameter is not present, the ME shall select the I-WLAN according
to TS 24.234 [42] using the Automatic PLMN Selection Mode Procedure.
When OPEN CHANNEL is related to WLAN bearer, the ME shall select the WLAN
according to TS 24.302 [63] using the automatic mode WLAN selection procedure
and ignore the I-WLAN Identifier, if provided.
The local address parameter provides information to the ME necessary to
identify the local device. If the parameter is present and length is not null,
it provides an IP address that identifies the USAT application in the address
area applicable to the PDN. If local address length is null, dynamic local
address allocation is required for the USAT application. If parameter is not
present, the ME may use the ME default local address configuration.
If the UICC/ME interface transport level is present in the command, then the
ME shall provide the requested transport layer protocols under the channel and
shall use this object containing a set of parameters required to make the
transport connection. The data that is exchanged at the UICC/ME interface in
the RECEIVE DATA/SEND DATA commands are SDUs. When the USAT application sends
an SDU, the transport layer within the ME is in charge to add the transport
header to the SDU in order to build the Transport-PDU. When the USAT
application requests to receive an SDU, the transport layer within the ME is
in charge to remove the transport header of the Transport-PDU, and to forward
the SDU to the USAT. If the parameter is not present, the UICC/ME interface is
the bearer level (serial link or packet link), and the USAT application is in
charge of the network and transport layer.
The Data destination address is the end point destination address of sent
data. This data destination address is requested when a UICC/ME interface
transport is present, otherwise it is ignored. The data destination address is
a data network address (e.g. IP address).
Text Attribute applies to the Alpha Identifier. It may be present only if the
Alpha Identifier is present.
#### 6.6.27.2 OPEN CHANNEL for IMS
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C+D) - M Y 1 or 2 Command details 8.6 M Y A Device identities 8.7
M Y B Buffer size 8.55 M Y C IARI 8.110 M Y D
* * *
### 6.6.28 CLOSE CHANNEL
See ETSI TS 102 223 [32] clause 6.6.28.
### 6.6.29 RECEIVE DATA
See ETSI TS 102 223 [32] clause 6.6.29.
### 6.6.30 SEND DATA
See ETSI TS 102 223 [32] clause 6.6.30.
### 6.6.31 GET CHANNEL STATUS
See ETSI TS 102 223 [32] clause 6.6.31.
### 6.6.32 SERVICE SEARCH
See ETSI TS 102 223 [32] clause 6.6.32.
### 6.6.33 GET SERVICE INFORMATION
See ETSI TS 102 223 [32] clause 6.6.33.
### 6.6.34 DECLARE SERVICE
See ETSI TS 102 223 [32] clause 6.6.34.
### 6.6.35 RETRIEVE MULTIMEDIA MESSAGE
See ETSI TS 102 223 [32] clause 6.6.37.
### 6.6.36 SUBMIT MULTIMEDIA MESSAGE
See ETSI TS 102 223 [32] clause 6.6.38.
### 6.6.37 DISPLAY MULTIMEDIA MESSAGE
See ETSI TS 102 223 [32] clause 6.6.39.
### 6.6.38 SET FRAMES
See ETSI TS 102 223 [32] clause 6.6.35.
### 6.6.39 GET FRAMES STATUS
See ETSI TS 102 223 [32] clause 6.6.36.
### 6.6.40 Geographical Location Request
* * *
Description Clause M/O/C Min Length Proactive UICC command Tag 9.2 M Y 1
Length (A+B+C+D+E) - M Y 1 or 2 Command details 8.6 M Y A Device Identities
8.7 M Y B Alpha identifier 8.2 O N C Icon identifier 8.31 O N D Geographical
Location Parameters 8.94 M N E
* * *
### 6.6.41 ACTIVATE
Not required by 3GPP.
### 6.6.42 CONTACTLESS STATE CHANGED
Not required by 3GPP.
### 6.6.43 COMMAND CONTAINER
Not required by 3GPP.
### 6.6.44 ENCAPSULATED SESSION CONTROL
Not required by 3GPP.
## 6.7 Command results
Once the ME has made its attempt to execute a proactive command from the UICC,
the ME shall inform the UICC of the success or otherwise of that command, by
using TERMINAL RESPONSE.
This procedure is defined in ETSI TS 102 223 [32] clause 6.7, and applies here
except for the following statements.
Temporary problems are defined as:
\- ME is currently unable to process the command. Specific causes for this are
listed in ETSI TS 102 223 [32] clause 6.7; in addition to these, the following
causes may be returned within the USAT context:
\- ME currently busy on SS transaction;
\- ME currently busy on USSD operation;
\- access control class barred on serving network;
\- if none of these can be made to apply, a \"no cause can be given\" value
can be used;
\- network is currently unable to process the command. Within the USAT
context, specific cause values are the cause values given by the network, as
defined in TS 24.008 [9];
\- in some proactive commands, the ME is required to solicit and receive
approval of the user before executing the proactive command. In the case that
the user does not give approval for the execution of the proactive command, it
shall not be executed by the ME and the terminal response \"user did not
accept the proactive command\" shall be returned by the ME to the UICC;
\- the user cleared down the call, before the call connected (CONNECT received
from network, as defined in TS 24.008 [9]) or before the network released the
call;
\- action in contradiction with the current timer state. This is where the
UICC requests an action for a timer to be taken by the ME and the state of the
timer does not allow that action;
\- interaction with call control by USIM, temporary problem. This is sent by
the ME to indicate that call control modified the type of request indicated in
the proactive command, and that the action requested by call control
encounters a temporary problem.
Permanent problems are defined as in ETSI TS 102 223 [32] clause 6.7, with the
addition of:
\- SS Return Error. This is given to the UICC when the network returns a SS
error in response to a previous SS command. Specific cause values are the same
as given by the network in the Return Error message;
\- USSD Return Error. This is given to the UICC when the network returns a
USSD error in response to a previous USSD command. Specific cause values are
the same as given by the network in a Return Error message;
\- SMS RP-ERROR. This is given to the UICC when the network returns an error
in response to the ME trying to send a short message. Specific cause values
are the same as the cause value of RP‑Cause in an RP-ERROR message;
\- interaction with MO short message control by USIM, permanent problem. This
is sent by the ME to indicate that:
MO short message control by USIM does not allow the action corresponding to
the proactive command; or
MO short message control by USIM has modified the type of request indicated in
the proactive command and that the action requested by call control encounters
a permanent problem.
## 6.8 Structure of TERMINAL RESPONSE
### 6.8.0 Overall structure of TERMINAL RESPONSE
Direction: ME to UICC.
The command header is specified in TS 31.101 [13]. Length (A+B+ ... +AA) is
indicated by P3 of the header.
Command parameters/data.
+-----------------+-----------------+-------+-----+-----------------+ | Description | Clause | M/O/C | Min | Length | +-----------------+-----------------+-------+-----+-----------------+ | Command details | 8.6 | M | Y | A | +-----------------+-----------------+-------+-----+-----------------+ | Device | 8.7 | M | N | B | | identities | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Result | 8.12 | M | Y | C | +-----------------+-----------------+-------+-----+-----------------+ | Duration (only | 8.8 | C | N | D | | required in | | | | | | response to a | | | | | | POLL INTERVAL | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Text string | 8.15 | C | N | E | | (only required | | | | | | in response to | | | | | | a GET INKEY or | | | | | | GET INPUT or | | | | | | SEND USSD | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Item identifier | 8.10 | C | N | F | | (only required | | | | | | in response to | | | | | | SELECT ITEM | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Local | 8.19, 8.20, | C | N | G | | information | 8.29, 8.39, | | | | | (only required | 8.45, 8.46, | | | | | in response to | 8.62, 8.83, | | | | | PROVIDE LOCAL | 8.85, 8.86, | | | | | INFORMATION | 8.87, 8.100, | | | | | proactive | 8.129, 8.130, | | | | | command) | 8.131, 8.134, | | | | | | | | | | | | 8.140, 8.141 | | | | +-----------------+-----------------+-------+-----+-----------------+ | Local | 8.22, 8.119 | C | N | AB or | | information | | | | | | (only required | | | | AB~0~ + ... + | | in response to | | | | AB~n~ | | PROVIDE LOCAL | | | | | | INFORMATION | | | | | | (Network | | | | | | Measurement | | | | | | Results) | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Local | 8.58 | C | N | AC or | | information | | | | | | (only required | | | | AC~0~ + ... + | | in response to | | | | AC~n~ | | PROVIDE LOCAL | | | | | | INFORMATION | | | | | | (H(e)NB IP | | | | | | address | | | | | | request) | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Local | 8.19, 8.62 | C | N | AD or | | information | | | | | | (only required | | | | AD~0~ + ... + | | in response to | | | | AD~n~ | | PROVIDE LOCAL | | | | | | INFORMATION | | | | | | (list of | | | | | | surrounding | | | | | | macrocells) | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Call control | 8.30 | C | N | H | | requested | | | | | | action (only | | | | | | required if | | | | | | call control by | | | | | | USIM has | | | | | | modified a | | | | | | proactive | | | | | | command SET UP | | | | | | CALL, SEND SS | | | | | | or SEND USSD in | | | | | | another type of | | | | | | request). | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Result data | 8.12 | C | N | I | | object 2 (only | | | | | | required if | | | | | | call control by | | | | | | USIM has | | | | | | modified a | | | | | | proactive | | | | | | command SET UP | | | | | | CALL, SEND SS | | | | | | or SEND USSD in | | | | | | another type of | | | | | | request). | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Card reader | 8.33, 8.57 | C | N | J~0~ + ... + | | status (only | | | | J~n~ | | required in | | | | | | response to GET | | | | or J | | READER STATUS | | | | | | command). | | | | | | According to | | | | | | the requested | | | | | | information, | | | | | | one Card reader | | | | | | status object | | | | | | for each card | | | | | | interface | | | | | | reported, or | | | | | | one Card reader | | | | | | identifier | | | | | | object is | | | | | | required.. | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Card ATR (only | 8.34 | C | N | K | | required in | | | | | | response to | | | | | | POWER ON CARD). | | | | | +-----------------+-----------------+-------+-----+-----------------+ | R-APDU (only | 8.36 | C | N | L | | required in | | | | | | response to | | | | | | PERFORM CARD | | | | | | APDU). | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Timer | 8.37 | C | N | M | | identifier | | | | | | (only required | | | | | | in response to | | | | | | a TIMER | | | | | | MANAGEMENT | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Timer value | 8.38 | C | N | N | | (only required | | | | | | in response to | | | | | | a TIMER | | | | | | MANAGEMENT | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | AT Response | 8.41 | C | N | P | | (only required | | | | | | in response to | | | | | | RUN AT COMMAND | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Text string2 | 8.15 | C | N | Q | | (only required | | | | | | if call control | | | | | | by USIM has | | | | | | modified the | | | | | | proactive | | | | | | command SET UP | | | | | | CALL or SEND SS | | | | | | into a USSD | | | | | | request) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Channel data | 8.53 | C | N | R | | (only required | | | | | | in response to | | | | | | RECEIVE DATA) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Channel status | 8.56 | C | N | S~0~ + ... + | | (only required | | | | S~n~ | | in response to | | | | | | GET CHANNEL | | | | | | STATUS or OPEN | | | | | | CHANNEL | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Channel data | 8.54 | C | N | T | | length (only | | | | | | required in | | | | | | response to | | | | | | RECEIVE DATA or | | | | | | SEND DATA | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Bearer | 8.52 | C | N | U | | description | | | | | | (only required | | | | | | in response to | | | | | | OPEN CHANNEL | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Buffer size | 8.55 | C | N | V | | (only required | | | | | | in response to | | | | | | OPEN CHANNEL | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Total display | 8.8 | C | N | W | | duration (only | | | | | | required in | | | | | | response to a | | | | | | GET INKEY | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Service | 8.68 | C | N | X | | availability | | | | | | (only required | | | | | | in response to | | | | | | SERVICE SEARCH | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Service record | 8.64 | C | N | Y | | (only required | | | | | | in response to | | | | | | GET SERVICE | | | | | | INFORMATION | | | | | | proactive | | | | | | command) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Other address | 8.58 | C | N | Z | | (local address) | | | | | | (only required | | | | | | in response to | | | | | | OPEN CHANNEL | | | | | | proactive | | | | | | command with | | | | | | dynamic local | | | | | | address | | | | | | request) | | | | | +-----------------+-----------------+-------+-----+-----------------+ | Frames | 8.81 | C | N | AA | | Information | | | | | | (only required | | | | | | in response to | | | | | | SET FRAMES or | | | | | | GET FRAMES | | | | | | STATUS | | | | | | proactive | | | | | | commands) | | | | | +-----------------+-----------------+-------+-----+-----------------+
Specific rules apply for the coding of the TERMINAL RESPONSE, see ETSI TS 102
223 [32] clause 6.8.
Response parameters/data: None.
### 6.8.1 Command details
See ETSI TS 102 223 [32] clause 6.8.1.
### 6.8.2 Device identities
See ETSI TS 102 223 [32] clause 6.8.2.
### 6.8.3 Result
See ETSI TS 102 223 [32] clause 6.8.3.
### 6.8.4 Duration
See ETSI TS 102 223 [32] clause 6.8.4.
### 6.8.5 Text string
ETSI TS 102 223 [32] clause 6.8.5 applies, with the addition of the following
procedure.
When the ME issues a successful TERMINAL RESPONSE for a SEND USSD command, it
shall supply the text returned within the Return Result message from the
network, no matter what type of string was returned.
### 6.8.6 Item identifier
See ETSI TS 102 223 [32] clause 6.8.6.
### 6.8.7 Local information
For Local Information values defined in clause 8.6 then ETSI TS 102 223 [32]
clause 6.8.7 applies, with the addition of the following procedures:
\- Where the UICC has requested the Network Measurement Results, the TERMINAL
RESPONSE shall contain
\- for GERAN: The NMR data object and the BCCH channel list data object
\- for UTRAN: The Network Measurement Results are coded as the MEASUREMENT
REPORT message as defined in TS 25.331 [38].
\- for E-UTRAN: The Network Measurement Results are coded as the
_MeasurementReport_ message defined in TS 36.331 [49]
\- Where the UICC has requested the Network Measurement Results for multiple
access technologies, TERMINAL RESPONSE shall contain the Access Technology
data object listing all current access technologies, followed by one NMR data
object and one BCCH channel list data object for each current access
technology in the same sequence. The BCCH channel list data object shall
immediately follow the NMR data object, even if not supported by a network
access technology. If no NMR data or no BCCH channel list is available for an
access technology, the respective data object shall have length zero.
\- Where the UICC has requested the Timing Advance, the TERMINAL RESPONSE
shall contain the Timing Advance data object if supported by the network
access technology.
\- Where the UICC has requested the WLAN Specific Identifier, the TERMINAL
RESPONSE shall contain the WSID of the current I-WLAN connection.
\- Where the UICC has requested the WLAN Identifier, the TERMINAL RESPONSE
shall contain the SSID, the BSSID when available, and the HESSID when
available, of the current WLAN connection.
\- Where the UICC has requested the CSG ID list Identifier, the TERMINAL
RESPONSE shall contain the CSG ID list and the corresponding HNB name (if
available in the broadcasted information to the ME) of the detected CSG or
Hybrid cells in the Allowed CSG list or the Operator CSG list. (if class \"q\"
is supported)
\- Where the UICC has requested the H(e)NB IP address, the TERMINAL RESPONSE
shall contain the list of all IP addresses available on the H(e)NB-network
interface, as a sequence of \"Other Address\" Data Objects in the TERMINAL
RESPONSE. (if class \"v\" is supported)
\- Where the UICC has requested the list of surrounding macrocells, the
TERMINAL RESPONSE shall contain, for all supported access technologies, the
Access Technology data object listing all current access technologies,
followed by one location information data object for each current access
technology in the same sequence, up to the limit of the TERMINAL RESPONSE APDU
command size. If no location information is available for an access
technology, the respective data object shall have length zero. (if class \"w\"
is supported).
### 6.8.8 Call control requested action
When the ME issues a TERMINAL RESPONSE for a proactive command SET UP CALL,
SEND SS or SEND USSD which has been modified by call control by USIM in
another type of request, it shall supply the response data given in response
to the ENVELOPE (CALL CONTROL).
### 6.8.9 Result data object 2
When the ME issues a TERMINAL RESPONSE for a proactive command SET UP CALL,
SEND SS or SEND USSD which has been modified by call control by USIM in
another type of request, it shall supply the Result data object it would have
supplied for the proactive command equivalent to the action requested by call
control, and given in the Call control request data element.
### 6.8.10 Card reader status
See ETSI TS 102 223 [32] clause 6.8.10.
### 6.8.11 Card ATR
See ETSI TS 102 223 [32] clause 6.8.11.
### 6.8.12 R-APDU
See ETSI TS 102 223 [32] clause 6.8.12.
### 6.8.13 Timer identifier
See ETSI TS 102 223 [32] clause 6.8.13.
### 6.8.14 Timer value
See ETSI TS 102 223 [32] clause 6.8.14.
### 6.8.15 AT Response
See ETSI TS 102 223 [32] clause 6.8.15.
### 6.8.16 Text string 2
When the ME issues a successful TERMINAL RESPONSE for a proactive command SET
UP CALL or SEND SS which has been modified by \"call control\" by USIM into a
USSD request (\'05\' result value), it shall supply the Text string 2. The
Text string 2 shall contain the text returned within the Return Result message
from the network for the USSD response. Text string 2 is equivalent to the
Text string in the Terminal Response to a SEND USSD command.
### 6.8.17 Channel data
See ETSI TS 102 223 [32] clause 6.8.17.
### 6.8.18 Channel status
See ETSI TS 102 223 [32] clause 6.8.18.
### 6.8.19 Channel data length
See ETSI TS 102 223 [32] clause 6.8.19.
### 6.8.20 Bearer description
See ETSI TS 102 223 [32] clause 6.8.20.
### 6.8.21 Buffer size
See ETSI TS 102 223 [32] clause 6.8.21.
### 6.8.22 Total Display Duration
See ETSI TS 102 223 [32] clause 6.8.22.
### 6.8.23 Service Availability
See ETSI TS 102 223 [32] clause 6.8.23.
### 6.8.24 Service Record
See ETSI TS 102 223 [32] clause 6.8.24.
### 6.8.25 Other address (local address)
See ETSI TS 102 223 [32] clause 6.8.25.
### 6.8.26 Frames Information
See ETSI TS 102 223 [32] clause 6.8.26.
## 6.9 Proactive UICC session and ME display interaction
See ETSI TS 102 223 [32] clause 6.9.
## 6.10 Handling of unknown, unforeseen and erroneous messages
See ETSI TS 102 223 [32] clause 6.10.
## 6.11 Proactive commands versus possible Terminal response
Table 6.1 shows for each proactive command the possible terminal response
returned (marked by a \"•\" character), in addition to those defined in ETSI
TS 102 223 [32] clause 6.11.
The commands \"COMMAND CONTAINER\" and \"ENCAPSULATED SESSION CONTROL\" listed
in ETSI TS 102 223 [32] are not required by 3GPP.
Table 6.1: Proactive commands versus possible terminal response
* * *
                                                                                                           PROACTIVE COMMAND                                                       
                                                                                   SET UP CALL   SEND SS   SEND USSD           SEND SMS   Geographical Location Request            
       TERMINAL RESPONSE                                                           \'10\'        \'11\'    \'12\'              \'13\'     \'16\'
00 Command performed successfully • • • • •  
01 Command performed with partial comprehension • • • • •  
02 Command performed, with missing information • • • • •  
03 REFRESH performed with additional Efs read  
04 Command performed successfully, but requested icon could not be displayed •
• • • •  
05 Command performed, but modified by call control by USIM • •  
06 Command performed successfully, limited service  
07 Command performed with modification  
08 REFRESH performed but indicated USIM was not active  
09 Command performed successfully, tone not played  
10 Proactive UICC session terminated by the user •  
11 Backward move in the proactive UICC session requested by the user  
12 No response from user •  
13 Help information required by the user  
14 USSD or SS Transaction terminated by user • • •  
15 Reserved for 3GPP (for future usage)  
16 Reserved for 3GPP (for future usage)  
20 ME currently unable to process command • • • • •  
21 Network currently unable to process command • • • • •  
22 User did not accept the proactive command • •  
23 User cleared down call before connection or network release •  
24 Action in contradiction with the current timer state  
25 Interaction with call control by USIM, temporary problem • • •  
26 Launch browser generic error  
27 MMS Temporary Problem  
28 Reserved for 3GPP (for future usage)  
29 Reserved for 3GPP (for future usage)  
30 Command beyond Mes capabilities • • • • •  
31 Command type not understood by ME • • • • •  
32 Command data not understood by ME • • • • •  
33 Command number not known by ME • • • • •  
34 SS Return Error • •  
35 SMS RPERROR •  
36 Error, required values are missing • • • • •  
37 USSD return error •  
38 Multiple Card command error  
39 Interaction with call/SM control by USIM, permanent problem • • • •  
3A Bearer Independent Protocol error  
3B Access Technology unable to process command  
3C Frames error • • • •  
3D MMS Error  
3E Reserved for 3GPP (for future usage)  
3F Reserved for 3GPP (for future usage)
* * *
# 7 ENVELOPE Commands
## 7.1 Data download to UICC
### 7.1.1 SMS-PP data download
#### 7.1.1.1 Procedure
If the service \"data download via SMS Point-to-point\" is allocated and
activated in the USIM Service Table (see TS 31.102 [14]), then the ME shall
follow the procedure below:
\- when the ME receives a Short Message with:
protocol identifier = SIM data download; and
data coding scheme = class 2 message; or
\- when the ME receives a Short Message with:
protocol identifier=ANSI-136 R-DATA (see TS 23.040 [5]); and
data coding scheme = class 2 message, and the ME chooses not to handle the
message (e.g. Mes not supporting EGPRS over TIA/EIA-136 do not need to handle
the message).
\- then the ME shall pass the message transparently to the UICC using the
ENVELOPE (SMS-PP DOWNLOAD) command as defined below;
\- the ME shall not display the message, or alert the user of a short message
waiting;
\- the ME shall wait for an acknowledgement from the UICC;
\- When receiving a secured Command Packet (as specified in TS 31.115 [41])
requesting a Proof of Receipt (PoR), the UICC shall verify the authenticity of
the sender. If the authentication of the sender fails, no further processing
related to the Proof of Receipt shall take place.
\- if the UICC responds with \'90 00\' or \'6F XX\' or \'62 XX\' or \'63 XX\',
the ME shall acknowledge the receipt of the short message to the network using
an RP-ACKmessage. The response data from the UICC will be supplied by the ME
in the TP-User-Data element of the RP-ACK message it will send back to the
network (see TS 23.040 [5] and TS 24.011 [10]). The values of protocol
identifier and data coding scheme in RP-ACK shall be as in the original
message;
\- if the UICC responds with \'93 00\', the ME shall either retry the command
or send back an RP-ERROR message to the network with the TP-FCS value
indicating \'SIM Application Toolkit Busy\' (see TS 23.040 [5]).
If the service \"data download via SMS-PP\" is not available in the USIM
Service Table, and the ME receives a Short Message with the protocol
identifier = SIM data download and data coding scheme = class 2 message, then
the ME shall store the message in EFSMS in accordance with TS 31.102 [14].
#### 7.1.1.1a Procedure for SMS-PP data download via REGISTRATION ACCEPT or DL
NAS TRANSPORT messages
If the service \"data download via SMS Point-to-point\" is allocated and
activated in the USIM Service Table (see 3GPP TS 31.102 [14]), then the ME
shall follow the procedure below:
\- when the ME receives a:
\- REGISTRATION ACCEPT message or a DL NAS TRANSPORT message that includes an
SOR transparent container information element with list type with value \"0\"=
secure packet; or
\- DL NAS TRANSPORT message that includes a UE parameters update transparent
container containing a UE parameters update data set with UE parameters update
data set type with value \"1\"=Routing Indicator update data
\- containing a secured packet constructed as a single SMS-Deliver TPDU or
concatenation of several SMS-Deliver TPDUs (as specified in 3GPP TS 23.040
[5]) with:
protocol identifier = SIM data download; and
data coding scheme = class 2 message
\- and the integrity check of the message was successful
\- then the ME shall pass the message(s) transparently to the UICC using the
ENVELOPE (SMS-PP DOWNLOAD) command as defined in clause 7.1.1.2;
\- the ME shall not display or alert the user
\- the secure packet is coded as a Command Packet formatted as Short Message
Point to Point (as specified in 3GPP TS 31.115 [41]))
NOTE: The command packet should not request a Proof of Receipt (PoR).
#### 7.1.1.2 Structure of ENVELOPE (SMS-PP DOWNLOAD)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
+--------------+--------------+--------------+--------------+--------+ | Description | Clause | M/O/C | Min | Length | +--------------+--------------+--------------+--------------+--------+ | SMS-PP | 9.1 | M | Y | 1 | | download tag | | | | | +--------------+--------------+--------------+--------------+--------+ | Length | - | M | Y | 1 or 2 | | (A+B+C) | | | | | +--------------+--------------+--------------+--------------+--------+ | Device | 8.7 | M | Y | A | | identities | | | | | +--------------+--------------+--------------+--------------+--------+ | Address | 8.1 or 8.108 | C(see note2) | N(see note1) | B | +--------------+--------------+--------------+--------------+--------+ | URI | 8.135 | C | N | 2 | | truncated | | | | | +--------------+--------------+--------------+--------------+--------+ | SMS TPDU | 8.13 | M | Y | C | | ( | | | | | | SMS-DELIVER) | | | | | +--------------+--------------+--------------+--------------+--------+ | Originating | 8.108 | C | N (see | D | | Address | | | note1) | | +--------------+--------------+--------------+--------------+--------+ | NOTE1: The | | | | | | UICC shall | | | | | | be able to | | | | | | manage the | | | | | | situation | | | | | | when the | | | | | | address | | | | | | field is not | | | | | | present, in | | | | | | order to | | | | | | ensure | | | | | | backwards | | | | | | c | | | | | | ompatibility | | | | | | with | | | | | | previous | | | | | | releases of | | | | | | this | | | | | | sp | | | | | | ecification. | | | | | | | | | | | | NOTE2: The | | | | | | address data | | | | | | object shall | | | | | | not be | | | | | | present when | | | | | | SMS-PP data | | | | | | download is | | | | | | transporting | | | | | | SOR | | | | | | transparent | | | | | | container | | | | | | information | | | | | | element | | | | | | received | | | | | | from | | | | | | REGISTRATION | | | | | | ACCEPT or DL | | | | | | NAS | | | | | | TRANSPORT | | | | | | message as | | | | | | such message | | | | | | does not | | | | | | contain the | | | | | | address of a | | | | | | service | | | | | | center. | | | | | +--------------+--------------+--------------+--------------+--------+
\- Device identities: the ME shall set the device identities to:
\- source: Network;
\- destination: UICC.
\- Address: The address data object holds the RP_Originating_Address of the
Service Centre (TS‑Service-Centre-Address), as defined in 3GPP TS 24.011 [10].
If the USIM or the ISIM Service Table indicates URI support for SMS-PP
DOWNLOAD, then this address data object may contain the Public Service
Identity of the Service Center. If the URI is longer than the maximum length
that can be transmitted to the UICC, then the URI shall be truncated to the
maximum length that can be transmitted to the UICC and the request shall
contain a URI truncated tag.
\- Originating Address: If the USIM or the ISIM Service Table indicates URI
support for SMS-PP DOWNLOAD, then the Originating Address data object may be
present and contain the Public Identity (IMPU) of the sender of the short
message. If the URI is longer than the maximum length that can be transmitted
to the UICC, then the Originating Address data object shall not be sent.
Response parameters/data.
It is permissible for the UICC not to provide response data. If the UICC
provides response data, the following data is returned.
* * *
Byte(s) Description Length 1‑X (X128) UICC Acknowledgement X
* * *
### 7.1.2 Cell Broadcast data download
#### 7.1.2.1 Procedure
If the service \"data download via SMS-CB\" is available in the USIM Service
Table (see TS 31.102 [14]), then the ME shall follow the procedure below:
\- when the ME receives a new Cell Broadcast message, the ME shall compare the
message identifier of the Cell Broadcast message with the message identifiers
contained in EFCBMID;
\- In the case of a GSM Cell Broadcast message, if the message identifier is
found in EFCBMID, the cell broadcast page is passed to the UICC using the
ENVELOPE (CELL BROADCAST DOWNLOAD) command, defined below. The ME shall not
display the message;
\- In the case of a UMTS Cell Broadcast message, if the message identifier is
found in EFCBMID, the ME shall deconstruct the UMTS Cell Broadcast message
Parameter into its Cell Broadcast pages, and reconstruct each page in the
format of the GSM Cell Broadcast Message Parameter, as described below, and
according to the definition of the Cell Broadcast message structure in TS
23.041[6]:
1) From the Number-of-Pages byte of the UMTS message, the ME shall obtain the
number of Cell Broadcast pages to be constructed.
2) For each page the ME shall reconstruct GSM Cell Broadcast Page header as
follows:
\- The 2-byte Serial Number of the UMTS message shall be mapped to the
reconstructed GSM message Serial Number.
\- The 2-byte Message ID of the UMTS message shall be mapped to the
reconstructed GSM message Message ID.
\- The 1-byte Data Coding Scheme of the UMTS message shall be mapped to the
reconstructed GSM message Data Coding Scheme.
\- The 1-byte Number-Of-Pages of the UMTS message in combination with the
current page\'s sequence number (based on the order of the pages in the UMTS
message) shall be formatted into the reconstructed GSM message Page Parameter
byte, as described in TS 23.041[6].
\- The respective 82 byte CBS-Message-Information-Page shall be mapped to the
reconstructed GSM message content.
Table: Cell Broadcast Message Parameter Element mapping
* * *
Network -- ME (UMTS Cell Broadcast Message) ME-USAT interface (GSM Cell
Broadcast Message Format) Message ID Message ID Serial Number Serial Number
Data Coding Scheme Data Coding Scheme Number-Of --Pages Page Parameter (Note)
CBS-Message-Information-Page Content of Message
* * *
> NOTE: The Page Parameter byte is constructed from the total number of pages
> as indicated in the UMTS CB message, in combination with the current page\'s
> sequence number (based on the order of the pages in the UMTS message).
\- Each of the resulting pages shall then be passed to the UICC using the
ENVELOPE (CELL BROADCAST DOWNLOAD) command, defined below. The ME shall not
display the message;
\- if the message identifier of the incoming cell broadcast message is not
found in EFCBMID, then the ME shall determine if the message should be
displayed, by following the procedures in TS 23.041 [6] and TS 31.102 [14].
\- if the UICC responds with \'93 00\', the ME shall consider that the Cell
Broadcast page has not been delivered successfully. The ME may retry to
deliver the same Cell Broadcast page.
The ME shall identify new cell broadcast pages by their message identifier,
serial number and page values.
#### 7.1.2.2 Structure of ENVELOPE (CELL BROADCAST DOWNLOAD)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O/C Min Length Cell Broadcast Download tag 9.1 M Y 1
Length (A+B) - M Y 1 or 2 Device identities 8.7 M Y A Cell Broadcast page 8.5
M Y B
* * *
\- Device identities: the ME shall set the device identities to:
\- source: Network;
\- destination: UICC.
Response parameters/data: None for this type of ENVELOPE command.
## 7.2 Menu Selection
See ETSI TS 102 223 [32] clause 7.2.
If the UICC responds with \'93 00\', the ME shall not re‑issue this particular
envelope.
## 7.3 Call Control and MO SMS control by USIM
### 7.3.1 Call Control by USIM
#### 7.3.1.1 Procedure for mobile originated calls
If the service \"call control\" is available in the USIM Service Table (see TS
31.102 [14]), then the ME shall follow the procedure described in ETSI TS 102
223 [32] clause 7.3.1.1 with the additional rules listed here:
\- when the user is dialling \"112\" or an emergency call code stored in
EF~ECC~, the ME shall set up an emergency call instead of passing the call
set-up details to the UICC;
\- if the UICC provides response data, then in addition to the response data
listed by ETSI TS 102 223 [32] clause 7.3.1.6, the response data from the UICC
may indicate to the ME to send instead a supplementary service or USSD
operation using the data supplied by the UICC. It is then mandatory for the ME
to perform the supplementary service or USSD operation in accordance with the
data from the UICC, if it is within the ME\'s capabilities to do so. If the
UICC requires a supplementary service or USSD operation that is beyond the
ME\'s capabilities, then the ME shall not perform the supplementary service or
USSD operation at all.
\- If, as a result of the procedure, the UICC supplies a number stored in
EF~ECC~, this shall not result in an emergency call.
This procedure is applicable also in the case where the call is originated
over IMS and the service \"communication control for IMS by USIM\" is not
available in the USIM Service Table (see TS 31.102 [14]). If the call is
originated over IMS and the service \"communication control for IMS by USIM\"
is available in the USIM Service Table, only the procedure for IMS
communications establishment (clause 7.3.1.9) shall be used.
In the case where the initial call set-up request results from a proactive
command SET UP CALL:
\- if the call control result is \"not allowed\", the ME shall inform the UICC
using TERMINAL RESPONSE \"interaction with call control by USIM or MO short
message control by USIM, permanent problem; action not allowed\";
\- if the call set-up request is changed by call control in a supplementary
service or USSD operation, and if the supplementary service or USSD operation
is within the ME\'s capabilities, then the ME shall send this request to the
network. The ME shall then send back a TERMINAL RESPONSE to the SET UP CALL
command at the same time it would have done for the proactive command
equivalent to the action requested by call control (i.e. SEND SS or SEND
USSD). However, in that case, the TERMINAL RESPONSE shall contain the response
data given in the response to ENVELOPE (CALL CONTROL) and a second Result TLV
identical to the one given in response to the proactive command equivalent to
the action requested by call control (i.e. SEND SS or SEND USSD). The mapping
between the general result in the first Result TLV and the general result in
the second Result TLV is given below:
the general result \"command performed, but modified by call control by USIM\"
shall be given in the first Result TLV if the general result of the second
Result TLV is \'0X\' or \'1X\';
the general result \"interaction with call control by USIM, temporary
problem\" shall be given in the first Result TLV if the general result of the
second Result TLV is \'2X\';
the general result \"interaction with call control by USIM or MO short message
control by USIM, permanent problem\" shall be given in the first Result TLV if
the general result of the second Result TLV is \'3X\';
\- if the call set-up request is changed by call control into a supplementary
service or USSD operation, and if the supplementary service or USSD operation
is beyond the ME\'s capabilities, then the ME shall send back a TERMINAL
RESPONSE to the SET UP CALL command, without performing the supplementary
service or USSD operation at all. In that case, the TERMINAL RESPONSE shall
contain the response data given in the response to ENVELOPE (CALL CONTROL) and
a second Result TLV identical to the one given in response to the proactive
command equivalent to the action requested by call control (i.e. SEND SS or
SEND USSD). The mapping between the general result in the first Result TLV and
the general result in the second Result TLV is given below:
the general result \"interaction with call control by USIM or MO short message
control by USIM, permanent problem\" shall be given in the first Result TLV,
and the general result \"command beyond ME\'s capabilities\" shall be given in
the second Result TLV.
The ME shall then follow the call set-up procedure defined in TS 24.008 [9] or
the supplementary service or USSD operation procedure defined in TS 24.080
[11].
#### 7.3.1.2 Procedure for Supplementary Services and USSD
If the service \"call control\" is available in the USIM Service Table (see TS
31.102 [14]), then for all supplementary service and USSD operations
(including those resulting from a SEND SS or SEND USSD proactive UICC
command), the ME shall first pass the supplementary service or USSD control
string (corresponding to the supplementary service or USSD operation and coded
as defined in TS 22.030 [2], even if this SS or USSD operation has been
performed via a specific menu of the ME) to the UICC, using the ENVELOPE (CALL
CONTROL) command defined below. The ME shall also pass to the UICC in the
ENVELOPE (CALL CONTROL) command the current serving cell.
The UICC shall respond in the same way as for mobile originated calls. The ME
shall interpret the response as follows:
\- if the UICC responds with \'90 00\', the ME shall send the supplementary
service or USSD operation with the information as sent to the UICC;
\- if the UICC responds with any status code indicating an error, the ME shall
not send the supplementary service or USSD;
\- if the UICC responds with \'93 00\', the ME shall not send the
supplementary service or USSD operation and may retry the command;
\- if the UICC provides response data, then the response data from the UICC
shall indicate to the ME whether to send the supplementary service or USSD
operation as proposed, not send the SS or USSD operation, send the SS or USSD
operation using the data supplied by the UICC, or instead set up a call using
the data supplied by the UICC. It is mandatory for the ME to perform the
supplementary service or USSD operation or the call set-up request in
accordance with the data from the UICC, if it is within the ME\'s capabilities
to do so. If the UICC requires a call set-up or supplementary service or USSD
operation that is beyond the ME\'s capabilities (e.g. the UICC maps a USSD
operation to a data call, and the ME does not support data calls), then the ME
shall not the perform the call set-up request or supplementary service or USSD
operation at all.
In the case where the initial SS or USSD request results from a proactive
command SEND SS or SEND USSD:
\- if the call control result is \"not allowed\", the ME shall inform the UICC
using TERMINAL RESPONSE (\"interaction with call control by USIM or MO short
message control by USIM, permanent problem; action not allowed\");
\- if the SS or USSD request is changed by call control in a call set-up
request, then the ME shall set up the call using the data given by the UICC,
if it is within the ME\'s capabilities to do so. If the UICC requires a call
set-up that is beyond the ME\'s capabilities (e.g. the UICC maps a USSD
operation to a data call, and the ME does not support data calls), then the ME
shall not set up the call at all. The ME shall send back a TERMINAL RESPONSE
to the initial proactive command at the same time it would have done for the
proactive command equivalent to the action requested by call control (i.e. SET
UP CALL). However, in that case, the TERMINAL RESPONSE shall contain the
response data given in the response to ENVELOPE (CALL CONTROL) and a second
Result TLV identical to the one given in response to the proactive command
equivalent to the action requested by call control (i.e. SET UP CALL). The
mapping between the general result in the first Result TLV and the general
result in the second Result TLV is the same as the one described in clause
7.3.1.1.
If the ME supports the Outgoing Call Information service, the ME shall update
EF~OCI~ with the supplementary service or USSD control string corresponding to
the initial user request.
The ME shall then follow the supplementary service or USSD operation procedure
defined in TS 24.080 [11] or the call set-up procedure defined in TS 24.008
[9].
#### 7.3.1.3 Indication to be given to the user
The UICC may optionally include an alpha-identifier in the response data to
the ENVELOPE (CALL CONTROL) message, in order to inform the user at the time
the response is received by the ME. The use of this alpha identifier by the ME
is described below:
\- if the UICC responds with \"allowed, no modification\", then:
if the alpha identifier is provided by the UICC and is not a null data object,
the ME shall use it to inform the user during the PDP/PDN context activation,
PDU session establishment or call set-up;
if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), this is an indication that the ME
should not modify the display corresponding to the initial user request;
if the alpha identifier is not provided by the UICC, the ME may give
information to the user concerning what is happening;
\- if the UICC responds with \"not allowed\", then:
if the alpha identifier is provided by the UICC and is not a null data object,
the ME shall use it to inform the user. This is also an indication that the ME
should not give any other information to the user on the reason of the
barring;
if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), the ME may give information to the
user concerning what is happening;
if the alpha identifier is not provided by the UICC, the ME may give
information to the user concerning what is happening.
\- if the UICC responds with \"allowed, with modifications\", and the modified
request is within the ME\'s capabilities, then:
if the alpha identifier is provided by the UICC and is not a null data object,
the ME shall use it to inform the user. The ME shall then not display the
destination address or SS string given by the UICC. This is also an indication
that the ME should not give any other information to the user on the changes
made by the UICC to the initial user request;
if the alpha identifier is provided by the UICC and is a null data object
(i.e. length = \'00\' and no value part), this is an indication that the ME
should not give any information to the user on the changes made by the UICC to
the initial user request. The ME shall not display the destination address or
SS string given by the UICC. The ME should not modify the display
corresponding to the initial user request;
if the alpha identifier is not provided by the UICC, the ME may indicate to
the user that the initial user request has been changed.
\- if the UICC responds with \"allowed, with modifications\" to a user-
initiated request (i.e. a request not initiated by a proactive command), and
the modified user request is beyond the ME\'s capabilities, then the ME may
give information to the user on the modified request and the fact that the
modified request is beyond the ME\'s capabilities, optionally using the alpha
identifier, if one is provided by the UICC;
\- if the UICC responds with \"allowed, with modifications\" to a request by a
proactive command SET UP CALL, SEND SS, SEND USSD or OPEN CHANNEL where GPRS
is selected, and the modified request is beyond the ME\'s capabilities, then
the ME shall not give any information to the user on the fact that the
modified request is beyond the ME\'s capabilities, and shall give a TERMINAL
RESPONSE to the proactive command (i.e. SET UP CALL, SEND SS, SEND USSD or
OPEN CHANNEL) as detailed in clauses 7.3.1.1, 7.3.1.2 and 7.3.1.3. The
responsibility to inform the user in this case lies with the UICC application
which sent the proactive command.
A terminal of type ND shall ignore any alpha identifier provided together with
the response data to the ENVELOPE (CALL CONTROL) message.
#### 7.3.1.4 Interaction with Fixed Dialling Number
The procedure defined in ETSI TS 102 223 [32] clause 7.3.1.4 for calls
applies. In addition, it shall apply in the same way for supplementary service
operations, the supplementary service control string being checked as if it
was a called number.
The ME shall check the number (or the supplementary service control string) in
accordance with TS 22.101 [34].
When the called address is an IMS URI, the ME shall check the destination
address using the FDN stored in EF~FDNURI~, in addition to the EF~FDN~
entries, following the same principle as defined in the Fixed Dialling Number
description in TS 22.101 [34] applied to URIs, and as described in TS
31.102[14] clause 4.2.97.
#### 7.3.1.5 Support of Barred Dialling Number (BDN) service
The procedure defined in ETSI TS 102 223 [32] clause 7.3.1.5 for calls
applies. In addition, it shall apply in the same way for supplementary service
operations, the supplementary service control string being checked as if it
was a called number.
The ME shall check the number (or the supplementary service control string) in
accordance with TS 22.101 [34].
When the called address is an IMS URI, the ME shall check the destination
address using the BDN stored in EF~BDNURI~, in addition to the EF~BDN~
entries, following the same principle as defined in the Barring Dialling
Number description in TS 22.101 [34] applied to URIs, and as described in TS
31.102[14] clause 4.2.98.
#### 7.3.1.6 Structure of ENVELOPE (CALL CONTROL)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O/C Min Length Call control tag 9.1 M Y 1 Length
(A+B+C+D+E+F+G) - M Y 1 or 2 Device identities 8.7 M Y A Address or SS string
or USSD string or PDP context activation parameters or EPS PDN connection
activation parameters or IMS URI or PDU session establishment parameters 8.1,
8.14 or 8.17 or 8.72 or 8.98 or 8.108 or 8.143 M Y B Capability configuration
parameters 1 8.4 O N C Subaddress 8.3 O N D Location information 8.19 C N E
Capability configuration parameters 2 8.4 O N F Media Type 8.132 C N G URI
truncated 8.135 C N 2
* * *
\- Device identities: the ME shall set the device identities to:
source: ME;
destination: UICC.
\- Address or SS string or USSD string or PDP context activation parameters or
EPS PDN connection activation parameters or IMS URI or PDU session
establishment parameters: only one data object shall be sent to the UICC:
> for a call set-up, the address data object is used and holds the Called
> Party Number, as defined in TS 24.008 [9], to which the ME is proposing
> setting up the call;
>
> for a supplementary service, the SS string data object is used and holds the
> corresponding supplementary service;
for a USSD operation, the USSD string data object is used and holds the
corresponding USSD control string;
> USIM Applications and MEs should take into account that early
> implementations of USAT use the SS string data object for coding of USSD
> control strings (instead of the USSD string data object). This behaviour is
> only possible for USSD control strings consisting of digits (0-9,*,#). The
> UICC can identify MEs having this early implementation by evaluating the
> indication \"USSD string data object supported in Call Control\" in the
> TERMINAL PROFILE. The ME can identify USIMs having this early implementation
> by evaluating the indication \"USSD string data object supported in Call
> Control\" in the USIM Service Table.
>
> For a PDP context activation, the Activate PDP context request parameters
> are used, as defined in TS 24.008 [9]. Except for the following parameters:
>
> \- Requested QoS;
>
> \- Access Point Name; and
>
> \- Protocol configuration options,
>
> the UICC should not modify any other parameters included in the ACTIVATE PDP
> CONTEXT REQUEST message as defined in TS 24.008 [9] to avoid that the UE
> sends a value of any of these parameters that is not compliant to TS 24.008
> [9];
>
> for an EPS PDN connection activation, the PDN Connectivity Request
> parameters are used, as defined in TS 24.301 [46]. Except for the following
> parameters:
>
> \- Access Point Name; and
>
> \- Protocol configuration options,
>
> the UICC should not modify any other parameters included in the PDN
> CONNECTIVITY REQUEST message as defined in TS 24.301 [46] to avoid that the
> UE sends a value of any of these parameters that is not compliant to TS
> 24.301 [46];
>
> for an IMS communication establishment, the IMS Request-URI field is used
> and the IMS URI data object holds the SIP URI or tel URI, as defined in TS
> 24.229[52], to which the ME is proposing setting up the communication. If
> the URI is longer than the maximum length that can be transmitted to the
> UICC, then the URI shall be truncated to the maximum length that can be
> transmitted to the UICC and the request shall contain a URI truncated tag.
>
> for a PDU session establishment, the PDU Session Establishment Request
> parameters are used, as defined in TS 24.501 [70]. Except for the following
> parameters:
>
> \- SM PDU DN request container; and
>
> \- operator specific parameters in Extended Protocol configuration options,
>
> the UICC should not modify any other parameters included in the PDU SESSION
> ESTABLISHMENT REQUEST message as defined in TS 24.501 [70] to avoid that the
> UE sends a value of any of these parameters that is not compliant to TS
> 24.501 [70].
\- Capability configuration parameters: Only used for a call set-up, this
contains the Bearer capabilities that the ME is proposing to send to the
network. The first capability configuration parameters corresponds to the
bearer capability 1 information element of a mobile originating SETUP message,
as defined in TS 24.008 [9]. The second capability configuration parameters
correspond to the bearer capability 2 information element of a mobile
originating SETUP message, as defined in TS 24.008 [9]. If no capability
configuration parameters are present, this shall indicate a speech call.
\- Subaddress: Only used for a call set-up, this contains the called party
subaddress that the ME is proposing to send to the network. If one is not
present, this shall indicate that the ME is proposing not to send this
information element to the network.
\- Location information: This data object contains the identification (MCC,
MNC, LAC/TAC, Cell Identity) of the current serving cell of the UE. The
comprehension required flag of this data object in this command shall be set
to \'0\'. This data object shall be present if the call is performed over
GERAN, UTRAN, E-UTRAN or NG-RAN.
\- Media Type: This data object indicates the type of media the ME is
proposing using to set up the communication. If the type of media to be used
by the ME is one of those listed in the Terminal Profile and if the \"Media
Type support\" service is allocated and activated in the USIM or ISIM Service
Table, the Media Type data object shall be present.
\- URI truncated: This data object indicates that the URI in the request was
truncated because too long to be transmitted to the UICC.
Response parameters/data.
It is permissible for the UICC to provide no response data, by responding with
SW1/SW2 = \'90 00\'. If the UICC does not provide any response data, then this
shall have the same meaning as \"allowed, no modification\".
+----------------------+----------------------+-------+-----+--------+ | Description | Clause | M/O/C | Min | Length | +----------------------+----------------------+-------+-----+--------+ | Call control result | - | M | Y | 1 | +----------------------+----------------------+-------+-----+--------+ | Length | - | M | Y | 1 or 2 | | (A+B+C+D+E+F+G) | | | | | +----------------------+----------------------+-------+-----+--------+ | Address or SS string | 8.1, 8.14 or 8.17 or | O | N | A | | or USSD string or | 8.72 or 8.98 or | | | | | PDP context | 8.108 or 8.143 | | | | | activation | | | | | | parameters or EPS | | | | | | PDN connection | | | | | | activation | | | | | | parameters or IMS | | | | | | URI | | | | | | | | | | | | or PDU session | | | | | | establishment | | | | | | parameters | | | | | +----------------------+----------------------+-------+-----+--------+ | Capability | 8.4 | O | N | B | | configuration | | | | | | parameters 1 | | | | | +----------------------+----------------------+-------+-----+--------+ | Subaddress | 8.3 | O | N | C | +----------------------+----------------------+-------+-----+--------+ | Alpha identifier | 8.2 | O | N | D | +----------------------+----------------------+-------+-----+--------+ | BC repeat indicator | 8.42 | C | N | E | +----------------------+----------------------+-------+-----+--------+ | Capability | 8.4 | O | N | F | | configuration | | | | | | parameters 2 | | | | | +----------------------+----------------------+-------+-----+--------+ | Media Type | 8.132 | O | N | G | +----------------------+----------------------+-------+-----+--------+
\- Call control result:
Contents:
\- The command that the UICC gives to the ME concerning whether to allow, bar
or modify the proposed call (or supplementary service operation);
Coding:
\- \'00\' = Allowed, no modification;
\- \'01\' = Not allowed;
\- \'02\' = Allowed with modifications.
\- Address or SS string or USSD string or PDP context/EPS PDN connection
activation parameters or IMS URI or PDU session establishment parameters: Only
one data object may be included if the UICC requests the call (or
supplementary service or USSD operation or PDP context/EPS PDN connection
activation or IMS communication establishment or PDU session establishment
parameters) details to be modified:
> for a call set-up, if the address data object is not present, then the ME
> shall assume the Dialling number is not to be modified;
>
> if the SS string data object or address data object is present and the ME
> receives wild values according to TS 31.102 [14], then the ME shall not
> process the command.
>
> For a supplementary service, if the SS string data object is not present,
> then the ME shall assume that SS is not to be modified;
>
> for a USSD operation, if the USSD string data object is not present, then
> the ME shall assume that the USSD operation is not to be modified;
>
> for a PDP context activation, if the PDP context activation parameters
> object is not present, then the ME shall assume that the PDP context
> activation is not to be modified;
>
> for an EPS PDN connection activation, if the EPS PDN connection activation
> parameters object is not present, then the ME shall assume that the EPS PDN
> connection activation is not to be modified;
>
> for an IMS communication establishment, if the IMS URI data object is not
> present, then the ME shall assume that neither the SIP URI nor the tel URI
> are to be modified.
>
> for a PDU session establishment, if the PDU session establishment parameters
> object is not present, then the ME shall assume that the PDU session
> establishment is not to be modified.
\- Capability configuration parameters: Only used for a call set-up, this data
object is only required if the USIM application requests the call details to
be modified. The first capability configuration parameters corresponds to the
bearer capability 1 information element of a mobile originating SETUP message,
as defined in TS 24.008 [9]. The second capability configuration parameters
corresponds to the bearer capability 2 information element of a mobile
originating SETUP message, as defined in TS 24.008 [9]. If the capability
configuration parameters are not present, then the ME shall assume the
parameters are not to be modified.
\- Subaddress: Only used for a call set-up, this data object is only required
if the USIM application requests the call details to be modified. If the
subaddress is not present, then the ME shall assume the called party
subaddress is not to be modified. If the subaddress supplied by the USIM
application is a null data object, then the ME shall not provide a called
party subaddress to the network. A null data object shall have length = \'00\'
and no value part.
\- Alpha identifier: this data object is only required if the UICC requests a
particular indication to be given to the user. The handling of this data
object by the ME is described in clause 7.3.1.3. The comprehension required
flag of this data object shall be set to \'0\'.
\- BC repeat indicator: indicates how the associated bearers shall be
interpreted. The change of bearer occurs on a network event. This BC repeat
indicator is conditioned to the presence of the second capability
configuration parameters and is coded as defined in TS 24.008 [9].
\- Media Type: this data object is only required if the UICC requests the
media type of the call to be modified. If the Media Type is not present then
the ME shall assume the media type of the call is not to be modified.
It is mandatory for the UICC to provide at least one of the optional data
objects if it has set the Call control result to \"allowed with
modifications\".
#### 7.3.1.7 Procedure for PDP Context Activation
If the service \"call control on GPRS by USIM\" is available in the USIM
Service Table (see TS 31.102 [14]), then for all PDP Context activation
(including those resulting from a OPEN CHANNEL proactive UICC command where
GPRS is selected), the ME shall first pass the corresponding Activate PDP
Context message (see TS 24.008 [9]) to the UICC, using the ENVELOPE (CALL
CONTROL) command defined below. The ME shall also pass to the UICC in the
ENVELOPE (CALL CONTROL) command the current serving cell.
When the ME performs an emergency PDP context activation, the ME shall not
send the ENVELOPE (CALL CONTROL) command to the UICC.
The UICC shall respond in the same way as for mobile originated calls. The ME
shall interpret the response as follows:
\- if the UICC responds with \'90 00\', the ME shall send the Activate PDP
Context message with the information as sent to the UICC;
\- if the UICC responds with \'93 00\', the ME shall not the Activate PDP
Context message and may retry the command;
\- if the UICC provides response data, then the response data from the UICC
shall indicate to the ME whether to send the Activate PDP Context message as
proposed, not send the Activate PDP Context message or send the Activate PDP
Context message using the data supplied by the UICC. It is mandatory for the
ME to perform the PDP Context Activation in accordance with the data from the
UICC, if it is within the ME\'s capabilities to do so. If the UICC requires
PDP Context Activation that is beyond the ME\'s capabilities, then the ME
shall not perform PDP Context Activation at all.
In the case where the initial PDP Context Activation request results from a
proactive command OPEN CHANNEL where GPRS is selected:
\- if the call control result is \"not allowed\", the ME shall inform the UICC
using TERMINAL RESPONSE (\"interaction with call control by USIM or MO short
message control by USIM, permanent problem; action not allowed\");
\- if the PDP Context Activation data is changed by call control, then the ME
shall activate the PDP context using the data given by the UICC, if it is
within the ME\'s capabilities to do so. If the UICC requires a PDP Context
Activation that is beyond the ME\'s capabilities (e.g. the UICC requests a QoS
that the ME cannot handle ), then the ME shall not activate the PDP context at
all.
#### 7.3.1.8 Procedure for EPS PDN connection Activation
If the service \"call control on EPS PDN connection by USIM\" is available in
the USIM Service Table (see TS 31.102 [14]), then for all EPS PDN connection
activation (including those resulting from a OPEN CHANNEL proactive UICC
command where E-UTRAN is selected), the ME shall first pass the corresponding
PDN Connectivity Request message (see TS 24.301 [46]) to the UICC, using the
ENVELOPE (CALL CONTROL) command defined above. The ME shall also pass to the
UICC in the ENVELOPE (CALL CONTROL) command the current serving cell.
When the ME performs an emergency EPS PDN connection activation, the ME shall
not send the ENVELOPE (CALL CONTROL) command to the UICC.
The UICC shall respond in the same way as for mobile originated calls. The ME
shall interpret the response as follows:
\- if the UICC responds with \'90 00\', the ME shall send the PDN Connectivity
Request message with the information as sent to the UICC;
\- if the UICC responds with \'93 00\', the ME shall not send the PDN
Connectivity Request message and may retry the command;
\- if the UICC provides response data, then the response data from the UICC
shall indicate to the ME whether to send the PDN Connectivity Request message
as proposed, not send the PDN Connectivity Request message or send the PDN
Connectivity Request message using the data supplied by the UICC. It is
mandatory for the ME to perform the EPS PDN Connection Activation in
accordance with the data from the UICC, if it is within the ME\'s capabilities
to do so. If the UICC requires EPS PDN Connection Activation that is beyond
the ME\'s capabilities, then the ME shall not perform EPS PDN Connection
Activation at all.
In the case where the initial PDN Connectivity Request results from a
proactive command OPEN CHANNEL where E-UTRAN is selected:
\- if the call control result is \"not allowed\", the ME shall inform the UICC
using TERMINAL RESPONSE (\"interaction with call control by USIM or MO short
message control by USIM, permanent problem; action not allowed\");
\- if the EPS PDN Connection Activation data is changed by call control, then
the ME shall activate the EPS PDN Connection using the data given by the UICC,
if it is within the ME\'s capabilities to do so. If the UICC requires a EPS
PDN Connection Activation that is beyond the ME\'s capabilities, then the ME
shall not activate the EPS PDN Connection at all.
#### 7.3.1.9 Procedure for IMS communications establishment
If the service \"communication control for IMS by USIM\" is available in the
USIM Service Table (see TS 31.102 [14]), then for all IMS communication
establishment, the ME shall first pass the corresponding IMS Request-URI
contained in SIP INVITE message (see TS24.229 [52]) to the UICC, using the
ENVELOPE (CALL CONTROL) command defined above. The ME shall also pass to the
UICC in the ENVELOPE (CALL CONTROL) command the current serving cell if the
IMS communication is established over GERAN, UTRAN, E-UTRAN or NG-RAN.. If the
type of media to be used by the ME is one of those listed in the Terminal
Profile and if the \"Media Type support\" service is allocated and activated
in the USIM or ISIM Service Table, the ME shall pass to the UICC in the
ENVELOPE (CALL CONTROL) command the media type of the SIP communication
session it is setting up.
This procedure replaces the call control by USIM using the Address TLV (clause
8.1) when the call is originated over IMS and the service \"communication
control for IMS by USIM\" is available in the USIM Service Table (see TS
31.102 [14]).
When the ME detects that an IMS emergency call is being initiated, the ME
shall set up an emergency call without sending the ENVELOPE (CALL CONTROL)
command to the UICC.
The UICC shall respond in the same way as for mobile originated
communications. The ME shall interpret the response as follows:
\- if the UICC responds with \'90 00\', the ME shall send the SIP INVITE
message with the information as sent to the UICC;
\- if the UICC responds with \'93 00\', the ME shall not send SIP INVITE
message and may retry the command;
\- if the UICC provides response data, then the response data from the UICC
shall indicate to the ME whether to send the SIP INVITE message as proposed,
not send the SIP INVITE message or send the SIP INVITE message using the IMS-
Request URI supplied by the UICC. It is mandatory for the ME to perform the
SIP INVITE request in accordance with the data from the UICC, if it is within
the ME\'s capabilities to do so. If the UICC requires SIP INVITE request that
is beyond the ME\'s capabilities, then the ME shall not send SIP INVITE
request at all.
#### 7.3.1.10 Procedure for PDU session establishment
If the service \"call control on PDU session by USIM\" is available in the
USIM Service Table (see TS 31.102 [14]), then for all PDU session
establishment (including those resulting from a OPEN CHANNEL proactive UICC
command where NG-RAN is selected), the ME shall first pass the corresponding
PDU Session Establishment Request message (see TS 24.501 [70]) to the UICC,
using the ENVELOPE (CALL CONTROL) command defined above. The ME shall also
pass to the UICC in the ENVELOPE (CALL CONTROL) command the current serving
cell.
When the ME performs an emergency PDU session establishment, the ME shall not
send the ENVELOPE (CALL CONTROL) command to the UICC.
The UICC shall respond in the same way as for mobile originated calls. The ME
shall interpret the response as follows:
\- if the UICC responds with \'90 00\', the ME shall send the PDU Session
Establishment Request message with the information as sent to the UICC;
\- if the UICC responds with \'93 00\', the ME shall not send the PDU Session
Establishment Request message and may retry the command;
\- if the UICC provides response data, then the response data from the UICC
shall indicate to the ME whether to send the PDU Session Establishment Request
message as proposed, not send the PDU Session Establishment Request message or
send the PDU Session Establishment Request message using the data supplied by
the UICC. It is mandatory for the ME to perform the PDU session establishment
in accordance with the data from the UICC, if it is within the ME\'s
capabilities to do so. If the UICC requires PDU session establishment that is
beyond the ME\'s capabilities, then the ME shall not perform PDU session
establishment at all.
In the case where the initial PDU Session Establishment Request results from a
proactive command OPEN CHANNEL where NG-RAN is selected:
\- if the call control result is \"not allowed\", the ME shall inform the UICC
using TERMINAL RESPONSE (\"interaction with call control by USIM or MO short
message control by USIM, permanent problem; action not allowed\");
\- if the PDU session establishment data is changed by call control, then the
ME shall establish the PDU session using the data given by the UICC, if it is
within the ME\'s capabilities to do so. If the UICC requires a PDU session
establishment that is beyond the ME\'s capabilities, then the ME shall not
establish the PDU session at all.
### 7.3.2 MO Short Message Control by USIM
#### 7.3.2.1 Description
If the service \"MO Short Message Control\" is available in the USIM Service
Table (see TS 31.102 [14]), then the ME shall follow the procedure below:
\- for all MO short message attempts (even those resulting from a SEND SM
proactive UICC command), the ME shall first pass the RP_destination_address of
the service centre and the TP_Destination_Address to the UICC, using the
ENVELOPE (MO SHORT MESSAGE CONTROL) command defined below. The ME shall also
pass to the UICC in the ENVELOPE (MO SHORT MESSAGE CONTROL) command the
current serving cell;
\- if the UICC responds with \'90 00\', the ME shall send the short message
with the addresses unchanged;
\- if the UICC responds with any other status code indicating an error, the ME
shall not send the short message;
\- if the UICC responds with \'93 00\', the ME shall not send the short
message and may retry the command;
\- if the UICC provides response data, then the response data from the UICC
shall indicate to the ME whether to send the short message as proposed, not
send the short message or send a short message using the data supplied by the
UICC. It is mandatory for the ME to perform the MO short message request in
accordance with the data from the UICC.
The ME shall then follow the MO Short Message procedure defined in TS 24.011
[10].
In the case where the initial MO short message request results from a
proactive command SEND SHORT MESSAGE, if the MO short message control result
is \"not allowed\", the ME shall inform the UICC using TERMINAL RESPONSE,
\"interaction with call control by USIM or MO short message control by USIM,
permanent problem; action not allowed\".
#### 7.3.2.2 Structure of ENVELOPE (MO SHORT MESSAGE CONTROL)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O/C Min Length MO Short Message control tag 9.1 M Y 1
Length (A+B+C+D) - M Y 1 or 2 Device identities 8.7 M Y A Address data object
1 8.1 or 8.108 M Y B Address data object 2 8.1 or 8.108 M Y C Location
information 8.19 C Y D
* * *
\- Device identities: the ME shall set the device identities to:
source: ME;
destination: UICC.
\- Address data object 1: this address data object 1 contains the
RP_Destination_Address of the Service Centre to which the ME is proposing to
send the short message. If the USIM or the ISIM Service Table indicates URI
support for MO SHORT MESSAGE CONTROL, then the address data object 1 may
contain the Public Service Identity of the SM-SC to which the ME is proposing
to send the short message. The type of address data object shall not be
modified.
\- Address data object 2: this address data object 2 contains the
TP_Destination_Address to which the ME is proposing to send the short message.
If the USIM or the ISIM Service Table indicates URI support for MO SHORT
MESSAGE CONTROL, then the address data object 2 may contain the Public
Identity (IMPU) of the receiver to which the ME is proposing to send the short
message. The type of address data object shall not be modified.
\- Location information: this data object contains the identification (MCC,
MNC, LAC/TAC, Cell Identity) of the current serving cell of the UE. This data
object shall be present if the short message is sent over GERAN, UTRAN,
E-UTRAN or NG-RAN.
Response parameters/data.
It is permissible for the UICC to provide no response data, by responding with
SW1/SW2 = \'90 00\'. If the UICC does not provide any response data, then this
shall have the same meaning as \"allowed, no modification\".
* * *
Description Clause M/O/C Min Length MO short message control result - M Y 1
Length (A+B+C) - M Y 1 or 2 Address data object 1 8.1 or 8.108 O (see note) N
A Address data object 2 8.1 or 8.108 O (see note) N B Alpha identifier 8.2 O N
C NOTE: The UICC shall provide the two optional address data objects if it has
set the MO Short Message control result to \"allowed with modifications\".
* * *
\- MO Short Message control result:
Contents:
\- The command that the UICC gives to the ME concerning whether to allow, bar
or modify the proposed short message;
Coding:
\- \'00\' = Allowed, no modification;
\- \'01\' = Not allowed;
\- \'02\' = Allowed with modifications.
\- if the ME receives wild values according to TS 31.102 [14] in either the
Address data object 1 or Address data object 2, then the ME shall not process
the command.
\- Alpha identifier: this data object is only required if the UICC requests a
particular indication to be given to the user. The handling of this data
object by the ME is described in clause 7.3.2.3.
#### 7.3.2.3 Indication to be given to the user
The UICC may optionally include an alpha-identifier in the response data to
the ENVELOPE (MO SHORT MESSAGE CONTROL) message, in order to inform the user
at the time the response is received by the ME. The use of this alpha
identifier by the ME is identical to the one described in clause 7.3.1.3
relative to call control by USIM.
#### 7.3.2.4 Interaction with Fixed Dialling Number
It is permissible for the Fixed Dialling Number service to be enabled (see TS
31.102 [14]) at the same time as MO Short Message Control is available (in the
USIM Service Table). If FDN is enabled, the ME shall follow the procedure for
Call Control (see clause 7.3.1.4), where the number or called address (i.e.
IMS URI) in the procedure refers to both the SMS destination address and the
SMSC address.
## 7.4 Timer Expiration
See ETSI TS 102 223 [32] clause 7.4.
## 7.5 Event download
See ETSI TS 102 223 [32] clause 7.5.
Regarding all the call events, the following equivalences shall apply:
\- the \"call setup message\" is the SETUP message as defined in TS 24.008
[09];
\- the \"call connect message\" is the CONNECT message as defined in TS 24.008
[09];
\- the \"disconnect messages\" are the DISCONNECT, RELEASE, RELEASE COMPLETE
messages as defined in TS 24.008 [09];
\- the \"NULL state\" is the CC-U0 state as defined in TS 24.008 [09].
Regarding the location status event, the following equivalence shall apply:
\- the \"idle\" state is the MM-IDLE state as defined in TS 24.008 [09] for
GERAN/UTRAN, the EMM-IDLE state as defined in TS 24.301 [46] for E-UTRAN and
5GMM-IDLE state as defined in TS 24.501 [70] for NG-RAN.
Where events occur and the UICC responds with \'93 00\', the ME shall retry to
deliver the event download messages to the UICC.
### 7.5.1 (I-)WLAN Access status event
#### 7.5.1.1 Procedure
If the (I-)WLAN Access Status event is part of the current event list (as set
up by the last SET UP EVENT LIST command, see clause 6.4.16), then, when the
terminal detects a change in its current I-WLAN access or WLAN access
respectively the terminal shall inform the UICC that this has occurred, by
using the ENVELOPE (EVENT DOWNLOAD -- (I-)WLAN Access Status) command as
defined in clause 7.5.1.2.
#### 7.5.1.2 Structure of ENVELOPE (EVENT DOWNLOAD -- (I-)WLAN Access Status)
Direction: terminal to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O Min Length Event download tag 9.1 M Y 1 Length (A+B+C)
- M Y 1 or 2 Event list 8.25 M Y A Device identities 8.7 M Y B (I-)WLAN Access
Status 8.84 M Y C
* * *
Event list: the Event list data object shall contain only one event (value
part of length 1 byte), and terminal shall set the event to:
(I-)WLAN Access Status.
Device identities: the terminal shall set the device identities to:
source: terminal;
destination: UICC.
(I-)WLAN Access Status: this data object shall contain the (I-)WLAN Access
status of the terminal.
Response parameters/data: None for this type of ENVELOPE command.
### 7.5.1A MT Call event
#### 7.5.1A.1 Procedure
If the MT call event is part of the current event list (as set up by the last
SET UP EVENT LIST command, see clause 6.4.16), then when the ME receives an
incoming call setup message, the ME shall inform the UICC that this has
occurred, by using the ENVELOPE (EVENT DOWNLOAD - MT call) command as defined
in clause 7.5.1A.2.
#### 7.5.1A.2 Structure of ENVELOPE (EVENT DOWNLOAD - MT call)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O/C Min Length Event download tag 9.1 M Y 1 Length
(A+B+C+D+E+F+G) - M Y 1 or 2 Event list 8.25 M Y A Device identities 8.7 M Y B
Transaction identifier 8.28 M N C Address 8.1 C N D Subaddress 8.3 C N E IMS
URI 8.108 C N F Media Type 8.132 C N G URI truncated 8.135 C N 2
* * *
Event list: the event list object shall contain only one event (value part of
length 1 byte), and ME shall set the event to:
\- MT call.
Device identities: the ME shall set the device identities to:
\- source: network;
\- destination: UICC.
Transaction identifier: the transaction identifier data object shall contain
one transaction identifier, and this shall be the Transaction Identifier as
defined in clause 8.28.
Address: the address data object holds the Calling Party number received by
the ME in the call setup message. If the Calling Party number is included in
the call setup message, the ME shall include the Address object. Otherwise the
ME shall not include the Address object.
Subaddress: The Subaddress data object holds the Calling Party Subaddress as
received by the ME in the call setup message. If the Calling Party Subaddress
is included in the call setup message, the ME shall include the Subaddress
object, otherwise the terminal shall not include the Subaddress object.
IMS URI: The IMS URI data object is a SIP or TEL URI of the Calling Party
received by the ME in the call setup message. This data object will be present
only if the \"URI support by UICC\" Service is present in the USIM or the ISIM
Service Table. The IMS URI data object shall contain the SIP URI or tel URI
indicated in the P-Asserted-Identity field as defined in TS 24.229 [52]. In
case the P-Asserted-Identity field is missing the SIP URI or tel URI indicated
in the From header field shall be used. If the URI is longer than the maximum
length that can be transmitted to the UICC, then the URI shall be truncated to
the maximum length that can be transmitted to the UICC and the request shall
contain a URI truncated tag.
Media Type: The Media Type indicates the type of media of the incoming call
session and shall be coded as defined in clause 8.132. The Media Type data
object shall be present, if the \"Media Type support\" service is allocated
and activated in the USIM or ISIM Service Table.
Response parameters/data:
\- none.
### 7.5.2 Network Rejection event
#### 7.5.2.1 Procedure
If the Network Rejection event is part of the current event list (as set up by
the last SET UP EVENT LIST command, see ETSI TS 102 223 [32] clause 6.4.16),
then, in the case of GERAN/UTRAN if the terminal receives a LOCATION UPDATING
REJECT message or a GPRS ATTACH REJECT message or a ROUTING AREA UPDATE REJECT
message (as defined in TS 24.008 [9]) or in the case of E-UTRAN if the
terminal receives an EMM ATTACH REJECT message or TRACKING AREA UPDATE REJECT
message (as defined in TS 24.301 [46]), or in the case of NG-RAN if the
terminal receives a REGISTRATION REJECT message (as defined in TS 24.501
[70]), the terminal shall inform the UICC that this has occurred, by using the
ENVELOPE (EVENT DOWNLOAD -- Network Rejection Event) command as defined below.
#### 7.5.2.2 Structure of ENVELOPE (EVENT DOWNLOAD -- Network Rejection)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O Min Length Event download tag 9.1 M Y 1 Length (A+B+(C
or D or I)+E+F+G+H+J) - M Y 1 Event list 8.25 M Y A Device identities 8.7 M Y
B Location Information 8.19 C N C Routing Area Identification 8.91 C N D
Tracking Area Identification 8.99 C N I Access Technology 8.62 M Y E
Update/Attach/Registration Type 8.92 M Y G Rejection Cause Code 8.93 M Y H
Extended Rejection Cause Code 8.136 C N J
* * *
\- Event list: the Event list data object shall contain only one event (value
part of length 1 byte), and terminal shall set the event to:
> \- Network Rejection Event.
\- Device identities: the terminal shall set the device identities to:
> \- source: Network;
>
> \- destination: UICC.
\- Location information: This data object shall only be present when the ME
receives a Location Updating Reject message, and shall contain the
identification (MCC, MNC, and LAC) of the rejecting network.
\- Routing Area Identification: This data object shall only be present when
the ME receives a GPRS ATTACH REJECT message or a ROUTING AREA UPDATE REJECT
message and shall contain the identification (MCC, MNC, LAC and RAC) of the
rejecting network.
\- Tracking Area Identification: This data object shall only be present when
the ME receives an EMM ATTACH REJECT or a TRACKING AREA UPDATE REJECT or a
REGISTRATION REJECT message and shall contain the identification (MCC, MNC and
TAC) of the rejecting network.
\- Access Technology: This data object shall contain the access technology of
the rejecting network.
\- Update/Attach/Registration Type: This data object contains the location
updating or attach or update or EPS attach or EPS update or 5GS registration
type that was used in the LOCATION UPDATING REQUEST or GPRS ATTACH REQUEST or
ROUTING AREA UPDATE REQUEST or EMM ATTACH REQUEST or TRACKING AREA UPDATE
REQUEST or REGISTRATION REQUEST message.
\- Rejection Cause Code: This data object contains the cause code value that
was received in the LOCATION UPDATING REJECT or GPRS ATTACH REJECT or ROUTING
AREA UPDATE REJECT or EMM ATTACH REJECT or TRACKING AREA UPDATE REJECT or
REGISTRATION REJECT message.
\- Extended Rejection Cause Code: This data object contains the extended cause
code value that was received in the EMM ATTACH REJECT or TRACKING AREA UPDATE
REJECT message.
Response parameters/data: None for this type of ENVELOPE command.
### 7.5.2A Call connected event
#### 7.5.2A.1 Procedure
See ETSI TS 102 223 [32] clause 7.5.2.1.
#### 7.5.2A.2 Structure of ENVELOPE (EVENT DOWNLOAD - call connected)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O/C Min Length Event download tag 9.1 M Y 1 Length
(A+B+C+D) - M Y 1 or 2 Event list 8.25 M Y A Device identities 8.7 M Y B
Transaction identifier 8.28 M Y C Media Type 8.132 O N D
* * *
Event list: the event list object shall contain only one event (value part of
length 1 byte), and the ME shall set the event to:
\- call connected.
Device identities:
\- in the case of connecting at the near end (an MT call), the ME shall set
the device identities to:
\- source: ME;
\- destination: UICC.
\- in the case of connecting at the far end (an MO call), the ME shall set the
device identities to:
\- source: network;
\- destination: UICC.
Transaction identifier: the Transaction identifier data object shall contain
one transaction identifier.
Media Type: The Media Type indicates the type of media of the call session and
shall be coded as defined in clause 8.132. The Media Type data object shall be
present, if the \"Media Type support\" service is allocated and activated in
the USIM or ISIM Service Table.
Response parameters/data:
\- none.
### 7.5.3 CSG Cell Selection event
The following clause applies if class \"q\" is supported
#### 7.5.3.1 Procedure
If the CSG Cell Selection event is part of the current event list (as set up
by the last SET UP EVENT LIST command, see ETSI TS 102.223 [32]), then, when
the ME detects a change in its current CSG or Hybrid cell selection status,
the ME shall inform the UICC that it has occurred, using ENVELOPE (EVENT
DOWNLOAD -- CSG Cell Selection) as defined below.
#### 7.5.3.2 Structure of ENVELOPE (EVENT DOWNLOAD -- CSG Cell Selection)
Direction : ME to UICC
The command header is specified in TS 31.101 [13]
Command parameters/data
* * *
Description Clause M/O Min Length Event download tag 9.1 M Y 1 Length
(A+B+C+D+E+F) - M Y 1 Event list 8.25 M Y A Device identities 8.7 M Y B Access
Technology 8.62 C Y C CSG cell selection status 8.101 M Y D CSG ID 8.102 C N E
HNB name 8.103 C N F PLMN ID 8.118 O N G
* * *
\- Event list: the Event list data object shall contain only one event (value
part of length 1 byte), and terminal shall set the event to:
\- CSG Cell Selection.
\- Device identities: the terminal shall set the device identities to:
\- source: Network;
\- destination: UICC.
> \- Access Technology: This data object shall contain the access technology
> of the current serving cell. If the device is not camping on any cell, this
> data object shall not be present.
>
> \- CSG cell selection status: this data object shall contain CSG or Hybrid
> cell selection status. The ME should send the event indicating that it is
> not camped on a CSG or Hybrid cell only after a previous event that
> indicated that UE was camped on a CSG or Hybrid cell.
>
> \- CSG ID: If the UE is camping on a CSG or Hybrid cell in the Allowed CSG
> list or the Operator CSG list, this data object shall be present, and shall
> contain CSG id of the current serving CSG or Hybrid cell. In all other cases
> this data object shall not be present.
>
> \- HNB name: If the UE is camping on a CSG or Hybrid cell in the Allowed CSG
> list or the Operator CSG list and the HNB name of the cell is available in
> the broadcasted information to the ME, this data object shall be present,
> and shall contain the broadcasted HNB name of the current serving CSG or
> Hybrid cell. In all other cases this data object shall not be present.
>
> \- PLMN ID: If the UE is camping on a CSG or Hybrid cell that is listed in
> the Allowed CSG list or the Operator CSG list, this data object may be
> present, and, if present, shall contain the PLMN identity of the current
> serving CSG or Hybrid cell.
Response parameters/data: None for this type of ENVELOPE command.
### 7.5.3A Call disconnected event
#### 7.5.3A.1 Procedure
See ETSI TS 102 223 [32] clause 7.5.3.1.
#### 7.5.3A.2 Structure of ENVELOPE (EVENT DOWNLOAD - call disconnected)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O/C Min Length Event download tag 9.1 M Y 1 Length
(A+B+C+D+E+F) - M Y 1 or 2 Event list 8.25 M Y A Device identities 8.7 M Y B
Transaction identifier 8.28 M Y C Cause 8.26 O N D Media Type 8.132 C N E IMS
call disconnection cause 8.133 O N F
* * *
Event list: the event list object shall contain only one event (value part of
length 1 byte), and the ME shall set the event to:
\- call disconnected.
Device identities:
\- in the case of \"near end\" disconnection, the ME shall set the device
identities to:
\- source: ME;
\- destination: UICC.
\- in the case of \"far end\" disconnection, the ME shall set the device
identities to:
\- source: network;
\- destination: UICC.
Transaction identifier: the transaction identifier data object shall contain a
list of the transaction identifiers for each of the calls being disconnected.
Cause: the cause shall reflect the cause information element sent or received
in the disconnect message triggering the ENVELOPE command. If the cause
information element was not present in the message, or the cause data object
shall not be included. In the case of a radio link timeout, the cause data
object shall be included, with a value part of zero length.
Media Type: The Media Type indicates the type of media of the call session and
shall be coded as defined in clause 8.132. The Media Type data object shall be
present if the \"Media Type support\" service is allocated and activated in
the USIM or ISIM Service Table.
IMS call disconnection cause: The IMS call disconnection cause shall reflect
the Reason header field in the SIP message triggering the ENVELOPE command. If
the Reason header field is not present in the SIP message, the IMS call
disconnection cause data object shall not be included. The cause and
corresponding protocol shall not be present in the ENVELOPE command within a
corresponding IMS call disconnection cause data object if the \"IMS call
disconnection cause\" service is neither allocated and activated in the USIM
nor ISIM Service Table.
Response parameters/data:
\- none.
### 7.5.4 Location status event
See ETSI TS 102 223 [32] clause 7.5.4.
If a location status is already available in the UE when the UICC supplies an
event list with location status event (by using the SET UP EVENT LIST
command), the ME shall immediately send the ENVELOPE (EVENT DOWNLOAD -
location status) command (after the TERMINAL RESPONSE), providing the Location
status and the Location information.
### 7.5.5 User activity event
See ETSI TS 102 223 [32] clause 7.5.5.
### 7.5.6 Idle screen available event
See ETSI TS 102 223 [32] clause 7.5.6.
### 7.5.7 Card reader status event
See ETSI TS 102 223 [32] clause 7.5.7.
### 7.5.8 Language selection event
See ETSI TS 102 223 [32] clause 7.5.8.
### 7.5.9 Browser termination event
See ETSI TS 102 223 [32] clause 7.5.9.
### 7.5.10 Data available event
See ETSI TS 102 223 [32] clause 7.5.10.
### 7.5.11 Channel status event
See ETSI TS 102 223 [32] clause 7.5.11.
### 7.5.12 Access Technology Change Event
See ETSI TS 102 223 [32] clause 7.5.12.
If a access technology is already available in the UE when the UICC supplies
an event list with Access Technology Change event (by using the SET UP EVENT
LIST command), the ME shall immediately send the ENVELOPE (EVENT DOWNLOAD -
Access Technology Change) command (after the TERMINAL RESPONSE), providing the
Access Technology.
### 7.5.13 Display parameters changed event
See ETSI TS 102 223 [32] clause 7.5.13.
### 7.5.14 Local Connection event
See ETSI TS 102 223 [32] clause 7.5.14.
### 7.5.15 Network Search Mode Change Event
See ETSI TS 102 223 [32] clause 7.5.15.
### 7.5.16 Browsing status event
See ETSI TS 102 223 [32] clause 7.5.16.
### 7.5.17 Frames Information changed event
See ETSI TS 102 223 [32] clause 7.5.17.
### 7.5.18 HCI connectivity event
Not required by 3GPP.
### 7.5.19 Contactless state request
Not required by 3GPP.
### 7.5.20 Incoming IMS Data event
The following clauses apply if classes \"e\" and \"t\" are supported.
#### 7.5.20.1 Procedure
If the Incoming IMS data event is part of the current event list (as set up by
the last SET UP EVENT LIST command, see ETSI TS 102 223 [32]), then, in the
case of an incoming IMS message to an IARI (see TS 24.229 [52]) associated to
an application installed on the UICC and no open channel is available for IMS
communication, see 3GPP TS 31.102 [14], the terminal shall inform the UICC
that this has occurred, by using the ENVELOPE (EVENT DOWNLOAD -- Incoming IMS
data) command as defined below.
#### 7.5.20.2 Structure of ENVELOPE (EVENT DOWNLOAD -- Incoming IMS Data)
Direction : ME to UICC
The command header is specified in TS 31.101 [13]
Command parameters/data
* * *
Description Clause M/O Min Length Event download tag 9.1 M Y 1 Length A+B+G -
M Y 1 or 2 Event list 8.25 M Y A Device identities 8.7 M Y B IARI 8.110 M Y G
* * *
\- Event list: the Event list data object shall contain only one event (value
part of length 1 byte), and terminal shall set the event to:
\- Incoming IMS Data event.
\- Device identities: the terminal shall set the device identities to:
\- source: Network;
\- destination: UICC.
\- IARI: This data object contains the IARI included in the Accept-Contact
(see TS 24.229 [52]) header field of the incoming SIP INVITE IMS message
destined for the UICC.
Response parameters/data: None for this type of ENVELOPE command.
### 7.5.21 IMS Registration Event
The following clauses apply if classes \"e\" and \"t\" are supported.
#### 7.5.21.1 Procedure
If the IMS Registration event is part of the current event list (as set up by
the last SET UP EVENT LIST command, see ETSI TS 102 223 [32]) and the SIP
REGISTER message contains the IARIs defined in EF-UICCIARI, then, upon
receiving the 200 OK (see 3GPP TS 24.229 [52]) message in response to the SIP
REGISTER message (see 3GPP TS 24.229 [52]) or upon receiving any status code
(see 3GPP TS 24.229 [52]) indicating a failure in response to the SIP REGISTER
message, the terminal shall inform the UICC that this event has occurred, by
using the ENVELOPE (EVENT DOWNLOAD -- IMS Registration) command as defined
below.
#### 7.5.21.2 Structure of ENVELOPE (EVENT DOWNLOAD -- IMS Registration)
Direction : ME to UICC
The command header is specified in TS 31.101 [13]
Command parameters/data
* * *
Description Clause M/O/C Min Length Event download tag 9.1 M Y 1 Length
(A+B+C) or (A+B+D) - M Y 1 or 2 Event list 8.25 M Y A Device identities 8.7 M
Y B IMPU list 8.111 C Y C IMS status code 8.112 C Y D
* * *
\- Event list: the Event list data object shall contain only one event (value
part of length 1 byte), and terminal shall set the event to:
\- IMS Registration Event.
\- Device identities: the terminal shall set the device identities to:
\- source: Network;
\- destination: UICC.
\- IMPU list: This data object shall contain the list of IMPUs built from the
URIs from the aor (address of record) attributes for which within the same
registration element at least one of the ME\'s contact URIs has the status
\"active\" (see RFC 3680 [55]) received in the registration event package (see
3GPP TS 24.229 [52]) of the SIP NOTIFY request. This data object shall only be
present in the case of a successful registration. If the network indicates,
using the SIP NOTIFY request containing the registration event package, that
there are no aor attributes that for which within the same registration
element at least one of the ME\'s contact URIs has the status \"active\" then
the ME shall send an empty list of IMPUs to the UICC.
\- Status Code: This data object shall contain the Status-code (see 3GPP TS
24.229 [52]) received from the IMS network in response to a SIP REGISTER
message. This data object shall only be present to indicate that a failure
occurred during an IMS registration.
Response parameters/data: None for this type of ENVELOPE command.
### 7.5.22 Profile Container
Not required by 3GPP.
### 7.5.23 Envelope Container
Not required by 3GPP.
### 7.5.24 Poll Interval Negotiation
See ETSI TS 102 223 [32] clause 7.5.22.
### 7.5.25 Data Connection Status Change Event
#### 7.5.25.1 Procedure
This and the following clauses apply if class \"e\" is supported.
If the Data Connection Status Change event is part of the current event list
(as set up by the last SET UP EVENT LIST command, see clause 8.25 of this
document), then, upon detection by the ME of a change in the data connection
status, the terminal shall inform the UICC that this event has occurred, by
using the ENVELOPE (EVENT DOWNLOAD -- Data Connection Status Change) command
as defined below.
#### 7.5.25.2 Structure of ENVELOPE (EVENT DOWNLOAD -- Data Connection Status
Change)
Direction: ME to UICC
The command header is specified in TS 31.101 [13].
Command parameters/data
* * *
Description Clause M/O/C Min Length Event download tag 9.1 M Y 1 Length
(A+B+C+D+E+F+G+H+I+J+K+L+M) - M Y 1 or 2 Event list 8.25 M Y A Device
identities 8.7 M Y B Data connection status 8.137 M Y D Data connection type
8.138 M Y E (E/5G)SM cause 8.139 C Y F Transaction identifier 8.28 M Y G Date-
Time and Time zone 8.39 C Y H Location Information 8.19 C Y I Access
Technology 8.62 C Y J Location status 8.27 M Y K Network Access Name 8.61 C Y
L PDP/PDN/PDU type 8.142 C Y M
* * *
\- Event list: the Event list data object shall contain only one event (value
part of length 1 byte), and the ME shall set the event to:
\- Data Connection Status Change.
\- Device identities: the terminal shall set the device identities to:
\- source: Network for network originated messages. ME for ME originated
messages;
\- destination: UICC.
\- Data connection status: This data object shall contain the status of the
data connection.
\- Data connection type: This data object shall contain the type of data
connection.
\- (E/5G)SM cause: If an (E/5G)SM cause is available, this data object shall
contain either the SM cause as defined in 3GPP TS 24.008 [9] or the ESM cause
as defined in 3GPP TS 24.301 [46], or the 5GSM cause as defined in 3GPP TS
24.501 [70].
\- Transaction identifier: The Transaction identifier data object shall
contain one transaction identifier as defined in clause 8.28.
\- Date-Time and Time zone: If the date-time and time zone information is
available in the ME, this data object is mandatory and shall contain the Date-
Time and Time zone at the ME detected moment of occurrence of the event.
\- Location Information: This data object contains the identification (MCC,
MNC, LAC/TAC, Cell Identity) of the current serving cell of the UE. The
comprehension required flag of this data object in this command shall be set
to \'0\'. This data object shall be present if the data connection is
performed over GERAN, UTRAN, E-UTRAN or NG-RAN.
\- Access Technology: This data object shall contain the access technology of
the rejecting or accepting network.
\- Location Status: This data object indicates the current service state of
the terminal.
\- Network Access Name: This data object shall contain the Access Point Name
value present in the Activate PDP context request (for a PDP context
activation, as defined in TS 24.008 [9]) or the PDN connectivity request (for
an EPS PDN connection activation, as defined in TS 24.301 [46]), or it shall
contain the Data Network Name value present in the UL NAS TRANSPORT message
for PDU Session Establishment request, as defined TS 24.501 [70]. It is
present only when Data connection status is either successful or rejected.
\- PDP/PDN/PDU type: This data object shall contain the PDP/PDN/PDU type
requested in the Activate PDP context request (for a PDP context activation,
as defined in TS 24.008 [9]) or the PDN connectivity request (for an EPS PDN
connection activation, as defined in TS 24.301 [46]), or the PDU Session
Establishment request (as defined in TS 24.501 [70]). It is present only when
Data connection status is either successful or rejected.
Response parameters/data: None for this type of ENVELOPE command.
## 7.6 USSD Data Download
This clause applies if class \"p\" is supported.
### 7.6.1 Procedure
If the service \"data download via USSD and USSD application mode\" is
allocated and activated in the USIM Service Table (see TS 31.102 [14]), then
the ME shall follow the procedure below:
\- When the ME receives a USSD packet it shall pass the message transparently
to the USIM using the ENVELOPE (USSD DOWNLOAD) if the Data Coding Scheme of
the USSD message (as defined for the CBS Data Coding Scheme in TS 23.038 [4])
indicate the USIM as the target (Bit 0 set to 0 and Bit 1 set to 1):
\- The ME shall wait for an acknowledgement from the USIM:
\- if the UICC responds with \'90 00\', the ME shall acknowledge the receipt
of USSD message to the network using a FACILITY message. The ME will supply
the response data from the UICC in the USSD String of the return result
component of the FACILITY message it will send back to the network (see TS
24.090 [37]). The alphabet and language indicators shall be those used in the
original message.
\- if the USIM responds with \'93 00\', the ME shall either retry the command
or send back a FACILITY message to the network. The ME will supply the status
word followed by the response data from the UICC in the USSD String of the
return result component of the FACILITY message it will send back to the
network (see TS 24.090 [37]). The alphabet and language indicators shall be
those used in the original message.
\- if the UICC responds with \'62 XX\' or \'63 XX\', the ME shall acknowledge
the receipt of the USSD message to the network using a FACILITY message. The
ME will supply the status word followed by the response data from the UICC in
the USSD String of the return result component of the FACILITY message it will
send back to the network (see TS 24.090 [37]). The alphabet and language
indicators shall be those used in the original message.
If the service \"data download via USSD and USSD application mode \" is not
allocated and activated in the USIM Service Table, and the ME receives a USSD
message with a Data Coding Scheme indicating that the destination is the card
(as defined above), the ME shall return a FACILITY message to the network. The
ME will supply the status word \'6D 00\' (i.e. Instruction code not supported
or invalid) in the USSD String of the return result component of the FACILITY
message it will send back to the network (see TS 24.090 [37]). The alphabet
and language indicators shall be those used in the original message.
### 7.6.2 Structure of ENVELOPE (USSD Data Download)
Direction: ME to UICC
The command header is specified in TS 31.101 [13].
Command parameters/data:
* * *
**Description** **Clause** **M/O** **Min** **Length** USSD Download tag 9.1 M
Y 1 Length (A+B) - M Y 1 or 2 Device identities 8.7 M Y A USSD string 8.17 M Y
B
* * *
\- Device identities: the ME shall set the device identities to:
Source: Network
Destination: UICC
Response parameters/data:
It is permissible for the UICC not to provide response data. If the UICC
provides response data, the following data is returned.
* * *
**Byte(s)** **Description** **Length** 1‑X (X182) UICC response X
* * *
## 7.7 MMS Transfer Status
See ETSI TS 102 223 [32] clause 7.6.
## 7.8 MMS notification download
See ETSI TS 102 223 [32].
Considering the addressing mechanism to the UICC indicated in ETSI TS 102 223
[32] clause 7.7, the UICC shall be targeted using the following application
identifier: \"uicc.3gpp.org\".
## 7.9 Terminal Applications
See ETSI TS 102 223 [32] clause 7.8.
## 7.10 Geographical Location Reporting
### 7.10.1 Procedure
This clause applies if class \"n\" is supported.
If the ME has processed the proactive command \"Geographical Location
Request\" successfully, then the ME shall send the ENVELOPE (Geographical
Location Reporting).
It is acceptable for the ME to send the envelope even if the requested
accuracy has not been achieved.
Note: some GAD Shapes contain the actual accuracy.
If positioning data cannot be provided, the envelope command shall neither
include the GAD shape TLV nor the NMEA-sentence TLV.
If positioning data can be provided, the envelope command shall include either
a GAD shape TLV or a NMEA-sentence TLV. The information sent by the ME is
deemed fresh.
### 7.10.2 Structure of ENVELOPE (Geographical Location Reporting)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
* * *
Description Clause M/O/C Min Length Geographical Location Reporting tag 9.1 M
Y 1 Length (A or A+B or A+C) - M Y 1 or 2 Device identities 8.7 M Y A GAD
shape 8.95 C N B NMEA sentence 8.96 C N C
* * *
\- Device identities: the ME shall set the device identities to:
\- source: ME;
\- destination: UICC.
\- GAD shape: This data object contains the location information.
\- NMEA sentence: This data object contains the location information.
Response parameters/data: None for this type of ENVELOPE command.
## 7.11 Void
## 7.12 ProSe usage information reporting
### 7.12.1 Procedure
If the service \"ProSe Usage Information Reporting configuration\" and service
\"UICC ProSe Direct Communication usage information reporting\" are allocated
and activated in the ProSe Service Table (see TS 31.102 [14]), then a ProSe-
enabled Public Safety ME that supports \"ProSe usage information reporting\"
shall store the ProSe usage information to be sent over the PC3ch interface
(see 3GPP TS 24.334 [61]) in the UICC. This is performed using the ENVELOPE
(ProSe Report).
A UICC supporting the \"ProSe usage information reporting\" shall also support
BIP. The UICC is responsible to transmit the collected reports to the ProSe
Function CTF (ADF) using BIP mechanism, following the same procedure described
in TS 24.334 [61] clause 10.3.1 and using the communication security described
in TS 24.334 [61] clause 4.1. The address of the ProSe Function CTF (ADF) is
available in the EF~PROSE_UIRC~ (see TS 31.102 [14]).
The UICC shall store the received ProSe usage information until a
USAGE_INFORMATION_REPORT_LIST_RESPONSE is received with transaction ID set to
the value of the transaction ID included in the USAGE_INFORMATION_REPORT_LIST
message.
If one envelope is not enough to transmit all the information (i.e. the ProSe
usage information is more than 243 bytes), the information shall be split into
several ENVELOPE (ProSe Report). The final envelope is indicated by containing
a Last Envelope TLV. Intermediate envelopes shall not contain this TLV.
If one envelope is enough to transmit the information, this envelope shall
contain a Last Envelope TLV.
NOTE: If the usage information report list sending procedure is unsuccessfully
completed, the USIM behaviour is according to what is specified for the UE in
3GPP TS 24.334 [61], clause 10.3.2.1.6.
### 7.12.2 Structure of ENVELOPE (ProSe Report)
Direction: ME to UICC.
The command header is specified in TS 31.101 [13].
Command parameters/data.
Description Clause M/O/C Min Length
* * *
ProSe Report tag 9.1 M Y 1 Length (A or A+B or A+C) - M Y 1 or 2 Device
identities 8.7 M Y A ProSe Report 8.128 M Y B Last Envelope 8.79 C N C
\- Device identities: the ME shall set the device identities to:
\- source: ME;
\- destination: UICC.
\- ProSe Report Data: This data object contains the ProSe Report.
\- Last Envelope: Indicates that the last information concerning the ProSe
Report has been sent.
Response parameters/data: None for this type of ENVELOPE command.
The UICC may respond with status word \'69 82\' if the PIN verification has
not been performed successfully.
NOTE: The handling of the case where the USIM cannot process the ENVELOPE
command (e.g. when there is not enough memory for storing a ProSe Report) is
implementation-specific.
# 8 COMPREHENSION-TLV data objects
The coding of the TLV objects is as described in ETSI TS 102 223 [32] clause
8, except when stated otherwise in the present document.
## 8.1 Address
See ETSI TS 102 223 [32] clause 8.1.
## 8.2 Alpha identifier
See ETSI TS 102 223 [32] clause 8.2.
## 8.3 Subaddress
See ETSI TS 102 223 [32] clause 8.3.
## 8.4 Capability configuration parameters
* * *
**Byte(s)** **Description** **Length** 1 Capability configuration parameters
tag 1 2 to (Y‑1)+2 Length (X) Y (Y‑1)+3 to (Y‑1)+X+2 Capability configuration
parameters X
* * *
Capability configuration parameters are coded as for EF~CCP~. If it is being
provided by the UICC, the UICC shall supply all information required to
complete the Bearer Capability Information Element in the Call Set-up message
(see TS 24.008 [9]). Any unused bytes at the end of the value part shall be
coded \'FF\'.
See TS 31.102 [14] for the coding of all Efs.
NOTE: The second byte of this TLV contains the Length of the TLV and the third
byte contains the Length of the bearer capability contents, followed by the
actual contents.
## 8.5 Cell Broadcast Page
* * *
Byte(s) Description Length 1 Cell Broadcast page tag 1 2 Length = \'58\' (88
decimal) 1 3 - 90 Cell Broadcast page 88
* * *
The Cell Broadcast page is formatted in the same way as the GSM Cell Broadcast
Message Parameter, as described in TS 23.041 [6].
## 8.6 Command details
The content and the coding of the Command Details TLV object is defined in
ETSI TS 102 223 [32] clause 8.6, except for the following.
The coding of the Command Qualifier is defined for the following commands:
\- SEND SS:
this byte is RFU.
\- SEND USSD:
this byte is RFU.
\- PROVIDE LOCAL INFORMATION.
The following additional values are defined:
\'00\' = Location Information (MCC, MNC, LAC/TAC, Cell Identity and Extended
Cell Identity).
\'02\' = Network Measurement results.
\'05\' = Timing Advance.
\'0C\' = current WSID.
\'11\' = CSG ID list and corresponding HNB name.
\'12\' = H(e)NB IP address.
\'13\' = H(e)NB surrounding macrocells.
\'14\' = current WLAN identifier.
\'15\' to \'19\' = reserved for 3GPP (for future usage)
The following values do not apply
\'07\' = Reserved by ETSI (ESN)
\'0B\' = Reserved by ETSI (MEID)
\- REFRESH. The following additional values are defined:
\'07\' = Steering of Roaming as defined in TS 23.122 [7].
\'08\' = Steering of Roaming for I-WLAN as defined in TS 24.234 [42].
\- Geographical Location Request:
this byte is RFU.
> \- OPEN CHANNEL related to CS bearer, GPRS/UTRAN packet service/ E-UTRAN/NG-
> RAN, local bearer, Default (network) bearer, I-WLAN bearer, WLAN bearer,
> Terminal Server Mode, UICC Server Mode:
>
> \- As defined in ETSI TS 102 223 [32]
\- OPEN CHANNEL for IMS:
this byte is RFU
## 8.7 Device identities
See ETSI TS 102 223 [32] clause 8.7.
## 8.8 Duration
See ETSI TS 102 223 [32] clause 8.8.
## 8.9 Item
See ETSI TS 102 223 [32] clause 8.9.
## 8.10 Item identifier
See ETSI TS 102 223 [32] clause 8.10.
## 8.11 Response length
See ETSI TS 102 223 [32] clause 8.11.
## 8.12 Result
For the general result byte coding the following values are defined in
addition to or replacement of those in ETSI TS 102 223 [32] clause 8.12:
\- \'14\' = USSD or SS transaction terminated by the user
\- \'34\' = SS Return Error;
\- \'35\' = SMS RP-ERROR;
\- \'37\' = USSD Return Error;
\- \'39\' = Interaction with call control by USIM or MO short message control
by USIM, permanent problem;
In addition, the following values are reserved for 3GPP for future usage:
\- \'15\' = reserved for 3GPP (for future usage);
\- \'16\' = reserved for 3GPP (for future usage);
\- \'28\' = reserved for 3GPP (for future usage);
\- \'29\' = reserved for 3GPP (for future usage);
\- \'3E\' = reserved for 3GPP (for future usage);
\- \'3F\' = reserved for 3GPP (for future usage);
Additional information:
Contents:
\- For the general result \"Command performed successfully\", some proactive
commands require additional information in the command result. This is defined
in the clauses below. For the general result values \'20\', \'21\', \'34\',
\'35\', \'37\', and \'39\', it is mandatory for the ME to provide a specific
cause value as additional information, as defined in the clauses below. For
other values, see ETSI TS 102 223 [32] clause 8.12.
### 8.12.1 Additional information for SEND SS
When the ME issues a successful general result for a SEND SS proactive
command, it shall also include the Operation Code and Parameters included in
the Return Result component from the network, as additional information.
The first byte of the additional information shall be the SS Return Result
Operation code, as defined in TS 24.080 [11].
The rest of the additional information shall be the SS Return Result
Parameters, as defined in TS 24.080 [11].
### 8.12.2 Additional information for ME problem
For the general result \"ME currently unable to process command\", it is
mandatory for the ME to provide additional information, the first byte of
which to be as defined in ETSI TS 102 223 [32] clause 8.12.2, with the
addition of the following value:
\- \'03\' = ME currently busy on SS transaction;
\- \'08\' = ME currently busy on USSD transaction.
### 8.12.3 Additional information for network problem
For the general result \"network currently unable to process command\", it is
mandatory for the ME to provide additional information. The first byte shall
be the cause value of the Cause information element returned by the network
(as defined in TS 24.008 [9]). Bit 8 shall be set to \'1\'. One further value
is defined:
\- \'00\' = No specific cause can be given.
All other values shall be interpreted by the UICC as \'00\'. The coding \'00\'
shall only be used by the ME if no others apply.
### 8.12.4 Additional information for SS problem
For the general result \"SS Return Error\", it is mandatory for the ME to
provide additional information. The first byte shall be the error value given
in the Facility (Return Error) information element returned by the network (as
defined in TS 24.080 [11]). One further value is defined:
\- \'00\' = No specific cause can be given.
All other values shall be interpreted by the UICC as \'00\'. The coding \'00\'
shall only be used by the ME if no others apply.
### 8.12.5 Additional information for SMS problem
For the general result \"SMS RP-ERROR\", it is mandatory for the ME to provide
additional information. The first byte shall be the cause value given in the
RP-Cause element of the RP-ERROR message returned by the network (as defined
in TS 24.011 [10]), with bit 8 = 0. One further value is defined:
\- \'00\' = No specific cause can be given.
All other values shall be interpreted by the UICC as \'00\'. Specific cause
\'00\' shall only be used by the ME if no others apply.
### 8.12.6 Not used
### 8.12.7 Additional information for USSD problem
For the general result \"USSD Return Error\", the ME shall provide additional
information. The first byte shall be the error value given in the Facility
(Return Error) information element returned by the network (as defined in TS
24.080 [11]). One further value is defined:
\- \'00\' = No specific cause can be given.
All other values shall be interpreted by the UICC as \'00\'.
The coding \'00\' shall only be used by the ME if no others apply.
### 8.12.8 Additional information for interaction with call control or MO SM
control
For the general result \"interaction with call control by USIM or MO short
message control by USIM, permanent problem\", it is mandatory for the ME to
provide additional information, the first byte of which to be as defined
below:
\- \'00\' = No specific cause can be given;
\- \'01\' = Action not allowed;
\- \'02\' = The type of request has changed.
All other values shall be interpreted by the UICC as \'00\'. The coding \'00\'
shall only be used by the ME if no others apply.
### 8.12.9 Additional information for MultipleCard commands
See ETSI TS 102 223 [32] clause 8.12.9.
### 8.12.10 Additional information for launch browser problem
See ETSI TS 102 223 [32] clause 8.12.10.
### 8.12.11 Additional information for Bearer Independent Protocol
See ETSI TS 102 223 [32] clause 8.12.11.
### 8.12.12 Additional information for Frames commands
See ETSI TS 102 223 [32] clause 8.12.12.
### 8.12.13 Additional information for SUBMIT and RETRIEVE MULTIMEDIA MESSAGE
See ETSI TS 102 223 [32] clause 8.12.13.
## 8.13 SMS TPDU
* * *
Byte(s) Description Length 1 SMS TPDU tag 1 2 to (Y‑1)+2 Length (X) Y (Y‑1)+3
to (Y‑1)+X+2 SMS TPDU X
* * *
The TPDU is formatted as described in TS 23.040 [5].
Where the TPDU is being sent from the UICC to the ME (to be forwarded to the
network), and where it includes a TP-Message-Reference which is to be
incremented by the ME for every outgoing message, the TP-Message-Reference as
provided by the UICC need not be the valid value. TP-Message-Reference shall
be checked and corrected by the ME to the value described in TS 23.040 [5].
## 8.14 SS string
* * *
Byte(s) Description Length 1 SS string tag 1 2 to (Y‑1)+2 Length (X) Y (Y‑1)+3
TON and NPI 1 (Y‑1)+4 to (Y‑1)+X+2 SS or USSD string X - 1
* * *
TON/NPI and SS or USSD control string are coded as for EF~ADN~, where the ADN
record relates to a Supplementary Service Control string. See TS 31.102 [14]
for the coding of EF~ADN~.
## 8.15 Text string
Content and coding is defined ETSI TS 102 223 [32] clause 8.15, with the
following requirement:
Data coding scheme is coded as for SMS Data coding scheme defined in TS 23.038
[4]. Parts of the data coding scheme other than the character set indication
shall be ignored.
## 8.16 Tone
See ETSI TS 102 223 [32] clause 8.16.
NOTE: Standard supervisory tones for 3G are specified in TS 22.001 [22].
## 8.17 USSD string
* * *
Byte(s) Description Length 1 USSD string tag 1 2 to (Y-1)+2 Length (X) Y
(Y-1)+3 Data coding scheme 1 (Y-1)+4 to (Y-1)+X+2 USSD string X-1
* * *
The Data coding scheme is coded as for Cell Broadcast defined in TS 23.038
[4]. The coding of the USSD string is defined in TS 22.030 [2].
NOTE 1: The MMI mode uses a 7 bit character set, the Application mode uses a 8
bit character set.
NOTE2: The DCS is set to 0x96 to indicate that the USSD string is formatted
according to TS 31.115 [41].
## 8.18 File List
See ETSI TS 102 223 [32] clause 8.18.
## 8.19 Location Information
### 8.19.1 Location Information for GERAN
* * *
Byte(s) Description Length 1 Location Information tag 1 2 Length = \'07\' or
\'05\' (see Note) 1 3 -- 5 Mobile Country & Network Codes (MCC & MNC) 3 6 -- 7
Location Area Code (LAC) 2 8 -- 9 Cell Identity Value (Cell ID) (see Note) 2
NOTE: When this object is used in the Network Rejection event download, the
Cell Identity Value (Cell ID) field shall not be present and the length field
shall be set to \'05\'.
* * *
The Mobile Country Code (MCC), the Mobile Network Code (MNC) and the Location
Area Code (LAC) are coded as in TS 24.008 [9].
For GERAN, the Cell Identity Value is coded as in TS 24.008 [9].
### 8.19.2 Location Information for UTRAN
Byte(s) Description Length
* * *
1 Location Information tag 1 2 Length = \'09\' or \'05\' (see Note) 1 3 -- 5
Mobile Country & Network Codes (MCC & MNC) 3 6 -- 7 Location Area Code (LAC) 2
8 -- 9 Cell Identity Value (Cell ID) (see Note) 2 10 -- 11 Extended Cell
identity Value (see Note) 2 NOTE: When this object is used in the Network
Rejection event download, the Cell Identity Value (Cell ID) and Extended Cell
identity Value fields shall not be present and the length field shall be set
to \'05\'.
The Mobile Country Code (MCC), the Mobile Network Code (MNC) and the Location
Area Code (LAC) are coded as in TS 24.008 [9].
Only the C-id part of the UC-id is returned in the Cell Identity Value (i.e.
the 16 least significant bits of the UC-id), as defined in TS 25.401 [35] and
TS 25.413 [36].
The Extended Cell identity Value is coded as the RNC-id part of the UC-id, as
defined in TS 25.401 [35] and TS 25.413 [36]. It is left padded with zeros
(this means that byte 10 contains the 4 most significant bits of the RNC-id
value, and byte 11 contains the 8 least significant bits of the RNC-id value).
### 8.19.3 Location Information for E-UTRAN
Byte(s) Description Length
* * *
1 Location Information tag 1 2 Length = \'09\' or \'05\' (see Note) 1 3 -- 5
Mobile Country & Network Codes (MCC & MNC) 3 6 -- 7 Tracking Area Code (TAC) 2
8 -- 11 E-UTRAN Cell Identifier (ECI) (see Note) 4 NOTE: When this object is
used in the Network Rejection event download, the E-UTRAN Cell Identifier
(ECI) field shall not be present and the length field shall be set to \'05\'.
The Mobile Country Code (MCC), the Mobile Network Code (MNC) is coded as in TS
24.008 [9].
The Tracking Area Code (TAC) for E-UTRAN is coded in 2 bytes as specified in
TS 24.301 [46].
The E-UTRAN Cell Identifier (ECI) is coded as defined in TS 36.401 [48]. ECI
has a length of 28 bits. The most significant bit of ECI is coded on the most
significant bit of byte 8. The least significant bit of ECI is coded on the
4^th^ bit of byte 11. The 4 least significant bits of byte 11 shall be set to
1.
### 8.19.4 Location Information for NG-RAN
Byte(s) Description Length
* * *
1 Location Information tag 1 2 Length = \'0B\' or \'03\' (see Note) 1 3 -- 5
Mobile Country & Network Codes (MCC & MNC) 3 6 -- 8 Tracking Area Code (TAC)
(see Note) 3 9 -- 13 NR Cell Identifier (NCI) (see Note) 5 NOTE: When this
object is used in the Network Rejection event download, the Tracking Area Code
(TAC) and the NR Cell Identifier (NCI) fields shall not be present and the
length field shall be set to \'03\'.
The Mobile Country Code (MCC), the Mobile Network Code (MNC) is coded as in TS
24.008 [9].
The Tracking Area Code (TAC) for NG-RAN is coded in 3 bytes as specified in TS
24.501 [70]. The most significant bit of TAC is coded on the most significant
bit of byte 6. The least significant bit of TAC is coded on the least
significant bit of byte 8.
NR Cell Identifier (NCI) Value is coded on 36 bits as referenced in TS 38.413
[69] clause 9.3.1.7. The most significant bit of NCI is coded on the most
significant bit of byte 9. The least significant bit of NCI is coded on the
4^th^ bit of byte 13. The 4 least significant bits of byte 13 shall be set to
1.
### 8.19.5 Location Information when no surrounding macrocell is detected
When PROVIDE LOCAL INFORMATION with command qualifier \'13\' is used and no
surrounding macrocell is detected for an Access Technology, a location
information data object with length set to \'00\' shall be present.
Byte(s) Description Length
* * *
1 Location Information tag 1 2 Length = \'00\' 1
## 8.20 IMEI
See ETSI TS 102 223 [32] clause 8.20.
## 8.21 Help Request
See ETSI TS 102 223 [32] clause 8.21.
## 8.22 Network Measurement Results
* * *
Byte(s) Description Length 1 Network Measurement Results tag 1 2 Length (X) of
bytes following 1 3 -- to X+2 Network Measurement Results X
* * *
For GERAN: The Network Measurement Results are coded as for the Measurement
Results information element in TS 44.018 [27], starting at octet 2 (the IEI is
removed, as this information is duplicated by the data object tag). The Length
shall be set to \'10\' (16 decimal).
For UTRAN: The Network Measurement Results are coded as for the
\"MeasurementReport\" information element as defined in the ASN.1 description
of TS 25.331 [38], according to the following:
\- The \"Measurement identity\" field in the MEASUREMENT REPORT shall be set
to the value \'1\'.
\- If \"intra-frequency measurements\" are requested by USIM, the ME shall, in
the MEASUREMENT REPORT, include IE \"Intra-frequency measured results list\"
in IE \"Measured Results\". The ME shall report CPICH Ec/No, CPICH RSCP and
pathloss for the up to 6 strongest (highest Ec/No value) intra-frequency
cells, if available in the ME according to TS 25.331 [38] and TS 25.133 [39].
\- If \"inter-frequency measurements\" are requested by USIM, the ME shall, in
the MEASUREMENT REPORT, include IE \"inter-frequency measured results list\"
in IE \"Measured Results\". The ME shall report CPICH Ec/No, CPICH RSCP and
pathloss for the up to 6 strongest (highest Ec/No value) inter-frequency cells
per monitored frequency, if available in the ME according to TS 25.331 [38]
and TS 25.133 [39].
\- If \"inter-RAT (GERAN) measurements\" are requested by USIM, the ME shall,
in the MEASUREMENT REPORT, include IE \"inter-RAT measured results list\" in
IE \"Measured Results\". The ME shall report GSM carrier RSSI for the up to 6
strongest (highest RSSI value) inter-RAT GSM cells (identified by the BCCH
ARFCN), if available in the ME according to TS 25.331 [38] and TS 25.133 [39].
\- If \"inter-RAT (E-UTRAN)\" are requested by USIM, the ME shall, in the
MEASUREMENT REPORT, include IE \"E-UTRA measured results\". The ME shall
report RSRP and RSRQ for the up to 4 strongest (highest RSRQ value) inter-RAT
E-UTRAN cells per monitored frequency, if available in the ME according to TS
25.331 [38] and TS 25.133 [39].
\- All other optional fields in the MEASUREMENT REPORT shall be set to be
absent.
For E-UTRAN:
Intra-frequency & inter-RAT (GERAN): the Network Measurement Results are coded
as for the _MeasurementReport_ information element as defined in the ASN.1
description of TS 36.331 [49], according to the following:
\- The \"measId\" field in the \"measResults\" shall be set to the value
\'1\'.
\- the ME shall include IE \"measResultServCell\" with RSRP and RSRQ of the
serving cell.
\- If \"intra-frequency measurements\" are requested by USIM, the ME shall, in
the _MeasurementReport_ , include IE \"measResultListEUTRA\" in IE
\"measResults\". The ME shall report RSRP, RSRQ, Physical Cell ID and IE
\"cgi-Info\" for the up to 8 strongest (highest RSRQ value) intra-frequency
cells, if available in the ME according to TS 36.331 [49] and TS 36.133 [50].
\- If \"inter-RAT (GERAN) measurements\" are requested by USIM, the ME shall,
in the _MeasurementReport_ , include IE \"measResultListGERAN\" in IE
\"measResults\". The ME shall report GERAN carrier RSSI and Physical Cell ID
for the up to 8 strongest (highest RSSI value) inter-RAT GERAN cells
(identified by the BCCH ARFCN) and IE \"cgi-Info\", if available in the ME
according to TS 36.331 [49] and TS 36.133 [50].
\- All other optional fields in the _MeasurementReport_ shall be set to be
absent.
> Inter-frequency & inter-RAT (UTRAN): the ME can send more than one Network
> Measurement Results TLV object, each containing the results of one
> frequency. Each Network Measurement Results shall include 2 bytes with the
> frequency value coded as the ARFCN-ValueEUTRA for inter-frequency
> measurements or as the ARFCN-ValueUTRA for inter-RAT (UTRAN) measurements as
> defined in TS 36.331 [49], followed by the _MeasurementReport_ information
> element as defined in the ASN.1 description of TS 36.331 [49], according to
> the following:
\- The \"measId\" field in the \"measResults\" shall be set to the value
\'1\'.
\- the ME shall include IE \"measResultServCell\" with RSRP and RSRQ of the
serving cell.
\- If \"inter-frequency measurements\" are requested by the USIM, the ME
shall, in the _MeasurementReport_ , include IE \" measResultListEUTRA\" in IE
\"measResults\". The ME shall report RSRP, RSRQ, Physical Cell ID and IE
\"cgi-Info\" for the up to 8 strongest (highest RSRQ value) inter-frequency
cells per monitored frequency, if available in the ME according to TS 36.331
[49] and TS 36.133 [50].
\- If \"inter-RAT (UTRAN) measurements\" are requested by the USIM, the ME
shall, in the _MeasurementReport_ , include IE \" measResultListUTRA\" in IE
\"measResults\". The ME shall report CPICH Ec/No, CPICH RSCP, Physical Cell ID
and IE \"cgi-Info\" for the up to 8 strongest (highest Ec/No value) inter-RAT
UTRAN cells per monitored frequency, if available in the ME according to TS
36.331 [49] and TS 36.133 [50].
\- All other optional fields in the _MeasurementReport_ shall be set to be
absent.
> For inter-frequency measurement results with EARFCN that exceeds maxEARFCN,
> the ME shall use the E-UTRAN Inter-frequency Network Measurement Results TLV
> objects if the service \"extended EARFCN\" is available in the USIM Service
> Table (see TS 31.102 [14]) or not include them otherwise.
>
> Inter-RAT (NR): the ME can send more than one Network Measurement Results
> TLV object, each containing the results of one frequency. Each Network
> Measurement Results shall include 4 bytes containing the frequency value
> coded as the ARFCN-ValueNR for inter-RAT (NR) measurements as defined in TS
> 36.331 [49], where the least significant byte of the frequency value is
> stored in the least significant byte of this 4 byte field and the unused
> bytes of these 4 byte field are set to 0, followed by the
> _MeasurementReport_ information element as defined in the ASN.1 description
> of TS 36.331 [49], according to the following:
\- The \"measId\" field in the \"measResults\" shall be set to the value
\'1\'.
\- the ME shall include IE \"measResultServCell\" with RSRP and RSRQ of the
serving cell.
\- If \"inter-RAT (NR) measurements\" are requested by the USIM, the ME shall,
in the _MeasurementReport_ , include IE \"measResultNeighCellListNR\" in IE
\"measResults\". The ME shall report Physical Cell ID, related RSRP,RSRQ and
SINR for the up to 8 strongest inter-RAT NR cells per monitored frequency, if
available in the ME according to TS 36.331 [49] and TS 36.133 [50].
> \- All other optional fields in the _MeasurementReport_ shall be set to be
> absent.
## 8.23 Default Text
See ETSI TS 102 223 [32] clause 8.23.
## 8.24 Items Next Action Indicator
See ETSI TS 102 223 [32] clause 8.24.
## 8.25 Event list
For the event list byte coding, the following value are defined in addition to
those in ETSI TS 102 223 [32] clause 8.25:
\- \'11\' = (I-)WLAN Access Status.
\- \'12\' = Network Rejection
\- \'15\' = CSG cell selection
\- \'17\' = IMS Registration
\- \'18\' = Incoming IMS data
\- \'1D\' = Data Connection Status Change
In addition, the following events are reserved for 3GPP for future usage:
\- \'1E\' = reserved for 3GPP (for future usage);
\- \'1F\' = reserved for 3GPP (for future usage);
\- \'20\' = reserved for 3GPP (for future usage);
\- \'21\' = reserved for 3GPP (for future usage);
\- \'22\' = reserved for 3GPP (for future usage);
## 8.26 Cause
* * *
Byte(s) Description Length 1 Cause tag 1 2 Length (X) of bytes following. X=0,
or 2 ≤ X ≤ 30. 1 3 to X+2 Cause X
* * *
The Cause data object is coded as for the Cause call control information
element in TS 24.008 [9], starting at octet 3 (the IEI and Length information
are removed, as this information is duplicated by the data object tag and
length).
Radio Link Timeout is indicated by the Cause data object having a value part
of zero length (only the Tag and Length components are sent).
## 8.27 Location status
See ETSI TS 102 223 [32] clause 8.27.
## 8.28 Transaction identifier
* * *
Byte(s) Description Length 1 Transaction identifier tag 1 2 Length (X) of
bytes following 1 3 to X+2 Transaction identifier list X
* * *
\- Transaction identifier list:
Contents:
\- A list of transaction identifiers, of variable length. Each byte in the
list defines a transaction identifier. Each transaction identifier shall not
appear more than once within the list;
Coding:
\- Each byte in the transaction identifier list shall be coded as defined
below:
bits 1 to 4 = RFU;
bits 5 to 7 = TI value;
bit 8 = TI flag.
If the terminal supports IMS:
\- TI value is an identifier generated by the terminal to uniquely identify
the call, regardless of the bearer of the call.
\- TI flag is:
\- Call connected event: \"1\"
\- MT Call event: \"0\"
\- Call disconnected event: \"0\" if caller disconnects the call, \"1\"
otherwise
If the terminal does not support IMS:
\- Call connected event: Transaction Identifier in the corresponding call
connect message
\- MT Call event: Transaction Identifier in the corresponding call setup
message from the network
\- Call disconnected event: Transaction Identifier in the corresponding
disconnect message triggering the ENVELOPE command, or in case of radio link
failure, the Transaction Identifier as in an ME initated disconnect message.
\- TI value and TI flag are coded as defined in TS 24.007 [8].
In case of Data Connection Status Change event, the transaction identifier is
encoded as:
\- TI value is an identifier generated by the terminal to uniquely identify
the PDP or PDN or PDU data connection, regardless of the bearer of the
connection.
\- TI flag is always 0 in this data connection transaction identifier.
## 8.29 BCCH channel list
This information is only available when the ME is connected to a GSM access
network.
* * *
Byte(s) Description Length 1 BCCH channel list tag 1 2 Length (X) of bytes
following 1 3 to X+2 BCCH channel list X
* * *
\- BCCH channel list:
Contents:
\- The list of absolute RF channels for BCCH carriers, as known by the ME from
the SYSTEM INFORMATION messages. The BCCH channel list is composed of one to
three BCCH channel sub lists, each sub list is derived from the set of
frequencies defined by reference neighbour cells description information
element or elements. In the latter case the set is the union of the different
subsets defined by the neighbour cells description information elements (see
TS 44.018 [27]). The length of the BCCH channel list field depends on the
length of the received BCCH channel list derived from the different SYSTEM
INFORMATION messages to be considered.
Coding:
\- Each ARFCN is represented by 10 bits. Spare bit(s) are to be filled with 0.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | | Bit 8 | Bit 7 | Bit 6 | Bit 5 | Bit 4 | Bit 3 | Bit 2 | Bit 1 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Byte | ARF | | | | | | | | | 1 | CN#1 | | | | | | | | | | (high | | | | | | | | | | part) | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Byte | ARF | ARF | | | | | | | | 2 | CN#1 | CN#2 | | | | | | | | | (low | (high | | | | | | | | | part) | part) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Byte | ARF | ARF | | | | | | | | 3 | CN#2 | CN#3 | | | | | | | | | (low | (high | | | | | | | | | part) | part) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | ... | ... | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Byte | ARFCN | ARF | | | | | | | | X-1 | #m-1 | CN#m | | | | | | | | | (low | (high | | | | | | | | | part) | part) | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Byte | ARF | Spare | Spare | | | | | | | X | CN#m | bit | bit | | | | | | | | (low | (0) | | | | | | | | | part) | | (0) | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
## 8.30 Call control requested action
* * *
Byte(s) Description Length 1 Call control requested action tag 1 2 to (Y-1)+2
Length (X) Y (Y-1)+3 to (Y-1)+X+2 Call control requested action X
* * *
\- Call control requested action:
Contents:
\- The action given in response to the ENVELOPE (CALL CONTROL). It may
contain, in the same order as given by the UICC, the address or SS string, the
capability configuration parameters, the called party sub-address and the
alpha identifier, or the IMS Request-URI;
Coding:
\- As described in clause 7.3.1.6, starting with the first optional element
given in the response data to the ENVELOPE (CALL CONTROL).
## 8.31 Icon Identifier
See ETSI TS 102 223 [32] clause 8.31.
## 8.32 Item Icon Identifier list
See ETSI TS 102 223 [32] clause 8.32.
## 8.33 Card reader status
See ETSI TS 102 223 [32] clause 8.33.
## 8.34 Card ATR
See ETSI TS 102 223 [32] clause 8.34.
## 8.35 C-APDU
See ETSI TS 102 223 [32] clause 8.35.
## 8.36 R-APDU
See ETSI TS 102 223 [32] clause 8.36.
## 8.37 Timer identifier
See ETSI TS 102 223 [32] clause 8.37.
## 8.38 Timer value
See ETSI TS 102 223 [32] clause 8.38.
## 8.39 Date-Time and Time zone
See ETSI TS 102 223 [32] clause 8.39.
NOTE: coding is as for the Time Zone and Time information element in TS 24.008
[9], starting at octet 2.
## 8.40 AT Command
* * *
Byte(s) Description Length 1 AT Command tag 1 2 to (Y-1)+2 Length (X) Y
(Y-1)+3 to (Y-1)+3+X-1 AT Command string X
* * *
Contents:
\- The AT Command string is structured exactly as the AT Command line as
defined in TS 27.007 [12], which may contain single or concatenated AT
commands.
## 8.41 AT Response
* * *
Byte(s) Description Length 1 AT Response tag 1 2 to (Y-1)+2 Length (X) Y
(Y-1)+3 to (Y-1)+3+X-1 AT Response string X
* * *
Contents:
\- The AT Response string is structured exactly as the response to a command
line as defined in TS 27.007 [12], which may contain single or concatenated
responses appropriate to the issued AT command.
\- If the AT Response string is longer than the maximum length capable of
being transmitted to the UICC then the AT Response string shall be truncated
to this length by the ME.
## 8.42 BC Repeat indicator
* * *
Byte(s) Description Length 1 BC repeat indicator tag 1 2 Length = \'01\' 1 3
BC repeat indicator values 1
* * *
Contents & coding:
\- The BC repeat indicator is structured exactly as defined in 3GPP TS 24.008
[09].
## 8.43 Immediate response
See ETSI TS 102 223 [32] clause 8.43.
## 8.44 DTMF string
See ETSI TS 102 223 [32] clause 8.44.
## 8.45 Language
See ETSI TS 102 223 [32] clause 8.45.
## 8.46 Timing Advance
This information is only available when the ME is connected to a GSM access
network.
* * *
Byte(s) Description Length 1 Timing Advance tag 1 2 Length = \'02\' 1 3 ME
Status 1 4 Timing Advance 1
* * *
Coding of ME status:
\- \'00\' = ME is in the idle state;
\- \'01\' = ME is not in idle state;
\- \'02\' to\'FF\'= reserved values.
The Timing Advance is coded as for the Timing Advance information element in
TS 44.018 [27], starting at octet 2 (the IEI is removed, as this information
is duplicated by the data object tag).
## 8.47 Browser Identity
See ETSI TS 102 223 [32] clause 8.37.
## 8.48 URL
See ETSI TS 102 223 [32] clause 8.48.
## 8.49 Bearer
* * *
Byte(s) Description Length 1 Bearer tag 1 2 to (Y + 1) Length (X) Y (Y+2) to
(Y + X +1) List of bearers in order of priority requested X
* * *
The ME shall use this list to choose which bearers are allowed in order of
priority.
Coding of the bearers:
\- \'00\' = SMS;
\- \'01\' = CSD;
\- \'02\' = USSD;
\- \'03\' = GPRS/UTRAN packet service/E-UTRAN/NG-RAN;
\- \'04\' to \'FF\' = RFU.
## 8.50 Provisioning File Reference
See ETSI TS 102 223 [32] clause 8.50.
## 8.51 Browser Termination Cause
See ETSI TS 102 223 [32] clause 8.51.
## 8.52 Bearer description
* * *
Byte(s) Description Length 1 Bearer description tag 1 2 Length (X+1) 1 3
Bearer type 1 4 to (3+X) Bearer parameters X
* * *
\- Bearer Type coding: in addition to the values defined in ETSI TS 102 223
[32], the following are defined:
\'01\' = CSD;
\'02\' = GPRS / UTRAN packet service / E-UTRAN.
\'09\' = UTRAN packet service with extended parameters / HSDPA / E-UTRAN.
\'0A\' = (I-)WLAN.
\'0B\' = E-UTRAN / mapped UTRAN packet service.
\'0C\'=NG-RAN
\'0D\' and \'0E\' = reserved for 3GPP (for future usage)
\- Bearer parameters coding: see the following clauses.
### 8.52.1 Bearer parameters for CSD
Contents: parameters specific to the bearer.
In this case X=3.
NOTE: The default values of the subparameters are manufacturer specific since
they depend on the purpose of the device and data services provided by it. Not
all combinations and values of these subparameters are supported by GSM (see
TS 22.002 [1]).
Coding:
\- The following values are as defined in the TS 27.007 [12] for the select
service bearer type \"+CBST\" extended command. They are coded in hexadecimal.
Coding of Byte 4:
\- Data rate: same as the \"speed\" subparameter defined in TS 27.007 [12].
Coding of byte 5:
\- Bearer service: same as the \"name\" subparameter defined in TS 27.007
[12].
Coding of Byte 6:
\- Connection element: same as the \"ce\" subparameter defined in TS 27.007
[12].
### 8.52.2 Bearer parameters for GPRS/UTRAN Packet Service/E-UTRAN
Contents: parameters describing the Quality of Service (QoS) and the type of
PDP. This is an element of the PDP context. These parameters can be used for
3GPP network packet service.
In this case X=6.
Coding:
\- The following values are as defined in the TS 27.007 [12], for the
\"+CGQREQ\" extended command. They are coded in hexadecimal.
Coding of Byte 4:
\- Precedence class: same as the \"precedence\" subparameter, defined in TS
27.007 [12].
Coding of Byte 5:
\- Delay class: same as the \"delay\" subparameter, defined in TS 27.007 [12].
Coding of Byte 6:
\- Reliability class: same as the \"reliability\" subparameter, defined in TS
27.007 [12].
Coding of Byte 7:
\- Peak throughput class: same as the \"peak\" subparameter, defined in TS
27.007 [12].
Coding of Byte 8:
\- Mean throughput class: same as the \"mean\" subparameter, defined in TS
27.007 [12].
Coding of Byte 9:
\- Packet data protocol type (PDP type):
\'02\' = IP (Internet Protocol, IETF STD 5);
\'07\' = Non-IP (Transfer of Non-IP data to external packet data network);
all other values are reserved.
> Note: The mapping between the UTRAN and E-UTRAN QoS parameters are defined
> in TS 23.203 [47].
### 8.52.3 Bearer parameters for UTRAN Packet Service with extended parameters
/ HSDPA / E-UTRAN
Contents: parameters describing the Quality of Service (QoS) and the type of
PDP. This is an element of the PDP context.
In this case X=17.
Coding:
\- The following values are as defined in the TS 27.007 [12], for the
\"+CGEQREQ\" extended command. They are coded in hexadecimal.
Coding of Byte 4:
\- Traffic class: same as the \"Traffic class\" subparameter, defined in TS
27.007 [12].
Coding of Byte 5 and 6:
> \- Maximum bitrate UL: same as the \"Maximum bitrate UL\" subparameter,
> defined in TS 27.007 [12]. The ME shall fill all octets with \'FF\' in case
> the value exceeds the maximum that can be represented.
Coding of Byte 7 and 8:
> \- Maximum bitrate DL: same as the \"Maximum bitrate DL\" subparameter,
> defined in TS 27.007 [12]. The ME shall fill all octets with \'FF\' in case
> the value exceeds the maximum that can be represented.
Coding of Byte 9 and 10:
> \- Guaranteed bitrate UL: same as the \"Guaranteed bitrate UL\"
> subparameter, defined in TS 27.007 [12]. The ME shall fill all octets with
> \'FF\' in case the value exceeds the maximum that can be represented.
Coding of Byte 11 and 12:
> \- Guaranteed bitrate DL: same as the \"Guaranteed bitrate DL\"
> subparameter, defined in TS 27.007 [12]. The ME shall fill all octets with
> \'FF\' in case the value exceeds the maximum that can be represented.
Coding of Byte 13:
> \- Delivery order: same as the \"Delivery order\" subparameter, defined in
> TS 27.007 [12].
Coding of Byte 14:
> \- Maximum SDU size: same as the \"Maximum SDU size\" subparameter, defined
> in TS 24.008 [9].
Coding of Byte 15:
> \- SDU error ratio: same as the \"SDU error ratio\" subparameter, defined in
> TS 24.008 [9], coded in the first 4 bits. The 4 most significant bits shall
> be set to 0.
Coding of Byte 16:
> \- Residual bit error ratio: same as the \"Residual bit error ratio\"
> subparameter, defined in TS 24.008 [9], coded in the first 4 bits. The 4
> most significant bits shall be set to 0.
Coding of Byte 17:
> \- Delivery of erroneous SDUs: same as the \"Delivery of erroneous SDUs\"
> subparameter, defined in TS 27.007 [12].
Coding of Byte 18:
> \- Transfer delay: same as the \"Transfer delay\" subparameter, defined in
> TS 24.008 [9] , coded in the first 6 bits. The 2 most significant bits shall
> be set to 0.
Coding of Byte 19:
> \- Traffic handling priority: same as the \"Traffic handling priority\"
> subparameter, defined in TS 27.007 [12].
Coding of Byte 20:
> \- PDP_type: same as the \"PDP type\" subparameter, defined in TS 24.008 [9]
> for ETSI or IETF allocated address.
>
> Note 1: HSDPA parameters and UTRAN Packet Service parameters are the same
> except for the maximum bitrate DL and the guaranteed bitrate DL, which can
> be higher for HSDPA (see TS 24.008 [9]).
>
> Note 2: The mapping between the UTRAN and E-UTRAN QoS parameters are defined
> in TS 23.203 [47].
### 8.52.4 Bearer parameters for (I-)WLAN
Content: parameters specific to the bearer. RFU.
In this case X=0
### 8.52.5 Bearer parameters for E-UTRAN / mapped UTRAN packet service
Contents: parameters describing the Quality of Service (QoS) and the type of
PDP. This is an element of the PDP context.
In this case X=2 or X=6 or X=10 or X=14, depending on the size of the \"EPS
quality of service\" information element and the resource type (GBR or non-
GBR).
In case of a non-GBR QCI, the QoS octets in the \"EPS quality of service\"
information element are ignored by the UE, as specified in TS 24.301 [46]. In
this case, the UE shall use X=2, passing only the QCI value.
Coding of Byte 4 to Byte X+2:
Byte 4 same as \"octet 3\" of the \"EPS quality of service\" information
element, defined in TS 24.301 [46].
> For a GBR QCI each subsequent Byte shall be present only if the
> corresponding next octet in the \"EPS quality of service\" information
> element is present. The coding of the corresponding bytes shall be the same.
Coding of Byte X+3:
> \- PDP_type: same as the \"PDP type\" subparameter, defined in TS 24.008 [9]
> for ETSI or IETF allocated address.
NOTE: the UICC should handle the cases with X > 14 gracefully, ignoring
additional octets.
### 8.52.6 Bearer parameters for NG-RAN
Contents: parameters describing the type of PDU session. This is an element of
the PDU session context.
The Bearer parameters for NR shall contain the PDU session type.
Length:
\- 1 to X Bytes
Coding:
\- Coding of Byte 4:
PDU session type: same as the \"PDU session type\", defined in Figure
9.11.4.11.1 of TS 24.501 [70].
\- Coding of further Bytes:
RFU
## 8.53 Channel data
See ETSI TS 102 223 [32] clause 8.53.
## 8.54 Channel data length
See ETSI TS 102 223 [32] clause 8.54.
## 8.55 Buffer size
See ETSI TS 102 223 [32] clause 8.55.
## 8.56 Channel status
ETSI TS 102 223 [32] clause 8.56 applies, with the following addition.
In case of an OPEN CHANNEL for IMS, the coding is as follows:
Coding :
\- byte 3 :
\- Bit 1 to 3 : Channel identifier 1 to 7;
Channel identifier 0 means \"no channel available\".
\- Bit 4 to 7 : RFU
\- Bit 8 : 0 = BIP channel not established;
> 1 = BIP channel established.
\- byte 4:
\'00\' = No further info can be given;
\'01\' = Not used;
\'02\' = Not used;
\'03\' = Not used;
\'04\' = Not used;
\'05\' = Link dropped (network failure or user cancellation);
all other values are reserved.
## 8.57 Card reader identifier
See ETSI TS 102 223 [32] clause 8.57.
## 8.58 Other Address
See ETSI TS 102 223 [32] clause 8.58.
## 8.59 UICC/ME interface transport level
See ETSI TS 102 223 [32] clause 8.59.
## 8.60 AID
See ETSI TS 102 223 [32] clause 8.60.
## 8.61 Network Access Name
* * *
Byte(s) Description Length 1 Network Access Name tag 1 2 Length (X) 1 3 to
3+X-1 Network Access Name X
* * *
Content:
\- The Network Access Name is used to identify the Gateway entity (GGSN) or a
Packet Data Network Gateway (PDN-GW) or a User Plane Function (UPF), which
provides interworking with an external packet data network. For GPRS, UTRAN
packet service and E-UTRAN, the Network Access Name is an APN. For NG-RAN, the
Network Access Name is a DNN (which is coded same as an APN).
Coding:
\- As defined in TS 23.003 [30].
## 8.62 Access Technology
See ETSI TS 102 223 [32] clause 8.61.
## 8.63 Display parameters
See ETSI TS 102 223 [32] clause 8.62.
## 8.64 Service Record
See ETSI TS 102 223 [32] clause 8.63.
## 8.65 Device Filter
See ETSI TS 102 223 [32] clause 8.64.
## 8.66 Service Search
See ETSI TS 102 223 [32] clause 8.65.
## 8.67 Attribute Information
See ETSI TS 102 223 [32] clause 8.66.
## 8.68 Service Availability
See ETSI TS 102 223 [32] clause 8.67.
## 8.69 Remote Entity Address
See ETSI TS 102 223 [32] clause 8.68.
## 8.70 Text Attribute
See ETSI TS 102 223 [32] clause 8.72.
## 8.71 Item Text Attribute List
See ETSI TS 102 223 [32] clause 8.73.
## 8.72 PDP context Activation parameters
* * *
Byte(s) Description Length 1 PDP context Activation parameters tag 1 2 to
(Y+1) Length (X) Y (Y+2) to (Y+X+1) PDP context Activation parameters X
* * *
The PDP context Activation parameters are coded as the ACTIVATE PDP CONTEXT
REQUEST message, refer to TS 24.008 [9].
NOTE: If the \"Protocol configuration options\" in the ACTIVATE PDP CONTEXT
REQUEST message is too large (i.e. greater than 229-L, where L is the sum of
the length of the Requested QoS Information Element, the Requested PDP address
Information Element, and the Access point name Information Element), the ME
may decide not to include the \"Protocol configuration options\" and any
subsequent information elements of the ACTIVATE PDP CONTEXT REQUEST message
inside the \"PDP context Activation parameters\".
## 8.73 UTRAN/E-UTRAN Measurement Qualifier
This information is only available when the ME is connected to a UTRAN or an
E-UTRAN.
* * *
Byte(s) Description Length 1 UTRAN/E-UTRAN Measurement Qualifier tag 1 2
Length (1) 1 3 UTRAN/E-UTRAN Measurement Qualifier 1
* * *
UTRAN/E-UTRAN Measurement Qualifier
Contents: Qualifier specific to the UTRAN/E-UTRAN NMR
Coding
\'01\' UTRAN Intra-frequency measurements
\'02\' UTRAN Inter-frequency measurements
\'03\' UTRAN Inter-RAT (GERAN) measurements
\'04\' UTRAN Inter-RAT (E-UTRAN) measurements
\'05\' E-UTRAN Intra-frequency measurements
\'06\' E-UTRAN Inter-frequency measurements
\'07\' E-UTRAN Inter-RAT (GERAN) measurements
\'08\' E-UTRAN Inter-RAT (UTRAN) measurements
\'09\' E-UTRAN Inter-RAT (NR) measurements
All other values are reserved
## 8.74 Multimedia Message Reference
See ETSI TS 102 223 [32] clause 8.82.
## 8.75 Multimedia Message Identifier
See ETSI TS 102 223 [32] clause 8.83.
## 8.76 Multimedia Message Transfer status
See ETSI TS 102 223 [32] clause 8.84.
## 8.77 MM Content Identifier
In addition to ETSI TS 102 223 [32] clause 8.85, the codinf of the MM Content
Data Object tag is done according to TS 31.102[14].
## 8.78 Multimedia Message Notification
See ETSI TS 102 223 [32] clause 8.86.
## 8.79 Last Envelope
See ETSI TS 102 223 [32] clause 8.87.
## 8.80 Frames Layout
See ETSI TS 102 223 [32] clause 8.78.
## 8.81 Frames Information
See ETSI TS 102 223 [32] clause 8.79.
## 8.82 Frames identifier
See ETSI TS 102 223 [32] clause 8.80.
## 8.83 I-WLAN Identifier
* * *
Byte(s) Description Length 1 I-WLAN Identifier tag 1 2 Length (X) 1 3 to (2+X)
WSID value X
* * *
The WSID Value is coded as the WLAN Specific Identifier (WSID) defined in TS
24.234 [42].
## 8.84 (I-)WLAN Access Status
* * *
Byte(s) Description Length 1 (I-)WLAN Access Status tag 1 2 Length (1) 1 3
Access status 1
* * *
Coding of Access status:
\- \'00\' = No current (I-)WLAN coverage;
\- \'01\' = (I-)WLAN coverage available, no current connection;
\- \'02\' = (I-)WLAN coverage available, connection on-going;
\- \'03\' to\'FF\'= reserved values.
## 8.85 IMEISV
See ETSI TS 102 223 [32] clause 8.74.
## 8.86 Network search mode
See ETSI TS 102 223 [32] clause 8.75.
## 8.87 Battery State
See ETSI TS 102 223 [32] clause 8.76.
## 8.88 Browsing status
See ETSI TS 102 223 [32] clause 8.77.
## 8.89 Registry application data
See ETSI TS 102 223 [32] clause 8.88.
## 8.90 PLMNwAcT List
* * *
Byte(s) Description Length 1 PLMNwAcT List tag 1 2 Length (5n) 1 3 to 5 1^st^
PLMN Identifier(highest priority) 3 6 to 7 1^st^ PLMN Access Technology
Identifier 2 : :  
(5n-2) to (5n) nth PLMN Identifier (lowest priority) 3 (5n+1) to (5n+2) nth
PLMN Access Technology Identifier 2
* * *
Coding of PLMN Identifier:
As for PLMN within EF~PLMNwACT~ in TS 31.102 [14].
Coding of PLMN Access Technology Identifier:
As for Access Technology Identifier within EF~PLMNwACT~ in TS 31.102 [14].
## 8.91 Routing Area Identification
* * *
Byte(s) Description Length 1 Routing Area Information Tag 1 2 Length 1 3 - 5
Mobile Country & Network Codes (MCC & MNC) 3 6 - 7 Location Area Code (LAC) 2
8 Routing Area code (RAC) 1
* * *
When present, this object shall contain the Routing Area Identification
information of rejecting network. The RAI is coded in the same manner as the
value part of the Routing Area Identification information element as specified
in TS 24.008 [9].
## 8.92 Update/Attach/Registration Type
* * *
Byte(s) Description Length 1 Update/Attach/Registration Type Tag 1 2 Length 1
3 Update/Attach/Registration Type 1
* * *
Contents:
\- In the case of GERAN/UTRAN, the terminal shall use this information as a
mechanism to indicate to the UICC the location updating type that was sent in
the LOCATION UPDATING REQUEST message or the attach type that was sent in the
GPRS Attach Request message or the update type that was sent in the Routing
Area Updating Request message, as specified in TS 24.008 [9].
\- In the case of E-UTRAN, the terminal shall use this information as a
mechanism to indicate to the UICC the EPS attach type that was sent in the EMM
ATTACH REQUEST message or the EPS update type that was sent in the TRACKING
AREA UPDATE REQUEST message, as specified in TS 24.301 [46].
\- In the case of NG-RAN, the terminal shall use this information as a
mechanism to indicate to the UICC the 5GS registration type that was sent in
the REGISTRATION REQUEST message, as specified in TS 24.501 [70].
Coding:
\- \'00\' = \"Normal Location Updating\" in the case of a Location Updating
Request message;
\- \'01\' = \"Periodic Updating\" in the case of a Location Updating Request
message;
\- \'02\' = \"IMSI Attach\" in the case of a Location Updating Request
message;
\- \'03\' = \"GPRS Attach\" in the case of a GPRS Attach Request message;
\- \'04\' = \"Combined GPRS/IMSI Attach\" in the case of a GPRS Attach Request
message;
\- \'05\' = \"RA Updating\" in the case of a Routing Area Update Request
message;
\- \'06\' = \"Combined RA/LA Updating\" in the case of a Routing Area Update
Request message;
\- \'07\' = \"Combined RA/LA Updating with IMSI Attach\" in the case of a
Routing Area Update Request message;
\- \'08\' = \"Periodic Updating\" in the case of a Routing Area Update Request
message
\- \'09\' = \"EPS Attach\" in the case of an EMM ATTACH REQUEST message
\- \'0A\' = \"Combined EPS/IMSI Attach\" in the case of an EMM ATTACH REQUEST
message
\- \'0B\' = \"TA updating \" in the case of an EMM TRACKING AREA UPDATE
REQUEST message
\- \'0C\' = \"Combined TA/LA updating\" in the case of an EMM TRACKING AREA
UPDATE REQUEST message
\- \'0D\' = \"Combined TA/LA updating with IMSI attach\" in the case of an EMM
TRACKING AREA UPDATE REQUEST message
\- \'0E\' = \"Periodic updating\" in the case of an EMM TRACKING AREA UPDATE
REQUEST message
\- \'0F\' = \"Initial Registration\" in the case of a 5GMM REGISTRATION
REQUEST message
\- \'10\' = \"Mobility Registration updating\" in the case of a 5GMM
REGISTRATION REQUEST message
\- \'11\' = \"Periodic Registration updating\" in the case of a 5GMM
REGISTRATION REQUEST message
\- All other values are reserved for future use
## 8.93 Rejection Cause Code
* * *
Byte(s) Description Length 1 Rejection Cause Code Tag 1 2 Length 1 3 Rejection
Cause Code 1
* * *
For GERAN/UTRAN, in the case of a Location Updating Reject message, this
object shall contain the Reject Cause as received in the Location Updating
Reject message. The Reject Cause is coded in the same manner as the value part
of the Reject Cause information element as specified in TS 24.008 [9]
For GERAN/UTRAN, in the case of a GPRS Attach Reject message or a Routing Area
Update Reject message, this object shall contain the GMM Cause as received in
the GPRS Attach Reject message or Routing Area Update Reject message. The GMM
Cause is coded in the same manner as the value part of the GMM Cause
information element as specified in TS 24.008 [9].
For E-UTRAN, in the case of an EMM ATTACH REJECT message or an EMM TRACKING
AREA UPDATE REJECT message, this object shall contain the EMM Cause as
received in the EMM ATTACH REJECT message or EMM TRACKING AREA UPDATE REJECT
message. The EMM Cause is coded in the same manner as the value part of the
EMM Cause information element as specified in TS 24.301 [46].
For NG-RAN, in the case of a 5GMM REGISTRATION REJECT message, this object
shall contain the 5GMM Cause as received in the 5GMM REGISTRATION REJECT
message. The 5GMM Cause is coded in the same manner as the value part of the
5GMM Cause information element as specified in TS 24.501 [70].
## 8.94 Geographical Location Parameters
* * *
Byte(s) Description Length 1 Geographical Location Parameters Tag 1 2 Length 1
3 Horizontal accuracy 1 4 Vertical coordinate 1 5 Velocity 1 6 Preferred GAD
shapes 1 7 Preferred NMEA sentences 1 8 Preferred Maximum Response Time 1
* * *
Horizontal accuracy:
Contents:
\- the preferred horizontal accuracy.
Coding:
\- \'81\' : horizontal accuracy not specified / best effort;
\- \'xx\' where \'00\' ≤ \'xx\' ≤ \'7F\': \'xx\' represents the uncertainty
for longitude and latitude as described in TS 23.032 [44]. A value in this
range may be specified in the parameters of the \"Geographical Location
Request\" command. The horizontal location error should be less than the error
indicated by the horizontal accuracy with 67% confidence.
\- All other values are reserved.
Vertical coordinate:
Contents:
\- indicates if the vertical coordinate (altitude) is requested and
potentially indicate the preferred vertical coordinate accuracy.
Coding:
\- \'80\' : vertical coordinate is not requested (i.e. 2D location fix is
acceptable);
\- \'81\' : vertical coordinate is requested, (i.e. 3D location fix is
preferred) but accuracy is not specified (best effort);
\- \'xx\' where \'00\' ≤ \'xx\' ≤ \'7F\': vertical coordinate is requested and
\'xx\' represents the altitude uncertainty as described in TS 23.032 [44]. A
value in this range may be specified in the parameters of the \"Geographical
Location Request\" command. The vertical location error should be less than
the error indicated by the vertical accuracy with 67% confidence.
\- All other values are reserved.
Velocity:
Contents:
\- indicates if a velocity and a velocity uncertainty are requested. When a
velocity type or an uncertainty are requested, the corresponding bit shall be
set to 1. Otherwise the bit is set to 0. If b1 is set to zero, b2, b3 and b4
shall be ignored. If b2 is set to zero, b4 shall be ignored.
Coding:
* * *
     b8   B7   b6   B5   b4   b3   b2   b1   
                                             Horizontal velocity requested
                                             Vertical velocity requested
                                             Uncertainty of horizontal velocity requested
                                             Uncertainty of vertical velocity requested
                                             RFU, bit = 0
                                             RFU, bit = 0
                                             RFU, bit = 0
                                             RFU, bit = 0
* * *
Preferred GAD shapes:
Contents:
\- the preferred GAD shape(s). When a GAD shape is indicated as \"preferred\",
the corresponding bit shall be set to 1. Otherwise the bit is set to 0. The
UICC application should be capable of extracting the needed information from
all GAD shapes indicated in the bit map below.
Coding:
* * *
     b8   B7   b6   B5   b4   b3   b2   b1   
                                             Ellipsoid point
                                             Ellipsoid point with uncertainty circle
                                             Ellipsoid point with uncertainty ellipse
                                             Ellipsoid point with altitude
                                             Polygon
                                             Ellipsoid point with altitude and uncertainty ellipsoid
                                             Ellipsoid arc
                                             RFU, bit = 0
* * *
Preferred NMEA sentences:
Contents:
\- the preferred NMEA sentence(s). When a NMEA sentence is indicated as
\"preferred\", the corresponding bit shall be set to 1. Otherwise the bit is
set to 0. The UICC application should be capable of extracting the needed
information from all NMEA sentences indicated in the bit map below.
Coding:
* * *
     b8   B7   b6   B5   b4   b3   b2   b1   
                                             \$\--RMC
                                             \$\--GGA
                                             \$\--GLL
                                             \$\--GNS
                                             RFU, bit = 0
                                             RFU, bit = 0
                                             RFU, bit = 0
                                             RFU, bit = 0
* * *
Preferred Maximum Response Time:
Contents:
\- indicates the preferred maximum response time. This hint may be used by the
ME to make trade-offs between requirements for positioning accuracy and
response time.
Coding:
\- \'xx\' where \'02\' ≤ \'xx\' ≤ \'07\': 2\^^\'xx\'^ represents the preferred
maximum response time in seconds.
\- All other values are reserved;
## 8.95 GAD shapes
* * *
Byte(s) Description Length 1 GAD shapes Tag 1 2 Length 1 3 Length of GAD shape
1 4 to X+3 GAD shape X X+4 Length of Velocity 1 X+5 to X+Y+4 Velocity Y
* * *
Length of GAD shape:
Contents:
\- the length of the GAD shape.
Coding:
\- binary.
GAD shape:
Contents:
\- universal geographical area description shape.
Coding:
\- shape encoded as described in TS 23.032 [44] with the first byte of the
shape (i.e. octet 1 containing the type shape) encoded on byte 4.
Length of Velocity:
Contents:
\- the length of the velocity. This byte shall be set to \'00\' when the
Velocity is not available.
Coding:
\- binary.
Velocity:
Contents:
\- velocity.
Coding:
\- velocity encoded as described in TS 23.032 [44] with the first byte of the
velocity (i.e. octet 1 containing the velocity shape) encoded on byte X+5.
## 8.96 NMEA sentence
* * *
Byte(s) Description Length 1 NMEA sentence Tag 1 2 Length 1 3 to X+2 NMEA
sentence X
* * *
NMEA sentence:
Contents:
\- NMEA sentence as defined in IEC 61162-1 [45]. The ME should use one of the
Preferred NMEA sentences indicated in the \"Geographical Location Parameters\"
by the UICC. Otherwise, one of the NMEA sentences listed in clause 8.94 shall
be used.
Coding:
ASCII;
## 8.97 PLMN List
* * *
Byte(s) Description Length 1 PLMN List tag 1 2 Length (3n) 1 3 to 5 1^st^ PLMN
Identifier(highest priority) 3 : :  
(3n) to (3n+2) nth PLMN Identifier (lowest priority) 3
* * *
Coding of PLMN Identifier:
As for PLMN within EF~OPLMNWLAN~ in TS 31.102 [14].
## 8.98 EPS PDN connection activation parameters
* * *
Byte(s) Description Length 1 EPS PDN connection Activation parameters tag 1 2
to (Y+1) Length (X) Y (Y+2) to (Y+X+1) EPS PDN connection Activation
parameters X
* * *
The EPS PDN connection Activation parameters are coded as the PDN CONNECTIVITY
REQUEST message, refer to TS 24.301 [46].
NOTE: If the \"Protocol configuration options\" in the PDN CONNECTIVITY
REQUEST message is too large (i.e. greater than 229-L, where L is the length
of the Access point name Information Element), the ME may decide not to
include the \"Protocol configuration options\" and any subsequent information
elements of the PDN CONNECTIVITY REQUEST message inside the \"EPS PDN
connection Activation parameters\".
## 8.99 Tracking Area Identification
* * *
Byte(s) Description Length 1 Tracking Area Identification Tag 1 2 Length 1 3 -
5 Mobile Country & Network Codes (MCC & MNC) 3 6 - X Tracking Area Code (TAC)
(See NOTE) X - 5 NOTE: TAC is coded in 2 bytes for E-UTRAN and in 3 bytes for
NG-RAN
* * *
This object shall contain the Tracking Area Identification information of
rejecting network (i.e. MCC, MNC and TAC). The value part of this object is
coded in the same manner as the value part of the Tracking Area Identity
information element as specified in TS 24.301 [46] for E-UTRAN, or as the
value part of the Tracking Area Identity information element as specified in
TS 24.501 [70] for NG-RAN.
## 8.100 CSG ID list identifier
* * *
Byte(s) Description Length 1 CSG ID list Identifier tag 1 2 to 1+Y Length Y
(Y+2) to (Y+X+1) CSG ID List X (X>1)
* * *
CSG ID List:
Description Value M/O Length (bytes)
* * *
PLMN Tag \'80\' M 1 Length A M 1 PLMN -- M A CSG ID and Name Tag \'81\' M 1
Length B M 1 CSG ID and Name - M B
The CSG ID List TLV object shall contain one PLMN TLV object, Tag \'80\',
followed by at least one CSG ID and Name TLV, Tag \'81\'. The CSG ID List TLV
object can contain more than one PLMN TLV objects. Each CSG ID and Name TLV
belongs to the previous PLMN.
Coding of PLMN object (Tag \'80\'):
Content:
Mobile Country Code (MCC) followed by the Mobile Network Code (MNC).
Coding:
according to TS 24.008 [9].
Coding of CSG ID and name (Tag \'81\'):
Content:
CSG ID and HNB Name
Coding:
1 to 4 CSG ID M 4 bytes
* * *
5 to B HNB Name M B-4 bytes
CSG ID: as in EF~ACSGL~, in TS 31.102 [14].
HNB Name: as for HNB name in EF~HNBN~ in TS 31.102 [14].
## 8.101 CSG cell selection status
* * *
Byte(s) Description Length 1 CSG cell selection status tag 1 2 Length 1 3 CSG
cell selection status 2
* * *
Coding of CSG cell selection status:
Byte 1 : general information
\- \'00\' = not camped on a CSG or Hybrid cell in the Allowed CSG list or the
Operator CSG list
\- \'01\' = camped on a CSG or Hybrid cell of the Operator CSG list or Allowed
CSG list
\- other values are RFU
Byte 2 : additional information
This byte may contain additional information. If additional information is
present, bit b1 shall be set to 1. If b1 is set to 0, this byte shall be
ignored.
Bits b7 and b8 indicate the CSG selection mechanism used; see TS 25.304 [59]
and TS 36.304 [60].
* * *
        B8   b7   b6   b5   b4   b3   b2   b1   
                                                Additional information presence bit
                                                RFU
                                                RFU
                                                RFU
                                                RFU
                                                RFU
                                                Result of a manual CSG selection
                                                Result of another CSG selection type
* * *
## 8.102 CSG ID
* * *
Byte(s) Description Length 1 CSG ID tag 1 2 Length 1 3 to X+2 CSG ID X
* * *
Coding of CSG ID:
As for CSG ID in EF~ACSGL~, in TS 31.102 [14]
## 8.103 HNB name
* * *
Byte(s) Description Length 1 HNB name tag 1 2 Length 1 3 to 2+X HNB name X
* * *
Coding of HNB name:
As for HNB name in EF~HNBN~ in TS 31.102 [14]
## 8.104 Activate descriptor
Not required by 3GPP.
## 8.105 Broadcast Network information
Not required by 3GPP.
## 8.106 Contactless state request
Not required by 3GPP.
## 8.107 Contactless functionality state
Not required by 3GPP.
## 8.108 IMS URI
* * *
Byte(s) Description Length 1 IMS URI Tag 1 2 to (Y+1) Length Y (Y+2) to
(Y+X+1) IMS URI (IMPU) X
* * *
Content :
IMS URI shall take the form of IMPU, which is SIP URI or tel URI, as defined
in TS 24.229 [52]
Coding of IMS URI
As defined in TS 24.229 [52]
## 8.109 Extended registry application data
See ETSI TS 102 223 [32] clause 8.93.
## 8.110 IARI
* * *
Byte(s) Description Length 1 IARI Tag 1 2 to (Y+1) Length Y (Y+2) to (Y+X+1)
IARI value X NOTE: X>0
* * *
Coding:
\- IARI value shall be coded as specified in TS 24.229 [52].
## 8.111 IMPU List
* * *
Byte(s) Description Length 1 IMPU List Tag 1 2 to (Y+1) Length Y Y+2 URI TLV
tag 1 (Y+3) to (Y+Z+2) URI TLV length Z .. : ... ... ... ...
* * *
Coding:
\- For contents and syntax of URI TLV data object values see IETF RFC 3261
[53]. The URI shall be encoded to an octet string according to UTF-8 encoding
rules as specified in IETF RFC 3629 [54]. The tag value of the URI TLV data
object shall be \'80\'.
## 8.112 IMS status code
* * *
Byte(s) Description Length 1 IMS Status-code Tag 1 2 Length 1 3 to X+2 IMS
Status-code X NOTE: X>0
* * *
Content
\- IMS status code as specified in 3GPP TS 24.229 [52]
Coding:
\- Sequence of digits in ASCII format.
## 8.113 eCAT client profile
Not required by 3GPP.
## 8.114 eCAT client identity
Not required by 3GPP.
## 8.115 Encapsulated envelope type
Not required by 3GPP.
## 8.116 Void
## 8.117 Void
## 8.118 PLMN ID
* * *
Byte(s) Description Length 1 PLMN Identity Tag 1 2 Length 1 3 to 5 PLMN
identity 3
* * *
PLMN ID TLV object shall contain PLMN identity Tag followed by Length and PLMN
identity, containing Mobile Country Code (MCC) and Mobile Network Code (MNC),
coded according to TS 24.008 [9].
## 8.119 E-UTRAN Inter-frequency Network Measurement Results
Byte(s) Description Length
* * *
1 E-UTRAN Inter-frequency Network Measurement Results tag 1 2 Length (X) of
bytes following 1 3 -- 6 Frequency value 4 7 -- to X+6 Measurement Report
information X
> The ME can send more than one E-UTRAN Inter-frequency Network Measurement
> Results TLV object, each containing the results of one frequency. This TLV
> object shall be used only if the service \"extended EARFCN\" is available in
> the USIM Service Table (see TS 31.102 [14]).
>
> The frequency value shall be coded as the ARFCN-ValueEUTRA-v9e0 as defined
> in TS 36.331 [49].
>
> The Measurement Report information shall be coded as _MeasurementReport_
> information element defined in the ASN.1 description of TS 36.331 [49],
> according to the following:
\- The \"measId\" field in the \"measResults\" shall be set to the value
\'1\'.
\- the ME shall include IE \"measResultServCell\" with RSRP and RSRQ of the
serving cell.
\- the ME shall, in the _MeasurementReport_ , include IE \"
measResultListEUTRA\" in IE \"Measured Results\". The ME shall report RSRP,
RSRQ, Physical Cell ID and IE \"cgi-Info\" for the up to 6 strongest (highest
RSRQ value) inter-frequency cells per monitored frequency, if available in the
ME according to TS 36.331 [49] and TS 36.133 [50].
\- All other optional fields in the _MeasurementReport_ shall be set to be
absent.
## 8.120 Call control result
Not required by 3GPP.
## 8.121 eCAT sequence number
Not required by 3GPP.
## 8.122 Encrypted TLV list
Not required by 3GPP.
## 8.123 MAC
Not required by 3GPP.
## 8.124 SA template
Not required by 3GPP.
## 8.125 CAT service list
Not required by 3GPP.
## 8.126 Refresh enforcement policy
See ETSI TS 102 223 [32] clause 8.103.
## 8.127 DNS Server Address
See ETSI TS 102 223 [32] clause 8.104.
## 8.128 ProSe Report Data
Byte(s) Description Length
* * *
1 ProSe Report Data Tag 1 2 to (X+1) Length X (1 or 2) X+2 to X+1+Y ProSe
Report Data Y
Contents:
\- Contains the ProSe Report
Coding:
\- Coded according to the XML schema defined in TS 24.334 [61] with \ element as the root element and one
\ element inside it.
## 8.129 SSID
* * *
Byte(s) Description Length 1 SSID tag 1 2 Length (X) 1 3 to (2+X) SSID Value X
≤ 32
* * *
The SSID value is coded as specified for the SSID field in IEEE 802.11 [64].
## 8.130 BSSID
* * *
Byte(s) Description Length 1 BSSID tag 1 2 Length = \'06\' 1 3 to 8 BSSID
value 6
* * *
The BSSID value is coded as specified for the BSSID field in IEEE 802.11 [64].
## 8.131 HESSID
* * *
Byte(s) Description Length 1 HESSID tag 1 2 Length = \'06\' 1 3 to 8 HESSID
value 6
* * *
The HESSID value is coded as specified for the HESSID field in IEEE 802.11
[64].
## 8.132 Media Type
The Media Type data element indicates the media type of the communication.
* * *
Byte(s) Description Length 1 Media type tag 1 2 Length = \'01\' 1 3 Media type
value 1
* * *
Coding:
\- The Media type value is coded as a bitmap
First byte (conversational communication):
* * *
        b8   b7   b6   b5   b4   b3   b2   b1   
                                                Bit = 1 if the type of media is voice
                                                Bit = 1 if the type of media is video
                                                Bit = 0: RFU
                                                Bit = 0: RFU
                                                Bit = 0: RFU
                                                Bit = 0: RFU
                                                Bit = 0: RFU
                                                Bit = 0: RFU
* * *
## 8.133 IMS call disconnection cause
* * *
Byte(s) Description Length 1 IMS cause tag 1 2 Length = \'03\' 1 3 Protocol 1
4 to 5 Cause 2
* * *
Protocol is the value of the protocol header field parameter in the Reason
header field of the SIP message triggering the call disconnect event. It is
coded on 1 byte as follows:
\- \'01\' for SIP
\- \'02\' for Q.850
\- Other values are RFU
Cause is the value of the cause header field parameter in the Reason header
field of the SIP message triggering the call disconnect event. It is coded as
2-bytes integer, e.g. a value of \"603\" translates to \'025B\'.
## 8.134 E-UTRAN Primary Timing Advance Information
* * *
Byte(s) Description Length 1 E-UTRAN Timing Advance tag 1 2 Length = \'03\' 1
3 ME Status 1 4 - 5 E-UTRAN Primary Timing Advance value 2
* * *
Coding of ME status:
\- \'00\' = ME is in the idle state;
\- \'01\' = ME is not in idle state;
\- \'02\' to \'FF\' = reserved values.
The E-UTRAN Primary Timing Advance value is equal to the total \"Timing offset
between uplink and downlink radio frames at the UE, expressed in units of Ts\"
(Basic time unit), as defined in TS 36.211 [66].
If the ME has never been in E-UTRAN RRC connected mode on the current cell,
the value of the E-UTRAN Primary Timing Advance shall be set to \'FF FF\'.
## 8.135 URI truncated
* * *
Byte(s) Description Length 1 URI truncated tag 1 2 Length = \'0\' 1
* * *
## 8.136 Extended Rejection Cause Code
* * *
Byte(s) Description Length 1 Extended Rejection Cause Code Tag 1 2 Length 1 3
Extended Rejection Cause Code 1
* * *
For E-UTRAN, in the case of an EMM ATTACH REJECT message or an EMM TRACKING
AREA UPDATE REJECT message, if the Extended EMM Cause is available, then this
object shall contain the Extended EMM Cause as received in the EMM ATTACH
REJECT message or EMM TRACKING AREA UPDATE REJECT message. The Extended EMM
Cause is coded in the same manner as the value part of the Extended EMM Cause
information element as specified in TS 24.301 [46].
## 8.137 Data connection status
This data object shall contain the result of the PDP request procedure, PDN
request procedure or PDU establishment procedure as defined in 3GPP TS 24.008
[9] for GERAN & UTRAN, 3GPP TS 24.301 [46] for E-UTRAN or 3GPP TS 24.501 [70]
for NG-RAN.
* * *
Byte(s) Description Length 1 Data connection status tag 1 2 Length = \'01\' 1
3 Data connection status value 1
* * *
Data connection status value coding:
\- \'00\' = Data connection successful; Successful means accepted by the
network and completed by the device.
\- \'01\' = Data connection rejected;
\- \'02\' = Data connection dropped or deactivated.
\- Other values RFU
## 8.138 Data connection type
This data object shall contain the type of procedure, PDP request procedure,
PDN request procedure or PDU establishment procedure, as defined in 3GPP TS
24.008 [9] for GERAN & UTRAN, 3GPP TS 24.301 [46] for E-UTRAN or 3GPP TS
24.501 [70] for NG-RAN.
* * *
Byte(s) Description Length 1 Data connection type tag 1 2 Length = \'01\' 1 3
Data connection type 1
* * *
Data connection type coding:
\- \'00\' = PDP connection
\- \'01\' = PDN connection
\- \'02\' = PDU connection
\- Other values RFU
## 8.139 (E/5G)SM cause
This data object shall contain the value of the SM cause for PDP as defined in
3GPP TS 24.008 [9] for GERAN & UTRAN, the ESM Cause for PDN as defined in 3GPP
TS 24.301 [46] for E-UTRAN or the 5GSM Cause for PDU as defined in 3GPP TS
24.501 [70] for NG-RAN.
* * *
Byte(s) Description Length 1 (E/5G)SM cause tag 1 2 Length = \'01\' 1 3
(E/5G)SM cause value 1
* * *
(E/5G)SM cause value coding:
For PDP procedures:
The coding of the cause is defined in 3GPP TS 24.008 [9]
> \- If the data connection (i.e. request procedure) is accepted, (E/5G)SM
> cause value is the SM cause value contained in the message for PS session
> management (i.e. ACTIVATE PDP CONTEXT ACCEPT **message)** coded as in TS
> 24.008 [9] clause 10.5.6.6a;
>
> \- If the data connection (i.e. request procedure) fails or is deactivated,
> (E/5G)SM cause value is the SM cause value contained in the messages for PS
> session management (i.e. ACTIVATE PDP CONTEXT REJECT message or REQUEST
> **PDP CONTEXT ACTIVATION REJECT message or the DEACTIVATE PDP CONTEXT
> REQUEST message) and** is coded as in TS 24.008 [9] clause 10.5.6.6.
>
> For PDN procedures:
>
> The coding of the cause is defined in 3GPP TS 24.301 [46].
>
> \- If the data connection (i.e. request procedure) fails or is deactivated,
> (E/5G)SM cause value is the ESM cause value contained in the message types
> for EPS session management (ie. in the PDN CONNECTIVITY REJECT message
> **or** ACTIVATE DEFAULT EPS BEARER CONTEXT REJECT message or **the**
> DEACTIVATE EPS BEARER CONTEXT REQUEST **message) and** is coded as in TS
> 24.301 [46] clause 9.9.4.4.
>
> For PDU procedures:
>
> The coding of the cause is defined in 3GPP TS 24.501 [70].
>
> \- If the data connection (i.e. request procedure) fails or is
> deactivated/released, (E/5G)SM cause value is the 5GSM cause value contained
> in the message types for 5GS session management (ie. in the PDU SESSION
> ESTABLISHMENT REJECT message **or in the** PDU SESSION RELEASE REQUEST
> **message) and** is coded as in TS 24.501 [70] clause 9.11.4.2.
## 8.140 IP address list
* * *
Byte(s) Description Length 1 IP address list Tag 1 2 Length 1 3 to (2+X) Other
address TLV object(s) X
* * *
Content :
\- List of IP addresses on the H(e)NB-network interface.
Coding:
\- coding of Other address : see clause 8.58.
## 8.141 Surrounding macrocells
* * *
Byte(s) Description Length 1 Surrounding macrocell list Tag 1 2 Length 1 3 to
5 Access Technology TLV object(s) 3 6 to 6+X Location information TLV
object(s) X
* * *
Content :
\- List of surrounding macrocells, per access technology
Coding:
\- coding of Access Technology : see clause 8.62.
\- coding of Location Information : see clause 8.19.
## 8.142 PDP/PDN/PDU type
This data object shall contain the PDP, PDN or PDU Session type, as defined in
3GPP TS 24.008 [9] for GERAN and UTRAN, in 3GPP TS 24.301 [46] for E-UTRAN or
in 3GPP TS 24.501 [70] for NG-RAN.
* * *
Byte(s) Description Length 1 PDP/PDN/PDU type tag (see Note) 1 2 Length =
\'01\' 1 3 PDP/PDN type or PDU Session type 1 NOTE: Interpretation of the type
depends on the value for the Access Technology (see clause 8.62)
* * *
PDP/PDN type coding:
\- \'00\' = IPv4
\- \'01\' = IPv6
\- \'03\' = IPv4v6
\- \'04\' = PPP
\- \'05\' = non IP
All other values are RFU.
PDU Session type coding:
\- \'00\' = IPv4
\- \'01\' = IPv6
\- \'03\' = IPv4v6
\- \'04\' = Unstructured
\- \'05\' = Ethernet
All other values are RFU.
## 8.143 PDU Session Establishment parameters
* * *
Byte(s) Description Length 1 PDU Session Establishment parameters tag 1 2 to
(Y+1) Length (Z+X) Y (Y+2) to (Y+Z+1) DNN Z (Y+Z+2) to (Y+Z+X+1) PDU Session
Establishment parameters X
* * *
The DNN is coded as specified in TS 24.501 [70] clause 9.11.2.1B.
The PDU Session Establishment parameters are coded as the PDU SESSION
ESTABLISHMENT REQUEST message as specified in TS 24.501 [70].
NOTE: If the \"SM PDU DN request container\" in the PDU SESSION ESTABLISHMENT
REQUEST message is too large (i.e. greater than 207-Z, where Z is the length
of the DNN Information Element), the ME may decide not to include the \"SM PDU
DN request container\" and any subsequent information elements of the PDU
SESSION ESTABLISHMENT REQUEST message inside the \"PDU Session Establishment
parameters\". If the \"Extended protocol configuration options\" in the PDU
SESSION ESTABLISHMENT REQUEST message is too large (i.e. greater than 207-Z-L,
where Z is the length of the DNN Information Element, L is the length of the
\"SM PDU DN request container\", and L\
Acquiring GPS location  
→
                           ENVELOPE (Geographical Location Reporting)                                                                                                                                                                                                                                                             
                           →                                                                                                                                                                                                                                                                                  
                           NMEA sentence (*tag*68\$GPRMC,175544,V,3957.5751,N,07511.5938,W,0.0,0.0,25052,12.4,W,S\*24)
* * *
Figure O.1
###### ## Annex P (normative): Support of USAT by Terminals with reduced
feature capabilities.
See ETSI TS 102 223 [32] Annex S except for USAT-specific commands which are
defined as follows.
Table P.1 provides the applicability of USAT-specific envelope commands for
the different terminal types.
Table P.2 provides an overview of USAT-specific affected commands.
Table P.1: Envelope applicability table
+---------------+---------+---------+---------+---------+---------+ | Envelope | ND type | NK type | NA type | NS type | NL type | +---------------+---------+---------+---------+---------+---------+ | SMS-PP data | | | | | | | download | | | | | | +---------------+---------+---------+---------+---------+---------+ | Cell | | | | | | | Broadcast | | | | | | | data download | | | | | | +---------------+---------+---------+---------+---------+---------+ | Call Control | Note 2 | | | | | | by USIM | | | | | | +---------------+---------+---------+---------+---------+---------+ | MO Short | Note 2 | | | | | | Message | | | | | | | Control by | | | | | | | USIM | | | | | | +---------------+---------+---------+---------+---------+---------+ | EVENT | | | | | | | DOWNLOAD - | | | | | | | (I-)WLAN | | | | | | | Access status | | | | | | +---------------+---------+---------+---------+---------+---------+ | EVENT | | | | | | | DOWNLOAD - | | | | | | | Network | | | | | | | Rejection | | | | | | +---------------+---------+---------+---------+---------+---------+ | USSD Data | | | | | | | Download | | | | | | +---------------+---------+---------+---------+---------+---------+ | Geographical | | | | | | | Location | | | | | | | Reporting | | | | | | +---------------+---------+---------+---------+---------+---------+ | ProSe Report | | | | | | +---------------+---------+---------+---------+---------+---------+ | Note 1: \"O\" | | | | | | | means | | | | | | | proactive | | | | | | | command is | | | | | | | optional, No | | | | | | | indication | | | | | | | means that | | | | | | | the proactive | | | | | | | command is | | | | | | | fully | | | | | | | applicable. | | | | | | | | | | | | | | Note 2: If an | | | | | | | alpha | | | | | | | identifier is | | | | | | | provided by | | | | | | | the UICC in | | | | | | | the response, | | | | | | | it shall be | | | | | | | ignored by | | | | | | | the terminal. | | | | | | +---------------+---------+---------+---------+---------+---------+
Table P.2: Overview of affected commands
* * *
Command ND type NK type NA type NS type NL type SEND SS partial  
SEND USSD - MMI Mode partial  
SEND USSD - Application Mode partial  
OPEN CHANNEL related to (I-)WLAN bearer partial  
Geographical Location Request partial  
Note: \"O\" means support of this command is optional, \"partial\" means parts
of the command are affected. No indication means that the proactive command is
fully applicable.
* * *
###### ## Annex Q (normative): Default routing for USAT over AT interface
# Q.0 3GPP-specific facilities
The provisions of ETSI TS 102 223 [32] Annex T apply with the extensions given
below.
In addition to the facilities given in ETSI TS 102 223 [32], the facilities
given in table Q.1 may be supported by multiple entities at the same time.
Table Q.1: Additional facilities that may be supported by multiple entities
+-----------------------------------------------------------+---------+ | Facility | Remarks | +-----------------------------------------------------------+---------+ | Proactive UICC: REFRESH | | +-----------------------------------------------------------+---------+ | Proactive UICC: SET UP EVENT LIST | | +-----------------------------------------------------------+---------+ | Event: Data available | Note 2 | +-----------------------------------------------------------+---------+ | Event: Channel status | Note 2 | +-----------------------------------------------------------+---------+ | Event: Local connection | Note 2 | +-----------------------------------------------------------+---------+ | Proactive UICC: OPEN CHANNEL | Note 1 | +-----------------------------------------------------------+---------+ | Proactive UICC: CLOSE CHANNEL | Note 2 | +-----------------------------------------------------------+---------+ | Proactive UICC: RECEIVE DATA | Note 2 | +-----------------------------------------------------------+---------+ | Proactive UICC: SEND DATA | Note 2 | +-----------------------------------------------------------+---------+ | Proactive UICC: GET CHANNEL STATUS | Note 2 | +-----------------------------------------------------------+---------+ | Proactive UICC: SERVICE SEARCH | Note 2 | +-----------------------------------------------------------+---------+ | Proactive UICC: GET SERVICE INFORMATION | Note 2 | +-----------------------------------------------------------+---------+ | Proactive UICC: DECLARE SERVICE | Note 2 | +-----------------------------------------------------------+---------+ | Number of channels supported by terminal | Note 3 | +-----------------------------------------------------------+---------+ | TCP, UICC in client mode, remote connection | Note 2 | +-----------------------------------------------------------+---------+ | UDP, UICC in client mode, remote connection | Note 2 | +-----------------------------------------------------------+---------+ | Note 1: Uniqueness is provided by means of the bearer | | | type. | | | | | | Note 2: Uniqueness is provided by means of the channel | | | identifier. | | | | | | Note 3: The total number of channels supported shall be | | | sum of the respective number of supported channels by | | | each entity, limited to a maximum of 7. | | +-----------------------------------------------------------+---------+
The list of facilities given in ETSI TS 102 223 [32] that can be provided by
the MT only shall be considered a default list that applies if EF~UFC~ does
not exist (see TS 31.102 [14]). If EF~UFC~ exists, the list coded in this file
applies. However, the facilities below are inherent to MT operation and shall
be considered MT only even if not indicated so in EF~UFC~.
PROVIDE LOCAL INFORMATION (MCC, MNC, LAC/TAC, Cell Identity and Extended Cell
Identity)
PROVIDE LOCAL INFORMATION (NMR)
POLL INTERVAL
POLLING OFF
PROVIDE LOCAL INFORMATION (IMEI)
PROVIDE LOCAL INFORMATION (IMEISV)
PROVIDE LOCAL INFORMATION (Search Mode change)
PROVIDE LOCAL INFORMATION (NMR(UTRAN/E-UTRAN))
# Q.1 Default routing mechanism
In addition to the mechanism defined in ETSI TS 102 223 [32], the MT shall
route USAT commands as follows:
\- SET UP EVENT LIST shall be routed to all entities supporting the command,
each containing only the events supported by the entity, even if the list is
empty (which allows for proper deregistration of events set up earlier). For
the TERMINAL RESPONSE to the UICC, the responses from the MT and the TE have
to be combined as follows:
\- The MT shall check if it is able to set up the events it supports itself.
If the MT is currently unable to process command or if the set up of the
events would fail, the MT shall send this result in the TERMINAL RESPONSE
without forwarding the command to the TE.
\- If the MT is capable of setting up the MT events, the list of TE events
shall be forwarded to the TE and the TE shall send its TERMINAL RESPONSE.
\- If the TE command was successful, the MT shall set up its events and report
that the command was performed in the TERMINAL RESPONSE. If the MT or the TE
or both have performed the command with partial comprehension or with missing
information, this shall be reflected in the TERMINAL RESPONSE; if one reported
partial comprehension and the other missing information, the MT response takes
precedence.
\- If the TE reports that it is currently unable to process command or the
command failed, the MT shall report this in the TERMINAL RESPONSE.
\- REFRESH shall be routed to all entities supporting the command to inform
them about modified Efs; only the MT shall perform other activities indicated
in the command (e.g. UICC reset). For the TERMINAL RESPONSE to the UICC, the
responses from the MT and the TE have to be combined as follows:
\- The MT shall check if it is able to perform the REFRESH. If the MT is
currently unable to process the command or the command would fail, the MT
shall send this result in the TERMINAL RESPONSE without forwarding the command
to the TE.
\- If the MT is capable of performing the REFRESH, the command shall be
forwarded to the TE and the TE shall send its TERMINAL RESPONSE, but if there
is a refresh action to be performed by the MT (e.g. USIM initialisation), the
MT shall send its response to the TE\'s TERMINAL RESPONSE only after the
refresh action has started to avoid that the TE tries to access the UICC
before the refresh action.
\- If the TE command was successful, the MT shall perform the REFRESH and
report that the command was performed in the TERMINAL RESPONSE. If the MT or
the TE have performed the command with a limitation (partial comprehension,
missing information, additional Efs read, requested icon could not be
displayed or USIM/ISIM was not active) this shall be reflected in the TERMINAL
RESPONSE; if both reported different limitations, the MT response takes
precedence.
\- If the TE reports that it is currently unable to process command or the
command failed, the MT shall report this in the TERMINAL RESPONSE.
\- OPEN CHANNEL shall be routed according to the indicated bearer type. To
avoid conflicts in channel identifier assignment, the MT shall replace the
destination device identity by an available channel identifier and the entity
providing the bearer type shall use this channel identifier in its response.
\- Subsequent BIP commands shall be routed according to the channel
identifier.
# Q.2 Combination rules for terminal profiles
In addition to the mechanism defined in ETSI TS 102 223 [32], the MT shall
proceed as follows when combining the MT and TE profiles:
\- Number of channels supported by terminal for BIP: Here the indicated
numbers of the different entities shall be added and the sum, limited to a
maximum of 7, shall be provided in the combined terminal profile.
###### ## Annex R (informative): UICC access to IMS, command flow examples
This annex applies if class \"e\" and \"t\" are supported.
The flowcharts provided in this annex are illustrative examples. The listing
of commands is not exhaustive and the timing/order of commands may differ. All
SIP requests and responses received by the ME within the SIP dialog
established by the SIP INVITE request are sent to the UICC.
# R.1 Discovery of the UICC\'s IARI and IMS Registration
* * *
UICC ME IMS network
* * *
+----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← TERMINAL PROFILE (support of | | | UICC access to IMS) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | SET UP EVENT LIST (IMS | | | Registration, Incoming IMS data, | | | Data Available) → | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← READ BINARY (ISIM Service | | | Table) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Support of IARI list, SW=9000 → | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← READ BINARY (IARI list) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | IARI list, SW=9000 → | | +----------------------------------+----------------------------------+ | | SIP REGISTER (UICC IARI(s), ME | | | IARI(s)) → | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | ← SIP : 200 OK | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | SIP SUBSCRIBE (Registration | | | event package) → | | | | | | ← SIP : 200 OK | | | | | | ← SIP : NOTIFY (Registration | | | event package -- active | | | IMPU/contacts list) | | | | | | SIP : 200 OK → | +----------------------------------+----------------------------------+ | ← ENVELOPE (Event download -- | | | IMS Registration) | | | | | | IMPU list | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+
Figure R.1
If the ISIM is present, the list of IARIs associated with active applications
installed on the UICC is located in the ISIM. Otherwise, the list of IARIs
associated with active applications installed on the UICC is located in the
USIM. The case where the ISIM is supported is shown in the command flow.
The ME will register the IARI(s) associated with active applications installed
on the UICC and the IARI(s) of applications installed in the ME. The ME does
not need to wait for SET UP EVENT LIST command to register to IMS.Therefore it
is recommended that the UICC sends the SET UP EVENT LIST as soon as possible
to avoid the case where the ME registers to the IMS network before the UICC
can be informed of this.
Since the IMS Registration and Incoming IMS data events may occur at anytime,
it is assumed that the UICC will keep monitoring both events.
# R.2 Notification of Incoming IMS data
* * *
UICC ME IMS network
* * *
+----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | ← SIP : INVITE (UICC IARI) | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← ENVELOPE (event download : | | | Incoming IMS data) with the IARI | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | OPEN CHANNEL for IMS → | | +----------------------------------+----------------------------------+ | IARI, buffer size | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← Terminal Response (Channel | | | identifier) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← ENVELOPE (event download : | | | Data Available) | | | | | | RECEIVE DATA → | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← Terminal Response (SIP INVITE | | | message) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | SEND DATA (Immediate, Data) → | | +----------------------------------+----------------------------------+ | | SIP : 200 OK → | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← Terminal Response (OK) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | SEND DATA (Immediate, Data) → | --------------------------- | | | -------------------------------- | | | [Messages specific to th | | | e current SIP dialog not shown] | | | SIP : BYE → | | | --------------------------- | | | -------------------------------- | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← Terminal Response (OK) | | +----------------------------------+----------------------------------+ | ← ENVELOPE (event download : | ← SIP : 200 OK | | Data available) with the Channel | | | identifier | | +----------------------------------+----------------------------------+ | RECEIVE DATA → | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← Terminal Response (OK) | | +----------------------------------+----------------------------------+ | CLOSE CHANNEL(Channel | | | identifier) → | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← Terminal Response(OK) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+
Figure R.2
When an incoming SIP message is received, the ME checks the IARI to see if the
destination application resides on ME or on the UICC. If the IARI is
associated with an active application installed on the UICC and there is not
any channel to the UICC associated with that IARI, the ME informs the UICC
with an ENVELOPE Incoming IMS data event command. The UICC sends an Open
Channel for IMS proactive command upon reception of this ENVELOPE command. At
end of the SIP dialog, the UICC closes the channel to free resources.
This flowchart occurs after a successful IMS registration is completed and the
UICC is registered to the Incoming IMS data event. Otherwise the ME discards
the incoming SIP INVITE message.
# R.3 UICC originating a SIP message
* * *
UICC ME IMS network
* * *
* * *
OPEN CHANNEL for IMS →  
IARI, buffer size
← Terminal Response (Channel identifier)
SEND DATA (store, Data) →
← Terminal Response (OK)
SEND DATA (Immediate, Data) →  
SIP : INVITE →
← Terminal Response (OK)
                                                                              ← SIP : 200 OK
                                                                              \[Messages specific to the current SIP dialog not shown\]
                                                                              ← SIP : BYE
← ENVELOPE (event download : Data available) with the Channel identifier
RECEIVE DATA →
← Terminal Response (OK)
SEND DATA (Immediate, Data) →
                                                                              SIP : 200 OK →
CLOSE CHANNEL(Channel identifier) →
← Terminal Response(OK)
* * *
Figure R.3
The UICC will close the channel at the end of the SIP dialog.
###### ## Annex S (normative): 3GPP PS data off and Bearer Independent
Protocol
This annex applies if class \"e\" is supported.
The UE may support the 3GPP PS data off.
If the UE supports the 3GPP PS data off, the UE may be configured with an
indication whether the Bearer Independent Protocol is a 3GPP PS data off
exempt service using one or more of the following methods:
\- the Bearer Independent Protocol indication of the EF~3GPPPSDATAOFF~ file
described in 3GPP TS 31.102 [14];
\- the 3GPP_PS_data_off/Bearer_independent_protocol node of 3GPP TS 24.368
[68].
If the UE is configured with both the BIP_exempt node of 3GPP TS 24.368 [68]
and the Bearer Independent Protocol indication of the EF~3GPPPSDATAOFF~ file
described in 3GPP TS 31.102 [14], then the Bearer Independent Protocol
indication of the EF~3GPPPSDATAOFF~ file shall take precedence.
###### ## Annex T (informative): Data Connection Status change event, command
flow examples
# T.1 Introduction
This annex applies if class \"e\" is supported.
The flowcharts provided in this annex are illustrative examples. The listing
of commands is not exhaustive and the timing/order of commands may differ.
They are illustrating how after a completion of PDP, PDN or PDU procedure,
initiated by Network or by the ME, a new Data connection status change event
is sent to the UICC.
# T.2 Success activation of PDP/PDN/PDU request flow example
* * *
UICC ME Network
* * *
+---------------------------------------+---------------------------------+ | Initial status -- PDP Inactive | | +---------------------------------------+---------------------------------+ | | | +---------------------------------------+---------------------------------+ | | | +---------------------------------------+---------------------------------+ | | ACTIVATE PDP CONTEXT REQUEST → | +---------------------------------------+---------------------------------+ | | | +---------------------------------------+---------------------------------+ | | | +---------------------------------------+---------------------------------+ | | ← ACTIVATE PDP CONTEXT ACCEPT | +---------------------------------------+---------------------------------+ | | | +---------------------------------------+---------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status : Data connection successful) | | +---------------------------------------+---------------------------------+ | | | +---------------------------------------+---------------------------------+ | Final Status -- PDP active | | +---------------------------------------+---------------------------------+
Figure T.2.1 Successful PDP context activation procedure
* * *
UICC ME Network
* * *
+----------------------------------+----------------------------------+ | Initial status -- Bearer context | | | Inactive | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | PDN CONNECTIVITY REQUEST → | +----------------------------------+----------------------------------+ | | ←ACTIVATE DEFAULT CONTEXT | | | REQUEST | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | ACTIVATE DEFAULT CONTEXT ACCEPT | | | → | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status : Data connection | | | successful) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Final Status -- Bearer context | | | active | | +----------------------------------+----------------------------------+
Figure T.2.2 Successful PDN context activation procedure
* * *
UICC ME Network
* * *
+----------------------------------+----------------------------------+ | Initial status -- PDU session | | | not established | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | PDU SESSION ESTABLISHMENT | | | REQUEST → | +----------------------------------+----------------------------------+ | | ←PDU SESSION ESTABLISHMENT | | | ACCEPT | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status : Data connection | | | successful) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Final Status -- PDU session | | | established | | +----------------------------------+----------------------------------+
Figure T.2.3 Successful PDU session establishment procedure
# T.3 Rejected activation of PDP/PDN/PDU request flow example
* * *
UICC ME Network
* * *
+------------------------------------+---------------------------------+ | Initial status -- PDP Inactive | | +------------------------------------+---------------------------------+ | | | +------------------------------------+---------------------------------+ | | | +------------------------------------+---------------------------------+ | | ACTIVATE PDP CONTEXT REQUEST → | +------------------------------------+---------------------------------+ | | | +------------------------------------+---------------------------------+ | | | +------------------------------------+---------------------------------+ | | ← ACTIVATE PDP CONTEXT REJECT | +------------------------------------+---------------------------------+ | | | +------------------------------------+---------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status: Data connection rejected) | | +------------------------------------+---------------------------------+ | | | +------------------------------------+---------------------------------+ | Final status -- PDP inactive | | +------------------------------------+---------------------------------+
Figure T.3.1 Rejected PDP context activation procedure when initiated by the
ME
* * *
UICC ME Network
* * *
+----------------------------------+----------------------------------+ | Initial status -- Bearer context | | | Inactive | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | PDN CONNECTIVITY REQUEST → | +----------------------------------+----------------------------------+ | | ← ACTIVATE DEFAULT CONTEXT | | | REQUEST | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | ACTIVATE DEFAULT CONTEXT REJECT | | | → | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status : Data connection | | | rejected) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Final Status -- Bearer context | | | inactive | | +----------------------------------+----------------------------------+
Figure T.3.2 Rejected PDN context activation procedure when initiated by the
ME
* * *
UICC ME Network
* * *
+----------------------------------+----------------------------------+ | Initial status -- PDU session | | | not establihed | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | PDU SESSION ESTABLISHMENT | | | REQUEST → | +----------------------------------+----------------------------------+ | | ← PDU SESSION ESTABLISHMENT | | | REJECT | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status : Data connection | | | rejected) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | Final Status -- PDU session not | | | established | | +----------------------------------+----------------------------------+
Figure T.3.3 Rejected PDU session establishment procedure when initiated by
the ME
# T.4 PDP/PDN/PDU Data connection deactivated flow example
* * *
UICC ME Network
* * *
+----------------------------------+----------------------------------+ | Initial status -- PDP/Bearer | | | Context Active | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | DEACTIVATE PDP/REQUEST / PDN | | | DISCONNECT REQUEST → | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | ← DEACTIVATE PDP/EPS BEARER | | | CONTEXT ACCEPT | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status: Data connection | | | deactivated) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | > Final status -- PDP/Bearer | | | > Context Inactive | | +----------------------------------+----------------------------------+
Figure T.4.1 MS Initiated PDP/PDN context deactivation procedure
* * *
UICC ME Network
* * *
+----------------------------------+----------------------------------+ | Initial status -- PDP/Bearer | | | context Active | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | DEACTIVATE PDP/EPS BEARER | | | CONTEXT REQUEST | +----------------------------------+----------------------------------+ | | ← | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | | →DEACTIVATE PDP/EPS BEARER | | | CONTEXT ACCEPT | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status: Data connection | | | deactivated) | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | > Final status -- PDP/Bearer | | | > context Inactive | | +----------------------------------+----------------------------------+
Figure T.4.2 Network Initiated PDP/PDN context deactivation procedure
* * *
UICC ME Network
* * *
+-------------------------------------------+--------------------------------+ | Initial status -- PDU session established | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | PDU SESSION RELEASE REQUEST → | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | PDU SESSION RELEASE COMMAND | +-------------------------------------------+--------------------------------+ | | ← | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | PDU SESSION RELEASE COMPLETE→ | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status: Data connection deactivated) | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | > Final status -- PDU session released | | +-------------------------------------------+--------------------------------+
Figure T.4.3 MS Initiated PDU session release procedure
* * *
UICC ME Network
* * *
+-------------------------------------------+--------------------------------+ | Initial status -- PDU session established | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | PDU SESSION RELEASE COMMAND | +-------------------------------------------+--------------------------------+ | | ← | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | | PDU SESSION RELEASE COMPLETE→ | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | ← DATA CONNECTION STATUS EVENT | | | | | | (Status: Data connection deactivated) | | +-------------------------------------------+--------------------------------+ | | | +-------------------------------------------+--------------------------------+ | > Final status -- PDU session released | | +-------------------------------------------+--------------------------------+
Figure T.4.4 Network Initiated PDU session release procedure
#