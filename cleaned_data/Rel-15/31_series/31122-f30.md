# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document provides the Conformance Test Specification for a
Universal IC Card (UICC) defined in TS 31.101 [2] with Universal Subscriber
Identity Module (USIM) defined in TS 31.102 [3].
# 2 Normative References
The following documents contain provisions, which through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference to a non-3GPP document, the latest version
applies.
\- For a non-specific reference to a 3GPP document, the latest version in the
same release as the implementation release of the UICC under test applies.
[1] ETSI TS 102 221: \"UICC-Terminal Interface; Physical and Logical
Characteristics\".
[2] 3GPP TS 31.101: \"UICC-Terminal Interface; Physical and Logical
Characteristics\".
[3] 3GPP TS 31.102: \"Characteristics of the USIM application\".
[4] ISO/IEC 7816‑1: \"Identification cards ‑ Integrated circuit(s) cards with
contacts, Part 1: Physical characteristics\".
[5] ISO/IEC 7816‑2: \"Identification cards ‑ Integrated circuit cards \- Part
2: Card with contacts - Dimensions and locations of the contacts\".
[6] ISO/IEC 7816‑3: \"Identification cards ‑ Integrated circuit(s) cards with
contacts, Part 3: Electronic signals and transmission protocols\".
[7] ISO/IEC 7816‑4: \"Identification cards ‑ Integrated circuit cards \- Part
4: Organization, security and commands for interchange\".
[8] Void
[9] Void
[10] Void
[11] Void
[12] ISO/IEC 7811‑1: \"Identification cards - Recording technique - Part 1:
Embossing\"
[13] Void
[14] 3GPP TS 11.11: \"Digital cellular telecommunications system (Phase 2+);
Specification of the Subscriber Identity Module - Mobile Equipment (SIM - ME)
interface\".
[15] ETSI TS 101 220: \"Smart cards; ETSI numbering system for
telecommunication application providers\".
[16] ETSI TS 102 221 Release 99: \"UICC-Terminal Interface; Physical and
Logical Characteristics\".
[17] ETSI TS 102 221 Release 4: \"UICC-Terminal Interface; Physical and
Logical Characteristics\".
[18] ETSI TS 102 221 Release 5: \"UICC-Terminal Interface; Physical and
Logical Characteristics\".
[19] ISO/IEC 9646‑7 (1995): \"Information technology - Open Systems
Interconnection - Conformance testing methodology and framework - Part 7:
Implementation Conformance Statements\".
[20] ETSI TS 102 230 - 2 v9.1.0: \"UICC-Terminal interface; Physical,
electrical and logical test specification; Part 2: UICC features\".
# 3 Definitions, symbols, abbreviations and coding
## 3.1 Definitions
For the purposes of the present document, the following definitions apply in
addition to the terms defined in TS 102.221 [1] and TS 31.102 [3].
**Implementation Conformance Statement (ICS):** A statement made by the
supplier of an implementation or system claimed to conform to a given
specification, stating which capabilities have been implemented. The ICS can
take several forms: protocol ICS, profile ICS, profile specific ICS,
information object ICS, etc.
**ICS proforma:** A document, in the form of a questionnaire, which when
completed for an implementation or system becomes an ICS.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
t~F~ fall time
t~R~ rise time
V~IH~ Input Voltage (high)
V~IL~ Input Voltage (low)
V~OH~ Output Voltage (high)
V~OL~ Output Voltage (low)
## 3.3 Abbreviations
For the purposes of the present document, the following abbreviations apply:
CRn Conformance Requirement \'n\'
IUT Implementation Under Test
ME Mobile Equipment
TS Test Specification
UICC Universal Integrated Circuit Card
USIM Universal Subscriber Identity Module
## 3.4 Coding Conventions
The following coding conventions apply to the present document:
All lengths are presented in bytes, unless otherwise stated. Each byte is
represented by bit b8 to b1, where b8 is the most significant bit (MSB) and b1
is the least significant bit (LSB). In each representation, the leftmost bit
is the MSB.
## 3.5 Applicability
## 3.5.1 Applicability of the present document
The present document applies to a UICC which supports one or more USIMs.
## 3.5.2 Applicability to the UICC
The applicability to a UICC supporting one or more USIMs is specified in table
B.1, unless otherwise specified in the specific clause.
## 3.5.3 Applicability of the individual tests
Table B.1 lists the optional, conditional or mandatory features for which the
supplier of the implementation states the support. As pre-condition the
supplier of the implementation shall state the support of possible options in
table A.1.
The \"Release XY UICC\" columns shows the status of the entries as follows:
The following notations, defined in ISO/IEC 9646‑7 [19], are used for the
status column:
M mandatory - the capability is required to be supported.
O optional - the capability may be supported or not.
N/A not applicable - in the given context, it is impossible to use the
capability.
X prohibited (excluded) - there is a requirement not to use this capability in
the given context.
O.i qualified optional - for mutually exclusive or selectable options from a
set. \"i\" is an integer which identifies an unique group of related optional
items and the logic of their selection which is defined immediately following
the table.
Ci conditional - the requirement on the capability (\"M\", \"O\", \"X\" or
\"N/A\") depends on the support of other optional or conditional items. \"i\"
is an integer identifying an unique conditional status expression which is
defined immediately following the table. For nested conditional expressions,
the syntax \"IF ... THEN (IF ... THEN ... ELSE...) ELSE ...\" shall be used to
avoid ambiguities.
##### References to items {#references-to-items .H6}
For each possible item answer (answer in the support column) there exists a
unique reference, used, for example, in the conditional expressions. It is
defined as the table identifier, followed by a solidus character \"/\",
followed by the item number in the table. If there is more than one support
column in a table, the columns shall be discriminated by letters (a, b, etc.),
respectively.
EXAMPLE: A.1/4 is the reference to the answer of item 4 in table A.1.
### 3.5.4 Applicability of conformance requirements
All conformance requirements are annotated with their applicability. This
clause defines the notation used.
The basic notation is as follows:
(DefinedRelease) ReleaseRange: Options
The components of the notation are as follows:
+----------------+-------------------------+-------------------------+ | **Component** | **Content** | **Example content** | +================+=========================+=========================+ | DefinedRelease | Contains a single | R99 | | | release. | | | | | Rel-6 | | | Optional (along with | | | | the surrounding | | | | parentheses). | | | | | | | | If present, it | | | | indicates the release | | | | of the core | | | | specification in which | | | | the conformance | | | | requirement was first | | | | defined. This is | | | | intended for | | | | conformance | | | | requirements which were | | | | defined in a certain | | | | release of the core | | | | specification but for | | | | which tests were not | | | | introduced into this | | | | document until a later | | | | release. | | | | | | | | If absent, this | | | | indicates that the | | | | conformance requirement | | | | was introduced in the | | | | first release contained | | | | in ReleaseRange. | | +----------------+-------------------------+-------------------------+ | ReleaseRange | Contains a single | R99 | | | release or a range of | | | | releases. An ellipsis | R99 - Rel-5 | | | (...) in the right-hand | | | | part indicates the | Rel-6 - ... | | | current release of this | | | | document. | | | | | | | | Optional; but at least | | | | one of ReleaseRange and | | | | Options must be | | | | present. | | | | | | | | If present, it | | | | indicates the range of | | | | releases for which the | | | | conformance requirement | | | | is tested. | | | | | | | | If absent, it is | | | | equivalent to \"R99 - | | | | ...\". | | +----------------+-------------------------+-------------------------+ | Options | A comma-separated list | O_LOG_CHANS | | | containing at least one | | | | of the options in table | O_LOG_CHANS, | | | A.1. | O_SHAREABLE | | | | | | | Optional (along with | | | | the preceding colon); | | | | but at least one of | | | | ReleaseRange and | | | | Options must be | | | | present. | | | | | | | | If present, this | | | | indicates that the | | | | conformance requirement | | | | is only applicable to | | | | UICCs supporting all of | | | | the specified options. | | | | | | | | If absent, this | | | | indicates that the | | | | conformance requirement | | | | applies to all UICCs. | | +----------------+-------------------------+-------------------------+
An additional shortcut notation for \"R99 - ...\" is specified: \"M\". This
indicates that the conformance requirement is mandatory for all UICCs of all
releases.
Examples of the notation are as follows:
**Example** **Meaning**
* * *
(Rel-4) Rel-6 -- ...: O_LOG_CHANS Conformance requirement introduced in Rel-4,
but not tested until Rel-6, where it is only applicable if O_LOG_CHANS is
supported. (Rel-4) Rel-6 -- ...: O_LOG_CHANS, O_SHAREABLE Conformance
requirement introduced in Rel-4, but not tested until Rel-6, where it is only
applicable if O_LOG_CHANS and O_SHAREABLE are supported. Rel-6 -- ...:
O_LOG_CHANS Conformance requirement introduced in Rel-6, where it is only
applicable if O_LOG_CHANS is supported. Rel-6 -- ...: O_LOG_CHANS, O_SHAREABLE
Conformance requirement introduced in Rel-6, where it is only applicable if
O_LOG_CHANS and O_SHAREABLE are supported. R99 - Rel-5 Mandatory for all UICCs
from R99 to Rel-5. Rel-6 - ... Mandatory for all UICCs from all releases up to
and including the current release of this document. O_MONO_APP Applies to all
releases, but only applicable if O_MONO_APP is supported by the UICC. M
Mandatory for all releases; equivalent to \"R99 - ...\".
## 3.6 Table of optional features
Support of several features is optional, release dependent or configuration
dependent for the UICC. However, if a UICC states conformance with a specific
3GPP release, it is mandatory for the UICC to support all mandatory functions
of that release, as stated in table A.1.
The \"Option defined in Releases\" column indicates the releases of the
relevant core specification(s) in which the option is defined.
The supplier of the implementation shall state the support of possible options
in table A.1.
A supplier may choose to use a single UICC and reconfigure it as required for
each test; or may choose to use a number of UICCs which are based on the same
platform but are configured differently. The supplier shall state the chosen
solution and in the latter case shall confirm usage of identical platforms.
Table A.1: Options
* * *
Option Status Option defined in Releases Support Mnemonic ID-1 UICC O.1 R99
O_ID1_UICC Plug-in UICC O.1 R99 O_PLUG_IN_UICC Type 1 (i.e. UICC which always
enters the negotiable mode after a warm reset) O.2 R99 O_TYPE_1 Type 2 (UICC
which always enters the specific mode after a warm reset) O.2 R99 O_TYPE_2 T=0
O.3 R99 O_T0 T=1 O.3 R99 O_T1 Mono application UICC O.4 R99 O_MONO_APP Multi-
application UICC O.4 R99 O_MULTI_APP Single verification capable UICC O.5 R99
O_SINGLE_VER Multi-verification capable UICC O.5 R99 O_MULTI_VER More than one
logical channel supported O Rel-4 O_LOG_CHANS More than two logical channels
supported O Rel-4 O_LOG_CHANS_34 Shareable files O Rel-4 O_SHAREABLE Non-
shareable files O Rel-4 O_NON_SHAREABLE GET CHALLENGE O Rel-4 O_GET_CHALLENGE
Mini-UICC O.1 Rel-6 O_MINI_UICC (F, D) = (512, 64) O Rel-6 O_F_D_512_64 Low
impedance drivers O Rel-6 O_LOW_IMPEDANCE BER-TLV structure EFs O Rel-6
O_BER_TLV_FILES GET IDENTITY when SUCI calculation performed by the USIM O
Rel-15 O_GET IDENTITY_SUCI
* * *
## 3.7 Applicability table
Table B.1: Applicability of tests
**Clause** **Description** **Test procedure** **Tested features defined in
Release** **R99 UICC** **Rel-4 UICC** **Rel-5 UICC** **Rel-6 UICC** **Rel-7
UICC** **Rel-8 UICC** **Rel-9 UICC** **Rel-10 UICC** **Rel-11 UICC** **Rel-12
UICC** **Rel-13 UICC** **Rel-14 UICC** **Rel-15 UICC** **Support**
* * *
6.1.1 **ID-1 UICC** 1 R99 **C001** **C001** **C001** **C001** **C001**
**C001** **C001** **C001** **C001** **C001** **C001** **C001** **C001**  
6.1.2 **Plug-in UICC** 1 R99 C002 C002 C002 C002 C002 C002 C002 C002 C002 C002
C002 C002 C002  
6.1.3 **Temperature range for card operation** 1 R99 M **M** **M**  
2 Rel-6 **M** **M** **M** **M** **M** **M** **M** **M** **M** **M**  
6.1.4 **Contacts** N/A  
6.1.5 **Mini-UICC** 1 Rel-6 **C003** **C003** **C003** **C003** **C003**
**C003** **C003** **C003** **C003** **C003**  
6.2.1.1 **Vcc -- Voltage limits** 1 R99 M M M M M M M M M M M M M  
6.2.1.2 **Vcc - Idle current limits** 1 R99 M M M M M M M M M M M M M  
6.2.1.3 **Vcc - Current limits in clk-stop-mode** 1 R99 M M M M M M M M M M M
M M  
6.2.2.1 **RST - Static operation** 1 R99 M M M M M M M M M M M M M  
6.2.3.1 **Vpp - Static operation** 1 R99 M M M M M M M M M M M M M  
6.2.4.1 **CLK - Frequency and duty cycle** 1 R99 M M M M M M M M M M M M M  
6.2.4.2 **Voltage and current** 1 R99 M M M M M M M M M M M M M  
6.2.5.1 **I/O - Voltage and current** 1 R99 M M M C018 C018 C018 C018 C018
C018 C018 C018 C018 C018  
2 Rel-6 C019 C019 C019 C019 C019 C019 C019 C019 C019 C019  
3 Rel-6 C020 C020 C020 C020 C020 C020 C020 C020 C020 C020  
6.3.1.1 **Supply voltage switching - Supply voltage classes** N/A  
6.3.1.2 **Supply voltage switching - Power consumption of the UICC during
ATR** 1 R99 M M M M M M M M M M M M M  
6.3.1.3 **Supply voltage switching - Application related electrical
parameters** 1 R99 M M M M M M M M M M M M M  
6.3.2.1 **ATR - Major capabilities** 1 R99 M M M M M M M M M M M M M  
6.3.2.2 **ATR - Speed enhancement** 1 R99 M M M M M M M M M M M M M  
6.3.2.3 **Global Interface bytes** 1 Rel-6 M M M M M M M M M M  
6.3.3 **PPS procedure** 1 R99 M M M M M M M M M M  
6.3.4 **Reset procedures** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M M M M M M M M  
3 R99 C004 C004 C004 C004 C004 C004 C004 C004 C004 C004  
4 R99 C005 C005 C005 C005 C005 C005 C005 C005 C005 C005  
6.3.5 **Clock stop mode** 1 R99 M M M M M M M M M M M M M  
6.3.6 **Bit/character duration and sampling time** N/A  
6.3.7 **Error handling** 1 R99 M M M M M M M M M M M M M  
6.3.8 **Compatibility** N/A  
6.4.1 **Physical Layer** N/A  
6.4.2.1 **Character Frame** 1 R99 M M M M M M M M M M M M M  
6.4.2.2 **Transmission Protocol T=0** 1 R99 C006 C006 C006 C006 C006 C006 C006
C006 C006 C006 C006 C006 C006  
6.4.2.3.1.1 **T=1 - Information field size** 1 R99 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.1.2 **T=1 - Character waiting integer** 1 R99 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.1.3 **T=1 - Character waiting time** 1 R99 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.1.4 **T=1 - Block guard time** 1 R99 C007 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.1.5 **T=1 - Waiting time extension** N/A  
6.4.2.3.1.6 **T=1 - Error detection code** 1 R99 C007 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.2.1.1 **T=1 - Prologue field - Node address byte** 1 R99 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.2.1.2 **T=1 - Prologue field - Protocol Control Byte** N/A  
6.4.2.3.2.1.3 **T=1 - Prologue field - Length** 1 R99 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.2.1.4 **T=1 - Information field** 1 R99 C007 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.2.3 **T=1 - Epilogue field** 1 R99 C007 C007 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007  
6.4.2.3.3 **T=1 - Error free operation** 1 R99 C007 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.4.1 **T=1 - Error Handling - Protocol initialisation** 1 R99 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.4.2.1 **T=1 - Error Handling - Sending invalid blocks to the UICC** 1
R99 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.4.2.3.5 **T=1 - Chaining** 1 R99 C007 C007 C007 C007 C007 C007 C007 C007
C007 C007 C007 C007 C007  
6.4.3.1.1 **Transportation of an APDU using T=0 - Case 1** 1 R99 C006 C006
C006 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006  
6.4.3.1.2 **Transportation of an APDU using T=0 - Case 2** 1 R99 C006 C006
C006 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006  
6.4.3.1.3 **Transportation of an APDU using T=0 - Case 3** 1 R99 C006 C006
C006 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006  
6.4.3.1.4 **Transportation of an APDU using T=0 - Case 4** 1 R99 C006 C006
C006 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006  
6.4.3.1.5.1 **Use of Procedure Bytes \'61xx\' and \'6Cxx\' - Case 2 Commands**
1 R99 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006 C006  
6.4.3.1.5.2 **Use of Procedure Bytes \'61xx\' and \'6Cxx\' - Case 4 Commands**
N/A  
6.4.3.2.1 **Transportation of an APDU using T=1 - Case 1** 1 R99 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.4.3.2.2 **Transportation of an APDU using T=1 - Case 2** 1 R99 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.4.3.2.3 **Transportation of an APDU using T=1 - Case 3** 1 R99 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.4.3.2.4 **Transportation of an APDU using T=1 - Case 4** 1 R99 C007 C007
C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.4.4 **Application Layer** N/A  
6.5.1 **UICC Application structure** 1 R99 M M M M M M M M M M M M M  
6.5.2.1 **Dedicated files** N/A  
6.5.2.2.1 **Transparent EF** 1 R99 M M M M M M M M M M M M M  
6.5.2.2.2 **Linear fixed EF** 1 R99 M M M M M M M M M M M M M  
6.5.2.2.3 **Cyclic EF** 1 R99 M M M M M M M M M M M M M  
6.5.2.2.4 **BER-TLV structure EF** N/A  
6.5.3 **File referencing** N/A  
6.5.4.1 **SELECT by File Identifier Referencing** 1 R99 M M M M M M M M M M M
M M  
6.5.4.2 **SELECT by Path Referencing** 1 R99 M M M M M M M M M M M M M  
6.5.4.3 **Short File Identifier** 1 R99 M M M M M M M M M M M M M  
6.5.5.1.1 **SELECT by DF Name** 1 R99 M M M M M M M M M M M M M  
6.5.5.1.2 **SELECT by partial DF Name** 1 R99 C009 C009 C009 C009 C009 C009
C009 C009 C009 C009  
2 R99 C008 C008 C008  
3 R99 C008 C008 C008 C008 C008 C008 C008 C008 C008 C008  
6.5.5.2 **Application session activation** 1 R99 M M M M M M M M M M M M M  
6.5.5.3 **Application session termination** 1 R99 C008 C008 C008 C008 C008
C008 C008 C008 C008 C008 C008 C008 C008  
2 R99 M M M  
3 Rel-6 M M M M M M M M M M  
4 R99 M M M M M M M M M M M M M  
5 Rel-4 C010 C010 C010 C010 C010 C010 C010 C010 C010 C010  
6.5.5.4 **Application session reset** 1 R99 M M M M M M M M M M M M M  
6.5.5.5 **GSM/USIM application interaction and restrictions** 1 R99 M M M  
6.5.6 **Reservation of file IDs** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M  
3 R99 M M M M M M M M M M  
6.5.7.1 **No Logical Channel Support** 1 Rel-4 C011 C011 C011 C011 C011 C011
C011 C011 C011 C011  
6.5.7.2 **Logical Channels - Basic Behaviour** 1 Rel-4 C010 C010 C010 C010
C010 C010 C010 C010 C010 C010  
2 Rel-4 C012 C012 C012 C012 C012 C012 C012 C012 C012 C012  
6.5.7.3 **Opening a Logical Channel from the Basic Channel** 1 Rel-4 C010 C010
C010 C010 C010 C010 C010 C010 C010 C010  
6.5.7.4 **Opening a Logical Channel from a Non-Basic Channel** 1 Rel-4 C013
C013 C013 C013 C013 C013 C013 C013 C013 C013  
6.5.7.5 **Opening a Logical Channel on Non-Shareable Files** 1 Rel-4 C014 C014
C014 C014 C014 C014 C014 C014 C014 C014  
6.5.7.6 **Logical Channels and Shareable Files** 1 Rel-6 C014 C014 C014 C014
C014 C014 C014 C014 C014 C014  
2 Rel-4 C015 C015 C015 C015 C015 C015 C015 C015 C015 C015  
6.5.7.7 **Logical channels - Command Interdependencies** 1 Rel-4 C015 C015
C015 C015 C015 C015 C015 C015 C015 C015  
6.5.7.8 **Logical channels - Consistency of File Updates** 1 Rel-4 C015 C015
C015 C015 C015 C015 C015 C015 C015 C015  
6.6.1 **Supported security features** 1 R99 C016 C016 C016 C016 C016 C016 C016
C016 C016 C016 C016 C016 C016  
2 R99 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017  
6.6.2 **Security architecture** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M M M M M M M M  
6.6.3 **Security environment** 1 R99 C016 C016 C016 C016 C016 C016 C016 C016
C016 C016 C016 C016 C016  
6.6.4 **PIN definitions** 1 R99 C016 C016 C016  
2 R99 C016 C016 C016 C016 C016 C016 C016 C016 C016 C016  
3 R99 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017  
6.6.5 **PIN and key reference relationship** 1 R99 C016 C016 C016 C016 C016
C016 C016 C016 C016 C016 C016 C016 C016  
2 R99 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017  
6.7.1 **Mapping principles** 1 R99 M M M M M M M M M M M M M  
6.7.2.1 **Status Conditions Returned by the UICC** 1 R99 M M M M M M M M M M M
M M  
6.7.2.2 **Status Words of the Commands** N/A  
6.7.3 **Logical Channels** N/A  
6.8.1.1 **SELECT** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M M M M M M M M  
6.8.1.2 **STATUS** 1 R99 M M M M M M M M M M M M M  
6.8.1.3 **READ BINARY** 1 R99 M M M M M M M M M M M M M  
6.8.1.4 **UPDATE BINARY** 1 R99 M M M M M M M M M M M M M  
6.8.1.5 **READ RECORD** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M M M M M M M M M M M  
3 R99 M M M M M M M M M M M M M  
6.8.1.6 **UPDATE RECORD** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M M M M M M M M M M M  
3 R99 M M M M M M M M M M M M M  
6.8.1.7 **SEARCH RECORD** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M M M M M M M M M M M  
3 R99 M M M M M M M M M M M M M  
4 R99 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
6.8.1.8 **INCREASE** 1 R99 M M M M M M M M M M M M M  
6.8.1.9 **VERIFY PIN** 1 R99 M M M M M M M M M M M M M  
2 Rel-4 C010 C010 C010 C010 C010 C010 C010 C010 C010 C010  
3 R99 M M M M M M M M M M  
6.8.1.10 **CHANGE PIN** 1 R99 M M M M M M M M M M M M M  
2 Rel-4 C010 C010 C010 C010 C010 C010 C010 C010 C010 C010  
6.8.1.11 **DISABLE PIN** 1 R99 M M M M M M M M M M M M M  
6.8.1.12 **ENABLE PIN** 1 R99 M M M M M M M M M M M M M  
6.8.1.13 **UNBLOCK PIN** 1 R99 M M M M M M M M M M M M M  
2 R99 M M M M M M M M M M M M M  
3 R99 M M M M M M M M M M  
4 Rel-4 C010 C010 C010 C010 C010 C010 C010 C010 C010 C010  
6.8.1.14 **DEACTIVATE FILE** 1 R99 M M M M M M M M M M M M M  
6.8.1.15 **ACTIVATE FILE** 1 R99 M M M M M M M M M M M M M  
6.8.1.16 **AUTHENTICATE** N/A  
6.8.1.17 **MANAGE CHANNEL** N/A  
6.8.1.18 **GET CHALLENGE** 1 Rel-4 C021 C021 C021 C021 C021 C021 C021 C021
C021 C021  
**6.8.2.1** **RETRIEVE DATA** 1 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022
C022 C022  
2 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022 C022  
3 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022 C022  
**6.8.2.2** **SET DATA** 1 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022
C022  
2 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022 C022  
3 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022 C022  
4 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022 C022  
**6.8.2.3** **BER-TLV structure files** 1 Rel-6 C022 C022 C022 C022 C022 C022
C022 C022 C022 C022  
2 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022 C022  
3 Rel-6 C022 C022 C022 C022 C022 C022 C022 C022 C022 C022  
**6.8.2.4** **Logical channel interactions** 1 Rel-6 C023 C023 C023 C023 C023
C023 C023 C023 C023 C023  
2 Rel-6 C023 C023 C023 C023 C023 C023 C023 C023 C023 C023  
3 Rel-6 C023 C023 C023 C023 C023 C023 C023 C023 C023 C023  
6.9.1.1 **GET RESPONSE** 1 R99 M M M M M M M M M M M M M  
6.10 **Application independent files** 1 R99 M M M M M M M M M M M M M  
7.1 **Contents of the Elementary Files (EF)** 1 R99 M M M M M M M M M M  
2 R99 M M M  
7.2 **Security features** 1 R99 C016 C016 C016 C016 C016 C016 C016 C016 C016
C016 C016 C016 C016  
7.3.1 **AUTHENTICATE** 1 R99 M M M M M M M M M M M M M  
7.3.2.1 **Security management** 1 R99 M M M M M M M M M M M M M  
7.3.2.2 **Status Words of the Commands** N/A  
7.3.3 **GET IDENTITY** 1 Rel-15 N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A N/A
N/A C024  
8.1.1 **GSM/USIM application interaction and restrictions** 1 Rel-6 M M M M M
M M M M M  
8.2.1 **Transmission speed** 1 Rel-6 C006 C006 C006 C006 C006 C006 C006 C006
C006 C006  
1 Rel-6 C007 C007 C007 C007 C007 C007 C007 C007 C007 C007  
8.2.2 **Voltage classes** 1 Rel-6 M M M M M M M M M M  
8.2.3 **File Control Parameters (FCP)** 1 Rel-6 M M M M M M M M M M  
8.3 **User verification and file access conditions** 1 Rel-6 C016 C016 C016
C016 C016 C016 C016 C016 C016 C016  
2 Rel-6 C017 C017 C017 C017 C017 C017 C017 C017 C017 C017  
8.4.1 **Contents of the EFs at the MF level** 1 Rel-6 M M M M M M M M M M
**Clause** | **Description** | **Test procedure** | **Tested features defined in Release** | **R99 UICC** | **Rel-4 UICC** | **Rel-5 UICC** | **Rel-6 UICC** | **Rel-7 UICC** | **Rel-8 UICC** | **Rel-9 UICC** | **Rel-10 UICC** | **Rel-11 UICC** | **Rel-12 UICC** | **Rel-13 UICC** | **Rel-14 UICC** | **Rel-15 UICC** | **Support**  
---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---  
C001 IF O_ID1_UICC THEN M ELSE N/A C002 IF O_PLUG_IN_UICC THEN M ELSE N/A C003 IF O_MINI_UICC THEN M ELSE N/A C004 IF O_TYPE_1 THEN M ELSE N/A C005 IF O_TYPE_2 THEN M ELSE N/A C006 IF O_T0 THEN M ELSE N/A C007 IF O_T1 THEN M ELSE N/A C008 IF O_MULTI_APP THEN M ELSE N/A C009 IF O_MONO_APP THEN M ELSE N/A C010 IF **O_LOG_CHANS THEN M ELSE N/A** C011 IF (NOT **O_LOG_CHANS) THEN M ELSE N/A** **C012 IF** O_LOG_CHANS_34 **THEN M ELSE N/A** **C013 IF (O_LOG_CHANS_34 AND O_SHAREABLE) THEN M ELSE N/A** **C014 IF (O_LOG_CHANS AND O_NON_SHAREABLE) THEN M ELSE N/A** **C015 IF (O_LOG_CHANS AND O_SHAREABLE) THEN M ELSE N/A** C016 IF O_MULTI_VER THEN M ELSE N/A C017 IF O_SINGLE_VER THEN M ELSE N/A C018 IF (NOT O_F_D_512_64) THEN M ELSE N/A C019 IF O_F_D_512_64 THEN M ELSE N/A C020 IF O_LOW_IMPEDANCE THEN M ELSE N/A C021 IF O_GET_CHALLENGE THEN M ELSE N/A C022 IF O_BER_TLV_FILES THEN M ELSE N/A C023 IF (O_BER_TLV_FILES AND O_LOG_CHANS AND O_SHAREABLE) THEN M ELSE N/A C024 IF O_GET IDENTITY_SUCI **THEN M ELSE N/A** |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |   
# 4 Test environment
This clause specifies several requirements which shall be met, and a number of
rules which shall be adhered to before testing can proceed.
## 4.1 Test equipment
This clause recommends a minimum specification for each of the items of test
equipment referenced in the tests.
### 4.1.1 ME simulator
This item of equipment shall allow T = 0 and T = 1 protocol communications to
take place on both ID-1 and plug-in UICCs. It shall be able to generate and
send any command APDU and receive any of the possible responses. These
commands may be generated manually, one at a time, or automatically from a
predefined batch procedure containing one or more commands.
The ME simulator shall be able to support clock stop modes.
The ME simulator shall be able to accept an external clock signal to drive CLK
(contact C3) of the UICC.
It shall be possible to access all the UICC contacts either directly or
through test points.
### 4.1.2 Signal generation device
#### 4.1.2.1 Vcc
The voltage level for Vcc (contact C1) of the UICC shall be adjustable between
-0,5 V and 6,0 V to an accuracy of 1% of the nominal Vcc voltage (e.g. 50 mV
for class A operating conditions).
The ME simulator shall be able to source current on the Vcc contact in the
range ‑2 mA to 12 mA statically and to deliver charges of > 400 nAs without
lowering the Vcc voltage for more than 10 % of Vcc nominal. _(to be able to
detect current spikes generated by the UICC)_
#### 4.1.2.2 RST
The generated voltage level for RST (contact C2) of the UICC shall be
adjustable between -0,5 V and 6,0 V to an accuracy of 50 mV.
The rise and fall times shall be adjustable from 0 μs to 500 μs with an
accuracy of 5 μs. _(to check if the USIM works with the defined rise and fall
times.)_
The beginning of the rising edge shall be programmable from 1 clk-cycle to
50,000 clk-cycles after enabling the clk-line. _(to check if the UICC accepts
the minimum and maximum clk-cycle values)_
#### 4.1.2.3 CLK
This item of equipment shall be able to generate square wave signals for the
clock on the UICC, any of which can be a single-shot or continuous signal, in
the range 1 MHz to 5 MHz. The voltage levels for both high and low states
shall be adjustable between -0,5 V and 6,0 V to an accuracy of 0,1 V. The duty
cycle of the clock signal shall be adjustable between 40 % and 60 % to an
accuracy of 1 %. It shall also provide control over the following parameters:
The voltage levels for both high and low states shall be adjustable between 0
V and 6 V to an accuracy of 1% of the nominal Vcc voltage. The duty cycle of
the clock signal shall be adjustable between 40 % and 60 % to an accuracy of 1
% or 5 ns whichever is the worst.
It shall also provide control over the following parameters:
\- rise and fall time to an accuracy of 1 % or 5 ns whichever is the worst.
_(5 ns = 2,5 % accuracy for f~max~ = 5 MHz)._
#### 4.1.2.4 I/O
The equipment shall be able to generate I/O-Signals according to TS 102.221
[1]
The voltage levels for high and low states shall be adjustable between -0,5 V
and 6,0 V to an accuracy of 1 % of the nominal Vcc voltage. The I/O line in
transmission mode (high bit) shall be programmable between state A (active
driven output) and state Z (I/O-voltage-driver inactive, current source
I-I/O-high active).
It shall also provide control over the rise and fall time of 100 ns to 1 000
ns with an accuracy of 50 ns.
The ME simulator shall be able to source and sink currents on the I/O contact
in the range ‑20 μA to +20 μA in state high and 0 mA to ‑1 mA in state low
(receiving mode) and shall be able to switch in transmission mode (outputting
a high bit) between voltage and current driving mode.
The timing of the bitstream (jitter, guardtime, etu-value, etc.) on the
I/O-Line shall be programmable with an accuracy of ≤ 0,01 etu or 2 clk-cycles
whichever is the worst.
### 4.1.3 Precision force-inducing contacting device
This item of equipment shall be able to apply a prescribed and maintained
level of force onto one or more contacts of the UICC. The range shall be
between 0 and 0,5 N and accurate to 0,01 N.
### 4.1.4 Temperature controllable environment
This item of equipment shall be able to control the temperature of a chamber
large enough to enclose the UICC and the card reader. The range of temperature
control shall be between ‑25 °C and +85 °C to an accuracy of 0,5 °C.
### 4.1.5 Temperature measuring device
This item of equipment shall be able to measure the temperature of the UICC to
within 0,5 °C. The range of this device shall allow measurement of
temperatures between ‑25 °C and +85 °C.
### 4.1.6 Voltage measuring device
This item of equipment shall be able to measure static and transient voltages
on any one of the contacts of the UICC. The measurable voltage range shall be
between ‑2 V and +7 V to an accuracy of 1% of the nominal Vcc voltage (e.g. 30
mV for class B operating conditions) with a timebase accuracy of 25 ns.
### 4.1.7 Precision measuring device
This item of equipment shall be able to measure both linear and radius of
curvature dimensions to an accuracy of 0,01 mm.
### 4.1.8 Current measuring device
This item of equipment shall be able to supervise the current levels for any
one of the contacts of the USIM.
The simulator shall be able to detect an over - or underload with a time
resolution of ≤ 100 ns.
+----------------+-----------+-----------+------------+ | Channel | Minimum | Maximum | Resolution | +================+===========+===========+============+ | Vcc high | -2 mA | +12,5 mA | 125 μA | +----------------+-----------+-----------+------------+ | Vcc low | -2 mA | +12,5 mA | 125 μA | +----------------+-----------+-----------+------------+ | | | | | +----------------+-----------+-----------+------------+ | Vcc Burst | 12 mA | +250 mA | 2,5 mA | +----------------+-----------+-----------+------------+ | RST/CLK | -50 μA | +50 μA | 1 μA | | | | | | | High state | | | | +----------------+-----------+-----------+------------+ | RST/CLK | -250 μA | +250 μA | 2,5 μA | | | | | | | Low state | | | | +----------------+-----------+-----------+------------+ | I/O high state | -50 μA | +50 μA | 1 μA | +----------------+-----------+-----------+------------+ | I/O low state | -1 500 μA | +1 500 μA | 15 μA | +----------------+-----------+-----------+------------+
### 4.1.9 Timing Measurements on contact I/O
To verify the timing of the I/O transmission from the UICC, the ME simulator
shall be able to measure the I/O-Bit-Timing in clk-cycles with an accuracy of
≤ 0,01 etu or 2 clk-cycles whichever is the worst.
## 4.2 IUT default conditions
Unless otherwise stated, the following is default:
\- The voltage level for Vcc (contact C1) shall be set to 3,0 V.
\- The voltage levels for CLK (contact C3) shall be set to 0 V and 3,0 V for
low and high respectively.
\- The clock frequency CLK (contact C3) shall be set to 5 MHz with duty cycle
50 %.
\- The ME simulator generated low transmission voltage level for I/O (contact
C7) shall be set to 0 V and the current sources for high transmission and
reception shall be set to -20 μA and +20 μA respectively
\- Any level 1 user verification requirement (PIN) on the UICC shall be
enabled with three VERIFY PIN attempts and ten UNBLOCK PIN attempts remaining.
\- Any level 2 user verification requirement (PIN2) on the UICC shall be
enabled with three VERIFY PIN2 attempts and ten UNBLOCK PIN2 attempts
remaining, if assigned.
\- A Universal PIN on the UICC shall be enabled, if IUT is a multi-
verification capable UICC.
## 4.3 Default data formatting
All numeric data enclosed in single quotes (\' \') in this document are
hexadecimal data.
Where \'X\' is used in place of a hexadecimal digit, X ranges from \'0\' to
\'F\'. For example, the data \'6X\' ranges from \'60\' to \'6F\' inclusive.
Where data is expressed as a group of bytes, it shall be in the following
format: \'XX XX XX... XX\', indicating first byte, second byte, third byte
etc. in that order.
A string of digits shall be formatted with a continuous string of numeric data
and enclosed with single quotes. For example, the string \'XXXXXXXX\' where X
ranges from 0 to 9 inclusive.
## 4.4 Test definition and applicability
The following statements are applicable to the test definition and
applicability clause for all test purposes contained within the present
document:
\- Unless otherwise stated, tests apply to both plug-in and ID-1 UICC cards.
\- Unless otherwise stated, tests apply to each protocol supported by the
UICC.
\- The tests are performed on a UICC as defined in TS 31.101 [2] with a USIM
application as defined in TS 31.102 [3]. The tests to check the requirement of
TS 31.101 [2] use the files as defined in TS 31.102 [3].
\- Unless otherwise stated, the tests apply to single and multi-verification
capable UICCs with USIM application(s). In the case of a multi-verification
capable UICC, there shall be only one application.
## 4.5 Initial conditions
Unless otherwise stated, all the PINs used in the test procedures shall be
initially enabled.
Figure 1 shows the files in the UICC which shall be used for the test
procedures, in the case where the EFs are not mandatory, they may be replaced
with other EFs of the same file structure.
Unless otherwise stated, all the EFs used in the test procedure shall be
activated.
* * *
                                                         MF                                                                                                 
                                                         \'3F00\'
     DF~TELECOM~                         EF~DIR~                    EF~PL~                     EF~ARR~         EF~ICCID~                                    
     \'7F10\'                            \'2F00\'                   \'2F05\'                   \'2F06\'        \'2FE2\'
                                                         EF~ARR~                    EF~ADN~                                                                 
                                                         \'6F06\'                   \'6F3A\'
     ADF~USIM~
                      DF~PHONEBOOK~                                                                                                                         
                      \'5F3A\'
                      EF~PBR~            EF~ADN~                                                                                                            
                      \'4F30\'           \'4F3A\'
                      EF~ARR~            EF~IMSI~                   EF~Keys~                   EF~KeysPS~      EF~HPLMN~      EF~UST~                       
                      \'6F06\'           \'6F07\'                   \'6F08\'                   \'6F09\'        \'6F31\'       \'6F38\'
                      EF~PUCT~           EF~START-HFN~              EF~THRESHOLD~              EF~LOCIPS~      EF~ACC~        EF~FPLMN~                     
                      \'6F41\'           \'6F5B\'                   \'6F5C\'                   \'6F73\'        \'6F78\'       \'6F7B\'
                      EF~LOCI~           EF~AD~                     EF~ECC~                    EF~FDN~         EF~ICI~        EF~CCP2~                      
                      \'6F7E\'           \'6FAD\'                   \'6FB7\'                   \'6F3B\'        \'6F80\'       \'6F4F\'
                      EF~SMS~            EF~SMSS~                   EF~ACMmax~                 EF~ACM~                                                      
                      \'6F3C\'           \'6F43\'                   \'6F37\'                   \'6F39\'
* * *
Figure 1: File identifiers and directory structures of UICC
The initial conditions for some of the EFs are given in the followings:
> \- PIN shall be set to \'00000000\'.
>
> \- PIN2 shall be set to \'11111111\'.
>
> \- Universal PIN shall be set to \'22222222\', if supported.
>
> \- EF~FPLMN~ shall contain the data string: \'55 AA 0F 00 F0 FF 00 F0 FF 00
> F0 FF\'.
>
> \- EF~LOCI~ shall contain the data string: \'A1 A2 A3 A4 A5 A6 A7 A8 A9 00
> 00\'.
\- The records in EF~SMS~ shall contain the following data for the first 20
bytes:
* * *
**1^st^ record** \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0 A1 A2 FF A0 A1 A2 A3 A4 A5
A6\' **2^nd^ record** \'B0 B1 B2 A0 A1 A2 A0 A1 A2 B0 B1 B2 FF B0 B1 B2 B3 B4
B5 B6\' **3^rd^ record** \'B0 B1 B2 A0 A1 A2 B0 B1 B2 A0 A1 A2 FF C0 C1 C2 C3
C4 C5 C6\' **4^th^ record** \'A0 A1 A2 B0 B1 B2 B0 B1 B2 B0 B1 B2 FF D0 D1 D2
D3 D4 D5 D6\'
* * *
The data for the remainder of these four records and for all other records
shall be \'FF\'.
\- The records in EF~FDN~ shall contain the following data for the first 10
bytes:
* * *
**1st record** \'A0 A1 A2 B0 B1 B2 A0 A1 A2 A0\' **2nd record** \'B0 B1 B2 A0
A1 A2 A0 A1 A2 B0\' **3rd record** \'B0 B1 B2 A0 A1 A2 B0 B1 B2 A0\' **4th
record** \'A0 A1 A2 B0 B1 B2 B0 B1 B2 B0\'
* * *
> The data for the remainder of these four records and for all other records
> (if any) shall be \'FF\'.
\- The records in EF~CCP2~ shall contain the following data:
* * *
**1^st^ record** \'10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E\' **2^nd^
record** \'20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E\' **2^nd^ last
record** \'E0 E1 E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE\' **Last record** \'F0
F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE\'
* * *
\- The records in EF~ACM~ shall contain the following data, if it is
supported:
* * *
**1^st^ record** \'00 00 01\'(last updated record) **2^nd^ record** \'00 00
02\' **3^rd^ record** \'00 00 03\' **X^th^ record** \'00 00\' followed by byte
value X (first updated record)
* * *
\- The records in EF~ICI~ shall contain the following data:
* * *
**1^st^ record** \'01\' for all bytes **2^nd^ record** \'02\' for all bytes
**3^rd^ record** \'03\' for all bytes **X^th^ record** byte value X for all
bytes
* * *
\- The records in EF~ECC~ shall contain the following data:
* * *
**1^st^ record** \'21 F2 FF 54 45 53 54 00\' **All other records** \'FF FF FF
FF FF FF FF 00\'
* * *
## 4.6 Test procedure
The following statements are applicable to the test procedure clause for all
test purposes contained within the present document:
\- Unless otherwise stated, all steps within the test procedure shall be
carried out in order.
\- Unless otherwise stated, all test procedures shall be applicable to both T
= 0 and T = 1 protocols.
\- Where steps indicate that a ME simulator shall select a particular DF or EF
using an unspecified number of SELECT commands, the ME simulator is to send
the correct sequence of SELECT commands in order to select the required file
ID from the current file ID (this may be achieved most easily by selecting
from the MF down each time).
\- Unless otherwise stated, the Le (P3) for all READ RECORD commands and Lc
(P3) for all UPDATE RECORD commands sent by the ME simulator is to be that of
the record length of the EF currently selected. In the case where an EF is not
currently selected, the length sent is to be 1 unless otherwise stated.
\- Unless otherwise stated, the offset for all READ BINARY and UPDATE BINARY
commands sent by the ME simulator is to be \'00 00\'.
\- Unless otherwise specified, when the T = 0 protocol is used, the necessary
GET RESPONSE commands are assumed to be sent, or the same command header is
assumed to be resent with P3 = L~UICC~ at the transport layer level in order
to retrieve the available response data from the UICC.
\- Unless otherwise stated, the length (Le) for all SELECT, STATUS and GET
RESPONSE commands sent by the ME simulator is to be such that all available
data is read.
\- Unless otherwise stated, the PIN and Unblock PIN presented for VERIFY PIN,
CHANGE PIN, DISABLE PIN, ENABLE PIN and UNBLOCK PIN commands sent by the ME
simulator is to be correct.
\- Unless otherwise stated, a SELECT command sent to the UICC to select
ADF~USIM~ is with the application\'s AID, indicating in the command parameter
that the application shall be activated.
\- Unless otherwise stated, a SELECT command sent to the UICC is with P2 =
\'04\', indicating that the FCP shall be returned.
\- Unless otherwise stated, all RETRIEVE DATA commands sent to the UICC shall
be with P2 indicating \"current EF\".
\- Unless otherwise stated, all SET DATA commands sent to the UICC shall be
with P2 indicating \"current EF\".
\- Unless otherwise stated, all SET DATA commands sent to the UICC shall be
sent with the maximum amount of data possible according to the data object
being transmitted.
## 4.7 Test requirement
Where steps within a test procedure involve a ME simulator sending one or more
commands to the UICC, these commands are required to be correctly executed,
with the UICC responding with status conditions of \'90 00\', unless otherwise
stated in the clause for the test.
# 5 Void
# 6 Test Procedure (TS 102.221)
This clause details all the tests for testing the IUT against TS 102.221 [1].
This test suite allows testing of the IUT against the base specification with
respect to:
\- Physical characteristics
\- Electrical specifications of the UICC - Terminal interface
\- Initial communication establishment procedure
\- Transmission protocols
\- Application and File structure
\- Security features
\- Structure of commands and responses
\- Commands
\- Transmission Oriented Commands
\- Application independent files
## 6.1 Physical characteristics
See ETSI TS 102 230 - 2 [20].
## 6.2 Electrical specifications of the UICC -- Terminal interface
See ETSI TS 102 230 - 2 [20].
## 6.3 Initial communication establishment procedure
See ETSI TS 102 230 - 2 [20].
## 6.4 Transmission Protocols
See ETSI TS 102 230 - 2 [20].
## 6.5 Application and File structure
See ETSI TS 102 230 - 2 [20].
## 6.6 Security features
See ETSI TS 102 230 - 2 [20].
## 6.7 Structure of commands and responses
See ETSI TS 102 230 - 2 [20].
## 6.8 Commands
See ETSI TS 102 230 - 2 [20].
## 6.9 Transmission Oriented Commands
See ETSI TS 102 230 - 2 [20].
## 6.10 Application independent files
See ETSI TS 102 230 - 2 [20].
# 7 Test Procedure (31.102)
This clause details all the tests for testing the IUT against TS 31.102 [3].
This test suite allows testing of the IUT against the base specification with
respect to:
\- Contents of the Elementary Files
\- Security Features supported by USIM
\- USIM commands.
## 7.1 Contents of the Elementary Files (EF)
The clause provides tests to ensure that the IUT contains all of the EFs need
for a Telecom session.
### 7.1.1 Definition and applicability
See clause 3.5.3.
### 7.1.2 Conformance requirement
The following conformance requirements refer to the tables for each EF in TS
31.102 [3], clause 4.
* * *
CR1 Each existing EF shall be selectable under the respective DF using the
identifier given in the table for that EF. M CR2 All mandatory EFs shall exist
on the UICC. M CR3 The identifier of the EF shall be that given in the table
for that EF. M CR4 The type and structure of the EF shall be that given in the
table for that EF. M CR5 The file size shall be at least that given in the
table for that EF. M CR6 The short file identifier shall be those given in the
table for that EF. M CR7 The short file identifier shall exist if it is
mandatory in the table for that EF. This includes EFs with SFI indicated by
\'YY\'. (R99) Rel-6 - ... CR8 The access conditions shall be those given in
the table for that EF. M CR9 If no SFI is indicated in the table for the EF,
the EF shall not have an SFI. (R99) Rel-6 - ... CR10 The short file identifier
shall exist if it is mandatory in the table for that EF. M
* * *
Reference: TS 31.102 [3], clause 4.
### 7.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: The contents and coding of the data within the files are not tested, but
shall conform to the respective contents and coding of the data given for each
file in TS 31.102 [3], clause 4.
### 7.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the
respective DF for the first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
_The following shall be true of the response data:_
_\- TLV DO with tag \'83\' shall indicate the identifier of the file selected
[CR3];_
_\- TLV DO with tag \'82\' shall not be \'38\' and \'78\' indicating EF
[CR4];_
_\- TLV DO with tag \'82\' shall indicate the structure given in the table for
the file in clause 4 of TS 31.102 [3] [CR4];_
_\- TLV DO with tag \'80\' shall be at least the minimum file size given in
the table for the file in clause 4 of TS 31.102 [3]. if the EF is transparent
[CR5];_
_\- Byte 5 and 6 of TLV DO with tag \'82\' shall be in accordance with the
record length given in the table for the file in clause 4 of TS 31.102 [3]. if
the EF is linear fixed or cyclic [CR5];_
_\- TLV DO with tag \'80\' shall be an integer multiple of the record length
if the EF is linear fixed or cyclic [CR5];_
_\- If a value for the SFI is specified in the table for the file in clause 4
of TS 31.102 [3] and the value of the specified SFI is equal to the 5 least
significant bits (bits b5 to b1) of the file identifier for the file, then the
TLV DO with tag \'88\'shall either be absent, or shall be present with the
specified SFI value [CR6, CR7];_
_\- If a value for the SFI is specified in the table for the file in clause 4
of TS 31.102 [3] and the value of the specified SFI is not equal to the 5
least significant bits (bits b5 to b1) of the file identifier for the file,
then the TLV DO with tag \'88\'shall be present with the specified SFI value
[CR6, CR7];_
_\- If an SFI is specified in the table for the file in clause 4 of TS 31.102
[3] but no actual value is specified (i.e. \'YY\' is used), then the TLV DO
with tag \'88\'shall either be absent, or shall be present with a value of
length 1 [CR6, CR7];_
_\- If no SFI is specified in the table for the file in clause 4 of TS 31.102
[3], then the TLV DO with tag \'88\'shall be present with an empty value
[CR9]_
_\- TLV DO with tag \'86\' or \'8B\' or \'8C\' or \'AB\' shall indicate the
access conditions given in the table for the file in clause 4 of TS 31.102 [3]
[CR8].\_ Note: if the access conditions indicate referenced security, the
referenced record in the EF~ARR~ may be read at this point if necessary.
d) Steps a) to c) shall be repeated for the remaining mandatory EFs clause 4
of TS 31.102 [3].
e) Steps a) to c) shall be repeated for the existing optional EFs clause 4 of
TS 31.102 [3].
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the
respective DF for the first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in clause 4 of TS 31.102 [3].
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' - normal ending of the command [CR1, CR2]._
_The following shall be true of the response data:_
_\- TLV DO with tag \'83\' shall indicate the identifier of the file selected
[CR3];_
_\- TLV DO with tag \'82\' shall not be \'38\' and \'78\' indicating EF
[CR4];_
_\- TLV DO with tag \'82\' shall indicate the structure given in the table for
the file in clause 4 of TS 31.102 [3] [CR4];_
_\- TLV DO with tag \'80\' shall be at least the minimum file size given in
the table for the file in clause 4 of TS 31.102 [3]. if the EF is transparent
[CR5];_
_\- Byte 5 and 6 of TLV DO with tag \'82\' shall be in accordance with the
record length given in the table for the file in clause 4 of TS 31.102 [3]. if
the EF is linear fixed or cyclic [CR5];_
_\- TLV DO with tag \'80\' shall be an integer multiple of the record length
if the EF is linear fixed or cyclic [CR5];_
_\- TLV DO with tag \'88\' shall indicate the short file identifier given in
the table for the file in clause 4 of TS 31.102 [3] [CR6, CR10];_
_\- TLV DO with tag \'86\' or \'8B\' or \'8C\' or \'AB\' shall indicate the
access conditions given in the table for the file in clause 4 of TS 31.102 [3]
[CR8].\_ Note: if the access conditions indicate referenced security, the
referenced record in the EF~ARR~ may be read at this point if necessary.
d) Steps a) to c) shall be repeated for the remaining mandatory EFs clause 4
of TS 31.102 [3].
e) Steps a) to c) shall be repeated for the existing optional EFs clause 4 of
TS 31.102 [3].
## 7.2 Security features
### 7.2.1 Definition and applicability
See clause 3.5.3.
### 7.2.2 Conformance requirement
* * *
CR1 The USIM application shall use a global key reference as PIN and a local
key reference as PIN2. M CR2 Access with PIN2 shall be limited to the ADF
(USIM). M CR3 For a USIM application on a multi-verification capable UICC, the
only valid values for the usage qualifiers shall be \'00\' (verification
requirement is not used) and \'08\' (user authentication knowledge based
(PIN)) as defined in ISO/IEC 7816‑4 [7]. O_MULTI_VER CR4 Void N/A CR5 Void N/A
CR6 Void N/A CR7 Void N/A CR8 For access to DF~TELECOM~ the PIN shall be
verified. M
* * *
Reference: TS 31.102 [3], clause 6.4.
### 7.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR1, CR2 are tested in the clause 6.6.4.
NOTE 2: CR8 is not currently tested.
### 7.2.4 Method of test
No test procedure is currently required for a single verification capable
UICC.
Initial conditions
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
_The following shall be true of the response data:_
_\- TLV DO with tag \'C6\' (PS Template DO) shall contain for the Universal
PIN the TLV DO with tag \'95\' (Usage Qualifier) and the value of this TLV
shall be \'00\' or \'08\' [CR3];_
## 7.3 USIM commands
### 7.3.1 AUTHENTICATE
#### 7.3.1.1 Definition and applicability
See clause 3.5.3.
#### 7.3.1.2 Conformance requirement
* * *
CR1 This function shall cause the UICC to run the f1, f2, f3, f4, f5, and f1*
algorithms using a 16 bytes random number, AUTN, and the subscriber
authentication key K stored in the UICC. M CR2 If the received sequence number
SQN is in the correct range, the function shall return the response RES,
cipher key CK, and integrity key IK. M CR3 If the UICC detects the sequence
numbers are not in the valid range, the function shall return the signed
response AUTS. M CR4 The function shall not be executable unless a particular
USIM application has been selected as the Current Directory and activated and
the current directory is the USIM ADF or any subdirectory under this ADF. M
CR5 The function shall not be executable unless a successful PIN verification
procedure has been performed. M CR6 The function shall not be executable
unless the expected MAC-A is received. M CR7 If the UICC does not support
\'GSM context\' which is indicated in parameter P2, the function shall not be
executable. M
* * *
Reference: TS 31.102 [3], clause 7.1.
#### 7.3.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 7.3.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send an AUTHENTICATE command to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
- security status not satisfied [CR5]._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select the MF.
h) The ME simulator shall send an AUTHENTICATE command to the UICC.
_The command shall be aborted [CR4]._
i) The ME simulator shall send a SELECT command to the UICC to select the
current ADF (\'7FFF\').
j) The ME simulator shall send an AUTHENTICATE command to the UICC with
incorrect signed data.
_The status condition returned by the UICC shall be SW1 = \'98\', SW2 = \'62\'
- authentication error, incorrect MAC [CR6]._
k) If the \'GSM context\' is not supported, the ME simulator shall send an
AUTHENTICATE command with parameter P2 indicating \'GSM context\'.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'64\' - authentication error, GSM security context not supported [CR7]._
l) The ME simulator shall send an AUTHENTICATE command to the UICC with
incorrect sequence number SQN.
> _The data field returned shall begin with the tag \'DC\', and the data shall
> be correct for the given f1* and f5 algorithms and K stored in the UICC
> [CR1, CR3]._
m) The ME simulator shall send an AUTHENTICATE command to the UICC with
correct data.
> _The data field returned shall begin with the tag \'DB\', and the data shall
> be correct for the given f2, f3 and f4 algorithms and K stored in the UICC
> [CR1, CR2]._
### 7.3.2 Status Conditions Returned by the USIM
#### 7.3.2.1 Security management
##### 7.3.2.1.1 Definition and applicability
See clause 3.5.3.
##### 7.3.2.1.2 Conformance requirement
* * *
CR1 The UICC shall respond with the correct SW1 and SW2 status words for
commands which produce authentication errors. M
* * *
Reference: TS 31.102 [3], clause 7.3.1.
##### 7.3.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements when issuing SW1
and SW2 status words.
##### 7.3.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a VERIFY PIN command with relevant PIN to the
UICC.
d) The ME simulator shall send an AUTHENTICATE command to the UICC with
incorrect MAC.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'62\' - authentication error, incorrect MAC [CR1]._
e) If the \'GSM context\' is not supported, the ME simulator shall send an
AUTHENTICATE command with parameter P2 indicating \'GSM context\'.
> _The status condition returned by the UICC shall be SW1 = \'98\', SW2 =
> \'64\' - authentication error, GSM security context not supported [CR1]._
#### 7.3.2.2 Status Words of the Commands
##### 7.3.2.2.1 Definition and applicability
See clause 3.5.3.
##### 7.3.2.2.2 Conformance requirement
* * *
CR1 Table in TS 31.102 [3], clause 7.3.2 shows for each command the possible
status conditions returned (marked by an asterisk *). The UICC shall not
generate status conditions other than those allowed for each command. M
* * *
Reference: TS 31.102 [3], clause 7.3.2.
##### 7.3.2.2.3 Test purpose
To verify for each command that the UICC will only generate the allowed status
conditions.
NOTE: CR1 shall not be tested as it is not possible to force the UICC to
generate all of the allowed and disallowed status conditions for each command.
##### 7.3.2.2.4 Method of test
**Initial conditions**
N/A
**Test procedure**
N/A
### 7.3.3 GET IDENTITY
#### 7.3.3.1 Definition and applicability
See clause 3.5.3.
#### 7.3.3.2 Conformance requirement
+-----+----------------------------------------------------------+---+ | CR1 | The function can be used to retrieve the SUCI when | M | | | \"SUCI calculation is to be performed by the USIM\" | | | | (i.e. Service n°124 and Service n°125 are | | | | \"available\"). | | +-----+----------------------------------------------------------+---+ | CR2 | The function shall not be executable unless a particular | M | | | USIM application has been selected as the Current | | | | Directory and activated and the current directory is the | | | | USIM ADF or any subdirectory under this ADF. | | +-----+----------------------------------------------------------+---+ | CR3 | The function shall not be executable unless a successful | M | | | PIN verification procedure has been performed. | | +-----+----------------------------------------------------------+---+ | CR4 | The command returns the SUCI which is a privacy | M | | | preserving identifier containing the concealed SUPI. | | +-----+----------------------------------------------------------+---+ | CR5 | The SUCI is designed for one-time use, however, the | M | | | freshness and randomness of SUCI returned upon each call | | | | of the command depends on the protection scheme | | | | configured. There is the special case where the | | | | protection scheme used is null-scheme, in such case SUCI | | | | contains the non concealed SUPI. | | +-----+----------------------------------------------------------+---+ | CR6 | If the home network public key is not provisioned in the | M | | | USIM, the SUCI shall be calculated using the null-scheme | | | | irrespective of the protection scheme stored in the | | | | USIM. | | +-----+----------------------------------------------------------+---+ | CR7 | If SUCI context is supported and: | M | | | | | | | - Service n°124 is not \"available\" or: | | | | | | | | - \"SUCI calculation is to be performed by the ME\" | | | | (i.e. Service n°124 is \"available\", and Service n°125 | | | | is not \"available\") | | | | | | | | the status word \'6985\' (Conditions of use not | | | | satisfied) shall be returned. | | +-----+----------------------------------------------------------+---+
Reference: TS 31.102 [3], clause 7.5.
#### 7.3.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 7.3.3.4 Method of test
**Initial conditions 1**
1) Service n°124 and service n°125 are both \"available\" in the USIM.
2) The Profile B protection scheme is configured to be used in the USIM, and
the corresponding home network public key(compressed or uncompressed) is
provisioned in the USIM.
3) The USIM supports ECIES scheme profile B.
4) The UICC shall be connected to an ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a GET IDENTITY command to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
- security status not satisfied [CR3]._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select the MF.
h) The ME simulator shall send a GET IDENTITY command to the UICC.
_The command shall be aborted [CR2]._
i) The ME simulator shall send a SELECT command to the UICC to select the
current ADF (\'7FFF\').
j) The ME simulator shall send a GET IDENTITY command to the UICC with correct
data.
> _The data field returned shall begin with the tag \'A1\', and the data shall
> be correct for the_ ECIES scheme profile B _and home network public key
> stored in the UICC [CR1, CR2, CR3, CR4]._
k) The ME simulator shall send a GET IDENTITY command to the UICC with correct
data.
> _The data field returned shall begin with the tag \'A1\', and the data shall
> be correct for the_ ECIES scheme profile B _and home network public key
> stored in the UICC [CR1, CR2, CR3, CR4]._
>
> _The data shall be different with j) [CR5]._
**Initial conditions 2**
1) Service n°124 and service n°125 are both \"available\" in the USIM.
2) The Profile A protection scheme is configured to be used in the USIM, and
the corresponding home network public key(compressed or uncompressed) is
provisioned in the USIM.
3) The USIM supports ECIES scheme profile A.
4) The UICC shall be connected to an ME simulator.
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a GET IDENTITY command to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
- security status not satisfied [CR3]._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select the MF.
h) The ME simulator shall send a GET IDENTITY command to the UICC.
_The command shall be aborted [CR2]._
i) The ME simulator shall send a SELECT command to the UICC to select the
current ADF (\'7FFF\').
j) The ME simulator shall send a GET IDENTITY command to the UICC with correct
data.
> _The data field returned shall begin with the tag \'A1\', and the data shall
> be correct for the_ ECIES scheme profile A _and home network public key
> stored in the UICC [CR1, CR2, CR3, CR4]._
k) The ME simulator shall send a GET IDENTITY command to the UICC with correct
data.
> _The data field returned shall begin with the tag \'A1\', and the data shall
> be correct for the_ ECIES scheme profile A _and home network public key
> stored in the UICC [CR1, CR2, CR3, CR4]_
>
> _The data shall be different with j) [CR5]._
**Initial conditions 3**
1) Service n°124 and service n°125 are both \"available\" in the USIM.
2) The home network public key is not provisioned, or null-scheme is
configured to be used in the USIM.
3) The UICC shall be connected to an ME simulator.
**Test procedure 3**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a GET IDENTITY command to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'82\'
- security status not satisfied [CR3]._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select the MF.
h) The ME simulator shall send a GET IDENTITY command to the UICC.
_The command shall be aborted [CR2]._
i) The ME simulator shall send a SELECT command to the UICC to select the
current ADF (\'7FFF\').
j) The ME simulator shall send a GET IDENTITY command to the UICC with correct
data.
> _The data field returned shall begin with the tag \'A1\', and the data shall
> be correct for the given Null-scheme [CR6]._
k) The ME simulator shall send a GET IDENTITY command to the UICC with correct
data.
> _The data field returned shall begin with the tag \'A1\', and the data shall
> be correct for the given Null-scheme [CR6]._
>
> _The data shall be the same with j) [CR5]._
**Initial conditions 4**
1) Service n°124 is not \"available\" in the USIM, or Service n°124 is
\"available\", and Service n°125 is not \"available\" in the USIM.
2) The home network public key is provisioned in the USIM.
3) The UICC shall be connected to an ME simulator.
**Test procedure 4**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
c) The ME simulator shall send a GET IDENTITY command to the UICC.
_The status condition returned by the UICC shall be SW1 = \'69\', SW2 = \'85\'
- conditions of use not satisfied [CR7]._
d) The ME simulator shall reset the UICC.
e) The ME simulator shall send a SELECT command to the UICC to select the USIM
application.
f) The ME simulator shall send a VERIFY PIN command with PIN to the UICC.
g) The ME simulator shall send a SELECT command to the UICC to select the MF.
h) The ME simulator shall send a GET IDENTITY command to the UICC.
_The command shall be aborted [CR2]._
i) The ME simulator shall send a SELECT command to the UICC to select the
current ADF (\'7FFF\').
j) The ME simulator shall send a GET IDENTITY command to the UICC with correct
data.
> _The status condition returned by the UICC shall be SW1 = \'69\', SW2 =
> \'85\' - conditions of use not satisfied [CR7]._
## 7.4 Void
# 8 Test Procedure (31.101)
This clause details each of the tests in each of the test groups within the
Test Group Ts 31.101 [2]. This test suite allows testing of the IUT against
the base specification with respect to:
\- General 3GPP platform requirements
\- Physical and logical characteristics
\- User verification and file access conditions
\- Files.
## 8.1 General 3GPP platform requirements
### 8.1.1 GSM/USIM application interaction and restrictions
#### 8.1.1.1 Definition and applicability
See clause 3.5.3.
#### 8.1.1.2 Conformance requirement
* * *
CR1 Activation of a USIM session shall exclude the activation of a GSM
session. Rel-6 - ... CR2 Once a USIM application session has been activated,
commands sent to the UICC with CLA byte set to \'A0\' shall return SW1SW2 \'6E
00\' (class not supported) to the ME. Rel-6 - ... CR3 Activation of a GSM
session shall exclude the activation of a USIM session. Rel-6 - ...
* * *
Reference: TS 31.101 [2], clause 4.1.
#### 8.1.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE: CR3 is not tested as it is out of the scope of the present document.
#### 8.1.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a STATUS command with \'A0\' as the class byte.
> _The status condition returned by the UICC shall be SW1 = \'6E\', SW2 =
> \'00\' -- class not supported [CR1, CR2]._
d) The ME simulator shall send a STATUS command with \'80\' as the class byte.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of a command [CR1]._
## 8.2 Physical and logical characteristics
### 8.2.1 Transmission speed
#### 8.2.1.1 Definition and applicability
See clause 3.5.3.
#### 8.2.1.2 Conformance requirement
* * *
CR1 The UICC shall support (F, D) = (512, 32) in addition to those required by
TS 102.221 [1]. Rel-6 - ...
* * *
Reference: TS 31.101 [2], clause 5.1.
#### 8.2.1.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 8.2.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test Procedure 1**
a) The ME simulator shall cold reset the UICC.
b) The ME simulator shall send a PPS-Request to the UICC, selecting T = 0
protocol and (F, D) = (512, 32).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
c) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(512, 32).
> _The UICC shall send a status word indicating successful command execution
> [CR1]._
**Test Procedure 2**
a) The ME simulator shall cold reset the UICC.
b) The ME simulator shall send a PPS-Request to the UICC, selecting T = 1
protocol and (F, D) = (512, 32).
> _The UICC shall send a valid PPS-Response indicating support for the
> requested parameters._
c) The ME simulator shall send a STATUS command with P2 = \'00\' at (F, D) =
(512, 32).
> _The UICC shall send a status word indicating successful command execution
> [CR1]._
### 8.2.2 Voltage classes
#### 8.2.2.1 Definition and applicability
See clause 3.5.3.
#### 8.2.2.2 Conformance requirement
* * *
CR1 A UICC holding a USIM application shall support at least two consecutive
voltage classes as defined in TS 102.221 [1], e.g. AB or BC. Rel-6 - ... CR2
If the UICC supports more than two classes, they shall all be consecutive,
e.g. ABC. Rel-6 - ...
* * *
Reference: TS 31.101 [2], clause 5.2.
#### 8.2.2.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 8.2.2.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> _The UICC shall send the ATR sequence._
>
> _The supply voltage class indicator (the lower 6 bits in TA(i) after the
> first occurrence of T = 15 in TD(i-1) for I > 2) shall be exist and one of
> the following values:_
>
> _\- \'03\', \'06\', \'07\' [CR1, CR2]._
### 8.2.3 File Control Parameters (FCP)
#### 8.2.3.1 Definition and applicability
See clause 3.5.3.
#### 8.2.3.2 Conformance requirement
* * *
CR1 The value indicated in the Minimum application clock frequency object
shall not exceed 3 MHz, corresponding to \'1E\'. Rel-6 - ...
* * *
Reference: TS 31.101 [2], clause 5.3.
#### 8.2.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
#### 8.2.3.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
> b) The ME simulator shall send a SELECT command with AID to the UICC to
> select and activate the USIM application.
_The status returned by the UICC shall be SW1 = \'90\', SW2 = \'00\' -- normal
ending of the command._
_If the returned FCP contains the Proprietary Information object (Tag \'A5\')
and the Proprietary Information object contains the Minimum application clock
frequency object (Tag \'82\') then:_
_\- The Application minimum clock frequency value shall not exceed \'1E\',
which corresponds to 3 MHz. [CR1]_
## 8.3 User verification and file access conditions
### 8.3.1 Definition and applicability
See clause 3.5.3.
### 8.3.2 Conformance requirement
* * *
CR1 Every file related to a 3GPP application shall have a reference to an
access rule stored in EF~ARR~. Rel-6 - ... CR2 A multi-verification capable
UICC holding a 3GPP application shall support the referenced format using SEID
as defined in TS 102 221 [1]. Rel-6 - ...: O_MULTI_VER CR3 A 3GPP application
residing on a multi-verification capable UICC shall support the replacement of
its application PIN with the Universal PIN, key reference \'11\', as defined
in TS 102 221 [1]. Rel-6 - ...: O_MULTI_VER CR4 Only the Universal PIN is
allowed as a replacement. Rel-6 - ...: O_MULTI_VER
* * *
Reference: TS 31.101 [2], clause 7.
### 8.3.3 Test purpose
To verify that the UICC conforms to the above requirements.
NOTE 1: CR3 is tested in the clause 6.6.3.
NOTE 2: CR4 is not currently tested in this document.
### 8.3.4 Method of test
Initial conditions
> 1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in the USIM application.
> _The response data shall contain the TLV DO with with tag \'8B\' indicating
> Referenced Security Attributes and shall contain the file ID and EF~ARR~
> record numbers for SEID = 0 and SEID = 1 [CR1, CR2]._
>
> d) Step c) shall be repeated for all the EFs under the selected USIM in the
> UICC.
**Test procedure 2**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select and
activate USIM application.
c) The ME simulator shall send a SELECT command to the UICC to select the
first EF in the USIM application.
> _The response data shall contain the TLV DO with with tag \'8B\' indicating
> Referenced Security Attributes [CR1]._
>
> d) Step c) shall be repeated for all the EFs under the selected USIM in the
> UICC.
## 8.4 Files
### 8.4.1 Contents of the EFs at the MF level
#### 8.4.1.1 Definition and applicability
See clause 3.5.3.
#### 8.4.1.2 Conformance requirement
* * *
CR1 EF~ARR~ under MF is mandatory. Rel-6 - ... CR2 EF~DIR~ entries for 3GPP
applications shall contain the Application Identifier and the Application
Label as mandatory elements. Rel-6 - ... CR3 EF~DIR~ entries for 3GPP
applications shall not contain a path object for application selection. Rel-6
- ...
* * *
Reference: TS 31.101 [2], clause 8.1.
#### 8.4.1.3 Test purpose
To verify that the Elementary Files within the UICC application structure
conform to the above requirements.
#### 8.4.1.4 Method of test
**Initial conditions**
1) The UICC shall be connected to a ME simulator.
**Test procedure 1**
a) The ME simulator shall reset the UICC.
b) The ME simulator shall send a SELECT command to the UICC to select EF~ARR~.
> _The status condition returned by the UICC shall be SW1 = \'90\', SW2 =
> \'00\' -- normal ending of the command [CR1]._
c) The ME simulator shall send a SELECT command to the UICC to select EF~DIR~.
d) Step e) shall be repeated for each record in EF~DIR~.
e) The ME simulator shall send a READ RECORD command with NEXT mode to the
UICC.
> _If the EF~DIR~ entry contains a 3GPP application (i.e. contains an AID
> matching the AID of a 3GPP application as defined in TS 101 220 [15]),
> then:_
>
> _\- the Application Label shall be present [CR2];_
>
> _\- a File Reference (tag \'51\') TLV DO shall not be present [CR3]._
#