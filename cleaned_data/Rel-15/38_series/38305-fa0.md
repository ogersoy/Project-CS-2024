# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the stage 2 of the UE Positioning function of
NG-RAN which provides the mechanisms to support or assist the calculation of
the geographical position of a UE. UE position knowledge can be used, for
example, in support of Radio Resource Management functions, as well as
location-based services for operators, subscribers, and third-party service
providers. The purpose of this stage 2 specification is to define the NG-RAN
UE Positioning architecture, functional entities and operations to support
positioning methods. This description is confined to the NG-RAN Access
Stratum. It does not define or describe how the results of the UE position
calculation can be utilised in the Core Network (e.g., LCS) or in NG-RAN
(e.g., RRM).
UE Positioning may be considered as a network-provided enabling technology
consisting of standardised service capabilities that enable the provision of
location applications. The application(s) may be service provider specific.
The description of the numerous and varied possible location applications
which are enabled by this technology is outside the scope of the present
document. However, clarifying examples of how the functionality being
described may be used to provide specific location services may be included.
This stage 2 specification covers the NG-RAN positioning methods, state
descriptions, and message flows to support UE Positioning.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501 \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 22.071: \"Location Services (LCS); Service description, Stage 1\".
[4] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
[5] IS-GPS-200, Revision D, Navstar GPS Space Segment/Navigation User
Interfaces, March 7^th^, 2006.
[6] IS-GPS-705, Navstar GPS Space Segment/User Segment L5 Interfaces,
September 22, 2005.
[7] IS-GPS-800, Navstar GPS Space Segment/User Segment L1C Interfaces,
September 4, 2008.
[8] Galileo OS Signal in Space ICD (OS SIS ICD), Draft 0, Galileo Joint
Undertaking, May 23^rd^, 2006.
[9] Global Navigation Satellite System GLONASS Interface Control Document,
Version 5, 2002.
[10] IS-QZSS, Quasi Zenith Satellite System Navigation Service Interface
Specifications for QZSS, Ver.1.0, June 17, 2008.
[11] Specification for the Wide Area Augmentation System (WAAS), US Department
of Transportation, Federal Aviation Administration, DTFA01-96-C-00025, 2001.
[12] RTCM 10402.3, RTCM Recommended Standards for Differential GNSS Service
(v.2.3), August 20, 2001.
[13] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
[14] 3GPP TS 38.331: \"NR Radio Resource Control (RRC) protocol
specification\".
[15] OMA-AD-SUPL-V2_0: \"Secure User Plane Location Architecture Approved
Version 2.0\".
[16] OMA-TS-ULP-V2_0_4: \"UserPlane Location Protocol Approved Version
2.0.4\".
[17] 3GPP TS 36.214: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical layer -- Measurements\".
[18] 3GPP TS 36.302: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Services provided by the physical layer\".
[19] 3GPP TS 36.355: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
LTE Positioning Protocol (LPP)\"
[20] BDS-SIS-ICD-2.0: \"BeiDou Navigation Satellite System Signal In Space
Interface Control Document Open Service Signal (Version 2.0)\", December 2013.
[21] IEEE 802.11: \"Wireless LAN Medium Access Control (MAC) and Physical
Layer (PHY) Specifications\"
[22] Bluetooth Special Interest Group: \"Bluetooth Core Specification v4.2\",
December 2014.
[23] ATIS-0500027: \"Recommendations for Establishing Wide Scale Indoor
Location Performance\", May 2015.
[24] 3GPP TS 36.211: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical channels and modulation\".
[25] 3GPP TS 36.305: \"Stage 2 functional specification of User Equipment (UE)
positioning in E‑UTRA\".
[26] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[27] 3GPP TS 38.455: \"NG-RAN; NR Positioning Protocol A (NRPPa)\".
[28] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[29] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[30] 3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".
[31] RTCM 10403.3, \"RTCM Recommended Standards for Differential GNSS Services
(v.3.3)\", October 7, 2016.
[32] 3GPP TS 38.133: \"NR; Requirements for support of radio resource
management\".
[33] 3GPP TS 29.572: \"Location Management Services; Stage 3\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
As used in this document, the suffixes \"-based\" and \"-assisted\" refer
respectively to the node that is responsible for making the positioning
calculation (and which may also provide measurements) and a node that provides
measurements (but which does not make the positioning calculation). Thus, an
operation in which measurements are provided by the UE to the LMF to be used
in the computation of a position estimate is described as \"UE-assisted\" (and
could also be called \"LMF-based\"), while one in which the UE computes its
own position is described as \"UE-based\".
**Transmission Point (TP)** : A **set of geographically co-located transmit
antennas for one cell, part of one cell or one PRS-only TP.** Transmission
Points can include base station (ng-eNB or gNB) antennas, remote radio heads,
a remote antenna of a base station, an antenna of a PRS-only TP, etc. One cell
can be formed by one or multiple transmission points. For a homogeneous
deployment, each transmission point may correspond to one cell.
**PRS-only TP** : A TP which only transmits PRS signals for PRS-based TBS
positioning for E-UTRA and is not associated with a cell.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
5GC 5G Core Network
5GS 5G System
ADR Accumulated Delta Range
AoA Angle of Arrival
AP Access Point
ARP Antenna Reference Point
BDS BeiDou Navigation Satellite System
BSSID Basic Service Set Identifier
CID Cell-ID (positioning method)
E-SMLC Enhanced Serving Mobile Location Centre
E-CID Enhanced Cell-ID (positioning method)
ECEF Earth-Centered, Earth-Fixed
ECI Earth-Centered-Inertial
EGNOS European Geostationary Navigation Overlay Service
E-UTRAN Evolved Universal Terrestrial Radio Access Network
FDMA Frequency Division Multiple Access
FKP Flächenkorrekturparameter (Engl: Area Correction Parameters)
GAGAN GPS Aided Geo Augmented Navigation
GLONASS GLObal\'naya NAvigatsionnaya Sputnikovaya Sistema (Engl.: Global
Navigation Satellite System)
GMLC Gateway Mobile Location Center
GNSS Global Navigation Satellite System
GPS Global Positioning System
GRS80 Geodetic Reference System 1980
HESSID Homogeneous Extended Service Set Identifier
LCS LoCation Services
LMF Location Management Function
LPP LTE Positioning Protocol
MAC Master Auxiliary Concept
MBS Metropolitan Beacon System
MO-LR Mobile Originated Location Request
MT-LR Mobile Terminated Location Request
NG-C NG Control plane
NG-AP NG Application Protocol
NI-LR Network Induced Location Request
N-RTK Network -- Real-Time Kinematic
NRPPa NR Positioning Protocol A
OTDOA Observed Time Difference Of Arrival
PDU Protocol Data Unit
PPP Precise Point Positioning
PRS Positioning Reference Signal (for E-UTRA)
QZSS Quasi-Zenith Satellite System
RRM Radio Resource Management
RSSI Received Signal Strength Indicator
RTK Real-Time Kinematic
SBAS Space Based Augmentation System
SET SUPL Enabled Terminal
SLP SUPL Location Platform
SSID Service Set Identifier
SSR State Space Representation
SUPL Secure User Plane Location
T~ADV~ Timing Advance
TBS Terrestrial Beacon System
TP Transmission Point
UE User Equipment
WAAS Wide Area Augmentation System
WGS-84 World Geodetic System 1984
WLAN Wireless Local Area Network
# 4 Main concepts and requirements
## 4.1 Assumptions and Generalities
The stage 1 description of LCS at the service level is provided in TS 22.071
[3]; the stage 2 LCS functional description, including the LCS system
architecture and message flows, is provided in TS 23.501 [2] and TS 23.502
[26].
Positioning functionality provides a means to determine the geographic
position and/or velocity of the UE based on measuring radio signals. The
position information may be requested by and reported to a client (e.g., an
application) associated with the UE, or by a client within or attached to the
core network. The position information shall be reported in standard formats,
such as those for cell-based or geographical co-ordinates, together with the
estimated errors (uncertainty) of the position and velocity of the UE and, if
available, the positioning method (or the list of the methods) used to obtain
the position estimate.
Restrictions on the geographic shape encoded within the \'position
information\' parameter may exist for certain LCS client types. The 5GS,
including NG-RAN, shall comply with any shape restrictions defined in 5GS and,
in a particular country, with any shape restrictions defined for a specific
LCS client type in relevant national standards. For example, in the US,
national standard J-STD-036-C-2 restricts the geographic shape for an
emergency services LCS client to minimally either an \"ellipsoid point\" or an
\"ellipsoid point with uncertainty circle\" as defined in TS 23.032 [4].
It shall be possible for the majority of the UEs within a network to use the
LCS feature without compromising the radio transmission or signalling
capabilities of the NG-RAN.
The uncertainty of the position measurement shall be network-implementation-
dependent, at the choice of the network operator. The uncertainty may vary
between networks as well as from one area within a network to another. The
uncertainty may be hundreds of metres in some areas and only a few metres in
others. In the event that a particular position measurement is provided
through a UE-assisted process, the uncertainty may also depend on the
capabilities of the UE. In some jurisdictions, there is a regulatory
requirement for location service accuracy that is part of an emergency
service. Further details of the accuracy requirements can be found in TS
22.071 [3].
The uncertainty of the position information is dependent on the method used,
the position of the UE within the coverage area and the activity of the UE.
Several design options of the NG-RAN system (e.g., size of cell, adaptive
antenna technique, pathloss estimation, timing accuracy, ng-eNB and gNB
surveys) shall allow the network operator to choose a suitable and cost-
effective UE positioning method for their market.
There are many different possible uses for the positioning information. The
positioning functions may be used internally by the 5GS, by value-added
network services, by the UE itself or through the network, and by \"third
party\" services. The feature may also be used by an emergency service (which
may be mandated or \"value-added\"), but the location service is not
exclusively for emergencies.
Design of the NG-RAN positioning capability as documented in this
specification includes position methods, protocols and procedures that are
either adapted from capabilities already supported for E-UTRAN, UTRAN and
GERAN, or created separately from first principles. In contrast to GERAN and
UTRAN but similarly to E-UTRAN, the NG-RAN positioning capabilities are
intended to be forward compatible to other access types and other position
methods, in an effort to reduce the amount of additional positioning support
needed in the future. This goal also extends to user plane location solutions
such as OMA SUPL ([15], [16]), for which NG-RAN positioning capabilities are
intended to be compatible where appropriate.
As a basis for the operation of UE Positioning in NG-RAN, the following
assumptions apply:
\- both TDD and FDD will be supported;
\- the provision of the UE Positioning function in NG-RAN and 5GC is optional
through support of the specified method(s) in the ng-eNB, gNB and the LMF;
\- UE Positioning is applicable to any target UE, whether or not the UE
supports LCS, but with restrictions on the use of certain positioning methods
depending on UE capability (e.g. as defined within the LPP protocol);
\- the positioning information may be used for internal system operations to
improve system performance;
\- the UE Positioning architecture and functions shall include the option to
accommodate several techniques of measurement and processing to ensure
evolution to follow changing service requirements and to take advantage of
advancing technology.
## 4.2 Role of UE Positioning Methods
The NG-RAN may utilise one or more positioning methods in order to determine
the position of an UE.
Positioning the UE involves two main steps:
\- signal measurements; and
\- position estimate and optional velocity computation based on the
measurements.
The signal measurements may be made by the UE or by the serving ng-eNB. The
basic signals measured for terrestrial position methods are typically the LTE
radio transmissions; however, other methods may make use of other
transmissions such as general radio navigation signals including those from
Global Navigation Satellites Systems (GNSSs).
The positioning function should not be limited to a single method or
measurement. That is, it should be capable of utilising other standard methods
and measurements, as such methods and measurements are available and
appropriate, to meet the required service needs of the location service
client. This additional information could consist of readily available E-UTRAN
or NG-RAN measurements.
The position estimate computation may be made by the UE or by the LMF.
## 4.3 Standard UE Positioning Methods
### 4.3.1 Introduction
The standard positioning methods supported for NG-RAN access are:
\- network-assisted GNSS methods;
\- observed time difference of arrival (OTDOA) positioning;
\- enhanced cell ID methods;
\- WLAN positioning;
\- Bluetooth positioning;
\- terrestrial beacon system (TBS) positioning;
\- sensor based methods:
\- barometric Pressure Sensor;
\- motion sensor.
Hybrid positioning using multiple methods from the list of positioning methods
above is also supported.
Standalone mode (e.g. autonomous, without network assistance) using one or
more methods from the list of positioning methods above is also supported.
These positioning methods may be supported in UE-based, UE-assisted/LMF-based,
and NG-RAN node assisted versions. Table 4.3.1-1 indicates which of these
versions are supported in this version of the specification for the
standardised positioning methods.
Table 4.3.1-1: Supported versions of UE positioning methods
+-------------+----------+-------------+-------------+-------------+ | Method | UE-based | U | NG-RAN node | SUPL | | | | E-assisted, | assisted | | | | | LMF-based | | | +=============+==========+=============+=============+=============+ | A-GNSS | Yes | Yes | No | Yes | | | | | | (UE-based | | | | | | and | | | | | | U | | | | | | E-assisted) | +-------------+----------+-------------+-------------+-------------+ | OTDOA | No | Yes | No | Yes | | ^Note1 | | | | (U | | ,\ Note\ 2^ | | | | E-assisted) | +-------------+----------+-------------+-------------+-------------+ | E-CID | No | Yes | Yes | Yes for | | ^Note\ 3 | | | | E-UTRA | | ,\ Note\ 4^ | | | | (U | | | | | | E-assisted) | +-------------+----------+-------------+-------------+-------------+ | Sensor | Yes | Yes | No | No | +-------------+----------+-------------+-------------+-------------+ | WLAN | Yes | Yes | No | Yes | +-------------+----------+-------------+-------------+-------------+ | Bluetooth | No | Yes | No | No | +-------------+----------+-------------+-------------+-------------+ | TBS | Yes | Yes | No | Yes (MBS) | | ^Note\ 5^ | | | | | +-------------+----------+-------------+-------------+-------------+ | NOTE 1: | | | | | | This | | | | | | includes | | | | | | TBS | | | | | | positioning | | | | | | based on | | | | | | PRS | | | | | | signals. | | | | | | | | | | | | NOTE 2: In | | | | | | this | | | | | | version of | | | | | | the | | | | | | sp | | | | | | ecification | | | | | | only OTDOA | | | | | | based on | | | | | | LTE signals | | | | | | is | | | | | | supported. | | | | | | | | | | | | NOTE 3: In | | | | | | this | | | | | | version of | | | | | | the | | | | | | sp | | | | | | ecification | | | | | | E-CID based | | | | | | on LTE | | | | | | signals | | | | | | only is | | | | | | supported. | | | | | | However, | | | | | | depending | | | | | | on the | | | | | | serving | | | | | | NG-RAN node | | | | | | e.g. | | | | | | ng-eNB, | | | | | | uplink | | | | | | E-CID may | | | | | | be | | | | | | supported | | | | | | based on | | | | | | GERAN, UTRA | | | | | | or WLAN | | | | | | signals. | | | | | | | | | | | | NOTE 4: | | | | | | This | | | | | | includes | | | | | | Cell-ID for | | | | | | NR method | | | | | | when UE is | | | | | | served by | | | | | | gNB. | | | | | | | | | | | | NOTE 5: In | | | | | | this | | | | | | version of | | | | | | the | | | | | | sp | | | | | | ecification | | | | | | only for | | | | | | TBS | | | | | | positioning | | | | | | based on | | | | | | MBS | | | | | | signals. | | | | | | | | | | | | NOTE 6: | | | | | | Void | | | | | +-------------+----------+-------------+-------------+-------------+
Sensor, WLAN, Bluetooth, and TBS positioning methods based on MBS signals are
also supported in standalone mode, as described in the corresponding clauses.
### 4.3.2 Network-assisted GNSS methods
These methods make use of UEs that are equipped with radio receivers capable
of receiving GNSS signals. In 3GPP specifications the term GNSS encompasses
both global and regional/augmentation navigation satellite systems.
Examples of global navigation satellite systems include GPS, Modernized GPS,
Galileo, GLONASS, and BeiDou Navigation Satellite System (BDS). Regional
navigation satellite systems include Quasi Zenith Satellite System (QZSS)
while the many augmentation systems, listed in 8.1.1, are classified under the
generic term of Space Based Augmentation Systems (SBAS) and provide regional
augmentation services.
In this concept, different GNSSs (e.g. GPS, Galileo, etc.) can be used
separately or in combination to determine the location of a UE.
The operation of the network-assisted GNSS methods is described in clause 8.1.
### 4.3.3 OTDOA positioning
The OTDOA positioning method makes use of the measured timing of downlink
signals received from multiple TPs, comprising eNBs, ng-eNBs and PRS-only TPs,
at the UE. The UE measures the timing of the received signals using assistance
data received from the positioning server, and the resulting measurements are
used to locate the UE in relation to the neighbouring TPs.
The operation of the OTDOA method is described in clause 8.2.
### 4.3.4 Enhanced Cell ID methods
In the Cell ID (CID) positioning method, the position of an UE is estimated
with the knowledge of its serving ng-eNB, gNB and cell. The information about
the serving ng-eNB, gNB and cell may be obtained by paging, registration, or
other methods.
Enhanced Cell ID (E‑CID) positioning refers to techniques which use additional
UE measurements and/or NG-RAN radio resource and other measurements to improve
the UE location estimate.
In this version of the specification, E-CID is supported for E-UTRA only.
However, depending on the serving NG-RAN node e.g. ng-eNB, uplink E-CID may be
supported based on GERAN, UTRA or WLAN signals.
Although E-CID positioning may utilise some of the same measurements as the
measurement control system in the RRC protocol, the UE generally is not
expected to make additional measurements for the sole purpose of positioning;
i.e., the positioning procedures do not supply a measurement configuration or
measurement control message, and the UE reports the measurements that it has
available rather than being required to take additional measurement actions.
In cases with a requirement for close time coupling between UE and ng-eNB
measurements (e.g., T~ADV~ type 1 and UE E-UTRA Rx-Tx time difference), the
ng-eNB configures the appropriate RRC measurements and is responsible for
maintaining the required coupling between the measurements.
The operation of the Enhanced Cell ID method is described in clause 8.3.
### 4.3.5 Barometric pressure sensor positioning
The barometric pressure sensor method makes use of barometric sensors to
determine the vertical component of the position of the UE. The UE measures
barometric pressure, optionally aided by assistance data, to calculate the
vertical component of its location or to send measurements to the positioning
server for position calculation.
This method should be combined with other positioning methods to determine the
3D position of the UE.
The operation of the Barometric pressure sensor positioning method is
described in clause 8.4.
### 4.3.6 WLAN positioning
The WLAN positioning method makes use of the WLAN measurements (AP identifiers
and optionally other measurements) and databases to determine the location of
the UE. The UE measures received signals from WLAN [21] access points,
optionally aided by assistance data, to send measurements to the positioning
server for position calculation. Using the measurement results and a
references database, the location of the UE is calculated.
Alternatively, the UE makes use of WLAN measurements and optionally WLAN AP
assistance data provided by the positioning server, to determine its location.
The operation of the WLAN positioning method is described in clause 8.5.
### 4.3.7 Bluetooth positioning
The Bluetooth positioning method makes use of Bluetooth measurements (beacon
identifiers and optionally other measurements) to determine the location of
the UE. The UE measures received signals from Bluetooth [22] beacons. Using
the measurement results and a references database, the location of the UE is
calculated. The Bluetooth methods may be combined with other positioning
methods (e.g. WLAN) to improve positioning accuracy of the UE.
The operation of the Bluetooth positioning method is described in clause 8.6.
### 4.3.8 TBS positioning
A Terrestrial Beacon System (TBS) consists of a network of ground-based
transmitters, broadcasting signals only for positioning purposes. The current
type of TBS positioning signals are the MBS (Metropolitan Beacon System)
signals [23] and Positioning Reference Signals (PRS) (TS 36.211 [24]). The UE
measures received TBS signals, optionally aided by assistance data, to
calculate its location or to send measurements to the positioning server for
position calculation.
The operation of the TBS positioning method based on MBS signals is described
in clause 8.7.
TBS positioning based on PRS signals is part of OTDOA positioning and
described in clause 8.2.
### 4.3.9 Motion sensor positioning
The motion sensor method makes use of different sensors such as
accelerometers, gyros, magnetometers, to calculate the displacement of UE. The
UE estimates a relative displacement based upon a reference position and/or
reference time. UE sends a report comprising the determined relative
displacement which can be used to determine the absolute position.
This method should be used with other positioning methods for hybrid
positioning.
The operation of the sensor positioning method is described in clause 8.8.
# 5 NG-RAN UE Positioning Architecture
## 5.1 Architecture
Figure 5.1-1 shows the architecture in 5GS applicable to positioning of a UE
with NR or E-UTRA access.
The AMF receives a request for some location service associated with a
particular target UE from another entity (e.g., GMLC) or the AMF itself
decides to initiate some location service on behalf of a particular target UE
(e.g., for an IMS emergency call from the UE) as described in TS 23.502 [26].
The AMF then sends a location services request to an LMF. The LMF processes
the location services request which may include transferring assistance data
to the target UE to assist with UE-based and/or UE-assisted positioning and/or
may include positioning of the target UE. The LMF then returns the result of
the location service back to the AMF (e.g., a position estimate for the UE. In
the case of a location service requested by an entity other than the AMF
(e.g., a GMLC), the AMF returns the location service result to this entity.
An ng-eNB may control several TPs, such as remote radio heads, or PRS-only TPs
for support of PRS-based TBS for E-UTRA.
An LMF may have a proprietary signalling connection to an E-SMLC which may
enable an LMF to access information from E‑UTRAN (e.g. to support the OTDOA
for E-UTRA positioning method using downlink measurements obtained by a target
UE of signals from eNBs and/or PRS-only TPs in E-UTRAN). Details of the
signalling interaction between an LMF and E-SMLC are outside the scope of this
specification.
An LMF may have a proprietary signalling connection to an SLP. The SLP is the
SUPL entity responsible for positioning over the user plane. Further details
of user-plane positioning are provided in [15][16]. Details of the signalling
interaction between an LMF and SLP are outside the scope of this
specification.
Figure 5.1-1: UE Positioning Architecture applicable to NG-RAN
NOTE 1: The gNB and ng-eNB may not always both be present.
NOTE 2: Void
NOTE 3: Proprietary interface possible.
## 5.2 UE Positioning Operations
To support positioning of a target UE and delivery of location assistance data
to a UE with NG-RAN access in 5GS, location related functions are distributed
as shown in the architecture in Figure 5.1-1 and as clarified in greater
detail in TS 23.501 [2]. The overall sequence of events applicable to the UE,
NG-RAN and LMF for any location service is shown in Figure 5.2-1.
Note that when the AMF receives a Location Service Request in case of the UE
is in CM-IDLE state, the AMF performs a network triggered service request as
defined in TS 23.502 [26] in order to establish a signalling connection with
the UE and assign a specific serving gNB or ng-eNB. The UE is assumed to be in
connected mode before the beginning of the flow shown in the Figure 5.2-1;
that is, any signalling that might be required to bring the UE to connected
mode prior to step 1a is not shown. The signalling connection may, however, be
later released (e.g. by the NG-RAN node as a result of signalling and data
inactivity) while positioning is still ongoing.
Figure 5.2-1: Location Service Support by NG-RAN
1a. Either: some entity in the 5GC (e.g. GMLC) requests some location service
(e.g. positioning) for a target UE to the serving AMF.
1b. Or: the serving AMF for a target UE determines the need for some location
service (e.g. to locate the UE for an emergency call).
2\. The AMF transfers the location service request to an LMF.
3a. The LMF instigates location procedures with the serving ng-eNB or gNB in
the NG-RAN -- e.g. to obtain positioning measurements or assistance data.
3b. In addition to step 3a or instead of step 3a, for downlink positioning the
LMF instigates location procedures with the UE -- e.g. to obtain a location
estimate or positioning measurements or to transfer location assistance data
to the UE.
4\. The LMF provides a location service response to the AMF and includes any
needed results -- e.g. success or failure indication and, if requested and
obtained, a location estimate for the UE.
5a. If step 1a was performed, the AMF returns a location service response to
the 5GC entity in step 1a and includes any needed results -- e.g. a location
estimate for the UE.
5b. If step 1b occurred, the AMF uses the location service response received
in step 4 to assist the service that triggered this in step 1b (e.g. may
provide a location estimate associated with an emergency call to a GMLC).
Location procedures applicable to NG-RAN occur in steps 3a and 3b in Figure
5.2-1 and are defined in greater detail in this specification. Other steps in
Figure 5.2-1 are applicable only to the 5GC and are described in greater
detail and in TS 23.502 [26].
Steps 3a and 3b can involve the use of different position methods to obtain
location related measurements for a target UE and from these compute a
location estimate and possibly additional information like velocity.
Positioning methods supported in this release are summarized in clause 4.3 and
described in detail in clause 8.
The case that the NG-RAN node functions as an LCS client is not supported in
this version of the specification.
## 5.3 NG-RAN Positioning Operations
### 5.3.1 General NG-RAN Positioning Operations
Separately from location service support for particular UEs, an LMF may
interact with elements in the NG-RAN in order to obtain measurement
information to help assist one or more position methods for all UEs.
### 5.3.2 OTDOA Positioning Support
An LMF can interact with any ng-eNB reachable from any of the AMFs with
signalling access to the LMF in order to obtain location related information
to support the OTDOA for E-UTRA positioning method, including PRS-based TBS
for E-UTRA. The information can include timing information for the TP in
relation to either absolute GNSS time or timing of other TPs and information
about the supported cells and TPs including PRS schedule.
Signalling access between the LMF and ng-eNB may be via any AMF with
signalling access to both the LMF and ng‑eNB.
An LMF can also interact with any gNB reachable from any of the AMFs with
signalling access to the LMF in order to obtain NR cell timing information to
support the OTDOA for E-UTRA positioning method, in case the UE is served by a
NR cell.
## 5.4 Functional Description of Elements Related to UE Positioning in NG-RAN
### 5.4.1 User Equipment (UE)
The UE may make measurements of downlink signals from NG-RAN and other sources
such as E-UTRAN, different GNSS and TBS systems, WLAN access points, Bluetooth
beacons, UE barometric pressure and motion sensors. The measurements to be
made will be determined by the chosen positioning method.
The UE may also contain LCS applications, or access an LCS application either
through communication with a network accessed by the UE or through another
application residing in the UE. This LCS application may include the needed
measurement and calculation functions to determine the UE\'s position with or
without network assistance. This is outside of the scope of this
specification.
The UE may also, for example, contain an independent positioning function
(e.g., GPS) and thus be able to report its position, independent of the NG-RAN
transmissions. The UE with an independent positioning function may also make
use of assistance information obtained from the network.
### 5.4.2 gNB
The gNB is a network element of NG-RAN that may provide information such as
serving cell ID of a target UE and communicates this information to an LMF.
NOTE: gNB based measurements for position estimate are not supported in this
version of the specification.
### 5.4.3 ng-eNB
The ng-eNB is a network element of NG-RAN that may provide measurement results
for position estimation and makes measurements of radio signals for a target
UE and communicates these measurements to an LMF.
The ng-eNB makes its measurements in response to requests from the LMF (on
demand or periodically).
An ng-eNB may serve several TPs, including for example remote radio heads and
PRS-only TPs for PRS-based TBS positioning for E-UTRA.
### 5.4.4 Location Management Function (LMF)
The LMF manages the support of different location services for target UEs,
including positioning of UEs and delivery of assistance data to UEs. The LMF
may interact with the serving gNB or serving ng-eNB for a target UE in order
to obtain position measurements for the UE, including uplink measurements made
by an ng-eNB and downlink measurements made by the UE that were provided to an
ng-eNB as part of other functions such as for support of handover.
The LMF may interact with a target UE in order to deliver assistance data if
requested for a particular location service, or to obtain a location estimate
if that was requested.
For positioning of a target UE, the LMF decides on the position methods to be
used, based on factors that may include the LCS Client type, the required QoS,
UE positioning capabilities, gNB positioning capabilities and ng-eNB
positioning capabilities. The LMF then invokes these positioning methods in
the UE, serving gNB and/or serving ng‑eNB. The positioning methods may yield a
location estimate for UE-based position methods and/or positioning
measurements for UE-assisted and network-based position methods. The LMF may
combine all the received results and determine a single location estimate for
the target UE (hybrid positioning). Additional information like accuracy of
the location estimate and velocity may also be determined.
# 6 Signalling protocols and interfaces
## 6.1 Network interfaces supporting positioning operations
### 6.1.1 General LCS control plane architecture
The general LCS control plane architecture in the 5GS applicable to a target
UE with NG-RAN access is defined in TS 23.501 [2].
### 6.1.2 NR-Uu interface
The NR-Uu interface, connecting the UE to the gNB over the air, is used as one
of several transport links for the LTE Positioning Protocol for a target UE
with NR access to NG-RAN.
### 6.1.3 LTE-Uu interface
The LTE-Uu interface, connecting the UE to the ng-eNB over the air, is used as
one of several transport links for the LTE Positioning Protocol for a target
UE with LTE access to NG-RAN.
### 6.1.4 NG-C interface
The NG-C interface between the gNB and the AMF and between the ng-eNB and the
AMF is transparent to all UE-positioning-related procedures. It is involved in
these procedures only as a transport link for the LTE Positioning Protocol.
For gNB related positioning procedures, the NG-C interface transparently
transports both positioning requests from the LMF to the gNB and positioning
results from the gNB to the LMF.
For ng-eNB related positioning procedures, the NG-C interface transparently
transports both positioning requests from the LMF to the ng-eNB and
positioning results from the ng-eNB to the LMF.
### 6.1.5 NLs interface
The NLs interface, between the LMF and the AMF, is transparent to all UE
related, gNB related and ng-eNB related positioning procedures. It is used
only as a transport link for the LTE Positioning Protocols LPP and NRPPa.
## 6.2 UE-terminated protocols
### 6.2.1 LTE Positioning Protocol (LPP)
The LTE Positioning Protocol (LPP) is terminated between a target device (the
UE in the control-plane case or SET in the user-plane case) and a positioning
server (the LMF in the control-plane case or SLP in the user-plane case). It
may use either the control- or user-plane protocols as underlying transport.
In this specification, only control plane use of LPP is defined. User plane
support of LPP is defined in [15] and [16].
LPP messages are carried as transparent PDUs across intermediate network
interfaces using the appropriate protocols (e.g., NGAP over the NG-C
interface, NAS/RRC over the LTE-Uu and NR-Uu interfaces). The LPP protocol is
intended to enable positioning for NR and LTE using a multiplicity of
different position methods, while isolating the details of any particular
positioning method and the specifics of the underlying transport from one
another.
The protocol operates on a transaction basis between a target device and a
server, with each transaction taking place as an independent procedure. More
than one such procedure may be in progress at any given moment. An LPP
procedure may involve a request/response pairing of messages or one or more
\"unsolicited\" messages. Each procedure has a single objective (e.g.,
transfer of assistance data, exchange of LPP related capabilities, or
positioning of a target device according to some QoS and use of one or more
positioning methods). Multiple procedures, in series and/or in parallel, can
be used to achieve more complex objectives (e.g., positioning of a target
device in association with transfer of assistance data and exchange of LPP
related capabilities). Multiple procedures also enable more than one
positioning attempt to be ongoing at the same time (e.g., to obtain a coarse
location estimate with low delay while a more accurate location estimate is
being obtained with higher delay).
An LPP session is defined between a positioning server and the target device,
the details of its relation with transactions are described in clause 4.1.2 of
TS 36.355 [19].
For the 3GPP 5GS Control Plane solution defined in TS 23.501 [2] and TS 23.502
[26], the UE is the target device and the LMF is the server. For SUPL 2.0
support, the SUPL Enabled Terminal (SET) is the target device and the SUPL
Location Platform (SLP) is the server. The operations controlled through LPP
are described further in clause 7.1.
### 6.2.2 Radio Resource Control (RRC) for NR
The RRC protocol for NR is terminated between the gNB and the UE. It provides
transport for LPP messages over the NR-Uu interface.
### 6.2.3 Radio Resource Control (RRC) for LTE
The RRC protocol for LTE is terminated between the ng-eNB and the UE. In
addition to providing transport for LPP messages over the LTE-Uu interface, it
supports transfer of measurements that may be used for positioning purposes
through the existing measurement systems specified in TS 36.331 [13].
## 6.3 NG-RAN Node terminated protocols
### 6.3.1 NR Positioning Protocol A (NRPPa)
The NR Positioning Protocol A (NRPPa) carries information between the NG-RAN
Node and the LMF. It is used to support the following positioning functions:
\- E-CID for E-UTRA where measurements are transferred from the ng-eNB to the
LMF.
\- Data collection from ng-eNB\'s and gNB\'s for support of OTDOA positioning
for E-UTRA.
\- Cell-ID and Cell Portion ID retrieval from gNB\'s for support of NR Cell ID
positioning method.
The NRPPa protocol is transparent to the AMF. The AMF routes the NRPPa PDUs
transparently based on a Routing ID corresponding to the involved LMF over
NG-C interface without knowledge of the involved NRPPa transaction. It carries
the NRPPa PDUs over NG-C interface either in UE associated mode or non-UE
associated mode.
### 6.3.2 NG Application Protocol (NGAP)
The NGAP protocol, terminated between the AMF and the NG-RAN Node, is used as
transport for LPP and NRPPa messages over the NG-C interface. The NGAP
protocol is also used to instigate and terminate NG-RAN Node related
positioning procedures.
## 6.4 Signalling between an LMF and UE
### 6.4.1 Protocol Layering
Figure 6.4.1-1 shows the protocol layering used to support transfer of LPP
messages between an LMF and UE. The LPP PDU is carried in NAS PDU between the
AMF and the UE.
Figure 6.4.1-1: Protocol Layering for LMF to UE Signalling
### 6.4.2 LPP PDU Transfer
Figure 6.4.2-1 shows the transfer of an LPP PDU between an LMF and UE, in the
network- and UE-triggered cases. These two cases may occur separately or as
parts of a single more complex operation.
Figure 6.4.2-1: LPP PDU transfer between LMF and UE (network- and UE-triggered
cases)
1\. Steps 1 to 4 may occur before, after, or at the same time as steps 5 to 8.
Steps 1 to 4 and steps 5 to 8 may also be repeated. Steps 1 to 4 are triggered
when the LMF needs to send an LPP message to the UE as part of some LPP
positioning activity. The LMF then invokes the Namf_Communication
_N1N2MessageTransfer service operation towards the AMF to request the transfer
of a LPP PDU to the UE. The service operation includes the LPP PDU together
with the LCS Correlation ID in the N1 Message Container as defined in TS
29.518 [29].
2\. If the UE is in CM-IDLE state (e.g. if the NG connection was previously
released due to data and signalling inactivity), the AMF initiates a network
triggered service request as defined in TS 23.502 [26] in order to establish a
signalling connection with the UE and assign a serving NG-RAN node.
3\. The AMF includes the LPP PDU in the payload container of a DL NAS
Transport message, and a Routing Identifier identifying the LMF in the
Additional Information of the DL NAS Transport message defined in TS 24.501
[29]. The AMF then sends the DL NAS Transport message to the serving NG-RAN
Node in an NGAP Downlink NAS Transport message defined in TS 38.413 [30]. The
AMF need not retain state information for this transfer; it can treat any
response in step 7 as a separate non-associated transfer.
4\. The NG-RAN Node forwards the DL NAS Transport message to the UE in an RRC
DL Information Transfer message.
5\. Steps 5 to 8 are triggered when the UE needs to send an LPP PDU to the LMF
as part of some LPP positioning activity. If the UE is in CM-IDLE state, the
UE instigates a UE triggered service request as defined in TS 23.502 [26] in
order to establish a signalling connection with the AMF and assign a serving
NG-RAN node.
6\. The UE includes the LPP PDU in the payload container of an UL NAS
Transport message, and the Routing Identifier, which has been received in step
4, in the Additional Information of the UL NAS Transport message defined in TS
24.501 [29]. The UE then sends the UL NAS Transport message to the serving NG-
RAN node in an RRC UL Information Transfer message.
7\. The NG-RAN node forwards the UL NAS Transport Message to the AMF in an
NGAP Uplink NAS Transport message.
8\. The AMF invokes the Namf_Communication_N1MessageNotify service operation
towards the LMF indicated by the Routing Identifier received in step 7. The
service operation includes the LPP PDU received in step 7 together with the
LCS Correlation ID in the N1 Message Container as defined in TS 29.518 [28].
## 6.5 Signalling between an LMF and NG-RAN node
### 6.5.1 Protocol Layering
Figure 6.5.1-1 shows the protocol layering used to support transfer of NRPPa
PDUs between an LMF and NG-RAN Node.
The NRPPa protocol is transparent to the AMF. The AMF routes the NRPPa PDUs
transparently based on a Routing ID which corresponds to the involved LMF node
over the NG interface without knowledge of the involved NRPPa transaction. It
carries the NRPPa PDUs over NG interface either in UE associated mode or non-
UE associated mode.
Figure 6.5.1-1: Protocol Layering for LMF to NG-RAN Signalling
### 6.5.2 NRPPa PDU Transfer for UE Positioning
Figure 6.5.2-1 shows NRPPa PDU transfer between an LMF and NG-RAN Node to
support positioning of a particular UE.
Figure 6.5.2-1: NRPPa PDU Transfer between an LMF and NG-RAN node for UE
Positioning
1\. Steps 1 to 3 are triggered when the LMF needs to send an NRPPa message to
the serving NG-RAN Node for a target UE as part of a NRPPa positioning
activity. The LMF then invokes the Namf_Communication_N1N2MessageTransfer
service operation towards the AMF to request the transfer of a NRPPa PDU to
the serving NG-RAN Node for the UE. The service operation includes the NRPPa
PDU together with the LCS Correlation ID in the N2 Message Container as
defined in TS 29.518 [28].
2\. If the UE is in CM-IDLE state (e.g. if the NG connection was previously
released due to data and signalling inactivity), the AMF performs a network
triggered service request as defined in TS 23.502 [26] in order to establish a
signalling connection with the UE and assign a serving NG-RAN Node.
3\. The AMF forwards the NRPPa PDU to the serving NG-RAN Node in an NGAP
Downlink UE Associated NRPPa Transport message over the NG signalling
connection corresponding to the UE and includes the Routing ID related to the
LMF. The AMF need not retain state information for this transfer \-- e.g. can
treat any response in step 4 as a separate non-associated transfer.
4\. Steps 4 and 5 are triggered when a serving NG-RAN Node needs to send an
NRPPa message to the LMF for a target UE as part of an NRPPa positioning
activity. The NG-RAN Node then sends an NRPPa PDU to the AMF in an NGAP Uplink
UE Associated NRPPa Transport message and includes the Routing ID received in
step 3.
5\. The AMF invokes the Namf_Communication_N2InfoNotify service operation
towards the LMF indicated by the Routing ID received in step 4\. The service
operation includes the NRPPa PDU received in step 4 together with the LCS
Correlation ID in the N2 Info Container as defined in TS 29.518 [28]. Steps 1
to 5 may be repeated.
### 6.5.3 NRPPa PDU Transfer for Positioning Support
Figure 6.5.3-1 shows NRPPa PDU transfer between an LMF and NG-RAN Node when
related to gathering data from the NG-RAN Node for positioning support for all
UEs.
Figure 6.5.3-1: NRPPa PDU Transfer between an LMF and NG-RAN for obtaining NG-
RAN Data
0\. An ng-eNB in the NG-RAN may communicate with several TPs (including PRS-
only TPs in case of PRS-based TBS is supported) to configure TPs, obtain TP
configuration information, etc.
> NOTE: ng-eNB--TP signalling and configuration is outside the scope of this
> specification.
1\. Steps 1 and 2 are triggered when the LMF needs to send an NRPPa message to
an NG-RAN Node to obtain data related to the NG-RAN Node, and possibly
associated TPs. The LMF invokes the Namf_Communication_N1N2MessageTransfer
service operation towards the AMF to request the transfer of a NRPPa PDU to a
NG-RAN node (gNB or ng-eNB) in the NG-RAN. The service operation includes the
target NG-RAN node identity and the NRPPa PDU in the N2 Information Container
as defined in TS 29.518 [28].
2\. The AMF forwards the NRPPa PDU to the identified NG-RAN Node in an NGAP
Downlink Non UE Associated NRPPa Transport message and includes a Routing ID
identifying the LMF. The AMF need not retain state information for this
transfer -- e.g. can treat any response in step 3 as a separate non-associated
transfer.
3\. Steps 3 and 4 are triggered when an NG-RAN Node needs to send an NRPPa PDU
to an LMF containing data applicable to the NG-RAN Node, and possibly
associated TPs. The NG-RAN Node then sends an NRPPa PDU to the AMF in an NGAP
Uplink Non UE Associated NRPPa Transport message and includes the Routing ID
received in step 2.
4\. The AMF invokes the Namf_Communication_N2InfoNotify service operation
towards the LMF indicated by the Routing Identifier received in step 3. The
service operation includes the NRPPa PDU received in step 3 in the N2 Info
Container as defined in TS 29.518 [28]. Steps 1 to 4 may be repeated.
## 6.6 Void
# 7 General NG-RAN UE Positioning procedures
## 7.1 General LPP procedures for UE Positioning
### 7.1.1 LPP procedures
Positioning procedures in the NG-RAN are modelled as transactions of the LPP
protocol using the procedures defined in this specification. A procedure
consists of a single operation of one of the following types:
\- Exchange of positioning capabilities;
\- Transfer of assistance data;
\- Transfer of location information (positioning measurements and/or position
estimate);
\- Error handling;
\- Abort.
Parallel transactions are permitted (i.e. a new LPP transaction may be
initiated, while another one is outstanding).
As described in clause 6.2.1, the protocol operates between a \"target\" and a
\"server\". In the control-plane context, these entities are the UE and LMF
respectively; in the SUPL context they are the SET and the SLP. A procedure
may be initiated by either the target or the server.
### 7.1.2 Positioning procedures
#### 7.1.2.1 Capability transfer
The capability transfer procedure between a \"target\" and a \"server\" is
specified in clause 7.1.2.1 of TS 36.305 [25].
#### 7.1.2.2 Assistance data transfer
The assistance data transfer procedure between a \"target\" and a \"server\"
is specified in clause 7.1.2.2 of TS 36.305 [25].
#### 7.1.2.3 Location information transfer
The location information transfer procedure between a \"target\" and a
\"server\" is specified in clause 7.1.2.3 of TS 36.305 [25].
#### 7.1.2.4 Multiple transactions
Multiple LPP transactions may be in progress simultaneously as specified in
clause 7.1.2.4 of TS 36.305 [25].
#### 7.1.2.5 Sequence of procedures
LPP procedures are not required to occur in any fixed order, in order to
provide greater flexibility in positioning. Thus, a UE may request assistance
data at any time in order to comply with a previous request for location
measurements from the LMF; an LMF may instigate more than one request for
location information (e.g., measurements or a location estimate) in case
location results from a previous request were not adequate for the requested
QoS; and the target device may transfer capability information to the server
at any time if not already performed.
Despite the flexibility allowed by LPP, it is expected that procedures will
normally occur in the following order:
1\. Capability Transfer;
2\. Assistance Data Transfer;
3\. Location Information Transfer (measurements and/or location estimate).
Specific examples for each positioning method are shown in clause 8.
#### 7.1.2.6 Error handling
The error handling procedure is specified in clause 7.1.2.6 of TS 36.305 [25].
#### 7.1.2.7 Abort
The abort procedure is specified in clause 7.1.2.7 of TS 36.305 [25].
## 7.2 General NRPPa Procedures for UE Positioning
### 7.2.1 NRPPa procedures
Positioning and data acquisition transactions between a LMF and NG-RAN node
are modelled by using procedures of the NRPPa protocol. There are two types of
NRPPa procedures:
\- UE associated procedure, i.e. transfer of information for a particular UE
(e.g. positioning measurements);
\- Non UE associated procedure, i.e. transfer of information applicable to the
NG-RAN node and associated TPs (e.g. gNB/ng-eNB/TP timing information).
Parallel transactions between the same LMF and NG-RAN node are supported; i.e.
a pair of LMF and NG-RAN node may have more than one instance of an NRPPa
procedure in execution at the same time.
For possible extensibility, the protocol is considered to operate between a
generic \"access node\" (e.g. ng-eNB) and a \"server\" (e.g. LMF). A procedure
is only initiated by the server.
Figure 7.2.1-1: A single NRPPa transaction
Figure 7.2.1-1 shows a single NRPPa transaction. The transaction is terminated
in step 2 in the case of a non UE associated procedure. For a UE associated
procedure to gather information concerning the access node, additional
responses may be allowed (e.g. sending of updated information periodically
and/or whenever there is some significant change). In this case, the
transaction may be ended after some additional responses. In the NRPPa
protocol, the described transaction may be realized by the execution of one
procedure defined as a request and a response, followed by one or several
procedures initiated by the NG-RAN node (each procedure defined as a single
message) to realize the additional responses. _The Correlation ID, as
specified in_ TS 29.572 _[33], included by the LMF when it invokes the
Namf_Communication_N1N2MessageTransfer AMF service operation to transfer the
NRPPa PDU may be used by the LMF to identify the target UE positioning
session._
### 7.2.2 NRPPa transaction types
#### 7.2.2.1 Location information transfer
The term \"location information\" applies both to an actual position estimate
and to values used in computing position (e.g., radio measurements or
positioning measurements). It is delivered in response to a request.
Figure 7.2.2‑1: Location information transfer
1\. The server sends a request for location related information to the NG-RAN
node, and indicates the type of location information needed and associated
QoS. The request may refer to a particular UE.
2\. In response to step 1, the NG-RAN Node transfers location related
information to the server. The location related information transferred should
match the location related information requested in step 1.
3\. If requested in step 1, the NG-RAN node may transfer additional location
related information to the server in one or more additional NRPPa messages
when the positioning method is E-CID for E-UTRA.
## 7.3 Service Layer Support using combined LPP and NRPPa Procedures
### 7.3.1 General
As described in TS 23.502 [26], UE-positioning-related services can be
instigated from the 5GC for an NI-LR or MT‑LR location service. MO-LR location
service is not supported in this Release of the specification. The complete
sequence of operations in the 5GC is defined in TS 23.502 [26]. This clause
defines the overall sequences of operations that occur in the LMF, NG-RAN and
UE as a result of the 5GC operations.
### 7.3.2 NI-LR and MT-LR Service Support
Figure 7.3.2-1 shows the sequence of operations for an NI-LR or MT-LR location
service, starting at the point where the AMF initiates the service in the LMF.
Figure 7.3.2-1: UE Positioning Operations to support an MT-LR or NI-LR
1\. The AMF sends a location request to the LMF for a target UE and may
include associated QoS.
2\. The LMF may obtain location related information from the UE and/or from
the serving NG-RAN Node. In the former case, the LMF instigates one or more
LPP procedures to transfer UE positioning capabilities, provide assistance
data to the UE and/or obtain location information from the UE. The UE may also
instigate one or more LPP procedures after the first LPP message is received
from the LMF (e.g., to request assistance data from the LMF).
3\. If the LMF needs location related information for the UE from the NG-RAN,
the LMF instigates one or more NRPPa procedures. Step 3 is not necessarily
serialised with step 2; if the LMF and NG-RAN Node have the information to
determine what procedures need to take place for the location service, step 3
could precede or overlap with step 2.
4\. The LMF returns a location response to the AMF with any location estimate
obtained as a result of steps 2 and 3.
## 7.4 General RRC procedures for UE Positioning
### 7.4.1 NR RRC Procedures
NR RRC supports the following positioning related procedures:
\- Location Measurement Indication.
#### 7.4.1.1 Location Measurement Indication
The location measurement indication procedure is used by the UE to request
measurement gaps for OTDOA RSTD measurements, or for subframe and slot timing
detection for inter-RAT E-UTRA RSTD measurements.
Figure 7.4.1.1-1: Location measurement indication procedure
> **Precondition:** The UE served by a gNB has received a LPP message from an
> LMF requesting inter-RAT RSTD measurements for OTDOA positioning.
1\. If the UE requires measurement gaps for performing the requested location
measurements while measurement gaps are either not configured or not
sufficient, or if the UE needs gaps to acquire the subframe and slot timing of
the target E-UTRA system before requesting measurement gaps for the inter-RAT
RSTD measurements (see TS 38.133 [32], the UE sends an RRC Location
Measurement Indication message to the serving gNB. The message indicates that
the UE is going to start location measurements, or that the UE is going to
acquire subframe and slot timing of the target E-UTRA system, and includes
information required for the gNB to configure the appropriate measurement
gaps. When the gNB has configured the required measurement gaps the UE
performs the location measurements or timing acquisition procedures.
2\. When the UE has completed the location procedures which required
measurement gaps, the UE sends another RRC Location Measurement Indication
message to the serving gNB. The message indicates that the UE has completed
the location measurements or timing acquisition procedures.
### 7.4.2 LTE RRC Procedures
LTE RRC supports the following positioning related procedures:
\- Inter-frequency RSTD measurement indication.
#### 7.4.2.1 Inter-frequency RSTD measurement indication
The Inter-frequency RSTD measurement indication procedure is used by the UE to
request measurement gaps for OTDOA RSTD measurements.
Figure 7.4.2.1-1: Inter-frequency RSTD measurement indication procedure
> **Precondition:** The UE served by an ng-eNB has received a LPP message from
> an LMF requesting inter‑frequency RSTD measurements for OTDOA positioning.
1\. If the UE requires measurement gaps for performing the requested
inter‑frequency RSTD measurements for OTDOA positioning while measurement gaps
are either not configured or not sufficient, the UE sends an RRC Inter-
frequency RSTD Measurement Indication message to the serving ng-eNB. The
message indicates that the UE is going to start inter-frequency RSTD
measurements and includes information required for the ng-eNB to configure the
appropriate measurement gaps. When the ng-eNB has configured the required
measurement gaps the UE performs the inter-frequency RSTD measurements.
2\. When the UE has completed the inter-frequency RSTD measurements which
required measurement gaps, the UE sends another RRC Inter-frequency RSTD
Measurement Indication message to the serving ng-eNB. The message indicates
that the UE has completed the inter-frequency RSTD measurements.
# 8 Positioning methods and Supporting Procedures
## 8.1 GNSS positioning methods
### 8.1.1 General
A navigation satellite system provides autonomous geo-spatial positioning with
either global or regional coverage. Augmentation systems, such as SBAS, are
navigation satellite systems that provide regional coverage to augment the
navigation systems with global coverage.
By definition, GNSS refers to satellite constellations that achieve global
coverage, however, in 3GPP specifications the term GNSS is used to encompass
global, regional, and augmentation satellite systems. The following GNSSs are
supported in this version of the specification:
\- GPS and its modernization [5], [6], [7]; (global coverage)
\- Galileo [8]; (global coverage)
\- GLONASS [9]; (global coverage)
\- Satellite Based Augmentation Systems (SBAS), including WAAS, EGNOS, MSAS,
and GAGAN [11]; (regional coverage)
\- Quasi-Zenith Satellite System (QZSS) [10]; (regional coverage)
\- BeiDou Navigation Satellite System (BDS) [20]. (global coverage)
Each global GNSS can be used individually or in combination with others,
including regional navigation systems and augmentation systems. When used in
combination, the effective number of navigation satellite signals would be
increased:
\- extra satellites can improve **availability** (of satellites at a
particular location) and results in an improved ability to work in areas where
satellite signals can be obscured, such as in urban canyons;
\- extra satellites and signals can improve **reliability** , i.e., with extra
measurements the data redundancy is increased, which helps identify any
measurement outlier problems;
\- extra satellites and signals can improve **accuracy** due to improved
measurement geometry and improved ranging signals from modernized satellites.
When GNSS is designed to inter-work with the NG-RAN, the network assists the
UE GNSS receiver to improve the performance in several respects. These
performance improvements will:
\- reduce the UE GNSS start-up and acquisition times; the search window can be
limited and the measurements speed up significantly;
\- increase the UE GNSS sensitivity; positioning assistance messages are
obtained via NG-RAN so the UE GNSS receiver can operate also in low SNR
situations when it is unable to demodulate GNSS satellite signals;
\- allow the UE to consume less handset power than with stand-alone GNSS; this
is due to rapid start-up times as the GNSS receiver can be in idle mode when
it is not needed;
\- allow the UE to compute its position with a better accuracy; RTK
corrections (for N-RTK) and GNSS physical models (for SSR/PPP) are obtained
via NG-RAN so the UE can use these assistance data, together with its own
measurements, i.e., code and carrier phase measurements, to enable computation
of a position with a high accuracy.
The network-assisted GNSS methods rely on signalling between UE GNSS receivers
(possibly with reduced complexity) and a continuously operating GNSS reference
receiver network, which has clear sky visibility of the same GNSS
constellation as the assisted UEs. Two assisted modes are supported:
_\- UE-Assisted_ : The UE performs GNSS measurements (pseudo-ranges, pseudo
Doppler, carrier phase ranges, etc.) and sends these measurements to the LMF
where the position calculation takes place, possibly using additional
measurements from other (non GNSS) sources;
_\- UE-Based_ : The UE performs GNSS measurements and calculates its own
location, possibly using additional measurements from other (non GNSS) sources
and assistance data from the LMF.
The assistance data content may vary depending on whether the UE operates in
UE-Assisted or UE-Based mode.
The assistance data signalled to the UE can be broadly classified into:
\- _data assisting the measurements_ : e.g. reference time, visible satellite
list, satellite signal Doppler, code phase, Doppler and code phase search
windows;
\- _data providing means for position calculation_ : e.g. reference time,
reference position, satellite ephemeris, clock corrections, code and carrier
phase measurements from a GNSS reference receiver or network of receivers;
\- _data increasing the position accuracy_ : e.g. satellite code biases,
satellite orbit corrections, satellite clock corrections, atmospheric models,
RTK residuals, gradients.
A UE with GNSS measurement capability may also operate in an autonomous
(standalone) mode. In autonomous mode the UE determines its position based on
signals received from GNSS without assistance from the network.
### 8.1.2 Information to be transferred between NG-RAN/5GC Elements
This clause defines the information that may be transferred between LMF and
UE.
#### 8.1.2.1 Information that may be transferred from the LMF to UE
Table 8.1.2.1-1 lists assistance data for both UE-assisted and UE-based modes
that may be sent from the LMF to the UE.
NOTE: The provision of these assistance data elements and the usage of these
elements by the UE depend on the NG-RAN/5GC and UE capabilities, respectively.
Table 8.1.2.1-1: Information that may be transferred from the LMF to UE
* * *
Assistance Data Reference Time Reference Location Ionospheric Models Earth
Orientation Parameters GNSS-GNSS Time Offsets Differential GNSS Corrections
Ephemeris and Clock Models Real-Time Integrity Data Bit Assistance Acquisition
Assistance Almanac UTC Models RTK Reference Station Information RTK Auxiliary
Station Data RTK Observations RTK Common Observation Information GLONASS RTK
Bias Information RTK MAC Correction Differences RTK Residuals RTK FKP
Gradients SSR Orbit Corrections SSR Clock Corrections SSR Code Bias
* * *
##### 8.1.2.1.1 Reference Time
Reference Time assistance provides the GNSS receiver with coarse or fine GNSS
time information. The specific GNSS system times (e.g., GPS, Galileo, GLONASS,
BDS system time) shall be indicated with a GNSS ID.
In case of coarse time assistance only, the Reference Time provides an
estimate of the current GNSS system time (where the specific GNSS is indicated
by a GNSS ID). The LMF should achieve an accuracy of ±3 seconds for this time
including allowing for the transmission delay between LMF and UE.
In case of fine time assistance, the Reference Time provides the relation
between GNSS system time (where the specific GNSS is indicated by a GNSS ID)
and NG-RAN air-interface timing.
##### 8.1.2.1.2 Reference Location
Reference Location assistance provides the GNSS receiver with an a priori
estimate of its location (e.g., obtained via Cell-ID, OTDOA positioning, etc.)
together with its uncertainty.
The geodetic reference frame shall be WGS-84, as specified in TS 23.032 [4].
##### 8.1.2.1.3 Ionospheric Models
Ionospheric Model assistance provides the GNSS receiver with parameters to
model the propagation delay of the GNSS signals through the ionosphere.
Ionospheric Model parameters as specified by GPS [5], Galileo [8], QZSS [10],
and BDS [20] may be provided.
##### 8.1.2.1.4 Earth Orientation Parameters
Earth Orientation Parameters (EOP) assistance provides the GNSS receiver with
parameters needed to construct the ECEF-to-ECI coordinate transformation as
specified by GPS [5].
##### 8.1.2.1.5 GNSS-GNSS Time Offsets
GNSS-GNSS Time Offsets assistance provides the GNSS receiver with parameters
to correlate GNSS time (where the specific GNSS is indicated by a GNSS-1 ID)
of one GNSS with other GNSS time (where the specific GNSS is indicated by a
GNSS-2 ID). GNSS-GNSS Time Offsets parameters as specified by GPS [5], Galileo
[8], GLONASS [9], QZSS [10], and BDS [20] may be provided.
##### 8.1.2.1.6 Differential GNSS Corrections
Differential GNSS Corrections assistance provides the GNSS receiver with
pseudo-range and pseudo-range-rate corrections to reduce biases in GNSS
receiver measurements as specified in [12]. The specific GNSS for which the
corrections are valid is indicated by a GNSS-ID.
##### 8.1.2.1.7 Ephemeris and Clock Models
Ephemeris and Clock Models assistance provides the GNSS receiver with
parameters to calculate the GNSS satellite position and clock offsets. The
various GNSSs use different model parameters and formats, and all parameter
formats as defined by the individual GNSSs are supported by the signalling.
##### 8.1.2.1.8 Real-Time Integrity
Real-Time Integrity assistance provides the GNSS receiver with information
about the health status of a GNSS constellation (where the specific GNSS is
indicated by a GNSS ID).
##### 8.1.2.1.9 Data Bit Assistance
Data Bit Assistance provides the GNSS receiver with information about data
bits or symbols transmitted by a GNSS satellite at a certain time (where the
specific GNSS is indicated by a GNSS ID). This information may be used by the
UE for sensitivity assistance (data wipe-off) and time recovery.
##### 8.1.2.1.10 Acquisition Assistance
Acquisition Assistance provides the GNSS receiver with information about
visible satellites, reference time, expected code-phase, expected Doppler,
search windows (i.e., code and Doppler uncertainty) and other information of
the GNSS signals (where the specific GNSS is indicated by a GNSS ID) to enable
a fast acquisition of the GNSS signals.
##### 8.1.2.1.11 Almanac
Almanac assistance provides the GNSS receiver with parameters to calculate the
coarse (long-term) GNSS satellite position and clock offsets. The various
GNSSs use different model parameters and formats, and all parameter formats as
defined by the individual GNSSs are supported by the signalling.
##### 8.1.2.1.12 UTC Models
UTC Models assistance provides the GNSS receiver with parameters needed to
relate GNSS system time (where the specific GNSS is indicated by a GNSS ID) to
Universal Coordinated Time. The various GNSSs use different model parameters
and formats, and all parameter formats as defined by the individual GNSSs are
supported by the signalling.
##### 8.1.2.1.13 RTK Reference Station Information
RTK Reference Station Information provides the GNSS receiver with the Earth-
Centered, Earth-Fixed (ECEF) coordinates of the Reference Station\'s installed
antenna\'s ARP, and the height of the ARP above the survey monument.
Additionally, this assistance data provides information about the antenna type
installed at the reference site.
NOTE: With the MAC N-RTK technique this assistance data is used to provide
information regarding the Master Reference Station (see clause 8.1.2.1a).
##### 8.1.2.1.14 RTK Auxiliary Station Data
RTK Auxiliary Station Data provides the GNSS receiver with the location for
all Auxiliary Reference Stations (see clause 8.1.2.1a) within the assistance
data. These values are expressed as relative geodetic coordinates (latitude,
longitude, and height) with respect to a Master Reference Station (see clause
8.1.2.1a) and based on the GRS80 ellipsoid. This type of assistance data is
relevant only with the MAC N-RTK technique [31].
##### 8.1.2.1.15 RTK Observations
RTK Observations provides the GNSS receiver with all primary observables
(pseudo-range, phase-range, phase-range rate (Doppler), and carrier-to-noise
ratio) generated at the Reference Station for each GNSS signal. The signal
generation from the reference station is in compliance with [31]: as an
example, the phase measurements of different signals in the same band must be
phased aligned. More examples can be found in [31].
The pseudo-range is the distance between the satellite and GNSS receiver
antennas, expressed in metres, equivalent to the difference of the time of
reception (expressed in the time frame of the GNSS receiver) and the time of
transmission (expressed in the time frame of the satellite) of a distinct
satellite signal.
The phase-range measurement is a measurement of the range between a satellite
and receiver expressed in units of cycles of the carrier frequency. This
measurement is more precise than the pseudo-range (of the order of
millimetres), but it is ambiguous by an unknown integer number of wavelengths.
The phase-range rate is the rate at which the phase-range between a satellite
and a GNSS receiver changes over a particular period of time.
The carrier-to-noise ratio is the ratio of the received modulated carrier
signal power to the noise power after the GNSS receiver filters.
NOTE: With the MAC N-RTK technique this assistance data is used to provide raw
observables recorded at the Master Reference Station (see clause 8.1.2.1a).
##### 8.1.2.1.16 RTK Common Observation Information
RTK Common Observation Information provides the GNSS receiver with common
information applicable to any GNSS, e.g. clock steering indicator. This
assistance data is always used together GNSS RTK Observations (see clause
8.1.2.1.15).
##### 8.1.2.1.17 GLONASS RTK Bias Information
RTK Bias Information provides the GNSS receiver with information which is
intended to compensate for the first-order inter-frequency phase-range biases
introduced by the reference receiver code-phase biases. This information is
applicable only for GLONASS FDMA signals. In the case that the MAC Network RTK
method is used, GLONASS RTK Bias Information defines the code-phase biases
related to the Master Reference Station [31].
##### 8.1.2.1.18 RTK MAC Correction Differences
RTK MAC Correction Differences provides the GNSS receiver with information
about ionospheric (dispersive) and geometric (non-dispersive) corrections
generated between a Master Reference Station and its Auxiliary Reference
Stations [31].
##### 8.1.2.1.19 RTK Residuals
RTK Residuals provides the GNSS receiver with network error models generated
for the interpolated corrections disseminated in Network RTK techniques. With
sufficient redundancy in the RTK network, the location server process can
provide an estimate for residual interpolation errors. Such quality estimates
may be used by the target UE to optimize the performance of RTK solutions. The
values may be considered by the target UE as a priori estimates only, with
sufficient tracking data available the target UE might be able to judge
residual geometric and ionospheric errors itself. According to [31], RTK
Residual error information should be transmitted every 10-60 seconds.
##### 8.1.2.1.20 RTK FKP Gradients
RTK FKP Gradients provides the GNSS receiver with horizontal gradients for the
geometric (troposphere and satellite orbits) and ionospheric signal components
in the observation space. According to [31], RTK FKP gradient information
should be typically transmitted every 10-60 seconds.
##### 8.1.2.1.21 SSR Orbit Corrections
SSR Orbit Corrections provides the GNSS receiver with parameters for orbit
corrections in radial, along-track and cross-track components. These orbit
corrections are used to compute a satellite position correction, to be
combined with satellite position ^­^calculated from broadcast ephemeris (see
clause 8.1.2.1.7).
NOTE 1: The orbit corrections define an offset between the broadcast ephemeris
orbit and a satellite antenna reference point (ARP) to which the other
corrections refer. The exact definition of the reference point along the
satellite antenna is implementation-defined by the Network and use of all
corrections together shall yield a consistent solution.
NOTE 2: The UE should not apply any additional corrections for the Satellite
Antenna Phase Center (APC) such as Phase Center Offset (PCO) or Phase Center
Variation (PCV) corrections. The Network may form the SSR corrections to
minimise the impact of Satellite APC effects on the UE.
##### 8.1.2.1.22 SSR Clock Corrections
SSR Clock Corrections provides the GNSS receiver with parameters to compute
the GNSS satellite clock correction applied to the broadcast satellite clock
(see clause 8.1.2.1.7). A polynomial of order 2 describes the clock
differences for a certain time period: clock offset, drift, and drift rate.
##### 8.1.2.1.23 SSR Code Bias
SSR Code Bias provides the GNSS receiver with the Code Biases that must be
added to the pseudo range measurements of the corresponding code signal to get
corrected pseudo ranges. SSR Code Bias contains absolute values, but also
enables the alternative use of Differential Code Biases by setting one of the
biases to zero. A UE can consistently use signals for which a code bias is
transmitted. It is not reliable for a UE to use a signal without retrieving a
corresponding code bias from the assistance data message.
#### 8.1.2.1a Recommendations for grouping of assistance data to support
different RTK service levels
The high-accuracy GNSS methods can be classified as:
\- _Single base RTK service_ : RTK is a technique that uses carrier-based
ranging measurements i.e., phase-range to improve the positioning accuracy in
a differential approach. The basic concept is to reduce and remove errors
common to a Reference Station, with known position, and UE pair. When only
pseudo ranges (code-based measurements) are used to compute the UE location,
this method is known as DGNSS (Differential GNSS).
Table 8.1.2.1a-1: Single base RTK service: Specific information that may be
transferred from the LMF to the UE
* * *
Assistance Data RTK Reference Station Information RTK Observations RTK Common
Observation Information GLONASS RTK Bias Information (if GLONASS data is
transmitted) Ephemeris and Clock (if UE did not acquire the navigation
message)
* * *
\- _Non-Physical Reference Station Network RTK service_ : In this approach the
target UE receives synthetic observations from a fictitious Reference Station.
The Network RTK software at the location server is performing the error
estimation and creates a virtual Reference Station close to the initial
location of the target device (provided a priori to the location server). The
target UE interprets and uses the data just as if it had come from a single,
real Reference Station. Additionally, the target UE can also receive network
information such as RTK Network Residuals (see clause 8.1.2.1.19) or even FKP
gradients (see clause 8.1.2.1.20).
Table 8.1.2.1a-2: Non-Physical Reference Station Network RTK service: Specific
information that may be transferred from the LMF to the UE
* * *
Assistance Data RTK Reference Station Information RTK Observations RTK Common
Observation Information GLONASS RTK Bias Information (if GLONASS data is
transmitted) RTK Residuals RTK FKP Gradients Ephemeris and Clock (if UE did
not acquire the navigation message)
* * *
\- _MAC Network RTK service_ : In MAC network RTK, a group of Reference
Stations are used and one of them is chosen as a Master station. The other
stations are then called Auxiliary stations. In this service, the location
server sends full raw observations and coordinate information for a single
Reference Station, the Master Station. For all auxiliary stations in the
network (or a suitable subset of stations) the information is provided to the
UE in a highly compact form: their reduced ambiguity-levelled observations,
coordinate differences (to the Master Station observations and coordinates),
and network residuals. Two Reference Stations are said to be on a common
ambiguity level if the integer ambiguities for each phase range (satellite-
receiver pair) have been removed (or adjusted) so that the integer ambiguities
cancel when double-differences (involving two receivers and two satellites)
are formed during processing. The maintenance of a common ambiguity level at a
specific set of stations rather than across the whole GNSS network will lead
to a grouping in network clusters or subnetworks of all ambiguity-levelled
Reference Stations. If one network has only one subnetwork, this indicates
that an ambiguity level throughout the whole network is established. When
subnetworks are predefined, the assistance data can be broadcast to all UEs
located in the assigned sub-network. More details on the usage of subnetworks
can be found in [31].
Table 8.1.2.1a-3: MAC Network RTK service: Specific Information that may be
transferred from the LMF to the UE
* * *
Assistance Data RTK Reference Station Information RTK Auxiliary Station Data
RTK Observations RTK Common Observation Information GLONASS RTK Bias
Information (if GLONASS data is transmitted) RTK MAC Correction Differences
RTK Residuals Ephemeris and Clock (if UE did not acquire the navigation
message)
* * *
\- _FKP Network RTK service_ : With the concept of FKP, horizontal gradients
of distance-dependent errors like ionosphere, troposphere and orbits are
derived from a network of GNSS Reference Stations and transmitted to a target
device together with raw or correction data of a corresponding Reference
Station (physical or non physical). The target UE may use the gradients to
compute the effect of the distance-dependent errors for its own position.
Table 8.1.2.1a-4: FKP Network RTK service: Information that may be transferred
from the LMF to the UE
* * *
Assistance Data RTK Reference Station Information RTK Observations RTK Common
Observation Information GLONASS RTK Bias Information (if GLONASS data is
transmitted) RTK Residuals RTK FKP Gradients Ephemeris and Clock (if UE did
not acquire the navigation message)
* * *
\- _PPP service_ : This concept uses precise satellite orbit and clock
parameters derived from global networks of Reference Stations as well as
atmospheric models to perform single station positioning [31]. Compared to RTK
and Network RTK, PPP is not a differential technique as there is no baseline
limitation. When the orbits and clocks assistance data elements are provided
in real-time, with no latency, the method is called Real-Time PPP.
Table 8.1.2.1a-5: SSR PPP service: Information that may be transferred from
the LMF to the UE
* * *
Assistance Data SSR Orbit Corrections SSR Clock corrections SSR Code Bias
Ephemeris and Clock (if UE did not acquire the navigation message)
* * *
#### 8.1.2.2 Information that may be transferred from the UE to LMF
The information that may be signalled from UE to the LMF is listed in table
8.1.2.2-1.
Table 8.1.2.2-1: Information that may be transferred from UE to the LMF
* * *
Information UE‑assisted UE‑based/standalone Latitude/Longitude/Altitude,
together with uncertainty shape No Yes Velocity, together with uncertainty
shape No Yes Reference Time, possibly together with GNSS to NG-RAN time
association and uncertainty Yes Yes Indication of used positioning methods in
the fix No Yes Code phase measurements, also called pseudorange Yes No Doppler
measurements Yes No Carrier phase measurements, also called Accumulated Delta
Range (ADR) Yes No Carrier-to-noise ratio of the received signal Yes No
Measurement quality parameters for each measurement Yes No Additional, non-
GNSS related measurement information Yes No
* * *
##### 8.1.2.2.1 GNSS Measurement Information
The GNSS measurement information reported from the UE to the LMF depends on
the GNSS mode (i.e., UE-based, autonomous (standalone), or UE-assisted).
###### 8.1.2.2.1.1 UE-based mode
In UE-based or standalone mode, the GNSS receiver reports the latitude,
longitude and possibly altitude, together with an estimate of the location
uncertainty, if available.
If requested by the LMF and supported by the UE, the GNSS receiver may report
its velocity, possibly together with an estimate of the uncertainty, if
available.
If requested by the LMF and supported by the UE, the GNSS receiver may report
the relation between GNSS system time (where the specific GNSS is indicated by
a GNSS ID; the specific GNSS system time may be selected by the UE) and NG-RAN
air-interface timing. This information may be used by the LMF to assist other
UEs in the network.
The UE should also report an indication of which GNSSs and possibly other
location methods have been used to calculate a fix.
###### 8.1.2.2.1.2 UE-assisted mode
In UE-assisted mode, the GNSS receiver reports the Code Phase and Doppler
measurements together with associated quality estimates. These measurements
enable the LMF to calculate the location of the UE, possibly using other
measurements and data.
If requested by the LMF and supported by the UE, the GNSS receiver may report
Carrier Phase measurements (also called Accumulated Delta Range), together
with associated quality measurements, if available.
If requested by the LMF and supported by the UE, the GNSS receiver may report
the relation between GNSS system time (where the specific GNSS is indicated by
a GNSS ID; the specific GNSS system time may be selected by the UE) and NG-RAN
air-interface timing. This information may be used by the LMF to assist other
UEs in the network.
##### 8.1.2.2.2 Additional Non-GNSS Related Information
Additional non-GNSS measurements performed by NG-RAN or UE may be used by the
LMF or UE to calculate or verify a location estimate. This information may
include OTDOA positioning measurements, pathloss and signal strength related
measurements, etc.
### 8.1.3 Assisted-GNSS Positioning Procedures
#### 8.1.3.1 Capability Transfer Procedure
The Capability Transfer procedure for Assisted-GNSS positioning is described
in clause 7.1.2.1.
#### 8.1.3.2 Assistance Data Transfer Procedure
The purpose of this procedure is to enable the LMF to provide assistance data
to the UE (e.g., as part of a positioning procedure) and the UE to request
assistance data from the LMF (e.g., as part of a positioning procedure). In
the case of high-accuracy GNSS positioning techniques (e.g., RTK), the LMF can
provide unsolicited periodic assistance data to the UE and the UE can request
periodic assistance data from the LMF.
##### 8.1.3.2.1 LMF initiated Assistance Data Delivery
Figure 8.1.3.2.1-1 shows the Assistance Data Delivery operations for the
network-assisted GNSS method when the procedure is initiated by the LMF.
Figure 8.1.3.2.1-1: LMF-initiated Assistance Data Delivery Procedure
> (1) The LMF determines that assistance data needs to be provided to the UE
> (e.g., as part of a positioning procedure) and sends an LPP Provide
> Assistance Data message to the UE. This message may include any of the GNSS
> assistance data defined in clause 8.1.2.1.
##### 8.1.3.2.1a LMF initiated Periodic Assistance Data Delivery
The Periodic Assistance Data Delivery procedure allows the server to provide
unsolicited periodic assistance data to the target and is shown in Figure
8.1.3.2.1a-1.
NOTE: In this version of the specification, periodic assistance data delivery
is supported for HA GNSS (e.g., RTK) positioning only.
Figure 8.1.3.2.1a-1: LPP Periodic Assistance data delivery procedure
(1) The LMF determines that assistance data needs to be provided to the UE and
sends an LPP Provide Assistance Data message to the UE. This message includes
information to identify the type of periodic assistance data and a duration
for ending the assistance data delivery. The message indicates the end of the
control transaction.
(2) When the first periodic message is available, the LMF sends an unsolicited
LPP Provide Assistance Data message to the UE containing the periodic
assistance data announced in step (1).
(3) The LMF may continue to send further LPP Provide Assistance Data messages
to the target containing the periodic assistance data announced in step (1)
when each additional periodicity condition occurs. When the duration for
ending the periodic assistance data transfer occurs, the last LPP Provide
Assistance Data message transferred indicates the end of transaction.
Additionally, the session can be ended on request by the UE or by the LMF with
the help of an Abort message.
##### 8.1.3.2.2 UE initiated Assistance Data Transfer
Figure 8.1.3.2.2-1 shows the Assistance Data Transfer operations for the
network-assisted GNSS method when the procedure is initiated by the UE.
Figure 8.1.3.2.2-1: UE-initiated Assistance Data Transfer Procedure
(1) The UE determines that certain A-GNSS assistance data are desired (e.g.,
as part of a positioning procedure when the LMF provided assistance data are
not sufficient for the UE to fulfil the request) and sends a LPP Request
Assistance Data message to the LMF. This request includes an indication of
which specific A-GNSS assistance data are requested for each GNSS, possibly
together with additional information (e.g., for which GNSS signal types, or
satellites, or times the assistance is requested, etc.). Additional
information concerning the UE\'s approximate location and serving and
neighbour cells may also be provided in the Request Assistance Data message
and/or in an accompanying Provide Location Information message to help the LMF
provide appropriate assistance data. This additional data may include the
UE\'s last known location if available, the cell IDs of the UE serving NG-RAN
node and possibly neighbour NG-RAN nodes, as well as E-UTRA E-CID
measurements.
(2) The LMF provides the requested assistance data in a LPP Provide Assistance
Data message, if available at the LMF. The entire set of assistance data may
be delivered in one or several LPP messages, e.g., one message per GNSS. In
this case, this step may be repeated by the LMF several times. If any of the
UE requested assistance data in step (1) are not provided in step 2, the UE
shall assume that the requested assistance data are not supported, or
currently not available at the LMF. If none of the UE requested assistance
data in step (1) can be provided by the LMF, return any information that can
be provided in an LPP message of type Provide Assistance Data which includes a
cause indication for the not provided assistance data.
##### 8.1.3.2.2a UE initiated Periodic Assistance Data Transfer
Figure 8.1.3.2.2a-1 shows the Periodic Assistance Data Transfer operations for
the high-accuracy GNSS methods (e.g., RTK) when the procedure is initiated by
the UE.
NOTE: In this version of the specification, periodic assistance data transfer
is supported for HA GNSS (e.g., RTK) positioning only.
Figure 8.1.3.2.2a-1: UE-initiated Periodic Assistance Data Transfer Procedure
(1) The UE determines that periodic assistance data are desired and sends a
LPP Request Assistance Data message to the LMF. This request includes an
indication of which specific assistance data are requested together with
additional information such as desired periodicity for sending the assistance
data and a duration for ending the periodic assistance data delivery session.
(2) The LMF responds with a LPP Provide Assistance Data message to the UE. If
the UE request can be supported, the message contains information which may
confirm or redefine the type of assistance data or periodicity parameters
requested at step (1). This response indicates the end of the control
transaction.
(3) When available, the LMF provides the requested assistance data in a LPP
Provide Assistance Data message to the UE. If any of the requested assistance
data in step (1) or redefined in step (2) are not provided the UE assumes that
the requested assistance data are not supported, or currently not available at
the LMF.
(4) The LMF may transmit one or more additional LPP Provide Assistance Data
messages to the UE containing further periodic assistance data confirmed or
redefined in step (2). When the duration for ending the periodic assistance
data transfer occur, the last LPP Provide Assistance Data message transferred
indicates the end of the transaction. Additionally, the periodic assistance
data delivery session can be ended on request by the UE or by the LMF with the
help of an Abort message.
#### 8.1.3.3 Location Information Transfer Procedure
The purpose of this procedure is to enable the LMF to request position
measurements or location estimate from the UE, or to enable the UE to provide
location measurements to the LMF for position calculation.
##### 8.1.3.3.1 LMF initiated Location Information Transfer Procedure
Figure 8.1.3.3.1-1 shows the Location Information Transfer operations for the
network-assisted GNSS method when the procedure is initiated by the LMF.
Figure 8.1.3.3.1-1: LMF-initiated Location Information Transfer Procedure
(1) The LMF sends a LPP Request Location Information message to the UE for
invocation of A-GNSS positioning. This request includes positioning
instructions such as the GNSS mode (UE-assisted, UE-based, UE-based preferred
but UE-assisted allowed, UE-assisted preferred, but UE-based allowed,
standalone), positioning methods (GPS, Galileo, GLONASS, BDS, etc. and
possibly non-GNSS methods, such as OTDOA positioning or E-CID positioning),
specific UE measurements requested if any, such as fine time assistance
measurements, velocity, carrier phase, multi-frequency measurements, and
quality of service parameters (accuracy, response time).
(2) The UE performs the requested measurements and possibly calculates its own
location. The UE sends an LPP Provide Location Information message to the LMF
before the Response Time provided in step (1) elapsed. If the UE is unable to
perform the requested measurements, or if the Response Time provided in step 1
elapsed before any of the requested measurements have been obtained, the UE
returns any information that can be provided in an LPP message of type Provide
Location Information which includes a cause indication for the not provided
location information.
##### 8.1.3.3.2 UE-initiated Location Information Delivery Procedure
Figure 8.1.3.3.2-1 shows the Location Information delivery operations for the
UE-assisted GNSS method when the procedure is initiated by the UE.
Figure 8.1.3.3.2-1: UE-initiated Location Information Delivery Procedure
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include any UE measurements (GNSS
pseudo-ranges, carrier phase-ranges, and other measurements) already available
at the UE.
## 8.2 OTDOA positioning
### 8.2.1 General
In this version of the specification, only OTDOA based on LTE signals is
supported.
In the OTDOA positioning method, the UE position is estimated based on
measurements taken at the UE of downlink radio signals from multiple E-UTRA
TPs (possibly including PRS-only E-UTRA TPs from a PRS-based TBS), along with
knowledge of the geographical coordinates of the measured TPs and their
relative downlink timing.
The UE while connected to a gNB may require measurement gaps to perform the
OTDOA measurements from E-UTRA TPs. The UE may request measurement gaps from a
gNB using the procedure described in clause 7.4.1.1. If the UE is not aware of
the SFN of at least one E-UTRA TP in the OTDOA assistance data, the UE may use
autonomous gaps to acquire SFN of the E-UTRA OTDOA reference cell prior to
requesting measurement gaps for performing the requested E-UTRA RSTD
measurements.
The UE while connected to a ng-eNB may require measurement gaps to perform
inter-frequency RSTD measurements for OTDOA from E-UTRA TPs (see TS 38.133
[32]). The UE may request measurement gaps from a ng-eNB using the procedure
described in clause 7.4.2.1.
The specific positioning techniques used to estimate the UE\'s location from
this information are beyond the scope of this specification.
### 8.2.2 Information to be transferred between NG-RAN/5GC Elements
This clause defines the information that may be transferred between LMF and
UE/ng-eNB.
#### 8.2.2.1 Information that may be transferred from the LMF to UE
The following assistance data may be transferred from the LMF to the UE:
\- Physical cell IDs (PCIs), global cell IDs (GCIs), and TP IDs of candidate
E-UTRA TPs for measurement;
\- Timing relative to the reference E-UTRA TP of candidate E-UTRA TPs;
\- PRS configuration of candidate E-UTRA TPs;
\- If known, the SFN timing offset between the serving NR cell and the E-UTRA
assistance data reference cell.
NOTE: The LMF can provide the UE with a list of E-UTRA TP candidates for
measurement, even if the LMF does not know the SFN or frame timing of the
E-UTRA TPs.
#### 8.2.2.2 Information that may be transferred from the ng-eNB to LMF
The following assistance data may be transferred from the ng-eNB to the LMF:
\- PCI, GCI, and TP IDs of the TPs served by the ng-eNB;
\- Timing information of TPs served by the ng-eNB;
\- PRS configuration of the TPs served by the ng-eNB;
\- Geographical coordinates of the TPs served by the ng-eNB.
An ng-eNB may provide assistance data relating only to itself and served TPs
via NRPPa signalling, although assistance data from several ng-eNBs and served
TPs may be acquired through other mechanisms, see NOTE below.
NOTE: The assistance data described in this clause are not necessarily
transferred only from the ng-eNB, and in some deployment options may not be
delivered from the ng-eNB at all; they may also be delivered to the LMF
through OAM or other mechanisms external to the NG-RAN. In addition, in cases
where assistance data are delivered from the ng-eNB, how the ng-eNB acquires
the data is outside the scope of this specification.
#### 8.2.2.3 Information that may be transferred from the UE to LMF
The information that may be signalled from UE to the LMF is listed in Table
8.2.2.3-1. The individual UE measurements are defined in TS 36.214 [17].
Table 8.2.2.3-1: Information that may be transferred from UE to the LMF
* * *
Information Measurements Downlink Measurement Results List for EUTRA TPs
Physical cell IDs Global cell IDs TP IDs Downlink timing measurements
Information used to compute a reference time corresponding to the downlink
timing measurements to allow correlation of downlink timing measurements with
motion information independently obtained from motion sensors Delta SFN for
each E-UTRA neighbour cell
* * *
#### 8.2.2.4 Information that may be transferred from the gNB to LMF
The following assistance data may be transferred from the gNB to the LMF:
\- NR CGI and timing information of the cells served by the gNB;
\- Geographical coordinates of the access points associated with each cell
served by the gNB.
### 8.2.3 OTDOA Positioning Procedures
The procedures described in this clause support OTDOA positioning measurements
obtained by the UE and provided to the LMF using LPP.
In this version of the specification only the UE-assisted OTDOA positioning is
supported.
#### 8.2.3.1 Capability Transfer Procedure
The Capability Transfer procedure for OTDOA positioning is described in clause
7.1.2.1.
#### 8.2.3.2 Assistance Data Transfer Procedure
##### 8.2.3.2.1 Assistance Data Transfer between LMF and UE
The purpose of this procedure is to enable the LMF to provide assistance data
to the UE (e.g., as part of a positioning procedure) and the UE to request
assistance data from the LMF (e.g., as part of a positioning procedure).
###### 8.2.3.2.1.1 LMF initiated Assistance Data Delivery
Figure 8.2.3.2.1.1-1 shows the Assistance Data Delivery operations for the
OTDOA positioning method when the procedure is initiated by the LMF.
Figure 8.2.3.2.1.1-1: LMF-initiated Assistance Data Delivery Procedure
(1) The LMF determines that assistance data needs to be provided to the UE
(e.g., as part of a positioning procedure) and sends an LPP Provide Assistance
Data message to the UE. This message may include any of the OTDOA positioning
assistance data defined in clause 8.2.2.1.
###### 8.2.3.2.1.2 UE initiated Assistance Data Transfer
Figure 8.2.3.2.1.2-1 shows the Assistance Data Transfer operations for the
OTDOA positioning method when the procedure is initiated by the UE.
Figure 8.2.3.2.1.2-1: UE-initiated Assistance Data Transfer Procedure
(1) The UE determines that certain OTDOA positioning assistance data are
desired (e.g., as part of a positioning procedure when the LMF provided
assistance data are not sufficient for the UE to fulfil the request) and sends
an LPP Request Assistance Data message to the LMF. This request includes an
indication of which specific OTDOA assistance data are requested. Additional
information concerning the UE\'s approximate location and serving and
neighbour cells may also be provided in the Request Assistance Data message
and/or in an accompanying Provide Location Information message to help the LMF
provide appropriate assistance data. This additional data may include the
UE\'s last known location if available, the cell IDs of the UE serving NG-RAN
node and possibly neighbour NG-RAN nodes, as well as E-UTRA E-CID
measurements.
(2) The LMF provides the requested assistance in an LPP Provide Assistance
Data message, if available at the LMF. If any of the UE requested assistance
data in step (1) are not provided in step 2, the UE shall assume that the
requested assistance data are not supported, or currently not available at the
LMF. If none of the UE requested assistance data in step (1) can be provided
by the LMF, return any information that can be provided in an LPP message of
type Provide Assistance Data which includes a cause indication for the not
provided assistance data.
##### 8.2.3.2.2 Assistance Data Delivery between LMF and NG-RAN node
The purpose of this procedure is to enable the NG-RAN node to provide
assistance data to the LMF, for subsequent delivery to the UE using the
procedures of clause 8.2.3.2.1 or for use in the calculation of positioning
estimates at the LMF.
###### 8.2.3.2.2.1 LMF-initiated assistance data delivery to the LMF
Figure 8.2.3.2.2.1-1 shows the Assistance Data Delivery operation from the NG-
RAN node to the LMF for the OTDOA positioning method, in the case that the
procedure is initiated by the LMF.
Figure 8.2.3.2.2.1-1: LMF-initiated Assistance Data Delivery Procedure
(1) The LMF determines that certain OTDOA positioning assistance data are
desired (e.g., as part of a periodic update or as triggered by OAM) and sends
an NRPPa OTDOA INFORMATION REQUEST message to the NG-RAN node. This request
includes an indication of which specific OTDOA assistance data are requested.
(2) The NG-RAN node provides the requested assistance in an NRPPa OTDOA
INFORMATION RESPONSE message, if available at the NG-RAN node. If the NG-RAN
node is not able to provide any information, it returns an OTDOA INFORMATION
FAILURE message indicating the cause of the failure.
#### 8.2.3.3 Location Information Transfer Procedure
The purpose of this procedure is to enable the LMF to request position
measurements from the UE, or to enable the UE to provide location measurements
to the LMF for position calculation.
##### 8.2.3.3.1 LMF-initiated Location Information Transfer Procedure
Figure 8.2.3.3.1-1 shows the Location Information Transfer operations for the
OTDOA positioning method when the procedure is initiated by the LMF.
Figure 8.2.3.3.1-1: LMF-initiated Location Information Transfer Procedure
(1) The LMF sends an LPP Request Location Information message to the UE. This
request includes indication of OTDOA measurements requested, including any
needed measurement configuration information, and required response time.
(2) The UE obtains OTDOA measurements as requested in step 1. The UE then
sends an LPP Provide Location Information message to the LMF, before the
Response Time provided in step (1) elapsed, and includes the obtained OTDOA
measurements. If the UE is unable to perform the requested measurements, or
the Response Time elapsed before any of the requested measurements were
obtained, the UE returns any information that can be provided in an LPP
message of type Provide Location Information which includes a cause indication
for the not provided location information.
##### 8.2.3.3.2 UE-initiated Location Information Delivery procedure
Figure 8.2.3.3.2-1 shows the Location Information Delivery procedure
operations for the OTDOA positioning method when the procedure is initiated by
the UE.
Figure 8.2.3.3.2-1: UE-initiated Location Information Delivery Procedure.
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include any UE OTDOA measurements
already available at the UE.
## 8.3 Enhanced cell ID positioning methods
### 8.3.1 General
In the Cell ID (CID) positioning method, the UE position is estimated with the
knowledge of the geographical coordinates of its serving ng-eNB or gNB.
Enhanced Cell ID (E-CID) positioning refers to techniques which use UE and/or
NG-RAN radio resource related measurements to improve the UE location
estimate.
In this version of the specification, E-CID based on LTE signals only is
supported. However, depending on the serving NG-RAN node e.g. ng-eNB, uplink
E-CID may be supported based on GERAN, UTRA or WLAN signals.
NOTE 1: For E-CID positioning methods the UE reports only the measurements
that it has available rather than being required to take additional
measurement actions. Therefore, the measurement gap request procedure
described in clause 7.4.1.1 is not applicable for E-CID positioning methods.
E-CID measurements for E-UTRA may include [17, 18]:
UE measurements (TS 36.214 [17], TS 36.302 [18]):
\- E-UTRA Reference signal received power (RSRP);
\- E-UTRA Reference Signal Received Quality (RSRQ);
\- UE E-UTRA Rx -- Tx time difference;
E-CID UE measurements for other RAT may include:
\- GERAN RSSI;
\- UTRAN CPICH RSCP;
\- UTRAN CPICH Ec/Io;
\- WLAN RSSI.
NOTE 2: The GERAN, UTRAN and WLAN measurements by UE are only used for Uplink
E-CID positioning when UE is served by ng-eNB
ng-eNB measurements (TS 36.214 [17], TS 36.302 [18]):
\- ng-eNB Rx -- Tx time difference;
\- Timing Advance (T~ADV~):
\- Type1: T~ADV~ = (ng-eNB Rx -- Tx time difference) + (UE E-UTRA Rx -- Tx
time difference);
\- Type2: T~ADV~ = ng-eNB Rx -- Tx time difference;
\- Angle of Arrival (AoA).
Various techniques exist to use these measurements to estimate the location of
the UE. The specific techniques are beyond the scope of this specification.
### 8.3.2 Information to be transferred between NG-RAN/5GC Elements
This clause defines the information that may be transferred between LMF and
UE/NG-RAN node.
#### 8.3.2.1 Information that may be transferred from the LMF to UE
UE-assisted Enhanced Cell-ID location does not require any assistance data to
be transferred from the LMF to the UE.
UE-Based Enhanced Cell-ID location is not supported in this version of the
specification.
#### 8.3.2.2 Information that may be transferred from the ng-eNB to LMF
The information that may be signalled from ng-eNB to the LMF is listed in
table 8.3.2.2-1.
Table 8.3.2.2-1: Information that may be transferred from ng-eNB to the LMF
* * *
Information  
Timing Advance (T~ADV~)  
Angle of Arrival (AoA)  
E-UTRA Measurement Results List:  
\- Evolved Cell Global Identifier (ECGI)/Physical Cell ID \- E-UTRA Reference
signal received power (RSRP) \- E-UTRA Reference Signal Received Quality
(RSRQ) GERAN Measurement Results List:  
\- Base Station Identity Code (BSIC) \- ARFCN of Base Station Control Channel
(BCCH) \- Received Signal Strength Indicator (RSSI) UTRA Measurement Results
List:  
\- UTRAN Physical ID \- Common Pilot Channel Received Signal Code Power (RSCP)
\- Common Pilot Channel Ec/Io WLAN Measurement Results List:  
\- WLAN Received Signal Strength Indicator (RSSI) \- SSID \- BSSID \- HESSID
\- Operating Class \- Country Code \- WLAN Channel(s) \- WLAN Band
* * *
#### 8.3.2.3 Information that may be transferred from the gNB to LMF
The information that may be signalled from gNB to the LMF is listed in table
8.3.2.3-1.
Table 8.3.2.3-1: Information that may be transferred from gNB to the LMF
* * *
Information  
NR Measurement Results List:  
\- Cell Global Identifier /Physical Cell ID \- Cell Portion ID
* * *
#### 8.3.2.4 Information that may be transferred from the UE to LMF
The information that may be signalled from UE to the LMF is listed in table
8.3.2.4-1.
Table 8.3.2.4-1: Information that may be transferred from UE to the LMF
* * *
Information UE‑assisted Evolved Cell Global Identifier (ECGI)/Physical Cell ID
Yes E-UTRA Reference signal received power (RSRP) Yes E-UTRA Reference Signal
Received Quality (RSRQ) Yes UE E-UTRA Rx -- Tx time difference Yes
* * *
### 8.3.3 Downlink E-CID Positioning Procedures
The procedures described in this clause support E-CID related measurements
obtained by the UE and provided to the LMF using LPP. The term \"downlink\" is
intended to indicate that from the LMF perspective the involved measurements
are provided by the UE; this set of procedures might also be considered as
\"UE-assisted, LMF-based E-CID\".
#### 8.3.3.1 Capability Transfer Procedure
The Capability Transfer procedure for E-CID positioning is described in clause
7.1.2.1.
#### 8.3.3.2 Assistance Data Transfer Procedure
Assistance data transfer is not required for E-CID positioning.
#### 8.3.3.3 Location Information Transfer Procedure
The purpose of this procedure is to enable the LMF to request position
measurements from the UE, or to enable the UE to provide location measurements
to the LMF for position calculation.
##### 8.3.3.3.1 LMF-initiated Location Information Transfer
Figure 8.3.3.3-1 shows the Location Information Transfer operations for the
E-CID method when the procedure is initiated by the LMF.
Figure 8.3.3.3-1: LMF-initiated Location Information Transfer Procedure.
(1) The LMF sends a LPP Request Location Information message to the UE for
invocation of E-CID positioning. This request includes the E-CID measurements
requested by the LMF and supported by the UE as listed in Table 8.3.2.4-1
together with a required response time.
(2) The UE sends an LPP Provide Location Information message to the LMF and
reports the requested measurements that are available in the UE before the
Response Time provided in step (1) elapsed. If the requested measurements are
not available, or if the Response Time provided in step 1 elapsed before any
of the requested measurements have been obtained, the UE returns any
information that can be provided in an LPP message of type Provide Location
Information which includes a cause indication for the not provided location
information.
##### 8.3.3.3.2 UE-initiated Location Information Delivery procedure
Figure 8.3.3.3.2-1 shows the Location Information Delivery procedure
operations for the E-CID method when the procedure is initiated by the UE.
Figure 8.3.3.3.2-1: UE-initiated Location Information Delivery Procedure.
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include any UE measurements already
available at the UE.
### 8.3.4 Uplink E-CID Positioning Procedures
The procedures described in this clause support E-CID related measurements
obtained by the NG-RAN node and provided to the LMF using NRPPa. The term
\"uplink\" is intended to indicate that from the LMF point of view, the
involved measurements are provided by the NG-RAN node; this set of procedures
might also be considered as \"NG-RAN node-assisted E-CID\". An example of this
uplink E-CID positioning method for E-UTRA is AoA+T~ADV~.
#### 8.3.4.1 Capability Transfer Procedure
The Capability Transfer procedure is not applicable to uplink E-CID
positioning not using E-UTRA T~ADV~ type 1. For uplink E-CID positioning using
E-UTRA T~ADV~ type 1, the Capability Transfer procedure for E-CID positioning
is described in clause 7.1.2.1.
#### 8.3.4.2 Assistance Data Transfer Procedure
The assistance data transfer procedure is not applicable to uplink E-CID
positioning.
#### 8.3.4.3 Position Measurement Procedure
The purpose of this procedure is to enable the LMF to request position
measurements from the NG-RAN node.
##### 8.3.4.3.1 LMF-initiated Position Measurement
Figure 8.3.4.3.1-1 shows the position measurement operations for the uplink
E-CID method when the procedure is initiated by the LMF.
Figure 8.3.4.3.1-1: LMF-initiated Position Measurement Procedure
(1) The LMF sends a NRPPa E-CID MEASUREMENT INITIATION REQUEST message to the
NG-RAN node. This request includes indication of E-CID measurements requested
and whether the result is expected only once or periodically.
(2) If the LMF in step (1) requested UE measurements (e.g., E-UTRA RSRP,
E-UTRA RSRQ measurements, etc.), the NG-RAN node may configure the UE to
report the measurement information requested as specified in TS 36.331 [13],
TS 38.331 [14].
(3) If the result is expected only once and the NG-RAN node initiates at least
one of the E-CID measurements as requested, the NG-RAN node sends an NRPPa
E-CID MEASUREMENT INITIATION RESPONSE to the LMF, which includes the obtained
E-CID measurements. If the result is expected periodically and the NG-RAN node
is able to initiate at least one of the E-CID measurements as requested, the
NG-RAN node sends an NRPPa E-CID MEASUREMENT INITIATION RESPONSE to the LMF,
which does not include any result. The NG-RAN node reports then the obtained
measurements by initiating the E-CID Measurement Report procedure, with the
requested periodicity. If the NG-RAN node is unable to initiate any of the
requested measurements as requested from the LMF, or is unable to instigate
any of the required RRC procedures to obtain the requested measurements from
the UE, the NG-RAN node sends an NRPPa E-CID MEASUREMENT INITIATION FAILURE
message providing the error reason. If the failure occurs during a periodic
reporting, the NG-RAN node sends an NRPPa E-CID MEASUREMENT FAILURE INDICATION
message.
## 8.4 Barometric pressure sensor positioning
8.4.1 General
In the barometric pressure sensor positioning method, the UE vertical
component of the position is estimated by combining the measured atmospheric
pressure and a reference atmospheric pressure. This is accomplished through
barometric sensors measuring atmospheric pressure at the UE, and applying a
height determination algorithm using the reference atmospheric pressure.
Three positioning modes are supported:
\- _UE-Assisted_ : The UE performs barometric pressure sensor measurements
with or without assistance from the network and sends these measurements to
the LMF where the vertical component of the position calculation may take
place, possibly using additional measurements from other sources;
\- _UE-Based_ : The UE performs barometric pressure sensor measurements and
calculates its own vertical component of the position, possibly using
additional measurements from other sources.
\- _Standalone_ : The UE performs barometric pressure sensor measurements and
calculates its own vertical component of the position, possibly using
additional measurements from other sources, without network assistance.
### 8.4.2 Information to be transferred between NG-RAN/5GC Elements
This clause defines the information that may be transferred between LMF and
UE.
#### 8.4.2.1 Information that may be transferred from the LMF to UE
Table 8.4.2.1-1 lists assistance data for both UE-assisted and UE-based modes
that may be sent from the LMF to the UE.
NOTE: The provision of these assistance data elements and the usage of these
elements by the UE depend on the NG-RAN/5GC and UE capabilities, respectively.
Table 8.4.2.1-1: Information that may be transferred from the LMF to UE
* * *
Assistance Data Reference pressure Additional reference data
* * *
##### 8.4.2.1.1 Barometric pressure sensor assistance data
The barometric pressure sensor assistance data may include reference pressure,
along with other reference data, such as the reference point where the
reference barometric pressure is valid and reference temperature at the
reference point.
#### 8.4.2.2 Information that may be transferred from the UE to LMF
The information that may be signalled from the UE to the LMF is summarized in
Table 8.4.2.2-1.
Table 8.4.2.2-1: Information that may be transferred from UE to the LMF
+---------------------------------------------------+-------------+------------+ | Information | UE‑assisted | UE-based/ | | | | | | | | Standalone | +---------------------------------------------------+-------------+------------+ | UE position estimate with uncertainty shape | No | Yes | +---------------------------------------------------+-------------+------------+ | Indication of used positioning methods in the fix | No | Yes | +---------------------------------------------------+-------------+------------+ | Timestamp | Yes | Yes | +---------------------------------------------------+-------------+------------+ | Barometric pressure sensor measurements | Yes | No | +---------------------------------------------------+-------------+------------+
##### 8.4.2.2.1 Standalone mode
In Standalone mode, the UE reports the vertical component of the position,
together with an estimate of the location uncertainty, if available.
The UE should also report an indication of which positioning method(s) have
been used to calculate a fix.
##### 8.4.2.2.2 UE-assisted mode
In UE-assisted mode, the UE reports the barometric pressure sensor
measurements together with associated quality estimates. These measurements
enable the LMF to calculate the vertical component of the location of the UE,
possibly using other measurements and data.
If requested by the LMF and supported by the UE, the UE may report barometric
pressure sensor measurements together with associated quality measurements, if
available.
##### 8.4.2.2.3 UE-based mode
In UE-based mode, the UE reports the vertical component of the position,
together with an estimate of the location uncertainty, if available.
The UE should also report an indication of which positioning method(s) have
been used to calculate a fix.
### 8.4.3 Barometric Pressure Sensor Positioning Procedures
#### 8.4.3.1 Capability Transfer Procedure
The Capability Transfer procedure for Barometric Pressure Sensor positioning
is described in clause 7.1.2.1.
#### 8.4.3.2 Assistance Data Transfer Procedure
The purpose of this procedure is to enable the LMF to provide assistance data
to the UE (e.g., as part of a positioning procedure) and the UE to request
assistance data from the LMF (e.g., as part of a positioning procedure).
##### 8.4.3.2.1 LMF initiated Assistance Data Delivery
Figure 8.4.3.2.1-1 shows the Assistance Data Delivery operations for the
network-assisted barometric pressure sensor method when the procedure is
initiated by the LMF.
Figure 8.4.3.2.1-1: LMF-initiated Assistance Data Delivery Procedure
(1) The LMF determines that assistance data needs to be provided to the UE
(e.g., as part of a positioning procedure) and sends an LPP Provide Assistance
Data message to the UE. This message may include any of the barometric
pressure sensor assistance data defined in clause 8.4.2.1.
##### 8.4.3.2.2 UE initiated Assistance Data Transfer
Figure 8.4.3.2.2-1 shows the Assistance Data Transfer operations for the
network-assisted Barometric pressure sensor method when the procedure is
initiated by the UE.
Figure 8.4.3.2.2-1: UE-initiated Assistance Data Transfer Procedure
(1) The UE determines that certain barometric pressure sensor assistance data
is desired (e.g., as part of a positioning procedure when the LMF provided
assistance data are not sufficient for the UE to fulfil the request) and sends
a LPP Request Assistance Data message to the LMF. This request includes an
indication of which specific barometric pressure sensor assistance data is
requested.
(2) The LMF provides the requested assistance data in a LPP Provide Assistance
Data message, if available at the LMF. The entire set of assistance data may
be delivered in one or several LPP messages. In this case, this step may be
repeated by the LMF several times. If any of the UE requested assistance data
in step (1) are not provided in step 2, the UE shall assume that the requested
assistance data are not supported, or currently not available at the LMF. If
none of the UE requested assistance data in step (1) can be provided by the
LMF, return any information that can be provided in an LPP message of type
Provide Assistance Data which includes a cause indication for the not provided
assistance data.
#### 8.4.3.3 Location Information Transfer Procedure
The purpose of this procedure is to enable the LMF to request barometric
pressure sensor measurements or position estimate from the UE, or to enable
the UE to provide barometric pressure sensor measurements to the LMF for
position calculation.
##### 8.4.3.3.1 LMF initiated Location Information Transfer Procedure
Figure 8.4.3.3.1-1 shows the Location Information Transfer operations when the
procedure is initiated by the LMF.
Figure 8.4.3.3.1-1: LMF-initiated Location Information Transfer Procedure
(1) The LMF sends a LPP Request Location Information message to the UE for
invocation of barometric pressure sensor positioning. This request includes
positioning instructions such as the positioning mode (UE-assisted, UE-based,
standalone), specific requested UE measurements if any, and quality of service
parameters (accuracy, response time).
(2) The UE performs the requested measurements and possibly calculates its own
position. The UE sends an LPP Provide Location Information message to the LMF
before the Response Time provided in step (1) elapsed. If the UE is unable to
perform the requested measurements, or if the Response Time provided in step 1
elapsed before any of the requested measurements have been obtained, the UE
returns any information that can be provided in an LPP message of type Provide
Location Information which includes a cause indication for the not provided
location information.
##### 8.4.3.3.2 UE-initiated Location Information Delivery Procedure
Figure 8.4.3.3.2-1 shows the Location Information delivery operations for the
barometric pressure sensor method when the procedure is initiated by the UE.
Figure 8.4.3.3.2-1: UE-initiated Location Information Delivery Procedure
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include UE barometric pressure sensor
measurements or location estimate already available at the UE.
## 8.5 WLAN positioning
### 8.5.1 General
In the WLAN positioning method, the UE position is estimated with the
knowledge of geographical coordinate of reference WLAN access points. This is
accomplished by collecting a certain amount of measurements from UE\'s WLAN
receivers, and applying a location determination algorithm using databases of
the estimated position\'s references points.
The UE WLAN measurements may include:
\- WLAN Received Signal Strength (RSSI);
\- Round Trip Time (RTT) between WLAN Access Point and the UE.
Three positioning modes are supported:
\- _Standalone_ :\ The UE performs WLAN position measurements and location
computation, without network assistance.
\- _UE-assisted_ :\ The UE provides WLAN position measurements with or without
assistance from the network to the LMF for computation of a location estimate
by the network.
\- _UE-based_ :\ The UE performs WLAN position measurements and computation of
a location estimate with network assistance.
### 8.5.2 Information to be transferred between NG-RAN/5GC Elements
This clause defines the information that may be transferred between LMF and
UE.
#### 8.5.2.1 Information that may be transferred from the LMF to UE
Table 8.5.2.1-1 lists assistance data for both UE-assisted and UE-based modes
that may be sent from the LMF to the UE.
NOTE: The provision of these assistance data elements and the usage of these
elements by the UE depend on the NG-RAN/5GC and UE capabilities, respectively.
Table 8.5.2.1-1: Information that may be transferred from the LMF to UE
* * *
Assistance Data **WLAN AP List** BSSID SSID AP Type Data^(1)^ AP Location NOTE
1: WLAN AP Type Data may include WLAN Type (e.g., 802.11a/b/g/n/ac/ad, etc.),
transmit power, antenna gain, coverage area, etc.
* * *
##### 8.5.2.1.1 WLAN AP BSSID
This assistance data provides the BSSID of the WLAN access point [21].
##### 8.5.2.1.2 WLAN AP SSID
This assistance data provides the SSID of the WLAN access point [21].
##### 8.5.2.1.3 WLAN AP Type Data
This assistance data provides additional information about the access point
and may include WLAN Type (e.g., 802.11a/b/g/n/ac/ad, etc.), transmit power,
antenna gain, coverage area, etc. [21]
##### 8.5.2.1.4 WLAN AP Location
This assistance data provides the location (possibly including altitude
information) of the access point [21].
#### 8.5.2.2 Information that may be transferred from the UE to LMF
The information that may be signalled from the UE to the LMF is summarized in
Table 8.5.2.2-1.
Table 8.5.2.2-1: Information that may be transferred from the UE to the LMF
+-----------------------------------------+-------------+------------+ | Information | UE‑Assisted | UE-based/ | | | | | | | | Standalone | +-----------------------------------------+-------------+------------+ | **WLAN Location Information** | | | +-----------------------------------------+-------------+------------+ | > BSSID | Yes | No | +-----------------------------------------+-------------+------------+ | > SSID | Yes | No | +-----------------------------------------+-------------+------------+ | > Received Signal Strength (RSSI) | Yes | No | +-----------------------------------------+-------------+------------+ | > Round Trip Time (RTT) | Yes | No | +-----------------------------------------+-------------+------------+ | > Time Stamp | Yes | No | +-----------------------------------------+-------------+------------+ | > Measurement characteristics | Yes | No | +-----------------------------------------+-------------+------------+ | **UE Location Information** | | | +-----------------------------------------+-------------+------------+ | > UE position estimate with uncertainty | No | Yes | | > shape | | | +-----------------------------------------+-------------+------------+ | > Position Time Stamp | No | Yes | +-----------------------------------------+-------------+------------+ | > Location Source (method(s) used to | No | Yes | | > compute location) | | | +-----------------------------------------+-------------+------------+
##### 8.5.2.2.1 Standalone mode
In Standalone mode, the UE reports the latitude, longitude and possibly
altitude, together with an estimate of the location uncertainty, if available.
The UE should also report an indication of WLAN method and possibly other
positioning methods used to calculate a fix.
##### 8.5.2.2.2 UE-assisted mode
In UE-assisted mode, the UE should report:
\- The BSSID/SSID of the measured WLAN access points, and associated RSSI or
RTT.
##### 8.5.2.2.3 UE-based mode
In UE-based mode, the UE reports the latitude, longitude, and possibly
altitude, together with an estimate of the location uncertainty, if available.
The UE should also report an indication that WLAN method is used and possibly
other positioning methods used to calculate the fix.
### 8.5.3 WLAN Positioning Procedures
#### 8.5.3.1 Capability Transfer Procedure
The Capability Transfer procedure for WLAN positioning is described in clause
7.1.2.1.
#### 8.5.3.2 Assistance Data Transfer Procedure
The purpose of this procedure is to enable the UE to request assistance data
from the LMF (e.g., as part of a positioning procedure) and the LMF to provide
assistance data to the UE (e.g., as part of a positioning procedure).
##### 8.5.3.2.1 LMF initiated Assistance Data Delivery
Figure 8.5.3.2.1-1 shows the Assistance Data Delivery operations for the
network-assisted WLAN method when the procedure is initiated by the LMF.
Figure 8.5.3.2.1: LMF-initiated Assistance Data Delivery Procedure
(1) The LMF determines that assistance data needs to be provided to the UE
(e.g., as part of a positioning procedure) and sends an LPP Provide Assistance
Data message to the UE. This message may include any of the WLAN assistance
data defined in clause 8.5.2.1.
##### 8.5.3.2.2 UE initiated Assistance Data Transfer
Figure 8.5.3.2.2-1 shows the Assistance Data Transfer operations for the
network-assisted WLAN method when the procedure is initiated by the UE.
Figure 8.5.3.2.2-1: UE-initiated Assistance Data Transfer Procedure
> (1) The UE determines that certain WLAN assistance data is desired (e.g., as
> part of a positioning procedure when the LMF provided assistance data are
> not sufficient for the UE to fulfil the request) and sends a LPP Request
> Assistance Data message to the LMF. This request includes an indication of
> which specific WLAN assistance data is requested.
>
> (2) The LMF provides the requested assistance data in a LPP Provide
> Assistance Data message, if available at the LMF. The entire set of
> assistance data may be delivered in one or several LPP messages. In this
> case, this step may be repeated by the LMF several times. If any of the UE
> requested assistance data in step (1) are not provided in step 2, the UE
> shall assume that the requested assistance data are not supported, or
> currently not available at the LMF. If none of the UE requested assistance
> data in step (1) can be provided by the LMF, return any information that can
> be provided in an LPP message of type Provide Assistance Data which includes
> a cause indication for the not provided assistance data.
##### 8.5.3.3 Location Information Transfer Procedure
The purpose of this procedure is to enable the LMF to request position
measurements or location estimate from the UE, or to enable the UE to provide
location measurements to the LMF for position calculation.
##### 8.5.3.3.1 LMF initiated Location Information Transfer Procedure
Figure 8.5.3.3.1-1 shows the Location Information Transfer operations for the
WLAN method when the procedure is initiated by the LMF.
Figure 8.5.3.3.1-1: LMF-initiated Location Information Transfer Procedure
(1) The LMF sends a LPP Request Location Information message to the UE for
invocation of WLAN positioning. This request includes positioning instructions
such as the positioning mode (UE-assisted, UE-based, Standalone), specific
requested UE measurements if any, and quality of service parameters (accuracy,
response time).
(2) The UE performs the requested measurements and possibly calculates its own
location. The UE sends an LPP Provide Location Information message to the LMF
before the Response Time provided in step (1) elapsed. If the UE is unable to
perform the requested measurements, or if the Response Time provided in step 1
elapsed before any of the requested measurements have been obtained, the UE
returns any information that can be provided in an LPP message of type Provide
Location Information which includes a cause indication for the not provided
location information.
##### 8.5.3.3.2 UE-initiated Location Information Delivery Procedure
Figure 8.5.3.3.2-1 shows the Location Information delivery operations for the
WLAN method when the procedure is initiated by the UE.
Figure 8.5.3.3.2-1: UE-initiated Location Information Delivery Procedure
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include UE WLAN information or
location estimate already available at the UE.
## 8.6 Bluetooth positioning
8.6.1 General
In the Bluetooth positioning method, the UE position is estimated with the
knowledge of geographical coordinate of reference Bluetooth beacons. This is
accomplished by collecting a certain amount of measurements from UE\'s
Bluetooth receiver, and applying a location determination algorithm using
databases of the estimated position\'s references points.
The UE Bluetooth measurements may include:
\- Bluetooth beacon\'s Received Signal Strength (RSSI).
Two positioning modes are supported:
\- _Standalone_ :\ The UE performs Bluetooth position measurements and
location computation.
\- _UE-assisted_ :\ The UE provides Bluetooth position measurements without
assistance from the network to the LMF for computation of a location estimate
by the network.
### 8.6.2 Information to be transferred between NG-RAN/5GC Elements
This clause defines the information that may be transferred between LMF and
UE.
#### 8.6.2.1 Information that may be transferred from the LMF to UE
Bluetooth positioning does not require any assistance data to be transferred
from the LMF to the UE.
#### 8.6.2.2 Information that may be transferred from the UE to LMF
The information that may be signalled from the UE to the LMF is summarized in
Table 8.6.2.2-1.
Table 8.6.2.2-1: Information that may be transferred from the UE to the LMF
+-----------------------------------------+-------------+------------+ | Information | UE‑Assisted | Standalone | +-----------------------------------------+-------------+------------+ | **Bluetooth Location Information** | | | +-----------------------------------------+-------------+------------+ | > MAC Address | Yes | No | +-----------------------------------------+-------------+------------+ | > Received Signal Strength (RSSI) | Yes | No | +-----------------------------------------+-------------+------------+ | > Time Stamp | Yes | No | +-----------------------------------------+-------------+------------+ | > Measurement characteristics | Yes | No | +-----------------------------------------+-------------+------------+ | **UE Location Information** | | | +-----------------------------------------+-------------+------------+ | > UE position estimate with uncertainty | No | Yes | | > shape | | | +-----------------------------------------+-------------+------------+ | > Position Time Stamp | No | Yes | +-----------------------------------------+-------------+------------+ | > Location Source (method(s) used to | No | Yes | | > compute location) | | | +-----------------------------------------+-------------+------------+
##### 8.6.2.2.1 Standalone mode
In Standalone mode, the UE reports the latitude, longitude and possibly
altitude, together with an estimate of the location uncertainty, if available.
The UE should also report an indication of Bluetooth method and possibly other
location methods have been used to calculate a fix.
##### 8.6.2.2.2 UE-assisted mode
In UE-assisted mode, the UE should report:
\- The MAC addresses of the measured Bluetooth beacons and associated RSSI.
### 8.6.3 Bluetooth Positioning Procedures
#### 8.6.3.1 Capability Transfer Procedure
The Capability Transfer procedure for Bluetooth positioning is described in
clause 7.1.2.1.
#### 8.6.3.2 Assistance Data Transfer Procedure
Assistance data transfer is not required for Bluetooth positioning.
#### 8.6.3.3 Location Information Transfer Procedure
The purpose of this procedure is to enable the LMF to request position
measurements or location estimate from the UE, or to enable the UE to provide
location measurements to the LMF for position calculation.
##### 8.6.3.3.1 LMF initiated Location Information Transfer Procedure
Figure 8.6.3.3.1-1 shows the Location Information Transfer operations for the
Bluetooth method when the procedure is initiated by the LMF.
Figure 8.6.3.3.1-1: LMF-initiated Location Information Transfer Procedure
(1) The LMF sends a LPP Request Location Information message to the UE for
invocation of Bluetooth positioning. This request includes positioning
instructions such as the positioning mode (UE-assisted, Standalone), specific
requested UE measurements if any, and quality of service parameters (accuracy,
response time).
(2) The UE performs the requested measurements and possibly calculates its own
location. The UE sends an LPP Provide Location Information message to the LMF
before the Response Time provided in step (1) elapsed. If the UE is unable to
perform the requested measurements, or if the Response Time provided in step 1
elapsed before any of the requested measurements have been obtained, the UE
returns any information that can be provided in an LPP message of type Provide
Location Information which includes a cause indication for the not provided
location information.
##### 8.6.3.3.2 UE-initiated Location Information Delivery Procedure
Figure 8.6.3.3.2-1 shows the Location Information delivery operations for the
Bluetooth method when the procedure is initiated by the UE.
Figure 8.6.3.3.2-1: UE-initiated Location Information Delivery Procedure
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include UE Bluetooth information or
location estimate already available at the UE.
## 8.7 TBS positioning
### 8.7.1 General
Terrestrial Beacon Systems (TBS) is the standard generic term for a network of
ground-based transmitters broadcasting signals for geo-spatial positioning
with wide-area or regional coverage. The following TBSs are supported in this
version of the specification:
\- Metropolitan Beacon Systems (MBS).
NOTE: PRS-based TBS is part of downlink OTDOA positioning and described in
clause 8.2.
Three positioning modes are supported:
\- _UE-Assisted_ : The UE performs TBS measurements with or without assistance
from the network, and sends these measurements to the LMF where the position
calculation takes place, possibly using additional measurements from other
(non-TBS) sources;
\- _UE-Based_ : The UE performs TBS measurements and calculates its own
location, possibly using additional measurements from other (non-TBS) sources.
\- _Standalone_ : The UE performs TBS measurements and calculates its own
location, possibly using additional measurements from other (non-TBS) sources,
without network assistance.
### 8.7.2 Information to be transferred between NG-RAN/5GC Elements
This clause defines the information that may be transferred between LMF and
UE.
#### 8.7.2.1 Information that may be transferred from the LMF to UE
Table 8.7.2.1-1 lists assistance data for both UE-assisted and UE-based modes
that may be sent from the LMF to the UE.
NOTE: The provision of these assistance data elements and the usage of these
elements by the UE depend on the NG-RAN/5GC and UE capabilities, respectively.
Table 8.7.2.1-1: Information that may be transferred from the LMF to UE
* * *
Assistance Data Acquisition assistance Almanac
* * *
##### 8.7.2.1.1 Acquisition Assistance
Acquisition assistance provides the MBS receiver with information about
visible beacons, PN Codes, and other information of the MBS signals to enable
a fast acquisition of the MBS signals.
##### 8.7.2.1.2 Almanac
Almanac assistance provides the MBS receiver with MBS beacon parameters that
can be used to determine the UE position.
#### 8.7.2.2 Information that may be transferred from the UE to LMF
The information that may be signalled from the UE to the LMF is summarized in
Table 8.7.2.2-1.
Table 8.7.2.2-1: Information that may be transferred from UE to the LMF
+-----------------------------------------------------+-------------+------------+ | Information | UE‑assisted | UE-based/ | | | | | | | | Standalone | +-----------------------------------------------------+-------------+------------+ | UE position estimate with uncertainty shape | No | Yes | +-----------------------------------------------------+-------------+------------+ | Timestamp | Yes | Yes | +-----------------------------------------------------+-------------+------------+ | Indication of used positioning methods in the fix | No | Yes | +-----------------------------------------------------+-------------+------------+ | TBS measurements (code phase (MBS)) | Yes | No | +-----------------------------------------------------+-------------+------------+ | Measurement quality parameters for each measurement | Yes | No | +-----------------------------------------------------+-------------+------------+
##### 8.7.2.2.1 Standalone mode
In Standalone mode, the UE reports the latitude, longitude and possibly
altitude, together with an estimate of the location uncertainty, if available.
The UE should also report an indication that TBS method is used and possibly
other positioning methods used to calculate the fix.
##### 8.7.2.2.2 UE-assisted mode
In UE-assisted mode, the UE reports the TBS associated measurements, together
with associated quality estimates. These measurements enable the LMF to
calculate the location of the UE, possibly using other measurements and data.
##### 8.7.2.2.3 UE-based mode
In UE-based mode, the UE reports the latitude and longitude, together with an
estimate of the location uncertainty, if available.
The UE should also report an indication that TBS method is used and possibly
other positioning methods used to calculate the fix.
### 8.7.3 TBS Positioning Procedures
#### 8.7.3.1 Capability Transfer Procedure
The Capability Transfer procedure for TBS positioning is described in clause
7.1.2.1.
#### 8.7.3.2 Assistance Data Transfer Procedure
The purpose of this procedure is to enable the LMF to provide assistance data
to the UE (e.g., as part of a positioning procedure) and the UE to request
assistance data from the LMF (e.g., as part of a positioning procedure).
##### 8.7.3.2.1 LMF initiated Assistance Data Delivery
Figure 8.7.3.2.1-1 shows the Assistance Data Delivery operations for the
network-assisted TBS method when the procedure is initiated by the LMF.
Figure 8.7.3.2.1-1: LMF-initiated Assistance Data Delivery Procedure
(1) The LMF determines that assistance data needs to be provided to the UE
(e.g., as part of a positioning procedure) and sends an LPP Provide Assistance
Data message to the UE. This message may include any of the TBS assistance
data defined in clause 8.7.2.1.
##### 8.7.3.2.2 UE initiated Assistance Data Transfer
Figure 8.7.3.2.2-1 shows the Assistance Data Transfer operations for the
network-assisted TBS method when the procedure is initiated by the UE.
Figure 8.7.3.2.2-1: UE-initiated Assistance Data Transfer Procedure
(1) The UE determines that certain TBS assistance data is desired (e.g., when
the LMF provided assistance data are not sufficient for the UE to fulfil the
request) and sends a LPP Request Assistance Data message to the LMF. This
request includes an indication of which specific TBS assistance data is
requested.
(2) The LMF provides the requested assistance data in a LPP Provide Assistance
Data message, if available at the LMF. The entire set of assistance data may
be delivered in one or several LPP messages. In this case, this step may be
repeated by the LMF several times. If any of the UE requested assistance data
in step (1) are not provided in step 2, the UE shall assume that the requested
assistance data are not supported, or currently not available at the LMF. If
none of the UE requested assistance data in step (1) can be provided by the
LMF, return any information that can be provided in an LPP message of type
Provide Assistance Data which includes a cause indication for the not provided
assistance data.
#### 8.7.3.3 Location Information Transfer Procedure
The purpose of this procedure is to enable the LMF to request position
measurements or location estimate from the UE, or to enable the UE to provide
location measurements to the LMF for position calculation.
##### 8.7.3.3.1 LMF initiated Location Information Transfer Procedure
Figure 8.7.3.3.1-1 shows the Location Information Transfer operations for the
TBS method when the procedure is initiated by the LMF.
Figure 8.7.3.3.1-1: LMF-initiated Location Information Transfer Procedure
(1) The LMF sends a LPP Request Location Information message to the UE for
invocation of TBS positioning. This request includes positioning instructions
such as the positioning mode (UE-assisted, UE-based, Standalone), specific
requested UE measurements if any, and quality of service parameters (accuracy,
response time).
(2) The UE performs the requested measurements and possibly calculates its own
location. The UE sends an LPP Provide Location Information message to the LMF
before the Response Time provided in step (1) elapsed. If the UE is unable to
perform the requested measurements, or if the Response Time provided in step 1
elapsed before any of the requested measurements have been obtained, the UE
returns any information that can be provided in an LPP message of type Provide
Location Information which includes a cause indication for the not provided
location information.
##### 8.7.3.3.2 UE-initiated Location Information Delivery Procedure
Figure 8.7.3.3.2-1 shows the Location Information delivery operations for the
TBS method when the procedure is initiated by the UE.
Figure 8.7.3.3.2-1: UE-initiated Location Information Delivery Procedure
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include UE TBS measurements or
location estimate already available at the UE.
## 8.8 Motion sensor positioning method
### 8.8.1 General
Motion sensors can be used to estimate the location of the UE. With the
combination of other positioning methods (hybrid) a more accurate position of
the UE can be computed. UE using one or more motion sensors provides the
movement information. The movement information comprises displacement results
estimated as an ordered series of points.
The positioning modes supported are UE-Assisted, UE-Based, and Standalone _._
### 8.8.2 Information to be transferred between NG-RAN/5GC Elements
#### 8.8.2.1 General
This clause defines the information (e.g., assistance data, position and/or
measurement data) that may be transferred between NG-RAN/5GC elements.
#### 8.8.2.2 Information that may be transferred from the UE to LMF
The information transferred from the UE to the LMF consists of capability
information and location measurements or UE position. The supported
information elements are given in Table 8.8.2.2-1.
Table 8.8.2.2-1: Sensor Measurement Information that may be transferred from
UE to the LMF
+--------------------------+-------------+------------+ | Information | UE‑assisted | UE-based/ | | | | | | | | Standalone | +==========================+=============+============+ | Displacement Timestamp | Yes | Yes | +--------------------------+-------------+------------+ | Displacement Information | Yes | Yes | +--------------------------+-------------+------------+ | Reference Position | Yes | Yes | +--------------------------+-------------+------------+ | Reference Time | Yes | Yes | +--------------------------+-------------+------------+
##### 8.8.2.2.1 UE-assisted, UE-based, Standalone mode
In the _UE-assisted_ , UE-Based, and Standalone mode, the UE reports,
displacement information, displacement timestamp, reference position and
reference time.
##### 8.8.2.2.2 UE Displacement and Movement Information
The UE may report movement and displacement information which comprises an
ordered series of direction, distance travelled by the target device and the
time intervals when these measurements are taken.
#### 8.8.2.3 Information that may be transferred from the LMF to the UE
In this release, no information, e.g. assistance data is transferred to the
UE.
### 8.8.3 Motion Sensors Location Information Transfer Procedure
#### 8.8.3.1 General
The purpose of this procedure is to enable the LMF to request additional
sensor measurements or to enable the UE to provide sensor measurements to the
LMF for position calculation.
#### 8.8.3.2 LMF initiated Location Information Transfer Procedure
Figure 8.8.3.2-1 shows the Location Information Transfer operations when the
procedure is initiated by the LMF.
Figure 8.8.3.2-1: LMF-initiated Location Information Transfer Procedure
(1) The LMF sends a LPP Request Location Information message to the UE for
invocation of motion sensor positioning. This request includes positioning
instructions such as the positioning mode, specific requested UE measurements
if any, and quality of service parameters (accuracy, response time).
(2) The UE performs the requested measurements. The UE sends an LPP Provide
Location Information message to the LMF before the Response Time provided in
step (1) elapsed. If the UE is unable to perform the requested measurements,
or if the Response Time provided in step 1 elapsed before any of the requested
measurements have been obtained, the UE returns any information that can be
provided in an LPP message of type Provide Location Information which includes
a cause indication for the not provided location information.
#### 8.8.3.3 UE-initiated Location Information Delivery Procedure
Figure 8.8.3.3-1 shows the Location Information delivery operations for motion
sensor method when the procedure is initiated by the UE.
Figure 8.8.3.3-1: UE-initiated Location Information Delivery Procedure
(1) The UE sends an LPP Provide Location Information message to the LMF. The
Provide Location Information message may include UE sensor measurements or
location estimate already available at the UE.
###### ## Annex A (informative): Use of LPP with SUPL
The design goal of LPP is to enable it to be used in user plane location
solutions such as OMA SUPL ([15], [16]) and this informative annex shows how
LPP can be used in SUPL 2.0.
# A.1 SUPL 2.0 Positioning Methods and Positioning Protocols
The following table shows how the 3GPP positioning protocols are supported in
SUPL 2.0.
Table A.1-1: SUPL support of positioning methods
+---------------------+-------------------+-----------+-----------+ | Positioning | RRLP | RRC | LPP | | Protocol: | | | | | | (GSM/GPRS/WCDMA/\ | (WCDMA) | (NR/LTE) | | | LTE/WLAN/WiMAX) | | | +=====================+===================+===========+===========+ | Positioning Method: | | | | +---------------------+-------------------+-----------+-----------+ | A-GPS (A-GANSS) SET | | | | | Assisted | | | | +---------------------+-------------------+-----------+-----------+ | A-GPS (A-GANSS) SET | | | | | Based | | | | +---------------------+-------------------+-----------+-----------+ | Autonomous | | | | | GPS/GANSS | | | | +---------------------+-------------------+-----------+-----------+ | Enhanced Cell ID | | | ^NOTE\ 2^ | | ^NOTE\ 1^ | | | | +---------------------+-------------------+-----------+-----------+ | Enhanced Observed | (GSM only) | NA | NA | | Time Difference | | | | | (E-OTD) | | | | +---------------------+-------------------+-----------+-----------+ | Observed Time | NA | | | | Difference of | | | | | Arrival (OTDOA) | | | | | ^NOTE\ 1,\ NOTE\ 3^ | | | | +---------------------+-------------------+-----------+-----------+ | Sensors | NA | ^NOTE\ 5^ | | +---------------------+-------------------+-----------+-----------+ | WLAN | NA | | | +---------------------+-------------------+-----------+-----------+ | Bluetooth | NA | | | +---------------------+-------------------+-----------+-----------+ | TBS ^NOTE\ 4^ | NA | | | +---------------------+-------------------+-----------+-----------+ | NOTE 1: Excludes | | | | | methods based on NR | | | | | signals. | | | | | | | | | | NOTE 2: For LPP, NR | | | | | CID is supported. | | | | | | | | | | NOTE 3: This | | | | | includes TBS | | | | | positioning based | | | | | on PRS signals, | | | | | which is only | | | | | supported in LPP | | | | | (LTE). | | | | | | | | | | NOTE 4: TBS | | | | | positioning based | | | | | on MBS signals. | | | | | | | | | | NOTE 5: Only | | | | | barometric pressure | | | | | sensor is | | | | | supported. | | | | +---------------------+-------------------+-----------+-----------+
NOTE: What is referred to in the SUPL specifications as \"Enhanced Cell ID\",
is a UE-Assisted positioning mode, where the neighbouring cell measurements
are carried at the SUPL layer (in the SUPL_POS_INIT for example) and does not
include methods based on NR signals. The ASN.1 container for this mode is
defined as follows:
LteCellInformation ::= SEQUENCE {
cellGlobalIdEUTRA CellGlobalIdEUTRA,
physCellId PhysCellId,
trackingAreaCode TrackingAreaCode,
rsrpResult RSRP-Range OPTIONAL,
rsrqResult RSRQ-Range OPTIONAL,
ta INTEGER(0..1282) OPTIONAL, -- Currently used Timing Advance value (N_TA/16
as per [3GPP 36.213])
measResultListEUTRA MeasResultListEUTRA OPTIONAL, --Neighbour measurements
...,
earfcn INTEGER(0..65535) OPTIONAL, -- see Table 37
earfcn-ext INTEGER (65536..262143) OPTIONAL, -- see Table 37
rsrpResult-ext RSRP-Range-Ext OPTIONAL,
rsrqResult-ext RSRQ-Range-Ext OPTIONAL,
rs-sinrResult RS-SINR-Range OPTIONAL,
servingInformation5G ServingInformation5G OPTIONAL
}
MeasResultListEUTRA ::= SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultEUTRA
MeasResultEUTRA ::= SEQUENCE {
physCellId PhysCellId,
cgi-Info SEQUENCE {
cellGlobalId CellGlobalIdEUTRA,
trackingAreaCode TrackingAreaCode
} OPTIONAL,
measResult SEQUENCE {
rsrpResult RSRP-Range OPTIONAL, -- Mapping to measured values
rsrqResult RSRQ-Range OPTIONAL, -- in 3GPP TS 36.133
...,
earfcn INTEGER(0..65535) OPTIONAL, -- see Table 37
earfcn-ext INTEGER (65536..262143) OPTIONAL, -- see Table 37
rsrpResult-ext RSRP-Range-Ext OPTIONAL,
rsrqResult-ext RSRQ-Range-Ext OPTIONAL,
rs-sinrResult RS-SINR-Range OPTIONAL,
neighbourInformation5G NeighbourInformation5G OPTIONAL
}
}
The IE \"MeasResultListEUTRA\" mirrors the equivalent IE from the RRC
specification:
MeasResultEUTRA ::= SEQUENCE {
physCellId PhysCellId,
cgi-Info SEQUENCE {
cellGlobalId CellGlobalIdEUTRA,
trackingAreaCode TrackingAreaCode,
plmn-IdentityList PLMN-IdentityList2 OPTIONAL
} OPTIONAL,
measResult SEQUENCE {
rsrpResult RSRP-Range OPTIONAL,
rsrqResult RSRQ-Range OPTIONAL,
...,
[[ additionalSI-Info-r9 AdditionalSI-Info-r9 OPTIONAL
]],
[[ primaryPLMN-Suitable-r12 ENUMERATED {true} OPTIONAL,
measResult-v1250 RSRQ-Range-v1250 OPTIONAL
]],
[[ rs-sinr-Result-r13 RS-SINR-Range-r13 OPTIONAL,
cgi-Info-v1310 SEQUENCE {
freqBandIndicator-r13 FreqBandIndicator-r11 OPTIONAL,
multiBandInfoList-r13 MultiBandInfoList-r11 OPTIONAL,
freqBandIndicatorPriority-r13 ENUMERATED {true} OPTIONAL
} OPTIONAL
]],
[[
measResult-v1360 RSRP-Range-v1360 OPTIONAL
]],
[[
cgi-Info-5GC-r15 SEQUENCE (SIZE (1..maxPLMN-r11)) OF
CellAccessRelatedInfo-5GC-r15 OPTIONAL
]]
}
}
It should be noted that in addition to the container provided by SUPL itself,
E-CID positioning methods (excludes E-CID and CID for NR signals) defined
within LPP proper can be supported in SUPL, via tunneling LPP as shown in this
annex (in the same manner that A-GNSS, OTDOA, Barometric Pressure Sensors,
WLAN, Bluetooth and TBS are supported).
# A.2 SUPL 2.0 and NR Architecture
This clause describes interworking between the control-plane LCS architecture,
as defined in the main body of this specification, and SUPL 2.0. Similarly, to
the E-SMLC in the LTE architecture (TS 36.305 [25]), the LMF either includes
or has an interface to an SPC function, as defined in OMA SUPL V2.0 ([15],
[16]). It can thus provide a consistent set of positioning methods for
deployments utilizing both control-plane and user-plane.
The interworking does not enable use of user-plane signalling for part of a
control-plane positioning session. The user plane in the interworking here is
not intended as an alternative path for control-plane signalling that would be
needed between UE and NG-RAN for mechanisms such as A-GPS in a standalone
control-plane solution.
This interworking does enable the SPC to retrieve measurements (e.g., GNSS-to-
RAN time relations) from the NG-RAN.
The underlying architecture is shown in Figure A.2-1 (TS 23.501 [2]). Note
that, for interworking between user-plane and control-plane positioning, no
new interfaces need to be defined as compared to those in the figure, assuming
the SPC is either integrated in the LMF or attached to it with a proprietary
interface.
Figure A.2-1: System reference architecture reference for Location Services in
reference point representation
The Lup and Llp interfaces shown in this architecture are part of the user-
plane solution only and are not required for control-plane positioning.
# A.3 LPP session procedures using SUPL
This clause indicates how an LPP session relates to the SUPL message set.
Figure A.3-1 shows how SUPL and LPP can be combined within a SUPL positioning
session. Step 4 here is repeated to exchange multiple LPP messages between the
SLP and SET.
Figure A.3-1: LPP session over SUPL
For positioning operations which take place entirely within an LPP session
(step 4 in Figure A.3-1), the flow of LPP messages can be the same as in the
control-plane version of LPP; the role of the (LPP) target is taken by the
target SET, and that of the (LPP) server by the SLP. An example LPP flow,
including exchange of capabilities, request and delivery of assistance data,
and request and delivery of positioning information, is shown in Figure A.3-2.
Figure A.3-2: LPP session over SUPL
# A.4 Procedures combining C-plane and U-plane operations
Since SUPL by definition is carried over the user plane, it is not applicable
to operations terminating at the NG-RAN. SUPL operations must take place in
combination with control-plane procedures over NRPPa.
This situation could arise in the case of UE-assisted OTDOA, for example, in
which the SLP needs to provide the UE (in a SUPL session) with assistance data
supplied by the NG-RAN. This clause uses a UE-assisted OTDOA positioning
operation as an example.
Although the positioning server in this operation is the SLP, the existence of
an interface to the LMF means that the SLP can communicate with the LMF via
the SPC. In particular, this means that assistance data that was delivered to
the LMF via NRPPa can be transferred over to the SLP for delivery to the UE
via LPP over SUPL.
There are several ways to realise this general behaviour. In the simplest
case, the LMF could be supplied with the necessary assistance data in advance,
so that it can be supplied to the SLP without any actual NRPPa procedures
taking place in real time (and possibly even before the positioning
transaction begins).
Figure A.4-1: Transfer of OTDOA assistance data to UE via SUPL
In the event that the LMF does not have the required assistance data
available, it would need to retrieve them from the NG-RAN once it was made
aware that they were needed.
Figure A.4-2: Transfer to the UE via SUPL of OTDOA assistance data not already
available at the LMF
In both cases, it should be noted that the retrieval of the assistance data is
transparent to the UE and to the actual SUPL session. This model is parallel
to the approach used with A-GNSS, in which assistance data such as satellite
ephemerides are retrieved from sources entirely external to the cellular
network. For purposes of LPP over SUPL, the delivery of assistance data to the
SLP can be viewed as an independent external process.
The delivery of assistance data to the UE, however, takes place through the
same mechanisms as control-plane LPP, transported through SUPL.
#