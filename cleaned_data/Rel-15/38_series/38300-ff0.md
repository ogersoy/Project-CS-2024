# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides an overview and overall description of the NG-
RAN and focuses on the radio interface protocol architecture of NR connected
to 5GC (E-UTRA connected to 5GC is covered in the 36 series). Details of the
radio interface protocols are specified in companion specifications of the 38
series.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall
description; Stage 2\".
[3] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[4] 3GPP TS 38.401: \"NG-RAN; Architecture description\".
[5] 3GPP TS 33.501: \"Security Architecture and Procedures for 5G System\".
[6] 3GPP TS 38.321: \"NR; Medium Access Control (MAC) protocol
specification\".
[7] 3GPP TS 38.322: \"NR; Radio Link Control (RLC) protocol specification\".
[8] 3GPP TS 38.323: \"NR; Packet Data Convergence Protocol (PDCP)
specification\".
[9] 3GPP TS 37.324: \" E-UTRA and NR; Service Data Protocol (SDAP)
specification\".
[10] 3GPP TS 38.304: \"NR; User Equipment (UE) procedures in Idle mode and RRC
Inactive state\".
[11] 3GPP TS 38.306: \"NR; User Equipment (UE) radio access capabilities\".
[12] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC); Protocol
specification\".
[13] 3GPP TS 38.133: \"NR; Requirements for support of radio resource
management\".
[14] 3GPP TS 22.168: \"Earthquake and Tsunami Warning System (ETWS)
requirements; Stage 1\".
[15] 3GPP TS 22.268: \"Public Warning System (PWS) Requirements\".
[16] 3GPP TS 38.410: \"NG-RAN; NG general aspects and principles\".
[17] 3GPP TS 38.420: \"NG-RAN; Xn general aspects and principles\".
[18] 3GPP TS 38.101-1: \"NR; User Equipment (UE) radio transmission and
reception; Part 1: Range 1 Standalone\".
[19] 3GPP TS 22.261: \"Service requirements for next generation new services
and markets\".
[20] 3GPP TS 38.202: \"NR; Physical layer services provided by the physical
layer\"
[21] 3GPP TS 37.340: \"NR; Multi-connectivity; Overall description; Stage-2\".
[22] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[23] IETF RFC 4960 (2007-09): \"Stream Control Transmission Protocol\".
[24] 3GPP TS 26.114: \"Technical Specification Group Services and System
Aspects; IP Multimedia Subsystem (IMS); Multimedia Telephony; Media handling
and interaction\".
[25] Void.
[26] 3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".
[27] IETF RFC 3168 (09/2001): \"The Addition of Explicit Congestion
Notification (ECN) to IP\".
[28] 3GPP TS 24.501: \"NR; Non-Access-Stratum (NAS) protocol for 5G System
(5GS)\".
[29] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
[30] 3GPP TS 38.415: \"NG-RAN; PDU Session User Plane Protocol\".
# 3 Abbreviations and Definitions
## 3.1 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], in TS 36.300 [2] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in TR 21.905 [1] and TS 36.300 [2].
5GC 5G Core Network
5QI 5G QoS Identifier
A-CSI Aperiodic CSI
AKA Authentication and Key Agreement
AMBR Aggregate Maximum Bit Rate
AMC Adaptive Modulation and Coding
AMF Access and Mobility Management Function
ARP Allocation and Retention Priority
BA Bandwidth Adaptation
BCH Broadcast Channel
BPSK Binary Phase Shift Keying
C-RNTI Cell RNTI
CBRA Contention Based Random Access
CCE Control Channel Element
CD-SSB Cell Defining SSB
CFRA Contention Free Random Access
CMAS Commercial Mobile Alert Service
CORESET Control Resource Set
DFT Discrete Fourier Transform
DCI Downlink Control Information
DL-SCH Downlink Shared Channel
DMRS Demodulation Reference Signal
DRX Discontinuous Reception
ETWS Earthquake and Tsunami Warning System
FS Feature Set
GFBR Guaranteed Flow Bit Rate
I-RNTI Inactive RNTI
INT-RNTI Interruption RNTI
KPAS Korean Public Alarm System
LDPC Low Density Parity Check
MDBV Maximum Data Burst Volume
MIB Master Information Block
MICO Mobile Initiated Connection Only
MFBR Maximum Flow Bit Rate
MMTEL Multimedia telephony
MNO Mobile Network Operator
MU-MIMO Multi User MIMO
NCGI NR Cell Global Identifier
NCR Neighbour Cell Relation
NCRT Neighbour Cell Relation Table
NGAP NG Application Protocol
NR NR Radio Access
P-RNTI Paging RNTI
PCH Paging Channel
PCI Physical Cell Identifier
PDCCH Physical Downlink Control Channel
PDSCH Physical Downlink Shared Channel
PO Paging Occasion
PRACH Physical Random Access Channel
PRB Physical Resource Block
PRG Precoding Resource block Group
PSS Primary Synchronisation Signal
PUCCH Physical Uplink Control Channel
PUSCH Physical Uplink Shared Channel
PWS Public Warning System
QAM Quadrature Amplitude Modulation
QFI QoS Flow ID
QPSK Quadrature Phase Shift Keying
RA-RNTI Random Access RNTI
RACH Random Access Channel
RANAC RAN-based Notification Area Code
REG Resource Element Group
RMSI Remaining Minimum SI
RNA RAN-based Notification Area
RNAU RAN-based Notification Area Update
RNTI Radio Network Temporary Identifier
RQA Reflective QoS Attribute
RQoS Reflective Quality of Service
RS Reference Signal
RSRP Reference Signal Received Power
RSRQ Reference Signal Received Quality
SD Slice Differentiator
SDAP Service Data Adaptation Protocol
SFI-RNTI Slot Format Indication RNTI
SIB System Information Block
SI-RNTI System Information RNTI
SLA Service Level Agreement
SMC Security Mode Command
SMF Session Management Function
S-NSSAI Single Network Slice Selection Assistance Information
SPS Semi-Persistent Scheduling
SR Scheduling Request
SRS Sounding Reference Signal
SS Synchronization Signal
SSB SS/PBCH block
SSS Secondary Synchronisation Signal
SST Slice/Service Type
SU-MIMO Single User MIMO
SUL Supplementary Uplink
TA Timing Advance
TPC Transmit Power Control
UCI Uplink Control Information
UL-SCH Uplink Shared Channel
UPF User Plane Function
URLLC Ultra-Reliable and Low Latency Communications
Xn-C Xn-Control plane
Xn-U Xn-User plane
XnAP Xn Application Protocol
## 3.2 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1], in TS 36.300 [2] and the following apply. A term defined in the
present document takes precedence over the definition of the same term, if
any, in TR 21.905 [1] and TS 36.300 [2].
**Cell-Defining SSB:** an SSB with an RMSI associated.
**CORESET#0** : the control resource set for at least SIB1 scheduling, can be
configured either via MIB or via dedicated RRC signalling.
**gNB** : node providing NR user plane and control plane protocol terminations
towards the UE, and connected via the NG interface to the 5GC.
**Intra-system Handover:** Handover that does not involve a CN change (EPC or
5GC).
**Inter-system Handover:** Handover that involves a CN change (EPC or 5GC).
**MSG1** : preamble transmission of the random access procedure.
**MSG3** : first scheduled transmission of the random access procedure.
**ng-eNB** : node providing E-UTRA user plane and control plane protocol
terminations towards the UE, and connected via the NG interface to the 5GC.
**NG-C** : control plane interface between NG-RAN and 5GC.
**NG-U** : user plane interface between NG-RAN and 5GC.
**NG-RAN node** : either a gNB or an ng-eNB.
**Numerology** : corresponds to one subcarrier spacing in the frequency
domain. By scaling a reference subcarrier spacing by an integer _N_ ,
different numerologies can be defined.
**Xn:** network interface between NG-RAN nodes.
# 4 Overall Architecture and Functional Split
## 4.1 Overall Architecture
An NG-RAN node is either:
\- a gNB, providing NR user plane and control plane protocol terminations
towards the UE; or
\- an ng-eNB, providing E-UTRA user plane and control plane protocol
terminations towards the UE.
The gNBs and ng-eNBs are interconnected with each other by means of the Xn
interface. The gNBs and ng-eNBs are also connected by means of the NG
interfaces to the 5GC, more specifically to the AMF (Access and Mobility
Management Function) by means of the NG-C interface and to the UPF (User Plane
Function) by means of the NG-U interface (see TS 23.501 [3]).
NOTE: The architecture and the F1 interface for a functional split are defined
in TS 38.401 [4].
The NG-RAN architecture is illustrated in Figure 4.1-1 below.
Figure 4.1-1: Overall Architecture
## 4.2 Functional Split
The **gNB** and ng-eNB host the following functions:
\- Functions for Radio Resource Management: Radio Bearer Control, Radio
Admission Control, Connection Mobility Control, Dynamic allocation of
resources to UEs in both uplink and downlink (scheduling);
\- IP header compression, encryption and integrity protection of data;
\- Selection of an AMF at UE attachment when no routing to an AMF can be
determined from the information provided by the UE;
\- Routing of User Plane data towards UPF(s);
\- Routing of Control Plane information towards AMF;
\- Connection setup and release;
\- Scheduling and transmission of paging messages;
\- Scheduling and transmission of system broadcast information (originated
from the AMF or OAM);
\- Measurement and measurement reporting configuration for mobility and
scheduling;
\- Transport level packet marking in the uplink;
\- Session Management;
\- Support of Network Slicing;
\- QoS Flow management and mapping to data radio bearers;
\- Support of UEs in RRC_INACTIVE state;
\- Distribution function for NAS messages;
\- Radio access network sharing;
\- Dual Connectivity;
\- Tight interworking between NR and E-UTRA.
The **AMF** hosts the following main functions (see TS 23.501 [3]):
\- NAS signalling termination;
\- NAS signalling security;
\- AS Security control;
\- Inter CN node signalling for mobility between 3GPP access networks;
\- Idle mode UE Reachability (including control and execution of paging
retransmission);
\- Registration Area management;
\- Support of intra-system and inter-system mobility;
\- Access Authentication;
\- Access Authorization including check of roaming rights;
\- Mobility management control (subscription and policies);
\- Support of Network Slicing;
\- SMF selection.
The **UPF** hosts the following main functions (see TS 23.501 [3]):
\- Anchor point for Intra-/Inter-RAT mobility (when applicable);
\- External PDU session point of interconnect to Data Network;
\- Packet routing & forwarding;
\- Packet inspection and User plane part of Policy rule enforcement;
\- Traffic usage reporting;
\- Uplink classifier to support routing traffic flows to a data network;
\- Branching point to support multi-homed PDU session;
\- QoS handling for user plane, e.g. packet filtering, gating, UL/DL rate
enforcement;
\- Uplink Traffic verification (SDF to QoS flow mapping);
\- Downlink packet buffering and downlink data notification triggering.
The Session Management function (**SMF**) hosts the following main functions
(see TS 23.501 [3]):
\- Session Management;
\- UE IP address allocation and management;
\- Selection and control of UP function;
\- Configures traffic steering at UPF to route traffic to proper destination;
\- Control part of policy enforcement and QoS;
\- Downlink Data Notification.
This is summarized on the figure below where yellow boxes depict the logical
nodes and white boxes depict the main functions.
Figure 4.2-1: Functional Split between NG-RAN and 5GC
## 4.3 Network Interfaces
### 4.3.1 NG Interface
#### 4.3.1.1 NG User Plane
The NG user plane interface (NG-U) is defined between the NG-RAN node and the
UPF. The user plane protocol stack of the NG interface is shown on Figure
4.3.1.1-1. The transport network layer is built on IP transport and GTP-U is
used on top of UDP/IP to carry the user plane PDUs between the NG-RAN node and
the UPF.
Figure 4.3.1.1-1: NG-U Protocol Stack
NG-U provides non-guaranteed delivery of user plane PDUs between the NG-RAN
node and the UPF.
Further details of NG-U can be found in TS 38.410 [16].
#### 4.3.1.2 NG Control Plane
The NG control plane interface (NG-C) is defined between the NG-RAN node and
the AMF. The control plane protocol stack of the NG interface is shown on
Figure 4.3.1.2-1. The transport network layer is built on IP transport. For
the reliable transport of signalling messages, SCTP is added on top of IP. The
application layer signalling protocol is referred to as NGAP (NG Application
Protocol). The SCTP layer provides guaranteed delivery of application layer
messages. In the transport, IP layer point-to-point transmission is used to
deliver the signalling PDUs.
Figure 4.3.1.2-1: NG-C Protocol Stack
NG-C provides the following functions:
\- NG interface management;
\- UE context management;
\- UE mobility management;
\- Transport of NAS messages;
\- Paging;
\- PDU Session Management;
\- Configuration Transfer;
\- Warning Message Transmission.
Further details of NG-C can be found in TS 38.410 [16].
### 4.3.2 Xn Interface
#### 4.3.2.1 Xn User Plane
The Xn User plane (Xn-U) interface is defined between two NG-RAN nodes. The
user plane protocol stack on the Xn interface is shown in Figure 4.3.2.1-1.
The transport network layer is built on IP transport and GTP-U is used on top
of UDP/IP to carry the user plane PDUs.
Figure 4.3.2.1-1: Xn-U Protocol Stack
Xn-U provides non-guaranteed delivery of user plane PDUs and supports the
following functions:
\- Data forwarding;
\- Flow control.
Further details of Xn-U can be found in TS 38.420 [17].
#### 4.3.2.2 Xn Control Plane
The Xn control plane interface (Xn-C) is defined between two NG-RAN nodes. The
control plane protocol stack of the Xn interface is shown on Figure 4.3.2.2-1.
The transport network layer is built on SCTP on top of IP. The application
layer signalling protocol is referred to as XnAP (Xn Application Protocol).
The SCTP layer provides the guaranteed delivery of application layer messages.
In the transport IP layer point-to-point transmission is used to deliver the
signalling PDUs.
Figure 4.3.2.2-1: Xn-C Protocol Stack
The Xn-C interface supports the following functions:
\- Xn interface management;
\- UE mobility management, including context transfer and RAN paging;
\- Dual connectivity.
Further details of Xn-C can be found in TS 38.420 [17].
## 4.4 Radio Protocol Architecture
### 4.4.1 User Plane
The figure below shows the protocol stack for the user plane, where SDAP,
PDCP, RLC and MAC sublayers (terminated in gNB on the network side) perform
the functions listed in clause 6.
Figure 4.4.1-1: User Plane Protocol Stack
### 4.4.2 Control Plane
The figure below shows the protocol stack for the control plane, where:
\- PDCP, RLC and MAC sublayers (terminated in gNB on the network side) perform
the functions listed in clause 6;
\- RRC (terminated in gNB on the network side) performs the functions listed
in clause 7;
\- NAS control protocol (terminated in AMF on the network side) performs the
functions listed in TS 23.501 [3]), for instance: authentication, mobility
management, security control...
Figure 4.4.2-1: Control Plane Protocol Stack
## 4.5 Multi-Radio Dual Connectivity
NG-RAN supports Multi-Radio Dual Connectivity (MR-DC) operation whereby a UE
in RRC_CONNECTED is configured to utilise radio resources provided by two
distinct schedulers, located in two different NG-RAN nodes connected via a
non-ideal backhaul, one providing NR access and the other one providing either
E-UTRA or NR access. Further details of MR-DC operation can be found in TS
37.340 [21].
## 4.6 Radio Access Network Sharing
NG-RAN supports radio access network sharing as defined in TS 23.501 [3].
If NR access is shared, system information broadcast in a shared cell
indicates a TAC and a Cell Identity for each subset of PLMNs (up to 12). NR
access provides only one TAC and one Cell Identity per cell per PLMN.
Each Cell Identity associated with a subset of PLMNs identifies its serving
NG-RAN node.
# 5 Physical Layer
## 5.1 Waveform, numerology and frame structure
The downlink transmission waveform is conventional OFDM using a cyclic prefix.
The uplink transmission waveform is conventional OFDM using a cyclic prefix
with a transform precoding function performing DFT spreading that can be
disabled or enabled.
Figure 5.1-1: Transmitter block diagram for CP-OFDM with optional DFT-
spreading
The numerology is based on exponentially scalable sub-carrier spacing _âˆ†f_ = 2
_^Âµ^_ Ã— 15 kHz with _Âµ_ ={0,1,3,4} for PSS, SSS and PBCH and _Âµ_ ={0,1,2,3}
for other channels. Normal CP is supported for all sub-carrier spacings,
Extended CP is supported for _Âµ_ =2. 12 consecutive sub-carriers form a
Physical Resource Block (PRB). Up to 275 PRBs are supported on a carrier.
Table 5.1-1: Supported transmission numerologies.
Cyclic prefix Supported for data Supported for synch
* * *
0 15 Normal Yes Yes 1 30 Normal Yes Yes 2 60 Normal, Extended Yes No 3 120
Normal Yes Yes 4 240 Normal No Yes
The UE may be configured with one or more bandwidth parts on a given component
carrier, of which only one can be active at a time, as described in clauses
7.8 and 6.10 respectively. The active bandwidth part defines the UE\'s
operating bandwidth within the cell\'s operating bandwidth. For initial
access, and until the UE\'s configuration in a cell is received, initial
bandwidth part detected from system information is used.
Downlink and uplink transmissions are organized into frames with 10 ms
duration, consisting of ten 1 ms subframes. Each frame is divided into two
equally-sized half-frames of five subframes each. The slot duration is 14
symbols with Normal CP and 12 symbols with Extended CP, and scales in time as
a function of the used sub-carrier spacing so that there is always an integer
number of slots in a subframe.
Timing Advance _TA_ is used to adjust the uplink frame timing relative to the
downlink frame timing.
Figure 5.1-2: Uplink-downlink timing relation
Operation on both paired and unpaired spectrum is supported.
## 5.2 Downlink
### 5.2.1 Downlink transmission scheme
A closed loop Demodulation Reference Signal (DMRS) based spatial multiplexing
is supported for Physical Downlink Shared Channel (PDSCH). Up to 8 and 12
orthogonal DL DMRS ports are supported for type 1 and type 2 DMRS
respectively. Up to 8 orthogonal DL DMRS ports per UE are supported for SU-
MIMO and up to 4 orthogonal DL DMRS ports per UE are supported for MU-MIMO.
The number of SU-MIMO code words is one for 1-4 layer transmissions and two
for 5-8 layer transmissions.
The DMRS and corresponding PDSCH are transmitted using the same precoding
matrix and the UE does not need to know the precoding matrix to demodulate the
transmission. The transmitter may use different precoder matrix for different
parts of the transmission bandwidth, resulting in frequency selective
precoding. The UE may also assume that the same precoding matrix is used
across a set of Physical Resource Blocks (PRBs) denoted Precoding Resource
Block Group (PRG).
Transmission durations from 2 to 14 symbols in a slot is supported.
Aggregation of multiple slots with Transport Block (TB) repetition is
supported.
### 5.2.2 Physical-layer processing for physical downlink shared channel
The downlink physical-layer processing of transport channels consists of the
following steps:
\- Transport block CRC attachment;
\- Code block segmentation and code block CRC attachment;
\- Channel coding: LDPC coding;
\- Physical-layer hybrid-ARQ processing;
\- Rate matching;
\- Scrambling;
\- Modulation: QPSK, 16QAM, 64QAM and 256QAM;
\- Layer mapping;
\- Mapping to assigned resources and antenna ports.
The UE may assume that at least one symbol with demodulation reference signal
is present on each layer in which PDSCH is transmitted to a UE, and up to 3
additional DMRS can be configured by higher layers.
Phase Tracking RS may be transmitted on additional symbols to aid receiver
phase tracking.
The DL-SCH physical layer model is described in TS 38.202 [20].
### 5.2.3 Physical downlink control channels
The Physical Downlink Control Channel (PDCCH) can be used to schedule DL
transmissions on PDSCH and UL transmissions on PUSCH, where the Downlink
Control Information (DCI) on PDCCH includes:
\- Downlink assignments containing at least modulation and coding format,
resource allocation, and hybrid-ARQ information related to DL-SCH;
\- Uplink scheduling grants containing at least modulation and coding format,
resource allocation, and hybrid-ARQ information related to UL-SCH.
In addition to scheduling, PDCCH can be used to for
\- Activation and deactivation of configured PUSCH transmission with
configured grant;
\- Activation and deactivation of PDSCH semi-persistent transmission;
\- Notifying one or more UEs of the slot format;
\- Notifying one or more UEs of the PRB(s) and OFDM symbol(s) where the UE may
assume no transmission is intended for the UE;
\- Transmission of TPC commands for PUCCH and PUSCH;
\- Transmission of one or more TPC commands for SRS transmissions by one or
more UEs;
\- Switching a UE\'s active bandwidth part;
\- Initiating a random access procedure.
A UE monitors a set of PDCCH candidates in the configured monitoring occasions
in one or more configured COntrol REsource SETs (CORESETs) according to the
corresponding search space configurations.
A CORESET consists of a set of PRBs with a time duration of 1 to 3 OFDM
symbols. The resource units Resource Element Groups (REGs) and Control Channel
Elements (CCEs) are defined within a CORESET with each CCE consisting a set of
REGs. Control channels are formed by aggregation of CCE. Different code rates
for the control channels are realized by aggregating different number of CCE.
Interleaved and non-interleaved CCE-to-REG mapping are supported in a CORESET.
Polar coding is used for PDCCH.
Each resource element group carrying PDCCH carries its own DMRS.
QPSK modulation is used for PDCCH.
### 5.2.4 Synchronization signal and PBCH block
The Synchronization Signal and PBCH block (SSB) consists of primary and
secondary synchronization signals (PSS, SSS), each occupying 1 symbol and 127
subcarriers, and PBCH spanning across 3 OFDM symbols and 240 subcarriers, but
on one symbol leaving an unused part in the middle for SSS as show in Figure
5.2.4-1. The possible time locations of SSBs within a half-frame are
determined by sub-carrier spacing and the periodicity of the half-frames where
SSBs are transmitted is configured by the network. During a half-frame,
different SSBs may be transmitted in different spatial directions (i.e. using
different beams, spanning the coverage area of a cell).
Within the frequency span of a carrier, multiple SSBs can be transmitted. The
PCIs of SSBs transmitted in different frequency locations do not have to be
unique, i.e. different SSBs in the frequency domain can have different PCIs.
However, when an SSB is associated with an RMSI, the SSB corresponds to an
individual cell, which has a unique NCGI (see clause 8.2). Such an SSB is
referred to as a Cell-Defining SSB (CD-SSB). A PCell is always associated to a
CD-SSB located on the synchronization raster.
Figure 5.2.4-1: Time-frequency structure of SSB
Polar coding is used for PBCH.
The UE may assume a band-specific sub-carrier spacing for the SSB unless a
network has configured the UE to assume a different sub-carrier spacing.
PBCH symbols carry its own frequency-multiplexed DMRS.
QPSK modulation is used for PBCH.
The PBCH physical layer model is described in TS 38.202 [20].
### 5.2.5 Physical layer procedures
#### 5.2.5.1 Link adaptation
Link adaptation (AMC: adaptive modulation and coding) with various modulation
schemes and channel coding rates is applied to the PDSCH. The same coding and
modulation is applied to all groups of resource blocks belonging to the same
L2 PDU scheduled to one user within one transmission duration and within a
MIMO codeword.
For channel state estimation purposes, the UE may be configured to measure
CSI-RS and estimate the downlink channel state based on the CSI-RS
measurements. The UE feeds the estimated channel state back to the gNB to be
used in link adaptation.
#### 5.2.5.2 Power Control
Downlink power control can be used.
#### 5.2.5.3 Cell search
Cell search is the procedure by which a UE acquires time and frequency
synchronization with a cell and detects the Cell ID of that cell. NR cell
search is based on the primary and secondary synchronization signals, and PBCH
DMRS, located on the synchronization raster.
#### 5.2.5.4 HARQ
Asynchronous Incremental Redundancy Hybrid ARQ is supported. The gNB provides
the UE with the HARQ-ACK feedback timing either dynamically in the DCI or
semi-statically in an RRC configuration.
The UE may be configured to receive code block group based transmissions where
retransmissions may be scheduled to carry a sub-set of all the code blocks of
a TB.
#### 5.2.5.5 Reception of SIB1
The Master Information Block (MIB) on PBCH provides the UE with parameters
(e.g. CORESET#0 configuration) for monitoring of PDCCH for scheduling PDSCH
that carries the System Information Block 1 (SIB1). PBCH may also indicate
that there is no associated SIB1, in which case the UE may be pointed to
another frequency from where to search for an SSB that is associated with a
SIB1 as well as a frequency range where the UE may assume no SSB associated
with SIB1 is present. The indicated frequency range is confined within a
contiguous spectrum allocation of the same operator in which SSB is detected.
## 5.3 Uplink
### 5.3.1 Uplink transmission scheme
Two transmission schemes are supported for PUSCH: codebook based transmission
and non-codebook based transmission.
For codebook based transmission, the gNB provides the UE with a transmit
precoding matrix indication in the DCI. The UE uses the indication to select
the PUSCH transmit precoder from the codebook. For non-codebook based
transmission, the UE determines its PUSCH precoder based on wideband SRI field
from the DCI.
A closed loop DMRS based spatial multiplexing is supported for PUSCH. For a
given UE, up to 4 layer transmissions are supported. The number of code words
is one. When transform precoding is used, only a single MIMO layer
transmission is supported.
Transmission durations from 1 to 14 symbols in a slot is supported.
Aggregation of multiple slots with TB repetition is supported.
Two types of frequency hopping are supported, intra-slot frequency hopping,
and in case of slot aggregation, inter-slot frequency hopping.
PUSCH may be scheduled with DCI on PDCCH, or a semi-static configured grant
may be provided over RRC, where two types of operation are supported:
\- The first PUSCH is triggered with a DCI, with subsequent PUSCH
transmissions following the RRC configuration and scheduling received on the
DCI, or
\- The PUSCH is triggered by data arrival to the UE\'s transmit buffer and the
PUSCH transmissions follow the RRC configuration.
### 5.3.2 Physical-layer processing for physical uplink shared channel
The uplink physical-layer processing of transport channels consists of the
following steps:
\- Transport Block CRC attachment;
\- Code block segmentation and Code Block CRC attachment;
\- Channel coding: LDPC coding;
\- Physical-layer hybrid-ARQ processing;
\- Rate matching;
\- Scrambling;
\- Modulation: Ï€/2 BPSK (with transform precoding only), QPSK, 16QAM, 64QAM
and 256QAM;
\- Layer mapping, transform precoding (enabled/disabled by configuration), and
pre-coding;
\- Mapping to assigned resources and antenna ports.
The UE transmits at least one symbol with demodulation reference signal on
each layer on each frequency hop in which the PUSCH is transmitted, and up to
3 additional DMRS can be configured by higher layers.
Phase Tracking RS may be transmitted on additional symbols to aid receiver
phase tracking.
The UL-SCH physical layer model is described in TS 38.202 [20].
### 5.3.3 Physical uplink control channel
Physical uplink control channel (PUCCH) carries the Uplink Control Information
(UCI) from the UE to the gNB. Five formats of PUCCH exist, depending on the
duration of PUCCH and the UCI payload size.
\- Format #0: Short PUCCH of 1 or 2 symbols with small UCI payloads of up to
two bits with UE multiplexing capacity of up to 6 UEs with 1-bit payload in
the same PRB;
\- Format #1: Long PUCCH of 4-14 symbols with small UCI payloads of up to two
bits with UE multiplexing capacity of up to 84 UEs without frequency hopping
and 36 UEs with frequency hopping in the same PRB;
\- Format #2: Short PUCCH of 1 or 2 symbols with large UCI payloads of more
than two bits with no UE multiplexing capability in the same PRBs;
\- Format #3: Long PUCCH of 4-14 symbols with large UCI payloads with no UE
multiplexing capability in the same PRBs;
\- Format #4: Long PUCCH of 4-14 symbols with moderate UCI payloads with
multiplexing capacity of up to 4 UEs in the same PRBs.
The short PUCCH format of up to two UCI bits is based on sequence selection,
while the short PUCCH format of more than two UCI bits frequency multiplexes
UCI and DMRS. The long PUCCH formats time-multiplex the UCI and DMRS.
Frequency hopping is supported for long PUCCH formats and for short PUCCH
formats of duration of 2 symbols. Long PUCCH formats can be repeated over
multiple slots.
UCI multiplexing in PUSCH is supported when UCI and PUSCH transmissions
coincide in time, either due to transmission of a UL-SCH transport block or
due to triggering of A-CSI transmission without UL-SCH transport block:
\- UCI carrying HARQ-ACK feedback with 1 or 2 bits is multiplexed by
puncturing PUSCH;
\- In all other cases UCI is multiplexed by rate matching PUSCH.
UCI consists of the following information:
\- CSI;
\- ACK/NAK;
\- Scheduling request.
QPSK and Ï€/2 BPSK modulation can be used for long PUCCH with more than 2 bits
of information, QPSK is used for short PUCCH with more than 2 bits of
information and BPSK and QPSK modulation can be used for long PUCCH with up to
2 information bits.
Transform precoding is applied to PUCCH Format #3 and Format #4.
Channel coding used for uplink control information is described in table
5.3.3-1.
Table 5.3.3-1: Channel coding for uplink control information
Uplink Control Information size including CRC, if present Channel code
* * *
1 Repetition code 2 Simplex code 3-11 Reed Muller code >11 Polar code
### 5.3.4 Random access
Random access preamble sequences, of two different lengths are supported. Long
sequence length 839 is applied with subcarrier spacings of 1.25 and 5 kHz and
short sequence length 139 is applied with subcarrier spacings of 15, 30, 60
and 120 kHz. Long sequences support unrestricted sets and restricted sets of
Type A and Type B, while short sequences support unrestricted sets only.
Multiple PRACH preamble formats are defined with one or more PRACH OFDM
symbols, and different cyclic prefix and guard time. The PRACH preamble
configuration to use is provided to the UE in the system information.
The UE calculates the PRACH transmit power for the retransmission of the
preamble based on the most recent estimate pathloss and power ramping counter.
The system information provides information for the UE to determine the
association between the SSB and the RACH resources. The RSRP threshold for SSB
selection for RACH resource association is configurable by network.
### 5.3.5 Physical layer procedures
#### 5.3.5.1 Link adaptation
Four types of link adaptation are supported as follows:
\- Adaptive transmission bandwidth;
\- Adaptive transmission duration;
\- Transmission power control;
\- Adaptive modulation and channel coding rate.
For channel state estimation purposes, the UE may be configured to transmit
SRS that the gNB may use to estimate the uplink channel state and use the
estimate in link adaptation.
#### 5.3.5.2 Uplink Power control
The gNB determines the desired uplink transmit power and provides uplink
transmit power control commands to the UE. The UE uses the provided uplink
transmit power control commands to adjust its transmit power.
#### 5.3.5.3 Uplink timing control
The gNB determines the desired Timing Advance setting and provides that to the
UE. The UE uses the provided TA to determine its uplink transmit timing
relative to the UE\'s observed downlink receive timing.
#### 5.3.5.4 HARQ
Asynchronous Incremental Redundancy Hybrid ARQ is supported. The gNB schedules
each uplink transmission and retransmission using the uplink grant on DCI.
The UE may be configured to transmit code block group based transmissions
where retransmissions may be scheduled to carry a sub-set of all the code
blocks of a transport block.
## 5.4 Carrier aggregation
### 5.4.1 Carrier aggregation
In Carrier Aggregation (CA), two or more Component Carriers (CCs) are
aggregated. A UE may simultaneously receive or transmit on one or multiple CCs
depending on its capabilities:
\- A UE with single timing advance capability for CA can simultaneously
receive and/or transmit on multiple CCs corresponding to multiple serving
cells sharing the same timing advance (multiple serving cells grouped in one
TAG);
\- A UE with multiple timing advance capability for CA can simultaneously
receive and/or transmit on multiple CCs corresponding to multiple serving
cells with different timing advances (multiple serving cells grouped in
multiple TAGs). NG-RAN ensures that each TAG contains at least one serving
cell;
\- A non-CA capable UE can receive on a single CC and transmit on a single CC
corresponding to one serving cell only (one serving cell in one TAG).
CA is supported for both contiguous and non-contiguous CCs. When CA is
deployed frame timing and SFN are aligned across cells that can be aggregated.
The maximum number of configured CCs for a UE is 16 for DL and 16 for UL.
### 5.4.2 Supplementary Uplink
In conjunction with a UL/DL carrier pair (FDD band) or a bidirectional carrier
(TDD band), a UE may be configured with additional, Supplementary Uplink
(SUL). SUL differs from the aggregated uplink in that the UE may be scheduled
to transmit either on the supplementary uplink or on the uplink of the carrier
being supplemented, but not on both at the same time.
## 5.5 Transport Channels
The physical layer offers information transfer services to MAC and higher
layers. The physical layer transport services are described by _how_ and with
what characteristics data are transferred over the radio interface. An
adequate term for this is \"Transport Channel\". This should be clearly
separated from the classification of _what_ is transported, which relates to
the concept of logical channels at MAC sublayer.
Downlink transport channel types are:
1\. **Broadcast Channel (BCH)** characterised by:
\- fixed, pre-defined transport format;
\- requirement to be broadcast in the entire coverage area of the cell, either
as a single message or by beamforming different BCH instances.
2\. **Downlink Shared Channel (DL-SCH)** characterised by:
\- support for HARQ;
\- support for dynamic link adaptation by varying the modulation, coding and
transmit power;
\- possibility to be broadcast in the entire cell;
\- possibility to use beamforming;
\- support for both dynamic and semi-static resource allocation;
\- support for UE discontinuous reception (DRX) to enable UE power saving.
3\. **Paging Channel (PCH)** characterised by:
\- support for UE discontinuous reception (DRX) to enable UE power saving (DRX
cycle is indicated by the network to the UE);
\- requirement to be broadcast in the entire coverage area of the cell, either
as a single message or by beamforming different BCH instances;
\- mapped to physical resources which can be used dynamically also for
traffic/other control channels.
Uplink transport channel types are:
1\. **Uplink Shared Channel (UL-SCH)** characterised by:
\- possibility to use beamforming;
\- support for dynamic link adaptation by varying the transmit power and
potentially modulation and coding;
\- support for HARQ;
\- support for both dynamic and semi-static resource allocation.
2\. **Random Access Channel(s) (RACH)** characterised by:
\- limited control information;
\- collision risk.
Association of transport channels to physical channels is described in TS
38.202 [20].
# 6 Layer 2
## 6.1 Overview
The layer 2 of NR is split into the following sublayers: Medium Access Control
(MAC), Radio Link Control (RLC), Packet Data Convergence Protocol (PDCP) and
Service Data Adaptation Protocol (SDAP). The two figures below depict the
Layer 2 architecture for downlink and uplink, where:
\- The physical layer offers to the MAC sublayer transport channels;
\- The MAC sublayer offers to the RLC sublayer logical channels;
\- The RLC sublayer offers to the PDCP sublayer RLC channels;
\- The PDCP sublayer offers to the SDAP sublayer radio bearers;
\- The SDAP sublayer offers to 5GC QoS flows;
\- _Comp._ refers to header compression and _segm._ to segmentation;
\- Control channels (BCCH, PCCH are not depicted for clarity).
NOTE: The gNB may not be able to guarantee that a L2 buffer overflow will
never occur. If such overflow occurs, the UE may discard packets in the L2
buffer.
Figure 6.1-1: Downlink Layer 2 Structure
Figure 6.1-2: Uplink Layer 2 Structure
Radio bearers are categorized into two groups: data radio bearers (DRB) for
user plane data and signalling radio bearers (SRB) for control plane data.
## 6.2 MAC Sublayer
### 6.2.1 Services and Functions
The main services and functions of the MAC sublayer include:
\- Mapping between logical channels and transport channels;
\- Multiplexing/demultiplexing of MAC SDUs belonging to one or different
logical channels into/from transport blocks (TB) delivered to/from the
physical layer on transport channels;
\- Scheduling information reporting;
\- Error correction through HARQ (one HARQ entity per cell in case of CA);
\- Priority handling between UEs by means of dynamic scheduling;
\- Priority handling between logical channels of one UE by means of logical
channel prioritisation;
\- Padding.
A single MAC entity can support multiple numerologies, transmission timings
and cells. Mapping restrictions in logical channel prioritisation control
which numerology(ies), cell(s), and transmission timing(s) a logical channel
can use (see clause 16.1.2).
### 6.2.2 Logical Channels
Different kinds of data transfer services as offered by MAC. Each logical
channel type is defined by what type of information is transferred. Logical
channels are classified into two groups: Control Channels and Traffic
Channels. Control channels are used for the transfer of control plane
information only:
\- Broadcast Control Channel (BCCH): a downlink channel for broadcasting
system control information.
\- Paging Control Channel (PCCH): a downlink channel that carries paging
messages.
\- Common Control Channel (CCCH): channel for transmitting control information
between UEs and network. This channel is used for UEs having no RRC connection
with the network.
\- Dedicated Control Channel (DCCH): a point-to-point bi-directional channel
that transmits dedicated control information between a UE and the network.
Used by UEs having an RRC connection.
Traffic channels are used for the transfer of user plane information only:
**-** Dedicated Traffic Channel (DTCH): point-to-point channel, dedicated to
one UE, for the transfer of user information. A DTCH can exist in both uplink
and downlink.
### 6.2.3 Mapping to Transport Channels
In Downlink, the following connections between logical channels and transport
channels exist:
\- BCCH can be mapped to BCH;
\- BCCH can be mapped to DL-SCH;
\- PCCH can be mapped to PCH;
\- CCCH can be mapped to DL-SCH;
\- DCCH can be mapped to DL-SCH;
\- DTCH can be mapped to DL-SCH.
In Uplink, the following connections between logical channels and transport
channels exist:
\- CCCH can be mapped to UL-SCH;
\- DCCH can be mapped to UL- SCH;
\- DTCH can be mapped to UL-SCH.
### 6.2.4 HARQ
The HARQ functionality ensures delivery between peer entities at Layer 1\. A
single HARQ process supports one TB when the physical layer is not configured
for downlink/uplink spatial multiplexing, and when the physical layer is
configured for downlink/uplink spatial multiplexing, a single HARQ process
supports one or multiple TBs.
## 6.3 RLC Sublayer
### 6.3.1 Transmission Modes
The RLC sublayer supports three transmission modes:
\- Transparent Mode (TM);
\- Unacknowledged Mode (UM);
\- Acknowledged Mode (AM).
The RLC configuration is per logical channel with no dependency on
numerologies and/or transmission durations, and ARQ can operate on any of the
numerologies and/or transmission durations the logical channel is configured
with.
For SRB0, paging and broadcast system information, TM mode is used. For other
SRBs AM mode used. For DRBs, either UM or AM mode are used.
### 6.3.2 Services and Functions
The main services and functions of the RLC sublayer depend on the transmission
mode and include:
\- Transfer of upper layer PDUs;
\- Sequence numbering independent of the one in PDCP (UM and AM);
\- Error Correction through ARQ (AM only);
\- Segmentation (AM and UM) and re-segmentation (AM only) of RLC SDUs;
\- Reassembly of SDU (AM and UM);
\- Duplicate Detection (AM only);
\- RLC SDU discard (AM and UM);
\- RLC re-establishment;
\- Protocol error detection (AM only).
### 6.3.3 ARQ
The ARQ within the RLC sublayer has the following characteristics:
\- ARQ retransmits RLC SDUs or RLC SDU segments based on RLC status reports;
\- Polling for RLC status report is used when needed by RLC;
\- RLC receiver can also trigger RLC status report after detecting a missing
RLC SDU or RLC SDU segment.
## 6.4 PDCP Sublayer
### 6.4.1 Services and Functions
The main services and functions of the PDCP sublayer include:
\- Transfer of data (user plane or control plane);
\- Maintenance of PDCP SNs;
\- Header compression and decompression using the ROHC protocol;
\- Ciphering and deciphering;
\- Integrity protection and integrity verification;
\- Timer based SDU discard;
\- For split bearers, routing;
\- Duplication;
\- Reordering and in-order delivery;
\- Out-of-order delivery;
\- Duplicate discarding.
Since PDCP does not allow COUNT to wrap around in DL and UL, it is up to the
network to prevent it from happening (e.g. by using a release and add of the
corresponding radio bearer or a full configuration).
## 6.5 SDAP Sublayer
The main services and functions of SDAP include:
\- Mapping between a QoS flow and a data radio bearer;
\- Marking QoS flow ID (QFI) in both DL and UL packets.
A single protocol entity of SDAP is configured for each individual PDU
session.
## 6.6 L2 Data Flow
An example of the Layer 2 Data Flow is depicted on Figure 6.6-1, where a
transport block is generated by MAC by concatenating two RLC PDUs from RB
_~x~_ and one RLC PDU from RB _~y~_. The two RLC PDUs from RB _~x~_ each
corresponds to one IP packet (_n_ and _n+1_) while the RLC PDU from RB _~y~_
is a segment of an IP packet (_m_).
NOTE: H depicts the headers and subheaders.
Figure 6.6-1: Data Flow Example
## 6.7 Carrier Aggregation
In case of CA, the multi-carrier nature of the physical layer is only exposed
to the MAC layer for which one HARQ entity is required per serving cell as
depicted on Figures 6.7-1 and 6.7-2 below:
\- In both uplink and downlink, there is one independent hybrid-ARQ entity per
serving cell and one transport block is generated per assignment/grant per
serving cell in the absence of spatial multiplexing. Each transport block and
its potential HARQ retransmissions are mapped to a single serving cell.
Figure 6.7-1: Layer 2 Structure for DL with CA configured
Figure 6.7-2: Layer 2 Structure for UL with CA configured
## 6.8 Dual Connectivity
When the UE is configured with SCG, the UE is configured with two MAC
entities: one MAC entity for the MCG and one MAC entity for the SCG. Further
details of DC operation can be found in TS 37.340 [21].
## 6.9 Supplementary Uplink
In case of Supplementary Uplink (SUL, see TS 38.101-1 [18]), the UE is
configured with 2 ULs for one DL of the same cell, and uplink transmissions on
those two ULs are controlled by the network to avoid overlapping PUSCH/PUCCH
transmissions in time. Overlapping transmissions on PUSCH are avoided through
scheduling while overlapping transmissions on PUCCH are avoided through
configuration (PUCCH can only be configured for only one of the 2 ULs of the
cell). In addition, initial access is supported in each of the uplink (see
clause 9.2.6). An example of SUL is given in Annex B.
## 6.10 Bandwidth Adaptation
With Bandwidth Adaptation (BA), the receive and transmit bandwidth of a UE
need not be as large as the bandwidth of the cell and can be adjusted: the
width can be ordered to change (e.g. to shrink during period of low activity
to save power); the location can move in the frequency domain (e.g. to
increase scheduling flexibility); and the subcarrier spacing can be ordered to
change (e.g. to allow different services). A subset of the total cell
bandwidth of a cell is referred to as a Bandwidth Part (BWP) and BA is
achieved by configuring the UE with BWP(s) and telling the UE which of the
configured BWPs is currently the active one.
Figure 6.10-1 below describes a scenario where 3 different BWPs are
configured:
\- BWP~1~ with a width of 40 MHz and subcarrier spacing of 15 kHz;
\- BWP~2~ with a width of 10 MHz and subcarrier spacing of 15 kHz;
\- BWP~3~ with a width of 20 MHz and subcarrier spacing of 60 kHz.
Figure 6.10-1: BA Example
# 7 RRC
## 7.1 Services and Functions
The main services and functions of the RRC sublayer include:
\- Broadcast of System Information related to AS and NAS;
\- Paging initiated by 5GC or NG-RAN;
\- Establishment, maintenance and release of an RRC connection between the UE
and NG-RAN including:
\- Addition, modification and release of carrier aggregation;
\- Addition, modification and release of Dual Connectivity in NR or between
E-UTRA and NR.
\- Security functions including key management;
\- Establishment, configuration, maintenance and release of Signalling Radio
Bearers (SRBs) and Data Radio Bearers (DRBs);
\- Mobility functions including:
\- Handover and context transfer;
\- UE cell selection and reselection and control of cell selection and
reselection;
\- Inter-RAT mobility.
\- QoS management functions;
\- UE measurement reporting and control of the reporting;
\- Detection of and recovery from radio link failure;
\- NAS message transfer to/from NAS from/to UE.
## 7.2 Protocol States
RRC supports the following states which can be characterised as follows:
**\- RRC_IDLE** :
\- PLMN selection;
\- Broadcast of system information;
\- Cell re-selection mobility;
\- Paging for mobile terminated data is initiated by 5GC;
\- DRX for CN paging configured by NAS.
\- **RRC_INACTIVE** :
\- PLMN selection;
\- Broadcast of system information;
\- Cell re-selection mobility;
\- Paging is initiated by NG-RAN (RAN paging);
\- RAN-based notification area (RNA) is managed by NG- RAN;
\- DRX for RAN paging configured by NG-RAN;
\- 5GC - NG-RAN connection (both C/U-planes) is established for UE;
\- The UE AS context is stored in NG-RAN and the UE;
\- NG-RAN knows the RNA which the UE belongs to.
\- **RRC_CONNECTED** :
\- 5GC - NG-RAN connection (both C/U-planes) is established for UE;
\- The UE AS context is stored in NG-RAN and the UE;
\- NG-RAN knows the cell which the UE belongs to;
\- Transfer of unicast data to/from the UE;
\- Network controlled mobility including measurements.
## 7.3 System Information Handling
### 7.3.1 Overview
System Information (SI) consists of a MIB and a number of SIBs, which are
divided into Minimum SI and Other SI:
\- **Minimum SI** comprises basic information required for initial access and
information for acquiring any other SI. Minimum SI consists of:
\- _MIB_ contains cell barred status information and essential physical layer
information of the cell required to receive further system information, e.g.
CORESET#0 configuration. _MIB_ is periodically broadcast on BCH.
\- _SIB1_ defines the scheduling of other system information blocks and
contains information required for initial access. SIB1 is also referred to as
Remaining Minimum SI (RMSI) and is periodically broadcast on DL-SCH or sent in
a dedicated manner on DL-SCH to UEs in RRC_CONNECTED.
\- **Other SI** encompasses all SIBs not broadcast in the Minimum SI. Those
SIBs can either be periodically broadcast on DL-SCH, broadcast on-demand on
DL-SCH (i.e. upon request from UEs in RRC_IDLE or RRC_INACTIVE), or sent in a
dedicated manner on DL-SCH to UEs in RRC_CONNECTED. Other SI consists of:
\- _SIB2_ contains cell re-selection information, mainly related to the
serving cell;
\- _SIB3_ contains information about the serving frequency and intra-frequency
neighbouring cells relevant for cell re-selection (including cell re-selection
parameters common for a frequency as well as cell specific re-selection
parameters);
\- _SIB4_ contains information about other NR frequencies and inter-frequency
neighbouring cells relevant for cell re-selection (including cell re-selection
parameters common for a frequency as well as cell specific re-selection
parameters);
\- _SIB5_ contains information about E-UTRA frequencies and E-UTRA
neighbouring cells relevant for cell re-selection (including cell re-selection
parameters common for a frequency as well as cell specific re-selection
parameters);
\- _SIB6_ contains an ETWS primary notification;
\- _SIB7_ contains an ETWS secondary notification;
\- _SIB8_ contains a CMAS warning notification;
\- _SIB9_ contains information related to GPS time and Coordinated Universal
Time (UTC).
Figure 7.3-1 below summarises System Information provisioning.
Figure 7.3-1: System Information Provisioning
For a cell/frequency that is considered for camping by the UE, the UE is not
required to acquire the contents of the minimum SI of that cell/frequency from
another cell/frequency layer. This does not preclude the case that the UE
applies stored SI from previously visited cell(s).
If the UE cannot determine the full contents of the minimum SI of a cell by
receiving from that cell, the UE shall consider that cell as barred.
In case of BA, the UE only acquires SI on the active BWP.
### 7.3.2 Scheduling
The MIB is mapped on the BCCH and carried on BCH while all other SI messages
are mapped on the BCCH, where they are dynamically carried on DL-SCH. The
scheduling of SI messages part of Other SI is indicated by _SIB1_.
For UEs in RRC_IDLE and RRC_INACTIVE, a request for Other SI triggers a random
access procedure (see clause 9.2.6) where MSG3 includes the SI request message
unless the requested SI is associated to a subset of the PRACH resources, in
which case MSG1 is used for indication of the requested Other SI. When MSG1 is
used, the minimum granularity of the request is one SI message (i.e. a set of
SIBs), one RACH preamble and/or PRACH resource can be used to request multiple
SI messages and the gNB acknowledges the request in MSG2. When MSG 3 is used,
the gNB acknowledges the request in MSG4.
The Other SI may be broadcast at a configurable periodicity and for a certain
duration. The Other SI may also be broadcast when it is requested by UE in
RRC_IDLE/RRC_INACTIVE.
For a UE to be allowed to camp on a cell it must have acquired the contents of
the Minimum SI from that cell. There may be cells in the system that do not
broadcast the Minimum SI and where the UE therefore cannot camp.
### 7.3.3 SI Modification
Change of system information (other than for ETWS/CMAS, see clause 16.4) only
occurs at specific radio frames, i.e. the concept of a modification period is
used. System information may be transmitted a number of times with the same
content within a modification period, as defined by its scheduling. The
modification period is configured by system information.
When the network changes (some of the) system information, it first notifies
the UEs about this change, i.e. this may be done throughout a modification
period. In the next modification period, the network transmits the updated
system information. Upon receiving a change notification, the UE acquires the
new system information from the start of the next modification period. The UE
applies the previously acquired system information until the UE acquires the
new system information.
## 7.4 Access Control
NG-RAN supports overload and access control functionality such as RACH back
off, RRC Connection Reject, RRC Connection Release and UE based access barring
mechanisms.
One unified access control framework as specified in TS 22.261 [19] applies to
all UE states (RRC_IDLE, RRC_INACTIVE and RRC_CONNECTED) for NR. NG-RAN
broadcasts barring control information associated with Access Categories and
Access Identities (in case of network sharing, the barring control information
can be set individually for each PLMN). The UE determines whether an access
attempt is authorized based on the barring information broadcast for the
selected PLMN, and the selected Access Category and Access Identity(ies) for
the access attempt:
\- For NAS triggered requests, NAS determines the Access Category and Access
Identity(ies);
\- For AS triggered requests, RRC determines the Access Category while NAS
determines the Access Identity(ies).
The gNB handles access attempts with establishment causes \"emergency\",
\"mps-PriorityAccess\" and \"mcs-PriorityAccess\" (i.e. Emergency calls, MPS,
MCS subscribers) with high priority and responds with RRC Reject to these
access attempts only in extreme network load conditions that may threaten the
gNB stability.
## 7.5 UE Capability Retrieval framework
The UE reports its UE radio access capabilities which are static at least when
the network requests. The gNB can request what capabilities for the UE to
report based on band information.
## 7.6 Transport of NAS Messages
NR provides reliable in-sequence delivery of NAS messages over SRBs in RRC,
except at handover where losses or duplication can occur when PDCP is re-
established. In RRC, NAS messages are sent in transparent containers.
Piggybacking of NAS messages can occur in the following scenarios:
\- At bearer establishment/modification/release in the DL;
\- For transferring the initial NAS message during connection setup and
connection resume in the UL.
NOTE: In addition to the integrity protection and ciphering performed by NAS,
NAS messages can also be integrity protected and ciphered by PDCP.
Multiple NAS messages can be sent in a single downlink RRC message during PDU
Session Resource establishment or modification. In this case, the order of the
NAS messages contained in the RRC message shall be in the same order as that
in the corresponding NG-AP message in order to ensure the in-sequence delivery
of NAS messages.
## 7.7 Carrier Aggregation
When CA is configured, the UE only has one RRC connection with the network. At
RRC connection establishment/re-establishment/handover, one serving cell
provides the NAS mobility information, and at RRC connection re-
establishment/handover, one serving cell provides the security input. This
cell is referred to as the Primary Cell (PCell). Depending on UE capabilities,
Secondary Cells (SCells) can be configured to form together with the PCell a
set of serving cells. The configured set of serving cells for a UE therefore
always consists of one PCell and one or more SCells.
The reconfiguration, addition and removal of SCells can be performed by RRC.
At intra-NR handover, RRC can also add, remove, or reconfigure SCells for
usage with the target PCell. When adding a new SCell, dedicated RRC signalling
is used for sending all required system information of the SCell i.e. while in
connected mode, UEs need not acquire broadcast system information directly
from the SCells.
## 7.8 Bandwidth Adaptation
To enable BA on the PCell, the gNB configures the UE with UL and DL BWP(s). To
enable BA on SCells in case of CA, the gNB configures the UE with DL BWP(s) at
least (i.e. there may be none in the UL). For the PCell, the BWP used for
initial access is configured via system information. For the SCell(s), the BWP
used after initial activation is configured via dedicated RRC signaling.
In paired spectrum, DL and UL can switch BWP independently. In unpaired
spectrum, DL and UL switch BWP simultaneously. Switching between configured
BWPs happens by means of RRC signalling, DCI, inactivity timer or upon
initiation of random access. When an inactivity timer is configured for a
serving cell, the expiry of the inactivity timer associated to that cell
switches the active BWP to a default BWP configured by the network. There can
be at most one active BWP per cell, except when the serving cell is configured
with SUL, in which case there can be at most one on each UL carrier.
## 7.9 UE Assistance Information
When configured to do so, the UE can signal the network through
_UEAssistanceInformation_ if it prefers an adjustment in the connected mode
DRX cycle length, or if it is experiencing internal overheating. In the latter
case, the UE can express a preference for _temporarily reducing the number of
maximum secondary component carriers, the maximum aggregated bandwidth and the
number of maximum MIMO layers. In both cases,_ it is up to the gNB whether to
accommodate the request.
# 8 NG Identities
## 8.1 UE Identities
In this clause, the identities used by NR connected to 5GC are listed. For
scheduling at cell level, the following identities are used:
\- C-RNTI: unique UE identification used as an identifier of the RRC
Connection and for scheduling;
\- CS-RNTI: unique UE identification used for Semi-Persistent Scheduling in
the downlink or configured grant in the uplink;
\- INT-RNTI: identification of pre-emption in the downlink;
\- MCS-C-RNTI: unique UE identification used for indicating an alternative MCS
table for PDSCH and PUSCH;
\- P-RNTI: identification of Paging and System Information change notification
in the downlink;
\- SI-RNTI: identification of Broadcast and System Information in the
downlink;
\- SP-CSI-RNTI: unique UE identification used for semi-persistent CSI
reporting on PUSCH.
For power and slot format control, the following identities are used:
\- SFI-RNTI: identification of slot format;
\- TPC-PUCCH-RNTI: unique UE identification to control the power of PUCCH;
\- TPC-PUSCH-RNTI: unique UE identification to control the power of PUSCH;
\- TPC-SRS-RNTI: unique UE identification to control the power of SRS.
During the random access procedure, the following identities are also used:
\- RA-RNTI: identification of the Random Access Response in the downlink;
\- Temporary C-RNTI: UE identification temporarily used for scheduling during
the random access procedure;
\- Random value for contention resolution: UE identification temporarily used
for contention resolution purposes during the random access procedure.
For NR connected to 5GC, the following UE identities are used at NG-RAN level:
\- I-RNTI: used to identify the UE context in RRC_INACTIVE.
## 8.2 Network Identities
The following identities are used in NG-RAN for identifying a specific network
entity:
\- AMF Name: used to identify an AMF.
\- NR Cell Global Identifier (NCGI): used to identify NR cells globally. The
NCGI is constructed from the PLMN identity the cell belongs to and the NR Cell
Identity (NCI) of the cell. The PLMN ID included in the NCGI should be the
first PLMN ID within the set of PLMN IDs associated to the NR Cell Identity in
SIB1, following the order of broadcast.
NOTE 1: How to manage the scenario where a different PLMN ID has been
allocated by the operator for an NCGI is left to OAM and/or implementation.
\- gNB Identifier (gNB ID): used to identify gNBs within a PLMN. The gNB ID is
contained within the NCI of its cells.
\- Global gNB ID: used to identify gNBs globally. The Global gNB ID is
constructed from the PLMN identity the gNB belongs to and the gNB ID. The MCC
and MNC are the same as included in the NCGI.
NOTE 2: It is not precluded that a cell served by a gNB does not broadcast the
PLMN ID included in the Global gNB ID.
\- Tracking Area identity (TAI): used to identify tracking areas. The TAI is
constructed from the PLMN identity the tracking area belongs to and the TAC
(Tracking Area Code) of the Tracking Area.
\- Single Network Slice Selection Assistance information (S-NSSAI): identifies
a network slice.
## 8.3 User Data Transport on the CN-RAN Interface
The core network may provide two transport layer addresses of different
versions to enable that a NG-RAN node can select either IPv4 or IPv6.
# 9 Mobility and State Transitions
## 9.1 Overview
Load balancing is achieved in NR with handover, redirection mechanisms upon
RRC release and through the usage of inter-frequency and inter-RAT absolute
priorities and inter-frequency Qoffset parameters.
Measurements to be performed by a UE for connected mode mobility are
classified in at least three measurement types:
\- Intra-frequency NR measurements;
\- Inter-frequency NR measurements;
\- Inter-RAT measurements for E-UTRA.
For each measurement type one or several measurement objects can be defined (a
measurement object defines e.g. the carrier frequency to be monitored).
For each measurement object one or several reporting configurations can be
defined (a reporting configuration defines the reporting criteria). Three
reporting criteria are used: event triggered reporting, periodic reporting and
event triggered periodic reporting.
The association between a measurement object and a reporting configuration is
created by a measurement identity (a measurement identity links together one
measurement object and one reporting configuration of the same RAT). By using
several measurement identities (one for each measurement object, reporting
configuration pair) it is then possible to:
\- Associate several reporting configurations to one measurement object and;
\- Associate one reporting configuration to several measurement objects.
The measurements identity is used as well when reporting results of the
measurements.
Measurement quantities are considered separately for each RAT.
Measurement commands are used by NG-RAN to order the UE to start, modify or
stop measurements.
Handover can be performed within the same RAT and/or CN, or it can involve a
change of the RAT and/or CN.
Inter system fallback towards E-UTRAN is performed when 5GC does not support
emergency services, voice services, for load balancing etc. Depending on
factors such as CN interface availability, network configuration and radio
conditions, the fallback procedure results in either RRC_CONNECTED state
mobility (handover procedure) or RRC_IDLE state mobility (redirection), see TS
23.501 [3] and TS 38.331 [12].
In the NG-C signalling procedure, the AMF based on support for emergency
services, voice service, any other services or for load balancing etc, may
indicate the target CN type as EPC or 5GC to the gNB node. When the target CN
type is received by gNB, the target CN type is also conveyed to the UE in
_RRCRelease_ Message.
## 9.2 Intra-NR
### 9.2.1 Mobility in RRC_IDLE
#### 9.2.1.1 Cell Selection
The principles of PLMN selection in NR are based on the 3GPP PLMN selection
principles. Cell selection is required on transition from RM-DEREGISTERED to
RM-REGISTERED, from CM-IDLE to CM-CONNECTED and from CM-CONNECTED to CM-IDLE
and is based on the following principles:
\- The UE NAS layer identifies a selected PLMN and equivalent PLMNs;
\- Cell selection is always based on CD-SSBs located on the synchronization
raster (see clause 5.2.4):
\- The UE searches the NR frequency bands and for each carrier frequency
identifies the strongest cell as per the CD-SSB. It then reads cell system
information broadcast to identify its PLMN(s):
\- The UE may search each carrier in turn (\"initial cell selection\") or make
use of stored information to shorten the search (\"stored information cell
selection\").
\- The UE seeks to identify a suitable cell; if it is not able to identify a
suitable cell it seeks to identify an acceptable cell. When a suitable cell is
found or if only an acceptable cell is found it camps on that cell and
commence the cell reselection procedure:
\- A suitable cell is one for which the measured cell attributes satisfy the
cell selection criteria; the cell PLMN is the selected PLMN, registered or an
equivalent PLMN; the cell is not barred or reserved and the cell is not part
of a tracking area which is in the list of \"forbidden tracking areas for
roaming\";
\- An acceptable cell is one for which the measured cell attributes satisfy
the cell selection criteria and the cell is not barred.
Transition to RRC_IDLE:
On transition from RRC_CONNECTED or RRC_INACTIVE to RRC_IDLE, a UE should camp
on a cell as result of cell selection according to the frequency be assigned
by RRC in the state transition message if any.
Recovery from out of coverage:
The UE should attempt to find a suitable cell in the manner described for
stored information or initial cell selection above. If no suitable cell is
found on any frequency or RAT, the UE should attempt to find an acceptable
cell.
In multi-beam operations, the cell quality is derived amongst the beams
corresponding to the same cell (see clause 9.2.4).
#### 9.2.1.2 Cell Reselection
A UE in RRC_IDLE performs cell reselection. The principles of the procedure
are the following:
\- Cell reselection is always based on CD-SSBs located on the synchronization
raster (see clause 5.2.4).
\- The UE makes measurements of attributes of the serving and neighbour cells
to enable the reselection process:
\- For the search and measurement of inter-frequency neighbouring cells, only
the carrier frequencies need to be indicated.
\- Cell reselection identifies the cell that the UE should camp on. It is
based on cell reselection criteria which involves measurements of the serving
and neighbour cells:
\- Intra-frequency reselection is based on ranking of cells;
\- Inter-frequency reselection is based on absolute priorities where a UE
tries to camp on the highest priority frequency available;
\- An NCL can be provided by the serving cell to handle specific cases for
intra- and inter-frequency neighbouring cells;
\- Black lists can be provided to prevent the UE from reselecting to specific
intra- and inter-frequency neighbouring cells;
\- Cell reselection can be speed dependent;
\- Service specific prioritisation.
In multi-beam operations, the cell quality is derived amongst the beams
corresponding to the same cell (see clause 9.2.4).
#### 9.2.1.3 State Transitions
The following figure describes the UE triggered transition from RRC_IDLE to
RRC_CONNECTED (for the NAS part, see TS 23.502 [22]):
Figure 9.2.1.3-1: UE triggered transition from RRC_IDLE to RRC_CONNECTED
1\. The UE requests to setup a new connection from RRC_IDLE.
2/2a. The gNB completes the RRC setup procedure.
NOTE: The scenario where the gNB rejects the request is described below.
3\. The first NAS message from the UE, piggybacked in _RRCSetupComplete_ , is
sent to AMF.
4/4a/5/5a. Additional NAS messages may be exchanged between UE and AMF, see TS
23.502 [22].
6\. The AMF prepares the UE context data (including PDU session context, the
Security Key, UE Radio Capability and UE Security Capabilities, etc.) and
sends it to the gNB.
7/7a. The gNB activates the AS security with the UE.
8/8a. The gNB performs the reconfiguration to setup SRB2 and DRBs.
9\. The gNB informs the AMF that the setup procedure is completed.
NOTE 1: RRC messages in step 1 and 2 use SRB0, all the subsequent messages use
SRB1. Messages in steps 7/7a are integrity protected. From step 8 on, all the
messages are integrity protected and ciphered.
NOTE 2: For signalling only connection, step 8 is skipped since SRB2 and DRBs
are not not setup.
The following figure describes the rejection from the network when the UE
attempts to setup a connection from RRC_IDLE:
Figure 9.2.1.3-2: Rejection of UE triggered transition from RRC_IDLE
1\. UE attempts to setup a new connection from RRC_IDLE.
2\. The gNB is not able to handle the procedure, for instance due to
congestion.
3\. The gNB sends _RRCReject_ (with a wait time) to keep the UE in RRC_IDLE.
### 9.2.2 Mobility in RRC_INACTIVE
#### 9.2.2.1 Overview
RRC_INACTIVE is a state where a UE remains in CM-CONNECTED and can move within
an area configured by NG-RAN (the RNA) without notifying NG-RAN. In
RRC_INACTIVE, the last serving gNB node keeps the UE context and the UE-
associated NG connection with the serving AMF and UPF.
If the last serving gNB receives DL data from the UPF or DL UE-associated
signalling from the AMF (except the UE Context Release Command message) while
the UE is in RRC_INACTIVE, it pages in the cells corresponding to the RNA and
may send XnAP RAN Paging to neighbour gNB(s) if the RNA includes cells of
neighbour gNB(s).
Upon receiving the UE Context Release Command message while the UE is in
RRC_INACTIVE, the last serving gNB may page in the cells corresponding to the
RNA and may send XnAP RAN Paging to neighbour gNB(s) if the RNA includes cells
of neighbour gNB(s), in order to release UE explicitly.
Upon receiving the NG RESET message while the UE is in RRC_INACTIVE, the last
serving gNB may page involved UEs in the cells corresponding to the RNA and
may send XnAP RAN Paging to neighbour gNB(s) if the RNA includes cells of
neighbour gNB(s) in order to explicitly release involved UEs.
Upon RAN paging failure, the gNB behaves according to TS 23.501 [3].
The AMF provides to the NG-RAN node the Core Network Assistance Information to
assist the NG-RAN node\'s decision whether the UE can be sent to RRC_INACTIVE.
The Core Network Assistance Information includes the registration area
configured for the UE, the Periodic Registration Update timer, and the UE
Identity Index value, and may include the UE specific DRX, an indication if
the UE is configured with Mobile Initiated Connection Only (MICO) mode by the
AMF, and the Expected UE Behaviour. The UE registration area is taken into
account by the NG-RAN node when configuring the RNA. The UE specific DRX and
UE Identity Index value are used by the NG-RAN node for RAN paging. The
Periodic Registration Update timer is taken into account by the NG-RAN node to
configure Periodic RNA Update timer. The NG-RAN node takes into account the
Expected UE Behaviour to assist the UE RRC state transition decision.
At transition to RRC_INACTIVE the NG-RAN node may configure the UE with a
periodic RNA Update timer value. At periodic RNA Update timer expiry without
notification from the UE, the gNB behaves as specified in TS 23.501 [3].
If the UE accesses a gNB other than the last serving gNB, the receiving gNB
triggers the XnAP Retrieve UE Context procedure to get the UE context from the
last serving gNB and may also trigger an Xn-U Address Indication procedure
including tunnel information for potential recovery of data from the last
serving gNB. Upon successful UE context retrieval, the receiving gNB shall
perform the slice-aware admission control in case of receiving slice
information and becomes the serving gNB and it further triggers the NGAP Path
Switch Request and applicable RRC procedures. After the path switch procedure,
the serving gNB triggers release of the UE context at the last serving gNB by
means of the XnAP UE Context Release procedure.
In case the UE is not reachable at the last serving gNB, the gNB shall fail
any AMF initiated UE-associated class 1 procedure which allows the signalling
of unsuccessful operation in the respective response message. It may trigger
the NAS Non Delivery Indication procedure to report the non-delivery of any
NAS PDU received from the AMF.
If the UE accesses a gNB other than the last serving gNB and the receiving gNB
does not find a valid UE Context, the receiving gNB can perform establishment
of a new RRC connection instead of resumption of the previous RRC connection.
UE context retrieval will also fail and hence a new RRC connection needs to be
established if the serving AMF changes.
A UE in the RRC_INACTIVE state is required to initiate RNA update procedure
when it moves out of the configured RNA. When receiving RNA update request
from the UE, the receiving gNB triggers the XnAP Retrieve UE Context procedure
to get the UE context from the last serving gNB and may decide to send the UE
back to RRC_INACTIVE state, move the UE into RRC_CONNECTED state, or send the
UE to RRC_IDLE. In case of periodic RNA update, if the last serving gNB
decides not to relocate the UE context, it fails the Retrieve UE Context
procedure and sends the UE back to RRC_INACTIVE, or to RRC_IDLE directly by an
encapsulated _RRCRelease_ message.
#### 9.2.2.2 Cell Reselection
A UE in RRC_INACTIVE performs cell reselection. The principles of the
procedure are as for the RRC_IDLE state (see clause 9.2.1.2).
#### 9.2.2.3 RAN-Based Notification Area
A UE in the RRC_INACTIVE state can be configured by the last serving NG-RAN
node with an RNA, where:
\- the RNA can cover a single or multiple cells, and shall be contained within
the CN registration area; in this release Xn connectivity should be available
within the RNA;
\- a RAN-based notification area update (RNAU) is periodically sent by the UE
and is also sent when the cell reselection procedure of the UE selects a cell
that does not belong to the configured RNA.
There are several different alternatives on how the RNA can be configured:
\- List of cells:
\- A UE is provided an explicit list of cells (one or more) that constitute
the RNA.
\- List of RAN areas:
\- A UE is provided (at least one) RAN area ID, where a RAN area is a subset
of a CN Tracking Area or equal to a CN Tracking Area. A RAN area is specified
by one RAN area ID, which consists of a TAC and optionally a RAN area Code;
\- A cell broadcasts one or more RAN area IDs in the system information.
NG-RAN may provide different RNA definitions to different UEs but not mix
different definitions to the same UE at the same time. UE shall support all
RNA configuration options listed above.
#### 9.2.2.4 State Transitions
##### 9.2.2.4.1 UE triggered transition from RRC_INACTIVE to RRC_CONNECTED
The following figure describes the UE triggered transition from RRC_INACTIVE
to RRC_CONNECTED in case of UE context retrieval success:
Figure 9.2.2.4.1-1: UE triggered transition from RRC_INACTIVE to
RRC_CONNECTED\ (UE context retrieval success)
1\. The UE resumes from RRC_INACTIVE, providing the I-RNTI, allocated by the
last serving gNB.
2\. The gNB, if able to resolve the gNB identity contained in the I-RNTI,
requests the last serving gNB to provide UE Context data.
3\. The last serving gNB provides UE context data.
4/5. The gNB and UE completes the resumption of the RRC connection.
NOTE: User Data can also be sent in step 5 if the grant allows.
6\. If loss of DL user data buffered in the last serving gNB shall be
prevented, the gNB provides forwarding addresses.
7/8. The gNB performs path switch.
9\. The gNB triggers the release of the UE resources at the last serving gNB.
After step 1 above, when the gNB decides to use a single RRC message to reject
the Resume Request right away and keep the UE in RRC_INACTIVE without any
reconfiguration (e.g. as described in the two examples below), or when the gNB
decides to setup a new RRC connection, SRB0 (without security) is used.
Conversely, when the gNB decides to reconfigure the UE (e.g. with a new DRX
cycle or RNA) or when the gNB decides to push the UE to RRC_IDLE, SRB1 (with
integrity protection and ciphering as previously configured for that SRB)
shall be used.
NOTE: SRB1 can only be used once the UE Context is retrieved i.e. after step
3.
The following figure describes the UE triggered transition from RRC_INACTIVE
to RRC_CONNECTED in case of UE context retrieval failure:
Figure 9.2.2.4.1-2: UE triggered transition from RRC_INACTIVE to
RRC_CONNECTED\ (UE context retrieval failure)
1\. The UE resumes from RRC_INACTIVE, providing the I-RNTI, allocated by the
last serving gNB.
2\. The gNB, if able to resolve the gNB identity contained in the I-RNTI,
requests the last serving gNB to provide UE Context data.
3\. The last serving gNB cannot retrieve or verify the UE context data.
4\. The last serving gNB indicates the failure to the gNB.
5\. The gNB performs a fallback to establish a new RRC connection by sending
_RRCSetup_.
6\. A new connection is setup as described in clause 9.2.1.3.1.
The following figure describes the rejection form the network when the UE
attempts to resume a connection from RRC_INACTIVE:
Figure 9.2.2.4.1-3: Reject from the network, UE attempts to resume a
connection
1\. UE attempts to resume the connection from RRC_INACTIVE.
2\. The gNB is not able to handle the procedure, for instance due to
congestion.
3\. The gNB sends _RRCReject_ (with a wait time) to keep the UE in
RRC_INACTIVE.
##### 9.2.2.4.2 Network triggered transition from RRC_INACTIVE to
RRC_CONNECTED
The following figure describes the network triggered transition from
RRC_INACTIVE to RRC_CONNECTED:
Figure 9.2.2.4.2-1: Network triggered transition from RRC_INACTIVE to
RRC_CONNECTED
1\. A RAN paging trigger event occurs (incoming DL user plane, DL signalling
from 5GC, etc.).
2\. RAN paging is triggered; either only in the cells controlled by the last
serving gNB or also by means of Xn RAN Paging in cells controlled by other
gNBs, configured to the UE in the RAN-based Notification Area (RNA).
3\. The UE is paged with the I-RNTI.
4\. If the UE has been successfully reached, it attempts to resume from
RRC_INACTIVE, as described in clause 9.2.2.4.1.
#### 9.2.2.5 RNA update
The following figure describes the UE triggered RNA update procedure involving
context retrieval over Xn. The procedure may be triggered when the UE moves
out of the configured RNA, or periodically.
Figure 9.2.2.5-1: RNA update procedure with UE context relocation
1\. The UE resumes from RRC_INACTIVE, providing the I-RNTI allocated by the
last serving gNB and appropriate cause value, e.g., RAN notification area
update.
2\. The gNB, if able to resolve the gNB identity contained in the I-RNTI,
requests the last serving gNB to provide UE Context, providing the cause value
received in step 1.
3\. The last serving gNB may provide the UE context (as assumed in the
following). Alternatively, the last serving gNB may decide to move the UE to
RRC_IDLE (and the procedure follows steps 3 and later of figure 9.2.2.5-3) or,
if the UE is still within the previously configured RNA, to keep the UE
context in the last serving gNB and to keep the UE in RRC_INACTIVE (and the
procedure follows steps 3 and later of figure 9.2.2.5-2).
4\. The gNB may move the UE to RRC_CONNECTED (and the procedure follows step 4
of Figure 9.2.2.4.1-1), or send the UE back to RRC_IDLE (in which case an
_RRCRelease_ message is sent by the gNB), or send the UE back to RRC_INACTIVE
as assumed in the following.
5\. If loss of DL user data buffered in the last serving gNB shall be
prevented, the gNB provides forwarding addresses.
6./7. The gNB performs path switch.
8\. The gNB keeps the UE in RRC_INACTIVE state by sending _RRCRelease_ with
suspend indication.
9\. The gNB triggers the release of the UE resources at the last serving gNB.
The following figure describes the RNA update procedure for the case when the
UE is still within the configured RNA and the last serving gNB decides not to
relocate the UE context and to keep the UE in RRC_INACTIVE:
Figure 9.2.2.5-2: Periodic RNA update procedure without UE context relocation
1\. The UE resumes from RRC_INACTIVE, providing the I-RNTI allocated by the
last serving gNB and appropriate cause value, e.g., RAN notification area
update.
2\. The gNB, if able to resolve the gNB identity contained in the I-RNTI,
requests the last serving gNB to provide UE Context, providing the cause value
received in step 1.
3\. The last serving gNB stores received information to be used in the next
resume attempt (e.g. C-RNTI and PCI related to the resumption cell), and
responds to the gNB with the RETRIEVE UE CONTEXT FAILURE message including an
encapsulated _RRCRelease_ message. The _RRCRelease_ message includes Suspend
Indication.
4\. The gNB forwards the _RRCRelease_ message to the UE.
The following figure describes the RNA update procedure for the case when the
last serving gNB decides to move the UE to RRC_IDLE:
Figure 9.2.2.5-3: RNA update procedure with transition to RRC_IDLE
1\. The UE resumes from RRC_INACTIVE, providing the I-RNTI allocated by the
last serving gNB and appropriate cause value, e.g., RAN notification area
update.
2\. The gNB, if able to resolve the gNB identity contained in the I-RNTI,
requests the last serving gNB to provide UE Context, providing the cause value
received in step 1.
> 3\. Instead of providing the UE context, the last serving gNB provides an
> _RRCRelease_ message to move the UE to RRC_IDLE.
>
> 4\. The last serving gNB deletes the UE context.
>
> 5\. The gNB sends the _RRCRelease_ which triggers the UE to move to
> RRC_IDLE.
### 9.2.3 Mobility in RRC_CONNECTED
#### 9.2.3.1 Overview
Network controlled mobility applies to UEs in RRC_CONNECTED and is categorized
into two types of mobility: cell level mobility and beam level mobility.
**Cell Level Mobility** requires explicit RRC signalling to be triggered, i.e.
handover. For inter-gNB handover, the signalling procedures consist of at
least the following elemental components illustrated in Figure 9.2.3.1-1:
Figure 9.2.3.1-1: Inter-gNB handover procedures
1\. The source gNB initiates handover and issues a HANDOVER REQUEST over the
Xn interface.
2\. The target gNB performs admission control and provides the new RRC
configuration as part of the HANDOVER REQUEST ACKNOWLEDGE.
3\. The source gNB provides the RRC configuration to the UE by forwarding the
_RRCReconfiguration_ message received in the HANDOVER REQUEST ACKNOWLEDGE. The
_RRCReconfiguration_ message includes at least cell ID and all information
required to access the target cell so that the UE can access the target cell
without reading system information. For some cases, the information required
for contention-based and contention-free random access can be included in the
_RRCReconfiguration_ message. The access information to the target cell may
include beam specific information, if any.
4\. The UE moves the RRC connection to the target gNB and replies with the
_RRCReconfigurationComplete_.
NOTE: User Data can also be sent in step 4 if the grant allows.
The handover mechanism triggered by RRC requires the UE at least to reset the
MAC entity and re-establish RLC. RRC managed handovers with and without PDCP
entity re-establishment are both supported. For DRBs using RLC AM mode, PDCP
can either be re-established together with a security key change or initiate a
data recovery procedure without a key change. For DRBs using RLC UM mode, PDCP
can either be re-established together with a security key change or remain as
it is without a key change. For SRBs, PDCP can either remain as it is, discard
its stored PDCP PDUs/SDUs without a key change or be re-established together
with a security key change.
Data forwarding, in-sequence delivery and duplication avoidance at handover
can be guaranteed when the target gNB uses the same DRB configuration as the
source gNB.
Timer based handover failure procedure is supported in NR. RRC connection re-
establishment procedure is used for recovering from handover failure.
**Beam Level Mobility** does not require explicit RRC signalling to be
triggered. The gNB provides via RRC signalling the UE with measurement
configuration containing configurations of SSB/CSI resources and resource
sets, reports and trigger states for triggering channel and interference
measurements and reports. Beam Level Mobility is then dealt with at lower
layers by means of physical layer and MAC layer control signalling, and RRC is
not required to know which beam is being used at a given point in time.
SSB-based Beam Level Mobility is based on the SSB associated to the initial DL
BWP and can only be configured for the initial DL BWPs and for DL BWPs
containing the SSB associated to the initial DL BWP. For other DL BWPs, Beam
Level Mobility can only be performed based on CSI-RS.
#### 9.2.3.2 Handover
##### 9.2.3.2.1 C-Plane Handling
The intra-NR RAN handover performs the preparation and execution phase of the
handover procedure performed without involvement of the 5GC, i.e. preparation
messages are directly exchanged between the gNBs. The release of the resources
at the source gNB during the handover completion phase is triggered by the
target gNB. The figure below depicts the basic handover scenario where neither
the AMF nor the UPF changes:
Figure 9.2.3.2.1-1: Intra-AMF/UPF Handover
0\. The UE context within the source gNB contains information regarding
roaming and access restrictions which were provided either at connection
establishment or at the last TA update.
1\. The source gNB configures the UE measurement procedures and the UE reports
according to the measurement configuration.
2\. The source gNB decides to handover the UE, based on _MeasurementReport_
and RRM information.
3\. The source gNB issues a Handover Request message to the target gNB passing
a transparent RRC container with necessary information to prepare the handover
at the target side. The information includes at least the target cell ID,
KgNB*, the C-RNTI of the UE in the source gNB, RRM-configuration including UE
inactive time, basic AS-configuration including _antenna Info and DL Carrier
Frequency_ , the current QoS flow to DRB mapping rules applied to the UE, the
SIB1 information from source gNB, the UE capabilities for different RATs, PDU
session related information, and can include the UE reported measurement
information including beam-related information if available. The PDU session
related information includes the slice information and QoS flow level QoS
profile(s).
NOTE: After issuing a Handover Request, the source gNB should not reconfigure
the UE, including performing Reflective QoS flow to DRB mapping.
4\. Admission Control may be performed by the target gNB. Slice-aware
admission control shall be performed if the slice information is sent to the
target gNB. If the PDU sessions are associated with non-supported slices the
target gNB shall reject such PDU Sessions.
5\. The target gNB prepares the handover with L1/L2 and sends the HANDOVER
REQUEST ACKNOWLEDGE to the source gNB, which includes a transparent container
to be sent to the UE as an RRC message to perform the handover.
6\. The source gNB triggers the Uu handover by sending an _RRCReconfiguration_
message to the UE, containing the information required to access the target
cell: at least the target cell ID, the new C-RNTI, the target gNB security
algorithm identifiers for the selected security algorithms. It can also
include a set of dedicated RACH resources, the association between RACH
resources and SSB(s), the association between RACH resources and UE-specific
CSI-RS configuration(s), common RACH resources, and system information of the
target cell, etc.
7\. The source gNB sends the SN STATUS TRANSFER message to the target gNB.
8\. The UE synchronises to the target cell and completes the RRC handover
procedure by sending _RRCReconfigurationComplete_ message to target gNB.
9\. The target gNB sends a PATH SWITCH REQUEST message to AMF to trigger 5GC
to switch the DL data path towards the target gNB and to establish an NG-C
interface instance towards the target gNB.
10\. 5GC switches the DL data path towards the target gNB. The UPF sends one
or more \"end marker\" packets on the old path to the source gNB per PDU
session/tunnel and then can release any U-plane/TNL resources towards the
source gNB.
11\. The AMF confirms the PATH SWITCH REQUEST message with the PATH SWITCH
REQUEST ACKNOWLEDGE message.
12\. Upon reception of the PATH SWITCH REQUEST ACKNOWLEDGE message from the
AMF, the target gNB sends the UE CONTEXT RELEASE to inform the source gNB
about the success of the handover. The source gNB can then release radio and
C-plane related resources associated to the UE context. Any ongoing data
forwarding may continue.
The RRM configuration can include both beam measurement information (for layer
3 mobility) associated to SSB(s) and CSI-RS(s) for the reported cell(s) if
both types of measurements are available. Also, if CA is configured, the RRM
configuration can include the list of best cells on each frequency for which
measurement information is available. And the RRM measurement information can
also include the beam measurement for the listed cells that belong to the
target gNB.
The common RACH configuration for beams in the target cell is only associated
to the SSB(s). The network can have dedicated RACH configurations associated
to the SSB(s) and/or have dedicated RACH configurations associated to CSI-
RS(s) within a cell. The target gNB can only include one of the following RACH
configurations in the Handover Command to enable the UE to access the target
cell:
i) Common RACH configuration;
ii) Common RACH configuration + Dedicated RACH configuration associated with
SSB;
iii) Common RACH configuration + Dedicated RACH configuration associated with
CSI-RS.
The dedicated RACH configuration allocates RACH resource(s) together with a
quality threshold to use them. When dedicated RACH resources are provided,
they are prioritized by the UE and the UE shall not switch to contention-based
RACH resources as long as the quality threshold of those dedicated resources
is met. The order to access the dedicated RACH resources is up to UE
implementation.
##### 9.2.3.2.2 U-Plane Handling
The U-plane handling during the Intra-NR-Access mobility activity for UEs in
RRC_CONNECTED takes the following principles into account to avoid data loss
during HO:
\- During HO preparation, U-plane tunnels can be established between the
source gNB and the target gNB;
\- During HO execution, user data can be forwarded from the source gNB to the
target gNB;
\- Forwarding should take place in order as long as packets are received at
the source gNB from the UPF or the source gNB buffer has not been emptied.
\- During HO completion:
\- The target gNB sends a path switch request message to the AMF to inform
that the UE has gained access and the AMF then triggers path switch related
5GC internal signalling and actual path switch of the source gNB to the target
gNB in UPF;
\- The source gNB should continue forwarding data as long as packets are
received at the source gNB from the UPF or the source gNB buffer has not been
emptied.
**For RLC-AM bearers** :
\- For in-sequence delivery and duplication avoidance, PDCP SN is maintained
on a per DRB basis and the source gNB informs the target gNB about the next DL
PDCP SN to allocate to a packet which does not have a PDCP sequence number yet
(either from source gNB or from the UPF).
\- For security synchronisation, HFN is also maintained and the source gNB
provides to the target one reference HFN for the UL and one for the DL i.e.
HFN and corresponding SN.
\- In both the UE and the target gNB, a window-based mechanism is used for
duplication detection and reordering.
\- The occurrence of duplicates over the air interface in the target gNB is
minimised by means of PDCP SN based reporting at the target gNB by the UE. In
uplink, the reporting is optionally configured on a per DRB basis by the gNB
and the UE should first start by transmitting those reports when granted
resources are in the target gNB. In downlink, the gNB is free to decide when
and for which bearers a report is sent and the UE does not wait for the report
to resume uplink transmission.
\- The target gNB re-transmits and prioritizes all downlink data forwarded by
the source gNB (i.e. the target gNB should first send all forwarded PDCP SDUs
with PDCP SNs, then all forwarded downlink PDCP SDUs without SNs before
sending new data from 5GC), excluding PDCP SDUs for which the reception was
acknowledged through PDCP SN based reporting by the UE.
NOTE: Lossless delivery when a QoS flow is mapped to a different DRB at
handover, requires the old DRB to be configured in the target cell. For in-
order delivery in the DL, the target gNB should first transmit the forwarded
PDCP SDUs on the old DRB before transmitting new data from 5GCN on the new
DRB. In the UL, the target gNB should not deliver data of the QoS flow from
the new DRB to 5GCN before receiving the end marker on the old DRB from the
UE.
\- The UE re-transmits in the target gNB all uplink PDCP SDUs starting from
the oldest PDCP SDU that has not been acknowledged at RLC in the source,
excluding PDCP SDUs for which the reception was acknowledged through PDCP SN
based reporting by the target.
\- In case of handovers involving Full Configuration, the following
description below for RLC-UM bearers applies for RLC-AM bearers instead. Data
loss may happen.
**For RLC-UM bearers** :
\- The PDCP SN and HFN are reset in the target gNB;
\- No PDCP SDUs are retransmitted in the target gNB;
\- The target gNB prioritises all downlink SDAP SDUs forwarded by the source
gNB over the data from the core network;
NOTE: To minimise losses when a QoS flow is mapped to a different DRB at
handover, the old DRB needs to be configured in the target cell. For in-order
delivery in the DL, the target gNB should first transmit the forwarded PDCP
SDUs on the old DRB before transmitting new data from 5GCN on the new DRB. In
the UL, the target gNB should not deliver data of the QoS flow from the new
DRB to 5GCN before receiving the end marker on the old DRB from the UE.
\- The UE does not retransmit any PDCP SDU in the target cell for which
transmission had been completed in the source cell.
##### 9.2.3.2.3 Data Forwarding
The following description depicts the data forwarding principles for intra-
system handover.
The source NG-RAN node may suggest downlink data forwarding per QoS flow
established for a PDU session and may provide information how it maps QoS
flows to DRBs. The target NG-RAN node decides data forwarding per QoS flow
established for a PDU Session.
If \"lossless handover\" is required and the QoS flows to DRB mapping applied
at the target NG-RAN node allows applying for data forwarding the same QoS
flows to DRB mapping as applied at the source NG-RAN node for a DRB and if all
QoS flows mapped to that DRB are accepted for data forwarding, the target NG-
RAN node establishes a downlink forwarding tunnel for that DRB.
For a DRB for which preservation of SN status applies, the target NG-RAN node
may decide to establish an UL data forwarding tunnel.
The target NG-RAN node may also decide to establish a downlink forwarding
tunnel for each PDU session. In this case the target NG-RAN node provides
information for which QoS flows data forwarding has been accepted and
corresponding UP TNL information for data forwarding tunnels to be established
between the source NG-RAN node and the target NG-RAN node.
If QoS flows have been re-mapped at the source NG-RAN node and user packets
along the old source mapping are still being processed at handover
preparation, and if the source NG-RAN node has not yet received the SDAP end
marker for certain QoS flows when providing the SN status to the target NG-RAN
node, the source NG-RAN node provides the old side QoS mapping information for
UL QoS flows to the target NG-RAN node for which no SDAP end marker was yet
received. The target NG-RAN will receive for those QoS flows the end marker
when the UE finalises to send UL user data according to the old source side
mapping.
The source NG-RAN node may also propose to establish uplink forwarding tunnels
for some PDU sessions in order to transfer SDAP SDUs corresponding to QoS
flows for which flow re-mapping happened before the handover and the SDAP end
marker has not yet been received, and for which user data was received at the
source NG-RAN node via the DRB to which the QoS flow was remapped. If accepted
the target NG-RAN node shall provide the corresponding UP TNL information for
data forwarding tunnels to be established between the source NG-RAN node and
the target NG-RAN node.
As long as data forwarding of DL user data packets takes place, the source NG-
RAN node shall forward user data in the same forwarding tunnel, i.e.
\- for any QoS flow accepted for data forwarding by the target NG-RAN node and
for which a DRB DL forwarding tunnel was established for a DRB to which this
QoS flow was mapped at the source NG-RAN node, any fresh packets of this QoS
flow shall be forwarded as PDCP SDUs via the mapped DRB DL forwarding tunnel.
\- for DRBs for which preservation of SN status applies, the source NG-RAN
node may forward in order to the target NG-RAN node via the DRB DL forwarding
tunnel all downlink PDCP SDUs with their SN corresponding to PDCP PDUs which
have not been acknowledged by the UE.
NOTE: The SN of forwarded PDCP SDUs is carried in the \"PDCP PDU number\"
field of the GTP-U extension header.
\- for any QoS flow accepted for data forwarding by the target NG-RAN node for
which a DL PDU session forwarding tunnel was established, the source NG-RAN
node forwards SDAP SDUs as received on NG-U from the UPF.
For handovers involving Full Configuration, the source NG-RAN node behaviour
is unchanged from the description above. In case a DRB DL forwarding tunnel
was established, the target NG-RAN node may identify the PDCP SDUs for which
delivery was attempted by the source NG-RAN node, by the presence of the PDCP
SN in the forwarded GTP-U packet and may discard them.
As long as data forwarding of UL user data packets takes place for DRBs for
which preservation of SN status applies the source NG-RAN node either:
\- discards the uplink PDCP PDUs received out of sequence if the source NG-RAN
node has not accepted the request from the target NG-RAN node for uplink
forwarding or if the target NG-RAN node has not requested uplink forwarding
for the bearer during the Handover Preparation procedure; or
\- forwards to the target NG-RAN node via the corresponding DRB UL forwarding
tunnel, the uplink PDCP SDUs with their SN corresponding to PDCP PDUs received
out of sequence if the source NG-RAN node has accepted the request from the
target NG-RAN node for uplink forwarding for the bearer during the Handover
Preparation procedure, including PDCP SDUs corresponding to user data of those
QoS flows, for which re-mapping happened for a QoS flow before the handover
and the SDAP end marker has not yet been received at the source NG-RAN node.
As long as data forwarding of UL user data packets takes place for a PDU
session, the source NG-RAN node forwards via the corresponding PDU session UL
forwarding tunnel, the uplink SDAP SDUs corresponding to QoS flows for which
flow re-mapping happened before the handover and the SDAP end marker has not
yet been received at the source NG-RAN node, and which were received at the
source NG-RAN node via the DRB to which the QoS flow was remapped.
Handling of end marker packets:
\- The source NG-RAN node receives one or several GTP-U end marker packets per
PDU session from the UPF and replicates the end marker packets into each data
forwarding tunnel when no more user data packets are to be forwarded over that
tunnel.
\- End marker packets sent via a data forwarding tunnel are applicable to all
QoS flows forwarded via that tunnel. After end marker packets have been
received over a forwarding tunnel, the target NG-RAN node can start taking
into account the packets of QoS flows associated with that forwarding tunnel
received at the target NG-RAN node from the NG-U PDU session tunnel.
#### 9.2.3.3 Re-establishment procedure
A UE in RRC_CONNECTED may initiate the re-establishment procedure to continue
the RRC connection when a failure condition occurs (e.g. radio link failure,
reconfiguration failure, integrity check failure...).
The following figure describes the re-establishment procedure started by the
UE:
Figure 9.2.3.3-1: Re-establishment procedure
1\. The UE re-establishes the connection, providing the UE Identity
(PCI+C-RNTI) to the gNB where the trigger for the re-establishment occurred.
2\. If the UE Context is not locally available, the gNB, requests the last
serving gNB to provide UE Context data.
3\. The last serving gNB provides UE context data.
4/4a. The gNB continues the re-establishment of the RRC connection. The
message is sent on SRB1.
5/5a. The gNB may perform the reconfiguration to re-establish SRB2 and DRBs
when the re-establishment procedure is ongoing.
6/7. If loss of user data buffered in the last serving gNB shall be prevented,
the gNB provides forwarding addresses, and the last serving gNB provides the
SN status to the gNB.
8/9. The gNB performs path switch.
10\. The gNB triggers the release of the UE resources at the last serving gNB.
### 9.2.4 Measurements
In RRC_CONNECTED, the UE measures multiple beams (at least one) of a cell and
the measurements results (power values) are averaged to derive the cell
quality. In doing so, the UE is configured to consider a subset of the
detected beams. Filtering takes place at two different levels: at the physical
layer to derive beam quality and then at RRC level to derive cell quality from
multiple beams. Cell quality from beam measurements is derived in the same way
for the serving cell(s) and for the non-serving cell(s). Measurement reports
may contain the measurement results of the _X_ best beams if the UE is
configured to do so by the gNB.
The corresponding high-level measurement model is described below:
Figure 9.2.4-1: Measurement Model
NOTE 1: K beams correspond to the measurements on SSB or CSI-RS resources
configured for L3 mobility by gNB and detected by UE at L1.
\- **A** : measurements (beam specific samples) internal to the physical
layer.
\- **Layer 1 filtering** : internal layer 1 filtering of the inputs measured
at point A. Exact filtering is implementation dependent. How the measurements
are actually executed in the physical layer by an implementation (inputs A and
Layer 1 filtering) in not constrained by the standard.
\- **A^1^** : measurements (i.e. beam specific measurements) reported by layer
1 to layer 3 after layer 1 filtering.
**\- Beam Consolidation/Selection** : beam specific measurements are
consolidated to derive cell quality. The behaviour of the Beam
consolidation/selection is standardised and the configuration of this module
is provided by RRC signalling. Reporting period at B equals one measurement
period at A^1^.
**\- B** : a measurement (i.e. cell quality) derived from beam-specific
measurements reported to layer 3 after beam consolidation/selection.
\- **Layer 3 filtering for cell quality** : filtering performed on the
measurements provided at point B. The behaviour of the Layer 3 filters is
standardised and the configuration of the layer 3 filters is provided by RRC
signalling. Filtering reporting period at C equals one measurement period at
B.
\- **C** : a measurement after processing in the layer 3 filter. The reporting
rate is identical to the reporting rate at point B. This measurement is used
as input for one or more evaluation of reporting criteria.
\- **Evaluation of reporting criteria** : checks whether actual measurement
reporting is necessary at point D. The evaluation can be based on more than
one flow of measurements at reference point C e.g. to compare between
different measurements. This is illustrated by input C and C^1^. The UE shall
evaluate the reporting criteria at least every time a new measurement result
is reported at point C, C^1^. The reporting criteria are standardised and the
configuration is provided by RRC signalling (UE measurements).
\- **D** : measurement report information (message) sent on the radio
interface.
\- **L3 Beam filtering** : filtering performed on the measurements (i.e. beam
specific measurements) provided at point A^1^. The behaviour of the beam
filters is standardised and the configuration of the beam filters is provided
by RRC signalling. Filtering reporting period at E equals one measurement
period at A^1^.
\- **E** : a measurement (i.e. beam-specific measurement) after processing in
the beam filter. The reporting rate is identical to the reporting rate at
point A^1^. This measurement is used as input for selecting the X measurements
to be reported.
\- **Beam Selection for beam reporting** : selects the X measurements from the
measurements provided at point E. The behaviour of the beam selection is
standardised and the configuration of this module is provided by RRC
signalling.
\- **F** : beam measurement information included in measurement report (sent)
on the radio interface.
Layer 1 filtering introduces a certain level of measurement averaging. How and
when the UE exactly performs the required measurements is implementation
specific to the point that the output at B fulfils the performance
requirements set in TS 38.133 [13]. Layer 3 filtering for cell quality and
related parameters used are specified in TS 38.331 [12] and do not introduce
any delay in the sample availability between B and C. Measurement at point C,
C^1^ is the input used in the event evaluation. L3 Beam filtering and related
parameters used are specified in TS 38.331 [12] and do not introduce any delay
in the sample availability between E and F.
Measurement reports are characterized by the following:
\- Measurement reports include the measurement identity of the associated
measurement configuration that triggered the reporting;
\- Cell and beam measurement quantities to be included in measurement reports
are configured by the network;
\- The number of non-serving cells to be reported can be limited through
configuration by the network;
\- Cells belonging to a blacklist configured by the network are not used in
event evaluation and reporting, and conversely when a whitelist is configured
by the network, only the cells belonging to the whitelist are used in event
evaluation and reporting;
\- Beam measurements to be included in measurement reports are configured by
the network (beam identifier only, measurement result and beam identifier, or
no beam reporting).
Intra-frequency neighbour (cell) measurements and inter-frequency neighbour
(cell) measurements are defined as follows:
\- SSB based intra-frequency measurement: a measurement is defined as an SSB
based intra-frequency measurement provided the center frequency of the SSB of
the serving cell and the center frequency of the SSB of the neighbour cell are
the same, and the subcarrier spacing of the two SSBs is also the same.
\- SSB based inter-frequency measurement: a measurement is defined as an SSB
based inter-frequency measurement provided the center frequency of the SSB of
the serving cell and the center frequency of the SSB of the neighbour cell are
different, or the subcarrier spacing of the two SSBs is different.
NOTE 2: For SSB based measurements, one measurement object corresponds to one
SSB and the UE considers different SSBs as different cells.
\- CSI-RS based intra-frequency measurement: a measurement is defined as a
CSI-RS based intra-frequency measurement provided that:
\- The SCS of CSI-RS resources on the neighbour cell configured for
measurement is the same as the SCS of CSI-RS resources on the serving cell
indicated for measurement; and
\- For SCS = 60kHz, the CP type of CSI-RS resources on the neighbour cell
configured for measurement is the same as the CP type of CSI-RS resources on
the serving cell indicated for measurement; and
\- The centre frequency of CSI-RS resources on the neighbour cell configured
for measurement is the same as the centre frequency of CSI-RS resource on the
serving cell indicated for measurement.
\- CSI-RS based inter-frequency measurement: a measurement is defined as a
CSI-RS based inter-frequency measurement if it is not a CSI-RS based intra-
frequency measurement.
NOTE 3: Extended CP for CSI-RS based measurement is not supported in this
release.
Whether a measurement is non-gap-assisted or gap-assisted depends on the
capability of the UE, the active BWP of the UE and the current operating
frequency:
\- For SSB based inter-frequency, a measurement gap configuration is always
provided in the following cases:
\- If the UE only supports per-UE measurement gaps;
\- If the UE supports per-FR measurement gaps and any of the serving cells are
in the same frequency range of the measurement object.
\- For SSB based intra-frequency measurement, a measurement gap configuration
is always provided in the following case:
\- Other than the initial BWP, if any of the UE configured BWPs do not contain
the frequency domain resources of the SSB associated to the initial DL BWP.
In non-gap-assisted scenarios, the UE shall be able to carry out such
measurements without measurement gaps. In gap-assisted scenarios, the UE
cannot be assumed to be able to carry out such measurements without
measurement gaps.
### 9.2.5 Paging
Paging allows the network to reach UEs in RRC_IDLE and in RRC_INACTIVE state
through _Paging_ messages, and to notify UEs in RRC_IDLE, RRC_INACTIVE and
RRC_CONNECTED state of system information change (see clause 7.3.3) and
ETWS/CMAS indications (see clause 16.4) through _Short Messages_. Both
_Paging_ messages and _Short Messages_ are addressed with P-RNTI on PDCCH, but
while the former is sent on PCCH, the latter is sent over PDCCH directly (see
clause 6.5 of TS 38.331 [12]).
While in RRC_IDLE the UE monitors the paging channels for CN-initiated paging;
in RRC_INACTIVE the UE also monitors paging channels for RAN-initiated paging.
A UE need not monitor paging channels continuously though; Paging DRX is
defined where the UE in RRC_IDLE or RRC_INACTIVE is only required to monitor
paging channels during one Paging Occasion (PO) per DRX cycle (see TS 38.304
[10]). The Paging DRX cycles are configured by the network:
1) For CN-initiated paging, a default cycle is broadcast in system
information;
2) For CN-initiated paging, a UE specific cycle can be configured via NAS
signalling;
3) For RAN-initiated paging, a UE-specific cycle is configured via RRC
signalling;
\- The UE uses the shortest of the DRX cycles applicable i.e. a UE in RRC_IDLE
uses the shortest of the first two cycles above, while a UE in RRC_INACTIVE
uses the shortest of the three.
The POs of a UE for CN-initiated and RAN-initiated paging are based on the
same UE ID, resulting in overlapping POs for both. The number of different POs
in a DRX cycle is configurable via system information and a network may
distribute UEs to those POs based on their IDs.
When in RRC_CONNECTED, the UE monitors the paging channels in any PO signalled
in system information for SI change indication and PWS notification. In case
of BA, a UE in RRC_CONNECTED only monitors paging channels on the active BWP
with common search space configured.
**Paging optimization for UEs in CM_IDLE** : at UE context release, the NG-RAN
node may provide the AMF with a list of recommended cells and NG-RAN nodes as
assistance info for subsequent paging. The AMF may also provide Paging Attempt
Information consisting of a Paging Attempt Count and the Intended Number of
Paging Attempts and may include the Next Paging Area Scope. If Paging Attempt
Information is included in the Paging message, each paged NG-RAN node receives
the same information during a paging attempt. The Paging Attempt Count shall
be increased by one at each new paging attempt. The Next Paging Area Scope,
when present, indicates whether the AMF plans to modify the paging area
currently selected at next paging attempt. If the UE has changed its state to
CM CONNECTED the Paging Attempt Count is reset.
**Paging optimization for UEs in RRC_INACTIVE** : at RAN Paging, the serving
NG-RAN node provides RAN Paging area information. The serving NG-RAN node may
also provide RAN Paging attempt information. Each paged NG-RAN node receives
the same RAN Paging attempt information during a paging attempt with the
following content: Paging Attempt Count, the intended number of paging
attempts and the Next Paging Area Scope. The Paging Attempt Count shall be
increased by one at each new paging attempt. The Next Paging Area Scope, when
present, indicates whether the serving NG_RAN node plans to modify the RAN
Paging Area currently selected at next paging attempt. If the UE leaves
RRC_INACTIVE state the Paging Attempt Count is reset.
### 9.2.6 Random Access Procedure
The random access procedure is triggered by a number of events:
\- Initial access from RRC_IDLE;
\- RRC Connection Re-establishment procedure;
\- DL or UL data arrival during RRC_CONNECTED when UL synchronisation status
is \"non-synchronised\";
\- UL data arrival during RRC_CONNECTED when there are no PUCCH resources for
SR available;
\- SR failure;
\- Request by RRC upon synchronous reconfiguration (e.g. handover);
\- Transition from RRC_INACTIVE;
\- To establish time alignment for a secondary TAG;
\- Request for Other SI (see clause 7.3);
\- Beam failure recovery.
Furthermore, the random access procedure takes two distinct forms: contention-
based random access (CBRA) and contention-free random access (CFRA) as shown
on Figure 9.2.6-1 below:
(a) Contention-Based (b) Contention-Free
Figure 9.2.6-1: Random Access Procedures
For random access in a cell configured with SUL, the network can explicitly
signal which carrier to use (UL or SUL). Otherwise, the UE selects the SUL
carrier if and only if the measured quality of the DL is lower than a
broadcast threshold. Once started, all uplink transmissions of the random
access procedure remain on the selected carrier.
When CA is configured, the first three steps of CBRA always occur on the PCell
while contention resolution (step 4) can be cross-scheduled by the PCell. The
three steps of a CFRA started on the PCell remain on the PCell. CFRA on SCell
can only be initiated by the gNB to establish timing advance for a secondary
TAG: the procedure is initiated by the gNB with a PDCCH order (step 0) that is
sent on an activated SCell of the secondary TAG, preamble transmission (step
1) takes place on the SCell, and Random Access Response (step 2) takes place
on PCell.
### 9.2.7 Radio Link Failure
In RRC_CONNECTED, the UE performs Radio Link Monitoring (RLM) in the active
BWP based on reference signals (SSB/CSI-RS) and signal quality thresholds
configured by the network. SSB-based RLM is based on the SSB associated to the
initial DL BWP and can only be configured for the initial DL BWP and for DL
BWPs containing the SSB associated to the initial DL BWP. For other DL BWPs,
RLM can only be performed based on CSI-RS.
The UE declares Radio Link Failure (RLF) when one of the following criteria
are met:
\- Expiry of a timer started after indication of radio problems from the
physical layer (if radio problems are recovered before the timer is expired,
the UE stops the timer); or
\- Random access procedure failure; or
\- RLC failure.
After RLF is declared, the UE:
\- stays in RRC_CONNECTED;
\- selects a suitable cell and then initiates RRC re-establishment;
\- enters RRC_IDLE if a suitable cell was not found within a certain time
after RLF was declared.
### 9.2.8 Beam failure detection and recovery
For beam failure detection, the gNB configures the UE with beam failure
detection reference signals (SSB or CSI-RS) and the UE declares beam failure
when the number of beam failure instance indications from the physical layer
reaches a configured threshold before a configured timer expires.
SSB-based Beam Failure Detection is based on the SSB associated to the initial
DL BWP and can only be configured for the initial DL BWPs and for DL BWPs
containing the SSB associated to the initial DL BWP. For other DL BWPs, Beam
Failure Detection can only be performed based on CSI-RS.
After beam failure is detected, the UE:
\- triggers beam failure recovery by initiating a Random Access procedure on
the PCell;
\- selects a suitable beam to perform beam failure recovery (if the gNB has
provided dedicated Random Access resources for certain beams, those will be
prioritized by the UE).
Upon completion of the Random Access procedure, beam failure recovery is
considered complete.
### 9.2.9 Timing Advance
In RRC_CONNECTED, the gNB is responsible for maintaining the timing advance to
keep the L1 synchronised. Serving cells having UL to which the same timing
advance applies and using the same timing reference cell are grouped in a TAG.
Each TAG contains at least one serving cell with configured uplink, and the
mapping of each serving cell to a TAG is configured by RRC.
For the primary TAG the UE uses the PCell as timing reference. In a secondary
TAG, the UE may use any of the activated SCells of this TAG as a timing
reference cell, but should not change it unless necessary.
Timing advance updates are signalled by the gNB to the UE via MAC CE commands.
Such commands restart a TAG-specific timer which indicates whether the L1 can
be synchronised or not: when the timer is running, the L1 is considered
synchronised, otherwise, the L1 is considered non-synchronised (in which case
uplink transmission can only take place on PRACH).
## 9.3 Inter RAT
### 9.3.1 Intra 5GC
#### 9.3.1.1 Cell Reselection
Cell reselection is characterised by the following:
\- Cell reselection between NR RRC_IDLE and E-UTRA RRC_IDLE is supported;
\- Cell reselection from NR RRC_INACTIVE to E-UTRA RRC_IDLE is supported.
#### 9.3.1.2 Handover
Inter RAT mobility is characterised by the following:
\- The Source RAT configures Target RAT measurement and reporting.
\- The source RAT decides on the preparation initiation and provides the
necessary information to the target RAT in the format required by the target
RAT:
\- For handover preparation from E-UTRA to NR, the source RAT issues a
handover preparation request message to the target RAT passing a transparent
RRC container with necessary information to prepare the handover at the target
side. The information for the target RAT is the same type as specified in
clause 9.2.3.2.1 including the current QoS flow to DRB mapping applied to the
UE and RRM configuration.
\- The details of RRM configuration are the same type as specified for NR in
clause 9.2.3.2.1 including beam measurement information for the listed cells
if the measurements are available.
\- Radio resources are prepared in the target RAT before the handover.
\- The RRC reconfiguration message from the target RAT is delivered to the
source RAT via a transparent container, and is passed to the UE by the source
RAT in the handover command:
\- The inter-RAT handover command message carries the same type of information
required to access the target cell as specified for NR baseline handover in
clause 9.2.3.2.1.
\- The in-sequence and lossless handover is supported for the handover between
gNB and ng-eNB.
\- Both Xn and NG based inter-RAT handover between NG-RAN nodes is supported.
Whether the handover is over Xn or CN is transparent to the UE.
\- In order to keep the SDAP and PDCP configurations for in-sequence and
lossless inter-RAT handover, delta-configuration for the radio bearer
configuration is used.
#### 9.3.1.3 Measurements
Inter RAT measurements in NR are limited to E-UTRA.
For a UE configured with E-UTRA Inter RAT measurements, a measurement gap
configuration is always provided when:
\- The UE only supports per-UE measurement gaps; or
\- The UE supports per-FR measurement gaps and at least one of the NR serving
cells is in FR1.
### 9.3.2 From 5GC to EPC
#### 9.3.2.1 Cell Reselection
Cell reselection is characterised by the following:
\- Cell reselection between NR RRC_IDLE and E-UTRA RRC_IDLE is supported;
\- Cell reselection from NR RRC_INACTIVE to E-UTRA RRC_IDLE is supported.
#### 9.3.2.2 Handover and redirection
The source NG-RAN node decides between handover or redirection to EPS based on
radio criteria and availability of the N26 interface.
NOTE: Information about the availability of the N26 interface may be
configured by OAM at the NG-RAN.
Inter RAT handover is characterised by the following:
\- The Source RAT configures Target RAT measurement and reporting.
\- The source RAT decides on the preparation initiation and provides the
necessary information to the target RAT in the format required by the target
RAT.
\- Radio resources are prepared in the target RAT before the handover.
\- The RRC reconfiguration message from the target RAT is delivered to the
source RAT via a transparent container, and is passed to the UE by the source
RAT in the handover command.
\- In-sequence and lossless handovers are not supported.
\- Security procedures for handover to E-UTRA/EPC should follow legacy inter-
RAT handover procedures.
#### 9.3.2.3 Measurements
Inter RAT measurements in NR are limited to E-UTRA.
For a UE configured with E-UTRA Inter RAT measurements, a measurement gap
configuration is always provided when:
\- The UE only supports per-UE measurement gaps; or
\- The UE supports per-FR measurement gaps and at least one of the NR serving
cells is in FR1.
#### 9.3.2.4 Data Forwarding for the Control Plane
Control plane handling for inter-System data forwarding from 5GS to EPS
follows the following key principles:
\- PDU session information at the serving NG-RAN node contains mapping
information per QoS Flow to a corresponding E-RAB.
\- At handover preparation, the source NG-RAN node shall decide which mapped
E-RABs are proposed to be subject to data forwarding and provide this
information in the source-to-target container to the target eNB.
\- The target eNB assigns forwarding TEID/TNL address(es) for the E-RAB(s) for
which it accepts data forwarding.
\- A single data forwarding tunnel is established between the source NG-RAN
node and UPF per PDU session for which at least data for a single QoS Flow is
subject to data forwarding.
#### 9.3.2.5 Data Forwarding for the User Plane
User plane handling for inter-System data forwarding from 5GS to EPS follows
the following key principles:
\- For the QoS flows accepted for data forwarding, the NG-RAN node initiates
data forwarding to the UPF by the corresponding PDU session data forwarding
tunnel(s).
\- The UPF maps forwarded data received from the per PDU session data
forwarding tunnel(s) to the mapped EPS bearer(s) removing the QFI.
Handling of end marker packets:
The source NG-RAN node receives one or several end marker packets per PDU
session from the UPF. When there are no more data packets to be forwarded for
QoS flows mapped to an E-RAB, the source NG-RAN node sends one or several end
markers including one QFI (by means of the PDU Session User Plane protocol TS
38.415 [30]) of those QoS flows mapped to that E-RAB and sends the end marker
packets to the UPF over the PDU session tunnel. From the included QFI in the
end markers and its mapping to an EPS bearer ID, the UPF knows which EPS
bearer tunnel it needs to forward the end-markers to the SGW. The QFI is
removed in the end marker packets sent to the SGW.
### 9.3.3 From EPC to 5GC
#### 9.3.3.1 Data Forwarding for the Control Plane
Control plane handling for inter-System data forwarding from EPS to 5GS
follows the following key principles:
\- The target NG-RAN node receives in the Handover Request message the mapping
between E-RAB ID(s) and QoS Flow ID(s). It decides whether to accept the data
forwarding for E-RAB IDs proposed for forwarding within the Source NG-RAN Node
to Target NG-RAN Node Transparent Container. It assigns a TEID/TNL address for
each PDU session for which at least one QoS flow is involved in the accepted
forwarding.
\- The target NG-RAN node sends the Handover Request Acknowledge message in
which it indicates the list of PDU sessions and QoS flows for which it has
accepted the forwarding.
\- A single data forwarding tunnel is established between the UPF and the
target NG-RAN node per PDU session for which at least data for a single QoS
Flow is subject to data forwarding.
\- The source eNB receives in the Handover Command message the list of E-RAB
IDs for which the target NG-RAN node has accepted data forwarding of
corresponding PDU sessions and QoS flows.
#### 9.3.3.2 Data Forwarding for the User Plane
User plane handling for inter-System data forwarding from EPS to 5GS follows
the following key principles:
\- For each E-RAB accepted for data forwarding, the source eNB forwards data
to the SGW in the corresponding E-RAB tunnel and the SGW forwards the received
data to the UPF in the E-RAB tunnel.
\- The UPF maps the forwarded data received from an E-RAB tunnel to the
corresponding mapped PDU session tunnel, adding a QFI value (by means of the
PDU Session User Plane protocol TS 38.415 [30]).
\- The target NG-RAN node maps a forwarded packet to the corresponding DRB
based on the received QFI value. It prioritizes the forwarded packets over the
fresh packets for those QoS flows.
Handling of end marker packets:
The UPF/PGW-U sends one or several end marker packets to the SGW per EPS
bearer. The SGW forwards the received end markers per EPS bearer to the source
eNB. When there are no more data packets to be forwarded for an E-RAB, the
source eNB forwards the received end markers in the EPS bearer tunnel to the
SGW and the SGW forwards them to the UPF. The UPF adds one QFI (by means of
the PDU Session User Plane protocol TS 38.415 [30]) among the QoS flows mapped
to that E-RAB to the end markers and sends those end markers to the target NG-
RAN node in the per PDU session tunnel. When the target NG-RAN node receives
an end marker with a QFI added, the target NG-RAN node starts to transmit the
data packets of all QoS flows mapped to the corresponding E-RAB received from
the core network towards the UE.
## 9.4 Roaming and Access Restrictions
The roaming and access restriction information for a UE includes information
on restrictions to be applied for subsequent mobility action during CM-
CONNECTED state. It may be provided by the AMF and also may be updated by the
AMF later.
It includes the forbidden RAT, the forbidden area and the service area
restrictions as specified in TS 23.501 [3]. It also includes serving PLMN and
may include a list of equivalent PLMNs.
Upon receiving the roaming and access restriction information for a UE, if
applicable, the gNB should use it to determine whether to apply restriction
handling for subsequent mobility action, e.g., handover, redirection.
If the roaming and access restriction information is not available for a UE at
the gNB, the gNB shall consider that there is no restriction for subsequent
mobility actions.
Only if received over NG or Xn signalling, the roaming and access restriction
information shall be propagated over Xn by the source gNB during Xn handover.
If the Xn handover results in a change of serving PLMN (to an equivalent
PLMN), the source gNB shall replace the serving PLMN with the identity of the
target PLMN and move the serving PLMN to the equivalent PLMN list, before
propagating the roaming and access restriction information.
If NG-RAN nodes with different versions of the XnAP or NGAP protocol are
deployed, information provided by the 5GC within the NGAP Mobility Restriction
List may be lost in the course of Xn mobility. In order to avoid such loss of
information at Xn handover or UE context retrieval due to a source NG-RAN node
or an old NG-RAN node not able to recognise the entire content, the source NG-
RAN node or the old NG-RAN node may provide an 5GC Mobility Restriction List
Container to the target NG-RAN node or the new NG-RAN node, containing the
Mobility Restriction List as received from the 5GC. The target NG-RAN node or
the new NG-RAN node shall use the information contained in the 5GC Mobility
Restriction List Container as the Mobility Restriction List, except for the
Serving PLMN and the Equivalent PLMNs, which the NG-RAN node shall use from
the XnAP Mobility Restriction List. The 5GC Mobility Restriction List
Container may be propagated at future Xn handover and UE context retrieval.
# 10 Scheduling
## 10.1 Basic Scheduler Operation
In order to utilise radio resources efficiently, MAC in gNB includes dynamic
resource schedulers that allocate physical layer resources for the downlink
and the uplink. In this clause, an overview of the scheduler is given in terms
of scheduler operation, signalling of scheduler decisions, and measurements.
Scheduler Operation:
\- Taking into account the UE buffer status and the QoS requirements of each
UE and associated radio bearers, schedulers assign resources between UEs;
\- Schedulers may assign resources taking account the radio conditions at the
UE identified through measurements made at the gNB and/or reported by the UE;
\- Resource assignment consists of radio resources (resource blocks).
Signalling of Scheduler Decisions:
\- UEs identify the resources by receiving a scheduling (resource assignment)
channel.
Measurements to Support Scheduler Operation:
\- Uplink buffer status reports (measuring the data that is buffered in the
logical channel queues in the UE) are used to provide support for QoS-aware
packet scheduling;
\- Power headroom reports (measuring the difference between the nominal UE
maximum transmit power and the estimated power for uplink transmission) are
used to provide support for power aware packet scheduling.
## 10.2 Downlink Scheduling
In the downlink, the gNB can dynamically allocate resources to UEs via the
C-RNTI on PDCCH(s). A UE always monitors the PDCCH(s) in order to find
possible assignments when its downlink reception is enabled (activity governed
by DRX when configured). When CA is configured, the same C-RNTI applies to all
serving cells.
The gNB may pre-empt an ongoing PDSCH transmission to one UE with a latency-
critical transmission to another UE. The gNB can configure UEs to monitor
interrupted transmission indications using INT-RNTI on a PDCCH. If a UE
receives the interrupted transmission indication, the UE may assume that no
useful information to that UE was carried by the resource elements included in
the indication, even if some of those resource elements were already scheduled
to this UE.
In addition, with Semi-Persistent Scheduling (SPS), the gNB can allocate
downlink resources for the initial HARQ transmissions to UEs: RRC defines the
periodicity of the configured downlink assignments while PDCCH addressed to
CS-RNTI can either signal and activate the configured downlink assignment, or
deactivate it; i.e. a PDCCH addressed to CS-RNTI indicates that the downlink
assignment can be implicitly reused according to the periodicity defined by
RRC, until deactivated.
NOTE: When required, retransmissions are explicitly scheduled on PDCCH(s).
The dynamically allocated downlink reception overrides the configured downlink
assignment in the same serving cell, if they overlap in time. Otherwise a
downlink reception according to the configured downlink assignment is assumed,
if activated.
When CA is configured, at most one configured downlink assignment can be
signalled per serving cell. When BA is configured, at most one configured
downlink assignment can be signalled per BWP. On each serving cell, there can
be only one configured downlink assignment active at a time. Activation and
deactivation of configured downlink assignments are independent among the
serving cells.
## 10.3 Uplink Scheduling
In the uplink, the gNB can dynamically allocate resources to UEs via the
C-RNTI on PDCCH(s). A UE always monitors the PDCCH(s) in order to find
possible grants for uplink transmission when its downlink reception is enabled
(activity governed by DRX when configured). When CA is configured, the same
C-RNTI applies to all serving cells.
In addition, with Configured Grants, the gNB can allocate uplink resources for
the initial HARQ transmissions to UEs. Two types of configured uplink grants
are defined:
\- With Type 1, RRC directly provides the configured uplink grant (including
the periodicity).
\- With Type 2, RRC defines the periodicity of the configured uplink grant
while PDCCH addressed to CS-RNTI can either signal and activate the configured
uplink grant, or deactivate it; i.e. a PDCCH addressed to CS-RNTI indicates
that the uplink grant can be implicitly reused according to the periodicity
defined by RRC, until deactivated.
The dynamically allocated uplink transmission overrides the configured uplink
grant in the same serving cell, if they overlap in time. Otherwise an uplink
transmission according to the configured uplink grant is assumed, if
activated.
Retransmissions other than repetitions are explicitly allocated via PDCCH(s).
When CA is configured, at most one configured uplink grant can be signalled
per serving cell. When BA is configured, at most one configured uplink grant
can be signalled per BWP. On each serving cell, there can be only one
configured uplink grant active at a time. A configured uplink grant for one
serving cell can either be of Type 1 or Type 2. For Type 2, activation and
deactivation of configured uplink grants are independent among the serving
cells. When SUL is configured, a configured uplink grant can only be signalled
for one of the 2 ULs of the cell.
## 10.4 Measurements to Support Scheduler Operation
Measurement reports are required to enable the scheduler to operate in both
uplink and downlink. These include transport volume and measurements of a UEs
radio environment.
Uplink buffer status reports (BSR) are needed to provide support for QoS-aware
packet scheduling. In NR, uplink buffer status reports refer to the data that
is buffered in for a group of logical channels (LCG) in the UE. Eight LCGs and
two formats are used for reporting in uplink:
\- A short format to report only one BSR (of one LCG);
\- A flexible long format to report several BSRs (up to all eight LCGs).
Uplink buffer status reports are transmitted using MAC signalling. When a BSR
is triggered (e.g. when new data arrives in the transmission buffers of the
UE), a Scheduling Request (SR) can be transmitted by the UE (e.g. when no
resources are available to transmit the BSR).
Power headroom reports (PHR) are needed to provide support for power-aware
packet scheduling. In NR, three types of reporting are supported: a first one
for PUSCH transmission, a second one for PUSCH and PUCCH transmission in an
LTE Cell Group in EN-DC (see TS 37.340 [21]) and a third one for SRS
transmission on SCells configured with SRS only. In case of CA, when no
transmission takes place on an activated SCell, a reference power is used to
provide a virtual report. Power headroom reports are transmitted using MAC
signalling.
## 10.5 Rate Control
### 10.5.1 Downlink
In downlink, for GBR flows, the gNB guarantees the GFBR and ensures that the
MFBR is not exceeded while for non-GBR flows, it ensures that the UE-AMBR is
not exceeded (see clause 12). When configured for a GBR flow, the gNB also
ensures that the MDBV is not exceeded.
### 10.5.2 Uplink
The UE has an uplink rate control function which manages the sharing of uplink
resources between logical channels. RRC controls the uplink rate control
function by giving each logical channel a priority, a prioritised bit rate
(PBR), and a buffer size duration (BSD). The values signalled need not be
related to the ones signalled via NG to the gNB. In addition, mapping
restrictions can be configured (see clause 16.1.2).
The uplink rate control function ensures that the UE serves the logical
channel(s) in the following sequence:
1\. All relevant logical channels in decreasing priority order up to their
PBR;
2\. All relevant logical channels in decreasing priority order for the
remaining resources assigned by the grant.
NOTE 1: In case the PBRs are all set to zero, the first step is skipped and
the logical channels are served in strict priority order: the UE maximises the
transmission of higher priority data.
NOTE 2: The mapping restrictions tell the UE which logical channels are
relevant for the grant received. If no mapping restrictions are configured,
all logical channels are considered.
NOTE 3: Through radio protocol configuration and scheduling, the gNB can
guarantee the GFBR(s) and ensure that neither the MFBR(s) nor the UE-AMBR are
exceeded in uplink (see clause 12).
NOTE 4: The mapping restrictions allows the gNB to fulfil the MDBV
requirements through scheduling at least for the case where logical channels
are mapped to separate serving cells.
If more than one logical channel have the same priority, the UE shall serve
them equally.
## 10.6 Activation/Deactivation Mechanism
To enable reasonable UE battery consumption when CA is configured, an
activation/deactivation mechanism of Cells is supported. When an SCell is
deactivated, the UE does not need to receive the corresponding PDCCH or PDSCH,
cannot transmit in the corresponding uplink, nor is it required to perform CQI
measurements. Conversely, when an SCell is active, the UE shall receive PDSCH
and PDCCH (if the UE is configured to monitor PDCCH from this SCell) and is
expected to be able to perform CQI measurements. NG-RAN ensures that while
PUCCH SCell (a Secondary Cell configured with PUCCH) is deactivated, SCells of
secondary PUCCH group (a group of SCells whose PUCCH signalling is associated
with the PUCCH on the PUCCH SCell) should not be activated. NG-RAN ensures
that SCells mapped to PUCCH SCell are deactivated before the PUCCH SCell is
changed or removed.
When reconfiguring the set of serving cells:
\- SCells added to the set are initially deactivated;
\- SCells which remain in the set (either unchanged or reconfigured) do not
change their activation status (_activated_ or _deactivated_).
At handover:
\- SCells are deactivated.
To enable reasonable UE battery consumption when BA is configured, only one UL
BWP for each uplink carrier and one DL BWP or only one DL/UL BWP pair can be
active at a time in an active serving cell, all other BWPs that the UE is
configured with being deactivated. On deactivated BWPs, the UE does not
monitor the PDCCH, does not transmit on PUCCH, PRACH and UL-SCH.
## 10.7 E-UTRA-NR Cell Resource Coordination
An NR cell may use spectrum that overlaps or is adjacent to spectrum in use
for E-UTRA cells. In this case network signalling enables coordination of TDM
and FDM cell resources between MAC in the gNB and the corresponding entity in
the ng-eNB. Both the gNB and the ng-eNB can trigger the E-UTRA - NR Cell
Resource Coordination procedure over Xn to its peer node.
## 10.8 Cross Carrier Scheduling
Cross-carrier scheduling with the Carrier Indicator Field (CIF) allows the
PDCCH of a serving cell to schedule resources on another serving cell but with
the following restrictions:
\- Cross-carrier scheduling does not apply to PCell i.e. PCell is always
scheduled via its PDCCH;
\- When an SCell is configured with a PDCCH, that cell\'s PDSCH and PUSCH are
always scheduled by the PDCCH on this SCell;
\- When an SCell is not configured with a PDCCH, that SCell\'s PDSCH and PUSCH
are always scheduled by a PDCCH on another serving cell;
\- The scheduling PDCCH and the scheduled PDSCH/PUSCH are using the same
numerology.
# 11 UE Power Saving
The PDCCH monitoring activity of the UE in RRC connected mode is governed by
DRX and BA.
When DRX is configured, the UE does not have to continuously monitor PDCCH.
DRX is characterized by the following:
\- **on-duration** : duration that the UE waits for, after waking up, to
receive PDCCHs. If the UE successfully decodes a PDCCH, the UE stays awake and
starts the inactivity timer;
\- **inactivity-timer** : duration that the UE waits to successfully decode a
PDCCH, from the last successful decoding of a PDCCH, failing which it can go
back to sleep. The UE shall restart the inactivity timer following a single
successful decoding of a PDCCH for a first transmission only (i.e. not for
retransmissions);
\- **retransmission-timer** : duration until a retransmission can be expected;
\- **cycle** : specifies the periodic repetition of the on-duration followed
by a possible period of inactivity (see figure 11-1 below);
**\- active-time** : total duration that the UE monitors PDCCH. This includes
the \"on-duration\" of the DRX cycle, the time UE is performing continuous
reception while the inactivity timer has not expired, and the time when the UE
is performing continuous reception while waiting for a retransmission
opportunity.
Figure 11-1: DRX Cycle
When BA is configured, the UE only has to monitor PDCCH on the one active BWP
i.e. it does not have to monitor PDCCH on the entire DL frequency of the cell.
A BWP inactivity timer (independent from the DRX inactivity-timer described
above) is used to switch the active BWP to the default one: the timer is
restarted upon successful PDCCH decoding and the switch to the default BWP
takes place when it expires.
# 12 QoS
## 12.1 Overview
The **5G QoS model** is based on QoS Flows (see TS 23.501 [3]) and supports
both QoS Flows that require guaranteed flow bit rate (GBR QoS Flows) and QoS
Flows that do not require guaranteed flow bit rate (non-GBR QoS Flows). At NAS
level (see TS 23.501 [3]), the QoS flow is thus the finest granularity of QoS
differentiation in a PDU session. A QoS flow is identified within a PDU
session by a QoS Flow ID (QFI) carried in an encapsulation header over NG-U.
The **QoS architecture** in NG-RAN, both for NR connected to 5GC and for
E-UTRA connected to 5GC, is depicted in the Figure 12-1 and described in the
following:
\- For each UE, 5GC establishes one or more PDU Sessions;
\- For each UE, the NG-RAN establishes at least one Data Radio Bearers (DRB)
together with the PDU Session and additional DRB(s) for QoS flow(s) of that
PDU session can be subsequently configured (it is up to NG-RAN when to do so);
\- The NG-RAN maps packets belonging to different PDU sessions to different
DRBs;
\- NAS level packet filters in the UE and in the 5GC associate UL and DL
packets with QoS Flows;
\- AS-level mapping rules in the UE and in the NG-RAN associate UL and DL QoS
Flows with DRBs.
Figure 12-1: QoS architecture
NG-RAN and 5GC ensure quality of service (e.g. reliability and target delay)
by mapping packets to appropriate QoS Flows and DRBs. Hence there is a 2-step
mapping of IP-flows to QoS flows (NAS) and from QoS flows to DRBs (Access
Stratum).
At **NAS level** , a QoS flow is characterised by a QoS profile provided by
5GC to NG-RAN and QoS rule(s) provided by 5GC to the UE. The QoS profile is
used by NG-RAN to determine the treatment on the radio interface while the QoS
rules dictates the mapping between uplink User Plane traffic and QoS flows to
the UE. A QoS flow may either be GBR or Non-GBR depending on its profile. The
QoS profile of a QoS flow contains QoS parameters, for instance (see TS 23.501
[3]):
\- For each QoS flow:
\- A 5G QoS Identifier (5QI);
\- An Allocation and Retention Priority (ARP).
\- In case of a GBR QoS flow only:
\- Guaranteed Flow Bit Rate (GFBR) for both uplink and downlink;
\- Maximum Flow Bit Rate (MFBR) for both uplink and downlink;
\- Maximum Packet Loss Rate for both uplink and downlink;
\- Delay Critical Resource Type;
\- Notification Control.
NOTE: The Maximum Packet Loss Rate (UL, DL) is only provided for a GBR QoS
flow belonging to voice media.
\- In case of Non-GBR QoS only:
\- Reflective QoS Attribute (RQA): the RQA, when included, indicates that some
(not necessarily all) traffic carried on this QoS flow is subject to
reflective quality of service (RQoS) at NAS;
\- Additional QoS Flow Information.
The QoS parameter Notification Control indicates whether notifications are
requested from the RAN when the GFBR can no longer (or again) be fulfilled for
a QoS Flow. If, for a given GBR QoS Flow, notification control is enabled and
the RAN determines that the GFBR cannot be guaranteed, RAN shall send a
notification towards SMF and keep the QoS Flow (i.e. while the NG-RAN is not
delivering the requested GFBR for this QoS Flow), unless specific conditions
at the NG-RAN require the release of the NG-RAN resources for this GBR QoS
Flow, e.g. due to Radio link failure or RAN internal congestion. When
applicable, NG-RAN sends a new notification, informing SMF that the GFBR can
be guaranteed again.
In addition, an Aggregate Maximum Bit Rate is associated to each PDU session
(Session-AMBR) and to each UE (UE-AMBR). The Session-AMBR limits the aggregate
bit rate that can be expected to be provided across all Non-GBR QoS Flows for
a specific PDU Session and is ensured by the UPF. The UE-AMBR limits the
aggregate bit rate that can be expected to be provided across all Non-GBR QoS
Flows of a UE and is ensured by the RAN (see clause 10.5.1).
The 5QI is associated to QoS characteristics giving guidelines for setting
node specific parameters for each QoS Flow. Standardized or pre-configured 5G
QoS characteristics are derived from the 5QI value and are not explicitly
signalled. Signalled QoS characteristics are included as part of the QoS
profile. The QoS characteristics consist for instance of (see TS 23.501 [3]):
\- Priority level;
\- Packet Delay Budget;
\- Packet Error Rate;
\- Averaging window;
\- Maximum Data Burst Volume.
At **Access Stratum** level, the data radio bearer (DRB) defines the packet
treatment on the radio interface (Uu). A DRB serves packets with the same
packet forwarding treatment. The QoS flow to DRB mapping by NG-RAN is based on
QFI and the associated QoS profiles (i.e. QoS parameters and QoS
characteristics). Separate DRBs may be established for QoS flows requiring
different packet forwarding treatment, or several QoS Flows **belonging to the
same PDU session** can be multiplexed in the same DRB.
In the uplink, the mapping of QoS Flows to DRBs is controlled by mapping rules
which are signalled in two different ways:
\- Reflective mapping: for each DRB, the UE monitors the QFI(s) of the
downlink packets and applies the same mapping in the uplink; that is, for a
DRB, the UE maps the uplink packets belonging to the QoS flows(s)
corresponding to the QFI(s) and PDU Session observed in the downlink packets
for that DRB. To enable this reflective mapping, the NG-RAN marks downlink
packets over Uu with QFI.
\- Explicit Configuration: QoS flow to DRB mapping rules can be explicitly
signalled by RRC.
The UE always applies the latest update of the mapping rules regardless of
whether it is performed via reflecting mapping or explicit configuration.
When a QoS flow to DRB mapping rule is updated, the UE sends an end marker on
the old bearer.
In the downlink, the QFI is signalled by NG-RAN over Uu for the purpose of
RQoS and if neither NG-RAN, nor the NAS (as indicated by the RQA) intend to
use reflective mapping for the QoS flow(s) carried in a DRB, no QFI is
signalled for that DRB over Uu. In the uplink, NG-RAN can configure the UE to
signal QFI over Uu.
For each PDU session, a default DRB may be configured: if an incoming UL
packet matches neither an RRC configured nor a reflective mapping rule, the UE
then maps that packet to the default DRB of the PDU session. For non-GBR QoS
flows, the 5GC may send to the NG-RAN the Additional QoS Flow Information
parameter associated with certain QoS flows to indicate that traffic is likely
to appear more often on them compared to other non-GBR QoS flows established
on the same PDU session.
Within each PDU session, it is up to NG-RAN how to map multiple QoS flows to a
DRB. The NG-RAN may map a GBR flow and a non-GBR flow, or more than one GBR
flow to the same DRB, but mechanisms to optimise these cases are not within
the scope of standardization.
## 12.2 Explicit Congestion Notification
The gNB and the UE support of the Explicit Congestion Notification (ECN) is
specified in clause 5 of [27].
# 13 Security
## 13.1 Overview and Principles
The following principles apply to NR connected to 5GC security, see TS 33.501
[5]:
\- For user data (DRBs), ciphering provides user data confidentiality and
integrity protection provides user data integrity;
\- For RRC signalling (SRBs), ciphering provides signalling data
confidentiality and integrity protection signalling data integrity;
NOTE: Ciphering and integrity protections are optionally configured except for
RRC signalling for which integrity protection is always configured. Ciphering
and integrity protection can be configured per DRB but all DRBs belonging to a
PDU session for which the User Plane Security Enforcement information
indicates that UP integrity protection is required (see TS 23.502 [22]), are
configured with integrity protection.
\- For key management and data handling, any entity processing cleartext shall
be protected from physical attacks and located in a secure environment;
\- The gNB (AS) keys are cryptographically separated from the 5GC (NAS) keys;
\- Separate AS and NAS level Security Mode Command (SMC) procedures are used;
\- A sequence number (COUNT) is used as input to the ciphering and integrity
protection and a given sequence number must only be used once for a given key
(except for identical re-transmission) on the same radio bearer in the same
direction.
The keys are organised and derived as follows:
\- Key for AMF:
\- K~AMF~ is a key derived by ME and SEAF from K~SEAF~.
\- Keys for NAS signalling:
\- K~NASint~ is a key derived by ME and AMF from K~AMF~, which shall only be
used for the protection of NAS signalling with a particular integrity
algorithm;
\- K~NASenc~ is a key derived by ME and AMF from K~AMF~, which shall only be
used for the protection of NAS signalling with a particular encryption
algorithm.
Key for gNB:
\- K~gNB~ is a key derived by ME and AMF from K~AMF~. K~gNB~ is further
derived by ME and source gNB when performing horizontal or vertical key
derivation.
Keys for UP traffic:
\- K~UPenc~ is a key derived by ME and gNB from K~gNB~, which shall only be
used for the protection of UP traffic between ME and gNB with a particular
encryption algorithm;
\- K~UPint~ is a key derived by ME and gNB from K~gNB~, which shall only be
used for the protection of UP traffic between ME and gNB with a particular
integrity algorithm.
Keys for RRC signalling:
\- K~RRCint~ is a key derived by ME and gNB from K~gNB~, which shall only be
used for the protection of RRC signalling with a particular integrity
algorithm;
\- K~RRCenc~ is a key derived by ME and gNB from K~gNB~, which shall only be
used for the protection of RRC signalling with a particular encryption
algorithm.
Intermediate keys:
\- NH is a key derived by ME and AMF to provide forward security.
\- K~gNB~* is a key derived by ME and gNB when performing a horizontal or
vertical key derivation.
The primary authentication enables mutual authentication between the UE and
the network and provide an anchor key called K~SEAF~. From K~SEAF~, K~AMF~ is
created during e.g. primary authentication or NAS key re-keying and key
refresh events. Based on K~AMF~, K~NASint~ and K~NASenc~ are then derived when
running a successful NAS SMC procedure.
Whenever an initial AS security context needs to be established between UE and
gNB, AMF and the UE derive a K~gNB~ and a Next Hop parameter (NH). The K~gNB~
and the NH are derived from the K~AMF~. A NH Chaining Counter (NCC) is
associated with each K~gNB~ and NH parameter. Every K~gNB~ is associated with
the NCC corresponding to the NH value from which it was derived. At initial
setup, the K~gNB~ is derived directly from K~AMF~, and is then considered to
be associated with a virtual NH parameter with NCC value equal to zero. At
initial setup, the derived NH value is associated with the NCC value one. On
handovers, the basis for the K~gNB~ that will be used between the UE and the
target gNB, called K~gNB~*, is derived from either the currently active K~gNB~
or from the NH parameter. If K~gNB~* is derived from the currently active
K~gNB~, this is referred to as a horizontal key derivation and is indicated to
UE with an NCC that does not increase. If the K~gNB~* is derived from the NH
parameter, the derivation is referred to as a vertical key derivation and is
indicated to UE with an NCC increase. Finally, K~RRCint~, K~RRCenc~, K~UPint~
and K~UPenc~ are derived based on K~gNB~ after a new K~gNB~ is derived. This
is depicted on Figure 13.1-1 below:
Figure 13.1-1: 5G Key Derivation
With such key derivation, a gNB with knowledge of a K~gNB~, shared with a UE,
is unable to compute any previous K~gNB~ that has been used between the same
UE and a previous gNB, therefore providing backward security. Similarly, a gNB
with knowledge of a K~gNB~, shared with a UE, is unable to predict any future
K~gNB~ that will be used between the same UE and another gNB after n or more
handovers (since NH parameters are only computable by the UE and the AMF).
The AS SMC procedure is for RRC and UP security algorithms negotiation and RRC
security activation. When AS security context is to be established in the gNB,
the AMF sends the UE 5G security capabilities to the gNB. The gNB chooses the
ciphering algorithm which has the highest priority from its configured list
and is also present in the UE 5G security capabilities. The gNB also chooses
the integrity algorithm which has the highest priority from its configured
list and is also present in the UE 5G security capabilities. The chosen
algorithms are indicated to the UE in the AS SMC and this message is integrity
protected. RRC downlink ciphering (encryption) at the gNB starts after sending
the AS SMC message. RRC uplink deciphering (decryption) at the gNB starts
after receiving and successful verification of the integrity protected AS
security mode complete message from the UE. The UE verifies the validity of
the AS SMC message from the gNB by verifying the integrity of the received
message. RRC uplink ciphering (encryption) at the UE starts after sending the
AS security mode complete message. RRC downlink deciphering (decryption) at
the UE shall start after receiving and successful verification of the AS SMC
message. The RRC Connection Reconfiguration procedure used to add DRBs shall
be performed only after RRC security has been activated as part of the AS SMC
procedure.
The maximum supported data rate for integrity protected DRBs is a UE
capability indicated at NAS layer, with a minimum value of 64 kbps and a
maximum value of the highest data rate supported by the UE. In case of failed
integrity check (i.e. faulty or missing MAC-I), the concerned PDU shall be
discarded by the receiving PDCP entity.
Key refresh is possible for K~gNB~, K~RRC-enc~, K~RRC-int~, K~UP-enc~, and
K~UP-int~ and can be initiated by the gNB when a PDCP COUNTs are about to be
re-used with the same Radio Bearer identity and with the same K~gNB~. Key re-
keying is also possible for the K~gNB~, K~RRC-enc~, K~RRC-int~, K~UP-enc~, and
K~UP-int~ and can be initiated by the AMF when a 5G AS security context
different from the currently active one shall be activated.
## 13.2 Security Termination Points
The table below describes the security termination points.
Table 13.2-1 Security Termination Points
+-------------------+-------------+------------------------+ | | > Ciphering | > Integrity Protection | +-------------------+-------------+------------------------+ | > NAS Signalling | > AMF | > AMF | +-------------------+-------------+------------------------+ | > RRC Signalling | > gNB | > gNB | +-------------------+-------------+------------------------+ | > User Plane Data | > gNB | > gNB | +-------------------+-------------+------------------------+
## 13.3 State Transitions and Mobility
As a general principle, on RRC_IDLE to RRC_CONNECTED transitions, RRC
protection keys and UP protection keys are generated while keys for NAS
protection as well as higher layer keys are assumed to be already available.
These higher layer keys may have been established as a result of an AKA run,
or as a result of a transfer from another AMF during handover or idle mode
mobility see TS 23.502 [22]).
On RRC_CONNECTED to RRC_IDLE transitions, the gNBs deletes the keys it stores
for that UE such that state information for idle mode UEs only has to be
maintained in AMF. It is also assumed that gNB does no longer store state
information about the corresponding UE and deletes the current keys from its
memory. In particular, on connected to idle transitions:
\- The gNB and UE delete NH, K~gNB~, K~RRCint~, K~RRCenc~, K~UPint~ and
K~UPenc~ and related NCC;
\- AMF and UE keeps K~AMF~, K~NASint~ and K~NASenc~ stored.
On mobility with vertical key derivation the NH is further bound to the target
PCI and its frequency ARFCN-DL before it is taken into use as the K~gNB~ in
the target gNB. On mobility with horizontal key derivation the currently
active K~gNB~ is further bound to the target PCI and its frequency ARFCN-DL
before it is taken into use as the K~gNB~ in the target gNB (see clause 13.1).
In both cases, ARFCN-DL is the absolute frequency of SSB of the target PCell.
It is not required to change the AS security algorithms during intra-gNB-CU
handover. If the UE does not receive an indication of new AS security
algorithms during an intra-gNB-CU handover, the UE shall continue to use the
same algorithms as before the handover (see TS 38.331 [12]).
# 14 UE Capabilities
The UE capabilities in NR rely on a hierarchical structure where each
capability parameter is defined per UE, per duplex mode (FDD/TDD), per
frequency range (FR1/FR2), per band, per band combinations, ... as the UE may
support different functionalities depending on those (see TS 38.306 [11]).
NOTE 1: Some capability parameters are always defined per UE (e.g. SDAP, PDCP
and RLC parameters) while some other not always (e.g. MAC and Physical Layer
Parameters).
The UE capabilities in NR do not rely on UE categories: UE categories
associated to fixed peak data rates are only defined for marketing purposes
and not signalled to the network. Instead, the peak data rate for a given set
of aggregated carriers in a band or band combination is the sum of the peak
data rates of each individual carrier in that band or band combination, where
the peak data rate of each individual carrier is computed according to the
capabilities supported for that carrier in the corresponding band or band
combination.
For each block of contiguous serving cells in a band, the set of features
supported thereon is defined in a Feature Set (FS). The UE may indicate
several Feature Sets for a band (also known as feature sets per band) to
advertise different alternative features for the associated block of
contiguous serving cells in that band. The two-dimensional matrix of feature
sets for all the bands of a band combination (i.e. all the feature sets per
band) is referred to as a feature set combination. In a feature set
combination, the number of feature sets per band is equal to the number of
band entries in the corresponding band combination, and all feature sets per
band have the same number of feature sets. Each band combination is linked to
one feature set combination. This is depicted on Figure 14-1 below:
Figure 14-1: Feature Set Combinations
In addition, for some features in intra-band contiguous CA, the UE reports its
capabilities individually per carrier. Those capability parameters are sent in
feature set per component carrier and they are signalled in the corresponding
FSs (per Band) i.e. for the corresponding block of contiguous serving cells in
a band. The capability applied to each individual carrier in a block is
agnostic to the order in which they are signalled in the corresponding FS.
NOTE 2: For intra-band non-contiguous CA, there are as many feature sets per
band signalled as the number of (groups of contiguous) carriers that the UE is
able to aggregate non-contiguously in the corresponding band.
To limit signalling overhead, the gNB can request the UE to provide NR
capabilities for a restricted set of bands. When responding, the UE can skip a
subset of the requested band combinations when the corresponding UE
capabilities are the same.
# 15 Self-Configuration and Self-Optimisation
## 15.1 Definitions
Void.
## 15.2 Void
## 15.3 Self-configuration
### 15.3.1 Dynamic configuration of the NG-C interface
#### 15.3.1.1 Prerequisites
The following prerequisites are assumed:
\- An initial remote IP end point to be used for SCTP initialisation is
provided to the NG-RAN node for each AMF the NG-RAN node is supposed to
connect to.
#### 15.3.1.2 SCTP initialization
NG-RAN establishes the first SCTP (IETF RFC 4960 [23]) using a configured IP
address.
NOTE: The NG-RAN node may use different source and/or destination IP end
point(s) if the SCTP establishment towards one IP end point fails. How the NG-
RAN node gets the remote IP end point(s) and its own IP address are outside
the scope of this specification.
#### 15.3.1.3 Application layer initialization
Once SCTP connectivity has been established, the NG-RAN node and the AMF shall
exchange application level configuration data over NGAP with the NG Setup
procedure, which is needed for these two nodes to interwork correctly on the
NG interface.
\- The NG-RAN node provides the relevant configuration information to the AMF,
which includes list of supported TA(s), etc;
\- The AMF provides the relevant configuration information to the NG-RAN node,
which includes PLMN ID, etc.;
\- When the application layer initialization is successfully concluded, the
dynamic configuration procedure is completed and the NG-C interface is
operational.
After the application layer initialization is successfully completed, the AMF
may add or update or remove SCTP endpoints to be used for NG-C signalling
between the AMF and the NG-RAN node pair as specified in TS 23.501 [3].
### 15.3.2 Dynamic Configuration of the Xn interface
#### 15.3.2.1 Prerequisites
The following prerequisites are necessary:
\- An initial remote IP end point to be used for SCTP initialisation is
provided to the NG-RAN node.
#### 15.3.2.2 SCTP initialization
NG-RAN establishes the first SCTP (IETF RFC 4960 [23]) using a configured IP
address.
NOTE: The NG-RAN node may use different source and/or destination IP end
point(s) if the SCTP establishment towards one IP end point fails.
#### 15.3.2.3 Application layer initialization
Once SCTP connectivity has been established, the NG-RAN node and its candidate
peer NG-RAN node are in a position to exchange application level configuration
data over XnAP needed for the two nodes to interwork correctly on the Xn
interface.
\- The NG-RAN node provides the relevant configuration information to the
candidate NG-RAN node, which includes served cell information.
\- The candidate NG-RAN node provides the relevant configuration information
to the initiating NG-RAN node, which includes served cell information.
\- When the application layer initialization is successfully concluded, the
dynamic configuration procedure is completed and the Xn interface is
operational.
\- The NG-RAN node shall keep neighbouring NG-RAN nodes updated with the
complete list of served cells, or, if requested by the peer NG-RAN node, by a
limited list of served cells, while the Xn interface is operational.
### 15.3.3 Automatic Neighbour Cell Relation Function
#### 15.3.3.1 General
The purpose of ANR function is to relieve the operator from the burden of
manually managing NCRs. Figure 15.3.3.1-1 shows ANR and its environment:
Figure 15.3.3.1-1: Interaction between gNB and OAM due to ANR
The ANR function resides in the gNB and manages the Neighbour Cell Relation
Table (NCRT). Located within ANR, the Neighbour Detection Function finds new
neighbours and adds them to the NCRT. ANR also contains the Neighbour Removal
Function which removes outdated NCRs. The Neighbour Detection Function and the
Neighbour Removal Function are implementation specific.
An existing NCR from a source cell to a target cell means that gNB controlling
the source cell:
a) Knows the global and physical IDs (e.g. NR CGI/NR PCI, ECGI/PCI) of the
target cell.
b) Has an entry in the NCRT for the source cell identifying the target cell.
c) Has the attributes in this NCRT entry defined, either by OAM or set to
default values.
NCRs are cell-to-cell relations, while an Xn link is set up between two gNBs.
Neighbour Cell Relations are unidirectional, while an Xn link is
bidirectional.
NOTE: The neighbour information exchange, which occurs during the Xn Setup
procedure or in the gNB Configuration Update procedure, may be used for ANR
purpose.
The ANR function also allows OAM to manage the NCRT. OAM can add and delete
NCRs. It can also change the attributes of the NCRT. The OAM system is
informed about changes in the NCRT.
#### 15.3.3.2 Intra-system Automatic Neighbour Cell Relation Function
ANR relies on NCGI (see clause 8.2) and ANR reporting of E-UTRA cells as
specified in TS 36.300 [2].
Figure 15.3.3.2-1: Automatic Neighbour Relation Function
Figure 15.3.3.2-1 depicts an example where the NG-RAN node serving cell A has
an ANR function. In RRC_CONNECTED, the NG-RAN node instructs each UE to
perform measurements on neighbour cells. The NG-RAN node may use different
policies for instructing the UE to do measurements, and when to report them to
the NG-RAN node. This measurement procedure is as specified in TS 38.331[12]
and TS 36.331 [29].
1\. The UE sends a measurement report regarding cell B. This report contains
Cell B\'s PCI, but not its NCGI/ECGI.
When the NG-RAN node receives a UE measurement report containing the PCI, the
following sequence may be used.
2\. The NG-RAN node instructs the UE, using the newly discovered PCI as
parameter, to read all the broadcast NCGI(s) /ECGI(s), TAC(s), RANAC(s), PLMN
ID(s) and, for neighbour NR cells, NR frequency band(s). To do so, the NG-RAN
node may need to schedule appropriate idle periods to allow the UE to read the
NCGI/ECGI from the broadcast channel of the detected neighbour cell. How the
UE reads the NCGI/ECGI is specified in TS 38.331 [12] and TS 36.331 [29].
3\. When the UE has found out the new cell\'s NCGI(s) /ECGI(s), the UE reports
all the broadcast NCGI(s)/ECGI(s) to the serving cell NG-RAN node. In
addition, the UE reports all the tracking area code(s), RANAC(s), PLMN IDs
and, for neighbour NR cells, NR frequency band(s), that have been read by the
UE. In case the detected NR cell does not broadcast SIB1, the UE may report
_noSIB1_ indication as specified in TS 38.331 [12].
4\. The NG-RAN node decides to add this neighbour relation, and can use PCI
and NCGI(s)/ECGI(s) to:
a. Lookup a transport layer address to the new NG-RAN node.
b. Update the Neighbour Cell Relation List.
c. If needed, setup a new Xn interface towards this NG-RAN node.
#### 15.3.3.3 Void
#### 15.3.3.4 Void
#### 15.3.3.5 Inter-system Automatic Neighbour Cell Relation Function
For Inter-system ANR, each cell contains an Inter Frequency Search list. This
list contains all frequencies that shall be searched.
Figure 15.3.3.5-1: Automatic Neighbour Relation Function in case of E-UTRAN
detected cell
Figure 15.3.3.5-1 depicts an example where the NG-RAN node serving cell A has
an ANR function. In RRC_CONNECTED, the NG-RAN node instructs a UE to perform
measurements and detect E-UTRA cells connected to EPC. The NG-RAN node may use
different policies for instructing the UE to do measurements, and when to
report them to the NG-RAN node.
1 The NG-RAN node instructs a UE to look for neighbour cells in the target
system. To do so the NG-RAN node may need to schedule appropriate idle periods
to allow the UE to scan all cells in the target sysstem.
2 The UE reports the PCI and carrier frequency of the detected cells in the
target system.
When the NG-RAN node receives UE reports containing PCIs of cell(s) the
following sequence may be used.
3 The NG-RAN node instructs the UE, using the newly discovered PCI as
parameter, to read the ECGI, the TAC and all available PLMN ID(s) of the newly
detected cell in case of E-UTRA detected cells. The UE ignores transmissions
from the serving cell while finding the requested information transmitted in
the broadcast channel of the detected inter-system/inter-frequency neighbour
cell. To do so, the NG-RAN node may need to schedule appropriate idle periods
to allow the UE to read the requested information from the broadcast channel
of the detected inter-system neighbour cell.
4 After the UE has read the requested information in the new cell, it reports
the detected ECGI, TAC, and available PLMN ID(s) to the serving cell NG-RAN
node.
5 The NG-RAN node updates its inter-system NCRT.
### 15.3.4 Xn-C TNL address discovery
If the NG-RAN node is aware of the RAN node ID of the candidate NG-RAN node
(e.g. via the ANR function) but not of a TNL address suitable for SCTP
connectivity, then the NG-RAN node can utilize the 5GC (an AMF it is connected
to) to determine the TNL address as follows:
\- The NG-RAN node sends the UPLINK RAN CONFIGURATION TRANSFER message to the
AMF to request the TNL address of the candidate NG-RAN node, and includes
relevant information such as the source and target RAN node ID.
\- The AMF relays the request by sending the DOWNLINK RAN CONFIGURATION
TRANSFER message to the candidate NG-RAN node identified by the target RAN
node ID.
\- The candidate NG-RAN node responds by sending the UPLINK RAN CONFIGURATION
TRANSFER message containing one or more TNL addresses to be used for SCTP
connectivity with the initiating NG-RAN node, and includes other relevant
information such as the source and target RAN node ID.
\- The AMF relays the response by sending the DOWNLINK CONFIGURATION TRANSFER
message to the initiating NG-RAN node identified by the target RAN node ID.
NOTE: In this version of the specification, it is assumed that the NG-RAN node
is able to determine the gNB ID length of the candidate gNB (e.g. based on OAM
configuration).
## 15.4 Support for Energy Saving
### 15.4.1 General
The aim of this function is to reduce operational expenses through energy
savings.
The function allows, for example in a deployment where capacity boosters can
be distinguished from cells providing basic coverage, to optimize energy
consumption enabling the possibility for an E-UTRA or NR cell providing
additional capacity via single or dual connectivity, to be switched off when
its capacity is no longer needed and to be re-activated on a need basis.
### 15.4.2 Solution description
The solution builds upon the possibility for the NG-RAN node owning a capacity
booster cell to autonomously decide to switch-off such cell to lower energy
consumption (inactive state). The decision is typically based on cell load
information, consistently with configured information. The switch-off decision
may also be taken by O&M.
The NG-RAN node may initiate handover actions in order to off-load the cell
being switched off and may indicate the reason for handover with an
appropriate cause value to support the target node in taking subsequent
actions, e.g. when selecting the target cell for subsequent handovers.
All neighbour NG-RAN nodes are informed by the NG-RAN node owning the
concerned cell about the switch-off actions over the Xn interface, by means of
the NG-RAN node Configuration Update procedure.
All informed nodes maintain the cell configuration data, e.g., neighbour
relationship configuration, also when a certain cell is inactive. If basic
coverage is ensured by NG-RAN node cells, NG-RAN node owning non-capacity
boosting cells may request a re-activation over the Xn interface if capacity
needs in such cells demand to do so. This is achieved via the Cell Activation
procedure. During switch off time period of the boost cell, the NG-RAN node
may prevent idle mode UEs from camping on this cell and may prevent incoming
handovers to the same cell.
The NG-RAN node receiving a request should act accordingly. The switch-on
decision may also be taken by O&M. All peer NG-RAN nodes are informed by the
NG-RAN node owning the concerned cell about the re-activation by an indication
on the Xn interface.
### 15.4.3 O&M requirements
Operators should be able to configure the energy saving function.
The configured information should include:
\- The ability of an NG-RAN node to perform autonomous cell switch-off;
\- The ability of an NG-RAN node to request the re-activation of a configured
list of inactive cells owned by a peer NG-RAN node.
O&M may also configure
\- policies used by the NG-RAN node for cell switch-off decision;
\- policies used by peer NG-RAN nodes for requesting the re-activation of an
inactive cell.
# 16 Verticals Support
## 16.1 URLLC
### 16.1.1 Overview
The support of Ultra-Reliable and Low Latency Communications (URLLC) services
is facilitated by the introduction of the mechanisms described in the
following clauses. Please note however that those mechanisms need not be
limited to the provision of URLLC services. Furthermore, RRC can associate
logical channels with different SR configurations, for instance, to provide
more frequent SR opportunities to URLLC services.
### 16.1.2 LCP Restrictions
With LCP restrictions in MAC, RRC can restrict the mapping of a logical
channel to a subset of the configured cells, numerologies, PUSCH transmission
durations and control whether a logical channel can utilise the resources
allocated by a Type 1 Configured Grant (see clause 10.3). With such
restrictions, it then becomes possible to reserve, for instance, the
numerology with the largest subcarrier spacing and/or shortest PUSCH
transmission duration for URLLC services. Furthermore, RRC can associate
logical channels with different SR configurations, for instance, to provide
more frequent SR opportunities to URLLC services.
### 16.1.3 Packet Duplication
When duplication is configured for a radio bearer by RRC, a secondary RLC
entity is added to the radio bearer to handle the duplicated PDCP PDUs as
depicted on Figure 16.1.3-1, where the logical channel corresponding to the
primary RLC entity is referred to as _the primary logical channel_ , and the
logical channel corresponding to the secondary RLC entity, the _secondary
logical channel_. The two RLC entities have the same RLC mode. Duplication at
PDCP therefore consists in submitting the same PDCP PDUs twice: once to the
primary RLC entity and a second time to the secondary RLC entity. With two
independent transmission paths, packet duplication therefore increases
reliability and reduces latency and is especially beneficial for URLLC
services.
Figure 16.1.3-1: Packet Duplication
NOTE: PDCP control PDUs are not duplicated and always submitted to the primary
RLC entity.
When configuring duplication for a DRB, RRC also sets the state of PDCP
duplication (either activated or deactivated) at the time of
(re-)configuration. After the configuration, the state can then be dynamically
controlled by means of a MAC control element and in DC, the UE applies the MAC
CE commands regardless of their origin (MCG or SCG). When duplication is
configured for an SRB the state is always active and cannot be dynamically
controlled.
When activating duplication for a DRB, NG-RAN should ensure that at least one
serving cell is activated for each logical channel of the DRB; and when the
deactivation of SCells leaves no serving cells activated for a logical channel
of the DRB, NG-RAN should ensure that duplication is also deactivated.
When duplication is activated, the original PDCP PDU and the corresponding
duplicate shall not be transmitted on the same carrier. The primary and
secondary logical channels can either belong to the same MAC entity (referred
to as CA duplication) or to different ones (referred to as DC duplication). In
CA duplication, logical channel mapping restrictions are used in MAC to ensure
that the primary and secondary logical channels are not sent on the same
carrier. When CA duplication is configured for an SRB, one of the logical
channels associated to the SRB is mapped to SpCell.
When duplication is deactivated for a DRB, the secondary RLC entity is not re-
established, the HARQ buffers are not flushed, and the transmitting PDCP
entity should indicate to the secondary RLC entity to discard all duplicated
PDCP PDUs. In addition, in case of CA duplication, the logical channel mapping
restrictions of the primary and secondary logical channels are lifted for as
long as duplication remains deactivated.
When an RLC entity acknowledges the transmission of a PDCP PDU, the PDCP
entity shall indicate to the other RLC entity to discard it. In addition, in
case of CA duplication, when an RLC entity restricted to only SCell(s) reaches
the maximum number of retransmissions for a PDCP PDU, the UE informs the gNB
but does not trigger RLF.
### 16.1.4 CQI and MCS
For channel state reporting, a CQI table for target block error rate 10^-5^ is
introduced.
For scheduling data packets with higher reliability, 64QAM MCS tables
containing entries with lower spectral efficiency are introduced for both
downlink and uplink. The tables are different for CP-OFDM and DFT-s-OFDM. The
MCS tables can be configured semi-statically or dynamically. The dynamic
signalling of MCS table is supported by configuring UE with MCS-C-RNTI, where
the scrambling of DCI CRC by MCS-C-RNTI indicates the 64QAM MCS tables with
entries of lower spectral efficiency.
## 16.2 IMS Voice
### 16.2.0 Support for IMS voice
For IMS voice support in NG-RAN, the following is assumed:
\- Network ability to support IMS voice sessions, i.e. ability to support QoS
flows with 5QI for voice and IMS signalling (see clause 12 and TS 23.501 [3]),
or through EPC System fallback;
\- UE capability to support \"IMS voice over PS\", see TS 24.501 [28].
The capabilities indications check is handled at NAS layer. To maintain the
voice service in NG-RAN, the UE provides additional capabilities over RRC (see
TS 38.331 [12]), that are used to determine accurate NR voice support options.
Further MMTEL IMS voice and video enhancements are facilitated by the
mechanisms described in the following clauses.
### 16.2.1 Support for MMTEL IMS voice and video enhancements
#### 16.2.1.1 RAN-assisted codec adaptation
RAN-assisted codec adaptation provides a means for the gNB to send codec
adaptation indication with recommended bit rate to assist the UE to select or
adapt to a codec rate for MMTEL voice or MMTEL video. The RAN-assisted codec
adaptation mechanism supports the uplink/downlink bit rate increase or
decrease. For a bearer associated with configuration of MBR greater than GBR,
the recommended uplink/downlink bit rate is within boundaries set by the MBR
and GBR of the concerned bearer.
For uplink or downlink bit rate adaptation, gNB may send a recommended bit
rate to the UE to inform the UE on the currently recommended transport bit
rate on the local uplink or downlink, which the UE may use in combination with
other information to adapt the bit rate, e.g. the UE may send a bit rate
request to the peer UE via application layer messages as specified in TS
26.114 [24], which the peer UE may use in combination with other information
to adapt the codec bit rate. The recommended bit rate is in kbps at the
physical layer at the time when the decision is made.
The recommended bit rate for UL and DL is conveyed as a MAC Control Element
(CE) from the gNB to the UE as outlined in Figure 16.2.1.1-1.
Figure 16.2.1.1-1: UL or DL bit rate recommendation
Based on the recommended bit rate from the gNB, a UE may initiate an end-to-
end bit rate adaptation with its peer (UE or MGW). The UE may also send a
query message to its local gNB to check if a bit rate recommended by its peer
can be provided by the gNB. The UE is not expected to go beyond the
recommended bit rate from the gNB.
The recommended bit rate query message is conveyed as a MAC CE from the UE to
the gNB as outlined in Figure 16.2.1.1-2.
Figure 16.2.1.1-2: UL or DL bit rate recommendation query
A prohibit timer can be configured per logical channel by the network to limit
UEs sending frequent query MAC CEs. Independent prohibit timers are used for
each direction (uplink and downlink) to prohibit the UE from retransmitting
exactly the same query MAC CE to the gNB during the configured time.
#### 16.2.1.2 MMTEL voice quality/coverage enhancements
The air interface delay budget can be relaxed to increase the robustness of
the transmission for coverage enhancement. Such relaxation may be achieved
when a UE in good coverage indicates a preference to the gNB to reduce the
local air interface delay by sending a _DelayBudgetReport_ message to decrease
the DRX cycle length, so that the E2E delay and jitter can be reduced. When
the UE detects changes such as end-to-end MMTEL voice quality or local radio
quality, the UE may inform the gNB its new preference by sending
_DelayBudgetReport_ messages with updated contents.
## 16.3 Network Slicing
### 16.3.1 General Principles and Requirements
In this clause, the general principles and requirements related to the
realization of network slicing in the NG-RAN for NR connected to 5GC and for
E-UTRA connected to 5GC are given.
A network slice always consists of a RAN part and a CN part. The support of
network slicing relies on the principle that traffic for different slices is
handled by different PDU sessions. Network can realise the different network
slices by scheduling and also by providing different L1/L2 configurations.
Each network slice is uniquely identified by a S-NSSAI, as defined in TS
23.501 [3]. NSSAI (Network Slice Selection Assistance Information) includes
one or a list of S-NSSAIs (Single NSSAI) where a S-NSSAI is a combination of:
\- mandatory SST (Slice/Service Type) field, which identifies the slice type
and consists of 8 bits (with range is 0-255);
\- optional SD (Slice Differentiator) field, which differentiates among Slices
with same SST field and consist of 24 bits.
The list includes at most 8 S-NSSAI(s).
The UE provides NSSAI (Network Slice Selection Assistance Information) for
network slice selection in _RRCSetupComplete_ , if it has been provided by NAS
(see clause 9.2.1.3). While the network can support large number of slices
(hundreds), the UE need not support more than 8 slices simultaneously.
Network Slicing is a concept to allow differentiated treatment depending on
each customer requirements. With slicing, it is possible for Mobile Network
Operators (MNO) to consider customers as belonging to different tenant types
with each having different service requirements that govern in terms of what
slice types each tenant is eligible to use based on Service Level Agreement
(SLA) and subscriptions.
The following key principles apply for support of Network Slicing in NG-RAN:
**RAN awareness of slices**
\- NG-RAN supports a differentiated handling of traffic for different network
slices which have been pre-configured. How NG-RAN supports the slice enabling
in terms of NG-RAN functions (i.e. the set of network functions that comprise
each slice) is implementation dependent.
**Selection of RAN part of the network slice**
\- NG-RAN supports the selection of the RAN part of the network slice, by
NSSAI provided by the UE or the 5GC which unambiguously identifies one or more
of the pre-configured network slices in the PLMN.
**Resource management between slices**
\- NG-RAN supports policy enforcement between slices as per service level
agreements. It should be possible for a single NG-RAN node to support multiple
slices. The NG-RAN should be free to apply the best RRM policy for the SLA in
place to each supported slice.
**Support of QoS**
\- NG-RAN supports QoS differentiation within a slice.
**RAN selection of CN entity**
\- For initial attach, the UE may provide NSSAI to support the selection of an
AMF. If available, NG-RAN uses this information for routing the initial NAS to
an AMF. If the NG-RAN is unable to select an AMF using this information or the
UE does not provide any such information the NG-RAN sends the NAS signalling
to one of the default AMFs.
\- For subsequent accesses, the UE provides a Temp ID, which is assigned to
the UE by the 5GC, to enable the NG-RAN to route the NAS message to the
appropriate AMF as long as the Temp ID is valid (NG-RAN is aware of and can
reach the AMF which is associated with the Temp ID). Otherwise, the methods
for initial attach applies.
**Resource isolation between slices**
\- The NG-RAN supports resource isolation between slices. NG-RAN resource
isolation may be achieved by means of RRM policies and protection mechanisms
that should avoid that shortage of shared resources in one slice breaks the
service level agreement for another slice. It should be possible to fully
dedicate NG-RAN resources to a certain slice. How NG-RAN supports resource
isolation is implementation dependent.
**Access control**
\- By means of the unified access control (see clause 7.4), operator-defined
access categories can be used to enable differentiated handling for different
slices. NG-RAN may broadcast barring control information (i.e. a list of
barring parameters associated with operator-defined access categories) to
minimize the impact of congested slices.
**Slice Availability**
\- Some slices may be available only in part of the network. The NG-RAN
supported S-NSSAI(s) is configured by OAM. Awareness in the NG-RAN of the
slices supported in the cells of its neighbours may be beneficial for inter-
frequency mobility in connected mode. It is assumed that the slice
availability does not change within the UE\'s registration area.
\- The NG-RAN and the 5GC are responsible to handle a service request for a
slice that may or may not be available in a given area. Admission or rejection
of access to a slice may depend by factors such as support for the slice,
availability of resources, support of the requested service by NG-RAN.
**Support for UE associating with multiple network slices simultaneously**
\- In case a UE is associated with multiple slices simultaneously, only one
signalling connection is maintained and for intra-frequency cell reselection,
the UE always tries to camp on the best cell. For inter-frequency cell
reselection, dedicated priorities can be used to control the frequency on
which the UE camps.
**Granularity of slice awareness**
\- Slice awareness in NG-RAN is introduced at PDU session level, by indicating
the S-NSSAI corresponding to the PDU Session, in all signalling containing PDU
session resource information.
**Validation of the UE rights to access a network slice**
\- It is the responsibility of the 5GC to validate that the UE has the rights
to access a network slice. Prior to receiving the Initial Context Setup
Request message, the NG-RAN may be allowed to apply some provisional/local
policies, based on awareness of which slice the UE is requesting access to.
During the initial context setup, the NG-RAN is informed of the slice for
which resources are being requested.
### 16.3.2 AMF and NW Slice Selection
#### 16.3.2.1 CN-RAN interaction and internal RAN aspects
NG-RAN selects AMF based on a Temp ID or NSSAI provided by the UE over RRC.
The mechanisms used in the RRC protocol are described in the next clause.
Table 16.3.2.1-1 AMF selection based on Temp ID and NSSAI
+----------------------+----------------------+----------------------+ | > Temp ID | > NSSAI | > AMF Selection by | | | | > NG-RAN | +----------------------+----------------------+----------------------+ | > not available or | > not available | > One of the default | | > invalid | | > AMFs is selected | | | | > (NOTE) | +----------------------+----------------------+----------------------+ | > not available or | > present | > Selects AMF which | | > invalid | | > supports UE | | | | > requested slices | +----------------------+----------------------+----------------------+ | > valid | > not available, or | > Selects AMF per CN | | | > present | > identity | | | | > information in | | | | > Temp ID | +----------------------+----------------------+----------------------+ | NOTE: The set of | | | | default AMFs is | | | | configured in the | | | | NG-RAN nodes via | | | | OAM. | | | +----------------------+----------------------+----------------------+
#### 16.3.2.2 Radio Interface Aspects
When triggered by the upper layer, the UE conveys the NSSAI over RRC in the
format explicitly indicated by the upper layer.
### 16.3.3 Resource Isolation and Management
Resource isolation enables specialized customization and avoids one slice
affecting another slice.
Hardware/software resource isolation is up to implementation. Each slice may
be assigned with either shared or dedicated radio resource up to RRM
implementation and SLA.
To enable differentiated handling of traffic for network slices with different
SLA:
\- NG-RAN is configured with a set of different configurations for different
network slices by OAM;
\- To select the appropriate configuration for the traffic for each network
slice, NG-RAN receives relevant information indicating which of the
configurations applies for this specific network slice.
### 16.3.4 Signalling Aspects
#### 16.3.4.1 General
In this clause, signalling flows related to the realization of network slicing
in the NG-RAN are given.
#### 16.3.4.2 AMF and NW Slice Selection
RAN selects the AMF based on a Temp ID or NSSAI provided by the UE.
Figure 16.3.4.2-1: AMF selection
In case a Temp ID is not available, the NG-RAN uses the NSSAI provided by the
UE at RRC connection establishment to select the appropriate AMF (the
information is provided after MSG3 of the random access procedure). If such
information is also not available, the NG-RAN routes the UE to one of the
configured default AMF(s).
The NG-RAN uses the list of supported S-NSSAI(s) previously received in the NG
Setup Response message when selecting the AMF with the NSSAI. This list may be
updated via the AMF Configuration Update message.
#### 16.3.4.3 UE Context Handling
Following the initial access, the establishment of the RRC connection and the
selection of the correct AMF, the AMF establishes the complete UE context by
sending the Initial Context Setup Request message to the NG-RAN over NG-C. The
message contains the Allowed NSSAI and additionally contains the S-NSSAI(s) as
part of the PDU session(s) resource description when present in the message.
Upon successful establishment of the UE context and allocation of PDU session
resources to the relevant network slice(s) when present, the NG-RAN responds
with the Initial Context Setup Response message.
Figure 16.3.4.3-1: Network Slice-aware Initial Context Setup
#### 16.3.4.4 PDU Session Setup Handling
When new PDU sessions need to be established, the 5GC requests the NG-RAN to
allocate/ resources relative to the relevant PDU sessions by means of the PDU
Session Resource Setup procedures over NG-C. One S-NSSAI is added per PDU
session to be established, so NG-RAN is enabled to apply policies at PDU
session level according to the SLA represented by the network slice, while
still being able to apply (for example) differentiated QoS within the slice.
NG-RAN confirms the establishment of the resources for a PDU session
associated to a certain network slice by responding with the PDU Session
Resource Setup Response message over the NG-C interface.
Figure 16.3.4.4-1: Network Slice-aware PDU Session Resource Setup
#### 16.3.4.5 Mobility
To make mobility slice-aware in case of Network Slicing, S-NSSAI is introduced
as part of the PDU session information that is transferred during mobility
signalling. This enables slice-aware admission and congestion control.
Both NG and Xn handovers are allowed regardless of the slice support of the
target NG-RAN node i.e. even if the target NG-RAN node does not support the
same slices as the source NG-RAN node. An example for the case of connected
mode mobility across different Registration Areas is shown in Figure
16.3.4.5-1 for the case of NG based handover and in Figure 16.3.4.5-2 for the
case of Xn based handover.
Figure 16.3.4.5-1: NG based mobility across different Registration Areas
Figure 16.3.4.5-2: Xn based mobility across different Registration Areas
## 16.4 Public Warning System
NR connected to 5GC provides support for public warning systems (PWS) through
means of system information broadcast capability. NR is responsible for
scheduling and broadcasting of the warning messages as well as for paging the
UE to provide indication that the warning message is being broadcast:
\- Earthquake and Tsunami Warning System: ETWS is a public warning system
developed to meet the regulatory requirements for warning notifications
related to earthquake and/or tsunami events (see TS 22.168 [14]). ETWS warning
notifications can either be a primary notification (short notification) or
secondary notification (providing detailed information).
\- Commercial Mobile Alert System: CMAS is a public warning system developed
for the delivery of multiple, concurrent warning notifications (see TS 22.268
[15]).
Different SIBs are defined for ETWS primary notification, ETWS secondary
notification and CMAS notification. Paging is used to inform UEs about ETWS
indication and CMAS indication (see clause 9.2.5). UE monitors ETWS/CMAS
indication in its own paging occasion for RRC_IDLE and RRC_INACTIVE. UE
monitors ETWS/CMAS indication in any paging occasion for RRC Connected. Paging
indicating ETWS/CMAS notification triggers acquisition of system information
(without delaying until the next modification period).
KPAS and EU-Alert are public warning systems developed for the delivery of
multiple, concurrent warning notifications (see TS 22.268 [15]). KPAS and EU-
Alert uses the same AS mechanisms as CMAS. Therefore, the NR procedures
defined for CMAS equally apply for KPAS and EU-Alert.
## 16.5 Emergency Services
### 16.5.1 Overview
NG-RAN provides support for Emergency Services either directly or through
fallback mechanisms towards E-UTRA. The support of Emergency Services is
broadcast in system information (see TS 38.331 [12]).
### 16.5.2 IMS Emergency call
An IMS Emergency call support indication is provided to inform the UE that
emergency bearer services are supported. In normal service state the UE is
informed if the PLMN supports emergency services through an Emergency Service
Support indicator in the Attach and TAU procedures (see TS 23.501 [3]). In
limited service state and for emergency services other than eCall over IMS, a
UE is informed about if a cell supports emergency services over NG-RAN from a
broadcast indication (_ims-EmergencySupport_). The broadcast indicator is set
to \"support\" if any AMF in a non-shared environment or at least one of the
PLMN\'s in a shared environment supports IMS emergency bearer services.
### 16.5.3 eCall over IMS
NG-RAN broadcast an indication to indicate support of eCall over IMS
(_eCallOverIMS-Support_). UEs that are in limited service state need to
consider both _eCallOverIMS-Support_ and _ims-EmergencySupport_ to determine
if eCall over IMS is possible.
### 16.5.4 Fallback
RAT fallback towards E-UTRA connected to 5GC is performed when NR does not
support Emergency Services and System fallback towards E-UTRA connected to EPS
is performed when 5GC does not support Emergency Services. Depending on
factors such as CN interface availability, network configuration and radio
conditions, the fallback procedure results in either CONNECTED state mobility
(handover procedure) or IDLE state mobility (redirection) - see TS 23.501 [3]
and TS 38.331 [12].
###### ## Annex A (informative): QoS Handling in RAN
# A.1 PDU Session Establishment
The following figure shows an example message flow for a PDU session
establishment. NAS procedures details between gNB and 5GC can be found in TS
23.501 [3], TS 23.502 [22] and TS 38.413 [26].
Figure A.1-1: PDU session establishment
1\. UE requests a PDU session establishment to AMF.
2\. AMF sends a PDU SESSION RESOURCE SETUP REQUEST message to gNB, which
includes the NAS message to be sent to the UE with NAS QoS related
information.
3\. gNB sends an _RRCReconfiguration_ message to UE including the
configuration of at least one DRB and the NAS message received at Step 2.
4\. UE establishes the DRB(s) for the new PDU session and creates the QFI to
DRB mapping rules.
5\. UE sends an _RRCReconfiguration_ _Complete_ message to gNB.
6\. gNB sends a PDU SESSION RESOURCE SETUP RESPONSE message to AMF.
7\. User Plane Data can then be exchanged between UE and gNB over DRB(s)
according to the mapping rules and between UPF and gNB over the tunnel for the
PDU session. QFI marking over Uu is optional (see clause 12) while QFI marking
over NG-U is always present.
# A.2 New QoS Flow with RQoS
The following figure shows an example message flow when RQoS is used for a new
QoS flow. In this example, the gNB receives from UPF a first downlink packet
associated with a QFI for which the QoS parameters are known from the PDU
session establishment, but for which there is no association to any DRB yet in
AS.
Figure A.2-1: DL data with new QFI sent over existing DRB
0\. PDU session and DRB(s) have been already established.
1\. gNB receives a downlink packet with a new QFI from UPF.
2\. gNB decides to send the new QoS flow over an existing DRB.
NOTE: If gNB decides to send it over a new DRB, it needs to establish the DRB
first.
3\. gNB sends the DL packet over the selected DRB with the new QFI and RDI set
in the SDAP header.
4\. UE identifies the QFI and RDI in the received DL packet and the DRB on
which the packet was received. The AS mapping rules are then updated
accordingly.
5\. User Plane Data for the new QoS flow can then be exchanged between UE and
gNB over the DRB according to the updated mapping rules and between UPF and
gNB over the tunnel for the PDU session.
# A.3 New QoS Flow with Explicit RRC Signalling
The following figure shows an example message flow when explicit RRC
signalling is used for a new QoS flow. In this example, the gNB receives from
UPF a first downlink packet associated with a QFI, for which the QoS
parameters are already known from the PDU session establishment, but for which
there is no association to any DRB yet in AS.
Figure A.3-1: DL data with new QFI sent over existing DRB
0\. PDU session and DRB(s) have been already established.
1\. gNB receives a downlink packet with a new QFI from UPF.
2\. gNB decides to send the new QoS flow over an existing DRB using explicit
RRC signalling for updating the AS mapping rules.
3\. gNB sends an _RRCReconfiguration_ message to UE with the new QFI to DRB
mapping rule. gNB may also decide to update the DRB configuration if required
to meet the QoS requirements for the new QoS Flow.
4\. UE updates the QFI to DRB mapping rules and configuration (if received).
5\. UE sends an _RRCReconfigurationComplete_ message to gNB.
6\. User Plane Data for the new QoS flow can then be exchanged between UE and
gNB over the DRB according to the updated mapping rules and between UPF and
gNB over the tunnel for the PDU session.
# A.4 New QoS Flow with Explicit NAS Signalling
The following figure shows an example message flow when the gNB receives a new
QoS flow establishment request from CN that involves NAS explicit signalling.
The QoS flow establishment request provides the gNB and UE with the QoS
parameters for the QFI. In this example, the gNB decides to establish a new
DRB (rather than re-use an existing one) for this QoS flow and provides the
mapping rule over RRC signalling. NAS procedures details between gNB and 5GC
can be found in TS 23.501 [3], TS 23.502 [22] and TS 38.413 [26].
Figure A.4-1: DL data with new QoS Flow ID sent over new DRB with explicit
signalling
0\. PDU session DRB(s) have been already established.
1\. gNB receives a PDU SESSION RESOURCE MODIFY REQUEST message from AMF for a
new QoS flow.
2\. If gNB cannot find an existing DRB to map this new QoS flow, it decides to
establish a new DRB.
3\. gNB sends an _RRCReconfiguration_ message to UE including the DRB
configuration with the new QFI to DRB mapping rule and the NAS message
received at step 1.
4\. UE establishes the DRB for the new QoS flow associated with this PDU
session and updates the mapping rules.
5\. UE sends an _RRCReconfigurationComplete_ message to gNB.
6\. gNB sends a PDU SESSION RESOURCE MODIFY RESPONSE message to AMF.
7\. User Plane Data can then be exchanged between UE and gNB over DRB(s)
according to the mapping rules and between UPF and gNB over the tunnel for the
PDU session.
# A.5 Release of QoS Flow with Explicit Signalling
The following figure shows an example message flow when the gNB receives a
request to release a QoS flow from CN that involves explicit NAS signalling.
NAS procedures details between gNB and 5GC can be found in TS 23.501 [3], TS
23.502 [22] and TS 38.413 [26].
Figure A.5-1: Release of QoS Flow with Explicit Signalling
0\. PDU session and DRB(s) have been already established.
1\. gNB receives a PDU SESSION RESOURCE MODIFY REQUEST message from AMF to
release a QoS flow.
2\. The gNB decides to release corresponding the QFI to DRB mapping rule.
Since the DRB also carries other QoS flows, the DRB is not released.
3\. gNB sends an _RRCReconfiguration_ message to UE to release the QFI to DRB
mapping rule.
4\. UE updates the AS QFI to DRB mapping rules to release this QFI to DRB
mapping rule.
5\. UE sends an _RRCReconfigurationC_ omplete message to gNB.
6\. gNB sends a PDU SESSION RESOURCE MODIFY RESPONSE message to AMF.
# A.6 UE Initiated UL QoS Flow
The following figure shows an example message flow when the UE AS receives an
UL packet for a new QoS flow for which a QFI to DRB mapping rule does not
exist.
Figure A.6-1: UL packet with a new QoS flow for which a mapping does not exist
in UE
0\. PDU session and DRBs (including a default DRB) have been already
established.
1\. UE AS receives a packet with a new QFI from UE NAS.
2\. UE uses the QFI of the packet to map it to a DRB. If there is no mapping
of the QFI to a DRB in the AS mapping rules for this PDU session, then the
packet is assigned to the default DRB.
3\. UE sends the UL packet on the default DRB. The UE includes the QFI in the
SDAP header.
4\. gNB sends UL packets to UPF and includes the corresponding QFI.
5\. If gNB wants to use a new DRB for this QoS flow, it sets up one. It can
also choose to move the QoS flow to an existing DRB using RQoS or RRC
signalling (see clauses A.2 and A.3).
6\. User Plane Data for the new QoS flow can then be exchanged between UE and
gNB over the DRB according to the updated mapping rules and between UPF and
gNB over the tunnel for the PDU session.
###### ## Annex B (informative): Deployment Scenarios
# B.1 Supplementary Uplink
To improve UL coverage for high frequency scenarios, SUL can be configured
(see TS 38.101-1 [18]). With SUL, the UE is configured with 2 ULs for one DL
of the same cell as depicted on Figure B.1-1 below:
Figure B.1-1: Example of Supplementary Uplink
# B.2 Multiple SSBs in a carrier
For a UE in RRC_CONNECTED, the BWPs configured by a serving cell may overlap
in the frequency domain with the BWPs configured for other UEs by other cells
within a carrier. Multiple SSBs may also be transmitted within the frequency
span of a carrier used by the serving cell. However, from the UE perspective,
each serving cell is associated to at most a single SSB. Figure B.2-1 below
describes a scenario with multiple SSBs in a carrier, identifying two
different cells (NCGI = 5, associated to SSB1, and NCGI = 6, associated to
SSB3) with overlapping BWPs, and where RRM measurements can be configured to
be performed by the UE on each of the available SSBs, i.e. SSB1, SSB2, SSB3
and SSB4.
Figure B.2-1: Example of multiple SSBs in a carrier
###### ## Annex C (informative): I-RNTI Reference Profiles
The I-RNTI provides the new NG-RAN node a reference to the UE context in the
old NG-RAN node. How the new NG-RAN node is able to resolve the old NG-RAN ID
from the I-RNTI is a matter of proper configuration in the old and new NG-RAN
node.
Table C-1 below provides some typical partitioning of a 40bit I-RNTI, assuming
the following content:
\- **UE specific reference** : reference to the UE context within a logical
NG-RAN node;
\- **NG-RAN node address index** : information to identify the NG-RAN node
that has allocated the UE specific part;
NOTE: **RAT-specific information** may be introduced in a later release,
containing information to identify the RAT of the cell within which the UE was
sent to RRC_INACTIVE. This version of the specification only supports intra-
RAT mobility of UEs in RRC_INACTIVE.
\- **PLMN-specific information** : information supporting network sharing
deployments, providing an index to the PLMN ID part of the Global NG-RAN node
identifier.
Table C-1: I-RNTI reference profiles
+----------+----------+----------+----------+----------+----------+ | Profile | UE | NG-RAN | RAT- | PLMN- | Comment | | ID | specific | node | specific | specific | | | | r | address | inf | inf | | | | eference | index\ | ormation | ormation | | | | | (e.g., | | | | | | | gNB ID, | | | | | | | eNB ID) | | | | +==========+==========+==========+==========+==========+==========+ | 1 | 20 bits | 20 bits | N/A | N/A | NG-RAN | | | | | | | node | | | (\~1 | (\~1 | | | address | | | million | million | | | index | | | values) | values) | | | may be | | | | | | | very | | | | | | | well | | | | | | | rep | | | | | | | resented | | | | | | | by the | | | | | | | LSBs of | | | | | | | the gNB | | | | | | | ID. | | | | | | | | | | | | | | This | | | | | | | profile | | | | | | | may be | | | | | | | ap | | | | | | | plicable | | | | | | | for any | | | | | | | NG-RAN | | | | | | | RAT. | +----------+----------+----------+----------+----------+----------+ | 2 | 20 bits | 16 bits | N/A | 4 bits | Max | | | | | | (Max 16 | number | | | (\~1 | (65.000 | | PLMNs) | of PLMN | | | million | nodes) | | | IDs | | | values) | | | | b | | | | | | | roadcast | | | | | | | in NR is | | | | | | | 12. | | | | | | | | | | | | | | This | | | | | | | profile | | | | | | | may be | | | | | | | ap | | | | | | | plicable | | | | | | | for any | | | | | | | NG-RAN | | | | | | | RAT. | +----------+----------+----------+----------+----------+----------+ | 3 | 24 bits | 16 bits | N/A | N/A | Reduced | | | | | | | node | | | (16 | (65.000 | | | address | | | million | nodes) | | | to | | | values) | | | | maximise | | | | | | | add | | | | | | | ressable | | | | | | | UE | | | | | | | c | | | | | | | ontexts. | | | | | | | | | | | | | | This | | | | | | | profile | | | | | | | may be | | | | | | | ap | | | | | | | plicable | | | | | | | for any | | | | | | | NG-RAN | | | | | | | RAT. | +----------+----------+----------+----------+----------+----------+
###### ## Annex D (informative): SPID ranges and mapping of SPID values to
cell reselection and inter-RAT/inter frequency handover priorities
The SPID values are defined in Annex I of TS 36.300 [2].
From the SPID reference values, only the SPID=253 also applies for 5GC.
###### ## Annex E: NG-RAN Architecture for Radio Access Network Sharing with
multiple cell ID broadcast (informative)
Each NG-RAN node serving a cell identified by a Cell Identity associated with
a subset of PLMNs is connected to another NG-RAN node via a single Xn-C
interface instance.
Each Xn-C interface instance is setup and removed individually.
Xn-C interface instances terminating at NG-RAN nodes which share the same
physical radio resources may share the same signalling transport resources. If
this option is applied:
\- Non-UE associated signalling is associated to an Xn-C interface instance by
including an Interface Instance Indication in the XnAP message;
\- Node related, non-UE associated Xn-C interface signalling may provide
information destined for multiple logical nodes in a single XnAP procedure
instance once the Xn-C interface instance is setup;
NOTE 1: If the Interface Instance Indication corresponds to more than one
interface instance, the respective XnAP message carries information destined
for multiple logical nodes.
\- A UE associated signalling connection is associated to an Xn-C interface
instance by allocating values for the corresponding NG-RAN node UE XnAP IDs so
that they can be mapped to that Xn-C interface instance.
NOTE 2: One possible implementation is to partition the value ranges of the
NG-RAN node UE XnAP IDs and associate each value range with an Xn-C interface
instance.
#