# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present specification provides the stage 3 definition of the Binding
Support Management Service of the 5G System.
The 5G System Architecture is defined in 3GPP TS 23.501 [2]. The stage 2
definition and related procedures for Binding Support Management Service is
specified in 3GPP TS 23.502 [3] and 3GPP TS 23.503 [4].
The 5G System stage 3 call flows are provided in 3GPP TS 29.513 [5].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition are specified in 3GPP TS 29.500 [6] and
3GPP TS 29.501 [7].
The Binding Support Management Service is provided by the Binding Support
Function (BSF).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System;
Stage 2\".
[5] 3GPP TS 29.513: \"5G System; Policy and Charging Control signalling flows
and QoS parameter mapping; Stage 3\".
[6] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[7] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[8] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
[9] IETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange
Format\".
[10] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces Stage 3\".
[11] OpenAPI: \"OpenAPI 3.0.0 Specification\",
[https://github.com/OAI/OpenAPI-
Specification/blob/master/versions/3.0.0.md]{.underline}.
[12] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[13] IETF RFC 7807: \"Problem Details for HTTP APIs\".
[14] 3GPP TS 29.213: \" Policy and Charging Control signalling flows and
Quality of Service (QoS) parameter mapping\".
[15] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[16] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[17] 3GPP TS 23.527: \"5G System; Restoration Procedures\".
[18] 3GPP TR 21.900: \"Technical Specification Group working methods\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
AF Application Function
BSF Binding Support Function
DNN Data Network Name
DRA Diameter Routing Agent
HTTP Hypertext Transfer Protocol
FQDN Fully Qualified Domain Name
GPSI Generic Public Subscription Identifier
JSON JavaScript Object Notation HTTP Hypertext Transfer Protocol
MAC Media Access Control
NEF Network Exposure Function
NRF Network Repository Function
PCF Policy Control Function
SMF Session Management Function
S-NSSAI Single Network Slice Selection Assistance Information
SUPI Subscription Permanent Identifier
UDR Unified Data Repository
# 4 Binding Support Management Service
## 4.1 Service Description
### 4.1.1 Overview
The Binding Support Management Service as defined in 3GPP TS 23.502 [3] and
3GPP TS 23.503 [4], is provided by the Binding Support Function (BSF).
The Nbsf_Management service is used for the BSF to provide a PDU session
binding functionality, which ensures that an AF request for a certain PDU
Session reaches the relevant PCF holding the PDU Session information.
This service:
\- allows NF service consumers to register, update and remove the binding
information; and
\- allows NF service consumers to retrieve the binding information.
### 4.1.2 Service Architecture
The 5G System Architecture is defined in 3GPP TS 23.501 [2]. The Policy and
Charging related 5G architecture is also described in 3GPP TS 23.503 [4] and
3GPP TS 29.513 [5].
The Binding Support Management Service (Nbsf_Management) is exhibited by the
Binding Support Function (BSF).
Known consumers of the Nbsf_management service are:
\- Policy Control Function (PCF)
\- Network Exposure Function (NEF)
\- Application Function (AF)
As described in 3GPP TS 23.503 [4], the BSF is a function that can be deployed
standalone or can be the functionality provided by other network functions,
such as PCF, UDR, NRF, SMF.
> NOTE: The PCF accesses the Nbsf_management service at the BSF via an
> internal interface when it is collocated with BSF.
{width="3.3944444444444444in" height="1.8229166666666667in"}
Figure 4.1.2-1: Reference Architecture for the Nbsf_management service; SBI
representation
### 4.1.3 Network Functions
#### 4.1.3.1 Binding Support Function (BSF)
The BSF:
\- stores the binding information for a certain PDU Session; and
\- discovers the binding information (e.g. the address information of the
selected PCF).
The BSF allows NF service consumers (e.g.PCF) to register, update and remove
the binding information, and allows NF service consumers (e.g. AF, NEF) to
discover the binding information (e.g the address information of the selected
PCF).
The BSF can be deployed standalone or can be collocated with other network
functions, such as PCF, UDR, NRF andSMF.
#### 4.1.3.2 NF Service Consumers
The Policy Control Function (PCF):
\- registers the binding information in the BSF for a UE when an IPv4 address
and/or IPv6 prefix is allocated, or a MAC address is used for the PDU session;
and,
\- removes the binding information in the BSF when an IPv4 address and/or IPv6
prefix is released, or a MAC address is not used for the PDU Session.
The Network Exposure Function (NEF):
\- provides a means for the Application Functions to securely interact with
the Policy framework for policy control to 3GPP network. During the procedure,
it needs to discover the selected PCF by using the Nbsf_Management_Discovery
service operation.
The Application Function (AF):
\- discover the selected PCF by using the Nbsf_Management_Discovery service
operation when it is allowed to interact directly with the policy framework
for policy control.
## 4.2 Service Operations
### 4.2.1 Introduction
Table 4.2.1-1: Operations of the Nbsf_Management Service
* * *
**Service operation name** **Description** **Initiated by**
Nbsf_Management_Register This service operation is used to register the
binding information for a UE when an IPv4 address and/or an IPv6 prefix is
allocated for an IP PDU Session or a MAC address is used for an Ethernet PDU
session. NF service consumer (PCF) Nbsf_Management_Deregister This service
operation is used to deregister the binding information for a UE. NF service
consumer (PCF) Nbsf_Management_Discovery This service operation is used by an
NEF or AF to discover a selected PCF . NF service consumer (NEF, AF)
* * *
### 4.2.2 Nbsf_Management_Register Service Operation
#### 4.2.2.1 General
This service operation allows the NF service consumer (e.g. PCF) to register
the session binding information for a UE in the BSF by providing the user
identity, the DNN, the UE address(es) and the selected PCF address for a
certain PDU Session to the BSF, and BSF stores the information.
If the NF service consumer (e.g. PCF) receives a new UE address (e.g. IPv6
prefix) and already registered session binding information for this PDU
session, the NF service consumer (e.g. PCF) shall register a new session
binding information in the BSF.
NOTE: For a PDU session, the PCF can receive a new UE address by
Npcf_SMPolicyControl_Update service operation.
#### 4.2.2.2 Register a new PCF Session binding information
{width="6.031944444444444in" height="1.4694444444444446in"}
Figure 4.2.2.2-1: NF service consumer register a new PCF Session binding
information
The NF service consumer shall invoke the Nbsf_Management_Register service
operation to register the session binding information for a UE in the BSF. The
NF service consumer shall send an HTTP POST request with \"{apiRoot}/nbsf-
management/v1/pcfBindings\" as Resource URI representing the \"PCF Session
Bindings\", as shown in figure 4.2.2.2-1, step 1, to create a binding
information for an \"Individual PCF Session Binding\" according to the
information (e.g. UE address(es), SUPI, GPSI, DNN, S-NSSAI) in message body.
The PcfBinding data structure provided in the request body shall include:
\- address information of the served UE consisting of:
(i) either IP address information consisting of:
\+ the IPv4 address encoded as \"ipv4Addr\" attribute; and/or
\+ the IPv6 address prefix encoded as \"ipv6Prefix\" attribute; or
(ii) the MAC address encoded as \"macAddr48\" attribute; and
\- PCF address information consisting of:
(i) if the PCF supports the Npcf_PolicyAuthorization service:
\+ the FQDN of the PCF encoded as \"pcfFqdn\" attribute; and/or
\+ a description of IP endpoints at the PCF hosting the
Npcf_PolicyAuthorization service encoded as \"pcfIpEndPoints\" attribute; and
(ii) if the PCF supports the Rx interface,
\+ the Diameter host id of the PCF encoded as \"pcfDiamHost\"; and
\+ the Diameter realm of the PCF and \"pcfDiamRealm\" attributes;
\- DNN encoded as \"dnn\" attribute; and
\- S-NSSAI encoded as \"snssai\" attribute;
> and may include:
\- SUPI encoded as \"supi\" attribute;
\- GPSI encoded as \"gpsi\" attribute;
\- IPv4 address domain encoded as \"ipDomain\" attribute.
Upon the reception of an HTTP POST request with: \"{apiRoot}/nbsf-
management/v1/pcfBindings\" as Resource URI and PcfBinding data structure as
request body, the BSF shall:
\- create new binding information;
\- assign a bindingId; and
\- store the binding information.
The PCF as NF service consumer may provide PCF Id in \"pcfId\" attribute and
recovery timestamp in \"recoveryTime\" attribute. The BSF may use the
\"pcfId\" attribute to supervise the status of the PCF as described in
subclause 5.2 of 3GPP TS 29.510 [12] and perform necessary cleanup upon status
change of the PCF later, and/or both the \"pcfId\" attribute and the
\"recoveryTime\" attribute in cleanup procedure as described in subclause 6.4
of 3GPP TS 23.527 [17].
If the BSF created an \"Individual PCF Session Binding\" resource, the BSF
shall respond with \"201 Created\" with the message body containing a
representation of the created binding information, as shown in figure
4.2.2.2.2-1, step 2. The BSF shall include a Location HTTP header field. The
Location header field shall contain the URI of the created binding information
i.e. \"{apiRoot}/nbsf-management/v1/pcfBindings/{bindingId}\".
### 4.2.3 Nbsf_Management_Deregister Service Operation
#### 4.2.3.1 General
This service operation allows the service consumer to remove the session
binding information for a UE in the BSF. It is executed by deleting a given
resource identified by an \"Individual PCF Session Binding\" resource
identifier. The operation is invoked by issuing an HTTP DELETE request on the
URI representing the specific session binding information.
#### 4.2.3.2 Deregister an individual PCF Session binding information
Figure 4.2.3.2-1: Session Binding Information Deregistration
The NF service consumer shall invoke the Nbsf_Management_DeRegister service
operation to deregister the session binding information for a UE in the BSF.
The NF service consumer shall send an HTTP DELETE request with
\"{apiRoot}/nbsf-management/v1/pcfBindings/{bindingId}\" as Resource URI,
where \"{bindingId}\" is the \"Individual PCF Session Binding\" resource
identifier that is to be deleted.
Upon the the reception of an HTTP DELETE request with: \"{apiRoot}/nbsf-
management/v1/pcfBindings/{bindingId}\" as Resource URI, the BSF shall:
\- remove the corresponding binding information.
If the HTTP DELETE request message from the NF service consumer is accepted,
the BSF shall respond with \"204 No Content\". If the Individual PCF Session
Binding resource does not exist, the BSF shall respond with \"404 Not Found\".
### 4.2.4 Nbsf_Management_Discovery Service Operation
#### 4.2.4.1 General
This service operation allows the service consumer to use the HTTP GET method
to obtain the address information of the selected PCF.
#### 4.2.4.2 Retrieve the PCF Session binding information for a given tuple
{width="6.0256944444444445in" height="1.64375in"}
Figure 4.2.4.2-1: NF service consumer retrieve the PCF Session binding
information for a given tuple
The NF service consumer shall invoke the Nbsf_Management_Discovery service
operation to obtain address information of the the selected PCF for a PDU
session in the BSF. The NF service consumer shall send an HTTP GET request
with \"{apiRoot}/nbsf-management/v1/pcfBindings\" as Resource URI, where
\"query parameters\" shall include:
\- UE address;
and may include:
\- SUPI or GPSI;
\- DNN and optionally S-NSSAI; and
\- IPv4 address domain.
NOTE: The query parameters S-NSSAI and/or IPv4 addres domain is helpful in the
scenario of IPv4 address overlapping where the same IPv4 address may be
allocated to UE PDU sessions.
Upon the reception of an HTTP GET request with: \"{apiRoot}/nbsf-
management/v1/pcfBindings\" as Resource URI, the BSF shallsearch the
corresponding binding information. If \"ipv6Prefix\" is used as an UE IPv6
address in the query parameter, the BSF shall use the longest prefix match to
find a matching IPv6 prefix so that the IPv6 address in the query parameter is
within the address range covered by that matching IPv6 prefix. The IPv6
address in the query parameter shall be formatted as an IPv6 prefix value
including the trailing prefix length \"/128\".
If the HTTP request message from the NF service consumer is accepted and a
session binding resource matching the query parameters exists, the BSF shall
reply with a \"200 OK\" HTTP response containing the corresponding PcfBinding
data structure, as provided by the PCF during the Nbsf_Management_Register
Service Operation in the response body. If there is no PCF session binding
information matching the query parameters, the BSF shall respond with \"204 No
Content\".
If the \"PCF Session Bindings\" resource does not exist, the BSF shall respond
with \"404 Not Found\". If an invalid combination of query parameters (i.e. a
combination without UE address(es)) is contained in the request URI, the BSF
shall respond with an \"400 Bad Request\" HTTP error code containing
\"MANDATORY_QUERY_PARAM_MISSING\" as application error within the
ProblemDetails IE. If more then one PCF Session Binding resources are found,
the BSF shall respond with \"400 Bad Request\" HTTP error code containing
\"MULTIPLE_BINDING_INFO_FOUND\" as application error within the ProblemDetails
IE.
# 5 Nbsf_Management Service API
## 5.1 Introduction
The Nbsf_management Service shall use the Nbsf_management API.
The request URI used in each HTTP request from the NF service consumer towards
the BSF shall have the structure defined in subclause 4.4.1 of 3GPP TS 29.501
[7], i.e.:
> **{apiRoot}/{apiName}/{apiVersion}/{apiSpecificResourceUriPart}**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [7].
\- The {apiName} shall be \"nbsf-management\".
\- The {apiVersion} shall be \"v1\".
\- The {apiSpecificResourceUriPart} shall be set as described in subclause
5.3.
## 5.2 Usage of HTTP
### 5.2.1 General
HTTP/2, IETF RFC 7540 [8], shall be used as specified in clause 5 of 3GPP TS
29.500 [6].
HTTP/2 shall be transported as specified in subclause 5.3 of 3GPP TS 29.500
[6].
The OpenAPI [11] specification of HTTP messages and content bodies for the
Nbsf_management is contained in Annex A.
### 5.2.2 HTTP standard headers
#### 5.2.2.1 General
See subclause 5.2.2 of 3GPP TS 29.500 [6] for the usage of HTTP standard
headers.
#### 5.2.2.2 Content type
JSON, IETF RFC 8259 [9], shall be used as content type of the HTTP bodies
specified in the present specification as specified in subclause 5.4 of 3GPP
TS 29.500 [6]. The use of the JSON format shall be signalled by the content
type \"application/json\".
\"Problem Details\" JSON object shall be used to indicate additional details
of the error in a HTTP response body and shall be signalled by the content
type \"application/problem+json\", as defined in IETF RFC 7807 [13].
### 5.2.3 HTTP custom headers
#### 5.2.3.1 General
The Nbsf_Management Service API shall support HTTP custom header fields
specified in subclause 5.2.3.2 of 3GPP TS 29.500 [6].
In this release of the specification, no specific custom headers are defined
for the Nbsf_Management Service API.
## 5.3 Resources
### 5.3.1 Resource Structure
The structure of the Resource URI of the Nbsf_Management service is shown in
figure 5.3.1-1.
Figure 5.3.1-1: Resource URI structure of the Nbsf_Management API
Table 5.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 5.3.1-1: Resources and methods overview
* * *
Resource name Resource URI HTTP method or custom operation Description
PCF Session Bindings {apiRoot}/\ POST Register new PCF Session binding
information of a given UE address in BSF. nbsf-management/v1\  
/pcfBindings
                                                         GET                               Retrieve the Session binding information i.e. PCF address information of a given tuple (UE address(es), SUPI; GPSI, DNN, snssai).
Individual PCF Session Binding {apiRoot}/\ DELETE Deregister existing PCF
Session binding information from BSF. nbsf-management/v1\  
/pcfBindings\  
/{bindingId}
* * *
### 5.3.2 Resource: PCF Session Bindings
#### 5.3.2.1 Description
This resource represents a collection of the different PCF Session binding
information of given UE address(es) registered in the BSF.
#### 5.3.2.2 Resource definition
Resource URI: {apiRoot}/nbsf-management/v1/pcfBindings
This resource shall support the resource URI variables defined in table
5.3.2.2-1.
Table 5.3.2.2-1: Resource URI variables for this resource
* * *
Name Definition apiRoot See subclause 5.1
* * *
#### 5.3.2.3 Resource Standard Methods
##### 5.3.2.3.1 POST
This method shall support the URI query parameters specified in table
5.3.2.3.1-1.
Table 5.3.2.3.1-1: URI query parameters supported by the POST method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.2.3.1-2 and the response data structures and response codes specified in
table 5.3.2.3.1-3.
Table 5.3.2.3.1-2: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description PcfBinding M 1 Register a new Individual
PCF binding information.
* * *
Table 5.3.2.3.1-3: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+-------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+-------------+---------------+ | PcfBinding | M | 1 | 201 Created | The creation | | | | | | of an | | | | | | individual | | | | | | PCF session | | | | | | biding. | +---------------+---+-------------+-------------+---------------+ | NOTE: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [6] | | | | | | shall also | | | | | | apply. | | | | | +---------------+---+-------------+-------------+---------------+
##### 5.3.2.3.2 GET
This method shall support the URI query parameters specified in table
5.3.2.3.2-1.
Table 5.3.2.3.2-1: URI query parameters supported by the GET method on this
resource
+--------------+--------------+-------+--------------+--------------+ | **Name** | **Data |** P**|** C | **D | | | type** | | ardinality**| escription** | +--------------+--------------+-------+--------------+--------------+ | ipv4Addr | Ipv4Addr | C | 0..1 | The IPv4 | | | | | | Address of | | | | | | the served | | | | | | UE. (NOTE 1) | +--------------+--------------+-------+--------------+--------------+ | ipv6Prefix | Ipv6Prefix | C | 0..1 | The IPv6 | | | | | | Address of | | | | | | the served | | | | | | UE. (NOTE 1) | | | | | | | | | | | | The NF | | | | | | service | | | | | | consumer | | | | | | shall append | | | | | | \'/128\' to | | | | | | the IPv6 | | | | | | address in | | | | | | the | | | | | | attribute | | | | | | value. E.g. | | | | | | \ | | | | | | '2001:db8:85 | | | | | | a3::8a2e:370 | | | | | | :7334/128\'. | +--------------+--------------+-------+--------------+--------------+ | macAddr48 | MacAddr48 | C | 0..1 | The MAC | | | | | | Address of | | | | | | the served | | | | | | UE. (NOTE 1) | +--------------+--------------+-------+--------------+--------------+ | dnn | Dnn | O | 0..1 | DNN | +--------------+--------------+-------+--------------+--------------+ | supi | Supi | O | 0..1 | Subscription | | | | | | Permanent | | | | | | Identifier | +--------------+--------------+-------+--------------+--------------+ | gpsi | Gpsi | O | 0..1 | Generic | | | | | | Public | | | | | | Subscription | | | | | | Identifier | +--------------+--------------+-------+--------------+--------------+ | snssai | Snssai | O | 0..1 | The | | | | | | id | | | | | | entification | | | | | | of slice. | | | | | | (NOTE 2) | +--------------+--------------+-------+--------------+--------------+ | ipDomain | string | O | 0..1 | The IPv4 | | | | | | address | | | | | | domain | | | | | | identifier. | | | | | | (NOTE 2) | +--------------+--------------+-------+--------------+--------------+ | supp-feat | Suppo | O | 0..1 | To filter | | | rtedFeatures | | | irrelevant | | | | | | responses | | | | | | related to | | | | | | unsupported | | | | | | features. | +--------------+--------------+-------+--------------+--------------+ | NOTE 1: One | | | | | | and only one | | | | | | of query | | | | | | parameter | | | | | | ipv4-addr, | | | | | | ipv6-prefix | | | | | | or | | | | | | mac-addr48 | | | | | | shall be | | | | | | present. | | | | | | | | | | | | NOTE 2: The | | | | | | query | | | | | | parameters | | | | | | snssai | | | | | | and/or | | | | | | ipDomain, if | | | | | | applicable | | | | | | (IPv4 | | | | | | address | | | | | | o | | | | | | verlapping), | | | | | | shall be | | | | | | present with | | | | | | query | | | | | | parameter | | | | | | ipv4Addr. | | | | | +--------------+--------------+-------+--------------+--------------+
This method shall support the request data structures specified in table
5.3.2.3.2-2 and the response data structures and response codes specified in
table 5.3.2.3.2-3.
Table 5.3.2.3.2-2: Data structures supported by the GET Request Body on this
resource
* * *
**Data type** **P** **Cardinality** **Description** n/a
* * *
Table 5.3.2.3.2-3: Data structures supported by the GET Response Body on this
resource
+--------------+-------+--------------+--------------+--------------+ | **Data |** P**|** C | **Response |** D | | type**| | ardinality** | codes**| escription** | +--------------+-------+--------------+--------------+--------------+ | PcfBinding | M | 1 | 200 OK | The | | | | | | individual | | | | | | PCF session | | | | | | binding | | | | | | information | | | | | | resource | | | | | | matching the | | | | | | query | | | | | | parameter(s) | | | | | | is returned. | +--------------+-------+--------------+--------------+--------------+ | n/a | | | 204 No | There is no | | | | | Content | PCF session | | | | | | binding | | | | | | information | | | | | | matching the | | | | | | query | | | | | | p | | | | | | arameter(s). | +--------------+-------+--------------+--------------+--------------+ | Pr | M | 1 | 400 Bad | More than | | oblemDetails | | | Request | one binding | | | | | | information | | | | | | is found. | | | | | | (NOTE 2) | +--------------+-------+--------------+--------------+--------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the GET | | | | | | method | | | | | | listed in | | | | | | tab | | | | | | le 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [6] | | | | | | shall also | | | | | | apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure | | | | | | cases are | | | | | | described in | | | | | | su | | | | | | bclause 5.7. | | | | | +--------------+-------+--------------+--------------+--------------+
### 5.3.3 Resource: Individual PCF Session Binding
#### 5.3.3.1 Description
This resource represents a collection of the different PCF Session binding
information of given UE address(es) registered in the BSF.
#### 5.3.3.2 Resource definition
Resource URI: **{apiRoot}/nbsf-management/v1/pcfBindings/{bindingId}**
This resource shall support the resource URI variables defined in table
5.3.3.2-1.
Table 5.3.3.2-1: Resource URI variables for this resource
+-----------+---------------------------------------------------------+ | **Name** | **Definition** | +-----------+---------------------------------------------------------+ | apiRoot | See subclause 5.1 | +-----------+---------------------------------------------------------+ | bindingId | Represents the individual PCF Session Binding. | | | | | | To enable that the value is used as part of a URI, the | | | string shall only contain characters allowed according | | | to the \"lower-with-hyphen\" naming convention defined | | | in 3GPP TS 29.501 [7]. | +-----------+---------------------------------------------------------+
#### 5.3.3.3 Resource Standard Methods
##### 5.3.3.3.1 DELETE
This method shall support the URI query parameters specified in table
5.3.3.3.2-1.
Table 5.3.3.3.1-1: URI query parameters supported by the DELETE method on this
resource
* * *
**Name** **Data type** **P** **Cardinality** **Description** n/a
* * *
This method shall support the request data structures specified in table
5.3.3.3.1-2 and the response data structures and response codes specified in
table 5.3.3.3.1-3.
Table 5.3.3.3.1-2: Data structures supported by the DELETE Request Body on
this resource
* * *
**Data type** **P** **Cardinality** **Description** n/a
* * *
Table 5.3.3.3.1-3: Data structures supported by the DELETE Response Body on
this resource
* * *
**Data type** **P** **Cardinality** **Response codes** **Description** n/a 204
No Content Successful case: The Individual PCF session binding information
resource is deleted. NOTE: The mandatory HTTP error status codes for the POST
method listed in table 5.2.7.1-1 of 3GPP TS 29.500 [6] shall also apply.
* * *
## 5.4 Custom Operations without associated resources
None in this release of this specification.
## 5.5 Notifications
None in this release of this specification.
## 5.6 Data Model
### 5.6.1 General
This subclause specifies the application data model supported by the API.
Table 5.6.1-1 specifies the data types defined for the N~bsf~ service based
interface protocol.
Table 5.6.1-1: N~bsf~ specific Data Types
* * *
Data type Section defined Description Applicability PcfBinding 5.6.2.2
Identifies an Individual PCF binding.
* * *
Table 5.6.1-2 specifies data types re-used by the N~bsf~ service based
interface protocol from other specifications, including a reference to their
respective specifications and when needed, a short description of their use
within the N~bsf~ service based interface.
Table 5.6.1-2: N~bsf~ re-used Data Types
* * *
Data type Reference Comments Applicability DateTime 3GPP TS 29.571 [10]  
DiameterIdentity 3GPP TS 29.571 [10]  
Dnn 3GPP TS 29.571 [10]  
Fqdn 3GPP TS 29.510 [12]  
Gpsi 3GPP TS 29.571 [10]  
IpEndPoint 3GPP TS 29.510 [12]  
Ipv4Addr, 3GPP TS 29.571 [10]  
Ipv6Prefix 3GPP TS 29.571 [10]  
MacAddr48 3GPP TS 29.571 [10]  
NfInstanceId 3GPP TS 29.571 [10]  
ProblemDetails 3GPP TS 29.571 [10] Used in error responses to provide more
detailed information about an error.  
Snssai 3GPP TS 29.571 [10]  
Supi 3GPP TS 29.571 [10]  
SupportedFeatures 3GPP TS 29.571 [10] Used to negotiate the applicability of
the optional features defined in table 5.8-1.
* * *
### 5.6.2 Structured data types
#### 5.6.2.1 Introduction
This subclause defines the structures to be used in resource representations.
#### 5.6.2.2 Type PcfBinding
Table 5.6.2.2-1: Definition of type PcfBinding
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | supi | Supi | O | 0..1 | Sub | | | | | | | scription | | | | | | | Permanent | | | | | | | I | | | | | | | dentifier | | +-----------+-----------+---+-----------+-----------+-----------+ | gpsi | Gpsi | O | 0..1 | Generic | | | | | | | Public | | | | | | | Sub | | | | | | | scription | | | | | | | I | | | | | | | dentifier | | +-----------+-----------+---+-----------+-----------+-----------+ | ipv4Addr | Ipv4Addr | C | 0..1 | The IPv4 | | | | | | | Address | | | | | | | of the | | | | | | | served | | | | | | | UE. | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | i | I | C | 0..1 | The IPv6 | | | pv6Prefix | pv6Prefix | | | Address | | | | | | | Prefix of | | | | | | | the | | | | | | | served | | | | | | | UE. | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | ipDomain | string | O | 0..1 | IPv4 | | | | | | | address | | | | | | | domain | | | | | | | id | | | | | | | entifier. | | +-----------+-----------+---+-----------+-----------+-----------+ | macAddr48 | MacAddr48 | C | 0..1 | The MAC | | | | | | | Address | | | | | | | of the | | | | | | | served | | | | | | | UE. | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | dnn | Dnn | M | 1 | DNN | | +-----------+-----------+---+-----------+-----------+-----------+ | pcfFqdn | Fqdn | C | 0..1 | FQDN of | | | | | | | the PCF | | | | | | | hosting | | | | | | | the | | | | | | | Npcf_P | | | | | | | olicyAuth | | | | | | | orization | | | | | | | service. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | pcfIp | array(Ip | C | 1..N | IP end | | | EndPoints | EndPoint) | | | points of | | | | | | | the PCF | | | | | | | hosting | | | | | | | the | | | | | | | Npcf_P | | | | | | | olicyAuth | | | | | | | orization | | | | | | | service. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | pc | Diamete | C | 0..1 | The | | | fDiamHost | rIdentity | | | diameter | | | | | | | host for | | | | | | | an | | | | | | | i | | | | | | | ndividual | | | | | | | PCF. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | pcf | Diamete | C | 0..1 | The | | | DiamRealm | rIdentity | | | diameter | | | | | | | realm for | | | | | | | an | | | | | | | i | | | | | | | ndividual | | | | | | | PCF. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | snssai | Snssai | M | 1 | The | | | | | | | ident | | | | | | | ification | | | | | | | of slice. | | +-----------+-----------+---+-----------+-----------+-----------+ | suppFeat | Supporte | C | 0..1 | Used to | | | | dFeatures | | | negotiate | | | | | | | the | | | | | | | supported | | | | | | | optional | | | | | | | features | | | | | | | as | | | | | | | described | | | | | | | in | | | | | | | subcl | | | | | | | ause 5.8. | | | | | | | | | | | | | | When a | | | | | | | supported | | | | | | | feature | | | | | | | is | | | | | | | s | | | | | | | pecified, | | | | | | | it shall | | | | | | | be | | | | | | | present | | | | | | | in the | | | | | | | HTTP POST | | | | | | | request/ | | | | | | | response; | | | | | | | or in the | | | | | | | HTTP GET | | | | | | | response | | | | | | | if the | | | | | | | \"su | | | | | | | pp-feat\" | | | | | | | attribute | | | | | | | query | | | | | | | parameter | | | | | | | is | | | | | | | included | | | | | | | in the | | | | | | | HTTP GET | | | | | | | request. | | +-----------+-----------+---+-----------+-----------+-----------+ | pcfId | NfI | O | 0..1 | PCF | | | | nstanceId | | | instance | | | | | | | i | | | | | | | dentifier | | +-----------+-----------+---+-----------+-----------+-----------+ | rec | DateTime | O | 0..1 | Recovery | | | overyTime | | | | time of | | | | | | | the PCF | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | Either IP | | | | | | | ad | | | | | | | dress(es) | | | | | | | (ipv4Addr | | | | | | | and/or | | | | | | | ip | | | | | | | v6Prefix) | | | | | | | or | | | | | | | macAddr48 | | | | | | | shall be | | | | | | | included. | | | | | | | | | | | | | | NOTE 2: | | | | | | | At least | | | | | | | one of | | | | | | | pcfFqdn | | | | | | | or | | | | | | | pcfIp | | | | | | | EndPoints | | | | | | | shall be | | | | | | | included | | | | | | | if the | | | | | | | PCF | | | | | | | supports | | | | | | | the | | | | | | | Npcf_P | | | | | | | olicyAuth | | | | | | | orization | | | | | | | service. | | | | | | | | | | | | | | NOTE 3: | | | | | | | Both | | | | | | | pc | | | | | | | fDiamHost | | | | | | | and | | | | | | | pcf | | | | | | | DiamRealm | | | | | | | are | | | | | | | provided | | | | | | | if the | | | | | | | PCF | | | | | | | supports | | | | | | | Rx | | | | | | | i | | | | | | | nterface. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
### 5.6.3 Simple data types and enumerations
#### 5.6.3.1 Introduction
This subclause defines simple data types and enumerations that can be
referenced from data structures defined in the previous subclauses.
#### 5.6.3.2 Simple data types
The simple data types defined in table 5.6.3.2-1 shall be supported.
Table 5.6.3.2-1: Simple data types
* * *
Type Name Type Definition Description Applicability n/a
* * *
## 5.7 Error handling
### 5.7.1 General
HTTP error handling shall be supported as specified in subclause 5.2.4 of 3GPP
TS 29.500 [6].
For the Nbsf_Management Service API, HTTP error responses shall be supported
as specified in subclause 4.8 of 3GPP TS 29.501 [7]. Protocol errors and
application errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [6] shall be
supported for an HTTP method if the corresponding HTTP status codes are
specified as mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS
29.500 [6]. In addition, the requirements in the following subclauses shall
apply.
### 5.7.2 Protocol Errors
In this Release of the specification, there are no additional protocol errors
applicable for the Nbsf_Management Service API.
### 5.7.3 Application Errors
The application errors defined for the Nbsf_Management Service API are listed
in table 5.7.3-1. The PCF shall include in the HTTP status code a
\"ProblemDetails\" data structure with the \"cause\" attribute indicating the
application error as listed in table 5.7.3-1.
Table 5.7.3-1: Application errors
* * *
**Application Error** **HTTP status code** **Description**
MULTIPLE_BINDING_INFO_FOUND 400 Bad Request Indicates that the BSF found more
than one binding resource so it cannot provide the selected PCF to the
consumer. (NOTE) NOTE: This application error is included in the responses to
the GET request.
* * *
## 5.8 Feature negotiation
The optional features in table 5.8-1 are defined for the Nbsf_Management
Service API. They shall be negotiated using the extensibility mechanism
defined in subclause 6.6 of 3GPP TS 29.500 [6].
Table 5.8-1: Supported Features
* * *
**Feature number** **Feature Name** **Description**
* * *
## 5.9 Security
As indicated in 3GPP TS 33.501 [15] and 3GPP TS 29.500 [6], the access to the
Nbsf_Management API may be authorized by means of the OAuth2 protocol (see
IETF RFC 6749 [16]), based on local configuration, using the \"Client
Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [12])
plays the role of the authorization server.
If OAuth2 is used, a n NF Service Consumer, prior to consuming services
offered by the Nbsf_Management API, shall obtain a \"token\" from the
authorization server, by invoking the Access Token Request service, as
described in 3GPP TS 29.510 [12], subclause 5.4.2.2.
NOTE: When multiple NRFs are deployed in a network, the NRF used as
authorization server is the same NRF that the NF Service Consumer used for
discovering the Nbsf_Management service.
The Nbsf_Management API defines a single scope \"nbsf-management\" for the
entire service, and it does not define any additional scopes at resource or
operation level.
###### ## Annex A (normative): OpenAPI specification
# A.1 General
The present Annex contains an OpenAPI [11] specification of HTTP messages and
content bodies used by the Nbsf_Management API.
This Annex shall take precedence when being discrepant to other parts of the
specification with respect to the encoding of information elements and methods
within the API.
NOTE 1: The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
Informative copies of the OpenAPI specification file contained in this 3GPP
Technical Specification are available on the public 3GPP file server in the
following locations (see clause 5B of the 3GPP TR 21.900 [18] for further
information):
\- [https://www.3gpp.org/ftp/Specs/archive/OpenAPI/\/]{.underline},
and
\-
[https://www.3gpp.org/ftp/Specs/\/\/OpenAPI/]{.underline}.
NOTE 2: To fetch the OpenAPI specification file after CT#83 plenary meeting
for Release 15 in the above links \ must be replaced with the date
the CT Plenary occurs, in the form of year-month (yyyy-mm), e.g. for CT#83
meeting \ must be replaced with value \"2019-03\" and \ must
be replaced with value \"Rel-15\".
# A.2 Nbsf_Management API
openapi: 3.0.0
info:
version: 1.0.3
title: Nbsf_Management
description: \|
Binding Support Management Service API.
© 2019, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
externalDocs:
description: 3GPP TS 29.521 V15.5.0; 5G System; Binding Support Management
Service.
url: \'http://www.3gpp.org/ftp/Specs/archive/29_series/29.521/\'
servers:
\- url: \'{apiRoot}/nbsf-management/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in subclause 4.4 of 3GPP TS 29.501.
security:
\- {}
\- oAuth2ClientCredentials:
\- nbsf-management
paths:
/pcfBindings:
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/PcfBinding\'
responses:
\'201\':
description: The creation of an individual PCF session binding.
content:
application/json:
schema:
\$ref: \'#/components/schemas/PcfBinding\'
headers:
Location:
description: \'Contains the URI of the newly created resource, according to
the structure: {apiRoot}/nbsf-management/v1/pcfBindings/{bindingId}\'
required: true
schema:
type: string
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
get:
parameters:
\- name: ipv4Addr
in: query
description: The IPv4 Address of the served UE.
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
\- name: ipv6Prefix
in: query
description: The IPv6 Address of the served UE. The NF service consumer shall
append \'/128\' to the IPv6 address in the attribute value. E.g.
\'2001:db8:85a3::8a2e:370:7334/128\'.
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix\'
\- name: macAddr48
in: query
description: The MAC Address of the served UE.
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/MacAddr48\'
\- name: dnn
in: query
description: DNN.
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Dnn\'
\- name: supi
in: query
description: Subscription Permanent Identifier.
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Supi\'
\- name: gpsi
in: query
description: Generic Public Subscription Identifier
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Gpsi\'
\- name: snssai
in: query
description: The identification of slice.
required: false
content:
application/json:
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Snssai\'
\- name: ipDomain
in: query
description: The IPv4 address domain identifier.
required: false
schema:
type: string
\- name: supp-feat
in: query
description: To filter irrelevant responses related to unsupported features
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
responses:
\'200\':
description: The individual PCF session binding session binding information
resource matching the query parameter(s) is returned.
content:
application/json:
schema:
\$ref: \'#/components/schemas/PcfBinding\'
\'204\':
description: There is no PCF session binding information matching the query
parameter(s).
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'406\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/406\'
\'414\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/414\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/pcfBindings/{bindingId}:
delete:
parameters:
\- name: bindingId
in: path
description: Represents the individual PCF Session Binding.
required: true
schema:
type: string
responses:
\'204\':
description: No Content. The Individual PCF session binding information
resource is deleted.
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
components:
securitySchemes:
oAuth2ClientCredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
nbsf-management: Access to the Nbsf_Management API
schemas:
PcfBinding:
type: object
properties:
supi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Supi\'
gpsi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Gpsi\'
ipv4Addr:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
ipv6Prefix:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix\'
ipDomain:
type: string
macAddr48:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/MacAddr48\'
dnn:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Dnn\'
pcfFqdn:
\$ref: \'TS29510_Nnrf_NFManagement.yaml#/components/schemas/Fqdn\'
pcfIpEndPoints:
type: array
items:
\$ref: \'TS29510_Nnrf_NFManagement.yaml#/components/schemas/IpEndPoint\'
minItems: 1
description: IP end points of the PCF hosting the Npcf_PolicyAuthorization
service. At least one of pcfFqdn or pcfIpEndPoints shall be included if the
PCF supports the Npcf_PolicyAuthorization service.
pcfDiamHost:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DiameterIdentity\'
pcfDiamRealm:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DiameterIdentity\'
snssai:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Snssai\'
suppFeat:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
pcfId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NfInstanceId\'
recoveryTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTime\'
required:
\- dnn
\- snssai
oneOf:
\- anyOf:
\- required: [ipv4Addr]
\- required: [ipv6Prefix]
\- required: [macAddr48]
anyOf:
\- anyOf:
\- required: [pcfFqdn]
\- required: [pcfIpEndPoints]
\- required: [pcfDiamHost, pcfDiamRealm]
Annex B (informative):\ Deployment option to support BSF and DRA coexistence
due to network migration
As described in Annex B of 3GPP TS 23.503 [4], the Diameter Routing Agent
(DRA) and the BSF can coexist in an operator\'s network during the network
migration to 5GC. The DRA is described in 3GPP TS 29.213 [14] and can be a
service consumer of the Nbsf_Management_Discovery service.
During the Rx session establishment, the DRA can discover the selected PCF for
the related subscriber by using the Nbsf_Management_Discovery service
operation to obtain the related PCF address if it has no stored binding
information derived from an ongoing Gx session for that subscriber.
NOTE 1: For a UE in the EPC there is a Gx session and the DRA stores the
binding information. For a UE in the 5GC the Npcf_SmPolicyControl service is
used and the BSF stores the binding information.
NOTE 2: If the DRA has no stored binding information derived from an ongoing
Gx session for a subscriber, the DRA needs to request new binding information
for each Rx session establishment because the information in the BSF could
have changed compared to any previous binding information the DRA requested.
#