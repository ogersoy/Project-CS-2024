# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes the Diameter-based interfaces between the
SCEF/IWK-SCEF and other network entities such as MME/SGSN for the Architecture
enhancements to facilitate communications with packet data networks and
applications.
In particular, this document specifies the T6a interface between the MME and
the SCEF, the T6ai interface between the MME and the IWK-SCEF, the T6b
interface between the SGSN and the SCEF, the T6bi interface between the SGSN
and the SCEF and the T7 interface between the SCEF and the IWK-SCEF. The
procedures over those interfaces are defined in 3GPP TS 23.682 [2].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
with packet data networks and applications \".
[3] Void.
[4] 3GPP TS 29.229: \"Cx and Dx interfaces based on the Diameter protocol;
protocol details \".
[5] 3GPP TS 29.336: \"Home Subscriber Server (HSS) diameter interfaces for
interworking with packet data networks and applications\".
[6] 3GPP TS 29.228: \"IP multimedia (IM) Subsystem Cx Interface; Signalling
flows and Message Elements\".
[7] IETF RFC 4960: \"Stream Control Transport Protocol\".
[8] IETF RFC 5234: \"Augmented BNF for Syntax Specifications: ABNF\".
[9] IETF RFC 7683: \"Diameter Overload Indication Conveyance\".
[10] 3GPP TS 29.212: \"Policy and Charging Control (PCC); Reference points\".
[11] 3GPP TS 25.413: \"UTRAN Iu interface Radio Access Network Application
Part (RANAP) signalling\".
[12] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core
Network Protocols; Stage 3\".
[13] 3GPP TS 36.413: \"Evolved Universal Terrestrial Radio Access Network
(E-UTRAN); S1 Application Protocol (S1AP)\".
[14] 3GPP TS 48.018: \"General Packet Radio Service (GPRS); Base Station
System (BSS) - Serving GPRS Support Node (SGSN); BSS GPRS protocol (BSSGP)\".
[15] IETF RFC 7944: \"Diameter Routing Message Priority\".
[16] 3GPP TS 29.272: \"Mobility Management Entity (MME) and Serving GPRS
Support Node (SGSN) related interfaces based on Diameter protocol\".
[17] 3GPP TS 29.329: \"Sh Interface based on the Diameter protocol; Protocol
details\".
[18] Void.
[19] 3GPP TS 23.007: \"Restoration procedures\".
[20] 3GPP TS 32.299: \"Telecommunication management; Charging management;
Diameter charging applications\".
[21] IETF RFC 5778: \"Diameter Mobile IPv6: Support for Home Agent to Diameter
Server Interaction\".
[22] 3GPP TS 32.299: \"Telecommunication management; Charging management;
Diameter charging applications\".
[23] 3GPP TS 32.253: \"Telecommunication management; Charging management;
Control Plane (CP) data transfer domain charging\".
[24] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[25] 3GPP TS 23.401: \"GPRS enhancements for E-UTRAN access\".
[26] 3GPP TS 29.172: \"Location Services (LCS); Evolved Packet Core (EPC) LCS
Protocol (ELP) between the Gateway Mobile Location Centre (GMLC) and the
Mobile Management Entity (MME); SLg interface\".
[27] 3GPP TS 29.338: \"Diameter based protocols to support SMS capable MMEs\".
[28] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[29] 3GPP TS 29.061: \"Interworking between the Public Land Mobile Network
(PLMN) supporting packet based services and Packet Data Networks (PDN)\".
[30] 3GPP TS 32.298: \"Telecommunication Management; Charging Management;
Charging Data Record (CDR) parameter description\".
[31] IETF RFC 8583: \"Diameter Load Information Conveyance\".
[32] IETF RFC 6733: \"Diameter Base Protocol\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
DRMP Diameter Routing Message Priority
DSCP Differentiated Services Code Point
SCEF Service Capability Exposure Function
IWK-SCEF Interworking - SCEF
# 4 General Description
## 4.1 Introduction
The T6a/b reference point between the MME/SGSN and the SCEF, the T6ai/bi
reference point between the MME/SGSN in the VPLMN and the IWK-SCEF and the T7
reference point between the IWK-SCEF and the SCEF are defined in the 3GPP TS
23.682 [2].
This document describes the Diameter-based T6a/b, T6ai/bi and T7 related
procedures, message parameters and protocol specification.
An excerpt of the 3GPP Architecture for the enhancements to facilitate
communications with packet data networks and applications, as defined in 3GPP
TS 23.682 [2] is shown in Figure 4.1-1, where the relevant interfaces towards
the SCEF/IWK-SCEF are highlighted.
Figure 4.1-1: 3GPP Architecture for the enhancements to facilitate
communications with packet data networks and applications
In this architecture, the T6a/b reference point connects the MME/SGSN with the
SCEF.
The T6a/b interface shall allow the SCEF:
\- to receive reports of the monitoring events from the MME/SGSN configured
via an HSS;
\- to configure the monitoring events at an MME/SGSN which are not UE related
in the non roaming cases;
\- to manage a connection between the MME and the SCEF on T6a;
\- to send MT data on T6a;
\- to receive MO data on T6a.
The T6ai/bi reference point connects the MME/SGSN with the IWK-SCEF in the
visited network, if the IWK-SCEF is deployed.
The T6ai/bi interface shall allow the IWK-SCEF to:
\- to receive configuration of the monitoring events from the MME or the SGSN
and perform a filtering of the services which are allowed for this subscriber
in this visited network based on roaming policies;
\- to receive reports of the monitoring events from the MME/SGSN that are
configured via an HSS, perform a filtering and forward them to the SCEF (in
the home network which has configured the event) via the T7 reference point;
\- to receive MO data on T6ai/bi and forward them to the SCEF;
\- to receive MT data and forward them to the MME on T6ai/bi;
\- to manage a connection between MME/SGSN and IWK-SCEF on T6ai/bi and forward
connection management commands to the SCEF.
The T7 reference point connects the IWK-SCEF in the visited network with the
SCEF in the home network.
The T7 interface shall allow the IWK-SCEF to:
\- to forward reports received on T6ai/bi to the SCEF indicated in the event
report received on T6ai/T6bi;
\- to receive MO data on T6ai/bi and forward them to the SCEF on T7;
\- to receive MT data on T7 and forward them to the MME/SGSN;
\- to manage connection between the SCEF and the IWK-SCEF on T7 and forward
connection management commands to the MME/SGSN.
# 5 Procedures Description
## 5.1 Introduction
This clause describes the Diameter-based T6a, T6b, T6ai, T6bi and T7 interface
related procedures and the Information elements exchanged between the
functional entities.
In the tables that describe the Information Elements transported by each
Diameter command, each Information Element is marked as (M) Mandatory, (C)
Conditional or (O) Optional in the \"Cat.\" column. For the correct handling
of the Information Element according to the category type, see the description
detailed in clause 6 of the 3GPP TS 29.228 [6].
## 5.2 Report Procedures
### 5.2.1 General
This procedure is used between the MME/SGSN and the SCEF, between the MME/SGSN
and the IWK-SCEF and between the IWK-SCEF and the SCEF.
When the procedure is invoked by the MME or the SGSN, it is used for
reporting:
\- the UE Loss of Connectivity;
\- the UE Reachability;
\- location of the UE and change in location of the UE;
\- Communication Failure;
\- Idle Status Indication.
When the procedure is invoked by the IWK-SCEF, it is used for conveying the
monitoring event reported by the MME or the SGSN to the SCEF, after applying
the roaming policies configured at the IWK-SCEF.
This procedure is mapped to the commands Reporting-Information-Request/Answer
in the Diameter application specified in clause 6. The tables 5.2.1-1 and
5.2.1-2 detail the involved information elements.
Table 5.2.1-1: Reporting Information Request
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | User Identity | User-Identifier | C | If present, this | | | | | information | | (See 6.4.16) | | | element shall | | | | | contain the | | | | | identity of the | | | | | UE. This is a | | | | | grouped AVP | | | | | containing the | | | | | MSISDN or the | | | | | Ext | | | | | ernal-Identifier. | +-------------------+-------------------+------+-------------------+ | Monitoring Event | Monito | C | If the | | Report | ring-Event-Report | | Reporting-In | | | | | formation-Request | | (see 3GPP TS | | | is sent for | | 29.336 [5] | | | reporting the | | clause 8.4.3) | | | monitoring | | | | | events, the | | | | | MME/SGSN and the | | | | | IWK-SCEF shall | | | | | include the | | | | | monitoring | | | | | event(s) reported | | | | | towards the SCEF. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+
Table 5.2.1-2: Reporting Information Answer
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | Result | Result-Code / | M | Result of the | | | Ex | | request. | | (See 6.3) | perimental-Result | | | | | | | Result-Code AVP | | | | | shall be used for | | | | | errors defined in | | | | | the Diameter Base | | | | | Protocol. | | | | | | | | | | Ex | | | | | perimental-Result | | | | | AVP shall be used | | | | | for T6a/b errors. | | | | | This is a grouped | | | | | AVP, which | | | | | contains the 3GPP | | | | | Vendor ID in the | | | | | Vendor-Id AVP, | | | | | and the error | | | | | code in the | | | | | Experim | | | | | ental-Result-Code | | | | | AVP. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+ | Monitoring Event | Monitoring-Ev | O | If present, this | | Report Status | ent-Report-Status | | information | | | | | element shall | | | | | contain the | | | | | status of each | | | | | individual | | | | | monitoring event | | | | | report received | | | | | by the SCEF from | | | | | the MME/SGSN. | +-------------------+-------------------+------+-------------------+
### 5.2.2 Detailed Behaviour of the MME/SGSN
#### 5.2.2.0 General
The MME/SGSN shall fill the Monitoring-Event-Report AVP according to the event
reported as specified below. For all monitoring events, the SCEF-ID and the
SCEF-Reference-ID AVPs shall be included. In addition, the event specific AVPs
as listed below shall be included based on the type of event reported.
The MME/SGSN shall include the External-Identifier or the MSISDN if present in
the subscription data received from the HSS.
If the MME/SGSN receives an Experimental-Result-Code set to
DIAMETER_ERROR_SCEF_REFERENCE_ID_UNKNOWN within an RIA command, it shall
delete the event stored for the indicated SCEF-ID and SCEF-Reference-ID (see
3GPP TS 23.007 [19]).
#### 5.2.2.1 UE Loss of Connectivity
The following AVPs shall be present within the Monitoring-Event-Report AVP
when the UE Loss of Connectivity event is reported:
\- Monitoring-Type set to LOSS_OF_CONNECTIVITY (0)
The following AVPs may be present within the Monitoring-Event-Report AVP when
the UE Loss of Connectivity event is reported:
\- Loss-Of-Connectivity-Reason set to one of the values defined in 3GPP TS
29.336 [5]
#### 5.2.2.2 UE Reachability
The following AVPs shall be present within the Monitoring-Event-Report AVP
when the UE Reachability event is reported:
\- Monitoring-Type set to UE_REACHABILITY (1)
\- Reachability-Information set to REACHABLE_FOR_DATA(1)
The following AVPs may be present within the Monitoring-Event-Report AVP when
the UE Reachability event is reported:
\- Maximum-UE-Availability-Time
#### 5.2.2.3 Location Reporting
The following AVPs shall be present within the Monitoring-Event-Report AVP
when the location event is reported:
\- Monitoring-Type set to LOCATION_REPORTING (2)
\- EPS-Location-Information
#### 5.2.2.4 Communication Failure
The following AVPs shall be present within the Monitoring-Event-Report AVP
when the Communication Failure event is reported
\- Monitoring-Type set to COMMUNICATION_FAILURE (5)
\- Communication-Failure-Information (see clause 6.4.3)
#### 5.2.2.5 Availability after DDN failure
The following AVPs shall be present within the Monitoring-Event-Report AVP
when the Availablability after DDN failure event is reported:
\- Monitoring-Type set to AVAILABILITY_AFTER_DDN_FAILURE (6)
#### 5.2.2.6 Idle Status Indication
The following AVPs shall be present within the Monitoring-Event-Report AVP
when the Idle Status Indiciation event is reported:
\- Idle-Status-Timestamp;
\- Active-Time;
\- Subscribed-Periodic-RAU-TAU-Timer.
### 5.2.3 Detailed Behaviour of the SCEF
When the SCEF receives a Reporting Information Request from the MME/SGSN or
the IWK-SCEF and at least one of the Monitoring Event Report AVPs has a SCEF-
Reference-ID not known by the SCEF, it shall reply with Experimental-Result-
Code set to DIAMETER_ERROR_SCEF_REFERENCE_ID_UNKNOWN (see 3GPP TS 23.007
[19]). In that case, if the HSS had included multiple Monitoring Event Reports
in the RIR command, the SCEF shall include in the Reporting Information Answer
command a list of Monitoring-Event-Report-Status AVPs where the status of
multiple monitoring event reports is detailed. In that AVP list, the AVPs
corresponding to event reports with a successful status may be omitted by the
SCEF, for efficiency.
Otherwise when the SCEF receives a Reporting-Information-Request command from
the MME/SGSN or the IWK-SCEF, the SCEF shall set Result-Code to
DIAMETER_SUCCESS in the Reporting-Information-Answer and shall handle it
according to the procedures defined in 3GPP TS 23.682 [2].
### 5.2.4 Detailed Behaviour of the IWK-SCEF
When the IWK-SCEF receives a Reporting-Information-Request command from the
MME/SGSN it shall deliver the request to the SCEF after applying the roaming
policies configured at the IWK-SCEF, as specified in 3GPP TS 23.682 [2].
## 5.3 Event Configuration Procedure
### 5.3.1 General
This procedure is used between the SCEF and the MME and between the SCEF and
the SGSN to configure the monitoring events directly at the MME/SGSN through
the T6a/b interface.
When the procedure is invoked by the SCEF, it is used for configuring the
event(s):
\- the number of UEs at a given geographic location.
This procedure is mapped to the commands Configuration-Information-
Request/Answer in the Diameter application specified in clause 6. The tables
5.3.1-1 and 5.3.1-2 detail the involved information elements.
Table 5.3.1-1: Configuration Information Request
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | Monitoring Event | Monitoring-Ev | C | If present, this | | Configuration | ent-Configuration | | Information | | | | | Element shall | | (see clause | | | contain the | | 6.4.2) | | | details of the | | | | | Monitoring | | | | | event(s) | | | | | configured. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | Information | | | | | Element shall | | (See | | | contain the list | | 3GPP | | | of features | | TS 29.229 [4]) | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+
Table 5.3.1-2: Configuration Information Answer
+-------------------+-------------------+-----+-------------------+ | Information | Mapping to | Cat | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+-----+-------------------+ | Result | Result-Code / | M | Result of the | | | Ex | | request. | | (See 6.3) | perimental-Result | | | | | | | Result-Code AVP | | | | | shall be used for | | | | | errors defined in | | | | | the Diameter Base | | | | | Protocol. | | | | | | | | | | Ex | | | | | perimental-Result | | | | | AVP shall be used | | | | | for T6a/T6b | | | | | errors. This is a | | | | | grouped AVP which | | | | | contains the 3GPP | | | | | Vendor ID in the | | | | | Vendor-Id AVP, | | | | | and the error | | | | | code in the | | | | | Experim | | | | | ental-Result-Code | | | | | AVP. | +-------------------+-------------------+-----+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See | | | contain the list | | 3GPP | | | of features | | TS 29.229 [4]) | | | supported by the | | | | | origin host. | +-------------------+-------------------+-----+-------------------+ | Monitoring Event | Monito | C | If an immediate | | Report | ring-Event-Report | | report is | | | | | available this | | (see | | | information | | 3GP | | | element shall | | P TS 29.336 [5] | | | contain the | | clause 8.4.3) | | | requested data | | | | | available in the | | | | | MME/SGSN. | +-------------------+-------------------+-----+-------------------+ | Monitoring | Monitoring-Ev | O | If present it | | Ev | ent-Config-Status | | shall contain the | | ent-Configuration | | | status of each | | Status | | | monitoring event | | | | | configuration | | (see | | | identified by an | | 3GP | | | SCEF-Reference-ID | | P TS 29.336 [5] | | | | | clause 8.4.24) | | | | +-------------------+-------------------+-----+-------------------+
### 5.3.2 Detailed Behaviour of the MME/SGSN
Monitoring Events configuration and deletion directly at the MME/SGSN for
roaming scenarios is not supported. For the non roaming cases, when the
Configuration-Information-Request is received from the SCEF, the MME/SGSN
shall, in the following order:
1\. Check whether the requesting SCEF is authorized to request the specified
service (e.g: number of UEs at a given geographic location). If not,
Experimental-Result-Code shall be set to
DIAMETER_ERROR_UNAUTHORIZED_REQUESTING_ENTITY (5510) in the Configuration-
Information-Answer.
2\. If the TA / RA / ECGI location requested by the SCEF is not served by the
MME/SGSN, then the MME/SGSN shall set the Experimental-Result AVP to
DIAMETER_ERROR_REQUESTED_LOCATION_NOT_SERVED (5650) in the Configuration-
Information-Answer.
If there is an error in any of the above steps then the MME/SGSN shall stop
processing and shall return the error code specified in the respective step.
If the MME/SGSN cannot fulfil the received request for reasons not stated
above, it shall stop processing the request and set Result-Code to
DIAMETER_UNABLE_TO_COMPLY.
If CIR message includes multiple SCEF-Reference-ID and for a SCEF-Reference-ID
the monitoring events cannot be handled, the MME/SGSN shall report the failed
SCEF-Reference-ID to the SCEF with an appropriate status in the Monitoring-
Event-Config-Status AVP.
For the number of UEs in a geographic location monitoring event, for each
SCEF-Reference-ID that the MME/SGSN is able to successfully process, the
MME/SGSN shall
\- if filtering is not requested (i.e. IMSI-Group-Id was not present in the
request) or not supported:
include in the Configuration-Information-Answer, the exact count of the number
of UEs that are known to be at the requested location.
> \- if filtering is requested and (i.e. IMSI-Group-Id was present in the
> request) and supported:
include in the Configuration-Information-Answer, the exact count of the number
of UEs belonging to the provided IMSI Group that are known to be at the
requested location.
If the requested location type is current location, then the MME/SGSN may
activate the paging and RAN location reporting procedures (if required) before
providing the response in the Configuration-Information-Answer.
If the monitoring event configuration is for a continuous monitoring (i.e.
Monitoring-Duration and/or Maximum-Number-Of-Reports are set) and the deletion
criteria are met (i.e. Monitoring-Duration time expired and/or Maximum-Number-
Of-Reports are sent) the MME/SGSN shall locally delete the Monitoring event.
### 5.3.3 Detailed Behaviour of the IWK-SCEF
Monitoring Events configuration and deletion directly at the MME/SGSN for
roaming scenarios is not supported. Consequently the IWK-SCEF is not impacted
for Monitoring Events configuration and deletion directly at the MME/SGSN from
the SCEF.5.3.4 Detailed Behaviour of the SCEF
When the SCEF receives Monitoring Event Report AVP from the MME/SGSN or the
IWK-SCEF in the CIA command, it shall handle it according to the procedures
defined in 3GPP TS 23.682 [2].
When the SCEF receives a Monitoring Event Report AVP from the MME/SGSN with a
SCEF-Reference-ID not known by the SCEF, it should discard the Monitoring
Event Report received in CIA command.
## 5.4 Event Configuration Procedure for Roaming
### 5.4.1 General
The MME/SGSN shall send the monitoring event configuration information to the
IWK-SCEF in roaming scenarios, when the MME/SGSN receives the monitoring event
configuration from the HSS. The monitoring event configuration information
shall be locally consumed at the IWK-SCEF and the IWK-SCEF shall not route
such requests beyond it.
This procedure is mapped to the commands Configuration-Information-
Request/Answer in the Diameter application specified in clause 6. The tables
5.4.1-1 and 5.4.1-2 detail the involved information elements.
Table 5.4.1-1: Configuration-Information-Request
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | Monitoring Event | Monitoring-Ev | C | If present, this | | Configuration | ent-Configuration | | Information | | | | | Element shall | | (see 8.4.2) | | | contain the | | | | | details of | | | | | Monitoring | | | | | event(s). | +-------------------+-------------------+------+-------------------+ | Monitoring Event | Monito | C | If an immediate | | Report | ring-Event-Report | | report is | | | | | available this | | (see 8.4.3) | | | information | | | | | element shall | | | | | contain the event | | | | | reported by the | | | | | MME/SGSN. The | | | | | IWK-SCEF may | | | | | normalize the | | | | | event report and | | | | | return it in the | | | | | Configuration-In | | | | | formation-Answer. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | Information | | | | | Element shall | | (See 3GPP TS | | | contain the list | | 29.229 [7]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+
Table 5.4.1-2: Configuration-Information-Answer
+-------------------+-------------------+-----+-------------------+ | Information | Mapping to | Cat | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+-----+-------------------+ | Result | Result-Code / | M | Result of the | | | Ex | | request. | | (See 6.3) | perimental-Result | | | | | | | Result-Code AVP | | | | | shall be used for | | | | | errors defined in | | | | | the Diameter Base | | | | | Protocol. | | | | | | | | | | Ex | | | | | perimental-Result | | | | | AVP shall be used | | | | | for T6a/b errors. | | | | | This is a grouped | | | | | AVP which | | | | | contains the 3GPP | | | | | Vendor ID in the | | | | | Vendor-Id AVP, | | | | | and the error | | | | | code in the | | | | | Experim | | | | | ental-Result-Code | | | | | AVP. | +-------------------+-------------------+-----+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [7]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+-----+-------------------+ | Monitoring | Monitoring-Ev | O | If present it | | Ev | ent-Config-Status | | shall contain the | | ent-Configuration | | | status of each | | Status | | | monitoring event | | | | | configuration | | (see 3GPP TS | | | identified by an | | 29.336 [5] | | | SCEF-Reference-ID | | clause 8.4.24) | | | | +-------------------+-------------------+-----+-------------------+
### 5.4.2 Detailed Behaviour of the IWK-SCEF
When the Configuration-Information-Request is received from the MME/SGSN, the
IWK-SCEF shall, in the following order:
1\. Check whether the requesting SCEF, identified by the SCEF-ID is authorized
to request the specified service at the VPLMN. If not, Experimental-Result
shall be set to DIAMETER_ERROR_UNAUTHORIZED_REQUESTING_ENTITY (5510) in the
Configuration-Information-Answer.
2\. Check whether the chargeable party for the monitoring event is authorized
to be charged at the VPLMN. If not, Experimental-Result shall be set to
DIAMETER_ERROR_UNAUTHORIZED_REQUESTING_ENTITY (5510) in the Configuration-
Information-Answer.
If the monitoring event configuration also carries the monitoring event
report, the IWK-SCEF checks if the immediate events reported by the MME/SGSN
needs to be normalized. If yes, the IWK-SCEF shall normalize the event report
as per local policies. The IWK-SCEF shall then send the normalized monitoring
event report towards the SCEF as a separate Reporting-Information-Request
message.
If the monitoring event configuration is for a continuous monitoring (i.e.
Monitoring-Duration and/or Maximum-Number-Of-Reports are set), then the IWK-
SCEF shall temporarily store the monitoring event configuration until the
deletion criteria for the monitoring event configuration is met. If the
deletion criteria are met, the IWK-SCEF shall delete the Monitoring event
locally. The stored monitoring event configuration information shall be used
during subsequent monitoring event report procedure, to generate the charging
records towards the right chargeable party.
If the received SCEF Reference ID for Deletion does not exist, the IWK-SCEF
shall set the Experimental-Result-Code to
DIAMETER_ERROR_CONFIGURATION_EVENT_NON_EXISTANT (5514).
If the SCEF-Reference-ID exists and the old configuration data could not be
replaced by new Configuration event data, the HSS shall set the Experimental-
Result-Code to DIAMETER_ERROR_CONFIGURATION_EVENT_STORAGE_NOT_SUCCESSFUL
(5513).
If the IWK-SCEF cannot fulfil the received request for reasons not stated in
the above, it shall stop processing the request and set Result-Code to
DIAMETER_UNABLE_TO_COMPLY.
The details how to handle expiring of Monitoring events is described in 3GPP
TS 23.682 [2]
### 5.4.3 Detailed Behaviour of the MME/SGSN
When the MME/SGSN receives the Configuration-Information-Answer from the IWK-
SCEF, it shall handle it as follows: For the monitoring event configurations
for which the configuration status have changed since last informed to the
HSS, the MME/SGSN shall report the status to the HSS through a Notify-Request
command as specified in clause 5.2.5 of 3GPP TS 29.272 [16].
## 5.5 MO-Data Procedure
### 5.5.1 General
This procedure shall be used between the MME/SGSN and the SCEF, between the
MME/SGSN and the IWK-SCEF and between the IWK-SCEF and the SCEF.
When the procedure is invoked by the MME or SGSN, it is used to forward mobile
originated Non-IP data of a mobile user from the MME or SGSN to the SCEF. The
procedure is also invoked by the MME on reception of RRC cause \"MO Exception
data\".
This procedure is used according to 3GPP TS 23.682 [2] clause 5.13.4.
The IWK-SCEF may be in the path between the MME/SGSN and the SCEF for roaming
cases when the IWK-SCEF is deployed by the operator of the visited PLMN.
When the procedure is invoked by the IWK-SCEF, it is used to forward mobile
originated Non-IP data received from the MME or SGSN to the SCEF.
This procedure is mapped to the commands MO-Data-Request/Answer (ODR/ODA) in
the Diameter application specified in clause 6.
The tables 5.5.1-1 and 5.5.1-2 detail the involved information elements.
Table 5.5.1-1: MO Data Request
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | User Identity | User-Identifier | M | This Information | | | | | Element shall be | | (See 6.4.16) | | | present and shall | | | | | contain the | | | | | identity of the | | | | | UE. This is a | | | | | grouped AVP which | | | | | shall contain the | | | | | IMSI. | +-------------------+-------------------+------+-------------------+ | EPS Bearer | Bearer-Identifier | M | This information | | Identity | | | element shall be | | | | | present and shall | | (See 6.4.17) | | | contain either | | | | | the identity of | | | | | the EPS bearer | | | | | identifying the | | | | | T6a connection, | | | | | or the NSAPI of | | | | | the PDP context | | | | | identifying the | | | | | T6b connection, | | | | | for the Non-IP | | | | | data delivery. | +-------------------+-------------------+------+-------------------+ | Non IP data | Non-IP-Data | C | This information | | | | | element shall | | (See 6.4.19) | | | contain the | | | | | Non-IP data to be | | | | | delivered to the | | | | | SCEF. | | | | | | | | | | This Information | | | | | Element shall be | | | | | present when the | | | | | request conveys | | | | | Non-IP data. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+ | MO Exception Data | RRC-Cause-Counter | C | The MME shall | | Counter | | | include this | | | | | Information | | (see 6.4.27) | | | Element when MME | | | | | needs to send a | | | | | non-zero counter | | | | | value for the MO | | | | | Exception Data | | | | | Counter. The | | | | | timestamp in the | | | | | counter shall be | | | | | set with the time | | | | | at which the | | | | | counter value | | | | | increased from 0 | | | | | to 1. | +-------------------+-------------------+------+-------------------+
Table 5.5.1-2: MO Data Answer
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | Result | Result-Code / | M | Result of the | | | Ex | | request. | | (See 6.3) | perimental-Result | | | | | | | Result-Code AVP | | | | | shall be used for | | | | | errors defined in | | | | | the Diameter Base | | | | | Protocol. | | | | | | | | | | Ex | | | | | perimental-Result | | | | | AVP shall be used | | | | | for T6a/b errors. | | | | | This is a grouped | | | | | AVP, which | | | | | contains the 3GPP | | | | | Vendor ID in the | | | | | Vendor-Id AVP, | | | | | and the error | | | | | code in the | | | | | Experim | | | | | ental-Result-Code | | | | | AVP. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+
### 5.5.2 Detailed Behaviour of the MME/SGSN
The MME shall make use of this procedure over a T6a connection identified by
its EPS bearer identity and previously established with the SCEF to forward
the Non-IP data received from the UE to the SCEF or to an IWK-SCEF when
deployed for a roaming case.
The SGSN shall make use of this procedure over a T6b connection identified by
the NSAPI of the PDP context, and previously established with the SCEF, to
forward the Non-IP data received from the UE to the SCEF or to an IWK-SCEF
when deployed for a roaming case.
The MME shall increment the \"MO Exception data counter\" by one each time the
MME has received the RRC cause \"MO Exception data\". The MME may defer
sending a MO Data command message to report a non-zero value for the MO
Exception Data Counter based on local configuration.
If the MME has sent the RRC-Cause-Counter for RRC Cause \"MO Exception data\"
in the MO Data Request command the MME shall reset the RRC-Cause-Counter when
receiving MO Data Answer command.
When receiving a Permanent Failure Result-Code/Experimental-Result, the MME or
SGSN shall initiate a PDN disconnection procedure or Detach procedure towards
the UE and if the permanent failure is different from DIAMETER_ERROR_
INVALID_EPS_BEARER and different from DIAMETER_ERROR_USER_UNKNOWN, the MME or
SGSN shall make use of the \"Connection Management by MME/SGSN\" Procedure
(see clause 5.7) to release the T6a/b connection between the MME/SGSN and the
SCEF.
### 5.5.3 Detailed Behaviour of the SCEF
When the SCEF receives a MO Data Request from the MME/SGSN or the IWK-SCEF,
the SCEF shall, in the following order:
\- Check that the User Identity exists in the SCEF. If not, Experimental-
Result shall be set to DIAMETER_ERROR_USER_UNKNOWN in the MO Data Answer;
\- Check if, for this user, a bearer context exists. If not, Experimental-
Result shall be set to DIAMETER_ERROR_ INVALID_EPS_BEARER in the MO Data
Answer;
_-_ Process the delivery of the data (if available) to the SCS/AS and/or
process the RRC Cause Counter (if available). If the processing of either of
them is not successful, return an appropriate Diameter error code, otherwise
return a Result code set to DIAMETER_SUCCESS to the MME/SGSN or IWK-SCEF. If
the data delivery to the SCS/AS has failed due to there being no NIDD
configuration context with an SCS/AS, set the Experimental-Result to
DIAMETER_ERROR_NIDD_CONFIGURATION_NOT_AVAILABLE in the MO Data Answer.
NOTE: The Diameter Result-Code / Experimental-Result returned by the SCEF can
depend on the error returned by the SCS/AS to the SCEF. The interface between
the SCEF and the SCS/AS is out of scope of 3GPP.
### 5.5.4 Detailed Behaviour of the IWK-SCEF
When the IWK-SCEF receives a MO Data Request from the MME or SGSN, it shall
forward the request to the SCEF.
When the IWK-SCEF receives a MO Data Answer from the SCEF, it shall forward
the answer to the MME or SGSN.
## 5.6 MT Data Procedure
### 5.6.1 General
This procedure shall be used between the SCEF and the MME or SGSN, between the
SCEF and the IWK-SCEF and between the IWK-SCEF and the MME or SGSN.
When the procedure is invoked by the SCEF, it is used to forward mobile
terminated Non-IP data of a mobile user from the SCEF to the MME or SGSN.
This procedure is used according to 3GPP TS 23.682 [2] clause 5.13.3.
The IWK-SCEF may be in the path between the SCEF and the MME/SGSN for roaming
cases when the IWK-SCEF is deployed by the operator of the visited PLMN.
When the procedure is invoked by the IWK-SCEF, it is used to forward mobile
terminated Non-IP data received from the SCEF to the MME or SGSN.
This procedure is mapped to the commands MT-Data-Request/Answer (TDR/TDA) in
the Diameter application specified in clause 6.
The tables 5.6.1-1 and 5.6.1-2 detail the involved information elements.
NOTE: The corresponding message name in 3GPP TS 23.682 [2] is \"NIDD Submit
Request\".
Table 5.6.1-1: MT Data Request
+-------------------+-------------------+-------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+-------+-------------------+ | User Identity | User-Identifier | M | This Information | | | | | Element shall be | | (See 6.4.16) | | | present and shall | | | | | contain the | | | | | identity of the | | | | | UE. This is a | | | | | grouped AVP which | | | | | shall contain the | | | | | IMSI. | +-------------------+-------------------+-------+-------------------+ | EPS Bearer | Bearer-Identifier | M | This information | | Identity | | | element shall be | | | | | present and shall | | (See 6.4.17) | | | contain either | | | | | the identity of | | | | | the EPS bearer | | | | | identifying the | | | | | T6a connection, | | | | | or the NSAPI of | | | | | the PDP context | | | | | identifying the | | | | | T6b connection, | | | | | for the Non-IP | | | | | data delivery. | +-------------------+-------------------+-------+-------------------+ | Non-IP Data | Non-IP-Data | C | This information | | | | | element shall | | (See 6.4.19) | | | contain the | | | | | Non-IP data to be | | | | | delivered to the | | | | | MME or SGSN. | | | | | | | | | | This Information | | | | | Element shall be | | | | | present when the | | | | | request conveys | | | | | Non-IP data. | +-------------------+-------------------+-------+-------------------+ | SCEF Wait Time | SCEF-Wait-Time | **O** | This information | | | | | element, when | | (See 6.4.24) | | | present, shall | | | | | indicate the | | | | | timestamp (in | | | | | UTC) until which | | | | | the SCEF expects | | | | | a response. | +-------------------+-------------------+-------+-------------------+ | Maximum | Maximum-Re | **O** | This information | | Retransmission | transmission-Time | | element, when | | Time | | | present, shall | | | | | indicate the | | (See 3GPP TS | | | maximum | | 29.338 [27]) | | | retransmission | | | | | time (in UTC) | | | | | until which the | | | | | SCEF is capable | | | | | to retransmit the | | | | | MT Non-IP Data. | +-------------------+-------------------+-------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+-------+-------------------+
Table 5.6.1-2: MT Data Answer
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | Result | Result-Code / | M | This information | | | Ex | | element shall | | (See 6.3) | perimental-Result | | contain the | | | | | Result of the | | | | | request. | | | | | | | | | | The Result-Code | | | | | AVP shall be used | | | | | to indicate | | | | | success or errors | | | | | as defined in the | | | | | Diameter Base | | | | | Protocol. | | | | | | | | | | The | | | | | Ex | | | | | perimental-Result | | | | | AVP shall be used | | | | | for T6a/b errors. | | | | | This is a grouped | | | | | AVP, which | | | | | contains the 3GPP | | | | | Vendor ID in the | | | | | Vendor-Id AVP, | | | | | and the error | | | | | code in the | | | | | Experim | | | | | ental-Result-Code | | | | | AVP. | +-------------------+-------------------+------+-------------------+ | Requested | Requested-Re | O | This information | | Retransmission | transmission-Time | | element may be | | Time | | | present if the | | | | | Experim | | (See 3GPP TS | | | ental-Result-Code | | 29.338 [27]) | | | is set to | | | | | DIAMETER_ERR | | | | | OR_USER_TEMPORA | | | | | RILY_UNREACHABLE | | | | | and the Maximum | | | | | Retransmission | | | | | Time information | | | | | element is | | | | | present in the MT | | | | | Data Request. It | | | | | may be included | | | | | if the UE is | | | | | using a power | | | | | saving mechanism | | | | | (such as extended | | | | | idle mode DRX) | | | | | and the UE is | | | | | currently not | | | | | reachable. | | | | | | | | | | When present, | | | | | this shall | | | | | indicate the | | | | | retransmission | | | | | time (in UTC) at | | | | | which the SCEF is | | | | | requested to | | | | | retransmit the MT | | | | | Non-IP Data. The | | | | | Requested | | | | | Retransmission | | | | | Time shall not | | | | | exceed the | | | | | Maximum | | | | | Retransmission | | | | | Time received | | | | | from the SCEF. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+ | TDA Flags | TDA-Flags | O | This Information | | | | | Element contains | | (See 6.4.31) | | | a bit mask. See | | | | | clause 6.4.31 for | | | | | the meaning of | | | | | the bits and the | | | | | condition for | | | | | each bit to be | | | | | set or not. | +-------------------+-------------------+------+-------------------+
### 5.6.2 Detailed Behaviour of the SCEF
The SCEF shall make use of this procedure over a T6a connection identified by
its EPS Bearer Identity, and previously established with the MME, to forward
the Non-IP data received from the SCS/AS to the MME or to an IWK-SCEF when
deployed for a roaming case.
The SCEF shall make use of this procedure over a T6b connection identified by
the NSAPI of the PDP context, and previously established with the SGSN, to
forward the Non-IP data received from the SCS/AS to the SGSN or to an IWK-SCEF
when deployed for a roaming case.
The SCEF shall check if a bearer context exists for the user before sending
the request.
The SCEF may include the Maximum-Retransmission-Time AVP in the MT Data
Request to indicate the maximum retransmission time for when it is capable to
retransmit the Non-IP Data.
If the MT Data Answer includes the Requested-Retransmission-Time AVP, the SCEF
shall retransmit the MT Non-IP Data at the requested retransmission time.
### 5.6.3 Detailed Behaviour of the MME/SGSN
When the MME or SGSN receives a MT Data Request from the SCEF or the IWK-SCEF,
the MME or SGSN shall, in the following order:
\- Check that the User Identity exists in the MME or SGSN. If not,
Experimental-Result shall be set to DIAMETER_ERROR_USER_UNKNOWN in the MT Data
Answer;
\- Check whether, for this user, a bearer context exists. If not,
Experimental-Result shall be set to DIAMETER_ERROR_ INVALID_EPS_BEARER in the
MT Data Answer.
_-_ Process the data delivery to the UE and:
\- if it is successful, return a Result code set to DIAMETER_SUCCESS to the
SCEF or IWK-SCEF; in addition, if the successful delivery was acknowledged by
the eNodeB, the MME/SGSN shall set the \"Success Acknowledged Delivery\" bit
within the TDA-Flags AVP.
\- return an Experimental-Result set to
DIAMETER_ERROR_USER_TEMPORARILY_UNREACHABLE, if the UE is using a power saving
function (e.g. extended idle mode DRX or UE Power Saving Mode as defined in
3GPP TS 23.682 [27]) and the UE is expected to not be reachable shortly or,
based on MME or SGSN implementation, within the time indicated by the SCEF-
Wait-Time;\ \ The MME or SGSN shall set the Not Reachable for NIDD flag and
store the SCEF Host and Realm for which this flag is set;\ \ If the MT Data
Request includes the Maximum-Retransmission-Time AVP, the MME or SGSN may
additionally include the Requested-Retransmission-Time AVP requesting the SCEF
to retransmit the Non-IP Data at a later time prior to the Maximum
Retransmission Time;\ \ The MME or SGSN shall then update the SCEF, as
specified in clause 5.7, when it detects that the UE is reachable or about to
become reachable and the Not Reachable for NIDD flag is set. If the MME or
SGSN included the Requested-Retransmission-Time AVP in the MT Data Answer, the
MME or SGSN shall do so only if the UE becomes reachable before the Requested
Retransmission Time, i.e. the MME or SGSN shall reset the Not Reachable for
NIDD flag when the Requested-Retransmission-Time expires if the UE has not
become reachable beforehand;
\- return an Experimental-Result set to DIAMETER_ERROR_UNREACHABLE_USER, if
the UE is not reachable;
\- otherwise return an appropriate Diameter error code.
### 5.6.4 Detailed Behaviour of the IWK-SCEF
When the IWK-SCEF receives a MT Data Request from the SCEF, it shall forward
the request to the MME or SGSN.
When the IWK-SCEF receives a MT Data Answer from the MME or SGSN, it shall
forward the answer to the SCEF.
## 5.7 Connection Management by MME/SGSN Procedure _._
### 5.7.1 General
This procedure shall be used between the MME/SGSN and the SCEF, between the
MME/SGSN and the IWK-SCEF and between the IWK-SCEF and the SCEF.
When the procedure is invoked by the MME or SGSN, it is used:
\- to establish a T6a/b connection between the MME/SGSN and the SCEF;
\- to update the parameters (e.g. RAT-Type) for a T6a/b connection between the
MME/SGSN and the SCEF;
\- to update the status of a T6a/b connection between the MME/SGSN and the
SCEF, e.g. to indicate to the SCEF that the UE has become or is about to
become reachable when MT non-IP data is pending at the SCEF for a UE using a
power saving function;
This procedure is used according to 3GPP TS 23.682 [2] clause 5.13.1 and
5.13.5 and 5.13.6. The IWK-SCEF may be in the path between the MME/SGSN and
the SCEF for roaming cases when the IWK-SCEF is deployed by the operator of
the visited PLMN.
When the procedure is invoked by the IWK-SCEF, it is used to forward the
Connection Management Request received from the MME or SGSN to the SCEF.
This procedure is mapped to the commands Connection-Management-Request/Answer
(CMR/CMA) in the Diameter application specified in clause 6.
The tables 5.7.1-1 and 5.7.1-2 detail the involved information elements.
Table 5.7.1-1: Connection Management Request
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | User Identity | User-Identifier | M | This Information | | | | | Element shall be | | (See 6.4.16) | | | present and shall | | | | | contain the | | | | | identity of the | | | | | UE. This is a | | | | | grouped AVP which | | | | | shall contain the | | | | | IMSI. | +-------------------+-------------------+------+-------------------+ | EPS Bearer | Bearer-Identifier | M | This Information | | Identity | | | Element shall be | | | | | present and shall | | (See 6.4.17) | | | contain either | | | | | the identity of | | | | | the EPS bearer | | | | | identifying the | | | | | T6a connection, | | | | | or the NSAPI of | | | | | the PDP context | | | | | of the T6b | | | | | connection, to | | | | | which the request | | | | | applies. | +-------------------+-------------------+------+-------------------+ | T6a/b Connection | Connection-Action | M | This Information | | Action | | | element shall be | | | | | present and shall | | (See 6.4.18) | | | contain a T6a/b | | | | | connection | | | | | management action | | | | | indicating a | | | | | T6a/b connection | | | | | establishment or | | | | | a T6a/b | | | | | connection | | | | | release or a | | | | | T6a/b connection | | | | | update. | +-------------------+-------------------+------+-------------------+ | APN | Service-Selection | C | This Information | | | | | element shall | | (See 6.4.20) | | | contain the APN | | | | | the user wants to | | | | | connect to. | | | | | | | | | | It shall be | | | | | present if the | | | | | request is for a | | | | | T6a/b connection | | | | | establishment. | +-------------------+-------------------+------+-------------------+ | Serving PLMN Rate | Serving- | O | If present, this | | Control | PLMN-Rate-Control | | information | | | | | element shall | | (See 6.4.21) | | | contain the | | | | | Serving PLMN rate | | | | | control set by | | | | | the MME. | +-------------------+-------------------+------+-------------------+ | CMR Flags | CMR-Flags | O | This Information | | | | | Element contains | | (See 6.4.25) | | | a bit mask. See | | | | | clause 6.4.25 for | | | | | the meaning of | | | | | the bits and the | | | | | condition for | | | | | each bit to be | | | | | set or not. | +-------------------+-------------------+------+-------------------+ | Maximum UE | Maximum-UE- | O | This information | | Availability Time | Availability-Time | | element may be | | | | | included, if | | (See 3GPP TS | | | available, if the | | 29.338 [27]) | | | Connection-Action | | | | | AVP indicates a | | | | | T6a/b connection | | | | | update and the | | | | | UE-Re | | | | | achable-Indicator | | | | | is set in the | | | | | CMR-Flags AVP. | | | | | | | | | | When present, it | | | | | shall indicate | | | | | the timestamp (in | | | | | UTC) until which | | | | | a UE using a | | | | | power saving | | | | | mechanism (such | | | | | as extended idle | | | | | mode DRX) is | | | | | expected to be | | | | | reachable for MT | | | | | Non-IP Data | | | | | Delivery. | | | | | | | | | | This information | | | | | may be used by | | | | | the SCEF to | | | | | prioritize the | | | | | retransmission of | | | | | MT Non-IP Data to | | | | | UEs using a power | | | | | saving mechanism. | +-------------------+-------------------+------+-------------------+ | Extended PCO | Extended-PCO | C | This Information | | | | | Element shall be | | | | | present, if the | | | | | MME or SGSN | | | | | receives Extended | | | | | PCO information | | | | | from the UE. | +-------------------+-------------------+------+-------------------+ | 3GPP Charging | 3GPP-Chargin | C | This Information | | Characteristics | g-Characteristics | | element shall | | | | | contain the PDN | | (See 3GPP TS | | | Connection | | 32.298 [30] | | | Charging | | | | | Characteristics | | | | | data for an APN | | | | | Configuration | | | | | with SCEF-based | | | | | NIDD mechanism. | | | | | | | | | | It shall be | | | | | present if the | | | | | request is for a | | | | | T6a/b connection | | | | | establishment and | | | | | may be present if | | | | | the request is | | | | | for a T6a/b | | | | | connection | | | | | update. | +-------------------+-------------------+------+-------------------+ | RAT-Type | RAT-Type | C | This Information | | | | | Element shall | | (See 3GPP TS | | | contain the used | | 29.212 [10]) | | | RAT Type. | | | | | | | | | | It shall be | | | | | present if the | | | | | request is for a | | | | | T6a/b connection | | | | | establishment or | | | | | for a T6a/b | | | | | connection | | | | | update. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+ | Terminal | Ter | C | This Information | | Information | minal-Information | | Element shall | | | | | contain the | | (See 3GPP TS | | | identity of the | | 29.272 [16]) | | | UE. | | | | | | | | | | It shall be | | | | | present if | | | | | available. | +-------------------+-------------------+------+-------------------+ | Visited PLMN ID | Visited-PLMN-Id | C | This Information | | | | | Element shall | | (See 3GPP TS | | | contain the | | 29.272 [16]) | | | identity (MCC and | | | | | MNC) of serving | | | | | PLMN. | | | | | | | | | | It shall be | | | | | present if the | | | | | request is for a | | | | | T6a/b connection | | | | | establishment or | | | | | for a T6a/b | | | | | connection | | | | | update. | +-------------------+-------------------+------+-------------------+
Table 5.7.1-2: Connection Management Answer
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | Result | Result-Code / | M | Result of the | | | Ex | | request. | | (See 6.3) | perimental-Result | | | | | | | Result-Code AVP | | | | | shall be used for | | | | | errors defined in | | | | | the Diameter Base | | | | | Protocol. | | | | | | | | | | Ex | | | | | perimental-Result | | | | | AVP shall be used | | | | | for T6a/b errors. | | | | | This is a grouped | | | | | AVP, which | | | | | contains the 3GPP | | | | | Vendor ID in the | | | | | Vendor-Id AVP, | | | | | and the error | | | | | code in the | | | | | Experim | | | | | ental-Result-Code | | | | | AVP. | +-------------------+-------------------+------+-------------------+ | NIDD Charging | PDN-Conne | C | This Information | | Identifier | ction-Charging-Id | | element is | | | | | defined in | | (See 3GPP TS | | | 3GPP | | 32.299 [22]) | | | TS 32.253 [23] | | | | | and shall be | | | | | present if the | | | | | answer is for a | | | | | T6a/b connection | | | | | establishment. | +-------------------+-------------------+------+-------------------+ | Extended PCO | Extended-PCO | C | This Information | | | | | Element shall be | | | | | present, if the | | | | | SCEF needs to | | | | | send Extended PCO | | | | | information to | | | | | the UE. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+
### 5.7.2 Detailed Behaviour of the MME/SGSN
The MME or SGSN shall make use of this procedure to request one of the
following T6a/b connection management actions:
\- for a T6a/b connection establishment, the MME shall:
\- include the user\'s IMSI.
\- fill the EPS Bearer Identity information element with either the identity
of the EPS bearer that MME allocated to the Non-IP PDN connection, or the
NSAPI of the PDP context used by the SGSN for the Non-IP connection, as
described in 3GPP TS 23.682 [2];
\- if Serving PLMN Rate Control is configured, the MME shall include the
Serving PLMN Rate Control information as described in 3GPP TS 23.401 [25];
\- for a T6a/b connection release, the MME or SGSN shall:
\- fill the EPS Bearer Identity information element with the identity of the
EPS bearer of the T6a connection, or the NSAPI of the PDP context of the T6b
connection, which is released as described in 3GPP TS 23.682 [2];
\- upon getting the Connection Management Answer from the SCEF, delete the
T6a/b connection context;
\- for a T6a/b connection update, the MME or SGSN shall:
\- fill the EPS Bearer Identity information element with the identity of the
EPS bearer of the T6a connection, or the NSAPI of the PDP context of the T6b
connection, that needs to be updated;
\- set the UE-Reachable-Indicator in the CMR-Flags AVP if the UE has become or
is about to become reachable. The MME or SGSN may additionally include the
Maximum UE Availability Time AVP, if available, to indicate the timestamp (in
UTC) until which a UE using a power saving mechanism (such as extended idle
mode DRX) is expected to be reachable for MT Non-IP Data Delivery;
\- upon getting the Connection Management Answer from the SCEF, reset the Not
Reachable for NIDD flag if this flag was set and if the UE-Reachable-Indicator
was set in the CMR-Flags AVP in the Connection Management Request;
\- if Serving PLMN Rate Control needs to be added or updated, the MME shall
include Serving PLMN Rate Control information as described in 3GPP TS 23.401
[25].
NOTE: If the UE has several T6a/b connections to the same SCEF, for which Non-
IP data is pending, the MME or SGSN initiates a T6a/b connection update for
only one of the T6a/b connections towards this SCEF; the UE can have either
T6a or T6b connections, but not both simultaneously.
If the MME or SGSN receives the Extended-PCO AVP in the Connection Management
Answer from the SCEF, the MME or SGSN shall forward the Extended-PCO to the UE
transparently, as specified in 3GPP TS 24.301 [28].
### 5.7.3 Detailed Behaviour of the SCEF
When the SCEF receives a Connection Management Request from the MME or SGSN
the SCEF shall, in the following order:
\- check that the User Identity exists in the SCEF. If not, Experimental-
Result shall be set to DIAMETER_ERROR_USER_UNKNOWN in the Connection
Management Answer;
\- check that the T6a/b connection action indicates a T6a/b connection
establishment, a T6a/b connection release or a T6a/b connection update. If
not, the Experimental-Result shall be set to
DIAMETER_ERROR_OPERATION_NOT_ALLOWED in the Connection Management Answer;
\- if the T6a/b connection action indicates a T6a/b connection establishment:
\- check whether a valid NIDD configuration exists for the UE at the SCEF;
If not, the SCEF shall:
\- reject the Connection Management Request, with Experimental-Result set to
DIAMETER_ERROR_NIDD_CONFIGURATION_NOT_AVAILABLE in the Connection Management
Answer, or
\- accept the Connection Management Request, and initiate a NIDD Configuration
procedure with a default SCS/AS configured in the SCEF and the MSISDN or an
external ID obtained from the HSS, as specified in 3GPP TS 29.336 [5] clause
7.2.3.2. If such NIDD Configuration procedure fails, the SCEF shall reject the
Connection Management Request, with Experimental-Result set to
DIAMETER_ERROR_NIDD_CONFIGURATION_NOT_AVAILABLE in the Connection Management
Answer;
\- create an EPS bearer context;
\- store the MME or SGSN Identity identified by the Origin-Host AVP of the
T6a/b Connection Management Request, and the MME or SGSN realm identified by
the Origin-Realm AVP of the T6a/b Connection Management Request in the EPS
bearer context;
\- include the Extended-PCO AVP in the Connection Management Answer, if the
Extended PCO information (e.g. APN Rate Control information) needs to be
provided to the UE;
\- if Serving PLMN Rate Control is provided by the MME, restrict the number of
messages for the downlink to not exceed the values provided in Serving PLMN
Rate Control. If it is not provided and Serving PLMN Rate Control is active,
then continue using the previously provided values;
\- If successful, Result shall be set to DIAMETER_SUCCESS in the Connection
Management Answer;
\- if the T6a/b connection action indicates a T6a/b connection release:
\- check whether, for this user and the received EPS bearer ID, a T6a
connection context exists. If not, Experimental-Result shall be set to
DIAMETER_ERROR_INVALID_EPS_BEARER in the Connection Management Answer;
\- include the Extended-PCO AVP in the Connection Management Answer, if the
Extended PCO information needs to be provided to the UE;
\- delete the T6a/b connection context at the SCEF. If successful, Result code
shall be set to DIAMETER_SUCCESS in the Connection Management Answer;
\- if the T6a/b connection action indicates a T6a connection update:
\- check whether, for this user and the received EPS Bearer Identity, a T6a/b
connection context exists. If not, Experimental-Result shall be set to
DIAMETER_ERROR_INVALID_EPS_BEARER in the Connection Management Answer;
\- if successful:
\- if Serving PLMN Rate Control is provided by the MME, restrict the number of
messages for the downlink to not exceed the values provided in Serving PLMN
Rate Control. If it is not provided and Serving PLMN Rate Control is active,
then continue using the previously provided values;
\- include the Extended-PCO AVP in the Connection Management Answer, if the
Extended PCO information (e.g. APN Rate Control information) needs to be
provided to the UE;
\- store the MME or SGSN Identity identified by the Origin-Host AVP of the
T6a/b Connection Management Request and the MME or SGSN realm identified by
the Origin-Realm AVP of the T6a/b Connection Management Request, if the MME or
SGSN identity has changed, in the bearer context, and the Result shall be set
to DIAMETER_SUCCESS in the Connection Management Answer;
\- if the UE-Reachable-Indicator was set in the CMR-Flags AVP, forward any MT
Non-IP data pending for any T6a/b connection for this UE, to the MME or SGSN.
If the Serving-PLMN-Rate-Control AVP is included in the Connection Management
Request message from the MME, the SCEF shall enforce the Serving PLMN Rate
Control as specified in 3GPP TS 23.401 [12] clause 4.7.7.2.
### 5.7.4 Detailed Behaviour of the IWK-SCEF
When the IWK-SCEF receives a Connection Management Request from the MME or
SGSN, it shall forward the request to the SCEF.
When the IWK-SCEF receives a Connection Management Answer from the SCEF, it
shall forward the answer to the MME or SGSN.
## 5.8 Connection Management by SCEF Procedure
#### 5.8.1 General
This procedure shall be used between the SCEF and the MME/SGSN, and between
the SCEF and the MME/SGSN via the IWK-SCEF acting as a Diameter proxy agent
for roaming cases.
When the procedure is invoked by the SCEF, it is used
\- to update the parameters (e.g. Extended PCO information) associated to a
T6a/b connection between the MME/SGSN and the SCEF;
\- to release a T6a/b connection between MME/SGSN and SCEF.
This procedure is used according to 3GPP TS 23.682 [2]. The IWK-SCEF may be in
the path between the MME/SGSN and the SCEF for roaming cases when the IWK-SCEF
is deployed by the operator of the visited PLMN.
This procedure is mapped to the commands Connection-Management-Request/Answer
(CMR/CMA) in the Diameter application specified in clause 6.
The tables 5.8.1-1 and 5.8.1-2 detail the involved information elements.
Table 5.8.1-1: Connection Management SCEF Request
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | User Identity | User-Identifier | M | This Information | | | | | Element shall be | | (See 6.4.16) | | | present and shall | | | | | contain the | | | | | identity of the | | | | | UE. This is a | | | | | grouped AVP | | | | | containing the | | | | | IMSI. | +-------------------+-------------------+------+-------------------+ | EPS Bearer | Bearer-Identifier | M | This Information | | Identity | | | Element shall be | | | | | present and shall | | (See 6.4.17) | | | contain either | | | | | the identity of | | | | | the EPS bearer | | | | | identifying the | | | | | T6a connection, | | | | | or the NSAPI of | | | | | the PDP context | | | | | identifying the | | | | | T6b connection, | | | | | to which the | | | | | request applies. | +-------------------+-------------------+------+-------------------+ | T6a/b Connection | Connection-Action | M | This Information | | Action | | | element shall be | | | | | present and shall | | (See 6.4.18) | | | contain a T6a/b | | | | | connection | | | | | management action | | | | | indicating a | | | | | T6a/b connection | | | | | update. | +-------------------+-------------------+------+-------------------+ | Extended PCO | Extended-PCO | C | This Information | | | | | Element shall be | | (see 6.4.26) | | | present if the | | | | | SCEF needs to | | | | | send updated | | | | | Extended PCO | | | | | information (e.g. | | | | | APN Rate Control | | | | | information) to | | | | | the UE. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+
Table 5.8.1-2: Connection Management SCEF Answer
+-------------------+-------------------+------+-------------------+ | Information | Mapping to | Cat. | Description | | Element Name | Diameter AVP | | | +-------------------+-------------------+------+-------------------+ | Result | Result-Code / | M | Result of the | | | Ex | | request. | | (See 6.3) | perimental-Result | | | | | | | Result-Code AVP | | | | | shall be used for | | | | | errors defined in | | | | | the Diameter Base | | | | | Protocol. | | | | | | | | | | Ex | | | | | perimental-Result | | | | | AVP shall be used | | | | | for T6a/b errors. | | | | | This is a grouped | | | | | AVP, which | | | | | contains the 3GPP | | | | | Vendor ID in the | | | | | Vendor-Id AVP, | | | | | and the error | | | | | code in the | | | | | Experim | | | | | ental-Result-Code | | | | | AVP. | +-------------------+-------------------+------+-------------------+ | Supported | S | O | If present, this | | Features | upported-Features | | information | | | | | element shall | | (See 3GPP TS | | | contain the list | | 29.229 [4]) | | | of features | | | | | supported by the | | | | | origin host. | +-------------------+-------------------+------+-------------------+
#### 5.8.2 Detailed Behaviour of the SCEF
The SCEF shall make use of this procedure to send the updated Extended PCO
information (e.g. APN Rate Control information) to the UE during T6a/b
connection update, if needed. If APN Rate Control Control information is
included in the Extended-PCO AVP within the Connection Management SCEF Request
message from the SCEF, the SCEF shall enforce the APN Rate Control as
specified in 3GPP TS 23.401 [12] clause 4.7.7.3.
The SCEF shall make use of this procedure to request the release of the T6a/b
connection.
#### 5.8.3 Detailed Behaviour of the MME/SGSN
When the MME or SGSN receives a Connection Management SCEF Request from the
SCEF or the IWK-SCEF, the MME or SGSN shall, in the following order:
\- check that the User Identity exists in the MME or SGSN. If not,
Experimental-Result shall be set to DIAMETER_ERROR_USER_UNKNOWN in the
Connection Management SCEF Answer;
\- check that the T6a/b connection action indicates a T6a/b connection update
or T6a/b connection release. If not, the Experimental-Result shall be set to
DIAMETER_ERROR_OPERATION_NOT_ALLOWED in the Connection Management SCEF Answer;
\- check whether, for this user and the received EPS Bearer Identity, a T6a/b
connection context exists. If not, Experimental-Result shall be set to
DIAMETER_ERROR_ INVALID_EPS_BEARER in the Connection Management SCEF Answer;
\- if the T6a/b connection action indicates a T6a/b connection update:
\- if the Extended-PCO AVP is received, forward the Extended-PCO to the UE, as
specified in 3GPP TS 24.301[28]. If successful, the Result code shall be set
to DIAMETER_SUCCESS in the Connection Management SCEF Answer.
\- if the T6a/b connection action indicates T6a/b connection release, delete
the T6a/b connection context at the MME/SGSN. If successful, the Result code
shall be set to DIAMETER_SUCCESS in the Connection Management SCEF Answer.
#### 5.8.4 Detailed Behaviour of the IWK-SCEF
When the IWK-SCEF receives a Connection Management SCEF Request from the SCEF,
it shall forward the request to the MME or SGSN.
When the IWK-SCEF receives a Connection Management SCEF Answer from the MME or
SGSN, it shall forward the answer to the SCEF.
# 6 Protocol Specification and Implementation
## 6.1 Introduction
### 6.1.1 Use of Diameter Base Protocol
The Diameter base protocol as specified in IETF RFC 6733 [32] shall apply
except as modified by the defined support of the methods and the defined
support of the commands and AVPs, result and error codes as specified in this
specification. Unless otherwise specified, the procedures (including error
handling and unrecognised information handling) shall be used unmodified.
### 6.1.2 Securing Diameter Messages
For secure transport of Diameter messages, see 3GPP TS 33.210 [4].
### 6.1.3 Accounting Functionality
Accounting functionality (Accounting Session State Machine, related command
codes and AVPs) shall not be used on the T6a/T6b interface, T6ai/T6bi
interface and the T7 interface.
### 6.1.4 Use of Sessions
Diameter sessions shall be implicitly terminated between:
\- the MME/SGSN and the SCEF, for the T6a/T6b interface;
\- the MME/SGSN and the IWK-SCEF, for the T6ai/T6bi interface and
\- the IWK-SCEF and the SCEF for the T7 interface.
An implicitly terminated session is one for which the server does not maintain
state information. The client shall not send any re-authorization or session
termination requests to the server.
The Diameter base protocol includes the Auth-Session-State AVP as the
mechanism for the implementation of implicitly terminated sessions.
The client (server) shall include in its requests (responses) the Auth-
Session-State AVP set to the value NO_STATE_MAINTAINED (1), as described in
IETF RFC 6733 [32]. As a consequence, the server shall not maintain any state
information about this session and the client shall not send any session
termination request. Neither the Authorization-Lifetime AVP nor the Session-
Timeout AVP shall be present in requests or responses.
### 6.1.5 Transport Protocol
Diameter messages over the T6a/T6b, T6ai/T6bi and T7 interface shall make use
of SCTP IETF RFC 4960 [7] as transport protocol.
### 6.1.6 Routing Considerations
#### 6.1.6.1 Routing Considerations for Monitoring Event related Requests
This clause specifies the use of the Diameter routing AVPs Destination-Realm
and Destination-Host for Monitoring Event related requests.
The MME/SGSN shall use the SCEF-ID and the SCEF realm previously received over
S6a/b for a monitoring event configuration as the Destination-Host AVP and the
Destination-Realm AVP in the Reporting-Information-Request for the monitoring
event reports sent over the T6a/T6b or T6ai/bi interface.
The MME/SGSN shall use the pre-configured IWK-SCEF identify and the pre-
configured IWK-SCEF realm as the Destination-Host AVP and the Destination
Realm AVP in the Configuration-Information-Request for the monitoring event
configuration sent over the T6ai/bi interface.
The IWK-SCEF behaves as a Diameter Proxy agent according to IETF RFC 6733 [32]
for the Reporting-Information-Request received from the MME/SGSN over the
T6ai/bi interface and shall forward these requests to the SCEF over the T7
interface by keeping unchanged the Destination Realm and Destination Host
AVPs.
For monitoring events directly configured at the MME/SGSN by the SCEF, if the
SCEF knows the address/name of the MME/SGSN, both the Destination-Realm AVP
and the Destination-Host AVP shall be present in the request. Otherwise, only
the Destination-Realm AVP shall be present and the command shall be routed to
the next Diameter node. Consequently, the Destination-Host AVP is declared as
optional in the ABNF for all Monitoring Event related requests initiated by
the SCEF.
The Destination-Realm AVP is declared as mandatory in the ABNF for all
Monitoring Event related requests. The Destination-Host AVP is declared as
optional in the ABNF description of the Reporting-Information-Request and of
the Configuration Information-Request.
#### 6.1.6.2 Routing Considerations for Non-IP Data Related Requests
This clause specifies the use of the Diameter routing AVPs Destination-Realm
and Destination-Host for Non-IP Data related requests.
The MME or SGSN shall use the SCEF-ID and the SCEF realm that it received in
the subscribed APN associated to the T6a/b connection at its establishment as
the Destination-Host AVP and the Destination realm AVP in the Non-IP data
related request commands sent over the T6a/b and T6ai/bi interfaces.
The Destination-Host AVP is declared as optional and the Destination realm AVP
as mandatory in the ABNF description of the Non-IP data related requests
initiated by the MME or SGSN.
NOTE 1: For roaming cases, the routing of MME or SGSN initiated request
commands to the IWK-SCEF relies on the Destination Realm AVP as according to
the Diameter base protocol.
NOTE 2: The Diameter implicitly terminated sessions and their Session ID for
the Non-IP data related traffic are end to end between the MME/SGSN and the
SCEF.
The IWK-SCEF behaves as a Diameter Proxy agent according to IETF RFC 6733 [32]
for the Non-IP related requests received from the MME or SGSN over the T6ai/bi
interfaces and shall forward these requests to the SCEF over the T7 interface
by keeping unchanged the Destination Realm and Destination Host AVPs.
The SCEF obtains the Destination-Host AVP and the Destination-Realm AVP to use
in the Non-IP data related requests towards an MME or SGSN from the Origin-
Host AVP and the Origin-Realm AVP received in previous Non-IP Data related
requests from the MME or SGSN. The Origin-Realm AVP in the requests received
by the SCEF in roaming cases should contain the domain name of the network to
which the MME or SGSN belongs, encoded as specified in clause 19.2 of 3GPP TS
23.003 [24].
The Destination-Host AVP is declared as optional and the Destination realm AVP
as mandatory in the ABNF for the Non-IP Data related requests initiated by the
SCEF.
The IWK-SCEF behaves as a Diameter Proxy agent according to IETF RFC 3588 [3]
for the Non-IP related requests received from the SCEF over the T7 interface
and shall forward these requests to the MME or SGSN over the T6ai/bi
interfaces by keeping unchanged the Destination Realm and Destination Host
AVPs.
#### 6.1.6.3 Handling of the Vendor-Specific-Application-Id AVP
If the Vendor-Specific-Application-ID AVP is received in any of the commands
defined in this specification, it shall be ignored by the receiving node, and
it shall not be used for routing purposes.
#### 6.1.7 Advertising Application Support
The SCEF, MME, SGSN and the IWK-SCEF shall advertise support of the Diameter
T6a/T6b Application by including the value of the application identifier in
the Auth-Application-Id AVP within the Vendor-Specific-Application-Id grouped
AVP of the Capabilities-Exchange-Request and Capabilities-Exchange-Answer
commands.
NOTE: Even though the reference point between the MME/SGSN and the IWK-SCEF is
called T6ai/T6bi respectively and the reference point between the IWK-SCEF and
the SCEF is called T7, all these reference points use the same Diameter
Application ID.
The vendor identifier value of 3GPP (10415) shall be included in the
Supported-Vendor-Id AVP of the Capabilities-Exchange-Request and Capabilities-
Exchange-Answer commands, and in the Vendor-Id AVP within the Vendor-Specific-
Application-Id grouped AVP of the Capabilities-Exchange-Request and
Capabilities-Exchange-Answer commands.
The Vendor-Id AVP included in Capabilities-Exchange-Request and Capabilities-
Exchange-Answer commands that is not included in the Vendor-Specific-
Application-Id AVPs as described above shall indicate the manufacturer of the
Diameter node as per IETF RFC 6733 [32].
### 6.1.8 Diameter Application Identifier
The T6a/T6b interface protocol shall be defined as an IETF vendor specific
Diameter application, where the vendor is 3GPP. The vendor identifier assigned
by IANA to 3GPP (http://www.iana.org/assignments/enterprise-numbers) is 10415.
The Diameter application identifier assigned to the T6a/T6b interface
application is 16777346.
The T6ai/T6bi and the T7 interface protocol shall use the same Diameter
application identifier as the T6a/T6b interface.
### 6.1.9 Use of the Supported-Features AVP
When new functionality is introduced on the T6a/T6b application, it should be
defined as optional. If backwards incompatible changes cannot be avoided, the
new functionality shall be introduced as a new feature and support advertised
with the Supported-Features AVP. The usage of the Supported-Features AVP on
the T6a/T6b application is consistent with the procedures for the dynamic
discovery of supported features as defined in clause 7.2 of 3GPP TS 29.229
[4].
When extending the application by adding new AVPs for a feature, the new AVPs
shall have the M bit cleared and the AVP shall not be defined mandatory in the
command ABNF.
As defined in 3GPP TS 29.229 [4], the Supported-Features AVP is of type
grouped and contains the Vendor-Id, Feature-List-ID and Feature-List AVPs. On
the all reference points as specified in this specification, the Supported-
Features AVP is used to identify features that have been defined by 3GPP and
hence, for features defined in this document, the Vendor-Id AVP shall contain
the vendor ID of 3GPP (10415). If there are multiple feature lists defined for
the reference point, the Feature-List-ID AVP shall differentiate those lists
from one another.
## 6.2 Commands
### 6.2.1 Introduction
This clause defines the Command code values and related ABNF for each command
described in this specification. The ABNF for the commands on T6a/T6b,
T6ai/T6bi and T7 are the same if not specified explicitly different.
### 6.2.2 Command-Code values
This clause defines Command-Code values for the T6a/T6b interface application
as allocated by IANA.
Every command is defined by means of the ABNF syntax IETF RFC 5234 [8],
according to the Command Code Format (CCF) specification defined in IETF RFC
6733 [32]. When the definition and use of an AVP is not specified in this
document, the guidelines in IETF RFC 6733 [32] shall apply.
The Vendor-Specific-Application-Id AVP shall not be included in any command
sent by Diameter nodes supporting applications defined in this specification.
If the Vendor-Specific-Application-Id AVP is received in any of the commands
defined in this specification, it shall be ignored by the receiving node.
NOTE: The Vendor-Specific-Application-Id is included as an optional AVP in all
Command Code Format specifications defined in this specification in order to
overcome potential interoperability issues with intermediate Diameter agents
non-compliant with IETF RFC 6733 [32].
The following Command Codes are defined in this specification for T6a/T6b:
Table 6.2.2-1: Command-Code values for T6a/T6b
* * *
Command-Name Abbreviation Code Clause Configuration-Information-Request CIR
8388718 3GPP TS 29.336 [5] clause 8.2.3 and clause 6.2.3 below Configuration-
Information-Answer CIA 8388718 3GPP TS 29.336 [5] clause 8.2.4 and clause
6.2.4 below Reporting-Information-Request RIR 8388719 3GPP TS 29.336 [5]
clause 8.2.5 and clause 6.2.5 below Reporting-Information-Answer RIA 8388719
3GPP TS 29.336 [5] clause 8.2.6 and clause 6.2.6 below Connection-Management-
Request CMR 8388732 6.2.7 Connection-Management-Answer CMA 8388732 6.2.8 MO-
Data-Request ODR 8388733 6.2.9 MO-Data-Answer ODA 8388733 6.2.10 MT-Data-
Request TDR 8388734 6.2.11 MT-Data-Answer TDA 8388734 6.2.12
* * *
For these commands, the Application-ID field shall be set to 16777346
(application identifier of the T6a/T6b interface application, allocated by
IANA).
### 6.2.3 Configuration Information Request (CIR) Command
The Configuration Information Request (CIR) command, indicated by the Command-
Code field set to 8388718 and the \"R\" bit set in the Command Flags field, is
sent from:
\- the SCEF to the MME/SGSN;
\- the SCEF to the IWK-SCEF and
\- the MME/SGSN to the IWK-SCEF
This command is originally defined in 3GPP TS 29.336 [5].
For the T6a/T6b interface, the Configuration-Information-Request command
format is specified as following:
Message Format:
> \ ::= \ PXY, 16777346 >
>
> \
>
> [ DRMP ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ Destination-Host ]
>
> { Destination-Realm }
>
> ***[ Supported-Features ]**
>
> *[ Monitoring-Event-Configuration ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.4 Configuration-Information-Answer (CIA) Command
The Configuration-Information-Answer (CIA) command, indicated by the Command-
Code field set to 8388718 and the \"R\" bit cleared in the Command Flags
field, is sent from:
\- the MME/SGSN to the SCEF;
\- the IWK-SCEF to the SCEF and
\- the IWK-SCEF to the MME/SGSN
This command is originally defined in 3GPP TS 29.336 [5].
For the T6a/T6b interface, the Configuration-Information-Answer command format
is specified as following:
Message Format:
> \ ::= \ 16777346 >
>
> \
>
> [ DRMP ]
>
> [ Result-Code ]
>
> [ Experimental-Result ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> ***[ Supported-Features ]**
>
> *[ Monitoring-Event-Report ]
>
> *[ Monitoring-Event-Config-Status ]
>
> [ Failed-AVP ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.5 Reporting-Information-Request (RIR) Command
The Reporting-Information-Request (RIR) command, indicated by the Command-Code
field set to 8388719 and the \"R\" bit set in the Command Flags field, is sent
from:
\- the MME/SGSN to the SCEF;
\- the MME/SGSN to the IWK-SCEF and
\- the IWK-SCEF to the SCEF.
This command is originally defined in 3GPP TS 29.336 [5].
For the T6a/T6b interface, the Reporting-Information-Request command format is
specified as following:
Message Format:
> \ ::= \ PXY, 16777346 >
>
> \
>
> [ DRMP ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ Destination-Host ]
>
> { Destination-Realm }
>
> [ OC-Supported-Features ]
>
> ***[ Supported-Features ]**
>
> **[ User-Identifier ]**
>
> *[ Monitoring-Event-Report ]
>
> **[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.6 Reporting-Information-Answer (RIA) Command
The Reporting-Information-Answer (RIA) command, indicated by the Command-Code
field set to 8388719 and the \"R\" bit cleared in the Command Flags field, is
sent from:
\- the SCEF to the MME/SGSN;
\- the SCEF to the IWK-SCEF and
\- the IWK-SCEF to the MME/SGSN.
This command is originally defined in 3GPP TS 29.336 [5].
For the T6a/T6b interface, the Reporting-Information-Answer command format is
specified as following:
Message Format:
> \ ::= \ 16777346 >
>
> \
>
> [ DRMP ]
>
> [ Result-Code ]
>
> [ Experimental-Result ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ OC-Supported-Features ]
>
> [ OC-OLR ]
>
> *[ Load ]
>
> ***[ Supported-Features ]**
>
> ***[ Monitoring-Event-Report-Status ]**
>
> [ Failed-AVP ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.7 Connection-Management-Request (CMR) Command
The Connection-Management-Request (CMR) command, indicated by the Command-Code
field set to 8388732 and the \"R\" bit set in the Command Flags field, is sent
from:
\- the MME or SGSN to the SCEF;
\- the MME or SGSN to the SCEF via the IWK-SCEF for roaming cases;
\- the SCEF to the MME or SGSN;
\- the SCEF to the MME or SGSN via the IWK-SCEF for roaming cases.
For the T6a/b, T6ai/bi, T7 interfaces, the Connection-Management-Request
command format is specified as following:
Message Format:
> \ ::= \ PXY, 16777346 >
>
> \
>
> \
>
> \
>
> [ DRMP ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ Destination-Host ]
>
> { Destination-Realm }
>
> [ OC-Supported-Features ]
>
> [ CMR-Flags ]
>
> [ Maximum-UE-Availability-Time ]
>
> *[ Supported-Features ]
>
> [ Connection-Action ]
>
> [ Service-Selection ]
>
> [ Serving-PLMN-Rate-Control ]
>
> [ Extended-PCO ]
>
> [ 3GPP-Charging-Characteristics ]
>
> [ RAT-Type ]
>
> [ Terminal-Information ]
>
> [ Visited-PLMN-Id ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.8 Connection-Management-Answer (CMA) Command
The Connection-Management-Answer (CMA) command, indicated by the Command-Code
field set to 8388732 and the \"R\" bit cleared in the Command Flags field, is
sent from:
\- the SCEF to the MME or SGSN;
\- the SCEF to the MME or SGSN via the IWK-SCEF for roaming cases;
\- the MME or SGSN to the SCEF;
\- the MME or SGSN to the SCEF via the IWK-SCEF for roaming cases.
For the T6a/b, T6ai/bi and T7 interfaces, the Connection-Management-Answer
command format is specified as following:
Message Format:
> \ ::= \ 16777346 >
>
> \
>
> [ DRMP ]
>
> [ Result-Code ]
>
> [ Experimental-Result ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ OC-Supported-Features ]
>
> [ OC-OLR ]
>
> *[ Load ]
>
> ***[ Supported-Features ]**
>
> [ PDN-Connection-Charging-Id ]
>
> **[ Extended-PCO ]**
>
> [ Failed-AVP ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.9 MO-Data-Request (ODR) Command
The MO-Data-Request (ODR) command, indicated by the Command-Code field set to
8388733 and the \"R\" bit set in the Command Flags field, is sent from:
\- the MME or SGSN to the SCEF;
\- the MME or SGSN to the IWK-SCEF and
\- the IWK-SCEF to the SCEF.
For the T6a/b, T6ai/bi, T7 interfaces, the MO-Data-Request command format is
specified as following:
Message Format:
> \ ::= \
>
> \
>
> \
>
> \
>
> [ DRMP ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ Destination-Host ]
>
> { Destination-Realm }
>
> [ OC-Supported-Features ]
>
> *[ Supported-Features ]
>
> [ Non-IP-Data ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> [ RRC-Cause-Counter ]
>
> *[AVP]
### 6.2.10 MO-Data-Answer (ODA) Command
The MO-Data-Answer (ODA) command, indicated by the Command-Code field set to
8388733 and the \"R\" bit cleared in the Command Flags field, is sent from:
\- the SCEF to the MME or SGSN;
\- the SCEF to the IWK-SCEF and
\- the IWK-SCEF to the MME or SGSN.
For the T6a/b, T6ai/bi and T7 interfaces, the MO-Data-Answer command format is
specified as following:
Message Format:
> \ ::= \
>
> \
>
> [ DRMP ]
>
> [ Result-Code ]
>
> [ Experimental-Result ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ OC-Supported-Features ]
>
> [ OC-OLR ]
>
> *[ Load ]
>
> ***[ Supported-Features ]**
>
> [ Failed-AVP ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.11 MT-Data-Request (TDR) Command
The MT-Data-Request (TDR) command, indicated by the Command-Code field set to
8388734 and the \"R\" bit set in the Command Flags field, is sent from:
\- the SCEF to the MME or SGSN;
\- the SCEF to the IWK-SCEF and
\- the IWK-SCEF to the MME or SGSN.
For the T6a/b, T6ai/bi, T7 interfaces, the MT-Data-Request command format is
specified as following:
Message Format:
> \ ::= \
>
> \
>
> \
>
> \
>
> [ DRMP ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ Destination-Host ]
>
> { Destination-Realm }
>
> [ OC-Supported-Features ]
>
> *[ Supported-Features ]
>
> [ Non-IP-Data ]
>
> [ SCEF-Wait-Time ]
>
> [ Maximum-Retransmission-Time ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> *[AVP]
### 6.2.12 MT-Data-Answer (TDA) Command
The MT-Data-Answer (OSA) command, indicated by the Command-Code field set to
8388734 and the \"R\" bit cleared in the Command Flags field, is sent from:
\- the MME or SGSN to the SCEF;
\- the MME or SGSN to the IWK-SCEF and
\- the IWK-SCEF to the SCEF.
For the T6a/b, T6ai/bi and T7 interfaces, the MT-Data-Answer command format is
specified as following:
Message Format:
> \ ::= \
>
> \
>
> [ DRMP ]
>
> [ Result-Code ]
>
> [ Experimental-Result ]
>
> { Auth-Session-State }
>
> { Origin-Host }
>
> { Origin-Realm }
>
> [ OC-Supported-Features ]
>
> [ OC-OLR ]
>
> *[ Load ]
>
> [ Requested-Retransmission-Time ]
>
> ***[ Supported-Features ]**
>
> [ Failed-AVP ]
>
> *[ Proxy-Info ]
>
> *[ Route-Record ]
>
> [ TDA-Flags ]
>
> *[AVP]
## 6.3 Result-Code AVP and Experimental-Result AVP Values
### 6.3.1 General
This clause defines result code values that shall be supported by all Diameter
implementations that conform to this specification.
### 6.3.2 Success
Result codes that fall within the Success category shall be used to inform a
peer that a request has been successfully completed. The Result-Code AVP
values defined in the Diameter base protocol specified in IETF RFC 6733 [32]
shall be applied.
### 6.3.3 Permanent Failures
Errors that fall within the Permanent Failures category shall be used to
inform the peer that the request has failed, and should not be attempted
again. The Result-Code AVP values defined in the Diameter base protocol
specified IETF RFC 6733 [32] shall be applied. When one of the result codes
defined here is included in a response, it shall be inside an Experimental-
Result AVP and the Result-Code AVP shall be absent.
#### 6.3.3.1 DIAMETER_ERROR_UNAUTHORIZED_REQUESTING_ENTITY (5510)
This result code shall be sent by the MME/SGSN or the IWK-SCEF to indicate
that the SCEF is not allowed to request Monitoring services. This error code
is defined in 3GPP TS 29.336 [5].
#### 6.3.3.2 DIAMETER_ERROR_UNAUTHORIZED_SERVICE (5511)
This result code shall be sent by the MME/SGSN or the IWK-SCEF to indicate
that the specific service requested by the SCEF is not allowed as per local
policies. This error code is defined in 3GPP TS 29.336 [5].
#### 6.3.3.3 DIAMETER_ERROR_CONFIGURATION_EVENT_STORAGE_NOT_ SUCCESSFUL (5513)
This result code shall be sent by the MME/SGSN to indicate that the specific
service requested by the SCEF could not be stored. This error code is defined
in 3GPP TS 29.336 [5].
#### 6.3.3.4 DIAMETER_ERROR_CONFIGURATION_EVENT_NON_EXISTANT (5514)
This result code shall be sent by the IWK-SCEF to indicate that the requested
deletion by the MME/SGSN could not be performed because the event does not
exist. This error code is defined in 3GPP TS 29.336 [5].
#### 6.3.3.5 DIAMETER_ERROR_REQUESTED_LOCATION_NOT_SERVED (5650)
This result code shall be sent by the MME/SGSN to indicate that the location
for which a related monitoring event is configured (e.g. Number of UEs at a
given geographical location) by the SCEF, is not served by the MME/SGSN.
#### 6.3.3.6 DIAMETER_ERROR_USER_UNKNOWN (5001)
This result code shall be sent by the SCEF or the MME/SGSN to indicate that
the user identified by the IMSI is unknown. This error code is defined in 3GPP
TS 29.229 [4].
#### 6.3.3.7 DIAMETER_ERROR_OPERATION_NOT_ALLOWED (5101)
This result code shall be sent by the SCEF to indicate that the operation is
not allowed when an EPS bearer context exists for the user. This error code is
defined in 3GPP TS 29.329 [17].
This result code shall be sent by the SCEF or the MME/SGSN to indicate that
the requested T6a/b connection action is not allowed.
#### 6.3.3.8 DIAMETER_ERROR_INVALID_EPS_BEARER (5651)
This result code shall be sent by the SCEF or the MME/SGSN to indicate that
there is no bearer context for the user.
#### 6.3.3.9 DIAMETER_ERROR_NIDD_CONFIGURATION_NOT_AVAILABLE (5652)
This result code shall be sent by the SCEF to indicate that there is no valid
NIDD configuration available.
#### 6.3.3.10 DIAMETER_ERROR_ SCEF_REFERENCE_ID_UNKNOWN (5515)
This result code shall be sent by the SCEF to indicate that the SCEF reference
ID is not known by the SCEF.
#### 6.3.3.11 DIAMETER_ERROR_USER_TEMPORARILY_UNREACHABLE (5653)
This result code shall be sent by the MME or SGSN to indicate that the UE is
temporarily not reachable due to a power saving function, and that the MME or
SGSN will update the SCEF when it detects that the UE is reachable or about to
become reachable as specified in clause 5.6.3.
#### 6.3.3.12 DIAMETER_ERROR_UNREACHABLE_USER (4221)
This result code shall be sent by the MME to indicate that the UE is not
reachable. This error code is defined in 3GPP TS 29.172 [26].
## 6.4 AVPs
### 6.4.1 General
The following table specifies the Diameter AVPs defined for the T6a/T6b
interface protocol, their AVP Code values, types, possible flag values and
whether or not the AVP may be encrypted. The Vendor-ID header of all AVPs
defined in this specification shall be set to 3GPP (10415).
For all AVPs which contain bit masks and are of the type Unsigned32, bit 0
shall be the least significant bit. For example, to get the value of bit 0, a
bit mask of 0x00000001 should be used.
Table 6.4.1-1: T6a/T6b specific Diameter AVPs
+-------+-------+-------+-------+------+-----+-------+-------+-------+ | | AVP | | | | | | | | | | Flag | | | | | | | | | | rules | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Attr | AVP | C | Value | Must | May | S | Must | May | | ibute | Code | lause | Type | | | hould | not | Encr. | | Name | | de | | | | not | | | | | | fined | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Com | 4300 | 6.4.4 | Gr | M,V | | | | No | | munic | | | ouped | | | | | | | ation | | | | | | | | | | -Fail | | | | | | | | | | ure-I | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Cause | 4301 | 6.4.5 | Unsig | M,V | | | | No | | -Type | | | ned32 | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | S1AP- | 4302 | 6.4.6 | Unsig | M,V | | | | No | | Cause | | | ned32 | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | R | 4303 | 6.4.7 | Unsig | M,V | | | | No | | ANAP- | | | ned32 | | | | | | | Cause | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | B | 4309 | 6.4.8 | Unsig | M,V | | | | No | | SSGP- | | | ned32 | | | | | | | Cause | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | GMM- | 4304 | 6.4.9 | Unsig | M,V | | | | No | | Cause | | | ned32 | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | SM- | 4305 | 6 | Unsig | M,V | | | | No | | Cause | | .4.10 | ned32 | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Numb | 4306 | 6 | Gr | M,V | | | | No | | er-Of | | .4.11 | ouped | | | | | | | -UE-P | | | | | | | | | | er-Lo | | | | | | | | | | catio | | | | | | | | | | n-Con | | | | | | | | | | figur | | | | | | | | | | ation | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Nu | 4307 | 6 | Gr | M,V | | | | No | | mber- | | .4.12 | ouped | | | | | | | Of-UE | | | | | | | | | | -Per- | | | | | | | | | | Locat | | | | | | | | | | ion-R | | | | | | | | | | eport | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | UE- | 4308 | 6 | Unsig | M,V | | | | No | | Count | | .4.13 | ned32 | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Co | 4314 | 6 | Unsig | M,V | | | | No | | nnect | | .4.18 | ned32 | | | | | | | ion-A | | | | | | | | | | ction | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | N | 4315 | 6 | O | M,V | | | | No | | on-IP | | .4.19 | ctets | | | | | | | -Data | | | tring | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Servi | 4310 | 6 | Gr | M,V | | | | No | | ng-PL | | .4.21 | ouped | | | | | | | MN-Ra | | | | | | | | | | te-Co | | | | | | | | | | ntrol | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Up | 4311 | 6 | Unsig | M,V | | | | No | | link- | | .4.23 | ned32 | | | | | | | Rate- | | | | | | | | | | Limit | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Down | 4312 | 6 | Unsig | M,V | | | | No | | link- | | .4.22 | ned32 | | | | | | | Rate- | | | | | | | | | | Limit | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Ex | 4313 | 6 | O | M,V | | | | No | | tende | | .4.26 | ctetS | | | | | | | d-PCO | | | tring | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | SCEF | 4316 | 6 | Time | M,V | | | | No | | -Wait | | .4.24 | | | | | | | | -Time | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | CMR- | 4317 | 6 | Unsig | M,V | | | | No | | Flags | | .4.25 | ned32 | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | RR | 4318 | 6 | Gr | M,V | | | | No | | C-Cau | | .4.27 | ouped | | | | | | | se-Co | | | | | | | | | | unter | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Cou | 4319 | 6 | Unsig | M,V | | | | No | | nter- | | .4.28 | ned32 | | | | | | | Value | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | R | 4320 | 6 | Time | M,V | | | | No | | RC-Co | | .4.29 | | | | | | | | unter | | | | | | | | | | -Time | | | | | | | | | | stamp | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | TDA- | 4321 | 6 | Unsig | V | | | M | No | | Flags | | .4.31 | ned32 | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | Id | 4322 | 6 | Gr | V | | | M | No | | le-St | | .4.32 | ouped | | | | | | | atus- | | | | | | | | | | Indic | | | | | | | | | | ation | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | I | 4323 | 6 | Time | V | | | M | No | | dle-S | | .4.33 | | | | | | | | tatus | | | | | | | | | | -Time | | | | | | | | | | stamp | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | A | 4324 | 6 | Unsig | V | | | M | No | | ctive | | .4.34 | ned32 | | | | | | | -Time | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+ | NOTE | | | | | | | | | | 1: | | | | | | | | | | The | | | | | | | | | | AVP | | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | bit | | | | | | | | | | de | | | | | | | | | | noted | | | | | | | | | | as | | | | | | | | | | \"M\" | | | | | | | | | | indi | | | | | | | | | | cates | | | | | | | | | | wh | | | | | | | | | | ether | | | | | | | | | | su | | | | | | | | | | pport | | | | | | | | | | of | | | | | | | | | | the | | | | | | | | | | AVP | | | | | | | | | | is | | | | | | | | | | requ | | | | | | | | | | ired. | | | | | | | | | | The | | | | | | | | | | AVP | | | | | | | | | | h | | | | | | | | | | eader | | | | | | | | | | bit | | | | | | | | | | de | | | | | | | | | | noted | | | | | | | | | | as | | | | | | | | | | \"V\" | | | | | | | | | | indi | | | | | | | | | | cates | | | | | | | | | | wh | | | | | | | | | | ether | | | | | | | | | | the | | | | | | | | | | opt | | | | | | | | | | ional | | | | | | | | | | Vend | | | | | | | | | | or-ID | | | | | | | | | | field | | | | | | | | | | is | | | | | | | | | | pr | | | | | | | | | | esent | | | | | | | | | | in | | | | | | | | | | the | | | | | | | | | | AVP | | | | | | | | | | he | | | | | | | | | | ader. | | | | | | | | | | For | | | | | | | | | | fu | | | | | | | | | | rther | | | | | | | | | | det | | | | | | | | | | ails, | | | | | | | | | | see | | | | | | | | | | I | | | | | | | | | | ETF R | | | | | | | | | | FC 67 | | | | | | | | | | 33 [ | | | | | | | | | | 32]. | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 2: If | | | | | | | | | | the | | | | | | | | | | M-bit | | | | | | | | | | is | | | | | | | | | | set | | | | | | | | | | for | | | | | | | | | | an | | | | | | | | | | AVP | | | | | | | | | | and | | | | | | | | | | the | | | | | | | | | | rec | | | | | | | | | | eiver | | | | | | | | | | does | | | | | | | | | | not | | | | | | | | | | under | | | | | | | | | | stand | | | | | | | | | | the | | | | | | | | | | AVP, | | | | | | | | | | it | | | | | | | | | | shall | | | | | | | | | | r | | | | | | | | | | eturn | | | | | | | | | | a | | | | | | | | | | rejec | | | | | | | | | | tion. | | | | | | | | | | If | | | | | | | | | | the | | | | | | | | | | M-bit | | | | | | | | | | is | | | | | | | | | | not | | | | | | | | | | set | | | | | | | | | | for | | | | | | | | | | an | | | | | | | | | | AVP, | | | | | | | | | | the | | | | | | | | | | rec | | | | | | | | | | eiver | | | | | | | | | | shall | | | | | | | | | | not | | | | | | | | | | r | | | | | | | | | | eturn | | | | | | | | | | a | | | | | | | | | | rejec | | | | | | | | | | tion, | | | | | | | | | | wh | | | | | | | | | | ether | | | | | | | | | | or | | | | | | | | | | not | | | | | | | | | | it | | | | | | | | | | u | | | | | | | | | | nders | | | | | | | | | | tands | | | | | | | | | | the | | | | | | | | | | AVP. | | | | | | | | | | If | | | | | | | | | | the | | | | | | | | | | rec | | | | | | | | | | eiver | | | | | | | | | | u | | | | | | | | | | nders | | | | | | | | | | tands | | | | | | | | | | the | | | | | | | | | | AVP | | | | | | | | | | but | | | | | | | | | | the | | | | | | | | | | M-bit | | | | | | | | | | value | | | | | | | | | | does | | | | | | | | | | not | | | | | | | | | | match | | | | | | | | | | with | | | | | | | | | | the | | | | | | | | | | defin | | | | | | | | | | ition | | | | | | | | | | in | | | | | | | | | | this | | | | | | | | | | t | | | | | | | | | | able, | | | | | | | | | | the | | | | | | | | | | rec | | | | | | | | | | eiver | | | | | | | | | | shall | | | | | | | | | | i | | | | | | | | | | gnore | | | | | | | | | | the | | | | | | | | | | M | | | | | | | | | | -bit. | | | | | | | | | +-------+-------+-------+-------+------+-----+-------+-------+-------+
The following table specifies the Diameter AVPs re-used by the T6a/T6b
interface protocol from existing Diameter Applications, including a reference
to their respective specifications and when needed, a short description of
their use within T6a/T6b.
Any other AVPs from existing Diameter Applications, except for the AVPs from
Diameter Base Protocol, do not need to be supported. The AVPs from Diameter
Base Protocol are not included in table 6.4.1-2, but they may be re-used for
the T6a/T6b protocol.
Table 6.4.1-2: T6a/T6b re-used Diameter AVPs
* * *
Attribute Name Reference Comments Monitoring-Event-Configuration 3GPP TS
29.336 [5] This AVP shall contain the monitoring event to be configured at the
MME/SGSN or the IWK-SCEF. See 6.4.2. Monitoring-Event-Report 3GPP TS 29.336
[5] This AVP shall contain the monitoring event reported by the MME/SGSN or
the IWK-SCEF. See 6.4.3. SCEF-Reference-ID 3GPP TS 29.336 [5]  
SCEF-ID 3GPP TS 29.336 [5]  
SCEF-Reference-ID-for-Deletion 3GPP TS 29.336 [5]  
Supported-Features 3GPP TS 29.229 [4]  
Feature-List-ID 3GPP TS 29.229 [4]  
Feature-List 3GPP TS 29.229 [4] See 6.4.14 OC-Supported-Features IETF RFC 7683
[9]  
OC-OLR IETF RFC 7683 [9]  
Monitoring-Event-Config-Status 3GPP TS 29.336 [5] This AVP shall contain the
status of configuration of each monitoring event identified by an SCEF-ID and
SCEF-Reference-ID. DRMP IETF RFC 7944 [15] see 6.4.15 User-Identifier 3GPP TS
29.336 [5] See 6.4.16 Bearer-Identity 3GPP TS 29.212 [10] See 6.4.17
Monitoring-Type 3GPP TS 29.336 [5]  
Loss-Of-Connectivity-Reason 3GPP TS 29.336 [5]  
Maximum-Number-of-Reports 3GPP TS 29.336 [5]  
Monitoring-Duration 3GPP TS 29.336 [5]  
Charged-Party 3GPP TS 32.299 [20]  
UE-Reachability-Configuration 3GPP TS 29.336 [5]  
Location-Information-Configuration 3GPP TS 29.336 [5]  
Reachability-Information 3GPP TS 29.336 [5]  
EPS-Location-Information 3GPP TS 29.272 [16]  
Service-Selection IETF RFC 5778 [21] See 6.4.20 PDN-Connection-Charging-Id
3GPP TS 32.299 [22]  
Maximum-Retransmission-Time 3GPP TS 29.338 [27]  
Requested-Retransmission-Time 3GPP TS 29.338 [27]  
Maximum-UE-Availability-Time 3GPP TS 29.338 [27]  
3GPP-Charging-Characteristics 3GPP TS 29.061 [29]  
RAT-Type 3GPP TS 29.212 [10]  
Terminal-Information 3GPP TS 29.272 [16] See 6.4.30 Visited-PLMN-Id 3GPP TS
29.272 [16]  
Load IETF RFC 8583 [31]  
Subscribed-Periodic-RAU-TAU-Timer 3GPP TS 29.272 [16]  
Monitoring-Event-Report-Status 3GPP TS 29.336 [5]  
IMSI-Group-Id 3GPP TS 29.272 [16]  
Reporting-Time-Stamp 3GPP TS 29.336 [5]  
eDRX-Cycle-Length 3GPP TS 29.272 [16]  
DL-Buffering-Suggested-Packet-Count 3GPP TS 29.272 [16]
* * *
### 6.4.2 Monitoring-Event-Configuration
The Monitoring-Event-Configuration AVP is of type Grouped. It shall contain
the Monitoring event configuration related data. It is originally defined in
3GPP TS 29.336 [5].
For the T6a/T6b interface, the Monitoring-Event-Configuration AVP format is
specified as following:
AVP format:
> Monitoring-Event-Configuration ::= \
>
> [ SCEF-Reference-ID ]
>
> { SCEF-ID }
>
> { Monitoring-Type }
>
> *[ SCEF-Reference-ID-for-Deletion ]
>
> [ Maximum-Number-of-Reports ]
>
> [ Monitoring-Duration ]
>
> [ Charged-Party ]
>
> [ UE-Reachability-Configuration ]
>
> [ Location-Information-Configuration ]
>
> *[ Number-Of-UE-Per-Location-Configuration ]
>
> *[AVP]
### 6.4.3 Monitoring-Event-Report
The Monitoring-Event-Report AVP is of type Grouped. It shall contain the
Monitoring event report data. It is originally defined in 3GPP TS 29.336 [5].
For the T6a/T6b interface, the Monitoring-Event-Report AVP format is specified
as following:
AVP format:
> Monitoring-Event-Report ::= \
>
> { SCEF-Reference-ID }
>
> [ SCEF-ID ]
>
> [ Monitoring-Type ]
>
> [ Reachability-Information ]
>
> [ EPS-Location-Information ]
>
> [ Communication-Failure-Information ]
>
> *[ Number-Of-UE-Per-Location-Report ]
>
> [ Loss-Of-Connectivity-Reason ]
>
> [ Visited-PLMN-Id ]
>
> [ Idle-Status-Indication ]
>
> [ Reporting-Time-Stamp ]
>
> [ Maximum-UE-Availability-Time ]
>
> *[AVP]
The AVPs applicable for each Monitoring-Type reported by the MME/SGSN are
specified under clause 5.2.2.
### 6.4.4 Communication-Failure-Information
The Communication-Failure-Information AVP is of type Grouped. It shall contain
the reason for communication failure.
AVP format:
> Communication-Failure-Information ::= \
>
> [ Cause-Type ]
>
> [ S1AP-Cause ]
>
> [ RANAP-Cause ]
>
> [ BSSGP-Cause ]
>
> [ GMM-Cause ]
>
> [ SM-Cause ]
>
> *[AVP]
### 6.4.5 Cause-Type
The Cause-Type AVP is of type Unsigned32 and it shall identify the type of the
S1AP-Cause. The following values are defined:
RADIO_NETWORK_LAYER (0)
TRANSPORT_LAYER (1)
NAS (2)
PROTOCOL (3)
MISCELLANEOUS (4)
### 6.4.6 S1AP-Cause
The S1AP-Cause AVP is of type Unsigned32. It shall contain a non-transparent
copy of the S1AP cause code as specified clause 9.2.1.3 of 3GPP TS 36.413
[13]. The RAN cause sub-category of the S1AP-Cause as specified in 3GPP TS
36.413 [13] shall be encoded in the Cause-Type AVP as specified in clause
6.4.5 above.
### 6.4.7 RANAP-Cause
The RANAP-Cause AVP is of type Unsigned32. It shall contain the non-
transparent copy of the cause value of the RANAP cause code as specified in
clause 9.2.1.4 of 3GPP TS 25.413 [11].
### 6.4.8 BSSGP-Cause
The BSSGP-Cause AVP is of type Unsigned32. It shall contain the non-
transparent copy of the cause value of the BSSGP \"Cause\" as specified in
clause 11.3.8 in 3GPP TS 48.018 [14].
### 6.4.9 GMM-Cause
The GMM-Cause AVP is of type Unsigned32. It shall contain the GMM cause code
as specified in clause 10.5.5.14 of 3GPP TS 24.008 [12].
### 6.4.10 SM-Cause
The SM-Cause AVP is of type Unsigned32. It shall contain the SM cause code as
specified in clause 10.5.6.6 and 10.5.6.6A of 3GPP TS 24.008 [12].
### 6.4.11 Number-Of-UE-Per-Location-Configuration
The Number-Of-UE-Per-Location-Configuration AVP is of type Grouped. It shall
contain the location information for which the number of UEs needs to be
reported by the MME/SGSN.
AVP format:
> Number-of-UE-Per-Location-Configuration ::= \
>
> { EPS-Location-Information }
>
> [ IMSI-Group-Id ]
>
> *[AVP]
### 6.4.12 Number-Of-UE-Per-Location-Report
The Number-Of-UE-Per-Location-Report AVP is of type Grouped. It shall contain
the location information along with the number of UEs found at that location
by the MME/SGSN.
AVP format:
> Number-of-UE-Per-Location-Report ::= \
>
> { EPS-Location-Information }
>
> { UE-Count }
>
> [ IMSI-Group-Id ]
>
> *[AVP]
### 6.4.13 UE-Count
The UE-Count AVP is of type Unsigned32. It shall contain the number of UEs
counted against a given criteria (say location information).
### 6.4.14 Feature-List AVP
#### 6.4.14.1 Feature-List AVP for the T6a/T6b application
The syntax of this AVP is defined in 3GPP TS 29.229 [4].
For the T6a/b application, the meaning of the bits shall be as defined in
table 6.4.14.1-1 for the Feature-List-ID.
Table 6.4.14.1-1: Features of Feature-List-ID used in T6a/b
+------------------------+-----------+-----+------------------------+ | Feature bit | Feature | M/O | Description | +------------------------+-----------+-----+------------------------+ | 0 | MONTE | O | Configuration and | | | | | reporting of | | | | | monitoring events | | | | | | | | | | This feature is | | | | | applicable to from an | | | | | SCEF with CIR/CIA | | | | | command pair and the | | | | | reporting of events to | | | | | the SCEF with RIR/RIA | | | | | command pair. | | | | | | | | | | If the MME/SGSN does | | | | | not support this | | | | | feature, the SCEF | | | | | shall not send | | | | | monitoring event | | | | | configurations to the | | | | | HSS within CIR. | +------------------------+-----------+-----+------------------------+ | 1 | NIDD | O | Support of Non-IP Data | | | | | service over T6a/b | | | | | | | | | | This feature is | | | | | applicable to OSR/OSA, | | | | | ODR/ODA and TDR/TDA | | | | | command pairs. | | | | | | | | | | If the SCEF does not | | | | | indicate support of | | | | | this feature in an | | | | | OSA, the MME or SGSN | | | | | may store this | | | | | information and not | | | | | send any further OSR | | | | | commands to that SCEF. | +------------------------+-----------+-----+------------------------+ | 2 | Filtering | O | Filtering Number of | | | | | UEs present at given | | | | | location by IMSI-Group | | | | | | | | | | This feature is | | | | | applicable to the | | | | | CIR/CIA command pair. | | | | | | | | | | If the MME/SGSN does | | | | | not support this | | | | | feature, the SCEF | | | | | shall interpret the | | | | | reported number of UEs | | | | | per location as not | | | | | being filtered by the | | | | | provided | | | | | IMSI-Group-Id. | +------------------------+-----------+-----+------------------------+ | Feature bit: The order | | | | | number of the bit | | | | | within the | | | | | Supported-Features | | | | | AVP, e.g. \"1\". | | | | | | | | | | Feature: A short name | | | | | that can be used to | | | | | refer to the bit and | | | | | to the feature, e.g. | | | | | \"MONTE\". | | | | | | | | | | M/O: Defines if the | | | | | implementation of the | | | | | feature is mandatory | | | | | (\"M\") or optional | | | | | (\"O\"). | | | | | | | | | | Description: A clear | | | | | textual description of | | | | | the feature. | | | | +------------------------+-----------+-----+------------------------+
### 6.4.15 DRMP
The DRMP AVP is of type Enumerated and it is defined in IETF RFC 7944 [15].
This AVP allows the MME, the SGSN, the SCEF and the IWK-SCEF to indicate the
relative priority of Diameter messages. The DRMP AVP may be used to set the
DSCP marking for transport of the associated Diameter message.
### 6.4.16 User-Identifier
The User-Identifier AVP is of type Grouped and it contains the different
identifiers used by the UE.
It is defined in 3GPP TS 29.336 [5]
### 6.4.17 Bearer-Identifier
The Bearer-Identifier AVP contains either the identity of the EPS bearer used
to identify the T6a connection between the MME and the SCEF or the NSAPI of
the PDP context identifying the T6b connection between the SGSN and the SCEF.
It is defined in 3GPP TS 29.212 [10].
### 6.4.18 Connection-Action
The Connection-Action AVP is of type Unsigned32 and it shall identify the
action to be performed on the T6a/b connection. The following values are
defined:
CONNECTION_ESTABLISHMENT (0)
This value shall be used if the T6a/b Connection-Management-Request applies to
a T6a/b connection establishment.
CONNECTION_RELEASE (1)
This value shall be used if the T6a/b Connection-Management-Request applies to
a T6a/b connection release.
CONNECTION_UPDATE (2)
This value shall be used if the T6a/b Connection-Management-Request applies to
updating the properties of a T6a/b connection.
### 6.4.19 Non-IP-Data
The Non-IP-Data AVP is of type OctetString and it contains the Non-IP data
conveyed between the MME or SGSN and the SCEF.
### 6.4.20 Service-Selection
The Service-Selection AVP is of type of UTF8String. This AVP shall contain the
APN Network Identifier as specified in 3GPP TS 23.003 [24] clause 9.1.
The contents of the Service-Selection AVP shall be formatted as a character
string composed of one or more labels separated by dots (\".\").
This AVP is originally defined in IETF RFC 5778[21].
### 6.4.21 Serving-PLMN-Rate-Control
The Serving-PLMN-Rate-Control AVP is of type Grouped and shall contain.
The AVP format shall conform to:
Serving-PLMN-Rate-Control::= \
> [ Uplink-Rate-Limit ]
>
> [ Downlink-Rate-Limit ]
>
> *[AVP]
A Downlink-Rate-Limit set to 0 shall be interpreted that the Serving PLMN Rate
Control for downlink messages is deactivated in the MME. If the Serving PLMN
Rate Control is activated, the value of Downlink-Rate-Limit shall not be less
than 10, see 3GPP TS 23.401 [25].
An Uplink-Rate-Limit set ot 0 shall be interpreted that the Serving PLMN Rate
Control for uplink messages is deactivated in the MME. If Serving PLMN Rate
Control is activated, the value of Uplink-Rate-Limit shall not be less than
10, see 3GPP TS 23.401 [25].
### 6.4.22 Downlink-Rate-Limit
The Downlink-Rate-Limit AVP is of type type Unsigned32 and shall contain the
maximum number of NAS Data PDUs per deci hour for this UE for downlink.
### 6.4.23 Uplink-Rate-Limit
The Uplink-Rate-Limit AVP is of type Unsigned32 and shall contain the maximum
number of NAS Data PDUs per deci hour for this UE for uplink.
### 6.4.24 SCEF-Wait-Time
The SCEF-Wait-Time is of type Time and it shall contain the timestamp (in UTC)
until which the SCEF expects a response.
### 6.4.25 CMR-Flags
The CMR-Flags AVP is of type Unsigned32 and it shall contain a bit mask. The
meaning of the bits shall be as defined in table 6.4.25/1:
Table 6.4.25/1: CMR-Flags
* * *
Bit Name Description 0 UE-Reachable-Indicator This bit if set indicates that
the UE has become or is about to become reachable. NOTE 1: Bits not defined in
this table shall be cleared by the sending entity and discarded by the
receiving entity.
* * *
### 6.4.26 Extended-PCO
The Extended-PCO AVP is of type OctetString. The Extended-PCO AVP shall
contain the value part of the ePCO IE, starting from octet 4, as specified in
clause 9.9.4.26 of 3GPP TS 24.301[28].
### 6.4.27 RRC-Cause-Counter
The RRC-Cause-Counter AVP is of type Grouped and shall contain the number of
receptions of \"MO Exception data\" and the time when the cause \" MO
Exception Data\" is received for the first time.
The AVP format shall conform to:
RRC-Cause-Counter::= \
> [ Counter-Value ]
>
> [ RRC-Counter-Timestamp ]
>
> *[AVP]
### 6.4.28 Counter-Value
The Counter-Value AVP is of type type Unsigned32 and shall contain the number
of occurrences of reception of RRC cause \"MO Exception data\".
### 6.4.29 RRC-Counter-Timestamp
The RRC-Counter-Timestamp AVP is of type Time and shall contain a timestamp.
### 6.4.30 Terminal-Information
The Terminal-Information AVP is of type Grouped. This AVP shall contain the
information about the user\'s terminal. It is originally defined in 3GPP TS
29.272 [16].
AVP format
> Terminal-Information ::= \
>
> [ IMEI ]
>
> [ Software-Version ]
>
> *[ AVP ]
### 6.4.31 TDA-Flags
The TDA-Flags AVP is of type Unsigned32 and it shall contain a bit map. The
meaning of the bits shall be as defined in table 6.4.31-1:
Table 6.4.31-1: TDA-Flags
* * *
Bit Name Description 0 Acknowledged Delivery This bit when set indicates that
eNodeB has acknowledged the successful downlink NIDD delivery. NOTE Bits not
defined in this table shall be cleared by the sending entity and discarded by
the receiving entity.
* * *
### 6.4.32 Idle-Status-Indication
The Idle-Status-Indication AVP is of type Grouped, and it shall contain the
details when the UE transitions into idle mode.
AVP format:
> Idle-Status-Indication::= \
>
> [ Idle-Status-Timestamp ]
>
> [ Active-Time ]
>
> [ Subscribed-Periodic-RAU-TAU-Timer ]
>
> [ eDRX-Cycle-Length ]
>
> [ DL-Buffering-Suggested-Packet-Count ]
>
> *[AVP]
The Subscribed-Periodic-RAU-TAU-Timer AVP shall contain the periodic TAU/RAU
time granted to the UE by the MME/SGSN.
The eDRX-Cycle-Length AVP shall contain the eDRX cycle length granted to the
UE by the MME/SGSN.
The DL-Buffering-Suggested-Packet-Count AVP shall contain the suggested number
of downlink packets sent to the S-GW by the MME/SGSN.
### 6.4.33 Idle-Status-Timestamp
The Idle-Status-Timestamp AVP is of type Time and shall contain a timestamp
(the time at which the UE transitioned into idle mode).
### 6.4.34 Active-Time
Active-Time AVP is of type Unsigned32 and shall provide the active time
granted to the UE in seconds.
Annex A (normative):\ Diameter overload control mechanism
## A.1 T6a/b and T7 interfaces
### A.1.1 General
The Diameter overload control mechanism is an optional feature over the T6a/b
and T7 interface, which may be applied to the traffic of requests commands
sent to the SCEF and/or to the traffic of request commands sent to the MME or
SGSN.
It is recommended to make use of the IETF RFC 7683 [9] on the T6a/b and T7
interface where:
\- when applied to the traffic of request commands sent to the SCEF, the SCEF
shall behave as a reporting node while the MME/SGSN, and as an alternative the
IWK-SCEF shall behave as a reacting node;
\- when applied to the traffic of request commands sent to the MME or SGSN,
the MME or SGSN shall behave as a reporting node while the SCEF, and as an
alternative the IWK-SCEF, shall behave as a reacting node.
### A.1.2 SCEF behaviour
The SCEF requests traffic reduction from the MME/SGSN and the IWK-SCEF when it
is in an overload situation, by including OC-OLR AVP in answer commands as
described in IETF RFC 7683 [9].
The SCEF identifies that it is in an overload situation by implementation
specific means. For example, the SCEF may take into account the traffic over
the T6a/b interfaces or other interfaces, the level of usage of internal
resources (CPU, memory), the access to external resources etc.
The SCEF determines the specific contents of the OC-OLR AVP in overload
reports and the SCEF decides when to send OC-OLR AVPs by implementation
specific means.
The SCEF may decide to deactivate Monitoring events to reduce the number of
Reporting-Information-Requests sent for reporting monitoring events.
The SCEF shall apply required traffic reduction according to the OC-OLR AVPs
received in answer commands from the MME to subsequent applicable requests, as
per IETF RFC 7683 [9].
Requested traffic reduction is achieved by the SCEF by implementation specific
means. It may in particular implement throttling of MT non-IP data messages.
### A.1.3 MME/SGSN behaviour
The MME or SGSN requests traffic reduction from the SCEF when it is in an
overload situation, by including OC-OLR AVP in answer commands as described in
IETF RFC 7683 [9].
The MME or SGSN identifies that it is in an overload situation by
implementation specific means.
The MME or SGSN shall apply required traffic reduction according to the OC-OLR
AVPs received in answer commands from the SCEF to subsequent applicable
requests, as per IETF RFC 7683 [9].
Requested traffic reduction is achieved by the MME or SGSN by implementation-
specific means. It may in particular implement:
\- throttling of monitoring event reports or stop reporting with
prioritization (e.g. prioritisation on the type of events, or that one-time
reporting takes priority over continuous reporting, ...);
\- throttling of new T6a/b connection establishment messages;
\- throttling of MO non-IP data messages.
### A.1.4 IWK-SCEF behaviour
The IWK-SCEF, when acting as a reacting node towards the SCEF shall apply
required traffic reduction received in answer commands from the SCEF to
subsequent applicable requests received from the MME or SGSN, as per IETF RFC
7683 [9]. In this case the IWK-SCEF does not forward OC-OLR AVPs to the MME or
SGSN.
The IWK-SCEF, when acting as a reacting node towards the MME or SGSN, shall
apply required traffic reduction received in answer commands from the MME or
SGSN to subsequent applicable requests received from the SCEF, as per IETF RFC
7683 [9]. In this case the IWK-SCEF does not forward OC-OLR AVPs to the SCEF.
Requested traffic reduction is achieved by the IWK-SCEF by implementation
specific means. For example, it may implement throttling of monitoring event
report with prioritization, throttling of MO data or MT data messages.
###### ## Annex B (normative):**** Diameter message priority mechanism
## B.1 General
IETF RFC 7944 [15] specifies a Diameter routing message priority mechanism
that allows Diameter nodes to indicate the relative priority of Diameter
messages. With this information, other Diameter nodes may leverage the
relative priority of Diameter messages into routing, resource allocation, set
the DSCP marking for transport of the associated Diameter message, and also
abatement decisions when overload control is applied.
## B.2 T6a, T6ai, T6b, T6bi, T7 interfaces
The Diameter message priority mechanism is an optional feature which may apply
on one or several of the T6a, T6ai, T6b, T6bi, T7 interfaces.
It is recommended to make use of IETF RFC 7944 [15] over the T6a, T6ai, T6b,
T6bi, T7 interfaces of an operator network when the overload control defined
in Annex A is applied on these interfaces.
A 3GPP functional entity supporting the Diameter message priority mechanism
over one or several of the T6a, T6ai, T6b, T6bi, T7 interfaces shall comply
with IETF RFC 7944 [15].
A 3GPP functional entity sending a request shall determine the required
priority according to its policies. When priority is required, it shall
include the DRMP AVP indicating the required priority level in the request it
sends, and shall prioritise the request according to the required priority
level.
When the 3GPP functional element receives the corresponding response, it shall
prioritise the received response according to the priority level received
within the DRMP AVP if present in the response, otherwise according to the
priority level of the corresponding request.
When a 3GPP functional entity receives a request, it shall handle the request
according to the received DRMP AVP priority level. For the response, it may
modify the priority level received in the DRMP AVP according to its policies
and shall handle the response according to the required priority level. If the
required priority level is different from the priority level received in the
request, it shall include the DRMP AVP in the response.
If:
\- a 3GPP functional entity supports using the Diameter message priority
mechanism for DSCP marking purposes,
\- the transport network utilizes DSCP marking, and
\- message-dependant DSCP marking is possible for the protocol stack
transporting Diameter,
then the 3GPP functional entity shall set the DSCP marking for transport of
the request or response according to the required priority level.
The decisions of the 3GPP functional entity for a required priority and for
the priority level value are implementation specific.
Diameter requests related to high priority traffic shall contain a DRMP AVP
with a high priority of which the level value is operator dependent.
###### ## Annex C (normative): Diameter load control mechanism
## C.1 General
The Diameter load control mechanism is an optional feature over the T6a/b and
T7 interface, which may be applied to the traffic of request commands sent to
the SCEF and/or to the traffic of request commands sent to the MME/SGSN.
It is recommended to make use of the IETF RFC 8583 [31] on the T6a/b and T7
interface where:
\- when applied to the traffic of request commands sent to the SCEF, the
MME/SGSN, and as an alternative the IWK-SCEF shall behave as a reacting node;
\- when applied to the traffic of request commands sent to the MME/SGSN, the
SCEF, and as an alternative the IWK-SCEF, shall behave as a reacting node.
## C.2 SCEF behaviour
When performing next hop Diameter Agent selection for requests that are routed
based on realm, the SCEF may take into account load values from Load AVPs of
type PEER received from candidate next hop Diameter nodes, as per IETF RFC
8583 [31].
## C.3 MME/SGSN behaviour
When performing next hop Diameter Agent selection for requests that are routed
based on realm, the MME/SGSN may take into account load values from Load AVPs
of type PEER received from candidate next hop Diameter nodes, as per IETF RFC
8583 [31].
## C.4 IWK-SCEF behaviour
When performing next hop Diameter Agent selection for requests that are routed
based on realm, the IWK-SCEF may take into account load values from Load AVPs
of type PEER received from candidate next hop Diameter nodes, as per IETF RFC
8583 [31].
#