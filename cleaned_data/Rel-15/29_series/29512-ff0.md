# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides the stage 3 specification of the Session
Management Policy Control Service of 5G system. The stage 2 definition and
related procedures of the Session Management Policy Control Service are
contained in 3GPP TS 23.502 [3] and 3GPP TS 23.503 [6]. The 5G System
Architecture is defined in 3GPP TS 23.501 [2].
Stage 3 call flows are provided in 3GPP TS 29.513 [7].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition of the 5G System are specified in 3GPP
TS 29.500 [4] and 3GPP TS 29.501 [5].
The Policy Control Function with session related policies provides the Session
Management Policy Control Service to the NF consumers (i.e. Session Management
Function).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[5] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[6] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System;
Stage 2\".
[7] 3GPP TS 29.513: \"5G System; Policy and Charging Control signalling flows
and QoS parameter mapping; Stage 3\".
[8] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
[9] IETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange
Format\".
[10] OpenAPI: \"OpenAPI 3.0.0 Specification\", https://github.com/OAI/OpenAPI-
Specification/blob/master/versions/3.0.0.md.
[11] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces; Stage 3\".
[12] 3GPP TS 29.508: \"5G System; Session Management Event Exposure Service;
Stage 3\".
[13] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
of EPC Nodes\".
[14] Void.
[15] 3GPP TS 29.519: \"5G System; Usage of the Unified Data Repository service
for Policy Control Data, Application Data and Structured Data for Exposure;
Stage 3\".
[16] 3GPP TS 23.228: \"IP multimedia subsystem; Stage 2\".
[17] 3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".
[18] 3GPP TS 29.214: \"Policy and Charging Control over Rx reference point
5\".
[19] 3GPP TS 32.291: \"5G System; Charging service; Stage 3\".
[20] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[21] 3GPP TS 23.380: \"IMS Restoration Procedures\".
[22] 3GPP TS 29.502: \"5G System; Session Management Services; Stage 3\".
[23] 3GPP TS 29.212: \"Policy and Charging Control (PCC); Reference points\".
[24] 3GPP TS 32.422: \"Telecommunication management; Subscriber and equipment
trace; Trace control and configuration management\".
[25] 3GPP TS 29.507: \"5G System; Access and Mobility Policy Control Service;
Stage 3\".
[26] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[27] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[28] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[29] 3GPP TS 29.510: \"Network Function Repository Services; Stage 3\".
[30] 3GPP TS 32.290: \"5G system; Services, operations and procedures of
charging using Service Based Interface (SBI)\".
[31] IETF RFC 7807: \"Problem Details for HTTP APIs\".
[32] 3GPP TS 29.122: \"T8 reference point for Northbound APIs\".
[33] 3GPP TS 23.527: \"5G System; Restoration Procedures\".
[34] 3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".
[35] 3GPP TS 32.255: \"Charging management; 5G data connectivity domain
charging; stage 2\".
[36] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[37] 3GPP TS 29.274: \"3GPP Evolved Packet System (EPS); Evolved General
Packet Radio Service (GPRS) Tunnelling Protocol for Control plane (GTPv2-C);
Stage 3\".
[38] 3GPP TR 21.900: \"Technical Specification Group working methods\".
[39] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification\".
[40] 3GPP TS 29.551: \"5G System; Packet Flow Description Management Service;
Stage 3\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**Application detection filter:** A logic used to detect packets generated by
an application based on extended inspection of these packets, e.g., header
and/or payload information, as well as dynamics of packet flows. The logic is
entirely internal to a UPF, and is out of scope of this specification.
**Application identifier:** An identifier, referring to a specific application
detection filter.
**Detected application traffic:** An aggregate set of packet flows that are
generated by a given application and detected by an application detection
filter.
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.501 [2], subclause 3.1 apply:
**5G QoS Identifier**
**PCC rule**
**PDU Session**
**Service Data Flow**
**Service Data Flow Filter**
**Service Data Flow Template**
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
ADC Application Detection and Control
AF Application Function
AMF Access and Mobility Management Function
API Application Programming Interface
CHF Charging Function
DNN Data Network Name
ePDG evolved Packet Data Gateway
GFBR Guaranteed Flow Bit Rate
GUAMI Globally Unique AMF Identifier
HTTP Hypertext Transfer Protocol
NEF Network Exposure Function
NF Network Function
NRF Network Repository Function
PCC Policy and Charging Control
PCF Policy Control Function
PFD Packet Flow Description
PFDF Packet Flow Description Function
PSAP Public Safety Answering Point
QoS Quality of Service
SDF Service Data Flow
SMF Session Management Function
S-NSSAI Single Network Slice Selection Assistance Information
SUPL Secure User Plane for Location
UDM Unified Data Management
UDR Unified Data Repository
UE User Equipment
# 4 Npcf_SMPolicyControl Service
## 4.1 Service Description
### 4.1.1 Overview
The Session Management Policy Control Service performs provisioning, update
and removal of session related policies and PCC rules by the Policy Control
Function (PCF) to the NF service consumer (i.e. SMF). The Session Management
Policy Control Service can be used for charging control, policy control and/or
application detection and control. Session Management Policy Control Service
applies to the cases where the SMF interacts with the PCF in the non-roaming
scenario, the V-SMF interacts with the V-PCF in the local breakout roaming
scenario and the H-SMF interacts with the H-PCF in the home-routed scenario.
### 4.1.2 Service Architecture
The Session Management Policy Control Service is provided by the PCF to the
consumer and shown in the SBI representation model in figure 4.1.2-1 and in
the reference point representation model in figure 4.1.2-2. The overall Policy
and Charging Control related 5G architecture is depicted in 3GPP TS 29.513
[7].
The only known NF Service Consumer is the SMF.
Figure 4.1.2-1: Reference Architecture for the Npcf_SMPolicyControl Service;
SBI representation
Figure 4.1.2-2: Reference Architecture for the Npcf_SMPolicyControl Service;
reference point representation
NOTE: The SMF represents the V-SMF and the PCF represents the V-PCF in the
local breakout scenario. The SMF represents the H-SMF and the PCF represents
the H-PCF in the home routed scenario.
### 4.1.3 Network Functions
#### 4.1.3.1 Policy Control Function (PCF)
The PCF is responsible for policy control decisions and flow based charging
control functionalities. The PCF provides the following:
\- policies for application and service data flow detection, gating, QoS, flow
based charging, traffic steering control, usage monitoring control, access
network information report and RAN support information to the SMF.
The policy decisions made by the PCF may be based on one or more of the
following:
\- Information obtained from the AF, e.g. the session, media and subscriber
related information;
\- Information obtained from the UDR;
\- Information obtained from the AMF, e.g. UE related and access related
information;
\- Information obtained from the SMF;
\- Information obtained from the NWDAF;
\- Information obtained from the NEF;
\- information from CHF; and
\- PCF pre-configured policy context.
#### 4.1.3.2 NF Service Consumers
The SMF is responsible for the enforcement of session management related
policy decisions from the PCF, related to service flow detection, QoS,
charging, gating, traffic usage reporting and traffic steering.
The SMF shall support:
\- sending the PDU session related attributes to the PCF;
\- requesting and receiving the PCC rule(s) from the PCF;
\- binding of service data flows to QoS flow as defined in 3GPP TS 29.513 [7];
\- deriving rule(s) from the PCC rule(s) and then providing those rules to the
user plane function or remove the rule(s) from the user plane as defined in
3GPP TS 29.244 [13];
\- deriving the QoS rules towards the UE;
\- deriving the QoS profile towards the access network;
\- handling the policy control request trigger; and
\- handling the PDU session related policy information.
NOTE: SMF functionality related to event exposure is defined in 3GPP TS 29.508
[12].
### 4.1.4 Rules
#### 4.1.4.1 General
A rule is a set of policy information elements associated with a PDU session,
or with service data flows (i.e., with a PCC rule).
Two types of rules are defined:
\- Session rule; and
\- PCC rule.
Both Session rules and PCC rules are composed of embedded information elements
as well as information elements that are part of the referenced objects (e.g.
condition data, or usage monitoring policy data type) by the rule.
PCC rule is defined in subclause 4.1.4.2. Session rule is defined in subclause
4.1.4.3.
#### 4.1.4.2 PCC rules
##### 4.1.4.2.1 PCC rules definition
A PCC rule is a set of information elements enabling the detection of a
service data flow and providing parameters for policy control and/or charging
control. There are two different types of PCC rules as defined in 3GPP TS
23.503 [6]:
\- Dynamic PCC rules. PCC rules that are dynamically provisioned by the PCF to
the SMF. These PCC rules may be either predefined or dynamically generated in
the PCF. Dynamic PCC rules can be installed, modified and removed at any time.
\- Predefined PCC rules. PCC rules that are preconfigured in the SMF.
Predefined PCC rules can be activated or deactivated by the PCF at any time.
Predefined PCC rules within the PCF may be grouped allowing the PCF to
dynamically activate a set of PCC rules.
Additionally, predefined PCC rules may be grouped within the SMF as predefined
PCC rule bases which allow the PCF to dynamically activate these sets of
rules. In this case, the PCC rule identifier is used to hold the predefined
PCC rule base identifier.
NOTE: The operator can define a predefined PCC rule, to be activated by the
SMF. Such a predefined rule is not explicitly known in the PCF.
A PCC rule consists of:
Table 4.1.4.2.1-1: PCC rule information elements
+---------------------------+---------------------------+-----------+ | Information name | Description | Category | +---------------------------+---------------------------+-----------+ | Rule identifier | Uniquely identifies the | Mandatory | | | PCC rule, within a PDU | | | | Session. | | | | | | | | It is used between PCF | | | | and SMF for referencing | | | | PCC rules. | | +---------------------------+---------------------------+-----------+ | | Service data flow | | | | detection | | +---------------------------+---------------------------+-----------+ | Precedence | Determines the order, in | Mandatory | | | which the service data | | | | flow templates are | | | | applied at service data | | | | flow detection, | | | | enforcement and charging. | | +---------------------------+---------------------------+-----------+ | Service Data Flow | For IP PDU traffic: | Mandatory | | Template | Either a list of service | | | | data flow filters or an | | | | application identifier | | | | that references the | | | | corresponding application | | | | detection filter for the | | | | detection of the service | | | | data flow. | | | | | | | | For Ethernet PDU traffic: | | | | Combination of traffic | | | | patterns of the Ethernet | | | | PDU traffic. | | +---------------------------+---------------------------+-----------+ | Mute for notification | Defines whether | Optional | | | application\'s start or | | | | stop notification is to | | | | be muted. | | +---------------------------+---------------------------+-----------+ | | Charging | | +---------------------------+---------------------------+-----------+ | Charging key | The charging system (CHF) | Optional | | | uses the charging key to | | | | determine the tariff to | | | | apply to the service data | | | | flow. | | +---------------------------+---------------------------+-----------+ | Service identifier | The identity of the | Optional | | | service or service | | | | component the service | | | | data flow in a rule | | | | relates to. | | +---------------------------+---------------------------+-----------+ | Sponsor Identifier | An identifier, provided | Optional | | | from the AF, which | | | | identifies the Sponsor, | | | | used for sponsored flows | | | | to correlate measurements | | | | from different users for | | | | accounting purposes. | | +---------------------------+---------------------------+-----------+ | Application Service | An identifier, provided | Optional | | Provider Identifier | from the AF, which | | | | identifies the | | | | Application Service | | | | Provider, used for | | | | sponsored flows to | | | | correlate measurements | | | | from different users for | | | | accounting purposes. | | +---------------------------+---------------------------+-----------+ | Charging method | Indicates the required | Optional | | | charging method for the | | | | PCC rule. | | | | | | | | Values: online or offline | | | | or none. | | +---------------------------+---------------------------+-----------+ | Service Data flow | Indicates whether the | Optional | | handling while requesting | service data flow is | | | credit | allowed to start while | | | | the SMF is waiting for | | | | the response to the | | | | credit request. | | | | | | | | Only applicable for | | | | charging method online. | | +---------------------------+---------------------------+-----------+ | Measurement method | Indicates whether the | Optional | | | service data flow data | | | | volume, duration, | | | | combined volume/duration | | | | or event shall be | | | | measured. | | | | | | | | This is applicable to | | | | reporting, if the | | | | charging method is online | | | | or offline. | | | | | | | | Note: Event based | | | | charging is only | | | | applicable to predefined | | | | PCC rules and PCC rules | | | | used for application | | | | detection filter (i.e. | | | | with an application | | | | identifier). | | +---------------------------+---------------------------+-----------+ | Application Function | An identifier, provided | Optional | | Record Information | from the AF, correlating | | | | the measurement for the | | | | Charging key/Service | | | | identifier values in this | | | | PCC rule with application | | | | level reports. | | +---------------------------+---------------------------+-----------+ | Service identifier level | Indicates that separate | Optional | | reporting | usage reports shall be | | | | generated for this | | | | Service identifier. | | | | | | | | Values: mandated or not | | | | required. | | +---------------------------+---------------------------+-----------+ | | Policy control | | +---------------------------+---------------------------+-----------+ | 5QI | Identifier for the | Mandatory | | | authorized QoS parameters | | | | for the service data | | | | flow. | | +---------------------------+---------------------------+-----------+ | ARP | The Allocation and | Mandatory | | | Retention Priority for | | | | the service data flow | | | | consisting of the | | | | priority level, the | | | | pre-emption capability | | | | and the pre-emption | | | | vulnerability. | | +---------------------------+---------------------------+-----------+ | Gate status | The gate status indicates | Optional | | | whether the service data | | | | flow, detected by the | | | | service data flow | | | | template, may pass (Gate | | | | is open) or shall be | | | | discarded (Gate is | | | | closed). | | +---------------------------+---------------------------+-----------+ | QoS Notification Control | Indicates whether | Optional | | (QNC) | notifications are | | | | requested from 3GPP | | | | NG-RAN when the GFBR can | | | | no longer (or again) be | | | | guaranteed for a QoS Flow | | | | during the lifetime of | | | | the QoS Flow. | | +---------------------------+---------------------------+-----------+ | Reflective QoS Control | Indicates to apply | Optional | | | reflective QoS for the | | | | SDF. | | +---------------------------+---------------------------+-----------+ | MBR (UL/DL) | The uplink/downlink | Optional | | | maximum bitrate | | | | authorized for the | | | | service data flow. | | +---------------------------+---------------------------+-----------+ | GBR (UL/DL) | The uplink/downlink | Optional | | | guaranteed bitrate | | | | authorized for the | | | | service data flow. | | +---------------------------+---------------------------+-----------+ | UL sharing indication | Indicates resource | Optional | | | sharing in uplink | | | | direction with service | | | | data flows having the | | | | same value in their PCC | | | | rule. | | +---------------------------+---------------------------+-----------+ | DL sharing indication | Indicates resource | Optional | | | sharing in downlink | | | | direction with service | | | | data flows having the | | | | same value in their PCC | | | | rule. | | +---------------------------+---------------------------+-----------+ | Redirect | Redirect state of the | Optional | | | service data flow | | | | (enabled/disabled). | | +---------------------------+---------------------------+-----------+ | Redirect Destination | Controlled Address to | Optional | | | which the service data | | | | flow is redirected when | | | | redirect is enabled. | | +---------------------------+---------------------------+-----------+ | Bind to default QoS Flow | Indicates that the | Optional | | | dynamic PCC rule shall | | | | always have its binding | | | | with the default QoS | | | | Flow. | | +---------------------------+---------------------------+-----------+ | Priority Level | Indicates a priority in | Optional | | | scheduling resources | | | | among QoS Flows. | | +---------------------------+---------------------------+-----------+ | Averaging Window | Represents the duration | Optional | | | over which the guaranteed | | | | and maximum bitrate shall | | | | be calculated. | | +---------------------------+---------------------------+-----------+ | Maximum Data Burst Volume | Denotes the largest | Optional | | | amount of data that is | | | | required to be | | | | transferred within a | | | | period of 5G-AN PDB. | | +---------------------------+---------------------------+-----------+ | | Access Network | | | | Information Reporting | | +---------------------------+---------------------------+-----------+ | User Location Required | The serving cell of the | Optional | | | UE is to be reported. | | | | When the corresponding | | | | QoS flow is deactivated, | | | | and if available, | | | | information on when the | | | | UE was last known to be | | | | in that location is also | | | | to be reported. | | +---------------------------+---------------------------+-----------+ | UE Timezone Required | The time zone of the UE | Optional | | | is to be reported. | | +---------------------------+---------------------------+-----------+ | | Usage Monitoring Control | | +---------------------------+---------------------------+-----------+ | Monitoring key | The PCF uses the | Optional | | | monitoring key to group | | | | services that share a | | | | common allowed usage. | | +---------------------------+---------------------------+-----------+ | Indication of exclusion | Indicates that the | Optional | | from session level | service data flow shall | | | monitoring | be excluded from PDU | | | | Session usage monitoring. | | +---------------------------+---------------------------+-----------+ | | N6-LAN Traffic Steering | | | | Enforcement Control | | +---------------------------+---------------------------+-----------+ | Traffic steering policy | Reference to a | Optional | | identifier(s) | pre-configured traffic | | | | steering policy at the | | | | SMF. | | +---------------------------+---------------------------+-----------+ | | AF influenced Traffic | | | | Steering Enforcement | | | | Control | | +---------------------------+---------------------------+-----------+ | Data Network Access | Identifier of the target | Optional | | Identifier | Data Network Access. | | +---------------------------+---------------------------+-----------+ | Per DNAI: Traffic | Reference to a | Optional | | steering policy | pre-configured traffic | | | identifier | steering policy at the | | | | SMF. | | +---------------------------+---------------------------+-----------+ | Per DNAI: N6 traffic | Describes the information | Optional | | routing information | necessary for traffic | | | | steering to the DNAI. | | +---------------------------+---------------------------+-----------+ | Information on AF | Indicates whether a | Optional | | subscription to UP path | notification in case of | | | changes events | UP path change is | | | | requested, as well as the | | | | destination(s) for where | | | | to provide the | | | | notification. | | +---------------------------+---------------------------+-----------+ | | RAN support information | | +---------------------------+---------------------------+-----------+ | UL Maximum Packet Loss | The maximum rate for lost | Optional | | Rate | packets that can be | | | | tolerated in the uplink | | | | direction for the service | | | | data flow. | | +---------------------------+---------------------------+-----------+ | DL Maximum Packet Loss | The maximum rate for lost | Optional | | Rate | packets that can be | | | | tolerated in the downlink | | | | direction for the service | | | | data flow. | | +---------------------------+---------------------------+-----------+
The above information is organized into a set of decision data objects as
defined in subclause 4.1.4.4. The exact encoding of PCC rules is defined in
subclause 5.6.2.6.
##### 4.1.4.2.2 PCC rules operation
For dynamic PCC rules, the following applies:
\- Installation: to provision the PCC rules.
\- Modification: to modify the PCC rules.
\- Removal: to remove the PCC rules.
For predefined PCC rules, the following operations are available:
\- Activation: to activate the PCC rules.
\- Deactivation: to deactivate the PCC rules.
#### 4.1.4.3 Session rule
##### 4.1.4.3.1 Session rules definition
A session rule consists of policy information elements associated with PDU
session. A session rule is dynamically provisioned by the PCF to the SMF
(i.e., there are only dynamic session rules). The encoding of the SessionRule
data type is defined in subclause 5.6.2.7.
A session rule shall include:
\- Session Rule Identifer.
A session rule may include:
\- Authorized Session AMBR;
\- Authorized Default QoS;
\- Reference to Usage Monitoring Data; and
\- Reference to Condition Data.
##### 4.1.4.3.2 Session rules operation
For Session rules, the following applies:
\- Installation: to provision the session rules.
\- Modification: to modify the session rules.
\- Removal: to remove the session rules.
#### 4.1.4.4 Policy Decision types
##### 4.1.4.4.1 General
A policy decision is a grouping of cohesive information elements describing a
specific type of decision, e.g. QoS, Charging data, etc. A policy decision can
be linked to one or more PCC rules or one or more Session rules. A PCC rule or
session rule can at most refer to one instance of the policy decision for each
type.
The following types of policy decision are defined:
\- Traffic control data;
\- QoS data;
\- Charging data; and
\- Usage Monitoring data.
##### 4.1.4.4.2 Traffic control data definition
Traffic control data defines how traffic data flows associated with a rule are
treated (e.g. blocked, redirected). The traffic control data encoding table is
defined in subclause 5.6.2.10.
Traffic control data shall include:
\- Traffic Control Data ID.
Traffic control data may include:
\- Flow status;
\- Redirect Information;
\- Mute Notification;
\- Traffic Steering Policy ID UL;
\- Traffic Steering Policy ID DL;
\- Routing requirements; and
\- UP path change event subscription from the AF.
##### 4.1.4.4.3 QoS data definition
QoS data defines QoS parameters (e.g. bitrates) associated with a rule. The
QoS data encoding table is defined in subclause 5.6.2.8.
QoS data shall include:
\- QoS Data ID;
QoS data may include:
\- 5QI;
\- ARP;
\- QNC;
\- Maximum Packet Loss Rate UL;
\- Maximum Packet Loss Rate DL;
\- Maximum Bit Rate UL;
\- Maximum Bit Rate DL;
\- Guaranteed Bit Rate UL;
\- Guaranteed Bit Rate DL;
\- 5QI Priority Level;
\- Averaging window;
\- Maximum Data Burst Volume;
\- Bound to default QoS flow indication;
\- Resource Sharing Key UL;
\- Resource Sharing Key DL; and
\- Reflective QoS attribute.
NOTE: Either 5QI and ARP combination or Bound to default QoS flow indication
is provided.
##### 4.1.4.4.4 Charging data definition
Charging data defines charging related parameters (e.g. rating group)
associated with a rule. The charging data encoding table is defined in
subclause 5.6.2.11.
Charging data shall include:
\- Charging Data ID;
\- Rating Group.
Charging data may include:
\- Metering Method;
\- Charging Method;
\- Service Data flow handling while requesting credit;
\- Reporting Level;
\- Service ID;
\- Sponsor ID;
\- Application Service Provider ID; and
\- AF Charging ID.
##### 4.1.4.4.5 UsageMonitoring data definition
UsageMonitoring data defines usage monitoring information associated with a
rule. The UsageMonitoring data encoding table is defined in subclause
5.6.2.12.
Usage Monitoring Data shall include:
\- Usage Monitoring ID.
Usage Monitoring Data may include:
\- Volume Threshold;
\- Volume Threshold UL;
\- Volume Threshold DL;
\- Time Threshold;
\- Monitoring Time;
\- Next Volume Threshold;
\- Next Volume Threshold UL;
\- Next Volume Threshold DL;
\- Next Time Threshold;
\- Inactivity Time; and
\- PCC rule identifier(s) corresponding to the service data flow(s) which
needs to be excluded from PDU session level usage monitoring.
### 4.1.5 Policy control request trigger
Policy control request trigger is a condition when the SMF shall interact
again with PCF for further policy decision of a PDU session.
The policy control request trigger is designed as an Enumeration type defined
in the subclause 5.6.3.6.
The PCF can provide an array of policy control request triggers in policy
decision to subscribe the triggers in SMF.
When SMF interacts with PCF due to the triggering of the policy control
request triggers, the SMF shall send the related attributes that have changed
together with the corresponding triggers.
### 4.1.6 Requested rule data
Requested rule data consists of requested information by the PCF associated
with one or more PCC rules.
The requested rule data is designed as a subresource of the policy decision
within an attribute called \"lastReqRuleData\". The PCF only records the last
requested rule data.
When requesting rule data, the PCF shall include the types of data requested
for the rules within the \"reqData\" array of the \"lastReqRuleData\" and
shall also provide the corresponding policy control request triggers if the
triggers are not yet set.
The encoding of the requested rule data is further specified in subclause
5.6.2.24.
When the SMF receives the requested rule data, the SMF shall report the
corresponding information to the PCF for the associated PCC rule(s).
### 4.1.7 Requested usage data
Requested Usage data consists of requested usage reports by the PCF for one or
more instances of Usage Monitoring data decision.
The requested usage data is designed as a sub resource of the policy decision
within an attribute called \"lastReqUsageData\". The PCF only records the last
requested usage data.
The encoding of the requested usage data is further specified in subclause
5.6.2.25.
When the SMF receives the requested usage data, the SMF shall report the
corresponding accumulated usage to the PCF for the corresponding Usage
Monitoring data decision(s). The requested usage data shall not be valid for
the Usage Monitoring data decision(s) after the reporting.
### 4.1.8 Condition data
Condition data defines the condition(s) where the PCC rules or session rules
are applicable and/or not applicable. The condition data encoding is defined
in subclause 5.6.2.9.
Condition data shall include:
\- Condition Data ID.
Condition data may include:
\- Activation Time; and
\- Deactivation Time.
## 4.2 Service Operations
### 4.2.1 Introduction
The service operations defined for Npcf_SMPolicyControl are shown in table
4.2.1-1.
Table 4.2.1-1: Npcf_SMPolicyControl Operations
* * *
Service Operation Name Description Initiated by Npcf_SMPolicyControl_Create
Request to create an SM Policy Association with the PCF to receive the policy
for a PDU session. NF consumer (SMF) Npcf_SMPolicyControl_Update Request to
update the SM Policy association with the PCF to receive the updated policy
when Policy Control Request Trigger condition is met. NF consumer (SMF)
Npcf_SMPolicyControl_UpdateNotify Update and/or delete the PCC rule(s) PDU
session related policy context at the SMF and Policy Control Request Trigger
information. PCF Npcf_SMPolicyControl_Delete Request to delete the SM Policy
Association and the associated resources. NF consumer (SMF)
* * *
### 4.2.2 Npcf_SMPolicyControl_Create Service Operation
#### 4.2.2.1 General
The Npcf_SMPolicyControl_Create service operation provides means for the SMF
to request the creation of a corresponding SM Policy Association with PCF.
The Session Management procedures of the SMF and related to policies are
defined in 3GPP TS 23.501 [2], 3GPP TS 23.502 [3] and 3GPP TS 23.503 [6].
The following procedures using the Npcf_SMPolicyControl_Create service
operation are supported:
\- Request of creation of a corresponding SM Policy Association with PCF.
\- Provisioning of PCC rules.
\- Provisioning of policy control request triggers.
\- Provisioning of charging related information for PDU session.
\- Provisioning of revalidation time.
\- Policy provisioning and enforcement of authorized AMBR per PDU session.
\- Policy provisioning and enforcement of authorized default QoS.
\- Provisioning of PCC rule for Application Detection and Control.
\- 3GPP PS Data Off Support.
\- IMS Emergency Session Support.
\- Request Usage Monitoring Control.
\- Access Network Charging Identifier report.
\- Request for the successful resource allocation notification.
\- Provisioning of IP Index Information.
\- Negotiation of the QoS flow for IMS signalling.
\- PCF resource cleanup.
#### 4.2.2.2 SM Policy Association establishment
Figure 4.2.2.2-1: SM Policy Association establishment
When the SMF receives the Nsmf_PDUSession_CreateSMContext Request as defined
in subclause 5.2.2.2 of 3GPP TS 29.502 [22], if the SMF was requested not to
interact with the PCF, the SMF shall not interact with the PCF; otherwise, the
SMF shall send the POST method as step 1of the figure 4.2.2.2-1 to request to
create an \"Individual SM Policy\".
NOTE 1: The decision to not interact with PCF applies for the life time of the
PDU session.
NOTE 2: The indicator to not interact with PCF is configured in the UDM. It is
delivered by the UDM to the SMF within the Charging Characteristics using the
Session Management Subscription Data Retrieval service operation as described
in 3GPP TS 29.503 [34]. The indicator is operator specific, therefore it can
only be used in non-roaming and home routed roaming cases.
The SMF shall include SmPolicyContextData data structure in the payload body
of the HTTP POST to request a creation of representation of the \"Individual
SM Policy\" resource. The \"Individual SM Policy\" resource is created as
described below.
The SMF shall include (if available) in SmPolicyContextData data structure:
\- SUPI of the user within the \"supi\" attribute;
\- PDU Session Id within the \"pduSessionId\" attribute;
\- DNN within the \"dnn\" attribute;
\- URL identifying the recipient of SM policies update notification within the
\"notificationUri\" attribute;
\- PDU Session Type within the \"pduSessionType\" attribute;
\- PEI within the \"pei\" attribute;
\- Internal Group Id(s) within the \"interGrpIds\" attribute;
\- type of access within the \"accessType\" attribute;
\- type of the radio access technology within the \"ratType\" attribute;
\- the UE Ipv4 address within the \"ipv4Address\" attribute and/or the UE Ipv6
prefix within the \"ipv6AddressPrefix\" attribute;
\- the UE time zone information within \"ueTimeZone\" attribute;
\- subscribed Session-AMBR within \"subsSessAmbr\" attribute;
\- subscribed Default QoS Information within \"subsDefQos\" attribute;
\- the number of supported packet filters for signalled QoS rules within the
\"numOfPackFilter\";
\- the online charging status within \"online\" attribute;
\- the offline charging status within \"offline\" attribute;
\- the charging characteristics within \"chargingCharacteristics\" attribute;
\- access network charging identifier within the \"accNetChId\" attribute;
\- the address of the network entity performing charging within the
\"chargEntityAddr\" attribute;
\- 3GPP PS data off status within the \"3gppPsDataOffStatus\" attribute;
\- indication of UE supporting reflective QoS within the \"refQosIndication\"
attribute;
\- user location information within the \"userLocationInfo\" attribute;
\- the S-NSSAI corresponding to the network slice the PDU session is allocated
within the \"sliceInfo\" attribute;
\- the QoS flow usage required of the default QoS flow within the
\"qosFlowUsage\" attribute;
\- identifier of the serving network within the \"servingNetwork\" attribute;
\- serving network function identifier within the \"servNfId\" attribute; and
\- trace control and configuration parameters information encoded as
\"traceReq\" attribute.
The SMF may include in \"SmPolicyContextData\" data structure the IPv4 address
domain identity within the \"ipDomain\" attribute.
NOTE 3: The \"ipDomain\" attribute is helpful when within a network slice
instance, there are several separate IP address domains, with SMF/UPF(s) that
allocate Ipv4 IP addresses out of the same private address range to UE PDU
Sessions. The same IP address can thus be allocated to UE PDU sessions served
by SMF/UPFs in different IPv4 address domains. If one PCF controls several
SMF/UPFs in different IP address domains, the UE IP address is thus not
sufficient for the AF session binding procedure, as described in 3GPP TS
29.514 [17]. The SMF assists the PCF in the session binding supplying an
\"ipDomain\" attribute denoting the IPv4 address domain identity of the
allocated UE IPv4 address.
When the PCF receives the HTTP POST request from the SMF, the PCF shall make
an authorization based on the information received from the SMF and, if
available, AMF, CHF, AF, UDR, NWDAF and operator policy pre-configured at the
PCF. If the authorization is successful, the PCF shall create a new resource,
which represents \"Individual SM Policy\", addressed by a URI as defined in
subclause 5.3.3.2 and contains a PCF created resource identifier. The PCF
shall respond to the SMF with a 201 Created message, including:
\- Location header field containing the URI for the created resource; and
\- a response body providing session management related policies, e.g.
provisioning of PCC rules as defined in subclause 4.2.6.2, provisioning of
policy control request triggers as defined in subclause 4.2.6.4.
The SMF shall use the URI received in the Location header in subsequent
requests to the PCF to refer to the \"Individual SM Policy\".
It the PCF received a \"traceReq\" attribute, it shall perform trace
procedures as defined in 3GPP TS 32.422 [24].
If errors occur when processing the HTTP POST request, the PCF shall apply
error handling procedures as specified in subclause 5.7.
If the user information received within the \"supi\" attribute is unknown, the
PCF shall reject the request and include in an HTTP \"400 Bad Request\"
response message the \"cause\" attribute of the ProblemDetails data structure
set to \"USER_UNKNOWN\".
If the PCF is, due to incomplete, erroneous or missing information (e.g. QoS,
RAT type, subscriber information) not able to provision a policy decision as
response to the request for PCC rules by the SMF, the PCF may reject the
request and include in an HTTP \"400 Bad Request\" response message the
\"cause\" attribute of the ProblemDetails data structure set to
\"ERROR_INITIAL_PARAMETERS\".
If the PCF, based on local configuration and/or operator policies, denies the
creation of the Individual SM Policy resource, the PCF may reject the request
and include in an HTTP \"403 Forbidden\" response message the \"cause\"
attribute of the ProblemDetails data structure set to
\"POLICY_CONTEXT_DENIED\". Based on configured failure action, the SMF at
reception of this error code may reject the PDU session establishment or allow
the PDU session establishment applying local policies.
If the SMF receives HTTP response with these codes, the SMF shall reject the
PDU session establishment that initiated the HTTP POST Request.
#### 4.2.2.3 Provisioning of charging related information for PDU session
##### 4.2.2.3.1 Provisioning of Charging Addresses
The PCF may provide the CHF address(es) to the SMF during the initial
interaction with the SMF defining the charging function respectively based on
the operator policy. In this case, the PCF may retrieve the CHF address(es) as
follows:
\- receives it from the UDR as part of the Policy Data Subscription
information as defined in subclause 5.2.10 of 3GPP TS 29.519 [15].
\- locally configured in the PCF based on operator policies.
\- discovers using NRF as described in subclause 6.1 of 3GPP TS 32.290 [30].
In order to provision the CHF address(s) to the SMF, the PCF shall include the
\"chargingInfo\" attribute containing the charging address within the
SmPolicyDecision data structure. Within the ChargingInformation data
structure, both primary CHF address within a \"primaryChfAddress\" attribute
and secondary CHF address within a \"secondaryChfAddress\" attribute shall be
provided simultaneously. These shall overwrite any predefined addresses at the
SMF. Provisioning CHF addresses without PCC rules for charged service data
flows shall not be considered as an error since such PCC rules may be provided
later. If the PCF has provided the CHF address, it shall not modify the CHF
address in subsequent interactions.
If no CHF address is provisioned by the PCF, the SMF shall use the CHF address
obtained via one of the following procedures with this precedence (highest to
lowest) order (see 3GPP TS 32.255 [35], subclause 5.1.8):
1\. UDM provided charging characteristics.
2\. NRF based discovery.
3\. SMF locally configured charging characteristics.
##### 4.2.2.3.2 Provisioning of Default Charging Method
The default charging method indicates what charging method shall be used for
every PCC rule where the charging method is omitted within the PCC rule. The
SMF may have a pre-configured default charging method.
Upon the initial interaction with the PCF, the SMF shall provide the pre-
configured default charging method, if available, within the \"offline\"
attribute and/or \"online\" attribute embedded directly within the
SmPolicyContextData data structure of HTTP POST message to the PCF.
The PCF may provide the default charging method which applies to the PDU
session. In order to do so, if offline charging applies, the PCF shall include
the \"offline\" attribute set to \"true\" within the SmPolicyDecision data
structure, or if online charging applies, the PCF shall include the \"online\"
attribute set to \"true\" within the SmPolicyDecision data structure in the
response of HTTP POST message. The default charging method provided by the PCF
shall overwrite any predefined default charging method at the SMF. If the PCF
has provided the default charging method, it shall not modify the default
charging method in subsequent interactions.
NOTE: It is possible that there is no default charging method applied to a PDU
session.
#### 4.2.2.4 Provisioning of revalidation time
The PCF may within the SmPolicyDecision data structure provide the
revalidation time within the \"revalidationTime\" attribute and the RE_TIMEOUT
policy control request trigger within the \"policyCtrlReqTriggers\" attribute
to instruct the SMF to trigger a PCF interaction to request PCC rule from the
PCF.
The SMF shall start the timer based on the revalidation time and shall send
the PCC rule request before the indicated revalidation time.
#### 4.2.2.5 Policy provisioning and enforcement of authorized AMBR per PDU
session
The SMF may include the subscribed AMBR per PDU session with the
\"subsSessAmbr\" attribute within the SmPolicyContextData data structure as
defined in subclause 4.2.2.2. The PCF shall authorize the session AMBR based
on the operator\'s policy and provision the authorized session AMBR to the SMF
in the response of the message as defined in subclauses 4.2.6.3.1 and
4.2.6.3.2.
Upon receiving the authorized session AMBR, the SMF shall apply the
corresponding procedures towards the access network, the UE and the UPF for
the enforcement of the AMBR per PDU session.
#### 4.2.2.6 Policy provisioning and enforcement of authorized default QoS
During the PDU session establishment as defined in subclause 4.2.2.2, the SMF
may include the subscribed default QoS with the \"subsDefQos\" attribute. The
PCF shall provision the authorized default QoS to the SMF in the response of
the message as defined in subclauses 4.2.6.3.1 and 4.2.6.3.2.
Upon receiving the authorized default QoS, the SMF enforces it which may lead
to the change of the subscribed default QoS. The SMF shall apply the
corresponding procedures towards the access network, the UE and the UPF for
the enforcement of the authorized default QoS.
NOTE 1: If dynamic PCC is not deployed, the SMF can have a DNN based
configuration to enable the establishment of a GBR resource type default QoS
flow. This configuration contains a standardized GBR 5QI as well as GFBR and
MFBR for UL and DL.
NOTE 2: GBR resource type is not applicable to the default QoS flow of the PDU
session which is interworking with EPS.
#### 4.2.2.7 Provisioning of PCC rule for Application Detection and Control
If the ADC feature is supported, and the user subscription indicates that the
application detection and control is required, the PCF may provision PCC rule
for application detection and control as defined in subclause 4.2.6.2.11 in
the response message.
If the SMF receives the PCC rule for application detection and control, the
SMF shall instruct the UPF as defined in 3GPP TS 29.244 [13] to detect the
application traffic.
#### 4.2.2.8 3GPP PS Data Off Support
When the 3GPP-PS-Data-Off feature as defined in subclause 5.8 is supported,
and if the SMF is informed that the 3GPP PS Data Off status of the UE is set
to active during the PDU session establishment, it shall include the
\"3gppPsDataOffStatus\" attribute set to true within the SmPolicyContextData
data structure in the HTTP POST message as defined in subclause 4.2.2.2.
If the PCF receives that HTTP POST message with a \"3gppPsDataOffStatus\" set
to true as above and the access type of the PDU session indicated as
\"3GPP_ACCESS\", the PCF shall configure the SMF to block any downlink and
optionally uplink IP flows not relating to a service within the list of 3GPP
PS Data Off Exempt Services, for instance by not installing any related
dynamic PCC rule(s) or by not activating related predefined PCC rule(s) such
as PCC rule(s) with wild-carded service data flow filters. The PCF may also,
subject to its normal policies, provide the PCC rule for service(s) from the
list of 3GPP PS Data Off Exempt Service as defined in subclause 4.2.6.2.1.
The PCF shall subscribe to \"AC_TY_CH\" policy control request trigger with
the SMF as defined in subclause 4.2.6.4 to support this feature if the PCF
determines the UE is allowed to access the non-3GPP access.
NOTE 1: The PCF can be configured with a list of 3GPP PS Data Off Exempt
Services per DNN and S-NSSAI. The list of 3GPP PS Data Off Exempt Services for
an DNN and S-NSSAI can also be empty, or can allow for any service within that
DNN and S-NSSAI, according to operator policy.
NOTE 2: For the PDU session used for IMS services, the 3GPP Data Off Exempt
Services are enforced in the IMS domain as specified 3GPP TS 23.228 [16].
Policies configured in the PCF need to ensure that IMS services are allowed
when the 3GPP Data Off status of the UE is set to activated, e.g. by treating
any service within a well-known IMS DNN as 3GPP PS Data Off Exempt Services.
#### 4.2.2.9 IMS Emergency Session Support
A SMF that requests PCC Rules at PDU Session Establishment shall send an HTTP
POST message as defined in subclause 4.2.2.2 and the \"dnn\" attribute
including the Emergency DNN. The SMF may include the SUPI within the \"supi\"
attribute and if the SUPI is not available or unauthenticated, the SMF shall
include the PEI within the \"pei\" attribute, the \"invalidSupi\" attribute
set to \"true\" and an implementation specific value within the \"supi\"
attribute. The SMF may include the rest of the attributes described in
subclause 4.2.2.2. The SMF may also include the GPSI if available within the
\"gpsi\" attribute.
The PCF shall detect that a PDU session is restricted to IMS Emergency
services when the HTTP POST message is received and the \"dnn\" attribute
includes a data network identifier that matches one of the Emergency DNs from
the configurable list. The PCF does not perform subscription check with UDR;
instead it uses the locally configured operator policies to make authorization
and policy decisions. The PCF:
\- shall provision PCC Rules restricting the access to Emergency Services
(e.g. P-CSCF(s), DHCP(s) and DNS (s) and SUPL(s) addresses) as required by
local operator policies in a response message according to the procedures
described in subclause 4.2.6.
\- may provision the authorized QoS that applies to the default QoS flow
within the \"authDefQos\" attribute of a session rule according to the
procedures described in subclause 4.2.3.6 except for obtaining the authorized
QoS upon interaction with the UDR. The value for the \"priorityLevel\"
attribute included within the \"arp\" attribute shall be assigned as required
by local operator policies (e.g. if an IMS Emergency session is prioritized
the \"priorityLevel\" attribute may contain a value that is reserved for an
operator domain use of IMS Emergency sessions). If the \"accessType\"
attribute is assigned to \"3GPP_ACCESS\" the values for \"preemptCap\" and the
\"preemptVuln\" attributes included within the \"arp\" attribute shall be
assigned as required by local operator policies.
\- may provision the authorized session AMBR in the response message according
to the procedures described in subclause 4.2.3.5.
When the SMF detects that the provisioning of PCC Rules failed, the PCC rule
error handling procedure shall be performed.
#### 4.2.2.10 Request Usage Monitoring Control
If the UMC as defined in subclause 5.8 is support, the PCF may provision the
usage monitoring control policy to the SMF as defined in subclause 4.2.6.5.3.
#### 4.2.2.11 Access Network Charging Identifier report
During the PDU session establishment, the SMF may provide the access network
charging identifier information within the \"accNetChId\" attribute. Within
the AccNetChId data structure, the SMF shall include the \"accNetChaIdValue\"
containing the Access Network Charging Identifier for the default QoS flow and
the \"sessionChScope\" attribute set to true if the Access Network Charging
Identifier is applied to the whole PDU session. The SMF may provide the
address of the network entity performing charging within the
\"chargEntityAddr\" attribute.
NOTE: During the PDU Session Establishment no \"refPccRuleIds\" attribute is
provided regardless if the charging identifier applies to the entire PDU
session or to the default QoS flow since the PCC Rules are not yet authorized
at this stage.
#### 4.2.2.12 Request for the successful resource allocation notification
The PCF may request the SMF to confirm that the resources associated to a PCC
rule are successfully allocated as defined in subclause 4.2.6.5.5.
#### 4.2.2.13 Request of Presence Reporting Area Change Report
If the PRA feature as defined in subclause 5.8 is supported, the PCF may
provision the Presence Reporting Area Information to the SMF as defined in
subclause 4.2.6.5.6.
#### 4.2.2.14 Provisioning of IP Index Information
If the PDU session type received within the \"pduSessionType\" attribute is
\"IPv4\" or \"IPv6\" or \"IPv4v6\", and no corresponding IP address/prefix is
received, the PCF may within the SmPolicyDecision data structure include the
IP index information within the \"ipv4Index\" attribute for IPv4 address
allocation and/or \"ipv6Index\" attribute for IPv6 address allocation.
The SMF may use this to assist in selecting how the IP address is to be
allocated when multiple allocation methods, or multiple instances of the same
method are supported.
#### 4.2.2.15 Negotiation of the QoS flow for IMS signalling
If the SMF includes the \"qosFlowUsage\" attribute required for the default
QoS flow within the SmPolicyContextData data structure during the PDU session
establishment procedure, the PCF shall provide the \"qosFlowUsage\" attribute
back in the response with the authorized usage.
If during PDU session establishment procedure, the SMF includes the "IMS_SIG\"
value within the \"qosFlowUsage\" attribute and the PCF accepts that default
QoS flow is dedicated to IMS signalling, the PCF shall within the
SmPolicyDecision data structure include the \"IMS_SIG\" value within the
\"qosFlowUsage\" attribute. In this case, the PCF shall restrict the QoS flow
to only be used for IMS signalling as specified in 3GPP TS 23.228 [16] by
applying the applicable 5QI for IMS signalling.
If the SMF include the \"IMS_SIG\" value within the \"qosFlowUsage\" attribute
of the SmPolicyContextData data structure, but the PCF does not include the
\"IMS_SIG\" within the \"qosFlowUsage\" attribute of SmPolicyDecision data
structure, the PCC Rules provided by the PCF shall have a 5QI value different
from the 5QI value for the IMS signalling.
#### 4.2.2.16 PCF resource cleanup
In the Npcf_SMPolicyControl_Create service operation, the SMF as NF service
consumer may provide SMF Id in \"smfId\" attribute and recovery timestamp in
\"recoveryTime\" attribute. The PCF may use the \"smfId\" attribute to
supervise the status of the SMF as described in subclause 5.2 of 3GPP TS
29.510 [29] and perform necessary cleanup upon status change of the SMF later,
and/or both the \"smfId\" attribute and the \"recoveryTime\" attribute in
cleanup procedure as described in subclause 6.4 of 3GPP TS 23.527 [33].
### 4.2.3 Npcf_SMPolicyControl_UpdateNotify Service Operation
#### 4.2.3.1 General
The UpdateNotify service operation provides updated Session Management related
policies to the NF service consumer (SMF) or triggers the deletion of the
context of SM related policies. The POST method is used for both, update and
delete operations.
The following procedures using the Npcf_SMPolicyControl_UpdateNotify service
operation are supported:
\- PCF initiated update of the policies associated with the PDU session.
\- PCF initiated deletion of SM Policy Association of a PDU session.
\- Provisioning of PCC rules.
\- Provisioning of policy control request triggers.
\- Provisioning of revalidation time.
\- Policy provisioning and enforcement of authorized AMBR per PDU session.
\- Policy provisioning and enforcement of authorized default QoS.
\- Provisioning of PCC rule for Application Detection and Control.
\- 3GPP PS Data Off Support.
\- IMS Emergency Session Support.
\- Request Access Network Information.
\- Request Usage Monitoring Control.
\- Request for the result of PCC rule removal.
\- Access Network Charging Identifier request.
\- Request for the successful resource allocation notification.
\- IMS Restoration Support.
\- P-CSCF Restoration Enhancement Support.
#### 4.2.3.2 SM Policy Association Update request
Figure 4.2.3.2-1: SM Policy Association Update request
The PCF may decide to provision policies without obtaining a request from the
SMF, e.g. in response to information provided to the PCF via the Rx or N5
reference point, or in response to an internal trigger within the PCF. The PCF
shall send a POST request to the NF Service Consumer (SMF)
(../{notificationUri}/update). The payload body of the message shall contain
an SmPolicyNotification data structure that contains the representation of the
updated policies within the \"smPolicyDecision\" attribute and the resource
URI of individual SM Policy related to the notification within the
\"resourceUri\" attribute. Detailed procedures related to the provisioning and
enforcement of the policy decisions within the SmPolicyDecision data structure
are contained in subclause 4.2.6.
In case of a successful update of SM policies:
\- if the PCF provisioned the policy control request triggers related to
access type change, RAT change or location change, a \"200 OK\" response code
and a response body with the corresponding available information in the
\"UeCampingRep\" data structure shall be returned in the response;
\- otherwise, a \"204 No Content\" response code shall be returned in the
response.
If errors occur when processing the HTTP POST request, the SMF shall apply
error handling procedures as specified in subclause 5.7.
If the SMF received one or more PCC rules from the PCF but the validation of
all the PCC Rules were unsuccessful, the SMF shall reject the request and
include in an HTTP \"400 Bad Request\" response message the ErrorReport data
structure. Within the ErrorReport data structure, SMF shall include the
\"error\" attribute containing the \"cause\" attribute of the ProblemDetails
data structure set to \"PCC_RULE_EVENT\" or \"PCC_QOS_FLOW_EVENT\" and the
\"ruleReports\" attribute to report the PCC rule status of affected PCC rules
as defined in subclause 4.2.3.16.
If the \"SessionRuleErrorHandling\" feature is supported and if the SMF
received one or more PCC rules and/or session rules from the PCF but the
validation of all the PCC Rules and/or session rule were unsuccessful, the SMF
shall reject the request and include in an HTTP \"400 Bad Request\" response
message the ErrorReport data structure. Within the ErrorReport data structure,
SMF shall include the \"error\" attribute containing the \"cause\" attribute
of the ProblemDetails data structure set to \"RULE_PERMANENT_ERROR \" or
\"RULE_TEMPORARY_ERROR\" and the \"ruleReports\" attribute to report the PCC
rule status of affected PCC rules as defined in subclause 4.2.3.16 and/or the
\"sessRuleReports\" attribute to report the session rule status of affected
session rules as defined in subclause 4.2.3.20.
If the SMF received one or more PCC rules from the PCF but the validation of
some of them were unsuccessful, the SMF shall include an HTTP \"200 OK\"
status code together with one or more RuleReport data structure(s) to report
the PCC rule status of affected PCC rules as defined in subclause 4.2.3.16 in
the \"PartialSuccessReport\" data structure included in the response message.
The \"failureCause\" attribute of the \"PartialSuccessReport\" shall be set to
\"PCC_RULE_EVENT\" or \"PCC_QOS_FLOW_EVENT\".
If the \"SessionRuleErrorHandling\" feature is supported and if the SMF
received one or more PCC rule and/or session rules from the PCF but the
validation of some of them were unsuccessful, the SMF shall include an HTTP
\"200 OK\" status code together with the \"ruleReports\" attribute to report
the PCC rule status of affected PCC rules as defined in subclause 4.2.3.16
and/or the \"sessRuleReports\" attribute to report the session rule status of
affected session rules as defined in subclause 4.2.3.20 in the
\"PartialSuccessReport\" data structure included in the response message. The
\"failureCause\" attribute of the \"PartialSuccessReport\" shall be set to
\"RULE_PERMANENT_ERROR\" or \"RULE_TEMPORARY_ERROR\".
If the PCF provisioned policy control request triggers, the SMF may include in
the \"PartialSuccessReport\" data structure the \"ueCampingRep\" attribute
with the corresponding available information. When it is required to report
multiple instances of the \"PartialSuccessReport\" data structure due to
different \"failureCause\" values, the SMF shall use only one instance of the
\"PartialSuccessReport\" data structure to include the ueCampingRep\"
attribute with the corresponding available information.
#### 4.2.3.3 SM Policy Association termination request
Figure 4.2.3.3-1: SM Policy Association termination request
The PCF may request the PDU session termination in the following instances:
\- If the PCF decides to terminate a PDU session due to an internal trigger or
trigger from the UDR.
\- The PCF may also decide to terminate an PDU session upon receiving POST
message from the SMF (e.g. when usage quota reached).
The PCF shall send a POST request to the NF Service Consumer (SMF)
(../{notificationUri}/terminate) and include the TerminationNotification data
structure in the body of the HTTP POST request. Within the
TerminationNotification data structure, the PCF shall include the resource URI
of the individual SM policy related to the notification within the
\"resourceUri\" attribute and the cause why the PCF requests the termination
of the policy association encoded as \"cause\" attribute.
If the SMF accepted received POST request the SMF shall send \"204 No
Content\" response.
After the successful processing of the HTTP POST request, the SMF shall invoke
the Npcf_SMPolicyControl_Delete Service Operation defined in subclause 4.2.5
to terminate the policy association and initiate the procedure to terminate
the PDU session as defined in 3GPP TS 29.502 [22].
If errors occur when processing the HTTP POST request, the SMF shall apply
error handling procedures as specified in subclause 5.7.
#### 4.2.3.4 Provisioning of revalidation time
During the lifetime of the PDU session, within the SmPolicyDecision data
structure, the PCF may provide the revalidation time within the
\"revalidationTime\" attribute and the RE_TIMEOUT policy control request
trigger within the \"policyCtrlReqTriggers\" attribute to instruct the SMF to
trigger a PCF interaction to request PCC rule from the PCF if not provided
yet. The PCF may also update the revalidation time by including the new value
within the \"revalidationTime\" attribute. The PCF may disable the
revalidation function by removing RE_TIMEOUT policy control request trigger if
it has been provided.
When the SMF receives the revalidation time within \"revalidationTime\"
attribute, the SMF shall store the received value and start the timer based on
it. Then the SMF shall send the PCC rule request before the indicated
revalidation time.
If the RE_TIMEOUT policy control request trigger is removed, SMF shall stop
the timer for revalidation.
NOTE: By disabling the revalidation function the revalidation time value
previously provided to the SMF is not applicable anymore.
#### 4.2.3.5 Policy provisioning and enforcement of authorized AMBR per PDU
session
The PCF may modify the authorized session AMBR at any time during the lifetime
of the PDU session and provision it to the SMF by invoking the procedure as
defined in subclause 4.2.3.2. The PCF shall provision the new authorized
session AMBR to the SMF in the response of the message as defined in
subclauses 4.2.6.2.1 and 4.2.6.2.2.
Upon receiving the authorized session AMBR, the SMF shall apply the
corresponding procedures towards the access network, the UE and the UPF for
the enforcement of the AMBR per PDU session.
For UL Classifier or Multi-homing PDU Session, the SMF will provision the
policies of session-AMBR for downlink and uplink direction to the UL
Classifier/Branching Point functionality and in addition provision the
policies of session-AMBR in the downlink direction to all the PDU session
anchors as defined in subclause 5.4.4 of 3GPP TS 29.244 [13].
#### 4.2.3.6 Policy provisioning and enforcement of authorized default QoS
The PCF may modify the authorized default QoS during the lifetime of the PDU
session and provision it to the SMF by invoking the procedure as defined in
subclause 4.2.3.2. The PCF shall provision the authorized default QoS to the
SMF in the response of the message as defined in subclauses 4.2.6.3.1 and
4.2.6.3.2.
Upon receiving the authorized default QoS, the SMF enforces it which may lead
to the change of the subscribed default QoS. The SMF shall apply the
corresponding procedures towards the access network, the UE and the UPF for
the enforcement of the authorized default QoS.
#### 4.2.3.7 Provisioning of PCC rule for Application Detection and Control
If the ADC feature is supported, and the user subscription indicates that the
application detection and control is required, the PCF may provision PCC rule
for application detection and control as defined in subclause 4.2.6.2.11 in
the HTTP POST request.
If the SMF receives the PCC rule for application detection and control, the
SMF shall instruct the UPF as defined in 3GPP TS 29.244 [13] to detect the
application traffic.
#### 4.2.3.8 3GPP PS Data Off Support
When the PCF receives service information from the AF while the 3GPP PS Data
Off handling functionality is active, the PCF shall check whether the
corresponding service is a 3GPP PS Data Off Exempt Service and permissible
according to the userÂ´s subscription and the policies of the PCF. If so, the
PCF shall install, modify or delete corresponding PCC rules. Otherwise, the
PCF shall reject the service information from the AF.
If the PCF determines that the 3GPP PS Data Off handling functionality becomes
inactive, the PCF shall perform policy control decision and provision the PCC
rules to make sure that services are allowed according to the user\'s
subscription and operator policy (irrespective of whether they belong to the
list of 3GPP PS Data Off Exempt Services).
NOTE: The PCF can then open gates via the \"flowStatus\" attribute for active
PCC associated to services not within the list 3GPP PS Data Off Exempt
Services. The PCF can also install PCC rules or activate predefined PCC rules
for some services not belonging to the list 3GPP PS Data Off Exempt Services.
If the PCF activates or installs a PCC rule with wildcarded filters, it can
remove or de-activate PCC rules for 3GPP PS Data Off Exempt Services that are
made redundant by this PCC rule.
#### 4.2.3.9 IMS Emergency Session Support
##### 4.2.3.9.1 Provisioning of PCC rule
When the PCF receives IMS service information from the AF for an Emergency
service and derives authorized PCC Rules from the service information, the
\"priorityLevel\" attribute, the \"preemptCap\" attribute and the
\"preemptVuln\" attribute in the ARP within the QoS data decision which the
PCC Rule refers to shall be assigned a priority and pre-emption as required by
local operator policies (e.g. if an IMS Emergency session is prioritized the
\"priorityLevel\" attribute may contain a value that is reserved for an
operator domain use of IMS Emergency session).
The PCF shall immediately initiate the procedure as described in subclause
4.2.6.2.1 to provision PCC Rules and the procedures described in subclause
4.2.6.2.3 to provision the authorized QoS per service data flow.
The provisioning of PCC Rules at the SMF that require the establishment of a
dedicated QoS flow for emergency services shall cancel the inactivity timer in
the SMF, if it started running as defined in the subclause 4.2.3.9.2.
Any SMF-initiated request for PCC Rules for an IMS Emergency service with the
\"repPolicyCtrlReqTriggers\" attribute containing the \"RES_MO_RE\" value
(i.e. UE-initiated resource reservation) shall be rejected by the PCF
including in an HTTP \"403 Forbidden\" response message the \"cause\"
attribute of the ProblemDetails data structure set to
\"ERROR_TRAFFIC_MAPPING_INFO_REJECTED\".
The SMF shall execute the procedures to ensure that a new QoS flow is
established for the Emergency service.
When the SMF detects that the provisioning of PCC Rules failed, the PCC rule
error handling procedure shall be performed.
##### 4.2.3.9.2 Removal of PCC Rules for Emergency Services
The reception of a request to terminate an AF session for an IMS Emergency
service by the PCF triggers the removal of PCC Rules assigned to the
terminated IMS Emergency Service from the SMF by using the procedure as
defined in subclause 4.2.6.2.1 to removed PCC Rules.
At reception of an HTTP POST message that removes one or several PCC Rules
from an PDU Session restricted to emergency services the SMF shall:
\- when all PCC Rules bound to a QoS flow are removed, initiate a QoS flow
termination procedure.
\- when not all PCC Rule bound to a QoS flow are removed, initiate an QoS flow
modification procedure.
In addition, the SMF shall initiate an inactivity timer if all PCC Rules with
a 5QI other than the 5QI of the default QoS flow or the 5QI used for IMS
signalling were removed from the PDU session restricted to Emergency Services
(e.g., to enable PSAP Callback session). When the inactivity timer expires,
the SMF shall initiate a PDU session termination procedure as defined in
subclause 4.2.3.3.
#### 4.2.3.10 Request of Access Network Information
If the NetLoc as defined in subclause 5.8 is supported, the PCF may request
the SMF to report the access network information as defined in subclause
4.2.6.5.4.
#### 4.2.3.11 Request Usage Monitoring Control
If the UMC as defined in subclause 5.8 is supported, the PCF may provision the
usage monitoring control policy to the SMF as defined in subclause 4.2.6.5.3
to request the usage monitoring control.
#### 4.2.3.12 Ipv6 Multi-homing support
During the lifetime of the Multi-homing PDU session, the PCF shall provision
the PCC rules and session rules to SMF. The SMF shall derive the appropriate
policies based on the policies provisioned by the PCF and provision them to
the appropriate UPF if applicable, access network, if applicable, and UE if
applicable.
#### 4.2.3.13 Request for the result of PCC rule removal
If the RAN-NAS-Cause feature is supported, the PCF may request the SMF to
inform it of the result of the PCC rule removal when the PCF removes the PCC
rule as defined in subclause 4.2.6.5.2.
When the SMF receives the request, the SMF shall maintain locally the removed
PCC rules until it receives of the resource release outcome from the network.
#### 4.2.3.14 Access Network Charging Identifier request
The PCF may request the SMF to provide the Access Network Charging Identifier
associated to the dynamic PCC rules as defined in subclause 4.2.6.5.1.
#### 4.2.3.15 Request for the successful resource allocation notification
The PCF may request the SMF to confirm that the resources associated to a PCC
rule are successfully allocated as defined in subclause 4.2.6.5.5.
#### 4.2.3.16 PCC Rule Error Report
If the SMF receives one or more PCC rules as defined in subclause 4.2.3.1 but
the validation of all the PCC Rule was unsuccessful, the SMF shall reject the
request and include an HTTP \"400 Bad Request\" status code and the
\"ruleReports\" attribute for the affected PCC rules to report the failure
within the ErrorReport data structure; otherwise if the validation of some of
PCC rules was unsuccessful, the SMF shall include an HTTP \"200 OK\" status
code and one or more RuleReport data structure(s) for the affected PCC rules
to report the failure within the PartialSuccessReport data structure in the
response message. Within each RuleReport instance, the SMF shall identify the
failed PCC rule(s) by including the affected PCC rules within the
\"pccRuleIds\" attribute(s), identify the failed reason code by including a
\"failureCode\" attribute, and shall include rule status within the
\"ruleStatus\" attribute with the value as described below.
If the installation/activation of one or more new PCC rules (i.e. rules which
were not previously successfully installed) fails, the SMF shall set the
\"ruleStatus\" to INACTIVE.
If the modification of a currently active PCC rule fails, the SMF shall retain
the existing PCC rule as active without any modification unless the reason for
the failure has an impact also on the existing PCC rule.
The removal of a PCC rule shall not fail, even if the PDU session procedures
with the UE fail. The SMF shall retain information on the removal and conduct
the necessary PDU session procedures with the UE when it is possible.
Depending on the value of the \"failureCode\" attribute, the PCF may decide
whether retaining of the old PCC rule, re-installation, modification, removal
of the PCC rule or any other action applies.
If the \"RuleVersioning\" feature is supported and the PCF included the
\"contVer\" attribute for a specific PCC rule instance in the \"pccRules\"
attribute, then if the resource allocation for the corresponding PCC rule was
unsuccessful, the SMF shall include the \"contVers\" attribute for the
corresponding RuleReport instance included in the \"ruleReports\" attribute.
Depending on the value of the \"failureCode\" attribute, and when applicable,
depending also on the value of the \"contVer\" attribute, the PCF may decide
whether retaining of the old PCC rule, re-installation, modification, removal
of the PCC rule or any other action applies.
#### 4.2.3.17 IMS Restoration Support
In order to support IMS Restoration procedures (refer to 3GPP TS 23.380 [21]),
PCF needs to convey the AF address to the SMF. In order to do so, in case AF
provisions information about the AF signalling flows between the UE and the
AF, as defined in 3GPP TS 29.214 [18] subclause 4.4.5a, the PCF shall install
the corresponding dynamic PCC rules (if not installed before) as defined in
subclause 4.2.6.2.1. The PCF shall within the PccRule instance include the
signalling flows between UE and the AF within the \"flowInfos\" attribute and
the \"afSigProtocol\" attribute set to the value corresponding to the
signalling protocol used between the UE and the AF.
The SMF shall respond with \"204 no content\" to the PCF and initiate the
corresponding QoS flow procedure if required. The SMF shall extract the AF
address from the PCC rules and use it for the monitoring procedure as defined
for the different access types.
NOTE 1: The SMF can use the extracted AF address from the PCC rule to check
if, the monitoring procedure has to be started for the corresponding AF.
In case AF de-provisions information about the AF signalling flows between the
UE and the AF, as defined in 3GPP TS 29.214 [18] subclause 4.4.5a, the PCF
shall remove the corresponding dynamic PCC rules by triggering an HTTP POST
message. The PCF shall apply the procedure as defined in subclause 4.2.6.2.1.
The SMF shall send a HTTP response message to the PCF.
NOTE 2: The SMF can use the AF address associated with the removed rule to
check if it can stop monitoring the corresponding AF.
#### 4.2.3.18 P-CSCF Restoration Enhancement Support
This subclause is applicable when the PCF-based P-CSCF Restoration
Enhancement, as defined in 3GPP TS 23.380 [21], is supported by both PCF and
SMF.
If the PCF receives a request for P-CSCF restoration from the P-CSCF as
defined in subclause 4.4.7 of 3GPP TS 29.214 [18], the PCF shall send an HTTP
POST message including the \"pcscfRestIndication\" attribute set to true to
the SMF for the corresponding PDU session.
The SMF shall acknowledge to the PCF and shall initiate the corresponding QoS
flow procedure for the IMS PDU connection as defined in 3GPP TS 23.380 [21].
#### 4.2.3.19 Request of Presence Reporting Area Change Report
If the PRA feature as defined in subclause 5.8 is supported, the PCF may
provision the Presence Reporting Area Information to the SMF as defined in
subclause 4.2.6.5.6.
#### 4.2.3.20 Session Rule Error Report
If the \"SessionRuleErrorHandling\" feature is supported and if the SMF
receives one or more session rules as defined in subclause 4.2.6.3.1 but the
validation of all the session Rule was unsuccessful, the SMF shall reject the
request and include an HTTP \"400 Bad Request\" status code and the
\"sessRuleReports\" attribute for the affected session rules to report the
failure within the ErrorReport data structure; otherwise if the validation of
some of session rules was unsuccessful, the SMF shall include an HTTP \"200
OK\" status code and one or more SessionRuleReport data structure(s) for the
affected session rules to report the failure within the PartialSuccessReport
data structure in the response message. Within each SessionRuleReport
instance, the SMF shall identify the failed session rule(s) by including the
affected session rules within the \"ruleIds\" attribute(s), identify the
failed reason code by including a \"sessRuleFailureCode\" attribute, and shall
include rule status within the \"ruleStatus\" attribute with the value as
described below.
If the installation of one or more new session rules (i.e. rules which were
not previously successfully installed) fails, the SMF shall set the
\"ruleStatus\" to INACTIVE.
If the modification of a currently provisioned session rule fails, the SMF
shall retain the existing session rule as provisioned without any modification
unless the reason for the failure has an impact also on the existing session
rule. The SMF shall report the modification failure to the PCF.
The removal of a session rule shall not fail, even if the PDU session
procedures with the UE fail. The SMF shall retain information on the removal
and conduct the necessary PDU session procedures with the UE when it is
possible.
Depending on the value of the \"sessRuleFailureCode\" attribute, the PCF may
decide whether retaining of the old session rule, re-installation,
modification, removal of the session rule or any other action applies.
### 4.2.4 Npcf_SMPolicyControl_Update Service Operation
#### 4.2.4.1 General
The Npcf_SMPolicyControl_Update service operation provides means for the NF
service consumer to inform the PCF that a policy control request trigger
condition has been met and for the PCF to inform the NF service consumer of
any resulting update of the Session Management related policies.
The following procedures using the Npcf_SMPolicyControl_Update service
operation are supported:
\- Provisioning of PCC rules.
\- Provisioning of policy control request triggers.
\- Request the policy based on revalidation time.
\- Policy provisioning and enforcement of authorized AMBR per PDU session.
\- Policy provisioning and enforcement of authorized default QoS.
\- Application detection information reporting.
\- Indication of QoS Flow Termination Implications.
\- 3GPP PS Data Off Support.
\- Request and report Access Network Information.
\- Request Usage Monitoring Control and report Accumulated Usage.
\- Ipv6 Multi-homing support.
\- Request and report the result of PCC rule removal.
\- Access Network Charging Identifier Request and report.
\- Request and report the successful resource allocation notification.
\- Negotiation of the QoS flow for IMS signalling.
\- Notification about Service Data Flow QoS target enforcement.
#### 4.2.4.2 Requesting the update of the Session Management related policies
Figure 4.2.4.2-1: Requesting the update of the Session Management related
policies
When the SMF detects that one or more policy control request triggers are met,
the SMF shall send a POST request to the PCF to update an Individual SM Policy
resource. The {smPolicyId} in the URI identifies the Individual SM Policy
resource to be updated. The SMF include SmPolicyUpdateContextData data
structure in the payload body of the HTTP POST to request a update of
representation of the \"Individual SM Policy\" resource. The SMF shall include
the met policy control request trigger(s) within the
\"repPolicyCtrlReqTriggers\" attribute and applicable updated value(s) in the
corresponding attribute(s).
The SMF shall include (if the corresponding policy control request trigger is
met and the applicable information is available) in SmPolicyUpdateContextData
data structure:
\- type of access within the \"accessType\" attribute;
\- type of the radio access technology within the \"ratType\" attribute;
\- the new allocated UE Ipv4 address within the \"ipv4Address\" attribute
and/or the UE Ipv6 prefix within the \"ipv6AddressPrefix\" attribute;
\- the released UE Ipv4 address within the \"relIpv4Address\" attribute and/or
the UE Ipv6 prefix within the \"relIpv6AddressPrefix\" attribute;
\- the UE MAC address within the \"ueMac\" attribute;
\- the released UE MAC address within the \"relUeMac\" attribute;
\- the indication of UE supporting reflective QoS within the
\"refQosIndication\" attribute;
\- access network charging identifier within the \"accNetChIds\" attribute;
\- 3GPP PS data off status within the \"3gppPsDataOffStatus\" attribute;
\- the UE time zone information within the \"ueTimeZone\" attribute;
\- subscribed Session-AMBR within the \"subsSessAmbr\" attribute;
\- subscribed Default QoS Information within the \"subsDefQos\" attribute;
\- detected application information within the \"appDetectionInfos\"
attribute;
\- accumulated usage reports within the \"accuUsageReports\" attribute;
\- if the \"PRA\" feature is supported, the reported presence reporting area
information within the \"repPraInfos\" attribute;
\- the QoS flow usage required of the default QoS flow within the
\"qosFlowUsage\" attribute;
\- indication whether the QoS targets of one or more SDFs are not guaranteed
or guaranteed again within the \"qncReports\" attribute;
\- user location information within the \"userLocationInfo\" attribute;
\- serving network function identifier within the \"servNfId\" attribute; and
\- identifier of the serving network within the \"servingNetwork\" attribute.
The SMF may include in \"SmPolicyUpdateContextData\" data structure the IPv4
address domain identity within the \"ipDomain\" attribute.
In case of a successful update, \"200 OK\" response shall be returned. The PCF
shall include in the \"200 OK\" response the representation of the updated
policies within the SmPolicyDecision data structure. Detailed procedures
related to the provisioning and enforcement of the policy decisions within the
SmPolicyDecision data structure are contained in subclause 4.2.6.
NOTE: An empty SmPolicyDecision data structure is included in the \"200 OK\"
response when the PCF decides not to update policies.
If errors occur when processing the HTTP POST request, the PCF shall apply
error handling procedures as specified in subclause 5.7.
If the PCF is, due to incomplete, erroneous or missing information (e.g. QoS,
RAT type, subscriber information) not able to provision a policy decision as
response to the request for PCC rules by the SMF, the PCF may reject the
request and include in an HTTP \"400 Bad Request \" response message the
\"cause\" attribute of the ProblemDetails data structure set to
\"ERROR_INITIAL_PARAMETERS\".
If the PCF receives the set of session information which is sent in the
message originated due to a trigger being met is incoherent with the previous
set of session information for the same session (E.g. trigger met was RAT
changed, and the RAT notified is the same as before), the PCF may reject the
request and include in an HTTP \"400 Bad Request\" response message the
\"cause\" attribute of the ProblemDetails data structure set to
\"ERROR_TRIGGER_EVENT\".
If the PCF detects that the packet filters in the request for new PCC rules
received from the SMF is covered by the packet filters of outstanding PCC
rules that the PCF is provisioning to the SMF, the PCF may reject the request
and include in an HTTP \"403 Forbidden\" response message the \"cause\"
attribute of the ProblemDetails data structure set to
\"ERROR_CONFLICTING_REQUEST\".
If the PCF does not accept one or more of the traffic mapping filters provided
by the SMF in an HTTP POST request (e.g. because the PCF does not allow the UE
to request enhanced QoS for services not known to the PCF), the PCF shall
reject the request and include in an HTTP \"403 Forbidden\" response message
the \"cause\" attribute of the ProblemDetails data structure set to
\"ERROR_TRAFFIC_MAPPING_INFO_REJECTED\".
If the SMF receives HTTP response with these codes, the SMF shall reject the
PDU session modification that initiated the HTTP Request.
The PCF shall not combine a rejection with provisioning of PCC rule operations
in the same HTTP response message.
#### 4.2.4.3 Request the policy based on revalidation time
If the timer for the policy revalidation is started, the SMF shall send the
PCC rule request before the indicated revalidation time. The SMF shall within
the SmPolicyUpdateContextData data structure include RE_TIMEOUT within the
\"repPolicyCtrlReqTriggers\" attribute. The SMF shall stop the timer once the
SMF sends the HTTP POST request.
NOTE 1: The PCF is expected to be prepared to provide a new policy, as desired
for the revalidation time, during a preconfigured period before the
revalidation time. The preconfigured periods in the SMF and PCF need to be
aligned.
The PCF may instruct the SMF to revalidate the provided PCC rules by including
the \"revalidationTime\" attribute within the SmPolicyDecision in the HTTP
POST response.
NOTE 1: If the PCF omits the \"revalidationTime\" attribute the revalidation
function remains enabled, but the timer remains stopped till the PCF provides
a revalidation time within the \"revalidationTime\" attribute.
When the SMF receives the HTTP POST response message, the SMF shall start the
timer for revalidation based on the received value of revalidation time if the
revalidation function is not disabled; otherwise, the SMF shall not start the
timer for revalidation.
The PCF may disable the revalidation function by removing the RE_TIMEOUT
policy control request trigger in the HTTP POST response message. If the
revalidation function is disabled, the SMF shall ignore any received value of
revalidation time and shall not start the timer for revalidation.
NOTE 2: By disabling the revalidation function the revalidation time value
previously provided to the SMF is not applicable anymore.
#### 4.2.4.4 Policy provisioning and enforcement of authorized AMBR per PDU
session
When the SMF detects that the subscribed session AMBR change, the SMF shall
notify of the PCF by invoking the procedure as defined in subclause 4.2.4.2,
include the new subscribed session AMBR within the \"subsSessAmbr\" attribute
and the SE_AMBR_CH policy control request trigger within the
\"repPolicyCtrlReqTriggers\". Upon receiving the change of session AMBR, the
PCF shall provision the new authorized session AMBR to the SMF in the response
as defined in subclauses 4.2.6.2.1 and 4.2.6.2.2.
Upon receiving the authorized session AMBR, the SMF shall apply the
corresponding procedures towards the access network, the UE and the UPF for
the enforcement of the AMBR per PDU session.
For UL Classifier or Multi-homing PDU Session, the SMF will provision the
policies of session-AMBR for downlink and uplink direction to the UL
Classifier/Branching Point functionality and in addition provision the
policies of session-AMBR in the downlink direction to all the PDU session
anchors as defined in subclause 5.4.4 of 3GPP TS 29.244 [13].
#### 4.2.4.5 Policy provisioning and enforcement of authorized default QoS
When the SMF detects that the subscribed default QoS change, the SMF shall
notify of the PCF by invoking the procedure as defined in subclause 4.2.4.2,
include the new subscribed default QoS within the \"subsDefQos\" attribute and
\"repPolicyCtrlReqTriggers\" set to DEF_QOS_CH. Upon receiving the change of
default QoS, the PCF shall provision the authorized default QoS to the SMF in
the response of the message The PCF shall provision the authorized default QoS
to the SMF in the response of the message as defined in subclauses 4.2.6.3.1
and 4.2.6.3.2.
Upon receiving the authorized default QoS, the SMF enforces it which may lead
to the change of the subscribed default QoS. The SMF shall apply the
corresponding procedures towards the access network, the UE and the UPF for
the enforcement of the authorized default QoS.
#### 4.2.4.6 Application detection information reporting
If the ADC feature is supported and if the SMF receives the PCC rule for
application detection and control, the SMF shall instruct the UPF as defined
in 3GPP TS 29.244 [13] to
\- Detect the application traffic
\- Report the detected application's traffic start/stop events along with the
application instance identifier and service data flow descriptions when
service data flow descriptions are deducible.
When the start of the application`s traffic, identified by an application
identifier, is received from the UPF, if the PCF has previously provisioned
the APP_STA/APP_STO policy control request triggers, unless a request to mute
such a notification (i.e. the \"muteNotif\" attribute set to true within the
Traffic Control Data decision which the PCC rule refers to), the SMF shall
report the start of the application to the PCF.
In order to do so, the SMF shall perform the procedure as defined in subclause
4.2.4.2 by including the information regarding the detected application`s
traffic within the \"appDetectionInfos\" attribute and the \"APP_STA\" within
the \"repPolicyCtrlReqTriggers\" attribute even if the application traffic is
discarded due to enforcement actions of the PCC rule. In this case, within the
each AppDetectionInfo instance, the SMF shall include the corresponding
application identifier within the \"appId\" attribute, and may include the
detected service data flow description within the \"sdfDescriptions\"
attribute if deducible and a dynamically allocated application instance
identifier for the detected service data flow descriptions within the
\"instanceId\". The \"sdfDescriptions\" attribute, if present, shall contain
the \"flowDescription\" attribute and \"flowDirection\" attribute. The
application instance identifier allows the correlation of APP_STA and APP_STO
policy control request trigger to the specific service data flow descriptions.
When the stop of the application\'s traffic, identified by an application
identifier is received from the UPF and the SMF has reported the start of the
application to the PCF, the SMF shall report the stop of the application to
the PCF. In order to do so, the SMF shall perform the procedure as defined in
subclause 4.2.4.2 by including the information regarding the detected
application`s traffic within the \"appDetectionInfos\" attribute and the
\"APP_STO\" within the \"repPolicyCtrlReqTriggers\" attribute. For each
AppDetectionInfo instance, the SMF shall include the corresponding application
identifier within the \"appId\" attribute and the application instance
identifier within the \"instanceId\" if it is provided along with the APP_STA.
The PCF then may make policy decisions based on the information received and
send the corresponding updated PCC rules to the SMF.
When a PFD provisioned by the PFDF as specified in 3GPP TS 29.551 [40] is
removed/modified and the removed/modified PFD was used to detect application
traffic related to an application identifier in a PCC rule installed or
activated for a PDU session, if the removed/modified PFD results in that the
stop of an application or an application instance is not able to be detected,
and if the SMF has reported the application start as described in this
subclause to the PCF for the application or application instance represented
by this PFD, the SMF shall report the application stop to the PCF for the
corresponding application or the corresponding application instance, if the
stop of the application's traffic, identified by the corresponding application
or the corresponding application instance, is received from the UPF.
NOTE: Multiple PFDs can be associated with the application identifier. When
the removed/modified PFD is the last one which is used to detect traffic
identified by the \"appId\" attribute, the SMF reports application stop.
#### 4.2.4.7 Indication of QoS Flow Termination Implications
When the SMF detects that a dedicated QoS flow could not be activated or has
been terminated it shall remove the affected PCC rules and send an HTTP POST
request to the PCF with an SmPolicyUpdateContextData data structure, including
the \"ruleReports\" attribute containing the RuleReport data instance which
specifies the affected PCC rules within the \"pccRuleIds\" attribute(s),
\"INACTIVE\" as the value within the \"ruleStatus\" attribute and the
\"RES_ALLO_FAIL\" as the value of the \"failureCode\" attribute.
If the RAN-NAS-Cause feature is supported, the SMF shall provide the available
access network information within the \"userLocationInfo\" attribute (if
available), \"userLocationInfoTime\" attribute (if available) and
\"ueTimezone\" attribute (if available). Additionally, if the SMF receives
from the access network the RAN cause and/or the NAS cause due to QoS flow
termination the SMF shall provide the received cause(s) in the
\"ranNasRelCauses\" attribute included in RuleReport data instance.
If the NetLoc feature is supported, and the identifier of the affected PCC
rule was included within the \"refPccRuleIds\" attribute of the
RequestedRuleData data structure when the affected PCC rule was installed or
modified, the SMF shall provide the access network information to the PCF by
including the user location information within the \"userLocationInfo\"
attribute (if requested by the PCF and if provided to the SMF), the
information on when the UE was last known to be in that location within
\"userLocationInfoTime\" attribute (if user location information was requested
by the PCF and if the corresponding information was provided to the SMF), the
PLMN identifier within the \"servingNetwork\" attribute (if the user location
information was requested by the PCF but it is not provided to the SMF) and
the timezone information within the \"ueTimeZone\" attribute (if requested by
the PCF and available).
NOTE 1: The SMF derives the value of the \"userLocationInfoTime\" attribute
from the age of location information received from the AMF at PDU session
update as described in 3GPP TS 29.502[22]. Whether the \"userLocationInfo\"
attribute also encodes the age of location is implementation specific.
This shall be done whenever one of these conditions applies:
\- The SMF is requested by the RAN to initiate the deactivation of a QoS flow,
\- PCC rule(s) are removed/deactivated by the SMF without PCF request (e.g.
due to unsuccessful reservation of resources to satisfy the QoS flow binding).
NOTE 2: The SMF will not initiate the deactivation of the QoS flow upon
reception of the UE-initiated resource modification procedure indicating
packet filter deletion. If all the PCC rules associated to a QoS flow have
been deleted as a consequence of the PCF interaction, the SMF will initiate
the QoS flow termination procedure towards the RAN.
Signalling flows for the QoS flow termination and details of the binding
mechanism are presented in 3GPP TS 29.513 [7].
#### 4.2.4.8 3GPP PS Data Off Support
If the SMF is informed that the 3GPP PS Data Off status of the UE changes, the
SMF shall provide the PS_DA_OFF value within the \"repPolicyCtrlReqTriggers\"
attribute and the \"3gppPsDataOffStatus\" attribute set to the value indicated
by the UE within \"SmPolicyUpdateContextData\" and send the HTTP POST message
as defined in subclause 4.2.4.2 to the PCF.
Upon receipt of an HTTP POST message with the \"repPolicyCtrlReqTriggers\"
attribute with the value PS_DA_OFF or the AC_TY_CH the PCF shall determine
whether the 3GPP PS Data Off handling functionality (as described below)
becomes active or inactive. The 3GPP PS Data Off handling functionality is
active if, and only if,
\- the latest received \"3gppPsDataOffStatus\" attribute is set to true, and
NOTE 1: If the PS_DA_OFF policy control request trigger is received, the
latest received value is the one received in the HTTP POST message. Otherwise,
it corresponds to the stored value.
\- the UE uses an access with \"accessType\" attribute set to \"3GPP_ACCESS\".
If the PCF determines that the 3GPP PS Data Off handling functionality becomes
active, the PCF shall configure the SMF in such a way that:
\- only packets for services belonging to the list of 3GPP PS Data Off Exempt
Services are forwarded; and
\- all other downlink packets and optionally uplink packets are discarded by
modifying or removing any related dynamic PCC rule(s) or by deactivating any
related predefined PCC rule(s).
NOTE 2: In order for the UPF to prevent the services that do not belong to the
list of 3GPP PS Data Off Exempted Services, if such services are controlled by
dynamic PCC rules, PCF can either close gates for the downlink and optionally
the uplink direction via the \"flowStatus\" attribute in related dynamic PCC
rules or remove those dynamic PCC rules. If the services are controlled by
predefined PCC rules, PCF needs to deactivate those PCC rules. PCC rule(s)
with wild-carded service data flow filters can be among the PCC rules that are
modified, removed or disabled in that manner. It can then be necessary that
the PCF at the same time installs or activates PCC rules for data-off exempt
services. The network configuration can ensure that at least one PCC rule is
bound to the default QoS flow when Data Off is activated in order to avoid a
deletion of an existing PDU session or in order to not fail a PDU session
establishment.
If the PCF determines that the 3GPP PS Data Off handling functionality becomes
inactive, the PCF shall perform policy control decision and perform PCC rule
operations to make sure that services are allowed according to the user's
subscription and operator policy (irrespective of whether they belong to the
list of 3GPP PS Data Off Exempt Services).
NOTE 3: The PCF can then open gates via the \"flowStatus\" attribute for
active PCC rules associated to services not within the list 3GPP PS Data Off
Exempt Services. The PCF can also install PCC rules or activate predefined PCC
rules for some services not belonging to the list 3GPP PS Data Off Exempt
Services. If the PCF activates or installs a PCC rule with wildcarded filters,
it can remove or de-activate PCC rules for 3GPP PS Data Off Exempt Services
that are made redundant by this PCC rule.
#### 4.2.4.9 Request and Report of Access Network Information
If the NetLoc as defined in subclause 5.8 is supported, the PCF may request
the SMF to report the access network information as defined in subclause
4.2.6.5.4.
If the AN_INFO policy control request trigger is set, upon receiving the
\"lastReqRuleData\" attribute with the \"reqData\" attribute with the value(s)
MS_TIME_ZONE and/or USER_LOC_INFO and the \"refPccRuleIds\" attribute
containing the PCC rule identifier(s) corresponding to the PCC rule(s) which
is being installed, modified or removed together, the SMF shall apply the
Namf_EventExposure service with One-Time Report type as defined in subclause
5.3.1 of 3GPP TS 29.518 [36] if the related information is not available to
obtain this information. When the SMF then receives access network information
from the AMF, the SMF shall provide the required access network information to
the PCF by as defined in subclause 4.2.4.2 and set the corresponding
attributes as follows:
\- If the user location information was requested by the PCF and was provided
to the SMF, the SMF shall provide the user location information within the
\"userLocationInfo\" attribute and the time when it was last known within
\"userLocationInfoTime\" attribute (if available).
NOTE: The SMF derives the value of the \"userLocationInfoTime\" attribute from
the age of location information received in the Location-Report (defined in
subclause 5.3.1 of 3GPP TS 29.518 [36]) from the AMF. Whether the
\"userLocationInfo\" attribute also encodes the age of location is
implementation specific.
\- If the user location information was requested by the PCF and was not
provided to the SMF, the SMF shall provide the serving PLMN identifier within
the \"servingNetwork\" attribute.
\- If the time zone was requested by the PCF, the SMF shall provide it within
the \"ueTimeZone\" attribute.
In addition, the SMF shall provide the AN_INFO policy control request trigger
within the \"repPolicyCtrlReqTriggers\" attribute.
The SMF shall not report any subsequent access network information updates
received from the RAN without any further provisioning or removal of related
PCC rules requesting the access network information unless the associated QoS
flow or PDU session has been released.
#### 4.2.4.10 Request Usage Monitoring Control and Reporting Accumulated Usage
If the UMC as defined in subclause 5.8 is supported, the PCF may provision the
usage monitoring control policy to the SMF as defined in subclause 4.2.6.5.3
to request the usage monitoring control.
The UPF measures the volume and/or the time of usage of all traffic for the
PDU session or the corresponding service data flows. When the SMF receives the
accumulated usage report from the UPF as defined in subclauses 7.5.5.2,
7.5.7.2 or 7.5.8.3 of 3GPP TS 29.244 [13], the SMF shall send an HTTP POST
message as defined in subclause 4.2.4.2 by including one or more accumulate
usage reports within the \"accuUsageReports\" attribute(s) and the \"US_RE\"
value within the \"repPolicyCtrlReqTriggers\" attribute. Each AccuUsageReport
data structure shall contain the accumulated usage within one or two Usage
Report information element(s) corresponding to one usage monitoring control
instance as requested by the PCF.
If the monitoring time is provided by the PCF for a usage monitoring control
instance and:
\- if the SMF receives only one Usage Report information elements
corresponding to the usage monitoring control instance from the UPF, within
the AccuUsageReport data structure, the SMF shall include the accumulated
usage before the monitoring time within the \"timeUsage\" attribute,
\"volUsage\" attribute, \"volUsageUplink\" attribute and/or
\"volUsageDownlink\" attribute if applicable; otherwise,
\- if the SMF receives two Usage Report information elements corresponding to
the usage monitoring control instance from the UPF, within the AccuUsageReport
data structure, the SMF include the accumulated usage before the monitoring
time within the \"timeUsage\" attribute, \"volUsage\" attribute,
\"volUsageUplink\" attribute and/or \"volUsageDownlink\" attribute if
applicable and the accumulated usage after the monitoring time within the
\"nextTimeUsage\" attribute, \"nextVolUsage\" attribute,
\"nextVolUsageUplink\" attribute and/or \"nextVolUsageDownlink\" attribute if
applicable.
When the PCF receives the accumulated usage in the HTTP POST message, the PCF
shall indicate to the SMF if usage monitoring shall continue for usage
monitoring control instance as follows:
\- if the PCF wishes to continue monitoring for the usage monitoring control
instance and:
\- if monitoring shall continue for specific level(s), the PCF shall provide
the new thresholds for the level(s) in the response of HTTP POST message using
the same attribute as before (i.e. \"volumeThreshold\" attribute,
\"volumeThresholdUplink\" attribute, \"volumeThresholdDownlink\" attribute
and/or \"timeThreshold\" attribute; \"nextVolThreshold\" attribute,
\"nextVolThresholdUplink\" attribute, \"nextVolThresholdDownlink\", and/or
\"nextTimeThreshold\" attribute if the \"monitoringTime\" attribute is
provided within an entry of the \"umDecs\" attribute); or
\- if the PCF wishes to stop monitoring for specific level(s) the PCF shall
not include an updated threshold in the response of HTTP POST message for the
stopped level(s) i.e. the corresponding \"volumeThreshold\" attribute,
\"volumeThresholdUplink\" attribute, \"volumeThresholdDownlink\" attribute,
\"timeThreshold\" attribute, \"nextVolThreshold\" attribute,
\"nextVolThresholdUplink\" attribute, \"nextVolThresholdDownlink\" attribute,
and/or \"nextTimeThreshold\" attribute shall not be included within an entry
of the \"umDecs\" attribute;
\- otherwise, if the PCF wishes to stop monitoring for the usage monitoring
control instance, the PCF shall not include any thresholds of the usage
monitoring control instance in the response of HTTP POST message or remove the
reference of the usage monitoring control instance from dynamic the PCC rule
or session rule.
If both volume and time thresholds were provided and the threshold for one of
the measurements is reached, the SMF shall report this event to the PCF and
the accumulated usage since last report shall be reported for both
measurements.
The PCF shall process the usage reports and shall perform the actions as
appropriate for each report.
#### 4.2.4.11 Ipv6 Multi-homing support
The SMF may insert an additional PDU Session Anchor to an existing PDU session
by using Ipv6 multi-homing mechanism. In this case, the SMF shall inform the
PCF when a new Ipv6 prefix is allocated to the new PDU Session Anchor as
defined in subclause 4.2.4.2. The SMF shall, within the
SmPolicyUpdateContextData data structure, include the \"UE_IP_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and include the new Ipv6 prefix within
the \"ipv6AddressPrefix\" attribute.
When the PCF receives the request from the SMF indicating the addition of a
new Ipv6 prefix, the PCF shall determine the impacted PCC rules and/or session
rules associated with the new Ipv6 prefix and provision them to the SMF as
defined in subclauses 5.6.2.6 and 5.6.2.7. The SMF shall derive the
appropriate policies based on the policies provisioned by the PCF and
provision them to the appropriate UPF, if applicable, access network, if
applicable, and UE, if applicable. The PCF shall additionally consider the new
Ipv6 prefix during subsequent PCC rules and/or session rules updates.
When the SMF removes a PDU Session anchor from the Multi-homing PDU session,
the SMF shall inform the PCF of the released Ipv6 prefix related to the PDU
Session anchor as defined in subclause 4.2.5.2. The SMF shall, within the
SmPolicyUpdateContextData data structure, include the \"UE_IP_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and include the released Ipv6 prefix
within the \"relIpv6AddressPrefix\" attribute.
When the PCF receives the request from the SMF indicating the release of an
existing Ipv6 prefix, the PCF shall determine the previously provisioned PCC
rules and/or session rules associated with the released Ipv6 prefix and shall
remove and/or update them from the SMF as applicable. The PCF shall remove the
released Ipv6 prefix.
#### 4.2.4.12 Request and report for the result of PCC rule removal
If the RAN-NAS-Cause feature is supported, the PCF may request the SMF to
inform it of the result of the PCC rule removal when the PCF removes the PCC
rule as defined in subclause 4.2.6.5.2.
When the SMF receives the request, the SMF shall maintain locally the removed
PCC rules until it receives of the resource release outcome from the network.
The SMF shall notify the PCF by include the \"RES_RELEASE\" within the
\"repPolicyCtrlReqTriggers\" attribute and the affected rules indicated within
one instance of the \"ruleReports\" attribute with the \"ruleStatus\"
attribute set to the value INACTIVE.
If the QoS flow is terminated as a consequence of the removal of one or more
PCC rules, the SMF shall inform the PCF about the completion of the QoS flow
procedure related to the removal of PCC rules that indicated resource release
notification by including the RequestedRuleData instance containing the
\"reqData\" attribute with the RES_RELEASE referring to the PCC rule. If the
SMF received from the access network some RAN/NAS release cause(s), the SMF
shall also provide the received cause(s) in the \"ruleReports\" attribute. The
SMF shall also provide the available access network information within the
\"userLocationInfo\" attribute (if available), \"userLocationInfoTime\"
attribute (if available) and \"ueTimezone\" attribute (if available).
#### 4.2.4.13 Access Network Charging Identifier request and report
If the \"policyCtrlReqTriggers\" attribute with the value \"AN_CH_COR\" has
been provided to the SMF, the SMF shall notify of the PCF the Access Network
Charging Identifier(s) that the SMF has assigned for the dynamic PCC Rules
which referred from the RequestedRuleData data structure containing the CH_ID
within the \"reqData\" attribute by including an \"accNetChIds\" attribute
within the SmPolicyUpdateContextData data structure in the HTTP POST message.
If the SMF assigns a Access Network Charging Identifier to the whole PDU
session, the SMF shall include one AccNetChId instance within the
\"accNetChIds\" attribute and include the Access Network Charging Identifier
within the \"accNetChaIdValue\" attribute and the \"sessionChScope\" attribute
set to true; otherwise, within each AccNetChId instance, the PCF shall include
Access Network Charging Identifier within the \"accNetChaIdValue\" attribute
and all the PCC rule identifier(s) associated to the provided Access Network
Charging Identifier within the \"refPccRuleIds\" attribute.
The PCF may request the SMF to provide the Access Network Charging Identifier
associated to the new dynamic PCC rules as defined in subclause 4.2.6.5.1 in
the response message.
#### 4.2.4.14 Request and report for the successful resource allocation
notification
The PCF may request the SMF to confirm that the resources associated to a PCC
rule are successfully allocated as defined in subclause 4.2.6.5.5.
If the \"policyCtrlReqTriggers\" attribute with the value \"SUCC_RES_ALLO\"
has been provided to the SMF, the SMF shall notify of the PCF the resources
associated to the PCC rules which referred from the RequestedRuleData data
structure containing the \"SUCC_RES_ALLO\" within the \"reqData\" attribute
are successfully allocated. When the SMF received successful resource
allocation response from the access network, the SMF shall within the
SmPolicyUpdateContextData data structure include the \"SUCC_RES_ALLO\" within
the \"repPolicyCtrlReqTriggers\" attribute and \"ruleReports\" attribute.
Within the RuleReport instance, the SMF shall include the corresponding PCC
rule identifier(s) within the \"pccRuleIds\" attribute and the \"ruleStatus\"
attribute set to value \"ACTIVE\".
If the \"RuleVersioning\" feature is supported and the PCF included the
\"contVer\" attribute for a specific PCC rule instance, and the resource
allocation was successful for this PCC rule, the SMF shall include the rule
content version within the \"contVers\" attribute in the corresponding
RuleReport instance.
#### 4.2.4.15 PCC Rule Error Report
If the installation/activation of one or more PCC rules fails using the
procedure as defined in subclause 4.2.2.1 or 4.2.4.1 or the PCF installed,
activated or modified one or more PCC rules as defined in subclause 4.2.3.1
but resource allocation for the PCC Rule was unsuccessful, the SMF shall
include the \"ruleReports\" attribute for the affected PCC rules to report the
failure within the SmPolicyUpdateContextData data structure. Within each
RuleReport instance, the SMF shall identify the failed PCC rule(s) by
including the affected PCC rules within the \"pccRuleIds\" attribute(s),
identify the failed reason code by including a \"failureCode\" attribute, and
shall include rule status within the \"ruleStatus\" attribute with the value
as described below.
If the installation/activation of one or more new PCC rules (i.e., rules which
were not previously successfully installed) fails, the SMF shall set the
\"ruleStatus\" to INACTIVE.
The removal of a PCC rule shall not fail, even if the PDU session procedures
with the UE fail. The SMF shall retain information on the removal and conduct
the necessary PDU session procedures with the UE when it is possible.
If the modification of a currently active PCC rule, the SMF shall retain the
existing PCC rule as active without any modification unless the reason for the
failure has an impact also on the existing PCC rule. The SMF shall report the
modification failure to the PCF.
If a PCC rule was successfully installed/activated, but can no longer be
enforced by the SMF, the SMF shall set the \"ruleStatus\" attribute to
INACTIVE.
NOTE: When the PCF receives \"ruleStatus\" set to INACTIVE, the PCF does not
need request the SMF to remove the inactive PCC rule.
Depending on the value of the \"failureCode\" attribute, the PCF may decide
whether retaining of the old PCC rule, re-installation, modification, removal
of the PCC rule or any other action applies.
If the RAN-NAS-Cause feature is supported and as part of any of the procedures
described in this subclause the SMF receives from the access network some
RAN/NAS release cause(s), the SMF shall also provide the received cause(s) in
the RuleReport instance. If RAN-NAS-Cause feature is supported the SMF shall
provide the available access network information within the
\"userLocationInfo\" attribute (if available), \"userLocationInfoTime\"
attribute (if available) and \"ueTimezone\" attribute (if available).
If the \"RuleVersioning\" feature is supported and the PCF included the
\"contVer\" attribute for a specific PCC rule instance, and the resource
allocation was unsuccessful as for any of the procedures described in this
subclause the SMF shall include the rule content version within the
\"contVers\" attribute for the corresponding RuleReport instance.
#### 4.2.4.16 Presence Reporting Area Information Report
If the PRA feature as defined in subclause 5.8 is support and when the SMF
receives the presence reporting area information from the serving node as
defined in 3GPP TS 29.518 [36] indicating that the UE is inside or outside of
one or more presence reporting areas or any of the presence reporting areas is
set to inactive, the SMF shall check if the reported presence reported area
identifier corresponds to a presence reporting area that is relevant for the
PCF. In that case, the SMF shall within the SmPolicyUpdateContextData data
structure include the \"PRA_CH\" within the \"repPolicyCtrlReqTriggers\"
attribute and one or more Presence Reporting Area Information Report within
the \"repPraInfos\" attribute. For each PresenceInfo data structure, the SMF
shall also include the presence reporting area status within the
\"presenceState\" attribute and the presence reporting area identifier within
the \"praId\" attribute for each of the presence reporting areas reported by
the serving node.
NOTE 1: The PCF can acquire the necessary data for presence reporting from the
UDR.
NOTE 2: Homogeneous support of Presence Area reporting in a network is
assumed.
NOTE 3: The serving node can activate the reporting for the PRAs which are
inactive as described in the 3GPP TS 23.501 [2].
#### 4.2.4.17 UE initiates a resource modification support
In the case that the UE initiates a resource modification procedure as defined
in subclause 6.4.2.2 of 3GPP 3GPP TS 24.501 [20], the SMF shall within the
SmPolicyUpdateContextData data structure include the \"RES_MO_RE\" within the
\"repPolicyCtrlReqTriggers\" attribute and shall include the UE request of
specific QoS handling for selected SDF within the \"ueInitResReq\" attribute.
Within the UeInitiatedResourceRequest data structure, the SMF shall include
the \"ruleOp\" attribute, \"packFiltInfo\" attribute and \"reqQos\" attribute
if applicable as follows:
\- When the UE requests to \"Create new QoS rule\", the SMF shall include the
\"ruleOp\" attribute set to \"CREATE_PCC_RULE \", the \"packFiltInfo\"
attribute and \"reqQos\" attribute containing the requested QoS for the new
PCC rule. Each PacketFilterInfo instance shall contain one packet filters
requested for creating the new QoS rule. If the PCF authorizes the request,
the PCF shall create a new PCC rule by including the new packet filters within
the service data flow template of the PCC rule. When the SMF received the PCC
rule, the SMF shall derive the QoS rule based on the PCC rule, assign a new
QoS rule identifier within the PDU session for the QoS rule. The SMF shall
keep the mapping between the PCC rule identifier and the QoS rule identifier.
\- When the UE requests to \"Modify existing QoS rule and add packet
filters\", SMF shall include the \"ruleOp\" attribute set to
\"MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS\", the \"pccRuleId\" attribute
including the PCC rule identifier corresponding the QoS rule identifier and
the \"packFiltInfo\" attribute. Each PacketFilterInfo instance shall contain
one packet filters requested for addition to this QoS Rule. If the UE request
includes the modified QoS information the SMF shall also include the
\"reqQos\" attribute to indicate the updated QoS for the affected PCC rule(s).
If the PCF authorizes the request, the PCF shall update the PCC rule by adding
the new packet filters to the service data flow template of the PCC rule.
\- When the UE requests to \"Modify existing QoS rule and replace all packet
filters\", SMF shall include the \"ruleOp\" attribute set to \"MODIFY_
PCC_RULE_AND_REPLACE_PACKET_FILTERS\", the \"pccRuleId\" attribute including
the PCC rule identifier corresponding the QoS rule identifier and the
\"packFiltInfo\" attribute. Each PacketFilterInfo instance shall contain one
packet filters requested for addition to this QoS Rule. If the UE request
includes the modified QoS information the SMF shall also include the
\"reqQos\" attribute to indicate the updated QoS for the affected PCC rule. If
the PCF authorizes the request, the PCF shall update PCC rule by replacing the
all existing packet filters within the service data flow template of the PCC
rule with the new packet filter(s).
\- When the UE requests to \"Modify existing QoS rule and delete packet
filters\", SMF shall include the \"ruleOp\" attribute set to \"MODIFY_
PCC_RULE_AND_DELETE_PACKET_FILTERS\", the \"pccRuleId\" attribute including
the PCC rule identifier corresponding the QoS rule identifier and the
\"packFiltInfo\" attribute. Each PacketFilterInfo instance shall within the
\"packFiltId\" attribute include the removed packet filter identifier assigned
by the PCF corresponding to the packet filter identifier received from the UE.
If the UE request includes modified QoS information the SMF shall also include
the \"reqQos\" attribute to indicate the updated QoS for the affected PCC
rule(s). If the PCF authorizes the request, the PCF shall update PCC rule by
removing the corresponding packet filters from the service data flow template
of the PCC rule.
\- When the UE requests to \"Modify existing QoS rule without modifying packet
filters\", SMF shall include the \"ruleOp\" attribute set to
\"MODIFY_PCC_RULE_WITHOUT_MODIFY_PACKET_FILTERS\", the \"pccRuleId\" attribute
including the PCC rule identifier corresponding the QoS rule identifier, the
\"packFiltInfo\" attribute and the modified QoS information within the
\"reqQos\" attribute. The \"packFiltInfo\" attribute shall include one
PacketFilterInfo instance which includes any packet filter identifier assigned
by the PCF for the PCC rule within the \"packFiltId\" attribute.
\- When the UE requests to \"Delete existing QoS rule\" the SMF shall include
the \"ruleOp\" attribute set to \"DELETE_PCC_RULE\", the \"pccRuleId\"
attribute including the PCC rule identifier corresponding the QoS rule
identifier and the \"packFiltInfo\" attribute. The \"packFiltInfo\" attribute
shall include one PacketFilterInfo instance which includes any packet filter
identifier assigned by the PCF for the PCC rule within the \"packFiltId\"
attribute. The PCF shall remove the PCC rule when the PCF receives the request
according to the PCC rule identifier.
The SMF shall calculate the requested GBR, for a GBR 5QI, as the sum of the
previously authorized GBR for the affected PCC rule, corresponding to the QoS
rule, adjusted with the difference between the requested GBR for the QoS flow
and previously negotiated GBR for the QoS flow. For the UE request to create a
new QoS Rule, the GBR as requested by the UE for the QoS rule shall be used.
If the request covers all the PCC rules with a QoS flow binding to the same
QoS flow, then the SMF may request a change to the 5QI for existing PCC rules.
For the purpose of creating or modifying a QoS rule with adding, replacing and
modifying packet filter, within the UeInitiatedResourceRequest instance, the
SMF shall include the precedence information of the QoS rule within the
\"precedence\" attribute, and within each PacketFilterInfo instance, the SMF
shall include the \"packFiltCont\" attribute, \"tosTrafficClass\" attribute,
\"spi\" attribute, \"flowLabel\" attribute and \"flowDirection\" attribute set
to the value(s) describing the packet filter provided by the UE.
NOTE: The UE signalling with the network is governed by the applicable NAS
signalling TS. The NAS 3GPP TS for a specific access may restrict the UE
possibilities to make requests compared to what is stated above.
If the PCF authorizes the request from the UE, the PCF shall construct a PCC
rule(s) based on the UeInitiatedResourceRequest data structure. For the
request to add the filter(s), the PCF shall within the FlowInformation data
structure include the assigned packet filter identifier within the
\"packFiltId\" attribute. When the SMF derives the QoS based on the PCC rule,
the SMF shall assign a new packet filter identifier for each added packet
filter within the QoS rule and keep the mapping between the packet filter
identifier for the packet filter within the PCC rule and QoS rule.
The PCF shall perform the QoS authorization for the new created or modified
PCC rules if requested by the UE as defined in subclause 4.2.6.6.2.
If the PCF detects that the packet filters in the request for new PCC rules
received from the SMF is covered by the packet filters of outstanding PCC
rules that the PCF is provisioning to the SMF, the PCF may reject the request
and indicate the cause for the rejection including the \"cause\" attribute of
the ProblemDetails data structure set to \"ERROR_CONFLICTING_REQUEST\" in an
HTTP \"403 Forbidden\" response message. If the SMF receives a response
message with this code, the SMF shall reject the PDU session modification that
initiated the HTTP request.
If the PCF does not accept one or more of the traffic mapping filters provided
by the SMF in an HTTP Request (e.g. because the PCF does not allow the UE to
request enhanced QoS for services not known to the PCF), the PCF shall reject
the request and indicate the cause for the rejection including the \"cause\"
attribute of the ProblemDetails data structure set to
\"ERROR_TRAFFIC_MAPPING_INFO_REJECTED\" in an HTTP \"403 Forbidden\" response
message. If the SMF receives an HTTP response with this code, the SMF shall
reject the PDU session modification that initiated the HTTP request.
The PCF shall not combine a rejection with provisioning of PCC rule operations
in the same HTTP response.
#### 4.2.4.18 Trace Control
When there is the requirement to activate tracing the SMF may provide trace
control parameters to the PCF via the Npcf_SMPolicyControl_Update service
operation. The update service operation may also indicate the deactivation of
the trace session to the PCF.
#### 4.2.4.19 Negotiation of the QoS flow for IMS signalling
When UE initiates a resource modification request, if the SMF includes the
\"qosFlowUsage\" attribute containing \"IMS_SIG\" within
SmPolicyUpdateContextData data structure and the PCF accepts that a QoS flow
dedicated to IMS signalling shall be used, the PCF shall return the
\"qosFlowUsage\" containing \"IMS_SIG\" value within the SmPolicyDecision data
structure. The provided PCC rules shall have the 5QI applicable for IMS
signalling.
#### 4.2.4.20 Notification about Service Data Flow QoS target enforcement
When the SMF gets the knowledge that for one or more QoS Flows:
\- the GBR QoS targets cannot be guaranteed; or
\- the GBR QoS targets can be guaranteed again;
the SMF shall inform the PCF that the GBR QoS targets cannot be guaranteed or
can be guaranteed again for the PCC rules bound to the QoS flows.
The SMF gets the knowledge that the GBR QoS targets cannot be guaranteed or
can be guaranteed again for the QoS flow(s) as follows:
\- upon receiving a notification from the NG-RAN that the GFBR can no longer
be guaranteed or can be guaranteed again as defined subclause 5.2.2.3.1 of
3GPP TS 29.502 [22]; or
\- during a handover, a QoS Flow which is listed as transferred QoS Flow
received from the AMF as defined subclause 5.2.2.3.1 of 3GPP TS 29.502 [22]
can be interpreted as a notification that GFBR can be guaranteed again if the
SMF has received a notification from the source NG-RAN that the GFBR can no
longer be guaranteed but does not receive an explicit notification that the
GFBR can no longer be guaranteed for that QoS Flow from the Target NG-RAN
within a configured time as previous bullet.
The SMF shall send an HTTP POST request to the PCF with an
SmPolicyUpdateContextData data structure, including the \"QOS_NOTIF\" within
\"repPolicyCtrlReqTriggers\" attribute and the \"qncReports\" attribute. In
each QosNotificationControlInfo data structure, the SMF shall include the
indication that the GBR QoS targets cannot be guaranteed or the GBR QoS
targets can be guaranteed again within the \"notifType\" attribute and
affected PCC rule identifiers within the \"refPccRuleIds\" attribute.
If the affected PCC rule was provisioned with a content version, the SMF shall
include the \"contVers\" attribute defined in the QosNotificationControlInfo
data structure for those corresponding PCC rules. The SMF may include more
than one content version in the \"contVers\" attribute for the same PCC rule
within the corresponding QosNotificationControlInfo instance included in the
\"qncReports\" attribute (e.g. the SMF has combined multiple PCC rule versions
enforcement into one QoS flow operation).
When the PCF receives the HTTP POST request, it shall acknowledge the request
by sending a \"200 OK\" response to the SMF and then notify the AF as defined
in 3GPP TS 29.514 [17], subclause 4.2.5.4
#### 4.2.4.21 Session Rule Error Report
If the \"SessionRuleErrorHandling\" feature is supported and if the
installation of one or more session rules fails using the procedure as defined
in subclauses 4.2.2.1 or 4.2.4.1 or the PCF provisioned one or more session
rules as defined in subclause 4.2.3.1 but enforcement of the session Rule was
unsuccessful (e.g. session-AMBR is rejected by the AMF in the roaming
scenario), the SMF shall include the \"sessRuleReports\" attribute for the
affected session rules to report the failure within the
SmPolicyUpdateContextData data structure. Within each SessionRuleReport
instance, the SMF shall identify the failed session rule(s) by including the
affected session rules within the \"ruleIds\" attribute(s), identify the
failed reason code by including a \"sessRuleFailureCode\" attribute, and shall
include rule status within the \"ruleStatus\" attribute with the value as
described below.
If the installation of one or more new session rules fails, the SMF shall set
the \"ruleStatus\" to INACTIVE.
The removal of a session rule shall not fail, even if the PDU session
procedures with the UE fail. The SMF shall retain information on the removal
and conduct the necessary PDU session procedures with the UE when it is
possible.
If the modification of a currently provisioned session rule fails, the SMF
shall retain the existing session rule as provisioned without any modification
unless the reason for the failure has an impact also on the existing session
rule. The SMF shall report the modification failure to the PCF.
If a session rule was successfully installed, but can no longer be enforced by
the SMF, the SMF shall set the \"ruleStatus\" attribute to INACTIVE.
NOTE: When the PCF receives \"ruleStatus\" set to INACTIVE, the PCF does not
need request the SMF to remove the inactive session rule.
Depending on the value of the \"sessRuleFailureCode\" attribute, the PCF may
decide whether retaining of the old session rule, re-installation,
modification, removal of the session rule or any other action applies.
### 4.2.5 Npcf_SMPolicyControl_Delete Service Operation
#### 4.2.5.1 General
The delete service operation provides means for the NF service consumer to
delete the context of PDU Session related information.
The following procedures using the Npcf_SMPolicyControl_Delete service
operation are supported:
\- Deletion of the policy context associated with a PDU session.
\- Report Accumulated Usage.
\- Report Access Network Information.
#### 4.2.5.2 SM Policy Association termination
Figure 4.2.5.2-1: SM Policy Association termination
When an individual resource of the SM Policy Association shall be deleted the
SMF shall invoke the Npcf_SMPolicyContext_DELETE service operation to the PCF
using an HTTP POST request, as shown in figure 4.2.5.2-1, step 1.
The SMF shall set the request URI to \"{apiRoot}/npcf-smpolicycontrol/v1/sm-
policies/{smPolicyId}/delete\". The {smPolicyId} in the URI identifies the
\"Individual SM Policy\" to be deleted.
The SMF delete request shall (if available) contain SM Policy Association
related information within the SmPolicyDeleteData data structure in the body:
\- accumulated usage within the \"accuUsageReports\" attribute as defined in
subclause 4.2.5.3;
\- the user location information within the \"userLocationInfo\" attribute,
the information on when the UE was last known to be in that location within
the \"userLocationInfoTime\" attribute, the PLMN identifier within the
\"servingNetwork\" attribute, the timezone information within the
\"ueTimeZone\" attribute and RAN cause and/or the NAS cause within the
\"ranNasRelCauses\" attribute as defined in subclause 4.2.5.4.
NOTE: The SMF derives the value of the \"userLocationInfoTime\" attribute from
the age of location information received from the AMF at PDU session
termination as described in 3GPP TS 29.502[22]. Whether the
\"userLocationInfo\" attribute also encodes the age of location is
implementation specific.
When the PCF receives the HTTP POST request from the SMF, the PCF shall
acknowledge the request by sending an HTTP response message with the
corresponding status code. The PCF acknowledged the delete request by sending
a \"204 No Content\" response to the SMF, as shown in figure 4.2.5.2-1, step
2. Further, the PCF shall remove the individual resources linked to the delete
request.
#### 4.2.5.3 Report Accumulated Usage
If the UMC feature is supported, when the SMF receives the accumulated usage
report from the UPF as defined in subclause 7.5.7.2 of 3GPP TS 29.244 [13],
within the SmPolicyDeleteData data structure the SMF shall include one or more
accumulated usage reports within the \"accuUsageReports\" attribute.
If all PDU sessions of a user to the same DNN and S-NSSAI combination are
terminated, the PCF shall store the remaining allowed usage, i.e. the
information about the remaining overall amount of resources, in the UDR as
defined in 3GPP TS 29.519 [15].
#### 4.2.5.4 Report Access Network Information
If the RAN-NAS-Cause feature is supported or the NetLoc feature is supported,
within the SmPolicyDeleteData data structure the SMF shall provide the
available access network information within the \"userLocationInfo\" attribute
(if available), the information on when the UE was last known to be in that
location within \"userLocationInfoTime\" attribute (if available),
\"ueTimezone\" attribute (if available). Additionally, for NetLoc feature, if
the user location information is not available, the SMF shall include the PLMN
identifier within the \"servingNetwork\" attribute; for RAN-NAS-Cause feature,
if the SMF received from the access network the RAN cause and/or the NAS cause
due to PDU session termination, the SMF shall provide the received cause(s) in
the \"ranNasRelCauses\" attribute.
NOTE: The SMF derives the value of the \"userLocationInfoTime\" attribute from
the age of location information received in the Location-Report (defined in
subclause 5.3.1 of 3GPP TS 29.518 [36]) from the AMF. Whether the
\"userLocationInfo\" attribute also encodes the age of location is
implementation specific.
### 4.2.6 Provisioning and Enforcement of Policy Decisions
#### 4.2.6.1 General
Policy Decisions are provided from the PCF to the NF service consumer (SMF) as
part of the following service operations:
\- the Npcf_SMPolicyControl_Create Service Operation described in subclause
4.2.2;
\- the SM Policy Association Notification request as part of the
Npcf_SMPolicyControl_UpdateNotify Service Operation as described in subclause
4.2.3.2; and
\- the Npcf_SMPolicyControl_Update service operation as described in subclause
4.2.4
Policy decisions shall be encoded within the SmPolicyDecision data structure
defined in subclause 5.6.2.4
Policy decisions may include:
\- Session Rules as described in subclause 4.1.4.3 encoded within the
\"sessRules\" attribute;
\- PCC Rules as described in subclause 4.1.4.2 encoded within the \"pccRules\"
attribute;
\- QoS decisions as described in subclause 4.1.4.4.3 that can be referenced
from PCC rules encoded within the \"qosDecs\" attribute;
\- charging decisions as described in subclause 4.1.4.4.4 that can be
referenced from PCC rules encoded within the \"chgDecs\" attribute;
\- Traffic control decisions as described in subclause 4.1.4.4.2 that can be
referenced from PCC rules encoded within the \"traffContDecs\" attribute;
\- Usage monitoring control decisions as described in subclause 4.1.4.4.5 that
can be referenced from PCC rules and session rules encoded within the
\"umDecs\" attribute;
\- Conditions that can be referenced from PCC rules and session rules encoded
within the \"conds\" attribute;
\- A reflective QoS timer;
\- Policy control request triggers and applicable additional information,
e.g., Revalidation Time, PRA information;
\- Last requested rule data;
\- Last requested usage data;
\- Default charging method of the PDU session;
\- Charging information;
\- P-CSCF Restoration Support Indication;
\- IP index information;
\- Usage of QoS flow.
For the Npcf_SMPolicyControl_Create Service Operation, the SmPolicyDecision
data structure shall contain a full description of all of policies decisions
provided by the PCF for the policy association.
For the Npcf_SMPolicyControl_UpdateNotify service operation for the SM Policy
Association Notification request and for the Npcf_SMPolicyControl_Update
service operation, the SmPolicyDecision data structure shall contain a
description of changes of the policies decisions with respect to the last
provided previous policy decision for the corresponding policy association.
The default charging method of the PDU session, charging information,
Reflective QoS Timer, P-CSCF Restoration Support Indication and IP index
information shall not been updated by the PCF.
If no other rules are defined for specific data types within the
SmPolicyDecision data structure, the encoding of changes of the policies
decisions in the SmPolicyDecision data structure shall follow the following
principles:
1) To modify an attribute with a value of type map (e.g. the \"sessRules\"
attribute, the \"pccRules\" attribute, the \"qosDecs\" attribute, the
\"traffContDecs\" attribute, the \"umDecs\" attribute, and the \"conds\"
attribute) the attribute shall be provided with a value containing a map with
entries according to the following principles:
\- A new entry shall be added by supplying a new identifier (e.g. rule /
decision identifier) as key and the corresponding structured data type
instance (e.g. PCC rule) with complete contents as value as an entry within
the map.
\- An existing entry shall be modified by supplying the existing identifier as
key and the corresponding structured data type instance with the same existing
identifier (e.g. set the \"qosId\" to the same existing QoS data decision
identifier), which shall describe the modifications following bullets 1 to 6,
as value as an entry within the map.
\- An existing entry shall be deleted by supplying the existing identifier as
key and \"NULL\" as value as an entry within the map.
\- For an unmodified entry, no entry needs to be provided within the map.
2) To modify an attribute with a structured data type instance as value, the
attribute shall be provided with a value containing a structured data type
instance with entries according to bullets 1 to 6.
3) To modify an attribute with another type than map or structured data type
as value, the attribute shall be provided with a complete representation of
its value that shall replace the previous value.
4) To create an attribute of any type, the attribute shall be provided with a
complete representation of its value.
5) To delete an attribute of any type, the attribute shall be provided with
NULL as value.
NOTE 1: Attributes that are allowed to be deleted need to be marked as
\"nullable\" within the OpenAPI file in Annex A.
6) Attributes that are not added, modified, or deleted do not need to be
provided.
NOTE 2: In related data structures no attribute can be marked as mandatory
except the attribute for the identifier (e.g. rule / decision identifier).
The PCF shall not remove a provisioned policy decision data or condition data
from the SMF when the reference(s) from the PCC rule(s) or session rule(s) are
still valid. If the PCF determines that the policy decision or condition data
shall be used for future PCC or session rule(s), the PCF may keep a policy
decision data or condition data valid when the PCF removes all the PCC or
session rule(s) referring to the policy decision data or condition data;
otherwise the PCF shall remove the provisioned policy decision data or
condition data when the PCF removes all the PCC or session rule(s) referring
to the policy decision data or condition data.
#### 4.2.6.2 PCC Rules
##### 4.2.6.2.1 Overview
The PCF may perform an operation on a single PCC rule or a group of PCC rules.
The impacted rules shall be included in the \"pccRules\" map attribute within
the SmPolicyDecision data structure with the \"pccRuleId\" as a key. For
activating the pre-defined PCC rule, or installing or modifying a dynamic PCF-
provisioned PCC rule, the corresponding PccRule data instance shall be
provided as the map entry value. For deactivating or removing a PCC rule, the
map entry value shall be set to NULL.
NOTE 1: When deactivating a predefined PCC rule that is activated in more than
one QoS flow, the predefined PCC rule is deactivated simultaneously in all the
QoS flow where it was previously activated.
In order to activate a pre-defined PCC rule, the PCF shall within the PccRule
instance include the pre-defined PCC rule identifier within the \"pccRuleId\"
attribute and the \"refCondData\" attribute if applicable, i.e. the PccRule
instance is empty except for the \"pccRuleId\" attribute and the
\"refCondData\" if applicable. If the \"refCondData\" attribute is applicable,
a \"conds\" attributes containing the corresponding Condition Data referred by
the PCC rule shall be included in the SmPolicyDecision data structure if it
has not been provided.
In order to install a new dynamic PCF-provisioned PCC rule, the PCF shall
further set other attributes within the PccRule data structure as follows:
\- it may include the precedence within the \"precedence\" attribute. Within a
PDU session, the PCF shall authorize different precedence values for the PCC
rules whose packet filters contained within the \"flowDescription\" attribute
or the \"ethFlowDescription\" attribute include the \"packetFilterUsage\"
attribute set to true;
NOTE 2: The SMF sets the precedence value of the QoS rule to the precedence
value of the PCC rule for which the QoS rule is generated. The UE considers an
error when two or more QoS rules associated with a PDU session have identical
precedence values.
\- it shall include either the flow information within the \"flowInfos\"
attribute(s) or the application identifier within the \"appId\" attribute;
\- it shall include one reference to the QosData data structure within the
\"refQosData\" attribute. In this case, a \"qosDecs\" attributes containing
the corresponding QoS data policy decisions shall be included in the
SmPolicyDecision data structure if it has not been provided;
\- it shall include one reference to the TrafficControlData data structure
within the \"refTcData\" attribute. In this case, a \"traffContDecs\"
attribute containing the corresponding Traffic Control data policy decision
shall be included in the SmPolicyDecision data structure if it has not been
provided;
\- it may include one reference to the ChargingData data structure within the
\"refChgData\" attribute. In this case, a \"chgDecs\" attribute containing the
corresponding Charging Data policy decisions shall be included in
SmPolicyDecision data structure if it has not been provided;
\- it may include one reference to the UsageMonitoringData data structure
within the \"refUmData\" attribute. In this case, a \"umDecs\" attribute
containing the corresponding Usage Monitoring data policy decision shall be
included in the SmPolicyDecision data structure if it has not been provided;
and
\- it may include one reference to the ConditionData data type within the
\"refCondData\" attribute. In this case, a \"conds\" attributes containing the
corresponding Condition Data shall be included in the SmPolicyDecision data
structure if it has not been provided;
In order to modify an existing dynamic PCF-provisioned PCC rule, the PCF shall
further set other attributes within the PccRule data structure as follows:
\- If the PCF needs to modify the attribute(s) within a PCC rule, the PCF
shall include the modified attributes(s) with the new value(s) within the
PccRule data instance. Previously supplied attributes not supplied in the
modified PCC rule instance shall remain valid.
\- If the PCF only needs to modify the content of referenced policy decision
data (e.g. QosData, ChargingData, etc.) and/or condition data for one or more
PCC rules, the PCF shall, within the SmPolicyDecision data structure, include
the corresponding policy decision data and/or condition data within the
corresponding map attributes (e.g. include the QoS data decision within the
\"qosDecs\" attribute).
In order to modify the content of referenced condition data for one or more
existing pre-defined PCC rules, the PCF shall, within the SmPolicyDecision
data structure, include the corresponding condition data within the \"conds\"
attribute.
The PCF may combine multiple of the above PCC rule operations in a single
message.
The SMF shall ensure that at least one PCC Rule bound to the default QoS flow
is activated for the PDU Session. If the PCF did not provision any PCC rule,
the SMF shall activate at least one pre-defined PCC rule which is not known by
the PCF and bound to the default QoS flow.
If the authorized default QoS is GBR type or delay critical GBR type as
defined in subclause 4.2.6.3.3, to ensure that one and only one of the
authorized PCC rules is bound to the default QoS flow the PCF shall indicate
that one and only one PCC rule is bound to the default QoS flow as defined in
subclause 4.2.6.2.10. The SMF shall not bind any other PCC rule to the default
QoS flow with a GBR or delay critical GBR 5QI.
##### 4.2.6.2.2 Gate function
The Gate Function represents a user plane function enabling or disabling the
forwarding of data packets belonging to a service data flow. A gate is
described within a PCC rule. If the PCC rule contains the \"flowInfos\"
attribute(s) applicable for uplink service data flows, it shall describe a
gate for the corresponding uplink service data flows. If the PCC rule contains
the \"flowInfos\" attribute(s) applicable for downlink service data flows, it
shall describe a gate for the corresponding downlink service data flows. If
the PCC rule contains the \"appId\" attribute, it shall describe a gate for
the corresponding detected application traffic. The \"flowStatus\" attribute
within a TrafficControlData data structure which the PCC rule refers to shall
describe if the possible uplink and possible downlink gate is opened or
closed.
The commands to open or close the gate shall lead to the enabling or disabling
of the passage for corresponding data packets. If the gate is closed all
packets of the related service data flows shall be dropped. If the gate is
opened the packets of the related service data flows are allowed to be
forwarded.
##### 4.2.6.2.3 Policy enforcement for authorized QoS per PCC Rule
The PCF can provide the authorized QoS for a PCC rule to the SMF. The
Provisioning of authorized QoS per PCC Rule shall be performed using the PCC
rule provisioning procedure as defined in subclause 4.2.6.2.1. For a PCF-
provided PCC rule, the authorized QoS shall be encoded using a QosData data
structure. The PCF shall include the reference to the QosData data structure
within the \"refQosData\" attribute of the PCC rule and a \"qosDecs\"
attribute containing this QoS data decision within the SmPolicyDecision data
structure.
If the authorized QoS is provided for a PCC rule, the SMF shall derive the QoS
profile towards the access network if applicable, the QoS rule towards the UE
if applicable, and the QoS information with the PDR(s) towards the UPF.
##### 4.2.6.2.4 Redirect function
When the ADC feature is supported, the PCF may provide the redirect
instruction for one or several dynamic PCC rules to the SMF. The Provisioning
shall be performed using the policy provisioning procedure as defined in
subclause 4.2.6.1.
The \"traffContDecs\" attribute within the SmPolicyDecision is used to provide
traffic control decisions. The redirect instruction shall be encoded using a
\"redirectInfo\" attribute within the corresponding TrafficControlData data
structure. That attribute provides a RedirectInformation data structure with
the following components:
\- The \"redirectEnabled\" attribute indicates whether redirect is enabled. It
shall be included and set to true when the redirect instruction is initially
provisioned and may be included in subsequent updates of the
RedirectInformation to enable or disable the redirect instruction.
\- The redirect address may be provided using the \"redirectAddressType\" and
\"redirectServerAddress\" attributes or may be preconfigured in the SMF/UPF. A
redirect destination provided within the \"redirectServerAddress\" attribute
for a dynamic PCC Rule shall override the redirect destination preconfigured
in the SMF/UPF.
NOTE 1: The SMF/UPF uses the preconfigured redirection address only if it can
be applied to the application traffic being detected, e.g. the redirection
destination address could be preconfigured on a per application identifier
basis.
If redirect needs to be applied to a dynamic PCC rule, that PCC rule shall
reference a traffic control decision with such redirect instructions.
If \"redirectInfo\" attribute is provided for a dynamic PCC rule, the SMF
shall instruct the UPF to perform the redirection as defined in 3GPP TS 29.244
[13].
If the \"redirectServerAddress\" attribute is not provided by the dynamic PCC
rule and the redirection address is not preconfigured in the SMF/UPF for this
PCC rule, the SMF shall perform PCC Rule Error Report as specified in
subclauses 4.2.3.16 and 4.2.4.15, and shall set the \"failureCode\" attribute
to \"MISS_REDI_SER_ADDR\".
NOTE 2: When the redirect server address is not provided by the PCC rule, the
SMF determines the \"MISS_REDI_SER_ADDR\" error, e.g. when the SMF determines
the redirect destination is not pre-configured at both SMF and UPF.
To disable the redirect function for one or more already installed PCC Rule,
the PCF shall:
\- update the PCC rule to modify the reference to a new Traffic Control Data
decision which does not have the \"redirectInfo\"; or
\- update the Traffic Control Data decision which the PCC rule refers to with
the \"redirectEnabled\" attribute set to false if the PCF disables the
redirect function for all the PCC rules which refer to this Traffic Control
Data decision.
For a predefined PCC rule, the redirect information shall be included in the
rule definition at the SMF/UPF. Redirect information shall be activated for
predefined PCC rules while those rules are active.
##### 4.2.6.2.5 Usage Monitoring Control
Usage monitoring may be performed for service data flows associated with one
or more PCC rules.
The provisioning of usage monitoring control per PCC rule shall be performed
using the PCC rule provisioning procedure as defined in subclause 4.2.6.2.1.
For a dynamic PCC rule, the reference to the UsageMonitoringData data
structure of the usage monitoring control instance, which is related with the
PCC rule, shall be included within the \"refUmData\" attribute of the PccRule
data structure of the PCC rule(s). For a predefined PCC rule, the reference to
a usage monitoring control instance shall be included in the rule definition
at the SMF. Usage monitoring shall be activated for both service data flows
associated with predefined PCC rules and dynamic PCC rules, including rules
with deferred activation and/or deactivation times while those rules are
active.
##### 4.2.6.2.6 Traffic Steering Control support
If the TSC feature is supported, the PCF may instruct the SMF to apply a
traffic steering control for the purpose of steering the subscriber\'s traffic
to appropriate operator or 3rd party service functions (e.g. NAT, antimalware,
parental control, DdoS protection) in the N6-LAN or enabling the routing of
the user traffic to a local Data Network identified by the DNAI per AF
request.
###### 4.2.6.2.6.1 Steering the traffic in the N6-LAN
This procedure is only applicable in non-roaming and home-routed scenarios.
For the purpose of steering the subscriber\'s traffic to appropriate operator
or 3rd party service functions in the N6-LAN, the PCF shall include the
reference to a Traffic Control Data decision within the PccRule data instance
and set other attribute as follows:
\- either include the application to be detected is identified by the
\"appId\" attribute or the service data flow to be detected is identified by
the \"flowInfos\" attribute(s) within the PccRule data structure; and
\- include a \"traffContDecs\" attribute contain the corresponding Traffic
Control Data decision within the SmPolicyDecision if it has not been provided
yet. In this case, the PCF shall include a traffic steering policy identifier
for downlink identified by the \"trafficSteeringPolIdDl\" attribute and/or a
traffic steering policy identifier for uplink identified by the
\"trafficSteeringPolIdUl\" attribute directly within the Traffic Control Data
decision.
The PCF may also provision the traffic steering control information by
activating the pre-defined PCC rule(s) in the SMF.
###### 4.2.6.2.6.2 Steering the traffic to a local access of the data network
This procedure is only applicable in non-roaming and visited access scenarios.
The PCF shall determine if the ongoing PDU Session is impacted by the routing
of traffic to a local access to a data network as follows:
\- If the AF request includes the individual IP address/ prefix allocated to
an UE or the UE MAC address, the PCF shall store the received traffic routing
information and shall perform the session binding as defined in subclause 6.2
of 3GPP TS 29.513 [7] to determine the impacted PDU session.
\- Otherwise, the PCF fetches the traffic routing data information from the
UDR as defined in 3GPP TS 29.519 [15] applicable for a UE, any UE or Internal
Group Id if received in the SMF request.
Then the PCF authorizes the request for influencing SMF routing decisions. For
impacted PDU Session that corresponds to the AF request, the PCF shall
determine the PCC rules that are generated based on the AF request as follows:
\- When the request is for influencing SMF routing decisions, based on the
traffic routing information, operator\'s policy, etc. and determines the
traffic steering policy. The traffic steering policy indicates for each DNAI,
a traffic steering policy identifier configured in SMF and/or if the N6
routing information associated to the application is explicitly provided by
the AF, the N6 routing information (as provided by the AF). The traffic
steering policy identifier is related to the mechanism enabling traffic
steering to the DN, the PCF derives it from the routing profile Id provided by
the AF. The PCF shall within each PccRule data instance include the
information to identify the traffic within the \"flowInfos\" attribute or
\"appId\" attribute, and within the TrafficControlData data type which the PCC
rule refers to include a list of locations which the traffic shall be routed
to in the \"routeToLocs\" attribute. Within each RouteToLocation instance, the
PCF shall include a DNAI in the \"dnai\" attribute to indicate the location of
the application towards which the traffic routing is applied, and a traffic
steering policy identifier in the \"routeProfId\" attribute or the explicit
routing information in the \"routeInfo\" attribute. If the AF provides both a
traffic steering policy identifier and the N6 routing information for a DNAI,
the PCF shall include two RouteToLocation instances with same DNAI within the
\"dnai\" attribute and include the traffic steering policy identifier within
the \"routeProfId\" attribute in one instance and include the explicit routing
information within the \"routeInfo\" attribute in the other instance.
NOTE 1: The N6 traffic routing requirements are related to the mechanism
enabling traffic steering in the local access to the DN. The routing profile
ID refers to a pre-agreed policy between the AF and the 5GC. This policy may
refer to different steering policy identifier(s) sent to SMF and e.g. based on
time of the day etc.
NOTE 2: Per DNAI, a Traffic steering policy identifier and/or N6 traffic
routing information can be provided. If the pre-configured traffic steering
policy (that is referenced by the traffic steering policy identifier) contains
information that is overlapping with the N6 traffic routing information, the
N6 traffic routing information shall take precedence.
NOTE 3: In this release of the specification, either a traffic steering policy
identifier for UL or a traffic steering policy identifier for the DL can be
defined per DNAI.
\- When the request is for subscribing the UP path change event of the PDU
session , the PCF shall include the information on AF subscription to UP path
change event within the PCC rule(s) to request the notification from the SMF
for the AF. In order to do so, the PCF shall within the PccRule data
instance(s) include the information to identify the traffic either within the
\"flowInfos\" attribute or \"appId\" attribute, and/or within the Traffic
Control Data data decision which the PCC rule refers to include the
information on AF subscription to the events within the \"upPathChgEvent\"
attribute. Within the \"upPathChgEvent\" attribute, the PCF shall include the
\"dnaiChgType\" attribute to indicate the type of notification (i.e. early
notification, late notification or both), the notification address within the
\"notificationUri\" attribute and the notification correlation Id within the
\"notifCorreId\" attribute. In order to enable the AF to identify the AF
request which the notification corresponds to when the AF receives the
notification from the SMF as defined in subclause 4.2.2.2 of 3GPP TS 29.508
[12], the PCF shall set the values of \"notificationUri\" attribute and
\"notifCorreId\" attribute respectively as follows:
\- If the PCF fetches the traffic routing data information from the UDR, the
PCF shall set the value of \"notificationUri\" to the value of the
\"upPathChgNotifUri\" attribute of the TrafficInfluData data structure and set
the value of \"notifCorreId\" attribute to value of \"upPathChgNotifCorreId\"
attribute of the TrafficInfluData data structure as defined in 3GPP TS 29.519
[15].
\- If the PCF receives the traffic routing data information from the AF via N5
interface, the PCF shall set the values of \"notificationUri\" attribute and
\"notifCorreId\" attribute according to the \"upPathChgSub\" attribute within
the AfRoutingRequirement data structure as defined in 3GPP TS 29.514 [17].
\- If the AF request includes an indication indicating that application
relocation is not possible, the PCF shall within the PccRule data instance(s)
include the information to identify the traffic either within the
\"flowInfos\" attribute or \"appId\" attribute and the \"appReloc\" attribute
set to true. In this case, the SMF shall ensure that for the traffic related
with an application, no DNAI change takes place once selected for this
application.
The PCF shall provide the PCC rule(s) as defined in subclause 4.2.6.2.1.
If the temporal validity condition is received, the PCF shall evaluate the
temporal validity condition of the AF request and informs the SMF to install
or remove the corresponding PCC rules according to the evaluation result. When
policies specific to the PDU Session and policies general to multiple PDU
Sessions exist, the PCF gives precedence to the PDU Session specific policies
over the general policies.
If the spatial validity condition is received, the PCF considers the latest
known UE location to determine the PCC rules provided to the SMF. In order to
do that, the PCF shall request the SMF to report the notifications about
change of UE location in an area of interest (i.e. Presence Reporting Area) as
defined in subclauses 4.2.2.13 or 4.2.3.19. The subscribed area of interest
may be the same as spatial validity condition, or may be a subset of the
spatial validity condition (e.g. a list of TAs) based on the latest known UE
location. When the SMF detects that UE entered the area of interest subscribed
by the PCF, the SMF notifies the PCF and the PCF provides to the SMF the PCC
rules described above. When the SMF becomes aware that the UE left the area
subscribed by the PCF, the SMF notifies the PCF and the PCF may remove or
provide updated PCC rules to the SMF.
When the PCC rules are installed, the SMF may, based on local policies, take
the information in the PCC rules into account to:
\- (re)select UPF(s) for PDU Sessions.
\- activate mechanisms for traffic multi-homing or enforcement of an UL
Classifier (UL CL).
\- Inform the AF of the (re)selection of the UP path (change of DNAI).
##### 4.2.6.2.7 Conditioned PCC rule
The PCF may control at what time the status of a PCC rule changes. In order to
provision a PCC rule with conditional data, the PCF shall provision a PCC rule
as defined in subclause 4.2.6.2.1and include within its \"refCondData\"
attribute the corresponding ConditionData\'s \"condId\" attribute value. The
PCF shall also ensure that the referenced ConditionData instance is included
in the \"conds\" map within the SmPolicyDecision data structure following the
procedures defined in subclause 4.2.6.1.
Within the ConditionData instance, the PCF shall include the activation time
within the \"activationTime\" attribute and/or deactivation time within the
\"deactivationTime\" attribute.
When the SMF receives the PCC rule, the SMF shall act as follows:
1) If \"activationTime\" attribute is specified only and the time specified in
\"activationTime\" attribute is in the future, then the SMF shall set the PCC
rule inactive and make it active at that time. If time specified in the
\"activationTime\" attribute is in the past, then the SMF shall immediately
set the PCC rule active.
2) If \"deactivationTime\" attribute is specified only and the time specified
in \"deactivationTime\" attribute is in the future, then the SMF shall set the
PCC rule active and make it inactive at that time. If the time specified in
the \"deactivationTime\" is in the past, then the SMF shall immediately set
the PCC rule inactive.
3) If both \"activationTime\" attribute and \"deactivationTime\" attribute are
specified, and the time specified in the \"activationTime\" occurs before the
time specified in the \"deactivationTime\" attribute, and also when the PCC
rule is provided before or at the time specified in the \"deactivationTime\",
the SMF shall handle the rule as defined in 1) and then as defined in 2).
4) If both \"activationTime\" attribute and \"deactivationTime\" attribute are
specified, and the time specified in the \"deactivationTime\" attribute occurs
before the time specified in the \"activationTime\", and also when the PCC
rule is provided before or at the time specified in the \"activationTime\"
attribute, the SMF shall handle the rule as defined in 2) and then as defined
in 1).
5) If both the \"activationTime\" attribute and the \"deactivationTime\"
attribute are specified but time has already occurred for both, and the time
specified in the \"activationTime\" occurs before the time specified in the
\"deactivationTime\" attribute, then the SMF shall immediately set the PCC
rule inactive.
6) If both the \"activationTime\" attribute and the \"deactivationTime\"
attribute are specified but time has passed for both, and the time specified
in \"deactivationTime\" attribute occurs before the \"activationTime\"
attribute, then the SMF shall immediately set the PCC rule active.
The PCF may modify a currently installed/activated PCC rule, including
setting, modifying or deleting its deferred activation and/or deactivation
time as follows:
1) When modifying a PCC rule by setting the deferred activation time and/or
deactivation time, the PCF shall update the PCC rule by including the
corresponding ConditionData\'s \"condId\" attribute value within the
\"refCondData\" attribute and within the SmPolicyDecision data structure
include the ConditionData instance within the \"conds\" attribute if not
provisioned yet.
2) When modifying a PCC rule by modifying the deferred activation time and/or
deactivation time:
\- the PCF may update the PCC rule by replacing the existing ConditionData
instance\'s \"condId\" attribute value within the \"refCondData\" attribute
with a new one and within the SmPolicyDecision data structure include the new
ConditionData instance within the \"conds\" attribute if not provisioned yet;
or
\- the PCF may update the condition data decision which the PCC rule refers to
by updating the corresponding ConditionData instance as defined in subclause
4.2.6.1. The PCF may add an activation time or an deactivation time, update
the values of the existing activation time and/or the existing deactivation
time, or delete either the existing activation time or the existing
deactivation time.
3) When modifying a PCC rule by deleting the deferred activation time and
deactivation time:
\- the PCF shall delete the reference to the ConditionData instance within the
PCC rule by updating PCC rule with the \"refCondData\" attribute set to NULL;
and
\- the PCF may delete the condition data decision which the PCC rule refers to
as defined in subclause 4.2.6.1 if no other PCC rules are referring to the
condition data decision.
To delete a conditioned PCC rule, the PCF shall perform the deletion of PCC
rule as defined in subclause 4.2.6.2.1.
The UE timezone information, if available, may be used by the PCF to derive
the values of \"activationTime\" attribute and/or the \"deactivationTime\"
attribute.
The PCC rule(s) including the reference to the Condition Data decision which
includes the \"activationTime\" attribute and/or \"deactivationTime\"
attribute shall only be bound to a QoS flow associated with a default QoS
rule. If such PCC rule(s) is not bound to a QoS flow associated with a default
QoS rule, the SMF shall report the failure to the PCF by including the
\"ruleReports\" attribute with the \"failureCode\" attribute set the value
\"NO_QOS_FLOW_BOUND\" for the affected PCC rule(s). Changes of the QoS profile
or QoS rule which will initiate the signalling towards the access network
and/or UE in such PCC rule(s) shall also not be applied.
NOTE: This limitation prevents dependencies on the signalling of changed
traffic mapping information towards the UE.
##### 4.2.6.2.8 PCC rule for resource sharing
If the ResShare feature is supported by both the SMF and PCF as described in
subclause 5.8, the PCF may indicate that the SMF should commonly reserve
resources for a set of PCC rules. The SMF shall then, for PCC rules bound to
the same QoS flow and the same sharing key value , use the highest GBR value
among those PCC rules as input for calculating the common GBR value when
reserving QoS flow resources. The GBR value for each direction shall be
considered separately, so that the uplink and downlink GBR values may
originate from different PCC rules.
The SMF may, based on internal logic, use the highest MBR value among the
provided PCC rules indicated to share resources, when determining the MBR for
the QoS flow. Each individual PCC rule is still subject to data rate policing
based on its own MBR values.
The PCF shall provide the \"sharingKeyDl\" attribute and/or \"sharingKeyUl\"
attribute within the QosData data structure which the PCC rules refers to in
order to indicate that the related PCC rule may share resources with other PCC
rules bound to the same QoS flow.
The SMF shall apply resource sharing if at least two PCC rules bound to the
same QoS flow share the same value in the \"sharingKeyDl\" attribute and/or
\"sharingKeyUl\" attribute.
When modifying the value of \"sharingKeyDl\" attribute and/or \"sharingKeyUl\"
attribute of the QosData data structure, which a PCC rule refers to for the
PCC rule that is subject to resource sharing the SMF may adjust the resource
sharing of the remaining PCC rules.
NOTE 1: A PCC rule that is deleted is also removed from the resource sharing,
while the remaining PCC rules continue their sharing relationship.
NOTE 2: The state of resource sharing ends when less than two of the PCC rules
in the set remains.
##### 4.2.6.2.9 Resource reservation for services sharing priority
When the PCF derives PCC Rules corresponding to a service related to an AF
that has indicated that priority sharing is allowed for that service over Rx
interface, it derives the corresponding PCC Rules according to current
procedures as described in 3GPP TS 29.513 [7], subclause 7.3. The PCF may
additionally take the suggested pre-emption capability and vulnerability
values into account if the AF provided them when the PCF determines the ARP
pre-emption capability and vulnerability. The ARP derived at this point and
the priority sharing indicator provided over Rx reference point (see 3GPP TS
29.214 [18] for further information) related to these derived PCC Rules are
stored for later use.
For PCC Rules related to the same PDU session with the same assigned 5QI and
with the priority sharing indicator enabled (see 3GPP TS 29.214 [18],
subclause 4.4.8), the PCF shall rederive the ARP into a shared ARP for these
PCC Rules as follows:
\- The Priority Level shall be set to the lowest value (i.e. highest priority)
among the Priority Level values derived for the PCC rules that include the
priority sharing indicator.
\- The Pre-emption Capability shall be set to true if any of the original
derived PCC Rules have the Pre-emption-Capability value set to true.
\- The Pre-emption Vulnerability shall be set to true if all the original
derived PCC Rules have the Pre-emption Vulnerability value set to true.
NOTE 1: Having the same setting for the ARP parameter in the PCC Rules with
the priority sharing indicator set enables the usage of the same bearer.
Furthermore, a combined modification of the ARP parameter in the PCC rules
ensures that a bearer modification is triggered when a media flow with higher
service priority starts.
If the 5QI and/or ARP related to any of the PCC Rules that share priority is
changed (e.g. based on local policies), the PCF shall rederive the ARP for the
impacted PCC Rules following the same procedure as defined in this subclause.
The PCF shall provision the PCC Rules according to the rederived ARP
information as described in subclause 4.2.6.2.1.
If the PCF receives a report that a PCC rule provisioning or modification
failed due to the resource reservation failure as defined in subclauses
4.2.3.1.6 and 4.2.4.15 (PCC Rule Error Report) and if the PCF supports the
MCPTT-Preemption feature as defined in subclause 5.4.1 of 3GPP TS 29.214 [18],
the PCF shall check if pre-emption control based on the pre-emption control
information provided by the AF as defined in subclauses 4.4.1 or 4.4.2 of 3GPP
TS 29.214 [18] applies.
NOTE 2: The PCF determines that pre-emption control applies based on the
presence of the preEemptionControlInfo attribute received over Rx/N5 reference
point as defined in 3GPP TS 29.214 [18] and operator policies.
If pre-emption control applies, the PCF shall check the corresponding derived
PCC Rules (before applying priority sharing procedures). If the Pre-emption
Capability of the derived PCC Rule is disabled the PCF shall notify that
resource allocation has failed for this PCC rule to the AF as defined in
subclauses 4.4.1 or 4.4.2 of 3GPP TS 29.214 [18] . Otherwise, if the Pre-
emption Capability of the derived PCC Rule is enabled, the PCF shall perform
the pre-emption control as follows:
\- For all the active PCC rule(s) that applied priority sharing mechanism, the
PCF shall identify the PCC Rules that have the Pre-emption Vulnerability
enabled. For those selected PCC Rule(s), the PCF shall check the Priority
Level value.
\- If there is only one PCC Rule with the Priority Level value higher (i.e.
lower priority) than the derived Priority Level value of new or modified PCC
Rule, the PCF shall remove this PCC rule. The PCF shall retry the PCC rule
provisioning or modification procedure for the PCC rule that failed.
\- Otherwise, if there are more than one PCC Rule with the Priority Level
value higher (i.e. lower priority) than the derived Priority Level value of
new or modified PCC Rule, the PCF shall remove the PCC Rule with the highest
Priority Level from the SMF. The PCF shall retry the PCC rule provisioning or
modification procedure for the PCC rule that failed; If more than one PCC Rule
have the same highest Priority Level, the PCF shall check the Pre-Emption-
Control-Info AVP received over Rx interface as defined in 3GPP TS 29.214 [18]
and remove the PCC Rule that matches the condition.
\- Otherwise, if there is at least one PCC Rule with the same Priority Level
value than the derived Priority Level value of new or modified PCC Rule, the
PCF shall check the Pre-emption-Control-Info AVP received over Rx interface as
defined in 3GPP TS 29.214 [18] for these PCC Rules and remove the PCC Rule
that matches the condition.
\- Otherwise, the PCF shall notify that resource allocation has failed for
this PCC rule to the AF as defined in subclause 4.4.1 or 4.4.2 of 3GPP TS
29.214 [18].
If there is no active PCC Rule with the Pre-emption Vulnerability enabled, the
PCF shall notify that resource allocation has failed for this PCC rule to the
AF as defined in subclauses 4.4.1 or 4.4.2 of 3GPP TS 29.214 [18].
NOTE 3: If the PCF receives a report that a PCC rule provisioning or
modification failed due to the resource reservation failure and the PCF does
not support the MCPTT-Preemption feature as defined in subclause 5.4.1 of 3GPP
TS 29.214 [18], the PCF can apply pre-emption and remove active PCC rules from
the SMF and then retry the PCC rule provisioning or modification procedure.
Otherwise, the PCF will notify it to the AF as defined in subclauses 4.4.1 or
4.4.2 of 3GPP TS 29.214 [18]. How the PCF applies the pre-emption depends on
the implementation.
##### 4.2.6.2.10 PCC rule bound to the default QoS flow
The PCF may indicate to the SMF that a PCC rule shall be bound to the default
QoS flow and shall remain on the default QoS flow. The SMF shall then, for the
indicated PCC rule bind it to the default QoS flow until the PCC rule is
removed or until the PCF modifies the PCC rule to set the
\"defQosFlowIndication\" attribute to false. The SMF this second case shall
evaluate the full QoS information within the QosData data structure which the
PCC rule refers and follow normal policy enforcement procedures for authorized
QoS per service data flow as described in subclause 4.2.8.2.
NOTE: 5QI, ARP, QNC (if available), Priority Level (if available), Averaging
Window (if available) and Maximum Data Burst Volume (if available) within QoS
Data decision referred by the PCC rule are only used by the SMF for QoS flow
binding purposes when the \"defQosFlowIndication\" attribute is not included
in QoS Data decision attribute or it is set to false.
The PCF shall provide the \"defQoSFlowIndication\" attribute set to true in
order to indicate that the related PCC rule shall be bound to the default QoS
flow.
If the \"defQosFlowIndication\" attribute set to true within the QosData data
structure which the PCC rule refers to is received in the SMF, the SMF shall
bind the related PCC rule to the default QoS flow. This remains valid until
the PCC rule is removed or if the PCF indicates to the SMF that the binding to
the default QoS flow no longer applies.\ The SMF shall ignore other values
including 5QI, ARP, QNC (if available), Priority Level (if available),
Averaging Window (if available) and Maximum Data Burst Volume (if available)
within the QosData data structure if the \"defQosFlowIndication\" attribute
set to true. If the PCF has previously indicated to the SMF that a PCC rule
shall be bound to the default QoS flow, to indicate that the binding to the
default QoS flow no longer applies the PCF shall update the PCC rule by
including the \"defQosFlowIndication\" attribute set to false. The SMF in this
case shall evaluate the full QoS information within the QosData data structure
which the PCC rule refers to and follow normal policy enforcement procedures
for authorized QoS per service data flow.
If the PCF has not previously indicated to the SMF that a PCC rule shall be
bound to the default QoS flow (i.e. it may be bound to another QoS flow) in
order to indicate that the binding to the default QoS flow applies, the PCF
shall update the PCC rule by including the \"defQosFlowIndication\" set to
true. The SMF in this case shall follow the procedures described in this
subclause.
##### 4.2.6.2.11 PCC rule for Application Detection and Control
If the ADC feature is supported and the user subscription indicates that the
application detection and control is required, the PCF may instruct the SMF to
detect application (s) by installing or activating a PCC rule.
The application to be detected is identified by an application identifier,
which shall be provided within the \"appId\" attribute for dynamic PCC rules
or pre-provisioned for the predefined PCC rule. If the PCF requires to be
reported about when the application start/stop is detected, it shall also
provide the APP_STA and APP_STO policy control request triggers to the SMF as
defined in subclause 4.2.6.4. For dynamic PCC rules, the PCF may also mute
such a notification about a specific detected application by including a
\"traffContDecs\" attribute to contain a Traffic Control Data decision which
includes the \"muteNotif\" attribute set to true and including a \"refTcData\"
attribute referring to the Traffic Control Data decision within the PCC rule.
If the application identifier provided in the \"appId\" attribute is invalid,
unknown or not applicable, the SMF shall perform PCC Rule Error Report as
specified in subclauses 4.2.3.16 and 4.2.4.15, and shall set the
\"failureCode\" attribute to \"APP_ID_ERR\".
In this release of the specification Application Detection and Control applies
only to the IP PDU session type.
##### 4.2.6.2.12 Provisioning of PCC Rules for Multimedia Priority Services
###### 4.2.6.2.12.1 General
The provision of PCC Rules corresponding to both MPS and non-MPS service shall
be performed as described in subclause 4.2.6.2.1 \"Provisioning of PCC
rules\".
When the PCF derives PCC Rules corresponding to MPS service, the ARP and 5QI
shall be set as appropriate for the prioritized service, e.g. an IMS
Multimedia Priority Service. The PCF may authorize a standardized 5QI or a
standardized 5QI with a specific 5QI priority level as defined in subclause
4.2.6.6.2. The PCF may also authorize a non-standardized 5QI with explicitly
signalled QoS characteristics as defined in subclause 4.2.6.6.3.
When the PCF derives PCC Rules corresponding to non-MPS service, the PCF shall
generate the PCC Rules as per normal procedures. At the time the Priority PDU
connectivity services is invoked (i.e. Indication for support of priority PDU
connectivity service and MPS Priority Level are set), the PCF shall upgrade
the ARP and/or change 5QI for the PCC Rules to appropriate values as needed
for MPS. The PCF shall change the ARP and/or 5QI (also associated QoS
characteristics if applicable) modified for the priority PDU connectivity
service to an appropriate value according to PCF decision.
When the PCF receives an HTTP POST message as defined in subclause 4.2.2.1,
the PCF shall check whether any of these parameters is stored in the UDR:
indication for support of priority PDU connectivity service, MPS Priority
Level and/or indication of IMS priority service support. The PCF shall derive
the applicable PCC rules and default QoS flow QoS based on that information.
If the indication of IMS priority service support is set and the \"dnn\"
attribute corresponds to a DNN dedicated for IMS, the PCF shall assign an ARP
corresponding to MPS for the default QoS flow and for the PCC Rules
corresponding to the IMS signalling QoS flow. If the \"dnn\" does not
correspond to a DNN dedicated for IMS, the ARP shall be derived without
considering IMS Signalling Priority.
NOTE 1: Subscription data for MPS is provided to PCF through the Nudr service.
Once the PCF receives a notification of a change in Priority PDU connectivity
services support, MPS Priority Level and/or IMS priority service support from
the UDR, the PCF shall make the corresponding policy decisions (i.e. ARP
and/or 5QI (also associated QoS characteristics if applicable) change) and, if
applicable, shall initiate an HTTP POST message as defined in subclause
4.2.3.2 to provision the modified data.
NOTE 2: The details associated with the UDR service are specified in 3GPP TS
29.519 [15].
NOTE 3: The MPS Priority Level is one among other input data such as operator
policy for the PCF to set the ARP.
Whenever one or more AF sessions of an MPS service are active within the same
PDU session, the PCF shall ensure that the ARP priority level of the default
QoS flow is at least as high as the highest ARP priority level used by any
authorized PCC rules belonging to an MPS service. If the ARP pre-emption
capability is enabled for any of the authorized PCC rules belonging to an MPS
service, the PCF shall also enable the ARP pre-emption capability for the
default QoS Flow.
NOTE 4: This ensures that services using dedicated QoS flows are not
terminated because of a default QoS flow with a lower ARP priority level or
disabled ARP pre-emption capability being dropped during mobility events.
NOTE 5: This PCF capability does not cover interactions with services other
than MPS services.
###### 4.2.6.2.12.2 Invocation/Revocation of Priority PDU connectivity
services
When a Priority PDU connectivity services is invoked, the PCF shall:
\- Derive the corresponding PCC Rules with the ARP and 5QI (also associated
QoS characteristics if applicable) set as appropriate for a prioritized
service.
\- Set the ARP of the default QoS flow as appropriate for a Priority PDU
connectivity services under consideration of the requirement described in
subclause 4.2.6.2.12.1.
\- Set the 5QI (also associated QoS characteristics if applicable) of the
default QoS flow as appropriate for the Priority PDU connectivity services.
\- Set the ARP of PCC Rules installed before the activation of the Priority
PDU connectivity services to the ARP as appropriate for the Priority PDU
connectivity services under the consideration of the requirements described in
subclause 4.2.6.2.12.1.
\- Set the 5QI of the PCC Rules installed before the activation of the
Priority PDU connectivity services to the 5QI (also associated QoS
characteristics if applicable) as appropriate for the Priority PDU
connectivity services if modification of the 5QI of the PCC Rules is required.
When a Priority PDU connectivity services is revoked, the PCF shall:
\- Delete the PCC Rules corresponding to the Priority PDU connectivity
services if they were previously provided.
\- Set the ARP of the default QoS flow to the normal ARP under the
consideration of the requirements described in subclause 4.2.6.2.12.1.
\- Set the 5QI of the default QoS flow as appropriate for PCF decision.
\- Set the ARP of all active PCC Rules as appropriate for the PCF under the
consideration of the requirements described in subclause 4.2.6.2.12.1.
\- Set the 5QI to an appropriate value according to PCF decision if
modification of the 5QI of PCC Rules is required.
NOTE: Priority PDU connectivity services can be explicitly invoked/revoked via
UDR MPS user profile (Indication of Priority PDU connectivity services, MPS
Priority Level). An AF for MPS Priority Service can also be used to provide
Priority PDU connectivity services using network-initiated resource allocation
procedures (via interaction with PCC) for originating accesses.
The PCF shall provision the SMF with the applicable PCC Rules upon Priority
PDU connectivity services activation and deactivation as described above. The
provision of the QoS information applicable for the PCC Rules shall be
performed as described in subclause 4.5.6.2. The provision of QoS information
for the default QoS flow shall be performed as described in subclause 4.2.6.3.
###### 4.2.6.2.12.3 Invocation/Revocation of IMS Multimedia Priority Services
If the PCF receives service information including an MPS session indication
and the service priority level from the P-CSCF or at reception of the
indication that IMS priority service is active for the PDU session, the PCF
shall under consideration of the requirements described in subclause
4.2.6.2.12.1:
\- if required, set the ARP and 5QI (also associated QoS characteristics if
applicable) of the default QoS flow as appropriate for the prioritized
service;
\- if required, set the ARP and 5QI (also associated QoS characteristics if
applicable) of all PCC rules assigned to the IMS signalling QoS flow as
appropriate for IMS Multimedia Priority Services;
\- derive the PCC Rules corresponding to the IMS Multimedia Priority Service
and set the ARP and 5QI (also associated QoS characteristics if applicable) of
these PCC Rules based on the information received over N5/Rx.
If the PCF detects that the P-CSCF released all the MPS session and the IMS
priority service has been deactivated for the PDU session the PCF shall under
consideration of the requirements described in subclause 4.2.6.2.12.1:
\- delete the PCC Rules corresponding to the IMS Multimedia Priority Service;
\- if required, set the ARP and 5QI of the default QoS flow as appropriate for
the IMS Multimedia Priority set to inactive;
\- replace the ARP and 5QI of all PCC Rules assigned to the IMS signalling QoS
flow as appropriate when the IMS Multimedia Priority is inactive.
##### 4.2.6.2.13 Sponsored Data Connectivity
Sponsored data connectivity may be performed for service data flows associated
with one or more PCC rules if the information about the sponsor, the
application service provider and optionally the threshold values are provided
by the AF and if the AF has not indicated to disable/not enable sponsored data
connectivity as described in 3GPP TS 29.214 [18] subclauses 4.4.1 and 4.4.2 or
3GPP TS 29.514 [17] subclauses 4.2.2.5 and 4.2.3.5.
The provisioning of sponsored data connectivity per PCC rule shall be
performed using the PCC rule provisioning procedure as defined in subclause
4.2.6.2.1. The sponsor identity shall be set using the \"sponsorId\" attribute
within the ChargingData data type which the PCC rule refers to. The
application service provider identity shall be set using the \"appSvcProvId\"
attribute within the ChargingData data type which the PCC rule refers to. The
\"sponsorId\" attribute and \"appSvcProvId\" shall be set if the
\"reportingLevel\" attribute within the ChargingData data type which the PCC
rule refers to is set to the value \"SPON_CON_LEVEL\".
When receiving the usage thresholds from the AF, the PCF shall use the sponsor
identity to generate a value of \"umId\" attribute of the UsageMonitoringData
data type which the PCC rule refers to and request usage monitoring control
for the sponsored data connectivity by following the procedures specified in
subclause 4.2.6.4.3.
When the AF disables sponsoring a service (See 3GPP TS 29.214 [18] subclause
4.4.2 or 3GPP TS 29.514 [17] subclause 4.2.3.5), the PCF:
\- may modify the PCC rules in order to set the \"reportingLevel\" attribute
to \"SER_ID_LEVEL\" or \"RAT_GR_LEVEL\" within the ChargingData data type
which the PCC rule refers to and not include the \"sponsorId\" attribute and
\"appSvcProvId\" attribute if they were included previously.
\- may modify the PCC rules to update the charging key by setting the new
value of the \"ratingGroup\" attribute within the ChargingData data type which
the PCC rule refers to.
NOTE: A specific charging key can be applied to the sponsored data
connectivity for online charging.
\- shall disable the usage monitoring for the sponsored data connectivity
according to subclause 4.2.6.4.3 if it was enabled previously. As a result,
PCF gets the accumulated usage of the sponsored data connectivity.
##### 4.2.6.2.14 Support for PCC rule versioning
The support of PCC rule versioning is optional. When the \"RuleVersioning\"
feature is supported, the SMF and the PCF shall comply with the procedures
specified in this subclause.
If required by operator policies, the PCF shall assign a content version for
each generated PCC rule and shall include the assigned version in the
\"contVer\" attribute included within the PccRule data structure. Upon each
PCC rule modification, if the content version was previously assigned to a PCC
rule, the PCF shall assign a new content version. In this case, all the
content related to that PCC rule shall be included. If the PCF needs to modify
the attribute(s) within the PCC rule, the PCF shall include the new content
version within the \"contVer\" attribute together with all modified and
unmodified applicable attributes(s) within the PccRule data structure. If the
PCF only needs to modify the content of referenced policy decision data and/or
condition data for one or more PCC rules, the PCF shall additionally provide
the PCC rule(s) which is referring to the modified policy decision data and/or
condition data. Within each PCC rule instance, the PCF shall include all
unmodified applicable attributes(s) and the new assigned version in the
\"contVer\" attribute. The content version is unique for the lifetime of the
PCC rule.
NOTE 1: The PCF will include all the content of the PCC rule in each
modification of the PCC rule in order to ensure that the rule is installed
with the proper information regardless of the outcome of the QoS flow
procedure related to previous rule provisioning versions that are not reported
yet.
NOTE 2: The operation policies can take into account whether the AF provides
the related content version information over Rx reference point (see subclause
4.4.9 in 3GPP TS 29.214 [18]), or over Npcf_PolicyAuthorization service (see
subclauses 4.2.2.13 and 4.2.3.13 in 3GPP TS 29.514 [17]).
Whenever the SMF provides a PCC rule report for rules that were provisioned
with a content version, the SMF shall include the \"contVers\" attribute
defined in the RuleReport data structure for those corresponding PCC rules. In
case it is required to report the content version of multiple PCC rules, the
SMF shall use one instance of RuleReport data structure per PCC rule, and
shall include in the \"pccRuleIds\" attribute only the identifier of the
corresponding PCC rule. The SMF may include more than one content version in
the \"contVers\" attribute for the same PCC rule within the corresponding
RuleReport instance included in the \"ruleReports\" attribute (e.g. the SMF
has combined multiple PCC rule versions enforcement into one QoS flow
operation). In this case, the \"ruleStatus\" attribute shall indicate the
final status of the PCC rule.
NOTE 3: The PCF will use the content version to identify the PCC rule version
that failed or succeeded when multiple provisions of the same PCC rule occur
in a short period of time. If required by the AF, the PCF will inform the AF
according to 3GPP TS 29.214 [18], subclause 4.4.9, or according to 3GPP TS
29.514 [17], subclause 4.2.5.8 about the failure or success for the media
component version associated to the PCC rule version.
##### 4.2.6.2.15 Background data transfer support
If the PCF receives Reference Id within the service information from the AF as
defined in 3GPP TS 29.514 [17] or 3GPP TS 29.214 [18], the PCF shall retrieve
the corresponding transfer policy from the UDR based on the Reference Id as
defined in 3GPP TS 29.519 [15], then the PCF shall take the transfer policy as
input for policy decisions (e.g. setting the charging key equal to the
charging key of the transfer policy, rule activation/deactivation time
according to the time window).
##### 4.2.6.2.16 Number of supported packet filter for signalled QoS rule
limitation support
If the PCF includes the flow information within the \"flowInfos\" attribute(s)
and if the number of supported packet filter for signalled QoS rules within
the \"numOfPackFilter\" attribute is received from the SMF during the PDU
session establishment, the PCF may ensure that for all PCC rules of a PDU
session, the number of packet filters contained within the \"flowDescription\"
attribute or the \"ethFlowDescripiont\" attribute with the
\"packetFilterUsage\" set to true does not exceed the value of the
\"numOfPackFilter\" attribute.
#### 4.2.6.3 Session Rules
##### 4.2.6.3.1 Overview
The PCF may perform operations on session rules. The impacted rules shall be
included in the \"sessRules\" map attribute within the SmPolicyDecision data
structure with the \"sessRuleId\" as a key. For installing or modifying a
session rule, the corresponding SessionRule data instance shall be provided as
the map entry value. For removing a session rule, the map entry value shall be
set to NULL.
In order to install a new session rule, the PCF shall further set other
attributes within the SessionRule data structure as follows:
\- it shall include the authorized session AMBR within the \"authSessAmbr\"
attribute;
\- it shall include the authorized default QoS within the \"authDefQos\"
attribute using the procedure as defined in subclause 4.2.6.3.3;
\- it may include one reference to the UsageMonitoringData data structure
within the \"refUmData\" attribute. In this case, a \"umDecs\" attribute
containing the corresponding Usage Monitoring data policy decisions shall be
included in SmPolicyDecision data structure if it has not been previously
provided; and
\- it may include one reference to the ConditionData data structure within the
\"refCondData\" attribute. In this case, a \"conds\" attribute containing the
corresponding Condition Data decision shall be included in SmPolicyDecision
data structure if it has not been previously provided.
In order to modify an existing session rule, the PCF shall further set other
attributes within the SessionRule data structure as follows:
\- If the PCF needs to modify the attribute(s) within a session rule, the PCF
shall include the modified attributes(s) with the new value(s) within the
SessionRule data instance. Previously supplied attributes not supplied in the
modified PCC rule instance shall remain valid.
\- If the PCF only needs to modify the content of referenced policy decision
data (e.g. UsageMonitoringData, etc.) and/or condition data for one or more
session rules, the PCF shall, within the SmPolicyDecision data structure,
include the corresponding policy decision data and/or condition data within
the corresponding map attributes (e.g. include the usage monitoring data
decision within the \"umDecs\" attribute).
The PCF may combine multiple of the above session rule operations in a single
message, but the PCF shall ensure that one and only one session rule is
enforced in the SMF.
##### 4.2.6.3.2 Conditioned Session rule
###### 4.2.6.3.2.1 General
Up to four conditioned session rules (i.e. authorized session AMBR and
authorized default QoS) may be provisioned by the PCF. In order to provision a
session rule with conditional data, the PCF shall provision a session rule as
defined in subclause 4.2.6.3.1 and include within its \"refCondData\"
attribute the corresponding ConditionData\'s \"condId\" attribute value. The
PCF shall also ensure that the referenced ConditionData instance is included
in the \"conds\" map within the SmPolicyDecision data structure following the
procedures defined in subclause 4.2.6.1.
Within the ConditionData instance, the PCF shall include the activation time
within the \"activationTime\" attribute.
NOTE 1: The SMF retains remaining time conditioned session rules that have an
execution time in the future.
If the SMF receives the conditioned session rule, at the time indicated in the
\"activationTime\" attribute, the SMF shall perform the requested change
without interaction with the PCF.
If time conditioned session rule(s) to change the non-conditioned session rule
are received by the SMF and the earliest Activation Time is in the past, then
the SMF shall immediately enforce the most recent time conditioned instance
that is not in the future.
The PCF may modify a currently installed session rule, including setting,
modifying or deleting its deferred activation time as follows:
1) When modifying a session rule by setting the deferred activation time, the
PCF shall update the session rule by including the corresponding
ConditionData\'s \"condId\" attribute value within the \"refCondData\"
attribute and within the SmPolicyDecision data structure include the
ConditionData instance within the \"conds\" attribute if not provisioned yet.
2) When modifying a session rule by modifying the deferred activation time:
> \- the PCF may update the session rule by replacing the existing
> ConditionData instance\'s \"condId\" attribute value within the
> \"refCondData\" attribute with a new one and within the SmPolicyDecision
> data structure include the new ConditionData instance within the \"conds\"
> attribute if not provisioned yet; or
\- the PCF may update the condition data decision which the session rule
refers to by updating the corresponding ConditionData instance as defined in
subclause 4.2.6.1. The PCF may update the value of the existing deferred
activation time.
3) When modifying a session rule by deleting the deferred activation time:
\- the PCF shall delete the reference to the ConditionData instance within the
session rule by updating session rule with the \"refCondData\" attribute set
to NULL; and
\- the PCF may delete the condition data decision which the session rule
refers to as defined in subclause 4.2.6.1 if no other session rules are
referring to the condition data decision.
To delete a time conditioned session rule, the PCF shall perform the deletion
of session rule as defined in subclause 4.2.6.3.1.
The \"ueTimeZone\" attribute, if available, may be used by the PCF to derive
the value for the \"activationTime\" attribute.
NOTE 2: Time conditioned session AMBR and default QoS change helps reducing
the signalling load over N7. However, the session AMBR and default QoS change
needs to be communicated to the UE. Consequently a simultaneous change of the
session AMBR and default QoS for many UE(s) may introduce a signalling storm
in the 5GC (e.g. over N1/N2/N4/N11). The PCF can avoid this simultaneous
change of the session AMBR and default QoS (e.g. spread the time conditioned
change over time for many UEs).
###### 4.2.6.3.2.2 Time conditioned authorized session AMBR
The procedures in subclause 4.2.6.2.2.1 apply with clarifications in the
present subclause.
Each instance of the session rule shall include authorized session AMBR within
the \"authSessAmbr\" attribute.
The SMF shall, after applying a time conditioned instruction to change the
authorized AMBR, apply the corresponding procedures towards to the access
network, the UE and the UPF for the enforcement of the AMBR per PDU session.
###### 4.2.6.3.2.3 Time conditioned authorized default QoS
The procedures in subclause 4.2.6.3.2.1 apply with clarifications in the
present subclause.
Each instance of the session rule shall include authorized default QoS within
the \"authDefQos\" attribute.
The SMF shall, after applying a time conditioned instruction to change the
authorized default QoS, apply the corresponding procedures towards to the
access network, the UE and the UPF for the enforcement of the authorized
default QoS. All PCC rule(s) with the \"defQosFlowIndication\" attribute set
to true shall remain bound to the default QoS flow. For any other PCC rule
previously bound to the default QoS flow, SMF shall then perform the QoS flow
binding according to subclause 6.4 in 3GPP TS 29.513 [7].
##### 4.2.6.3.3 Provisioning of authorized default QoS
The PCF can provide the authorized default QoS for a session rule to the SMF.
The provisioning of authorized default QoS for a session rule shall be
performed using the session rule provisioning procedure as defined in
subclause 4.2.6.3.1. The authorized default QoS shall be encoded using a
AuthorizedDefaultQos data structure.
In order to provision authorized default QoS for a new session rule, the PCF
shall include the assigned 5QI value within the \"5qi\" attribute and the
assigned ARP value within the \"arp\" attribute in the AuthorizedDefaultQos
data structure. The PCF may include the \"priorityLevel\" attribute in the
AuthorizedDefaultQos data structure to authorize the particular 5QI priority
level to override the default values for a standardized or pre-configured 5QI.
The PCF may include a \"QosCharacteristics\" entry in the \"qosChars\"
attribute map to provide explicitly signalled QoS characteristics associated
with a 5QI that is neither standardized nor pre-configured. When the
authorized default QoS applies to explicitly signalled QoS Characteristics, it
shall be provisioned as defined in subclause 4.2.6.6.3. For 5QI of GBR type or
delay critical GBR type, the PCF shall include max bandwidth in uplink within
the \"maxbrUl\" attribute and/or max bandwidth in downlink within the
\"maxbrDl\" attribute, the guaranteed bandwidth in uplink within the \"gbrUl\"
attribute and/or the guaranteed bandwidth in downlink within the \"gbrDl\"
attribute and may include the particular averaging window within the
\"averWindow\" attribute and/or particular maximum data burst volume within
the \"maxDataBurstVol\" attribute to override the default values for a
standardized or pre-configured 5QI.
In order to modify authorized default QoS for an existing session rule, the
PCF shall include the modified attributes(s) with the new value(s) within the
AuthorizedDefaultQos data structure and provision a new QoS Characteristics if
applicable. Previously supplied attributes not supplied in the
AuthorizedDefaultQos data structure shall remain valid.
#### 4.2.6.4 Policy control request triggers
The PCF may provide one or several policy control request trigger(s) to the
SMF. In order to do so, the PCF shall include one or several policy control
request trigger(s) within the \"policyCtrlReqTriggers\" attribute(s) within
the SmPolicyDecision data structure.
During the lifetime of the PDU session, the PCF may update or remove the
policy control request triggers. In order to update the policy control request
trigger, the PCF shall provide the new complete list of applicable policy
control request triggers by including one or several policy control request
trigger(s) within the \"policyCtrlReqTriggers\" attribute within the
SmPolicyDecision data structure.
The PCF may remove all previously provided policy control request triggers by
providing a \"policyCtrlReqTriggers\" attribute set to the value NULL. Upon
reception of a policy control request trigger with this value, the SMF shall
not inform PCF of any trigger except for those triggers that are always
reported and do not require provisioning from the PCF.
Whenever the PCF provisions one or several policy control request trigger(s)
by using an HTTP POST message as defined in subclause 4.2.3.2, unless
otherwise specified in a policy control request trigger\'s value definition,
the SMF shall send the corresponding currently applicable values (e.g. access
type, RAT type, user location information, etc.) to the PCF within the
UeCampingRep data structure in the response of the HTTP POST message, and in
this case, the \"repPolicyCtrlReqTriggers\" attribute shall not be included.
#### 4.2.6.5 Encoding of the request of information reporting
##### 4.2.6.5.1 Request of Access Network Charging Identifier
When the Access Network Charging Identifier is unknown for an AF session to
the PCF, the PCF may request the SMF to provide the Access Network Charging
Identifier associated to the dynamic PCC rules. To do so, the PCF shall within
SmPolicyDecision data structure provide the \"policyCtrlReqTriggers\"
attribute with the value \"AN_CH_COR\" if the policy control request trigger
is not previously set and the \"lastReqRuleData\" attribute. For the
RequestedRuleData instance, the PCF shall include the CH_ID within the
\"reqData\" attribute and reference of the PCC rule within the
\"refPccRuleIds\" attribute.
The PCF shall interpret that the Access Network Charging Identifier is known
when the PCF receives an \"accNetChId\" attribute with the \"sessionChScope\"
attribute included and set to true.
##### 4.2.6.5.2 RAN NAS Cause Support
When RAN-NAS-Cause feature is supported, the PCF may request the SMF to inform
it of the result of the PCC rule removal when the PCF removes the PCC rule. In
order to do so, the PCF shall additionally include the
\"policyCtrlReqTriggers\" attribute with RES_RELEASE if the policy control
request trigger is not previously set and the \"lastReqRuleData\" attribute.
For the RequestedRuleData instance, the PCF shall include the RES_RELEASE
within the \"reqData\" attribute and reference of the removed PCC rule within
the \"refPccRuleIds\" attribute.
NOTE: This is done to allow the PCF to notify the AF when there is an abnormal
termination of the QoS flow. The PCF does not have to retry the removal of
these PCC Rules.
##### 4.2.6.5.3 Provisioning of the Usage Monitoring Control Policy
The PCF may indicate the need to apply monitoring control for the accumulated
usage of network resources on a PDU session basis. Usage is defined as volume
or time of user plane traffic. Monitoring for traffic volume and traffic time
can be performed in parallel. The data collection for usage monitoring control
shall be performed per monitoring key, which may apply for a single service
data flow, a set of service data flows or for all the traffic in a PDU
session. If the usage monitoring of a PDU session level is enabled, the PCF
may request the SMF to exclude a single service data flow or a set of service
data flows from the usage monitoring of PDU session level.
During the PDU session establishment, the PCF may receive information about
total allowed usage per DNN and S-NSSAI combination and UE from the UDR, i.e.
the overall amount of allowed traffic volume and/or time of usage that are to
be monitored per DNN and S-NSSAI combination and UE and/or total allowed usage
for Monitoring key(s) per DNN and S-NSSAI combination and UE.
NOTE: It depends on the implementation of UDR to provide the total allowed
usage per DNN and UE to different PCFs if the different PCFs are serving the
PDU sessions with same value of DNN and UE.
If the SMF supports the UMC feature, the PCF may request usage monitoring
control for the PDU session. If at this time, the PCF has not provided
\"US_RE\" policy control request trigger to the SMF, the PCF shall include the
\"policyCtrlReqTriggers\" attribute with the value \"US_RE\" and provide it to
the SMF as defined in subclause 4.2.6.4. The PCF shall not remove the
\"US_RE\" policy control request trigger while usage monitoring is still
active in the SMF.
At PDU session establishment and modification, the PCF may provide the
applicable thresholds, volume threshold, time threshold or both volume
threshold and time threshold, for each usage monitoring control instance to
the SMF. To provide the initial threshold for each usage monitoring control
instance, the PCF shall include the threshold(s) within the \"umDecs\"
attribute within the SmPolicyDecision data structure.
The PCF may provide a monitoring time to the SMF for the usage monitoring
control instance (s) and optionally specify a subsequent threshold value for
the usage after the monitoring time.
Threshold levels, monitoring time if applicable and inactive time if
applicable for each usage monitoring control instance may be provisioned
within an entry of the \"umDecs\" attribute as follows:
\- the total volume threshold within the \"volumeThreshold\" attribute if
applicable;
\- the uplink volume threshold within the \"volumeThresholdUplink\" attribute
if applicable;
\- the downlink volume threshold within the \"volumeThresholdDownlink\"
attribute if applicable;
\- the time threshold within the \"timeThreshold\" attribute if applicable;
. the total volume threshold after the monitoring time within the
\"nextVolThreshold\" attribute if applicable;
\- the uplink volume threshold after the monitoring time within the
\"nextVolThresholdUplink\" attribute if applicable;
\- the downlink volume threshold after the monitoring time within the
\"nextVolThresholdDownlink\" attribute if applicable;
\- the time threshold after the monitoring time within the
\"nextTimeThreshold\" attribute if applicable;
\- the monitoring time within the \"monitoringTime\" attribute if applicable;
\- the inactive time within the \"inactivityTime\" attribute if applicable.
If the usage monitoring control instance applies to the PDU session level, the
PCF shall include the reference to the Usage Monitoring Data decision within
the \"refUmData\" attribute of a session rule.
If the usage monitoring control instance applies to a service data flow or a
group of service data flows, the PCF shall include the reference to the Usage
Monitoring Data decision within the \"refUmData\" attribute of one or more PCC
rule.
The PCF may provide one usage monitoring control instance applicable at PDU
session level and one or more usage monitoring instances applicable at PCC
Rule level.
If the PDU session level usage monitoring is enabled and if the service data
flow(s) need to be excluded from PDU session level usage monitoring, the PCF
shall include the corresponding PCC rule identifier(s) within the
\"exUsagePccRuleIds\" attribute of the UsageMonitoringData instance of PDU
session level usage monitoring. If the exclusion is enabled, the PCF may
disable the exclusion again for the service data flow(s) by removing the
corresponding PCC rule identifier from \"exUsagePccRuleIds\" attribute.
If the PCF wishes to remove the threshold level for one or more monitoring
keys, the PCF shall provide the corresponding attribute with NULL value to the
corresponding usage monitoring control instance.
When the SMF receives the usage monitoring control request above from the PCF,
the SMF shall initiate the PFCP Session Establishment Request as defined in
subclause 7.5.2 or PFCP Session Modification Request as defined in subclause
7.5.4 of 3GPP TS 29.244 [13] to request the UPF to perform the usage
monitoring control.
When usage monitoring is enabled, the PCF may request the SMF to report
accumulated usage for one or more enabled usage monitoring control instance
regardless if a usage threshold has been reached. In order do so, the PCF
shall include the \"lastReqUsageData\" attribute to contain one more
reference(s) to usage monitoring data decision(s) within the \"refUmIds\"
attribute or contain the \"allUmIds\" set to true. The PCF shall only require
SMF to report accumulated usage for one or more enabled usage monitoring
control instance(s) in a response of HTTP POST initiated by the SMF when the
SMF has not provided accumulated usage in the HTTP POST for the same usage
monitoring control instance(s).
Upon receiving the reported usage from the SMF, the PCF shall deduct the value
of the usage report from the total allowed usage for that PDU session, usage
monitoring key, or both as applicable, and the PCF may also derive the PCC
rules based on the remaining allowed usage or reported usage and provision
them to the SMF.
##### 4.2.6.5.4 Request for Access Network Information
When the NetLoc feature is supported, if the AF requests the PCF to report the
access network information as described in subclauses 4.2.2, 4.2.3 or 4.2.4 of
3GPP TS 29.514 [17] or in subclauses 4.1 and 4.2 of 3GPP TS 29.214 [18], the
PCF shall perform the PCC rule provisioning procedure as defined in subclause
4.2.6.2.1 and additionally provide the requested access network information
indication (e.g. user location and/or user timezone information) to the SMF as
follows:
\- it shall include the \"lastReqRuleData\" attribute to contain the
\"reqData\" attribute with the value(s) MS_TIME_ZONE and/or USER_LOC_INFO and
the \"refPccRuleIds\" attribute to contain the related
installed/modified/removed PCC rule identifier(s).
\- it shall provide the AN_INFO policy control request rigger within the
\"policyCtrlReqTriggers\" attribute (if not yet set).
For those PCC Rule(s) based on preliminary service information as described in
3GPP TS 29.514 [17] or in 3GPP TS 29.214 [18], the PCF may assign the 5QI and
ARP of the default QoS flow to avoid signalling to the UE. These PCC Rules
shall not include the \"packetFilterUsage\" attribute set to true within the
\"flowInfos\" attribute.
##### 4.2.6.5.5 Request for the successful resource allocation notification
The PCF may request the SMF to confirm that the resources associated to a PCC
rule are successfully allocated. To do so the PCF shall within the
SmPolicyDecision data structure provide the \"policyCtrlReqTriggers\"
attribute with the value \"SUCC_RES_ALLO \" if the policy control request
trigger is not previously set and the \"lastReqRuleData\" attribute. For the
RequestedRuleData instance, the PCF shall include the \"SUCC_RES_ALLO\" within
the \"reqData\" attribute and the reference of the PCC rule within the
\"refPccRuleIds\" attribute.
##### 4.2.6.5.6 Provisioning of Presence Reporting Area Information
When PRA feature is supported, the PCF may determine during the lifetime of
the PDU session whether reports for change of UE presence in Presence
Reporting Area(s) are desired for the PDU session based on the subscriber\'s
profile configuration. If the reporting is desired for the PDU session, the
PCF shall provide the \"praInfos\" attribute within the SmPolicyDecision data
structure. Within each PresenceInfoRm data structure, the PCF shall include
the Presence Reporting Area Identifier within the \"praId\" attribute, and,
for a UE-dedicated Presence Reporting Area, the list of elements composing the
presence reporting area within the \"trackingAreaList\" attribute,
\"ecgiList\" attribute, \"ncgiList\" attribute, and/or \"globalRanNodeIdList\"
attribute. The PCF shall activate the reporting changes of UE presence in
Presence Reporting Area(s) by provisioning the \"PRA_CH\" policy control
request trigger to the SMF.
NOTE 1: If this feature is not supported, the PCF can instead activate
location change reporting that reports actual location. Due to the potential
increase in signalling load, careful consideration of the network load is
necessary for such reporting, e.g. limiting the number of subscribers\'
subject to such reporting.
NOTE 2: The Presence Reporting Area Identifier can correspond to a list of
Presence Reporting Area Identifier(s) within a set of Core Network predefined
Presence Reporting Areas (PRA set identifier) as defined in 3GPP TS 23.501
[2].
The PCF may modify the list of PRA Identifier(s) by providing the new Presence
Reporting Area or by removing existing Presence Reporting Area(s) or modify
the list(s) of Presence Reporting Area elements by providing the updated
Presence Reporting Area. In order to do that, the PCF shall follow the general
procedure as defined in subclause 4.2.6.1 and supply the Presence Reporting
Area identifier(s) as the key(s) of the map.
The PCF may remove the policy control request trigger of change of UE presence
in Presence Reporting Area as defined in subclause 4.2.6.4, if previously
activated.
If the \"PRA_CH\" policy control request trigger is provisioned, when the PCF
provides a list of presence reporting areas as described above, the PCF shall
ensure that the maximum number of provisioned Presence Reporting Area
Identifiers is not exceeded. The maximum number of PRAs may be configured in
the PCF. The PCF may have independent configuration of the maximum number for
Core Network pre-configured PRAs and UE-dedicated PRAs.
NOTE 3: For all the Presence Reporting Area(s) provided by the PCF, the SMF
can store the Presence Reporting Area Identifier(s) together with an
indication that states that it relates to PCF requested PRA status changes.
NOTE 4: This information is needed so that if both PCF and CHF request the
reports of PRA status changes, the SMF is able to differentiate whether the
reported PRA changes are relevant to PCF or CHF.
The SMF shall invoke the Namf_EventExposure service in the AMF to handle the
subscription to the presence state of a UE in an area of interest as specified
in 3GPP TS 29.518 [36].
The PCF may be notified during the lifetime of an PDU session that the UE is
located in an access network where local configuration indicates that the
reporting change of UE presence in Presence Reporting Area is not supported.
The PCF may remove the policy control request trigger of the change of UE
presence in Presence Reporting Area, if previously activated. In this case,
the PCF shall also remove the provisioned presence reporting areas by
including the \"praInfos\" attribute set to NULL within the SmPolicyDecision
data structure.
The SMF shall remove the Namf_EventExposure service subscription with the AMF
for the reporting of Change of UE presence in Presence Reporting Area, when
the PCF and CHF remove the request trigger of change of UE presence in
Presence Reporting Area.
##### 4.2.6.5.7 Policy provisioning and enforcement of reflective QoS
If the PCF receives the \"refQosIndication\" attribute set to true as defined
in subclauses 4.2.2.2 or 4.2.4.2, and if the PCF determines that Reflective
QoS Control will be enabled for the PDU session based on the operator\'s
policy and user subscriptions, the PCF may provision the Reflective QoS Timer
by including the \"reflectiveQoSTimer\" attribute within the SmPolicyDecision
data structure in the response message.
The provisioning of reflective QoS may be performed for service data flows
associated with one or more PCC rules, and shall be performed using the PCC
rule provisioning procedure. The PCF may within a QoS data decision which a
PCC rule refer to include the \"reflectiveQos\" attribute set to true to
enable the Reflective QoS control to a non-GBR downlink service data flow when
the PCF authorizes the QoS for the service data flow as defined in subclause
4.2.6.6.2. The PCF shall ensure that both, uplink and downlink traffic for
such non-GBR service data flow are allowed.
NOTE 1: The PCF can allow both uplink and downlink traffic for the non-GBR
service data flow in several ways, e.g. by installing a PCC rule with uplink
and downlink flow information, or by installing separate PCC rules for the
uplink flows and downlink flows, or by installing a PCC rule with only the
application identifier.
The PCF shall activate the reporting changes of reflective QoS indication by
provisioning the \"REF_QOS_IND_CH\" policy control request trigger to the SMF.
NOTE 2: While the UE applies a standardized value for the precedence of all UE
derived QoS rules, PCC rules precedence values can vary and PCF configuration
has to ensure that there is a large enough value range for the precedence of
PCC rules corresponding to UE derived QoS rules. To avoid that the precedence
of network provided QoS rules need to be changed when Reflective QoS is
activated and filters are overlapping, the PCF will take the standardized
value for the precedence of UE derived QoS rules into account and will setting
the precedence value of PCC rules subject to Reflective QoS to a value in the
range from 70 to 99 (decimal), as specified in 3GPP TS 24.501 [20], subclause
6.2.5.1.1.3.
The SMF shall apply reflective QoS control for the downlink traffic of the
service data flows of the PCC rules that reference a QosData decision that
includes \"reflectiveQos\" attribute set to true.
The PCF shall not include the \"reflectiveQos\" attribute set to true within
the QoS data decision which the PCC rule with match-all SDF template refers
to. If a PCC rule with match-all SDF template has been provisioned to the SMF,
the PCF shall not include the \"reflectiveQos\" attribute within the QoS data
decision which contains the \"defQosFlowIndication\" attribute, either.
If the PCF receives the \"refQosIndication\" attribute set to false as defined
in subclause 4.2.4.2, the PCF shall disable the reflective QoS Control for the
PDU session. In order to do so, the PCF shall within the QoS data decision
which affected PCC rule refer to include the \"reflectiveQos\" attribute set
to false and may update other QoS parameters within the QoS data decision
and/or update the flow information of PCC rule by including the
\"packetFilterUsage\" attribute set to true.
#### 4.2.6.6 Authorized QoS
##### 4.2.6.6.1 General
The PCF shall provision the authorized QoS. The authorized QoS may apply to a
PCC rule or to a PDU session.
\- When the authorized QoS applies to a PCC rule, it shall be provisioned
within the corresponding PCC rule as defined in subclause 4.2.6.6.2.
\- When the authorized QoS for a PCC rule with a GBR QCI is candidate for
resource sharing an instruction on the allowed sharing may be provisioned as
defined in subclause 4.2.6.2.8.
\- When the authorized QoS applies to a PDU session, it shall be provisioned
as defined in subclause 4.2.6.3.1.
\- When the authorized QoS applies to the default QoS flow, it shall be
provisioned as defined in subclause 4.2.6.3.1.
\- When the authorized QoS applies to an explicitly signalled QoS
Characteristics, it shall be provisioned as defined in subclause 4.2.6.6.3.
\- When the authorized QoS applies to the Reflective QoS, it shall be
provisioned as defined in subclause 4.2.6.5.7.
The authorized QoS provides appropriate values for the resources to be
enforced. The authorized QoS for a PCC rule is a request for allocating the
corresponding resources. The Provisioning of authorized QoS per PCC rule is a
part of PCC rule provisioning procedure.
If the SMF cannot allocate any of the resources as authorized by the PCF, the
SMF informs the PCF and acts as described in subclauses 4.2.3.16 and 4.2.4.15.
The SMF shall interact with the (R)AN, UPF and UE for enforcing the policy
based authorization.
QoS authorization information may be dynamically provisioned by the PCF or it
may be a pre-defined PCC rule in the SMF. Moreover, all the parameters of the
authorized QoS may be changed.
NOTE 1: A change of 5QIs cannot be described as an upgrade or downgrade and
also no 5QI can be referred to as the higher or lower. Whether the 5QI is
permitted to be changed or not is subject to both operator policies and normal
restrictions on changing from a non-GBR 5QI value to GBR 5QI value on an IP
flow.
NOTE 2: All attributes of the ARP QoS parameter can be changed but only the
ARP priority level represents an ordered range of values. The ARP priority
level attribute represents the actual priority for the service/user with the
value 1 as the highest and can thus be upgraded and downgraded.
If the PCF is unable to make a decision for the response to the HTTP POST
message by the SMF, the PCF may reject the request as described in subclause
5.7.
##### 4.2.6.6.2 Policy provisioning and enforcement of authorized QoS per
service data flow
The Provisioning of authorized QoS per service data flow is a part of PCC rule
provisioning procedure, as described in subclause 4.2.6.2.1.
The authorized QoS per service data flow shall be provisioned within a QosData
data structure. The PCF shall include a \"qosDecs\" attribute containing the
corresponding QoS data decision within the SmPolicyDecision data structure and
include the reference to this QoS data decision within the \"refQosData\"
attribute of the PccRule data instance.
Within the QoS data decision, for 5QI of GBR type or delay critical GBR type,
the PCF shall include the authorized GBR 5QI or delay critical GBR 5QI
respectively within the \"5qi\" attribute, the ARP within the \"arp\"
attribute, and max bandwidth in uplink within the \"maxbrUl\" attribute and/or
max bandwidth in downlink within the \"maxbrDl\" attribute, the guaranteed
bandwidth in uplink within the \"gbrUl\" attribute and/or the guaranteed
bandwidth in downlink within the \"gbrDl\" attribute. If the PCF determines
that the application traffic can be adapted to the change in the QoS based on
the configuration (e.g. if the AF is capable to trigger rate adaptation), the
PCF may request a notification when authorized GBR or delay critical GBR
cannot be guaranteed or can be guaranteed again by including the \"qnc\"
attribute set to true.
Within the QoS data decision, for 5QI of non-GBR type, the PCF shall include
the authorized non-GBR 5QI within the \"5qi\" attribute and the ARP within the
\"arp\" attribute. The PCF may authorize the max bandwidth in uplink within
the \"maxbrUl\" attribute and/or max bandwidth in downlink within the
\"maxbrDl\" attribute.
When the PCF authorizes a standardized 5QI but a Priority Level, an Averaging
Window and/or a Maximum Data Burst Volume which are different from the
standardized value in the table 5.7.4-1 of 3GPP TS 23.501 [2] are required,
the PCF shall include the Priority Level within the \"priorityLevel\"
attribute, the Averaging Window within the \"averWindow\" attribute and/or the
Maximum Data Burst Volume within the \"maxDataBurstVol\" attribute.
NOTE 1: For the non-standardized or non-configured 5QI, the PCF needs to
authorize explicitly signalled QoS Characteristics associated with the 5QI if
the PCF has not provisioned it.
If the configured policy allows at reception of the service information from
the AF and the application of the rules of the QoS mapping procedures defined
in 3GPP TS 29.513 [7] subclause 7.3.2 for the received service information
result in a 5QI of 1 associated with the corresponding flows, and the RAN-
Support-Info feature as defined subclause 5.8 is supported, the PCF shall
determine the Maximum Packet Loss Rate for UL and DL for those flows
associated within 5QI of 1. In this case, the PCF shall include the value of
Maximum Packet Loss Rate for UL within the \"maxPacketLossRateUl\" attribute
and/or the value of Maximum Packet Loss Rate for DL within the
\"maxPacketLossRateDl\" attribute.
NOTE 2: Based on local configuration, the PCF sets the downlink and uplink
maximum packet loss rates corresponding to either the most robust codec mode
or the least robust codec mode of the negotiated set in each direction.
If the PCF wants to ensure that a PCC Rule is always bound to the default QoS
flow, the policy provisioning for the related authorized QoS shall be done as
described in subclause 4.2.6.2.10.
The SMF shall perform a QoS flow binding based on the QoS information within
the Qos data decision as defined in subclause 6.4 of 3GPP TS 29.513 [7] after
the SMF installs or activates the PCC rules.
The SMF shall reserve the resources necessary for the guaranteed bitrate for
the PCC rule upon receipt of a PCC rule provisioning including QoS
information. For GBR QoS flows the SMF should set the QoS flow\'s GBR to the
sum of the GBRs of all PCC rules that are active/installed and bound to that
GBR QoS flow. For GBR QoS flow the SMF should set the QoS flow\'s MBR to the
sum of the MBRs of all PCC rules that are active/installed and bound to that
GBR QoS flow.
NOTE 3: Since the PCF controls the GBR value in the PCC rule, the PCF can
prevent that uplink GBR resources are reserved by providing an uplink GBR
value of zero for that PCC rule This may be useful e.g. for a PCC rule with
application identifier as the uplink traffic can be received in other QoS flow
than the one the PCC rule is bound to.
The SMF shall assign a QFI if a new QoS flow needs to be established and shall
derive, if applicable, the QoS profile required towards the Access Network,
the QoS rule required towards the UE and the QoS information with PDRs towards
to the UPF. If multiple PCC rules with the Maximum Packet Loss Rate for UL and
DL are bound to the same QoS flow, the SMF shall choose the lowest value per
direction related to the PCC rules within the QoS profile towards to the
access network.
If one or more of the 5QI, ARP, QNC, Priority level, Averaging Window and
Maximum Data Burst Volume attributes of a PCC rule are modified to the same
updated values for all the PCC rules bound to the same QoS flow, then the SMF
should modify the corresponding attributes for that impacted QoS flow.
Upon deactivation or removal of a PCC rule, the SMF shall free the resources
reserved for that PCC rule, and initiate the corresponding procedure with
access network, UE and UPF to remove the resources.
##### 4.2.6.6.3 Policy provisioning and enforcement of authorized explicitly
signalled QoS Characteristics
The PCF may provision a dynamically assigned 5QI value (from the non-
standardized and non-preconfigured value range) and the associated 5G QoS
characteristics to the SMF. In order to do so, the PCF shall within the
SmPolicyDecision data structure include the \"qosChars\" attribute to contain
one more authorized signalled QosCharacteristics instances. For each
QosCharacteristics instance, the PCF shall include assigned 5QI value within
the \"5qi\" attribute, resource type value within the \"resourceType\"
attribute, the 5QI Priority Level value within the \"priorityLevel\"
attribute, the Packet Delay Budget value within the \"packetDelayBudget\"
attribute, Packet Error Rate value within the \"packetErrorRate\" attribute,
the Averaging Window value within the \"averagingWindow\" attribute if
applicable and the Maximum Data Burst Volume value within the
\"maxDataBurstVol\" attribute if applicable. If the PCF has provisioned an
authorized signalled QosCharacteristics instance to the SMF, the PCF shall not
update nor remove it during the lifetime of the policy association.
Upon receiving the authorized explicitly signalled QoS characteristics, the
SMF shall derive the QoS profile towards the access network and provide it to
the access network by invoking corresponding procedure.
NOTE: Operator configuration is assumed to ensure that the assigned dynamic
5QI value is unique and references the same set of QoS characteristics within
the whole PLMN at a given time.
# 5 Npcf_SMPolicyControl Service API
## 5.1 Introduction
The request URI used in HTTP request from the NF service consumer towards the
PCF shall have the structure defined in subclause 4.4.1 of 3GPP TS 29.501 [5],
i.e.:
All resource URIs of this API shall have the following root:
**{apiRoot}/{apiName}/{apiVersion}/{apiSpecificResourceUriPart}**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [5].
\- The {apiName} shall be \"npcf-smpolicycontrol\".
\- The {apiVersion} shall be \"v1\".
\- The {apiSpecificResourceUriPart} shall be set as described in subclause
5.3.
## 5.2 Usage of HTTP
### 5.2.1 General
HTTP/2, IETF RFC 7540 [8], shall be used as specified in clause 5 of 3GPP TS
29.500 [4].
HTTP/2, shall be transported as specified in subclause 5.3 of 3GPP TS 29.500
[4].
An OpenAPI [10] specification of HTTP messages and content bodies for the
Npcf_SMPolicyControl is contained in Annex A.
### 5.2.2 HTTP standard headers
#### 5.2.2.1 General
See subclause 5.2.2 of 3GPP TS 29.500 [4] for the usage of HTTP standard
headers.
#### 5.2.2.2 Content type
JSON, IETF RFC 8259 [9], shall be used as content type of the HTTP bodies
specified in the present specification as specified in subclause 5.4 of 3GPP
TS 29.500 [4]. The use of the JSON format shall be signalled by the content
type \"application/json\".
\"Problem Details\" JSON object shall be used to indicate additional details
of the error in a HTTP response body and shall be signalled by the content
type \"application/problem+json\", as defined in IETF RFC 7807 [31].
### 5.2.3 HTTP custom headers
#### 5.2.3.1 General
The mandatory HTTP custom header fields specified in subclause 5.2.3.2 of 3GPP
TS 29.500 [4] shall be applicable.
## 5.3 Resources
### 5.3.1 Resource Structure
Figure 5.3.1-1: Resource URI structure of the Npcf_SMPolicyControl API
Table 5.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 5.3.1-1: Resources and methods overview
+----------------+----------------+----------------+----------------+ | Resource name | Resource URI | HTTP method or | Description | | | | custom | | | | | operation | | +----------------+----------------+----------------+----------------+ | SM Policies | {apiRoot}/\ | POST | Create a new | | | npcf-smp | | Individual SM | | | olicycontrol/\ | | Policies | | | v1/sm-policies | | resource for | | | | | an SUPI or for | | | | | a PEI and PDU | | | | | Session ID and | | | | | PDU Session ID | | | | | supplied by | | | | | the SMF. | +----------------+----------------+----------------+----------------+ | Individual SM | {apiRoot}/\ | GET | Read the | | Policy | npcf-smp | | Individual SM | | | olicycontrol/\ | | Policies | | | v1/sm-policie | | resource. | | | s/{smPolicyId} | | | +----------------+----------------+----------------+----------------+ | | {apiRoot}/\ | delete | Delete the | | | npcf-smpoli | | Individual SM | | | cycontrol/v1/\ | (POST) | Policies | | | sm- | | resource. | | | policies/{smPo | | | | | licyId}/delete | | | +----------------+----------------+----------------+----------------+ | | {apiRoot}/\ | update | Update the | | | npcf-smpoli | | Individual SM | | | cycontrol/v1/\ | (POST) | Policies | | | sm- | | resource when | | | policies/{smPo | | a policy | | | licyId}/update | | control | | | | | request event | | | | | is met or an | | | | | error of | | | | | policy | | | | | enforcement | | | | | occurs. | +----------------+----------------+----------------+----------------+
### 5.3.2 Resource: SM Policies
#### 5.3.2.1 Description
This resource represents the collection of the individual SM Policies created
in the PCF.
#### 5.3.2.2 Resource definition
Resource URI: **{apiRoot}/npcf-smpolicycontrol/v1/sm-policies**
This resource shall support the resource URI variables defined in table
5.3.2.2-1.
Table 5.3.2.2-1: Resource URI variables for this resource
* * *
Name Definition apiRoot See subclause 5.1
* * *
#### 5.3.2.3 Resource Standard Methods
##### 5.3.2.3.1 POST
This method shall support the URI query parameters specified in table
5.3.2.3.1-1.
Table 5.3.2.3.1-1: URI query parameters supported by the POST method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.2.3.1-2 and the response data structures and response codes specified in
table 5.3.2.3.1-3.
Table 5.3.2.3.1-2: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description SmPolicyContextData M 1 Parameters to
create an individual SM policies resources.
* * *
Table 5.3.2.3.1-3: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | SmP | M | 1 | 201 Created | An individual | | olicyDecision | | | | SM Policy | | | | | | resources for | | | | | | the SUPI and | | | | | | PDU session | | | | | | id are | | | | | | created | | | | | | successfully. | +---------------+---+-------------+---------------+---------------+ | P | M | 1 | 400 Bad | (NOTE 2) | | roblemDetails | | | Request | | +---------------+---+-------------+---------------+---------------+ | P | M | 1 | 403 Forbidden | (NOTE 2) | | roblemDetails | | | | | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in table | | | | | | 5.2.7.1-1 of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | shall also | | | | | | apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure cases | | | | | | are described | | | | | | in | | | | | | s | | | | | | ubclause 5.7. | | | | | +---------------+---+-------------+---------------+---------------+
#### 5.3.2.4 Resource Custom Operations
None.
### 5.3.3 Resource: Individual SM Policy
#### 5.3.3.1 Description
The individual SM Policy resource represents an individual SM Policy created
in the PCF and associated with the SUPI and PDU session ID.
#### 5.3.3.2 Resource definition
Resource URI: **{apiRoot}/npcf-smpolicycontrol/v1/sm-policies/{smPolicyId}**
This resource shall support the resource URI variables defined in table
5.3.3.2-1.
Table 5.3.3.2-1: Resource URI variables for this resource
* * *
Name Definition apiRoot See subclause 5.1 smPolicyId Unique identifier of the
individual SM Policy resource.
* * *
#### 5.3.3.3 Resource Standard Methods
##### 5.3.3.3.1 GET
This method shall support the URI query parameters specified in table
5.3.3.3.1-1.
Table 5.3.3.3.1-1: URI query parameters supported by the GET method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.3.3.1-2 and the response data structures and response codes specified in
table 5.3.3.3.1-3.
Table 5.3.3.3.1-2: Data structures supported by the GET Request Body on this
resource
* * *
Data type P Cardinality Description n/a
* * *
Table 5.3.3.3.1-3: Data structures supported by the GET Response Body on this
resource
* * *
Data type P Cardinality Response codes Description SmPolicyControl M 1 200 OK
An individual SM Policy resources for the SUPI and PDU session id are returned
successfully. NOTE: The mandatory HTTP error status codes for the GET method
listed in table 5.2.7.1-1 of 3GPP TS 29.500 [4] shall also apply.
* * *
#### 5.3.3.4 Resource Custom Operations
##### 5.3.3.4.1 Overview
Table 5.3.3.4.1-1: Custom operations
* * *
Custom operation URI Mapped HTTP method Description
{apiRoot}/\ POST Delete an individual SM Policy resource. npcf-
smpolicycontrol/\  
v1/sm-policies/{smPolicyId}/delete
{apiRoot}/\ POST Update an individual SM Policy resource. npcf-
smpolicycontrol/\  
v1/sm-policies/{smPolicyId}/update
* * *
##### 5.3.3.4.2 Operation: delete
###### 5.3.3.4.2.1 Description
###### 5.3.3.4.2.2 Operation Definition
This custom operation deletes an individual SM Policy resource in the PCF.
This operation shall support the request data structures specified in table
5.3.3.4.2.2-1 and the response data structure and response codes specified in
table 5.3.3.4.2.2-2.
Table 5.3.3.4.2.2-1: Data structures supported by the POST Request Body on
this resource
* * *
Data type P Cardinality Description SmPolicyDeleteData O 0..1 Parameters to be
sent by the SMF when the individual SM policy is deleted.
* * *
Table 5.3.3.4.2.2-2: Data structures supported by the POST Response Body on
this resource
* * *
Data type P Cardinality Response codes Description n/a 204 No Content This
case represents a successful deletion of the individual SM policy resource.
NOTE: The mandatory HTTP error status codes for the POST method listed in
table 5.2.7.1-1 of 3GPP TS 29.500 [4] shall also apply.
* * *
##### 5.3.3.4.3 Operation: update
###### 5.3.3.4.3.1 Description
###### 5.3.3.4.3.2 Operation Definition
This custom operation updates an individual SM Policy resource in the PCF.
This operation shall support the request data structures specified in table
5.3.3.4.3.2-1 and the response data structure and response codes specified in
table 5.3.3.4.3.2-2.
Table 5.3.3.4.3.2-1: Data structures supported by the POST Request Body on
this resource
* * *
Data type P Cardinality Description SmPolicyUpdateContextData M 1 Parameters
to be sent by the SMF when the individual SM policy is updated. It indicates
the occurred changes.
* * *
Table 5.3.3.4.3.2-2: Data structures supported by the POST Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | SmP | M | 1 | 200 OK | An individual | | olicyDecision | | | | SM Policy | | | | | | resources is | | | | | | updated | | | | | | successfully. | | | | | | Response body | | | | | | includes the | | | | | | policy | | | | | | decision | | | | | | changes. | +---------------+---+-------------+---------------+---------------+ | P | M | 1 | 400 Bad | (NOTE 2) | | roblemDetails | | | Request | | +---------------+---+-------------+---------------+---------------+ | P | M | 1 | 403 Forbidden | (NOTE 2) | | roblemDetails | | | | | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | shall also | | | | | | apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure cases | | | | | | are described | | | | | | in | | | | | | s | | | | | | ubclause 5.7. | | | | | +---------------+---+-------------+---------------+---------------+
## 5.4 Custom Operations without associated resources
None.
## 5.5 Notifications
### 5.5.1 General
Table 5.5.1-1: Notifications
* * *
Custom operation URI Mapped HTTP method Description {notificationUri}/update
POST Policy Update Notification. {notificationUri}/terminate POST Request for
termination of the policy association.
* * *
### 5.5.2 Policy Update Notification
#### 5.5.2.1 Description
This notification is used by the PCF to update the policy.
#### 5.5.2.2 Operation Definition
This operation shall support the request data structures specified in table
5.5.2.2-1 and the response data structure and response codes specified in
table 5.5.2.2-2.
Table 5.5.2.2-1: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description SmPolicyNotification M 1 Update the SM
policies provided by the PCF
* * *
Table 5.5.2.2-2: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | The SM | | | | | Content | policies are | | | | | | updated | | | | | | successfully. | +---------------+---+-------------+---------------+---------------+ | UeCampingRep | O | 0..1 | 200 OK | The current | | | | | | applicable | | | | | | values | | | | | | corresponding | | | | | | to the policy | | | | | | control | | | | | | request | | | | | | trigger is | | | | | | reported. | +---------------+---+-------------+---------------+---------------+ | a | O | 1..N | 200 OK | Some of the | | rray(PartialS | | | | PCC rules | | uccessReport) | | | | and/or | | | | | | session rules | | | | | | provisioned | | | | | | by the PCF | | | | | | are not | | | | | | instal | | | | | | led/activated | | | | | | successfully. | +---------------+---+-------------+---------------+---------------+ | ErrorReport | M | 1 | 400 Bad | The SM | | | | | Request | policies | | | | | | including all | | | | | | the PCC rules | | | | | | and session | | | | | | rules | | | | | | provisioned | | | | | | by the PCF | | | | | | are not | | | | | | instal | | | | | | led/activated | | | | | | successfully. | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | shall also | | | | | | apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure cases | | | | | | are described | | | | | | in | | | | | | s | | | | | | ubclause 5.7. | | | | | +---------------+---+-------------+---------------+---------------+
### 5.5.3 Request for termination of the policy association
#### 5.5.3.1 Description
This notification is used by the PCF to request the termination of a policy
association.
#### 5.5.3.2 Operation Definition
This operation shall support the request data structures specified in table
5.5.3.2-1 and the response data structure and response codes specified in
table 5.5.3.2-2.
Table 5.5.3.2-1: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description TerminationNotification M 1 Request to
terminate the policy association.
* * *
Table 5.5.3.2-2: Data structures supported by the POST Response Body on this
resource
* * *
Data type P Cardinality Response codes Description n/a 204 No Content The
request for policy association termination was received. NOTE: The mandatory
HTTP error status codes for the POST method listed in table 5.2.7.1-1 of 3GPP
TS 29.500 [4] shall also apply.
* * *
## 5.6 Data Model
### 5.6.1 General
This subclause specifies the application data model supported by the API.
The Npcf_SMPolicyControl API allows the SMF to retrieve the session management
related policy from the PCF as defined in 3GPP TS 23.503 [6].
Table 5.6.1-1 specifies the data types defined for the Npcf_SMPolicyControl
service based interface protocol.
Table 5.6.1-1: Npcf_SMPolicyControl specific Data Types
* * *
Data type Section defined Description Applicability 5GSmCause 5.6.3.2
Indicates the 5GSM cause code value. RAN-NAS-Cause AccNetChargingAddress
5.6.2.35 Identifies the address of the network node performing charging and
used for charging applications.  
AccNetChId 5.6.2.23 Contains the access network charging identifier for the
PCC rule(s) or whole PDU session.  
AccuUsageReport 5.6.2.18 Contains the accumulated usage report information.
UMC AfSigProtocol 5.6.3.10 Indicates the protocol used for signalling between
the UE and the AF. ProvAFsignalFlow AppDetectionInfo 5.6.2.22 Contains the
detected application\'s traffic information. ADC AuthorizedDefaultQos 5.6.2.34
Authorized Default QoS.  
ChargingData 5.6.2.11 Contains charging related parameters.  
ChargingInformation 5.6.2.17 Contains the addresses of the charging functions.  
ConditionData 5.6.2.9 Contains conditions for applicability of a rule.  
CreditManagementStatus 5.6.3.16 Indicates the reason of the credit management
session failure.  
EpsRanNasRelCause 5.6.3.2 Indicates the RAN or NAS release cause code
information in 3GPP-EPS access type or indicates the untrusted WLAN release
cause code information in Non-3GPP-EPS access type. RAN-NAS-Cause ErrorReport
5.6.2.36 Contains the rule reports.  
FailureCause 5.6.3.14 Indicates the cause of the failure in a Partial Success
Report.  
FailureCode 5.6.3.9 Indicates the reason of the PCC rule failure.  
FlowDescription 5.6.3.2 Defines a packet filter for an IP flow.  
FlowDirection 5.6.3.3 Indicates the direction of the service data flow.  
FlowDirectionRm 5.6.3.15 This data type is defined in the same way as the
\"FlowDirection\" data type, but with the OpenAPI \"nullable: true\" property.  
FlowInformation 5.6.2.14 Contains the flow information.  
MeteringMethod 5.6.3.5 Indicates the metering method.  
PacketFilterContent 5.6.3.2 Defines a packet filter for an IP flow.  
NetLocAccessSupport 5.6.3.18 Indicates the access network support of the
report of the requested access network information. NetLoc PacketFilterInfo
5.6.2.30 Contains the information from a single packet filter sent from the
SMF to the PCF.  
PartialSuccessReport 5.6.2.33 Includes the information reported by the SMF
when some of the PCC rules and/or session rules are not successfully
installed/activated.  
PccRule 5.6.2.6 Contains the PCC rule information.  
PolicyControlRequestTrigger 5.6.3.6 Contains the policy control request
trigger(s).  
QosCharacteristics 5.6.2.16 Contains QoS characteristics for a non-
standardized or non-configured 5QI.  
QosData 5.6.2.8 Contains the QoS parameters.  
QosFlowUsage 5.6.3.13 Indicates a QoS flow usage information.  
QosNotificationControlInfo 5.6.2.32 Contains the QoS Notification Control
Information.  
RanNasRelCause 5.6.2.28 Contains the RAN/NAS release cause. RAN-NAS-Cause
RedirectAddressType 5.6.3.12 Indicates the redirect address type. ADC
RedirectInformation 5.6.2.13 Contains the redirect information. ADC
ReportingLevel 5.6.3.4 Indicates the reporting level.  
RequestedQos 5.6.2.31 Contains the QoS information requested by the UE.  
RequestedRuleData 5.6.2.24 Contains rule data requested by the PCF to receive
information associated with PCC rules.  
RequestedRuleDataType 5.6.3.7 Contains the type of rule data requested by the
PCF.  
RequestedUsageData 5.6.2.25 Contains usage data requested by the PCF
requesting usage reports for the corresponding usage monitoring data
instances.  
RuleOperation 5.6.3.11 Indicates a UE initiated resource operation that causes
a request for PCC rules.  
RuleReport 5.6.2.27 Reports the status of PCC.  
RuleStatus 5.6.3.8 Indicates the status of PCC or session rule.  
ServingNfIdentity 5.6.2.38 Contains the serving Network Function identity.  
SessionRule 5.6.2.7 Contains session level policy information.  
SessionRuleFailureCode 5.6.3.17 Indicates the reason of the session rule
failure.  
SessionRuleReport 5.6.2.37 Reports the status of session rule.  
SmPolicyControl 5.6.2.2 Contains the parameters to request the SM policies and
the SM policies authorized by the PCF.  
SmPolicyContextData 5.6.2.3 Contains the parameters to create individual SM
policy resource.  
SmPolicyDecision 5.6.2.4 Contains the SM policies authorized by the PCF.  
SmPolicyNotification 5.6.2.5 Contains the update of the SM policies.  
SmPolicyDeleteData 5.6.2.15 Contains the parameters to be sent to the PCF when
the individual SM policy is deleted.  
SmPolicyUpdateContextData 5.6.2.19 Contains the met policy control request
trigger(s) and corresponding new value(s) or the error report of the policy
enforcement.  
TerminationNotification 5.6.2.21 Termination Notification.  
TrafficControlData 5.6.2.10 Contains parameters determining how flows
associated with a PCCRule are treated (blocked, redirected, etc).  
UeCampingRep 5.6.2.26 Contains the current applicable values corresponding to
the policy control request triggers.  
UeInitiatedResourceRequest 5.6.2.29 Indicates a UE requests specific QoS
handling for selected SDF.  
UpPathChgEvent 5.6.2.20 Contains the UP path change event subscription from
the AF. TSC UsageMonitoringData 5.6.2.12 Contains usage monitoring related
control information. UMC
* * *
Table 5.6.1-2 specifies data types re-used by the Npcf_SMPolicyControl service
based interface protocol from other specifications, including a reference to
their respective specifications and when needed, a short description of their
use within the Npcf_SMPolicyControl service based interface.
Table 5.6.1-2: Npcf_SMPolicyControl re-used Data Types
+----------------+----------------+----------------+----------------+ | Data type | Reference | Comments | Applicability | +----------------+----------------+----------------+----------------+ | 5GMmCause | 3GPP TS | Contains the | RAN-NAS-Cause | | | 29.571 [11] | cause value of | | | | | 5GMM protocol. | | +----------------+----------------+----------------+----------------+ | 5Qi | 3GPP TS | Unsigned | | | | 29.571 [11] | integer | | | | | representing a | | | | | 5G QoS | | | | | Identifier | | | | | (see | | | | | sub | | | | | clause 5.7.2.1 | | | | | of | | | | | 3GPP TS | | | | | 23.501 [2]), | | | | | within the | | | | | range 0 to | | | | | 255. | | +----------------+----------------+----------------+----------------+ | 5Q | 3GPP TS | Unsigned | | | iPriorityLevel | 29.571 [11] | integer | | | | | indicating the | | | | | 5QI Priority | | | | | Level (see | | | | | subc | | | | | lauses 5.7.3.3 | | | | | and 5.7.4 of | | | | | 3GPP TS | | | | | 23.501 [2]), | | | | | within the | | | | | range 1 to | | | | | 127. | | | | | | | | | | Values are | | | | | ordered in | | | | | decreasing | | | | | order of | | | | | priority, i.e. | | | | | with 1 as the | | | | | highest | | | | | priority and | | | | | 127 as the | | | | | lowest | | | | | priority. | | +----------------+----------------+----------------+----------------+ | 5QiP | 3GPP TS | This data type | | | riorityLevelRm | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \"5QiP | | | | | riorityLevel\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | AccessType | 3GPP TS | The | | | | 29.571 [11] | identification | | | | | of the type of | | | | | access | | | | | network. | | +----------------+----------------+----------------+----------------+ | Ambr | 3GPP TS | Session AMBR. | | | | 29.571 [11] | | | +----------------+----------------+----------------+----------------+ | AnGwAddress | 3GPP TS | Carries the | | | | 29.514 [17] | control plane | | | | | address of the | | | | | access network | | | | | gateway. | | | | | (NOTE) | | +----------------+----------------+----------------+----------------+ | Applica | 3GPP TS | Application | AF_Chargi | | tionChargingId | 29.571 [11] | provided | ng_Identifier | | | | charging | | | | | identifier | | | | | allowing | | | | | correlation of | | | | | charging | | | | | information. | | +----------------+----------------+----------------+----------------+ | Arp | 3GPP TS | ARP. | | | | 29.571 [11] | | | +----------------+----------------+----------------+----------------+ | AverWindow | 3GPP TS | Averaging | | | | 29.571 [11] | Window. | | +----------------+----------------+----------------+----------------+ | AverWindowRm | 3GPP TS | This data type | | | | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \"AverWindow\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | BitRate | 3GPP TS | String | | | | 29.571 [11] | representing a | | | | | bit rate that | | | | | shall be | | | | | formatted as | | | | | follows: | | | | | | | | | | pattern: | | | | | \"\^ | | | | | \d+(\\.\d+)? | | | | | (bps\ | | | | | |Kbps\|Mbps\|G | | | | | bps\|Tbps)\$\" | | | | | | | | | | Examples: | | | | | | | | | | \"125 Mbps\", | | | | | \"0.125 | | | | | Gbps\", | | | | | \"125000 | | | | | Kbps\". | | +----------------+----------------+----------------+----------------+ | BitRateRm | 3GPP TS | This data type | | | | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \"BitRate\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | ChargingId | 3GPP TS | Charging | | | | 29.571 [11] | identifier | | | | | allowing | | | | | correlation of | | | | | charging | | | | | information. | | +----------------+----------------+----------------+----------------+ | ContentVersion | 3GPP TS | Indicates the | RuleVersioning | | | 29.514 [17] | content | | | | | version of a | | | | | PCC rule. It | | | | | uniquely | | | | | identifies a | | | | | version of the | | | | | PCC rule as | | | | | defined in | | | | | subclau | | | | | se 4.2.6.2.14. | | +----------------+----------------+----------------+----------------+ | DateTime | 3GPP TS | String with | | | | 29.571 [11] | format | | | | | \"date-time\" | | | | | as defined in | | | | | O | | | | | penAPI Specifi | | | | | cation [10]. | | +----------------+----------------+----------------+----------------+ | DateTimeRm | 3GPP TS | This data type | | | | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \"DateTime\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | DnaiChangeType | 3GPP TS | Describes the | | | | 29.571 [11] | types of DNAI | | | | | change. | | +----------------+----------------+----------------+----------------+ | Dnn | 3GPP TS | The DNN the | | | | 29.571 [11] | user is | | | | | connected to. | | +----------------+----------------+----------------+----------------+ | DurationSec | 3GPP TS | Identifies a | | | | 29.571 [11] | period of time | | | | | in units of | | | | | seconds. | | +----------------+----------------+----------------+----------------+ | DurationSecRm | 3GPP TS | This data type | | | | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \ | | | | | "DurationSec\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | EthF | 3GPP TS | Defines a | | | lowDescription | 29.514 [17] | packet filter | | | | | for an | | | | | Ethernet flow. | | +----------------+----------------+----------------+----------------+ | F | 3GPP TS | Indicates the | | | inalUnitAction | 32.291 [19] | action to be | | | | | taken when the | | | | | user\'s | | | | | account cannot | | | | | cover the | | | | | service cost. | | +----------------+----------------+----------------+----------------+ | FlowStatus | 3GPP TS | Describes | | | | 29.514 [17] | whether the IP | | | | | flow(s) are | | | | | enabled or | | | | | disabled. The | | | | | value | | | | | \"REMOVED\" is | | | | | not applicable | | | | | to | | | | | Npcf_S | | | | | MPolicyControl | | | | | service. | | +----------------+----------------+----------------+----------------+ | Gpsi | 3GPP TS | Identifies a | | | | 29.571 [11] | GPSI. | | +----------------+----------------+----------------+----------------+ | GroupId | 3GPP TS | Identifies a | | | | 29.571 [11] | group of | | | | | internal | | | | | globally | | | | | unique ID. | | +----------------+----------------+----------------+----------------+ | Guami | 3GPP TS | Globally | | | | 29.571 [11] | Unique AMF | | | | | Identifier. | | +----------------+----------------+----------------+----------------+ | IpIndex | 3GPP TS | Information | | | | 29.519 [15] | that | | | | | identifies | | | | | which IP pool | | | | | or external | | | | | server is used | | | | | to allocate | | | | | the IP | | | | | address. | | +----------------+----------------+----------------+----------------+ | Ipv4Addr | 3GPP TS | Identifies an | | | | 29.571 [11] | Ipv4 address. | | +----------------+----------------+----------------+----------------+ | Ipv6Addr | 3GPP TS | Identifies an | | | | 29.571 [11] | IPv6 address. | | +----------------+----------------+----------------+----------------+ | Ipv6Prefix | 3GPP TS | The Ipv6 | | | | 29.571 [11] | prefix | | | | | allocated for | | | | | the user. | | +----------------+----------------+----------------+----------------+ | MacAddr48 | 3GPP TS | MAC Address. | | | | 29.571 [11] | | | +----------------+----------------+----------------+----------------+ | M | 3GPP TS | Maximum Data | | | axDataBurstVol | 29.571 [11] | Burst Volume. | | +----------------+----------------+----------------+----------------+ | Max | 3GPP TS | This data type | | | DataBurstVolRm | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \"Max | | | | | DataBurstVol\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | NetworkId | 3GPP TS | The | | | | 29.571 [11] | identification | | | | | of the | | | | | Network. | | +----------------+----------------+----------------+----------------+ | NfInstanceId | 3GPP TS | The NF | | | | 29.571 [11] | instance | | | | | identifier. | | +----------------+----------------+----------------+----------------+ | NgApCause | 3GPP TS | Contains the | RAN-NAS-Cause | | | 29.571 [11] | cause value of | | | | | NgAP protocol. | | +----------------+----------------+----------------+----------------+ | P | 3GPP TS | Packet Delay | | | acketDelBudget | 29.571 [11] | Budget. | | +----------------+----------------+----------------+----------------+ | PacketErrRate | 3GPP TS | Packet Error | | | | 29.571 [11] | Rate. | | +----------------+----------------+----------------+----------------+ | Pa | 3GPP TS | This data type | | | cketLossRateRm | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \"Pa | | | | | cketLossRate\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | PduSessionId | 3GPP TS | The | | | | 29.571 [11] | identification | | | | | of the PDU | | | | | session. | | +----------------+----------------+----------------+----------------+ | PduSessionType | 3GPP TS | Indicate the | | | | 29.571 [11] | type of a PDU | | | | | session. | | +----------------+----------------+----------------+----------------+ | Pei | 3GPP TS | The | | | | 29.571 [11] | Identification | | | | | of a Permanent | | | | | Equipment. | | +----------------+----------------+----------------+----------------+ | P | 3GPP TS | The cause why | | | olicyAssociati | 29.507 [25] | the PCF | | | onReleaseCause | | requests the | | | | | termination of | | | | | the policy | | | | | association. | | +----------------+----------------+----------------+----------------+ | PresenceInfo | 3GPP TS | Contains the | PRA | | | 29.571 [11] | information | | | | | which | | | | | describes a | | | | | Presence | | | | | Reporting | | | | | Area. | | +----------------+----------------+----------------+----------------+ | PresenceInfoRm | 3GPP TS | This data type | PRA | | | 29.571 [11] | is defined in | | | | | the same way | | | | | as the | | | | | \" | | | | | PresenceInfo\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | ProblemDetails | 3GPP TS | Contains a | | | | 29.571 [11] | detailed | | | | | information | | | | | about an | | | | | error. | | +----------------+----------------+----------------+----------------+ | QosNotifType | 3GPP TS | Indicates | | | | 29.514 [17] | whether the | | | | | GBR targets | | | | | for the | | | | | indicated SDFs | | | | | are | | | | | \"NOT | | | | | _GUARANTEED\" | | | | | or | | | | | \"GUARANTEED\" | | | | | again. | | +----------------+----------------+----------------+----------------+ | Q | 3GPP TS | Indicates | | | osResourceType | 29.571 [11] | whether the | | | | | resource type | | | | | is GBR, delay | | | | | critical GBR, | | | | | or non-GBR. | | +----------------+----------------+----------------+----------------+ | RatingGroup | 3GPP TS | Identifier of | | | | 29.571 [11] | a rating | | | | | group. | | +----------------+----------------+----------------+----------------+ | RatType | 3GPP TS | The | | | | 29.571 [11] | identification | | | | | of the RAT | | | | | type. | | +----------------+----------------+----------------+----------------+ | R | 3GPP TS | A traffic | TSC | | outeToLocation | 29.571 [11] | routes to | | | | | applications | | | | | location. | | +----------------+----------------+----------------+----------------+ | ServiceId | 3GPP TS | Identifier of | | | | 29.571 [11] | a service. | | +----------------+----------------+----------------+----------------+ | Snssai | 3GPP TS | Identifies the | | | | 29.571 [11] | S-NSSAI. | | +----------------+----------------+----------------+----------------+ | Subscr | 3GPP TS | Subscribed | | | ibedDefaultQos | 29.571 [11] | Default QoS. | | +----------------+----------------+----------------+----------------+ | Supi | 3GPP TS | The | | | | 29.571 [11] | identification | | | | | of the user | | | | | (i.e. IMSI, | | | | | NAI). | | +----------------+----------------+----------------+----------------+ | Sup | 3GPP TS | Used to | | | portedFeatures | 29.571 [11] | negotiate the | | | | | applicability | | | | | of the | | | | | optional | | | | | features | | | | | defined in | | | | | table 5.8-1. | | +----------------+----------------+----------------+----------------+ | TraceData | 3GPP TS | | | | | 29.571 [11] | | | +----------------+----------------+----------------+----------------+ | TimeZone | 3GPP TS | Contains the | | | | 29.571 [11] | user time zone | | | | | information. | | +----------------+----------------+----------------+----------------+ | Uri | 3GPP TS | URI. | | | | 29.571 [11] | | | +----------------+----------------+----------------+----------------+ | UserLocation | 3GPP TS | Contains the | | | | 29.571 [11] | user location. | | +----------------+----------------+----------------+----------------+ | Volume | 3GPP TS | Unsigned | | | | 29.122 [32] | integer | | | | | identifying a | | | | | volume in | | | | | units of | | | | | bytes. | | +----------------+----------------+----------------+----------------+ | VolumeRm | 3GPP TS | This data type | | | | 29.122 [32] | is defined in | | | | | the same way | | | | | as the | | | | | \"Volume\" | | | | | data type, but | | | | | with the | | | | | OpenAPI | | | | | \"nullable: | | | | | true\" | | | | | property. | | +----------------+----------------+----------------+----------------+ | NOTE: | | | | | \"AnGwAddr\" | | | | | data structure | | | | | is only | | | | | applicable to | | | | | the 5GS and | | | | | EPC/E-UTRAN | | | | | interworking | | | | | scenario as | | | | | defined in | | | | | Annex B. | | | | +----------------+----------------+----------------+----------------+
### 5.6.2 Structured data types
#### 5.6.2.1 Introduction
This subclause defines the structures to be used in resource representations.
#### 5.6.2.2 Type SmPolicyControl
Table 5.6.2.2-1: Definition of type SmPolicyControl
* * *
Attribute name Data type P Cardinality Description Applicability context
SmPolicyContextData M 1 Includes the parameters to request the SM policies by
the SMF.  
policy SmPolicyDecision M 1 Includes the SM policies authorized by the PCF.
* * *
#### 5.6.2.3 Type SmPolicyContextData
Table 5.6.2.3-1: Definition of type SmPolicyContextData
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | a | A | O | 0..1 | Indicates | | | ccNetChId | ccNetChId | | | the | | | | | | | access | | | | | | | network | | | | | | | charging | | | | | | | i | | | | | | | dentifier | | | | | | | for | | | | | | | default | | | | | | | QoS flow | | | | | | | or whole | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | chargE | Acc | O | 0..1 | Address | | | ntityAddr | NetChargi | | | of the | | | | ngAddress | | | network | | | | | | | entity | | | | | | | p | | | | | | | erforming | | | | | | | charging. | | +-----------+-----------+---+-----------+-----------+-----------+ | gpsi | Gpsi | O | 0..1 | Gpsi | | | | | | | shall | | | | | | | contain | | | | | | | either an | | | | | | | External | | | | | | | Id or an | | | | | | | MSISDN. | | +-----------+-----------+---+-----------+-----------+-----------+ | supi | Supi | M | 1 | Sub | | | | | | | scription | | | | | | | Permanent | | | | | | | Id | | | | | | | entifier. | | | | | | | | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | in | boolean | C | 0..1 | When this | | | validSupi | | | | attribute | | | | | | | is | | | | | | | included | | | | | | | and set | | | | | | | to true, | | | | | | | it | | | | | | | indicates | | | | | | | that the | | | | | | | \"supi\" | | | | | | | attribute | | | | | | | contains | | | | | | | an | | | | | | | invalid | | | | | | | value. | | | | | | | This | | | | | | | attribute | | | | | | | shall be | | | | | | | present | | | | | | | if the | | | | | | | SUPI is | | | | | | | not | | | | | | | available | | | | | | | in the | | | | | | | SMF, or | | | | | | | the SUPI | | | | | | | is | | | | | | | unauthe | | | | | | | nticated. | | | | | | | | | | | | | | When | | | | | | | present | | | | | | | it shall | | | | | | | be set as | | | | | | | follows: | | | | | | | | | | | | | | - true: | | | | | | | invalid | | | | | | | SUPI. | | | | | | | | | | | | | | - false | | | | | | | ( | | | | | | | default): | | | | | | | valid | | | | | | | SUPI. | | +-----------+-----------+---+-----------+-----------+-----------+ | pdu | Pdu | M | 1 | PDU | | | SessionId | SessionId | | | session | | | | | | | Id. | | +-----------+-----------+---+-----------+-----------+-----------+ | dnn | Dnn | M | 1 | The DNN | | | | | | | of the | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | in | array | O | 1..N | The | | | terGrpIds | (GroupId) | | | internal | | | | | | | Group | | | | | | | Id(s). | | +-----------+-----------+---+-----------+-----------+-----------+ | notifi | Uri | M | 1 | I | | | cationUri | | | | dentifies | | | | | | | the | | | | | | | recipient | | | | | | | of SM | | | | | | | policies | | | | | | | update | | | | | | | noti | | | | | | | fications | | | | | | | sent by | | | | | | | the PCF. | | +-----------+-----------+---+-----------+-----------+-----------+ | pduSe | PduSe | M | 1 | Indicates | | | ssionType | ssionType | | | the type | | | | | | | of a PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | a | A | O | 0..1 | The | | | ccessType | ccessType | | | Access | | | | | | | Type | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | ratType | RatType | O | 0..1 | The RAT | | | | | | | Type | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | servi | NetworkId | O | 0..1 | The | | | ngNetwork | | | | serving | | | | | | | network | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | userLoc | Use | O | 0..1 | The | | | ationInfo | rLocation | | | location | | | | | | | of the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | u | TimeZone | O | 0..1 | The time | | | eTimeZone | | | | zone | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | pei | Pei | O | 0..1 | The | | | | | | | Permanent | | | | | | | Equipment | | | | | | | I | | | | | | | dentifier | | | | | | | of the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | ip | Ipv4Addr | O | 0..1 | The IPv4 | | | v4Address | | | | Address | | | | | | | of the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | ipv6Addr | I | O | 0..1 | The Ipv6 | | | essPrefix | pv6Prefix | | | Address | | | | | | | Prefix of | | | | | | | the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | ipDomain | string | O | 0..1 | IPv4 | | | | | | | address | | | | | | | domain | | | | | | | id | | | | | | | entifier. | | | | | | | | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | sub | Ambr | O | 0..1 | S | | | sSessAmbr | | | | ubscribed | | | | | | | Sess | | | | | | | ion-AMBR. | | +-----------+-----------+---+-----------+-----------+-----------+ | s | Su | O | 0..1 | S | | | ubsDefQos | bscribedD | | | ubscribed | | | | efaultQos | | | Default | | | | | | | QoS | | | | | | | Inf | | | | | | | ormation. | | +-----------+-----------+---+-----------+-----------+-----------+ | numOfP | integer | O | 0..1 | Contains | | | ackFilter | | | | the | | | | | | | number of | | | | | | | supported | | | | | | | packet | | | | | | | filter | | | | | | | for | | | | | | | signalled | | | | | | | QoS | | | | | | | rules. | | +-----------+-----------+---+-----------+-----------+-----------+ | online | boolean | O | 0..1 | If it is | | | | | | | included | | | | | | | and set | | | | | | | to true, | | | | | | | the | | | | | | | online | | | | | | | charging | | | | | | | is | | | | | | | applied | | | | | | | to the | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | offline | boolean | O | 0..1 | If it is | | | | | | | included | | | | | | | and set | | | | | | | to true, | | | | | | | the | | | | | | | offline | | | | | | | charging | | | | | | | is | | | | | | | applied | | | | | | | to the | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | charg | string | O | 0..1 | Contains | | | ingCharac | | | | the | | | teristics | | | | Charging | | | | | | | Charac | | | | | | | teristics | | | | | | | applied | | | | | | | to the | | | | | | | PDU | | | | | | | session. | | | | | | | F | | | | | | | unctional | | | | | | | req | | | | | | | uirements | | | | | | | for the | | | | | | | Charging | | | | | | | Charac | | | | | | | teristics | | | | | | | are | | | | | | | defined | | | | | | | in | | | | | | | 3GP | | | | | | | P TS 32.2 | | | | | | | 55 [35] | | | | | | | Annex A. | | | | | | | | | | | | | | The | | | | | | | charging | | | | | | | charac | | | | | | | teristics | | | | | | | are | | | | | | | encoded | | | | | | | as | | | | | | | specified | | | | | | | in | | | | | | | 3GPP | | | | | | | TS 29.50 | | | | | | | 3 [34]. | | +-----------+-----------+---+-----------+-----------+-----------+ | 3 | boolean | O | 0..1 | If it is | | | gppPsData | | | | included | | | OffStatus | | | | and set | | | | | | | to true, | | | | | | | the 3GPP | | | | | | | PS Data | | | | | | | Off is | | | | | | | activated | | | | | | | by the | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | refQosI | boolean | O | 0..1 | If it is | | | ndication | | | | included | | | | | | | and set | | | | | | | to true, | | | | | | | the | | | | | | | r | | | | | | | eflective | | | | | | | QoS is | | | | | | | supported | | | | | | | by the | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | sliceInfo | Snssai | M | 1 | I | | | | | | | dentifies | | | | | | | the | | | | | | | S-NSSAI. | | +-----------+-----------+---+-----------+-----------+-----------+ | qos | Qos | O | 0..1 | Indicates | | | FlowUsage | FlowUsage | | | the | | | | | | | required | | | | | | | usage for | | | | | | | default | | | | | | | QoS flow. | | +-----------+-----------+---+-----------+-----------+-----------+ | servNfId | ServingN | O | 0..1 | Contains | | | | fIdentity | | | the | | | | | | | serving | | | | | | | network | | | | | | | function | | | | | | | identity. | | +-----------+-----------+---+-----------+-----------+-----------+ | suppFeat | Supporte | C | 0..1 | Indicates | | | | dFeatures | | | the list | | | | | | | of | | | | | | | Supported | | | | | | | features | | | | | | | used as | | | | | | | described | | | | | | | in | | | | | | | subcl | | | | | | | ause 5.8. | | | | | | | | | | | | | | This | | | | | | | parameter | | | | | | | shall be | | | | | | | supplied | | | | | | | by the NF | | | | | | | service | | | | | | | consumer | | | | | | | in the | | | | | | | POST | | | | | | | request | | | | | | | that | | | | | | | requested | | | | | | | the | | | | | | | creation | | | | | | | of an | | | | | | | i | | | | | | | ndividual | | | | | | | SM policy | | | | | | | resource. | | +-----------+-----------+---+-----------+-----------+-----------+ | traceReq | TraceData | O | 0..1 | Trace | | | | | | | control | | | | | | | and | | | | | | | conf | | | | | | | iguration | | | | | | | p | | | | | | | arameters | | | | | | | in | | | | | | | formation | | | | | | | defined | | | | | | | in | | | | | | | 3GPP | | | | | | | TS 32.42 | | | | | | | 2 [24]. | | +-----------+-----------+---+-----------+-----------+-----------+ | smfId | NfI | O | 0..1 | SMF | | | | nstanceId | | | instance | | | | | | | id | | | | | | | entifier. | | +-----------+-----------+---+-----------+-----------+-----------+ | rec | DateTime | O | 0..1 | It | | | overyTime | | | | includes | | | | | | | the | | | | | | | recovery | | | | | | | time of | | | | | | | the SMF. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | The value | | | | | | | provided | | | | | | | in this | | | | | | | attribute | | | | | | | is | | | | | | | imple | | | | | | | mentation | | | | | | | specific. | | | | | | | The only | | | | | | | c | | | | | | | onstraint | | | | | | | is that | | | | | | | the SMF | | | | | | | shall | | | | | | | supply a | | | | | | | different | | | | | | | i | | | | | | | dentifier | | | | | | | for each | | | | | | | ov | | | | | | | erlapping | | | | | | | address | | | | | | | domain | | | | | | | (e.g. the | | | | | | | SMF NF | | | | | | | instance | | | | | | | ide | | | | | | | ntifier). | | | | | | | | | | | | | | NOTE 2: | | | | | | | For an | | | | | | | emergency | | | | | | | session, | | | | | | | when the | | | | | | | SUPI is | | | | | | | not | | | | | | | available | | | | | | | in the | | | | | | | SMF, or | | | | | | | if | | | | | | | a | | | | | | | vailable, | | | | | | | the SUPI | | | | | | | is | | | | | | | unauthe | | | | | | | nticated, | | | | | | | the value | | | | | | | provided | | | | | | | in the | | | | | | | \"supi\" | | | | | | | attribute | | | | | | | is | | | | | | | imple | | | | | | | mentation | | | | | | | specific. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.4 Type SmPolicyDecision
Table 5.6.2.4-1: Definition of type SmPolicyDecision
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | sessRules | map(Ses | O | 1..N | A map of | | | | sionRule) | | | Ses | | | | | | | sionrules | | | | | | | with the | | | | | | | content | | | | | | | being the | | | | | | | Se | | | | | | | ssionRule | | | | | | | as | | | | | | | described | | | | | | | in | | | | | | | subclause | | | | | | | 5.6.2.7. | | | | | | | The key | | | | | | | used in | | | | | | | this map | | | | | | | for each | | | | | | | entry is | | | | | | | the | | | | | | | s | | | | | | | essRuleId | | | | | | | attribute | | | | | | | of the | | | | | | | corr | | | | | | | esponding | | | | | | | Ses | | | | | | | sionRule. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | pccRules | map | O | 1..N | A map of | | | | (PccRule) | | | PCC rules | | | | | | | with the | | | | | | | content | | | | | | | being the | | | | | | | PCCRule | | | | | | | as | | | | | | | described | | | | | | | in | | | | | | | subclause | | | | | | | 5.6.2.6. | | | | | | | The key | | | | | | | used in | | | | | | | this map | | | | | | | for each | | | | | | | entry is | | | | | | | the | | | | | | | pccRuleId | | | | | | | attribute | | | | | | | of the | | | | | | | corr | | | | | | | esponding | | | | | | | PccRule. | | +-----------+-----------+---+-----------+-----------+-----------+ | qosDecs | map | O | 1..N | Map of | | | | (QosData) | | | QoS data | | | | | | | policy | | | | | | | d | | | | | | | ecisions. | | | | | | | The key | | | | | | | used in | | | | | | | this map | | | | | | | for each | | | | | | | entry is | | | | | | | the qosId | | | | | | | attribute | | | | | | | of the | | | | | | | corr | | | | | | | esponding | | | | | | | QosData. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | chgDecs | map(Char | O | 1..N | Map of | | | | gingData) | | | Charging | | | | | | | data | | | | | | | policy | | | | | | | d | | | | | | | ecisions. | | | | | | | The key | | | | | | | used in | | | | | | | this map | | | | | | | for each | | | | | | | entry is | | | | | | | the chgId | | | | | | | attribute | | | | | | | of the | | | | | | | corr | | | | | | | esponding | | | | | | | Char | | | | | | | gingData. | | +-----------+-----------+---+-----------+-----------+-----------+ | cha | C | C | 1 | Contains | | | rgingInfo | hargingIn | | | the CHF | | | | formation | | | addresses | | | | | | | of the | | | | | | | PDU | | | | | | | session. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | traf | map(T | O | 1..N | Map of | | | fContDecs | rafficCon | | | Traffic | | | | trolData) | | | Control | | | | | | | data | | | | | | | policy | | | | | | | d | | | | | | | ecisions. | | | | | | | The key | | | | | | | used in | | | | | | | this map | | | | | | | for each | | | | | | | entry is | | | | | | | the tcId | | | | | | | attribute | | | | | | | of the | | | | | | | corr | | | | | | | esponding | | | | | | | T | | | | | | | rafficCon | | | | | | | trolData. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | umDecs | map(Us | O | 1..N | Map of | | | | ageMonito | | | Usage | | | | ringData) | | | M | | | | | | | onitoring | | | | | | | data | | | | | | | policy | | | | | | | d | | | | | | | ecisions. | | | | | | | The key | | | | | | | used in | | | | | | | this map | | | | | | | for each | | | | | | | entry is | | | | | | | the umId | | | | | | | attribute | | | | | | | of the | | | | | | | corr | | | | | | | esponding | | | | | | | Us | | | | | | | ageMonito | | | | | | | ringData. | | +-----------+-----------+---+-----------+-----------+-----------+ | qosChars | map(Q | O | 1..N | Map of | | | | osCharact | | | QoS | | | | eristics) | | | charac | | | | | | | teristics | | | | | | | for | | | | | | | non | | | | | | | -standard | | | | | | | 5QIs and | | | | | | | non-prec | | | | | | | onfigured | | | | | | | 5QIs. | | | | | | | This map | | | | | | | uses the | | | | | | | 5QI | | | | | | | values as | | | | | | | keys. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | reflectiv | Du | O | 0..1 | Defines | | | eQoSTimer | rationSec | | | the | | | | | | | lifetime | | | | | | | of a UE | | | | | | | derived | | | | | | | QoS rule | | | | | | | belonging | | | | | | | to the | | | | | | | PDU | | | | | | | Session | | | | | | | for | | | | | | | r | | | | | | | eflective | | | | | | | QoS. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | offline | boolean | O | 0..1 | Indicates | | | | | | | the | | | | | | | offline | | | | | | | charging | | | | | | | is | | | | | | | a | | | | | | | pplicable | | | | | | | to the | | | | | | | PDU | | | | | | | session | | | | | | | when it | | | | | | | is | | | | | | | included | | | | | | | and set | | | | | | | to true. | | | | | | | (NOTE 3) | | | | | | | (NOTE 4) | | +-----------+-----------+---+-----------+-----------+-----------+ | online | boolean | O | 0..1 | Indicates | | | | | | | the | | | | | | | online | | | | | | | charging | | | | | | | is | | | | | | | a | | | | | | | pplicable | | | | | | | to the | | | | | | | PDU | | | | | | | session | | | | | | | when it | | | | | | | is | | | | | | | included | | | | | | | and set | | | | | | | to true. | | | | | | | (NOTE 3) | | | | | | | (NOTE 4) | | +-----------+-----------+---+-----------+-----------+-----------+ | conds | map(Condi | O | 1..N | A map of | | | | tionData) | | | condition | | | | | | | data with | | | | | | | the | | | | | | | content | | | | | | | being as | | | | | | | described | | | | | | | in | | | | | | | subclause | | | | | | | 5.6.2.9. | | | | | | | The key | | | | | | | used in | | | | | | | this map | | | | | | | for each | | | | | | | entry is | | | | | | | the | | | | | | | condId | | | | | | | attribute | | | | | | | of the | | | | | | | corr | | | | | | | esponding | | | | | | | Condi | | | | | | | tionData. | | +-----------+-----------+---+-----------+-----------+-----------+ | revalid | DateTime | O | 0..1 | Defines | | | ationTime | | | | the time | | | | | | | before | | | | | | | which the | | | | | | | SMF shall | | | | | | | have to | | | | | | | r | | | | | | | e-request | | | | | | | PCC | | | | | | | rules. | | +-----------+-----------+---+-----------+-----------+-----------+ | p | boolean | O | 0..1 | If this | PC | | cscfRestI | | | | attribute | SCF-Resto | | ndication | | | | is | ration-En | | | | | | included | hancement | | | | | | and set | | | | | | | to true, | | | | | | | it | | | | | | | indicates | | | | | | | that the | | | | | | | P-CSCF | | | | | | | Re | | | | | | | storation | | | | | | | is | | | | | | | r | | | | | | | equested. | | | | | | | The | | | | | | | default | | | | | | | value | | | | | | | \"FALSE\" | | | | | | | applies, | | | | | | | if the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | and has | | | | | | | not been | | | | | | | supplied | | | | | | | pr | | | | | | | eviously. | | +-----------+-----------+---+-----------+-----------+-----------+ | pol | array(P | O | 1..N | Defines | | | icyCtrlRe | olicyCont | | | the | | | qTriggers | rolReques | | | policy | | | | tTrigger) | | | control | | | | | | | request | | | | | | | triggers | | | | | | | s | | | | | | | ubscribed | | | | | | | by the | | | | | | | PCF. | | +-----------+-----------+---+-----------+-----------+-----------+ | lastRe | array( | O | 1..N | Defines | | | qRuleData | Requested | | | the last | | | | RuleData) | | | list of | | | | | | | rule | | | | | | | control | | | | | | | data | | | | | | | requested | | | | | | | by the | | | | | | | PCF. | | +-----------+-----------+---+-----------+-----------+-----------+ | lastReq | Requested | O | 0..1 | Defines | | | UsageData | UsageData | | | the last | | | | | | | requested | | | | | | | usage | | | | | | | data by | | | | | | | the PCF. | | +-----------+-----------+---+-----------+-----------+-----------+ | praInfos | m | O | 1..N | Defines | PRA | | | ap(Presen | | | the PRA | | | | ceInfoRm) | | | in | | | | | | | formation | | | | | | | pr | | | | | | | ovisioned | | | | | | | by the | | | | | | | PCF. The | | | | | | | \"praId\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall | | | | | | | also be | | | | | | | the key | | | | | | | of the | | | | | | | map. The | | | | | | | \"presen | | | | | | | ceState\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall not | | | | | | | be | | | | | | | supplied. | | +-----------+-----------+---+-----------+-----------+-----------+ | ipv4Index | IpIndex | C | 0..1 | In | | | | | | | formation | | | | | | | that | | | | | | | i | | | | | | | dentifies | | | | | | | the IP | | | | | | | address | | | | | | | a | | | | | | | llocation | | | | | | | method | | | | | | | for IPv4 | | | | | | | address | | | | | | | al | | | | | | | location. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | ipv6Index | IpIndex | C | 0..1 | In | | | | | | | formation | | | | | | | that | | | | | | | i | | | | | | | dentifies | | | | | | | the IP | | | | | | | address | | | | | | | a | | | | | | | llocation | | | | | | | method | | | | | | | for IPv6 | | | | | | | address | | | | | | | al | | | | | | | location. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | qos | Qos | O | 0..1 | Indicates | | | FlowUsage | FlowUsage | | | the | | | | | | | required | | | | | | | usage for | | | | | | | default | | | | | | | QoS flow. | | +-----------+-----------+---+-----------+-----------+-----------+ | suppFeat | Supporte | C | 0..1 | Indicates | | | | dFeatures | | | the list | | | | | | | of | | | | | | | n | | | | | | | egotiated | | | | | | | supported | | | | | | | features. | | | | | | | | | | | | | | This | | | | | | | parameter | | | | | | | shall be | | | | | | | supplied | | | | | | | by the | | | | | | | PCF in | | | | | | | the | | | | | | | response | | | | | | | to the | | | | | | | POST | | | | | | | request | | | | | | | that | | | | | | | requested | | | | | | | the | | | | | | | creation | | | | | | | of an | | | | | | | i | | | | | | | ndividual | | | | | | | SM policy | | | | | | | resource. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | For | | | | | | | IPv4v6 | | | | | | | PDU | | | | | | | session, | | | | | | | both the | | | | | | | \"ip | | | | | | | v4Index\" | | | | | | | attribute | | | | | | | and | | | | | | | \"ip | | | | | | | v6Index\" | | | | | | | attribute | | | | | | | may be | | | | | | | pr | | | | | | | ovisioned | | | | | | | by the | | | | | | | PCF. | | | | | | | | | | | | | | NOTE 2: | | | | | | | This | | | | | | | attribute | | | | | | | shall not | | | | | | | be | | | | | | | removed | | | | | | | if it was | | | | | | | pro | | | | | | | visioned. | | | | | | | | | | | | | | NOTE 3: | | | | | | | This | | | | | | | attribute | | | | | | | may only | | | | | | | be | | | | | | | supplied | | | | | | | by the | | | | | | | PCF in | | | | | | | the | | | | | | | response | | | | | | | to the | | | | | | | POST | | | | | | | request | | | | | | | that | | | | | | | requested | | | | | | | the | | | | | | | creation | | | | | | | of an | | | | | | | i | | | | | | | ndividual | | | | | | | SM policy | | | | | | | resource. | | | | | | | | | | | | | | NOTE 4: | | | | | | | If both | | | | | | | the | | | | | | | \" | | | | | | | offline\" | | | | | | | attribute | | | | | | | and the | | | | | | | \ | | | | | | | "online\" | | | | | | | attribute | | | | | | | is | | | | | | | omitted | | | | | | | by the | | | | | | | PCF, the | | | | | | | default | | | | | | | charging | | | | | | | method | | | | | | | pre-c | | | | | | | onfigured | | | | | | | at the | | | | | | | SMF if | | | | | | | available | | | | | | | shall be | | | | | | | applied | | | | | | | to the | | | | | | | PDU | | | | | | | session. | | | | | | | If both | | | | | | | offline | | | | | | | and | | | | | | | online | | | | | | | charging | | | | | | | methods | | | | | | | are | | | | | | | pre-c | | | | | | | onfigured | | | | | | | at the | | | | | | | SMF, the | | | | | | | SMF shall | | | | | | | determine | | | | | | | either of | | | | | | | them to | | | | | | | be | | | | | | | applied | | | | | | | to the | | | | | | | PDU | | | | | | | session | | | | | | | based on | | | | | | | local | | | | | | | policy. | | | | | | | The | | | | | | | "offline" | | | | | | | attribute | | | | | | | and the | | | | | | | "online" | | | | | | | attribute | | | | | | | shall not | | | | | | | be | | | | | | | simul | | | | | | | taneously | | | | | | | present | | | | | | | with the | | | | | | | same | | | | | | | value, | | | | | | | i.e., | | | | | | | both set | | | | | | | to true | | | | | | | or both | | | | | | | set to | | | | | | | false. | | | | | | | | | | | | | | NOTE 5: | | | | | | | If the | | | | | | | \"charg | | | | | | | ingInfo\" | | | | | | | attribute | | | | | | | is not | | | | | | | supplied | | | | | | | by the | | | | | | | PCF, the | | | | | | | charging | | | | | | | in | | | | | | | formation | | | | | | | c | | | | | | | onfigured | | | | | | | at the | | | | | | | SMF shall | | | | | | | be | | | | | | | applied | | | | | | | to the | | | | | | | PDU | | | | | | | session. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.5 Type SmPolicyNotification
Table 5.6.2.5-1: Definition of type SmPolicyNotification
* * *
Attribute name Data type P Cardinality Description Applicability resourceUri
Uri M 1 The resource URI of the individual SM policy related to the
notification.  
smPolicyDecision SmPolicyDecision M 1 Session management policy (see subclause
5.6.2.4).
* * *
#### 5.6.2.6 Type PccRule
Table 5.6.2.6-1: Definition of type PccRule
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | flowInfos | arra | C | 1..N | An array | | | | y(FlowInf | | | of | | | | ormation) | | | Ethernet | | | | | | | or IP | | | | | | | flow | | | | | | | packet | | | | | | | filter | | | | | | | inf | | | | | | | ormation. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | appId | string | C | 0..1 | A | ADC | | | | | | reference | | | | | | | to the | | | | | | | ap | | | | | | | plication | | | | | | | detection | | | | | | | filter | | | | | | | c | | | | | | | onfigured | | | | | | | at the | | | | | | | UPF. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | contVer | Conte | O | 0..1 | Indicates | RuleV | | | ntVersion | | | the | ersioning | | | | | | content | | | | | | | version | | | | | | | of the | | | | | | | PCC rule. | | +-----------+-----------+---+-----------+-----------+-----------+ | pccRuleId | string | M | 1 | U | | | | | | | nivocally | | | | | | | i | | | | | | | dentifies | | | | | | | the PCC | | | | | | | rule | | | | | | | within a | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | p | Uinteger | O | 0..1 | D | | | recedence | | | | etermines | | | | | | | the order | | | | | | | in which | | | | | | | this PCC | | | | | | | rule is | | | | | | | applied | | | | | | | relative | | | | | | | to other | | | | | | | PCC rules | | | | | | | within | | | | | | | the same | | | | | | | PDU | | | | | | | session. | | | | | | | It shall | | | | | | | be | | | | | | | included | | | | | | | if the | | | | | | | \"fl | | | | | | | owInfos\" | | | | | | | attribute | | | | | | | is | | | | | | | included | | | | | | | or may be | | | | | | | included | | | | | | | if the | | | | | | | \"appId\" | | | | | | | attribute | | | | | | | is | | | | | | | included | | | | | | | when the | | | | | | | PCF | | | | | | | initially | | | | | | | p | | | | | | | rovisions | | | | | | | the PCC | | | | | | | rule. | | | | | | | (NOTE 2) | | | | | | | (NOTE 4) | | +-----------+-----------+---+-----------+-----------+-----------+ | afSi | AfSi | O | 0..1 | Indicates | ProvAFs | | gProtocol | gProtocol | | | the | ignalFlow | | | | | | protocol | | | | | | | used for | | | | | | | s | | | | | | | ignalling | | | | | | | between | | | | | | | the UE | | | | | | | and the | | | | | | | AF. The | | | | | | | default | | | | | | | value | | | | | | | \ | | | | | | | "NO_INFO | | | | | | | RMATION\" | | | | | | | shall | | | | | | | apply, if | | | | | | | the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | and has | | | | | | | not been | | | | | | | supplied | | | | | | | pr | | | | | | | eviously. | | +-----------+-----------+---+-----------+-----------+-----------+ | appReloc | boolean | O | 0..1 | It | TSC | | | | | | indicates | | | | | | | that the | | | | | | | ap | | | | | | | plication | | | | | | | cannot be | | | | | | | relocated | | | | | | | once a | | | | | | | location | | | | | | | of the | | | | | | | ap | | | | | | | plication | | | | | | | is | | | | | | | selected | | | | | | | by the | | | | | | | 5GC when | | | | | | | it is | | | | | | | included | | | | | | | and set | | | | | | | to | | | | | | | \"true\" | | | | | | | The | | | | | | | default | | | | | | | value | | | | | | | \"false\" | | | | | | | shall | | | | | | | apply, if | | | | | | | the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | and has | | | | | | | not been | | | | | | | supplied | | | | | | | pr | | | | | | | eviously. | | +-----------+-----------+---+-----------+-----------+-----------+ | r | arra | O | 1..N | A | | | efQosData | y(string) | | | reference | | | | | | | to the | | | | | | | QosData | | | | | | | policy | | | | | | | type | | | | | | | decision | | | | | | | type. It | | | | | | | is the | | | | | | | qosId | | | | | | | described | | | | | | | in | | | | | | | subclause | | | | | | | 5.6.2.8. | | | | | | | | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | refTcData | arra | O | 1..N | A | | | | y(string) | | | reference | | | | | | | to the | | | | | | | TrafficCo | | | | | | | ntrolData | | | | | | | policy | | | | | | | decision | | | | | | | type. It | | | | | | | is the | | | | | | | tcId | | | | | | | described | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.6.2.10. | | | | | | | | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | r | arra | O | 1..N | A | | | efChgData | y(string) | | | reference | | | | | | | to the | | | | | | | Cha | | | | | | | rgingData | | | | | | | policy | | | | | | | decision | | | | | | | type. It | | | | | | | is the | | | | | | | chgId | | | | | | | described | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.6.2.11. | | | | | | | | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | refUmData | arra | O | 1..N | A | | | | y(string) | | | reference | | | | | | | to | | | | | | | U | | | | | | | sageMonit | | | | | | | oringData | | | | | | | policy | | | | | | | decision | | | | | | | type. It | | | | | | | is the | | | | | | | umId | | | | | | | described | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.6.2.12. | | | | | | | | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | re | string | O | 0..1 | A | | | fCondData | | | | reference | | | | | | | to the | | | | | | | condition | | | | | | | data. It | | | | | | | is the | | | | | | | condId | | | | | | | described | | | | | | | in | | | | | | | subclause | | | | | | | 5.6.2.9. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | Arrays | | | | | | | are only | | | | | | | i | | | | | | | ntroduced | | | | | | | for | | | | | | | future | | | | | | | compa | | | | | | | tibility. | | | | | | | In this | | | | | | | release | | | | | | | of the | | | | | | | spec | | | | | | | ification | | | | | | | the | | | | | | | maximum | | | | | | | number of | | | | | | | elements | | | | | | | in the | | | | | | | array is | | | | | | | 1. | | | | | | | | | | | | | | NOTE 2: | | | | | | | For a PCC | | | | | | | rule with | | | | | | | the | | | | | | | \"appId\" | | | | | | | a | | | | | | | ttribute, | | | | | | | the | | | | | | | p | | | | | | | recedence | | | | | | | can be | | | | | | | prec | | | | | | | onfigured | | | | | | | in SMF or | | | | | | | provided | | | | | | | in the | | | | | | | PCC rule | | | | | | | from PCF. | | | | | | | The | | | | | | | p | | | | | | | recedence | | | | | | | provided | | | | | | | by the | | | | | | | PCF shall | | | | | | | take | | | | | | | pr | | | | | | | ecedence. | | | | | | | | | | | | | | NOTE 3: | | | | | | | Either | | | | | | | the | | | | | | | \"fl | | | | | | | owInfos\" | | | | | | | attribute | | | | | | | or | | | | | | | \"appId\" | | | | | | | attribute | | | | | | | shall be | | | | | | | supplied | | | | | | | by the | | | | | | | PCF when | | | | | | | the PCC | | | | | | | rule is | | | | | | | initially | | | | | | | pro | | | | | | | visioned. | | | | | | | If the | | | | | | | \"appId\" | | | | | | | attribute | | | | | | | is | | | | | | | supplied, | | | | | | | the PCF | | | | | | | shall not | | | | | | | modify | | | | | | | the | | | | | | | ap | | | | | | | plication | | | | | | | i | | | | | | | dentifier | | | | | | | supplied | | | | | | | within | | | | | | | the | | | | | | | \"appId\" | | | | | | | attribute | | | | | | | later. | | | | | | | | | | | | | | NOTE 4: | | | | | | | The | | | | | | | \"pre | | | | | | | cedence\" | | | | | | | attribute | | | | | | | is used | | | | | | | to | | | | | | | specify | | | | | | | the | | | | | | | p | | | | | | | recedence | | | | | | | of the | | | | | | | PCC rule | | | | | | | among all | | | | | | | PCC rules | | | | | | | a | | | | | | | ssociated | | | | | | | with the | | | | | | | PDU | | | | | | | session. | | | | | | | It | | | | | | | includes | | | | | | | an | | | | | | | integer | | | | | | | value in | | | | | | | the range | | | | | | | from 0 to | | | | | | | 255 | | | | | | | ( | | | | | | | decimal). | | | | | | | The | | | | | | | higher | | | | | | | the value | | | | | | | of the | | | | | | | \"pre | | | | | | | cedence\" | | | | | | | a | | | | | | | ttribute, | | | | | | | the lower | | | | | | | the | | | | | | | p | | | | | | | recedence | | | | | | | of that | | | | | | | PCC rule | | | | | | | is. The | | | | | | | p | | | | | | | recedence | | | | | | | value | | | | | | | range | | | | | | | from 70 | | | | | | | to 99 | | | | | | | (decimal) | | | | | | | shall be | | | | | | | used for | | | | | | | the PCC | | | | | | | rules | | | | | | | subject | | | | | | | to | | | | | | | R | | | | | | | eflective | | | | | | | QoS. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.7 Type SessionRule
Table 5.6.2.7-1: Definition of type SessionRule
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | aut | Ambr | C | 0..1 | A | | | hSessAmbr | | | | uthorized | | | | | | | Sess | | | | | | | ion-AMBR. | | | | | | | | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | a | Au | C | 0..1 | A | | | uthDefQos | thorizedD | | | uthorized | | | | efaultQos | | | default | | | | | | | QoS | | | | | | | inf | | | | | | | ormation. | | | | | | | | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | s | string | M | 1 | U | | | essRuleId | | | | nivocally | | | | | | | i | | | | | | | dentifies | | | | | | | the | | | | | | | session | | | | | | | rule | | | | | | | within a | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | refUmData | string | O | 0..1 | A | | | | | | | reference | | | | | | | to | | | | | | | U | | | | | | | sageMonit | | | | | | | oringData | | | | | | | policy | | | | | | | decision | | | | | | | type. It | | | | | | | is the | | | | | | | umId | | | | | | | described | | | | | | | in | | | | | | | s | | | | | | | ubclause | | | | | | | 5.6.2.12. | | +-----------+-----------+---+-----------+-----------+-----------+ | re | string | O | 0..1 | A | | | fCondData | | | | reference | | | | | | | to the | | | | | | | condition | | | | | | | data. It | | | | | | | is the | | | | | | | condId | | | | | | | described | | | | | | | in | | | | | | | subclause | | | | | | | 5.6.2.9. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE: The | | | | | | | PCF shall | | | | | | | ensure | | | | | | | that a | | | | | | | session | | | | | | | rule | | | | | | | enforced | | | | | | | in the | | | | | | | SMF | | | | | | | contains | | | | | | | the | | | | | | | \"authS | | | | | | | essAmbr\" | | | | | | | and the | | | | | | | \"aut | | | | | | | hDefQos\" | | | | | | | at | | | | | | | tributes. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.8 Type QosData
Table 5.6.2.8-1: Definition of type QosData
* * *
Attribute name Data type P Cardinality Description Applicability qosId string
M 1 Univocally identifies the QoS control policy data within a PDU session.  
5qi 5Qi C 0..1 Identifier for the authorized QoS parameters for the service
data flow. It shall be included when the QoS data decision is initially
provisioned and \"defQosFlowIndication\" is not included or is included and
set to false.  
maxbrUl BitRateRm O 0..1 Indicates the max bandwidth in uplink.  
maxbrDl BitRateRm O 0..1 Indicates the max bandwidth in downlink.  
gbrUl BitRateRm O 0..1 Indicates the guaranteed bandwidth in uplink.  
gbrDl BitRateRm O 0..1 Indicates the guaranteed bandwidth in downlink.  
arp Arp C 1 Indicates the allocation and retention priority. It shall be
included when the QoS data decision is initially provisioned and
\"defQosFlowIndication\" is not included or is included and set to false.  
qnc boolean O 0..1 Indicates whether notifications are requested from 3GPP NG-
RAN when the GFBR can no longer (or again) be guaranteed for a QoS Flow during
the lifetime of the QoS Flow. Default value \"FALSE\" is used, if not present
and has not been supplied previously.  
reflectiveQos boolean O 0..1 Indicates whether the QoS information is
reflective for the corresponding non-GBR service data flow. Default value
\"FALSE\" is used, if not present and has not been supplied previously.  
sharingKeyDl string O 0..1 Indicates, by containing the same value, what PCC
rules may share resource in downlink direction. ResShare sharingKeyUl string O
0..1 Indicates, by containing the same value, what PCC rules may share
resource in uplink direction. ResShare priorityLevel 5QiPriorityLevelRm O 0..1
Indicates a priority in scheduling resources among QoS Flows. (NOTE)  
averWindow AverWindowRm O 0..1 Represents the duration over which the
guaranteed and maximum bitrate shall be calculated. (NOTE)  
maxDataBurstVol MaxDataBurstVolRm O 0..1 Denotes the largest amount of data
that is required to be transferred within a period of 5G-AN PDB. (NOTE)  
maxPacketLossRateDl PacketLossRateRm O 0..1 Indicates the downlink maximum
rate for lost packets that can be tolerated for the service data flow. RAN-
Support-Info maxPacketLossRateUl PacketLossRateRm O 0..1 Indicates the uplink
maximum rate for lost packets that can be tolerated for the service data flow.
RAN-Support-Info defQosFlowIndication boolean O 0..1 Indicates that the
dynamic PCC rule shall always have its binding with the QoS Flow associated
with the default QoS rule. Default value \"FALSE\" is used, if not present and
has not been supplied previously.  
NOTE: Applicable only when a value different from the standardized value for
this 5QI in table 5.7.4-1 3GPP TS 23.501 [2] is required.
* * *
#### 5.6.2.9 Type ConditionData
Table 5.6.2.9-1: Definition of type ConditionData
* * *
Attribute name Data type P Cardinality Description Applicability condId string
M 1 Uniquely identifies the condition data within a PDU session.  
activationTime DateTimeRm O 0..1 The time when the decision data shall be
activated.  
deactivationTime DateTimeRm O 0..1 The time when the decision data shall be
deactivated.
* * *
#### 5.6.2.10 Type TrafficControlData
Table 5.6.2.10-1: Definition of type TrafficControlData
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | tcId | string | M | 1 | U | | | | | | | nivocally | | | | | | | i | | | | | | | dentifies | | | | | | | the | | | | | | | traffic | | | | | | | control | | | | | | | policy | | | | | | | data | | | | | | | within a | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | f | F | O | 0..1 | Enum | | | lowStatus | lowStatus | | | de | | | | | | | termining | | | | | | | what | | | | | | | action to | | | | | | | perform | | | | | | | on | | | | | | | traffic. | | | | | | | Possible | | | | | | | values | | | | | | | are: | | | | | | | [enable, | | | | | | | disable, | | | | | | | enable | | | | | | | _uplink, | | | | | | | enable_d | | | | | | | ownlink] | | | | | | | . The | | | | | | | default | | | | | | | value | | | | | | | \" | | | | | | | ENABLED\" | | | | | | | shall | | | | | | | apply, if | | | | | | | the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | and has | | | | | | | not been | | | | | | | supplied | | | | | | | pr | | | | | | | eviously. | | +-----------+-----------+---+-----------+-----------+-----------+ | red | R | O | 0..1 | It | ADC | | irectInfo | edirectIn | | | indicates | | | | formation | | | whether | | | | | | | the | | | | | | | detected | | | | | | | ap | | | | | | | plication | | | | | | | traffic | | | | | | | should be | | | | | | | r | | | | | | | edirected | | | | | | | to | | | | | | | another | | | | | | | c | | | | | | | ontrolled | | | | | | | address. | | +-----------+-----------+---+-----------+-----------+-----------+ | muteNotif | boolean | O | 0..1 | Indicates | ADC | | | | | | whether | | | | | | | appli | | | | | | | cation\'s | | | | | | | start or | | | | | | | stop | | | | | | | not | | | | | | | ification | | | | | | | is to be | | | | | | | muted. | | | | | | | The | | | | | | | default | | | | | | | value | | | | | | | \"FALSE\" | | | | | | | shall | | | | | | | apply, if | | | | | | | the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | and has | | | | | | | not been | | | | | | | supplied | | | | | | | pr | | | | | | | eviously. | | +-----------+-----------+---+-----------+-----------+-----------+ | traf | string | O | 0..1 | Reference | TSC | | ficSteeri | | | | to a | | | ngPolIdDl | | | | pre-c | | | | | | | onfigured | | | (NOTE) | | | | traffic | | | | | | | steering | | | | | | | policy | | | | | | | for | | | | | | | downlink | | | | | | | traffic | | | | | | | at the | | | | | | | SMF. | | +-----------+-----------+---+-----------+-----------+-----------+ | traf | string | O | 0..1 | Reference | TSC | | ficSteeri | | | | to a | | | ngPolIdUl | | | | pre-c | | | | | | | onfigured | | | (NOTE) | | | | traffic | | | | | | | steering | | | | | | | policy | | | | | | | for | | | | | | | uplink | | | | | | | traffic | | | | | | | at the | | | | | | | SMF. | | +-----------+-----------+---+-----------+-----------+-----------+ | ro | array( | O | 1..N | A list of | TSC | | uteToLocs | RouteTo | | | location | | | | Location) | | | which the | | | (NOTE) | | | | traffic | | | | | | | shall be | | | | | | | routed to | | | | | | | for the | | | | | | | AF | | | | | | | request | | +-----------+-----------+---+-----------+-----------+-----------+ | upPat | UpPat | O | 0..1 | Contains | TSC | | hChgEvent | hChgEvent | | | the | | | | | | | in | | | | | | | formation | | | | | | | about the | | | | | | | AF | | | | | | | subs | | | | | | | criptions | | | | | | | of the UP | | | | | | | path | | | | | | | change. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE: | | | | | | | Traffic | | | | | | | steering | | | | | | | policy | | | | | | | iden | | | | | | | tifier(s) | | | | | | | (i.e. | | | | | | | \"traffi | | | | | | | cSteering | | | | | | | PolIdDl\" | | | | | | | attribute | | | | | | | and/or \" | | | | | | | traff | | | | | | | icSteerin | | | | | | | gPolIdUl" | | | | | | | a | | | | | | | ttribute) | | | | | | | and N6 | | | | | | | traffic | | | | | | | routing | | | | | | | req | | | | | | | uirements | | | | | | | (i.e. | | | | | | | \"rout | | | | | | | eToLocs\" | | | | | | | a | | | | | | | ttribute) | | | | | | | are | | | | | | | mutually | | | | | | | e | | | | | | | xclusive. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.11 Type ChargingData
Table 5.6.2.11-1: Definition of type ChargingData
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | chgId | string | M | 1 | U | | | | | | | nivocally | | | | | | | i | | | | | | | dentifies | | | | | | | the | | | | | | | charging | | | | | | | control | | | | | | | policy | | | | | | | data | | | | | | | within a | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | meter | Meter | O | 0..1 | Defines | | | ingMethod | ingMethod | | | what | | | | | | | p | | | | | | | arameters | | | | | | | shall be | | | | | | | metered | | | | | | | for | | | | | | | offline | | | | | | | charging. | | | | | | | If the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | but it | | | | | | | has been | | | | | | | supplied | | | | | | | pr | | | | | | | eviously, | | | | | | | the | | | | | | | previous | | | | | | | in | | | | | | | formation | | | | | | | remains | | | | | | | valid. If | | | | | | | the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | and it | | | | | | | has not | | | | | | | been | | | | | | | supplied | | | | | | | p | | | | | | | reviously | | | | | | | or the | | | | | | | attribute | | | | | | | has been | | | | | | | supplied | | | | | | | p | | | | | | | reviously | | | | | | | but the | | | | | | | attribute | | | | | | | is set to | | | | | | | NULL, the | | | | | | | metering | | | | | | | method | | | | | | | pre-c | | | | | | | onfigured | | | | | | | at the | | | | | | | SMF is | | | | | | | a | | | | | | | pplicable | | | | | | | as | | | | | | | default | | | | | | | metering | | | | | | | method. | | +-----------+-----------+---+-----------+-----------+-----------+ | offline | boolean | O | 0..1 | Indicates | | | | | | | the | | | | | | | offline | | | | | | | charging | | | | | | | is | | | | | | | a | | | | | | | pplicable | | | | | | | to the | | | | | | | PCC rule | | | | | | | when it | | | | | | | is | | | | | | | included | | | | | | | and set | | | | | | | ot true. | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | online | boolean | O | 0..1 | Indicates | | | | | | | the | | | | | | | online | | | | | | | charging | | | | | | | is | | | | | | | a | | | | | | | pplicable | | | | | | | to the | | | | | | | PCC rule | | | | | | | when it | | | | | | | is | | | | | | | included | | | | | | | and set | | | | | | | ot true. | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | sdfHandl | boolean | O | 0..1 | Indicates | | | | | | | whether | | | | | | | the | | | | | | | service | | | | | | | data flow | | | | | | | is | | | | | | | allowed | | | | | | | to start | | | | | | | while the | | | | | | | SMF is | | | | | | | waiting | | | | | | | for the | | | | | | | response | | | | | | | to the | | | | | | | credit | | | | | | | request. | | | | | | | The | | | | | | | default | | | | | | | value | | | | | | | \"FALSE\" | | | | | | | ( | | | | | | | blocking) | | | | | | | shall | | | | | | | apply, if | | | | | | | the | | | | | | | attribute | | | | | | | is not | | | | | | | present. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | ra | Ra | O | 0..1 | The | | | tingGroup | tingGroup | | | charging | | | | | | | key for | | | | | | | the PCC | | | | | | | rule used | | | | | | | for | | | | | | | rating | | | | | | | purposes. | | +-----------+-----------+---+-----------+-----------+-----------+ | repor | Repor | O | 0..1 | Defines | | | tingLevel | tingLevel | | | on what | | | | | | | level the | | | | | | | SMF | | | | | | | reports | | | | | | | the usage | | | | | | | for the | | | | | | | related | | | | | | | PCC rule. | | | | | | | If the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | but it | | | | | | | has been | | | | | | | supplied | | | | | | | pr | | | | | | | eviously, | | | | | | | the | | | | | | | previous | | | | | | | in | | | | | | | formation | | | | | | | remains | | | | | | | valid. If | | | | | | | the | | | | | | | attribute | | | | | | | is not | | | | | | | present | | | | | | | and it | | | | | | | has not | | | | | | | been | | | | | | | supplied | | | | | | | p | | | | | | | reviously | | | | | | | or the | | | | | | | attribute | | | | | | | has been | | | | | | | supplied | | | | | | | p | | | | | | | reviously | | | | | | | but it is | | | | | | | set to | | | | | | | NULL, the | | | | | | | reporting | | | | | | | level | | | | | | | pre-c | | | | | | | onfigured | | | | | | | at the | | | | | | | SMF is | | | | | | | a | | | | | | | pplicable | | | | | | | as | | | | | | | default | | | | | | | reporting | | | | | | | level. | | +-----------+-----------+---+-----------+-----------+-----------+ | serviceId | ServiceId | O | 0..1 | Indicates | | | | | | | the | | | | | | | i | | | | | | | dentifier | | | | | | | of the | | | | | | | service | | | | | | | or | | | | | | | service | | | | | | | component | | | | | | | the | | | | | | | service | | | | | | | data flow | | | | | | | in a PCC | | | | | | | rule | | | | | | | relates | | | | | | | to. | | +-----------+-----------+---+-----------+-----------+-----------+ | sponsorId | string | O | 0..1 | Indicates | Spon | | | | | | the | sored-Con | | | | | | sponsor | nectivity | | | | | | identity. | | +-----------+-----------+---+-----------+-----------+-----------+ | app | string | O | 0..1 | Indicates | Spon | | SvcProvId | | | | the | sored-Con | | | | | | ap | nectivity | | | | | | plication | | | | | | | service | | | | | | | provider | | | | | | | identity. | | +-----------+-----------+---+-----------+-----------+-----------+ | af | C | C | 0..1 | An | | | ChargingI | hargingId | | | id | | | dentifier | | | | entifier, | | | | | | | provided | | | | | | | from the | | | | | | | AF, | | | | | | | co | | | | | | | rrelating | | | | | | | the | | | | | | | me | | | | | | | asurement | | | | | | | for the | | | | | | | Charging | | | | | | | ke | | | | | | | y/Service | | | | | | | i | | | | | | | dentifier | | | | | | | values in | | | | | | | this PCC | | | | | | | rule with | | | | | | | ap | | | | | | | plication | | | | | | | level | | | | | | | reports. | | | | | | | (NOTE 4) | | +-----------+-----------+---+-----------+-----------+-----------+ | afChargId | App | O | 0..1 | A | AF_Ch | | | licationC | | | character | arging_I | | | hargingId | | | string | dentifier | | | | | | id | | | | | | | entifier, | | | | | | | provided | | | | | | | from the | | | | | | | AF, | | | | | | | co | | | | | | | rrelating | | | | | | | the | | | | | | | me | | | | | | | asurement | | | | | | | for the | | | | | | | Charging | | | | | | | ke | | | | | | | y/Service | | | | | | | i | | | | | | | dentifier | | | | | | | values in | | | | | | | this PCC | | | | | | | rule with | | | | | | | ap | | | | | | | plication | | | | | | | level | | | | | | | reports. | | | | | | | | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | The | | | | | | | absence | | | | | | | of both | | | | | | | the | | | | | | | \" | | | | | | | offline\" | | | | | | | attribute | | | | | | | and | | | | | | | \ | | | | | | | "online\" | | | | | | | attribute | | | | | | | or only | | | | | | | one | | | | | | | attribute | | | | | | | is | | | | | | | present | | | | | | | and set | | | | | | | to false | | | | | | | within a | | | | | | | Charging | | | | | | | Data | | | | | | | decision | | | | | | | instance | | | | | | | indicates | | | | | | | that the | | | | | | | default | | | | | | | charging | | | | | | | method of | | | | | | | the PDU | | | | | | | session | | | | | | | is | | | | | | | a | | | | | | | pplicable | | | | | | | to the | | | | | | | PCC rule | | | | | | | referring | | | | | | | to the | | | | | | | Charging | | | | | | | Data | | | | | | | decision. | | | | | | | Either | | | | | | | \" | | | | | | | offline\" | | | | | | | attribute | | | | | | | or | | | | | | | \ | | | | | | | "online\" | | | | | | | attribute | | | | | | | ans set | | | | | | | to true | | | | | | | shall be | | | | | | | pr | | | | | | | ovisioned | | | | | | | initially | | | | | | | if there | | | | | | | is no | | | | | | | default | | | | | | | charging | | | | | | | method | | | | | | | applied | | | | | | | to the | | | | | | | PDU | | | | | | | session. | | | | | | | The | | | | | | | "offline" | | | | | | | attribute | | | | | | | and the | | | | | | | "online" | | | | | | | attribute | | | | | | | shall not | | | | | | | be | | | | | | | simul | | | | | | | taneously | | | | | | | present | | | | | | | with the | | | | | | | same | | | | | | | value, | | | | | | | i.e., | | | | | | | both set | | | | | | | to true | | | | | | | or both | | | | | | | set to | | | | | | | false. | | | | | | | | | | | | | | NOTE 2: | | | | | | | The | | | | | | | \"s | | | | | | | dfHandl\" | | | | | | | attribute | | | | | | | shall not | | | | | | | be | | | | | | | present | | | | | | | when the | | | | | | | online | | | | | | | charging | | | | | | | method | | | | | | | does not | | | | | | | apply for | | | | | | | the PCC | | | | | | | rule | | | | | | | referring | | | | | | | to the | | | | | | | Charging | | | | | | | Data | | | | | | | decision | | | | | | | (i.e., | | | | | | | when the | | | | | | | \ | | | | | | | "online\" | | | | | | | attribute | | | | | | | is | | | | | | | present | | | | | | | and set | | | | | | | to false, | | | | | | | or is | | | | | | | absent | | | | | | | and the | | | | | | | online | | | | | | | default | | | | | | | charging | | | | | | | method | | | | | | | does not | | | | | | | apply for | | | | | | | the PDU | | | | | | | session, | | | | | | | or is | | | | | | | absent | | | | | | | and there | | | | | | | is no | | | | | | | online | | | | | | | default | | | | | | | charging | | | | | | | method | | | | | | | defined). | | | | | | | | | | | | | | NOTE 3: | | | | | | | The | | | | | | | \"af | | | | | | | ChargId\" | | | | | | | attribute | | | | | | | shall be | | | | | | | used | | | | | | | instead | | | | | | | of the | | | | | | | \"afCh | | | | | | | argingIde | | | | | | | ntifier\" | | | | | | | attribute | | | | | | | when the | | | | | | | \ | | | | | | | "AF_Char | | | | | | | ging_Ide | | | | | | | ntifier\" | | | | | | | feature | | | | | | | is | | | | | | | s | | | | | | | upported. | | | | | | | | | | | | | | NOTE 4: | | | | | | | The | | | | | | | \"afCh | | | | | | | argingIde | | | | | | | ntifier\" | | | | | | | attribute | | | | | | | shall not | | | | | | | be | | | | | | | present | | | | | | | when the | | | | | | | \ | | | | | | | "AF_Char | | | | | | | ging_Ide | | | | | | | ntifier\" | | | | | | | feature | | | | | | | is | | | | | | | s | | | | | | | upported. | | | | | | | When the | | | | | | | \ | | | | | | | "AF_Char | | | | | | | ging_Ide | | | | | | | ntifier\" | | | | | | | feature | | | | | | | is not | | | | | | | supported | | | | | | | it is out | | | | | | | of the | | | | | | | scope of | | | | | | | the | | | | | | | spec | | | | | | | ification | | | | | | | what the | | | | | | | behaviour | | | | | | | of the | | | | | | | PCF is | | | | | | | when the | | | | | | | AF | | | | | | | provides | | | | | | | charging | | | | | | | i | | | | | | | dentifier | | | | | | | values | | | | | | | that are | | | | | | | out of | | | | | | | C | | | | | | | hargingId | | | | | | | data type | | | | | | | value | | | | | | | range. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.12 Type UsageMonitoringData
Table 5.6.2.12-1: Definition of type UsageMonitoringData
* * *
Attribute name Data type P Cardinality Description Applicability umId string M
1 Univocally identifies the usage monitoring policy data within a PDU session.  
volumeThreshold VolumeRm O 0..1 Indicates the total volume threshold.  
volumeThresholdUplink VolumeRm O 0..1 Indicates a volume threshold in uplink.  
volumeThresholdDownlink VolumeRm O 0..1 Indicates a volume threshold in
downlink.  
timeThreshold DurationSecRm O 0..1 Indicates a time threshold.  
monitoringTime DateTimeRm O 0..1 Indicates the time at which the UP function
is expected to reapply the next thresholds (e.g. nextVolThreshold).  
nextVolThreshold VolumeRm C 0..1 Indicates a volume threshold after the
Monitoring Time.  
nextVolThresholdUplink VolumeRm O 0..1 Indicates a volume threshold in uplink
after the Monitoring Time.  
nextVolThresholdDownlink VolumeRm O 0..1 Indicates al volume threshold in
downlink after the Monitoring Time.  
nextTimeThreshold DurationSecRm C 0..1 Indicates a time threshold after the
Monitoring.  
inactivityTime DurationSecRm O 0..1 Defines the period of time after which the
time measurement shall stop, if no packets are received.  
exUsagePccRuleIds array(string) C 1..N Contains the PCC rule identifier(s)
which corresponding service data flow(s) shall be excluded from PDU Session
usage monitoring. It is only included in the UsageMonitoringData instance for
session level usage monitoring.
* * *
#### 5.6.2.13 Type RedirectInformation
Table 5.6.2.13-1: Definition of type RedirectInformation
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | redire | boolean | C | 0..1 | This | | | ctEnabled | | | | attribute | | | | | | | indicates | | | | | | | whether | | | | | | | the | | | | | | | redirect | | | | | | | in | | | | | | | struction | | | | | | | is | | | | | | | enable. | | | | | | | It shall | | | | | | | be | | | | | | | included | | | | | | | and set | | | | | | | to true | | | | | | | when the | | | | | | | redirect | | | | | | | in | | | | | | | struction | | | | | | | is | | | | | | | pr | | | | | | | ovisioned | | | | | | | initially | | | | | | | and may | | | | | | | be | | | | | | | included | | | | | | | sub | | | | | | | sequently | | | | | | | to | | | | | | | disable | | | | | | | or | | | | | | | re-enable | | | | | | | the | | | | | | | redirect | | | | | | | ins | | | | | | | truction. | | | | | | | If the | | | | | | | attribute | | | | | | | omitted, | | | | | | | the | | | | | | | previous | | | | | | | value | | | | | | | shall | | | | | | | apply. | | +-----------+-----------+---+-----------+-----------+-----------+ | r | R | O | 0..1 | Indicates | | | edirectAd | edirectAd | | | the type | | | dressType | dressType | | | of | | | | | | | redirect | | | | | | | address | | | | | | | contained | | | | | | | within | | | | | | | the | | | | | | | \"redir | | | | | | | ectServer | | | | | | | Address\" | | | | | | | a | | | | | | | ttribute. | | +-----------+-----------+---+-----------+-----------+-----------+ | red | string | O | 0..1 | Indicates | | | irectServ | | | | the | | | erAddress | | | | address | | | | | | | of the | | | | | | | redirect | | | | | | | server. | | | | | | | | | | | | | | If | | | | | | | \"red | | | | | | | irectAddr | | | | | | | essType\" | | | | | | | attribute | | | | | | | indicates | | | | | | | the | | | | | | | IP | | | | | | | V4_ADDR, | | | | | | | the | | | | | | | encoding | | | | | | | is the | | | | | | | same as | | | | | | | the | | | | | | | Ipv4Addr | | | | | | | data type | | | | | | | defined | | | | | | | in | | | | | | | 3GPP | | | | | | | TS 29.57 | | | | | | | 1 [11]. | | | | | | | | | | | | | | If | | | | | | | \"red | | | | | | | irectAddr | | | | | | | essType\" | | | | | | | attribute | | | | | | | indicates | | | | | | | the | | | | | | | IP | | | | | | | V6_ADDR, | | | | | | | the | | | | | | | encoding | | | | | | | is the | | | | | | | same as | | | | | | | the | | | | | | | Ipv6Addr | | | | | | | data type | | | | | | | defined | | | | | | | in | | | | | | | 3GPP | | | | | | | TS 29.57 | | | | | | | 1 [11]. | | | | | | | | | | | | | | If | | | | | | | \"red | | | | | | | irectAddr | | | | | | | essType\" | | | | | | | attribute | | | | | | | indicates | | | | | | | the URL | | | | | | | or | | | | | | | SIP_URI, | | | | | | | the | | | | | | | encoding | | | | | | | is the | | | | | | | same as | | | | | | | the Uri | | | | | | | data type | | | | | | | defined | | | | | | | in | | | | | | | 3GPP | | | | | | | TS 29.57 | | | | | | | 1 [11]. | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.14 Type FlowInformation
Table 5.6.2.14-1: Definition of type FlowInformation
* * *
Attribute name Data type P Cardinality Description Applicability
flowDescription FlowDescription O 0..1 Contains the packet filters of the IP
flow(s).  
ethFlowDescription EthFlowDescription O 0..1 Defines a packet filter for an
Ethernet flow. If the \"fDir\" attribute is included, it shall be set to
\"DOWNLINK\". If the \"fDir\" attribute is never provided, the address
information within the \"ethFlowDescription\" attribute shall be encoded in
downlink direction.  
packFiltId string O 0..1 An identifier of packet filter.  
packetFilterUsage boolean O 0..1 The packet shall be sent to the UE. The
default value \"FALSE\" shall apply, if the attribute is not present and has
not been supplied previously.  
tosTrafficClass string O 0..1 2-octet string. The first octet contains the
Ipv4 Type-of-Service or the Ipv6 Traffic-Class field and the second octet
contains the ToS/Traffic mask field in hexadecimal representation. Each
character in the string shall take a value of \"0\" to \"9\" or \"A\" to \"F\"
and shall represent 4 bits. One example is that of a TFT packet filter as
defined in 3GPP TS 24.008 [39].  
spi string O 0..1 4 octet string, representing the security parameter index of
the IPSec packet in hexadecimal representation. Each character in the string
shall take a value of \"0\" to \"9\" or \"A\" to \"F\" and shall represent 4
bits. One example is that of a TFT packet filter as defined in 3GPP TS 24.008
[39].  
flowLabel string O 0..1 3-octet string, representing the Ipv6 flow label
header field in hexadecimal representation. Each character in the string shall
take a value of \"0\" to \"9\" or \"A\" to \"F\" and shall represent 4 bits.
One example is that of a TFT packet filter as defined in 3GPP TS 24.008 [39].  
flowDirection FlowDirectionRm O 0..1 Indicates the direction/directions that a
filter is applicable, downlink only, uplink only or both down- and uplink
(bidirectional).
* * *
#### 5.6.2.15 Type SmPolicyDeleteData
Table 5.6.2.15-1: Definition of type SmPolicyDeleteData
* * *
Attribute name Data type P Cardinality Description Applicability
userLocationInfo UserLocation O 0..1 The location of the served UE is camping.
RAN-NAS-Cause, NetLoc ueTimeZone TimeZone O 0..1 The time zone where the
served UE is camping. RAN-NAS-Cause, NetLoc userLocationInfoTime DateTime O
0..1 Contains the NTP time at which the UE was last known to be in the
location. (NOTE) RAN-NAS-Cause, NetLoc servingNetwork NetworkId O 0..1 The
serving network where the served UE is camping. RAN-NAS-Cause, NetLoc
ranNasRelCauses array(RanNasRelCause) O 1..N indicates the RAN or NAS release
cause code information. RAN-NAS-Cause accuUsageReports array(AccuUsageReport)
O 1..N Contains the usage report. UMC NOTE: The age of UE location included
within the \"userLocationInfoTime\" attribute is the age of the 3GPP access UE
location received from the AMF and shall be included only when the reported
\"userLocationInfo\" attribute includes the UE location in the 3GPP access.
* * *
#### 5.6.2.16 Type QosCharacteristics
Table 5.6.2.16-1: Definition of type QosCharacteristics
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | 5qi | 5Qi | M | 1 | I | | | | | | | dentifier | | | | | | | for the | | | | | | | a | | | | | | | uthorized | | | | | | | QoS | | | | | | | p | | | | | | | arameters | | | | | | | for the | | | | | | | service | | | | | | | data | | | | | | | flow. | | | | | | | Applies | | | | | | | to PCC | | | | | | | rule and | | | | | | | PDU | | | | | | | session | | | | | | | level. | | +-----------+-----------+---+-----------+-----------+-----------+ | res | QosRes | M | 1 | Indicates | | | ourceType | ourceType | | | whether | | | | | | | the | | | | | | | resource | | | | | | | type is | | | | | | | GBR, | | | | | | | delay | | | | | | | critical | | | | | | | GBR, or | | | | | | | non-GBR. | | +-----------+-----------+---+-----------+-----------+-----------+ | prio | 5QiPrio | M | 1 | Unsigned | | | rityLevel | rityLevel | | | integer | | | | | | | i | | | | | | | ndicating | | | | | | | the 5QI | | | | | | | Priority | | | | | | | Level, | | | | | | | within a | | | | | | | range of | | | | | | | 1 to 127. | | +-----------+-----------+---+-----------+-----------+-----------+ | packetDe | Packet | M | 1 | Unsigned | | | layBudget | DelBudget | | | integer | | | | | | | indicates | | | | | | | the | | | | | | | packet | | | | | | | delay | | | | | | | budget. | | | | | | | Packet | | | | | | | Delay | | | | | | | Budget | | | | | | | expressed | | | | | | | in | | | | | | | mill | | | | | | | iseconds. | | +-----------+-----------+---+-----------+-----------+-----------+ | packet | Pack | M | 1 | String | | | ErrorRate | etErrRate | | | i | | | | | | | ndicating | | | | | | | the | | | | | | | packet | | | | | | | error | | | | | | | rate. | | | | | | | | | | | | | | Examples: | | | | | | | | | | | | | | Packer | | | | | | | Error | | | | | | | Rate | | | | | | | 4x10^-6^ | | | | | | | shall be | | | | | | | encoded | | | | | | | as | | | | | | | \"4E-6\". | | | | | | | | | | | | | | Packer | | | | | | | Error | | | | | | | Rate | | | | | | | 10^-2^ | | | | | | | shall be | | | | | | | encoded | | | | | | | as | | | | | | | \"1E-2\". | | +-----------+-----------+---+-----------+-----------+-----------+ | averag | A | C | 0..1 | Indicates | | | ingWindow | verWindow | | | the | | | | | | | averaging | | | | | | | window. | | | | | | | | | | | | | | This IE | | | | | | | shall be | | | | | | | present | | | | | | | only for | | | | | | | a GBR QoS | | | | | | | flow or a | | | | | | | Delay | | | | | | | Critical | | | | | | | GBR QoS | | | | | | | flow. | | +-----------+-----------+---+-----------+-----------+-----------+ | maxDat | MaxDat | C | 0..1 | Unsigned | | | aBurstVol | aBurstVol | | | Integer. | | | | | | | Indicates | | | | | | | the | | | | | | | maximum | | | | | | | data | | | | | | | burst | | | | | | | volume. | | | | | | | | | | | | | | This IE | | | | | | | shall be | | | | | | | present | | | | | | | for a | | | | | | | Delay | | | | | | | Critical | | | | | | | GBR QoS | | | | | | | flow. | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.17 Type ChargingInformation
Table 5.6.2.17-1: Definition of type ChargingInformation
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | primaryC | Uri | M | 1 | URI, | | | hfAddress | | | | which | | | | | | | co | | | | | | | rresponds | | | | | | | to the | | | | | | | {apiRoot} | | | | | | | in the | | | | | | | form of | | | | | | | an FQDN | | | | | | | or | | | | | | | IPAdd | | | | | | | ress/Port | | | | | | | Number, | | | | | | | of the | | | | | | | primary | | | | | | | CHF | | | | | | | instance. | | | | | | | | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | s | Uri | M | 1 | URI, | | | econdaryC | | | | which | | | hfAddress | | | | co | | | | | | | rresponds | | | | | | | to the | | | | | | | {apiRoot} | | | | | | | in the | | | | | | | form of | | | | | | | an FQDN | | | | | | | or | | | | | | | IPAdd | | | | | | | ress/Port | | | | | | | Number, | | | | | | | of the | | | | | | | secondary | | | | | | | CHF | | | | | | | instance. | | | | | | | | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE: | | | | | | | Based on | | | | | | | the | | | | | | | {apiRoot} | | | | | | | in the | | | | | | | form of | | | | | | | an FQDN | | | | | | | of the | | | | | | | CHF | | | | | | | instance, | | | | | | | the | | | | | | | consumer | | | | | | | can | | | | | | | derive | | | | | | | the | | | | | | | N | | | | | | | finstance | | | | | | | via NRF | | | | | | | lookup. | | | | | | | It is up | | | | | | | to the | | | | | | | consumer | | | | | | | to | | | | | | | determine | | | | | | | which | | | | | | | service | | | | | | | to invoke | | | | | | | from the | | | | | | | CHF. The | | | | | | | {apiRoot} | | | | | | | shall | | | | | | | apply to | | | | | | | all CHF | | | | | | | services. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.18 Type AccuUsageReport
Table 5.6.2.18-1: Definition of type AccuUsageReport
* * *
Attribute name Data type P Cardinality Description Applicability refUmIds
string M 1 An id referencing UsageMonitoringData objects associated with this
usage report.  
volUsage Volume O 0..1 Indicates a total accumulated volume usage.  
volUsageUplink Volume O 0..1 Indicates an accumulated volume usage in uplink.  
volUsageDownlink Volume O 0..1 Indicates an accumulated volume usage in
downlink.  
timeUsage DurationSec O 0..1 Indicates an accumulated time usage.  
nextVolUsage Volume C 0..1 Indicates an accumulated volume usage after the
Monitoring Time.  
nextVolUsageUplink Volume O 0..1 Indicates an accumulated volume usage in
uplink after the Monitoring Time.  
nextVolUsageDownlink Volume O 0..1 Indicates an accumulated volume usage in
downlink after the Monitoring Time.  
nextTimeUsage DurationSec C 0..1 Indicates an accumulated time usage after the
Monitoring.
* * *
#### 5.6.2.19 Type SmPolicyUpdateContextData
Table 5.6.2.19-1: Definition of type SmPolicyUpdateContextData
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | repPol | array(P | C | 1..N | The | | | icyCtrlRe | olicyCont | | | policy | | | qTriggers | rolReques | | | control | | | | tTrigger) | | | request | | | | | | | triggers | | | | | | | which are | | | | | | | met. It | | | | | | | is | | | | | | | omitted | | | | | | | if no | | | | | | | triggers | | | | | | | are met | | | | | | | such as | | | | | | | in | | | | | | | subclause | | | | | | | s 4.2.4.7 | | | | | | | and | | | | | | | 4.2.4.15. | | +-----------+-----------+---+-----------+-----------+-----------+ | ac | array(Ac | O | 1..N | Indicates | | | cNetChIds | cNetChId) | | | the | | | | | | | access | | | | | | | network | | | | | | | charging | | | | | | | i | | | | | | | dentifier | | | | | | | for the | | | | | | | PCC | | | | | | | rule(s) | | | | | | | or whole | | | | | | | PDU | | | | | | | session. | | +-----------+-----------+---+-----------+-----------+-----------+ | a | A | O | 0..1 | The | | | ccessType | ccessType | | | Access | | | | | | | Type | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | ratType | RatType | O | 0..1 | The RAT | | | | | | | Type | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | servi | NetworkId | O | 0..1 | The | | | ngNetwork | | | | serving | | | | | | | network | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | userLoc | Use | O | 0..1 | The | | | ationInfo | rLocation | | | location | | | | | | | of the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | u | TimeZone | O | 0..1 | The time | | | eTimeZone | | | | zone | | | | | | | where the | | | | | | | served UE | | | | | | | is | | | | | | | camping. | | +-----------+-----------+---+-----------+-----------+-----------+ | ip | Ipv4Addr | O | 0..1 | The IPv4 | | | v4Address | | | | Address | | | | | | | of the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | ipDomain | string | O | 0..1 | IPv4 | | | | | | | address | | | | | | | domain | | | | | | | id | | | | | | | entifier. | | | | | | | | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | relIp | Ipv4Addr | O | 0..1 | Indicates | | | v4Address | | | | the | | | | | | | released | | | | | | | IPv4 | | | | | | | Address | | | | | | | of the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | ipv6Addr | I | O | 0..1 | The Ipv6 | | | essPrefix | pv6Prefix | | | Address | | | | | | | Prefix of | | | | | | | the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | re | I | O | 0..1 | Indicates | | | lIpv6Addr | pv6Prefix | | | the | | | essPrefix | | | | released | | | | | | | IPv6 | | | | | | | Address | | | | | | | Prefix of | | | | | | | the | | | | | | | served UE | | | | | | | in | | | | | | | mul | | | | | | | ti-homing | | | | | | | case. | | +-----------+-----------+---+-----------+-----------+-----------+ | relUeMac | MacAddr48 | O | 0..1 | Indicates | | | | | | | the | | | | | | | released | | | | | | | MAC | | | | | | | Address | | | | | | | of the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | ueMac | MacAddr48 | O | 0..1 | The MAC | | | | | | | Address | | | | | | | of the | | | | | | | served | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | sub | Ambr | O | 0..1 | S | | | sSessAmbr | | | | ubscribed | | | | | | | Sess | | | | | | | ion-AMBR. | | +-----------+-----------+---+-----------+-----------+-----------+ | s | Su | O | 0..1 | S | | | ubsDefQos | bscribedD | | | ubscribed | | | | efaultQos | | | Default | | | | | | | QoS | | | | | | | Inf | | | | | | | ormation. | | +-----------+-----------+---+-----------+-----------+-----------+ | numOfP | integer | O | 0..1 | Contains | | | ackFilter | | | | the | | | | | | | number of | | | | | | | supported | | | | | | | packet | | | | | | | filter | | | | | | | for | | | | | | | signalled | | | | | | | QoS | | | | | | | rules. | | | | | | | | | | | | | | (NOTE 1) | | +-----------+-----------+---+-----------+-----------+-----------+ | accuUsa | arra | O | 1..N | A | | | geReports | y(AccuUsa | | | ccumulate | | | | geReport) | | | usage | | | | | | | report. | | +-----------+-----------+---+-----------+-----------+-----------+ | 3 | boolean | O | 0..1 | If it is | | | gppPsData | | | | included | | | OffStatus | | | | and set | | | | | | | to true, | | | | | | | the 3GPP | | | | | | | PS Data | | | | | | | Off is | | | | | | | activated | | | | | | | by the | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | appDetec | array | O | 1..N | Reports | ADC | | tionInfos | (AppDetec | | | the | | | | tionInfo) | | | s | | | | | | | tart/stop | | | | | | | of the | | | | | | | ap | | | | | | | plication | | | | | | | traffic | | | | | | | and | | | | | | | detected | | | | | | | SDF | | | | | | | des | | | | | | | criptions | | | | | | | if | | | | | | | ap | | | | | | | plicable. | | +-----------+-----------+---+-----------+-----------+-----------+ | ru | array(Ru | O | 1..N | Used to | | | leReports | leReport) | | | report | | | | | | | the PCC | | | | | | | rule | | | | | | | failure. | | +-----------+-----------+---+-----------+-----------+-----------+ | sessRu | array( | O | 1..N | Used to | Sessio | | leReports | SessionRu | | | report | nRuleErro | | | leReport) | | | the | rHandling | | | | | | session | | | | | | | rule | | | | | | | failure. | | +-----------+-----------+---+-----------+-----------+-----------+ | q | array( | O | 1..N | QoS | | | ncReports | QosNotifi | | | Not | | | | cationCon | | | ification | | | | trolInfo) | | | Control | | | | | | | inf | | | | | | | ormation. | | +-----------+-----------+---+-----------+-----------+-----------+ | us | DateTime | O | 0..1 | Contains | | | erLocatio | | | | the NTP | | | nInfoTime | | | | time at | | | | | | | which the | | | | | | | UE was | | | | | | | last | | | | | | | known to | | | | | | | be in the | | | | | | | location. | | | | | | | (NOTE 3) | | +-----------+-----------+---+-----------+-----------+-----------+ | re | map(Pres | O | 1..N | Reports | PRA | | pPraInfos | enceInfo) | | | the | | | | | | | changes | | | | | | | of | | | | | | | presence | | | | | | | reporting | | | | | | | area. The | | | | | | | \"praId\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall | | | | | | | also be | | | | | | | the key | | | | | | | of the | | | | | | | map. The | | | | | | | \"presen | | | | | | | ceState\" | | | | | | | attribute | | | | | | | within | | | | | | | the | | | | | | | Pre | | | | | | | senceInfo | | | | | | | data type | | | | | | | shall be | | | | | | | supplied. | | +-----------+-----------+---+-----------+-----------+-----------+ | ueI | UeInitia | O | 0..1 | Indicates | | | nitResReq | tedResour | | | a UE | | | | ceRequest | | | requests | | | | | | | specific | | | | | | | QoS | | | | | | | handling | | | | | | | for | | | | | | | selected | | | | | | | SDF. | | +-----------+-----------+---+-----------+-----------+-----------+ | refQosI | boolean | O | 0..1 | If it is | | | ndication | | | | included | | | | | | | and set | | | | | | | to true, | | | | | | | the | | | | | | | r | | | | | | | eflective | | | | | | | QoS is | | | | | | | supported | | | | | | | by the | | | | | | | UE. If it | | | | | | | is | | | | | | | included | | | | | | | and set | | | | | | | to false, | | | | | | | the | | | | | | | r | | | | | | | eflective | | | | | | | QoS is | | | | | | | revoked | | | | | | | by the | | | | | | | UE. | | +-----------+-----------+---+-----------+-----------+-----------+ | qos | Qos | O | 0..1 | Indicates | | | FlowUsage | FlowUsage | | | the | | | | | | | required | | | | | | | usage for | | | | | | | default | | | | | | | QoS flow. | | +-----------+-----------+---+-----------+-----------+-----------+ | creditMan | Cred | O | 0..1 | Indicates | | | ageStatus | itManagem | | | the | | | | entStatus | | | reason of | | | | | | | the | | | | | | | credit | | | | | | | m | | | | | | | anagement | | | | | | | session | | | | | | | failure. | | +-----------+-----------+---+-----------+-----------+-----------+ | servNfId | ServingN | O | 0..1 | Contains | | | | fIdentity | | | the | | | | | | | serving | | | | | | | network | | | | | | | function | | | | | | | identity. | | +-----------+-----------+---+-----------+-----------+-----------+ | traceReq | TraceData | C | 0..1 | It shall | | | | | | | be | | | | | | | included | | | | | | | if trace | | | | | | | is | | | | | | | required | | | | | | | to be | | | | | | | a | | | | | | | ctivated, | | | | | | | modified | | | | | | | or | | | | | | | de | | | | | | | activated | | | | | | | (see | | | | | | | 3GPP | | | | | | | TS 32.422 | | | | | | | [24]). | | | | | | | For trace | | | | | | | modi | | | | | | | fication, | | | | | | | it shall | | | | | | | contain a | | | | | | | complete | | | | | | | re | | | | | | | placement | | | | | | | of trace | | | | | | | data. | | | | | | | | | | | | | | For trace | | | | | | | deac | | | | | | | tivation, | | | | | | | it shall | | | | | | | contain | | | | | | | the Null | | | | | | | value. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | This | | | | | | | attribute | | | | | | | is only | | | | | | | a | | | | | | | pplicable | | | | | | | to the | | | | | | | 5GS and | | | | | | | EP | | | | | | | C/E-UTRAN | | | | | | | int | | | | | | | erworking | | | | | | | scenario | | | | | | | as | | | | | | | defined | | | | | | | in Annex | | | | | | | B. | | | | | | | | | | | | | | NOTE 2: | | | | | | | The value | | | | | | | provided | | | | | | | in this | | | | | | | attribute | | | | | | | is | | | | | | | imple | | | | | | | mentation | | | | | | | specific. | | | | | | | The only | | | | | | | c | | | | | | | onstraint | | | | | | | is that | | | | | | | the SMF | | | | | | | shall | | | | | | | supply a | | | | | | | different | | | | | | | i | | | | | | | dentifier | | | | | | | for each | | | | | | | ov | | | | | | | erlapping | | | | | | | address | | | | | | | domain | | | | | | | (e.g. the | | | | | | | SMF NF | | | | | | | instance | | | | | | | ide | | | | | | | ntifier). | | | | | | | | | | | | | | NOTE 3: | | | | | | | The age | | | | | | | of UE | | | | | | | location | | | | | | | included | | | | | | | within | | | | | | | the | | | | | | | \"user | | | | | | | LocationI | | | | | | | nfoTime\" | | | | | | | attribute | | | | | | | is the | | | | | | | age of | | | | | | | the 3GPP | | | | | | | access UE | | | | | | | location | | | | | | | received | | | | | | | from the | | | | | | | AMF and | | | | | | | shall be | | | | | | | included | | | | | | | only when | | | | | | | the | | | | | | | reported | | | | | | | \" | | | | | | | userLocat | | | | | | | ionInfo\" | | | | | | | attribute | | | | | | | includes | | | | | | | the UE | | | | | | | location | | | | | | | in the | | | | | | | 3GPP | | | | | | | access. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.20 Type UpPathChgEvent
Table 5.6.2.20-1: Definition of type UpPathChgEvent
* * *
Attribute name Data type P Cardinality Description Applicability
notificationUri Uri M 1 Notification address of AF receiving the event
notification. TSC notifCorreId string M 1 It is used to set the value of
Notification Correlation ID in the notification sent by the SMF. TSC
dnaiChgType DnaiChangeType M 1 Indicates the type of DNAI change. TSC
* * *
#### 5.6.2.21 Type TerminationNotification
Table 5.6.2.21-1: Definition of type TerminationNotification
* * *
Attribute name Data type P Cardinality Description Applicability resourceUri
Uri M 1 The resource URI of the individual SM policy related to the
notification.  
cause PolicyAssociationReleaseCause M 1 The cause why the PCF requests the
termination of the policy association.
* * *
#### 5.6.2.22 Type AppDetectionInfo
Table 5.6.2.22-1: Definition of type AppDetectionInfo
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | appId | string | M | 1 | A | | | | | | | reference | | | | | | | to the | | | | | | | ap | | | | | | | plication | | | | | | | detection | | | | | | | filter | | | | | | | c | | | | | | | onfigured | | | | | | | at the | | | | | | | UPF. | | +-----------+-----------+---+-----------+-----------+-----------+ | i | string | O | 0..1 | I | | | nstanceId | | | | dentifier | | | | | | | dy | | | | | | | namically | | | | | | | assigned | | | | | | | by the | | | | | | | SMF in | | | | | | | order to | | | | | | | allow | | | | | | | co | | | | | | | rrelation | | | | | | | of | | | | | | | ap | | | | | | | plication | | | | | | | Start and | | | | | | | Stop | | | | | | | events to | | | | | | | the | | | | | | | specific | | | | | | | service | | | | | | | data flow | | | | | | | des | | | | | | | cription, | | | | | | | if | | | | | | | service | | | | | | | data flow | | | | | | | des | | | | | | | criptions | | | | | | | are | | | | | | | d | | | | | | | educible. | | +-----------+-----------+---+-----------+-----------+-----------+ | sdfDes | arra | O | 1..N | Contains | | | criptions | y(FlowInf | | | the | | | | ormation) | | | detected | | | | | | | service | | | | | | | data flow | | | | | | | des | | | | | | | criptions | | | | | | | if they | | | | | | | are | | | | | | | d | | | | | | | educible. | | | | | | | | | | | | | | When | | | | | | | present, | | | | | | | it shall | | | | | | | only | | | | | | | include | | | | | | | the | | | | | | | \ | | | | | | | "flowDesc | | | | | | | ription\" | | | | | | | and the | | | | | | | \"flowDi | | | | | | | rection\" | | | | | | | a | | | | | | | ttributes | | | | | | | of the | | | | | | | FlowIn | | | | | | | formation | | | | | | | data | | | | | | | type. | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.23 Type AccNetChId
Table 5.6.2.23-1: Definition of type AccNetChId
* * *
Attribute name Data type P Cardinality Description Applicability
accNetChaIdValue ChargingId M 1 Contains a charging identifier.  
refPccRuleIds array(string) O 1..N Contains the identifier of the PCC rule(s)
associated to the provided Access Network Charging Identifier.  
sessionChScope boolean O 0..1 When it is included and set to true, indicates
the Access Network Charging Identifier applies to the whole PDU Session.
* * *
#### 5.6.2.24 Type RequestedRuleData
Table 5.6.2.24-1: Definition of type RequestedRuleData
* * *
Attribute name Data type P Cardinality Description Applicability refPccRuleIds
array(string) M 1..N An array of PCC rule id references to the PCC rules
associated with the control data.  
reqData array(RequestedRuleDataType) M 1..N Array of requested rule data type
elements indicating what type of rule data is requested for the corresponding
referenced PCC rules.
* * *
#### 5.6.2.25 Type RequestedUsageData
Table 5.6.2.25-1: Definition of type RequestedUsageData
* * *
Attribute name Data type P Cardinality Description Applicability refUmIds
array(string) C 1..N An array of usage monitoring data id references to the
usage monitoring data instances for which the PCF is requesting a usage
report. This attribute shall only be provided when allUmIds is not set to
true.  
allUmIds boolean C 0..1 This boolean indicates whether requested usage data
applies to all usage monitoring data instances. When it\'s not included, it
means requested usage data shall only apply to the usage monitoring data
instances referenced by the refUmIds attribute.
* * *
#### 5.6.2.26 Type UeCampingRep
Table 5.6.2.26-1: Definition of type UeCampingRep
* * *
Attribute name Data type P Cardinality Description Applicability accessType
AccessType O 0..1 The Access Type where the served UE is camping.  
ratType RatType O 0..1 The RAT Type where the served UE is camping.  
servNfId ServingNfIdentity O 0..1 Contains the serving network function
identity.  
servingNetwork NetworkId O 0..1 The serving network where the served UE is
camping.  
userLocationInfo UserLocation O 0..1 The location of the served UE is camping.  
ueTimeZone TimeZone O 0..1 The time zone where the served UE is camping.  
netLocAccSupp NetLocAccessSupport O 0..1 Indicates the access network does not
support the report of the requested access network information. NetLoc
* * *
#### 5.6.2.27 Type RuleReport
Table 5.6.2.27-1: Definition of type RuleReport
* * *
Attribute name Data type P Cardinality Description Applicability pccRuleIds
array(string) M 1..N Contains the identifier of the affected PCC rule(s).  
ruleStatus RuleStatus M 1 Indicates the status of the PCC rule(s).  
contVers array(ContentVersion) C 1..N Indicates the version of the PCC rule.
If rule versioning feature is supported, the content version shall be included
if it was included when the corresponding PCC rule was installed or modified.
RuleVersioning failureCode FailureCode C 0..1 Indicates the reason that the
PCC Rule is being reported. It shall be included when the SMF reports the
enforcement failure of the PCC rule(s).  
finUnitAct FinalUnitAction O 0..1 Contains the related filter parameters and
redirect address parameters (if available), when the user\'s account cannot
cover the service cost.  
ranNasRelCauses array(RanNasRelCause) O 1..N Indicates the RAN or NAS release
cause code information. RAN-NAS-Cause
* * *
#### 5.6.2.28 Type RanNasRelCause
Table 5.6.2.28-1: Definition of type RanNasRelCause
* * *
Attribute name Data type P Cardinality Description Applicability ngApCause
NgApCause O 0..1 Indicates the cause value of NGAP protocol. RAN-NAS-Cause
5gMmCause 5GMmCause O 0..1 Indicates the cause value of 5GMM protocol. RAN-
NAS-Cause 5gSmCause 5GSmCause O 0..1 Indicates the cause value of 5GSM
protocol. RAN-NAS-Cause epsCause EpsRanNasRelCause O 0..1 Indicates the
RAN/NAS cause value for EPS. RAN-NAS-Cause
* * *
#### 5.6.2.29 Type UeInitiatedResourceRequest
Table 5.6.2.29-1: Definition of type UeInitiatedResourceRequest
* * *
Attribute name Data type P Cardinality Description Applicability pccRuleId
string C 1 Indicates a PCC rule corresponding to a QoS rule which is requested
to be modified or deleted by the UE.  
ruleOp RuleOperation M 1 Indicates an operation for the PCC rule.  
packFiltInfo array(PacketFilterInfo) M 1..N Contains the information from a
single packet filter sent from the SMF to the PCF.  
precedence integer O 0..1 The requested order for the PCC rule generated from
the QoS rule requested by the UE.  
reqQos RequestedQos O 0..1 Contains the QoS information requested by the UE.
* * *
#### 5.6.2.30 Type PacketFilterInfo
Table 5.6.2.30-1: Definition of type PacketFilterInfo
* * *
Attribute name Data type P Cardinality Description Applicability packFiltId
string O 0..1 An identifier of packet filter.  
packFiltCont PacketFilterContent O 0..1 Contains the content of the packet
filter as requested by the UE and required by the PCF to create the PCC rules.  
tosTrafficClass string O 0..1 2-octet string. The first octet contains the
Ipv4 Type-of-Service or the Ipv6 Traffic-Class field and the second octet
contains the ToS/Traffic mask field in hexadecimal representation. Each
character in the string shall take a value of \"0\" to \"9\" or \"A\" to \"F\"
and shall represent 4 bits. One example is that of a TFT packet filter as
defined in 3GPP TS 24.008 [39].  
spi string O 0..1 4 octet string, representing the security parameter index of
the IPSec packet in hexadecimal representation. Each character in the string
shall take a value of \"0\" to \"9\" or \"A\" to \"F\" and shall represent 4
bits. One example is that of a TFT packet filter as defined in 3GPP TS 24.008
[39].  
flowLabel string O 0..1 3-octet string, representing the Ipv6 flow label
header field in hexadecimal representation. Each character in the string shall
take a value of \"0\" to \"9\" or \"A\" to \"F\" and shall represent 4 bits.
One example is that of a TFT packet filter as defined in 3GPP TS 24.008 [39].  
flowDirection FlowDirection O 0..1 Indicates the direction/directions that a
filter is applicable, downlink only, uplink only or both down- and uplink
(bidirectional).
* * *
#### 5.6.2.31 Type RequestedQos
Table 5.6.2.31-1: Definition of type RequestedQos
* * *
Attribute name Data type P Cardinality Description Applicability 5qi 5Qi M 1
Identifier for the authorized QoS parameters for the service data flow.  
gbrUl BitRate O 0..1 Indicates the guaranteed bandwidth in uplink requested by
the UE.  
gbrDl BitRate O 0..1 Indicates the max guaranteed in downlink requested by the
UE.
* * *
#### 5.6.2.32 Type QosNotificationControlInfo
Table 5.6.2.32-1: Definition of type QosNotificationControlInfo
* * *
Attribute name Data type P Cardinality Description Applicability refPccRuleIds
array(string) M 1..N An array of PCC rule id references to the PCC rules
associated with the QosNotificationControlInfo.  
notifType QosNotifType M 1 Indicates whether the GBR targets for the indicated
SDFs are \"NOT_GUARANTEED\" or \"GUARANTEED\" again.  
contVers array(ContentVersion) C 1..N Indicates the version of the PCC rule.
If rule versioning feature is supported, the content version shall be included
if it was included when the corresponding PCC rule was installed or modified.
RuleVersioning
* * *
#### 5.6.2.33 Type PartialSuccessReport
Table 5.6.2.33-1: Definition of type PartialSuccessReport
* * *
Attribute name Data type P Cardinality Description Applicability failureCause
FailureCause M 1 Application error cause specific to this report.  
ruleReports array(RuleReport) C 1..N Information about the PCC rules
provisioned by the PCF not successfully installed/activated.  
sessRuleReports array(SessionRuleReport) O 1..N Information about the session
rules provisioned by the PCF not successfully installed.
SessionRuleErrorHandling ueCampingRep UeCampingRep O 0..1 Includes the current
applicable values corresponding to the provisioned policy control request
triggers.  
NOTE: The \"ruleReports\" shall be included if the SessionRuleErrorHandling
feature is not supported.
* * *
#### 5.6.2.34 Type AuthorizedDefaultQos
Table 5.6.2.34-1: Definition of type AuthorizedDefaultQos
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | 5qi | 5Qi | C | 0..1 | 5G QoS | | | | | | | Id | | | | | | | entifier. | | | | | | | It shall | | | | | | | be | | | | | | | included | | | | | | | when the | | | | | | | A | | | | | | | uthorized | | | | | | | Default | | | | | | | QoS is | | | | | | | initially | | | | | | | pro | | | | | | | visioned. | | +-----------+-----------+---+-----------+-----------+-----------+ | arp | Arp | C | 0..1 | Indicates | | | | | | | the | | | | | | | a | | | | | | | llocation | | | | | | | and | | | | | | | retention | | | | | | | priority. | | | | | | | It shall | | | | | | | be | | | | | | | included | | | | | | | when the | | | | | | | A | | | | | | | uthorized | | | | | | | Default | | | | | | | QoS is | | | | | | | initially | | | | | | | pro | | | | | | | visioned. | | +-----------+-----------+---+-----------+-----------+-----------+ | prio | 5QiPriori | O | 0..1 | Unsigned | | | rityLevel | tyLevelRm | | | integer | | | | | | | i | | | | | | | ndicating | | | | | | | the 5QI | | | | | | | Priority | | | | | | | Level, | | | | | | | within a | | | | | | | range of | | | | | | | 1 to 127. | | +-----------+-----------+---+-----------+-----------+-----------+ | a | Ave | O | 0..1 | Indicates | | | verWindow | rWindowRm | | | the | | | | | | | averaging | | | | | | | window. | | | | | | | | | | | | | | This IE | | | | | | | can be | | | | | | | present | | | | | | | only for | | | | | | | GBR QoS | | | | | | | flow or a | | | | | | | Delay | | | | | | | Critical | | | | | | | GBR QoS | | | | | | | flow. | | +-----------+-----------+---+-----------+-----------+-----------+ | maxDat | MaxDataB | O | 0..1 | Unsigned | | | aBurstVol | urstVolRm | | | integer | | | | | | | i | | | | | | | ndicating | | | | | | | the | | | | | | | maximum | | | | | | | data | | | | | | | burst | | | | | | | volume. | | | | | | | | | | | | | | This IE | | | | | | | can be | | | | | | | present | | | | | | | for a | | | | | | | Delay | | | | | | | Critical | | | | | | | GBR QoS | | | | | | | flow. | | +-----------+-----------+---+-----------+-----------+-----------+ | gbrUl | BitRateRm | O | 0..1 | Indicates | | | | | | | the | | | | | | | g | | | | | | | uaranteed | | | | | | | bandwidth | | | | | | | in | | | | | | | uplink. | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | gbrDl | BitRateRm | O | 0..1 | Indicates | | | | | | | the | | | | | | | g | | | | | | | uaranteed | | | | | | | bandwidth | | | | | | | in | | | | | | | downlink. | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | maxbrUl | BitRateRm | O | 0..1 | Indicates | | | | | | | the max | | | | | | | bandwidth | | | | | | | in | | | | | | | uplink. | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | maxbrDl | BitRateRm | O | 0..1 | Indicates | | | | | | | the max | | | | | | | bandwidth | | | | | | | in | | | | | | | downlink. | | | | | | | (NOTE) | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE: | | | | | | | This | | | | | | | attribute | | | | | | | is only | | | | | | | a | | | | | | | pplicable | | | | | | | to GBR | | | | | | | type 5QI | | | | | | | or delay | | | | | | | critical | | | | | | | GBR type. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.35 Type AccNetChargingAddress
Table 5.6.2.35-1: Definition of type AccNetChargingAddress
* * *
Attribute name Data type P Cardinality Description Applicability
anChargIpv4Addr Ipv4Addr O 0..1 Includes the IPv4 address of network entity
within the access network performing charging.  
anChargIpv6Addr Ipv6Addr O 0..1 Includes the IPv6 address of network entity
within the access network performing charging.  
NOTE: At least one address of the access network entity (the IPv4 address or
the IPv6 address or both if both addresses are available) shall be included.
* * *
#### 5.6.2.36 Type ErrorReport
Table 5.6.2.36-1: Definition of type ErrorReport
* * *
Attribute name Data type P Cardinality Description Applicability error
ProblemDetails M 1 More information on the error shall be provided in the
\"cause\" attribute of the \"ProblemDetails\" structure.  
ruleReports array(RuleReport) O 1..N Used to report the PCC rule failure.  
sessRuleReports array(SessionRuleReport) O 1..N Used to report the session
rule failure. SessionRuleErrorHandling
* * *
#### 5.6.2.37 Type SessionRuleReport
Table 5.6.2.37-1: Definition of type SessionRuleReport
* * *
Attribute name Data type P Cardinality Description Applicability ruleIds
array(string) M 1..N Contains the identifier of the affected session rule(s).  
ruleStatus RuleStatus M 1 Indicates the status of the session rule(s).  
sessRuleFailureCode SessionRuleFailureCode C 0..1 Indicates the reason that
the session rule(s) is being reported. It shall be included when the SMF
reports the enforcement failure of the session rule(s).
* * *
#### 5.6.2.38 Type ServingNfIdentity
Table 5.6.2.38-1: Definition of type ServingNfIdentity
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | ser | NfI | O | 0..1 | Network | | | vNfInstId | nstanceId | | | Function | | | | | | | Instance | | | | | | | I | | | | | | | dentifier | | | | | | | of the 5G | | | | | | | serving | | | | | | | CN node. | | | | | | | It | | | | | | | r | | | | | | | epresents | | | | | | | the AMF. | | +-----------+-----------+---+-----------+-----------+-----------+ | guami | Guami | O | 0..1 | Globally | | | | | | | Unique | | | | | | | AMF | | | | | | | Id | | | | | | | entifier. | | +-----------+-----------+---+-----------+-----------+-----------+ | anGwAddr | An | O | 0..1 | Contains | | | | GwAddress | | | the | | | | | | | access | | | | | | | network | | | | | | | control | | | | | | | gateway | | | | | | | address. | | | | | | | It | | | | | | | r | | | | | | | epresents | | | | | | | the S-GW | | | | | | | or ePDG | | | | | | | address. | | | | | | | (NOTE 2) | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE 1: | | | | | | | At least | | | | | | | one of | | | | | | | the | | | | | | | \"servNf | | | | | | | InstId\", | | | | | | | \ | | | | | | | "guami\", | | | | | | | or | | | | | | | \"a | | | | | | | nGwAddr\" | | | | | | | a | | | | | | | ttributes | | | | | | | shall be | | | | | | | present. | | | | | | | | | | | | | | NOTE 2: | | | | | | | \"a | | | | | | | nGwAddr\" | | | | | | | attribute | | | | | | | is only | | | | | | | a | | | | | | | pplicable | | | | | | | to the | | | | | | | 5GS and | | | | | | | EPC | | | | | | | (E-UTRAN | | | | | | | and | | | | | | | non-3GPP | | | | | | | access) | | | | | | | int | | | | | | | erworking | | | | | | | scenario | | | | | | | as | | | | | | | defined | | | | | | | in | | | | | | | Annex B. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
### 5.6.3 Simple data types and enumerations
#### 5.6.3.1 Introduction
This subclause defines simple data types and enumerations that can be
referenced from data structures defined in the previous subclauses.
#### 5.6.3.2 Simple data types
The simple data types defined in table 5.6.3.2-1 shall be supported. For
additional simple data types see 3GPP TS 29.571 [11].
Table 5.6.3.2-1: Simple data types
+----------------+----------------+----------------+---------------+ | Type Name | Type | Description | Applicability | | | Definition | | | +----------------+----------------+----------------+---------------+ | 5GSmCause | Uinteger | Indicates the | RAN-NAS-Cause | | | | 5GSM cause | | | | | code value as | | | | | defined in | | | | | subc | | | | | lause 9.11.4.2 | | | | | of | | | | | 3GPP TS | | | | | 24.501 [20]. | | +----------------+----------------+----------------+---------------+ | Eps | string | Indicates the | RAN-NAS-Cause | | RanNasRelCause | | RAN or NAS | | | | | release cause | | | | | code | | | | | information in | | | | | 3GPP-EPS | | | | | access type or | | | | | indicates the | | | | | untrusted WLAN | | | | | release cause | | | | | code | | | | | information in | | | | | Non-3GPP-EPS | | | | | access type. | | | | | It shall be | | | | | coded as per | | | | | the RAN/NAS | | | | | Cause in | | | | | s | | | | | ubclause 8.103 | | | | | of | | | | | 3GPP TS | | | | | 29.274 [37], | | | | | starting with | | | | | Octet 5. | | | | | | | | | | (NOTE) | | +----------------+----------------+----------------+---------------+ | F | string | Defines a | | | lowDescription | | packet filter | | | | | for an IP | | | | | flow. | | | | | | | | | | Refer to | | | | | s | | | | | ubclause 5.4.2 | | | | | of | | | | | 3GPP TS | | | | | 29.212 [23] | | | | | for encoding. | | +----------------+----------------+----------------+---------------+ | Packe | string | Defines a | | | tFilterContent | | packet filter | | | | | for an IP | | | | | flow. | | | | | | | | | | Refer to | | | | | su | | | | | bclause 5.3.54 | | | | | of | | | | | 3GPP TS | | | | | 29.212 [23] | | | | | for encoding. | | +----------------+----------------+----------------+---------------+ | NOTE: Trusted | | | | | WLAN release | | | | | cause code | | | | | information is | | | | | not applicable | | | | | to this | | | | | Release of the | | | | | specification. | | | | +----------------+----------------+----------------+---------------+
#### 5.6.3.3 Enumeration: FlowDirection
Table 5.6.3.3-1: Enumeration FlowDirection
* * *
Enumeration value Description Applicability DOWNLINK The corresponding filter
applies for traffic to the UE.  
UPLINK The corresponding filter applies for traffic from the UE.  
BIDIRECTIONAL The corresponding filter applies for traffic both to and from
the UE.  
UNSPECIFIED The corresponding filter applies for traffic to the UE (downlink),
but has no specific direction declared. The service data flow detection shall
apply the filter for uplink traffic as if the filter was bidirectional. The
PCF shall not use the value UNSPECIFIED in filters created by the network in
NW-initiated procedures. The PCF shall only include the value UNSPECIFIED in
filters in UE-initiated procedures if the same value is received from the SMF.
* * *
#### 5.6.3.4 Enumeration: ReportingLevel
Table 5.6.3.4-1: Enumeration ReportingLevel
* * *
Enumeration value Description Applicability SER_ID_LEVEL Indicates that the
usage shall be reported on service id and rating group combination level.  
RAT_GR_LEVEL Indicates that the usage shall be reported on rating group level.  
SPON_CON_LEVEL Indicates that the usage shall be reported on sponsor identity
and rating group combination level.
* * *
#### 5.6.3.5 Enumeration: MeteringMethod
Table 5.6.3.5-1: Enumeration MeteringMethod
* * *
Enumeration value Description Applicability DURATION Indicates that the
duration of the service data flow traffic shall be metered.  
VOLUME Indicates that volume of the service data flow traffic shall be
metered.  
DURATION_VOLUME Indicates that the duration and the volume of the service data
flow traffic shall be metered.  
EVENT Indicates that events of the service data flow traffic shall be metered.
* * *
#### 5.6.3.6 Enumeration: PolicyControlRequestTrigger
Table 5.6.3.6-1: Enumeration PolicyControlRequestTrigger
+----------------------+----------------------+----------------------+ | Enumeration value | Description | Applicability | +----------------------+----------------------+----------------------+ | PLMN_CH | PLMN Change. | | +----------------------+----------------------+----------------------+ | RES_MO_RE | A request for | | | | resource | | | | modification has | | | | been received by the | | | | SMF. | | | | | | | | (NOTE) | | +----------------------+----------------------+----------------------+ | AC_TY_CH | Access Type Change. | | +----------------------+----------------------+----------------------+ | UE_IP_CH | UE IP address | | | | change. (NOTE) | | +----------------------+----------------------+----------------------+ | UE_MAC_CH | A new UE MAC address | | | | is detected or a | | | | used UE MAC address | | | | is inactive for a | | | | specific period. | | +----------------------+----------------------+----------------------+ | AN_CH_COR | Access Network | | | | Charging Correlation | | | | Information. | | +----------------------+----------------------+----------------------+ | US_RE | The PDU Session or | UMC | | | the Monitoring key | | | | specific resources | | | | consumed by a UE | | | | either reached the | | | | threshold or needs | | | | to be reported for | | | | other reasons. | | +----------------------+----------------------+----------------------+ | APP_STA | The start of | ADC | | | application traffic | | | | has been detected. | | +----------------------+----------------------+----------------------+ | APP_STO | The stop of | ADC | | | application traffic | | | | has been detected. | | +----------------------+----------------------+----------------------+ | AN_INFO | Access Network | NetLoc | | | Information report. | | +----------------------+----------------------+----------------------+ | CM_SES_FAIL | Credit management | | | | session failure. | | +----------------------+----------------------+----------------------+ | PS_DA_OFF | The SMF reports when | 3GPP-PS-Data-Off | | | the 3GPP PS Data Off | | | | status changes. | | | | (NOTE) | | +----------------------+----------------------+----------------------+ | DEF_QOS_CH | Default QoS Change. | | | | (NOTE) | | +----------------------+----------------------+----------------------+ | SE_AMBR_CH | Session AMBR Change. | | | | (NOTE) | | +----------------------+----------------------+----------------------+ | QOS_NOTIF | The SMF notify the | | | | PCF when receiving | | | | notification from | | | | RAN that QoS targets | | | | of the QoS Flow | | | | cannot be guaranteed | | | | or can be | | | | guaranteed. | | +----------------------+----------------------+----------------------+ | NO_CREDIT | Out of credit. | | +----------------------+----------------------+----------------------+ | PRA_CH | Change of UE | PRA | | | presence in Presence | | | | Reporting Area. | | +----------------------+----------------------+----------------------+ | SAREA_CH | Location Change with | | | | respect to the | | | | Serving Area. | | +----------------------+----------------------+----------------------+ | SCNN_CH | Location Change with | | | | respect to the | | | | Serving CN node. | | +----------------------+----------------------+----------------------+ | RE_TIMEOUT | Indicates the SMF | | | | generated the | | | | request because | | | | there has been a PCC | | | | revalidation timeout | | | | (i.e. Enforced PCC | | | | rule request defined | | | | in table 6.1.3.5.-1 | | | | of | | | | 3G | | | | PP TS 23.503 [6]). | | +----------------------+----------------------+----------------------+ | RES_RELEASE | Indicates that the | RAN-NAS-Cause | | | SMF can inform the | | | | PCF of the outcome | | | | of the release of | | | | resources for those | | | | rules that require | | | | so. | | +----------------------+----------------------+----------------------+ | SUCC_RES_ALLO | Indicates that the | | | | SMF shall inform the | | | | PCF of the | | | | successful resource | | | | allocation for those | | | | rules that requires | | | | so. | | +----------------------+----------------------+----------------------+ | RAT_TY_CH | RAT type change. | | +----------------------+----------------------+----------------------+ | REF_QOS_IND_CH | Reflective QoS | | | | indication Change. | | +----------------------+----------------------+----------------------+ | NUM | Indicates that the | | | _OF_PACKET_FILTER | SMF shall report the | | | | number of supported | | | | packet filter for | | | | signalled QoS rules. | | | | (NOTE) Only | | | | applicable to the | | | | interworking | | | | scenario as defined | | | | in Annex B. | | +----------------------+----------------------+----------------------+ | UE_STATUS_RESUME | Indicates that the | Policy | | | UE's status is | UpdateWhenUESuspends | | | resumed. Only | | | | applicable to the | | | | interworking | | | | scenario as defined | | | | in Annex B. | | +----------------------+----------------------+----------------------+ | UE_TZ_CH | UE Time Zone Change. | | +----------------------+----------------------+----------------------+ | NOTE: The SMF always | | | | reports to the PCF. | | | +----------------------+----------------------+----------------------+
The PCF may provision the values of policy control request trigger which are
not always reported by the SMF as defined in subclause 4.2.6.4.
When the SMF detects the corresponding policy control request trigger(s), the
SMF shall report the detected trigger(s) to the PCF as defined in subclause
4.2.4.1 with the additional information for different independent policy
control request triggers as follows:
If the \"PLMN_CH\" is provisioned, when the SMF detects a change of PLMN, the
SMF shall include the \"PLMN_CH\" within the \"repPolicyCtrlReqTriggers\"
attribute and the current identifier of the serving network within the
\"servingNetwork\" attribute.
When the SMF receives the resource modification request from the UE, the SMF
shall include the \"RES_MO_RE\" within the \"repPolicyCtrlReqTriggers\"
attribute and the information for requesting the PCC rule as defined in
subclause 4.2.4.17.
If the \"AC_TY_CH\" is provisioned, when the SMF detects a change of access
type, the SMF shall include the \"AC_TY_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and the current access type within the
\"accessType\" attribute. The RAT type encoded in the \"ratType\" attribute
shall also be provided when applicable to the specific access type. Specific
attributes for the EPC interworking case are described in Annex B.
When the SMF detects an IPv4 address and/or an IPv6 prefix is allocated or
released, the SMF shall include the \"UE_IP_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and new allocated UE Ipv4 address
within the \"ipv4Address\" attribute and/or the UE Ipv6 prefix within the
\"ipv6AddressPrefix\" attribute or the released UE Ipv4 address within the
\"relIpv4Address\" attribute and/or the UE Ipv6 prefix within the
\"relIpv6AddressPrefix\" attribute.
When the SMF detects a new UE MAC address or a used UE MAC address is not used
any more, the SMF shall include the \"UE_MAC_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and new detected UE MAC address within
the \"ueMac\" attribute or the not used UE MAC address within the \"relUeMac\"
attribute.
If the \"AN_CH_COR\" is provisioned, when the SMF is provisioned with the PCC
rule as defined in subclause 4.2.6.5.1, the SMF shall notify the PCF of access
network charging identifier associated with the PCC rules as defined in
subclause 4.2.4.13.
If the \"US_RE\" is provisioned, when the SMF receives the usage report from
the UPF, the SMF shall notify the PCF of the accumulated usage as defined in
subclause 4.2.4.10. Applicable to functionality introduced with the UMC
feature as described in subclause 5.8.
If the \"APP_STA\" is provisioned, when the SMF receives the application start
report from the UPF, the SMF shall notify the PCF of the application start
report as defined in subclause 4.2.4.6. Applicable to functionality introduced
with the ADC feature as described in subclause 5.8.
If the \"APP_STO\" is provisioned, when the SMF receives the application stop
report from the UPF, the SMF shall notify the PCF of the application stop
report as defined in subclause 4.2.4.6. Applicable to functionality introduced
with the ADC feature as described in subclause 5.8.
If the \"AN_INFO\" is provisioned, when the SMF receives the reported access
network information from the access network, the SMF shall notify the PCF of
the access network information as defined in subclause 4.2.4.9. Applicable to
functionality introduced with the NetLoc feature as described in subclause
5.8.
If the \"CM_SES_FAIL\" is provisioned, when the SMF receives a detected
transient/permanent failure from the CHF, the SMF shall include the
\"CM_SES_FAIL\" within the \"repPolicyCtrlReqTriggers\" attribute. If the
failure does not apply to all PCC Rules, the affected PCC Rules are indicated
within the \"ruleReports\" attribute, with the \"ruleStatus\" attribute set to
value ACTIVE and the \"failureCode\" attribute set to the corresponding value
as reported by the CHF; otherwise if the failure applies to the session, the
\"creditManageStatus\" shall be set to the corresponding value as reported by
the CHF.
If the \"PS_DA_OFF\" is provisioned, when the SMF receives a change of 3GPP PS
Data Off status from the UE, the SMF shall notify the PCF as defined in
subclause 4.2.4.8. Applicable to functionality introduced with the 3GPP-PS-
Data-Off feature as described in subclause 5.8.
When the SMF detects a change of subscribed default QoS, the SMF shall include
the \"DEF_QOS_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the
new subscribed default QoS within the \"subsDefQos\" attribute.
When the SMF detects a change of subscribed Session-AMBR, the SMF shall
include the \"SE_AMBR_CH\" within the \"repPolicyCtrlReqTriggers\" attribute
and the new subscribed Session-AMBR within the \"subsSessAmbr\" attribute.
If the \"QOS_NOTIF\" is provisioned, when the SMF receives a notification from
access network that QoS targets of the QoS Flow cannot be guaranteed or can be
guaranteed again, the SMF shall send the notification as defined in subclause
4.2.4.20.
If the \"NO_CREDIT\" is provisioned, when the SMF detects the credit for the
PCC rule(s) is no longer available, the SMF shall include the \"NO_CREDIT\"
within the \"repPolicyCtrlReqTriggers\" attribute, the termination action the
SMF applies to the PCC rules as instructed by the CHF within the
\"finUnitAct\" attribute and the affected PCC rules within the \"ruleReports\"
attribute.
If the \"PRA_CH\" is provisioned, to detect when the UE enters/leaves certain
presence reporting areas, the SMF is provisioned with the presence reporting
area information as defined in subclause 4.2.6.5.6. When the SMF receives the
presence reporting area information from the serving node, the SMF shall
notify the PCF of the reported presence area information as defined in
subclause 4.2.4.16. This includes the reporting of the initial status at the
time the request for reports is initiated. Applicable to functionality
introduced with the PRA feature as described in subclause 5.8.
If the \"SAREA_CH\" is provisioned, when the SMF detects a change of serving
area (i.e. tracking area), the SMF shall include the \"SAREA_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and the current TAI within the
\"userLocationInfo\" attribute in either the \"eutraLocation\" or
\"nrLocation\", as applicable. Non-3GPP access user location is reported in
the \"n3gaLocation\" attribute when applicable. The attributes used in case of
EPC interworking are described in Annex B.
If the \"SCNN_CH\" is provisioned, when the SMF detects a change of serving
Network Function (i.e. the AMF, ePDG or S-GW), the SMF shall include the
\"SCNN_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current
serving Network Function in the \"servNfId\" attribute. When the serving
Network Function is an AMF, the SMF shall include the AMF Network Function
Instance Identifier within the \"servNfInstId\" attribute and the Globally
Unique AMF Identifier within the \"guami\" attribute. The attributes included
in case of EPC interworking are described in Annex B.
If the \"RE_TIMEOUT\" is provisioned, when the SMF is provisioned with the
revalidation time by the PCF, the SMF shall request the policy before the
indicated revalidation time is reached as defined in subclause 4.2.4.3.
If the \"RES_RELEASE\" is provisioned, when the SMF receives the request of
PCC rule removal as defined in subclause 4.2.6.5.2, the SMF shall report the
outcome of resource release as defined in subclause 4.2.4.12. Applicable to
functionality introduced with the RAN-NAS-Cause feature as described in
subclause 5.8.
When \"SUCC_RES_ALLO\" is provisioned and PCC rules are provisioned according
to subclause 4.2.6.5.5, the SMF shall inform the PCF of the successful
resource allocation as defined in subclause 4.2.4.14.
If the \"RAT_TY_CH\" is provisioned, when the SMF detects a change of the RAT
type, the SMF shall include the \"RAT_TY_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and the current RAT type within the
\"ratType\" attribute.
If the \"REF_QOS_IND_CH\" is provisioned, when the SMF receives a change of
reflective QoS indication from the UE, the SMF shall include the
\"REF_QOS_IND_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the
indication within the \"refQosIndication\" attribute.
When the SMF receives the number of supported packet filter for signalled QoS
rules for the PDU session from the UE during the PDU Session Modification
procedure after the first inter-system change from EPS to 5GS for a PDU
Session established in EPS and transferred from EPS with N26 interface, the
SMF shall include the \"NUM_OF_PACKET_FILTER\" within the
\"repPolicyCtrlReqTriggers\" attribute and the number of supported packet
filter for signalled QoS rules within the \"numOfPackFilter\" attribute. Only
applicable to the interworking scenario as defined in Annex B.
If the \"UE_STATUS_RESUME\" is provisioned, when the SMF detected the UE's
status is resumed from suspend state, the SMF shall inform the PCF of the UE
status including the \"UE_STATUS_RESUME\" within \"repPolicyCtrlReqTriggers\"
attribute. The PCF shall after this update the SMF with PCC Rules or session
rules if necessary. Applicable to functionality introduced with the
PolicyUpdateWhenUESuspends feature as described in subclause 5.8.
If the \"UE_TZ_CH\" is provisioned, when the SMF detects a change of the UE
Time Zone, the SMF shall include the \"UE_TZ_CH\" within the
\"repPolicyCtrlReqTriggers\" attribute and the current UE Time Zone within the
\"ueTimeZone\" attribute.
#### 5.6.3.7 Enumeration: RequestedRuleDataType
Table 5.6.3.7-1: Enumeration RequestedRuleDataType
* * *
Enumeration value Description Applicability CH_ID Indicates that the requested
rule data is the charging identifier.  
MS_TIME_ZONE Indicates that the requested access network info type is the
UE\'s timezone. (NOTE)  
USER_LOC_INFO Indicates that the requested access network info type is the
UE\'s location. (NOTE)  
RES_RELEASE Indicates that the requested rule data is the result of the
release of resource.  
SUCC_RES_ALLO Indicates that the requested rule data is the successful
resource allocation.  
NOTE: The requested rule data shall also be reported at QoS flow termination
and PDU session termination.
* * *
#### 5.6.3.8 Enumeration: RuleStatus
Table 5.6.3.8-1: Enumeration RuleStatus
* * *
Enumeration value Description Applicability ACTIVE Indicates that the PCC
rule(s) are successfully installed (for those provisioned from PCF) or
activated (for those pre-defined in SMF), or the session rule(s) are
successfully installed.  
INACTIVE Indicates that the PCC rule(s) are removed (for those provisioned
from PCF) or inactive (for those pre-defined in SMF) or the session rule(s)
are removed.
* * *
#### 5.6.3.9 Enumeration: FailureCode
Table 5.6.3.9-1: Enumeration FailureCode
+----------------------+----------------------+----------------------+ | Enumeration value | Description | Applicability | +----------------------+----------------------+----------------------+ | UNK_RULE_ID | Indicates that the | | | | pre-provisioned PCC | | | | rule could not be | | | | successfully | | | | activated because | | | | the PCC rule | | | | identifier is | | | | unknown to the SMF. | | +----------------------+----------------------+----------------------+ | RA_GR_ERR | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed or | | | | enforced because the | | | | Rating Group | | | | specified within the | | | | Charging Data policy | | | | decision which the | | | | PCC rule refers to | | | | is unknown or, | | | | invalid. | | +----------------------+----------------------+----------------------+ | SER_ID_ERR | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed or | | | | enforced because the | | | | Service Identifier | | | | specified within the | | | | Charging Data policy | | | | decision which the | | | | PCC rule refers to | | | | is invalid, unknown, | | | | or not applicable to | | | | the service being | | | | charged. | | +----------------------+----------------------+----------------------+ | NF_MAL | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed (for those | | | | provisioned from the | | | | PCF) or activated | | | | (for those | | | | pre-defined in SMF) | | | | or enforced (for | | | | those already | | | | successfully | | | | installed) due to | | | | SMF/UPF malfunction. | | +----------------------+----------------------+----------------------+ | RES_LIM | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed (for those | | | | provisioned from | | | | PCF) or activated | | | | (for those | | | | pre-defined in SMF) | | | | or enforced (for | | | | those already | | | | successfully | | | | installed) due to a | | | | limitation of | | | | resources at the | | | | SMF/UPF. | | +----------------------+----------------------+----------------------+ | MAX_NR_QoS_FLOW | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed (for those | | | | provisioned from | | | | PCF) or activated | | | | (for those | | | | pre-defined in SMF) | | | | or enforced (for | | | | those already | | | | successfully | | | | installed) due to | | | | the fact that the | | | | maximum number of | | | | QoS flows has been | | | | reached for the PDU | | | | session. | | +----------------------+----------------------+----------------------+ | MISS_FLOW_INFO | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed or | | | | enforced because | | | | neither the | | | | \"flowInfos\" | | | | attribute nor | | | | \"appId\" attribute | | | | is specified within | | | | the PccRule data | | | | structure by the PCF | | | | during the first | | | | install request of | | | | the PCC rule. | | +----------------------+----------------------+----------------------+ | RES_ALLO_FAIL | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed or | | | | maintained since the | | | | QoS flow | | | | establ | | | | ishment/modification | | | | failed, or the QoS | | | | flow was released. | | +----------------------+----------------------+----------------------+ | UNSUCC_QOS_VAL | This value is used | | | | to: | | | | | | | | - indicate that the | | | | QoS validation has | | | | failed or, | | | | | | | | - Indicate when | | | | Guaranteed Bandwidth | | | | > | | | | Max- | | | | Requested-Bandwidth. | | +----------------------+----------------------+----------------------+ | INCOR_FLOW_INFO | Indicates that the | | | | PCC rule could not | | | | be successfully | | | | installed or | | | | modified at the SMF | | | | because the provided | | | | flow information is | | | | not supported by the | | | | network (e.g. the | | | | provided IP | | | | address(es) or Ipv6 | | | | prefix(es) do not | | | | correspond to an IP | | | | version applicable | | | | for the PDU | | | | session). | | +----------------------+----------------------+----------------------+ | PS_TO_CS_HAN | Indicates that the | | | | PCC rule could not | | | | be maintained | | | | because of PS to CS | | | | handover. | | +----------------------+----------------------+----------------------+ | APP_ID_ERR | Indicates that the | ADC | | | PCC rule could not | | | | be successfully | | | | installed or | | | | enforced because the | | | | Application | | | | Identifier is | | | | invalid, unknown, or | | | | not applicable to | | | | the application | | | | required for | | | | detection. | | +----------------------+----------------------+----------------------+ | NO_QOS_FLOW_BOUND | Indicates that there | | | | is no QoS flow which | | | | the SMF can bind the | | | | PCC rule(s) to. | | +----------------------+----------------------+----------------------+ | FILTER_RES | Indicates that the | | | | Flow Information | | | | within the | | | | \"flowInfos\" cannot | | | | be handled by the | | | | SMF because any of | | | | the restrictions | | | | defined in | | | | subclause 5.4.2 of | | | | 3 | | | | GPP TS 29.212 [23] | | | | was not met. | | +----------------------+----------------------+----------------------+ | M | Indicates that the | ADC | | ISS_REDI_SER_ADDR | PCC rule could not | | | | be successfully | | | | installed or | | | | enforced at the SMF | | | | because there is no | | | | valid Redirect | | | | Server Address | | | | within the Traffic | | | | Control Data policy | | | | decision which the | | | | PCC rule refers to, | | | | provided by the PCF, | | | | and no preconfigured | | | | redirection address | | | | for this PCC rule at | | | | the SMF/UPF. | | +----------------------+----------------------+----------------------+ | CM_EN | Indicates that the | | | D_USER_SER_DENIED | charging system | | | | denied the service | | | | request due to | | | | service restrictions | | | | (e.g. terminate | | | | rating group) or | | | | limitations related | | | | to the end-user, for | | | | example the | | | | end-user\'s account | | | | could not cover the | | | | requested service. | | +----------------------+----------------------+----------------------+ | CM_C | Indicates that the | | | REDIT_CON_NOT_APP | charging system | | | | determined that the | | | | service can be | | | | granted to the end | | | | user but no further | | | | credit control is | | | | needed for the | | | | service (e.g. | | | | service is free of | | | | charge or is treated | | | | for offline | | | | charging). | | +----------------------+----------------------+----------------------+ | CM_AUTH_REJ | Indicates that the | | | | charging system | | | | denied the service | | | | request in order to | | | | terminate the | | | | service for which | | | | credit is requested. | | +----------------------+----------------------+----------------------+ | CM_USER_UNK | Indicates that the | | | | specified end user | | | | could not be found | | | | in the charging | | | | system. | | +----------------------+----------------------+----------------------+ | CM_RAT_FAILED | Indicates that the | | | | charging system | | | | cannot rate the | | | | service request due | | | | to insufficient | | | | rating input, | | | | incorrect AVP | | | | combination or due | | | | to an attribute or | | | | an attribute value | | | | that is not | | | | recognized or | | | | supported in the | | | | rating. | | +----------------------+----------------------+----------------------+ | UE_STA_SUSP | Indicates that the | Policy | | | UE is in suspend | UpdateWhenUESuspends | | | state. Only | | | | applicable to the | | | | interworking | | | | scenario as defined | | | | in Annex B. | | +----------------------+----------------------+----------------------+
#### 5.6.3.10 Enumeration: AfSigProtocol
Table 5.6.3.10-1: Enumeration AfSigProtocol
* * *
Enumeration value Description Applicability NO_INFORMATION Indicate that no
information about the AF signalling protocol is being provided.
ProvAFsignalFlow SIP Indicate that the signalling protocol is Session
Initiation Protocol. ProvAFsignalFlow
* * *
#### 5.6.3.11 Enumeration: RuleOperation
Table 5.6.3.11-1: Enumeration RuleOperation
+-------------------------+-------------------------+---------------+ | Enumeration value | Description | Applicability | +-------------------------+-------------------------+---------------+ | CREATE_PCC_RULE | Indicates to create a | | | | new PCC rule to reserve | | | | the resource requested | | | | by the UE. | | +-------------------------+-------------------------+---------------+ | DELETE_PCC_RULE | Indicates to delete a | | | | PCC rule corresponding | | | | to reserve the resource | | | | requested by the UE. | | +-------------------------+-------------------------+---------------+ | MODIFY_PCC_RULE_AN | Indicates to modify the | | | D_ADD_PACKET_FILTERS | PCC rule by adding new | | | | packet filter(s). | | +-------------------------+-------------------------+---------------+ | MODIFY_ | Indicates to modify the | | | | PCC rule by replacing | | | PCC_RULE_AND_R | the existing packet | | | EPLACE_PACKET_FILTERS | filter(s). | | | | | | | (NOTE) | | | +-------------------------+-------------------------+---------------+ | MODIFY_ | Indicates to modify the | | | PCC_RULE_AND_ | PCC rule by deleting | | | DELETE_PACKET_FILTERS | the existing packet | | | | filter(s). | | | (NOTE) | | | +-------------------------+-------------------------+---------------+ | MODIF | Indicates to modify the | | | Y_PCC_RULE_WITHOUT_ | PCC rule by modifying | | | MODIFY_PACKET_FILTERS | the QoS of the PCC | | | | rule. | | +-------------------------+-------------------------+---------------+ | NOTE: The enumeration | | | | value does not follow | | | | the related naming | | | | convention (i.e. | | | | \"UPP | | | | ER_WITH_UNDERSCORE\") | | | | defined in clause 5.1.4 | | | | of | | | | 3GPP TS 29.501 [5]. | | | | There is a space | | | | between the | | | | \"MODIFY_\" part and | | | | the \"PCC\" part. This | | | | enumeration value is | | | | however kept as | | | | currently defined in | | | | this specification for | | | | backward compatibility | | | | considerations. | | | +-------------------------+-------------------------+---------------+
#### 5.6.3.12 Enumeration: RedirectAddressType
Table 5.6.3.12-1: Enumeration RedirectAddressType
* * *
Enumeration value Description Applicability IPV4_ADDR Indicates that the
address type is in the form of \"dotted-decimal\" IPv4 address.  
IPV6_ADDR Indicates that the address type is in the form of IPv6 address.  
URL Indicates that the address type is in the form of Uniform Resource
Locator.  
SIP_URI Indicates that the address type is in the form of SIP Uniform Resource
Identifier.
* * *
#### 5.6.3.13 Enumeration: QosFlowUsage
Table 5.6.3.13-1: Enumeration QosFlowUsage
* * *
Enumeration value Description Applicability GENERAL Indicates no specific QoS
flow usage information is available.  
IMS_SIG Indicates that the QoS flow is used for IMS signalling only.
* * *
#### 5.6.3.14 Enumeration: FailureCause
Table 5.6.3.14-1: Enumeration FailureCause
* * *
Enumeration value Description Applicability PCC_RULE_EVENT Some of the PCC
rules provisioned by the PCF in the request cannot be installed/activated. It
is used to inform the PCF that the request failed and should not be attempted
again.  
PCC_QOS_FLOW_EVENT For some reason some of the PCC rules provisioned by the
PCF in the request cannot be enforced or modified successfully in a network
initiated procedure. It is used to inform the PCF that the request could not
be satisfied at the time it was received, but may be able to satisfy the
request in the future.  
RULE_PERMANENT_ERROR The HTTP request is rejected because some of the PCC
and/or session rules provisioned by the PCF in the request cannot be
installed/activated. It is used to inform the PCF that the request failed, and
should not be attempted again. SessionRuleErrorHandling RULE_TEMPORARY_ERROR
The HTTP request is rejected because for some reason some of the PCC and/or
session rules provisioned by the PCF in the request cannot be enforced or
modified successfully in a network initiated procedure. It is used to inform
the PCF that the request could not be satisfied at the time it was received,
but may be able to satisfy the request in the future. SessionRuleErrorHandling
* * *
#### 5.6.3.15 Enumeration: FlowDirectionRm
This data type is defined in the same way as the \"FlowDirection\" data type,
but with the OpenAPI \"nullable: true\" property.
#### 5.6.3.16 Enumeration: CreditManagementStatus
Table 5.6.3.16-1: Enumeration CreditManagementStatus
* * *
Enumeration value Description Applicability END_USER_SER_DENIED Indicates that
the charging system denied the service request due to service restrictions
(e.g. terminate rating group) or limitations related to the end-user, for
example the end-user\'s account could not cover the requested service.  
CREDIT_CTRL_NOT_APP Indicates that the charging system determined that the
service can be granted to the end user but no further credit control is needed
for the service (e.g. service is free of charge or is treated for offline
charging).  
AUTH_REJECTED Indicates that the charging system denied the service request in
order to terminate the service for which credit is requested.  
USER_UNKNOWN Indicates that the specified end user could not be found in the
charging system.  
RATING_FAILED Indicates that the charging system cannot rate the service
request due to insufficient rating input, incorrect attribute combination or
an attribute value that is not recognized or supported in rating.
* * *
#### 5.6.3.17 Enumeration: SessionRuleFailureCode
Table 5.6.3.17-1: Enumeration SessionRuleFailureCode
* * *
Enumeration value Description Applicability NF_MAL Indicates that the session
rule could not be successfully installed) or enforced (for those already
successfully installed) due to SMF/UPF malfunction.  
RES_LIM Indicates that the session rule could not be successfully installed or
enforced (for those already successfully installed) due to a limitation of
resources at the SMF/UPF.  
UNSUCC_QOS_VAL Indicates that the QoS validation has failed.  
UE_STA_SUSP Indicates that the UE is in suspend state. Only applicable to the
interworking scenario as defined in Annex B. PolicyUpdateWhenUESuspends
* * *
#### 5.6.3.18 Enumeration: NetLocAccessSupport
Table 5.6.3.18-1: Enumeration NetLocAccessSupport
+-------------------------+-------------------------+---------------+ | Enumeration value | Description | Applicability | +-------------------------+-------------------------+---------------+ | ANR_NOT_SUPPORTED | Indicates that the | | | | access network does not | | | | support the report of | | | | access network | | | | information. | | +-------------------------+-------------------------+---------------+ | TZR_NOT_SUPPORTED | Indicates that the | | | | access network does not | | | | support the report of | | | | UE time zone.\ | | | | (NOTE 1) | | +-------------------------+-------------------------+---------------+ | LOC_NOT_SUPPORTED | Indicates that the | | | | access network does not | | | | support the report of | | | | UE Location. | | | | | | | | (NOTE 2) | | +-------------------------+-------------------------+---------------+ | NOTE 1: The UE time | | | | zone is not available | | | | in EPC untrusted WLAN. | | | | | | | | NOTE 2: The SMF+PGW | | | | determines the UE | | | | Location is not | | | | available as described | | | | in subclause B.3.6.3. | | | +-------------------------+-------------------------+---------------+
## 5.7 Error handling
### 5.7.1 General
HTTP error handling shall be supported as specified in subclause 5.2.4 of 3GPP
TS 29.500 [4].
For the Npcf_SMPolicyControl API, HTTP error responses shall be supported as
specified in subclause 4.8 of 3GPP TS 29.501 [5]. Protocol errors and
application errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [4] shall be
supported for an HTTP method if the corresponding HTTP status codes are
specified as mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS
29.500 [4]. In addition, the requirements in the following subclauses shall
apply.
### 5.7.2 Protocol Errors
In this Release of the specification, there are no additional protocol errors
applicable for the Npcf_SMPolicyControl API.
### 5.7.3 Application Errors
The application errors defined for the Npcf_SMPolicyControl API are listed in
table 5.7.3-1 and 5.7.3-2. The PCF shall include in the HTTP status code a
\"ProblemDetails\" data structure with the \"cause\" attribute indicating the
application error as listed in table 5.7.3-1 when PCF acts as a server. The
SMF shall include in the HTTP status code a \"ProblemDetails\" data structure
with the \"cause\" attribute indicating the application error as listed in
table 5.7.3-2 when SMF acts as a server.
Table 5.7.3-1: Application errors when PCF acts as a server
+------------------------+------------------+------------------------+ | Application Error | HTTP status code | Description | +------------------------+------------------+------------------------+ | USER_UNKNOWN | 400 Bad Request | The HTTP request is | | | | rejected because the | | | | end user specified in | | | | the request is unknown | | | | to the PCF. (NOTE 1) | +------------------------+------------------+------------------------+ | ERRO | 400 Bad Request | The HTTP request is | | R_INITIAL_PARAMETERS | | rejected because the | | | | set of session or | | | | subscriber information | | | | needed by the PCF for | | | | rule selection is | | | | incomplete or | | | | erroneous or not | | | | available for the | | | | decision to be made. | | | | (E.g. QoS, , RAT type, | | | | subscriber | | | | information) (NOTE 1) | | | | (NOTE 2) | +------------------------+------------------+------------------------+ | ERROR_TRIGGER_EVENT | 400 Bad Request | The HTTP request is | | | | rejected because the | | | | set of session | | | | information sent the | | | | message originated due | | | | to a trigger been met | | | | is incoherent with the | | | | previous set of | | | | session information | | | | for the same session. | | | | (E.g. trigger met was | | | | RAT changed, and the | | | | RAT notified is the | | | | same as before) | | | | (NOTE 2) | +------------------------+------------------+------------------------+ | ERROR_TRAFFIC_M | 403 Forbidden | The HTTP request is | | APPING_INFO_REJECTED | | rejected because the | | | | PCF does not accept | | | | one or more of the | | | | traffic mapping | | | | filters provided by | | | | the SMF in a PCC | | | | Request. (NOTE 2) | +------------------------+------------------+------------------------+ | ERROR | 403 Forbidden | The HTTP request is | | _CONFLICTING_REQUEST | | rejected because the | | | | PCF cannot accept the | | | | UE-initiated resource | | | | request as a | | | | network-initiated | | | | resource allocation is | | | | already in progress | | | | that has packet | | | | filters that cover the | | | | packet filters in the | | | | received UE-initiated | | | | resource request. The | | | | SMF shall reject the | | | | attempt for | | | | UE-initiated resource | | | | request. (NOTE 2) | +------------------------+------------------+------------------------+ | P | 403 Forbidden | The HTTP request is | | OLICY_CONTEXT_DENIED | | rejected because the | | | | PCF does not accept | | | | the SMF request due to | | | | operator policies | | | | and/or local | | | | configuration. | | | | (NOTE 1) | +------------------------+------------------+------------------------+ | NOTE 1: These | | | | application errors are | | | | used by the create | | | | service operation (see | | | | subclause 4.2.2.2) and | | | | included in the | | | | responses to the POST | | | | request. | | | | | | | | NOTE 2: These | | | | application errors are | | | | used by the update | | | | service operation (see | | | | subclause 4.2.4.2) and | | | | included in the | | | | responses to the POST | | | | request. | | | +------------------------+------------------+------------------------+
Table 5.7.3-2: Application errors when SMF acts as a server
* * *
Application Error HTTP status code Description PCC_RULE_EVENT 400 Bad Request
The HTTP request is rejected because all the PCC rules provisioned by the PCF
in the request cannot be installed/activated. It is used to inform the PCF
that the request failed, and should not be attempted again. (NOTE)
PCC_QOS_FLOW_EVENT 400 Bad Request The HTTP request is rejected because for
some reason all the PCC rules provisioned by the PCF in the request cannot be
enforced or modified successfully in a network initiated procedure. It is used
to inform the PCF that the request could not be satisfied at the time it was
received, but may be able to satisfy the request in the future. (NOTE)
UE_STATUS_SUSPEND 400 Bad Request The HTTP request is rejected because the
UE's status is suspended and the policy decisions received from the PCF cannot
be enforced by the SMF. Applicable only to functionality introduced with the
PolicyUpdateWhenUESuspends feature as described in subclause 5.8. (NOTE)
RULE_PERMANENT_ERROR 400 Bad Request The HTTP request is rejected because all
the PCC rules and/or session rules provisioned by the PCF in the request
cannot be installed/activated. It is used to inform the PCF that the request
failed, and should not be attempted again. Applicable only to functionality
introduced with the SessionRuleErrorHandling feature as described in subclause
5.8. (NOTE) RULE_TEMPORARY_ERROR 400 Bad Request The HTTP request is rejected
because for some reason all the PCC rules and/or session rules provisioned by
the PCF in the request cannot be enforced or modified successfully in a
network initiated procedure. It is used to inform the PCF that the request
could not be satisfied at the time it was received, but may be able to satisfy
the request in the future. Applicable only to functionality introduced with
the SessionRuleErrorHandling feature as described in subclause 5.8. (NOTE)
NOTE: These application errors are used by the UpdateNotify service operation
(see subclause 4.2.3.2) and included in the responses to the POST request.
* * *
## 5.8 Feature negotiation
The optional features in table 5.8-1 are defined for the Npcf_SMPolicyControl
API. They shall be negotiated using the extensibility mechanism defined in
subclause 6.6 of 3GPP TS 29.500 [4].
Table 5.8-1: Supported Features
+----------------------+----------------------+----------------------+ | Feature number | Feature Name | Description | +----------------------+----------------------+----------------------+ | 1 | TSC | This feature | | | | indicates support | | | | for traffic steering | | | | control in the | | | | (S)Gi-LAN or routing | | | | of the user traffic | | | | to a local Data | | | | Network identified | | | | by the DNAI per AF | | | | request. If the SMF | | | | supports this | | | | feature, the PCF | | | | shall behave as | | | | described in | | | | subclause 4.2.6.2.6. | +----------------------+----------------------+----------------------+ | 2 | ResShare | This feature | | | | indicates the | | | | support of service | | | | data flows that | | | | share resources. If | | | | the SMF supports | | | | this feature, the | | | | PCF shall behave as | | | | described in | | | | subclause 4.2.6.2.8. | +----------------------+----------------------+----------------------+ | 3 | 3GPP-PS-Data-Off | This feature | | | | indicates the | | | | support of 3GPP PS | | | | Data off status | | | | change reporting. | +----------------------+----------------------+----------------------+ | 4 | ADC | This feature | | | | indicates the | | | | support of | | | | application | | | | detection and | | | | control. | +----------------------+----------------------+----------------------+ | 5 | UMC | Indicates that the | | | | usage monitoring | | | | control is | | | | supported. | +----------------------+----------------------+----------------------+ | 6 | NetLoc | This feature | | | | indicates the | | | | support of the | | | | Access Network | | | | Information | | | | Reporting for 5GS. | +----------------------+----------------------+----------------------+ | 7 | RAN-NAS-Cause | This feature | | | | indicates the | | | | support for the | | | | detailed release | | | | cause code | | | | information from the | | | | access network. | | | | | | | | (NOTE) | +----------------------+----------------------+----------------------+ | 8 | ProvAFsignalFlow | This feature | | | | indicates support | | | | for the feature of | | | | IMS Restoration as | | | | described in | | | | subclause 4.2.3.17. | | | | If SMF supports this | | | | feature the PCF may | | | | provision AF | | | | signalling IP flow | | | | information. | +----------------------+----------------------+----------------------+ | 9 | PCSCF-Res | This feature | | | toration-Enhancement | indicates support of | | | | P-CSCF Restoration | | | | Enhancement. It is | | | | used for the SMF to | | | | indicate if it | | | | supports P-CSCF | | | | Restoration | | | | Enhancement. | +----------------------+----------------------+----------------------+ | 10 | PRA | This feature | | | | indicates the | | | | support of presence | | | | reporting area | | | | change reporting. | +----------------------+----------------------+----------------------+ | 11 | RuleVersioning | This feature | | | | indicates the | | | | support of PCC rule | | | | versioning as | | | | defined in | | | | subclause 4.2.6.7. | +----------------------+----------------------+----------------------+ | 12 | S | This feature | | | ponsoredConnectivity | indicates support | | | | for sponsored data | | | | connectivity | | | | feature. If the SMF | | | | supports this | | | | feature, the PCF may | | | | authorize sponsored | | | | data connectivity to | | | | the subscriber. | +----------------------+----------------------+----------------------+ | 13 | RAN-Support-Info | This feature | | | | indicates the | | | | support of maximum | | | | packet loss rate | | | | value(s) for uplink | | | | and/or downlink | | | | voice service data | | | | flow(s). | +----------------------+----------------------+----------------------+ | 14 | Policy | This feature | | | UpdateWhenUESuspends | indicates the | | | | support of report | | | | when the UE is | | | | suspended and then | | | | resumed from suspend | | | | state. Only | | | | applicable to the | | | | interworking | | | | scenario as defined | | | | in Annex B. | +----------------------+----------------------+----------------------+ | 17 | Sess | This feature | | | ionRuleErrorHandling | indicates the | | | | support of session | | | | rule error handling. | +----------------------+----------------------+----------------------+ | 18 | AF_ | Indicates the | | | Charging_Identifier | support of long | | | | character strings as | | | | charging | | | | identifiers. | +----------------------+----------------------+----------------------+ | NOTE: 5GS and EPS | | | | release cause code | | | | information is | | | | supported. The EPS | | | | release cause code | | | | information from the | | | | access network is | | | | only applicable to | | | | EPS interworking | | | | scenarios as | | | | specified in | | | | Annex B. | | | +----------------------+----------------------+----------------------+
## 5.9 Security
As indicated in 3GPP TS 33.501 [27], the access to the Npcf_SMPolicyControl
API shall be authorized by means of the OAuth2 protocol (see IETF RFC 6749
[28]), using the \"Client Credentials\" authorization grant, where the NRF
(see 3GPP TS 29.510 [29]) plays the role of the authorization server.
An NF Service Consumer, prior to consuming services offered by the
Npcf_SMPolicyControl API, shall obtain a \"token\" from the authorization
server, by invoking the Access Token Request service, as described in 3GPP TS
29.510 [29], subclause 5.4.2.2.
NOTE: When multiple NRFs are deployed in a network, the NRF used as
authorization server is the same NRF that the NF Service Consumer used for
discovering the Npcf_SMPolicyControl service.
The Npcf_SMPolicyControl API defines a single scope \"npcf-smpolicycontrol\"
for OAuth2 authorization (as specified in 3GPP TS 33.501 [27]) for the entire
API, and it does not define any additional scopes at resource or operation
level.
###### ## Annex A (normative): OpenAPI specification
# A.1 General
The present Annex contains an OpenAPI [10] specification of HTTP messages and
content bodies used by the Npcf_SMPolicyControl API.
This Annex shall take precedence when being discrepant to other parts of the
specification with respect to the encoding of information elements and methods
within the API.
NOTE 1: The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
Informative copies of the OpenAPI specification file contained in this 3GPP
Technical Specification are available on the public 3GPP file server in the
following locations (see clause 5B of the 3GPP TR 21.900 [38] for further
information):
\- https://www.3gpp.org/ftp/Specs/archive/OpenAPI/\/, and
\- https://www.3gpp.org/ftp/Specs/\/\/OpenAPI/.
NOTE 2: To fetch the OpenAPI specification file after CT#83 plenary meeting
for Release 15 in the above links \ must be replaced with the date
the CT Plenary occurs, in the form of year-month (yyyy-mm), e.g. for CT#83
meeting \ must be replaced with value \"2019-03\" and \ must
be replaced with value \"Rel-15\".
# A.2 Npcf_SMPolicyControl API
openapi: 3.0.0
info:
title: Npcf_SMPolicyControl API
version: 1.0.7
description: \|
Session Management Policy Control Service
Â© 2021, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
externalDocs:
description: 3GPP TS 29.512 V15.10.0; 5G System; Session Management Policy
Control Service.
url: \'http://www.3gpp.org/ftp/Specs/archive/29_series/29.512/\'
security:
\- {}
\- oAuth2Clientcredentials:
\- npcf-smpolicycontrol
servers:
\- url: \'{apiRoot}/npcf-smpolicycontrol/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in subclause 4.4 of 3GPP TS 29.501
paths:
/sm-policies:
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/SmPolicyContextData\'
responses:
\'201\':
description: Created
content:
application/json:
schema:
\$ref: \'#/components/schemas/SmPolicyDecision\'
headers:
Location:
description: \'Contains the URI of the newly created resource\'
required: true
schema:
type: string
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
description: Not Found
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
callbacks:
SmPolicyUpdateNotification:
\'{\$request.body#/notificationUri}/update\':
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/SmPolicyNotification\'
responses:
\'200\':
description: OK. The current applicable values corresponding to the policy
control request trigger is reported
content:
application/json:
schema:
oneOf:
\- \$ref: \'#/components/schemas/UeCampingRep\'
\- type: array
items:
\$ref: \'#/components/schemas/PartialSuccessReport\'
minItems: 1
\'204\':
description: No Content, Notification was succesfull
\'400\':
description: Bad Request.
content:
application/json:
schema:
\$ref: \'#/components/schemas/ErrorReport\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
SmPolicyControlTerminationRequestNotification:
\'{\$request.body#/notificationUri}/terminate\':
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/TerminationNotification\'
responses:
\'204\':
description: No Content, Notification was succesful
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/sm-policies/{smPolicyId}:
get:
parameters:
\- name: smPolicyId
in: path
description: Identifier of a policy association
required: true
schema:
type: string
responses:
\'200\':
description: OK. Resource representation is returned
content:
application/json:
schema:
\$ref: \'#/components/schemas/SmPolicyControl\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'406\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/406\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/sm-policies/{smPolicyId}/update:
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/SmPolicyUpdateContextData\'
parameters:
\- name: smPolicyId
in: path
description: Identifier of a policy association
required: true
schema:
type: string
responses:
\'200\':
description: OK. Updated policies are returned
content:
application/json:
schema:
\$ref: \'#/components/schemas/SmPolicyDecision\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/sm-policies/{smPolicyId}/delete:
post:
requestBody:
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/SmPolicyDeleteData\'
parameters:
\- name: smPolicyId
in: path
description: Identifier of a policy association
required: true
schema:
type: string
responses:
\'204\':
description: No content
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
components:
securitySchemes:
oAuth2Clientcredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
npcf-smpolicycontrol: Access to the Npcf_SMPolicyControl API
schemas:
SmPolicyControl:
type: object
properties:
context:
\$ref: \'#/components/schemas/SmPolicyContextData\'
policy:
\$ref: \'#/components/schemas/SmPolicyDecision\'
required:
\- context
\- policy
SmPolicyContextData:
type: object
properties:
accNetChId:
\$ref: \'#/components/schemas/AccNetChId\'
chargEntityAddr:
\$ref: \'#/components/schemas/AccNetChargingAddress\'
gpsi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Gpsi\'
supi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Supi\'
invalidSupi:
type: boolean
description: When this attribute is included and set to true, it indicates
that the supi attribute contains an invalid value.This attribute shall be
present if the SUPI is not available in the SMF or the SUPI is
unauthenticated. When present it shall be set to true for an invalid SUPI and
false (default) for a valid SUPI.
interGrpIds:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/GroupId\'
minItems: 1
pduSessionId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PduSessionId\'
pduSessionType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PduSessionType\'
chargingcharacteristics:
type: string
dnn:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Dnn\'
notificationUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
accessType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/AccessType\'
ratType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RatType\'
servingNetwork:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NetworkId\'
userLocationInfo:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/UserLocation\'
ueTimeZone:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/TimeZone\'
pei:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Pei\'
ipv4Address:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
ipv6AddressPrefix:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix\'
ipDomain:
type: string
description: Indicates the IPv4 address domain
subsSessAmbr:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ambr\'
subsDefQos:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SubscribedDefaultQos\'
numOfPackFilter:
type: integer
description: Contains the number of supported packet filter for signalled QoS
rules.
online:
type: boolean
description: If it is included and set to true, the online charging is applied
to the PDU session.
offline:
type: boolean
description: If it is included and set to true, the offline charging is
applied to the PDU session.
3gppPsDataOffStatus:
type: boolean
description: If it is included and set to true, the 3GPP PS Data Off is
activated by the UE.
refQosIndication:
type: boolean
description: If it is included and set to true, the reflective QoS is
supported by the UE.
traceReq:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/TraceData\'
sliceInfo:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Snssai\'
qosFlowUsage:
\$ref: \'#/components/schemas/QosFlowUsage\'
servNfId:
\$ref: \'#/components/schemas/ServingNfIdentity\'
suppFeat:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
smfId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NfInstanceId\'
recoveryTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTime\'
required:
\- supi
\- pduSessionId
\- pduSessionType
\- dnn
\- notificationUri
\- sliceInfo
SmPolicyDecision:
type: object
properties:
sessRules:
type: object
additionalProperties:
\$ref: \'#/components/schemas/SessionRule\'
minProperties: 1
description: A map of Sessionrules with the content being the SessionRule as
described in subclause 5.6.2.7.
pccRules:
type: object
additionalProperties:
\$ref: \'#/components/schemas/PccRule\'
minProperties: 1
description: A map of PCC rules with the content being the PCCRule as
described in subclause 5.6.2.6.
nullable: true
pcscfRestIndication:
type: boolean
description: If it is included and set to true, it indicates the P-CSCF
Restoration is requested.
qosDecs:
type: object
additionalProperties:
\$ref: \'#/components/schemas/QosData\'
minProperties: 1
description: Map of QoS data policy decisions.
chgDecs:
type: object
additionalProperties:
\$ref: \'#/components/schemas/ChargingData\'
minProperties: 1
description: Map of Charging data policy decisions.
nullable: true
chargingInfo:
\$ref: \'#/components/schemas/ChargingInformation\'
traffContDecs:
type: object
additionalProperties:
\$ref: \'#/components/schemas/TrafficControlData\'
minProperties: 1
description: Map of Traffic Control data policy decisions.
umDecs:
type: object
additionalProperties:
\$ref: \'#/components/schemas/UsageMonitoringData\'
minProperties: 1
description: Map of Usage Monitoring data policy decisions.
nullable: true
qosChars:
type: object
additionalProperties:
\$ref: \'#/components/schemas/QosCharacteristics\'
minProperties: 1
description: Map of QoS characteristics for non standard 5QIs. This map uses
the 5QI values as keys.
reflectiveQoSTimer:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\'
conds:
type: object
additionalProperties:
\$ref: \'#/components/schemas/ConditionData\'
minProperties: 1
description: A map of condition data with the content being as described in
subclause 5.6.2.9.
nullable: true
revalidationTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTime\'
offline:
type: boolean
description: Indicates the offline charging is applicable to the PDU session
when it is included and set to true.
online:
type: boolean
description: Indicates the online charging is applicable to the PDU session or
PCC rule when it is included and set to true.
policyCtrlReqTriggers:
type: array
items:
\$ref: \'#/components/schemas/PolicyControlRequestTrigger\'
minItems: 1
description: Defines the policy control request triggers subscribed by the
PCF.
nullable: true
lastReqRuleData:
type: array
items:
\$ref: \'#/components/schemas/RequestedRuleData\'
minItems: 1
description: Defines the last list of rule control data requested by the PCF.
lastReqUsageData:
\$ref: \'#/components/schemas/RequestedUsageData\'
praInfos:
type: object
additionalProperties:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PresenceInfoRm\'
minProperties: 1
description: Map of PRA information.
nullable: true
ipv4Index:
\$ref: \'TS29519_Policy_Data.yaml#/components/schemas/IpIndex\'
ipv6Index:
\$ref: \'TS29519_Policy_Data.yaml#/components/schemas/IpIndex\'
qosFlowUsage:
\$ref: \'#/components/schemas/QosFlowUsage\'
suppFeat:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
SmPolicyNotification:
type: object
properties:
resourceUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
smPolicyDecision:
\$ref: \'#/components/schemas/SmPolicyDecision\'
PccRule:
type: object
properties:
flowInfos:
type: array
items:
\$ref: \'#/components/schemas/FlowInformation\'
minItems: 1
description: An array of IP flow packet filter information.
appId:
type: string
description: A reference to the application detection filter configured at the
UPF.
contVer:
\$ref:
\'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/ContentVersion\'
pccRuleId:
type: string
description: Univocally identifies the PCC rule within a PDU session.
precedence:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uinteger\'
afSigProtocol:
\$ref: \'#/components/schemas/AfSigProtocol\'
appReloc:
type: boolean
description: Indication of application relocation possibility.
refQosData:
type: array
items:
type: string
minItems: 1
maxItems: 1
description: A reference to the QosData policy decision type. It is the qosId
described in subclause 5.6.2.8.
refTcData:
type: array
items:
type: string
minItems: 1
maxItems: 1
description: A reference to the TrafficControlData policy decision type. It is
the tcId described in subclause 5.6.2.10.
refChgData:
type: array
items:
type: string
minItems: 1
maxItems: 1
description: A reference to the ChargingData policy decision type. It is the
chgId described in subclause 5.6.2.11.
nullable: true
refUmData:
type: array
items:
type: string
minItems: 1
maxItems: 1
description: A reference to UsageMonitoringData policy decision type. It is
the umId described in subclause 5.6.2.12.
nullable: true
refCondData:
type: string
description: A reference to the condition data. It is the condId described in
subclause 5.6.2.9.
nullable: true
required:
\- pccRuleId
nullable: true
SessionRule:
type: object
properties:
authSessAmbr:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ambr\'
authDefQos:
\$ref: \'#/components/schemas/AuthorizedDefaultQos\'
sessRuleId:
type: string
description: Univocally identifies the session rule within a PDU session.
refUmData:
type: string
description: A reference to UsageMonitoringData policy decision type. It is
the umId described in subclause 5.6.2.12.
nullable: true
refCondData:
type: string
description: A reference to the condition data. It is the condId described in
subclause 5.6.2.9.
nullable: true
required:
\- sessRuleId
nullable: true
QosData:
type: object
properties:
qosId:
type: string
description: Univocally identifies the QoS control policy data within a PDU
session.
5qi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5Qi\'
maxbrUl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
maxbrDl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
gbrUl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
gbrDl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
arp:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Arp\'
qnc:
type: boolean
description: Indicates whether notifications are requested from 3GPP NG-RAN
when the GFBR can no longer (or again) be guaranteed for a QoS Flow during the
lifetime of the QoS Flow.
priorityLevel:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5QiPriorityLevelRm\'
averWindow:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/AverWindowRm\'
maxDataBurstVol:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/MaxDataBurstVolRm\'
reflectiveQos:
type: boolean
description: Indicates whether the QoS information is reflective for the
corresponding service data flow.
sharingKeyDl:
type: string
description: Indicates, by containing the same value, what PCC rules may share
resource in downlink direction.
sharingKeyUl:
type: string
description: Indicates, by containing the same value, what PCC rules may share
resource in uplink direction.
maxPacketLossRateDl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PacketLossRateRm\'
maxPacketLossRateUl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PacketLossRateRm\'
defQosFlowIndication:
type: boolean
description: Indicates that the dynamic PCC rule shall always have its binding
with the QoS Flow associated with the default QoS rule
required:
\- qosId
nullable: true
ConditionData:
type: object
properties:
condId:
type: string
description: Uniquely identifies the condition data within a PDU session.
activationTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTimeRm\'
deactivationTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTimeRm\'
required:
\- condId
nullable: true
TrafficControlData:
type: object
properties:
tcId:
type: string
description: Univocally identifies the traffic control policy data within a
PDU session.
flowStatus:
\$ref:
\'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/FlowStatus\'
redirectInfo:
\$ref: \'#/components/schemas/RedirectInformation\'
muteNotif:
type: boolean
description: Indicates whether applicat\'on\'s start or stop notification is
to be muted.
trafficSteeringPolIdDl:
type: string
description: Reference to a pre-configured traffic steering policy for
downlink traffic at the SMF.
nullable: true
trafficSteeringPolIdUl:
type: string
description: Reference to a pre-configured traffic steering policy for uplink
traffic at the SMF.
nullable: true
routeToLocs:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RouteToLocation\'
minItems: 1
description: A list of location which the traffic shall be routed to for the
AF request
upPathChgEvent:
\$ref: \'#/components/schemas/UpPathChgEvent\'
required:
\- tcId
nullable: true
ChargingData:
type: object
properties:
chgId:
type: string
description: Univocally identifies the charging control policy data within a
PDU session.
meteringMethod:
\$ref: \'#/components/schemas/MeteringMethod\'
offline:
type: boolean
description: Indicates the offline charging is applicable to the PCC rule when
it is included and set to true.
online:
type: boolean
description: Indicates the online charging is applicable to the PCC rule when
it is included and set to true.
sdfHandl:
type: boolean
description: Indicates whether the service data flow is allowed to start while
the SMF is waiting for the response to the credit request.
ratingGroup:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RatingGroup\'
reportingLevel:
\$ref: \'#/components/schemas/ReportingLevel\'
serviceId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ServiceId\'
sponsorId:
type: string
description: Indicates the sponsor identity.
appSvcProvId:
type: string
description: Indicates the application service provider identity.
afChargingIdentifier:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ChargingId\'
afChargId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ApplicationChargingId\'
required:
\- chgId
nullable: true
UsageMonitoringData:
type: object
properties:
umId:
type: string
description: Univocally identifies the usage monitoring policy data within a
PDU session.
volumeThreshold:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/VolumeRm\'
volumeThresholdUplink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/VolumeRm\'
volumeThresholdDownlink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/VolumeRm\'
timeThreshold:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSecRm\'
monitoringTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTimeRm\'
nextVolThreshold:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/VolumeRm\'
nextVolThresholdUplink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/VolumeRm\'
nextVolThresholdDownlink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/VolumeRm\'
nextTimeThreshold:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSecRm\'
inactivityTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSecRm\'
exUsagePccRuleIds:
type: array
items:
type: string
minItems: 1
description: Contains the PCC rule identifier(s) which corresponding service
data flow(s) shall be excluded from PDU Session usage monitoring. It is only
included in the UsageMonitoringData instance for session level usage
monitoring.
nullable: true
required:
\- umId
nullable: true
RedirectInformation:
type: object
properties:
redirectEnabled:
type: boolean
description: Indicates the redirect is enable.
redirectAddressType:
\$ref: \'#/components/schemas/RedirectAddressType\'
redirectServerAddress:
type: string
description: Indicates the address of the redirect server. If
\"redirectAddressType\" attribute indicates the IPV4_ADDR, the encoding is the
same as the Ipv4Addr data type defined in 3GPP TS 29.571.If
\"redirectAddressType\" attribute indicates the IPV6_ADDR, the encoding is the
same as the Ipv6Addr data type defined in 3GPP TS 29.571.If
\"redirectAddressType\" attribute indicates the URL or SIP_URI, the encoding
is the same as the Uri data type defined in 3GPP TS 29.571.
FlowInformation:
type: object
properties:
flowDescription:
\$ref: \'#/components/schemas/FlowDescription\'
ethFlowDescription:
\$ref:
\'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/EthFlowDescription\'
packFiltId:
type: string
description: An identifier of packet filter.
packetFilterUsage:
type: boolean
description: The packet shall be sent to the UE.
tosTrafficClass:
type: string
description: Contains the Ipv4 Type-of-Service and mask field or the Ipv6
Traffic-Class field and mask field.
nullable: true
spi:
type: string
description: the security parameter index of the IPSec packet.
nullable: true
flowLabel:
type: string
description: the Ipv6 flow label header field.
nullable: true
flowDirection:
\$ref: \'#/components/schemas/FlowDirectionRm\'
SmPolicyDeleteData:
type: object
properties:
userLocationInfo:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/UserLocation\'
ueTimeZone:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/TimeZone\'
servingNetwork:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NetworkId\'
userLocationInfoTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTime\'
ranNasRelCauses:
type: array
items:
\$ref: \'#/components/schemas/RanNasRelCause\'
minItems: 1
description: Contains the RAN and/or NAS release cause.
accuUsageReports:
type: array
items:
\$ref: \'#/components/schemas/AccuUsageReport\'
minItems: 1
description: Contains the usage report
QosCharacteristics:
type: object
properties:
5qi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5Qi\'
resourceType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/QosResourceType\'
priorityLevel:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5QiPriorityLevel\'
packetDelayBudget:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PacketDelBudget\'
packetErrorRate:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PacketErrRate\'
averagingWindow:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/AverWindow\'
maxDataBurstVol:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/MaxDataBurstVol\'
required:
\- 5qi
\- resourceType
\- priorityLevel
\- packetDelayBudget
\- packetErrorRate
ChargingInformation:
type: object
properties:
primaryChfAddress:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
secondaryChfAddress:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
required:
\- primaryChfAddress
\- secondaryChfAddress
AccuUsageReport:
type: object
properties:
refUmIds:
type: string
description: An id referencing UsageMonitoringData objects associated with
this usage report.
volUsage:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/Volume\'
volUsageUplink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/Volume\'
volUsageDownlink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/Volume\'
timeUsage:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\'
nextVolUsage:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/Volume\'
nextVolUsageUplink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/Volume\'
nextVolUsageDownlink:
\$ref: \'TS29122_CommonData.yaml#/components/schemas/Volume\'
nextTimeUsage:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\'
required:
\- refUmIds
SmPolicyUpdateContextData:
type: object
properties:
repPolicyCtrlReqTriggers:
type: array
items:
\$ref: \'#/components/schemas/PolicyControlRequestTrigger\'
minItems: 1
description: The policy control reqeust trigges which are met.
accNetChIds:
type: array
items:
\$ref: \'#/components/schemas/AccNetChId\'
minItems: 1
description: Indicates the access network charging identifier for the PCC
rule(s) or whole PDU session.
accessType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/AccessType\'
ratType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RatType\'
servingNetwork:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NetworkId\'
userLocationInfo:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/UserLocation\'
ueTimeZone:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/TimeZone\'
relIpv4Address:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
ipv4Address:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
ipDomain:
type: string
description: Indicates the IPv4 address domain
ipv6AddressPrefix:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix\'
relIpv6AddressPrefix:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix\'
relUeMac:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/MacAddr48\'
ueMac:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/MacAddr48\'
subsSessAmbr:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ambr\'
subsDefQos:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SubscribedDefaultQos\'
numOfPackFilter:
type: integer
description: Contains the number of supported packet filter for signalled QoS
rules.
accuUsageReports:
type: array
items:
\$ref: \'#/components/schemas/AccuUsageReport\'
minItems: 1
description: Contains the usage report
3gppPsDataOffStatus:
type: boolean
description: If it is included and set to true, the 3GPP PS Data Off is
activated by the UE.
appDetectionInfos:
type: array
items:
\$ref: \'#/components/schemas/AppDetectionInfo\'
minItems: 1
description: Report the start/stop of the application traffic and detected SDF
descriptions if applicable.
ruleReports:
type: array
items:
\$ref: \'#/components/schemas/RuleReport\'
minItems: 1
description: Used to report the PCC rule failure.
sessRuleReports:
type: array
items:
\$ref: \'#/components/schemas/SessionRuleReport\'
minItems: 1
description: Used to report the session rule failure.
qncReports:
type: array
items:
\$ref: \'#/components/schemas/QosNotificationControlInfo\'
minItems: 1
description: QoS Notification Control information.
userLocationInfoTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTime\'
repPraInfos:
type: object
additionalProperties:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/PresenceInfo\'
minProperties: 1
description: Reports the changes of presence reporting area.
ueInitResReq:
\$ref: \'#/components/schemas/UeInitiatedResourceRequest\'
refQosIndication:
type: boolean
description: If it is included and set to true, the reflective QoS is
supported by the UE. If it is included and set to false, the reflective QoS is
revoked by the UE.
qosFlowUsage:
\$ref: \'#/components/schemas/QosFlowUsage\'
creditManageStatus:
\$ref: \'#/components/schemas/CreditManagementStatus\'
servNfId:
\$ref: \'#/components/schemas/ServingNfIdentity\'
traceReq:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/TraceData\'
UpPathChgEvent:
type: object
properties:
notificationUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
notifCorreId:
type: string
description: It is used to set the value of Notification Correlation ID in the
notification sent by the SMF.
dnaiChgType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DnaiChangeType\'
required:
\- notificationUri
\- notifCorreId
\- dnaiChgType
nullable: true
TerminationNotification:
type: object
properties:
resourceUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
cause:
\$ref:
\'TS29507_Npcf_AMPolicyControl.yaml#/components/schemas/PolicyAssociationReleaseCause\'
required:
\- resourceUri
\- cause
AppDetectionInfo:
type: object
properties:
appId:
type: string
description: A reference to the application detection filter configured at the
UPF
instanceId:
type: string
description: Identifier sent by the SMF in order to allow correlation of
application Start and Stop events to the specific service data flow
description, if service data flow descriptions are deducible.
sdfDescriptions:
type: array
items:
\$ref: \'#/components/schemas/FlowInformation\'
minItems: 1
description: Contains the detected service data flow descriptions if they are
deducible.
required:
\- appId
AccNetChId:
type: object
properties:
accNetChaIdValue:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ChargingId\'
refPccRuleIds:
type: array
items:
type: string
minItems: 1
description: Contains the identifier of the PCC rule(s) associated to the
provided Access Network Charging Identifier.
sessionChScope:
type: boolean
description: When it is included and set to true, indicates the Access Network
Charging Identifier applies to the whole PDU Session
required:
\- accNetChaIdValue
AccNetChargingAddress:
description: Describes the network entity within the access network performing
charging
type: object
anyOf:
\- required: [anChargIpv4Addr]
\- required: [anChargIpv6Addr]
properties:
anChargIpv4Addr:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
anChargIpv6Addr:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr\'
RequestedRuleData:
type: object
properties:
refPccRuleIds:
type: array
items:
type: string
minItems: 1
description: An array of PCC rule id references to the PCC rules associated
with the control data.
reqData:
type: array
items:
\$ref: \'#/components/schemas/RequestedRuleDataType\'
minItems: 1
description: Array of requested rule data type elements indicating what type
of rule data is requested for the corresponding referenced PCC rules.
required:
\- refPccRuleIds
\- reqData
RequestedUsageData:
type: object
properties:
refUmIds:
type: array
items:
type: string
minItems: 1
description: An array of usage monitoring data id references to the usage
monitoring data instances for which the PCF is requesting a usage report. This
attribute shall only be provided when allUmIds is not set to true.
allUmIds:
type: boolean
description: This boolean indicates whether requested usage data applies to
all usage monitoring data instances. When it\'s not included, it means
requested usage data shall only apply to the usage monitoring data instances
referenced by the refUmIds attribute.
UeCampingRep:
type: object
properties:
accessType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/AccessType\'
ratType:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RatType\'
servNfId:
\$ref: \'#/components/schemas/ServingNfIdentity\'
servingNetwork:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NetworkId\'
userLocationInfo:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/UserLocation\'
ueTimeZone:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/TimeZone\'
netLocAccSupp:
\$ref: \'#/components/schemas/NetLocAccessSupport\'
RuleReport:
type: object
properties:
pccRuleIds:
type: array
items:
type: string
minItems: 1
description: Contains the identifier of the affected PCC rule(s).
ruleStatus:
\$ref: \'#/components/schemas/RuleStatus\'
contVers:
type: array
items:
\$ref:
\'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/ContentVersion\'
minItems: 1
description: Indicates the version of a PCC rule.
failureCode:
\$ref: \'#/components/schemas/FailureCode\'
finUnitAct:
\$ref:
\'TS32291_Nchf_ConvergedCharging.yaml#/components/schemas/FinalUnitAction\'
ranNasRelCauses:
type: array
items:
\$ref: \'#/components/schemas/RanNasRelCause\'
minItems: 1
description: indicates the RAN or NAS release cause code information.
required:
\- pccRuleIds
\- ruleStatus
RanNasRelCause:
type: object
properties:
ngApCause:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NgApCause\'
5gMmCause:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5GMmCause\'
5gSmCause:
\$ref: \'#/components/schemas/5GSmCause\'
epsCause:
\$ref: \'#/components/schemas/EpsRanNasRelCause\'
UeInitiatedResourceRequest:
type: object
properties:
pccRuleId:
type: string
ruleOp:
\$ref: \'#/components/schemas/RuleOperation\'
precedence:
type: integer
packFiltInfo:
type: array
items:
\$ref: \'#/components/schemas/PacketFilterInfo\'
minItems: 1
reqQos:
\$ref: \'#/components/schemas/RequestedQos\'
required:
\- ruleOp
\- packFiltInfo
PacketFilterInfo:
type: object
properties:
packFiltId:
type: string
description: An identifier of packet filter.
packFiltCont:
\$ref: \'#/components/schemas/PacketFilterContent\'
tosTrafficClass:
type: string
description: Contains the Ipv4 Type-of-Service and mask field or the Ipv6
Traffic-Class field and mask field.
spi:
type: string
description: The security parameter index of the IPSec packet.
flowLabel:
type: string
description: The Ipv6 flow label header field.
flowDirection:
\$ref: \'#/components/schemas/FlowDirection\'
RequestedQos:
type: object
properties:
5qi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5Qi\'
gbrUl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\'
gbrDl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\'
required:
\- 5qi
QosNotificationControlInfo:
type: object
properties:
refPccRuleIds:
type: array
items:
type: string
minItems: 1
description: An array of PCC rule id references to the PCC rules associated
with the QoS notification control info.
notifType:
\$ref:
\'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/QosNotifType\'
contVer:
\$ref:
\'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/ContentVersion\'
required:
\- refPccRuleIds
\- notifType
PartialSuccessReport:
type: object
properties:
failureCause:
\$ref: \'#/components/schemas/FailureCause\'
ruleReports:
type: array
items:
\$ref: \'#/components/schemas/RuleReport\'
minItems: 1
description: Information about the PCC rules provisioned by the PCF not
successfully installed/activated.
sessRuleReports:
type: array
items:
\$ref: \'#/components/schemas/SessionRuleReport\'
minItems: 1
description: Information about the session rules provisioned by the PCF not
successfully installed.
ueCampingRep:
\$ref: \'#/components/schemas/UeCampingRep\'
required:
\- failureCause
AuthorizedDefaultQos:
type: object
properties:
5qi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5Qi\'
arp:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Arp\'
priorityLevel:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/5QiPriorityLevelRm\'
averWindow:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/AverWindowRm\'
maxDataBurstVol:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/MaxDataBurstVolRm\'
maxbrUl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
maxbrDl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
gbrUl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
gbrDl:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRateRm\'
ErrorReport:
type: object
properties:
error:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ProblemDetails\'
ruleReports:
type: array
items:
\$ref: \'#/components/schemas/RuleReport\'
minItems: 1
description: Used to report the PCC rule failure.
sessRuleReports:
type: array
items:
\$ref: \'#/components/schemas/SessionRuleReport\'
minItems: 1
description: Used to report the session rule failure.
SessionRuleReport:
type: object
properties:
ruleIds:
type: array
items:
type: string
minItems: 1
description: Contains the identifier of the affected session rule(s).
ruleStatus:
\$ref: \'#/components/schemas/RuleStatus\'
sessRuleFailureCode:
\$ref: \'#/components/schemas/SessionRuleFailureCode\'
required:
\- ruleIds
\- ruleStatus
ServingNfIdentity:
type: object
properties:
servNfInstId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NfInstanceId\'
guami:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Guami\'
anGwAddr:
\$ref:
\'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/AnGwAddress\'
5GSmCause:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uinteger\'
EpsRanNasRelCause:
type: string
description: Defines the EPS RAN/NAS release cause.
PacketFilterContent:
type: string
description: Defines a packet filter for an IP flow.
FlowDescription:
type: string
description: Defines a packet filter for an IP flow.
FlowDirection:
anyOf:
\- type: string
enum:
\- DOWNLINK
\- UPLINK
\- BIDIRECTIONAL
\- UNSPECIFIED
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- DOWNLINK: The corresponding filter applies for traffic to the UE.
\- UPLINK: The corresponding filter applies for traffic from the UE.
\- BIDIRECTIONAL: The corresponding filter applies for traffic both to and
from the UE.
\- UNSPECIFIED: The corresponding filter applies for traffic to the UE
(downlink), but has no specific direction declared. The service data flow
detection shall apply the filter for uplink traffic as if the filter was
bidirectional. The PCF shall not use the value UNSPECIFIED in filters created
by the network in NW-initiated procedures. The PCF shall only include the
value UNSPECIFIED in filters in UE-initiated procedures if the same value is
received from the SMF.
FlowDirectionRm:
anyOf:
\- type: string
enum:
\- DOWNLINK
\- UPLINK
\- BIDIRECTIONAL
\- UNSPECIFIED
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- DOWNLINK: The corresponding filter applies for traffic to the UE.
\- UPLINK: The corresponding filter applies for traffic from the UE.
\- BIDIRECTIONAL: The corresponding filter applies for traffic both to and
from the UE.
\- UNSPECIFIED: The corresponding filter applies for traffic to the UE
(downlink), but has no specific direction declared. The service data flow
detection shall apply the filter for uplink traffic as if the filter was
bidirectional. The PCF shall not use the value UNSPECIFIED in filters created
by the network in NW-initiated procedures. The PCF shall only include the
value UNSPECIFIED in filters in UE-initiated procedures if the same value is
received from the SMF.
nullable: true
ReportingLevel:
anyOf:
\- type: string
enum:
\- SER_ID_LEVEL
\- RAT_GR_LEVEL
\- SPON_CON_LEVEL
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- SER_ID_LEVEL: Indicates that the usage shall be reported on service id and
rating group combination level.
\- RAT_GR_LEVEL: Indicates that the usage shall be reported on rating group
level.
\- SPON_CON_LEVEL: Indicates that the usage shall be reported on sponsor
identity and rating group combination level.
nullable: true
MeteringMethod:
anyOf:
\- type: string
enum:
\- DURATION
\- VOLUME
\- DURATION_VOLUME
\- EVENT
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- DURATION: Indicates that the duration of the service data flow traffic
shall be metered.
\- VOLUME: Indicates that volume of the service data flow traffic shall be
metered.
\- DURATION_VOLUME: Indicates that the duration and the volume of the service
data flow traffic shall be metered.
\- EVENT: Indicates that events of the service data flow traffic shall be
metered.
nullable: true
PolicyControlRequestTrigger:
anyOf:
\- type: string
enum:
\- PLMN_CH
\- RES_MO_RE
\- AC_TY_CH
\- UE_IP_CH
\- UE_MAC_CH
\- AN_CH_COR
\- US_RE
\- APP_STA
\- APP_STO
\- AN_INFO
\- CM_SES_FAIL
\- PS_DA_OFF
\- DEF_QOS_CH
\- SE_AMBR_CH
\- QOS_NOTIF
\- NO_CREDIT
\- PRA_CH
\- SAREA_CH
\- SCNN_CH
\- RE_TIMEOUT
\- RES_RELEASE
\- SUCC_RES_ALLO
\- RAT_TY_CH
\- REF_QOS_IND_CH
\- NUM_OF_PACKET_FILTER
\- UE_STATUS_RESUME
\- UE_TZ_CH
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- PLMN_CH: PLMN Change
\- RES_MO_RE: A request for resource modification has been received by the
SMF. The SMF always reports to the PCF.
\- AC_TY_CH: Access Type Change
\- UE_IP_CH: UE IP address change. The SMF always reports to the PCF.
\- UE_MAC_CH: A new UE MAC address is detected or a used UE MAC address is
inactive for a specific period
\- AN_CH_COR: Access Network Charging Correlation Information
\- US_RE: The PDU Session or the Monitoring key specific resources consumed by
a UE either reached the threshold or needs to be reported for other reasons.
\- APP_STA: The start of application traffic has been detected.
\- APP_STO: The stop of application traffic has been detected.
\- AN_INFO: Access Network Information report
\- CM_SES_FAIL: Credit management session failure
\- PS_DA_OFF: The SMF reports when the 3GPP PS Data Off status changes. The
SMF always reports to the PCF.
\- DEF_QOS_CH: Default QoS Change. The SMF always reports to the PCF.
\- SE_AMBR_CH: Session AMBR Change. The SMF always reports to the PCF.
\- QOS_NOTIF: The SMF notify the PCF when receiving notification from RAN that
QoS targets of the QoS Flow cannot be guranteed or gurateed again.
\- NO_CREDIT: Out of credit
\- PRA_CH: Change of UE presence in Presence Reporting Area
\- SAREA_CH: Location Change with respect to the Serving Area
\- SCNN_CH: Location Change with respect to the Serving CN node
\- RE_TIMEOUT: Indicates the SMF generated the request because there has been
a PCC revalidation timeout
\- RES_RELEASE: Indicate that the SMF can inform the PCF of the outcome of the
release of resources for those rules that require so.
\- SUCC_RES_ALLO: Indicates that the requested rule data is the successful
resource allocation.
\- RAT_TY_CH: RAT Type Change.
\- REF_QOS_IND_CH: Reflective QoS indication Change
\- NUM_OF_PACKET_FILTER: Indicates that the SMF shall report the number of
supported packet filter for signalled QoS rules
\- UE_STATUS_RESUME: Indicates that the UE's status is resumed.
\- UE_TZ_CH: UE Time Zone Change
RequestedRuleDataType:
anyOf:
\- type: string
enum:
\- CH_ID
\- MS_TIME_ZONE
\- USER_LOC_INFO
\- RES_RELEASE
\- SUCC_RES_ALLO
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- CH_ID: Indicates that the requested rule data is the charging identifier.
\- MS_TIME_ZONE: Indicates that the requested access network info type is the
UE\'s timezone.
\- USER_LOC_INFO: Indicates that the requested access network info type is the
UE\'s location.
\- RES_RELEASE: Indicates that the requested rule data is the result of the
release of resource.
\- SUCC_RES_ALLO: Indicates that the requested rule data is the successful
resource allocation.
RuleStatus:
anyOf:
\- type: string
enum:
\- ACTIVE
\- INACTIVE
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- ACTIVE: Indicates that the PCC rule(s) are successfully installed (for
those provisioned from PCF) or activated (for those pre-defined in SMF), or
the session rule(s) are successfully installed
\- INACTIVE: Indicates that the PCC rule(s) are removed (for those provisioned
from PCF) or inactive (for those pre-defined in SMF) or the session rule(s)
are removed.
FailureCode:
anyOf:
\- type: string
enum:
\- UNK_RULE_ID
\- RA_GR_ERR
\- SER_ID_ERR
\- NF_MAL
\- RES_LIM
\- MAX_NR_QoS_FLOW
\- MISS_FLOW_INFO
\- RES_ALLO_FAIL
\- UNSUCC_QOS_VAL
\- INCOR_FLOW_INFO
\- PS_TO_CS_HAN
\- APP_ID_ERR
\- NO_QOS_FLOW_BOUND
\- FILTER_RES
\- MISS_REDI_SER_ADDR
\- CM_END_USER_SER_DENIED
\- CM_CREDIT_CON_NOT_APP
\- CM_AUTH_REJ
\- CM_USER_UNK
\- CM_RAT_FAILED
\- UE_STA_SUSP
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- UNK_RULE_ID: Indicates that the pre-provisioned PCC rule could not be
successfully activated because the PCC rule identifier is unknown to the SMF.
\- RA_GR_ERR: Indicate that the PCC rule could not be successfully installed
or enforced because the Rating Group specified within the Charging Data policy
decision which the PCC rule refers to is unknown or, invalid.
\- SER_ID_ERR: Indicate that the PCC rule could not be successfully installed
or enforced because the Service Identifier specified within the Charging Data
policy decision which the PCC rule refers to is invalid, unknown, or not
applicable to the service being charged.
\- NF_MAL: Indicate that the PCC rule could not be successfully installed (for
those provisioned from the PCF) or activated (for those pre-defined in SMF) or
enforced (for those already successfully installed) due to SMF/UPF
malfunction.
\- RES_LIM: Indicate that the PCC rule could not be successfully installed
(for those provisioned from PCF) or activated (for those pre-defined in SMF)
or enforced (for those already successfully installed) due to a limitation of
resources at the SMF/UPF.
\- MAX_NR_QoS_FLOW: Indicate that the PCC rule could not be successfully
installed (for those provisioned from PCF) or activated (for those pre-defined
in SMF) or enforced (for those already successfully installed) due to the fact
that the maximum number of QoS flows has been reached for the PDU session.
\- MISS_FLOW_INFO: Indicate that the PCC rule could not be successfully
installed or enforced because neither the \"flowInfos\" attribute nor the
\"appId\" attribute is specified within the PccRule data structure by the PCF
during the first install request of the PCC rule.
\- RES_ALLO_FAIL: Indicate that the PCC rule could not be successfully
installed or maintained since the QoS flow establishment/modification failed,
or the QoS flow was released.
\- UNSUCC_QOS_VAL: indicate that the QoS validation has failed or when
Guaranteed Bandwidth > Max-Requested-Bandwidth.
\- INCOR_FLOW_INFO: Indicate that the PCC rule could not be successfully
installed or modified at the SMF because the provided flow information is not
supported by the network (e.g. the provided IP address(es) or Ipv6 prefix(es)
do not correspond to an IP version applicable for the PDU session).
\- PS_TO_CS_HAN: Indicate that the PCC rule could not be maintained because of
PS to CS handover.
\- APP_ID_ERR: Indicate that the rule could not be successfully installed or
enforced because the Application Identifier is invalid, unknown, or not
applicable to the application required for detection.
\- NO_QOS_FLOW_BOUND: Indicate that there is no QoS flow which the SMF can
bind the PCC rule(s) to.
\- FILTER_RES: Indicate that the Flow Information within the \"flowInfos\"
attribute cannot be handled by the SMF because any of the restrictions defined
in subclause 5.4.2 of 3GPP TS 29.212 was not met.
\- MISS_REDI_SER_ADDR: Indicate that the PCC rule could not be successfully
installed or enforced at the SMF because there is no valid Redirect Server
Address within the Traffic Control Data policy decision which the PCC rule
refers to provided by the PCF and no preconfigured redirection address for
this PCC rule at the SMF.
\- CM_END_USER_SER_DENIED: Indicate that the charging system denied the
service request due to service restrictions (e.g. terminate rating group) or
limitations related to the end-user, for example the end-user\'s account could
not cover the requested service.
\- CM_CREDIT_CON_NOT_APP: Indicate that the charging system determined that
the service can be granted to the end user but no further credit control is
needed for the service (e.g. service is free of charge or is treated for
offline charging).
\- CM_AUTH_REJ: Indicate that the charging system denied the service request
in order to terminate the service for which credit is requested.
\- CM_USER_UNK: Indicate that the specified end user could not be found in the
charging system.
\- CM_RAT_FAILED: Indicate that the charging system cannot rate the service
request due to insufficient rating input, incorrect AVP combination or due to
an attribute or an attribute value that is not recognized or supported in the
rating.
\- UE_STA_SUSP: Indicates that the UE is in suspend state.
AfSigProtocol:
anyOf:
\- type: string
enum:
\- NO_INFORMATION
\- SIP
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- NO_INFORMATION: Indicate that no information about the AF signalling
protocol is being provided.
\- SIP: Indicate that the signalling protocol is Session Initiation Protocol.
nullable: true
RuleOperation:
anyOf:
\- type: string
enum:
\- CREATE_PCC_RULE
\- DELETE_PCC_RULE
\- MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS
\- MODIFY_ PCC_RULE_AND_REPLACE_PACKET_FILTERS
\- MODIFY_ PCC_RULE_AND_DELETE_PACKET_FILTERS
\- MODIFY_PCC_RULE_WITHOUT_MODIFY_PACKET_FILTERS
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- CREATE_PCC_RULE: Indicates to create a new PCC rule to reserve the resource
requested by the UE.
\- DELETE_PCC_RULE: Indicates to delete a PCC rule corresponding to reserve
the resource requested by the UE..
\- MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS: Indicates to modify the PCC rule by
adding new packet filter(s).
\- MODIFY_ PCC_RULE_AND_REPLACE_PACKET_FILTERS: Indicates to modify the PCC
rule by replacing the existing packet filter(s).
\- MODIFY_ PCC_RULE_AND_DELETE_PACKET_FILTERS: Indicates to modify the PCC
rule by deleting the existing packet filter(s).
\- MODIFY_PCC_RULE_WITHOUT_MODIFY_PACKET_FILTERS: Indicates to modify the PCC
rule by modifying the QoS of the PCC rule.
RedirectAddressType:
anyOf:
\- type: string
enum:
\- IPV4_ADDR
\- IPV6_ADDR
\- URL
\- SIP_URI
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- IPV4_ADDR: Indicates that the address type is in the form of \"dotted-
decimal\" IPv4 address.
\- IPV6_ADDR: Indicates that the address type is in the form of IPv6 address.
\- URL: Indicates that the address type is in the form of Uniform Resource
Locator.
\- SIP_URI: Indicates that the address type is in the form of SIP Uniform
Resource Identifier.
QosFlowUsage:
anyOf:
\- type: string
enum:
\- GENERAL
\- IMS_SIG
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- GENERAL: Indicate no specific QoS flow usage information is available.
\- IMS_SIG: Indicate that the QoS flow is used for IMS signalling only.
FailureCause:
anyOf:
\- type: string
enum:
\- PCC_RULE_EVENT
\- PCC_QOS_FLOW_EVENT
\- RULE_PERMANENT_ERROR
\- RULE_TEMPORARY_ERROR
\- type: string
CreditManagementStatus:
anyOf:
\- type: string
enum:
\- END_USER_SER_DENIED
\- CREDIT_CTRL_NOT_APP
\- AUTH_REJECTED
\- USER_UNKNOWN
\- RATING_FAILED
\- type: string
SessionRuleFailureCode:
anyOf:
\- type: string
enum:
\- NF_MAL
\- RES_LIM
\- UNSUCC_QOS_VAL
\- UE_STA_SUSP
\- type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- NF_MAL: Indicate that the PCC rule could not be successfully installed (for
those provisioned from the PCF) or activated (for those pre-defined in SMF) or
enforced (for those already successfully installed) due to SMF/UPF
malfunction.
\- RES_LIM: Indicate that the PCC rule could not be successfully installed
(for those provisioned from PCF) or activated (for those pre-defined in SMF)
or enforced (for those already successfully installed) due to a limitation of
resources at the SMF/UPF.
\- UNSUCC_QOS_VAL: indicate that the QoS validation has failed.
\- UE_STA_SUSP: Indicates that the UE is in suspend state.
NetLocAccessSupport:
anyOf:
\- type: string
enum:
\- ANR_NOT_SUPPORTED
\- TZR_NOT_SUPPORTED
  * LOC_NOT_SUPPORTED
  * type: string
description: >
This string provides forward-compatibility with future
extensions to the enumeration but is not used to encode
content defined in the present version of this API.
description: >
Possible values are
\- ANR_NOT_SUPPORTED: Indicates that the access network does not support the
report of access network information.
\- TZR_NOT_SUPPORTED: Indicates that the access network does not support the
report of UE time zone.
\- LOC_NOT_SUPPORTED: Indicates that the access network does not support the
report of UE Location (or PLMN Id).
###### ## Annex B (normative): 5GC and EPC interworking scenario support
# B.1 Scope
This annex defines procedures for 5GC and EPC/E-UTRAN interworking, which
contains the following scenarios:
\- EPS and 5GS interworking (i.e. 3GPP access connected to EPC and 3GPP access
connected to 5GC).
\- EPC/ePDG and 5GS interworking (i.e. ePDG connected to EPC and 3GPP access
connected to 5GC).
\- EPS and 5GC/N3IWF interworking (i.e. 3GPP access connected to EPC and N3IWF
connected to 5GC).
# B.2 Npcf_SMPolicyControl Service
## B.2.1 Service Description
### B.2.1.1 Overview
Session Management Policy Control Service applies to the cases where the
SMF+PGW-C interacts with the PCF in the non-roaming scenario, the
V-SMF+V-PGW-C interacts with the V-PCF in the local breakout roaming scenario
and the H-SMF+H-PGW-C interacts with the H-PCF in the home-routed scenario.
### B.2.1.2 Service Architecture
The Session Management Policy Control Service is provided by the PCF as shown
in the SBI representation model in figure B.2.1.2-1 and in the reference point
representation model in figure B.2.1.2.2.
In this scenario the NF Service Consumer is a combined SMF and PGW-C.
Figure B.2.1.2-1: Reference Architecture for the Npcf_SMPolicyControl Service
for 5GC and\ EPC interworking scenario; SBI representation
Figure B.2.1.2-2: Reference Architecture for the Npcf_SMPolicyControl Service
or 5GC and\ EPC interworking scenario; reference point representation
NOTE: The SMF+PGW-C represents the V-SMF+V-PGW-C and the PCF represents the
V-PCF in the local breakout scenario. The SMF+PGW-C represents the
H-SMF+H-PGW-C and the PCF represents the H-PCF in the home routed scenario.
# B.3 Service Operation
## B.3.1 Introduction
This subclause defines the specific service operations for the 5GC and EPC
interworking scenario. In addition, the service operations defined in
subclause 4.2 shall be applicable.
NOTE: For brevity reason, the combined SMF and PGW-C is denoted as SMF in what
follows.
## B.3.2 Npcf_SMPolicyControl_Create Service Operation
### B.3.2.0 General
When the UE establishes the PDN connection through the EPC network and the
SMF+PGW-C receives the Create Session Request message as defined in 3GPP TS
29.274 [37], the SMF+PGW-C shall behave as defined in subclause 4.2.2.2 with
the differences that the SMF+PGW-C shall include (if available) in
SmPolicyContextData data structure:
\- the IMSI of the user within the \"supi\" attribute;
\- the MSISDN of the user within the \"gpsi\" attribute;
\- APN within the \"dnn\" attribute;
\- PDN Type within the \"pduSessionType\" attribute;
\- IMEI-SV within the \"pei\" attribute;
\- IP-CAN type within the \"accessType\" attribute;
\- RAT type within the \"ratType\" attribute;
NOTE 1: See Annex B.3.2.2 for further information.
\- subscribed APN-AMBR within \"subsSessAmbr\" attribute;
\- subscribed Default EPS bearer QoS within \"subsDefQos\" attribute;
NOTE 2: Subscribed APN-AMBR and the QCI within the subscribed default EPS
bearer QoS are mapped to subscribed Session-AMBR and 5QI as defined in Annex
B.3.6.1 respectively.
\- user location information within the \"userLocationInfo\" attribute;
NOTE 3: See Annex B.3.2.1 for further information.
\- the S-NSSAI determined by the SMF+PGW-C within the \"sliceInfo\" attribute;
and
\- the bearer usage required of the default bearer within the \"qosFlowUsage\"
attribute.
\- the UE time zone information within \"ueTimeZone\" attribute, if available;
NOTE 4: The UE time zone is not available in EPC untrusted WLAN.
### B.3.2.1 UE Location related information
When the UE establishes the PDU session through the EPC/E-UTRAN network, the
SMF+PGW-C shall include, if available, the following user location
information:
\- user location information within the \"eutraLocation\" attribute included
in the \"userLocationInfo\" attribute; and
\- S-GW address, if available, within the \"anGwAddr\" attribute included in
the \"servNfId\" attribute.
When the UE establishes the PDU session through the EPC/ePDG network, the
SMF+PGW-C shall include, if available, the following user location
information:
\- user location information within the \"n3gaLocation\" attribute included in
the \"userLocationInfo\" attribute; and
\- ePDG identification within the \"anGwAddr\" attribute included in the
\"servNfId\" attribute.
NOTE: The \"n3gaLocation\" attribute does not include the \"n3gppTai\" and
\"n3IwfId\" attributes in EPC interworking scenarios.
### B.3.2.2 Access Type related information
When the UE establishes the PDU session through the EPC/E-UTRAN network, the
SMF+PGW shall include, if available, the following access type information:
\- the \"3GPP_ACCESS\" value within the \"accessType\" attribute; and
\- the \"EUTRA\" value within the \"ratType\" attribute.
When the UE establishes the PDU session through the EPC/ePDG network, the
SMF+PGW shall include, if available, the following access type information:
\- the \"NON_3GPP_ACCESS\" value within the \"accessType\" attribute;
\- the \"WLAN\" or \"VIRTUAL\" value within the \"ratType\" attribute, as
applicable; and
\- the ePDG address in the \"servNfId\" attribute within the \"anGwAddr\"
attribute.
## B.3.3 Npcf_SMPolicyControl_UpdateNotify Service Operation
### B.3.3.0 General
When the UE has an established PDN connection through the EPC/E-UTRAN network
and the PCF provisions the policy to the SMF+PGW-C as defined in subclause
4.2.3. The SMF+ PGW-C shall behave as defined in subclause 4.2.3 with the
differences that the SMF+PGW-C shall map the QoS information within the PCC
rule and/or session rule into EPS QoS information as defined in Annex B.3.6.1.
### B.3.3.1 Policy Update When UE suspends
If the PolicyUpdateWhenUESuspends feature as defined in subclause 5.8 is
supported, and when the SMF receives the policy decision from the PCF as
defined in subclause 4.2.3.1 for a PDN connection maintained when the UE's
status is suspend state, the SMF shall reject the request and include an HTTP
\"400 Bad Request\" status code together with an ErrorReport structure. Within
the ErrorReport data structure, the SMF shall include the \"error\" attribute
containing the \"cause\" attribute of the ProblemDetails data structure set to
\"UE_STATUS_SUSPEND\" which indicates the failure to enforce the corresponding
policy decision, except if the policy decision is for the PCC rule removal
only and/or session rule removal only, and further include the information as
follows:
\- If the policy decision includes the installation of one or more PCC rules,
the SMF shall invoke the procedure as defined in subclause 4.2.3.16 with the
\"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute
set to INACTIVE to indicate the failure to enforce those PCC rules.
\- If the policy decision includes the modification of one or more PCC rules,
the SMF shall invoke the procedure as defined in subclause 4.2.3.16 with the
\"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute
set to ACTIVE to indicate the failure to enforce those PCC rules.
\- If the policy decision includes the modification of one or more session
rules, the SMF shall within an RuleReport data structure include the
\"sessRuleReports\" attribute. Within each SessionRuleReport data structure,
the SMF shall include the affected session rules within the \"ruleIds\"
attribute(s), the \"sessRuleFailureCode\" attribute set to \"UE_STA_SUSP\" and
\"ruleStatus\" attribute set to ACTIVE to indicate the failure to enforce
those session rules.
Upon reception of the \"failureCode\" attribute and/or \"sessRuleFailureCode\"
attribute set to \"UE_STA_SUSP\" or the ProblemDetails data structure set to
\"UE_STATUS_SUSPEND\", the PCF shall not initiate any PDU Session Modification
procedure, except if it is initiated for the PCC rule removal only or the
session rule removal only, for the given PDU session over N7 until the UE's
status is resumed. When the SMF detected the UE's status is resumed from
suspend state, the SMF shall inform the PCF of the UE status as defined in
Annex B.3.4.2.
## B.3.4 Npcf_SMPolicyControl_Update Service Operation
### B.3.4.0 General
When the established PDN connection through the EPC network is modified and
SMF+PGW-C receives Modify Bearer Request, Modify Bearer or Delete Bearer
Command message and if the SMF detects the policy control request trigger(s)
is met or the error(s) needs to be reported or when the UE handed over from
the 5GS to the EPS and the SMF detects the policy control request trigger(s)
is met, the SMF+PGW-C shall behave as defined in subclause 4.2.4.2 with the
differences that the SMF+PGW-C shall include (if available) in the
SmPolicyUpdateContextData data structure:
\- IP-CAN type within the \"accessType\" attribute;
\- RAT type within the \"ratType\" attribute;
NOTE 1: See Annex B.3.4.5 for further information.
\- subscribed APN-AMBR within the \"subsSessAmbr\" attribute;
\- subscribed Default EPS bearer QoS Information within the \"subsDefQos\"
attribute;
NOTE 2: Subscribed APN-AMBR and the QCI within the subscribed default EPS
bearer QoS are mapped to subscribed Session-AMBR and 5QI as defined in Annex
B.3.6.1 respectively.
\- the bearer usage required for the dedicated bearer within the
\"qosFlowUsage\" attribute if the UE initiates a resource modification request
procedure and the bearer usage request was present in the Bearer Resource
Command; and
\- user location information of EPC within the \"userLocationInfo\" attribute.
NOTE 3: See Annex B.3.4.3 for further information.
### B.3.4.1 Number of Supported Packet Filters Report
When the UE handed over from the EPC/E-UTRAN to the 5GS and the number of
supported packet filters for signalled QoS rules is received from the UE, the
SMF shall include the \"NUM_OF_PACKET_FILTER\" within the
\"repPolicyCtrlReqTriggers\" attribute and the number of supported packet
filters for signalled QoS rules within the \"numOfPackFilter\". In this case,
the PCF shall behave as defined in subclause 4.2.6.2.16.
### B.3.4.2 Policy Update When UE suspends
#### B.3.4.2.1 Policy Update Error Report
If the PolicyUpdateWhenUESuspends feature as defined in subclause 5.8 is
supported, and when the SMF receives the policy decision from the PCF as
defined in subclause 4.2.4.1 for a PDN connection maintained when the UE's
status is suspend state, the SMF shall include the \"ruleReports\" attribute
for the affected PCC rules and/or session rules to report the failure within
the SmPolicyUpdateContextData data structure. Within the ErrorReport data
structure, the SMF shall include the \"error\" attribute containing the
\"cause\" attribute of the ProblemDetails data structure set to
\"UE_STATUS_SUSPEND\" which indicates the failure to enforce the corresponding
policy decision, except if the policy decision is for the PCC rule removal
only and/or session rule removal only, and further include the information as
follows:
\- if the policy decision includes the modification of one or more session
rules, within an RuleReport instance, the SMF shall include the
\"sessRuleReports\" attribute. Within each SessionRuleReport data structure,
the SMF shall include the affected session rules within the \"ruleIds\"
attribute(s), the \"sessRuleFailureCode\" attribute set to \"UE_STA_SUSP\" and
the \"ruleStatus\" attribute set to ACTIVE to indicate the failure to enforce
those session rules.
\- if the policy decision includes the installation of one or more PCC rules,
the SMF shall invoke the procedure as defined in subclause 4.2.4.15 with the
\"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute
set to INACTIVE to indicate the failure to enforce those PCC rules.
\- if the policy decision includes the modification of one or more PCC rules,
the SMF shall invoke the procedure as defined in subclause 4.2.4.15 with the
\"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute
set to ACTIVE to indicate the failure to enforce those PCC rules.
Upon reception of the \"failureCode\" attribute and/or \"sessRuleFailureCode\"
attribute set to \"UE_STA_SUSP\", the PCF shall not initiate any PDU Session
Modification procedure, except if it is initiated for the PCC rule removal
only and/or session rule removal only, for the given PDU session over N7 until
the UE's status is resumed.
#### B.3.4.2.2 UE State Change Report
If the SMF detected the UE's status is resumed from suspend state, the SMF
shall inform the PCF of the UE status including the \"UE_STATUS_RESUME\"
within \"repPolicyCtrlReqTriggers\" attribute. The PCF shall after this update
the SMF with PCC Rules or session rules if necessary.
### B.3.4.3 UE Location related information
When the UE handed over from the 5GS to EPC/E-UTRAN the SMF+PGW-C shall
include, together with the policy control request triggers met, the following
user location information:
\- If the \"SAREA_CH\" policy control request trigger is provisioned and met,
the user location information within the \"eutraLocation\" attribute included
in the \"userLocationInfo\" attribute.
\- If the \"SCNN_CH\" policy control request trigger is provisioned and met,
the \"servNfId\" attribute including the S-GW identification within the
\"anGwAddr\" attribute.
\- If the \"AN_INFO\" policy control request trigger is met, the user location
was requested by the PCF and provided to the SMF+PGW-C, the SMF shall provide
the user location information within the \"eutraLocation\" attribute included
in the \"userLocationInfo\" attribute and the time when it was last known in
the 3GPP access within \"userLocationInfoTime\" attribute (if available).
When the UE handed over from the 5GS to EPC non-3GPP access, the SMF+PGW-C
shall include, together with the applicable provisioned policy control request
triggers, the following user location information:
\- If the \"SAREA_CH\" policy control request trigger is provisioned and met,
the user location information within the \"n3gaLocation\" attribute included
in the \"userLocationInfo\" attribute.
\- If the \"SCNN_CH\" policy control request trigger is provisioned and met,
the ePDG identification within the \"anGwAddr\" attribute included in the
\"servNfId\" attribute.
\- If the \"AN_INFO\" policy control request trigger is met, the user location
was requested by the PCF and provided to the SMF+PGW-C, the SMF shall provide
the user location information within the \"n3gaLocation\" attribute included
in the \"userLocationInfo\" attribute and the time when it was last known in
the non-3GPP access within \"userLocationInfoTime\" attribute (if available).
NOTE: The \"n3gaLocation\" attribute does not include the \"n3gppTai\" and
\"n3IwfId\" attributes in EPC interworking scenarios.
### B.3.4.4 Presence Reporting Area Information Report
When the UE is connected through the EPC/E-UTRAN network, the SMF+PGW-C
receives the presence reporting area information as defined in 3GPP TS 29.274
[37]. When the PRA feature is supported, the SMF+PGW-C provides presence
reporting area to the PCF as specified in subclause 4.2.4.16.
### B.3.4.5 Access Type related information
The SMF+PGW shall include, when the policy control request trigger
\"AC_TY_CH\" is met, the following access type information:
\- If after handover the new access type is EPC/E-UTRAN:
a) the \"3GPP_ACCESS\" value within the \"accessType\" attribute; and
b) the \"EUTRA\" value within the \"ratType\" attribute.
\- If after handover the new access type is EPC/ePDG:
a) the \"NON_3GPP_ACCESS\" value within the \"accessType\" attribute;
b) the \"WLAN\" or \"VIRTUAL\" value within the \"ratType\" attribute, as
applicable; and
c) the ePDG address in the \"servNfId\" attribute within the \"anGwAddr\"
attribute.
NOTE 1: In the interworking scenario, \"AC_TY_CH\" is met when the UE handed
over from the 5GC/N3IWF to EPC/E-UTRAN, or when the UE handed over from the
5GS to EPC/ePDG.
The SMF+PGW shall include, when the policy control request trigger \"RAT_TY_CH
\" is met, the following RAT type information:
\- If after handover the new RAT type is the E-UTRA, the \"EUTRA\" value
within the \"ratType\" attribute.
\- If after handover the new RAT type is the WLAN, the \"WLAN\" or \"VIRTUAL\"
value within the \"ratType\" attribute, as applicable.
NOTE 2: In the interworking scenario, \"RAT_TY_CH\" is met when the UE handed
over from the NR to the E-UTRA or when the UE handed over from the NR to the
WLAN and from E-UTRA to WLAN.
### B.3.4.6 EPS RAN NAS Cause Support
If the RAN-NAS-Cause feature as defined in subclause 5.8 is supported, and the
PDN connection is established through the EPC network, the SMF shall report
the RAN/NAS release cause(s) as specified in subclauses 4.2.4.7, 4.2.4.12 and
4.2.4.15, with the exception that the received EPS RAN/NAS cause(s) are
encoded within the \"epsCause\" attribute included in the RanNasRelCause data
type. In this Release of the specification, the EPS release cause code
information may include RAN/NAS release cause(s) or an untrusted WLAN release
cause.
## B.3.5 Npcf_SMPolicyControl_Delete Service Operation
### B.3.5.1 General
When the UE deletes the PDN connection through the EPC network and the
SMF+PGW-C shall behave as defined in subclause 4.2.5.2 with the difference
that the SMF+PGW-C shall include the information elements contained in the
Delete Session Request message within the SmPolicyDeleteData data structure.
NOTE: See Annex B.3.2.1 for location information.
### B.3.5.2 EPS RAN NAS Cause Support
If the RAN-NAS-Cause feature as defined in subclause 5.8 is supported, and the
PDN connection is established through the EPC network, the SMF shall report
the RAN/NAS release cause(s) as specified in subclause 4.2.5.4.7, with the
exception that the received EPS RAN/NAS cause(s) are encoded within the
\"epsCause\" attribute included in the RanNasRelCause data type. In this
Release of the specification, the EPS release cause code information may
include RAN/NAS release cause(s) or an untrusted WLAN release cause.
## B.3.6 Provisioning and Enforcement of Policy Decisions
### B.3.6.1 QoS mapping performed by the SMF+PGW-C
When the UE is served by the 5GC, during PDU Session establishment and GBR QoS
flow establishment, SMF+ PGW-C performs EPS QoS mappings, from the 5G QoS
parameters obtained from the PCF, and allocates TFT with the PCC rules
obtained from the PCF. If a TFT is to be allocated for a downlink
unidirectional EPS bearer mapped from a downlink only QoS Flow, the SMF+ PGW-C
shall allocate a TFT packet filter that effectively disallows any useful
uplink packet as described in subclause 15.3.3.4 of 3GPP TS 23.060 [26]. The
SMF+PGW-C sends the mapped QoS parameters and TFT to the UE via PCO.
When the UE is served by the EPC, during PDN Connection establishment and
dedicated bearer establishment/modification, SMF+ PGW-C performs EPS QoS
mappings, from the 5G QoS parameters obtained from the PCF, and allocates TFT
with the PCC rules obtained from the PCF. Other 5G QoS parameters
corresponding to the PDN connection, e.g. Session AMBR, and QoS rules and QoS
Flow level QoS parameters if needed for the QoS Flow(s) associated with the
QoS rule(s), are sent to UE in PCO.
The SMF+PGW-C shall perform EPS QoS mappings as defined in subclause 4.11.1.1
and Annex C in 3GPP TS 23.502 [3] as follows:
\- ignore the QNC and reflective QoS indication if received;
\- for standardized 5QIs, the authorized 5QI is one to one mapped to the QCI;
NOTE: The delay critical 5QI mapping to QCI is unspecified in the present
specification.
\- for non-standardized 5QI,derive the authorized QCI based on the authorized
5QI and operator policy;
\- one to one map the subscribed default QCI to the subscribed default 5QI;
\- set the subscribed Session-AMBR according to operator policy (e.g. taking
the value of subscribed APN-AMBR into account); and
\- set the authorized APN-AMBR according to operator policy (e.g. taking the
value of authorized Session-AMBR into account).
### B.3.6.2 Provisioning of Presence Reporting Area Information
When the PRA feature is supported, the PCF provides the SMF with Presence
Reporting Area(s) information as specified in subclause 4.2.6.5.6. When the UE
is connected through the EPC/E-UTRAN network, the SMF+PGW-C initiates the
appropriate PDU session specific procedures specified in 3GPP TS 29.274 [37]
to obtain or to deactivate the report of the presence state of a UE in a
presence reporting area.
NOTE: Homogeneous support of Presence Area reporting in EPC and 5GC networks
is assumed.
### B.3.6.3 Request and Report of Access Network information
If the NetLoc feature as defined in subclause 5.8 is supported, the PCF may
request the SMF+PGW-C to report the access network information as defined in
subclause 4.2.6.5.4.
If the AN_INFO policy control request trigger is set, upon receiving the
\"lastReqRuleData\" attribute with the \"reqData\" attribute with the value(s)
MS_TIME_ZONE and/or USER_LOC_INFO and the \"refPccRuleIds\" attribute
containing the PCC rule identifier(s) corresponding to the PCC rule(s) being
installed, modified or removed:
\- If the \"reqData\" attribute indicates MS_TIME_ZONE and USER_LOC_INFO and
the SMF+PGW-C determines that the access network does not support the access
network information reporting, the SMF+PGW-C shall immediately inform the PCF
by including the \"netLocAccSupp\" attribute set to \"ANR_NOT_SUPPORTED" value
in the \"UeCampingRep\" data structure returned in the \"200 OK\" response to
the policy update notification request.
\- If the \"reqData\" attribute only includes the MS_TIME_ZONE value and the
SMF+PGW-C determines that the access network does not support the report of
the UE time zone, the SMF+PGW-C shall immediately inform the PCF by including
the \"netLocAccSupp\" attribute set to \"TZR_NOT_SUPPORTED" value in the
\"UeCampingRep\" data structure returned in the \"200 OK\" response to the
policy update notification request.
\- If the \"reqData\" attribute only includes the USER_LOC_INFO value and the
SMF+PGW-C determines that the access network does not support the report of
the UE location, the SMF+PGW-C shall immediately inform the PCF by including
the \"netLocAccSupp\" attribute set to \"LOC_NOT_SUPPORTED" value in the
\"UeCampingRep\" data structure returned in the \"200 OK\" response to the
policy update notification request.
\- If the \"reqData\" attribute includes the USER_LOC_INFO value and/or the
MS_TIME_ZONE value, and the SMF+PGW-C determines the access network supports
the report of UE time zone, the SMF+PGW-C shall apply appropriate procedures
to the EPC access network to obtain the requested access network information
and shall behave as specified in subclause 4.2.4.9.
NOTE: The SMF+PGW determines whether the access network supports access
network information reporting based on access type, RAT type and
trusted/untrusted type of the access network.
#