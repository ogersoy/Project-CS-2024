# Foreword
This Technical Specification has been produced by the 3GPP.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of this TS, it will be re-released by the TSG with an identifying
change of release date and an increase in version number as follows:
Version 3.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 Indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the specification;
# 1 Scope
The scope of this Technical Specification is to provide a detailed
specification for interworking between the A interface protocol and the Mobile
Application Part for handling of supplementary services. The MAP interfaces of
interest are the B-, C-, D- and E-interfaces.
The A-, C-, D- and E-interfaces are physical interfaces while the B-interface
is an internal interface defined for modelling purposes. Information relating
to the modelling interface is not normative in this specification.
Supplementary service signalling may be passed by the MSC/VLR between the A-
and E-interfaces after inter-MSC handover. This procedure is transparent as
far as supplementary services are concerned therefore interworking concerning
this process is not described in this specification.
Clause 2 describes general procedures for interworking between the A- and D-
physical interfaces.
Clause 3 describes the general procedures for the SS version negotiation.
Clause 4 describes the mapping of layer 3 radio path messages with Transaction
Capabilities (TC) transaction sublayer messages for interworking between the
A- and D- physical interfaces.
Clause 5 describes specific interworking procedures for all interfaces
relating to call related SS activity.
Clause 6 describes specific interworking procedures for all interfaces
relating to call independent SS activity. Clause 6 also covers the
interworking between the MAP User (see 3GPP TS 29.002) and the SS handling
functions of the network entities (see 3GPP TS 24.010 and 3GPP TS 24.080).
Reference is made to the following Technical Specifications:
\- 3GPP TS 22.004 and 3GPP TS 22.08x and 3GPP TS 22.09x-series,\ for
definition of supplementary services;
\- 3GPP TS 23.011, 3GPP TS 23.08x and 3GPP TS 23.09x-series,\ for technical
realisation of supplementary services;
\- 3GPP TS 24.010, 3GPP TS 24.080, 3GPP TS 24.08x and 3GPP TS 24.09x-series,\
for radio path signalling procedures for supplementary services;
\- 3GPP TS 29.002 (MAP).
## 1.1 Normative references
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.004: \"General on supplementary services\".
[3] 3GPP TS 22.024: \"Description of Charge Advice Information (CAI)\".
[4] 3GPP TS 22.082: \"Call Forwarding (CF) supplementary services - Stage 1\".
[5] 3GPP TS 22.086: \"Advice of Charge (AoC) supplementary services - Stage
1\".
[6] 3GPP TS 22.093: \"Completion of Calls to Busy Subscriber - Stage 1\".
[7] 3GPP TS 23.011: \"Technical realization of supplementary services\".
[8] 3GPP TS 23.086: \"Advice of Charge (AoC) supplementary services - Stage
2\".
[9] 3GPP TS 23.093: \"Completion of Calls to Busy Subscriber - Stage 2\".
[10] 3GPP TS 24.008: \"Mobile radio interface layer 3 specification\".
[11] 3GPP TS 24.010: \"Mobile radio interface layer 3 Supplementary services
specification General aspects\".
[12] 3GPP TS 24.072: \"Call Deflection supplementary service - Stage 3\".
[13] 3GPP TS 24.080: \"Mobile radio interface layer 3 supplementary services
specification Formats and coding\".
[14] 3GPP TS 24.081: \"Line identification supplementary services - Stage 3\".
[15] 3GPP TS 24.082: \"Call Forwarding (CF) supplementary services - Stage
3\".
[16] 3GPP TS 24.083: \"Call Waiting (CW) and Call Hold (HOLD) supplementary
services - Stage 3\".
[17] 3GPP TS 24.084: \"Multi Party (MPTY) supplementary services - Stage 3\".
[18] 3GPP TS 24.085: \"Closed User Group (CUG) supplementary services \- Stage
3\".
[19] 3GPP TS 24.086: \"Advice of Charge (AoC) supplementary services - Stage
3\".
[20] 3GPP TS 24.088: \"Call Barring (CB) supplementary services - Stage 3\".
[21] 3GPP TS 24.090: \"Unstructured supplementary services operation - Stage
3\".
[22] 3GPP TS 24.091: \"Explicit Call Transfer (ECT) supplementary services -
Stage 3\".
[23] 3GPP TS 24.093: \"Completion of Calls to Busy Subscriber - Stage 3\".
[24] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[25] 3GPP TS 29.010: \"Information element mapping between Mobile Station -
Base Station System and BSS ‑ Mobile-services Switching Centre (MS - BSS -
MSC) Signalling procedures and the Mobile Application Part (MAP)\".
[26] 3GPP TS 23.088: \"Call Barring (CB) Supplementary Service; Stage 2\".
## 1.2 Definitions and abbreviations
Abbreviations used in this specification are listed in 3GPP TR 21.905.
# 2 Introduction
This clause describes general procedure at the MSC/VLR for SS interworking
between the A- and D-interfaces.
## 2.1 MSC/VLR procedures for handling supplementary service signalling
received over the A-interface
Upon receipt of supplementary service signalling on the A-interface, the
MSC/VLR shall:
\- perform any internal SS checks or procedures appropriate to the signal (see
clauses 4 and 5);
\- if necessary request access to the HLR over the D-interface using the
procedures defined in this specification and MAP, 3GPP TS 29.002;
\- use the version indicator received from the MS to set up the right AC
context name towards the HLR (see clause 3). The version indicator is
described in 3GPP TS 24.010 and 3GPP TS 24.080. AC names are defined in 3GPP
TS 29.002;
\- perform mapping between layer 3 messages on the radio path and TC
transaction sublayer messages as required (see clause 3).
## 2.2 MSC/VLR procedures for handling supplementary service signalling
received over the D-interface
Upon receipt of supplementary service signalling on the D-interface, the
MSC/VLR shall:
\- perform any internal SS checks or procedures appropriate to the signal (see
clauses 4 and 5);
\- handle any information elements according to the screening indicator
procedure as described in 3GPP TS 24.010;
\- perform mapping between TC transaction sublayer messages and layer 3
messages on the radio path as required (see clause 3).
# 3 SS version negotiation
This clause describes the general procedures for the call related and call
independent supplementary services version negotiation.
## 3.1 Call related supplementary services interworking
No interworking identified.
## 3.2 Call independent supplementary services interworking
On receipt of the REGISTER message from the MS, the MSC/VLR will include the
appropriate AC name in the dialogue control portion of the BEGIN message based
on the following rules:
\- if no version indicator is present, no AC name is included in the BEGIN
message towards the HLR (no AC name indicates \"version1\");
\- if the version indicator is less or equal to the highest AC name the
MSC/VLR and HLR both support, the \"dialogue\" will be handled according to
the AC name corresponding to the version indicator and to the SS operation
received;
\- if the version indicator is greater than the highest commonly supported AC
name within the network (MSC/VLR, HLR), the \"dialogue\" will be handled
according to this highest AC name if the request from the MS can also be
fulfilled with this version of the \"dialogue\".
The selection of the highest commonly supported AC name by the network is
described in 3GPP TS 29.002.
It should be noted that unknown parameters of the extension field within the
Facility Information Element shall be forwarded to a phase 2 HLR according to
the Extensibility rules as defined in 3GPP TS 29.002. They may be discarded
when sent to a phase 1 HLR.
According to this version of the standards, the highest AC name is
\"version3\".
The description method employed in the clauses 4 to 6 is tabled showing the
mapping of parameter values. The exact values of the parameters and parameter
tags can be found in the referenced specifications.
# 4 Mapping between TC transaction sublayer messages and layer 3 radio path
messages
This clause describes the mapping of TC transaction sublayer messages to layer
3 radio path messages over the external interfaces. The precise coding of
these messages is given in other technical specifications.
## 4.1 D-interface to A-interface mapping
Table 4.1 shows the mapping of TC transaction sublayer messages to layer 3
messages on the radio path.
Table 4.1: Mapping of TC transaction sublayer messages to layer 3 radio path
messages
+----------------------------------+----------------------------------+ | **TC transaction sublayer |** Layer 3 radio path message**| | message** | | +----------------------------------+----------------------------------+ | BEGIN | REGISTER (note 1) | +----------------------------------+----------------------------------+ | CONTINUE (note 2) | FACILITY/REGISTER (note 3) | +----------------------------------+----------------------------------+ | END (note 2) | RELEASE COMPLETE/REGISTER (note | | | 3) | +----------------------------------+----------------------------------+ | ABORT (note 2) | RELEASE COMPLETE | +----------------------------------+----------------------------------+ | NOTE 1: AC name is not mapped to | | | a version indicator. | | | | | | NOTE 2: The user information | | | field if present is discarded. | | | | | | NOTE 3: A CONTINUE or END is | | | mapped to REGISTER if a new | | | transaction has to be | | | established. | | +----------------------------------+----------------------------------+
## 4.2 A-interface to D-interface mapping
Table 4.2 shows the mapping of layer 3 radio path messages to TC transaction
sublayer messages.
Table 4.2: Mapping of layer 3 radio path messages to TC transaction sublayer
messages
* * *
**Layer 3 radio path message** **TC transaction sublayer message** REGISTER
BEGIN (note) FACILITY CONTINUE RELEASE COMPLETE END NOTE: The right AC name
shall be included, see clause 3.
* * *
## 4.3 Procedures
The mapping from TC Transaction Sublayer messages to Layer 3 radio path
messages must include a replacement of the tag and length of the Component
Portion in the Transaction Sublayer message with the Information element
identifier and length of the Facility Information Element for the Layer 3
message. Similarly for the reverse mapping. However, if a version indicator is
received an AC name will be provided in the BEGIN message, see clause 3.
All transaction sublayer messages, except the ABORT message, will normally
contain one or more components. If components are included, the conversion
algorithm described below applies. If a message does not contain a component,
then the corresponding message is also sent without a component: messages
shall not be withheld by the interworking function.
For call independent SS operations each message shall only contain a single
component. If a message contains more than one component then a RELEASE
COMPLETE message with the cause \"Facility rejected\" (see 3GPP TS 24.008) and
without any component shall be sent on the radio path (see 3GPP TS 24.010).
TC Transaction sublayer messages can also contain a dialogue portion. If a
user-information is received within this dialogue portion, it will not be
conveyed in a Layer 3 radio path message.
If an ABORT message is received in TC, a RELEASE COMPLETE message is to be
sent on the radio path. The RELEASE COMPLETE message shall not contain any
component. If a cause is to be provided to the MS, one of the cause codes of
3GPP TS 24.008 shall be used.
If an ABORT message with a dialogue portion indicating \"version fallback\"
(e.g. the cause \"AC-not-supported\") is received in TC then, if the MSC does
not re-attempt the \"dialogue\" (e.g. by using a different AC name), it shall
send a RELEASE COMPLETE to the MS with the cause \"Facility rejected\" (see
3GPP TS 24.008) and without any component.
If an END message with a dialogue portion indicating \"dialogue refused\" is
received in TC then the MSC shall send a RELEASE COMPLETE to the MS with the
cause \"Facility rejected\" (see 3GPP TS 24.008) and without any component.
If a layer 3 radio path message or a component in the layer 3 radio path
message is rejected by the MSC, the MSC shall:
\- return a RELEASE COMPLETE message to the MS. If the reject condition is not
associated with a component, one of the cause codes of 3GPP TS 24.008 shall be
inserted, as described below. If it is a component (except a REJECT
component), a REJECT component with the appropriate problem code shall be
inserted in the RELEASE COMPLETE message, as described below. If the reject
condition concerns a REJECT component the RELEASE COMPLETE message may be
empty;
\- terminate the transaction with the VLR by use of an ABORT message.
If a dialogue cannot be established with the HLR because no common AC name is
available then the MSC shall send a RELEASE COMPLETE to the MS with the cause
\"Facility rejected\".
# 5 Call related supplementary services management
## 5.1 SS management in connection establishment phase
When a CM connection is being set up between an MS and an MSC, setting up of a
connection between the MSC and the VLR to request access proceeds as for
normal call set-up (see 3GPP TS 29.002). Moreover, the MSC will also assess
the capabilities of the MS according to the screening indicator (see 3GPP TS
24.010 and 3GPP TS 24.080). As the call set-up proceeds, the following
supplementary services may apply:
### 5.1.1 Line Identification services
These supplementary services (described in 3GPP TS 24.081) require
interworking in the MSC between both 3GPP TS 24.008, MAP (3GPP TS 29.002) and
the fixed network protocol, see also 3GPP TS 29.010.
#### 5.1.1.1 Calling Line Identification Presentation (CLIP)
The signalling at invocation of the CLIP supplementary service is shown in
figure 5.1.
MS MSC VLR\ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦SEND INFORMATION FOR INCOMING
CALL SETUP¦ ¦\ ¦ ¦ ¦ ¦--------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\ ¦ ¦ ¦ ¦ COMPLETE CALL ¦ ¦\ ¦ ¦ SETUP ¦
¦\¦
¦--------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ COMPLETE
CALL ¦ ¦\ ¦ ¦ ¦ ¦\¦
¦--------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ COMPLETE
CALL ¦ ¦\ ¦ ¦ CONNECT ¦ ¦\¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\ ¦ ¦ ¦ ¦ COMPLETE CALL ¦ ¦\ ¦ ¦ SETUP ¦
¦\¦ ¦SEND INFORMATION
FOR OUTGOING CALL SETUP¦ ¦\ ¦ ¦ ¦ ¦--------------------------------------->¦
¦\ ¦ ¦ ALERTING/ ¦ ¦ ¦ ¦\ ¦ ¦ CONNECT/ ¦ ¦ COMPLETE CALL ¦ ¦\ ¦ ¦ FACILITY ¦
¦\¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\ ¦ ¦ ¦ ¦ PROCESS CW ¦ ¦\ ¦ ¦ SETUP ¦
¦\¦
¦--------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦
Figure 5.8: Signalling at explicit invocation of a CUG call
When a subscriber to the CUG supplementary service sets up a call, an explicit
invocation involves transport of a ForwardCUG-Info operation in a Facility
information element in the SETUP message. Parameter mapping between the air-
interface SETUP message and the B-interface MAP_SEND_INFO_FOR_OUTGOING_CALL
service primitive shall take place in the MSC. Exact values of the parameter
and parameter tags are indicated in 3GPP TS 24.080 and 3GPP TS 24.085. The
parameter tags and values are mapped as follows:
Table 5.1: Mapping of parameter names and values for explicit invocation of a
CUG call
* * *
**3GPP TS 24.080 parameter name** **3GPP TS 29.002 parameter name** cug-Index
cug-Index suppressPrefCUG suppressPrefCUG suppressOA suppressOutgoingAccess
* * *
#### 5.1.4.2 Notification of CUG invocation to served MS
The signalling for this situation is shown in figure 5.9.
MS MSC VLR\ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦SEND INFORMATION FOR INCOMING
CALL SETUP¦ ¦\ ¦ ¦ ¦ ¦--------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\ ¦ ¦CALL PROCEEDING/¦ ¦ COMPLETE CALL ¦ ¦\ ¦ ¦ FACILITY ¦
¦\¦
¦--------------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦SEND
INFORMATION FOR OUTGOING CALL SETUP ERROR¦ ¦\ ¦ ¦ ¦
¦\¦ ¦\ ¦ ¦ DISCONNECT/ ¦ ¦ ¦ ¦\ ¦ ¦ RELEASE/ ¦ ¦ ¦ ¦\ ¦
¦RELEASE COMPLETE¦ ¦ SEND_ROUTING_INFO ¦ ¦\ ¦ ¦\¦ ¦\ ¦ ¦ ¦
¦ ¦ ¦\ ¦ ¦ ¦ ¦ COMPLETE CALL/ PROCESS CALL WAITING ¦ ¦\ ¦ ¦ ¦
¦\¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦
SEND INFORMATION FOR OUTGOING CALL SETUP ERROR/¦ ¦\ ¦ ¦ ¦ ¦SEND INFORMATION
FOR MOBILE ORIGINATED SMS ERROR/¦ ¦\ ¦ ¦ RELEASE ¦ ¦ ERROR ¦ ¦\ ¦ ¦ COMPLETE ¦
¦\¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ DISCONNECT/ ¦ ¦ SEND_ROUTING_INFO/
¦ ¦\ ¦ ¦ RELEASE/ ¦ ¦ ERROR ¦ ¦\ ¦ ¦ RELEASE COMPLETE ¦
¦\¦ ¦
¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦CCBS CALL DELIVERY¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦----------------->¦ ¦ ¦ ¦\ ¦
¦ ¦ ¦ ¦ ¦ STATUS_REPORT ¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦----------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦
Figure 5.16a: Signalling for CCBS call outcome
The CONNECT or ALERTING messages imply that the call establishment has been
successful. Then the value of the Outcome information element in the
MAP_STATUS_REPORT is set to success.
The DISCONNECT and RELEASE are, in this case, error messages and can contain
different causes (e.g. _Call Rejected_ or _User Busy_). The MSC translates the
message and/or the cause received into the proper value for the Outcome
information element (_Failure_ or _Busy_).
Exact coding and values of the messages and parameter tags can be found in
3GPP TS 24.008 and 3GPP TS 29.002.
## 5.2 SS Management in stable connection state
When a stable CM connection is set up between a mobile station and the
network, the following supplementary services may apply:
### 5.2.1 Call Forwarding services
#### 5.2.1.1 Notification of invocation of CFB to served mobile subscriber
As described in 3GPP TS 22.082, when the Call Forwarding on MS Busy service is
invoked by the network, a notification of this fact may be sent to the MS. The
signalling for the situation when the user is NDUB is shown in figure 5.17.
Note that if the subscriber is not NDUB, this notification does not apply.
MS MSC VLR\ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦SEND INFORMATION FOR INCOMING
CALL SETUP¦ ¦\ ¦ ¦ ¦ ¦--------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\ ¦ ¦ ¦ ¦ COMPLETE CALL ¦ ¦\ ¦ ¦ ¦
¦\¦ ¦------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ INVOKESS ACK ¦ ¦\ ¦ ¦
HOLD ACK/ ¦ ¦\¦ ¦------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ INVOKESS ACK ¦ ¦\ ¦ ¦
buildMPTY ¦ ¦\¦ ¦------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ INVOKESS ACK ¦ ¦\ ¦ ¦
explicitCT¦ ¦\¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\ ¦ ¦ ¦ ¦ COMPLETE CALL ¦ ¦\ ¦ ¦ ¦
¦\¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ CCBS REQUEST ¦ ¦ ¦ ¦\ ¦ ¦ ¦
¦----------------->¦ ¦ REGISTER_CC ENTRY¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦----------------->¦ ¦\
¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦ REGISTER_CC ¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦ ENTRY_ACK ¦ ¦\ ¦ ¦ ¦
¦ ¦ ¦ REGISTER_CC ¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦ ENTRY_ERROR ¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\¦
¦------------------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦
Figure 5.22: Signalling of a Call Deflection Request
The MS requests Invocation of Call Deflection by including a CallDeflection
operation (defined in 3GPP TS 24.080) in a DISCONNECT message. The parameters
of the CallDeflection operation of the DISCONNECT message shall be transferred
by the MSC to the VLR with the B-interface COMPLETE_CALL_ERROR or
PROCESS_CALL_WAITING_ERROR message.
#### 5.3.3.2 Call Deflection Operation Response
**Optimal Routeing of late call forwarding is not invoked**
The signalling for this situation is shown in figure 5.23.
MS MSC VLR\ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ COMPLETE CALL ERROR / PROCESS
CALL WAITING ERROR ¦ ¦\ ¦ ¦ ¦
¦------------------------------------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦
SEND INFORMATION FOR INCOMING CALL SETUP ACK / ¦ ¦\ ¦ ¦ ¦ ¦ SEND INFORMATION
FOR INCOMING CALL SETUP ERROR ¦ ¦\ ¦ ¦ RELEASE ¦
¦\¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ RESUME
CALL HANDLING ACK / ¦ ¦\ ¦ ¦ ¦ ¦ RESUME CALL HANDLING ERROR ¦ ¦\ ¦ ¦ ¦
¦\¦ ¦ A_CM_SERV_REQ ¦ ¦\ ¦ ¦ ¦ ¦ (CM service type = ¦
¦\ ¦ ¦ ¦ ¦ SS Activation) ¦ ¦\ ¦ ¦ ¦ ¦----------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦
Figure 6.1: Signalling flow for SS connection establishment
### 6.1.2 Connection established
At this stage of the connection, the version negotiation mechanism will be
invoked as described in clause 3. The abstract definition of the protocol used
for call independent SS operations is imported directly from 3GPP TS 29.002
into 3GPP TS 24.080.
The signalling for invocation of a supplementary service operation is shown in
figure 6.2, while figure 6.3 shows the signalling for returning the result of
the supplementary service operation. Tables 6.1 and 6.2 show the mapping of
3GPP TS 24.080 operation codes to MAP service primitives, and vice versa
respectively. The detailed mapping of the contents of the facility information
elements to the service primitives triggering the MAP user are described in
subclause 6.3.
MS MSC MAP User in MSC\ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ REGISTER/FACILITY ¦ ¦ ¦
¦\ ¦ ¦ (SS OPERATION) ¦ ¦ ¦ ¦\ ¦ ¦------------------------->¦ ¦SS_SERVICE
PRIMITIVE REQ¦ ¦\ ¦ ¦ ¦ ¦----------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦
Figure 6.2: Signalling flow for SS operation invocation
Choice of service primitive on the basis of received facility information
element is as follows:
Table 6.1: Mapping of 3GPP TS 24.080 operations to 3GPP TS 29.002 service
primitives
* * *
**Facility information element operation** **Service primitive for MAP Service
user** RegisterSS A_REGISTER_SS EraseSS A_ERASE_SS ActivateSS A_ACTIVATE_SS
DeactivateSS A_DEACTIVATE_SS InterrogateSS A_INTERROGATE_SS RegisterPassword
A_REGISTER_PASSWORD ProcessUnstructuredSS-Request
A_PROCESS_UNSTRUCTURED_SS_REQUEST EraseCC-Entry A_ERASE_CC_ENTRY
* * *
MS MSC MAP User in MSC\ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ REGISTER/FACILITY ¦
¦SS_SERVICE PRIMITIVE CNF¦ ¦\ ¦ ¦ (SS OPERATION) ¦
¦\¦ ¦ A_CM_SERV_REL ¦ ¦\ ¦ ¦ ¦
¦--------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦
Figure 6.5: Signalling flow for SS connection release by the MS
## 6.2 Network initiated SS Management
### 6.2.1 Connection establishment phase
Call independent supplementary service management takes place on a separate,
dedicated CM connection between the mobile station and the MSC. The MSC may
need to open a connection towards the MS (as described in 3GPP TS 24.008) to
send the Network initiated SS operation to the MS. Detailed mapping rules are
described in subclause 6.3.
### 6.2.2 Connection established
The abstract definition of the protocol used for call independent SS
operations is imported directly from 3GPP TS 29.002 into 3GPP TS 24.080.
The signalling for invocation of a Network initiated SS operation is shown in
figure 6.6, while figure 6.7 shows the signalling for returning the result of
supplementary service operation.
Choice of facility information element on the basis of received service
primitive is described in table 6.2.
MS MSC MAP User in MSC\ +-+ +-+ +-+\ ¦ ¦ ¦ ¦SS_SERVICE PRIMATIVE REQ¦ ¦\ ¦ ¦ ¦
¦\¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦SS_SERVICE PRIMATIVE CNF¦ ¦\ ¦
¦ ¦ ¦----------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦
Figure 6.7: Signalling flow for Network Initiated SS operation return result
### 6.2.3 Connection release
A Network initiated SS connection is usually released by the network. The
signalling for this situation is shown in figure 6.4.
However, in exceptional circumstances, the MS may request release of the
connection. The signalling for this situation is shown in figure 6.5.
### 6.2.4 ForwardCheckSSIndication
When a mobile station first makes contact with the network after there has
been a HLR restart, an indication may be sent by the HLR to the MS to inform
of possible unintended consequences with respect to supplementary services.
This indication is a separate service in the MAP
(MAP_FORWARD_CHECK_SS_INDICATION service), and the abstract definition of its
operation (ForwardCheckSSIndication) is imported into the 3GPP TS 24.080
protocol.
Upon receipt of ForwardCheckSSIndication from the VLR, the MSC shall create a
new call independent SS transaction and then send ForwardCheckSSIndication
(see 3GPP TS 24.010).
The MSC is only required to deliver ForwardCheckSSIndication if there is an
active RR connection to the MS. The network shall not page the MS in order to
deliver ForwardCheckSSIndication.
MS MSC VLR HLR\ +-+ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦ForwardCheckSSInd.¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦\¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ CCBS RUF
ACK ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦----------------->¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦REMOTE_USER
FREE_ACK¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦------------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦
Figure 6.9: Signalling for CCBS Recall
The indication of destination B idle is sent in the MAP_REMOTE_USER_FREE
service primitive. It is transmitted on the D-interface and relayed on the
B-interface. Then, the recall procedure starts with the establishment of a CC
connection initiated by the network with the CM SERVICE PROMPT message. The
following exchange of message concerns only the A-interface and is not
described here since it is already done in 3GPP TS 24.093.
The acceptation of the recall by the user is implicit in the SETUP message
sent by the MS to the MSC. This message contains the call information
previously sent to the MS and the indication that the call in its
establishment phase is a CCBS call. The MSC informs the HLR of this
acceptation by sending a MAP_REMOTE_USER_FREE_ACK message on the B-interface
and further on the D-interface.
In case an error occurs (e.g. _MS not reachable_ or _Incompatible terminal_),
at any time of the recall procedure (i.e. just after the error has been
received), the MSC shall send the MAP_REMOTE_USER_FREE_ERROR with the
appropriate value for the Error information element.
Exact values of the parameters and parameter tags are indicated in 3GPP TS
24.008, 3GPP TS 24.093 and 3GPP TS 29.002.
### 6.2.6 CCBS Monitoring
The monitoring process is initiated by the network. It is started on the
B-side as soon as subscriber B becomes a target of a CCBS request. It is
started on the A-side when subscriber A is found to be busy or suspends a
request while being offered a recall. Since the status of a subscriber is
linked to its activity, a message sent by the MS to the MSC may lead to the
transmission of a message containing the new status on the D-interface (i.e.
the MAP_STATUS_REPORT service primitive). This message contains a Status
information element which can take the value _Idle, Not_Reachable_ or _Not_
_Idle_.
Several situations might occur, they are described in the figure 6.10.
MS MSC VLR HLR\ +-+ +-+ +-+ +-+\ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦\ a. ¦ ¦CM SERVICE REQUEST¦ ¦
¦ ¦ ¦ ¦\ ¦ ¦----------------->¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ MS ACTIVITY ¦ ¦ ¦ ¦\ ¦ ¦ ¦
¦----------------->¦ ¦ ¦ ¦\ ___¦ ¦ ¦ ¦ ¦ ¦ STATUS REPORT ¦ ¦\ ¦ ¦ ¦ ¦ ¦
¦----------------->¦ ¦\ b. ¦ ¦ IMSI DETACH ¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦----------------->¦
¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ DETACH IMSI ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦----------------->¦ ¦ ¦ ¦\ ___¦
¦ ¦ ¦ ¦ ¦ STATUS REPORT ¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦----------------->¦ ¦\ c. ¦ ¦ RELEASE
¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦----------------->¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ CALL END ¦ ¦ ¦ ¦\ ¦ ¦ ¦
¦----------------->¦ ¦ ¦ ¦\ ___¦ ¦ ¦ ¦ ¦ ¦ STATUS REPORT ¦ ¦\ d. ¦ ¦ SETUP ¦ ¦
¦ ¦----------------->¦ ¦\ ¦ ¦----------------->¦ ¦ ¦ ¦ ¦ ¦\ ¦ ¦ ¦ ¦ NOT IDLE ¦
¦ ¦ ¦\ ¦ ¦ ¦ ¦----------------->¦ ¦ ¦ ¦\ ___¦ ¦ ¦ ¦ ¦ ¦ STATUS REPORT ¦ ¦\ ¦ ¦
¦ ¦ ¦ ¦----------------->¦ ¦\ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦
Figure 6.10: Signalling for CCBS Monitoring
For all these situations (from a to d), the transmission of the
MAP_STATUS_REPORT service primitive depends on the possible change of status
of the MS. The detailed behaviour of this procedure is described in 3GPP TS
23.093.
Exact coding and values of the messages are indicated in 3GPP TS 24.008 and
3GPP TS 29.002.
## 6.3 Mapping of Operation Codes, Error Codes, Parameter Tags and Parameter
Contents
### 6.3.1 Operation codes
The same operation codes are used for equivalent operations in 3GPP TS 24.080
and 3GPP TS 29.002 for call independent supplementary service management.
### 6.3.2 Error codes
For call independent supplementary service management, the same error codes
are used for equivalent error types in 3GPP TS 24.080 and 3GPP TS 29.002.
The RETURN ERROR components are also constructed in the same way on both sides
of the interface.
### 6.3.3 Parameter tags and parameter values
The same parameter tags and parameter values are used for equivalent
parameters in 3GPP TS 24.080 and 3GPP TS 29.002.
#