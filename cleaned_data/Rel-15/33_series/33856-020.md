# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
The interworking between NR andUTRAN is not supported in 3GPP, leading to the
lack of Voice Call Continuity from NR to UTRAN. This may cause problem to
voice service, when NR coverage is limited, as listed below:
Scenario # -- Operators with both VoNR and VoLTE enabled
  * In the initial stage of 5G deployment, the voice service continuity may not be guaranteed if the VoLTE coverage provided by the operators is not (ideal) complete, i.e., there are some "holes" of VoLTE coverage.
The present document presents the security aspects of single radio voice
continuity from 5G to UTRAN.
# 1 Scope
The present document studies the security aspects of single radio voice
continuity from 5G to UTRAN CS. In particular, the goal of the present
document is to study the impacts on 3GPP security architecture which may
result from 5GS to UTRAN CS voice continuity, e.g. security context mapping
from 5G and UTRAN, security procedure for the emergency call, etc.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**example:** text used to clarify abstract rules by applying them literally.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
\ \
# 4 Overview
# 5 Key issues
## 5.1 Key Issue #1: Achieving backward security of key derivation during
SRVCC from 5G to UTRAN CS
[]{#__RefHeading___Toc515055695 .anchor}5.1.1 Key issue details
During SRVCC from 5G to UTRAN CS, .
the MSC server should never know the K~AMF~ nor should the K~AMF~ be revealed
to an entity other than AN AMF. If the AMF or the MME does not derive new
key(s) to create a mapped SRVCC security context for the MSC server instead of
sending K~AMF~ to the MSC server, or if the keys sent to the MSC server are
not generated properly, the MSC server or an attacker can gain knowledge of
K~AMF~ and violate backward security.
[]{#__RefHeading___Toc515055696 .anchor}5.1.2 Security threats
If the backward security is not achieved, the key received from the AMF may be
used to attack 5G system, for example, deriving other keys based on K~AMF~ and
recover communication between a UE and the system.
### 5.1.3 Potential Security requirements
> \- backward security shall be achieved when handover is performed from the
> AMF to the MSC server
## 5.2 Key Issue #2: \
### 5.2.1 Key issue details
During SRVCC from 5G to 3G, IMS Emergency Sessions can be made by:
  * normally attached UEs or
  * UEs attached for emergency bearer services.
IMS Emergency Services can be authenticated or unauthenticated, it depends on
the serving network policy if unauthenticated IMS Emergency Sessions are
allowed. Any behaviour not explicitly specified as being special to IMS
Emergency Sessions is handled in accordance to normal procedures.
If the SRVCC is for an emergency call, the UE is not in limited service state,
it initiates normal initial attach when not already attached to receive
emergency bearer services. If the serving network attempts to authenticate the
UE after receiving a request for emergency bearer services which was integrity
protected by the current NAS security context and the authentication failed
and if the serving network policy does not allow unauthenticated IMS Emergency
Sessions, the UE and AMF proceed as for set up of normal bearers.
In this scenario, since the serving network policy does not allow
unauthenticated IMS Emergency Sessions, the continuous authentication process
may exhaust UE and network resource.
### 5.2.2 Security threats
If the serving network policy does not allow unauthenticated IMS Emergency
Sessions, the continuous authentication process may exhaust the resources of
UE and network.
### 5.2.3 Potential Security requirements
The continuous authentication process during the IMS Emergency Session
handling shall be avoided.
# 6 Solutions
Editor\'s note: This clause contains solutions proposed to address the
identified key issues.
## 6.1 Solution #1.1: Key derivation during SRVC from 5G to UTRAN CS without
direct interface between AMF and MSC server
### 6.1.1 Introduction
This solution addresses the key issue #5.1, namely achieving backward security
of key derivation during SRVCC from 5G to UTRAN CS if there is no direct
interface between the AMF and the MSC server.
### 6.1.2 Solution details
**Figure6 -1: key derivation of 5G to UTRAN CS during SRVCC without direct
interface between AMF and MSC server**
The gNB sends Handover Required message to the AMF.
The AMF derives a new K\'~ASME~ key using the K~AMF~ key and the current
downlink 5G NAS COUNT of the current 5G security context as described in
clause 8.6.1 of TS 33.501 [1].
The AMF assigns the value of ngKSI to the eKSI (maps ngKSI to eKSI) and
transfers the new K\'~ASME~ key and the UE security capability to the MME via
PS to CS HO request message.
The MME may further derive the CK~SRVCC~, IK~SRVCC~ based on the new K\'~ASME~
key, or treat the received new K\'~ASME~ key as the concatenation of the
CK~SRVCC~, IK~SRVCC~. Then the MME assigns the value of eKSI to KSI~SRVCC~
(maps eKSI to KSI~SRVCC~) and transfers CK~SRVCC~, IK~SRVCC~ with KSI~SRVCC,~
downlink 5G NAS COUNT and the UE security capability to the MSC server in PS
to CS HO request message.
> NOTE: MME and UE need to agree on how CK~SRVCC~, IK~SRVCC~ are derived (e.g.
> via a new key generation procedure using K'~ASME~ or treating K'~ASME~ as a
> simple concatenation of CK~SRVCC~, IK~SRVCC~).
The MSC server sends the PS to CS HO response message to the MME.
The MME sends the PS to CS HO response message including the security
parameters in step 4 to the AMF.
The AMF sends PS to CS HO command to the gNB, in which includes the security
parameters in step 6.
The gNB sends the PS to CS HO command to the UE, in which includes the
security parameters in step 7.
When the UE receives the message, it derives the new K\'~ASME~ key using the
K~AMF~ key and the current downlink 5G NAS COUNT, and identifies the CK~SRVCC~
and IK~SRVCC~ as the MME does.
If the SRVCC handover is not completed successfully, the new mapped CK~SRVCC~,
IK~SRVCC~ and KSI~SRVCC~ cannot be used. The MSC server enhanced for SRVCC
shall delete the newly mapped SRVCC security context for the UE, including
CK~SRVCC~, IK~SRVCC~ and KSI~SRVCC~.
### 6.1.3 Evaluation
TBA
## 6.2 Solution #1.2: Key derivation during SRVCC from 5G to UTRAN CS with
direct interface between AMF and MSC server
### 6.2.1 Introduction
This solution addresses the key issue #5.1, namely achieving backward security
of key derivation during SRVCC from 5G to UTRAN CS if there is a direct
interface between the AMF and the MSC server.
### 6.2.2 Solution details
**Figure6.-2: key derivation of 5G to UTRAN CS during SRVCC with direct
interface between AMF and MSC server**
The gNB sends Handover Required message to the AMF.
The AMF derives CK~SRVCC~\|\|IK~SRVCC~ using the K~AMF~ key and the current
downlink 5G NAS COUNT of the current 5G security context.
The AMF assigns the value of ngKSI to the KSI~SRVCC~ (maps ngKSI to
KSI~SRVCC~) and transfers the CK~SRVCC~\|\|IK~SRVCC~ and the UE security
capability to the MSC servere via PS to CS HO request message.
The MSC server sends the PS to CS HO response message to the AMF.
The AMF sends PS to CS HO command to the gNB, in which includes the security
parameters in step 3.
The gNB sends the PS to CS HO command to the UE, in which includes the
security parameters in step 5.
When the UE receives the message, it derives the CK~SRVCC~\|\|IK~SRVCC~ using
the K~AMF~ key and the current downlink 5G NAS COUNT.
If the SRVCC handover is not completed successfully, the new mapped CK~SRVCC~,
IK~SRVCC~ and KSI~SRVCC~ cannot be used. The MSC server enhanced for SRVCC
shall delete the newly mapped UE SRVCC security context, including CK~SRVCC~,
IK~SRVCC~ and KSI~SRVCC~.
### 6.2.3 Evaluation
TBA
## 6.3 Solution #1.3: Emergency session in SRVCC from 5G to UTRAN CS
### 6.3.1 Introduction
This clause addresses the key issue #5.1 for authenticated emergency session
and unauthenticated emergency session.
### 6.3.2 Solution details
When the SVRCC is for an authenticated emergency session or an unauthenticted
emergency session, the security procedure in solution #1.1 is applied if there
is no direct interface between the AMF and the MSC server. Otherwise if there
is direct interface between the AMF and the MSC server, the security procedure
in solution #1.2 is applied.
In the case when the SRVCC is for an unauthenticated emergency session, since
the derived keys have no ability to affect the output of the NULL algorithms,
it is irrelevant that the network and the UE derive different keys.
### 6.3.3 Evaluation
TBA
# 7 Conclusions
Editor\'s note: This clause is intended to list conclusions that have been
agreed during the course of the study item activities.
#