# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document contains objectives, requirements and test cases that are
specific to the eNB network product class. It refers to the Catalogue of
General Security Assurance Requirements and formulates specific adaptions of
the requirements and test cases given there, as well as specifying
requirements and test cases unique to the eNB network product class.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 33.117 (Release 15): \"Catalogue of general security assurance
requirements\".
[3] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security
architecture\".
[4] 3GPP TR 33.926: \"Security Assurance Specification (SCAS) threats and
critical assets in 3GPP network product classes\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
# 4 eNodeB-specific security requirements and related test cases
## 4.1 Introduction
eNodeB specific security requirements include both requirements derived from
eNodeB-specific security functional requirements as well as security
requirements derived from threats specific to eNB as described in TR 33.926
[4]. Generic security requirements and test cases common to other network
product classes have been captured in TS 33.117 [2] and are not repeated in
the present document.
## 4.2 eNodeB-specific security functional adaptations of requirements and
related test cases
### 4.2.1 Introduction
Present clause contains eNodeB-specific security functional adaptations of
requirements and related test cases.
### 4.2.2 Security functional requirements on the eNodeB deriving from 3GPP
specifications and related test cases
#### 4.2.2.1 Security functional requirements on the eNodeB deriving from 3GPP
specifications -- TS 33.401 [3]
##### 4.2.2.1.1 Control plane data confidentiality protection
> _Requirement Name:_ Control plane data confidentiality protection
>
> _Requirement Reference:_ TS 33.401 [3], clause 5.3.4a
>
> _Requirement Description:_ \"The eNB shall provide confidentiality
> protection for control plane packets on the S1/X2 reference points.\" as
> specified in TS 33.401 [3], clause 5.3.4a.
>
> _Threat References:_ TR 33.926 [4], clause C.2.2.1 -- Control plane data
> confidentiality protection.
>
> _Test Case:_
>
> The requirement mentioned in this clause is tested in accordance to the
> procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].
##### 4.2.2.1.2 Control plane data integrity protection
> _Requirement Name:_ Control plane data integrity protection
>
> Requirement Reference: TS 33.401 [3], clause 5.3.4a
>
> _Requirement Description:_ \"The eNB shall provide integrity protection for
> control plane packets on the S1/X2 reference points.\" as specified in TS
> 33.401 [3], clause 5.3.4a.
>
> _Threat References:_ TR 33.926 [4], clause C.2.2.2 -- Control plane data
> integrity protection.
>
> _Test Case:_
>
> The requirement mentioned in this clause is tested in accordance to the
> procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].
##### 4.2.2.1.3 User plane data ciphering and deciphering at the eNB
> _Requirement Name:_ User plane data ciphering and deciphering at the eNB
>
> Requirement Reference: TS 33.401 [3], clause 5.3.4
>
> _Requirement Description:_ \"The eNB shall cipher and decipher user plane
> packets between the Uu reference point and the S1/X2 reference points.\" as
> specified in TS 33.401 [3], clause 5.3.4.
>
> _Threat References:_ TR 33.926 [4], clause C.2.2.3 -- User plane data
> ciphering and deciphering at the eNB.
>
> _Test Case:_
>
> The requirement mentioned in this clause is tested in accordance to the
> procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].
##### 4.2.2.1.4 User plane data integrity protection
> _Requirement Name:_ User plane data integrity protection
>
> Requirement Reference: TS 33.401 [3], clause 5.3.4
>
> _Requirement Description:_ \"The eNB shall handle integrity protection for
> user plane packets for the S1/X2 reference points.\" as specified in TS
> 33.401 [3], clause 5.3.4.
>
> _Threat References:_ TR 33.926 [4], clause C.2.2.4 -- User plane data
> integrity protection.
>
> _Test Case:_
>
> The requirement mentioned in this clause is tested in accordance to the
> procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].
##### 4.2.2.1.5 AS algorithms selection
> _Requirement Name_ : AS algorithms selection
>
> _Requirement Reference:_ TS 33.401 [3], clause 7.2.4.1; TS 33.401 [3],
> clause 7.2.4.2.1
>
> _Requirement Description_ : \" The serving network shall select the
> algorithms to use dependent on: the UE security capabilities of the UE, and
> the configured allowed list of security capabilities of the currently
> serving network entity.\" as specified in TS 33.401 [3], clause 7.2.4.1\".
>
> \"Each eNB shall be configured via network management with lists of
> algorithms which are allowed for usage. There shall be one list for
> integrity algorithms, and one for ciphering algorithms. These lists shall be
> ordered according to a priority decided by the operator.\" as specified in
> TS 33.401 [3], clause 7.2.4.2.1.
>
> _Threat References_ : TBA
>
> _Test Case_ :
>
> **Purpose:**
>
> Verify that the eNB select the algorithm with the highest priority in its
> configured list.
>
> **Pre-Conditions:**
>
> Test environment with the eNB has been pre-configured with allowed security
> algorithms with priority.
>
> **Execution Steps**
1) The UE sends attach request message to the eNB.
2) The eNB receives S1 context setup request message.
3) The eNB sends the SECURITY MODE COMMAND message.
4) The UE replies with the AS SECURITY MODE COMPLETE message.
> **Expected Results:**
>
> The eNB initiates the SECURITY MODE COMMAND message that includes the chosen
> algorithm with the highest priority according to the ordered lists and is
> contained in the UE EPS security capabilities.
>
> The MAC in the AS SECURITY MODE COMPLETE message is verified, and the AS
> protection algorithms are selected and applied correctly.
>
> **Expected format of evidence:**
>
> Sample copies of the log files.
##### 4.2.2.1.6 Verify RRC integrity protection
> _Requirement Name_ : The check of RRC integrity
>
> _Requirement Reference:_ TS 33.401 [3], clause 7.4.1
>
> _Requirement Description_ : \" The supervision of failed RRC integrity
> checks shall be performed both in the ME and the eNB. In case of failed
> integrity check (i.e. faulty or missing MAC-I) is detected after the start
> of integrity protection, the concerned message shall be discarded. \" as
> specified in TS 33.401 [3], clause 7.4.1.
>
> _Threat References_ : TBA
>
> _Test Case_ :
>
> **Purpose:**
>
> Verify that the message is discarded in case of failed integrity check (i.e.
> faulty or missing MAC-I).
>
> **Pre-Conditions:**
>
> Test environment with RRC Protection is activated at the eNB.
>
> **Execution Steps**
>
> Positive:
>
> The eNB receives a RRC message with a right MAC-I.
>
> Negative:
>
> The eNB receives a RRC message with a wrong MAC-I or missing MAC-I.
>
> **Expected Results:**
>
> The RRC message is discarded in the negative test.
>
> **Expected format of evidence:**
Sample copies of the log files.
##### 4.2.2.1.7 The selection of EIA0
> _Requirement Name_ : The selection of EIA0
>
> _Requirement Reference:_ TS 33.401 [3], clause 5.1.4.2
>
> _Requirement Description_ : \" EIA0 is only allowed for unauthenticated
> emergency calls \" as specified in TS 33.401 [3], clause 5.1.4.2.
>
> _Threat References_ : TBA
>
> _Test Case_ :
>
> **Purpose:**
>
> Verify that AS NULL integrity algorithm is used correctly.
>
> **Pre-Conditions:**
>
> Test environment with a UE. The UE may be simulated.
>
> The vendor shall provide documentation describing how EIA0 is disabled or
> enabled.
>
> **Execution Steps**
>
> Positive:
1) The eNB receives a UE security capability only containing EIA0 from S1
context setup message.
2) The eNB sends AS SMC to the UE.
> Negative:
1) The eNB receives a UE security capability that contains EIA0 and other
integrity algorithm(s).
2) The eNB sends AS SMC to the UE.
> **Expected Results:**
>
> EIA0 is only selected in the Positive test.
>
> **Expected format of evidence:**
>
> Sample copies of the log files.
##### 4.2.2.1.8 Key refresh at the eNB
> _Requirement Name_ : Key refresh at the eNB
>
> _Requirement Reference:_ TS 33.401 [3], clause 7.2.9.1
>
> _Requirement Description_ : \"Key refresh shall be possible for K~eNB~,
> K~RRC-enc~, K~RRC-int~, K~UP-int~, and K~UP-enc~ and shall be initiated by
> the eNB when a PDCP COUNTs is about to be re-used with the same Radio Bearer
> identity and with the same K~eN~. \" as specified in TS 33.401 [3], clause
> 7.2.9.1.
>
> _Threat References_ : TBA
>
> _Test Case_ :
>
> **Purpose:**
>
> Verify that the eNB performs K~eNB~ refresh when PDCP COUNTs are about to
> wrap around.
>
> **Pre-Conditions:**
>
> UE may be simulated.
>
> **Execution Steps**
1) The eNB sends AS SMC to the UE, and the UE response AS SMC.
2) UE sends RRC messages or UP messages to the eNB with a PDCP COUNT that is
about to wrap around. UE continue sending RRC messages or UP messages with an
increasing PDCP COUNT until step 3 occurs or PDCP COUNT wraps around.
3) The eNB triggers intra-cell handover.
> **Expected Results:**
>
> The eNB triggers intra-cell handover to get a new KeNB.
>
> **Expected format of evidence:**
>
> Part of log that shows the PDCP COUNT wrap around and the intra-cell
> handover. This part can be presented for example as a screenshot.
##### 4.2.2.1.9 AS Security Mode Command Procedure
_Requirement Name_ : AS integrity algorithm selection
_Requirement Reference:_ TS 33.401 [3], clause 7.4.2
_Requirement Description_ : The eNB shall protect the SECURITY MODE COMMAND
message with the integrity algorithm, which has the highest priority according
to the ordered lists.
_Threat References_ : TBA
_Test Case_ :
**Purpose:**
Verify that AS integrity protection algorithm is selected and applied
correctly.
**Pre-Conditions:**
Test environment with UE. UE may be simulated.
**Execution Steps:**
The eNB sends the SECURITY MODE COMMAND message. The UE replies with the
SECURITY MODE COMPLETE message.
**Expected Results:**
1\. The eNB has selected the integrity algorithm which has the highest
priority according to the ordered lists and is contained in the UE EPS
security capabilities. The eNB checks the message authentication code on the
SECURITY MODE COMPLETE message.
2\. The MAC in the SECURITY MODE COMPLETE is verified, and the AS integrity
protection algorithm is selected and applied correctly.
**Expected format of evidence:**
Snapshots containing the result.
##### 4.2.2.1.10 Bidding down prevention in X2-handovers
_Requirement Reference:_ TBA
_Requirement Description_ : \"In the path-switch message, the target eNB shall
send the UE EPS security capabilities received from the source eNB to the
MME.\" as specified in TS 33.401 [3], clause 7.2.4.2.2.\"
_Threat References_ : TBA
_Test Case_ :
**Purpose:**
Verify that bidding down is prevented in X2-handovers.
**Pre-Conditions:**
Test environment with source eNB and target eNB, and the source eNB may be
simulated.
**Execution Steps:**
The target eNB sends the path-switch message to the MME.
**Expected Results:**
The UE EPS security capabilities are in the path-switch message.
**Expected format of evidence:**
Snapshots containing the result
##### 4.2.2.1.11 AS protection algorithm selection in eNB change
_Requirement Name_ : AS protection algorithm selection in eNB change.
_Requirement Reference:_ TS 33.401 [3], clause 7.2.4.2.2, and clause 7.2.4.2.3
_Requirement Description_ : \"The target eNB shall select the algorithm with
highest priority from the UE EPS security capabilities according to the
prioritized locally configured list of algorithms (this applies for both
integrity and ciphering algorithms). The chosen algorithms shall be indicated
to the UE in the handover command if the target eNB selects different
algorithms compared to the source eNB\" as specified in TS 33.401 [3], clause
7.2.4.2.2, and clause 7.2.4.2.3.
_Threat References_ : TBA
_Test Case_ :
**Purpose:**
Verify that AS protection algorithm is selected correctly.
**Pre-Conditions:**
Test environment with source eNB, target eNB and MME. Source eNB and MME may
be simulated.
**Execution Steps:**
Test Case 1:
Source eNB transfers the ciphering and integrity algorithms used in the source
cell to the target eNB in the handover request message.
Target eNB verifies the algorithms and selects AS algorithms which have the
highest priority according to the ordered lists. Target eNB includes the
algorithm in the handover command.
Test Case 2:
MME sends the UE EPS security capability to the Target eNB.
The target eNB selects the AS algorithms which have the highest priority
according to the ordered lists in the HANDOVER COMMAND.
The above test cases assume that the algorithms selected by the target eNB are
different from the ones received from the source eNB.
**Expected Results:**
For both test cases:
1\. The UE checks the message authentication code on the handover command
message.
2\. The MAC in the handover complete message is verified, and the AS integrity
protection algorithm is selected and applied correctly.
**Expected format of evidence:**
Snapshots containing the result.
##### 4.2.2.1.12 RRC and UP downlink ciphering at the eNB
_Requirement Name:_ RRC and UP downlink ciphering at the eNB.
_Requirement Reference:_ TS 33.401 [3], clause 7.2.4.5
_Requirement Description:_ \"The eNB shall start RRC and UP downlink ciphering
after sending the AS security mode command message\" .
_Threat References:_ TBA
_Test Case:_
**Test Name:** TC_eNB_DL_Cipher
**Purpose:** To verify that the eNB performs RRC and UP downlink ciphering
after sending the AS security mode command message.
**Pre-Condition:**
\- The UE and eNB network products are connected in the test environment. UE
may be simulated.
\- The tester shall have access to the AS security context and the
corresponding cryptographic keys (e.g. RRC and UP cipher keys).
\- The tester have access to Uu interface and ability to capture the Uu
interface messages with the debug port enabled in the UE.
**Execution Steps:**
1) The tester shall POWER ON the UE to trigger the registration procedures
(Attach and SMC).
2) The tester performs packet capturing over the Uu interface using any packet
analyser.
3) The tester filters the AS SMC command message and the following RRC and UP
downlink packets from eNB to UE.
4) The tester proceeds the testing based on the parameters (algorithm
identifier and algorithm distinguisher) present in the AS SMC command message.
Case 1: If the parameters refer to null ciphering algorithm, the tester
verifies that the downlink packets filtered in step 3 are unciphered.
Case 2: If the parameters refer to algorithms such as SNOW, AES, ZUC, the
tester verifies that the downlink packets filtered in step 3 are ciphered.
> The tester also checks if the packets are ciphered in accordance with the
> selected algorithm stated in the AS SMC command message.
NOTE: The requirement mentioned in this clause is tested in accordance with
the procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].
**Expected Results:**
\- The downlink packets following the AS SMC command message are ciphered
except NULL ciphering algorithm case.
**Expected format of evidence:**
Evidence suitable for the interface, e.g. Screenshot contains the operation
results.
### 4.2.3 Technical Baseline
#### 4.2.3.1 Introduction
The present clause provides baseline technical requirements.
#### 4.2.3.2 Protecting data and information
##### 4.2.3.2.1 Protecting data and information -- general
There are no eNB-specific additions to clause 4.2.3.2.1 of TS 33.117 [2].
##### 4.2.3.2.2 Protecting data and information -- unauthorized viewing
There are no eNB-specific additions to clause 4.2.3.2.2 of TS 33.117 [2].
##### 4.2.3.2.3 Protecting data and information in storage
There are no eNB-specific additions to clause 4.2.3.2.3 of TS 33.117 [2].
##### 4.2.3.2.4 Protecting data and information in transfer
There are no eNB-specific additions to clause 4.2.3.2.4 of TS 33.117 [2].
##### 4.2.3.2.5 Logging access to personal data
The requirement and testcases in clause 4.2.3.2.5 of TS 33.117 [2] is not
applicable to eNB network product.
#### 4.2.3.3 Protecting availability and integrity
There are no eNB-specific additions to clause 4.2.3.3 of TS 33.117 [2].
#### 4.2.3.4 Authentication and authorization
##### 4.2.3.4.1 Authentication attributes
eNB-specific adaptation to clause 4.2.3.4.2.1 of TS 33.117 [2] is:
\- Dual-factor authentication by combining several authentication options as
noted in clause 4.2.3.4.2.1 of TS 33.117 [2] for higher level of security is
not applicable to the eNB.
Apart from the above exception, there are no other eNB-specific adaptations to
clause 4.2.3.4.2 of TS 33.117 [2].
#### 4.2.3.5 Protecting sessions
There are no eNB-specific additions to clause 4.2.3.5 of TS 33.117 [2].
#### 4.2.3.6 Logging
There are no eNB-specific additions to clause 4.2.3.6 of TS 33.117 [2].
### 4.2.4 Operating Systems
eNB-specific additions to clause 4.2.4 of TS 33.117 [2] are:
For the requirement defined in clause 4.2.4.1.1.2 Handling of ICMP of TS
33.117[2]:
\- Echo Reply can be sent by default.
\- In case of remote base station auto deployment, Router Advertisement can be
processed.
Apart from the above exceptions, there are no eNB-specific addtions to clause
4.2.4 of TS 33.117 [2].
### 4.2.5 Web Servers
There are no eNB-specific additions to clause 4.2.5 of TS 33.117 [2].
### 4.2.6 Network Devices
#### 4.2.6.1 Protection of Data and Information
There are no eNB-specific additions to clause 4.2.6 of TS 33.117 [2].
#### 4.2.6.2 Protecting availability and integrity
##### 4.2.6.2.1 Packet filtering
There are no eNB-specific additions to clause 4.2.6.2.1 of TS 33.117 [2].
##### 4.2.6.2.2 Interface robustness requirements
There are no eNB-specific additions to clause 4.2.6.2.2 of TS 33.117 [2].
##### 4.2.6.2.3 GTP-C Filtering
The requirement and test case in clause 4.2.6.2.3 of TS 33.117 [2] are not
applicable to eNB network products.
##### 4.2.6.2.4 GTP-U Filtering
There are no eNB-specific additions to clause 4.2.6.2.4 of TS 33.117 [2].
### 4.2.7 Void
## 4.3 eNodeB-specific adaptations of hardening requirements and related test
cases
### 4.3.1 Introduction
The present clause contains eNodeB-specific adaptations of hardening
requirements and related test cases.
### 4.3.2 Technical Baseline
There are no eNB-specific additions to clause 4.3.2 of TS 33.117 [2].
### 4.3.3 Operating Systems
There are no eNB-specific additions to clause 4.3.3 of TS 33.117 [2].
### 4.3.4 Web Servers
There are no eNB-specific additions to clause 4.3.4 of TS 33.117 [2].
### 4.3.5 Network Devices
There are no eNB-specific additions to clause 4.3.5 of TS 33.117 [2].
### 4.3.6 Void
## 4.4 eNodeB-specific adaptations of basic vulnerability testing requirements
and related test cases
There are no eNB-specific additions to clause 4.4 of TS 33.117 [2].
#