# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document studies potential enhancements to the \"Isolated E-UTRAN
Operation for Public Safety\" feature specified in TS 23.401 [2].
Whereas this feature assumes a complete absence of backhaul, the present study
considers following cases:
\- the backhaul is not completely lost but suffers from a limited bandwidth,
which does not suffice for normal operation; or
\- the backhaul is completely lost and a backup link is set up (by means
outside the scope of this study) to provide backhaul with a limited bandwidth
as above.
Under such scenario it is desirable to use the available backhaul for
signalling between an E-UTRAN site and other PLMN entities, for local mission
critical communications. The present document studies enhancements to realize
this in an optimal manner.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[3] 3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network
layer security\".
[4] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security
architecture\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**IOPS network:** see TS 23.401 [2].
**IOPS network with Limited Backhaul:** A network consisting of one or more
eNBs and a Local EPC with a sub-set of the functional entities, having limited
backhaul to the Macro EPC to connect to the rest of the EPC functional
entities.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
Abbreviation format (EW)
\ \
# 4 Architectural considerations
## 4.1 Architectural assumptions
Like a Rel-13 IOPS network, an IOPS network with Limited Backhaul broadcasts a
PLMN identity that is dedicated to IOPS mode of operation. This PLMN identity
corresponds to the one that is served by the HSS of the Local EPC. In
addition, UEs having a subscription in other IOPS PLMNs may be served by the
IOPS network with Limited Backhaul.
## 4.2 Architectural requirements
The architecture for IOPS with Limited Backhaul should not expose the IMSI
more than the current EPS architecture.
# 5 Key issues
## 5.1 Key issue 1: Optimizing the use of the limited backhaul for local
communications
This Key Issue aims at developing solutions to:
\- limit the signalling exchanges between an IOPS network and other PLMN
entities to provide local mission-critical communications, when the E-UTRAN
experiences backhaul limitations
\- make use of the limited backhaul to allow Public Safety UEs not known in
the IOPS network but having a subscription in other IOPS PLMN (i.e., other
PLMN identity beside the one being broadcasted by the current eNb which is
also dedicated to IOPS mode of operation), to be served by this IOPS network
operating with a limited backhaul.
## 5.2 Key issue 2: Transition of an IOPS network between full isolation and
limited backhaul
When the Rel-13 IOPS feature described in Annex K of TS 23.401 [2] is
deployed, an IOPS network can maintain a level of communications in the
absence of backhaul, i.e. without communicating with other PLMN entities. From
this situation, it may be possible to setup a backup or temporary connection
to provide a backhaul with limited bandwidth, thus transitioning to a
\"limited backhaul\" configuration. Reversely, an IOPS network with limited
backhaul (IOPS LB) can later transition to a full isolation configuration,
e.g. because a backup or temporary connection goes down or because the
incident that caused a degradation of the backhaul further developed and led
to complete loss of the backhaul.
This key issue will develop solutions for handling these transitions. In
particular, this key issue will determine the handling of the UEs that were
using the IOPS network before the transition occurs (in either direction).
## 5.x Key issue x: Title
Editor\'s note: This clause will identify key architectural issues to be
solved during the architecture design.
# 6 Solutions
## 6.1 Solution 1: IOPS network using the backhaul for authentication only
### 6.1.1 Description
#### 6.1.1.1 Introduction and high-level architecture
This is a solution to Key Issue 1.
This solution consists in making use of the backhaul for authentication only,
in order to limit the traffic on the limited backhaul, while allowing real-
time management of the users by the network operator.
For the user plane, SIPTO\@LN is re-used, with a L-GW in the Isolated Network
Node.
For the control plane, most functionalities of the MME are provided in the
Isolated Network Node in order to avoid that signalling traffic related to
Service Requests traverses the backhaul. Interaction with the HSS is kept in
the central part of network in order to avoid direct access to the HSS from a
multitude of radio sites, that could cause security and resilience issues.
Based on these principles, the following architecture is proposed:
Figure 6.1.1.1-1: High-level architecture for IOPS network using the backhaul
for authentication only
The IOPS network comprises an L-MME (Local MME), which locally assumes the
functions of an MME (authentication, bearer management, etc.) and interacts
with the rest of the PLMN via a \"Proxy MME\" (P-MME), for authentication and
mobility procedures (when moving in/out of the area covered by the IOPS
network). The P-MME is meant to be a \"central\" element in the PLMN used by
potentially all isolated network sites and is seen by other network entities
as a normal MME (serving all the users attaches through an IOPS network
connected to it). It also enables roaming by interacting with the HSS in the
HPLMN.
With regards to Network Domain Security (see TS 33.210 [3]), the P-MME belongs
to the security domain of the macro CN whereas the IOPS Network (including the
L-MME) does not. In consequence, the security material conveyed on S6a\' is
different to that conveyed on S6a and to be determined by SA WG3.
The IOPS Network uses a PLMN ID that is dedicated to IOPS mode of operation
and therefore different to the PLMN ID of the macro network. When operating in
IOPS mode, IOPS-enabled UEs only use the appropriate USIM credentials defined
in the UICC, i.e. those defined exclusively for use in an IOPS PLMN. As a
consequence, mobility procedures between the macro network and the IOPS
Network are not supported.
The Local HSS manages the subscriptions of the PLMN which identity is
broadcast by the IOPS Network. The IOPS-enabled UEs equipped with USIM
credentials of this PLMN are handled according to Rel-13 IOPS (see TS 23.401
[2] Annex K), using the Local HSS as defined in TS 33.401 [4] Annex F. The
IOPS-enabled UEs equipped with USIM credentials of other IOPS PLMNs are not
handled by the Local HSS but by the HSS of their respective PLMN in the macro
network.
GUTI handling is unchanged compared to normal EPS operation: when attaching to
an IOPS Network, the UE is provided with a GUTI (allocated by the P-MME), and
the UE uses this GUTI to identify itself for any subsequent procedure (TAU,
Attach) with the same USIM. The L-MME will then retrieve the IMSI from the
P-MME if needed.
#### 6.1.1.2 MME functional split
Table 6.1.1.2-1: MME functional split
+-----------------------------+-------+-----------------------------+ | MME function | L-MME | P-MME | +-----------------------------+-------+-----------------------------+ | NAS signalling | X | | +-----------------------------+-------+-----------------------------+ | NAS signalling security | X | | +-----------------------------+-------+-----------------------------+ | Inter CN node signalling | | N/A | | for mobility between 3GPP | | | | access networks | | | | (terminating S3) | | | +-----------------------------+-------+-----------------------------+ | UE Reachability in ECM-IDLE | X | | | state (including control, | | | | execution of paging | | | | retransmission and | | | | optionally Paging Policy | | | | Differentiation) | | | +-----------------------------+-------+-----------------------------+ | Tracking Area list | | N/A | | management | | | | | | NOTE: The TA List contains | | | | only 1 TA corresponding to | | | | the IOPS network. | +-----------------------------+-------+-----------------------------+ | Mapping from UE location | | N/A | | (e.g. TAI) to time zone, | | | | and signalling a UE time | | | | zone change associated with | | | | mobility, | | | +-----------------------------+-------+-----------------------------+ | PDN GW and Serving GW | X | | | selection | | | +-----------------------------+-------+-----------------------------+ | MME selection for handovers | N/A | N/A | | with MME change | | | +-----------------------------+-------+-----------------------------+ | SGSN selection for | N/A | N/A | | handovers to 2G or 3G 3GPP | | | | access networks | | | +-----------------------------+-------+-----------------------------+ | Roaming (S6a towards home | | X | | HSS) | | | +-----------------------------+-------+-----------------------------+ | Authentication | X | | +-----------------------------+-------+-----------------------------+ | Authorization | X | | +-----------------------------+-------+-----------------------------+ | Bearer management functions | X | | | including dedicated bearer | | | | establishment | | | +-----------------------------+-------+-----------------------------+ | Lawful Interception of | X | | | signalling traffic | | | +-----------------------------+-------+-----------------------------+ | Warning message transfer | X | | | function (including | | | | selection of appropriate | | | | eNodeB) | | | +-----------------------------+-------+-----------------------------+ | UE Reachability procedures | X | | +-----------------------------+-------+-----------------------------+
#### 6.1.1.3 Information flows
##### 6.1.1.3.1 Initial Attach procedure
The following diagram describes the information flow for the Initial Attach
procedure. Differences from the current E-UTRAN Initial Attach procedure are
shown in red.
Figure 6.1.1.3.1-1: Initial Attach procedure
1-2. Attach Request from UE to L-MME as specified in TS 23.401 [2] to MME.
3\. The L-MME requests the user context to the P-MME.
4-5. If the UE was previously attached to an IOPS Network, the P-MME obtains
the IMSI from its locally stored context for the GUTI provided by the UE.
Otherwise, the P-MME obtains the IMSI from the UE by performing Identity
Request/Response, as specified in TS 23.401 [2] for the MME, except that the
Identity Request/Response goes via the L-MME.
> 6\. P-MME performs Authentication Data Request/Response as required, as
> specified in TS 23.401 [2] for the MME.
7\. The P-MME provides the L-MME with context information for the UE,
including IMSI and security information.
8\. The L-MME authenticates the UE using the information received at step 7,
performs security association and obtains the IMEI.
9\. The L-MME queries the EIR via the P-MME.
10\. The L-MME may obtain ciphered options from the UE.
11\. The L-MME deletes any active bearer for the UE.
12\. The L-MME requests the UE\'s subscription data to the P-MME and confirms
to the P-MME that authentication was performed successfully.
13\. The P-MME sends an Update Location Request message to the HSS, unless the
UE was already registered in this P-MME. HSS responds and provides the
subscription data.
14\. The P-MME allocates a GUTI and sends it along with the UE\'s subscription
data to the L-MME.
15\. The L-MME sends a Create Session request to the L-GW located in the same
IOPS network. The L-GW performs the operations of both S-GW and P-GW for
creating the default bearer and returns a Create Session Response to the
L-MME.
16\. Attach Accept from L-MME to UE, as specified in TS 23.401 [2] from MME to
UE.
17\. Steps 18 to 26 of E-UTRAN Initial Attach procedure from TS 23.401 [2].
##### 6.1.1.3.2 UE triggered Service Request
Figure 6.1.1.3.2-1: UE triggered Service Request procedure
Editor\'s note: S-TMSI handling and how the Service Request is routed to the
L-MME is FFS.
### 6.1.2 Impacts on existing nodes and functionality
New functional entities L-MME and P-MME based on current MME.
New reference point S6a\' between L-MME and P-MME, based on S6a.
### 6.1.3 Solution evaluation
Editor\'s note: The security aspects of this solution need to be investigated
by SA WG3.
## 6.2 Solution 2: IOPS network using the backhaul only for authentication of
unknown UEs
### 6.2.1 Introduction and high-level architecture
This is a solution to Key Issue 1.
Figure 6.2.1-1: High-level control plane architecture for IOPS network using
the backhaul only for authentication of unknown UEs
The IOPS network comprises an L-MME (Local MME), which locally assumes the
functions of an MME (authentication, bearer management, etc.) and interacts
with the HSS of the PLMN. The L-AS is preconfigured by the AS of the public
safety organization with service-level information regarding the expected
users, UE identities and groups. When a UE attaches to the L-MME, the L-MME
needs to query the HSS via the limited backhaul link.
### 6.2.2 Information flows
#### 6.2.2.1 Initial Attach procedure, UE known in the IOPS network
UEs known is the IOPS network, i.e. IOPS-enabled UEs equipped with USIM
credentials of the PLMN which identity is broadcast by the IOPS network, are
handled according to Rel-13 IOPS (see TS 23.401 [2], Annex K), using the Local
HSS as defined in TS 33.401 [4], Annex F.
#### 6.2.2.2 Initial Attach procedure, UE not known in the IOPS network
The following diagram describes the information flow for the Initial Attach
procedure for UEs not known in the IOPS network.
Figure 6.2.2.2-1: High-level control plane architecture for IOPS network using
the backhaul only for authentication of unknown UEs
As a precondition, the macro AS preconfigures the L-AS with the relevant
information for the IOPS network. It may contain a list of users, UE
identities, and group associations. Further the local HSS of the IOPS network
is configured with the related IOPS subscriptions.
1\. The UE attaches to the IOPS eNB and includes its Identity.
2\. The eNB forwards the Attach request to the L-MME.
4\. The L-MME queries the HSS in the macro network with an Authentication
Request and the UE identity. The Authentication Request may contain an IOPS
indicator to distinguish the request from normal MME queries. Based on the
IOPS indicator the HSS is able to distinguish the request from a normal
authentication request and can select for the IOPS network the L-HSS ID n in
the relevant bits of the Authentication Management Field (AMF) for deriving
K_n in the UE.
NOTE: The details of the authentication via the external HSS are defined in SA
WG3.
5\. The HSS provides an authentication vector for the UE to the L-MME,
including K_n and indicating the selected L-HSS ID n in the AMF bits of the
AUTN.
6\. The L-MME updates and stores the authentication information. The L-MME
creates and Authentication Request towards the UE, including the RND and AUTN.
7\. The eNB forwards the Authentication Request to the UE.
8\. The UE may use a special IOPS USIM application and derives the AUTN, RES
as well as CK, IK for further key derivation.
9\. The UE sends and Authentication Response with the RES value to the eNB.
10\. The eNB forwards the Authentication Response with the RES value to the
L-MME
11\. The L-MME authenticates the UE by comparing the RES with the XRES and
normal Attach procedure is performed in the following.
### 6.2.2 Impacts on existing nodes and functionality
### 6.2.3 Solution evaluation
Editor\'s note: The security aspects of this solution need to be investigated
by SA WG3.
## 6.3 Solution 3: Limited backhaul for authentication only
### 6.3.1 Description
#### 6.3.1.1 Introduction and high-level architecture
This is a solution to Key Issue 1.
This solution is based on the concept described in TS 23.401 [2], Annex K
(informative): Isolated E-UTRAN Operation for Public Safety but also making it
possible to use a limited backhaul for authentication of UEs not having the
subscription in the local HSS. This makes it possible for IOPS-enabled UEs
equipped with USIM credentials of other IOPS PLMNs not handled by the Local
HSS to attach to the IOPS network i.e. a type of roaming functionality in the
IOPS network.
Based on these principles, the following architecture is proposed:
Figure 6.3.1.1-1: High-level architecture for IOPS network using the backhaul
for authentication only
With regards to Network Domain Security (see TS 33.210 [3]), the AAA Proxy/DRE
belongs to the security domain of the macro CN whereas the IOPS Network
(including the L-MME) does not. The solution for handling the authentication
between the IOPS network, AAA Proxy/DRE and the macro PLMNs to be determined
by SA WG3.
The IOPS Network uses a PLMN ID that is dedicated to IOPS mode of operation
and therefore different to the PLMN ID of the macro network. When operating in
IOPS mode, IOPS-enabled UEs only use the appropriate USIM credentials defined
in the UICC, i.e. those defined exclusively for use in an IOPS PLMN. A UE
moving between IOPS networks or between IOPS network and macro network will
make detach followed by an attach i.e. TAU or handover is not possible. The
reasons that mobility are not supported are due to the use of different USIM
credentials and that there is no user plane going in/out from the IOPS network
(PDN GW change)
#### 6.3.1.2 Information flows
##### 6.3.1.2.1 Initial Attach procedure
The following diagram describes the information flow for the Initial Attach
procedure.
Figure 6.3.1.2.1-1: Initial Attach procedure
The eNodeB, New MME, Serving GW and PDN GW in the above figure will be the
part of the IOPS network i.e. eNodeB, Local MME and Local GW. The HSS can be
either the Local HSS or an HSS in the macro network. PCRF is not valid in the
IOPS network.
1-2. Attach Request sent from UE to L-MME as specified in TS 23.401 [2].
3-4. The L-MME may send the Identification Request to L-MME in another IOPS
network over the limited backhaul were the UE has used the IOPS PLMN. If the
UE previously was attached to a macro PLMN not using the IOPS PLMN it will not
be useful to make an Identification Request as the UE is not having the same
IMSI in the IOPS network as used in the macro PLMN due to change of USIM.
> 5a. The L-MME sends the Authentication Request to the Local HSS if the UE
> has a subscription in the Local HSS. If the UE has no subscription in the
> Local HSS the local MME sends the Authentication request to a relevant
> external HSS in the macro network. For the case with an IOPS external HSS
> the same principles are used as for a roaming subscriber. In a non IOPS case
> with a roaming subscriber domain security is deployed between operator\'s
> networks and the same principles can be used in this solution. The security
> aspects of this handling needs to be investigated by SA WG3 and if a new
> reference point (S6a\') is needed.
>
> 5b. Local MME sends ME Identity Check over the limited backhaul to the
> relevant EIR..
8\. The L-MME sends an Update Location Request message to the Local HSS,
unless the UE was already registered in this L-MME. HSS responds and provides
the subscription data in step 11. If the UE subscription is not in the Local
HSS the L-MME sends the Update Location Request over the limited backhaul to a
HSS in a macro network.
12-16. The L-MME sends a Create Session request to the L-GW located in the
same IOPS network. The L-GW performs the operations of both S-GW and P-GW for
creating the default bearer and returns a Create Session Response to the
L-MME.
17-18. Attach Accept from L-MME to UE, as specified in TS 23.401 [2] from MME
to UE.
### 6.3.2 Impacts on existing nodes and functionality
New reference point S6a\' between L-MME and AAA Proxy/DRE, based on S6a.
### 6.3.3 Solution evaluation
Editor\'s note: The security aspects of this solution need to be investigated
by SA WG3.
## 6.x Solution x: Title
Editor\'s note: This clause will describe a candidate solution.
### 6.x.1 Description
### 6.x.2 Impacts on existing nodes and functionality
### 6.x.3 Solution evaluation
# 7 Overall evaluation
## 7.1 Overall evaluation for Key Issue #1
For Key Issue #1 three solutions are proposed in the TR:
**Solution 1: IOPS network using the backhaul for authentication only.**
This solution uses a new type of MME, called a Proxy MME (P-MME) which shall
be used for authentication and mobility. For the authentication the P-MME is
seen to be in the secure domain and contacts HSSs outside the IOPS area and
the IOPS network is seen as being an un-secure domain.\ Using the P-MME for
mobility is not valid as no mobility is possible if the UE moves from the IOPS
area to the macro area or between two IOPS areas as the connection to the PDN
GW/L-GW will be lost in all these cases. The result will be that the UE is
detached and will then perform an attach in the new area. This is also needed
to ensure that the right IOPS services are available through the right GWs.\
It is also specified that the GUTI for the UE is allocated by the P-MME. This
will make e.g. Periodic TAU and Service Request fail as the eNB in the IOPS
Area has no access to the P-MME. The eNB in the IOPS area has only access to
the L-MME and the L-MME must allocate the GUTI for the UE to make it work.
**Solution 2: IOPS network using the backhaul only for authentication of
unknown UEs.**
This solution uses external HSS for authentication of IOPS UEs not known in
the L-HSS but do not discuss any issue with secure domain (external HSS
access) and unsecure domain (IOPS network) as solution 1 and 3 are discussing.
This solution discuss the use of \"IOPS identifier\" and \"L-HSS ID\" which
needs to be resolved by SA WG3 for the case with IOPS limited backhaul.
**Solution 3: Limited backhaul for authentication only.**
This solution introduces the use of a AAA Proxy/DRE to resolve the issue with
the secure domain for the external HSSs and the IOPS network as seen as being
in an unsecure domain. No new procedures are needed and the Attach procedure
will handle the IOPS UEs not known in the IOPS area as roaming UEs.
**Summary**
Solution #1 introduces a new type of MME i.e. Proxy MME but the main issue
with this solution is the allocation of GUTI in the P-MME which will have the
result that e.g. periodic TAU and Service Request procedures will fail.
Solution #2 does not handle the question related to the secure/unsecure domain
but handles the details that needs to be resolved by SA WG3.
Solution #3 has the same principles as in solution #1 for authentication with
HSS and operates within a secure domain, but using a deployment solution i.e.
not a new type of MME as proposed in solution #1. Same as for solution #1 SA
WG3 security aspects of this solution need to be investigated by SA WG3 and a
new S6a\' may be needed. Not new procedures or normative work is needed.
## 7.2 Overall evaluation of Key Issue #2
No solutions for Key Issue #2 is proposed in the TR and it can be questioned
if any solutions are needed as the existing solutions in Annex K in TS 23.401
[2] can be used.
For the case the IOPS network goes from limited backhaul to full isolation all
UEs needs to have or have to switch to subscriptions configured in the local
HSS i.e. same as described in Annex K in TS 23.401 [2].
For the case the IOPS network goes from fully isolated to limited backhaul,
IOPS UEs not known in the IOPS network can be used but no specific procedures
are needed.
# 8 Conclusions
## 8.1 Conclusion for Key Issue #1
It is concluded that the solution for Key Issue #1 shall be based on solution
#3 in clause 6.3. The solution will be captured as a deployment solution and
integrated in Annex K in TS 23.401 [2]. SA WG3 may need to evaluate further
capabilities for meeting the security requirements for authentication via
external HSS and domain security.
## 8.2 Conclusion for Key Issue #2
No new solutions are needed for Key Issue #2.
#