# Foreword
The present document has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the stage 2 description of the Multiple
Subscriber Profile (MSP) Supplementary Service Phase 2. MSP Phase 2 is
implemented using CAMEL Phase 3.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \" 3G Vocabulary\".
[2] 3GPP TS 22.030: \" Man Machine Interface (MMI) of the Mobile Station
(MS)\".
[3] 3GPP TS 22.097: \" Multiple Subscriber Profile (MSP) Service Description
-- Stage 1\".
[4] 3GPP TS 23.008: \"Organisation of subscriber data\".
[5] 3GPP TS 23.015: \"Technical realization of Operator Determined Barring
(ODB)\".
[6] 3GPP TS 23.018: \"Basic Call Handling -- Technical Realization\".
[7] 3GPP TS 23.067: \"enhanced Multi-Level Precedence and Pre-emption service
(eMLPP) -- Stage 2\".
[8] 3GPP TS 23.072: \"Call Deflection (CD); Stage 2\".
[9] 3GPP TS 23.078: \"Customised Applications for Mobile network Enhanced
Logic (CAMEL) -- Phase 3; Stage 2\".
[10] 3GPP TS 23.079: \"Support of Optimal Routeing (SOR); Technical
Realisation\".
[11] 3GPP TS 23.081: \"Line identification supplementary services -- Stage
2\".
[12] 3GPP TS 23.082: \"Call Forwarding (CF) supplementary services -- Stage
2\".
[13] 3GPP TS 23.083: \"Call Waiting (CW) and Call Hold (HOLD) supplementary
services -- Stage 2\".
[14] 3GPP TS 23.084: \"Multi Party (MPTY) supplementary services -- Stage 2\".
[15] 3GPP TS 23.085: \"Closed User Group (CUG) supplementary services \--
Stage 2\".
[16] 3GPP TS 23.086: \"Advice of Charge (AoC) supplementary services \-- Stage
2\".
[17] 3GPP TS 23.087: \"User-to-User (UUS) Supplementary Service; Stage 2\".
[18] 3GPP TS 23.088: \"Call Barring (CB) supplementary services -- Stage 2\".
[19] 3GPP TS 23.090: \"Unstructured Supplementary Service Data (USSD) \--
Stage 2\".
[20] 3GPP TS 23.091: \"Explicit Call Transfer (ECT) supplementary service --
Stage 2\".
[21] 3GPP TS 23.093: \"Technical Realization of Completion of Calls to Busy
Subscriber (CCBS); Stage 2\".
[22] 3GPP TS 24.086: \"Advice of Charge (AoC) supplementary services \-- Stage
3\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purpose of this specification, the following terms and definitions
apply:
**Default Profile:** profile used when the MSP subscriber roams to a non-
supporting network.
**MSP Subscriber:** the subscriber provisioned with the MSP service
**Profile Identity:** numerical identity (between 1 and 4) of the profile
**Profile Status** : specifies if the profile is the registered profile and/or
the default profile
**Registered Profile:** profile used for all MO calls and short messages if a
profile has not been explicitly selected
## 3.2 Abbreviations
The abbreviations used in this specification are listed in 3G TR21.905.
For the purpose of this specification, the following abbreviations apply:
CD The Call Deflection supplementary service
MSP The Multiple Subscriber Profile supplementary service
UUS The User-to-User Signalling supplementary service
SII2 The Service Interaction Indicators Two parameter (see 3G TS 23.078)
# 4 Features needed to support MSP Phase 2
CAMEL Phase 3 is a pre-requisite for MSP Phase 2.
The following CAMEL Phase 3 features are used for MSP Phase 2:
\- SII2;
\- MO SMS interaction;
\- T-BCSM in the VMSC;
\- SS-CSI Invocation Notification for CCBS;
\- Any Time Modification;
\- CUG Handling.
The following CAMEL Phase 2 features are used for MSP Phase 2:
\- Network Indication of Alerting pattern;
\- Event detection points;
\- USSD Interaction;
\- Control of Call Duration;
\- SS-CSI Invocation Notification for CD;
\- Furnish Charging Information.
# 5 Additional Information stored in network entities
## 5.1 Data stored in the HLR
The HLR contains all the common data (the data valid for all profiles) and
some data specific to the default profile.
The data stored in the HLR are defined in 3G TS 23.008. The elements
specifically used for MSP are:
\- list of MSISDNs and associated Bearer Capabilities for each profile;
\- default profile (associated with the Basic MSISDN);
\- capabilities of VLR (support of CAMEL Phase 2 and 3);
\- supplementary services (per BSG) provisioned per subscriber (CW, CH,
MPTY,...);
\- Call Barring Data (see subclause 7.6.8: Call Barring);
\- ODB Data (see subclause 7.7.5: Operator Determined Barring);
\- HOLD Data (see subclause 7.8.2: Call Hold);
\- ECT Data (see subclause 7.8.9: Explicit Call Transfer);
\- MPTY Data (see subclause 7.8.5: Multi Party);
\- CCBS Data (see subclause 7.8.10: Completion of Calls to Busy Subscriber);
\- CW Data (see subclause 7.8.3: Call Waiting);
\- CLIR Data (see subclause 7.8.1.2);
\- CAMEL data including the MSP service key, O-CSI, T-CSI, VT-CSI, UG-CSI, SS-
CSI and Location information / Subscriber state Interrogation.
## 5.2 Data stored in the VLR
The data stored in a VLR are defined in 3G TS 23.008. MSP has no impact on the
VLR.
# 6 Additional procedures in network entities
## 6.1 OCB_flag
The OCB_flag shall be set in the HLR if Call Barrings are provided in the
gsmSCF.
If the OCB_flag is set then:
\- when the subscriber roams to a VLR which supports CAMEL Phase 2 or later,
the HLR shall not send any outgoing call barring supplementary services data
to the VLR;
\- when the subscriber roams to a VLR which does not support CAMEL Phase 2 or
later, the HLR shall send to the VLR outgoing call barring supplementary
services data as stored in the HLR;
\- the subscriber shall not be allowed to alter the Call Barring data in the
HLR.
## 6.2 ODB flags
The ODB flag for the relevant category shall be set in the HLR if ODB is
provisioned in the gsmSCF for that category.
If the ODB flag is set for that category, then:
when the subscriber roams to a VLR which supports CAMEL Phase 2 or later, the
HLR shall not send any ODB data for that category to the VLR;
when the subscriber roams to a VLR which does not support CAMEL Phase 2 or
later, the HLR shall send to the VLR ODB data for that category as stored in
the HLR.
## 6.3 HOLD_flag
The HOLD_flag shall be set in the HLR if the subscriber data for the HOLD SS
are controlled by the gsmSCF.
If the HOLD_flag is set, then:
\- when the subscriber roams to a VLR which supports CAMEL Phase 3 or later,
the HLR shall send to the VLR the activation state of the HOLD SS as Active
and Operative;
\- when the subscriber roams to a VLR which does not support CAMEL Phase 3 or
later, the HLR shall send to the VLR the activation state of the HOLD SS as
stored in the HLR.
## 6.4 CW_flag
The CW_flag shall be set in the HLR if the subscriber data for the CW SS are
controlled by the gsmSCF.
If the CW_flag is set, then:
\- when the subscriber roams to a VLR which supports CAMEL Phase 3 or later,
the HLR shall send to the VLR the activation state of the CW SS as Active and
Operative;
\- when the subscriber roams to a VLR which does not support CAMEL Phase 3 or
later, the HLR shall send to the VLR the activation state of the CW SS as
stored in the HLR;
\- the subscriber shall not be allowed to alter the CW data in the HLR.
## 6.5 MPTY_flag
The MPTY_flag shall be set in the HLR if the subscriber data for the MPTY SS
are controlled by the gsmSCF.
If the MPTY_flag is set, then:
\- when the subscriber roams to a VLR which supports CAMEL Phase 3 or later,
the HLR shall send to the VLR the activation state of the MPTY SS as Active
and Operative;
\- when the subscriber roams to a VLR which does not support CAMEL Phase 3 or
later, the HLR shall send to the VLR the activation state of the MPTY SS as
stored in the HLR.
## 6.6 ECT_flag
The ECT_flag shall be set in the HLR if the subscriber data for the ECT SS are
controlled by the gsmSCF.
If the ECT_flag is set, then:
\- when the subscriber roams to a VLR which supports CAMEL Phase 3 or later,
the HLR shall send to the VLR the activation state of the ECT SS as Active and
Operative;
\- when the subscriber roams to a VLR which does not support CAMEL Phase 3 or
later, the HLR shall send to the VLR the activation state of the ECT SS as
stored in the HLR.
## 6.7 CCBS_flag
The CCBS_flag shall be set in the HLR if the subscriber data for the CCBS SS
are controlled by the gsmSCF.
If the CCBS_flag is set, then:
\- when the subscriber roams to a VLR which supports CAMEL Phase 3 or later,
the HLR shall send to the VLR the activation state of the CCBS SS as Active
and Operative;
\- when the subscriber roams to a VLR which does not support CAMEL Phase 3 or
later, the HLR shall send to the VLR the activation state of the CCBS SS as
stored in the HLR;
\- the subscriber shall not be allowed to alter the CCBS data in the HLR.
## 6.8 CLIR_flag
The CLIR_flag shall be set in the HLR if the subscriber data for the CLIR SS
are controlled by the gsmSCF.
If the CLIR_flag is set, then:
\- when the subscriber roams to a VLR which supports CAMEL Phase 3 or later,
the HLR shall send to the VLR the activation state of the CLIR SS as Active
and Operative, and the presentation mode as \"temporary (presentation
allowed)\";
\- when the subscriber roams to a VLR which does not support CAMEL Phase 3 or
later, the HLRshall send to the VLR the activation state and presentation mode
for the CLIR SS as stored in the HLR;
\- the subscriber shall not be allowed to alter the CLIR data in the HLR.
# 7 Description of Multiple Subscriber Profile
## 7.1 Overview
The MSP service allows the served subscriber to have several profiles, to
distinguish between different telecommunication service requirements (e.g.
business and home). This is described in 3G TS 22.097. Subscriber data
specific to MSP is stored in the HLR and the gsmSCF.
## 7.2 Registration of a Profile
Registration of a profile allows the subscriber to register a provisioned
profile to be used for mobile originated calls and activities. The request to
register a profile shall contain the MSP code and the profile identity and
will be sent to the gsmSCF using USSD, see 3G TS 23.078 and 3G TS 23.090. The
registered profile is stored in the gsmSCF. In response to a successful
registration request, the gsmSCF shall return a positive acknowledgement,
including the identity of the registered profile, using USSD.
The registration process in the gsmSCF is shown in figure 2. The information
flow for successfully registering a profile is shown in figure 1.
Figure 1: Registration Process: information flow
Figure 2: Process Register_MSP_gsmSCF
## 7.3 Interrogation
The MS can interrogate MSP, using USSD, to identify which profiles are
provisioned and which of the provisioned profiles is the currently registered
profile. The interrogate MSP operation shall contain the MSP code and will be
sent to the gsmSCF using USSD. In response to a successful interrogation
request, the gsmSCF shall return the profile identity and profile status for
each provisioned profile. If the MSP service is not provisioned then the
gsmSCF shall return the service status indicating not provisioned.
The interrogation process is shown in figure 4. The information flow for
interrogation of MSP is shown in figure 3.
Figure 3: Interrogating MSP: information flow
{width="6.691666666666666in" height="8.09375in"}
Figure 4: Process Interrogate_MSP_gsmSCF
## 7.4 Call Handling for an MSP subscriber
The procedure for handling MSP calls can be divided into two areas: mobile
originating call handling and mobile terminating call handling.
### 7.4.1 Mobile Originating (MO) call handling
The served subscriber may use the registered profile or explicitly select a
provisioned profile to set up an MO call. If the profile is explicitly
selected, the selection information will be included in the called party BCD
number and transported to the gsmSCF. If the gsmSCF recognises that a profile
has not been explicitly selected (there is no profile selection information in
the called party BCD number) then the registered profile is used. The MMI for
explicitly selecting a profile is defined in 3G TS 22.030.
The information flow for an MO call is shown in figure 28.
When the gsmSCF receives an Initial_DP message containing MO call parameters
from the gsmSSF, the process MO_MSP_Call_gsmSCF will be invoked, see figure 5.
All other call handling is described in 3G TS 23.018 and 3G TS 23.078.
### 7.4.2 Mobile Terminating (MT) call handling
The profile used for an MT call to the served subscriber is determined by the
called MSISDN.
The information flow for an MT call is shown in figure 29.
When the gsmSCF receives an Initial_DP message containing MT call parameters
from the gsmSSF, the process MT_MSP_Call_gsmSCF will be invoked, see figure 8.
All other call handling is described in 3G TS 23.018 and 3G TS 23.078.
## 7.5 Functions and Information Flows
### 7.5.1 MO call handling in the gsmSCF
#### 7.5.1.1 Process MO_MSP_Call_gsmSCF
Handles an MO call for an MSP subscriber. See figure 5.
#### 7.5.1.2 Procedure Set_Calling_Profile_gsmSCF
Sets the correct parameters for the calling profile. See figure 6.
#### 7.5.1.3 Procedure Send_FCI_gsmSCF
Sends a Furnish Charging Information message to the gsmSSF. See figure 7.
{width="6.691666666666666in" height="8.09375in"}
Figure 5a: Process MO_MSP_Call_gsmSCF (sheet 1 of 4)
{width="6.691666666666666in" height="8.09375in"}
Figure 5b: Process MO_MSP_Call_gsmSCF (sheet 2 of 4)
{width="6.691666666666666in" height="8.09375in"}
Figure 5c: Process MO_MSP_Call_gsmSCF (sheet 3 of 4)
{width="6.691666666666666in" height="8.09375in"}
Figure 5d: Process MO_MSP_Call_gsmSCF (sheet 4 of 4)
{width="6.691666666666666in" height="8.09375in"}
Figure 6: Procedure Set_Calling_Profile_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 7: Procedure Send_FCI_gsmSCF
### 7.5.2 MT call handling in the gsmSCF
#### 7.5.2.1 Process MT_MSP_Call_gsmSCF
Handles an MT call for an MSP subscriber. See figure 8.
{width="6.691666666666666in" height="8.09375in"}
Figure 8a: Process MT_MSP_Call_gsmSCF (sheet 1 of 5)
{width="6.691666666666666in" height="8.09375in"}
Figure 8b: Process MT_MSP_Call_gsmSCF (sheet 2 of 5)
{width="6.691666666666666in" height="8.09375in"}
Figure 8c: Process MT_MSP_Call_gsmSCF (sheet 3 of 5)
{width="6.691666666666666in" height="8.09375in"}
Figure 8d: Process MT_MSP_Call_gsmSCF (sheet 4 of 5)
{width="6.691666666666666in" height="8.09375in"}
Figure 8e: Process MT_MSP_Call_gsmSCF (sheet 5 of 5)
### 7.5.3 SS handling in the gsmSCF
#### 7.5.3.1 Procedure Check_CLIR_gsmSCF
Checks whether the CLI Presentation Indicator shall be set to Presentation
Restricted. See figure 9.
#### 7.5.3.2 Procedure Forwarded_MSP_Call_gsmSCF
Sets the parameters for a forwarded or deflected call. See figure 10.
#### 7.5.3.3 Procedure Check_CFU_gsmSCF
Applies CFU to the MT Call if Active and Operative for the Called profile. See
figure 11.
#### 7.5.3.4 Procedure Check_Early_CF_gsmSCF
Checks whether any early Call Forwarding apply to the Called profile. See
figure 12
#### 7.5.3.5 Procedure Check_Late_CF_gsmSCF
Arms the detection points required for the provisioned late Call Forwardings
on the Called profile. See figure 13.
#### 7.5.3.6 Procedure Check_CFNRy_gsmSCF
Applies CFNRy to the MT call if Active and Operative for the Called profile.
See figure 14.
#### 7.5.3.7 Procedure Check_CFB_gsmSCF
Applies CFB to the MT call if Active and Operative for the Called profile. See
figure 15.
#### 7.5.3.8 Procedure Check_CFNRc_gsmSCF
Applies CFNRc to the MT call if Active and Operative for the Called profile.
See figure 16.
#### 7.5.3.9 Procedure Check_CW_gsmSCF
Checks whether CW is allowed during the current call. See figure 17.
#### 7.5.3.10 Procedure Check_HOLD_gsmSCF
Checks whether a HOLD request shall be accepted or rejected during the ongoing
call. See figure 18.
#### 7.5.3.11 Procedure Check_MPTY_gsmSCF
Checks whether an MPTY request shallbe accepted or rejected during the ongoing
call. See figure 19.
#### 7.5.3.12 Procedure Check_ACM_gsmSCF
Ensures that ACMmax is not exceeded for the profile in use. See figure 20.
#### 7.5.3.13 Process AoC_MSP_gsmSCF
Applies AoC per profile. See figure 21.
#### 7.5.3.14 Procedure AoCI_gsmSCF
Applies AoCI per profile. See figure 22.
#### 7.5.3.15 Procedure AoCC_gsmSCF
Applies AoCC per profile. See figure 23.
#### 7.5.3.16 Procedure Outgoing_Barring_Check_gsmSCF
Checks the outgoing call barrings for an MSP subscriber. See figure 24.
#### 7.5.3.17 Procedure Incoming_Barring_Check_gsmSCF
Checks the incoming barrings for the Called profile. See figure 25.
#### 7.5.3.18 Procedure Check_ECT_gsmSCF
Checks whether an ECT request shall be accepted or rejected during the ongoing
call. See figure 26.
#### 7.5.3.19 Procedure Check_CCBS_gsmSCF
Checks whether a CCBS request can be planted by/against the MSP subscriber.
See figure 27.
{width="6.691666666666666in" height="8.09375in"}
Figure 9: Procedure Check_CLIR_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 10: Procedure Forwarded_MSP_Call_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 11: Procedure Check_CFU_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 12: Procedure Check_Early_CF_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 13: Procedure Check_Late_CF_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 14: Procedure Check_CFNRy_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 15: Procedure Check_CFB_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 16: Procedure Check_CFNRc_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 17: Procedure Check_CW_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 18: Procedure Check_HOLD_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 19: Procedure Check_MPTY_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 20: Procedure Check_ACM_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 21: Process AoC_MSP_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 22: Procedure AoCI_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 23: Procedure AoCC_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 24: Procedure Outgoing_Barring_Check_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 25: Procedure Incoming_Barring_Check_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 26: Procedure Check_ECT_gsmSCF
{width="6.691666666666666in" height="8.09375in"}
Figure 27: Procedure Check_CCBS_gsmSCF
### 7.5.4 Information flows
The information flow for a successful MO call by an MSP subscriber is shown in
figure 28.
The information flow for a successful MT call to an MSP subscriber is shown in
figure 29.
Figure 28: Information flow for a successful MO call
Figure 29: Information flow for a successful MT call to a profile\ that has no
Call Forwardings Active and Operative in the gsmSCF
NOTE: For information flows to a profile that has Call Forwarding services
Active and Operative in the gsmSCF, see subclause7.11.1: Call Forwarding.
## 7.6 SMS handling
MSP Phase 2 does not apply to MT short messages. The MSP subscriber will
receive MT short messages but no profile indication will be given.
When the gsmSCF receives an Initial SMS Event message from the gsmSSF, the
process MO_MSP_SMS_gsmSCF will be invoked, see figure 30.
{width="6.691666666666666in" height="8.269444444444444in"}
Figure 30a: Process MO_MSP_SMS_gsmSCF (sheet 1 of 2)
{width="6.691666666666666in" height="8.09375in"}
Figure 30b: Process MO_MSP_SMS_gsmSCF (sheet 2 of 2)
## 7.7 Call Independent SS handling
Supplementary Services provisioned per subscriber will be handled in the usual
way.
Supplementary Services provisioned per profile will be controlled using USSD,
sent via the VLR and HLR to the gsmSCF.
If Call Barring is provisioned per profile, if the outgoing call barring data
for the default profile is changed, the HLR shall be informed using Any Time
Modification. On receipt of an Any Time Modification message from the gsmSCF
for a subscriber with the OCB_flag set, the HLR will modify the stored Call
Barring information for the default profile in accordance with the information
in the Any Time Modification message.
## 7.8 Interaction with Supplementary Services
### 7.8.1 Line Identification services
#### 7.8.1.1 CLIP
No interaction.
#### 7.8.1.2 CLIR
CLIR can be provisioned per subscriber or per profile.
If CLIR is provisioned per subscriber and CLIR is active, it will be active
for all profiles. Data for the CLIR Supplementary Service will be stored in
the HLR, and if appropriate in the VLR, in the usual manner. CLIR will
function as specified in 3G TS 23.081 and will not distinguish between MSP and
non-MSP subscribers.
If CLIR is provisioned per profile then the CLIR_flag shall be set in the HLR
(see subclause 6.8: CLIR_flag) and the CLIR subscription information for the
default profile shall be stored in the HLR in the usual manner. For an MO
call, if the CLIR subscription information for the Calling profile indicates
that the CLI shall be restricted, the gsmSCF shall set the Calling Party
Presentation Indicator to Presentation Restricted in the SII2 parameter.
#### 7.8.1.3 COLP
No interaction.
#### 7.8.1.4 COLR
No interaction.
### 7.8.2 Call Hold (HOLD)
Call Hold can be provisioned per subscriber or per profile.
If Call Hold is provisioned per subscriber and Call Hold is active, it will be
active for all profiles. Data for the Call Hold Supplementary Service will be
stored in the HLR, and if appropriate in the VLR, in the usual manner. Call
Hold will function as specified in 3G TS 23.083 and will not distinguish
between MSP and non-MSP subscribers.
If Call Hold is provisioned per profile then the HOLD_flag shall be set in the
HLR (see subclause 6.3: HOLD_flag). On receipt of an Initial_DP message for an
MO or MT call, the gsmSCF will check the subscription information for the
profile in use for that call. If HOLD is not active and operative, then the
SII2 will be included in the Connect message with the HOLD Treatment Indicator
set to Reject HOLD Request.
### 7.8.3 Call Waiting (CW)
Call Waiting can be provisioned per subscriber or per profile.
If Call Waiting is provisioned per subscriber and Call Waiting is active, it
will be active for all profiles. Data for the Call Waiting Supplementary
Service will be stored in the HLR, and if appropriate in the VLR, in the usual
manner. Call Waiting will function as specified in 3G TS 23.083 and will not
distinguish between MSP and non-MSP subscribers.
If Call Waiting is provisioned per profile then the CW_flag shall be set in
the HLR (see subclause 6.4: CW_flag). On receipt of an Initial_DP message for
an MO or MT call, the gsmSCF will check the subscription information for the
profile in use for that call. If Call Waiting is not active and operative,
then the SII2 will be included in the Connect message with the CW Treatment
Indicator set to CW Not Allowed. The subscriber shall be able to modify CW
information per profile by making contact with the gsmSCF using USSD. However,
the subscriber shall not be able to modify CW data for the default profile.
### 7.8.4 Call Forwarding
The Call Forwarding Supplementary Services, described in 3G TS 23.082, can
only be provisioned per subscriber. However, services equivalent to the Call
Forwarding Supplementary Services, implemented in the gsmSCF, will be
available to the MSP subscriber per profile. This is described in subclause
7.11.1: Call Forwarding.
If the Call Forwarding Supplementary Services are provisioned per subscriber,
then Call Forwarding will function as specified in 3G TS 23.082 and will not
distinguish between MSP and non-MSP subscribers.
NOTE 1: If Call Forwarding is provisioned per subscriber in the HLR then Call
Forwarding should not be provisioned per profile in the gsmSCF, as this may
cause unpredictable behaviour.
NOTE 2: If Call Forwarding is provisioned per subscriber in the HLR then Call
Deflection should not be provisioned per profile in the gsmSCF, as this may
cause unpredictable behaviour.
### 7.8.5 Multi Party Service (MPTY)
The Multi Party Supplementary Service can be provisioned per subscriber or per
profile.
If MPTY is provisioned per subscriber and MPTY is active, it will be active
for all profiles. Data for the MPTY Supplementary Service will be stored in
the HLR, and if appropriate in the VLR, in the usual manner. MPTY will
function as specified in 3G TS 23.084 and will not distinguish between MSP and
non-MSP subscribers.
If MPTY is provisioned per profile then the MPTY_flag shall be set in the HLR
(see subclause 6.5: MPTY_flag). On receipt of an Initial_DP message for an MO
or MT call, the gsmSCF will check the subscription information for the profile
in use for that call. If MPTY is not active and operative, then the SII2 will
be included in the Connect message with the Conference Treatment Indicator set
to Reject Conference Request.
### 7.8.6 Closed User Group (CUG)
The Closed User Group Supplementary Service can be provisioned per subscriber
or per profile.
If CUG is provisioned per subscriber and CUG is active, it will be active for
all profiles. Data for the CUG Supplementary Service will be stored in the
HLR, and if appropriate in the VLR, in the usual manner. CUG will function as
specified in 3G TS 23.085 and will not distinguish between MSP and non-MSP
subscribers. The interaction between CAMEL and CUG is defined in 3G TS 23.078.
CUG provisioning per profile is supported by CAMEL Phase 3 and is FFS.
### 7.8.7 Advice of Charge (AoC)
The Advice of Charge Supplementary Service can be provisioned per subscriber.
However, services equivalent to the Advice of Charge supplementary services,
implemented in the gsmSCF, will be available to the MSP subscriber per
profile. This is described in subclause 7.11.4: Advice of Charge (AoC).
Signalling on the access interface will be as specified in 3G TS 24.086.
If AoC is active, it will be active for all profiles. Data for the AoC
Supplementary Service will be stored in the HLR, and if appropriate in the
VLR, in the usual manner. AoC will function as specified in 3G TS 23.086 and
will not distinguish between MSP and non-MSP subscribers.
### 7.8.8 Call Barring
The Call Barring Supplementary Services, described in 3G TS 23.088, can only
be provisioned per subscriber. However, services equivalent to the Call
Barring Supplementary Services, implemented in the gsmSCF, can be provided to
the MSP subscriber per profile. This is described in subclause 7.11.2: Call
Barring. This requires the OCB_flag mechanism described in section subclause
6.1: OCB_flag.
### 7.8.9 Explicit Call Transfer (ECT)
The Explicit Call Transfer supplementary service can be provisioned per
subscriber or per profile.
If ECT is provisioned per subscriber and ECT is active, it will be active for
all profiles. Data for the ECT Supplementary Service will be stored in the
HLR, and if appropriate in the VLR, in the usual manner. ECT will function as
specified in 3G TS 23.091 and will not distinguish between MSP and non-MSP
subscribers.
If ECT is provisioned per profile then the ECT_flag shall be set in the HLR
(see subclause 6.6: ECT_flag). On receipt of an Initial_DP message for an MO
or MT call, the gsmSCF will check the subscription information for the profile
in use for that call leg. If ECT is not active and operative, then the SII2
will be included in the Connect message with the ECT Treatment Indicator set
to Reject ECT Request.
### 7.8.10 Completion of Calls to Busy Subscriber (CCBS)
CCBS can be provisioned per subscriber or per profile.
If CCBS is provisioned per subscriber and CCBS is active, it will be active
over all profiles. Data for the CCBS Supplementary Service will be stored in
the HLR, and if appropriate in the VLR, in the usual manner.
If CCBS is provisioned per profile then the CCBS_flag shall be set in the HLR
(see subclause 6.7: CCBS_flag).
On receipt of an Initial_DP message for an MO call, the gsmSCF will check the
subscription information for the calling profile. If CCBS is not active and
operative, then the SII2 will be included in the Connect message with the Call
Completion Treatment Indicator set to Call Completion Not Allowed.
On receipt of an Initial_DP message for an MT call, the gsmSCF will check the
subscription information for the called profile. If CCBS is not active and
operative, then the SII2 will be included in the Connect message with the Call
Completion Treatment Indicator sent to Call Completion not allowed.
The subscriber shall be able to modify CCBS information per profile by making
contact with the gsmSCF using USSD. However, the subscriber shall not be able
to modify CCBS data for the default profile.
If a CFU-equivalent service is activated while there are queue entries in
MS-B\'s target queue, HLR-B will not know about this activation and will
process these queue entries as normal. As a consequence, the CCBS calls
related to these queue entries will be forwarded to the new destination. CCBS
activation is not possible if this forwarded call meets NDUB. This results in
expiry of recall timer T9 and deletion of the queue entry from MS-B\'s target
queue. For further details on the interaction between CCBS and CAMEL, refer to
3G TS 23.093.
The same applies to Incoming Call Barring-equivalent services which are
activated while there are queue entries in MS-B\'s target queue.
An MSP subscriber will have CCBS set in the SS-CSI. The gsmSCF will be
informed of CCBS Request and CCBS Setup messages for the MSP subscriber. This
allows the service logic in the gsmSCF to assign the correct profile to the
CCBS call.
### 7.8.11 enhanced Multi-Level Precedence and Pre-emption (eMLPP)
eMLPP will be provisioned per subscriber. If eMLPP is active, it will be
active for all profiles. Data for the eMLPP Supplementary Service will be
stored in the HLR, and if appropriate in the VLR, in the usual manner. eMLPP
will function as specified in 3G TS 23.067 and will not distinguish between
MSP and non-MSP subscribers.
### 7.8.12 User-to-User Signalling (UUS)
The User-to-User Supplementary Service will be provisioned per subscriber. If
UUS is active, it will be active for all profiles. Data for the UUS
Supplementary Service will be stored in the HLR, and if appropriate in the
VLR, in the usual manner. UUS will function as specified in 3G TS 23.087 and
will not distinguish between MSP and non-MSP subscribers.
### 7.8.13 Call Deflection (CD)
The Call Deflection Supplementary Service will be provisioned per subscriber.
If CD is active, it will be active for all profiles. Data for the CD
Supplementary Service will be stored in the HLR, and if appropriate in the
VLR, in the usual manner. CD will function as specified in 3G TS 23.072 and
will not distinguish between MSP and non-MSP subscribers.
When the MSP subscriber deflects an MT call, it triggers an interrogation of
the gsmSCF for an MO Call. Using the call reference number, the gsmSCF can
recognise that there is an ongoing dialogue for the MT call, and can then
retrieve the profile to apply for the deflected call.
This gives the gsmSCF the opportunity to reject the call deflection per
profile, providing the MSP subscriber is in a supporting network.
NOTE: Call Deflection should not be provisioned per profile if Call
Forwardings are provisioned per subscriber in the HLR as unpredictable
behaviour may occur.
## 7.9 Interaction with other services
### 7.9.1 The Multi-Numbering Scheme
If the MSP subscriber has different MSISDNs allocated for different Basic
Services, all MSISDNs and associated Basic Services will be stored in the HLR.
Each MSISDN and associated Basic Services will also be stored in the gsmSCF
with associated profile ID.
### 7.9.2 The Short Message Service
Mobile terminated short messages can be received on any profile although the
profile will not be indicated to the user.
It shall be possible to select a profile for mobile originated short messages.
If a profile is explicitly selected, the MO short message will be sent by and
charged to the selected profile. If a profile is not explicitly selected, the
MO short message will be sent by and charged to the registered profile.
### 7.9.3 Interactions with CAMEL
An MSP subscriber will, by definition, have a CAMEL subscription.
If other CAMEL services are designed in such a way that an MSP subscriber can
use them, they will be available to the MSP subscriber. It is a network option
to design CAMEL services that interact with MSP.
### 7.9.4 Interactions with OR
The GMSC in the Interrogating PLMN (IPLMN) needs to support CAMEL Phase 2
capability if the called subscriber is an MSP subscriber.
If an interrogation request is received for an MSP subscriber from a GMSC in
the IPLMN that does not support the CAMEL Phase 2 capability, the HLR shall
return an OR not allowed negative response (see 3G TS 23.079) to the GMSC.
This will force the call to be routed to a GMSC supporting CAMEL Phase 2
capabilitity in the HPLMN.
### 7.9.5 Operator Determined Barring
ODB, as described in 3G TS 23.015, can only be provisioned per subscriber.
A service, implemented in the gsmSCF equivalent to the ODB service will be
available for an MSP subscriber per profile. This is described in subclause
7.11.3: Operator Determined Barring (ODB); it requires the mechanism described
in subclause 6.2: ODB flags..
Outgoing ODB for the default profile will be stored in the HLR for use when
the subscriber roams into a non-supporting network, see subclause 7.11.3:
Roaming into a network not supporting CAMEL Phase 2 for further details.
### 7.9.6 Roaming Restrictions
Roaming Restrictions will apply per subscriber. Data for the Roaming
Restrictions will be stored in the HLR in the usual manner.
## 7.10 Data stored in the gsmSCF
The gsmSCF contains all the data needed to control the MSP service. These data
can be divided into the common data (the data valid for all profiles) and the
profile specific data.
{width="3.0729166666666665in" height="8.21875in"}
## 7.11 Equivalent services implemented by the gsmSCF
### 7.11.1 Call Forwarding
Call Forwarding services will be provided in the gsmSCF per profile. An MT
call to an MSP subscriber will be subject to the provided call forwardings for
the called profile.
The Call Forwarding services, implemented by the gsmSCF, should operate in the
same way as the Call Forwarding Supplementary Services. The MSP subscriber
should have control over the call forwarding data (Registration, Erasure,
Activation, Deactivation, and Interrogation). The method for controlling this
data is a network option.
Figure 31: Information flow for a successful MT call to a profile\ with some
Call Forwardings Active and Operative
NOTE: Request_Report_BCSM_Event will contain the list Arm_DP_List (see figure
1). This list will contain the following elements:\ T_Answer EDP-N\ T_Abandon
EDP-N\ T_Busy EDP-N (Unless CFB and/or CFNRc are A&O for the called profile,
in which case EDP-R)\ T_No_Answer EDP-N (Unless CFNRy is A&O for the called
profile, in which case EDP-R)
#### 7.11.1.1 Call Forward Unconditional
{width="5.104861111111111in" height="4.085416666666666in"}
Figure 32: Information flow for an MT call to a profile with CFU active\ and
operative in the gsmSCF
#### 7.11.1.2 Call Forward on Busy
{width="6.052777777777778in" height="3.4895833333333335in"}
Figure 33: Information flow for an MT call to a profile with CFB active\ and
operative in the gsmSCF, where the called subscriber is NDUB or UDUB
#### 7.11.1.3 Call Forward on No Reply
{width="6.479861111111111in" height="4.523611111111111in"}
Figure 34: Information flow for an MT call to a profile with CFNRy active\ and
operative in the gsmSCF, where the called party does not answer
NOTE: The timer TNRy is started in the GMSC after the Address Complete Message
has been received from the destination exchange. If this timer expires before
an Answer message is received from the destination exchange, a release message
is sent to the destination exchange and the detection point T_No_Answer is
reached. This is specified in 3G TS 23.018 and 3G TS 23.078.
#### 7.11.1.4 Call Forward on Not Reachable
#### 7.11.1.5 Early CFNRc
Early Call Forwarding on Not Reachable will apply if the gsmSCF receives the
parameter \"subscriber state\" set as Not Reachable. Due to the presence of
the Location information / Subscriber state Interrogation parameter in the
CAMEL data, stored in the HLR, the HLR sends a Provide Subscriber Information
message to the VLR. This determines if the subscriber state is Not Reachable.
{width="6.490277777777778in" height="6.188888888888889in"}
Figure 35: Information flow for an MT call to a profile with CFNRc active\ and
operative in the gsmSCF, where early CFNRc is invoked
#### 7.11.1.6 Late CFNRc
Figure 36: Information flow for an MT call to a profile with CFNRc active\ and
operative in the gsmSCF, where late CFNRc is invoked
### 7.11.2 Call Barring
Call Barring services can be provided by the gsmSCF per profile. An MO call
made by an MSP subscriber will be subject to the outgoing call barrings
provided for the Calling profile. An MT call to an MSP subscriber will be
subject to the incoming call barrings provided for the Called profile. If an
MT call to an MSP subscriber is forwarded, the forwarded call will be subject
to the outgoing call barrings provided for the Called profile.
The Call Barring services available per profile are:
\- Barring of all outgoing calls (BAOC);
\- Barring of outgoing international calls (BOIC);
\- Barring of outgoing international calls except those directed to the home
PLMN country (BOIC-exHC);
\- Barring of all incoming calls (BAIC);
\- Barring of incoming calls when roaming outside the home PLMN country (BIC-
roam).
The Call Barring services, implemented by the gsmSCF, should operate in the
same way as the Call Barring Supplementary Services. The MSP subscriber should
have control over the call barring data (Registration, Erasure, Activation,
Deactivation, and Interrogation). The method for controlling this data is a
network option.
If the MSP subscriber changes the Outgoing Call Barrings for the default
profile by contacting the gsmSCF, the gsmSCF will change the barrings stored
in the gsmSCF and inform the HLR using ATM to change the barrings stored in
the HLR. The Call Barring Supplementary Services may require a password before
Call Barring data can be changed. For the Call Barring Services implemented in
the gsmSCF, use of a password is a network option.
The operator should ensure that if the equivalent call barring service is
provided then:
\- the OCB_flag is set in the HLR (See subclause 6.1:OCB_flag);
\- if an equivalent outgoing call barring service is in a \"Provisioned and
Active\" state in the gsmSCF for the default profile, that outgoing call
barring supplementary service will be in a \"Provisioned and Active\" state in
the HLR;
\- if an equivalent outgoing call barring service is in a \"Not Active\" state
in the gsmSCF for the default profile, that outgoing call barring
supplementary service will be in a \"Not Provisioned\" state in the HLR;
\- incoming Call Barrings shall not be provisioned in the HLR;
NOTE: Barrings will not apply to MT short messages.
### 7.11.3 Operator Determined Barring (ODB)
Operator Determined Barring will be available per profile in the gsmSCF for
the following categories:
\- Barring of outgoing calls;
\- Barring of incoming calls;
\- Barring of roaming;
\- Barring of outgoing Premium Rate Calls;
\- Barring specific to the home PLMN;
\- Barring of registration of call forwarding;
\- Barring of invocation of call transfer.
However, if zone related barring is implemented in the gsmSCF, the appropriate
data will be needed in the gsmSCF as well as the HLR. For barring of incoming
calls when roaming outside the zone of the home country, the gsmSCF will need
to use Any Time Interrogation to establish the location of the called party.
Management of ODB data is operator specific.
The operator should ensure that if the equivalent ODB service for an ODB
category is provided then:
\- the ODB flag for the correct category is set in the HLR (See subclause 6.2:
ODB flags);
\- the ODB data for that category for the default profile is duplicated in the
HLR.
NOTE: Barring of incoming calls in the gsmSCF will not disallow MO or MT short
messages.
### 7.11.4 Advice of Charge (AoC)
Advice of Charge is available per profile in the gsmSCF. This is detailed in
the SDL diagrams in Section 7.5: Functions and Information flows.
## 7.12 Exceptional Procedures
### 7.12.1 Roaming into a network not supporting CAMEL Phase 3
When roaming into a network not supporting CAMEL Phase 3, only the
functionality of MSP Phase 1 will be available to an MSP subscriber.
The default profile subscription information shall apply to all supplementary
services, excluding Call Forwarding and Call Barring, provisioned per profile.
### 7.12.2 Roaming into a network not supporting CAMEL Phase 2
This subclause details MSP specific handling for roaming into a network not
supporting CAMEL Phase 2. Other handling for this scenario is described in 3G
TS 23.078.
#### 7.12.2.1 Actions required on Location Update
The HLR will send the outgoing call barring data and outgoing ODB data,
specific to the default profile, to the VLR.
#### 7.12.2.2 MO call handling
When an MSP subscriber roams into a network not supporting CAMEL Phase 2, the
default profile will be used for all outgoing traffic.
#### 7.12.2.3 MT call handling
MT calls to any profile will be received by the subscriber (subject to call
forwardings and call barrings provided in the gsmSCF on the called profile),
although no indication of the called profile will be received.
The HLR will not allow OR, this means that for MT calls, the GMSC will always
support CAMEL Phase 2, allowing the gsmSCF to invoke appropriate Call
Forwardings and Call Barrings.
#### 7.12.2.4 MO short message handling
MO short messages will be sent from and charged to the default profile.
### 7.12.3 Lack of availability of the Network Indication of Alerting feature
If an MSP subscriber roams into a network not supporting the Network
Indication of Alerting feature, or is using an MS that does not support the
Network indication of Alerting feature, then the subscriber will still receive
all MT calls, but no indication of the called profile will be given.
###### ## Annex A (informative): Provision and Withdrawal of MSP
# A.1 Provision of MSP
MSP will be provisioned by prior arrangement with the service provider.
For an existing subscriber converting to an MSP subscriber, all profile
specific data will be stored in the gsmSCF and removed from the HLR, and MSP
will be provisioned in the HLR.
For a new subscriber provisioned with the MSP service, all profile specific
data will be stored in the gsmSCF and MSP will be provisioned in the HLR.
Data specific to the Default Profile will be stored in both the HLR and the
gsmSCF.
# A.2 Withdrawal of MSP
MSP will be withdrawn when there is only one profile remaining. In this event,
the subscriber data will be stored in the HLR and removed from the gsmSCF, and
the HLR will remove all MSP markings. The subscriber will then be treated as a
normal subscriber.
#