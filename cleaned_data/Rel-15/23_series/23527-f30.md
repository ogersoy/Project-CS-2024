# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document defines the restoration procedures in the 5G System.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.007: \"Restoration procedures\".
[3] 3GPP TS 29.281: \"General Packet Radio System (GPRS) Tunneling Protocol
User Plane (GTPv1-U)\".
[4] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
Nodes; Stage 3\".
[5] 3GPP TS 23.502:\"Procedures for the 5G System; Stage 2\"
[6] 3GPP TS 29.518: \"5G System; Access and Mobility Management Service; Stage
3\".
[7] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[8] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service (CBS)\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and 3GPP TS 29.244 [4] and the following apply. A term
defined in the present document takes precedence over the definition of the
same term, if any, in 3GPP TR 21.905 [1] and 3GPP TS 29.244 [4].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
F-SEID Fully Qualified SEID
PFCP Packet Forwarding Control Protocol
PSA PDU Session Anchor
# 4 Restoration Procedures related to the N4 Interface
## 4.1 General
This clause specifies the procedures supported in the 5G System to detect and
handle failures affecting the N4 interface.
## 4.2 N4 Failure and Restart Detection
Across PFCP based interfaces, an SMF and UPF shall utilize the PFCP Heartbeat
Request and Heartbeat Response messages to detect a peer PFCP entity failure
or restart as described in clause 19A of 3GPP TS 23.007 [2].
A PFCP function that receives a PFCP Association Setup Request shall proceed
with:
\- establishing the PFCP association and
\- deleting the existing PFCP association and associated PFCP sessions, if a
PFCP association was already established for the Node ID received in the
request, regardless of the Recovery Timestamp received in the request.
A PFCP function shall ignore the Recovery Timestamp received in PFCP
Association Setup Response message.
## 4.3 UPF Restoration Procedures
### 4.3.1 General
When a UPF fails, all its Session contexts and PFCP associations affected by
the failure become invalid and may be deleted.
### 4.3.2 Restoration Procedure for PSA UPF Restart
If F-TEID allocation is performed in the UPF, the UPF shall ensure that
previously used F-TEID values are not immediately reused after a UPF restart,
in order to avoid inconsistent TEID allocation throughout the network and to
enable the restoration of PFCP sessions affected by the failure. How this is
ensured is implementation specific.
The UPF shall not send an Error indication message for a configurable period
after an UPF restart when the UPF receives a G-PDU not matching any PDRs.
During or immediately after an UPF Restart, the UPF shall place a local UPF
Recovery Time Stamp value in all Heartbeat Request/Response messages.
Immediately after the re-establishment of a PFCP association between the SMF
and the UPF, the SMF may start restoring PFCP sessions in the UPF.
### 4.3.3 Restoration Procedure for PSA UPF Failure without Restart
Procedures for PSA UPF failure without restart are implementation specific.
### 4.3.4 Restoration Procedure for Intermediate UPF Restart
The SMF will receive the UPF recovery time stamps in PFCP heartbeat
requests/responses.
After an Intermediate UPF restart, the PFCP association between the SMF(s) and
the Intermediate UPF has to be re-established.
The restoration of the PFCP sessions may start immediately after the PFCP
association setup procedure:
\- if the restoration is supported in the SMF on a proactive basis, the SMF
may start re-establishing PFCP sessions matching any PDRs.
\- if the restoration is supported in the SMF on a reactive basis:
\- the SMF shall establish an PFCP session with a wildcarded PDR to instruct
the Intermediate UPF to forward G-PDU packets which are not matching any other
PDRs to the SMF (to a F-TEID uniquely assigned in the SMF for this PFCP-u
tunnel);
\- upon receipt of G-PDUs from this PFCP-u tunnel, the SMF shall then check if
it has an active session for each received G-PDU packet:
\- if so, the SMF shall perform the PFCP Session establishment procedures to
re-establish the corresponding PFCP sessions in the Intermediate UPF;
\- otherwise the SMF shall generate a GTP-U Error Indication with a
destination address set to the source IP address of the received G-PDU, and
send it to the Intermediate UPF. The Intermediate UPF shall forward this GTP-U
Error Indication transparently. The SMF shall delete the G-PDU after the check
for active sessions.
NOTE 1: The UPF can filter the G-PDU packets with same target F-TEID and send
only one such G-PDU to the Intermediate SMF.
The Intermediate UPF shall not send any Error indication messages for a
configurable period after an Intermediate UPF restart when the Intermediate
UPF receives G-PDU not matching any PDRs.
NOTE 2: If restoration on a reactive basis is used, the period needs to be
longer than the time required by the SMF to detect the UPF restart, to
establish the PFCP association and provision the wildcarded PDR. Otherwise,
the period needs to be longer than the time required by the SMF to restore all
the PFCP sessions on a proactive basis.
### 4.3.5 Restoration Procedure for Intermediate UPF Failure without Restart
Procedures for Intermediate UPF failure without restart are implementation
specific.
## 4.4 SMF Restoration Procedures
### 4.4.1 General
When a SMF fails, all its PDU session contexts and PFCP associations affected
by the failure may become invalid and may be deleted.
If F-TEID allocation is performed in the SMF, the SMF should ensure as far as
possible that previously used F-TEID values are not immediately reused after a
SMF restart, in order to avoid inconsistent TEID allocation throughout the
network.
NOTE: This is to ensure that F-TEIDs are not reused until earlier PDU sessions
using them are released.
### 4.4.2 Restoration Procedure for SMF Restart
During or immediately after a SMF Restart, the SMF shall place local SMF-C
Recovery Time Stamp value in all Heartbeat Request/Response messages.
The UPF will receive the SMF recovery time stamps in PFCP heartbeat
requests/responses.
When a UPF detects that a peer PFCP entity in the SMF has restarted (as
specified in subclause 4.2), the UPF shall delete all session contexts
affected by the PFCP entity restart that it may have stored. When the UPF
receives a GTP‑U PDU not matching any PDRs, it shall discard the GTP‑U PDU and
return a GTP error indication to the originating node (e.g. other UPF, gNB or
N3IWF).
### 4.4.3 Restoration Procedure for SMF Failure without Restart
When a UPF detects that a peer PFCP entity in the SMF is not reachable for a
preconfigured time, the UPF shall delete all the session contexts affected by
the peer PFCP entity failure that it may have stored.
## 4.5 N4 path failure
If the N4 path to the UPF is down, the SMF should handle this as an UPF
Failure without Restart, see subclause 4.3.3.
If the N4 path to the SMF is down, the UPF should handle this as a SMF Failure
without Restart, see subclause 4.4.3.
# 5 Restoration Procedures related to the User Plane Interfaces N3 and N9
## 5.1 General
This clause specifies the procedures supported in the 5G System to detect and
handle failures affecting the user plane interfaces N3 and N9
## 5.2 User Plane Failure Detection
### 5.2.1 Loss of GTP-U contexts
A GTP-U entity may lose its GTP-U contexts upon a failure or restart.
When a GTP-U node receives a G-PDU for which no corresponding GTP-U tunnel
exists, the GTP-U node shall discard the G-PDU and return a GTP-U Error
Indication to the sending node, as specified in subclause 7.3.1 of 3GPP TS
29.281 [3].
The receipt of a GTP-U Error Indication is an indication for the sending GTP-U
entity that the peer GTP-U entity cannot receive any more user plane traffic
on the corresponding GTP-U tunnel.
### 5.2.2 User Plane Path Failure
A GTP-U entity may detect a user plane path failure by using GTP-U Echo
Request and Echo Response messages, as specified in subclause 20.3.1 of 3GPP
TS 23.007 [2].
## 5.3 Restoration Procedures upon Loss of GTP-U contexts
### 5.3.1 General
The following subclauses specify the behaviour of the different network
entities when receiving a GTP-U Error Indication.
### 5.3.2 Procedure for GTP-U Error Indication received from 5G-AN
#### 5.3.2.1 Principles
Figure 5.3.2.1-1: GTP-U Error Indication from 5G-AN
1\. The user plane connection of an existing PDU session is activated.
Downlink G-PDUs are sent towards the 5G-AN.
2\. The 5G-AN returns a GTP-U Error Indication if it does not have a
corresponding GTP-U context (see subclause 5.2).
3\. Upon receipt of a GTP-U Error Indication, the UPF shall identify the
related PFCP session and send an Error Indication Report to the SMF, as
specified in subclause 5.10 of 3GPP TS 29.244 [4].
4\. For a GTP-U Error Indication received from a 5G-AN, the SMF shall modify
the PFCP session to instruct the UPF to buffer downlink packets.
5\. If the user plane connection of the PDU session is seen as activated by
the SMF, the SMF shall initiate an Namf_Communication_N1N2MessageTransfer
service operation to request the 5G-AN to release the PDU session\'s
resources, as specified in subclause 4.3.7 of 3GPP TS 23.502 [5].
6\. Upon receipt of an Namf_Communication_N1N2MessageTransfer request to
transfer the PDU Session Resource Release Command, the AMF shall:
\- proceed with the request, as specified in subclause 5.2.2.3.1 of 3GPP TS
29.518 [6], if the UE is in CM-CONNECTED state for the Access Network Type
associated to the PDU session;
\- otherwise, reject the request with an error indicating that the UE is in
CM-IDLE state for the Access Network Type associated to the PDU session.
7\. If the AMF sent a PDU Session Resource Release Command to the 5G-AN, the
PDU session\'s resource release is acknowledged to the SMF.
8\. The SMF initiates the Network Triggered Service Request procedure
specified in subclause 4.2.3.3 of 3GPP TS 23.502 [5], to re-activate the user
plane connection of the PDU session.
### 5.3.3 Procedure for GTP-U Error Indication received from UPF
#### 5.3.3.1 GTP-U Error Indication received by 5G-AN
Upon receipt of a GTP-U Error Indication, the 5G-AN shall proceed as follows:
\- if the GTP-U Error Indication was received from an UPF for a NG-U tunnel
other than an indirect forwarding tunnel, the 5G-AN shall initiate a PDU
Session Resource Notify procedure and release immediately the resources of the
PDU session for which the Error Indication was received;
\- if the GTP-U Error Indication was received from a peer 5G-AN or UPF for a
direct or indirect forwarding tunnel, the 5G-AN may ignore the error
indication or delete the forwarding tunnel context locally without deleting
the corresponding PDU session and bearers.
NOTE: The 5G-AN behaviour for dual connectivity is not described in this
specification.
#### 5.3.3.2 GTP-U Error Indication received by another UPF
Upon receipt of a GTP-U Error Indication, the UPF shall identify the related
PFCP session and send an Error Indication Report to the SMF, as specified in
subclause 5.10 of 3GPP TS 29.244 [4].
Upon receipt of an Error Indication Report from the UPF, the SMF shall
identify the PDU session for which the Error Indication is received using the
remote F-TEID included in the report.
For a GTP-U Error Indication received from another UPF, the SMF shall delete
the PFCP session and PDU session, unless the UPF from which the Error
Indication was received is controlled by the same SMF and the SMF is able to
restore the user plane connectivity of the PDU session (e.g. Error Indication
received from an Intermediate UPF controlled by the same SMF).
## 5.4 Restoration Procedures upon User Plane Path Failure
Upon detecting a GTP-U user plane path failure as specified in subclause
5.2.2, the UPF shall report the user plane path failure to the SMF, by sending
a PFCP Node Report Request (see 3GPP TS 29.244 [4]) including a User Plane
Path Failure Report with the IP address of the remote GTP-U peer(s) towards
which a failure has been detected. The UPF should also notify the GTP-U user
plane path failure via the Operation and Maintenance system.
When the SMF receives the PFCP Node Report Request with a User Plane Path
Failure Report, the SMF may:
\- delete the PDU session contexts associated with the path in failure; or
\- maintain the PDU session contexts associated with the path in failure
during an operator configurable maximum path failure duration. The SMF shall
delete the PDU session contexts associated with the path in failure if the
path is still down when this duration expires.
NOTE 1: During transient path failures (e.g. path failures not exceeding few
minutes at most), maintaining the PDU session contexts associated with the
peer\'s IP address enables the delivery of end user services (when the path is
re-established again) and this also avoids unnecessary signalling in the
network for restoring those PDU sessions.
NOTE 2: It is not intended to maintain PDU session contexts during long path
failures (e.g. exceeding few minutes at most) as this would imply undesirable
effects like undue charging.
When deciding to delete the PDU session contexts associated with the path in
failure, the SMF shall modify or delete the affected PFCP sessions in the UPF.
NOTE 3: The SMF need to take care to smoothen the signalling load towards the
UPF if a large number of PFCP sessions are affected by the user plane path
failure.
# 6 Restoration Procedures related to Service-Based Interfaces
## 6.1 General
A NF may detect a failure or a restart of a peer NF or NF service using the
NRF as specified in subclause 6.2.
A NF may also detect a restart of a peer NF or NF service by receiving
recovery time information in signalling exchanged with that peer NF or NF
service.
The restoration procedures, initiated when detecting a failure or a restart
are not specified in this release.
## 6.2 NF (NF Service) Failure and Restart Detection using the NRF
### 6.2.1 General
This subclause describes optional procedures that may be supported by NFs to
detect the failure or restart of a NF or a NF service using the NRF.
### 6.2.2 NF (NF Service) Failure
Figure 6.2.2-1 describes a NF failure scenario and how other NFs can be
notified of this failure.
Figure 6.2.2-1: NF Failure Detection and Notification
1\. NF A subscribes to the NRF to receive notifications of changes of the NF B
Profile, as specified in 3GPP TS 29.510 [7].
2\. A NF failure occurs at NF B.
3\. The NRF detects that NF B is no longer operative using the NF Heart-Beat
procedure as specified in subclause 5.2.2.3.2 of 3GPP TS 29.510 [7]. The NRF
changes the NFStatus of NF B to SUSPENDED.
4\. The NRF notifies NFs having subscribed to receive notifications of changes
of the NF B Profile that the NFStatus of NF B is changed to SUSPENDED.
5\. NF A may trigger appropriate restoration or clean-up actions, if it cannot
communicate with NF B.
Figure 6.2.2-2 describes a NF service failure scenario and how other NFs can
be notified of this failure.
Figure 6.2.2-2: NF Service Failure Detection and Notification
1\. NF A subscribes to the NRF to receive notifications of changes of the NF B
Profile.
2\. A NF Service failure occurs at NF B. NF B (other than the failed NF
Service) is still operative.
3\. NF B (or OAM) updates its NF Profile in the NRF, by setting the
NFServiceStatus of the failed NF Service to SUSPENDED.
4\. The NRF notifies NFs having subscribed to receive notifications of changes
of NF B Profile that the NF Service status of the failed NF service of NF B is
changed to SUSPENDED.
5\. NF A triggers appropriate restoration or clean-up actions, if it cannot
communicate with the NF B service.
### 6.2.3 NF (NF Service) Restart
Figure 6.2.3-1 describes a NF restart scenario and how other NFs can be
notified of this restart.
Figure 6.2.3-1: NF Restart Detection and Notification
1\. NF B (or OAM) registers NF B Profile to the NRF. The NF B Profile may
include the recoveryTime attribute, if a restart of NF B results in losing
contexts.
2 NF A subscribes to the NRF to receive notifications of changes of the NF B
Profile.
3\. NF B restarts.
4\. If contexts are lost during the restart, NF B (or OAM) updates the
recoveryTime in its NF Profile in the NRF.
5\. The NRF notifies NFs having subscribed to receive notifications of changes
of NF B Profile about the updated recoveryTime of the NF B Profile.
6\. NF A may consider that all the resources created in the NF B before the NF
B recovery time as have been lost. NF A triggers then appropriate restoration
or clean-up actions.
Figure 6.2.3-2 describes a NF service restart scenario and how other NFs can
be notified of this restart.
Figure 6.2.3-2: NF Service Restart Detection and Notification
1\. NF B (or OAM) registers its NF B Profile (and its services) to the NRF.
The NF B Profile may include the recoveryTime attribute for the NF Services it
supports, if a restart of a NF B service results in losing contexts.
2 NF A subscribes to the NRF to receive notifications of changes of the NF B
Profile.
3\. A NF B service restarts.
4\. If contexts are lost during the service restart, NF B (or OAM) updates the
recoveryTime of the corresponding NF Service in the NRF.
5\. The NRF notifies NFs having subscribed to receive notifications of changes
of the NF B Profile about the updated recoveryTime of the NF B Service.
6\. NF A may consider that all the resources created in the NF B service
before the NF B service recovery time as have been lost. NF A triggers then
appropriate restoration or clean-up actions.
## 6.3 NF Service Producer Restart Detection using direct signalling between
NFs
### 6.3.1 General
This subclause describes an optional procedure that may be supported by NFs to
detect the restart of a peer NF service using direct signalling between NFs.
### 6.3.2 NF Service Producer Restart
Figure 6.3.2-1 describes a NF Service restart scenario of an NF Service
Producer and how the NF Service Consumer can detect this restart.
Figure 6.3.2-1: NF Service Producer Restart Detection
1\. NF A requests to create a resource in the NF B. If the request is
accepted, and if NF B implements the procedure specified in this subclause, NF
B shall return its NF B service instance ID in the response, and NF A shall
associate the created resource with the NF B service instance.
2\. A NF service produced by NF B restarts.
3-4. NF B service may include its last recovery timestamp in responses it
sends to the NF Service Consumer, if the restart of the NF service resulted in
losing contexts and e.g. if the NF service has restarted recently.
5\. NF A may consider that all the resources created in the NF B service
instance before the NF B service recovery time as have been lost. NF A
triggers then appropriate restoration or clean-up actions.
The recovery timestamp signalled in direct signalling between NFs shall be
associated to a NF service instance, i.e. the same recovery timestamp shall be
signalled by a NF service instance whatever the NF service instance\'s
endpoint addresses used for the signalling.
NOTE 1: This procedure is only supported by NF services that support
signalling the recoveryTime attribute.
NOTE 2: The recovery time signalled in this procedure is equivalent to the
recovery time of the NF service of Figure 6.2.3-2. For an entire NF restart
scenario, this procedure can be applied by each NF service instance of the NF.
NOTE 3: This procedure enables the detection of a restart of a peer NF service
when sending signalling towards that NF Service. It can fasten the detection
of a restart of a peer NF service when frequent signalling occurs towards that
peer NF Service.
NOTE 4: In some use cases, NF A is not aware of the NF B Service Instance ID
when creating the resource, e.g. a V-SMF just receives the H-SMF URI from the
AMF to create a PDU session resource in H-SMF. Besides, for APIs supporting
distributed collections (e.g. SMF), the response can contain a different
Service Instance ID (that need not be registered in the NRF) than the one
selected by NF A for sending the request.
## 6.4 NF Service Consumer Restart Detection using direct signalling between
NFs
### 6.4.1 General
This subclause describes an optional procedure that may be supported by NFs to
detect the restart of a peer NF Service Consumer by NF Service Producer using
direct signalling between NFs.
### 6.4.2 NF Service Consumer Restart
Figure 6.4.2-1 describes a NF Service Consumer restart scenario and how the NF
Service Producer can detect this restart.
Figure 6.4.2-1: NF Service Consumer Restart Detection
1\. NF A requests to create a resource in the NF B. If NF A implements the
procedure specified in this subclause, it shall include a Consumer Id together
with the last recovery timestamp in the request. The Consumer Id shall be
identical for all service requests triggered by the NF service consumer for
that service and shall be globally unique (e.g. using UUID).
2\. If resource creation is successful, NF B as service producer shall store
the received Consumer Id and recovery timestamp and associate the created
resource with it.
3\. The NF service consumer in NF A restarts.
4\. The NF service consumer in NF A shall include its last recovery timestamp
together with the Consumer Id in the request when invoking service provided by
NF B. The same Consumer Id shall be used after restarting.
5\. NF B as NF service producer may compare the received recovery timestamp
with previous recovery timestamp associated with the Consumer Id and detect
the NF service consumer was restarted, if the received recovery timestamp is
newer than the previous one.
The consumer Id for the resource may be updated if another service consumer
took over the usage of the resource. e.g. if a new consumer Id is received
during a service operation of a resource, NF B as NF service producer shall
consider the service consumer handling the resource has changed and associate
the resource with the new consumer Id and recovery timestamp.
6\. NF B may consider that the context in the NF A corresponding to all the
resources associated with the consumer Id and the previous stored recovery
time stamp has been lost. NF B triggers then appropriate restoration or clean-
up actions.
NOTE 1: This procedure is only supported by NF services that support
signalling the recovery timestamp attribute.
NOTE 2: This procedure can be used when the resource is exclusively used by an
NF service consumer.
NOTE 3: This procedure enables the detection of a restart of a peer NF service
consumer when sending signalling towards that NF service producer. It is
helpful if the NF A as a pure service consumer without registration of its
profile in NRF. If NF A does have a profile registered in NRF, it also can
fasten the detection of a restart of a peer NF service consumer when frequent
signalling occurs towards that peer NF Service.
## 6.5 NF Service Instance Reselection
An NF Instance of an NF Service Producer may expose several service instances
of the same NF Service (e.g., an UDM instance may expose several service
instances of the \"Nudm_SubscriberDataManagement\" service).
An NF Service Consumer may discover, via NRF Nnrf_NFDiscovery service, all
available NF Service Instances for a given NF Service and select one of them.
If a formerly selected NF Service Instance becomes unavailable, the NF Service
Consumer may select a different instance of a same NF Service, in the same NF
Instance, if the NF Instance indicates in its NF Profile that it supports the
capability to persist their resources in shared storage inside the NF
Instance, and if the new NF Service Instance offers the same major service
version.
If so, the NF Service Consumer may invoke service operations in the newly
selected NF Service Instance by means of replacing the addressing parameters
with those of the new service instance, and the new NF Service Instance in the
NF Service Producer shall produce the same result as if the service operation
request would have been successfully delivered to the former NF Service
Instance.
NOTE: This reselection mechanism is applicable only for the request/response
service semantics, but not for notify/callback requests.
If the NF instance does not indicate in its NF Profile the support of the
capability to persist their resources in shared storage across service
instances of the same NF Service, inside the NF Instance, the NF Service
Consumer may still reselect any of the exposed service instances, but it shall
not assume that the resources created in the former service instance are still
valid.
# 7 Restoration Procedures related to Public Warning System (PWS)
## 7.1 General
This clause specifies the procedures supported in the 5G System to handle
failures affecting Public Warning System (PWS). The stage 2 architecture and
procedures for PWS are specified in 3GPP TS 23.041 [8].
## 7.2 PWS operation failure in NG-RAN
The NG-RAN shall report that on-going PWS operation for one or more cells of
the NG-RAN has failed by sending a PWS Failure Indication as specified in 3GPP
TS 23.041 [8].
## 7.3 PWS operation restart in NG-RAN
After a NG-RAN (i.e. gNB or ng-eNB) has restarted, it shall delete all its
warning message data. If the warning message service is operational in one or
more cell(s) of the NG-RAN, the NG-RAN shall send a PWS Restart Indication
message, which shall include the identity of the NG-RAN, the identity of the
restarted cell(s), and the TAI(s) and Emergency Area Id(s) with which the
restarted cell(s) are configured, to request the CBC to re-load its warning
message data if applicable.
The NG-RAN should send the PWS Restart Indication message via two AMFs of the
AMF Region, if possible, to ensure that the CBC receives the message even if
one AMF cannot propagate it to the CBC (e.g. due to a path failure between the
AMF and the CBC).
If the AMF interfaces with multiple CBCs, the AMF shall forward the PWS
Restart Indication to all CBCs.
Upon receipt of a PWS Restart Indication message, the CBC shall consider that
the warning message service is restarted in the reported cell(s), i.e. the
service is operational and no warning messages are being broadcast in the
cell(s). The CBC shall then re-send the warning message data (with the same
message identifier and serial number) to the NG-RAN for these cells, if any.
When doing so, the CBC:
\- shall provide the identity of the NG-RAN received in the PWS Restart
Indication when sending the Write-Replace-Warning-Request message(s) to the
AMF, to enable the AMF to forward the message(s) only to the NG-RAN involved
in the restart. The identity of the NG-RAN shall be included in:
\- the Write-Replace-Warning-Request message(s) sent to the PWS-IWF over the
SBc interface; or
\- the globalRanNodeList IE of the NonUeN2MessageTransfer request message(s)
sent to the AMF over the N50 interface (see subclauses 5.2.2.4.1.3 and
6.1.6.2.9 of 3GPP TS 29.518 [6]) to request the transfer of the Write-Replace-
Warning-Request message(s).
\- should set the warning area list to the identities of the cell(s) to be
reloaded which are relevant to the warning message data being reloaded; and
\- may update the number of broadcasts requested, if necessary.
The CBC shall consider a PWS Restart Indication message received shortly after
a preceding one for the same cell identity as a duplicate restart indication
for that cell which it shall ignore.
NOTE: The broadcast of warning messages can be configured in the network per
individual cell, TAI and/or Emergency Area Id. The CBC can use the list of
cell(s), the TAI(s) and Emergency Area Id(s) received in the PWS Restart
Indication to derive the list of warning messages to be broadcast in the
respective cell(s), TAI(s) and Emergency Area Id(s).
Likewise, in other scenarios where the NG-RAN may need to reload its warning
message data (e.g. when an individual cell is restarted), the NG-RAN shall
send a PWS Restart Indication message (including the identity of the NG-RAN,
the identity of the restarted cell(s), and the TAI(s) and Emergency Area Id(s)
with which the restarted cell(s) are configured) to the CBC to request the CBC
to re-load its warning message data if applicable. The NG-RAN, AMF and CBC
shall then proceed as specified above for a NG-RAN restart.
#