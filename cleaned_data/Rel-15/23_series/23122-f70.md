# Foreword
This Technical Specification (TS) has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The present document specifies functions related to Mobile Station (MS) in
idle mode and within the 3GPP system.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document gives an overview of the tasks undertaken by the Core
network protocols of a Mobile Station (MS) when in idle mode, that is,
switched on but typically not having a dedicated channel allocated. It also
describes the corresponding network functions. The idle mode functions are
also performed by a GPRS MS as long as no dedicated channel is allocated to
the MS. The conditions when the idle mode functions are performed by an MS in
the UTRA RRC connected mode states are specified in 3GPP TS 25.331 [33]. The
conditions when the idle mode functions are performed by an MS in the E-UTRAN
are specified in 3GPP TS 36.304 [43]. The conditions when the idle mode
functions are performed by an MS in the NG-RAN are specified in 3GPP TS 38.304
[61].
The present document defines the PLMN selection for a multi mode MS that
supports both 3GPP and 3GPP2 systems. The common PLMN selection logic covers
also PLMNs that are available in 3GPP2 system, but the present document makes
no changes on the cdma2000^®^ signalling towards networks that are available
via 3GPP2 system.
The present document gives procedures for using the CSG cells, whenever such
use is permitted.
This 3GPP TS outlines how the requirements of the 22 series Technical
Specifications (especially 3GPP TS 22.011 [9]) on idle mode operation shall be
implemented. Further details are given in 3GPP TS 24.008 [23].
Clause 2 of this 3GPP TS gives a general description of the idle mode process.
Clause 3 outlines the main requirements and technical solutions of those
requirements. Clause 4 describes the processes used in idle mode. There is
inevitably some overlap between these clauses.
NOTE: cdma2000^®^ is a registered trademark of the Telecommunications Industry
Association (TIA-USA).
The present document describes the procedures for control plane solution of
steering of roaming in 5GS in annex C.
Annex C is applicable to the MS, the AMF and the UDM in the 5GS.
The present document does not consider GERAN Iu mode.
## 1.1 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document._
[1] Void.
[2] Void.
[3] Void.
[4] Void.
[5] Void.
[6] Void.
[7] Void
[8] Void.
[9] 3GPP TS 22.011: \"Service accessibility\".
[10] Void.
[11] Void.
[12] Void.
[13] Void.
[14] Void.
[15] Void.
[16] Void.
[17] Void.
[18] Void.
[19] Void.
[20] Void.
[21] Void.
[22] Void.
[22A] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[23] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification, Core
Network Protocols - Stage 3\".
[23A] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[24] 3GPP TS 45.002: \"Multiplexing and multiple access on the radio path\".
[25] 3GPP TS 45.008: \"Radio subsystem link control\".
[26] Void.
[27] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[27A] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
with packet data networks and applications\".
[28] Void.
[29] Void.
[30] Void.
[31] Void.
[32] 3GPP TS 25.304: \"UE Procedures in Idle Mode and Procedures for Cell
Reselection in Connected Mode\".
[33] 3GPP TS 25.331: \"RRC Protocol Specification\".
[34] 3GPP TS 44.018:\"Mobile radio interface layer 3 specification, Radio
Resource Control Protocol\".
[35] 3GPP TS 43.022: \"Functions related to Mobile Station (MS) in idle mode
and group receive mode\".
> [35A] 3GPP TS 43.318: \"Generic Access Network (GAN); Stage 2\".
>
> [35B] 3GPP TS 44.318: \"Generic Access Network (GAN); Mobile GAN interface
> layer 3 specification; Stage 3\".
[36] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[37] Void.
[38] 3GPP TS 21.111: \"USIM and IC card requirements\".
[39] 3GPP TS 44.060: \"General Packet Radio Service (GPRS);Mobile Station (MS)
- Base Station System (BSS) interface;Radio Link Control/Medium Access Control
(RLC/MAC) protocol\".
[40] 3GPP TS 31.102: \"Characteristics of the USIM Application\".
[41] 3GPP TS 31.111: \"Universal Subscriber Identity Module (USIM),
Application Toolkit (USAT)\".
[42] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA)
Radio Resource Control (RRC); Protocol specification\".
[43] 3GPP TS 36.304: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) procedures in idle mode\".
[44] 3GPP2 C.S0016-D v1.0: \"Over-the-Air Service Provisioning of Mobile
Stations in Spread Spectrum Standards\".
[45] 3GPP2 C.S0011-C v2.0: \"Recommended Minimum Performance Standards for
cdma2000 Spread Spectrum Mobile Stations\".
[46] 3GPP2 C.S0033-A v2.0: \"Recommended Minimum Performance Standards for
cdma2000 High Rate Packet Data Access Terminal\".
[47] 3GPP TS 24.285: \"Allowed Closed Subscriber Group (CSG) List Management
Object (MO)\".
[48] Void.
[49] 3GPP TS 22.220: \"Service requirements for Home Node B (HNB) and Home
eNode B (HeNB)\".
[50] 3GPP TS 24.368: \"Non-Access Stratum (NAS) configuration Management
Object (MO)\".
[51] 3GPP TS 24.334: \"Proximity-services (ProSe) User Equipment (UE) to
Proximity-services (ProSe) Function Protocol aspects; Stage 3\".
[52] 3GPP TS 24.333: \"Proximity-services (ProSe) Management Objects (MO)\".
[53] 3GPP TS 24.105: \"Application specific Congestion control for Data
Communication (ACDC) Management Object (MO)\".
[54] 3GPP TS 36.306: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
User Equipment (UE) radio access capabilities\".
[55] 3GPP TS 43.064: \"Overall description of the GPRS Radio Interface; Stage
2\".
[56] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall
description\".
[57] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
[58] 3GPP TS 23.401: \"GPRS enhancements for E-UTRAN access\".
[59] 3GPP TS 24.386: \"User Equipment (UE) to V2X control function; protocol
aspects; Stage 3\".
[60] 3GPP TS 24.385: \"V2X services Management Object (MO)\".
[61] 3GPP TS 38.304: \"New Generation Radio Access Network; User Equipment
(UE) procedures in Idle mode\".
[62] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[63] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[64] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[65] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol
specification\".
[66] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\".
[67] 3GPP TS 31.115: \"Secured packet structure for (Universal) Subscriber
Identity Module (U)SIM Toolkit applications\"
## 1.2 Definitions and abbreviations
For the purposes of the present document, the abbreviations defined in 3GPP TR
21.905 [36] apply.
**(A/Gb mode only):** Indicates this clause applies only to a GSM system which
operates in A/Gb mode. For multi system case this is determined by the current
serving radio access network.
**(Iu mode only):** Indicates this clause applies only to UMTS. For multi
system case this is determined by the current serving radio access network.
NOTE 1: In accordance with the description of packet services in Iu mode in
3GPPS TS 24.008 [23], the terms \'CS/PS mode of operation\' and \'PS mode of
operation\' are not used in the present document. Instead the terms \'MS
operation mode A\' and \'MS operation mode C\' are used.
**(S1 mode only):** Indicates this clause applies only to an EPS. For multi
system case this is determined by the current serving radio access network.
**Acceptable Cell:** This is a cell that the MS may camp on to make emergency
calls. It must satisfy criteria which are defined for A/Gb mode in 3GPP TS
43.022 [35], for Iu mode in 3GPP TS 25.304 [32], for S1 mode in 3GPP TS 36.304
[43], and for N1 mode in 3GPP TS 38.304 [61]. For an MS in eCall only mode, an
acceptable cell must further satisfy the criteria defined in subclause
4.4.3.1.1.
**Access Technology:** The access technology associated with a PLMN. The MS
uses this information to determine what type(s) of radio carrier to search for
when attempting to select a specific PLMN (e.g., GSM, UTRAN, GSM COMPACT,
E-UTRAN or NG-RAN). A PLMN may support more than one access technology.
**ACDC:** Application specific Congestion control for Data Communication, see
3GPP TS 22.011 [9].
**Allowable PLMN:** In the case of an MS operating in MS operation mode A or
B, this is a PLMN which is not in the list of \"forbidden PLMNs\" in the MS.
In the case of an MS operating in MS operation mode C or an MS not supporting
A/Gb mode and not supporting Iu mode, this is a PLMN which is not in the list
of \"forbidden PLMNs\" and not in the list of \"forbidden PLMNs for GPRS
service\" in the MS.
**Allowable PLMN/access technology** **combination:** For an MS operating in
MS operation mode C or an MS not supporting A/Gb mode and not supporting Iu
mode, this is an allowable PLMN in any specific access technology. For an MS
operating in MS operation mode A or B, this is a PLMN/access technology
combination where:
\- the PLMN is an allowable PLMN and the specific access technology is
supporting non-GPRS services; or
\- the PLMN is not in the list of \"forbidden PLMNs\" and not in the list of
\"forbidden PLMNs for GPRS service\" in the MS and the specific access
technology is only supporting GPRS services.
EXAMPLE: E-UTRAN and NG-RAN are access technologies that are only supporting
GPRS services.
**Available PLMN:** For GERAN A/Gb mode see 3GPP TS 43.022 [35]. For UTRAN see
3GPP TS 25.304 [32]. For E-UTRAN see 3GPP TS 36.304 [43]. For NG-RAN see 3GPP
TS 38.304 [61]. For cdma2000^®^ 1xRTT and cdma2000^®^ HRPD see 3GPP2 C.S0016
[44].
**Available PLMN/access technology** **combination:** This is an available
PLMN in a specific access technology.
**Camped on a cell:** The MS (ME if there is no SIM) has completed the cell
selection/reselection process and has chosen a cell from which it plans to
receive all available services. Note that the services may be limited, and
that the PLMN may not be aware of the existence of the MS (ME) within the
chosen cell.
**Country: A country is identified by a single MCC value, with the exception
that MCC values 310 through 316 identify a single country (USA) and MCC values
404 through 406 identify a single country (India).**
**CSG whitelist:** See 3GPP TS 36.304 [43].
**Current serving cell:** This is the cell on which the MS is camped.
**CTS MS:** An MS capable of CTS services is a CTS MS.
**EAB:** Extended Access Barring, see 3GPP TS 22.011 [9].
**Extended Coverage in GSM for Internet of Things (EC-GSM-IoT):** Extended
coverage in GSM for IoT is a feature which enables extended coverage
operation. See 3GPP TS 43.064 [55].
**EHPLMN:** Any of the PLMN entries contained in the Equivalent HPLMN list.
**Equivalent HPLMN list:** To allow provision for multiple HPLMN codes, PLMN
codes that are present within this list shall replace the HPLMN code derived
from the IMSI for PLMN selection purposes. This list is stored on the USIM and
is known as the EHPLMN list. The EHPLMN list may also contain the HPLMN code
derived from the IMSI. If the HPLMN code derived from the IMSI is not present
in the EHPLMN list then it shall be treated as a Visited PLMN for PLMN
selection purposes.
**Generic Access Network (GAN):** See 3GPP TS 43.318 [35A].
**GAN mode:** See 3GPP TS 43.318 [35A].
**GPRS MS:** An MS capable of GPRS services is a GPRS MS.
**MS operation mode:** See 3GPP TS 23.060 [27].
**High quality signal:** The high quality signal limit is used in the PLMN
selection procedure. It is defined in the appropriate AS specification: 3GPP
TS 43.022 [35] for the GSM radio access technology, 3GPP TS 25.304 [32] for
the UMTS radio access technology (FDD or TDD mode), 3GPP TS 36.304 [43] for
the E‑UTRAN radio access technology, 3GPP TS 38.304 [61] for the NG-RAN radio
access technology. For 3GPP2 access technologies the high quality signal limit
is defined in 3GPP2 C.S0011 [45] for cdma2000^®^ 1xRTT and in 3GPP2 C.S0033
[46] for cdma2000^®^ HRPD. A mobile station attempting to find a cell that
supports EC-GSM-IoT (see 3GPP TS 43.064 [55]) does not use high quality signal
limit in the PLMN selection procedure, i.e. for the purpose of PLMN selection,
when attempting to find a cell that supports EC-GSM-IoT, any found cell
supporting EC-GSM-IoT is considered to be received with high quality signal.
**Home PLMN:** This is a PLMN where the MCC and MNC of the PLMN identity match
the MCC and MNC of the IMSI. Matching criteria are defined in Annex A.
**In A/Gb mode,...:** Indicates this clause applies only to a GSM system which
operates in A/Gb mode. For multi system case this is determined by the current
serving radio access network.
**In Iu mode,...:** Indicates this clause applies only to UMTS. For multi
system case this is determined by the current serving radio access network.
**In N1 mode,...:** Indicates this clause applies only to an 5GS. For multi
system case this is determined by the current serving radio access network.
**In S1 mode,...:** Indicates this clause applies only to an EPS. The S1 mode
includes WB-S1 mode and NB-S1 mode. For multi system case this is determined
by the current serving radio access network.
**In NB-S1 mode:** Indicates this paragraph applies only to a system which
operates in NB-S1 mode. For a multi-access system this case applies if the
current serving radio access network provides access to network services via
E-UTRA by NB-IoT (see 3GPP TS 36.300 [56], 3GPP TS 36.331 [22], 3GPP TS 36.306
[54]).
**In WB-S1 mode:** Indicates this paragraph applies only to a system which
operates in WB-S1 mode. For a multi-access system this case is applies if the
system operates in S1 mode, but not in NB-S1 mode.
**Localised Service Area (LSA):** A localised service area consists of a cell
or a number of cells. The cells constituting a LSA may not necessarily provide
contiguous coverage.
**Location Registration (LR):** An MS which is IMSI attached to non-GPRS
services only performs location registration by the Location Updating
procedure. A GPRS MS which is IMSI attached to GPRS services or to GPRS and
non-GPRS services performs location registration by the Routing Area Update
procedure only when in a network of network operation mode I. Both location
updating and routing area update procedures are performed independently by the
GPRS MS when it is IMSI attached to GPRS and non-GPRS services in a network of
network operation mode II (see 3GPP TS 23.060 [27]). An MS which is attached
via the E-UTRAN performs location registration by the tracking area update
procedure. An MS which is registered via the NG-RAN performs location
registration by the mobility registration update procedure.
**MS:** Mobile Station. The present document makes no distinction between MS
and UE.
**N1 mode capability:** Capability of the UE associated with an N1 NAS
signalling connection between the UE and network. The present document refers
to the N1 mode capability over 3GPP access only (see 3GPP TS 24.501 [64]).
**NarrowBand Internet of Things (NB-IoT):** NB-IoT is a non-backward
compatible variant of E-UTRAN supporting a reduced set of functionality. NB-
IoT allows access to network services via E-UTRA with a channel bandwidth
limited to 180 kHz (see 3GPP TS 36.300 [20], 3GPP TS 36.331 [42], 3GPP TS
36.306 [44]).
**Network Type:** The network type associated with HPLMN or a PLMN on the PLMN
selector (see 3GPP TS 31.102 [40]). The MS uses this information to determine
what type of radio carrier to search for when attempting to select a specific
PLMN. A PLMN may support more than one network type.
**Registered PLMN (RPLMN):** This is the PLMN on which certain LR outcomes
have occurred (see table 1). In a shared network the RPLMN is the PLMN defined
by the PLMN identity of the CN operator that has accepted the LR.
**Registration:** This is the process of camping on a cell of the PLMN and
doing any necessary LRs.
**Registration Area:** A registration area is an area in which mobile stations
may roam without a need to perform location registration. The registration
area corresponds to location area (LA) for performing location updating
procedure, to routing area for performing the GPRS attach or routing area
update procedures, and to a list of tracking areas (TAs) for performing the
EPS attach, tracking area update, or 5GS registration procedure.
The PLMN to which a cell belongs (PLMN identity):
\- for GERAN, in the system information (MCC + MNC part of LAI) broadcast as
specified in 3GPP TS 44.018 [34];
\- for UTRA, see the broadcast information as specified in 3GPP TS 25.331
[33];
\- for E-UTRA, see the broadcast information as specified in 3GPP TS 36.331
[42]; and
\- for NR, see the broadcast information as specified in 3GPP TS 38.331 [65]).
In a shared network a cell belongs to all PLMNs given in the system
information broadcasted as specified in 3GPP TS 44.018 [34] for GERAN, in 3GPP
TS 25.331 [33] for UTRAN, in 3GPP TS 36.331 [42] for E-UTRA, and in 3GPP TS
38.331 [65] for NR.
**Selected PLMN:** This is the PLMN that has been selected according to
subclause 3.1, either manually or automatically.
**Shared Network:** An MS considers a cell to be part of a shared network,
when multiple PLMN identities are received as specified in 3GPP TS 44.018 [34]
for GERAN, in 3GPP TS 25.331 [33] for UTRAN, in 3GPP TS 36.331 [42] for
E-UTRA, and in 3GPP TS 38.331 [65] for NR.
**SIM:** Subscriber Identity Module (see 3GPP TS 21.111 [38]). The present
document makes no distinction between SIM and USIM.
**SoLSA exclusive access:** Cells on which normal camping is allowed only for
MS with Localised Service Area (LSA) subscription.
**Suitable Cell:** This is a cell on which an MS may camp. It must satisfy
criteria which are defined for GERAN A/Gb mode in 3GPP TS 43.022 [35], for
UTRAN in 3GPP TS 25.304 [32], for E-UTRAN in 3GPP TS 36.304 [43] and for NG-
RAN see 3GPP TS 38.304 [61]. For 3GPP2 access technologies the criteria are
defined in 3GPP2 C.S0011 [45] for cdma2000^®^ 1xRTT and in 3GPP2 C.S0033 [46]
for cdma2000^®^ HRPD. For an MS in eCall only mode, a suitable cell must
further satisfy the criteria defined in subclause 4.4.3.1.1.
**Steering of Roaming (SOR):** A technique whereby a roaming UE is encouraged
to roam to a preferred roamed-to-network indicated by the HPLMN.
**Steering of Roaming information:** This consists of the following HPLMN
protected information (see 3GPP TS 33.501 [66]):
a) an indication of whether the UDM requests an acknowledgement from the UE
for successful reception of the steering of roaming information; and
b) one of the following:
1) list of preferred PLMN/access technology combinations with an indication
that it is included;
2) a secured packet with an indication that it is included; or
3) the HPLMN indication that \'no change of the \"Operator Controlled PLMN
Selector with Access Technology\" list stored in the UE is needed and thus no
list of preferred PLMN/access technology combinations is provided\'.
NOTE 2: The secured packet contains the list of preferred PLMN/access
technology combinations encapsulated with a security mechanism as described in
3GPP TS 31.115 [67].
**Visited PLMN** : This is a PLMN different from the HPLMN (if the EHPLMN list
is not present or is empty) or different from an EHPLMN (if the EHPLMN list is
present).
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.167 [57] apply:
**eCall over IMS**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.401 [58] apply:
**eCall only mode**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.501 [62] apply:
**NG-RAN**
# 2 General description of idle mode
When an MS is switched on, it attempts to make contact with a public land
mobile network (PLMN). The particular PLMN to be contacted may be selected
either automatically or manually.
The MS looks for a suitable cell of the chosen PLMN and chooses that cell to
provide available services, and tunes to its control channel. This choosing is
known as \"camping on the cell\". The MS will then register its presence in
the registration area of the chosen cell if necessary, by means of a location
registration (LR), GPRS attach, IMSI attach or registration procedure.
If the MS loses coverage of a cell, or find a more suitable cell, it reselects
onto the most suitable cell of the selected PLMN and camps on that cell. If
the new cell is in a different registration area, an LR request is performed.
If the MS loses coverage of a PLMN, either a new PLMN is selected
automatically, or an indication of which PLMNs are available is given to the
user, so that a manual selection can be made.
Registration is not performed by MSs only capable of services that need no
registration.
The purpose of camping on a cell in idle mode is fourfold:
a) It enables the MS to receive system information from the PLMN.
b) If the MS wishes to initiate a call, it can do this by initially accessing
the network on the control channel of the cell on which it is camped.
c) If the PLMN receives a call for the MS, it knows (in most cases) the
registration area of the cell in which the MS is camped. It can then send a
\"paging\" message for the MS on control channels of all the cells in the
registration area. The MS will then receive the paging message because it is
tuned to the control channel of a cell in that registration area, and the MS
can respond on that control channel.
d) It enables the MS to receive cell broadcast messages.
If the MS is unable to find a suitable cell to camp on, or the SIM is not
inserted, or if it receives certain responses to an LR request (e.g.,
\"illegal MS\"), it attempts to camp on a cell irrespective of the PLMN
identity, and enters a \"limited service\" state in which it can only attempt
to make emergency calls. An MS operating in NB-S1 mode, never attempts to make
emergency calls.
If the MS is in eCall only mode, it attempts to camp on a suitable cell and
enters an \"eCall inactive\" state in which it can only attempt an eCall over
IMS, or a call to a non-emergency MSISDN or URI for test or terminal
reconfiguration services as specified in 3GPP TS 31.102 [40].
If the MS is in eCall only mode and is unable to find a suitable cell to camp
on, it attempts to camp on an acceptable cell in limited service state, and
enters an \"eCall inactive\" state in which it can only attempt an eCall over
IMS.
While in eCall inactive state, the MS does not perform LR with the PLMN of the
cell on which the MS is camped.
In A/Gb mode, if the CTS MS is in CTS mode only or in automatic mode with CTS
preferred, it will start by attempting to find a CTS fixed part on which it is
enrolled.
The idle mode tasks can be subdivided into five processes:
\- PLMN selection;
\- CSG selection (Iu mode and S1 mode only);
\- Cell selection and reselection;
\- Location registration; and
\- CTS fixed part selection (A/Gb mode only).
In A/Gb mode, to make this initial CTS fixed part selection, the MS shall be
enrolled on at least one fixed part.
The relationship between these processes is illustrated in figure 1 in clause
5. The states and state transitions within each process are shown in figure
2a, figure 2b, and figure 3 in clause 5.
# 3 Requirements and technical solutions
The following clauses list the main requirements of idle mode operation and
give an outline of the technical solution.
## 3.1 PLMN selection and roaming
The MS normally operates on its home PLMN (HPLMN) or equivalent home PLMN
(EHPLMN). However, a visited PLMN (VPLMN) may be selected, e.g., if the MS
loses coverage. There are two modes for PLMN selection:
i) Automatic mode ‑ This mode utilizes a list of PLMN/access technology
combinations in priority order. The highest priority PLMN/access technology
combination which is available and allowable is selected.
ii) Manual mode ‑ Here the MS indicates to the user which PLMNs are available.
Only when the user makes a manual selection does the MS try to obtain normal
service on the VPLMN.
To prevent repeated attempts to have roaming service on a not allowed area
(i.e. LA or TA), when the MS is informed that an area is forbidden, the LA or
TA is added to a list of \"forbidden location areas for roaming\" or
\"forbidden tracking areas for roaming\" respectively which is stored in the
MS. These lists, if existing, are deleted when the MS is switched off or when
the SIM is removed, and periodically (with period in the range 12 to 24
hours). LA area restrictions are always valid for complete location areas
independent of possible subdivision into GPRS routing areas. The structure of
the routing area identifier (see 3GPP TS 23.003 [22A]) supports area
restriction on LA basis.
If a message with cause value #15 (see 3GPP TS 24.008 [23] and 3GPP TS 24.301
[23A]) is received by an MS, then the MS shall take the following actions
depending on the access technology in which the message was received:
GSM, GSM COMPACT or UTRAN:
The location area is added to the list of \"forbidden location areas for
roaming\" which is stored in the MS. The MS shall then search for a suitable
cell in the same PLMN but belonging to an LA or TA which is not in the
\"forbidden location areas for roaming\" or \"forbidden tracking areas for
roaming\" list respectively.
E-UTRAN:
The tracking area is added to the list of \"forbidden tracking areas for
roaming\" which is stored in the MS. The MS shall then search for a suitable
cell in the same PLMN but belonging to a TA or LA which is not in the
\"forbidden tracking areas for roaming\" or \"forbidden location areas for
roaming\" list respectively
NG-RAN:
The tracking area is added to the list of \"5GS forbidden tracking areas for
roaming\" which is stored in the MS. The MS shall then search for a suitable
cell in the same PLMN but belonging to a tracking area which is not in the
\"5GS forbidden tracking areas for roaming\" list.
A VPLMN is added to a list of \"forbidden PLMNs\" in the SIM and thereafter
that VPLMN will not be accessed by the MS when in automatic mode if a message
with cause value \"PLMN not allowed\" or \"Requested service option not
authorized in this PLMN\" is received by an MS in response to an LR request
from that VPLMN and:
\- the MS is configured to use timer T3245 as defined in 3GPP TS 24.008 [23]
and 3GPP TS 24.301 [23A];
\- the MS is not configured to use timer T3245 and the message is integrity-
protected;
\- the MS is not configured to use timer T3245, the message is not integrity-
protected and the MS does not maintain a list of PLMN-specific attempt
counters; or
\- the MS is not configured to use timer T3245, the message is not integrity-
protected, the MS maintains a list of PLMN-specific attempt counters and the
value of the PLMN-specific attempt counter for that VPLMN is equal to the MS
implementation specific maximum value as defined in 3GPP TS 24.008 [23] and
3GPP TS 24.301 [23A].
A PLMN is removed from the \"forbidden PLMNs\" list if, after a subsequent
manual selection of that PLMN, there is a successful LR or upon expiry of
timer T3245 if the MS is configured to use timer T3245. This list is retained
when the MS is switched off or the SIM is removed. The HPLMN (if the EHPLMN
list is not present or is empty) or an EHPLMN (if the EHPLMN list is present)
shall not be stored on the list of \"forbidden PLMNs\".
In A/Gb mode, an ME not supporting SoLSA may consider a cell with the escape
PLMN code (see 3GPP TS 23.073) to be a part of a PLMN belonging to the list of
\"forbidden PLMNs\".
Optionally the ME may store in its memory an extension of the \"forbidden
PLMNs\" list. The contents of the extension of the list shall be deleted when
the MS is switched off or the SIM is removed.
A VPLMN may be stored in the extension of the \"forbidden PLMNs\" list if a
message with cause value \"PLMN not allowed\" or \"Requested service option
not authorized in this PLMN\" is received by an MS in response to an LR
request from that VPLMN, and the following is valid:
\- the MS is not configured to use timer T3245, the message is not integrity-
protected, the MS maintains a list of PLMN-specific attempt counters and the
value of the PLMN-specific attempt counter for that VPLMN is less than an MS
implementation specific maximum value as defined in 3GPP TS 24.008 [23] and
3GPP TS 24.301 [23A].
If a message with cause value \"GPRS services not allowed in this PLMN\" or
\"EPS services not allowed in this PLMN\" is received by an MS in response to
an GPRS attach, routing area update, EPS attach or tracking area update
request or received in a network initiated GPRS detach or EPS detach request
(see 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A]) from a VPLMN, that VPLMN is
added to a list of \"forbidden PLMNs for GPRS service\" which is stored in the
MS and thereafter that VPLMN will not be accessed by the MS for GPRS service
when in automatic mode. This list is deleted when the MS is switched off or
when the SIM is removed. A PLMN is removed from the list of \"forbidden PLMNs
for GPRS service\" if:
\- after a subsequent manual selection of that PLMN, there is a successful
GPRS attach, Routing Area Update, EPS attach or Tracking Area Update;
\- the MS is configured to use timer T3245 and timer T3245 expires; or
\- the MS is not configured to use timer T3245, the MS maintains a list of
PLMN-specific PS-attempt counters as specified in 3GPP TS 24.008 [23] and 3GPP
TS 24.301 [23A], the value of the PLMN-specific PS-attempt counter for that
PLMN has a value greater than zero and less than the MS implementation-
specific maximum value as defined in clause 5.3.7b in 3GPP TS 24.301 [23A],
and T3247 expires.
The maximum number of possible entries in this list is implementation
dependant, but must be at least one entry. The HPLMN (if the EHPLMN list is
not present or is empty) or an EHPLMN (if the EHPLMN list is present) shall
not be stored on the list of \"forbidden PLMNs for GPRS service\".
An MS that is attaching for emergency bearer services or is attached for
emergency bearer services may access PLMNs in the list of \"forbidden PLMNs\"
or the list of \"forbidden PLMNs for GPRS service\". The MS shall not remove
any entry from the list of \"forbidden PLMNs\" or the list of \"forbidden
PLMNs for GPRS service\" as a result of such accesses.
A UE capable of S101 mode maintains a list \"forbidden PLMNs for attach in
S101 mode\"; the properties and handling in NAS signalling is defined in
subclause 5.3.3 of 3GPP TS 24.301 [23A].
If the MS is in GAN mode and a \"Location not allowed\" message is received
(see 3GPP TS 44.318 [35B]), then the MS may attempt to select another PLMN so
that further GAN registrations may again be attempted. The selection of the
PLMN either automatically or manually is implementation dependent.
If MS that has disabled its E-UTRA capability re-enables it when PLMN
selection is performed, then:
\- the MS should, for duration of timer TD, memorize the PLMNs where E-UTRA
capability was disabled as PLMNs where voice service was not possible in
E-UTRAN. The number of PLMNs where voice service was not possible in E-UTRAN
that the MS can store is implementation specific, but it shall be at least
one. The value of timer TD is MS implementation specific, but shall not exceed
the maximum possible value of background scanning timer T as specified in
subclause 4.4.3.3.1.
\- in automatic PLMN selection the MS shall not consider PLMNs where voice
service was not possible in E-UTRAN as PLMN selection candidates for E-UTRA
access technology, unless no other PLMN is available. This does not prevent
selection of such a PLMN if it is available in GERAN or UTRAN; and
\- the MS shall delete stored information on PLMNs where voice service was not
possible in E-UTRAN when the MS is switched off, the USIM is removed, timer TD
expires or MS voice domain configuration changes so that E-UTRA capability
disabling is no longer necessary.
The MS may support \"E-UTRA Disabling for EMM cause #15\" as specified in 3GPP
TS 24.301 [23A]. If the MS supports \"E-UTRA Disabling for EMM cause #15\" and
the \"E-UTRA Disabling Allowed for EMM cause #15\" parameter as specified in
3GPP TS 24.368 [50] or 3GPP TS 31.102 [40] is present and set to enabled:
\- the MS shall maintain a list of \"PLMNs with E-UTRAN not allowed\";
\- when the MS disables its E-UTRA capability on a PLMN due to E-UTRAN not
allowed, it shall add the PLMN to the \"PLMNs with E-UTRAN not allowed\" list,
and start timer TE if timer TE is not already running;
\- the number of PLMNs that the MS can store in the \"PLMNs with E-UTRAN not
allowed\" list is implementation specific, but it shall be at least one;
\- the value of timer TE is MS implementation specific, but it shall not
exceed the maximum possible value of background scanning timer T (8 hours or
240 hours for MSs supporting EC-GSM-IoT, Category M1 or Category NB1 as
defined in 3GPP TS 36.306 [54])) as specified in subclause 4.4.3.3.1;
\- in automatic PLMN selection the MS shall not consider PLMNs included in the
\"PLMNs with E-UTRAN not allowed\" list as PLMN selection candidates for
E-UTRAN access technology, unless no other PLMN is available. This does not
prevent selection of such a PLMN if it is available in GERAN or UTRAN; and
\- the MS shall delete stored information in the \"PLMNs with E-UTRAN not
allowed\" list when the MS is switched off, the USIM is removed or timer TE
expires.
The MS should maintain a list of PLMNs where the N1 mode capability was
disabled due to IMS voice not available and the MS's usage setting was \"voice
centric\" as PLMNs where voice service was not possible in N1 mode. When the
MS disables its N1 mode capability due to IMS voice not available and the MS's
usage setting was \"voice centric\":
\- the MS should add the identity of the PLMN to the list of PLMNs where voice
service was not possible in N1 mode and should start timer TF if timer TF is
not already running. The number of PLMNs that the MS can store where voice
services is not possible is implementation specific, but it shall be at least
one. The value of timer TF is MS implementation specific, but shall not exceed
the maximum possible value of background scanning timer T as specified in
subclause 4.4.3.3.1;
\- in automatic PLMN selection the MS shall not consider PLMNs where voice
service was not possible in N1 mode as PLMN selection candidates for NG-RAN
access technology, unless no other PLMN is available. This does not prevent
selection of such a PLMN if it is available in another RAT; and
\- the MS shall delete stored information on PLMNs where voice service was not
possible in N1 mode when the MS is switched off, the USIM is removed, timer TF
expires or the MS\'s usage setting changes so that N1 mode capability
disabling is no longer necessary.
The MS should maintain a list of PLMNs where the N1 mode capability was
disabled due to receipt of a reject from the network with 5GMM cause #27 \"N1
mode not allowed\", as PLMNs where N1 mode is not allowed. When the MS
disables its N1 mode capability due to receipt of a reject from the network
with 5GMM cause #27 \"N1 mode not allowed\":
\- the MS should add the identity of the PLMN to the list of PLMNs where N1
mode is not allowed and should start timer TG if timer TG is not already
running. The number of PLMNs that the MS can store where N1 mode is not
allowed is implementation specific, but it shall be at least one. The value of
timer TG is MS implementation specific, but shall not exceed the maximum
possible value of background scanning timer T as specified in subclause
4.4.3.3.1;
\- in automatic PLMN selection the MS shall not consider PLMNs where N1 mode
is not allowed as PLMN selection candidates for NG-RAN access technology,
unless no other PLMN is available. This does not prevent selection of such a
PLMN if it is available in another RAT; and
\- the MS shall delete stored information on PLMNs where N1 mode is not
allowed when the MS is switched off, the USIM is removed or timer TG expires.
The MS in NB-S1 mode may maintain a list of \"PLMNs with NB-IoT not allowed\"
where the NB-IoT capability was disabled due to receipt of a reject from the
network with EMM cause #15 \"no suitable cells in tracking area\" and an
Extended EMM cause IE with value \"NB-IoT not allowed\", as PLMNs where NB-S1
mode is not allowed. When the MS disables its NB-IoT capability due to receipt
of a reject from the network with EMM cause #15 \"no suitable cells in
tracking area\" and an Extended EMM cause IE with value \"NB-IoT not
allowed\":
\- the MS may add the identity of the PLMN to the list of \"PLMNs with NB-IoT
not allowed\" and start timer TH if timer TH is not already running. The
number of PLMNs that the MS can store in the \"PLMNs with NB-IoT not allowed\"
list is implementation specific, but it shall be at least one. The value of
timer TH is MS implementation specific, but shall not exceed the maximum
possible value of background scanning timer T as specified in subclause
4.4.3.3.1;
\- in automatic PLMN selection the MS shall not consider PLMNs included in the
\"PLMNs with NB-IoT not allowed\" list as PLMN selection candidates for NB-IoT
access technology, unless no other PLMN is available. This does not prevent
selection of such a PLMN if it is available in another RAT; and
\- the MS shall delete stored information in the \"PLMNs with NB-IoT not
allowed\" list when the MS is switched off, the USIM is removed or timer TH
expires.
## 3.1A CSG selection / restriction
If the MS supports CSG, it is provisioned with an Allowed CSG list and an
Operator CSG list and associated PLMN identities. Both lists can be retrieved
either from the USIM if the lists are available in the USIM, or as described
in 3GPP TS 24.285 [47] if the lists are not available in the USIM. These lists
have zero or more entries.
NOTE 1: The network also updates the Allowed CSG list in the same updating
operation if one or more entries are removed from the Operator CSG list. This
avoids an entry removed from the Operator CSG list remaining in the Allowed
CSG list.
There are two modes of CSG selection:
\- Automatic mode: This mode utilizes the Allowed CSG list and the Operator
CSG list. After a PLMN is selected, the MS camps on a cell in that PLMN only
if the cell is either not a CSG cell or it is a CSG cell with a CSG identity
that is in the Allowed CSG list or in the Operator CSG List. The idle mode
procedures of NAS are not impacted by this mode.
\- Manual mode: In this mode, the MS indicates to the user a list of available
CSGs and the associated PLMNs. Based on configuration by the HPLMN, the list
of CSGs provided to the user for a certain PLMN is either:
\- not restricted by the Allowed CSG list and the Operator CSG List stored in
the MS; or
\- restricted to entries in the Operator CSG List only.
After the user makes a selection, the MS camps on a cell with the selected CSG
identity and may attempt to register with the associated PLMN (see 3GPP TS
24.008 [23] and 3GPP TS 24.301 [23A]).
The CSG whitelist is a combination of Operator CSG list and the Allowed CSG
list. NAS shall provide the CSG whitelist to the AS. If the contents of the
CSG whitelist have changed, NAS shall provide an updated CSG whitelist to the
AS.
NOTE 2: The same CSG ID and its associated PLMN can exist in both the Operator
CSG list and the Allowed CSG list. Such duplicates can be removed when
combining these lists to form the CSG whitelist.
If an integrity protected message with cause value #25 (see 3GPP TS 24.008
[23] and 3GPP TS 24.301 [23A]) is received by an MS for a CSG ID and
associated PLMN identity present in the Operator CSG list, then for an
implementation dependent time which is not shorter than 60 minutes, or until
the MS is switched off, or the SIM/USIM is removed, or the Operator CSG list
is updated:
a) The NAS shall not include this CSG ID and the associated PLMN identity in
the CSG whitelist provided to the AS; and
b) In CSG manual mode selection, the MS shall not indicate to the user that
this CSG ID and the associated PLMN identity is in the Operator CSG List
stored in the MS.
NOTE 3: As an implementation option, the user can be informed that the MS has
not been authorized for a CSG included in the Operator CSG list.
## 3.1B PLMN selection triggered by ProSe direct communication
If the MS supports ProSe direct communication and needs to perform PLMN
selection for ProSe direct communication as specified in 3GPP TS 24.334 [51],
then the MS shall proceed as follows:
i) the MS shall store a duplicate value of the RPLMN and a duplicate of the
PLMN selection mode that were in use before PLMN selection due to ProSe direct
communication was initiated, unless this PLMN selection due to ProSe direct
communication follows another PLMN selection due to ProSe direct communication
or a manual CSG selection as specified in subclause 4.4.3.1.3.3;
ii) the MS shall enter into Automatic mode of PLMN selection as specified in
subclause 4.4 taking into account the additional requirements in items iii) to
x) below;
iii) Among the PLMNs advertised by the E-UTRA cell operating in the radio
resources provisioned to the MS for ProSe direct communication as specified in
3GPP TS 24.333 [52] or 3GPP TS 31.102 [40], the MS shall choose one allowable
PLMN which:
1) provides radio resources for ProSe direct communication;
2) is in the list of authorised PLMNs for ProSe direct communication as
specified in 3GPP TS 24.334 [51]; and
3) is not in the list of \"PLMNs with E-UTRAN not allowed\" as specified in
subclause 3.1;
if conditions 1) through 3) above are met then the MS shall attempt to
register on that PLMN. If none of the PLMNs meet conditions 1) through 3)
above, the MS shall return to the stored duplicate PLMN selection mode and use
the stored duplicate value of RPLMN for further action;
iv) if the registration fails due to \"PLMN not allowed\" or \"EPS services
not allowed\" as specified in 3GPP TS 24.334 [51], then the MS shall update
the appropriate list of forbidden PLMNs as specified in subclause 3.1, and
shall either:
A) if the PLMN provides common radio resources needed by the MS to do ProSe
direct communication as specified in 3GPP TS 36.331 [42], perform ProSe direct
communication on the selected PLMN in limited service state. In this case the
MS shall not search for available and allowable PLMNs during the duration of
ProSe direct communication;
B) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action; or
C) perform the action described in iii) again with the choice of PLMNs further
excluding the PLMNs on which the MS has failed to register.
Whether the MS performs A), B) or C) above is left up to MS implementation.
v) if the registration fails due to causes other than \"PLMN not allowed\" or
\"EPS services not allowed\", the MS shall:
\- if the handling of the failure requires updating a list of forbidden PLMNs,
update the appropriate list (as specified in 3GPP TS 24.301 [23A]); and
\- if the handling of the failure does not require updating a list of
forbidden PLMNs (as specified in 3GPP TS 24.301 [23A]), remember the PLMN as a
PLMN on which the MS has failed to register;
NOTE 1: How long the MS memorizes the PLMNs on which it has failed to register
is implementation dependent.
and the MS shall either:
A1) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action;
B1) perform the action described in iii) again with the choice of PLMNs
further excluding the PLMNs on which the MS has failed to register; or
C1) perform ProSe direct communication in limited service state on a PLMN
advertised by the cell operating in the radio resources provisioned to the MS
for ProSe direct communication as specified in 3GPP TS 24.333 [52] or 3GPP TS
31.102 [40], if registration on this PLMN has previously failed due to \"PLMN
not allowed\" or \"EPS services not allowed\" as specified in 3GPP TS 24.334
[51] and if this PLMN provides common radio resources needed by the MS to do
ProSe direct communication as specified in 3GPP TS 36.331 [42]. In this case
the MS shall not search for available and allowable PLMNs during the duration
of ProSe direct communication;
Whether the MS performs A1), B1) or C1) above is left up to MS implementation.
vi) if the MS is no longer in the coverage of the selected PLMN, then the MS
shall either:
A2) perform ProSe direct communication procedures for MS to use provisioned
radio resources as specified in 3GPP TS 24.334 [51]; or
B2) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action.
Whether the MS performs A2) or B2) above is left up to MS implementation.
vii) if the MS is unable to find a suitable cell on the selected PLMN as
specified in 3GPP TS 24.334 [51], then the MS shall either:
A3) if the PLMN provides common radio resources needed by the MS to do ProSe
direct communication as specified in 3GPP TS 36.331 [42], perform ProSe direct
communication on the selected PLMN in limited service state. In this case the
MS shall not search for available and allowable PLMNs during the duration of
ProSe direct communication; or
B3) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action.
Whether the MS performs A3) or B3) above is left up to MS implementation.
viii) if the MS is switched off while on the selected PLMN and switched on
again, the MS shall use the stored duplicate value of RPLMN as RPLMN and
behave as specified in subclause 4.4.3.1;
ix) if the user initiates a PLMN selection while on the selected cell, the MS
shall delete the stored duplicate value of PLMN selection mode, use the stored
duplicate value of RPLMN as RPLMN and follow the procedures (as specified for
switch-on or recovery from lack of coverage) in subclause 4.4.3.1. The MS
shall delete the stored duplicate value of RPLMN once the MS has successfully
registered to the selected PLMN; and
x) if the MS no longer needs to perform Prose direct communication, the MS
shall return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action.
NOTE 2: If the MS returns to the RPLMN due to a failure to register in the
selected PLMN, the upper layers of the MS can trigger PLMN selection again to
initiate ProSe direct communication.
If the PLMN selected for ProSe direct communication is a VPLMN, the MS shall
not periodically scan for higher priority PLMNs during the duration of ProSe
direct communication.
The solution to prevent potential ping-pong between the RPLMN and the PLMN
selected for ProSe direct communication is MS implementation specific.
## 3.1C PLMN selection triggered by V2X communication over PC5
If the MS supports V2X communication over PC5 and needs to perform PLMN
selection for V2X communication over PC5 as specified in 3GPP TS 24.386 [59],
then the MS shall proceed as follows:
i) the MS shall store a duplicate value of the RPLMN and a duplicate of the
PLMN selection mode that were in use before PLMN selection due to V2X
communication over PC5 was initiated, unless this PLMN selection due to V2X
communication over PC5 follows another PLMN selection due to V2X communication
over PC5 or a manual CSG selection as specified in subclause 4.4.3.1.3.3;
ii) the MS shall enter into Automatic mode of PLMN selection as specified in
subclause 4.4 taking into account the additional requirements in items iii) to
x) below;
iii) Among the PLMNs advertised by the E-UTRA cell operating in the radio
resources provisioned to the MS for V2X communication over PC5 as specified in
3GPP TS 24.385 [60] or 3GPP TS 31.102 [40], the MS shall choose one allowable
PLMN which:
1) provides radio resources for V2X communication over PC5;
2) is in the list of authorised PLMNs for V2X communication over PC5 as
specified in 3GPP TS 24.386 [59]; and
3) is not in the list of \"PLMNs with E-UTRAN not allowed\" as specified in
subclause 3.1;
if conditions 1) through 3) above are met then the MS shall attempt to
register on that PLMN. If none of the PLMNs meet conditions 1) through 3)
above, the MS shall return to the stored duplicate PLMN selection mode and use
the stored duplicate value of RPLMN for further action;
iv) if the registration fails due to \"PLMN not allowed\" or \"EPS services
not allowed\" as specified in 3GPP TS 24.386 [59], then the MS shall update
the appropriate list of forbidden PLMNs as specified in subclause 3.1, and
shall either:
A) if the PLMN provides common radio resources needed by the MS to do V2X
communication over PC5 as specified in 3GPP TS 36.331 [42], perform V2X
communication over PC5 on the selected PLMN in limited service state. In this
case the MS shall not search for available and allowable PLMNs during the
duration of V2X communication over PC5;
B) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action; or
C) perform the action described in iii) again with the choice of PLMNs further
excluding the PLMNs on which the MS has failed to register.
Whether the MS performs A), B) or C) above is left up to MS implementation.
v) if the registration fails due to causes other than \"PLMN not allowed\" or
\"EPS services not allowed\", the MS shall:
\- if the handling of the failure requires updating a list of forbidden PLMNs,
update the appropriate list (as specified in 3GPP TS 24.301 [23A]); and
\- if the handling of the failure does not require updating a list of
forbidden PLMNs (as specified in 3GPP TS 24.301 [23A]), remember the PLMN as a
PLMN on which the MS has failed to register;
NOTE 1: How long the MS memorizes the PLMNs on which it has failed to register
is implementation dependent.
and the MS shall either:
A1) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action;
B1) perform the action described in iii) again with the choice of PLMNs
further excluding the PLMNs on which the MS has failed to register; or
C1) perform V2X communication over PC5 in limited service state on a PLMN
advertised by the cell operating in the radio resources provisioned to the MS
for V2X communication over PC5 as specified in 3GPP TS 24.385 [60] or 3GPP TS
31.102 [40], if registration on this PLMN has previously failed due to \"PLMN
not allowed\" or \"EPS services not allowed\" as specified in 3GPP TS 24.386
[59] and if this PLMN provides common radio resources needed by the MS to do
V2X communication over PC5 as specified in 3GPP TS 36.331 [42]. In this case
the MS shall not search for available and allowable PLMNs during the duration
of V2X communication over PC5;
Whether the MS performs A1), B1) or C1) above is left up to MS implementation.
vi) if the MS is no longer in the coverage of the selected PLMN, then the MS
shall either:
A2) perform V2X communication over PC5 procedures for MS to use provisioned
radio resources as specified in 3GPP TS 24.386 [59]; or
B2) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action.
Whether the MS performs A2) or B2) above is left up to MS implementation.
vii) if the MS is unable to find a suitable cell on the selected PLMN as
specified in 3GPP TS 24.386 [59], then the MS shall either:
A3) if the PLMN provides common radio resources needed by the MS to do V2X
communication over PC5 as specified in 3GPP TS 36.331 [42], perform V2X
communication over PC5 on the selected PLMN in limited service state. In this
case the MS shall not search for available and allowable PLMNs during the
duration of V2X communication over PC5; or
B3) return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action.
Whether the MS performs A3) or B3) above is left up to MS implementation.
viii) if the MS is switched off while on the selected PLMN and switched on
again, the MS shall use the stored duplicate value of RPLMN as RPLMN and
behave as specified in subclause 4.4.3.1;
ix) if the user initiates a PLMN selection while on the selected cell, the MS
shall delete the stored duplicate value of PLMN selection mode, use the stored
duplicate value of RPLMN as RPLMN and follow the procedures (as specified for
switch-on or recovery from lack of coverage) in subclause 4.4.3.1. The MS
shall delete the stored duplicate value of RPLMN once the MS has successfully
registered to the selected PLMN; and
x) if the MS no longer needs to perform V2X communication over PC5, the MS
shall return to the stored duplicate PLMN selection mode and use the stored
duplicate value of RPLMN for further action.
NOTE 2: If the MS returns to the RPLMN due to a failure to register in the
selected PLMN, the upper layers of the MS can trigger PLMN selection again to
initiate V2X communication over PC5.
If the PLMN selected for V2X communication over PC5 is a VPLMN, the MS shall
not periodically scan for higher priority PLMNs during the duration of V2X
communication over PC5.
The solution to prevent potential ping-pong between the RPLMN and the PLMN
selected for V2X communication over PC5 is MS implementation specific.
## 3.2 Regional provision of service
An MS may have a \"regionally restricted service\" where it can only obtain
service on certain areas (i.e. LAs or TAs). If such an MS attempts to camp on
a cell of an area for which it does not have service entitlement, when it does
an LR request, it will receive a message with cause value #12 (see 3GPP TS
24.008 [23] and 3GPP TS 24.301 [23A]). In this case, the MS shall take the
following actions depending on the access technology in which the message was
received:
GSM, GSM COMPACT or UTRAN:
\- The MS stores the forbidden LA identity (LAI) in a list of \"forbidden
location areas for regional provision of service\", to prevent repeated access
attempts on a cell of the forbidden LA. This list is deleted when the MS is
switched off or the SIM is removed. The MS enters the limited service state.
E-UTRAN:
The MS stores the forbidden TA identity (TAI) in a list of \"forbidden
tracking areas for regional provision of service\", to prevent repeated access
attempts on a cell of the forbidden TA. This list is deleted when the MS is
switched off or the SIM is removed. The MS enters the limited service state.
NG-RAN:
The MS stores the forbidden TA identity (TAI) in a list of \"5GS forbidden
tracking areas for regional provision of service\", to prevent repeated access
attempts on a cell of the forbidden TA. This list is deleted when the MS is
switched off or the SIM is removed. The MS enters the limited service state.
In A/Gb mode, a cell may be reserved for SoLSA exclusive access (see 3GPP TS
24.008 [23] and 3GPP TS 44.060 [39]). An MS is only allowed to camp normally
on such a cell if it has a Localised Service Area subscription to the cell.
Other MS may enter the limited service state.
NOTE: In A/Gb mode, in a SoLSA exclusive cell the MCC+MNC code is replaced by
a unique escape PLMN code (see 3GPP TS 23.073), not assigned to any PLMN, in
SI3 and SI4. An MS not supporting SoLSA may request for location update to an
exclusive access cell. In this case the location attempt is rejected with the
cause \"PLMN not allowed\" and the escape PLMN code is added to the list of
the \"forbidden PLMNs\".
## 3.3 Borders between registration areas
If the MS is moving in a border area between registration areas, it might
repeatedly change between cells of different registration areas. Each change
of registration area would require an LR, which would cause a heavy signalling
load and increase the risk of a paging message being lost. The access stratum
shall provide a mechanism to limit this effect.
## 3.4 Access control
### 3.4.1 Access control
Due to problems in certain areas, network operators may decide to restrict
access from some MSs (e.g., in case of congestion), and for this reason, a
mechanism for common access control is provided. In A/Gb mode and Iu mode a
mechanism for domain specific access control is also provided (see 3GPP TS
43.022 [35], 3GPP TS 44.018 [34] and 3GPP TS 25.304 [32]).
A mechanism to restrict access is provided via EAB. A network operator can
restrict network access of those MSs that are configured for EAB in addition
to common access control and domain specific access control.
The MS can be configured for EAB in the USIM (see 3GPP TS 31.102 [40]) or in
the ME (see 3GPP TS 24.368 [50]). An MS that supports EAB shall follow the EAB
mechanism (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A], 3GPP TS 44.018 [34],
3GPP TS 25.331 [33], 3GPP TS 36.331 [42]) when configured for EAB.
The MS can be configured for ACDC in the USIM (see 3GPP TS 31.102 [40]) or in
the ME (see 3GPP TS 24.105 [53]). An MS that supports ACDC shall follow the
ACDC mechanism (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A], 3GPP TS 25.331
[33], 3GPP TS 36.331 [42]) when configured for ACDC.
The MS can be configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME
(see 3GPP TS 24.368 [50]) to override EAB. An MS that supports overriding EAB
shall follow the overriding EAB mechanism (see 3GPP TS 24.008 [23], 3GPP TS
24.301 [23A]) when configured to allow overriding EAB.
In the case that a network operator decides to restrict access they may as an
option allow restricted MSs to respond to paging messages and/or to perform
location registrations. Mechanisms to allow this optional access are provided
(see 3GPP TS 25.304 [32]).
A network operator can also restrict some MSs to access the network for
location registration, although via common access class control or domain
specific access class control the MSs are permitted to access the network for
other purposes.
If the MS is accessing the network with a special access class (Access classes
11 to 15), then the MS shall ignore EAB and ACDC.
NOTE: The conditions when the MS is allowed to access the network with access
class 11 -- 15 are specified in 3GPP TS 22.011 [138].
If an MS configured for EAB is initiating an emergency call, then the MS shall
ignore EAB.
If an MS configured for EAB is responding to paging, then the MS shall ignore
EAB.
If an MS configured for ACDC is responding to paging, then the MS shall ignore
ACDC.
If an MS configured for ACDC is initiating an emergency call, then the MS
shall ignore ACDC.
If an MS configured for ACDC and the MO MMTEL voice call is started, the MO
MMTEL video call is started or the MO SMSoIP is started (see 3GPP TS 24.008
[23], 3GPP TS 24.301 [23A]), then the MS shall ignore ACDC.
### 3.4.2 Forbidden LA or TA for regional provision of service
The MS is not allowed to initiate establishment of a CM connection except for
an emergency call when camped on a cell of an LA or TA of which belongs to the
list of \"forbidden location areas for regional provision of service\" or
\"forbidden tracking areas for regional provision of service\". The MS may
respond to paging.
The MS is not allowed to request GPRS services except for an emergency bearer
services when camped on a cell of an LA or TA of which belongs to the list of
\"forbidden location areas for regional provision of service\" or \"forbidden
tracking areas for regional provision of service\".
The MS is not allowed to request 5GS services except emergency services when
camped on a cell of a TA of which belongs to the list of \"5GS forbidden
tracking areas for regional provision of service\".
## 3.5 No suitable cell (limited service state)
There are a number of situations in which the MS is unable to obtain normal
service from a PLMN. These include:
a) Failure to find a suitable cell of the selected PLMN;
b) No SIM in the MS;
c) A \"PLMN not allowed\" response when an LR is received;
d) An \"illegal MS\" or \"illegal ME\" response when an LR is received (Any
SIM in the ME is then considered \"invalid\");
e) An \"IMSI unknown in HLR\" response when an LR is received (Any SIM in the
ME is then considered \"invalid\" for non-GPRS services);
f) A \"GPRS services not allowed\" response when an LR of a GPRS MS attached
to GPRS services only is received (The cell selection state of GPRS MSs
attached to GPRS and non-GPRS depends on the outcome of the location
updating), or an \"EPS services not allowed\" response is received when an EPS
attach, tracking area update or service request is performed, or a \"5GS
services not allowed\" response is received when a registration or service
request is performed; or
g) Power saving mode (PSM) is activated (see 3GPP TS 23.682 [27A]).
(In automatic PLMN selection mode, items a, c and f would normally cause a new
PLMN selection, but even in this case, the situation may arise when no PLMNs
are available and allowable for use).
For the items a to f, the MS attempts to camp on an acceptable cell,
irrespective of its PLMN identity, so that emergency calls can be made if
necessary, with the exeption that an MS operating in NB-S1 mode, shall never
attempt to make emergency calls. When in the limited service state with a
valid SIM, the MS shall search for available and allowable PLMNs in the manner
described in subclause 4.4.3.1 and when indicated in the SIM also as described
in subclause 4.4.3.4. For an MS that is not in eCall only mode, with the
exception of performing GPRS attach or EPS attach for emergency bearer
services, or performing registration for emergency services, no LR requests
are made until a valid SIM is present and either a suitable cell is found or a
manual network reselection is performed. For an MS in eCall only mode, no LR
requests are made except for performing EPS attach for emergency bearer
services or registration for emergency services. When performing GPRS attach
or EPS attach for emergency bearer services, or registration for emergency
services, the PLMN of the current serving cell is considered as the selected
PLMN for the duration the MS is attached for emergency bearer services or
registered for emergency services. In the limited service state the presence
of the MS need not be known to the PLMN on whose cell it has camped.
There are also other conditions under which only emergency calls may be made.
These are shown in table 2 in clause 5. ProSe direct communication and ProSe
direct discovery for public safety use can be initiated if necessary (see 3GPP
TS 24.334 [51]) when in the limited service state due to items a) or c) or f).
V2X communication over PC5 can be initiated if necessary (see 3GPP TS 24.386
[59]) when in the limited service state due to items a) or c) or f).
## 3.6 CTS fixed part selection (A/Gb mode only)
In CTS mode only or in automatic mode with CTS preferred, the CTS MS normally
operates on a CTS fixed part on which the mobile station is already enrolled.
If the CTS MS loses CTS coverage in these modes, it shall attempt periodically
to select again a CTS fixed part.
To select a CTS fixed part, the CTS MS shall listen to the CTSBCH frequencies
of all the fixed parts on which the MS is currently enrolled.
If the CTS MS is moving in a border area between one area with CTS coverage
and one without it, it might repeatedly require CTS attachments and LU on the
PLMN. To prevent this, the criteria C1_CTS and C2_CTS (defined in 3GPP TS
45.008 [25] subclause 11.1) are used. To attach to a CTS FP, the C1_CTS
criterion shall be greater than zero. When the C2_CTS criterion falls below
zero, the CTS MS shall consider itself to be no more under CTS coverage.
## 3.7 NAS behaviour configuration
NAS behaviour can be operator configurable using parameters in the USIM (see
3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]). For parameters
available in both the USIM and the ME, precedence is specified in 3GPP TS
31.102 [40] subclause 5.2.29.
# 4 Overall process structure
## 4.1 Process goal
The aim of the idle mode processes is to ensure that the registered PLMN is
the selected PLMN.
## 4.2 States description
Each of the processes of PLMN selection, cell selection and location
registration can be described by a set of states. The overall state of the
mobile is thus a composite of the states of the three processes. In some
cases, an event which causes a change of state in one process may trigger a
change of state in another process, e.g., camping on a cell in a new
registration area triggers an LR request. The relationship between the
processes is illustrated in figure 1 in clause 5.
The states in which the MS may be, for each of the processes, are described
below and illustrated in figures 2a, 2b and 3 in clause 5. For many of the
states, a fuller description can be found in other Technical Specifications,
and a reference to the Technical Specification is given after the state
description.
In the event of any conflict between the diagrams and the text in the present
document, the text takes precedence.
## 4.3 List of states
### 4.3.1 List of states for the PLMN selection process
#### 4.3.1.1 List of states for automatic mode (figure 2a)
A1 Trying RPLMN ‑ The MS is trying to perform a Location Registration on the
registered PLMN.
A2 On PLMN ‑ The MS has successfully registered on a PLMN.
A3 Trying PLMN ‑ The MS is trying to register on a PLMN in the ordered list of
PLMNs.
A4 Wait for PLMNs to appear ‑ There are no allowable and available PLMNs at
present and the MS is waiting for one to appear.
A5 HPLMN search in progress ‑ The MS is trying to find if the HPLMN is
available.
A6 No SIM ‑ There is no SIM in the MS, or certain LR responses have been
received.
#### 4.3.1.2 List of states for manual mode (figure 2b)
M1 Trying registered PLMN ‑ The MS is trying to perform a Location
Registration on the registered PLMN.
M2 On PLMN ‑ The MS has successfully registered on a PLMN.
M3 Not on PLMN ‑ The MS has failed to register on the selected PLMN.
M4 Trying PLMN ‑ The MS is trying to register on a user selected PLMN.
M5 No SIM ‑ There is no SIM in the MS, or certain LR responses have been
received.
### 4.3.2 Void
### 4.3.3 List of states for location registration (figure 3)
The states are entered depending on responses to location registration (LR)
requests. Independent update states exist for GPRS and for non-GPRS operation
in MSs capable of GPRS and non-GPRS services.
L0 Null -- The MS is considered in this state when switched off.
L1 Updated ‑ The MS enters this state if an LR request is accepted. The update
status is set to \"UPDATED\". The GPRS and the non-GPRS update state of a MS
may enter \"Updated\" as a result of combined signalling or as a result of
individual signalling depending on the capabilities of the network.
L2 Idle, No IMSI ‑ The MS enters this state if an LR request is rejected with
cause:
a) IMSI unknown in HLR;
b) illegal ME;
c) illegal MS;
d) GPRS services not allowed,
e) GPRS services and non-GPRS services not allowed,
or if there is no SIM. All update states of a MS enter this state regardless
whether received by individual or combined signalling for events b) and c).
Event a) has no influence on the GPRS update state. Events b) and c) result in
\"ROAMING NOT ALLOWED\" for the GPRS and/or non-GPRS update status depending
on the specific location registration procedure. Event d) results in \"ROAMING
NOT ALLOWED\" for the GPRS update status. Event e) results in \"ROAMING NOT
ALLOWED\" for the GPRS update status and non-GPRS update status.
If a SIM is present, the non-GPRS update status of the SIM is set to \"ROAMING
NOT ALLOWED\".
L3 Roaming not allowed ‑ The MS enters this state if it receives an LR reject
message with the cause:
a) PLMN not allowed;
b) Location area not allowed;
c) Tracking area not allowed;
d) Roaming not allowed in this location area;
e) Roaming not allowed in this tracking area;
f) GPRS services not allowed in this PLMN;
g) No suitable cells in location area;
h) No suitable cells in tracking area;
i) Not authorized for this CSG.
Except from event f) all update states of the MS are set to \"Roaming not
allowed\" regardless whether received by individual or combined signalling.
Event f) results in \"Roaming not allowed\" for the GPRS update state only.
Event f) has no influence on the non-GPRS update state. The behaviour of the
MS in the roaming not allowed state is dependent on the LR reject cause as
shown in table 2 in clause 5. Additionally:
\- in automatic mode, \"PLMN not allowed\", \"Roaming not allowed in this
location area\" and \"Roaming not allowed in this tracking area\" cause the
Automatic Network Selection procedure of subclause 4.4.3.1.1 to be started; it
is also caused by \"GPRS services not allowed in this PLMN\" when received by
a GPRS MS operating in MS operation mode C;
\- in manual mode, \"PLMN not allowed\" and \"Roaming not allowed\" cause the
Manual Network Selection procedure of subclause 4.4.3.1.2 to be started; it is
also caused by \"GPRS services not allowed in this PLMN\" when received by a
GPRS MS operating in MS operation mode C.
L4 Not updated ‑ The MS enters this state if any LR failure not specified for
states L2 or L3 occurs, in which cases the MS is not certain whether or not
the network has received and accepted the LR attempt. The non-GPRS update
status on the SIM and/or the GPRS update status are set to \"NOT UPDATED\"
depending on the specific location registration procedure and their outcome.
L5 LR request -- The MS enters this state when determining that a LR request
is to be made.
L6 LR pending -- The MS enters this state after having started the LR, waiting
for the outcome (response message from the network).
NOTE This clause does not describe all the cases. For more details refer to
3GPP TS 24.008 [23]
## 4.4 PLMN selection process
### 4.4.1 Introduction
There are two modes for PLMN selection, automatic and manual. These are
described in subclauses 4.4.3 below and illustrated in figures 2a to 2b in
clause 5.
### 4.4.2 Registration on a PLMN
The MS shall perform registration on the PLMN if the MS is capable of services
which require registration. In both automatic and manual modes, the concept of
registration on a PLMN is used. An MS successfully registers on a PLMN if:
a) The MS has found a suitable cell of the PLMN to camp on; and
b) An LR request from the MS has been accepted in the registration area of the
cell on which the MS is camped (see table 1).
### 4.4.3 PLMN selection
The registration on the selected PLMN and the location registration are only
necessary if the MS is capable of services which require registration.
Otherwise, the PLMN selection procedures are performed without registration.
The ME shall utilise all the information stored in the SIM related to the PLMN
selection; e.g. \"HPLMN Selector with Access Technology\", \"User Controlled
PLMN Selector with Access Technology\", \"Forbidden PLMNs\", \"Equivalent
HPLMN\", see 3GPP TS 31.102 [40].
The ME shall either utilise the \"Operator controlled PLMN Selector with
Access Technology\" that it has stored locally on the ME, or the Operator
controlled PLMN Selector with Access Technology\" stored in the SIM, for the
purposes of PLMN selection.
The \"HPLMN Selector with Access Technology\", \"User Controlled PLMN Selector
with Access Technology\" and \"Operator Controlled PLMN Selector with Access
Technology\" data files in the SIM include associated access technologies for
each PLMN entry, see 3GPP TS 31.102 [40]. The PLMN/access technology
combinations are listed in priority order. If an entry indicates more than one
access technology, then no priority is defined for the access technologies
within this entry and the priority applied to each access technology within
this entry is an implementation issue. If no particular access technology is
indicated in an entry, it shall be assumed that all access technologies
supported by the ME apply to the entry. If an entry only indicates access
technologies not supported by the ME, the entry shall be ignored. If an entry
indicates at least one access technology supported by the ME, the entry shall
be used in the PLMN selection procedures if the other criteria defined for the
specific PLMN selection procedures are fulfilled.
The Mobile Equipment stores a list of \"equivalent PLMNs\". This list is
replaced or deleted at the end of each location update procedure, routing area
update procedure, GPRS attach procedure, tracking area update procedure, EPS
attach procedure, and registration procedure. The list is deleted by an MS
attached for emergency bearer services after detach or registered for
emergency services after deregistration. The stored list consists of a list of
equivalent PLMNs as downloaded by the network plus the PLMN code of the
registered PLMN that downloaded the list. All PLMNs in the stored list, in all
access technologies supported by the PLMN, are regarded as equivalent to each
other for PLMN selection, cell selection/re-selection and handover.
When the MS reselects to a cell in a shared network, and the cell is a
suitable cell for multiple PLMN identities received on the BCCH or on the EC-
BCCH the AS indicates these multiple PLMN identities to the NAS according to
3GPP TS 44.018 [34], 3GPP TS 44.060 [39], 3GPP TS 25.304 [32], 3GPP TS 36.304
[43] and 3GPP TS 38.304 [61]. The MS shall choose one of these PLMNs. If the
registered PLMN is available among these PLMNs, the MS shall not choose a
different PLMN.
The MS shall not use the PLMN codes contained in the \"HPLMN Selector with
Access Technology\" data file.
It is possible for the home network operator to identify alternative Network
IDs as the HPLMN. If the EHPLMN list is present, and not empty, the entries in
the EHPLMN list are used in the network selection procedures. When attempting
to select a network the highest priority EHPLMN that is available shall be
selected. If the EHPLMN list is present and is empty or if the EHPLMN list is
not present, the HPLMN derived from the IMSI is used for network selection
procedures.
NOTE 1: The \"HPLMN Selector with Access Technology\" data file is only used
by the MS to get the HPLMN access technologies related to the HPLMN code which
corresponds to the PLMN code included in the IMSI if the EHPLMN list is not
present or is empty. If the EHPLMN list is present then this data field is
applicable to all the entries within the EHPLMN list.
NOTE 2: Different GSM frequency bands (e.g. 900, 1800, 1900, 400) are all
considered GSM access technology. An MS supporting more than one band should
scan all the bands it's supports when scanning for GSM frequencies. However
GSM COMPACT systems which use GSM frequency bands but with the CBPCCH
broadcast channel are considered as a separate access technology from GSM.
NOTE 3: The inclusion of the HPLMN derived from the IMSI in the EHPLMN list is
allowed. The priority of the HPLMN derived from the IMSI is given by its
position in the EHPLMN list, see 3GPP TS 31.102 [40].
#### 4.4.3.1 At switch‑on or recovery from lack of coverage
At switch on, or following recovery from lack of coverage, the MS selects the
registered PLMN or equivalent PLMN (if it is available) using all access
technologies that the MS is capable of and if necessary (in the case of
recovery from lack of coverage, see subclause 4.5.2) attempts to perform a
Location Registration.
NOTE 1: The MS in automatic network selection mode can end the PLMN search
procedure once the registered PLMN or equivalent PLMN is found on an access
technology.
NOTE 2: An MS in automatic network selection mode can use location information
to determine which PLMNs can be available in its present location.
EXCEPTION: As an alternative option to this, if the MS is in automatic network
selection mode and it finds coverage of an EHPLMN, the MS may register to that
EHPLMN and not return to the registered PLMN or equivalent PLMN. If the EHPLMN
list is not present or is empty, and the HPLMN is available, the MS may
register on the HPLMN and not return to the registered PLMN or equivalent
PLMN. The operator shall be able to control by SIM configuration whether an MS
that supports this option is permitted to perform this alternative behaviour.
EXCEPTION: In A/Gb mode an MS with voice capability, shall not search for
CPBCCH carriers. In A/Gb mode an MS not supporting packet services shall not
search for CPBCCH carriers.
If successful registration is achieved, the MS indicates the selected PLMN.
If there is no registered PLMN, or if registration is not possible due to the
PLMN being unavailable or registration failure, the MS follows one of the
following two procedures depending on its PLMN selection operating mode. At
switch on, if the MS provides the optional feature of user preferred PLMN
selection operating mode at switch on then this operating mode shall be used.
Otherwise, the MS shall use the PLMN selection mode that was used before
switching off.
EXCEPTION: At switch on, if the MS is in manual mode and neither registered
PLMN nor PLMN that is equivalent to it is available but EHPLMN is available,
then instead of performing the manual network selection mode procedure of
subclause 4.4.3.1.2 the MS may select and attempt registration on the highest
priority EHPLMN. If the EHPLMN list is not available or is empty and the HPLMN
is available, then the MS may select and attempt registration on the HPLMN.
The MS shall remain in manual mode.
NOTE 3: If successful registration is achieved, then the current serving PLMN
becomes the registered PLMN and the MS does not store the previous registered
PLMN for later use.
EXCEPTION: If registration is not possible on recovery from lack of coverage
due to the registered PLMN being unavailable, an MS attached to GPRS services,
attached via E-UTRAN or registered via the NG-RAN may, optionally, continue
looking for the registered PLMN for an implementation dependent time.
NOTE 4: An MS attached to GPRS services, attached via E-UTRAN or registered
via the NG-RAN should use the above exception only if one or more PDP
contexts, PDN connections or PDU sessions are currently active.
##### 4.4.3.1.1 Automatic Network Selection Mode Procedure
The MS selects and attempts registration on other PLMN/access technology
combinations, if available and allowable, in the following order:
i) either the HPLMN (if the EHPLMN list is not present or is empty) or the
highest priority EHPLMN that is available (if the EHPLMN list is present) ;
ii) each PLMN/access technology combination in the \"User Controlled PLMN
Selector with Access Technology\" data file in the SIM (in priority order);
iii) each PLMN/access technology combination in the \"Operator Controlled PLMN
Selector with Access Technology\" data file in the SIM (in priority order);
iv) other PLMN/access technology combinations with received high quality
signal in random order;
v) other PLMN/access technology combinations in order of decreasing signal
quality.
When following the above procedure the following requirements apply:
a) An MS with voice capability shall ignore PLMNs for which the MS has
identified at least one GSM COMPACT.
b) In A/Gb mode or GSM COMPACT, an MS with voice capability, or an MS not
supporting packet services shall not search for CPBCCH carriers.
c) In ii and iii, the MS should limit its search for the PLMN to the access
technology or access technologies associated with the PLMN in the appropriate
PLMN Selector with Access Technology list (User Controlled or Operator
Controlled selector list).
An MS using a SIM without access technology information storage (i.e. the
\"User Controlled PLMN Selector with Access Technology\" and the \"Operator
Controlled PLMN Selector with Access Technology\" data files are not present)
shall instead use the \"PLMN Selector\" data file, for each PLMN in the \"PLMN
Selector\" data file, the MS shall search for all access technologies it is
capable of. The priority ordering amongst the access technologies is
implementation dependent.
d) In iv and v, the MS shall search for all access technologies it is capable
of, before deciding which PLMN to select.
e) In ii, and iii, a packet only MS which supports GSM COMPACT, but using a
SIM without access technology information storage (i.e. the \"User Controlled
PLMN Selector with Access Technology\" and the \"Operator Controlled PLMN
Selector with Access Technology\" data files are not present) shall instead
use the \"PLMN Selector\" data file, for each PLMN in the \"PLMN Selector\"
data file, the MS shall search for all access technologies it is capable of
and shall assume GSM COMPACT access technology as the lowest priority radio
access technology.
f) In i, the MS shall search for all access technologies it is capable of. No
priority is defined for the preferred access technology and the priority is an
implementation issue, but \"HPLMN Selector with Access Technology\" data file
on the SIM may be used to optimise the procedure.
g) In i, an MS using a SIM without access technology information storage (i.e.
the \"HPLMN Selector with Access Technology\" data file is not present) shall
search for all access technologies it is capable of. The priority ordering
amongst the access technologies is implementation dependent. A packet only MS
which supports GSM COMPACT using a SIM without access technology information
storage shall also assume GSM COMPACT access technology as the lowest priority
radio access technology.
NOTE 1: For f) and g), the MS in automatic network selection mode can end the
PLMN search procedure once the HPLMN or the highest priority EHPLMN is found
on an access technology.
NOTE 2: For i, ii and iii, the MS can use location information to determine
which PLMNs can be available in its present location.
h) In v, the MS shall order the PLMN/access technology combinations in order
of decreasing signal quality within each access technology. The order between
PLMN/access technology combinations with different access technologies is an
MS implementation issue.
NOTE 3: Requirements a) and b) apply also to requirement d), so a GSM voice
capable MS should not search for GSM COMPACT PLMNs, even if capable of GSM
COMPACT.
NOTE 4: Requirements a) and b) apply also to requirement f), so a GSM voice
capable MS should not search for GSM COMPACT PLMNs, even if this is the only
access technology on the \"HPLMN Selector with Access Technology\" data file
on the SIM.
NOTE 5: High quality signal is defined in the appropriate AS specification.
i) In i to v, the MS shall not consider PLMNs where voice service was not
possible as PLMN selection candidate, unless such PLMN is available in GERAN
or UTRAN or no other allowed PLMN is available.
j) In i to v, if the MS only supports EMM-REGISTERED without PDN connection
(see 3GPP TS 24.301 [23A]), the MS shall not consider PLMNs which do not
advertise support of EMM-REGISTERED without PDN connection.
k) In i to v, if the MS only supports control plane CIoT EPS optimization (see
3GPP TS 24.301 [23A]) and the UE camps on a E-UTRA cell which is not NB-IoT
cell (see 3GPP TS 36.304 [43], 3GPP TS 36.331 [22]), the MS shall not consider
PLMNs which do not advertise support of EPS services with control plane CIoT
EPS optimization.
l) In i to v, if the MS is in eCall only mode, the MS shall not consider PLMNs
which do not advertise support for eCall over IMS, unless such PLMNs are
available in GERAN or UTRAN.
NOTE 6: As an implementation option, an MS in eCall only mode that was not
able to select any PLMN according to l) can perform a second iteration of i to
v with no restriction.
If successful registration is achieved, the MS indicates the selected PLMN.
If registration cannot be achieved because no PLMNs are available and
allowable, the MS indicates \"no service\" to the user, waits until a new PLMN
is available and allowable and then repeats the procedure.
If there were one or more PLMNs which were available and allowable, but an LR
failure made registration on those PLMNs unsuccessful or an entry in any of
the lists \"forbidden location areas for roaming\", \"forbidden tracking areas
for roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden
location areas for regional provision of service\", \"forbidden tracking areas
for regional provision of service\" or \"5GS forbidden tracking areas for
regional provision of service\" prevented a registration attempt, the MS
selects the first such PLMN again and enters a limited service state.
##### 4.4.3.1.2 Manual Network Selection Mode Procedure
The MS indicates whether there are any PLMNs, which are available using all
supported access technologies. This includes PLMNs in the \"forbidden PLMNs\"
list, \"forbidden PLMNs for GPRS service\" list and PLMNs which only offer
services not supported by the MS. An MS which supports GSM COMPACT shall also
indicate GSM COMPACT PLMNs (which use PBCCH).
If displayed, PLMNs meeting the criteria above are presented in the following
order:
i)- either the HPLMN (if the EHPLMN list is not present or is empty) or, if
one or more of the EHPLMNs are available then based on an optional data field
on the SIM either only the highest priority available EHPLMN is to be
presented to the user or all available EHPLMNs are presented to the user in
priority order. If the data field is not present on the SIM, then only the
highest priority available EHPLMN is presented;
ii)- PLMN/access technology combinations contained in the \" User Controlled
PLMN Selector with Access Technology \" data file in the SIM (in priority
order);
iii)- PLMN/access technology combinations contained in the \"Operator
Controlled PLMN Selector with Access Technology\" data file in the SIM (in
priority order);
iv)- other PLMN/access technology combinations with received high quality
signal in random order;
v)- other PLMN/access technology combinations in order of decreasing signal
quality.
In ii and iii, an MS using a SIM without access technology information storage
(i.e. the \"User Controlled PLMN Selector with Access Technology\" and the
\"Operator Controlled PLMN Selector with Access Technology\" data files are
not present) shall instead present the PLMNs contained in the \"PLMN
Selector\" data file in the SIM (in priority order).
In v, requirement h) in subclause 4.4.3.1.1 applies.
In i to v, requirements j), k) and l) in subclause 4.4.3.1.1 apply.
In GSM COMPACT, the non support of voice services shall be indicated to the
user.
The HPLMN may provide on the SIM additional information on the available
PLMNs. If this information is provided then the MS shall indicate it to the
user. This information, provided as free text may include:
> \- preferred partner,
>
> \- roaming agreement status,
>
> \- supported services
Furthermore, the MS may indicate whether the available PLMNs are present on
the EHPLMN list, the Forbidden list, the User Controlled PLMN List or the
Operator Controlled PLMN List. The MS may also indicate that the PLMN is not
present on any of these lists.
The user may select his desired PLMN and the MS then initiates registration on
this PLMN using the access technology chosen by the user for that PLMN or
using the highest priority available access technology for that PLMN, if the
associated access technologies have a priority order. (This may take place at
any time during the presentation of PLMNs). For such a registration, the MS
shall ignore the contents of the \"forbidden location areas for roaming\",
\"forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for
roaming\", \"forbidden location areas for regional provision of service\",
\"forbidden tracking areas for regional provision of service\", \"5GS
forbidden tracking areas for regional provision of service\", \"forbidden
PLMNs for GPRS service\" and \"forbidden PLMNs\" lists.
NOTE 1: It is an MS implementation option whether to indicate access
technologies to the user. If the MS does display access technologies, then the
access technology selected by the user is only used for initial registration
on the selected PLMN. If the MS does not display access technologies, then the
access technology chosen for a particular PLMN should be the highest priority
available access technology for that PLMN, if the associated access
technologies have a priority order, and is only used for initial registration.
Once the MS has registered on a PLMN selected by the user, the MS shall not
automatically register on a different PLMN unless:
i) the new PLMN is declared as an equivalent PLMN by the registered PLMN;
ii) the user selects automatic mode; or
iii) the user initiates an emergency call while the MS is in limited service
state and either the network does not broadcast the indication of support of
emergency calls in limited service state, the registration request for
emergency services is rejected by the network or the attach request for
emergency bearer services is rejected by the network.
NOTE 2: If case iii) occurs, the MS can provide an indication to the upper
layers that the MS has exited manual network selection mode.
If the user does not select a PLMN, the selected PLMN shall be the one that
was selected before the PLMN selection procedure started. If no such PLMN was
selected or that PLMN is no longer available, then the MS shall attempt to
camp on any acceptable cell and enter the limited service state.
NOTE 3: High quality signal is defined in the appropriate AS specification.
##### 4.4.3.1.3 Manual CSG selection
###### 4.4.3.1.3.1 General
The HPLMN may configure the MS whether to provide to the user CSGs for a
certain PLMN without any restriction or to provide to the user only CSGs in
the Operator CSG List for that PLMN.This configuration may be done either:
\- in the USIM if the Operator CSG list is available in the USIM; or
\- as described in 3GPP TS 24.285 [47].
In the absence of such configuration from the HPLMN for a certain PLMN, the MS
shall by default provide to the user CSGs for that PLMN without any
restriction.
For PLMNs where no restriction is configured, the MS provides to the user the
CSGs that are available and the associated PLMNs using all access technologies
which support CSGs (see 3GPP TS 23.003 [22A]) and which are supported by the
MS. For each entry in the list, an indication is provided whether that CSG
identity is in the Allowed CSG list or in the Operator CSG list stored in the
MS for this PLMN.
For PLMNs where the MS is configured to provide to the user only CSGs in the
Operator CSG List, the MS provides to the user the CSGs that are available and
in the Operator CSG list, using all access technologies which support CSGs
(see 3GPP TS 23.003 [22A]) and which are supported by the MS. For each entry
in the list, the MS provides to the user the associated PLMN and an indication
that the CSG identity is in the Operator CSG List stored in the MS for this
PLMN.
Additional requirements for the display, including for the display of HNB
name, can be found in 3GPP TS 22.220 [49].
The user may select a CSG from the indicated CSGs.
If the MS has a PDN connection for emergency bearer services, manual CSG
selection shall not be performed.
###### 4.4.3.1.3.2 Manual CSG selection within the RPLMN
If the user selects a CSG whose CSG identity is not included in the Allowed
CSG list or Operator CSG list, then the MS shall attempt to register on a cell
that corresponds to the CSG. For such a registration, the MS shall ignore the
contents of the \"forbidden location areas for roaming\", \"forbidden tracking
areas for roaming\", \"forbidden location areas for regional provision of
service\", \"forbidden tracking areas for regional provision of service\" and
\"forbidden PLMNs for GPRS service\" lists.
Manual CSG selection within the RPLMN does not affect the current PLMN
selection mode.
###### 4.4.3.1.3.3 Manual CSG selection in a PLMN different from the RPLMN
If the user selects a CSG in a PLMN that is different from the RPLMN, then the
following applies:
i) The MS shall store a duplicate of the RPLMN and a duplicate of the PLMN
selection mode that were in use before the manual CSG selection was initiated,
unless this manual CSG selection follows another manual CSG selection or a
PLMN selection triggered by ProSe direct communication as specified in
subclause 3.1B or a PLMN selection triggered by V2X communication over PC5 as
specified in subclause 3.1x;
ii) The MS shall enter into Manual mode of PLMN selection in state M4 (Trying
PLMN) as defined in subclause 4.3.1.2;
iii) The MS shall select the PLMN corresponding to the CSG and attempt to
register on the selected CSG cell in the PLMN. For such a registration, the MS
shall ignore the contents of the \"forbidden location areas for roaming\",
\"forbidden tracking areas for roaming\", \"forbidden location areas for
regional provision of service\", \"forbidden tracking areas for regional
provision of service\", \"forbidden PLMNs for GPRS service\" and \"forbidden
PLMNs\" lists;
iv) If the registration fails or the MS is no longer in the coverage of the
selected CSG, then the MS shall return to the stored duplicate PLMN selection
mode and use the stored duplicate value of RPLMN for further action;
v) If the MS is switched off while on the selected CSG and switched on again,
the MS should return to the stored duplicate PLMN selection mode, unless the
MS provides the optional feature of user preferred PLMN selection operating
mode at switch on. Additionally, the MS shall use the stored duplicate value
of RPLMN for further action;
vi) If the user initiates a PLMN selection while on the selected CSG, the MS
shall delete the stored duplicate PLMN selection mode, use the stored
duplicate value of RPLMN as RPLMN and follow the procedures (as specified for
switch-on or recovery from lack of coverage) in subclause 4.4.3.1. The MS
shall delete the stored duplicate value of RPLMN once the PLMN selection has
been completed successfully ;
vii) If the MS\'s E-UTRA capability is disabled as a result of successful
registration (as described in 3GPP TS 24.301 [23A] subclauses 5.5.1.3.4.2,
5.5.1.3.4.3, 5.5.3.3.4.2 and 5.5.3.3.4.3) and the selected CSG is not
available on UTRAN radio access technology, the MS shall re-enable the E-UTRA
capability, return to the stored duplicate PLMN selection mode and use the
stored duplicate value of RPLMN for further action; and
viii) If the MS\'s E-UTRA capability is disabled as a result of performing the
service request procedure (as described in 3GPP TS 24.301 [23A] subclause
5.6.1.5), the selected CSG is not available on UTRAN radio access technology
and the MS performed a CS call, then after the end of the call, the MS shall
re-enable the E-UTRA capability, return to the stored duplicate PLMN selection
mode and use the stored duplicate value of RPLMN for further action.
#### 4.4.3.2 User reselection
At any time the user may request the MS to initiate reselection and
registration onto an available PLMN, according to the following procedures,
dependent upon the operating mode.
##### 4.4.3.2.1 Automatic Network Selection Mode
The MS selects and attempts registration on PLMN/access technology
combinations, if available and allowable, in all of its bands of operation in
accordance with the following order:
i) the HPLMN (if the EHPLMN list is not present or is empty) or the highest
priority EHPLMN that is available (if the EHPLMN list is present);
ii) PLMN/access technology combinations contained in the \"User Controlled
PLMN Selector with Access Technology\" data file in the SIM (in priority
order) excluding the previously selected PLMN/access technology combination;
iii) PLMN/access technology combinations contained in the \"Operator
Controlled PLMN Selector with Access Technology\" data file in the SIM (in
priority order) excluding the previously selected PLMN/access technology
combination;
iv) other PLMN/access technology combinations with the received high quality
signal in random order excluding the previously selected PLMN/access
technology combination;
v) other PLMN/access technology combinations, excluding the previously
selected PLMN/access technology combination in order of decreasing signal
quality or, alternatively, the previously selected PLMN/access technology
combination may be chosen ignoring its signal quality;
vi) The previously selected PLMN/access technology combination.
The previously selected PLMN/access technology combination is the PLMN/access
technology combination which the MS has selected prior to the start of the
user reselection procedure.
NOTE 1: If the previously selected PLMN is chosen, and registration has not
been attempted on any other PLMNs, then the MS is already registered on the
PLMN, and so registration is not necessary.
The equivalent PLMNs list shall not be applied to the user reselection in
Automatic Network Selection Mode.
When following the above procedure the requirements a), b), c), e), f), g),
h), j), k) and l) in subclause 4.4.3.1.1 apply: Requirement d) shall apply as
shown below:
d) In iv, v, and vi, the MS shall search for all access technologies it is
capable of before deciding which PLMN/access technology combination to select.
NOTE 2: High quality signal is defined in the appropriate AS specification.
##### 4.4.3.2.2 Manual Network Selection Mode
The Manual Network Selection Mode Procedure of subclause 4.4.3.1.2 is
followed.
##### 4.4.3.2.3 Manual CSG selection
The procedure of subclause 4.4.3.1.3 is followed.
#### 4.4.3.3 In VPLMN
##### 4.4.3.3.1 Automatic and manual network selection modes
If the MS is in a VPLMN, the MS shall periodically attempt to obtain service
on its HPLMN (if the EHPLMN list is not present or is empty) or one of its
EHPLMNs (if the EHPLMN list is present) or a higher priority PLMN/access
technology combinations listed in \"user controlled PLMN selector\" or
\"operator controlled PLMN selector\" by scanning in accordance with the
requirements that are applicable to i), ii) and iii) as defined in the
Automatic Network Selection Mode in subclause 4.4.3.1.1. In the case that the
mobile has a stored \"Equivalent PLMNs\" list the mobile shall only select a
PLMN if it is of a higher priority than those of the same country as the
current serving PLMN which are stored in the \"Equivalent PLMNs\" list. For
this purpose, a value of timer T may be stored in the SIM. The interpretation
of the stored value depends on the radio capabilities supported by the MS:
\- For an MS that does not support any of the following: EC-GSM-IoT, Category
M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]), T is either in the
range 6 minutes to 8 hours in 6 minute steps or it indicates that no periodic
attempts shall be made. If no value for T is stored in the SIM, a default
value of 60 minutes is used for T.
\- For an MS that only supports any of the following or a combination of: EC-
GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]), T is
either in the range 2 hours to 240 hours, using 2 hour steps from 2 hours to
80 hours and 4 hour steps from 84 hours to 240 hours, or it indicates that no
periodic attempts shall be made. If no value for T is stored in the SIM, a
default value of 72 hours is used.
\- For an MS that supports both:
a) any of the following or a combination of: EC-GSM-IoT, Category M1 or
Category NB1 (as defined in 3GPP TS 36.306 [54]); and
b) any access technology other than the following: EC-GSM-IoT, Category M1 or
Category NB1 (as defined in 3GPP TS 36.306 [54]),
then T is interpreted depending on the access technology in use as specified
below:
1) if the MS is using any of the following at the time of starting timer T:
EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]), T
is either in the range 2 hours to 240 hours, using 2 hour steps from 2 hours
to 80 hours and 4 hour steps from 84 hours to 240 hours, or it indicates that
no periodic attempts shall be made. If no value for T is stored in the SIM, a
default value of 72 hours is used; and
2) if the MS is not using any of the following at the time of starting timer
T: EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306
[54]), T is either in the range 6 minutes to 8 hours in 6 minute steps or it
indicates that no periodic attempts shall be made. If no value for T is stored
in the SIM, a default value of 60 minutes is used for T.
If the MS is configured with the MinimumPeriodicSearchTimer as specified in
3GPP TS 24.368 [50] or 3GPP TS 31.102 [40], the MS shall not use a value for T
that is less than the MinimumPeriodicSearchTimer. If the value stored in the
SIM, or the default value for T (when no value is stored in the SIM), is less
than the MinimumPeriodicSearchTimer, then T shall be set to the
MinimumPeriodicSearchTimer.
The MS does not stop timer T, as described in 3GPP TS 24.008 [23] and 3GPP TS
24.301 [23A], when it activates power saving mode (PSM) (see 3GPP TS 23.682
[27A]).
The MS can be configured for Fast First Higher Priority PLMN search as
specified in 3GPP TS 31.102 [40] or 3GPP TS 24.368 [50]. Fast First Higher
Priority PLMN search is enabled if the corresponding configuration parameter
is present and set to enabled. Otherwise, Fast First Higher Priority PLMN
search is disabled.
The attempts to access the HPLMN or an EHPLMN or higher priority PLMN shall be
as specified below:
a) The periodic attempts shall only be performed in automatic mode when the MS
is roaming, and not while the MS is attached for emergency bearer services, is
registered for emergency services, has a PDU session for emergency services or
has a PDN connection for emergency bearer services;
b) The MS shall make the first attempt after a period of at least 2 minutes
and at most T minutes:
\- only after switch on if Fast First Higher Priority PLMN search is disabled;
or
\- after switch on or upon selecting a VPLMN if Fast First Higher Priority
PLMN search is enabled.
c) The MS shall make the following attempts if the MS is on the VPLMN at time
T after the last attempt;
d) Periodic attempts shall only be performed by the MS while in idle mode;
d1) periodic attempts may be postponed while the MS is in power saving mode
(PSM) (see 3GPP TS 23.682 [27A]).
e) If the HPLMN (if the EHPLMN list is not present or is empty) or a EHPLMN
(if the list is present) or a higher priority PLMN is not found, the MS shall
remain on the VPLMN.
f) In steps i), ii) and iii) of subclause 4.4.3.1.1 the MS shall limit its
attempts to access higher priority PLMN/access technology combinations to
PLMN/access technology combinations of the same country as the current serving
VPLMN, as defined in Annex B.
g) Only the priority levels of Equivalent PLMNs of the same country as the
current serving VPLMN, as defined in Annex B, shall be taken into account to
compare with the priority level of a selected PLMN.
h) If the PLMN of the highest priority PLMN/access technology combination
available is the current VPLMN, or one of the PLMNs in the \"Equivalent
PLMNs\" list, the MS shall remain on the current PLMN/access technology
combination.
##### 4.4.3.3.2 Manual CSG selection
The procedure of subclause 4.4.3.1.3 is followed.
#### 4.4.3.4 Investigation Scan for higher prioritized PLMN
The support of this procedure is mandatory if the ME supports GSM COMPACT and
otherwise optional.
A MS capable of both GSM voice and packet service shall, when indicated in the
SIM, investigate if there is service from a higher prioritized PLMN not
offering GSM voice service, either HPLMN (if the EHPLMN list is not present or
is empty) or one of its EHPLMNs (if the EHPLMN list is present) or a PLMN in a
\"PLMN Selector with Access Technology \" data file on the SIM.
The MS shall scan for PLMNs in accordance with the requirements described for
automatic network selection mode in subclause 4.4.3.1.1 that are applicable to
i), ii) and iii) with the exception of requirement a) and b) in subclause
4.4.3.1. Requirement a) and b) that are specified for automatic network
selection mode in subclause 4.4.3.1 shall be ignored during the investigation
scan.
If indicated on the SIM, the investigation scan shall be performed:
i) After each successful PLMN selection and registration is completed, when
the MS is in idle mode. This investigation scan may rely on the information
from the already performed PLMN selection and may not necessarily require a
rescan
ii) When the MS is unable to obtain normal service from a PLMN, (limited
service state) see subclause 3.5.
The investigation scan is restricted to automatic selection mode and shall
only be performed by an MS that is capable of both voice and packet data. It
shall only be performed if the selected PLMN is not already the highest
prioritized PLMN in the current country. (HPLMN in home country, otherwise
according to PLMN selector lists)
The MS shall return to RPLMN after the investigation scan is performed.
If a higher prioritized PLMN not offering GSM voice service is found, this
shall be indicated to the user. The MS shall not select the PLMN unless
requested by the user.
### 4.4.4 Abnormal cases
If there is no SIM in the MS, if there is an authentication failure, or if the
MS receives an \"IMSI unknown in HLR\", \"illegal ME\" or \"illegal MS\"
response to an LR request, then effectively there is no selected PLMN (\"No
SIM\" state). In these cases, the states of the cell selection process are
such that no PLMN selection information is used. Except when performing GPRS
attach or EPS attach for emergency bearer services or registration for
emergency services, no further attempts at registration on any PLMN are made
until the MS is switched off and on again, or a SIM is inserted. When
performing GPRS attach or EPS attach for emergency bearer services or
registration for emergency services, the PLMN of the current serving cell is
temporarily considered as the selected PLMN.
When in Automatic Network Selection mode and the MS is in the \"not updated\"
state with one or more suitable cells to camp on; then after the maximum
allowed unsuccessful LR requests (controlled by the specific attempt counters)
the MS may continue (or start if it is not running) the user reselection
procedure of subclause 4.4.3.2 1.
A multi mode MS that also supports 3GPP2 access technology may fall back to
3GPP2 mode if no SIM is inserted.
### 4.4.5 Roaming not allowed in this LA or TA
If in either PLMN selection mode the LR response \"Roaming not allowed in this
LA\" or \"Roaming not allowed in this TA\" is received:
The PLMN Automatic or Manual Mode Selection Procedure of subclause 4.4.3.1 are
followed, depending on whether the MS is in automatic or manual mode.
### 4.4.6 Steering of roaming
If the MS receives a USAT REFRESH command qualifier (3GPP TS 31.111 [41]) of
type \"Steering of Roaming\", the MS shall:
a) replace the highest priority entries in the \"Operator Controlled PLMN
Selector with Access Technology\" list stored in the ME with the list provided
in the REFRESH command;
b) delete the PLMNs identified by the list in the REFRESH command from the
Forbidden PLMN list and from the Forbidden PLMNs for GPRS service list, if
they are present in these lists. This includes any information stored in the
SIM and the ME internal memory;
c) take the new information into account in subsequent attempts to access a
higher priority PLMN; and
d) attempt to obtain service on a higher priority PLMN as specified in
subclause 4.4.3.3 by acting as if timer T that controls periodic attempts has
expired.
In order to avoid unnecessary signalling, the network operator should avoid
repeatedly using steering of roaming of a particular MS.
## 4.5 Location registration process
### 4.5.1 General
When the MS is switched on and capable of services requiring registration, the
action taken by the location registration process is as follows:
a) SIM present and no LR needed (because of the status of the stored
registration area identity and \"attach\" flag): The MS is in the update state
\"Updated\";
b) SIM present and LR needed: A LR request is made;
c) No SIM present: The MS enters the update state \"Idle, No IMSI\".
In case b) above, and subsequently whenever a LR request is made, the MS
enters a state depending on the outcome of the LR request, as listed in
subclause 4.3.3 above. In case c) the GPRS and the non-GPRS update state
enters \"Idle, No IMSI\".
Whenever the MS goes to connected mode and then returns to idle mode again,
the MS selects the appropriate state.
A multi mode MS that also supports 3GPP2 access technology may fall back to
3GPP2 mode if no SIM is inserted.
### 4.5.2 Initiation of Location Registration
An LR request indicating Normal Updating is made when, in idle mode,
\- the MS changes cell while the update status is \"NOT UPDATED\"; (for MS
capable of GPRS and non-GPRS services when at least one of both update
statuses is \"NOT UPDATED\")
\- the MS detects that it has entered a new registration area, i.e., when the
received registration area identity differs from the one stored in the MS, and
the LAI, TAI or PLMN identity is not contained in any of the lists of
\"forbidden location areas for roaming\", \"forbidden tracking areas for
roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden location
areas for regional provision of service\", \"forbidden tracking areas for
regional provision of service\", \"5GS forbidden tracking areas for regional
provision of service\", \"forbidden PLMNs for GPRS service\" or \"forbidden
PLMNs\" respectively, while being in one of the following update statuses:
\- UPDATED;
\- NOT UPDATED;
\- ROAMING NOT ALLOWED.
\- the MS detects that it has entered a registration area that has the same
identity as the one stored in the MS, while the update status is \"ROAMING NOT
ALLOWED\", and the LAI, TAI or PLMN identity is not contained in any of the
lists of \"forbidden location areas for roaming\", \"forbidden tracking areas
for roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden
location areas for regional provision of service\", \"forbidden tracking areas
for regional provision of service\", \"5GS forbidden tracking areas for
regional provision of service\", \"forbidden PLMNs for GPRS service\" or
\"forbidden PLMNs\" respectively.
\- the Periodic Location Updating Timer expires while the non-GPRS update
status is \"NOT UPDATED\" (triggers Location Updating);
\- the Periodic Routing Area Update timer expires while the GPRS update status
is \"NOT UPDATED\" (triggers Routing Area Update);
\- the Periodic Tracking Area Update timer expires while the EPS update status
is \"NOT UPDATED\" (triggers Tracking Area Update);
\- a manual network reselection has been performed, an acceptable cell of the
selected PLMN is present, and the MS is not in the update status \"UPDATED\"
on the selected PLMN; or
\- emergency bearer services over packet services are requested by upper
layers.
An MS which is attached for PS services and enters a new PLMN shall perform a
routeing area update or a tracking area update or an MS which is registered
via NG-RAN and enters a new PLMN shall perform a registration update if the
following conditions are fulfilled:
\- if the MS is in S1 mode or N1 mode and the currently stored TAI list does
not contain the TAI of the current serving cell;
\- the LAI, TAI or PLMN identity of the current serving cell is not contained
in any of the lists \"forbidden location areas for roaming\", \"forbidden
tracking areas for roaming\", \"5GS forbidden tracking areas for roaming\",
\"forbidden location areas for regional provision of service\", \"forbidden
tracking areas for regional provision of service\", \"5GS forbidden tracking
areas for regional provision of service\", \"forbidden PLMNs for GPRS
service\" or \"forbidden PLMNs\", or the MS has a PDN connection for emergency
bearer services;
\- the current update state is different from \"Idle, No IMSI\"; and
\- the MS is configured to perform the attach procedure with IMSI at PLMN
change (see \"AttachWithIMSI\" leaf of the NAS configuration MO in 3GPP TS
24.368 [50] or USIM file NAS~CONFIG~ in 3GPP TS 31.102 [40]) and the new PLMN
is the registered PLMN or an equivalent PLMN; or
\- the MS is not configured to perform the attach procedure with IMSI at PLMN
change.
If the new PLMN the MS has entered is neither the registered PLMN nor an
equivalent PLMN, an MS which is attached for PS services and configured to
perform the attach procedure with IMSI at PLMN change (see \"AttachWithIMSI\"
leaf of the NAS configuration MO in 3GPP TS 24.368 [50] or USIM file NASCONFIG
in 3GPP TS 31.102 [40]) shall perform an attach procedure using IMSI as mobile
identity.
An LR request indicating Periodic Location Updating is made when, in idle
mode, the Periodic Location Updating timer expires while the non-GPRS update
status is \"UPDATED\".
An LR request indicating Periodic Routing Area Update is made when the
Periodic Routing Area Update timer expires while the GPRS update status is
\"UPDATED\", except when the MS is attached for emergency bearer services.
An LR request indicating Periodic Tracking Area Update is made when the
Periodic Tracking Area Update timer expires while the EPS update status is
\"UPDATED\", except when the MS is attached for emergency bearer services.
An LR request indicating Periodic Registration Updating is made when the
periodic registration timer expires while the 5GS update status is
\"UPDATED\", except when the MS is registered for emergency services.
An LR request indicating IMSI attach is made when the MS is activated in the
same location area in which it was deactivated while the non-GPRS update
status is \"UPDATED\", and the system information indicates that IMSI
attach/detach shall be used.
A GPRS attach is made by a GPRS MS when activated and capable of services
which require registration. A GPRS attach may only be performed if the
selected PLMN is not contained in the list of \"forbidden PLMNs for GPRS
service\". Depending on system information about GPRS network operation mode
MSs operating in MS operation mode A or B perform combined or non-combined
location registration procedures. When the combined routing area update or
GPRS attach is accepted with indication \"MSC not reachable\" or is not
answered the MS performs also the corresponding location updating procedure or
falls back to a GPRS only MS. When the combined routing area update or GPRS
attach is rejected with cause \"GPRS not allowed\" the GPRS update status is
\"ROAMING NOT ALLOWED\" and the MS performs the corresponding location
updating procedure.
Furthermore, an LR request indicating Normal Location Updating is also made
when the response to an outgoing request shows that the MS is unknown in the
VLR or SGSN, respectively.
Table 2 in clause 5 summarizes the events in each state that trigger a new LR
request. The actions that may be taken while being in the various states are
also outlined in table 2.
A GPRS MS which is both IMSI attached for GPRS and non-GPRS services and which
is capable of simultaneous operation of GPRS and non-GPRS services shall
perform Routing Area Update in connected mode when it has entered a new
routing area which is not part of a LA contained in the list of \"forbidden
location areas for roaming\" or \"forbidden location areas for regional
provision of service\".
### 4.5.3 Periodic Location Registration
A Periodic Location Updating timer (for non-GPRS operation), a Periodic
Routing Area Update timer (for GPRS operation) and a Periodic Tracking Area
Update timer (for EPS operation) with the following characteristics shall be
implemented in the MS (MS shall implement all timers corresponding to
supported operations):
i) Upon switch on of the MS or when the system information indicates that
periodic location registration shall be applied, and the timer is not running,
the timer shall be loaded with a random value between 0 and the broadcast or
signalled time‑out value and started.
ii) The time‑out value for the Periodic Location Updating timer shall be
within the range of 1 deci‑hour to 255 deci‑hours with a granularity of 1
deci‑hour.
iii) When the timer reaches its expiry value, it shall be initiated with
respect to the relevant time‑out value, and the MS shall initiate the Periodic
Location Registration corresponding to the expired timer. If the MS is
attached for emergency bearer services or the MS is registered for emergency
services, the MS shall locally detach instead of performing Periodic Location
Registration.
iv) The Periodic Location Updating timer shall be prevented from triggering
Periodic Location Updating during connected mode. When the MS returns to idle
mode, the Periodic Location Updating timer shall be initiated with respect to
the broadcast time‑out value, then started. Thereafter, the procedure in iii)
shall be followed.
v) The Periodic Routing Area Update timer shall be prevented from triggering
the Periodic Routing Area Update during Ready state. At transition from Ready
to Standby state the Periodic Routing Area Update timer shall be initiated
with respect to its time‑out value, then started. Thereafter, the procedure in
iii) shall be followed.
vi) If the MS performs a successful combined Routing Area Update the Periodic
Location Updating timer shall be prevented from triggering the Periodic
Location Updating until the MS starts using Location Updating procedure, for
example because of a changed network operation mode or the MS uses non-GPRS
services only.
vii) When a change in the time‑out value occurs (at a change of serving cell
or a change in the broadcast time‑out value or a change in the signalled time-
out value), the related timer shall be reloaded so that the new time to expiry
will be: \"old time to expiry\" modulo \"new time‑out value\".
### 4.5.4 IMSI attach/detach operation
The system information will contain an indicator indicating whether or not
IMSI attach/detach operation is mandatory to use in the cell. The MS shall
operate in accordance with the received value of the indicator.
A GPRS MS shall perform GPRS attach/detach procedures independent of the value
of the IMSI attach/detach indicator. When a GPRS MS has to perform IMSI
attach/detach independent of GPRS procedures (for example GPRS network
operation mode 2) the handling described in the clause above applies.
When IMSI attach/detach operation applies, a MS shall send the IMSI detach
message to the network when the MS is powered down or the SIM is removed while
the update status is \"UPDATED\". The IMSI detach message will not be
acknowledged by the network.
When the MS returns to the active state, the MS shall perform an LR request
indicating IMSI attach, provided that the MS still is in the same registration
area. If the registration area has changed, an LR request indicating Normal
Location Updating according to subclause 4.5.2 shall be performed.
### 4.5.5 No Suitable Cells In Location Area
If during location registration the LR response \"No Suitable Cells In
Location Area\" or \"No Suitable Cells In Tracking Area\" is received:
\- The MS shall attempt to find another LA or TA of the same PLMN or an
equivalent PLMN on which it received the LR response. If the MS is able to
find another LA or TA it shall attempt registration. If the MS is unable to
find an LA or TA, the PLMN Automatic or Manual Mode Selection Procedure of
subclause 4.4.3.1 shall be followed, depending on whether the MS is in
automatic or manual mode.
## 4.6 Service indication (A/Gb mode only)
This is an indication to the user that service or CTS service is available.
The service indication should be set if the following conditions are all
satisfied:
a) Cell Selection: Camped on a suitable cell and in updated state, or in
connected mode having been camped on a suitable cell.
b) Location registration: In updated state, for MSs capable of services
requiring registration.
A specific CTS service indication should be set when the CTS MS is attached to
a CTS FP.
However due to the fact that there may be some transitory changes of state,
the service indication is permitted to continue to be set for up to 10 seconds
after the above conditions cease to be met. Also the service indication is
permitted to take up to 1 second to be set after the above conditions are met.
## 4.7 Pageability of the mobile subscriber
An MS is required to listen to all paging messages that could address it (see
3GPP TS 45.002 [24]), when the following conditions are all satisfied:
\- A SIM is inserted;
\- The MS is camped on a cell;
\- The MS is not in state \"Idle, No IMSI\"; and
\- The MS is not performing the task to search for available PLMNs. (Whenever
possible during this task, the MS should listen for paging.). However, when
the MS is camped on a cell, is registered in a PLMN and is performing its
regular search for a higher priority PLMN, as specified in 3GPP TS 22.011 [9],
then it shall listen to all paging messages that could address it.
NOTE: In A/Gb mode, during cell reselection there is a certain period when the
MS is no longer camped on the old cell but must decode the full BCCH, CPBCCH
or EC-BCCH before camping on the new cell. This leads to a period of slightly
more than 8 51 frame multiframes when the MS will not necessarily be pageable
(full BCCH or CPBCCH is decoded) or up to 32 51 frame multiframes when the MS
will not necessarily be pageable (full EC-BCCH is decoded).
## 4.8 MM Restart Procedure
In some cases, e.g. on change of SIM data, there is a need for the MM to be
restarted without the need for user intervention.
To perform the procedure the MS shall behave as if the SIM is removed and
afterwards a new SIM is inserted.
# 5 Tables and Figures
Table 1: Effect of LR Outcomes on PLMN Registration
+----------------------+---------------------+----------------------+ | Location | Registration Status | Registered PLMN is | | Registration Task | | | | State | | | +----------------------+---------------------+----------------------+ | Updated | Successful | Indicated in the | | | | stored registration | | | | area identity | +----------------------+---------------------+----------------------+ | Idle, No IMSI | Unsuccessful | No registered PLMN | | | | (3) (4) | +----------------------+---------------------+----------------------+ | Roaming not allowed: | | | +----------------------+---------------------+----------------------+ | > a) PLMN not | Unsuccessful | No registered PLMN | | > allowed | | (4) | +----------------------+---------------------+----------------------+ | > b) LA not allowed | Indeterminate(1) | No registered PLMN | | > or TA not allowed | | | +----------------------+---------------------+----------------------+ | > c) Roaming not | Indeterminate (2) | No registered PLMN | | > allowed in this LA | | (4) | | > or Roaming not | | | | > allowed in this TA | | | +----------------------+---------------------+----------------------+ | > d) No suitable | Indeterminate (5) | No registered PLMN | | > cells in location | | | | > area or No | | | | > suitable cells in | | | | > tracking area | | | +----------------------+---------------------+----------------------+ | > e) Not authorized | Indeterminate (6) | No registered PLMN | | > for this CSG | | | +----------------------+---------------------+----------------------+ | Not updated | Unsuccessful | No registered PLMN | | | | (4) | +----------------------+---------------------+----------------------+ | 1) The MS will | | | | perform a cell | | | | selection and will | | | | eventually either | | | | enter a different | | | | state when the | | | | registration status | | | | will be determined, | | | | or fail to be able | | | | to camp on a new | | | | cell, when | | | | registration status | | | | will be | | | | unsuccessful. | | | | | | | | 2) The MS will | | | | select the HPLMN (if | | | | the EHPLMN list is | | | | not present or is | | | | empty) or an EHPLMN | | | | (if the EHPLMN list | | | | is present) if in | | | | automatic mode and | | | | will enter Automatic | | | | Network Selection | | | | Mode Procedure of | | | | subclause 4.4.3.1. | | | | If in manual mode, | | | | the MS will display | | | | the list of | | | | available PLMNs and | | | | follow the Manual | | | | Network Selection | | | | Mode Procedure of | | | | subclause 4.4.3.1.2 | | | | If the appropriate | | | | process does not | | | | result in | | | | registration, the MS | | | | will eventually | | | | enter the limited | | | | service state. | | | | | | | | 3) An MS may have | | | | different update | | | | states for GPRS and | | | | non-GPRS. A PLMN is | | | | registered when at | | | | least one of both | | | | update states is | | | | updated. | | | | | | | | 4) The stored list | | | | of equivalent PLMNs | | | | is invalid and can | | | | be deleted. | | | | | | | | 5) The MS will | | | | attempt registration | | | | on another LA or TA | | | | of the same PLMN, or | | | | equivalent PLMN if | | | | available.Otherwise | | | | it will enter either | | | | the Automatic | | | | Network Selection | | | | Mode procedure of | | | | subclause 4.4.3.1 or | | | | follow the Manual | | | | Network Selection | | | | Mode procedure of | | | | subclause 4.4.3.1.2. | | | | If the appropriate | | | | process does not | | | | result in | | | | registration, the MS | | | | will eventually | | | | enter the limited | | | | service state. | | | | | | | | 6) The MS will | | | | attempt registration | | | | on another cell of | | | | the same PLMN, or | | | | equivalent PLMN if | | | | available.Otherwise | | | | it will enter either | | | | the Automatic | | | | Network Selection | | | | Mode procedure of | | | | subclause 4.4.3.1 or | | | | follow the Manual | | | | Network Selection | | | | Mode procedure of | | | | subclause 4.4.3.1.2. | | | | If the appropriate | | | | process does not | | | | result in | | | | registration, the MS | | | | will eventually | | | | enter the limited | | | | service state. | | | | | | | | NOTE 1: MSs capable | | | | of GPRS and non-GPRS | | | | services may have | | | | different | | | | registration status | | | | for GPRS and for | | | | non-GPRS. | | | | | | | | NOTE 2: The | | | | registered PLMN is | | | | determined by | | | | looking at the | | | | stored registration | | | | area identity and | | | | stored location | | | | registration status. | | | +----------------------+---------------------+----------------------+
Table 2: LR Process States and Allowed Actions
+---------+---------+---------+---------+---------+---------+---------+ | L | New LR | Normal | Paging | | | | | ocation | request | Calls | re | | | | | Regis | when | | sponded | | | | | tration | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Task | C | C | C | Other | Su | to | | State | hanging | hanging | hanging | | pported | | | | Cell | regis | PLMN | | (1) | | | | | tration | | | | | | | | area | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Null | No | Yes | Yes | No | No | No | | (4) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | U | No | Yes | Yes | (2) | Yes | Yes | | pdated, | | | | | | | | (5) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Idle, | No | No | No | No | No | No | | No IMSI | | | | | | | | (7) | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Roaming | | | | | | | | not | | | | | | | | a | | | | | | | | llowed: | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | > a) | No | No | Yes | No | No | O | | > Idle, | | | | | | ptional | | > PLMN | | | | | | if with | | > not | | | | | | IMSI | | > | | | | | | | | allowed | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | > b) | No | Yes(6) | Yes | No | No | O | | > Idle, | | | | | | ptional | | > LA | | | | | | if with | | > not | | | | | | IMSI | | > | | | | | | | | allowed | | | | | | | | > or TA | | | | | | | | > not | | | | | | | | > | | | | | | | | allowed | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | > c) | No | Y | Yes | No | No | O | | > Idle, | | es(6,8) | | | | ptional | | > | | | | | | if with | | Roaming | | | | | | IMSI | | > not | | | | | | | | > | | | | | | | | allowed | | | | | | | | > in | | | | | | | | > this | | | | | | | | > LA or | | | | | | | | > | | | | | | | | > | | | | | | | | Roaming | | | | | | | | > not | | | | | | | | > | | | | | | | | allowed | | | | | | | | > in | | | | | | | | > this | | | | | | | | > TA | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | > d) | No | Y | Yes | No | No | O | | > No | | es(6,8) | | | | ptional | | > s | | | | | | if with | | uitable | | | | | | IMSI | | > cells | | | | | | | | > in | | | | | | | | > l | | | | | | | | ocation | | | | | | | | > area | | | | | | | | > or | | | | | | | | > | | | | | | | | > No | | | | | | | | > s | | | | | | | | uitable | | | | | | | | > cells | | | | | | | | > in | | | | | | | | > t | | | | | | | | racking | | | | | | | | > area | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | > e) | No | Yes | Yes | No | No | O | | > Not | | (6,8) | | | | ptional | | > aut | | | | | | if with | | horized | | | | | | IMSI | | > for | | | | | | | | > this | | | | | | | | > CSG | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Not | Yes | Yes | Yes | (2)&(3) | (3) | Yes if | | updated | | | | | | with | | | | | | | | IMSI | +---------+---------+---------+---------+---------+---------+---------+ | 1): | | | | | | | | Em | | | | | | | | ergency | | | | | | | | calls | | | | | | | | may | | | | | | | | always | | | | | | | | be | | | | | | | | made, | | | | | | | | subject | | | | | | | | to | | | | | | | | access | | | | | | | | control | | | | | | | | per | | | | | | | | mitting | | | | | | | | it. | | | | | | | | | | | | | | | | 2): A | | | | | | | | new LR | | | | | | | | is made | | | | | | | | when | | | | | | | | the | | | | | | | | p | | | | | | | | eriodic | | | | | | | | regis | | | | | | | | tration | | | | | | | | timer | | | | | | | | e | | | | | | | | xpires. | | | | | | | | | | | | | | | | 3): If | | | | | | | | a | | | | | | | | normal | | | | | | | | call | | | | | | | | request | | | | | | | | is | | | | | | | | made, | | | | | | | | an LR | | | | | | | | request | | | | | | | | is | | | | | | | | made. | | | | | | | | If | | | | | | | | suc | | | | | | | | cessful | | | | | | | | the | | | | | | | | updated | | | | | | | | state | | | | | | | | is | | | | | | | | entered | | | | | | | | and the | | | | | | | | call | | | | | | | | may be | | | | | | | | made. | | | | | | | | | | | | | | | | 4): The | | | | | | | | MS is | | | | | | | | in the | | | | | | | | null | | | | | | | | state | | | | | | | | from | | | | | | | | switch | | | | | | | | on | | | | | | | | until | | | | | | | | it has | | | | | | | | camped | | | | | | | | on a | | | | | | | | cell | | | | | | | | and | | | | | | | | either | | | | | | | | made an | | | | | | | | LR | | | | | | | | attempt | | | | | | | | or | | | | | | | | decided | | | | | | | | that no | | | | | | | | LR | | | | | | | | attempt | | | | | | | | is | | | | | | | | needed. | | | | | | | | | | | | | | | | 5): In | | | | | | | | this | | | | | | | | state, | | | | | | | | IMSI | | | | | | | | detach | | | | | | | | is | | | | | | | | pe | | | | | | | | rformed | | | | | | | | if the | | | | | | | | MS is | | | | | | | | deac | | | | | | | | tivated | | | | | | | | and the | | | | | | | | BCCH | | | | | | | | in | | | | | | | | dicates | | | | | | | | that | | | | | | | | IMSI | | | | | | | | attach | | | | | | | | /detach | | | | | | | | shall | | | | | | | | be | | | | | | | | used. | | | | | | | | An LR | | | | | | | | request | | | | | | | | ind | | | | | | | | icating | | | | | | | | IMSI | | | | | | | | attach | | | | | | | | is | | | | | | | | pe | | | | | | | | rformed | | | | | | | | if the | | | | | | | | MS is | | | | | | | | ac | | | | | | | | tivated | | | | | | | | in the | | | | | | | | same | | | | | | | | regis | | | | | | | | tration | | | | | | | | area in | | | | | | | | which | | | | | | | | it was | | | | | | | | deac | | | | | | | | tivated | | | | | | | | while | | | | | | | | being | | | | | | | | in this | | | | | | | | state. | | | | | | | | | | | | | | | | 6): An | | | | | | | | MS | | | | | | | | shall | | | | | | | | not | | | | | | | | perform | | | | | | | | a new | | | | | | | | LR when | | | | | | | | the new | | | | | | | | routing | | | | | | | | area is | | | | | | | | part of | | | | | | | | an LA | | | | | | | | or TA | | | | | | | | co | | | | | | | | ntained | | | | | | | | in any | | | | | | | | of the | | | | | | | | lists | | | | | | | | \"fo | | | | | | | | rbidden | | | | | | | | l | | | | | | | | ocation | | | | | | | | areas | | | | | | | | for | | | | | | | | roa | | | | | | | | ming\", | | | | | | | | \"fo | | | | | | | | rbidden | | | | | | | | t | | | | | | | | racking | | | | | | | | areas | | | | | | | | for | | | | | | | | roa | | | | | | | | ming\", | | | | | | | | \"5GS | | | | | | | | fo | | | | | | | | rbidden | | | | | | | | t | | | | | | | | racking | | | | | | | | areas | | | | | | | | for | | | | | | | | roa | | | | | | | | ming\", | | | | | | | | \"fo | | | | | | | | rbidden | | | | | | | | l | | | | | | | | ocation | | | | | | | | areas | | | | | | | | for | | | | | | | | r | | | | | | | | egional | | | | | | | | pr | | | | | | | | ovision | | | | | | | | of | | | | | | | | ser | | | | | | | | vice\", | | | | | | | | \"fo | | | | | | | | rbidden | | | | | | | | t | | | | | | | | racking | | | | | | | | areas | | | | | | | | for | | | | | | | | r | | | | | | | | egional | | | | | | | | pr | | | | | | | | ovision | | | | | | | | of | | | | | | | | ser | | | | | | | | vice\", | | | | | | | | \"5GS | | | | | | | | fo | | | | | | | | rbidden | | | | | | | | t | | | | | | | | racking | | | | | | | | areas | | | | | | | | for | | | | | | | | r | | | | | | | | egional | | | | | | | | pr | | | | | | | | ovision | | | | | | | | of | | | | | | | | se | | | | | | | | rvice\" | | | | | | | | or the | | | | | | | | new | | | | | | | | cell is | | | | | | | | a CSG | | | | | | | | cell | | | | | | | | which | | | | | | | | is not | | | | | | | | part of | | | | | | | | any of | | | | | | | | the | | | | | | | | lists | | | | | | | | \" | | | | | | | | Allowed | | | | | | | | CSG | | | | | | | | list\", | | | | | | | | \"O | | | | | | | | perator | | | | | | | | CSG | | | | | | | | list\". | | | | | | | | | | | | | | | | 7): The | | | | | | | | con | | | | | | | | ditions | | | | | | | | in | | | | | | | | which | | | | | | | | the | | | | | | | | GPRS | | | | | | | | and/or | | | | | | | | n | | | | | | | | on-GPRS | | | | | | | | regis | | | | | | | | tration | | | | | | | | status | | | | | | | | \"Idle, | | | | | | | | No | | | | | | | | IMSI\" | | | | | | | | is | | | | | | | | entered | | | | | | | | are | | | | | | | | sp | | | | | | | | ecified | | | | | | | | in | | | | | | | | su | | | | | | | | bclause | | | | | | | | 4.3.3. | | | | | | | | | | | | | | | | 8): A | | | | | | | | MS | | | | | | | | shall | | | | | | | | perform | | | | | | | | a LR if | | | | | | | | it has | | | | | | | | entered | | | | | | | | a | | | | | | | | regis | | | | | | | | tration | | | | | | | | area | | | | | | | | w | | | | | | | | hatever | | | | | | | | the | | | | | | | | regis | | | | | | | | tration | | | | | | | | area | | | | | | | | stored | | | | | | | | in the | | | | | | | | MS. | | | | | | | +---------+---------+---------+---------+---------+---------+---------+
Figure 1: Overall Idle Mode process
The individual steps are the following (they are not necessarily executed in
the number sequence):
(1) The PLMN selection mode is set (e.g. by the user via the user interface or
by AT command).
(2) The list of available PLMNs is presented to the user, according to the
rules given in subclause 4.4.3.1.2.
(3) In manual PLMN selection mode the user selects from the available PLMNs.
(4) If the MS supports CSGs, the list of available PLMNs and CSGs, together
with an indication as to which of the available CSGs is in the Allowed or
Operator CSG list, is presented to the user upon request. The detailed rules
are defined in subclause 5.5.4 of 3GPP TS 22.220 [49].
(5) Only for MSs supporting CSGs: when camping on a cell, the available CSGs
(with PLMN information) are conveyed to the CSG selection/restriction
procedure (see subclause 3.1A).
(6) Only for MSs supporting CSGs: in manual CSG selection mode the user
selects from the available CSGs.
(7) Only for MSs supporting CSGs: if the selected CSG is associated with the
RPLMN, the MS performs selection of a cell belonging to this CSG.
(8) Only for MSs supporting CSGs: if the selected CSG is associated with a
PLMN different from the RPLMN, the MS enters the PLMN selection process and
performs the parts applicable after manual selection of a PLMN.
(9) After it has selected a PLMN, the MS performs selection of a cell
belonging to this PLMN; this selection is additionally restricted by the
selected CSG, if the PLMN selection was triggered by a manual CSG selection.
(10) After having selected a new cell and the registration area has changed,
the MS shall enter the LR process (see figure 3).
(10a) A MS\'s CM requests may lead to a registration request.
(11) If the LR is not successful, and if the cause received from the network
does not exclude the RPLMN, the MS performs another cell selection (i.e. cell
re-selection) within the RPLMN.
> (12) The information on available PLMNs, as detected by the cell selection
> process from detectable broadcast information, is made available to the PLMN
> selection process.
>
> (13) If the LR is not successful, and if the cause received from the network
> excludes the RPLMN, the MS performs PLMN selection.
>
> (14) The positive result of cell selection (suitable cell and in updated
> state, or in connected mode having been camped on a suitable cell) and
> location registration (updated, for MSs capable of services requiring
> registration) is indicated to the user.
Possible sequences of steps are e.g.:
1) 1 2  3  9  10  11 (manual PLMN selection, MS is not CSG capable)
2) 1  9  4  5  6  8  9  10  11 (automatic PLMN selection, MS is CSG
capable, manual CSG selection);
Figure 2a: PLMN Selection State diagram (automatic mode)
Figure 2b: PLMN Selection State diagram (manual mode)
NOTE 1: Whenever the MS goes to connected mode and then returns to idle mode
again the MS selects appropriate state.
NOTE 2: A MS capable of GPRS and non-GPRS services has two Task State machines
one for GPRS and one for non-GPRS operation.
Figure 3: Location Registration Task State diagram
# 6 MS supporting access technologies defined both by 3GPP and 3GPP2
## 6.1 General
An MS that supports access technologies defined both by 3GPP and 3GPP2 (see
3GPP TS 31.102 [40]) shall consider all supported access technologies in all
supported bands when performing PLMN selection.
The goal of the PLMN selection process for such a multi mode MS is to find the
highest priority PLMN and to attempt to register to it.
A multi mode MS shall follow the requirements in the present document for the
PLMN selection procedures across both 3GPP and 3GPP2 access technologies.
Additionally, the MS shall follow the requirements of the present document in
its signalling procedures towards any 3GPP network. If the common PLMN
selection procedure leads to selection of a 3GPP2 network, then the MS shall
follow 3GPP2 specifications **_in meeting any 3GPP2 specific system selection
constraints and_** in all signalling procedures towards the 3GPP2 network.
While registered to VPLMN via 3GPP2 access, the MS shall follow the 3GPP2
specifications for scan of higher priority PLMNs. Additionally to the
requirements specified for 3GPP2 system, a multi mode MS while registered to a
3GPP2 VPLMN shall follow the requirements specified in subclause 4.4.3.3.
NOTE: It is assumed that the MS can determine the PLMN identity of networks
supporting 3GPP2 technologies from the information broadcast over the air.
###### ## Annex A (normative): HPLMN Matching Criteria
With the introduction of PCS1900 with the regulatory mandate to allocate
3-digit MNC codes, additional functionality is required to identify the HPLMN.
##### Assumptions {#assumptions .H6}
An MNC code shall consist of 2 or 3 decimal digits. In NA PCS1900, all SIMs
shall store 3 digit MNCs.
Any network using a 2 digit MNC code shall broadcast the hexadecimal code
\"F\" in place of the 3^rd^ digit.
For PCS1900 for North America, regulations mandate that a 3-digit MNC shall be
used; however during a transition period, a 2 digit MNC may be broadcast by
the Network and, in this case, the 3^rd^ digit of the SIM is stored as 0 (this
is the 0 suffix rule).
With the exception of North America during the transition period:
a) Within a single country (or area identified by a MCC) all networks shall
broadcast a 2 digit MNC code, or all networks shall broadcast a 3 digit MNC
code. A mixture of broadcast 2 and 3 digit MNC codes is not permitted within a
single country (or area identified by a MCC).
b) A network which broadcasts a 2 digit MNC code, will issue SIMs with a 2
digit MNC code in the IMSI on the SIM. A network which broadcasts a 3 digit
MNC code, will issue SIMs with a 3 digit MNC code in the IMSI on the SIM.
##### Definitions and abbreviations {#definitions-and-abbreviations-1 .H6}
**BCCH-MCC** For GERAN, the MCC part of the LAI read from System Information
type 3 messages broadcast on the BCCH by the network (see 3GPP TS 44.018
[34]), for UTRA, the MCC part of the PLMN broadcasted as specified in 3GPP TS
25.331 [33], for E-UTRA, the MCC part of the PLMN broadcasted as specified in
3GPP TS 36.331 [42], or for NR, the MCC part of the PLMN broadcasted as
specified in 3GPP TS 38.331 [65].
**BCCH-MNC** For GERAN the MNC part of the LAI read from System Information
type 3 messages broadcast on the BCCH by the network (see 3GPP TS 44.018
[34]), for UTRA, the MNC part of the PLMN broadcasted as specified in 3GPP TS
25.331 [33], for E-UTRA, the MNC part of the PLMN broadcasted as specified in
3GPP TS 36.331 [42], or for NR, the MNC part of the PLMN broadcasted as
specified in 3GPP TS 38.331 [65].
**SIM-MCC** The MCC part of the IMSI or of additional entries in the EHPLMN
list read from the SIM.
**SIM-MNC** The MNC part of the IMSI or of additional entries in the EHPLMN
list read from the SIM.
##### HPLMN Matching Criteria in mobiles which don't support PCS1900 for NA:
{#hplmn-matching-criteria-in-mobiles-which-dont-support-pcs1900-for-na .H6}
Figure A.1 illustrates the logic flow described below. The text below is
normative. Figure A.1 is informative.
(1) The MS shall compare using all 3 digits of the SIM-MCC with the BCCH-MCC.
If the values do not match, then the HPLMN match fails.
NOTE: If the MCC codes match, then the number of digits used for the SIM-MNC
must be the same as the number of digits used for the BCCH-MNC.
(2) The MS shall read the 3^rd^ digit of the BCCH-MNC. If the 3^rd^ digit is
Hex F, then proceed to step (4).
(3) The MS shall compare using all 3 digits of the SIM-MNC with the BCCH-MNC.
If the values match, then the HPLMN match succeeds, otherwise the HPLMN match
fails.
(4) The MS shall compare using just the 1^st^ 2 digits the SIM-MNC with the
BCCH-MNC. If the values match, then the HPLMN match succeeds, otherwise the
HPLMN match fails.
If the EHPLMN list is present and is empty or if the EHPLMN list is not
present, the matching procedure shall be done for the MCC/MNC of the IMSI.
If the EHPLMN list is present and is not empty, the matching procedure shall
be done for all entries in the EHPLMN list until a match is found or all
matches fail.
{width="5.528472222222222in" height="4.93125in"}
Figure A.1: HPLMN Matching Criteria Logic Flow for mobiles which support GSM
and DCS1800 (informative)
##### HPLMN Matching Criteria for mobiles which support PCS1900 for NA:
{#hplmn-matching-criteria-for-mobiles-which-support-pcs1900-for-na .H6}
Figure A.2 illustrates the logic flow described below. The text below is
normative. Figure A.2 is informative.
(1) The MS shall compare using all 3 digits the SIM-MCC with the BCCH-MCC. If
the values do not match, then the HPLMN match fails.
(2) The MS shall read the 3^rd^ digit of the BCCH-MNC. If the 3^rd^ digit is
Hex F, then proceed to step (4).
(3) The MS shall compare using all 3 digits the SIM-MNC with the BCCH-MNC. If
the values match, then the HPLMN match succeeds, otherwise the HPLMN match
fails.
NOTE: These rules (1) -- (3) are the same as for mobiles which don't support
PCS1900 for NA, except step (4) is different.
(4) The MS shall determine if the BCCH-MCC lies in the range 310-316 (i.e.,
whether this network is a PCS1900 for NA network). If the BCCH-MCC lies
outside the range 310-316, then proceed to step (6).
(5) The MS shall compare the 3^rd^ digit of the SIM-MNC with '0'. If the 3^rd^
digit is not '0' then the HPLMN match fails.
NOTE: This is the '0' suffix rule.
(6) The MS shall compare using just the 1^st^ 2 digits of the SIM-MNC with the
BCCH-MNC. If the values match, then the HPLMN match succeeds, otherwise the
HPLMN match fails.
NOTE: When PCS1900 for NA switches over to broadcasting 3 digit MNCs in
**all** networks, then the additional requirements for PCS1900 for NA can be
deleted.
If the EHPLMN list is present and is empty or if the EHPLMN list is not
present, the matching procedure shall be done for the MCC/MNC of the IMSI.
If the EHPLMN list is present and is not empty, the matching procedure shall
be done for all entries in the EHPLMN list until a match is found or all
matches fail.
##### Guidance for Networks in PCS1900 for NA {#guidance-for-networks-in-
pcs1900-for-na .H6}
There may be some problems in the transition period from broadcasting 2 MNC
digits to broadcasting 3 MNC digits. Here are some guidelines to avoid these
problems.
(1) Existing network codes. Operators who currently use a 2 digit BCCH-MNC
**xy** should use the new code **xy0**.
(2) New operators allocated 3 digit MNC codes with the same 1^st^ 2 digits as
an existing operator shall not use a 3^rd^ digit of 0.
Figure A.2: HPLMN Matching Criteria Logic Flow for mobiles which support
PCS1900 for NA (informative)
###### ## Annex B (normative): PLMN matching criteria to be of same country as
VPLMN
While a MS is roaming on a VPLMN, **the VPLMN and a PLMN are of the same
country only if their MCC values identify the same country.** See subclause
1.2 for the definition of country.
###### ## Annex C (normative): Control plane solution for steering of roaming
in 5GS
# C.0 Requirements for 5G steering of roaming over the control plane
In addition to the requirements specified in 3GPP TS 22.011 [9] subclause
3.2.2.8, the requirements in this subclause apply.
The UE supporting N1 mode shall support the control plane solution for
steering of roaming in 5GS. If the HPLMN supports and wants to use the control
plane solution for steering of roaming in 5GS, then the HPLMN shall provide
the steering of roaming information to the UE using the control plane
mechanism defined in this annex.
The VPLMN shall transparently relay the steering of roaming information
received from the HPLMN to the UE. The UE shall be able to detect whether the
VPLMN removed the steering of roaming information during the initial
registration procedure in the VPLMN. The UE shall be able to detect whether
the VPLMN altered the steering of roaming information. If the UE detects that
the VPLMN altered or removed the steering of roaming information then the UE
shall consider the current VPLMN as the lowest priority PLMN and perform PLMN
selection as defined in this annex.
# C.1 General
The purpose of the control plane solution for steering of roaming in 5GS
procedure is to allow the HPLMN to update the \"Operator Controlled PLMN
Selector with Access Technology\" list in the UE by providing the HPLMN
protected list of preferred PLMN/access technology combinations via NAS
signalling. The HPLMN updates the \"Operator Controlled PLMN Selector with
Access Technology\" based on the operator policies, which can be based on the
registered VPLMN, the location of the UE, etc.
The HPLMN can configure their subscribed UE\'s USIM to indicate that the UE is
expected to receive the steering of roaming information due to initial
registration in a VPLMN. At the same time the HPLMN will mark the UE is
expected to receive the steering of roaming information due to initial
registration in a VPLMN, in the subscription information in the UDM. In this
case, it is mandatory for the HPLMN to provide the steering of roaming
information to the UE during initial registration in a VPLMN. Otherwise if
such configuration is not provided in the USIM, it is optional for the HPLMN
to provide the steering of roaming information to the UE during initial
registration (based on operator policy). The HPLMN can provide the steering of
roaming information to the UE during the registration procedure for mobility
and periodic registration update. In addition, the HPLMN can request the UE to
provide an acknowledgement of successful reception of the steering of roaming
information.
If:
\- the UE\'s USIM is configured to indicate that the UE shall expect to
receive the steering of roaming information during initial registration
procedure but did not receive it or security check on the steering of roaming
information fails;
\- the current chosen VPLMN is not contained in the list of \"PLMNs where
registration was aborted due to SOR\";
\- the current chosen VPLMN is not part of \"User Controlled PLMN Selector
with Access Technology\" list; and
\- the UE is not in manual mode of operation;
then the UE will perform PLMN selection with the current VPLMN considered as
lowest priority.
It is mandatory for the VPLMN to transparently forward to the UE the steering
of roaming information received from HPLMN and to transparently forward to the
HPLMN the acknowledgement of successful reception of the steering of roaming
information received from UE, both while the UE is trying to register onto the
VPLMN as described in subclause C.2, and after the UE has registered onto the
VPLMN as described in subclause C.3.
The procedure in this annex for steering of UE in VPLMN can be initiated by
the network while the UE is trying to register onto the VPLMN as described in
subclause C.2, or after the UE has registered onto the VPLMN as described in
subclause C.3.
# C.2 Stage-2 flow for steering of UE in VPLMN during registration
The stage-2 flow for the case when the UE registers with VPLMN AMF is
described below in figure C.2.1:
Figure C.2.1: Procedure for providing list of preferred PLMN/access technology
combinations
For the steps below, security protection is described in 3GPP TS 33.501 [24].
1) The UE to the VPLMN AMF: The UE initiates registration by sending
REGISTRATION REQUEST message to the VPLMN AMF;
2) The VPLMN AMF to the HPLMN UDM: The VPLMN AMF executes the registration
procedure as defined in subclause 4.2.2.2.2 of 3GPP TS 23.502 [63]. As part of
the registration procedure, the VPLMN AMF invokes Nudm_SDM_Get service
operation message to the HPLMN UDM to get amongst other information the Access
and Mobility Subscription data for the UE (see step 14b in subclause 4.2.2.2.2
of 3GPP TS 23.502 [63]);
3) If the user subscription information indicates to send the steering of
roaming information due to initial registration in a VPLMN, then the HPLMN UDM
shall provide the steering of roaming information to the UE when the UE
performs initial registration in a VPLMN, otherwise the HPLMN UDM may provide
the steering of roaming information to the UE, based on operator policy;
4) The HPLMN UDM to the VPLMN AMF: The HPLMN UDM sends a response to the
Nudm_SDM_Get service operation to the VPLMN AMF, which includes the steering
of roaming information within the Access and Mobility Subscription data. The
Access and Mobility Subscription data type is defined in subclause 5.2.3.3.1
of 3GPP TS 23.502 [63]). The HPLMN may also request the UE to acknowledge the
successful security check of the received steering of roaming information, by
providing the indication as part of the steering of roaming information in the
Nudm_SDM_Get response service operation;
5) The VPLMN AMF to the HPLMN UDM: As part of the registration procedure, the
VPLMN AMF also invokes Nudm_SDM_Subscribe service operation to the HPLMN UDM
to subscribe to notification of changes of the subscription data received in
step 4) including notification of updates of the steering of roaming
information included in the Access and Mobility Subscription data (see step
14c in subclause 4.2.2.2.2 of 3GPP TS 23.502 [63]);
6) The VPLMN AMF to the UE: The VPLMN AMF shall transparently send the
received steering of roaming information to the UE in the REGISTRATION ACCEPT
message;
7) If the steering of roaming information is received and the security check
is successful, then:
a) if the steering of roaming information contains a secured packet (see 3GPP
TS 31.115 [67]):
\- if the UDM has not requested an acknowledgement from the UE the UE shall
send the REGISTRATION COMPLETE message;
\- the ME shall upload the secured packet to the USIM using procedures in 3GPP
TS 31.111 [41];
NOTE 1: How the ME handles UICC responses and failures in communication
between the ME and UICC is implementation specific and out of scope of this
release of the specification.
\- if the UDM has not requested an acknowledgement from the UE and the ME
receives a USAT REFRESH command qualifier (3GPP TS 31.111 [41]) of type
\"Steering of Roaming\" it shall perform items a), b) and c) of the procedure
for steering of roaming in subclause 4.4.6 and if the UE has a list of
available and allowable PLMNs in the area and based on this list the UE
determines that there is a higher priority PLMN than the currently camped
chosen VPLMN and the UE is in automatic network selection mode, then the UE
shall either:
i) release the current N1 NAS signalling connection locally and then attempt
to obtain service on a higher priority PLMN as specified in subclause 4.4.3.3
by acting as if timer T that controls periodic attempts has expired. In this
case, steps 8 to 11 are skipped; or
ii) not release the current N1 NAS signalling connection locally and skip
steps 8 to 10;
b) if the steering of roaming information contains the list of preferred
PLMN/access technology combinations, the ME shall replace the highest priority
entries in the \"Operator Controlled PLMN Selector with Access Technology\"
list stored in the ME with the received list of preferred PLMN/access
technology combinations. Additionally, if the UDM has not requested an
acknowledgement from the UE and if the UE has a list of available and
allowable PLMNs in the area and based on this list the UE determines that
there is a higher priority PLMN than the currently camped chosen VPLMN and the
UE is in automatic network selection mode, then the UE shall send the
REGISTRATION COMPLETE message to the serving AMF without including an SOR
transparent container and then either:
i) release the current N1 NAS signalling connection locally and then attempt
to obtain service on a higher priority PLMN as specified in subclause 4.4.3.3
by acting as if timer T that controls periodic attempts has expired. In this
case, steps 8 to 11 are skipped; or
ii) not release the current N1 NAS signalling connection locally and skip
steps 8 to 10;
8) If:
a) the UE\'s USIM is configured with indication that the UE is to receive the
steering of roaming information due to initial registration in a VPLMN, but
neither the list of preferred PLMN/access technology combinations nor the
secured packet nor the HPLMN indication that \'no change of the \"Operator
Controlled PLMN Selector with Access Technology\" list stored in the UE is
needed and thus no list of preferred PLMN/access technology combinations is
provided\' is received in the REGISTRATION ACCEPT message, when the UE
performs initial registration in a VPLMN or if the steering of roaming
information is received but the security check is not successful; and
b) the current chosen VPLMN is not contained in the list of \"PLMNs where
registration was aborted due to SOR\", not part of \"User Controlled PLMN
Selector with Access Technology\" list, the UE is not in manual mode of
operation and the PDU session for emergency services is not pending to be
activated;
then the UE shall send the REGISTRATION COMPLETE message to the serving AMF
without including an SOR transparent container, release the current N1 NAS
signalling connection locally, store the PLMN identity in the list of \"PLMNs
where registration was aborted due to SOR\" and attempt to obtain service on a
higher priority PLMN as specified in subclause 4.4.3.3 by acting as if timer T
that controls periodic attempts has expired, with an exception that the
current PLMN is considered as lowest priority, and skip steps 9 to 12;
NOTE 2: When the UE is in the manual mode of operation or the current chosen
VPLMN is part of the \"User Controlled PLMN Selector with Access Technology\"
list, the UE stays on the VPLMN.
9) The UE to the VPLMN AMF: If the UDM has requested an acknowledgement from
the UE:
the UE verified that the steering of roaming information has been provided by
the HPLMN in step 7, the UE sends the REGISTRATION COMPLETE message to the
serving AMF with an SOR transparent container including the UE
acknowledgement; and
if the steering of roaming information contained a secured packet and the
security check was successful, then when the UE receives the USAT REFRESH
command qualifier of type \"Steering of Roaming\", it performs items a), b)
and c) of the procedure for steering of roaming in subclause 4.4.6.
10) The AMF to the UDM: If an SOR transparent container is received in the
REGISTRATION COMPLETE message, the AMF uses the Nudm_SDM_Info service
operation to provide the received SOR transparent container to the UDM. If the
HPLMN decided that the UE is to acknowledge the successful security check of
the received steering of roaming information in step 4, the UDM verifies that
the acknowledgement is provided by the UE as specified in 3GPP TS 33.501 [66];
11) If the UE has a list of available PLMNs in the area and based on this list
the UE determines that there is a higher priority PLMN than the currently
camped chosen VPLMN and the UE is in automatic network selection mode, then
the UE shall attempt to obtain service on a higher priority PLMN as specified
in subclause 4.4.3.3 by acting as if timer T that controls periodic attempts
has expired after the release of the N1 NAS signalling connection. If the N1
NAS signaling connection is not released after implementation dependent time,
the UE may locally release the N1 signaling connection except when the UE is
registered for emergency services or the UE has an established emergency PDU
session (see 3GPP TS 24.501 [64]); and
12) The UE deletes the list of \"PLMNs where registration was aborted due to
SOR\".
The list of \"PLMNs where registration was aborted due to SOR\" is deleted
when the UE is switched off or the USIM is removed.
When the UE performs registration procedure for emergency services (see 3GPP
TS 24.501 [64] and 3GPP TS 23.502 [63]) while the UE has a valid USIM and the
AMF performs the authentication procedure, then based on HPLMN policy, the SOR
procedure described in this subclause may apply.
NOTE 3: The HPLMN/UDM cannot distinguish between \"initial registration\" and
\"emergency registration\" thus SOR implicitly applies for emergency
registration.
# C.3 Stage-2 flow for steering of UE in VPLMN after registration
The stage-2 flow for the steering of UE in VPLMN after registration is
indicated in figure C.3.1.
{width="6.686805555555556in" height="3.0215277777777776in"}Figure C.3.1:
Procedure for providing list of preferred PLMN/access technology combinations
after registration
For the steps below, security protection is described in 3GPP TS 33.501 [24].
1) The UDM to the AMF: The UDM notifies the changes of the user profile to the
affected AMF by the means of invoking Nudm_SDM_Notification service operation.
The Nudm_SDM_Notification service operation contains the steering of roaming
information that needs to be delivery transparently to the UE over NAS within
the Access and Mobility Subscription data. If the HPLMN decided that the UE is
to acknowledge successful security check of the received steering of roaming
information, the Nudm_SDM_Notification service operation also contains an
indication that the UDM requests an acknowledgement from the UE as part of the
steering of roaming information;
2) The AMF to the UE: the AMF sends a DL NAS TRANSPORT message to the served
UE. The AMF includes in the DL NAS TRANSPORT message the steering of roaming
information received from the UDM.
3) Upon receiving the steering of roaming information, the UE shall perform a
security check on the list of preferred PLMN/access technology combinations
included in the DL NAS TRANSPORT message to verify that the list of preferred
PLMN/access technology combinations is provided by HPLMN, and:
a) if the security check is successful and:
\- if the steering of roaming information contains a secured packet (see 3GPP
TS 31.115 [67]), the ME shall upload the secured packet to the USIM using
procedures in 3GPP TS 31.111 [41];
NOTE 1: How the ME handles UICC responses and failures in communication
between the ME and UICC is implementation specific and out of scope of this
release of the specification.
When the ME receives a USAT REFRESH command qualifier (see 3GPP TS 31.111
[41]) of type \"Steering of Roaming\" it performs the procedure for steering
of roaming in subclause 4.4.6 with an exception that if the UE is in automatic
network selection mode, then the UE shall wait until it moves to idle mode or
5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64])
before attempting to obtain service on a higher priority PLMN (specified in
subclause 4.4.6 bullet d);
\- otherwise, the ME shall replace the highest priority entries in the
\"Operator Controlled PLMN Selector with Access Technology\" list stored in
the ME with the received list of preferred PLMN/access technology
combinations. If the UE is in automatic network selection mode, then the UE
shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC
inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain
service on a higher priority PLMN as specified in subclause 4.4.3.3 by acting
as if timer T that controls periodic attempts has expired.
If the last established PDU session is an emergency PDU session then the UE
shall attempt to perform the PLMN selection after the release of the emergency
PDU session and expiration of timer T.
If the UDM has not requested an acknowledgement from the UE then steps 4 and 5
are skipped; and
b) if the security check is not successful and the UE is in automatic network
selection mode, then the UE shall wait until it moves to idle mode or 5GMM-
CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before
attempting to obtain service on a higher priority PLMN as specified in
subclause 4.4.3.3 by acting as if timer T that controls periodic attempts has
expired, with an exception that the current PLMN is considered as lowest
priority. If the last established PDU session is an emergency PDU session then
the UE shall attempt to perform the PLMN selection after the release of the
emergency PDU session and expiration of timer T.
If the UDM has not requested an acknowledgement from the UE then steps 4 and 5
are skipped;
NOTE 2: When the UE is in the manual mode of operation or the current chosen
VPLMN is part of the \"User Controlled PLMN Selector with Access Technology\"
list, the UE stays on the VPLMN.
4) The UE to the AMF: if the UDM has requested an acknowledgement from the UE
in the DL NAS TRANSPORT message and the security check in step 2 was
successful, the UE sends an UL NAS TRANSPORT message to the serving AMF with
an SOR transparent container including the UE acknowledgement; and
5) The AMF to the UDM: If the UL NAS TRANSPORT message with an SOR transparent
container is received, the AMF uses the Nudm_SDM_Info service operation to
provide the received SOR transparent container to the UDM. If the HPLMN
decided that the UE is to acknowledge successful security check of the
received list of preferred PLMN/access technology combinations in step 1, the
UDM verifies that the acknowledgement is provided by the UE.
#