# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies for User Equipment (UE), in UMTS system, for
FDD and TDD modes, those UE functions that are required for conformance
testing purposes.
For conformance tests, functions are activated via the radio interface. These
functions shall be capable of being activated when a test USIM is present. Any
USIM related features such as subsidy-related UE features should also not
interfere with the functions. In the loopback state, the UE shall be able to
perform all functions specified in the present document except where otherwise
stated; in addition however, the conformance testing functions must be
operational.
USIM, in general, is described in TS 31.101 [7]. The ME recognises the test
USIM by the Administrative Data Field. Test USIM data fields are described in
TS 34.108 [10].
The present document applies to the unit that includes the hardware to
establish a connection across the radio interface.
# 2 References
The following documents contain provisions that, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
aspects\".
[2] 3GPP TS 24.008: \"Mobile radio interface layer 3 specification; Core
Network Protocols; Stage 3\".
[3] 3GPP TS 25.101: \"UE Radio transmission and reception (FDD)\".
[4] 3GPP TS 25.102: \"UTRA (UE) TDD; Radio transmission and reception\".
[5] 3GPP TS 25.331: \"Radio Resource Control (RRC); protocol specification\".
[6] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[7] 3GPP TS 31.101: \"UICC-Terminal Interface; Physical and Logical
Characteristics\".
[8] 3GPP TS 34.121: \"Terminal Conformance Specification; Radio Transmission
and Reception (FDD)\".
[9] 3GPP TS 34.122: \"Terminal Conformance Specification; Radio Transmission
and Reception (TDD)\".
[10] 3GPP TS 34.108: \"Common Test Environments for User Equipment (UE)
Conformance Testing\".
[11] 3GPP TS 25.211: \"Physical channels and mapping of transport channels
onto physical channels (FDD)\".
[12] 3GPP TS 25.133: \"Requirements for support of Radio Resource Management
(FDD)\".
[13] 3GPP TS 44.014: \"Individual equipment type requirements and
interworking; Special conformance testing functions\".
[14] 3GPP TS 27.005: \"Use of Data Terminal Equipment - Data Circuit
terminating Equipment (DTE - DCE) interface for Cell Broadcast Service
(CBS)\".
[15] 3GPP TS 27.007: \"AT command set for User Equipment (UE)\".
[16] 3GPP TS 27.060: \"Mobile Stations (MS) supporting packet switched
services\".
[17] 3GPP TS 34.123-2: \"User Equipment (UE) conformance specification; Part
2: Implementation Conformance Statement (ICS) proforma specification\".
[18] 3GPP TS 25.306: \"UE Radio Access capabilities\".
[19] 3GPP TS 25.322: \"Radio Link Control (RLC) protocol specification\".
[20] 3GPP TS 23.060: \"General Packet Radio Service (GPRS) Service Description
Stage 2\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the following terms and definitions
apply:
**UE (User Equipment):** user equipment that is under test.
**SS (System Simulator):** test system (or equipment) that drives the test
process between UE, like BS (Base Station) simulator.
**User:** test user, who handles the test and measurement process via the
logical test interface.
**Logical Test Interface:** interface which provides the logical service to
interwork and to communicate between UE and System Simulator during the test
of a UE.
**TC (Test Control):** UE protocol entity used by the SS to control the UE
specific testing functions.
## 3.2 Abbreviations
Abbreviations used in the present document are listed in TR 21.905 [6].
For the purposes of the present document, the following abbreviations apply:
IP Internet Protocol
LB Loop Back
RAB Radio Access Bearer
RB Radio Bearer
SAPI Service Access Point Indicator
SS System Simulator
TC Test Control
TFT Traffic Flow Template
UICC UMTS Integrated Circuit Card
UL TFT Uplink Traffic Flow Template
# 4 UE conformance test functions
## 4.1 General description
The SS performs activation and deactivation of the conformance test functions
in the UE by sending standard NAS Layer 3 messages. A specific protocol
discriminator value has been defined in TS 24.007 [1], subclause 11.2.3.1.1
for the UE test command messages. Figure 4.1.1 illustrates the Layer 3
protocol entity Test Control (TC) where the UE test command messages
terminates.
NOTE: The protocol discriminator value used for the TC messages is the same as
used in GSM for the MS specific testing functions, see TS 44.014 [13].
Figure 4.1.1: TC protocol termination (TC =Test Control)
Apart from sending the appropriate deactivation command to the UE the
functions shall be deactivated by switching off the UE.
The following UE conformance testing functions can be activated (and
deactivated):
\- UE test loop function;
\- UE radio bearer test mode;
\- Electrical Man Machine Interface (EMMI).
In addition to the conformance testing functions listed above there is a set
of reference measurement channels that a UE need to support to enable RF
conformance testing. The reference measurement channels are defined in TS
34.121 [8], Annex C for FDD and in TS 34.122 [9], Annex C for TDD.
Example of reference measurement channels (RMC) essential to all UEs
supporting FDD or TDD are:
\- UL 12.2 kbps RMC (Reference Measurement Channel);
\- DL 12.2 kbps RMC.
Example of reference measurement channels associated with UE service
capabilities for FDD (DL and UL) and TDD (DL only) are:
\- DL 64 kbps RMC;
\- DL 144 kbps RMC;
\- DL 384 kbps RMC;
\- UL 64 kbps RMC;
\- UL 144 kbps RMC;
\- UL 384 kbps RMC.
## 4.2 UE radio bearer test mode
The UE radio bearer test mode is specified in subclause 5.2.
The following TC procedures are used to control the UE radio bearer test mode:
\- Activate UE radio bearer test mode;
\- Deactivate UE radio bearer test mode.
## 4.3 UE test loop
The UE test loop function is specified in subclause 5.3.
The following TC procedures are used to control the UE test loop function:
\- Close UE test loop;
\- Open UE test loop.
A prerequisite for the UE test loop function is that the UE radio bearer test
mode is active.
## 4.4 EMMI
The EMMI is specified in clause 7.
No specific TC procedures are associated with EMMI.
# 5 Test Control (TC) protocol procedures and test loop operation
## 5.1 General description
The UE test loop function provides access to isolated functions of the UE via
the radio interface without introducing new physical interfaces just for the
reason of conformance testing.
NOTE: It should be emphasised that the UE test loop function only describes
the functional behaviour of the UE with respect to its external interfaces;
physical implementation of the UE test loop function is completely left open
to the manufacturer.
The UE test loop function is activated by transmitting the appropriate Test
Control (TC) message to the UE, see clause 6.
For the purposes of this specification only, the following definitions are
used:
Bidirectional Radio Bearer:
> If the \"RB mapping info\" information element ([5] subclause 10.3.4.21) for
> the currently active configuration of a radio bearer includes mappings to
> both uplink and downlink transport channels then this radio bearer is
> defined to be a bidirectional radio bearer.
Unidirectional Radio Bearer:
> If the \"RB mapping info\" information element ([5] subclause 10.3.4.21) for
> the currently active configuration of a radio bearer includes mappings to
> only uplink or downlink transport channels then this radio bearer is defined
> to be a unidirectional radio bearer.
NOTE: This definition of unidirectional radio bearer is only applicable to RLC
Unacknowledged Mode, in this version of the specification.
The UE test loop function can be operated in four different loopback modes:
\- UE test loop mode 1;
\- UE test loop mode 2;
\- UE test loop mode 3; and
\- UE test loop mode 4.
UE test loop mode 1, 2 and 4 provide loopback of data for bidirectional radio
bearers. UE test loop mode 3 provides counting of successfully received RLC
SDUs on a given MTCH.
The UE test loop mode 1 and 2 are mandatory to all UEs. The UE test loop mode
3 is mandatory for UEs supporting MBMS. The UE test loop mode 4 is mandatory
for UEs supporting network initiated secondary PDP context.
Support of Update UE Location Information function is optional for the UE.
Figure 5.1.1 shows a functional block diagram of the UE test loop function for
UE test loop mode 1.
Figure 5.1.2 shows a functional block diagram of the UE test loop function for
UE test loop mode 3 applicable when testing reception of MBMS services not
operating in MBSFN mode.
Figure 5.1.3 shows a functional block diagram of UE test loop function for UE
test loop mode 3 applicable when testing MBMS services operating in MBSFN
mode. Test loop command/response messages are sent on the unicast carrier
while the UE test loop mode 3 operates on the MTCH on the MBSFN carrier.
Figure 5.1.4 shows a functional block diagram of UE test loop function for UE
test loop mode 4 applicable when testing network initiated secondary PDP
context and routing of UE uplink IP packets based on network signalled UL TFT.
For UE test loop mode 1 the loopback point is located above Layer 2. Depending
on the actual radio bearer setup loopback is performed of RLC SDUs or PDCP
SDUs according to the procedure specified in subclause 5.3.3.2.
For UE test loop mode 3 the UE counts each successfully received RLC SDU on
the MTCH configured for RLC SDU counting.
The loop back point for UE test loop mode 1 has been selected above Layer 2 to
separate the protocol configurations from the UE test loop function. By
configuration of RLC and MAC layers other loop back points may functional be
achieved. E.g. by transparent configuration of RLC and MAC layer functional
loop back point at Transport channel level can be achieved to implement the
reference measurement channels as specified by TS 34.121 [8], Annex C for FDD
and by TS 34.122 [9], Annex C for TDD.
For UE test loop mode 2 both data and CRC are looped back. UE test loop mode 2
is intended for Blind Transport Format Detection (BTFD) testing and BLER
testing of DL 12.2 kbps reference measurement channel for which loopback of
downlink CRC is required. UE test loop mode 2 can also be used for BLER
testing of DL 64, 144 and 384 kbps reference measurement channels if the UE
supports correspondent UL reference measurement channels. Both received data
and CRC bits for the DCH transport channel used for the BTFD test case is
returned according to the procedure specified in subclause 5.3.3.3.
The loop back point for UE test loop mode 4 has been selected above UE's
function for UL TFT handling. IP PDUs (=PDCP SDUs) received in downlink are
returned to the UL TFT handling SAP in the UE. The UE shall perform normal
operation of the UL TFT handling function while UE test loop mode 4 is active,
i.e. the UE shall perform routing of uplink IP packets to the uplink radio
bearers in accordance with the signalled UL TFT filters as specified in [20]
and [2].
A specific radio bearer test mode is specified to be used together with the UE
test loop function. The purpose of the radio bearer test mode is to put the UE
into a mode where: SS can set up radio bearers to be terminated in the UE test
loop function without having to involve CC or SM; and to disable any control
mechanisms in NAS protocols or in any UE applications that otherwise could
cause the RRC connection to be released.
Figure 5.1.1: UE Test Loop Mode 1 function (TC =Test Control, LB = Loop Back
entity)
Figure 5.1.2: UE test loop mode 3 for testing MBMS services not operating in
MBSFN mode
Figure 5.1.3: UE test loop mode 3 for testing MBMS services operating in MBSFN
mode
Figure 5.1.4: Model for UE Test Loop Mode 4 for testing UE UL TFT handling
## 5.2 UE radio bearer test mode procedures
### 5.2.1 Activate UE radio bearer test mode
Figure 5.2.1.1: Activate UE radio bearer test mode procedure
#### 5.2.1.1 General
The SS uses the activate UE radio bearer procedure to get the UE into a test
mode where: the SS can set up radio bearers to be terminated in the UE test
loop function without having to involve CC or SM; and to disable any control
mechanisms in NAS protocols (TC protocol excluded) or in any UE applications
that otherwise could cause the RRC connection to be released.
#### 5.2.1.2 Initiation
The SS can initiate the UE radio bearer test mode when an RRC connection is
established.
The SS requests the UE to activate the UE radio bearer test mode by
transmitting an ACTIVATE RB TEST MODE message. The SS then starts timer TT01.
#### 5.2.1.3 Reception of ACTIVATE RB TEST MODE message by UE
When the UE receives the ACTIVATE RB TEST MODE message then the radio bearer
test mode shall be activated.
When the radio bearer test mode is active the UE shall:
\- accept any requested radio bearer setup within the radio access
capabilities of the UE;
\- terminate all user plane radio bearer(s) in the UE test loop function;
\- discard all SDUs delivered by the RLC layer to the UE test loop function
for a radio bearer without a closed test loop if the configuration of that
radio bearer does not include the PDCP layer;
\- discard all SDUs delivered by the PDCP layer to the UE test loop function
for a radio bearer without a closed test loop if the configuration of that
radio bearer includes the PDCP layer (configured by \"PDCP info\" (see [5]);
\- disable any control mechanisms in NAS protocols or in any UE applications
that otherwise could cause the RRC connection to be released; and
\- optionally, if the UE supports CSG Proximity Indication, ignore any non
3GPP radio signals which are normally used in determining proximity to a CSG
(closed subscriber group) cell and delete any previously stored cell
information for proximity detection.
NOTE: The UE may provide other means which would guarantee that the UE ignores
any non 3GPP radio signals which are normally used in determining proximity to
a CSG (closed subscriber group) cell and deletes any previously stored cell
information for proximity detection. For such UEs the above mentioned CSG
requirements in UE test mode may not apply.
When the radio bearer test mode has been activated the UE shall transmit the
ACTIVATE RB TEST MODE COMPLETE message.
NOTE: For UEs not supporting UE test loop mode 4 then the UE does not need to
provide any CC or SM functionality while the radio bearer test mode is active.
For testing of UE uplink packet filtering using UE test loop mode 4 then SM
procedures are used by the SS to configure uplink packet filters. Thus for UEs
supporting UE test loop mode 4 then the UE has to provide SM functionality
while the radio bearer test mode is active.
#### 5.2.1.4 Reception of ACTIVATE RB TEST MODE COMPLETE message by SS
Upon reception of the ACTIVATE RB TEST MODE COMPLETE message the SS stops
timer TT01.
The reception of the ACTIVATE RB TEST MODE COMPLETE message by SS confirms
that the UE radio bearer test mode has been activated in the UE.
#### 5.2.1.5 TT01 timeout
If TT01 expires, then the SS shall indicate this to the test case. The
procedure is then completed.
### 5.2.2 Deactivate UE radio bearer test mode
Figure 5.2.2.1: Deactivate UE radio bearer test mode procedure
#### 5.2.2.1 General
The purpose of this procedure is to deactivate the radio bearer test mode and
return UE to normal operation.
#### 5.2.2.2 Initiation
The SS can deactivate the UE radio bearer test mode when an RRC connection is
established and the UE radio bearer test mode is active.
The SS requests the UE to deactivate the UE radio bearer test mode by
transmitting a DEACTIVATE RB TEST MODE message. The SS then starts timer TT01.
#### 5.2.2.3 Reception of DEACTIVATE RB TEST MODE message by UE
When the UE receives DEACTIVATE RB TEST MODE message then the radio bearer
test mode shall be deactivated and UE shall be returned to normal operation.
When the UE has deactivated the radio bearer test mode the UE shall transmit
the DEACTIVATE RB TEST MODE COMPLETE message using the RRC UPLINK DIRECT
TRANSFER message.
#### 5.2.2.4 Reception of DEACTIVATE RB TEST MODE COMPLETE message by SS
Upon reception of the DEACTIVATE RB TEST MODE COMPLETE message the SS stops
timer TT01.
The reception of DEACTIVATE RB TEST MODE COMPLETE message by SS confirms that
the UE radio bearer test mode has been deactivated in the UE.
#### 5.2.2.5 TT01 timeout
If TT01 expires, then the SS shall indicate this to the test case. The
procedure is then completed.
## 5.3 UE test loop procedures
### 5.3.1 General
The UE test loop function is intended for:
\- Testing of receiver characteristics based on BER (Bit Error Ratio)
measurement. The SS calculates BER from a bit-by-bit comparison of data sent
to and received from UE. BER measurement requires symmetric RAB bit-rates.
\- Testing of receiver performance based on BLER (BLock Error Ratio)
measurement. The SS calculates BLER based on the RLC STATUS SDU received from
the UE operating in RLC acknowledged mode; or the SS calculates BLER based on
checking returned downlink data and downlink CRC by UE operating in UE test
loop mode 2.
\- Testing of UE Blind Transport Format Detection.
\- Testing of UE transmitter characteristics.
\- Testing of UE transmitter DTX characteristics.
\- Testing of radio bearers (UE test loop function emulates terminal
equipment).
\- Counting received RLC SDUs on a given MTCH. This may be used for the
estimation of RLC SDU error rate for testing of MTCH performance.
\- Generating reliable data transmission flow on E-DPDCH for E-DCH testing (UE
test loop mode 1).
\- Testing of UE uplink packet filtering (UE test loop mode 4).
### 5.3.2 Close UE test loop
Figure 5.3.2.1: Close UE test loop procedure
#### 5.3.2.1 General
The SS uses the close UE test loop procedure to start the UE Test Loop
function in the UE. A prerequisite for UE test loop mode 1, UE test loop mode
2 and UE test loop mode 4 is that at least one bidirectional user plane radio
bearer has been established between SS and UE. A prerequisite for UE test loop
mode 3 is that at least one MTCH has been established. See TS 34.108 [10],
clause 7 for generic setup procedures.
The UE shall provide for normal Uu layer 1, layer 2 and RRC functionality
while the UE test loop function is active. This includes (but is not limited
to) handover procedures and normal disconnection of the radio bearer. The
loopback shall be maintained across handovers, but after radio bearer
disconnection, the loopback shall cease to exist.
#### 5.3.2.2 Initiation
The SS can request the UE to close a test loop in mode 1, mode 2 or mode 4 if
at least one bidirectional user plane radio bearer is established and the UE
radio bearer test mode is active.
When testing reception of MBMS services not operating in MBSFN mode the SS can
request the UE to close the test loop in mode 3 if any MTCH is established and
the UE radio bearer test mode is active.
When testing reception of MBMS services operating in MBSFN mode the SS can
request the UE to close the test loop in mode 3 before or after any MTCH has
been established on the MBSFN carrier and the UE radio bearer test mode is
active.
The SS requests the UE to close its radio bearer test loop by transmitting a
CLOSE UE TEST LOOP message. The SS then starts timer TT01.
#### 5.3.2.3 Reception of CLOSE UE TEST LOOP message by the UE
If UE test loop mode 1, mode 2 or mode 4 has been selected and no user plane
bidirectional radio bearers are established or the UE radio bearer test mode
is not active, then the UE shall ignore any CLOSE UE TEST LOOP message.
If UE test loop mode 1, mode 2 or mode 4 has been selected and one or more
user plane bidirectional radio bearers are established, the UE shall close the
test loop on all user plane bidirectional radio bearers and then send back to
the SS a CLOSE UE TEST LOOP COMPLETE message. The loopback shall be
operational prior to the sending of the acknowledgement. The UE shall not
close the UE test loop mode 1, mode 2 or mode 4 on any unidirectional user
plane radio bearers.
If UE test loop mode 3 has been selected and a MTCH corresponding to the
specified MBMS short transmission identity is established, the UE shall
commence counting of received RLC SDUs on this MTCH. The counter value shall
be reset to zero on reception of CLOSE UE TEST LOOP MODE 3 and the UE shall
send back a CLOSE UE TEST LOOP COMPLETE message to the SS.
If UE test loop mode 3 has been selected, no MTCH corresponding to the
specified MBMS short transmission identity is established and the UE supports
MBMS service operating in MBSFN mode, the UE shall wait until a MTCH is
established corresponding to this MBMS short transmission identity to close
the test loop and commence counting of received RLC SDUs. The counter value
shall be reset to zero when the MTCH is established, the test loop shall be
closed and the UE shall send back a CLOSE UE TEST LOOP COMPLETE message to the
SS.
If the test loop is already closed on one or more user plane radio bearers,
the UE shall still respond as if the loop had been open, i.e. the CLOSE UE
TEST LOOP COMPLETE message shall be sent.
NOTE: There is no requirement on the UE to read the content of the CLOSE UE
TEST LOOP message if it is received while the test loop is closed.
If UE test loop mode 1 has been selected then the loop back scheme according
to subclause 5.3.2.6 shall be performed by the UE.
If UE test loop mode 2 has been selected then the loop back scheme according
to subclause 5.3.2.7 shall be performed by the UE.
If UE test loop mode 3 has been selected then the RLC SDU counting scheme
according to subclause 5.3.2.8a shall be performed by the UE.
If UE test loop mode 4 has been selected then the loop back scheme according
to subclause 5.3.2.8b shall be performed by the UE.
#### 5.3.2.4 Reception of CLOSE UE TEST LOOP COMPLETE message by the SS
Upon reception of the CLOSE UE TEST LOOP COMPLETE message the SS stops timer
TT01.
#### 5.3.2.5 TT01 timeout
If TT01 expires, then the SS shall indicate this to the test case. The
procedure is then completed.
#### 5.3.2.6 UE test loop mode 1 operation
If the configuration of a user plane radio bearer with a closed UE test loop
mode 1 includes the PDCP protocol layer, configured by \"PDCP info\" (see
[5]), then the loop back scheme according to subclause 5.3.2.6.1 shall be
performed by the UE for that radio bearer.
If the PDCP protocol layer is not used for a user plane radio bearer with a
closed UE test loop mode 1 then the loop back scheme according to subclause
5.3.2.6.2 shall be performed by the UE for that radio bearer.
##### 5.3.2.6.1 Loopback of PDCP SDUs
If UE test loop mode 1 has been closed on a user plane radio bearer and the
setup of that radio bearer includes configuration of PDCP protocol layer,
configured by \"PDCP info\" (see [5]), then the following loop back scheme
shall be performed by the UE.
After the UE has closed UE test loop mode 1 on a user plane radio bearer,
every PDCP SDU received by the UE on that radio bearer (downlink) shall be
taken from the output of the PDCP service access point (SAP) and be input to
the correspondent PDCP SAP and transmitted (uplink).
The UE shall provide for normal PDCP operation.
The PDCP loopback operation is illustrated in figure 5.3.2.6.1.1.
Figure 5.3.2.6.1.1: Loop back of PDCP SDU\ (DL RLC SDU size = UL RLC SDU size
= N)
##### 5.3.2.6.2 Loopback of RLC SDUs
If UE test loop mode 1 has been closed on a user plane radio bearer and the
setup of that radio bearer does not include configuration of the PDCP protocol
layer (\"PDCP info\" is not configured (see [5]) then the following loop back
scheme shall be performed by the UE.
After the UE has closed UE test loop mode 1 on a user plane radio bearer,
every user data block received by the UE on that radio bearer (downlink) shall
be taken from the output of the RLC service access point (SAP) and be input to
the correspondent RLC SAP and transmitted (uplink). The UE reads the UL RLC
SDU size parameter from the \"LB Setup RB IE#k\" parameter associated with
that radio bearer, see subclause 6.2.
If no \"LB Setup RB IE#k\" parameter is associated with that radio bearer then
the UE shall use the same UL RLC SDU size as the received DL RLC SDU.
For the case when the \"UL RLC SDU size\" parameter is set to \"0\" no data
shall be returned.
For the case when the \"UL RLC SDU size\" parameter is set to the same value
as the down link (DL) RLC SDU block size then the complete user data block
shall be returned, see figure 5.3.2.6.2.1.
Figure 5.3.2.6.2.1: DL and UL RLC SDU block size equal\ (DL RLC SDU size = UL
RLC SDU size = N)
For the case when the \"UL RLC SDU size\" parameter is set to a value less
than the down link (DL) RLC SDU block size then the UE shall return the first
K bits of the received block, where K is the UL block size, see figure
5.3.2.6.2.2.
Figure 5.3.2.6.2.2: DL > UL RLC SDU block size\ (DL RLC SDU size = N, UL RLC
SDU size = K)
For the case when the \"UL RLC SDU size\" parameter is set to a value bigger
than the down link (DL) RLC SDU block size then the UE shall pad the UL send
block by repeating the received data block until the UL send block has been
filled (truncating the last block if necessary), see figure 5.3.2.6.2.3.
Figure 5.3.2.6.2.3: DL \ NOTE 2: See TS 25.133 [12], subclause 7.1 for definition of the timing error
> for FDD mode.
Figure 5.3.2.9.1: Loopback delay requirement (TTI=10 ms)
##### 5.3.2.9.2 Loopback delay requirement for RLC and PDCP SDUs (UE Test loop
mode 1)
The maximum delay from receiving an RLC or PDCP SDU in a downlink SAP until
returning an SDU in the correspondent uplink SAP shall be within the delay
requirement specified in subclause 5.3.2.9.1.
The UE test loop function, operating in UE test loop mode 1, shall for every
radio bearer with a closed test loop be able to return at least 4 SDUs within
the time equal to the TTI of the actual radio bearer.
NOTE: To enable testing of the Conversational CS TM reference radio bearer
combinations as specified in 34.108 subclause 6.10 a UE must be able to loop
back 4 SDUs per TTI. E.g. for \"Conversational / unknown / UL:64 DL:64 kbps /
CS RAB\" operated in TM RLC mode 4 SDUs are needed to fill the transport
format existing of 4x640 bits.
NOTE: The loopback delay requirement in 5.3.2.9.2 does not impose any
synchronisation mechanisms between the uplink RLC entity and the UE test loop
function. Thus it could happen that a UE when having received 4 SDUs within
one and the same TTI may deliver the SDUs to the uplink RLC entity in two
subsequent TTIs. For a TM radio bearer requiring multiple SDUs to fill a
transport block set then \"Timer discard without explicit signalling\" needs
to be configured to secure that the TM RLC entity does not discard the SDUs in
case they are delivered in subsequent TTIs.
### 5.3.3 Open UE test loop
Figure 5.3.3.1: Open UE test loop procedure
#### 5.3.3.1 General
The SS uses the procedure open UE test loop to deactivate the UE test loop
function in the UE.
#### 5.3.3.2 Initiation
The SS requests the UE to open all closed radio bearer test loops by
transmitting an OPEN_UE_TEST _LOOP_CMD message. The SS then starts timer TT01.
#### 5.3.3.3 Reception of OPEN UE TEST LOOP message by the UE
If no bidirectional user plane radio bearers are established in UE Test loop
mode 1 or UE test loop mode 2, the UE shall ignore any OPEN UE TEST LOOP
message.
If one or more user plane radio bearer test loops are closed, the UE shall
open all test loops and send back to the SS an OPEN UE TEST LOOP COMPLETE
message.
If the test loops are already open, the UE shall still respond as if the loops
had been closed, i.e. the OPEN UE TEST LOOP COMPLETE message should be sent
prior to TT01 expiring.
#### 5.3.3.4 Reception of OPEN UE TEST LOOP COMPLETE by the SS
Upon reception of the OPEN UE TEST LOOP COMPLETE message the SS stops timer
TT01.
#### 5.3.3.5 TT01 timeout
If TT01 expires, then the SS shall indicate this to the test case. The
procedure is then completed.
## 5.4 UE Positioning test mode procedures
### 5.4.1 Reset UE Positioning Stored Information
#### 5.4.1.1 General
The SS uses the reset UE positioning stored information procedure to command
the UE to reset the already acquired UE POSITIONING information in preparation
for subsequent test procedures.
#### 5.4.1.2 Initiation
The SS requests the UE to reset the stored UE positioning information mode by
transmitting a RESET UE POSITIONING STORED INFORMATION message.
#### 5.4.1.3 Reception of RESET UE POSITIONING STORED INFORMATION message by
UE
When UE receives RESET UE POSITIONING STORED INFORMATION message then the UE
shall:
1> if the IE \"UE Positioning Technology\" has the value 'AGPS':
2> discard any stored GPS reference time, reference position, and any other
aiding data obtained or derived during the previous test instance (e.g.
expected ranges and Doppler).
1> if the IE \"UE Positioning Technology\" has the value \'AGNSS\':
2> discard any stored GPS and GANSS reference time, reference position, and
any other aiding data obtained or derived previously (e.g. expected ranges and
Doppler);
2> temporarily disable any sensor data (if applicable) that can aid the
positioning for the duration of the subsequent positioning procedure.
> 1> otherwise:
>
> 2> ignore the message.
### 5.4.2 Update UE Location Information
Figure 5.4.2-1: Update UE Location Information procedure
#### 5.4.2.1 General
The SS uses the Update UE Location information procedure to send positioning
information to the UE and command it to store positioning information in
preparation for subsequent test procedures.
#### 5.4.2.2 Initiation
The SS requests the UE to store the positioning information contained in the
message by transmitting a UPDATE UE LOCATION INFORMATION message.
#### 5.4.2.3 Reception of UPDATE UE LOCATION INFORMATION message by UE
When UE receives UPDATE UE LOCATION INFORMATION message then the UE shall:
1> if the UE has location information values stored:
2> discard the stored location information:
1> store the received location information (ellipsoidPointWithAltitude) and
maintain it until reception of RESET UE POSITIONING STORED INFORMATION or
UPDATE UE LOCATION INFORMATION message. Information not supported by the UE
may be discarded.
## 5.5 UE RLC SDU counter reporting procedure
Figure 5.5.1: UE RLC SDU counter reporting procedure
### 5.5.1 UE TEST LOOP MODE 3 RLC SDU COUNTER REQUEST and UE TEST LOOP MODE 3
RLC SDU COUNTER RESPONSE
#### 5.5.1.1 General
The SS may transmit a UE TEST LOOP MODE 3 RLC SDU COUNTER REQUEST message at
any time when UE test loop mode 3 is active.
#### 5.5.1.2 Initiation
The SS requests the UE to report its current RLC SDU counter value by sending
the message UE TEST LOOP MODE 3 RLC SDU COUNTER REQUEST to the UE. The SS then
starts timer TT01.
#### 5.5.1.3 Reception of UE TEST LOOP MODE 3 RLC SDU COUNTER REQUEST by the
UE
If UE test loop mode 3 is not active, the UE shall ignore the UE TEST LOOP
MODE 3 RLC SDU COUNTER REQUEST message.
If UE test loop mode 3 is active, the UE shall respond by transmitting a UE
TEST LOOP MODE 3 RLC SDU COUNTER RESPONSE message, containing the current RLC
SDU counter value.
#### 5.5.1.4 Reception of UE TEST LOOP MODE 3 RLC SDU COUNTER RESPONSE by the
SS
Upon reception of the UE TEST LOOP MODE 3 RLC SDU COUNTER RESPONSE message the
SS stops timer TT01.
#### 5.5.1.5 TT01 timeout
If TT01 expires, then the SS shall indicate this to the test case. The
procedure is then completed.
# 6 Message definitions and contents
In this clause, only TC protocol messages are described. TC control messages
are intended to be sent using the RRC downlink and uplink direct transfer
procedures, see TS 25.331 [5], subclause 8.1.9 and subclause 8.1.10.
NOTE 1: A message received with skip indicator different from 0 will be
ignored.
NOTE 2: For general definition of Layer 3 message format see TS 24.007 [1],
clause 11.
NOTE 3: GSM and 3G test messages uses the same protocol discriminator value
(\"1111\"). Following message type value series are reserved for GSM testing
commands as specified by TS 44.014 [13]:\ 0000xxxx, 0001xxxx and 0010xxxx
where x represent 0 or 1. For 3G test commands the message type value series
0100xxxx is reserved.
## 6.1 Timer values
TT01:
\- for testing the reception of MBMS services operating in MBSFN mode: [15]
seconds.
\- otherwise: 2.5 seconds.
NOTE: For testing the reception of MBMS services operating in MBSFN mode a
longer time is specified for TT01 as the response to the CLOSE UE TEST LOOP
message by the UE may involve waiting for cluster selection and/or MTCH
establishment on the MBSFN carrier.
## 6.2 CLOSE UE TEST LOOP
This message is only sent in the direction SS to UE.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1 UE test loop mode M V 1 UE test loop mode
1 LB setup C LV 1-16 UE test loop mode 3 setup C V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 0 0 0 0 octet 1
* * *
where UE test loop mode is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 0 0 0 0 0 X2 X1 octet 1
* * *
X2=0 and X1=0 then UE test loop mode 1 loop back scheme according to 5.3.2.6
shall be performed by the UE (loopback of RLC SDUs or PDCP SDUs).
X2=0 and X1=1 then UE test loop mode 2 loop back scheme according to 5.3.2.7
shall be performed by the UE (loopback of transport block data and CRC bits).
X2=1 and X1=0 then the UE test loop mode 3 RLC SDUcounting scheme according to
section 5.3.2.8a shall be performed by the UE (counting of received RLC SDUs).
X2=1 and X1=1 then the UE test loop mode 4 loop back scheme according to
section 5.3.2.8b shall be performed by the UE (loopback of IP PDUs).
For backward compatibility reason, the bit 3 of octet 1 shall not be used and
shall always be set to zero.
where UE test loop mode 1 LB setup is:
+---+-------------------------------------------+--------------+ | | 8 7 6 5 4 3 2 1 | | +---+-------------------------------------------+--------------+ | | Length of UE test loop mode 1 LB setup IE | Octet 1 | +---+-------------------------------------------+--------------+ | | LB setup list | Octet 2 | | | | | | | | Octet N*3+1 | +---+-------------------------------------------+--------------+
N is the number of LB entities in the LB setup list and is less than or equal
to 5.
where LB setup list is:
+---+-------------------+--------------+ | | 8 7 6 5 4 3 2 1 | | +---+-------------------+--------------+ | | LB setup RB IE#1 | Octet 2 | | | | | | | | Octet 3 | | | | | | | | Octet 4 | +---+-------------------+--------------+ | | LB setup RB IE#2 | Octet 5 | | | | | | | | Octet 6 | | | | | | | | Octet 7 | +---+-------------------+--------------+ | | ... | | +---+-------------------+--------------+ | | LB setup RB IE#N | Octet N*3-1 | | | | | | | | Octet N*3 | | | | | | | | Octet N*3+1 | +---+-------------------+--------------+
where LB Setup RB IE#k is:
* * *
8 7 6 5 4 3 2 1 bit no. Z15 Z14 Z13 Z12 Z11 Z10 Z9 Z8 octet 1 Z7 Z6 Z5 Z4 Z3
Z2 Z1 Z0 octet 2 Reserved Q4 Q3 Q2 Q1 Q0 octet 3
* * *
Z15..Z0 = Uplink RLC SDU size in bits 0.. 65535 (binary coded, Z15 is most
significant bit and Z0 least significant bit). Support of Uplink RLC SDU sizes
bigger than 12160 bits is optional for the UE, see Note 1.
Q4..Q0 = RB identity number, 5..32 (binary coded, Q4 is most significant bit
and Q0 least significant bit), where RB identity identifies the radio bearer,
see [5] TS 25.331. The range is limited to 5..32 due to RB0 to RB4 are
reserved for signalling radio bearers.
NOTE: The parameter UL RLC SDU size is only applicable for UE test loop mode 1
and for radio bearers not using the PDCP protocol layer, see subclause
5.3.2.6.2. The UE capability for support of UL RLC SDU sizes bigger than 12160
bits is stated by the UE manufacturer as an Implementation Conformations
Statement (ICS) as defined in TS 34.123-2 [17], subclause A.4.3.1 table A.13.
The UE Total RLC AM buffer size according to the UE Radio Access Capabilities
defined in TS 25.306 [18] shall not be exceeded.
And where UE test loop mode 3 setup is:
* * *
     8 7 6 5 4 3 2 1                
     UE test loop mode 3 setup IE   Octet 1
* * *
Where
* * *
8 7 6 5 4 3 2 1 bit no. Reserved Q5 Q4 Q3 Q2 Q1 Q0 octet 1
* * *
Q5..Q0 = MBMS short transmission identity number -1, 0..63 (binary coded, Q5
is most significant bit and Q0 least significant bit), where MBMS short
transmission identity number identifies the MBMS Transmission identity (= MBMS
service identity + MBMS session id) associated with the MTCH under test, see
[5] TS 25.331. Test loop mode 3 operation is only defined for MTCH.
## 6.3 CLOSE UE TEST LOOP COMPLETE
This message is only sent in the direction UE to SS.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V 1/2 Skip indicator TS 24.007 [1],
subclause 11.2.3.1.2 M V 1/2 Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 0 0 0 1 Octet 1
* * *
## 6.4 OPEN UE TEST LOOP
This message is only sent in the direction SS to UE
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 Bit no. 0 1 0 0 0 0 1 0 Octet 1
* * *
## 6.5 OPEN UE TEST LOOP COMPLETE
This message is only sent in the direction UE to SS.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V 1/2 Skip indicator TS 24.007 [1],
subclause 11.2.3.1.2 M V 1/2 Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 0 0 1 1 Octet 1
* * *
## 6.6 ACTIVATE RB TEST MODE
This message is only sent in the direction SS to UE.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 0 1 0 0 octet 1
* * *
## 6.7 ACTIVATE RB TEST MODE COMPLETE
This message is only sent in the direction UE to SS.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 0 1 0 1 octet 1
* * *
## 6.8 DEACTIVATE RB TEST MODE
This message is only sent in the direction SS to UE.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 0 1 1 0 octet 1
* * *
## 6.9 DEACTIVATE RB TEST MODE COMPLETE
This message is only sent in the direction UE to SS.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 0 1 1 1 octet 1
* * *
## 6.10 RESET UE POSITIONING STORED INFORMATION
This message is only sent in the direction SS to UE.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1 UE Positioning Technology M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 1 0 0 0 octet 1
* * *
where UE positioning technology is a single octet IE:
* * *
8 7 6 5 4 3 2 1 bit no. UE positioning Technology octet 1
* * *
UE Positioning Technology value
Bits\ **8 7 6 5 4 3 2 1** \ 0 0 0 0 0 0 0 0 AGPS\ 0 0 0 0 0 0 0 1 AGNSS
All other cause values are reserved for future use
## 6.11 UE TEST LOOP MODE 3 RLC SDU COUNTER REQUEST
This message is only sent in the direction SS to UE.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 1 0 0 1 octet 1
* * *
## 6.12 UE TEST LOOP MODE 3 RLC SDU COUNTER RESPONSE
This message is only sent in the direction UE to SS.
* * *
Information Element Reference Presence Format Length Protocol discriminator TS
24.007 [1], subclause 11.2.3.1.1 M V ½ Skip indicator TS 24.007 [1], subclause
11.2.3.1.2 M V ½ Message type M V 1 RLC SDU Counter Value M V 4
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 1 0 1 0 octet 1
* * *
And where
RLC SDU Counter Value is
* * *
C31 C30 C29 C28 C27 C26 C25 C24 octet 1 C23 C22 C21 C20 C19 C18 C17 C16 octet
2 C15 C14 C13 C12 C11 C10 C9 C8 octet 3 C7 C6 C5 C4 C3 C2 C1 C0 octet 4
* * *
C31..C0 = UE received RLC SDU counter value 0.. 4294967295 (binary coded, C31
is most significant bit and C0 least significant bit).
## 6.13 UPDATE UE LOCATION INFORMATION
This message is only sent in the direction SS to UE.
* * *
**Information Element** **Reference** **Presence** **Format** **Lenght**
Protocol discriminator TS 24.007 [1], subclause 11.2.3.1.1 M V ½ Skip
indicator TS 24.007 [1], subclause 11.2.3.1.2 M V ½ Message type M V 1
ellipsoidPointWithAltitude TS 25.331 [5], subclause 10.3.8.4b M V 8
* * *
where message type is:
* * *
8 7 6 5 4 3 2 1 bit no. 0 1 0 0 1 0 1 1 octet 1
* * *
and where ellipsoidPointWithAltitude is:
* * *
8 7 6 5 4 3 2 1 bit no. L1 DLA22 DLA21 DLA20 DLA19 DLA18 DLA17 DLA16 octet 1
DLA15 DLA14 DLA13 DLA12 DLA11 DLA10 DLA9 DLA8 octet 2 DLA7 DLA6 DLA5 DLA4 DLA3
DLA2 DLA1 DLA0 octet 3 DLO23 DLO22 DLO21 DLO20 DLO19 DLO18 DLO17 DLO16 octet 4
DLO15 DLO14 DLO13 DLO12 DLO11 DLO10 DLO9 DLO8 octet 5 DLO7 DLO6 DLO5 DLO4 DLO3
DLO2 DLO1 DLO0 octet 6 A1 AD14 AD13 AD12 AD11 AD10 AD9 AD8 octet 7 AD7 AD6 AD5
AD4 AD3 AD2 AD1 AD0 octet 8
* * *
L1 = \"latitudeSign\" value 0=north and 1=south
DLA22..DLA0 = \"degreesLatitude\" value 0..8388607 (binary coded, DLA22 is
most significant bit and DLA0 is least significant bit).
DLO23..DLO0 = \"degreesLongitude\" value -8388608..8388607 (two's complement
binary coded as per ASN.1 encoding of an integer value, DLO23 is most
significant bit and DLO0 is least significant bit).
A1 = \"altitudeDirection\" value 0=height and 1=depth
AD14..AD0 = \"altitude\" value 0..32767 (binary coded, AD14 is most
significant bit and AD0 is least significant bit).
# 7 Electrical Man Machine Interface (EMMI)
The EMMI is used for automation of conformance testing. The commands used on
the EMMI by the System Simulator, shall be limited to the AT commands
specified in TS 27.005 [15], TS 27.007 [16] and TS 27.060 [17]. The EMMI and
its use for automation of signalling testing are illustrated in figure 7.1 as
an example.
At the System Simulator side, a logical EMMI using AT commands shall interface
with the TTCN test cases. A physical EMMI interface may be a standard RS232
interface towards the UE. Other interfaces shall not be precluded.
At the UE side the physical interface may be of various types, and an adapter
may be provided by the UE manufacturer for converting the AT commands between
the System Simulator interface into the UE manufacturer specific interface and
format.
The use of EMMI is optional for the UE.
Figure 7.1: An example of EMMI and its use for automation of signalling
testing
# 8 UICC/ME test interface
## 8.1 General description
A special interface is required in order to perform the tests of the UICC/ME
interface.
## 8.2 Formal aspects
It shall be possible to connect the UICC/USIM simulator to the ME. If an
adapter is to be used, the manufacturer of the ME shall provide it.
When using the UICC/USIM simulator, the ME does not necessarily conform to all
RF requirements.
When the UICC/USIM simulator is connected the ME shall be able to correctly
send and receive on a DTCH and associated channels under ideal radio
conditions.
## 8.3 Hardware and logical aspects of the interface
The signals on this interface are specified in TS 31.101 [7].
## 8.4 Mechanical characteristics of the interface
The mechanical interface is specified in TS 31.101 [7].
###### ## Annex A (informative): UE test loop use scenarios
## A.1 Measurement of receiver characteristics (BER) using UE test loop mode 1
and RLC TM
SS can use the UE test loop mode 1 and RLC TM for measuring BER. For UE to be
able to return all data it receives form SS it is required that the DL and UL
transport block size are the same. It is also required that the UL RLC SDU
size parameter of the CLOSE UE TEST LOOP message is set to the same value as
the DL and UL transport block size.
### A.1.1 Measurement of receiver characteristics (BER) - DL reference
measurement channel (12.2 kbps)
In FDD mode, for measuring BER for the DL and UL reference measurement channel
12.2 kbps according to TS 34.121 [8], Annex C the configuration should be:
\- DL and UL transport block size = 244 bits (RLC TM);
\- UE test loop mode 1 parameter UL RLC SDU size = 244 bits.
In TDD mode, for measuring BER for the DL and UL reference measurement channel
12.2 kbps according to TS 34.122 [9], Annex C.
## A.2 Measurement of receiver performance (BLER) using UE test loop mode 1
and RLC AM
To measure BLER UE test loop mode 1 can be used by having the DL RLC protocol
operating in acknowledged mode (AM). The SS can calculate BLER from the ratio
of number of UE retransmission requests and the total number of blocks sent by
the SS.
In AM the UE indicates missing protocol units (=transport blocks) in the
STATUS PDU message. There are different triggers for sending the STATUS PDU
message. For the purpose of SS BLER measurement a timer based trigger such as
receiver timer based STATUS PDU transfer can be used (see TS 25.322, subclause
9.7.2). The figure below illustrates the SS BLER measurement procedure. In the
example in the figure block errors are detected by the UE of a total of N
blocks. The BLER calculated by the SS is 4 / N.
Figure A.2.1: Measuring BLER using UE test loop mode 1 and DL RLC AM
### A.2.1 Measurement of receiver performance (BLER) - DL reference
measurement channel (64,144,384 kbps)
By having downlink transport block size set to size of user data part
according to the 64, 144 or 384 kbps reference measurement channels and using
RLC acknowledge mode the UE test loop mode 1 can be used to measure BLER.
## A.3 Measurement of receiver performance (BLER) using UE test loop mode 2
In addition to the method described in A.2 UE test loop mode 2 can be used to
measure BLER if the UL transport block size is bigger or equal to the sum of
DL transport block size and number of DL CRC bits.
The SS can calculate BLER by checking returned data and CRC and count number
of block errors and the total number of sent blocks.
### A.3.1 Measurement of receiver performance (BLER) - DL reference
measurement channel (12.2 kbps)
TS 34.121 [8], subclauses C.2.1 and C.3.1 defines the DL and UL reference
measurement channel 12.2 kbps for FDD mode.
TS 34.122 [9], subclauses C.2.1 and C.3.1 defines the DL and UL reference
measurement channel 12.2 kbps for TDD mode.
To be able to measure BLER using UE test loop mode 2 the SS needs to configure
the uplink transport block size to 260 bits to fit downlink transport block
size (244 bits) and downlink CRC bits (16 bits), see figure A.3.1.
Figure A.3.1: UE test loop mode 2 operation for the 12.2 kbps BLER measurement
case
### A.3.2 Measurement of receiver performance (BLER) - DL reference
measurement channel (64,144 and 384 kbps)
TS 34.121 [8], subclause C.2 defines the DL and UL reference measurement
channel for 64, 144 and 384 kbps for FDD mode.
TS 34.122 [9], subclause C.2 defines the DL reference measurement channel for
64, 144 and 384 kbps for TDD mode.
If a UE supports downlink reference measurement channels for 64,144 or 384
kbps and also the correspondent uplink reference measurement channel then it
is possible to use UE test loop mode 2 for measuring BLER for these reference
measurement channels.
## A.4 Measurement of transmitter characteristics
The SS sets up the radio bearer for DL and UL reference measurement channels
12.2 kbps using the generic setup procedure.
See TS 34.108 [10], clause 7 for specification of the generic setup procedure.
See TS 34.121 [8], subclauses C.2.1 and C.3.1 for definition of the DL and UL
reference measurement channel 12.2 kbps for FDD mode.
See TS 34.122 [9], subclauses C.2.1 and C.2.2 for definition of the DL and UL
reference measurement channel 12.2 kbps for TDD mode.
The SS orders the UE to close its UE test loop by transmitting a CLOSE UE TEST
LOOP CMD message.
When the SS receives the CLOSE UE TEST LOOP COMPLETE message from the UE the
SS starts transmission of data to the UE.
Perform the transmitter test.
The SS sends the OPEN UE TEST LOOP message to the UE to open the UE test loop.
## A.5 Measurement of transmitter DTX characteristics
The SS requests the UE to enable DTX and sets up the radio bearer for DL and
UL reference measurement channels 12.2 kbps using the generic setup procedure.
See TS 34.108 [10], clause 7 for specification of the generic setup procedure.
See TS 34.121 [8], subclauses C.2.1 and C.3.1 for definition of the DL and UL
reference measurement channel 12.2 kbps for FDD mode.
See TS 34.122 [9], subclauses C.2.1 and C.2.2 for definition of the DL and UL
reference measurement channel 12.2 kbps for TDD mode.
The SS orders the UE to close its UE test loop using UE test mode 1 by
transmitting a CLOSE UE TEST LOOP message.
The UE confirms that the UE test loop is closed by sending the CLOSE UE TEST
LOOP COMPLETE message to the SS.
Perform the transmitter DTX testing.
The SS sends the OPEN UE TEST LOOP message to the UE to open the UE test loop.
## A.6 Using UE test loop mode 2 for testing of UE Blind Transport Format
Detection (FDD mode)
When a UE operates in UE test loop mode 2 then the received downlink transport
block and the downlink CRC data bits shall be returned in the uplink transport
block, see subclause 5.3.2.7. The UE shall select the uplink transport format
with the smallest transport block size, which fits both the received downlink
transport block and the downlink CRC bits. Table A.6.1 gives an example of an
uplink radio bearer configuration for variable rate having three transports
formats TF0, TF1 and TF2. Table A.6.2 gives some examples of UE selected
uplink transport format versus size of received downlink transport block and
downlink CRC bits.
The SS can use UE test loop mode 2 for testing UE blind transport format
detection by taken the possible downlink transport formats into consideration
when configuring the uplink transport formats. I.e. for every downlink
transport format there should be an uplink transport format for which the
transport block size is equal to the sum of the downlink transport block size
and the number of downlink CRC bits. Thus the SS can check the TFI of the UE
transmitted transport format to verify that the UE has detected the correct
downlink transport format. Table A.6.3 gives an example of a configuration for
testing blind transport format detection using 9 possible downlink transport
formats TF0 to TF8. The right hand column shows the minimum uplink transport
block sizes the SS has to set-up to be able to test the UE blind transport
format detection behaviour.
Table A.6.1: Uplink transport formats
* * *
UL transport format Transport block size TF0 0 TF1 55 bits TF2 111 bits
* * *
Table A.6.2: Selected uplink transport format versus size\ of received
downlink transport block and downlink CRC bits
+----------------+----------------+----------------+----------------+ | DL transport | Number of DL | Selected UL TF | Comment | | block size | CRC bits | | | +----------------+----------------+----------------+----------------+ | 39 bits | 16 bits | TF1 | 39 + 16 = 55 | | | | | i.e. TF1 ok | +----------------+----------------+----------------+----------------+ | 40 bits | 16 bits | TF2 | TF1 not | | | | | possible (40 + | | | | | 16 = 56 > 55) | | | | | | | | | | TF2 OK (56 \ DL RLC SDU size
Received data is repeated until UL RLC SDU block is filled and sent in uplink
* * *
Examples of different configurations are shown in figures A.7.1 and A.7.2.
Figure A.7.1 illustrates a configuration for testing of RLC reassemble and
segmentation. SS sends DL RLC SDU block size > DL RLC PDU block size and have
configured UL RLC SDU block size = DL RLC SDU size > UL RLC PDU block size.
NOTE: For this type of configuration the UE receiver buffer limitations need
to be considered when designing the test.
Figure A.7.2 illustrates a configuration for BER measurements. SS sends DL RLC
SDU block size = DL RLC PDU block size and have configured UL RLC SDU block
size = UL RLC PDU block size = DL RLC PDU block size. RLC and MAC are
configured for transparent mode.
Figure A.7.1: Configuration for testing of RLC reassembly in downlink\ and RLC
segmentation in uplink
Figure A.7.2: Example of a configuration used for BER measurement
#