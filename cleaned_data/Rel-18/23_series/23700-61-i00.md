# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
This study will focus on the mechanism to determine the \"unavailability
period\" in the 5G system for the UE.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support
network data analytics services\".
# 3 Definitions of terms and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
# 4 Architectural Assumptions and Requirements
1) The \"unavailability period\" may be made available on the user interface.
Whether and how \"unavailability period\" is used on the user interface (if
any) of the UE is outside the scope of this study.
2) The \"unavailability period\" for the UE is expected to be sufficiently
long for the UE to execute required events such as:
a) Silent reset at Modem;
b) Security patch updates;
c) OS upgrade;
d) Modem SW updates; and
e) Device reboot upon Modem setting changes via OMA-DM.
# 5 Key Issues
## 5.1 Key Issue #1: Determination of unavailability period in 5GS for a
specific UE
### 5.1.1 Description
To execute certain events, for example OS upgrade, silent reset at modem or
modem software updates (also commonly called as binary updates) there are 3
parties involved: the device, the operator and the application function. Once
the UE has downloaded the binary, the time when the UE performs the upgrade is
left for the UE implementation, with possibly UE implementations seeking user
input. If UEs cannot execute the event (e.g. the storage capacity or the
battery level are insufficient), they may delay execution of the event. These
UEs become unavailable (i.e. cannot interact with the 5G System) in the order
of minutes whenever such operations are performed. As UEs become unavailable
without prior knowledge from the core network and/or application function, it
can impact critical operations of an application server if it depends on
availability of the UE during the unavailability period (i.e. a period of time
during which the UE is not available).
The present key issue shall study:
a) Whether and how an unavailability period is determined in 5GS for a
specific UE.
b) Study the expected UE and/or network actions (if any) based on determined
unavailability period.
# 6 Solutions
## 6.0 Mapping of Solutions to Key Issues
Table 6.0-1: Mapping of Solutions to Key Issues
              Key Issues
* * *
Solutions 1  
1 X  
2 X  
3 X  
4 X  
5 X  
6 X
## 6.1 Solution #1: Usage of MICO mode for UE unavailability period management
### 6.1.1 Introduction {#introduction-1}
This solution addresses Key Issue #1 on Determination of unavailability period
in 5GS for a specific UE.
### 6.1.2 Functional Description
The solution relies on usage of Mobile Initiated Connection Only (MICO) mode
as specified already in TS 23.501 [2] and TS 23.502 [3], with some
enhancements.
Once the user or the application in the UE has decided to turn down the UE,
the UE:
\- triggers Mobility Registration Update procedure indicating preference for
MICO mode.
\- provides the network with an estimated time while the UE is going to be
unavailable (or an estimated time for MICO mode).
\- stores its MM context in USIM or in non-volatile memory to avoid a full re-
registration and reauthentication after MICO mode is terminated.
\- provides in the Registration Request message the PDU session status
information indicating that all PDU sessions have been torn down, thus
avoiding UE and 5G core to keep PDU sessions contexts while the UE is
unavailable.
When receiving Registration Request with MICO indication, the AMF determines
whether MICO mode is allowed for the UE, and if so, accepts the registration
request and provides a periodic registration timer with a value that is at
least equal to the estimated unavailability time from the UE. This then avoids
that the network considers the UE de-registered while the UE is not in a
situation where it could perform periodic registration update (because of the
UE being unavailable).
After the unavailability period and when the UE comes back, the UE issues a
new Registration Request without MICO mode indication, reusing the stored MM
context, and re-establishes PDU sessions that are still required.
### 6.1.3 Procedures
The procedure is based on the general registration procedure specific in
clause 4.2.2.2.2 of TS 23.502 [3]. Details are provided in figure 6.1.3-1 and
steps below.
Figure 6.1.3-1: Registration with indication of UE unavailability
0\. UE decides to turn down, e.g. for OS upgrade or device reboot. The UE
stores its MM context in USIM or non-volatile memory to be able to reuse it
after its unavailability period.
1\. The UE sends Registration Request to the AMF (via (R)AN). This step is the
same as step 1 from clause 4.2.2.2.2 of TS 23.502 [3]. The UE includes MICO
mode preference and an estimated time while the UE is going to be unavailable.
The UE indicates, via PDU session status, that all PDU sessions are inactive.
2-20. Same steps as steps 2 to 20 from clause 4.2.2.2.2 of TS 23.502 [3].
21\. AMF sends Registration Accept to the UE. This step is similar to step 21
from clause 4.2.2.2.2 of TS 23.502 [3]. The AMF indicates accepted MICO mode.
The AMF provides Periodic Registration Update timer greater than the estimated
time when the UE is going to be unavailable, as provided by the UE in step 1.
21b-25. Same steps as steps 21b to 25 from clause 4.2.2.2.2 of TS 23.502 [3].
26\. When the UE is available again, the UE sends a Registration Request to
the AMF without MICO mode indication.
27\. The UE re-establishes the PDU sessions that are required.
### 6.1.4 Impacts on services, entities and interfaces
UE:
\- Determination of unavailability period;
\- Registration with MICO mode when unavailability starts, together with an
indication of duration for unavailability (equivalent to a duration for MICO
mode);
\- Storage of MM context in USIM or in non-volatile memory;
\- Tearing down of PDU sessions.
AMF:
\- Handling of MICO mode requests from the UE, and configuration of
appropriate periodic registration timer taking UE indicated duration for
unavailability into account.
## 6.2 Solution #2: UE provided Unavailability Period
### 6.2.1 Introduction {#introduction-2}
This solution addresses Key issue #1.
### 6.2.2 Functional Description
When the UE is about to become unavailable due to the events as described in
Key issue #1, the UE initiates registration procedure indicating
unavailability period.
The AMF, may set the periodic registration timer to a value equal or slightly
larger than the unavailability period provided by the UE.
During this unavailability period the 5GC maintains the UE context in CM-IDLE,
and considers the UE unreachable, in similar approach as MICO mode.
When the UE concludes the event that kept it unavailable, the UE triggers
registration procedure and does not provide indication of unavailability
period. During that registration procedure, if the AMF had assigned a periodic
registration timer based on unavailability period, the AMF provides the UE
with a regular value for the periodic registration timer (i.e. not considering
unavailability period).
The use of periodic registration timer of similar value of the unavailability
period is to make sure the UE resumes normal activity after the unavailability
period is concluded.
### 6.2.3 Procedures
Figure 6.2.3-1 shows the call flow for this solution.
Figure 6.2.3-1: UE triggered Unavailability Period
1\. During initial Registration procedure, the UE provides indication of
support of \"Unavailability Period\" in Registration Request, and the AMF
provides support of \"Unavailability Period\" in Registration Accept message.
2\. When an event as described in Key issue #1 is to be triggered in the UE,
if \"Unavailability period\" support was indicated by AMF, a supporting UE
proceeds with step 3 before executing the event and becoming unavailable.
3\. The UE sends Registration Request message indicating an Unavailability
period. The Unavailability period is determined internally in the UE, and
implementation dependent, (e.g. may be determined based on type of event and
expected event duration).
4\. The AMF responds with Registration Accept. The AMF may set the periodic
registration timer to a value equal or slightly larger than the unavailability
period provided by the UE. The AMF stores the information that the UE is in
unavailability period in UE context, and considers the UE unreachable until
the UE performs registration procedure again. In this state, all HLCom
solutions apply if supported, e.g. extended data buffering, downlink data
buffering status report, etc.
5\. Once the event is executed, the UE triggers registration procedure to
resume regular service. The UE does not include Unavailability period in the
registration request. Depending of the state the UE ends up after the event,
the registration type may be initial registration, \"mobility\" or
\"periodic\" registration.
6\. The AMF responds with registration accept. If the AMF has stored that the
previously assigned periodic registration timer was assigned based on
unavailability period, the AMF assigns a new periodic registration timer not
considering unavailability period.
### 6.2.4 Impacts on services, entities and interfaces
UE:
\- Support of unavailability period indication in registration procedure.
AMF:
\- Support of unavailability period indication in registration procedure.
\- Storing unavailability period in UE context.
\- Handling of MT data and control plane procedures for UE unreachable (no new
procedures compared to CM-IDLE with MICO).
## 6.3 Solution #3: Determination of unavailability period in 5GS
### 6.3.1 Introduction {#introduction-3}
This solution addresses Key issue #1.
### 6.3.2 Functional Description
This is a solution to Key Issue #1, \"Determination of unavailability period
in 5GS for a specific UE\".
**In this solution, the unavailability period is requested by the UE from 5GC.
Once requested, the UE-requested unavailability period can be delayed by the
5GC with a backoff timer, if necessary.**
The UE and network undergo capability negotiation wherein the UE indicates its
capability to support Unavailability period and the network indicates its
capability to support and use the Unavailability period in 5GS as part of the
initial registration procedure.
The UE may download software, patches and other updates from AF. When the UE
determines the appropriate time to become unavailable, UE initiates the
Registration procedure for mobility and periodic registration update. The UE
indicates the duration for which it may become unavailable, and the network
may accept the unavailability duration indicated by the UE or indicate a
different value.
The AMF may also reject the UE request to become unavailable if it is
currently not appropriate for the UE to become unavailable. The AMF may
optionally provide a backoff timer to the UE, if it is appropriate for the UE
to become unavailable after a certain duration. If the UE receives a backoff
timer, the UE starts the backoff timer and delays becoming unavailable for
doing internal updates. While the backoff timer is running the UE is available
and normal operation continues.
Once the backoff timer expires, the UE initiates De-registration procedure and
becomes unavailable. The AMF stores the UE context and starts an internal
timer for the duration that the UE is unavailable. Once the internal updates
are completed, the UE restarts and initiates the initial Registration
procedure. The AMF seamlessly restores the UE context and registers the UE.
#### 6.3.2.1 Alternate solution with re-use of MUSIM features
Alternatively, UE may r**e-use some of the MUSIM features defined in Rel-17
for the purpose of this solution and indicate** capabilities for **Connection
Release (clause 5.38.2 of TS 23.501 [2]) and Paging Restriction (clause 5.38.5
of TS 23.501 [2]). In addition, UE also indicates capability for \"Expected
Leaving Duration\" that was discussed in the context of MUSIM in Rel-17 but
eventually not adopted for MUSIM.**
**When the UE determines the appropriate time to become unavailable, the UE
can initiate** either a Service Request procedure or a registration procedure
and include the Release Request indication and the Paging Restriction
Information as specified for MUSIM. **As part of the Connection Release, the
UE can request Expected Leaving Duration, that specifies the length of the
unavailability period. Expected Leaving Duration can only be used in
combination of the Connection Release feature. The backoff timer mechanism
remains the same as described above** , but with the use of the MUSIM
**Connection Release feature, the UE does not need to de-register from the
network.**
### 6.3.3 Procedures
Figure 6.3.3-1: Procedure for determining Unavailability Period
Figure 6.3.3-1 represents the high-level procedure for determining the
Unavailability period.
1) The UE indicates its capability to support Unavailability period in 5GMM
Core Network Capability in Registration Request message as part of initial
registration procedure.
2) The AMF indicates its capability to support and use the Unavailability
period in 5GMM network feature support in Registration Accept message as part
of registration procedure.
3) The UE may download software, patches and other updates from the AF. Once
the updates are locally available the UE may determine a suitable time to
install these updates and indicate the duration for which it may become
unavailable to 5GC.
4) The UE requests the network to become unavailable for a duration of
Unavailable time requested by sending the Registration Request message (for
mobility and periodic registration update).
5) The AMF evaluates the UE request to become unavailable for a duration of
Unavailable time requested. The AMF indicates if the network accepts the UE
becoming unavailable or the network rejects the UE request to become
unavailable if it is currently not appropriate for the UE to become
unavailable in the Registration Accept message. The AMF may accept the
unavailability duration indicated by the UE or indicate a different value in
Unavailable time accepted. The AMF may optionally provide a backoff timer to
the UE, if it is appropriate for the UE to become unavailable after a certain
duration. If the UE receives a backoff timer, the UE starts the backoff timer
and delays becoming unavailable for doing internal updates equivalent to the
value of backoff timer. While the backoff timer is running the UE is available
and normal operation continues.
6) If the UE has received the backoff timer, the UE waits until the backoff
timer expires. The UE initiates De-registration procedure to become
unavailable. The UE shall indicate the type of de-registration. The UE may
optionally indicate that de-registration is for software update.
7) The AMF accepts the de-registration request and sends a De-registration
Accept message. If the UE has indicated that de-registration is for software
update, the AMF may store the UE context and start an internal timer for
duration of Unavailable time accepted.
8) Once the internal updates are completed and the UE has re-started, the UE
registers with the network by sending the Registration Request message for
initial registration.
9) If the UE restarts and initiates registration within the Unavailable time
accepted time duration, by initiating the registration procedure, the AMF
seamlessly restores the UE context and registers the UE.
#### 6.3.3.1 Alternate solution with re-use of MUSIM features
The UE follows similar steps as above in this case as well. The key
differences in the alternative approach are as follows:
1) The UE indicates its capability to support the Connection Release and
Paging Restriction features as per existing registration procedure defined in
clause 4.2.2.2.2 of TS 23.502 [3] with the exception that support for these
features is not restricted to Multi-USIM UEs. The UE also indicates support
for Expected Leaving Duration.
2) The AMF indicates its capability to support the Connection Release and
Paging Restriction features as per existing registration procedure defined in
clause 4.2.2.2.2 of TS 23.502 [3] based on network capability and preference
by the network (i.e. based on local network policy). The AMF only indicates
Expected Leaving Duration Supported together with Connection Release
Supported.
3) The UE initiates either a Service Request procedure or a Registration
procedure as defined for MUSIM. The UE includes the Release Request
indication, the Paging Restriction Information and the Expected Leaving
Duration in the Service Request message, if the UE intends to leave CM-
CONNECTED state, as defined in clause 4.2.3.2 of TS 23.502 [3]. The UE
includes the Release Request indication, the Paging Restriction Information
and the Expected Leaving Duration in the Registration Request message over
3GPP access, if the UE intends to leave CM-IDLE state (or CM-CONNECTED state
and the UE needs to perform Registration Update at the same time), as defined
in clause 4.2.2.2.2 of TS 23.502 [3]. In addition, the UE sets the Paging
Restriction Information to \"all paging is restricted\" (according to clause
5.38.5 of TS 23.501 [2]). The Expected Leaving Duration indicates the
requested unavailability period in seconds.
4) When using the MUSIM Connection Release feature, the UE does not need to
de-register from the network.
### 6.3.4 Impacts on services, entities and interfaces
UE:
\- Indicates its capability to support Unavailability time in 5GS in 5GMM Core
Network Capability as part of registration procedure.
\- Connects with the AF and downloads patches, software updates and other
upgrades.
\- Determines unavailability duration time interval and an appropriate time to
become unavailable and requests the network to become unavailable by sending
Registration Request (MRU) message.
\- If the network has provided a backoff timer value, starts the backoff timer
and delays becoming unavailable for duration of backoff timer.
\- Initiates de-registration procedure by sending the De-registration request
message and indicating that de-registration is for software update.
\- Once the UE performs software updates and the operation is complete,
initiates registration procedure.
In alternate solution with re-use of MUSIM features:
\- The UE indicates its capability to support the Connection Release, the
Paging Restriction and Expected Leaving Duration as part of registration
procedure.
\- The UE initiates either a Service Request procedure or a registration
procedure and includes the Release Request indication, the Paging Restriction
Information and the Expected Leaving Duration.
\- When using the MUSIM Connection Release feature, the UE does not need to
de-register from the network.
AMF:
\- Indicates its capability to support and use Unavailability time in 5GS in
5GMM network feature support as part of registration procedure.
\- Accepts or rejects the UE request to become unavailable. Indicates the
duration for which the UE may become unavailable. Provides a backoff timer if
it is appropriate for UE to delay becoming unavailable for a certain duration.
\- When UE indicates de-registration is for software update, stores the UE
context and starts an internal timer for duration of Unavailable time
accepted.
\- Restores the UE context, when UE performs registration within Unavailable
time accepted duration and registers the UE.
In alternate solution with re-use of MUSIM features:
\- The AMF indicates its capability to support the Connection Release, the
Paging and the Expected Leaving Duration as part of registration procedure.
\- The AMF suspends the NAS signalling connection per the Connection Release
initiated by the UE and it does not page the UE per UE\'s request that \"all
paging is restricted\" during the Unavailability time.
## 6.4 Solution #4: Exposing UE provided unavailability period via Loss of
Connectivity event subscription
### 6.4.1 Introduction {#introduction-4}
This solution addresses key issue #1: Determination of unavailability period
in 5GS for a specific UE.
### 6.4.2 Functional Description
This solution proposes to extend \"Loss of Connectivity\" event subscription
to notify unavailability period of the UE if the UE provides unavailability
period via NAS message. How the UE determines unavailability period is not
defined by this solution and out of scope of 3GPP.
### 6.4.3 Procedures
Figure 6.4.3-1: Overall procedure for unavailability period report to the AF
1\. The UE is registered with 5GC.
2-7. The AF subscribes \"Loss of Connectivity\" event to the NEF based on
existing procedure.
8\. The UE may send NAS message (e.g. Registration, Deregistration) with
unavailability period information, which is determined by the UE.
9\. If the AMF received unavailability period in the NAS message and there is
\"Loss of Connectivity\" event subscription for the UE, the AMF includes
unavailability period in the event notification report even though the UE is
not deregistered.
10\. If the NEF receives unavailability period in the event notification
report from the AMF, the NEF provide the received unavailability period to the
AF.
### 6.4.4 Impacts on services, entities and interfaces
UE:
\- Provides unavailability period via NAS message.
AMF:
\- If the UE provides unavailability period via NAS message and there is
\"Loss of Connectivity\" event subscription for the UE, the AMF triggers
\"Loss of Connectivity\" event report and includes unavailability period
during the \"Loss of Connectivity\" event report.
NEF:
\- Notifies unavailability period during the \"Loss of Connectivity\" event
report to the AF if the AMF provided unavailability period in the \"Loss of
Connectivity\" event report.
## 6.5 Solution #5: Determination of unavailability period in 5GS for a
specific UE
### 6.5.1 Introduction {#introduction-5}
This solution aims to solve Key Issue #1 as described in clause 5.1.
### 6.5.2 Functional Description
Once the UE has downloaded the binary, the time when the UE performs the
upgrade is left for the UE implementation, with possibly UE implementations
seeking user input. In order to avoid impact to critical operations which
would be executed during the UE unavailable period without prior knowledge
from the core network and/or application function, this solution proposes that
the UE reports its unavailable period to the network. The network takes the UE
unavailable period into account when determining recommended time window for
data transfer of the UE.
It is proposed that the NWDAF collects UE unavailable period from the UE via
Data Collection AF. The application function negotiates recommended time
window using background data transfer procedure. During this procedure, the
PCF requests from the NWDAF the UE unavailable period. The PCF determines the
recommended time for the application function to avoid the UE unavailable
period.
### 6.5.3 Procedures
#### 6.5.3.1 Procedures for future background data transfer
This procedure is performed as per Figure 4.16.7.2-1 Negotiation for future
background data transfer in TS 23.502 [3] with the following differences:
Figure 6.5.3.1-1: Negotiation for future background data transfer
In step 1, the AF invokes the Nnef_BDTPNegotiation_Create service and carries
a \"critical\" indication. It indicates that this service is critical and the
data transfer shall be performed avoid UE unavailable period.
In step 2, the NEF sends the \"critical\" indication within the
Npcf_BDTPolicyControl_Create message to the H-PCF.
Alternative 1) In step 5, the H-PCF interacts with the NWDAF using
Nnwdaf_AnalyticsSubscription_Subscribe and requests for UE unavailable period
for the corresponding UEs.
The NWDAF responds to the H-PCF with UE unavailable period using
Nnwdaf_AnalyticsSubscription_Notify.
Alternative 2) In step 3, the PCF requests UE unavailable period from the UDR.
In step 4, the UDR response to the H-PCF with UE unavailable period.
The H-PCF determines Background Data Transfer policies by taking into account
the UE unavailable period.
#### 6.5.3.2 Procedure for NWDAF collects UE unavailable period from the UE
Figure 6.5.3.2-1: NWDAF collects UE unavailable period
1\. The UE determines its unavailable period. The UE can determine its
unavailable period based on UE implementation. The UE sends the UE unavailable
period to the Data collection AF. This step reuses the data collection
procedure in clause 6.2.8.2.1 of TS 23.288 [4].
2\. The Data Collection AF sends the UE unavailable period to the NWDAF, e.g.
using Naf_EventExposure_Notify.
The NWDAF may subscribe the UE unavailable period from the AF using
Naf_EventExposure_Subscribe.
Editor\'s note: Whether NWDAF needs to be involved is FFS.
#### 6.5.3.3 Procedure for UDR collects UE unavailable period
Figure 6.5.3.3-1: UDR collects UE unavailable period
1\. The UE determines its unavailable period. The UE can determine its
unavailable period based on UE implementation. The UE sends the UE unavailable
period to the AF.
2\. The AF sends the UE unavailable period to the NEF, e.g. using
Nnef_ParameterProvision_Create.
3\. The NEF sends the UE unavailable period to the UDR.
The UDR stores the UE unavailable period and is provided to the PCF as
described in clause 6.5.3.1.
### 6.5.4 Impacts on services, entities and interfaces
For alternative 1):
UE:
\- Be able to send UE unavailable period to the Data collection AF.
Data collection AF:
\- Be able to send UE unavailable period to the NWDAF.
NWDAF:
\- Be able to send UE unavailable period to the PCF.
PCF:
\- Be able to request for UE unavailable period from the NWDAF and to take the
UE unavailable period into account when determining recommended time window in
Background Data Transfer policies.
AF:
\- Be able to send \"critical\" indication to the NEF.
For alternative 2):
UE:
\- Be able to send UE unavailable period to the AF.
AF:
\- Be able to send UE unavailable period to the NEF.
NEF:
\- Be able to send UE unavailable period to the UDR.
PCF:
\- Be able to request for UE unavailable period from the UDR and to take the
UE unavailable period into account when determining recommended time window in
Background Data Transfer policies.
AF for critical application:
\- Be able to send \"critical\" indication to the NEF.
## 6.6 Solution #6: Determination of unavailability period in 5GS for a
specific UE
### 6.6.1 Introduction {#introduction-6}
This is a candidate solution to the key issue#1.
### 6.6.2 Functional Description
As described in key issue#1, UEs become unavailable (i.e. cannot interact with
the 5G System) in the order of minutes whenever below events (hereafter called
as events) are executed:
a) Silent reset at Modem;
b) Security patch updates;
c) OS upgrade;
d) Modem SW updates; and
e) Device reboot upon Modem setting changes via OMA-DM.
As UEs become unavailable without prior knowledge from the core network and/or
application function while executing these events, it can impact critical
operations of an application server if it depends on availability of the UE
during the unavailability period (i.e. a period of time during which the UE is
not available).
Thus this solution proposes a mechanism to co-ordinate the unavailability
period between UE, 5GC and AF. So that UE can make informed decision on when
to execute these events.
### 6.6.3 Procedures
Figure 6.6.2-1: Determination of unavailability period in 5GS for a specific
UE
Option-A:
1a) By re-using the procedures described in clause 4.15.6.2 of TS 23.502 [3],
the AF provisions the unavailability period parameter into the UDM/UDR, or the
UDM/UDR can be configured with the unavailability period parameter based on
operator policy.
1b) The unavailability period parameter is provided to AMF by UDM using
Nudm_SDM_Get response. Based on the unavailability period, AMF may choose to
not initiate procedures which can force UE to enter deregistered state.
1c) UDM uses the UE Parameters Update via UDM Control Plane Procedure as
described in clause 4.20 of TS 23.502 [3] to configure the unavailability
period parameter into the UE.
Option-B:
2a) By re-using the procedures described in clause 4.15.6.7 of TS 23.502 [3],
AF provisions the unavailability period parameter into the PCF, or the PCF can
be configured with the unavailability period parameter based on operator
policy.
2b) The unavailability period parameter is provided to AMF by PCF during AM
policy association. Based on the unavailability period, AMF may choose to not
initiate procedures which can force UE to enter deregistered state.
2c) PCF uses the UE Configuration Update procedure for transparent UE Policy
delivery as described in clause 4.2.4.3 of TS 23.502 [3] to configure the
unavailability period parameter into the UE.
NOTE: The AF configures the unavailability period parameter which is
acceptable to 5GC .i.e. based on negotiation between 5GC and AF.
The unavailability period parameter is the time slot which indicates the time
in which UE is allowed to perform deregistration procedure to execute events
described in clause 6.6.2. The unavailability period parameter can have
multiple time slots for example 10:00-12:00 UTC, 14:00 - 18:00 UTC,
22:00-23:59 UTC etc. If UE is not able to execute the events for example due
to the less storage capacity or insufficient battery level in the first time
slot then UE should wait for the next time slot to execute the events.
The network takes unavailability period parameter into account to execute
Device reboot upon Modem setting changes via OMA-DM procedures.
If UE have a user interface, how UE indicates the unavailability period to the
user and take his consent to execute the events during unavailability period
is outside the scope of this study as agreed in clause 2.
The unavailability period is configured by the HPLMN, based on agreements with
the AF and operator policy, into the UE.
### 6.6.4 Impacts on services, entities and interfaces
This solution impacts the following system entities.
UDM or PCF:
\- To support provisioning of the unavailability period parameter from the
application function which is acceptable to both 5GC and AF.
\- To support provisioning of the unavailability period parameter provisioning
into the UE.
AMF:
\- To take unavailability period into account to decide whether it can
initiate procedures which makes UE enter deregistration procedure.
UE:
\- To take unavailability period into account to decide whether it can trigger
deregistration procedure to execute the events described in clause 6.6.2.
## 6.X Solution #X: \
### 6.X.1 Introduction
Editor\'s note: This clause lists the key issue(s) addressed by this solution.
### 6.X.2 Functional Description
Editor\'s note: This clause outlines solution principles, assumptions and
high-level architectures, etc.
### 6.X.3 Procedures
Editor\'s note: This clause describes high-level procedures and information
flows for the solution.
### 6.X.4 Impacts on services, entities and interfaces
Editor\'s note: This clause describes impacts to existing services, entities
and interfaces.
# 7 Overall Evaluation
Table 7-1: Evaluations
+----------------+----------------+----------------+----------------+ | | Summary | System impacts | AF interaction | +================+================+================+================+ | Solution #1: | UE provides | UE provides | No interaction | | Usage of MICO | unavailability | unavailability | | | mode for UE | period via | period in | | | unavailability | Registration | Registration | | | period | | | | | management | UE requests | | | | | MICO and | | | | | release all | | | | | PDU Sessions | | | | | | | | | | UE stores MM | | | | | context | | | | | | | | | | AMF sets | | | | | periodic | | | | | registration | | | | | timer | | | | | considering | | | | | unavailability | | | | | period | | | +----------------+----------------+----------------+----------------+ | Solution #2: | UE provides | UE provides | No interaction | | UE provided | unavailability | unavailability | | | Unavailability | period via | period in | | | Period | Registration | Registration | | | | | | | | | Capability | Capability | | | | negotiation | negotiation | | | | between UE and | | | | | AMF | | | | | | | | | | AMF sets | | | | | periodic | | | | | registration | | | | | timer | | | | | considering | | | | | unavailability | | | | | period | | | | | | | | | | HLCom for DL | | | | | data | | | +----------------+----------------+----------------+----------------+ | Solution #3: | Capability | UE provides | No interaction | | Determination | negotiation | unavailability | | | of | between UE and | period in | | | unavailability | AMF | Registration | | | period in 5GS | | | | | | AMF may reject | Capability | | | | UE request to | negotiation | | | | become | | | | | unavailable | AMF may reject | | | | and optionally | unavailability | | | | provide a back | period and | | | | off timer | provide back | | | | | off timer | | | | If AMF accepts | | | | | unavailability | UE needs to | | | | period, UE | support | | | | triggers | unavailability | | | | d | back off timer | | | | eregistration. | | | | | | | | | | Alternatively, | | | | | MUSIM | | | | | connection | | | | | release and | | | | | paging | | | | | restriction | | | | | can be used | | | | | instead of | | | | | performing | | | | | d | | | | | eregistration. | | | +----------------+----------------+----------------+----------------+ | Solution #4: | UE provides | UE provides | Report | | Exposing UE | unavailability | unavailability | unavailability | | provided | period | period in | period to the | | unavailability | | Registration | AF via Loss of | | period via | If Loss Of | or | Connectivity | | Loss of | Connectivity | Deregistration | event | | Connectivity | event exists, | | subscription | | event | the AMF sends | If Loss of | | | subscription | notification. | Connectivity | | | | | Event | | | | | subscription | | | | | is exist, the | | | | | AMF reports | | | | | notification | | | | | when the UE | | | | | provided | | | | | unavailability | | | | | period | | +----------------+----------------+----------------+----------------+ | Solution #5: | UE reports | AF provisions | Negotiate BDT | | Determination | unavailability | unavailability | time window | | of | period to the | period | considering | | unavailability | AF via | provisioning | unavailability | | period in 5GS | application | via external | period | | for a specific | layer | parameter | | | UE | signalling. | provisioning | | | | | procedure | | | | AF provides | | | | | unavailability | Critical | | | | period to the | indication in | | | | UDR / NWDAF | BDT | | | | | negotiation | | | | For critical | | | | | service, the | | | | | AF negotiates | | | | | BDT | | | +----------------+----------------+----------------+----------------+ | Solution #6: | AF provides | AF provisions | AF determines | | Determination | unavailability | unavailability | unavailability | | of | period to the | period | period | | unavailability | UDM/UDR. | provisioning | | | period in 5GS | | via external | | | for a specific | UDM/UDR | parameter | | | UE | provides | provisioning | | | | unavailability | procedure | | | | period to the | | | | | AMF via | AMF, UE use | | | | subscription | the | | | | or AM Policy | unavailability | | | | association | period whether | | | | | to trigger | | | | UDM/PCF | deregistration | | | | provides | | | | | unavailability | | | | | period to the | | | | | UE via UPU / | | | | | Policy | | | | | delivery | | | | | | | | | | AMF / UE uses | | | | | the | | | | | unavailability | | | | | period to | | | | | determine | | | | | whether | | | | | deregistration | | | | | can be | | | | | executed | | | +----------------+----------------+----------------+----------------+
# 8 Conclusions
## 8.1 Conclusions for Key Issue #1
During Registration procedure, the UE provides indication of support of
\"Unavailability Period\" in Registration Request message, and the AMF
indicates the support of the \"Unavailability Period\" in Registration Accept
message.
If UE and network support \"Unavailability Period\" and an event is triggered
in the UE that would make the UE unavailable for a certain period of time
(e.g. for OS upgrade or device reboot), the UE may store its MM context in
USIM or Non Volatile memory to be able to reuse it after its unavailability
period. When the UE is ready to execute the event, the UE triggers mobility
registration or deregistration procedure including the unavailability period.
The AMF may provide Periodic Registration Update timer based on unavailability
period indicated by the UE, e.g. the AMF may provide a Periodic Registration
Update time larger than unavailability period. If the UE is not deregistered,
the AMF stores the information that the UE is unavailable in UE context, and
considers the UE is unreachable until the unavailability period has passed or
the UE enters CM-CONNECTED state. While the UE is unreachable, all high
latency communication solutions (see clause 5.31.8 of TS 23.501 [2]) may apply
if supported, e.g. extended data buffering, downlink data buffering status
report, etc. If there is \"Loss of Connectivity\" event subscription for the
UE by AF, the AMF triggers \"Loss of Connectivity\" event report and includes
unavailability period towards the NEF and the unavailability period is
reported to the respective subscribed AF.
When the UE is ready to execute the event (e.g. for OS upgrade or device
reboot), the UE may choose to store the UE contexts (MM and SM context).
NOTE 1: How the UE stores the context depends upon the UE implementation. The
UE may store some or all of the UE contexts in the USIM using existing USIM
functionality.
Once the event which makes the UE unavailable is completed in the UE or the
event is delayed to a future time or cancelled in the UE (e.g. due to
insufficient storage capacity, insufficient battery level or the event which
makes the UE unavailable is completed), the UE triggers registration procedure
to resume regular service. The UE does not include the Unavailability Period
in the Registration Request message. Depending on the state the UE ends up
after the event, the registration procedure can be Initial Registration
procedure or Mobility Registration Update procedure.
NOTE 2: The actual event execution in the UE, including user interaction, is
out of the scope of this feature.
NOTE 3: Exact names for the parameters exchanged between UE and Network can be
decided during normative work.
#