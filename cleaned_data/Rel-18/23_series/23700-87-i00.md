# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, certain modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
NOTE 1: The constructions \"shall\" and \"shall not\" are confined to the
context of normative provisions, and do not appear in Technical Reports.
NOTE 2: The constructions \"must\" and \"must not\" are not used as
substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as
possible, and they are not used in a normative context except in a direct
citation from an external, referenced, non-3GPP document, or so as to maintain
continuity of style when extending or modifying the provisions of such a
referenced document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
NOTE 3: The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
NOTE 4: The constructions \"can\" and \"cannot\" shall not to be used as
substitutes for \"may\" and \"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
NOTE 5: The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The scope of this document is to study IMS architecture enhancements to
support new real time communication services based on requirements of e.g.
eMMTEL and 5G_MEDIA_MTSI_ext.
The study in this document includes the following aspects:
1) Study the enhancement of IMS architecture and procedures to support Data
Channel usage in IMS network, including whether and which functionalities are
defined in IMS architecture for Data Channel server, with separate control
plane and media plane, and Data Channel application repository, which
procedures are needed between Data channel server and IMS AS to support call
event notifications.
2) Study whether and how IMS architecture and functions are supported for the
requirements from SA WG1 Rel-18 eMMTEL WID impacts:
\- to support AR telephony communication.
\- to support 3rd party to verify via operator network that the caller is
authorized to use or reference specific identity information which can be
securely signalled to the callee when placing a call.
3) Study whether and which IMS media control interfaces can be potentially
applied for service based architecture, supporting both existing capabilities
and new capabilities for possible new applications and efficient media
processing.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G system, Stage 2\".
[4] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G
System\".
[5] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS)\".
[6] 3GPP TS 26.114: \"Media handling and interaction\".
[7] 3GPP TS 22.261: \"Service requirements for the 5G system\".
[8] 3GPP TS 24.229: \"IP Multimedia Call Control based on SIP and SDP; Stage
3\".
[9] 3GPP TS 29.165: \"Inter-IMS Network to Network Interface (NNI)\".
[10] IETF RFC 5688: \"A Session Initiation Protocol (SIP) Media Feature Tag
for MIME Application Subtypes\".
[11] IETF RFC 6809: \"Mechanism to Indicate Support of Features and
Capabilities in the Session Initiation Protocol (SIP)\".
[12] IETF RFC 3264: \"An Offer/Answer Model with the Session Description
Protocol (SDP)\".
[13] IETF RFC 3261: \"SIP: Session Initiation Protocol\".
[14] 3GPP TR 26.998: \"Support of 5G Glass-type Augmented Reality / Mixed
Reality (AR/MR) devices\".
[15] 3GPP TS 26.928: \" Extended Reality (XR) in 5G\".
[16] draft-ietf-stir-passport-rcd-18: \"PASSporT Extension for Rich Call
Data\".
Editor\'s note: The above document cannot be formally referenced until it is
published as an RFC.
[17] ATIS-1000074: \"Signature-based Handling of Asserted information using
toKENs (SHAKEN)\".
https://access.atis.org/apps/group_public/download.php/62391/ATIS-1000074.v002.pdf.
[18] IETF RFC 8224: \"Authenticated Identity Management in the Session
Initiation Protocol (SIP)\".
[19] IETF RFC 6749: \"The OAuth 2,0 Authorization Framework\".
[20] 3GPP TS 24.183: \"IP Multimedia Subsystem (IMS) Customized Ring Signal
(CRS)\".
[21] 3GPP TS 23.256: \" Support of Uncrewed Aerial Systems (UAS) connectivity,
identification and tracking\".
[22] IETF RFC 8226: \"Secure Telephone Identity Credentials: Certificates\".
[23] draft-ietf-stir-cert-delegation-04: \"STIR Certificate Delegation\".
Editor\'s note: The above document cannot be formally referenced until it is
published as an RFC.
[24] ATIS-1000092: \"Signature-based Handling of Asserted information using
toKENs (SHAKEN): Delegate Certificates\".
[https://access.atis.org/apps/group_public/download.php/56801/ATIS-1000092.zip]{.underline}.
[25] 3GPP TR 22.873: \"Study on evolution of IMS multimedia telephony
service\".
[26] 3GPP TS 29.214: \"Policy and Charging Control over Rx reference point\".
[27] 3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".
[28] draft-ietf-sipcore-callinfo-rcd-04: \"SIP Call-Info Parameters for Rich
Call Data\".
Editor\'s note: The above document cannot be formally referenced until it is
published as an RFC.
[29] 3GPP TS 26.511: \"5G Media Streaming (5GMS); Profiles, codecs and
formats\".
[30] 3GPP TS 26.116: \"Television (TV) over 3GPP services; Video profiles\".
[31] 3GPP TS 26.117: \"5G Media Streaming (5GMS); Speech and audio profiles\".
[32] 3GPP TS 26.118: \"Virtual Reality (VR) profiles for streaming
applications\".
[33] 3GPP TS 26.119: \"Media Capabilities for Augmented Reality\".
# 3 Definitions of terms and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1], in
TS 23.501 [2] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1] or in TS 23.501 [2].
**Application data channel:** It is used to transfer data of data channel
applications between the UEs or between the UE and the network. The
application data channel should be established only after the application has
been downloaded. As specified in TS 26.114 [6], the stream ID for application
data channel can be integers starting from 1000.
**AR Application Server:** It is used to control the service logic related to
AR communication. The functional definition of the AR Application Server is
out of scope of 3GPP.
**Bootstrap data channel:** It is used to transfer data channel application
list and data channel applications between the UE and the network. The
bootstrap data channel is based on HTTP protocol. As specified in TS 26.114
[6], the stream ID for bootstrap data channel can be integers below 1000.
**Data channel application:** The HTML web content includes JavaScript(s), and
optionally image(s) and style sheet(s). It is accessible at the HTTP root
(\"/\") URL through a bootstrap data channel and describes the graphical user
interface and the interactive service logic.
**DC Application Server:** It interacts with DCSF and DC media function
(either DCMF or enhanced MRF) for data channel traffic handling in P2A/A2P
scenario. The functional definition of the DC Application Server is out of
scope of 3GPP.
**Ms reference point:** This reference point is used to request signing of an
Identity header field or request verification of a signed assertion in an
Identity header field.
**Secure Telephone Identity Authentication Service (STI-AS):** The SIP
application server that performs the function of the authentication service
defined in IETF RFC 8224 [18].
**Secure Telephone Identity Verification Service (STI-VS):** The SIP
application server that performs the function of the verification service
defined in IETF RFC 8224 [18].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], in TS 23.501 [2] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in TR 21.905 [1] or in TS 23.501 [2].
5QI 5G QoS Identifier
A2P Application to Person
DC Data Channel
DCAR Data Channel Application Repository
DCMF Data Channel Media Function
DCMTSI Data Channel Multimedia Telephony Service for IMS
DCS Data Channel Server
DCS-C Control Function of Data Channel Server
DCS-M Media Function of Data Channel Server
DCSF Data Channel Signalling Function
P2A Person to Application
P2P Person to Person
PASSporT Personal Assertion Token
QCI QoS Class Identifier
QoS Quality of Service
RCD Rich Call Data
SHAKEN Signature-based Handling of Asserted information using toKENs
STI Secure Telephone Identity
STI-AS Secure Telephone Identity Authentication Service
STI-VS Secure Telephone Identity Verification Service
STIR Secure Telephone Identity Revisited
TN Telephone Number
# 4 Architectural Assumptions and Principles
## 4.1 Architectural Assumptions
The following architecture assumptions are applied to all KIs in the study:
\- Reference architecture of IMS defined in TS 23.228 [5] is used as basis
architecture for supporting next generation real time communication.
\- Call control protocol is based on SIP.
## 4.2 Architectural Principles
The following architectural principles apply for all KIs in the study:
\- Solutions shall be access agnostic.
The following architectural principles apply for Data Channel usage in IMS:
\- Solutions shall have minimal impacts to IMS architecture and procedures.
\- Solutions shall use functionality and procedures for data channel as
defined in TS 26.114 [6] as a baseline.
# 5 Key Issues
## 5.1 Key Issue #1: Enhancement to support Data Channel usage in IMS network
### 5.1.1 Description
In TS 26.114 [6], the key component DCMTSI client is defined as a data channel
capable MTSI client supporting data channel media. It implies the data channel
media function or component is necessary for data channel communication.
TS 26.114 [6] specifies the workflow where the data channel application is
created prior to the DCMTSI call where it is intended to be used, and it
doesn\'t cover how to create data channel in parallel with IMS call setup.
This key issue aims to study enhancement of IMS network to support the
following aspects:
\- How IMS network architecture needs to be enhanced to support
functionalities associated with Data Channel Server functionality allowing for
separate control and media plane, and Data Channel Application Repository.
This includes defining new IMS functionalities and interfaces and/or
identifying impacts on existing IMS functionalities and interfaces.
\- Whether, and if so which, existing IMS procedures need to be changed to
support Data Channel usage in IMS.
\- Study how support of Data Channel capabilities can be discovered by the
network and UE.
\- Study which functionalities and procedures that need to be changed to
support policy and charging control for Data Channel in IMS including QoS
support.
\- Whether and how IMS network architecture and procedures can be enhanced to
support interworking between a DCMTSI client and MTSI client.
NOTE: This last bullet has dependency on progress of other bullets.
Coordination with SA WG4 might be needed.
## 5.2 Key Issue #2: IMS based AR telephony communication
### 5.2.1 Description
The Key Issue is to study the IMS architecture and solution for AR telephony
communication including:
\- Study, and identify IMS network architecture enhancements required to
support AR telephony communication for different types of AR-capable UEs.
\- Study, and identify how existing IMS procedures including signalling and
media processing need to be changed to support AR telephony communication
NOTE: Coordination with SA**WG** 4 will be required**, the AR media and AR
specific data format, codecs and media processing procedures need to be
defined in SA WG4.**
## 5.3 Key issue #3: Third party specific user identities
### 5.3.1 Description
The Key Issue is to study the architecture impact of third party specific user
identities accessing IMS network, including:
\- Study and if needed, define a mechanism how the serving IMS network can
authorize a third party, and how the authorized third parties can verify
whether a third party user is allowed to use third-party specific identities
to initiate a call.
\- Study and if needed, define a mechanism how the terminating IMS network can
support the called party to verify third-party specific identities during a
call.
\- Study whether and how IMS procedures need to be enhanced to support
authentication, authorization and verification to use third-party specific
identities, which should be performed by the IMS network and third party. This
includes studying potential impacts to the call-back procedure, and potential
impacts on STIR/SHAKEN procedures defined in TS 24.229 [8].
\- Study and if needed, identify required enhancements to an IMS subscription
to support trusted third parties.
NOTE: Security related aspects should be studied by SA WG3.
## 5.4 Key Issue #4: Study of Applicability of Service based principles to IMS
media control interfaces
### 5.4.1 Description
This key issue aims to study whether and how 5G service based principles can
be applied to IMS media control architecture and related interfaces.
The following aspects are studied in this key issue taken into account all the
Notes listed below:
\- Study whether and how 5G service based principles e.g. service
registration, discovery, selection, etc. can be applied to IMS media control
architecture and interfaces, to support existing and new capabilities such as
e.g. Data Channel or AR, and to provide efficient media processing.
\- Based on the outcome from the first bullet, study co-existence of 5G
service based and legacy IMS media control interfaces while considering
backward compatibility.
NOTE 1: The priority is to support IMS DC.
NOTE 2: Solutions defined for this key issue need to be aligned with solutions
for e.g. data channel and AR communications.
NOTE 3: SIP as call control protocol shall be maintained.
NOTE 4: While media discovery/selection is in scope for the study, extension
to e.g. IMS AS, etc. discovery/selection may be considered when it comes to
solution evaluation.
# 6 Solutions
## 6.0 Mapping of Solutions to Key Issues
Table 6.0-1: Mapping of Solutions to Key Issues
* * *
              Key Issues
Solutions 1 2 3 4 1 X  
2 X  
3 X  
4 X  
5 X  
6 X  
7 X  
8 X  
9 X  
10 X  
11 X  
12 X  
13 X  
14 X 15 X 16 X X 17 X X 18 X  
19 X  
20 X  
21 X  
22 X  
23 X
* * *
## 6.1 Solution #1: Data Channel Usage for A2P/P2A Scenario
### 6.1.1 Description
This solution resolves Key Issue #1 about supporting Data Channel usage in IMS
network, specifically for Application to Person (A2P) and Person to
Application (P2A) scenarios.
DC Server includes both control function and media function and they interact
with IMS AS in the IMS network. DC control function implements data channel
business logic; and DC media function executes IMS data channel media
operations. DC media function can be deployed as a standalone function as
shown in Figure 6.1.1-1 (Option 1); or it can be integrated in MRF in IMS
network as shown in Figure 6.1.1-2 (Option 2). In Option 1, there are two new
interfaces which need to be defined: Interface 1 between DC control function
and IMS AS, and Interface 2 between DC control function and DC media function.
Interface 1 is used to send DC event notification and exchange the media
information which will be translated into SIP/SDP between DC control function
and IMS AS. In Option 2, only Interface 1\' between DC control function and
IMS AS is newly defined; and the interface between IMS AS and MRF will reuse
Mr\'/Cr in IMS architecture. In Option 2, when DC Control Function needs to
control the DC related media in MRF, it will send the controlling operations
to IMS AS, and IMS AS interacts with MRF for the media operations through
existing Mr\'/Cr interfaces. It will be better for MRF to receive the
controlling operations from a single source, e.g. IMS AS.
{width="1.6881944444444446in" height="1.05625in"}
Figure 6.1.1-1: Option 1: Standalone DC media function
{width="1.18125in" height="1.5631944444444446in"}
Figure 6.1.1-2: Option 2: DC media function integrated in MRF
The procedures of Data Channel establishment for A2P/P2A applications defined
in clause 6.1.2 will be based on the interaction between DC control function
and DC media function.
### 6.1.2 Procedures
Depicted in Figure 6.1.2 -1 is the high-level procedures of Data Channel
establishment for A2P/P2A applications.
Figure 6.1.2-1: High-level procedures of Data Channel establishment for
A2P/P2A applications
There are 3 phase procedures for supporting DC usage in IMS network as shown
in Figure 6.1.2-1 and they are:
\- Procedures of bootstrap DC establishment;
\- Procedures of application acquirement;
\- Procedures of application DC establishment.
For the procedures of bootstrap DC establishment, DCMTSI Client sends Invite
request for Bootstrap DC to IMS AS through I/S-CSCF. IMS AS triggers the event
notification to DC Control Function. Then DC Control Function instructs DC
Media Function to create Bootstrap DC resource directly or through IMS AS. IMS
AS responds the result to DCMTSI Client. Then bootstrap data channel is
established between DCMTSI and DC Media Function.
For the procedures of application acquirement, DCMTSI Client sends Application
Request to DC Media Function on the established bootstrap data channel. DC
Media Function interacts with DC Application Repository to get the application
and transfers it to DCMTSI Client over bootstrap data channel.
For the procedures of application DC establishment, DCMTSI Client sends Invite
request for Application DC to IMS AS through I/S-CSCF. IMS AS triggers the
event notification to DC Control Function. The subscribe/notify pattern could
be used by DC Control Function and IMS AS for the DC event notification. DC
Control Function subscribes to IMS AS and the subscription information at
least includes the user identity and the event description i.e. DC event
information. When there are multiple IMS AS deployed, DC Control Function will
subscribe to all IMS AS. Alternatively, the pre-configuration of mapping
information of the user identity to DC Control Function stored in IMS AS can
be used for the DC event notification. Then DC Control Function instructs DC
Media Function to create Application DC resource directly or through IMS AS.
IMS AS responds the result to DCMTSI Client. Then application data channel is
established between DCMTSI Client and DC Media Function; and the data could be
exchanged between DCMTSI Client and DC Media Function for the A2P/P2A
application over this DC.
Editor\'s note: The detail subscription information from DC Control Function
to IMS AS is FFS.
### 6.1.3 Impacts on existing nodes and functionality
The solution has impacts on the following entities:
UE:
\- Support DCMTSI functionality and related procedures.
IMS network:
\- IMS AS: Support interaction with DC Control Function and Media Function to
support DC usage; send DC event notification and receive DC media information.
\- New added DC Control Function, DC Media Function, and DC Application
Repository.
\- MRF: Support DC Media Function.
## 6.2 Solution #2: Solution of Data Channel usage in IMS network
### 6.2.1 Description
#### 6.2.1.1 Introduction
TS 26.114 [6] specifies the workflow where the data channel application is
created prior to the DCMTSI call where it is intended to be used. It doesn\'t
cover how to integrate data channel related functions into IMS architecture,
as well as the impact to IMS call setup procedures.
This solution proposes the enhancement of IMS network based on SBA to support
the functionalities of data channel. Two new network functions are specified
for data channel management, including Data Channel Server (DChS) and Data
Channel Application Repository (DCAR). Some existing NFs are enhanced in IMS
network to support data channel, including MRFC, NRF and NEF.
#### 6.2.1.2 Enhancement to IMS architecture
Figure 1 depicts the reference architecture of IMS enhancement for data
channel. Service-based interfaces are used within the Control Plane.
{width="6.569444444444445in" height="2.1354166666666665in"}
Figure 6.2.1.2-1: IMS architecture enhancement to support data channel
Data Channel Server (DChS) supports the following functionalities:
\- Receives data channel applications from the users or authorized party.
\- Stores the data channel applications in the Data Channel Application
Repository (DCAR).
\- Manages data channels with DCMTSI clients according to the request from
IMS-AS.
\- Distributes or updates data channel applications via established bootstrap
data channels to DCMTSI clients.
\- Routes data channel applications traffic between DCMTSI clients and the
application servers.
\- Generates traffic usage reports and event reports
Data Channel Application Repository (DCAR) supports the following
functionalities:
\- Storage and retrieval data channel applications
NOTE: An open interface between DCAR and DChS will not need to be normatively
specified.
Media Resource Function Controller (MRFC) is enhanced with service-based
interface to support the handling of media data from data channels and the
convergence with audio/video traffic in the media channels.
Editor\'s note: How MRFC applies in IMS data channel establishment procedures
is FFS.
NRF maintains the IMS NFs profile and support service discovery function.
NEF supports provision of external information e.g. data channel applications
to IMS networks.
### 6.2.2 Procedures
{width="5.100694444444445in" height="4.075694444444444in"}
Figure 6.2.2-1: Data Channel establishment procedure
1\. The originating DCMTSI UE as defined in TS 26.114 [6] includes a data
channel media description for the bootstrap data channels in the initial SDP
offer.
2\. The IMS-AS determines to trigger the bootstrap data channel for the
originating UE based on the network operator\'s policy.
3\. The IMS AS creates and sends a new SDP offer to the terminating DCMTSI UE
in order to setup a bootstrap data channel with the terminating UE.
4\. If the IMS-AS does discovery of Data Channel Server (DChS), the IMS-AS
shall utilize the NRF to discover DChS instance(s) unless DCS information is
available by other means, e.g. locally configured on IMS-AS.
5\. IMS AS sends an offer response of bootstrap DC to the originating UE.
6\. The IMS-AS requests DChS to allocate resource (e.g. DTLS/SCTP bears) for
the bootstrap DC to the originating UE and the terminating UE with related
media description information.
7\. If the DChS does not store the requested applications, it will retrieve
the applications from the Data Channel Application Repository (DCAR). If the
DC applications are provisioned by third party, the NEF is required for the
interworking between DChS and external AF. If the DCAR are deployed by third
party, the NEF is required for the interworking between DChS and DCAR.
8\. The applications are distributed to the DCMTSI UE(s) via the bootstrap
data channel(s) as defined in TS 26.114 [6].
9\. One or more non-bootstrap data channels are established according to the
media feature of applications that invoked in the DCMTSI UE. IMS AS may
request MRFC to perform the synchronization and convergence of DC media and
audio/video media for rendering in the DC applications.
### 6.2.3 Impacts on existing nodes and functionality
Media Resource Function Controller (MRFC) is enhanced to support the handling
of media data from data channels and the convergence with audio/video traffic
in the media channels.
NRF is enhanced to maintain the IMS NFs profile and support service discovery
function.
NEF is enhanced to support provision of external information e.g. data channel
applications to IMS networks.
## 6.3 Solution #3: Data Channel Architecture
### 6.3.1 Description
This solution addresses Key Issue #1 \"Enhancement to support Data Channel
usage in IMS network\" and focuses on how IMS network architecture and
procedures needs to be enhanced to support functionalities associated with
Data Channel Server functionality allowing for separate control and media
plane, and Data Channel Application Repository.
The solution introduces two new network functions into IMS network, which
provide the control function and the media function of IMS data channel
respectively.
#### 6.3.1.1 Architecture Description
The following Figure 6.3.1.1-1 shows the high-level architecture of the
solution.
{width="6.690277777777778in" height="4.0055555555555555in"}
Figure 6.3.1.1-1: IMS data channel architecture; reference point
representation
The following network functions are introduced into this architecture, whose
services are described in clause 6.3.1.2:
\- DCS-C: Control Function of Data Channel Server.
\- DCS-M: Media Function of Data Channel Server.
NOTE 1: The NRF is not depicted in the reference point architecture figure.
NOTE 2: There is no change to the existing MRF (MRFC and MRFP).
The following reference points are defined for the IMS data channel
architecture. It is suggested that SBI is applied to these reference points:
\- IF1: Reference point between the DCS-C and the DCS-M.
\- IF3: Reference point between the DCS-C and the MMTel AS.
\- IF4: Reference point between the DCS-C and the NEF.
\- IF5: Reference point between the MMTel AS and the DCS-M.
NOTE 3: Specifying IF4 is out of the scope of 3GPP Release 18 and will be
discussed in the later release.
#### 6.3.1.2 Network Function Description
##### 6.3.1.2.1 Control Function of Data Channel Server (DCS-C)
The Control Function of Data Channel Server (DCS-C) plays the role of IMS data
channel control function, which includes:
\- Manages bootstrap data channels and application data channels.
\- Controls upload and download of IMS data channel applications.
\- Subscribes and receives media event notifications from the MMTel AS when
the data channels are associated with an IMS audio/video session. The
notifications contain the information about the data channel media
descriptions in the SDP offer/answer received by the MMTel AS. Based on these
information and the user\'s subscription to the data channel services, the
DCS-C indicates the MMTel AS how to deal with the data channel media
descriptions in the SDP offer/answer received.
It is noted that the MMTel AS is selected by the S-CSCF when the ISC interface
is triggered, the DCS-C does not know which MMTel AS will serve some user.
Therefore the DCS-C has to query all the MMTel AS in the network via the NRF
and send Subscribe requests to them. Another solution is that implicit
subscription is used. That is, the MMTel AS knows the mapping from the
subscriber identity segments to the DCS-C based on local configuration:
\- Exposure data channel capability to the third party through IF4.
In addition, the DCS-C need to support service registration with the NRF, and
service discovery/selection via the NRF.
##### 6.3.1.2.2 Media Function of Data Channel Server (DCS-M)
The Media Function of Data Channel Server (DCS-M) plays the role of IMS data
channel media function, which includes:
\- Initiates and terminates bootstrap data channels between the UE and itself.
\- Initiates and terminates application data channels between the UE and
itself in A2P/P2A scenarios.
\- Supports data channel interworking towards internet/intranet. In the
A2P/P2A scenarios, the data channel applications may be hosted on the third
party application server and the UE must interacts with the third party
application server through the DCS-M to send and receive application data.
In addition, the DCS-M need to support service registration with the NRF.
#### 6.3.1.3 Network Function Service Description
All the services described below will be discovered and selected via the NRF.
##### 6.3.1.3.1 DCS-C Services
{width="0.9076388888888889in" height="1.1270833333333334in"}
Figure 6.3.1.3.1-1: Reference Architecture for the Ndcs-c Services; SBI
representation
{width="0.9076388888888889in" height="1.1270833333333334in"}
Figure 6.3.1.3.1-2: Reference Architecture for the Ndcs-c Services; reference
point representation
The DCS-C provides the following services to the NEF:
\- Control operations of data channel, such as opening, continuing, closing,
refusing some data channel media stream, etc.
NOTE: This service is out of the scope of 3GPP Release 18 and will be
discussed in the later release.
##### 6.3.1.3.2 DCS-M Services
{width="2.0006944444444446in" height="1.1270833333333334in"}
Figure 6.3.1.3.2-1: Reference Architecture for the Ndcs-m Services; SBI
representation
{width="1.99375in" height="1.14375in"}
Figure 6.3.1.3.2-2: Reference Architecture for the Ndcs-m Services; reference
point representation
The DCS-M provides the following services to the MMTel AS:
\- Operations on data channel related resources and data channel media stream,
such as allocating/updating/releasing data channel related resources,
initiating and terminating some data channel media stream and so on.
The DCS-M provides the following services to the DCS-C:
\- Operations on the application data of the data channel applications, such
as sending/reporting application data, and so on.
##### 6.3.1.3.3 MMTel AS Services
{width="0.9076388888888889in" height="1.1270833333333334in"}
Figure 6.3.1.3.3-1: Reference Architecture for the Nmmtelas Services; SBI
representation
{width="0.9076388888888889in" height="1.1270833333333334in"}
Figure 6.3.1.3.3-2: Reference Architecture for the Nmmtelas Services;
reference point representation
The MMTel AS provides the following services to the DCS-C:
\- Subscription and notification of media event during an IMS session.
It should be noted that, the DCS-C could not know what subscribers each MMTel
AS serve for the MMTel AS is selected by the S-CSCF and, there are two
solutions:
\- The DCS-C should subscribe to all the MMTel ASs in the network for the
media event notification.
\- The MMTel AS is locally configured for discovering the DCS-C serving
specific subscribers.
\- Media control during an IMS session, including SDP operations such as
initiating, terminating and forwarding some media stream.
#### 6.3.1.3 Lawful Intercept of IMS Data Channel
Editor\'s note: The lawful intercept solution of IMS data channel is FFS.
#### 6.3.1.4 Interactions with IMS Supplementary Services
Editor\'s note: How the data channel interacts with IMS supplementary services
is FFS.
### 6.3.2 Procedures
#### 6.3.2.1 NF service registration
The DCS-C, DCS-M and MMTel AS should register their services to the NRF before
providing services to the consumers, through the NF service registration
procedure specified in clause 4.17.1 of TS 23.502 [3].
#### 6.3.2.2 Data channel SDP media description model
Bootstrap data channels are established between the UE and the network. In an
IMS session associated with data channel, the originating network and the
terminating network will establish bootstrap data channels with the
originating UE and the terminating UE respectively, if the networks and the
UEs all support data channel. There are different data channel media
descriptions in the SDP offer/answer, according to clause 6.2.10.1 of TS
26.114 [6].
In P2P scenarios, application data channels are established between the UEs.
For example, Sharing Screen is implemented through the application data
channel between the originating UE and the terminating UE. In this case, a
separate data channel media description is used in the SDP offer/answer for
the application data channel.
In A2P/P2A scenarios, application data channels are established between the UE
and the DCS-M. For example, Multimedia CLIP (Calling Line Identification
Presentation) is implemented through the application data channel between the
DCS-M in the originating network and the terminating UE. In this case, the
application data channel could use the same data channel media description
with that of the bootstrap data channel between the DCS-M in the originating
network and the terminating UE, if the two kinds of data channels use the same
bear/QCI Flow. Otherwise, a separate data channel media description is used in
the SDP offer/answer for the application data channel.
#### 6.3.2.3 Establishing bootstrap data channels
There are two types establishing procedures of bootstrap data channel shown
below.
\- UE-initiated bootstrap data channel establishment.
\- Network-initiated bootstrap data channel establishment.
NOTE 1: It is assumed in this clause that all the service producers (MMTel AS,
DCS-C and DCS-M) have registered their services to the NRF and the DCS-C has
subscribed to the MMTel AS.
NOTE 2: The NF discovery and selection is not shown in the following
procedures.
##### 6.3.2.3.1 UE-initiated bootstrap data channel establishment
Figure 6.3.2.3.1-1 and Figure 6.3.2.3.1-2 show the procedure of UE-initiated
bootstrap data channel establishment between network A and the UEs. It\'s
assumed that both UE A and UE B support data channel capability.
{width="6.688194444444444in" height="4.6125in"}
Figure 6.3.2.3.1-1: UE-initiated bootstrap data channel establishment
procedure
1\. UE A sends an INVITE request to its local IMS network with an initial SDP
offer, to initiates an IMS session to UE B.
2\. The MMTel AS A sends a Media Event Notification to the DCS-C A, indicating
the channel media descriptions with the IMS session. The DCS-C A sends a Media
Control request to the MMTel AS A, indicating how to process the SDP. The
MMTel AS A sends an DC Resource Allocation request to the DCS-M A, requiring
the DCS-M A to allocate data channel resources for the bootstrap data channel
media stream between UE A and the DCS-M A and the bootstrap data channel media
stream between the DCS-M A and UE B.
3\. The MMTel AS A updates the SDP offer in the INVITE request, based on the
Media Control request from the DCS-C A, and sends the INVITE request message
to the terminating network.
4\. UE B sends an 18X response to its local IMS network with an initial SDP
answer.
5\. The P-CSCF B executes QoS procedure to establish the dedicated bearer/QCI
Flow for the audio/video/data channel media based on the SDP answer in the 18X
response.
6\. The MMTel AS B updates the initial SDP answer in the 18X response, and
sends it to the remote network.
7\. When the MMTel AS A receives the 18X response, it sends a Data Channel
Resource Update request to the DCS-M A, requiring the DCS-M A to update data
channel resources for the bootstrap data channel media stream between the
DCS-M B and UE B. The MMTel AS A sends a Media Update Notification message to
the DCS-C A, reporting the data channel media negotiation result.
8\. The MMTel AS A updates the initial SDP answer in the 18X response, and
sends it to the S-CSCF A. This 18X response is sent to the UE A by the S-CSCF.
9\. The P-CSCF A executes QoS procedure to establish the dedicated bearer/QCI
Flow for the audio/video/data channel media based on the SDP answer in the 183
response.
10\. The subsequent is the PRACK/PRACK 200 procedure.
11\. After the precondition procedure is completed in the network A, UE A
sends an UPDATE request with a new SDP offer for media renegotiation.
12-13. UE A initiates SCTP association and DTLS connection establishment
procedures to establish the bootstrap data channels with the DCS-M A and the
DCS-M B respectively. UE A retrieves the bootstrap application and the data
channel application list from the DCS-C A and the DCS-C B respectively.
14\. After the precondition procedure is completed in the network B, UE B
returns a 200 OK with a new SDP answer for the UPDATE request from UE A.
15-16. UE B initiates SCTP association and DTLS connection establishment
procedures to establish the bootstrap data channels with the DCS-M B and the
DCS-M A respectively. UE B retrieves the bootstrap application and the data
channel application list from the DCS-C B and the DCS-C A respectively.
17\. The subsequent procedure of the session is continued.
##### 6.3.2.3.2 Network-initiated bootstrap data channel establishment
The network-initiated bootstrap data channel establishment procedure is used
when the originating UE does not support data channel. Therefore, there is no
data channel media description in the initial SDP offer generated by the
originating UE. If the originating network or the terminating network supports
data channel, it will add data channel media description(s) into the SDP offer
to negotiate with the terminating UE.
The network-initiated bootstrap data channel establishment procedure has few
difference with the UE-initiated bootstrap data channel establishment
procedure, and details are not described herein again.
#### 6.3.2.4 Establishing application data channels
There are two types establishing procedures of application data channel shown
below.
\- Establishing application data channel between UEs.
\- Establishing application data channel between the UE and the network.
NOTE 1: It\'s assumed in this clause that all the service producers (MMTel AS,
DCS-C and DCS-M) have registered their services to the NRF and the DCS-C has
subscribed to the MMTel AS.
NOTE 2: The NF discovery and selection is not shown in the following
procedures.
##### 6.3.2.4.1 Establishing application data channel between UEs
Figure 6.3.2.4.1-1 shows the establishment procedure of application data
channel between UEs after the IMS session between UE A and UE B has been
connected. It\'s assumed that both UE A and UE B, and their local networks
support data channel capability.
{width="6.689583333333333in" height="2.3583333333333334in"}
Figure 6.3.2.4.1-1: Establishment procedure of application data channel
between UEs
1\. UE A sends a re-INVITE request to the P-CSCF A with an updated SDP offer
in which a data channel media description for an application data channel is
added.
2\. The MMTel AS A sends a Media Event Notification to the DCS-C A with the
information of this new data channel media description. The DCS-C A sends a
Media Control request to the MMTel AS A, indicating how to process the SDP.
3\. The MMTel AS A updates the SDP offer based on the Media Control request
from the DCS-C A, and sends the re-INVITE request message to the S-CSCF A with
the updated SDP offer. This re-INVITE request is sent to the MMTel AS B.
4\. The MMTel AS B sends a Media Event Notification message to the DCS-C B.
The DCS-C B sends a Media Control request to the MMTel AS B, indicating how to
process the SDP.
5\. The MMTel AS B updates the SDP offer in the re-INVITE request, based on
the Media Control request from the DCS-C B, and sends the re-INVITE request
message to the S-CSCF B with the updated SDP offer. This re-INVITE request is
sent to UE B.
6\. UE B sends a 200 OK response to its local network with a SDP answer.
7\. The P-CSCF B executes QoS procedure to establish the dedicated bearer/QCI
Flow for the application data channel media based on the SDP answer in this
200 OK response.
8\. This 200 OK response is sent to UE B.
9\. The P-CSCF A executes QoS procedure to establish the dedicated bearer/QCI
Flow for the application data channel media based on the SDP answer in this
200 OK response.
10\. UE A initiates SCTP association and DTLS connection establishment
procedures to establish the application data channel with UE B.
11\. The subsequent is the ACK for 200 OK procedure.
##### 6.3.2.4.2 Establishing application data channel between the UE and the
network
Figure 6.3.2.4.2-1 shows the establishment procedure of application data
channel between UE B and the network A when the IMS session between UE A and
UE B is not connected yet. It\'s assumed that both UE A and UE B, and their
local networks support data channel capability.
{width="6.683333333333334in" height="2.0180555555555557in"}
Figure 6.3.2.4.2-1: Establishment procedure of application data channel
between the UE and the network
1\. UE B sends an UPDATE request with an updated SDP offer, in which an
application data channel media stream is added. This UPDATE request is sent to
the MMTel AS B.
2\. The MMTel AS B sends a Media Event Notification to the DCS-C A. The DCS-C
A sends a Media Control request to the MMTel AS A, requiring the MMTel AS A to
terminate this application data channel media stream. The MMTel AS A sends a
DC Resource Allocation request to the DCS-M A, requiring the DCS-M A to
allocate data channel resources for the application data channel media stream
between the DCS-M A and UE B.
3\. Then the MMTel AS B updates the SDP offer and sends the UPDATE request to
the S-CSCF A with the SDP offer. Then this UPDATE request is sent to UE A.
4\. UE A returns a 200 OK response. This response is sent to UE B.
5\. The P-CSCF B executes QoS procedure to update the dedicated bearer/QCI
Flow for the data channel media based on the SDP answer in the 200 OK
response.
6\. The application data channel between the DCS-M A and UE B is established.
#### 6.3.2.5 Terminating data channels
In the case of data channel associated with an IMS audio/video session, all
the data channels should be terminated with the IMS session.
#### 6.3.2.6 Exception handling of data channels
In the case of abnormal scenarios, such as failing to establish bearer/QCI
Flow for data channel, audio/video media negotiation failure and so on, the
MMTel AS should terminate all the data channels.
### 6.3.3 Impacts on existing nodes and functionality
#### 6.3.3.1 Impacts to existing nodes
This solution has some requirements on the existing IMS nodes below:
MMTel AS:
\- Support service registration with the NRF and service discovery via the
NRF.
\- Provides the DCS-C media event subscription and notification service.
\- Provides the DCS-C media control service, including initiation and
termination of bootstrap data channels and application data channels.
\- Supports IMS data channel capability registration of the UE, as specified
in clause 5.4.1.7 of TS 24.229 [8].
\- Supports data channel media negotiation according to the requests from the
DCS-C.
P-CSCF/IMS-AGW:
\- Supports for data channel QoS handling between IMS Core and Packet Core.
IBCF/TrGW:
\- Supports data channel media feature tag and data channel media description
at the II-NNI, as specified in TS 29.165 [9].
PCRF/PCF:
\- Supports for data channel QoS handling between IMS Core and Packet Core.
#### 6.3.3.2 Impacts to existing interfaces
This solution has some impacts on the existing interfaces below:
Nnrf:
\- Nnrf_NFManagement service need to be extended to support service
registration of DCS-C, DCS-M and MMTel AS.
\- Nnrf_NFDiscovery service need to be extended to support service
discovery/selection of DCS-C, DCS-M and MMTel AS.
## 6.4 Solution #4: IMS Data Channel Capabilities Discovery
### 6.4.1 Description
This solution addresses Key Issue #1 \"Enhancement to support Data Channel
usage in IMS network\" and focuses on the third bullet, that is, how support
of Data Channel capabilities can be discovered by the network and UE.
IMS data channel capabilities discovery includes two aspects:
\- The network discovers the data channel capability of the UE, including the
local UE and the remote UE.
\- The UE discovers the data channel capability of the network, including the
local network and the remote network.
#### 6.4.1.1 Network discovers the data channel capability of the UE
The basic principles of how the network discovers the data channel capability
of the UE are as follows.
\- The home network discovers the data channel capability of its UE during IMS
REGISTER procedure defined in clause 5.1.1 of TS 24.229 [8].
\- The network discovers the data channel capability of the remote UE during
initial INVITE procedure defined in clause 5.1.3.1 and clause 5.1.4.1 of TS
24.229 [8].
##### 6.4.1.1.1 Home network discovers the data channel capability of its UE
According to clause 5.1.1 of TS 24.229 [8], a DCMTSI client shall include a
+sip.app-subtype media feature tag, as specified by IETF RFC 5688 [10], with a
value of \"webrtc-datachannel\" in the Contact header field of a REGISTER
request to indicate to its local network that it supports IMS data channel
capability.
It should be noted that, the MMTel AS also need to discover whether the UE
supports data channel capability in the case of data channel associated with
an IMS voice/video call. According to clause 5.4.1.7 of TS 24.229 [8], the
S-CSCF should include the contents of the incoming REGISTER request or the
contents of the 200 (OK) response to the incoming REGISTER request in the body
of the third-party REGISTER, if there is Filter Criteria indicating the need.
That is, the MMTel AS could discover the data channel capability of the UE by
inspecting a +sip.app-subtype media feature tag with a value of \"webrtc-
datachannel\" in the Contact header field of user-initiated REGISTER request
contained in the body of the third-party REGISTER request received from the
S-CSCF.
##### 6.4.1.1.2 Remote network discovers the data channel capability of the
local UE
According to clause 5.1.3.1 of TS 24.229 [8], when the local UE originates an
initial INVITE request, it shall include a +sip.app-subtype media feature tag,
as specified by RFC 5688 [10], with a value of \"webrtc-datachannel\" in the
Contact header of the INVITE request, to indicate to the remote network that
it supports IMS data channel capability during this IMS session.
According to clause 5.1.4.1 of TS 24.229 [8], when the local UE terminates an
initial INVITE request, it shall include a +sip.app-subtype media feature tag,
as specified by RFC 5688 [10], with a value of \"webrtc-datachannel\" in the
Contact header of the 18X and 200 response to the INVITE request, to indicate
to the remote network that it supports IMS data channel capability during this
IMS session.
#### 6.4.1.2 UE discovers the data channel capability of the network
##### 6.4.1.2.1 UE discovers the data channel capability of its home network
It is suggested that the mechanism defined in IETF RFC 6809 [11] is applied
for the UE to discover the data channel capability of its home network. That
is, the S-CSCF in its home network includes a Feature-Caps header field, with
the \"+g.3gpp.webrtc-datachannel\" header field parameter in the 200 OK
response during IMS registration procedure defined in clause 5.1.1 of TS
24.229 [8], if the home network supports IMS data channel capability.
After the initial registration if the network starts supporting IMS DC then
S-CSCF shall add Feature-Caps header with value set to \"+g.3gpp.webrtc-
datachannel\" in 200 OK of any subsequent registration request it receives
from the UE.
Editor\'s note: This feature-capability indicator \"+g.3gpp.webrtc-
datachannel\", is to be registered with IANA.
In roaming scenario, the HPLMN should ensure that the requested QoS sent to a
VPLMN is within the limits of the roaming agreement. Therefore, if the S-CSCF
knows that the VPLMN does not support IMS data channel capability based on
local configuration according to the roaming agreement with the VPLMN, it
should not include a Feature-Caps header field, with the \"+g.3gpp.webrtc-
datachannel\" header field parameter in the 200 OK response during IMS
registration procedure.
##### 6.4.1.2.2 Local UE discovers the data channel capability of the remote
end
If the local UE is the originating party, it may discover that the remote end
does not support IMS data channel if the port number in the data channel media
stream of the SDP answer it received is set to zero, as specified in clause 6
of IETF RFC 3264 [12].
#### 6.4.1.3 Avoid impact on IMS basic audio/video call
It\'s important that the basic IMS voice/video session should not be impacted
by the failure of data channel media negotiation. To avoid this case, it\'s
recommended that:
\- if the home network does not support IMS data channel, the UE should not
include data channel media description in the SDP offer.
\- For already registered UE if the IMS DC capability of network was not
provided then S-CSCF shall add a Feature-Caps header field with a
\"+g.3gpp.webrtc-datachannel\" header field parameter in the 200 OK of any
subsequent registration request it receives from the UE.
\- if the remote network does not support IMS data channel and returns a 488
(Not Acceptable Here) response with a Warning header indicating that it does
not support data channel media description, as specified in IETF RFC 3261
[13], the originating UE in the local network should remove all the data
channel media descriptions in the SDP offer and retry sending the updated
request, as specified in clause 6.1.2 of TS 24.229 [8].
\- if the remote UE does not support IMS data channel, the MMTel AS in the
remote network should remove all the data channel media descriptions in the
SDP offer contained in any request message to the remote UE.
### 6.4.2 Procedures
There is no update to the existing procedures.
### 6.4.3 Impacts on existing nodes and functionality
The requirements on the S-CSCF are as follows:
\- If the network supports data channel media, the S-CSCF should include a
Feature-Caps header field with a \"+g.3gpp.webrtc-datachannel\" header field
parameter in the 200 OK response during SIP registration procedure, to
indicate the UE that its home network supports data channel capability.
\- For already registered UE if the IMS DC capability of network was not
provided then S-CSCF shall add a Feature-Caps header field with a
\"+g.3gpp.webrtc-datachannel\" header field parameter in the 200 OK of any
subsequent registration request it receives from the UE.
The requirements on the MMTel AS are as follows:
\- The MMTel AS should discover the data channel capability of the served UE
by a +sip.app-subtype media feature tag with a value of \"webrtc-datachannel\"
in the Contact header field of user-initiated REGISTER request contained in
the body of the third-party REGISTER request received from the S-CSCF.
The requirements on the UE are as follows:
\- The UE discovers the data channel capability of its home network by
detecting a Feature-Caps header field with a \"+g.3gpp.webrtc-datachannel\"
header field parameter in the 200 OK response from the S-CSCF during SIP
registration procedure.
## 6.5 Solution #5: Negotiation and report of IMS Data Channel capabilities
### 6.5.1 Description
#### 6.5.1.1 General
This solution aims to address how support of Data Channel capabilities can be
discovered by the network and UE in key issue #1: Enhancement to support Data
Channel usage in IMS network.
IMS Data Channel services are provided based on supporting of IMS Data Channel
related capabilities by DCMTSI UE and IMS network.
The IMS Data Channel capabilities of the DCMTSI UE and IMS network needs to be
discovered and negotiated, in order to determine whether IMS Data Channel is
allowed to be provided and what DC services can be provided:
\- Whether DCMTSI UE or IMS network supports IMS Data Channel related
capabilities determines whether IMS Data Channel Server needs to be involved
in IMS call session and whether IMS Data Channel is allowed to be established
during IMS call session;
\- If IMS Data Channel is allowed to be provided, the detailed capabilities
related to IMS Data Channel needs to be reported to IMS network, to determine
what DC application can be supported and downloaded to the DCMTSI UE or to
determine which functionalities within an application is enabled or disabled.
IMS data channel capabilities are the capabilities that are required by DC
applications for data processing, e.g. media processing, AI, location. These
capabilities are essential for IMS network to decide what application can be
provided and for the UE to use specific applications, e.g. if the UE has no AR
capability, AR assistance will not be able to use hence IMS network will not
download AR related applications or disable link to AR assistance service when
downloading a HTML index page to the UE, so that the user will not click the
AR assistance but failed to use it.
Editor\'s note: Whether the detailed capabilities is needed is for further
study and evaluation.
Data Channel services are provided by operators on top of MMTel services, so
the operators may need to control the services that can be provided to the UE,
in the same manner with supplementary services or value-added services. In
this assumption, providing IMS Data Channel services may need service
information of IMS data channel from the service profile within the IMS
subscription. Only UEs that subscribes IMS Data Channel is allowed to use IMS
Data Channel services. IMS Data Channel subscription may include whether and
what IMS Data Channel related capabilities are allowed in a registration
period. Based on operator\'s policy, Data Channel services may also be
provided only based on UE support of DC capability.
If the IMS network decides to provide IMS data channel to the UE, it needs to
indicate support of IMS data channel to the UE.
#### 6.5.1.2 IMS Data Channel capability discovery and negotiation
A DCMTSI UE includes its support of IMS Data Channel in Register request
message when initiating IMS registration procedure. A feature tag has been
defined in TS 26.114 [6] as the indication of supporting IMS Data Channel,
which can be reused and included.
When the S-CSCF receives a Register request indicating the UE support IMS Data
Channel, after successful authentication, it determines if the UE is allowed
to use IMS Data Channel within this registration period, based on whether the
UE and IMS network supports IMS Data Channel. The S-CSCF includes an
indication of whether the UE is allowed to use IMS Data Channel in the 200 OK
response for Registration request. If DC subscription is required, S-CSCF may
also consider the service profile received from HSS when determining whether
the UE is allowed to use IMS Data Channel.
If the UE is allowed to use IMS Data Channel services, the S-CSCF includes the
indication of the UE is allowed to use IMS Data Channel in third party
registration request to the AS.
#### 6.5.1.3 Option 1 of report of IMS Data Channel capabilities to Data
Channel Server: via IMS registration procedure
As described in 6.5.1.1, IMS Data Channel capabilities of DCMTSI UE are used
for Data Channel Server to determine what DC application can be supported and
downloaded to the DCMTSI UE or to determine which functionalities within an
application is enabled or disabled. One way to report the capabilities from
the DCMTSI UE to Data Channel Server is via IMS registration procedure.
A DCMTSI UE may include the capability list with its detailed capabilities
related to IMS Data Channel in Register request message if available. The
capabilities are defined in 6.5.1.5. If the UE is allowed to use IMS Data
Channel services, the S-CSCF includes the indication of the UE is allowed to
use IMS Data Channel and the capability list the UE sent in third party
registration request to the AS.
When the AS receives third party registration request including the indication
of the UE is allowed to use IMS Data Channel and IMS Data Channel capability
list information, it invokes service of Data Channel Server to forward the IMS
Data Channel capability list information to Data Channel Server through the
service based interface between AS and Data Channel Server.
In this solution, the SIP and IMS are only used to transport UE DC capability
list information to Data Channel Server. The IMS entities, including S-CSCF
and IMS AS do not recognize and store this information.
Editor\'s note: The service definition is FFS after the architecture is
finalized.
#### 6.5.1.4 Option 2 of report of IMS Data Channel capabilities to Data
Channel Server: when the UE requests Data Channel applications
Besides solution in clause 6.5.1.3, an alternative solution to report the
capabilities from the DCMTSI UE to Data Channel Server is via Data Channel
application request.
After the bootstrap data channel is established, the UE sends Data Channel
application request to Data Channel Server through the bootstrap data channel
to retrieve the \"data channel application\" as specified in [6]. If the UE
has its IMS Data Channel capability list, the UE includes the information in
the request message.
In this solution, the UE DC IMS Data Channel capability list is transported
via bootstrap data channel and is transparent to IMS network,
To ensure the interoperability between DCMTSI UE and Data Channel Server, the
detailed Data Channel capabilities of the UE may need to be defined within
3GPP specifications, as proposed in clause 6.5.1.6.
#### 6.5.1.5 Option 3 of report of IMS Data Channel capabilities to Data
Channel Server: when the UE establishment the bootstrap data channel
Besides solution in clause 6.5.1.3 and 6.5.1.4, an alternative solution to
report the capabilities from the DCMTSI UE to Data Channel Server is via
bootstrap data channel request.
When the UE sends the bootstrap data channel request to Data Channel Server,
if the UE has its IMS Data Channel capability list, the UE includes the
information in the request message. The IMS Data Channel capability list is
included in the SIP Invite/re-Invite message. And the opposite UE can also
send the IMS Data Channel capability list to the Data Channel Server if it
has.
If both UEs use the same Data Channel Server, and the Data Channel Server gets
IMS Data Channel capability list of each UEs, the Data Channel Server can
generate the Application list which is supported by both UEs, which can avoid
the failure of the application data channel procedure.
To ensure the interoperability between DCMTSI UE and Data Channel Server, the
detailed Data Channel capabilities of the UE may need to be defined within
3GPP specifications, as proposed in clause 6.5.1.6.
#### 6.5.1.6 IMS Data Channel capabilities
The capabilities related to IMS Data Channel may include:
\- video codec;
\- AI capability;
\- positioning capability;
\- AR communication capability.
Editor\'s note: Whether other capabilities are needed is FFS.
### 6.5.2 Procedures
The figure 6.5.2-1 depicts the procedures how the IMS network and DCMTSI UE
discovers and negotiates IMS Data Channel capability, and how the IMS Data
Channel capability information is reported to Data Channel Server.
Figure 6.5.2-1: Procedure of IMS Data Channel capability discovery,
negotiation and report
The procedure includes the following steps:
1\. The DCMTSI UE initiates IMS registration and includes its support of IMS
Data Channel. The UE optionally includes the capability list with all detailed
capabilities related to IMS Data Channel in Register request message if option
1 in clause 6.5.1.3 is used.
2\. P-CSCF forwards Register request message to S-CSCF.
3\. IMS registration procedure is as specified in current specifications.
4\. After successful authentication, if the operator requires the UE to
subscribe DC service, S-CSCF may get service information from the service
profile in HSS.
5\. S-CSCF determines if the UE is allowed to use IMS Data Channel within this
registration period, based on IMS Data Channel capabilities of the UE and IMS
network and optionally from the service profile retrieved from HSS.
6\. S-CSCF includes the indication of supporting IMS DC to P-CSCF in 200 OK
response.
7\. P-CSCF forwards 200 OK response to the UE. The UE stores and uses the
indication of supporting IMS DC.
8\. The S-CSCF initiates third party registration and includes the indication
of the UE is allowed to use IMS Data Channel in third party registration
request to the AS.
9\. If option 1 in clause 6.5.1.3 is used, the AS invokes service of Data
Channel Server to forward the indication of the UE is allowed to use IMS Data
Channel and the IMS Data Channel capabilities of the UE retrieved from
Register request to Data Channel Server through the service based interface
between AS and Data Channel Server.
If option 2 in clause 6.5.1.4 is used, this step is skipped.
10\. The bootstrap data channel is established.
If option 3 in clause 6.5.1.5 is used, the IMS Data Channel capability list is
included in the SIP Invite/re-Invite message which is used to request to
establish the bootstrap data channel. And if the Data Channel Server receives
the IMS Data Channel capability list from the opposite UE in the response
message, the Data Channel Server can generate the Application list which is
supported by both UEs. The application list is sent to both UEs after the
bootstrap data channel is established.
11\. If option 2 in clause 6.5.1.4 is used, when the UE sends Data Channel
application request to Data Channel Server through the bootstrap data channel
to retrieve data channel application, it may include its IMS Data Channel
capability list in the request message, which is transparent to IMS network.
### 6.5.3 Impacts on existing nodes and functionality
UE impacts:
\- The UE includes its support of IMS Data Channel in Register request;
\- stores and uses the indication of supporting IMS DC received in 200 OK
response.
\- The UE may include its IMS Data Channel capability list in Register request
(when option 1 in clause 6.5.1.3 is used) or in the request message to
retrieve data channel application (when option 2 in clause 6.5.1.4 is used) or
in the request message to establish the bootstrap data channel (when option 3
in clause 6.5.1.5 is used);
S-CSCF impacts:
\- determines if the UE is allowed to use IMS Data Channel and which
capabilities are allowed to use within this registration period, based on
service profile received from HSS and IMS Data Channel capabilities of the UE
and IMS network;
\- sends the indication of supporting IMS DC and allowed IMS DC capability
list in 200 OK response;
\- includes the indication of whether the UE is allowed to use IMS Data
Channel and the capability list the UE is allowed to use in third party
registration request.
IMS AS impacts:
\- invokes Data Channel Server service to forward the received information to
Data Channel Server through the service based interface between AS and Data
Channel Server (when option in clause 6.5.1.3 is used).
Data Channel Server impacts:
\- generates the application list base on both UE\'s IMS Data Channel
capability list (when option 3 in clause 6.5.1.5 is used).
HSS:
\- Holds the DC service profile and convey it to S-CSCF.
## 6.6 Solution #6: Enhancement to support Data Channel usage in IMS network
### 6.6.1 Description
This solution is proposed to address WT#5.1: Key Issue on enhancement to
support Data Channel usage in IMS networks.
1) The Data Channel Server functionalities should be separated as Data Channel
control function and Data Channel media function to facilitate the Data
Channel media utilization.
2) Data Channel control function can be defined as DCS (Data Channel
Server)/DCS-C(Data Channel Server-Control) by reusing existing definition in
TS 26.114, or DCSF(Data Channel Signalling Function) to distinguish with DCS.
Data Channel Media function is the new function which has not been defined in
TS 26.114, hence it can be defined as DCM (Data Channel Media)/DCS-M (Data
Channel Server-Media), or DCMF (Data Channel Media Function).
Editor\'s note: In this document DCSF and DCMF will be used at this time and
the naming can be considered as FFS.
3) HTTP/Restful should be applied on the interface between Data Channel
Control function(DCSF) and Data Channel Media function(DCMF).
4) The Data Channel Application Repository(DCAR) can be the data base
component inside DCSF.
The network architecture for data channel and major functionalities of IMS
data channel is illustrated in clause 6.6.2 and the procedure for data channel
set up is illustrated in clause 6.6.3.
### 6.6.2 Network Architecture and Functionalities of IMS Data Channel
{width="266.45in" height="3.3756944444444446in"}
Figure 6.6.2-1: IMS Data Channel Network Architecture
The IMS data channel network architecture provides the definition of IMS data
channel interfaces and network functions.
Data Channel Signalling Function(DCSF/DCS):
\- Implements data channel control logic through DC control API
\- Initiates the bootstrap and application data channel control procedures
\- Terminates the bootstrap and application data channel control procedures
\- Handles the Application confliction and priority decision among different
data channel applications
Data Channel Application Repository function:
\- Supports data channel applications storage which can be internally inside
Data Channel Signalling Function or dedicated element outside of Data Channel
Signalling Function.
Data Channel Media Function(DCMF):
\- Executes IMS data channel media(bootstrap or application data channel)
creation and closure
\- Connects with IMS network media functions(IMS-AGW) and 3rd party data
channel media functions as protocol or content gateway
IMS AS:
\- Interworks with Data Channel Signalling Function on Data Channel call event
routing and Data Channel control procedure
\- Interacts with Data Channel Media Function on data channel media control
Network interface:
\- IF1: the interface between Data Channel Signalling Function and Data
Channel Media Function for data channel media content transmission.
\- IF2: the interface between Data Channel Signalling Function and Operator
Application Server for Data Channel control and Application information
communication.
\- IF3: the interface between NRF and IMS AS for data channel media function
selection.
\- IF4: the interface between Data Channel Media Function and other data
channel related media resources
\- IF5: the interface between Data Channel Signalling Function and IMS AS for
data channel control information interaction.
\- IF6: the interface between IMS AS and the Data Channel Signalling Function
is used for data channel call event communication.
\- IF7: the interface between Data Channel Signalling Function and NEF for
data channel application and services logic controlling.
\- IF8: the interface between Data Channel Signalling Function and NEF data
channel media content transmission.
\- IF9/Mb: the interface between Data Channel Media Function and IMS-AGW for
data channel protocol or media content transmission
\- IF10: the interface between Data Channel Media Function and 3rd party media
function for data channel protocol or 3rd party media content transmission, or
integration with local data channel media
\- Sh/N71: the interface between Data Channel Signalling Function and HSS/UDM
for fetching Data Channel user subscription data;
### 6.6.3 Procedure
The Data Channel initiates and terminates procedures should cover the
bootstrap and application data channel procedures.
#### 6.6.3.1 UE Initiated Bootstrap Data Channel Establishment
Figure 6.6.3.1-1: UE Initiated Bootstrap Data Channel Establishment
Procedures for UE initiated bootstrap data Channel establishment is as
follows:
1\~3. UE#1 sends the SIP INVITE request with an initial SDP to AS, through
originating network P-CSCF and S-CSCF. The initial SDP contains the bootstrap
data channel establishment requirement which is indicated by stream ID(dcmap
value:0/100), stream Label, etc. In this example procedure, SDP contains both
offers for stream ID 0 and 100.
4\. After receiving the SIP INVITE request, AS validates the Data Channel
media description information and/or user subscription data to determine
whether the DC Call request should be sent to DCSF.
If the DC call request needs to be sent to DCSF, the AS selects a DCSF for
this session based on local configuration or discovers and selects a DCSF
instance via NRF. The solution of discovery and selection of DCSF defined in
solution #17 applies.
5\. AS sends the DC call request to the DCSF which is selected in Step. 4.
NOTE: The detailed interaction between AS and the DCSF is specified in
solution #20.
6\. After receiving the DC call request, the DCSF determines the policy about
how to process the bootstrap data channel establishment requirement based on
the related parameters in the DC call request and/or operator strategy.
DCSF sends data channel control request to AS with the policy of bootstrap
data channel establishment, and it mainly includes the indications as follows:
\- Terminates the bootstrap data channel establishment which takes the
originating network DCMF as target;
\- Forwards or initiates the bootstrap data channel establishment which takes
the terminating network DCMF or UE as target.
The DCSF also includes the media point information, i.e. IP address/port of
DCSF for routing of further application request and application between DCSF
and DCMF via interface IF1.
7\. The AS selects a DCMF based on local configuration or discovers and
selects a DCMF instance via NRF. The solution of discovery and selection of
DCMF defined in solution #17 applies. Then the AS instructsDCMF on Data
Channel establishment and data channel media resource reservation based on the
DC media information received from DCSF. The media resource for interface IF1
to DCSF is also reserved. And DCMF responds after successful media resource
reservation.
8\. AS sends an data channel control response to DCSF to indicate the media
resource reservation result.
9\~11. AS sends the INVITE which includes the updated SDP offer to originating
S-CSCF and then to remote network side/UE#2. The SDP offer for bootstrap data
channel to UE#2 may also be included.
12\. SDP negotiation proceeds at terminating network side.
13-18. UE#2 returns a 183 response with SDP answer to originating network
P-CSCF. The AS modifies SDP answer for bootstrap data channels to UE#1 in 183
response which may include local bootstrap data channel to UE#1 or remote
bootstrap data channel to UE#1. The AS modifies the media resources on
originating DCMF and reports to originating DCSF.
19\. The originating network P-CSCF executes QoS procedure for bootstrap data
channel media based on the SDP answer information from the 183 response.
20\. P-CSCF returns the 183 response to UE#1.
21\. The PRACK and UPDATE negotiation between originating and terminating
network.
22\~23. The bootstrap data channels have been established between originating
DCMF and UE#1/UE#2. The UEs send application request messages to DCMF via
bootstrap data channel with its data channel capabilities. The DCMF forwards
the message to received media point of DCSF. The DSCF downloads the proper
data channel applications to UE#1 and UE#2 based on their data channel
capabilities.
24\. Alternatively, the bootstrap data channels have been established between
terminating DCMF and UE#1/UE#2. The data channel application is requested and
downloaded to UE#1 and UE#2 from terminating DSCF.
25\. The subsequent procedures continue.
#### 6.6.3.2 UE Initiated Application Data Channel Establishment
Figure 6.6.3.2-1: UE Initiated Application Data Channel Establishment
Procedures for UE initiated application data Channel establishment with
originating network is as follows:
1\. The precondition of application data channel establishment is bootstrap
data channel has been established successfully.
2\~4. UE#1 sends the SIP re-INVITE request with an updated SDP to AS, through
originating network P-CSCF and S-CSCF. The updated SDP contains the
established bootstrap data channel information, as well as the application
data channel establishment requirement which is indicated by stream ID(dcmap
value:greater than or equal to 1000), stream Label, etc.
5\. After receiving the SIP re-INVITE request, AS validates the Data Channel
media description information from DCSF and/or user subscription data to
determine whether DC Call request should be sent to DCSF.
6\. AS sends the DC call request to the DCSF which is selected in Step. 5.
NOTE: The detailed interaction between AS and the DCSF is specified in
solution #20.
7\. After receiving the DC call event notification, the DCSF determines how to
process the application data channel establishment requirement based on the
related parameters in the DC call event notification and/or Operator policy.
DCSF sends data channel control request to AS with the indication on
application data channel establishment. It mainly includes the actions as
follows:
1) Terminates the application data channel establishment which takes the
originating network DCMF as target endpoint.
2) Forwards or initiates the application data channel establishment which
takes the terminating network DCMF or UE#2 as target endpoint.
NOTE: The procedure in figure 6.6.3.2.1 traffic case meets with condition 1).
8\. The AS selects a DCMF based on local configuration or discovers and
selects a DCMF instance via NRF. The solution of discovery and selection of
DCMF defined in solution #17 applies. Then AS instructs DCMF on Data Channel
establishment and data channel media resource reservation based on the DC
media information received from DCSF. And DCMF responds after successful media
resource reservation.
9\. AS sends a data channel control response to DCSF to indicate the media
resource reservation result.
10\~11. The MMTel AS A updates the SDP offer and sends an re-INVITE request to
the originating network S-CSCF, then this re-INVITE request is sent to
terminating network and UE#2.
12\. SDP negotiation proceeds at terminating network side.
13\~14. UE#2 returns a 200 OK for re-INVITE to AS.
15\~16. AS negotiates with DCSF and DCMF for the SDP modification.
17\~18. AS constructs and sends the updated SDP with negotiated application
data channel media to originating network S-CSCF and P-CSCF.
19\. The originating network P-CSCF executes QoS procedure for application
data channel media based on the SDP answer information from the 200 OK
response.
20\. P-CSCF returns the 200 OK response to UE#1.
21\. The application data channel has been established between UE#1 and
originating network DCMF; and UE#1 can get application content from DCMF
through this application data channel.
22\. The subsequent procedures continue.
### 6.6.4 Impacts on Existing Functions and Services
\- Extensions of IMS existing function to support inter-working with IMS Data
Channel functionalities:
\- I/S-CSCF: supports end user registration for data channel.
\- P-CSCF: supports for data channel media offer and answer negotiation.
\- IMS AS and NRF supports service based discovery and selection of DCSF and
DCMF.
\- IMS AS supports call event report to DCSF via service based IF3 interface.
\- IMS AS supports DC media management to DCMF via service based IF5
interface.
\- Extensions of IMS subscription to support IMS Data Channel services.
\- Extensions of IMS MMTEL Services for the enhancement of IMS Data Channel
capability.
## 6.7 Solution #7: Reference architecture to support Data Channel usage in
IMS
### 6.7.1 Description
In clause 6.2.10 of TS 26.114 [6], a Data Channel Workflow is defined
including Data Channel Server and Data Channel Application Repository.
However, this workflow does not define interfaces between the functions, nor
does it show or define interfaces between Data Channel Server and existing IMS
functions.
This solution defines architectural enhancements to IMS to support Data
Channel functionality by re-using the Data Channel Workflow as mentioned
above. The Data Channel functionality can be used to enable e.g. screen
sharing, file transfer and co-editing during and in the context of an IMS
call. The overall reference architecture to support Data Channel usage in IMS
is depicted in Figure 6.7.1-1.
Figure 6.7.1-1: Reference architecture to support Data Channel usage in IMS
Data Channel Server (DC Server or DCS) and Data Channel Application Repository
are defined in TS 26.114 [6] while all other functions in Figure 6.7.1-1 are
defined in TS 23.228 [5]. The DC Server is separated in a control and a media
function called Data Channel (DC) control and Data Channel (DC) media
functions, called DCS-C and DCS-M respectively.
NOTE: The DC control function can be standalone or collocated with other
functions like MMTel AS. The DC media function can be standalone (i.e. dealing
only with DC media) or collocated with other functions like MRF.
UE A and UE B contain a DCMTSI client, which is a data channel capable MTSI
client supporting data channel media, as defined in TS 26.114 [6]. The DCMTSI
client uses SIP/SDP to indicate support for \"webrtc-datachannel\" and to
establish a \"bootstrap\" data channel to the Data Channel Server. The
\"bootstrap\" data channel is used to send the application (JavaScript files)
from the Data Channel Server to the UE during an IMS call. The DC Server
fetches the application from the Data Channel Application Repository via the
DC2 interface which is out of scope of 3GPP. The DCMTSI client in the
originating UE uses SIP/SDP to establish data channel media either to the DC
media function or directly to the terminating UE via the IMS domain. This data
channel transports media content either via the DC media function or directly
between the two UEs.
After negotiation of the bootstrap data channel with the DCS-C, UE can setup
the bootstrap data channel connection with the DCS-M. Then UE can initiate a
HTTP GET request on the root (\"/\") URL through the bootstrap data channel.
The DCS-M sends the application list in the HTTP response to the UE.
The DC control function interacts with the IMS MMTel AS via DC1 interface. DC1
is used for Data Channel call control (establishing bootstrap and application
data channels to UE A and UE B) and call event notifications. Call event
triggers from MMTel AS to DC control function contain calling and called
identities, UE capabilities and SDP related information. Notification from DC
control function to MMTel AS via DC1 interface contains e.g. address/port
information of the DC media function where the UE sends and receives data
channel media, and optionally QoS data related to the media channel. DC1 is
based on a HTTP Restful API protocol and follows SBI principles.
After establishment of the DC application data channel the UE can send/receive
DC Data via the application data channel directly to/from another UE or via
the DCS-M. The DCS-M can use HTTP/S to provide DC Data (e.g., AR model data in
case of an AR application) to the UE.
The IMS MMTel AS discovers and selects the DC control function either
\- using SBI principles: DC control function registers at NRF with its
capabilities (e.g. support of Data Channel capability) and MMTel AS discovers
and selects DC control function via NRF; or
\- by static configuration: MMTel AS is configured with DC control function
FQDN or IP address.
The DC control function discovers and selects DC media function either
\- using SBI principles: DC media function registers at NRF with its
capabilities (e.g. support of Data Channel capability) and DC control function
discovers and selects DC media function via NRF; or
\- by static configuration: DC control function is configured with DC media
function FQDN or IP address.
Impacts to IMS interfaces Gm, Mw, ISC, Iq are determined during normative
phase.
### 6.7.2 Procedures
#### 6.7.2.1 UE Initiated Bootstrap Data Channel establishment
{width="6.398611111111111in" height="6.100694444444445in"}
Figure 6.7.2.1-1: UE Initiated Bootstrap Data Channel establishment
Procedure for UE initiated bootstrap data channel establishment is as follows:
1\. UE A sends the SIP INVITE request with an initial SDP to MMTel AS, through
originating IMS network. The initial SDP contains audio/video, and the
bootstrap data channel establishment requirements.
2\. After receiving the SIP INVITE request, MMTel AS validates the Data
Channel media description information and user subscription data to determine
whether to send the DC call event notification to DCS-C.
If the DC call event notification needs to be sent to DCS-C, the MMTel AS
selects a DCS-C for this session based on local configuration or service
discovery via NRF and selects a DCS-C instance. The DC call event notification
includes calling/called party identify, bootstrap data channel information,
and possibly other data.
3\~5. After receiving the DC call event notification, the DCS-C determines the
policy how to process the bootstrap data channel establishment requirement
based on the related parameters in the DC call event notification, service
subscription, and/or operator policies. DCS-C sends DC media resource
reservation request to DCS-M when bootstrap data channel is allowed. The DCS-M
allocates media resources for the bootstrap data channel and sends them to
DCS-C. DCS-C sends DC control request with reserved media resources to MMTel
AS.
6\. MMTel AS sends the INVITE which includes the modified SDP offer to
originating IMS network and then to the remote network. The SDP offer includes
bootstrap data channel establishment information from DCS-M.
7\. UE B returns a 183 response with SDP answer. The SDP answer includes
bootstrap data channel information from UE B.
8\. The terminating IMS network executes QoS procedure for bootstrap data
channel media based on the SDP answer information from the 183 Response.
9\~10. The terminating IMS network returns the 183 Response to the originating
IMS network and MMTel AS.
11\. After receiving the 183 Response, MMTel AS validates the Data Channel
media description information and sends DC call event notification (e.g.,
calling and called party information) with bootstrap data channel
establishment information to DCS-C.
12\~14. After receiving the DC call event notification, the DCS-C sends DC
media resource update and reservation request to DCS-M. Then DCS-M updates the
bootstrap data channel establishment information. The DCS-M allocates media
resources for the bootstrap data channel to UE A and sends them to DCS-C.
DCS-C sends DC control request with reserved media resources to MMTel AS.
15\. The MMTel AS sends 183 response which includes the modified SDP answer to
the originating IMS network and then to UE A. The SDP answer includes
bootstrap data channel establishment information from DCS-M. The originating
IMS network executes QoS procedure for bootstrap data channel media based on
the SDP answer information from the 183 Response.
16\. The PRACK and UPDATE negotiation between originating and terminating
network occurs.
17\~22. The UE A and UE B initiate bootstrap data channel establishment based
on SDP negotiation. The bootstrap data channel is established between
originating DCS-M and UE A and UE B. The UEs sends application request
messages to DCS-M via bootstrap data channel to retrieve the application list.
The DCS-M retrieves proper application list from Data Channel application
repository via DCS-C and includes them in response to UE A and UE B.
#### 6.7.2.2 Application Data Channel establishment between UEs (P2P)
{width="6.5680555555555555in" height="5.649305555555555in"}
Figure 6.7.2.2-1: Application Data Channel establishment between UEs (P2P)
Procedure for application data channel between UEs establishment is as
follows:
1\. UE A sends the SIP re-INVITE request with an initial SDP to MMTel AS,
through originating IMS network. The initial SDP contains audio/video, and the
application data channel establishment requirements.
2\. After receiving the SIP re-INVITE request, MMTel AS validates the Data
Channel media description information and user subscription data to determine
whether to send the DC call event notification to DCS-C.
If the DC call event notification needs to be sent to DCS-C, the MMTel AS
selects a DCS-C for this session based on local configuration or service
discovery via NRF and selects a DCS-C instance. The DC call event notification
includes calling/called party identity, application data channel information,
and possibly other data.
3\. After receiving the DC call event notification, the DCS-C determines the
policy how to process the application data channel establishment requirement
based on the related parameters in the DC call event notification, service
subscription, and/or operator policies. For the P2P application data channel,
DCS media resources are not required. DCS-C sends DC control request without
reserved media resources to MMTel AS.
4\. MMTel AS sends the INVITE which includes the original SDP offer to
originating IMS network and then to the remote network.
5\. UE B returns 200 OK response with SDP answer. The SDP answer includes
application data channel data from UE B.
6\~7. The terminating IMS network executes QoS procedure for application data
channel media based on the SDP answer information in the 200 OK response. The
terminating IMS network returns the 200 OK response to the originating IMS
network and MMTel AS.
8\. After receiving the 200 OK response, MMTel AS validates the Data Channel
media description information and sends DC call event notification with
application data channel establishment information to DCS-C.
9\~10. After receiving the DC call event notification, the DCS-C determines
this is for P2P application data channel establishment, which doesn\'t require
DCS media resources. DCS-C sends DC control request without reserved media
resource to MMTel AS.
11\. The MMTel AS sends 200 OK response which includes SDP answer to
originating IMS network and then to UE A. The SDP answer includes application
data channel establishment information from UE B. The originating IMS network
executes QoS procedure for application data channel media based on the SDP
answer information from the 200 OK response.
12\. The ACK for 200 OK procedure is send.
13\~14. The UE A and UE B initiate application data channel establishment
based on SDP negotiation. UE A and UE B exchange application data via the
application data channel.
#### 6.7.2.3 Application Data Channel establishment between UE and DCS (P2A)
{width="6.684027777777778in" height="3.1729166666666666in"}
Figure 6.7.2.3-1: Application Data Channel establishment between UE and DCS
(P2A)
Procedure for application data channel establishment between UE and DCS is as
follows:
1\. UE A sends the SIP re-INVITE request with an initial SDP to MMTel AS,
through originating IMS network. The initial SDP contains the application data
channel establishment requirements.
2\. After receiving the SIP re-INVITE request, MMTel AS validates the Data
Channel media description information and user subscription data to determine
whether to send the DC call event notification to DCS-C.
If the DC call event notification needs to be sent to DCS-C, the MMTel AS
selects a DCS-C for this session based on local configuration or service
discovery via NRF and selects a DCS-C instance. The DC call event notification
includes calling/called party identity, application data channel information,
and possibly other data.
3\~5. After receiving the DC call event notification, the DCS-C determines the
policy how to process the application data channel establishment requirement
based on the related parameters in the DC call event notification, service
subscription, and/or operator policies. For the P2A application data channel,
DCS media resources are required. DCS-C sends DC media resource reservation
request to DCS-M. The DCS-M allocates media resources for the application DC
and sends them to DCS-C. DCS-C sends DC control request with reserved media
resource to MMTel AS.
6\. MMTel AS sends the 200 OK response to the UPDATE message which includes
the SDP answer for the application data channel and DCS-M information (e.g.,
address).
7\~8. The UE A initiates application data channel establishment with DCS-M and
exchanges application data with an Application Server via the application data
channel.
### 6.7.3 Impacts on existing nodes and functionality
Following nodes are impacted by this solution.
HSS:
\- Impact to HSS (e.g. Data Channel specific subscription information) is FFS.
Data Channel control (DCS-C)function:
\- Interacts with the IMS MMTel AS via DC1 interface. DC1 is used for Data
Channel call control and call event notifications and is based on a HTTP
Restful API. The control function interacts with the DC media function via DC3
to reserve and maintain media resources.
\- DC control function discovers and selects DC media function either using
SBI principles (i.e. via NRF) or by static configuration (e.g. by using a
configured FQDN or IP address).
Data Channel media (DCS-M) function:
\- Maintains DC media resources and interacts with the DC control function via
DC3. DC3 can be based on HTTP/S.
Data Channel Application repository:
\- It stores data channel applications. This function is out of scope of 3GPP.
CSCF:
\- Impact to P-CSCF, I-CSCF, S-CSCF is FFS.
MMTel AS:
\- Needs to interact with the DC control function via DC1 interface to send
call event triggers and receive notifications that are translated into
SIP/SDP.
\- MMTel AS discovers and selects DC control function either using SBI
principles (i.e. via NRF) or by static configuration (e.g. by using a
configured FQDN or IP address).
IMS-AGW:
\- Needs to support transport of DC Data.
UE:
\- Support data channel usage in IMS.
## 6.8 Solution #8: AR Telephony Communication Based on Data Channel
### 6.8.1 Description
This solution resolves Key Issue #2 about supporting IMS based AR telephony
communication.
For some AR telephony communication, e.g. remote cooperation, the exchanged
data between two sides includes two types: one is the normal multimedia audio
or video which can be handled in a normal multimedia call; another is AR
specific data which is some additional information related to the multimedia
audio or video. For this kind of AR telephony communication, the data channel
could be used to transfer the AR specific data during the communication. UE
renders AR content based on these specific data.
The protocol stack for MTSI client which is involved in an AR telephony
communication is shown in Figure 6.8.1-1, as specified in TS 26.114 [6].
For AR telephony communication, the normal multimedia part is transported as
speech/video over RTP and the AR specific data is transported through data
channel over SCTP/DTLS.
{width="2.615972222222222in" height="1.5805555555555555in"}
Figure 6.8.1-1: User plane protocol stack for a basic MTSI client
### 6.8.2 Procedures
Depicted in Figure 6.8.2 -1 is the high-level procedures of AR telephony
communication service.
{width="6.689583333333333in" height="5.576388888888889in"}
Figure 6.8.2-1: High-level procedures of AR telephony communication service
When UE initiates an AR telephony communication with peer UE, the data
exchange for this communication request will include both normal multimedia
and AR specific data.
There are 3 phase procedures for supporting AR telephony communication service
based on data channel as shown in Figure 6.8.2-1 and they are:
\- Procedures of normal multimedia part of AR telephony communication;
\- Procedures of bootstrap DC establishment and application acquirement;
\- Procedures of application DC establishment and data exchange for AR
telephony communication.
For the procedures of normal multimedia part of AR telephony communication,
normal IMS calling procedure is proceeded and after that, audio/video
multimedia of AR telephony communication is transported over RTP.
For the procedures of bootstrap DC establishment and application acquirement,
bootstrap DC is established and application for AR specific data exchange is
acquired by two UEs. The application is associated with the normal multimedia
part in the previous procedures and the integration of them provides the AR
telephony communication service. The application produces and exchanges AR
specific data, such as digital content, to enhance the telephony
communication.
For the procedures of application DC establishment, UE sends Invite request
for Application DC to IMS AS through I/S-CSCF. IMS AS sends the Data Channel
event notification to DC Control Function. The interaction between IMS AS and
DC Control Function for the DC event notification is addressed by other
solutions for Key Issue #1. Then DC Control Function instructs DC Media
Function to create Application DC resource directly or through IMS AS. IMS AS
sends Invite request for Application DC to peer UE through peer I/S-CSCF and
peer IMS AS serving peer UE. The response of Invite request from peer UE is
transferred to UE through IMS AS, I/S-CSCF of both UE sides. Then application
data channel is established between UE and peer UE; and the AR specific data
in this AR telephony communication could be exchanged between them over the
data channel.
The procedures for multimedia part establishment and DC part establishment of
AR telephony communication could be proceeded simultaneously, i.e. the
invitation request from UE could include both multimedia part establishment
and DC part establishment requests.
### 6.8.3 Impacts on existing nodes and functionality
The solution has impacts on the following entities:
UE:
\- Support AR and data channel functionality and related procedures.
IMS network:
\- IMS-AS: Support interaction with DC Control Function and Media Function to
support DC usage.
\- New added data channel functionality: DC Control Function, DC Media
Function, and DC Application Repository.
## 6.9 Solution #9: Supporting AR communication
### 6.9.1 Description
According to the definition of TR 26.998 [14], different AR devices have
different media processing capabilities. IMS needs to support media
transmission and media rendering related to AR communication. This solution
defines how IMS can be enhanced to support AR communication.
#### 6.9.1.1 Assumption
This solution has the following assumptions:
\- Due to the flexibility (constant iteration, frequent upgrade required) and
diversity (various industries, different experiences) of AR applications,
built-in or pre-installed AR applications in AR devices will lead to software
version fragmentation and difficult integration of different terminals.
Therefore, this solution only considers the unified use of IMS data channel
downloading mode for AR applications.
\- For the security of national laws and regulations, 3D models used for AR
communication should be provided to the IMS when the AR application connects
to IMS and saved in the persistent database. IMS needs to be notified when the
3D model is changed by AR application.
#### 6.9.1.2 Definitions
The following definitions apply to this solution:
**3D Model** : 3D Model include 3D virtual object model and 3D virtual human
avatar model.
**AR metadata** : Data used for AR media rendering, including user pose
information and camera information and so on.
#### 6.9.1.3 Architecture
{width="5.799305555555556in" height="2.595833333333333in"}
Figure 6.9.1.3-1: Enhanced IMS architecture to support AR communication
NOTE 1: The DCMF could be an enhanced MRF that support DC, the DC related
architecture and interfaces will be defined in the solution to KI#1.
AR communication architecture is enhanced based on data channel architecture,
including the following network functions:
1\. Add a new network function AR Application Server, responsible for AR
service control related to AR communication, including AR session media
controlling, AR media rendering negotiation and AR service handling.
NOTE 2: AR Application Server can be deployed in operator\'s network or
belongs to third party.
2\. Add the AR media processing network function ARMF, responsible for AR
communication media transmission and media rendering function, including the
following functions:
\- **AR Rendering Logic:** controls the application-based rendering logic of
AR communication.
\- **AR Media Processing Function:** including Vision Engine, 3D Rendering
Engine. Vision Engine and 3D Rendering Engine will establish spatial map, and
render the scenes, virtual human models and 3D object models according to the
field of view, posture, position, etc. which are transmitted from UE using
data channel.
NOTE 3: ARMF is a logic network function element, it can be deployed together
with other media functions such as DCMF, it can also be collocated in other
functional entities, e.g. UMF (Unified Media Function). The details of UMF is
described in solution #15.
The following reference points are used for the IMS AR communication
architecture. It is suggested that SBI is applied to these reference points.
\- DC4: Service based reference point between the AR Application Server and
the DCSF for AR service handling and AR session media control.
\- DC5: Service based reference point between the MMTEL AS and the ARMF for AR
resource management.
NOTE 4: The DC4 interface will be defined in solution #20.
The following media interface are used for the IMS AR communication
architecture.
\- MDC2: Reference point of data channel media between the AR Application
Server and DCMF for AR media rendering negotiation.
\- MDC4: Reference point of AR media between the AR Application Server and
ARMF for AR media transmission.
\- Mb (RTP&DC): The media interface between UE and IMS-AGW, including RTP
channel used for audio/video media stream transmission and data channel used
for data media stream transmission.
\- Mb (RTP): The media interface between IMS-AGW and ARMF, using RTP channel
for audio/video media stream transmission.
\- Mb (HTTP): The media interface between DCMF and ARMF, used by DCMF to
transmit data in HTTP channel after transforming data media stream received in
data channel to HTTP format.
\- Mb (DC): the media interface between IMS-AGW and DCMF, using data channel
for data media stream transmission.
### 6.9.2 Procedures
According to AR communication scenarios defined by TR 26.998 [14] and TR
26.928 [15], media processing capabilities are different for different AR
devices (STAR, EDGAR, and WLAR). The AR communication call flows can be
summarized as follows:
1\. Terminal rendering process: When the media processing capability of AR
device meets the requirements of AR communication (such as AR mark and simple
AR effect) according to its status such as power status, signal status,
computing power status, internal storage status, etc, the AR device can
independently implement AR media rendering by itself. The either side of IMS
provides AR application to the calling and the called users at the same time.
The terminal performs local rendering based on the media obtained locally or
sent by the peer.
2\. Network rendering process: When the media processing capability of AR
device cannot meet AR communication requirements (such as complex scene or
virtual human rendering requirements) according to its status, the AR device
can decide to request IMS for AR media rendering. The either side of IMS
provides AR application to the calling and the called users at the same time,
IMS then performs AR media rendering based on AR media received from the
calling or the called users, finally IMS sends rendered AR media using normal
audio/video streams through RTP channel to the calling or called user.
#### 6.9.2.1 Terminal Rendering Process
{width="6.697222222222222in" height="2.595833333333333in"}
Figure 6.9.2.1-1: Terminal rendering process
Key steps:
1\. The UE-A initiates an AR communication session and establishes audio and
video session connections with the UE-B.
2\. The bootstrap and application data channel connections are established for
the UE-A and UE-B according to AR application requirements.
**Scenario 1** : The UE performs AR media rendering based on the AR media get
from local application.
3\. The UE-A gets AR media (such as 3D model) from AR application locally and
performs AR media rendering itself.
4\. The UE-A sends the rendered AR audio/video media to the peer through the
RTP channel.
**Scenario 2** : The UE performs AR media rendering based on the AR media get
from remote application.
5\. The UE-B sends AR media through application data channel to UE-A.
6\. The UE-A performs AR media rendering itself based on the AR media
received, and displays the rendered audio/video media on its screen.
#### 6.9.2.2 Network Rendering Process
{width="6.691666666666666in" height="6.353472222222222in"}
Figure 6.9.2.2-1: Network rendering process
**Key steps:**
1\. The UE-A initiates an AR communication session and establishes audio and
video session connections with the UE-B. Then the bootstrap data channels are
established for the UE-A and UE-B.
2\. The application data channels are established for the UE-A and the UE-B.
**AR Media Rendering Negotiation Procedure:**
3\. The UE-A decide to request network media rendering based on its status
such as power status, signal status, computing power status, internal storage
status, etc.
4\. The UE-A initiate the application data channel between UE-A and the DCMF,
and sends a Media Rendering Negotiation Request to IMS, finally the request is
transferred to AR AS.
NOTE: The media negotiation for split rendering between the UE and the network
will be specified by SA WG4.
5\. The AR AS decides whether to provide media rendering function based on the
request from UE in step 4 and its available resource.
6\. The AR AS will send request to DCSF to allocate media resource on ARMF.
7\. The DCSF will send a XR Service Resource Allocation Request using
Nmmtelas_XRServiceResource_Allocate to MMTel AS to confirm whether ARMF has
enough resource to finish AR media rendering, carrying XR computing power
value.
8\. The MMTEL AS sends a XR Media Resource allocation request using
Narmf_XRMediaResource_Allocate to ARMF, carrying the UE-A\'s application data
channel address information, the IMS-AGW(for UE-A) audio/video address
information, and the remote UE-B\'s address information.
9\. When the ARMF resource applied successfully, it returns a successful
response carrying the termination addresses information allocated on ARMF to
the MMTEL AS.
10-11. The MMTEL AS sends a successful response to the DCSF. The DCSF will
forward the message to AR AS.
12\. The AR AS stores the media point information of the ARMF.
13\. The AR AS sends a Media Rendering Negotiation Response to indicate the
media rendering negotiation is successful.
UE-A can request to change the network rendering content if the status changed
in the UE-A, such as low power, low computing power etc.
**AR Session Media re-Negotiation Procedure For Network Rendering:**
14\. If the XR resource are allocated successfully in step11, the MMTEL AS
sends a DC modification request using Ndcmf_MediaResourceManagement to the
DCMF, carrying ARMF address information, to connect DCMF and ARMF termination.
15\. The MMTEL AS sends a REINVITE message carrying ARMF address information,
to anchor UE-A\'s audio/video media stream to ARMF through IMS-AGW.
16\. The UE-A sends 200 response carrying UE-A\'s audio/video media address
information.
17\. The MMTEL AS sends a REINVITE message carrying ARMF address information,
to connect ARMF to UE-B.
18\. The terminating IMS side sends 200 for REINVITE.
**Networking Rendering Procedure:**
19\. The UE-A starts AR media rendering.
20-21. The UE-A sends AR media through application data channel to DCMF and
DCMF transfers the AR media to ARMF for AR media rendering.
22\. The ARMF performs AR media rendering.
23\. The UE-A performs part of the AR media rendering itself.
24-25. The UE-A sends the rendered audio/video media over RTP to ARMF through
IM-AGW. If UE-A does not perform the rendering, the UE-A sends the original
audio/video media over RTP to ARMF.
26-27. The ARMF combines the AR media rendered by ARMF and the rendered AR
media received from UE-A, and sends the complete audio/video media to UE-B. If
UE-A does not perform the rendering itself, step 25 can be omitted, and the
ARMF directly sends the rendered media to the UE-B.
28\. The ARMF sends the rendered video RTP media stream to the UE-A when it
needs to send video back to the UE-A through the video back channel.
29\. The UE-A hangs up, UE-A sends a BYE message to P-CSCF.
30\. AR AS sends a XR Service Resource release request to DCSF to release the
allocated resource.
31\. DCSF sends the XR Service Resource release request using
Nmmtelas_XRServiceResource_Release to MMTEL AS.
32\. MMTEL AS sends the XR Media Resource release request using
Narmf_XRMediaResource_Release to ARMF.
### 6.9.3 Impacts on existing nodes and functionality
MMTel AS:
\- Support data channel resource modification, to connect DCS-M to a new
network node.
\- Support ARMF resource management, and connect ARMF to IMS-AGW and DCMF.
DCMF:
\- Support transforming AR media in data channel to HTTP and send to a new
network node.
AR AS:
\- Support AR media rendering negotiation between UE and IMS.
\- Support AR application service handling.
ARMF:
\- Support AR media rendering function for AR communication based on the
received AR metadata and audio/video media stream.
UE:
\- Support data channel capability.
\- Decides whether to use the network rendering method and change the split
ratio of the rendering tasks based on its status.
## 6.10 Solution #10: Support of Third Party specific User Identities in IMS
re-using the Ms reference point and STIR/SHAKEN
### 6.10.1 Description
The Ms reference point as described in TS 24.229 [8] is used to request
signing of an Identity header field or request verification of a signed
assertion in an Identity header field. This enables calling number
verification using signature verification and attestation information based on
the STIR/SHAKEN framework.
This solution proposes to use the existing Ms reference point and procedures
as described in TS 24.229 [8] for signing and verifying other identities than
for example the ones in the P-Asserted-Identity header field which are mainly
in the format of a SIP URI or Tel URL. For verification of the calling line
identity the IBCF or an AS of the originating network sends a HTTP signing
request to the signing AS which in turn replies with a Personal Assertion
Token (PASSporT). At the terminating network side, the IBCF or an AS sends a
HTTP verification request to the signing AS including the PASSporT which in
turn replies with a verification success or failure message. Figure 6.10.1-1
shows the use of the Ms reference point for signing and verification of
identities in SIP header fields using an AS (STI-AS) for signing at the
originating side and an AS (STI-VS) for verification at the terminating side.
{width="4.017361111111111in" height="2.435416666666667in"}
Figure 6.10.1-1: Ms reference point operation (see TS 24.229 [8], Annex V.2)
According to draft-ietf-sipcore-callinfo-rcd-04 [28] and draft-ietf-stir-
passport-rcd-18 [16] securing the display name of a callers was outside the
scope of Secure Telephone Identity Revisited (STIR) while [16] documents an
optional mechanism for PASSporT and the associated STIR procedures allowing to
sign and verify additional data elements (see also [28] for more detailed
description) including for example:
\- the name of the calling person or of an entity;
\- the traditional caller ID along with related display information that would
be rendered to the called party during alerting;
\- hyperlinks to images, such as logos or pictures of faces, or to similar
external profile information;
\- information related to the location of the caller;
\- information related to an organization the caller is associated with, or
categories/departments of organizations and institutions;
\- possibly other Rich Call Data (RCD) information elements.
The types of Third Party User Identities as used in IMS should be aligned with
the definitions in [28] and include the calling person\'s name and job title,
information related to the organization the caller is associated with and
information related to the caller\'s location. The concrete list of Third
Party User Identities is determined during normative phase in alignment with
stage 3.
The overall reference architecture is depicted in Figure 6.10.1-2. The Third
Party (Enterprise) network can be connected to the serving IMS network via UNI
or NNI interfaces. The serving IMS network handles outbound SIP calls from the
Third Party network.
{width="5.788888888888889in" height="1.9034722222222222in"}
Figure 6.10.1-2: Third Party network connected to the serving IMS network
There are several options how and where the Third Party User Identities are
signed and verified, listed below as Option 1, Option 2a and Option 2b. These
options allow for different deployment scenarios, e.g. using UNI or NNI
interface (e.g. IP-PBX cases) between Third Party and IMS network, with
different levels of impact to the Third Party network and the IMS network
provider and with different levels of trust relationship between both.
**Option 1:** The Third Party (an Enterprise) invokes the signing itself. For
that purpose, the Third Party may use the SHAKEN framework and protocols
defined by STIR. This requires a STI certificate assigned to the Third Party
to cryptographically assert authority over telephone numbers. The scope of a
STI certificate can be expressed by the certificate\'s TNAuthList identifying
a set or subset of Telephone Numbers (TNs) assigned to the certificate holder
as described in RFC 8226 [22]. This allows the terminating network to compare
the calling number attested by the SIP request with the TNAuthList of the
certificate to determine whether the caller is authorized to use the calling
number. In addition, with the use of the delegate certificate mechanism as
described in draft-ietf-stir-cert-delegation-04 [23] and in ATIS-1000092 [24]
it is possible to extend the SHAKEN credential system to enable also non-
SHAKEN entities such as a Third Party IP-PBX to create and sign a PASSporT to
demonstrate its association with the calling TN when initiating outbound calls
to a telephone service provider, e.g. an IMS service provider. The certificate
management procedures are further described in ATIS-1000092 [24]. This allows
the serving IMS network (IBCF or AS) for an incoming SIP request based on
local policies to verify the provided PASSporT, compare the calling number
attested by the SIP request with the TNAuthList of the certificate and, if
accepted, forward the SIP request with the signature towards the terminating
network which in turn can invoke the verification. With this approach the
serving IMS network is not required to configure and store the list of numbers
that the Third Party is authorized to use.
**Option 2:** The serving IMS network (IBCF in the trunking case, S-CSCF or AS
otherwise) invokes the signing on behalf of the Third Party. In this case the
signing AS in Figure 6.10.1-1 is invoked by the IMS network based on local
policy (e.g. signing is only invoked if the call leaves the IMS network and
Third Party specific user identity information is present in a SIP header).
The verification of the signature is invoked in the terminating IMS network.
The Third Party specific user identities that are subject for signing in the
serving IMS network can be either provided:
a) by the Third Party in the SIP signalling during session setup; the
legitimacy of the calling telephone number or other provided information can
be part of the service level agreement between IMS service provider and Third
Party or the IMS service provider can obtain TN or other data (e.g. name card)
assignment information from the Third Party by means outside the scope of
3GPP; or
b) by the HSS in the serving IMS network based on trusted information from the
Third Party. In this case the HSS may need to store additional data (in
addition to telephone numbers or SIP URIs) in the subscription of a Third
Party subscriber like a caller name or organization information. These data
are fetched from the HSS by the S-CSCF or AS depending which entity invokes
the signing. If these additional data are not user specific (e.g. just a
company name), also other entities like the IBCF or an AS may be configured
with this Third Party specific user identity information.
The SIP header extensions required to transfer Third Party specific user
identity information are defined by stage 3.
### 6.10.2 Procedures
The procedures to sign and verify PASSporT tokens follow the descriptions in
TS 24.229 [8] and ATIS-1000074 [17] with the main difference that besides
telephone numbers also other information as described in draft-ietf-sipcore-
callinfo-rcd-04 [28] and draft-ietf-stir-passport-rcd-18 [16] can be used for
signing and verification. Use of delegate certificates is based on draft-ietf-
stir-cert-delegation-04 [23] and ATIS-1000092 [24].
### 6.10.3 Impacts on existing nodes and functionality
Following nodes are impacted by this solution.
HSS:
\- For Option 2b in clause 6.10.1 the HSS stores additional trusted
information from the Third Party like caller name, job title, organization the
caller is associated with and information related to the caller\'s location.
IBCF, S-CSCF and AS:
\- Need to be able to invoke signing and verification of new information
elements in the SIP header based on local policies and an existing trust
relationship with the Third Party.
\- IBCF, AS: May be configured with Third Party specific user identity
information that is not user specific.
\- S-CSCF, AS: May fetch data from HSS for signing.
Signing AS (STI-AS):
\- Need to be able to sign new information elements from the SIP header.
Verification AS (STI-VS)
\- Need to be able to verify new information elements from the SIP header.
CSCF:
\- Potentially support of new SIP headers. Transparently forwards the
signature from the Third Party towards the terminating network.
## 6.11 Solution #11: Verification of calling party when using third party
specific identity
### 6.11.1 Description
This paper proposes solution for verifying the calling party when using third
party specific identity at the originating side and validating at the
terminating side to ensure to the called party that the call is received from
the intended user.
The following are the main principles of the solution:
\- Third Party will create group data in HSS which will have list of IMPUs, s,
Signing server address and the need for verification per IMPU. These IMPUs are
assigned by third party to its users which will be used by them to make calls.
\- These IMPUs can be put into one IRS and get implicitly registered or
independently registered.
\- When the user initiates one session using one of the assigned IMPU then at
the originating side, S-CSCF derives the IMPU from PAI/from header and if the
same IMPU is present in group data then it invokes the Signing server.
\- Signing server will sign it and provides the Identity header.
\- At the terminating side S-CSCF will invoke the verification server based on
the presence of Identity header.
\- Verification server will validate the header and provide the validity
status.
If both the calling party and called party belongs to same group data (calls
between users of same third party) then based on operator policy invoking of
signing server at the originating side will be skipped.
### 6.11.2 Procedures
{width="7.153472222222222in" height="6.340277777777778in"}
Figure 6.11.2-1: Network controlling network slice when UE does not have PDU
session
The detailed procedure is described in Figure 6.11.2-1.
1\. HSS will expose services for third party to create group data. Third party
will provision the list of IMPUs which will be used by its users along with
signing server address to this group data.
2\. UE1 will be implicitly registered or independently registered as in clause
5.2.1a of TS 23.228 [5].
3\. UE1 initiate a IMS session by sending INVITE.
4\. S-CSCF at originating side will derive the IMPU from PAI/From header and
if present in group data then invoke the signing server and forwards the
INVITE request.
5\. Signing server will sign the request using certificates and add the
Identity header and sends back the INVITE to S-CSCF
6\. S-CSCF will forward the INVITE request to the terminating side.
7\. S-CSCF at terminating side will invoke the verification server based on
the presence of Identity header and forwards the INVITE request.
8\. Verification server will verify the Identity header using certificates and
provides the validity status along with the INVITE to S-CSCF.
9\. S-CSCF at terminating side sends the INVITE towards UE2 based on the
successful validation result. S-CSCF may reject the call for the unsuccessful
result received from verification server.
10\. Successful call happens between UE1 & UE2.
Editor\'s note: Security aspect related to signing server if hosted by third
party will be handled by SA WG3.
### 6.11.3 Impacts on existing nodes and functionality
This solution may have the following impacts to existing entities and
interfaces:
HSS:
\- HSS will expose services for third party to create group data.
S-CSCF:
\- S-CSCF at originating side will invoke signing server if the received IMPU
from PAI/From header is present in the group data.
\- S-CSCF at terminating side will invoke verification server based on the
present of Identity header. Also based on the successful result from
verification server it will forward the invite to called party and may reject
the call for unsuccessful result.
## 6.12 Solution #12: Solution of SHAKEN based third-party specific user
identities
### 6.12.1 Description
#### 6.12.1.1 Introduction
SHAKEN (Signature-based Handling of Asserted Information Using toKENs) is
defined as a framework that utilizes protocols defined in the IETF STIR
Working Group that work together in an end-to-end architecture for the
authentication and assertion of a Caller ID by an originating service provider
and the verification of this identity by a terminating service provider.
STIR/SHAKEN framework has been adopted in 3GPP and related procedures are
defined in TS 24.229 [8].
This solution introduced an enhancement to existing STIR/SHAKEN framework and
procedures to support the usage of third-party specific user identities. It is
assumed that the SIP UA has been authorized by third party Authorization
Server with designated IMPU or an application layer token.
#### 6.12.1.2 Enhancement to SHAKEN framework
Figure 6.12.1.2-1 depicts the reference architecture of enhanced SHAKEN
framework.
This is a logical view of the architecture and does not mandate any particular
deployment and/or implementation. Secure Telephone Identity Authentication
Service (STI-AS) together with Secure Key Store (SKS) performs as Signing
Server, which creates PASSporT signatures. Secure Telephone Identity
Verification Service (STI-VS) performs as Verification Server, which verifies
the signature in the Identity header field.
Figure 6.12.1.2-1: Enhancement of SHAKEN framework to support third-party
specific user identities
Third party Authorization Server interacts with IMS network via NEF to
authorize the usage of third-party specific user identity by the originating
SIP UA. If the third party specific user identity is authorized, the third
party Authorization Server may issue an enterprise name card of the
originating SIP UA to IMS network, which can be presented to the terminating
SIP UA upon successful verification.
The key information included in the enterprise name card may derived from the
\"display-name\" in the From header and further \"rich call data\" (RCD) about
the caller in Call-Info header as specified in draft-ietf-sipcore-callinfo-
rcd-03 [28].
After inserting the Call-Info header field, the originating IMS or third party
AS should sign the caller information via STIR mechanisms RFC8224 [18] and
through the draft-ietf-stir-passport-rcd-15 [16], which extends PASSporT to
provide cryptographic protection for the \"display-name\" field of SIP
requests as well as further \"rich call data\" (RCD) about the caller. The
terminating IMS can verify the signature and forward the \"display-name\" and
RCD to the callee UE for rendering.
When the IMS call is originated from IP PBX, third-party specific user ID
including the enterprise name card is generated by IP PBX in the SIP INVITE
message in a P-Asserted-Identity and Call-info header fields. The S-CSCF or
IBCF then initiates a trigger to the Signing Server for the SIP INVITE.
### 6.12.2 Procedures
Figure 6.12.2-1: Procedure of third party specific user identity authorization
and verification
Following preconditions are fulfilled before a SIP UA with third party
specific user identity initiating a call flow.
\- For the originating UE, subscription data for the usage of third party
specific user identity and signing of third party specific user ID for secure
delivery may be configured in the HSS.
\- For the terminating UE, subscription data for the verification of third
party specific user identity may be configured in the HSS.
\- Third party Authorization Server is authorized by the serving IMS network
to provide third party specific user identity for specific group of SIP UAs. A
security association between third party Authorization Server and NEF has been
established.
\- The originating SIP UA is authorized by third party Authorization Server to
use designated third party specific user identity in following two methods:
\- Option A: The third party leverages the subscriber management capability
exposed by HSS via NEF to allocate an designated Public User Identity and
associated Service Profile for the SIP UA.
\- Option B: The third party assigned a token to the SIP UA for the
authorization of third party specific ID via application layer. How the third
party Authorization Server distributes the token to the SIP UAs is out of the
scope of this study report.
The enhancement to SHAKEN reference call flow specified in clause 4.3 of
ATIS-1000074 [17] are as following:
1\. The originating SIP UA creates a SIP INVITE with:
\- the Public User Identity allocated by third party (for option A); or
\- an Authorization Header which contains the third party specific user
identity, realm of the third party Authorization Server and the token assigned
by the third party Authorization Server (for option B).
NOTE 1: SIP UA may interactive with third party Authorization Server via
application layer to get the third party specific user identity and token,
which is out of scope of this study.
2\. The S-CSCF resolves the address of the third party Authorization Server
based on the Public User Identity (option A) or realm information in the
authorization request (option B). The authorization request is forwarded to
the NEF. The NEF discovers the selects the third party Authorization Server
for the authorization of using third party specific user identity.
NOTE 2: If a secure connection between the S-CSCF and third party
Authorization Server is available, the exchange of authorization information
may not involve NEF. This communication method is similar like the secondary
authorization/authentication procedures as described in clause 4.3.2.3 of TS
23.502 [3].
3\. The third party Authorization Server authorizes the request and creates an
enterprise name card for the SIP UA, which is going to be delivered in the SIP
header. If the authorization request is rejected, the IMS call can continue
without presentation of third party specific user identity.
NOTE 3: The key information of enterprise name card and integrity protection
mechanism are specified in draft-ietf-stir-passport-rcd-15 [16].
4-5. The Signing Server signs the SIP INVITE and adds Identity header field(s)
per IETF RFC 8224 [18] using the third party specific user ID in the
P-Asserted-Identity header field and enterprise name card information.
6\. SIP INVITE with signature is sent to the terminating IMS networks.
7-8. Upon receiving the SIP INVITE with third party specific user identity,
the terminating IMS triggers the verification procedure with the Verification
Server.
9\. The third party specific user identity and enterprise name card is
received and rendered in the terminating SIP UA.
### 6.12.3 Impacts on Existing Nodes and Functionality
NEF is enhanced to support following functionalities:
\- Authorization of third party Authorization Server and establishment of
secure association with Authorization Server.
\- Supporting interaction between IMS network and third party Authorization
Server for authentication and authorization of SIP UAs for using third party
specific user identities. The existing NEF Services Nnef_Authentication
specified in TS 23.256 [21] can be reused and extended for the authorization
of third party user ID with third party Authorization Server.
\- Supporting exposure of subscription data management capability from HSS to
allocate designated Public User Identities for authorized SIP UAs.
UE is enhanced to support:
\- Initiating IMS call with third party allocated IMPU (for option A).
\- Delivery of third party specific identity, realm and token in the SIP INVTE
(for option B).
\- Rendering caller information (e.g., enterprise name card) in terminating
UE.
S-CSCF is enhanced to support following functionalities:
\- Upon receiving IMS calls from designed IMPUs, resolving the address of
third party Authorization Server and trigger the Authorization Request via NEF
(for option A).
\- Receiving the SIP INVITE with Authorization Header for the third-party user
ID request, and generating authorization request to the NEF (for option B).
\- Triggering the signing of third-party specific user ID with the Signing
Server for originating call.
\- Triggering the Verification Server for the verification of the signature in
the Identity Header field for terminating call.
\- Interworking with third party Authorization server directly or via NEF for
authorization request of third-party user ID.
IP PBX is enhanced to support inserting enterprise name card in the
P-Asserted-Identity header field of SIP INVITE.
## 6.13 Solution #13: third party specific user identities
### 6.13.1 Description
This solution proposes an architecture using the third party ID and credential
to access IMS network.
This solution proposes to solve the data coupling issue between third party
subscribers and network operators using procedures similar to OAuth 2.0
framework. The OAuth 2.0 is described in IETF RFC 6749 [19].
This solution covers two ways of enterprises accessing IMS network: SIP trunk
and single registration.
#### 6.13.1.1 Assumptions
This solution has following assumptions:
\- The third party (e.g. enterprises) subscribes with the network operator,
and the third party subscribers (e.g. employees) use third party ID
(enterprise employee ID) to access operators\' network.
\- The third party authentication server belongs to the third party IT domain.
The third party subscribers (e.g. employees) need to be authenticated and
authorized by third party (e.g. their enterprise) before accessing operator
network. Network operators\' IMS needs to connect to the third party
authentication server.
\- This solution assumes the SIP client of single registration is a SIP
calling App installed on UE, or a wired SIP phone configured by the third
party (enterprise) or the third party subscriber.
\- The third party ID and credential (e.g. token) will be generated by the
third party.
#### 6.13.1.2 Definitions
**third party** : An enterprise. The third party is authorized to access IMS
network after subscribing with the operator. Under the OAuth 2.0 framework,
the third party is the resource owner.
**third party auth. server** : an authentication server used by the third
party to authenticate and authorize the third party subscriber, allocate
tokens to the authenticated third party subscriber and accept Token
verification request from other servers. Under the OAuth 2.0 framework, the
third party auth. server is the authorization server.
**third party subscriber** : a user of third party, e.g. an employee. The
authentication and authorization will jointly be performed by IMS and third
party auth. server. Under the OAuth 2.0 framework, the third party subscriber
is the client.
**third party ID (3PID)** : the identity of third party subscriber accessing
to IMS network. Used for authentication and authorization, combined with
credential.
**enterprise Data Server (EDS)** : a network element in IMS that connects to
third party auth. server. EDS performs authentication and authorization of
third party subscriber with third party auth. server. Under the OAuth 2.0
framework, EDS and IMS is the resource server.
NOTE 1: The subscription data generated by EDS follows the same format of
subscription in HSS. The third party user specific data (e.g. position, call
purpose, current location) does not need to be standardized. However, the
interface for fetching the data is standardised.
NOTE 2: Appropriate terminology regarding Credential Provider can be decided
in normative phase.
#### 6.13.1.3 Architecture
Figure 6.13.1.3-1 depicts the architecture for the third party ID access
solution. The third party subscribers use the third party ID and credential to
access IMS network. IMS network and the third party auth. server jointly
perform authentication and authorization, which achieves calls, user identity
information retrievals, name card securely transmissions and demonstrations.
{width="6.226388888888889in" height="5.022222222222222in"}
Figure 6.13.1.3-1: Architecture for third party id Access solution
NOTE 1: Security related aspects should be studied by SA WG3.
Considering the network position of the Enterprise Data Server, the EDS needs
to frequently communicate with external servers and perform joint
authentication. Therefore, the EDS cannot be combined with other functions
that are at the core of the network. Enterprise Data Server in Carrier IMS
Domain has following service logic:
\- Accept provision instruction and store third party subscription data (e.g.
enterprise name, enterprise domain name, call out E.164 number list for its
employee) in its database.
\- Interwork with third party Auth. Server with Mutual TLS authentication and
authenticate third party.
\- Jointly authenticate and authorize third party subscriber with the third
party Auth. Server and EDS stores/caches the third party subscriber data (e.g.
enterprise identity information and authorized call out E.164 number) from the
third party Auth. Server.
\- Interwork with I/S-CSCF and provide function for third party authenticate
procedures, third party subscribers authenticate procedures, location
management procedures, user data handling procedures, IMS Restoration
procedures, the first two are new procedures defined for the solution, other
procedures are same with procedures defined in Cx / N70.
\- Interwork with MMTel AS and provide function for third party ID
presentation procedures, Data handling procedures, Subscription/notification
procedures, the first is new procedure defined for the solution, other
procedures are same with procedures defined in Sh / N71.
\- Interwork with IBCF and provide function for query provisioned information
procedures, this procedure is new defined procedure for this solution.
The following reference points are defined for the third party id access
architecture. It is suggested that SBI is applied to these reference points,
and use HTTP/2 protocol.
\- IF1: Reference point between the EDS and the I/S-CSCF.
\- IF2: Reference point between the EDS and the MMTel AS.
\- IF3: Reference point between the EDS and the IBCF.
\- IF4: Reference point between the EDS and the third party Auth. Server.
NOTE 2: IF4 is out of scope of 3GPP.
#### 6.13.1.4 Subscription model and data processing principle
Traditionally, the subscription is associated to a single user. To satisfy the
data decoupling requirement of enterprise, IMS needs to support the
subscription of an enterprise, instead of its each employee. Under this
subscription, the third party subscriber (e.g. an employee) could use the IMS
resource to initiate a call after authenticated by the third party auth.
server and IMS, and the third party is charged for the call. Key data of the
subscription includes third party domain name, the CA for the third party
certificate, third party name, and E.164 number segment or list allocated to
the given third party for call routing etc. The network operator could decide
which data is needed based on their own design.
### 6.13.2 Procedures
Editor\'s note: The detail registration, originating and terminating call flow
is FFS.
#### 6.13.2.1 third party ID Access via SIP Trunk
{width="6.583333333333333in" height="7.509027777777778in"}
Figure 6.13.2.1-1: Third party ID Access via SIP Trunk
1\. The BSS provisions the third party subscription data to the EDS according
to the description in 6.x.1.4.
2\. The third party PBX establishes TLS connection with the IBCF. The PBX
needs to store the IBCF domain name and the CA of the IBCF certificate for the
TLS handshake.
3\. The IBCF sends domain name and provisioned info to the EDS to verify if
the third party PBX is a trusted one.
4\. After verifying provisioned info, EDS sends response indicating the
request has succeeded.
5\. The TLS connection is established.
6\. The third party subscriber sends a SIP INVITE through TLS connection,
containing the third party ID and token. The third party subscriber gets the
token when login into the third party auth. server.
7\. The IBCF forwards the SIP request to the S-CSCF.
8\. The S-CSCF finds the corresponding EDS based on the domain info in the
third party ID, and send the third party ID and the token to the EDS for
authentication.
9\. The EDS forwards the third party ID and the token to the corresponding
third party auth. server for authentication. The TLS link between EDS and
third party Auth. Server is established in previous stage with mutual TLS
authentication.
10\. The third party auth. server verifies whether the Token is a valid one.
If so, the third party auth. server sends success response with the relevant
third party subscriber data (e.g. E.164 number, name, department etc.)
corresponding to the provisioned third party ID to the EDS. The EDS caches the
data.
11\. The EDS informs the S-CSCF the authentication is succeeded. The S-CSCF
downloads temporarily generated user data from the EDS.
NOTE 1: Security related aspects should be studied by SA WG3.
12\. The S-CSCF forwards the messages to the AS.
13.The MMTel AS requests user data from the EDS.
NOTE 2: The subscription data generated by EDS follows the same format of
subscription in HSS. The third party user specific data (e.g. position, call
purpose, current location) does not need to be standardized, and will be
transparently transmitted from EDS to MMTel AS to MRF.
14\. The EDS responses, returning data of the third party subscriber.
15\. The MMTel AS requests the MRF to process name card media.
16\. The MMTel AS responses, and perform asynchronous processing.
17\. The MMTel changes the value of From and P-Asserted-Identity headers to
E.164 number that allocated to the given third party, then forwards the INVITE
to the S-CSCF.
18\. The S-CSCF forwards the messages to the terminating IMS network.
19\. The MRF shows the rich name card (e.g. through the CRS service defined in
TS 24.183 [20]) during ringing. The detailed procedure is specified in
6.13.2.5.
NOTE 3: The media negotiation process of CRS aligns with A.2.2 procedure in TS
24.183 [20].
NOTE 4: The structure of the name card is customized by third party.
20\. The called party responds 18x and 200 to the S-CSCF.
21\. The S-CSCF forwards 18x and 200 messages to the calling UE.
22\. The MRF stops playing rich name card in media plane, and redirects the
call to calling party.
23\. Call established.
24\. Call ended.
25\. Billing and record for later audit use.
#### 6.13.2.2 third party ID Access via Single SIP Registration
{width="6.600694444444445in" height="8.044444444444444in"}
Figure 6.13.2.2-1: Third party ID Access via Single SIP Registration
Editor\'s note: The Editor\'s note in clause 6.13.2.1 are also applicable
here.
1\. The BSS sends third party provision to EDS according to the description in
6.13.1.4.
2\. The third party subscriber sends authentication requests to third party
auth. server.
3\. The third party auth. server returns Token after authenticating the third
party subscriber.
4\. The third party subscriber sends SIP REGISTER to the P-CSCF with a third
party ID and Token.
5\. The P-CSCF forwards the message to the S-CSCF.
6\. The S-CSCF finds the corresponding EDS based on the domain info in third
party ID, and send third party ID and Token to the EDS for authentication.
7\. The EDS forwards third party ID and Token to corresponding third party
auth. server for authentication. The TLS link between EDS and third party
Auth. Server is established in previous stage with mutual TLS authentication.
8\. The third party auth. server verifies whether the token is a valid one. If
so, third party auth. server sends success responses and relevant third party
subscriber data corresponding to provisioned third party ID to the EDS. The
EDS caches the data.
9\. The EDS informs S-CSCF the authentication is succeeded. The S-CSCF
downloads temporarily generated user data from the EDS.
10\. The S-CSCF sends 200 response.
11\. The P-CSCF forwards 200 response.
12\. The S-CSCF sends registration request to the MMTel AS. The MMTel AS
downloads temporarily generated user data from the EDS.
13\. The third party subscriber sends a SIP INVITE.
14\. The P-CSCF forwards the message to the S-CSCF.
15\. The S-CSCF forwards the messages to the AS.
16-26. These steps are same as steps 15-25 described in clause 6.13.2.1.
NOTE: Security related aspects (e.g. Steps 2-11) should be studied by SA WG3.
#### 6.13.2.3 SIP Trunk third party User as the called party
{width="6.683333333333334in" height="4.757638888888889in"}
Figure 6.13.2.3-1: SIP Trunk third party User as the called party
Editor\'s note: The Editor\'s note in clause 6.13.2.1 are also applicable
here.
1\. The S-CSCF receives INVITE request from originating side, which the E.164
number is assigned to a third party.
2\. The S-CSCF finds the corresponding EDS based on the domain information in
the Request URI, and gets the number relative data from the EDS.
3\. The EDS returns user data information, including third party PBX\'s IBCF
domain name and third party domain name.
4\. The S-CSCF forwards the message to the MMTel AS.
5\. The MMTel AS requires the relevant service data from the EDS.
6\. The EDS returns the data.
7\. The MMTel AS forwards the message to the S-CSCF after MMTel service
handling.
8\. The S-CSCF changes the Route header to third party domain name, and
forwards the message to the IBCF.
9\. The IBCF gets the third party PBX address from the DNS server, and
forwards the message through the established TLS connection. If the TLS
connection has not established, the IBCF will start the handshake.
10\. The third party PBX responds 18x and 200.
11\. The IBCF forwards 18x and 200 responses.
12\. Call established.
13\. Call ends.
14\. Billing and record for later audit use.
#### 6.13.2.4 Single SIP Registration third party User as the called party
{width="6.683333333333334in" height="4.029861111111111in"}
Figure 6.13.2.4-1: single SIP Registration third party User as the called
party
1\. The S-CSCF receives INVITE request from originating side, which the E.164
number is assigned to a third party.
2\. The S-CSCF finds the corresponding third party ID of the E.164 number from
implicit registration set, and forwards the message to the MMTel AS.
3\. The MMTel AS finds the corresponding third party ID of the E.164 number
from implicit registration set, and forwards the message to the S-CSCF after
MMTel service handling.
4\. The S-CSCF forwards the message to the P-CSCF.
5\. The P-CSCF forwards the message to the third party calling APP.
6\. The third party calling APP responds 18x and 200.
7\. The P-CSCF forwards 18x and 200 messages.
8\. Call established.
9\. Call ends.
10\. Billing and record for later audit use.
#### 6.13.2.5 Terminating IMS network verifying third party specific
identities and name card
This clause aims to give solution to the KI \"_how the terminating IMS network
can support the called party to verify third party specific identities during
a call._ \" and \"_potential impacts on STIR/SHAKEN procedures defined in TS
24.229 [8]_ \".
{width="6.690972222222222in" height="8.88125in"}
Figure 6.13.2.5-1: terminating IMS network verifying third party specific
identities and name card
1\. The third party subscriber initiates a call.
2\. The originating MMTel AS gets a private key, generates the JWT and
signature, and put them in SIP Identity header as the standard STIR/SHAKEN
procedure.
3\. The originating MMTel AS indicates in the INVITE message that the caller
side support media SHAKEN by carrying \"Supported: early-media-verification-
with-shaken\".
4\. The originating IBCF forwards the message to the terminating IBCF.
5\. The terminating IBCF forwards the message to the terminating MMTel AS.
6\. The terminating MMTel AS verifies the signature in Identity header with
the public key as the standard STIR/SHAKEN procedure.
7\. The terminating MMTel AS generates shared key and shared salt, encrypts
them with the public key. The shared key and shared salt is used for the
originating IMS to encrypt the media and the terminating IMS to decrypt the
media.
8\. The terminating MMTel AS forwards the call to the terminating UE, and uses
verstat parameter in the From and PAI URI header to indicate caller\'s level.
9\. The terminating UE responds 18x. When the response reach terminating MMTel
AS, it will include the encrypted shared key and shared salt in the response,
and also indicate the originating IMS that it supports media check.
10\. The terminating MMTel AS forwards the 18x to the originating MMTel AS,
carrying the Require and P-Media-Verification header.
11\. The originating MMTel AS decrypts the shared key and shared salt with the
private key.
12\. The terminating MMTel AS forwards the shared key and shared salt to the
terminating media checkpoint, and inform the terminating media checkpoint to
initiate media check.
13\. The terminating media checkpoint responds.
14\. The originating MMTel AS forwards the shared key and shared salt to the
MRF, and request the MRF to initiate media integrity protection tag in SRTP
tag.
15\. The MRF responds.
16\. The originating MMTel AS informs the MRF to start playing name card.
NOTE 1: The media negotiation process of CRS aligns with A.2.2 procedure in TS
24.183 [20].
17\. The MRF start sending the SRTP with integrity protection.
18\. The terminating media checkpoint checks the integrity of the media.
19\. The terminating media checkpoint sends the result to the terminating
MMTel AS.
20\. The terminating MMTel AS sends the results to the terminating UE.
NOTE 2: Security related aspects should be studied by SA WG3.
Editor\'s note: Which network element will take the role of terminating media
check point is FFS.
### 6.13.3 Impacts on Existing Nodes and Functionality
I/S-CSCF impact:
\- Support third party subscription model.
\- Support using third party ID and token to access IMS network.
\- Support IF1 reference point between I/S-CSCF and EDS.
P-CSCF impact:
\- Support using third party ID and Token to access IMS network.
IBCF impact:
\- Support using third party ID and Token to access IMS network.
\- Support IF3 reference point between IBCF and EDS.
MMTel AS impact:
\- Support using third party ID to trigger services.
\- Support generating and validating signature as STIR/SHAKEN process.
\- Support encrypting and decrypting the shared key and shared salted used to
encrypted rich name card media.
\- Support controlling MRF to process and forward rich name card media.
\- Support IF2 reference point between MMTel AS and EDS.
MRF impact:
\- Support processing and forwarding rich name card media.
EDS impact:
\- Support authenticating and connecting to third party auth. server,
retrieving and caching identity information.
\- Support receiving verification request from IBCF and CSCF, and forwarding
the request to third party.
\- Support generating temporary IMS user data, and forwarding to CSCF and AS.
NOTE: Whether the impact happens in MRF could be influenced by other KI.
## 6.14 Solution #14: IMS MRF Discovery and Selection using 5G-SBA NRF
### 6.14.1 Description
#### 6.14.1.1 Introduction
This is a solution for part of Key Issue #4: Study of Applicability of Service
based principles to IMS media control interfaces - addressing the issue of
selecting an appropriate MRF by an IMS AS, the solution proposes extending
existing NRF capabilities to support this action. It is anticipated that use
of this solution will be orthogonal to other solutions for different aspects
of Key Issue #4.
#### 6.14.1.2 Summary
On initialization the MRF performs a NF registration with the NRF, this
procedure is enhanced to include the list of media capabilities supported by
the MRF - this may include a wildcard to indicate all media capabilities
supported. In addition to the new indication of media capabilities, the
registration may include other existing parameters such as location and
priority, etc. This list of media capabilities is operator configured
depending on the IMS service offering and network configuration, some media
capabilities configuration may be generic (e.g. voice, video), some may be
more specific (e.g. a specific video codec).
After successful registration, the NRF will receive status updates from the
MRF regarding the load according to existing 5G_SBA principles. The NRF can
then utilize the load information to assist in MRF selection or distribute to
other SBA entities using existing capabilities. How the MRF determines its
load is left for implementation (e.g. hardware processor load, allocated
memory occupancy, media channels used, total bandwidth consumed etc).
When an IMS AS requires a MRF to perform media processing for a particular IMS
service it shall request service discovery/selection by the NRF, this request
will need to include the media capabilities (configured according the AS
service and operator configuration) this particular IMS service requires.
Depending on IMS AS implementation the AS may request each media capability
individually, or may request a particular set at a time (e.g. a TAS supporting
voice services may request all of the voice capabilities the first time it
needs a service for a particular user, or may request each voice capability
singularly when it needs to provide a particular service for a user). When
performing service discovery, the IMS AS will need to include the list of
required media capabilities (or wildcard), for service selection the IMS AS
may need to include other parameters.
NOTE 1: The media capabilities requested must align with the operator
configured list of media capabilities supported by the MRF (MRFC/MRFP).
If the NRF is performing discovery, the NRF will need to respond with the list
of MRF matching the requested media capabilities (along with the other NRF
parameters, location, priority, load etc). The IMS AS can then use the
supplied information to select the appropriate MRF. If the NRF is performing
discovery and selection the NRF will only need to respond with the specific
selected MRF.
NOTE 2: In some network implementations all MRF may be configured to provide
all media capabilities, and thus registration and selection may only need to
use the wildcard media capabilities.
Examples of media capabilities include:
\- Voice Announcements;
\- Voice Conferencing;
\- Voice Codec Adaptation;
\- RTT Interworking;
\- Video Codec Adaptation;
\- Video Conferencing;
\- XRM Adaptation;
\- DC Interworking.
Following the discovery/selection of the MRF by the IMS AS, normal IMS
procedures (using SIP signalling) will occur to establish the connections to
the MRF.
#### 6.14.1.3 Networks using SCP
After discovery/selection of the MRF the subsequent interactions with the MRF
use SIP signalling it is not applicable to use communication modes C and D and
thus no SCP interactions occur. Therefore, there are no SCP impacts.
#### 6.14.1.4 Distributed MRFC/MRFP
In some networks the MRF is distributed into discrete MRFC and MRFP - to
support all implementation options the same procedures for MRF
selection/discovery may need to be supported for MRFC and MRFP nodes. The IMS
AS may need to discover/select an appropriate MRFC, and in some cases the MRFC
may need to discover/select an appropriate MRFP. However, in many
implementations the pairing between MRFC and MRFP can be fixed by
implementation or pre-configuration, and thus only selection of MRFC is
sufficient.
### 6.14.2 Procedures
#### 6.14.2.1 MRF Registration
Figure 6.14.2.1: MRF Service Registration
1\. The IMS_MRF sends Nnrf_NFManagement_NFRegister Request message to inform
the NRF of its profile when the IMS_MRF becomes operative for the first time.
The IMS_MRF profile includes the operator configured list of media
capabilities supported by this MRF - this may be a wildcard to indicate
support of all media capabilities.
2\. The NRF stores the profile of the IMS_MRF and marks it available.
3\. The NRF acknowledge MRF Registration is accepted via
Nnrf_NFManagement_NFRegister response.
NOTE: For distributed MRFC/MRFP replace IMS MRF above with either MRFC or MRFP
- in fully distributed implementations both MRFC and MRFP may need to register
; however in some implementations only one of the MRFC or MRFP will need to
register if the pairing is known or pre-configured (as per SBA model A).
#### 6.14.2.2 MRF Service Discovery & Selection
Figure 6.14.2.2: IMS_MRF discovery using SBA NRF
1\. The IMS NF (e.g. CSCF, IMS_AS, etc) invokes Nnrf_NFDiscovery_Request to
request an MRF - including the list of required media capabilities (which may
be a wildcard for all media services).
2\. The NRF authorizes the Nnrf_NFDiscovery_Request. According to current
5G_SBA practices.
3\. If the request is allowed, the NRF determines a set of MRF instance(s)
matching the Nnrf_NFDiscovery_Request and internal policies of the NRF and
sends the information for the determined IMS_MRF instance(s).
Depending on implementation the discovery request may contain other
information (e.g. IMS_NF location, IP address, etc.). The selection algorithm
may be configured to use this information (if available) to determine the most
suitable IMS_MRF instance, e.g. the location may be used to select the IMS_MRF
instance located closest to the user if all other aspects are equal.
NOTE 1: The list of media capabilities (which could be a single capability)
sent in the Discovery_Request must align with the operator configured list of
capabilities supported by the MRF (MRFC/MRFP) that are sent when the AF
registers with the NRF.
Based on network configuration either the NRF performs network selection based
on included profile information or supplies the set of appropriate MRF (and
associated profile information) for the IMS_NF to perform NF selection
according to its own criteria.
NOTE 2: For distributed MRFC/MRFP the IMS NF may be discovering/selecting the
MRFC or MRFP - in fully distributed implementations both MRFC and MRFP may
need to be selected in this way.
### 6.14.3 Impacts on Existing Nodes and Functionality
#### 6.14.3.2 Impacts to existing nodes
Impacts to NRF
\- NRF needs to support MRF registration (with a list of IMS media
capabilities).
\- NRF needs to support MRF selection/discovery (with a list of IMS media
capabilities).
Impacts to MRF
\- MRF needs to support SBA.
\- MRF needs to support service registration with NRF including media
capabilities.
\- MRF needs to support configuration of list of supported media capabilities.
Impacts to IMS AS
\- AS needs to support MRF selection/discovery via NRF.
\- AS needs to support configuration of the requested media capabilities.
NOTE: It is assumed that the IMS AS already supports SBA due to support of Sh
via SBA in earlier releases.
#### 6.14.3.1 Impacts to interfaces
Nnrf
\- NF registration service requires addition of MRF, MRFC, and MRFP as NF
types.
\- NF registration service requires extension to include list of media
capabilities of MRF (including wildcard).
\- NF discovery service needs to support IMS AS to request MRF, MRFC, and MRFP
services for selection/discovery.
\- NF discovery service for MRF requires extension to include required media
capabilities of MRF (including wildcard).
## 6.15 Solution #15: Applying service based principles to IMS media control
interfaces for supporting new capbilities Efficiently
### 6.15.1 Description
#### 6.15.1.1 Scope
For media control interfaces of new capabilities (such as DC, AR, etc.),
service-based interfaces should be used. For the existing capabilities
associated with the new capabilities, the media control interface should also
be service-based(Only AGW is considered this time, and the service-based
transformation of other existing media capabilities is FFS). Both new media
capabilities and existing media capabilities should establish a dynamic
registration and discovery mechanism. Further, the unified media plane
function is used to enable the coordination between new media capabilities and
existing media capabilities, making media processing more efficient.
#### 6.15.1.2 Definitions
**Media plane network element (NE):** The existing media plane network
element, including MRFP/IMS-AGW/ TrGW/IM-MGW.
**Media plane network function (NF):** The media plane network entities that
are accessed through service-based interfaces and support dynamic registration
and discovery. The media plane NF inherits some of the media capabilities of
the existing media plane network element.
**Media plane network function service (NFS):** media plane NF is disassembled
into different services, referred to as NFS.
**Unified Media Function (UMF)** : The unified NF which load media plane NFS.
Any media plane NFS can be loaded into a UMF, which supports the mixed
deployment of NFS from different media plane NEs at the same time.
**Numf:** the service-based interface provided by UMF. All media control plane
NEs request the media capabilities by this interface.
#### 6.15.1.3 Principle
Based on the scope of this solution, media plane NF is disassembled into
different services, referred to as NFS (network function service). Each NFS
has the characteristics of independence and autonomy.
NFS related to DC and AR is defined in other documents. Here, only NFS related
to AGW is defined.
Table 6.15.1.3-1
+------+-----------------------------+------------------------------+ | Seq. | Service | Service description | +------+-----------------------------+------------------------------+ | 1 | IMS Access gateway function | Through this service, | | | | service consumer can request | | | (_imsAGW) | NF to realize Local NAT, | | | | Remote NAT traversal, | | | | Transcoding, etc. | +------+-----------------------------+------------------------------+
NOTE 1: The operations contained in each NFS need to be defined in CT WG4.
For media plane NFS, the NRF (Network Repository Function) needs to be defined
to be responsible for the automatic management of all NFS, including
registration, discovery and status detection. After a NF is powered on, it
will actively report its own NFS information to NRF.
The media plane NF loading with media plane NFS is uniformly named UMF
(Unified media function), which provides the possibility for the unified
deployment of NFS from different media plane NEs, and enables more efficient
media processing.
During the session, when a media control plane NE (such as AS, P-CSCF etc.)
needs to use a certain media capability, it needs to query the NRF to obtain a
specific UMF instance.
NOTE 2: UMF is an implementation option. There is no requirement to replace
existing media functions with UMF or implement all functions in a single UMF.
Editor\'s note: Whether and which other information besides supported media
capabilities is used to select UMF, MRF, TrGW, IMS-AGW is FFS.
#### 6.15.1.4 Architecture
{width="6.690277777777778in" height="1.538888888888889in"}
Figure 6.15.1.4-1: Architecture to support SBA for IMS media plane
NOTE: The capabilities of DCS-M and AR-M in relevant documents are uniformly
provided by UMF, which is no longer reflected separately in the above figure.
P-CSCF (IMS-ALG) accesses the service bus and invokes the AGW function based
on the service-based interface.
#### 6.15.1.5 Co-existence of 5G service based and legacy IMS media control
interfaces
H248-based media control and service-based media control can coexist in one
network:
\- If a control plane NE only supports H248 interface, it calls the media
capability provided by the traditional media plane NE, such as P-CSCF_1 below.
\- If a control plane NE only supports SBI, it calls the media capability
provided by UMF, such as P-CSCF_3 below.
\- If a control plane NE supports both H248 interface and SBI, it can freely
choose to call the media capability provided by the traditional media plane NE
or the media capability provided by UMF, such as P-CSCF_2 below.
{width="6.677777777777778in" height="2.652083333333333in"}
Figure 6.15.1.5-1: Architecture to support SBA for IMS media plane
### 6.15.2 Procedures
#### 6.15.2.1 Registration of media plane NF
After an UMF is powered on, it shall register in NRF their capabilities using
the Nnrf_NFManagement_NFRegister Request message (as described in clause 4.17
of TS 23.502 [3]). The parameter related to IMS media plane are as follows:
\- When UMF sends NF registration request to NRF, the following key parameters
need to be carried:
\- NF type: indicates NF type, and the value should be \"UMF\".
\- supported NF services: indicates the list of NFS instances contained in an
NF, which can be discovered by other NF. The value is the attribute of each
NFS instance in the current UMF: unique identification, type (such as numf-
agw-xxx), calling address, etc.
#### 6.15.2.2 Discovery of media plane NF
During the IMS procedure, an SBI capable IMS entity (such as AS, P-CSCF, etc.)
sends a Nnrf_NFDiscovery_Request to NRF (as described in clause 4.17 of TS
23.502 [3]) to discover SBI capable UMF instances. The parameter related to
IMS media plane are as follows:
\- Service consumers need to carry the following key parameters when sending
NF discovery request to NRF:
\- Requester NF type: indicates the NF type of the service requester. Possible
values include AS, P-CSCF, S-CSCF and IBCF.
\- Target NF type: service provider NF type, the value should be \"UMF\".
\- Service names: the type of NFS requested. The value range is all NFS
supported by UMF, such as numf-agw-xxx. This parameter is required for IMS
media plane.
#### 6.15.2.3 Coordination between new media capabilities and existing media
capabilities
The Figure below shows the procedure of UE-initiated bootstrap data channel
establishments, as example of collaboration between new media capabilities and
existing media capabilities. This procedure assumes that UE A (calling party)
only needs to establish a bootstrap DC with the local network (stream ID 0),
but does not need to establish a bootstrap DC with the remote network (stream
ID 100).
This procedure focuses on data channel. The audio / video established
simultaneously with DC is not described in this procedure.
UMF_O implements the functions of the existing IMS-AGW and is requested by
P-CSCF through the service-based interface instead of the original H248
interface.
{width="6.682638888888889in" height="6.930555555555555in"}
Figure 6.15.2.3-1: Procedure of UE-initiated bootstrap data channel
establishments
1\. UMF_O indicates that it supports AGW media capability and DC related media
capability through above NF registration procedure.
2\. UE A sends an INVITE request to the P-CSCF_O with an initial SDP offer, to
initiates an IMS call to UE B (called party). The initial SDP offer includes
one description for the bootstrap data channel media stream between UE A and
the local network.
3\. P-CSCF_O sends NF discovery request to NRF carrying required NF
information: NF type(value: \'UMF\'), media plane service names (value:
\'AGW\'). NRF provides UMF_O as the target NF in the response message.
4\. P-CSCF_O sends Reserve and Configure Connect Point request to UMF_O to
acquire two DC connection point information: 1) first DC connection point for
connecting to UE A, 2) second DC connection point for connecting to local
network. Connection point information includes their unique identification,
local IP, local port, URL address, etc.
NOTE 1: The audio / video connection points are acquired by the same message,
but the following procedure will not be described audio/video related
processing in detail.
5\. P-CSCF_O forwards the INVITE message to S-CSCF-O, and the address in SDP
is replaced with the local address of second connection point. Additionally,
the INVITE carries the information of the two connection points and UMF_O. The
connection point information includes their unique identification, URL
address, etc. The UMF_O information includes unique identification of UMF_O.
S-CSCF-O forwards the INVITE message to MMTELAS_O.
6\. MMTELAS_O sends an Event Notification to the DCS-C, and DCS-C sends a
Session Control request to the MMTel AS A, indicating it how to process the
SDP: In this case, it requires the MMTel AS A to terminate the bootstrap data
channel media stream between UE A and the local network, and initiate a
bootstrap data channel media stream between the local network and UE B.
7\. MMTELAS_O sends NF discovery request to NRF carrying required NF
information: NF type (value: \'UMF\'), media plane service names (value:
\'DC\') and preferred NF instance information: preferred-NF-id (value:
\'UMF_O\').
8\. NRF according to UMF_ O\'s registration information to determines that
UMF_O can provide DC media plane service, it sends a NF discovery response to
MMTELAS_O indicating MMTELAS_O that the target NF providing DC service for
current session is UMF_O.
NOTE 2: If the UMF_O can\'t provide DC media plane service, NRF returns
another UMF instance instead of UMF_O to provide the service, the subsequent
procedure is no different from the existing procedure.
9\. The MMTELAS_O constructs a new SDP offer based on the Session Control
request from the DCS-C, including one new description for data channel media
stream between UE B and the local network. Then sends an INVITE request
message to the S-CSCF with the new SDP offer. The address in SDP is the local
address of second DC connection point.
S-CSCF-O forwards the INVITE message to called IMS network.
10\. Called IMS network sends this 18X response to the S-CSCF-O carrying
called media descriptions for data channel media stream between UE B and the
local network.
S-CSCF-O forwards the 18X response to MMTELAS_O.
11\. MMTELAS_ O sends Configure DC Connection Point request to UMF_ O,
configures the remote address of second connection point as per called
party\'s IP/port, and completes the establishment of the bootstrap DC path
between the local network and the UE B.
12\. UMF_O sends Configure Connection Point response to MMTELAS_ O
13\. MMTELAS_ O sends a Media Update Notification message to the DCS-C,
reporting the audio/video/data channel media negotiation result, including URL
address of two connection point.
DCS-C sends a response to MMTELAS_ O
14\. MMTELAS_O updates the initial SDP answer in 183 response, and sends it to
the S-CSCF. The new SDP answer includes one media description for data channel
media stream between UE A and the local network. The transport layer address
is replaced with invalid value (such as 0.0.0.0).
S-CSCF-O forwards the 183 response to P-CSCF_O.
15\. P-CSCF_O updates the SDP answer in 183 response, the transport layer
address is replaced with the local address of first connect point, then
forwards the 183 response to UE A.
The subsequent is the PRACK/PRACK 200 procedure.
### 6.15.3 Impacts on existing nodes and functionality
P-CSCF/AS impact:
\- The extension for supporting the discovery of media plane NF through NRF.
\- The extension for supporting requesting media plane NF through the SBI.
NRF impact:
\- The extension for supporting preferred NF instance.
UMF impact:
\- Support the mixed deployment of NFS from different media plane NEs (DCS-M
and AR-M and IMS-AGW).
\- Support coordination between new media capabilities and existing media
capabilities.
## 6.16 Solution #16: Solution for IMS Media Support for DC Server
### 6.16.1 Description
In this solution, the MRF is enhanced to support the IMS DC feature. To
provide the DC Signalling Function (DCSF) with the enhanced MRF Egress
information for Bootstrap data as an example, as well as receive the DCSF
bootstrapping addressing information, the IMS AS interacts with the DCSF for
that purpose.
Figure 6.16.1-1 depicts a high level architecture diagram for the enhanced MRF
solution showing the architecture of the IMS for supporting the IMS Data
Channel feature, illustrating the interworking between IMS and other entities
needed to support DC feature in this option.
In this architecture, the IMS MRF is enhanced to support additional
functionality related to DCSF and other data channel media. This functionality
is referred to as Data Channel Media Function (DCMF) while maintaining
backward compatibility, and reusability. MRFs that are expected to support DC
feature shall be enhanced for that purpose.
NOTE 1: Not all deployed MRFs needs to be enhanced to support DC feature.
In this architecture, the \'3rd Party WebRTC enabled Application\' provides
application media content relayed over established WebRTC 1.0 RTCDataChannels
(IF10). The \'3rd Party WebRTC enabled Application\' establishes peer media
connectivity using WebRTC data channels.
Figure 6.16.1.1-1includes the following interfaces:
\- IF1 between the enhanced MRF and DCSF for media transport related to
bootstrapping. What is transported over IF1 is only relevant to the UE. IF1 is
HTTP based.
\- IF10 between the enhanced MRF and 3pty Web RTC Applications. IMS is
transparent to the data channel payload media carried on this interface.
\- IF6 between the IMS AS and DCSF for managing DC feature related to IMS data
channel including media control. This interface hast to be extensible and
support vendor specific information with no impact on interoperability. IF6 is
service based.
\- DCSF includes multiple functions. The control function for DCSF decides
usage of data channel media within the sessions, interacting with both the
IMSAS and third-party WebRTC applications. The Bootstrap media function
terminates HTTP bootstrap channels established with call sessions, hereby
taking the role of a standard web server, potentially acting as a proxy for
HTTP resources hosted by external third-party webservers. The DC Application
repository includes bootstrap media content fetched by TS 26.114 [6] UE\'s.
\- MRF (MRFC/MRFP) includes both legacy media resources (e.g. Voice and
Video).
\- Enhanced MRF includes the data channel media function DCMF resources.
NOTE 2: Not all MRFs have to be enhanced to support DCMF.
\- The IMSAS can utilize the Network Repository Function to discover the MRF
instance(s). The NRF provides the IP address or the FQDN of MRF instance(s) to
the IMSAS. The MRF selection function in the IMSAS selects the MRF instance(s)
based on the available MRF instances obtained from NRF or based on the
configured MRF information in the IMSAS. The following factors may be
considered during the MRF discovery and selection: - UE location information.
- Local operator policies. - Availability of candidate MRFs. - UE IP address.
- Access Type. - Proximity to location of selected UPF if possible.
IF6 is in scope of the TR.
Nimsas implements services supported by the IMS AS.
Ndcsf implements services supported by the DCSF.
Editors note: Nimsas, and Ndcsf are FFS.
{width="6.1875in" height="5.676388888888889in"}
Figure 6.16.1-1: IMS DC Enhanced MRF Architectural Option
NOTE 3: Application Repository can be outside DCSF.
### 6.16.2 Procedures
#### 6.16.2.1 IMS Session Procedures
The call flow in Fig 6.16.2.1-1 illustrates the various interactions within an
IMS DC related session related to the DC feature. Interactions triggered by
UEs related to the actual initiation of bootstrapping are not included.
{width="6.622222222222222in" height="7.69375in"}
Figure 6.16.2.1-1: DC Channel Establishment
The following is a brief description of the steps in the call flow:
\- In step 1, a DCMTSI UE registers in IMS after successfully establishing an
IMS PDU session.
\- In step 2, the UE establishes an audio IMS session with a DCMTSI UE of the
terminating network, i.e. both UE\'s have indicated support for the IMS DC
feature by including the feature tag _+sip.app-subtype=\"webrtc-datachannel\"_
in the Contact header
\- In step 3, the originating user initiates upgrade of the established
session to add data channel content, which results in the DCMTSI UE sending a
session re-negotiation request with local and remote data channel streams
added to the SDP as per TS 26.114 [6]. It is here assumed that both the
originating and terminating networks provides IMS DC content.
\- In step 4, the IMS AS notifies the DCSF about a session modification
request event of served user including information about offered data channel
streams. DCSF apply policies and check for applicable content that may require
bootstrapping.
Editor\'s note: The exact nature of that interaction is FFS.
\- In step 5, the DCSF instructs the IMSAS on how each offered data channel
stream of served user shall be handled, i.e. passed-on to the terminating
network, removed or be anchored in the enhanced MRF. In this example, the DCSF
requests IMS AS to anchor the stream including local bootstrapping and pass-on
the stream including remote bootstrapping.
Editor\'s note: The exact nature of that interaction is FFS.
\- In step 6, the IMS AS selects an enhanced MRF supporting the DCMF feature
and requests the MRF to allocate resources for the specified data channel
stream.
\- In step 7, the IMS AS informs DSCF that anchoring of the local bootstrap
stream was successful, so session modification procedure can continue.
Editor\'s note: The exact nature of that interaction is FFS.
\- In step 8, the session modification procedure is continued. The SDP is
adjusted as per DCSF request, to exclude the data channel stream anchored in
the MRF before the session re-negotiation request is sent to the terminating
network.
\- In step 9, the terminating network responds to session modification
request. In this call flow it is also assumed that the terminating network
offers remote bootstrapping, which means that the offered data channel stream
for remote bootstrapping is accepted.
\- In step 10, the IMS AS notifies the DCSF of the session modification
request answer event, including data channel stream information of the SDP
answer.
Editor\'s note: The exact nature of that interaction is FFS.
\- In step 11, The DCSF may at this point depending on the remote answer,
request the IMSAS to update the enhanced MRF with additional instructions on
how DC streams shall be handled within the session.
\- In step 12, the IMS AS updates the SDP towards the UE as per DCSF request,
so that the IMS AGW is updated with correct media anchoring information
related to the bootstrap data streams.
\- In step 13, the SIP ACK is sent to the target.
As can be seen, as examples, a) the local Bootstrap data of served user
traverses through enhanced MRF to the DCSF, b) the remote Bootstrap of served
user, offered by the Terminating NW, bypasses the enhanced MRF.
\- In step 14, the remote user may take the initiative to upgrade the session
with DC content, which would result in the remote DCMTSI UE, initiating a
session modification, adding local and remote bootstrapping streams.
#### 6.16.2.2 IMS AS - DC Server Interaction for Media control
Editor\'s note: This interface is FFS.
### 6.16.3 Impacts on existing nodes and functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
## 6.17 Solution #17: Service registration, discovery and selection for
distributed DC server
### 6.17.1 Description
This solution addresses Key Issue #1 \"Enhancement to support Data Channel
usage in IMS network\" and Key Issue #4: \"Study of Applicability of Service
based principles to IMS media control interfaces\", on service registration
and discovery of DC Server.
To support distributed DC server architecture with separate control plane and
media plane, separate service registration and discovery for control plane and
media plane are required.
The solution proposes to extend existing NRF based mechanism with DC specific
profiles for control plane and media plane of DC Server. When there are
multiple control plane NFs or media plane NFs, the solution discovers and
selects a NF whose profile fulfils the DC requirements.
### 6.17.2 DCSF Registration and Discovery
#### 6.17.2.1 DCSF Registration
Figure 6.17.2.1-1: DCSF registration procedure
1\. The DCSF sends Nnrf_NFManagement_NFRegister_Request message to inform the
NRF of its profile.
2\. The NRF stores the DCSF profile and marks it as available.
3\. The NRF acknowledges that DCSF Registration is accepted by
Nnrf_NFManagement_NFRegister_Response.
Considering DCSF may be deployed per customer, e.g. per company, and
integrates or connects to different DCAR to provide different applications or
services to their subscribers, the DCSF profile includes information
identifying the customers it serves, i.e. IMPU range of calling identity or
called identity of it serves.
NOTE 1: The DCSF profile will align with solution #20 and the details can be
specified in normative work.
NOTE 2: The DCSF also can update and deregister in the NRF after registration
and the procedures are specified in clauses 4.17.2 and 4.17.3 of TS 23.502
[3].
#### 6.17.2.2 DCSF Service Discovery and Selection
Figure 6.17.2.2-1: DCSF discovery procedure
1\. IMS AS sends Nnrf_NFDiscovery_Request to NRF, with the required data
channel control related information .e.g. calling IMPU, Request URI, NF
type=DCSF.
2\. The NRF determines the DCSF instance(s) which satisfies the
Nnrf_NFDiscovery_Request and/or NRF local policy. NRF can provide the
dedicated one DCSF instance based on network configuration or send the
appropriate DCSF instances to the IMS AS, and IMS AS will make decision on the
selection of DCSF.
3\. NRF sends Nnrf_NFDiscovery_Response with the DCSF instance(s) information
to IMS AS. In case of multiple DCSF instances are received, the IMS AS will
perform DCSF NF selection based on the local policy.
### 6.17.3 DCMF Registration and Discovery
#### 6.17.3.1 DCMF Registration
Figure 6.17.3.1-1: DCMF registration procedure
1\. The DCMF sends Nnrf_NFManagement_NFRegister Request message to inform the
NRF of its profile. The DCMF profile includes the data channel media
capabilities which are supported by this DCMF.
2\. The NRF stores the DCMF profile and marks it as available.
3\. The NRF acknowledges that DCMF Registration is accepted by
Nnrf_NFManagement_NFRegister_Response.
NOTE 1: The details of DCMF profile is similar to MRF in solution #14 and can
be specified in normative work.
NOTE 2: The DCMF also can update and deregister in the NRF after registration
and the procedures are specified in clauses 4.17.2 and 4.17.3 of TS 23.502
[3].
#### 6.17.3.2 DCMF Service Discovery and Selection
Figure 6.17.3.2-1: DCMF discovery procedure
1\. IMS AS sends Nnrf_NFDiscovery_Request to NRF, with the required data
channel media services related information, e.g. NF type=DCMF.
2\. The NRF determines the DCMF instance(s) which satisfies the
Nnrf_NFDiscovery_Request and/or NRF local policy. NRF can provide the
dedicated one DCMF instance based on network configuration or send the
appropriate DCMF instances to the IMS AS, and IMS AS will make decision on the
selection of DCMF.
3\. NRF sends Nnrf_NFDiscovery_Response with the DCMF instance(s) information
to IMS AS. In case of multiple DCMF instances are received, the IMS AS will
perform DCMF NF selection based on the local policy.
### 6.17.4 Impacts on existing nodes and functionality
NRF:
\- NRF supports service based registration, update, deregistration and
discovery of DCSF and DCMF.
IMS AS:
\- IMS AS supports service based discovery and selection of DCSF and DCMF.
## 6.18 Solution #18: Negotiation the data channel application(s) used in the
call
### 6.18.1 Description
#### 6.18.1.1 General
For example, UE-A and UE-B is on the call, and the UE-A is the one who
requests to establish an application data channel.
As described in TS 26.114 [6] that: application data channel can be
established after the data channel application is downloaded from the Data
Channel Server Control Function. That is the UE-A can select any data channel
application which has been downloaded to establish the application data
channel, and does not consider whether the user of UE-B is willing to use it
e.g. the user of UE-A selects an LCS data channel application, but the user of
UE-B does not like to let others know his location, so the user of UE-B
refuses the request. This trial and error method is a kind of waste to
Operator(wasting network resource) and to UEs(wasting battery power).
This solution provides a new procedure to let the user of UE-B has the
capability to decide whether to use the data channel application(s) selected
by UE-A before downloading the data channel application(s) to the UEs and
receiving the establishment request.
This solution is used in the P2P scenario.
### 6.18.2 Procedures
The figure 6.18.2-1 depicts the procedures how the data channel application
used in the call is negotiated.
Figure 6.18.2-1: Negotiation of a selected data channel application
Key steps:
1\. The UE-A establishes audio/video session connections with the UE-B.
2\. The UE-A initiates bootstrap data channel connections. The bootstrap data
channel is established for the UE-A and UE-B respectively, e.g. using the DC
Control Function of UE-A.
3\. The data channel application list is received from the DC Control Function
by UE-A and UE-B respectively.
4\. UE-A and UE-B negotiate the data channel application(s) used in the call.
The UE-A can send the selected data channel application list to UE-B to ask
whether UE-B is willing to use in the call, e.g. via the bootstrap data
channels established in step 2.
The UE-B can acknowledge whether the data channel application(s) in the list
can be used in the call, e.g. via the bootstrap data channels.
Editor\'s note: How to sends the data channel application list from UE-A to
UE-B is FFS. Whether the message sent in the bootstrap data channel needs to
be specified in 3GPP is FFS.
Editor\'s note: How does the solution work if the UE\'s are using different DC
server instances or in different IMS networks is FFS.
5-6. The data channel application(s) acknowledged by UE-B will be downloaded
to the UE-A and UE-B respectively.
7\. The application data channel is established between UE-A and UE-B.
### 6.18.3 Impacts on Existing Nodes and Functionality
#### 6.18.3.1 Impacts to existing nodes
This solution has some requirements on the existing IMS nodes below:
**UE** :
\- The UE-A who selects a data channel application(s) can request the UE-B
whether to accept to use it.
\- The UE-B can acknowledge whether to use the data channel application
selected by the UE-A.
## 6.19 Solution #19: Light weight solution of third party specific ID using
existing mechanisms
### 6.19.1 Description
This solution addresses Key Issue #3 \"Third party specific user identities\".
This solution is a light weight solution using existing mechanisms including
implicit registration set, display-name parameter in From hear field and
STIR/SHAKEN, to sign, verify and demonstrate an ID including third party
specific information. This solution has no impact on the UE, so it applies to
the standard IMS UE and does not require the UE to be upgraded or install any
application.
The third party customer has a business contract with IMS network operator.
Based on the contract, each third party user is provisioned with IMS
subscription data, including a third party specific IMPU, stored in the HSS of
the IMS network. This third party specific IMPU includes IMS domain name
specific to the third party customer.
The IMS network operator configures corresponding SiFC on S-CSCF identifying
the domain name and targeting the originating AS specific to the customer.
The originating AS can be a specific AS for a third party, e.g. a STI-AS, or
an existing AS, e.g. TAS. The IMS network operator provisions domain name list
or IMPU range of third parties it serves in the AS to decide whether to sign
the message.
The UE get the third party specific IMPU and uses it to initiate IMS call.
Originating S-CSCF forwards the INVITE request message, based on the
configured iFC, to the originating AS specific to the customer. The
originating AS adds display-name containing third party specific information
to From header field in the INVITE message. The third party specific
information can be texts of the company name, title, et. al. The originating
AS may also copy Tel URI included in P-Asserted-Identity header to From header
for CLIP and for call back.
The originating AS and the terminating AS follows existing STIR/SHAKEN
procedures specified in TS 24.229 [8] to sign and verify the modified From
header field.
Per third party request, the originating AS discovers the call is between
users belonging to the same third party based on the configured domain name
list or IMPU range of third parties it serves, it can skip the signing
procedure.
NOTE: The display-name part of From header field is not verified by the
terminating AS, but the terminating AS can check and validate it according to
RFC 8224 [18].
The terminating AS may modify display-name of From header with some texts like
\"verified by operator\" to inform the called user that the calling ID has
been verified and attested.
The terminating UE demonstrate the calling ID based on From header.
### 6.19.2 Procedures
There is no impact on procedures.
### 6.19.3 Impacts on existing nodes and functionality
The originating AS:
\- copy Tel URI included in P-Asserted-Identity header to From header for CLIP
and for call back;
\- adds display-name containing third party specific information to From
header field in the INVITE message;
\- provisions domain name list or IMPU range of third parties it serves.
HSS and S-CSCF:
\- support of provisioning and configuration of third party specific SiFC.
## 6.20 Solution #20: Merged solution to support Data Channel usage in IMS
network
### 6.20.1 Description
#### 6.20.1.1 General
This solution addresses Key Issue #1 \"Enhancement to support Data Channel
usage in IMS network\" and focuses on how IMS network architecture and
procedures are enhanced to support Data Channel usage. This contribution is
trying to merge existing solutions of DC architecture and procedure in TR
23.700-87 to establish a joint proposal for evaluation and conclusion for
KI#1.
Generally, this contribution includes principles and contents from solution
#1, solution #3, solution #6, solution #7 and solution #16.
The interim conclusion in clause 9.1 is also considered when shaping the
merged solution.
This solution supports separation of signalling function and media function
supporting Data Channel. A new service based function, Data Channel Signalling
Function (DCSF), is introduced. There are two ways to provide the DC media
function to fulfil different requirements of IMS migration to support DC:
\- by enhancing the existing IMS MRF (called enhanced MRF) to perform media
functions related to DC, which interacts with IMS AS via legacy MRF
interfaces, i.e. Mr\'/Cr; and
\- by introducing a new service based function called Data Channel Media
Function (DCMF), which interacts with IMS AS via the new SBA interface DC2.
For both options, the DC media function is specified in clause 6.20.1.2.
NOTE 1: The above MRF can be a standalone enhanced MRF that performs only DC
functions, or a combined MRF that performs the DC functions as well as other
media functions (e.g. voice/video, etc).
NOTE 2: DCMF can also be collocated with other functional entities.
The discovery and selection of DCSF, DCMF,/enhanced MRF and IMS AS are
supported by NRF based mechanisms, referring to solutions #14 and #17.
#### 6.20.1.2 Architecture
##### 6.20.1.2.1 Solution Overall Architecture
The two architecture options of this solution are shown in Figure 6.20.1.2-1
and Figure 6.20.1.2-2.
In this Release, it is assumed that IMS AS, as depicted in the architecture
figure, is co-located with the TAS.
Figure 6.20.1.2-1: Architecture option of IMS supporting DC usage with DCMF
Figure 6.20.1.2-2: Architecture option of IMS supporting DC usage with
enhanced MRF
The following functional entities are introduced or enhanced to support DC
usage in IMS network:
**1) Data Channel Signalling Function (DCSF):**
\- Implements data channel control logic through DC1 control API;
\- Receives event reports from the IMS AS and decides the usage of data
channel;
\- Manages bootstrap data channels and (if applicable) application data
channels by interacting with IMS AS;
\- Enables uploading of data channel applications as specified in TS 26.114
[6], however this is out of scope;
\- Controls download of IMS data channel applications to the UE;
\- Supports HTTP web server to terminate HTTP traffic associated with
downloading of data channel applications (Bootstrapping) via DCMF and/or
enhanced MRF. Additionally, it may optionally act as a proxy for HTTP for
resources hosted by external third-party applications;
\- Interacts with NEF for data channel capability exposure via N33 and
MDC3/MDC2;
\- Interacts with DC application Server via DC3/DC4 for DC resource control
and traffic forwarding via MDC3/MDC2.
**2) Data Channel Application Repository (DCAR):**
\- Supports data channel applications storage. DCAR can be part of the DCSF or
a standalone function.
NOTE 1: When the DCAR is a standalone function, the interface DC5 between DCAR
and DCSF is out of scope of 3GPP.
**3) Data Channel Media Function (DCMF) / enhanced MRF:**
DCMF and enhanced MRF support the same DC media functionalities as below:
\- Manage the media resources for data channel media (bootstrap and
application data channel if applicable) under the control of IMS AS;
\- Terminates bootstrap data channel to/from the UE and forwards HTTP traffic
between the UE and DSCF via MDC1 and optionally between the UE and the DC
Application Server via MDC2;
\- Anchors application data channel in P2P scenarios, if required, and
accordingly supports e.g. data traffic forwarding and possible media
interworking between DCMTSI client and MTSI client;
\- Relays A2P/P2A application data channels between the UE and the DC
Application Server via MDC2.
NOTE 2: The definition of DC Application Server is out of scope of 3GPP.
**4) IMS AS:**
\- Interworks with DCSF via DC1 for event notification for data channel and
data channel control procedures;
\- Interacts with DCMF via DC2 and with enhanced MRF via Mr\'/Cr for data
channel media resource management.
NOTE 3: The IMS AS may be integrated with the DCSF in which case the DC1
interface is internal.
The following service based reference points are introduced or enhanced to
support DC usage in IMS network:
\- DC1: Reference point between the DCSF and the IMS AS.
\- DC2: Reference point between the IMS AS and DCMF.
\- DC3: Reference point between the DCSF and NEF.
\- DC4: Reference point between the DCSF and DC Application Server.
\- DC5: Reference point between the DCSF and DCAR.
NOTE 4: DC5 is not specified in 3GPP.
Editor\'s note: Whether DC3 is specified in this release is FFS.
The following reference points are introduced or enhanced to support DC media
handling:
\- Mb: Existing reference point used for transport of data channel media
between DCMF and IMS-AGW.
\- Mr\'/Cr: SIP based reference point between IMS AS and enhanced MRF
\- MDC1: Reference point for transport of data channel media between DC media
function (either DCMF or enhanced MRF) and DCSF.
\- MDC2: Reference point for transport of data channel media between DC media
function (either DCMF or enhanced MRF) and DC Application Server.
\- MDC3: Reference point of data channel media between DCSF and DC Application
Server.
NOTE 5: MDC1, MDC2 and MDC3 are not specified in 3GPP.
DC1, DC2, DC3 and DC4 are service based interfaces so that the following
services are to be specified:
\- Ndcsf:
\- Exposure of data channel control. (Possible service consumer: NEF, DC
Application Server).
\- Ndcmf:
\- Management of data channel media resources. (Possible service consumer: IMS
AS).
\- Nimsas:
\- Notification of data channel media events, e.g. media resource status or
media information, to IMS AS during an IMS session. (Possible service
consumer: DCSF).
\- Management of data channel media resources. (Possible service consumer:
DCSF).
\- Nnef:
\- Enhancements on exposure for data channel capabilities (Possible service
consumer: DC Application server).
Editor\'s note: Whether enhancements to Nnef is specified in this release is
FFS.
##### 6.20.1.2.2 Architectural aspects related to media configurations for
MDC1 and MDC2
Figure 6.20.1.2.2.1-1 below depicts the DCMF media configuration, referred to
as the \"HTTP Proxy\" configuration, available for the DCSF when instructing
the DCMF to relay bootstrap data channel media between the Mb and the MDC1
interfaces. The protocol view of this media configuration can be used as a
basis for deriving required DCMF attributes for DC1 and DC2 service operations
(as well as Mr\'/Cr).
{width="4.320833333333334in" height="2.1534722222222222in"}
Figure 6.20.1.2.2-1: DCMF Mb - MDC1 \"HTTP Proxy\" Media Configuration for
Bootstrap DC
The DCMF \"HTTP Proxy\" configuration will be selected by the DCSF to provide
the bootstrap application (menu and application download). Figure 6.20.1.2.2-2
below depicts the DCMF \"Transparent Relay Mode\" configuration available for
the DCSF when instructing the DCMF to relay application data channel media
between the Mb and MDC2 towards a DC Application Server providing a P2A/A2P DC
application. The protocol view can be used as a basis for deriving required
attributes for DC1, DC2, DC3 and DC4 service operations (as well as Mr\'/Cr).
The DCMF will in this configuration relay the complete SCTP association
payload as is, between the UE and the DC Application Server, hereby requiring
the DC Application Server to allocate an SCTP Association media resource.
{width="4.50625in" height="2.089583333333333in"}
Figure 6.20.1.2.2-2: DCMF Mb -- MDC2 \"Transparent Relay Mode\" Media
Configuration for Application DC
Figures 6.20.1.2.2-3 below depicts an example that the DCMF \"HTTP Proxy\"
configuration available for the DCSF when instructing the DCMF to relay
application data channel media between the Mb and MDC2 towards a DC
Application Server providing a P2A/A2P HTTP DC application. The downloaded DC
application will in this case communicate with the DC Application Server,
using basic HTTP., within the same bootstrap SCTP association as in which this
application was downloaded. UDP, TCP and SCTP should be supported as the
transport layer protocols for MDC2.
NOTE 1: The protocol used within the application data channel is out of scope
of 3GPP.
{width="4.638888888888889in" height="2.373611111111111in"}
Figure 6.20.1.2.2-3: DCMF Mb -- MDC2 \"HTTP Proxy\" Media Configurations for
Application DC
NOTE 2: Enhanced MRF supports the same functionality as DCMF in Figure
6.20.1.2.2-1, 2, and 3.
### 6.20.2 Procedures
#### 6.20.2.1 NF service registration and discovery
If NRF is used for NF registration and discovery, the DCSF, DCMF/ MRF and IMS
AS shall register their services at the NRF before providing services to
consumers.
The registration and discovery of DCSF, DCMF and IMS AS refers to solution #17
on top of existing procedures specified in TS 23 501 [2].
The registration and discovery of MRF refers to solution #14.
If NRF is not used for NF registration and discovery, the discovery of NF is
based on configurations. The IMS AS is configured with the contact information
for a DSCF. This may be the target DSCF instance, or the request could be
directed to the target DSCF instance to be used by the IMS AS for subsequent
interactions for the subject user.
#### 6.20.2.2 Session event notification
DSCF and IMS AS assume there is an implicit subscription to all IMS DC session
relevant events in IMS AS for every IMS user engaged in an IMS DC session. IMS
AS notifies the DSCF of all relevant IMS DC events requiring action from the
DCSF.
#### 6.20.2.3 UE initiated bootstrap data channel establishment
{width="6.676388888888889in" height="4.925in"}
Figure 6.20.2.3-1: UE Initiated Bootstrap Data Channel Establishment (1/2)
1\. UE#1 sends the SIP INVITE request with an initial SDP to AS, through
originating network P-CSCF and S-CSCF. The initial SDP contains offers for the
bootstrap data channel establishment requirement. In this example procedure,
SDP contains both bootstrap data channel offers for originating side and
terminating side.
NOTE 1: This SIP INVITE can also be a SIP re-INVITE performed after the
initial IMS audio session is setup.
NOTE 2: The trigger for a UE to initiate or not initiate a DC establishment
request is to be determined during the normative phase. One option is that
this trigger is left for UE implementation.
2\. IMS AS validates user subscription data to determine whether the DC Call
request should be triggered to DCSF.
If IMS AS determins that the DC call request needs to be sent to DCSF, the IMS
AS selects a DCSF for this user based on local configuration or discovery and
selection of a DCSF instance via NRF.
If the IMS AS determined that the DC call request need not sent to DCSF, or
DCSF decides that DC request is not allowed, the IMS AS proceeds with normal
IMS procedures to setup the MMTel session without performing DC bootstrapping.
NOTE 3: Based on local configuration the IMS-AS can decide whether the DC
bootstrap establishment proceeds or not.
3\. IMS AS notifies the DCSF the call event by sending
Nimsas_SessionEventControl_Notify (SessionEstablishmentRequestEvent,
CallingID, CalledID, SessionCase, SessionID, MediaInfoList) request to the
DCSF. IMS AS may provide information such as IMPU and location information of
UE#1 to the DCSF.
NOTE 4: Providing subscriber related information such as location information
to the DC Application Server or to the DCAR is not specified in Rel-18.
4\. After receiving the DC control request, the DCSF determines the policy
about how to process the bootstrap data channel establishment requirement
based on the related parameters in the DC control request and/or operator
strategy.
5\. Since the SessionEstablishmentRequestEvent indicates that served user
offered local bootstrap media, DCSF, based on its policies prepares
originating side MDC1 media information, as well as the terminating side MDC1
remote bootstrap media (targeting remote UE) for the DCMF.
6\. DCSF invokes the Nimsas_MediaControl_MediaInstruction (SessionID,
MediaInstructionSet) operation based on its policies instructing the IMS AS to
connectDCMF both for originating and terminating side.
7\. The IMS AS selects a DCMF based on local configuration or discovers and
selects a DCMF instance or enhanced MRF supporting DC media function via NRF.
8\. IMS AS invokes DCMF service to instruct DCMF to allocate a Mb resource to
terminate the media descriptor specified by the DCSF for the originating side.
For IMS AS to stand alone DCMF, DC2 is used to reserve data channel media
resources reserved based on DCSF media information created in step 5. If
enhanced MRF is used, IMS AS uses Mr\'/Cr to enhanced MRF to reserve data
channel media resources.
9\. IMS AS invokes DCMF service to instruct DCMF to allocate a Mb resource to
terminate the media specified by the DCSF for the terminating side. For IMS AS
to stand alone DCMF, DC2 is used to reserve data channel media resources based
on DCSF received in step 5. If enhanced MRF is used, IMS AS uses Mr\'/Cr to
enhanced MRF to reserve data channel media resources.
NOTE 5: The DCMF media resource allocation could be done with one or multiple
service invocations.
10\. IMS AS responds to MediaInstruction request received in step 6. The
response may include the atomic success of operation received by the IMS AS
and includes also media resource information.
11\. The DCSF stores the media resource information and responds to the Notify
Request received in step 3.
12-14. IMS AS sends the INVITE which includes the updated SDP offer adding
media information of DCMF or enhanced MRF to originating S-CSCF and then to
remote network side and UE#2. The SDP offer for bootstrap data channel to UE#2
will in this case be included.
{width="6.665277777777778in" height="6.692361111111111in"}
Figure 6.20.2.3-2: UE Initiated Bootstrap Data Channel Establishment (2/2)
15-17. UE#2 and terminating network returns an 18X response with SDP answer to
bootstrap DC to originating network. If the terminating network decides to
establish another bootstrap DC to UE#1 and UE#2, the corresponding data
channel media description is also included in SDP answer.
18\. IMS AS invokes DCMF service to instruct DCMF on data channel media
resource modification based on the SDP answer received from terminating
network. For IMS AS to stand alone DCMF, DC2 is used to reserve data channel
media resources. If enhanced MRF is used, IMS AS uses Mr\'/Cr to enhanced MRF
to modify data channel media resource.
19-20. The IMS AS modifies SDP answer for bootstrap data channels to UE#1 in
18X response which may include local bootstrap data channel to UE#1 and/or
remote bootstrap data channel to UE#1 and sends 18X response to S-CSCF and
P-CSCF.
21\. The originating network P-CSCF executes QoS procedure for bootstrap data
channel media based on the SDP answer information from the 18X response.
22\. P-CSCF returns the 18X response to UE#1.
23\. The PRACK and UPDATE negotiation between originating and terminating
network.
24-25. UE#2 and terminating network returns a 200 OK response.
26\. IMS AS notifies the successful session establishment event, with
Nimsas_SessionEventControl Notify (SessionEstablishmentSuccessEvent,
SessionID, MediaInfoList) to DCSF. IMS AS may provide information such as IMPU
and location information of UE#2 to the DCSF.
27\. The DCSF responds to the notification.
28-30. 200 OK forwarded to UE#1.
31\~32. The bootstrap data channels have been established between originating
DCMF or enhanced MRF and UE#1/UE#2. The UEs send application request messages
to DCMF or enhanced MRF via bootstrap data channel with its data channel
capabilities. The DCMF or enhanced MRF forwards the message to received media
point of DCSF. The DCSF provides the proper data channel applications to UE#1
and UE#2 based on their data channel capabilities through DCMF or enhanced
MRF.
33\. The bootstrap data channels have been established between terminating
DCMF or enhanced MRF and UE#1/UE#2. The data channel application is requested
and downloaded to UE#1 and UE#2 from terminating DCSF.
Editor\'s note: How the originating and terminating UEs download the same
application is FFS.
Editor\'s note: Whether the bootstrap DC can be established before step 30
(200 OK) is FFS.
34\. The subsequent procedures continue.
#### 6.20.2.4 UE initiated P2P application data channel establishment
{width="7.10625in" height="5.966666666666667in"}
Figure 6.20.2.4-1: UE Initiated P2P Application Data Channel Establishment
0\. IMS session and bootstrap data channel has been established. Data channel
applications have been downloaded to UE#1 and UE#2.
1\. UE#1 sends the SIP reINVITE request with an updated SDP to IMS AS, through
originating network P-CSCF and S-CSCF. The updated SDP contains the
established bootstrap data channel information, as well as the application
data channel establishment requirement which is indicated by stream ID (dcmap
value: greater than or equal to 1000), stream Label, etc.
2\. IMS AS validates user subscription data to determine whether the media
change request should be triggered to DCSF.
3\. IMS AS notifies via Nimsas_SessionEventControl_Notify (MediaChangeRequest
Event, SessionID, EventDirection, MediaInfoList) the DCSF of the media update
request event. IMS AS may provide information such as IMPU and location
information of UE#1 to the DCSF.
4\. After receiving the session event notification, the DCSF determines the
policy about how to process the application data channel establishment
requirement based on the related parameters in the notification and/or
operator strategy.
5\. DCSF determines (in this example) that the added application data channel
media of the offer takes UE#2 as target endpoint not requiring anchoring in
the local DCMF or enhanced MRF. If DCMF or enhanced MRF needs to anchor
application data channel, DCMF would have used the Nimsas_ MediaControl
service .
6\. DCSF responds to the notification received in step 3.
7-8. IMS AS sends the reINVITE to originating S-CSCF and then to remote
network side and UE#2.
9-11. UE#2 and terminating network returns a 200 OK response with SDP answer
for application DC to originating network.
Editor\'s note: It is FFS how UE#2 determines which DC application to use.
This needs to be discussed with SA WG4.
13\. If DCMF needs to anchor application data channel, IMS AS invokes DCMF
service to modify data channel media resource based on the SDP answer to
application DC. For IMS AS to stand alone DCMF, DC2 is used to modify data
channel media resources. If enhanced MRF is used, IMS AS uses Mr\'/Cr to
enhanced MRF to modify data channel media resource.
1412\. IMS AS notifies the successful data channel modification to DCSF. IMS
AS may provide information such as IMPU and location information of UE#2 to
the DCSF.
13\. DCSF responds to the notification.
14-15. The IMS AS sends 200 OK response to S-CSCF and P-CSCF.
16\. The originating network P-CSCF executes QoS procedure for application
data channel media based on the SDP answer information from the 200 OK
response.
17\. P-CSCF returns the 200 OK response to UE#1.
18\. UE#1 send ACK to the terminating network.
19\. The application data channel between UE#1 and UE#2 is established, in
this example, not anchored on DCMF/enhanced MRF.
#### 6.20.2.5 UE initiated P2A/A2P application data channel establishment
{width="6.6625in" height="5.481944444444444in"}
Figure 6.20.2.5-1: UE Initiated P2A/A2P Application Data Channel Establishment
0-3. Steps 0-3 of clause 6.20.2.3 applies.
4\. After receiving the session event notification, the DCSF determines the
policy about how to process the application data channel establishment
requirement based on the related parameters in the notification and/or
operator strategy.
5\. DCSF determines (in this example) that the added application data channel
media of the offer takes DC Application Server as target endpoint requiring
anchoring in the local DCMF or enhanced MRF. DCSF communicates with the DC
Application Server for DC resource control; and when application data channel
is established, DC application server will send/receive traffic to/from UE#1
through MDC2.
NOTE: Details on how the DCSF communicates with the DC Application Server via
DC4 is out of scope of Release 18.
6\. DCSF invokes Nimsas MediaControl service to instruct IMS AS to connect
media to DCMF including information on how to relay data channel media via the
MDC2 interface.
7\. IMS AS invokes DCMF service to instruct DCMF on Data Channel establishment
and data channel media resource reservation based on the DC media information
received from DCSF. For IMS AS to stand alone DCMF, DC2 is used to reserve
data channel media resources. If enhanced MRF is used, IMS AS uses Mr\'/Cr to
enhanced MRF to reserve data channel media resources.
8\. IMS AS notifies the MediaControl instruction control response to DCSF.
9\. The DCSF stores the media resource information and establishes MDC1
connections with DCMF or enhanced MRF for application DC traffic to UE#1 and
replies to the Nimsas notification request.
10-11. IMS AS sends the reINVITE which does not include the SDP offer for
application data channel to originating S-CSCF and then to remote network side
and UE#2.
12-14. UE#2 and terminating network returns a 200 OK response with SDP answer
for audio/video.
15\. IMS AS notifies the DCSF about the successful result of the
MediaChangeRequest event.
16\. DCSF replies to the notification.
17-18. The IMS AS includes SDP answer for application data channels to UE#1 in
200 OK response and sends 200 OK response to S-CSCF and P-CSCF.
19\. The originating network P-CSCF executes QoS procedure for application
data channel media based on the SDP answer information from the 200 OK
response.
20\. P-CSCF returns the 200 OK response to UE#1.
21\. UE#1 send ACK to the terminating network.
22\. The application data channel between UE#1 and DC Application Server is
established via DCMF or enhanced MRF. DCMF or enhanced MRF forwards data
channel traffic between UE#1 and DC Application Server based on MDC2 media
point information received in step 6.
#### 6.20.2.6 Replacing Root-URL in HTTP GET request from the UE
According to clause 6.2.10.1 of TS 26.114 [6], the UE can send a HTTP GET
Request for the root (\"/\") URL through the bootstrap data channel which is
replied with a data channel application describing the graphical user
interface and the logic needed to handle any further data channel usage beyond
the bootstrap data channel itself. The graphical user interface should be
subscriber specific e.g., it should only contain applications for which the
user has subscribed to and is authorized to use. To provide a subscriber
specific data channel application list via the bootstrap data channel, the
DCSF, when receiving call event notification including subscriber specific
information from the IMS AS, creates the URL identifying the graphical user
interface for this subscriber. The DCSF provides the URL via the IMS AS to the
DCMF or enhanced MRF during data channel media resource reservation for the
bootstrap data channel. The DCMF or enhanced MRF associate this URL with the
bootstrap data channel. Once the DCMF or enhanced MRF, acting as HTTP proxy,
receive a HTTP GET Request containing the root URL through the bootstrap data
channel, the DCMF or enhanced MRF replace the root URL in the HTTP GET Request
with the subscriber specific URL and forward the request to the DCSF for
downloading the subscriber specific graphical user interface.
### 6.20.3 Network Function Services
#### 6.20.3.1 DCMF Services
##### 6.20.3.1.1 General
The following table illustrates the DCMF Services and Service Operations.
Table 6.20.3.1.1-1: NF services provided by the DCMF
+----------------+----------------+----------------+----------------+ | NF service | Service | Operation | Example | | | Operations | Semantics | Consumer(s) | +----------------+----------------+----------------+----------------+ | Nd | Create | Re | IMS AS | | cmf_MediaReso | | quest/Response | | | urceManagement | | | | | | | | | | (MRM) | | | | +----------------+----------------+----------------+----------------+ | | Update | Re | IMS AS | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Delete | Re | IMS AS | | | | quest/Response | | +----------------+----------------+----------------+----------------+
NOTE: In this Release, the IMS AS supporting data channel is TAS.
##### 6.20.3.1.2 Ndcmf_MediaResourceManagement (MRM) service
##### 6.20.3.1.2.1 General {#general-4 .H6}
**Service description:** This service enables the DCMF to create, update and
delete media resources related to IMS Data Channel. The media resources
include Mb media resources and resources related to media path between DCMF
and DCSF.
##### 6.20.3.1.2.2 Ndcmf_MRM_Create service operation {#ndcmf_mrm_create-
service-operation .H6}
**Service operation name:** Ndcmf_MRM_Create
**Description:** The consumer NF requests the DCMF to create and reserve a
media resource to originate/terminate IMS Data Channel media flow.
**Inputs, Required:** DCMF media specification.
DCMF media specification includes remote media point information, i.e. IP
address, ports used by the DCMF to handle IMS Data Channel media flows towards
the DCSF. The DCMF media specification may also include information specifying
IMS data channel attributes to be offered by the DCMF in case the data channel
shall take the remote NW as target.**Inputs, Optional:** Mb media
specification, Replacement URL
Mb media specification includes media description information derived from m
line, c line and SDP parameters in the SDP offer/answer, for the Mb interface
required by the DCMF. If this parameter is omitted from the Create operation,
then this means that IMS AS requests DCMF to provide a Mb resource offer.
Replacement URL is the URL identifying the resource in DCSF, e.g. graphical
user interface, specific to a subscriber which provides the instruction of DC
applications to be requested and downloaded to the UE. The DCMF uses this URL
to replace the root URL in the HTTP GET Request from the UE.
**Outputs, Required:** Result indication, DCMF resource identity, Mb media
resource information.
DCMF resource identity uniquely identifies the media resource within the
producer instance. This identity shall be used as reference when updating or
deleting the created media resource.
Mb media resource information includes media flow information over Mb, e.g.
local IP address and ports, which is used by the consumer NF to generate SDP
offer or answer.
**Outputs, Optional:** DCSF media resource information.
DCSF media resource information includes local media point (IP address, port
number) on DCMF towards DCSF, which is forwarded to the DCSF by the consumer
NF.
NOTE: The details of media specifications and media resource information is
defined in normative work and also in stage 3.
##### 6.20.3.1.2.3 Ndcmf_MRM_Update service operation {#ndcmf_mrm_update-
service-operation .H6}
**Service operation name:** Ndcmf_MRM_Update
**Description:** The consumer NF requests the DCMF to update media resources.
**Inputs, Required:** DCMF resource identity.
DCMF resource identity specifies the media resource to be updated.
**Inputs, Optional:** Mb media specification, DCMF media specification.
Mb media specification includes updated media information for the Mb
interface.
DCMF media specification includes updated media information for the DCMF.
**Outputs, Required:** Result indication.
**Outputs, Optional:** Mb media resource information, DCSF media resource
information.
Mb media resource information includes modified Mb media resource information
if present.
DCSF media resource information includes modified DCSF media resource
information if present.
##### 6.20.3.1.2.4 Ndcmf_MRM_Delete service operation {#ndcmf_mrm_delete-
service-operation .H6}
**Service operation name:** Ndcmf_MRM_Delete
**Description:** The consumer NF requests the DCMF to delete media connections
of a media flow and release corresponding media resource.
**Inputs, Required:** DCMF resource identity.
DCMF resource identity specifies the media resource to be deleted.
**Inputs, Optional:** None.
**Outputs, Required:** Result indication.
**Outputs, Optional:** None.
### 6.5.3 Impacts on existing nodes and functionality
UE impacts:
\- The UE supports indicating its DC capability and discovery of network DC
capability;
\- The UE supports SDP negotiation enhancements for bootstrap data channel and
application data channel;
\- The UE supports data channel application request, downloading and DC media
handling.
P-CSCF impacts:
\- P-CSCF supports media resource reservation and modification for bootstrap
data channel and application data channel.
IMS AS impacts:
\- IMS AS supports service based discovery and selection of DCSF, DCMF and
enhanced MRF;
\- IMS AS supports call event notification to DCSF via DC1 interface;
\- IMS AS supports DC media management with DCMF via service based DC2
interface and to enhanced MRF via Mr\'/Cr interface.
NEF impacts:
\- Exposure for data channel capabilities.
MRF impacts:
\- MRF supports data channel media handling when enhanced with DC media
functionality.
NRF impacts:
\- NRF supports service based discovery and selection of DCSF, DCMF and
enhanced MRF.
## 6.21 Solution #21: Interworking between a DCMTSI client in terminal and an
MTSI client in terminal
### 6.21.1 Description
Some data channel use cases do not require interaction from both ends. For
example, in Real-time Sharing Screen use case specified in TR 22.873, only the
sharing party shares its mobile screen to other parties through data channel
supported by its DCMTSI client in terminal, and the other parties only need to
receive the sharing screen media stream, which could be transferred over video
media streams supported by all the MTSI client in terminals. Hence, if these
data channel services can be supported between a DCMTSI client in terminal and
an MTSI client in terminal, it would speed up the commercial deployment
process of IMS data channel.
This solution proposes a method to achieve the one-sided interactive
communication between a DCMTSI client in terminal and an MTSI client in
terminal.
#### 6.21.1.1 Network Function Description
##### 6.21.1.1.1 Data Channel Signaling Function (DCSF)
In addition to those functions defined in other solutions, the Data Channel
Signalling Function (DCSF) also need to provide:
\- Controls interworking between a DCMTSI client in terminal and an MTSI
client in terminal.
##### 6.21.1.1.2 Data Channel Media Function (DCMF)
In addition to those functions defined in other solutions, the Data Channel
Media Function (DCMF) also need to provide:
\- Supports of interworking between a DCMTSI client in terminal and an MTSI
client in terminal. That is, it supports to correlate application data
channels with video media streams, decapsulates data over the application data
channels from a DCMTSI client in terminal, encapsulates and sends these data
over video media streams to an MTSI client in terminal. It also includes
anchoring audio/video media streams.
### 6.21.2 Procedures
#### 6.21.2.1 Interworking between a DCMTSI client in terminal and an MTSI
client in terminal
The procedures described in this clause is applied to some data channel use
cases in which it\'s a video session and only unidirectional interaction is
needed between both UEs.
For example, in Real-time Sharing Screen use case, only UE A supports IMS data
channel and it establishes application data channels with the DCMF in its
local network and transfers its mobile screen data, including RTP stream and
RTCP stream, over the application data channels. The DCMF decapsulates RTP
data and RTCP data from the data channels, encapsulates and sends these data
through video media streams to UE B. Figure 6.21.2.1-1 depicts the workflow
below.
{width="6.6875in" height="0.5638888888888889in"}
Figure 6.21.2.1-1: Interworking between a DCMTSI client in terminal and an
MTSI client in terminal
Figure 6.21.2.1-2 demonstrates the procedure of UE-initiated bootstrap data
channel establishment between network A and UE A (a DCMTSI client in
terminal), while an IMS video call is established between UE A and UE B (an
MTSI client in terminal).
{width="6.6875in" height="3.8020833333333335in"}
Figure 6.21.2.1-2: Bootstrap data channel establishment procedure for
interworking between a DCMTSI client in terminal and an MTSI client in
terminal
1-8. UE A completes media negotiation with local network through
INVITE/18X/200 procedure and the dedicated bearer/QCI Flow of data channel is
created between UE A and its local network. Based the updated DC media
description information reported by the MMTel AS A, in which the port of
bootstrap data channel between the DCSF A and UE B is set zero, the DCSF A
knows that UE B or network B does not support IMS data channel.
NOTE: \"a=3gpp-qos-hint\" line in SDP is used to indicate specific loss and
latency characteristics desired by the data channel applications. As specified
in Annex A, clause A.20 of TS 29.214 [26] and Annex B, clause B.16 of TS
29.514 [27], the P-CSCF will provide the PCRF/PCF with the desired loss and
latency characteristics and the PCRF/PCF will map the data channel media in
SDP to an appropriate QoS.
9-11. After the precondition procedure is completed, UE A initiates SCTP
association and DTLS connection establishment procedures and establishes a
bootstrap data channel with the DCMF A. Then UE A retrieves the bootstrap
application and the data channel application list from the DCSF A. The data
channel application list may include all data channel applications or only
contain the data channel applications which can be workable for interworking
between a DCMTSI client in terminal and an MTSI client in terminal. If all
data channel applications are included in the list, the indications to the
applications which are workable for interworking should be sent to UE and
demonstrated to the user. The user downloads application e.g. Real-time Screen
Sharing application from the DCSF A. At the same time, the IMS video session
is connected and video stream is transferred between UE A and UE B.
After UE A retrieves Real-time Screen Sharing application from the DCSF A and
run the application, the following procedure shown in Figure 6.21.2.1-3 is
performed to transfer UE A\'s mobile screen data to UE B.
{width="6.685416666666667in" height="5.309722222222222in"}
Figure 6.21.2.1-3: Application channel establishment procedure for
interworking between a DCMTSI client in terminal and an MTSI client in
terminal
1\. UE A initiates a re-INVITE request to negotiate application data channel
media with the local network, in which two application data channels (stream
1000 and 1001) are contained. Stream 1000 is used to transfer video RTP stream
of screen shots sequence and stream 1001 is used to transfer RTCP stream.
2\. The MMTel AS A reports the media event of data channel the DCSF A.
3\. Based on the initial SDP O/A media negotiation, the DCSF A knows that UE B
or network B could not support IMS data channel. In addition to the App info
carried in the report from the MMTel AS A, the DCSF A could decide that it
need to start one-side data channel procedure in this IMS session. If the one-
side data channel procedure is not applied to this App, the DCSF A should
indicate the MMTel AS A to reject this re-INVITE request.
4\. The DCSF A send a Data Channel Control Request to the MMTel AS A and
indicates it to create two application data channels (stream 1000 and 1001).
5\. The MMTel AS A send a Media Resource Management Request to the DCMF to
allocate resource for two application data channels (stream 1000 and 1001).
6\. The DCSF A indicates the MMTel AS A to anchor the video media streams of
UE B to the DCMF A, then the MMTel AS A controls the DCMF A to allocate video
resource.
7-9. The MMTel AS A sends a re-INVITE request with the SDP offer for anchoring
the video media of UE B to the DCMF A. UE B returns 200 OK with its SDP
answer. Then the MMTel AS A sends ACK to UE B.
10-11. The MMTel AS A sends 200 OK for re-INVITE initiated by UE A and UE A
returns ACK.
12\. UE A initiates SCTP association and DTLS connection establishment
procedures and establishes two application data channels (stream 1000 and
1001) with the DCMF A.
13\. The MMTel AS A reports a Media Event to the DCSF A, and reports that
anchoring video stream is successful.
14\. The DCSF A indicates the MMTel AS A to continue the call process, then
the MMTel AS A controls the DCMF A to associate application data channel
stream 1001 and 1002 between UE A and the DCMF A with the allocated video
streams between UE B and the DCMF A.
Then the application data channels (stream 1001 and 1002) between the DCMF A
and UE A are associated with the RTP and RTCP video streams between the DCMF A
and UE B. The RTP and RTCP stream of UE A\'s screenshot sequence is received
by UE B from video streams.
### 6.21.3 Impacts on Existing Nodes and Functionality
#### 6.21.3.1 Impacts to existing nodes
This solution has some requirements on the existing IMS nodes below:
MMTel AS:
\- Support triggering media re-negotiation to anchor video media to the DCMF
according to the requests from the DCSF.
## 6.22 Solution #22: Application Data Channel establishment based on
application ID
### 6.22.1 Description
#### 6.22.1.1 Application Data Channel route selection
After bootstrap DCs are established for an IMS session, DCMTSI UEs may
download DC applications from the DC server and trigger the establishment of
DCs for the selected applications.
The DC Server may determine to establish application DCs based on the SDP
offer provided by DCMTSI UE with the following route selections:
\- Direct DC connection between UEs;
\- Anchoring the DCs in the DC Server (e.g. DCS-M, DCMF, MRF);
\- Forwarding DC streams to/from 3pty Web RTC Applications;
\- Forwarding DC streams to/from AR Server (or other Application Servers).
Based on the existing information in the SDP Offer specified in TS 26.114, the
DC Server is not able to know which application is going to be transferred in
the requested DC, and may not able to determine the proper traffic route
selection for the DC establishment.
When an DCMTSI UE sends an SDP Offer for the establishment of an application
DC, an optional information of the triggered DC Application ID is included in
the SDP Offer. The DC Server may check the traffic requirement of the specific
DC Application ID and determine the route selection for the DC establishment.
When multiple Application Data Channels with different route (e.g. P2P or P2A)
are supported in a DC application, additional information associated with the
DC application ID may be required to assist the route selection (e.g. P2P or
P2A) of each Data Channel.
NOTE: How to indicate the additional information associated with a DC
application ID offered and selected in SDP should be defined in CT1/SA4.
If the DC Application ID is not available in the SDP Offer, the DC Server may
determine the route selection based on MNOs policy (e.g., direct DC connection
between DCMTSI UEs).
Editor\'s note: Other ways to determine the route selection policy besides DC
Application ID and MNOs policies are FFS.
#### 6.22.1.2 Trigger of DC application downloading in the peer UE
Data transmission on data channels shall not start until there is confirmation
that both peers have downloaded the selected DC applications and instantiated
the corresponding data channels.
When an DCMTSI UE sends an SDP Offer for the establishment of an application
DC, an optional information of the triggered DC Application ID is included in
the SDP Offer. Upon receiving the DC Application ID, the peer UE checks the
availability of the DC application and may trigger the downloading of the same
DC application before sending the SDP Answer.
If the DC Application ID is not included in the SDP Offer, it is assumed that
the peer UE has already instantiated the DC application, e.g. the DC
application is pre-configured in the UE, or peer UE has downloaded all the
available DC applications from the DC Servers.
#### 6.22.1.3 Usage of DC Application ID
DC Application ID is used to uniquely identify a DC Application in the IMS
networks, which can be included in the SDP media description of DC as an
optional line to identify the association of DC with the serving application.
The DC Application ID may be specified as following options:
\- Allocated by IMS network provider, which may include following information:
\- PLMN ID (include MNC + MCC);
\- Data channel application providers (user or network provider);
\- DC Application Number, (allocated by the network provider);
\- DC Application Name (optional, human readable information).
\- URI/URL of the DC Application stored in the DC Server or DC Application
Depository.
\- Allocated by third party AF or HLOS, defined the same as in TS 23.503 [4].
The DC Application ID can be contained in SDP media description via specifying
a new attribute for DC Application ID.
Example of DC attributes for DC Application ID:
a=dcapp-id=\"DC Application #1\"
NOTE: How to indicate the application offered and selected in SDP should be
defined in CT WG1/SA WG4.
The DC Application ID is allocated by MNO or retrieved from DC Application
provider when the DC Application is uploaded to DC Server or DC Application
Repository.
DC Server may be configured with a DC Application profile associated with the
DC Application ID, which indicates the characteristic of the DC Application
(e.g. AR application) and traffic route policy for the DC control (e.g., UE to
UE connection, anchored in DC Server, FQDN of associated application server).
The allocated DC Application ID can be contained in the DC application package
or signalled to the UE when the DC application is downloaded in bootstrap DC.
When the UE initiating the DC for an application, the DC Application ID is
included in the SDP media description.
### 6.22.2 Procedures
Figure 6.22.2.1-1: Procedure of application DC establishment
0\. Bootstrap DCs are established for UE_A and UE_B. UE_A downloads the
selected DC application via bootstrap DC. The DC Application ID is obtained
when UE_A downloading the DC application.
1\. UE_A sends an SDP offer for the establishment of an application DC, which
may contain the DC Application ID in the SDP media description.
2\. Upon receiving the SDP Offer, IMS_AS sends a service request with the DC
Application ID to the signalling function of DChS for the creation of a DC .
If the DC application is a local application, the DChS determines the DC
control policy (e.g. traffic route) of the DC based on the associated DC
Application profile. If the DC creation request intends to open a remote
application from the UE, as specified in TS 26.114 [6], the DChS may reject
the DC creation request.
NOTE: If the DC Application ID is not available in the SDP Offer, the DC
Server may determine the route selection based on MNOs policy (e.g., direct DC
connection between DCMTSI UEs).
3\. The signalling function of DChS sends a service response with the DC
control policy to the IMS_AS.
4\. The IMS_AS requests Data Channel media function to allocates related media
resource for the DC, and may further establish media connection to Other_AS
(e.g., AR Application Server, 3rd party WebRTC Server).
5\. The SDP Offer with DC Application ID is sent to the terminating IMS_AS.
6\. The IMS_AS_B sends a service request to the signalling function of DChS_B
for the creation of the DC. When DCS_B finds the received DC Application ID is
not a local application, it determines not to anchor the data channel.
7\. The DChS_B sends a service response with the DC control policy.
8\. The SDP Offer with DC Application ID is sent to the UE_B. The user of
terminating UE decides to accept or reject to use the DC application which is
identified by the received DC Application ID/Name.
9\. If the user accepts the DC application, the terminating UE checks whether
the identified DC Application is instantiated. If not, the terminating UE
requests the downloading of the DC application via bootstrap DC. The UE also
need to associate the DC traffic with the identified DC application.
10\. UE_B returns 200 OK.
11\. The application DCs and corresponding media connections to Other_AS are
established according to the DC route configuration instruction from DChS.
### 6.22.3 Impacts on Existing Nodes and Functionality
DChS is enhanced to support:
\- Retrieving or allocating DC Application ID when a DC application is
provided and uploaded to the DC Application Repository. Retrieving and storing
the DC application profile in the DC Server.
\- Delivering the associated DC Application IDs when a UE downloading DC
applications.
\- Determining DC control policy according to the DC Application ID.
UE is enhanced to support following functionalities:
\- Adding DC Application ID in the SDP offer when initiating SDP negotiation
for the DC .
\- Triggering the downloading of identified DC Application via the bootstrap
DC.
\- Associating the DC traffic with the identified DC application.
## 6.23 Solution #23: UE capabilities detection for IMS DC applications
### 6.23.1 Description
This solution is proposed in order to address WT#5.1: Key Issue on enhancement
to support Data Channel usage in IMS networks.
IMS network or third party may provide variety of DC applications to the
DCMTSI UE, and each DC application may have different requirements for the UE
capabilities for its execution . At the same time, DCMTSI UE may support a
variety of capabilities that can be invoked by DC applications. Before a
DCMTSI UE is going to download a DC application, the UE or IMS network need to
check whether the required capabilities of the DC application can be supported
by the UE and to determine whether the DC application can be downloaded to the
UE.
As an example, SA WG4 defines media capabilities several 3GPP specifications:
\- TS 26.511 [29]: 5G Media Streaming (5GMS); Profiles, codecs and formats
\- TS 26.116 [30]: Television (TV) over 3GPP services; Video profiles
\- TS 26.117 [31]: 5G Media Streaming (5GMS); Speech and audio profiles
\- TS 26.118 [32]: Virtual Reality (VR) profiles for streaming applications
\- TS 26.119 [33] (under development in Rel-18): Media Capabilities for
Augmented Reality
The example of UE capabilities that might be used by DC applications may
include:
\- hardware capabilities, including
\- video encoding and decoding capabilities
\- audio encoding and decoding capabilities
\- other media capabilities such as haptics, etc.
\- support for multiple encoders/decoders in parallel
\- rendering capabilities
\- visual rendering capabilities, such as GPUs
\- audio rendering capabilities
\- Capturing capabilities
\- visual capturing capabilities, such as 2D and 3D cameras
\- audio rendering capabilities, such as microphones, arrays of microphones
\- Sensor and Tracking capabilities
\- Support for positioning
\- Support for pose recognition
\- Other AR Runtime capabilities
\- Storage (W/R)
\- Connectivity
\- 5G capabilities
\- Non 3GPP access networks, e.g. WiFi/BT.
NOTE 1: The definition of UE capabilities to be used by DC applications is out
of SA WG2 scope.
It is assumed when a DC application is uploaded to DC server, the required UE
capabilities are provided and stored in the manifest of the application. A DC
Bootstrap Application installed in the UE retrieves allowed DC application
lists from DC Servers and renders the list for user selection. The DC
Bootstrap Application is preconfigured in the UE or downloaded from DC server
via Bootstrap DC.
Following two options are proposed for UE capabilities negotiation:
\- Option A: the UE retrieves the allowed DC application lists including
required UE capabilities for each application from the DC Servers via
Bootstrap DC. The Bootstrap Application in the UE checks the application lists
against the UE capabilities. If the UE does not have needed capabilities, the
corresponding DC application will not be shown/enabled for such UE.
\- Option B: when retrieving the DC application list, the Bootstrap
Application in the UE sends its capabilities to the DC Server via Bootstrap
DC. The DC Server checks the application lists against the UE capabilities. If
the UE does not have needed capabilities, the corresponding DC application
will be removed from the application list. The validated DC application list
is sent to the UE.
NOTE 2: Both options A and B are over-the-top solutions and have no impacts to
3GPP defined architectures and procedures.
### 6.23.2 Procedures
{width="6.621527777777778in" height="4.009027777777778in"}
Figure 6.23.2-1: Detection of UE capabilities for DC applications
1\. In an MMTel session, the bootstrap data channels are established between
UEs and the DC Server.
2-3. UE downloads via bootstrap DC a Bootstrap Application (or pre-configured
in the UE).
4\. Option A: the UE-A retrieves an allowed DC application list from DC Server
via bootstrap channel, including capability/resource needed for each
applications.
Option B: the UE-A sends its capabilities to the DC Server via Bootstrap DC.
The DC Server checks the applications against UE capabilities, and response
with a refined DC application list.
5\. Same procedure as step 4 for UE-B.
NOTE: For option B, the DC Server may take into account the capabilities
received in steps 4a and 5a to derive a common application list for both UE-A
and UE-B before performs steps 4b and 5b.
6\. (Only applies for option A) The Bootstrap Application in the UE refines
the DC application list against the UE capabilities. If UE does not have
needed capabilities, the corresponding DC application may be removed from the
application list.
7\. The Bootstrap Application displays the supported DC application list in
the UE-A for user selection.
8-9. Same procedures as steps 6-7 for UE_B.
10\. The UE triggers the establishment of Application DC upon user selection.
# 7 Overall Evaluation
## 7.1 Evaluation on Key Issue #1
### 7.1.1 Architecture and procedure enhancements
Solution #1, #2, #3, #6, #7 and #16 have proposed architecture and procedure
enhancements on how IMS network supports data channel. The evaluation is as
follows:
**Solution #1:**
This solution is proposed only for A2P/P2A scenario. It supports split of DC
control function and media function with two options to control DC media
function:
\- Option 1: DC media function is standalone and is controlled by DC control
function, which requires DC control function directly controlling the media
resource of DC.
\- Option 2: DC media function is integrated in MRF and is controlled by DC
control function via IMS AS. DC control function does not directly control the
media resource of DC.
\- The subscribe/notify pattern is used for DC event notification from IMS AS
to DC control function, which requires DC control function subscribing to all
IMS AS.
**Solution #2:**
This solution enhances IMS AS to be the DC control function, which makes
decision of DC and control DC server to manage DC media resource.
\- The DC server further control MRF via service based interface for media
resource management.
**Solution #3:**
This solution supports split of DC control function and media function by
introducing DCS-C for DC control and DCS-M for media control.
\- The subscribe/notify pattern is used for DC event notification from IMS AS
to DC control function, which requires DCS-C subscribing to all IMS AS.
\- DCS-C makes decision of DC usage and controls DCS-M for DC resource
management via IMS AS. DCS-C does not directly control the media resource of
DC.
**Solution #6:**
This solution is similar to solution #3. It supports split of DC control
function and media function by introducing DCSF and DCMF.
\- The IMS AS reports DC event to DCSF with request/response pattern.
\- DCSF makes decision of DC usage and controls DCMF for DC resource
management via IMS AS. DCSF does not directly control the media resource of
DC.
**Solution #7:**
This solution supports split of DC control function and media function.
\- The IMS AS reports DC event to DC control function with request/response
pattern.
\- DC media function is controlled by DC control function, which requires DC
control function directly controlling the media resource of DC.
**Solution #16:**
This solution introduces DCSF as DC control function and enhances MRF to
support DC media function.
\- The IMS AS reports DC event to DCSF with request/response pattern.
\- DCSF makes decision of DC usage and controls DCMF for DC resource
management via IMS AS. DCSF does not directly control the media resource of
DC.
**Solution #18:**
This solution introduces the procedure for negotiation of the data channel
application(s) used in the call between UEs.
\- The user of terminating UE has the capability to decide whether to use the
data channel application(s) selected by initiating UE before downloading the
data channel application(s).
**Solution #20:**
This is a merged solution trying to produce a joint proposal based on the
existing solutions for KI #1.
\- The architecture separates signalling function and media function
supporting Data Channel. A new service based function, Data Channel Signalling
Function (DCSF), is introduced. For media function supporting Data Channel, 2
options are proposed: enhanced MRF, or a new service based function called
Data Channel Media Function (DCMF).
\- The procedures for UE initiated bootstrap DC establishment, UE initiated
application DC establishment for P2P and P2A/A2P usage are described.
\- The IMS AS selects the DCSF and also gets the notification endpoint of the
DCSF for DC event notification, either via local configuration or via NRF. The
interaction between IMS AS, DCSF and DCMF uses service based interfaces.
**Solution #21:**
This solution proposes using DCSF/DCMF to support interactive communication
between a DCMTSI client and an MTSI client.
\- The procedures of bootstrap DC and application DC establishment for
interworking between a DCMTSI client and an MTSI client are described.
\- The DCMF decapsulates RTP/RTCP data from the data channels connected to
DCMTSI client, then encapsulates and sends these data through video media
streams to MTSI client.
**Solution #22:**
This solution introduces DC Application ID contained in SDP to identify the
association of DC with the serving application, when an DCMTSI UE sends an SDP
Offer for the establishment of an application DC.
\- The DC Server may check the traffic requirements against the DC Application
ID and determine the route selection for the DC establishment.
\- Upon receiving the DC Application ID, the peer UE checks the availability
of the DC application and may trigger the downloading of the same DC
application before sending SDP Answer if the user accepts to use it in the
call.
### 7.1.2 DC capability discovery
Solution #4, #5 and #23 propose solutions on how to define DC capabilities and
how the capability of supporting DC is mutually discovered between network and
UE. The evaluation is as follows:
**Solution #4:**
The networks discover UE DC capability as follows:
\- The home network discovers UE DC capability based on +sip.app-subtype media
feature tag in Register request as specified in TS 24.229 [8].
\- The remote network discovers UE DC capability based on +sip.app-subtype
media feature tag in initial INVITE request or 18X/200 OK response as
specified in TS 24.229 [8].
The UE discovers network capability as follows:
\- The UE discovers DC capability of home network based on Feature-Caps header
in 200 OK to Register request as specified in TS 24.229 [8].
\- The UE discovers DC capability of remote network according to whether the
SDP info for DC is included.
**Solution #5:**
This solution proposes two types of DC capability, one of which is indication
of whether UE or network supports DC, the other is the detailed capabilities
of supporting DC.
For indication of whether UE or network supports DC:
\- The home network discovers UE DC capability based on +sip.app-subtype media
feature tag in Register request as specified in TS 24.229 [8].
\- The network includes an indication of whether the UE is allowed to use IMS
Data Channel in the 200 OK response for Registration request.
For the detailed capabilities of supporting DC, there are 3 options to
transfer the capabilities from UE to network:
\- Option 1: report of IMS Data Channel capabilities in SIP Register request
via IMS registration procedure;
\- Option 2: report of IMS Data Channel capabilities via bootstrap DC when the
UE requests Data Channel applications;
\- Option 3: report of IMS Data Channel capabilities in SIP INVITE/reINVITE
request when the UE establishment the bootstrap data channel.
Option 1 and option 3 may need stage 3 standardization, while option 2 is on
application level that can be implementation specific.
**Solution #23:**
This solution proposes two options for UE capability negotiation:
\- Option A: the UE retrieves the allowed DC application lists including
required UE capabilities for each application from the DC Server (DCSF) via
the Bootstrap DC. If the UE does not have needed capabilities, the
corresponding DC application will not be shown/enabled for such a UE.
\- Option B: when retrieving the DC application list, the Bootstrap
Application in the UE sends its capabilities to the DC Server (DCSF) via the
Bootstrap DC. The DC Server checks the application list against the UE
capabilities. The validated DC application list is replied to the UE.
NOTE: Both options do not require any normative changes in 3GPP
specifications.
## 7.2 Evaluation on Key Issue #2
For Key Issue #2, the following solutions are proposed:
\- Solution#8 mainly proposes the following:
\- The data channel could be used to transfer the AR specific data during the
session for some AR telephony communication; and UE renders AR content based
on these specific data. The solution does not suggest specific IMS
architecture enhancements to support AR telephony communications.
\- For supporting AR telephony communication service based on data channel,
the high-level 3 phase procedures are described which include: procedures of
normal multimedia part of AR telephony communication, procedures of bootstrap
DC establishment and application acquirement, and procedures of application DC
establishment and data exchange for AR telephony communication.
\- Solution#9 mainly proposes the following:
\- Besides being based on the data channel architecture, this solution defines
two specialised network functions to enable network rendering: the AR
Application Server NF which includes AR media rendering negotiation and AR
service handling; and the AR Media Function NF.
\- For terminal rendering process, it uses the same procedure as described in
Solution#8.
\- For network rendering process, IMS performs AR media rendering based on AR
media received from the calling or the called users, and then IMS sends
rendered AR media using normal audio/video streams through RTP channel to the
calling or called user. The partial media rendering by splitting the rendering
tasks between terminal and network is also described.
NOTE: Alignment is required with SA4 for the network rendering procedures as
it provides the media negotiation procedures.
## 7.3 Evaluation on Key Issue #3
Five solutions were proposed for KI#3: #10, #11, #12, #13, #19.
Three solutions refer explicitly to STIR/SHAKEN: #10, #12, #19.
One solution refers to signing and verification of SIP headers but does not
mention STIR/SHAKEN explicitly: #11
In the following table solutions are classified based on following categories
(Y=YES, N=NO, more details in brackets):
\- Solution is applicable to UNI (SIP UA) and NNI (IP PBX) case
\- Solution re-uses STIR/SHAKEN framework and related IETF RFCs/drafts
\- Solutions is impacting existing IMS procedures (e.g., SIP headers)
\- Solutions requires new/adapted function(s) in the IMS
\- Solution requires new/adapted function(s) in the Enterprise network
Table 7.3-1
* * *
                                                                                                                          Applicable to UEs connected via UNI and NNI (IP PBX)     Re-use of STIR/SHAKEN              Impact to existing IMS procedures                                                                                           Requires new/adapted functions in the IMS        Requires new/adapted functions in the enterprise
Solution #10: Support of Third Party specific User Identities in IMS re-using
the Ms reference point and STIR/SHAKEN Y Y Y (new/changed SIP headers) N N
(signing in enterprise network is based on SLA with IMS provider) Solution
#11: Verification of calling party when using third party specific identity Y
(requires group data in HSS) Y (but not explicitly mentioned) Y (new/changed
SIP headers, third party creating group subscription in HSS) N N Solution #12:
Solution of SHAKEN based third-party specific user identities Y (different
solutions for UNI and NNI) Y Y (requires a token based authentication
mechanism between enterprise and IMS in case of UNI, no token used for NNI
case) N Y (requires 3rd party AAA server in the enterprise) Solution #13:
third party specific user identities Y N Y (requires a token based
authentication mechanism between enterprise and IMS) Y (requires Enterprise
Data Server in the IMS) Y (requires auth server in the enterprise Solution
#19: Light weight solution of third party specific ID using existing
mechanisms N (requires HSS subscription for each enterprise user) Y Y (changed
From header) N N
* * *
## 7.4 Evaluation on Key Issue #4
Solution #14, #15 and #17 are related to KI#4. The evaluation is as follows:
**\- Solution #14**
This solution proposes extending existing NRF services to support registration
and discovery of MRF which supports both legacy and new capabilities. New
media capabilities are defined and used for MRF registration and selection.
The solution supports both integrated MRF and distributed MRFC/MRFP.
**\- Solution #15**
This solution proposes a service based framework of IMS media plane.
It introduces concept of Media plane network function service (NFS) and
Unified Media Function (UMF), by which the functionalities of IMS network
entities are dissembled as NFS and are requested from UMF by consumer NFs.
The registration of UMF and media capability discovery is based on NRF
enhancements.
In this release, UMF only supports functionality of IMS-AGW.
**\- Solution #17**
This solution proposes extending existing NRF services to support registration
and discovery of DCMF. The media capabilities of DCMF are referring to
solution #14 and used for DCMF registration and selection.
# 8 Deployment Guideline
Editor\'s note: This clause captures deployment guidelines for typical edge
computing use cases.
# 9 Conclusions
## 9.1 Conclusions of Key Issue #1
The following conclusions are agreed for IMS DC architecture:
\- The data channels shall be established in the context of an IMS MMTel
session. Standalone data channels without accompanying media in an IMS MMTel
session are not supported in this Release.
\- The signalling function and media function supporting Data Channel are
logically separated from each other.
\- To fulfil different requirements of IMS migration to support DC, the DC
media function can be provided by enhancing the existing IMS MRF reusing
Mr\'/Cr interface to the IMS AS or by a new service based function supporting
a new SBA interface to the IMS AS. The architectures of IMS supporting Data
Channel for both options are specified in solution #20 and are used as the
basis for normative work.
\- DCSF and DCMF registration, discovery and selection follows SBA principles
as outlined in Solution #17. DCSF and DCMF profiles are being defined during
normative phase.
NOTE 1: It is still to be decided whether a single DCSF will be used for IMS
AS discovery or more than a single DSCF can be used depending on the DCSF
Registration in NRF.
NOTE 2: Other information used in DCSF registration and for DCSF discovery is
specified during normative work.
\- The signalling function supporting Data Channel interacts with IMS AS for
call event notification and management of data channel media. Such interaction
is based on service based interface principles. Solution #20 is used as basis
for normative work related to interactions between IMS AS And DC signalling
function.
\- The signalling function is not involved in SIP/SDP negotiation.
\- IMS AS exclusively controls media resources for data channel purposes.
\- The IMS AS interacts with media function supporting Data Channel for data
channel resource management. Solution #20 is used as basis for normative work
related to interactions between IMS AS and DC media function.
\- Both, the UDP proxy and HTTP proxy media configurations for DCMF/enhanced
MRF shall be specified.
\- The DCSF shall provide a URL during bootstrap data channel establishment to
the DCMF or enhanced MRF via the IMS AS that allows to download a subscriber
specific graphical user interface to the UE via the bootstrap data channel.
The DCMF or enhanced MRF, acting as HTTP proxy, when receiving a HTTP GET
Request containing the root URL through the bootstrap data channel from the
UE, shall replace the root URL in the HTTP GET Request with the subscriber
specific URL that was received from the DCSF.
\- The application data channel protocol is out of scope of 3GPP.
\- The DCAR can be integrated in the signalling function supporting Data
Channel or deployed standalone. In either case, the interface to DCAR and its
functionality is out of scope of 3GPP and hence is not specified.
\- The interaction between the signalling function supporting Data Channel and
NEF is not standardized in this release.
The following interim conclusions are agreed for IMS DC capability discovery:
\- The network discovers the UE support of DC based on existing mechanism as
specified in TS 26.114 [6] and TS 24.229 [8].
\- The UE discovers home network support for DC via the Feature-Caps header
field in 200 OK during registration, as specified in solution #4.
\- The discovery of UE capabilities required to use data channel applications
is done via application level communication through the bootstrap data channel
and is transparent to IMS.
NOTE 3: UE capabilities exchange through the bootstrap data channel is an
optional feature and out of scope of 3GPP. Whether a high-level description of
this feature is required in a technical specification will be decided during
normative phase.
The following conclusions are agreed for IMS application DC establishment:
\- Information for the binding of DC Application with the related DC is
required to support multiple, simultaneous DC applications in a UE. The UE is
aware of the binding information, (e.g., DC Application ID as specified in
solution #22) from Bootstrap DC. The binding information is sent from UE in
SDP to assist DC route selection in the DC server and synchronize the DC
application used in the call with peer UE(s).
NOTE 4: In normative phase, the definition of the binding information needs to
be aligned with the future specification of SA WG4.
When a UE is connected via 3GPP access and the use of mobile data is
deactivated, the feature \"IMS data channel\" is not available via 3GPP access
in Rel-18.
NOTE 5: No further work is required during normative phase on the data off
aspect.
## 9.2 Conclusions of Key Issue #2
The following conclusions are agreed for supporting AR telephony
communication:
\- The data channel architecture is used as baseline to support AR telephony
communication. If the UE needs network support for media rendering, the
architecture and procedures specified in Solution #9 are used. Otherwise, if
the UE can perform the media rendering without network support, the procedures
as specified in Solution #8 are taken as baseline for terminal rendering
process.
NOTE: The media negotiation for network supported rendering between the UE and
the network will be specified in SA WG4.
## 9.3 Conclusions of Key Issue #3
Five solutions were proposed for KI#3 (sol #10, #11, #12, #13, #19). Out of
these, three solutions refer explicitly to STIR/SHAKEN (sol #10, #12, #19)
while one solution refers to signing and verification of SIP headers but does
not mention STIR/SHAKEN explicitly (sol #11).
It is concluded that KI#3 will not progress for normative work in Rel-18.
## 9.4 Conclusions of Key Issue #4
The following conclusions are agreed for service based IMS media control
interfaces:
\- The 5G service registration, discovery and selection applies to the MRF.
The MRF profile is to be defined during normative work.
\- Baseline for defining service based principles for MRF is solution #14.
###### ### Annex A: IMS AS Services
This Annex provides a subset of the services required to support the DCMF
architectures depicted in clause 6.20.1.2.2. It is not intended to be
complete.
# A.1 General
The following table shows the IMS AS Services and IMS AS Service Operations.
Table A1-1: NF services provided by the IMS AS
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer(s) | | | | Semantics | | +----------------+----------------+----------------+----------------+ | Nimsas_Sessi | **Subscribe | Su | DCSF | | onEventControl | (currently not | bscribe/Notify | | | | used)** | | | +----------------+----------------+----------------+----------------+ | | **Notify** | Su | DCSF | | | | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | Nimsas | Me | Re | DCSF | | _MediaControl | diaInstruction | quest/Response | | +----------------+----------------+----------------+----------------+
# A.2 Nimsas_SessionEventControl Service
## A.2.1 General
**Service description:** This service enables the consumer to be notified and
take part in session events when served IMS subscribers takes part in IMS
sessions.
The following operations are available for this service:
\- Notifying IMS session control events of a specific IMS subscriber to NFs.
This service operation reports the event to the consumer that has subscribed
implicitly via configuration in the IMS AS.
## A.2.2 Nimsas_SessionEventControl_Notify service operation
**Service operation name:** Nimsas_SessionEventControl_Notify
**Description:** This service operation enables IMS AS to notify consumers of
session events related to a specific served IMS subscriber requesting IMS data
channel.
**Inputs, Required:** SessionID, EventID,
**Inputs, Optional:** CallingID, CalledID, SessionCase, MediaInfoList
CallingID is the calling subscriber.
CalledID is the called Subscriber
SessionCase indicates if this is an originating or terminating session.
EventInitiator indicates initiator of the event, i.e. \'served user\' vs
\'remote user\'.
MediaInfoList includes for each media in the list; media ID which uniquely
identifies this media item within the list, media specification, which is
dependent on media type, and includes relevant attributes e.g dcmap.
**Outputs, Required:** Result indication.
**Outputs, Optional:** None
The table below is a subset of events and related information.
Table A.2.2-1 : subset for List of events and Related Optional parameters
* * *
EventID Parameters SessionEstablishmentRequestEvent CallingID, CalledID,
SessionCase, MediaInfoList SessionEstablishmentProgressEvent MediaInfoList
SessionEstablishmentAlertingEvent MediaInfoList
SessionEstablishmentSuccessEvent MediaInfoList
SessionEstablishmentFailureEvent  
MediaChangeRequestEvent. EventInitiator, MediaInfoList MediaChangeSuccessEvent
MediaInfoList MediaChangeFailureEvent MediaInfoList SessionTerminationEvent
SessionCase
* * *
# A.3 Nimsas_MediaControl Service
## A.3.1 General
**Service description:** This service enables the consumer to control IMS AS
handling of media within an IMS session. The service is used before responding
to a Nimsas_SessionEventControl_Notity request.
## A.3.2 Nimsas_MediaControl_MediaInstruction service operation
**Service operation name:** Nimsas_MediaControl_MediaInstruction
**Description:** This operation provides instructions to the IMS AS for all
the media a consumer requires based on its policies for the received session
event, and that may require resource reservation in DCMF or enhanced MRF.
There will be separate entry for every media that includes the complete media
specification required by DCMF to provide interworking between Mb and
MDC1/MDC2 interfaces.
This enables establishing an end-to-end media path for the required bootstrap
channels by the originating or terminating end in the originating network, as
well as originating or terminating end from the terminating network.
Additionally, it enables establishing the end-to-end media path for the
application data channels for peer-to-peer communication, peer to network and
vice versa
**Inputs, Required:** SessionID, MediaInstructionSet
MediaInstructionSet includes a set of instructions for each media. Each
instruction includes:
\'mediaID\' used by the IMS AS and the DSCF for referencing purposes. The
consumer reuses the mediaID it received from the IMS AS for referencing the
same media.
\'mediaInstruction\' instructing the IMS AS for handling the media, examples
are connectDCMF, disconnectDCMF filtermedia, etc.
\'mediaInstructionData\' includes instruction dependent data intended for
consumption by the DCMF or enhanced MRF.**Inputs, Conditional:** None.
**Inputs, Optional:** CallingID, CalledID, **Replacement URL** to retrieve
application list via the bootstrap DC
**Outputs, Required:** Atomic operation result indication
**Outputs, Optional:** mediaResourceInformation
#