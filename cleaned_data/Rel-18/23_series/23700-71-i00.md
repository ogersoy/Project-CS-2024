# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The scope of this Technical Report is to study further enhancements to the to
the 5GC LoCation Services including the following aspects:
\- Investigate potential architectural enhancements to location service (e.g.
in scenarios like edge computing, and other), i.e. support Positioning
Signalling via user plane.
\- Investigate potential architectural enhancements to location service (e.g.
in scenarios like edge computing, and other), i.e. reduction of location
service latency, signalling overhead and location estimate exposure.
\- Study how the location services can benefit from NWDAF reporting and how
the NWDAF use cases can benefit from location services, e.g. enhanced accuracy
in certain UE location or population flow statistics data that require UE
locations smaller than TA/cell
\- Study enhancements to support low power positioning (e.g. for RedCap)
including the requirements related to low power high accuracy positioning
described in TS 22.104 [7].
\- Study necessary enhancement to support regulatory requirement i.e. the
network should not notify the UE by any means during the LCS session.
\- Study enhancement to support the Flexible and Efficient Periodic and
Triggered Location for UE power saving purpose.
\- In collaboration with RAN, study specific network functionality related to
use of Positioning Reference Units (PRUs) as defined by RAN WGs and study how
5GS to support a specific UE (i.e. Reference UE) to improve the accuracy of
positioning, and reduce the signalling:
\- Study enhancements to support the location service continuity for UE
mobility, i.e. between EPS and 5GS;
\- For 5G with satellite access, in collaboration with RAN, study LCS
architectural enhancement to support network verified UE location, and to meet
location services related requirements defined in TS 22.261 [8].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.271: \"Functional stage 2 description of Location Services
(LCS)\".
[5] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".
[6] 3GPP TS 38.305: \"Stage 2 functional specification of User Equipment (UE)
positioning in NG-RAN\".
[7] 3GPP TS 22.104: \"Service requirements for cyber-physical control
applications in vertical domains\".
[8] 3GPP TS 22.261: \"Service requirements for the 5G system\".
[9] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support
network data analytics services\".
[10] 3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\".
[11] S3i210282: \"LS OUT on UE location aspects in NTN\"
https://www.3gpp.org/ftp/TSG_SA/WG3_Security/TSGS3_LI/2021_81e-a/Docs/s3i210282.zip.
[12] RP-213690: \"New WI: NR NTN (Non-Terrestrial Networks) enhancements\".
[13] OMA-AD-SUPL-V2_0: \"Secure User Plane Location Architecture Approved
Version 2.0\".
[14] OMA-TS-ULP-V2_0_6: \"User Plane Location Protocol Approved Version
2.0.6\".
[15] 3GPP TS 37.355: \"LTE Positioning Protocol (LPP)\".
[16] 3GPP TS 23.503: \"Policy and charging control framework for the 5G System
(5GS); Stage 2\".
[17] 3GPP TR 23.700‑81: \"Study on Enablers for Network Automation for 5G;
Phase 3\".
[18] 3GPP TS 22.071: \"Location Services (LCS); Service description; Stage
1\".
[19] 3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System
(5GS)\".
[20] IETF RFC 5246: \"The Transport Layer Security (TLS) Protocol Version
1.2\".
[21] 3GPP TS 24.080: \"Supplementary services specification; Formats and
coding\".
[22] 3GPP TS 38.300: \"NR; NR and NG-RAN Overall description; Stage-2\".
[23] 3GPP TR 23.700‑86: \"Study on Architecture Enhancement to support Ranging
based services and sidelink positioning\".
[24] 3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs;
Stage 3\".
[25] 3GPP TS 38.423: \"NG-RAN; Xn Application Protocol (XnAP)\".
[26] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
**Positioning Reference Unit (PRU):** As defined in TS 38.305 [6].
**Reference UE:** A UE **with a location assumed known to the network that
can** obtain location related information **of one or more target UE(s), which
may** assist the network to improve the positioning performance of target
UE(s). In this technical report, the Reference UE is the PRU and the location
related information is the measurements provided by PRU.
NOTE: Within the FS_eLCS_ph3 study and this TR, the Reference UE has no
relationship with other Studies, e.g. FS_Ranging_SL, unless clearly mentioned.
If a terminology alignment between studies is required, it will be done before
starting normative work.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
EASDF Edge Application Server Discovery Function
EDC Edge DNS Client
FQDN Fully Qualified Domain Name
LCS LoCation Service
LCUP LCs User Plane
LMF Location Management Function
LPP LTE Positioning Protocol
LPPe LPP extension
NPN Non-Public Network
NWDAF Network Data Analytics Function
PRU Positioning Reference Unit
TAI Tracking Area Identity
ULI User Location Information
URSP UE Route Selection Policy
# 4 Architectural Assumptions and Requirements
## 4.1 Architecture assumptions
The existing 5G LCS architecture is the bases for further enhancement work,
with following add on assumption:
\- Positioning methods may be Access Network specific, although commonalties
should be encouraged between Access Networks.
## 4.2 Architecture requirements
The following requirements are applicable to further enhance the existing 5GC
LCS architecture defined in TS 23.273 [5]:
\- The further enhancement to the 5GC LCS architecture should incorporate
flexible modular components with open interfaces that facilitate equipment
interoperability and the architectural requirements based on evolution of
service providing capabilities.
\- The further enhancement to the 5GC LCS architecture should be future proof.
# 5 Key Issues
## 5.1 Key Issue #1: Architectural Enhancement to support User Plane
positioning
### 5.1.1 Introduction
The key target of this KI is to identify the LCS features and enhancements
required to support user plane positioning.
Positioning Signalling via user plane has several benefits, such as:
\- It has a more efficient communication overload with a direct connection
from LCS server to UE.
\- It may not require gNodeB, AMF, LMF signalling processing of RRC, NG-AP and
HTTP/2 protocol stacks. A single session may handle all the transactions.
\- It can have multiple choices depending on UE support. For example, both
3GPP LPP and OMA LPPe can be possible in positioning methods\' choices.
To deploy user plane positioning, it involves the following considerations:
\- Different use cases like emergency/non-emergency, other regulatory cases
like lawful interception and MO-LR cases, etc.
\- Different deployment options including centrally deployed or local
deployment ,i.e, deployed the edge data network.
\- Whether the solution is end to end or restricted to only certain entities
(e.g. UE and LMF, LMF and LCS Client).
For user plane positioning deployment, two options are identified, although
other options are also possible:
Option 1: User plane positioning functionality (e.g. LMF) in the central
network.
Option 2: The user plane positioning functionality can be deployed \"in
scenarios like edge computing\" of the edge data network to provide
positioning in the edge and fits into the architecture in TS 23.548 [10].
This KI is to address architectural changes allowing user plane positioning
deployment, including central deployment or deployment at the edge e.g.:
\- Discovery of user plane capability and configuration and selection of PDU
Sessions (if needed) to be used for the communication between UE and user
plane positioning.
\- Whether and how to enhance existing 5GS LCS architecture or related
procedures to support MO-LR, MT-LR, Deferred MT-LR and regulatory-related
positioning procedures when user plane positioning is involved.
\- Interaction with legacy LCS call flows and security aspect.
\- Requirements on transport protocol e.g. if reliable transport and in
sequence delivery is required.
\- Interaction (if any) between user plane and existing control plane
solution.
\- User plane as a possible enhancement to control plane.
## 5.2 Key Issue #2: enhanced positioning architecture for NPN deployment
### 5.2.1 Description
For NPN network deployments, the following technical issues will be studied:
\- How to realize low latency positioning procedure under NPN deployment.
\- How to realize low complexity positioning procedure under NPN deployment.
\- How to achieve reliable and secure location result delivery and exposure,
e.g. UE location not exposed to the public network.
## 5.3 Key Issue #3: Local Area Restriction for an LMF and GMLC
### 5.3.1 Description
In some scenarios, an GMLC and an LMF might be restricted to supporting
location services in a local area, i.e. the LMF needs to be selected within
the same local area of the GMLC. The objective of this KI is to investigate
how to support the local area restriction for GMLC and LMF.
NOTE: This KI is not applicable to an NPN.
## 5.4 Key Issue #4: Interaction between Location Service and NWDAF
### 5.4.1 Description
NWDAF can generate different analytics data, e.g. UE mobility analytics, WLAN
performance analytics. 5GC NF (e.g. AMF, PCF) can request analytics data from
NWDAF for decision making. But whether and how location service can be benefit
from NWDAF is not studied yet. For example, whether the existing analytics
generated by NWDAF (e.g. WLAN performance analytics) can be used to improve
the location service performance, e.g. to assist the LMF to select the
positioning method or decide more accurate assistance data?
Furthermore, based on Table 6.7.2.2.1 and Table 6.7.2.3.1 of TS 23.288 [9],
the UE location collected and included in the analytics data by the NWDAF is
TA or cell. But in some use cases, analytics in granularity of TA or cell
level is not sufficient. Considering location service can provide more
accurate UE location information, it is needed to study how does the location
service provides such information to NWDAF.
To support the aspects above, this key issue will study:
\- How to provide the NWDAF with location information with finer granularity
than TA/cell level, e.g. which NF in the location architecture supports the
interface to the NWDAF, whether existing location procedures can be re-used or
not;
\- Whether the privacy check can be skipped or not when the NWDAF requests
location information via LCS services, if not, how to perform the privacy
check in LCS;
\- Whether existing data analytics generated by the NWDAF can be used to
improve location service performance and how, e.g. assist the LMF to select
the positioning method, decide more accurate assistance data, reduce
signalling cost and delay etc.;
\- Identify use cases where new or existing data analytics from the NWDAF can
be used for improving location service performance. Regulatory requirements
(e.g. different location accuracy requirements from FCC in different cases)
will be taken into account.
NOTE: Coordinated activities between the study FS_eNA_Ph3 and this study are
needed. Any new data analytics agreed as part of this Key Issue that need to
be provided by NWDAF need to be studied and agreed in FS_eNA_Ph3.
## 5.5 Key Issue #5: Assistance data provisioning for low power high accuracy
GNSS positioning
### 5.5.1 Description
The GNSS assistance data could help reduce UE GNSS receivers\' power
consumption and increase the position accuracy. Nowadays, UE usually gets the
assistance data from internet through user-plane. However, using a user plane
based way means that UE must active a PDU Session, which leads to higher power
consummation. Moreover, it may not apply to Redcap UEs, as some of them may
not support to establish a PDU Session.
The distance between the UE GNSS receivers and GNSS reference receiver should
be sufficiently short to make sure the GNSS assist data provided by the
reference receiver are valid and accurate. However, GNSS reference receivers
are not widely implemented in some countries, which makes it hard to provide
high accuracy GNSS positioning service for UE GNSS receivers in some areas.
This key issue aims at studying the possible method to get nearby GNSS
assistance data inside 3GPP, to mitigate a lack of implementation of GNSS
reference receivers.
The following aspects will be studied:
\- How could the core network (i.e. LMF) get the GNSS assistance data of a
GNSS reference receiver, either inside 3GPP domain or external to 3GPP domain
to select a GNSS reference receiver close to the estimated location of the UE,
help reduce power consumption and increase the positioning accuracy?
\- Whether and how existing procedures, protocols or interfaces can be re-used
or enhanced to make UE get the nearby GNSS assistance data?
## 5.6 Key Issue #6: UE Positioning without UE/User Awareness
### 5.6.1 Description
There are regulatory cases (e.g. helping with police enquires), in that UE
should not be notified by any means during the LCS session. But how to support
the requirement has not been considered.
For some IoT or RedCap devices, when power saving is more important than
fulfilling the LCS request, how to obtain UE location without notifying the UE
especially when UE is in CM-IDLE or RRC_INACTIVE state is also not considered.
To support the requirements above, this key issue will study:
\- Which NF and how to decide not to notify UE/User during the LCS session,
e.g. what information is considered to make the decision;
\- Functionality and procedure enhancements to guarantee not to notify UE/User
during the LCS session when UE is in CM_CONNECTED, CM_IDLE or RRC_INACTIVE
state;
\- What UE location information is provided to LCS Client/ AF to fulfil the
LCS QoS when the UE is in CM_IDLE or RRC_INACTIVE state and if the UE is not
notified during the LCS procedure.
## 5.7 Key Issue #7: support of Positioning Reference Units and Reference UEs
### 5.7.1 Description
Based on RAN WG conclusion in Rel-17, positioning reference units (PRUs) with
known locations can enhance the positioning performance. PRUs may be used to
assist positioning of UEs by e.g. providing measurement information related to
RAN nodes. This key issue aims to study the system level impact to support
PRUs.
The accuracy of positioning heavily relies on the number of Line of Sight
(LoS) paths, so positioning in the indoor environment is complex, as there are
many factors that reduce the possibility of LoS path. It is resource consuming
and complicated to deploy sufficient RAN nodes (e.g. pRRUs or gNBs) to provide
enough LoS path, considering the complex environment with possible changes.
Consequently, a simplified node, referred to as a Reference UE, is required to
provide more potential LoS paths for positioning.
The following aspects will be studied for PRUs:
\- What information of the PRUs needs to be obtained by 5GC and how can the
5GC become aware which PRU(s) are available.
\- How can 5GC determine and enable particular (e.g. candidate) PRU(s) from
the available PRU(s).
\- How are the location service procedures performed to improve positioning
accuracy using PRU(s). This can include using PRUs to assist positioning of
one UE or using PRUs to assist positioning of many or all UEs.
The following aspects will be studied for Reference UEs:
\- Whether and how the 5GS can assist with the selection of Reference UE
supporting the 5G location services provided to a different UE.
\- The specific entities and mechanisms in the 5GC whose functionality need to
be updated to account for the Reference UE operation as part of the location
service.
NOTE 1: Coordination with RAN WG may be required.
NOTE 2: Whether PRU and Reference UE can be the same entity should be
determined during normative phase.
NOTE 3: Within the FS_eLCS_ph3 study and this TR, the Reference UE has no
relationship with other Studies, e.g. FS_Ranging_SL, unless clearly mentioned.
If a terminology alignment between studies is required, it will be done before
starting normative work.
## 5.8 Key Issue #8: support of location service continuity in case of UE
mobility
### 5.8.1 Description
For commercial location service, in particular the use case on vehicle(V2X)
UE, it is very likely that UE moves between EPS and 5GS, and continuous UE
positioning (periodical location service/LDR) is required.
Following UE mobility scenarios are considered under this key issue:
\- UE mobility between EPS and 5GS (bi-direction).
\- UE mobility between NG-RAN node.
The following \"Types of Location Request\" should be considered in the scope
of WT#6:
\- Mobile Terminated Location Request, and in detail covers:
\- Immediate Location Request (Response Time \"no delay\" and \"low delay\"
are excluded).
\- Deferred Location Request (both periodic location service, and event based
location request).
\- Mobile Originated Location Request.
The following issues will be studied:
\- How to handle the UE location service context in case of UE mobility (e.g.
context in the AMF, MME, LMF, E-SMLC).
\- Configuration update of the positioning information/configuration on the
source and target RAN nodes in case of UE mobility.
\- How to enhance the cancellation of the existing positioning procedure in
case of UE mobility.
## 5.9 Key Issue #9: Support of Positioning Requirements Related to Satellite
Access
### 5.9.1 Description
In Rel-17, the 5GS system has been enhanced to support the service
requirements of 5GC with satellite access (in the WID: Architecture aspects
for using satellite access in 5G).
In Rel-17, when a UE is using NR satellite access, in order to ensure to meet
the regulatory requirements, the network will verify whether the PLMN selected
by the UE is allowed to operate in the country of the UE location based on the
UE location information.
Besides, the broadcast TAI(s) and the TAI where the UE is geographically
located, if known, will be provided as part of ULI by NG-RAN to the AMF. Using
UE-generated location information (e.g. GNSS/A-GNSS) to determine the TAI
where the UE is geographically located can be accurate but may be unreliable
as has been evaluated by SA WG3.
When UE access 5G via satellite access, some services with regulatory
requirements, e.g. emergency calls service and lawful interception, require a
trusted/reliable methods to determine with sufficient accuracy the UE
location. Any method which relies solely on UE-generated location information
may not be reliable unless the information provided by the UE can be verified
by the network. But how does the network verify the UE location has not been
considered, so this key issue will study:
\- What kind of location information can represent the UE location that meets
required accuracy in NR satellite access (e.g. doing verification based on the
location information to meet regulatory requirements)?
\- In collaboration with RAN, for the reliability of the location verification
by the network for regulated services (LI, emergency) and given SA WG3-LI
requirements defined in S3i210282 [11], further study how the 5GC LCS can
ensure that network verification of UE location is performed with reliable
method, that does not rely solely on UE-generated location information, and
the result of such network verification of UE location meets aforementioned
requirements;
\- In collaboration with RAN on their work on network verified UE location,
study whether existing core network verification mechanisms needs enhancement
and conditions (which NF, when, how, etc.);
\- How to further enhance the LCS to verify location services related
requirements defined in TS 22.261 [8];
NOTE: The work of this key issue needs collaboration with RAN. Considering SA
WG2 Rel-18 work begins earlier than RAN and RAN will make decision related to
the work by RAN#98 as indicated in NR_NTN_enh WID in RP-213690 [12], thus SA
WG2 can start discussing solutions first and make conclusion in collaboration
with RAN.
## 5.10 Key Issue #10: Support of Reduced Latency
### 5.10.1 Description
Reduction of latency is useful for many user cases and needs to be end-to-end.
For example, very low latency for positioning that may be supported by
procedures defined by RAN1 and RAN2 would be nullified by extra time in
establishing a positioning session with a target UE or in returning a location
estimate to an LCS Client or AF.
The following aspects will be studied:
\- Reducing end to end latency for an immediate location request (5GC-MT-LR,
5GC-MO-LR).
\- Reducing end to end latency for a deferred location request (periodic or
triggered 5GC-MT-LR).
NOTE: Reducing latency should focus on aspects related to signalling and
procedures involving the 5GCN and not on aspects completely within NG-RAN
which are under RAN control.
## 5.11 Key Issue #11: Enhance the Triggered Location for UE power saving
purpose
### 5.11.1 Description
Some use cases only need the UE location to be tracked when the UE is within a
set of pre-defined areas, e.g. when UE is within one big city or a campus. For
power saving purpose, it is beneficial to only allow UE location tracking when
the UE enters one such area.
This Key Issue will study:
\- How to provide location service only when the UE is within a pre-defined
area, including border district and central district in this area;
\- How to define and identify the pre-defined areas; and:
\- Which entity provide such pre-defined areas to the LCS system and how?
## 5.12 Key Issue #12: support of low power and/or high accuracy positioning
### 5.12.1 Description
SA WG1 considers low power high accuracy positioning is an integral part of a
considerable number of industrial applications. The total energy needed for a
specific operation time for such a low power high accuracy positioning
optimized IoT-device is a combination of energy for positioning (varies
depending on the used positioning method), energy for
communication/synchronization and a difficult to predict factor to take
additional losses through e.g. security, power management, microcontroller,
and self-discharge of batteries into account.
Low power and/or high accuracy positioning may need specific handing in the
system level, depending on the localization requirements of an LCS Client or
AF.
Reduction of power consumption can be useful for IIoT and CIoT UEs and is
generally preferable for any UE to improve battery lifetime. Reduction of
power consumption may or may not be associated with high accuracy.
Following issues are proposed for study:
\- How to identify localization QoS for low power and/or high accuracy
positioning;
\- Whether new information is needed in subscription data for low power and/or
high accuracy positioning;
\- Whether LCS QoS should be enhanced to support LPHAP;
\- How to handle UE connection management/mobility management, for power
saving purpose, when supporting low power and/or high accuracy positioning;
\- Positioning procedure optimization:
\- Reducing UE power consumption for an immediate location request (5GC-MT-LR,
5GC-MO-LR);
\- Reducing UE power consumption for a deferred location request (periodic or
triggered 5GC-MT-LR);
\- Reducing UE power consumption in association with high accuracy
positioning.
# 6 Solutions
## 6.0 Mapping Solutions to Key Issues
Table 6.0-1: Mapping Solutions to Key Issues
              Key Issues
* * *
Solutions 1 2 3 4 5 6 7 8 9 10 11 12  
1 X X  
2 X  
3 X X  
4 X  
5 X  
6 X  
7 X  
8 X  
9 X  
10 X  
11 X  
12 X  
13 X  
14 X  
15 X  
16 X  
17 X  
18 X X  
19 X X  
20 X  
21 X  
22 X  
23 X  
24 X  
25 X  
26 X  
27 X  
28 X  
29 X  
30 X  
31 X  
32 X  
33 X  
34 X  
35 X X
## 6.1 Solution #1: Positioning protocol transport over User Plane
### 6.1.1 Introduction
This solution addresses Key Issue #1 on Architectural Enhancement to support
User Plane positioning and also provides option to reduce latency for Key
Issue #10.
### 6.1.2 Functional Description
The AMF, UE and LMF are enhanced to initiate setup of a User Plane connection
between a selected LMF and UE and to provide LMF and UE with needed
information to establish a secure connection. The information includes e.g. IP
address of LMF to be used for the connection, temporary UE identifier (not the
same as used N2 or other reference points), and security credentials. The AMF,
UE and LMF are enhanced to transport LPP over a UP protocol. Once the LCS-UP
connection is established the LMF selects either to use the LCS-UP procedure
according to clause 6.1.3.3 or to use CP procedure according to clause 6.11.1
of TS 23.273 [5]. Within one LPP session the same transport shall be used.
Since LCS-UP connection is maintained during the lifetime of the PDU session,
the procedure also reduces the latency if LMF selects LCS-UP over CP for
certain positioning requests.
Current solution considers UE has only one LCS-UP connection with the selected
LMF.
Multiple LCS-UP connection establishment could be also considered from a
single or multiple LMF to separate different traffic type (emergency, LI or
commercial).
NOTE: If and what security mechanism is used and subject to SA WG3 conclusion.
It is proposed to define a protocol stack that includes a lightweight LPP
transfer protocol that is limited services aligned to what CP transport
provides (e.g. identification of UE and positioning session). A potential
stack is shown in Figure 6.1.2.-1 (TCP is shown as example of a transport
layer and security details are omitted). Details of protocol stack will be
determined in the normative work.
Figure 6.1.2.-1: Protocol Layering for User Plane Transfer of LPP
### 6.1.3 Procedures
#### 6.1.3.1 Establish LCS-UP connection between UE and LMF
The flow below shows how a secure LCS-UP connection between UE and LMF is
established.
Figure 6.1.3.1-1: Connection establishment between UE and LMF
1\. At applicable Registration events or when an LCS procedure is initiated,
AMF may decide to select an LMF and request the UE and the selected LMF to
establish an LCS-UP connection to be used for transfer of LPP signalling. The
decision may be based on e.g. UE capabilities, UE location, subscription
information, LMF load and LMF capabilities. It can be an operator decision
whether LCS-UP connection is established at Registration events or when an LCS
procedure is initiated.
Latency sensitive use-cases would require LCS-UP connection established at
Registration events. Emergency traffic might not require pre-established LCS-
UP connection.
1.b. When a new LCS procedure is initiated for the UE which already has LCS-UP
connection, the AMF may detect a need to reselect LMF used for LCS-UP
signalling. The detection may be based on e.g. UE capabilities, UE location,
subscription information, LMF load and LMF capabilities. Further at AMF
relocation, the target AMF needs to inform the LMF using LCS-UP signalling
about the AMF change.
2\. The AMF sends a Nlmf_Location_UPConfig Request towards the LMF to request
set up of a LCS-UP connection. The message may include e.g. a temporary UE
identifier.
3\. The LMF sends a LCS UP Info message to the UE via the serving AMF by
invoking the Namf_Communication_N1N2MessageTransfer service operation. The LCS
UP Info message may include e.g. IP or FQDN address of LMF, temporary UE
identifier and security credentials.
4\. The AMF forwards the LCS UP Info in a DL NAS TRANSPORT message.
5\. The UE and LMF establish a secure connection.
6\. The LMF sends Nlmf_Location_UPConfig Response message to AMF to inform of
outcome of connection setup.
7\. The AMF stores the LCS-UP connection context as part of UE context.
After establishing the connection, UE and LMF may maintain the connection for
later message transfer via user plane.
#### 6.1.3.2 Modify LCS-UP connection between UE and LMF
The flow below shows how a secure LCS-UP connection between UE and LMF is
modified. Flow describes change of LMF but applies also when source and target
LMF is the same. The procedure can also be used to terminate LCS-UP connection
to Source LMF by AMF not selecting any Target LMF.
Figure 6.1.3.2-1: Connection modification between UE and LMFs
1a. [Conditional] The LMF discovers a need to change LMF or re-establish LCS-
UP connection. The LMF sends an Nlmf_Location_UPNotify message that includes
UP Info that indicates the reason for modification. The address of the AMF was
provided to LMF as a \"Notification Target Address\" in latest
Nlmf_Location_UPConfig message.
1b. [Conditional] At applicable Registration events and when an LCS procedure
is initiated, AMF may detect a need to reselect LMF used for LCS-UP
signalling. The detection may be based on e.g. UE capabilities, UE location,
subscription information and LMF capabilities. Further at AMF relocation the
target AMF needs to inform the LMF using LCS-UP signalling of the AMF change.
2\. [Conditional] If AMF reallocation has occurred this step is skipped.
Otherwise, steps 2 to 7 of clause 6.1.3.1 are performed between AMF, UE, and
Target LMF with addition that UE also terminate connection to Source LMF.
3\. The AMF sends a Nlmf_Location_UPConfig Request towards the source LMF. The
message may include a request for the Source LMF to terminate a specific LCS-
UP connection to the UE if connection is still active. Alternatively, it may
include information about AMF reallocation.
4\. [Conditional] If the LCS-UP connection to source LMF is still active
source LMF terminates the connection to the UE.
5\. The LMF sends Nlmf_Location_UPConfig Response message to AMF to confirm
connection termination or acknowledge change of AMF.
#### 6.1.3.3 UE Assisted and UE Based Positioning Procedure over LCS-UP
The flow below shows a positioning procedure used by an LMF to support UE
based positioning, UE assisted positioning and delivery of assistance data.
The procedure is based on use of the LPP protocol defined in TS 37.355 [15]
between the LMF and UE.
Figure 6.1.3.3-1: UE Assisted and UE Based Positioning Procedure over LCS-UP
1\. The LMF use the LCS-UP connection to transfer of a Downlink (DL) UP
TRANSFER message to the UE. The message includes a LPP message. The LPP
message may request location information from the UE, provide assistance data
to the UE or query for the UE capabilities.
2\. The UE stores any assistance data provided in the Downlink Positioning
message and performs any positioning measurements and/or location computation
requested by the Downlink Positioning message.
3\. [Conditional] The UE use the LCS-UP connection to transfer of a Uplink
(UL) UP TRANSFER message carrying includes a LPP message to the LMF to return
any location information or returns any capabilities.
### 6.1.4 Impacts on services, entities, and interfaces
The solution impacts the following network functions:
\- AMF that need to support triggering of LCS-UP connection setup,
modification & termination. Additionally, AMF also needs to consider at LMF
selection that the requested UE has an existing LCS-UP connection with one of
the LMFs.
\- LMF that need to support procedure to setup, modification & termination of
LCS-UP connection. Transfer of LPP messages over LCS-UP.
\- UE that need to support: Procedure to setup, modification & termination of
LCS-UP connection. Transfer of LPP messages over LCS-UP.
\- UDM that need to add info in Subscriber info if LCS-UP transport is
supported.
\- NRF that need to add info in NF profile LMF support LCS-UP transport.
## 6.2 Solution #2: Discovery of User Plane service Cooperated with 3GPP LCS
Features
### 6.2.1 Introduction
This solution addresses the KI \"Key Issue #1:Architectural Enhancement to
support User Plane positioning\".
The solution contains mainly two parts:
1\. User Plane feature support with compatibility with OMA standards [13][14]
2\. User Plane service (re-)discovery compatible to TS 23.548 [10].
### 6.2.2 Functional Description
As described in clause 5, User Plane positioning gives benefits including a
simpler protocol stack, less overload, better performance, extra LPPe support,
etc. When there is overloaded LCS signalling over N1 and/or NL1 interfaces,
like massive emergency cases, LMF can offload the traffic to the user plane to
enhance capacity.
LMF can perform legacy 3GPP LCS features independently. User Plane features
can also be used independently or cooperated with LMF using OMA User Plane
specifications as specified in TS 23.271 [4] and TS 38.305 [6].
With many features defined by OMA, since UE can\'t take uplink measurements,
to fulfil positioning methods like RTT, the User Plane has to cooperate with
Control Plane LMF to collect both uplink and downlink measurements.
User Plane cooperated with the 3GPP LCS control plane can be named \'LCUP\'
(LCs User Plane).
Figure 6.2.2-1: LMF and LCUP can be deployed independently and can cooperate
with each other
Independent/legacy LMF handles control plane requests as per legacy 3GPP LCS
specifications.
For independent User Plane entity, it could perform end to end location
service (possibly following legacy OMA specifications) without 5GC impact:
Figure 6.2.2-2: Independent user plane
Details of independent user plane function is out of this solution scope.
In this solution, only user plane invoked by LMF to enhance the 3GPP 5G LCS
procedures is referred as \'LCUP\'. This solution makes it compatible that
LCUP could also act as independent user plane while cooperating with LMF. For
LCUP cooperated with LMF, it can achieve the following benefits:
1\. Both uplink and downlink measurements can be collected.
2\. User Plane and Control Plane can have feature reusability, e.g. sharing
the same algorithm calculation.
NOTE 1: As per clause 5.1 of TS 38.305 [6], detailed cooperation interface
between LMF and LCUP is out of the solution scope and could be implementation
specific.
To keep legacy LCS procedures\' compatibility, for the cooperated LMF and LCUP
instances, LMF should still perform the entry point and response route for 5GS
LCS procedures, including MO-LR, MT-LR, Deferred MT-LR and regulatory-related
positioning when user plane positioning is involved.
Since there could be multiple LMF and LCUP instances, when LCUP cooperated
with LMF, UE needs to discover the correct instance of LCUP. With 3GPP LCS MT-
LR/NI-LR/MO-LR procedures, when AMF has selected an LMF instance - LMFi to
serve an LCS request about a UE, when the UE establishes user plane
interaction with an LCUP, the UE should perform user plane session with an
LCUPi cooperated with LMFi. This means UE should discover the LCUP instance
working with the serving LMF instance.
For the cooperated case, LMF can perform the offload operation to switch the
LPP traffic to User Plane.
LMF can provide information to UE, and allows the UE to establish a secure UP
connection to a proper LCUP over existing or new PDU session through the
following options:
1\. LMF can send SUPL INIT to UE through OMA-defined push mechanisms and
activate the UP session with its cooperated LCUP.
2\. For LPP offload in Rel.18, it is straightforward that the LCUP related
information be delivered over LPP itself. LMF can treat cooperated LCUP
information and contents in SUPL INIT as part of assistance data in LPP
provide assistance message.
a. The provide assistance data message can be unsolicited or in response to a
request assistance message from UE.
b. The LPP offload instruction in the LCUP assistance can be imperative or
instructive. Imperative means UE can choose to offload the traffic or receive
failure; instructive means UE would better to offload the traffic but may
still be served by LMF over control plane.
3\. LMF can also provide LCUP information to AMF using
Namf_Communication_N1N2MessageTransfer and AMF forward it to UE with DL NAS
TRANSPORT.
Besides the contents in SUPL INIT, LCUP assistance data can also include:
1\. The pre-provisioned or unique FQDN of the LCUP cooperating with serving
LMF.
2\. Security attributes of LCUP for TLS connection establishment.
NOTE 2: The PDU session (or related DNN) may be used only for LCS UP
connection.
NOTE 3: If any security work with PDU session and/or User Plane connection
needed, it should be handled by SA WG3.
Meanwhile, LCUP service should only be provided to capable UEs. UE capability
of User Plane can be exposed in a similar way as its legacy 3GPP LCS
capability:
1\. The capabilities of a target UE to support user plane may be signalled by
the UE to a serving PLMN or to an SNPN at the AS, NAS during registration of
the UE.
2\. Some of these positioning capabilities may be transferred subsequently to
an LMF with enhanced LPP signalling.
Such capability information could be transferred to LMF from:
1\. AMF in the DetermineLocation Request enhancement when UE provides the UP
capability during registration.
2\. LPP message to LMF in capabilities exchange.
As per [13][14], UE could use pre-configured FQDN and/or runtime parameter(s)
received in SUPL INIT as OMA compliant approach or LPP/NAS assistance as R18
enhancements to discover the LCUP.
Since UE uses FQDN to discover the User Plane server, URSP, EASDF rules and
different FQDN resolution can be used to locate the LCUP:
1\. As one of the Rel-18 enhanced options, each LCUP instance cooperated with
the LMF can be assigned to a unique FQDN. LMF can provide the corresponding
FQDN as part of the assistance data to the UE. UE can also retry the user
plane in case of an overloaded error reply of the control plane request.
2\. As OMA SUPL compliant option, for UEs which can only use provisioned
(H-SLP) FQDN and related trusted certificate settings, before the traffic
offload, the serving LMF can act as a (backend) DNS server and respond to the
DNS query to reply the cooperated LCUP.
a. If LCUP is bounded to certain area like in localized LCS, LMF can use the
same serving cell identity to choose the LCUP as its cooperated instance.
b. For the more specific cases that LMF is pre-configured with LCUP instance,
after LMF offload instruction to UE. UE performs the LCUP DNS query. EASDF
rules can attach UE IP in the ECS (EDNS Client Subnet) and forward the
provisioned FQDN\'s DNS query to all related LMF instances. LMF could decide
the DNS response by combining UP IP with information query from BSF or message
contents from IMS. Only when UE IP in ECS exists in the serving UE IP list,
the LMF would reply with its cooperated LCUP IP. Then UE can use the LCUP
assistance delivered from serving LMF to establish User Plane session with the
cooperated LCUP instance.
In conclusion, the solution to the cooperation of LMF and LCUP can be
summarized as follows:
1\. LMF performs the entry point and response route of LCS procedures
2\. OAM provisions LMF with the assistance information (including FQDN, etc.)
of its cooperated LCUP instance(s).
3\. LMF provides LCUP assistance to UE either through OMA defined push
mechanism or LPP/NAS assistance delivery
4\. With knowledge of LCUP service, URSP configured in the UE may indicate
which existing or new PDU session is used to establish the connection with
LCUP.
5\. With Edge DNS Client (EDC) functionality in the UE, EASDF rules has the
flexibility to match the DNS query to correct LCUP provisioned to the
cooperated LMF instance.
a. When each cooperated LCUP can have its unique FQDN so that UE can have
direct access, it could be pre-configured in LMF for all its LCUP assistance
delivery.
b. When applying DNS query feature to LMF, when triggered by MT/MO/NI
procedures, after offload instruction, serving LMF can reply the DNS query
with its cooperated LCUP assistance information based on either serving area
or UE IP/identity.
When LCUP is used with 3GPP LCS MT/NI/MO procedures, LMF can offload the LPP
traffic to LCUP by the following options to activate UP connection from UE :
1\. LMF can use LPP assistance delivery containing LCUP information.
2\. LMF can use OMA defined push mechanisms. This is compatible with legacy
SUPL capability of UE.
3\. LMF can also use Namf_Communication_N1N2MessageTransfer to AMF which
forwards LCUP info to UE with DL NAS TRANSPORT.
After UE gets the cooperated LCUP assistance data of its serving LMF:
1\. UE starts LCUP DNS query either with pre-provisioned, or from OMA defined
push mechanism or LPP assistance delivery:
a. If the FQDN of LCUP could uniquely identify an LCUP instance, such instance
would be the serving LCUP cooperated with the currently serving LMF. OAM can
perform pre-provision.
b. With localized LCS cases where LCUP and/or LMF are bounded to the serving
area, LMF can use UE\'s serving cell ID to match its serving area and respond
to DNS queries with its cooperated LCUP assistance information.
c. LMF can also maintain serving UE IP list from BSF query or SIP IP header of
SIP INVITE with co-location with LRF/RDF in emergency IMS call. LMF can use UE
IP to match ECS in LCUP DNS query to know whether it is the serving LMF so
that its cooperated LCUP assistance can be replied for the DNS query.
2\. UE connects to the LCUP over the user plane through the N6 interface.
3\. UE establishes TLS connection possibly with LCUP assistance data or pre-
configured trusted certificates.
4\. UE can start OMA specified SUPL positioning procedures besides the control
plane MT/MO/NI procedures.
### 6.2.3 Procedures
#### 6.2.3.1 LMF Offload traffic to Cooperated LCUP
Figure 6.2.3.1-1: LMF offload traffic to cooperated LCUP
1\. The external location services client sends a request to the GMLC for a
location for the target UE identified by an GPSI or an SUPI.
2\. The GMLC invokes a Nudm_UECM_Get service operation towards the home UDM of
the target UE to be located with the GPSI or SUPI of this UE.
3\. The UDM returns the network addresses of the current serving AMF.
4\. The GMLC invokes the Namf_Location_ProvidePositioningInfo service
operation towards the AMF to request the current location of the UE. The
service operation includes the SUPI, and client type and may include the
required QoS, Supported GAD shapes and UE UP capability.
5\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure as defined in clause 4.2.3.3 of TS 23.502 [3] to
establish a signaling connection with the UE.
6\. The AMF selects an LMF based on the available information as defined in
clause 5.1 or based on AMF local configuration. The LMF selection takes the
5G-AN currently serving the UE into account. The selection may use an NRF
query.
7\. The AMF invokes the Nlmf_Location_DetermineLocation service operation
towards the LMF to request the current location of the UE.
8\. LMF offloads the LPP traffic to its cooperated LCUP by one of the methods
in clause 6.2.2.
8.a The cooperated LMF can perform one or more of the positioning procedures
with RAN defined by 3GPP.
8.b The cooperated LCUP can perform one or more of the positioning procedures
with UE defined by OMA.
NOTE: LPPe can be executed in step 8.b.
9\. The LMF returns the Nlmf_Location_DetermineLocation Response towards the
AMF with the combined result from cooperated LMF and LCUP.
10\. The AMF returns the Namf_Location_ProvidePositioningInfo Response towards
the GMLC/LRF.
11\. The GMLC sends the location service response to the external location
services client.
#### 6.2.3.2 LMF Activates UE with UP Connection to LCUP
Figure 6.2.3.2-1
1\. URSP rules can be provisioned as an example in TS 23.503 [16]:
+----------------------+----------------------+----------------------+ | Rule Precedence =4 | Route Selection | This URSP rule | | | Descriptor | associates the | | Traffic Descriptor: | Precedence =1 | application \"App1\" | | | | and the Connection | | Application | Network Slice | Capabilities | | descriptor=App1 | Selection: S-NSSAI-a | \"internet\" and | | | | \"supl\" with | | Connection | DNN Selection: | DNN_1, S-NSSAI-a | | Capabi | DNN_1 | over Non-3GPP | | lities=\"internet\", | | access. | | \"supl\" | Access Type | | | | preference: Non-3GPP | It enforces the | | | access | following routing | | | | policy: | | | | | | | | When the \"App1\" | | | | requests a network | | | | connection with | | | | Connection | | | | Capability | | | | \"internet\" or | | | | \"supl\", the UE | | | | establishes (if not | | | | already established) | | | | a PDU Session with | | | | DNN_1 and S-NSSAI-a | | | | over Non-3GPP | | | | access. After that, | | | | the UE routes the | | | | traffic of \"App1\" | | | | over this PDU | | | | Session. | +----------------------+----------------------+----------------------+
2\. URSP rules are applied to UE.
3\. The start of 3GPP LCS procedures contained in TS 23.273 [5].
4\. Request comes to LMF with UE identity in inputData of
Nlmf_Location_DetermineLocation request. When UE provides the user plane
capability in registration, the request could take such capability in its
parameters.
a. LMF can use UE id to query BSF for UE IP; in emergency IMS call, E-CSCF
forwards SIP INVITE to GMLC/LRF. Through GMLC/LRF, LMF can also get the UE IP
from SIP header of the SIP INVITE.
NOTE 1: If authentication work needed, it should be handled by SA WG3.
5\. LMF gets UE user plane capability and provides LCUP information through
either LPP or NAS. LMF can also reuse legacy 2G/3G/4G SUPL mechanisms by
sending SUPL INIT to UE with attempts to activate user plane connection.
a. LPP capability exchange is used to fetch UE user plane capability if
Nlmf_Location_DetermineLocation doesn\'t show such capability; LMF can also
use solicited or unsolicited assistance data delivery to transfer LCUP
information to UE.
b. In (rare) cases that UE doesn\'t support LPP but supports user plane,
DL_NAS_TRANSPORT can be used to query UE user plane capability and delivery
the LCUP assistance information.
c. To be compatible with legacy SUPL implementation in UE, especially when LMF
has knowledge of UE user plane capability by OAM provision or other means, LMF
can use OMA defined push mechanisms and send SUPL INIT message to activate the
user plane session.
6, 7, 8. PDU session and EASDF rule execution as per TS 23.548 [10].
9\. If FQDN in DNS query is uniquely mapped to one LCUP instance, the LCUP
address is replied. This applies to cases when such FQDN is transferred from
LMF to UE at step 5. But this may not apply to pre-provisioned H-SLP/E-SLP in
UE. Such pre-configuration follows OMA SUPL specifications whose FQDN and
trusted certificates override the runtime parameter transferred through step 5
or other means.
a. If FQDN could be mapped to multiple LCUP instances(for example, different
LCUP instances in different campus areas), EASDF attached UE address in ECS
field and forward the DNS query to related LMF/LCUP instances. Since each LCUP
and cooperated LMF can be configured with (e.g. local data network) address
ranges, the serving LMF/LCUP instance could match UE address among its serving
UE requests and reply its LCUP address. This address is the cooperated LCUP
instance that UE should establish or resume user plane session.
10\. DNS result is replied to UE. If the UE has previous TLS context with same
FQDN, the TLS handshake workload can be minimized as per clause 6.1.1.4 in
OMA-TS-ULP [14].
11\. UE continues to establish or resume secure user plane session. After
secure connection established, user plane messages can be transferred, e.g.
SUPL POS INIT for option c in step 5.
NOTE 2: The discovery process in above activation procedures follows the EAS
discovery and relocation defined in TS 23.548 [10]. It covers both the initial
discovery of User Plane service for the UE and also the rediscovery process
when UE needs to switch different User Plane services.
### 6.2.4 Impacts on services, entities, and interfaces
LMF: provides NAS, LPP assistance and acts as backend DNS server for LCS UP
server instance.
For UE compliant with user plane specified in TS 23.271 [4], TS 38.305 [6]:
there is no mandatory changes needed.
For UE with Rel-18 enhancement: there can be update to support
DL_NAS_TRANSPORT and/or LPP assistance for User Plane assistance.
## 6.3 Solution #3: User plane location capability transfer and positioning
via user plane
### 6.3.1 Introduction
This solution addresses Key Issue #1 on Positioning via user plane
transmission.
In this solution, UE \'user plane location capability\' can be regarded as a
part of 5GMM capability or as a LPP sub-capability. If network determines to
use user plane for positioning, the network should send the information (e.g.
address information) of the LMF supporting user plane positioning
functionality to UE to enable the user plan connection.
### 6.3.2 Functional Description
In this solution, we assume LMF is integrated with a user plane location
function , to which UE needs to establish a user plane connection if user
plane positioning is to be used.
Before a UE establishes the user plane connection, it is required to send user
plane location capability to the network so that the network knows that the UE
supports positioning via user plane then can determine to use user plane for
positioning. Thus, for the \'user plane location capability\' awareness, UE
can include its \'user plane location capability\' as part of the \'5GMM
Capability\' in the Registration Request message (Option 1) or the existing
LPP capability transfer should cover the \'user plane location capability\'
indication (Option 2).
During the MO or MT positioning procedure, after the network determines to use
user plane positioning, the network should indicate the UE to use user plane
for positioning with the address information of LMF. With the address
information, UE can establish a secure connection with the LMF, and via this
secure connection, position messages can be transferred between UE and the
LMF. The established user plane connection may be reused for subsequent user
plane position messages transmission trigged by UE or LMF, e.g. if UE does not
move to a new place, does not have new QoS requirements and uses the same
positioning method via the user plane.
### 6.3.3 Procedures
#### 6.3.3.1 User plane location capability transfer
During the MO-LR or MT-LR procedures, LMF may request the UE to provide the
user plane location capability. Figure 6.3.3.1.-1 presents the capability
transfer procedure, the _ProvideCapabilities_ message message described in TS
37.355 [15] should support to carry \'user plane location capability\'
indication.
Figure 6.3.3.1-1: Capability transfer
1\. AMF sends Nlmf_Location_DetermineLocation Request to the LMF.
2-3. The LMF invokes the Namf_Communication_N1N2MessageTransfer service
operation towards the AMF to request the transfer of a Downlink (DL)
Positioning message to the UE. The Downlink Positioning message queries for
the UE capabilities if the UE Positioning Capability is not received from AMF.
The AMF forwards the Downlink Positioning message to the UE in a DL NAS
TRANSPORT message.
4-5. UE provide its \'user plane location capability\' indication in an Uplink
Positioning message included in a NAS TRANSPORT message, if it supports user
plane positioning method.
#### 6.3.3.2 5GC-MT-LR Procedure via user plane
Figure 6.3.3.2-1: 5GC-MT-LR Procedure via user plane
0a. UE registration procedure in figure 4.2.2.2.2-1 of TS 23.502 [3]. If
Option 1 for UE capability awareness is selected, UE include its \'user plane
location capability\' indication as part of the \'5GMM Capability\' in the
Registration Request.
0b. [Conditional] AMF may trigger UE to establish a PDU session for later
usage based on the capability of UE, UE location, and subscription information
if \'user plane location capability\' indication is received in step 0a.
0c. [Conditional] UE establishes a PDU session for positioning if receiving
the trigger in step 0b.
1\~10. Steps 1-10 of figure 6.1.2-1 in TS 23.273 [5]. For the step 10, if UE
include its \'user plane location capability\' indication as part of the
\'5GMM Capability\' in the Registration Request message (Option 1 for UE user
plane location capability awareness), AMF selects a LMF supporting user plane
location based on the capability information.
11\. The AMF invokes the Nlmf_Location_DetermineLocation service operation
towards the LMF to request the current location of the UE, which carries the
\'user plane location capability\' information of UE if AMF received it in
step 10. AMF also sends its notification URL to LMF in this message for
subscription of secure user plane connection status.
12-13. [Conditional] Steps 2-5 of clause 6.3.3.1 for capability transfer, if
Option 2 for UE user plane location capability awareness is used and LMF has
not obtained the capability of UE.
14\. Based on the \'user plane location capability\' indication of the UE
received in step 11 or step 12-13, the Positioning methods and modes the UE
supports, the load of the control plane, service type, Client Type, deferred
location type, required location QoS received in step 11, LMF decides whether
to continue the position procedure via user plane. Steps 15-20a is skipped if
there is already user plane connection context of the target UE in LMF.
15\. [Conditional] If LMF decides to utilize user plane and there is no
established secure user plane positioning for the UE, LMF sends a user plane
positioning information to AMF to indicate UE to use user plane positioning.
The user plane positioning information includes the FQDN or IP address of the
LMF, the S-NSSAI and DNN for the PDU session used for user plane positioning,
a temporary UE identifier and security related information. LMF may send a
dedicated DNN for user plane connection. Also, the LMF may require the UE to
report the IP address of the PDU session used for user plane positioning. If
UE supports more than one positioning methods, LMF may also indicate UE which
type of positioning methods should use the user plane connection, while others
may still use the control plane (e.g. user plane for sensor method and control
plane for NR-based positioning method). The user plane positioning information
transfer can be based on NAS signalling or enhanced LPP.
NOTE: LMF can select different positioning methods (e.g. motion sensor-based
method) for the user plane and it is based on implementation and local
configuration to determine which positioning method to use on user plane.
Editor\'s note: The security mechanism and security information provided by
LMF to UE is subject to SA WG3\'s work.
16\. [Conditional] When AMF receives the user plane information from LMF in
step 15, AMF sends it to UE via a DL NAS TRANSPORT message.
17\. [Conditional] The UE starts to establish a secure connection with LMF. If
UE finds there is no suitable existing PDU session for user plane positioning,
UE should establish a PDU session with the S-NSSAI and DNN received from the
positioning information. SMF should select a UPF connecting with the LMF based
on S-NSSAI, DNN (maybe a dedicated DNN), and UE location information, etc.
18\. [Conditional] If the suitable PDU session exists, UE sends an
acknowledgement to LMF through AMF via a UL NAS TRANSPORT message, to confirm
that user plane position is chosen, and the IP address of the PDU session may
also be included in the acknowledgement. If there is no suitable existing PDU
session and the PDU session establishment failed in step 17, a failure
indication should be included in the acknowledgement message.
19\. [Conditional] AMF sends the acknowledgement received in step 18 to the
LMF via Namf_N1messageNotify service.
20a. UE establishes a secure user plane connection with LMF.
20b. LPP message can be transferred between UE and LMF for UE based
positioning, UE assisted positioning and delivery of assistance data. If the
user plane secure connection has been established, LMF directly sends LPP
messages to UE. The message flow of step 20a and 20b is described in clause
6.3.3.4.
21\~23. Steps 9\~11 of figure 6.1.1-1 in TS 23.273 [5]. In step 21, LMF
indicates AMF in the Nlmf_Location_DetermineLocation Response message that a
user plane positioning method is used. AMF should store the indication
information and LMF ID, which presents that there is a user plane connection
between the UE and LMF.
24\. UE and LMF may maintain the secure user plane connection for later
message transfer via user plane. If UE or LMF release the connection, LMF
should send an Nlmf_Location_EventNotify message to indicate AMF to release
related resources. This step can occur at any time after step 21.
#### 6.3.3.2a Deferred 5GC-MT-LR Procedure via user plane
Figure 6.3.3.2a-1: Deferred 5GC-MT-LR via user plane
0\. Same with step 0a-0c in figure 6.3.3.2-1 of clause 6.3.3.2.
1\. Steps 1-13 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273 [5].
In step 13, AMF selects a LMF supporting user plane positioning based on UE
capability if received \'user plane location\' indication in step 0.
2-9. Same with steps 11-20 in clause 6.3.3.2.
10a-10c. Step 16-18 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273
[5] with following differences:
\- In step 18 (step 10c in this figure), LMF indicates AMF in the
Nlmf_Location_DetermineLocation Response message that a user plane positioning
method is used. AMF should store the indication information, which presents
that there is a user plane connection between the UE and LMF.
\- For UE available location event, after step 18, LMF may still maintain the
user plane connection for later usage.
10d. Steps 19-21 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273 [5]
with following difference:
\- After step 19, besides storing UE user plane positioning context for
periodic and trigged event report, AMF should maintain the secure user plane
connection status of UE if LMF does not indicate AMF to release it.
11-15. Steps 16-21 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273
[5] with following differences:
\- The Event report of step 13-14 and step 15 for UE positioning are performed
via user plane.
\- To reduce the event report latency, LMF and UE may maintain the user plane
connection thus UE will not be in CM-IDLE state.
16-17. Steps 28-31 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273
[5].
#### 6.3.3.2b Cancellation of Event Reporting
Cancellation of event reporting can be initiated by the UE, H-GMLC or LCS
Client or AF, using the control plane procedures defined in clauses 6.3.2 and
6.3.3 in TS 23.273 [5] with following differences:
\- LMF and UE may still maintain the secure user plane for later positioning
session usage after Cancellation of Event Reporting for current positioning
session. If LMF decides to release the secure user plane connection, or UE has
released the secure user plane connection, LMF sends the
Nlmf_Location_EventNotify message to AMF to release the stored information.
#### 6.3.3.3 5GC-MO-LR Procedure via user plane
For MO-LR procedure, the user plane location capability may be included in the
MO-LR request message, in this case there is no need for LMF to require UE to
report its user plane capability if Option 2 for capability awareness is
selected. After receiving the Nlmf_Location_DetermineLocation message, LMF
determines whether to utilize user plane for UE positioning.
Figure 6.3.3.2-2 presents the 5GC-MO-LR procedure via user plane, of which the
principle is similar with 5GC-MT-LR Procedure via user plane. The difference
is, in step 4, the user plane location capability can be carried by the
Nlmf_Location_DetermineLocation message no matter whether Option 1 or Option 2
for UE capability awareness is selected.
If the UE has received DNNs/S-NSSAIs used for user plane positioning and
established corresponding PDU sessions from previous location procedure, it
may directly interact with LMF via the user plane connection for MO-LR, if the
requested location service type is either location estimate of the UE or
location assistance data. If the MO-LR requesting location transfer to an LCS
client or AF, the UE still should send the MO-LR request through AMF, but step
5\~9 in figure 6.3.3.2-2 can be skipped after LMF determined to utilize user
plane.
Figure 6.3.3.3-1: 5GC-MO-LR Procedure via user plane if there is no
established user plane secure connection between UE and LMF
1-4. Similar with steps 1-4 in figure 6.2-1 of clause 6.2 of TS 23.273 [5].
The difference is that the \'user plane location capability\' indication can
be carried by the Nlmf_Location_DetermineLocation message in step 4 no matter
whether Option 1 or Option 2 for UE capability awareness is selected.
4b-14. Same with steps 15-24 in clause 6.3.3.2.
#### 6.3.3.4 LPP transfer via user plane
This procedure presents the LPP Message transfer between UE and LMF via user
plane. The LMF interacts with the UE in order to exchange location information
applicable to UE assisted and UE based position methods.
Figure 6.3.3.4-4: UE assisted and UE based positioning via user plane
1\. Before the LPP message transfer, UE and LMF should has established a
secure connection.
2\. LMF send LPP Message to UE via DL UP LPP TRANSFER, which may request
location information from the UE, provide assistance data to the UE or query
for the UE capabilities.
3\. After receiving the downlink LPP message, the UE may store assistance data
provided by LMF and/or performs positioning measurements and/or location
computation.
4\. UE may return location information or returns capabilities to LMF via
uplink LPP message.
Editor\'s note: The user plane transport protocol and security aspects for LPP
re-use solution#1 and the conclusion of SA WG3.
#### 6.3.3.5 LMF Change Procedure with user plane positioning
The LMF Change procedure supports change of a serving LMF during a deferred
5GC-MT-LR procedure for periodic, or triggered location events via user plane
as described in clause 6.3.2.2.a.
When the there is no ongoing positioning sessions, AMF may also trigger the
LMF re-selection to transfer the maintained secure user-plane connection to a
new LMF.
Figure 6.3.3.5-1: LMF Change Procedure with user plane positioning
1\. [Conditional] At applicable Registration events, AMF may decides to
reselect a new LMF as there is a MT-LR positioning session for periodic or
triggered events report via user plane of UE or there is a secure user plane
connection between UE and LMF.
2\. [Conditional] AMF sends the Nlmf_Location_LMFRelocation request to LMF1,
carrying the information of the selected new LMF2.
3\. [Conditional] The old LMF1 may decide to use a new LMF2 for user plane
positioning.
4-5. If the old LMF1 decides to change LMF with user plane positioning, the
old LMF1 sends a user plane positioning information message to AMF to include
the information of new LMF2.
6\. UE decides whether or not the old PDU Session associated with old LMF1 for
user plane positioning can be reused for the new LMF2. If not, the UE
establishes the new PDU session associated with the information of new LMF2.
7-8. UE sends a user plane positioning information message to AMF to
acknowledge the update of new LMF2 information.
9-10. The old LMF1 performs context transfer and send the request to the new
LMF2 selected in step 1 or step 3 as specified in steps 6-7 of clause 6.4 of
TS 23.273 [5].
11-12. After finishing the Location context switch, the new LMF2 sends a user
plane positioning information message to AMF to indicate the accomplishment of
LMF change with user plane positioning. AMF updates the routing information of
serving LMF for the UE.
13\. The UE utilizes the new LMF2 and PDU Session if possible for the
transmission of Event report message and deletes the old PDU Session
associated with the old LMF1 if possible.
### 6.3.4 Impacts on services, entities, and interfaces
The solution impact the following network functions:
\- UE supports to send user plane location capability to LMF, receives user
plane positioning information from LMF, support setup and release of UP
connection and supports to perform positioning via user plane location
connection;
\- LMF supports user plane location service and supports to transfer the user
plane positioning information to UE.
\- AMF supports to trigger UE to establish a PDU session for user plane
positioning based on UE capability and store the secure user plane connection
status of UE.
## 6.4 Solution #4: Direct communication between LMF and RAN node
### 6.4.1 Introduction
This solution aims to address the key issues#2: enhanced positioning
architecture for NPN deployment. Particularly this solution address the
following questions:
\- How to realize low latency positioning procedure under NPN deployment.
\- How to achieve reliable and secure location result delivery and exposure,
e.g. UE location not exposed to the public network.
### 6.4.2 Functional Description
The following is the architecture figure in this solution.
Figure 6.4.2: Reference architecture for Location Services
In this solution, the LMF communicates with the RAN node via a local AMF. The
LMF exchanges Network Positioning Message with RAN for Non-UE Associated
Network Assistance Data procedure, without going through the AMF. The LMF
directly communicates with the GMLC to exposure the UE location to GMLC
directly without going through the AMF. For network assisted or network based
positioning procedure, the LMF sends the Network Positioning Message(request)
toward the RAN via the serving AMF. The RAN sends the Network Positioning
Message(response or notification) towards LMF via the Local AMF.
The interface between local AMF and LMF is NL1, as defined in TS 23.273 [5].
The local AMF needs not retain state information for Network Assisted
Positioning procedure and Non-UE Associated Network Assistance Data procedure,
e.g. can treat any response from NG-RAN as a separate non-associated transfer.
The Local AMF supports the management of N2 interface, i.e. the TNL
association between the RAN node and Local AMF. The TNL association between
the RAN node and the local AMF is pre-established via configuration. The
weight factor of TNL association with the Local AMF shall be set to zero so
the RAN node shall not select the Local AMF for initial N2.
Other functionalities supported by the serving AMF defined in TS 23.501 [2]
may not be needed in local AMF.
The GMLC notification address is provided from AMF to LMF. The LMF notifies
the UE location estimation towards the GMLC directly.
NOTE 1: This solution assumes that the LMF/Local AMF and the RAN node are in
the same trusted domain.
NOTE 2: In order to reduce the latency the local AMF and LMF can be deployed
together. The local AMF address is local configured in the LMF.
NOTE 3: The user plane based solution in KI#1 can be used for UE Assisted and
UE Based Positioning.
### 6.4.3 Procedures
#### 6.4.3.1 Network Assisted Positioning Procedure
Figure 6.4.3-1: Mobile Terminated Network Assisted Positioning Procedure
1\. Based on configuration the TNL association may be pre-established between
the RAN node and the Local AMF.
2\. The GMLC invokes the Namf_Location_ProvidePositioningInfo service
operation towards the AMF to request the current location of the UE. The
service operation includes the SUPI, and client type and may include the
required QoS and Supported GAD shapes.
3\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure as defined in clause 4.2.3.3 of TS 23.502 [3] to
establish a signalling connection with the UE.
4\. The AMF selects the LMF and invokes the Nlmf_Location_DetermineLocation
service operation towards the LMF to request the current location of the UE..
This service operation may also include the GMLC notification address to
receive the UE location.
5\. The LMF response Nlmf_Location_DetermineLocation response.
6\. The AMF response Namf_Location_ ProvidePositioningInfo response with
success indication.
7\. The LMF sends a Namf_Communication_N1N2MessageTransfer(Network Positioning
message) to the serving AMF.
8\. The serving AMF sends DOWNLINK UE ASSOCIATED NRPPA TRANSPORT via the TNL
association to the RAN node to request position related information from the
RAN node. The N2 Transport message includes the Routing ID of the LMF.
9\. The target RAN node determines the Local AMF based on the configuration or
Routing ID of the LMF, and returns any position related information to the
Local AMF in a Network Positioning message included in an UPLINK UE ASSOCIATED
NRPPA TRANSPORT message. The N2 Transport message includes the Routing ID of
the LMF received from the serving AMF. The AMF NGAP UE ID is set to one
received from the serving AMF.
10\. The Local AMF sends Namf_Communication_N2InfoNotify(Network Positioning
message) to the LMF identified by the Routing ID.
11\. The LMF invokes the Nlmf_Location_EventNotify service operation towards
the GMLC notification address received from AMF in step 4.
#### 6.4.3.2 Obtaining Non-UE Associated Network Assistance Data
Figure 6.4.3.2: Non-UE Associated Network Assistance Data procedure
1\. Based on configuration the TNL association may be pre-established between
the RAN node and the LMF/Local AMF.
2\. The LMF decides the Local AMF and invokes
Namf_Communication_NonUeN2MessageTransfer service operation in the Local AMF.
3. The Local AMF sends a Network Positioning message in the DOWNLINK NON UE
ASSOCIATED NRPPA TRANSPORT message via the TNL association to the RAN node to
request position related information from the RAN node.
4\. The target RAN node returns any position related information to the LMF in
a Network Positioning message included in an UPLINK NON UE ASSOCIATED NRPPA
TRANSPORT message.
5\. The Local AMF invokes the Namf_Communication_N2InfoNotify service
operation to the LMF.
### 6.4.4 Impacts on services, entities, and interfaces
LMF:
\- Exchange the Non-UE associated Network Positioning message with RAN node
via the Local AMF.
\- Send the UE location directly to the GMLC.
Local AMF:
\- Receives UE or non-UE associated Network Positioning message from the RAN
node.
\- Forward the UE or non-UE associated Network Positioning message towards the
LMF identified by the Routing ID.
RAN node:
\- Sends UE or non-UE associated Network Positioning message towards the Local
AMF.
## 6.5 Solution #5: LCS architecture with \"any AMF\"
### 6.5.1 Introduction
This solution is applicable to LCS procedure including MO-LR, MT-LR, and LDR.
When network based positioning method is selected by LMF, the signalling
between LMF and NG-RAN, LMF and GMLC, are not transmitted to the AMF in the
public network.
### 6.5.2 Functional Description
Architecture for this solution is illustrated as below.
Figure 6.5.2-1: Architecture for NPN
When UE registers to the network, NG-RAN 1 is the serving RAN node for the UE.
NG-RAN 1 shall select an AMF in the public network\'. It is assumed, by means
of configuration, that \"any AMF\" cannot be selected as the serving AMF of
the UE.
Multiple RAN nodes are deployed in the campus network. At a given time, only a
certain RAN (e.g. RAN 1 in the figure) is the serving RAN of the UE. Other RAN
nodes may be selected by the LMF to measure the UE positioning signal.
It is assumed all RAN nodes in the campus network have TNL association and NG-
AP connection with the \"any AMF\".
Current LCS design assumes NG-RAN report UE measurement to AMF (NRPPa message)
and then to LMF. Because the NG-AP message may not be cyphered, it is likely
the information will be sniffed by other entity in the transport network,
which leads to exposure concern.
**It is proposed to update the NRPPa signalling as follows:**
During the location request procedure, if network based positioning method is
selected by LMF, for UE associated NRPPa signalling, it is transmitted via the
serving AMF. For non UE associated NRPPa signalling, it is transmitted using
\"any AMF\" deployed in the campus network.
The description of using \"any AMF\" is specified in TS 38.305 [6]:
_An LMF can interact with any gNB reachable from any of the AMFs with
signalling access to the LMF in order to obtain location related information
to support the NR RAT-Dependent positioning methods. The information can
include timing information for the TRP in relation to either absolute GNSS
time or timing of other TRPs and information about the supported cells and
TRPs including PRS schedule._
_Signalling access between the LMF and gNB may be via any AMF with signalling
access to both the LMF and gNB._
\"any AMF\" is an AMF defined in TS 23.501, and needs to support the following
functionality in this solution.
\- handling of Namf_nonUEN2message transfer service from LMF;
\- NG-AP message capsulation and decapsulation for UL and DL non UE associated
NRPPa message.
Other functionalities supported by the AMF may not be needed in \"any AMF\".
NOTE 1: Based on configuration by the campus network, the NG-RAN(s) are
configured with the \"any AMF\" address, and establish NG-AP association with
the any AMF.
Topology of NG-RAN, \"any AMF\" and LMF are configured by the operator. LMF is
configured with \"any AMF\" address. NG-RAN nodes in the campus network
establishes TNL association with \"any AMF\" in the campus network.
NOTE 2: this solution is for the positioning procedure using UL positioning
method. Regarding the positioning procedure using DL positioning method,
solution#3 can be a candidate.
### 6.5.3 Procedures
#### 6.5.3.1 Network Assisted Positioning Procedure
Same as clause 6.11.2 of TS 23.273 [5].
The AMF illustrated in this call flow is the serving AMF of the UE.
Figure 6.5.3.1-1: Network assisted positioning procedure
#### 6.5.3.2 Obtaining Non-UE Associated Network Assistance Data
Same as clause 6.11.3 of TS 23.273 [5].
The AMF illustrated in this call flow is \"any AMF\" deployed in the campus
network. LMF is configured with \"any AMF\" address. NG-RAN nodes in the
campus network establishes TNL association with \"any AMF\" in the campus
network.
Figure 6.5.3.2-1: Obtaining Non-UE associated network assistance data
### 6.5.4 Impacts on services, entities, and interfaces
LMF:
\- configured with \"any AMF\" address.
\- if network based positioning method is selected by LMF, for UE associated
NRPPa signalling, it is transmitted via the serving AMF. For non UE associated
NRPPa signalling, it is transmitted using \"any AMF\" deployed in the campus
network.
NG-RAN:
\- establishes TNL association with \"any AMF\".
## 6.6 Solution #6: LMF selection based on LMF ID
### 6.6.1 Introduction
This solution aims to address the key issues#3: Local Area Restriction for an
LMF and GMLC. In this solution the LMF discovery and selection mechanism is
enhanced to use LMF ID as input parameter.
### 6.6.2 Functional Description
In this solution, the GMLC is configured with an LMF ID of the LMF located
within the same local area of the GMLC. The LMF may register itself in the
NRF. The GMLC provides the LMF ID to AMF in
Namf_Location_ProvidePositioningInfo service operation. The AMF uses the LMF
ID to discover the LMF via NRF query or local configuration and invokes the
Nlmf_Location_DetermineLocation service operation to request the current
location of the UE.
### 6.6.3 Procedures
Figure 6.6.3-1: 5GC-MT-LR procedure
1\. The external location services client sends a request to the GMLC for a
location for the target UE identified by an GPSI or an SUPI.
2\. The GMLC invokes a Nudm_UECM_Get service operation towards the home UDM of
the target UE to be located with the GPSI or SUPI of this UE.
3\. The UDM returns the network addresses of the current serving AMF.
4\. The GMLC invokes the Namf_Location_ProvidePositioningInfo service
operation towards the AMF to request the current location of the UE. The
service operation includes the SUPI, and client type and may include the
required QoS and Supported GAD shapes. The service operation may also include
the LMF ID if it is configured in the GMLC.
5\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure as defined in clause 4.2.3.3 of TS 23.502 [3] to
establish a signalling connection with the UE.
6\. The AMF selects the LMF based on the LMF ID received from GMLC. The
selection may use a NRF query or local configuration.
7-11. Same steps 7-11 in clause 6.1.1 of TS 23.273 [5].
### 6.6.4 Impacts on existing entities and interfaces
GMLC:
\- Configured with LMF ID in the same location area.
\- Send the LMF ID to AMF in Namf_Location_ProvidePositioningInfo service
operation.
AMF:
\- Select the LMF according to the LMF ID received from the GMLC.
## 6.7 Solution #7: LMF selection based on client or AF identifier
### 6.7.1 Introduction
This solution is to address KI#3: Local Area Restriction for an LMF and GMLC.
LMF selection functionality is used by the AMF to determine an LMF for
location estimation of the target UE. In some local cases, operators may
deploy specific LMF and GMLC for enterprises for some customized or privacy
requirements. But the UEs of different enterprises may share the same AMF or
AMF pool. In order to select the right LMF for specific enterprise, AMF could
use new identifiers which can map between enterprise and specific LMF.
### 6.7.2 Functional Description
Based on the scenarios mentioned above, AMF may use client identifiers or AF
identifiers as one of the additional factors during the LMF selection, as
specified in clause 5.1 in TS 23.273 [5]. The client and AF request the
location information of the target UE, whose identifiers are assigned by the
operator. The selection policy can be configured locally at AMF, or by
querying NRF.
If the LMF selection is performed at the AMF by querying NRF, LMF shall
register with the client or AF identifier(s) that the LMF can serve.
### 6.7.3 Procedures
N/A.
### 6.7.4 Impacts on services, entities, and interfaces
AMF:
\- Take AF or client identifier(s) into account during the LMF selection.
AF:
\- Provide the AF identifier(s) in location service procedures.
UE:
\- Provide the client or AF identifier(s) to AMF in location service
procedures.
LMF:
\- Register in NRF with serving AF or client identifier(s).
## 6.8 Solution #8: LMF Selection based on GMLC service area
### 6.8.1 Introduction
This solution addresses KI#3: Local Area Restriction for an LMF and GMLC.
### 6.8.2 Functional Description
The existing LMF selection mechanism is re-used with the following
enhancements:
\- When AMF selects LMF: a new factor considered for LMF selection is added,
i.e. GMLC service area consisting of one or more TA(s) which is locally
configured in AMF.
\- When AMF selects target LMF: if the GMLC is restricted to supporting local
services in a local area, it selects target LMF able to support location in
the same local area.
### 6.8.3 Procedures
The existing LMF Change Procedure in clause 6.4 in TS 23.273 [5] is re-used.
### 6.8.4 Impacts on services, entities, and interfaces
AMF:
\- Consider GMLCS service area when selecting LMF.
LMF:
\- If the LMF is restricted to supporting local services in a local area, it
selects target LMF in the same local area.
## 6.9 Solution #9: local LMF and GMLC selection
### 6.9.1 Introduction
This solution enables dedicated LMF and GMLC selection for the UE positioning
in the local network. The solution addresses key issue 1 and key issue 3.
### 6.9.2 Functional Description
Three options are proposed for the AMF to select a local LMF and local GMLC:
\- Based on operator\'s configuration. An example could be a mapping table of
UE identity e.g. GPSI and LMF/GMLC address is stored at AMF.
\- Fetch from UDM, UE LCS subscription storing its serving local LMF and local
GMLC address.
\- UE LCS subscription data indicate a set of parameters including the
dedicated DNN, UPF, and LMF/GMLC. When retrieved by AMF, User Plane
positioning is determined for UE positioning. AMF triggers the PDU session
establishment by indicating SMF with the UPF, and LMF/GMLC identifier. For
example, in solution#3 step 0c, when AMF receives the PDU session request from
UE, AMF includes the UPF, and LMF/GMLC identifier to the SMF, when invoking a
Nsmf_session create service operation.
### 6.9.3 Procedures
#### 6.9.3.1 5GC-MT-LR Procedure for the commercial location service
Is clause 6.1.2 of TS 23.273 [5].
Figure 6.9.3.1-1: Local LMF selection during 5GC-MT-LR procedure for the
commercial location service
Other steps are same as in TS 23.273 [5], except step 10:
10\. AMF, based on local configuration, e.g. mapping table mapping table of UE
identity e.g. MSISDN and LMF address, or the UE LCS subscription data where
includes a dedicated LMF ID, selects an LMF.
#### 6.9.3.2 integration with user plane positioning
During the UE initial registration procedure, AMF retrieves the UE LCS
subscriber data from UDM. If the subscriber data includes the DNN, UPF, and
LMF/GMLC, AMF determines to trigger the PDU session establishment for user
plane positioning using these parameters. Procedures are described in
solution#3.
### 6.9.4 Impacts on services, entities, and interfaces
AMF:
\- configured locally, a mapping table of UE identity e.g. MSISDN and LMF/GMLC
address is stored at AMF.
\- Fetch from UDM, UE LCS subscription storing its serving local LMF and local
GMLC address.
\- Determine the LMF for the location request.
UDM:
\- Stores UE LCS subscriber data including:
\- serving local LMF and local GMLC address;
\- a set of parameters including the dedicated DNN, UPF, and LMF/GMLC.
## 6.10 Solution #10: Support interaction between location service and NWDAF
### 6.10.1 Introduction
This solution addresses KI#4: Interaction between Location Service and NWDAF.
### 6.10.2 Functional Description
This solution reuses the existing architecture and interfaces to support
interaction between location service and NWDAF:
\- Based on description in clause 4.3.2 of TS 23.273 [5], the LCS service
supports NFs to access LCS services from a GMLC. So the Ngmlc interface is re-
used when NWDAF obtains UE location by invoking LCS services.
\- Based on description in clause 4.2.0 of TS 23.288 [9], any 5GC NF can
request network analytics information from NWDAF. So the Nnwdaf interface is
re-used when LMF obtains data analytics from the NWDAF. In this solution, the
LMF selects positioning method based on WLAN performance analytics from the
NWDAF.
\- The existing privacy check mechanism is re-used with enhancements of
introducing the following new LCS Client Type and Service Type which are used
by NWDAF to request UE location:
\- new LCS Client Types for PLMN Operator Class:
\- NWDAF client in the HPLMN (when the UE is currently being served by the
HPLMN);
\- NWDAF client in the VPLMN；
\- exempted NWDAF client in the HPLMN (when the UE is currently being served
by the HPLMN);
\- exempted NWDAF client in the VPLMN.
NOTE: For the exempted NWDAF client in the HPLMN and the exempted NWDAF client
in the VPLMN, which may indicate the privacy check is performed on the NWDAF
side, then the privacy check procedure in LCS will be skipped in some
scenarios with the signalling reduction purpose. Performing the privacy check
on the NWDAF side needs coordination work with eNA_Ph3.
\- new standardized Service Type for Tracking Services:
\- Analytics;
\- Model training.
\- The NWDAF may invoke LCS services for a SUPI, a list of SUPI or an internal
group identifier. The NWDAF determines the identifier as described in TS
23.288 [9].
### 6.10.3 Procedures
#### 6.10.3.1 NWDAF accesses location service
Figure 6.10.3.1-1: NWDAF accesses location service based on existing mechanism
1\. NWDAF invokes Ngmlc_Location_ProvideLocation Request to GMLC.
The NWDAF includes the LCS Client Type, Service Type, LCS QoS and UE
identifier in the Request.
The LCS Client Type is NWDAF client in the HPLMN (when the UE is currently
being served by the HPLMN) or NWDAF client in the VPLMN. The Service Type is
analytics or model training. The UE identifier is SUPI, SUPI list or an
internal group identifier.
If the NWDAF requests location of any UE within an Area of Interest, it
provides the Area of Interest instead of UE identifier.
2\. The GMLC performs steps 2-23 in clause 6.1.2, or steps 2-29 in clause
6.3.1, or triggers the procedure in clause 6.8 of TS 23.273 [5].
If the UE identifier is SUPI, the GMLCS performs steps 2-23 in clause 6.1.2,
or steps 2-29 in clause 6.3.1 of TS 23.273 [5]. If the UE identifier is SUPI
list, the GMLC performs the procedure above for each SUPI in the list. If the
UE identifier is an internal group identifier, the GMLC performs the procedure
in clause 6.8 of TS 23.273 [5].
If the NWDAF provides an Area of Interest in step 1, the GMLC obtains from AMF
a list of UEs located within the Area of Interest and then performs step 2.
3\. The GMLC sends Ngmlc_Location_ProvideLocation Response to NWDAF.
#### 6.10.3.2 LMF obtains data analytics from NWDAF
The procedure in clause 6.11.4 of TS 23.288 [9] can be re-used.
### 6.10.4 Impacts on services, entities, and interfaces
LMF:
\- Selects positioning method based on data analytics from NWDAF.
GMLC:
\- If the UE identifier is SUPI list in the Ngmlc_Location_ProvideLocation
Request, the GMLC triggers the existing positioning procedure for each SUPI in
the list.
## 6.11 Solution #11: Interaction Enhancement between LCS and NWDAF
### 6.11.1 Introduction
This solution addresses the KI \"Key Issue #4: Interaction between Location
Service and NWDAF\".
### 6.11.2 Functional Description
TS 23.273 [5] defines LCS QoS to have the following attributes:
\- Location Accuracy.
\- Response time.
\- QoS Class.
Among these, the QoS Class attribute gives the requirement on the other
attributes like accuracy or response time. It could take values Best Effort,
Multiple QoS Class or Assured. While the Best Effort class is the least
stringent one, the other two require the LMF to determine how accurate its
location estimate is.
For example:
\- In the case of \"Multiple QoS Class\", if the accuracy is less than what is
required, the LMF shall rerun the estimate with more measurements etc. to
achieve the accuracy required.
\- In the case of \"Assured\" QoS Class, the procedure fails if the accuracy
required is not met.
This is a data analytics-based solution that shall run in the NWDAF where a
Machine Learning model is trained using data like positioning estimate,
positioning method used, assistance data, UE ID, time of the day etc. and
corresponding accuracy. This model is then subsequently used by the LMF to
determine if its location estimate meets the accuracy required and take
appropriate action. To enable this, the LMF makes use of a Service Based API
that is exposed by the NWDAF.
### 6.11.3 Procedure
Figure 6.11.3-1: ML based positioning accuracy
Step 0.1: The LMF invokes NWDAF API to subscribe to the Analytics ID
corresponding to Location Accuracy for a given target area, this acts as a
trigger for the NWDAF to do the offline training of the corresponding ML
model.
Editor\'s note: Whether to use new Analytics ID or reuse existing one is FFS
and may need to be decided in coordination with eNA_ph3.
Step 0.2: The NWDAF performs the offline training of the model using
supervised data. It may also access labelled data collected from eg.MDT for
its training purposes. The training is complete waiting for analytics request
from the LMF for that Analytics ID.
Step 1: LCS Client requests UE location with QoS Class as either \"Multiple
QoS Class\" or \"Assured\" along with the location accuracy required. The
expected behaviour from the LMF is as given in clause 6.11.2.
Step 2: The LMF initiates the LCS session as given in TS 23.273 [5] and
derives the UE location estimate
Step 3: The LMF then queries the NWDAF for the location estimate accuracy
giving as inputs the subscribed Analytics ID, location estimate and other
parameters like UE ID, assistance data, time of the day etc. The NWDAF uses
the corresponding model trained in Step: 0.2 and provides the location
accuracy as the output to the LMF.
NOTE 1: The training done in step 0.2 gives the ML model the ability to
predict the location accuracy without the need for a reference location
estimate. This is made possible by the extensive training done using various
accuracy/reference values, which result in the computing of weights in the ML
model. Such a trained model can then be used for an inference/prediction of
the location accuracy in this step. An internal PoC has shown very encouraging
results using such an ML model
NOTE 2: The NWDAF and related aspects of this solution to be further discussed
in FS_eNA_Ph3, as part of Key Issue #9: Enhancement of NWDAF with finer
granularity of location information given in TR 23.700-81 [23].
Step 4: LMF compares the location accuracy got in step 3 with the required
location accuracy got in step 1 from the LCS Client.
Step 5: If the required location accuracy is not met, the LMF may take
subsequent actions like re-executing the LCS procedure with more stringent
parameters (for example: higher periodicity measurements).
Step 6: The LMF returns the location estimate with the required accuracy.
### 6.11.4 Impacts on services, entities, and interfaces
LMF:
\- To request and receive analytics corresponding to Location Accuracy for a
given target area from NWDAF.
\- To decide whether the required location accuracy is met or not based on the
analytics provided by NWDAF.
NWDAF:
\- To support Analytics ID corresponding to Location Accuracy for a give
target area.
\- To provide the Location Accuracy analytics to LMF.
## 6.12 Solution #12: Supporting analytics for location accuracy
### 6.12.1 Description
As part of the location services requirements defined in TS 22.071 [18], one
of the main requirements for the LCS service is the support of Location
Accuracy.
The location accuracy is provided in terms of horizontal, vertical accuracy
and response time. In general the accuracy of the location depends on the
positioning technology used, the varying radio environments (e.g. considering
multipath propagation), the type of environment where the location is measured
(dense urban area or rural area).
The location accuracy required by each service varies and can vary from
location accuracy up to 200km for weather services to location accuracy of up
to 50m for Asset Location, route guidance, navigation. Further information is
provided in Table 4.1 of TS 22.071 [18].
When a location client requires a location accuracy the location client may
include in the request to the GMLC:
\- A response time (no delay, low delay, delay tolerant).
\- Horizontal and/or vertical accuracy requirements (in meters).
\- LCS QoS Class (best effort, assured or multiple QoS corresponding to a
priority of QoS accuracy).
When the LMF determines the location the LMF also determines the accuracy of
the location and also whether the location requirements are met which are sent
to the GMLC. The GMLC responds to the client the accuracy of the location
measurement can be met.
Analytics from the NWDAF can be enhanced to allow a location client to be
aware if a location accuracy can be met. Example consumers of such analytics
is as follows:
\- LMF uses the analytics to identify the best positioning method to use to
determine a location in a specific area, taking into account UE capabilities,
QoS requirements and operator policies.
\- The location client can determine to upgrade/downgrade the requested LCS
QoS taking into account the analytics of location accuracy.
\- The location client can adapt the application service accordingly. For
example, a navigation service can take into account areas where location
accuracy cannot be met when providing route guidance.
### 6.12.2 Procedures
A consumer (e.g. a location client) requests from the NWDAF analytics for
\"Location Accuracy Sustainability\". The request may also include the
following as Analytic Filters:
\- A target area.
\- A target UE (not applicable for option 1), group of UEs (not applicable for
option 1) or any UE.
\- Time of Day.
\- An LCS QoS Class or Horizontal/Vertical Accuracy requirement (denotes the
requested LCS QoS or Horizontal/Vertical accuracy requirement.
\- Optionally a positioning method used.
\- A location accuracy threshold, i.e. report accuracy analytics only if the
location accuracy exceed an horizontal or a vertical accuracy threshold (in
meters).
The analytics consumer may also include as Analytic Filters within the
location request the following:
\- An indication to report the ratio of UEs using LOS/NLOS measurements in a
target area.
Two options are available from the NWDAF to collect input data for Location
Measurement Accuracy:
\- Option 1: Data Producer is the LMF (applicable when an analytics consumer
requests Location Accuracy Analytics for any UE for a specific Target Area).
\- Option 2: Data Producer is the GMLC.
**Data collection for Option 1:**
The NWDAF finds the LMF that servers a target area. The NWDAF then invokes a
new SBI (e.g. Nlmf_Event_Exposure) and requests data from the LMF identified
by a new Event ID, e.g. \"Location Measurement Accuracy request\". The LMF
based on the Event ID requested provides information on accuracy of a
measurement of a location when a location measurement is made by the LMF.
\'The LMF provides measurements reports to the NWDAF as follows:
\- The LMF provides measurements report for any location request received by
the LMF by a location client (the request is received via the GMLC).
\- If the request includes a requested LCS QoS class or horizontal/vertical
accuracy the LMF provides a measurements report when the LMF receives a
location request from a location client with the requested accuracy.
\- If the request includes a positioning method, the LMF provides measurements
report when the LMF determines the location using the position method used.
\- If the request includes an LOS/NLOS ratio the LMF triggers the UEs to
report whether a measurement was made according to LOS or NLOS measurements.
The procedure is shown below:
Figure 6.12.2-1: Procedure to derive analytics for location accuracy
sustainability(Option 1)
1\. A Consumer requests analytics for location accuracy sustainability from
the NWDAF. The request may include a target area, a time of day, a target UE
(or group of UEs or any UE). The request may also include, to report analytics
for a specific LCS QoS requirement or horizontal/vertical accuracy.
2\. The NWDAF finds the LMF serving the UE target area (Option 1) by querying
the NRF.
3\. The NWDAF sends a request to the LMF to provide location measurement
accuracy data (the request may be a subscription or a one-time request). The
NWDAF includes in the request to the LMF information to satisfy the
requirements of the consumer in step 1.
4a-4c. The LMF is triggered to provide a location from a location client as
per procedure in TS 23.273 [5]. The LMF derives the location of the UE.
5\. The LMF determines that the location measured is in an area where the
NWDAF has subscribed to report location measurements. The LMF reports the
location accuracy to the NWDAF.
6\. The data are provided to the NWDAF.
7\. The NWDAF derives analytics for location accuracy.
8\. The NWDAF provides analytics to the consumer.
**Data collection for Option 2:**
The NWDAF subscribes from GMLC to obtain location data for a UE or any UE. The
NWDAF discovers GMLC from NRF and invokes (via a new SBI) to retrieve data
about the location measurement accuracy (optionally per positioning method).
The GMLC provides measurements report to the NWDAF as follows:
\- If the request target any UE the GMLC provides measurements report for any
location request received by a location client
\- If the request target a specific UE, the GMLC provides measurements report
when the GMLC receives a location request from a location client that targets
the specific UE.
\- If the request includes a requested LCS QoS class or horizontal/vertical
accuracy the GMLC provides measurements report when the GMLC receives a
location request from a location client with the requested accuracy
\- If the request includes a positioning method, the GMLC provides
measurements report when the GMLC receives information (from the AMF) on the
positioning method used by the LMF to determine the location of the UE.
The procedure is shown below:
Figure 6.12.2-2: Procedure to derive analytics for location accuracy
sustainability (Option 2)
1\. A Consumer requests analytics for location accuracy sustainability from
the NWDAF. The request may include a target area, a time of day, a target UE
(or group of UEs or any UE). The request may also include, to report analytics
for a specific LCS QoS requirement or horizontal/vertical accuracy.
2\. The NWDAF finds the GMLC from the NRF
3\. The NWDAF sends a request to the GMLC to provide location measurement
accuracy data (the request may be a subscription or a one-time request). The
NWDAF includes in the request to the GMLC information to satisfy the
requirements of the consumer in step 1.
4a-4b. The GMLC is triggered to provide a location from a location client as
per procedure in TS 23.273 [5]. The GMLC invokes a location request to the
AMF/LMF according to TS 23.273 [5]. The GMLC receives location information
from the AMF/LMF including information indicating if the location accuracy
requested has been met and the positioning method used.
5\. The GMLC determines to report the location information to the NWDAF.
6\. The data are provided to the NWDAF
7\. The NWDAF derives analytics for location accuracy .
8\. The NWDAF provides analytics to the consumer.
The following input data are required by the NWDAF to measure location measure
accuracy.
Table 6.12.2-1: Location measurement accuracy data collected by NWDAF
+-----------------------------+--------+-----------------------------+ | Information | Source | Description | +-----------------------------+--------+-----------------------------+ | Location Measurement | LMF or | Includes information on the | | accuracy data | | Position Method used, the | | | GMLC | requested LCS QoS or | | | | horizontal/accuracy and | | | | whether the location | | | | accuracy request was | | | | satisfied | +-----------------------------+--------+-----------------------------+ | Timestamp | LMF or | The time where the location | | | | was measured by the LMF | | | GMLC | | +-----------------------------+--------+-----------------------------+ | LOS or NLOS measurements | LMF | Indication whether the UE | | | | measurements was based on | | | | LOS/NLOS measurements | +-----------------------------+--------+-----------------------------+ | UE Location | AMF | The location area of the UE | | | | when the location | | | | measurement was made | +-----------------------------+--------+-----------------------------+
The analytics output to the consumer may include one of the following:
Table 6.12.2-2: \"Location Accuracy Sustainability\" statistics
Information Description
* * *
List of Accuracy Analytics (1..max)  
>Applicable Area A list of TAIs or Cell IDs within the Location information
that the analytics applies to. >Applicable Time Period The time period within
the Analytics target period that the analytics applies to. >The requested LCS
QoS The analytics provide a delta against the request measurement accuracy
level from a consumer. > List of SUPIs A list of SUPIs experiencing the same
analytics accuracy. > Positioning Method The positioning method used to
measure location. > Ratio of NLOS/LOS measurements in target area Provides a
ratio of LOS to NLOS measurements reported by the UE in the target area. >
Percentage of analytics accuracy above/below requested thresholds A percentage
indicating if the requested analytics accuracy is met.
Table 6.12.2-3: \"Location Accuracy Sustainability\" predictions
Information Description
* * *
List of Accuracy sustainability Analytics (1..max)  
>Applicable Area A list of TAIs or Cell IDs within the Location information
that the analytics applies to. >Applicable Time Period The time period within
the Analytics target period that the analytics applies to. > The requested LCS
QoS The analytics provide a delta against the request measurement accuracy
level from a consumer. > List of SUPIs A list of SUPIs experiencing the same
analytics accuracy. > Positioning Method The positioning method used to
measure location. > Ratio of NLOS/LOS measurements in target area Provides
predicted ratio of LOS to NLOS measurements of UEs in target area. >
Percentage of analytics accuracy above/below requested thresholds A percentage
prediction indicating if the requested analytics accuracy is met. >Confidence
Confidence of the prediction.
### 6.12.3 Impacts on services, entities and interfaces
\- Applicable to Option 1: New Nlmf event notification service to allow the
NWDAF to retrieve location measurement reports from the LMF.
\- Applicable to Option 2: NWDAF support Ngmlc service based interfaces to
retrieve location information for a UE.
## 6.13 Solution #13: Architecture enhancement for the interaction between LCS
and NWDAF
### 6.13.1 Introduction
The solution is intended to address and resolve Key Issue 4: Interaction
between Location Service and NWDAF.
Here are three schemes that can be a potential basis to support the finer
granularity location information interaction between LCS and NWDAF, i.e. AMF
interacts with NWDAF, GMLC interacts with NWDAF, and LMF interacts with NWDAF.
This solution aims to enhance the interfaces between AMF and NWDAF with the
consideration of the reduction of the time latency and the signalling flows.
The interaction between AMF and NWDAF is enhanced to support the delivery of
the finer granularity location information, including the finer geographical
location, velocity, accuracy, and other necessary information. When the
location information request is received in AMF from NWDAF, the AMF has a
responsibility to distinct the requested granularity to determine whether it
is necessary to initiate a request to LMF. If the granularity is TA/cell
level, the AMF returns the TA/cell level location to the NWDAF as specified in
TS 23.288 [9]. If the granularity is finer than the TA/cell level and other
requirements are received in the requested message, the AMF initiates a
location request to LMF.
To solve the aforementioned issue, this solution proposes a scheme to support
location information delivery between LCS architecture and NWDAF.
### 6.13.2 Architecture
Figure 6.13.2-1: Interaction between LCS and NWDAF architecture
Figure 6.13.2-1 is similar to Figure 4.2.1-1 in TS 23.273 [5] and additionally
supports the enhancement of the service-based interface between AMF and NWDAF.
\'Enhanced Service Based Interfaces proposed in this solution comprise:
**Nnwdaf:** Service-based interface exhibited by NWDAF.
**Namf:** Service-based interface exhibited by AMF.
In addition, this solution utilizes the existing service operations defined in
TS 23.502 [3] and TS 23.273 [5] for the Nlmf and Nudm service based
interfaces.
As for privacy check for location service, this solution supports performing
privacy check on the NWDAF side in some scenarios with the signalling
reduction purpose. The NWDAF sends location requests for the SUPI with an
indication to exempt the privacy check in LCS only when the user consent and
the privacy check of this SUPI are all passed on the NWDAF side. The LCS
architecture skips the privacy check accordingly. Otherwise, the NWDAF will
not initiate the location request for the SUPI.
NOTE: Performing the privacy check on the NWDAF side needs coordination work
with eNA_Ph3.
In detail, if the result of the privacy check for call/session unrelated class
is \"Location allowed without notification\" then the NWDAF acquires the UE
location as normal without notifying the UE. If the indicator of privacy check
indicates the UE must either be notified or notified with privacy
verification, then the NWDAF request to the AMF with an indication of a
privacy related action and the AMF sends a notification invoke message to the
target UE.
### 6.13.3 Procedures
#### 6.13.3.1 One-time Collection Procedure
Figure 6.13.3.1-1 illustrates the one-time data collection from NWDAF to LCS
architecture. In this scenario, it is assumed that the target UE(s) is
identified using a SUPI or GPSI. This procedure is applicable to a request
from NWDAF for immediately location collection.
Figure 6.13.3.1-1: AMF provides UE location information to NWDAF (One-time
Collection)
1\. The NWDAF invokes a Nudm_UECM_Get service operation towards the home UDM
of the target UE to be located with the GPSI or SUPI of the UE. If the NWDAF
needs to have a trajectory or the location of the target UE and the user
consent has been checked to allow the NWDAF to collect and use the location
information, then the NWDAF process this procedure.
2\. The UDM returns the address of the current serving AMF for the target UE.
3\. The NWDAF invokes the location information request towards the AMF to
request the location of the UE. The service operation includes the SUPI, the
required location granularity, and may include the collection type, an
indication of velocity information and the required QoS, which includes
accuracy, latency, and QoS class.
4\. The AMF determines whether the required location granularity can be
provided by AMF itself. If the finer granularity location is required, the AMF
selects an LMF based on NRF query or configuration in AMF.
5\. The AMF invokes the Nlmf_Location_DetermineLocation service operation
towards the LMF to request the location information of the UE. The service
operation includes an LCS Correlation identifier, the access type and may
include the required QoS, which includes accuracy, latency, and QoS class.
6\. The LMF initiates the positioning procedure toward UE.
7\. The LMF returns the Nlmf_Location_DetermineLocation Response towards the
AMF to return the location information of the UE. The service operation
includes the location estimate and may include velocity estimate, the age of
location information, the timestamp, achieved QoS, which includes accuracy,
latency and QoS class.
8\. The AMF returns the Namf_Location_ProvideLocation Response towards the
NWDAF to return the location information of the UE.
#### 6.13.3.2 Continuous Collection Procedure
Figure 6.13.3.2-1 illustrates the continuous data collection from NWDAF to LCS
architecture using event reporting. In this architecture, it is assumed that
the target UE(s) is identified using a SUPI or GPSI. This procedure is
applicable for the request from NWDAF for the deferred location reporting.
Figure 6.13.3.2-1: AMF provides UE location information to NWDAF (Continuous
Collection)
1\. The NWDAF invokes a Nudm_UECM_Get service operation towards the home UDM
of the target UE to be located with the GPSI or SUPI of the UE. If the NWDAF
needs to collect the trajectory or the location of the target UE and the user
consent has been checked to allow the NWDAF to collect and use the location
information, then the NWDAF process this procedure.
2\. The UDM returns the address of the current serving AMF of the target UE.
3\. The NWDAF invokes the location information request towards the AMF to
request the location of the UE. The service operation includes the SUPI, the
required location granularity and may include the collection type, the event
type, an indication of velocity information and the required QoS, which
includes accuracy, latency, and QoS class.
The NWDAF includes trigger or periodic event types in the location information
request message. The AMF delivers event types to LMF and then LMF sends to the
UE are specified as the current deferred MT-LR procedure.
4\. The AMF determines whether the required location granularity can be
provided by AMF itself. If the finer granularity location is required the AMF
selects an LMF based on NRF query or configuration in AMF.
5\. The AMF invokes the Nlmf_Location_DetermineLocation service operation
towards the LMF to request the location information of the UE. The service
operation includes an LCS Correlation identifier, the access type and may
include the event type, the required QoS, which includes accuracy, latency,
and QoS class.
6\. The LMF initiates the positioning procedure towards UE.
7-8. The AMF includes in the notification to the UE the type of deferred
location request in the case of periodic or triggered location. The UE returns
a result to the LMF.
9-10. The LMF may report the current location information, including the age
of location information, the timestamp, event type, location estimate,
velocity estimate, achieved QoS accuracy and QoS class, to the AMF and then to
the NWDAF according to the periodic location reporting rule.
11\. The UE monitors for the occurrence of the trigger or periodic event
requested in step 7. When a trigger or periodic event is detected, the UE
needs to connect to LMF and report its location information.
12-13. The UE sends an event reporting to the LMF. This event report may
include the event type, location estimate, velocity estimate.
14\. One or more UE positioning may be needed in this scenario.
15-16. The LMF reports the current location information, which may include the
age of location information, the timestamp, event type, location estimate,
velocity estimate, achieved QoS accuracy and QoS class.
### 6.13.4 Impacts on existing entities and interfaces
#### 6.13.4.1 Impacts on AMF
\- Provides to NWDAF with finer granularity location data than TA/cell level
and other information, e.g. location estimate, velocity estimate, timestamp,
achieved QoS information.
#### 6.13.4.2 Impacts on NWDAF
\- Enhanced interface with AMF to request finer granularity location data than
TA/cell level.
\- Enable NWDAF to perform user consent and privacy check when requiring the
finer granularity location data than TA/cell level.
## 6.14 Solution #14: Unawareness positioning
### 6.14.1 Introduction
This solution addresses KI#6: UE Positioning without UE/User Awareness.
### 6.14.2 Functional Description
The principles of the solution are as follows:
\- UE unaware positioning:
\- If the UE is in CM_IDLE or RRC_INACTIVE state, the UE cannot be paged
during the positioning procedure. In this case, the 5GC provides the latest
stored UE location information to the LCS Client/AF if the requested accuracy
is achieved.
\- If the UE is in CM_CONNECTED state, the LMF selects uplink positioning
method (e.g. Uplink E-CID, Uplink NR-E-CID, UL-TDOA, UL-AoA) which requires
the NG-RAN configures the UE to report the measurement information, e.g.
E-UTRA RSRP, E-UTRA RSRQ measurements in UL E-CID. From UE point of view, it
has no idea that the measurement is related to positioning, so UE unawareness
can be achieved. Furthermore, the privacy check which requires interaction
with UE is also skipped.
\- The UE unaware positioning can be applied to the 5GC-MT-LR and NI-LR
procedures.
\- User unaware positioning:
\- If the UE is in CM_IDLE or RRC_INACTIVE state, the UE can be paged during
the positioning procedure.
\- The User unaware positioning can be applied to any existing positioning
procedure with the exception that the privacy check which requires interaction
with user is skipped.
### 6.14.3 Procedures
#### 6.14.3.1 UE unaware positioning
To support UE unaware positioning, enhancements to the existing 5GC-MT-LR
procedure and NI-LR procedure are described in this clause.
Enhancements to 5GC-MT-LR procedure for the regulatory location service in
clause 6.1.1 of TS 23.273 [5] are as follows:
\- Step 1: the LCS Service Request includes the UE unaware indication.
\- Step 4: the Namf_Location_ProvidePositioningInfo Request includes the UE
unaware indication.
\- If the UE is in CM_IDLE or RRC_INACTIVE state (if known by AMF by
requesting the NG-RAN to report RRC state information), the enhancements to
steps 5-11 are as follows:
\- Steps 5-9 are skipped.
\- Step 10: the AMF rejects the location request with appropriate rejection
cause or returns the Namf_Location_ProvidePositioningInfo Response which
includes the latest UE location information.
\- Step 11: the GMLC rejects the LCS Service Request if there is no UE
location can fulfil the QoS. Otherwise, the GMLC returns the LCS Service
Response with latest UE location.
\- If the UE is in CM_CONNECTED state, the enhancements to steps 5-11 are as
follows:
\- Step 7: the Nlmf_Location_DetermineLocation Request includes the UE unaware
indication. The LMF selects positioning method based on the UE unaware
indication.
\- If the UE is in RRC_INAVTIVE state (from AMF point of view, UE is CM-
CONNECTED), the enhancements to steps 5-11 are as follows:
\- Step 7: the Nlmf_Location_DetermineLocation Request includes the UE unaware
indication. The LMF selects positioning method based on the UE unaware
indication.
\- Step 8: The LMF sends NRPPa message including UE unaware indication to RAN.
Because UE cannot be paged, RAN rejects the NRPPa message.
\- Step 9: The LMF rejects the Nlmf_Location_DetermineLocation Reject with
appropriate rejection cause.
\- Step 10: the AMF rejects the location request with appropriate rejection
cause or returns the Namf_Location_ProvidePositioningInfo Response which
includes the latest UE location information.
\- Step 11: the GMLC rejects the LCS Service Request if there is no UE
location can fulfil the QoS. Otherwise, the GMLC returns the LCS Service
Response with latest UE location.
Enhancements to 5GC-MT-LR procedure for the commercial location service in
clause 6.1.2 of TS 23.273 [5] are as follows:
\- Steps 1a, 1b-1, 1b-2, 4, 5: the corresponding message includes the UE
unaware indication.
\- If the UE is in CM_IDLE or RRC_INACTIVE state(if known by AMF by requesting
the NG-RAN to report RRC state information), the enhancements to steps 6-24
are as follows:
\- Steps 5-21 are skipped.
\- Step 22: the AMF rejects the location request with appropriate rejection
cause or returns the Namf_Location_ProvidePositioningInfo Response which
includes the latest UE location information.
\- Step 23-24: the GMLC rejects the LCS Service Request if there is no UE
location can fulfil the QoS. Otherwise, the latest UE location is returned to
LCS Client or AF.
\- If the UE is in CM_CONNECTED state, the enhancements to steps 6-24 are as
follows:
\- Steps 7-9 are skipped.
\- Step 11: the Nlmf_Location_DetermineLocation Request includes the UE
unaware indication. The LMF selects positioning method based on the UE unaware
indication.
\- Steps 20-21 are skipped.
\- If the UE is in RRC_INAVTIVE state (from AMF point of view, UE is CM-
CONNECTED), the enhancements to steps 6-24 are as follows:
\- Step 11: the Nlmf_Location_DetermineLocation Request includes the UE
unaware indication. The LMF selects positioning method based on the UE unaware
indication.
\- Step 12: The LMF sends NRPPa message including UE unaware indication to
RAN. Because UE cannot be paged, RAN rejects the NRPPa message.
\- Step 13: The LMF rejects the Nlmf_Location_DetermineLocation Reject with
appropriate rejection cause.
\- Step 14: the AMF rejects the location request with appropriate rejection
cause or returns the Namf_Location_ProvidePositioningInfo Response which
includes the latest UE location information.
\- Step 16-23 are skipped.
\- Step 24: the GMLC rejects the LCS Service Request if there is no UE
location can fulfill the QoS. Otherwise, the GMLC returns the LCS Service
Response with latest UE location.
Enhancements to 5GC-NI-LR procedure in clause 6.10.1 of TS 23.273 [5] are as
follows:
\- Step 1: the AMF decides that the positioning is UE unaware based on
configuration.
\- Step 2: the Nlmf_Location_DetermineLocation Request includes the UE unaware
indication. The LMF selects positioning method based on the UE unaware
indication.
#### 6.14.3.2 User unaware positioning
To support user unaware positioning, enhancements to the existing procedures
are described in this clause.
Enhancements to 5GC-MT-LR procedure for the commercial location service in
clause 6.1.2 of TS 23.273 [5] are as follows:
\- Steps 1a, 1b-1, 1b-2, 4, 5: the corresponding message includes the user
unaware indication.
\- Steps 7-9, 20-21 are skipped.
Enhancements to Deferred 5GC-MT-LR procedure for Periodic, Triggered and UE
Available Location Events in clause 6.3 of TS 23.273 [5] are as follows:
\- Steps 1a, 1b-1, 1b-2, 4, 5: the corresponding message includes the user
unaware indication.
\- Steps 11-12 are skipped.
### 6.14.4 Impacts on services, entities, and interfaces
GMLC:
\- To support UE unaware positioning: receive UE unaware positioning
indication from LCS Client and send the indication to AMF.
\- To support user unaware positioning: receive user unaware positioning
indication from LCS Client and send the indication to AMF.
AMF:
\- To support UE unaware positioning:
\- If UE is in CM_IDLE or RRC_INACTIVE state (if known by AMF), the AMF does
not page UE. The AMF rejects the request or returns the latest UE location to
GMLC.
\- If UE is in CM_CONNECTED state, the AMF sends the UE unaware indication to
LMF.
\- To support user unaware positioning: the AMF does not send the NAS Location
Notification Invoke Request to UE.
LMF:
\- To support UE unaware positioning:
\- Receives the UE unaware indication from AMF and selects positioning method
based on the indication.
\- Sends the UE unaware indication included in the NRPPa message to NG-RAN.NG-
RAN:
\- To support UE unaware positioning: receives the UE unaware indication from
LMF and rejects the NRPPa request if UE is in RRC_INACTIVE state.
LCS Client/AF:
\- To support UE unaware positioning: send UE unaware positioning indication
to GMLC.
\- To support user unaware positioning: send user unaware positioning
indication to GMLC.
## 6.15 Solution #15: PRU assisted LCS architecture and procedure
### 6.15.1 Introduction
This solution addresses Key Issue #7, especially on the enable of the PRU
management in 5GC and utilize the PRU to enhance the LCS procedure.
### 6.15.2 Functional Description
The procedures in clause 6.15.3.1 is used for 5GC to obtain the available
PRU(s) information. The procedures in clauses 6.15.3.2 and 6.15.3.3 are used
for the 5GC to choose the candidate PRU(s) and to use the candidate PRU(s) to
enhance the location service procedure.
#### 6.15.2.1 PRU Information
The PRU information consists the following aspects:
\- Capability: indicate the capability a PRU supports positioning signal
transmission capability and positioning measurement capability on Uu and PC5,
based on that information, PRUs could be selected as candidate PRUs to assist
the positioning of other UE.
NOTE 1: The positioning signal transmission capability and signal measurement
capability on PC5 relates to the study in RAN WG.
\- Location information, e.g. whether absolute location coordinates are
available and to which degree of accuracy. This is required if a PRU to be
utilized for timing calibration or to be utilized to complete the insufficient
LoS path. The location information may include other parameters, such as
velocity information, time stamps or duration of valid location information
etc.
\- Mobility state, whether a PRU is fixed or mobile.
\- State indication, e.g. ON/OFF: this indicates whether a PRU is enabled to
assist positioning of the other UEs.
#### 6.15.2.2 PRU Information Acquisition
PRU information could be obtained by 5GC via three different ways:
i. Registration to AMF:
A UE can be registered as a PRU. When a PRU registers to the network, the PRU
information may be included in the UE context data and obtained by the AMF.
After receive the PRU registration, the AMF sends message to NRF to indicate
PRU existence in certain area (e.g. the TAI of the PRU location).
ii. Registration to LMF:
A UE can be configure as a PRU by a NF, e.g. LMF. LMF obtains PRU information
via AMF. This information may be provided by the UE via LPP procedure. After
receive the PRU registration, LMF sends message to NRF to indicate PRU
existence in certain area (e.g. the TAI of the PRU location).
iii. Subscription to UDM:
A UE may be pre-configured as a PRU. Then, the PRU information may be included
in the UE subscription data as a new parameter set and stored in UDM/UDR.
#### 6.15.2.3 PRU (de)/Activation
To save power, the PRU may not always be activated. 5GC may activate or
deactivate the PRU(s) based on the location service requirements. This can be
enabled by updating the state indication in the PRU information. For instance,
LMF may determine to de/activate PRUs via AMF.
#### 6.15.2.4 CM-IDLE/RRC-Inactive PRU(s) Utilization
To fully utilize the PRU(s) in the same camping cell of target UE, target UE
AMF can send the PRU wake up indication to the target UE NG-RAN, then target
UE NG-RAN broadcast this information in target UE camping cell, then all
candidate PRU(s) could listen this information and go back to connected state.
NOTE 1: RAN WG coordination is needed.
NOTE 2: This clause does not support the function to fully utilize the PRUs in
the neighbour cells of target UE and in CM-IDLE/RRC-inactive state.
### 6.15.3 Procedures
#### 6.15.3.0 Architecture Assumption
It is assumed to reuse the existing architecture defined in Rel-17 LCS work
(see TS 23.273 [5]).
Figure 6.15.3.1-0: Architecture Assumption
#### 6.15.3.1 PRU Management
The PRU management procedure is used by 5GC to obtain the PRU information and
to become aware which PRU(s)) are available in the network.
To manage PRU, three options could be considered:
\- Option A: PRU registration to AMF.
\- Option B.1: PRU registration to LMF.
\- Option B.2: LMF obtains available PRU information via LPP procedures.
\- Option C: PRU information are pre-configured in the UDM.
Figure 6.15.3.1-1: PRU Management
**Option A: PRU registration to AMF**
1a\~2a. PRU initiate the registration procedure to the AMF, including the PRU
capability as well as the User Location Information (i.e. CGI and TAI). The
PRU may also include the mobility state (e.g. mobile or static) in its
registration, so AMF can maintain all the available PRU with related
information dynamically.
3a. After receive the PRU information, the AMF invokes the
Nnrf_NFManagement_NFUpdate Request (PRU location, PRU existence indication) to
NRF to indicate the PRU existence in certain areas (e.g. in one or multiple
TAI(s)).
**Option B.1: PRU registration to LMF**
1b\~2b. The UE provides an indication to the serving AMF whether it can
function as a PRU. The serving AMF then registers the PRU to an LMF.
3b. After receive the PRU information, the LMF invokes the
Nnrf_NFManagement_NFUpdate Request (PRU location, PRU existence indication) to
NRF to indicate the PRU existence in certain areas (e.g. in one or multiple
TAI(s)).
**Option B.2: PRU registration to LMF**
1b. LMF obtains available PRU information via LPP procedures.
2b. This step is same as step 3b in OptionB.1.
**Option C: PRUs information are maintained at the UDM.**
A UE may be pre-configured as a PRU with the PRU information included in the
UE subscription data as a new parameter set and stored in UDM.
#### 6.15.3.2 PRU Activation/Deactivation
PRU activation/deactivation procedure is used by 5GC to enable/disable the
candidate PRU(s) for assisting location service.
Figure 6.15.3.2-1: PRU activated or deactivated
1\. Activation/deactivation of PRU(s) is triggered by LMF, such as based on
LCS requirements, e.g. LCS QoS of target UEs cannot be met, or based on the
location service procedure in clause 6.15.3.3.
2\. LMF invokes the PRU activation request towards the PRU AMF. The operation
request may include target UE location, PRU(s) information and triggering
conditions.
3\. AMF invokes a Nudm_SDM_Get service operation towards the UDM to obtain the
privacy settings of the PRU(s). The UDM returns the PRU(s) privacy setting.
AMF checks the PRU(s) Privacy profile.
4\. AMF performs privacy check if the privacy profile indicates that the
PRU(s) must be either notifies or verified.
5\. AMF invokes the context management update operation request to UDM to
update the PRU state information.
6\. AMF receives the response from UDM.
7\. The AMF activates the candidate PRU.
8\. AMF returns PRU activation response towards LMF.
#### 6.15.3.3 Location service procedure by using PRU(s)
This clause describes the location service procedure with the assistance of
PRU. Clauses 6.15.3.3.1 and 6.15.3.3.2 are based on the prerequisite that
PRU(s) are managed by AMF, i.e. the AMF-centric. Clauses 6.15.3.3.3 and
6.15.3.3.4 are based on the prerequisite that PRU(s) are managed by LMF, i.e.
the LMF-centric.
##### 6.15.3.3.1 AMF-centric MT-LR
The AMF-centric MT-LR requests PRU AMF to provide one or multiple candidates
PRU(s) in the vicinity of target UE, e.g. the same cell or the neighbour cell,
to improve positioning accuracy.
##### 6.15.3.3.1.1 MT-LR procedure based on Option A in clause 6.15.3.1 {#mt-
lr-procedure-based-on-option-a-in-clause-6.15.3.1 .H6}
Figure 6.15.3.3-1: MT-LR procedure using PRU (AMF-centric)
The following additions apply to step 1\~4 compared to steps 1-5 defined in
clause 6.1.1 of TS 23.273 [5].
3b. After target UE AMF receive step 3a, if the target UE support positioning
by PRU, e.g. based on the target UE subscription information or the
information in target UE context, or based on the target UE positioning
capability, e.g. whether target UE support NR positioning, the AMF send an
indication to NG-RAN to trigger NG-RAN broadcast the PRU wake up information
in target UE camping cell, e.g. the per PLMN indication in posSIB. For those
PRU(s) in CM-IDLE/RRC-inactive state, after receive this information, those
PRU(s) trigger the service request/RRC-resume to go back to CM-CONNECTED as
described in clause 4.2.3.2 of TS 23.502 [3] or clause 9.2.2.4 of TS 38.300
[22].
5\. The LMF invokes the Nnrf_NFDiscovery_Request Request towards NRF to
request the PRU AMF. The service operation includes the target UE location
information (e.g. the TAI of target UE), the indication to find the PRU AMF
which could serve in the area around the target UE.
6\. Based on the PRU AMF discovery indication and the target UE location
information, the NRF return one or multiple PRU AMF(s) via
Nnrf_NFDiscovery_Request Response.
7\. LMF sends the PRU discovery request to PRU AMF to request the candidate
PRU. The message includes the target UE location information and the target UE
vicinal location (e.g. the neighbour cell of target UE).
8\. Based on the message in step 7, the PRU AMF choose one or multiple
candidate PRU(s) based on the target UE location, the target UE vicinal
location, and the mobile state of PRU. The PRU AMF invokes PRU discovery
response to LMF, includes one or multiple candidate PRU(s).
9\. The LMF performs the activation procedure as defined in clause 6.15.3.2 to
activate the desired PRU(s). LMF also performs one or more of the positioning
procedures towards PRU as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS
23.273 [5].
10\. The LMF performs one or more of the positioning procedures towards target
UE as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].
##### 6.15.3.3.1.2 MT-LR procedure based on Option C in clause 6.15.3.1 {#mt-
lr-procedure-based-on-option-c-in-clause-6.15.3.1 .H6}
Figure 6.15.3.3-2: MT-LR procedure using PRU (AMF-centric)
The following additions apply to steps 1\~3 compared to steps 1\~4 defined in
clause 6.1.1 of TS 23.273 [5].
3b. After target UE AMF receive step 3a, if the target UE support positioning
by PRU, e.g. based on the target UE subscription information or the
information in target UE context, or based on the target UE positioning
capability, e.g. whether target UE support NR positioning, the AMF send an
indication to NG-RAN to trigger NG-RAN broadcast the PRU wake up information
in target UE camping cell, e.g. the per PLMN indication in posSIB. For those
PRU(s) in CM-IDLE/RRC-inactive state, after receive this information, those
PRU(s) trigger the service request/RRC-resume to go back to CM-CONNECTED as
described in clause 4.2.3.2 of TS 23.502 [3] or clause 9.2.2.4 of TS 38.300
[22].
4\. The AMF invokes Nudm_SDM_Get request to UDM to request PRU information of
the UE(s) in the same or vicinal location with the target UE, e.g. within the
target UE TAI(s).
5\. UDM sends the Nudm_SDM_Get response to AMF, includes PRU information in
the subscription information of the UE(s) in the same or vicinal location with
the target UE. The AMF choose one or multiple candidate PRU(s) from those
UE(s) in step 5, such as, based on the target UE location, PRU capability,
location information and mobility state.
6\. The target UE AMF invokes Nlmf_Location_DetermineLocation Request towards
LMF, includes one or multiple candidate PRU information.
7\. The LMF performs the activation procedure as defined in clause 6.15.3.2 to
activate the desired PRU(s). LMF also performs one or more of the positioning
procedures towards PRU(s) as described in clauses 6.11.1, 6.11.2 and 6.11.3 of
TS 23.273 [5].
8\. The LMF performs one or more of the positioning procedures towards target
UE as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].
##### 6.15.3.3.2 AMF-centric MO-LR
The AMF-centric MO-LR requests PRU AMF to provide one or multiple candidates
PRU(s) in the vicinity of target UE to improve positioning accuracy.
##### 6.15.3.3.2.1 MO-LR procedure based on Option A in clause 6.15.3.1 {#mo-
lr-procedure-based-on-option-a-in-clause-6.15.3.1 .H6}
Figure 6.15.3.3-3: MO-LR procedure using PRU/ (AMF-centric)
Steps 1\~4 are same as steps 1\~4 defined in clause 6.2 of TS 23.273 [5].
Steps 5\~10 are same as steps 5\~10 in clause 6.15.3.3.1.1.
##### 6.15.3.3.2.2 MO-LR procedure based on Option C in clause 6.15.3.1 {#mo-
lr-procedure-based-on-option-c-in-clause-6.15.3.1 .H6}
Figure 6.15.3.3-4: MO-LR procedure using PRU (AMF-centric)
Steps 1\~2 are same as the steps 1\~2 defined in clause 6.2 of TS 23.273 [5].
Steps 3\~7 are same as steps 4\~8 in clause 6.15.3.3.1.2.
##### 6.15.3.3.3 LMF-centric MT-LR
The LMF-centric MT-LR requests PRU LMF to provide one or multiple candidates
PRU(s) in the vicinity of target UE to improve positioning accuracy. This
procedure based on option B in clause 6.15.3.1.
Figure 6.15.3.3-5: MT-LR procedure using PRU (LMF-centric)
The following additions apply to steps 1\~4 compared to steps 1\~5 defined in
clause 6.1.1 of TS 23.273 [5].
3b. After AMF receive step 3a, if the target UE support positioning by PRU,
e.g. based on the target UE subscription information or the information in
target UE context, or based on the target UE positioning capability, e.g.
whether target UE support NR positioning, the AMF send an indication to NG-RAN
to trigger NG-RAN broadcast the PRU wake up information in target UE camping
cell, e.g. the per PLMN indication in posSIB. For those PRU(s) in CM-IDLE/RRC-
inactive state, after receive this information, those PRU(s) trigger the
service request/RRC-resume to go back to CM-CONNECTED as described in clause
4.2.3.2 of TS 23.502 [3] or clause 9.2.2.4 of TS 38.300 [22].
5\. The LMF invokes the Nnrf_NFDiscovery_Request Request towards NRF to
request the PRU LMF. The service operation includes the target UE location
information (e.g. the TAI(s) of target UE), the indication to find the PRU LMF
which could serve the target UE positioning.
6\. Based on the PRU LMF discovery indication and the target UE location
information, the NRF return one or multiple PRU UE LMF(s) via
Nnrf_NFDiscovery_Request Response.
7\. LMF sends PRU discovery request to PRU LMF to request the PRU information.
The message includes the target UE location information and the target UE
vicinal location (e.g. the neighbour cell of target UE).
8\. The PRU LMF choose one or multiple candidate PRU(s) based on the target UE
location, PRU capability, location information and mobility state. The PRU LMF
invokes PRU discovery response to LMF, includes one or multiple candidate
PRU(s).
9\. The LMF performs the activation procedure as defined in clause 6.15.3.2 to
activate the desired PRU(s). LMF also performs one or more of the positioning
procedures towards PRU(s) as described in clauses 6.11.1, 6.11.2 and 6.11.3 of
TS 23.273 [5].
10\. The LMF performs one or more of the positioning procedures towards target
UE as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].
##### 6.15.3.3.4 LMF-centric MO-LR
The LMF-centric MO-LR request PRU LMF to provide one or multiple candidates
PRU(s) in the vicinity of target UE to improve the positioning accuracy.
Figure 6.15.3.3-6: MO-LR procedure using PRU (LMF-centric)
Steps 1\~4 are same as the steps 1\~4 defined in clause 6.2 of TS 23.273 [5].
Steps 5\~10 are same as in clause 6.15.3.3.3.
### 6.15.4 Impacts on services, entities, and interfaces
UE:
\- Support operate as PRU and send PRU information to 5GC.
AMF:
\- store PRU information in the UE context.
\- when receive the PRU registration, sends message to NRF to indicate PRU
existence in certain area.
\- aware of the PRU information if there are UE(s) can be operated as PRU(s).
\- choose one or multiple candidate PRU(s) and response to LMF.
\- After target UE positioning is triggered, the target UE AMF send an PRU
wake up indication to NG-RAN to trigger NG-RAN broadcast this information in
target UE camping cell.
LMF:
\- store PRU information.
\- when receive the PRU registration, send message to NRF to indicate PRU
existence in certain area.
\- aware of the PRU information if there are UE(s) can be operated as PRU(s).
\- choose one or multiple candidate PRU(s).
NRF:
\- Support NF profile update once receive the PRU existence indication.
\- Support selection of AMF(s)/LMF(s) that have registered with PRU.
UDM:
\- store PRU(s) information.
NG-RAN:
\- Support broadcast the PRU wake up information in target UE camping cell.
UE:
\- After receive the PRU wake up indication, trigger to perform the service
request/RRC resume procedure.
## 6.16 Solution #16: Support of Positioning Reference Units
### 6.16.1 Introduction
This solution addresses the questions related to Positioning Reference Units
(PRU) in KI#7: support of Positioning Reference Units and Reference UEs.
### 6.16.2 Functional Description
PRU Capability Verification:
\- During Registration procedure, the UE includes PRU capability in the
Registration Request. The AMF verifies the capability based on the
subscription data received from UDM.
PRU Information Storage:
\- The PRU information is stored in the LMF: after successful Registration
procedure of PRU, the AMF initiates the 5GC-NI-LR procedure (only steps 2 - 4
of the procedure are performed) to store PRU information in the LMF.
\- The PRU information is stored in the NRF: in order to support that the PRU
assists positioning of all UEs, but not the UEs in the service area of the LMF
storing the PRU information, the LMF may further store PRU information in the
LMF profile in the NRF.
\- The PRU information includes LCS correlation ID, serving cell ID, serving
AMF ID, PRU measurements and PRU location.
PRU Utilization:
\- The LMF decides to use the PRU to assist UE positioning based on the
required QoS.
\- The LMF obtain PRU measurements by initiating PRU positioning or request
the information from the serving LMF of the PRU. The LMF obtains the serving
LMF of the PRU from NRF.
\- To fully utilize the PRU(s) in the same camping cell of target UE, target
UE AMF can send the PRU wake up indication to the target UE NG-RAN, then
target UE NG-RAN broadcast this information in target UE camping cell, then
all candidate PRU(s) could listen this information and go back to connected
state.
Editor\'s note: RAN WG coordination is needed.
### 6.16.3 Procedures
#### 6.16.3.1 PRU Registration
Figure 6.16.3.1-1: PRU Registration procedure
1\. PRU sends Registration Request to AMF. The message includes PRU
capability.
2\. The AMF invokes a Nudm_SDM_Get service operation towards the UDM to obtain
subscription data of the UE to verify whether the subscription data includes
the PRU subscription. If not, the AMF rejects the Registration Request.
3\. The AMF returns Registration Accept to PRU.
4\. After the successful registration of PRU, the AMF invokes a
Nlmf_Location_DetermineLocation Request to LMF. The request includes PRU
indication and LCS correlation ID.
5\. The LMF triggers UE positioning procedure to obtain measurements and
location of PRU. The LMF stores the PRU information locally, e.g. PRU serving
cell ID, serving AMF ID, LCS correlation ID, PRU measurements, PRU location.
6\. The LMF invokes a Nlmf_Location_DetermineLocation Response to AMF.
7\. [Conditional] If the LMF decides to store PRU information in the NRF, e.g.
the serving cell of the PRU is near the boundary of the service area of the
LMF, the PRU measurements can also be used by other LMF to assist UE
positioning, the LMF invokes a Nnrf_NFManagement_NFUpdate Request to NRF. The
service operation includes NF type=LMF, supported PRU information, e.g. PRU
serving cell ID, PRU location, LCS correlation ID, serving AMF ID.
8\. [Conditional] If step 7 is performed, the NRF returns a
Nnrf_NFManagement_NFUpdate Response to LMF.
#### 6.16.3.2 PRU Utilization
Figure 6.16.3.2-1: PRU Utilization Registration procedure
0a. The trigger for target UE positioning happens, e.g. the AMF receives
Namf_Location_ProvidePositioningInfo Request service operation from GMLC or
receives MO-LR Request from UE.
0b. If the target UE support positioning by PRU, e.g. based on the target UE
subscription information or the information in target UE context, or based on
the target UE positioning capability, e.g. whether target UE support NR
positioning, the AMF send an indication to NG-RAN to trigger NG-RAN broadcast
the PRU wake up information in target UE camping cell, e.g. the per PLMN
indication in posSIB. For those PRU(s) in CM-IDLE/RRC-inactive state, after
receive this information, those PRU(s) trigger the service request/RRC-resume
to go back to CM-CONNECTED as described in clause 4.2.3.2 of TS 23.502 [3] or
clause 9.2.2.4 of TS 38.300 [22].
1\. The AMF invokes a Nlmf_Location_DetermineLocation Request to LMF.
2\. The LMF triggers UE positioning procedure to obtain measurements from PRU.
3\. [Conditional] If the LMF decides to obtain PRU information from NRF, e.g.
the PRU(s) stored in the LMF is not available to assist UE positioning, the
LMF invokes a Nnrf_NFDiscovery Request to NRF. The request includes NF
type=LMF, cell ID or cell list, PRU indication.
4\. [Conditional] The NRF returns a Nnrf_ NFDiscovery Response to LMF. The
response includes LMF ID and PRU information.
5\. [Conditional] If LMF receives PRU information and the serving LMF of the
PRU from NRF, the LMF sends the Nlmf_Location_DetermineLocation Request to the
serving LMF of the PRU.
6\. [Conditional] If step 5 is performed, the serving LMF of PRU triggers UE
positioning procedure to obtain measurements from PRU.
7\. [Conditional] If step 6 is performed, the serving LMF of PRU sends the
Nlmf_Location_DetermineLocation Response to the serving LMF.
8\. The LMF calculates UE location based on the measurements obtained from PRU
in step 4 and step 7 and invokes a Nlmf_Location_DetermineLocation Response to
AMF.
### 6.16.4 Impacts on services, entities, and interfaces
AMF:
\- During Registration procedure, receive PRU capability from PRU and verify
the capability using the subscription data.
\- After PRU successful registration, AMF initiates the 5GC-NI-LR procedure
(only steps 2 - 4 are performed) to store PRU information in LMF. The AMF
includes PRU indication in step 2 of the 5GC-NI-LR procedure.
\- After target UE positioning is triggered, the target UE AMF send an PRU
wake up indication to NG-RAN to trigger NG-RAN broadcast this information in
target UE camping cell.
LMF:
\- During the 5GC-NI-LR procedure, if PRU indication is received from AMF, the
LMF stores PRU information locally or stores PRU information in NRF.
\- Decide to use PRU to assist UE positioning based on the required QoS,
obtain available PRU based on the locally stored information or from NRF.
\- To obtain PRU measurements to assist UE positioning, initiate positioning
procedure for PRU or request PRU measurements from serving LMF of the PRU
based on the received information from NRF.
PRU:
\- Send Registration Request including PRU capability to AMF.
NRF:
\- Store information of the PRU which is in the service area of LMF in LMF
profile.
\- Provides PRU information to LMF.
NG-RAN:
\- Support broadcast the PRU wake up information in target UE camping cell.
UE:
\- After receive the PRU wake up indication, trigger to perform the service
request/RRC resume procedure.
## 6.17 Solution #17: Support for 5GS Localization via Reference UE
### 6.17.1 Introduction
This solution to KI#7 as described in clause 5.7 proposes a mechanism for the
5GS to assist determining the location of a set of UEs via another UE known as
reference UE. The solution addresses use cases mentioned in clause 5.7 such as
the set of UEs not having LoS path with the RAN node(s), or the opportunity to
reduce the signalling involved in providing location services including
positioning and tracking to a set of UEs. Multiple reference UEs may also be
utilized to assist with the location of the target UE.
### 6.17.2 Functional Description
At a high level, the functional description of this solution is as follows:
\- The LCS architecture is leveraged to provide location services to a target
UE assisted by one or multiple reference UE(s).
The solution requires LMF to support location requests via reference UE and
processing of the location estimation results.
\- A reference UE in this solution could be co-located with a PRU since both
entities behave like UEs assisting with the positioning performance of a
target UE.
NOTE: In this solution it is assumed that reference UEs have known location
obtained via Uu positioning.
### 6.17.3 Procedures
Figure 6.17.3-1: Support for 5GS Localization via Reference UE
0\. \'The reference and target UEs register to the network. An indication
identifying reference UE(s) may be provided to LMF by AMF.
1\. The LCS client request location services for a target UE to the 5GS.
2\. After receiving the location request from the LCS client, the LMF starts
the localization procedures as in a default scenario as shown in clause 6.1.2
of TS 23.273 [5].
3\. The LMF may identify one or a set of references UEs suitable to provide
location information and/or assistance location data related to the target UE
4\. Optionally, ProSe capabilities (e.g. for ranging or sidelink positioning)
may be used by the reference UEs to collect location information or location
assistance data from the target UE.
NOTE 1: The functionality in step 4 is out of scope of this study but details
can be found in TR 23.700-86 [17].
5\. The LMF sends location request for a target UE to one or multiple
reference UEs using LPP.
NOTE 2: AS level procedures required between NG-RAN and the reference UE are
determined by RAN WGs.
6\. The reference UE(s) will initiate the positioning of the target UE. This
can include providing target UE related location measurements or assistance
data. The target UE will provide the location assistance data (or
measurements) to the one or multiple reference UEs.
NOTE 3: This solution is agnostic as to what type of positioning mechanism is
employed between reference UEs and target UE, e.g. Uu based positioning,
sidelink positioning, etc.
7\. The reference UE(s) will relay location reporting data back to the LMF via
LPP.
8\. The LMF will process the data to combine and/or downselect multiple inputs
from multiple Reference UE to generate the best possible estimate of the
target UE location.
9-11. Location information is passed onto the LCS client through the AMF and
GMLC. These steps are not changed from the default location responses in
clause 6.1.2 of TS 23.273 [5].
### 6.17.4 Impacts on services, entities and interfaces
AMF
\- To support registration of reference UEs.
LMF
\- To support location request via multiple reference UEs.
\- To support processing of multiple location estimations of same target UE
via multiple reference UEs.
UE
\- As a reference UE to be able to provide location related measurements or
any assistance data w.r.t. a target UE to 5GC.
## 6.18 Solution #18: Location Verification for Satellite Access assisted by
NWDAF Analytics
### 6.18.1 Introduction
This solution proposes a mechanism for location verification of the UE
location provided via satellite access by leveraging NWDAF analytics in the
5GC. The solution addresses KI#9 as it enables the AMF to receive statistics
and predictions on the UE location, hence making it easier to determine
whether the potentially inaccurate location information provided by the UE is
reliable and trustable or not.
### 6.18.2 Functional description
At a high level, the functional description of this solution is as follows:
\- The UE provides an initial location to NG-RAN/AMF via satellite access, and
the location verification process at the 5GC is triggered.
\- The AMF discovers an NWDAF instance capable of providing UE related
analytics on the UE that provided its location via satellite access. If
available, the selected NWDAF instance should have analytics aggregation
analytics to retrieve UE related analytics from other NWDAF instances.
\- If the selected NWDAF instance has aggregator capabilities, it discovers
and collects UE related analytics from other NWDAF instance(s) following the
procedures specified in TS 23.288 [9].
\- The NWDAF instance with potential aggregator capabilities aggregates
analytics (if collected), derives its own analytics, and delivers them to the
AMF.
\- The AMF uses the received analytics as part of its decision on whether the
UE location should be accepted or rejected as provided by the UE.
### 6.18.3 Procedures
Figure 6.18.2-1: Procedure for location verification for satellite access
assisted by NWDAF analytics
1\. UE reports location to the NG-RAN via satellite access.
2\. NG-RAN selects a suitable AMF based on reported UE location (e.g. AMF A,
serving Country A).
3\. NG-RAN indicates to the AMF the need to verify/confirm the UE location
provided via satellite access.
4\. AMF retrieves the subscriber profile of the UE from the UDM.
5\. If not done previously, AMF discovers NWDAF according to clause 5.2 of TS
23.288 [9] and clause 6.3.13 of TS 23.501 [2], if available supporting
analytics aggregation as described in clause 6.1A.2 of TS 23.288 [9]. In
addition, AMF uses NWDAF Serving Area information, and NWDAF location
information to select the appropriate NWDAF instance.
6\. AMF requests or subscribes to UE related analytics (e.g. expected UE
behaviour, abnormal behaviour, UE mobility) for one or more Analytic IDs in a
given Area of Interest from a NWDAF that covers the country where the UE
reported its location. When the AMF requests or subscribes to analytics
containing UE location information, it may use the Analytics ID \"UE
Mobility\" supported in Release 17 with location information granularity of TA
or cell. In addition, to increase the accuracy and reliability, the AMF may
use other Analytics IDs supported in Release 18 with finer location
information granularity than TA or cell.
NOTE 1: The available granularity of UE location information will be decided
when FS_eNA_ph3 reaches conclusions, and which fine granularity Analytics ID
can be consumed by AMF for location verification purposes in satellite access
depend on such conclusion and will be finalized during normative work.
7\. [OPTIONAL] The selected NWDAF instance may register with the UDM for the
UE that it is collecting data for and for the related Analytic ID(s).
8\. [OPTIONAL] If needed and the selected NWDAF instance has analytics
aggregation capability, the NWDAF for which the AMF requested analytics
discovers other NWDAF instances that may provide relevant UE related analytics
on the UE ID that provided its location in step 1.
9\. [OPTIONAL] The aggregator NWDAF requests UE related analytics from other
NWDAF(s) on the UE which initially provided its location information to NG-
RAN.
10\. [OPTIONAL] If needed, other NWDAFs contacted by the aggregator NWDAF may
collect data from other NFs (AMFs, SMFs, etc.) related to this UE (e.g.
previous locations in other countries, any reported UE abnormal behaviour,
etc.).
11\. [OPTIONAL] The NWDAF(s) contacted by the aggregator NWDAF derive(s) UE
related analytics for the UE in the area it is responsible for, e.g. (part of)
a country.
12\. [OPTIONAL] The NWDAF(s) contacted by the aggregator NWDAF report(s) their
analytics (UE mobility, UE abnormal behaviour, etc.) to the aggregator NWDAF.
13\. The aggregator NWDAF performs aggregation of the reported analytics and
derives analytics.
14\. The aggregator NWDAF provides (potentially aggregated) analytics to the
AMF.
15\. AMF decides whether the UE should or should not be allowed access given
the currently reported location.
16\. AMF interacts with NG-RAN and/or the UE to convey the decision. For
example, based on the reported UE analytics (e.g. UE behaviour, UE location),
the AMF and/ or NG-RAN may behave as follows:
a) In case of UE in initial access, the AMF may accept or reject UE
Registration Request to the UE reported location. In case of rejection, the
AMF may provide a cause value to the UE and/or NG-RAN (e.g. \"inaccurate/wrong
Location\", \"Location is not supported\", or any other naming).
b) AMF may forward the full, part or a modified version of the analytics (e.g.
UE behaviour, UE location) to NG-RAN which may act upon it. For example, NG-
RAN may release the UE in case of an \"unexpected UE location\".
c) AMF may decide to initiate UE release procedure with the NG-RAN, and
indicates the cause of UE context release as UE (e.g.
\"inaccurate/wrong/unexpected UE Location\", \"UE Location is not supported\",
or any other naming).
NOTE 2: The AMF may use additional information other than analytics to
increase the reliability of location verification for satellite access. It is
up to RAN WGs to decide if additional information to AMF is provided by NG-
RAN.
NOTE 3: To which extent NWDAF analytics can enhance the reliability of the
location verification is for RAN WGs to verify.
### 6.18.4 Impacts on services, entities and interfaces
AMF:
\- To trigger UE related analytics request/subscription after NG-RAN requests
AMF UE location verification for satellite access.
\- To discover an NWDAF instance with aggregator capabilities for UE related
analytics.
\- To verify UE location provided via satellite access based on NWDAF
analytics, report to NG-RAN and/or UE, and initiate any necessary action.
NWDAF:
\- To support aggregation of UE related analytics for location verification
purposes.
## 6.19 Solution #19: Support of Low Latency via User Plane
### 6.19.1 Introduction
This solution addresses KI#1 (Architectural Enhancement to support User Plane
positioning and KI#10 (Support of Reduced Latency).
The main principles of this solution are as follows:
1\. The solution applies to event reporting for a periodic or triggered
deferred 5GC-MT-LR.
2\. The target UE uses a user plane connection to report events to the LCS
Client or AF, either directly or via the LMF or H-GMLC.
3\. When reporting directly to the LCS Client or AF or reporting via an
H-GMLC, the UE sends a supplementary services event report (e.g. as defined in
TS 24.080 [21]) over the user plane connection with a location estimate
included. This could significantly reduce end-to-end latency because the event
report no longer needs to be transferred via control plane through the NG-RAN,
AMF, LMF, GMLC and possibly NEF. Signalling efficiency is likewise increased.
4\. When reporting via the LMF, the UE sends a supplementary services event
report over the user plane connection to the LMF with one or more LPP messages
included in the event report. The LMF then verifies or determines a location
estimate and sends the event report with the location estimate to the LCS
Client or AF over a second user plane connection. This can still reduce
latency and increase signalling efficiency.
5\. The control plane associations between the UE and LMF, LMF and
V-GMLC/H-GMLC and H-GMLC and LCS Client or NEF and AF are retained to allow
the status of event reporting to be conveyed to the H-GMLC (and NEF if used)
and to support cancellation of event reporting using the existing control
plane procedures in clauses 6.3.2 and 6.3.3. in TS 23.273 [5].
### 6.19.2 Functional Description
#### 6.19.2.1 Architecture
There are no changes to 5GS architecture as defined in TS 23.501 [2] and TS
23.273 [5].
#### 6.19.2.2 Protocol Layering
Location event reports are transferred from a UE to an LCS Client or AF using
data transport through a UPF. Transfer can be direct or can be via an LMF or
H-GMLC. Transfer via an LMF allows the LMF to determine or verify a location
estimate and, if needed, exchange LPP messages with the target UE via user
plane to perform positioning of the target UE. Transfer via an H-GMLC enables
the H-GMLC to monitor event reporting by the target UE and to avoid direct UE
to LCS Client or AF data interaction which might be a security risk to either
entity.
The associated protocol layering is shown in Figure 6.19.2.2-1. A version of
TLS (e.g. TLS 1.2 defined in RFC 5246 [20]) is used to enable secure data
connection. The LMF or H-GMLC shown in Figure 6.19.2.2-1 is only present when
event reports are transferred through the LMF or H-GMLC and not directly to
the LCS Client or AF.
NOTE: Security aspects of reporting location to an AF or LCS Client via a user
plane will need to be verified or defined by SA WG3.
Figure 6.19.2.2-1: Protocol Layering for User Plane Transfer of Event Reports
### 6.19.3 Procedures
#### 6.19.3.1 Event Reporting from a UE directly to an LCS Client or AF
Figure 6.19.3.1-1 shows a procedure for event reporting from a UE directly to
an LCS Client or AF when a User Plane connection is established directly from
the UE to the LCS Client or AF with no intermediate LMF or H-GMLC. This
procedure is applicable when UE based position methods or standalone position
methods are used by the UE.
Figure 6.19.3.1-1: Event Reporting from a UE directly to an LCS Client or AF
1\. Steps 1-21 for the deferred 5GC-MT-LR procedure for periodic or triggered
location events in clause 6.3.1 of TS 23.273 [5] are performed with the
following differences.
\- At step 1, the LCS Client or AF includes a request for user plane reporting
in the Location Request and includes an IP address or FQDN for the user plane
connection and security information to enable a secure connection.
\- At steps 4, 5, 14 and 16, the request for user plane reporting and the IP
address or FQDN and the security information are forwarded in sequence to the
V-GMLC (if used), AMF, LMF and target UE. The type of user plane connection
(direct to the LCS Client or AF) and criteria for sending cumulative event
reports at step 9 are also conveyed to the target UE from the H-GMLC. The
criteria can include a periodic time interval or the sending of a certain
number of event reports via user plane at step 6.
\- At steps 17-21, the target UE indicates to the LMF, H-GMLC and LCS Client
or AF whether event reporting via user plane can be supported by the target
UE. If event reporting via user plane cannot be supported, the target UE uses
the procedure in clause 6.3.1 of TS 23.273 [5] to send events reports via
Control Plane.
2\. The UE establishes a secure TCP/IP connection to the LCS Client or AF
using the IP address or FQDN and security information received at step 1.
3\. If the UE needs assistance data to help determine a location later at step
5, the UE may send a positioning LPP request to the LMF via Control Plane
using the deferred Routing ID received in step 16 of the procedure in clause
6.3.1 in TS 23.273 [5] to identify and route the request to the correct LMF.
The LMF then provides the requested assistance data to the UE by returning an
LPP positioning message via Control Plane. Preferably, the UE requests
assistance data some time before location determination is needed to avoid
increasing latency. The LMF may use the LMF change procedure in clause 6.4 in
TS 23.273 [5] to forward the request for assistance data to a better LMF if
the current LMF cannot provide assistance data for the current UE location
(e.g. the current UE TAI or CGI). In this case, the new LMF can return the
assistance data to the UE via the original LMF to avoid changing the LMF
association in the UE and H-GMLC or V-GMLC.
4\. The UE monitors for and detects the occurrence of a trigger or periodic
event as described for step 22 of the procedure in clause 6.3.1 of TS 23.273
[5].
5\. The UE obtains location measurements and determines a current location,
possibly using assistance data obtained at step 3.
NOTE: Obtaining a location at step 5 limits the UE to using UE based or
standalone position methods. If UE assisted position methods need to be used,
the LMF can use the procedure described in clause 6.19.3.3 instead of the
procedure in this clause.
6\. The UE sends a supplementary services Event Report to the LCS Client or AF
over the secure TCP/IP Connection established at step 2. The event report
indicates the type of event being reported and includes the location
determined at step 5.
7\. The LCS Client or AF returns a supplementary services Event Report
Acknowledgment to the UE over the secure TCP/IP Connection established at step
2.
8\. The UE continues to monitor for and detect further trigger or periodic
events as at step 4 and repeats steps 5-7 for each detected trigger or
periodic event.
9\. Based on the criteria received by the UE for sending of cumulative event
reports (e.g. the expiration of a periodic timer or the sending of certain
number of event reports at step 6), the UE sends a cumulative event report to
the LMF, H-GMLC and LCS Client or AF over the control plane portion of the
periodic or triggered deferred 5GC-MT-LR using steps 25-30 of the procedure in
clause 6.3.1 of TS 23.273 [5]. The cumulative event report indicates to the
LMF, H-GMLC and External LCS Client or AF that the control plane portion of
the periodic or triggered deferred 5GC-MT-LR is still operational, that the UE
is still reporting events (e.g. is still powered on and in network coverage)
and may include statistics on the events reported since the last cumulative
event report was sent (e.g. the number of event reports).
#### 6.19.3.2 Event Reporting from a UE to an LCS Client or AF via an H-GMLC
Figure 6.19.3.2-1 shows a procedure for event reporting from a UE to an LCS
Client or AF when a User Plane connection is established to the LCS Client or
AF via the H-GMLC. This procedure is applicable when UE based position methods
or standalone position methods are used by the UE.
Figure 6.19.3.2-1: Event Reporting from a UE to an LCS Client or AF via the
H-GMLC
1\. Steps 1-21 for the deferred 5GC-MT-LR procedure for periodic or triggered
location events in clause 6.3.1 of TS 23.273 [5] are performed with the
following differences.
\- At step 1, the LCS Client or AF includes a request for user plane reporting
in the Location Request and includes an IP address or FQDN for the user plane
connection and security information to enable a secure connection.
\- At steps 4, 5, 14 and 16, the request for user plane reporting and an IP
address or FQDN and security information for the H-GMLC are forwarded in
sequence to the VGMLC (if used), AMF, LMF and target UE. The H-GMLC also
retains the IP address or FQDN and security information for the LCS Client or
AF that was received at step 1. The type of user plane connection (via the
H-GMLC)) is also conveyed to the LMF and target UE from the H-GMLC. The H-GMLC
can decide to use this procedure (rather than either of the other procedures)
prior to step 4 or step 5 of the procedure in clause 6.3.1 of TS 23.273 [5].
\- At step 17-21, the target UE indicates to the LMF, H-GMLC and LCS Client or
AF whether event reporting via user plane can be supported by the target UE.
If event reporting via user plane cannot be supported, the target UE uses the
procedure in clause 6.3.1 of TS 23.273 [5] to send events reports via Control
Plane.
2\. The UE establishes a secure TCP/IP connection to the H-GMLC using the IP
address or FQDN and security information received by the UE at step 1.
3\. The H-GMLC establishes a secure TCP/IP connection to the LCS Client or AF
H-GMLC using the IP address or FQDN and security information received by the
H-GMLC at step 1.
4\. If the UE needs assistance data to help determine a location later at step
6, the UE performs step 3 in clause 6.19.3.1 to obtain assistance data from
the LMF using control plane.
5\. The UE monitors for and detects the occurrence of a trigger or periodic
event as described for step 22 of the procedure in clause 6.3.1 of TS 23.273
[5].
6\. The UE obtains location measurements and determines a current location,
possibly using assistance data obtained at step 3.
NOTE 1: Obtaining a location at step 6 limits the UE to using UE based or
standalone position methods. If UE assisted position methods need to be used,
the LMF can use the procedure described in clause 6.19.3.3 instead of the
procedure in this clause.
7\. The UE sends a supplementary services Event Report to the H-GMLC over the
secure TCP/IP Connection established at step 2. The event report indicates the
type of event being reported and includes the location determined at step 6.
8\. The H-GMLC forwards the supplementary services Event Report to LCS Client
or AF over the secure TCP/IP Connection established at step 3.
9\. The LCS Client or AF returns a supplementary services Event Report
Acknowledgment to the H-GMLC over the secure TCP/IP Connection established at
step 3.
10\. The H-GMLC returns the supplementary services Event Report Acknowledgment
to the UE over the secure TCP/IP Connection established at step 2.
11\. The UE continues to monitor for and detect further trigger or periodic
events as at step 5 and repeats steps 6-10 for each detected trigger or
periodic event.
NOTE 2: A cumulative event report from the UE, as at step 9 in the procedure
in clause 6.19.3.1, should not be needed when event reports are sent via the
H-GMLC, as the H-GMLC is already aware of the status of event reporting and
would know if the UE had ceased reporting events.
#### 6.19.3.3 Event Reporting from a UE to an LCS Client or AF via an LMF
Figure 6.19.3.3-1 shows a procedure for event reporting from a UE to an LCS
Client or AF when a User Plane connection is established to the LCS Client or
AF via the LMF. This procedure is applicable when UE assisted position methods
are used by the UE.
NOTE: This procedure does not support transfer of event reporting to a new
LMF. While such support could be added, it could substantially increase
latency as well as add more impacts for the target UE, LMF and LCS Client or
AF. Environments where very low latency is needed can include factories,
warehouses and industrial plants where a single LMF might support the entire
UE coverage area, thereby making LMF change unnecessary. In other
environments, where an LMF change could be needed, the procedure in clauses
6.19.3.1 or 6.19.3.2 could be used instead.
Figure 6.19.3.3-1: Event Reporting from a UE to an LCS Client or AF via the
LMF
1\. Steps 1-21 for the deferred 5GC-MT-LR procedure for periodic or triggered
location events in clause 6.3.1 of TS 23.273 [5] are performed with the
following differences:
\- At step 1, the LCS Client or AF includes a request for user plane reporting
in the Location Request and includes an IP address or FQDN for the user plane
connection and security information to enable a secure connection.
\- At steps 4, 5 and 14, the request for user plane reporting and the IP
address or FQDN and the security information are forwarded in sequence to the
V-GMLC (if used), AMF and LMF. The criteria for sending cumulative event
reports at step 14 are also conveyed to the LMF. The criteria can include a
periodic time interval or the sending of a certain number of event reports via
user plane at steps 7 and 11.
\- At step 16, the request for user plane reporting and an IP address or FQDN
and security information for the LMF are sent to target UE. The LMF also
retains the IP address or FQDN and security information for the LCS Client or
AF that was received at step 14. The type of user plane connection (via the
LMF) is also conveyed to the target UE at step 16. The LMF can decide to use
this procedure (rather than either of the other procedures) prior to step 16
of the procedure in clause 6.3.1 of TS 23.273 [5] and only if the H-GMLC had
decided not to use event reporting via the H-GMLC.
\- At step 17-21, the target UE indicates to the LMF, H-GMLC and LCS Client or
AF whether event reporting via user plane can be supported by the target UE.
If event reporting via user plane cannot be supported, the target UE uses the
procedure in clause 6.3.1 of TS 23.273 [5] to send events reports via Control
Plane.
2\. The UE establishes a secure TCP/IP connection to the LMF using the IP
address or FQDN and security information received by the UE at step 1.
3\. The LMF establishes a secure TCP/IP connection to the LCS Client or AF
using the IP address or FQDN and security information received by the LMF at
step 1.
4\. If the UE needs assistance data to help obtain location measurements later
at step 6, the UE performs step 3 in clause 6.19.3.1 to obtain assistance data
from the LMF using control plane.
5\. The UE monitors for and detects the occurrence of a trigger or periodic
event as described for step 22 of the procedure in clause 6.3.1 of TS 23.273
[5].
6\. The UE obtains location measurements and possibly determines a location,
and possibly using assistance data obtained at step 4.
7\. The UE sends a supplementary services Event Report to the LMF over the
secure TCP/IP Connection established at step 2. The event report indicates the
type of event being reported and includes an embedded LPP message with the
location measurements or location estimate obtained at step 6.
8\. The LMF returns a supplementary services Event Report Acknowledgment to
the UE over the secure TCP/IP Connection established at step 2.
9\. If the LMF needs additional location measurements or a location estimate
from the UE, the LMF exchanges LPP messages with the UE over the secure TCP/IP
Connection established at step 2 to request and receive the additional
location measurements or location estimate from the UE.
10\. Based on the location measurements or location estimate received from the
UE at step 7 and/or step 9, the LMF determines or verifies a location estimate
for the UE.
11\. The LMF sends a supplementary services Event Report to the LCS Client or
AF over the secure TCP/IP Connection established at step 3 and includes the
type of event report and the location estimate determined or verified at step
10.
12\. The LCS Client or AF returns a supplementary services Event Report
Acknowledgment to the LMF over the secure TCP/IP Connection established at
step 3.
13\. The UE continues to monitor for and detect further trigger or periodic
events as at step 5 and repeats steps 6-12 for each detected trigger or
periodic event.
14\. Based on the criteria received by the LMF for sending of cumulative event
reports (e.g. the expiration of a periodic timer or the sending of certain
number of event reports), the LMF sends a cumulative event report to the
H-GMLC and LCS Client or AF over the control plane portion of the periodic or
triggered deferred 5GC-MT-LR using steps 28-30 of the procedure in clause
6.3.1 of TS 23.273 [5]. The cumulative event report indicates to the H-GMLC
and External LCS Client or AF that the control plane portion of the periodic
or triggered deferred 5GC-MT-LR is still operational, that the UE is still
reporting events (e.g. is still powered on and in network coverage) and may
include statistics on the events reported since the last cumulative event
report was sent (e.g. the number of event reports).
#### 6.19.3.4 Cancellation of Event Reporting
Cancellation of event reporting can be initiated by the UE, H-GMLC or LCS
Client or AF using the control plane procedures defined in clauses 6.3.2 and
6.3.3 in TS 23.273 [5]. The only change to these procedures is that the user
plane connection(s) established for the procedures in clauses 6.19.3.1,
6.19.3.2 and 6.19.3.3 are also released. The user plane connection(s) may be
released by either end once cancellation at the control plane level has
occurred.
### 6.19.4 Impacts on services, entities, and interfaces
UE:
\- Support control plane signalling transfer of information related to user
plane transfer (e.g. IP address, FQDN, security information).
\- Support user plane connection establishment and release to an LMF, H-GMLC
or LCS Client or AF.
\- Support sending event reports via the user plane connection.
\- Support cumulative event reporting to an LMF via control plane.
LMF:
\- support control plane signalling transfer of information related to user
plane transfer (e.g. IP address, FQDN, security information).
\- Support user plane connection establishment and release to a UE and an LCS
Client or AF (this is optional).
\- Support receiving and sending event reports via the user plane connections
(this is optional).
\- Support receiving and sending cumulative event reports via control plane.
H-GMLC:
\- support control plane signalling transfer of information related to user
plane transfer (e.g. IP address, FQDN, security information).
\- Support user plane connection establishment and release to a UE and an LCS
Client or AF (this is optional).
\- Support receiving and sending event reports via the user plane connections
(this is optional).
\- Support receiving and sending cumulative event reports via control plane.
LCS Client or AF:
\- support control plane signalling transfer of information related to user
plane transfer (e.g. IP address, FQDN, security information).
\- Support user plane connection establishment and release to a UE, H-GMLC or
LMF.
\- Support receiving event reports via the user plane connection.
\- Support receiving cumulative event reports via control plane.
## 6.20 Solutions 20: NWDAF based Indoor or Outdoor in Location Services
### 6.20.1 Introduction
The FS_eLCS_Ph3 of this TR includes the following agreed aspect to study as
part of key Issue #4: Interaction between Location Service and NWDAF:
\- Identify use cases where new or existing data analytics from the NWDAF can
be used for improving location service performance. Regulatory requirements
(e.g. different location accuracy requirements from FCC in different cases)
will be taken into account.
NOTE: Coordinated activities between the study FS_eNA_Ph3 and this study are
needed.
### 6.20.2 Solution Description
As part of the Regulatory requirements, for example FCC \"Wireless E911
Location Accuracy Requirements\" which requires ±3 meters accuracy for indoor
cases. However, currently, LMF output does not contain indoor/outdoor level
indication. For example, police or lawful agency wants to know if user/victim
is inside the building or outside the building, according, they approach the
user. Additionally, knowledge of such UE status helps LMF to use most optimal
positioning method and optimization to calculate UE\'s indoor and/or outdoor
position. (e.g. different location accuracy requirements from FCC in different
cases), it is required to determine if a particular user is located indoor or
outdoor. Such information of user can then be used by rescue team to take
appropriate action. This clause provides high level solution, and detail
procedures are for further studies.
This solution allows an regulatory AF/LCS client to request UE\'s indoor or
outdoor location in the \"LCS Service Request\".
Such request triggers LMF to request/subscribe to analytics data from NWDAF.
This is to request analytics information from NWDAF to assist LMF in
determining whether UE is indoor or not.
Since indoor/outdoor information is regulatory requirements about accuracy and
could assist in better accuracy of final result, to support this, NWDAF can
use the same interface of regulatory AF/LCS Client to fetch both accurate
result and indoor/outdoor information. NWDAF can also implement new analytics
determination logic in order to determine indoor-outdoor prediction of the UE.
This fits the KI#9 in eNA study.
As proposed by other solutions of KI#4, using GMLC/NEF interface, NWDAF can
get the better accurate information for machine learning of both accurate
position and indoor/outdoor indication.
\'\'LMF can optionally decide the indoor/outdoor information by following
methods:
1\. UE can detect the indoor-only signal including serving cell ID (NCGI)
which serves only indoor cases, or indoor WLAN and/or Bluetooth positioning
information defined in TS 37.355 [15].
2\. LMF can generate the altitude information and identify the UE is below the
height of the roof (in SRTM DB, etc).
3\. Other implementation specific methods.
LMF provides all the measurements from RAN node/UE and optional indoor/outdoor
indication to NWDAF:
\- When indoor/outdoor indication is provided to NWDAF, NWDAF can perform the
learning process to correlate the positioning measurements with indoor/outdoor
result.
\- When indoor/outdoor indication is absent, LMF can use the measurements to
query NWDAF for the indoor/outdoor decision result.
NWDAF generates analytics data and with certain confidence level, provides as
output to LMF indicating whether UE is indoor or outdoor.
LMF based on its own decision or the received analytics result includes
whether UE is indoor or outdoor, LMF can reply the information to AF/LCS
Client to meet the regulatory requirements through AMF/GMLC/NEF; LMF can also
determines most suitable positioning method e.g. optimized to indoor
positioning or outdoor positioning.
### 6.20.3 Procedures
\'
Figure 6.20.3-1: In/out-door analytics provided by NWDAF
Step 1: Regulatory (LI or Emergency) NI-LR or MT-LR procedure as defined in TS
23.273 [5]. NWDAF can also use GMLC to fetch finer granularity information
with indoor/outdoor indication in response.
Step 2: LMF receives the request which requires indoor and outdoor indication.
Step 3: LMF performs positioning procedures (using LPP with UE or NRPPa with
RAN nodes).
Step 3.1: LMF may decide indoor and outdoor decision by its own positioning
procedures/measurements. This could also be carried out in non-regulatory
procedures to enrich the NWDAF dataset.
Step 3.2.a: When LMF decides the indoor/outdoor indication, it can feed the
measurements and result to NWDAF for learning process.
Step 3.2.b: When LMF can\'t decide the indoor/outdoor indication, it can use
its measurements to query NWDAF.
Step 3.3: No matter indoor/outdoor decision is made by LMF or NWDAF, LMF can
use the information to optimize its positioning methods or procedures.
Step 4\~5: indoor and outdoor information can be forwarded back to various
client to meet the regulatory requirements.
Step 6: The indoor/outdoor information can be included in the response if
needed. NWDAF can get the indoor/outdoor indication when better accurate
information than TA/CI is needed.
### 6.20.4 Impacts on services, entities, and interfaces
LCS Client: support indication of indoor/outdoor in the LCS Service Request.
LMF: support determination of UE\'s indoor or outdoor location.
NWDAF: support new analytics of indoor and outdoor decision.
## 6.21 Solution #21: Collection of nearby GNSS assistance data
### 6.21.1 Introduction
This solution addresses KI#5 about how LMF to obtain nearby GNSS assistance
data.
### 6.21.2 Functional Description
Normally, a serving area of a GNSS reference station can cover one TA or
multiple TAs (i.e. its GNSS assistance data applies to one TA or multiple
TAs). When LMF collects GNSS assistance data, it requests corresponding data
which can serve its serving area. The collection may be performed on a
periodic basis.
With different GNSS reference deployment scenarios, how LMF obtain GNSS
assistance data can be different. In this solution, following cases are
considered:
\- GNSS reference stations are third party functions co-located with gNBs and
LMF collects data from AFs.
LMF gets GNSS assistance data through AF event exposure service as described
in clause 5.2.19.2 of TS 23.502 [3], LMF may also get the precise global
coordinates of GNSS reference stations. In this case, LMF is enhanced to
support utilize the Naf_EventExposure service. LMFs collected GNSS assistance
data may update its NF profile in NRF by indicating the TAs of which
corresponding GNSS assistance data exists, which can be discovered and used by
other LMFs not having corresponding GNSS assistance data.
\- For a trusted AF, AF registers at the NRF with its serving area (e.g. TAs
or geographical location). LMF discovers trusted AFs which can cover its
serving area through NRF and subscribes to GNSS assistance data exposure from
discovered trusted AFs.
\- For a third-part AF, AF registers at the NEF with its serving area (e.g.
geographical location) and NEF registers itself with the serving area
information (mapped into TAs) to NRF. LMF discovers corresponding NEFs which
can cover its serving area through NRF then subscribes GNSS assistance data
through the discovered NEFs.
### 6.21.3 Procedures
#### 6.21.3.1a GNSS assistance data collection from untrusted AF
The procedure in Figure 6.21.3.1a-1 is used by LMF to collect GNSS assistance
information from AFs via the NEF, which is similar with NWDAF collecting data
from untrusted AF described in clause 6.2.2.3 of TS 23.288 [9].
Figure 6.21.3.1a-1: GNSS assistance data collection
1a-1c. Similar with steps 1a-1c in figure 6.2.2.3-1 of TS 23.288 [9]. The
difference is that AF should also provide its serving area to NEF. NEF should
map the serving area into TA(s) if it is presented as geographical location
and update the NEF profile in NRF including the serving area information.
1d-1e. Similar with steps 1d-1e in figure 6.2.2.3-1 of TS 23.288 [9]. The
difference is that LMF may additionally provide TAs to discover specific NEFs.
2-5. Similar with steps 2-5 in figure 6.2.2.3-1 of TS 23.288 [9]. The
difference is that besides available GNSS assistance data, AF further provide
associated serving area of the GNSS assistance data and optional precise
global coordinates of the source of the GNSS assistance data. NEF may map the
serving area into a TA or TA list.
#### 6.21.3.1b GNSS assistance data collection from trusted AF
For trusted AFs, LMF should collect GNSS assistance data through AFs directly.
LMF discovers trusted AFs covering LMF serving area through NRF and subscribes
to GNSS assistance data exposure from discovered trusted AFs.
Figure 6.21.3.1b-1: GNSS measurements transfer1a-1c. AF registers at the NRF\
with its serving area (e.g. TAs)
1d-1e. LMF provide TAs to discover AFs.
2-3. LMF subscribes AF for GNSS assistance collection. Besides available GNSS
assistance data, AF further provides associated serving area of the GNSS
assistance data and optional precise global coordinates of the source of the
GNSS assistance data.
### 6.21.4 Impacts on services, entities, and interfaces
LMF:
\- Support to collect and store GNSS assistance data from AF, RAN or UE.
\- When receive GNSS assistance data, send message to NRF to indicate GNSS
assistance data existence in certain area.
AF:
\- Support exposure of GNSS assistance data associated with geographical
location.
NEF:
\- Support exposure of GNSS assistance data associated with geographical
location from AF.
## 6.22 Solution #22: Support of LCS mobility when UE moves between NG-RAN
nodes
### 6.22.1 Introduction
This solution addresses the KI \"Key Issue #8: support of location service
continuity in case of UE mobility\".
Continuity of certain basic services like a PDU session during mobility is
defined currently. However, the handling of an LCS session during mobility
procedures is not specified currently. In particular, there is no
specification on whether an ongoing LCS session shall be terminated or
continued with after the mobility and if continued, how the continuity shall
work. There can be many effects due to this missing part:
\- LCS sessions may be terminated at mobility with the LCS Client having to
re-initiate the session after the procedure.
\- The LMF may not be aware of the mobility at all, leading to inaccurate
positioning estimates.
\- Since there are no clear specifications, inter-vendor tests could fail.
\- LCS sessions could be enabled as part of other critical services (like
emergency calls) - those services could be impacted due to the current
specifications - leading to regulatory issues.
All of the above issues could be prevented if there is a clear specification
on how LCS sessions are to be handled in different mobility procedures and in
particular, if continuity can be guaranteed by the network.
We describe the additional handling required at LMF change for LCS Continuity
in both the scenarios - Xn based HO and NG based HO.
It is noted that clause 6.4 of TS 23.273 [5] describes LMF change handling
already. But this is for the case where the AMF detects the need for LMF
change (possibly due to UE mobility) before the LCS session is started. In the
scenario that solution 22 addresses, the HO happens after the LCS session is
started. So, the existing solution will not address this scenario.
### 6.22.2 Functional Description
This proposal provides a solution for the intra-5GS mobility across NG-RAN
nodes.
### 6.22.3 Procedure
Figure 6.22.3-1: Xn Based Handover -- LCS Continuity
Description:
Steps 1-12 describe the normal LCS session and Xn based HO procedures.
Some of the key steps are described below.
Step 4: AMF knows the LCS Correlation ID of the UE for which the LCS session
is being initiated - it stores the same.
Step 12: AMF comes to know of the completion of the Xn based HO. The Target
gNB also sends the old NGAP : AMF UE ID assigned by the AMF in the message
(Target gNB gets it from Source gNB in step 7).
Step 13: The AMF checks if this UE ID has an associated LCS session that is
active (by checking for the corresponding LCS Correlation ID).
Step 14: If such an LCS session exists, then the AMF shall invoke a
notification towards the LMF indicating the completion of the ongoing mobility
procedure. This could be an existing API enhanced or a new API.
AMF determines that the existing LMF cannot serve the LCS session anymore due
to UE mobility (this could be based on an internal configuration); it then
selects a new LMF and provides this LMF address in the mobility completion
notification to the old LMF.
The old LMF then invokes the Nlmf_Location_LocationContextTransfer procedure
to the new LMF and transfers the LCS Session context.
Step 16: When the LMF receives the notification for mobility completion, it
will keep all the active LCS sessions on, but requests for updated information
to make the measurements accurate. The LMF may communicate with the Target gNB
through the AMF for this purpose.
The new LMF then initiates the LCS session (using the target NG-RAN).
This could be the modified list of TRPs, assistance information etc. and then
subsequently, a fresh request for measurements based on the updated
information.
As can be observed, the entire procedure is done in a way where GMLC and/or
LCS Client is not aware of the mobility handling and the LCS session
continuity is ensured.
Figure 6.22.3-2: NG Based Handover - LCS Continuity
Description:
Steps 1-16 describe the normal LCS session and NG based HO procedures. Some
key steps are highlighted below.
Step 4: Source AMF knows the LCS Correlation ID of the UE for which the LCS
session is being initiated - it stores the same.
Step 9: The Source AMF adds the LCS Session information corresponding to all
the active LCS sessions to the Target AMF along with the assigned old NGAP AMF
UE ID.
S-AMF already sends the Target RAN ID to the T-AMF as part
Namf_CreateUEContextRequest. It could add the S-LMF Address in the same. The
T-SMF then determines if the same LMF can continue to serve the UE post HO
(possibly based on internal configuration).
Step 10: The Target AMF assigns a new NGAP AMF UE ID for the UE as per HO
signalling.
Step 12: T-AMF may then select a different LMF(T-LMF) and indicates this to
the S-AMF in Namf_CreateUEContextResponse. If a new LMF is indicated, then the
S-AMF requests the S-LMF to initiate LMF context transfer using the
Nlmf_Location_CancelLocation. This triggers the S-LMF to start
Nlmf_Location_LocationContextTransfer procedure to the T-LMF and transfers the
LCS Session context.
Step 16: The HO completes and Target AMF gets the notification with the new
NGAP AMF UE ID.
Step 17: It then checks if that UE had an existing LCS Session on the Source
AMF (using the data it got in step 9).
Step 18: If such an LCS session exists, then the AMF shall invoke a
notification towards the LMF indicating the completion of the ongoing mobility
procedure. This could be an existing API enhanced or a new API.
The LMF may then choose to do the same actions as described for the Xn based
HO to keep the LCS session active, but with updated, more accurate parameters
and measurements. The LMF may communicate with the Target gNB through the
Target AMF for this purpose. This completes the LCS session continuity for NG
based HO.
The T-LMF shall then wait HO completion notification and then re-initiates the
LCS session with the T-gNB.
NOTE 1: The above solutions are applicable to:
\- UL or DL or UL+DL positioning methods.
\- MTLR/MOLR/NILR LCS sessions.
NOTE 2: In both the solutions, the LMF is assumed to remain the same. Handling
of LCS session during LMF change is already specified in TS 23.273 [5].
### 6.22.4 Impacts on services, entities, and interfaces
AMF: Check if the UE has an existing LCS Session after HO. If yes, invoke a
notification towards the LMF indicating the completion of the ongoing mobility
procedure.
LMF: Receive notification indicating the completion of the ongoing mobility
procedure and initiate the LCS session using the target NG-RAN.
## 6.23 Solution #23: Location Verification for Satellite Access assisted by
TN access
### 6.23.1 Introduction
This solution addresses Key Issue #9 on support of positioning requirements
related to satellite access.
When a UE using NR satellite access, the UE should first determine a most
suitable PLMN based on its own physical location determination. As there may
be border cases where the UE cannot determine sufficiently accurate or
sufficiently precise in which country it is, in order to meet the regulatory
requirements, the network needs to verify whether the PLMN selected by the UE
is allowed to operate in the country of the UE location based on the UE
location information. But the UE location information may not reliable since
it was determined by gNB based on UE-generated location information (e.g.
GNSS/A-GNSS ).
Such verification becomes essential in the country borders, especially in
terrestrial border. There is usually terrestrial cellular network coverage in
such areas. This solution provides a method to do NTN location verification
for UE using satellite access based on the UE location provided by TN access
(e.g. NR) and based on the following assumptions:
\- The UE has the capability to support both TN access and NTN access.
\- The area of the UE present location has both TN and NTN network coverage.
### 6.23.2 Functional Description
The high level functional description of this solution is as follows:
\- During the registration procedure through NR satellite access, the UE
indicates the capability of supporting TN access (e.g. NR).
\- If the network intends to do NTN location verification for UE using
satellite access, it requests UE to initiate registration via TN access.
\- The UE initiates Registration through TN access. The TN access (e.g. gNB)
provides UE location information to the network through NGAP message. After
receiving the UE location, the network responds Registration Reject to the UE.
\- The AMF verifies the PLMN selected by the UE is whether allowed to operate
in the country of the UE present location based on the UE location receiving
from TN access.
NOTE 1: Solution works in areas covered by both TN access and NTN access and
the UE has the capability of supporting both TN access and NTN access.
NOTE 2: How to support emergency service is out of scope in this solution.
### 6.23.3 Procedures
Figure 6.23.3-1: Procedure for location verification for satellite access
assisted by TN access
1\. For a UE accessing to 5GC using NR satellite access, the UE sends a
registration request message to AMF1. As per existing procedure, parameters
such as registration type, SUCI or 5G-GUTI, etc, are contained in the message.
Besides that, if the UE supports 3GPP TN access (e.g. NR), the capability is
also included in the message.
2\. The AMF1 registrates to the UDM using Nudm_UECM_Registration message as
described in clause 4.2.2.2.2 of TS 23.502 [3].
3\. The AMF1 determines NTN location verification for NR satellite access is
needed, it returns the Registration Accept message to the UE with an
indication to request the UE to access via TN access.
4\. The UE sends registration request via TN access to AMF2 which includes
\"NTN location verification\" to indicate the registration procedure is used
to provide UE location for NTN location verification. The TN RAN (e.g. gNB)
sends the UE location information in NGAP to the AMF2. The AMF1 and the AMF2
selected by the UE via NTN and TN access may belong to different PLMNs.
5\. The AMF2 registers with the UDM using Nudm_UECM_Registration. The UDM
stores the UE location information received from TN access.
If the TN access and NTN access selected by the UE belong to different PLMNs,
it can be seen as the PLMN selected by UE via NTN access is home PLMN while
the PLMN selected by UE via NTN access is Serving PLMN. The AMF2 in the
serving PLMN will selects UDM in the Home PLMN based on the UDM selection as
specified in clause 6.3.8 in TS 23.501 [2] during initial registration. Then
the AMF2 provides the UE location information in TN access to the UDM for
preserve.
6\. The AMF2 sends registration reject message to UE with a suitable cause
value indicating NTN location verification.
7\. The UDM sends Nudm_SDM_Notification to provide the UE location receiving
from TN access to the registered AMF1.
8\. Based on the UE location receiving from TN access, the AMF1 can verify
whether the UE is allowed to operate in the country/area of the UE present
location.
### 6.23.4 Impacts on services, entities, and interfaces
UE:
\- Capability to support both TN access and NTN access, inform this capability
to the network.
AMF:
\- Based on the UE capability, requests UE to initiate registration through TN
access.
\- Requests UE location information from UDM.
\- Based on the UE location information receiving from TN access, verifies the
PLMN selected by UE is whether allowed to operate in the country of the UE
location.
UDM:
\- Receives and Stores UE location information through registration procedure
via TN access.
\- Provides the UE location information to the AMF.
## 6.24 Solution #24: UE Location Verification based on Obtained Information
### 6.24.1 Introduction
This solution addresses KI#9: Support of Positioning Requirements Related to
Satellite Access.
### 6.24.2 Functional Description
In Rel-17, as described in clause 5.4.11.4 in TS 23.501 [2], if the AMF is not
able to determine the UE\'s location with sufficient accuracy based on the
ULI, the AMF proceeds with the Mobility Management or Session Management
procedure and may initiate UE location procedure after the Mobility Management
or Session Management procedure is complete, as specified in clause 6.10.1 of
TS 23.273 [5], to determine the UE location. The AMF shall be prepared to
deregister the UE if the information received from LMF indicates that the UE
is registered to a PLMN that is not allowed to operate in the current UE
location.
In this solution, it is proposed to optimize the mechanism for UE location
verification, as follows:
\- If NG-RAN can verify UE location, the NG-RAN provides assistance
information including the verification result to AMF.
\- When the assistance information indicates that UE location is reliable, the
AMF skips the UE location verification mechanism in Rel-17.
\- When the assistance information indicates that UE location is not reliable,
the following scenario may happen:
\- If the country of the UE reported location is the same as the country of
the network verified UE location, the AMF triggers LCS procedure to obtain UE
location and notify the UE location to NFs which have subscribed the related
event.
\- If the country of the UE reported location is different from the country of
the network verified UE location, the AMF initiates deregistration procedure
with a suitable cause value.
NOTE: Whether and what assistance information can be provided by NG-RAN
depends on the conclusion of the network verified UE location objective in
Rel-18 NR_NTN_enh WID in RAN WG.
\- Otherwise, the existing UE location verification mechanism in Rel-17 is re-
used.
### 6.24.3 Procedures
#### 6.24.3.1 UE Provided Location Verification based on Obtained Information
Figure 6.24.3.1-1: UE Provided Location Verification based on Obtained
Information
1\. The UE sends UE location information (i.e. GNSS info) to NG-RAN over NR-Uu
via satellite access.
2\. [Conditional] If the NG-RAN can verify UE location, it verifies the
reported UE location.
NOTE: Whether NG-RAN can verify UE location and how to verify the UE location
depends on the conclusion of the network verified UE location objective in
Rel-18 NR_NTN_enh WID in RAN WG.
3\. [Conditional] If the step 2 is performed, the NG-RAN sends N2 message
including the assistance information.
4\. [Conditional] If assistance information provided by NG-RAN indicates that
UE location is not-reliable, and the country of the UE reported location is
the same as the country of the network verified UE location, and there is
NF(s) has subscribed UE location event report, the AMF triggers the 5GC-NI-LR
procedure in clause 6.10.1 of TS 23.273 [5] to obtain UE location.
5\. [Conditional] If the step 4 is performed , the AMF notifies the UE
location to the NF(s)..
6\. [Conditional] If assistance information provided by NG-RAN indicates that
UE location is not-reliable and the country of the UE reported location is
different from the country of the network verified UE location, the AMF
deregisters the UE.
### 6.24.4 Impacts on services, entities, and interfaces
AMF: receive assistance information from NG-RAN and behaves accordingly.
NG-RAN: verifies the UE location reported by the UE and provides assistance
information to AMF.
NOTE: Whether and what assistance information can be provided by NG-RAN
depends on the conclusion of the network verified UE location objective in
Rel-18 NR_NTN_enh WID in RAN WG.
## 6.25 Solution #25: Event Report in an Allowed Area
### 6.25.1 Introduction
This solution addresses KI#11: Enhance the Triggered Location for UE power
saving purpose.
### 6.25.2 Functional Description
To support tracking UE location in a pre-defined area, an event report allowed
area is introduced in this solution. Only when a UE is in the area, it is
allowed to send the event report.
The event report allowed area can be provided by UE or LCS Client/AF:
\- The UE provided area is stored in UDM; and/or
\- The LCS Client/AF can provide the event report allowed area in the LCS
Service Request.
If GMLC receives both areas above, the overlap of the areas is the event
report allowed area. If there is no overlap, the GMLC rejects the LCS Service
Request. The GMLC is responsible to determine a TA/cell list based on the
event report allowed area.
NOTE: To support power saving, the UE can set the event report allowed area to
a small geographical area.
The event report allowed area determined by GMLC is sent to UE via the LCS
Periodic-Triggered Invoke Request message. When the UE detects the trigger or
periodic event happens, if the UE is in the event report allowed area, then it
obtains location measurements, calculates the location estimate and sends the
event report. Otherwise, the UE behaviours above are not performed to save
power. If the time period to the last time that the UE sent the event report
or to the time that the UE receives the LCS Periodic-Triggered Invoke Request
message reaches a certain threshold (e.g. the maximum reporting time for area
or motion event type, implementation dependent threshold for UE available or
periodic event type), the UE initiates the cancellation procedure.
### 6.25.3 Procedures
#### 6.25.3.1 Event Report Allowed Area provided by UE
Figure 6.25.3.1-1: UE Provided Location Verification based on Obtained
Information
1\. If the UE has generated or updated the event report allowed area, the UE
sends the event report allowed area to the AMF via UE Location Privacy Setting
Request.
2\. The AMF invokes a Nudm_ParameterProvision_Update service operation towards
the UDM and the service operation carries the event report allowed area. The
UDM stores or updates the event report allowed area in the UDR by invoking a
Nudr_DM_Update (SUPI, Subscription Data) service operation accordingly.
3\. The AMF responses to the UE via UE Location Privacy Setting Response.
#### 6.25.3.2 Event Report in an Allowed Area
To support the event report allowed area, the enhancements to the existing
Initiation and Reporting of Location Events in clause 6.3.1 of TS 23.273 [5]
are as follows:
\- Step 1a: LCS Client includes the event report allowed area in the LCS
Service Request.
\- Step 1b: the event report allowed area is included in the
Nnef_EventExposure_Subscribe Request and Ngmlc_Location_ProvideLocation
Request.
\- Step 2: the event report allowed area is included in Nudm_SDM_Get Response.
If the event report allowed areas received in step 1 and step 2 are not
overlapped, the GMLC rejects the location request, the left steps are skipped.
Otherwise the event report allowed area is the overlapped area and
enhancements to the left steps are as follows:
\- Steps 4, 5, 14 and 16 are enhanced to include the event report allowed area
parameter. In step 4, the GMLC is responsible to determine the cell/TA list
based on the overlapped area and include the cell/TA list in the event report
allowed area.
\- Step 22: When UE detects the event happens, it further checks whether it is
in the event report allowed area. If yes, the steps 23 to 30b-2 are performed.
Otherwise, the steps 23 to 30b-2 are skipped.
#### 6.25.3.3 Add a new trigger for Cancellation of Reporting of Location
Events by a UE
A new trigger is added for UE to cancel Reporting of Location Events procedure
in clause 6.3.2 in TS 23.273 [5]:
\- If the time period to the last time that the UE sent the event report or to
the time that the UE receives the LCS Periodic-Triggered Invoke Request
message reaches a certain threshold (e.g. the maximum reporting time for area
or motion event type, implementation dependent threshold for UE available or
periodic event type), the UE initiates the cancellation procedure.
### 6.25.4 Impacts on services, entities, and interfaces
GMLC:
\- Receive the event report allowed area from LCS Client/AF and/or UDM and
decide the final event report allowed area based on the received area(s).
\- Send the event report allowed area to AMF.
UDM:
\- Receive the event report allowed area from UE and store the parameter.
\- Provide the event report allowed area to GMLC.
AMF: Receives the event report allowed area from GMLC and send the parameter
to LMF.
LMF: send the event report allowed area to UE.
UE: Receive the event report allowed area from LMF and enforce the parameter.
## 6.26 Solution #26: LPHAP requirement awareness by LMF
### 6.26.1 Introduction
The solution addresses key issue #12, support of low power and/or high
accuracy positioning. In particular, the issue \"whether new information is
needed in subscription data for low power and/or high accuracy positioning\"
is clarified its necessity.
When RAN discussed low power and high accuracy positioning (LPHAP) in the
workshop (RWS-210573), people believe the UE requiring low power and high
accuracy positioning can be a new UE type, or based on Redcap UE or eMBB UE.
It means low power and high accuracy positioning is not a \"label\" to
differentiate UE, but actually a location service requirement for both UE
impact and service performance.
With the introduction of LPHAP, location procedure in rel-18 needs to be
enhanced to satisfy the requirement. In terms of \"HA(high accuracy\",
currently it is identified by LCS QoS, and optionally provided by the LCS
client/AF. If the LCS QoS is not provided, the LMF will treat the location
request with a default accuracy.
On the other hand, LPHAP also reflects the expected UE impact when being
positioned, i.e. low power consumption. LMF is responsible for positioning
method selection. Usually UE-based positioning will consume more power than
NW-based one. Therefore LMF should take into account the LPHAP requirement
when determine the positioning method.
### 6.26.2 Functional Description
In UE LCS subscription data, it may include \"LPHAP indication\". During UE
registration, AMF fetches the UE LCS subscription data to the LMF.
\- AMF includes the LPHAP indication to LMF when forwards the location request
message.
\- AMF provisions RAN with LPHAP indication during UE registration procedure
and/or LMF provides RAN with LPHAP indication during positioning procedure.
This is used by RAN to determine positioning measurement method to the UE.
### 6.26.3 Procedures
Figure 6.26.3-1: LPHAP requirement awareness by LMF
1\. (registration phase) UE sends requisition request message to AMF.
2\. AMF request UDM for UE subscriber data.
3\. UDM returns UE subscriber data including LCS relevant parameter, i.e.
LPHAP indication.
4\. AMF sends the LPHAP indication to RAN in the UE context modification
message.
5\. (Location procedure) LCS client sends location request to GMLC.
6\. GMLC forwards the location request to AMF.
7\. AMF sends location request to LMF including LPHAP indication.
8\. LMF determines suitable positioning method, by taking into account the
LPHAP requirement.
9\. If NW based is determined in step8, LMF sends the LPHAP indication to RAN,
in the NRPPa message.
10\. (rest of the positioning procedure).
### 6.26.4 Impacts on services, entities, and interfaces
UDM:
\- LPHAP indication in the UE LCS subscription data.
AMF:
\- Retrieve from UDM LPHAP indication in the UE LCS subscription data.
\- Provides to LMF LPHAP indication, in the location request.
\- Provisions RAN with LPHAP indication.
LMF:
\- Receive from AMF LPHAP indication in the location request.
\- Determine positioning method, by taking into account the LPHAP requirement.
\- sends LPHAP indication to RAN.
RAN:
\- Receive from AMF LPHAP indication in the UE registration procedure and
based on it to determine the handling of NRPPa request from LMF.
## 6.27 Solution #27: Use Group Information to Correlate GMLC and LMF
### 6.27.1 Introduction
This solution addresses the key issue #3: Local Area Restriction for an LMF
and GMLC. In this solution, the LMF discovery and selection mechanism by AMF
is enhanced to use Group Information as a way to select a \"local LMF\" for
local requests whose LMF should be \"local\".
For example, it may be desirable to handle location requests targeting a UE
belonging to a factory by using a \"local\" LMF associated with the factory
i.e. possibly hosted on the factory premises, allowing to keep information
related with location of the factory users within entities controlled by the
factory. Conversely, the location of UE, not members of the factory (users
passing by near or within the factory but not members of the factory staff),
should not be handled by LMF resources of the factory.
Another example is the ProSe [19]/Ranging services within the local area,
after discovery process, the group information can be exposed to AS/AF through
PC1/SR1 interface. Based on the information exposed, AS/AF can update the
group and its member information by group management through NEF according to
TS 23.501 [2]. When the group information has been aligned, AS/AF can use the
group parameter in LCS request to the paired GMLC and LMF in the local area.
The group information may be transferred directly from AF/LCS Client or
derived from the LCS request by AMF. With the group information, which shows
the location service requires a local LMF, AMF select a local LMF.
GMLC/NEF may derive group information from the attributes in the request; when
the slice information is correlated to the group communication, AMF may derive
the group information from the slice information of the UE.
Such information can also be used by LMF to select GMLC of the same area to
perform event/periodic reporting.
### 6.27.2 Functional Description
**AF/LCS Client Provides Group Parameter**
AF/LCS Client issues LCS request through NEF or GMLC. It may provide an
external group ID in the location request as a parameter for LMF selection by
AMF.
NOTE: Detailed definition and/or parameters of group information can be
decided during normative phase and/or stage 3 process.
**GMLC/NEF Forwards or Derives Group Information**
GMLC and NEF can forward the group information from LCS Client/AF to AMF.
GMLC and NEF can also derive the group information from following parameters
in the LCS request:
\- Group id (ExternalGroupId from AF/LCS Client) may be transferred to AMF
through GMLC/NEF (using e.g. Ngmlc_Location_ProvideLocation service operation
defined in clause 8.4.2 of TS 23.273 [5]), as a complementary information to
the UE ID.
\- The ServiceIdentity/Serviceid/svcId in the request from AF/LCS Client. When
it is the local service in the local area, NEF or GMLC can derive the group
information from the AF/LCS Client information from the request (e.g. LCS
Client Identification or ServiceIdentity/Serviceid in
Ngmlc_Location_ProvideLocation service operation defined in clause 8.4.2 of TS
23.273 [5] or \"svcId\" in MonitoringEventSubscription of TS 29.522 [24]) and
forward the derived target group information to AMF.
\- A local (corporate or local service related) GMLC instance may be
configured to always add a Group attribute in the LCs requests sent to the AMF
\- In some cases (like NI-LR), NEF or GMLC may know the serving TAI/NCGI when
receiving the LCS request, and can derive the area information where the
GMLC/LMF correlation should be performed. The local group information can be
derived independently or can also be queried from UDM.
\- Through AF/AS(LCS Client) profile which can be derived by client
connection, GMLC/NEF may be aware all the requests from such clients should be
restricted to the area. The group information of the area can be attached
before the request forwarded to AMF.
Through above information, GMLC/NEF can instruct AMF to perform the LMF
selection logic of the same area.
**AMF Selection Logic with Group and/or Slice Information**
The AMF may use group information received in a location request to select the
LMF.
Since slicing information is already defined as NF related NRF registration
and discovery information, when dedicated slices allocated to the service area
and LMF profile in NRF has configured same area (which could be used to drive
such GMLC/LMF correlation), AMF could also lookup the LMF instance through the
slice information to ensure the LMF of the specific area/service is chosen.
For the serving TAI/NCGI in the area where the GMLC/LMF correlation should be
performed. The local group information can be derived or can be queried from
UDM.
**LMF Registration to NRF**
\- The Group ID is added to LMF related NRF registration and discovery
Information.
\- Based on multiple trigger criteria, the AMF determines whether a group is
to be related with a LCS request, and uses this information to select the
proper LMF.
**LMF Selection of GMLC in Event/Periodic Reporting**
When selected, LMF receives the group information from the AMF LCS request.
The group information is used in GMLC selection in case of event/periodic
report in deferred location process:
\- LMF may be configured with local GMLC address when area correlation is used
in the location request.
\- LMF may use the group service area to derive the GMLC address for
event/periodic reporting, and/or verify the GMLC address in the request and
decides accordingly with implementation logic.
### 6.27.3 Procedures
Figure 6.27.3-1: LMF selection based on group information
Step 1: MT-LR procedure started as defined in TS 23.273 [5]. The service uses
local GMLC (or through NEF). AF/LCS Client may take group information in the
request parameters.
Step 2: Local GMLC may use the group information in the request or derive the
group information from the context or parameters of the request.
Step 3: AMF receives the request.
Step 3.1: For local/edge service, AMF could also use the slice information to
select/lookup LMF instance (from NRF).
Steps 4\~6: LMF performs the LCS session.
Step 7: LMF select the paired GMLC for reporting. When multiple criteria
exist, the GMLC selection logic is implementation specific.
### 6.27.4 Impacts on services, entities, and interfaces
AS/AF/LCS Client:
\- may provide group information in an LCS request.
GMLC/NEF:
\- May propagate group information received from AS/AF/LCS Client or may
determine group information based on the received location request.
AMF:
\- Select the LMF according to the group information received from the GMLC.
## 6.28 Solution #28: Support of PRUs
### 6.28.1 Introduction
This solution addresses KI#7 - support of Positioning Reference Units (PRUs)
according to the definition in TS 38.305 [6] which is as follows:
+----------------------------------------------------------------------+ | **5.4.5 Positioning Reference Unit (PRU)** | | | | A Positioning Reference Unit (PRU) at a known location can perform | | positioning measurements (e.g. RSTD, RSRP, UE Rx-Tx Time Difference | | measurements, etc.) and report these measurements to a location | | server. In addition, the PRU can transmit SRS to enable TRPs to | | measure and report UL positioning measurements (e.g. RTOA, UL-AoA, | | gNB Rx-Tx Time Difference, etc.) from PRU at a known location. The | | PRU measurements can be compared by a location server with the | | measurements expected at the known PRU location to determine | | correction terms for other nearby target devices. The DL- and/or UL | | location measurements for other target devices can then be corrected | | based on the previously determined correction terms. | | | | From a location server perspective, the PRU functionality is | | realized by a UE with known location. | +----------------------------------------------------------------------+
The definition shows that a PRU can be a supported as a UE since positioning
measurements and SRS transmission can correspond to what is defined for a UE.
The main principles of this solution are as follows:
1\. Treat PRUs the same as normal UEs from an architectural perspective.
2\. Avoid impacting an AMF, NG RAN node, UDM or any existing non-eLCS
interface or reference point.
3\. Make use of a Supplementary Service protocol (e.g. the protocol defined in
TS 24.080 [21]) to enable interaction between a PRU and an LMF that is
transparent to other entities.
NOTE: It is assumed that a PRU can only operate when in coverage of the PLMN
to which it belongs or with which it is associated.
### 6.28.2 Functional Description
#### 6.28.2.1 Architecture
The non-roaming reference architecture shown in Figure 4.2.1-1 in TS 23.273
[5] is modified as shown in Figure 6.28.2.1-1 to support a PRU.
Figure 6.28.2.1-1: Non-roaming reference architecture for a PRU
#### 6.28.2.2 Protocol Layering
A PRU interacts with an LMF using the protocol layering shown in Figure
6.28.2.2-1. This is the same protocol layering defined in clause 6.4.1 of TS
38.305 [6] for LMF to UE interaction except for allowing a supplementary
services protocol and other positioning protocols besides LPP to be used
between an LMF and a PRU at the top level.
Figure 6.28.2.2-1: Protocol Layering for LMF to PRU Signalling
The top protocol layer between the PRU and the LMF is a supplementary services
protocol (e.g. as defined in TS 24.080 [21]) or a positioning protocol (e.g.
LPP).
#### 6.28.2.3 Multiple LMF Association
A PRU can be registered with more than one LMF to enable multiple LMFs to
obtain location related information from or for the PRU. This is no different
to a normal target UE being positioned by different LMFs (e.g. at the same
time or at different times). A PRU may be configured with a limit on the
number of LMFs that it is allowed to register with. When a PRU receives a
conflicting location related request from an LMF (e.g. a request to obtain
measurements at the same time as obtaining measurements for another LMF), the
PRU can reject the request. The sharing of a PRU by several LMFs might occur
in a border area between areas supported by the different LMFs.
PRU registration in more than one LMF can be avoided or reduced if PRUs are
deployed to support only one LMF or if multiple LMF registration is restricted
to just a small fraction of PRUs located in border areas shared by two or more
LMFs.
### 6.28.3 Procedures
#### 6.28.3.1 Registration Procedure
Figure 6.28.3.1-1 shows a registration procedure used by a PRU to register
with an LMF. The procedure is used for initial registration when a PRU first
starts to access its associated PLMN - e.g. following an initial deployment
and initial power on. The procedure can also be used subsequently to perform a
registration update to inform the LMF of the continued availability of the PRU
or to inform the LMF of some change to the PRU such as a change of location
(e.g. a change of tracking area or change of serving AMF) or change of the PRU
positioning capabilities.
Figure 6.28.3.1-1: Registration Procedure for a PRU
**Precondition:**
For initial Registration, a Routing Identifier has been configured in the PRU
indicating an LMF. For subsequent Registration, a Routing ID indicating an LMF
has been returned to the PRU at step 6a or 6b of a previous Registration.
NOTE 1: A Correlation ID and a Routing ID are different terms for the same
identifier. The term \"Correlation ID\" is used for an identifier in NL1
service operations between an AMF and LMF while the term \"Routing ID\" is
used for an identifier in a NAS message sent over the N1 reference point
between a PRU and AMF.
1\. The PRU performs a UE Triggered Service Request if in CM IDLE state.
2\. The PRU sends a supplementary services Registration Request to the serving
AMF in an UL NAS TRANSPORT message and includes the preconfigured Routing ID
for an initial Registration or the Routing ID received at step 6a or step 6b
for the previous Registration. The Registration Request is included in the UL
NAS TRANSPORT message as a \"Location services message container\" at the NAS
level which means that an AMF can transfer the message to the LMF at step 3
without a new AMF impact. The Registration Request may include an identity for
the PRU (e.g. a SUPI, a PEI or a serial number), a reason for the Registration
(e.g. initial Registration, a Registration update, a manually invoked
Registration), a location of the PRU if available, optional authentication
information, a type of PRU (e.g. whether the PRU is fixed or mobile) and
capabilities of the PRU. The capabilities can include capabilities to perform
positioning activities associated with a UE. Capabilities to perform
positioning activities associated with a UE may be indicated by including one
or more embedded LPP messages as defined in TS 37.355 [15] in the Registration
Request.
3\. The AMF selects an LMF based on the Routing ID and transfers the
Registration Request to the LMF. The LMF may be selected based on the Routing
ID and the current TAI and/or CGI for the PRU.
NOTE 2: The AMF sees the PRU as just a normal UE. However, an operator can
assign reserved Routing IDs to a PRU different to Routing IDs used for other
UEs. For example, all PRUs might be configured with a Routing ID A. The
operator can then configure this Routing ID in an AMF such that the AMF
selects a preferred LMF for Routing ID A. This may not require any new
functionality in an AMF.
4\. The LMF authenticates the PRU and verifies that it is a legitimate for
this PLMN. This may use one of the following methods.
**Method A:**
The AMF includes the SUPI of the PRU at step 3 and the LMF verifies that the
SUPI matches a SUPI of a legitimate PRU configured in the LMF.
**Method B:**
The PRU includes an identification and authentication information at step 2
which the LMF verifies against expected authentication information configured
in the LMF for a PRU with this identification. The authentication information
might include a ciphering of the PRU identity and/or a current date and time
(e.g. UTC) based on a private key stored in secure memory of the PRU.
**Method C:**
The LMF sends an authentication challenge to the PRU via the AMF as a DL
supplementary services message and receives an authentication response from
the PRU sent as an UL supplementary services message, where the authentication
response is based on a private ciphering key held in secure memory in the PRU.
If the LMF is able to store/update PRU information in other LMFs, the serving
LMF need not provide Routing IDs for additional LMFs to the UE.
5a. If the LMF is able to authenticate the PRU at step 4 and can accept the
Registration, the LMF returns a Registration Response to the serving AMF as a
location services supplementary services message and includes a Correlation
ID. The Correlation ID is assigned by the LMF to identify the LMF and the PRU.
The Registration Response may indicate conditions for performing another
Registration with the LMF (e.g. a periodic Registration timer or Registration
based on a change of location, change of TAI or change of serving AMF for the
PRU). The Registration Response may also provide Routing IDs for additional
LMFs with each of which the PRU shall perform a separate Registration.
NOTE 3: A PRU may be fixed, with re-Registration of the PRU only needed at
long periodic intervals. A PRU could instead be mobile (e.g. attached to a
vehicle), with re-Registration then minimally needed whenever the serving AMF
changes to enable the LMF to reach the PRU for the procedures in clause
6.28.3.2 and 6.28.3.3. If the LMF selected by the new AMF then changes, the
previous LMF would discover this from an error response from the previous AMF
when instigating the procedure in clause 6.28.3.2 or clause 6.28.3.3.
NOTE 4: Provision of additional LMFs at step 5a can be implementation and
operator dependent. As one example, if a PRU is located in an area supported
by both the LMF and one or more other LMFs, the LMF may provide indications of
the other LMFs to the PRU.
6a. The serving AMF forwards the Registration Response and a Routing ID equal
to the Correlation ID to the PRU. The PRU stores the Routing ID which is used
for any repeated Registration with this LMF. If Routing IDs for other LMFs are
included in the Registration Response, the PRU performs a Registration with
each of these LMFs.
5b. If the LMF is unable to authenticate the PRU at step 4 or cannot accept
the Registration for some other reason (e.g. the LMF is the wrong LMF), the
LMF sends a Registration Reject to the serving AMF and may include the Routing
ID of another LMF with which the PRU shall perform a Registration.
6b. The serving AMF forwards the Registration Reject to the PRU. If a Routing
ID is included, the PRU performs a Registration with the LMF associated with
this Routing ID.
NOTE 5: The PRU may be configured with a limit on the number or duration of
Registration attempts performed unsuccessfully. When this limit is reached,
the PRU may send an indication to some entity in the PLMN. The indication
might be a text message or an HTTPS message, for example.
7\. If Registration is performed successfully as in steps 5a and 6a, the LMF
may optionally instigate positioning procedures for the PRU as described in
clause 6.28.3.3. For example, the positioning procedures may be used to obtain
or verify a location of the PRU or obtain the positioning capabilities of the
PRU. The LMF also stores information for the PRU including the PRU identity,
the Correlation ID assigned at step 5a and the serving AMF instance.
NOTE 6: Positioning at step 7 may be performed prior to step 5 as an option -
e.g. if PRU location needs to be verified before accepting the Registration.
#### 6.28.3.2 Registration Modification Procedure
Figure 6.28.3.2-1 shows a Registration Modification procedure used by an LMF
to change the Registration status of a PRU. The change in status can include
deregistering the PRU, changing the conditions for sending Registration
updates by the PRU or requesting the PRU to register with additional LMFs.
Figure 6.28.3.2-1: Registration Modification Procedure for a PRU
**Precondition:**
The PRU has previously successfully registered with the LMF using the
procedure in clause 6.28.3.1.
1\. The LMF sends a Registration Modification to the serving AMF as a location
services supplementary services message and includes the identity of the PRU
(e.g. the SUPI) and a Correlation ID identifying the LMF and the PRU. The
Registration Modification may indicate to the PRU new conditions for
performing Registration updates with the LMF (e.g. a periodic Registration
timer or Registration based on a change of location for the PRU). The
Registration Modification may also provide Routing IDs for other LMFs with
each of which the PRU shall perform a separate Registration. The Registration
Modification may further indicate a deregistration of the PRU with the LMF.
2\. If the PRU is in CM IDLE state, the serving AMF performs a Network
Triggered service request to place the PRU in CM CONNECTED state.
3\. The serving AMF forwards the Registration Modification and a Routing ID
equal to the Correlation ID to the PRU.
4\. The PRU returns a supplementary services Registration Modification
response to the serving AMF in an UL NAS TRANSPORT message and includes the
Routing ID received in step 3. The Registration Modification response confirms
receipt of the information in the Registration Modification at step 3.
5\. The serving AMF forwards the Registration Modification response to the LMF
indicated by the Routing ID received at step 4 and includes a Correlation ID
equal to the Routing ID.
#### 6.28.3.3 Positioning Procedure for a PRU
Figure 6.28.3.3-1 shows a positioning procedure used by an LMF to obtain
location related information from or for a PRU.
Figure 6.28.3.3-1: Positioning Procedure for a PRU
**Precondition:**
The PRU has successfully registered with the LMF using the procedure in clause
6.28.3.1.
1\. The LMF may use the UE Assisted and UE Based Positioning Procedure defined
in clause 6.11.1 of TS 23.273 [5] to request positioning capabilities from,
provide assistance data to or request location measurements from a PRU when
functioning as a target UE. The LMF can access the PRU through the serving AMF
identified during Registration.
2\. The LMF may use the Network Assisted Positioning Procedure defined in
clause 6.11.2 of TS 23.273 [5] to send or request location information related
to the PRU to or from the serving NG-RAN node for the PRU. The LMF can access
the NG-RAN through the serving AMF identified during Registration.
3\. The LMF may use the Obtaining Non-UE Associated Network Assistance Data
procedure defined in clause 6.11.3 of TS 23.273 [5] to send or request
location information related to the PRU to or from one or more NG-RAN nodes.
The LMF can access the NG-RAN nodes through the serving AMF identified during
Registration.
### 6.28.4 Impacts on services, entities, and interfaces
PRU:
\- Support Registration and Registration Modification Procedures.
LMF:
\- Support Registration and Registration Modification Procedures for a PRU.
AMF:
\- no impact.
## 6.29 Solution #29: Use PRU in 5G LCS Procedures
### 6.29.1 Introduction
This solution addresses KI#7, support of Positioning Reference Units and
Reference UEs.
### 6.29.2 Functional Description
PRU can claims its location or capabilities\' attributes during registration
process, whether it is static or mobile; these attributes can also be
provisioned by OAM so that 5GC components can fetch the information using its
identity.
\- The location and capabilities of static PRU can either be claimed by itself
in the registration phase or provisioned by OAM.
\- The initial location and capabilities of mobile PRU can be identified in
same way as static PRU in registration attributes or from OAM; it can also be
identified in LPP by triggering an NI-LR process during the registration
phase.
LMF may perform the positioning procedures to PRU during the positioning
process of target UE. But LMF may not always use PRU. It depends on the
positioning request (QoS requirements, etc), environment profile or UE
positioning capabilities and measurements. LMF takes the decision to use PRU
and perform the query/discovery process of available/useful PRU instances.
And there is no conclusion that LCS providers want to use full PRU
capabilities to all LCS requests of all UEs. So, PRU usage is decided and its
information is needed during the request procedures. They are on the request
level instead of subscription level.
For request level information, GMLC is the legacy portal for all LCS related
queries. For future flexibility, GMLC performs the storage and query/discovery
procedures of PRUs.
GMLC can provides different PRU features to different client profiles and/or
request attributes. PRU capabilities can be discovered differently according
to different deployment or LCS provider policies.
PRU information includes the following attributes stored in GMLC to be
discovered/queried:
1\. PRU location information and its mobility and static attributes.
2\. PRU capability and optionally, some measurements which don\'t change for
different target UE transactions, like TA value of static PRU against static
TRP.
3\. Serving AMF and LMF instance of the PRU.
Due to different LMF selection criteria in clause 5.1 of TS 23.273 [5] and
solution to KI#3. When positioning procedures include both target UE and PRU,
the serving LMF for UE and PRU may not be the same LMF instance. This solution
provides inter-LMF communications.
### 6.29.3 Procedures
#### 6.29.3.1 PRU Information Update
Figure 6.29.3.1-1: PRU information update procedure
Step 1: PRU performs registration. The registration may contain PRU attributes
(including location estimate, capabilities).
Step 2: AMF select LMF instance based on PRU attributes or other criteria. If
PRU attributes are available, they are forwarded to LMF.
Step 3: When necessary PRU attributes are missing, LMF perform LCS procedures
to PRU to fetch these attributes.
Step 4: LMF may notify GMLC directly with PRU information or indirectly
through AMF.
Option a: If PRU takes GMLC address in registration, LMF gets the information
from AMF or LMF can derive GMLC address, the GMLC address can be used directly
to send Nlmf_Location_EventNotify with PRU information to GMLC.
Option b: LMF may use AMF to forward the PRU information to GMLC. AMF may
derive the GMLC address.
NOTE 1: Nlmf_Location_DetermineLocation response takes not only location
result, but also additional information of PRU.
NOTE 2: AMF selection of LMF, LMF/AMF selection of GMLC could be
implementation specific.
#### 6.29.3.2 Positioning Procedures with PRU
Figure 6.29.3.2-1: Positioning procedure with PRU
Step 1: LCS NI-LR, MO-LR or MT-LR as defined in TS 23.273 [5].
Step 2: Request arrives to serving LMF of UE.
Steps 3.1\~3.2: LMF may decide to use PRU before/during/after positioning
procedure of target UE.
Step 3.3: LMF queries the GMLC for PRU discovery. It may use the target UE
information or serving TAI/NCGI information as discovery parameters. LMF may
get the GMLC information of the PRU by following ways.
\- LMF could query NRF using serving TAI/NCGI of target UE.
\- LMF could get the serving GMLC if they are correlated as per solutions of
KI#3 of certain local area.
\- LMF may use implementation specific methods to get GMLC instance.
Step 3.4: Based on PRU capabilities, with AMF information of PRU attributes,
LMF for target UE sends request to serving AMF of PRU with requested
positioning information of PRU.
NOTE 1: With implementation specific policy, the serving LMF of PRU during its
registration phase can be used. In this case, LMF for target UE should still
send the request through AMF in case PRU is in CM-IDLE/RRC-INACTIVE state.
Steps 3.5\~3.7: Serving LMF of PRU performs the requested procedures and
replies the necessary information back to the serving LMF of target UE.
NOTE 2: Different PRU may use different LMF instances. The LMF instance
decided by serving AMF may not be same as serving LMF during the registration
phase.
Step 3.8: LMF for target UE may use the result from PRU session to optimize
its positioning procedures.
### 6.29.4 Impacts on services, entities, and interfaces
AMF: Notify PRU info to GMLC.
GMLC:
\- Receive PRU info from AMF or LMF.
\- Provide PRU info to LMF based on request from LMF.
LMF:
\- Notify PRU info to GMLC.
\- Request PRU info from GMLC.
## 6.30 Solution #30: location service continuity for UE moves between NG-RAN
nodes
### 6.30.1 Introduction
This solution addresses Key Issue #8, mainly focus on the deferred 5GC-MT-LR
Procedure for Periodic, Triggered and UE Available Location Events procedure
and the location service continuity for UE moves between NG-RAN nodes.
### 6.30.2 Functional description
The procedures in clause 6.30.3.1\~6.30.3.3 are used for the location service
continuity for UE moves between NG-RAN nodes, under the following mobility
cases:
\- Moving in RRC-inactive for UL and DL positioning: with anchor NG-RAN
relocation, target NG-RAN acquire the positioning related information via the
retrieve UE context message, target NG-RAN update the positioning related
configuration and sends the latest configuration to LMF. AMF or old LMF
determines whether need trigger the LMF change procedure and enable the latest
configuration reach to the correct LMF. After handover complete, AMF notify
LMF the target cell ID and/or the target NG-RAN ID, based on that information,
LMF configures the selected neighbour NG-RANs with the latest configuration.
\- Moving in CM-connected with RRC-connected for UL and DL positioning: during
the handover preparation phase, source NG-RAN sends the positioning related
information to target NG-RAN via the handover message, target NG-RAN updates
the positioning related configuration and sends the latest configuration to
LMF. AMF or old LMF determine whether need trigger the LMF change procedure
and enable the latest configuration reach to the correct LMF. AMF notify LMF
the target cell ID and/or the target NG-RAN ID, based on that information, LMF
configures the selected neighbour NG-RANs with the latest configuration.
NOTE: RAN WG coordination is needed.
\- Moving in CM-IDLE: during the registration procedure, after new AMF receive
the UE context information from old AMF, if AMF finds UE has positioning
related information, AMF sends the new AMF instance ID to LMF via the next
periodical N1messageNotify.
### 6.30.3 Procedures
#### 6.30.3.1 Location Service Continuity for UE moves in RRC-inactive
Figure 6.30.3.1-1: Location Service Continuity for UE moves in RRC-inactive
1\. Deferred 5GC-MT-LR for periodic, triggered and UE available location
events procedure, as defined in steps 1\~21 in clause 6.3.1 of TS 23.273 [5].
2\~4. UE in RRC-inactive sate and finds event is triggered, UE sends the RRC
Resume to target NG-RAN.
5\. With anchor NG-RAN relocation, target NG-RAN acquire the old LMF ID and
the positioning related information (based on the RAN 17 conclusion, see
clause 9.2.1.13 and clause 9.2.3.168 of TS 38.423 [25]), target NG-RAN update
the positioning configuration (e.g. SRS configuration) based on the
positioning related information (e.g. the requested SRS Transmission
Characteristics).
6\. Target NG-RAN sends the N2 Path Switch Request to AMF, based on the UE
location information (i.e. the ULI in path switch request), either AMF or old
LMF can determine whether LMF need change (i.e. clause 6.4 of TS 23.273 [5]),
if AMF determine LMF change, steps 7\~15 are performed and steps 16\~23 are
skipped, after LMF change complete, the AMF need store the mapping
relationship between the source LMF ID and the new LMF ID. Otherwise, if old
LMF determine LMF change, steps 7\~15 are skipped and steps 16\~23 are
performed.
If AMF determine the LMF change (i.e. as described in TS 23.273, clause 6.4,
step 4\~7), the following steps 7\~15 are performed and steps 16\~23 are
skipped.
NOTE 1: No sequence restrict for step 7 and step 8, step 7 and step 8 may
perform in parallel.
8\~9. Target NG-RAN invokes the Uplink UE associated NRPPa transport message
to AMF, includes the routing ID (i.e. the old LMF ID), the NRPPa PDU (i.e. the
Positioning Information Update (includes the positioning configuration)).
10\. If AMF finds the LMF is changed, the AMF determine the source LMF ID
corresponding new LMF ID, then sends the NRPPa PDU to the new LMF.
11\. AMF invokes Namf_Communication_N2InfoNotify to new LMF, includes the
NRPPa PDU (e.g. the update positioning configuration), the NG-RAN node ID
and/or the target cell ID, the handover complete notification.
12\. The new LMF invokes the Namf_Communication_N1N2MessageTransfer to AMF,
includes the NRPPa PDU (e.g. the Positioning Information Activation), the LCS
correlation ID.
13\. After receive the Namf_Communication_N1N2MessageTransfer from new LMF,
the AMF invokes Downlink UE associated NRPPa transport message to target NG-
RAN, includes the new LMF ID, the indication to indicates a change of LMF.
14\. Based on the handover complete notification and the target cell ID and/or
the target NG-RAN node ID, the new LMF configure the selected neighbour NG-RAN
nodes with the latest positioning configuration.
NOTE 2: No sequence restrict for steps 12\~15 and step 14, steps 12\~15 and
step 14 may perform in parallel.
15\. The target NG-RAN update the LMF ID.
If old LMF determines the LMF change (i.e. as described in step 4\~7 in clause
6.4 of TS 23.273 [5]), the following steps 16\~23 are performed and steps
7\~15 are skipped.
17\. Target NG-RAN invokes the Uplink UE associated NRPPa transport message to
AMF, includes the routing ID (i.e. the old LMF ID), the NRPPa PDU (i.e. the
Positioning Information Update (includes the positioning configuration)).
18\. The AMF invokes Namf_Communication_N2InfoNotify to new LMF, includes the
NRPPa PDU (e.g. the update positioning configuration), the NG-RAN node ID
and/or the target cell ID, the handover complete notification.
20\. The new LMF invokes the Namf_Communication_N1N2MessageTransfer from new
LMF, includes the new LMF ID, the indication to indicate a change of LMF.
21\. The AMF invokes Downlink UE associated NRPPa transport message to target
NG-RAN, includes the new LMF ID, the indication to indicates a change of
LMF.22. Based on the handover complete notification and the target cell ID
and/or the target NG-RAN node ID, the new LMF configure the selected neighbour
NG-RAN nodes with the latest positioning configuration.
23\. The target NG-RAN update the LMF ID.
NOTE 3: No sequence restrict for step 22 and steps 20\~23, step 22 and steps
2-\~23 may perform in parallel.
#### 6.30.3.2 Location Service Continuity for UE moves in CM-connected with
RRC-connected
##### 6.30.3.2.1 Xn handover
Figure 6.30.3.2.1-1: Location Service Continuity for UE moves in CM-connected
with RRC-connected-Xn handover
1\. Deferred 5GC-MT-LR for periodic, triggered and UE available location
events procedure, as defined in steps 1\~21 in clause 6.3.1 of TS 23.273 [5].
2\~4. Target NG-RAN acquire the old LMF ID and the positioning related
information (e.g. via the handover request message), target NG-RAN update the
positioning configuration based on the positioning related information and
sends the update positioning configuration to UE.5. Target NG-RAN sends the N2
Path Switch Request to AMF, based on clause 6.4 of TS 23.273 [5], either AMF
or old LMF can determine whether LMF need change, if AMF determine LMF change,
steps 6\~14 are performed and steps 15\~19 are skipped, if old LMF determine
LMF change, steps 6\~14 are skipped and steps 15\~19 are performed.
6\~14. Same as steps 7\~19 as described in clause 6.30.3.1.
15\~19. Same as steps 16\~23 as described in clause 6.30.3.1.
##### 6.30.3.2.2 N2 handover
Figure 6.30.3.2.2-2: Location Service Continuity for UE moves in CM-connected
with RRC connected-N2 handover
1\. Deferred 5GC-MT-LR for periodic, triggered and UE available location
events procedure, as defined in steps 1\~21 in clause 6.3.1 of TS 23.273 [5].
2\~4. Target NG-RAN acquire the old LMF ID and the positioning related
information (e.g. via the handover required and handover request message),
target NG-RAN update the positioning configuration based on the positioning
related information and sends the update positioning configuration to UE.5.
Target NG-RAN sends the Handover Notify to AMF, based on clause 6.4 of TS
23.273 [5], either AMF or old LMF can determine whether LMF need change, if
AMF determine LMF change, steps 6\~14 are performed and steps 15\~19 are
skipped, if old LMF determine LMF change, steps 6\~14 are skipped and steps
15\~19 are performed.
NOTE The AMF in figure 6.30.3.2.2-2 can be referred to the T-AMF, i.e. T-AMF
determines whether the LMF need change based on the ULI (i.e. the target cell
ID) included in handover notify message.
6\~13. Same as steps 7\~15 as described in clause 6.30.3.1.
14\~17. Same as steps 16\~23 as described in clause 6.30.3.1.
#### 6.30.3.3 Location Service Continuity for UE moves in CM-IDLE
Figure 6.30.3.3-1: Location Service Continuity for UE moves in CM-IDLE
1\. Deferred 5GC-MT-LR for periodic, triggered and UE available location
events procedure, as defined in steps 1\~21 in clause 6.3.1 of TS 23.273 [5].
2\. Periodic event triggered, UE sends the event report to 5GC, as described
in steps 22\~30 in clause 6.3.1 of TS 23.273 [5].
3\. Before next time periodic event triggered, UE may go to CM-IDLE state.
4\~8. As UE moving, registration procedure may performed, as defined in steps
1\~5 in clause 4.2.2.2.2 of TS 23.502 [3].
9\. After retrieve the UE context information, if AMF finds UE has positioning
related information (i.e. if AMF has stored the periodic/deferred location
service context), AMF sends the new AMF instance ID to LMF, e.g. via the next
periodical N1messageNotify in step 12.
10\~11. Same as steps 22\~25 as defined in clause 6.3.1 of TS 23.273 [5].
12\. AMF sends the Namf_N1MessageNotify to LMF, includes the new AMF instance
ID, based on the received message, the LMF update the location context, i.e.
substitute the old AMF instance ID to the new AMF instance ID.
13\. Same as steps 26\~30 in clause 6.3.1 of TS 23.273 [5].
### 6.30.4 Impacts on services, entities, and interfaces
NG-RAN:
\- exchange the positioning related information and positioning related
configuration during the handover preparation phase.
\- After positioning configuration update, trigger to sends the latest
positioning configuration to LMF.
LMF:
\- After receive the positioning configuration and the target cell ID/target
NG-RAN node ID, select and configure the candidate neighbour NG-RAN with the
latest positioning configuration.
\- If LMF determine the LMF change, the new LMF invokes the
Namf_Communication_N1N2MessageTransfer to AMF, includes the new LMF ID, the
indication to indicate a change of LMF.
AMF:
\- After receive the Uplink UE associated NRPPa transport, if UE has
positioning related information and if AMF is changed, indicates the new AMF
instance ID to LMF.- After retrieve the UE context information, if UE has
positioning related information and if LMF is changed, map the source LMF ID
to the new LMF ID and sends the NRPPa PDU to the new LMF.
\- After handover complete, notify LMF the target cell ID and/or the target
NG-RAN node ID.
\- After receive downlink UE associated NRPPa transport, notify the new LMF ID
and the LMF change indication to NG-RAN.
## 6.31 Solution #31: location service continuity between EPS and 5GS (bi-
direction)
### 6.31.1 Introduction
This solution addresses Key Issue #8, mainly focus on the location service
continuity between EPS and 5GS (bi-direction).
### 6.31.2 Functional description
This solution include following procedures:
\- Location service continuity from 5GS to EPS:
During periodic location service triggered, if AMF/LMF finds the UE reporting
type includes \"EUTRAN\" and if the required \"LCS QoS class\" is \"multiple
QoS class\", the AMF/LMF determines the corresponding location QoS can be
applicable to EPS, e.g. AMF or LMF map the QoS class to \"Best Effort\" and
choose the most stringent value from the \"LocationQoS\" as the QoS
requirement, LMF sends these parameters to UE and AMF if AMF does not
determine the location QoS applicable to EPS.
After receive the handover required, if AMF finds UE can support interworking
between 5GS and EPS, AMF sends the 5GS location QoS corresponding EPS location
QoS to GMLC.
After handover complete, if UE finds periodical event is triggered and if UE
finds it has moved to EPS, the UE sends LCS MO-LR Invoke message, carry the
location QoS can be applicable to EPS.
\- Location service continuity from EPS to 5GS:
After receive the handover required message, if MME finds UE has positioning
related information, MME trigger to send the handover to 5GC notification to
GMLC.
After handover complete, if UE finds periodical event is triggered and if UE
finds it has moved to 5GS, UE sends event report message to 5GS.
NOTE 1: If UE finds handover is not complete but the event is triggered, UE
need wait handover complete to sends the event report message in 5GS or sends
the LCS MO-LR Invoke message in EPS.
NOTE 2: The procedures can be applied to all types of Location service. For
deferred/periodic MT-LR, the core network also need coordinate with UE to
enable UE sends the suitable signalling message and carry the suitable
location QoS after the location event is triggered.
### 6.31.3 Architecture Assumption
It is assumed to use the co-located GMLC.
Figure 6.31.3-1: Architecture Assumption
### 6.31.4 Procedures
#### 6.31.4.1 Location Service Continuity from 5GS to EPS
Figure 6.31.4.1-1: Location Service Continuity from 5GS to EPS
1\. Steps 1-15 defined in clause 6.3.1 of TS 23.273 [5] with the following
additions: after receive Namf_Location_ProvidePositioningInfo Request, if AMF
determine the access type supported by UE for event reporting includes
\"EUTRAN\" and if the required LCS QoS class in location QoS is \"multiple QoS
class\", the AMF determines its corresponding location QoS can be applicable
to EPS, i.e. determine two set of location QoS, one used for 5GS and its
corresponding used for EPS (i.e. the location QoS applicable to EPS). If AMF
determines the 5GS corresponding location QoS applicable to EPS, AMF notifies
that information to LMF via Nlmf_Location_DetermineLocation Request message.
Otherwise, if AMF does not do that processing, the LMF could perform that
processing as described in step 2.
2\. After receive Nlmf_Location_DetermineLocation Request, if LMF determines
the access type supported by UE for event reporting includes \"EUTRAN\" , e.g.
the reporting type includes \"EUTRAN\" and if the required LCS QoS class in
location QoS is \"multiple QoS class\", the LMF determines its corresponding
location QoS can be applicable to EPS, i.e. determine two set of location QoS,
one used for 5GS and its corresponding used for EPS (i.e. the location QoS
applicable to EPS). For example, choose the most stringent values from the
\"LocationQoS\" and set the \"LcsQoSClass\" in \"LocationQoS\" as the \"Best
Effort\" (since the \"LCS QoS class\" is defined as an enumerate data type and
MME only understand the enumerated value {\"assured\" and \"best effort\"}, it
does not understand the enumerated value \"multiple qos\").
NOTE 1: Either AMF or LMF could determine the location QoS applicable to EPS
if the UE reporting type includes \"EUTRAN\" and if the required \"LCS QoS
class\" is \"multiple QoS class\".
3-4. LMF sends the LCS Periodical-Triggered Invoke Request, includes the
location QoS used for 5GS and the its corresponding location QoS used for EPS.
UE response to LMF with the LCS Periodical-Triggered Invoke Return Result
5\. LMF sends the Nlmf_Location_DermineLocation Response to AMF, if AMF does
not determine the 5GS location QoS corresponding location QoS applicable to
EPS, i.e. AMF does not perform the processing as illustrated in step 1, the
LMF includes the location QoS used for 5GS and the its corresponding location
QoS used for EPS to AMF. After receive that information, the AMF should keep
the positioning related information and do not release.
6\~9. After AMF receives the handover required message, if AMF finds UE can
support interworking between 5GS and EPS, e.g. AMF can determine whether UE
can be interworking between 5GS and EPS based on whether receive the location
QoS used for 5GS and the its corresponding location QoS used for EPS from LMF
or based on the UE subscription information or based on whether the UE
reporting type includes \"EUTRAN\", AMF sends the Namf_LocationEventNotify to
GMLC, includes the MME ID/address, the handover to EPS notification, location
QoS used in 5GS and its corresponding location QoS applicable to EPS.
Alternatively, AMF can perform step 8 and step 9 after receive Relocation
response message (i.e. step 9 in clause 4.11.1.2.1 of TS 23.502 [3]) or
Relocation Complete Notification message (i.e. step 12c in clause 4.11.1.2.1
of TS 23.502 [3]) from MME.
NOTE 2: No step sequence restrict between step 9 and steps 10\~14, step 9 and
steps 10\~14 can be performed in parallel.
10-14: 5GS to EPS handover.
15\. If UE finds periodical event triggered and if the UE has moved to EPS,
the UE sends LCS MO-LR Invoke message, carry the location QoS can be
applicable to EPS. The UE can determine whether it has moved to EPS based on
the message received from target access network during handover, e.g. based on
the \"target RAT=eutran\" included in message\"MobilityFromNRCommand\" or can
based on the RRC message type, e.g. for NR-NR handover, UE will receive the
RRCReconfiguration from target NG-RAN, for EUTRAN-EUTRAN handover, UE will
receive the RRCConnectionreconfiguration from target EUTRAN, for NG-RAN to
EUTRAN handover, UE will receive the MobilityFromNRCommand from target EUTRAN.
NOTE 3: If UE finds handover is not complete but the event is triggered, i.e.
step 16 happens before step 13, the UE need wait handover complete to send the
triggered LCS MO-LR Invoke message.
Then, as UE moving, UE may moves from EPS back to 5GS, in that case, if UE
finds periodical event triggered and if the UE has moved to 5GS, the UE sends
Event Report message, carry the location QoS can be applicable to 5GS. Also,
the MME need notify GMLC the handover to 5GS notification.
#### 6.31.4.2 Location Service Continuity from EPS to 5GS
Figure 6.31.4.2-1: Location Service Continuity from EPS to 5GS
Since all the \"LCS QoS class\" in \"location QoS\" supported by EPS can also
supported by 5GS, there is no need do the location QoS class mapping
processing as described in clause 6.31.4.1.
3-4. After MME receives the handover required message, if MME finds UE has
positioning related information, MME trigger to send Subscriber Location
Report to GMLC, includes the AMF ID/address, the LDR Reference number, the
handover to 5GS notification. Alternatively, MME can perform step 3 and step 4
after receive Forward Relocation Response message (i.e. step 14 in clause
4.11.1.2.2.2 of TS 23.502 [3]) or Forward Relocation Complete Notification
(i.e. step 5 in clause 4.11.1.2.2.3 of TS 23.502 [3]) message from AMF.
10\. If UE finds periodical event triggered and if the UE has moved to 5GS,
the UE sends event report message to 5GS. The UE can determine whether it has
moved to 5GS based on the message receive from target access network during
handover, e.g. based on the RRC message type, e.g. for NR-NR handover, UE will
receive the RRCReconfiguration from target NG-RAN, for EUTRAN-EUTRAN handover,
UE will receive the RRCConnectionreconfiguration from target EUTRAN, for NG-
RAN to EUTRAN handover, UE will receive the MobilityFromNRCommand from target
EUTRAN.
NOTE 1: If UE finds handover is not complete but the event is triggered, i.e.
step 10 happens before step 8, the UE need wait handover complete to send the
triggered Event Report message.
NOTE 2: No step sequence restrict between step 4 and steps 5\~9, step 4 and
steps 5\~9 can be performed in parallel.
Then, as UE moving, UE may moves from 5GS back to EPS, in that case, if UE
finds periodical event triggered and if the UE has moved to EPS, the UE sends
the LCS MO-LR Invoke message, carry the location QoS can be applicable to EPS.
Also, the AMF need notify GMLC the handover to EPS notification.
### 6.31.5 Impacts on services, entities, and interfaces
UE:
\- After periodic event triggered, support differentiate whether move to EPS
or 5GS and determine the suitable messages and location QoS sends to 5GS/EPS.
LMF:
\- Support aware whether UE can support the interworking between 5GS and EPS.
\- Support determine the 5GS location QoS corresponding location QoS can be
applicable to EPS, and send this information to UE and AMF.
AMF:
\- Support determine the 5GS location QoS corresponding location QoS can be
applicable to EPS, and send this information to LMF.
\- After receive handover required, instigate Namf_LocationEventNotify to GMLC
to notify the handover and the 5GS location QoS corresponding location QoS can
be applicable to EPS if UE can support interworking between 5GS and EPS.
MME:
\- After receive handover required, instigate the Subscriber Location Report
to GMLC to notify the handover if UE can support interworking between EPS and
5GS.
## 6.32 Solution #32: LCS continuity Support for N26 based Handover
### 6.32.1 Introduction
This solution addresses KI#8: support of location service continuity in case
of UE mobility.
### 6.32.2 Functional Description
The interworking between 5GS and EPS with N26 interface is specified in clause
5.17.2.2 of TS 23.501 [2], and the handover procedure via is specified in
clause 4.11.1.2 of TS 23.502 [3]. During that handover procedure, location
request from LCS Client may arrive at 5GC or EPS core network entities, e.g.
AMF or MME. Or after core network entities received Location Request from GMLC
and before actual positioning procedure finish, the handover required message
maybe received from RAN.
Since those handover procedure is on-going, continue performing positioning
procedure within the source RAN may have problems, e.g. such positioning
procedure may not able be finished due to UE moved to target side; the
positioning result from the source side may not be accurate due to UE
mobility. In such handover and location service simultaneously on-going
scenarios, forwarding arrived location request to target side and trigger
actual positioning procedure at target side has benefits over simply reject
the location request. The benefits including that network can provide UE
location timely and accurately.
### 6.32.3 Procedures
#### 6.32.3.1 LCS support during Handover from 5GS to EPS
Within below figure 6.32.3.1-1, the MT-LR location request arrives at AMF
(e.g. Step 4 of clause 6.1.1 of TS 23.273 [5], Namf_Location_Provide Request
from V-GMLC), and this would trigger the positioning procedure. When such MT-
LR procedure is still on-going, the NG-RAN may decides that a Handover is
required.
Figure 6.32.3.1-1: LCS support during handover from 5GS to EPS
Step A-1: During the 5GC-MT-LR procedure, e.g. in clause 6.1.1 of TS 23.273
[5], step 4, the AMF received Namf_Location_ProvidePositioningInfo request
from V-GMLC, which includes the SUPI, and client type and may include the
required QoS parameters. The LMF is then contacted to perform one or more of
the positioning procedures described in clause 6.11.1 and 6.11.2 of TS 23.273
[5].
Step A-2. Take the clause 6.1.1 of TS 23.273 [5] as an example, the step 1 of
this procedure is triggered. The LMF invokes the
Namf_Communication_N1N2MessageTransfer service operation towards the AMF.
Step B: Before the complete of procedure triggered in StepA-2, or before Step
A-2 but after Step A-1, the NG-RAN may decide to initiate the Handover. The
AMF receives the Handover Required from NG-RAN as defined in clause 4.11.1.2.1
of TS 23.502 [3], step 1.
Step C-1: Replace the step 10 in 6.1.1 of TS 23.273 [5], the AMF returns the
Namf_Location_ProvidePositioningInfo Response towards the V-GMLC, to indicate
that there is a Handover.
Step C-2: The AMF invokes the Namf_Communication_N1MessageNotify service
operation towards the LMF, to indicate that there is a Handover, and the abort
of positioning procedure.
Step D: The AMF needs to indicate the MME to preform Location Procedure in EPS
and return the result, via N26 interface. The AMF may map the
Namf_Location_ProvidePositioningInfo request message received to the message
Provide Subscriber Location message, and send this message to MME by
piggybacking in the Relocation Required, which is step 3 of procedure in
4.11.1.2.1 of TS 23.502 [3]. The MME assumes such Provide Subscriber Location
is come from a GMLC, and triggers the Step F-1. At the same time, the handover
procedure continues, as defined in 4.11.1.2.1 of TS 23.502 [3].
Step E-1: The MME send Location request to E-SMLC, as defined in clause 9.1.15
of TS 23.271 [4].
Step F-1: The E-SMLC performs the step 7 of clause 9.1.15 of TS 23.271 [4].
Step G-1: The E-SMLC performs the step 8 of clause 9.1.15 of TS 23.271 [4]. In
this step, the MME receives the Location Response message from E-SMLC. That
means the positioning result is from the target side.
Step H: The positioning result is return to AMF via N26 interface. The context
request/response pair message could to re-use with some modification, or
defines new messages for this purpose.
Step J: Like the step 10 in clause 6.1.1 of TS 23.273 [5], the AMF returns the
Namf_Location_ProvideLocation Response towards the V-GMLC, to return the UE
location to V-GMLC.
#### 6.32.3.2 LCS support during Handover from EPS to 5GS
Within below figure 6.22.3.2-1, the MT-LR location request (e.g. Provide
Subscriber Location Request sent by VGMLC in step 2 of clause 9.1.15 of TS
23.271 [4]) arrives at MME, and this would trigger the positioning procedure.
When such MT-LR procedure is still on-going, the NG-RAN decides that a
Handover is required.
Figure 6.32.3.2-1: LCS support during handover from EPS to 5GS
Step A: During the EPS-MT-LR procedure, e.g. procedure in 9.1.15 of TS 23.271
[4], step 2, GMLC sends a Provide Subscriber Location message to the MME. This
message carries the type of location information requested (e.g. current
location and optionally, velocity), the UE subscriber\'s IMSI, LCS QoS
information (e.g. accuracy, response time) and an indication of whether the
LCS client has the override capability. The procedure may continue and step 6
of 9.1.15 of TS 23.271 [4] happens.
Step B: Before the complete of procedure triggered in Step A, the E-UTRAN may
decide to initiate the Handover. The MME receives the Handover Required from
NG-RAN as defined in clause 4.11.1.2.2.2 of TS 23.502 [3], step 2.
Step C-1: In such case, since the Handover is going to happen, continuing
positioning at EPS side become useless, so the MME may send Location Abort to
E-SMLC.
Step C-2: The MME may also send Subscriber Location Report to V-GMLC, to
indicate that there is a Handover imminent.
Step D: The MME needs to indicate the AMF to preform Location Procedure in 5GS
and return the result, via N26 interface. The MME send the Provide Subscriber
Location message to AMF, by piggybacking it in the Forward Relocation Request
message, which is step 3 of procedure in 4.11.1.2.2.2 of TS 23.502 [3].
After receive this message, the AMF needs map the Provide Subscriber Location
message to Namf_Location_ProvideLocation request message, and the MME assumes
such Namf_Location_ProvideLocation is come from a V-GMLC, and triggers the
Step E. At the same time, the handover procedure continues, as defined in
4.11.1.2.2 of TS 23.502 [3].
Step E: As step 6 in clause 6.1.1 of TS 23.273 [5], the AMF selects an LMF
based on NRF query or configuration in AMF and invokes the
Nlmf_Location_DetermineLocation service operation towards the LMF to request
the current location of the UE.
Step F-1: As step 8 in clause 6.1.1 of TS 23.273 [5], the LMF performs one or
more of the positioning procedures described in clause 6.11.1, 6.11.2 of TS
23.273 [5]. This step F-1 shows that clause 6.1.1 as an example.
Step F-2: As step 9 in clause 6.1.1 of TS 23.273 [5], the LMF returns the
Nlmf_Location_DetermineLocation Response towards the AMF to return the current
location of the UE.
Step G: The positioning result is return to MME via N26 interface. The context
request/response pair message could to re-use with some modification, or
defines new messages for this purpose.
Step H: Like the step 9a in in 9.1.15 of TS 23.271 [4], the MME send a
Subscriber Location Report to the V-GMLC.
### 6.32.4 Impacts on services, entities, and interfaces
Impacted entities:
\- AMF: forward LCS related message to MME, and receive such message from MME,
to trigger positioning procedure; to forward positioning result to MME;
mapping the Provide Subscriber Location message to and from the
Namf_Location_ProvideLocation request message.
\- MME: forward LCS related message to AMF, and receive such message from MME,
to trigger positioning procedure; to forward positioning result to AMF.
Impacted interfaces:
\- N26, forwarding LCS related messages between AMF and MME.
## 6.33 Solution #33: Support of LCS mobility when UE moves between 5GS and
EPS
### 6.33.1 Introduction
This solution addresses the KI \"Key Issue #8: support of location service
continuity in case of UE mobility\".
Continuity of certain basic services like a PDU session during mobility is
defined currently. However, the handling of an LCS session during mobility
procedures is not specified. In particular, there is no specification on
whether an ongoing LCS session shall be terminated or continued with after the
mobility and if continued, how the continuity shall work. There can be many
effects due to this missing part:
\- LCS sessions may be terminated at mobility with the LCS Client having to
re-initiate the session after the procedure.
\- The LMF may not be aware of the mobility at all, leading to inaccurate
positioning estimates.
\- Since there are no clear specifications, inter-vendor tests could fail.
\- LCS sessions could be enabled as part of other critical services (like
emergency calls) - those services could be impacted due to the current
specifications - leading to regulatory issues.
All of the above issues could be prevented if there is a clear specification
on how LCS sessions are to be handled in different mobility procedures and in
particular, if continuity can be guaranteed by the network.
The main considerations in the solution are:
\- Keep the changes minimal in EPC so that legacy functionality requires only
a small incremental change
\- Not needing a standardized interface between the EPC-GMLC and 5GC-GMLC.
According to clause 4.2a of TS 23.273 [5], this interface, denoted as Lr\' is
not standardized and in case EPC-GMLC and 5GC-GMLC are co-located, Lr\' is not
needed altogether. This solution doesn\'t require the standardization of this
interface.
\- provide a common procedure for all types of Location Request (MO-LR/MT-LR
with/without deferred location).
\- provide a simple solution that works regardless of the current status of
the on-going location procedure when the mobility event occurs.
### 6.33.2 Functional Description
This proposal provides solutions for mobility between 5GS and EPS.
### 6.33.3 Procedure
Figure 6.33.3-1 : LCS Continuity Solution for 5GS to EPS Mobility
Description:
Steps 1-4 describe the normal MT-LR LCS session on 5GS (similar to steps 1.a.
to 12 in Figure 6.1.2-1 in TS 23.273 [5].
Steps 5-14 describe the normal 5GS to EPS HO procedure (similar to steps 1 to
12.b in Figure 4.11.1.2.1-1 in TS 23.502 [3].
The AMF could initiate steps 15 and 17 in parallel to step 11 when it receives
the Relocation Response (step 10).
NOTE 1: Steps 15/16 is meant to be completed before the UE is handed over to
LTE. If it is determined to be too close to the HO procedure, then the
normative phase could choose to trigger step 15 in parallel with step 7.
Steps 15-16: The LCS Session on 5GS is cancelled.
Step 17: The AMF indicates failure to the 5GC-GMLC with reason \"HO to EPC\"
and including the target MME ID.
Step 18: The 5GC-GMLC forwards the location request to the EPC-GMLC including
all the parameters of the LCS Request and the target MME ID.
Steps 19-24: The LCS Session is started on EPS (similar to steps 1-10 in
Figure 9.18 in TS 23.271 [4]).
Steps 25-26: The UE location estimate is returned by the EPC-GMLC to the 5GC-
GMLC which then forwards the same to the LCS Client.
NOTE 2: As can be observed, the entire procedure is done in a way where the
LCS Client is not aware of the mobility handling and the LCS session
continuity is ensured.
NOTE 3: There could be a mapping of LCS QoS (from the values defined for 5GS
to values defined in 4GS) - this could be done by the GMLC.
\- For QoS attributes that are common between 5GS and EPS, the original LCS
QoS defined values can be used as is in EPS.
\- For QoS attributes that are specific to 5GS -> the QoS mapping could be
done to the most stringent QoS value with best effort handling in QoS Class.
If an LCS session was active over user plane in 5GS when the HO is triggered,
the AMF/LMF share assistance data to the UE that minimizes the TLS handshake
workload according to clause 6.1.1.4 of OMA-TS-ULP-V2_0_6 [14] specification,
once the UE moves to EPS.
Figure 6.33.3-2: LCS Continuity Solution for EPS to 5GS Mobility
Description:
Steps 1-4 describe the normal MT-LR LCS session on EPS (similar to steps 1 to
3 in Figure 6.1.2-1 in TS 23.271 [4].
Steps 5-14 describe the normal EPS to 5GS HO procedure (similar to steps 1 to
16 in Figure 4.11.1.2.2.2-1 and steps 1-4 in Figure 4.11.1.2.2.3-1 in TS
23.502 [3]).
The MME could initiate steps 15 and 17 in parallel to step 11 when it receives
the Forward Relocation Response (step 10).
Steps 15-16: The LCS Session on EPS is cancelled.
Step 17: The MME indicates failure to the EPC-GMLC with reason \"HO to EPC\"
and including the target AMF ID.
Step 18: The EPC-GMLC forwards the location request to the 5GC-GMLC including
all the parameters of the LCS Request and the target AMF ID.
Steps 19-24: The LCS Session is started on 5GS (similar to steps 1-23 in
Figure 6.1.2-1 in TS 23.273 [5]).
Steps 25-26: The UE location estimate is returned by the 5GC-GMLC to the EPC-
GMLC which then forwards the same to the LCS Client.
NOTE 1: As can be observed, both the procedures are defined in a way to keep
the LCS Client unaware of the mobility signalling and the LCS session
continuity is ensured.
NOTE 2: There could be a mapping of LCS QoS (from the values defined for 5GS
to values defined in 4GS or vice versa) - this could be done by the GMLC.
\- For QoS attributes that are common between 5GS and EPS, the original LCS
QoS defined values can be used as is in 5GS.
\- For QoS attributes that are specific to EPS -> the QoS mapping could be
done to the most stringent QoS value with best effort handling in QoS Class.
\- If the LMF is configured to use LCS over user plane in 5GS, then LMF will
choose to initiate the LCS session over user plane at step 24.
### 6.33.4 Impacts on services, entities, and interfaces
Table 6.33.4-1: Impacts on services, entities and interfaces
+-------------+-------------+-------------+-------------+-------------+ | | GMLC | AMF | MME | LMF/e | | | | | | SMLC/RAN/UE | +=============+=============+=============+=============+=============+ | 5GS -> EPS | Transfer of | Provide the | | None | | Mobility | LCS context | target MME | | | | | from 5GS to | ID to GMLC | | | | | EPS | as part of | | | | | | Na | | | | | Mapping of | mf_Locatio | | | | | LCS QoS | n_Response | | | | | from 5GS to | | | | | | EPS | Trigger the | | | | | | sending of | | | | | Initiating | LCS UP | | | | | LCS session | server | | | | | on EPS on | assistance | | | | | target MME | data to the | | | | | given by | UE as part | | | | | AMF | of the HO | | | | | | procedure | | | +-------------+-------------+-------------+-------------+-------------+ | EPS -> 5GS | Transfer of | | Provide | None | | Mobility | LCS context | | the target | | | | from EPS to | | AMF ID to | | | | 5GS | | GMLC as | | | | | | part of | | | | Mapping of | | Locatio | | | | LCS QoS | | n_Response | | | | from EPS to | | | | | | 5GS | | | | +-------------+-------------+-------------+-------------+-------------+
## 6.34 Solution #34: UE location determination for Mobility Restriction
enforcement
### 6.34.1 Introduction
Using UE-generated location information (e.g. GNSS/A-GNSS) to determine the
TAI where the UE is geographically located can be accurate but may be
unreliable as has been evaluated by SA WG3.
To perform precise Mobility Restriction enforcement, this solution propose to
use NI-LR procedure to determine the TAI where the UE is geographically
located, when NG-RAN reports multiple TAIs to AMF and any but not all of them
are Forbidden Area or Non-allowed area.
### 6.34.2 Functional Description
This solution proposes to utilize NI-LR procedure to determine the TAI where
the UE (with satellite access) is geographically located, NG-RAN reports
multiple TAIs to AMF (not indicating the TAI in which the UE is located) and
any but not all of the reported TAIs are Forbidden Area or Non-allowed area.
### 6.34.3 Procedure
Figure 6.34.2-1: NI-LR based UE location determination for Mobility
Restriction enforcement
1\. AMF receives a NGAP message containing User Location Information for a UE
using NR satellite access during a Mobility Management or Session Management
procedure. The ULI information contains multiple TAIs.
NOTE 1: In step 1, NG-RAN does not indicate the TAI in which the UE is located
as part of the ULI.
2\. AMF determines to initiate NI-LR procedure if any but not all of the
received TAIs in step 1 is Forbidden or Not-Allowed.
3\. AMF sends Nlmf_location_DetermineLocation request to LMF including a UE
TAI determination indication.
4\. Based on the indication of step 3, LMF may do not select UE standalone or
UE-based positioning mode for UE positioning, or also may restrict the usage
of UE-assisted method, which can ensure that network verification of UE
location is performed with a reliable method.
NOTE 2: The positioning method mode selection needs coordination with RAN TSG
WG and depends on RAN supported methods.
5\. LMF sends the UE location estimate to AMF via
Nlmf_location_DetermineLocation response.
6\. AMF maps the UE location into TAI and performs mobility restriction based
on clause 5.3.4.1 of TS 23.501 [2].
NOTE 3: AMF is configured with TAI geographic information.
### 6.34.4 Impacts on services, entities, and interfaces
AMF:
\- Triggers NI-LR procedure when NG-RAN reports multiple TAIs (not indicating
the TAI in which the UE is located) and any but not all of the reported TAIs
are Forbidden Area or Non-allowed area) and any but not all of them are
Forbidden Area or Non-allowed area.
\- Indicates to LMF in the NI-LR request that the request is for UE TAI
determination.
\- AMF is configured with TAI geographic information.
LMF:
\- May select a reliable positioning method supported by RAN based on the UE
TAI determination indication.
\- RAN:NTN-based NG-RAN needs to support reliable positioning methods.
## 6.35 Solution #35: Support reporting the UE location only when the UE
locates the target area defined with the finer granularity
### 6.35.1 Introduction
This solution addresses KI#4: Interaction between Location Service and NWDAF,
and KI#11: Enhance the Triggered Location for UE power saving purposes.
With the requirements from the NWDAF or some power saving requirements, the
LCS architecture is required to report the UE location only when the UE
locates in the exact target area to accomplish the power-saving purpose or
signalling reduction purpose.
This solution addresses the following two points on the LCS side:
1) delivers the detailed target area information from LCS service demander
including NWDAF to the UE;
2) enables the UE to trigger the area event reporting only when the UE locates
in the exact target area or enables the LMF to judge whether the UE location
is in the target area or not, which is defined with the finer granularity.
### 6.35.2 Functional Description
This solution proposes that the LCS architecture delivers the detail of the
target geographical area to the UE including the shape of the target area, the
coordinates of latitude and longitude, area accuracy and other information.
The area accuracy is used to allow the LCS architecture to report the UE
location within the tolerant granularity. Besides, two approaches (i.e.
decided by UE and decided by NF) are proposed to address how to report the UE
location only when the UE locates the target area defined with the finer
granularity:
\- **Approach A: Decided by UE.** The UE knows the exact target area with
finer granularity and triggers area event reporting when the UE can calculate
its location (e.g. RAT-independent positioning) and the UE locates in the
exact target area;
\- **Approach B: Decided by NF.** The NF (e.g. LMF) determines whether the UE
location is in the exact target area or not when the UE can not calculate its
exact location (e.g. UL positioning) or the NF (e.g. LMF) receives the request
from the UE side to help to make a judgment. Then the NF (e.g. LMF) makes the
judgment based on the UE location and the target area The judgment means the
NF (e.g. LMF) only counts and reports the valid UE location data to the NWDAF
or other LCS clients.
Besides, if the LCS service demander including NWDAF indicates explicitly in
the request that there is no need to implement the exact area event reporting,
the UE would handle the area event reporting as cell and TA granularity
although the target area is defined with the finer granularity.
### 6.35.3 Procedures
#### 6.35.3.1 NWDAF interacts with GMLC
Figure 6.3.1-1 in clause 6.3.1 of TS 23.273 [5] is reused with the following
enhancements:
Figure 6.35.3.1-1 (Figure 6.3.1-1): Deferred 5GC-MT-LR for periodic, triggered
and UE available location events
1\. For area event reporting, the LCS client (e.g. NWDAF) provides to the GMLC
the details of the target area and may include the requirement of area
reporting (e.g. reporting based on the cell or TA level as the Rel-17 does,
reporting only when the UE locates in the exact target area, multiple scheme
reporting). In this step, if the target area is defined with finer
granularity, the area accuracy may be included to allow the LCS architecture
to report the UE location within the tolerant granularity.
4&5\. The GMLC delivers the target area information received in step 1 to the
AMF. If the requirement of area report is indicated with reporting only when
the UE locates in the exact target area, the GMLC may not convert the target
area into the cell or TA lists and just notifies the target area to the UE.
14&16\. The AMF delivers the target area information received in step 1 to the
LMF and then the LMF notifies the UE in the LCS trigger invoke request
message.
22\. The UE detects the target area. If the UE obtains its exact location, the
UE compares the location with the target area. The UE triggers area event
reporting only when the UE locates in the exact target area. If the UE cannot
calculate its exact location, the UE may request the NF (e.g. LMF) to assist
in confirming and comparing the location with the target area.
25\. The UE triggers area event reporting. Optionally, the UE may send
temporary area event reporting to the LMF with an indication to request the
LMF to confirm and compare location when the UE cannot calculate its exact
location.
28\. The LMF sends the area event reporting. If the temporary area event
reporting is received in step 25, the LMF compares the location with the
target area. This procedure will be terminated and the reporting status will
not be updated if the UE doesn\'t locate in the exact target area.
#### 6.35.3.1 NWDAF interacts with AMF
The procedure mentioned (i.e. Figure 6.13.3.2-1) in sol#13 is reused with the
following step enhancements:
Figure 6.35.3.1-1 (Figure 6.13.3.2-1): AMF provides UE location information to
NWDAF (Continuous Collection)
3\. The NWDAF provides to the AMF the details of the target area and may
include the requirement of area reporting (e.g. reporting based on the cell or
TA level as the Rel-17 does, reporting only when the UE locates in the exact
target area, multiple scheme reporting). In this step, if the target area is
defined with finer granularity, the area accuracy may be included to allow the
LCS architecture to report the UE location within the tolerant granularity.
5&7\. The AMF delivers the target area information received in step 3 to the
LMF and then the LMF notifies the UE in the LCS trigger invoke request
message.
11\. The UE detects the target area. If the UE obtains its location, the UE
compares the location with the target area. The UE triggers area event
reporting only when the UE locates in the exact target area. If the UE cannot
calculate its exact location, the UE may request the NF (e.g. LMF) to assist
in confirming and comparing the location with the target area.
12\. The UE triggers area event reporting. Optionally, the UE may send
temporary area event reporting to the LMF with an indication to request the
LMF confirm and compare location when the UE cannot calculate its exact
location.
15\. The LMF sends the area event reporting. If the temporary area event
reporting is received in step 12, the LMF compares the location with the
target area. This procedure will be terminated and the reporting status will
not be updated if the UE doesn\'t locate in the exact target area.
### 6.35.4 Impacts on services, entities, and interfaces
GMLC/AMF/LMF:
\- Supports delivering the detailed target area information defined with finer
granularity to the UE.
LMF:
\- Determines whether the UE location is in the exact target area or not when
the UE can not calculate its exact location or receives the request from the
UE side to help to make a judgment.
\- Update the reporting status only when the UE location is in the exact
target area.
UE:
\- Supports triggering area event reporting only when the UE can calculate its
exact location and the UE locates in the exact target area defined with finer
granularity
# 7 Evaluation
## 7.1 Key Issue #1: Architectural Enhancement to support User Plane
positioning
The following solutions address KI#1.
\- Solution #1: Positioning protocol transport over User Plane.
\- Solution #2: Discovery of User Plane service Cooperated with 3GPP LCS
Features.
\- Solution #3: User plane location capability transfer and positioning via
user plane.
\- Solution #19: Support of Low Latency via User Plane.
KI#1 identifies the following benefit of user plane positioning:
\- It has a more efficient communication overload with a direct connection
from LCS server to UE.
\- It may not require gNodeB, AMF, LMF signalling processing of RRC, NG-AP and
HTTP/2 protocol stacks. A single session may handle all the transactions.
An additional benefits can be reduced latency which is covered by KI#10,
applicability in local service covered in KI#2, mobility support covered in
KI#8, power saving covered by KI#11 and KI#12.
Solutions need to be evaluated against these benefits.
**UE Impact**
As a \"_direct connection from LCS server to UE_ \", UE impact is of first
priority. In R16 and R17, UE compliant with TS 38.305 [6] and related
specifications has already specified user plane support.
As the considerations in KI#1 \"_emergency/non-emergency, other regulatory
cases like lawful interception_ \", whether legacy Rel-16/Rel-17 compatible UE
can directly use the user plane service in this study is important for
emergency and/or regulatory use cases.
Solution#1 introduced a new protocol which requires UE with a new
communication method. Solution#2 takes SUPL compliance with same reference as
TS 38.305 [6]. Solution#3 supports \'secure user plane\' and it depends on NAS
to activate the user plane connection from UE; The detailed protocol between
UE and LMF in solution#19 and solution#3 is unknown whether it is a new
protocol to be defined from scratch or reusing SUPL.
In summary:
Table 7.1-1: Comparison of solutions on UE Impact
R16/R17 UE Impact Solution#1 Solution#2 Solution#3 Solution#19
* * *
Mandatory Change Yes No TBD TBD Optional Enhancement Yes Yes Yes TBD
NOTE 1: The main optional enhancement update to UE includes the
DL_NAS_TRANSPORT or extension to LPP. These enhancements are needed in
solution#1 and solution#3, optional to solution#2.
**Delay Analysis**
The protocol of solution#1 doesn\'t have details for analysis. There are no
enough details for comparison between \'lightweight\' protocol in solution#1,
OMA ULP in solution#2, \'secure user plane\' in solution#3 and \"User Plane
Transfer of Event Reports\" in solution#19. Although solution#19 improves
legacy supplementary service, but it has two segments of secure connection.
So, latency analysis doesn\'t have comparable result.
**Mobility Support**
\"_mobility support covered in KI#8_ \" has both EPS to 5GS mobility and
inter-RAN node mobility.
Since data channel should not have impact when UE moves from one RAN node to
another, the analysis focuses on EPS and 5GS mobility.
In EPS, user plane is specified in TS 23.271 [4] as same SUPL reference to TS
38.305 [6]. The mobility switches over with different cases as following
summary:
Since solution#19 doesn\'t cover handover or mobility contents, the EPS/5GS
mobility in this solution is TBD.
Table 7.1-2: Comparison of solutions on how to support EPS and 5GS mobility
EPS and 5GS mobility Solution#1 Solution#2 Solution#3 Solution#19
* * *
UE moves from EPS to 5GS SUPL->\'lightweight protocol\' SUPL->SUPL SUPL->TBD
SUPL->TBD UE moves from 5GS to EPS \'lightweight protocol\'->SUPL SUPL->SUPL
TBD->SUPL TBD->SUPL
**Local/Edge LCS Support**
\"_Applicability in local service covered in KI#2_ \" is taken as dependencies
in solution# 4 and solution#5.
It is also described in KI statements \"_deployed the edge data network....
and fits into the architecture in TS 23.548 [10]_ \". TS 23.548 [10] mainly
contains discovery and relocation features which maps to user plane function
discovery and UE mobility to Edge Hosting Environment.
Since solution#19 doesn\'t cover handover or mobility contents, the discovery
and DN mobility in this solution is TBD.
Table 7.1-3: Comparison of solutions on Edge/Local LCS Support
Edge/Local LCS Support Solution#1 Solution#2 Solution#3 Solution#19
* * *
User Plan Discovery Through enhancement of NAS Compliant with TS 23.548 [10]
Through enhancement of NAS TBD Mobility between different data networks *
Through enhancement of LMF switchover Compliant with TS 23.548 [10] Through
enhancement of LMF switchover TBD
NOTE 2: The UE mobility can cover the following cases:
1\. UE may move between central data network (C-DN) and local data network
(L-DN)).
2\. UE may move between different local data networks (L-DN).
**Other Aspects**
Among all solutions of KI#1, power saving is not addressed.
With Solution #1, a LCS-UP connection over a PDU session is established
between the UE and an LMF. During the registration procedure or the initiation
of an LCS procedure, AMF decides to select an LMF and request the UE and the
selected LMF to establish an LCS-UP connection. LMF sends its user plane
location address to UE via existing procedures, and a lightweight LPP transfer
protocol is to be introduced. User Plane connection establishment is initiated
by the UE and can be transferred to another LMF by the AMF. An LMF can also
transfer a user plane connection it has to a UE to a different LMF. User plane
establishment and transfer requires extra signalling but should reduce
signalling when used to transfer positioning messages between the UE and LMF.
However, it is not clear how an AMF can determine which UEs will benefit from
a user plane connection. If applied to all UEs, there could more signalling
overall and not less signalling. If applied to UEs which perform the most
positioning, there might be less signalling overall. But there is no analysis
of this. In this solution, it is LMF to decide whether or not utilize the user
plane positioning method after receiving a request from AMF. The user plane
connection would not be used if LMF decides to use control plane for UE
positioning.
With Solution #2, an LMF can transfer control plane positioning of a UE to a
separate SUPL user plane connection between the UE and a separate but
associated LCUP server. In this solution, it is LMF to decide whether or not
utilize the user plane positioning method after receiving a request from AMF.
SUPL based push mechanism or LPP itself is used to trigger the establishment
of UP connection if there is no available one. There would be extra signalling
to setup the SUPL user plane connection but, once setup, transfer of SUPL
positioning messages could use less signalling. The user plane server (LCUP)
might possibly be part of an LMF. The solution also requires some
clarification of how the SUPL user plane connection would be used. For
example, a SUPL user plane connection is normally released after a UE location
is obtained, as its emphasized OMA SUPL compliance, it should use minimized
handshake feature defined in clause 6.1.1.4 of OMA ULP specification if the
SUPL user plane connection ends then can be resumed for a later positioning of
the UE. URSP including user plane positioning related DNN/S-NSSAI is used for
PDU session establishment.
With Solution #3, an LMF can trigger a UE to establish a user plane secure
connection with the LMF and then exchange LPP messages with the UE over the
user plane secure connection. An LMF can also use an already established user
plane secure connection with a UE to transfer LPP messages. The protocols to
securely support the user plane connection and conditions for releasing the
user plane connection re-uses the solution#1. Establishing a user plane will
add extra signalling, thus AMF may trigger UE to establish the PDU session
when UE registers, considering UE capability, location and subscription
information, etc. to reduce signalling.
With Solution #19, user plane positioning is used only for a periodic or
triggered MT-LR to return location event reports to an LCS Client or AF. The
user plane connection is between the UE and LCS Client or AF and comprises
either a single direct connection or two concatenated user plane connections
through an intermediate entity that is either the LMF or the H-GMLC. For UE
assisted position methods, positioning (e.g. LPP) messages can be exchanged
between the UE and LMF over one user plane connection, with an event report
later sent by the LMF to the LCS Client or AF over a second user plane
connection. For UE based position methods, no signalling between the UE and
LMF is needed and a single direct user plane connection or two concatenated
user plane connections through an H-GMLC can be used. Although there is extra
signalling to establish and later release the user plane connection(s),
signalling would be reduced for reporting of location events which would
reduce overall signalling as long as event reports are sent. The \'second user
plane connection\' in this solution does not use the SBA pattern and exposures
the address information of LMF directly to AF and LCS Client. In this
solution, UE assisted and UE-based/UE standalone positioning methods utilize
different procedures, which does not involve LMF to make the decision to
select the positioning method and mode. The solution impacts the UE, AMF, LMF,
GMLC, LCS client, AF.
In general, use plane based solutions can reduce the communication overload
and signalling cost of control plane, i.e. AMF not involved for LPP message
transfer. In all solutions, there are no limitations on deployment scenario,
i.e. the LMF or LCUP can be deployed at centre or edge.
In summary, the comparison of solutions for KI#1 is listed in the Table 7.1-4.
Table 7.1-4: Comparison of solutions of Key Issue #1
Solutions NF to trigger to establish the UP connection How to trigger UP
establishment if there is no available one NF/entity the UE establish UP
connection to NF to selects the UP method Transport mechanism for LPP or Supp
Svc messages Whether cover LMF change Impacts on NFs
* * *
Sol#1 AMF UP Info of LMF LMF LMF A lightweight protocol to be defined by stage
3 in 3GPP Yes UE, AMF, LMF, UDM, NRF Sol#2 LMF LCUP information or OMA SUPL
based push mechanism LCUP (separated but cooperated with LMF) LMF or UE (SUPL)
OMA SUPL NO UE, LMF and LCUP at least Sol#3 LMF UP Info of LMF LMF LMF or UE
(for MO-LR after UP connection established) Re-use Sol#1 Yes UE, LMF and AMF
Sol#19 LCS client/ AF/GMLC/LMF UP Info of LCS client/ AF/GMLC/LMF LCS client
or AF/GMLC/LMF LMF not involved TLS NO UE, LMF, GMLC, LCS client/AF
## 7.2 Key Issue #2: enhanced positioning architecture for NPN deployment
The clause evaluates the solutions for KI#2 as following.
Solution#4 and #5 addresses key issue#2: enhanced positioning architecture for
NPN deployment. Both solutions propose the following principles:
\- AMF (in the public network) for general service operation, local AMF/any
AMF for LCS operation.
\- UE location result is transmitted from LMF to GMLC, not via AMF (in the
public network).
\- Non-UE NRPPa messages are transmitted between LMF and local AMF/any AMF.
\- UE associated NRPPa Requested message are transmitted via AMF in public
network.
Open issue of this key issue is the method for UE associated NRPPa Response
message transmission. Two options are for discussion:
\- Solution#4: via local AMF. The latency is reduced than legacy network, The
impacts are on Local AMF, and RAN.
\- Solution#5: via AMF in the public network. The latency is same as legacy
network. No new impact.
## 7.3 Key Issue #3: Local Area Restriction for an LMF and GMLC
The clause evaluates the solutions for KI#3 as following.
Solution#6, #7, #8, #9 are all addressing key issue#3: Local Area Restriction
for an LMF and GMLC. Three aspects \"parameter configuration\", \"parameter
exchange\", and \"LMF selection logic\" are used to summarize the solutions:
Table 7.3-1: Comparison of solutions of Key Issue #3
+-------------+-------------+-------------+-------------+-------------+ | Parameter | GMLC: | AMF/NRF: | AMF: | AMF/UDM: | | co | | | | | | nfiguration | configured | Mapping of | GMLC | Mapping of | | | with LMF ID | AF/client | service | UE ID and | | | | ID and LMF | area | LMF/GMLC | | | | ID | | address | +=============+=============+=============+=============+=============+ | Parameter | GMLC to | If mapping | none | If mapping | | exchange | AMF: | is on NRF, | | is on UDM, | | | | AMF | | AMF fetches | | | Configured | retrieves | | it. | | | LMF ID | the LMF ID | | | +-------------+-------------+-------------+-------------+-------------+ | LMF | AMF, based | By AMF | AMF, make | By AMF | | selection | on | | sure LMF | | | | provisioned | | can serve | | | | LMF ID | | the service | | | | | | area of the | | | | | | GMLC | | +-------------+-------------+-------------+-------------+-------------+
## 7.4 Key Issue #4: Interaction between Location Service and NWDAF
Key issue#4 details the questions to be studied for WT#2 in FS_eLCS_Ph3 SID
which includes the following aspects:
\- Aspect#1: how the location services can benefit from NWDAF;
\- Aspect#2: how the NWDAF use cases can benefit from location service; and
\- Aspect#3: how to provide location information to NWDAF.
Accordingly, the solutions for the key issue#4 can also be classified based on
the three aspects above, as shown in the Table 7.4-1.
Table 7.4-1: Solution Classification for KI#4
+----------------------+----------------------+----------------------+ | Aspect in WT#2 | Solutions for the | Whether coordination | | | aspect | with the | | | | FS_eNA_Ph3 study | | | | is needed | +======================+======================+======================+ | Aspect#1: how the | solution#11, | Yes | | location services | solution#20 | | | can benefit from | | | | NWDAF | | | +----------------------+----------------------+----------------------+ | Aspect#2: how the | solution#12, | Yes | | NWDAF use cases can | | | | benefit from | solution#20, | | | location service | | | +----------------------+----------------------+----------------------+ | Aspect#3: how to | solution#10, | No | | provide location | solution#13, | | | information to NWDAF | solution#35 | | +----------------------+----------------------+----------------------+
The evaluation of solutions (i.e. solution#11, solution#12 and solution#20)
related to aspect#1 is as follows:
\- LMF subscribes from NWDAF to obtain Location Accuracy analytics. NWDAF
obtains data from OAM (MDT data) or historical LMF output. LMF improves the
location accuracy by leveraging the location estimation from the NWDAF
(Solution#11).
\- NWDAF can optionally provide indoor/outdoor information based on available
measurements to assist LMF in above process (Solution#20).
The evaluation of solutions (i.e. solution#12, solution#20) related to
aspect#2 is as follows:
\- Analytics consumer requests Location Accuracy analytics. NWDAF obtains data
from GMLC/LMF to identify location accuracy (e.g. vertical/horizontal
accuracy) for a positioning method (Solution 12).
NOTE 1: Solution#59 in eNA_Ph3 study TR 23.700-81 [17] provides corresponding
solution on NWDAF.
\- information fed to NWDAF from GMLC/LMF could contain the indoor/outdoor
information so that NWDAF can provide such feature in aspect#1.
The evaluation of solutions (i.e. solution#10, solution#35 and solution#13)
related to aspect#3 is as follows:
\- In solution#10 and Solution#35, NWDAF requests UE location from GMLC, i.e.
the NWDAF acts as an AF which can request UE location using the existing
location service. In Solution#10, the only enhancement to existing location
service is to introduce new LCS Client Type and Service Type for NWDAF. In
Solution#35, the NWDAF requests (or collects) the location information of a UE
within a target geographical area from LCS system via GMLC. The enhancement to
existing location service is to provide a target geographical area, which can
be any shape comparing to current cell or TA concept, and a new location event
reporting condition(i.e. reporting only when the UE locates in the exact
target geographical area) from NWDAF to LMF.
NOTE 2: The requirement why the NWDAF requests the finer granularity location
information from LCS system originates from FS_eNA_Ph3 KI#9. How to provide
location information to NWDAF in a target geographical area finer than TA/cell
should be determined in this FS_eLCS_Ph3.
\- In solution#13, NWDAF requests UE location from AMF, so GMLC is not
involved. The solution can reduce location service latency because not
involving GMLC leads to reducing signalling flows especially in the roaming
scenarios. Some enhancements to NWDAF and AMF to help complete the privacy
check. It is an optional choice to realize data collection between NWDAF and
LCS.
## 7.5 Key Issue #5: Assistance data provisioning for low power high accuracy
GNSS positioning
This clause provides evaluation of Candidate Solutions for Key Issue #5.
A unique Candidate Solution has been proposed:
\- Candidate Solution #21- Collection of nearby GNSS assistance data. The
following concepts are proposed within the solution.
\- LMF collects GNSS assistance data and coordinates of GNSS reference
stations from AF(s) through AF event exposure service as described in clause
5.2.19.2 of TS 23.502 [3].
\- LMFs collected GNSS assistance data may update its NF profile in NRF by
indicating the TAs of which corresponding GNSS assistance data exists, which
can be discovered and used by other LMFs not having corresponding GNSS
assistance data.
Solution #21 reuses the AF event exposure service to collect GNSS assistance
data, this solution only has some small impacts on LMF, NRF and AF
functionality.
## 7.6 Key Issue #6: UE Positioning without UE/User Awareness
There is one solution in the present TR, i.e. sol#14, related to key issue#6
which aims to support UE not notified by any means during the LCS session,
especially when UE is in CM_IDLE or RRC_INACTIVE state.
To support key issue#6, two indications (i.e. UE unaware indication and user
unaware indication) are introduced in sol#14. When UE unaware indication is
provided by LCS Client/ AF, if target UE is in CM_IDLE or RRC_INACTIVE state,
the target UE is not paged. When user unaware indication is provided by LCS
Client/ AF, the only exception with the existing positioning procedure is that
interaction between network and user, i.e. privacy check requiring such
interaction, is skipped. Thus the function of the two indications is
different. The impacts to NFs of the two indications are further analyzed in
Table 7.6-1.
Table 7.6-1: Impacts to NFs of Different Indications in Solution#14
+--------------+--------------------------+--------------------------+ | Impacts | UE unaware | User unaware | +==============+==========================+==========================+ | GMLC impacts | Receive UE unaware | Receive user unaware | | | indication from LCS | indication from LCS | | | Client/NEF and send the | Client/NEF and send the | | | indication to AMF. | indication to AMF. | +--------------+--------------------------+--------------------------+ | NEF impacts | Receive UE unaware | Receive user unaware | | | indication from AF and | indication from AF and | | | send the indication to | send the indication to | | | GMLC. | GMLC. | +--------------+--------------------------+--------------------------+ | AMF impacts | Receive UE unaware | Receive user unaware | | | indication from GMLC and | indication from GMLC and | | | behave differently based | skip the privacy check | | | on UE state: | which requires | | | | interaction with user is | | | UE in CM_CONNECTED: | skipped. | | | send the UE unaware | | | | indication to LMF. | | | | | | | | UE in CM_IDLE: not to | | | | page UE and rejects the | | | | location request from | | | | GMLC or returns the | | | | latest UE location. | | +--------------+--------------------------+--------------------------+ | LMF impacts | Receive UE unaware | No | | | indication from AMF, | | | | select uplink | | | | positioning method (e.g. | | | | UL E-CID) based on the | | | | indication and send the | | | | network positioning | | | | message including UE | | | | unaware indication to | | | | RAN node. | | +--------------+--------------------------+--------------------------+ | RAN impacts | Receive UE unaware | No | | | indication from LMF and | | | | behave differently based | | | | on UE state: | | | | | | | | UE in RRC_CONNECTED: | | | | RAN behaviour is not | | | | impacted. | | | | | | | | UE in RRC_INACTIVE: not | | | | to page UE and reject | | | | the network positioning | | | | message. | | +--------------+--------------------------+--------------------------+
Based on the analyses in Table 7.6-1, user unaware indication requires the
network to page UE when UE is in CM_IDLE or RRC_INACTIVE state during the
positioning procedure which is not required by UE unaware indication. Thus the
user unaware indication can only support user unawareness, the UE unaware
indication can support both UE and user unawareness.
## 7.7 Key Issue #7: Support of Positioning Reference Units and Reference UEs
### 7.7.1 Evaluation of solutions for PRU
There are four solutions related to Positioning Reference Units (PRU) of KI#7,
i.e. solution#15, #16, #28, #29 . Solution#15 includes three options from PRU
Information Acquisition perspective, which are referred as solution#15-AMF,
solution#15-LMF and solution#15-UDM.
The comparison of solutions is shown in Table 7.7.1-1.
Table 7.7.1-1: Comparison of solutions to PRU of KI#7
+---------+---------+---------+---------+---------+---------+---------+ | | Sol\ | Sol\ | Sol\ | Sol#16 | Sol#28 | Sol#29 | | | #15-AMF | #15-LMF | #15-UDM | | | | +=========+=========+=========+=========+=========+=========+=========+ | PRU | UE | In | PRU | When | Similar | UE | | Regis | sends | cluding | info | AMF | to | sends | | tration | Regis | two | rmation | r | sol# | Regis | | | tration | o | i | eceives | 15-LMF, | tration | | | Request | ptions: | ncluded | PRU | optio | request | | | in | | in the | ind | n#B.1. | with | | | cluding | Optio | UE | ication | | PRU | | | PRU | n#B.1: | subsc | in | PRU may | info to | | | info | UE | ription | Regis | r | AMF. | | | rmation | sends | data is | tration | egister | PRU | | | to AMF | PRU | pre-con | R | to | Info | | | | Regis | figured | equest, | m | may | | | | tration | in UDM | it | ultiple | include | | | | Request | | t | LMFs. | AMF ID, | | | | in | | riggers | | LMF ID | | | | cluding | | posi | | or URI, | | | | PRU | | tioning | | mobile | | | | info | | pr | | /static | | | | rmation | | ocedure | | PRU, | | | | to LMF | | after | | P | | | | via | | the | | osition | | | | AMF. | | Regis | | info. | | | | The | | tration | | | | | | message | | pro | | | | | | is a | | cedure. | | | | | | supple | | | | | | | | mentary | | LMF | | | | | | service | | obtains | | | | | | ope | | PRU | | | | | | ration. | | l | | | | | | | | ocation | | | | | | Optio | | after | | | | | | n#B.2: | | the | | | | | | UE | | posi | | | | | | sends | | tioning | | | | | | PRU | | pr | | | | | | Regis | | ocedure | | | | | | tration | | and | | | | | | Request | | stores | | | | | | in | | the | | | | | | cluding | | info | | | | | | PRU | | rmation | | | | | | info | | l | | | | | | rmation | | ocally. | | | | | | to LMF | | | | | | | | via LPP | | | | | | | | pro | | | | | | | | cedure. | | | | | +---------+---------+---------+---------+---------+---------+---------+ | | AMF | LMF | | LMF | | LMF | | | invokes | invokes | | invokes | | n | | | Nnrf_N | Nnrf_N | | Nnrf_N | | otifies | | | FManage | FManage | | FManage | | the | | | ment_N | ment_N | | ment_N | | GMLC | | | FUpdate | FUpdate | | FUpdate | | the PRU | | | Request | Request | | Request | | info | | | in | in | | in | | rmation | | | cluding | cluding | | cluding | | | | | PRU | PRU | | PRU | | | | | l | l | | info | | | | | ocation | ocation | | rmation | | | | | and PRU | and PRU | | to NRF | | | | | ex | ex | | | | | | | istence | istence | | | | | | | ind | ind | | | | | | | ication | ication | | | | | | | to NRF. | to NRF. | | | | | +---------+---------+---------+---------+---------+---------+---------+ | How to | Target | Target | Target | Same as | Target | Target | | obtain | UE LMF | UE LMF | UE AMF | sol\ | UE LMF | UE LMF | | PRU | obtains | obtains | obtains | #15-LMF | stores | obtains | | info | PRU AMF | PRU LMF | PRU | | info | PRU | | rmation | from | from | info | | rmation | from | | used to | NRF. | NRF. | rmation | | about | GMLC. | | assist | | | from | | av | | | target | Target | Target | UDM and | | ailable | | | UE | UE LMF | UE LMF | p | | PRUs | | | posi | obtains | obtains | rovides | | | | | tioning | PRU | PRU | PRU | | | | | | info | info | info | | | | | | rmation | rmation | rmation | | | | | | from | from | to | | | | | | PRU | PRU | Target | | | | | | AMF. | LMF. | UE LMF. | | | | +---------+---------+---------+---------+---------+---------+---------+ | I | AMF, | AMF, | AMF, | AMF, | LMF | AMF, | | mpacted | LMF, | LMF, | UDM, | LMF, | | LMF, | | 5GC NF | NRF | NRF | LMF | NRF | | GMLC | +---------+---------+---------+---------+---------+---------+---------+ | Impacts | PRU | PRU | PRU | PRU | No | No | | to RAN/ | wake | wake | wake | wake | | | | RAN WG | up: RAN | up: | up: | up: | | | | | r | same as | same as | same as | | | | | eceives | sol# | sol\ | sol\ | | | | | PRU | 15-AMF. | #15-AMF | #15-AMF | | | | | wake up | | | | | | | | ind | In | | | | | | | ication | Optio | | | | | | | from | n#B.2, | | | | | | | AMF and | PRU | | | | | | | sends | regis | | | | | | | br | tration | | | | | | | oadcast | pr | | | | | | | message | ocedure | | | | | | | in the | is a | | | | | | | serving | new LPP | | | | | | | cell of | pr | | | | | | | target | ocedure | | | | | | | UE. | which | | | | | | | | is in | | | | | | | | RAN2 | | | | | | | | scope. | | | | | +---------+---------+---------+---------+---------+---------+---------+
Solution #15 supports multiple alternatives and impacts multiple entities
besides PRUs (AMF, LMF, NRF, UDM). There are also separate procedures defined
for supporting an MT-LR and MO-LR and for activating and deactivating PRUs
which add more impact. Option A (PRU registration to AMF) impacts the AMF
which needs to indicate a PRU to the NRF after which an LMF would need to
discover PRUs from the NRF. However, PRUs are not NFs but more part of the NG-
RAN making NRF support possibly unnecessary. Option B (PRU registration to
LMF) is more direct and impacts the PRU, LMF and possibly NRF. Option C (PRUs
information are maintained at the UDM) requires an AMF to query the UDM for
available PRUs and then indicate these to an LMF. It is not clear how a UDM
would know about PRU availability since a PRU could be powered off, out of
coverage or undergoing maintenance. Of these options, option B looks simplest.
Solution #16 uses the NAS Registration procedure to indicate a PRU to an AMF
which then indicates the PRU to an LMF via an Nlmf location request. There is
no direct confirmation back to the PRU that the AMF was able to indicate the
PRU to an LMF, so if the LMF rejects the Nlmf location request or if the AMF
cannot find a suitable LMF, the PRU would not know. However such failure case
is in scope of stage 3, e.g. AMF could send the UCU to PRU to notify the PRU
registration failure. LMF utilization of a PRU to support location of a target
UE (in clause 6.16.3.2) includes UE positioning in steps 2 and 6 for Figure
6.16.3.2-1. However, no details are provided concerning how the PRU would help
position the target UE. Positioning of a target UE by a PRU is not so far
defined by RAN, so it is unclear whether these steps are feasible and what
might be the impacts to the LMF, target UE and PRU. The use of an NRF to
discover other PRUs managed by another LMF to assist with the location of a
target UE would add additional impacts to an LMF and NRF.
Solution #28 avoids any impact to an AMF or NRF. A PRU registers with one or
more LMFs using a supplementary services protocol. The PRU can be used by an
LMF to obtain measurements of RAN nodes in the same was as from a normal UE
using LPP. These measurements and a location of the PRU can be used to
determine correction terms (e.g. timings and internal delays) of RAN nodes, as
defined in TS 38.305 [6]. Extension of the solution to support Reference UEs
could be possible later. The PRU updates the registration in LMF based on
conditions received from LMF, e.g. periodically or triggered by location
change. When the PRU registers with more LMFs, each LMF stores the same PRU
information which leads to duplicated storage of the same information in the
LMFs. In this case, the PRU has to update the registration when needed to all
LMFs storing the PRU information, so more signalling cost is introduced.
Furthermore, the PRU authentication would need to be performed in each LMF
separately. This duplication of storage and authentication among multiple LMFs
should not be significant if PRUs are few in number compared to UEs or if
duplicate PRU storage and authentication only occurs for PRUs in border areas
between LMF serving areas.
Solution #29 stores the PRU information in GMLC. When LMF decides to perform
the positioning procedures to PRU during the positioning process of target UE,
the LMF always obtains PRU information from the GMLC. Considering that the PRU
is introduced to improve positioning accuracy which is the responsibility of
LMF and is transparent to GMLC, in order to avoid dispersing the same function
in different network functions, it is better to store PRU information in LMF
or the LMF profile stored in NRF.
### 7.7.2 Evaluation of solutions for Reference UE
There is one solution related to Reference UE of KI#7, i.e. solution#17.
Solution #17 is based on use of sidelink positioning and ProSe. There seems to
be no Uu (UL/DL) level positioning. This means the solution should be part of
sidelink positioning and ranging in Release 18 and cannot be evaluated
separately, e.g. in case it duplicates or conflicts with other sidelink
positioning and ranging solutions for Release 18.
## 7.8 Key Issue #8: support of location service continuity in case of UE
mobility
Table 7.8-1: Comparison of solutions to 5GS\<>EPS Mobility
+----------+----------------------------+----------------------------+ | Solution | Solution Summary | Solution Evaluation | +==========+============================+============================+ | 31 | During periodic location | Solution is the deferred | | | service triggered, if | MTLR case and it is | | | AMF/LMF finds the UE | converted into an MO-LR | | | reporting type includes | session in the target | | | \"EUTRAN\" and if the | case. | | | required \"LCS QoS class\" | | | | is \"multiple QoS class\", | Not clear how LCS session | | | the AMF/LMF determines the | is handled when mobility | | | corresponding location QoS | happens during the LCS | | | can be applicable to EPS, | signalling itself (i.e. | | | e.g. AMF or LMF map the | before the measurements | | | QoS class to \"Best | are got). | | | Effort\" and choose the | | | | most stringent value from | | | | the \"LocationQoS\" as the | | | | QoS requirement, LMF sends | | | | these parameters to UE and | | | | AMF if AMF does not | | | | determine the location QoS | | | | applicable to EPS. | | | | | | | | After receive the handover | | | | required, if AMF finds UE | | | | can support interworking | | | | between 5GS and EPS, AMF | | | | sends the 5GS location QoS | | | | corresponding EPS location | | | | QoS to GMLC. | | | | | | | | After handover complete, | | | | if UE finds periodical | | | | event is triggered and if | | | | UE finds it has moved to | | | | EPS, the UE sends LCS | | | | MO-LR Invoke message, | | | | carry the location QoS can | | | | be applicable to EPS. | | | | | | | | Similar solution for | | | | EPS->5GS mobility. | | +----------+----------------------------+----------------------------+ | 32 | The source RAT AMF/MME | There is an assumption | | | acts as the anchor, | that the UE context stays | | | forwarding the Positioning | in the source AMF/MME till | | | context data to the target | the LCS session completes | | | RAT MME/AMF, which | in the target RAT. This is | | | forwards the same the | an unrealistic assumption | | | eSMLC/LMF. The LCS session | since the LCS session | | | is continued with in the | could have a long life | | | target RAT and result sent | (particularly in cases of | | | back to the source | event triggered/periodic | | | AMF/MME, which responds | cases) during which time | | | back to the GMLC to return | the UE context cannot be | | | the location estimate to | stored on the source side. | | | the LCS Client. | | +----------+----------------------------+----------------------------+ | 33 | Source AMF/MME play | It is a common solution | | | central role, cancelling | for all types of LCS | | | LCS session, responding to | procedures and positioning | | | GMLC with a new cause for | methods while keeping | | | HO and target MME ID. | impacts to EPC to minimum. | | | | No need for any UE context | | | GMLC then initiates | retention on the source | | | location request to target | RAT side after HO is | | | MME/AMF with the location | complete. The procedure | | | session data - location | can be easily enhanced to | | | estimated and returned to | support LCS session over. | | | GMLC which returns the | | | | estimate to LCS Client. | | +----------+----------------------------+----------------------------+
Table 7.8-2: Comparison of solutions to NG-RAN node mobility
+----+-------------------------------+-------------------------------+ | ID | Solution Summary | Solution Evaluation | +====+===============================+===============================+ | 22 | S-AMF shares LCS session | The solution is applicable to | | | details to T-AMF as part of | UL/DL methods + | | | HO preparation. | MOLR/MTLR/NILR procedures + | | | | Xn/NG Based HO - it is | | | T-AMF notifies to LMF after | generic in nature. | | | HO completion. | | | | | Sharing of LCS information | | | LMF continues with the LCS | was analysed at | | | Session with new | RAN/AMF/LMF/GMLC. | | | configuration. | | | | | RAN - not possible for DL | | | LMF responds with UE | methods. | | | location. | | | | | LMF - LMF/eSMLC have no | | | | direct interface. | | | | | | | | GMLC - this is possible, but | | | | may take time compared to | | | | AMF. | | | | | | | | AMF - was found to be the | | | | most optimal in terms of time | | | | taken + generality of the | | | | solution - was chosen for the | | | | solution | | | | | | | | The solution ensures that the | | | | LCS Client need not be aware | | | | of the mobility. | | | | | | | | For mobility in RRC-INACTIVE | | | | and RRC-IDLE the explicit | | | | solution is not proposed. For | | | | mobility in RRC-INACTIVE, we | | | | believe that the current | | | | solution defined in R17 | | | | (23.273, sec. | | | | 6.7.3/6.7.4/6.7.5) could be | | | | reused/enhanced. | | | | | | | | For mobility in RRC-IDLE, the | | | | current proposed solution | | | | (where location transfer | | | | happens from the old AMF to | | | | new AMF) could be reused. | +----+-------------------------------+-------------------------------+ | 30 | As part of the HO procedure, | The solution for connected | | | the source RAN sends | mobility proposes the sharing | | | Positioning related | of Positioning information | | | information to Target RAN | between RANs directly | | | over Xn or NGAP (depending on | (through Xn or NG). The | | | the type of HO). | following issues are noted. | | | | | | | Target RAN then sends the | For DL methods, the source | | | positioning information to | RAN will not know that an LCS | | | LMF. | session is on or not due to | | | | the following reasons. | | | AMF/Old LMF then determine if | | | | LMF should be reselected and | LCS signalling happens over | | | forward the positioning | LPP (invisible to RAN). | | | configuration to chosen LMF. | | | | | there is no UE associated | | | AMF notifies the LMF the | NRPPa signalling for DL | | | target cell ID/NG-RAN - based | methods. | | | on that, the LMF configures | | | | the neighbouring RAN with the | The IE Positioning | | | latest configuration. | Information defined in | | | | R17:XnAP provides only | | | In RRC-Idle mobility, as part | SRS-Config info - for UL | | | of registration procedure, | methods. Evidently this | | | the new AMF checks if | solution cannot be applied to | | | positioning information is | DL methods. | | | present in the UE context | | | | data - if so, then sends the | For UL methods, the sharing | | | new AMF ID to LMF via the | information over Xn is not | | | next periodic | likely to speed up the | | | N1messageNotify. | procedure, since that | | | | information can be taken into | | | | use by the target RAN only | | | | when the LMF sets up the LCS | | | | session with the target RAN. | | | | | | | | In summary, we believe that | | | | this solution will not work | | | | for DL methods based LCS | | | | session and offers not much | | | | advantage for UL methods. Any | | | | solution defined should be | | | | common for UL, DL or UL+DL | | | | methods. | +----+-------------------------------+-------------------------------+
## 7.9 Key Issue #9: Support of Positioning Requirements Related to Satellite
Access
The clause evaluates the solutions for KI#9 as following.
There are 4 candidate solutions proposed to address positioning requirements
related to satellite access.
Solution overview:
\- Solution #18: Location Verification for Satellite Access assisted by NWDAF
Analytics.
NWDAF is involved to provide analytics with statistics and predictions of the
UE location which can assist with the network verification task that is
required when a UE provides its location to the network via satellite access.
\- Solution #23: Location Verification for Satellite Access assisted by TN
access.
Location verification for UE using satellite access is enforced based on the
UE location provided through TN access. If the AMF decides to do such
verification, it indicates UE to do registration via TN access. The UE
location in TN access can be delivered to the AMF through registration
procedure.
\- Solution #24: UE Location Verification based on Obtained Information.
This solution depends on the NG-RAN providing assistance information to do
location verification. The reliability of verification can be enhanced by
means of the assistance information, but whether and what assistance
information can be provided by NG-RAN should depends on RAN WGs conclusion.
\- Solution #34: UE location determination for Mobility Restriction
enforcement
This solution proposes AMF to invoke NI-LR procedure to determine the UE
located TAI in the case of not all of the NG-RAN reporting TAIs are in
Forbidden Area or Non-allowed area. AMF can perform precise Mobility
Restriction based on the TAI determined through NI-LR procedure. The
positioning method mode selection needs coordination with RAN WGs and depends
on RAN supported methods.
All the solutions can be evaluated based on the following factors:
\- Solution assumptions or restrictions.
\- The reliability of UE location verification.
\- RAN dependency for proposed solution.
\- Functionality(entity, interface) impact.
Based on the solution whether to resolve reliability issue, whether the
solution has RAN dependency and functionality impacts, solutions can be
evaluated as follows:
Table 7.9-1: Candidate Solutions evaluation
Solution Assumptions verification reliability RAN Independency Functionality
impact
* * *
#18: Location Verification for Satellite Access assisted by NWDAF Analytics N
Analytics confidence dependent Y AMF, NWDAF #23: Location Verification for
Satellite Access assisted by TN access Y Y Y UE, AMF, UDM #24: UE Location
Verification based on Obtained Information N RAN assistance dependent N NG-
RAN, AMF,LMF #34: UE location determination for Mobility Restriction
enforcement N RAN positioning dependent N NG-RAN, AMF, LMF NOTE: N = No, Y =
Yes
1) Solution assumptions and restrictions
There is no assumption or restriction on solution #18, #24 and #34.
Solution #23 works under the conditions that 1) the area that the UE located
is covered by both TN access (e.g. LTE, NR) and NR satellite access and 2) UE
has the capability of supporting both TN access and NR satellite access.
Considering the user location verification under satellite access often needs
to be performed in national cross borders, and some of the boundary areas have
TN and NR satellite coverage, this solution is feasible in some cases.
2) The reliability of UE location verification.
Solution #18 relies on NWDAF providing location statistics and analytics to
the AMF to assist with location verification. While location verification
relying only on analytics may not always be fully reliable (e.g. predictions
on UE location may not be accurate), they will certainly enhance the
reliability of the location verification process when combined with additional
assistance information and/or procedures. Hence, in most cases, this can
enhance the reliability of verification.
Solution #23 relies on UE location in TN access to do verification. Since the
UE location (e.g. the cell the UE is camping on) is reported by RAN rather
than generated by the UE, besides, the UE location in TN access represents a
smaller range of location area than that in NR satellite access, based on
above, it can be seen as reliable when used for verification.
The premise of solution #24 relies on RAN providing reliable assistance
information.
Solution #34 relies on NR Satellite-based RAN position method to obtain
reliable UE location.
3) RAN dependency for proposed solution.
Getting reliable UE location through RAN position will increase the time
latency. Especially the latency of satellite communication is more serious,
RAN position will aggravate the time delay. Besides, satellite resource may be
scare, RAN position will increase resource consumption.
Solution #18 and solution #23 has no RAN dependency.
Solution #24 and solution #34 relies on RAN providing reliable location
information. The feasibility of the solutions depends on RAN conclusion.
4) Functionality(entity, interface) impact.
Solution #18 requires NWDAF to do UE location analytic with the request from
AMF and provide it to the AMF. No other enhancement is needed.
Solution #23 requires AMF to indicate UE to register on TN access when
location verification is determined to perform by AMF. UE location in TN
access is reported to UDM via registration procedure and is further delivered
to AMF. UE, AMF and UDM are involved to convey such location information,
existing procedure can be reused.
Solution #24 requires RAN to provide location assistant information to the
AMF. N2 interface need to be enhanced, existing procedure can be reused.
Solution #34 requires AMF to indicate to the LMF that reliable position method
is required. Existing procedure can be reused with no more enhancement.
## 7.10 Key Issue #10: Support of Reduced Latency
By supporting user plane-based positioning, Sol#1, Sol#2, Sol#3 and Sol#19 can
reduce the latency of LPP or Supplementary service transfer between UE and
LMF, in particular when UPF and LMF are located at edge while serving AMF are
located at centre (i.e. the LPP message or Supplementary service not to be
relayed by centre AMF through control plane).
\- Compared with control plane based mode, the user plane mode may introduce
extra signalling latency, e.g. there will be a PDU session/UP connection
establishment procedure if there is no available proper PDU session/UP
connection, when a LCS request is received by LMF. Sol#1 and Sol#3 considers
to trigger LCS-UP connection/PDU session establishment at application
registration events, which aims to establish LCS-UP connection/PDU session in
advance to reduce latency. Sol#1 and Sol#3 also proposed to maintain the
established user plane connection for the sake of low latency of subsequent
LCS request.
\- Sol#19 proposed a \'second user plane\' between LMF/GMLC and AF or LCS
client, which aims to bypass GMLC to reduce latency when reporting UE location
to LCS client. However, exposure of LMF address information directly to LCS
client and AF may cause security risks. By co-deployment of GMLC and LMF at
edge, the latency between GLMC and LMF may be reduced.
\- Sol#19 proposed a user plane connection between the UE and AF or LCS client
for a periodic or triggered MT-LR which can minimize end to end latency when
the target UE (rather than LMF) determines location estimates.
## 7.11 Key Issue #11: Enhance the Triggered Location for UE power saving
purpose
This clause provides the evaluation of Candidate Solution (i.e. solution#25
and solution#35) for Key Issue #11.
Power saving purpose is achieved by allowing the UE to report location only
when the UE is in the pre-defined area. The location event report has
dependency on the pre-defined area. Both Solution#25 and Solution#35 proposed
that the pre-defined area can be requested by an LCS Client/AF and sent to the
UE via LCS Periodic-Triggered Invoke Request message.
In Solution #25:
\- the pre-defined area will be translated by GMLC to a geographical area as
defined in TS 23.032 [26] and converted to a TA/cell list. The UE received
pre-defined area named \"event report allowed area\" is a TA/cell list. The UE
periodically monitors cell ID and/or TAI as broadcasted by RAN, by simply
comparing with the received \"event report allowed area\", UE can decide it is
in the area or not.
\- Only when the UE is in the area, the UE needs to detect whether the event
happens. So the event report allowed area is used to reduce UE power
consumption by reducing the number of event report and the number of UE
positioning procedures which may be triggered by the event report.
\- The event report allowed area can be applied to all event types, and the UE
can adjust the area based on the power status, e.g. if the power status of UE
is low, the UE can set the area to a small area.
\- Solution #25 also contains two ambiguous aspects concerning whether a UE
should occasionally send event reports when outside an allowed area to show an
HGMLC and LCS Client that event reporting is still active in the UE and on
whether an allowed area can be used in an opposite sense where a UE only
reports when outside a certain area (e.g. where a UE spends most time in the
area but UE location is only needed when the UE is outside the area).
In Solution #35:
\- the pre-defined area can be any shape as requested by LCS client/AF, or the
translated geographical area as defined in TS 23.032 [26]. The UE received
pre-defined area named \"exact target area\" is with finer granularity than
TA/cell list and can be any shape.
\- The \"exact target area\" is an enhancement to area type event report, that
the UE location is only reported when the UE is exactly in the \"exact target
area\"
\- To achieve this, either UE or LMF needs to compare the UE location and the
\"exact target area\" with the UE location measurement. Only when the UE is in
the \"exact target area\", UE/LMF reports the event.
\- Power saving can be achieved only with Solution #25, i.e. after UE detects
it is in the TA/cell list (\"event report allowed area\") and obtains the
Location Measurement as specified in step 23) in clause 6.3.1 TS 23.273 [5].
By further comparing the location with the \"exact target area\", UE/LMF can
decide that the UE is in the area or not, i.e. Case II mentioned area as shown
in Figure 7.11-1, the area identified by cell/TA, but not in the pre-defined
area.
Figure 7.11-1: Illustration of pre-defined area, event report allowed area,
and finer granularity area
# 8 Conclusions
## 8.1 Key Issue #1: Architectural Enhancement to support User Plane
positioning
\- A user plane connection may be used between a UE and LMF with the following
properties.
\- The UE uses the URSP which includes user plane positioning related PDU
session parameters (e.g. DNN and S-NSSAI) to establish the PDU session for
user plane positioning.
\- It is LMF to decide whether to use user plane or control plane positioning
mode when receiving positioning requests from AMF.
\- If LMF decides to utilize user plane positioning, the LMF sends its UP
positioning address and security related information to UE to trigger the UP
connection if it is not available.
\- LMF and UE may maintain the established user plane connection between UE
and LMF for subsequent LCS session. Protocol to be used for User Plan
connection may be decided by SA WG3 and by Stage 3 based on considering the
proposed alternatives:
\- The user plane connections can be supported using other transport decided
by CT WG1 and common security procedures and protocol to be determined by SA
WG3.
\- As per both TS 38.305 [6] from RAN and TS 23.271 [4] for
GERAN/UTRAN/E-UTRAN, the User Plane work aligned with both RAN and 2G/3G/4G
may use solution#2.
\- The UP connection between UE and LMF supports LPP message transfer and
Supplementary service.
\- A user plane connection may be used between a UE and AF or LCS Client as
defined in Solution #19 for a periodic or triggered MT-LR for the case where
UE based location is used and where the UE determines location estimates. The
AF or LCS Client address and security related information is then provided to
the UE in the MT-LR request. The UE establishes the user plane connection to
the AF or LCS Client and uses it to send event reports to the AF or LCS
Client.
## 8.2 Key Issue #2: enhanced positioning architecture for NPN deployment
The Local AMF/Any AMF in NPN deployment is used to transfer the Non-UE
Associated Network Assistance Data between the RAN and LMF, as described in
solution 4 and solution 5.
For UE Associated Network Positioning procedure, the LMF sends the UE
Associated Network Positing message towards the RAN via the serving AMF. RAN
responds UE Associated Network Positioning message to LMF via the serving AMF.
The LMF notifies the UE location to GMLC directly, i.e. without going through
the serving AMF.
## 8.3 Key Issue #3: Local Area Restriction for an LMF and GMLC
The following aspects are concluded for normative work:
**Aspect 1: Provisioning of LMF ID:**
1\. LCS Data in the GMLC for an LCS Client/AF, maybe enhanced by adding the
following parameters:
\- LMF ID;
\- Group ID and its correlating LMF ID.
When the GMLC receives a MT location request from LCS client/AF, GMLC
determines the LMF ID based on the LCS Data context per LCS client/AF.
If that group ID can be provided or derived from the LCS request, GMLC
determines the LMF ID based on the provisioned Group ID.
2\. GMLC may be configured with an LMF ID, and irrelevant to any LCS
client/AF. When the GMLC receives a MT location request from LCS client/AF,
GMLC determines the LMF ID for all LCS client/AF.
3\. UDM may be enhanced in the UE LCS subscriber data by adding a correlating
LMF ID, and GMLC fetches it when interacting with UDM.
4\. AMF maybe configured locally, a mapping table of UE identity e.g. MSISDN
and LMF/GMLC address, When receiving a MO-LR, AMF determines LMF and GMLC
based on local configuration.
**Aspect 2: LMF selection:**
\- The GMLC provides LMF ID to AMF or AMF determines the LMF ID based on
aspect 1. The AMF uses the LMF ID to select the LMF.
## 8.4 Key Issue #4: Interaction between Location Service and NWDAF
Key issue#4 details the questions to be studied for WT#2 in FS_eLCS_Ph3 SID
which includes the following three aspects:
\- Aspect#1: how the location services can benefit from NWDAF;
\- Aspect#2: how the NWDAF use cases can benefit from location service; and
\- Aspect#3: how to provide location information to NWDAF.
The interim conclusion for aspect#1 is as follows:
NOTE 1: In this aspect, as the beneficiary is LCS system, LCS will do the
conclusion and inform FS_eNA_Ph3 about the requirements to NWDAF (eNA_Ph3 Key
Issue#9) for the enhancement of LCS system.
\- NWDAF provides new analytics for Location Estimation Accuracy. The location
accuracy analytics include horizontal or vertical accuracy, indoor/outdoor
indication.
\- Solutions 11 and 20 will be used as a basis to derive location estimation
accuracy analytics. Further details on input data for the new location
accuracy analytics will be determined during the normative phase in
coordination with eNA_Ph3.
\- LMF as a NWDAF consumer of such analytics uses Location Estimation Accuracy
analytics to determine Position Method in the area where a UE is located.
\- Location client as a consumer of such analytics uses Location Estimation
Accuracy to determine a requested LCS QoS class or adjust application specific
parameters (out of scope of 3GPP).
The interim conclusion for aspect#2 is as follows:
NOTE 2: In this aspect, as the beneficiary is NWDAF, NWDAF (FS_eNA_Ph3 Key
Issue#9) is expected be informed with the possibilities and benefits from LCS.
NOTE 3: FS_eNA_Ph3 Key Issue#9 required enhancements to LCS system will be
evaluated, coordinated in this aspect based on coordination decision.
\- The NWDAF can retrieve indoor/outdoor indication if it can be decided by
LMF.
\- The NWDAF can provide as part of Location Estimation Accuracy a ratio of
NLOS/LOS measurements, if LMF receives the NLOS/LOS measurement indicator from
the UE in the measurement report.
The interim conclusion for aspect#3 is as follows:
\- The NWDAF retrieves location data from the GMLC using the Ngmlc services.
\- To support privacy check, new LCS Client Type and Service Type is
introduced and is used by NWDAF to request UE location:
\- new LCS Client Types for PLMN Operator Class:
\- NWDAF client in the HPLMN (when the UE is currently being served by the
HPLMN);
\- NWDAF client in the VPLMN.
\- new standardized Service Type for Tracking Services:
\- Analytics;
\- Model training.
\- To support reporting of finer granularity UE location information in a
target geographical area in form of any shape comparing with TA/cell to the
NWDAF, the enhancements for LCS system include:
\- The NWDAF provides to LCS system a target geographical area and a new
location event reporting condition, i.e. reporting only when the UE locates in
the exact target geographical area;
\- By comparing UE location information with the target geographical area, the
LCS system reports the UE location information to the NWDAF once UE locates in
the target geographical area.
## 8.5 Key Issue #5: Assistance data provisioning for low power high accuracy
GNSS positioning
LMF reuses the AF event exposure service to collect nearby GNSS assistance
data.
## 8.6 Key Issue #6: UE Positioning without UE/User Awareness
For key issue #6, it is concluded that solution#14 (UE unaware indication) is
used as the baseline for normative work.
## 8.7 Key Issue #7: Support of Positioning Reference Units and Reference UEs
To support PRU, the conclusions are as follows:
\- For PRU Registration, the conclusions include:
\- UE sends UL NAS Transport including PRU Registration Request to AMF.
\- The PRU Registration is an LCS supplementary service message and has no new
AMF impact.
\- AMF sends the PRU Registration Request to LMF and may include a UE
verification indication indicating whether this UE can serve as a PRU.
\- PRU Registration Request includes PRU information.
\- PRU information may include PRU\'s positioning capability, location
information (if known), type and state of the PRU (e.g. mobile/static type,
on/off state)
\- The PRU may register with multiple LMFs. e.g. for the case a PRU is in
multiple LMF overlapped serving areas.
\- LMF may indicate to NRF the PRU information or may store PRU information
locally based on operator policy.
\- LMF stores PRU information and may indicate to NRF the PRU existence in its
NF profile.
\- When the PRU information is provided to the NRF:
\- The serving LMF invokes the Nnrf_NFManagement_NFUpdate service operation to
store the PRU information in the LMF profile already stored in the NRF.
\- When other LMF needs to obtain the PRU information for a certain area, the
LMF just invokes the Nnrf_NFDiscovery including NF type which is set to LMF
and indicates the area. NRF will return the profile including PRU information
of the LMFs covering the area.
\- The target UE serving LMF may obtain PRU information locally, or may obtain
PRU information and a PRU serving LMF from an NRF.
\- A mobile PRU may lead to the update of registration at serving LMF and/or
registration at a new LMF.
\- A serving LMF of PRU obtains PRU location measurements as described in
clause 5.4.5 of TS 38.305 [6] by triggering the existing procedures defined in
clause 6.11 of TS 23.273 [5]:
\- To improve target UE positioning, the serving LMF of the target UE may
obtain PRU location measurements from a serving LMF of PRU.
To support Reference UE, the interim conclusion is as follows:
\- In this study, the Reference UE is the PRU.
NOTE: The above Reference UE conclusion applies only to FS_eLCS_Ph3. Other
uses of Reference UE as defined in other R18 studies do not require Reference
UE to be a PRU.
## 8.8 Key Issue #8: Support of location service continuity in case of UE
mobility
Normative work will take place according to principles described in this
clause:
**For 5GS - > EPS mobility:**
\- (During Hand-over) The source AMF shall cancel the LCS session (e.g. to
LMF), responding to GMLC with a new cause for HO and with the target MME ID.
\- GMLC then initiates a new location request to the target MME identified in
AMF message cancelling the LCS session over 5GS possibly translating location
parameters such as QoS, user Id (no privacy check is needed).
\- The location procedure takes place in EPS ; location estimation is returned
to GMLC which returns the estimate to LCS Client.
NOTE: This ensures a common procedure for all types of location and
positioning methods (and regardless of where the hand-over takes place in the
on-going location procedure) with no impacts to EPS.
**For EPS - > 5GS mobility:**
\- (During Hand-over) The source MME shall cancel the LCS session over EPS as
currently specified, and responds to GMLC with a new cause for HO and with the
target AMF ID.
\- GMLC then initiates location request to target AMF identified in MME cancel
message possibly translating location parameters such as QoS, user Id (no
privacy check is needed).
\- The location procedure takes place in 5GS ; location estimation is returned
to GMLC which returns the estimate to LCS Client.
For both direction of mobility between 5GS and EPS, the GMLC used over 5GS
(respectively EPS) can issue location request over EPS (respectively 5GS).
Based on operator policy, the following alternative solution could be
considered.
\- For periodic/deferred location service continuity from 5GS to EPS:
\- The LMF should determine whether UE can move between 5GS and EPS and notify
UE the corresponding location QoS can be applied to EPS.
\- After the location event is triggered, the UE should determine and send the
suitable event triggered message and carry the suitable location QoS which can
be applicable to EPS.
\- For periodic/deferred location service continuity from EPS to 5GS:
\- After the location event is triggered, the UE should determine and send the
suitable event triggered message which can be applicable to 5GS.
\- For both non-periodic/deferred location service continuity and
periodic/deferred location service continuity:
\- The LMF should determine the location information including the location
QoS can be applicable to EPS, GMLC notify this information to E-SMLC to
trigger the location procedure start in EPS.
\- After handover complete, the AMF/MME should notify GMLC.
**For mobility between NG-RAN nodes in connected mode:**
\- S-AMF shares LCS session details to T-AMF as part of HO preparation.
\- T-AMF notifies to LMF after HO completion.
\- LMF continues with the LCS Session with new configuration.
\- LMF responds with UE location to the T-AMF which responds to the LCS Client
via the GMLC(s).
**For mobility between NG-RAN node while the UE was RRC-INACTIVE:**
\- The current solution defined in R17 (clauses 6.7.3, 6.7.4, 6.7.5 of TS
23.273 [5]) is reused.
**For mobility in RRC-IDLE:**
\- Reuse of the solution 22 (where location transfer happens from the old AMF
to new AMF), as defined for connected mode in Solution #22, is used.
## 8.9 Key Issue #9: Support of Positioning Requirements Related to Satellite
Access
Based on the KI#9 evaluation documented in clause 7.9, the following aspects
are concluded as basis for normative work:
\- Verification of UE location provided via satellite access should be
performed leveraging the LCS framework at the 5GC.
\- The AMF is the entity in charge of providing the location verification
decision, in line with Rel-17 mechanism of UE location verification:
\- The AMF may trigger location service procedures as defined in TS 23.273 [5]
to determine the UE location verification decision and optional TAI
determination. Location information received at AMF is provided by LMF via the
NI-LR procedure. The LMF may decide specific positioning methods to be used
for verification based on RAN WG decisions.
\- The AMF may receive assistance information from NWDAF (i.e. analytics
containing UE location information) to perform the location verification
decision.
## 8.10 Key Issue #10: Support of Reduced Latency
It is proposed to concluded as follows for KI#10:
\- When UPF and LMF are located at edge while AMF at centre, user plane based
positioning can reduce the LPP message transfer latency between UE and LMF.
\- By co-deployment of GMLC and LMF at edge, the latency of periodic or
deferred location report from LMF to AF/LCS client through GMLC can be
reduced.
\- By using a user plane connection between a UE and an AF or LCS Client, end
to end latency for a periodic or triggered MT-LR can be minimized if a target
UE is able to determine the location estimates.
## 8.11 Key Issue #11: Enhance the Triggered Location for UE power saving
purpose
For key issue #11, it is concluded that solution#25 (Event Report in an
Allowed Area) is used as the baseline for normative work with the two
ambiguous aspects identified in clause 7.11 also being resolved in the
normative phase.
## 8.12 Key Issue #12: support of low power and/or high accuracy positioning
The following aspects are concluded for normative work:
\- UDM is enhanced to include LPHAP indication in the UE LCS subscription
data.
\- During the positioning procedure, AMF provides the LPHAP indication to the
LMF, either obtaining from the GMLC, or in the UE LCS context which received
during UE registration procedure.
\- LMF is enhanced to receive from AMF of the LPHAP indication in the location
request, and determine positioning method, by taking into account the LPHAP
requirement. LMF also sends LPHAP indication to RAN in the NRPPa message.
NOTE: RAN impact needs to coordinate with RAN WG, e.g. whether LPHAP
indication needs to be sent to RAN at an earlier time, before positioning
procedure is triggered.
#