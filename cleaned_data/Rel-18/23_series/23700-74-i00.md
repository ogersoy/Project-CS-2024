# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, certain modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
NOTE 1: The constructions \"shall\" and \"shall not\" are confined to the
context of normative provisions, and do not appear in Technical Reports.
NOTE 2: The constructions \"must\" and \"must not\" are not used as
substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as
possible, and they are not used in a normative context except in a direct
citation from an external, referenced, non-3GPP document, or so as to maintain
continuity of style when extending or modifying the provisions of such a
referenced document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
NOTE 3: The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
NOTE 4: The constructions \"can\" and \"cannot\" shall not to be used as
substitutes for \"may\" and \"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
NOTE 5: The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The scope of this Technical Report is to study potential enhancements on
generic group management, exposure and communication. Specifically, the
following aspects are in the scope of the study:
\- Enhance group attribute management and group status event reporting:
\- set/modify the group attributes: provisioning of service area or QoS
applicable to each UE of a given group;
\- subscribe to group status event reporting for the event \"newly registered
or (de)-registered group member\".
\- Study whether and how to enhance NEF exposure framework to enable
capability exposure for provisioning of traffic characteristics and monitoring
of performance characteristics applicable to each UE of a given group.
\- Support group communication for a 5G VN, which supports multiple SMFs,
including support of SMF redundancy for reliability of the 5G VN group
communication.
\- Whether additional mechanism or enhancement is needed and how to support
group communication allowing UE to simultaneously send data to different
groups, where each group has a different QoS policy (requirement regarding
5SEI as indicated in clause 6.13.2 of TS 22.261 [6]).
# 2 References
The following documents contain provisions, which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G system, Stage 2\".
[4] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G
System\".
[5] 3GPP TS 22.104: \"Service requirements for cyber-physical control
applications in vertical domains\".
[6] 3GPP TS 22.261: \"Service requirements for next generation new services
and markets\".
[7] 3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".
[8] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support
network data analytics services\".
[9] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[10] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[11] 3GPP TS 29.505: \"5G System; Usage of the Unified Data Repository
services for Subscription Data; Stage 3\".
[12] 3GPP TS 29.510: \"5G System; Network function repository services; Stage
3\".
[13] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
nodes\".
[14] 3GPP TS 23.527: \"5G System; Restoration procedures\".
# 3 Definitions of terms and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1], in
TS 23.501 [2] and in TS 23.502 [3] apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in TR
21.905 [1].
The following definitions of terms are copied from TS 23.501 [2]:
**5G LAN-type Service:** A service over the 5G system offering private
communication using IP and/or non-IP type communications.
**5G LAN-Virtual Network:** A virtual network over the 5G system capable of
supporting 5G LAN-type service.
**5G VN Group:** A set of UEs using private communication for 5G LAN-type
service.
**Private communication:** A communication between two or more UEs belonging
to a restricted set of UEs.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], in TS 23.501 [2] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in TR 21.905 [1].
5G LAN 5G Local Area Network
5G VN 5G LAN-Virtual Network
# 4 Architectural Assumptions and Requirements
## 4.1 Architectural Assumptions
The NEF exposure framework as in TS 23.501 [2] is the baseline for study of 5G
capabilities exposure for industrial and automation applications.
The QoS and policy framework as in TS 23.501 [2] is used for enforcement of
QoS applicable to each UE of a given group.
Existing QoS mechanism and service area mechanism are re-used for enforcement
of service area or QoS applicable to each UE of a given group, thus neither
new QoS nor service area enforcement mechanism will be specified.
Architecture and functions defined for 5G LAN-type service in clauses 4.4.6,
5.8.2.13 and 5.29 of TS 23.501 [2] are used as the baseline for 5G VN group
communication enhancements.
Unstructured PDU Session type is out of scope for this study.
## 4.2 Architectural Requirements
The solutions for this study will describe what kind of group the solution is
targeting (e.g. 5G VN group, or a group UE identified by External Group ID, or
a group UE identified Internal Group ID, or a group UE identified by address
(multicast/broadcast address) or any other form of group).
# 5 Key Issues
## 5.1 Key Issue #1: Enhance group attribute management
### 5.1.1 Description
**Based on the scope of this study, a group can be set with service area or
QoS that is applicable to each UE within the group.**
NOTE: UE can belong to multiple groups concurrently.
**Release-17 specifications including TS 23.501 [2] and TS 23.502 [3] already
provides enforcement mechanisms of \"Service Area\" attribute and these
depends on the particular service. For example:**
\- Service area restrictions: service area restrictions mechanism is per UE
and enforced in AMF and UE. The UE that is in non-allowed area is not allowed
to initiate Service Request, or have user plane connectivity etc. as described
in clause 5.3.4.1 of TS 23.501 [2].
\- LADN: LADN service area applies to any PDU Session to the given DNN. LADN
service area is enforced in SMF. The UE that is out of LADN service area
cannot access any services of the given DNN.
\- Spatial validity in Traffic Influence for Edge services: Spatial validity
is enforced in SMF. The UE that is out of spatial validity area can access the
service via C-PSA. \"Service Area\" for a group of UEs using an Edge service
is already supported by the existing spatial validity mechanism. A mechanism
for the AF to create and modify Edge user groups on temporary basis is out of
scope of this key issue.
**This key issue** aims at addressing the following points:
\- How to provision (i.e. set, modify and delete) the service area or QoS
applicable to each UE of the group via exposure interface, i.e.:
\- What is the information that constitutes the service area applicable to
each UE of the group via the exposure interface, and how to enforce the
service area applicable to each UE of the group by reusing the existing
mechanisms;
\- What is the information that constitutes the QoS applicable to each UE of
the group, and how to enforce the QoS applicable to each UE of the group using
existing mechanisms.
## 5.2 Key Issue #2: Enhance group status event reporting
### 5.2.1 Description
The study item includes objectives to enhance group status event reporting in
order to allow subscription to group status event reporting for the event
\"newly registered or (de)-registered group member\". To enable this, this key
issue aims at addressing the following points:
\- How to enable the group status event reporting via exposure interface,
i.e.:
\- What is the subscription information for the event \"newly registered or
(de)-registered group member\";
\- What is the trigger to detect such event;
\- What is the information within the event reporting to reflect the changes
of group status.
## 5.3 Key Issue #3: NEF exposure framework for provisioning of traffic
characteristics and monitoring of performance characteristics
### 5.3.1 Description
The objective of this Key Issue is to study the potential enhancement needs
for the NEF exposure framework to enable capability exposure for provisioning
of traffic characteristics and monitoring of performance characteristics
applicable to each UE of a given group. NEF framework shall allow the external
applications to subscribe to events of UEs forming the group.
For monitoring of performance characteristics applicable to each UE of a given
group the exposure framework shall support on-demand, periodic and event-
triggered monitoring for each UE that is part of a group of UEs. For event-
triggered monitoring, there shall be possible to define the triggering
event(s) or parameter threshold(s) valid for all monitored UEs (that are part
of a group).
The key issue will study:
\- What enhancements are needed for the defined Network Exposure procedures
and NEF Services;
\- How to use the NEF exposure framework to configure traffic characteristics
applicable to each UE of a given group;
\- How to use the NEF exposure framework to monitor performance
characteristics applicable to each UE of a given group;
\- Which traffic characteristics (e.g. transfer interval, data volume per
cycle time, average and peak date rates, silence time interval, and PDU
Session Type) are relevant for 5GS;
\- Which performance characteristics (e.g. communication service availability,
communication service reliability, end-to-end latency, service bit rate and
packet error rate) are relevant to be monitored.
NOTE 1: See 5G-ACIA White Paper (Exposure of 5G Capabilities for Connected
Industries and Automation Applications, February 2021), clause 5 and Annex C
of TS 22.104 [5] for more examples of traffic characteristics and performance
characteristics.
NOTE 2: This key issue focuses on exposure enhancements. No new enforcement
mechanisms will be specified as part of this key issue.
## 5.4 Key Issue #4: Multiple SMFs for VN group communication
### 5.4.1 Description
There is a restriction on the Rel-16 5G VN group communication session
management, \"A dedicated SMF is responsible for all the PDU Sessions for
communication of a certain 5G VN group\".. Rel-18 work aims at supporting
reliability of the 5G VN group communication as well as the case where a 5G VN
spans over a large area and different UE group member accesses to the 5G VN at
different locations, . When multiple SMFs are involved to serve a 5G VN group,
multiple UPFs controlled by these SMFs might be involved to enable 5G VN group
communication of the 5G VN group.
For this Key Issue, it will be studied how to support multiple SMFs to serve
PDU Sessions of a 5G VN group, including:
\- Support of SMF redundancy for reliability of the 5G VN group communication;
\- Which architectural enhancements, if any, are needed to enable the support
of multiple SMFs to serve a 5G VN group; this may include:
\- How to manage session management when multiple SMFs are involved to serve a
5G VN group where the UE group members are connected to multiple UPFs
controlled by these SMFs;
\- How to manage communication among the UE group members when they are served
by different UPFs and different SMFs including the case of UE(s) mobility,
this needs to take the signalling scalability issues for large VN groups with
lots of devices into account.
It is assumed that each solution will describe assumptions on UPF deployment
topology, if any. New solution targeting KI#4 should take the Rel-16
compatibility issue into account.
## 5.5 Key Issue #5: Allowing UE to simultaneously send data to different
groups with different QoS policy
### 5.5.1 Description
This key issue will study whether additional mechanisms or enhancement are
needed to support group communication allowing a UE to simultaneously send
data to different groups where each group has a different QoS policy and if
yes how to.
# 6 Solutions
## 6.0 Mapping of Solutions to Key Issues
Table 6.0-1: Mapping of Solutions to Key Issues
              Key Issues
* * *
Solutions #1 #2 #3 #4 #5 #1 X  
#2 X  
#3 X  
#4 X  
#5 X  
#6 X #7 X #8 X  
#9 X  
#10 X  
#11 X  
#12 X  
#13 X  
#14 X  
#15 X  
#16 X  
#17 X #18 X  
#19 X  
#20 X  
#21 X  
#22 X
## 6.1 Solution #1: Support for service area group attribute
### 6.1.1 Introduction
This solution aims to address the key issues #1: enhance group attribute
management, it addresses particularly how to set or modify the service area
group attribute for a 5G VN group.
### 6.1.2 Functional Description
To address how to set or modify the service area group attribute for a 5G VN
group, this solution follows the principles below:
\- The parameter provisioning service can be re-used to configure or update
the group membership information of a 5G VN group as defined in clause
4.15.6.3c of TS 23.502 [3] to UDM, and UDM manages the group membership
information as part of the group subscription data.
\- Enhance the parameter provisioning service by introducing the service area
information as a new input parameter, and this service area information is
stored as part of the group data in group subscription data.
\- AMF can retrieve from UDM the group subscription data as \"Subscription
Data, Group Data\" data type using Nudm_SDM_Get, or the AMF can be notified by
UDM the group subscription data as \"Subscription Data, Group Data\" data type
using Nudm_SDM_Notification. With the group subscription data, the AMF can
transform the service area group attribute to service area per UE group member
(Group Service Area) using the registration area of the registered UE group
member.
\- If the UE supports LADN per DNN and S-NSSAI, the UE can send the LADN per
DNN and S-NSSAI indication to AMF during registration procedure. If the AMF
receives the LADN per DNN and S-NSSAI indication from UE, the AMF can
configure UE with the Group Service Area, otherwise, the AMF does not. In both
cases, the AMF knows whether the DNN and S-NSSAI of the PDU Session is
associated with the 5G VN group, and further informs SMF of whether UE is IN
or OUT of the Group Service Area during PDU Session establishment or in UE
mobility event notification, the UE and SMF then take actions same as Local
Area Data Network (LADN) mechanism as specified in clause 5.6.5 of TS 23.501
[2].
\- AMF can determine UE presence in Group Service Area and provide the UE
mobility related event reporting to SMF using UE mobility event notification
as defined in clause 5.3.4.4 of TS 23.501 [2].
Figure 6.1.2-1 depicts the architecture to support service area group
attribute:
Figure 6.1.2-1: Architecture to support service area group attribute
**AF:** Application Function that interacts with NEF to dynamically create,
update or release a group with service area group attribute and group
membership.
**NEF:** 5G capabilities exposure function that supports interacting with AF
for management of a group with service area group attribute and group
membership, and interacting with UDM to update the group subscription data
including service area information and group membership. It can also transform
the geographical area received from AF into a list of TAI or cell ID.
**UDM:** Based on NEF request, it manages the group subscription data
including service area information and group membership via interacting with
UDR. It can also provide AMF or SMF with the group subscription data including
service area information and group membership as \"Subscription Data, Group
Data\" data type via Nudm_SDM_Get or Nudm_SDM_Notification.
NOTE 1: UDM manages 5G VN group data as \"Subscription Data, Group Data\" and
UDM provides AMF or SMF with \"Subscription Data, Group Data\" using the
Shared Data feature (nudm-sdm/v2/shared-data service API) as defined in TS
29.503 [7].
**UDR:** Storage of the group subscription data including service area
information and group membership. It can also provide AMF or SMF with the
group subscription data as \"Subscription Data, Group Data\" data type using
Nudr_DM_Query or Nudr_DM_Notify.
NOTE 2: UDR manages 5G VN group data as \"Subscription Data, Group Data\" and
UDR provides PCF with \"Subscription Data, Group Data\" using nudr-
dr/v2/subscription-data/group-data/5g-vn-groups service API as defined in TS
29.505 [11].
**AMF:** It is responsible to transform the service area information received
in group subscription data to service area per UE group member (Group Service
Area) using the registration area of the registered UE group member, and
configure UE with the Group Service Area if the AMF receive UE\'s LADN per DNN
and S-NSSAI indication. It is also responsible to detect that the UE is \"IN\"
or \"OUT\" of the Group Service Area and inform SMF about this during PDU
Session establishment or in UE mobility event notification.
**UE:** If the UE supports LADN per DNN and S-NSSAI, it can be provisioned
with the Group Service Area and determines whether it is in or out of the
Group Service Area. Then it takes actions as defined for LADN, i.e. UE
behaviour is based on LADN as defined in Rel-17 specifications without any
changes.
**SMF:** SMF can be informed by AMF that the UE is \"IN\" or \"OUT\" of the
Group Service Area via subscribing to UE mobility event notification for the
corresponding group and takes actions as defined for LADN.
### 6.1.3 Procedures
Figure 6.1.3-1 outlines the procedure for support of service area group
attribute.
Figure 6.1.3-1: Procedures for support of service area group attribute
1\. The AF provides information (Group ID, Group Data, and Group Membership)
of a group to be created or updated in Nnef_ParameterProvision_Create or
Nnef_ParameterProvision_Update to create.
Group ID identifies the 5G VN Group.
Group Data contains the DNN, S-NSSAI and Service Area Information for the
group.
Group Membership contains a list of UE identities that uniquely identify the
group member.
2\. The NEF requests to create or update group subscription data (External
Group ID, Group Data, and Group Membership) via Nudm_ParameterProvision_Create
or Nudm_ParameterProvision_Update.
The NEF can transform the Service Area Information expressed in geographical
area into Service Area Information expressed in a list of TAI or cell ID.
3\. The UDM may read from UDR, by means of Nudr_DM_Query, corresponding group
subscription data in order to validate required data updates and authorize
these changes for group for the corresponding AF.
4\. The UDM updates the UE subscription data and/or group subscription data,
and requests to create or update UE subscription data and/or group
subscription data via Nudr_DM_Create/Update.
5\. The UDM responds the NEF with Nudm_ParameterProvision_Create/Update
Response.
6\. The NEF responds the AF with Nnef_ParameterProvision_Create/Update
Response.
7\. The UDM provides group subscription data to AMF or SMF as \"Subscription
Data, Group Data\" data type via Nudm_SDM_Notification or Nudm_SDM_Get.
The UDM can provide the AMF with the group subscription data via
Nudm_SDM_Notification when there are UE group member(s) already registered via
the AMF or via Nudm_SDM_Get Response when the first UE group member is
registering via the AMF.
The UDM can provide the SMF with the group subscription data via
Nudm_SDM_Notification when there are ongoing PDU Session(s) accessing the
group established via the SMF or via Nudm_SDM_Get Response when the first PDU
Session accessing the group is going to be established via the SMF.
8\. The UDR provides group subscription data to PCF as \"Subscription Data,
Group Data\" data type via Nudr_DM_Query or Nudr_DM_Notify. The PCF updates
URSP rules to the registered UE group member, if needed.
9\. The AMF transforms the service area information received in group
subscription data to service area per UE group member (Group Service Area,
i.e. DNN, S-NSSAI, a list of TAIs) using the registration area of the
registered UE group member.
If the UE supports LADN per DNN and S-NSSAI, the UE can send the LADN per DNN
and S-NSSAI indication to AMF during registration procedure. If the AMF
receives the LADN per DNN and S-NSSAI indication from UE, the AMF can
configure UE with the Group Service Area via Registration or UE Configuration
Update procedure otherwise, the AMF does not, and step 10 is skipped.
10\. The UE behaves similar with mechanism defined for LADN as defined in
clause 5.6.5 of TS 23.501 [2]. When the UE is in a Group Service Area, the UE
can send NAS SM request to the network.
a) When the UE is out of a Group Service Area, the UE:
\- shall not request to activate UP connection of a PDU Session for the
corresponding DNN, S-NSSAI;
\- shall not establish/modify a PDU Session for the corresponding DNN, S-NSSAI
(except for PS Data Off status change reporting for an established PDU
Session);
\- need not release any existing PDU Session for the corresponding DNN,
S-NSSAI unless UE receives explicit SM PDU Session Release Request message
from the network.
b) When the UE is in a Group Service Area, the UE:
\- may request a PDU Session Establishment/Modification for the corresponding
DNN, S-NSSAI;
\- may request to activate UP connection of the existing PDU Session for the
corresponding DNN, S-NSSAI.
11\. When receiving NAS SM request with the DNN, S-NSSAI associated with the
group, the AMF determines UE presence in Group Service Area and forwards it to
the SMF.
12\. When receiving NAS SM request with the DNN, S-NSSAI associated with the
group, the SMF determines UE presence in Group Service Area based on the
indication received from the AMF. The SMF shall also subscribe to \"UE
mobility event notification\" for reporting UE presence in Area of Interest by
providing DNN, S-NSSAI associated with the group to the AMF as described in
clauses 5.6.11 and 5.3.4.4 of TS 23.501 [2]. The UE behaves similar with
mechanism defined for LADN as defined in clause 5.6.5 of TS 23.501 [2].
a) When SMF is informed that the UE presence in a Group Service Area is OUT,
the SMF shall:
\- release the PDU Session immediately; or
\- deactivate the user plane connection for the PDU Session with maintaining
the PDU Session and ensure the Data Notification is disabled and the SMF may
release the PDU Session if the SMF is not informed that the UE moves into the
LADN service area after a period.
b) When SMF is informed that the UE presence a Group Service Area is IN, the
SMF shall:
\- ensure that Data Notification is enabled.
\- trigger the Network triggered Service Request procedure for a PDU Session
accessing the group to active the UP connection when the SMF receives downlink
data or Data Notification from UPF.
c) When the SMF is informed that the UE presence in a Group Service Area is
UNKNOWN, the SMF may:
\- ensure that Data Notification is enabled.
\- trigger the Network triggered Service Request procedure for a PDU Session
accessing the group to active the UP connection when the SMF receives downlink
data or Data Notification from UPF.
13\. Finish rest of the Session Management procedures as defined in clause 4.3
of TS 23.502 [3].
### 6.1.4 Impacts on existing entities and interfaces
NEF/UDM: The parameter provisioning service can support service area
information as a new input parameter for management of a 5G VN group.
UDM/UDR: The group subscription data can contain 5G VN group membership
information and 5G VN group data including the service area information.
AMF: The AMF can transform the service area information received in the group
subscription data to service area per UE group member (Group Service Area)
using the registration area of the registered UE group member. If the AMF
receives LADN per DNN and S-NSSAI indication from UE it can configure UE with
the Group Service Area along with the associated DNN and S-NSSAI. The AMF can
detect that the UE is \"IN\" or \"OUT\" of the Group Service Area and inform
SMF about this during PDU Session establishment or in UE mobility event
notification.
UE: If the UE supports LADN per DNN and S-NSSAI, it can send the LADN per DNN
and S-NSSAI indication to AMF during registration request. With the Group
Service Area along with the associated DNN and S-NSSAI, the UE behaves as same
as Rel-17 LADN.
SMF: With the information received from AMF that the UE is \"IN\" or \"OUT\"
of the Group Service Area, the SMF takes actions as same as Rel-17 LADN.
## 6.2 Solution #2: New NEF service for connection management for a group
### 6.2.1 Introduction
This solution aims to address the key issue #3: NEF exposure framework for
provisioning of traffic characteristics and monitoring of performance
characteristics, particularly it introduces a new NEF service to address how
to use the NEF exposure framework to configure traffic characteristics
applicable to each UE of a given group, and how to use the NEF exposure
framework to monitor performance characteristics applicable to each UE of a
given group.
The solution assumes that the group membership information (e.g. list of UE
ID) of a group is already stored in the UDM/UDR via OAM configuration or NEF
Parameter Provisioning service request, and will investigate the following
traffic characteristics for this group:
\- Transfer interval: Time difference between two consecutive transfers of
application data from an application via the service interface to 3GPP system.
It indicates the time elapsed between any two consecutive messages delivered
by the automation application to the ingress of the 3GPP system. Applicable
only to periodic communication.
\- Data volume per cycle time: Largest data volume within a cycle i.e. one
transmission occurred every transfer interval.
\- Average and peak data rates: Indicate the expected target data rate and
maximum data rate of a connection during a given time window.
\- Silence time interval: Indicate the time period when an established
connection will not carry any user payload (e.g. at night or on weekends).
\- PDU Session Type: Indicate the target PDU Session Type (e.g. Ethernet or
IP) for an established connection.
The solution will investigate the following performance characteristics:
\- End-to-end latency: The time that it takes to transfer a given piece of
information from a source to a destination, measured at the communication
interface, from the moment it is transmitted by the source to the moment it is
successfully received at the destination. This parameter indicates the time
allotted to the communication system for transmitting a message and the
permitted timeliness. Maximum and average End-to-end latency are investigated
in this solution.
\- Service bit rate: In the context of deterministic communication, this
indicates committed data rate sought from the communication service. This is
the minimum data rate the communication system guarantees to provide at any
time.
\- Packet error rate: The Packet Error Rate (PER) defines an upper bound for
the rate of PDUs (e.g. IP packets) that have been processed by the sender of a
link layer protocol (e.g. RLC in RAN of a 3GPP access) but that are not
successfully delivered by the corresponding receiver to the upper layer (e.g.
PDCP in RAN of a 3GPP access). Thus, the PER defines an upper bound for a rate
of non-congestion related packet losses.
\- CSA: Indicate the percentage value of the amount of time the end-to-end
communication service is delivered according to a specified QoS, divided by
the amount of time the system is expected to deliver the end-to-end service.
The latency distribution condition e.g. request guaranteed percentage value or
request guaranteed E2E latency are investigated in this solution.
\- CSR: This parameter states the mean value of how long the communication
service is available before it becomes unavailable, or the ability of the
communication service to perform without failures as required for a given time
interval, under given conditions. The failures and mean time condition e.g.
mean time between failures or probability value of no failure are investigated
in this solution.
### 6.2.2 Functional Description
This solution introduces a new NEF service, this new service supports
provisioning of traffic characteristics applicable to each UE of a given
group, and monitoring of performance characteristics applicable to each UE of
a given group.
The following are the main principles of the solution:
\- Via this new NEF service, the AF can provide NEF with the information
targeting to a group in order to influence the user plane connection of each
group member\'s PDU Session for packet transmission within 5GC.
NOTE 1: The NEF service in this solution can be designed as a clean new
service to decouple with existing services or implemented by enhancing
existing NEF services, e.g. Nnef_AFsessionWithQoS or Nnef_ParameterProvision.
Whether to use new service or enhance existing services can be evaluated and
concluded later.
NOTE 2: The user plane connection for the PDU Session provides exchange of
PDUs between a UE and a Data Network, and maps to UE-to-data-network (UN) type
\"device connectivity\" used in 5G-ACIA White Paper (Exposure of 5G
Capabilities for Connected Industries and Automation Applications, February
2021).
\- NEF can query UDM/UDR with the group ID to retrieve the group membership
information, and then transforms the information targeting to a group (e.g.
traffic characteristics to be configured or performance characteristics to be
measured) to information for each UE group member. Additionally, the NEF can
send the information targeting to a group as part of the group subscription
data (e.g. group QoS) stored to UDM for management.
\- For traffic characteristics to be configured for each UE group member, the
PCF or TSCTSF can obtain such traffic characteristics from NEF or UDM/UDR,
then PCF or TSCTSF performs mapping between the traffic characteristics to be
configured and 5GS QoS parameters, and triggers PCF initiated SM Policy
Association Modification/ Termination.
\- If transfer interval is one parameter within the traffic characteristics to
be configured, the AF can map the transfer interval to periodicity and provide
mapped periodicity to TSCTSF via NEF using existing mechanism as defined in
clause 6.1.3.22 of TS 23.503 [4]. Alternatively, the AF can directly provide
transfer interval to TSCTSF via NEF and then TSCTSF can map the transfer
interval to periodicity, the TSCTSF can deliver the mapped periodicity in
TSCAC using existing mechanism as defined in clause 5.27.2.3 of TS 23.501 [2].
\- If data volume per cycle time is one parameter within the traffic
characteristics to be configured, the AF can map the data volume per cycle
time to Maximum Burst Size and provide mapped Maximum Burst Size to TSCTSF via
NEF using existing mechanism as defined in clause 6.1.3.22 of TS 23.503 [4].
Alternatively, the AF can directly provide data volume per cycle time to
TSCTSF via NEF and then TSCTSF can map the data volume per cycle time to
Maximum Burst Size, the TSCTSF can deliver the mapped Maximum Burst Size to
PCF as defined in clause 6.1.3.22 of TS 23.503 [4].
\- If average and peak data rates are parameters within the traffic
characteristics to be configured, the AF can map the average and peak data
rates to Requested Guaranteed Bitrate and Requested Maximum Bitrate
respectively, and provide the Requested Guaranteed Bitrate and Requested
Maximum Bitrate via NEF using existing mechanism as defined in clause 6.1.3.22
of TS 23.503 [4]. Alternatively, the AF can directly provide average and peak
data rates to TSCTSF via NEF and then TSCTSF can map the average and peak data
rates to Requested Guaranteed Bitrate and Requested Maximum Bitrate, the
TSCTSF can deliver the Requested Guaranteed Bitrate and Requested Maximum
Bitrate to PCF as defined in clause 6.1.3.22 of TS 23.503 [4].
\- If silence time interval is one parameter within the traffic
characteristics to be configured, the AF can map the silence time interval to
temporal invalidity condition and provide temporal invalidity condition to
TSCTSF via NEF. Alternatively, the AF can directly provide silence time
interval to TSCTSF via NEF and then TSCTSF can map the silence time interval
to temporal invalidity condition. The TSCTSF manages the temporal invalidity
condition (start-time, end-time), for example when the start-time is reached,
the TSCTSF initiates SM Policy Association Modification so to remove the QoS
Flow or de-activate the UP connection of a PDU Session as defined in clause
4.16.5.2 of TS 23.502 [3]; when the end-time is reached, the TSCTSF initiates
SM Policy Association Modification so to add a new QoS Flow or activate the UP
connection of a PDU Session as defined in clause 4.16.5.2 of TS 23.502 [3].
\- If PDU Session Type is one parameter within the traffic characteristics to
be configured, the AF should ensure that the requested PDU Session Type is
configured as part of the 5G VN group data e.g. via
Nnef_ParameterProvision_Create/Nnef_ParameterProvision_Update, so the UE group
members within the target group have subscription for the requested PDU
Session Type and have URSP rules configured for the requested PDU Session
Type. In the case that there are more than one PDU Session Types for a 5G VN
group, the AF can manipulate the order of the requested PDU Session Type in 5G
VN group data via
Nnef_ParameterProvision_Create/Nnef_ParameterProvision_Update to influence the
setting with precedence value at PCF when generating URSP rules, this is to
ensure that URSP rule for the requested PDU Session Type has higher precedence
value than the URSP rules for other PDU Session Type(s) of the 5G VN group. If
the PCF/SMF receives the requests to update the PDU Session type for an
ongoing PDU Session and the requested PDU Session type is authorized for the
UE or 5G VN group, then SMF sends PDU Session Release COMMAND to UE indicating
that re-establishment of the PDU Session is required, so the UE will re-
establish the PDU Session using URSP rules for the requested PDU Session Type
which has higher precedence value than the URSP rules for other PDU Session
Type(s) of the 5G VN group.
NOTE 3: There is only one subscribed PDU Session Type in use for a 5G VN group
at a time.
\- For performance characteristics to be measured for each UE group member,
the PCF or TSCTSF can obtain such information from NEF or UDM/UDR, and
trigger, e.g. for QoS Notification Control (QNC) or QoS Monitoring for URLLC.
\- If maximum end-to-end latency is one parameter within performance
characteristics to be measured, the AF can map the maximum end-to-end latency
to Requested 5GS Delay and provide Requested 5GS Delay to TSCTSF via NEF using
existing mechanism as defined in clause 6.1.3.22 of TS 23.503 [4].
Alternatively, the AF can directly provide maximum end-to-end latency to
TSCTSF via NEF and then TSCTSF can map the maximum end-to-end latency to
Requested 5GS Delay, the TSCTSF can calculate the Requested PDB using
Requested 5GS Delay and deliver the Requested PDB using existing mechanism as
defined in clauses 4.15.6.6 and 4.15.6.6a of TS 23.502 [3]. The PCF knows that
Requested PDB is to be monitored, then the PCF triggers QoS Notification
Control for Requested 5GS PDB. When the Requested 5GS PDB is no longer
fulfilled , the RAN reports that the \" PDB can no longer be guaranteed\",
additionally along with the measured PDB.
\- If average end-to-end latency is one parameter within performance
characteristics to be measured, QoS Monitoring for URLLC as defined in clause
6.1.3.21 of TS 23.503 [4] can be re-used.
\- If service bit rate is one parameter within performance characteristics to
be measured, the AF can map the service bit rate to Requested Guaranteed
Bitrate, and provide the Requested Guaranteed Bitrate using existing mechanism
as defined in clause 6.1.3.22 of TS 23.503 [4]. Alternatively, the AF can
directly provide service bit rate to TSCTSF via NEF and then TSCTSF can map
the service bit rate to Requested Guaranteed Bitrate, the TSCTSF can deliver
the Requested Guaranteed Bitrate to PCF as defined in clause 6.1.3.22 of TS
23.503 [4]. The PCF knows that Requested Guaranteed Bitrate is to be
monitored, then the PCF triggers QoS Notification Control for Requested
Guaranteed Bitrate. When the Requested Guaranteed Bitrate is no longer
fulfilled , the RAN reports that the \"GFBR can no longer be guaranteed\",
additionally along with the measured flow bit rate.
\- If packet error rate is one parameter within performance characteristics to
be measured, the AF can provide the Requested packet error rate as one
parameter in Individual QoS parameters as defined in clause 6.1.3.22 of TS
23.503 [4]. The PCF knows that Requested packet error rate is to be monitored,
then the PCF triggers QoS Notification Control for Requested packet error
rate. When the Requested packet error rate is no longer fulfilled , the RAN
reports that the \"PER can no longer be guaranteed\", additionally along with
the measured packet error rate.
\- If CSA is one parameter within performance characteristics to be measured,
AF may subscribe latency distribution condition (e.g. the cumulative
distribution function indicating the relationship between latency and
percentage value the service is delivered) to NWDAF via NEF. NWDAF may collect
data, e.g. the monitored E2E latency (according to the communication service
interface between distribution automation application and 5G system) that can
or can not fulfil a specified QoS. Then NWDAF may analyse and report the
subscribed result to AF. Alternatively, AF may subscribe a request guaranteed
percentage value in a certain required latency or a request guaranteed E2E
latency in a required guaranteed percentage value for CSA to NWDAF via NEF.
Then NWDAF will analyse and report the corresponding guaranteed percentage
value or guaranteed E2E latency in statistics for AF.
\- If CSR is one parameter within performance characteristics to be measured,
AF may subscribe failure condition (e.g. indicating failures and mean time
relationship) to NWDAF via NEF. NWDAF may collect data, e.g. the duration time
between two failures. Then NWDAF may analyse and report the subscribed result
to AF. Alternatively, AF may subscribe a request mean time between failures or
a request probability of no failure within a specified period of time for CSR
to NWDAF via NEF. Then NWDAF will analyse and report the corresponding mean
time value or probability value of no failure in statistics for AF.
\- If the information targeting to a group is for user plan connection between
two UEs, then the AF can initiate or later update AF request respectively for
UL UE-UE traffic and/or DL UE-UE traffic with the unmodified information
targeting to a group except the end-to-end latency:
\- The AF sets the 1/2 end-to-end latency as Requested 5GS Delay respectively
for UL UE-UE traffic and/or DL UE-UE traffic.
\- The AF subscribes to QoS Notification Control (QNC) or QoS Monitoring for
URLLC respectively for UL UE-UE traffic and/or DL UE-UE traffic.
\- The AF adjusts the Requested 5GS Delay respectively for UL UE-UE traffic
and/or DL UE-UE traffic based on end-to-end latency and the reporting for QoS
Notification Control (QNC) or QoS Monitoring for URLLC.
\- When performance characteristics to be measured indicates continuous
reporting (e.g. periodic reporting or event based reporting) along with
certain parameters (periodic time interval, Group Reporting Guard time,
threshold value, Maximum number of reports, or Maximum duration of reporting),
the NEF performs the aggregation of the event reporting about performance
characteristics to be measured for each UE group member, namely NEF buffers or
stores the event reports related with the UEs in a group before the certain
condition is met (e.g. expiry of periodic timer or Group Reporting Guard
timer, threshold is reached, subscription becomes invalid when Maximum number
of reports is reached or Maximum duration of reporting is expired). Once the
certain condition is met, the NEF sends this aggregated reporting (Group ID,
list of UE IDs and Event Reporting information for the affected group members)
to AF as achieved performance for performance characteristics to be measured.
\- For example, maximum end-to-end delay including delay needs be aggregated
to get the max among the aggregated data. In this case, only the maximum value
is needed, so the maximum value needs to be reported to AF without the whole
list end-to-end delays. When the AF request performance monitoring with data
aggregation method and data transfer condition, the NEF provides aggregated
reporting.
NOTE 4: It is assumed that event subscription at PCF for each group member for
QoS Notification Control (QNC) or for QoS Monitoring for URLLC only needs
immediate event based reporting (only the Event Reporting mode and the
immediate reporting flag in Event Reporting Information defined in Table
4.15.1-1 of TS 23.502 [3] are applicable).
Figure 6.2.2-1 depicts the architecture to support connection management for a
group:
Figure 6.2.2-1: Architecture to support connection management for a group
**AF:** Application Function that interacts with NEF to control (establish,
modify, terminate, monitor) the user plane connection of each group member\'s
PDU Session for packet transmission within 5GC. AF can support division of
end-to-end latency for UE-UE traffic. AF can manipulate the order of the
requested PDU Session Type in 5G VN group data via
Nnef_ParameterProvision_Create/Nnef_ParameterProvision_Update to influence the
setting with precedence value at PCF when generating URSP rules.
**NEF:** 5G capabilities exposure function that supports interacting with AF
in order for AF to influence the user plane connection of each group member\'s
PDU Session for packet transmission within 5GC. It can also query UDM/UDR with
the group ID to retrieve the group membership information, and then transform
the information target to a group to information for each UE group member, as
well as interact with PCF (via TSCTSF) to request network resources for the
user plane connection. It also performs the aggregation of the monitoring
reports for each UE group member. Additionally, the NEF can send the
information targeting to a group as part of the group subscription data (e.g.
group QoS) to UDM for management.
**UDM/UDR:** Storage of the group subscription data and group membership
information.
**NWDAF: Performs** network data analytics and exposes the analytics to AF via
NEF as requested.
**PCF:** Perform mapping between traffic characteristics to be configured and
5GS QoS parameters, and provides policy rules to Control Plane function(s) to
enforce them, e.g. TSCAI, QoS Notification Control (QNC) or QoS Monitoring for
URLLC. PCF can also support setting precedence value based on order of the PDU
Session Type in 5G VN group data when generating URSP rules.
**TSCTSF:** Provide Ntsctsf_QoSand TSCAssistance to allow handling for AF
requests with individual QoS parameters as described in clause 6.1.3.22 of TS
23.503 [4]. It can also map the traffic characteristics to be configured and
performance characteristics to be measured to existing QoS parameter. It may
also support division of end-to-end latency for UE-UE traffic.
### 6.2.3 Procedures
#### 6.2.3.1 Procedure to support connection management for a group
Figure 6.2.3.1-1: Procedure to support connection management for a group
1\. The AF provides information targeting to a group to influence the user
plane connection of each group member\'s PDU Session for packet transmission
within 5GC.
The information targeting to a group contains the Group ID, Flow Description,
traffic characteristics to be configured, and performance characteristics to
be measured.
2a. The NEF stores the information targeting to a group as part of the group
subscription data in UDM/UDR via invoking Nudm_SDM service. The TSCTSF can
retrieve the group subscription data from UDM/UDR during PDU Session
establishment procedure or be notified about the changes on group subscription
data by UDM/UDR if the TSCTSF subscribes to changes about the group
subscription data.
The TSCTSF maps the information targeting to a group to information targeting
to each group member using the group membership information.
2b. Alternatively, the NEF obtains group subscription information from UDM/UDR
using Group ID, the NEF maps the information targeting to a group to
information targeting to each group member using the group membership
information. Then NEF transfers the information targeting to each group member
to TSCTSF via Ntsctsf_QoSandTSCAssistance service.
3\. The TSCTSF invokes the Npcf_PolicyAuthorization service to transfer the
traffic characteristics to be configured and performance characteristics to be
measured to PCF. The TSCTSF may use GPSI and DNN/S-NSSAI information to
request BSF for getting PCF for the PDU session and the UE address(es).
The TSCTSF can process the traffic characteristics to be configured and
performance characteristics to be measured as described in clause 6.2.2.
4\. PCF updates the PCC rules and send the PCC rules to SMF via
Npcf_SMPolicyControl service.
The PCF can deduct the PCC rules (e.g. 5QI, PDB, GFBR, MFBR, MDBV, PER, TSCAC,
target PDU Session Type, QoS Monitoring for URLLC, QNC for PDB, QNC for PER,
QNC for GBR) using traffic characteristics to be configured and performance
characteristics to be measured received from TSCTSF.
5\. The SMF initiates the PDU Session Modification procedure to create/update
QoS Flows. If the PDU Session Type needs to be changed, then sends PDU Session
Release COMMAND to UE indicating that re-establishment of the PDU Session is
required.
6\. The SMF can receive the QNC notification (e.g. \"PDB can no longer be
guaranteed\", measured PDB) or notification for QoS Monitoring for URLLC if
corresponding QNC or QoS Monitoring for URLLC is requested.
7\. The SMF sends such notifications in step 6 to the PCF via
Npcf_SMPolicyControl service.
8\. The PCF sends such notifications in step 7 to the TSCTSF via
Npcf_PolicyAuthorization service.
9\. The TSCTSF sends such notifications in step 8 to the NEF via
Ntsctsf_QoSandTSCAssistance service. If the information targeting to a group
is for user plan connection between two UEs and TSCTSF performs division, the
TSCTSF can react to the notifications as described in clause 6.2.2 before
sending those notification to NEF.
10\. The NEF sends such notifications in step 9 to the AF via NEF service.
#### 6.2.3.2 Procedure to support CSA and CSR performance characteristics
monitoring
Figure 6.2.3.2-1: Procedure to support CSA and CSR performance characteristics
monitoring
Step 0\~2 utilizes existing procedure for CSA or CSR analytics subscribe by
AFs via NEF, as described in clause 6.1.1.2 of TS 23.288 [8].
\- If CSA performance characteristics analytics is required, AF may subscribe
latency distribution condition related information for UE (groups) to NWDAF
via NEF. E.g. AF may subscribe guaranteed percentage in a required latency of
10ms.
\- If CSR performance characteristics analytics is required, AF may subscribe
failure condition (e.g. indicating failures and mean time relationship) for UE
(groups) to NWDAF via NEF.
3\. NWDAF obtains UE groups subscription data.
4\. NWDAF requests for data collection via Npcf_EventExposure subscribe to PCF
for target UE (groups), with CSA or CSR analytics request in step one, and may
include a notification target address.
5\. PCC rules configure for the requested CSA or CSR analytics of step one,
e.g.
\- When AF subscribe guaranteed percentage in a required latency of 10ms for
CSA,PCF may set a rule of monitoring of E2E latency >10ms, indicating 5GS can
not fulfil a specified QoS of 10ms.
\- When AF subscribe a request mean time between failures for CSR, PCF may set
a rule of monitoring the starting and ending time of two failures.
6\. SM policy control update with requested performance monitoring.
7\. UPF collects the monitoring data. e.g. the E2E latency, the starting and
ending time of a failure of QoS enforcement.
8\. UPF reports the collected data to NWDAF by the notification target
address. It should be noted that CSA or CSR is not a real-time performance,
the granularity may be day, month, or year. So UPF may determine the report
frequency itself.
9\. NWDAF analyses the collected data. e.g. for CSA analysis, NWDAF takes
statistics in the E2E latency distribution and determine a relationship
between a guaranteed percentage and a required latency. For CSR analysis,
NWDAF takes statistics in the starting and ending time of every failure and
determine a mean time between failures or a probability of no failure within a
specified period of time for CSR.
10\~11. NWDAF reports the result of CSA or CSR analysis to AF.
### 6.2.4 Impacts on existing entities and interfaces
AF: provide the transfer interval, data volume per cycle time, the average and
peak data rates, the maximum end-to-end latency, the service bit rate,
Requested packet error rate, temporal invalidity condition (start-time, end-
time), target PDU Type, CSA or CSR analytics in AF request. AF can support
division of end-to-end latency for UE-UE traffic. AF can manipulate the order
of the requested PDU Session Type in 5G VN group data to influence the setting
with precedence value at PCF when generating URSP rules.
NEF: query UDR with the group ID to retrieve the group subscription data, and
then transform the information target to a group to information for each UE
group member.
TSCTSF: map the transfer interval to periodicity, map the data volume per
cycle time to Maximum Burst Size, map the average and peak data rates to
Requested Guaranteed Bitrate and Requested Maximum Bitrate, map the maximum
end-to-end latency to Requested 5GS Delay, map the service bit rate to
Requested Guaranteed Bitrate, and manage the temporal invalidity condition
(start-time, end-time). It may support division of end-to-end latency for UE-
UE traffic.
SMF: authorizes the AF request to change PDU Type for the PDU Sessions of UE
group member for a group. The SMF sends PDU Session Release COMMAND to UE
indicating that re-establishment of the PDU Session is required.
PCF: triggers QoS Notification Control for Requested 5GS PDB or Requested
Guaranteed Bitrate or Requested packet error rate respectively. PCF can also
support setting precedence value based on order of the PDU Session Type in 5G
VN group data when generating URSP rules.
RAN: When the Requested 5GS PDB or Requested Guaranteed Bitrate or Requested
packet error rate is no longer fulfilled, the RAN reports that the \"PDB can
no longer be guaranteed\" along with the measured PDB, or \"GBR can no longer
be guaranteed\" along with the measured bit rate, or \"PER can no longer be
guaranteed\" along with the measured packet error rate.
NWDAF: collect data from NFs and derive the CSA or CSR analytics for AF
request, and exposes the analytics to AF via NEF as requested.
UPF: data collection and report to NWDAF.
## 6.3 Solution #3: use of SMF sets for 5G VN group communications.
### 6.3.1 Introduction
This solution addresses KI 4.
### 6.3.2 Functional Description
The Support of group communication for a 5G VN needs to ensure
\- SMF redundancy for the reliability of the 5G VN group communications,
\- Support of 5G VN groups with UE(s) spread over a large country.
Such redundancy can be provided by the SMF set feature that has been supported
by 5GC since Rel-16.
Any inter SMF interactions related with intra SMF set co-ordination about a 5G
VN group ( e.g. on the control of the N19 tunnel between the UPF(s) involved
in a 5G VN group communication) is left outside the scope of 3GPP
specifications.
NOTE: This solution does not assume that 5G VN group communication only
happens in a local area, e.g. involving the same unique data centre as a SMF
Set may be deployed across multiple sites/data centres. Furthermore, to handle
5G VN groups with UE spread over a large country, I-SMF may be used to connect
remote UE(s) to the (unique) SMF set serving the 5G VN group.
### 6.3.3 Procedures
Following note of clause 5.29.3 of TS 23.501 [2] \"PDU Session management\"
needs to be reworded to no more refer to a \"SMF\" but to a \"SMF set\".
_NOTE 1: The network is configured so that the same SMF is always selected for
a certain 5G VN group, e.g. only one SMF registers on the NRF with the
DNN/S-NSSAI used for a given 5G VN group._
Thus, the NOTE would read as follows:
_NOTE 1: The network is configured so that the same SMF *set* is always
selected for a certain 5G VN group, e.g. only one SMF registers on the NRF
with the DNN/S-NSSAI used for a given 5G VN group._
When the UE is not located in the service area of the SMF set associated with
the DNN/S-NSSAI used for a 5G VN group, per 3GPP Rel-16 procedures, the AMF
involves an I-SMF for the PDU Session.
NOTE 1: The SMF(s) that are part of a SMF set can collaborate via one of or a
combination of following implementation dependant means:
\- The SMF(s) can share contextual information associated with the 5G VN group
(DNN + S-NSSAI) in the UDSF. The contextual information may e.g. relate to the
N19 configuration, to the list of PDU Sessions established by 5G VN group
members, etc.
\- Implementation dependant signalling can be used between SMF(s) that are
part of a SMF set e.g. based on an implementation choice SMF(s) within the set
can elect one SMF to control the N19 configuration.
NOTE 2: Even though signalling between SMF(s) that are part of a SMF set is
based on implementation choice, the SMF set or SMF instances in SMF set need
to support functionality for 5G VN group communications across SMFs.
The solution supports 5G VN groups with UE(s) spread over a wide area (e.g. a
whole country like China). In this case, the SMF(s) that control the PDU
Session (SMF(s) that have the PCF and CHF interactions, etc.) are part of the
same SMF set while I-SMF(s) handling the local connectivity to the UE do not
need to be part of this SMF set. A SMF can control local traffic switching
between group members via proper FAR(s) and PDR(s) rules sent over N16a. When
a UE moves out of the service area of the SMF set that controls the
communications within a 5G VN group an I-SMF is used as specified in 3GPP
Rel-17 specifications with N16a modifications described below.
NOTE 3: Each 5G VN group can be associated with a specific slice, using e.g.
the Slice Differentiator (SD), parameter of the S-NSSAI, to ensure that PDU
Sessions of 5G VN users in the I-SMF serving areas are handled by local PSA
UPF(s) supporting the necessary features possibly including the support of a
N6 interface associated with the 5G VN group.
N16a is updated to allow the A-SMF that control the PDU Session (the SMF that
has the PCF interactions, etc.) to control local switching at local PSA UPF
between members of a 5G VN group (a local PSA UPF is a PSA UPF controlled by
an I-SMF).
Editor\'s note: It is FFS how the I-SMF controls the local PSA UPF.
Editor\'s note: It is FFS the details on the procedural level, e.g. how SMF
makes the local switching decision, how to support the case of I-UPF/I-SMF
change, release, and insertion, as well as new UE address
allocation/detection/release.
\- This SMF control of local switching at local PSA UPF(s) reuses the
capability defined for ETSUN in clause 4.23.9.0 of TS 23.502 [3] including
that the \"SMF may then at any time invoke a Nsmf_PDUSession_Update Request to
send N4 information to the I-SMF\".
\- But the SMF control of local switching requires N16a changes allowing the
A-SMF to send TS 29.500 [10] N4Information that is related to \"5G VN
internal\" switching in the local PSA UPF(s) as defined in clause 5.8.2.13.0
of TS 23.502 [3].
\- This allows local switching in the local PSA UPF(s) for traffic between
\"local\" 5G VN group members i.e. 5G VN group members that are served by the
same local PSA UPF.
\- Traffic of local 5G VN group members that is not locally switched (due to
\"5G VN internal\" switching) is sent over the N6 interface of the local PSA
UPF associated with the 5G VN group. This traffic may be handled as described
in solution 16.
A-SMF only needs to know which UEs served by local PSA UPF(s) belong to a 5G
VN group and thus may benefit from local traffic switching (\"5G VN internal\"
switching within the same network instance between PDU Sessions served by the
same local PSA UPF) to be able to configure accordingly local PSA UPF via N4
rules sent over N16a; A-SMF does not need to know which couples of UE\'s
traffic is actually subject to local switching at a local PSA UPF as the local
switching is done based on the UE addresses of the PDU Sessions served by the
same local PSA UPF (based on \"5G VN internal\" switching defined in clause
5.8.2.13.0 of TS 23.502 [3]). 5G VN traffic not subject to local traffic
switching is sent over N6 interface of the local PSA UPF and may be handled as
described in solution 16.
This may be supported as follows: the SMF for the PDU session of a UE member
of the 5G VN group issues following N4 rules for 5G VN (this is what is
defined in clause 5.8.2.13.1 without N19 tunnels):
\- Associate the UL traffic on the access side of the PDU Session with \"5G VN
internal\" switching (in FAR).
\- Create a PDR with source interface \"5G VN internal\" , a traffic detection
filter set to the address(es) of the UE on the PDU Session and a FAR referring
to the DL path (N3/N9 tunnel) towards the 5G AN of the UE for the Destination
Interface set to \"access side .
\- Creates a lower priority PDR with source interface \"5G VN internal\" , a
traffic detection filter set to ANY and a FAR referring to N6 forwarding. This
ensures that traffic between members of the 5G VN group that has not been
switched locally (the 5G VN group members are not served by the same local PSA
UPF) is sent over N6 and handled as described in solution 16.
### 6.3.4 Impacts on existing entities and interfaces
The solution impacts are on:
\- Registering a SMF set (and not a SMF instance) as associated with the DNN +
S-NSSAI representing a certain 5G VN group.
\- possibly associate a 5G VN group with a dedicated Slice Differentiator.
\- N16a changes allowing the SMF to send TS 29.500 [10] N4Information that is
related to \"5G VN internal\" switching in the local PSA UPF(s).
\- associate the UL traffic on the access side of the PDU Session with \"5G VN
internal\" switching (in FAR)
\- create a PDR with source interface \"5G VN internal\", a traffic detection
filter set to the address(es) of the UE on the PDU Session and a FAR referring
to the DL path (N3/N9 tunnel) towards the 5G AN of the UE for the Destination
Interface set to \"access side\" .
\- creates a lower priority PDR with source interface \"5G VN internal\", a
traffic detection filter set to ANY and a FAR referring to N6 forwarding.
\- reusing deployment mechanisms defined in solution 16 (e.g. for traffic
between 5G VN group members served by different local PSA UPF(s))
Editor\'s note: It is FFS how to perform SMF discovery and selection in the
case of multiple SMF sets if used in conjunction with sol#16.
## 6.4 Solution #4: Multiple SMFs for VN group communication
### 6.4.1 Introduction
This solution is for Key Issue #4 on Multiple SMFs for VN group communication.
Figure 6.4.1-1 depicts the architecture for the solution.
Figure 6.4.1-1: Architecture for multiple SMFs involved 5G VN group
communication
### 6.4.2 Functional Description
The main idea of this solution is as below:
\- If the SMF has established at least one PDU session for a VN, the SMF can
be treated as SMF serving the VN.
\- Each SMF serving the same 5G VN group registers/update its profile in the
NRF with the serving 5G VN group identifier. The serving VN group identifier
is the DNN/S-NSSAI used by the PDU session.
\- Each SMF can obtain the other SMF(s) serving the same VN by querying the
NRF with VN group identifier.
\- Each SMF can subscribe the VN group status change event (e.g. new SMF
serving the VN, or a SMF stop serving the VN) with NRF. When the event occurs,
the NRF sends notification to subscribed SMF with SMF information of the VN.
NOTE: In this solution, it assume the SMF which discover the other SMFs will
initiate the N19 handling. The SMFs which is notified with VN group status
change event, will locally handling the VN session and N19 locally. For
example, when a SMF-A receives the event that SMF-B stop serving the VN, it
can start a timer. If SMF-A does not receive the VN release from SMF-B until
timer expires, it can release the VN session and N19 tunnel related with SMF-B
locally.
\- After SMF obtains the other SMF(s) serving the same 5G VN, it initiates the
VN session requests with each of other SMFs to establish the VN session and
N19 tunnels between UPFs controlled by two SMFs.
\- When the SMF determines VN status has changed (e.g. a new PDU session for
the VN established, a PDU session for the VN released, etc.), it sends
update/release requests to the all other SMFs to update the VN session (e.g.
update the PDR/FAR in the UPF).
\- There is a full mesh of N19 tunnels between UPFs serving the 5G VN group
controlled by different SMFs.
### 6.4.3 Procedures
#### 6.4.3.1 Create the N19 tunnel between UPFs
There are two options to create the N19 tunnel between UPFs controlled by two
SMFs belonging to the same VN group, one is via NRF query and the other is via
NRF subscribing/notification
The procedure in Figure 6.4.3-1 shows a signalling flow in which the N19
tunnel between UPFs controlled by two SMFs is created using NRF query.
Figure 6.4.3.1-1: Procedure to establish the N19 between UPFs controlled by
two SMFs using NRF query
1\. The SMF-1 receives the PDU session establishment request. According to the
information in the request, i.e. DNN/S-NSSAI, it knows this PDU session is for
the VN group.
2\. SMF-1 decides whether it will discover other SMF(s) which belonging to the
same 5G VN group and start to establish VN session between them. If yes, SMF-1
starts to continue the following procedures with NRF.
NOTE 1: The trigger that SMF decides to find another SMF(s) within the same 5G
VN group could be based on the destination address UE requested (for example,
depending on the destination address, some packet flows may be forwarded
locally, while other packet flows are forwarded via N19 and other packet flows
are forwarded to N6 which described in clause 5.8.2.10.0 of TS 23.501 [2]), or
based on the conclusion of Sol#19 or other similar solutions.
3\. The SMF-1 update or register its profile to NRF with serving 5G VN group
identifier.
4\. The SMF-1 perform the SMF discovery to the NRF using the serving 5G VN
group identifier. The NRF only return the SMF-1 in the response.
5\. The SMF-1 configure the PDR/FAR for this PDU session.
6\. The SMF-2 receives the PDU session establishment request. According to the
information in the request, i.e. DNN/S-NSSAI, it knows this PDU session is for
the VN group.
7\. Similar with step 2.
8\. The SMF-2 update or register its profile to NRF with serving 5G VN group
identifier.
9\. The SMF-2 perform the SMF discovery to the NRF using the serving 5G VN
group identifier. The NRF return the SMF-1 and SMF-2 in the response.
11\. The SMF-2 configure the PDR/FAR for this PDU session and request the
UPF-2 to allocate the N19 tunnel resource information (e.g. TEID).
NOTE 2: For each UPF controlled by SMF-2, it only allocates one tunnel
information, i.e. one IP address and Port to receive packet from all other
UPFs.
11\. The SMF-2 sends the VN session request to SMF-1, in the request, the N19
tunnel resource and IP address/prefix/MAC of PDU session-2 are included.
12\. The SMF-1 sends the received N19 tunnel resource information to UPF-1 and
request UPF-1 to allocate the N19 tunnel resource information in UPF-1 (e.g.
TEID). The SMF-1 also create the PDR/FAR according to the received IP
address/prefix/MAC of PDU session-2.
NOTE 3: For each UPF controlled by SMF-1, it only allocates one tunnel
information, i.e. one IP address and Port to receive packet from all other
UPFs.
13\. The SMF-1 sends the VN session response to SMF-2, in the response, the
N19 tunnel resource of UPF-1 and IP address/prefix/MAC of PDU session-2 are
included.
14\. The SMF-2 sends the N4 request to UPF-2, to inform the N19 tunnel
resource information in the UPF-1. The SMF-2 also create the PDR/FAR according
to the received IP address/prefix/MAC of PDU session-1.
After step 14, the N19 tunnel between UPF-1 and UPF-2 is established.
The procedure in Figure 6.4.3.1-2 shows a signalling flow in which the N19
tunnel between UPFs controlled by two SMFs is created using NRF
subscribing/notification.
Figure 6.4.3.1-2: Procedure to establish the N19 between UPFs controlled by
two SMFs using NRF notification
1\. The SMF-1 receives the PDU session establishment request. According to the
information in the request, i.e. DNN/S-NSSAI, it knows this PDU session is for
the VN group.
2\. SMF-1 decides whether it will discover other SMF(s) which belonging to the
same 5G VN group and start to establish VN session between them. If yes, SMF-1
starts to continue the following procedures with NRF.
NOTE 1: The trigger that SMF decides to find another SMF(s) within the same 5G
VN group could be based on the destination address UE requested (for example,
depending on the destination address, some packet flows may be forwarded
locally, while other packet flows are forwarded via N19 and other packet flows
are forwarded to N6 which described in clause 5.8.2.10.0 of TS 23.501 [2]), or
based on the conclusion of Sol#19 or other similar solutions.
3\. The SMF-1 updates or registers its profile to NRF with serving 5G VN group
identifier.
4\. The SMF-1 subscribes the VN status change event with NRF for this VN
session,. The 5G VN status change event includes e.g. when another SMF(s)
starts/stops to serve the same 5G VN group.
5\. The NRF may notify the SMF-1 if there are available SMF(s) serving the
same VN group in the present network.
Editor note: If NRF notifies SMF-1 with multiple SMFs belonging to the same 5G
VN group, how SMF selects the correct/right one serving the target UE is FFS.
6\. Similar with step1. The SMF-2 receives the PDU session establishment
request. According to the information in the request, i.e. DNN/S-NSSAI, it
knows this PDU session is for the VN group.
7\. Similar with step 2.
8\. The SMF-2 updates or registers its profile to NRF with serving 5G VN group
identifier.
9\. The SMF-2 subscribes the VN status change event with NRF for this VN
session.
10\. The NRF notifies the SMF-1, the SMF-2 start to serving the VN session.
NOTE 2: Step 10 may occur before step 9 or occur at the same time.
11\. The NRF notifies the SMF-2, the SMF-1 is serving the VN group session.
NOTE 3: Whether SMF1 or SMF2 or both initials the VN session request between
them is up to the implementation deployment or operator\'s policy, which
should be designed in CT WG4. Take SMF-2 as an example in this solution.
12\. The SMF-2 configures the PDR/FAR for this PDU session and requests the
UPF-2 to allocate the N19 tunnel resource information (e.g. TEID).
NOTE 4: For each UPF controlled by SMF-2, it only allocates one tunnel
information, i.e. one IP address and Port to receive packet from all other
UPFs.
13\. The SMF-2 sends the VN session request to SMF-1, in the request, the N19
tunnel resource and IP address/prefix/MAC of PDU session-2 are included.14.
The SMF-1 sends the group-level N4 request to UPF-1, including the received
N19 tunnel resource information and request UPF-1 to allocate the N19 tunnel
resource information (e.g. TEID). The SMF-1 also creates the PDR/FAR according
to the received IP address/prefix/MAC of PDU session-2.
NOTE 5: For each UPF controlled by SMF-1, it only allocates one tunnel
information, i.e. one IP address and Port to receive packet from all other
UPFs.
15\. The SMF-1 sends the VN session response to SMF-2, in the response, the
N19 tunnel resource of UPF-1 and IP address/prefix/MAC of PDU session-1 are
included.
16\. The SMF-2 sends the group-level N4 request to UPF-2, to inform the N19
tunnel resource information in the UPF-1. The SMF-2 also creates the PDR/FAR
according to the received IP address/prefix/MAC of PDU session-1.
After step 16, the N19 tunnel between UPF-1 and UPF-2 is established.
#### 6.4.3.2 Update the N19 tunnel between UPFs
The procedure in Figure 6.4.3.2-1 shows a signalling flow in which the N19
tunnel between UPFs controlled by two SMFs is updated.
Figure 6.4.3.2-1: Procedure to update the N19 between UPFs controlled by two
SMFs
1\. The VN session and N19 tunnel between SMF-1/UPF-1 and SMF-2/UPF-2 has been
established.
2\. The SMF-1 detect there is a change on the routing information, e.g.:
\- A new PDU session is established, and anchored in the UPF-1.
\- A new MAC address is detected, or a MAC address is removed from the
existing PDU session for the VN.
\- A new PDU session is established, and anchored in the UPF-3.
\- A PDU session is released which is anchored in the UPF-1.
When a new PDU session is anchored in a new UPF, the SMF-1 will request the
UPF-3 to allocate the N19 tunnel information.
3\. The SMF-1 sends the VN session update request to SMF-2, in the request,
the changed IP address/prefix/MAC address are included. If there is a new
A-UPF, the N19 tunnel information is also included.
4\. The SMF-2 sends the received N19 tunnel resource information to UPF-2, if
any. The SMF-2 also create/delete the PDR/FAR according to the received IP
address/prefix/MAC change information.
5\. The SMF-2 send the VN session update response to SMF-1.
6\. The SMF-1 update the UPF-1/3 if needed.
### 6.4.4 Impacts on existing entities and interfaces
\- NRF: adding a new IE, i.e. serving VN ID in the SMF profiles. It supports
SMF discovery/subscription/Notify using serving VN ID. When one SMF does not
serving the VN group, i.e. all the PDU session anchored in this SMF for the VN
are released, the NRF need to notify other SMFs which are serving this VN.
\- SMF:
\- Update/Register serving VN ID to NRF. When it does not serving the VN
group, i.e. all the PDU session anchored in this SMF for the VN are released,
it updates the profile in the NRF to deregister the VN ID in the profile
\- discover other SMF serving the same VN group
\- Establishes the VN session with other SMF serving the same VN group
\- establish the N19 (adding, removing N19 tunnels) between the UPF(s) serving
the same VN group it controls and the UPF serving the same VN group controlled
by other SMF when e.g.
\- A new PDU session for the VN group is established, and anchored in a new
UPF
\- the last PDU Session for the VN group has been released in an UPF
\- exchange information about UE members and their address, including addition
and removal of such addresses), e.g. when:
\- A new MAC address is detected, or a MAC address is removed from an UPF
(from an existing PDU session Or because a PDU session has been released).
\- An IP address (or Prefix) is allocated, or is released (because a PDU
session has been established, released or due to IPV6 multi-homing).
## 6.5 Solution #5: Multiple SMFs involved 5G VN group communication
### 6.5.1 Introduction
This solution is for Key Issue #4 on enhancements of 5G VN group
communication.
### 6.5.2 Functional Description
The main idea of this solution is as below:
\- Each SMF serving the same 5G VN group reports/registers its identifier and
the 5G VN group identifier to the Group Session Management Function. Thus, the
Group Session Management Function has the knowledge of all the SMF serving the
5G VN group. The Group Session Management Function may also receive the N19
tunnel information and UE address information from the SMF and can provide the
information to other SMFs in the 5G VN group when the N19 tunnel is
established. The correspondence of SMF supporting 5G VN group can also be
configured by a network administrator to GSMF.
\- Each SMF can be aware of other SMFs via the Group Session Management
Function as following:
\- A SMF subscribes to the Group Session Management Function for the 5G VN
group change events (e.g. when another new SMF starts to serve the same 5G VN
group or another SMF stops to serve the 5G VN group). When the 5G VN group
change events occurs, the Group Session Management Function sends a
notification including the changed SMF\'s identifier information to the
subscribed SMF; or
\- A SMF can query the SMF information of other group member (which have
established the PDU session of the same VN group) from the Group Session
Management Function with including corresponding DNN,S-NSSAI or 5G VN group
identifier.
\- The SMF requests a session with another SMF and these two SMFs can
establish the N19 tunnels between UPFs and configure the UPFs via the session.
When the SMF detects, allocates or releases an address of the UE within the 5G
VN group, the SMF sends create/update/release requests to the other SMF via
the session to update the configuration on the UPF.
\- When a new IP/MAC address is allocated/detected by an SMF for an UPF, the
SMF notifies all other SMFs with N19 tunnel information of the UPF and the new
IP/MAC address. Alternatively, the SMF registers or updates GSMF with the N19
tunnel information, active UE addresses for the corresponding UPF, the GSMF
can notify this to the subscribed SMFs or allow other SMFs to query later.
\- When a IP/MAC address is released at a SMF, the SMF notifies all other SMFs
with N19 tunnel information of the UPF and the old IP/MAC address.
Alternatively, the SMF informs the GSMF to remove the N19 tunnel information,
released UE addresses for the corresponding UPF, and the GSMF can notify this
to the subscribed SMFs.
NOTE 1: When a new IP/MAC address is allocated/detected for a PDU Session or
an existing IP/MAC address is released/detected as no more used for a PDU
Session, the SMF notifies, directly or indirectly all other SMFs dealing with
the same 5G VN group., compared with the IP address case, the signaling load
for the MAC address will be more than the load for the IP address case since
devices (thus MAC addresses) may be moved between PDU Sessions.
\- When UPF detects a destination UE address it does not know, the UPF reports
this unknown destination UE address to the SMF. SMF shall register or update
GSMF with the destination UE address and N19 tunnel information, GSMF will
store all the UE addresses for the corresponding UPF information. If this
unknown destination UE address is served by other UPFs of this SMF, the SMF
can locally obtain the N19 tunnel information of the UPF controlled by this
SMF. If the SMF determines that this unknown destination UE address is not
served by it, then the SMF can query or subscribe the GSMF to obtain the
target SMF serving this destination UE address and contact the target SMF to
obtain the N19 tunnel information of the UPF serving the destination UE
address. Alternatively, the GSMF can collect all the N19 tunnel information,
active UE addresses for each involved UPF, so this SMF can query or subscribe
the GSMF to obtain the N19 tunnel information of the UPF serving the
destination UE address.
The main idea of the UPF topology management is as below:
\- Each SMF serving the same 5G VN group also reports/registers the selected
UPF identifiers which are also serving the same 5G VN group to the Group
Session Management Function. Besides, when the SMF detects a UPF involved or
released from serving the 5G VN group, the SMF sends update/reports to the
Group Session Management Function. Thus, the Group Session Management Function
has the knowledge of all the SMF and the corresponding UPFs serving the same
5G VN group.
\- The Group Session Management Function can determines the UPF topology based
on the reported/registered information from each SMF, it is up to GSMF to
choose which topology (e.g. star, ring, tree, etc) to use based on network
deployment or policy. And also, based on different UPF topology, GSMF can send
the 5G VN management instruction to the relevant SMFs to manage the 5G VN
group according to the proper UPF topology. The management information may
contains the instructions for the N19 tunnels establishment between UPFs
within one SMF or cross-SMFs.
NOTE 2: It is assumed that the SMF mentioned above can be aware of multiple
SMFs are / need to be involved in certain 5G VN group communication.. Once the
SMF noticed that the 5G VN group can be served by single SMF, it will control
the N19 tunnel establishment as Rel-16.
\- Each SMF can be aware of the UPF topology management information via the
Group Session Management Function as following:
\- Each SMF subscribes to the Group Session Management Function for the 5G VN
group management events (e.g. Cross SMF N19 tunnel set up or release
indication.). When the 5G VN group management events occurs, the Group Session
Management Function sends a notification including the changed information to
the subscribed SMF; or
\- A SMF can query the SMF information of other group member from the Group
Session Management Function.
\- The SMF requests a session with another SMF and these two SMFs can
establish the N19 tunnels between UPFs and configure the UPFs via the session
as described in clause 6.5.3.2.
Figure 6.5.2-1 depicts the architecture for the solution.
Figure 6.5.2-1: Architecture for multiple SMFs involved 5G VN group
communication
The Group Session Management Function is defined as a new NF or can be a
logical function realized by UDM/UDR/NRF.
The GSMF selection function is supported by the SMF and is used to allocate
the same GSMF instance for a certain 5G VN group.
There are three different options of GSMF selection as follows:
\- Option #1: GSMF instance address for a certain 5G VN group can be
predefined in the related SMFs (i.e. GSMF FQDN or IP addresses). It\'s up to
operator policy and implementation specific to ensure that the same GSMF is
always been selected by SMFs for a certain 5G VN group;
\- Option #2: As same as SMF, GSMF can register to NRF. When a SMF performs
GSMF selection by Nnrf_NFDiscovery service request, the NRF provides GSMF
information to the consumer such as SMF. The SMF invokes Nnrf_NFDiscovery
service operation from NRF to discover GSMF instance; The main idea is as
below:
\- When needed, the SMF utilize NRF to select/discover the GSMF instance for a
certain 5G VN group. SMF sends NF discovery request message with the
corresponding 5G VN group identifier to NRF.
\- In order to discovered the GSMF via NRF, the GSMF instance need to be
registered in the NRF by sending a Nnrf_NFManagement_NFRegister containing the
GSMF profile. Especially, the DNN and S-NSSAI of the 5G VN group which the
GSMF can provide the VN group management service can be included as part of
GSMF profile. Furthermore, one SMF can be registered as the default GSMF for
5G VN groups that do not need to specify a specific GSMF to provide the
corresponding service.
\- Upon receiving the discovery request message from SMF, the NRF provides the
NF profiles of the suitable GSMF(s) to SMF. The NRF will use the DNN and
S-NSSAI of 5G VN group to check with each GSMF profile information. If the DNN
and S-NSSAI of 5G VN group exist in one GSMF profile, the NRF shall provide
that GSMF instance address (i.e. GSMF FQDN or IP addresses) to SMF.
\- It is implementation specific to ensure that one 5G VN group identifier can
only be contained in one GSMF profile. In this case, the NRF shall allocated
the same GSMF for a certain 5G VN group.
\- Option #3: The GSMF instance information can also be stored in the UDM as a
part of subscription data, the SMF in one group can select GSMF by querying
the subscription data from UDM. The GSMF information can contain the
information about the DNN and S-NSSAI of 5G VN group it serves.
The solution assumes the GSMF is aware of the list.
### 6.5.3 Procedures
#### 6.5.3.1 Retrieval of peer SMF
Pre-condition/assumption:
UE1 and UE2 belongs to the same 5G VN group.
Figure 6.5.3.1-1: Multiple SMFs involved 5G VN group communication
1a. The UE1 establishes a PDU session (clause 4.3.2.2.1 of TS 23.502 [3]) for
getting access to a 5G VN group. In this figure, the UE1 is served by SMF1 and
UPF1.
1b. A new IP/MAC address is for getting access to a 5G VN group by an SMF for
UPF. In this figure, SMF1 detects a new UE address for UPF1, then step 2 shall
be skipped.
2\. SMF1 decides whether it will discover other SMF(s) which belonging to the
same 5G VN group and starts to establish VN session between them. If yes, SMF1
starts to continue the following procedures with GSMF.
NOTE: The trigger that SMF decides to find another SMF(s) within the same 5G
VN group could be based on the destination address UPF reported (for example,
depending on the destination address in step 1b, some packet flows may be
forwarded locally, while other packet flows are forwarded via N19 and other
packet flows are forwarded to N6 which described in clause 5.8.2.10.0 of TS
23.501 [2]), or based on the conclusion of Sol#19 or other similar solutions.
3\. SMF1 reports/registers the 5G VN group identifier (which can be identified
by DNN and S-NSSAI) of UE1 and SMF1 identifier to the GSMF (Group Session
Management Function). If the address of UE1 is further registered to the GSMF
in this step, then this step is performed for every new PDU Session to 5G VN
in SMF1.
Editor\'s note: The cases when SMF provides UE address to GSMF and when it
does not is FFS.
4\. In order to enable communication among the group members served by
different SMFs, the SMF1 may subscribe to the GSMF for the 5G VN group change
events (e.g. when another SMF serves the same 5GVN group or another SMF stops
to serve the 5GVN group).
5a. Similar as step 1. In this figure, the UE2 is served by SMF2 and UPF2.
5b. Similar as step 1b. In this figure, the UE2 is served by SMF2 and UPF2.
6\. Similar as step 2.
7\. Similar as step 3.
8\. Similar as step 4.
9\. The SMF1 retrieves other SMF(s) information via the following two
alternatives:
9a. Corresponding to step 3, the GSMF sends a notification including the SMF2
identifier information to the subscribed SMF1 that a new SMF (i.e. the SMF2)
starts to serve the 5GVN group after the PDU Session of UE2 is successfully
established in step 3.
9b. If in step 1 the address of UE is further registered to the GSMF in step
1, the GSMF has the knowledge of all the SMFs serving the 5G VN group and the
corresponding list of UE address served by each SMF. When the UPF1 receives a
data which the UPF does not have corresponding N4 rule for the target address,
the UPF1 may send a notification to the SMF1 in order to request N4 rule
relative to N19-based forwarding. The SMF1 queries the serving SMF information
of the target UE from the GSMF with the group identifier and target UE address
in the request.
If the SMF1 receives the unknown destination address reporting from UPF and
cannot find the target SMF, the SMF1 instructs the UPF to discard the unknown
packet or instruct the UPF to forward the unknown packet to N6 (if N6-based
forwarding is supported). In case N6 is supported, this requires UPF to report
unknown addresses for all destinations available via N6.
#### 6.5.3.2 N19 tunnel management
Figure 6.5.3.2-1: N19 tunnel management
1\. The SMF1 retrieves the SMF2 information as described in clause 6.5.3.1.
2\. Upon the received SMF2 information, the SMF1 determines to establish N19
tunnel between UPF1 controlled by SMF1 and UPF(s) controlled by SMF2. The SMF1
initiates a N4 Session Establishment/Modification to the UPF1 and the UPF1
provides tunnel information to the SMF1.
NOTE: Instead of step 1, step 2 can also be triggered by unknown destination
address reporting from UPF as described in clause 6.5.3.2.
Editor\'s note: The call flow below is to be updated explain IEs and actions
for reporting unknown destination address. This is FFS.
The SMF1 manages the N19 tunnel between UPF1 and UPF(s) controlled by SMF2 via
either option #1 or option #2:
**Option #1:** SMF1 communication with SMF2 directly:
3\. If the session with SMF2 is already established, the step 7 is performed.
If the session with SMF2 is not established, the SMF1 sends
CrossSMFSession_Create Request (5G VN group identifier, SM Context ID at SMF1,
UPF1 tunnel information, UE1 IP address served by UPF1) towards the SMF2 to
establish a session with SMF2. The SMF2 would reject the
CrossSMFSession_Create Request from the SMF1 if the session already exists.
If there are other UPF(s) controlled by SMF1 also needs to be added into the
5G VN group, e.g. the SMF1 receives the PDU Session establishment request from
other UE(s) with the DNN and S-NSSAI related to the same 5G VN group, the SMF1
may also include the SM Context ID(s) of the PDU Session, UPF tunnel
information, UE(s) IP address served by UPF(s) in the CrossSMFSession_Create
Request.
4\. The SMF2 initiates a N4 Session Modification to the UPF2. During this
step:
\- The SMF2 installs N4 rules (e.g. PDRs and FARs related to UE1) on the UPF2.
\- The UPF2 provides tunnel information to the SMF2.
NOTE: It is assumed that the UPF2 shall allocate only one N19 tunnel
information for each 5G VN and all other UPFs serving the same 5G VN share the
same N19 tunnel information.
5\. The SMF2 responds to the SMF1 (SM Context ID at SMF2, UPF2 tunnel
information, UE2 IP address). Based on the received SMF Context ID, the SMF1
can update the session towards SMF2 if a UE member has been added or removed
to/from the group at SMF1 later.
6\. The SMF1 initiates a N4 Session Modification to the UPF1 and installs N4
rules (e.g. PDRs and FARs related to UE2) on the UPF1.
7a. If another new UE (e.g. UE3) belongs to the same 5G VN group as UE1 is
also served by the SMF1 and UPF3 (it can be the same as or different with
UPF1). The SMF1 installs N4 rules related to UE1 and UE2 on the UPF3 and
receives UPF3 tunnel information from the UPF3. The SMF1 sends
CrossSMFSession_Update Request (SM Context ID at SMF2, UPF3 tunnel
information, UE3 IP address) towards the SMF2. This step also can be triggered
when the SMF1 detects the list of MAC addresses of UE member has changed (e.g.
based on MAC address learning at UPF).
7b. The SMF2 initiates a N4 Session Modification to install N4 rules related
to UE3 on the UPF2.
7c. The SMF2 sends CrossSMFSession_Update Respond to the SMF1.
8\. When the SMF1 no more serves any member of the 5G VN group, the SMF1
releases the session with other SMF (e.g., SMF2). In order to remove N19
tunnels between UPF(s) controlled by SMF 1 and SMF2, the SMF1 releases the N4
rules relative to N19-based forwarding on the UPF(s) served by itself and
sends CrossSMFSession_Release Request (SM Context ID at SMF2) towards the
SMF2. Upon receiving the request from the SMF1, the SMF2 releases the session
with SMF1 and initiates a N4 Session Modification to the UPF2 and delete N4
rules related to UE(s) served by SMF1.
**Option #2:** SMF1 communication with SMF2 via the GSMF:
9\. The SMF1 sends N19 tunnel establishment request (5G VN group identifier,
UPF1 tunnel information, UE1 IP address) to the SMF2 via the GSMF. The GSMF
stores this information when receive the request from the SMF1 and forward the
request to the SMF2.
If there are other UPF(s) controlled by SMF1 also needs to be added into the
5G VN group, e.g. the SMF1 receives the PDU Session establishment request from
other UE(s) with the DNN and S-NSSAI related to the same 5G VN group, the SMF1
may also include the UPF tunnel information, UE(s) IP address served by UPF(s)
in the N19 tunnel establishment request.
10\. The SMF2 initiates a N4 Session Modification to each UPF controlled by
SMF2 for the same 5G VN group. During this step, taking UPF2 in the figure as
an example:
\- The SMF2 installs N4 rules (e.g. PDRs and FARs related to UE1) on the UPF2.
\- The UPF2 provides tunnel information to the SMF2.
11\. The SMF2 sends respond to the SMF1 via the GSMF, the response message
includes (list of) UPF tunnel information and corresponding UE IP address(es)
served by the UPF.
12\. The SMF1 initiates a N4 Session Modification to the each UPF controlled
by SMF1 for the same 5G VN group and installs N4 rules (e.g. PDRs and FARs
related to UE2) on the UPF. This step can be triggered when the SMF1 detects
the list of MAC addresses of UE member has changed (e.g. based on MAC address
learning at UPF).
13a. If another new UE (e.g. UE3) belongs to the same 5G VN group as UE1 is
also served by the SMF1 and UPF3 (it can be the same as or different with
UPF1). The SMF1 installs N4 rules related to UE1 and UE2 on the UPF3 and
receives UPF3 tunnel information from the UPF3. The SMF1 sends N19 tunnel
modification request (5G VN group identifier, UPF3 tunnel information, UE3 IP
address) towards the SMF2 via the GSMF. If a UE3 is served by SMF3 (i.e. a SMF
different with SMF1), the SMF3 can retrieve the UPF1 and UPF2 tunnel
information from the GSMF.
13b. The SMF2 initiates a N4 Session Modification to install N4 rules related
to UE3 on the UPF2.
13c. The SMF2 sends respond to the SMF1.
14\. When the SMF1 no more serves any member of the 5G VN group, the SMF1
removes N19 tunnel(s) between UPFs controlled by SMF 1 and other SMFs (e.g.,
SMF2). The SMF1 releases the N4 rules relative to N19-based forwarding on the
UPF(s) served by itself and sends N19 tunnel release request to the GSMF. The
GSMF sends the N19 tunnel release request to all of other SMF serving the same
5G VN (e.g., SMF2). Upon receiving the N19 tunnel release request from the
GSMF, the SMF2 initiates a N4 Session Modification to the UPF2 and delete N4
rules related to UE(s) served by SMF1.
#### 6.5.3.3 UPF Topology management
Figure 6.5.3.3-1: UPF topology management
1\. The UE1 establishes a PDU session as described in clause 6.5.3.1. In this
figure, the UE1 is served by SMF1 and UPF1.
2\. SMF1 reports/registers the 5G VN group identifier of UE1, SMF1 identifier
and UPF1 identifier to the GSMF (Group Session Management Function).
3\. In order to enable communication among the group members served by
different SMFs, the SMF1 may subscribe to the GSMF for the 5G VN group change
events as described in clause 6.5.3.1.
4\. In order to enable the 5G VN group management due to UPF topology change,
the SMF1 may subscribe to the GSMF for the 5G VN group management change
events. (e.g. when the GSMF decide to setup/release the N19 tunnel which is
relevant to SMF1).
5\. Similar as step 1. In this figure, the UE2 is served by SMF1 and UPF2.
6\. Similar as step 2. SMF1 reports/registers the 5G VN group identifier of
UE2, SMF1 identifier and UPF2 identifier to the GSMF (Group Session Management
Function).
7\. The GSMF detect that new UPF involved and multiple UPFs are served by one
SMF. GSMF determines the UPF topology. In this figure, the GSMF instruct the
SMF1 to setup N19 tunnel between UPF1 and UPF2.
8\. The GSMF instruct the SMF1 to setup N19 tunnel between UPF1 and UPF2 via
5G VN group management message.
9\. SMF1 set up N19 tunnel between UPF1 and UPF2. (clause 4.13.8.2.2 of TS
23.502 [3])
10\. Similar as step 1. In this figure, the UE3 is served by SMF2 and UPF3.
11\. Similar as step 2. SMF2 reports/registers the 5G VN group identifier of
UE3, SMF2 identifier and UPF3 identifier to the GSMF (Group Session Management
Function).
12\. Similar as step 3.
13\. The GSMF detect that multiple SMF involved. Based on different 5G VN
management strategy, GSMF determines the UPF topology. As an example, the GSMF
decide to setup the N19 tunnel between UPF1 and UPF3, and SMF knows which
traffic should go on which N19 link according the UE addresses anchored at
other SMF/UPF and the existence of the N19 tunnel.
14\. The GSMF instruct the SMF1 to setup N19 tunnel between UPF1 and UPF3 via
5G VN group management message.
15\. (Optional) The GSMF instruct the SMF2 to setup N19 tunnel between UPF1
and UPF3 via 5G VN group management message.
16\. The SMF1 or SMF2 (Optional) will setup The N19 tunnel between UPF1 and
UPF3 as described in clause 6.5.3.2.
Editor\'s note: Whether and how to handle multiple N19 hops for PDUs is FFS.
### 6.5.4 Impacts on existing entities and interfaces
New capabilities are needed to discover the GSMF handling a 5G VN group.
**GSMF** : A new NF is introduced to support retrieval of peer SMFs, N19
tunnel management and UPF Topology management and UE address (IP/MAC). GSMF
registers onto NRF.
**NRF and OAM:** handle a new NF type (GSMF).
**SMF** :
Select a GSMF
The SMF retrieves a peer SMF information via the GSMF via two ways:
a) the SMF subscribes to the GSMF for the 5G VN group change events and
receives a notification including other SMF\'s identifier information (but
also N19 information and information on UE IP/MAC address routing) to the
subscribed SMF when events occurs;
b) the SMF can query the SMF information of a specific group member UE from
the GSMF.
Based on the information retrieved from GSM the SMF needs to be able to:
\- Establish a 5GVNSM session with each other SMF(s) involved in the 5G VN
group.
\- Use this 5GVNSM session with each other SMF(s) involved in the 5G VN group
to establish N19 tunnels as instructed by the GSMF.
\- When a SMF no more serves any member of the 5G VN group, the SMF1 removes
N19 tunnel(s) between UPFs controlled by itself and other SMFs. And then this
SMF releases the 5GVNSM sessions with other SMF(s).
\- Receive instructions from GSMF about which N19 tunnels need to be
establish.
\- Configure UPF(s) the UPF for traffic routing for such N19 tunnels.
\- Handle UPF reports about reports unknown destination UE address.
\- If the SMF determines that this unknown destination UE address is not
served by it, then the SMF needs to query or subscribe to the GSMF to obtain
the target SMF serving this destination UE address and needs to contact the
target SMF to obtain the N19 tunnel information of the UPF serving the
destination UE address.
**UPF(s):**
\- When UPF detects a destination UE address it does not know, the UPF reports
this unknown destination UE address to the SMF and needs to buffer the
corresponding traffic:
\- this may entail avoiding sending a new notification while the UPF is
waiting to receive the answer to its previous notification.
\- When the UPF receives a response about a destination UE address it does not
know, the UPF needs to retrieve the corresponding traffic and to send it.
## 6.6 Solution #6: Reuse of Rel-17 QoS framework
### 6.6.1 Introduction
The solution targets Key Issue #5: Allowing UE to simultaneously send data to
different groups with different QoS policy.
### 6.6.2 Functional Description
It is assumed that application logic in the UE determines which data the UE
needs to send towards which groups. This may mean sending the same data to
different destinations (IP addresses).
To support group communication allowing UE to simultaneously send data to
different groups, where each group has a different QoS policy, following
Rel-17 mechanisms may be used:
\- usage of a single PDU Session where PCC rules from the PCF can associate
different Qos flows to the traffic of the UE within different groups (e.g.
traffic to or from different sets of addresses for IP PDU session types, or
using different VLAN(s) for Ethernet PDU session types). This alternative does
not assume groups associated with 5G VN communications.
A UE member of multiple groups may per Rel-17 establish one or multiple PDU
Sessions.
When for example each group is represented by an IP multicast address or a set
of IP singlecast addresses, QoS policies represented by PCC rules, QER
policies sent over N4 and by QoS rules sent over NAS may associate this IP
multicast address or set of IP single cast addresses with dedicated QoS
parameters.
If the UE has the same data to send to different groups (thus to different
destinations) it creates multiple UL packet to send (one per destination) and
applies the QoS rules received from the network to each of the UL packet.
NOTE 1: as an example, a UE can send data to different IP multicast addresses
where the different IP multicast addresses are reachable over the same PDU
Session. Traffic filters (received from the SMF as part of Rel-17 QoS rules
within NAS signalling) allow per Rel-17 mechanisms the UE to perform the
classification and marking of UL User plane traffic, i.e. the association of
UL traffic to QoS Flows.
\- usage of 5G VN group communications: where each group maps to a DNN (and
slice) that may be associated with its own QoS policies.
When for example each 5G VN group is associated with an IP multicast address
or a set of IP singlecast addresses, QoS policies represented by PCC rules,
QER policies sent over N4 and by QoS rules sent over NAS may associate this IP
multicast address or set of IP single cast addresses with dedicated QoS
parameters.
If the UE has the same data to send to different groups (thus to different
destinations) it creates multiple UL packet to send (one per destination). In
case of 5G VN usage, each UL packet corresponding to a different group maps to
a different PDU Session and the UE and applies the QoS rules received from the
network on this PDU Session.
For Ethernet PDU Sessions different PDU sessions, hence different groups
correspond to different values of the couple (UE MAC address, VLAN tag).
NOTE 2: As defined in Rel-17, for UL traffic, the application in the UE
determines the target group(s) thus the target IP (multicast) address(es) or
MAC address(es) or VLAN tag(s) that UL data are to be associated with. Then,
Rel-17 URSP mechanisms associate the UL data to the relevant PDU Session and
Rel-17 Traffic filters allow the UE to associate this UL traffic to QoS Flows.
For DL traffic, PCC rules can associate DL traffic to a relevant QoS flow
(using e.g. target IP (multicast) address(es) or VLAN tag(s)), noting that
Ethernet PDU Sessions support traffic filtering based on IP addresses.
NOTE 3: Broadcast -multicast requirements in clause 6.13.2 of TS 22.261 [6]
need to be studied in a 5MBS related study.
### 6.6.3 Procedures
No changes to existing procedures are needed.
### 6.6.4 Impacts on existing entities and interfaces
None.
## 6.7 Solution #7: A PDU Session with multiple groups
### 6.7.1 Introduction
This solution is Key Issue #5 on 5G Smart Energy and Infrastructure.
Figure 6.7.1-1 depicts the concept of the solution.
Figure 6.7.1-1: Group communication enhancements for SEI (Smart Energy and
Infrastructure)
Target scenario of this solution is a smart grid scenario. For example, a UE
shares its phase info with the UEs in Regsion.1 for synchronization and with
the UEs in Area.1 for monitoring. Region.1 is located in Aera.1. For that, a
UE belongs to Region.1 group and to Area.1 group. When the UE sends data to
Region.1 group in higher QoS and to Area.1 group in lower QoS. The other UEs
which belong to Region.1 group and to Area.1 group receive data in higher QoS.
The UEs which belong to only Region.1 group receive the data in higher QoS.
The UEs which belong to Area.1 group receive the data in lower QoS. A UE which
belongs to Region.1 only, sends data to UEs which belong to Region.1 group and
to Area.1 group and to UEs which belong to Region.1 group. A UE which belongs
to Area.1 group only sends data to UEs which belong to Region.1 group and to
Area.1 group and to UEs which belong to Area.1 group.
### 6.7.2 Functional Description
Figure 6.7.2-1 depicts the concept of the solution.
Figure 6.7.2-1: A PDU session with multiple groups
The principles of this solution are like the following. The numbers of each
bullet refer to those in Figure 6.7.2-1.
\- A UE or an AF requests 5GS to configure new groups with different QoS\'s
(0). UDM/UDR stores the group QoS information. SMF retrieves the information
during PDU Session setup. AF can pre-configure the group and the QoS per
group.\ A UE belongs to Group1 and Group2 sends data to the UEs which belong
to at least one of Group1 and Group2. A UE belongs to Group1 only sends data
to UEs which belong to Group1. A UE belongs to Group2 only sends data to UEs
which belong to Group2.
AF can predefine GroupA which has sub-groups of Group1 and Group2. Each of
sub-groups keeps group data such as members, QoS requirements, and so on.
\- A UE establishes a PDU Session for the groups with explicit priorities or
implicit priorities (e.g. the former of the list means the higher priority)
(1). The UE provides list of group IDs with explicit priorities. For this, the
UE provides an indication when it send PDU Session request to 5GC. It is
assumed that the UE knows the group id via pre-configuration or via any other
means.
Editor\'s note: How pre-configuration can work and what other means refers to
is FFS.
If the AF predefined GroupA which has sub-groups of Group1 and Group2, the UE
can establish a PDU Session for the Group1 and Group2 by using GroupA as a
group ID.
For each group the PDU Session is accessing, there should have one QoS flow.
For that, priorities among QoSs among groups are needed. It is also possible
with implicit priorities when the QoS information includes priorities.
Explicit priorities (e.g. using Priority Levels) are provided when the AF pre-
configure the group and the QoS per group. If explicit priorities are not
provided more strict requirements can be considered to have higher priorities
if the same types of requirements like max-latency or min-rate. If the same
types of requirements are not used, the groups specified in the earlier order
of the PDU Session Request from the UE can be considered to have higher
priorities.
The SMF sets up the UPF forwarding table based on the groups and the SMF sets
up the QoS flows based on the QoS requirements (2, 3, 4). For example, an UPF
can be configured to forward the highest group traffic first, and then to
forward the next-higher group traffic not overlapped with the previous
traffic. Each UE is verified if it is allowed to communicate with a group when
the PDU Session is established.
If multiple SMFs are needed to support Group1 and Group2, a SMF for Group1 may
select another SMF for Group2 and the SMFs signal with each other to complete
the PDU Session Establishment procedure including QoS configuration. The SMFs
may control inter-PSA UPF communications including QoS configuration.
\- The UE sends the traffic to the PSA UPF with the highest QoS of the groups.
The UPF forwards the traffic to the UEs of a group with the QoS requirements
of the group and to the other UEs of another group with the dedicated QoS for
the group (5). For the UL packet, the UE just needs to send one copy to the
PDU session on the QoS flow with most strict QoS requirements, and UPF is
responsible for distribution of packet to different groups with different QoS.
The usage of QoS rules may also need to know priorities among QoS\'s among
groups. The traffic from the UE belongs to multiple groups within the PDU
Session of multiple DNNs/S-NSSAIs mapped to 5G VN groups is identified as
group traffic, and is forwarded as the SMF configured the UPF for the group
communication. The UE sends the traffic to the PSA UPF. Each PSA UPF of a UE
with a single group forwards the traffic to the UE with the QoS of the group.
Each PSA UPF of a UE with multiple groups forwards the traffic to the UE with
the highest priority QoS of the groups.
### 6.7.3 Procedures
Figure 6.7.3-1 outlines the procedure for support of a PDU Session with
multiple groups when there can be one SMF/UPF(s).
Figure 6.7.3-1: Procedure for a PDU session with multiple groups
0\. The AF configures Group1 and Group2. It also configures QoS requirements1
for Group1 and QoS requirements2 for Group2. Then, the PCF maps QoS1 and QoS2
based on the QoS requirements1 and QoS requirements2.
1\. UE1, which belongs to Group1 and Group2, sends PDU Session Request with
Group1 and Group2 to the SMF. In this step, the AMF needs to select the SMF
based on the information including Group1 and Group2. UE should include
multiple DNNs/S-NSSAIs for a PDU Session.
NOTE 1: Configuration shall ensure that a SMF / UPF can support all
DNNs/S-NSSAIs of the group of groups.
2\. The SMF checks subscription of the UE1 with the UDM and retrieves group
information for Group1 and Group2 from UDM.
3\. The SMF associates with PCF and retrieves QoS information like QoS1 for
Group1 and QoS2 for Group2.
4/4a. The SMF exchanges N4 controls with the UPF1/UPF2 for Group1 and Group2.
5/5a. UPF1/UPF2 setup the forwarding rules for Group1 and Group2.
UPF1/UPF2 forwards the traffic from UE1 for Group1 and Group2 to UEs which
belong to (Group1 and Group2) or to Group1 with QoS1. Then, UPF1/UPF2 forwards
the traffic from UE1 for Group1 and Group2 to UEs which belong to Group2 but
do not belong to Group1 with QoS2.
6\. The SMF sends PDU Session establishment Response for Group1 and Group2 to
UE1. The SMF sets QoS for the traffic for Group1 and Group2 to QoS1 if QoS1
has higher priority than QoS2.
6a. UE2, which belongs to Group1, establishes PDU Session for Group1 with QoS1
with UPF1. This includes similar steps similar to steps 1 through 6.
6b. UE3, which belongs to Group2, establishes PDU Session for Group2 with QoS2
with UPF2. This includes similar steps similar to steps 1 through 6.
7\. UE1 sends traffic for Group1 and Group2 with QoS1 to the UPF.
NOTE 2: Only when UE1 wants to send same data to UEs of different groups, it
adds both Group1 and Group2 in PDU Session request. Then, it sends data to UEs
of both Group1 and Group2 via the PDU Session. If UE1 adds Group1 or Group2
only in a PDU Session request, it can send data to Group1 or Group2 only via
the PDU Session.
8\. UPF1 forwards the traffic from UE1 for Group1 and Group2 to UEs which
belong to (Group1 and Group2) or to Group1.
9\. UPF1 sends traffic from UE1 for Group1 and Group2 to UE2 for Group1 with
QoS1.
9a. UPF1 sends traffic from UE1 for Group1 and Group2 to UPF2 with QoS1.
10\. UPF2 forwards the traffic from UE1 for Group1 and Group2 to UEs which
belong to Group2 but do not belong to Group1.
11\. UPF2 sends traffic from UE1 for Group1 and Group2 to UE3 for Group2 with
QoS2.
The AF can predefine GroupA which has sub-groups of Group1 and Group2. Figure
6.7.3.1-2 outlines the procedure for support of a PDU Session with GroupA
including multiple sub-groups.
Figure 6.7.3-2: Procedure for a PDU session with a predefined Group including
multiple sub-groups
0\. The AF configures Group1 and Group2. It also configures QoS requirements1
for Group1 and QoS requirements2 for Group2. Then, the PCF maps QoS1 and QoS2
based on the QoS requirements1 and QoS requirements2. The AF predefines GroupA
which has sub-groups of Group1 and Group2.
1\. UE1, which belongs to Group1 and Group2, sends PDU Session Request with
GroupA to a SMF. In this step, the AMF needs to select the SMF based on the
information including GroupA which has sub-groups of Group1 and Group2. UE
should include DNN/S-NSSAI for GroupA for the PDU Session.
NOTE 3: Configuration shall ensure that a SMF / UPF(s) can support all
DNNs/S-NSSAIs of the sub-groups.
2\. The SMF checks subscription of the UE1 with the UDM and retrieves group
information for Group1 and Group2 from UDM.
3\. The SMF associates with PCF and retrieves QoS information like QoS1 for
Group1 and QoS2 for Group2.
4/4a. The SMF exchanges N4 controls with the UPF1/UPF2 for Group1 and Group2.
5/5a. UPF1/UPF2 setups the forwarding rules for Group1 and Group2.
UPF1/UPF2 forwards the traffic from UE1 for Group1 and Group2 to UEs belongs
to (Group1 and Group2) or to Group1 with QoS1. Then, UPF1/UPF2 forwards the
traffic from UE1 for Group1 and Group2 to UE(s) belong(s) to Group2 but do(es)
not belong(s) to Group1 with QoS2.
6\. The SMF sends PDU Session Establish Response for GroupA to UE1. The SMF
sets QoS for the traffic for GroupA to QoS1 if QoS1 has higher priority than
QoS2.
6a. UE2, which belongs to Group1, establishes PDU Session for Group1 with
QoS1. This includes similar steps similar to steps 1 through 6.
6b. UE3, which belongs to Group2, establishes PDU Session for Group2 with
QoS2. This includes similar steps similar to steps 1 through 6.
7\. UE1 sends traffic for GroupA with QoS1 to the UPF.
NOTE 4: Only when UE1 wants to send same data to UEs of different groups, it
adds both GroupA in PDU Session request. Then, it sends data to UEs of both
Group1 and Group2 via the PDU Session. If UE1 adds Group1 or Group2 only in a
PDU Session request, it can send data to Group1 or Group2 only via the PDU
Session.
Editor\'s note: It needs to be clarified whether \'the UE adds both GroupA in
PDU Session request\' means some User Plane impacts.
8\. The UPF forwards the traffic from UE1 for GroupA to UEs which belong to
GroupA or to Group1.
9\. The UPF sends traffic from UE1 for GroupA to UE2 for Group1 with QoS1.
10\. The UPF forwards the traffic from UE1 for GroupA to UEs which belong to
Group2 but do not belong to Group1.
11\. The UPF sends traffic from UE1 for GroupA to UE3 for Group2 with QoS2.
Unless configuration ensures that a SMF / UPF can support all DNNs/S-NSSAIs of
the group, multiple SMFs and UPFs are selected based on DNN/S-NSSAI specific
configuration and subscription. The higher QoS is applied, if there are
conflicts on the QoS configuration of the DNNs/S-NSSAIs.
The AMF selects SMF per DNN/S-NSSAI. Then, it sends the PDU Session Request to
the SMF with the highest priority (predefined by operator, by AF or by UE),
and the SMF selects the other SMFs and communicate with the other SMFs for
establishing the PDU Session.
If multiple SMFs are needed to support Group1 and Group2, a SMF selected by
the AMF for Group1 may select another SMF for Group2 and the SMFs signal with
each other to complete the PDU Session Establishment procedure including the
QoS configuration. The SMFs may control inter-PSA UPF communications including
the QoS configuration.
The final PDU Session Establishment Response singling is via the SMF that is
selected first. If one of the SMFs rejects the PDU Session establishment
request, the final PDU session establishment response includes this rejection.
Figure 6.7.3-3 outlines the procedure for support of a PDU Session when
multiple SMFs are needed.
NOTE 5: This procedure can be changed in order to coordinate with the
solutions for KI#4.
Figure 6.7.3-3: Procedure for a PDU session with multiple groups when multiple
SMFs are needed
0\. The AF configures Group1 and Group2. It also configures QoS requirements1
for Group1 and QoS requirements2 for Group2. Then, the PCF maps QoS1 and QoS2
based on the QoS requirements1 and QoS requirements2.
1\. UE1, which belongs to Group1 and Group2, sends PDU Session Request with
Group1 and Group2 to the AMF.
1a. The AMF selects SMF per DNN/S-NSSAI. Then, it sends the PDU Session
request to the SMF with the highest priority (predefined by operator, by AF or
by UE). In this case, the AMF selects SMF1 based on Group1.
1b. The AMF sends the PDU Session request to the SMF1 with an indication that
more SMFs are involved.
1c. SMF1 selects the other SMFs, in this case SMF2. This step may reuse
solutions for KI#4.
1d. SMF1 sends PDU Session request to the other SMFs, in this case SMF2, for
establishing the PDU Session.
1e. SMF1 and SMF2 communicate with each other for establishing the PDU
Session.
2/2a. SMF1/SMF2 checks subscription of UE1 with the UDM and retrieves group
information for Group1 and Group2 from UDM. If SMF1 is selected based on
Group1 and SMF2 is selected based on Group2, SMF1 will get subscription data
of UE1 for Group1 and SMF2 will get subscription data of UE1 for Group2.
3/3a. SMF1/SMF2 associates with PCF and retrieves QoS information like QoS1
for Group1 and QoS2 for Group2.
4/4a. SMF1/SMF2 exchanges N4 controls with the UPF1/UPF2 for Group1 and
Group2.
5/5a. UPF1/UPF2 setups the forwarding rules for Group1 and Group2.
UPF1/UPF2 forwards the traffic from UE1 for Group1 and Group2 to UEs which
belong to (Group1 and Group2) or to Group1 with QoS1. Then, the UPF forwards
the traffic from UE1 for Group1 and Group2 to UEs which belong to Group2 but
do not belong to Group1 with QoS2.
SMF1 and SMF2 can exchange signalling to updates the states with each other.
6\. SMF2 sends PDU Session establishment response to SMF1. SMF1 sends PDU
Session establishment Response for Group1 and Group2 to UE1. SMF1/SMF2 sets
QoS for the traffic for Group1 and Group2 to QoS1 if QoS1 has higher priority
than QoS2. The final PDU Session Establishment Response singling is via SMF1.
If one of SMF1 and SMF2 rejects the PDU Session establishment request, the
final PDU session establishment response includes this rejection.
6a. UE2, which belongs to Group1, establishes PDU Session for Group1 with QoS1
with SMF1 and UPF1. This includes similar steps similar to steps 1 through 6.
6b. UE3, which belongs to Group2, establishes PDU Session for Group2 with QoS2
with SMF2 and UPF2. This includes similar steps similar to steps 1 through 6.
7\~11. The same as 7\~11 of Figure 6.7.3-1.
The AF can predefine GroupA which has sub-groups of Group1 and Group2. Unless
configuration ensures that a SMF / UPF(s) can support all DNNs/S-NSSAIs of the
sub-groups of GroupA, multiple SMFs are needed. Figure 6.7.3-4 outlines the
procedure for support of a PDU Session with GroupA including multiple sub-
groups when multiple SMFs are needed
NOTE 6: This procedure can be changed in order to coordinate with the
solutions for KI#4.
Figure 6.7.3-4: Procedure for a PDU session with a predefined Group including
multiple sub-groups when multiple SMFs are needed
0\. The AF configures Group1 and Group2. It also configures QoS requirements1
for Group1 and QoS requirements2 for Group2. Then, the PCF maps QoS1 and QoS2
based on the QoS requirements1 and QoS requirements2. The AF predefines GroupA
which has sub-groups of Group1 and Group2.
1\. UE1, which belongs to Group1 and Group2, sends PDU Session Request with
GroupA to the AMF.
In this step, the AMF needs to select the SMF based on the information
including GroupA which has sub-groups of Group1 and Group2. UE should include
DNN/S-NSSAI for GroupA for the PDU Session.
1a. The AMF selects SMF per DNN/S-NSSAI of GroupA. In this case, as multiple
SMFs are needed, the SMF with the highest priority (predefined by operator, by
AF or by UE) is selected. In this case, the AMF selects SMF1.
1b. The AMF sends the PDU Session request to the SMF1 with an indication that
more SMFs are involved.
1c. SMF1 selects the other SMFs, in this case SMF2. This step may reuse
solutions for KI#4.
1d. SMF1 sends PDU Session request to the other SMFs, in this case SMF2, for
establishing the PDU Session.
1e. SMF1 and SMF2 communicate with each other for establishing the PDU
Session..
2/2a. SMF1/SMF2 checks subscription of UE1 with the UDM and retrieves group
information for Group1 and Group2 from UDM. If SMF1 is selected based on
Group1 and SMF2 is selected based on Group2, SMF1 will get subscription data
of UE1 for Group1 and SMF2 will get subscription data of UE1 for Group2.
3/3a. SMF1/SMF2 associates with PCF and retrieves QoS information like QoS1
for Group1 and QoS2 for Group2. If SMF1 is selected based on Group1 and SMF2
is selected based on Group2, SMF1 will get QoS1 info for Group1 and SMF2 will
get QoS2 for Group2.
4/4a. SMF1/SMF2 exchanges N4 controls with the UPF1/UPF2 for Group1 and
Group2.
5/5a. UPF1/UPF2 setups the forwarding rules for Group1 and Group2.
UPF1/UPF2 forwards the traffic from UE1 for Group1 and Group2 to UEs which
belong to (Group1 and Group2) or to Group1 with QoS1. Then, the UPF forwards
the traffic from UE1 for Group1 and Group2 to UEs which belong to Group2 but
do not belong to Group1 with QoS2.
SMF1 and SMF2 can exchange signalling to updates the states.
6\. SMF2 sends PDU Session establishment response to SMF1. SMF1 sends PDU
Session establishment Response for GroupA to UE1. SMF1/SMF2 sets QoS for the
traffic for Group1 and Group2 to QoS1 if QoS1 has higher priority than QoS2.
If one of SMF1 and SMF2 rejects the PDU Session establishment request, the
final PDU session establishment response includes this rejection.\ Each SMF
allocate UPF, while the first SMF allocate UE IP address. The first SMF
enforces PCC rules with the coordination form the SMFs. multi-SMF case is
related with the solutions for KI#4.
6a. UE2, which belongs to Group1, establishes PDU Session for Group1 with QoS1
with SMF1 and UPF1. This includes similar steps similar to steps 1 through 6.
6b. UE3, which belongs to Group2, establishes PDU Session for Group2 with QoS2
with SMF2 and UPF2. This includes similar steps similar to steps 1 through 6.
7\~11. The same as 7\~11 of Figure 6.7.3-1.
### 6.7.4 Impacts on existing entities and interfaces
The impacts on the existing entities are like the following.
\- UE shall include multiple DNNs/S-NSSAIs or a DNN/S-NSSAI mapped to a group
which has subgroups for the multiple DNNs/S-NSSAIs for a PDU Session. This
includes changes to NAS Transport protocol (as defined in TS 24.501 [9] and
Figure 8.2.2.1-1 of TS 23.501 [2]) that currently handles a single
DNN/S-NSSAI.
\- AMF shall select the SMF based on the multiple DNNs/S-NSSAIs or on the
DNN/S-NSSAI mapped to a group which has subgroups for the multiple
DNNs/S-NSSAIs.
\- AMF needs to manage conflicts where some of the multiple DNNs/S-NSSAIs for
the PDU Session are allowed by policies/subscription while DNNs/S-NSSAIs are
not
\- SMF shall control the UPF(s) based on the multiple DNNs/S-NSSAIs and QoS
setup considering priorities among multiple groups.
\- UPF shall forwards traffic for multiple groups. This may mean SMF , N4 and
UPF impacts to manage rules requiring the UE to multicast traffic towards 2
groups
\- AMF (including NAS) PCF/CHF/RAN shall support PDU Sessions with multiple
DNNs/S-NSSAIs or a DNN/S-NSSAI mapped to a group which has subgroups for the
multiple DNNs/S-NSSAIs.
\- UDM/UDR shall support multiple SMF(s) to register for the same PDU Session
if multiple SMFs are needed for the PDU Session.
\- PCF/CHF shall establish multiple Npcf or a Nchf association for the same
PDU Session if multiple SMFs are needed for the PDU Session. They need also to
be handle potentially conflicting information received from the different
SMF(s)
\- PCF/CHF need to handle PDU Session with the multiple DNNs/S-NSSAIs
Editor\'s note: it needs to be clarified whether \'the UE adds both GroupA in
PDU Session request\' means some User Plane impacts.
## 6.8 Solution #8: Support for service/LADN area and QoS provided by AF for a
group
### 6.8.1 Introduction
This solution aims to address the KI#1.
This solution assumes that the LADN feature is used to enforce the \"Service
Area\", and therefore uses the term \"LADN Area\" to distinguish it from the
unrelated Service Area Restriction feature.
This solution re-uses the 5G VN group management API to allow an AF to create
a group with an associated DNN/S-NSSAI. There is no assumption that the 5G VN
group communication features (eg. N19) are used for the group.
### 6.8.2 Functional Description
To address how to set or modify the LADN area and QoS for a group, this
solution follows the principles below:
\- The 5G VN group data is extended to include LADN Area and QoS information
\- The existing NEF parameter provisioning service for 5G VN group data
provisioning is re-used, with the difference that the 5G VN group data may
contain a \"AF LADN Area\" and QoS information as a new input parameters.
\- The existing UDM parameter provisioning service for 5G VN group data
provisioning is re-used, with the difference that the 5G VN group data may
contain a LADN Area and QoS information as a new input parameter. The LADN
Area and QoS information is also stored as part of the 5G VN group data in
UDR.
\- The KI#1 is not limited to 5G VN groups and thus applicable to general
subscribed groups. It should however be noted that the 5G VN API assumes that
the AF has created the group and provided the list of subscribers to the
DNN/S-NSSAI for the group. The 5G VN API is not applicable for regularly
subscribed DNN/S-NSSAIs, i.e. DNN/S-NSSAIs configured in regular MM/SM UE
subscription data by the operator.
It should also be noted that 5G VN solution defined in TS 23.501 [2]/TS 23.502
[3] consists of two main parts:
\- Group management solution where an AF can create a group of UEs and
associated with a DNN/S-NSSAI representing the 5G VN group.
\- Group communication enhancements that can optionally be used for 5G VN,
e.g, using local switch and N19 based forwarding in UPF.
In principle these two aspects are independent. I.e. a group can be created
using the 5G VN NEF API without using the 5G VN communication related
features, since use of N19 and local data switching and other 5G VN specific
features defined in 23.501, clause 5.8.2.13 are optional. Therefore, the NEF
and UDM services for 5G VN group data provisioning could apply also for groups
not using the specific 5G VN group communication mechanisms.
\- The provisioning of LADN Area and QoS takes place as follows:
\- The NEF allows an AF to invoke the NEF Parameter Provisioning API to
provide a 5G VN group data including a AF LADN Area and QoS information. The
AF may provide additional information as part of the 5G VN group data based on
existing specifications, e.g. AAA server address. The External Group ID refers
to a group that the AF has created.
\- The AF LADN Area provided by the AF refers to a geographical area. The NEF
maps this information to a list of TAIs.
\- The NEF invokes the Nudm Parameter Provision Services to provide the 5G VN
group data to UDM.
\- The UDM stores the 5G VN group data in UDR, and updates each group
member\'s AM and SM subscription data to refer to the 5G VN group data. If
Shared Data is not supported by AMF or UDM, the UDM includes the LADN Area in
the regular AM subscription data.
\- The AMF receives the UE\'s subscription data (and related 5G VN group
data). The AMF applies the LADN Area as described for LADN in 23.501, with the
following differences
\- that the LADN Area is received from UDM instead of being configured in AMF.
\- that the list of TAs will be sent to UE per DNN.
\- The UDR notifies subscribed PCFs about the updated 5G VN group data. The
PCFs take the received QoS information into account. The QoS information
provided by the AF contains a QoS Reference and it is used by PCF in
determining QoS parameters for application traffic.
### 6.8.3 Procedures
Figure 6.8.3-1 outlines the procedure for support of LADN area and QoS group
attributes.
Figure 6.8.3-1: Procedures for support of LADN area and QoS group attributes
It is assumed that the AF has previously created the group and provided the
group member information using the same API.
1\. The AF invokes Nnef_ParameterProvision service for 5G VN group management
is used to provide the AF LADN Area and QoS information for a DNN/S-NSSAI for
a group of UEs. The External Group ID identifies the group of UEs.
2\. The NEF maps the AF LADN Area (geographical area) to a LADN Area (list of
TAIs). The NEF invokes the Nudm_ParameterProvision for 5G VN group management
to provide the 5G VN group data (including LADN Area and QoS information) to
UDM. A Trusted AF may provide the list of TAIs (instead of geographical area)
when provisioning the AF LADN Area.
3\. The UDM stores the 5G VN group data for the DNN/S-NSSAI (including LADN
Area and QoS information) in UDR.
4\. The UDM replies to NEF.
5\. The NEF replies to the AF.
6\. In case there are AMFs that have subscribed to AM subscription data
updates for the UEs that are part of the group, the UDM notifies those AMFs.
The AMF receives the LADN Area as part of the 5G VN group data type, or as
part of the AM subscription data (if Shared Data is not supported). The AMF
enforces the LADN Area using the LADN mechanism as described in clause 5.6.5
of TS 23.501 [2].
7\. In case there are PCFs that have subscribed to UDR notifications for 5G VN
group data, the UDR notifies the PCFs. The PCF take the QoS information into
account and may trigger PCC rule updates and PDU Session Modification. The PCF
may also take the LADN Area into account when generating URSP rules, e.g. to
define the validity area in the URSP rules.
### 6.8.4 Impacts on existing entities and interfaces
**General:** The 5G VN group data provisioning procedure is enhanced to apply
to general groups not using 5G VN specific communication mechanisms.
**AF:** Support update of 5G VN group data information containing AF LADN Area
and QoS information attributes.
**NEF:** Transform the geographical area received from AF into a list of TAI.
Provides the 5G VN group data (including LADN Area and QoS information) to UDM
in existing Nudm_ParameterProvision service.
**UDM:** Based on NEF request, it manages the 5G VN group data including LADN
area and QoS information via interacting with UDR. It can also provide AMF
with the LADN Area information based on existing UDM services.
**UDR:** Storage of the 5G VN group subscription data including LADN Area and
QoS information.
**AMF:** Receive LADN Area from UDM and enforce it per UE group member.
**PCF:** Receive 5G VN group data (including LADN Area and QoS information)
and apply it when making policy decisions.
**UE:** If LADN is enhanced to support per-DNN/S-NSSAI LADN area, the UE needs
to be able to handle provisioning of LADN area per DNN/S-NSSAI.
## 6.9 Solution #9: Support for service/LADN area and QoS group attributes
### 6.9.1 Introduction
This solution aims to address the KI#1, it addresses particularly how to set
or modify the service area and QoS group attributes for a group of UEs.
This solution assumes that the LADN feature is used to enforce the \"Service
Area\", and therefore uses the term \"LADN Area\" to distinguish it from the
unrelated Service Area Restriction feature.
This solution uses the general NEF Parameter Provision API where an AF can
provide parameters for a group of UEs identified by an External Group Id, for
storing (group) subscription data in UDM/UDR. The solution is thus applicable
to both 5G VN group, and groups other than 5G VN group. (In case the External
Group Id refers to a 5GVN group it is assumed that the 5GVN group has been
previously created by the AF using the 5G VN APIs).
### 6.9.2 Functional Description
To address how to set or modify the LADN area group attribute and/or default
QoS for a group, this solution follows the principles below:
\- Enhance the NEF and UDM Parameter Provision services by introducing LADN
Area and/or default QoS information associated to a group of UEs as a new
input parameter. This LADN Area and/or default QoS information may be stored
as part of each group members\' subscription data.
Alternatively, the UDM may store the LADN Area and/or default QoS information
as Group Subscription data related to the group. For this, the Shared Data
feature defined in TS 29.503 [7] could be extended to allow the UDM to
create/update and store (in UDR) corresponding resources related to the Group
Subscription data provided by the AF.
NOTE 1: This can be applied not only for the newly introduced LADN Area and/or
default QoS information but also to other parameters currently supported over
the Nudm_ParameterProvision service (e.g. expected UE behaviour or network
configuration parameters).
\- The NEF allows an AF to invoke the NEF Parameter Provisioning API to
provide a \"AF LADN Area\" and/or default QoS parameter for a group of UEs
identified by an External Group ID. The AF also provides the DNN and S-NSSAI
for which the LADN Area and/or default QoS applies.
\- The NEF translates the \"AF LADN Area\" (geographical area) into a LADN
Area (TAI list)
\- The NEF invokes the Nudm Parameter Provision Services to provide the LADN
Area and/or default QoS together with the External Group ID, DNN and S-NSSAI.
\- The KI#1 is applicable to general groups and is not specific to 5G VN
groups. Therefore, this solution proposes to enhance the existing general NEF
Parameter Provisioning API (3gpp-cp-parameter-provisioning) to provision LADN
Area and/or default QoS, rather than enhancing the 5G VN specific NEF
Parameter Provision API (3gpp-5glan-pp). The general NEF Parameter Provision
API allows the AF to provision parameters for individual UEs as well as groups
of UEs and allows the solution to be applied to regular subscribed
DNN/S-NSSAIs as well as DNN/S-NSSAIs associated with 5GVN groups.
\- The UDM stores the LADN Area per DNN and S-NSSAI in each group member\'s
Access and Mobility Subscription Data or as shared data related to the group
based on local configuration. The UDM stores the default QoS per DNN and
S-NSSAI in each group member\'s Session Management Subscription Data or as
shared data related to the group based on local configuration.
\- The AMF receives the LADN Area(s) as part of the UE\'s Access and Mobility
Subscription Data if UDM stores the LADN Area per DNN and S-NSSAI in each
group member\'s AM Subscription Data or if AMF does not support retrieval of
Group Subscription data from the UDM.
\- The SMF receives the default QoS as part of the UE\'s Session Management
Subscription Data if UDM stores the default QoS per DNN and S-NSSAI in each
group member\'s SM Subscription Data or if SMF does not support retrieval of
Group Subscription data from the UDM.
\- The Shared Data feature defined by CT4 can be used to handle the data in
UDM/UDR and signalling towards AMF/SMF, in order to optimize the provisioning
of subscription data that is common to many UEs (e.g. a group of UEs). In this
case, if the UDM stores the LADN Area and/or default QoS per DNN and S-NSSAAI
as shared subscription data and the AMF/SMF also supports the retrieval of
shared data from the UDM, the AMF/SMF receives a reference to the shared data
associated to the corresponding group the UE belongs to (e.g. a
sharedDataIdentifier). Then the AMF/SMF retrieves the shared data associated
to the group from the UDM using the received sharedDataIdentifier.
\- The AMF enforces the LADN area as described for the LADN feature in clause
5.6.5 of TS 23.501 [2], with the difference that the LADN Area is received
form UDM rather than configured on the AMF, and that AMF stores the received
LADN area per DNN and S-NSSAI in the UE context.
\- Since LADN is currently specified per DNN (irrespective of S-NSSAI), in
order to not impact the NAS protocol or the UE, it is assumed that the UE is
only subscribed to a single 5G VN group per DNN, i.e. a UE cannot be a member
of two (or more) 5G VN groups with the same DNN and different S-NSSAIs. The UE
can however be a member of multiple 5G VN groups with different DNN and same
S-NSSAI. In case the UE is a member of multiple 5G VN groups with the same DNN
and different S-NSSAI, it is up to AMF implementation which LADN area is
provided to the UE.
NOTE 2: In case of 5GVN groups, it is assumed that the AF has created the 5GVN
group using the 5GVN-specific API before providing additional parameters using
other APIs. This is in line with existing specification and applies e.g. if
the AF wants to provide parameters for a group of UEs using general NEF APIs,
e.g. Expected UE behaviour, ECS address configuration, Service specific
parameters etc. as described in clause 4.15.6 of TS 23.502 [3].
### 6.9.3 Procedures
#### 6.9.3.1 Procedure for exposure of Service Area and default QoS group
attribute
Figure 6.9.3.1-1: Procedure to support provision of LADN Area per DNN/S-NSSAI
for a group of UEs
1\. The AF invokes Nnef_ParameterProvision service to provide the \"AF LADN
Area\" and/or default QoS for a DNN/S-NSSAI for a group of UEs. The External
Group ID identifies the group of UEs.
2\. The NEF translates the \"AF LADN Area\" (geographical area) to a LADN Area
(TAI List) and invokes the Nudm_ParameterProvision to provide the LADN Area
and/or default QoS to UDM.
3\. The UDM stores the LADN Area and/or default QoS as part of each group
member\'s subscription data or as shared data related to the group based on
local configuration.
4\. The UDM replies to NEF.
5\. The NEF replies to the AF.
6\. In case there are AMFs supporting members of the group that have
subscribed for AM subscription data updates for the UEs that are part of the
group, the UDM notifies those AMFs either:
a. including the LADN Area within the AM subscription Data set of individual
UE subscriptions (i.e. one notification per UE belonging to the group
registered in each AMF subscribed in UDM); or
b. including the created shared data identifier within the AM subscription
Data set of individual UE subscriptions (i.e. one notification per UE
belonging to the group registered in each AMF subscribed in UDM). The AMF then
retrieves the shared data associated to the group which includes the LADN Area
(i.e. only one request based on sharedDataIdentifier). The AMF may also
subscribe to changes in the shared data related to the group to receive
further updates. The AMF applies the received shared data associated to the
group for any UE belonging to the group currently registered or registered
subsequently via the AMF.
7\. The AMF enforces the LADN area
8\. In case there are SMFs supporting members of the group that have
subscribed for SM subscription data updates for the UEs that are part of the
group, the UDM notifies those SMFs either:
a. including the default QoS within the SM subscription Data set of individual
UE subscriptions (i.e. one notification per PDU Session for UEs belonging to
the group registered in each SMF subscribed in UDM); or
b. including the created shared data identifier within the SM subscription
Data set of individual UE subscriptions (i.e. one notification per UE
belonging to the group registered in each AMF subscribed in UDM). The SMF then
retrieves the shared data associated to the group which includes the default
QoS (i.e. only one request based on sharedDataIdentifier). The SMF may also
subscribe to changes in the shared data related to the group to receive
further updates. The SMF applies the received shared data associated to the
group for any UE belonging to the group currently registered or registered
subsequently via the SMF.
9\. The SMF enforces the default QoS as currently described in TS 23.501 [2].
### 6.9.4 Impacts on existing entities and interfaces
**AF:** Able to provide AF LADN Area and default QoS for a DNN/S-NSSAI in the
NEF Parameter Provision service.
**NEF:** Able to map AF LADN Area to LADN Area. Provide LADN Area and default
QoS for a DNN/S-NSSAI in the UDM Parameter Provision service.
**UDM:** Based on NEF request, it manages the UE\'s subscription data
including LADN area and default QoS information via interacting with UDR.
Shared Data functionality as defined in CT4 specifications can be extended
dynamically to create/update shared data related to the group and used to
optimize the handling of subscription data common to many UEs.
**UDR:** Storage of the UE\'s subscription data including LADN Area
information. Creation/Update of shared data associated to a group.
**AMF:** Be able to apply the LADN Area in the UE\'s subscription data or
shared data for a DNN/S-NSSAI.
## 6.10 Solution #10: Support 5G VN service area with LADN mechanism
### 6.10.1 Key Issue mapping
This solution is for Key Issue #1, which addresses following aspects:
\- How to provision (i.e. set, modify and delete) the service area or QoS
applicable to each UE of the group via exposure interface, i.e.:
\- What is the information that constitutes the service area applicable to
each UE of the group via the exposure interface, and how to enforce the
service area applicable to each UE of the group by reusing the existing
mechanisms.
### 6.10.2 Description
5G LAN type service may only support the UEs, which are belong to 5G VN group,
when the they are located in specific service area.
In this solution, it is proposed to use LADN mechanism to support the 5G VN
group restriction service area. AF/NEF may provide the External Group ID, 5G
VN group membership information and 5G VN group data to the UDM. In the 5G VN
group data, the 5G VN group service can be added to show the service area
restriction for the 5G LAN type services.
In this solution the LADN DNN is the same as 5G VN group DNN, so the PDU
Session for the LADN DNN and of the 5G VN group are the same.
For LADN mechanism, the AMF is configured with the LADN service area by OAM as
defined in TS 23.501 [2].
When a UE from 5G VN group registers to the 5G network, the AMF retrieve the
subscription information from UDM with the 5G VN group data. After the AMF get
the 5G VN group service area from UDM, the AMF should compare the LADN service
area and the 5G VN group service area information, to check whether these two
areas are the same or not. If there is some overlapping between these two
areas, i.e. the same TAs existing in both two areas, the overlapping part area
can be decided as the LADN service area and sent to UE. If there is no
overlapping between these two areas, the AMF may send the LADN information to
UE with indication that the 5G LAN type service cannot be used even the 5G VN
group DNN related PDU session of the 5G VN group DNN has been establishment or
trigger the PDU Session release procedure of 5G VN group based on local
policy.
After the UE registration procedure, the UE can get the 5G LADN DNN and
related LADN service area.
When a UE request a PDU session establishment for the LADN DNN, the AMF and
SMF can treat the PDU session as a general PDU session for the LADN DNN.
### 6.10.3 Procedures for support of LADN service area
Figure 6.10.3-1: Procedures for support of LADN service area
NOTE: In the following procedures, 5G VN Group DNN is the same of 5G LADN DNN.
1\. The AF provides 5G VN group data information through NEF to UDM (GPSI,
DNN, S-NSSAI and 5G VN Group service area).
2\. AMF is configured with LADN information (LADN service area, LADN DNN).
3\. During the registration procedure, AMF can retrieve the group subscription
data from UDM, which contains the 5G VN group data (5G VN group service area,
DNN,S-NSSAI). Then AMF should compare the LADN service area and the 5G VN
group service area information, to check whether these two areas are the same
or not, and generates the overlapped service area. The overlapped service area
can be considered as the LADN service area for this UE. The overlapped service
area will be sent to UE in registration accept message.
4\. UE has the information of LADN DNN and LADN service area (the one which
the AMF send to the UE in step 3). UE can request PDU session establishment
for the LADN DNN, and AMF and SMF handle the PDU session establishment request
as PDU session for the LADN DNN.
### 6.10.4 Impacts on services, entities and interfaces
**AMF:**
\- Capability enhancement to compare the LADN service area and 5G VN group
service area, and then generate the overlapped service area as the new LADN
service area.
## 6.11 Solution #11: Support for group status event reporting
### 6.11.1 Introduction
This solution aims to address the key issue #2: enhance group status event
reporting, it addresses particularly how to enable the 5G VN group status
event reporting.
### 6.11.2 Functional Description
To enable the 5G VN group status event reporting, this solution follows the
principles or assumptions below:
\- Enhance the event exposure service by introducing the new \"group status
event\" monitoring event for a group.
\- NEF can retrieve from UDR the group subscription data including the group
membership, which can be used by NEF to transform the subscription to the
\"group status event\" to subscription to monitoring event (s) e.g. \"PDU
Session Status \", \"Registration state changes\", \"Area Of Interest\",
monitoring event for each UE group member.
\- NEF can subscribe to the notification for the corresponding mentoring event
(s) for each UE group member within the 5GC using existing mechanism as
defined in clause 4.15.3 of TS 23.502 [3].
\- When subscription to the \"group status event\" indicates continuous
reporting (e.g. periodic reporting or event based reporting) along with
certain parameters (periodic time interval, Group Reporting Guard time,
threshold value, Maximum number of reports, or Maximum duration of reporting),
NEF can perform the aggregation of the event reports for each UE group member,
namely NEF buffers or stores the event reports related with the UEs in a group
before the certain condition is met (e.g. expiry of periodic timer or Group
Reporting Guard timer, threshold is reached, event subscription becomes
invalid when Maximum number of reports is reached or Maximum duration of
reporting is expired). Once the certain condition is met, the NEF sends the
aggregated report to AF in the notification to \"group status event\"
monitoring event. The notification can include the Group ID, list of UE IDs
and Event Reporting information for the affected group members.
Figure 6.11.2-1 depicts the architecture to support group status event
reporting:
Figure 6.11.2-1: Architecture to support group status event reporting
**AF:** Application Function that interacts with NEF to subscribe to the
notification of \"group status event\" so as to be informed of the group
status event reporting.
**NEF:** 5G capabilities exposure function that supports transforming the
subscription for \"group status event\" to subscription to monitoring events
(e.g. \"PDU Session Status \", \"Registration state changes\", \"Area Of
Interest\") for each UE group member within the group according to group
subscription data received from UDR, additionally supports aggregating the
event reporting collected for the UE group members in the group as the group
status event reporting (e.g. notification is periodical).
**UDR:** Store the group subscription data including group membership. It can
provide the group subscription data to NEF as the response to query request or
as the notification to \"group subscription data\" change.
### 6.11.3 Procedures
Figure 6.11.3-1 outlines the procedure for support of group status event
reporting.
Figure 6.11.3-1: Procedures for support of group status event reporting
1\. The AF subscribes to \"group status event\" by sending
Nnef_EventExposure_Subscribe Request (Group ID, Event ID: group status event,
Event Filter: Status Information, Event Reporting Information).
Group ID identifies the target Group.
Event ID indicates the \"group status event\" the AF wants to subscribe to.
Event Filter indicates the exact status information (e.g. PDU Session status,
Registration state, UE Presence in Group Service Area) the AF is interested
in.
Event Reporting Information can include the parameters defined in clause
4.15.1 of TS 23.502 [3].
The event reporting subscription is authorized by the NEF, the NEF records the
association of the event trigger and the requester identity.
2\. The NEF reads from UDR, by means of Nudr_DM_Query, corresponding group
subscription data in order to transform the subscription for \"group status
event\" to subscription to monitoring events (e.g. \"PDU Session Status\",
\"Registration state changes\", \"Area Of Interest\") for each UE group member
within the group according to group subscription data received from UDR.
3\. [Conditional] If the NEF determines to subscribe to \"Registration state
changes\" monitoring event for each UE group member in the group, the NEF
retrieves the serving AMF for each group member from UDM via Nudm_UECM_Get and
sends for each UE group member to AMF the Namf_EventExposure_Subscribe Request
with \"Area Of Interest\" Event ID, UE ID, Group Data (DNN, S-NSSAI or Group
Service Area).
4\. [Conditional] The AMF responds the NEF with Namf_EventExposure_Subscribe
Response.
5\. [Conditional] If the NEF determines to subscribe to \"PDU Session status\"
and/or \"Registration state\" monitoring event for each UE group member in the
group, the NEF sends to UDM the Numf_EventExposure_Subscribe Request with
\"PDU Session status\" and/or \"Registration state\" Event ID, UE ID, DNN,
S-NSSAI).
6\. [Conditional] If the UDM receives the subscription to \"Registration state
changes\" monitoring event, the UDM sends to AMF the
Namf_EventExposure_Subscribe Request with \"Registration state changes\" Event
ID, UE ID.
7\. [Conditional] The AMF responds the UDM with Namf_EventExposure_Subscribe
Response.
8\. [Conditional] If the UDM receives the subscription to \"PDU Session
Status\" monitoring event, the UDM sends to SMF the
Nsmf_EventExposure_Subscribe Request with \"PDU Session Status\" Event ID, UE
ID, DNN, S-NSSAI.
9\. [Conditional] The SMF responds the UDM with Nsmf_EventExposure_Subscribe
Response.
10\. [Conditional] The UDM responds the NEF with Nudm_EventExposure_Subscribe
Response.
11\. The NEF responds the AF with Nnef_EventExposure_Subscribe Response.
12\. [Conditional] When AMF detects the subscribed event occurs, it sends the
event reporting to NEF via Namf_EventExposure_Notify or via UDM.
13\. [Conditional] When SMF detects the subscribed event occurs, it sends the
event reporting to NEF via Nsmf_EventExposure_Notify or via UDM.
14\. [Conditional] Upon reception of the event reporting from AMF or SMF or
UDM, the NEF can immediately send the received event reporting to AF. When
Event Reporting Information indicates continuous reporting (e.g. periodic
reporting or event based reporting) along with certain parameters (periodic
time interval, Group Reporting Guard time, threshold value, Maximum number of
reports, or Maximum duration of reporting), the NEF performs the aggregation
of the event reports received for each UE group member before the certain
condition is met (e.g. expiry of periodic timer or Group Reporting Guard
timer, threshold is reached, event subscription becomes invalid when Maximum
number of reports is reached or Maximum duration of reporting is expired). And
once the certain condition is met, the NEF sends aggregated report to AF via
Nnef_EventExposure_Notify (Group ID, list of UE IDs and Event Reporting
information for the affected group members).
### 6.11.4 Impacts on existing entities and interfaces
NEF: The event exposure service supports new \"group status event\" monitoring
event for a group. The NEF can retrieve from UDR the group subscription data
including the group membership, which can be used by NEF to transform the
subscription to the \"group status event\" to subscription to monitoring event
(s) for each UE group member.
UDR: The group subscription data can contain 5G VN group membership
information. The UDM can provide the group subscription data to NEF.
## 6.12 Solution #12: Support 5G VN service area restriction with SMF service
area
### 6.12.1 Key Issue mapping
This solution is for Key Issue #1, which addresses following aspects:
\- How to provision (i.e. set, modify and delete) the service area or QoS
applicable to each UE of the group via exposure interface, i.e.:
\- What is the information that constitutes the service area applicable to
each UE of the group via the exposure interface, and how to enforce the
service area applicable to each UE of the group by reusing the existing
mechanisms.
### 6.12.2 Description
5G LAN type service may only support the UEs, which are belong to 5G VN group,
when the they are located in specific service area.
In this solution, it is proposed to introduce 5G VN group service area in UDM
subscription data, and SMF judge whether the UE is located within the 5G VN
group service area. If the UE is located in it, the PDU session for 5G VN
group can be established, otherwise the PDU session establishment request will
be rejected by SMF.
SMF get the UE location from AMF.
### 6.12.3 Procedures for support of SMF service area
Figure 6.12.3-1: Procedures for support of SMF service area
1\. The AF provides 5G VN group information (GPSI, DNN, S-NSSAI and 5G VN
group service area) through NEF by invoking Nnef_ParameterProvision_Create (as
described in clause 4.15.6.2 of TS 23.502 [3]) and to UDM by invoking
Nudm_ParameterProvision_Create (as described in clause 5.2.3.6.3 of TS 23.502
[3]).
2\. UE initiates 5G VN group DNN PDU session establishment request.
3\. AMF sends PDU session establishment request to SMF with carrying UE
location information.
4\. SMF retrieves SM subscription data from UDM with
Nudm_SubscriberDataManagement request include 5G VN DNN, S-NSSAI, and 5G VN
group service area.
5\. SMF determines whether the UE is within the 5G VN group service area. If
not, the SMF may reject the PDU session establishment.
6\. PDU session establishment procedure.
7\. SMF subscribe the UE location with AMF by invoke
Namf_EventExposure_Subscribe request. In This step, the SMF may send the 5G VN
group service area to AMF as the location subscription requirement.
8-9. During UE mobility, when UE moves out of the 5G VN group service area,
the AMF can notify the SMF.
10\. SMF will verify if the UE is within the service area of 5G VN group, if
UE move out of the service area, 5G VN PDU session will be released.
### 6.12.4 Impacts on services, entities and interfaces
**AF:**
\- Provides 5G VN group service area to NEF as a parameter of 5G VN group
information.
**NEF:**
\- Sends 5G VN group service area to UDM as a parameter of 5G VN group
information.
**UDM:**
\- Stores 5G VN group service area as 5G VN group information in SM
subscription data.
**SMF:**
\- Determines whether the UE is within the 5G VN group service area. If not,
the SMF may reject the PDU session establishment.
\- Sends the 5G VN group service area to AMF as the location subscription
requirement when subscribing the UE location with AMF.
**AMF:**
\- Notifies SMF when UE moves out of the 5G VN group service area.
## 6.13 Solution #13: Support for group attribute management
### 6.13.1 Introduction
This solution addresses the KI#1.
**A group can be set with the service area that are applicable to each UE
within the group.**
### 6.13.2 Functional Description
When an AF creates a group, it provides an explicit list of group members
(each identified by the UE ID).
AF creates and configures a group, with the group members, and subsequently
the group profiles are stored in the UDR. Consumer NFs can subscribe to
retrieve such group data from UDM/UDR, as required.
The UE ID as provided by AF may be a GPSI.
### 6.13.3 Group Provisioning Procedure
Figure 6.13.3-1 provides the details of the procedures:
Figure 6.13.3-1: AF Creating and Provisioning Group ID profiles to 5GC
1\. AF assigns an (external) Group ID and includes a list of UEs to the group.
AF then sends Nnef_ParameterProvision_Create/Update/Delete request including
the Group info (Group Members, Service area and QoS parameters for the group,
[5G-VN group]).
5G VN group indicates if to the group is a \"5G VN group\". This will indicate
to 5GC that the group is associated with 5G VN communication mechanisms as
defined in clauses 5.29.3 and 5.29.4 of TS 23.501 [2].
2\. NEF after authorizing the AF request, translates the external information
to 5GC internal information e.g. external group ID into an internal group ID.
The NEF sends Nudm_ParameterProvision_Create/Update/Delete request (Group ID,
Group members, Service area/TAIs, attribute).
3-4. UDM uses Nudr_DM_Query/Update messages. UDR stores the data as part of
the Group subscription data and responds with Nudr_DM_Create/Update/Delete
Response message.
5-6. AF receives the Response message to its request in step 1.
7\. Consumer Network Function e.g. AMF and SMF may subscribe and thus get
notified on the group subscription information. In case of NF enforced
functionality (e.g. Service area related restriction) the subscribing to the
notification is mandatory. If the group information is to be provided to AMF
and/or to SMF following mechanism is envisaged:
\- NFs (e.g. AMF, SMF) subscribe to UDM for the subscription data changes
(creation / modification / deletion) of the group member UEs. When such groups
are subject to a creation / modification / deletion, the UDM notifies the
subscribed NF with Nudm_SDM_Notification (SUPI, Internal Group Identifier, [5G
VN group], etc.) service operation.
\- UDM may also indicate shared data identifier to Group Subscription data, as
mentioned in clause 4.15.6.2 of TS 23.502 [3] and explained in clause 5.2.2 of
TS 23.503 [4]. If the PCF has subscribed to receive notification on the shared
data, UDR notifies using Nudr_DM_Notify procedure. Based on the information
PCF has received, it provides SMF with a PCC rule for PDU Sessions that
corresponds to the AF request, taking into account UE location presence in
area of interest.
### 6.13.4 Impacts on existing entities and interfaces
The identified enhancements concern Information elements contained in AF:
\- Enhancements to externally indicated service area definition into TAI (or
Area of Interest or to existing IE Potential Locations of Applications).
NFs (AMF, SMF, PCF) provisioning to the group membership definition and NF
subscription to the group event notifications and taking the required actions.
SMF shall utilize the 5G VN group information to invoke 5G VN communication
mechanisms for a 5G VN group.
PCF performing mapping between the UDR stored QoS attributes and 5GS QoS
parameters, manages the potential conflicts of the QoS definitions, and
triggers PCF initiated SM Policy Association Modification/ Termination for
each UE belonging to the group.
## 6.14 Solution #14: Group status event reporting based on existing NEF Event
Exposure service
### 6.14.1 Introduction
This solution addresses KI#2 to enable an AF to subscribe to group status
event reporting for the event \"newly registered or (de)-registered group
member\".
### 6.14.2 Functional Description
The existing Monitoring services exposed by NEF (described under
Nnef_EventExposure service in TS 23.502 [3]) can be used to subscribe to
monitoring events. The supported monitoring events are listed in clause 4.15.3
of TS 23.502 [3]. Several of the current available monitoring events such as
UE Reachability, PDU Session Status and Number of UEs in an area, are related
to the Key Issue event \"newly registered or (de)-registered group member\".
The service requirements for this event \"newly registered or (de)-registered
group member\" are not clear. In this solution it is assumed that the existing
monitoring event for \"PDU Session Status\" allows an AF to learn when a group
member establishes a PDU Session, together with the DNN, IP address etc. The
AF is also notified when the PDU Session is released. By subscribing to this
event, the AF can know when a group member \"registers\"/\"de-registers\" to a
DNN/S-NSSAI associated with the group, e.g. a 5G VN group.
Editor\'s note: If the requirements for \"newly registered or (de)-registered
group member\" become more clear, the need for a new monitoring event can be
further evaluated.
An AF can subscribe to monitoring events for a single UE (based on GPSI) or a
group of UEs (based on External Group ID).
If the monitoring event subscription refers to a group of UEs the AF can
provide a Group Reporting Guard Time. Group Reporting Guard Time is an
optional parameter for group-based monitoring configuration to indicate the
time for which the Monitoring Event Reporting related with the UEs in a group
can be aggregated before sending them to the AF. If no Group Reporting Guard
Time is provided, the NEF provides a notification for each UE for which it
received an event notification e.g. from AMF or UDM. If the AF provided a
Group Reporting Guard Time, the NEF accumulates all of the monitoring event
reports received from the UDM for the group members until the Group Reporting
Guard Time expires. When the timer expires, the NEF sends the accumulated
Monitoring Event Reports to the AF.
### 6.14.3 Procedures
The call flow below is based on existing pre-rel-18 standards, as e.g.
described in clause 4.15.3.2.3 of TS 23.502 [3].
Figure 6.14.3-1: Procedure to support event monitoring of group status related
events
1\. The AF subscribes to event monitoring for the group. The AF provides e.g.
the External Group ID and the requested monitoring events.
2\. For event subscriptions for a group of UEs, the NEF subscribes to UDM by
invoking the Nudm Event Exposure services. For certain events the UDM needs to
subscribe to the AMF or the SMF for the event.
The UDM knows what UEs are registered and have PDU Sessions (since each AMF
and SMF registers with UDM). UDM also knows the group membership since the
Internal Group ID(s) are part of each UE\'s subscription data. So UDM can
subscribe to the AMFs that have UEs that are Registered and are members of the
group, and to SMFs that have UEs that are members of the group with PDU
Sessions.
AMF/SMF knows the group membership since the Internal Group ID(s) are part of
the UE\'s subscription data.
3\. For events subscriptions for Number of UEs in an area, the NEF subscribes
directly to the AMF.
4\. The NEF acknowledges the event subscription to the AF.
5\. When the UDM detects that an event occurs the UDM sends an event report,
by means of Nudm_EventExposure_Notify message, to the NEF.
6\. When the AMF/SMF detects that an event occurs the AMF/SMF sends an event
report, by means of Namf_EventExposure_Notify/Nsmf_EventExposure_Notify
message, to the NEF.
7\. The NEF forwards the event notifications to the AF. In case the
subscription was for a group of UEs and the Group Reporting Guard Time was
provided, the NEF accumulates the reports and provides the accumulated
monitoring report to the AF when the Group Reporting Guard Time expires.
### 6.14.4 Impacts on existing entities and interfaces
No impacts.
Editor\'s note: If the requirements for \"newly registered or (de)-registered
group member\" become more clear, the need for a new monitoring event can be
further evaluated.
## 6.15 Solution #15: Group status event reporting
### 6.15.1 Introduction
This solution aims to address the KI#2, i.e. how to allow subscription for the
event \"newly registered or (de)-registered group member\". Newly registered
or de-registered group member should be notified to the AF that has subscribed
for changes on the members of the group, i.e. when a new member is added or
old member is removed from the group as identified by External Group ID. This
may occur e.g. when the corresponding Internal Group ID is removed from the
user subscription data by OAM.
### 6.15.2 Functional Description
The solution is based on the following principles:
\- The AF can subscribe for changes in the 5G VN group data. This is done by
including a Notification Target Address into the
Nnef_ParameterProvision_Create request when the 5G VN group is created. The
NEF then notifies the AF by invoking Nnef_ParameterProvision_UpdateNotify
service operation, and includes the current content of the 5G VN group data to
the notification.
\- If NEF receives 5G VN group creation (Nnef_ParameterProvision_Create)
request with a Notification Target Address, the NEF includes its own
Notification Target Address to the Nudm_ParameterProvision_Create request when
the NEF creates the 5G VN group into UDM. Whenever the UDM determines the 5G
VN group data has changed, e.g. because the Internal Group ID is removed from
a member\'s user subscription data by OAM, the UDM invokes
Nudm_ParameterProvision_UpdateNotify to the given Notification Target Address,
and includes the current 5G VN group data to the notification. The NEF may
further notify the AF via Nnef_ParameterProvision_UpdateNotify.
\- In addition to the subscription for the event \"newly registered or
(de)-registered group member\", the AF may wish to subscribe for the UE
Monitoring Event(s) for all group members at once:
\- If the AF wants to subscribe for any of the monitoring event(s) as
described in Table 4.15.3.1-1 of TS 23.502 [3] (e.g. UE reachability or PDU
Session status) for the members of the group, the AF can use the existing
Nnef_EventExposure service and include the External Group ID as a target to
the subscription. In this case the NEF subscribes to the notification for the
corresponding monitoring event(s) for each UE group member within the 5GC
using existing mechanism as defined in clause 4.15.3 of TS 23.502 [3].
\- The AF may include a Group Reporting Guard Time (as in Table 4.15.1-1 of TS
23.502 [3]) into the Nnef_EventExposure_Subscribe request that is targeted to
an External Group ID. In this case the NEF shall accumulate all of the
received Monitoring Event reports for the group of UEs until the Group
Reporting Guard Time expires or the monitoring duration is reached. No impacts
to the existing procedures are foreseen.
\- These procedures are covered in the current specifications and no impact is
foreseen.
### 6.15.3 Procedures
The flow below takes NEF service operation in clause 4.15.6.2 of TS 23.502 [3]
as a basis to support the event of \"newly registered or (de)-registered group
member\".
Figure 6.15.3-1: Procedure to support parameter provisioning of group
membership updates
1\. The AF sends Nnef_ParameterProvision_Create request to NEF with a
Notification Target Address.
2\. If the AF is authorised by the NEF to provision the parameters, the NEF
requests to create the provisioned parameters as part of the subscriber data
via Nudm_ParameterProvision_Create. The NEF includes its own Notification
Target Address to this request.
3\. The UDM may send a Query and read from UDR (Nudr_DM_Query) to validate
required updates with the corresponding subscription information. If a new 5G
VN group is created, a unique Internal Group ID is assigned by the UDM and
this Internal Group ID is added in the Nudr_DM_Create Request message.
4\. The UDM responds the request with Nudm_ParameterProvision_Create Response.
5\. The NEF responds the request with Nnef_ParameterProvision_Create.
6\. [Conditional] This step occurs if the UDM determines the 5G VN group data
has changed. The membership status of a 5G VN group is updated by OAM and
Internal Group ID is removed from the user subscription data. UDR notifies the
UDM that the user subscription data has been modified and the Internal Group
ID has been removed from the user subscription data. The UDM ensures the group
subscription data is consistent with the user subscription data and removes
the corresponding user identity from the group data in the UDR.
The UDM invokes Nudm_ParameterProvision_UpdateNotify to the given Notification
Target Address and includes the current 5G VN group data to the notification.
7\. [Conditional] The NEF notifies the AF via
Nnef_ParameterProvision_UpdateNotify and provides the current content of the
5G VN group data to the notification.
### 6.15.4 Impacts on existing entities and interfaces
\- UDM: new service operation Nudm_ParameterProvision_UpdateNotify allows the
UDM to notify the NF consumer (NEF) on changes for the 5G VN group data.
\- NEF: new service operation Nnef_ParameterProvision_UpdateNotify allows the
NEF to notify the NF consumer (AF) on changes for the 5G VN group data.
## 6.16 Solution #16: Use of N6 interconnect for 5G VN with multiple SMFs
### 6.16.1 Introduction
This solution addresses KI#4 on multiple SMFs for VN group communication.
Currently the 5G VN is assumed to be served by a single SMF. The reason for
that is to allow the user plane for 5G VN to be controlled by a single
controller (SMF) to enable N19 tunnel management. Since the SMF manages all
PDU Sessions and controls all UPFs, that SMF can ensure that relevant N19
tunnels are established and forwarding rules are provided to the involved
UPFs. Other 5G VN features than N19 are not dependent on the use of a single
SMF.
This solution generalizes the support of 5G VN to multiple SMFs by enabling
transport for traffic that goes between UE served by different SMFs. This
allows a 5G VN to be deployed by multiple SMFs (or multiple SMF Sets).
### 6.16.2 Functional Description
#### 6.16.2.1 General
One of the main ideas with 5G VN is to allow an operator to create a virtual
network where UEs can communicate with each other as well as with a DN.
As described in e.g. clauses 5.8.2.13 and 5.29.3 of TS 23.501 [2], a 5G VN
supports connectivity via N6. In 5GS in general, the N6 interface has two
purposes that applies also to 5G VN: allow the UEs (5G VN group members) to
access entities (e.g. servers) on the DN and enable UE-to-UE communication
between UEs served by different SMFs/UPFs.
In this solution two deployment scenarios are considered:
1) A 5G VN deployment scenarios with a \"native\" N6 access from UPF to a DN.
The UPF thus have access to a \"native\" DN that supports Ethernet in case of
Ethernet PDU Sessions and IP payload in case of IP PDU Session types.
2) Another 5G VN deployment scenario where there may not be a \"native\" N6 or
DN. Instead, the N6 interface may be running over an underlying transport
network. The N6 interface and the DN is thus a virtual network on top of this
underlay transport network.
The support of the two deployment scenarios above is optional and only
required when a 5G VN involves multiple SMFs, unless the SMFs are deployed in
a single SMF Set that is able to handle N19 forwarding as described in
solution #3.
#### 6.16.2.2 Native N6
In this deployment a native N6 exists, i.e. with either an Ethernet connection
towards Ethernet bridge(s) on the DN in case of Ethernet PDU Session, or an IP
connection towards IP router(s) for IP based PDU Sessions. Any up-link traffic
that is sent onto N6 will be forwarded/routed towards the destination based on
the destination MAC address or IP address, respectively.
Forwarding between UEs served by different SMFs is done via the bridged/routed
N6 network (DN). This is further illustrated in Figure 1. Forwarding between
UEs served by the same SMF may (optionally) utilize N19 tunnels, as per
rel-17. The figure shows a single router/bridge for simplicity, but there may
be multiple routers/bridges in the DN. The solution also supports
communication with hosts/servers on the DN, if needed.
The UPFs supporting a specific DNN/S-NSSAI corresponding to a 5G VN group
associate this DNN/S-NSSAI with the corresponding N6 interface(s) e.g. via
configuration between the network instance associated with the 5G VN group and
the relevant N6 interfaces.
Figure 6.16.2-1: Traffic forwarding between UEs served by different SMFs via
native N6
#### 6.16.2.3 N6 overlay
In this deployment the N6 interface is running over an underlying transport
network, similar to how N3, N9 and N19 GTP-U tunnels are running over an
underlying transport network. The N6 network (DN) is in this case a virtual
(overlay) network created on top of a (underlay) transport network. This is a
common deployment today and there are multiple well-established technologies
for handling packet transport and routing/bridging in such deployments,
including IP VPNs (or L3VPNs) and E-VPNs. Both IPVPN and EVPN are standardized
by IETF in a number of RFCs. There are several other VPN technologies
available, and different technologies may fit different operator deployments.
The intention is not to standardize a specific VPN solution in 3GPP (examples
of VPN solutions could however be made).
Forwarding between UEs served by different SMFs is done via the VPN.
Forwarding between UEs served by the same SMF may (optionally) utilize N19
tunnels, as per rel-17. This is further illustrated in Figure 2 where the
Provider Edge (PE) router functionality is shown. The solution also supports
communication with hosts/servers on the DN, if needed. To enable connectivity
with networks on the DN, \"standalone\" PE routers can also be included in the
VPN (as shown in the figure 2). This is however optional and if only UE-to-UE
communication is desired, separate PE routers are not needed. The figure shows
a single separate PE, but there may be multiple PEs in the VPN.
Since the IP/E-VPN is a virtual network running over an underlay IP network,
the routers in the underlay transport network have no visibility into VPN
tunnels, they simply provide connectivity from one PE router to another,
similar to how it works for GTP-U.
The UPFs supporting a specific DNN/S-NSSAI corresponding to a 5G VN group
associate this DNN/S-NSSAI with the corresponding VPN e.g. via configuration
between the network instance associated with the 5G VN group and the relevant
VPN information, such as information about peer PE(s) or information on how to
get the necessary connectivity to the peer PE(s).
UPFs participating as Provider Edges (PEs) need to be provided with
information about the IP/E-VPN (e.g. per UPE/PEs etc.). This is typically done
by O&M. Even if this can be done dynamically, i.e. adding and removing a
UPF/PE from the IP/E-VPN, it is typically not coordinated with the
establishment and release of PDU Sessions. It is possible for the operator to
pre-configure relevant UPF/PEs in advance irrespective of the number of PDU
Sessions. It can be noted that even for 5GVNs, UPFs need to be configured with
other information such as network instance values. UPF/PEs that are part of
the VPN but have no active PDU Sessions will still maintain the IP/E-VPN
information but may decide to not announce any routes (using BGP) or MAC
addresses (using RSTP) and will thus not attract any UE traffic. When a first
PDU Session is served by a UPF, the UPF announces routes / MAC address as
needed.
Editor\'s note: It is FFS how to support traffic forwarding between UPFs
served by different SMFs in the case that the UPF doesn\'t support Provider
Edges (PEs).
Editor\'s note: It is FFS whether it needs update the pre-configurations for
Provider Edges (PEs) on existing UPFs if there is a newly deployed UPF that
supports PE for a 5G VN.
Editor\'s note: It is FFS how to perform SMF discovery and selection in the
case of multiple SMF sets if used in conjunction with sol#3.
Figure 6.16.2-2: Traffic forwarding between UEs served by different SMFs via
IP/E-VPN
#### 6.16.2.4 Traffic routing/forwarding
The traffic routing/forwarding in both solutions above are based on existing
technologies.
For native N6 deployments with IP PDU Sessions, regular IP routing by IP
routers in the DN ensures that UE-to-UE traffic reaches the UPF that serves
the target UE IP address. For Ethernet PDU Sessions, Ethernet bridges in the
DN performs forwarding of Ethernet frames based on IEEE mechanisms.
For VPN deployments, it is the PE router functionality that performs IP
routing or Ethernet forwarding towards target destination based on either IP
routing protocols or Ethernet/IEEE based forwarding. These are old and proven
technologies that have worked in the field in carrier-grade environments for
many years. There seems to be no need to re-invent the wheel in 3GPP.
The routing information on N6 (VPN) is updated via IETF based mechanisms that
do not require further 3GPP standardization. For IP PDU Sessions, routing
protocols such as Border Gateway Protocol (BGP) are used between the PE/UPFs
over the VPN to ensure that packets are forwarded to the right UPF based on
destination IP address. For Ethernet PDU Sessions, IEEE protocols such as
Rapid Spanning Tree Protocol (RSTP) are used to exchange information between
the PE/UPFs about what MAC addresses are available at what ports. This also
ensures a loop free forwarding.
#### 6.16.2.5 Dealing with dynamic (de)selection of PSA UPF(s) to serve a 5G
VN group
This clause describes a potential optional added mechanism to deal with
dynamic (de)selection of PSA UPF(s) to serve a 5G VN group:
\- When a PDU session established for a UE belonging to 5G VN group is using a
new PSA UPF, then the PSA UPF needs to be added to the overlay DN network
described in Figure 6.16.2-2. N6 forwarding capabilities (e.g. VPN tunnels)
may need to be established to connect the PSA UPF to the overlay DN network.
\- Conversely, when the last UE belonging to a 5G VN group has its PDU session
released from a PSA UPF, then this PSA UPF no longer needs to be part of the
overlay DN network described in Figure 6.16.2-2.
The mechanism works as follows
\- An AF (Application Function) is responsible of the overlay DN network that
is associated with a 5G VN group, i.e. this AF may control the establishment /
release of the N6 tunnels described in Figure 6.16.2-2.
\- This AF subscribes (Nnef_EventExposure_Subscribe) for the \"usage of PSA
UPF\" event providing (as defined in clause 4.15.6.2 of TS 23.502 [3] for 5G
VN group creation or modification) an External Group ID identifying the 5G VN
Group. The \"usage of PSA UPF\" event corresponds to either:
\- A PDU session related with the 5G VN group is served by a new PSA UPF; or
\- The last PDU session related with the 5G VN group and served by a PSA UPF
has been released.
Editor\'s note: It is FFS the impacts to support \"usage of PSA UPF\" event.
\- The AF Request is authorized by NEF, validated by the UDM as defined in
steps 2 to 6 in clause 4.15.6.2 of TS 23.502 [3].
\- The AF subscription is provided (Nudm_SDM_Notification) to the SMF as
defined in clause 4.15.6.2 of TS 23.502 [3] for 5G VN group related data.
\- Whenever the SMF detects the Event corresponding to the insertion/ removal
of a PSA UPF to serve the DNN and S-NSSAI associated with the 5G VN group, it
notifies the AF accordingly providing the N6 addressing information of the PSA
UPF that has been added or removed. This N6 addressing information may be
retrieved from UPF information in NRF and correspond to the ipv4AddressRanges
and Ipv6PrefixRanges for the DNN and S-NSSAI associated with the 5G VN group
that are defined in Table 6.1.6.2.15-1 of TS 29.510 [12].
Based on the SMF notifications, the AF may update the N6 forwarding
capabilities (e.g. VPN tunnels, PE router configuration).
Editor\'s note: It is FFS the additional information (in addition to N6
addressing information) in the reporting of \"usage of PSA UPF\" event, so AF
can use such information to configure N6 forwarding capabilities (e.g. VPN
tunnels, PE router configuration).
Editor\'s note: The information flow for above dynamic (de)selection of PSA
UPF(s) to serve a 5G VN group is FFS.
### 6.16.3 Procedures
3GPP procedures are not impacted by this solution unless the potential
optional mechanism described in 6.16.2.5 clause would apply.
### 6.16.4 Impacts on existing entities and interfaces
This clause assumes that the potential optional mechanism described in clause
6.16.2.5 is not specified, otherwise:
\- An AF (Application Function) is responsible of the overlay DN network that
is associated with a 5G VN group, i.e. this AF may control the establishment /
release of the N6 tunnels described in Figure 6.16.2-2.
\- This AF subscribes (Nnef_EventExposure_Subscribe) for the \"usage of PSA
UPF\" event providing (as defined in clause 4.15.6.2 of TS 23.502 [3] for 5G
VN group creation or modification) an External Group ID identifying the 5G VN
Group. The \"usage of PSA UPF\" event corresponds to either
\- A PDU session related with the 5G VN group is served by a new PSA UPF, or
\- The last PDU session related with the 5G VN group and served by a PSA UPF
has been released.
\- The AF Request is authorized by NEF, validated by the UDM as defined in
steps 2 to 6 of clause 4.15.6.2 of TS 23.502 [3].
\- The AF subscription is provided (Nudm_SDM_Notification) to the SMF as
defined in clause 4.15.6.2 of TS 23.502 [3] for 5G VN group related data:
\- Whenever the SMF detects the Event corresponding to the insertion/ removal
of a PSA UPF to serve the DNN and S-NSSAI associated with the 5G VN group, it
notifies the AF accordingly providing the N6 addressing information of the PSA
UPF that has been added or removed. This N6 addressing information may be
retrieved from UPF information in NRF and correspond to the ipv4AddressRanges
and Ipv6PrefixRanges for the DNN and S-NSSAI associated with the 5G VN group
that are defined in Table 6.1.6.2.15-1 of TS 29.510 [12].
\- Based on the SMF notifications, the AF may update the N6 forwarding
capabilities (e.g. VPN tunnels, PE router configuration).
UPF: Support of VPN solution towards N6, e.g. to act as Provider Edge router
in IP/E VPN solution based on IETF RFCs.
The solution assumes that the PSA UPFs of the 5G VN group are either:
\- connected via N6 to a \"native\" DN where the UE\'s Ethernet (PDU Session
type Ethernet) or IP traffic (IP based PDU Session types) can be forwarded; or
\- connected via N6 to an IP based transport network which allows IP
connectivity between the PSA UPFs.
Several VPN solutions exist based on IETF standards and in deployments.
Examples of VPN solutions could be documented in a 3GPP annex to show the IETF
protocols that are already available.
## 6.17 Solution #17: Allowing 5G VN group member UE simultaneously send data
to different multicast groups with different QoS policy
### 6.17.1 Introduction
This solution aims to address the key issue #5: Allowing UE to simultaneously
send data to different groups with different QoS policy. In particular, it
addresses the following requirements from clause 6.13.2 of TS 22.261 [6]:
\- The 5G system shall allow a UE to request a communication service to
simultaneously send data to different groups of UEs at the same time.
\- The 5G system shall allow different QoS policy for each group the UE
communicates with.
This solution assumes that a UE with one dedicated application is a group
member of a 5G VN group, and the dedicated application can join multiple
Ethernet multicast groups. This application on the UE can generate the data
and replicates multiple copies of the data, and then each copy is sent to a
different Ethernet multicast destination that corresponds to a different
Ethernet multicast group. The transmission of the copy within the different
Ethernet multicast group needs different QoS treatment because of the
different purpose of data usage for the Ethernet multicast group. The UE maps
the data sent to different multicast groups on different QoS Flows of one
single Ethernet PDU Session.
NOTE: If SA WG1 requirements need the UE to send data to different IP
multicast groups, then this solution can be applicable by replacing the
Ethernet mulitcast address with IP multicast address, Ethernet PDU Session
with IP PDU session.
### 6.17.2 Functional Description
The following are the main principles of the solution:
\- UE is a group member within a 5G VN group, and the UE/App can join multiple
Ethernet multicast groups.
\- 5G VN group subscription data contains different instances of Application
descriptor, each for a multicast address for distinct multicast group. The UE
is provisioned/signalled with the multiple URSP rules, all the URSP rules has
the same Route Selection [including 5G VN group DNN, 5G VN group S-NSSAI,
Ethernet PDU Type], but different Traffic descriptors that is distinguished by
the multicast address for multicast group.
\- The UE application traffic targeting to different multicast groups will
trigger the UE to find the same PDU Session with 5G VN group DNN/S-NSSAI/PDU
Type by using the matched URSP rules.
\- 5G VN group subscription data contains different instances of group QoS
Policy, where each instance is distinguished by the multicast address for
multicast group. During establishment of the PDU Session targeting to the 5G
VN group, the SMF retrieves the group QoS Policy as part of the 5G VN group
subscription data (if dynamic PCC is not to be used) or as part of the PCC
rules (if dynamic PCC is to be used). Then the SMF will setup multiple QoS
Flows in the PDU Session, the QoS Profile (e.g. QoS Rule or N4 Rule) for each
QoS flow contains different QoS parameters and multicast addresses that are
derived from the group QoS Policy.
\- UE simultaneously sends data to different multicast groups via different
QoS Flows within the PDU Session targeting to the 5G VN group.
Figure 6.17.2-1 depicts the architecture to support the solution: Allowing 5G
VN group member UE simultaneously send data to different multicast groups with
different QoS policy.
Figure 6.17.2-1: Architecture to support 5G VN group member UE simultaneously
sending data to different multicast groups with different QoS policy
### 6.17.3 Procedures
1\. The AF manages the 5G VN group as in clause 4.15.6.2 of TS 23.502 [3]. The
group members in the 5G VN group can join more than one multicast groups: then
the 5G VN group subscription data contains multiple instances of Application
descriptor, each corresponds to a target multicast group. The instance of the
Application descriptor contains the multicast address of the multicast group.
\- The 5G VN group subscription data contains multiple instances of
Application descriptor, each corresponds to a target multicast group. The
instance of the Application descriptor contains the multicast address of the
multicast group. This can be achieved using existing mechanism.
\- The 5G VN group subscription data contains multiple instances of group QoS
Policy, each corresponds to a target multicast group. The instance of the
group QoS Policy contains the multicast address of the multicast group and
distinct QoS requirements. The exact QoS requirements and provisioning
procedures depend on the solutions to key issue #1, specifically for
provisioning of QoS applicable to each UE of the group and may correspond to
evolutions with regard to R17 QoS model.
2\. The UE is provisioned with the URSP rules used for the 5G VN group as in
clause 5.29.2 of TS 23.501 [2], clauses 4.16.11 and 4.16.12.2 of TS 23.502
[3]. Each URSP rule contains a different Traffic Descriptor and the same Route
Selection component. The Traffic Descriptor is differentiated by the multicast
address of the multicast group.
3\. With the URSP rules for the 5G VN group, the UE group member can match the
application data targeting to different multicast groups to the same PDU
Session associated with the DNN, S-NSSAI and PDU Session type of the 5G VN
group. This step can be achieved using mechanism in clause 6.6.2 of TS 23.503
[4], i.e. URSP as defined in Rel-17 specifications is reused without any
enhancements.
4\. During PDU Session establishment procedure, the SMF obtains group QoS
Policy as part of 5G VN group subscription data or obtains group QoS Policy as
part of the PCC rules. The SMF can set up multiple QoS Flows within the PDU
Session, the QoS profile for each QoS Flow is derived from the instance of the
group QoS Policy corresponding to a target multicast group. The exact
execution procedures depend on the solutions to key issue #1, specifically for
provisioning of QoS applicable to each UE of the group.
NOTE: The group QoS Policy as part of the PCC rules describe the Ethernet
multicast group and QoS parameters, e.g. IP/Ethernet multicast addresses, VLAN
headers that are specific to individual multicast group. The SMF obtains group
QoS Policy as part of PCC rules for a group member per Rel-17 procedures and
interfaces during the lifetime of the PDU Session.
### 6.17.4 Impacts on existing entities and interfaces
AF/NEF/UDM/UDR: Support provisioning group QoS policy (multicast address and
QoS parameters) for each individual multicast group as part of the 5G VN group
data. This may depend on solutions to KI# 1
Either SMF or PCF: Support group QoS policy in 5G VN group data received from
UDM/UDR.
## 6.18 Solution #18: Support Group service area restriction with using Area
of interesting
### 6.18.1 Introduction
This solution is for Key Issue #1, it addresses particularly how to enforce
the service area restriction for a group of UEs.
This solution re-uses the area of interesting mechanism defined in clause
5.6.11 of TS 23.501 [2].
### 6.18.2 Functional Description
To address how to enforce the service area restriction for a UE of group, this
solution follows the principles below:
\- The solution can be applied to the general group.
NOTE 1: This solution intent to define a solution which is not only used for
VN Group. If there is no use case/requirement for the Group other than VN, it
can be only applied for VN group.
\- The AF provides the group membership and area restriction to the NEF. The
NEF further store these information to the UDM/UDR. This step can be on the
top of solution#9/10/13.
\- During PDU session establishment, the SMF subscribe to UDM notifications of
UE and Group Subscription data updates.
\- The UDM/UDR notifies the SMF with the UE and group subscription data
including the area restriction.
\- SMF subscribe to notifications from the AMF for an Area of Interest via
Namf_EventExposure_Subscribe. Based on the notification about the UE presence
in Area of Interest notified by AMF, the SMF takes actions based on
operator\'s policy.
NOTE 2: UE may interact with AF to get area restriction information which is
out of 3GPP scope.
### 6.18.3 Procedures
Figure 6.18.3-1: Procedures for support of SMF service area
1\. The AF provides the group membership and area restriction to the NEF. The
NEF authorizes the request and may convert the area provides by AF to TAIs or
cell lists. The NEF further store these information to the UDM/UDR. This step
can be on the top of solution#9/10/13.
2\. UE initiates PDU session establishment.
3\. AMF sends PDU session establishment request to SMF with the user location
information.
4\. SMF retrieves SM subscription data from UDM and subscribe the group
information from UDM. The UDM/UDR notifies the SMF with area restriction
information by sending Nudm_SDM_notification Notify when it receives the
updated area restriction information from AF/NEF.
5\. Based on the notification from UDM/UDR and the user location information
from AMF, SMF determines whether the UE is within the group service area, and
takes actions based on operator\'s policy (e.g. to reject the PDU session
establishment if UE is out of the group service area).
6\. SMF subscribe to notifications from the AMF for an Area of Interest (i.e.
area restriction) via Namf_EventExposure_Subscribe service operation.
7\. The AMF send RAN with Location Reporting Control (Reporting Type, Area Of
Interest).
8\. NG-RAN determines the UE presence in the area of interest has changed and
notifies the AMF.
9\. The AMF detects the UE presence in the area of interest and it sends the
event report by means of Namf_EventExposure_Notify message to the SMF.
10\. Based on the notification about the UE presence in Area of Interest
notified by AMF, the SMF takes actions based on operator\'s policy.
### 6.18.4 Impacts on existing entities and interfaces
**\- SMF:**
\- receives the area restriction from UDM/UDR.
\- subscribe the UE presence of AOI with AMF.
**\- AF:**
\- Able to provide Area restriction information and group of UEs to NEF.
**\- NEF:**
\- Able to map Area restriction provided by AF to TAIs or cell lists, and
provide Area restriction and group information to the UDM/UDR.
**\- UDM/UDR:**
\- Notify the SMF with Area restriction and group information.
## 6.19 Solution #19: Solution of Multiple SMFs for VN group communication
### 6.19.1 Introduction
This solution is to address the Key Issue #4 on enhancements of 5G VN group
communication. It introduces a new indicator in 5G VN group data which is
aiming to inform the SMF whether the procedures used for multiple SMFs is
applicable for this 5G VN group.
For example, if one dedicated SMF is enough to support a certain 5G VN group,
then it\'s not necessary for the SMF to continue the procedures with NRF or
GSMF. And also, if the 5G VN group will use N6 based switch, then it\'s also
not necessary for the SMF to continue the procedures with NRF or GSMF. So,
this solution can be regard as the trigger point for the KI#4 and can be
collaborate with other solutions on the same KI topic.
Moreover, the requirement of 5G VN that contains multiple SMFs is to cover
wider area. And **\"Service Area\" attribute will be added in group data
according to KI#1, so the \"Service Area\" attribute can be taken into
consideration to decide whether to deploy single SMF or multiple SMFs for 5G
VN group communication by operators.**
### 6.19.2 Functional Description
The main idea of this solution is as below:
\- Enhance the parameter provisioning service by introducing the Single-SMF
indicator information as a new optional input parameter, and this Single-SMF
indicator is stored as part of the group data in group subscription data.
\- The Single-SMF indicator can be provisioned to UDM directly as part of the
group data.
\- Or, the Single-SMF indicator can be provisioned dynamically by AF as an
optional parameter.
\- Or, the Single-SMF indicator can be transformed or generated by the NEF
based on service area info that provided by AF and operator\'s pre-
configuration, and then provisioned to the UDM.
\- SMF can retrieve such indicator from UDM or be notified by UDM via the
group subscription data.
\- In case the indicator exist, the SMF can be informed that this 5G VN group
does not require multiple SMF to serve and will not continue the other
procedures which may lead to additional interaction with other nodes. For
example registration or updating its profile to NRF(Solution #4) or Group
Session Management Function(Solution #5).
\- In case the indicator doesn\'t exist, the SMF can continue the procedure
which will be addressed by other solutions for KI#4.
### 6.19.3 Procedures
Editor\'s note: This clause describes high-level procedures and information
flows for the solution.
Figure 6.19.3-1 outlines the procedure for support of Single-SMF indicator.
Figure 6.19.3-1: Procedures for support of Single-SMF indicator
1\. The AF provides information of a group to be created or updated in
Nnef_ParameterProvision_Create or Nnef_ParameterProvision_Update to create.
The Single-SMF indicator is contained as an optional Group Data information.
2\. The NEF requests to create or update group subscription data (External
Group ID, Group Data, and Group Membership) via Nudm_ParameterProvision_Create
or Nudm_ParameterProvision_Update.
The Single-SMF indicator can also be transformed or generated by the NEF based
on service area info that provided by AF and operator\'s pre-configuration.
3\. The UDM may read from UDR, by means of Nudr_DM_Query, corresponding group
subscription data in order to validate required data updates and authorize
these changes for group for the corresponding AF.
4\. The UDM updates the UE subscription data and/or group subscription data,
and requests to create or update UE subscription data and/or group
subscription data via Nudr_DM_Create/Update.
5\. The UDM responds the NEF with Nudm_ParameterProvision_Create/Update
Response.
6\. The NEF responds the AF with Nnef_ParameterProvision_Create/Update
Response.
7\. The UDM provides group subscription data to AMF or SMF as \"Subscription
Data, Group Data\" data type via Nudm_SDM_Notification or Nudm_SDM_Get.
The UDM can provide the AMF with the group subscription data via
Nudm_SDM_Notification when there are UE group member(s) already registered via
the AMF or via Nudm_SDM_Get Response when the first UE group member is
registering via the AMF.
The UDM can provide the SMF with the group subscription data via
Nudm_SDM_Notification when there are ongoing PDU Session(s) accessing the
group established via the SMF or via Nudm_SDM_Get Response when the first PDU
Session accessing the group is going to be established via the SMF.
8\. The UDR provides group subscription data to PCF as \"Subscription Data,
Group Data\" data type via Nudr_DM_Query or Nudr_DM_Notify.
9\. The UE initiates 5G VN group DNN PDU session establishment request.
10\. When receiving the session establishment request from the VN group
member, the AMF shall always select the same SMF for this certain VN group if
the Single-SMF indicator exist in the group subscription data.
11\. AMF sends PDU session establishment request to SMF.
12\. SMF retrieves SM subscription data from UDM with
Nudm_SubscriberDataManagement request include 5G VN group data. If the Single-
SMF indicator exist, the SMF will be informed that whether the procedures used
for multiple SMFs is applicable for this 5G VN group.
If the procedures used for multiple SMFs is applicable for this 5G VN group,
the solution procedure addressed for KI#4 can be proceed. For example
registration or updating its profile to NRF(Solution #4) or Group Session
Management Function(Solution #5).
13\. Finish rest of the Session Management procedures.
### 6.19.4 Impacts on existing entities and interfaces
NEF/UDM: The parameter provisioning service can support Single-SMF indicator
as a new input parameter for management of a 5G VN group.
NEF: The NEF transforms or generates the service area info that provided by AF
to the Single-SMF indicator based on operator\'s pre-configuration.
UDM/UDR: The group subscription data can contain 5G VN group membership
information and 5G VN group data including the Single-SMF indicator.
AMF: With the indicator retrieve from UDM or be notified by UDM, the AMF can
be notified that to select the same SMF for this 5G VN group.
SMF: With the indicator retrieve from UDM or be notified by UDM, the SMF can
be informed that this 5G VN group does not require multiple SMF to serve and
will not continue the other procedures which will be defined by KI#4. For
example registration or updating its profile to NRF(Solution #4) or Group
Session Management Function(Solution #5).
## 6.20 Solution #20: Solution on signalling scalability issues for large VN
groups with lots of devices into account
### 6.20.1 Introduction
This solution is for Key Issue #4, it addresses particularly how to enforce
the service area restriction for a group of UEs. Particular, the solution
focus on the scalability issue in the KI#4.
\- How to manage communication among the UE group members when they are served
by different UPFs and different SMFs including the case of UE(s) mobility,
this needs to take the signalling scalability issues for large VN groups with
lots of devices into account.
From the R16, there is a condition for the VN.
\- When N19 is used, there is a full mesh of N19 tunnels between UPFs serving
the 5G VN group.
When there are multiple SMFs/UPFs, if the full mesh mechanism is used, there
are more C/U-plane connections.
e.g. there are M SMFs and N UPFs, with the full mesh topology, the:
\- signalling connection between SMFs is, = M * (M-1) / 2.
\- number of N19 tunnels is, = N * (N-1)/2.
From the following figure, when the number of node (e.g. SMF/UPF) exceeds 4,
the star topology has more advantages.
Figure 6.20.1-1
So there is a need to reduce the number of interfaces from the square of the
number of nodes to a linear relationship of the number of nodes.
On the top of solution 4, it paper further proposes a solution to change to
full mesh topology to star topology when the complexity of topology exceeds
the threshold. The following figure the star topology for the SMFs. For the
UPFs, it is similar.
Figure 6.20.1-2
### 6.20.2 Functional Description
When the relay-SMF is needed, there is one relay-SMF/UPF for each VN Group.
There are 3 functionalities for this solution:
1) Relay-SMF discovery.
There are two mechanism for relay-SMF discovery:
\- Pre-configured in SMF. The operator know the star topology is needed, the
SMF supporting VN is pre-configured with pair (DNN/S-NSSAI, relay-SMF). The
DNN-S-NSSAI is used for VN.
\- Via NRF. The relay-SMF register itself in NRF as relay-SMF for the VN. SMF
can check the relay-SMF with DNN/S-NSSAI used for the VN.
If relay-SMF is failure, it need to select a new Relay-SMF and re-establish
the inter-SMF connection. The SMF may subscribe the relay-SMF status with NRF.
The NRF notify the relay-SMF status as specified in the TS 23.527 [14].
The relay-UPF is similar with Backbone router which handle the traffic
aggregation, the relay-SMF need to select relay-UPF which can serve this VN,
e.g. according to configuration. The load control and overload control
mechanism of relay-UPF refer to clauses 6.2.3 and 6.2.4 of TS 29.244 [13].
2) Routing information exchange.
\- When a SMF start to serve the VN (from 1st PDU session for the VN is
established), it discover the relay-SMF and register itself for the VN in NRF.
\- The SMF send the routing information to the relay-SMF, i.e. IP address. MAC
address for the PDU session.
\- When MAC address detected, no more valid, the SMF indicate the relay-SMF
the change.
\- When PDU session is released, the SMF indicate the relay-SMF to remove the
related address.
NOTE: The relay-SMF does not need to send the routing information of this SMF
to other SMFs for this VN.
\- When all the PDU session for the VN are release in one SMF, the SMF release
the N19 between UPF controlled by the SMF and relay-UPF.
\- For the destination is unknown to SMF, it send to relay-UPF controlled by
relay-SMF.
\- Because the relay-SMF know all the routing information, it can configure
the PDR/FAR in the relay-UPF to forward.
3) Co-existence with sol#4.
In some regions, there may be multiple SMFs for the VN, example, in the
following figure.
To avoid un-necessary traffic to relay-UPF, e.g. the packet from PDU session
under SMF-1 to PDU session under SMF-2, this solution can work with sol#4.
Figure 6.20.2-1
The relay-SMF discovery is same with above procedure.
The SMF-1/2/3 use the solution#4 with full mesh mechanism
The UPFs under SMF-1/2/3 only send the packet not related to UPFs under
SMF-1/2/3.
Another option is, for one region, only 1 SMF is assigned for the VN.
### 6.20.3 Procedures
Similar with sol#4.
### 6.20.4 Impacts on existing entities and interfaces
SMF/UPF:
\- Update/Register serving VN ID to NRF.
\- Discover relay-SMF.
\- Establishes the VN session with relay-SMF serving the same VN group and
send routing information about UE members and their address, including
addition and removal of such addresses) to relay-SMF.
Relay-SMF/UPF:
\- Establishes the VN session with SMF serving the same VN group.
\- configure the relay-UPF with PDR/FAR according to the received routing
information.
## 6.21 Solution #21: Support for attribute of Maximum Bit Rate for a 5G VN
group
### 6.21.1 Introduction
This solution aims to address the KI#1: Enhance group attribute management
### 6.21.2 Functional Description
#### 6.21.2.1 Attribute of Maximum Bit Rate for a 5G VN group
This solution proposes a method for management and control of maximum bit rate
for a 5G VN group, with following principles:
\- A Group Session Management Function (GSMF) is introduced in 5GC control
plane. GSMF is responsible for storing the status of the activated 5G VN group
members and their maximum bit rate.
Editor\'s note: It is FFS whether the GSMF functionality is better handled as
part of an existing NF.
\- The 5G VN group data is extended to include Group-MBR. Group-MBR limits the
total bit rate that can be expected to be provided across all sessions of a 5G
VN group.
\- The existing UDM parameter provisioning service for 5G VN group data
provisioning is re-used, with the difference that the 5G VN group data may
contain a Group-MBR as a new input parameter. The Group-MBR is also stored as
part of the 5G VN group data in UDR. GSMF can obtain Group-MBR from UDM.
\- The existing NEF parameter provisioning service for 5G VN group data
provisioning is re-used, with the difference that the 5G VN group data may
contain a Group-MBR as a new input parameter.
\- When a SMF completes the process of a 5G LAN PDU session establishment.
\- SMF sends a group update request to GSMF. The request message includes UE
ID, 5G VN group ID, Session-AMBR for Non-GBR QoS flow and MFBR for GBR QoS
flow, etc.
\- GSMF updates and stores the sum of the Session-AMBR and MFBR for GBR QoS
Flows of all PDU Sessions in the VN Group.
\- The SM Policy Association establishment/modification message sent by SMF to
PCF shall include the 5G VN group ID.
\- When a PCF receives SM Policy Association establishment/modification
message from SMF:
\- PCF query GSMF to retrieve the group information.
\- The group information provided by GSMF includes:
\- The sum of the Session-AMBR and MFBR for GBR QoS Flows of all PDU Sessions
in the VN Group.
\- Group-MBR.
\- Based on the group information provided by GSMF, PCF makes corresponding
decisions.
\- When a 5G LAN PDU session is modified/released:
\- SMF sends a group update request message to GSMF.
\- GSMF updates the sum of the Session-AMBR and MFBR for GBR QoS Flows of all
PDU Sessions in the VN Group.
Figure 6.21.2.1-1 depicts the architecture to support the management of
Maximum Bit Rate for a 5G VN group:
Figure 6.21.2.1-1: Architecture to support the management of Maximum Bit Rate
for a 5G VN group
Editor\'s note: It is FFS whether the GSMF functionality is better handled as
part of an existing NF.
### 6.21.3 Procedures
#### 6.21.3.1 Procedure for support of the attribute of Group-MBR for a VN
group when a UE initiates a 5G LAN PDU session establishment request
Figure 6.21.3.1-1 outlines the procedure for support the attribute of Group-
MBR for a VN group when a UE initiates a 5G LAN PDU session establishment
request.
Figure 6.21.3.1-1: Procedures for support of the attribute of maximum number
of users for a VN group when a UE initiates a 5G LAN PDU session establishment
request
1\. Based on local configuration or signal trigger, GSMF subscribe to 5G VN
Group data from UDM.
2\. UE sends PDU Session Request to the SMF.
3\. SMF sends SM Policy Association Establishment Request. The message shall
include the 5G VN group ID.
4\. PCF performs GSMF selection through local configuration or NRF.
Editor\'s note: It is FFS what parameters GSMF carries when registering to
NRF. This may be further analysed when the functionality of the GSMF is
clearer.
5\. PCF query GSMF to retrieve the group information.
6\. GSMF provide group information. The Group information includes Group-MBR
and the sum of the Session-AMBR and MFBR for GBR QoS Flows of all PDU Sessions
in the VN Group.
7\. PCF makes policy decisions based on message received from GSMF.
Editor\'s note: This solution supports policy control when members in VN group
belong to different PCF.
If the sum of bit rate allocated for the PDU sessions currently active UEs of
a 5G VN group reached Group-MBR , PCF can make the following decisions:
a) PCF provides an indication to the SMF indicating the Group-MBR is
overflown.
b) PCF changes Session-AMBR value or MFBR value in PCC rules belonging to GBR
service data flows and interacts with the SMF accordingly.
c) PCF rejects the establishment of the SM Policy Association and responds to
SMF with a proper cause code.
d) PCF rejects new GBR service data flows with high GBR requirements.
e) Other decisions depending on the operator\'s policies.
8\. PCF sends SM Policy Association Establishment Response (clause 4.16.4 of
TS 23.502 [3]).
9\. SMF sends PDU session Setup Response to UE.
If the PCF provides an indication to SMF indicating the Group-MBR is
overflown, SMF shall reject the PDU Session with a suitable cause code or
action according to the operator\'s policy.
10\. If the new PDU session is accepted, SMF sends group information update
request to GSMF. The request message includes UE ID, 5G VN group identifier,
Session-AMBR for Non-GBR QoS flow and MFBR for GBR QoS flow.
11\. GSMF updates and stores the group information.
12\. GSMF sends Response to SMF with successful update indication.
#### 6.21.3.2 Procedure for support of the attribute of Group-MBR for a VN
group when a UE or network initiates a 5G LAN PDU session release request
Figure 6.21.3.2-1 outlines the procedure for support of the attribute of
Group-MBR for a VN group when a UE or network initiates a 5G LAN PDU session
release request.
Figure 6.21.3.2-1: Procedures for support of the attribute of Group-MBR for a
VN group when a UE or network initiates a 5G LAN PDU session release request
1\. Step 1 follows the UE or network initiated PDU session release procedure
already defined in TS 23.502 [3].
2\. SMF completes the 5G LAN PDU session release produce, then it sends a
group information update request message to GSMF, which contains VN Group ID,
UE ID, etc.
3\. GSMF updates the sum of the Session-AMBR and MFBR for GBR QoS Flows of all
PDU Sessions in the VN Group.
4\. GSMF sends a Response to the SMF with successful update indication.
#### 6.21.3.3 Procedure for support of the attribute of Group-MBR for a VN
group when a UE or network initiates a 5G LAN PDU session modification request
Figure 6.21.3.3-1 outlines the procedure for support of the attribute of
Group-MBR for a VN group when a UE or network initiates a 5G LAN PDU session
modification request.
Figure 6.21.3.3-1: Procedures for support of the attribute of Group-MBR for a
VN group when a UE or network initiates a 5G LAN PDU session modification
request
1\. UE or network initiated PDU session modification procedure as defined in
clause 4.3.3 of TS 23.502 [3].
2\. SMF completes the 5G LAN PDU session modification process, and then sends
a group information update request message to GSMF, which contains VN Group
ID, UE ID, Session-AMBR for Non-GBR QoS flow and MFBR for GBR QoS flow, etc.
3\. GSMF updates the sum of the Session-AMBR and MFBR for GBR QoS Flows of all
PDU Sessions in the VN Group.
4\. GSMF sends a Response to the SMF with successful update indication.
### 6.21.4 Impacts on existing entities and interfaces
**AF:**
\- Provides 5G VN group-MBR to NEF as a parameter of 5G VN group data
information.
**NEF:**
\- Provides 5G VN group-MBR to UDM as a parameter of 5G VN group data
information.
**UDR:**
\- Storage of the 5G VN group subscription data including 5G VN group-MBR
information.
**UDM:**
\- Manages the 5G VN group data including 5G VN group-MBR information via
interacting with UDR based on the NEF request.
**GSMF:**
\- A new NF is introduced to store the status of the activated 5G VN group
members and their maximum bit rate.
\- Be able to subscribe to 5G VN Group data from UDM.
\- Be able to update and store the group information and send the indication
to SMF in case the Group-MBR is overflown.
**SMF:**
\- Send a group information update request after completing the process of a
5G LAN PDU session establishment/modification/release.
\- Be able to reject the 5G LAN PDU session with a suitable cause code or
operate according to the operator\'s policy when receiving the indication from
PCF to indicate the Group-MBR is overflown.
**PCF:**
\- Be able to query GSMF to retrieve the group information.
\- Be able to make policy decisions based on the group information received
from GSMF (e.g. an indication to the SMF indicating the Group-MBR is
overflown).
## 6.22 Solution #22: Support for traffic characteristics provisioning and
performance characteristics monitoring
### 6.22.1 Introduction
This solution addresses KI#3 on NEF exposure framework for provisioning of
traffic characteristics and monitoring of performance characteristics.
### 6.22.2 Functional Description
#### 6.22.2.1 Parameters related to Traffic Characteristics provisioning and
Performance Characteristics monitoring
The current AFsessionWithQoS services allows an AF to provide QoS information
and request to be notified when QoS parameters cannot be met. This solution
re-uses those capabilities but extends the API to allow an AF to provide a
request for a group of UEs.
Editor\'s note: Current AFsessionWithQoS requires that the AF provides a UE IP
or MAC address. It can be determined during normative phase whether a new NEF
service should be defined to handle Groups of UEs instead of enhancing
AFsessionWithQoS service.
KI#3 lists several parameters as examples of parameters applicable to Traffic
Characteristics provisioning and Performance Characteristics monitoring. Most
of these have corresponding 5GC parameters already that are also available in
the existing AFsessionWithQoS service. Below the parameters mentioned in KI#3
are listed, and the corresponding parameters provided by the AF in this
solution is indicated:
\- Transfer interval: AF can provide Periodicity.
\- Data volume per cycle time: AF can provide Maximum Data Burst Size.
\- Average and Peak data rate: AF can provide GBR and MBR parameters.
\- Silence time interval: It is proposed that the AF can provide a validity
time for the requested QoS. Validity time may be extended to support periodic
validity times.
\- PDU Session Type: Already available when a 5GVN group is created.
\- End-to-end latency: AF can provide Request 5GS Delay. This is mapped by
TSCTSF to Requested PDB, as per existing specification.
\- Service bit rate: AF can provide GBR and MBR parameters, as described
above.
\- Packet error rate: It is not possible for AF to provide PER in Rel-17, but
it has been agreed in FS_5TRS_URLLC study to add support in Rel-18.
For the rest of the above parameters, with the exception of validity time,
they are all supported in Rel-17 or are being added as part of Rel-18. Those
parameters are thus re-used for this solution (some of the parameters, e.g.
Periodicity, are only applicable to TSC cases). Defining new exposure
parameters that are similar to already existing parameters, and then let a 5GC
NF (e.g. NEF or TSCTSF) map between these new parameters and existing exposure
parameters risk creating duplication and ambiguities and should be avoided. In
case there is some specific mapping needed, this can be done by the Service
Enabler Architecture Layer (SEAL) defined by SA WG6.
KI#3 mentions two additional example parameters: Communication service
availability (CSA) and Communication service reliability (CSR). It is not
clear how the 5GC can monitor the availability/reliability of a service as
this would require e2e application-level monitoring. This should thus be
monitored on application level. Reliability is also typically related to very
long timescales (e.g. years). 5GC already allows monitoring of 5GC-related
information for the availability of a UE or a PDU Session via existing NEF
monitoring API, e.g. Loss of connectivity, UE reachability, communication
failure, PDU Session Status. Therefore, explicit monitoring of CSA and CSR via
NEF API are not needed and are proposed to be not supported.
#### 6.22.2.1a Performance Characteristics monitoring
The current AFsessionWithQoS services allows an AF to request to be notified
when QoS parameters cannot be met. The AF can e.g. request QoS monitoring
information, where the 5GC reports packet delay information to the AF, as
described in clause 5.33.3 of TS 23.501 [2]. This can also be supported using
QoS notification control (QNC) as described in TS 23.501 [2], clause 5.7.2.4.
This solution proposes to re-use those mechanisms as they are sufficient to
solve KI#3.
For QoS monitoring, the AF can provide reporting thresholds for the UL, DL or
RT delays. The 5GC will in this case report the UL, DL or RT if exceeding the
thresholds, based on existing specifications.
For QoS notifications, the AF can request to be notified when resources cannot
be met (and when resources can be met again). This ensures that the AF is
notified when there is an issue with the connection. As described in clause
5.7.2.4 of TS 23.501 [2], an AF can request QNC with or without providing
Alternative QoS Profiles (AQP). AQPs can e.g. be used if the AF needs more
information about the QoS being met in RAN. If the AF provides AQPs, these
will be forwarded by the PCF to NG-RAN. If NG-RAN determines that the GFBR,
the PDB or the PER of the QoS profile cannot be fulfilled, NG-RAN shall send a
notification to SMF. SMF notifies PCF that in turn notifies the AF. The
notification includes a reference to the AQP that contains the PER, PDB and/or
GFBR value(s) that is currently experienced by NG-RAN. Therefore, by creating
suitable AQPs, an AF can control what information is received in the
notifications. If e.g. an AF is interested in being notified when PER reaches
a certain value, the AF provides an AQP containing that PER value. If an AF is
instead interested in being notified when PDB reaches a certain value, the AF
provides an AQP containing that PDB value. Multiple AQPs may be provided by
the AF in a single request.
This solution re-uses this existing feature and there are therefore no impacts
to RAN.
Editor\'s note: An Alternative QoS Profile represents a combination of QoS
parameters PDB, PER and GFBR to which the application traffic is able to
adapt. How to set AQP with only one parameter value is FFS.
#### 6.22.2.2 Performance Characteristics Monitoring using NWDAF
5GS provides several mechanisms to use NWDAF to expose performance
characteristics towards a 3rd party AF.
The existing NWDAF service for DN service performance statistics can be used
by an AF to request performance monitoring information for specific
applications for a single UE or a group of UEs. The NWDAF DN service
performance is described in clause 6.14 of TS 23.288 [8]. It can be requested
by an AF via NEF, as described in clause 6.1.1.2 of TS 23.288 [8]. The DN
service performance statistics contains the information shown in Table
6.22.2-1:
Table 6.22.2-1: DN service performance statistics
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | Application ID | Identifies the application for | | | which analytics information is | | | provided. | +----------------------------------+----------------------------------+ | S-NSSAI | Identifies the Network Slice for | | | which analytics information is | | | provided. See note 1. | +----------------------------------+----------------------------------+ | DNN | Identifies the data network name | | | (e.g. \"internet\") for which | | | analytics information is | | | provided. See NOTE 1. | +----------------------------------+----------------------------------+ | DN performance (0-x) | List of DN performances for the | | | application. | +----------------------------------+----------------------------------+ | > Application Server Instance | Identifies the Application | | Address | Server Instance (IP address/FQDN | | | of the Application Server). | +----------------------------------+----------------------------------+ | > Serving anchor UPF | The involved anchor UPF. See | | | NOTE 2. | +----------------------------------+----------------------------------+ | > DNAI | Identifier of a user plane | | | access to one or more DN(s) | | | where applications are deployed | | | as defined in TS 23.501 [2]. | +----------------------------------+----------------------------------+ | > Performance | Performance indicators. | +----------------------------------+----------------------------------+ | >> Average Traffic rate | Average traffic rate observed | | | for UEs communicating with the | | | application. See NOTE 3. | +----------------------------------+----------------------------------+ | >> Maximum Traffic rate | Maximum traffic rate observed | | | for UEs communicating with the | | | application. See NOTE 3. | +----------------------------------+----------------------------------+ | >> Average Packet Delay | Average packet delay observed | | | for UEs communicating with the | | | application. See NOTE 3. | +----------------------------------+----------------------------------+ | >> Maximum Packet Delay | Maximum packet delay for | | | observed for UEs communicating | | | with the application. See | | | NOTE 3. | +----------------------------------+----------------------------------+ | >> Average Packet Loss Rate | Average packet loss observed for | | | UEs communicating with the | | | application. See NOTE 3. | +----------------------------------+----------------------------------+ | > Spatial Validity Condition | Area where the DN performance | | | analytics applies. | +----------------------------------+----------------------------------+ | > Temporal Validity Condition | Validity period for the DN | | | performance analytics. | +----------------------------------+----------------------------------+ | NOTE 1: The item \"DNN\" and | | | \"S-NSSAI\" shall not be | | | included if the consumer NF is | | | an untrusted AF. | | | | | | NOTE 2: The item \"Serving | | | anchor UPF\" shall not be | | | included if the consumer is an | | | AF. | | | | | | NOTE 3: Analytics subset that | | | can be used in \"list of | | | analytics subsets that are | | | requested\", \"Preferred level | | | of accuracy per analytics | | | subset\" and \"Reporting | | | Thresholds\". | | +----------------------------------+----------------------------------+
The NWDAF UE communication analytics can produce statistics of e.g. the
traffic volume used by a UE. The UE communication analytics service can be
used by an AF to request performance monitoring information for specific
applications for a single UE or a group of UEs. The UE communication
statistics is described in clause 6.7.3 of TS 23.288 [8] and contains the
information shown in Table 6.22.2-2.
Table 6.22.2-2 UE Communication Statistics
+----------------------------------+----------------------------------+ | Information | Description | +----------------------------------+----------------------------------+ | UE group ID or UE ID | Identifies a UE or a group of | | | UEs, e.g. internal group ID | | | defined in TS 23.501 [2] | | | clause 5.9.7 or SUPI (see NOTE). | +----------------------------------+----------------------------------+ | UE communications (1..max) | List of communication time | | (NOTE 1) | slots. | +----------------------------------+----------------------------------+ | > Periodic communication | Identifies whether the UE | | indicator (NOTE 1) | communicates periodically or | | | not. | +----------------------------------+----------------------------------+ | > Periodic time (NOTE 1) | Interval Time of periodic | | | communication (average and | | | variance) if periodic. | | | | | | Example: every hour | +----------------------------------+----------------------------------+ | > Start time (NOTE 1) | Start time observed (average and | | | variance) | +----------------------------------+----------------------------------+ | > Duration (NOTE 1) | Duration of communication | | | (average and variance). | +----------------------------------+----------------------------------+ | > Traffic characterization | S-NSSAI, DNN, ports, other | | | useful information. | +----------------------------------+----------------------------------+ | > Traffic volume (NOTE 1) | Volume UL/DL (average and | | | variance). | +----------------------------------+----------------------------------+ | > Ratio | Percentage of UEs in the group | | | (in the case of a UE group). | +----------------------------------+----------------------------------+ | Applications (0..max) (NOTE 1) | List of application in use. | +----------------------------------+----------------------------------+ | > Application Id | Identification of the | | | application. | +----------------------------------+----------------------------------+ | > Start time | Start time of the application. | +----------------------------------+----------------------------------+ | > Duration time | Duration interval time of the | | | application. | +----------------------------------+----------------------------------+ | > Occurrence ratio | Proportion for the application | | | used by the UE during requested | | | period. | +----------------------------------+----------------------------------+ | > Spatial validity | Area where the service behaviour | | | applies. If Area of Interest | | | information was provided in the | | | request or subscription, spatial | | | validity may be a subset of the | | | requested Area of Interest. | +----------------------------------+----------------------------------+ | N4 Session ID (1..max) (NOTE 1) | Identification of N4 Session. | +----------------------------------+----------------------------------+ | > Inactivity detection time | Value of session inactivity | | | timer (average and variance). | +----------------------------------+----------------------------------+ | NOTE 1: Analytics subset that | | | can be used in \"list of | | | analytics subsets that are | | | requested\" and \"Preferred | | | level of accuracy per analytics | | | subset\". | | +----------------------------------+----------------------------------+
As sepcified in TS 23.288 [8], the above analytcs outputs can be requested and
provided for a single UE, a group of UEs or any UE and contains per-
application information. The UE Communication Statistics includes information
about the UE(s), such as UE ID or Group ID, as well as about the applications
used by the UE. The DN service performance statistics includes application
related information such as statics related to application sever addresses.
Editor\'s note: How to support monitoring of PER, GFBR, PDB per connection
using DN service performance statistics and UE Communication Statistics is
FFS.
The KI#3 mentions also Communication service availability and Communication
service reliability as examples of monitored information. 5GC already allows
monitoring of information related to availability of a UE or a PDU Session via
existing NEF monitoring API, e.g. Loss of connectivity, UE reachability,
communication failure, PDU Session Status.
Editor\'s note: Monitoring of communication service availability and
communication service reliability is FFS.
### 6.22.3 Procedures
#### 6.22.3.1 Traffic Characteristics provisioning and Performance
Characteristics Monitoring for TSC and non-TSC scenarios
The provisioning of traffic characteristics per application for a group of UEs
is based on the existing NEF Service specific parameter provisioning procedure
in TS 23.502 [3], clause 4.15.6.7, but enhanced to allow the AF to provide the
traffic characteristics parameters described in clause 6.22.2.1.
It can be noted that this solution is based on the same services and procedure
as the support for QoS for a group of users in Solution#9, thus in practice it
is a common solution for KI#1 and KI#3.
Figure 6.22.3.1-1: Procedure for provisioning of traffic characteristics and
performance monitoring
0\. A PDU Session is established.
Based on local configuration associated with the DNN/S-NSSAI, the PCF
determines if the PDU Session is related to TSC services. In this case the PCF
invokes Npcf_PolicyAuthorization_Notify service operation to the TSCTSF
discovered and selected as described in clause 6.3.24 of TS 23.501 [2]. The
Npcf_PolicyAuthorization_Notify service operation includes the SUPI, the UE
address of the PDU Session and DNN/S-NSSAI. In non-TSC cases, the PCF
subscribes to notifications for Application Data from UDR.
1\. The AF decides to provide traffic characteristics for a group of UEs
identified by an External Group ID. The AF invokes the Nnef_AFSessionWithQoS
service to provide the QoS for the group and the related DNN/S-NSSAI. The
following parameters can be provided by the AF per traffic flow: GBR, MBR and
validity time.
2\. If the traffic characteristics is provided in relation to a DNN/S-NSSAI,
the NEF checks with UDM that the members of the group are subscribed already
to that DNN/S-NSSAI, as described in clause 4.15.6.10, steps 2-4 of TS 23.502
[3]. If UDM authorization is successful, the UDM provides the mapping of the
External Group ID to Internal Group ID in its response to the NEF.
The NEF determines whether to invoke the TSCTSF or not, as described in step 3
in clause 4.15.6.6 of TS 23.502 [3]. If the NEF determines to invoke TSCTSF,
steps 3-7 are executed and steps 8-10 are skipped. Otherwise steps 8-10 are
executed and steps 3-7 are skipped. The procedure then continues in step 11.
3\. The NEF forwards Group ID, QoS parameters, QoS references and Requested
Alternative QoS Parameter Set(s) in the Ntsctsf_QoSandTSCAssistance_Create
request message to the TSCTSF.
4\. The TSCTSF determines the individual group members using Nudm Group
Identifier translation service. The TSCTSF also determines which of these
group members have active PDU Sessions matching the DNN/S-NSSAI and determines
the relevant UE IP address.
5\. For each PDU Session, the TSCTSF invokes Npcf_PolicyAuthorization service.
6\. The TSCTSF replies to the NEF
7\. For each PDU Session, the TSCTSF sends a
Npcf_PolicyAuthorization_Subscribe message to the PCF to subscribe to
notifications of Resource allocation status and may subscribe to other events
described in clause 6.1.3.18 of TS 23.503 [4].
8\. The NEF invokes the Nudr_DM Create/Update/Remove to store the information
related to the Internal Group ID in UDR.
9\. The UDR notifies the PCFs that have subscribed with the traffic
characteristics for a group.
10\. The PCF identifies the active PDU Sessions associated with the data
received from UDR.
11\. The NEF replies to the AF.
12\. The PCF maps the traffic characteristics to parameters that are
applicable in 5GC, as described in clause 6.22.2.1. The PCF may take a policy
decision and may provide updated PCC rules towards SMF. This may trigger a PDU
Session Modification procedure.
13\. When the event condition is met, e.g. that the establishment of the
transmission resources corresponding to the QoS update succeeded or failed,
the relevant notification messages are sent as described in steps 7-8 in
clause 4.15.6.6 of TS 23.502 [3].
#### 6.22.3.2 Performance Characteristics Monitoring using NWDAF
The procedure for an AF to fetch analytics from NWDAF via NEF is shown below
(copied from clause 6.1.1.2 of TS 23.288 [8]).
The procedures specific for DN service performance analytics and UE
communication analytics are described in clause 6.14.4 and 6.7.3.4 of TS
23.288 [8], respectively.
Figure 6.22.3.2-2: Procedure for retrieving analytics via NEF, as copied from
clause 6.1.1.2 of TS 23.288 [8]
### 6.22.4 Impacts on existing entities and interfaces
**NEF:** Support Nnef_AFsessionWithQoS API with External Group Id as target
instead of UE address. Addition of validity condition to the AFsessionWithQoS
request. The rest of the parameters are re-used.
Editor\'s note: It can be determined during normative phase whether a new NEF
service should be defined to handle Groups of UEs instead of enhancing AF
session with QoS service (currently UE address is mandatory in the AF session
with QoS service).
**RAN:** No impacts
**SMF:** No impacts
For non-TSC cases:
\- UDR: Be able to store additional parameters provided by NEF.
\- PCF: Retrieve QoS information from UDR and take into account in policy
decisions. Support validity conditions related to the QoS information.
For TSC cases:
\- TSCTSF: Receive Ntsctsf request with Group ID from NEF and map it to
individual PDU Sessions.
\- PCF: Notify TSCTSF when new PDU Sessions are established.
# 7 Overall Evaluation
## 7.1 Key Issue #1: Enhance group attribute management
There are two aspects for study in key issue #1: **service area or QoS that is
applicable to each UE within the group. There are 7 solutions (** sol#1,
sol#8, sol#9, sol#10, sol#12, sol #13 and sol#18**) for service area
applicable to each UE within the group, there are 3 solutions (** sol#8, sol#9
and sol#21**) for QoS applicable to each UE within the group.**
The evaluation of key issue #1 separates into two aspects and uses the
principles as below table:
Table 7.1-1: Evaluation of KI#1 related principles
+-------------+-------------+-------------+-----------+-------------+ | Objectives | Principles | Impacts | Pros/Cons | Solution | +=============+=============+=============+===========+=============+ | P | Enhance the | NEF, UDM, | Pros: | sol#1, | | rovisioning | parameter | UDR | | sol#8, | | of the | p | | Cons: | sol#10, | | service | rovisioning | | | sol#12, | | area for a | service | | | sol #13, | | group | used for 5G | | | sol#18 | | | VN group | | | | | | management | | | | | | to support | | | | | | p | | | | | | rovisioning | | | | | | of service | | | | | | area for a | | | | | | group. | | | | | | | | | | | | Service | | | | | | area for a | | | | | | group can | | | | | | be stored | | | | | | as part of | | | | | | the group | | | | | | s | | | | | | ubscription | | | | | | data or | | | | | | each group | | | | | | member\'s | | | | | | AM | | | | | | s | | | | | | ubscription | | | | | | data. | | | | +-------------+-------------+-------------+-----------+-------------+ | | Enhance the | NEF, UDM, | Pros: | sol#9 | | | parameter | UDR | | | | | p | | Cons: | | | | rovisioning | | | | | | service | | | | | | used for | | | | | | p | | | | | | rovisioning | | | | | | of UE | | | | | | related | | | | | | information | | | | | | to support | | | | | | p | | | | | | rovisioning | | | | | | of service | | | | | | area for a | | | | | | group. | | | | | | | | | | | | Service | | | | | | area for a | | | | | | group can | | | | | | be stored | | | | | | as part of | | | | | | shared data | | | | | | related to | | | | | | the group | | | | | | or each | | | | | | group | | | | | | member\'s | | | | | | AM | | | | | | s | | | | | | ubscription | | | | | | data. | | | | +-------------+-------------+-------------+-----------+-------------+ | Enforcement | AMF obtains | AMF, UDM | Pros: | sol#1, | | of the | service | | | sol#8, | | service | area for a | | Cons: | sol#9, | | area for a | group from | | | sol#10 | | group | UDM/UDR. | | | | | | | | | | | | Apply LADN | | | | | | mechanism | | | | | | with | | | | | | service | | | | | | area for a | | | | | | group. | | | | +-------------+-------------+-------------+-----------+-------------+ | | SMF obtains | SMF, UDM | Pros: | sol#12, | | | service | | | sol#18 | | | area for a | | Cons: | | | | group from | | | | | | UDM/UDR, | | | | | | SMF obtains | | | | | | UE location | | | | | | or UE | | | | | | presence in | | | | | | service | | | | | | area of the | | | | | | group and | | | | | | determines | | | | | | how to | | | | | | handle | | | | | | UE\'s PDU | | | | | | Session. | | | | +-------------+-------------+-------------+-----------+-------------+ | P | Enhance the | NEF, UDM, | Pros: | sol#8 | | rovisioning | parameter | UDR | | | | of the QoS | p | | Cons: | | | for a group | rovisioning | | | | | | service | | | | | | used for 5G | | | | | | VN group | | | | | | management | | | | | | to support | | | | | | p | | | | | | rovisioning | | | | | | of QoS for | | | | | | a group. | | | | | | | | | | | | QoS for a | | | | | | group can | | | | | | be stored | | | | | | as part of | | | | | | the group | | | | | | s | | | | | | ubscription | | | | | | data. | | | | +-------------+-------------+-------------+-----------+-------------+ | | Enhance the | NEF, UDR | Pros: | sol#9 | | | general | | | | | | Parameter | | Cons: | | | | P | | | | | | rovisioning | | | | | | service to | | | | | | support | | | | | | p | | | | | | rovisioning | | | | | | of QoS for | | | | | | a group. | | | | | | | | | | | | QoS for a | | | | | | group can | | | | | | be stored | | | | | | at UDR as | | | | | | part of | | | | | | shared data | | | | | | related to | | | | | | the group | | | | | | or each | | | | | | group | | | | | | member\'s | | | | | | SM | | | | | | s | | | | | | ubscription | | | | | | data. | | | | +-------------+-------------+-------------+-----------+-------------+ | | The 5G VN | NEF, UDM, | Pros: | sol#21 | | | group data | UDR | | | | | is extended | | Cons: | | | | to include | | | | | | Group-MBR. | | | | | | Group-MBR | | | | | | limits the | | | | | | total bit | | | | | | rate that | | | | | | can be | | | | | | expected to | | | | | | be provided | | | | | | across all | | | | | | sessions of | | | | | | a 5G VN | | | | | | group. | | | | +-------------+-------------+-------------+-----------+-------------+ | Enforcement | The PCF can | PCF. | Pros: | sol#8 | | of the QoS | obtain the | | | | | for a group | QoS | | Cons: | | | | information | | | | | | as part of | | | | | | the group | | | | | | s | | | | | | ubscription | | | | | | data from | | | | | | UDR and | | | | | | apply it | | | | | | when making | | | | | | policy | | | | | | decisions. | | | | +-------------+-------------+-------------+-----------+-------------+ | | The SMF can | SMF/PCF. | Pros: | sol#9 | | | obtain the | | | | | | QoS | | Cons: | | | | information | | | | | | from UDM as | | | | | | per | | | | | | existing | | | | | | spec | | | | | | ifications. | | | | | | SMF | | | | | | provides it | | | | | | to PCF as | | | | | | per | | | | | | existing | | | | | | spec | | | | | | ifications, | | | | | | allowing | | | | | | PCF to | | | | | | apply it | | | | | | when making | | | | | | policy | | | | | | decisions. | | | | +-------------+-------------+-------------+-----------+-------------+ | | GSMF can | SMF, GSMF, | Pros: | sol#21 | | | obtain | PCF | | | | | Group-MBR | | Cons: | | | | from UDM. | | | | | | GSMF | | | | | | updates and | | | | | | stores the | | | | | | sum of the | | | | | | S | | | | | | ession-AMBR | | | | | | and MFBR | | | | | | for GBR QoS | | | | | | Flows of | | | | | | all PDU | | | | | | Sessions in | | | | | | the VN | | | | | | Group. PCF | | | | | | can query | | | | | | GSMF to | | | | | | retrieve | | | | | | the group | | | | | | information | | | | | | and make | | | | | | co | | | | | | rresponding | | | | | | decisions. | | | | +-------------+-------------+-------------+-----------+-------------+
**Provisioning of QoS and service area:**
As described in the table above, there are two basic approaches proposed for
how to provision service area and QoS:
1\. Extend 5GVN API to include service area and QoS (Sol#1, 8).
2\. Extend the general Parameter Provisioning API to include service area and
QoS information (Sol#9).
Either Alternative 1 or 2 can support provisioning of QoS and service area for
a group, since Rel-16 stage 2 specifications use the general parameter
provisioning service to support management of 5G VN group, but Rel-16 stage 3
specifies the separate PP service API for management 5G VN group. So SA2 can
simply conclude that the parameter provisioning service can be used to support
provisioning of QoS and service area for a group (including 5G VN group or
non-5GVN group), then it is up to stage 3 to decide whether to enhance 5G VN
API to support management of different types of group or use separate PP
service API or reformulate the 5G VN API in Rel-16 for a unified PP service
API for any type of group management in Rel-18.
Provisioning of QoS:
\- Alternative 1 enhances 5GVN Parameter Provisioning with QoS information.
The QoS information will be stored as 5GVN group data in UDR and be provided
to PCF. This alternative is thus overlapping with solutions for KI#3 where API
solutions for providing QoS for a group of UEs to the PCF are also discussed.
\- Alternative 2 enhances the general Parameter Provisioning with QoS
information. This information will be stored in UDM/UDR as subscribed
(default) QoS and provided to SMF. This solution thus complements the
solutions discussed as part of KI#3.
**Enforcement of service area:**
There are three basic solutions proposed for enforcement of service area:
a. Re-use LADN. Limited to one LADN area per DNN, independent of S-NSSAI
(Sol#9).
b. Extend LADN to support a LADN area per DNN/S-NSSAI combination (Sol#1, 8).
c. Introduce a SMF-based enforcement of Service Area (Sol#12, 18).
Alt-a reuses the existing mechanism, there is no standard impact. The cons is
the LADN is per DNN. It limit the deployment of this feature.
Alt b is more flexible than Alt a but can possibly be considered as minor
enhancements when re-using existing service area enforcement mechanisms. Alt b
also has UE impacts. Alt a has no impact to the UE and can thus work with
legacy UEs. It may be possible to support both a Alt a and b to have improved
flexibility as well as support legacy UEs in case the UE indicates its support
LADN area per DNN/S-NSSAI combination.
Alt-c also reuses the existing mechanism, while it can work on per DNN+S-NSSAI
service area restriction. The cons is that the UE is not aware of the Service
Area. The UE behaviour is unclear when it is outside the Service Area. One
potential way is the AF provides the service area to UE in the application
level which is out of 3GPP scope.
**Enforcement of QoS:**
No changes to the 5G QoS model are proposed.
## 7.2 Key Issue #2: Enhance group status event reporting
There are 3 **solutions (** sol#11, sol#14, sol#15**) addressing key issue
#2,** the evaluation of key issue #2 uses the principles as below table:
Table 7.2-1: Evaluation of KI#2 related principles
+--------------+--------------+-----------+-----------+--------------+ | Objectives | Principles | Impacts | Pros/Cons | Solution | +==============+==============+===========+===========+==============+ | Subscription | New Event ID | NEF | Pros: | sol#11 | | information | for event | | | | | for the | exposure | | Cons: | | | group event | service | | | | | | between NEF | | | | | | and AF | | | | +--------------+--------------+-----------+-----------+--------------+ | \"newly | AF | AF | Pros: | sol#14, | | registered | subscribes | | | sol#15 | | or | to group | | Cons: | | | (de | event | | | | | )-registered | \"newly | | | | | group | registered | | | | | member\" | or | | | | | | (de | | | | | | )-registered | | | | | | group | | | | | | member\" by | | | | | | using a | | | | | | series of | | | | | | existing | | | | | | monitoring | | | | | | events via | | | | | | event | | | | | | exposure | | | | | | service | | | | +--------------+--------------+-----------+-----------+--------------+ | | Parameter | NEF, UDM | Pros: | sol#15 | | | provisioning | | | | | | service is | | Cons: | | | | enhanced to | | | | | | include | | | | | | Notification | | | | | | Target | | | | | | Address to | | | | | | allow AF | | | | | | subscribe to | | | | | | changes for | | | | | | the 5G VN | | | | | | group | | | | | | membership | | | | +--------------+--------------+-----------+-----------+--------------+ | Trigger to | Reuse the | None | Pros: | sol#11, | | detect such | triggers for | | | sol14, | | \"newly | each | | Cons: | sol#15 | | registered | existing | | | | | or | monitoring | | | | | | event. | | | | +--------------+--------------+-----------+-----------+--------------+ | (de | Changes on | UDM, NEF | Pros: | sol#15 | | )-registered | the members | | | | | group | of the | | Cons: | | | member\" | group, i.e. | | | | | event | when a new | | | | | | member is | | | | | | added or old | | | | | | member is | | | | | | removed | | | | +--------------+--------------+-----------+-----------+--------------+ | Information | Comprise | AF or NEF | Pros: | Sol#11, | | within the | reporting | | | Sol14, | | event | information | | Cons: | Sol#15 | | reporting to | for a set of | | | | | reflect the | monitoring | | | | | changes of | events e.g. | | | | | group status | Registration | | | | | | state, UE | | | | | | R | | | | | | eachability, | | | | | | PDU Session | | | | | | status, UE | | | | | | Presence in | | | | | | the Area Of | | | | | | Interest, | | | | | | Number of | | | | | | UEs in an | | | | | | area, group | | | | | | members | | | | | | changes etc. | | | | +--------------+--------------+-----------+-----------+--------------+
## 7.3 Key Issue #3: NEF exposure framework for provisioning of traffic
characteristics and monitoring of performance characteristics
There are two **solutions (** sol#2, sol#22**) addressing key issue #3:**
\- Sol#2 proposes to enhance NEF service (either a new NEF service or existing
NEF service) to support provisioning of traffic characteristics (Transfer
interval, Data volume per cycle time, Average and peak data rates, Silence
time interval, PDU Session Type) and monitoring of performance characteristics
(End-to-end latency, Service bit rate, Packet error rate, communication
service availability, communication service reliability).
\- It supports either AF or TSCTSF for mapping from some traffic
characteristics/performance characteristics to existing QoS parameters in
order to use existing QoS and policy framework.
\- It supports enhancing QoS Notification Control for a specific performance
characteristics. This has impacts on RAN, SMF, PCF.
\- It supports AF or TSCTSF to manage the temporal invalidity condition
(start-time, end-time) to satisfy the silence time interval.
\- It supports PDU Session Type change for the PDU Session by using PDU
Session Release COMMAND indicating that re-establishment of the PDU Session is
required and URSP rule for the requested PDU Session Type setting with higher
precedence value than the URSP rules for other PDU Session Type(s) of the 5G
VN group (AF can manipulate the order of the requested PDU Session Type in 5G
VN group data via
Nnef_ParameterProvision_Create/Nnef_ParameterProvision_Update to influence the
setting with precedence value at PCF when generating URSP rules).
\- Moreover it supports either AF to handle request for UE-to-UE traffic.
\- NWDAF is enhanced to support monitoring of communication service
availability, communication service reliability using data collected from 5GC,
.e.g. delay performance monitoring data, start and end time of a QoS failure.
\- Sol#22 proposes to enhance NEF service to support provisioning of traffic
characteristics (GBR, MBR and validity time) for a group of UEs. Both TSC and
non-TSC cases are supported. PCF will receive the traffic characteristics for
making policy decision. Existing QoS monitoring and QoS Parameter Notification
control are re-used to support performance monitoring. And it proposes to re-
use NEF analytics exposure service for monitoring of performance
characteristics.
Sol#22 does not address the provisioning for UE-UE traffic while sol#2
proposes that UE-UE traffic is handled by the AF. Sol#22allows the use of
NWDAF analytics to provide performance statistics to the AF, however the NWDAF
analytics cannot support per connection PER/GBR/PDB monitoring. Sol#22
supports per connection monitoring of end-to-end latency, service bit rate and
packet error rate based on AQP in existing specifications and avoids RAN
impacts. This requires the AF to set proper combination of AQPs to derive the
actual unfilled target performance, this is not a general tool since AQP is
designed to allow RAN to provide alternative satisfied combination of PER, GBR
and PER. Sol#22 proposes that communication service availability,
communication service reliability may be handled via O&M performance counters
and SLA agreements, as defined by SA5. Provisioning of PDU Session type is
only addressed by sol#2.
## 7.4 Key Issue #4: Multiple SMFs for VN group communication
The following solutions are proposed for KI#4: Sol#3, 4, 5, 16, 19, 20\. They
could be grouped in 3 families:
1\. Family 1: Solutions introducing a new NF/interface/functionality (e.g.,
GSMF in Sol#5, similar for Sol#4, 19, 20) acting as the controller/common
anchor/sync of a 5G VN group spanning over a large area, which implies that UE
group members are accessing the 5G VN group via different SMFs (sets) serving
different service areas. The new NF/interface/functionality coordinates all
SMFs (sets) of the 5G VN group.
2\. Family 2: Solution #3 which leverages and extends the already defined
\"deployment topologies with specific SMF service areas\" (ETSUN) architecture
for supporting a 5G VN group spanning over a large area, where UE group
members are accessing the 5G VN group via different locations. A common anchor
SMF (set) serves the whole 5G VN group controlling I-SMFs (sets) in remote
service areas out of the reach of the anchor SMF (set).
3\. Family 3: Solution #16 based on N6 connectivity (\"Native N6\" or \"N6
Overlay\" as described in Sol#16) for transport of traffic between UEs,
members of the 5G VN group served by different SMFs (sets) due to the fact
that the 5G VN group spans over a large area.
Based on the KI#4 objectives the evaluation of the various solutions is
described in the following table:
Table 7.4-1
KI#4 Objective Family 1 Family 2 Family 3
* * *
Reliability of the 5G VN group communication Supported with the help of the
set functionality at all levels (e.g., SMF sets, GSMF set, etc.) Supported
with the help of the set functionality at all levels (A-SMF set, I-SMFs
(sets)) Supported with the help of the set functionality 5G VN group members
access the group at different locations Supported via the same or different
SMFs (sets) Supported via the same A-SMF (set) and potentially different
I-SMFs (sets) Supported via the same or different SMFs (sets) Rel. 16
compatibility Supported via proper network configuration Supported via proper
network configuration Supported via proper network configuration How to manage
session management when multiple SMFs are involved all belonging to the same
SMF set which is able to cover the whole service area of the 5G VN group
Existing specifications potentially with some NOTEs cover this case as the
SMFs of a set can communicate with each other / share information. Reliability
of the 5G VN group communication is also covered via the set reliability  
How to manage UE communications when they are served by different UPFs, all
controlled by the same SMF set which is able to cover the whole service area
of the 5G VN group Existing specifications potentially with some NOTEs cover
this case as the SMFs of a set can communicate with each other / share
information. Reliability of the 5G VN group communication is also covered via
the set reliability  
How to manage UE communications when there is no single SMF set covering the
whole service area of the 5G VN group There is a common per 5G VN group
(DNN/SNSSAI) GSMF or inter-SMF communication There is a common per 5G VN group
(DNN/SNSSAI) A-SMF set controlling multiple I-SMFs (sets) Controlling is
achieved via the user plane
In deployments where a single SMF set covers the whole service area of the 5G
VN group existing specifications with potentially some notes fulfil the KI#4
requirements.
Extending to deployments where there is no single SMF set able to cover the 5G
VN group service area:
Table 7.4-2
+----------------+----------------+----------------+----------------+ | | Family 1 | Family 2 | Family 3 | +================+================+================+================+ | Session | There is a | There is a | Controlling is | | management | common per 5G | common per 5G | achieved via | | | VN group | VN group | the user plane | | | (DNN/SNSSAI) | (DNN/SNSSAI) | | | | GSMF set or | A-SMF set | | | | inter-SMF | controlling | | | | (set) | multiple | | | | communication | I-SMFs (sets) | | +----------------+----------------+----------------+----------------+ | Multi-vendor | Yes: Different | Yes: Different | Yes: Different | | support | SMF sets might | I-SMF sets | SMF sets might | | | be deployed by | might be | be deployed by | | | multiple | deployed by | multiple | | | vendors. | multiple | vendors. | | | | vendors. | | | | The GSMF set | | | | | is deployed by | The A-SMF set | | | | a single | is deployed by | | | | vendor | a single | | | | | vendor | | +----------------+----------------+----------------+----------------+ | Interfacing | Multiple | Single | Multiple | | with the | interfaces per | interface from | interfaces per | | policy and | SMF set | the A-SMF set | SMF set | | charging | | | | | framework | | | | +----------------+----------------+----------------+----------------+ | New | Yes | No | No | | NF/interface | | | | | introduction | | | | +----------------+----------------+----------------+----------------+ | Dependency on | No | Yes, ETSUN is | No | | other legacy | | assumed but in | | | functionality | | deployments | | | | | where there is | | | | | no single SMF | | | | | set able to | | | | | cover the 5G | | | | | VN group | | | | | service area, | | | | | ETSUN might be | | | | | deployed | | | | | anyway or | | | | | needed for | | | | | other use | | | | | cases, too | | +----------------+----------------+----------------+----------------+
## 7.5 Key Issue #5: Allowing UE to simultaneously send data to different
groups with different QoS policy
There are 3 **solutions (** sol#6, sol#7, sol#17**) addressing key issue #5,**
the evaluation of key issue #5 uses the principles as below table:
Table 7.5-1: Evaluation of KI#5 related principles
+-------------+-------------+-------------+-----------+-------------+ | Objectives | Principles | Impacts | Pros/Cons | Solution | +=============+=============+=============+===========+=============+ | Group | UE/ | None | Pros: | sol#6, | | co | application | | | sol#17 | | mmunication | is capable | | Cons: | | | allowing UE | to | | | | | to | replicate | | | | | sim | multiple | | | | | ultaneously | copies of | | | | | send data | the data. | | | | | to | | | | | | different | UE sends | | | | | groups | each copy | | | | | | to | | | | | | different | | | | | | destination | | | | | | addresses | | | | | | co | | | | | | rresponding | | | | | | to | | | | | | different | | | | | | groups. | | | | +-------------+-------------+-------------+-----------+-------------+ | | UE/ | UE, AMF, | Pros: | sol#7 | | | application | SMF, UPF | | | | | is not | | Cons: | | | | capable to | | | | | | replicate | | | | | | multiple | | | | | | copies of | | | | | | the data. | | | | | | | | | | | | UE needs to | | | | | | send one | | | | | | copy to | | | | | | UPF, and | | | | | | then UPF is | | | | | | responsible | | | | | | for data | | | | | | duplication | | | | | | and further | | | | | | d | | | | | | istribution | | | | | | to | | | | | | different | | | | | | groups. | | | | +-------------+-------------+-------------+-----------+-------------+ | Data sent | Associate | 5GC: obtain | Pros: | sol#6, | | to | different | different | | sol#17 | | different | groups to | QoS policy | Cons: | | | groups has | the same | for | | | | a different | DNN and | different | | | | QoS policy | S-NSSAI | groups and | | | | | used for | set | | | | | PDU | different | | | | | Session. | QoS Flows | | | | | | in the | | | | | UE uses | co | | | | | different | rresponding | | | | | QoS Flows | PDU Session | | | | | of single | using such | | | | | PDU Session | different | | | | | to transfer | QoS policy. | | | | | the data | | | | | | copy sent | | | | | | to | | | | | | different | | | | | | group. | | | | | | | | | | | | Different | | | | | | QoS policy | | | | | | for | | | | | | different | | | | | | groups is | | | | | | achieved | | | | | | using | | | | | | different | | | | | | QoS Flows | | | | | | in a single | | | | | | PDU | | | | | | Session. | | | | +-------------+-------------+-------------+-----------+-------------+ | | Associate | 5GC: obtain | Pros: | sol#6 | | | different | different | | | | | groups to | QoS policy | Cons: | | | | the | for | | | | | different | different | | | | | DNN and | groups and | | | | | S-NSSAI | set the QoS | | | | | used for | Flow in | | | | | PDU | each | | | | | Session. | group\'s | | | | | | co | | | | | UE uses | rresponding | | | | | different | PDU | | | | | PDU | Sessions | | | | | Sessions to | using the | | | | | transfer | co | | | | | the data | rresponding | | | | | copy sent | QoS policy. | | | | | to | | | | | | different | | | | | | group. | | | | | | | | | | | | Different | | | | | | QoS policy | | | | | | for | | | | | | different | | | | | | groups is | | | | | | achieved | | | | | | using | | | | | | different | | | | | | PDU | | | | | | Sessions. | | | | +-------------+-------------+-------------+-----------+-------------+ | | Associate | UE, AMF, | Pros: | sol#7 | | | different | SMF, UPF. | | | | | groups to | | Cons: | | | | the | | | | | | different | | | | | | DNN and | | | | | | S-NSSAI | | | | | | used for | | | | | | PDU | | | | | | Session. | | | | | | | | | | | | UE uses one | | | | | | single PDU | | | | | | Session | | | | | | with | | | | | | multiple | | | | | | DN | | | | | | Ns/S-NSSAIs | | | | | | or a | | | | | | predefined | | | | | | DNN/S-NSSAI | | | | | | to transfer | | | | | | the data | | | | | | copy sent | | | | | | to | | | | | | different | | | | | | group: UE | | | | | | sends one | | | | | | UL copy on | | | | | | the QoS | | | | | | flow with | | | | | | most strict | | | | | | QoS, and | | | | | | UPF is | | | | | | responsible | | | | | | for packet | | | | | | duplication | | | | | | and further | | | | | | d | | | | | | istribution | | | | | | to | | | | | | different | | | | | | groups. | | | | +-------------+-------------+-------------+-----------+-------------+
Since sol#6 and sol#17 both assume that the data sent to different groups
corresponds to data with different destinations and the UE can determine how
to send the data toward a group, their principles or approaches are in line
and the scenarios are complementary. Hence, it is proposed to adopt sol#6 and
sol#17 when the application on the UE can replicate multiple copies of the
data.
Solution 7 relates to a rare case: UE/application is not capable to replicate
multiple copies of a packet but requires usage of multiple groups.
This solution 7 assumes the UE sends to 5GC only one copy of the traffic to be
sent, and then UPF(s) in the 5GC are responsible for data duplication and
further distribution to different groups each with a different QoS.
This nevertheless induce extensive and complex system impacts.
Quoting the solution:
_\"UE1, which belongs to Group1 and Group2, sends PDU Session Request with
Group1 and Group2 to the SMF. In this step, the AMF needs to select the SMF
based on the information including Group1 and Group2. UE should include
multiple DNNs/S-NSSAIs for a PDU Session\"._
This means that the solution 7 requires to be able to associate a PDU Session
with multiple groups and multiple DNNs / S-NSSAIs which breaks a fundamental
5GC rule that a PDU Session is associated with a single DNN and slice. This
would have significant impacts throughout all the 5GC: in AMF, SMF, PCF, UDM,
UDR, CHF.
# 8 Conclusions
## 8.1 Key Issue #1: Enhance group attribute management
The following principles are proposed for normative work:
\- The solution applies to groups created by an AF using the 5G VN API as well
as groups other than 5G VN groups configured by O&M.
\- For provisioning of service area applicable to each UE within the group and
DNN/S-NSSAI, the UDM/NEF parameter provisioning service is adopted as
baseline:
\- The service area is provisioned as subscription data for the group or as
individual subscription data.
\- For enforcement of service area applicable to each UE within the group:
\- LADN-based method: If the UE supports LADN per DNN and S-NSSAI, the AMF can
configure UE with the LADN Area. If the UE receives LADN area per DNN and
S-NSSAI, the UE behaves same as defined for LADN as defined in clause 5.6.5 of
TS 23.501 [2].The Service Area is determined by AMF based on AMF local
configured LADN service area (if any) and service area provisioned as part of
group subscription data for the DNN/S-NSSAI. AMF and SMF enforces the LADN
area as described in TS 23.501 [2].
NOTE: The above bullet assumes that the UE has the capability of supporting
Local Area Data Network as described in clause 5.6.5 of TS 23.501 [2].
\- For provisioning of default QoS applicable to each UE within the group and
DNN/S-NSSAI, the UDM/NEF parameter provisioning service is adopted as
baseline:
\- The default QoS is provisioned as subscription data for the group or as
individual subscription data.
\- For enforcement of default QoS applicable to each UE within the group:
\- The SMF can obtain such default QoS from UDM. The SMF sends it to PCF as
per existing specifications to consider it in policy decisions.
\- AF indicates to the 5GC if the group is associated with 5G VN Group
Communication as defined in clauses 5.29.3 and 5.29.4 of TS 23.501 [2].
\- Support of Group-MBR using Slice-MBR. Below method to enforce the Group-MBR
for a 5G VN group based on the realization of the Slice-MBR, as defined in
clause 6.1.4 of TS 23.503 [4].
\- PCF/UDR based method: The UDR maintains the Remaining Maximum Group Data
Rate per group identified by DNN and S-NSSAI, and the PCF interacts with the
UDR to deduct the value of the authorized Session-AMBR and the MBR of every
GBR SDF from the Remaining Maximum Group Data Rate per DNN and S-NSSAI for
every PDU Session of this group. When the remaining data rate for that group
is close to zero, the PCF may, based on operator policies, apply a policy
decision to strengthen the traffic restrictions for individual PDU Sessions or
PCC rules.
## 8.2 Key Issue #2: Enhance group status event reporting
The following principle is proposed for normative work:
\- This solution applies for 5G VN groups as well as other groups than 5GVN,
configured using O&M.
\- Information to reflect the changes of group status can comprise group
member list stored in UDM changes. This is reported by the 5GC via
notification mechanism.
\- The existing event notification (as described in Table 4.15.3.1-1 in TS
23.502 [3]) can be reused to collect the following events for a group of UEs
(identified by an External Group ID) e.g. UE Reachability, PDU Session status,
UE Presence in the Area Of Interest, Number of UEs in an area.
\- As already described in clause 5.2.6.2.2 of TS 23.502 [3], the AF may
provide a set of Event ID(s) in the Nnef_EventExposure_Subscribe request. No
related stage 2 impacts foreseen.
## 8.3 Key Issue #3: NEF exposure framework for provisioning of traffic
characteristics and monitoring of performance characteristics
The following principles are concluded for normative work:
\- Either a new **NEF service will be introduced or existing NEF service, e.g.
AF session with QoS service will be enhanced to** support provisioning of
traffic characteristics and monitoring of performance characteristics for a
group of UEs.
NOTE: Whether a new NEF service is to be defined or existing NEF service is
enhanced, and in that case which NEF service.
\- If TSCTSF is used, NEF provides the request for a group of UEs to the
TSCTSF and TSCTSF maps the request targeting a group to requests targeting
each group member\'s PDU Session, i.e. TSCTSF provides per-PDU-Session
requests to PCF(s). In case TSCTSF is not used, NEF stores the request in UDR
and PCF receives the information from UDR.
\- The AF provides 5G QoS parameters to NEF.
NOTE: Some of the traffic characteristics parameters from 5G-ACIA white paper
can be provided using 5GS QoS parameters, e.g.:
\- Transfer interval using Periodicity.
\- Data volume per cycle time using Maximum Burst Size.
\- Average/Service and peak data rates using Requested Guaranteed Bitrate and
Requested Maximum Bitrate.
\- Maximum end-to-end latency using Requested 5GS Delay.
\- The QoS and policy framework is re-used for parameter enforcement. The
existing QoS Parameter Notification Control and existing AQP can be used
formonitoring of specific performance characteristic. No RAN impacts are
foreseen.
\- The TSCTSF or PCF (in non-TSCTSF case) is responsible to manage the
temporal invalidity/validity condition (start-time, end-time).
\- PDU Session Release COMMAND for re-establishment of the PDU Session and
URSP rules for the highest priority PDU Session Type of a group are used to
change PDU Session Type of the PDU Session targeting the group for each group
member within the group.
\- The AF is responsible to handle request for UE-to-UE traffic e.g. initial
\"QoS division\" and updated \"QoS division\". (How the AF does this is not to
be standardized in SA2 specifications. (A NOTE may however be added to e.g. TS
23.501 [2] or TS 23.502 [3].)
\- To support KI#5, for provisioning of QoS applicable to UE's service flow
corresponding to multicast address within the group and DNN/S-NSSAI, the
solution defined above can be used.
## 8.4 Key Issue #4: Multiple SMFs for VN group communication
The following principles are concluded for normative work:
\- A 5G VN group may be served by a single SMF (set) or different SMF (set)s.
Set functionality is used to support SMF redundancy for reliability of the 5G
VN group communication:
\- The associations between one or more SMF Sets and the DNN, S-NSSAI of the
associated 5G VN group is registered and discovered in NRF per existing
mechanisms (SMF registers the DNN+S-NSSAI it supports).
\- The SMFs that registered to associate with the DNN, S-NSSAI of the
associated 5G VN group should be available in the service area of the 5G VN
group.
\- For UPFs served by a single SMF Set, N19-based forwarding, N6-based
forwarding and local switch as per Rel-17 can be used with the following
clarifications:
\- The SMF set or SMF instances in SMF set support functionality for 5G VN
group communications across SMFs. As an example, the SMF(s) can share
contextual information associated with the 5G VN group (DNN + S-NSSAI). The
contextual information may e.g. relate to the N19 configuration, to the list
of PDU Sessions established by 5G VN group members, etc.
\- No standard impacts are expected for this purpose except a NOTE such as:
NOTE 1: Implementation dependent mechanism can be used between SMF(s) that are
part of a SMF set to control the N19 configuration.
\- For UPFs controlled by different SMF Sets:
\- Among the UPFs controlled by one SMF (set), some or all UPF(s) support user
plane tunnels towards UPF(s) controlled by other SMF (set)s. These UPFs are
referred as \"border UPFs\" below, for ease of description in this clause. The
intent is however not to specify a new UPF role.
\- Static connectivity: To construct a virtual network between UPFs belonging
to different SMF (set)s, user plane tunnels are configured using OAM between
5G VN border UPFs via N19/N6. These inter-UPF user plane tunnels may be using
GTP-U or IETF VPN (e.g. GRE or MPLS, e.g. as defined in RFC 4364 for L3VPN).
How to implement the user plane tunnels configured between these UPFs is up to
network implementation and deployment, and it is not standardized by 3GPP SA2.
A NOTE below shows how static connectivity works.
NOTE 2: In the case of GTP-U and for a 5G VN group:
1) OAM ensures that F-TEIDs are reserved at each 5G VN border UPF for inter-5G
VN border UPF tunnels.
2) OAM configures each SMF(set) with the F-TEIDs of enabled links towards
other 5G VN border UPFs controlled by other SMF(set)s.
3) For a 5G VN using IP PDU Sessions, each SMF(set) may be configured with the
remote F-TEID used to reach a (set of) IP address range (e.g. IP address range
managed by another site). Then the SMF(set) can configure its UPF(s)
(including 5G VN border UPF(s)) accordingly.
4) For a 5G VN using Ethernet PDU Sessions, the UPFs apply source MAC address
learning on the N19 links. The UPFs may use technologies defined by other SDOs
such as IEEE to do this.
\- Care needs to be taken when configuring the N19 links and the user plane
forwarding to ensure loop free forwarding:
In the case of VPN: OAM provides the 5G VN border UPFs with the relevant
configuration needed to establish the VPN for either Ethernet or IP, i.e.
configuration of Provider Edge (PE) functionality. Traffic forwarding
decisions are made by 5G VN border based on the VPN technology (e.g. using BGP
for L3VPNs).
\- Dynamic control of the connectivity between UPFs controlled by different
SMF Sets will not be specified in Rel-18.
## 8.5 Key Issue #5: Allowing UE to simultaneously send data to different
groups with different QoS policy
In the case when Application is capable to replicate multiple copies of the
data, the following are ways forward:
\- If different groups (IP/Ethernet multicast groups) are associated to the
same DNN and S-NSSAI combination used for 5G VN group, then different QoS
Flows of single PDU Session may be used to transfer the data copy sent to
different groups
\- If different groups (IP/Ethernet multicast groups) are associated to the
different DNN and S-NSSAI combinations used for 5G VN group, then different
PDU Sessions are used to transfer the data copy sent to different groups
In the case when Application is not capable to replicate multiple copies of
the data, the following are ways forward.
\- UE establishes a PDU Session to a DNN/S-NSSAI, as per R17 specifications.
This can be a special DNN/S-NSSAI configured by the operator for e.g. an
electrical system.
\- Each group and group combination is associated with a separate multicast
address.
\- Application sends traffic to a multicast address depending on what group(s)
it wants to target. This allows an application to send a single packet
reaching multiple destinations and also multiple groups.
\- The network configures a QoS policy for each UE where a multicast address
is associated with a QoS level. The QoS level is set according to the QoS
requirements for the group(s) the multicast address represents. Corresponding
QoS Flow(s) is activated on each UE\'s PDU Session, as needed.
\- Application sends one UL copy.
NOTE 1: No normative changes will result from this conclusion.
NOTE 2: The outcome of KI#1, KI#2, KI#3 are assumed to apply also if a UE is a
member of multiple different groups.
#