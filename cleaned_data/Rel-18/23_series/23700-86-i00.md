# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document is to study 5GC architecture enhancements to enable
Ranging-based services and sidelink positioning for commercial, V2X and public
safety use cases in in-coverage, partial coverage, and out-of-coverage of 5G
network, which include:
\- Authorization and policy/parameter provisioning for a UE or a group of UEs;
\- Ranging device discovery and service operation procedures between two UEs,
between one UE and multiple UEs or via the assistance of another UE;
\- Ranging and sidelink positioning service exposure to a UE or an Application
Server who has requested the service.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 22.855: \"Study on Ranging-based Services\".
[3] 3GPP TS 23.287: \"Architecture enhancements for 5G System (5GS) to support
Vehicle-to-Everything (V2X) services\".
[4] 3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System
(5GS)\".
[5] 3GPP TS 22.261: \"Service requirements for next generation new services
and markets; Stage 1\".
[6] 3GPP TR 38.845: \"Study on scenarios and requirements of in-coverage,
partial coverage, and out-of-coverage NR positioning use cases\".
[7] 3GPP TS 22.186: \"Enhancement of 3GPP support for V2X scenarios\".
[8] 3GPP TS 38.300: \"NR; NR and NG-RAN Overall Description; Stage 2\".
[9] 3GPP TS 23.502: \"Procedures for the 5G System (5GS); Stage 2\".
[10] 3GPP TS 37.355: \"LTE Positioning Protocol (LPP)\".
[11] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS)\".
[12] 3GPP TS 23.222: \"Common API Framework for 3GPP Northbound APIs\".
[13] 3GPP TS 33.122: \"Security aspects of Common API Framework (CAPIF) for
3GPP northbound APIs\".
[14] 3GPP TS 23.501: \" System Architecture for the 5G System; Stage 2\".
[15] 3GPP TS 23.503: \"Policy and charging control framework for the 5G System
(5GS); Stage 2 \".
[16] 3GPP TS 38.305: \"NG Radio Access Network (NG-RAN); Stage 2 functional
specification of User Equipment (UE) positioning in NG-RAN\".
[17] 3GPP TS 24.587: \"Vehicle-to-Everything (V2X) services in 5G System
(5GS); Stage 3\".
[18] 3GPP TR 23.700‑33: \"Study on System enhancement for Proximity based
Services (ProSe) in the 5G System (5GS); Phase 2\".
[19] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall
description; Stage 2\".
[20] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC); Protocol
specification\".
[21] 3GPP TR 38.859: \"Study on Expanded and Improved NR Positioning\".
[22] 3GPP TS 23.303: \"Proximity-based services (ProSe); Stage 2\".
# 3 Definitions of terms and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
**Application Layer ID** : An identifier identifying a Ranging/SL Positioning-
enabled UE within the context of a specific application, is used by the SL
Positioning Client UE, the application of the Target UE/SL Reference UE or the
Application server to identify the target UE and the SL Reference UE in the
service request.
**Assistant UE:** A UE supporting Ranging/Sidelink Positioning between a SL
Reference UE and a Target UE over PC5, when the direct Ranging/Sidelink
positioning between the SL Reference UE and Target UE cannot be supported. The
measurement/result of Ranging/Sidelink Positioning between the Assistant UE
and the SL Reference UE and that between the Assistant UE and the Target UE
are determined and used to derive the Ranging/Sidelink Positioning result
between Target UE and SL Reference UE.
NOTE 1: Assistant UE is understood as \"Anchor UE\" in RAN WG1 TR 38.859 [21]
when it performs the AS layer operation.
**Located UE:** A SL Reference UE of which the location is known or is able to
be known using Uu based positioning. A Located UE can be used to determine the
location of a Target UE using Sidelink Positioning.
**Network-assisted Operation:** Operation of Ranging/Sidelink Positioning with
the involvement of 5GC NFs for the service request handling and result
calculation.
**Positioning:** A functionality, which detects a geographical location and
optionally, velocity (of e.g. a mobile terminal).
**Ranging:** Refers to the determination of the distance between two UEs or
more UEs and/or the direction of one UE (i.e. Target UE) from another UE (i.e.
Reference UE) via PC5 interface.
**Relative position:** An estimate of the UE position relative to other
network elements or relative to other UEs.
**SL Reference UE:** A UE, supporting positioning of target UE, e.g. by
transmitting and/or receiving reference signals for positioning, providing
positioning-related information, etc. using sidelink.
NOTE 2: SL Reference UE is understood as \"Anchor UE\" in RAN WG1 TR 38.859
[21].
NOTE 3: \"Reference UE\" mentioned in KIs and Solutions of this TR refers to
\"SL Reference UE\".
**Sidelink Positioning:** Positioning UE using PC5 to obtain absolute
position, relative position, or ranging information.
**SL Positioning Client UE:** A third-party UE, other than SL Reference UE and
Target UE, which initiates Ranging/Sidelink positioning service request on
behalf of the application residing on it.
NOTE 4: The SL Positioning Client UE does not have to support Ranging/Sidelink
positioning capability, but a communication between the SL Positioning Client
UE and SL Reference UE/Target UE has to be established, either via PC5 or via
5GC, for the transmission of the service request and the result.
**SL Positioning Server UE:** A UE offering method determination, assistant
data distribution and/or location calculation functionalities and/or location
calculation functionalities for Sidelink Positioning and Ranging based
service. It interacts with other UEs over PC5 as necessary in order to
determine Ranging/SL Position method, distribute assistant data and calculate
the location of the Target UE. Target UE or SL Reference UE can act as SL
Positioning Server UE if any of the functionalities is supported.
**Target UE:** A UE whose distance, direction and/or position is measured with
the support from one or multiple SL Reference UEs using Sidelink in the
Ranging based service and Sidelink positioning.
**UE-only Operation:** Operation of Ranging/Sidelink Positioning in which the
service request handling and result calculation are performed by UE.
NOTE 5: For UE-only Operation, the communication among UEs are over PC5.
Editor\'s note: Definition on the terminology of Ranging and Sidelink
positioning will be aligned with RAN WGs, and will be revisited when there\'s
any conclusion in RAN WGs.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
AS layer Access Stratum layer
LOS Line of Sight
ProSe Proximity based Services
SL Sidelink
V2X Vehicle-to-Everything
# 4 Architecture assumptions and requirements
## 4.1 Architecture assumptions
\- Ranging-based services and sidelink positioning consists of distance
measurement, direction measurement, or both. UE is allowed to request the
distance measurement only, direction measurement only, or both in the service.
\- Not all UEs are assumed to be Ranging/Sidelink positioning capable. It is
assumed that all Ranging/SL positioning capable UEs are ProSe or V2X capable.
\- For direct communication/discovery related aspects, architecture defined in
TS 23.287 [3] and TS 23.304 [4] is used as the basis, and the solutions
defined for V2X and ProSe will be reused as much as possible.
\- Licensed, unlicensed and ITS spectrum may be used for PC5. If licensed
spectrum is used, it shall be fully under operator control:
\- For commercial ranging based service, both licensed and unlicensed spectrum
can be used for PC5.
\- For V2X service, licensed, unlicensed and ITS spectrum can be used for PC5.
\- For Public safety service, licensed spectrum is used for PC5.
Editor\'s note: RAN has not concluded whether unlicensed spectrum can be
considered for R18. This architecture assumption will be revisited once it is
concluded in RAN.
\- Privacy protection and other security aspects will be tasked to SA3, and
the related impact to architecture enhancement will be based on SA3
conclusion.
## 4.2 Architecture requirements
The enhancement to 5GC architecture shall be able to support Ranging-based
services and sidelink positioning in in-coverage, partial coverage and out of
network coverage scenarios as defined in TS 22.261 [5] and TR 38.845 [6]:
\- When the UE operates a use case having the corresponding positioning
requirements, the requirements should be fulfilled when the UE is inside the
network coverage as well as when it is outside the network coverage.
The enhancement to 5GC architecture shall be able to support requirements
defined in TS 22.261 [5] to enable Ranging-based services and sidelink
positioning, specifically the following:
\- support energy efficient UE ranging operation.
NOTE 1: Solutions to support low power consumption UEs are developed in RAN
WGs, alignment for 5GC impact will be considered later.
\- support for a UE to discover other UEs supporting ranging.
\- provide mechanisms for a MNO, or authorized 3rd party, to provision and
manage ranging operation and configurations.
\- support mechanisms for a UE to assist another UE to perform ranging of a
third UE.
NOTE 2: It cannot be assumed that all ranging UEs support the same application
for exchange of information.
\- allow ranging service between 2 UEs triggered by and exposed to a SL
Positioning Client UE.
\- allow ranging service between 2 UEs triggered by and exposed to the
application server.
\- support one UE initiating ranging to the other UE.
\- support ranging between UEs belonging to different PLMNs.
\- allow roaming UEs to perform ranging.
The enhancement to 5GC architecture shall be able to support requirements
defined in TS 22.186 [7] to enable Ranging-based services and sidelink
positioning, specifically the following:
\- support relative position between UEs supporting V2X application.
Both Ranging-based services and sidelink positioning should be based on common
architecture.
## 4.3 General reference architecture
### 4.3.1 General
Figure 4.3.1-1 shows a reference architecture for Sidelink Positioning and
Ranging-based services for non-roaming operation. In this case, the UE A and
UE B that are involved in Sidelink Positioning and Ranging-based services have
subscription from the same PLMN. The reference architecture also supports the
case that UE-A or UE-B or both are not registered to the network or not in
coverage. UE C and UE D may be out of coverage, or with partial network
coverage. For simplicity, this figure only shows target UE and reference UE
(i.e. UE-A, UE-B, UE-C and UE-D), and there could also be Assistant UE,
Located UE and SL Positioning Server UE in the architecture as per the
solution.
NOTE 1: Other 5GC entities not marked with the SL positioning/Ranging label
may still need to be involved in SL positioning/Ranging.
Figure 4.3.1-1 Reference architecture for Sidelink Positioning and Ranging-
based services for non-roaming and same PLMN operation
Figure 4.3.1-2 shows a reference architecture for Sidelink Positioning and
Ranging-based services for Inter-PLMN non-roaming operation. In this case, the
UE A and UE B have subscriptions from different PLMNs, i.e. PLMN-A and PLMN-B
respectively. UE C and UE D may be out of coverage, or with partial network
coverage. For simplicity, this figure only shows target UE and reference UE
(i.e. UE-A, UE-B, UE-C and UE-D), and there could also be Assistant UE,
Located UE and SL Positioning Server UE in the architecture as per the
solution.
NOTE 2: Other 5GC entities not marked with the SL positioning/Ranging label
may still need to be involved in SL positioning/Ranging.
Figure 4.3.1-2 Reference architecture for Sidelink Positioning and Ranging-
based services for inter-PLMN operations
Figure 4.3.1-3 shows a reference architecture for Sidelink Positioning and
Ranging-based services for Inter-PLMN non-roaming operation. In this case, the
UE A and UE B have subscriptions from different PLMNs, i.e. PLMN-A and PLMN-B
respectively. In addition, UE A is roaming and registered to PLMN-C. UE C and
UE D may be out of coverage, or with partial network coverage. For simplicity,
this figure only shows target UE and reference UE (i.e. UE-A, UE-B, UE-C and
UE-D), and there could also be Assistant UE, Located UE and SL Positioning
Server UE in the architecture as per the solution.
NOTE 3: Other 5GC entities not marked with the SL positioning/Ranging label
may still need to be involved in SL positioning/Ranging.
Figure 4.3.1-3 Reference architecture for Sidelink Positioning and Ranging-
based services for inter-PLMN operation with roaming
Editor\'s note: Whether the architecture(s) for (S)NPN deployments will be
considered is FFS.
### 4.3.2 Functional descriptions
Sidelink Positioning and Ranging-based services are supported based on the
architectures in clause 4.3.1, with the following reference points:
\- SR1: The reference point between the UE Sidelink (SL) Positioning and
Ranging function in the UE and the SL Positioning/Ranging Server. This
reference point is out of scope of this specification. It may be used for the
configuration and application layer signaling.
\- SR5: The reference point between the Sidelink (SL) Positioning and Ranging
function in UEs. It is carried over the PC5 reference point.
Editor\'s note: Whether SR5 will be over PC5-RRC, PC5-D, PC5-U and/or PC5-S
will be aligned with RAN WGs.
\- PC5: The reference point between the UEs. It also supports the Sidelink
Positioning and Ranging operation defined by RAN WGs.
NOTE: Whether it includes the LTE based PC5 and/or NR based PC5 will be
addressed by solutions.
Editor\'s note: Reference to RAN WG specifications, e.g. TS 38.300 [8], to be
added when it is available.
\- N1: In addition to the relevant function defined in TS 23.501 [14], if the
UE is in coverage, it may be also used to convey the SL Positioning and
Ranging policy (SLPRP) (including service authorization) from AMF to the UE,
and to convey the UE\'s capability from the UE to the AMF. If the LMF supports
Sidelink Positioning and Ranging-base services, it may be also used to carry
the signaling between UE and LMF, as defined in TS 23.273 [11].
\- N2: In addition to the relevant functions defined in TS 23.501 [14] for N2,
in the case of SL Positioning and Ranging-based service is supported by NG-
RAN, it is also used to convey the SLPRP policy and parameters (including
service authorization) from AMF to NG-RAN.
\- Uu: The reference point between the UE and the NG-RAN.
Following service-based interfaces are used to support Sidelink Positioning
and Ranging-based services:
**Nlmf** : In addition to the relevant services defined in TS 23.273 [11], if
the LMF support SL Positioning and Ranging-based service, it may be used to
provide service to other NFs related to it.
**Nudm** : In addition to the relevant services defined in TS 23.501 [14] for
Nudm, in the case of SL Positioning and Ranging-based service, services
provided by UDM are used to get the related subscription information to AMF
during Initial registration procedure or UE Configuration Update (UCU)
procedure to inform AMF subscription information has changed.
**Npcf** : In addition to the relevant services defined in TS 23.501 [14] for
Npcf, in the case of SL Positioning and Ranging-based service, services
provided by H-PCF are used to provide SL Positioning and Ranging Service
related parameters to V-PCF for UE and NG-RAN in the roaming case.
**Nudr** : In addition to the relevant services defined in TS 23.501 [14] for
Nudr, in the case of SL Positioning and Ranging-based service, services
provided by UDR are used to notify the PCF and the UDM of the update of the SL
Positioning and Ranging-based service related information.
**Namf:** In addition to the relevant services defined in TS 23.501 [14] for
Namf, in the case of SL Positioning and Ranging-based service, services
provided by AMF are consumed by PCF to provide the SL Positioning and Ranging-
based service related parameters for the UE and the NG-RAN to AMF, and to
enable the AMF create or update UE context related to SL Positioning and
Ranging-based service.
# 5 Key Issues
## 5.1 Key Issue #1: Support of authorisation and policy/parameter
provisioning to UE
### 5.1.1 General description
A Ranging/SL positioning capable UE needs necessary configuration data to
perform ranging operations, which contains the policies and/or parameters
related to the service. Additionally, whether the service is permitted shall
also be authorised.
In order to enable Ranging based service and Sidelink positioning over PC5,
the following aspects related to authorisation and policy/parameter
provisioning need to be studied:
\- Study the principle, and identify the necessary and additional information
for service authorisation and (pre‑)configuration/provisioning to the UE based
on what is specified in clause 5.1.2.1 of TS 23.287 [3], and in clauses 5.1.1,
5.1.2.1, and 5.1.3.1 of TS 23.304 [4].
\- Study the procedures related to service authorisation and policy/parameter
(pre-)configuration/provisioning to a UE based on what is specified in clause
6.2 of TS 23.287 [3] and clause 6.2 of TS 23.304 [4].
NOTE: Architectural reference model as documented in clause 4.2 of TS 23.304
[4] and clause 4.2 of TS 23.287 [3] will be used as baseline for this key
issue.
## 5.2 Key Issue #2: Ranging service operation procedure with the assistance
of another UE
### 5.2.1 General description
The ranging service operation between two UEs may need the assistance of one
or more UEs (e.g. assistant UE) if the direct ranging/sidelink positioning
between a reference UE and a target UE cannot be supported, or if the
ranging/sidelink positioning is not sufficiently accurate. The direct
communication between a reference UE and one or more assistant UE and between
a target UE and one or more assistant UEs are respectively supported, so that
the assistant UEs can help on measurement and data transmission.
This key issue addresses how to enhance the 5GS to support ranging service
operation procedures with the assistance of other UEs (e.g. assistant UEs).
At least the following aspects need to be considered in potential solutions:
\- How to discover and determine one or more assistant UEs for ranging
service?
\- What parameters need to be exchanged between different UEs (reference UE,
assistant UEs, target UE) during ranging service operation procedures?
\- How the reference UE or target UE gets the ranging result with the
assistance of one or more assistant UEs during the ranging service operation
procedures?
NOTE: The direct discovery procedure between reference UE and assistant UEs
and between target UE and assistant UEs will be developed under the key issue
related to ranging direct discovery.
## 5.3 Key Issue #3: Ranging/Sidelink Positioning device discovery
### 5.3.1 General description
This KI maps to WT 1.3 of the SID. This KI addresses both UE triggered and
network triggered Ranging/ Sidelink Positioning.
In most of the cases, the 2 or more UE(s) in a Ranging based service and
sidelink positioning cannot always be aware of each other even when they are
in proximity.
To enable a Reference observer UE and a target UE to be able to perform
measurement and communicate for delivering measurement data, the UEs have to
be discovered by each other first.
The discovery procedure is used for a UE to discover or to be discovered by
other UE(s) in proximity over the PC5 interface with the aim of performing
Ranging and Sidelink Positioning.
Reference UE and Target UE are 2 roles in the Ranging based service and
Sidelink Positioning, in terms of who provides the reference plane and
reference direction. Either one can be discovered by the other.
Ranging/Sidelink Positioning device discovery may be triggered at the UEs
themselves and/or based on network instruction (e.g. under network monitoring,
when, within which distance/angle or which UE(s) can be discovered).
Following aspects need to be addressed under this key issue:
1\. How Reference UEs and Target UEs are discovered by each other to perform
Ranging based service and Sidelink Positioning for the case of in coverage,
partial coverage and out of coverage for both UE triggered and network
triggered Ranging/Sidelink Positioning, with the following considerations:
\- How one Target UE and one Reference UE are discovered by each other?
\- How one Target UE and multiple Reference UEs are discovered by each other?
\- How one Reference UE and multiple target UEs are discovered by each other?
NOTE 1: ProSe direct discovery procedure should be reused as much as possible.
2 How Ranging/Sidelink Positioning devices\' discovery is triggered at UE
based on network instruction for the cases of in coverage, partial coverage
and out of coverage?
NOTE 2: It is assumed that both the Reference UE(s) and the target UE are
Ranging/SL positioning capable.
## 5.4 Key issue #4: Control of Operations for Ranging/Sidelink positioning
### 5.4.1 General description
Ranging and sidelink positioning supports a large variety of use cases,
including automotive, public safety, and commercial use. These different uses
cases may utilize different access technologies for the communication between
the UEs, e.g. LTE based V2X, NR based sidelinks and, in later releases, other
RAT technologies may be supported over PC5, e.g. newer version of sidelink and
non-3GPP RATs. Therefore, it is beneficial to design a common framework and
system to support all these types of operations.
The control signalling part of the Ranging and Sidelink Positioning operation
may occur between the UEs before and after the transmission of the
Ranging/Sidelink positioning signals. The control signalling includes (but is
not limited to):
\- coordination and configuration of the UEs to participate in the
ranging/sidelink positioning, e.g. including discovery of the devices,
signalling control and configuration information between devices;
\- exchange of measurement results of Ranging/Sidelink positioning signals
between the UEs for ranging/Sidelink positioning calculation.
This key issue is focusing on developing the control signalling for Ranging
and Sidelink Positioning operations. Specifically, the key issue addresses:
\- What coordination and configuration information are exchanged between the
UEs?
\- What are the control signalling procedure to exchange the coordination &
configuration information and the Ranging/Sidelink positioning signals
measurement results between the UEs?
NOTE 1 Common solution is preferred to be developed if the same control
signalling procedure can be supported when the signalling is carried over
different RATs in different use cases.
NOTE 2: Common control signalling protocol is preferred to support the
different Ranging/Sidelink positioning signals operation in different
spectrums.
NOTE 3: The solution development may also consider signalling efficiency,
overhead, energy efficiency and the robustness.
NOTE 4: Coordination with RAN WGs is needed to develop an aligned solution.
NOTE 5: It is desirable to avoid any AS layer impacts to support the control
signalling.
\- What are the functionality of upper layers, and what parameters need to be
exchanged between the upper layers and AS layer for Ranging/ Sidelink
positioning?
## 5.5 Key Issue #5: Network assisted Sidelink Positioning for In Network
Coverage and Partial Network Coverage
### 5.5.1 General description
This key issue addresses the case when a UE is not able to perform Uu based
positioning estimation. The UE may be out of network coverage, or have network
coverage but not able to measure on enough gNBs to perform Uu based
positioning. In this case, the UE (i.e. partial coverage or in network
coverage) may use Sidelink Positioning to obtain relative positioning with a
Located UE which is in network coverage. This case is referred to as Sidelink
Positioning in TR 38.845 [6]. In this KI we call this case Network assisted
Sidelink Positioning.
For this key issue, the following aspects need to be studied:
\- Discovery of one or more Located UEs with capabilities that offers Sidelink
Positioning and/or Uu based positioning to support Network assisted Sidelink
Positioning for in network coverage and partial network coverage.
\- Discovery of network capability that offers Network assisted Sidelink
positioning for UE in network coverage and partial network coverage.
\- Signalling needed to support Sidelink positioning including both UE-based
positioning and network-assisted/based positioning.
NOTE 1: Security aspects are SA WG3 responsibility, and the related impact to
architecture enhancement will be based on SA WG3 conclusion.
NOTE 2: Coordination with RAN WG is needed for network assisted Sidelink
Positioning.
NOTE 3: Coordination with FS_eLCS_ph3 may be needed if any changes to existing
LCS framework.
## 5.6 Key Issue #6: Ranging and sidelink positioning service exposure to a UE
### 5.6.1 General description
The Ranging/Sidelink positioning service between 2 Ranging/Sidelink
positioning capable UEs may be exposed to a SL Positioning Client UE to obtain
the Ranging/Sidelink positioning information between the 2 UEs.
The SL Positioning Client UE may request Ranging/Sidelink positioning
information immediately, periodically or at a later time.
The service request can also be initiated by one of the Ranging/Sidelink
positioning capable UEs providing the service, i.e. Ranging/Sidelink
positioning service is exposed to one of the UEs providing the service. In
that case, the SL Positioning Client UE is the same as one of the UEs
providing the service.
The following aspects need to be studied for the potential solutions:
\- How does a Ranging/Sidelink positioning capable UE expose the
Ranging/Sidelink positioning service to a UE?
\- What Ranging/Sidelink positioning information are to be exposed to a UE?
\- How to authorize the SL Positioning Client UE to consume the
Ranging/Sidelink positioning service?
\- How to support Ranging/Sidelink Positioning request?
NOTE: For direct communication related aspects, V2X and/or ProSe architecture
is used as the basis, and V2X and ProSe solutions will be reused as much as
possible. Coordination with FS_5G_ProSe_Ph2 study may be required if any
impact to R18 ProSe solution is identified.
## 5.7 Key Issue #7: Ranging/Sidelink Positioning service exposure to
Application server and for network assisted sidelink positioning
### 5.7.1 General description
Application Server may initiate the Ranging/Sidelink Positioning service
request for acquiring Ranging information between 2 UEs. A Ranging/Sidelink
Positioning request may also be initiated by 5G network for network assisted
sidelink positioning. Application Server/5G network may request
Ranging/Sidelink positioning information immediately, periodically or at a
later time.
In order to enable Ranging/Sidelink positioning service exposure to
Application server and for network assisted measurement management, following
aspects need to be studied for the potential solutions:
\- How 5GS exposes the Ranging/Sidelink Positioning measurement management
service to 5G network and Application server?
\- What are the architectural enhancements to support Ranging/Sidelink
Positioning service exposure to Application server and for network assisted
sidelink positioning, the required NF and NF services?
\- How to support Ranging/Sidelink Positioning request?
## 5.8 Key Issue #8: Service Authorization to NG-RAN
### 5.8.1 General description
As defined in TS 38.300 [8], the UE can operate in either Scheduled resource
allocation mode or UE autonomous resource selection mode for resource
allocation in sidelink. This also applies to Ranging/SL Positioning. If
scheduled resource allocation mode is used, service authorization information
needs to be provisioned to NG-RAN for the support of Ranging/SL Positioning.
In order to enable Ranging based services and sidelink positioning over PC5,
the following aspects related to Service Authorization to NG-RAN need to be
studied:
\- What are the service authorization policy/parameter required for the
support of Ranging/SL Positioning to be provisioned to NG-RAN and how does 5GC
authorize the usage of Ranging based services and sidelink positioning over
PC5 and the related policy/parameter?
NOTE: Procedures for Service Authorization to NG-RAN as documented in clause
6.5 of TS 23.287 [3] and clause 6.6 of TS 23.304 [4] will be used as baseline
for this key issue.
# 6 Solutions
## 6.0 Mapping of solutions to key issues
Editor\'s note: This clause describes the mapping between solutions and key
issues.
Table 6.0-1: Mapping of solutions to key issues
              Key Issues
* * *
Solutions 1 2 3 4 5 6 7 8 1 X X 2 X  
3 X  
4 X X  
5 X X  
6 X  
7 X  
8 X  
9 X  
10 X X  
11 X  
12 X X  
13 X  
14 X X X X X X X X 15 X 16 X  
17 X  
18 X  
19 X X  
20 X  
21 X  
22 X X  
23 X  
24 X  
25 X  
26 X X X X X X  
27 X X X X X X  
28 X X X X X X  
29 X  
30 X  
31 X  
32 X X  
33 X X  
34 X X
## 6.1 Solution #1: Authorisation and policy/parameter provisioning to UE and
NG-RAN
Editor\'s note: This clause describes a solution addressing one or more key
issues identified in clause 5. The structure of the (sub) clauses can be
adjusted. The list of key issues which this solution attempts to resolve
should be clearly indicated.
### 6.1.1 General
This solution addresses KI#1 and KI#8: Support of authorisation and
policy/parameter provisioning to UE, two following major aspects are covered:
\- For the procedures related to Ranging/SL positioning service authorization
and policy/parameter provisioning to a UE, only necessary enhancement with
what is specified in TS 23.304 [4] clause 6.2, and TS 23.502 [9] clause
4.2.2.2 (Registration Procedure), clause 4.2.4.3 (UE Configuration Update
procedure for transparent UE Policy Delivery), clause 4.16.11 (UE Policy
Association Establishment procedure), clause 4.16.12 (UE Policy Association
Modification procedure), will be documented.
\- Identify necessary information for Ranging/SL positioning service
authorization and provisioning based on what is specified in TS 23.304 [4]
clauses 5.1.1, 5.1.2.1, and 5.1.3.1.
The PCF based service authorization and provisioning as defined in TS 23.304
[4] are used as baseline for this solution.
### 6.1.2 Functional descriptions
Ranging/SL positioning refers to the determination of the distance between two
UEs or more UEs and/or the direction and/or relative positioning of one UE
(i.e. Target UE) from another UE (i.e. Reference UE) via PC5 interface.
Ranging/SL positioning can be regarded as a new type of function built on top
of PC5 mechanism, including PC5 discovery and communication mechanisms.
Therefore, identifying Ranging/SL positioning related enhancements compared
with legacy PC5 mechanisms are necessary.
The followings reflect the additions provided by the UE w.r.t Ranging/SL
positioning:
\- UE includes PC5 Capability for Ranging/SL positioning as part of \"5GMM
capability\" in the Registration Request message. The AMF stores this
information for Ranging/SL positioning operation. The PC5 Capability for
Ranging/SL positioning indicates whether the UE is capable of Ranging/SL
positioning service over PC5 reference point.
\- If the UE does not have valid authorisation and policy/parameters for
Ranging/SL positioning, the UE includes the UE Policy Container with
indicating the Policy Provisioning Request for Ranging/SL positioning during
registration procedure.
\- If the UE indicates the Policy Provisioning Request for Ranging/SL
positioning in the UE Policy Container, the PCF determines whether to
provision Policy/parameters for Ranging/SL positioning to the UE, as specified
in clause 6.1.2.2.2 of TS 23.503 [15], and the PCF provides the
Policy/parameters for Ranging/SL positioning to the UE by using the procedure
as defined in clause 4.2.4.3 \"UE Configuration Update procedure for
transparent UE Policy Delivery\" in TS 23.502 [9].
The followings reflect the additions of the 5GC processing w.r.t Ranging/SL
positioning:
\- If the AMF receives the PC5 Capability for Ranging/SL positioning in the
Registration Request message from UE, the AMF selects the PCF which supports
Ranging/SL positioning and establishes a UE policy association with PCF for
Ranging/SL positioning service Policy/Parameter delivery.
The followings reflect the additions provided to the UE from PCF w.r.t
Ranging/SL positioning:
\- A \"Ranging/SL positioning service authorized\" indication, indicating the
UE is authorized to use Ranging/SL positioning service in the PLMN(s).
\- The authorized Ranging/SL positioning service types, authorized application
IDs, authorized user IDs.
\- The authorized Ranging/SL positioning parameters.
Editor\'s note: the Ranging/SL positioning parameters are FFS and may be
coordinated with RAN WGs.
\- The authorized Ranging/SL positioning role, e.g. target UE, reference UE,
assistant UE.
\- The authorized discovery mode and UE role in discovery for Ranging/SL
positioning.
The followings reflect the additions provided to the NG-RAN from AMF w.r.t
Ranging/SL positioning:
\- A \"Ranging/SL positioning service authorized\" indication based on UE
subscription from UDM, indicating the UE is authorized to use Ranging/SL
positioning service in the serving PLMN.
\- The authorized Ranging/SL positioning parameters used by the NG-RAN for the
resource management of UE\'s PC5 transmission for Ranging/SL positioning
services in network scheduled mode, which is from PCF and stored in AMF.
Editor\'s note: the Ranging/SL positioning parameters are FFS and may be
coordinated with RAN WGs.
\- The authorized Ranging/SL positioning role based on UE subscription from
UDM, e.g. target UE, reference UE, assistant UE.
The parameters may be preconfigured in ME/UICC, the UE can work without
provision of configuration parameters from the network, especially in the use
case of out-of-coverage. Or when the UE with Ranging/SL positioning capability
is in coverage, the UE can access to the network to obtain the necessary
configuration data from the network (e.g. PCF). One the other hand, the
network will also provide RAN-related configuration data (e.g. Ranging/SL
positioning authorized) to RAN node so as to enable RAN node to allocate PC5
resource once UE initiates Ranging/SL positioning operation.
### 6.1.3 Procedures
The procedures specified in TS 23.304 [4] clause 6.2, and TS 23.502 [9] clause
4.2.2.2 (Registration Procedure), clause 4.2.4.3 (UE Configuration Update
procedure for transparent UE Policy Delivery), clause 4.16.11 (UE Policy
Association Establishment procedure), clause 4.16.12 (UE Policy Association
Modification procedure), are applied.
### 6.1.4 Impacts on services, entities, and interfaces
**UE:**
\- Need to indicate its PC5 capability for Ranging/SL positioning to AMF;
\- Indicate the Policy Provisioning Request for Ranging/SL positioning in the
UE Policy Container to PCF.
\- Receive and enforce the Policy and parameter for Ranging/SL positioning.
**NG-RAN:**
\- Receive and store the UE\'s Ranging/SL positioning authorization
information for network scheduled mode operation.
**AMF:**
\- Determine whether UE is authorized for Ranging/SL positioning service;
\- Select a PCF capable of authorization Policy and parameter for Ranging/SL
positioning service;
\- Forward the UE\'s Ranging/SL positioning authorization information for
network scheduled mode to NG-RAN.
**PCF:**
\- Determine the UE\'s Authorization Policy and parameter for Ranging/SL
positioning and send it to UE based on the Policy Provisioning Request for
Ranging/SL positioning from UE;
\- Send the RAN\'s Authorization Policy and parameter for Ranging/SL
positioning to NG-RAN via AMF.
**UDM:**
\- Install the new UE subscription information of Ranging/SL positioning
services;
## 6.2 Solution #2: V2XP/ProSeP enhancement for the support of Ranging/SL
Positioning
### 6.2.1 General
This solution is to address KI#1.
It is assumed that all Ranging/SL positioning capable UEs are ProSe or V2X
capable, thus UE will be provisioned with either V2XP or ProSeP together with
the Ranging/SL positioning policy/parameter. Some Policy/Parameters of
V2XP/ProSeP may also be applied to Ranging/SL Positioning, then it is not
necessary to additionally transmit them to the UE when V2XP/ProSeP is also
transmitted, thus saves the NG-RAN resources.
Ranging/SL Positioning can be seen as an extended capability of ProSe or V2X.
### 6.2.2 Functional descriptions
Ranging/SL Positioning Policy/Parameters can be categorized into 2 groups:
\- Ranging/SL Positioning specific parameters: These parameters are
dedicatedly used for Ranging/SL Positioning, which may contain reused 5G
ProSeP/V2XP parameters by defining Ranging/SL Positioning as a specific V2X/5G
ProSe service type and the newly defined parameters specifically for
Ranging/SL Positioning.
\- ProSeP/V2XP shared parameters: These parameters are used for both V2X/5G
ProSe and Ranging/SL Positioning, which contain reused 5G ProSeP/V2XP
parameters that can apply to all service types.
The following parameters are defined as Ranging/SL Positioning specific
parameters:
\- For Direct Discovery:
\- Parameters used for Direct Discovery (e.g. Destination Layer-2 ID(s) for
sending/receiving initial signalling of discovery messages, ProSe identifiers
used for Ranging/Sidelink positioning).
\- For Direct Communication:
\- Policy/parameters related to privacy.
\- Policy/parameters when NR PC5 is selected.
\- Authorization policy for Ranging/SL Positioning (new defined).
\- When the UE is \"served by NG-RAN\":
\- For a Ranging/SL Positioning capable UE, PLMNs it is authorized to perform
as a reference UE for Ranging/SL Positioning.
\- For a Ranging/SL Positioning capable UE, PLMNs it is authorized to perform
as a target UE for Ranging/SL Positioning.
\- For a Ranging/SL Positioning capable UE, PLMNs it is authorized to perform
Ranging/SL Positioning for acquiring relevant distance.
\- For a Ranging/SL Positioning capable UE, PLMNs it is authorized to perform
Ranging/SL Positioning for acquiring relevant direction.
\- For a Ranging/SL Positioning capable UE, PLMNs it is authorized to perform
high accuracy Ranging/SL Positioning for acquiring relevant distance.
\- For a Ranging/SL Positioning capable UE, PLMNs it is authorized to perform
high accuracy Ranging/SL Positioning for acquiring relevant direction.
\- When the UE is \"not served by NG-RAN\":
\- For a Ranging/SL Positioning capable UE, whether it is authorized to
perform as a reference UE for Ranging/SL Positioning.
\- For a Ranging/SL Positioning capable UE, whether it is authorized to
perform as a target UE for Ranging/SL Positioning.
\- For a Ranging/SL Positioning capable UE, whether it is authorized to
perform Ranging/SL Positioning for acquiring relevant distance.
\- For a Ranging/SL Positioning capable UE, whether it is authorized to
perform Ranging/SL Positioning for acquiring relevant direction.
\- For a Ranging/SL Positioning capable UE, whether it is authorized to
perform high accuracy Ranging/SL Positioning for acquiring relevant distance.
\- For a Ranging/SL Positioning capable UE, whether it is authorized to
perform high accuracy Ranging/SL Positioning for acquiring relevant direction.
The following parameters are defined as ProSeP/V2XP shared parameters:
\- For Direct Discovery:
\- Authorization policy.
\- Radio parameters when the UE is \"not served by NG-RAN\".
\- Restricted ProSe Discovery UE ID for Restricted Direct Discovery.
\- Group Member Discovery parameters.
\- Validity timer indicating the expiration time of the Policy/Parameter.
\- For Direct Communication:
\- Authorization policy.
\- Groupcast mode 5G ProSe Direct Communication policy/parameters.
\- Radio parameters when the UE is \"not served by NR\".
Editor\'s note: It is FFS if other parameters are needed.
Editor\'s note: Whether LTE PC5 related policy/parameters are needed for
Ranging/SL positioning control signalling is FFS.
When UE requests Ranging/SL Positioning policy/parameters, it includes the UE
Policy Container with indicating Ranging/SL Positioning Policy Provisioning
Request in addition to V2X/5G ProSe Policy Provisioning Request. The PCF
provides Ranging/SL Positioning policy/parameters in either V2XP or ProSeP to
the UE. PCF determines whether to provide the V2XP or ProSeP to the UE
depending on whether a V2X Policy Provisioning Request or a 5G ProSe Policy
Provisioning Request is indicated together:
\- When V2X Policy Provisioning Request is indicated together with Ranging/SL
Positioning Policy Provisioning Request, PCF provides Ranging/SL Positioning
policy/parameters in the V2XP;
\- When 5G ProSe Policy Provisioning Request is indicated together with
Ranging/SL Positioning Policy Provisioning Request, PCF provides Ranging/SL
Positioning policy/parameters in the ProSeP;
\- When both V2X Policy Provisioning Request and 5G ProSe Policy Provisioning
Request are indicated together with Ranging/SL Positioning Policy Provisioning
Request, PCF provides Ranging/SL Positioning policy/parameters in both the
V2XP and the ProSeP.
To support Ranging/SL Positioning, UE enforces either the Ranging/SL
Positioning policy/parameters of V2XP or the those in the ProSeP based on the
service request:
\- When the service request is for a V2X service, it enforces Ranging/SL
Positioning policy/parameters of V2XP;
\- When the service request is for a commercial service or a public safety
service, it enforces Ranging/SL Positioning policy/parameters of ProSeP.
### 6.2.3 Procedures
#### 6.2.3.1 Support of Ranging/SL Positioning for V2X service
##### 6.2.3.1.1 PCF based Service Authorization and Provisioning to UE
If the UE supports V2X communication & Ranging/SL Positioning and it does not
have valid V2X policy/parameters, the UE includes the UE Policy Container with
indicating Ranging/SL Positioning Policy Provisioning Request in addition to
the V2X Policy Request during registration procedure.
If the UE indicates Ranging/SL Positioning Policy in addition to the V2X
Policy Provisioning Request in the UE Policy Container, the PCF determines to
include in the V2XP the following policy/parameters in addition by considering
Ranging/SL Positioning as a special V2X service type with the mapping
parameters:
\- Policy/parameters for PC5 Tx Profile selection;
\- Policy/parameters related to privacy;
\- Policy/parameters when NR PC5 is selected.
PCF also determines to include Authorization policy for Ranging/SL Positioning
as defined in clause 6.2.2 in the V2XP.
The PCF provides the V2XP to the UE by using \"UE Configuration Update
procedure for transparent UE Policy Delivery\" procedure as defined in clause
4.2.4.3 of TS 23.502 [9].
##### 6.2.3.1.2 Procedure for UE triggered V2X Policy provisioning
The UE triggered Policy Provisioning procedure is initiated by the UE to
request V2X Policy/Parameter from the PCF when UE determines the V2X
Policy/Parameter is invalid in the following cases:
\- if the validity timer indicated in the V2X Policy/Parameter expires;
\- if there are no valid parameters, e.g. for the V2X service type a UE wants
to use, for current area, or due to abnormal situation.
Figure 6.2.3.1.2-1: UE triggered V2X Policy provisioning procedure
1\. The UE sends UL NAS TRANSPORT message carrying the UE Policy Container (UE
V2X Policy Provisioning Request to request V2X policies) to the AMF.
2\. The AMF sends the Namf_Communication_N1MessageNotify request to the PCF
including the UE Policy Container received from UE.
3\. The PCF receives UE Policy Container which indicates UE Policy
Provisioning Request to request Ranging/SL Positioning policy/parameters in
addition to V2X policy/parameters. The PCF determines the authorised
policy/parameters and deliver them to the UE as defined in 6.2.3.1.1.
##### 6.2.3.1.3 Ranging/SL Positioning Policy enforcement at UE
When Ranging/SL Positioning is performed for V2X service, the UE applies
parameters received in V2XP for Ranging/SL Positioning.
#### 6.2.3.2 Support of Ranging/SL Positioning for commercial and public
safety service
##### 6.2.3.2.1 PCF based Service Authorization and Provisioning to UE
If the UE supports one of 5G ProSe capabilities & Ranging/SL Positioning and
it does not have valid 5G ProSe policy/parameters, the UE includes the UE
Policy Container with indicating Ranging/SL Positioning Policy Provisioning
Request in addition to the 5G ProSe Policy Provisioning Request during
registration procedure.
If the UE indicates Ranging/SL Positioning Policy Provisioning Request in
addition to the 5G ProSe Policy Provisioning Request in the UE Policy
Container, the PCF determines to include in the 5G ProSeP the following
policy/parameters in addition to the other policy/parameters by considering
Ranging/SL Positioning as a special 5G ProSe service identified by a
predefined ProSe Identifier with the mapping parameters:
\- Parameters used for 5G ProSe Direct Discovery.
\- Policy/parameters related to privacy.
\- Policy/parameters when NR PC5 is selected.
PCF also determines to include Authorization policy for Ranging/SL Positioning
as defined in clause 6.2.2 in the ProSeP.
The PCF provides the 5G ProSe policy/parameters to the UE by using \"UE
Configuration Update procedure for transparent UE Policy Delivery\" procedure
as defined in clause 4.2.4.3 of TS 23.502 [9].
##### 6.2.3.2.2 Procedure for UE triggered ProSe Policy provisioning
The UE triggered Policy Provisioning procedure is initiated by the UE to
request ProSe Policy/Parameter from the PCF when UE determines the 5G ProSe
Policy/Parameter is invalid in the following cases:
\- if the validity timer indicated in the 5G ProSe Policy/Parameter expires;
\- if there are no valid parameters, e.g. for the 5G ProSe Identifier a UE
wants to use, for current area, or due to abnormal situation.
Figure 6.2.3.2.2-1: UE triggered 5G ProSe Policy provisioning procedure
1\. The UE sends the UL NAS TRANSPORT message carrying the UE Policy Container
(UE Policy Provisioning Request to request 5G ProSe policies) to the AMF.
2\. The AMF sends Namf_Communication_N1MessageNotify request to the PCF
including the UE Policy Container received from UE.
3\. The PCF receives UE Policy Container which indicates UE Policy
Provisioning Request to request Ranging/SL Positioning policies in addition to
5G ProSe policies. The PCF determines the authorized policy and deliver them
to the UE as defined in clause 6.2.3.2.1.
##### 6.2.3.2.3 Ranging/SL Positioning Policy enforcement at UE
When Ranging/SL Positioning is performed for commercial and public safety
service, the UE applies parameters received in 5G ProSe policy for Ranging/SL
Positioning.
### 6.2.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities:
\- UE: differentiates Ranging/SL Positioning for V2X service or for
commercial/public safety service to determine whether to apply ProSe or V2XP
to enforce Ranging/SL Positioning.
\- PCF: determines whether to provide the V2XP or ProSeP to the UE depending
on whether a V2X Policy Provisioning Request or a 5G ProSe Policy Provisioning
Request is indicated together; support of new Ranging/SL Positioning
policy/parameter.
## 6.3 Solution #3: Solution for direct ranging operation
### 6.3.1 General
This solution resolves Key Issue #4 for Operation controls for
Ranging/Sidelink positioning. In particular, this solution tries to solve what
coordination and configuration information are exchanged between the UEs, and
how to exchange the coordination and configuration information and the ranging
results between the UEs.
In general, this solution proposes three steps in the direct Ranging
operation:
\- The upper layer (e.g. Ranging layer) initiates the ranging session by
sending ranging request/response message (i.e., Ranging/Sidelink Positioning
initiation procedure) and performs the ranging parameter coordination between
the UEs, and the upper layer provides the ranging configuration to the AS
layer. The ranging parameter includes the Ranging role (Reference UE or Target
UE), one time or period ranging, ranging for distance or direction measurement
or both, ranging QoS/accuracy.
\- Ranging/Sidelink Positioning Protocol (RSPP) procedure is performed e.g.,
for Ranging Capability Transfer, Ranging Assistance Data Transfer, and Ranging
Location Information Transfer between the UEs. The details of the RSPP
procedure are expected to be developed and defined in RAN WGs.
\- The lower layer (e.g. AS layer) transmits or receives Ranging signalling
and performs measurements according to the ranging configuration;
\- The UE calculates the ranging results, and the ranging results could be
shared between the UEs via the upper layer.
This solution proposes to add a RSPP protocol over the PDCP.
Figure 6.3.1-1: Ranging/sidelink Positioning protocol over PC5 reference point
### 6.3.2 Procedures
Figure 6.3.2-1: High-level procedure for Ranging operation control
1\. UE1 and UE2 may get the ranging authorization policy and parameters from
PCF during the registration procedure. The ranging authorization policy and
parameters may include whether the UE is authorized as Reference UE or Target
UE.
2\. When the UE1 gets the ranging request from the application layer, other UE
or 5GC NF, UE1 can discovery UE2 by using the solutions for KI#3
Ranging/Sidelink Positioning device discovery.
3\. UE1 and UE2 can perform the PC5 connection establishment, as defined in TS
23.304 [4].
NOTE: PC5 connection is established for the signalling interaction of ranging
parameters between two UEs. This step is optionally needed only when
Ranging/Sidelink positioning is between two UEs.
4\. UE1 sends the ranging request to the UE2 to initiate the ranging session
and also negotiate the ranging parameters, and the ranging request can be a
new PC5-S signalling carried by the PC5 connection. The ranging request
includes the ranging parameters, e.g. the Ranging role (Reference UE or Target
UE), one time or period ranging, ranging for distance or direction measurement
or both, and ranging QoS/accuracy.
Editor\'s note: The parameters coordinated between the 2 UEs will be further
evaluated.
UE1 can determinate the Ranging role based on the ranging authorization in
step 1 or ranging capability (capability as Reference UE or Target UE). For
example, the UE1 decides to act as Reference UE, then the Ranging role means
that \"I am Reference UE\" or \"you are Target UE\".
UE1 can get the one time or period ranging, ranging for distance or direction
measurement or both from the application layer when the application layer
sends the ranging request to the upper layer (e.g. Ranging layer).
5\. UE2 sends the ranging response to the UE1. If UE2 wants to change the
Ranging role (e.g. UE2 wants to act as Reference UE), for example due to its
ranging capability, a new Ranging role is included.
Step 4 and Step 5 can be regard as Ranging/Sidelink Positioning initiation
procedure.
6\. UE1 and UE2 perform the RSPP procedure to exchange the coordination
information, e.g. the Ranging Capability Transfer and Ranging Assistance Data
Transfer. The details are expected to be defined in RAN WGs.
7\. The upper layer of each UE provides the ranging configuration to the AS
layer. The ranging configuration includes the Ranging role (Reference UE or
Target UE), one time or period ranging, ranging for distance or direction
measurement or both.
8\. The AS layer of each UE transmits or receives Ranging signalling according
to the ranging configuration, and the Reference UE calculates the ranging
results. For example, for direction measurement, Target UE transmits Ranging
signalling and Reference UE receives it accordingly.
Editor\'s note: Coordination with RAN WGs is needed on whether and how the
ranging configuration is used.
9\. The ranging results could be shared between the UEs via e.g. the PC5-S
signalling.
### 6.3.3 Impacts on services, entities, and interfaces
**UE:**
\- Receives the ranging authorization policy and parameters from PCF;
\- Inter-layer communication regarding the configuration for ranging
operation;
\- Inter-UE communication regarding parameters negotiation for ranging service
and possibly further sharing of the ranging results.
## 6.4 Solution #4: Ranging devices discovery and ranging procedure
### 6.4.1 Description
This solution is related to the Key Issue #3 on Ranging/Sidelink Positioning
device discovery and Key issue #4: Control of Operations for Ranging/Sidelink
positioning.
To realize the Ranging/Sidelink Positioning, as explained in KI#4, the
signalling between the UEs is needed for the purpose of Ranging/Sidelink
Positioning control to exchange the coordination & configuration information
and the Ranging/Sidelink positioning signals measurement results, it, is very
similar to the LPP procedure between UE and LMF over NAS (e.g. capability
transfer, Assistance Data Transfer, Location Information Transfer specified in
6.4 of TS 38.305 [16]). Correspondingly, this solution is proposed to add a
Ranging/Sidelink Positioning Protocol layer on top of existing direct
communication protocol as specified in clause 6.1 of TS 23.304 [4], and clause
5.2.1 of TS 23.287 [3] for the Ranging/Sidelink Positioning control signalling
interaction between UEs.
Figure 6.4.1-1: Ranging/sidelink Positioning protocol over PC5 reference point
Similar to LPP over Uu interface, the Ranging/Sidelink Positioning Protocol
(RSPP) may include the following procedures as described in clause 6.4.2.4:
\- Procedures related to capability transfer for Ranging/Sidelink Positioning
between UEs;
\- Procedures related to Assistance Data Transfer for Ranging/Sidelink
Positioning between UEs;
\- Procedures related to Location Information Transfer for Ranging/Sidelink
Positioning between UEs.
NOTE: Details of the RSPP procedures in this solution are expected to be
developed in RAN WGs.
Editor\'s note: Texts related to RSPP may be further updated once there\'s any
conclusion in RAN Working Groups.
Editor\'s note: Whether a new Ranging/Sidelink positioning protocol is defined
or an enhancement to LPP to support Ranging/Sidelink positioning is defined
will be determined by RAN Working Groups.
### 6.4.2 Procedures of Ranging/Sidelink Positioning for 5G ProSe
#### 6.4.2.1 General
To realize the control of operations for Ranging/Sidelink positioning,
following procedure is assumed to be performed:
\- Ranging/Sidelink Positioning device discovery;
\- Direct communication establishment for Ranging/Sidelink Positioning
protocol procedure;
\- Ranging/Sidelink Positioning procedure.
The following procedures are for UEs that support 5G ProSe PC5 reference point
as defined in TS 23.304 [4].
Editor\'s note: Solutions on device discovery for UE supporting V2X PC5
reference as defined in TS 23.287 [3] may be provided in other solutions.
Existing Model A and Model B direct discovery as specified in clause 6.3.2.1
of TS 23.304 [4] are reused as basis for Ranging/Sidelink Positioning devices
discovery.
Existing Unicast mode 5G ProSe Direct Communication establishment procedure as
specified in clause 6.4.3 of TS 23.304 [4] are reused.
#### 6.4.2.2 Procedures of Ranging/Sidelink Positioning between 2 UEs with
Model A discovery
Figure 6.4.2.2-1: High-level procedure of Ranging/Sidelink Positioning with
Model A discovery
In this procedure, Reference UE and Target UE can take the design of UE
Assisted and UE Based Positioning Procedure as specified in clause 6.11.1 of
TS 23.273 [11] to enable the Ranging/Sidelink Positioning.
1\. The Target UE sends an Announcement message. The Announcement message may
include the Type of Discovery Message, Target UE info, Ranging/Sidelink
Positioning service Code, Role indication (target UE) and Target UE capability
(e.g. ranging support).
2\. Reference UEs monitor the Announcement message. If the Target info is the
Reference UE to be discovered, the Reference UEs have the interests on the
Ranging service and support the Ranging/Sidelink Positioning capability of the
Target UE if any, the Reference UE performs the direct PC5 link establishment
procedure with target UE as described in clause 6.4.3.1 of TS 23.304 [4].
3\. The Target UE and the Reference UE perform the Ranging/Sidelink
Positioning control interaction procedure to exchange the coordination &
configuration information, e.g. the Ranging capability and Ranging Assistance
Data, as described in clause 6.4.2.4.
NOTE: The PC5 message carrying RSPP message is consider as new kind of PC5-S
message in this solution.
Editor\'s note: How to handle the definition of PC5-S message carrying RSPP
message is FFS.
4\. Target UE and the Reference UE pass the interacted coordination &
configuration information down to the AS layer.
5\. Target UE and the Reference UE perform the Ranging/Sidelink Positioning
measurement and result calculation.
6\. The Target UE and the Reference UE perform the Ranging/Sidelink
Positioning control interaction procedure to exchange Ranging/Sidelink
Positioning measurement results as described in clause 6.4.2.5, and then
provide the measurement results to the RSPP layer.
#### 6.4.2.3 Procedures of Ranging/Sidelink Positioning between 2 UEs with
Model B discovery
Figure 6.4.2.3-1: High-level procedure of Ranging/Sidelink Positioning with
Model B discovery
In this procedure, Reference UE and Target UE can take the design of UE
Assisted and UE Based Positioning Procedure as specified in clause 6.11.1 of
TS 23.273 [11] to enable the Ranging/Sidelink Positioning.
1\. The Reference UE sends a Solicitation message. The Solicitation message
may include Type of Discovery Message, Ranging/Sidelink Positioning service
Code, Reference UE info, Target UE info, Role indication (Reference UE) and
Reference UE capability.
2\. Target UE monitors the Solicitation message. If the Target UE decides to
be discovered and ranged based on the included Target info and the Reference
UE capability in the Solicitation message, the Target UE responds to the
Reference UE with a Discovery response message. The Discovery response message
may include the Target UE capability.
3\. After the target UE discovery, the Reference UE performs the PC5 Unicast
communication establishment with target UE.
4-7. This step is same as the step 3\~6 of Figure 6.4.2.2-1.
NOTE: Reference UE can also initiate the discovery procedure to discover a
Target UE.
#### 6.4.2.4 RSPP procedures to exchange the coordination & configuration
information
##### 6.4.2.4.1 RSPP procedures to exchange Ranging capability
Figure 6.4.2.4.1-1: RSPP procedures to exchange Ranging capability
1\. For the RSPP procedure to exchange Ranging capability, the Target UE or
the Reference UE may request the peer UE to provide the Ranging capability.
The Ranging capability request is transferred via the PC5-S message.
2\. The Target UE or the Reference UE provides its Ranging capability to the
peer UE which is transferred via the PC5-S message.
##### 6.4.2.4.2 RSPP procedures to exchange Ranging assistant data
Figure 6.4.2.4.2-1: RSPP procedures to exchange Ranging assistant data
1\. For the RSPP procedure to exchange Ranging assistant data, the Target UE
or the Reference UE may request the peer UE to provide the Ranging assistant
data. The Ranging assistant data request is transferred via the PC5-S message.
2\. The Target UE or the Reference UE provides its Ranging assistant data to
the peer UE which is transferred via the PC5-S message.
#### 6.4.2.5 RSPP procedures to exchange Ranging/Sidelink Positioning
measurement results
Figure 6.4.2.5-1: RSPP procedures to exchange Ranging/Sidelink Positioning
measurement results
1\. For the RSPP procedure to exchange Ranging/Sidelink Positioning
measurement results, the Target UE or the Reference UE may request the peer UE
to provide the Ranging/Sidelink Positioning measurement results. The
Ranging/Sidelink Positioning measurement result request is transferred via the
PC5-S message.
2\. The Target UE or the Reference UE provides its Ranging/Sidelink
Positioning measurement results to the peer UE which is transferred via the
PC5-S message.
### 6.4.3 Impacts on Existing Nodes and Functionality
The solution has impacts on the following entities:
UE(s):
\- Support the RSPP over PC5 reference point.
\- Support the PC5-S message carrying RSPP message.
## 6.5 Solution #5: Solution to support Ranging/Sidelink Positioning
### 6.5.1 General
This solution addresses the KI#3: Ranging/ Sidelink Positioning device
discovery and the KI#4: Control of Operations for Ranging/ Sidelink.
### 6.5.2 Functional Descriptions
To trigger the sidelink positioning procedure between an UE-1 and UE-2(s), the
application layer in UE-1 provides ranging/sidelink positioning parameters to
ranging layer. The ranging layer in the UE-1 broadcasts a ranging/sidelink
positioning request message which includes the parameters provided by the
application layer.
After the UE-2(s) receives the message, the sidelink positioning procedure is
triggerred as follows to get the Ranging/Sidelink positioning result:
\- UE-1 based sidelink positioning: the UE-1 triggers the sidelink positioning
procedure to obtain measurements and calculates the Ranging/Sidelink
positioning result. Or
\- UE-1 assisted sidelink positioning: the UE-2(s) triggers the sidelink
positioning procedure to obtain measurements, calculates the Ranging/Sidelink
positioning result and returns it to the UE-1.
NOTE 1: The details of the sidelink positioning procedure is in RAN WG scope.
NOTE 2: Both the UE-1 and UE-2 can act as the reference UE. The capability
exchange and reference UE negotiation between the UE-1 and UE-2 is in RAN WG
scope. When the UE-1 obtains the Ranging/Sidelink positioning result, the
ranging layer of the UE-1 provides it to the application layer.
### 6.5.3 Ranging/ Sidelink Positioning Procedures
Figure 6.5.3.1-1: Ranging/Sidelink Positioning Procedure
1\. Application layer provides sidelink positioning parameters to ranging
layer, e.g. required location QoS, target UE\'s Application Layer ID may also
be included in the parameters.
2\. UE-1 broadcasts a Ranging/Sidelink positioning request. The message
includes UE-1\'s Application Layer ID, Target UE\'s Application ID and
required QoS.
3\. UE-2 returns the Ranging/Sidelink Positioning response to UE-1 if the
Application Layer ID for UE-2 matches.
4\. UE-1 initiates the Sidelink Positioning procedure. The details of the
procedure are in scope of RAN WGs.
NOTE 1: UE role (e.g. reference UE) configuration and authorisation is
realized by the solutions for KI#1.
NOTE 2: The details of step 4 are in RAN WGs. To better explain the solution,
here lists some examples may be included in step 4, e.g. capability exchange,
reference UE negotiation, Ranging/Sidelink positioning measurement and
calculation, Ranging/Sidelink positioning result transmission from UE-2 to
UE-1 if the UE-2 is responsible for calculation.
5\. The ranging layer in UE-1 provides the Ranging/Sidelink positioning result
to the application layer.
### 6.5.4 Impacts on services, entities, and interfaces
PC5 interface is enhanced to support ranging/sidelink positioning.
## 6.6 Solution #6: Network assisted Ranging and Sidelink Positioning
### 6.6.1 Description
This solution is related to the Key Issue #5 on Network assisted Sidelink
Positioning for In Network Coverage and Partial Network Coverage.
In this solution, the Located UE, who has capabilities that offers Sidelink
Positioning and/or Uu based positioning, may broadcast its Network assisted
Ranging and Sidelink Positioning service. A target UE who is not able to
perform Uu based positioning estimation may call this Network assisted Ranging
and Sidelink Positioning service to obtain its own Uu positioning estimation.
Network assisted Ranging and Sidelink Positioning may require that the network
has the capability of computing, providing the UE position or providing the
assistant data to the UE.
The Network assisted Ranging and Sidelink Positioning can be realized based on
the following potential mechanism:
\- Located UE requested procedure on behalf of the Target UE;
\- Target UE requested procedure.
For the Located UE requested procedure and Target UE requested procedure, the
Network assisted Ranging and Sidelink Positioning may require that the network
can compute and provide the UE position based on the Uu position of Located UE
and the ranging information over sidelink. The ranging information over
sidelink may be provided by the the Target UE or Located UE to the network.
### 6.6.2 Procedures of Located UE discovery
Figure 6.6.2-1: Located UE discovery and selection (Model A)
In this solution, a Located UE, who has capabilities that offers Sidelink
Positioning and/or Uu based positioning, may broadcast its Network assisted
Ranging and Sidelink Positioning service taking the discovery procedure as
basis in clause 6.3.2.2 of TS 23.304 [4]. A UE who is not able to perform Uu
based positioning estimation may call this Network assisted Ranging and
Sidelink Positioning service to obtain its own Uu positioning estimation.
1\. The Located UE broadcasts the discovery procedure including a NW assistant
ranging/sidelink positioning container. The NW assistant ranging/sidelink
positioning container can reflect that the Located UE can provide the Network
assisted Ranging and Sidelink Positioning service. The container may include
the Located UE ranging/sidelink capability, Uu positioning capability. The
Located UE may be aware of that its network supports the Network assisted
Ranging and Sidelink Positioning based on the network indication during the
registration procedure.
2\. Proximate Target UEs, who is not able to perform Uu based positioning
estimation, monitors above discovery message and perform the Located UE
selection based on above container (e.g. Located UE capability). After
selection, the Target UE invoke the Network assisted Ranging and Sidelink
Positioning service from the selected Located UE, as described in clause
6.6.3.
Alternatively, a Target UE may send sends a Solicitation message to discover
Located UE as Model B basis in clause 6.3.2.2 of TS 23.304 [4].
Figure 6.6.2-2: Located UE discovery and selection (Model B)
1\. The Target UE sends a Solicitation message for Located UE discovery, which
may include the requested Located UE info, e.g. ranging/sidelink capability,
Uu positioning capability.
2\. The Located UEs that match the parameters in the solicitation message,
responds to the Target UE with a Response message. The Response message
includes NW assistant ranging/sidelink positioning container.
3\. The Target UE selects Located UE(s) and performs Network assisted Ranging
and Sidelink Positioning procedure as described in clause 6.6.3.
For V2X case, a Target UE may send a Direct Communication Request message to
discover Located UE as Unicast mode V2X communication in clause 6.3.3 of TS
23.287 [3]. A located UE which provided Network assisted Sidelink Positioning
may follow the Unicast mode V2X communication to establish PC5 connection with
the Target UE. Then the Target UE selects Located UE(s) and performs Network
assisted Ranging and Sidelink Positioning procedure as described in clause
6.6.3.
### 6.6.3 Network assisted Ranging and Sidelink Positioning
#### 6.6.3.1 Located UE requested procedure on behalf of the Target UE
Figure 6.6.3.1-1: Located UE requested procedure with NW assistant
ranging/sidelink positioning
1\. After the Located UE selection, the Target UE calls the NW assistant
ranging/sidelink positioning service from the Located UE via the PC5 message.
2\. After receiving the above direct communication request, the Located UE may
perform the Ranging/Sildelink positioning procedure with Target UE.
3\. The Located UE takes the 5GC-MO-LR Procedure as basis to perform the
subsequent NW assistant ranging/sidelink positioning procedure. The Located UE
sends a UL NAS TRANSPORT message with including a MO-NW assistant
ranging/sidelink positioning request, the request may include the
Ranging/Sildelink positioning assistant data based on the step 2.
4\. AMF may perform the LMF selection with NW assistant ranging/sidelink
positioning condieration.
5\. AMF send a Nlmf_location_DetermineSidelinkLocation request to the selected
LMF, the request includes the Ranging/Sildelink positioning assistant data.
6\. The LMF initiates the Located UE positioning as described in TS 23.273
[11].
7\. The LMF determine the Target UE position based on Ranging/Sildelink
positioning assistant data and the Located UE position.
8\. The LMF responds to AMF with a Nlmf_location_DetermineSidelinkLocation
response including the Target UE position.
9\. AMF sends a DL NAS TRANSPORT message to the Located UE, which include a
MO-NW assistant ranging/sidelink positioning response with Target UE position.
Editor\'s note: It is FFS how the Target UE privacy is handled when the Target
UE location is disclosed to the Located UE.
10\. Located UE responds to Target UE with NW assistant ranging/sidelink
positioning response including Target UE position.
#### 6.6.3.2 Target UE requested procedure
Figure 6.6.3.2-1: Target UE requested procedure with NW assistant
ranging/sidelink positioning
1\. After a Located UE is selected , the Target UE performs the
Ranging/sidelink positioning with Located UE.
2\. Target UE initiates MO-LR procedure, and sends a UL NAS TRANSPORT message
with including a NW assisted ranging/sidelink MO-LR request, the request may
include the Ranging/Sildelink positioning assistant data based on the step1.
In addition, the Located UE ID (e.g. 5G GUTI) may be carried along withthe UL
NAS TRANSPORT message.
3\. AMF performs the LMF selection with NW assistant ranging/sidelink
positioning consideration. If the Located UE ID repents a different AMF, the
AMF forwards the NW assisted ranging/sidelink MO-LR request along with Located
UE ID to the AMF corresponding to the Located UE ID.
4\. AMF sends a Nlmf_location_DetermineSidelinkLocation request to the
selected LMF, the request includes the Ranging/Sildelink positioning assistant
data and the Located UE ID (e.g. GUTI).
5\. The LMF initiates the Located UE positioning as described in TS 23.273
[11].
6\. The LMF determine the Target UE position based on Ranging/Sildelink
positioning assistant data and the Located UE position.
7\. The LMF responds to AMF with a Nlmf_location_DetermineSidelinkLocation
response including the Target UE position. For different AMFs case, the AMF
further forwards the response to the AMF of Target UE.
8\. AMF sends a DL NAS TRANSPORT message to the Target UE, which include a NW
assisted ranging/sidelink MO-LR response with Target UE position.
NOTE: In this procedure, it assumes the Target UE is able to establish NAS
connection with AMF when the target UE is out-of-coverage, for example, via
ProSe L2 NW relay, ProSe L3 NW relay with N3IWF, Non-3gpp access connected to
5GC. If the Target UE is in coverage, the NW assisted ranging/sidelink MO-LR
procedure can be performed with Target UE directly.
### 6.6.4 Impacts on Existing Nodes and Functionality
The solution has impacts on the following entities:
AMF:
\- support the LMF selection with NW assistant ranging/sidelink positioning.
\- is able to support the NW assistant ranging/sidelink positioning request
from the Target UE and Located UE.
LMF:
\- Support the UE position determination based on the Uu position and sidelink
position.
UE(s):
\- Support the NW assistant ranging/sidelink positioning request.
## 6.7 Solution #7: Network based UE Sidelink Positioning
### 6.7.1 Introduction {#introduction-1}
This solution relates the KI#5 and proposes a solution where the network
perform the UE positioning estimation based on network assisted Sidelink
positioning.
### 6.7.2 Functional Description
This solution addresses KI#5 for MT-LR case, and the following principles are
used:
\- UE within the network coverage, either directly over Uu or via a L2 U2N
relay, is in a location where Uu based positioning is not possible
\- MT-LR procedure is triggered by the network as specified in TS 23.273 [11]
clause 6.1.
\- UE is requested to perform positioning measurements by the LMF
\- The UE check whether the UE can perform positioning measurements on other
RAN nodes or needs to use Sidelink positioning methods. The UE determines that
Uu based positioning is not possible and needs to perform Sidelink
positioning. The UE search for another UE that is able to estimate it\'s own
location based on Uu measurements and support Ranging service.
NOTE 1: The discovery of the Located UE depends on solution for KI#3
\"Ranging/Sidelink Positioning device discovery\"
\- The UE performs ranging estimate measurements of the Located UE and
provides either the ranging estimate or the ranging measurements data to the
LMF. The UE also include the UE ID of the Located UE.
NOTE 2: LPP (TS 37.355 [10]) may need to be enhanced to support new
measurement message to support Sidelink positioning.
\- When the network received the information from the UE, the network can use
a known location of the Located UE or trigger a new location estimate from the
Located UE. The LMF triggers any of the location procedures specified in TS
23.273 [11] clause 6.11 to estimate the Located UE\'s position.
\- Based on the position estimate of the Located UE, the LMF can estimate the
UE position, the UE being the UE that the first positioning request was sent
to.
NOTE 3: The RAN study on Sidelink Positioning will determine the accuracy of
Sidelink position e.g. whether multilateration positioning estimate(s) are
needed or not.
### 6.7.3 Procedures
#### 6.7.3.1 Network based UE Sidelink Positioning estimation (MT-LR).
Figure 6.7.3.1-1: Network based UE Sidelink Positioning estimation (MT-LR)
0\. The AMF is triggered to initiate location reporting procedure for UE1 as
specified in TS 23.273 [11]. UE1 may either be in network coverage and
communicates over Uu, or UE1 uses a Layer-2 UE-to-Network Relay to communicate
with the network. The Layer-2 UE-to-Network Relay can be the Located UE or a
different UE that can offer Layer-2 UE-to-Network service.
NOTE 1: UE1 and UE2 may be registered and served by different AMFs.
1\. The AMF sends the initial request to the LMF as specified in TS 23.273
[11], in which the AMF additionally indicate UE1's support of Network assisted
UE Sidelink Positioning.
2\. The LMF sends the DL Positioning message to the UE1 using the
Namf_Communication_N1N2messageTransfer as specified in clause 6.11.1 of TS
23.273 [11]. DL Positioning message may indicate whether Network assisted UE
Sidelink Positioning is supported/allowed. Details can be defined by RAN WG.
3\. The UE1 decides to perform discovery procedure to find a UE that supports
sidelink positioning and Uu based measurements (e.g. because it has determined
it is unable to perform legacy Uu positioning measurements and Network
assisted UE Sidelink Positioning is supported/allowed). The UE1 selects UE2.
NOTE 2: The UE logic to determine to use sidelink positioning is based on UE
implementation. E.g. the UE could determine that Uu positioning is not
possible for instance based on the number of cells that UE1 can detect being
limited.
NOTE 3: It is assumed that solutions for discovery addressing the KI#3 can
used. During the discovery procedure UE1 will get the UE_ID of UE2 which
supports positioning procedures defined in TS 23.273 [11]. The UE_ID is the ID
that UE2 used during the ProSe discovery procedure.
4\. The UE1 perform Ranging/Sidelink relative distance measurements to the
UE2.
NOTE 4: It is assumed that solutions addressing KI#4 can used.
5\. The UE1 send the UL Positioning message to the LMF. This message includes
both the Ranging/Sidelink positioning data and the UE_ID of UE2.
6\. The LMF resolves the received UE_ID of UE2 by querying the DDNMF and
triggers the location determination of UE2. The LMF may need to query the UDM
to find the AMF that is serving the UE2 to initiate the positioning
procedures.
NOTE 4: It is assumed that the LMF uses the service based interface N5g-ddnmf
for interaction with the DDNMF.
7\. The LMF triggers the serving AMF to initiate the positioning procedure.
The LMF receives from the AMF the LCS Correlation ID and cell-ID for UE2 and
performs one or more of the positioning procedures described in clauses
6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [11] to determine the location of UE2.
The LMF determines the location of UE1 based on the SL positioning data
received in step 5 and the location of UE2.
NOTE 5: UE1 mobility may impact the LMF location estimation of UE2. To reduce
the impact the LMF may try to time synchronize the UE1 location measurements
and the SL measurements or use time stamps and estimate the mobility based on
mobility trajectory. This is a generic topic for all solution that use non-
stationary devices that participates in the location estimation of another UE.
8\. The LMF provides the UE1 location to the AMF as a response to the request
in step 1.
### 6.7.4 Impacts on services, entities and interfaces
UE:
\- Support Ranging and Sidelink positioning.
LMF:
\- Support the Ranging and Sidelink positioning data and ability to calculate
the location of a UE based on this data set and the location of the Located UE
(UE2).
\- Resolve the UE_ID of the Located UE (UE2). The UE_ID being received in the
UL positioning message together with the SL position data.
## 6.8 Solution #8: Discovery of a Located UE for Enhancing Uu based
Positioning in Network Coverage
### 6.8.1 Introduction {#introduction-2}
This solution relates to discovery of a Located UE (UE2) with ranging/sidelink
positioning capability which can potentially be exploited as additional
reference nodes to enhance Uu based positioning of the first UE (UE1) under
insufficient network coverage.
The following assumptions can be made for UE1 and UE2:
UE1: A UE whose location is to be determined using Uu based positioning. The
positioning capability of UE1 on Uu is defined in TS 37.355 [10]. UE1 is
capable of ranging/sidelink positioning to another UE over PC5. UE1 is
considered to be in coverage.
UE2: A UE whose location is available to some degree of accuracy, which is to
be exploited for assisting positioning of the other UE, e.g. UE1. It is
assumed that UE2 supports location service over Uu and ranging-based
service/sidelink positioning over PC5. UE2 is considered to be in coverage.
In the terminology of ranging-based services and sidelink positioning, UE1 and
UE2 can be both a Target UE and a Reference UE.
### 6.8.2 Functional Description
In order to discover the direct links between UE1 and UE2 that may assist
positioning of UE1, the 5G ProSe Direct Discovery is to be triggered by
Location Management Function (LMF) based on LCS requirements. The LMF sends
the Application ID received from the AF to the UE to trigger the UE preforming
the 5G ProSe Direct Discovery. LMF may also determine the discovery model for
both UE1 and UE2.
When the location request is from the external AF, the GMLC will map the
external Application ID provided by the AF to a dedicated Application ID. The
external Application ID is an Application ID defined in the TS 23.303 [22] to
indicate which application want to know the UE location. The internal
Application ID has the same function as the Prose Application ID defined in
the TS 23.303 [22] to trigger the UE to preform Prose direct discovery. Maybe
there is only one internal Application ID because such ID is just used to
trigger the discovery and do not need to distinguish which application sends
the request.
Given a number of UEs like UE2 within the network coverage with known location
and ranging/sidelink positioning capability, a subset of them may be triggered
to initiate direct discovery over PC5. Then, they interact with 5GC to obtain
5G ProSe service authorization and the corresponding ProSe Direct Discovery
parameters.
The Discovery messages is to be used by UE2 to indicate its capability in
terms of assisting Uu based positioning as well as ranging/sidelink
positioning. The content of Discovery message is to be provided by LMF and may
consists of the following:
\- UE identity (UE2).
\- Capability information of UE2, including positioning capability over Uu and
ranging/sidelink positioning capability over PC5. The latter, for example, may
include capability of transmitting and/or processing sidelink positioning
signals.
\- Location information.
Correspondingly, LMF triggers UE1 with ranging/sidelink positioning capability
to monitor the Discovery message on PC5.
Alternatively, LMF may configure UE1 to transmit positioning assistance
requests. In this case, the Discovery message may consists of:
\- UE identity (UE1).
\- Requested positioning capability over Uu and ranging/sidelink positioning
capability over PC5. The latter, for example, may include capability of
transmitting and/or processing sidelink positioning signals.
\- Requested location information, e.g. accuracy.
Correspondingly, LMF triggers UE2 with ranging/sidelink positioning capability
to respond to the Discovery message with related information on PC5.
### 6.8.3 Procedures
This clause provides a signalling procedure for PC5 assisted Network based
positioning.
Figure 6.8.3-1: Procedure for network-based positioning assisted by
ranging/sidelink positioning
Signalling procedures for supporting Uu-based/network-based positioning with
ranging/sidelink positioning shown in Figure 6.8.3-1 can be described as the
following:
1\. The AF sends the location request for the target UE (UE1) directly to the
GMLC or via the NEF including the Application ID to indicate which application
wants to know the UE location. The LCS QoS may also be contained in the
request.
2\. If the request is from the external AF, the GMLC maps the external
Application ID to the internal Application ID.
3\. GMLC sends the location request to the LMF via AMF as described in TS
23.273 [11].
4\. Based on the request, the LMF may first trigger the Uu based positioning
for UE1. LCS procedures for positioning UE1 are carried out according to TS
23.273 [11].
5\. Based on the requested LCS QoS, LMF determines to trigger discovery of a
Located UE for positioning assistance.
6\. LMF obtains capability information in terms of LCS and ranging/sidelink
positioning and available location information of a number of UEs within a
region of interest, e.g. tracking area, geographical zone, and triggers
particular UEs, e.g. UE2, to discover UE1 reusing 5G ProSe Direct Discovery
procedure. LMF sends the Application ID to the UE2 to trigger the UE2
discovering UE1 reusing 5G ProSe Direct Discovery procedure. The Application
ID can be the internal Application ID provided by the GMLC in step 2. LMF
configures the information to be contained in the Discovery message, e.g. UE
identity, indication of capability information and/or location information.
NOTE 1: LMF is assumed to have obtained the capability/location information of
UE2 either by inquiring PRU info or by carrying out Uu based location
estimation before this procedure.
7\. LMF sends the Application ID to the UE1 to trigger UE1 discovering UE2 for
positioning assistance reusing 5G ProSe Direct Discovery procedure. The
Application ID can be the internal Application ID provided by the GMLC in step
2. LMF configures the information to be contained in the Discovery message.
LMF may configure UE1 to send a discovery report to LMF and specify
information to be included in the report, e.g. discovered UE identity(UE2).
8\. UE1 and UE2 perform 5G ProSe Direct Discovery procedure as defined in
clause 6.3.2 of TS 23.304 [4].
If Model A discovery is used,UE2 broadcasts a Discovery message containing UE
identity, indication of capability information and/or location information as
configured by LMF in step 3.UE1 monitors Discovery message.
If Model B discovery is used, UE1 transmits a Discovery message containing UE
identity, requested capability information and/or location information as
configured by LMF. UE2 that receives the request message may respond to UE1.
9\. Based on the result of direct discovery, UE1 provides a discovery report
to LMF as configured in step 4. The discovery report may contain the
discovered UE with required capability and/or location information for
positioning assistance in its proximity, e.g. UE2.
UE1 may send one or multiple discovery report messages, if it discovers more
than one UE2.
10\. Based on the discovery report, the LMF determines which UE as a Located
UE and in addition to the capability information and location information of
the two UEs, LMF determines whether and how ranging/sidelink positioning
between UE1 and UE2 should be carried out.
11\. LMF informs UE1 to perform ranging/sidelink positioning operation with
UE2.
12\. UE1 and UE2 carry out ranging/sidelink positioning operations over PC5.
NOTE 2: Step 9 is based on the Solution to KI#4: control of operations for
Ranging/Sidelink positioning.
13\. UE1/UE2 provides ranging/sidelink positioning measurements to LMF.
NOTE 3: Step 10 is for future study in FS_NR_pos_enh2 in RAN WGs (RP-213588).
14\. LMF determines and/or verifies the location estimate of UE1 based on the
positioning measurements obtained over both Uu and PC5.
15\. LMF sends the location response to the GMLC including the UE1 location
result via AMF.
16\. GMLC sends the location response to the AF including the UE1 location
result.
Editor\'s note: The current solution just support the UE1 and UE2 serving by
the same LMF and for the case where the UE1 and UE2 have different serving AMF
and LMF is FFS.
### 6.8.4 Impacts on services, entities, and interfaces
LMF:
\- Trigger UE discovery based on LCS QoS verification.
\- Configure content of the discovery message.
\- Determine whether and how a Located UE to be involved in ranging/sidelink
positioning for assisting Uu-based positioning.
\- Determine LCS target UE\'s location based on location information obtained
over Uu and PC5.
\- Send the Application ID to the UE.
UE:
\- Carry out positioning assisting UE discovery procedure based on LMF
configuration.
GMLC:
\- Map the external Application ID to the internal Application ID.
AF
\- Send the Application ID to the GMLC directly or via NEF.
## 6.9 Solution #9: Solution for KI#6 on Ranging/SL positioning service
exposure to UE
### 6.9.1 General
The solutions address the ranging and sidelink positioning service exposure to
UE for Key Issue #6.
The followings give two potential cases and the corresponding solutions:
Case 1: Two UEs, the UE involved in Ranging/SL positioning consumes the
Ranging/SL positioning service.
Case 2: Three UEs, the SL Positioning Client UE consumes the Ranging/SL
positioning service.
### 6.9.2 Functional descriptions
Ranging/SL positioning refers to the determination of the distance between two
UEs or more UEs and/or the direction and/or relative positioning of one UE
(i.e. Target UE) from another UE (i.e. Reference UE) via PC5 interface.
The consumer can be the UE involved in the Ranging/SL positioning service, or
a SL Positioning Client UE. The UE/SL Positioning Client UE may perform the
Ranging/SL positioning operation directly via PC5 interface and use the result
locally, without involvement of 5GC, or the SL Positioning Client UE (e.g. out
of SL coverage of either UE subject to Ranging/SL positioning) requests
Ranging/Sidelink positioning service with the involvement of 5GC (e.g. AMF,
LMF, etc.).
### 6.9.3 Procedures
#### 6.9.3.1 UE involved in SL ranging consumes the Ranging/SL positioning
service
Figure 6.9.3.1-1: UE involved in SL ranging consumes the Ranging/SL
positioning service
In this case, two UEs are involved in the Ranging/SL positioning operation.
The UE triggers ranging service, performs the Ranging/SL positioning
operation, and makes the calculation locally, i.e. Ranging/SL positioning
service is exposed to one of the two UEs.
Figure 6.9.3.1-2: Procedure of ranging UE consumes the Ranging/SL positioning
service
1\. The application layer of the UE1 triggers the request for Ranging/SL
positioning.
2\. The UE1 initiates the Ranging/SL positioning operation with the UE2. The
NG-RAN node is involved if UE is in network coverage and the scheduled
resource allocation is used.
NOTE 1: The role of Target UE and Reference UE is negotiated between UE1 and
UE2 over PC5 interface in this step which can refer to the Solutions of
KI#3&4.
NOTE 2: The security and privacy consideration for the Ranging/SL positioning
operation should be studied by SA WG3.
3\. The UE1 calculates the result and uses it locally.
#### 6.9.3.2 SL Positioning Client UE consumes the Ranging/SL positioning
service
##### 6.9.3.2.1 General
{width="4.097916666666666in" height="2.5541666666666667in"}
Figure 6.9.3.2.1-1: SL Positioning Client UE consumes the Ranging/SL
positioning service
In this case, three UEs are involved in the Ranging/SL positioning, in which a
SL Positioning Client UE asks for the Ranging/SL positioning for the other two
UEs (i.e. UE1 and UE2). The SL Positioning Client UE may request via Uu
interface to perform Ranging/SL positioning operation between UE1 and UE2 with
the involvement of 5GC. If the 3rd party UE is in the sidelink coverage with
one of the requested UEs (e.g. UE1), the SL Positioning Client UE may
alternatively request UE1 via PC5 interface to perform Ranging/SL positioning
with UE2.
When 5GC is involved, there are network based Ranging/Sidelink positioning in
which the Ranging/Sidelink positioning estimation result calculation is
performed at LMF and UE based Ranging/Sidelink positioning in which the
Ranging/Sidelink positioning estimation result calculation is performed at the
UE.
##### 6.9.3.2.2 Service exposure to the SL Positioning Client UE via PC5
{width="5.086805555555555in" height="3.217361111111111in"}
Figure 6.9.3.2.2-1: Service exposure to the SL Positioning Client UE via PC5
1\. The application layer of the SL Positioning Client UE triggers the request
for the Ranging/SL positioning, and the SL Positioning Client UE requests the
UE1 to perform the ranging/sidelink positioning operation with UE2.
2\. The UE1 initiates the Ranging/SL positioning operation with the UE2. The
NG-RAN node is involved if UE is in network coverage and the scheduled
resource allocation is used.
NOTE 1: The role of Target UE and Reference UE is negotiated between UE1 and
UE2 over PC5 interface in this step which can refer to the Solutions of
KI#3&4.
NOTE 2: The security and privacy consideration for the Ranging/SL positioning
operation should be studied by SA WG3.
3\. The UE1 makes the calculation locally.
4\. The UE2 returns the Ranging/SL positioning result to the SL Positioning
Client UE via the PC5 interface.
##### 6.9.3.2.3 Service exposure to the SL Positioning Client UE via 5GC/Uu
(network based)
Figure 6.9.3.2.3-1: Service exposure to the SL Positioning Client UE via
5GC/Uu (network based)
1\. The application layer of the SL Positioning Client UE triggers the
Ranging/SL positioning, and then requests the network to perform the
Ranging/SL positioning between the UE1 and UE2. If the SL Positioning Client
UE in CM-IDLE state, it firstly triggers the service request procedure.
2\. The SL Positioning Client UE requests the network to perform the
Ranging/SL positioning operation between the UE1 and UE2. The Ranging/SL
positioning requirement may include the requirement regarding Ranging/SL
positioning demand (i.e. the distance and/or the direction between two UEs or
more UEs), delay, accuracy, result feedback mode (e.g. immediately,
periodically or at a later time). The SL Positioning Client UE includes the
Ranging/SL positioning requirement in the MO-LR Request toward the AMF3, then
the AMF3 gets the Ranging/SL positioning requirement and send it to the GMLC.
The SL Positioning Client UE may suggest the initiator UE (i.e. which is used
to perform signalling exchange with the LMF) based on implementation and
indicate which UE is the initiator UE to the AMF.
3\. The AMF may select a GMLC based on NRF query or configuration in AMF, and
then acts as an LCS client to request the GMLC for Ranging/SL positioning
result, the AMF further includes the SL Positioning Client UE ID in the
request.
4\. The GMLC determines the initiator UE (e.g. UE2) from UE1 and UE2 and sends
the Namf_Location_ProvidePositioningInfo request to the UE2's AMF2. GMLC can
performs the authorization on the Ranging/SL positioning operation request
from SL Positioning Client UE.
NOTE: The security and privacy consideration for the Ranging/SL positioning
operation should be studied by SA WG3.
5\. The AMF2 selects the LMF (e.g. LMF2) and sends the
Nlmf_Location_DetermineLocation request (UE1 ID, UE2 ID) to the LMF2 for the
Ranging/SL positioning result between the UE1 and UE2.
6\. The LMF2 triggers the UE2 to perform Ranging/SL positioning with the UE1
via AMF2. The measurement request message may include the Ranging/SL
positioning demand, UE1 ID, UE2 ID, etc. The UE2 performs the Ranging/SL
positioning operation with the UE1, and reports the Ranging/SL positioning
measurements to the LMF for calculation.
7\. The LMF2 makes calculation based on the Ranging/SL positioning
measurements and returns the Ranging/SL positioning result to the AMF2.
8\. The AMF2 returns the Ranging/SL positioning result to the GMLC.
9\. Then the GMLC returns the result to the AMF3.10. The AMF3 returns the
result to the SL Positioning Client UE.
### 6.9.4 Impacts on services, entities, and interfaces
**UE:**
\- sends Ranging/SL positioning requirement to another UE for Ranging/SL
positioning measurement or to the LMF for Ranging/SL positioning result.
\- indicate which UE is the initiator UE to the LMF.
\- receives Ranging/SL positioning measurement from another UE or Ranging/SL
positioning result from the LMF (via the AMF).
\- receives Ranging/SL positioning measurement request from the LMF, performs
Ranging/SL positioning measurement, and reports the Ranging/SL positioning
measurement to the LMF.
**NG-RAN:**
\- allocates PC5 radio resource to UE for Ranging/SL positioning operation.
**AMF:**
\- acts as the consumer of GMLC service.
\- selects LMF and routes the Ranging/SL positioning requirement to the LMF.
\- routes the signalling (e.g. LPP messages for SL ranging) between the UE and
the LMF.
\- Support check the SL Positioning Client UE is authorized to request the
Ranging/SL positioning information between the UE1 and UE2.
**LMF:**
\- requests and controls the UE to perform Ranging/SL positioning measurement.
\- receives the Ranging/SL positioning measurement from the UE and makes
calculation.
\- returns the Ranging/SL positioning result to the AMF.
## 6.10 Solution #10: Ranging service exposure to UE
### 6.10.1 Description
This solution is related to the Key Issue #2: Ranging service operation
procedure with the assistance of another UE and the Key Issue #6 on Ranging
and sidelink positioning service exposure to a UE.
In this solution, a SL Positioning Client UE consumes the Ranging/Sidelink
positioning service from an Reference UE. The Reference UE uses the direct
discovery procedure as specified in clause 6.3.2.1 of TS 23.304 [4] to expose
its Ranging/Sidelink positioning service for the SL Positioning Client UE. The
SL Positioning Client UE is not required to be Ranging/Sidelink positioning
capable. As described in the following Figure 6.10.1.1-1, the SL Positioning
Client UE performs the Ranging/Sidelink positioning service provider (e.g. a
Reference UE) discovery and selection based on the Ranging information in the
discovery message. The Ranging information may include the role indication
(i.e. \" Ranging/Sidelink positioning service provider \"), Ranging/Sidelink
positioning service provider\'s ranging capability, the level of ranging
accuracy, ranging method and info of the list of UE that the Ranging/Sidelink
positioning service provider can range with. After that, the SL Positioning
Client UE invokes the Ranging/Sidelink positioning service provided by the
selected Ranging/Sidelink positioning service provider, and request Ranging
result between UE1 and UE2. The Ranging/Sidelink positioning service provider
performs the Ranging procedure with UE1 and with UE2 respectively based on the
solutions of KI#4, and calculates the ranging result between UE1 and UE2 based
on the ranging result between UE1 and itself and the ranging result between
UE2 and itself. This ranging service exposure can be simplified for the
following figure if SL Positioning Client UE can reach UE#1 or UE#2 directly
and trigger any one of them to performing ranging with each other. Thus in
this case the reference UE in the figure below can be UE#1 or UE#2 and then
there are only 3 roles.
Figure 6.10.1.1-1: High-level procedure for ranging service exposure via
Reference UE
Furthermore, in this solution, the SL Positioning Client UE can be replaced by
UE1 or UE2. For this case, the Ranging/Sidelink positioning service provider
mentioned on above is considered as the Assistant UE and the procedures of the
Ranging service exposure can be reflected by the following figure 6.10.1.1-2.
Figure 6.10.1.1-2: High-level procedure for ranging service exposure via
Assistant UE
### 6.10.2 Procedures of Ranging service exposure
#### 6.10.2.1 Procedures of Ranging service exposure
Figure 6.10.2.1-1a: High-level procedure of Ranging/Sidelink Positioning
exposure with Model A discovery
1\. The Ranging/Sidelink positioning service providers (e.g. Reference UE#1
and UE#2) performs the model A discovery as specified in clause 6.3.2.1 of TS
23.304 [4], the announcement message may include the Reference UE info, role
indication (i.e. \"Ranging/Sidelink positioning service provider\"), ranging
service code and Ranging exposure info. Ranging exposure info may include the
list of UEs info that the Reference UE can perform the Ranging and Sidelink
positioning with, and the level of the ranging accuracy.
2\. If a SL Positioning Client UE has the requirement to invoke the ranging
service to obtain the ranging result between UE#1 and UE#2, based on the
Ranging exposure info, the SL Positioning Client UE performs the
Ranging/Sidelink positioning service providers\' discovery and selection. For
the selected Reference UE, the SL Positioning Client UE may perform the direct
link establishment procedure with Assistant UE.
3\. To invoke the selected Reference UE\'s ranging service, the SL Positioning
Client UE sends a ranging service request to Assistant UE via the PC5 message
to request the requesting Ranging estimation/result between UE1 and UE2. In
addition, the PC5 message may include the SL Positioning Client UE info.
4\. After receiving the Ranging service request from the SL Positioning Client
UE, the Reference UE may perform the authentication procedure to determine
whether the SL Positioning Client UE is authorised to invoke this Ranging
service (e.g. to obtain the ranging result between UE1 and UE2).
Editor\'s note: It is FFS on authentication procedure.
5\. If the SL Positioning Client UE is authorised, the Assistant UE performs
the ranging and positioning procedure with the UE#1 and UE#2 based on the
solutions of KI#4.
6\. The Reference UE obtains the ranging measurement of UE#1 and UE#2 and
calculates the Ranging result between UE#1 and UE#2.
7\. After that, the Reference UE responses to the SL Positioning Client UE
with the Ranging service response. The ranging service response includes the
ranging result between UE#1 and UE#2.
The above procedure of Ranging/Sidelink Positioning exposure also is applied
to model B discovery for SL Positioning Client UE as described in the
following figure 6.10.2.1-1b. During the reference UE discovery and selection
(as described in the following step1\~3), the SL Positioning Client UE sends
the solicitation message to initiate the Reference UE to discover the Target
UEs using the solution of KI#3. Only the Reference UE who successfully
discover the Target UE will response the SL Positioning Client UE. After that,
the SL Positioning Client UE selects one or more Reference UE to consume the
Ranging service as described in the following step5\~9 which are same as
step3\~7 in the Figure 6.10.2.1-1a.
Figure 6.10.2.1-1b: High-level procedure of Ranging/Sidelink Positioning
exposure with Model B discovery
NOTE: For the above procedure, the SL Positioning Client UE can bereplaced by
UE1 or UE2. In this case, the Ranging/Sidelink positioning service provider
(e.g. above Reference UE#1 and Reference UE#2) mentioned above is considered
as the Assistant UE.
#### 6.10.2.2 Deferred procedures of Ranging service exposure to the SL
Positioning Client UE
Figure 6.10.2.2-1: Deferred procedures of Ranging service exposure to the SL
Positioning Client UE
1\~7. The step1\~5 are similar to the step1\~5 of the clause 6.10.2.1.
Difference is that the Ranging service request from the SL Positioning Client
UE may include the deferred event. The event may be as follows:
\- Periodic ranging: An event where a defined periodic timer expires, then
activates a ranging procedure and ranging result report.
Editor\'s note: What are the other events that may trigger Ranging/Sidelink
positioning service is FFS.
8\. After the step 6, the Reference UE detects the event.
9\. When the event is detected, the Reference UE performs the Ranging/Sidelink
positioning procedure with UE1/UE1 based on the solution of KI#4.
10\. Reference UE re-calculate the ranging result and reports the ranging
result between UE1 and UE2 included in the ranging service response to the SL
Positioning Client UE via the PC5 message.
### 6.10.3 Impacts on Existing Nodes and Functionality
The solution has impacts on the following entities:
UE(s):
\- Support ranging service exposure.
\- support of invoking the ranging service.
\- support Ranging/Sidelink positioning over the PC5.
## 6.11 Solution #11: UE using exposure API
### 6.11.1 General
This solution relates the KI#6 and proposes a solution where a UE can use
exposure API over user plane to access the Ranging and sidelink positioning
service exposure.
### 6.11.2 Functional Description
This solution addresses KI#6 and the following principles are used:
\- UE register and include in the registration request that it would like to
use the service API for Ranging and Sidelink positioning.
\- The AMF validate with the UDM that the UE is authorized to use the service
API
\- The AMF provides to the UE the \"Onboarding Enrolment Information\" in the
Registration Accept message
\- When the UE decides to use the service API it follows the procedures
specified in TS 23.222 [12].
\- The UE start by performing the Onboarding of an API Invoker procedure in
clause 8.1 ofTS.23.222 [12] and uses the received \"Onboarding Enrolment
Information\" in the security procedures as specified in clause 6.1 of TS
33.122 [13].
\- Once Onboarded the UE performs the procedure for \"API invoker obtaining
authorization to access service API\". The Service API here is the Ranging and
SL positioning service exposure API, which is assumed to be specified for Key
Issue #7.
\- The UE can now use the Service API as specified for Ranging and SL
positioning service exposure.
NOTE: Key Issue 7 address the Service API to be used by Application Functions
and this solution reuses this Service API and it therefore not further
detailed.
### 6.11.3 Procedures
#### 6.11.3.1 UE access to Ranging and sidelink positioning service exposure.
Figure 6.11.3.1-1: UE access to Ranging and sidelink positioning service
exposure
1\. The UE send a Registration Request that includes an indication that the UE
would like access to the Ranging and sidelink positioning service exposure
provided via the NEF. This indication could be included within the UE and
Network capability exchange or explicitly signalled.
2\. The AMF obtains the Ranging and sidelink positioning subscription data by
invoking the Nudm_SDM_Get.
NOTE 1: It is assumed that the authorization information to use the Ranging
and sidelink positioning service is stored in the UE\'s subscription data.
3\. The UDM provides the Ranging and sidelink positioning subscription data to
the AMF. The AMF verifies that the UE is authorized to use the service API.
The Ranging and sidelink positioning subscription data also include the
information that the UE needs for the initial Onboarding process as described
in TS 23.222 [12] and TS 33.122 [13].
NOTE 2: More NF e.g. UDR, AUSF may be involved in this step. SA3 will need to
specify how and where the information for onboarding is generate and stored.
In TS 33.122 [13] the information for onboarding is called Onboarding
Enrolment Information.
4\. The AMF includes the information for onboarding in the Registration Accept
message to the UE.
5\. The UE initiates the Onboarding procedure as specified in TS 23.222 [12]
clause 8.1 over an PDU session that provide access to data network that is
connected to the NEF.
6\. The UE sends an obtain service API authorization request to the NEF and
based on the UE\'s subscription information the authorization information to
access the service APIs is sent to the UE in the response. See clause 8.11 of
TS 23.222 [12].
7\. The UE uses the Ranging and sidelink positioning service exposure API to
gain access to Ranging and Sidelink information related to other UEs.
NOTE 3: The UE solution reuses this Service API proposed in solutions for Key
Issue 7 address used by Application Functions.
### 6.11.4 Impacts on services, entities and interfaces
UE:
\- Support Ranging and Sidelink capability exchange.
\- Support receiving the Onboarding enrolment information, to be used in the
initial access to the NEF.
AMF:
\- Support the Ranging and Sidelink capability exchange and to retrieve the
Onboarding enrolment information from the NF that holds this information e.g.
the UDM. Provide the Onboarding enrolment information to the UE in the
Registration Accept message.
UDM:
\- Store the Onboarding enrolment information and provide it to the AMF when
requested.
## 6.12 Solution #12: LCS-based Ranging Service Exposure
### 6.12.1 General
This solution addresses KI#7 as described in clause 5.7 and KI#5 in clause 5.5
by proposing a ranging service exposure solution in the 5GS towards the AF
that leverages the existing ProSe-based UE-to-Network Relaying mechanism and
the LCS architecture. Therefore, the procedure can be used both to determine
relative positioning between UEs and absolute locations of UEs via ranging and
sidelink positioning operations.
### 6.12.2 Functional descriptions
At a high level, the functional description of this solution can be summarized
as follows:
\- A ranging exposure service is proposed enabling a ranging application
server hosted at an AF to send a request to the 5GS to trigger a
ranging/sidelink positioning operation between two UEs, one of which acts as
reference UE the other ones as target UEs. The request may also indicate if
the absolute location of the target UE(s) is desired.
\- The proposed solution leverages the LCS architecture for localization, i.e.
GMLC and LMF are both involved in the 5GS procedure triggering the
ranging/sidelink positioning given the close relation of ranging and sidelink
positioning for a UE with the determination of the UE location. One UE (i.e. a
located UE acting also as reference UE) acts as a ProSe UE-to-Network Relay
for location reporting.
\- LMF is the entity in charge of performing the interactions with the ProSe
Application Server and the PCF.
\- The located UE acting also as reference UE is configured or provisioned
with special Relay Service Codes (RSCs) authorized for reporting of target UE
location when acting as a relay.
\- The positioning of the set of UEs not configured as relays (i.e. target
UEs) can be performed by the reference UE via sidelink positioning in RAN.
This set of UEs are authorized to act as relayed UE for location reporting.
\- The service operation may include a number of ranging/sidelink positioning
events related to both distance and direction measurements.
NOTE: An assumption for this solution is that target UEs cannot be located via
Uu positioning when an absolute location is requested. In that case, sidelink
positioning is applied.
### 6.12.3 Procedures
Figure 6.12.3-1: Procedure for LCS-based ranging service exposure
Figure 6.12.3-1 shows a procedure with the proposed service exposure framework
towards the application server. The description of the procedure is as
follows:
0\. The ProSe capabilities of the UEs are registered with the AMF beforehand.
This may include the support for location reporting in addition to other ProSe
capabilities. Also the Location Privacy Indication (LPI) defined in TR 38.845
[6] for ProSe based localization can be given by the UE\'s at this stage,
again to the AMF.
1\. Ranging/sidelink positioning service request (via NEF): the ranging
application server may contact GMLC directly or via NEF to provide a ranging
or sidelink positioning operation request to the 5GS. The request may be for
one or multiple target UEs, and may indicate if the server requires relative
positioning of target UEs, absolute positioning of target UEs, or both.
The service operations involved in the ranging/sidelink positioning request
may reuse and extend the existing NEF/GMLC services (e.g.
Nnef_EventExposure_Subscribe, Ngmlc_Location_ProvideLocation) and/or new
service operations may be defined if needed. The service operations may
include the target and reference UEs, the required Ranging/Sidelink
positioning QoS, and a number of events addressing distance and/or direction
measurements between the reference and target UEs. The service operations may
also indicate threshold(s) for distance and/or direction events. In addition,
the service operations may include other event configuration parameter(s) that
may be mandatory or optional (e.g. time to trigger, direction orientation,
threshold matching direction, measurement frequency, preferred accuracy,
privacy preservation).
2\. Setup of location information as per 5GC-MT-LR procedure in TS 23.273
[11], corresponding to steps 2-11 in Figure 6.1.2-1 contained in clause 6.1.2,
potentially including new optional inputs as part of the existing service
operations accounting for the ranging related events.
The following enhancements of the 5GC-MT-LR procedure in TS 23.273 [11] are
required to support ranging/sidelink positioning:
\- Step 5: an AMF service is consumed by GMLC to request ranging/sidelink
positioning. The service operation can be Namf_Location_ProvidePositioningInfo
with the same enhancements described above for Ngmlc_Location_ProvideLocation
or a new service operation could be defined if needed.
\- Step 10: an LMF must be selected that supports ranging/sidelink
positioning.
\- Step 11: either the Nlmf_Location service operations should be extended to
support ranging/sidelink positioning with the enhancements described for
Ngmlc_Location_ProvideLocation service operation or a new service operation
should be defined for that purpose.
3\. If not done yet, the LMF checks the ProSe capabilities registered for the
UEs in step 0 with the AMF.
4\. For the UEs supporting ProSe capabilities including also location
reporting, the LMF interacts with the ProSe application server (or PCF) to
initiate Relay operation for location reporting.
5\. [OPTIONAL] If not done previously, the ProSe AS may authorize and/or
configure UE1 as the reference UE through which the other UEs (similar to
ProSe Remote UEs) can relay location information to LMF.
The reference UE (acting similar to a ProSe UE-to-Network Relay as specified
in TS 23.304 [4]) may be configured or provisioned with special Relay Service
Codes (RSCs) authorized for location reporting. This is provided by the PCF,
already provisioned in the ME or configured in the UICC.
UE1 in Figure 6.12.3-1 is configured as ProSe L2 NW relay
Editor\'s note: Whether UE1 in Figure 6.12.3-1 can be configured as ProSe L3
NW relay is FFS.
6\. If not done previously, the ProSe application server authorizes the target
UEs. It also configures or provisions target UEs with special RSCs authorized
for location reporting. This is provided by the PCF, already provisioned in
the ME or configured in the UICC.
7-8. The ProSe Relay Discovery on the UEs identified in Steps 3-5 is conducted
with special RSCs based on either model A or Model B as specified in cl.
6.3.2.3 of TS 23.304 [4]. The discovery between the ProSe UE-to-Network Relay
and target UEs is triggered based on UE pre-configuration. Once discovered,
the connections between the reference UE and the other UEs are established
over PC5. It is not necessary to establish any UP PDU session for such special
RSCs between the reference UE (or other UEs) and network as such RSCs may not
be associated with any specific PDU session parameters.
9\. The ProSe application server (or PCF) responds or notifies the LMF when
the relay configuration is complete.
10\. The LMF sends a ranging/sidelink positioning request to UE1. The request
may contain multiple target UEs.
NOTE 1: UE1 is assumed to be the located UE acting as reference UE, in
coverage for this solution. UE1 is also acting as ProSe UE-to-Network Relay.
11 UE1 initiates side-link based positioning over PC5 for the multiple target
UEs (as instructed by the LMF in step 11). This may include obtaining position
estimates from a multiple UEs, which e.g. would carry out UE based
positioning, obtain positioning assistance data from these UEs or execute a
sidelink based positioning method (and gaining relative or absolute position
information of the set of UEs). Whichever method is used, the reference UE
will collect this data through the side-link in this step.
12\. UE1 sends the ranging/sidelink positioning measurements and/or results to
the LMF. The location information from multiple UEs can be concatenated into a
fewer positing protocol messages at the reference UE, in order to save
signalling overhead. If requested by the server, the LMF may combine the
location information of UE1 with the ranging/sidelink positioning information
related to the target UEs to derive absolute location information for the
target UEs.
13\. The LMF forwards the ranging/sidelink positioning and location results to
the AMF.
14\. The AMF forwards the ranging/sidelink positioning and location results to
the GMLC.
15\. The GMLC exposes the ranging/sidelink positioning and location results to
the ranging application server via NEF with the response operation of the
service employed in step 1.
### 6.12.4 Impacts on services, entities, and interfaces
**GMLC**
\- Support for ranging/SL positioning request for one or multiple UEs with
corresponding events
**LMF**
\- Support for ranging/SL positioning request for one or multiple UEs with
corresponding events
\- LMF selection considering support for ranging/SL positioning
\- LMF obtaining the UE\'s ProSe capability from AMF- To support interactions
with the ProSe Application Server and PCF.
**AMF**
\- To register the support for location reporting as part of ProSe
capabilities from the UE.
**UE**
\- Support to send/receive ranging/SL positioning request to/from LMF
\- Support to request ranging/SL positioning service from 5GS
\- As a reference UE (similar to a ProSe UE-to-Network Relay) to be able to
interpret RSCs for location reporting.
\- As a reference UE to be able to concatenate location information of other
UEs as LPP messages towards 5GC.
\- As a target UE (similar to ProSe Remote UE) to be able to interpret RSCs
for location reporting.
## 6.13 Solution #13: Ranging/SL positioning service initiated by application
server or 5GC NF
### 6.13.1 General
This solution is to address KI#7.
A Ranging/SL positioning service request may be initiated by an application
server for e.g. a commercial service or by a 5GC NF for e.g. network assisted
sidelink positioning.
The service request is transmitted to one of the UEs, and the UE then
initiates the Ranging/SL positioning procedure.
Once the result is calculated, the UE who receives the service request reports
the result to the application server or 5GC NF who initiates the service
request.
### 6.13.2 Functional descriptions
The service request and the result reporting can be transmitted over the
control plane. The 5GC NF who initiates or transmits the service request needs
to check with UDM to acquire the serving AMF of one of the UEs subject to
Ranging/SL positioning. The service request is then sent to the serving AMF of
one of the UEs, and the AMF forwards the service request to the UE over NAS
message.
When UE receives the service request either from application server or from
AMF, it initiates the Ranging/SL positioning procedure to the other UE for the
measurement and calculation of the result.
NOTE: Ranging/SL positioning procedure includes Ranging/Sidelink positioning
discovery and service operations, which will be addressed in the solutions
under KI#3 and KI#4.
The Ranging/SL positioning service request includes the following parameters:
\- Reference UE ID
\- Target UE ID
\- Result content: distance, angle or both
\- Required QoS
Editor\'s note: Whether there are any other parameters in the Ranging/SL
positioning service request is FFS.
### 6.13.3 Procedures
#### 6.13.3.1 Service initiated by application server
6.13.3.1-1: Service initiated by application server
1\. Service authorization policy/parameters are provisioned to UE1 and UE2.
2\. AF sends the Ranging/SL positioning service request to NEF, including UE1
ID, UE2 ID, Result content (distance, angle or both) and Required QoS, etc.
3\. NEF checks UDM to discover the serving AMF of UE1, and then forwards the
request to the AMF.
NOTE 1: NEF also checks the privacy on whether the AF is authorized to acquire
Ranging/SL positioning information of UE1 and UE2. The solution will be
developed by SA WG3.
NOTE 2: UE1 can be either the target UE or the reference UE, which can be
requested by the AF or can be decided during step 5.
Editor\'s note: How the reference UE and target UE are decided is FFS.
4\. AMF forwards the service request to the UE1 over NAS.
5\. UE1 initiates Ranging/SL positioning procedure to UE2 to trigger the
measurement and the calculation of the result. The Ranging/SL positioning
procedure includes Ranging/Sidelink positioning discovery and service
operations.
NOTE 3: Solutions for Ranging/Sidelink positioning discovery and service
operations will be developed under KI#3&4\. Whether DDNMF will be involved
depends on the solution.
6\. UE1 sends the Ranging/SL positioning result to the AMF.
7\. AMF forwards the Ranging/SL positioning result to the NEF.
8\. NEF forwards the Ranging/SL positioning result to the AF.
Editor\'s note: It is FFS whether LMF or GMLC needs to be involved.
Editor\'s note: It is FFS NEF/AMF performs any
checking/authorization/processing.
#### 6.13.3.2 Service initiated by 5GC NF
6.13.3.2-1: Service initiated by 5GC NF
1\. Service authorization policy/parameters are provisioned to UE1 and UE2.
2\. 5GC NF checks UDM to discover the serving AMF of UE1, and then sends the
request to the AMF, including UE1 ID, UE2 ID, Result content (distance, angle
or both) and Required QoS, etc.
NOTE 1: 5GC NF also checks the privacy on whether the AF is authorized to
acquire Ranging/SL positioning information of UE1 and UE2. The solution will
be developed by SA3.
NOTE 2: UE1 can be either the target UE or the reference UE, which can be
requested by the AF or can be decided during step 4.
Editor\'s note: How the reference UE and target UE are decided is FFS.
3\. AMF forwards the service request to the UE1 over NAS.
4\. UE1 initiates Ranging/SL positioning procedure to UE2 to trigger the
measurement and the calculation of the result. The Ranging/SL positioning
procedure includes Ranging/Sidelink positioning discovery and service
operations.
NOTE 3: Solutions for Ranging/Sidelink positioning discovery and service
operations will be developed under KI#3&4\. Whether DDNMF will be involved
depends on the solution.
5\. UE1 sends the Ranging/SL positioning result to the AMF.
6\. AMF forwards the Ranging/SL positioning result to the 5GC NF.
Editor\'s note: It is FFS whether LMF or GMLC needs to be involved.
Editor\'s note: It is FFS NEF/AMF performs any
checking/authorization/processing.
### 6.13.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: supports initiating Ranging/SL Positioning procedure; receives
Ranging/SL Positioning service request from AMF; sends Ranging/SL Positioning
result to the AMF
\- AMF: receives and forwards the Ranging/SL Positioning service request to
the UE1; receives and forwards the Ranging/SL Positioning result to the 5GC
NF/NEF
\- NAS: supports transmission of Ranging/SL Positioning service request and
Ranging/SL Positioning result
## 6.14 Solution #14: General reference architecture for Sidelink positioning
and ranging-based services
### 6.14.1 General
Figure 6.14.1-1 shows a reference architecture for Sidelink Positioning and
Ranging-based services for non-roaming operation. In this case, the UE A and
UE B that are involved in Sidelink Positioning and Ranging-based services have
subscription from the same PLMN. The reference architecture also supports the
case that UE-A or UE-B or both are not registered to the network or not in
coverage. UE C and UE D may be out of coverage, or with partial network
coverage.
Editor\'s note: Further impacts to the LCS NF are FFS.
Figure 6.14.1-1 Reference architecture for Sidelink Positioning and Ranging-
based services for non-roaming and same PLMN operation
Figure 6.14.1-2 shows a reference architecture for Sidelink Positioning and
Ranging-based services for Inter-PLMN non-roaming operation. In this case, the
UE A and UE B have subscriptions from different PLMNs, i.e. PLMN-A and PLMN-B
respectively. UE C and UE D may be out of coverage, or with partial network
coverage.
Figure 6.14.1-2 Reference architecture for Sidelink Positioning and Ranging-
based services for inter-PLMN operations
Figure 6.14.1-3 presented a reference architecture for Sidelink Positioning
and Ranging-based services for Inter-PLMN non-roaming operation. In this case,
the UE A and UE B have subscriptions from different PLMNs, i.e. PLMN-A and
PLMN-B respectively. In addition, UE A is roaming and registered to PLMN-C. UE
C and UE D may be out of coverage, or with partial network coverage.
Figure 6.14.1-3 Reference architecture for Sidelink Positioning and Ranging-
based services for inter-PLMN operation with roaming
### 6.14.2 Functional descriptions
Sidelink Positioning and Ranging-based services are supported based on the
architectures in clause 6.14.1, with the following reference points:
**SR1** : The reference point between the UE Sidelink (SL) Positioning and
Ranging application in the UE and the SL Positioning/Ranging Server. This
reference point is out of scope of this specification. It may be used for the
configuration and application layer signalling.
**SR5** : The reference point between the Sidelink (SL) Positioning and
Ranging application in UEs. It is carried over the PC5 reference point. The
operation over this interface is used to control the Sidelink Positioning and
Ranging operation over the PC5 reference point between the UEs.
Editor\'s note: Whether SR5 also covers discovery operations for Sidelink
Positioning and Ranging needs to be clarified.
**PC5** : The reference point between the UEs, and it includes the LTE based
PC5 and/or NR based PC5. It also supports the Sidelink Positioning and Ranging
operation defined by RAN WGs.
Editor\'s note: Reference to RAN WG specifications, e.g. TS 38.300 [8], to be
added when it is available.
**N1** : In addition to the relevant function defined in TS 23.501 [14], if
the UE is in coverage, it may be also used to convey the SL Positioning and
Ranging policy (SLPRP) (including service authorization) from AMF to the UE,
and to convey the UE\'s capability from the UE to the AMF. if the LMF supports
Sidelink Positioning and Ranging-base services, it may be also used to carry
the signalling between UE and LMF, as defined in TS 23.273 [11].
**N2** : In addition to the relevant functions defined in TS 23.501 [14] for
N2, in the case of SL Positioning and Ranging-based service is supported by
NG-RAN, it is also used to convey the SLPRP policy and parameters (including
service authorization) from AMF to NG-RAN.
**Uu** : The reference point between the UE and the NG-RAN.
Following service-based interfaces are used to support Sidelink Positioning
and Ranging-based services:
**Nlmf** : In addition to the relevant services defined in TS 23.273 [11], if
the LMF supports SL Positioning and Ranging-based service, it may be used to
provide service to other NFs related to it.
**Nudm** : In addition to the relevant services defined in TS 23.501 [14] for
Nudm, in the case of SL Positioning and Ranging-based service, services
provided by UDM are used to get the related subscription information to AMF
during Initial registration procedure or UE Configuration Update (UCU)
procedure to inform AMF subscription information has changed.
**Npcf** : In addition to the relevant services defined in TS 23.501 [14] for
Npcf, in the case of SL Positioning and Ranging-based service, services
provided by H-PCF are used to provide V2X Service related parameters to V-PCF
for UE and NG-RAN in the roaming case.
**Nudr** : In addition to the relevant services defined in TS 23.501 [14] for
Nudr, in the case of SL Positioning and Ranging-based service, services
provided by UDR are used to notify the PCF and the UDM of the update of the SL
Positioning and Ranging-based service related information.
**Namf:** In addition to the relevant services defined in TS 23.501 [14] for
Namf, in the case of SL Positioning and Ranging-based service, services
provided by AMF are consumed by PCF to provide the SL Positioning and Ranging-
based service related parameters for the UE and the NG-RAN to AMF, and to
enable the AMF create or update UE context related to SL Positioning and
Ranging-based service.
NOTE: N5g-ddnmf services may be used when UE supports 5G ProSe Restricted
discovery.
Editor\'s note: Other options for maintaining the mapping between UE SUPI and
UE Application Layer User ID is FS.
### 6.14.3 Procedures
UE A, UE B, UE C, and UE D may be pre-configured (in UICC or ME) or
provisioned by PCF with the SL Positioning and Ranging-based service Policies
(SLPRP). The UEs may also be configured by SL Positioning Ranging Server
regarding the corresponding operation parameters and configurations via SR1.
UE A, UE B, UE C, and UE D carry out the discovery and control signalling for
Sidelink Positioning and Ranging-based services over reference point SR5,
which is carried over PC5 reference point for direct communications between
the UEs. There may be more than two UEs involved in the Ranging-based service
and Sidelink Positioning session, depending on the signalling control carried
out over SR5.
When UE A or UE B are served by NG-RAN for Ranging-based services and Sidelink
Positioning, the UE A and UE B may communicate with LMF, re-using enhanced
procedures defined TS 23.273 [11]. The UE A (or UE B) and the LMF use a
Sidelink Positioning Protocol to perform the operation.
UE C and UE D can operate out of coverage, or with partial network coverage.
Sidelink Positioning and Ranging services can be performed without the network
involvement.
UE A, UE B, UE C, and UE D carry out the necessary measurement for the
Sidelink Positioning and Ranging-based service over the PC5 reference points.
Detail operation of this step is defined by RAN WGs.
Depends on the SL Positioning and Ranging-based service operation negotiated
during the control signalling, UE A, UE B, UE C, and UE D may exchange the
measurement results or Sidelink Positioning or Ranging results over the SR5
reference point. When LMF is used, the measurement results may be sent to the
LMF.
### 6.14.4 Protocol stack
Figure 6.14.4-1 illustrates an example UE protocol stack and the potential
interactions of the function elements and other layers of the UE.
Figure 6.14.4-1: UE functions and architecture for sidleink positioning and
ranging service
The function elements in figure 6.14.4-1 are defined as following:
\- Device and Service Discovery Function (DSDF): Discover and identify the
UE(s) in proximity that can participate in Sidelink Positioning and Ranging
service sessions, and it also provides to the upper layer about the service
supported by each of the identified UE.
\- Group Support Service Function (GSSF): Perform group management requested
by upper layer using the PC5 communication service provided by ProSe Layer or
V2X layer. The messages generated by GSSF are sent as data traffic over the
PC5 reference point and does not require additional enhancements to PC5
reference point.
\- Sidelink Positioning and Ranging Function (SPRF): Perform control
signalling between UEs or among a group of UEs to manage and coordinate the
Sidelink Positioning and Ranging operations. The messages generated by SPRF
are sent as data traffic over the PC5 reference point and does not require
additional enhancements to PC5 reference point.
In order to be supported over PC5, the three services, i.e. DSDF, GSSF, and
SPRF, should obtain a V2X Service Type (e.g. PSID, ITS-AID, or AID) or a ProSe
Application ID. It is possible for the three services to share the same
identifier or separate identifiers.
## 6.15 Solution #15: Service Authorization to NG-RAN for Ranging/Sidelink
Positioning
### 6.15.1 General
This solution is to address KI#8.
Since Ranging/Sidelink positioning is applied for V2X, public safety and
commercial use cases and all Ranging/SL positioning capable UEs are 5G ProSe
or V2X capable, it is assumed that Ranging/Sidelink positioning is always used
together with 5G ProSe or V2X or both service(s). It can be seen as the
extended capability of 5G ProSe or V2X and will be authorized by 5GC for the
usage in the PLMN.
Solutions on Service Authorization to NG-RAN for V2X communications over PC5
reference point and for ProSe based service over PC5 reference point have been
respectively defined in TS 23.287 [3] and TS 23.304 [4], however, they didn\'t
consider the support of Ranging/Sidelink positioning.
This solution provides enhancements to mechanism of Service Authorization to
NG-RAN for V2X communications over PC5 reference point and for ProSe based
service over PC5 reference point for the support of Ranging/Sidelink
positioning.
### 6.15.2 Functional descriptions
During registration, the UE includes the 5G ProSe Capability/V2X capability as
part of the \"5GMM capability\" in the Registration Request message. The AMF
stores the 5G ProSe Capability/V2X capability in the UE context.
The extension to the 5G ProSe capability or V2X capability due to the support
of Ranging/Sidelink positioning includes:
\- Ranging/Sidelink positioning reference UE.
\- Ranging/Sidelink positioning target UE.
\- Ranging/Sidelink positioning assistant UE.
\- Ranging/Sidelink positioning Located UE.
During registration, AMF determines whether the UE is authorised to use 5G
ProSe/V2X services based on UE\'s 5G ProSe/V2X Capability and the ProSe/V2X
Service Authorisation included in the subscription data received from UDM. The
AMF stores the authorized 5G ProSe Capability/authorized V2X Capability. The
extension to the authorized 5G ProSe capability / authorized V2X capability
due to the support of Ranging/Sidelink positioning includes:
\- Ranging/Sidelink positioning reference UE.
\- Ranging/Sidelink positioning target UE.
\- Ranging/Sidelink positioning assistant UE.
\- Ranging/Sidelink positioning Located UE.
The ProSe/V2X Service Authorisation of the subscription data also needs to be
extended, which can be achieved by extending ProSe/V2X subscription data to
include Ranging/Sidelink positioning information, see table 6.15.2-1.
Table 6.15.2-1: Extending ProSe/V2X subscription data
V2X Subscription data (see TS 23.287 [3]) NR V2X Services Authorization
Indicates whether the UE is authorized to use the NR sidelink for V2X services
as Vehicle UE, Pedestrian UE, or both, and whether the UE is authorized to use
or serve as Ranging/Sidelink positioning reference UE, target UE, assistant
UE, Located UE or any combination of these roles.
* * *
                                                  LTE V2X Services Authorization   Indicates whether the UE is authorized to use the LTE sidelink for V2X services as Vehicle UE, Pedestrian UE, or both and whether the UE is authorized to use LTE sidelink for Ranging/Sidelink positioning service control signalling.
                                                  NR UE-PC5-AMBR                   AMBR of UE\'s NR sidelink (i.e. PC5) communication for V2X services.
                                                  LTE UE-PC5-AMBR                  AMBR of UE\'s LTE sidelink (i.e. PC5) communication for V2X services.
ProSe Subscription data (see TS 23.304 [4]) ProSe Service Authorization
Indicates whether the UE is authorized to use ProSe Direct Discovery, ProSe
Direct Communication, or both, whether the UE is authorized to use or serve as
a ProSe UE-to-Network Relay and whether the UE is authorized to use or serve
as Ranging/Sidelink positioning reference UE, target UE, assistant UE, Located
UE, or any combination of these roles. ProSe NR UE-PC5-AMBR AMBR of UE\'s NR
sidelink (i.e. PC5) communication for ProSe services.
If the UE is authorised to use 5G ProSe/V2X services, then the AMF shall
include in a NGAP message sent to NG-RAN the \"5G ProSe authorised\"/\"V2X
authorised\" information. The \"5G ProSe authorised\" information and \"V2X
authorised\" information can be extended to include the Ranging/Sidelink
positioning authorization information:
\- whether the UE is authorized to act as a Ranging/Sidelink positioning
reference UE;
\- whether the UE is authorized to act as a Ranging/Sidelink positioning
target UE;
\- whether the UE is authorized to act as a Ranging/Sidelink positioning
assistant UE;
\- whether the UE is authorized to act as a Ranging/Sidelink positioning
Located UE.
The Ranging/Sidelink positioning authorization information is provided as part
of \"5G ProSe authorised\"/\"V2X authorised\" information from AMF to the NG-
RAN node over NGAP during Registration procedure, Service Request procedure
and N2 Handover procedure, and from source NG-RAN node to target NG-RAN node
over Xn during Xn Handover procedure as defined in clause 6.5 of TS 23.287 [3]
and clause 6.6 of TS 23.304 [4].
The Ranging/Sidelink positioning authorization information is only provided
when scheduled resource allocation mode is utilized.
### 6.15.3 Procedures
Procedures specified in clause 6.5 of TS 23.287 [3] and clause 6.6 of TS
23.304 [4] are reused with the extension described in clause 6.15.2.
### 6.15.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: extends 5G ProSe Capability/V2X capability with Ranging/Sidelink
positioning related parameters.
\- UDM: extends 5G ProSe /V2X subscription data with Ranging/Sidelink
positioning related parameters.
NG-RAN: resource allocation for Ranging/Sidelink positioning based on the
authorization
## 6.16 Solution #16: Solution for ranging operation with assistant UE(s)
### 6.16.1 General
This solution resolves Key Issue #2 for Ranging service operation procedure
with the assistance of other UEs (e.g. assistant UEs). In particular, this
solution presents the procedure of the ranging operation with the assistant
UE(s).
### 6.16.2 Functional descriptions
In general, this solution proposes the principles in the ranging operation
with the assistant UE(s):
1\. The direct ranging procedure defined by the solutions for KI#4 can be
directly used for Assistant UE(s) to get the relative position of the UE1 and
UE2 relative to the Assistant UE(s) respectively.
2\. UE1 as the initiator UE performs the ranging result calculation based on
the relative position of the UE1 and UE2 relative to the Assistant UE(s).
### 6.16.3 Procedures
Figure 6.16.3-1: High-level procedure for Ranging operation with assistant UE
1\. UE1 and UE2 get the ranging authorization policy from PCF during the
registration procedure. The ranging authorization policy may include whether
the UE is authorized to perform ranging operation with assistant UE. UE3 (i.e.
Assistant UE) gets the ranging authorization policy from PCF during the
registration procedure. The ranging authorization policy may include whether
the UE is authorized to act as an assistant UE for ranging operation.
2\. When the UE1 gets the ranging request from the application layer, but the
direct ranging operation between the UE1 and UE2 cannot be supported, so UE1
will perform assistant UE discovery procedure. Specifically, there are two
options:
Option A (Assistant UE selection by UE2): the UE1 sends a discovery message
including the ranging indication and UE2 User Info, and if the UE receives the
message including the ranging indication and supports as Assistant UE based on
the authorization policy in step 1 or its ranging capability, it will generate
and send a discovery message including UE2 User Info. After UE2 performs the
Assistant UE selection based on e.g. signal strength or whether LOS path
exists, and responses to the selected Assistant UE(s). The selected Assistant
UE(s) further responses to the UE1.
Option B (Assistant UE selection by UE1): the UE1 sends a discovery message
including the ranging indication and UE2 User Info, and if the UE receives the
message including the ranging indication and supports as Assistant UE based on
the authorization policy in step 1 or its ranging capability, it will generate
and send a discovery message including UE2 User Info. When UE2 receives the
discovery message from Assistant UE(s), UE2 responses to these Assistant
UE(s), and these Assistant UE(s) further responses to UE1. UE1 performs the
Assistant UE selection based on e.g. signal strength or whether LOS path
exists.
NOTE 1: The outcome of KI#1 \"Support of UE-to-UE Relay\" of FS_5G_ProSe_Ph2
described in TR 23.700‑33 [18] may be considered to down-select Option A or
Option B for a consistent UE action.
3\. UE1 sends the ranging request to the UE2, and the ranging request includes
Assistant UE ID(s). Ranging request is sent over PC5 direct connection or UE-
to-UE Relay connection.
When the ranging request from the application layer includes Ranging accuracy,
then UE1 can determinate the Ranging accuracy 1 for direct ranging between UE1
and Assistant UE and the Ranging accuracy 2 for direct ranging between UE2 and
Assistant UE, by considering the Ranging accuracy. Then the ranging request
includes Ranging accuracy 2.
NOTE 2: Coordination with RAN WGs is needed for the determination of Ranging
accuracy 1 and Ranging accuracy 2.
UE1 may get a scheduled ranging time from application layer or generate a
scheduled ranging time locally. The ranging request includes the scheduled
ranging time, and then step 4 and step 5 can be performed at the same
scheduled ranging time.
4\. The UE1 obtains the relative position of the Assistant UE(s) (named as
_relative position_ 1), by triggering the direct ranging procedure defined by
the solutions for KI#4 and using Ranging Method 1 based on Ranging accuracy 1.
If multiple Assistant UEs are used, the direct ranging procedure can be
performed for each Assistant UE.
5\. The UE2 obtains the relative position of the Assistant UE (named as
_relative position_ 2), by triggering the direct ranging procedure defined by
the solutions for KI#4 and using Ranging Method 2 based on Ranging accuracy 2.
If multiple Assistant UEs are used, the direct ranging procedure can be
performed for each Assistant UE.
NOTE 3: Coordination with RAN WGs is needed for the determination of Ranging
Method 1/2 based on Ranging accuracy 1/2.
6\. UE2 sends the _relative position_ 2 to the UE1.
NOTE 4: UE-to-UE Relay connection used in step 3 and step 6 depends on the
solutions for KI#1 \"Support of UE-to-UE Relay\" of FS_5G_ProSe_Ph2 described
in TR 23.700-33 [18].
7\. UE1 performs the ranging result calculation according to the _relative
position_ 1 and the _relative position_ 2.
### 6.16.4 Impacts on services, entities, and interfaces
**UE:**
\- The assistance UE(s) discovery.
\- Interaction for ranging request and ranging result.
## 6.17 Solution #17: Ranging/Sidelink positioning with the assistance of
assistant UE
### 6.17.1 General
This solution is to address KI#2.
When UE1 receives a service request for Ranging/Sidelink positioning between
UE1 and UE2, it triggers Ranging/Sidelink operation. At the time UE1 triggers
Ranging/Sidelink operation, UE1 doesn\'t know if direct communication between
UE1 and UE2 is possible, no matter whether UE2 has been successfully
discovered, because UE2 may move to a place where direct communication is not
possible.
When UE1 sends out the service request, it expects that this service request
is received by UE2 directly. If it can\'t be achieved, it has to sort help
from the assistant UE who can assist the Ranging/Sidelink positioning between
UE1 and UE2, i.e. who can perform Ranging/Sidelink positioning respectively
with UE1 and UE2, and can transmit the measurement data in between.
If multiple assistant UEs are available, UE1 needs to discover and select one
or multiple assistant UE to participate Ranging/Sidelink positioning between
UE1 and UE2.
Ranging/Sidelink positioning is performed between one or multiple assistant UE
and UE1 and between one or multiple assistant UE and UE2.
The final result of Ranging/Sidelink positioning between UE1 and UE2 can be
derived from the measurement data of Ranging/Sidelink positioning between
assistant UE and UE1 and the measurement data of Ranging/Sidelink positioning
between assistant UE and UE2.
### 6.17.2 Functional descriptions
An assistant UE has the following functionality:
\- Ranging/Sidelink positioning measurement.
\- Relay Ranging/Sidelink positioning measurement data and/or result between
UE1 and UE2.
\- Ranging/Sidelink positioning result calculation (optional).
To discover and select an assistant UE, UE1 broadcast the Ranging/Sidelink
positioning request. UE1 includes in the Ranging/Sidelink positioning request
an indication of \"assistant UE allowed\" in addition to the other parameters
(e.g. UE1 ID and UE2 ID, Ranging/Sidelink positioning content (i.e. distance,
direction) QoS requirement). \"Assistant UE allowed\" indicates that
Ranging/Sidelink positioning with the assistance of another UE is acceptable.
NOTE 1: The UE1 and UE2 ID may be application layer ID.
When the broadcast Ranging/Sidelink positioning request is received over PC5,
the potential assistant UE matches with the UE2 ID. If UE2 can receive the
request directly, it responds to UE1. If the potential assistant UE is
authorized as the Ranging/Sidelink positioning assistant UE at the current
PLMN, time and location by 5GC and when it receives from the Ranging/Sidelink
positioning request the \"Assistant UE allowed\" indication, it checks locally
if UE2 is already discovered. The potential assistant UE may maintain a list
of UEs that are discovered by itself. In that case, the potential assistant UE
searches from the list for UE2. If UE2 is already discovered, the potential
assistant UE responds to UE1; otherwise, the potential assistant UE triggers
UE2 discovery procedure and responds to UE1 when UE2 is successfully
discovered.
NOTE 2: If UE2 is also authorized as the Ranging/Sidelink positioning
assistant UE at the current PLMN, time and location by 5GC, it responds to UE1
as UE2.
UE1 may receive response from UE2 directly, and/or one or multiple responds
from assistant UE(s):
\- if UE1 receives response from UE2 directly, it initiates Ranging/Sidelink
positioning procedure to UE2
\- Otherwise, if UE1 receives one or multiple responds from assistant UE(s),
UE1 selects one or multiple assistant UE who sends the response first.
Since UE1 prefers direct Ranging/Sidelink positioning with UE2 than using
assistant UE, UE1 may wait for a while to receive response from UE2 after a
respond is received from any assistant UE. A timer may be configured at UE1.
When time is up, if no respond from UE2 is received, UE1 determines to use
assistant UE. The timer may be started when the first response is received
from any assistant UE or may be started when Ranging/Sidelink positioning
request is sent.
When Ranging/Sidelink positioning uses assistant UE and the assistant UE is
determined, UE1 initiates Ranging/Sidelink positioning procedure to the
selected assistant UE. An assistant UE ID is included in the request in
addition to other parameters (e.g. UE1 ID and UE2 ID, Ranging/Sidelink
positioning content (i.e. distance, direction) QoS requirement) to indicate
that Ranging/Sidelink positioning between UE1 and UE2 will be performed with
the assistance of the assistant UE.
When the selected assistant UE receives Ranging/Sidelink positioning request
which contains its own ID as the assistance UE ID, it performs
Ranging/Sidelink positioning with UE1, initiates the Ranging/Sidelink
positioning to UE2, including in the request UE1 ID and assistance UE ID, and
performs Ranging/Sidelink positioning with UE2.
The measurement data/result will be shared among UE1, UE2 and assistant UE to
derive the Ranging/Sidelink positioning result, and one of UE1, UE2 and
assistant UE calculates the result based on the measurement data/result.
Service authorization and policy/parameter provisioning take place during
registration or UE triggered Policy provisioning. A UE capable of being
Ranging/Sidelink positioning assistant UE indicates the capability in the UE
Policy Container to the PCF. The PCF authorizes the UE as Ranging/Sidelink
positioning assistant UE based on the capability received in the UE Policy
Container and other inputs.
NOTE 3: Details on how a UE is authorized as an assistant UE is developed in
solutions for KI#1.
### 6.17.3 Procedures
Figure 6.17.3-1 Procedure of Ranging/Sidelink positioning with the assistance
of assistant UE
1\. UE1 and UE2 are authorized as Ranging/Sidelink positioning
reference/target UE at the current PLMN, time and location. Assistant UE A,
assistant UE B, and Assistant UE C are authorized as Ranging/Sidelink
positioning assistant UE at the current PLMN, time and location.
2\. UE1 receives a Ranging/Sidelink positioning request from is application
layer, SL Positioning Client UE or 5GC NF for Ranging/Sidelink positioning
between UE1 and UE2.
3\. UE1 broadcasts the Ranging/Sidelink positioning request, which includes an
indication of \"assistant UE allowed\" in addition to the other parameters
(e.g. UE1 ID and UE2 ID, Ranging/Sidelink positioning content (i.e. distance,
direction) QoS requirement).
4\. When receiving Ranging/Sidelink positioning request, which includes an
indication of \"assistant UE allowed\" and UE2 ID, assistant UE A, assistant
UE B, and Assistant UE C check locally if UE2 is already discovered. If not,
they start to discover UE2 respectively, the discovery procedure is performed,
during which UE2 is discovered; otherwise this step is skipped.
NOTE 1: Details of the discovery procedure will be developed in solutions for
KI#3.
5\. Assistant UE A successfully discovers UE2, and sends the Ranging/Sidelink
positioning response to UE1.
6\. When Ranging/Sidelink positioning response is received from Assistant UE
A, UE1 may start a preconfigured timer. When time is up and no response is
received from UE2, UE1 determines to use Assistant UE A for Ranging/Sidelink
positioning.
7\. UE1 initiates Ranging/Sidelink positioning procedure to assistant UE A. An
assistant UE ID is included in the request in addition to other parameters
(e.g. UE1 ID and UE2 ID, Ranging/Sidelink positioning content (i.e. distance,
direction) QoS requirement) to indicate that Ranging/Sidelink positioning
between UE1 and UE2 will be performed with the assistance of the assistant UE.
Ranging/Sidelink positioning is performed between UE1 and assistant UE A.
Editor\'s note: The security issue, e.g. whether the selected assistant UE is
allowed to participate the Ranging/Sidelink positioning between UE1 and UE2 is
FFS, which will be evaluated by SA3.
8\. When assistant UE A receives Ranging/Sidelink positioning request which
contains its own ID as the assistance UE ID, it initiates the Ranging/Sidelink
positioning to UE2, and includes in the request UE1 ID and UE A ID as the
assistance UE ID. Ranging/Sidelink positioning is performed between UE2 and
assistant UE A.
9\. The measurement data/result are shared among UE1, UE2 and assistant UE A
to derive the Ranging/Sidelink positioning result.
NOTE 2: Whether the calculation is performed at UE1, UE2, assistant UE A or
any combination of them should be coordinated among them.
Editor\'s note: Whether there is any security concern of sharing the
measurement data/result to the selected assistant UE is FFS, which will be
evaluated by SA3.
10\. UE1 responds with the Ranging/Sidelink positioning result.
### 6.17.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE:
\- receives Ranging/Sidelink positioning request from is application layer, SL
Positioning Client UE or 5GC NF for Ranging/Sidelink positioning.
\- sends Ranging/SL Positioning result to application layer, SL Positioning
Client UE or 5GC NF.
\- broadcasts the Ranging/Sidelink positioning request, which includes an
indication of \"assistant UE allowed\" in addition to the other parameters.
\- handle Ranging/Sidelink positioning request, which includes an indication
of \"assistant UE allowed\".
\- handle Ranging/Sidelink positioning request, which includes an assistant UE
ID.
\- PC5: supports transmission of Ranging/SL Positioning service request and
Ranging/SL Positioning result.
## 6.18 Solution #18: Network triggered ranging device discovery
### 6.18.1 Description
This solution is related to the KI#3: Ranging/Sidelink Positioning device
discovery and mainly focuses on the following sub-KI:
\- How Ranging/Sidelink Positioning devices\' discovery is triggered at UE
based on network instruction for the cases of in coverage, partial coverage
and out of coverage?
From the low power consumption consideration, the ranging devices constraint
on the battery capability may not always perform the ranging device discovery
and ranging measurement over the sidelink/PC5. No ranging service requirement
for a long time may affect that the device turn off or de-activate the ranging
device discovery and ranging measurement. If current the peer device (UE#2)
has ranging requirement with UE#1, direct discovery over PC5 seems not work.
In this regard, it is proposed to use the Network triggered ranging service
discovery to activate the peer UE device discovery procedure.
In this solution, for the network triggered ranging device discovery, as
described in figure 6.18.1-1, the UE#1 sends the ranging device discovery
request to the network, then the network notifies that the UE#2 turns on or
activate the ranging device discovery. After receiving the notification from
the network, UE#2 initiates the ranging device discovery with UE#1.
This solution has 2 alternatives as following:
\- 5GC based network triggered ranging device discovery.
\- Application layer-based Network triggered ranging device discovery.
For the 5GC-based Network triggered ranging device discovery, the above-
mentioned procedure is performed over the Control plane as descried in clause
6.18.2 and this procedure is designed for UEs from same PLMN.
For the Application layer-based Network triggered ranging device discovery,
the above-mentioned procedure is performed over the application layer as
described in clause 6.18.3, which may be not in the SA2 scope for some
interactions. This procedure can work for UEs from different PLMN.
Figure 6.18.1-1: High-level procedure for Network triggered ranging device
discovery
### 6.18.2 Control plane-based Network triggered ranging device discovery
#### 6.18.2.1 General
For the Control plane-based Network triggered ranging device discovery, this
solution provides to 2 procedures as following:
\- One-shot Control plane-based Network triggered ranging device discovery
procedure.
\- Deferred Control plane-based Network triggered ranging device discovery
procedure.
For the one-shot procedure, the network notifies that the UE#2 activates the
ranging procedure after receiving request from the UE#1, the proximity is
determined by UE#1.
For the Deferred procedure, the UE#1 may subscribe to the network to monitor
the proximity between UE#1 and UE#2, once the proximity is determined, the
network notifies that the UE#1 and UE#2 activate the ranging device discovery.
#### 6.18.2.2 One-shot Control plane-based Network triggered ranging device
discovery
Figure 6.18.2.2-1: One-shot Control plane-based Network triggered ranging
device discovery procedure
1\. UE#1 sends a Ranging device discovery request to the AMF to invoke the
Network triggered ranging device discovery procedure for activating/turning on
the ranging discovery of UE#2, the Ranging device discovery request is
transferred via the UL NAS transport message including the UE#2 ID and
indication of one-shot procedure or deferred procedure.
2\. Considering the privacy, the AMF may check subscriber data of the UE#1 or
UE#2 whether the UE#1 is authorized to trigger the UE#2 to activate the
ranging service.
3\. If authorized in step2, the AMF selects a LMF supporting Network assistant
ranging/sidelink positioning procedure.
4\. AMF send the Ranging device discovery request to the selected LMF along
with the UE#2 ID and indication of one-shot procedure or deferred procedure.
5\. After receiving above request from the AMF, LMF may determine the
role(announcer/monitor) of UE#1 and UE#2 in ranging device discovery. And then
the LMF sends a Ranging device activation request including the role of UE#2
and UE#1 ID. LMF determine one-shot procedure in the next steps or deferred
procedure as in clause 6.18.2.3 based on the indication in above request.
6\. UE#2 determine to activate the ranging device discovery with UE#1 after
receiving request from LMF. UE#2 performs the device discovery procedure
(announcing or monitoring the discovery message) based on role provided by
LMF.
7\. UE#2 responses to the LMF that it has activated its ranging device
discovery.
8\. LMF responses to AMF with a ranging device discovery response message
including the role of UE#1.
9\. AMF forwards the ranging device discovery response message from LMF to the
UE#1 that UE#2 has activated the ranging device discovery.
10\. The UE#1 performs the Ranging device discovery (announcing or monitoring
the discovery message) with UE#2 based on role provided by LMF.
Editor\'s note: It is FFS how to handle the different AMF and LMF case.
#### 6.18.2.3 Deferred Control plane-based Network triggered ranging device
discovery
Figure 6.18.2.3-1: Deferred Control plane-based Network triggered ranging
device discovery procedure
1\. UE#1 sends a Ranging device discovery subscribe request to the AMF which
requests the network to monitor the proximity between UE#1 and UE#2, once the
proximity is determined, the network notifies that the UE#1 and UE#2 activate
the ranging device discovery.
2\. Considering the privacy, the AMF may check subscriber data of the UE#1 or
UE#2 whether the UE is authorized to trigger the UE#2 to activate the ranging
service.
3\. If authorized in step2, the AMF selects a LMF supporting Network assistant
ranging/sidelink positioning procedure.
4\. AMF send the Ranging device discovery subscribe request to the selected
LMF along with the UE#1 ID and UE#2 ID.
5\. After receiving above request from the AMF, LMF may determine the
role(announcer/monitor) of UE#1 and UE#2 in ranging device discovery and
determine the period of performing the positioning procedure with UE#1 and
UE#2. LMF responds to the AMF the Ranging device discovery subscribe response.
6\. AMF forwards the ranging device subscribe discovery response message from
LMF to the UE#1.
7\. LMF performs the UE positioning as described in TS 23.273 [11] with UE#1
and UE#2 periodically.
8\. LMF determines whether the UE#1 and UE2 are proximate based on the
positioning results of UE#1 and UE#2.
9\. If the proximity is detected, the LMF notifies that the UE#1 and UE#2
activate the Ranging device discovery.
10\. After receiving notification from LMF, the UE#1 and UE2 activate the
Ranging device discovery to discover each other.
NOTE: UE#1 and UE#2 performs the device discovery procedure (announcing or
monitoring the discovery message) based on role provided by LMF.
Editor\'s note: It is FFS how to handle the different AMF and LMF case.
### 6.18.3 Application layer-based Network triggered ranging device discovery
#### 6.18.3.1 General
For the Application layer-based Network triggered ranging device discovery,
similarly, this solution provides to 2 procedures as following:
\- One shot Application layer-based Network triggered ranging device discovery
procedure
\- Deferred Application layer-based Network triggered ranging device discovery
procedure
For the one-shot procedure, the AF notifies that the UE#2 activates the
ranging procedure after receiving request from the UE#1, the proximity is
determined by UE#1.
For the Deferred procedure, the UE#1 may subscribe to the AF to monitor the
proximity between UE#1 and UE#2, once the proximity is determined, the network
notifies that the UE#1 and UE#2 activate the ranging device discovery.
#### 6.18.3.2 One shot Application layer-based Network triggered ranging
device discovery
Figure 6.18.3.2-1: One shot Application layer-based Network triggered ranging
device discovery
1\. UE#1 may send the application message of ranging device discovery
including the UE#2 ID to request the AF to activate the ranging device
discovery of UE#2.
2\. AF performs the privacy check whether the UE#1 is authorized to perform
ranging service with UE#2. AF sends the ranging device discovery request
including UE#1 ID and UE#2 ID to NEF.
Editor\'s note: Whether to perform privacy check needs coordination with SA3.
3\. NEF check the UE#1 and UE#2 subscribe data
4\. Based on the subscribe data, the NEF determines the authorization result.
5\. NEF returns the authorization result to AF via the ranging device
discovery response.
6\. If it is authorised, the AF sends the application message of ranging
device discovery request to UE#2.
7\. After receiving the request from AF, the UE#2 activates the ranging device
discovery with UE#1.
8\. UE#2 responds to AF.
9\. AF responds to UE#1.
10\. UE#1 initiates the ranging device discovery with UE#2.
#### 6.18.3.3 Deferred Application layer-based Network triggered ranging
device discovery procedure
Figure 6.18.3.3-1: Deferred Application layer-based Network triggered ranging
device discovery procedure
1\. UE#1 sends a Ranging device discovery subscribe request over application
message to the AF which requests the AF to monitor the proximity between UE#1
and UE#2, once the proximity is determined, the AF notifies that the UE#1 and
UE#2 activate the ranging device discovery.
2\. Considering the privacy, the AF may check subscriber data of the UE#1 or
UE#2 whether the UE is authorized to trigger the UE#2 to activate the ranging
service as described in steps 2-5 in figure 6.18.3.2-1.
3\. AF responds to UE#1 based on the privacy checking results in step 2.
4\. AF performs the Deferred 5GC-MT-LR Procedure as described in TS 23.273
[11] with UE#1 and UE#2.
5\. AF determines whether UE#1 and UE#2 are proximate.
6\. If proximate, the AF notifies the UE#1 and UE#2 of performing the ranging
device discovery procedure.
7\. UE#1 and UE#2 perform the ranging device discovery to discover each other.
### 6.18.4 Impacts on Existing Nodes and Functionality
The solution has impacts on the following entities:
UE(s):
\- request the network to activate the ranging device discovery.
\- activate the ranging device discovery after receiving request from network.
AMF:
\- LMF selection.
\- privacy checking with UDM whether UE is able to trigger another UE to
perform ranging service.
\- request LMF to notify ranging device discovery.
LMF:
\- supports to notify ranging device discovery via LPP message.
UDM:
\- has the subscription data whether UE is able to be triggered by another UE
to perform the ranging service.
AF:
\- privacy checking with UDM whether UE is able to trigger another UE to
perform ranging service.
\- activate the ranging device discovery.
## 6.19 Solution #19: Support of Sidelink Positioning and Ranging signalling
over different PC5 RATs
### 6.19.1 General
This solution addresses the key issue#4 on \" Control of Operations for
Ranging/Sidelink positioning\" and key issue #5 on \"Network assisted Sidelink
Positioning for In Network Coverage and Partial Network Coverage\".
Specifically, this solution focused on supporting the control signalling over
different PC5 access technologies, with minimum AS layer impacts and on
supporting sidelink positioning with or without assistance from an LMF.
As described by solution#14 (clause 6.14), the system architecture supports
interactions between the UEs (e.g. UE-A and UE C, UE A and UE B, or UE C and
UE-D) and between UE and 5GC. For the interactions between the UEs, the
operation over the SR5 reference point is carried over the PC5 reference
point. Due to different deployment scenarios and operations, PC5 reference
point may utilize different type of access technologies, including LTE PC5 and
NR based PC5 for V2X use (as of TS 23.287 [3]), and 5G ProSe based PC5 (as of
TS 23.304 [4]). For example:
\- Among V2X capable UEs, the control signaling defined for SR5 is carried out
via LTE or NR PC5 (as defined in TS 23.287 [3]). The control signaling manages
the actual AS layer Sidelink Positioning and Ranging signaling and
measurements defined by RAN WGs.
\- Among 5G ProSe capable UEs, the control signaling for SR5 is carried out
over 5G ProSe PC5 (as defined in TS 23.304 [4]). The control signaling manages
the actual AS layer Sidelink Positioning and Ranging signaling and
measurements defined by RAN WGs.
The function of the SR5 services, and the AS layer Sidelink Positioning and
Ranging signaling and measurements defined by RAN WGs would not be affected by
which PC5 RAT is used to carry the SR5 control signaling.
### 6.19.2 Functional descriptions
#### 6.19.2.1 Upper Protocol Layers
Figure 6.19.2.1-1 illustrates an example UE architecture and the potential
interactions of the function elements and other layers of the UE for upper
protocol layers. The architecture shown in Figure 6.19.2.1-1 is aligned with
that for Solution #14 clause 6.14.4 but includes more details for each upper
protocol layer.
Figure 6.19.2.1-1: UE functions and architecture for sidelink positioning and
ranging service
The function elements identified in clause 6.19.1 are defined as follows:
\- Device and Service Discovery Function (DSDF):
\- DSDF provides the following services to the upper layer, e.g. Application
Layer:
\- a unique identifier of the UE(s) in proximity that can participate in
Sidelink Positioning and Ranging service;
\- services supported by each of the UE identified, e.g. signaling protocols,
pairwise ranging, group ranging;
\- communication channel and sessions with the identified UEs.
\- DSDF may receive the following information from the upper layer:
\- trigger for the discovery of UEs to participate in Sidelink Positioning and
Ranging services;
\- (optional) attributes of the UEs to be discovered;
\- indication of discovery by other UEs and corresponding attributes of the
other UEs;
\- Request/permission for the corresponding Sidelink Positioning and Ranging
services.
\- Operation performed by DSDF:
\- Performing device and service discovery using PC5 communication service
provided by ProSe or V2X layer. For example, it may perform application layer
discovery using broadcast service over PC5 reference point.
\- Group Support Service Function (GSSF):
\- GSSF may be part of the Application Layer (e.g. for V2X) or may be a layer
below the Application layer (e.g. for MC services);
Editor\'s note: it is FFS whether GSSF is in scope for 3GPP for V2X or whether
GSSF for V2X remains out of scope and part of the Application Layer.
\- GSSF (when below the Application Layer) provides the following services to
the upper layer, e.g. Application Layer:
\- creating a Sidelink Positioning and Ranging service group, when the upper
layer has specified the group. GSSF needs to provide group ID and group local
member IDs to the upper layer. GSSF needs to also manage the group members,
e.g. addition or removal of group members, splitting or merge of groups, etc.
as decided by the upper layer;
\- with upper layer application layer managed group function, e.g. V2X
platooning application, the GMSF provides the needed support for the group
member status monitoring, i.e. indication of group members of presence and
capability/status of the group members. GSSF may make use of the service of
DSDF for the needed operation.
\- GSSF may receive the following information from the upper layer:
\- request for the creation or deletion of a group containing identified UEs
for Sidelink Positioning and Ranging service;
\- request for the operation of a specific group member, e.g. add or remove a
group member;
\- request for the management of a group, e.g. merge 2 groups or split a group
into 2 separate groups.
\- Operation performed by GSSF:
\- Performing group management requested by upper layer using the PC5
communication service provided by ProSe Layer or V2X layer. The messages
generated by GSSF are sent as data traffic over the PC5 reference point and
does not require additional enhancements to PC5 reference point.
NOTE 1: The group support is only for the control signalling, e.g. to
determine which UE should be part of the Sidelink Positioning and Ranging
session. It does not affect how AS layer positioning/ranging signal operates.
\- Sidelink Positioning and Ranging Function (SPRF):
\- SPRF provides the following services to the upper layer, e.g. Application
Layer:
\- create a Sidelink Positioning/Ranging session between a specified group of
UEs;
\- on-demand Sidelink Positioning/Ranging, direction, or relative location of
another UE or a specified group of UEs;
\- periodic Sidelink Positioning/Ranging, direction, or relative location of
another UE or a specified group of UEs;
\- triggered Sidelink Positioning/Ranging, direction, or relative location of
another UE or a specified group of UEs.
\- SPRF may receive the following information from the upper layer:
\- request for current range/direction or relative location of another UE or a
specified group of UEs;
\- request for periodic range/direction or relative location of another UE or
a specified group of UEs;
\- request for triggered range/direction or relative location of another UE or
a specified group of UEs.
NOTE 2: The request from upper layers may originate on the UE itself (e.g. due
to a user request or in support of an autonomous UE function like driving
assistance for V2X) or may be received by the UE from the network (e.g. an
LMF) or from an external client.
\- Operation performed by SPRF:
\- Performing control signaling between 2 UEs or among a group of 2 of more
UEs to manage and coordinate the Sidelink Positioning and Ranging operations.
The messages generated by SPRF are sent as data traffic over the PC5 reference
point and does not require additional enhancements to PC5 reference point.
\- If the network supports Sidelink Positioning and Ranging, SPRF exchange may
happen between UE and the LMF (e.g. using NAS signaling), similar to that
defined in TS 23.273 [11].
\- Service Exposure Function:
\- This function allows the UE to interact with the application layer, or the
AF and external client.
\- If the network supports the Sidelink Positioning and Ranging, the
interactions may happen between the UE and the LMF as defined in TS 23.273
[11].
\- The exact operation of service exposure to an external client or AF is out
of scope of SA WG2.
In order to support the operation over different PC5 RATs, each of the SR5
service elements is assigned a V2X Service Type (e.g. PSID, ITS-AID, or AID as
of TS 23.287 [3]) and a ProSe Identifier (e.g. Application ID as of TS 23.304
[4]). For example:
\- Device and Service Discovery Function (DSDF) is assigned PSID_ DSDF, and
ProSe_AppID_DSDF;
\- Group Support Service Function (GSSF) is assigned PSID_GSSF, and
ProSe_AppID_GSSF;
\- Sidelink Positioning and Ranging Function (SPRF) is assigned PSID_SPRF, and
ProSe_AppID_SPRF.
NOTE 3: It is also possible that all the three services are sharing the same
V2X Service Type and ProSe Identifier.
Some lower layer functions might be combined to improve efficiency of
operation. For example, the GSSF and SPRF might be combined to improve
efficiency and reduce complexity in creating both a group of UEs (GSSF
service) and a sidelink positioning/ranging session between the UEs in the
group (SPRF service).
#### 6.19.2.2 Support of V2X UE operations
For a V2X capable UE (as defined in TS 23.287 [3]), it would be configured
with the corresponding information in the V2XP for the service types. The
following element would be included in the Policy/Parameters for V2X
communications over PC5 reference point, as in clause 5.1.2.1 of TS 23.287
[3]:
_3) Policy/parameters for PC5 RAT selection and for PC5 Tx Profile selection:_
_\- the mapping of_ _PSID_DSDF/PSID_GSSF/PSID_SPRF_ _to PC5 RAT(s) (e.g. LTE
PC5, NR PC5 or both), and:_
_\- for LTE PC5, to the corresponding Tx Profiles (see TS 36.300 [19] for
further information);_
_\- for NR PC5, to the corresponding NR Tx Profiles for broadcast and
groupcast (see TS 38.300 [8] and TS 38.331 [20] for further information)._
The other configuration parameters in clause 5.1.2.1 of TS 23.287 [3] may also
apply accordingly. For example, when NR PC5 RAT is selected, the configuration
may further determine the support of cast types, e.g.:
_6) Policy/parameters when NR PC5 is selected:_
_\- The mapping of_ _PSID_DSDF/PSID_GSSF/PSID_SPRF_ _to the default mode of
communication (i.e. broadcast mode, groupcast mode or unicast mode)._
In order to carry the SR5 signaling, the non-IP PDCP SDU type is utilized AS
layers over the user plane PC5 reference point (as shown in clause 6.1.1 of TS
23.287 [3]).
**Legend:**
\- PC5-U: The SDAP/PDCP/RLC/MAC/PHY functionality is specified in TS 38.300
[8].
\- For PDCP SDU type \"Non-IP\", a \"Non-IP Type\" header included in the SDU
by upper layer to indicate the type of non-IP messages carried will be
specified in stage 3 specification.
Figure 6.19.2.2-1: User Plane Lower Protocol Layers for NR PC5 reference point
In this approach, the SR5 signaling is handled as V2X Application (with
PSID_DSDF/PSID_GSSF/PSID_SPRF). The non-IP PDCP SDU type is supported by both
LTE PC5 and NR PC5. Therefore, regardless of the RAT selected based on policy
3) above, the transport can be supported.
The Non-IP PDCP SDU contains a Non-IP Type header, which indicates the V2X
message family used by the application layer. The non-IP Type header and
allowed value is defined TS 24.587 [17]. To support the signalling for SR5, a
new non-IP Type header value can be added, e.g. \"SR5\".
NOTE: Alternatively, each of the three SR5 services, e.g. DSDF, GSSF, SPRF,
can have its own non-IP Type header value.
With the use of non-IP PDCP SDU type, there is no need to change the AS layer
for carrying the SR5 signaling.
When NR PC5 is selected, broadcast, groupcast, or unicast mode can be also
supported without change of AS layer.
#### 6.19.2.3 Support of 5G ProSe UE operations
For a 5G ProSe capable UE, configuration regarding the SR5 signaling is
configured using ProSeP, as defined in clause 5.1.3.1 of TS 23.304 [4]. For
example, the policy could include the mapping of the corresponding ProSe
Identifier for the SR5 services to the cast mode and the Layer-2 ID to use:
_5) Policy/parameters when NR PC5 is selected:_
_\- The mapping of ProSe services (e.g._ ProSe_AppID_DSDF/ ProSe_AppID_GSSF/
ProSe_AppID_SPRF _) to radio frequencies with Geographical Area(s)._
_\- The mapping of ProSe services (e.g._ ProSe_AppID_DSDF/ ProSe_AppID_GSSF/
ProSe_AppID_SPRF _) to Destination Layer-2 ID(s) for broadcast._
_\- The mapping of ProSe services (e.g._ ProSe_AppID_DSDF/ ProSe_AppID_GSSF/
ProSe_AppID_SPRF _) to Destination Layer-2 ID(s) for groupcast._
_\- The mapping of ProSe services (e.g._ ProSe_AppID_DSDF/ ProSe_AppID_GSSF/
ProSe_AppID_SPRF _) to default Destination Layer-2 ID(s) for initial
signalling to establish unicast connection._
To carry the SR5 signaling messages over the PC5-U reference point as defined
in clause 6.1.2 of TS 23.304 [4], there are two options:
\- Use the same non-IP PDCP SDU type as in the case of V2X UEs. Although 5G
ProSe does not use the non-IP PDCP SDU type, the AS layer of 5G ProSe is
shared with NR based V2X defined in TS 38.300 [8]. Therefore, the non-IP PDCP
SDU type is supported without any AS layer impact.
\- Use the \"unstructured\" PDCP SDU type. This is supported by 5G ProSe UEs,
and the separation of the DSDF, GSSF, SPRF signaling can be achieved with
Destination L2 IDs as configured in ProSeP item 5) above.
### 6.19.3 Procedures
#### 6.19.3.1 Procedure for Sidelink Positioning/Ranging for UE-only operation
For a UE interested in Sidelink Positioning and Ranging service, it may invoke
the DSDF service for discovery and to identify other UEs in proximity that
support the operations. This may be based on the request from the upper layer.
Based on the pre-configuration, or provisioned policies and parameters as
described in clause 6.19.2, the UE can determine the RAT (e.g. LTE PC5 or NR
PC5) and corresponding Tx Profiles to be used for the DSDF, GSSF, and SPRF,
based on V2X Service Type/ProSe Identifier to RAT mapping. Such configuration
will also determine the communication modes to use, e.g. broadcast, groupcast,
or unicast.
If it is determined that more than two UEs need to participate in the
operation, the GMSF service is invoked to form the group or determine the
group members\' presence and status for the operation.
SPRF signaling is used for the control signaling between the UEs to determine
the corresponding Sidelink Positioning and Ranging operation, e.g. the channel
to use for the Sidelink Positioning or Ranging reference signal, the sequence
and time slot for each of the UE to perform the signal transmission and
measurements.
The UEs, e.g. UE A and UE B, or in other cases a group of UEs, carry out the
Sidelink Positioning or Ranging reference signal transmission and
measurements.
Based on the Sidelink Positioning or Ranging services negotiated by the SPRF
signaling in the earlier phase, the UEs uses the SPRF signaling to exchange
the measurement results. This enables the UEs to perform the calculation of
the range/direction, or relative locations.
Depending on the SPRF signaling support, some UEs may also provide a location
computation service to other UEs.
Figure 6.19.3.1-1 shows an example of a UE-only operation for sidelink
positioning/ranging procedure with a group of n UEs labelled 1 to n, where n ≥
2. In this example, the n UEs may all have network coverage, may have partial
network coverage or may all be out of coverage.
Figure 6.19.3.1-1: Procedure for Sidelink Positioning/Ranging for UE-only
operation
1\. UEs 1 to n discover one another. The discovery may or may not be network
assisted and may use the DSDF in each UE.
2\. A sidelink positioning/ranging session may be established between the UEs
1 to n. This may be supported by the GSSF and/or SPRF. This signalling
exchange happens over PC5 reference point.
3\. UEs 1 to n exchange sidelink positioning/ranging capabilities -- e.g.
using SPRF signalling over PC5.
4\. Transmission and measurement of Sidelink Reference Signals is configured
in UEs 1 to n -- e.g. by one coordinating UE or in a distributed manner.
5\. Transmission and measurement of Sidelink Reference Signals are performed
by each of UEs 1 to n according to the configurations at step 4.
6\. UEs 1 to n exchange the sidelink measurements obtained at step 5 - e.g.
using SPRF signalling.
7\. UEs 1 to n calculate sidelink positioning/ranging location results from
the sidelink measurements obtained at steps 5 and 6. The sidelink
positioning/ranging location results may include absolute locations, relative
locations and/or ranges for the UEs 1 to n. The calculation may be distributed
over all UEs 1 to n or may be centralized in one UE or in a few UEs.
8\. UEs 1 to n may exchange the sidelink positioning/ranging location results
obtained at step 7 - e.g. using SPRF signalling. Steps 5-8 or steps 4-8 may be
repeated.
#### 6.19.3.2 MO-LR Procedure for Sidelink Positioning/Ranging with LMF
Assistance
Sidelink positioning/ranging of a group of 2 or more UEs that are in network
coverage or partial network coverage may be instigated by the UEs themselves
and assisted by an LMF using the 5GC-MO-LR procedure in clause 6.2 of TS
23.273 [11] with some enhancements. A reason to reuse and enhance the existing
MO-LR procedure is to reduce new impacts to UEs, 5GCN and LCS Client and AF.
Figure 6.19.3.2-1 shows the enhanced MO-LR procedure applied to n UEs labelled
1 to n, where n ≥ 2. The procedure is invoked by one UE, assumed to be UE1 in
Figure 6.19.3.2-1. At least one of the UEs (UE1 in this example) must be in
network coverage though other UEs may or may not be in coverage.
Figure 6.19.3.2-1: MO-LR Procedure for Sidelink Positioning/Ranging with LMF
Assistance
1\. UE1 discovers UEs 2 to n. The discovery may or may not be network assisted
and may be supported by the DSDF in each UE.
2\. UE1 obtains the sidelink positioning capabilities of UEs 2 to n -- e.g.
using SPRF.
3\. If UE1 determines that assistance data from LMF is needed and/or location
calculation assistance from the LMF is needed and/or whether the sidelink
positioning/ranging location results should be transferred to an LCS Client or
AF, it sends a supplementary services MO-LR request to the serving AMF as in
steps 1 and 2 of clause 6.2 of TS 23.273 [11]. The MO-LR request includes a
request for sidelink positioning/ranging and indicates the other UEs 2 to n.
The MO-LR Request indicates the request to LMF, e.g. assistance data, location
calculation assistance, results transfer to LCS client or AF. For transfer to
an LCS Client or AF, details of the LCS Client or AF (and possibly of a GMLC)
and global identities for all UEs are also included. For location calculation
assistance from the LMF, the preferred type of sidelink positioning/ranging
location results (e.g. absolute locations, relative locations or ranges
between pairs of UEs) are included and QoS.
4\. The serving AMF selects an LMF (e.g. an LMF that supports sidelink
positioning/ranging) and sends an Nlmf_Location_DetermineLocation service
operation towards the LMF with the information from the MO-LR Request.
5\. The LMF sends a request (e.g. an SPRF request) to UE1 for the capabilities
of all UEs 1 to n.
6\. UE1 returns its capabilities and the capabilities for UEs 2 to n obtained
at step 2 to the LMF. This could instead occur as part of step 3 - e.g. if an
SPRF message carrying the capabilities is embedded in the MO-LR Request. The
capabilities may include the RATs and frequencies supported by each of the UEs
1 to n for sidelink positioning/ranging.
7\. If UE1 indicates assistance data is needed at step 3, UE1 sends a request
for specific assistance data to the LMF. As with step 6, this step could also
occur as part of step 3 - e.g. if an SPRF message indicating the requested
assistance data is embedded in the MO-LR Request
8\. If step 7 occurs, the LMF returns the requested assistance data to UE1.
The assistance data may assist UEs 1 to n to obtain sidelink location
measurements and/or may assist UE1 to calculate sidelink positioning/ranging
location results.
9\. If the MO-LR request at step 3 indicated location calculation assistance
is needed and/or indicated transfer of sidelink positioning/ranging location
results to an LCS Client or AF, the LMF sends a request for location
information to UE1.
10\. UE1 instigates a sidelink positioning/ranging procedure among UEs 1 to n,
e.g. as in steps 2-6 of Figure 6.19.3.1-1. This step can be supported using
any assistance data received at step 8. As part of this step, the UEs 1 to n
obtain sidelink location measurements of sidelink signals transmitted by other
UEs.
11\. If UE1 did not request location calculation assistance from the LMF at
step 3, UE1 calculates sidelink positioning/ranging location results for
itself and possibly for each of the other UEs 2 to n based on the sidelink
location measurements obtained at step 10 and possibly using any assistance
data received at step 8, The sidelink positioning/ranging location results can
include absolute locations, relative locations or ranges between pairs of the
UEs 1 to n. Some or all of the location calculation might be performed by some
or all of the UEs 2 to n with the location results then transferred to UE1.
12\. If UE1 received a request for location information at step 9, UE1 sends a
response to the LMF and includes either the sidelink location measurements
obtained at step 10 or the sidelink positioning/ranging location results
obtained at step 11 if step 11 occurred.
13\. If step 12 occurred and if location calculation assistance from the LMF
was requested at step 3, the LMF calculates sidelink positioning/ranging
location results for UEs 1 to n from the sidelink location measurements
received at step 12. The sidelink positioning/ranging location results can
include absolute locations, relative locations or ranges between pairs of the
UEs 1 to n.
14\. The LMF returns an Nlmf_Location_DetermineLocation service operation
response to the AMF and includes any sidelink positioning/ranging location
results received at step 12 or calculated at step 13.
15\. If sidelink positioning/ranging location results were received at step
14, the AMF performs steps 7-12 of clause 6.2 of TS 23.273 [11] to send the
sidelink positioning/ranging location results to the GMLC and to an AF or LCS
Client if this was requested at step 3. The sidelink positioning/ranging
location results include the global identities for UEs 2 to n received at step
3 (and the global identity of UE1).
NOTE: Sending location results and global identities for UEs 2 to n to an AF
or LCS Client may require privacy verification from UEs 2 to n and/or from the
HPLMNs of UEs 2 to n (as well as privacy verification for UE1).
16\. The LMF returns a supplementary services MO-LR response to UE1 and
includes any sidelink positioning/ranging location results calculated at step
13 if step 13 was performed. UE1 may then transfer any sidelink
positioning/ranging location results to UEs 2 to n.
#### 6.19.3.3 MT-LR Procedure for Sidelink Positioning/Ranging with LMF
Assistance
Sidelink positioning/ranging location results for a group of 2 or more UEs
that are in network coverage or partial network coverage may be requested by
an LCS Client or AF and assisted by an LMF using the 5GC-MT-LR procedure in
clause 6.1.2 of TS 23.273 [11] with some enhancements. A reason to reuse and
enhance the existing MT-LR procedure is to reduce new impacts to UEs, 5GCN and
LCS Client and AF. Figure 6.19.3.3-1 shows the enhanced MT-LR procedure
applied to n UEs 1 to n where n ≥ 2. Typically this requires the LCS Client or
AF to be aware that UEs 1 to n are or may be nearby to one another. This may
be possible in some IIoT scenarios (e.g. factory or warehouse) or when the AF
or LCS Client has other information indicating this. At least one the UEs (UE1
in this example) must be in network coverage though other UEs may or may not
be in coverage.
Figure 6.19.3.3-1: MT-LR Procedure for Sidelink Positioning/Ranging with LMF
Assistance
1\. An LCS Client or AF initiates an MT-LR procedure as in steps 1-11 of
clause 6.1.2 of TS 23.273 [11]. The LCS Client or AF includes global
identities of the n UEs 1 to n and may indicate one UE (assumed to be UE1
here) as the principal target UE. If the LCS Client or AF does not indicate a
principal target UE that is in network coverage, the GMLC or AMF selects a
principal target UE from among UEs 1 to n. The principal target UE must have
network coverage and preferably with the PLMN that is serving the LCS Client
or AF. The principal target UE later receives the MT-LR request and
coordinates sidelink positioning/ranging among the other UEs. Therefore, in
step 5 of clause 6.1.2 of TS 23.273 [11], the location request is sent to the
serving AMF of the principal target UE. The MT-LR location request at step 1
of clause 6.1.2 of TS 23.273 [11] includes the type of sidelink
positioning/ranging location results needed (absolute locations, relative
locations or ranges between pairs of UEs), QoS and includes conditions for
cancelling the location request when not all UEs 1 to n can be discovered for
positioning. The conditions for cancelling the location request may include:
\- One or more specific identified UEs cannot be discovered; and/or
\- The total number of UEs 1-n that are discovered is less than a quorum q,
where 1 ≤ q ≤ n.
NOTE 1: Privacy verification may need to be performed for all n UEs 1 to n. If
all n UEs have the same HPLMN, this can be performed by the H-GMLC at step 2
of clause 6.1.2 of TS 23.273 [11]. If all n UEs are in network coverage and
have the same serving AMF, privacy notification/verification for each of the
UEs 1 to n (if needed) can be performed by the common serving AMF at steps 7
and 8 in clause 6.1.2 of TS 23.273 [11]. If some of the UEs 1 to n have a
different HPLMN, are not in network coverage or have a different serving AMF,
some additional support not defined here may be needed.
2\. The LMF sends a supplementary services MT-LR request to the principal
target UE1 and includes the global identities of the other UEs 2 to n, the
conditions for cancelling the location request when not all UEs 1 to n can be
discovered and may include the types of sidelink positioning/ranging location
result needed.
3\. UE1 attempts to discover the other UEs 2 to n if not already discovered.
If not all UEs 2 to n are discovered and if the conditions for cancelling the
location request when not all UEs 1 to n can be discovered are met, UE1
returns a negative response at step 5 and the procedure terminates after the
LMF returns the negative response to the LCS Client or AF via the AMF and
GMLC.
4\. UE1 obtains (e.g. requests and receives) the sidelink positioning
capabilities of UEs 2 to n if not already obtained.
5\. UE1 returns a supplementary services MT-LR response to the LMF indicating
if the MT-LR request can be supported and which of UEs 2 to n have been
discovered and are available for positioning.
6\. Sidelink positioning/ranging of the UEs 1 to n occurs as for an MO-LR as
described for steps 5-13 of Figure 6.19.3.2-1 with the difference that
sidelink positioning/ranging location results are always obtained and the LMF
indicates to UE1 at step 8 or step 9 of Figure 6.19.3.2-1 whether the sidelink
positioning/ranging location results will be calculated by the LMF or by UE1
(and/or by other UEs).
7\. The LMF returns the sidelink positioning/ranging location results for UEs
1 to n to the LCS Client or AF as in steps 13-24 of clause 6.1.2 in TS 23.273
[11].
NOTE 2: The additional privacy check at steps 16-23 of clause 6.1.2 in TS
23.273 [11] is possible if all UEs 1 to n have the same HPLMN and same serving
AMF but could otherwise require some extension of the procedure in clause
6.1.2 in TS 23.273 [11].
#### 6.19.3.4 Periodic or Triggered MT-LR Procedure for Sidelink
Positioning/Ranging with LMF Assistance
Sidelink positioning/ranging results for a group of 2 or more UEs that are in
network coverage or partial network coverage may be requested periodically or
when certain trigger events occur by an LCS Client or AF and may be assisted
by an LMF using the periodic or triggered 5GC-MT-LR procedure in clause 6.3.1
of TS 23.273 [11] with some enhancements. A reason to reuse and enhance the
existing periodic or triggered MT-LR procedure is to reduce new impacts to
UEs, 5GCN and LCS Client and AF. Figure 6.19.3.4-1 shows the enhanced periodic
or triggered MT-LR procedure applied to n UEs 1 to n where n ≥ 2. Typically
this requires the LCS Client or AF to be aware that UEs 1 to n are or may be
nearby to one another over the whole duration of location reporting. This may
be possible in some IIoT scenarios (e.g. factory or warehouse) or when the AF
or LCS Client has other information indicating this. At least one the UEs (UE1
in this example) must be in network coverage though other UEs may or may not
be in coverage.
Figure 6.19.3.4-1: Periodic or Triggered MT-LR Procedure for Sidelink
Positioning/Ranging with LMF Assistance
1\. An LCS Client or AF initiates a periodic or triggered MT-LR procedure as
in steps 1-14 of clause 6.3.1 of TS 23.273 [11]. The LCS Client or AF includes
additional information in the location request for step 1 in clause 6.3.1 of
TS 23.273 [11] as described for step 1 of Figure 6.19.3.3-1. A principal
target UE (UE1 here) is also selected as described for step 1 of Figure
6.19.3.3-1. For triggered location reporting, different trigger events may be
supported than for clause 6.3.1 of TS 23.273 [11]. Some examples of different
trigger types are as follows:
\- area event trigger where any one UE (or all UEs) enters an area, remains in
an area or leaves an area;
\- motion event trigger where any one UE (or all UEs) moves by more than a
threshold distance from a previous position; and
\- range trigger where a particular type of range rises above a threshold,
falls below a threshold and/or increases or decreases by more than a threshold
amount. The particular type of range could be any of the following:
\- the maximum range of all ranges between all pairs of the UEs 1 to n.
\- the minimum range of all ranges between all pairs of the UEs 1 to n.
\- the minimum range between any UE and each of the other n-1 UEs (there are n
minimum ranges corresponding to the n UEs and the trigger occurs when any of
the n minimum ranges crosses a threshold)
\- the maximum range between any UE and each of the other n-1 UEs (there are n
maximum ranges corresponding to the n UEs and the trigger occurs when any of
the n maximum ranges crosses a threshold)
NOTE: Privacy verification may be supported as described for NOTE 1 in clause
6.19.3.3.
2\. The LMF instigates MT-LR sidelink positioning/ranging of the UEs 1 to n as
in steps 2-6 of Figure 6.19.3.3-1. The LMF may verify whether the conditions
are met for cancelling the location request when not all UEs 1 to n are
discovered (in which case the location request is cancelled by the LMF) and
may obtain the capabilities of the UEs 1 to n but may not always obtain
immediate sidelink positioning/ranging location results.
3\. The LMF sends a supplementary services LCS Periodic-Triggered Invoke
Request to UE1 as in step 16 for clause 6.3.1 of TS 23.273 [11] and includes
the event trigger(s) provided in step 1 and indicates sidelink
positioning/ranging of the UEs 1 to n.
4\. UE1 may establish a periodic or triggered sidelink positioning session
with UEs 2 to n (e.g. using GSSF and/or SPRF) which can enable UEs 2 to n to
participate in detecting trigger events for step 7 (e.g. events which affect
some or all of UEs 2 to n) and speed up sidelink positioning/ranging at step 8
by configuring UEs 2 to n in advance.
5\. UE1 returns an LCS Periodic-Triggered Invoke Response to the LMF as in
step 17 for clause 6.3.1 of TS 23.273 [11] and may indicate which of UEs 2 to
n can support the periodic or triggered sidelink positioning/ranging.
6\. The LMF sends a confirmation of whether periodic or triggered sidelink
positioning/ranging was successfully activated in UE1 (and UEs 2 to n) to the
LCS Client or AF using steps 18-21 in clause 6.3.1 of TS 23.273 [11].
7\. UE1 waits for an event to be detected, may then obtain sidelink
positioning/ranging measurements and possibly calculate sidelink
positioning/ranging location results, sends a supplementary services event
report to the LMF and receives back an event report acknowledgement as for
steps 22-26 for clause 6.3.1 of TS 23.273 [11]. Differences here are that
detection of an event by UE1 may depend on detecting an event related to one
or more of UEs 1 to n and that any sidelink positioning/ranging measurement
and calculation of location results may require interaction between UEs 1 to n
(e.g. using SPRF).
8\. If sidelink positioning/ranging location results for UEs 1 to n are needed
and were not provided to the LMF as part of step 7, the LMF performs sidelink
positioning/ranging of UEs 1 to n as in steps 5-13 of Figure 6.19.3.2-1.
9\. The LMF sends an event report to the LCS Client or AF as in steps 28-30 in
clause 6.3.1 of TS 23.273 [11] and includes any sidelink positioning/ranging
location results obtained at step 7 or step 8. If sidelink positioning/ranging
location results are provided for only some of UEs 1 to n (e.g. in several
successive event reports), the GMLC or LCS Client or AF may cancel the
periodic or triggered sidelink positioning/ranging as in clause 6.3.3 of TS
23.273 [11] with some additional steps to propagate the cancellation to the
other UEs 2 to n.
10\. Steps 7-9 are repeated until the periodic or triggered sidelink
positioning/ranging is cancelled or has attained a maximum duration or maximum
number of event reports.
### 6.19.4 Impacts on services, entities, and interfaces
UE supporting Sidelink Positioning and Ranging services need to support the
following new service functions:
\- DSDF;
\- GSSF;
\- SPRF.
No change to the existing AS layer PC5 communication service.
NOTE 1: Security protection of signaling for DSDF, GSSF, and SPRF needs to be
reviewed by SA WG3.
V2X UE supports new non-IP header type value for SR5 signalling.
NOTE 2: RAN WGs will determine the necessary AS layer enhancement for Sidelink
Positioning or Ranging reference signal transmission and measurements.
NOTE 3: New QoS parameters, e.g. default PPPP level or standardized PQI, may
need to be specified for the DSDF, GSSF, SPRF signaling.
An LMF may assist sidelink positioning/ranging for a group of UEs to support
an MO-LR, where the positioning/ranging is instigated by a UE, an MT-LR where
positioning/ranging location results for a group of UEs are requested by an
LCS Client or AF, and periodic or triggered MT-LR where an LCS Client or AF
requests periodic or triggered positioning/ranging location results for a
group of UEs. LMF assistance may reduce impacts to UEs - e.g. by allowing an
LMF to provide assistance data to the UEs and/or calculate positioning/ranging
location results for the UEs.
## 6.20 Solution #20: Network assisted Sidelink positioning with scheduled
location time and local co-ordinates
### 6.20.1 General
This solution relates to the KI#5. The scheduled location time defined in TS
23.273 [11] is used to get the Ranging/Sidelink positioning measurement data
and the location of the Located UE at a same time, to achieve more accurate
positioning of the target UE.
### 6.20.2 Functional descriptions
This solution addresses KI#5 and the following principles are used:
\- The positioning target UE (UE1) is within the network coverage or out of
network coverage.
\- Both MT-LR procedure and MO-LR procedure as specified in clause 6.1 of TS
23.273 [11] are supported.
\- When the LMF received the Located UE ID from the UE1, the LMF triggers a
new positioning procedure for the Located UE with a scheduled location time,
and triggers the UE1 to perform Ranging/Sidelink positioning with the Located
UE at the same scheduled location time.
\- The UE1 performs Ranging/Sidelink positioning with the Located UE based on
the scheduled location time and provides the Ranging/Sidelink positioning
measurements data to the LMF.
\- Based on the position of the Located UE and the Ranging/Sidelink
positioning measurement data between UE1 and Located UE, the LMF or UE1 can
calculate the UE1 position in a more precise way.
### 6.20.3 Procedures
#### 6.20.3.0 Located UE discovery for a specific coordination system
5GS supports UE location determination in Local Co-ordinates [11]. To obtain
the UE location for a specific coordinate system, the identification of a
coordinate system, i.e. Coordinate ID shall be provided to the LMF by the LCS
client/AF, considering the LMF may serve multiple factories or vertical sites
and corresponding systems. The LMF also includes the Coordinate ID in the
request to the Target UE.
When Target UE decides to perform discovery procedure to find a Located UE for
Network assisted sidelink positioning, the Coordinate ID is used as a filter
for Located UE selection if received from LMF. The located UEs are configured
and associated with certain coordinate systems represented by coordinate IDs.
When the Target UE broadcasts the discovery request including a Coordinate ID,
the located UE in proximity sends a response if it matches the broadcast
Coordinate ID, and then the discovery procedure completes.
NOTE 1: alternatively, LMF may determine the ID of the Located UE in network
assisted sidelink positioning. In that case, when the LMF receives a request
including a Coordinate ID indicating to obtain the Target UE location under a
certain local coordinate system, the LMF selects a located UE corresponding to
the requested Coordinate ID (the LMF may be preconfigured with a mapping
between different located UEs and coordinate IDs).
#### 6.20.3.1 MT-LR procedure for Network assisted Sidelink positioning in
Network Coverage case
Figure 6.20.3.1-1: MT-LR procedure for Network assisted Sidelink positioning
in Network Coverage case (UE1 is in Network Coverage)
1\. MT-LR procedure is triggered and UE1 LMF receives a location request for
UE1 as specified in clause 6.1 of TS 23.273 [11]. The location request may
include a scheduled location time (Time T).
2\. UE1 LMF decides to use the network assisted Sidelink positioning for UE1,
for example, UE1 has the sidelink capability or UE1 is authorized to use
sidelink positioning, or the requested LCS QoS is not satisfied by the
previous LCS positioning procedure. UE1 LMF triggers the discovery of a
Located UE for positioning assistance.
NOTE 1: LMF can decide when to send the request of step 2 based on the Time T,
so that the discovery time in step 3 will not be a long time compared to Time
T.
3\. UE1 performs the Located UE discovery, using the procedure defined by the
solutions for KI#3. UE2 is discovered and selected as the Located UE.
4\. The UE1 sends UE2 ID to UE1 LMF.
NOTE 2: What the UE2 ID is and its security aspect need the coordination with
SA WG3.
5\. UE1 LMF triggers the location procedure for UE2 and sends a Provide
Location Request to GMLC. The request message includes the Time T.
6\. GMLC triggers the procedure for UE2 positioning, as specified in clause
6.1 of TS 23.273 [11], and gets the UE2 location at Time T.
7\. GMLC responses UE2 location to UE1 LMF.
8\. UE1 LMF sends UL Positioning message to the UE1 with the Time T.
NOTE 3: Step 8 can be triggered at the same time of step 5.
9\. UE1 performs Ranging/Sidelink positioning procedure with UE2 defined by
the solutions for KI#3, and obtains the Ranging/Sidelink positioning
measurement data at the Time T.
10\. UE1 provides the Ranging/Sidelink positioning measurement data to the UE1
LMF.
11\. UE1 LMF determines the UE1 location based on the Ranging/Sidelink
positioning measurement data received in step 10 and UE2 location received in
step 7.
This solution can apply to multiple Located UEs case. If multiple Located UEs
are discovered and selected in step 3, then these Located UE IDs are sent to
UE1 LMF in step 4, and the step 5-7 are performed individually for each
Located UE. In step 9, Ranging/Sidelink positioning procedure is performed for
each Located UE. In step 11, UE1 LMF determines the UE1 location based on the
Ranging/Sidelink positioning measurement data with each Located UE received in
step 10 and each Located UE location in step 7.
#### 6.20.3.2 MO-LR procedure for Network assisted Sidelink positioning in
Network Coverage case
Figure 6.20.3.2-1: MO-LR procedure for Network assisted Sidelink positioning
in Network Coverage case (UE1 is in Network Coverage)
1\. UE1 performs the Located UE discovery for positioning assistance, using
the procedure defined by the solutions for KI#3. UE2 is discovered and
selected as Located UE.
2\. MO-LR procedure is triggered, and UE1 sends MO-LR Request to UE1 LMF,
including UE2 ID and a scheduled location time (Time T).
NOTE 1: What the UE2 ID is and its security aspect need the coordination with
SA WG3.
3\. UE1 LMF triggers the location procedure for UE2 and sends a Provide
Location Request to GMLC. The request message includes the Time T.
4\. GMLC triggers the procedure for UE2 positioning, as specified in clause
6.1 of TS 23.273 [11], and gets the UE2 location at Time T.
5\. GMLC responses UE2 location to UE1 LMF.
6\. UE1 LMF sends UL Positioning message to the UE1.
NOTE 2: Step 6 can be triggered at the same time of step 3.
7\. UE1 performs Ranging/Sidelink positioning procedure with UE2 defined by
the solutions for KI#3, and obtains the Ranging/Sidelink positioning
measurement data at the Time T.
NOTE 3: Step 7 can be triggered by UE1 itself based on the Time T.
8\. UE1 provides the Ranging/Sidelink positioning measurement data to the UE1
LMF.
9\. UE1 LMF determines the UE1 location based on the Ranging/Sidelink
positioning measurement data received in step 8 and UE2 location received in
step 5.
10\. UE1 LMF sends MO-LR Response to UE1 including the UE1 location.
This solution can apply to multiple Located UEs case. If multiple Located UEs
are discovered and selected in step 1, then these Located UE IDs are sent to
UE1 LMF in step 2, and the step 3-5 are performed individually for each
Located UE. In step 7, Ranging/Sidelink positioning procedure is performed for
each Located UE. In step 9, UE1 LMF determines the UE1 location based on the
Ranging/Sidelink positioning measurement data with each Located UE received in
step 8 and each Located UE location in step 5.
#### 6.20.3.3 MO-LR procedure for Network assisted Sidelink positioning in
Partial Coverage case
Figure 6.20.3.3-1: MO-LR procedure for Network assisted Sidelink positioning
in Partial Coverage case (UE1 is out of Network Coverage, UE2 is in Network
Coverage)
1\. UE1 performs the Located UE discovery for positioning assistance, using
the procedure defined by the solutions for KI#3. After the discovery
procedure, UE2 is discovered and selected as Located UE.
2\. UE1 requests the UE2 location at a scheduled location time (Time T).
3\. MO-LR procedure is triggered, as specified in clause 6.2 of TS 23.273
[11], with the Time T.
4\. UE2 responses the UE2 location at Time T to UE1.
NOTE 1: UE1 and UE2 can set up a PC5 link before step 2 then the UE2 location
can be transmitted over the encrypted PC5 link.
5\. UE1 performs Ranging/Sidelink positioning procedure with UE2 defined by
the solutions for KI#3, and obtains the Ranging/Sidelink positioning
measurement data at the Time T.
NOTE 2: Step 5 is triggered by UE1 itself based on the Time T, not by step 4.
6\. UE1 determines the UE1 location based on the Ranging/Sidelink positioning
measurement data received in step 5 and UE2 location received in step 4.
This solution can apply to multiple Located UEs case. If multiple Located UEs
are discovered and selected in step 1, then the request is sent to each
Located UE in step 2, and the step 3 is performed individually for each
Located UE. In step 5, Ranging/Sidelink positioning procedure is performed for
each Located UE. In step 6, UE1 determines the UE1 location based on the
Ranging/Sidelink positioning measurement data with each Located UE received in
step 5 and each Located UE location in step 4.
#### 6.20.3.4 MT-LR procedure for Network assisted Sidelink positioning with
Target UE out of coverage
Figure 6.20.3.4-1: MT-LR procedure for Network assisted Sidelink positioning
with Target UE out of coverage (UE1 is out of Network Coverage, UE2 is in
Network Coverage)
1\. MT-LR procedure is triggered by LCS client as specified in clause 6.1 of
TS 23.273 [11]. The LCS request may include a target area that the target UE
(i.e., UE1) presents.
2\. When GMLC does not get the Target UE\'s AMF address from UDM or get the
unreachable indication from Target UE\'s AMF, GMLC determines to use Network
assisted sidelink positioning to locate the target UE.
3\. GMLC selects a Located UE (i.e., UE2) based on the target area. It assumes
that a list of Located UEs can be configured in GMLC, and their locations can
be also configured for static UEs or obtained via NI-LR procedure.
4\. GMLC triggers the LCS procedure of Located UE defined in TS 23.273 [11] to
get the location of the Target UE.
5\. The Located UE performs the discovery of Target UE.
NOTE 1: Step 3-5 may be repeated until the GMLC has tried all the Located UE
in the list or until one Located UE discovers the Target UE.
6\. The Target UE and Located UE perform ranging/SL positioning, as defined in
KI#4
7\. The located UE reports the ranging/SL positioning measurement data to LMF.
8\. The LMF uses the location of the Located UE together with the ranging/SL
positioning measurement data or result reported by the Located UE to estimate
the location of the Target UE. The LMF provides the location estimate to the
Located UE\'s AMF which forwards it to the GMLC according to legacy
functionality.
NOTE 2: How to perform privacy check needs coordination with SA3.
### 6.20.4 Impacts on services, entities, and interfaces
**UE:**
\- Support Ranging and Sidelink positioning.
\- Support the calculation of the UE location based on Ranging/Sidelink
positioning measurement data and the location of the Located UE.
**LMF:**
\- Support the calculation of the UE location based on Ranging/Sidelink
positioning measurement data and the location of the Located UE.
\- Trigger the Located UE positioning and Ranging/Sidelink positioning at same
time.
**GMLC:**
\- Determine to use Network assisted sidelink positioning to locate the target
UE.
\- Select a Located UE based on the target area.
## 6.21 Solution #21: Network assisted sidelink positioning for partial
coverage
### 6.21.1 General
This solution is to address KI#5.
A UE out of coverage may be a UE not registered to the network or a UE
temporarily unreachable. It may be in a known area, e.g. a factory or a
campus, or not be in a known area, an application server may want to know its
accurate location.
When a UE is out of coverage, positioning directly over Uu is not possible,
communication between the UE and 5GC is not possible, either.
When 5GC determines that a UE is out of network coverage, it can consider to
use Network assisted Sidelink Positioning to estimate UE location.
Since Network assisted Sidelink Positioning requires Ranging/Sidelink
positioning between the UE and a Located UE, a Located UE needs to be
determined. Located UE has to be in proximity of the UE out of coverage;
however, UE should not be assumed to proactively discover a Located UE,
because it doesn\'t know when a location service request comes.
### 6.21.2 Functional descriptions
A location service request for a UE may be sent to GMLC by an application
server (via NEF) or a LCS client, and GMLC forwards the service request to an
AMF. The serving AMF needs to be determined by the GMLC when UE is out of
coverage.
UE out of coverage can be determined by GMLC or AMF, who will then triggers
Network assisted Sidelink Positioning to locate a UE based on serving AMF
address retrieval result or paging result:
Case 1: When GMLC retrieves AMF address from the UDM with SUPI of this UE and
no network address of the current serving AMF is returned.
Case 2: When UE\'s serving AMF identifies that UE is in CM-IDLE state and
paging couldn\'t be successful.
For Case 1, if Application server knows about the target area the UE is
present, it provides in the LCS service request the target area to the GMLC,
and the GMLC maps the target area into Cell ID/gNB ID/TAI and derives the
serving AMF which can serve that area.
For Case 2, serving AMF is determined based on the successful retrieval of AMF
address from the UDM.
The serving AMF of the UE/target area is responsible for discovery/selection
the Located UE, which can be achieved in 2 steps:
1\. Provision of Located UE candidates: AMF may be preconfigured with list of
Located UE, assuming those Located UE are nomadic, or if UE provides its
capability of being Located UE during registration, AMF stores it into UE
contexts. AMF selects Located UE candidates from the preconfigured list or
based on UE capability.
2\. Selecting serving Located UE(s) from the list of Located UE candidates: If
target area is provided, AMF selects one or multiple Located UE(s) based on
the target area identified by Cell ID/gNB ID/TAI. If last known cell ID of the
target UE is provided, AMF selects one or multiple Located UE(s) based on the
cell ID.
The AMF then selects an LMF supporting Network assisted Sidelink Positioning
as the serving LMF of the selected Located UE and sends the LCS service
request to the LMF with providing UE ID and one or multiple Located UE ID.
When both UE ID and one or multiple Located UE ID are received, the LMF
performs Network assisted Sidelink Positioning, including:
\- Discovery of the UE by the one or multiple Located UE over PC5. LMF can
decide to stop discovery when one or multiple Located UE has reported
successfully discovery of the UE.
\- Measurement and deriving UE location from:
\- Ranging/Sidelink positioning result/measurement data between UE and one or
multiple Located UE.
\- Uu positioning result/measurement data of one or multiple Located UE.
### 6.21.3 Procedures
6.21.3.2-1: Procedure of network assisted sidelink positioning for partial
coverage
0\. Located UE provides its Network assisted Sidelink positioning capability
in the registration request to the AMF, and AMF stores it in the UE context.
1\. GMLC receives a LCS service request from the AF/LCS client, the request
may include a target area the UE presents. GMLC checks service authorization
and privacy with UDM.
2\. GMLC retrieves serving AMF of target UE from UDM. If no AMF address is
returned and a target area is provided in the LCS service request, GMLC
determines to use Network assisted sidelink positioning to locate the target
UE. GMLC maps the target area into Cell ID/gNB ID/TAI, based on which derives
the serving AMF which can serve that area as the serving AMF of the Located
UE. If an AMF address is returned, GMLC selects the AMF as the serving AMF of
the target UE.
3\. GMLC sends the LCS service request to the selected AMF, which includes the
Cell ID/gNB ID/TAI of the target area if it is available.
NOTE: When the AMF is derived based on Cell ID/gNB ID/TAI identifying the
target area and multiple AMFs are derived, the LCS service request may be sent
to some or all AMFs.
4\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure as defined in clause 4.2.3.3 of TS 23.502 [9] to
establish a signalling connection with the UE. When the AMF is derived based
on Cell ID/gNB ID/TAI identifying the target area, no UE state is available,
this step is skipped.
5\. If the UE couldn\'t be successfully paged at step 4, AMF determines to
invoke network assisted sidelink positioning to locate the UE. AMF selects one
or multiple Located UE based on UE capability, cell ID/gNB ID/TAI of the
target area, the last known cell ID of the target UE and the pre-configuration
information.
6\. AMF selects a LMF capable of network assisted sidelink positioning.
7\. AMF sends the LCS service request to the LMF which includes target UE ID
and one or multiple Located UE ID(s)
Editor\'s note: The security issue, e.g. whether the selected list of Located
UE is allowed to have the Ranging/SL positioning information of the target UE,
is FFS, which will be evaluated in SA WG3.
8\. When both UE ID and one or multiple Located UE ID(s) are received in the
LCS service request, LMF sends the Ranging/Sidelink positioning request to one
or multiple Located UE(s) to trigger the Ranging/Sidelink positioning
procedure.
9\. Located UE triggers the Ranging/Sidelink positioning procedure, which
includes the discovery and service operation procedure over PC5.
10\. Located UE reports the Ranging/Sidelink positioning measurement or result
to the LMF. LMF may receive measurement or result reporting from multiple
Located UEs, LMF can determine whether to stop the further reporting from
other Located UEs based on QoS requirement or pre-configuration.
11\. LMF triggers one or multiple procedures for the positioning of one or
multiple Located UE. The LCS location estimation for the UE is generated based
on the Ranging/Sidelink positioning result/measurement data between UE and one
or multiple Located UE and Uu positioning result/measurement data of one or
multiple Located UE.
12\. LMF provides the LCS location estimation of the UE to the GMLC.
13\. GMLC provides the LCS location estimation of the UE to the AF or LCS
client.
### 6.21.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: supports Ranging/SL Positioning; provides capability of being Located
UE to the AMF.
\- AMF: receives UE capability of Located UE and stores them; discovers and
selects Located UE; determines to trigger network assisted sidelink
positioning.
\- GMLC: determines serving AMF based on target area; determines to trigger
network assisted sidelink positioning.
\- LMF: triggers the Ranging/Sidelink positioning procedure; derives UE
location estimation based on Ranging/Sidelink positioning and Uu location
measurements.
\- AF: provides target area in a LCS request.
## 6.22 Solution #22: Combine Uu positioning capability and/or Ranging/SL
positioning capability for the Ranging/SL positioning service
### 6.22.1 General
This solution is related to the Key Issue #6 and Key Issue #7.
### 6.22.2 Functional descriptions
The LMF combines the Uu positioning capability and Ranging/Sidelink
Positioning capability together to satisfy the Ranging/SL positioning service,
which may improve the accuracy, enable Ranging/SL positioning service even
when one UE lacks Uu/PC5 capabilities, enable Ranging/SL positioning service
even when one UE is out-of-coverage, etc.
### 6.22.3 Procedures
{width="6.25in" height="4.423611111111111in"}
Figure 6.22.3-1: Procedure for the Ranging/SL positioning service
1\. The AF (Step 1a) or SL Positioning Client UE (Step 1b) requests the
network for the Ranging/SL positioning service between the UE1 and UE2. The
Ranging/SL positioning requirement may include the service requirement
regarding Ranging/SL positioning demand (i.e. the distance and/or the
direction between two UEs or more UEs), delay, accuracy, result feedback mode
(e.g. immediately, periodically or at a later time). The UEs may be identified
by GPSIs or SUPIs. If the GPSI is used, the AMF will request UDM to provide
the associating SUPI.
2\. When the AMF receives the Ranging/SL positioning service request from UE
or AF via GMLC, it sends Ranging/SL positioning Request (UE1 ID, UE2 ID,
service requirement) to the LMF. The AMF is the serving AMF of SL Positioning
Client UE if the request is sent from the SL Positioning Client UE, or the AMF
is the serving AMF of the initiator UE (i.e. UE1/UE2, which is used to perform
signalling exchange with the LMF, and the initiator UE may be selected by GMLC
or indicated by AF) if the request is sent from AF.
3\. The LMF determines the appropriate positioning methods based on the
service requirements, UE capability (e.g. whether UE has the Uu capability/PC5
capability), UE current status (e.g. reachable or unreachable, CM-CONNECTED or
CM-IDLE) and operator policy. The positioning methods can be Uu positioning,
Ranging/SL positioning, or both.
4\. The LMF initiates the Ranging/SL positioning between UE1 and UE2 if
selected. The initiator UE reports the Ranging/SL positioning measurements to
the LMF for calculation. When the Ranging/SL positioning calculation is
performed by UE, the Ranging/SL positioning result is returned.
5a. The LMF initiates Uu positioning for UE2 if selected.
5b. The LMF initiates Uu positioning for UE1 if selected.
NOTE: LMF also needs to query UDM to locate the AMFs of the UEs (UE-1 and UE2)
in order to perform the positioning for both.
6\. The LMF performs the final calculation based on the Ranging/SL positioning
result and/or Uu positioning result, i.e. calculates from UE1 Uu positioning
result and UE2 Uu positioning result, when step 5a and step 5b are initiated;
or calculates from UE1 Uu positioning result, UE2 Uu positioning result,
Ranging/SL positioning result between UE1 and UE2, when step 5a, step 5b, and
step 6 are initiated.
7\. The LMF sends Ranging/SL positioning Response (Ranging/SL positioning
result) to the AMF.
8\. The AMF returns Ranging/SL positioning Service Response (Ranging/SL
positioning result) to the AF (Step 8a) or SL Positioning Client UE (Step 8b).
### 6.22.4 Impacts on services, entities, and interfaces
**UE:**
\- impacts in Sol#9 and Sol#12.
**NG-RAN:**
\- impacts in Sol#9 and Sol#12.
**AMF:**
\- impacts in Sol#9 and Sol#12.
**LMF:**
\- impacts in Sol#9 and Sol#12.
\- The LMF determines the appropriate positioning methods based on the service
requirements, UE capability (e.g. whether UE has the Uu capability/PC5
capability), UE current status (e.g. reachable or unreachable, CM-CONNECTED or
CM-IDLE) and operator policy.
## 6.23 Solution #23: Ranging service exposure to server
### 6.23.1 Description
This solution is related to the Key Issue #7 on Ranging/Sidelink Positioning
service exposure to Application server and for network assisted sidelink
positioning.
For the Ranging/Sidelink Positioning service exposure to Application server,
it requires that the 5GS is able to provide the Ranging/Sidelink Positioning
service to the Application server for obtaining the Ranging/Sidelink
Positioning information (e.g. relative distance) between target UEs. To obtain
this requirement, it needs the network assistance. In this solution, the
network assistance can be reflected in the following aspects:
\- Determine the role, i.e. who is Reference UE or Target UE;
\- Provide the Ranging/Sidelink Positioning assistant data;
\- Obtain or calculate Ranging/Sidelink Positioning results.
This solution is more suitable to the case where:
\- the 2 UEs are both under network coverage,
\- the 2 UEs are unable to perform PC5 capability negotiation and Ranging/SL
positioning calculation,
\- the 2 UEs supports Ranging/SL positioning capability negotiation with LMF;
### 6.23.2 Procedures of NW assistant Ranging service exposure to server
Figure 6.23.2-1: High-level procedure of Ranging/Sidelink Positioning with
Model A discovery
This procedure basically takes the 5GC-MT-LR Procedure for the commercial
location service as specified in clause 6.1.2 of TS 23.273 [11] as basis.
1\. AF (via NEF) sends a request to the GMLC for obtaining the
Ranging/Sidelink Positioning information (e.g. relative distance) between 2
UEs with target UE\'s GPSI.
2\. The GMLC invokes the Nudm_SDM_Get service operation towards the UDM of the
2 UEs to get the privacy settings of the UE identified by its GPSI or SUPI.
The UDM returns the target UEs Privacy setting of the UE. The (H)GMLC checks
the UE Ranging/Sidelink Positioning privacy profile. If the 2 UEs are not
allowed to be Ranged/Sidelink Positioned, the following steps 3-11 are
skipped.
3\. The GMLC invokes a Nudm_UECM_Get service operation towards the UDM of the
2 UEs with GPSI or SUPI of the 2 UEs. The UDM returns the network addresses of
the current serving AMF of the 2 UEs.
Editor note: How to handle different AMF and LMF case is FFS.
4\. The GMLC invokes the Namf_Location_ProvideRanging_Sidelink positioningInfo
Rquest service operation towards the AMF to request the Ranging/Sidelink
Positioning information of the 2 UEs.
5\. If the UE is in CM-IDLE, the AMF initiates a network triggered Service
Request procedure as defined in clause 4.2.3.3 of TS 23.502 [9] to establish a
signalling connection with the UE.
6\. If there is privacy check requirement, the UE must either be notified or
notified with privacy verification. The 2 UEs notify its user the
Ranging/Sidelink Positioning request and provide the checked result to the
AMF.
7\. If granted in step6, the AMF perform the LMF selection with supporting
Ranging/Sidelink Positioning capable consideration.
8\. The AMF invokes the Nlmf_Location_Determine Ranging/Sidelink Positioning
service operation towards the LMF to request the Ranging/Sidelink Positioning
information of the 2 UEs.
9\. After receiving the AMF request in step 8, the LMF performs the NW
assistant Ranging/Sidelink Positioning with the 2 UEs with following possible
aspects:
\- LMF obtains the Ranging/Sidelink Positioning capability of the 2 UEs,
similar to the Procedures related to capability transfer in clause 5.1 of TS
37.355 [10];
\- LMF determines the role of the 2 UEs; which one takes the role of Reference
UE, which one takes the role of Target UE.
\- LMF obtain the Ranging/Sidelink Positioning location information, similar
to the Procedures related to Location Information Transfer in clause 5.3 of TS
37.355 [10];
\- LMF calculates the Ranging/Sidelink Positioning result between the 2 UEs.
10\. After performing the NW assistant Ranging/Sidelink Positioning procedure,
the LMF returns the Nlmf_Location_Determine Ranging/Sidelink Positioning
response towards the AMF to return Ranging/Sidelink Positioning result between
the 2 UEs.
11\. The AMF returns the Namf_Location_ProvideRanging_Sidelink positioningInfo
Reponse towards the GMLC return Ranging/Sidelink Positioning result between
the 2 UEs.
12\. The (H)GMLC sends the location service response to the AF (via the NEF)
with the Ranging/Sidelink Positioning result between the 2 UEs.
### 6.23.3 Impacts on Existing Nodes and Functionality
The solution has impacts on the following entities:
LMF:
\- Support NW assistant Ranging/Sidelink Positioning procedure.
AMF:
\- LMF selection with NW assistant Ranging/Sidelink Positioning support.
GLMC:
\- support check the UE privacy profile of supporting Ranging/Sidelink
Positioning.
NEF:
\- support Ranging/Sidelink Positioning service exposure.
UDM:
\- support UE privacy profile of supporting Ranging/Sidelink Positioning
subscription.
UE:
\- Supports the Ranging/SL positioning information negotiation with LMF.
## 6.24 Solution #24: Service initiated by Application server over user plane
### 6.24.1 General
This solution is to address KI#7.
The communication between application server and one of the UEs subject to
Ranging/SL positioning for transmitting the service request and result
reporting can be over user plane when the service request is initiated by the
application server and there\'s already an existing PDU session between
application server and one of the UEs subject to Ranging/SL positioning.
This saves the efforts for retrieving AMF, selecting LMF and the required
signalling (e.g. NAS, signalling between UE and LMF if LMF has to be
involved).
### 6.24.2 Functional descriptions
When the service request is initiated by the application server and there\'s
already an existing PDU session between application server and one of the UEs
subject to Ranging/SL positioning, the application server sends the Ranging/SL
positioning service request to the UE and receives the result from the UE over
application layer.
### 6.24.3 Procedures
Figure 6.24.3-1 Procedure of Service initiated by Application server over user
plane
1\. Service authorization policy/parameters are provisioned to UE1 and UE2.
2\. If there is already a PDU session between application server and UE1, the
Ranging/SL positioning service request is sent to UE1 at application layer,
which includes Reference UE ID, Target UE ID, Result content (distance, angle
or both) and Required QoS, etc.
3\. UE1 initiates Ranging/SL positioning procedure to UE2 to trigger the
measurement and the calculation of the result. The Ranging/SL positioning
procedure includes Ranging/Sidelink positioning discovery and service
operations.
4\. UE1 sends the Ranging/SL positioning result to the AF over application
layer.
Editor\'s note: It is FFS how privacy checking and authorization is performed.
### 6.24.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: supports initiating Ranging/SL Positioning procedure.
## 6.25 Solution #25: Ranging/SL positioning service initiated by SL
Positioning Client UE
### 6.25.1 General
This solution is to address KI#6.
A Ranging/SL positioning service request can be initiated by a UE, which may
be one of the 2 UEs subject to Ranging/SL positioning (i.e. UE1 and UE2) or a
SL Positioning Client UE.
The service request may be initiated by the upper layer of one of the UEs
subject to Ranging/SL positioning (i.e. UE1 and UE2) or may be transmitted
from the SL Positioning Client UE to one of the UEs.
The SL Positioning Client UE can be any UE, which does not have to support
Ranging/SL positioning. It may be in proximity or not in proximity of UE1/UE2.
For the latter case, the SL Positioning Client UE has to transmit the service
request over 5GS network to UE1/UE2, which assumes that both the SL
Positioning Client UE and UE1/UE2 are in 5G coverage.
### 6.25.2 Functional descriptions
When the service request is initiated by the upper layer of UE1/UE2, the
UE1/UE2 triggers the Ranging/SL Positioning discovery and service pperations
to the other UE directly.
NOTE 1: The Ranging/Sidelink positioning discovery and service operations are
assumed to be addressed in the solutions under KI#3 and KI#4.
When the service request is initiated by the SL Positioning Client UE, the
communication between the SL Positioning Client UE and UE1/UE2 for
transmitting the service request and result reporting can be over PC5 or Uu:
\- If the SL Positioning Client is in proximity of UE1/UE2, the service
request and the result reporting are transmitted over PC5;
\- Otherwise, the service request and the result reporting are transmitted
over Uu, i.e. through the network.
The SL Positioning Client UE attempts to discover UE1/UE2:
\- If either UE1 or UE2 is successfully discovered, the SL Positioning Client
UE sends the service request to the discovered UE over PC5;
\- Otherwise, the SL Positioning Client UE sends the service request to one of
the UEs over network.
If the SL Positioning Client UE sends the service request to UE1/UE2 over
network, the SL Positioning Client UE sends the request to its serving AMF,
and the serving AMF of the SL Positioning Client UE needs to select the UE
under network coverage to deliver the service request. The serving AMF of the
SL Positioning Client UE retrieves the serving AMF of UE1/UE2 from the UDM,
and then sends the service request to the selected UE through its serving AMF
over NAS. The selected UE triggers the Ranging/Sidelink positioning procedure.
NOTE 2: The service request will only be sent to one of UE1 or UE2. If both
UE1 and UE2 are in network coverage, i.e. serving AMF address(es) for both UE1
and UE2 can be retrieved from UDM, serving AMF of the SL Positioning Client UE
randomly selects a UE to deliver the service request.
NOTE 3: This solution assumes UE-only Operation can be applied, i.e. SL
Positioning Server functionalities can be provided by UE1, UE2 and/or a SL
Positioning Server UE, hence no LMF involvement is needed.
The Ranging/SL positioning service request includes the following parameters:
\- Application Layer ID of Reference UE.
\- Application Layer ID of Target UE.
\- Result content: distance, angle or both.
\- Required QoS.
Editor\'s note: Whether there are any other parameters in the Ranging/SL
positioning service request is FFS.
GMLC maintains a mapping table between Application Layer ID(s) and SUPI of the
UE. This can be pre-configured by the operator, or is registered by the UE
during UE Policy Association Establishment. For the latter case, during the
registration, UE includes Ranging/SL Positioning Application Layer ID(s) in
the UE Policy Container to the PCF. If the Application Layer ID(s) is
received, PCF registers it together with UE SUPI into the GMLC for later use.
For the case where the SL Positioning Client UE has to send the
Ranging/Sidelink positioning request to the target UE/reference UE via 5GC,
when AMF receives a Ranging/Sidelink positioning request from the SL
Positioning Client UE, it queries GMLC for UE SUPIs based on their Application
Layer IDs contained in the Ranging/Sidelink positioning request, and then
continues with the following steps.
Editor\'s note: It is FFS whether it is possible that the mapping table
between Application Layer ID(s) and SUPI of the UE can be managed by other 5GC
NF.
### 6.25.3 Procedures
#### 6.25.3.1 PC5 based procedure for Ranging/SL positioning initiated by the
SL Positioning Client UE
This procedure applies to the use cases where the SL Positioning Client UE is
in proximity of UE1/UE2.
This procedure assumes UE-only Operation can be applied, i.e. SL Positioning
Server functionalities can be provided by UE1, UE2 and/or a SL Positioning
Server UE.
In this procedure, the SL Positioning Client UE, initiates the service request
for Ranging/SL positioning between UE1 and UE2.
If the SL Positioning Client UE and UE1 are the same UE, i.e. the service
request is initiated from upper layer of UE1, then step 2, 3 and 8 can be
skipped.
6.25.3.1-1: PC5 based procedure for Ranging/SL positioning initiated by SL
Positioning Client UE
1\. Service authorization policy/parameters are provisioned to the UE1 and
UE2.
2\. The SL Positioning Client UE initiates Ranging/SL positioning device
discovery procedure to discover either UE1 or UE2, and one of them is
successfully discovered, e.g. UE1. This step is skipped in the following
scenarios:
\- There is existing communication between the SL Positioning Client UE and
UE1.
\- The SL Positioning Client UE and UE1 are the same UE, i.e. the service
request is initiated from upper layer of UE1.
NOTE 1: It is also possible that UE2 is discovered. In this solution, UE1
represents the UE that the SL Positioning Client UE decides to send the
service request to.
NOTE 2: Device discovery follows the solution developed under KI#3.
3\. The SL Positioning Client UE sends the Ranging/SL positioning service
request to UE1, including Application Layer ID of UE1 and UE2, Result content
(distance, angle or both) and Required QoS, etc.
4\. UE1 initiates device discovery procedure. UE1 and UE2 are discovered.
NOTE 3: Device discovery follows the solution developed under KI#3.
5\. UE1 sends the service request to UE2.
If UE1 is the Target UE, it checks with its privacy information stored locally
to verify the service request:
\- If all the privacy requirements are satisfied (e.g. UE2 is allowed to act
as Reference UE and the SL Positioning Client UE is allowed to receive the
result of Ranging/SL Positioning between UE1 and UE2), the service request is
verified;
\- Otherwise, UE1 rejects the service request.
If UE1 is the SL Reference UE, it sends the service request to UE2, the Target
UE, and UE2 checks with its privacy information to verify the service request:
\- If all the privacy requirements are satisfied (e.g. UE1 is allowed to act
as Reference UE and the SL Positioning Client UE is allowed to receive the
result of Ranging/SL Positioning between UE1 and UE2), the service request is
verified;
\- Otherwise, UE2 rejects the service request
UE2 indicates the service request verification result to UE1.
6\. UE1 and UE2 determines who performs the SL Positioning Server
functionalities by exchanging their capability. If SL Positioning Server
functionalities are neither supported by UE1 nor by UE2, a SL Positioning
Server UE needs to be selected by either UE1 or UE2.
UE1/UE2 discovers the candidate SL Positioning Server UE(s). UE1 and UE2
performs privacy checking to decide whether a candidate SL Positioning Server
UE is allowed to act as the SL Positioning Server UE for the Ranging/SL
Positioning between the UE1 and UE2. A verified SL Positioning Server UE is
selected.
7\. UE1 initiates Ranging/SL positioning procedure to UE2 to trigger the
measurement and the calculation of the result. Application Layer ID of UE1 and
UE2 are used for the communication between UE1 and UE2 over PC5.
8\. UE1 sends the Ranging/SL positioning result of UE1 and UE2 to the SL
Positioning Client UE in the response.
#### 6.25.3.2 Network based procedure for Ranging/SL positioning initiated by
SL Positioning Client UE (without involving LMF)
In this procedure, the SL Positioning Client UE initiates the service request
for Ranging/SL positioning between UE1 and UE2.
This procedure applies to the use case where the SL Positioning Client UE is
not in proximity of either UE1 or UE2 and both of the SL Positioning Client UE
and UE1/UE2 are under network coverage.
This procedure assumes that UE1 and UE2 are capable of handling
Ranging/Sidelink positioning measurement and result calculation.
6.25.3.2-1: Network based procedure for Ranging/SL positioning initiated by SL
Positioning Client UE (without LMF involvement)
1\. Service authorization policy/parameters are provisioned to the UE1 and
UE2.
2\. The SL Positioning Client UE failed in discovering UE1 and UE2 over PC5.
The SL Positioning Client UE sends the Ranging/SL positioning service request
to its serving AMF, i.e. AMF3, including Application Layer ID of UE1 and UE2,
Result content (distance, angle or both) and Required QoS, etc.
3\. AMF3 selects a GMLC based on local configuration or by querying the NRF to
get GMLC address. AMF3 queries GMLC for SUPI of UE1 and UE2 based on their
Application Layer IDs.
Editor\'s note: It is FFS how AMF3 selects the right GMLC(s) managing
Application Layer ID and SUPI mapping of UE1&UE2, if multiple GMLCs are
deployed.
4\. AMF3 checks UDM to acquire the serving AMF of UE1/UE2. If serving AMF
address of UE1, i.e. AMF1, is retrieved, AMF3 sends the Ranging/SL positioning
service request to AMF1, including SUPI value of UE1&UE2 as well as their
Application Layer IDs.
NOTE 1: It is also possible that serving address of UE2, is retrieved. In this
solution, AMF1 represents the AMF that AMF3 decides to send the service
request to.
5\. AMF1 checks the privacy of UE1 and UE2 based on their SUPIs to see if the
SL Positioning Client UE is allowed to have the Ranging/SL positioning
information of UE1 and UE2.
Editor\'s note: How AMF1 performs service authorization and privacy checking
will be developed by SA3.
6\. AMF1 sends the Ranging/SL positioning service request to UE1 over NAS,
including UE1 and UE2\'s Application Layer IDs.
7\. UE1 initiates Ranging/SL positioning procedure to UE2 to trigger the
measurement and the calculation of the result.
NOTE 2: The Ranging/SL positioning procedure includes Ranging/Sidelink
positioning discovery and service operations. Whether DDNMF is involved is
determined by the solution developed under KI#3.
8\. UE1 sends the Ranging/SL positioning result to the AMF1 in the response.
9\. AMF1 forwards the Ranging/SL positioning result to the AMF3 in the
response.
10\. AMF3 forwards the Ranging/SL positioning result to SL Positioning Client
UE in the response.
#### 6.25.3.3 Ranging/SL positioning Application Layer ID registration
6.25.3.3-1: Ranging/SL positioning Application Layer ID registration
1\. PCF receives from UE the list of Ranging/SL Positioning Application Layer
ID(s) corresponding to the application(s) in the UE Policy Container contained
in the Npcf_UEPolicyControl Create Request during UE Policy Association
Establishment.
Editor\'s note: Whether there is security issue, e.g. A malicious UE may
hijack any other UE\'s service by registering other UE\'s application layer
ID, will be evaluated and studied by SA WG3.
Editor\'s note: How UE obtains the list of Ranging/SL Positioning Application
Layer ID(s) corresponding to the application(s) during and after UE Policy
Association Establishment is FFS.
2\. PCF registers the UE SUPI and the list of Ranging/SL Positioning
Application Layer ID(s) relationship into GMLC.
3\. GMLC stores the UE SUPI and Ranging/SL Positioning Application Layer ID
relationship, and responds PCF.
### 6.25.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: supports initiating Ranging/SL Positioning procedure; receives
Ranging/SL Positioning service request from AMF or the SL Positioning Client
UE; sends Ranging/SL Positioning result to AMF or the SL Positioning Client
UE.
\- AMF: receives and forwards the Ranging/SL Positioning service request to
the UE1; receives and forwards the Ranging/SL Positioning result to the SL
Positioning Client UE; SUPI query
\- GMLC: SUPI query and Application Layer ID registration
\- PCF: Application Layer ID registration
\- NAS: supports transmission of Ranging/SL Positioning service request and
Ranging/SL Positioning result.
\- PC5: supports transmission of Ranging/SL Positioning service request and
Ranging/SL Positioning result.
## 6.26 Solution #26: Functional Split and Positioning Protocol for SL
Positioning
Editor\'s note: This clause describes a solution addressing one or more key
issues identified in clause 5. The structure of the clauses can be adjusted.
The list of key issues which this solution attempts to resolve should be
clearly indicated.
### 6.26.1 General
This solution proposes a functional split and positioning protocol to enable
the support of Sidelink (SL) positioning (and Ranging). It is relevant to:
KI#2, KI#3, KI#4, KI#5, KI#6, KI#7. This solution is proposed in the form of
architectural requirements to implement the proposed functional split and
positioning protocol.
In the following the term \"Location Server\" is used either:
\- As a generic term, therefore applicable to any of the following qualified
terms; or
\- As a qualified term:
\- SL Positioning Server UE: residing in the UE
\- Location Server Platform: referring to a SUPL Location Platform (SLP) i.e.
accessible via user plane
\- Location Server NF: residing in the network and accessible via control
plane signalling i.e. LMF
In 5GS, the Location Server, whether in the user-plane (Platform) or in the
control-plane (NF) is a \"network\" entity that does not reside in a UE. With
SL positioning and Ranging aiming at enabling UE-only Operation without
necessarily having any network involvement, the current architecture is not
sufficient.
To perform a Ranging/SL Positioning procedure, the following functionalities
have to be supported
\- PRS measurement
\- Co-ordination and scheduling of resources required for Ranging/SL
Positioning
\- Determine type and number of Ranging/SL Position methods- Result
calculation
Some of the above functionalities are mandatory for Target UE and SL Reference
UE. However, the Target UE and SL Reference UE in a Ranging/SL Positioning
session is not assumed to be capable of supporting all those functionalities.
In that case, a SL Positioning Server UE needs to be involved for UE-Only
Operation, who can provide the required functionalities missing from Target UE
and SL Reference UE in a Ranging/SL Positioning session. The Target UE or the
SL Reference UE selects a SL Positioning Server UE after capability exchange.
This solution therefore proposes that
\- the functionality offered towards the UE by a Location Server can also
reside in a UE able to host such functionality as not all UEs supporting SL
positioning may be able to position themselves; and
\- a Positioning Protocol be defined that can operate;
\- between a Target UE and a SL Positioning Server UE (if a Target UE needs
assistance from a SL Positioning Server UE);
\- between a SL Positioning Server UE and a Reference UE, so the SL
Positioning Server UE can gain additional reference information to help
position a Target UE (similar to a Location Server NF getting information from
base stations);
\- between a Target UE and a Reference UE, at least for the case when a Target
UE need not rely on a SL Positioning Server UE to position itself.
It is also important to consider that SL Positioning or Ranging can operate
with a Location Server Platform/NF. Synergies must therefore be sought between
UE-only Operation and Network-Assisted operation in terms of the related
Positioning Protocol.
### 6.26.2 Functional Split
The following architectural requirements are proposed:
\- A UE supporting SL positioning may support functionality to act as a SL
Positioning Server UE, for positioning of Target UE(s). A SL Positioning
Server UE supports the following functionalities:
\- method determination;
\- assistant data distribution;
\- Result calculation.
\- The SL Positioning Server UE functionalities may be supported by the Target
UE and/or the SL Reference UE.
\- A Target UE supporting SL positioning may require assistance from a
Location Server.
\- A Target UE supporting SL positioning may require reference information
from Reference UE(s).
\- A SL Positioning Server UE may require reference information from Reference
UE(s).
### 6.26.3 Positioning Protocol
\- A Sidelink Positioning Protocol (hereafter \"RSPP\" - the term is
introduced in Solution #4) shall be defined to support SL Positioning.
\- A UE supporting SL Positioning shall support RSPP:
\- this UE may be a Target UE, a Reference UE or a SL Positioning Server UE.
\- A Location Server supporting SL Positioning shall support RSPP.
\- RSPP shall be able to operate between a Target UE and a Location Server,
whether the Location Server is hosted by a UE or a network entity (i.e. NF or
Platform).
\- RSPP shall be able to operate between a Target UE or SL Positioning Server
UE, and a Reference UE (see note 1).
NOTE 1: Operation with a Reference UE requires that RSPP also incorporate
functions analogous to those offered today by the NRPPa protocol for the
delivery of Reference UE configurations/measurements to the SL Positioning
Server UE, and by the RRC protocol for the control of reference signal
transmission/measurements between the Target UE and the Reference UE. Details
are under RAN WG responsibility.
NOTE 2: RSPP should be defined as a \"standalone\" extension of LPP i.e. RSPP
can be supported (esp. in a SL Positioning Server UE) without having to
support the entire LPP, while Location Servers (NF/Platform) already
supporting LPP can be upgraded with the RSPP extension. The definition of RSPP
is under RAN WG responsibility.
\- RSPP shall be able to operate securely over the User-Plane between a Target
UE and a Location Server Platform.
\- RSPP shall be able to operate over the Control-Plane between a Target UE
and a Location Server NF (LMF).
\- RSPP operating between two endpoint UEs shall operate over PC5-S between
these endpoints i.e.:
\- between a Target UE and a SL Positioning Server UE;
\- between a Target UE or a SL Positioning Server UE and a Reference UE.
Editor\'s note: PC5-U could be considered instead of PC5-S.
\- Should a Relay UE be necessary for a Target UE to communicate with a
Location Server, the Relay UE shall not be required to support SL positioning
or RSPP.
### 6.26.4 Impacts on services, entities, and interfaces
UE:
\- Support of RSPP.
\- Optional support of Location Server functionality i.e. SL Positioning
Server UE.
\- When operating as a Target UE:
\- Ability to require assistance from a Location Server if necessary;
\- Ability to require reference information from Reference UE(s).
\- Ability to support SL Positioning Server UE functionalities.
\- When operating as a SL Positioning Server UE:
\- Ability to receive measurement data, location information from a Target UE;
\- Ability to require reference information from Reference UE(s);
\- Ability to provide assistance data to a Target UE.
\- Ability to determine Ranging/SL Position method.
\- Ability to perform result calculation.
\- When operating as a Reference UE:
\- Ability to provide reference information to a SL Positioning Server UE or a
Target UE upon request from these UEs.
\- Ability to support SL Positioning Server UE functionalities.
LMF:
\- Support of RSPP.
\- Ability to receive measurement data, location information from a Target UE.
\- Ability to provide assistance data to a Target UE.
\- Ability to determine Ranging/SL Position method.
\- Ability to perform result calculation.
SUPL SLP:
\- Support of RSPP.
\- Ability to receive measurement data, location information from a Target UE.
\- Ability to provide assistance data to a Target UE).
\- Ability to determine Ranging/SL Position method.
\- Ability to perform result calculation.
\- Ability to select SL Reference UE/Located UE.
NOTE: RSPP, measurement data, reference information and assistance data are
for RAN WGs to define.
## 6.27 Solution #27: LMF selection for Ranging/Sidelink positioning
### 6.27.1 General
This solution is to address KI#2, KI#3, KI#4, KI#5, KI#6, and KI#7, where LMF
is involved for Ranging/SL positioning.
In some Ranging based service and sidelink positioning exposure solutions and
network assisted sidelink positioning solutions, LMF is used for initiating
the Ranging/SL positioning service request to the UE. LMF is originally
introduced for the determination of UE location, however, not every LMF is
capable of handling Ranging/SL positioning request, i.e. initiating Ranging/SL
positioning procedure to the UE based on the request received from the AMF,
generating Ranging/SL positioning result based on the measurement data and
reporting the result to the AMF. If LMF is determined to be used, the AMF has
to select a LMF supporting Ranging/SL positioning functionalities.
LMF may be deployed to support both Uu based positioning and Ranging/Sidelink
positioning. Meanwhile, it is also possible that Ranging/Sidelink positioning
dedicated LMF is deployed separately from the LMF used for Uu positioning,
i.e. an LMF is assumed to support capabilities of Uu based positioning only,
capabilities of Ranging/SL positioning only or both.
### 6.27.2 Functional descriptions
In Ranging/SL positioning service, LMF selection is performed at AMF when a
Ranging/SL positioning request is received and the AMF determines to use the
LMF for ranging/SL positioning.
To support Ranging/SL positioning service, Ranging/SL positioning capabilities
are required at LMF, which include:
\- Triggering Ranging/SL positioning between two UEs or between one UE and
multiple UEs based on the request received from the AMF;
\- Ranging/SL positioning result calculation based on Ranging/SL positioning
measurement data, which include:
\- Calculation of the distance between 2 UEs.
\- Calculation of the direction of one UE from the other UE.
\- Calculation of high accuracy distance between 2 UEs.
\- Calculation of high accuracy direction of one UE from the other UE.
\- Calculation of the distance between one UE and each one of the multiple
UEs.
\- Calculation of the direction of one UE from each one of the multiple UEs.
\- Calculation of high accuracy distance between one UE and each one of the
multiple UEs.
\- Calculation of high accuracy direction from one UE to each one of the
multiple UEs.
\- Ranging/SL positioning result reporting.
The above-mentioned Ranging/SL positioning capability factors should be taken
into consideration when selecting an LMF for Ranging/SL positioning.
Furthermore, Requested Quality of Service information needs to include the
Ranging/SL positioning Quality of Service information, i.e. distance accuracy
and direction accuracy.
Additionally, AMF also needs to consider the requested Ranging/SL positioning
content when selecting LMF, i.e. distance, direction or both.
Editor\'s note: Whether more factors need to be considered for LMF selection
for Ranging/SL positioning is FFS.
When LMF is selected to perform network assisted sidelink positioning, AMF
needs to select a LMF capable of network assisted sidelink positioning, i.e.
by considering both factors of LMF selection for Uu based positioning, as
defined in clause 5.1 of TS 23.273 [11] and factors of LMF selection for
Ranging/SL positioning.
### 6.27.3 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- AMF: selects LMF based on service request and new factors.
## 6.28 Solution #28: Using LMF for Ranging/Sidelink positioning
### 6.28.1 General
This solution is to address KI#2, KI#3, KI#4, KI#5, KI#6, and KI#7, where LMF
is involved for Ranging/SL positioning.
The overall procedure of Ranging/Sidelink positioning consists of the
following steps:
\- Ranging/Sidelink positioning request (e.g. from UE, AMF, LMF).
\- Measurement between 2 UEs or between one UE and multiple UEs.
\- Result calculation (e.g. at UE or at LMF, or at both).
\- Ranging/Sidelink positioning response (e.g. to UE, AMF, LMF).
If LMF is involved in the procedure and if Ranging/Sidelink positioning result
calculation is supported by LMF, result calculation can be tasked to LMF. This
is beneficial to the UE with reduced capability, e.g. who doesn\'t support
Ranging/Sidelink positioning result calculation, or who wants to save the
power consumed for result calculation. It is especially useful for the case of
network assisted sidelink positioning to facilitate positioning of a UE in
coverage or with partial coverage when Uu positioning is not possible and when
a higher location accuracy is required.
In the meantime, it is also possible that both UE and LMF will be involved for
result calculation, e.g. UE provides a rough Ranging/Sidelink positioning
result with a simple calculation, which can be used by the LMF together with
other inputs to derive a high accuracy result.
Since the result calculation can be performed at UE or LMF or both, they have
to be coordinated, so that both UE and LMF understand its role in the
procedure.
### 6.28.2 Functional descriptions
In terms of which node to perform Ranging/Sidelink positioning result
calculation, 3 modes are defined:
\- UE based Ranging/Sidelink positioning result calculation: UE performs
Ranging/Sidelink positioning result calculation.
\- LMF based Ranging/Sidelink positioning result calculation: LMF performs
Ranging/Sidelink positioning result calculation.
\- Hybrid: UE and LMF jointly perform Ranging/Sidelink positioning result
calculation.
LMF determines the Ranging/Sidelink positioning result calculation mode based
on:
\- LMF Ranging/Sidelink positioning capability.
\- UE Ranging/Sidelink positioning capability.
\- UE preference of Ranging/Sidelink positioning calculation node: i.e. UE,
LMF or both.
\- Operator policy, i.e. operator preference of UE, LMF or both.
If Ranging/Sidelink positioning result calculation is only supported by UE, UE
based mode is selected; if Ranging/Sidelink positioning result calculation is
only supported by LMF, LMF based mode is selected; if Ranging/Sidelink
positioning result calculation is supported by both UE&LMF, LMF determines the
node based on UE preference and operator policy.
After Ranging/Sidelink positioning result calculation mode is determined, the
LMF includes in the Ranging/Sidelink positioning service request the requested
info (i.e. measurement data or Ranging/Sidelink positioning result or both).
Requested info is determined by the selected mode, which may include:
\- Measurement data if LMF based mode is selected;
\- Ranging/Sidelink positioning result if UE based mode is selected;
\- Both Measurement data and Ranging/Sidelink positioning result if hybrid
mode is selected
During Ranging/Sidelink positioning procedure, UE performs:
\- measurement only if only measurement data is requested;
\- both measurement and calculation if Ranging/Sidelink positioning result is
requested.
After performing Ranging/Sidelink positioning, UE1 reports based on the
requested info.
### 6.28.3 Procedures
#### 6.28.3.1 Procedure of LMF triggered Ranging/sidelink positioning
This procedure applies to the following cases as a part of the overall
procedure when Ranging/Sidelink positioning between 2 UEs is triggered by LMF:
\- Ranging/Sidelink positioning with the assistance of assistant UE.
\- Network assisted Sidelink Positioning for In Network Coverage and Partial
Network Coverage.
\- Ranging and sidelink positioning service exposure to a SL Positioning
Client UE.
\- Ranging and sidelink positioning service exposure to AF or 5GC NF.
It is used to determine whether the Ranging/Sidelink positioning result or
Ranging/Sidelink positioning measurement data should be provided to the LMF.
Figure 6.28.3.1-1: Procedure of LMF triggered Ranging/sidelink positioning
1\. AMF receives a Ranging/Sidelink positioning request from a UE or a GMLC or
any 5GC NF.
2\. AMF selects a serving LMF for UE1.
3\. AMF sends the Ranging/Sidelink positioning request to the selected LMF.
4\. LMF performs Ranging/Sidelink positioning capability negotiation with UE1,
see clause 6.28.3.2 for details of LMF triggered Ranging/Sidelink positioning
capability negotiation.
5\. LMF determines the Ranging/Sidelink positioning result calculation mode
and the requested info based on LMF Ranging/Sidelink positioning capability,
UE Ranging/Sidelink positioning capability, UE preference of Ranging/Sidelink
positioning calculation node: i.e. UE, LMF or both and Operator policy, i.e.
operator preference of UE, LMF or both, as described in clause 6.28.2.
6\. LMF sends the Ranging/Sidelink positioning request to UE1, including the
requested info (i.e. measurement data or Ranging/Sidelink positioning result
or both).
7\. UE1 performs Ranging/Sidelink positioning with UE2. If only measurement
data is requested or LMF based mode is selected, UE does not have to take the
result calculation.
NOTE Details of the steps are developed in the solutions of KI#4.
8a. UE1 reports Ranging/Sidelink positioning result to LMF if it is requested.
8b.1 UE1 reports Ranging/Sidelink positioning measurement data to LMF if it is
requested.
8b.2 LMF performs Ranging/Sidelink positioning result calculation based on the
measurement data received from UE1.
9\. LMF reports the Ranging/Sidelink positioning result to the AMF.
10\. AMF reports the Ranging/Sidelink positioning result.
#### 6.28.3.2 Procedure of LMF initiated Ranging/sidelink positioning
capability negotiation between UE and LMF
Figure 6.28.3.2-1: Procedure of LMF initiated Ranging/sidelink positioning
capability negotiation between UE and LMF
1\. LMF sends the Ranging/Sidelink positioning capability request to the UE1,
which includes LMF Ranging/Sidelink positioning capability, UE1 ID and UE2 ID.
2\. If there is no available UE2 Ranging/Sidelink positioning capability for
result calculation, UE1 triggers Ranging/Sidelink positioning capability
negotiation procedure to acquire UE2 Ranging/Sidelink positioning capability
for result calculation.
Editor\'s note: The details on how Ranging/Sidelink positioning capability is
negotiated between UE1 and UE2 are FFS.
3\. UE1 responds to LMF with UE1/UE2 Ranging/Sidelink positioning capability.
Optionally, UE1 may also include in the response UE1 preference of
Ranging/Sidelink positioning result calculation mode, which is determined
based on LMF Ranging/Sidelink positioning capability and UE1/UE2
Ranging/Sidelink positioning capability.
### 6.28.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: supports Ranging/Sidelink positioning capability negotiation between
UEs and between LMF and UE; determines its role in the Ranging/Sidelink
positioning procedure based on the requested info.
\- LMF: supports Ranging/Sidelink positioning capability negotiation between
LMF and UE; determines result calculation mode.
Editor\'s note: The interactions between the UE and LMF regarding the
capability negotiation and switching of the mode should be determined by RAN
WGs, and alignment is needed once there\'s any conclusion in RAN.
## 6.29 Solution #29: Service continuity of periodic ranging with assistant UE
### 6.29.1 General
This solution address the key issue#2 on \"Ranging service operation procedure
with the assistance of another UE\". Specifically, this solution focuses on
maintaining the service continuity of periodic ranging with Assistant UEs.
### 6.29.2 Functional descriptions
There are scenarios where periodic ranging operation between two UEs is
required, e.g. tracking the relative position of two moving cars on the
highway at a certain interval, and there is another car in-between the two
cars.
The scenario is illustrated below, in which two assumptions are made:
1\. the pair of UE (UE 1 and UE 2) are moving towards the same direction
2\. assistant UE is fixed, and available during the periodical ranging period,
with the proper deployment e.g. RSU.
Figure 6.29.2-1
In these scenarios, if the direct ranging/sidelink positioning between the
target UE and the reference UE cannot be supported, or if the ranging/sidelink
positioning is not sufficiently accurate, the assistance of another UE (e.g.
assistant UE, deployed as RSU) is needed, and direct communication between the
assistant UE and the target UE/reference UE should be supported. During the
periodic ranging operation with assisted UE, when the distance between the
assistant UE and the target UE and/or the distance between the assistant UE
and the reference UE increases to an extent that the assistant UE cannot
continue the assistance, the ranging service operation might go through a
disruption. This solution is proposed to solve the problem of maintaining
service continuity of periodic ranging with assistant UE.
During each cycle of the periodic ranging process, after obtaining the ranging
measurements, UE1 immediately performs a ranging service check according to
all the measurement data collected so far to determine whether the current
assistant UE can continue the assistance in the next cycle, and if not, UE1
would restart the device discovery procedure to find another assistant UE. In
this way, disruptions of ranging service is avoided.
Functions of the Target UE:
\- Ranging/sidelink positioning measurements.
\- Determine whether the current assistant UE can continue to assist ranging
in the next cycle according to the previous measurements.
\- Ranging result calculation.
The Target UE (UE1) performs ranging service check according to all the
previous measurements (e.g. the distances, the received ranging signal power,
and the signal directions) and the tendencies that can be inferred or
calculated from the measurements (e.g. the moving direction and velocity of
the target UE). Thresholds of the relevant measurements and parameters can be
pre-set for a quick determination.
Editor\'s note: An alternative solution is that the determination on the use
of assistant UE and which assistant UE is selected are independent for each
cycle of periodic Ranging. When and how to determinate whether to use the
current assistant UE, discover a new assistant UE or no assistant UE in
different cycles of periodic Ranging is FFS.
### 6.29.3 Procedures
Figure 6.29.3-1: High-level procedure for ranging operation with assistant UE
1\. UE1 and UE2 get the ranging authorization policy from PCF during the
registration procedure. The ranging authorization policy may include whether
the UE is authorized to perform ranging operation with assistant UE. Assistant
UE1 and Assistant UE2 get the ranging authorization policy from PCF during the
registration procedure. The ranging authorization policy may include whether
the UE is authorized to act as an assistant UE for ranging operation.
2\. When the UE1 gets the ranging request from the application layer, but the
direct ranging operation between the UE1 and UE2 cannot be supported, UE1 will
perform assistant UE discovery procedure.
3\. Ranging and sidelink positioning is performed among UE1, UE2 and the
discovered assistant UE (Assistant UE1), and the ranging result is calculated.
For detailed procedures of this step, Sol#16 can be a reference.
4\. After the ranging/sidelink positioning measurement, UE1 performs ranging
service check to determine whether it can continue to provide assistance in
the next cycle, according to previous ranging measurements including the
distances from UE1 and UE2, the received ranging signal power, the moving
direction of UE1 and UE2; thresholds of these measurements maybe pre-set.
NOTE 1: For cases e.g. UE(cars) are on the barricaded highway or make a
U-turn, the on-going periodic ranging session can be terminated by the UE.
5\. When UE1 determines that the Assistant UE1 cannot continue to assist the
ranging service in the next cycle, it performs another assistant UE discovery
procedure to discover Assistant UE2.
NOTE 2: Assistant UE 2,3, N can be assumed to be discovered during the
lifetime of the periodic ranging service between UE1 and UE2. For example, in
V2X scenario multiple RSUs supporting the assistant UE functionality are
deployed at the roadside of high-way.
6\. Ranging and sidelink positioning is then performed among UE1, UE2 and the
newly discovered assistant UE (Assistant UE2), and the ranging result is
calculated.
7\. UE1 performs ranging service check to determine whether the current
assistant UE can continue to provide assistance in the next cycle.
### 6.29.4 Impacts on services, entities, and interfaces
The solution has impacts on the following entities:
Same impacts as proposed in solution#16, and in addition:
Target UE:
\- Perform \"ranging service check\" according to the previous measurements
## 6.30 Solution #30: Ranging service operation with the assistant UE(s)
### 6.30.1 Introduction {#introduction-3}
The solution provides methods for ranging service operation with the assistant
UE.
### 6.30.2 Functional Description
In this solution, it assumes UE1 and UE2 have established communication path
by existing technologies, e.g. direct communication via PC5, communication via
ProSe UE-to-UE relay.
The principles in the ranging operation with the assistant UE are as follows:
\- UE1 and UE2 discovers assistant UEs by any solutions for KI#3, e.g. Model A
(assistant UEs Announcement), Model B (Solicitation/Response).
\- UE1 and UE2 negotiate for assistant UEs selection
\- UE1 and UE2 perform ranging service with selected assistant UEs
independently and shares the ranging result to complete ranging calculation.
NOTE 1: Selected assistant UE(s) may be and may not be on the communication
path between UE1 and UE2. For example, when UE1 communicates with UE2 via a
ProSe UE-to-UE relay, UE1 and UE 2 select another UE as assistant UE rather
than the UE-to-UE relay.
NOTE 2: In this solution, any Target UE/ Reference UE defined in solutions for
KI#3 and KI#4 can act as assistant UE without additional enhancement.
NOTE 3: In this solution, even the Assistant UE cannot obtain the final
ranging result between UE1 and UE2, but the Assistant UE may still know
ranging result between UE1 and Assistant UE, UE2 and Assistant UE (depend on
the ranging method). For privacy reason, e.g. avoid to be tracked, the UE1 and
UE2 may restrict its (ID, position) pair to be exposed to the Assistant UE,
and vice versa. How to protect privacy in Ranging service operation with the
assistant UE(s) will be left to SA3 group and SA2 will make alignment if
necessary.
### 6.30.3 Procedures
Figure 6.30.3-1: Procedure of Ranging/Sidelink positioning with assistant UEs
0a. UE1, UE2 and assistant UE are authorized for Ranging/Sidelink positioning
service. The details will be defined by solutions for KI#1.
0b. Communication path between UE1 and UE2 is established. How to establish
communication path is based on existing technologies, e.g. direct PC5
communication, communication via UE-to-UE relay.
1\. Once UE1 decides to trigger Ranging/Sidelink positioning with UE2 via
assistant UEs, UE1 performs Ranging/Sidelink Positioning device discovery to
discover available assistant UEs. Ranging/Sidelink Positioning device
discovery may use any discovery solutions for KI#3. UE1 may select assistant
UE(s) based on discovered assistant UEs\' capability.
2\. UE1 sends Ranging/Sidelink positioning request to UE2 via established
communication path as defined in solutions for KI#4. Additionally, the
Ranging/Sidelink positioning request includes selected assistant UE list.
NOTE: Ranging/Sidelink positioning request/response are sent via SR5 reference
point defined in clause 4.3.2. Whether messages are carried by PC5 user plane
or control plane will be aligned with RAN WGs.
3\. UE2 discovers available assistant UEs as step 2 and performs assistant UE
selection based on discovered assistant UEs\' capability.
4\. UE2 sends Ranging/Sidelink positioning response with selected assistant
UEs.
5\. UE1 performs Ranging/Sidelink positioning with selected assistant UEs.
6\. UE2 performs Ranging/Sidelink positioning with selected assistant UEs.
7\. The Ranging/Sidelink positioning result with selected assistant UEs is
shared between UE1 and UE2 for calculation of Ranging/Sidelink positioning
result between UE1 and UE2.
### 6.30.4 Impacts on services, entities, and interfaces
UE:
\- support of Ranging/Sidelink positioning with assistant UEs.
Assistant UE:
\- a UE support Target UE/ Reference UE.
## 6.31 Solution #31: Enabling SL positioning for the UE out of coverage
### 6.31.1 General
This solution addresses the KI#5 with a way how to provide location service
when the requested UE is out of coverage.
### 6.31.2 Functional Description
#### 6.31.2.1 Deferred MT-LR which triggers location report when UE enters out
of coverage
LCS or AF may request target UE a deferred MT-LR which ask to report it\'s
location when it enters out of coverage.
After receiving location request from LCS or AF or after registration of a UE
supporting SL positioning, AMF may request deferred location request for the
UE to the LMF while UE is in coverage.
This location request may include following triggering condition on location
report:
\- Location report when UE enters out of coverage and discover any located UE
and/or UE2NW relay UE supporting SL positioning.
\- Location report when UE moves to another located UE or another UE2NW relay
UE while UE is out of coverage.
NOTE: In this solution, relay is referring to L2 UE2NW relay and L3 UE2NW
relay with N3IWF.
When this location request is for periodic location report, it may include
indication that UE need to report its location per the periodicity if
available through any located UE or by connecting relay UE even though UE is
out of coverage.
After receiving the deferred location request, the UE may initiate MO-LR for
reporting its location per triggering condition or per requested periodicity
through a located UE or UE2NW relay UE. The MO-LR mechanism used by the UE
will follows any other solutions defined for KI#5.
When UE reports its location with located UE information, AMF or LMF may store
this information and use it for delivering any MT-LR request to the UE while
UE is out of coverage.
#### 6.31.2.2 Location Request for SL positioning for the UE is out of
coverage.
The overall procedure involves AMF, LMF, located UE(s) and a requested UE.
In this solution, in addition to existing functionality, following major
functionality are added.
\- UE registered its capability for SL positioning and is configured with
policies and parameters for SL positioning (including the case when UE is out
of coverage).
\- AMF performs the selection of candidate list of located UEs when UE is
determined not reachable and compose a security container including protected
location request information for the requested UE.
\- LMF handles NW triggered SL positioning with located UEs and a requested
UE.
\- Located UE sets up a PC5 connection with a requested UE and performs the SL
positioning operation.
\- A requested UE validates a forwarded location request via a located UE.
This solution can support UE based SL positioning calculation, LMF based SL
positioning calculation, and hybrid mode based on configuration in the LMF or
negotiation between LMF and located UEs.
This solution supports both immediate location request and deferred location
request with triggering condition.
The security container is protected and validated by security credentials
shared between UE and the 5GCN.
In this solution, it is assumed that UE and AMF do not remove UE\'s context
and AMF maintain UE\'s last known location information even though UE is
considered as deregistered. If there is no context available for the UE in
AMF, AMF will reject the received location request.
Editor\'s note: The detail security mechanism is to be determined by SA WG3.
### 6.31.3 Procedures
#### 6.31.3.1 Procedure of deferred MT-LR triggering location report when UE
enters out of coverage
Figure 6.31.3.1-1: Procedure of deferred MT-LR triggering report when UE\'s
entering out of coverage
0\. It is assumed that UE registered its capability for SL positioning and is
provisioned with policies and parameters for SL positioning. There may be an
MT-LR request received in AMF.
1 Based on received MT-LR request or based on registered capability of target
UE for SL positioning, AMF may be triggered to send a deferred location
request for the target UE. The deferred location request may include
triggering condition to report its location information based on SL
positioning directly or via located UE. The triggering condition of location
report may include the case that when UE is out of coverage and discover a
located UE, when UE connected to another located UE, or when UE disconnected
from old located UE and connects to a new located UE.
2\. AMF may select LMF to send deferred location request to the target UE.
3\. AMF send deferred location request for the target UE to the selected LMF.
4\. After receiving request, LMF may communicate with target UE to exchange
capability for SL positioning and/or Uu positioning and any assistant
information for positioning.
5\. LMF may send target UE deferred location request with triggering condition
as indicated by AMF. In order to identify the location request, the LMF may
include identifier of the location request such as LOC Event Identifier. By
comparing LOC Event identifier and identifier of the target UE, LMF may verify
whether the location report is relating to the sent location request.
6\. After receiving the deferred location request including triggering
conditions, the target UE may respond to LMF. The target UE may start
monitoring whether triggering conditions are met or not
7\. After receiving the response from the target UE, LMF may inform AMF that
deferred location request is successfully sent to the target UE.
8\. When the target UE finds it is out of coverage, as indicated in the
triggering conditions, the target UE tries to discover located UE or UE2NW
relay UE.
9\. When the target UE discover a located UE, the target UE establish PC5
connection with the located UE.
10\. The target UE and the located UE perform SL positioning to measure
location of the target UE. The target UE informs the located UE of LMF ID of
which send deferred location request to the target UE for location report. The
target UE may inform the located UE of LOC Event identifier and target UE\'s
identifier which will be included in location report.
11\. The located UE sends the LMF a location report which include SL
positioning result between target UE and located UE. The location report may
include the LOC Event identifier and target UE\'s identifier received in step
10.
When the target UE discover UE2NW relay UE in step 9, the target UE connects
to relay UE. It may perform SL positioning with UE2NW relay if relay UE
support located UE or with any located discovered in step 10, and in step 11,
target UE reports the result through UE2NW relay.
Editor\'s note: It is FFS how the Target UE privacy is handled when the Target
UE location is disclosed to the Located UE.
12\. After receiving location report from the located UE, LMF may determine
the location of the target UE using SL positioning result and location of the
located UE. LMF send the determined location information of the target UE to
the AMF. LMF may include the information about located UE in the location
report.
13\. AMF may report target UE\'s location to the LCS client or AF when there
is any pending location request for the UE through GMLC.
The AMF and the LMF may use the located UE to send location request to the
target UE or to request location information of the target UE by using SL
positioning.
#### 6.31.3.2 Procedure of immediate location request procedure with SL
positioning
Figure 6.31.3.2-1: Procedure of immediate location request with SL positioning
0\. It is assumed that UE registered its capability for SL positioning and is
provisioned with policies and parameters for SL positioning (including the
case when UE is out of coverage). It is assumed that located UEs registered
its capability for SL positioning and capability for located UE at AMF.
1\. AMF is triggered to initiate location request for UE1. When UE1 is
determined unreachable, AMF compose list of located UEs based on last known
UE1\'s location information. When there is any located UE\'s information
reported by UE1 before, AMF will include those located UEs in the list of
located UEs for handling the location request. If there is no context
available for the UE in AMF, AMF will reject the received location request.
Editor\'s note: It is FFS whether existing timer can be reused or new timer
needs to be define for determining how long the context needs to be maintained
when UE is deregistered.
AMF selects a LMF and send a location request for UE1 to the selected LMF. In
the location request, AMF includes a security container to protect the
location request information to UE1. AMF may inform list of located UEs to
LMF.
The security container includes information that indication of immediate or
deferred location request, information for periodic-triggered location report
when deferred location request e.g. type of deferred location request and any
parameters for the deferred location request. signature for integrity
protection.
Editor\'s note: For UE deregistered from NW, how security container is
composed and validated between AMF and UE1 is FFS and needs coordination with
SA WG3.
2\. After receiving location request, the LMF sends NW triggered SL
positioning Request via (R)AN to the selected located UEs which includes the
security container information.
It is assumed that LMF is configured or has exchanged capability of
Ranging/sidelink positioning of each located UEs before NW triggered SL
positioning Request.
3.-4. The located UE performs discovery procedure with UE1 and if UE1 is
discovered, the located UE and UE1 perform security association and PC5
unicast connection setup procedure as mentioned in TS 23.304 [4]. When
receiving discovery requests from multiple located UEs, UE1 may select one
located UE and perform step 4 with the selected located UE.
5\. After PC5 unicast connection setup, the located UE sends SL positioning
Request including the received security container.
6\. After validating the message with information in the security container,
UE1 may accept the request with SL positioning Response.
7\. After receiving the SL positioning Response, the located UE may perform SL
positioning with the target UE.
8\. After successfully finishing SL positioning procedure, the located UE
responds to the LMF via ®AN using NW triggered SL positioning Response which
includes the result of SL positioning with UE1. LMF may determine the location
information of UE1 using information included in received SL positioning
Response.
9\. LMF may response AMF with location information of UE1.
#### 6.31.3.3 Procedure of deferred location request procedure with SL
positioning
Figure 6.31.3.3-1: Procedure of deferred location request with SL positioning
0\. It is assumed that UE registered its capability for SL positioning and is
provisioned with policies and parameters for SL positioning (when UE is out of
coverage). It is assumed that located UEs registered its capability for SL
positioning and capability for located UE at AMF.
1\. AMF is triggered to initiate location request for target UE. When target
UE is determined unreachable, AMF compose list of located UEs based on last
known target UE\'s location information. When there is any located UE\'s
information reported by UE1 before, AMF will include those located UEs in the
list of located UEs for handling the location request. If there is no context
available for the UE in AMF, AMF will reject the received location request.
AMF selects LMF and send a location request for target UE to the selected LMF.
In the location request, AMF includes a security container to protect the
information to target UE. AMF may inform list of located UEs to LMF.
The security container may include a indication of immediate or deferred
location request, information for periodic-triggered location report when
deferred location request e.g. type of deferred location request and any
parameters for the deferred location request. list of selected located UEs,
and signature for integrity protection.
Editor\'s note: For UE deregistered from NW, how security container is
composed and validated between AMF and target UE is FFS and needs coordination
with SA WG3.
2\. After receiving location request, the LMF sends NW triggered SL
positioning Request v®(R)AN to the selected located UEs which includes the
security container information.
3.-4. The located UE performs discovery procedure with target UE and if target
UE is discovered, the located UE and UE1 perform security association and PC5
unicast connection setup procedure as mentioned in TS 23.304 [4].
5\. After PC5 unicast connection setup, the located UE sends SL positioning
Request including the received security container.
6\. After validating the message with information in the security container,
the target UE may accept the request with SL positioning Response.
When the location type indicated in the security container is deferred
location request, the target UE will store the information and when the
trigger conditions are satisfied, the target UE may initiate MO-LR type
location request.
7\. After receiving the SL positioning Response, the located UE_1 may respond
LMF with NW triggered SL positioning Response to indicate the request was
delivered well.
8\. After receiving SL positioning Response, the LMF may respond AMF with
Location Response to indicate the Location Request was successfully delivered.
9\. When triggering condition was satisfied, the target UE may initiate
procedure for 5GC-MO-LR request.
10\. The target UE performs discovery procedure to find available located UEs.
When the target UE discover a located UE, the target UE may check whether the
located UE_2 is in the list of located UEs which is received in the security
container.
10.-11. After finding the located UE_2 is in the list of located UEs, target
UE and the located UE_2 perform security association and PC5 unicast
connection setup procedure as mentioned in TS 23.304 [4].
12\. The target UE send a NW Assisted SL positioning Request to the located
UE_2.
NW Assisted SL positioning Request includes the information required to
compose 5GC-MO-LR Request message at the located UE_2 e.g. information about
the consumer of the location information of target UE, i.e. AF ID or LCS
client ID, QoS information for the location request, and requested positioning
method.
13\. The target UE and the located UE_2 performs SL positioning.
14\. The located UE_2 sends 5GC-MO-LR request to LMF which include target UE
ID, located UE ID, consumer AF or LCS client ID, result of SL positioning
between located UE_2 and the target UE.
15\. After receiving 5GC-MO-LR request, LMF may perform procedure to determine
location information of the located UE_2.
16\. After determining the location information of the target UE, LMF may send
Location Report to the AMF which include target UE ID, location information of
the target UE, and consumer AF or LCS_client ID.
### 6.31.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: policy provisioning for SL positioning and performing SL positioning
with security update, and handling deferred location request with new
triggering conditions.
\- AMF: handling deferred location request with new triggering conditions,
managing list of located UE for SL positioning of UE out of coverage and
composing security container to target UE out of coverage.
\- LMF: handling deferred location request with new triggering condition,
location determination with SL positioning.
## 6.32 Solution #32: Involving Multiple Reference UEs for Sidelink
positioning
### 6.32.1 Description
Involving multiple Reference UEs can improve the position accuracy and is
sometimes essential to be able to calculate a position through
triangulation/tilateration, e.g. if the Target UE is out of coverage.
The following deployment scenarios are being considered:
\- Multiple Reference UEs are part of a \"fixed\" installation, for example to
cover a e.g. room, building or factory floor.
\- Multiple Reference UEs are close to a Target UE, but not necessarily have a
fixed position or role.
An example of how this could look like is illustrated below. The Target UE is
able to perform ranging with both Reference UE 1 and Reference UE 2\. The
results can be combined to estimate the Target UE\'s position in a relative
coordinate system or possibly geographical coordinate system (if the
geographical positions of the Reference UEs are known). By collecting the
ranging measurements/results from the various UEs involved, the sidelink
position can be calculated more accurately than when only a single Reference
UE would be used. Not only because the ranging measurements with multiple
Reference UEs can be used in the calculation, but also e.g. if a Target UE can
discover one reference UE of a \"fixed\" installation, but is not able to
discover another reference UE that is part of the same installation, it tells
something about the Target UE\'s location, since certain areas can be excluded
from the location calculation. Also Reference UEs may be instructed to perform
ranging between themselves to further improve the accuracy, in particular in
case their position is not always fixed.
These multiple Reference UEs may form some kind of \"constellation\" similar
to a satellite constellation for GNSS.
Figure 6.32.1-1: Illustration of a fixed installation of Reference UEs in a
room or factory floor
In this solution, the above scenarios are considered for in-coverage, partial-
coverage and out-of-coverage situations, whereby the LMF (or a subset
implemented by a reference UE/SL Positioning Server UE) is considered to have
the central coordinating role of the sidelink positioning involving multiple
Reference UEs and is also responsible for determining the position of the
Target UE. The case of a Target UE performing UE-based positioning and
coordinating individual ranging sessions with multiple reference UEs is not
described as part of this solution.
In this solution the term Ranging/Sidelink Positioning Protocol (RSPP) is used
as defined in solution #26.
Below each of the coverage situations is described in more detail:
\- **In-coverage:** Both the Target UE and Reference UEs can connect to an LMF
to coordinate and configure the ranging between the Target UE and the
Reference UEs. The LMF may keep track of Reference UEs and in particular
Located UEs in a certain area to be able to determine a group of Reference UEs
that could serve a Target UE, or be provisioned by an external application
e.g. through NEF with information about a \"constellation\" of Reference UEs
in a certain area and their locations. If the location of the Reference UEs is
not yet known, the LMF may initiate a location request with those Reference
UEs.
If the position of the Target UE needs to be determined, the Target UE may
send a location request to the LMF or vice-versa. After this, the Target UE
initiates a ranging discovery procedure as described in the various solutions
for KI#3, and initiate a ranging session with a discovered Reference UE by
transmitting a Direct Connection Request. The Target UE or Reference UE can
report information about the ranging session (such as session identifier, and
identifiers of the Target UE and Reference UE) to the LMF. Based on the
information about ranging constellations or other Reference UEs in the area,
the LMF can invite other Reference UEs to join the ranging session (with the
indicated identifier) or ask the Target UE or a Reference UE to do so, and in
this way coordinate the joint ranging of a Target UE for improved location
estimation.
In the figure below, the Target UE discovers and initiates a ranging session
with Reference UE 1, after which Reference UE 2 is also invited to join the
same ranging session.
Figure 6.32.1-2: High-level overview of in-coverage scenario
Once the ranging session with multiple Reference UEs is properly set up, the
UEs involved can perform ranging to measure/calculate distances and/or angles
between them, and report these to the LMF to estimate the location of the
Target UE.
NOTE 1: The details of these procedures will be defined by RAN WGs.
\- **Partial coverage:** In this situation, the Target UE is out-of-coverage,
but at least one of the Reference UEs is in coverage and can connect to the
LMF. In this situation, the Reference UEs can operate in a very similar way as
the in-coverage case. The Target UE can initiate a ranging discovery procedure
similarly as for the in-coverage case. The only difference is that the Target
UE cannot contact the LMF directly to initiate a location request, receive
configuration information or send its measurements. Instead, one or more the
Reference UEs that are connected with LMF have to do this on behalf of the
LMF. To this end, the Reference UE may act as a SL Positioning Server UE by
implementing part of the LMF\'s functionality, or may perform forwarding of
messages between the Target UE and the LMF, or a combination thereof.
In the figure below, the Target UE is out of coverage, and Reference UE 2 as
well. Reference UE 1 will perform the communication with the LMF on behalf of
the Target UE and Reference UE 2.
Figure 6.32.1-3: High-level overview of partial coverage scenario
\- **Out-of-coverage:** In this situation, the Target UE as well as the
Reference UEs are out of coverage. To not deviate too much from the previous
situations, a solution is for one or more of the Reference UEs to act as a SL
Positioning Server UE by implementing a subset of the LMF\'s functionality and
support the same protocols (e.g. Ranging/Sidelink Positioning Protocol (RSPP)
as in Solutions #26). Such Reference UE would need to be provisioned
beforehand with the necessary policies and information by the LMF (of PCF)
once it was still in coverage. This may include e.g. information about other
Reference UEs in the area and their position, or ranging \"constellation\"
information. It may also include information about position methods and
procedures supported by the PLMN, accuracy settings, etc. The solutions for
KI#1 can be extended to support the provisioning of such additional policies
and information.
NOTE 2: The details of the authorization aspects and procedures for such out-
of-coverage deployment need to be studied by SA WG3.
A Reference UE that implements part of the LMF\'s functionality, i.e. a SL
Positioning Server UE, may also by itself gather the necessary information
about nearby Reference UEs or ranging \"constellations\" by performing ranging
discovery, exchange capabilities and location information or perform ranging
with such nearby Reference UEs. This information can then be used to invite
other Reference UEs to join a ranging session for sidelink positioning of a
Target UE. It may also configure the Target UE and other Reference UEs to
transmit the ranging measurements to this Reference UE, so that it can
calculate the position of the Target UE based on it. For the Target UE, the
ranging discovery and session setup are similar to the ranging discovery and
session setup for the partial coverage case. Note that this deployment can in
principle also be used for partial coverage situations.
In the figure below, the Target UE, Reference UE 1 and Reference UE 2 are all
out of coverage. Reference UE 1 implements a subset of the LMF\'s
functionality.
Figure 6.32.1-4: High-level overview of out-of-coverage scenario
Note that the role of being a Reference UE and in particular Located UE may
not always stay the same. This depends on several factors, such as whether or
not the UE has a position fix and whether or not its position is stable. For
example, even if a UE includes a GNSS module in order to get a position fix,
it may be out of coverage of the GNSS satellite network (e.g. driving into a
tunnel or if it is deployed indoors), and hence may not be able to be a
Located UE or Reference UE. Similarly if the UE is out-of-coverage of the NG-
RAN it may not be able to be a Located UE or Reference UE because it cannot
connect to the LMF. Also, the position of a UE may be too unstable to be used
as Located UE or Reference UE (e.g. UE is moving too fast or shaking too
much). If the role changes, the LMF and other UEs (e.g. Target UE, Reference
UEs) involved in ranging need to be notified of such change.
NOTE 3: How the possible roles (e.g. Reference UE, Located UE) are determined
and the criteria for this are out-of-scope for SA WG2 and would need to be
studied by RAN WGs.
### 6.32.2 Procedures
The procedures below describe each of the above mentioned cases in more
detail. In these procedures, it is assumed that the Target UE and all involved
Reference UEs are served by the same PLMN.
**Case 1: Target UE and all Reference UEs are in coverage**
Figure 6.32.2-1: High-level procedure for involving multiple Reference UEs to
a ranging session for in-coverage situation
1\. The LMF may receive information about ranging \"constellations\" in an
area from the GMLC, which may have received this information from an AF (via
NEF), LCS client or another PLMN (see description of Figure 6.32.2-2 for more
details)
2\. The LMF collects data about potential Reference UEs/Located UEs in an area
(possibly based on the ranging \"constellation\" information from the AF),
including receiving data about the capabilities and location information for
these potential Reference UEs/Located UEs, and maintains this information in a
storage unit/database. This may also include keeping track of potential role
changes, e.g. if a UE is not able to be a Reference UE/Located UE anymore
(e.g. because it lost its position fix). To this end, the GMLC may issue a
Periodic MT-LR for the respective Reference UEs/Located UEs. The location
information of the Reference UEs/Located UEs will also be updated every time
the Reference UE/Located UE issues a MO-LR.
3\. The Target UE (3a) or the GMLC (3b)transmit a Location Request to trigger
the initiation of the ranging/sidelink positioning procedures for the Target
UE. The AMF then selects (3c) an LMF that supports ranging/sidelink
positioning procedures. Preferably, the LMFs are deployed to serve a
particular area, so that the LMF selection can be based on area information of
the Target UE, such as TAI or Cell-Id.
4.
6\. Based on area information, such as TAI or Cell-Id of the Target UE
provided by the AMF to the LMF, the LMF determines one or more Reference UEs
to get involved in the ranging session, e.g. based on the information about
ranging constellations or Reference UEs in the area (that have a stable
position).
NOTE 1: In case in steps 2 and 3b different LMFs have been selected for the
Target UE and one or more Reference UEs, if an LMF discovers that it does not
have UE context information for each of these UEs, then it may use the NL7
reference point (as specified in TS 23.273 [11] and which may need to be
extended for this purpose) to request other LMFs to perform a UE context
transfer of the \"missing\" UE context information to this LMF (or vice
versa), for example using steps 5-10 of the LMF Change Procedure in clause 6.4
of TS 23.273 [11]. If none of the LMFs have UE context information available
for the \"missing UE\", then the LMF may issue a request to the AMF to assign
the \"missing\" UE to the same LMF. If the AMF does not yet serve the
\"missing UE\", it may verify if another AMF is serving that UE, and if not,
issue a network triggered service request to that UE. Otherwise, it may align
with the serving AMF of that \"missing\" UE to select the same LMF.
5\. The LMF configures the Target UE and the Reference UEs, in this case
Reference UE#1 and Reference UE#2 to enable both Reference UE#1 and UE#2 to
join the ranging session with the Target UE. The configuration information may
include a session identifier for the joint ranging session. Such message could
be an extension to the Ranging/Sidelink Positioning Protocol (RSPP). The LMF
may also configure the respective UEs with other relevant information to
enable ranging (if this has not been done beforehand) in this step.
6\. The Target UE and Reference UE#1 and Reference UE#2 can perform ranging
discovery (if not done yet) and setup a ranging connection with each other,
using the session identifier for the joint ranging session as input, and
initiate ranging.
7\. Optionally, the Reference UEs (in this case Reference UE#1 and Reference
UE#2) will also perform ranging discovery and setup a ranging connection with
each other.
8\. In this step, the Target UE will perform ranging with all Reference UEs
involved in the ranging session (in this case both with Reference UE#1 and
with Reference UE#2) to determine a distance/angle between the respective UEs.
Optionally the Reference UEs are configured by the LMF to perform ranging
amongst each other for additional accuracy (in this case Reference UE#1 may
perform ranging with Reference UE#2).
9\. All UEs involved in the joint ranging session, in this case the Target UE
and Reference UE#1 and Reference UE#2 report their ranging
measurements/results to the LMF.
10\. The LMF calculates the location of Target UE based on the received
ranging measurements/results from all UEs involved in the joint ranging
session. The LMF may report the estimated location to the Target UE or AF.
**Additional details on how the LMF receives or determines information about
ranging \"constellations\":**
Figure 6.32.2-2: Example procedure of how the LMF receives ranging
\"constellation\" information from external entity
As indicated, the LMF may receive information about ranging \"constellations\"
in an area from an external application or an LCS client. Such information
would consist at least of a list of identifiers (e.g. GPSI) of known/preferred
Reference UEs/Located UEs, but may also contain additional information such as
(last known) location information of such UEs, capabilities of these UEs, or
area related information.
1a: In the case of an LCS client, information about ranging \"constellations\"
may be sent as part of a location request for a target UE.
1b: In case of an AF, information about ranging \"constellations\" may be
transmitted first to an NEF which forwards the information to the GMLC.
2: After the GMLC has received the ranging \"constellation\" information it
selects an AMF. This can be done in a similar way as in step 2 of solution#21,
whereby information provided about the ranging \"constellations\" (e.g.
identifier of Reference UE/Located UE, location of one or more Reference
UEs/Located UEs, or area information) may be used in addition to information
about a target UE. In case the GPSI is used as identifiers of Reference
UEs/Located UEs, the GMLC may request the UDM to provide the SUPI of those
UEs. The GMLC may also send the ranging \"constellation\" information to all
known AMFs of the 5GC.
3: The GMLC sends the information about ranging \"constellations\" to the
selected AMF(s).
4: Based on the ranging \"constellation\" information, the AMF selects a
ranging/SL position capable LMF that serves most (if not all) of the UEs of
the ranging \"constellation\", e.g. based on whether the area or location
information provided in the ranging \"constellation\" information is within an
LMF Service Area. The AMF may also select one or more other LMFs for which the
ranging \"constellation\" information could be relevant, such as LMFs with
partially overlapping service area or that are currently serving one or more
Reference UEs/Located UEs in the constellation.
5: The AMF provides the ranging \"constellation\" information to the selected
LMF(s).
NOTE 2: The above procedure of providing ranging \"constellation\" information
is optional. The LMF can have its own implementation specific means to
determine ranging \"constellations\".
NOTE 3: An HPLMN can use steps 2-5 of this procedure to provide the LMF(s) of
one or more VPLMNs with ranging \"constellation\" information and other
ranging related configuration information, whereby the GMLC in steps 2-5 is
the VGMLC and the HGMLC can provide the ranging \"constellation\" information
and other ranging related configuration information via the NL3 reference
point (as specified in TS 23.273 [11] and which may need to be extended for
this purpose) in an alternative step 1.
NOTE 4: The LMF (via AMF) or AMF may provide ranging \"constellation\"
information to a SL Positioning Server UE and the Target UE as part of their
ranging configuration.
**Case 2: Target UE is out of coverage and at least one Reference UE is in
coverage (i.e. partial coverage case)**
Figure 6.32.2-3: High-level procedure for involving multiple Reference UEs to
a ranging session for partial coverage situation
1-2. Steps 1 and 2 are the same as for Case 1 (i.e. in-coverage).
3\. The out-of-coverage Target UE can implicitly or based on a configured
policy initiate a MO-LR procedure by starting ranging discovery and connection
setup with a nearby Reference UE (in this case Reference UE#1).
4a. The Target UE may (4a1) use the ranging connection with the nearby
Reference UE to transmit a Location Request, which the Reference UE (which is
in coverage) can forward (4a2) to the AMF
The Target UE may (4a1) use the ranging connection with the nearby Reference
UE to transmit a Location Request to trigger the initiation of the
ranging/sidelink positioning procedures, but since the Target UE is out-of-
coverage this message needs to be forwarded (4a2) by a Reference UE that is in
coverage (in this case Reference #1) to the AMF.
4b. The Location Request may (4b1) also be issued by the GMLC. If the Target
UE is registered to the network (e.g. through ProSe UE-to-Network Relay
functionality offered by a Reference UE or by the Reference UE acting as a
gateway) or is otherwise known by the network how to reach it (e.g. by the
Reference UE providing discovery information or connection setup information
related to the Target UE to the AMF), the Location Request may be forwarded
(4b2) by the AMF to the respective Reference UE near the Target UE, which may
forward it (4b3) onwards to the Target UE. In case the Target UE is not
registered to the network or otherwise not known by the network how to reach
it, the AMF may find a Reference UE near the Target UE by using the Target
UE\'s last known location (as described in Solution #21).
NOTE 5: For the forwarding of the messages in steps 4a2 and 4b3, e.g. (a
subset of) ProSe UE-to-Network Relay functionality or some gateway
functionality (e.g. for repackaging RSPP from PC5 to Uu) could be considered.
This can be decided during normative phase and/or as part of the conclusions
depending on other partial coverage solutions.
4c. Based on the incoming Location Request, the AMF selects the LMF.
5\. The Target UE or the Reference UE can report that a ranging connection was
set up to the LMF, if this information was not provided yet via the Location
Request. This report may include identifiers of the Target UE and Reference UE
and a session identifier.
6\. This step is the same as step 4 of Case 1 (i.e. in-coverage).
7\. The LMF configures the Target UE and the Reference UEs (in this case
Reference UE#1 and Reference UE#2) to enable Reference UE#2 to join the
ranging session. The configuration information may include a session
identifier for the joint ranging session. This is the same as step 5 of Case 1
(i.e. in-coverage) except that since the Target UE is out-of-coverage, the
Reference UE that is in coverage (in this case Reference #1) needs to provide
or forward this message to the Target UE on behalf of the LMF. Similar if
Reference UE#2 is out-of-coverage.
NOTE 6: For the forwarding of the messages, e.g. (a subset of) ProSe UE-to-
Network Relay functionality or some gateway functionality (e.g. for
repackaging RSPP from PC5 to Uu) could be considered. This can be decided
during normative phase and/or as part of the conclusions depending on other
partial coverage solutions.
8-10. Steps 8 through 10 are the same as for Case 1 (i.e. in-coverage).
11\. All UEs involved in the joint ranging session, in this case the Target UE
and Reference UE#1 and Reference UE#2 need to report their ranging
measurements/results to the LMF. However, since the Target UE is out-of-
coverage, it may report its ranging measurements/results to the Reference UE
that is in coverage (in this case Reference UE#1), which may (collect and)
forward the ranging measurements/results to the LMF. Similar if Reference UE#2
is out-of-coverage.
12\. Step 12 is the same as step 10 for Case 1 (i.e. in-coverage).
**Case 3: Target UE as well as the Reference UEs are out of coverage**
Figure 6.32.2-4: High-level procedure for involving multiple Reference UEs to
a ranging session for out-of-coverage situation
0\. Step 0 is the same as step 1 for Case 1 (i.e. in-coverage) and Case 2
(i.e. partial coverage). Reference UE#1 is a SL Positioning Server UE.
1\. Optionally the LMF configures the SL Positioning Server UE, when that UE
is in coverage.
2\. Step 2 is the same as for Case 1 (i.e. in coverage) and Case 2 (i.e.
partial coverage), but is now executed by the SL Positioning Server UE instead
of the LMF.
3\. The Target UE or SL Positioning Server UE may transmit a Location Request
to trigger the initiation of the ranging/sidelink positioning procedures.
4\. Step 4 is the same as for Case 1 (i.e. in-coverage), but is now executed
by the SL Positioning Server UE, and NOTE 1 does not apply.
5-10. Steps 5 through 10 are the same as for Case 1 (i.e. in-coverage), but
are now executed by the SL Positioning Server UE instead of the LMF.
### 6.32.3 Impacts on services, entities and interfaces
Reference UE:
\- Support for ranging procedures (e.g. discovery, performing ranging
signalling/measurements, etc.).
\- Support of RSPP.
\- Optional support of a subset of LMF functionality
\- Optional support for forwarding messages from a Target UE and other
Reference UEs to the LMF and vice-versa.
SL Positioning Server UE:
\- Collect ranging measurements/results and calculate position
\- Configure Target UE and other Reference UEs for ranging
\- Invite other Reference UE to a ranging session
\- Collect/maintain/provide information about other Reference UEs/ranging
\"constellation\" information.
Target UE:
\- Support for ranging procedures (e.g. discovery, performing ranging
signalling/measurements, etc.).
\- Support of RSPP.
LMF:
\- Support of RSPP.
\- Ability to collect ranging measurements/results and calculate position.
\- Ability to invite (additional) Reference UEs to a ranging session.
\- Collect/maintain/provide information about other Reference UEs/ranging
\"constellation\" information.
\- Ability to request other LMFs if they have UE context information of a
Target UE or Reference UE, and if so request them to perform a UE context
transfer of that UE\'s context information to this LMF
\- Optional support to provision Reference UEs that support a subset of LMF
functionality.
GMLC:
\- Optional support for receiving ranging \"constellation\" information via
NEF or LCS client.
\- Optional support for interpreting \"constellation\" information to select
one or more AMFs.
AMF:
\- Optional support for receiving ranging \"constellation\" information from
GMLC.
\- Optional support for interpreting \"constellation\" information to select
one or more LMFs.
## 6.33 Solution #33: Common Ranging/Sidelink positioning service exposure
### 6.33.1 General
This solution is to address KI#6 and KI#7.
The overall procedure of Ranging/Sidelink positioning consists of the
following steps:
\- Ranging/Sidelink positioning request/response (e.g. received from/sent to
SL Positioning Client UE, AMF, LMF).
\- Measurement between 2 UEs or between one UE and multiple UEs.
\- Result calculation (e.g. at SL Positioning Server UE or at LMF, or at
both).
A SL Positioning Server UE supports at least one of the following
functionalities:
\- Receive/send Ranging/Sidelink positioning request/response from/to UE or
LMF.
\- Result calculation.
Either service is triggered by UE or Application server, result calculation
can be performed at SL Positioning Server UE, at LMF, or at both. However,
involving LMF for the result calculation is expected to be avoided as much as
possible to reduce the delay and network complexity. Before it is determined
to use LMF, try to perform the procedure on the UE side first. If at some step
UE determines to sort help from network, then proper LMF is selected and
involved.
### 6.33.2 Functional descriptions
In a Ranging/Sidelink positioning procedure, SL Positioning Server UE
functionalities (i.e. Receive/send Ranging/Sidelink positioning
request/response from/to UE or LMF and Result calculation) have to be
performed. If neither Ranging/Sidelink positioning UEs (i.e. reference UE and
target UE) supports SL Positioning Server UE functionalities, a SL Positioning
Server UE has to be discovered. The Ranging/Sidelink positioning UEs interact
with the SL Positioning Server UE for transmitting the measurement data and
the result.
However, if no SL Positioning Server UE in proximity can be discovered, the
Ranging/Sidelink positioning UE has to notify the network to select a proper
LMF for result calculation.
Editor\'s note: For the Ranging/Sidelink Positioning service request received
from GMLC, whether to select a LMF or a SL Positioning Server UE to perform
result calculation is FFS.
In a network based solution, Ranging/Sidelink positioning UE receives the
Ranging/Sidelink positioning request from its serving AMF. The AMF may receive
a Ranging/Sidelink positioning request from LMF, a SL Positioning Client UE,
GMLC, or NEF.
In a non-network based solution, Ranging/Sidelink positioning UE receives the
Ranging/Sidelink positioning request from a SL Positioning Client UE directly
over PC5.
In both cases, when Ranging/Sidelink positioning UE receives the request, it
starts to discover the other Ranging/Sidelink positioning UE. After the other
UE is successfully discovered, they exchange capabilities.
If SL Positioning Server UE functionalities are supported by either one, the
further measurements and result calculations will only be performed by the 2
UEs; otherwise, the Ranging/Sidelink positioning UE discovers a SL Positioning
Server UE, using either Mode A or Mode B ProSe discovery by indicating the
capability of SL Positioning Server UE for the discovery, so that only a UE
supporting SL Positioning Server functionalities is discovered.
Ranging/Sidelink positioning UE may be provisioned or pre-configured with a SL
Positioning Server UE ID, in that case, the Ranging/Sidelink positioning UE
discovers the SL Positioning Server UE based on the preconfigured ID. If
multiple SL Positioning Server UEs are discovered, the SL Positioning Server
UE is selected based on their capabilities, the pre-configured SL Positioning
Server UE ID, the distance, and the signaling strength.
### 6.33.3 Procedures
Figure 6.33.3-1: Procedure of common Ranging/sidelink positioning exposure
(network based solution)
1\. UE1\'s serving AMF receives a Ranging/Sidelink positioning service request
from the SL Positioning Client UE or a 5GC NF
2\. If no operator policy indicating the use of LMF, the AMF sends the request
to UE1.
3\. UE1 discovers UE2. UE1 and UE2 exchange their capabilities to determine if
it is necessary to use a SL Positioning Server UE:
\- if neither UE1 nor UE2 supports SL Positioning Server functionalities, UE1
or UE2 discovers a SL Positioning Server UE.
\- otherwise, no need to discover the SL Positioning server UE, and step 4 is
skipped.
Editor\'s note: The security issues due to the involvement of SL Positioning
server UE in the Ranging/Sidelink Positioning procedure will be evaluated by
SA WG3.
4\. UE1 or UE2 or both discover a SL Positioning Server UE using either Mode A
or Mode B ProSe discovery by indicating the capability of SL Positioning
Server UE for the discovery. If multiple SL Positioning Server UEs are
discovered, the SL Positioning Server UE is selected based on their
capabilities, the pre-configured SL Positioning Server UE ID, the distance,
and the signaling strength.
**Option A (start)**
5\. If a SL Positioning Server UE is successfully selected, Ranging/Sidelink
positioning measurement and result calculation are performed among UE1, UE2
and the selected SL Positioning Server UE (if needed).
6\. UE1 responds to AMF with the Ranging/Sidelink positioning result.
**Option A (end)**
**Option B (start)**
7\. If UE1 and UE2 fail in discovering and selecting a SL Positioning Server
UE, UE1 notifies AMF that no SL Positioning Server UE is available.
8\. AMF determines to involve LMF.
9\. A LMF is selected by the AMF. The selected LMF triggers UE1 or UE2 to
perform Ranging/Sidelink positioning measurement. The measurement data is sent
to LMF for result calculation.
**Option B (end)**
10\. AMF sends the Ranging/Sidelink positioning result to the SL Positioning
Client UE or a 5GC NF.
Figure 6.33.3-2: Procedure of common Ranging/sidelink positioning exposure
(non-network based solution)
1\. UE1 receives a Ranging/Sidelink positioning service request from the SL
Positioning Client UE
2\. UE1 discovers UE2. UE1 and UE2 exchange their capabilities to determine if
it is necessary to use a SL Positioning Server UE:
\- if neither UE1 nor UE2 supports SL Positioning Server functionalities, UE1
or UE2 discovers a SL Positioning Server UE.
\- otherwise, no need to discover the SL Positioning Server UE, and step 3 is
skipped.
3\. UE1 or UE2 or both discover a SL Positioning Server UE using either Mode A
or Mode B ProSe discovery by indicating the capability of SL Positioning
Server UE for the discovery. If multiple SL Positioning Server UEs are
discovered, the SL Positioning Server UE is selected based on their
capabilities, the pre-configured SL Positioning Server UE ID, the distance,
and the signaling strength.
**Option A (start)**
4\. If a SL Positioning Server UE is successfully selected, Ranging/Sidelink
positioning measurement and result calculation are performed among UE1, UE2
and the selected SL Positioning Server UE (if needed).
5\. UE1 responds to AMF with the Ranging/Sidelink positioning result
**Option A (end)**
**Option B (start)**
6\. If UE1 and UE2 fail in discovering and selecting a SL Positioning Server
UE, UE1 send the Ranging/Sidelink positioning request to the AMF, which may
include an indication that no SL Positioning Server UE is available.
7\. AMF determines to involve LMF.
8\. A LMF is selected by the AMF. The selected LMF triggers UE1 or UE2 to
perform Ranging/Sidelink positioning measurement. The measurement data is sent
to LMF for result calculation.
9\. AMF sends the Ranging/Sidelink positioning result to UE1.
10\. AMF sends the Ranging/Sidelink positioning result to the SL Positioning
Client UE.
**Option B (end)**
### 6.33.4 Impacts on services, entities, and interfaces
The solution has impacts in the following entities and interfaces:
\- UE: supports initiating Ranging/SL Positioning procedure; receives
Ranging/SL Positioning service request from AMF or the SL Positioning Client
UE; sends Ranging/SL Positioning result to AMF or the SL Positioning Client
UE, SL Positioning server functionalities; SL Positioning Server UE discovery
and selection; notification to 5GC that no SL Positioning Sever UE is
available.
\- AMF: receives and forwards the Ranging/SL Positioning service request to
the UE1; receives and forwards the Ranging/SL Positioning result to the SL
Positioning Client UE, handle notification about no available SL Positioning
Sever UE.
\- NAS: supports transmission of Ranging/SL Positioning service request and
Ranging/SL Positioning result; notification to 5GC that no SL Positioning
Sever UE is available.
\- PC5: supports transmission of Ranging/SL Positioning service request and
Ranging/SL Positioning result.
## 6.34 Solution #34: MT-LR and MO-LR signalling for UE-only Operation of SL
Positioning and Ranging
Editor\'s note: This clause describes a solution addressing one or more key
issues identified in clause 5. The structure of the clauses can be adjusted.
The list of key issues which this solution attempts to resolve should be
clearly indicated.
### 6.34.1 General
This solution addresses KI#2 (Ranging service operation procedure with the
assistance of another UE), KI#6 (Ranging and sidelink positioning service
exposure to a UE).
Solution #26 introduces, among others, the notion of a Location Server that
can be hosted in a UE, as not all UEs may be able to position themselves and a
network Ranging/SL Positioning capable LMF may simply not be reachable or
available.
UE-only Operation further implies:
\- LCS today assumes an LCS Client may operate in a UE; as specified in TS
23.273, an LCS Client is an \"entity that interacts with GMLC for the purpose
of obtaining location information for one or more UEs. The LCS Client may
reside in the UE.\" In UE-Only Operation this model needs to be adapted, i.e.
for operation in a third-party UE. The term \"SL Positioning Client UE\" is
used hereafter.
\- GMLC, UDM and AMF are not available, while noting LCS Clients traditionally
access LCS services from a GMLC using the Le reference point. These NFs
provide important functionality that need to be transposed into UE-only
scenarios.
Additionally, one or multiple SL Reference UEs need to be involved to position
a target UE using PC5.
This solution proposes to introduce a signalling framework to enable PC5-MT-LR
and PC5-MO-LR LCS procedures supporting sidelink positioning and ranging,
given the above.
### 6.34.2 Functional descriptions
In a network scenario, it is the GMLC (with assistance from the UDM) that
authorizes LCS Clients/AF and ensures the privacy of a Target UE is respected.
In UE-only scenario, without any network entity to rely on, it should be
considered whether a UE could host Vetting functionality. A key question is
then whether a UE has authority to verify a) that SL Positioning Client UE is
authorized and b) the Target UE privacy with respect to the SL Positioning
Client UE obtaining the location of the Target UE.
This solution proposes that no distinct GMLC/UDM UE be introduced. Instead, it
proposes that the necessary Vetting functionality be hosted either in the
Target UE (Case I.) or the SL Positioning Server UE (Case II.) as follows:
I. Target UE (with Vetting functionality): the Target UE interacts directly
with SL Positioning Client UEs. The Target UE itself vets any incoming
location requests addressed to it and only responds to requests it
successfully vets, such that \"illicit\" requests do not cause undue
signalling, given that:
\- In network-based scenarios, an LCS Client is verified to be authorized, or
not, to retrieve the UE location, as a function of the Subscriber LCS Privacy
Profile (SLPP) that is stored as part of the subscription data in the UDM, and
LCS Client Data (e.g. location request type, client identity). The SLPP is
subscriber-specific and can be updated by the UE, e.g. depending on user
input; and
\- In UE-only scenario, it can therefore be expected that the Target UE itself
holds its own Subscriber SL Positioning Privacy Profile, and using this
information and SL Positioning Client UE data (such as location request type
e.g. positioning/ranging, accuracy, client identity, SL Reference UE ID(s),
etc.) is able to decide whether or not to authorize the Client to retrieve its
location.
Furthermore, without an AMF, the Target UE will need taking on the \"role\" of
the AMF. In particular, the Target UE itself will select and interact with the
SL Positioning Server UE (if the Target UE determines it needs assistance from
a SL Positioning Server UE for positioning of the Target UE).
This solution proposes that the selection of the SL Positioning Server UE by
the Target UE is performed using direct discovery. Both models A and B
discovery can be used as follows (see TS 23.303 [22] for definitions of models
A and B):
\- Model A: a SL Positioning Server UE (\"announcing UE\") announces itself at
least as a SL Positioning Server UE. Target UEs (\"monitoring UE\") monitor
such announcements.
\- Model B: a Target UE (\"discoverer UE\") issues requests including
information it wishes to discover a SL Positioning Server UE (\"discoveree
UE\").
Once a suitable SL Positioning Server UE is identified by the Target UE,
direct communication between these UEs can thereafter take place to complete
the positioning/ranging procedure.
II. SL Positioning Server UE (with Vetting functionality): the SL Positioning
Server UE interacts with SL Positioning Client UEs i.e. it acts as a \"proxy\"
between these SL Positioning Client UEs and Target UEs. Unlike Case I. the
Target UEs would not interact directly with SL Positioning Client UEs in this
case. However like Case I. it can be expected here as well that the Target UE
itself holds its own Subscriber LCS Privacy profile information which can be
queried/used when necessary by the SL Positioning Server UE when interacting
with SL Positioning Client UEs. The SL Positioning Server UE may be able to
store this information.
A SL Positioning Client UE selects a SL Positioning Server UE (with Vetting
functionality) in order for the SL Positioning Client UE to be able to issue
Location Service Request.
The selection of the SL Positioning Server UE by the SL Positioning Client UE
is performed using direct discovery. Both models A and B discovery can be used
as follows (see TS 23.303 [22]), noting Model B discovery may be more
adequate:
\- Model A: a SL Positioning Server UE (\"announcing UE\") announces itself at
least as a SL Positioning Server UE (with Vetting functionality). Client UEs
(\"monitoring UE\") monitor such announcements.
\- Model B: a SL Positioning Client UE (\"discoverer UE\") issues requests
including information it wishes to discover a SL Positioning Server UE (with
Vetting functionality) (\"discoveree UE\").
The SL Positioning Client UE needs to select a SL Positioning Server UE which
is able to discover the Target UE/SL Reference UE.
Once a suitable SL Positioning Server UE is identified by the SL Positioning
Client UE, direct communication between these UEs can thereafter take place to
perform the necessary positioning/ranging procedure.
A SL Positioning Server UE (with Vetting functionality) uses Subscriber SL
Positioning Privacy Profile information from a Target UE, and SL Positioning
Client UE data (such as location request type e.g. positioning/ranging,
accuracy, identity, etc.) to determine whether a SL Positioning Client UE is
authorized and whether this SL Positioning Client UE is authorized to retrieve
the location information of the Target UE.
Resulting from the above, a signalling framework for PC5-MO-LR and PC5-MT-LR
procedures in UE-only scenario are proposed in clause 6.X.3 below for both
Cases I and II described above. No NI-LR procedure is deemed applicable in UE-
only scenario.
All signalling transactions depicted in clause 6.X.3 between Target UE, SL
Positioning Server UE, SL Reference UE operate using the RSPP protocol (see
e.g. Solutions #4, #26).
Editor\'s note: Future coordination with RAN WG2 is expected to ensure
alignment of the procedure details over the RSPP protocol.
Editor\'s note: The protocol used for signalling transactions with the SL
Positioning Client UE (i.e. Service Request/Response, Location Info/Info Ack)
is FFS.
Editor\'s note: It is FFS if the MT-LR and MO-LR model described hereafter
would be further optimized for UE-only operation.
Editor\'s note: It is FFS which functionalities need to be standardized for SL
Positioning Server UE.
Editor\'s note: Discovery Models A and B are referred to in clause 6.X.3. It
is FFS how Model A, Model B discovery over PC5 will be used to discover UE
\"roles\" (e.g. Target UE, SL Positioning Server UE). Whether another channel
(e.g. communication channel) is needed for discovery is FFS and should be
discussed in RAN groups.
Editor\'s note: Details of discovery will be addressed at a future meeting in
alignment with KI#3 solutions
Editor\'s note: Any Authentication/Authorization will be aligned with SA WG3.
Whether it refers to CN-related information is FFS.
### 6.34.3 Procedures
#### 6.34.3.1 Case I: Target UE holds Vetting functionality
##### 6.34.3.1.1 PC5-MT-LR procedure
Figure 6.34.3.1.1-1: PC5-MT-LR Procedure
1\. An application in a SL Positioning Client UE needs to retrieve the
location information of a Target UE. It initiates discovery to discover the
Target UE. The SL Positioning Client UE issues a Service Request message over
PC5 to a Target UE in order to retrieve the location of the Target UE. The
Service Request message contains necessary information allowing the Target UE
to identify the SL Positioning Client UE data incl. the identity, the type of
location request (e.g. positioning/ranging), the accuracy of the location,
etc. If the type of location request requires SL positioning or ranging, one
or multiple SL Reference UE may also be identified in the Service Request.
NOTE 1: The service request may be transmitted from the SL Positioning Client
UE to the Target UE through the SL Reference UE, for the case, e.g. the SL
Positioning Client UE can only discover the SL reference UE.
2\. Upon reception of a Service Request message, the Target UE verifies that
the originating SL Positioning Client UE is authorized. The Target UE uses its
own stored Subscriber SL Positioning Privacy Profile information and the
identified SL Positioning Client UE data in step 1. to determine whether or
not to authorize the SL Positioning Client UE and its location request. If
another UE was identified in step 1, the Target UE verifies that this other UE
is in proximity (e.g. by using the discovery procedure (Model A) with this
other UE) and that this other UE authorizes the positioning/ranging (see
Editor\'s note). If the Target UE determines that the SL Positioning Client
and its location request are not authorized, and/or that a SL Reference UE
included in the location request is not authorized for the
positioning/ranging, the Target UE does not respond to the Service Request and
the procedure stops, otherwise the Target UE proceeds with step 3.
Editor\'s note: The signalling transaction for the Target UE to verify that a
SL Reference UE is authorized for the positioning/ranging is FFS.
3\. If the Target UE determines it requires support from a SL Positioning
Server UE, the Target UE selects a SL Positioning Server UE. The selection of
the SL Positioning Server UE by the Target UE is performed using direct
discovery. Both models A and B discovery can be used as follows (see TS 23.303
[22] for definitions of models A and B):
\- Model A: a SL Positioning Server UE (\"announcing UE\") announces itself at
least as a SL Positioning Server UE. Target UEs (\"monitoring UE\") monitor
such announcements.
\- Model B: a Target UE (\"discoverer UE\") issues requests including
information it wishes to discover a SL Positioning Server UE (\"discoveree
UE\").
For the selection of the SL Positioning Server UE, the Target UE needs to
verify that the candidate SL Positioning Server UE is allowed to be involved
based on the Subscriber SL Positioning Privacy Profile information.
Once a SL Positioning Server UE is selected, direct communication is
established between the Target UE and this SL Positioning Server UE allowing
the procedure to proceed (step 4).
If the Target UE determines instead it does not need support from a SL
Positioning Server UE it proceeds to step 5.
4\. The Target UE issues a Determine Location Request message to the SL
Positioning Server UE, incl. necessary information as required by the SL
Positioning Client UE in step 1. If SL positioning or ranging was requested in
step 1 that includes one or more SL Reference UEs, the SL Reference UE(s) are
also identified in the Determine Location Request message.
NOTE 2: Step 4 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
5\. The UE Positioning (/ranging) is performed by the Target UE or with
support of the SL Positioning Server UE in order to determine the Target UE
location, depending on the outcome of step 3.
NOTE 3: SL Reference UE(s) (e.g. the other UE) may also be invoked at this
point to assist the Target UE or SL Positioning Server UE in determining the
Target UE location.
If support from a SL Positioning Server UE was requested in step 3, step 6
follows, else step 7.
6\. The SL Positioning Server UE reports the calculated Target UE location
information in a Determine Location Response message to the Target UE.
NOTE 4: Step 6 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
7\. The Target UE reports its location information to the SL Positioning
Client UE in a Service Response message.
##### 6.34.3.1.2 PC5-MO-LR procedure
Figure 6.34.3.1.2-1: PC5-MO-LR procedure
1\. This step is triggered in the Target UE e.g. by an application running in
the UE, to retrieve its position (absolute or relative) and, possibly, to
share it with a SL Positioning Client UE (e.g. at regular intervals). If the
location operation requires positioning or ranging vs. another UE, the Target
UE verifies that this other UE is in proximity (e.g. by using the discovery
procedure (Model A) with this other UE) and that the other UE authorizes the
location operation (see Editor\'s Note). If the Target UE determines it
requires support from a SL Positioning Server UE, the Target UE selects a SL
Positioning Server UE. The selection of the SL Positioning Server UE by the
Target UE is performed using direct discovery. Both models A and B discovery
can be used as follows (see TS 23.303 [22] for definitions of models A and B):
\- Model A: a SL Positioning Server UE (\"announcing UE\") announces itself at
least as a SL Positioning Server UE. Target UEs (\"monitoring UE\") monitor
such announcements.
\- Model B: a Target UE (\"discoverer UE\") issues requests including
information it wishes to discover a SL Positioning Server UE (\"discoveree
UE\").
For the selection of the SL Positioning Server UE, the Target UE needs to
verify that the candidate SL Positioning Server UE is allowed to be involved
based on the Subscriber SL Positioning Privacy Profile information.
Once a SL Positioning Server UE is selected, direct communication is
established between the Target UE and this SL Positioning Server UE allowing
the procedure to proceed (step 2).If the Target UE determines instead it does
not need support from a SL Positioning Server UE it proceeds to step 3, and a
direct communication is not established between the Target UE and the SL
Positioning Server UE.
Editor\'s note: The signalling transaction for the Target UE to verify that
the other UE authorizes the positioning/ranging is FFS.
1\. The Target UE issues a Determine Location Request message to the SL
Positioning Server UE, incl. necessary information as required by the intended
location operation.
NOTE 1: Step 2 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
3\. The UE Positioning (/ranging) is performed by the Target UE or with
support of the SL Positioning Server UE in order to determine the Target UE
location, depending on the outcome of step 1.
NOTE 2: SL Reference UE(s) (e.g. the other UE) may also be invoked at this
point to assist the Target UE or SL Positioning Server UE in determining the
Target UE location.
If support from a SL Positioning Server UE was requested in step 1, step 4
follows, else step 5.
4\. The SL Positioning Server UE reports the calculated Target UE location
information in a Determine Location Response message to the Target UE.
NOTE 3: Step 4 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
5\. If necessary (i.e. if reporting to a SL Positioning Client UE is
necessary), the Target UE reports the calculated Target UE location
information to an authorized SL Positioning Client UE.
6\. The SL Positioning Client UE acknowledges receipt of the Target UE
location information from the Target UE.
#### 6.34.3.2 Case II: SL Positioning Server UE holds Vetting functionality
##### 6.34.3.2.1 PC5-MT-LR procedure
Figure 6.34.3.2.1-1: PC5-MT-LR procedure
1\. An SL Positioning Client UE needs to retrieve location information of a
Target UE. It initiates discovery to discover the Target UE. The SL
Positioning Client UE selects a SL Positioning Server UE (with Vetting
functionality). The selection of the SL Positioning Server UE by the SL
Positioning Client UE is performed using direct discovery. Both models A and B
discovery can be used as follows (see TS 23.303 [22] for definitions of models
A and B):
\- Model A: a SL Positioning Server UE (\"announcing UE\") announces itself at
least as a SL Positioning Server UE (with Vetting functionality). SL
Positioning Client UEs (\"monitoring UE\") monitor such announcements.
\- Model B: a SL Positioning Client UE (\"discoverer UE\") issues requests
including information it wishes to discover a SL Positioning Server UE (with
Vetting functionality) (\"discoveree UE\").
The SL Positioning Client UE needs to select a SL Positioning Server UE which
is able to discover the Target UE/SL Reference UE.
Once a suitable SL Positioning Server UE is identified by the SL Positioning
Client UE, direct communication between these UEs can thereafter take place to
complete the procedure.
2\. The SL Positioning Client UE issues a Service Request message over PC5 to
the SL Positioning Server UE in order to retrieve the location of the Target
UE. The Service Request message contains necessary information allowing the SL
Positioning Server UE to identify the SL Positioning Client UE data incl. the
identity, the type of location request (e.g. positioning/ranging), the
accuracy of the location, etc. as well as the Target UE. If the type of
location request requires SL positioning or ranging, one or more SL Reference
UEs may also be identified in the Service Request.
If the SL Positioning Server UE holds Subscriber LCS Privacy Profile
information of the Target UE it proceeds to step 5, otherwise step 3.
NOTE 1: If a SL Reference UE is identified in the Service Request, the SL
Positioning Server UE proceeds the same way with verifying the SLPP
information of the SL Reference UE.
3\. After discovering the Target UE and establishing direct communication with
the Target UE, the SL Positioning Server UE issues an Subscriber SL
Positioning Privacy Profile Information Request message to the Target UE to
retrieve its Subscriber SL Positioning Privacy Profile Information.
4\. The Target UE upon receiving the Subscriber SL Positioning Privacy Profile
Information Request message from the SL Positioning Server UE responds with an
Subscriber SL Positioning Privacy Profile Information Response message
including the Target UE\'s Subscriber SL Positioning Privacy Profile
information.
5\. The SL Positioning Server UE verifies that the SL Positioning Client UE is
authorized. The SL Positioning Server UE uses the Subscriber SL Positioning
Privacy Profile information of the Target UE (and, of the SL Reference UE(s)
as applicable) and the identified SL Positioning Client UE data in step 2 to
determine whether or not to authorize the SL Positioning Client UE and its
location request. If the SL Positioning Client UE (and associated location
request) is not authorized the SL Positioning Server UE may reject the Service
Request from the SL Positioning Client UE. If the SL Positioning Client UE is
authorized, the SL Positioning Server UE proceeds with step 6.
6\. The SL Positioning Server UE forwards the authorized Service Request to
the Target UE. If the Target UE determines it needs support from the SL
Positioning Server UE to determine its location, it proceeds to step 7,
otherwise step 8.
7\. The Target UE issues a Determine Location Request message to the SL
Positioning Server UE, incl. necessary information as required by the Client
in step 1. If SL positioning or ranging was requested in step 1 (resp. Step 6)
that includes one or more SL Reference UEs, then th SL Reference UE(s) are
also identified in the Determine Location Request message.
NOTE 2: Step 7 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
8\. The UE Positioning (/ranging) is performed by the Target UE or with
support of the SL Positioning Server UE in order to determine the Target UE
location, depending on the outcome of step 6.
NOTE 3: SL Reference UE(s) may also be invoked at this point to assist the
Target UE or SL Positioning Server UE in determining the Target UE location.
If support from a SL Positioning Server UE was requested in step 6, step 9
follows, else step 10.
9\. The SL Positioning Server UE reports the calculated Target UE location
information in a Determine Location Response message to the Target UE.
NOTE 4: Step 9 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
10\. The Target UE reports its location information in a Service Response
message to the SL Positioning Server UE which in turn forwards it to the SL
Positioning Client UE.
##### 6.34.3.2.2 PC5-MO-LR procedure
Figure 6.34.3.2.2-1: PC5-MO-LR procedure
1\. This step is triggered in the Target UE e.g. by an application running in
the UE, to retrieve its position (absolute or relative) and, possibly, to
share it with a SL Positioning Client UE (e.g. at regular intervals). If the
location operation requires SL positioning or ranging with a SL Reference UE,
the Target UE verifies that this SL Reference UE is in proximity (e.g. by
using the discovery procedure (Model A) with this other UE). If the Target UE
determines it requires support from a SL Positioning Server UE, the Target UE
selects a SL Positioning Server UE. The selection of the SL Positioning Server
UE by the Target UE is performed using direct discovery. Both models A and B
discovery can be used as follows (see TS 23.303 [22] for definitions of models
A and B):
\- Model A: a SL Positioning Server UE (\"announcing UE\") announces itself at
least as a SL Positioning Server UE. Target UEs (\"monitoring UE\") monitor
such announcements.
\- Model B: a Target UE (\"discoverer UE\") issues requests including
information it wishes to discover a SL Positioning Server UE (\"discoveree
UE\").
For the selection of the SL Positioning Server UE, the Target UE needs to
verify that the candidate SL Positioning Server UE is allowed to be involved
based on the Subscriber SL Positioning Privacy Profile information.
Once a SL Positioning Server UE is selected, direct communication is
established between the Target UE and this SL Positioning Server UE allowing
the procedure to proceed (step 2).
If the Target UE determines instead it does not need support from a SL
Positioning Server UE it proceeds to step 3.
2\. The Target UE issues a Determine Location Request message to the SL
Positioning Server UE, incl. necessary information as required by the intended
location operation. If the type of location request requires SL positioning or
ranging with one or more SL Reference UEs, the SL Reference UE(s) are also
identified in the Determine Location Request message. The SL Positioning
Server UE verifies that the location operation with the other UE is authorized
(following if necessary similar steps as steps 3, 4 and 5 in clause
6.34.3.2.1, i.e. Subscriber SL Positioning Privacy Info Req/Resp with, and
Vetting of the SL Reference UE).
NOTE 1: Step 2 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
3\. The UE Positioning (/ranging) is performed by the Target UE or with
support of the SL Positioning Server UE in order to determine the Target UE
location, depending on the outcome of step 1.
NOTE 2: SL Reference UE(s) may also be invoked at this point to assist the
Target UE or SL Positioning Server UE in determining the Target UE location.
If support from a SL Positioning Server UE was requested in step 1, step 4
follows, else step 5.
4\. The SL Positioning Server UE reports the calculated Target UE location
information in a Determine Location Response message to the Target UE.
NOTE 3: Step 2 may be skipped if the Target UE does not determine to involve
SL Positioning Server UE.
5\. If necessary (i.e. if reporting to a SL Positioning Client UE is
necessary), the Target UE reports the calculated Target UE location
information to the SL Positioning Server UE, with necessary information
allowing identification of the SL Positioning Client UE. The Target UE
includes its SLPP information, which, together with the Client information
allows the SL Positioning Server UE to determine whether the SL Positioning
Client UE is authorized. If so, the SL Positioning Server UE forwards the
location information to the authorized SL Positioning Client UE.
6\. The SL Positioning Client UE acknowledges receipt of the Target UE
location information from the SL Positioning Server UE which in turn forwards
it to the Target UE.
### 6.34.4 Impacts on services, entities, and interfaces
UE: Support of PC5-MO-LR and PC5-MT-LR procedures for Case I and/or Case II
including:
\- Support of SL Positioning Server UE selection by Target UE or SL
Positioning Client UE.
\- Support of SL Positioning Client UE authorization incl. support storage of
Subscriber LCS Privacy Profile information and identification of SL
Positioning Client UE data by Target UE or SL Positioning Server UE.
\- (SL Positioning Client UE) Support of location requests/responses
pertaining to SL positioning/ranging.
# 7 Evaluation
Editor\'s note: This clause provides the evaluations of the solutions of
clause 6.
## 7.1 Key Issue #1: Support of authorisation and policy/parameter
provisioning to UE and Key Issue #8: Service Authorization to NG-RAN
This clause evaluates the solutions captured in Table 6.0-1 for KI#1 and KI#8.
**Sol#1: KI#1 and KI#8**
It proposes to reuse the procedures specified for ProSe in TS 23.304 [4] and
for V2X in TS 23.287 [3] to provision the Ranging/SL positioning service
authorization and policy/parameter to the UE and service authorization to RAN.
The Registration Procedure, UE Configuration Update procedure for transparent
UE Policy Delivery, UE Policy Association Establishment procedure, and UE
Policy Association Modification procedure are used with some necessary
enhancement. Some additional Ranging/SL positioning parameters provided to the
UE from PCF are proposed, and some additional Ranging/SL positioning service
authorization parameters provided to the RAN from AMF are proposed.
**Sol#2: KI#1**
It is assumed that all Ranging/SL positioning capable UEs are ProSe or V2X
capable. The UE will be provisioned with either V2XP or ProSeP together with
the Ranging/SL positioning policy/parameter, i.e. Ranging/SL positioning
policy/parameter is part of V2XP or ProSeP. Additionally, the whole parameters
are divided into Ranging/SL Positioning specific parameters and ProSeP/V2XP
shared parameters. It proposes to reuse the procedures specified for ProSe in
TS 23.304 [4] and for V2X in TS 23.287 [3] to provision the Ranging/SL
positioning service authorization and policy/parameter provisioning to the UE.
Whether the Ranging/SL positioning policy/parameter is a standalone or part of
V2XP or ProSeP can be determined later.
**Sol#14: for KI#1 and KI#8**
It gives a reference architecture for Sidelink Positioning and Ranging-based
services applicable to all KIs. When UE A or UE B are served by NG-RAN, the UE
A and UE B may communicate with LMF, re-using enhanced procedures of LCS. When
UE C and UE D are out of coverage, or with partial network coverage, the
Sidelink Positioning and Ranging services can be performed without the network
involvement.
**Sol#15: KI#8**
It is assumed that Ranging/Sidelink positioning is always used together with
5G ProSe or V2X or both service(s). The NG-RAN node will be provisioned with
either V2X service authorization or ProSe service authorization, together with
the Ranging/SL positioning service authorization, i.e. Ranging/SL positioning
service authorization is part of V2X service authorization or ProSe service
authorization. Additionally, the ProSe/V2X Service Authorization of the
subscription data in UDM is extended to include Ranging/Sidelink positioning
information, e.g. Ranging/Sidelink positioning reference UE, target UE,
assistant UE, Located UE. It proposes to reuse the procedures specified for
ProSe in TS 23.304 [4] and for V2X in TS 23.287 [3] to provision the
Ranging/SL positioning service authorization to the NG-RAN node. Whether the
Ranging/SL positioning service authorization is a standalone or part of V2XP
service authorization/ProSeP service authorization can be determined later.
## 7.2 Key Issue #2: Ranging service operation procedure with the assistance
of another UE
This clause evaluates the solutions related to KI#2, which are Sol#10, Sol#14,
Sol#16, Sol#17, Sol#26, Sol#27, Sol#28, Sol#29, and Sol#30. The solutions can
be summarized and evaluated in detail as the following.
\- Sol#10 (related to KI#2 and KI#6) proposes that a SL Positioning Client UE
consumes the Ranging/Sidelink positioning service from an Assistant UE which
performs the Ranging procedure with UE1 and UE2 respectively and calculate the
ranging result. The ranging and positioning procedure with UE1 and UE2 is
based on other solutions of KI#4
\- Sol#14 and Sol#19 propose a general reference architecture for Sidelink
positioning and ranging-based services, which are related to all KIs.
Conclusions from RAN WGs are needed to discuss the feasibility of the proposed
architecture.
\- Sol#16 proposes that the direct ranging procedure defined by the solutions
for KI#4 can be directly used for the direct ranging between Assistant UE(s)
and UE1, and the direct ranging between Assistant UE(s) and UE2. And the two
direct ranging procedures can be performed at the same scheduled ranging time
to get more accuracy ranging result. UE1 and UE2 can send the ranging
request/response to each other over PC5 direct connection or UE-to-UE Relay
connection. The ranging procedure between Assistant UE(s) and UE1 is triggered
by UE1 and the ranging procedure between Assistant UE(s) and UE2 is triggered
by UE2. The solution applies to multiple Assistant UEs case. Two options on
Assistant UE selection are proposed, and the selection of Option A (Assistant
UE selection by UE2) or Option B (Assistant UE selection by UE1) can consider
the UE-to-UE Relay selection mechanism for a consistent UE action. The Ranging
measurement/result between the Assistant UE(s) and UE1 and that between the
Assistant UE(s) and UE2 are used to derive the Ranging result between UE1 and
UE2, by UE1 as initiator UE, instead of Assistant UE(s). The benefit is that
the Assistant UE(s) just assists the ranging operation but does not get the
ranging result of the around UEs.
\- Sol#17 proposes that UE1 selects Assistant UE and triggers Assistant UE to
perform ranging procedure with UE2. In this solution, UE1 broadcast the
Ranging/Sidelink positioning request, and if no response from UE2 is received,
it selects one or multiple assistant UE who sends the response first. After
that, UE1 initiates Ranging/Sidelink positioning procedure with the selected
Assistant UE(s), which then also trigger the Assistant UE(s) to perform
ranging with UE2. The measurement data are finally shared among UE1, UE2 and
the Assistant UE(s) for result calculation.
The main difference between Sol#16 and Sol#17 includes
\- Assistant UE selection: UE1 or UE2 selects Assistant UE (Sol#16), UE1
selects Assistant UE (Sol#17)
\- Ranging procedure between Assistant UE(s) and UE2: initiated by UE 2
(Sol#16), initiated by Assistant UE (Sol#17)
\- Result calculation: UE1 calculates raging result (Sol#16), Assistant UE or
UE1 or UE2 calculates raging result (Sol#17),
\- Sol#26 proposes a functional split and positioning protocol to enable the
support of SL positioning and ranging. It focuses on the concept of \"Location
Server\", and proposes that the functionality offered to the UE by a location
server can also reside in a UE (no longer limited as a \"network\" entity),
termed as a \"SL Positioning Server UE\", to support ranging/SL positioning
operations between UEs without any network involvement. The SL Positioning
Server UE can provide assistant info to Target UE or obtain reference info
from Reference UE. Security issues should be considered by SA3 WG for this
newly introduced UE type.
\- Sol#27 mainly discusses LMF selection for its involvement in
Ranging/Sidelink positioning, and is related to KI#2, KI#3, KI#4, KI#5, KI#6,
and KI#7.
\- Sol#28 specifies the LMF involved Ranging/Sidelink positioning procedures.
3 modes of ranging result calculation are defined, which are UE-based, LMF-
based and hybrid calculation. LMF determines the result calculation mode based
on LMF/UE capability, UE preference and operator policy. This solution
provides a general procedure of LMF triggered Ranging/Sidelink positioning,
which can be applied to Ranging/Sidelink positioning with assistant UE,
Network assisted Sidelink positioning, and Ranging/Sidelink positioning
exposure to a SL Positioning Client UE, AF or 5GC NF.
\- Sol#29 addresses Assistant UE involved periodic ranging. It specifies a
common scenario for V2X applications where fixed Assistant UEs (e.g. RSUs)
help to track the relative position of two moving cars on a highway with
another car in-between. To maintain the assistive ranging service when the
working Assistant UE is too far from the targets to continue its ranging
assistance, the solution proposes that during each cycle of the periodic
ranging, the Target UE itself performs ranging service check to determine
whether it is necessary to initiate a new round discovery for a new Assistant
UE. This solution can be compatible with other solutions, and serve as a
supplement to address the periodic ranging scenarios.
\- Sol#30 proposes that the UE1 and UE2 perform ranging measurement with the
selected assistant UEs independently, and share the ranging result to complete
ranging calculation. The Assistant UEs are discovered and selected by UE1 and
UE2 by any solutions for KI#3, and are only involved in measuring but not in
result collection or calculation. Sol#16 and Sol#30 shares same principles,
such as UE2 is reachable by UE1 via direct communication or relay, UE2
initiates ranging procedure with Assistant UE and the Assistant UE is not
involved to final ranging result calculation for privacy protection. The main
difference between Sol#16 and Sol#30 is Assistant UE discovery and selection:
\- Sol#30 reuses discovery solutions of KI#3 and enhance Ranging/Sidelink
positioning request/response for Assistant UE selection, no additional impact
Assistant UE
\- Sol#16 proposes that Assistant UE needs to discover UE2 based on discovery
message received from UE1, and Assistant UE is selected during discovery
procedure.
## 7.3 Key Issue #3: Ranging/Sidelink Positioning device discovery
For Key Issue #3 \"Ranging/Sidelink Positioning device discovery\", the
Solution#4, #5, #14, #18, #26, #27 and #28 can be summarized and evaluated as
the following:
\- Sol#4 proposes the Model A and Model B Direct Discovery as defined in TS
23.304 [4] are reused as basis for Ranging/Sidelink Positioning devices
discovery. For Model A discovery, it is proposed Target UE sends an
Announcement message containing the Ranging/Sidelink Positioning related
parameters and Reference UEs monitor the Announcement message. For Model B
discovery, it is proposed Reference UE sends a Solicitation message containing
Ranging/Sidelink Positioning related parameters and Target UE responds to the
Reference UE with a Response message containing Ranging/Sidelink Positioning
related parameters. Discovery mechanism for V2X usage is not mentioned.
\- Sol#5 proposes the Reference UE or Target UE broadcasts a Ranging/Sidelink
Positioning Request message that contains the parameters provided by
application layer, and the Reference UE/Target UE responds if the Application
Layer ID is matched.
\- Sol#14 introduces a new reference point SR5 that is used to control the
Sidelink Positioning and Ranging operation over the PC5 reference point
between the UEs. Device and Service Discovery Function (DSDF) over the V2X/5G
ProSe layer is introduced to discover and identify the UE(s) in proximity that
can participate in Sidelink Positioning and Ranging service sessions. The
discovery is carried out over SR5 over PC5 reference point between the UEs
using PC5 communication service provided by ProSe or V2X layer.
\- Sol#18 focuses on the network triggered ranging device discovery. It
proposes one UE sends the ranging device discovery request to the network,
then the network notifies the peer UE to turn on or activate the ranging
device discovery. After receiving the notification from the network, the peer
UE initiates the ranging device discovery with the UE. This solution includes
two alternatives, i.e. 5GC based network triggered ranging device discovery
and Application layer-based Network triggered ranging device discovery. The
former is performed over the Control plane assuming same LMF is selected for
the 2 UEs and the 2 UEs are from same PLMN, and the latter is performed over
the application layer which is out of SA2 scope. This solution allows the
Ranging/SL Positioning UEs to switch off the discovery functionality, e.g. for
the purpose of power saving, and switch on based on the network instruction,
applying only to the In Coverage case to trigger and receive network
instruction.
\- Sol#26 focuses on the functional split and positioning protocol to enable
the support of Sidelink (SL) positioning (and Ranging), implying that
Ranging/Sidelink Positioning device discovery is part of RSPP protocol.
\- Sol#27 focuses on LMF selection for Ranging/Sidelink positioning by the
AMF. It is not clear how Ranging/Sidelink Positioning device discovery is
performed in this solution.
\- Sol#28 proposes a solution that uses LMF for Ranging/Sidelink positioning.
It is not clear how Ranging/Sidelink Positioning device discovery is performed
in this solution.
## 7.4 Key Issue #4: Control of Operations for Ranging/Sidelink positioning
For Key Issue #4: \"Control of Operations for Ranging/Sidelink positioning\",
based on Table 6.0-1, the solutions can be summarized and evaluated as the
following:
\- Solution #3 proposes 2 layers, which are \"Ranging Layer\" and \"AS
layer\". \"Ranging Layer\" performs the ranging parameter coordination between
the UEs and provides the ranging configuration to the \"AS layer\". \"AS
layer\" transmits or receives Ranging signalling and performs measurements
according to the ranging configuration. The ranging configuration includes the
Ranging role (Reference UE or Target UE), one time or periodic ranging,
ranging for distance or direction measurement or both. It addresses the case
of direct Ranging/Sidelink positioning between 2 UEs, assuming that either
Reference UE or Target UE performs as SL positioning server UE.
\- Solution #4 proposes Ranging/SL Positioning layer on top of V2X/ProSe layer
for Ranging/SL Positioning control, i.e. to exchange the coordination &
configuration information (i.e. Ranging capability, Ranging assistant data and
measurement results) and the Ranging/Sidelink positioning signal measurement
results using RSPP. RSPP is over PC5-S. It addresses the case of direct
Ranging/Sidelink positioning between 2 UEs, assuming that either Reference UE
or Target UE performs as SL positioning server UE.
\- Solution #5 assumes there\'s an Application layer on top of a Ranging
layer. The application layer provides Ranging/Sidelink Positioning parameters
to Ranging layer. The Ranging layer triggers the service, and provides the
result to the Application layer, assuming Sidelink Positioning procedure
defined by RAN.
\- Solution #14 introduces SR5 interface to control the Sidelink Positioning
and Ranging operation over the PC5 reference point between the UEs. Device and
Service Discovery Function (DSDF), Group Support Service Function (GSSF),
Sidelink Positioning and Ranging Function (SPRF) are introduced on top of
ProSe/V2X Layer. In order to be supported over PC5, the three services, i.e.
DSDF, GSSF, and SPRF, should obtain a V2X Service Type (e.g. PSID, ITS-AID, or
AID) or a ProSe Application ID. LMF may be involved when all the UEs are in
coverage. For out of coverage and partial coverage cases, no involvement of
LMF. Whether measurement results or Sidelink Positioning or Ranging results
are exchanged over the SR5 depends on the negotiation during the control
signalling.
\- Solution #19 introduces information exchanged between Application layer and
Device and Service Discovery Function (DSDF)/ Group Support Service Function
(GSSF)/ Sidelink Positioning and Ranging Function (SPRF). PC5-U is used for
SR5 with non-IP PDCP SDU type in the case of V2X UEs and non-IP PDCP SDU type/
\"unstructured\" PDCP SDU type in the case of 5G ProSe UEs. It supports
multiple UEs to participate in the operation. SPRF signalling is introduced
for the control signalling between the UEs to determine the corresponding
Sidelink Positioning and Ranging operation (e.g. the channel to use for the
Sidelink Positioning or Ranging reference signal, the sequence and time slot
for each of the UE to perform the signal transmission and measurements), to
exchange the measurement results and to provide the computing service either
by a central SL Positioning Server UE or by all UEs.
\- Solution #26 introduces SL Positioning Server UE. RSPP shall be able to
operate between a Target UE and a SL Positioning UE, between a Reference UE
and a SL Positioning UE and between a Target UE and a Reference UE. RSPP is
considered to be over PC5-S. RSPP shall be able to operate over the Control-
Plane between a Target UE and a LMF. RSPP should be defined as a
\"standalone\" extension of LPP i.e. RSPP can be supported (esp. in a SL
Positioning Server UE) without having to support the entire LPP, while LMF
already supporting LPP can be upgraded with the RSPP extension.
\- Solution #27 defines AMF selects a Ranging/SL positioning capable LMF when
LMF needs to be involved based on service request and LMF capabilities.
\- Solution #28 introduces Ranging/Sidelink positioning result calculation
modes (UE based, LMF based, Hybrid), and the mode is determined based on LMF
Ranging/Sidelink positioning capability, UE Ranging/Sidelink positioning
capability, UE preference and Operator policy. Information of LMF
Ranging/Sidelink positioning capability, UE Ranging/Sidelink positioning
capability and UE preference are exchanged between UE and LMF and between UEs.
\- Solution#32 defines how to position a Target UE by multiple Reference UEs,
in which control signalling is exchanged between the Target UE and the LMF for
providing the list of selected Reference UEs/Located UEs and between the
Reference UEs and the LMF for providing the measurement data for calculation.
When the target UE is out of coverage, the control signalling exchange is
through the Reference UE who are in coverage. When none of the Target UE and
the Reference UEs are in coverage, a SL Positioning Server UE has to be
discovered for the result calculation.
The commonalities and differences are summarized as the following:
\- A new layer is introduced between application layer and lower layers to
handle service request received from application layer and to control the
Sidelink Positioning and Ranging operation. (Solution #3, #4, #5, #14 and
#19).
\- A new protocol is introduced for SR5 over the PC5 reference point between
the UEs, and this new protocol can be over PC5-S (Solution #4 and #26) or
PC5-U (Solution #14 and #19).
\- A LMF may be involved when at least one of the Target UE and the Reference
UE are in the network coverage (Solution #14, #19, #26, #28 and #32). In that
case a suitable LMF needs to be selected by the AMF based on the LMF
capabilities and the service requests (Solution #27). The protocol used
between UE and LMF will be decided by RAN and could be an extension of LPP, a
new protocol or both.
\- A SL Positioning Server UE can be discovered and selected for result
calculation for the case of partial coverage and out of coverage (Solution
#14, #19, #26 and #32).
\- Multiple UEs may be involved in a single Ranging/Sidelink Positioning
session. (Solution #14, #19 and #32).
\- Whether measurement results or Sidelink Positioning/Ranging results are
exchanged over the SR5 depends on the negotiation during the control
signalling (Solution #14 and #28).
## 7.5 Key Issue #5: Network assisted SL Positioning
### 7.5.1 General
The following solutions address the KI#5.
**Solution#6**
Case1: MO-LR with that the Target UE is not able to have NAS connection with
network: The Located UE broadcasts a discovery message that it is capable to
assist in the SL positioning. The Target UE discovers the Located UE and sends
a sidelink positioning request to the Located UE. The Located UE performs
ranging procedure with the target UE and include the Ranging/Sildelink
positioning assistant data in the 5GC-MO-LR to the LMF. The LMF performs
network assisted UE positioning of the Located UE. The LMF uses the results
from both positioning procedures and provides the location of the Target UE to
the Located UE. The Located UE send the location result to the Target UE.
Case2: MO-LR with that the Target UE is able to have NAS connection with
network: The Target UE performs ranging procedure with the Located UE and the
Target UE includes the Ranging/Sildelink positioning assistant data and the ID
of the Located UE in the 5GC-MO-LR message to the LMF. The LMF performs
network assisted UE positioning of the Located UE, LMF then uses the results
from both positioning procedures and returns the location of the Target UE to
the Target UE.
**Solution#7**
MT-LR: The Target UE receives the DL positioning message from the LMF. The
Target UE discovers a Located UE and performs ranging procedure with the
Located UE. The Target UE includes the ranging result and the ID of the
Located UE in the UL positioning message to the LMF (the UL message could also
include measurement result of neighbouring gNBs). The LMF performs MT UE
positioning of the Located UE. The LMF uses the results and calculate the
location of the Target UE.
**Solution#8**
MT-LR: The LMF triggers one or more UEs to perform discovery of a Target UE by
providing an APP ID of the Target UE. The LMF triggers the Target UE in to
perform discovery of a Located UE (the UEs above) by providing the APP ID of
the Located UE. The Target UE provides the discovery report to the LMF and the
LMF decides which UE shall act as Located UE. The LMF informs which of the
discovered UEs the Target UE shall perform ranging/SL positioning with. The
Target UE reports the ranging/SL positioning measurements to the LMF and the
LMF calculates the position of the Target UE using the location of the
Location UE obtained before the ranging/SL positioning was performed.
**Solution#12**
MT-LR: The AF trigger location service via NEF (absolute or relative
position), the request may include location of several UEs. The Request goes
to the GMLC which forwards the location request to the AMF that serves the
Target UE. The AMF pages the Target UE(s) and each AMF selects a LMF that can
provide the ranging/SL positioning service. The AMF send a location request to
the LMF. The LMF checks the UE(s) ProSe Capabilities with the AMF. The LMF
interacts with PCF to initiate Relay operation for location Reporting. PCF
configures the UE(s) with RSC(s). The UEs involved perform discovery and set
up PC5 connection. The PCF reports to the LMF that the relay configuration is
complete. The LMF selects one Located UE to act as a location relay and
perform ranging/SL positioning with one or more Target UEs. The Located UE
provides the ranging and SL positioning measurement reports to the LMF and the
LMF calculates the location of all the Target UEs and provide this information
to the AMF(s), then AMF to GMLC, then GMLC to AF (via NEF). In this solution
the LPP location Request to locate the Target UE goes to the Located UE
instead of the Target UE, even if the AMF paged the Target UE to secure NAS
connection with the Target UE.
**Solution #19**
MO-LR: A target UE that is in network coverage may discover one or more other
UEs (e.g. assistant UEs and/or located UEs) and sends an MO-LR request to a
serving AMF requesting location information (absolute locations, relative
locations or ranges) for itself and possibly the other UEs. The AMF transfers
the request to an LMF which obtains the capabilities of all the UEs, may
provide assistance data to the UEs, and instigates sidelink positioning among
the UEs. Location results can be calculated by the target UE if capable or by
the LMF which then returns the results to the target UE.
MT-LR: An LCS Client or AF requests location information (absolute locations,
relative locations or ranges) for a group of two or more UEs known to be
nearby to one another and with at least one of the UEs in network coverage. A
normal Uu MT-LR procedure is used to send the location request to a serving
AMF for one of the UEs that is in network coverage. The AMF then forwards the
request to an LMF. The LMF sends the MT-LR request to the UE that is in
network coverage with identities for the other UE(s). This UE then discovers
the other UE(s) and responds to the LMF on whether the MT-LR is possible.
Location of the group of UEs then occurs using the same procedure as for the
MO-LR and location result information is returned to the LCS Client or AF. A
periodic or triggered MT-LR for a group of two or more UEs can be supported by
extending the MT-LR procedure similarly to the periodic or triggered MT-LR
procedure for Uu positioning in TS 23.273 [11].
**Solution#20**
MT-LR: The Target UE receives a DL positioning message instructing the target
UE to discover a Located UE. The Target UE discovers a Located UE and returns
the ID of the Located UE to the LMF. The LMF triggers the GMLC to retrieve the
location of the Located UE at a certain time T and returns the location to the
LMF. In parallel the LMF triggers the Target UE to perform ranging procedure
with the Location UE at time T. The Target UE returns the ranging measurement
result to the LMF. The LMF uses the results and calculates the location of the
Target UE.
MO-LR: Target UE discovers a Located UE and sends an MO-LR including the ID of
the Located UE and a certain time T. The LMF triggers the GMLC to determine
the Location UE location at time T and receives the Location UE location from
the GMLC. The LMF sends a DL positioning message to the Target UE to perform
the ranging procedure (at time T). The Target UE returns the ranging result to
the LMF. The LMF uses the results and calculates the location of the Target
UE. The location result is returned to the Target UE in the MO-LR Response.
MT-LR with Target UE out of coverage: When GMLC does not get the Target UE's
AMF address from UDM or get the unreachable indication from Target UE's AMF,
GMLC determines to use Network assisted sidelink positioning to locate the
target UE and GMLC selects a Located UE (i.e., UE2) based on the target area.
GMLC triggers the LCS procedure of Located UE defined in TS 23.273 [11] to get
the location of the Target UE.
**Solution#21**
MT-LR: This solution addresses the case where Target UE is out of coverage of
the network (i.e. no direct NAS connection). GMLC receives the LCS service
request from AF/LCS client, and GMLC determines the serving AMF based on UE
status and information in the LCS service request, and sends the request to
the selected AMF. AMF determines the list of Located UEs, and sends the LCS
service request to the LMF including the Target UE ID and IDs of one or
Multiple Located UEs. The LMF sends a LCS service request to the one or more
Located UEs. The Located UE(s) discovers the Target UE, performs ranging
procedure with the Target UE and report the result or measurement data to the
LMF. The LMF triggers the location determination of the Located UE(s). The LMF
uses the measurement results/data to calculate the location of the Target UE
and returns the location result to the AMF.
**Solution#31**
MT-LR: Deferred MT-LR is proposed to trigger location report from target UE
when it enters out of coverage through located UE or UE2NW relay UE. The AMF
provides together with Location Request a list of Located UEs that the LMF can
use as Located UEs. The AMF also includes a Security Container to be used by
the Target UE to validate the ranging/SL positioning request from the Located
UE. The LMF sends a SL positioning request to one of the Located UEs. The
Located UE performs PC5 discovery of the Target UE and setup a PC5 unicast
connection. The Located UE send a SL positioning request including the
security container to the Target UE. After the Target UE have validated the
request, the Located UE proceeds with the SL positioning and reports the
measurement to the LMF. The LMF uses the measurement results and calculates
the location of the Target UE and returns the location result to the AMF. In
this solution there is no NAS connection with the Target UE as the Target UE
is out-of-coverage.
**Solution#32**
An AF may provide constellation information related to Located UEs. The LMF
stores data on potential Located UE including e.g. geographical info, location
related capabilities.
Case 1: The LMF triggers MT-LR of the Target UE or the Target UE triggers MO-
LR. The Target UE initiates discovery and PC5 connection with one of the
Located UEs, the Located UE ID to which the Target UE has established a
ranging connection to are reported to the LMF. The LMF instructs the Target UE
and Located UE to invite other Located UEs to the location session. The Target
UE can then try to perform ranging/SL positioning with all of them. Optionally
the Located UEs will perform ranging/SL positioning with the other Located UEs
also (for additional accuracy). All UEs involved in the session report their
measurement data to the LMF. The LMF calculates the location and reports the
location to the requesting node. In this case the Target UE has a NAS
connection with the AMF.
Case 2: MT-LR: This is the same as case 1, but in this case one of the Located
UEs service as a relay for the NAS signalling between the AMF and the Target
UE.
Case 3: MO-LR: In this case the LMF configures a Located UE with the
constellation info, when the Located UE was in-coverage. This Located UE has
the functionality to calculate the position of the Target UE, based on
ranging/SL positioning data and its own location. The Located UE has the
capability of a SL Positioning Server UE.
### 7.5.2 Privacy/SA3 considerations
For solution#6 (alt1) and solution#32 (case 3) the Located UE has or receives
the final location information of the Target UE. Solution #12, #21 and #31
have the ranging/SL positioning information of the Target UE and could use
that information to estimate the location of the Target UE. Before these
solutions can be considered SA WG3 needs to evaluate the impact on UE privacy.
Solution#31 introduces a new security container which SA3 needs to evaluate.
## 7.6 Key Issue #6: Ranging and sidelink positioning service exposure to a UE
This clause evaluates the solutions captured in Table 6.0-1 for KI#6 as
following.
\- Sol#9 gives 2 potential cases for ranging service exposure to UE which
includes Two UEs case and Three UEs case. For the Two UEs case, UE1 initiates
the Ranging/SL positioning operation with the UE2 directly over PC5 and then
calculate the Ranging result locally. For the Three UEs case, the SL
Positioning Client UE consumes the Ranging/SL positioning service of UE#1
either through PC5 directly or through 5GC. When to invoke the ranging
services via PC5 directly, UE#1 triggers ranging process with UE#2 and
calculates the ranging result for the SL Positioning Client UE. For the
service exposure to the SL Positioning Client UE via 5GC, 5GC is responsible
for invoking the ranging service of UE#1 and calculating the ranging result
for SL Positioning Client UE. For this process, it potentially needs the
involved UEs should belong to same PLMN. If belonging to different severing
5GC NFs, interactions among 5GC NFs are necessary needed.
\- Sol#10 gives a procedure for ranging service exposure and invocation over
PC5 directly. This solution takes the Assistant UE or a reference UE as the
ranging service provider who needs to be discovered and selected first. After
that, the Ranging service consumer (e.g. UE#1, SL Positioning Client UE) sends
request to ranging service provider to invoke the ranging services for
obtaining the ranging result between Target UEs. Ranging service provider
performs the ranging procedure with Target UEs based on solution of KI#4 and
returns the ranging result to the Ranging service consumer.
\- Sol#11 proposes to use exposure API over user plane to access the Ranging
and sidelink positioning service exposure. In this solution, Registration
procedure needs to be enhanced so the AMF checks the UE subscription if the UE
is allowed to use the service API for Ranging service exposure and provides
the UE with the onboarding information. After that, the UE performs the
Onboarding of an API Invoker procedure in clause 8.1 of TS 23.222 [12] with
setting the Service API to the Ranging and SL positioning service exposure
API. Then, the UE uses the Service API as specified for Ranging and SL
positioning service exposure.
\- Sol#14 and#19 proposes a general reference architecture for Sidelink
positioning and ranging-based services. In this solution, the functionalities
of new reference points (e.g. SR1, SR5) and existing reference points
enhancement for ranging are defined. For ranging operations, it proposes to
use PC5-U to carry the SR5 signalling such as the Ranging control signalling
and discovery message. The Ranging services, including Device and Service
Discovery Function (DSDF), Group Support Service Function (GSSF) and Sidelink
Positioning and Ranging Function (SPRF), are considered as 3 kinds of
V2X/ProSe services from the V2X/ProSe layer perspective and use existing PC5
communication to realize the SR5 interactions. Whether SR5 will be over PC5-U
will be subject to RAN WGs conclusions.
\- Sol#22 is related to KI#6 and KI#7. This solution invokes the Ranging
service via 5GC. LMF is enhanced to determine the positioning methods with UE
capability consideration after receiving the ranging request. After
determination, LMF initiates the Ranging/SL positioning between UE1 and UE2,
and/or Uu positioning of UE#1 and UE#2. Then LMF calculates the ranging result
between UE#1 and UE#2 based on Uu position and SL ranging measurement. This
solution potentially requires that all the involved UEs are belong to same
PLMN and 5GC NFs interaction between each other due to different serving NFs.
\- Sol#25 has similarly thinking to So#9 on the SL Positioning client UE
consuming the ranging services through Uu or PC5. For invoking the ranging
service via 5GC, there is not LMF involvement and the AMF is responsible for
invoking the ranging service of UE. In addition, this solution enhances the
GMLC functionality which requires to maintain the mapping between Application
Layer ID(s) and SUPI of the UE for later corresponding NFs querying.
Similarly, this solution also requires that all the involved UEs are belong to
same PLMN and 5GC NFs interaction between each other due to different serving
5GC NFs.
\- Sol#26 proposes a functional split and positioning protocol to enable the
support of Sidelink (SL) positioning (and Ranging). This solution proposes to
introduce the location server UE to help the calculation of Ranging result.
Considering that the Location server UE is involved to the ranging and SL
positioning, security issues need to be considered and subject to SA3 groups
conclusions.
\- Sol#27 more focuses on the LMF selection with taking the Ranging and SL
positioning requirements into account.
\- Sol#28 proposes the LMF to be involved in Ranging/Sidelink positioning. In
this solution, 3 modes on ranging result calculation are introduced including
UE based, LMF based and Hybrid. when to decide ranging result mode, capability
interaction between UE and LMF is needed.
\- Sol#33 mainly introduces the usage of Location server UE for ranging result
calculation when ranging UEs are not able to calculate the ranging result. The
ranging result calculation is proposed to be performed in Location server UE
firstly, if it fails, then LMF is determined to be involved.
Among current solutions above, the Ranging and sidelink positioning service
exposure to a UE can be invoked:
a) Through PC5 directly (Sol#9, #10, #14, #25, #26 and #33):
i. Means the UE can invoke the Ranging service from another UE via PC5
directly.
b) Through Network (Sol#9, #11, #22, #25, #26, #27, #28 and #33):
ii. Means the UE can not invoke the Ranging service from another UE via PC5
directly, which requests network assistant to invoke the Ranging service from
another UE and response the Ranging result.
So, the Ranging and sidelink positioning service exposure to a UE can be
supported via PC5 directly or network.
**For ranging and sidelink positioning service exposure to UE over PC5
directly:**
The basic procedure for ranging and sidelink positioning service exposure to
UE over PC5 directly can be performed by the following order (See Sol#9, #10,
#25, #26 and #33):
\- Step1: UE#1 (e.g. SL positioning client UE) invokes the ranging and
sidelink positioning service from UE#2 (Assistant UE, Reference UE) by sending
a ranging and sidelink positioning service request to the UE#2 for obtaining
the Ranging and SL positioning result of/between Target UEs. In this request
at least the SL positioning client UE, the UE#1 info, UE#2 info and target UEs
info should be included.
\- Step 2: Authentication for the ranging and sidelink positioning service
invocation from UE#1
\- Step3: UE#2 receives the ranging and sidelink positioning service request
from UE#1, UE#2 initiates the ranging and sidelink positioning procedure with
Target UEs based on the process in conclusion of KI#4 and obtaining the
ranging and sidelink positioning result.
\- Step4: UE#2 responds to the UE#1 with ranging and sidelink positioning
result of/between Target UEs in the respond message.
In addition, considering capability of Ranging result calculation as described
in Sol#33, during the ranging and sidelink positioning service procedure as
described above, the SL Positioning Server UE can be involved in before
responding to UE#1 with ranging and sidelink positioning result.
**For ranging and sidelink positioning service exposure to UE via Network:**
This ranging service exposure and invocation through network can be realized
by the following 2 methods:
\- Ranging service exposure and invocation through 5GC, the ranging service
consumer sends the ranging request to the 5GC (e.g. AMF or LMF) as described
in Sol#9, #22, #25, #27, #33.
\- Ranging service exposure and invocation through Application layer as
described in sol#11, this mechanism reuses the solution for KI#7.
For the ranging and sidelink positioning service exposure to UE via 5GC, the
SL positioning client UE invokes ranging and sidelink positioning service by
sending NAS message to the 5GC, the LCS architecture and LPP messages can be
reused with small enhancements, i.e. defining new IEs for ranging/sidelink
positioning service. It only needs to enhance the AMF logic to select an
appropriate LMF, or act as the consumer of GMLC service for ranging/sidelink
positioning service (the following procedure is same to that of AF requesting
for ranging/sidelink positioning service). All the captured solutions have to
enforce the involved UEs to belong same PLMN.
Depend on UE implementation, the SL positioning client UE can also invoke the
ranging service exposure from UE via the Application exposure API, then the
subsequent processes rely on the conclusion of KI#7.
## 7.7 Key Issue #7: Ranging/Sidelink Positioning service exposure to
Application server and for network assisted sidelink positioning
This clause evaluates the solutions captured in Table 6.0-1 for KI#7 as
follows.
\- Sol#12 leverages the LCS architecture for service exposure triggered by the
AF. The LMF is enhanced to interact with ProSe application server (or PCF) to
configure the Located UE/Reference UE as ProSe-based UE-to-Network Relay to
report the Target UE location and configures the Target UE with remote UE with
special RSCs.
\- In Sol#13, the AF invokes the ranging service via 5GC. AMF is responsible
for triggering the UEs to initiate the ranging procedure between each other.
The service interface for AMF needs to be enhanced to support Ranging
invoking. The service request and result between UE and AMF are delivered over
NAS messages.
\- Sol#14 addresses all KIs by proposing a general reference architecture for
Sidelink positioning and ranging-based services. In this solution, the
functionalities of new reference points (e.g. SR1, SR5) and existing reference
points enhancement for ranging are defined. When either UE is in coverage, it
may communicate with LMF, re-using enhanced procedures of LCS. When the UEs
are out of coverage, or with partial network coverage, the Sidelink
Positioning and Ranging services can be performed without the network
involvement.
\- Sol#22 addresses both KI#6 and KI#7. It reuses the LCS architecture and
proposes the LMF to combine Uu positioning with Ranging/Sidelink Positioning
capabilities to satisfy the Ranging/Sidelink positioning service request. The
LMF selects the appropriate positioning methods based on the service
requirements, UE capability, UE status, and operator policy.
\- Sol#23 is similar to Sol#12, it also leverages the LCS architecture and
takes the MT-LR procedure as baseline for Ranging Service Exposure. The LMF is
enhanced to obtain the Ranging/Sidelink Positioning capability of the 2 UEs,
determine the role of the 2 UEs, obtain the Ranging/Sidelink Positioning
location information from UE, and calculate the result.
\- Sol#24 is a pure application layer procedure for AF invoked Ranging service
exposure. AF sends the ranging requests to UE directly and triggers the UE to
perform the ranging procedure between UEs via the application message. This
solution has no impacts on 5GC and UEs.
\- Sol#26 is broader than the scope of KI#7 as it addresses KIs #2 through #7.
It proposes a functional split and positioning protocol to enable the support
of Sidelink (SL) positioning and Ranging. This solution proposes a SL
Positioning Server UE to help the calculation of Ranging result. It further
proposes a Positioning Protocol (i.e. RSPP) that can operate between a Target
UE and a SL Positioning Server UE, between a SL Positioning Server UE and a
Reference UE, and between a Target UE and a Reference UE.
\- Sol#27 reuses the LCS architecture and focuses on the LMF selection by
taking the Ranging and SL positioning requirements into account.
\- Sol#28 proposes to reuse the LCS architecture and the MT-LR procedure for
Ranging Service Exposure to AF. The result calculation can be performed at UE
or LMF or both. LMF determines the Ranging/Sidelink positioning result
calculation mode. In this solution, 3 modes on ranging result calculation are
introduced including UE based, LMF based and Hybrid.
\- Sol#33 addresses both KI#6 and KI#7 by proposing a common Ranging/Sidelink
positioning service exposure that consists of both network based solution and
non-network based solution. In both cases, the solution introduces the usage
of SL Positioning Server UE for ranging result calculation. If the attempt to
involve a SL Positioning Server UE fails, then LMF is to be involved.
# 8 Conclusions
Editor\'s note: This clause provides the conclusions for the study.
## 8.1 Key Issue #1: Support of authorisation and policy/parameter
provisioning to UE and Key Issue #8: Service Authorization to NG-RAN
For KI #1 and KI #8, the followings are taken as conclusions:
\- The procedures and signalling specified for ProSe in clause 6.2 of TS
23.304 [4] and for V2X in clause 6.2 of TS 23.287 [3] are used to provision
the Ranging/SL positioning service authorization and policy/parameter
provisioning to the UE.
\- The specific Ranging/SL positioning parameters to UE include:
\- When the UE is served by NG-RAN, the PLMNs in which the UE is authorized to
perform Ranging/SL positioning service over PC5 reference point for acquiring
relative distance, relative direction, high accuracy relative distance and
high accuracy relative direction.
\- When the UE is not served by NG-RAN, indicates whether the UE is authorized
to perform Ranging/SL positioning service over PC5 reference point for
acquiring relative distance, relative direction, high accuracy relative
distance and high accuracy relative direction.
\- The mapping between Ranging/SL positioning services (e.g. ProSe
identifiers, V2X service types) and Ranging/SL positioning QoS parameters.
Ranging/SL Positioning QoS parameters include RSPP transport QoS, i.e. PQI if
RSPP is transported over PC5-U, and positioning QoS.
NOTE 1: Details of the RSPP transport QoS and the positioning QoS will be
coordinated with RAN WGs during the normative phase. Whether RSPP is
transported over PC5-U depends on the outcome of KI#4.
NOTE 2: Positioning QoS parameters can also be dynamically provided in the
Ranging/SL Positioning service request by the service application.
\- The authorized Ranging/SL positioning role per PLMN, i.e. target UE,
reference UE, SL Positioning Client UE, SL Positioning Server UE and located
UE.
\- When the UE is not served by NG-RAN, indicates the authorized Ranging/SL
positioning role, i.e. target UE, reference UE, SL Positioning Client UE, SL
Positioning Server UE, and located UE.
\- The discovery parameters for Ranging/SL positioning service depends on the
conclusions of KI#3.
NOTE 3: These parameters can be preconfigured in ME/UICC. If same
policy/parameters are provided by PCF, the policy/parameters provided by PCF
have higher priority than preconfigured parameters.
\- The procedures and signalling specified for ProSe in clause 6.6 of TS
23.304 [4] and for V2X in clause 6.5 of TS 23.287 [3] are used to provision
the Ranging/SL positioning service authorization to RAN.
\- The specific Ranging/SL positioning service authorization to RAN include:
\- The \"Ranging/SL positioning service authorized\" indication based on UE
subscription from UDM, indicating the UE is authorized to use Ranging/SL
positioning service in the serving PLMN.
\- QoS parameters used by NG-RAN.
NOTE 4: What QoS parameters of Ranging/SL positioning used by NG-RAN will be
specified during normative phase.NOTE 5: The parameters list is not exhausted.
Additional parameters can be added during normative phase.
## 8.2 Key Issue #2: Ranging service operation procedure with the assistance
of another UE
For Key Issue #2: Ranging service operation procedure with the assistance of
another UE, the followings are taken as conclusions:
For Assistant UE discovery and selection:
\- Both Model A and Model B can be used for Assistant UE discovery. The SL
Reference UE performs the Assistant UE selection for both Model A and Model B
discovery. For Model B discovery, the Target UE may respond or not to an
Assistant UE, e.g., based on the PC5 signal status of each received message.
\- Both SL Reference UE and Target UE can select Assistant UE(s) based result
of Assistant UE discovery. SL Reference UE and Target UE negotiate the
Assistant UE selection.
NOTE 1: In V2X case, Assistant UE discovery will be determined during
normative phase.
For Ranging/SL Positioning procedure with Assistant UE(s):
\- SL Reference UE triggers the selected Assistant UE(s) to perform Ranging/SL
Positioning procedure with Target UE, and gets the final ranging result from
the following options:
\- requests the ranging result or ranging measurement data between the
selected Assistant UE(s) and Target UE from the selected Assistant UE(s). SL
Reference UE calculates the final Ranging result based on the ranging result
between the selected Assistant UE(s) and SL Reference UE and the received
ranging result or ranging measurement data between the selected Assistant
UE(s) and Target UE;
\- requests the final ranging result between the SL Reference UE and the
Target UE from the selected Assistant UE(s) directly. In this option, the
Assistant UE calculates the ranging result based on the ranging measurement
data between the selected Assistant UE(s) and Target UE and between the
selected Assistant UE(s) and SL reference UE; or
\- SL Reference UE and Target UE perform the Ranging/SL Positioning operation
procedure with the selected Assistant UE(s) respectively. Then the
measurement/result obtained by SL Reference UE and Target UE are used by the
SL Reference UE or Target UE to calculate the final ranging result:
\- A scheduled ranging time for ranging service operation with Assistant UE(s)
is used to get more accurate ranging result. SL Reference UE or Target UE can
decide a scheduled ranging time, and share with each other or the selected
Assistant UE.
\- Ranging/SL Positioning procedure between the selected Assistant UE(s) and
Target UE, and Ranging/SL Positioning procedure between the selected Assistant
UE(s) and SL Reference UE are performed independently, and each procedure can
reuse the conclusion of KI#4.
\- For the Assistant UE involved for periodic Ranging/SL Positioning service
request, the Target UE determines whether to keep using the existing Assistant
UE, reselect a new Assistant UE or no use of Assistant UE based on e.g. signal
strength or whether LOS path exists:
\- If the assistant UE is still required, the existing Assistant UE continues
to be used, or a new Assistant UE is discovered and selected.
\- If the assistant UE is no longer required, the target UE can switch to
direct ranging operation for the next Ranging/SL Positioning.
NOTE 2: It\'s up to implementation on when the Target UE performs ranging
service check to determine to change Assistant UE.
NOTE 3: The determination of using assistant UE and the assistant UE
selection/reselection should be aligned with the mechanism defined by RAN WGs.
NOTE 4: Coordination with SA WG3 is needed for security aspect.
NOTE 5: The above conclusions for KI#2 are only valid if RAN WGs confirm to
support Assistant UE in RSPP/RLPP for this release, i.e. if RAN WGs conclude
to not support Assistant UE in RSPP/RLPP, no normative work related to
Assistant UE will be developed in SA2 for this release.
## 8.3 Key Issue #3: Ranging/Sidelink Positioning device discovery
For Key Issue #3 \"Ranging/Sidelink Positioning device discovery\", the
followings are taken as conclusions:
\- For Ranging/Sidelink Positioning device discovery, Model A and Model B
Direct Discovery as defined in TS 23.304 [4] are reused for the 5G ProSe
capable UE (including commercial and public safety use cases); and procedures
for V2X communication over PC5 reference point as defined in TS 23.287 [3] are
reused for the V2X capable UEs, with the following enhancements:
\- When 5G ProSe Direct Discovery procedures as defined in 6.3.1 of TS 23.304
[4] are used, the ProSe identifier indicates \"Ranging/Sidelink Positioning\";
\- When Group Member Discovery procedures as defined in 6.3.2.2 of TS 23.304
[4] are used, the Application Layer Group ID indicates a Ranging/Sidelink
Positioning group that the UE belongs to;
\- When unicast mode V2X communication procedure is used, the Service Type in
Layer-2 link establishment procedure indicates \"Ranging/Sidelink
Positioning\";
\- When broadcast mode or groupcast mode V2X communication procedure is used,
it is used with Service Type as \"Ranging/Sidelink Positioning\";
\- The expected roles of the UEs (e.g. Target UE, SL Reference UE) can be
reflected in discovery procedure.
NOTE 1: The parameters used in Ranging/Sidelink Positioning device discovery
procedures can be decided in normative phase.
NOTE 2: The Ranging/Sidelink Positioning device discovery procedures and the
parameters used in the procedures should be aligned with RAN WGs.
NOTE 3: Whether and how to support Restricted ProSe Discovery defined in TS
23.304 [4] for the 5G ProSe capable UE will be decided in normative phase.
## 8.4 Key Issue #4: Control of Operations for Ranging/Sidelink positioning
For Key Issue #4 \"Control of Operations for Ranging/Sidelink positioning\",
the followings are taken as conclusions:
\- A Ranging/SL Positioning layer is introduced on the Target UE/Reference
UE/SL Positioning Server UE under Application layer and above AS layer to
handle service request received from application layer and to control the
Sidelink Positioning and Ranging operation:
\- Functionalities supported by the Ranging/SL Positioning layer include
discovery of the UE(s) in proximity that can participate in Sidelink
Positioning and Ranging service sessions and control signalling between UEs or
among a group of UEs or between UE and LMF to manage and coordinate the
Sidelink Positioning and Ranging operations.
\- The group management can be performed at application layer, and the
application layer may provide group identifier information to the Ranging/SL
Positioning layer.
NOTE 1: Potential group management within RSPP layer is out-of-scope of SA2.
\- Information exchanged between Ranging/SL Positioning layer and lower layer
includes one time or periodic ranging, ranging for distance or direction
measurement or both.
NOTE 2: Further information may be identified in the normative phase.
\- If PC5-U is used, Ranging/SL Positioning signaling is carried over
V2X/ProSe Layer as payload. The existing V2X/ProSe transport mechanism is
reused to handle the Layer-2 ID and Application Layer ID information.
\- Ranging/Sidelink Positioning Protocol (RSPP) is introduced for SR5 over the
PC5 reference point between the UEs (i.e. Target UE, Reference UE, Assistant
UE, Located UE and SL Positioning Server UE), which includes the following
procedures (to be decided by RAN WGs):
\- exchange the Ranging/Sidelink Positioning capability.
\- exchange the Ranging/Sidelink Positioning assistant data.
NOTE 3: What assistant data are required to be exchanged will be coordinated
with RAN WGs.
\- exchange Ranging/Sidelink positioning measurement data/result.
NOTE 4: Further information may be identified in the normative phase.
\- V2X Communication procedures as defined in TS 23.287 [3] and 5G ProSe
Direct Communication procedures as defined in TS 23.304 [4] are used for the
RSPP communication between UEs over PC5.
\- Ranging/SL Positioning signalling is assumed to be carried over PC5-U.
NOTE 5: Whether RSPP is over PC5-U or whether the RSPP over PDCP is used will
be aligned with RAN WG decision.
\- A LMF may be involved when at least one of the Target UE and the Reference
UE are in the network coverage. In that case, a suitable LMF needs to be
selected by the AMF based on the LMF Ranging/SL Positioning capabilities
defined in clause 6.27.2 and the service requests. The protocol used between
UE and LMF will be decided by RAN and could be an extension of LPP, a new
protocol or both, including the following procedures (to be confirmed by RAN
WGs):
\- Triggering Ranging/Sidelink positioning.
\- exchange the Ranging/Sidelink Positioning capability.
\- exchange the Ranging/Sidelink Positioning assistant data.
NOTE 6: What assistant data are required to be exchanged will be coordinated
with RAN WGs.
\- exchange Ranging/Sidelink positioning signal measurement data/result.
\- deliver Ranging/Sidelink positioning service request/response.
NOTE 7: The full support of LPP is not required for operating only SL
Positioning/Ranging; in that case only the extension of LPP, a new protocol or
both is required.
NOTE 8: When Target UE is connected via L3 U2N Relay with N3IWF, LMF is only
involved for triggering Ranging/Sidelink positioning and delivering
Ranging/Sidelink positioning service request/response.
\- When LMF is involved for coordination of SL Positioning, SL Reference UE in
the same serving PLMN of Target UE is discovered and selected.
NOTE 9: Further information may be identified in the normative phase.
\- A SL Positioning Server UE can be discovered and selected for result
calculation, method determination, assistant data distribution and SL
reference UE selection in case of out-of-coverage or for UE-only Operation if
no Ranging/SL Positioning capable LMF is available. If LMF is capable for
Ranging/SL Positioning and is reachable by Target UE and/or Reference UE, the
LMF can still decide that SL Positioning Server UE executes the result
calculation.
NOTE 10: Functionalities of the SL Positioning Server UE will be determined by
RAN WGs.
\- Multiple UEs may be involved in a single Ranging/Sidelink Positioning
session.
\- Whether measurement results or Ranging/Sidelink Positioning results are
exchanged over the SR5 depends on the negotiation during the control
signalling.
## 8.5 Key Issue #5: Network assisted SL Positioning
The Normative work will be based on the following principles:
\- No normative work will be done by SA2 in Rel-18 to support inter PLMN
Network Assisted SL Positioning i.e., when the Target UE and Located UE are
registered in different PLMNs.
\- Roaming is supported when Target UE and Located UE are registered in the
same PLMN i.e., each UE is either registered in VPLMN or HPLMN, but both are
registered in the same PLMN.
\- Legacy functionality specified in TS 23.273 [11] for location services
shall be reused including MO-LR, MT-LR for both regulatory and commercial use,
when the Target UE has NAS connection with AMF (directly or indirectly via a
ProSe UE-to-Network Relay).
NOTE 1: When the target UE has pending LCS request e.g., per deferred MT-LR
and if there is no direct connection available, the target UE can try to
discover U2N Relay (layer-2 or layer-3 with N3IWF) and setup indirect
connection for handling the pending LCS request, e.g., location report.
\- The Location Service is triggered via the AMF that serves the Target UE,
the request comes either from an application server via the GMLC, a 5G NF, or
the Target UE.
\- The Target UE can initiate MO-LR or the LMF can initiate MT-LR based on
legacy procedures.
\- Positioning protocol LPP endpoints in this case are the Target UE and the
LMF.
NOTE 2: RAN WGs will determine whether and what enhancements and the subset
functionalities of LPP are needed to support Network assisted SL positioning
including an MT-LR and MO-LR.
\- Either the Target UE or LMF determines if network assisted SL positioning
will be applied. When LMF determines that network assisted SL positioning is
used, LMF may trigger the Target UE to perform the discovery of Located UE(s).
\- The Target UE and Located UE(s) perform ranging/SL positioning, as defined
in KI#4.
\- The Target UE reports the identity of the Located UE(s) to the LMF.
NOTE 3: It will be determined during normative phase what UE identity of the
Located UE that the Target UE provides to the LMF. Depending on which UE
identity, the LMF or the GMLC may need to resolve this by query another NF.
The security impact will be coordinated with SA3.
\- Target UE discovers Located UE(s) for network assisted SL positioning. To
assist the Target UE the LMF may provide candidate list of Located UE to
participate in the network assisted SL positioning for the target UE. The
provisioning of candidate list of Located UE assumes that the capability and
location information of the Located UE in the list are maintained by 5GC.
\- The LMF uses the location of Located UE(s) together with the ranging/SL
positioning measurement data or result reported by Target UE and optionally
also by Located UEs to estimate the location of the Target UE. The
Ranging/Sidelink positioning and the positioning of the Located UE(s) can be
scheduled with the same time (per TS 23.273 [11]) to improve the Target UE
positioning accuracy.
NOTE 4: The LMF may need to compensate the time difference of the positioning
of Target UE and Located UE with additional information.
NOTE 5: The Ranging/Sidelink positioning supports the scheduled location time
feature.
\- The LMF provides the location estimate to the AMF which forwards it either
to the Target UE over NAS or to the GMLC, or to the 5GC NF according to legacy
functionality.
\- If Target UE cannot establish NAS connection with AMF, for MO-LR or pending
MT-LR (e.g. deferred MT-LR), the following procedures can be used:
Option a):
\- The Target UE performs the Located UE\'s discovery and selection.
\- The Target UE may request for the Location of the Located UE(s).
\- If the Located UE(s) needs network assistance to retrieve its location, the
Located UE(s) may trigger a MO-LR. This assumes that the Located UE(s) has a
NAS connection to an AMF.
\- The Target UE uses the location returned by Located UE(s) together with the
ranging/SL positioning measurement data or result to estimate its own
location. The Ranging/Sidelink positioning and the positioning of the Located
UE(s) can be scheduled with the same time (according to TS 23.273 [11]) to
improve the Target UE positioning accuracy.
Option b):
\- The Target UE performs the Located UE\'s discovery and selection.
\- The Target UE may transmit its ranging measurements/results to the Located
UE(s).
\- Located UE(s) may report the ranging/SL positioning measurement result to
the LMF. This may include ranging measurements/results received from the
Target UE. The endpoints for LPP messages can be the LMF and the Located UE(s)
in this case.
\- The LMF may use the received information to calculate the location of the
Target UE, and provide the resulting location via the Located UE to the Target
UE or via 5G NF to the LCS client or the Application Server.
NOTE 6: Security aspects require confirmation from SA WG3.
NOTE 7: Supporting of location report via the Located UE to the LMF needs to
be confirmed by RAN.
NOTE 8: It will be determined during Normative phase that when AMF does not
maintain target UE\'s context or GMLC cannot get target UE AMF address because
of deregistration, whether and how location report from Located UE on behalf
of Target UE is supported.
## 8.6 Key Issue #6: Ranging and sidelink positioning service exposure to a UE
For Key Issue #6 (Ranging and sidelink positioning service exposure to a UE),
the normative work is based on the following principles:
A Ranging/Sidelink Positioning service request can be initiated by a SL
Positioning Client UE.
When Ranging/Sidelink Positioning service request is initiated by a SL
Positioning Client UE, the Ranging and sidelink positioning service exposure
to a UE can be through PC5 or through the 5GC network.
For Ranging and sidelink positioning service exposure to a UE through PC5,
following principles are taken as baseline for normative work:
\- SL Positioning Client UE discovers one of Reference UE and Target UE.
\- SL Positioning Client UE invokes the Ranging/Sidelink Positioning service
to Reference UE/Target UE that is discovered by sending a anging and sidelink
positioning service request for obtaining the Ranging and SL positioning
result between Reference UE and Target UE. This request includes the user info
of SL Positioning Client UE, Reference UE and Target UE.
\- Reference UE/Target UE that is contacted by the SL Positioning Client UE
triggers the authorization of SL Positioning Client UE for the ranging and
sidelink positioning service invocation.
NOTE 1: The procedure for Privacy handling on Ranging and sidelink positioning
service exposure needs to be determined by SA3 Group i.e. the authorization of
the SL positioning client UE for Ranging and sidelink positioning service
invocation of two other UEs.
\- The Ranging/Sidelink positioning procedure between Reference UE and Target
UE is performed based on the conclusion of KI#4.
\- Reference UE/Target UE that is contacted by the SL Positioning Client UE
provides the Ranging/Sidelink positioning result to SL Positioning Client UE.
NOTE 2: Other information to be included in the interaction messages between
SL Positioning Client UE and Reference UE/Target UE contacted by the SL
Positioning Client UE is determined in normative work.
For Ranging and sidelink positioning service exposure to a UE through network,
it will be supported by using the Application exposure API, MO-LR procedure as
specified in TS 23.273 [11] with extensions captured in clause 8.4, or
enhanced MO-LR procedure.
\- For the Application exposure API case:
\- The SL positioning client UE invokes the Ranging and sidelink positioning
service exposure from a UE by reusing the Application exposure API over the
application layer message, and the subsequent reuses the procedure described
in the conclusion for clause 8.7.
\- The SL Positioning Client UE receives the onboarding information in order
to use the Application exposure API during the registration procedure.
NOTE 3: The authorization of the SL positioning client UE for Ranging and
sidelink positioning service invocation of two other UEs reuses the procedures
will be determined by SA WG6, and defined in TS 23.222 [12].
\- For the enhanced MO-LR case:
\- SL positioning client UE sends an enhanced MO-LR request to AMF;, the AMF
sends a the Ranging/SL positioning request to the GMLC which also includes the
SL positioning client UE ID.
\- GMLC reuses the procedure described in the conclusion for clause 8.7 (like
the request from Application server), and sends the Ranging/SL positioning
result to AMF.
\- The AMF sends the Ranging/SL positioning result to the SL positioning
client UE when it receives the result from the GMLC.
NOTE 4: The procedure for Privacy handling on Ranging and sidelink positioning
service exposure needs to be determined by SA3 Group i.e. the authorization of
the SL positioning client UE for Ranging and sidelink positioning service
invocation of two other UEs.
## 8.7 Key Issue #7: Ranging/Sidelink Positioning service exposure to
Application server and for network assisted sidelink positioning
The following conclusion is proposed as basis for normative work:
\- The 5GS Ranging/Sidelink Positioning service may be exposed to the
Application server either via interaction with 5GC NFs e.g. GMLC or via the
NEF
\- A Ranging/Sidelink Positioning request issued by the Application server is
supported. The request supports indication for both relative positioning
between two UEs identified in the requests and absolute positioning and the
request may include new ranging/sidelink positioning parameters (e.g. QoS
related events regarding accuracy, latency for distance and/or direction
measurements). The result is returned to the Application server.
NOTE 1: It is assumed that for absolute positioning the Application server may
use legacy API for retrieving the location of a UE. This may trigger the LMF
to use Network Assisted SL Positioning if Uu based positioning was not
feasible or not provided the QoS needed. Details are described in clause 8.5.
NOTE 2: The exact parameters used in the Ranging/Sidelink Positioning request
issued by an Application Server can be decided in normative phase.
\- For Ranging/Sidelink Positioning service exposure to Application server,
the LCS architecture includeing and MT-LR and MO-LR procedures are taken as
baseline:
\- LMF is the responsible 5GC NF to trigger Ranging/Sidelink Positioning to
the UE.
\- One Ranging/SL Positioning capable LMF is selected by the AMF for a
Ranging/Sidelink Positioning session, the AMF serves either the Target UE or
the SL Reference UE or both. In case the selected LMF does not have the
context information for all involved UEs, a similar context transfer as
specified in TS 23.273 [11] can be performed, the details of which can be
worked out in normative phase.
\- For MT-LR procedure, the GMLC selects the AMF.
\- LMF or UE performs result calculation.
\- If LMF determines to use Network Assisted SL Positioning to position a
Target UE, Ranging/Sidelink Positioning results and Uu positioning results may
be combined by LMF before exposing the results to the AF. Details are
described in the conclusion for KI#5.
NOTE 3: No normative work will be performed on inter-PLMN case in SA WG2 for
Rel-18.
#