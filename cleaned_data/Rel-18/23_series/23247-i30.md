# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies architectural enhancements to the 5G system
using NR to support multicast and broadcast communication services, complying
to the requirements in TS 22.146 [2], TS 22.246 [3] and TS 22.261 [4]. This
document encompasses support for functions such as how to deliver multicast
and broadcast communications including support within certain location areas,
mobility, MBS session management, policy control and QoS, and support for
features e.g. group message delivery.
The present document also covers interworking with E-UTRAN and EPC based eMBMS
for Public Safety (e.g. MCX services).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.146: \"Multimedia Broadcast/Multicast Service (MBMS); Stage
1\".
[3] 3GPP TS 22.246: \"Multimedia Broadcast/Multicast Service (MBMS) user
services; Stage 1\".
[4] 3GPP TS 22.261: \"Service requirements for the 5G system\".
[5] 3GPP TS 23.501: \"System architecture for the 5G System (5GS)\".
[6] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[7] 3GPP TS 23.503: \"Policy and charging control framework for the 5G System
(5GS); Stage 2\".
[8] 3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS);
Architecture and functional description\".
[9] 3GPP TS 38.300: \"NR; Overall description; Stage-2\".
[10] 3GPP TS 23.468: \"Group Communication System Enablers for LTE
(GCSE_LTE)\".
[11] 3GPP TS 26.348: \"Northbound Application Programming Interface (API) for
Multimedia Broadcast/Multicast Service (MBMS) at the xMB reference point\".
[12] 3GPP TS 23.003: \"Numbering, Addressing and Identification\".
[13] 3GPP TS 26.346: \"MBMS: Protocols and Codecs\".
[14] Void.
[15] 3GPP TS 38.413: \"NG Application Protocol (NGAP)\".
[16] 3GPP TS 38.401: \"NG-RAN; Architecture description\".
[17] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
Nodes; Stage 3\".
[18] 3GPP TS 26.502: \"5G Multicast-Broadcast User Service Architecture\".
[19] 3GPP TS 29.510: \"Network Function Repository Services; Stage 3\".
[20] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[21] 3GPP TS 23.289: \"Mission Critical services over 5G System; Stage 2\".
[22] 3GPP TS 26.517: \"5G Multicast-Broadcast User Services; Protocols and
Formats\".
[23] 3GPP TS 29.281: \"General Packet Radio System (GPRS) Tunnelling Protocol;
User Plane (GTPv1-U)\".
[24] 3GPP TS 38.423: \"NG-RAN; Xn Application Protocol (XnAP)\".
[25] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
# 3 Definitions of terms and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms and definitions defined in
TR 21.905 [1] and the following apply:
**5GC Individual MBS traffic delivery** : 5G CN receives a single copy of MBS
data packets and delivers separate copies of those MBS data packets to
individual UEs via per-UE PDU sessions, hence for each such UE one PDU session
is required to be associated with a Multicast MBS Session.
**5GC Shared MBS traffic delivery** : 5G CN receives a single copy of MBS data
packets and delivers a single copy of those MBS data packets to a RAN node.
**Area Session Identifier:** A unique identifier within an MBS Session used
for an MBS session with location dependent content. When present, the Area
Session ID, together with the TMGI, is used to uniquely identify the data flow
of an MBS Session in a specific MBS service area.
**Associated PDU Session:** A PDU Session associated to a multicast MBS
session that is used for 5GC Individual MBS traffic delivery method and for
signalling related to a user\'s participation in a multicast MBS session such
as join and leave requests.
**Associated QoS Flow:** A unicast QoS Flow that belongs to the associated PDU
Session and is used for 5GC Individual MBS traffic delivery method. The
associated QoS Flow is mapped from a multicast QoS Flow in a multicast MBS
session.
**Broadcast communication service:** A 5GS communication service in which the
same service and the same specific content data are provided simultaneously to
all UEs in a geographical area (i.e. all UEs in the broadcast coverage area
are authorized to receive the data).
NOTE 1: For the broadcast communication service, the content provider and
network may not be aware whether the authorized UEs are actually receiving the
data being delivered.
**Broadcast MBS session:** An MBS session to deliver the broadcast
communication service. A broadcast MBS session is characterised by the content
to send and the geographical area where to distribute it.
**Broadcast service area:** The area within which data of one or multiple
Broadcast MBS session(s) are sent.
**MBS QoS Flow** : The finest granularity for QoS forwarding treatment for MBS
data. Providing different QoS forwarding treatment requires separate MBS QoS
Flows in 5GS supporting MBS.
**MBS Service Announcement:** Mechanism to allow users to be informed about
the available MBS services.
**MBS session:** A multicast MBS session or a broadcast MBS session.
**MBS service area:** The area within which data of one Multicast or Broadcast
MBS session may be sent. For location dependent MBS, for each MBS service
area, an Area Session ID, which is unique per MBS Session ID, is allocated and
the same location dependent content data for an MBS session is delivered to
the UE(s) within an MBS service area.
**Multicast communication service:** A 5GS communication service in which the
same service and the same specific content data are provided simultaneously to
a dedicated set of UEs (i.e. not all UEs in the coverage of the MBS service
area are authorized to receive the data).
NOTE 2: For multicast communication service, the content provider and network
can be aware whether the authorized UEs are actually receiving the data being
delivered.
**Multicast MBS session:** An MBS session to deliver the multicast
communication service. A multicast MBS session is characterised by the content
to send, by the list of UEs that may receive the service and optionally by a
geographical area where to distribute it.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], TS 23.501 [5] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in TR 21.905 [1].
**AL FEC Application Level FEC**
**CDN Content Delivery Network**
**FEC Forward Error Correction**
**FSA Frequency Selection Area**
**LL SSM Lower Layer SSM**
**MBMS** Multimedia Broadcast/Multicast Service
**MBS** Multicast/Broadcast Service.
MBSF Multicast/Broadcast Service Function.
MBSTF Multicast/Broadcast Service Transport Function.
MB-SMF Multicast/Broadcast Session Management Function.
MB-UPF Multicast/Broadcast User Plane Function
MSK MBS Service Key
MTK MBS Traffic Key
PTM Point To Multipoint
PTP Point To Point
PTW Paging Transmission Window
SSM Source Specific IP Multicast address.
TMGI Temporary Mobile Group Identity
# 4 General Concept
## 4.1 Overview of multicast and broadcast communication
Multicast and Broadcast Service (MBS) is a point-to-multipoint service in
which data is transmitted from a single source entity to multiple recipients,
either to all users in a Broadcast service area, or to users in a multicast
group as defined in TS 22.146 [2]. The corresponding types of MBS session are:
\- Broadcast MBS session
\- Multicast MBS session.
The MBS architecture defined in clause 5 follows the 5G System architectural
principles as defined in TS 23.501 [5], enabling distribution of the MBS data
from the 5GS ingress to NG-RAN node(s) and then to the UE. The MBS
architecture provides:
\- Efficient usage of RAN and CN resources, with an emphasis on radio
interface efficiency;
\- Efficient transport for a variety of multicast and broadcast services.
Multicast/Broadcast Service for roaming is not supported in this release.
Interaction between Multicast/Broadcast Service and support of deployments
topologies with specific SMF Service Areas is not specified in this Release.
The collection and reporting of MBS specific charging information are not
specified in this Release.
The MBS also provides functionalities such as local MBS service and location
dependent MBS service, authorization of multicast MBS and QoS differentiation.
Refer to clause 6 for more details.
MBS traffic is delivered from a single data source (e.g. Application Service
Provider) to multiple UEs. Depending on many factors, there are several
delivery methods which may be used to deliver the MBS traffic in the 5GS.
NOTE 1: For clarity, delivery methods are not referred to as
unicast/multicast/broadcast but as described below. The term \"unicast
delivery\" refers to a mechanism by which application data and signalling
between the UE and the application server are delivered using PDU Session
within the 3GPP network and using individual UE and application server
addresses (e.g. IP addresses) between the 3GPP network and the application
server. It is not equivalent to 5GC Individual MBS traffic delivery method
defined in this clause.
Between 5GC and NG-RAN, there are two possible delivery methods to transmit
the MBS data:
\- 5GC Individual MBS traffic delivery method: This method is only applied for
multicast MBS sessions. 5GC receives a single copy of MBS data packets and
delivers separate copies of those MBS data packets to individual UEs via per-
UE PDU sessions, hence for each such UE one PDU session is required to be
associated with a Multicast MBS session.
\- 5GC Shared MBS traffic delivery method: This method is applied for both
broadcast and multicast MBS sessions. 5GC receives a single copy of MBS data
packets and delivers a single copy of those MBS packets to an NG-RAN node,
which then delivers the packets to one or multiple UEs.
The 5GC Shared MBS traffic delivery method is required in all MBS deployments.
The 5GC Individual MBS traffic delivery method is required to enable mobility
when there is an NG-RAN deployment with non-homogeneous support of MBS.
For the Multicast MBS session, a single copy of MBS data packets received by
the CN may be delivered via 5GC Individual MBS traffic delivery method for
some UE(s) and via 5GC Shared MBS traffic delivery method for other UEs.
Between the NG-RAN and the UE, two delivery methods are available for the
transmission of MBS data packets over radio interface:
\- Point-to-Point (PTP) delivery method: NG-RAN delivers separate copies of
MBS data packets over radio interface to individual UE(s).
\- Point-to-Multipoint (PTM) delivery method: NG-RAN delivers a single copy of
MBS data packets over radio interface to multiple UEs.
NG-RAN may use a combination of PTP/PTM to deliver an MBS data packets to UEs.
NOTE 2: The PTP and PTM delivery methods are defined in RAN WGs.
As depicted in the following figure, 5GC Shared MBS traffic delivery method
(with PTP or PTM delivery) and 5GC Individual MBS traffic delivery method may
be used at the same time for a multicast MBS session.
Figure 4.1‑1: Delivery methods
For MBS broadcast communication, only 5GC Shared MBS traffic delivery method
with PTM delivery is applicable.
For MBS multicast communication, if the NG-RAN node supports MBS, the network
shall use the 5GC Shared MBS traffic delivery method for MBS data
transmission.
NOTE 3: The exception is when the UE moves between NG-RAN node not supporting
MBS (with 5GC Individual MBS traffic delivery method) and NG-RAN node
supporting MBS, there is temporary co-existence between 5GC Shared MBS traffic
delivery method and 5GC Individual MBS traffic delivery method. Refer to
clause 6.3 for details.
For MBS multicast communication, the switching between 5GC Shared MBS traffic
delivery method and 5GC Individual MBS traffic delivery method is supported.
The UE mobility between RAN nodes both supporting MBS, and between a RAN node
supporting MBS and a RAN node not supporting MBS is supported, for details see
clause 6.3.
For MBS multicast communication, the switching between PTP and PTM delivery
methods for 5GC Shared MBS traffic delivery shall be supported. NG-RAN is the
decision point for switching between PTP and PTM delivery methods.
## 4.2 MB service provisioning
### 4.2.1 Multicast data provisioning
An example for the sequence of phases for multicast data provisioning is
described in the figure below:
Figure 4.2.1-1: Phases of Multicast data provisioning example
The following phases are performed for a specific UE:
\- UE Session Join: UE Session Join is the process by which a UE joins an MBS
Session, i.e. the UE indicates to 5GC that such UE wants to receive Multicast
data identified by a specific MBS Session ID.
\- UE Session Leave: UE Session Leave is the process by which a UE leaves a
MBS Session, i.e. the UE no longer wants to receive Multicast data identified
by a specific MBS Session ID.
The following phases are performed for a specific service:
\- MBS Session Creation: It is the phase that the information of Multicast MBS
session is created as described in clause 4.3. This step is optional.
\- Service announcement: Service announcement is used to distribute
information toward UEs about the service required for service reception (e.g.
IP multicast address(es)) and possibly other service related parameters (e.g.
service start time). This step is optional.
\- Session Establishment: It is the phase that Multicast MBS session is
established as described in clause 4.3.
\- No data receiving: It is the phase when no multicast data is received by
5GC. This step is optional.
\- Data transfer: It is the phase when Multicast data are transferred to the
UEs.
\- Session Release: It is the phase that the resources for Multicast MBS
session is released as described in clause 4.3.
\- Session Deletion: It is the phase that Multicast MBS session is deleted as
described in clause 4.3.
NOTE: After session establishment, Multicast MBS session state could be
switched between Active and Inactive several times, triggered by AF or User
Plane event, see clause 7.2.5. 5GC further updates Multicast MBS session state
towards NG-RAN nodes after Session Establishment.
The phase of Multicast data provisioning is illustrated with the following
example of timeline:
Figure 4.2.1-2: Multicast service timeline example
### 4.2.2 Broadcast data provisioning
An example for the phases of broadcast data provisioning is described in the
figure below:
Figure 4.2.2-1: Phases of Broadcast data provisioning
The following phases are performed for a specific service:
\- MBS Session Creation: MBS Session Creation is used by the AF to create the
MBS Session towards 5GC. MBS session creation can occur in several steps (e.g.
TMGI allocation, provisioning information about MBS session, request to
activate the MBS session). The last step of the MBS session creation triggers
resource establishment for transmitting the DL Broadcast data between 5GC and
NG-RAN.
NOTE: For broadcast communication, after MBS Session Creation and Session
Establishment, the established resources are not only between 5GC and NG-RAN,
but also between the AF to 5GC.
\- Service announcement: Service announcement is used to distribute
information towards UEs about the service required for service reception (e.g.
IP multicast address(es)) and possibly other service related parameters (e.g.
service start time). This step can occur in parallel or after the MBS session
configuration. However, TMGI allocation is required before. The information of
the service announcement could be pre-configured at the UE side, see clause
7.3.1.
\- Data transfer: It is the phase when broadcast data are transferred in the
air interface.
\- Session Release and Deletion: It is the point at which there will be no
more need to transmit Broadcast data. At Session Release, the resources in 5GS
are released and the broadcast MBS session is deleted.
The phase of Broadcast data provisioning is illustrated with the following
example of timeline:
Figure 4.2.2-2: Broadcast service timeline
## 4.3 Multicast session state model
The following illustrate the states for the Multicast MBS session:
**\- Configured state** : Information about the Multicast MBS session (e.g.
QoS information) is available in 5GC NFs (e.g. MB-SMF) serving the Multicast
MBS session, but no User Plane resources towards NG-RAN are reserved and no
MBS data can be transmitted. Only resources at MB-SMF, NEF and MB-UPF are
reserved and no multicast data are transmitted. A TMGI can be allocated for
the Multicast MBS session. UEs may be allowed to join (subject to
authorization check and configuration), but the first accepted UE join request
will trigger the Multicast MBS session establishment towards the NG-RAN and
the UE, see clause 7.2.1.
NOTE 1: The SMF is not involved in the Multicast MBS session while the
Multicast MBS session is in configured state.
NOTE 2: There may be several interim states in the configured state, e.g. TMGI
requested, or information about the Multicast MBS session provided, but these
interim states will not be specified in this release.
\- **Active state** : Multicast MBS session is established and MBS data can be
transmitted to the UEs that have joined the Multicast MBS session. Radio
resources for the Multicast MBS session are established. To receive multicast
MBS session data, UEs that joined the Multicast MBS session shall be in CM-
CONNECTED state for receiving data of the Multicast MBS session. UEs are
allowed to join the Multicast MBS session (subject to authorization check).
5GC resources and radio resources for the Multicast MBS session are reserved
for UEs that joined the Multicast MBS session.
NOTE 3: When receiving the data of the Multicast MBS session, the joined UEs
can be in CM-CONNECTED with RRC_INACTIVE state as defined in clause 6.17.
\- **Inactive state** : Multicast MBS session is established but no MBS data
is transmitted to the UEs that have joined the Multicast MBS session. Radio
resources for the Multicast MBS session are released, and the UEs that joined
the Multicast MBS session may be in CM-CONNECTED or CM-IDLE state. UEs are
allowed to join the Multicast MBS session (subject to authorization check).
The following procedures are defined which result in transition of the
Multicast MBS session state:
**Multicast Session Creation** : The AF provides information about the
Multicast MBS session and optionally requests the allocation of a TMGI, see
clause 7.1.1.2 and 7.1.1.3. Alternatively, the information about the Multicast
MBS session can be pre-configured in the network. The creation may indicate
whether the Multicast MBS session may be established in active or inactive
state and when a Multicast MBS session can become active. The AF may perform
creation in several steps, e.g. to first request TMGI and then provide full
information about the Multicast MBS session and allow it to be established, or
to update the information whether the Multicast MBS session is to be in Active
or Inactive state after establishment. Multicast MBS session state transitions
from \"Start (NULL)\" to Configured state.
NOTE 4: A Multicast MBS session can also be created by the operator via OAM
configuration or be established without prior creation.
\- **Multicast Session Establishment** : When the join request of the first UE
for the Multicast MBS session is accepted, the Multicast MBS session is
established towards the NG-RAN node and the UE, see clause 7.2.1. Multicast
session state transitions from \"Start (NULL)\" or Configured state to either
Inactive or Active state.
\- **Multicast Session Activation** : See clause 7.2.5.2, Triggered by the
5GC, the radio resources for the Multicast MBS session are established and
Multicast MBS session data starts to be transmitted to the UE. UEs in CM-IDLE
state and CM-CONNECTED with RRC Inactive state that joined the Multicast MBS
session are notified. Activation can be triggered by AF request or data
notification from the MB-UPF. Multicast session state transitions from
Inactive state to Active state.
NOTE 5: The AF could not be aware, and the NEF will not be aware, whether a
session is in created or established state. An AF may therefore update the
session state to request the activation of a session prior to the
establishment of the session, and this will determine that the session is
subsequently established in Active state when the first UE joins, but will not
trigger the Multicast Session Activation state transition.
\- **Multicast Session Deactivation** : See clause 7.2.5.3. Triggered by the
5GC, the radio resources for the Multicast MBS session are released and
Multicast MBS session data stops to be transmitted to the UE. Deactivation can
be triggered by AF request or no reception of multicast data by the MB-UPF.
Multicast session state transitions from Active to Inactive state.
\- **Multicast Session Release** : Triggered by the last UE leaving the
Multicast MBS session (see clause 7.2.2.2), or Multicast Session Deletion
procedure (7.1.1.4 or 7.1.1.5), the resources for the Multicast MBS session
are released in both 5GC nodes and RAN nodes, see clause 7.2.2. Multicast
session state transitions from Active or Inactive state to Configured.
\- **Multicast Session Deletion** : All information about the Multicast MBS
session is removed from the 5GC, and the TMGI for the Multicast MBS session
(if allocated during Multicast Session Configuration) is deallocated, see
clause 7.1.1.4 or 7.1.1.5. The deletion may be triggered by an AF request.
Multicast session state transitions from Configured, Active or Inactive state
to \"End (NULL)\".
Figure 4.3-1: Multicast session states and state transitions
Figure 4.3-2: Multicast session states and state transitions in MB-SMF
Figure 4.3-3: Multicast session states and state transitions in NG-RAN
NOTE 6: Multicast session states and state transitions in NG-RAN is for
illustration purpose, normative procedures are provided by RAN WGs.
Figure 4.3-4: Multicast session states and state transitions in SMF
# 5 Architecture model
## 5.1 General architecture
Figure 5.1-1 depicts the MBS reference architecture. Service-based interfaces
are used within the Control Plane. Support for interworking at reference
points xMB and MB2 is described in Annex C.
Figure 5.1-1: 5G System architecture for Multicast and Broadcast Service.
NOTE 1: The MBSF is optional and may be collocated with the NEF or AF/AS, and
the MBSTF is an optional network function.
NOTE 2: The existing service-based interfaces of Nnrf, Nudm, and Nsmf are
enhanced to support MBS. The existing service-based interfaces of Npcf and
Nnef are enhanced to support MBS.
NOTE 3: A MBS-enabled AF uses either Nmbsf or Nnef to interact with the MBSF.
Figure 5.1-2 depicts the 5G system architecture for MBS using the reference
point representation.
Figure 5.1-2: 5G System architecture for Multicast and Broadcast Service in
reference point representation.
NOTE 4: The existing reference points of N1, N2, N4, N5, N10, N11, N30 and N33
are enhanced to support MBS.
NOTE 5: Regarding the functionalities, Nmb13, N29mb and Nmb1 are identical,
Nmb5 and Nmb10 are identical, Nmb9 and N6mb are identical.
## 5.2 General architecture for interworking with EPS
Interworking between MBS and eMBMS at service layer functionality applies in
cases where the same Multicast/Broadcast service is provided via eMBMS and
MBS. Figure 5.2-1 depicts the system architecture for interworking between
E-UTRAN/EPC eMBMS and MBS at service layer, with collocated BM-SC and
MBSF/MBSTF functionalities.
Figure 5.2-1: MBS-eMBMS interworking system architecture at service layer
The BM-SC+MBSF/MBSTF exposes common Nmb5/Nmb10/xMB-C/MB2-C and
Nmb8/xMB-U/MB2-U reference points to the NEF and/or AF/AS. A common TMGI is
used towards the AF/AS. The TMGI is also used as identifier for transport over
E-UTRAN/EPC. The MBSTF distributes the received data to the MB-UPF at
reference point Nmb9 and/or the MBMS-GW at reference point SGi-mb, when
supported by operator network configuration.
NOTE 1: MB2-C/U and xMB-C/U are legacy reference points.
NOTE 2: In the case of MBSTF providing MB2-C/U, it may be used for the GCS/AS
only supporting GC1 and MB2 interfaces, as defined TS 23.468 [10].
## 5.3 Service-based interfaces, Reference point and functional entities
### 5.3.0 Service-based interfaces
The 5G System Architecture for MBS contains the following service-based
interfaces:
**Nmbsmf:** Service-based interface exhibited by MB-SMF. Further details are
described in clause 9.1.
**Npcf:** Service-based interface exhibited by PCF. Further details are
described in clause 9.2.
**Namf:** Service-based interface exhibited by AMF. Further details are
described in clause 9.3.
**Nnef:** Service-based interface exhibited by NEF. Further details are
described in clause 9.4.
**Nmbsf:** Service-based interface exhibited by MBSF. Further details are
described in clause 9.5.
### 5.3.1 Reference point
The 5G System Architecture for MBS contains the following new reference
points:
**N3mb:** Reference point between the RAN and the MB-UPF.
**N4mb:** Reference point between the MB-SMF and the MB-UPF.
**N6mb:** Reference point between the MB-UPF and the AF/AS.
**N7mb:** Reference point between the MB-SMF and the PCF.
**N11mb:** Reference point between the AMF and the MB-SMF.
**N16mb:** Reference point between the SMF and the MB-SMF.
**N19mb:** Reference Point between the UPF and the MB-UPF.
**N29mb:** Reference point between the MB-SMF and the NEF.
**Nmb1:** Reference point between the MB-SMF and the MBSF.
**Nmb2:** Reference point between the MBSF and the MBSTF.
**Nmb5:** Reference point between the MBSF and the NEF.
**Nmb8:** Reference point between the MBSTF and the AF.
**Nmb9:** Reference point between the MB-UPF and the MBSTF.
**Nmb10:** Reference point between the MBSF and the AF.
**Nmb12:** Reference point between the MBSF and the PCF.
**Nmb13:** Reference point between the MB-SMF and the AF.
**Nmb14:** Reference point between the NEF and the MBSTF.
5G System Architecture for MBS reuses the existing reference points of N1, N2,
N4, N10, N11, N30 and N33 with enhancement to support MBS.
### 5.3.2 Functional entities
#### 5.3.2.1 PCF
In addition to the functions defined in TS 23.501 [5], the PCF performs the
following functions to support MBS if dynamic PCC for MBS is needed:
\- Supporting QoS handling for MBS Session.
\- Providing policy information regarding the MBS Session to MB-SMF for
authorizing the related QoS profiles.
\- Interacting with UDR for QoS information retrieval.
\- The PCF can receive MBS information from AF, NEF or MBSF, e.g. based on the
different configuration options in Annex A.
#### 5.3.2.2 MB-SMF
The MB-SMF performs the following functions to support MBS:
\- General for Multicast and Broadcast MBS sessions:
\- Supporting MBS session management (including QoS control).
\- Configuring the MB-UPF for multicast and broadcast data transport, based on
the policy rules for multicast and broadcast services from PCF or local
policy.
\- Allocating and de-allocating TMGIs.
\- Specific for Broadcast MBS sessions:
\- Interacting with RAN (via AMF) to control data transport using 5GC Shared
MBS traffic delivery method.
\- Specific for Multicast MBS sessions:
\- Interacting with SMF to provide the SMF with MBS Session Context
information.
\- Interacting with RAN (via AMF) to establish data transmission resources
between MB-UPF and RAN nodes for 5GC Shared MBS traffic delivery method.
\- Controlling the MB-UPF for multicast data transport using 5GC Individual
MBS traffic delivery method.
#### 5.3.2.3 SMF
In addition to the functions defined in TS 23.501 [5], the SMF performs the
following functions to support MBS:
\- Discovering MB-SMF for a Multicast MBS session.
\- Authorizing Multicast MBS session join operation for served UEs if needed.
\- Interacting with MB-SMF to obtain multicast Session Context information
used as input to modify the PDU Session associated with MBS session.
\- Interacting with RAN to provide information about a Multicast MBS session
that a UE is participating in.
\- Interacting with RAN and UPF for multicast data transport using 5GC
Individual MBS traffic delivery method.
\- Interacting with RAN to provide MBS Assistance Information for the MBS
session.
NOTE: SMF and MB-SMF may be co-located or deployed separately.
#### 5.3.2.4 MB-UPF
The MB-UPF performs the following functions to support MBS:
\- General for Multicast and Broadcast MBS sessions:
\- Packet processing of incoming downlink packets for multicast and broadcast
flows.
\- QoS enforcement (MFBR) based on existing means.
\- Interaction with MB-SMF for receiving multicast and broadcast data.
\- Delivery of multicast and broadcast data to RAN nodes for 5GC Shared MBS
traffic delivery method.
\- Specific for Multicast MBS sessions:
\- Delivery of multicast data to UPF for 5GC Individual MBS traffic delivery
method.
#### 5.3.2.5 UPF
In addition to the functions defined in TS 23.501 [5], the UPF performs the
following functions to support MBS:
\- Interacting with SMF for receiving multicast data from MB-UPF for 5GC
Individual MBS traffic delivery method.
\- Delivering multicast data to UEs via PDU Session for 5GC Individual MBS
traffic delivery method.
NOTE: UPF and MB-UPF may be co-located or deployed separately.
#### 5.3.2.6 AMF
In addition to the functions defined in TS 23.501 [5], the AMF performs the
following functions to support MBS:
\- Signalling with NG-RAN and MB-SMF for MBS Session management.
\- Selection of NG-RANs for notification of multicast session activation
toward UEs in CM-IDLE state.
\- Selection of NG-RANs for broadcast traffic distribution.
Additionally, AMF being aware of NG-RAN 5G MBS capability.
#### 5.3.2.7 NG-RAN
In addition to the functions defined in TS 23.501 [5], the NG-RAN performs the
following functions to support MBS:
\- Management of MBS QoS flows via N2.
\- Delivery of MBS data packets for multiple UEs over radio using PTM or PTP.
\- Configuration of UE for MBS QoS flow reception at AS layer.
\- Control switching between PTM and PTP delivery per UE.
\- Support for multicast session service continuity during Xn Handover and N2
Handover.
\- Support group paging at multicast session activation over radio toward UEs
in CM-IDLE state and CM-CONNECTED with RRC INACTIVE state.
\- Reception of MBS data packets from 5GC via shared MBS traffic delivery.
\- Support for efficient radio resource utilization for multiple broadcast MBS
Sessions via multiple CNs to deliver the same broadcast content in the case of
network sharing.
\- If supported, determine to move UE(s) receiving multicast MBS data from
RRC_CONNECTED state to CM-CONNECTED with RRC INACTIVE state if the UE(s) are
capable of receiving MBS data in RRC_INACTIVE state.
#### 5.3.2.8 UE
In addition to the functions defined in TS 23.501 [5], the UE may perform the
following functions to support MBS:
\- Reception of multicast data using PTM/PTP in RRC_CONNECTED state.
\- If supported, reception of multicast data using PTM in RRC_INACTIVE state.
\- Reception of broadcast data using PTM.
\- Handling of incoming MBS QoS flows.
\- Support of signalling for joining and leaving a Multicast MBS session.
\- MBS resource management support at AS layer.
\- Reception of notification in CM-IDLE state and CM-CONNECTED with RRC
_INACTIVE state for multicast data transmission.
\- Support of the aforementioned functions for UE using power saving
functions.
NOTE : UE functionality for MBS security is provided in TS 33.501 [20].
#### 5.3.2.9 AF
The AF performs the following functions to support MBS:
\- Requesting multicast or broadcast service from the 5GC by providing service
information including QoS requirement to 5GC.
\- Instructing MBS session operation towards 5GC if needed.
\- Interacting with NEF for MBS related service exposure.
\- Interacting with NEF for group message delivery to the UE(s).
#### 5.3.2.10 NEF
In addition to the functions defined in TS 23.501 [5], the NEF performs the
following functions to support MBS:
\- Providing an interface to AFs for MBS procedures including service
provisioning, MBS session and QoS management.
\- Interacting with AF and NFs in 5GC, e.g. MB-SMF for MBS session operations,
determination of transport parameters.
\- Selection of MB-SMF to serve an MBS Session.
\- Support of provisioning the optional MBS Session Assistance Information
related to the reception of multicast MBS data in RRC_INACTIVE state.
\- Interacting with AF and MBSF/MBSTF for group message delivery.
#### 5.3.2.11 MBSF
The MBSF performs the following functions to support MBS:
\- Service level functionality to support MBS, and interworking with LTE MBMS
\- Interacting with AF and MB-SMF for MBS session operations, determination of
transport parameters, and session transport.
\- Selection of MB-SMF to serve an MBS Session.
\- Controlling MBSTF if the MBSTF is used.
\- Determination of destination IP multicast address for the MBS session if IP
multicast address is sourced by MBSTF.
NOTE 1: MBSF functionality related to service and MBS data handling (e.g.
encoding) is specified in TS 26.502 [18].
NOTE 2: MBSF functionality for MBS security is provided in TS 33.501 [20].
#### 5.3.2.12 MBSTF
The MBSTF performs the following functions to support MBS if deployed:
\- Media anchor for MBS data traffic if needed.
\- Sourcing of IP Multicast if needed.
\- Generic packet transport functionalities available to any IP multicast
enabled application such as framing, multiple flows, packet FEC (encoding).
\- Multicast/broadcast delivery of input files as objects or object flows.
NOTE 1: MBSTF functionality related to MBS data handling (e.g. encoding) is
specified in TS 26.502 [18].
NOTE 2: MBSTF functionality for MBS security is provided in TS 33.501 [20].
#### 5.3.2.13 UDM
In addition to the functions defined in TS 23.501 [5], the UDM performs the
following functions to support MBS:
\- Support management of subscription for authorization for multicast MBS
sessions.
\- Support management of subscription MBS Assistance Information related to
the reception of multicast MBS data in RRC_INACTIVE state.
#### 5.3.2.14 UDR
In addition to the functions defined in TS 23.501 [5], the UDR performs the
following functions to support MBS if deployed:
\- Support storage or retrieval of MBS subscription data by the UDM for UE
authorization information for multicast MBS sessions and MBS Assistance
Information.
\- Support storage and retrieval of policy data by the PCF for Multicast or
Broadcast MBS sessions.
#### 5.3.2.15 NRF
##### 5.3.2.15.1 General
In addition to the functions defined in TS 23.501 [5], the NRF performs the
following functions to support MBS:
\- Support of new NF types MB-SMF and MBSF and their corresponding NF
profiles.
\- For both multicast and broadcast MBS sessions, support of MB-SMF discovery
based on parameters such as DNN, S-NSSAI and MBS service area, at MBS Session
creation.
\- For multicast MBS sessions, support of MB-SMF discovery based on MBS
Session ID by SMF serving the multicast Session at UE join.
NOTE: For broadcast MBS Session, AMF discovery by MB-SMF for an MBS service
area is based on tracking area IDs related to that service area, as registered
in the AMF profile according to TS 23.501 [5].
##### 5.3.2.15.2 Extensions to NF profile at NRF
In addition to the NF profile contents defined in clause 6.2.6.2 of TS 23.501
[5], the NF profile in the NRF contains the following content:
\- For MB-SMF, the NF profile may include MB-SMF service area, MBS Session
ID(s), Area Session ID(s) and corresponding MBS service area(s) if available.
# 6 Functionalities and features
## 6.1 Authorization to MBS service
### 6.1.1 AF authorization to the service for multicast and broadcast
The AF should be authorized by the 5GC for delivering MBS data to the 5GC
and/or interacting with the 5GC. For signalling exchange with the 5GC, the NEF
perform authorization to the external AF for determination of whether the
interaction with the 5GC is allowed or not.
### 6.1.2 UE authorization to the service for multicast
The following authorizations are defined:
a) Whether the UE is authorized to use the Multicast service in the PLMN.
b) The authorization for a UE of receiving the content of a specific multicast
MBS session.
A Multicast MBS session may be \"open to any UEs\".
NOTE 1: UE authorization for a specific Multicast MBS session can be
implicitly performed when UE is configured for a specific Multicast MBS
session, e.g. via Service Announcement for public safety use case.
NOTE 2: The authorization mentioned by a) is required even if an authorization
according to b) is available. If the UE is not authorized to use the Multicast
service by the PLMN, the UE is not authorized to join any multicast MBS
Session even if the Multicast MBS session is \"open to any UEs\".
For a Multicast MBS session, it is required that the 5GC authorizes the UE
based on the MBS subscription data and whether the Multicast MBS session is
\"open to any UEs\", which are preconfigured, or provided by the AF (see
clause 7.2.9).
The procedure for UE authorization is a part of UE join procedure and is
described in clause 7.2.1.3.
## 6.2 Local MBS service and Location dependent MBS service
### 6.2.1 General
A Local MBS service is an MBS service provided in one MBS service area. A
location dependent MBS service is an MBS service provided in several MBS
service area(s). An MBS service area is identified by a cell list or a
tracking area list. The MBS service area could be geographical area
information or civic address information, and NEF/MBSF translates the location
information to Cell ID list or TAI list as MBS service area, see clause
7.1.1.2.
The MBS service area may be updated by the AF for both multicast MBS sessions
and broadcast MBS sessions as specified in clause 7.1.1.6.
For more details, refer to clause 7.2.4 for multicast MBS session and refer to
clause 7.3.4 for broadcast MBS session.
### 6.2.2 Local MBS service
For a local MBS service, only UEs within the MBS service area may receive
content data, while UEs outside the MBS service area are not allowed to
receive location specific content. For multicast MBS service, UEs outside the
MBS service area are not allowed to join the MBS service, and the network
shall not deliver location specific content anymore to the UEs moved out of
the MBS service area. Depending on policy, for the multicast MBS service the
network may remove UEs outside the MBS service area of the MBS session from
the MBS Session Context after a grace period. The SMF may subscribe at the AMF
to notifications about \"UE moving in or out of a subscribed \"Area Of
Interest\"\" event.
For multicast communication, local MBS may be supported via 5GC Individual MBS
traffic delivery towards RAN nodes not supporting MBS. If the SMF obtains a
notification that the UE is no longer in the MBS service area, the SMF
terminates the 5GC Individual MBS traffic delivery towards the UE.
The UE shall be able to obtain service area information of the local multicast
service via MBS service announcement or via NAS signalling (UE Session Join
Accept/Reject including Cell ID list or TAI list). If the UE Session Join
procedure fails due to the UE being outside the MBS service area, the UE does
not attempt to join the Multicast MBS session again until the UE moves inside
the MBS service area. When the UE Session Join succeeds and if the Multicast
MBS session is inactive, the UE does not perform monitoring the session
activation notification and any other information related to the Multicast MBS
session identified by an MBS Session ID over the radio if outside the MBS
service area.
NOTE: Broadcast communication service is the service provided simultaneously
to all UEs in a geographical area, therefore for broadcast it is naturally a
local MBS service.
### 6.2.3 Location dependent MBS service
A location dependent MBS is identified by MBS Session ID, and provided in
several MBS service areas. The location dependent MBS service enables
distribution of different content data to different MBS service areas. The
same MBS Session ID is used but a different Area Session ID is used for each
MBS service area. The Area Session ID is used, in combination with MBS Session
ID, to uniquely identify the service area specific part of the content data of
the MBS service within 5GS. The network supports the location dependent
content distribution for the location dependent MBS services, while UEs are
only aware of the MBS Session ID (i.e. UEs are not required to be aware of the
Area Session IDs). When UE moves to a new MBS service area, content data from
the new MBS service area shall be delivered to the UE, and the network ceases
to deliver the content data from the old MBS service areas to the UE. For
multicast MBS service, UEs outside all MBS service areas of the location
dependent MBS session are not allowed to join the MBS service. When UE moves
out of an MBS service area and there is no other MBS service area for the MBS
session, the network ceases to deliver the content data to the UE. Depending
on policy, for the multicast MBS service the network may remove UEs outside
all MBS service areas of the location dependent MBS Session from the multicast
MBS Session Context after a grace period The SMF may subscribe at the AMF to
notifications about UE moving in or out of all MBS service areas of the
location dependent MBS session.
For multicast communication towards an NG-RAN supporting MBS, the NG-RAN node
handles mobility of UEs within the MBS session between MBS service areas
served by the same NG-RAN without interaction with SMF.
For multicast communication, location dependent MBS services may be supported
via 5GC Individual MBS traffic delivery towards RAN nodes not supporting MBS.
If the SMF determines that the UE is in another MBS service area of the
Multicast MBS session, the SMF configures the UPF to send multicast data
relating to the new MBS service area towards the UE.
Information about different MBS service areas for a location dependent MBS
service may be provided by one or several AFs or may be configured. Different
ingress points for location dependent points for the MBS session are supported
for different MBS service area dependent content of the MBS session; different
MB-SMFs and/or MB-UPF may be assigned for different MBS service areas in an
MBS session. When the different MB-SMFs are assigned for different MBS service
areas in an MBS session, the same TMGI is allocated for this MBS session.
The Area Session ID is allocated by MB-SMF in MBS Session creation procedure.
MB-SMF allocates Area Session ID for each MBS services area which is unique
within the MBS session. MB-SMF needs to further ensure there is no MBS service
area overlapping with other MBS service areas that share the same MBS Session
ID.
NOTE 1: In this release, deployments topologies with specific SMF Service
Areas are not supported, as a result, location dependent service using
multicast communication is not supported when a UE moves outside its SMF
service area.
NOTE 2: For location dependent service provided in different MBS service areas
within the same SMF service area, it is assumed that one MB-SMF is used for an
MBS Session.
NOTE 3: An example of Location dependent MBS is a nationwide weather forecast
service with local weather reports.
NOTE 4: Area Session ID is equivalent to Flow ID as specified in TS 23.246
[8].
### 6.2.4 Void
### 6.2.5 Void
## 6.3 Mobility support of MBS service
### 6.3.1 Mobility of Multicast MBS session
The mobility of multicast MBS service is supported when:
\- The UE moves from a NG-RAN node that supports MBS to a target NG-RAN node
that supports MBS; or
\- The UE moves from a NG-RAN node that supports MBS to a target NG-RAN node
that does not support MBS and vice versa.
During the mobility from a NG-RAN node that supports MBS to a target NG-RAN
node that supports MBS, or between a NG-RAN node that supports MBS and a
target NG-RAN node that does not support MBS, minimization of data loss should
be supported, see clause 7.2.3.5 for details.
To support Handover from NG-RAN node that supports MBS to a target NG-RAN node
that supports MBS:
\- If the shared delivery for the MBS session has not been established towards
target NG-RAN, the target NG-RAN establishes the shared delivery for the MBS
Session with MB-SMF and MB-UPF.
To support Handover from NG-RAN node that supports MBS to a target NG-RAN node
that does not support MBS:
\- mapping information about unicast QoS flows for multicast data transmission
and the information of associated multicast QoS flows are provided to the NG-
RAN node. This is already performed during the PDU session modification
procedure for the PDU session associated with the MBS session when the UE
joins the MBS Session;
\- during the handover procedure, the delivery method is switched from 5GC
Shared MBS traffic delivery method to 5GC Individual MBS traffic delivery
method, i.e. the N3 tunnel of the PDU Session for 5GC Individual MBS traffic
delivery needs to be established towards the target NG-RAN node. The SMF
realizes that the target NG-RAN node does not support MBS.
\- the SMF and the MB-SMF shall activate the GTP tunnel between the UPF and
the MB-UPF for 5GC Individual MBS traffic delivery method, if needed.
To support Handover from a NG-RAN node that does not support MBS to a target
NG-RAN node that supports MBS:
\- The PDU sessions, including the one associated with the MBS session and
used for 5GC Individual MBS traffic delivery, are handed over to the target
NG-RAN node.
\- SMF triggers mode switch, i.e. from 5GC Individual MBS traffic delivery
method to 5GC shared MBS traffic delivery method.
\- When the MBS Session Context is given to the target NG-RAN node by the SMF,
if the shared delivery for the MBS session has not been established towards
target NG-RAN, the target NG-RAN establishes the shared delivery for the MBS
Session with MB-SMF and MB-UPF.
\- The 5GC terminates the 5GC Individual MBS traffic delivery and changes to
the 5GC shared MBS traffic delivery.
### 6.3.2 Mobility of Broadcast MBS session
The UE receives the same Broadcast MBS service in the target NG-RAN if the
same MBS session is established with 5GC Shared MBS traffic delivery method in
the target NG-RAN node.
NOTE: When the UE moves into NG-RAN node not supporting MBS within the
Broadcast MBS service area, how the UE get the same content via application
level is out scope of this specification.
## 6.4 Subscription to multicast services
### 6.4.1 General
The UDM stores the MBS subscription information. The MBS subscription data for
a UE is included within the UE subscription data.
At any time, the operator may change the subscription for multicast services
in the UDM.
The MBS subscription data in UE subscription data contains the following
information:
\- MBS authorization information that gives the user permission to use
multicast services
\- Whether the UE is authorized to use the multicast MBS service.
\- Optionally, MBS Session ID(s) of the Multicast MBS session(s) that the UE
is allowed to join.
NOTE: The MBS Session ID applies only for MBS session which is not \"open to
any UEs\".
\- Optionally, MBS assistance information indicating that a UE is preferred to
be kept connected when the related MBS Session the UE joined is active, which
contains the following information:
\- MBS Session ID(s).
The MBS subscription data is provided by the UDM to the SMF during or after
the establishment procedure of PDU Session associated with Multicast MBS
session(s) using Nudm_SDM service for subscription data type \"MBS
subscription data\" as defined in clause 7.2.1.2.
During multicast session join procedure, the SMF retrieves MBS Session
information from the MB-SMF, and authorizes the MBS Session join request for
the UE based on MBS subscription data of the UE received from UDM and the Any
UE indication (i.e. whether the Multicast MBS session is \"open to any UEs\")
received from MB-SMF as described in clause 7.2.1.3.
The UDR stores the MBS data, which may be updated by the UDM or the AF/NEF as
specified in clause 4.15.6.2 of TS 23.502 [6], i.e. AF may provision Multicast
MBS Session Authorization information for the MBS as described in clause
7.2.9.
### 6.4.2 MBS subscription data in UDM
The information stored in the UDM as defined in clause 5.2.3.3.1 of TS 23.502
[6] is extended as follows:
\- MBS subscription data for a UE as part of UE subscription data, as defined
in Table 6.4.2-1, with keys defined in Table 6.4.2-2.
Table 6.4.2-1: MBS subscription data type
Subscription data type Field Description
* * *
                           MBS allowed                  Indicates whether the UE is authorized to use the multicast MBS service.
MBS subscription data Allowed MBS Session ID(s) Identifies the MBS Session(s)
that the UE are allowed to join. MBS assistance information Indicates that the
UE is preferred to be kept connected when the related MBS session the UE
joined is active, which contains the related MBS Session ID(s)
Table 6.4.2-2: MBS subscription data type keys
Subscription Data Types Data Key Data Sub Key
* * *
MBS Subscription data SUPI -
### 6.4.3 MBS information in UDR
The MBS information may be stored in the UDR by the UDM as part of the
subscription data, as defined in clause 5.2.12.2.1 of TS 23.502 [6].
1\. MBS data as defined in Tables 6.4.2-1, with keys defined in Table 6.4.3-1.
Table 6.4.3-1: MBS data type keys
Data Set Data Subset Data Key Data Sub Key
* * *
Subscription Data MBS subscription data SUPI -
## 6.5 Identifiers
### 6.5.1 MBS Session ID
The MBS session ID is used to identify a Multicast/Broadcast MBS Session by
the 5G system on external interface towards AF and between AF and UE, and
towards the UE.
MBS Session ID may have the following types:
\- TMGI (for broadcast and multicast MBS sessions);
\- source specific IP multicast address (for multicast MBS sessions).
If a multicast MBS session is provided within an SNPN, the multicast MBS
session can still be identified by a (globally unique) source specific IP
multicast address or TMGI. In 5GS internal signalling the PLMN ID, included in
TMGI, is complemented with the NID to identify an SNPN.
Source specific IP multicast address or TMGI may be used as MBS Session ID in
NAS messages exchange between a UE and a CN when the UE requests to join/leave
a Multicast MBS session. For multicast MBS sessions that the UE joined with a
source specific IP multicast address, a TMGI is also allocated by 5GC and is
sent to the UE and used in other signalling messages between RAN, CN and UE.
Details see clause 7.2.1.3.
The UE shall be able to obtain at least one MBS Session ID via MBS service
announcement.
For multicast MBS sessions, a source specific IP multicast address can be
assigned by external AFs.
### 6.5.2 Temporary Mobile Group Identity
TMGI (Temporary Mobile Group Identity) is defined in TS 23.003 [12] and is
used to be able to identify a broadcast MBS Session or a multicast MBS
session.
In SNPN (Stand-alone Non-Public Network), TMGI is used together with NID
(Network Identifier) defined in TS 23.003 [12] to identify an MBS Session.
### 6.5.3 Source Specific IP Multicast Address
The source specific IP multicast address is used to identify an Multicast MBS
session and consists of two IP addresses, one is an IP unicast address used as
source address in IP packets for identifying the source of the multicast
service (e.g. AF/AS), the other is an IP multicast address used as destination
address in related IP packets for identifying a multicast communication
service associated with the source.
### 6.5.4 MBS Frequency Selection Area ID
The MBS Frequency Selection Area (FSA) ID is used for broadcast MBS session to
guide the frequency selection of the UE.
MBS FSA ID identifies a preconfigured area within, and in proximity to, which
the cell(s) announces the MBS FSA ID and the associating frequency (details
see TS 38.300 [9]). MBS FSA ID and their mapping to frequencies are provided
to RAN nodes via OAM.
Based on this configuration, RAN nodes announce in SIBs over the radio
interface information about the MBS FSA IDs and frequencies.
When a broadcast MBS session is created, the AF may provide MBS FSA ID(s)
based on the business agreement. If the AF does not provide MBS FSA ID(s), the
MB-SMF determines MBS FSA ID(s) based on configured mapping from MBS service
area and/or broadcast MBS session information (e.g. application ID) to MBS FSA
ID(s) and sends the determined MBS FSA ID(s), to the AF (optionally via NEF).
NOTE: The same MBS FSA ID(s) can be assigned to multiple Broadcast MBS
sessions.
The MBS FSA ID(s) of a broadcast MBS session are communicated in the service
announcement towards the UE. The UE compares those MBS FSA IDs(s) with the MBS
FSA ID(s) in SIBs for frequency selection.
During MBS Session Start for Broadcast in clause 7.3.1 and MBS Session Update
for Broadcast in clause 7.3.3, the MB-SMF may include the MBS FSA ID(s) for
the MBS session and send them to the NG-RAN nodes via the AMF. The NG-RAN
nodes may then use those MBS FSA ID(s) to determine cells/frequencies within
the MBS service area to broadcast MBS session data. For details, see TS 38.300
[9] and TS 38.413 [15].
### 6.5.5 Associated Session ID
In the case of network sharing, an Associated Session ID may be used as
specified in clause 6.18. When the AF creates multiple broadcast MBS Sessions
via different CNs to deliver the same content, it may provide the Associated
Session ID which enables the NG-RAN to identify the multiple MBS Sessions
delivering the same content.
Source Specific IP Multicast Address specified in clause 6.5.3 may be used as
Associated Session ID.
## 6.6 QoS Handling for Multicast and Broadcast services
For MBS services, the network shall support QoS control per MBS session.
The 5G QoS model and parameters as defined in TS 23.501 [5] clause 5.7 also
apply to multicast/broadcast communication services with the following
differences:
\- Reflective QoS is not applicable;
\- Wireline access network specific 5G QoS parameters do not apply to MBS
services;
\- Alternative QoS Profile is not applicable;
\- QoS Notification Control is not applicable;
\- UE-AMBR is not applicable;
NOTE 1: For multicast communication service, the UE-AMBR applies for
associated PDU Session.
\- Session-AMBR if provided is enforced at MB-UPF but not communicated to NG-
RAN.
NOTE 2: Whether Session-AMBR is required in addition to the MBS service data
flow bit rate is determined by operator policy and/or agreement with the
service provider.
\- For broadcast MBS session, the QoS rule and QoS Flow level QoS parameters
are not provided to UE.
NOTE 3: For broadcast MBS session, the associated QoS Flow(s) are not
applicable.
\- For multicast MBS sessions, the QoS rule and QoS Flow level QoS parameters
of MBS QoS Flow are not provided to UE.
\- For multicast MBS sessions, the handling of QoS rule and QoS Flow level QoS
parameters of the associated QoS Flow(s) is the same as for other QoS Flow
without UL in a PDU Session.
NOTE 4: The UE does not need to know a QoS Flow within the PDU session is
mapped from MBS QoS Flow.
The network shall support one or multiple QoS flows, which can be either GBR
or non-GBR, for an MBS session.
If 5GC Individual MBS traffic delivery method is used to deliver multicast
data packets, the network may use dedicated QoS Flows for multicast data
packets in a PDU session. For the associated QoS Flow in the PDU session, the
SMF uses the same QoS parameters (e.g. 5QI) provided by MB-SMF. These
dedicated QoS Flows shall be kept separate from QoS Flows unrelated to
multicast even if the same 5QI and other QoS parameters are assigned.
NOTE 5: When there is a need to apply 5GC Individual MBS traffic delivery, the
Session-AMBR of the associated PDU Session can be configured with a
sufficiently high value to cater for MBS Session-AMBR.
The MB-SMF may obtain QoS information for multicast and broadcast MBS session
in different ways depending on the deployment and use cases.
If dynamic PCC is not deployed:
\- When an MBS session is started, the MB-SMF is provided with service
requirements including QoS information. If MBSF is not used, the service
requirement is provided to the MB-SMF by the AF (directly or via the NEF). If
the MBSF is used, the MBSF receives request from the AF (or via the NEF) and
decides the related QoS requirements (e.g. considering support for FEC) and
provides them to the MB-SMF. The MB-SMF determines the QoS profiles and QoS
for N4 rules for the MBS session with QoS parameters of the MBS QoS flows, and
provides related information to the RAN and the MB-UPF respectively.
NOTE 6: What information is included in the request from AF to MBSF requires
collaboration with SA WG4.
If dynamic PCC is deployed:
\- It is the PCF that generates policy rules for MBS Session based on the
received service requirement and provides the policy rules to the MB-SMF. The
MB-SMF, based on the policy rules from the PCF, determines to create, and/or
modify MBS QoS Flow(s) including providing QoS information to NG-RAN and MB-
UPF, and providing packet detection and forwarding information to MB-UPF.
## 6.7 User plane management
The MB-UPF acts as the MBS Session Anchor of an MBS session, and if the MBSTF
is involved in the MBS session, then the MBSTF acts as the media anchor of the
MBS traffic. The MB-UPF receives only one copy of MBS data packets from AF or
MBSTF.
The user plane between MB-UPF and AF, may use either multicast transport or a
unicast tunnel for the MBS session (depending on application and capabilities
of control interface). If the transport network does not support multicast
transport, the user plane uses a unicast tunnel for the MBS Session. The user
plane between MBSTF and AF may use a unicast tunnel, multicast transport or
other means (e.g. HTTP download from external CDN). The user plane between
MBSTF and MB-UPF uses a unicast tunnel for the MBS session. If a unicast
tunnel is used for the MBS Session between MB-UPF and AF or MBSTF, after
receiving the downlink MBS data, the MB-UPF forwards the downlink MBS data
without the received outer IP header and tunnel header information.
NOTE 1: For location dependent MBS Session, the user plane towards the MB-UPF
can only use unicast tunnel and content to be delivered to different areas are
sent to MB-UPF via different tunnels.
The user plane from the MB-UPF to NG-RAN(s) (for 5GC Shared MBS traffic
delivery) and the user plane from the MB-UPF to UPFs (for 5GC Individual MBS
traffic delivery) may use multicast transport via a common GTP-U tunnel per
MBS session, or use unicast transport via separate GTP-U tunnels at NG-RAN or
at UPF per MBS session in the following way
\- For 5GC Shared MBS traffic delivery (i.e. MB-UPF delivers user plane data
to NG-RAN supporting MBS), if the transport network supports IP multicast, the
NG-RAN node uses multicast transport via a common GTP-U tunnel per MBS
session, otherwise unicast transport via separate GTP-U tunnel per MBS session
per NG-RAN node is used.
\- For 5GC Individual MBS traffic delivery (i.e. MB-UPF delivers user plane
data to UPF), if the transport network supports IP multicast and the UPF
supports reception of multicast data over N19mb, UPF use multicast transport
via a common GTP-U tunnel per MBS session, otherwise unicast transport via
separate GTP-U tunnel per MBS session per UPF is used.
If the user plane uses unicast transport, the transport layer destination is
the IP address of the NG-RAN or UPF, each NG-RAN or UPF allocates the tunnel
separately and multiple GTP-U tunnels are used for the MBS Session. If the
user plane uses multicast transport, a common GTP-U tunnel is used for both
RAN and UPF nodes. The GTP-U tunnel is identified by a common tunnel ID and an
IP multicast address as the transport layer destination, both assigned by 5GC.
The above is depicted in Figure 6.7‑1. There could be more than one NG-RANs or
UPFs that are involved in the MBS traffic delivery.
Figure 6.7‑1: Schematic showing user plane data transmission
The MB-SMF instructs the MB-UPF to receive packets related to an MBS session.
MB-UPF transmits the MBS data with the sequence number for each MBS QoS Flow
as defined in TS 29.281 [23].
For shared delivery, if unicast transport over N3mb applies, the MB-SMF
instructs MB-UPF to replicate the received MBS packets and forward them
towards multiple RAN nodes via separate GTP tunnel. For shared delivery, if
multicast transport over N3mb applies, the MB-SMF instructs the MB-UPF to
replicate the received MBS data and forwards the data via a single GTP tunnel.
For individual delivery, the MBS data received by the MB-UPF is replicated
towards the UPF(s) where individual delivery is performed in the following
way:
\- The MB-SMF configures the MB-UPF to receive packets related to an MBS
session, to replicate those packets and forward them towards multiple UPFs via
GTP tunnels if unicast transport over N19mb is applied, or via a single GTP
tunnel if multicast transport over N19mb is applied.
\- The SMF(s) instructs the UPF to receive packets related to a Multicast MBS
session from an MB-UPF over N19mb, to replicate those packets and to forward
them in multiple PDU sessions.
For the MB-SMF and MB-UPF, packet detection, replication and forwarding for an
MBS session is realized by using for each MBS session one PDR that detects the
incoming MBS packets and points to one FAR that describes the forwarding of
the data towards multiple destinations (UPFs or RAN nodes):
\- A PFCP session is created when the MBS Session is started, regardless of
multicast or unicast transport over N3mb and N19mb.
\- For Multicast transport over N3mb and N19mb, the destination in the FAR
contains the MB-UPF IP Multicast Distribution Info.
\- For unicast transport over N3mb and N19mb, the FAR in the PFCP session may
contain multiple destinations represented by the NG-RAN N3mb Tunnel Info and
UPF N19mb Tunnel Info (if applicable).
For the SMF and the UPF (for 5GC individual delivery), packet detection,
replication and forwarding for an MBS session is realized by PDR and FAR of
the PDU session in which the UE has joined the MBS session:
\- The SMF instructs the UPF to associate the PFCP session of the PDU session
with an MBS session.
\- A new PDR with Source Interface \"Core\" is used to detect MBS data from
N19mb.
NOTE 2: This PDR is also containing the MBS Session ID to enable a single
detection of the incoming MBS data for multiple PDU sessions at the UPF.
\- For unicast transport over N19mb, the SMF requests UPF to allocate N19mb
Tunnel Info if not allocated.
\- For multicast transport over N19mb, the SMF includes the low layer source
specific multicast address information and C-TEID to UPF.
\- If the SMF wants to maintain the MBS data reception over N19mb but suspends
the delivery of the data to the UE\'s PDU session, the Action of FAR set to
\"drop\" (e.g. when the UE is switching from 5GC Individual delivery to 5GC
Shared delivery due to the UE moving from MBS non-supporting NG-RAN to MBS
supporting NG-RAN). Otherwise the SMF remove the related PDR and FAR.
See TS 29.244 [17] for the details of user plane handling.
## 6.8 Interworking with MBMS over E-UTRAN for public safety services
In order to minimize the interruption of services, upon mobility for MBS
service from NR/5GC to E-UTRAN/EPC and vice versa, the following applies:
\- If the same MBS service is provided via eMBMS in E-UTRAN and MBS,
interworking is supported at service layer.
\- The UE is always configured with a common TMGI regardless of whether the UE
is discovering the MBMS/MBS service via E-UTRAN or NR, for both multicast and
broadcast MBS services.
\- When the UE camps on NR and uses a multicast MBS service, the UE joins a
multicast MBS session and uses procedures as defined in clause 7.2 for MBS
reception for the TMGI. When the UE camps on E-UTRAN, the UE uses procedures
as defined in TS 23.246 [8] for MBMS reception for the TMGI.
\- The session context for multicast MBS service transferring is not handed
over to E-UTRAN during mobility from 5GS to EPS.
## 6.9 MBS Session Context
### 6.9.1 MBS Session Context
The MBS Session Context contains all information describing a particular MBS
session in the 5GS and is created in each node involved in the delivery of the
MBS data.
The content of the Multicast MBS Session Context is described in Table
6.9.1-1.
Table 6.9.1-1: Multicast MBS Session Context
+-----------+-----------+-----------+-----+----------+-----------+ | Parameter | De | NG-RAN | AMF | SMF | MB-SMF | | | scription | | | | | +===========+===========+===========+=====+==========+===========+ | State | State of | X | | X | X | | | MBS | | | | | | | session | (note 2) | | (note 2) | | | | (\ | | | | | | | 'Active\' | | | | | | | or | | | | | | | \'I | | | | | | | nactive\' | | | | | | | or | | | | | | | \'Conf | | | | | | | igured\') | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | SSM | IP | | | X\ | X\ | | (source | multicast | | | (note 1) | (note 1) | | specific | address | | | | | | IP | id | | | | | | multicast | entifying | | | | | | address) | the MBS | | | | | | | session. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | TMGI | Temporary | X | X | x | X | | | Mobile | | | | | | | Group | | | | | | | Identity | | | | | | | allocated | | | | | | | to the | | | | | | | MBS | | | | | | | Session. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | Area | Used for | X\ | X | X\ | X\ | | Session | MBS | (note 1) | | (note 1) | (note 1) | | I | session | | | | | | dentifier | with | | | | | | | location | | | | | | | dependent | | | | | | | content. | | | | | | | When | | | | | | | present, | | | | | | | the Area | | | | | | | Session | | | | | | | I | | | | | | | dentifier | | | | | | | together | | | | | | | with the | | | | | | | TMGI | | | | | | | uniquely | | | | | | | identify | | | | | | | the MBS | | | | | | | Session | | | | | | | in a | | | | | | | specific | | | | | | | MBS | | | | | | | service | | | | | | | area. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | MB-SMF | The | | X | X | | | | MB-SMF | | | | | | | that | | | | | | | handles | | | | | | | the MBS | | | | | | | session. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | QoS | QoS | X | | X | X | | in | in | | | | | | formation | formation | | | | | | | of the | | | | | | | MBS | | | | | | | session. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | MBS | Area over | X\ | | X\ | X\ | | Service | which the | (note 1) | | (note 1) | (note 1) | | Area | MBS | | | | | | | session | | | | | | | data is | | | | | | | di | | | | | | | stributed | | | | | | | (i.e. | | | | | | | Cell ID | | | | | | | list or | | | | | | | TAI | | | | | | | list). | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | NG-RAN | NG-RAN | | X | | X\ | | Node | nodes | | | | (note 1, | | ID(s) | which are | | | | note 4) | | | involved | | | | | | | in the | | | | | | | Multicast | | | | | | | MBS | | | | | | | session | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | AMF | The | X | | | X | | | AMF(s) | | | | | | | which are | | | | | | | selected | | | | | | | for the | | | | | | | MBS | | | | | | | session | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | IP | IP | X | | X\ | X | | multicast | addresses | (note 1) | | (note 1) | | | and | id | | | | (note 1) | | source | entifying | | | | | | address | the SSM | | | | | | for data | user | | | | | | dis | plane | | | | | | tribution | transport | | | | | | | for | | | | | | | shared | | | | | | | delivery | | | | | | | from | | | | | | | MB-UPF to | | | | | | | NG-RAN | | | | | | | and for | | | | | | | i | | | | | | | ndividual | | | | | | | delivery | | | | | | | from | | | | | | | MB-UPF to | | | | | | | UPF when | | | | | | | the IP | | | | | | | multicast | | | | | | | transport | | | | | | | is used. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | TEID for | Tunnel ID | X | | X | X | | IP | allocated | | | | | | multicast | by MB-UPF | | | | (note 1) | | dis | used for | | | | | | tribution | receiving | | | | | | | the | | | | | | | multicast | | | | | | | data for | | | | | | | shared | | | | | | | delivery | | | | | | | by NG-RAN | | | | | | | and for | | | | | | | i | | | | | | | ndividual | | | | | | | delivery | | | | | | | by UPF | | | | | | | when the | | | | | | | IP | | | | | | | multicast | | | | | | | transport | | | | | | | is used. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | SMF | The | | | | X | | | SMF(s) | | | | | | | that | | | | | | | manages | | | | | | | the | | | | | | | a | | | | | | | ssociated | | | | | | | PDU | | | | | | | session. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | UE ID | ID | X | | X | | | | id | | | | | | | entifying | (note 3) | | (note 3) | | | | the UE | | | | | | | that | | | | | | | suc | | | | | | | cessfully | | | | | | | join the | | | | | | | Multicast | | | | | | | MBS | | | | | | | session. | | | | | | | For | | | | | | | NG-RAN it | | | | | | | is NGAP | | | | | | | UE ID and | | | | | | | for SMF | | | | | | | it is | | | | | | | SUPI. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | NG-RAN IP | The IP | X | | X\ | X | | unicast | addresses | (note 1) | | (note 1) | | | dis | and TEID | | | | (note 1, | | tribution | of NG-RAN | | | | note 4) | | | used for | | | | | | | the user | | | | | | | plane | | | | | | | between | | | | | | | NG-RAN | | | | | | | and | | | | | | | MB-UPF | | | | | | | and | | | | | | | between | | | | | | | MB-UPF | | | | | | | and UPF | | | | | | | when | | | | | | | Point to | | | | | | | Point | | | | | | | tunnel is | | | | | | | used. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | PCF | The | | | | X | | | MB-PCF | | | | (note 1) | | | that | | | | | | | provides | | | | | | | policy | | | | | | | control | | | | | | | for the | | | | | | | MBS | | | | | | | session. | | | | | +-----------+-----------+-----------+-----+----------+-----------+ | NOTE 1: | | | | | | | It is an | | | | | | | optional | | | | | | | p | | | | | | | arameter. | | | | | | | | | | | | | | NOTE 2: | | | | | | | The value | | | | | | | \'Con | | | | | | | figured\' | | | | | | | is not | | | | | | | a | | | | | | | pplicable | | | | | | | for | | | | | | | NG-RAN | | | | | | | and SMF. | | | | | | | | | | | | | | NOTE 3: | | | | | | | the UE ID | | | | | | | is | | | | | | | available | | | | | | | within | | | | | | | the UE | | | | | | | Context | | | | | | | which | | | | | | | contains | | | | | | | the MBS | | | | | | | inf | | | | | | | ormation. | | | | | | | | | | | | | | NOTE 4: | | | | | | | The | | | | | | | Parameter | | | | | | | needs to | | | | | | | be stored | | | | | | | in | | | | | | | de | | | | | | | ployments | | | | | | | with | | | | | | | shared | | | | | | | NG-U | | | | | | | termi | | | | | | | nation(s) | | | | | | | if | | | | | | | unicast | | | | | | | transport | | | | | | | is used. | | | | | | +-----------+-----------+-----------+-----+----------+-----------+
In Broadcast MBS session, an MBS Session Context is created in the NG-RAN,
AMF, MB-SMF and MBSF as a result of the MBS Session Start procedure.
The content of the Broadcast MBS Session Context is described in Table
6.9.1-2.
Table 6.9.1-2: Broadcast MBS Session context
+---------------+---------------+----------+----------+---------------+ | Parameter | Description | NG-RAN | AMF | MB-SMF | +===============+===============+==========+==========+===============+ | TMGI | Temporary | X | X | X | | | Mobile Group | | | | | | Identity | | | | | | allocated to | | | | | | the MBS | | | | | | Session. | | | | +---------------+---------------+----------+----------+---------------+ | Area Session | Used for MBS | X\ | X\ | X\ | | Identifier | session with | (note 1) | (note 1) | (note 1) | | | location | | | | | | dependent | | | | | | content. When | | | | | | present, the | | | | | | Area Session | | | | | | Identifier | | | | | | together with | | | | | | the TMGI | | | | | | uniquely | | | | | | identify the | | | | | | MBS Session | | | | | | in a specific | | | | | | MBS service | | | | | | area. | | | | +---------------+---------------+----------+----------+---------------+ | AMF | The AMF(s) | X | | X | | | which are | | | | | | selected for | | | | | | the MBS | | | | | | session | | | | +---------------+---------------+----------+----------+---------------+ | MB-SMF | The MB-SMF | | X | | | | that handles | | | | | | the MBS | | | | | | session. | | | | +---------------+---------------+----------+----------+---------------+ | QoS | QoS | X | | X | | information | information | | | | | | for the MBS | | | | | | Session, | | | | | | including the | | | | | | QoS | | | | | | parameters of | | | | | | QoS flows. | | | | +---------------+---------------+----------+----------+---------------+ | MBS Service | Area over | X | X | X | | Area | which the MBS | | | | | | session data | | | | | | is | | | | | | distributed | | | | | | (i.e. Cell ID | | | | | | list or TAI | | | | | | list). | | | | +---------------+---------------+----------+----------+---------------+ | NG-RAN Node | NG-RAN nodes | | X | X\ | | ID(s) | which are | | | (note 1, | | | selected for | | | note 2) | | | the Broadcast | | | | | | MBS session | | | | +---------------+---------------+----------+----------+---------------+ | IP multicast | IP addresses | X\ | | X\ | | address for | identifying | (note 1) | | (note 1) | | data | the SSM user | | | | | distribution | plane | | | | | | transport | | | | | | used for | | | | | | shared | | | | | | delivery from | | | | | | MB-UPF to | | | | | | NG-RAN when | | | | | | the IP | | | | | | multicast | | | | | | transport is | | | | | | used. | | | | +---------------+---------------+----------+----------+---------------+ | TEID for IP | Tunnel ID | X | | X\ | | multicast | allocated by | | | (note 1) | | distribution | MB-UPF used | | | | | | for receiving | | | | | | the broadcast | | | | | | data for | | | | | | shared | | | | | | delivery by | | | | | | NG-RAN when | | | | | | the IP | | | | | | multicast | | | | | | transport is | | | | | | used. | | | | +---------------+---------------+----------+----------+---------------+ | NG-RAN IP | IP address | X\ | | X\ | | unicast | and TEID of | (note 1) | | (note 1, | | distribution | NG-RAN used | | | note 2) | | | for the user | | | | | | plane from | | | | | | NG-RAN to | | | | | | MB-UPF when | | | | | | Point to | | | | | | Point tunnel | | | | | | is used. | | | | +---------------+---------------+----------+----------+---------------+ | PCF | The PCF that | | | X\ | | | provides | | | (note 1) | | | policy | | | | | | control for | | | | | | the MBS | | | | | | session. | | | | +---------------+---------------+----------+----------+---------------+ | MBS FSA ID | MBS Frequency | X | | X | | | Selection | | | | | | Area (FSA) ID | | | | | | is used for | | | | | | broadcast MBS | | | | | | sessions to | | | | | | guide the | | | | | | frequency | | | | | | selection of | | | | | | the UE. | | | | +---------------+---------------+----------+----------+---------------+ | Associated | Associated | X\ | | X\ | | Session ID | Session ID is | (note 1) | | (note 1) | | | used by | | | | | | NG-RAN in | | | | | | network | | | | | | sharing to | | | | | | identify MBS | | | | | | sessions via | | | | | | different CNs | | | | | | transmitting | | | | | | the same | | | | | | content. | | | | +---------------+---------------+----------+----------+---------------+ | NOTE 1: It is | | | | | | an optional | | | | | | parameter. | | | | | | | | | | | | NOTE 2: The | | | | | | Parameter | | | | | | needs to be | | | | | | stored in | | | | | | deployments | | | | | | with shared | | | | | | NG-U | | | | | | t | | | | | | ermination(s) | | | | | | if unicast | | | | | | transport is | | | | | | used. | | | | | +---------------+---------------+----------+----------+---------------+
## 6.10 Policy control for Multicast and Broadcast services
### 6.10.1 General
The policy and charging control framework as defined in TS 23.503 [7] applies
to Multicast and Broadcast services in the following aspects:
\- MBS Session binding: MBS Session binding is the association of an AF
Session information to one and only one MBS Session. The PCF shall perform the
session binding based on the MBS Session ID, i.e. TMGI or source specific IP
multicast address.
\- QoS Flow binding: For an MBS Session, QoS Flow binding is the association
of a PCC rule to a QoS Flow within an MBS Session. The MB-SMF performs QoS
Flow binding for an MBS Session in the same way as the SMF for a PDU Session.
\- MBS policy information consists of:
\- PCC rules for MBS Session are used to provide policy for QoS flows: The
following PCC rule parameters defined in Table 6.3.1 of TS 23.503 [7] are
applicable for MBS:
\- Rule identifier.
\- Service data flow detection: Precedence, Service data flow template (only
for IP PDU traffic).
\- Policy Control: 5G QoS Identifier (5QI), DL-maximum bitrate, DL-guaranteed
bitrate, ARP, Priority Level, Averaging Window, Maximum Data Burst Volume.
\- Policy information can also be applicable for an entire MBS session. The
following parameters defined for a PDU session in Table 6.4.1 of TS 23.503 [7]
are applicable for an entire MBS session:
\- Authorized Session-AMBR.
\- Explicitly signalled QoS Characteristics.
\- Policy Control Request Triggers for MBS Session are used to define the
conditions when the MB-SMF shall interact again with the PCF to request an
update of the policy information for the MBS session by providing information
on the condition(s) that have been met. The following Policy Control Request
Triggers are defined for MBS:
\- MBS Session Update.
### 6.10.2 MBS Session policy control data in UDR
The policy control profile information may optionally be provided by the UDR
at MBS Session establishment, using Nudr service for Data Set \"Policy Data\"
and Data Subset \"MBS Session policy control data\", with the source specific
multicast address used as MBS session ID or with AF Application identifier as
data key is described in Table 6.10.2-1.
Table 6.10.2-1: MBS Session policy control information
Information element name Description Category
* * *
5QI(s) Allowed 5QI(s) for a PCC rule of an MBS session (NOTE 1) Optional ARP
Highest ARP for any PCC rule of an MBS session (NOTE 1) Optional Session-AMBR
Maximum Session-AMBR for all nonGBR QoS Flows of an MBS session (NOTE 1)
Optional GBR Maximum aggregated bitrate that can be provided across all GBR
QoS Flows for an MBS session (NOTE 1) Optional NOTE 1: This information
element may be used to decide whether to authorize received MBS Service
Information.
## 6.11 Service Announcement
Service Announcement provides the UE with descriptions specifying the
multicast or broadcast services to be delivered as part of MBS Session.
The Service Announcement includes the MBS Session ID(s), which is represented
by TMGI or a Source Specific IP Multicast Address, for the service. When the
MBS Session ID is Source Specific IP Multicast Address, the Service
Announcement may include the PLMN ID of the PLMN and NID for an SNPN in which
the service is delivered.
The Service Announcement includes an MBS Service Type, which indicates whether
the MBS Session for the service is multicast or broadcast.
NOTE 1: A Source Specific IP Multicast Address as MBS Session ID indicates a
Multicast MBS session.
For local MBS service, the Service Announcement may include the MBS service
area. The MBS service area used by AF can be Cell ID list, TAI list,
geographical area information or civic address information. Amongst them, Cell
ID list and TAI list shall only be used by AFs who reside in trust domain, and
when the AFs are aware of such information.
The service announcement may contain a start time and/or a sequence of
scheduled activation times (e.g. a first time and a periodicity) of the MBS
session when the AF may activate the MBS session (for multicast only) and
transmit MBS data as described in clause 6.16. When the AF decides that the
start time and/or scheduled activation times for the MBS session need to be
updated and the UE is unreachable (e.g. due to power saving function), the AF
can send service announcement containing the updated time information to the
UE at the old start time (if earlier than the new start time) or next
scheduled activation time previously provided to the UE for the MBS session
via multicast or broadcast.
NOTE 2: The scheduled activation times are intended to assist UEs using power
saving mechanisms and apply both for broadcast and multicast MBS.
NOTE 3: For UEs using power saving function, if the service announcement is
provided via unicast PDU Session, the application server can be aware of the
UE\'s reachability by subscribing to the corresponding event defined in clause
4.15.3.1 of TS 23.502 [6].
If the MBS Session is multicast, the Service Announcement may include the DNN
and S-NSSAI of the PDU Session to indicate which PDU Session is associated
with the MBS Session.
NOTE 4: For multicast, AF or MBSF provides Service Announcement to the UE only
after the MBS information is available to 5GC, to avoid potential rejection
sent by SMF of the MBS session join request.
NOTE 5: The MBS Service related information, e.g. default PLMN ID, DNN and
S-NSSAI can be pre-configured in the UE.
NOTE 6: If DNN and S-NSSAI information is not provided in the service
announcement or pre-configured, how UE determines the PDU session to join the
MBS Session is implementation specific.
If the MBS Session is broadcast, the Service Announcement may include the MBS
FSA ID(s) and optional frequency information associated with the broadcast MBS
session.
The Service Announcement may be provided to a UE by AF or MBSF, or may be
retrieved by the UE from those entities.
NOTE 7: How the UE can get the Service Announcement from other entities is not
specified.
NOTE 8: Service announcement can comply with TS 26.502 [18] and TS 23.289 [21]
or follow an application specific format.
NOTE 9: For supporting MBS security function, information included in Service
Announcement is defined in TS 26.502 [18].
## 6.12 Paging strategy handling
Compared to the paging strategy handling specified in clause 5.4.3 of TS
23.501 [5], the following additional functionality for multicast MBS service
applies:
\- At multicast MBS Session Activation, the SMF may provide the most demanding
ARP and 5QI of all MBS QoS Flow within the MBS session to the AMF.
\- The AMF may take the received ARP and 5QI into consideration in paging
differentiation.
## 6.13 MBS Security function
Security function may be used to protect MBS related signalling/data. Detailed
descriptions of security requirements, procedures and handling for 5G
Multicast/Broadcast Service (MBS) are provided in TS 33.501 [20].
MBS security function is implemented in the MBSF/MBSTF so that it can be
applied only when MBSF/MBSTF are used (i.e. Configuration option 2 and 3). For
configuration option 1 how to support MBS security is out of scope of this
specification.
The following additions to the MBS procedures for multicast Session in the
present specification apply if the functionalities of MBS security for control
plane procedure for multicast as defined in TS 33.501 [20] is used:
\- The multicast session security context, as defined in TS 33.501 [20], is
used to protect MBS traffic of an MBS session. During the session
establishment and when a UE joins, the multicast session security context
contains MSK and MTK.
\- The UEs in the MBS session use the received multicast session security
context to process the protected MBS traffic.
\- MBSF distributes the multicast session security context to the MB-SMF via
the Nmbsmf_MBSSession_Create Request or Nmbsmf_MBSSession_Update Request
message.
\- The SMF interacts with the MB-SMF to obtain the multicast session security
context. The MB-SMF provides the security context in the
Nmbsmf_MBSSession_ContextStatusSubscribe response message and in the
Nmbsmf_MBSSession_ContextStatusNotify request message.
\- If the UE is authorized to join the Multicast MBS session, the SMF shall
provide the multicast session security context to the UE in N1 SM container if
it received the multicast session security context from the MB-SMF.
\- When the MSK needs to be updated, MBSF shall send the updated multicast
session security context to the MB-SMF, and then the MB-SMF shall trigger the
session update as specified in clause 7.2.6 to provide the updated multicast
session security context to the UEs in the related MBS session. The updated
multicast session security context shall contain an updated MSK and may
contain an updated MTK in addition.
NOTE 1: If no MSK but only the MTK is to be updated, the session update
described in the previous bullet is not triggered and the MTK is updated as
defined in TS 33.501 [20].
NOTE 2: Interaction between MBSF and MBSTF will be defined in TS 33.501 [20]
and TS 26.502 [18].
NOTE 3: The additions to the user plane procedure to support the security
function for multicast and broadcast can be used as defined in TS 33.501 [20].
## 6.14 MBS Service Information
MBS Service Information is a set of information used by the AF to describe an
MBS session. It is directly conveyed from the AF to the MB-SMF or indirectly
via NEF and/or MBSF.
In addition, MBS Service Information may be optionally sent from AF/NEF/MBSF
to the PCF based on network configuration.
NOTE: Depending on deployment scenarios specified in Annex A, AF, NEF or MBSF
interacts with MB-SMF, and optionally that AF, NEF or MBSF interacts with PCF.
The MBS Service Information consists of an optional AF Application Identifier,
an optional Session-AMBR and the description of one or more data flows/media
components. For each data flow/media component, the following information may
be provided:
\- Flow description; and
\- one of the following:
\- Media information (Media type, Media format, bandwidth) with optional
Priority indicator;
\- QoS requirements (5G QoS parameters (i.e. 5QI, ARP, GBR, MBR) or QoS
reference).
The following MBS Service Information is mandatory to be supported: 5G QoS
parameters (i.e. 5QI, ARP, GBR, MBR) and optional Session-AMBR for one data
flow/media component. Additional MBS Service Information is optional to be
supported.
## 6.15 Group Message Delivery
Group Message Delivery via MBS Session is a feature that allows an AF to
deliver a payload to a group of UEs located in a particular geographical area
via a broadcast MBS Session, e.g. for Machine-Type communication. The AF may
request to deliver group message and the AF may also request to recall (i.e.
cancel) or replace a previously submitted group message.
Group Message Delivery utilizes the Object Distribution Method in MBSTF
specified in TS 26.502 [18]. The Object Distribution Method can benefit from
Application Layer Forward Error Correction (AL-FEC) to achieve reliable
delivery.
In Group Message Delivery via MBS Session, the NEF is responsible for handling
the group message delivery request from the AF, that is, the NEF transforms
the group message into a file and determines the meta data information of the
file. Over control plane, the NEF provisions Application Service (i.e. MBS
User Service creation and MBS User Data Ingest Session creation as specified
in TS 26.502 [18]), which then triggers the MBS session creation towards 5GC
and NG-RAN. Over user plane, the NEF is responsible for ingesting the file to
the MBSTF, which then delivers the file to the UE(s) via 5GC Shared MBS
traffic delivery.
NOTE: The AF can invoke the Nmbsmf service operations offered by the MB-SMF
(optionally via the NEF) for Transport Only Mode, as supported in Rel-17.
## 6.16 Support of MBS data reception for UEs using power saving functions
MBS provide means to deliver data over MBS Session to multiple UEs at the same
time. However, for UEs using power saving functions, e.g. MICO (Mobile
Initiated Connection Only) mode with Active Time, or extended DRX (Extended
Discontinuous Reception) as defined in clause 5.31.7 of TS 23.501 [5], the UEs
are usually unreachable for long periods of time. Moreover, different UEs are
likely to be reachable at different times.
If a UE becomes unreachable for unicast data transfer due to its using power
saving functions, the UE may still be involved in MBS specific operations,
e.g. activation/deactivation of the MBS service, MBS data transfer reception,
reception of service announcement (if needed).
To receive MBS data, those UEs need to wake up at coordinated times when the
MBS data is to be transmitted. The UE is informed via the service announcement
about a start time and/or a sequence of scheduled activation times (e.g. a
first time and a periodicity) of the MBS Session when the AF may activate the
MBS Session and transmit MBS data, as described in clause 6.11.
The AF may send data starting either at the start time or at any scheduled
activation times. If the AF sends data using an multicast MBS Session at a
scheduled activation time, it shall first activate the multicast MBS Session
at that scheduled activation time.
NOTE: If the UE does not receive paging for multicast MBS session activation
or does not receive MBS data after waking up according to the stored start
time and/or scheduled activation times for pre-configured number of times in
sequence, the UE can transition to CM-CONNECTED state to retrieve the updated
service announcement including start time and/or scheduled activation times
for the MBS session from the AF.
## 6.17 Support of Multicast MBS session data reception in UE with
RRC_INACTIVE state
To provide multicast MBS service to more UEs in a cell, the NG-RAN may decide
to move some UE(s) receiving multicast MBS data from RRC_CONNECTED to
RRC_INACTIVE state if the UE(s) is capable to receiving MBS data in
RRC_INACTIVE state.
The decision in NG-RAN may use the following information provided from 5GC:
\- Existing MBS session QoS parameters, e.g. the most demanding ARP and 5QI of
all MBS QoS Flow within the MBS session.
\- MBS assistance information for the MBS session, the MBS assistance
information for the MBS session is an optional parameter and associated with
one MBS session, which consists of an indication that the UE is preferred to
be kept in connected when the related MBS session that the UE joined is
active. When the NG-RAN node receives this information, the NG-RAN may
determine to keep the UE in RRC_CONNECTED state even if the MBS session data
is supported to be received in RRC_INACTIVE state.
NOTE 1: How the NG-RAN nodes perform those decisions is up to NG-RAN
implementation.
NOTE 2: The \"RRC Inactive Assistance Information\" in clause 5.3.3.2.5 of TS
23.501 [5] is sent by AMF to NG-RAN, whether and how it is used by NG-RAN for
deciding whether to send a UE to RRC_INACTIVE state is decided by NG-RAN.
The MBS session QoS parameters (e.g. ARP and 5QI) are provided to NG-RAN by
the MB-SMF during user plane establishment for shared delivery.
Per the MBS session that the UE joined, the related \"MBS assistance
information for the MBS session\" is provided to NG-RAN by the SMF if the MBS
assistance information is available in the SMF and the MBS session that the UE
joined is included in the MBS assistance information. The SMF gets from the
UDM the \"MBS assistance information\", which is provisioned by the AF via the
NEF to the UDM as part of the MBS subscription data and includes all the MBS
session ID(s), where the UE is preferred to be kept connected when the related
MBS session that the UE joined is active (as specified in clause 6.4). The SMF
provides the \"MBS assistance information for the MBS session\" to the NG-RAN
as part of the associated PDU session information within the N2 SM information
in the procedures where the associated PDU session information need be sent to
NG-RAN node, e.g. PDU Session modification for UE joining, handover procedure.
When an MBS session is to be activated, if there are UE(s) that joined the MBS
session, the 5GC activates the MBS Session in the NG-RANs serving the joined
UE(s). When the NG-RAN triggers the group paging to activate the MBS session
and decides to enable Multicast MBS session data reception for UE with
RRC_INACTIVE state, it also indicates that the MBS session data is allowed to
be received in RRC_INACTIVE state. Hence the joined UEs in RRC_INACTIVE state
in the cells, where the delivered MBS session is allowed to be received in
RRC_INACTIVE state, may be able to stay in RRC_INACTIVE state and receive MBS
Session data.
When an UE in RRC_INACTIVE state is receiving ongoing MBS session data, if the
UE moves to a new cell within the RNA, or if the UE moves outside the current
RNA but within the current Registration Area, or if the UE moves out of the
current Registration Area, the UE should be able to receive the MBS session
data if applicable in the new area.
NOTE 3: The scenario of the UE moving to a new cell within the RAN
Notification Area is specified in RAN specifications.
## 6.18 Resource sharing across broadcast MBS Sessions during network sharing
In network sharing scenario as specified in clause 5.18 of TS 23.501 [5], the
same MBS broadcast service may be delivered via multiple operators\' CN
participating in the network sharing to a shared NG-RAN, and the shared NG-RAN
nodes may broadcast the MBS data only once for resource efficiency.
When the AF creates multiple broadcast MBS sessions via multiple CNs to
deliver the same content, the shared NG-RAN allocates radio resource for one
of broadcast MBS Sessions instead of allocating radio resource for all the
broadcast MBS Sessions.
NOTE 1: The same QoS requirements are assumed to be provided by the AF for the
broadcast MBS Sessions via multiple CNs delivering the same content.
The NG-RAN determines the broadcast MBS sessions delivering the same content
in one of the following ways:
\- Based on the Associated Session ID (see clause 6.5.5) provided by the AF to
the NG-RAN via 5GCs when creating broadcast MBS sessions.
\- Based on the association of MBS session identifiers (i.e. TMGIs) configured
in NG-RAN, the shared NG-RAN nodes can determine that the multiple broadcast
MBS sessions are transmitting the same content for the same MBS service. For
the location dependent MBS session, the existing MBS session identifiers are
used to identify multiple broadcast MBS Sessions via different CNs delivering
the same content. The MB-SMF should be able to accept MBS session creation
with TMGIs without prior allocation of those TMGIs.
For a location dependent MBS session (see Clauses 6.2.3), the AF(s) that
create the location dependent MBS sessions towards the participating PLMNs
shall supply MBS Service Areas mapped to the same shared radio cells (but that
may also be mapped to different non-shared radio cells).
For location dependent broadcast services, the shared NG-RAN is required to
determine that the multiple broadcast MBS Sessions via different CNs deliver
the same content for location-dependent MBS session with additionally
considering the MBS Service Area.
NOTE 2: When the association of MBS session identifiers is configured in NG-
RAN, there is no requirement on the AF to provide an Associated Session ID.
NOTE 3: The AFs are configured with TMGIs that are mapped to each other in NG-
RAN, and the MB-SMF includes those TMGIs in the NF profile it registers at the
NRF, and does not allocate those TMGIs to other MBS services.
Illustrated in Figure 6.18-1 is an example that the AF creates broadcast MBS
Sessions via 5GC Operators A, B and C respectively to deliver the same content
and N3mb unicast transport is used from 5GC to the NG-RAN. Based on operator
policy in the NG-RAN node, the N3mb tunnel may be established from the 5GC of
only one operator (i.e., Operator A in Figure 6.18-1) to the shared NG-RAN, or
the N3mb tunnels may be established from the 5GCs of all the operators to the
shared NG-RAN. Over the Uu interface, the NG-RAN allocates radio resource for
only one of the established broadcast MBS Sessions regardless of the number of
N3mb tunnels established to deliver the MBS packets.
Figure 6.18-1: Example of Resource sharing across multiple broadcast MBS
Sessions via different CNs to deliver the same content during network sharing
# 7 MBS procedures
## 7.1 Common procedure for Multicast and Broadcast
### 7.1.1 MBS Session Management
#### 7.1.1.1 General
The call flows in clause 7.1.1 and clause 7.3 show a \"NEF/MBSF\", but as
detailed in Annex A, there can be different related network deployment
involving either only NEF, or MBSF, or both.
The interactions between \"NEF/MBSF\" and MB-SMF, PCF, BSF and NRF depicted in
the call flows apply for NEF, MBSF or a combined NEF and MBSF, depending on
network deployment. They may also apply for an AF in the trusted domain where
NEF is not mandated.
However, the interactions between AF and \"NEF/MBSF\" depicted in the call
flows only apply for the NEF.
Interactions between AF and MBSF based on the MB2 interface follow TS 23.468
[10] (see Annex C).
Interactions between AF and MBSF based on the xMB interface follow TS 26.348
[11] (see Annex C).
Services offered by the MBSF and related interactions based on that service
between MBSF and AF or NEF (if MBSF and NEF are split as shown in
configuration 2) are specified in TS 26.502 [18].
Detailed interactions between the MBSF or NEF and the MBSTF are specified in
TS 26.502 [18].
#### 7.1.1.2 MBS Session Creation without PCC
This procedure is used by the AF to start the MBS Session towards 5GC and
consist of TMGI allocation, and MBS session creation, and they apply to both
multicast and broadcast communications unless otherwise stated.
For multicast, MBS session establishment procedure triggered by UE join
requests may follow the MBS session creation procedure to reserve resources
towards NG-RAN. For broadcast, the MBS session start procedure to reserve
resources towards NG-RAN is triggered by the MBS session creation procedure.
For both broadcast and multicast communication, the TMGI allocation may be
separated from the MBS Session creation request.
For multicast communication, TMGI allocation procedure is applicable if TMGI
is used as MBS Session ID.
Figure 7.1.1.2-1: MBS Session Creation without PCC
Steps 1 to 6 are optional and only applicable if TMGI is used as MBS Session
ID and required to be pre-allocated.
1\. AF sends Nnef_MBSTMGI_Allocate Request (TMGI number, [MBS service area])
message to NEF/MBSF to request allocation of a TMGI(s) to identify new MBS
session(s). The MBS service area indicates the possible service area for those
TMGI(s) to be allocated, which may be needed for local MBS.
NOTE 1: Depending on the network deployment and use case, MB-SMF may receive
requests from AF directly, or via NEF, or via MBSF, or via NEF and MBSF.
2\. NEF/MBSF checks authorization of AF. If geographical area information or
civic address information was provided by the AF as MBS service area, NEF/MBSF
performs the translation.
NOTE 2: NEF is not required if AF is in trusted domain.
3\. NEF/MBSF discovers and selects an MB-SMF using NRF or based on local
configuration, possibly based on MBS service area.
4\. NEF/MBSF sends an Nmbsmf_TMGI_Allocate Request (TMGI number) message to
the MB-SMF.
5\. MB-SMF allocates TMGI(s) and returns the TMGI(s) to the NEF/MBSF via the
Nmbsmf_TMGI_Allocate response (TMGI(s), expiration time).
6\. The NEF or MBSF responds to the AF by sending an Nnef_MBSTMGI_Allocate
Response (TMGI(s), expiration time).
7\. The AF may perform a Service Announcement towards UEs. The AF informs UEs
about MBS Session information with MBS Session ID, e.g. TMGI, SSM, and
possibly other information e.g. MBS service area, session description
information, etc.
The MBS service area information can be Cell ID list, TAI list, geographical
area information or civic address information. Amongst them, Cell ID list and
TAI list shall only be used by AFs who reside in trust domain, and when the
AFs are aware of such information.
The UE needs to be aware if the service is broadcast or multicast to decide if
JOIN is to be performed.
8\. AF of content provider may provide description for an MBS session
(possibly providing information for a previously allocated TMGI to NEF via a
Nnef_MBSSession_Create request ([MBS Session ID], MBS service type, MBS
Service Information, [TMGI allocation request], [MBS service area], [Any UE
indication], [start and end time of the MBS session], [MBS session state],
[ingress transport address request indication], [Request for location-
dependent session], [FSA ID(s)], [Associated Session Identifier]). If step 1-6
has not been executed before, the AF may provide an MBS Session ID containing
an SSM or it may request that the network allocates an MBS Session ID (i.e.,
TMGI). The AF provides the MBS service type (i.e. either multicast service or
broadcast service) and MBS Service Information (as defined in clause 6.14).
The AF may provide the \"Any UE indication\" (indicating whether a multicast
MBS session is \"open to any UEs\"), MBS service area, start and end time of
the MBS session and MBS session state (active/inactive). In addition, the AF
request may also indicate that the allocation of an ingress transport address
is requested and that the AF request is for a location dependent MBS service.
If geographical area information or civic address information was provided by
the AF as MBS service area, NEF/MBSF translates the MBS service area to Cell
ID list or TAI list.
For broadcast communication, the AF may determine MBS FSA ID(s) for the
Broadcast MBS session based on business agreements and include them in the
description of the MBS session.
For broadcast communication, to support resource sharing across MBS Sessions
during network sharing (see clause 6.17), the AF may include Associated
Session Identifier in this step to enable NG-RAN to identify the broadcast MBS
sessions from multiple CNs delivering the same content.
NOTE 3: The same QoS requirements are assumed to be provided by the AF for the
broadcast MBS Sessions via multiple CNs delivering the same content.
NOTE 4: MBS session state is applicable for multicast MBS Session.
9\. NEF/MBSF checks authorization of content provider.
10\. NEF/MBSF discovers MB-SMF candidates and selects MB-SMF as ingress
control node, possibly based on MBS service area. If a TMGI is included in
step 8, NEF/MBSF finds MB-SMF based on that TMGI.
11\. NEF/MBSF sends Nmbsmf_MBSSession_Create Request ([MBS Session ID], MBS
service type, [TMGI allocation request], MBS Service Information (as defined
in clause 6.14), [MBS service area], [Any UE indication], [start and end time
of the MBS session], [MBS session state], [ingress transport address request
indication], [FSA ID(s)], [Associated Session Identifier], [multicast session
security context]) to MB-SMF, to request MB-SMF to reserve ingress resources
for a MBS distribution session. The NEF/MBSF forwards all parameters it has
received from the AF in step 8. If the MBSF decides to insert an MBSTF into
the user plane for the MBS session, it also indicates that the allocation of
an ingress transport address is requested even if this was not requested in
step 8. The request also includes the Any UE indication if provided in step 8.
If the MBSF acts as the MBS security function for multicast as defined in TS
33.501 [20], it provides a multicast session security context for the MBS
session.
If requested to do so, or if a source specific multicast is provided as MBS
Session ID in step 11, the MB-SMF allocates a TMGI.
For broadcast communication, if no MBS FSA ID(s) have been received, the MB-
SMF selects MBS FSA ID(s) for the Broadcast MBS session based on local
configuration.
12\. Void.
13\. The MB-SMF derives the required QoS parameters locally based on the MBS
Service Information.
14\. MB-SMF selects the MB-UPF. If the allocation of an ingress transport
address was requested in step 11, the MB-SMF requests the MB-UPF to reserve
user plane ingress resources. If multicast transport of the MBS data towards
RAN nodes is to be used, the MB-SMF also request the MB-UPF to reserve for the
outgoing data a tunnel endpoint and the related identifiers (source IP
address, SSM and GTP Tunnel ID) and to forward data received at the user plane
ingress resource using that tunnel endpoint.
If the allocation of an ingress transport address was not requested in step
11, the MB-SMF provides the SSM received as MBS Session ID to the MB-UPF and
requests the MB-UPF to join the corresponding multicast tree from the content
provider. The MB-SMF may also defer the configuration to join the
corresponding multicast tree e.g. based on information that the session is
inactive, service requirements and MBS start/end time until receiving the
first query for the MBS session as part of the establishment procedure in
clause 7.2.1.3, or until receiving a request to activate the MBS session via
the MBS Session Update procedure in clause 7.1.1.6.
15\. If requested, MB-UPF selects an ingress address (IP address and port) and
a tunnel endpoint for the outgoing data and provides it to MB-SMF.
16\. MB-SMF indicates the possibly allocated ingress address to the NEF/MBSF.
MB-SMF may include TMGI if it is allocated in step 11. For broadcast
communication, the MB-SMF includes any MBS FSA ID(s) selected in step 11.
16a. If a source specific multicast address is provided as MBS Session ID in
step 11, the MB-SMF updates its NF profile at the NRF with the serving MBS
Session ID. If an MBS service area was received in step 11, the MB-SMF updates
its NF profile at the NRF with that information.
NOTE 5: If TMGI is used to represent an MBS Session, MB-SMF does not need to
update NRF if the TMGI range(s) supported by an MB-SMF is already included in
the MB-SMF profile when MB-SMF register itself into NRF.
17\. For broadcast communication, the MB-SMF continues the procedure towards
the AMF and NG-RAN as specified in clause 7.3.1 to request the allocation of
resources to for the transmission of the broadcast session.
18\. [Optional] If the MBSF decides to use an MBSTF, the NEF/MBSF provides the
ingress address received in step 16 towards the MBSTF as DL destination. If
the allocation of an ingress transport address was requested in step 8, the
MBSF requests the MBSTF to allocate the user plane ingress resources. If the
allocation of an ingress transport address was not requested in step 8, the
MBSF provides the SSM received as Multicast session ID in step 8 and requests
the MBSTF to join the corresponding multicast tree from the content provider.
19\. [Conditional on step 19] If requested, the MBSTF selects an ingress
address (IP address and port) and provides it to NEF/MBSF.
20\. The NEF/MBSF indicates the possibly allocated ingress address and other
parameters (e.g. TMGI) to the AF via an Nnef_MBSSession_Create response
([TMGI], [Allocated ingress address])). If MBS Session ID is not provided in
step 8, or the MBS Session ID is SSM, the NEF/MBSF provides the allocated
TMGI. If AF requested the allocation of an ingress transport address, the
message also includes the allocated ingress address. For broadcast
communication, the message also includes any MBS FSA ID(s) received in step
17.
21\. Same as step 7. The AF may also perform a service announcement at this
stage.
22\. For multicast communication, depending on configuration UEs can join the
MBS Session as specified in clause 7.2.1.
#### 7.1.1.3 MBS Session Creation with PCC
Deployment of dynamic PCC is optional. This clause describes the procedure
when dynamic PCC is deployed.
Figure 7.1.1.3-1: MBS Session Creation with PCC
Steps 1 to 7 are optional and only applicable if TMGI is used as MBS Session
ID and required to be pre-allocated.
1 to 9: Same as in Figure 7.1.1.2-1.
10\. The NEF/MBSF may optionally, based on local configuration, decide to
interact with the PCF.
NOTE 1: In the deployment without NEF and MBSF, the AF optionally interacts
with PCF in steps 11-18.
If the NEF/MBSF decided to interact with the PCF, steps 11 to 19 are
performed, and in step 20 the MBS Service Information is not provided to the
MB-SMF.
If the NEF/MBSF decided not to interact with the PCF, steps 12 to 19 are
skipped, and in step 20 the MBS Service Information is provided to the MB-SMF.
11\. [Conditional] If the NEF/MBSF did not receive an MBS Session ID from the
AF in step 8, the NEF/MBSF sends an Nmbsmf_TMGI_Allocate Request (1) message
to the MB-SMF and the MB-SMF allocates a TMGI and returns the TMGI to the
NEF/MBSF via the Nmbsmf_TMGI_Allocate response (TMGI, expiration time).
12\. [Conditional] If the NEF/MBSF receives the Request for location-dependent
session from the AF and if there is a need to select the same PCF for the
location dependent MBS Sessions, the NEF/MBSF first uses the BSF Discovery
service to discover whether there is a PCF serving the MBS session with the
MBS Session ID by using Nbsf_management_Discovery operation. If there is a PCF
registered for the MBS Session ID, the NEF/MBSF interacts with that PCF and
skips the following step 13.
NOTE 2: This step is not necessary in a deployment with a single PCF.
13\. [Conditional] If step 12 was not executed or the interaction with the BSF
revealed that no PCF is registered for the MBS Session ID, the NEF/MBSF
discovers the PCF candidates by interacting with the NRF and selects a PCF,
possibly based on MBS service area.
14\. The NEF/MBSF sends an Npcf_MBSPolicy_Authorization_Create Request (MBS
Session ID, MBS Service Information (as defined in clause 6.14)) to the PCF.
15\. [Optional] The PCF may retrieve authorization information for the MBS
session from the UDR (see clause 6.10.2) and takes it into account for the
subsequent authorization and QoS allowance check.
NOTE 3: This step is not necessary in a deployment with a single PCF if
authorization data are stored in the PCF.
16\. The PCF determines whether the request is authorized and if the request
is authorized, the PCF derives the required QoS parameters based on the
received MBS Service Information and determines whether this QoS is allowed.
If the required QoS is allowed, the PCF generates the policy information for
the MBS session (as defined in clause 6.10) and stores it together with the
MBS Session ID.
17\. If the request is authorized and the required QoS is allowed, the PCF
registers at the BSF that it handles the MBS session by using
Nbsf_management_Register Request (MBS Session ID, PCF ID). It provides an
identifier that the policy association is for MBS and the MBS Session ID, its
own PCF ID and optionally its PCF set ID.
NOTE 4: This step is not necessary in a deployment with a single PCF.
18\. The PCF sends an Npcf_MBSPolicy_Authorization_Create Response (Result
indication) to the NEF/MBSF.
If the request is not authorized or the required QoS is not allowed, the PCF
indicates so in the response to the NEF/MBSF which in turn informs the AF
about it (by sending the Nnef_MBSSession_Create Response) and ends this
procedure.
19\. Same as step 10 in Figure 7.1.1.2-1.
20\. Same as step 11 in Figure 7.1.1.2-1 with the difference that the MBS
Service Information is not present if the optional interaction between
AF/NEF/MBSF and PCF has been performed (as the MBS Service Information was
provided to the PCF in step 14).
21\. The MB-SMF discovers the PCF using NRF.
22\. The MB-SMF sends an Npcf_MBSPolicyControl_Create Request (MBS Session ID,
[MBS Service Information (as defined in clause 6.14)]) for the MBS session
towards the PCF. The MB-SMF forwards the MBS Service Information to the PCF if
received from the NEF/MBSF in the previous step 20.
If PCF receives MBS Service Information from the MB-SMF, the PCF performs the
subsequent steps 23 to 26. If the PCF does not receive MBS Service Information
from the MB-SMF, but has previously determined policy information for the MBS
session (see step 16) corresponding to the MBS Session ID received from the
MB-SMF, the PCF continues with step 27.
23\. If the PCF is not handling the MBS Session ID, the PCF uses the BSF
Register service to check whether there is already a PCF serving the MBS
session. If so, the PCF skips steps 24 to 26 and indicates in step 27 that the
PCF serving the MBS session shall be contacted.
NOTE 5: This step is not necessary in a deployment with a single PCF.
24\. [Optional] The PCF may retrieve authorization information for the MBS
session from the UDR (see clause 6.10.2) and takes it into account for the
subsequent authorization and QoS allowance check.
NOTE 6: This step is not necessary if authorization data are stored in the
PCF.
25\. The PCF determines whether the request is authorized and if the request
is authorized, the PCF derives the required QoS parameters based on the
received MBS Service Information and determines whether this QoS is allowed.
If the required QoS is allowed, the PCF generates the policy information for
the MBS session (as defined in clause 6.10) and stores it together with the
MBS Session ID.
26\. If the request is authorized and the required QoS is allowed the PCF
registers at the BSF that it handles the MBS session by using
Nbsf_management_Register Request (MBS Session ID, PCF ID). It provides an
identifier that the policy association is for MBS and the MBS Session ID, its
own PCF ID and optionally its PCF set ID.
NOTE 7: This step is not necessary in a deployment with a single PCF.
27\. The PCF responds with Npcf_MBSPolicyControl_Create Response ([policy
information for the MBS session (as defined in clause 6.10)], Result
indication).
If the request is not authorized or the required QoS is not allowed, the PCF
indicates so in the response to the MB-SMF which in turn informs the AF about
it (by sending the Nmbsmf_MBSSession_Create Response) and ends this procedure.
If another PCF is serving the MBS session, the PCF indicates that another PCF
serving the MBS session shall be contacted and provides an ID of that other
PCF. The MB-SMF then repeats step 22 towards that other PCF.
28-37: Same as steps 14-22 in Figure 7.1.1.2-1.
NOTE 8: Steps 33-36 can be executed in parallel to step 32.
#### 7.1.1.4 MBS Session Deletion without PCC
This procedure is used by the AF to delete the MBS Session. This procedure may
also include TMGI de-allocation. The procedures apply to both multicast and
broadcast communications unless otherwise stated. This procedure releases the
reserved resources in both 5GC and NG-RAN.
Figure 7.1.1.4-1: MBS Session Deletion without PCC
1\. AF of content provider may request to delete the MBS session (MBS Session
ID).
2/3. If an MBSTF was inserted into the user plane, the MBSF request the MBSTF
to release user plane resources.
4\. NEF/MBSF requests MB-SMF to delete resources for the MBS session.
5\. For Broadcast MBS session, the MB-SMF triggers resource release towards
the AMFs as specified in clause 7.3.2. For Multicast MBS session, the MB-SMF
triggers resource release towards the SMFs as specified in clause 7.2.2.3.
6/7. MB-SMF requests the MB-UPF to release user plane resources.
8\. [Conditional] If MB-SMF configured the profile with an MBS Session ID when
the MBS session was created, the MB-SMF updates its NF profile at NRF to
release the MBS Session ID.
9\. MB-SMF responds to the NEF/MBSF.
10\. The NEF/MBSF responds to the AF.
11\. [Optional] AF requests NEF/MBSF to de-allocate TMGI(s),
12\. [Conditional on step 11] NEF/MBSF forwards request to de-allocate TMGI(s)
to MB-SMF.
13\. [Conditional on step 12] The MB-SMF responds to the NEF or MBSF by
sending a de-allocate TMGI Response message.
14\. [Conditional on step 13] NEF or MBSF forwards de-allocate TMGI Response
message to AF.
#### 7.1.1.5 MBS Session Deletion with PCC
This procedure is used by the AF to release the MBS Session. This procedure
may also include TMGI de-allocation. The procedures apply to both multicast
and broadcast communications unless otherwise stated. This procedure releases
the reserved resources in both 5GC and NG-RAN.
Figure 7.1.1.5-1: MBS Session Deletion with PCC
1-3. Same as in Figure 7.1.1.4-1.
For the interaction with the PCF in this procedure, the NEF/MBSF applies the
same decision that was taken in step 10 in Figure 7.1.1.3-1 during the MBS
Session Creation with PCC procedure:
If the NEF/MBSF decided to interact with the PCF, steps 4 to 5 are performed.
If the NEF/MBSF decided not to interact with the PCF, steps 4 to 5 are
skipped.
NOTE 1: If NEF and MBSF is not deployed, the AF optionally interacts with PCF
in steps 4 to 5.
4\. The NEF/MBSF sends an Npcf_MBSPolicyAuthorization_Delete Request to the
PCF that handles the MBS Session.
5\. The PCF sends an Npcf_MBSPolicyAuthorization_Delete Response to the
NEF/MBSF.
6\. Same as step 4 in Figure 7.1.1.4-1.
7\. The MB-SMF sends the Npcf_MBSPolicyControl_Delete Request to request the
deletion of the SM Policy Association with the PCF.
8\. The PCF sends the Npcf_MBSPolicyControl_Delete Response to the MB-SMF.
9\. The PCF de-registers at the BSF that it handles the MBS session.
10-19. Same as steps 5-14 in Figure 7.1.1.4-1.
#### 7.1.1.6 MBS Session Update without PCC
This procedure is used by the AF to update the MBS service area and/or MBS
Service Information. Updating MBS Service Information may lead to addition of
new MBS QoS Flow(s), removal of existing MBS QoS Flow(s) or update of existing
MBS QoS Flow(s). The procedure applies to both multicast and broadcast
communications unless otherwise stated.
If the MBSF acts as the MBS security function for multicast as defined in TS
33.501 [20], it may use this procedure to provide an MSK for the MBS session
via the control plane. In this case the MBSF may initiate this procedure and
steps 1, 2 and 10 do not apply.
NOTE: The procedure is not applicable if no MSK but only the MTK is to be
updated.
For local multicast services and location dependent multicast services, the AF
may perform a Service Announcement towards UEs to update the MBS service area
before the MBS Session Update procedure is started or after the MBS Session
Update procedure is completed.
Figure 7.1.1.6-1: MBS Session Update without PCC
1\. AF of content provider initiates MBS Session Update to a NEF/MBSF, e.g. to
update MBS service area and/or update MBS Service Information (as defined in
clause 6.14), or to activate or deactivate an MBS session. AF may provide
updated information for an MBS session (identified by MBS session ID) by
sending an Nnef_MBSSession_Update Request (MBS Session ID, [MBS Service
Information], [MBS service area], [MBS session state (active/inactive)]).
If geographical area information or civic address information was provided by
the AF as MBS service area, NEF/MBSF translates the MBS service area to Cell
ID list or TAI list.
2\. NEF checks authorization of AF.
3\. NEF/MBSF sends Nmbsmf_MBSSession_Update Request to MB-SMF forwarding the
updated information received from the AF in step 1. If the MBSF acts as the
MBS security function for multicast as defined in TS 33.501 [20], it may
provide an updated multicast session security context for the MBS session in
the Nmbsmf_MBSSession_Update Request.
4\. The MB-SMF derives any updated QoS parameters locally under consideration
of the updated MBS Service Information. This may lead to addition of new MBS
QoS Flow(s), removal of existing MBS QoS Flow(s) or update of existing MBS QoS
Flow(s).
5-6. MB-SMF may need to update MB-UPF, e.g. if new MBS QoS Flow is to be
created, or existing MBS QoS Flow is to be deleted.
7\. For broadcast communication, the MB-SMF continues the procedure towards
the AMF and NG-RAN as specified in clause 7.3.3. For multicast communication,
the MB-SMF continues the procedure towards the AMF and NG-RAN as specified in
clause 7.2.5 (for service activation/deactivation), 7.2.6 (for QoS updates and
service area updates).
8\. If an MBS service area is being updated, the MB-SMF stores the new service
area in its profile at the NRF.
9\. MB-SMF responds to the NEF/MBSF with a Nmbsmf_MBSSession_Update Response.
10\. NEF/MBSF responds to the AF with a Nnef_MBSSession_Update Response.
#### 7.1.1.7 MBS Session Update with PCC
For local multicast services and location dependent multicast services, the AF
may perform a Service Announcement towards UEs to update the MBS service area
before the MBS Session Update procedure is started or after the MBS Session
Update procedure is completed.
Figure 7.1.1.7-1: MBS Session Update with PCC
1-2. Same as in Figure 7.1.1.6-1.
3\. For the interaction with the PCF in this procedure, the NEF/MBSF applies
the same decision that was taken in step 10 in Figure 7.1.1.3-1 during the MBS
Session Creation with PCC procedure unless the MBS session update only relates
to an activation or deactivation of the MBS session and/or an MBS service area
update and thus no PCF interactions are required.
If the NEF/MBSF decided to interact with the PCF, steps 4 to 6 are performed
and in step 7 an indication that the PCF has to be contacted is provided, and
MBS Service Information is not provided to the MB-SMF.
If the NEF/MBSF decided not to interact with the PCF, steps 4 to 6 are skipped
and MBS Service Information is provided to the MB-SMF in step 7.
NOTE 1: In the deployment without NEF and MBSF, the AF optionally interacts
with PCF in steps 4 - 6.
4\. NEF/MBSF sends an Npcf_MBSPolicy_Authorization_Update Request (application
session context, [MBS Service Information]) to the PCF forwarding the updated
information received from the AF in step 1.
5\. The PCF determines whether the update is authorized and if the update is
authorized, the PCF derives the update for the QoS parameters based on the
received MBS Service Information and determines whether this new QoS is
allowed. If the new QoS is allowed, the PCF updates the policy information for
the MBS session (as defined in clause 6.10) accordingly. If the policy
information for the MBS session has changed, the PCF shall provide an
indication that the PCF has to be contacted.
6\. The PCF sends an Npcf_MBSPolicy_Authorization_Update Response (Result
indication, [indication that the PCF has to be contacted]) to the NEF/MBSF.
If the update is not authorized or the new QoS is not allowed, the PCF
indicates so in the response to the NEF/MBSF which in turn informs the AF
about it (by sending the Nnef_MBSSession_Update Response) and ends this
procedure.
7\. The NEF/MBSF sends Nmbsmf_MBSSession_Update Request to the MB-SMF
forwarding the updated information received from the AF in step 1. If the
NEF/MBSF has decided not to interact with the PCF, the NEF/MBSF send the
indication that the PCF has to be contacted, in addition.
If the NEF/MBSF has decided to interact with the PCF and thus provided the
updated MBS Service Information to the PCF in step 4, the updated MBS Service
Information is not forwarded. The NEF/MBSF forwards the indication that the
PCF has to be contacted, if received from the PCF.
8\. If the MB-SMF does not receive the indication that the PCF has to be
contacted, the MB-SMF decides whether to interact with the PCF. If it decides
not to interact with the PCF, it continues with step 11. Otherwise, the MB-SMF
sends an Npcf_MBSPolicyControl_Update Request (MBS Policy Association ID, [MBS
Service Information]) for the MBS session towards the PCF. The MB-SMF forwards
the MBS Service Information to the PCF if received from the NEF/MBSF in the
previous step 7.
If PCF receives MBS Service Information from the MB-SMF, the PCF performs the
subsequent step 9. If the PCF does not receive MBS Service Information from
the MB-SMF, the PCF identifies any updated policy information for the MBS
session (as defined in clause 6.10) corresponding to the MBS Session ID
received from the MB-SMF and continues with step 10.
9\. The PCF determines whether the update is authorized and if the update is
authorized, the PCF derives the update for the QoS parameters based on the
received MBS Service Information and determines whether this new QoS is
allowed. If the new QoS is allowed, the PCF updates the policy information for
the MBS session (as defined in clause 6.10) accordingly.
10\. The PCF responds with Npcf_MBSPolicyControl_Update Response ([updated
policy information for the MBS session], Result indication).
If the request is not authorized or the required QoS is not allowed, the PCF
indicates so in the response to the MB-SMF which in turn informs the AF about
it (by sending the Nmbsmf_MBSSession_Update Response) and ends this procedure.
11.-16. Same as steps 5-10 in Figure 7.1.1.6-1.
### 7.1.2 MB-SMF discovery and selection for multicast/broadcast session
To facilitate the MB-SMF discovery/selection for one multicast/broadcast MBS
session, the following mechanism is used:
\- The MB-SMF registers its capability related to Multicast/Broadcast Service
session management (e.g. S-NSSAI(s) and the associated NSI ID(s) (if
available), DNN(s), TMGI range, service area) as part of its profile to the
NRF by invoking Nnrf_NFManagement_NFRegister. In addition, when a Multicast
MBS session is created and the MBS Session ID is not yet included in the MB-
SMF profile, the MB-SMF updates its profile towards the NRF with the MB
Session ID (i.e. TMGI or source specific IP multicast address).
NOTE: The operator can preconfigure MB-SMF for specific source IP multicast
address range or TMGI range.
\- When the UE joins the multicast MBS session via PDU session modification
procedures, the SMF serving the PDU session invokes the
Nnrf_NFDiscovery_Request Request including the MBS Session ID for multicast
provided by the UE and optionally other information, i.e. the S-NSSAI and the
associated NSI ID (if available), DNN, etc. to query the NRF for MB-SMF
information. Based on the MBS Session ID and other information for query, the
NRF decides whether an MB-SMF serving the MBS session exists (i.e. the NRF
decides whether the requested MBS Session ID is in the profile of an MB-SMF,
as defined in clause 7.1.1.2 or clause 7.1.1.3 or preconfigured by the
operator). If so, the NRF provides in Nnrf_NFDiscovery_Request Response the
information of the MB-SMF currently serving the MBS session. The SMF serving
the PDU session selects the MB-SMF currently serving the multicast MBS
session, based on the MB-SMF information provided by the NRF. For local MBS
services, the SMF takes MB-SMF service area, UE location into account when
selecting the MB-SMF. If no MB-SMF serving the Multicast MBS session exists,
the NRF does not provide MB-SMF profiles in the response message to the SMF as
defined in TS 29.510 [19].
\- When the shared tunnel for shared delivery is established as described in
clause 7.2.1.4, the AMF may invoke the Nnrf_NFDiscovery_Request Request
including MBS Session ID and Area Session ID (if received from the NG-RAN), to
query the NRF for the MB-SMF information. In this case, based on the MBS
Session ID and Area Session ID, the NRF provides in Nnrf_NFDiscovery_Request
Response the MB-SMF information currently serving the MBS session and the Area
Session ID.
\- When the Multicast MBS Session Context is deleted from the MB-SMF, e.g. due
to MBS session release, the MB-SMF updates its profile towards the NRF (i.e.
removing the MBS Session ID which is no longer served by the MB-SMF), if the
MB-SMF performed NRF registration at multicast MBS Session Creation.
\- During MBS session information provisioning procedures defined in clause
7.1.1.2, unless the MB-SMF information is available by other means, e.g.
locally configured in the NEF/MBSF/AF, the NEF/MBSF/AF queries the NRF with
information of the Multicast/Broadcast Service session (as specified in clause
5.3.2.15.1) and selects the MB-SMF(s) based on the MB-SMF information provided
by the NRF. For local MBS services, the NEF/MBSF/AF takes MB-SMF service area
into account when selecting the MB-SMF(s).
### 7.1.3 MB-UPF discovery and selection for multicast/broadcast session
The selection and reselection of the MB-UPF are performed by the MB-SMF by
considering MB-UPF deployment. For the local Broadcast/Multicast MBS session
and location dependent MBS session, the service area is taken into
consideration for MB-UPF selection.
MB-SMF may be locally configured with the information about the available MB-
UPFs, e.g. by OA&M system when MB-UPF is instantiated or removed.
The MB-UPF selection functionality in the MB-SMF may optionally utilize the
NRF to discover MB-UPF instance(s) which is similar with UPF selection with
NRF defined in the TS 23.501 [5] clause 6.3.3.2.
## 7.2 MBS procedures for multicast Session
### 7.2.1 MBS join and Session establishment procedure
#### 7.2.1.1 General
MBS Session Join procedure is used by UEs to inform the 5GC of the UE interest
in joining a multicast MBS session. The first accepted UE join request will
trigger the multicast MBS session establishment towards the NG-RAN and the UE.
#### 7.2.1.2 Establishment of a PDU Session that can be associated with
multicast session(s)
The PDU Session associated with Multicast MBS session(s) (i.e. the associated
PDU Session) is established using the procedures as specified in TS 23.502 [6]
clause 4.3.2.2 with the following differences:
NOTE 1: The DNN and S-NSSAI are used to establish the PDU session which can
carry the operations related to Multicast MBS session(s), i.e. session
join/leave, and can be associated with multicast MBS session(s).
\- In step 2, the AMF selects an SMF capable of handling Multicast MBS
sessions based on DNN and S-NSSAI, locally configured data or a corresponding
SMF profile stored in the NRF. For indirect discovery, the AMF requests the
SCP to select an SMF capable of handling Multicast MBS sessions.
\- In step 4, if MBS subscription data for the UE (i.e. corresponding SUPI),
DNN and S-NSSAI of the HPLMN or subscribed SNPN is not available, the SMF
retrieves the MBS subscription data using Nudm_SDM_Get (SUPI, MBS subscription
data, selected DNN, S-NSSAI of the HPLMN or subscribed SNPN, Serving PLMN ID
(or PLMN ID and NID)) and subscribes to be notified when this subscription
data is modified using Nudm_SDM_Subscribe (SUPI, MBS subscription data,
selected DNN, S-NSSAI of the HPLMN or SNPN, Serving PLMN ID (or PLMN ID and
NID)). UDM may get this information from UDR by Nudr_DM_Query (SUPI, MBS data,
selected DNN, S-NSSAI of the HPLMN or subscribed SNPN, Serving PLMN ID (or
PLMN ID and NID)) and may subscribe to notifications from UDR for the same
data by Nudr_DM_subscribe. The MBS subscription data can also be retrieved
along with the Session Management Subscription data, i.e. with additional
input parameter for MBS subscription data in the Nudm_SDM services.
NOTE 2: In this release, roaming is not supported, i.e. HPLMN and Serving PLMN
are the same and subscribed SNPN and serving SNPN are same.
#### 7.2.1.3 Multicast session join and session establishment procedure
The following steps are executed before the UE requests to join the MBS
session:
\- The MBS Session may have been created in the 5GC (see clause 7.1.1 for
details).
\- The UE registers in the PLMN or SNPN and may have established a PDU session
that can be associated with multicast session(s).
\- The UE has known at least the MBS Session ID of a multicast group that the
UE can join, e.g. via service announcement.
Figure 7.2.1.3-1: PDU Session modification for UE joining Multicast MBS
session
1\. To join a multicast group:
\- if there is an existing PDU session that can be used to send the UE join
request for the multicast MBS Session, the UE sends a PDU Session Modification
Request over that PDU session (i.e. associated PDU Session) which additionally
contains one or several MBS Session ID(s) and join request. The MBS Session
ID(s) indicate the multicast MBS session(s) that UE wants to join.
\- if the UE has no appropriate PDU session established with the DNN and
S-NSSAI for the multicast MBS session, the UE joins the multicast MBS session
by sending PDU Session Establishment Request for associated PDU session
together with one or several MBS Session ID(s) and join request. In that case,
before step 2, the network proceeds with establishment of the associated PDU
session executing steps 4 to 10 of PDU Session Establishment procedure as
specified in TS 23.502 [6] clause 4.3.2.2.
NOTE 1: To avoid that join requests at the MBS session start time are rejected
due to many UEs joining at the same time, UEs can send join requests already
before the MBS session start time if provided in service announcement as
specified in clause 6.11.
2\. [Conditional] Based on the received MBS Session ID and join request, the
SMF determines this is MBS Session join request.
If SMF has no information about MBS Session Context for the indicated MBS
Session ID(s), SMF discovers and selects an MB-SMF for the MBS Session via the
NRF as described in clause 7.1.2. If no MB-SMF is assigned for the MBS Session
ID (i.e. the NRF provides empty MB-SMF profile), the SMF may select an MB-SMF
and request it to configure the multicast MBS session or the SMF may reject
the join request and respond to the UE with an appropriate cause value.
NOTE 2: Details about how the SMF selects an MB-SMF and requests it to
configure the multicast MBS session are left to SMF implementation.
3\. [Conditional] For each MBS session in step 1, if the SMF has not
subscribed to the MBS Session Context, it invokes
Nmbsmf_MBSSession_ContextStatusSubscribe request (MBS Session ID) towards the
MB-SMF to subscribe to events notifications related to the multicast MBS
session and to request information about the MBS Session Context. The MB-SMF
responds with the information about the indicated multicast MBS session in
Nmbsmf_MBSSession_ContextStatusSubscribe response (multicast QoS flow
information (e.g. QoS profile(s) for the multicast MBS session), [start time],
[session state (Active/Inactive)], [Any UE indication], [multicast DL tunnel
info], [multicast session security context]).
If it is the first time for the MB-SMF to receive
Nmbsmf_MBSSession_ContextStatusSubscribe request of the indicated MBS Session
from any SMF, the MB-SMF learns it is the first UE joining the multicast MBS
session. For multicast transport between MB-UPF and content provider, if it is
the first UE joining the multicast MBS session, and MB-UPF has not joined the
multicast tree in the MBS session creation procedure, described in clause
7.1.1, the MB-SMF requests the MB-UPF to join the multicast tree towards the
AF/MBSF, otherwise MB-SMF will not send the request to the MB-UPF.
NOTE 3: The MB-SMF can answer the Nmbsmf_MBSSession_ContextStatusSubscribe
request either based on information received in the MBS session creation
procedures in clause 7.1.1 or based on preconfigured information. The pre-
configuration also includes information about the MBS session stored in the
NRF. If the MB-SMF uses preconfigured information, the pre-configuration also
includes MB-UPF configuration.
4\. The SMF determines whether the user is authorized to join the Multicast
MBS session taking into account the MBS subscription data received from the
UDM and the Any UE indication if received from the MB-SMF. The SMF considers
the UE as authorized to the Multicast MBS session if the UE is authorized to
use multicast MBS services, and if the MBS Session ID(s) in the PDU Session
Modification Request is included in the MBS subscription data or Any UE
indication is received. If authorization check fails, the SMF rejects the join
request with a cause value. If a UE joins prior to the start time of the
multicast MBS session, the SMF may accept the join request and indicate to the
UE the start time, or it may reject the join request with an appropriate error
cause and optionally a back-off timer. If a UE joins while the multicast MBS
session is inactive, the SMF accepts the join request. The MBS subscription
data from the UDM may also contain MBS assistance information.
NOTE 4: To avoid that joins requests at the MBS session start time are
rejected due to many UEs joining at the same time, the SMF can accept join
requests already before the MBS session start time and indicate to the UE the
start time.
5\. If the join request is accepted, the SMF responds to the AMF through
Nsmf_PDUSession_UpdateSMContext response (N2 SM information (PDU Session ID,
MBS Session ID, [updated PDU Session information], [mapping information
between unicast QoS flow(s) and multicast QoS flow (s)], [MBS Assistance
Information for the MBS session]), N1 SM container (PDU Session Modification
Command, [multicast session security context])) to:
\- create an MBS Session Context for the indicated MBS session in the RAN, if
it does not exist in the RAN already; and
\- inform the NG-RAN about the relation between the Multicast MBS Session
Context and the UE\'s PDU Session context by including the MBS Session ID and
the mapping between the multicast QoS flow(s) and associated QoS flow(s).
Based on operator policy, the SMF may prepare for 5GC Individual MBS traffic
delivery fall-back. The SMF maps the received QoS information of the multicast
QoS Flow into PDU Session\'s unicast QoS Flow information, and includes the
information of the QoS Flows and the mapping information about the QoS Flows
(termed \"associated QoS flow information\") in the SM information sent to
RAN. The SMF compares the QFIs of the multicast QoS Flows received from the
MB-SMF with QFIs in use for the PDU Session and assigns unused QFIs to the PDU
Session\'s unicast QoS Flows corresponding to multicast QoS Flows.
NOTE 5: Detailed information included in N2 SM information will be aligned
with by RAN WG3.
NOTE 6: The SMF uses the same QoS in the received MBS QoS Flow QoS information
for the associated QoS Flow in the unicast PDU session.
If the MBS session join procedure was triggered by the UE together with PDU
Session Establishment procedure for the associated PDU session, the SMF
provides the N2 SM information and N1 SM container for the associated PDU
session in Namf_Communication_N1N2MessageTransfer service operation towards
the AMF, as described in step 11 of clause 4.3.2.2.1 in TS 23.502 [6]. The N2
SM information also includes the MBS Session ID and, if 5GC individual MBS
traffic delivery fall-back is supported, the mapping information between
unicast QoS flow(s) and multicast QoS flow(s).
If the join request is rejected, the SMF responds to the AMF through
Nsmf_PDUSession_UpdateSMContext response (N1 SM container (PDU Session
Modification Reject)) and the message will not contain any MBS Session Context
or the N2 SM information for the associated PDU session. The PDU Session
Modification Reject message is forwarded to the UE via the NG-RAN, and the
following steps are skipped.
The SMF may also include the MBS assistance information for the MBS session in
N2 SM Information, if the MBS subscription data from the UDM contains the MBS
assistance information which includes the ID of the MBS session that the UE
requests to join. The MBS assistance information for the MBS session sent to
NG-RAN is described in clause 6.16.
6\. The N2 message, which includes the MBS Session ID(s) the UE has joined
and, if applicable, associated QoS Flow, is sent to the NG-RAN.
If the MBS is supported by NG-RAN, 5GC Shared MBS traffic delivery is adopted.
If the MBS is not supported by NG-RAN, 5GC Individual MBS traffic delivery is
used if the PDU Session\'s unicast QoS Flow include QoS Flows for the
multicast session.
If the NG-RAN supports MBS, the NG-RAN uses the MBS Session ID to determine
that the PDU Session identified by the PDU Session ID is associated with the
indicated multicast MBS session.
If the NG-RAN supports MBS, the associated unicast QoS flow information, if
provided, is not used to allocate the radio resource and CN resource for
corresponding QoS flows.
NOTE 7: UE join request via PDU Session signalling will fail if NG-RAN rejects
the PDU Session Resource setup request (e.g. due to the number of UEs reaching
a limit).
7\. [Conditional] If shared tunnel has not been established for the multicast
MBS session towards the NG-RAN node, the procedures in clause 7.2.1.4 for the
establishment of shared delivery toward NG-RAN node are executed. This step is
executed separately for each multicast MBS session.
7a. If the MBS Session is active, the NG-RAN configures radio resources for
MBS session.
8\. If the MBS Session is active, the NG-RAN node performs AN specific
signalling exchange with the UE to configure the UE with radio resources for
the multicast MBS session. If the NG-RAN does not support MBS and the MBS
Session is active, radio resources are reconfigured for unicast transmission
of the MBS data over the associated PDU session. As part of the AN specific
signalling exchange, the N1 SM container (PDU Session Modification Command) is
provided to the UE.
9\. The NG-RAN node sends the PDU session modification response.
If the MBS is not supported by NG-RAN, the accepted unicast QoS flow is
included in the N2 SM information. If the MBS is supported by NG-RAN, the N2
SM information further includes the indication of supporting MBS.
10\. The AMF invokes Nsmf_PDUSession_UpdateSMContext request ([N2 SM
information]) to the SMF.
Per the indication of whether the NG-RAN supports MBS, the SMF determines
whether 5GC Individual MBS traffic delivery is used for multicast data
transmission.
NOTE 8: If the shared tunnel is used, no interaction with UPF is needed for
the indicated multicast MBS session
[Conditional] This step is used for 5GC Individual MBS traffic delivery, if
the related NG-RAN does not support MBS. If a shared tunnel between the UPF
(PSA) and MB-UPF for 5GC Individual MBS traffic delivery has not yet been
established by the SMF for the multicast MBS session, steps 11a to 11d are
executed. Step 11e is executed irrespective of that.
11a. The SMF contacts the UPF to request the creation of a tunnel and provides
the MBS Session ID. The UPF indicates to the SMF whether the tunnel for this
multicast MBS session is newly allocated (as there can be multiple SMFs
interacting with the same UPF for the same multicast MBS Session).
If the UPF determines to use unicast transport over N19mb, the UPF allocates a
DL N19mb Tunnel endpoint for the multicast MBS session if the SMF request is
the first one to allocate DL N19mb Tunnel endpoint for the multicast MBS
Session in the UPF. The UPF includes the DL Tunnel Info in the response to the
SMF. The DL tunnel info includes the downlink tunnel ID and the UPF address.
If the UPF determines to use multicast transport over N19mb, the UPF joins the
multicast distribution if the SMF request is the first one for the MBS Session
in the UPF. Steps 11b to 11d are skipped.
11b. If the UPF indicates the DL N19mb Tunnel is newly allocated, the SMF
invokes Nmbsmf_MBSSession_ContextUpdate request (MBS Session ID, [DL tunnel
info]) towards the MB-SMF for establishing the multicast MBS session transport
between MB-UPF and UPF.
11c. If the DL tunnel info of the UPF is received, the MB-SMF configures the
MB-UPF to transmit the multicast MBS session data towards UPF using the
possibly received downlink tunnel ID.
11d. The MB-SMF responds to the SMF through Nmbsmf_MBSSession_ContextUpdate
response (MBS Session ID, [multicast DL tunnel info]). If the UPF DL tunnel
info for unicast transport is not received by the MB-SMF, multicast transport
between MB-UPF and UPF is to be used, and the MB-SMF includes the downlink
tunnel information with the low layer transport multicast address for the
multicast MBS session.
11e. The SMF configures the UPF to forward the received multicast MBS session
data within the PDU session. (This step may be combined with step 11a).
12\. The SMF responds to the AMF with Nsmf_PDUSession_UpdateSMContext response
message.
13\. The MB-UPF receives multicast PDUs, either directly from the content
provider or via the MBSTF that can manipulate the data.
Steps 14 to 16 are for 5GC Shared MBS traffic delivery:
14\. The MB-UPF sends multicast PDUs in the N3mb tunnel associated to the
multicast MBS session to the NG-RAN. There is only one tunnel per multicast
MBS session per MBS service area and NG-RAN node, i.e. all the UEs which have
joined the multicast MBS session via the NG-RAN node share this tunnel for
reception of the multicast MBS session data.
15\. Void.
16\. The NG-RAN transmits the multicast MBS session data to the UE(s) via the
MBS Radio Bearer using either PTP or PTM transmission.
In this step or at later stage, the NG-RAN may determine to apply delivery
enabling reception by UEs in RRC_INACTIVE state for the MBS session, as
defined in clause 6.17.
NOTE 9: Whether and when the NG-RAN determine to apply delivery enabling
reception by UEs in RRC_INACTIVE state for the MBS session as defined in
clause 6.17 is to be decided by NG-RAN.
Steps 17 to 19 are for 5GC Individual MBS traffic delivery:
17\. The MB-UPF sends multicast PDUs in the N19mb tunnel associated to the
multicast MBS session to the UPF. There is only one tunnel per multicast MBS
session and destination UPF, i.e. all associated PDU sessions served by the
destination UPF share this tunnel.
18\. The UPF forwards the multicast data towards the NG-RAN via unicast (i.e.
in the N3 tunnel of the associated PDU Session).
19\. The NG-RAN forwards the multicast MBS session data to the UE via unicast
(i.e. over the radio bearer(s) corresponding to the associated QoS flow(s) of
the associated PDU Session).
NOTE 10: Details of the DL MBS data transmission are described in clause 6.7.
NOTE 11: When the MBSF is involved in the multicast MBS session, the tunnel
between MBSTF and MB-UPF has been established in the MBS session creation
procedure.
#### 7.2.1.4 Establishment of shared delivery toward RAN node
In the following cases, the shared tunnel for shared delivery is established
between the NG-RAN and MB-UPF:
\- The first UE is included in the context of the MBS session in the NG-RAN.
NOTE 1: When the multicast MBS session is inactive, if there is at least one
UE joining the multicast MBS session is in RRC-CONNECTED state in the NG-RAN,
the shared delivery is not released.
NOTE 2: Share delivery establishment procedures are used when MBS supporting
NG-RAN node(s) get involved in the multicast MBS session regardless of the
state of the multicast MBS session.
\- Handover to the target NG-RAN when the shared delivery tunnel is not
established in the target RAN node for this multicast MBS session.
Figure 7.2.1.4-1: Establishment of shared delivery toward NG-RAN node
1\. A NG-RAN node decides to establish shared delivery for a multicast MBS
session when it serves at least one UE within the multicast MBS session. For
location dependent services, the NG-RAN node needs to establish shared
delivery for the location dependent contents of a multicast MBS session if it
serves at least one UE assigned to an MBS Session ID and Area Session ID.
2\. The NG-RAN sends an N2 MBS Session request message (MBS Session ID, [Area
Session ID], N2 SM information ([unicast DL tunnel Info])) towards the AMF.
If the NG-RAN node is configured to use unicast transport for the shared
delivery, it allocates a GTP tunnel endpoint and provides the unicast DL
tunnel Info in the request, which includes the GTP tunnel endpoint and NG-RAN
node address. For location dependent MBS services, the NG-RAN node also
provides the Area Session ID.
3\. The AMF selects the MB-SMF serving the multicast MBS session, e.g. using
the NRF discovery service or locally stored information. It invokes
Nmbsmf_MBSSession_ContextUpdate request (MBS Session ID, [Area Session ID], N2
SM information, NG-RAN Node ID) to the MB-SMF.
The AMF stores the information of the NG-RAN nodes (e.g. NG-RAN Node ID) for
the subsequent signaling related to the multicast MBS Session.
4\. [Conditional] If the MB-SMF receives the unicast DL tunnel Info in step 3
in a deployment where NG-RAN nodes share a common user plane entity, the MB-
SMF only establishes the shared tunnel towards the DL GTP tunnel endpoint if
the shared tunnel has not yet been established (as determined based on the
stored DL GTP Tunnel endpoint(s) for the MBS session). The MB-SMF also stores
the received DL GTP Tunnel and corresponding NG-RAN Node ID for the MBS
session.
To establish the shared tunnel towards the DL GTP tunnel endpoint, the MB-SMF
configures the MB-UPF to send multicast data for the multicast MBS session (or
location dependent content of the multicast MBS session if an Area Session ID
was received) towards that GTP tunnel endpoint via unicast transport.
5\. The MB-SMF stores the information of the AMF (e.g. AMF ID) in the MBS
Multicast MBS session context (or location dependent part of the Multicast MBS
Session Context if an Area Session ID was received) to enable subsequent
signalling towards that AMF.
6\. The MB-SMF sends Nmbsmf_MBSSession_ContextUpdate response (MBS Session ID,
[Area Session ID], N2 SM information ([TMGI], multicast QoS flow information,
session state (Active/Inactive), [multicast DL tunnel Info], [MBS service
areas])) to the AMF. If the MB-SMF did not receive unicast DL tunnel Info in
step 3, it provides the multicast DL tunnel info that includes transport
multicast address (e.g. a LL SSM) and a GTP tunnel endpoint for multicast
transport of the shared delivery.
7\. The AMF sends an N2 MBS Session response message (MBS Session ID, [Area
Session ID], N2 SM information) to the NG-RAN node. If the NG-RAN node
receives the multicast DL tunnel Info of the shared delivery, it uses the
transport multicast address included in the multicast DL tunnel info to join
the multicast transport distribution.
### 7.2.2 Multicast MBS Session leave and Multicast MBS Session release
procedure
#### 7.2.2.1 General
This clause describes Multicast MBS Session leave requested by the UE or by
the network. This clause also describes Multicast MBS Session release.
#### 7.2.2.2 Multicast Session leave requested by the UE
When the UE determines to leave the Multicast MBS session, it shall send PDU
session Modification request to inform the 5GC the leaving operation. The
Figure 7.2.2.2-1 describes the procedure.
Figure 7.2.2.2-1: UE initiated Multicast MBS Session leave
1\. The UE sends the PDU Session Modification Request when the UE determine to
leave the multicast MBS Session. The PDU Session Modification Request carries
leave indication and the MBS Session ID which the UE want to leave.
2\. The AMF invokes Nsmf_PDUSession_UpdateSMContext (N1 SM container (PDU
Session Modification Request)) to the SMF.
3a. [Conditional] If 5GC individual MBS traffic delivery is applied towards
the UE, the SMF sends an N4 Session Modification Request to the UPF (PSA). The
SMF reconfigures the UPF to terminate the distribution of multicast data via
the PDU session.
3b. [Conditional] The UPF (PSA) sends an N4 Session Modification Response to
the SMF.
If there are no PDU sessions to transmit the multicast MBS session data in the
UPF, and unicast transport is used over N19mb, the UPF releases the DL N19mb
tunnel endpoint and informs the SMF.
If there are no PDU sessions to transmit the multicast MBS session data in the
UPF, and multicast transport is used over N19mb, the UPF leaves the multicast
distribution tree of MB-UPF.
4\. [Conditional] If the UPF indicates the tunnel release (i.e. unicast
transport was used), the SMF invokes Nmbsmf_MBSSession_ContextUpdate Request
(Release, MBS Session ID, tunnel information) to release the tunnel between
UPF and MB-UPF for this multicast MBS session. The MB-SMF determines whether
the context update is for tunnel release or create based on whether the tunnel
information exists in the multicast MBS Session Context stored in the MB-SMF
or not.
5\. [Conditional] If the MB-SMF determines the context update is for tunnel
release, the MB-SMF request to MB-UPF to release the tunnel between UPF and
MB-UPF for the multicast MBS session.
6\. [Conditional] The MB-SMF responds to the SMF for step 4.
7\. The SMF invokes the Nsmf_PDUSession_UpdateSMContext Response (PDU Session
ID, N2 SM information ([MBS Session ID], [leave indication]), N1 SM container)
service operation. In the N2 SM information, the MBS Session ID and the leave
indication are included for informing the NG-RAN to remove the UE from this
MBS session if 5GC Shared MBS traffic delivery method is used towards the UE.
If 5GC Individual MBS traffic delivery method is used towards the UE, the N2
SM information does not include MBS related information.
In the N2 SM information, the SMF also informs the NG-RAN to release the
associated QoS Flow(s), which carry or intend to carry the multicast MBS
session traffic for 5GC individual MBS traffic delivery.
The associated QoS Flow(s) are released as defined in TS 23.502 [6] clause
4.3.3.2.
8\. The AMF send N2 message (N2 SM information, N1 SM container) to the NG-RAN
9\. The NG-RAN node performs the necessary AN-specific resource modification
procedure toward the UE and transports the N1 SM container received in step 7
to the UE.
10\. The NG-RAN node removes the UE from this multicast MBS session and sends
a N2 message to the AMF.
11\. The AMF transfers the N2 message received in step 9 to the SMF via the
Nsmf_PDUSession_UpdateSMContext service operation.
The SMF updates the associated PDU session context, e.g. remove the MBS
Session ID from the associated PDU session context. In addition, if associated
QoS flow is used for the multicast MBS session, the SMF also removes the
associated QoS flow information associated with the indicated multicast MBS
session from the associated PDU session context.
12\. [Conditional] If the UE is the last joined one of the multicast MBS
session in the SMF, The SMF also indicates that the last UE served by the SMF
leaves the Multicast MBS Session, the SMF unsubscribes the notifications of
the MBS Session Context status updates from the MB-SMF by invoking
Nmbsmf_MBSSession_ContextStatusUnsubscribe service operation. The MB-SMF will
no longer notify the SMF of the further context status updates of the
multicast MBS session (e.g. activation, deactivation, update, release, etc.).
For multicast transport between MB-UPF and content provider, if the SMF is the
last remaining SMF that is subscribed for the MBS Session notification from
the MB-SMF, i.e. if it is the last UE leaving the MBS session, the MB-SMF
requests the MB-UPF to stop forwarding the multicast MBS session data and may
request the MB-UPF to leave the multicast tree towards the AF/MBSF, if the MB-
UPF joins the multicast tree when the first UE joins the MBS session.
13\. [Conditional] If the UE is the last UE in this RAN node for this
multicast MBS session, the NG-RAN release shared delivery between NG-RAN and
MB-UPF as described in clause 7.2.2.4.
If release of the PDU Session associated with a multicast MBS session is
triggered, corresponding procedures between UE, NG-RAN, AMF, and SMF are
performed as described in clause 4.3.4 of TS 23.502 [6], and SMF triggers the
UE leave the multicast MBS session by performing steps 3-6 in Figure 7.2.2.2-1
for each multicast MBS session(s) associated with the PDU Session, and UE
considers as left all the multicast MBS sessions associated with the PDU
Session.
NOTE: If the associated PDU Session is released, the UE leaves MBS Session(s)
associated with that PDU session implicitly. To resume the reception of the
related MBS service(s), the UE needs to initiate the procedures as defined in
clause 7.2.1 to re-join the MBS Session(s).
If the UE deregistration procedure is executed, corresponding procedures
between UE, NG-RAN, AMF, and SMF are performed as described in clause 4.2.2.3
of TS 23.502 [6], and SMF performs steps 3-6 in Figure 7.2.2.2-1 for all
multicast MBS sessions joined by the UE. When the PDU Session Release
procedure or UE deregistration procedure is executed, according to the UE
context, NG-RAN performs step 10 for each multicast MBS session associated
with the released PDU Session(s).
#### 7.2.2.3 Multicast session leave requested by the network or MBS session
release
This procedure applies to the following scenarios:
1\. When the MB-SMF decides to release an MBS Session:
\- based on a request from the AF (directly or via the NEF/MBSF);
In this scenario, the MB-SMF notifies the SMF of multicast session release,
and the SMF initiates procedures to remove all joined UEs from the MBS
session.
2\. When the SMF decides to remove a UE from an MBS session:
\- based on a request from the UDM (subscription change); or
\- due to local and location dependent MBS service is described in clause
7.2.4; or
\- due to network internal reasons.
For the active MBS session, to release radio resources as early as possible,
the MB-SMF may trigger Multicast Session Deactivation towards the NG-RAN as
specified in steps 5-9 of clause 7.2.5.3, prior to or in parallel with
triggering MBS Session Release to the SMF.
Figure 7.2.2.3-1: MBS Session Release or Multicast session leave requested by
the network
1a. For MB-SMF triggered MBS session release, the SMF receives
Nmbsmf_MBSSession_ContextStatusNotify (MBS Session ID, multicast session
release) from the MB-SMF with MBS Session ID. The SMF checks all joined UEs
and perform step 2 to step 9 for each UE.
1b. The SMF decides to remove a UE from the MBS session without MBS session
release (e.g. due to UE moving out of MBS service area for local or location
dependent MBS service as described in clause 7.2.4).
2\. For UEs without activated UP, the SMF may perform the same procedure as
defined in step 3-7 in clause 7.2.5.2.
Alternatively, for UEs without activated UP, the SMF does not trigger message
to the AMF, instead the SMF marks that the UE is to be informed of the MBS
Session release. In this case, the SMF initiates PDU Session Modification to
inform the UE of the MBS Session release at next UP activation of the
associated PDU Session, if needed.
3\. For the joined UEs with UP activated, the SMF invokes
Namf_Communicate_N1N2MessageTransfer to the AMF. The N1 SM container indicates
UE removed from MBS session with appropriate cause (e.g. MBS session release,
out of MBS service area, etc.). In N2 SM information, the SMF informs the NG-
RAN to remove the UE from the MBS session. If there are associated QoS Flow(s)
for individual delivery, the SMF also releases those QoS Flow(s) as specified
in TS 23.502 [6] clause 4.3.3.2.
4\. The AMF sends N2 Request to the NG-RAN.
5\. The NG-RAN transports the N1 SM container (PDU Session Modification
Command (MBS Session ID, UE removed from MBS session with appropriate cause))
to the UE.
6\. The NG-RAN performs radio resource modification. If there are no joined
UEs in the MBS session, the NG-RAN releases the radio resources.
7\. If there are no joined UEs in the MBS session, for unicast transport of
N3mb, the NG-RAN initiates the DL tunnel release towards MB-UPF via AMF and
MB-SMF. For multicast transportation of N3mb, the NG-RAN performs IGMP/MLD
Leave for the MBS session. See clause 7.2.2.4 for details.
8\. The NG-RAN sends N2 Response to the AMF. If there are no joined UEs in the
MBS session, the MBS Session Context is removed from the NG-RAN.
9\. The AMF transfers the N2 message received in step 8 to the SMF via the
Nsmf_PDUSession_UpdateSMContext service operation. The SMF removes the UE from
the MBS Session.
#### 7.2.2.4 Release of shared delivery toward RAN node
In the following case, the shared delivery tunnel may be released between NG-
RAN and MB-UPF:
\- The last UE is excluded from the context of the multicast MBS session in
the NG-RAN node;
\- Handover to the target NG-RAN when the UE is the last UE for this multicast
MBS session in the source NG-RAN node during handover preparation phase known
by the source NG-RAN node;
\- Handover to the target E-UTRAN when the UE is the last UE for this
multicast MBS session in the source NG-RAN node;
\- MBS session deletion.
NOTE: When the multicast MBS session is inactive, the shared delivery is not
released if there is at least one UE is in RRC-CONNECTED state for this
multicast MBS session.
Figure 7.2.2.4-1: Release of shared delivery toward RAN node
1\. A RAN node decides to release shared delivery for a multicast MBS session,
e.g. because it no longer serves at least one UE within the multicast MBS
session. For location dependent services, the NG-RAN node may release shared
delivery for the location dependent contents of a multicast MBS session if it
no longer serves at least one UE assigned to an MBS Session ID and Area
Session ID.
2\. The NG-RAN node sends N2 MBS Session release request (MBS Session ID,
[Area Session ID], [N2 SM information ([GTP tunnel info], release
indication)])]) to the AMF. For location dependent services, the NG-RAN node
also provides the Area Session ID. The RAN node includes the unicast DL tunnel
info if unicast transport is used for the shared delivery. If the NG-RAN node
was configured to use multicast transport for the 5GC Shared MBS traffic
delivery, the NG-RAN node does not include the N2 SM information in the
message.
3\. [Conditional] If the N2 SM information is received or it is the last RAN
node controlled by the AMF serving the multicast MBS session, the AMF invokes
Nmbsmf_MBSSession_ContextUpdate request (MBS Session ID [Area Session ID],
[leave indication], [N2 SM information ([DL GTP tunnel endpoint ID])], NG-RAN
Node ID) to the MB-SMF corresponding to the MB-SMF ID stored in the AMF for
the MBS Session ID. If it is the last RAN node controlled by the AMF serving
the multicast MBS session identified by the MBS Session ID or both the MBS
Session ID and Area Session ID (if exists), the leave indication is included.
4\. [Conditional] If unicast transport was used towards the NG-RAN node, the
MB-SMF determines whether the context update is for tunnel release or create
based on the release indication in the N2 container. If the MB-SMF determines
the context update is for tunnel release, , it performs the following:
If the unicast transport was used towards the NG-RAN in a deployment where NG-
RAN nodes share a common user plane entity, the MB-SMF removes the received
NG-RAN Node ID and possibly DL GTP tunnel endpoint from the stored NG-RAN Node
ID(s) for the DL GTP tunnel endpoint for the MBS session, and checks whether
the DL GTP tunnel is in use by other NG-RAN nodes based on the stored NG-RAN
Node ID(s) for DL GTP tunnel endpoint for the MBS session.
For the deployment where NG-RAN nodes do not share a common user plane entity,
the DL GTP tunnel will not be used by other NG-RAN nodes.
If the related DL GTP tunnel is not in use by other NG-RAN nodes the MB-SMF
sends N4mb Session Modification to the MB-UPF to release the N3mb tunnel used
for the multicast MBS session (or location dependent content of the multicast
MBS session if an Area Session ID was received) towards that NG-RAN node using
the received GTP tunnel info.
5\. [Conditional] The MB-SMF responses to the AMF with MBS Session ID and Area
Session ID if received. If leave indication is received, the MB-SMF also
removes the information of the AMF from the context of the multicast MBS
session.
6\. The AMF removes the information of the RAN node from the context of the
multicast MBS session (or location dependent part of the multicast MBS session
if an Area Session ID was received).
7\. The AMF sends an N2 MBS Session release response (MBS Session ID, [Area
Session ID]) to the RAN node. The NG-RAN node deletes the GTP tunnel info (if
unicast transport is used for the shared delivery) or sends IGMP/MLD leave
message to leave the multicast distribution tree (if multicast transport is
used for the shared delivery). The NG-RAN node releases local resources for
the multicast MBS session.
### 7.2.3 Mobility Procedures for MBS
#### 7.2.3.1 General
UE may move from one NG-RAN node to another NG-RAN node after UE has joined
the MB Session. There are various mobility scenarios possible, depending on
whether one of the involved NG-RAN nodes supports MBS.
During an active MBS Session, mobility between an NG-RAN supporting MBS and an
NG-RAN node not supporting MBS requires the mobility procedure to provide the
appropriate MBS traffic delivery method at the target NG-RAN node.
#### 7.2.3.2 Xn based handover from MBS supporting NG-RAN node
This clause describes an Xn based handover with MBS traffic delivered to the
UE at the source NG-RAN node supporting MBS.
Figure 7.2.3.2-1: Xn based handover with MBS Session
The following additions apply compared to clause 4.9.1.2 of TS 23.502 [6]:
**Before Handover:**
The source NG RAN has been provided with MBS Session Resource information
(including the MBS Session ID and multicast QoS flow information) and the UE
Context information contains a mapping information within the PDU Session
Resource associated with the MBS Session Resource, e.g. including mapped
unicast QoS Flows associated with the multicast QoS flow(s) of the MBS Session
Resource.
**Handover Preparation Phase:**
At Xn handover, the target NG-RAN is provided with MBS session information by
the source NG-RAN which causes:
\- an MBS non-supporting target NG-RAN node to prepare the unicast resources
according to associated QoS flow(s) information.
‐ an MBS supporting target NG-RAN node to allocate to the UE shared NG-RAN
resources according to the MBS session information. If the 5GC Shared MBS
traffic delivery for the indicated multicast MBS Session has not been
established in target NG-RAN, target NG-RAN triggers setup of the resources
for the 5GC Shared MBS traffic delivery, see clause 7.2.1.4 for details.
1\. Target NG-RAN to AMF: the target NG-RAN sends N2 Path Switch Request to
AMF.
The target NG-RAN node, if MBS-capable, indicates it supports of MBS to SMF in
N2 SM information. Per the received N2 SM information, the SMF knows whether
the target NG-RAN node supports MBS and determines the delivery method, i.e.
whether the 5GC Shared MBS traffic delivery or 5GC Individual MBS traffic
delivery is used for MBS data transferring.
The SMF differentiates two cases:
Case A) The target NG-RAN supports MBS. Step 3 applies and step 4 is skipped.
3\. SMF to UPF: The SMF invokes N4 Session Modification procedure with the UPF
(PSA) only for unicast PDU Session.
Case B) The target NG-RAN does not support MBS. Step 3 is skipped, step 4
applies.
4\. This steps is same as described in step 11 of clause 7.2.1.3.
The details of how to perform data forwarding refers to clause 7.2.3.5.
5\. SMF to AMF: The SMF responds to AMF through
Nsmf_PDUSession_UpdateSMContext response.
6\. AMF to target NG-RAN: The AMF sends the path switch Ack to target NG-RAN.
#### 7.2.3.3 N2 based handover from MBS supporting NG-RAN node
This clause describes the N2 based handover with MBS traffic delivered to the
UE at the source NG-RAN node supporting MBS.
Figure 7.2.3.3-1: N2 based handover with MBS Session
The following additions apply compared to clause 4.9.1.3 of TS 23.502 [6]):
1\. Source NG-RAN to S-AMF: Handover Required (RAN container (MBS Session
information, associated PDU session information, [associated QoS flow
information and corresponding multicast QoS flow information])).
2\. [Conditional] S-AMF to T-AMF: The T-AMF is provided with associated PDU
Session information and the MBS session related information.
3\. T-AMF and SMF(s): T-AMF interacts with SMF via
Nsmf_PDUSession_UpdateSMContext request/response. In the response sent by SMF,
multicast MBS session related information (i.e. MBS session ID and optionally
the mapping between the multicast QoS flow(s) and associated QoS flow(s)), is
included in the N2 SM information.
4\. T-AMF to Target NG-RAN: The Target NG-RAN prepares the radio resource
based on the received information:
\- If the Target NG-RAN does not support MBS, the MBS Session related
information is not used. The Target NG-RAN uses the associated PDU Session
information to allocate resource to deliver MBS data. The MBS data are
transmitted via the associated QoS flows within the associated PDU Session.
\- If the Target NG-RAN supports MBS, the Target NG-RAN uses the multicast MBS
Session related information to allocate RAN resources to deliver the MBS data.
If 5GC Shared MBS traffic delivery for the indicated multicast MBS session has
not been established towards the Target NG-RAN, the Target NG-RAN initiates
the shared delivery establishment towards the MB-SMF via AMF as described in
clause 7.2.1.4.
5\. Target NG-RAN to T-AMF: The target NG-RAN sends Handover Request Ack to
T-AMF.
The target NG-RAN node, if MBS-capable, indicates it supports MBS to SMF in N2
SM information. Per the received N2 SM information, the SMF knows whether the
target NG-RAN node supports MBS and determines the delivery method, i.e.
whether the 5GC Shared MBS traffic delivery or 5GC Individual MBS traffic
delivery is used for MBS data transferring.
12\. T-AMF to SMF: The AMF invokes Nsmf_PDUSession_UpdateSMContext request
towards SMF, the message includes the received N2 SM information received from
the target NG-RAN.
13-14. Same as described in steps 3-4 of clause 7.2.3.2.
The details of how to perform data forwarding, refers to clause 7.2.3.5.
15\. SMF to T-AMF: The SMF sends the Nsmf_PDUSession_UpdateSMContext Response
to the T-AMF.
#### 7.2.3.4 Xn/N2 based handover from non-MBS supporting NG-RAN node
When the UE has joined the multicast MBS session and the source NG-RAN node
does not support MBS, the 5GC Individual MBS traffic delivery method is used
for the multicast MBS session data delivery. When the Xn/N2 based handover
procedure is triggered, the UE is handed over to the target NG-RAN node per
existing Xn /N2 based handover procedure defined in TS 23.502 [6].
The following applies for an Xn based handover from an NG-RAN node not
supporting 5G MBS:
\- The source NG-RAN node requests the associated QoS Flow(s) in the
associated PDU session to be handed over to the target NG-RAN node.
\- In the Path Switch Request message, the target NG-RAN node, if MBS-capable,
indicates it supports MBS to the SMF in the N2 SM information.
\- After successful handover, if the target NG-RAN node supports MBS, the SMF
triggers modification of the associated PDU Session at the target NG-RAN node
by including the multicast MBS session related information in N2 SM
Information as described in step 7 of clause 7.2.1.3, which may trigger the
target NG-RAN node to initiate establishment of shared delivery as described
in clause 7.2.1.4. NG-RAN provides the response to the request for the
modification of the PDU session when the shared delivery of the MBS session
data to the related UE (if applicable) is available
\- Based on the response of PDU session modification procedure, the SMF
changes the MBS session data delivery method from 5GC Individual MBS traffic
delivery method to 5GC shared MBS traffic delivery method, and sends N4
Session modification message to UPF to configure UPF to not forward the
received multicast MBS session data via the associated PDU Session. If there
are no multicast MBS session data forwarding via the associated PDU session(s)
needed, the SMF may also release the shared tunnel between the UPF and MB-UPF.
The following applies for an N2 based handover from an NG-RAN node not
supporting MBS:
\- During handover preparation phase, the SMF includes the multicast MBS
session related information in N2 SM Information as described in step 7 of
clause 7.2.1.3 and sends it to the target NG-RAN. The target NG-RAN, if MBS-
capable, indicates it supports MBS to SMF in N2 SM information. If the target
NG-RAN node supports MBS, the target NG-RAN node adds the UE into the MBS
Session Context. If 5GC Shared MBS traffic delivery for the indicated
multicast MBS session has not been established towards the target NG-RAN, the
target NG-RAN uses the multicast MBS Session related information to allocate
RAN resources to deliver the MBS data and initiates the shared delivery
establishment towards the MB-SMF as described in clause 7.2.1.4.
\- Based on the received MBS support information in N2 SM information from the
target NG-RAN, the SMF determines the MBS data delivery method for the
multicast MBS session. The SMF configures UPF to not forward the received
multicast service data to the associated PDU Session via N4 Session
modification message, i.e. SMF changes 5GC individual MBS traffic delivery to
5GC shared MBS traffic delivery. If there are no multicast MBS session data
forwarding via the associated PDU session(s), the SMF may also release the
shared tunnel between the UPF and MB-UPF.
#### 7.2.3.5 Minimization of data loss
To minimize data loss of a multicast MBS session during the handover procedure
the following functions apply:
\- For each MBS QoS flow, the MB-UPF adds a sequence number in each data
packet of the MBS session sent by the MB-UPF and forwarded to all related NG-
RAN nodes and UPFs via GTP-U tunnel. When the UPF forwards the received MBS
data packet, the sequence number shall not be changed.
\- If both the source NG-RAN node and target NG-RAN node support MBS, to
minimize data loss of the MBS session either of, or a combination of, the
following methods may be applied, as specified in TS 38.300 [9]:
\- Data may be forwarded from source NG-RAN node to target NG-RAN node. In
handover preparation phase, the MBS progress information (i.e. PDCP number) is
exchanged between source NG-RAN node and target NG-RAN node.
\- NG-RAN nodes share a common user plane entity, denoted as shared NG-U
termination in TS 38.300 [9], which allows the allocation of identical PDCP
numbers to MBS users data when delivered to UEs in cells served by different
NG-RAN nodes.
\- If source NG-RAN node supports MBS and target NG-RAN node does not support
MBS, the multicast MBS session data is forwarded from source NG-RAN node to
target NG-RAN node via data forwarding tunnels allocated by the target NG-RAN
node associated with the mapped unicast QoS flows within the associated PDU
session according to the data forwarding mechanism defined in TS 23.502 [6].
\- If source NG-RAN node does not support MBS and target NG-RAN node supports
MBS, for Xn/N2 handover, the multicast MBS session data is forwarded to the
target NG-RAN node as the data forwarding mechanism defined in TS 23.502 [6].
Directly after the handover the target NG-RAN node thus still receives MBS
session data via individual delivery. The UPF forwards multicast MBS session
data within the associated PDU session which includes the sequence number
received from the MB-UPF to the target NG-RAN node. Shared delivery of MBS
data towards the target RAN node is being established as described in clause
7.2.1.4 and the target RAN node receives sequence numbers as part of the MBS
data with sequence numbers via shared delivery.
NOTE: For N2 handover, the detail mechanism of how to transmit the received
forwarded multicast MBS session data to UE is defined by RAN WGs.
#### 7.2.3.6 Xn/N2 based handover for inactive MBS session
If the MBS session is in Inactive state, the following differences apply as
compared to the handover procedures for the MBS session in Active state:
\- The target NG-RAN is provided with the MBS session ID, but is not provided
with Active MBS Session Information by the source NG-RAN as specified in TS
38.423 [24] and in TS 38.413 [15].
\- For Xn/N2 based handover, the information that MBS session is Inactive
state is implied by the lack of Active MBS Session Information provided from
the source RAN node towards the target RAN node.
\- For the MBS supporting NG-RAN node, the target NG-RAN establishes the
shared tunnel with the MB-UPF as usual, if it hasn\'t been established before.
However, as the MBS session is in Inactive state, the NG-RAN node will not
allocate related radio resource.
NOTE 1: The MBS Session Inactive state is provided by MB-SMF to NG-RAN in the
N2 SM information in step 7 of clause 7.2.1.4.
\- After a handover to a target NG-RAN node not supporting MBS, the SMF
removes the associated QoS flow(s) information.
NOTE 2: Whether the associated QoS Flow(s) are removed from UE, NG-RAN, or
only resource in NG-RAN is removed is up to implementation.
#### 7.2.3.7 Connection Resume in RRC Inactive procedure
If an MBS session is in Inactive state, the UE may be in CM-CONNECTED with RRC
Inactive state. If an MBS Session is in Active state, the UE may also be in
CM-CONNECTED with RRC Inactive state as specified in clause 16.10.5.2 of TS
38.300 [9].
The UE may resume the connection in a different NG-RAN node as specified in
clauses 4.8.2.2 and 4.8.2.2a of TS 23.502 [6], with following enhancement when
the context retrieval is successful:
\- For an MBS supporting NG-RAN:
\- if the UE context retrieved from the last serving NG-RAN includes MBS
session information and the NG-RAN node has not yet established the 5GC Shared
MBS traffic delivery for the MBS session, the NG-RAN establishes the 5GC
Shared MBS traffic delivery as specified in clause 7.2.1.4. The NG-RAN then
sends Path Switch Request indicating the MBS support information;
\- if the UE context retrieved from the last serving NG-RAN does not include
MBS session information, Path Switch Request sent from NG-RAN includes the MBS
support information. Based on the MBS support information, the SMF, after
acknowledging the path switch request, provides the MBS related information
and if applicable the associated QoS flow(s) information to the NG-RAN as
specified in clause 7.2.1.3. The NG-RAN establishes the 5GC Shared MBS traffic
delivery as specified in clause 7.2.1.4.
\- For an MBS non-supporting NG-RAN, Path Switch Request sent from NG-RAN does
not include the MBS support information. If the MBS session is still inactive,
the SMF, after acknowledging the path switch request, removes the associated
QoS flow(s) information if it was provided before.
If the UE context retrieval fails, the UE is moved into RRC IDLE state as per
TS 38.300 [9]. The UE initiates the NAS signalling recovery including
activating PDU Session(s) (see TS 24.501 [25]). When the associated PDU
session(s) is activated during registration procedure (see clause 4.2.2.2.2 of
TS 23.502 [6]) or service request procedure (see clause 4.2.3.2 of TS 23.502
[6]), clause 7.2.8 applies.
NOTE: As specified in clause 4.2.2.2.2 of TS 23.502 [6], parts of the service
request procedure can also be executed during the Mobility Registration Update
procedure.
#### 7.2.3.8 Mobility procedures to enable delivery of multicast MBS session
data to UEs in RRC_INACTIVE state
##### 7.2.3.8.1 General
The procedures in clauses 7.2.3.2, 7.2.3.3, 7.2.3.4, 7.2.3.6 and 7.2.3.7 apply
with the following additions:
\- If the MBS assistance information is available at the SMF for an MBS
session that the UE joined,
\- If there is signalling of MBS session related information from SMF to
target RAN node, the SMF includes MBS Assistance Information in the N2 SM
information.
\- For N2-based handover, when the SMF provides the MBS session related
information as part of the associated PDU Session context data as specified in
the existing procedures, the SMF also includes the MBS Assistance Information
in the N2 SM information.
\- For Xn-based handover or Connection Resume from a non-MBS supporting source
RAN node towards an MBS supporting target RAN node, the SMF provides MBS
session related information as part of the associated PDU Session context data
as specified in the existing procedures, the SMF also includes the MBS
Assistance Information in the N2 SM information.
\- For Xn-based handover or Connection Resume from an MBS supporting source
RAN node towards an MBS supporting target RAN node, depending on
configuration, the SMF may provide the MBS Assistance Information.
\- The MBS session information transferred from source NG-RAN towards target
NG-RAN also include MBS assistance information for the MBS session if such
information is available at the source RAN node.
Editor\'s note: It is up to RAN WG to confirm that the MBS session information
transferred from source NG-RAN towards target NG-RAN includes MBS assistance
information.
NOTE 1: In deployments where not all the MBS supporting NG RAN nodes support
delivery of multicast MBS session data to UEs in RRC_INACTIVE state, a source
NG-RAN node not supporting delivery of multicast MBS session data to UEs in
RRC_INACTIVE state will not provide MBS assistance information for the MBS
session to the target NG-RAN node.
NOTE 2: It is assumed that a RAN node not supporting delivery of multicast MBS
session data to UEs in RRC_INACTIVE state ignores the MBS assistance
information for the MBS session.
For a UE that is receiving multicast MBS data in CM-CONNECTED with
RRC_INACTIVE state, the scenarios for UE mobility are as follows:
\- UE moves to new cell within the RAN Notification Area (RNA).
\- UE moves outside the current RAN Notification Area but within the current
Registration Area (RA).
\- UE moves out of the current Registration Area.
##### 7.2.3.8.2 Mobility of UE in RRC_INACTIVE state receiving MBS data within
RNA
When a UE in RRC_INACTIVE state is receiving ongoing MBS session data and
moves to a new cell within the RNA, the UE may receive the MBS session data in
RRC_INACTIVE state or resume the connection as specified in TS 38.300 [9],
otherwise the UE may resume the connection.
##### 7.2.3.8.3 Mobility of UE in RRC_INACTIVE state receiving MBS data out of
RNA and within RA
When a UE in RRC_INACTIVE state is receiving multicast MBS session data, if
the UE moves out of the RNA and within the RA, the UE resumes the connection
in the same way as specified in clause 7.2.3.7.
##### 7.2.3.8.4 Mobility of UE in RRC_INACTIVE state receiving MBS data out of
RA
When the UE in RRC_INACTIVE receiving multicast MBS session data, if the UE
moves out of the RA, the UE initiates the Mobility Registration Update
procedure to activate the associated PDU session(s) as specified in clause
4.2.2.2.2 of TS 23.502 [6]. Hence the shared delivery (if not already
established) or the individual delivery can be established towards the NG-RAN
node to enable delivery of multicast MBS session data to the UEs.
### 7.2.4 Support of Local multicast service and Location dependent multicast
service
#### 7.2.4.1 General
The clause captures the procedural enhancement to support Location dependent
MBS service and the Local MBS service described in clause 6.2.
#### 7.2.4.2 Support of location dependent multicast service
##### 7.2.4.2.0 Creation for location dependent MBS session
For location dependent MBS, the MBS session creation procedure is performed as
defined in clause 7.1.1.2 with the following additions and difference:
\- Multiple AFs may start the same Multicast MBS session with different
content in different MBS service areas. The AF (or NEF/MBSF if involved)
selects MB-SMF for different MBS service areas.
\- For each MBS service area, the AF creates a location dependent component of
an MBS session for that service area towards the MB-SMF and provides the
service area, which may be via NEF or MBSF. The MB-SMF additionally returns
the Area Session ID allocated by MB-SMF in the response to a request to create
a location dependent component of a Multicast MBS session, and the NEF
forwards this Area Session ID to the AF. The AF provides the Area Session ID
in subsequent requests related to that location dependent component of the MBS
session.
\- When requesting the creation of a location dependent component of the MBS
session for a service area, the AF provides an indication that the request is
for the creation of a location dependent component of the MBS session.
\- The NEF, if involved in the MBS Session, maps MBS service areas of external
format (if any) to network internal format (list of cells, TAIs).
\- MB-SMF allocates Area Session ID, and updates its NF profile towards the
NRF with the MBS Session ID, MBS service area and Area Session ID.
NOTE: For a location dependent service provided in different MBS service areas
within the same SMF service area, it is assumed that one MB-SMF is used for an
MBS Session.
\- The QoS of Multicast MBS session is determined based on the service
requirements per MBS Session. MB-SMF assign the same QFI for MBS QoS Flow with
the same QoS requirement in different MBS service areas.
\- The MB-SMF configures the MB-UPF separately for each service area. The MB-
SMF may select the MB-UPF based on the MBS service area.
\- All MBS service area(s) of the location dependent MBS session are indicated
to the UE in the Service Announcement as defined in clause 6.11.
\- The AF transmits the DL media streams to MB-UPF via tunnels to
differentiate the content delivered to different areas.
##### 7.2.4.2.1 UE join location dependent Multicast MBS session and
establishment procedure
The location dependent multicast session join and establishment procedure is
performed as defined in clause 7.2.1 with the following additions:
\- The location dependent Multicast MBS session is created as described in
clause 7.2.4.2.0.
\- The UE may have information about the location dependent multicast service
including all MBS service areas of the location dependent MBS session via
Service Announcement as specified in clause 7.2.4.3.1.
\- If the UE determines that it is in MBS service area of the location
dependent MBS session based on the information about local multicast service
e.g. obtained via Service Announcement, the UE sends Join Request to join the
multicast group. If the UE determines that it is outside all MBS service area
of the location dependent MBS session, the UE does not send the Join Request.
\- If SMF requires information about the multicast MBS Session Context for the
indicated MBS Session ID, the SMF requests MB-SMF information via
Nnrf_NFDiscovery_Request Request (MBS Session ID, UE location). The SMF should
provide the TAI where the UE is located as input for the MB-SMF discovery. If
the NRF does not have information about service areas for an MBS Session ID in
the MB-SMF profile but obtains a TAI in combination with MBS Session ID as
query parameter, the NRF ignores the TAI and provides the MB-SMF profile
matching the MBS Session ID.If the TAI is not included, but the related MB-SMF
include the service area, the NRF return all the MB-SMF associated with that
MBS Session ID.
NOTE 1: The AMF provides the User Location Information of the UE (cell ID and
current tracking area ID) towards the SMF within
Nsmf_PDUSession_CreateSMContext request and if the location changed also in
Nsmf_PDUSession_UpdateSMContext request (as used for the join) as specified in
clauses 4.3.2.2.1 and 4.3.3.2 of TS 23.502 [6].
\- The NRF provides information about the MB-SMF(s) serving the Multicast MBS
session at the possible indicated location. The NRF provides the service areas
and Area Session IDs for the Multicast MBS session as part of the MB-SMF
profile(s), via Nnrf_NFDiscovery_Request Response (MB-SMF profile (Area
Session ID(s), MBS service area(s)). The SMF selects the MB-SMF based on the
location area where the UE is residing (if the TAI is not provided to the NRF)
and interacts with MB-SMF to retrieve QoS information of the multicast QoS
flow(s) for the MBS Session ID and subscribes to notifications about the MBS
Session ID.
\- The SMF check whether the UE is inside MBS service areas of the location
dependent MBS session by comparing the User Location Information of the UE
provided by the AMF with the MBS service areas received from the NRF. If the
UE is out of all MBS service area of the location dependent MBS session, the
SMF reject the multicast session join request.
\- If the Join Request from the UE is accepted, the SMF may subscribe at the
AMF using the Namf_EventExposure service to notifications about the \"UE
moving in or out of a subscribed \"Area Of Interest\"\" event. The SMF
supplies all MBS service areas of the location dependent MBS session as Area
Of Interest.
\- The SMF requests the AMF to transfer an N2 message to the RAN node using
the Nsmf_PDUSession_UpdateSMContext response, to provide the NG-RAN with
Multicast MBS session information which additionally includes the Area Session
ID.
\- If the NG-RAN node supports MBS, the NG-RAN uses the received MBS Session
ID and Area Session ID to determine the local Multicast MBS session context
and whether the user plane for the local Multicast MBS session is already
established. If the RAN determines the shared delivery is not established for
the MBS Session ID and Area Session ID, the NG-RAN initiates the shared
delivery establishment as specified in clause 7.2.1.4 and provides the Area
Session ID, tracking area ID(s) concerning the RAN node in addition to MBS
Session ID in the request for shared delivery establishment. The MB-SMF
provides MBS service area information (Area Session ID(s), MBS service
area(s)) associated with the same MBS session to NG-RAN in the shared delivery
establishment response. MB-SMF may either provide only the service areas
concerning the target RAN node or all service areas associated with the MBS
session. If the MB-SMF only provides the service areas concerning the target
RAN node, which includes the cell ID(s), the cell ID is included if the
tracking area IDs associated with the indicated cell ID is received by the MB-
SMF.
\- If the NG-RAN node serving the UE does not support MBS and the UE is in the
MBS service area, the SMF apply individual delivery towards the UE. The SMF
configures the UPF to send data related to the Multicast MBS session and
service area via individual delivery within a PDU session of the UE. The SMF
additionally subscribes at the AMF using the Namf_EventExposure service to
notifications about UE location changes (e.g. for a small MBS service area),
or to notifications about the \"UE moving in or out of a subscribed \"Area Of
Interest\"\" event. In the latter case, the SMF supplies the service area
associated with the multicast area session where the UE resides as Area Of
Interest. The SMF configures separate ingress terminations at the UPF for each
service area and interacts separately for each service area (providing MBS
Session ID and Area Session ID) with the MB-SMF to request or terminate the
distribution of data for the MBS session and service area towards the UPF.
##### 7.2.4.2.2 Void
##### 7.2.4.2.3 Handover procedure
The Handover procedure for the UE is performed as defined in clause 7.2.3.2,
7.2.3.3, and 7.2.3.4 with the following additions:
\- If the UE is receiving multicast data corresponding to the MBS Session ID
and Area Session ID via the 5GC Shared MBS traffic delivery from cells served
by the Source NG-RAN before the handover, for the Xn Handover (comparing with
the clause 7.2.3.2), the following applies:
\- The Source RAN node includes MBS Session ID, Area Session ID and MBS
service area associated with the cell where the UE resides to the Target RAN
node.
NOTE 1: During the handover procedure the associated QoS flow is established
towards a NG RAN node not supporting MBS regardless whether the UE is still in
the MBS service area associated with the original Area Session ID or not
\- If the UE is receiving multicast data corresponding to the MBS Session ID
and Area Session ID from cells served by the Source NG-RAN via the 5GC Shared
MBS traffic delivery before the handover, for the N2 Handover (comparing with
the clause 7.2.3.3), the following applies:
\- The source RAN node includes MBS session area information (MBS Session ID,
Area Session ID and MBS service area associated with the cell where the UE
resides) for delivery to the Target RAN node within the Source to Target
transparent container in the Handover Required message.
\- The SMF forwards the Source to Target transparent container and may also
include MBS session area information (MBS Session ID, Area Session ID and MBS
service area) to the Target RAN in Handover request.
NOTE 2: The SMF cannot determine the UE location and a possible new service
area at this stage.
\- If the UE is receiving multicast data corresponding to the MBS Session ID
and Area Session ID from cells served by the Source NG-RAN via the 5GC
Individual MBS traffic delivery before the Handover, for the Xn/N2 handover
procedure (comparing with the clause 7.2.3.4), the following applies:
NOTE 3: During the Xn handover procedure, the associated QoS flow is
established at Target RAN side regardless whether the UE is still in the MBS
service area associated with the original Area Session ID or not.
\- For the N2 handover procedure, the SMF includes MBS session area
information (MBS Session ID, Area Session ID, and MBS service area) associated
with the last known service area of the UE in N2 SM information to the Target
RAN node in Handover Request message.
\- If the target RAN node supports MBS, it determines whether to establish the
resources for multicast distribution and data forwarding for the received MBS
Session ID and Area Session ID, based on MBS Session ID, Area Session ID, MBS
service area provided by the source RAN (if source RAN support MBS) or SMF (if
source RAN not support MBS) and the target location of the UE. If UE is not in
the MBS service area provided by the source RAN (if source RAN supports MBS)
or SMF (if source RAN does not support MBS), the target RAN does not allocate
RAN resources, including the resource for data forwarding, for the multicast
MBS Session to the UE.
\- If the target RAN node support MBS, when it determines the shared delivery
is not established for the multicast session ID and Area Session ID, the
target NG-RAN initiates the shared delivery establishment as specified in
clause 7.2.1.4 and provides the Area Session ID and tracking area ID(s)
concerning the RAN node in addition to MBS Session ID in the request for
shared delivery establishment. The MB-SMF provides MBS session area
information (Area Session ID(s), MBS service area(s)) associated with the MBS
session to the NG-RAN in the shared delivery establishment reply. The MB-SMF
may either provide only the service areas concerning the target RAN node or
all service areas associated with the MBS session.
NOTE 4: If the target RAN does not support MBS, the associated QoS flow is
established at target RAN side during the handover procedure regardless
whether the UE is still in the MBS service area associated with the original
Area Session ID or not.
\- If the target RAN supports MBS, but the Source RAN does not support MBS,
the SMF configures the UPF to stop sending data related to the Multicast MBS
session and service area via the associated PDU session of the UE. The SMF
unsubscribes at the AMF using the Namf_EventExposure service to notifications
about UE location changes, or to notifications about the \"UE moving in or out
of a subscribed \"Area Of Interest\"\" event (for an individual service area).
NOTE 5: If the UE is still in the MBS session, the subscription for the UE
entering or leaving the complete service area does not need to be changed.
\- When the AMF receives the User Location Information from target RAN node
via the Path Switch Request message or Handover Notify message, the AMF
provide it to the SMF. When the SMF get the User Location Information, the SMF
determines the MBS service area of the UE camping cell by comparing the User
Location Information received from AMF with the MBS service areas received
from the NRF. The SMF uses the determined MBS service area and determined user
location as follows:
\- The SMF updates the Area Session ID in the locally stored the UE MBS
Session Context with the corresponding Area Session ID if the Area Session ID
is changed.
\- If the target RAN does not support MBS, the Source RAN supported MBS, and
the UE is in a service area of the MBS session, the SMF applies individual
delivery towards the UE. The SMF configures the UPF to send data related to
the Multicast MBS session and service area via the associated PDU session of
the UE. The SMF additionally subscribes at the AMF using the
Namf_EventExposure service to notifications about UE location changes, or to
notifications about the \"UE moving in or out of a subscribed \"Area Of
Interest\"\" event. In the latter case the SMF supplies the service area of
the multicast area session as Area Of Interest. If associated QoS flows are
not yet included in the PDU session, the SMF updates the PDU session with
associated QoS flows.
\- If the UE has moved to another MBS service area of the MBS session:
\- If the target NG-RAN node support MBS after the completion of the handover
procedure, the SMF provides the MBS session related information including the
new Area session ID to NG-RAN via the PDU Session Modification procedure. Per
the received the MBS session related information, the 5GC shared delivery is
established.
\- If the target NG-RAN node does not support MBS, the SMF updates the UPF to
forward the MBS data packets which are received from the tunnel associated
with the new Area Session ID to the target NG-RAN node. If the SMF did not
configure the UPF to receive the MBS data packet from the tunnel associated
with the new Area Session ID before, the SMF informs the MB-SMF of the new
Area Session ID and UPF DL N19mb Tunnel information. MB-SMF configure the MB-
UPF to transmit the Multicast MBS session data towards UPF using the received
downlink tunnel ID. If the SMF subscribed to the \"Area Of Interest\" event,
the SMF also updates the subscription with the new service area as \"Area Of
Interest\".
\- If the UE has moved out of all the MBS service areas of the MBS session:
\- If the target NG-RAN node does not support MBS, the SMF deletes the
associated QoS flow from NG-RAN and UPF after the completion of the handover.
\- Per operator\'s policy (e.g. when a local configured timer expires since
the UE left the whole MBS service area), the SMF may remove the UE from the
MBS session as defined in clause 7.2.2.3. When the UE is removed from the
location dependent MBS session, the SMF also unsubscribes to the AMF from the
notifications about the \"UE moving in or out of a subscribed \"Area Of
Interest\"\" event.
##### 7.2.4.2.4 Activation of location dependent MBS session
When the location dependent MBS session is activated, the MBS session is
activated in the whole MBS service area of the MBS session. It is not
supported that the same MBS session is in Active state in one MBS service area
but in Inactive state in another MBS service area.
NOTE: As an exception, if the MBS session contains service areas served by
several different MB-SMFs, the activation is for all service areas served by
the MB-SMF.
When the MB-SMF is requested by an AF to activate the MBS session in a service
area of the MBS session or the MB-UPF reports detection of data for a service
area of the MBS session, the MB-SMF triggers the activation for all service
areas of the MBS session that it serves, i.e. whole MBS session is activated.
For the location dependent MBS session activation, the differences comparing
to the procedure defined in clause 7.2.5.2 are as below:
\- The SMF invokes Namf_MT_EnableGroupReachability service operation to AMF,
which includes the whole MBS service area associated with the MBS session,
i.e. the sum of all MBS service area associated with the MBS Session ID
regardless of the Area Session ID.
\- For the UE in CM-IDLE state, when the AMF triggers the paging, it take the
receiving MBS service area information into account. Only the NG-RAN nodes
which are included in the MBS service area need to be triggered for paging.
\- SMF checks whether the UE is in or out of the MBS service area based on the
change notification or UE location information included in
Nsmf_PDUSession_UpdateSMContext Request or Namf_MT_UEReachabilityInfoNotify
message. Based on that information, the SMF determines how to activate the MBS
session in the same way as the handling defined in clause 7.2.4.2.3
\- When the SMF provides the MBS session information to the NG-RAN nodes, it
includes the MBS service area, and Area Session ID, in the N2 SM information.
##### 7.2.4.2.5 UE location change handling within the same NG-RAN node
between cells belonging to different MBS service areas during Individual
delivery
If UE has moved out of the MBS service area corresponding to the original Area
Session ID, the SMF checks whether UE is in MBS service area corresponding to
a new Area Session ID within the same MBS session:
\- For the case UE is out of the original MBS service area but in another MBS
service area of the MBS session:
\- If the RAN node does not support MBS and the MBS session is active, the SMF
updates the UPF to forward the MBS data packets which are received from the
tunnel associated with the new Area Session ID to the RAN node. If the SMF did
not configure the UPF receiving the MBS data packet from the tunnel associated
with the new Area Session ID before, the SMF informs the MB-SMF of the new
Area Session ID and UPF DL N19mb Tunnel information. The MB-SMF configure the
MB-UPF to transmit the Multicast MBS session data towards UPF using the
received downlink tunnel ID.
\- The SMF updates the AMF of the area of interest event subscription by
supplying the new MBS service area as Area Of Interest.
\- For the case UE is out of all the MBS service areas of the MBS session:
\- If RAN node does not support MBS, the SMF delete the associated QoS flow
from NG-RAN and UPF.
\- Per operator\'s policy (e.g. when a local configured timer expires since
the UE left the whole MBS service area), the SMF may remove the UE from the
MBS session as defined in clause 7.2.2.3. When the UE is removed from the
location dependent MBS session, the SMF also unsubscribes to the AMF from the
notifications about the \"UE moving in or out of a subscribed \"Area Of
Interest\"\" event.
\- For the case UE comes back to the MBS service area of the multicast MBS
session after moving out of the whole MBS service area of the multicast MBS
session, e.g. before the local configured timer expires:
\- If the UE is still in the multicast MBS session, the SMF adds the
associated QoS flow at NG-RAN and UPF.
##### 7.2.4.2.6 UE location change handling by SMF
When the SMF receives a notification about a UE location change or is becoming
aware of a UE location change (e.g. during handover, Mobility Registration
Update and Service Request procedures), the SMF checks whether the new UE
location is inside or outside all MBS service areas of the location dependent
MBS session:
\- For the case that UE is out of all MBS service area of the location
dependent MBS session:
\- If RAN node does not support MBS, the SMF delete the associated QoS flow
from the RAN node and the UPF.
\- Per operator\'s policy (e.g. when a local configured timer expires since
the UE left the whole MBS service area of the MBS session) the SMF may remove
the UE from the multicast MBS session as defined in clause 7.2.2.3. The SMF
also unsubscribes to the AMF from the notifications about the \"UE moving in
or out of a subscribed \"Area Of Interest\"\" event.
\- For the case UE comes back to MBS service area of the location dependent
MBS session after moving out of the whole MBS service area of the multicast
MBS session, e.g. before the local configured timer expires:
\- If the UE is still in the multicast MBS session and the multicast MBS
session is in Active state, the SMF tries to activate the multicast MBS
session towards the UE.
##### 7.2.4.2.7 UE mobility within the same NG-RAN between cells belonging to
different MBS service areas for shared delivery
When the UE moves from one service area to another served by the same NG-RAN,
the NG-RAN node that supports MBS handles content switching due to mobility
between service areas it serves without interaction with SMF. If it is the
first that UE enters a new location area the RAN node requests shared delivery
from the MB-SMF for the corresponding Area Session ID. If the last UE leaves a
location area the RAN node requests the termination of shared delivery from
the MB-SMF for the corresponding Area Session ID.
UE mobility can happen within the same NG-RAN between cells in or out of all
the MBS service areas:
\- The NG-RAN detects whether the UE is IN or OUT of all MBS service areas of
a location dependent MBS session. If the UE moves in or out of all MBS service
areas of a location dependent MBS session, the NG-RAN notifies the SMF.
NOTE: When the UE joins, the SMF subscribes to the \"Area Of Interest\" event,
and provides the combination of all MBS service areas of location dependent
MBS session as \"Area Of Interest\" (see clause 7.2.4.2.1).
\- When the SMF knows the UE is IN or OUT of all MBS service area of location
dependent MBS session, the SMF behaves as in clause 7.2.4.2.6.
##### 7.2.4.2.8 Void
##### 7.2.4.2.9 Connection Resume procedure
The Connection Resume procedure for the UE is performed as defined in clause
7.2.3.7 with the following additions:
\- For an MBS-supporting target NG RAN
\- The target RAN node obtains MBS session information including an area
session ID from the source RAN node (during the connection retrieval) or the
SMF and initiates the shared delivery establishment (if not established yet)
as specified in clause 7.2.1.4 providing that area session ID. It obtains
information about location areas and related area session IDs during the
shared delivery establishment. The target RAN then applies the procedures in
clause 7.2.4.2.7.
\- For a non MBS-supporting target NG RAN, the SMF subscribes at the AMF using
the Namf_EventExposure service to notifications about UE location changes (if
not yet done), and applies the procedures in 7.2.4.2.5.
#### 7.2.4.3 Support of local MBS for multicast
##### 7.2.4.3.1 Local MBS service area information provided by AF
For local multicast services, the MBS service area information is provided to
the UE and the 5GC as specified in clauses 7.1.1.2 and 7.1.1.3 with the
following differences and clarifications:
\- For the Service Announcement, MBS service area information is included
unless it is preconfigured.
\- When performing the MBS session creation request to the 5GC, the MBS
service area information for a Multicast MBS session is provided by the AF
unless it is preconfigured.
##### 7.2.4.3.2 Multicast session join and session establishment procedure for
local MBS
For the case that the multicast service is only available within a limited
area, the UEs outside the MBS service area are not allowed to join the
multicast service.
The Multicast MBS session join and session establishment for multicast service
available within a limited area are performed as specified in clause 7.2.1.3
with the following differences and clarifications:
\- The local Multicast MBS session has been created where the AF provided the
MBS service area information as specified in clause 7.2.4.3.1.
\- The UE may have information about local multicast service including MBS
service area via Service Announcement as specified in clause 7.2.4.3.1.
\- In step 1, if the UE determines that it is in the MBS service area based on
the information about local multicast service e.g. obtained via Service
Announcement, the UE sends the PDU Session Modification Request (MBS Session
ID) or the PDU Session Establishment Request (MBS Session ID) as a Join
Request to join the multicast group. If the UE determines that it is outside
the MBS service area, the UE does not send the Join Request.
\- In step 3, the SMF obtains the MBS service area (i.e. Cell ID list or TAI
list) of the indicated MBS session from the MB-SMF, and the SMF determines the
indicated MBS session corresponds to local multicast service based on the MBS
service area.
\- In step 5, the SMF checks whether the UE is inside or outside the MBS
service area.
\- The SMF determines whether the UE is inside the MBS service area by
comparing the User Location Information of the UE received from the AMF with
the MBS service area received from the MB-SMF.
NOTE 1: The AMF provides the User Location Information of the UE (cell ID and
current tracking area ID) towards the SMF within
Nsmf_PDUSession_CreateSMContext request and if the location changed also in
Nsmf_PDUSession_UpdateSMContext request (as used for the join) as specified in
clauses 4.3.2.2.1 and 4.3.3.2 of TS 23.502 [6].
\- If the SMF detects that the UE is inside the MBS service area, the SMF
continues the process of multicast session join as specified in clause 7.2.1.3
with the following additions:
\- The SMF sends the UE a PDU Session Modification Command or a PDU Session
Establishment Accept indicating a Join Accept as a response to the Join
Request. The Joint Accept includes the MBS service area (i.e. Cell ID list or
TAI list).
\- The Multicast MBS session information sent by the SMF to the NG-RAN
includes the MBS service area (i.e. Cell ID list or TAI list).
\- If the RAN node serving the UE does not support MBS the SMF applies
individual delivery towards the UE. The SMF configures the UPF to send data
related to the Multicast MBS session via individual delivery within a PDU
session of the UE.
\- If the SMF detects that the UE is outside the MBS service area, the SMF
rejects the multicast session join, so sends a Join Reject to the UE
indicating that the MBS join is rejected. The Joint Reject includes the reject
reason (outside of local service area) and the MBS service area (i.e. Cell ID
list or TAI list).
In this case, the MBS Session establishment (i.e. resources establishment for
MBS traffic delivery) for the UE is not performed.
NOTE 2: There may be the case that the UE determines that it is inside the MBS
service area based on the geographical area information or civic address
information as MBS service area information provided by the AF, so sends a
Join Request but the UE is outside the MBS service area.
NOTE 3: Which SM NAS message is used to deliver the Join Reject (e.g. PDU
Session Modification Reject) is defined in stage 3 specifications.
\- If the Join Request from the UE is accepted, the SMF subscribes to the UE
mobility event notification from the AMF (e.g. UE moving into or out of Area
Of Interest, which is set by MBS service area), by invoking
Namf_EventExposure_Subscribe service operation as specified in clause
5.2.2.3.2 of TS 23.502 [6]. The SMF supplies the service area associated with
the Multicast MBS session as Area Of Interest.
\- For the UE that received the Join Reject from the SMF, later, if the UE
detects that it is inside the MBS service area based on the MBS service area
provided in the Join Reject, the UE sends the PDU Session Modification Request
(MBS Session ID) to join the multicast group.
##### 7.2.4.3.3 Handover procedure with local MBS session
The Handover procedure for the UE is performed as defined in clause 7.2.3 with
the following additions:
\- If the UE is camping at the Source RAN node and receiving multicast data
corresponding to the MBS Session ID via the 5GC Shared MBS traffic delivery
before the Handover, for Xn based handover in clause 7.2.3.2, the Source RAN
node includes MBS Session ID and MBS service area to the Target RAN node
during Handover Preparation phase. For N2 based handover in clause 7.2.3.3,
this step corresponds to Handover Request and Handover Required message,
respectively.
NOTE: During the Xn or N2 handover procedures, if the target RAN node does not
support MBS, the associated QoS flow is established at the Target RAN side
regardless whether the UE is still in the MBS service area.
\- If the UE is camping at the Source RAN node and receiving multicast data
corresponding to the MBS Session ID via the 5GC individual MBS traffic
delivery before the Handover, for the N2 Handover in clause 7.2.3.4, the SMF
includes MBS session area information (MBS Session ID and MBS service area) in
N2 SM information to the Target RAN node in Handover request.
\- If the Target RAN node support MBS, it determines whether to establish the
resources for multicast distribution and data forwarding for MBS Session ID,
based on the received MBS Session ID provided by the source RAN (if source RAN
support MBS) or SMF (if source RAN not support MBS), and target location of
the UE. If UE is not in the in the MBS service area provided by the source RAN
(if source RAN support MBS) or SMF (if source RAN not support MBS), the Target
RAN does not allocate RAN resources, including the resource for data
forwarding, for the multicast MBS Session to the UE.
\- If the target RAN node support MBS, when it determines that the UE is in
the MBS service area and that the shared delivery is not established for the
multicast session ID, the target NG-RAN initiates the shared delivery
establishment as specified in clause 7.2.1.4.
\- When the AMF receives the User Location Information from target RAN node
via the Path Switch Request message or Handover Notify message, the AMF
provide it to the SMF. When the SMF get the User Location Information, the SMF
check the MBS service area of UE camping cell by comparing the User Location
Information received from AMF with the MBS service area received from the MB-
SMF. The SMF uses the determined UE location and MBS service area as follows:
\- The SMF determines whether the UE is outside the MBS service area by
comparing the received Cell ID and tracking area ID with the MBS service area
received from the MB-SMF.
\- If the UE is inside the MBS service area and target RAN node does not
support MBS, the SMF applies individual delivery towards the UE. If associated
QoS flows are not yet included in the PDU session, the SMF updates the PDU
session with associated QoS flows. If the SMF did not configure the UPF to
receive the MBS data packet from the tunnel associated with the Multicast MBS
session before, the SMF informs the MB-SMF of the MBS session and UPF DL N19mb
Tunnel information. MB-SMF configure the MB-UPF to transmit the Multicast MBS
session data towards UPF using the received downlink tunnel ID.
\- If the UE is out of the service area of the MBS session:
\- If the target NG-RAN node does not support MBS, the SMF deletes the
associated QoS flow from NG-RAN node and the UPF after the completion of the
handover procedure.
\- Per operator\'s policy (e.g. when a local configured timer expires since
the UE left the whole MBS service area of the MBS session) the SMF may remove
the UE from the MBS session as defined in clause 7.2.2.3. When the UE is
removed from the local MBS session, the SMF also unsubscribes to the AMF from
the notifications about the \"UE moving in or out of a subscribed \"Area Of
Interest\"\" event.
##### 7.2.4.3.4 Activation of local MBS session
For the local MBS session activation, the differences comparing to the
procedure defined in clause 7.2.5.2 are as below.
\- The SMF invokes Namf_MT_EnableGroupReachability service operation to AMF,
which include the MBS service area associated with the MBS session.
\- For the UE in CM-IDLE state, when the AMF triggers the paging, it takes the
received MBS service area information into account and only triggers the
paging at the NG-RAN nodes which are included in the MBS service area.
\- SMF checks whether the UE is in or out of the MBS service area based on the
change notification or UE location information included in
Nsmf_PDUSession_UpdateSMContext Request or Namf_MT_UEReachabilityInfoNotify
message. Based on that information, the SMF determines how to activate the MBS
session same as the handling when the SMF get the User Location Information
defined in clause 7.2.4.3.3.
\- When the SMF provides the MBS session information to the NG-RAN nodes, it
includes the MBS service area in the N2 SM information.
##### 7.2.4.3.5 UE location change handling by SMF
When the SMF receives a notification about a UE location change or is becoming
aware of a UE location change (e.g. during handover, Mobility Registration
Update and Service Request procedures), the SMF checks whether the new UE
location is inside or outside the MBS service area of the MBS session.
\- For the case UE is out of the MBS service area of the MBS session:
\- If RAN node does not support MBS, the SMF delete the associated QoS flow
from the RAN node and the UPF.
\- Per operator\'s policy (e.g. when a local configured timer expires since
the UE left the MBS service area of the MBS session) the SMF may remove the UE
from the multicast MBS session as defined in clause 7.2.2.3. When the UE is
removed from the local MBS session, the SMF also unsubscribes to the AMF from
the notifications about the \"UE moving in or out of a subscribed \"Area Of
Interest\"\" event.
\- For the case UE comes back to the MBS service area of the multicast MBS
session after moving out of the MBS service area of the multicast MBS session,
e.g. before the local configured timer expires:
\- If the UE is still in the multicast MBS session and the multicast MBS
session is in Active state, the SMF tries to activate the multicast MBS
session towards the UE.
##### 7.2.4.3.6 UE mobility within the same NG-RAN between cells in or out of
the MBS service area
If UE mobility can happen within the same NG-RAN between cells in or out of
the service area,
\- The NG-RAN detects whether the UE is IN or OUT of an MBS service area and
notifies the SMF if the UE moves in or out of the MBS service area.
NOTE: When the UE joins, the SMF subscribes to the \"Area Of Interest\" event
(see clause 7.2.4.3.2).
\- When the SMF knows the UE is IN or OUT of an MBS service, the SMF behaves
as in clause 7.2.4.3.5.
##### 7.2.4.3.7 Void
##### 7.2.4.3.8 Connection Resume procedure with local MBS session
The Connection Resume procedure for the UE is performed as defined in clause
7.2.3.7 with the following additions:
\- The source RAN, if supporting MBS and if the MBS session is active,
provides MBS service area to the target RAN during the UE Context Retrieval
procedure;
\- An MBS supporting target RAN then applies the procedures in clause
7.2.4.3.6.
\- The SMF applies the procedures in clause 7.2.4.3.5.
### 7.2.5 MBS session activation and deactivation
#### 7.2.5.1 General
MBS Session activation procedure is for multicast only. MBS Session activation
procedure is triggered by MB-SMF, when it receives the notification from MB-
UPF for the downlink MBS DL data, or when it receives the request directly
from AF or via NEF. The MBS Session activation procedure is used for
activating the resources for MBS data at NG-RAN node. The multicast session
state transits from Inactive to Active after MBS Session activation procedure,
see clause 4.3.
MBS Session deactivation procedure is for multicast only. MBS Session
deactivation procedure is triggered by MB-SMF, when it receives the
notification from MB-UPF in the case that there is no downlink data to be
transmitted for some duration, or when it receives the request directly from
AF or via NEF. The MBS Session deactivation procedure is used for deactivating
the resources for MBS data at NG-RAN node. The multicast session state
transits from Active to Inactive after MBS Session deactivation procedure, see
clause 4.3.
#### 7.2.5.2 MBS session activation procedure
The following can trigger the MBS session activation procedure:
\- AF requests MB-SMF to activate the MBS session;
\- MB-UPF receives the multicast data and notifies MB-SMF.
Figure 7.2.5.2-1: MBS session activation procedure
In this procedure, steps 11 to 15 are executed if the MB-SMF finds out there
are shared tunnel established. Steps 11 to 15, if needed, are executed in
parallel with steps 2 to 10.
1\. The procedure may be triggered by the following events:
\- When the MB-UPF receives downlink data for a multicast MBS session, based
on the instruction from the MB-SMF (as described in clause 7.2.5.3), the MB-
UPF sends N4mb Notification (N4 Session ID) to the MB-SMF for indicating the
arrival of DL MBS data.
\- The AF sends MBS Activation request (TMGI) to the MB-SMF directly or via
NEF.
2\. MB-SMF sends Nmbsmf_MBSSession_ContextStatusNotify (MBS Session ID,
multicast session state = Active) to SMF(s).
The SMF sets the related multicast MBS session state to Active and finds out
the list of UEs that joined the multicast MBS session identified by the
related TMGI. If the SMF determines the user plane of the associated PDU
session(s) of the UE(s) with respect to the TMGI are activated already, steps
3-8a will be skipped for those UE(s), i.e. executed from step 8b.
3\. The SMF invokes Namf_MT_EnableGroupReachability Request (List of UEs, [PDU
Session ID of the associated PDU Sessions], TMGI, [UE reachability
Notification Address], [most demanding ARP, 5QI of all MBS QoS Flow within MBS
session])) to AMF(s). When later UE is reachable, the UE reachability
Notification Address is used by the AMF to identify and notify the related
SMF.
After receiving the request, for each UE in the list, the AMF determines CM
state of the UE: see steps 4 - 7.
4a. If there are UEs involved in the multicast MBS Session and in CM-CONNECTED
state, the AMF indicates those UEs to the SMF, using
Namf_MT_EnableGroupReachability Response (UE list). Otherwise, the response
does not include UE list.
4b. For each UE in the UE list included in step 4a, if the QoS profile(s) for
associated PDU Session has not yet been provided, the SMF invokes
Namf_Communication_N1N2MessageTransfer (N2 SM information (PDU Session ID, MBS
Session ID, [QoS profile(s) for associated QoS flow(s)], [mapping information
between the unicast QoS flow and multicast QoS flow])) to the AMF for the UE
which is identified in step 4a. The associated unicast QoS Flow(s) as well as
the mapping information between the unicast QoS Flow(s) and multicast QoS
Flow(s) are included to support the 5GC Individual MBS traffic delivery.
The SMF may also include the MBS assistance information for the MBS session in
N2 SM Information, if the MBS subscription data from the UDM contains the MBS
assistance information which includes the ID(s) of the MBS session(s) that the
UE joined. The MBS assistance information for MBS session sent to the NG-RAN
is described in clause 6.16.
The procedure continues at step 9.
5\. [Conditional] If AMF determines that there are UEs in CM-IDLE state and
involved in the multicast MBS Session, the AMF figures out the paging area
covering all the registration areas of those UE(s), which need to be paged.
The AMF may apply paging differentiation as specified in clause 6.12. The AMF
sends a Multicast Group paging request message to the NG-RAN node(s) belonging
to this Multicast Paging Area with the involved UE list and TMGI as the
identifier to be paged if the related NG-RAN node(s) support MBS. If the AMF
knows that the NG-RAN node(s) do not support MBS based on configuration, the
AMF sends Paging message(s) to the NG-RAN node(s) per UE as described in step
4b in clause 4.2.3.3 of TS 23.502 [6].
NOTE 1: In addition to the paging in clause 6.12, other paging strategies is
up to AMF implementation.
NOTE 2: The details of the paging are specified by the RAN WGs.
NOTE 3: CM-IDLE UEs using power saving function are included by the AMF in
group paging as specified in clause 7.2.10.
6\. Receiving the paging, the UE(s) in CM-IDLE state sends Service Request
message to the AMF, see clause 4.2.3 of TS 23.502 [6].
NOTE 4: Step 6 for a UE can be parallel to step 5 for another UE(s), which has
not received any paging yet.
After receiving the Service Request sent by the UE(s),
\- Either based on the received PDU Session ID in step 3, the AMF invokes
steps 7a/7b to update the related PDU sessions; or:
\- Based on the received UE reachability Notification Address in step 3, the
AMF identifies and notifies the related SMF of the UE(s), which are reachable
now and the Location Information, by using the
Namf_MT_UEReachabilityInfoNotify message. In this case, it can be a separated
notification or combined with step 8.
7a/7b. Based on the received PDU Session ID in step 3, the AMF identifies the
related SMF and invokes Nsmf_PDUSession_UpdateSMContext request. The SMF
replies with Nsmf_PDUSession_UpdateSMContext response.
The SMF may also include the MBS assistance information for the MBS session in
N2 SM Information, if the MBS subscription data from the UDM contains the MBS
assistance information which includes the ID(s) of the MBS session(s) that the
UE joined. The MBS assistance information for MBS session sent to the NG-RAN
is described in clause 6.16. The procedure then continues at step 9.
8a. For UE(s) that do not respond to paging, the AMF informs the SMF of the
paging failure in Namf_MT_UEReachabilityInfoNotify.
8b. For UE(s) that is indicated as reachable via the
Namf_MT_UEReachabilityInfoNotify message, or user plane of the associated PDU
session is activated already but the QoS profile(s) for associated QoS flow(s)
needs to be provided for the PDU session, the SMF invokes
Namf_Communication_N1N2MessageTransfer (N2 SM information ()) to the AMF same
as described in step 4b.
The SMF may also include the MBS assistance information for the MBS session in
N2 SM Information, if the MBS subscription data from the UDM contains the MBS
assistance information which includes the ID(s) of the MBS session(s) that the
UE joined. The MBS assistance information for MBS session sent to the NG-RAN
is described in clause 6.16.
9\. The AMF sends N2 request message (N2 SM information ()) to the RAN node.
NOTE 5: A joined UE is not able to receive MBS data if NG-RAN rejects the PDU
Session Resource setup request (due to implementation specific reasons, e.g.
activation of user plane fails due to the number of UEs reaching a limit).
10a. If the shared tunnel has not been established before, the shared tunnel
is established at this step, as defined in clause 7.2.1.4. The NG-RAN
configures UE with RRC messages if needed.
In this step or at later stage, NG-RAN may determine whether to apply delivery
enabling reception by UEs in RRC_INACTIVE state for the MBS session, as
defined in clause 6.16.
NOTE 6: Whether and when the NG-RAN determines to apply delivery enabling
reception by UEs in RRC_INACTIVE state for the MBS session as defined in
clause 6.16 is to be decided by NG-RAN.
10b. Steps 8 to 12 defined in clause 7.2.1.3 are performed. If 5GC Individual
MBS traffic delivery is used, the SMF configures the UPF for individual
delivery and if necessary, requests the MB-SMF to configure the MB-UPF to send
multicast data to the UPF.
11\. If the MB-SMF finds out there are shared tunnel established, step11-15
are performed. The MB-SMF invokes Namf_MBSCommunication_N2MessageTransfer
Request (TMGI, N2 SM Information (Activation, TMGI)) to the AMF for those NG-
RAN nodes, which have shared tunnel with MB-UPF. This step may be performed in
parallel with step 2.
NOTE 7: The messages in steps 10a, 11 and 12 are MBS-specific and it is
possible that the AMF(s) in steps 10a, 11 and 12 are not associate to any UEs
involved in the multicast MBS Session.
12\. The AMF sends NGAP activation request message (N2 SM Information ()) to
the NG-RAN nodes. For those UEs that have joined in the MBS Session and are in
RRC_INACTIVE state, the RAN nodes perform RAN paging as specified in TS 38.300
[9].
NOTE 8: UEs in RRC_INACTIVE state are to be considered for RAN paging related
to an MBS session even if those UEs are using power saving functions, e.g.
MICO (Mobile Initiated Connection Only) mode with Active Time, or extended DRX
(Extended Discontinuous Reception) as defined in clause 5.31.7 of TS 23.501
[5].
13\. The NG-RAN nodes responses to AMF by NGAP activation response message.
The NG-RAN nodes establish radio resources to transmit multicast MBS session
data to the UE(s).
In this step or at later stage, NG-RAN may determine whether to apply delivery
enabling reception by UEs in RRC_INACTIVE state for the MBS session, as
defined in clause 6.16.
NOTE 9: Whether and when the NG-RAN determines to apply delivery enabling
reception by UEs in RRC_INACTIVE state for the MBS session as defined in
clause 6.16 is to be decided by the NG-RAN.
If the NG-RAN determines that a UE receives the multicast MBS data in
RRC_CONNECTED state, the NG-RAN shall not release the radio connection of a UE
that has joined into the Multicast MBS session only because no unicast traffic
is received for the UE.
14\. AMF to MB-SMF: Namf_MBSCommunication_N2MessageTransfer Response ().
15\. The MB-SMF sends N4mb Session Modification Request to the MB-UPF to
forward the received MBS packets. The MB-UPF responds to the MB-SMF with N4mb
Session Modification Response acknowledging the MB-SMF request.
NOTE 10: Depending on implementation, step 15 can be executed after the first
successful response in step 14 to shorten the activation time, or buffering at
the MB-UPF can be applied sufficiently long for the majority of RAN nodes to
activate the MBS session to reduce packet loss.
#### 7.2.5.3 MBS session deactivation procedure
Figure 7.2.5.3-1: MBS session deactivation procedure
In this procedure, steps 3 to 4 and steps 5 to 9 are executed in parallel.
1\. The procedure may be triggered by the following events:
\- When MB-UPF detects there is no data receives for the MBS Session, MB-UPF
sends MB-N4 Notification (N4 Session ID) to the MB-SMF for deactivating the
MBS session.
\- AF sends MBS Deactivation request (TMGI) to the MB-SMF directly or via NEF.
2\. The MB-SMF sends an N4mb Session Modification Request (TMGI, [Buffered
Downlink Traffic detection]) to the MB-UPF. The Buffered Downlink Traffic
detection is requested by MB-SMF to be informed by the MB-UPF about incoming
MBS data. The MB-SMF triggers MBS session activation once informed. If the MBS
session is to be activated via the AF request directly, the Buffered Downlink
traffic detection is not needed, but the MB-SMF still instructs the MB-UPF to
stop forwarding and possibly to buffer MBS data.
MB-UPF to MB-SMF: N4mb Session Modification Response acknowledging the MB-SMF
request.
NOTE 1: It is up to stage 3 to determine whether MB-UPF keeps the DL F-TEID(s)
for N3mb and N19mb interfaces.
3\. The MB-SMF sends Nmbsmf_MBSSession_ContextStatusNotify request (MBS
Session ID) to the SMFs.
Based on the received MBS Session ID, the SMF sets the indicated multicast MBS
session state to Inactive:
‐ If the SMF finds out there are UE(s) that joined the indicated multicast MBS
session and use 5GC Individual MBS traffic delivery, step 4 is performed for
those UE(s).
‐ If SMF find there are no UE(s) that joined the indicated MBS session and use
5GC Individual MBS traffic delivery, no further operation for SMF is required.
4a. [Conditional] For UE(s) for which the 5GC individual delivery is used,
step 3b and steps 4-8 in clause 4.3.3.2 of TS 23.502 [6] are performed to
remove the associated QoS flow(s) related to the multicast MBS session.
NOTE 2: Whether the associated QoS Flow(s) are removed from UE, NG-RAN, or
only resource in NG-RAN is removed is up to implementation.
4b [Conditional] For UE(s) for which the 5GC individual delivery is used, the
related SMF(s) may keep the shared tunnel that is used for Individual MBS
traffic delivery over N19mb interface. If the SMF decides to release the
shared tunnel, steps 3 to 6 in clause 7.2.2.2 need to be performed.
5\. If the MB-SMF finds out there are shared tunnel established over N3mb
interface, the MB-SMF sends Namf_MBSCommunication_N2MessageTransfer Request
(TMGI, N2 SM information (Deactivation, TMGI)) to the AMFs.
6\. The AMF sends NGAP deactivation request message (N2 SM information ()) to
the NG-RAN nodes.
7\. The NG-RAN node keeps the multicast MBS Session Context and N3mb shared
tunnel for the multicast MBS session.
If the MBS Session Context indicates no UE for the multicast MBS session (e.g.
due to UE becomes CM-IDLE state), the NG-RAN triggers release of the shared
delivery as described in clause 7.2.2.4.
8\. NG-RAN acknowledges the NGAP deactivation Response message.
9\. The AMF invokes Namf_MBSCommunication_N2MessageTransfer Response to
acknowledge the service for MB-SMF.
When the MBS session is in \"Inactive\" state and handover procedure is
triggered, it is defined in clause 7.2.3.6.
NOTE 3: There is no explicit \"deactivation\" indication to the UE, how the UE
is changed to IDLE state is defined in TS 38.300 [9].
### 7.2.6 Multicast session update procedure
Multicast MBS session update procedure is invoked by the AF to update the
service requirement (result in multicast QoS parameters update and/or
multicast QoS flow addition/removal) and/or MBS Service Area for an ongoing
Multicast MBS session.
If the MBSF acts as the MBS security function for multicast as defined in TS
33.501 [20], it may use this procedure to provide an updated MSK and optional
updated MTK in addition for the MBS session via the control plane.
NOTE: The procedure is not applicable if no MSK but only the MTK is to be
updated.
For the interaction between AF or MBSF and MB-SMF, see clauses 7.1.1.6 and
7.1.1.7.
Figure 7.2.6-1: Multicast MBS Session update procedure
1\. This procedure is triggered by the MB-SMF receiving the updated service
requirement, an updated multicast session security context from the MBSF
and/or MBS Service Area for a multicast MBS Session, see clauses 7.1.1.6 and
7.1.1.7.
2\. The AF providing the updated service area may also inform UEs at
application level about the new service area via a service announcement.
NOTE 1: If a UE is located in a cell which was previously outside the service
area and is now inside the updated service area, the UE can join the multicast
service as specified in clause 7.2.1.3.
For QoS updates steps 3 to 7 are performed.
For MBS Service Area update steps 3 to 7 may be performed to allow NG-RAN to
terminate data transmission in the area which is no longer in the MBS Service
Area.
3\. The MB-SMF invokes Namf_MBSCommunication_N2MessageTransfer service
operation (MBS Session ID, [Area Session ID], N2 SM message container (TMGI,
[QoS profile(s) for multicast MBS session], [MBS Service Area], [Area Session
Id])) to the AMF(s).
4\. The involved AMF sends N2 MBS session request (N2 SM message container) to
NG-RAN nodes handling the multicast MBS session and possible Area Session ID
based on the RAN node IDs stored in the AMF for the MBS session.
5\. The NG-RAN node updates the QoS profile and/or MBS Service Area for the
multicast MBS session based on the N2 MBS session request. If only QoS
parameters are updated without multicast QoS flows added/removed, the NG-RAN
may also update the QoS parameters of the associating PDU Sessions.
For MBS Service Area update, the NG-RAN updates the MBS Session Context with
the updated MBS Service Area. The NG-RAN stops transmission of the related
multicast data in the cell(s) which is within the old MBS Service Area but now
outside the updated MBS Service Area. The NG-RAN also configures the UE not to
receive the MBS data over the radio interface if the NG-RAN detects the UE(s)
was in the previous MBS Service Area but is outside the updated MBS Service
Area. If the NG-RAN node no longer serves any cells within the updated MBS
service area, it requests to release shared delivery resource as defined in
clause 7.2.2.4.
6\. The NG-RAN node(s) acknowledges N2 MBS session request by sending an N2
MBS session Response message to the AMF.
7\. The AMF invokes the Nmbsmf_MBSSession_ContextUpdate () to the MB-SMF.
8\. The MB-SMF sends Nmbsmf_MBSSession_ContextStatusNotify request (MBS
Session ID, [QoS profiles for multicast for MBS session], [MBS Service Area],
[Area Session ID], [updated multicast session security context]) to the SMFs.
For MBS Service Area updates, if an Area Session ID exists, the MB-SMF
provides the MBS Service Area corresponding to the Area Session ID to the SMFs
involved in the multicast MBS session. For QoS updates, the MB-SMF notifies
SMFs handling all MBS service areas.
9\. The SMF determines the affected UEs it serves based on the multicast MBS
Session ID and Area Session ID (if provided) received in the step 8.
The subsequent steps 10 to 12 are executed for each affected UE. For QoS
updates, steps 10 and 11 are skipped.
10\. [Conditional] For an MBS Service Area update, if the SMF previously
subscribed at the AMF to notifications about the UE moving in or out of a
subscribed \"Area Of Interest\", the SMF updates the subscription with the new
MBS Service Area as area of interest.
11\. [Optional] When the MBS Service Area is updated, if the SMF does not have
the latest UE location, the SMF queries AMF which then query the NG-RAN for
the current location of the UE to determine whether the UE is within the
updated MBS Service Area.
12\. [Conditional] For QoS Updates, if the 5GC Individual MBS traffic delivery
is used, or if the associated QoS flows is to be added/removed, the SMF
triggers PDU Session Modification procedure as defined in TS 23.502 [6]. If
the 5GC Individual MBS traffic delivery is used, the SMF may also configure
the UPF with the updated QoS and/or updated or removed QoS flows.
For MSK updates, the SMF also triggers PDU Session Modification procedure and
provides the updated multicast session security context in the N1 SM
container.
For MBS Service Area update, the SMF triggers the PDU Session Modification
procedure as defined in TS 23.502 [6] with the following enhancement:
\- The SMF also updates the PDU session resources associated to the multicast
MBS session with the new MBS service area in an N2 container. The RAN node
serving the PDU session starts or terminates transmission of multicast content
in cells which are added or removed in the updated service area, respectively,
and if necessary, interacts with the MB-SMF to start or terminate the
distribution of multicast data to the RAN node.
\- Towards the UE, the SMF provides the MBS service area in N1 SM container to
the UE. For a UE previously inside the MBS service area but now outside the
updated MBS service area of the multicast MBS session, the SMF may
alternatively, based on operator policy, inform the UE in the N1 SM container
that the UE has been removed from the multicast MBS session.
\- Towards the NG-RAN, the SMF provides the updated MBS service area in N2 SM
information. For a NG-RAN node supporting MBS, it starts transmission of
multicast content in cells which are added in the updated MBS service area if
UEs within the Multicast MBS session are within those cells, and if necessary,
the NG-RAN interacts with the MB-SMF to start the distribution of multicast
data to the RAN node. The RAN node stops transmission of multicast content in
cells which are removed from the updated MBS service area, and if necessary,
the NG-RAN interacts with the MB-SMF to terminate the distribution of
multicast data to the RAN node
\- For Individual delivery and a local Multicast MBS session the following
applies: For a UE previously inside the service area but now outside the
updated MBS service area, the SMF removes associated unicast QoS flows for the
multicast MBS session. For a UE previously outside the service area but now
inside the updated service area, the SMF adds associated unicast QoS flows for
the multicast MBS session to the PDU session resources.
### 7.2.7 Void
### 7.2.8 Service request procedure
If the multicast MBS session is in Inactive state, the UE can go to CM-IDLE
state or the user plane of the associated PDU Session may be deactivated even
when the UE is in CM-CONNECTED state. When user plane of the associated PDU
session is activated again, the SMF sends the MBS session information to NG-
RAN during Service Request procedure as specified in TS 23.502 [6]. The MBS
session information indicates that this MBS session is in Inactive state; and:
\- For the MBS supporting NG-RAN node, the NG-RAN establish the shared tunnel
with the MB-UPF as usual. However, as the MBS session is in Inactive state,
the NG-RAN node will not allocate related radio resource.
\- For the non-MBS supporting NG-RAN node, the unicast QoS flow associated
with the MBS session are not established.
The service request procedure can also be executed while the multicast MBS
session is in Active state: The UE can go to CM-IDLE state due to AN release
as specified in TS 23.502 [6]. In addition, to activate the associated PDU
session(s) parts of the service request procedure can also be executed during
the Mobility Registration Update procedure as specified in clause 4.2.2.2.2 of
TS 23.502 [6]. When the service request procedure is executed, the SMF
provides the MBS session information indicating that the UE joined the MBS
session to the NG-RAN within N2 SM container for the associated PDU Session.
NOTE: Network triggered Service Request, if triggered for other reason, can
also be used by the SMF to provide that MBS session information to NG-RAN.
### 7.2.9 AF provisioning multicast MBS Session Authorization information
The AF provisions the multicast MBS session authorization information for
multicast MBS sessions that are not open to \"any UE\". The procedure
specified in clause 4.15.6.2 of TS 23.502 [6] is reused with the following
enhancements:
\- The AF may provision the MBS Session Authorization information to the 5GC.
The MBS Session Authorization information is associated with a group of UEs.
Table 7.2.9-1: MBS Session Authorization information
Parameters Description
* * *
MBS Session Authorization information One or more MBS Session IDs. A group of
UEs identified by an External Group ID.
\- The AF may support multicast MBS group membership management and provide
parameters as described in Table 7.2.9-2.
Table 7.2.9-2: Multicast MBS group membership management parameters
Parameters Description
* * *
List of GPSI List of multicast group members, each member is identified by
GPSI. External Group ID Identifier for multicast MBS group.
\- If a new multicast MBS group is created, the UDM shall assign a unique
Internal Group ID for the multicast MBS group and include the newly assigned
Internal Group ID in the Nudr_DM_Create Request message.
\- If the AF is authorised by the UDM to provision the MBS Session
Authorization information, the UDM resolves the GPSI of each MBS session group
member to SUPI, and requests to create, update or delete the provisioned MBS
Session Authorization information as part of the MBS subscription data for
each SUPI via Nudr_DM_Create/Update/Delete Request message, and the message
includes the provisioned MBS Session Authorization information.
### 7.2.9a AF provisioning MBS Session assistance information
After the AF obtains the MBS Session ID of a multicast MBS Session as
specified in clauses 7.1.1.2 and 7.1.1.3, the AF may provision the MBS Session
assistance information for the UE(s) via NEF to UDM using the procedure of
external parameter provisioning as specified clause 4.15.6.2 of TS 23.502 [6]
with the following enhancements:
\- the AF may provision MBS Session Assistance Information, which indicates
that a UE is preferred to be kept connected when the related MBS Session the
UE joined is active.
Table 7.2.9a-1: MBS Session Assistance information
Parameters Description
* * *
MBS Session Assistance information A list of UEs represented by GPSIs that are
preferred to be kept connected when the MBS Session represented by the
indicated MBS session ID the UE joined is active. MBS Session ID.
NOTE 1: MBS Session Assistance information has no effect if the function of UE
receiving MBS multicast in RRC_INACTIVE state is not used. The AF does not
provision the MBS Session assistance information if the AF knows that the PLMN
does not support the function of UE receiving MBS multicast in RRC_INACTIVE
state.
NOTE 2: The AF can provide the MBS Session assistance information for the UEs
based on observed or expected UE data transmission behaviour, e.g., a frequent
talker and/or the group leader of a multicast group represented by an MBS
Session ID.
NOTE 3: If the MBS Assistance Information is already available when a UE joins
a multicast MBS Session, the SMF provides the information to the NG-RAN in the
UE join procedure as specified in clause 7.2.1.3. If the MBS Assistance
Information becomes available in the UDM, the UDM performs procedure of
Session Management Subscriber Data Update Notification to SMF as specified in
clause 4.5.2 of TS 23.502 [6] per subscription data change notification
requested by the SMF.
If the AF is authorised by the UDM to provision the UE list MBS Assistance
information, the UDM resolves the GPSI to SUPI, and requests to create, update
or delete the provisioned UE list MBS Assistance information as part of the
MBS subscription data for each SUPI.
### 7.2.10 Multicast MBS procedures for UEs using power saving functions
Editor\'s note: Alignment may be needed with RAN WG(s).
For a UE using power saving function to receive multicast MBS Session data,
the following applies:
\- For an MBS multicast session, a UE needs to join the multicast session as
defined in clause 7.2.1.3 prior to MBS data reception. To join the multicast
session, the UE needs to be in RRC_CONNECTED state. The UE may select any
suitable time when it is in RRC_CONNECTED state or transition to RRC_CONNECTED
state before joining the multicast session.
NOTE 1: If the UE has not previously joined the MBS multicast session, at the
possible scheduled activation time it performs MBS join procedure. Whether the
UE performs MBS join procedure in advance and stays \"joined\" or every time
at activation time is left up to UE implementation.
\- If a UE is in RRC_CONNECTED state or in CM-IDLE state or CM-CONNECTED with
RRC_INACTIVE state, and reachable (e.g., in active time in MICO or PTW for
eDRX), due to other reasons at the start time and the scheduled activation
times, the UE follows the related MBS procedures (e.g., clause 7.2.1 for UE
join and clause 7.2.5.2 for MBS Session Activation) with the following
enhancement:
\- At MBS Session Activation, when the AMF perform group paging, the AMF also
includes the CM-IDLE UEs using power saving function(s).
\- If a UE is in CM-IDLE state or CM-CONNECTED with RRC_INACTIVE and in deep
sleep (i.e., unreachable for paging to the network) at the possible start time
and the possible scheduled activation times, the UE leaves the deep sleep
state at the session start time and the possible scheduled activation times to
allow MBS related procedures (e.g., clause 7.2.1 for UE join and clause
7.2.5.2 for MBS Session Activation):
\- At the possible start time, an RRC_IDLE or CM-CONNECTED with RRC_INACTIVE
UE needs to send a request to transition to RRC_CONNECTED state and join the
MBS multicast session (if not done before).
NOTE 2: The UE become reachable in the network for the unicast service as
well.
\- At the possible scheduled activation times, an RRC_IDLE UE that already
joined the multicast MBS session needs to listen for paging requests and if
paged by the network follow the existing procedures in clause 7.2.5.2. How
long the device listens to paging is left up to device implementation.
NOTE 3: How long the UE need to listen to paging is left up to UE
implementation.
\- When the UE is in the middle of an MBS data transfer, and the UE is
scheduled to move to deep sleep due to power saving, e.g. end of PTW for
extended idle mode DRX, expiration of active time for MICO or the UE
transitioning from CM-CONNECTED to CM-IDLE in the case of MICO with no active
time, then the UE does not go to deep sleep during the remainder of the
current MBS data transfer.
NOTE 4: If at the end of the current MBS data transfer the UE knows there is
another MBS data transfer scheduled soon, depending on the time between MBS
data transfers, the UE can decide to go to sleep between MBS data transfers.
## 7.3 MBS procedures for broadcast Session
NOTE: The interactions between the MBSF, the MBSTF and the AF, for example
file delivery and HTTP adaptive streaming, will be defined in TS 26.502 [18]
and TS 26.517 [22].
### 7.3.1 MBS Session Start for Broadcast
The Broadcast MBS Session Start follows the common procedure specified in
clause 7.1.1.2 or clause 7.1.1.3, which consist of TMGI Allocation and MBS
Session Create. It is possible for AF to allocate TMGI once but create the MBS
Session for multiple times. A combined procedure to perform both TMGI
allocation and MBS Session Create is available.
The TMGI Allocation is used by AF to obtain the TMGI as MBS Session ID (i.e.
TMGI) and perform service announcement towards UEs.
The MBS Session Create (with MBS service type set to broadcast service) is
used by the AF to indicate the impending start of the transmission of MBS
data, and to provide the session attributes, so that resources for the MBS
Session are set up in the MB-UPF and in the NG-RAN for 5GC Shared MBS traffic
delivery. The MBS Session Create can be used if TMGI has not been allocated.
In this case, MB-SMF will allocate a unique TMGI for the AF and then start the
MBS Session.
NOTE 1: When the multicast transport between NG-RAN and MB-UPF is described
below, source specific multicasting is assumed.
To receive the data of broadcast communication service, the UE is either
preconfigured with needed configuration (e.g. USD as defined in TS 26.346
[13]) for the UE to receive MBS service, or provisioned with the configuration
of Broadcast MBS session on application level (service announcement; the
configuration may for instance be performed using SIP signalling, or methods
described in TS 26.346 [13]). If the needed configuration is pre-configured,
the UE does not need to interact with network.
Figure 7.3.1-1: MBS Session Establishment for Broadcast
0 Based on OAM configuration, RAN nodes announce in SIBs over the radio
interface information about the MBS FSA IDs and frequencies of neighbouring
cells.
1\. To establish broadcast MBS session, the AF performs TMGI allocation and
MBS session creation as specified in clause 7.1.1.2 or 7.1.1.3. The MBS
service type indicates to be broadcast service. The MBS FSA ID(s) of a
broadcast MBS session are communicated in the service announcement towards the
UE. The UE compares those MBS FSA IDs(s) with the MBS FSA ID(s) in SIBs for
frequency selection.
2\. The MB-SMF may use NRF to discover the AMF(s) supporting MBS based on the
MBS service area and select the appropriate one(s). Then the MB-SMF sends the
Namf_MBSBroadcast_ContextCreate (TMGI, N2 SM information ([LL SSM], 5G QoS
Profile), MBS service area, [MBS FSA ID(s)]) messages to the selected AMF(s)
in parallel if the service type is broadcast service. The MB-SMF may include a
maximum response time in the request.
3\. The AMF transfers the MBS Session Resource Setup Request message, which
contains the N2 SM information in the received Namf_MBSBroadcast_ContextCreate
Request to all NG-RANs which support MBS in the MBS service area. The AMF
includes the MBS service area.
4\. NG-RAN creates a Broadcast MBS Session Context and stores the TMGI and the
QoS Profile in the MBS Session Context. The LL SSM are optional parameters and
only provided by MB-SMF to NG-RAN if N3mb multicast transport is configured to
be used in the 5GC. If MBS FSA ID(s) were received, the NG-RAN may use those
MBS FSA ID(s)s to determine cells/frequencies within the MBS service area to
broadcast MBS session data based on OAM configuration about the MBS FSA IDs
and related frequencies.
Depending on the NG-RAN\'s preference to use multicast or unicast transport
over N3mb and the availability of the LL SSM, step 5a or step 5b is executed.
5a. If NG-RAN prefers to use N3mb multicast transport (and if LL SSM is
available in NG-RAN), the NG-RAN joins the multicast group (i.e. LL SSM).
5b. If NG-RAN prefers to use N3mb unicast transport (or if the LL SSM is not
available in NG-RAN) between the NG-RAN and MB-UPF, NG-RAN allocates its N3mb
DL Tunnel endpoint to receive downlink MBS session data.
6\. The NG-RAN reports successful establishment of the MBS Session resources
(which may include multiple MBS QoS Flows) by sending MBS Session Resource
Setup Response (TMGI, N2 SM information ([N3mb DL Tunnel Info])) message(s) to
the AMF. If NG-RAN prefers to use N3mb unicast transport (or if the LL SSM is
not available in NG-RAN) between the NG-RAN and MB-UPF, NG-RAN provides its
N3mb DL Tunnel Info as part of the N2 SM information. For more details, refer
to TS 38.413 [15].
7\. The AMF transfers the Namf_MBSBroadcast_ContextCreate Response () to the
MB-SMF. The AMF should respond success when it receives the first success
response from the NG-RAN(s). And if all NG-RAN(s) report failure, the AMF
should respond failure. The MB-SMF stores the AMF(s) which responds success in
the MBS Session Context as the downstream nodes. If the AMF receives the NG-
RAN response(s) from all involved NG-RAN(s), the AMF should include an
indication of completion of the operation in all NG-RANs. If received from NG-
RAN node, the N3mb DL Tunnel Info and NG-RAN ID are included in the response.
8\. [Conditional] If N3mb unicast transport is to be used (i.e. N3mb DL Tunnel
Info is present in the Namf_MBSBroadcast_ContextCreate Response message from
AMF) in a deployment where NG-RAN nodes share a common user plane entity, the
MB-SMF only establishes the shared tunnel towards the DL GTP tunnel endpoint
if the shared tunnel has not yet been established (as determined based on the
stored DL GTP Tunnel endpoint(s) for the MBS session). The MB-SMF also stores
the received DL GTP Tunnel and corresponding NG-RAN Node ID for the MBS
session. For the deployment where NG-RAN nodes do not share a common user
plane entity, the DL GTP tunnel will not be used by other NG-RAN nodes. In a
deployment where NG-RAN nodes do not share a common user plane entity, the MB-
SMF always establishes the shared tunnel towards the DL GTP tunnel endpoint.
To establish the shared tunnel towards the DL GTP tunnel endpoint, the MB-SMF
sends an N4mb Session Modification Request to the MB-UPF to allocate the N3mb
unicast transport tunnel for a replicated MBS stream for the MBS Session.
8a-8b. If the AF subscribed to a Delivery Status Indication (see clause
7.3.5), the MB-SMF notifies the AF as specified in step 2 of clause 7.3.5. The
MB-SMF notifies the AF The MB-SMF notifies the AF directly by invoking
Nmbsmf_MBSSession_StatusNotify service operation, or the MB-SMF notifies the
AF via NEF/MBSF (if deployed) by invoking Nmbsmf_MBSSession_StatusNotify
service operation to the NEF/MBSF which then invokes
Nnef_MBSSession_StatusNotify service operation to the AF.
9\. NG-RAN broadcasts the TMGI representing the MBS service over radio
interface. Step 9 can take place in parallel with step 6.
10\. Another NG-RAN may report successful establishment of the MBS Session
resources (which may include multiple MBS QoS Flows) by sending MBS Session
Resource Setup Response (TMGI, N2 SM information ([N3mb DL Tunnel Info]))
message after the AMF transferred the Namf_MBSBroadcast_ContextCreate Response
() to the MB-SMF.
11\. The AMF transfers the Namf_MBSBroadcast_ContextStatusNotify request () to
the MB-SMF. When the AMF receives the response from all NG-RAN nodes, the AMF
includes an indication of the completion of the operation. If the AMF does not
receive responses from all NG-RAN nodes before the maximum response time
elapses since the reception of the Namf_MBSBroadcast_ContextCreate Request,
then the AMF should transfer the Namf_MBSBroadcast_ContextStatusNotify request
() which indicates partial success or failure.
12\. [Conditional] If N3mb unicast transport is to be used (i.e. N3mb DL
Tunnel Info is present in the MBS Session Start Response message from AMF),
the handling in MB-SMF and MB-UPF is the same as specified in step 8.
13\. The AF starts transmitting the DL media stream to MB-UPF using the N6mb
Tunnel, or optionally un-tunnelled i.e. as an IP multicast stream using the HL
MC address.
14\. The MB-UPF transmits the media stream to NG-RAN via N3mb multicast
transport or unicast transport.
15\. The NG-RAN transmits the received DL media stream using DL PTM resources.
NOTE 2: Step 6-8 and 2-4 are comparable to step 2-5 and 6-7 in clause 7.2.1.4,
respectively.
### 7.3.1a MBS Session Start for resource sharing across multiple broadcast
MBS Sessions during network sharing
To support resource sharing across multiple broadcast MBS Sessions during
network sharing (see clause 6.18), in addition to clause 7.3.1, the following
enhancement applies:
\- Step 2: The MB-SMF includes Associated Session ID in the N2 SM information
in Namf_MBSBroadcast_ContextCreate.
\- Step 4: A shared NG-RAN node identifies the associated MBS sessions as
specified in clause 6.18. The associated MBS sessions share radio resource
configuration based on the existing Broadcast MBS Session context.
\- Step 5a: If the NG-RAN determines there is already an existing broadcast
MBS session delivering the same content, the NG-RAN may skip joining the
multicast group based on operator policy, i.e., step 5a can be skipped.
\- Step 5b: If the NG-RAN determines there is already an existing broadcast
MBS session delivering the same content, a shared NG-RAN node may decide not
to allocate N3mb DL tunnel endpoint.
\- Step 6: For N3mb unicast transport, if the NG-RAN does not allocate N3mb DL
Tunnel endpoint in step 5b, the N3mb DL Tunnel Info is not included in MBS
Session Resource Setup Response.
\- Step 8: If the N3mb unicast transport is used but N3mb DL Tunnel Info is
not present, step 8 is skipped.
\- Step 9: If the NG-RAN determines that radio resource has been allocated for
another broadcast MBS Session delivering the same content as specified in
clause 6.18, the NG-RAN advertises the TMGI of the broadcast MBS session, and
reuses such already allocated radio resource for the MBS data transmission for
the broadcast MBS session.
NOTE: The 5G QoS Profile values for the broadcast MBS sessions are assumed to
be pre-agreed amongst the multiple operators participating in the network
sharing, and are the same irrespective of the PLMN from which the MBS Session
Start is sent.
\- Step 10 \~ step 12:
The handling is the same as steps 5, 6, 7 and 8.
\- Step 14: If the user plane of a broadcast MBS session from its MB-UPF to
the shared NG-RAN is not established, the NG-RAN will not receive the MBS
packets from the MB-UPF.
\- Step 15: If the NG-RAN receives multiple DL media streams for the same
content represented by the same Associated Session ID via multiple CNs, the
NG-RAN should deliver only one DL media stream.
### 7.3.2 MBS Session Release for Broadcast
The MBS Session Release for broadcast follows the MBS Session Deletion (e.g.
TMGI De-allocation and MBS Session Deletion) so that resource for shared MBS
delivery is released. It is possible for AF to stop MBS Session but keep TMGI
allocated.
Figure 7.3.2-1: MBS Session Release for Broadcast
1\. The AF/AS may stop the media stream before sending the MBS Session Release
Request (TMGI) message to the 3GPP network.
2\. The AF/AS performs MBS Session Deletion procedure to request release of
MBS Session (steps 1 \~ 10 in figure 7.1.1.4-1, or steps 1 \~ 15 in figure
7.1.1.5-1).
3\. MB-SMF sends Namf_MBSBroadcast_ContextRelease request (TMGI) to the AMF(s)
that has been involved in the MBS Session.
4\. The AMF sends an N2 message to all RAN nodes that have been involved to
release MBS session. If a NG-RAN node receives multiple N2 message to release
the MBS Session for the same TMGI (e.g. from several AMFs the NG-RAN is
connected to), NG-RAN only performs step 5 and step 6 once.
5\. The NG-RAN stops the PTM transmission and stops TMGI advertisement for the
MBS Session.
Depending on whether multicast or unicast transport is used over N3mb, step 6a
or step 6b is executed.
6a. If N3mb multicast transport has been used, the NG-RAN sends a Leave
message (LL SSM) to stop the media stream to this NG-RAN node.
6b. If N3mb unicast transport has been used, the NG-RAN releases its unicast
DL N3mb Tunnel endpoint.
7\. NG-RAN deletes the MBS Session Context of the broadcast MBS Session. The
NG-RAN reports successful release of resources for the MBS Session by sending
MBS Session Resource Release Response (TMGI) message(s) to the AMF(s).
8\. The AMF sends Namf_MBSBroadcast_ContextRelease response (TMGI) to the MB-
SMF.
9\. The AF may start a TMGI de-allocation procedure (steps 11 \~ 14 in figure
7.1.1.4-1, or steps 16 \~ 19 in figure 7.1.1.5-1).
### 7.3.2a MBS Session Release for resource sharing across multiple broadcast
MBS Sessions during network sharing
To support resource sharing across multiple broadcast MBS Sessions, in
addition to clause 7.3.2, the following enhancement applies:
\- Step 5:
\- If the NG-RAN determines there are other associated broadcast MBS Sessions
based on the Associated Session Identifier, the step 5 is skipped.
\- Step 6a:
\- If the NG-RAN skipped joining the multicast group (LL SSM) in clause
7.3.1a, the NG-RAN does not send a Leave message (LL SSM),
\- Otherwise, if the NG-RAN joined the multicast group (LL SSM) previously,
and if the NG-RAN determines there are other associated broadcast MBS Sessions
based on the Associated Session Identifier, the NG-RAN may trigger procedure
of Transport change for resource sharing across broadcast MBS Sessions during
network sharing as specified in clause 7.3.7.
\- Step 6b:
\- If the DL N3mb Tunnel for the broadcast MBS Session was not allocated
previously in clause 7.3.1a, step 6b is skipped.
Otherwise, if the DL N3mb Tunnel for the broadcast MBS Session was allocated
previously, and if the NG-RAN determines there are other associated broadcast
MBS Sessions based on the Associated Session Identifier, the NG-RAN may
trigger the procedure of Transport change for resource sharing across
broadcast MBS Sessions during network sharing as specified in clause 7.3.7.
### 7.3.3 MBS Session Update for Broadcast
The MBS Session Update for broadcast is used by the AF to update the broadcast
area or service requirements of the MBS Session which may lead to addition of
new MBS QoS Flow(s), removal of existing MBS QoS Flow(s) or update of existing
MBS QoS Flow(s).
Figure 7.3.3-1: MBS Session Update for Broadcast
1\. The AF starts MBS session update procedure by sending
Nnef_MBSSession_Update Request to the NEF/MBSF with TMGI (steps 1-6 and steps
9-10 in Figure 7.1.1.6-1, or steps 1-12 and steps 15-16 in Figure 7.1.1.7-1).
The AF may adjust service requirement and/or broadcast area. The service
requirements adjustment may lead to addition of new MBS QoS Flow(s), removal
of existing MBS QoS Flow(s) or update of existing MBS QoS Flow(s).
2\. The MB-SMF sends Namf_MBSBroadcast_ContextUpdate Request (TMGI, N2 SM
information (MBS Session ID, [MBS QoS profile], [service area(s)], [Area
Session ID(s)], [MBS IP Multicast Tunnel Info(s)], [MBS FSA ID(s)]), [updated
MBS service area]) to the AMFs. For a location dependent service, the MB-SMF
may provide information about several location areas. If the broadcast area is
updated, the MB-SMF may use NRF to discover the AMF(s) based on the new
broadcast area and select the appropriate one(s). The MB-SMF may include a
maximum response time in the request.
Depending on the change of the MBS service area, the MB-SMF may send
Namf_MBSBroadcast_ContextCreate to some AMFs in the new MBS service area,
Namf_MBSBroadcast_ContextRelease to some other AMFs in the old MBS service
area.
3\. The AMF sends MBS Session Resource Update to NG-RANs with TMGI, the
updated 5G QoS Profile and the updated MBS service area.
Depending on the change of the MBS service area, the AMF may send MBS Session
Resource Setup to some NG-RANs in new MBS service area (see clause 7.3.1) and
MBS Session Resource Release to some other NG-RANs in old MBS service area.
4\. The NG-RAN updates MBS Session Context.
5\. The NG-RAN reports successful update of the MBS Session resources (which
may include multiple MBS QoS Flows) by sending MBS Session Resource Update
Response (TMGI, N2 SM information ([N3mb DL Tunnel Info])) message(s) to the
AMF. N3mb DL Tunnel Info is only available when unicast transport applies
between MB-UPF and NG-RAN and the NG-RAN wants the transport to be changed.
The NG-RAN should be ready to receive using the N3mb DL tunnel. For more
details, refer to TS 38.413 [15].
6\. The AMF sends Namf_MBSBroadcast_ContextUpdate Response to the MB-SMF. If
the AMF received the NG-RAN responses from all involved NG-RAN(s), the AMF
should include an indication of completion of the operation in all NG-RANs. If
received from NG-RAN node, the N3mb DL Tunnel Info and corresponding NG-RAN ID
are included in the response.
6a. [Conditional] If MBS service area is changed in such a manner that NG-RAN
nodes are added or removed from handling the MBS session, and N3mb unicast
transport is used.
\- In a deployment where NG-RAN nodes share a common user plane entity, the
MB-SMF perform as following:
\- For the NG-RAN node to be added, the MB-SMF only establishes the shared
tunnel towards the DL GTP tunnel endpoint if the shared tunnel has not yet
been established (as determined based on the stored DL GTP Tunnel endpoint(s)
for the MBS session). The MB-SMF also stores the received DL GTP Tunnel and
corresponding NG-RAN Node ID for the MBS session.
\- For the NG-RAN node to be removed, the MB-SMF removes the received NG-RAN
Node ID and possibly DL GTP tunnel endpoint from the stored NG-RAN Node ID(s)
for the DL GTP tunnel endpoint for the MBS session, and checks whether the DL
GTP tunnel is in use by other NG-RAN nodes based on the stored NG-RAN Node
ID(s) for DL GTP tunnel endpoint for the MBS session. If the related DL GTP
tunnel is not in use by other NG-RAN nodes, the N3mb unicast transport tunnel
shall be removed.
\- In a deployment where NG-RAN nodes do not share a common user plane entity,
the MB-SMF always establishes or releases the shared tunnel towards the DL GTP
tunnel endpoint if NG-RAN nodes are added or removed from handling the MBS
session.
If the N3mb unicast transport tunnel need to be added or removed, the SMF
sends an N4mb Session Modification Request to the MB-UPF to establish or
release the N3mb unicast transport tunnel for establishing, or releasing the
MBS stream for the MBS Session.
7\. The NG-RAN updates the MBS Session. It takes place in parallel with step 5
to step 6.
8 Another NG-RAN may report successful update of the MBS Session resources
(which may include multiple MBS QoS Flows) by sending MBS Session Resource
Update Response (TMGI, N2 SM information ([N3mb DL Tunnel Info])) message
after the AMF transferred the Namf_MBSBroadcast_ContextUpdate Response () to
the MB-SMF. N3mb DL Tunnel Info is only available when unicast transport
applies between MB-UPF and NG-RAN and the NG-RAN wants the transport to be
changed. The NG-RAN should be ready to receive using the N3mb DL tunnel. For
more details, refer to TS 38.413 [15].
9\. The AMF transfers the Namf_MBSBroadcast_ContextStatusNotify request () to
the MB-SMF. When the AMF receives the response from all NG-RAN nodes, the AMF
should include an indication of completion of the operation in all NG-RANs. If
the AMF does not receive responses from all NG-RAN nodes before the maximum
response time elapses since the reception of the
Namf_MBSBroadcast_ContextUpdate Request, then the AMF should transfer the
Namf_MBSBroadcast_ContextStatusNotify request () which indicates partial
success or failure. If received from NG-RAN node, the N3mb DL Tunnel Info and
corresponding NG-RAN ID are included in the request.
10\. [Conditional] If MBS service area is changed in such a manner that NG-RAN
nodes are added or removed from handling the MBS session, and N3mb unicast
transport is used, the MB-SMF establishes or releases the shared delivery
tunnel via unicast N3mb transport for the MBS Session in the same manner as
described in step 6a.
### 7.3.4 Support for Location dependent Broadcast Service
The clause describes procedures to support the Location dependent broadcast
service as described in clause 6.2.
The MBS session creation procedure is performed as defined in clause 7.1.1.2
with the following additions:
\- Multiple AFs may start the same Broadcast MBS session with different
content in different MBS service areas. The NEF selects MB-SMF as ingress
control node(s) for different MBS service areas.
\- If presented, the NEF maps possible external identifiers for MBS service
areas to network-internal identifiers (e.g. list of cells, TAIs).
\- For Location dependent Broadcast Service, MB-SMF allocates Area Session ID,
and updates its NF profile towards the NRF with the TMGI and Area Session ID.
\- The MB-SMF may select the MB-UPF based on the MBS service area.
\- The MBS service area(s) are indicated to the UE in the Service Announcement
as defined in clause 6.11.
The MBS session establishment procedure is performed as defined in clauses
7.3.1 and 7.3.1a with the following additions or clarification:
\- MB-SMF requests the AMF to transfer an N2 message (i.e. MBS Session
Resource Setup Request) to the NG-RAN nodes of the MBS service area with
Broadcast MBS session information which additionally includes the Area Session
IDs and MBS service areas.
\- The NG-RAN uses the received MBS Session ID and Area Session IDs to
determine the local Broadcast MBS session contexts.
\- The NG-RAN responds for service areas it handles with the Area Session
ID(s) and DL tunnel endpoint(s) for the DL tunnel(s) from MB-SMF if unicast
transport applies over N3mb between MB-UPF and NG-RAN.
\- According to the Area Session ID(s) and DL tunnel endpoint(s) provided by
NG-RAN, the MB-SMF instructs the MB-UPF to send location dependent content.
\- The AF transmits the DL media streams to MB-UPF via tunnels to
differentiate the content delivered to different areas.
### 7.3.5 MBS Session Delivery Status Indication for Broadcast
The MBS Session Delivery Status Indication for broadcast is used by the MB-SMF
to notify the AF/AS of conditions affecting the delivery of the MBS session
(e.g. MBS session created, MBS session terminated, etc.). The occurrence of
the indicated condition may have been detected at the MB-SMF or may have been
reported to the MB-SMF by other entities involved in the MBS session delivery.
Figure 7.3.5-1: MBS Session Delivery Status Indication for Broadcast
1\. The external AF subscribes event for delivery status towards the NEF, and
the NEF subscribes corresponding event towards the MB-SMF (step 1a), or the
legacy AS request status report towards the MBSF, and the MBSF subscribes
event for delivery status towards the MB-SMF (step 1b), or the internal AF
subscribes event for delivery status towards the MB-SMF (step 1c).
2\. The MB-SMF notifies the TMGI and the event towards the NEF, and the NEF
notifies the TMGI and corresponding event towards the external AF (step 2a),
or the MB-SMF notifies the TMGI and the event towards the MBSF, and the MBSF
sends Delivery Status Indication to legacy AS with the TMGI and the
corresponding event (step 2b), or the MB-SMF notifies the TMGI and the event
towards the internal AF (step 2c).
For the \"MBS session started\" event, after the MB-SMF contacts AMFs to
request the establishment of the Broadcast MBS session, the MB-SMF may wait
until it has received a Namf_MBSBroadcast_ContextCreate Response or
Namf_MBSBroadcast_ContextStatusNotify with the indication of the completion of
the operation from each AMF (see clause 7.3.1) before determining that the
Broadcast MBS session has been started.
### 7.3.6 Broadcast MBS Session Release Require
When NG-RAN is not able continue to provide the Broadcast MBS Session, e.g.
due to lack of radio resources, NG-RAN may initiate Broadcast Session Release
Require procedure.
Figure 7.3.6-1: Broadcast MBS Session Release Require
1\. If NG-RAN cannot continue to provide the Broadcast MBS session, e.g. due
to lack of radio resources, the NG-RAN sends Broadcast Session Release Require
(MBS Session ID) to the AMF.
2\. The AMF initiates Broadcast Session Release towards the NG-RAN as defined
in steps 4 - 7 in clause 7.3.2.
3\. If unicast transport applies in N3mb, the AMF receives the DL tunnel Info
for the Broadcast MBS Session from the NG-RAN in step 2. The AMF notifies the
MB-SMF about the DL tunnel release via Namf_MBSBroadcast_ContextStatusNotify
with N3mb DL Tunnel Info and corresponding NG-RAN ID. If multicast transport
applies in N3mb, only when Broadcast Session Release Require is performed for
all the NG-RANs involved in the MBS session which are managed by the AMF, the
AMF notifies the MB-SMF about radio resource release via
Namf_MBSBroadcast_ContextStatusNotify indicating radio resource release.
3a-3b. This step applies if the AF subscribed to a Delivery Status Indication
(see clause 7.3.5). If Broadcast Session Release Require is performed by all
the NG-RANs, i.e., for unicast N3mb transport, the MB-SMF releases all the DL
tunnel Info for the broadcast MBS Session, and for multicast N3mb transport,
the MB-SMF receives radio resource release from all the AMFs for the broadcast
MBS Session, the MB-SMF notifies the AF directly of the situation by invoking
Nmbsmf_MBSSession_StatusNotify, or the MB-SMF notifies the AF via NEF/MBSF (if
deployed) by invoking Nmbsmf_MBSSession_StatusNotify service operation to the
NEF/MBSF which then invokes Nnef_MBSSession_StatusNotify service operation to
the AF
4\. The MB-SMF performs N4mb Session Modification to let MB-UPF stop the
broadcast data forwarding towards the indicated DL tunnel and release the DL
tunnel as specified in step 6a of clause 7.3.3.
### 7.3.7 Transport change for resource sharing across broadcast MBS Sessions
during network sharing
The procedure in this clause is performed when one of the following events
occurs under the condition that the resource sharing across broadcast MBS
Sessions in network sharing was previously applied and the NG-RAN determined
to receive only a single copy of MBS data as specified in clause 6.18:
\- A broadcast MBS session, from which the shared NG-RAN receives DL data
stream, is released, and no DL data stream is received in the NG-RAN from the
remaining broadcast MBS session(s) with the same Associated Session ID.
\- When the shared NG-RAN fails to receive DL data stream from the CN (e.g.,
due to failure in the user plane), the NG-RAN attempts to get the DL data
stream via another CN\'s user plane.
Figure 7.3.7-1: Transport change for resource sharing across broadcast MBS
Sessions during network sharing
1\. The NG-RAN selects another broadcast MBS Session that is delivering the
same content via another CN to establish user plane, utilizing the broadcast
MBS session context stored in the NG-RAN.
If unicast transport of N3mb applies, continue at step 3.
NOTE: Which CN is to be selected is up to NG-RAN implementation.
2\. If multicast transport of N3mb applies, the NG-RAN joins the multicast
group towards the LL SSM provided by the CN and continues at step 8.
3\. If unicast transport of N3mb applies, the NG-RAN allocates N3mb DL Tunnel
Info, and sends N2 message (e.g. BROADCAST SESSION TRANSPORT REQUEST) to the
AMF, including the MBS Session ID, the N3mb DL Tunnel Info and optional Area
session ID.
4\. The AMF transfers the Namf_MBSBroadcast_ContextStatusNotify request to the
MB-SMF, which contains the N2 message.
5\. The MB-SMF sends an N4mb Session Modification Request to the MB-UPF to
allocate the N3mb point-to-point transport tunnel for a replicated MBS stream
for the MBS Session. The MB-UPF sends N4mb Session Modification Response to
the MB-SMF.
6\. The AMF forwards the received N2 information in N2 message (e.g. BROADCAST
SESSION TRANSPORT RESPONSE) to the NG-RAN.
7\. The NG-RAN receives the media stream from the MB-UPF via N3mb multicast
transport or unicast transport.
8\. The NG-RAN sends the received packets using the existing radio resource.
### 7.3.8 Broadcast MBS procedures for UEs using power saving functions
For a UE using power saving function to receive broadcast MBS Session data,
the following apply:
\- If a UE is in RRC_CONNECTED mode due to other reasons at the start time or
the scheduled activation times, the UE follows normal connected mode
procedures.
\- If a UE is in RRC_IDLE state and reachable (e.g. in active time in MICO or
PTW for eDRX) at the start time or the scheduled activation times) the UE
follows normal idle mode or inactive mode procedures), the UE follows normal
idle mode procedure.
\- If a UE is in RRC_IDLE mode or CM-CONNECTED with RRC_INACTIVE state and not
reachable (i.e. in deep sleep) at the start time or the scheduled activation
times, the UE leaves the deep sleep state only to perform procedures related
to MBS, the UE leaves the deep sleep state only to receive the MBS broadcast
service, but should not update the AMF to become reachable for paging to
minimize signalling load.
NOTE 1: UE would therefore still be considered unreachable for paging in the
AMF.
\- When the UE is in the middle of an MBS data transfer, and the UE is
scheduled to move to deep sleep due to power saving, e.g. end of PTW for
extended idle mode DRX, expiration of active time for MICO, or the UE
transitioning from CM-CONNECTED to CM-CONNECTED with RRC_INACTIVE state with
eDRX or the UE transitioning from CM-CONNECTED to CM-IDLE in the case of MICO
with no active time, then the UE does not go to deep sleep during the
remainder of the current MBS data transfer.
NOTE 2: If at the end of the current MBS data transfer the UE knows there is
another MBS data transfer scheduled soon, depending on the time between MBS
data transfers, the UE can decide to go to sleep between MBS data transfers.
## 7.4 MBS procedures for inter System Mobility
### 7.4.1 Inter-system mobility with interworking at service layer
For inter-system mobility with interworking at service layer, i.e. the same
multicast service is provided via eMBMS in E-UTRAN and MBS, the UE is
instructed to switch between MBS and eMBMS:
NOTE 1: The source network can be configured with the frequencies where the
same service is provided in the target network, i.e. the EPC network
neighbouring the 5GC network support the same eMBMS service.
NOTE 2: The UE can be configured, per TMGI, to know that the same service is
provided over MBS and eMBMS.
\- Mobility from MBS to eMBMS.
When moving to E-UTRAN/EPC, the UE initiates procedures as defined in TS
23.246 [8] to receive MBMS service for the TMGI(s).
If the UE has one or more unicast PDU Sessions (including, but not limited to,
the PDU Session used for MBS and for another service (e.g. Public Safety
service) with the QoS Flow(s) for the other service) moving to EPS, and if the
handover procedure from 5GS to EPS using N26 interface described in clause
4.11.1.2.1 of TS 23.502 [6] is used:
\- For the PDU Session used also for MBS, the SMF+PGW-C removes the UE from
the Multicast MBS session context(s), if it exists, upon receiving a Modify
Bearer Request of the PDU Session from the SGW (i.e. step 14a of clause
4.11.1.2.1 of TS 23.502 [6]).
\- The NG-RAN removes the UE from the Multicast MBS session context(s) if it
exists, or removes the whole multicast session context if the UE is the last
one for the Multicast MBS session (e.g. after receiving the UE Context Release
Command message sent by the AMF).
For 5GS to EPS Idle mode mobility with no N26, when the UE moves to the EPS
and performs E-UTRAN/EPS attach according to step 8 of clause 4.11.2.4.1 of TS
23.502 [6], if the UE does not maintain registration in 5GC, upon reachability
time-out, the AMF may implicitly detach the UE and release the possible
remaining PDU Session(s) in 5GC. The SMF/PGW-C removes the UE from the
Multicast MBS session context(s), if it exists, upon receiving a tracking area
update from the UE.
\- Mobility from eMBMS to MBS.
When the UE has moved to NR/5GC, it triggers the multicast context and
multicast flow setup/modification via PDU Session Modification procedures as
defined in clause 6.8 to receive MBS transport for the TMGI(s).
## 7.5 MBS procedures for Group Message Delivery
### 7.5.1 Group Message Delivery via MBS Broadcast
Figure 7.5.1-1: Group Message Delivery via MBS Broadcast
NOTE 1: The steps in this clause for group message delivery to the UE(s)
follow the procedures specified in TS 26.502 [18], where the NEF acts as an
MBS Application Provider.
1\. The AF sends Nnef_MBSGroupMsgDelivery_Create Request to the NEF. The
Request message contains the Group Message Payload, MBS service area, Group
Message Delivery Start Time, Stop Time and External Group Identifier.
2\. The NEF checks authorization of the AF. If geographical area information
or civic address information was provided by the AF as MBS service area, the
NEF translates the MBS service area to Cell ID list or TAI list. The NEF may
further check the MBS capability within the MBS service area.
NOTE 2: The NEF is mandated for group message delivery.
3\. The NEF transforms the group message payload into a file, and determines
the meta data information of the file (e.g. File URL, etc.). The NEF assigns a
Group Message Correlation ID that identifies this group message delivery
request.
If Application Service Provisioning specified in TS 26.502 [18] has not been
performed, step 4 to step 8 are executed. Otherwise, they can be skipped.
4\. The NEF performs Application Service Provisioning by invoking
Nmbsf_MBSUserService_Create and Nmbsf_MBSUserDataIngestSession_Create towards
the MBSF using Object Distribution Method as specified in TS 26.502 [18].
5\. The MBSF performs MBS Session Creation as specified in clause 7.1.1.2 or
clause 7.1.1.3.
6\. The MBSF performs Distribution Session Provisioning as specified in TS
26.502 [18]. The MBSF invokes Nmbstf_MBSDistributionSession_Create on the
MBSTF, passing the parameters of the MBS Distribution Session received in step
4 to the MBSTF.
7\. The MB-SMF initiates the MBS Session Start for Broadcast procedure as
specified in step 2 to step 9 in clause 7.3.1.
8\. If the MBSF performs the service announcement, it initiates the MBS User
Service Announcement as specified in TS 26.502 [18]. The application may
receive the appropriate information through the MBS-6 API from the MBS Client
(see TS 26.502 [18]). The NEF may receive the service announcement information
via Nmbsf_MBSUserDataIngestSession_StatusNotify callback service operation
(see TS 26.502 [18]).
9\. The NEF sends Nnef_MBSGroupMsgDelivery_Create Response (Group Message
Correlation ID, Acceptance Status, Cause) to the AF. The Acceptance Status
indicates whether the group message delivery request is accepted or not. If
not, the Cause is included indicating the appropriate failure reason. If the
AF performs the service announcement, the NEF includes in the Group Message
Response the service announcement information which contains information such
as Session Description parameters (e.g. TMGI) and the object meta data as
specified in TS 26.502 [18]. The NEF may further include the area where MBS is
not supported within the MBS service area in the
Nnef_MBSGroupMsgDelivery_Create response to the AF.
If the AF knows the UEs that are located in the area where MBS is not
supported, AF may use unicast to send the group message to those UEs.
10\. If the AF needs to perform the Service Announcement, the AF sends the
application service announcement to the UE as specified in TS 26.502 [18].
11\. The NEF performs the User Data Ingestion towards the MBSTF as specified
in TS 26.502 [18]. The NEF may push the file to the MBSTF or let MBSTF pull
the file from the NEF.
12\. The MBSTF performs packetization and optionally FEC encoding as specified
in TS 26.502 [18].
13\. The MBSTF delivers the packets to the MB-UPF to NG-RAN, and NG-RAN
broadcast to the UE as specified in step 13 to step 15 in clause 7.3.1.
14\. Based on the service announcement information received in step 8 or step
10, when the UE receives the packets, the MBS client performs FEC decoding to
restore the file and gets the group message from the file, as specified in TS
26.502 [18]. The MBS Client can expose the file towards the application in the
UE using the MBS-7 API (see TS 26.502 [18]).
15\. The MBSTF notifies the MBSF of User Data distribution status, and the
MBSF then notifies the MBSF of the User Data ingestion status as specific in
TS 26.502 [18].
16\. The NEF sends Nnef_MBSGroupMsgDelivery_StatusNotify to the AF, containing
Group Message Correlation ID, Delivery Status. The Delivery Status indicates
whether delivery of Group Message Payload is successful or not. The delivery
status information is received by the NEF via
Nmbsf_MBSUserDataIngestSession_StatusNotify service operation (see TS 26.502
[18]).
### 7.5.2 Modification of previously submitted Group message
Figure 7.5.2-1: Modify Group Message Delivery via MBS Broadcast
NOTE: The steps in this clause for modification of group message delivery to
the UE(s) follow the procedures specified in TS 26.502 [18], where the NEF
acts as an MBS Application Provider.
1\. The AF sends Nnef_MBSGroupMsg_Update Request to the NEF. The Request
message contains the Group Message Correlation ID, Group Message Payload, MBS
service area, Group Message Delivery Start Time, Stop Time and External Group
Identifier. The NEF identifies the associated MBS Service by the external
Group Identifier. The Group Message Correlation ID indicates the transaction
to be modified.
2\. The NEF checks authorization of AF. If geographical area information or
civic address information was provided by the AF as MBS service area, the NEF
translates the MBS service area to Cell ID list or TAI list. The NEF may
further check the MBS capability within the MBS service area.
For Group Message Payload update, steps 3 to 6 are executed:
3\. The NEF transforms the group message payload into a file, and use the
determined file meta data (e.g. File URL, etc.) in clause 7.5.1.
4\. If the NEF pushes the updated file to the MBSTF, step 4 to step 5 can be
skipped. If the MBSTF pulls the updated file from the NEF, the NEF updates MBS
User Data Ingest Session on the MBSF as specified in TS 26.502 [18]. The
update service operation needs to indicate an update of the file containing
the updated group message.
5\. The MBSF updates MBS Distribution Session on the MBSTF as specified in TS
26.502 [18]. The update service operation needs to indicate an update of the
file containing the updated group message.
6\. The NEF pushes the update file to the MBSTF or the MBSTF pulls the updated
file from the NEF. And the MBSTF delivers the updated file towards the MB-UPF
in 5GC as specified in clause 4.3.3.2 of TS 26.502 [18].
For MBS service area update, step 7 and step 8 are executed:
7\. The NEF updates MBS User Service on the MBSF as specified in TS 26.502
[18]. The update service operation indicates MBS service area update.
8\. The MBSF performs MBS Session Update as specified in clause 7.1.1.6 or
clause 7.1.1.7 to update MBS service area, which triggers MBS Session Update
for Broadcast as specified in clause 7.3.3.
9\. The NEF sends Nnef_MBSGroupMsgDelivery_Update Response (Acceptance Status,
Cause) to the AF. The Acceptance Status indicates whether the group message
update request is accepted or not. If not, the Cause is included indicating
the appropriate failure reason. The NEF may further include the area where MBS
is not supported in the Nnef_MBSGroupMsgDelivery_Update response to the AF.
After the modified group message is delivered, the NEF sends
Nnef_MBSGroupMsgDelivery_StatusNotify to the AF as described in step 16 in
clause 7.5.1.
### 7.5.3 Cancellation of previously submitted Group message
Figure 7.5.3-1: Cancelling Group Message Delivery via MBS Broadcast
NOTE: The steps in this clause for cancelling the group message delivery to
the UE(s) follow the procedures specified in TS 26.502 [18] where the NEF acts
as an MBS Application Provider.
1\. The AF sends Nnef_MBSGroupMsgDelivery_Delete Request (Group Message
Correlation ID, External Group Identifier) to the NEF. The NEF identifies the
associated MBS Service by the External Group Identifier. The Group Message
Correlation ID indicates the transaction to be cancelled.
2\. The NEF checks authorization of the AF.
Steps 3 to step 5 are executed if the group message delivery has started and
MBSF needs to inform the MBS Client about the cancellation of the file
delivery. Otherwise, they can be skipped.
3\. The NEF updates MBS User Data Ingest Session on the MBSF as specified in
TS 26.502 [18] indicating the cancellation of the file delivery.
4\. If the MBSTF pulled the file from the NEF previously, the MBSF updates MBS
Distribution Session on the MBSTF as specified in TS 26.502 [18] indicating
cancellation of the file delivery and the MBSTF stops the file delivery.
5\. If the NEF pushed the file previously to the MBSTF, the NEF may send HTTP
DELETE to the MBSTF to cancel the file delivery. The MBSTF stops the file
delivery.
6\. The NEF destroys MBS User Data Ingest Session on the MBSF as specified in
TS 26.502 [18].
7\. The MBSF destroys MBS Distribution Session on the MBSTF as specified in TS
26.502 [18].
8\. The MBSF performs MBS Session Deletion as specified in clause 7.1.1.4 or
clause 7.1.1.5, which includes MBS Session Release for Broadcast as specified
in clause 7.3.2.
9\. The NEF sends Nnef_MBSGroupMsgDelivery_Delete Response (Acceptance Status,
Cause) to the AF. The Acceptance Status indicates whether the
Nnef_MBSGroupMsgDelivery_Delete Request is accepted or not. Cause is included
when the Nnef_MBSGroupMsgDelivery_Delete Request is not accepted.
# 8 Control and user plane stacks
## 8.1 Control plane for Multicast and Broadcast services
### 8.1.1 General
The control plane protocol stacks for Multicast and Broadcast service between
NG-RAN and MB-SMF is defined in the clause 8.1.1 and the other control plane
protocol stacks for Multicast and Broadcast service are defined in the TS
23.501 [5] clause 8.2.
The control plane protocols for N4mb reference point between MB-SMF and MB-UPF
are defined in TS 29.244 [17].
The reference point Nmb2 between MBSF and MBSTF will be defined in TS 26.502
[18] and TS 26.517 [22].
### 8.1.2 NG-RAN -- MB-SMF
**Legend:**
\- **N2 SM information:** This is the subset of NG-AP information that the AMF
transparently relays between the NG-RAN and the MB-SMF, and is included in the
NG-AP messages and the N11mb related messages, where the NG-RAN node has MBS
capability and in this Release the NG-RAN is a 3GPP NR.
Figure 8.1.1-1: Control Plane between the NG-RAN and the MB-SMF
## 8.2 User plane for Multicast and Broadcast services
The User plane protocol stack for PDU session which handles the multicast
operation is same with the PDU session user plane Protocol Stack defined in
the TS 23.501 [5] clause 8.3.1.
The user plane protocol stack for MBS session in case of shared delivery is
described in Figure 8.2-1 and Figure 8.2-2. In Figure 8.2-1, the UDP tunnel
applies to N6mb and Nmb9, while in Figure 8.2-2, the plain IP multicast
applies to N6mb. The user plane protocol stack for MBS session in case of
individual delivery is described in Figure 8.2-3.
Figure 8.2-1: User Plane Protocol Stack for MBS session (UDP Tunnel)
Figure 8.2-2: User Plane Protocol Stack for MBS session (plain IP multicast)
\- **5G-AN Protocol Layers** : This set of protocols/layers depends on the AN:
\- in this Release, the 5G-AN is a 3GPP NR, these protocols/layers are defined
in TS 38.401 [16]. The radio protocol between the UE and the 5G-AN node
(gNodeB) is specified in TS 38.300 [9].
Figure 8.2-3: User Plane Protocol Stack for MBS session in case of Individual
delivery
\- **5G-AN Protocol Layers** : This set of protocols/layers depends on the AN:
\- in this Release, the 5G-AN is a 3GPP NR, these protocols/layers are defined
in TS 38.401 [16]. The radio protocol between the UE and the 5G-AN node
(gNodeB) is specified in TS 38.300 [9].
NOTE: In Figure 8.2-3, the User Plane Protocol Stack between MB-UPF and
AF/MBSTF is shown in Figure 8.2-1 and Figure 8.2-2.
# 9 Network Function Services
## 9.1 MB-SMF Services
### 9.1.1 General
The following table illustrates the MB-SMF Services for MBS.
Table 9.1.1-1: NF services provided by MB-SMF
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer (s) | | | | Semantics | | +================+================+================+================+ | ** | Allocate | Re | NEF, MBSF, AF | | Nmbsmf_TMGI**| | quest/Response | | +----------------+----------------+----------------+----------------+ | | Deallocate | Re | NEF, MBSF, AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | ContextS | | SMF | | | tatusSubscribe | | | +----------------+----------------+----------------+----------------+ |** Nmbsmf | ContextSta | Su | SMF | | _MBSSession** | tusUnsubscribe | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | | Conte | | SMF | | | xtStatusNotify | | | +----------------+----------------+----------------+----------------+ | | ContextUpdate | Re | AMF, SMF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | S | Su | MBSF, NEF, AF | | | tatusSubscribe | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | | Sta | | MBSF, NEF, AF | | | tusUnsubscribe | | | +----------------+----------------+----------------+----------------+ | | StatusNotify | | MBSF, NEF, AF | +----------------+----------------+----------------+----------------+ | | Create | Re | MBSF, NEF, AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Update | Re | MBSF, NEF, AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Delete | Re | MBSF, NEF, AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+
### 9.1.2 Nmbsmf_TMGI service
#### 9.1.2.1 General
**Service description:** NF Service Consumer can use this service to request
the allocation of TMGIs and release allocated TMGIs.
#### 9.1.2.2 Nmbsmf_TMGI_Allocate service operation
**Service operation name:** Nmbsmf_TMGI_Allocate
**Description:** This service is used by the NF Service Consumer to request
the allocation of TMGI(s) or request to refresh previously allocated TMGI(s).
**Inputs, Required:** Number of TMGIs.
**Inputs, Optional:** TMGI(s) (i.e. the TMGI(s) to be extended the expiry
time).
**Outputs, Required:** TMGI(s), Expiry Time of the TMGI(s).
**Outputs, Optional:** NID.
#### 9.1.2.3 Nmbsmf_TMGI_Deallocate service operation
**Service operation name:** Nmbsmf_TMGI_Deallocate
**Description:** NF Service Consumer can use this service to request the
release of TMGI(s).
**Inputs, Required:** TMGI(s).
**Inputs, Optional:** None.
**Outputs, Required:** Success or not.
**Outputs, Optional:** None.
### 9.1.3 Nmbsmf_MBSSession service
#### 9.1.3.1 General
**Service description:** The following are the key functionalities of this NF
service:
\- (between AMF or SMF and MB-SMF) For multicast, NF Service Consumer can use
this service to request the reception of MBS data or to terminate the
reception of MBS data of a Multicast MBS session, or for a location dependent
Multicast MBS session, the part of the MBS multicast session within a service
area;
\- (between SMF and MB-SMF) For multicast, allow consumer NFs to query
information (e.g. QoS information) about MBS Session. This service will be
invoked by SMF for UE join event;
\- (between SMF (only for multicast) or MBSF/NEF and MB-SMF) Allow consumer
NFs to subscribe and unsubscribe for an Event ID and MBS Session, or for a
location dependent MBS session, related to the part of the MBS session within
a service area (only for MBSF/NEF);
\- (between SMF (only for multicast) or MBSF/NEF and MB-SMF) Notifying events
on the MBS Session, or for a location dependent MBS session, related to the
part of the MBS session within a service area (only for MBSF/NEF), to the
subscribed NFs;
\- (between MBSF/NEF/AF and MB-SMF)
Creation/Modification/Activation/Deactivation/Release of Multicast MBS
session, or for a location dependent Multicast MBS session, the part of the
Multicast MBS session within a service area; and
\- (between MBSF/NEF and MB-SMF) Creation/Modification/Start/Stop/Release of
Broadcast MBS sessions, or for a location dependent Broadcast MBS session, the
part of the Broadcast MBS session within a service area.
The following events related to MBS Session Context can be subscribed by SMF
as consumer NF:
\- (between SMF and MB-SMF, only for multicast) QoS change: The event
notification is sent when QoS within a Multicast MBS session changes, e.g.
adding/removing QoS flow(s);
\- (between SMF and MB-SMF only for multicast) multicast session state
(Active, Inactive);
\- (between SMF and MB-SMF only for multicast) Multicast MBS session service
area change (for a location dependent Broadcast MBS session, the notification
relates to the part of the Broadcast MBS session within a service area);
\- (between SMF and MB-SMF only for multicast) Multicast MBS session release;
\- (between SMF and MB-SMF only for multicast) multicast session security
context update.
The following events related to an MBS session, or for a location dependent
MBS session, related to the part of the MBS session within a service area, can
be subscribed by MBSF, NEF, or AF as consumer NF:
\- (between MBSF/NEF/AF and MB-SMF) MBS session release due to TMGI expiry;
\- (between MBSF/NEF/AF and MB-SMF) Broadcast delivery status.
NOTE: Whether event IDs are needed can be determined by stage 3.
#### 9.1.3.2 Nmbsmf_MBSSession_ContextUpdate service operation
**Service operation name:** Nmbsmf_MBSSession_ContextUpdate
**Description:** NF Service Consumer can use this service to request or
terminate the reception of data of a multicast session, or for a location
dependent MBS session, related to the part of the MBS session within a service
area.
**Inputs, Required:** MBS Session ID, if consumer is AMF: N2 container
(Establishment or Release, MBS Session ID, Possible Area Session ID, Possible
GTP Tunnel info for unicast transport, Possible tracking Area IDs), AMF ID, if
consumer is SMF: SMF ID, MBS Session ID, Action(Establishment or Release).
**Inputs, Optional:** if consumer is SMF: Area Session ID, Unicast GTP Tunnel
info of the UPF.
**Outputs, Required:** Success or not.
**Outputs, Optional:** if consumer is AMF: N2 container (MBS Session ID,
Possible Multicast DL tunnel info, multicast QoS flow information, session
state (Active/Inactive), [MBS service areas]); if consumer is SMF: Multicast
DL tunnel info.
#### 9.1.3.3 Nmbsmf_MBSSession_ContextStatusSubscribe service operation
**Service operation name:** Nmbsmf_MBSSession_ContextStatusSubscribe
**Description:** Service Consumer NF can use this service operation to request
information (e.g. QoS information) about a multicast session and to subscribe
to notification of events about the multicast session context.
**Inputs, Required:** MBS Session ID, Notification Target Address, Events
ID(s).
**Inputs, Optional:** None.
**Outputs, Required:** None.
**Outputs, Optional:** Event information (e.g. QoS information for multicast
session, multicast MBS session state (Active, Inactive), multicast session
service area for local multicast service), Start time of multicast MBS
session, multicast DL tunnel info, if consumer is SMF: indication that the
multicast MBS session allows any UE to join, multicast session security
context.
#### 9.1.3.4 Nmbsmf_MBSSession_ContextStatusNotify service operation
**Service operation name:** Nmbsmf_MBSSession_ContextStatusNotify
**Description:** This service operation, which is applicable to multicast MBS
session, is used by the MB-SMF to notify its consumers about events of an MBS
Session, or for a location dependent MBS session, related to a service area
change.
**Inputs, Required:** MBS Session ID, Event ID.
**Inputs, Optional:** Event information (e.g. QoS information of MBS Session,
MBS service area, Area Session ID, updated multicast session security
context).
**Outputs, Required:** Operation execution result indication.
**Outputs, Optional:** Cause.
#### 9.1.3.5 Nmbsmf_MBSSession_ContextStatusUnsubscribe service operation
**Service operation name:** Nmbsmf_MBSSession_ContextStatusUnsubscribe
**Description:** This service operation, which is applicable to multicast MBS
session, is used by the consumer to unsubscribe to notifications about MBS
context events.
**Inputs, Required:** MBS Session ID.
**Inputs, Optional:** None.
**Outputs, Required:** Operation execution result indication.
**Outputs, Optional:** None _._
#### 9.1.3.6 Nmbsmf_MBSSession_Create service operation
**Service operation name:** Nmbsmf_MBSSession_Create
**Description:** Create a new multicast session or broadcast session, or for a
location dependent MBS session, the part of the MBS session within a service
area. Optionally subscribe to notifications for this MBS session.
**Input, Required:** MBS Session ID (SSM or TMGI) or TMGI allocation request,
MBS Service Type (multicast or broadcast).
**Input, Optional:** DNN, S-NSSAI, MBS service area, MBS Service Information
(as defined in clause 6.14), Input Transport Address Request, MBS start time,
MBS termination time. For a multicast session, indication that any UE may
join, multicast session security context. For a broadcast session, MBS FSA
ID(s). For subscription to notifications event ID(s), Notification Target
Address, Request for location dependent MBS session, Associated Session ID for
resource sharing across broadcast MBS Sessions during network sharing.
**Output, Required:** Result Indication.
**Output, Optional:** TMGI, NID, Expiry Time of the TMGI, Cause, MB-UPF tunnel
info, MBS FSA ID(s), Area Session ID.
#### 9.1.3.7 Nmbsmf_MBSSession_Update service operation
**Service operation name:** Nmbsmf_MBSSession_Update
**Description:** Update the established multicast session or broadcast
session, or for a location dependent MBS session, the part of the MBS session
within a service area, e.g. QoS update.
**Input, Required:** MBS Session ID.
**Input, Optional:** MBS Service Information (as defined in clause 6.14), MBS
service area, for a broadcast session, MBS FSA ID(s), Area Session ID,
indication that the PCF has to be contacted. For multicast, session state
(Active/Inactive), updated multicast session security context.
**Output, Required:** Result Indication.
**Output, Optional:** Cause, MBS FSA ID(s).
#### 9.1.3.8 Nmbsmf_MBSSession_Delete service operation
**Service operation name:** Nmbsmf_MBSSession_Delete
**Description:** Release the multicast session or broadcast session, or for a
location dependent MBS session, the part of the MBS session within a service
area. The MBS session is deleted and the subscription (if any) to
notifications about events related to the status of the MBS session is
terminated.
**Input, Required:** MBS Session ID.
**Input, Optional:** Area Session ID.
**Output, Required:** Result Indication.
**Output, Optional:** Cause.
#### 9.1.3.9 Nmbsmf_MBSSession_StatusNotify service operation
**Service operation name:** Nmbsmf_MBSSession_StatusNotify
**Description:** This service operation is used by the MB-SMF to notify its
consumers about the status change of the MBS session, or for a location
dependent MBS session, of the part of the MBS session within a service area.
**Input, Required:** MBS Session ID, Event ID.
**Input, Optional: Event information, Area Session ID**.
**Output, Required:** Result Indication.
#### 9.1.3.10 Nmbsmf_MBSSession_StatusSubscribe service operation
**Service operation name:** Nmbsmf_MBSSession_StatusSubscribe
**Description:** This service operation is used by the NF service consumer
(e.g. NEF, MBSF, AF) to subscribe notification about events related to the
status of the MBS session, or for a location dependent MBS session, the part
of the MBS session within a service area.
**Input, Required:** MBS Session ID, event ID(s), Notification Target Address.
**Input, Optional: Area Session ID**.
**Output, Required:** When the subscription is accepted: Subscription
Correlation ID.
#### 9.1.3.11 Nmbsmf_MBSSession_StatusUnsubscribe service operation
**Service operation name:** Nmbsmf_MBSSession_StatusUnsubscribe
**Description:** This service operation, is used by the NF service consumer
(e.g. NEF, MBSF, AF) to unsubscribe to notification about events related to
the status of the MBS session, or for a location dependent MBS session, the
part of the MBS session within a service area.
**Input, Required:** Subscription Correlation ID.
**Input, Optional: Area Session ID**.
**Output, Required:** Result Indication.
## 9.2 PCF Services
### 9.2.1 General
The following table illustrates the PCF Services for MBS.
Table 9.2.1-1: NF services provided by PCF for MBS
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer (s) | | | | Semantics | | +================+================+================+================+ | **Npcf_MBSP | Create | Re | MB-SMF | | olicyControl** | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Update | Re | MB-SMF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Delete | Re | MB-SMF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | **N | Create | Re | AF, NEF, MBSF | | pcf_MBSPolicy | | quest/Response | | | A | | | | | uthorization** | | | | +----------------+----------------+----------------+----------------+ | | Update | Re | AF, NEF, MBSF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Delete | Re | AF, NEF, MBSF | | | | quest/Response | | +----------------+----------------+----------------+----------------+
### 9.2.2 Npcf_MBSPolicyControl service
#### 9.2.2.1 General
**Service description:** NF Service Consumer, e.g. MB-SMF, can create and
manage a MBS Policy Association in the PCF through which the NF Service
Consumer receives policy information for the MBS Session.
As part of this service, the PCF may provide the NF Service Consumer, e.g. MB-
SMF, with policy information for the MBS Session that may contain (the details
are defined in clause 6.10):
\- Policy information applicable for an entire MBS Session.
\- PCC rule information.
\- Policy Control Request Trigger information.
At MBS Session establishment the NF Service Consumer, e.g. MB-SMF, requests
the creation of a corresponding MBS Policy Association with the PCF
(Npcf_MBSPolicyControl_Create) and provides relevant parameters about the MBS
Session to the PCF.
\- When the PCF has created the \"MBS Policy Association\", the PCF may
provide policy information as defined above.
When a Policy Control Request Trigger condition is met the NF Service
Consumer, e.g. MB-SMF, requests the update (Npcf_MBSPolicyControl_Update) of
the MBS Policy Association by providing information on the condition(s) that
have been met. The PCF may provide updated policy information for the MBS
session to the NF Service Consumer.
The PCF may at any time provide updated policy information for the MBS session
(Npcf_MBSPolicyControl_UpdateNotify).
At MBS Session Release the NF Service Consumer, e.g. MB-SMF, requests the
deletion of the corresponding MBS Policy Association.
#### 9.2.2.2 Npcf_MBSPolicyControl_Create service operation
**Service operation name:** Npcf_MBSPolicyControl_Create
**Description:** The NF Service Consumer can request the creation of a MBS
Policy Association and provide relevant parameters about the MBS Session to
the PCF.
**Inputs, Required:** MBS Session ID.
**Inputs, Optional:** MBS Service Information (as defined in clause 6.14),
DNN, S-NSSAI..
**Outputs, Required:** Success or Failure. In the case of Success, MBS Policy
Association ID and Policy information for the MBS Session (as defined in
clause 6.10).
**Outputs, Optional:** In the case of Failure, the Service Information that
can be accepted by the PCF. In the case of Failure, indication that another
PCF shall be contacted and an ID of that other PCF.
#### 9.2.2.3 Void
#### 9.2.2.4 Npcf_MBSPolicyControl_Delete service operation
**Service operation name:** Npcf_MBSPolicyControl_Delete
**Description:** The NF Service Consumer (i.e. MB-SMF) can request the
deletion of the MBS Policy Association and of the associated resources.
**Inputs, Required:** MBS Policy Association ID.
**Inputs, Optional: None**.
**Outputs, Required:** Success or Failure.
**Outputs, Optional:** None.
#### 9.2.2.5 Npcf_MBSPolicyControl_Update service operation
**Service operation name:** Npcf_MBSPolicyControl_Update
**Description:** The NF Service Consumer can request an update of the MBS
Policy Association.
**Inputs, Required:** MBS Policy Association ID.
**Inputs, Optional:** MBS Service Information (as defined in clause 6.14),
Information on the Policy Control Request Trigger condition that has been met.
**Outputs, Required:** Success or Failure.
**Outputs, Optional:** In the case of Failure, the Service Information that
can be accepted by the PCF. In the case of Success, Policy information for the
MBS Session (as defined in clause 6.10).
### 9.2.3 Npcf_MBSPolicyAuthorization Service
#### 9.2.3.1 General
**Service description:** This service is to authorise an AF / NEF / MBSF
request for an MBS service and to create policies as requested by the
authorized AF for the MBS Service. This service also allows the NF consumer to
subscribe/unsubscribe the notification of events.
#### 9.2.3.2 Npcf_MBSPolicyAuthorization_Create service operation
**Service operation name:** Npcf_MBSPolicyAuthorization_Create
**Description:** Authorize the request, and optionally determines and installs
MBS Policy Control Data according to the information provided by the NF
Consumer.
**Inputs, Required:** MBS Session ID.
**Inputs, Optional:** DNN if available, S-NSSAI if available, MBS Service
Information (as defined in clause 6.14).
**Outputs, Required:** Success (application session context) or Failure
(reason for failure).
**Outputs, Optional:** In the case of Failure, the MBS Service Information
that can be accepted by the PCF.
#### 9.2.3.3 Npcf_MBSPolicyAuthorization_Update service operation
**Service operation name:** Npcf_MBSPolicyAuthorization_Update
**Description:** Provides updated information to the PCF.
**Inputs, Required:** Identification of the application session context.
**Inputs, Optional:** MBS Service Information (as defined in clause 6.14).
**Outputs, Required:** Success or Failure (reason for failure).
**Outputs, Optional:** In the case of Failure, the MBS Service Information
that can be accepted by the PCF. In the case of Success, indication that the
PCF has to be contacted.
Provides updated application level information and communicates with
Npcf_MBSPolicyControl service to determine and install the policy according to
the information provided by the NF Consumer. Updates an application context in
the PCF.
#### 9.2.3.4 Npcf_MBSPolicyAuthorization_Delete service operation
**Service operation name:** Npcf_MBSPolicyAuthorization_Delete
**Description:** Provides means for the NF Consumer to delete the context of
application level session information.
**Inputs, Required:** Identification of the application session context.
**Inputs, Optional:** None.
**Outputs, Required:** Success or Failure.
**Outputs, Optional:** None.
## 9.3 AMF Services
### 9.3.1 General
The Namf_MT_EnableGroupReachability service operation is defined in TS 23.502
[6].
The following table illustrates the new AMF Service for broadcast
communication.
Table 9.3.1-1: NF services provided by AMF
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer (s) | | | | Semantics | | +================+================+================+================+ | Namf | ContextCreate | Re | MB-SMF | | _MBSBroadcast | | quest/Response | | +----------------+----------------+----------------+----------------+ | | ContextUpdate | Re | MB-SMF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | ContextRelease | Re | MB-SMF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Conte | Su | MB-SMF | | | xtStatusNotify | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | Namf_MB | N2M | Re | MB-SMF | | SCommunication | essageTransfer | quest/Response | | +----------------+----------------+----------------+----------------+
### 9.3.2 Namf_MBSBroadcast service
#### 9.3.2.1 General
**Service description:** This service is used by the consumer for broadcast
communication.
#### 9.3.2.2 Namf_MBSBroadcast_ContextCreate service operation
**Service operation name:** Namf_MBSBroadcast_ContextCreate
**Description:** This service operation is used to create the broadcast
session context towards the AMF.
**Inputs, Required:** MBS Session ID, Broadcast service area, N2 container
(e.g. MBS Session ID, MBS QoS profile, Broadcast service area).
**Inputs, Optional:** Area Session ID, Optional parameters in the N2 container
(MBS IP Multicast Tunnel Info, Area Session ID, MBS FSA ID(s), Associated
Session ID for resource sharing across broadcast MBS Sessions during network
sharing).
**Outputs, Required:** Result Indication.
**Outputs, Optional:** N2 container (MBS Session ID, Area Session ID, NG-RAN
MBS Tunnel Info).
#### 9.3.2.3 Namf_MBSBroadcast_ContextUpdate service operation
**Service operation name:** Namf_MBSBroadcast_ContextUpdate
**Description:** This service operation is used to update the broadcast
session context towards the AMF.
**Inputs, Required:** MBS Session ID.
**Inputs, Optional:** Broadcast service area, N2 container (MBS Session ID,
Possible MBS QoS profile, Possible Broadcast service area, Possible Area
Session ID, Possible MBS IP Multicast Tunnel Info, MBS FSA ID(s)).
**Outputs, Required:** Result Indication.
**Outputs, Optional:** N2 container (MBS Session ID, Area Session ID, NG-RAN
MBS Tunnel Info).
#### 9.3.2.4 Namf_MBSBroadcast_ContextRelease service operation
**Service operation name:** Namf_MBSBroadcast_ContextRelease
**Description:** This service operation is used to release the broadcast
session context towards the AMF.
**Inputs, Required:** MBS Session ID, N2 container (MBS Session ID).
**Inputs, Optional:** None.
**Outputs, Required:** Result Indication.
**Outputs, Optional:** None.
#### 9.3.2.5 Namf_MBSBroadcast_ContextStatusNotify service operation
**Service operation name:** Namf_MBSBroadcast_ContextStatusNotify
**Description:** This service operation is used to notify its consumers about
the status change of a broadcast session context.
**Inputs, Required:** MBS Session ID.
**Inputs, Optional:** Event ID (e.g. change of NG-RAN MBS Tunnel Info), N2 SM
information.
**Outputs, Required:** Result Indication.
**Outputs, Optional: None**.
### 9.3.3 Namf_MBSCommunication Service
#### 9.3.3.1 General
**Service description:** This service enables MBS multicast related N2 message
transfer towards the NG-RAN via the AMF, during multicast session
activation/deactivation/update/release.
#### 9.3.3.2 Namf_MBSCommunication_N2MessageTransfer service operation
**Service operation name:** Namf_MBSCommunication_N2MessageTransfer
**Description:** This service operation is used by the NF Consumer to request
the AMF to transfer the MBS related N2 message to the NG-RAN nodes serving the
MBS multicast session.
**Input, Required:** MBS Session ID, N2 SM information.
**Input, Optional:** MBS Area Session ID.
**Output, Required:** Result Indication.
**Output, Optional:** Cause.
## 9.4 NEF Services
### 9.4.1 General
The following table illustrates the NEF Services for MBS.
Table 9.4.1-1: NF services provided by NEF
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | Example | | | Operations | | Consumer (s) | | | | Semantics | | +================+================+================+================+ | Nnef_MBSTMGI | Allocate | Re | AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Deallocate | Re | AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | ExpiryNotify | Su | AF | | | | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | Nn | Create | Re | AF | | ef_MBSSession | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Update | Re | AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Delete | Re | AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | StatusNotify | Su | AF | | | | bscribe/Notify | | +----------------+----------------+----------------+----------------+ | | S | | AF | | | tatusSubscribe | | | +----------------+----------------+----------------+----------------+ | | Sta | | AF | | | tusUnsubscribe | | | +----------------+----------------+----------------+----------------+ | Nnef_MBSGr | Create | Re | AF | | oupMsgDelivery | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Update | Re | AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | Delete | Re | AF | | | | quest/Response | | +----------------+----------------+----------------+----------------+ | | StatusNotify | Su | AF | | | | bscribe/Notify | | +----------------+----------------+----------------+----------------+
### 9.4.2 Nnef_MBSTMGI service
#### 9.4.2.1 General
**Service description:** NF Service Consumer can use this service to request
the allocation of TMGIs and deallocate TMGIs previously allocated.
#### 9.4.2.2 Nnef_MBSTMGI_Allocate service operation
**Service operation name:** Nnef_MBSTMGI_Allocate
**Description:** This service is used by the NF Service Consumer to request
allocation of TMGI(s), or to refresh the expiry time for already allocated
TMGI(s).
**Inputs, Required:** Number of TMGIs (may be zero if only a refresh of expiry
time is requested).
**Inputs, Optional:** TMGI(s) to be refreshed, MBS service area.
**Outputs, Required:** TMGIs, Expiry Time, Success or not.
**Outputs, Optional:** NID.
#### 9.4.2.3 Nnef_MBSTMGI_Deallocate service operation
**Service operation name:** Nnef_MBSTMGI_Deallocate
**Description:** This service is used by the NF Service Consumer to request
deallocation the TMGI(s).
**Inputs, Required:** TMGI(s).
**Inputs, Optional:** None.
**Outputs, Required:** Success or not.
**Outputs, Optional:** None.
#### 9.4.2.4 Nnef_MBSTMGI_ExpiryNotify service operation
**Service operation name:** Nnef_MBSTMGI_ExpiryNotify
**Description:** This service is used by the NEF to notify the NF service
consumer of the timer expiry for TMGI(s).
**Inputs, Required:** TMGI(s).
**Inputs, Optional:** None.
**Outputs, Required:** None.
**Outputs, Optional:** None.
### 9.4.3 Nnef_MBSSession Service
#### 9.4.3.1 General
**Service description:** This service operates on the multicast and broadcast
MBS sessions. The following are the key functionalities of this NF service:
\- Create/Update Delete for both multicast and broadcast MBS session, or for a
location dependent MBS session, the part of the MBS session within a service
area;
\- Provide a Notification about subscribed events. The following events are
supported:
\- MBS session release due to TMGI expiry.
\- Broadcast delivery status.
#### 9.4.3.2 Nnef_MBSSession_Create service operation
**Service operation name:** Nnef_MBSSession_Create
**Description:** Create a new multicast session or broadcast session, or for a
location dependent MBS session, the part of the MBS session within a service
area. Optionally implicitly subscribe to notifications for this MBS session.
**Input, Required:** MBS Session ID (SSM or TMGI) or TMGI allocation request,
MBS Service Type (broadcast or multicast).
**Input, Optional:** MBS service area (mandatory for broadcast. Can be Cell ID
list and/or TAI list, or geographical area information, or civic address
information), MBS start time, MBS stop time, MBS Service Information (as
defined in clause 6.14), Input Transport Address Request, session state
(Active/Inactive), for subscription to notifications notification target
address. For a multicast session, indication that any UE may join the
multicast session. Request for location dependent MBS session. For a broadcast
session, MBS FSA ID(s), Associated Session ID for resource sharing across
broadcast MBS Sessions during network sharing.
**Output, Required:** Result Indication.
**Output, Optional:** TMGI, NID, Cause, MB-UPF tunnel info, MBS FSA ID(s),
Area Session ID.
#### 9.4.3.3 Nnef_MBSSession_Update service operation
**Service operation name:** Nnef_MBSSession_Update
**Description: This service is used by** the NF service consumer to update the
established multicast session or broadcast session, or for a location
dependent MBS session, the part of the MBS session within a service area, e.g.
QoS update. For multicast MBS Session, this service is also used to activate
or deactivate the MBS Session.
**Input, Required:** MBS Session ID.
**Input, Optional:** MBS Service Information (as defined in clause 6.14), MBS
service area, session state (Active/Inactive), Area Session ID. For a
broadcast session, MBS FSA ID(s).
**Output, Required:** Result Indication.
**Output, Optional:** Cause, MBS FSA ID(s).
#### 9.4.3.4 Nnef_MBSSession_Delete service operation
**Service operation name:** Nnef_MBSSession_Delete
**Description: This service is used** to delete the multicast or broadcast MBS
session, or for a location dependent MBS session, the part of the MBS session
within a service area.
**Input, Required:** MBS Session ID.
**Input, Optional:** Area Session ID.
**Output, Required:** Result Indication.
**Output, Optional:** Cause.
#### 9.4.3.5 Nnef_MBSSession_StatusNotify service operation
**Service operation name:** Nnef_MBSSession_StatusNotify
**Description:** This service is used by the MB-SMF to notify the NF service
consumers of the subscribed events related to an MBS session, or for a
location dependent MBS session, related to the part of the MBS session within
a service area.
**Inputs, Required:** Status Information, MBS Session ID.
**Inputs, Optional:** Area Session ID.
**Outputs, Required:** None.
**Outputs, Optional:** None.
#### 9.4.3.6 Nnef_MBSSession_StatusSubscribe service operation
**Service operation name:** Nnef_MBSSession_StatusSubscribe
**Description:** This service is used by the NF service consumers to subscribe
to the MBS Session status information of an MBS session, or for a location
dependent MBS session, of the part of the MBS session within a service area.
**Inputs, Required:** Status Information, MBS Session ID.
**Inputs, Optional:** Area Session ID.
**Outputs, Required:** None.
**Outputs, Optional:** None.
#### 9.4.3.7 Nnef_MBSSession_StatusUnsubscribe service operation
**Service operation name:** Nnef_MBSSession_StatusUnsubscribe
**Description:** This service is used by the NF service consumers to
unsubscribe to the MBS Session status information of an MBS session or for a
location dependent MBS session, of the part of the MBS session within a
service area.
**Inputs, Required:** Status Information, MBS Session ID.
**Inputs, Optional:** Area Session ID.
**Outputs, Required:** None.
**Outputs, Optional:** None.
### 9.4.4 Nnef_MBSGroupMsg Service
#### 9.4.4.1 General
**Service description:** NF Service Consumer can use this service to request
group message delivery or to modify or to cancel previously submitted group
message delivery.
#### 9.4.4.2 Nnef_MBSGroupMsgDelivery_Create service operation
**Service operation name:** Nnef_MBSGroupMsgDelivery_Create
**Description:** This service is used by the NF Service Consumer to request
group message delivery.
**Inputs, Required:** Group Message Payload, MBS service area, Group Message
Delivery Start Time, Stop Time, External Group Identifier.
**Inputs, Optional:** None.
**Outputs, Required:** Group Message Correlation ID, Delivery Status, service
announcement information.
**Outputs, Optional:** Cause, service area without MBS capability.
#### 9.4.4.3 Nnef_MBSGroupMsgDelivery_Update service operation
**Service operation name:** Nnef_MBSGroupMsgDelivery_Update
**Description:** This service is used by the NF Service Consumer to replace
group message delivery.
**Inputs, Required:** Group Message Correlation ID, External Group Identifier.
**Inputs, Optional:** Group Message Payload, MBS service area, Group Message
Delivery Start Time, Stop Time.
**Outputs, Required:** Acceptance Status
**Outputs, Optional:** Cause, service area without MBS capability.
#### 9.4.4.3a Nnef_MBSGroupMsgDelivery_Delete service operation
**Service operation name:** Nnef_MBSGroupMsgDelivery_Delete
**Description:** This service is used by the NF Service Consumer to recall (or
cancel) group message delivery.
**Inputs, Required:** Group Message Correlation ID, External Group Identifier.
**Inputs, Optional:** None.
**Outputs, Required:** Acceptance Status.
**Outputs, Optional:** Cause.
#### 9.4.4.4 Nnef_MBSGroupMsgDelivery_StatusNotify service operation
**Service operation name:** Nnef_MBSGroupMsgDelivery_StatusNotify
**Description:** This service is used by the NEF to notify the NF service
consumers of the status of a group message delivery.
NOTE: This notification corresponds to an implicit subscription.
**Inputs, Required:** Status Information, Group Message Correlation ID.
**Inputs, Optional:** None.
**Outputs, Required:** None.
**Outputs, Optional:** None.
## 9.5 MBSF Services
MBSF services are defined in TS 26.502 [18].
###### ## Annex A (normative): Configuration options at Service and/or
Application for MBS
Figure A-1 provides the reference architecture with all configuration variants
for Application Function interaction with 5G Core Network, usage of NEF or
MBSF in the control plane, and usage of N6, MB2-U or xMB-U in user plane.
Figure A-1: Configuration options at Service and/or Application
The following characteristics describe each of the Configuration options:
\- Configuration Option 1: No MBSF:
\- This configuration is used for Transport Only Mode (i.e. MBS provides only
transport of MBS data in a transparent manner without modifying the data),
when the Multicast service or Broadcast service does not require service layer
interworking with LTE MBMS.
\- The control plane entry point for the Application Function outside the
trusted domain towards 5GC to request establishment of an MBS session is the
NEF via N33.
\- An application function within the trusted domain can directly use the N30,
N5 and N29mb service based interfaces. In this case some NEF functionality
related to PCF and MB-SMF interaction is incorporated in AF.
NOTE 1: Application function within the trusted domain selects MB-SMF based on
e.g. its local configuration, or query NRF based on location, etc.
\- The user plane entry point for the Application Function towards 5GC is the
MB-UPF via N6mb.
\- Configuration Option 2: MBSF, N33 towards AF:
\- This configuration may be used for Service Mode (i.e. MBS provides service
layer capability, allows to modify the data), or when service layer
interworking with LTE MBMS is required, or when the functionalities of MBS
security is used (see clause 6.13).
\- When interworking with LTE MBMS for Transport Only Mode services, N33/Nmb5
and Nmb8 provide the same functionalities as N33/N13mb and N6mb respectively.
\- The control plane entry point from the Application Function to request
establishment of an MBS session is the NEF via N33.
\- The user plane entry point for the Application Function towards 5GC is the
MBSTF via MB2-U, xMB-U or Nmb8.
\- The NEF and MBSF may be collocated.
\- If the MBSF is not collocated with the NEF, the reference point between the
NEF and MBSF is Nmb5.
\- An application function within the trusted domain may be collocated with
MBSF.
\- Configuration Option 3: MBSF, MB2-C/xMB-C/Nmb10 towards AF:
\- This configuration may be used for Service Mode (xMB-C or Nmb10), or when
interworking with LTE MBMS is required (MB2-C, xMB-C or Nmb10), or when the
functionalities of MBS security is used (see clause 6.13).
\- When interworking with LTE MBMS for Transport Only Mode services, Nmb10 and
Nmb8 provide the same functionalities as Nmb13 and N6mb respectively.
\- The control plane entry point from the Application Function to request
establishment of an MBS session is the MBSF via MB2-C, xMB-C or Nmb10.
\- The user plane entry point for the Application Function is the MBSTF via
MB2-U, xMB-U or Nmb8.
For service mode, MBSF shall be used, i.e. either Configuration 2 or
Configuration 3 shall be used. In this case, the MBSF instructs the MBSTF to
modify the MBS data (e.g. including the FEC or MBS data transcoding).
For Configuration Option 2 and Option 3, when interworking with LTE MBMS is
used, LTE MBMS and MBS use the same mode (i.e. both use Transport Only Mode or
Service Mode).
For Transport Only mode:
\- If interworking with LTE MBMS at 5GC is required for the service, MBSF and
MBSTF shall be used, i.e. either Configuration 2 or Configuration 3 shall be
used.
\- If interworking with LTE MBMS is not required for the service, MBSF and
MBSTF are optional.
NOTE 2: Interworking providing by AF is out of scope of this specification.
MBSTF shall be used when MBSF is used.
Any particular deployment may support any combination of these configurations.
###### ## Annex B (informative): Service levels for multicast communication
service
The following service levels for the multicast communication service are
defined:
NOTE 1: Transport Only mode and Full-Service mode of operation as defined in
TS 23.246 [8] differ from the service levels defined here.
\- **Basic service level**. The following requirements are defined:
\- Media transported transparently through the 5GS.
\- Interactions between UE and network for receiving the multicast
communication service.
\- Packet distribution from the 5GS ingress to NG-RAN node(s).
\- Data delivery from NG-RAN node(s) to the UE.
\- **Enhanced service level** , with additional requirements on top of basic
service level. Different requirements out of the set below may be necessary to
address each use case:
\- Local MBS service.
\- User authentication and authorization for Multicast MBS session.
NOTE 2: User authentication and authorization is an optional feature in 5GS.
\- Explicit configuration of Multicast MBS session by AF, including group
member information.
\- Enhanced QoS support. E.g. to differentiate MBS data flow with different
QoS over 5GS.
###### ## Annex C (normative): Interworking at reference points MB2 and xMB
To allow the MBS System to interwork with a GCS AS supporting the MB2
interfaces defined in TS 23.468 [10]:
\- In addition to supporting the Nmbsf service-based API at Nmb10 (as defined
in clause 5.1) the MBSF shall support interfaces MB2 C.
\- In addition to supporting content ingest interfaces defined in TS 26.502
[18] at Nmb8 (as defined in clause 5.1) the MBSTF shall support interfaces MB2
U.
To allow the MBS System to interwork with a Content Provider supporting the
xMB interfaces defined in TS 26.348 [11]:
\- In addition to supporting the Nmbsf service-based API at Nmb10 (as defined
in clause 5.1) the MBSF shall support interface xMB C.
\- In addition to supporting content ingest interfaces defined in TS 26.502
[18] at Nmb8 (as defined in clause 5.1) the MBSTF shall support interface xMB
U.
Figure C-1: Interworking with GCS AS supporting MB2 interfaces and with
Content Provider supporting xMB interfaces
#