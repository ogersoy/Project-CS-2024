# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document defines the enhancements to Stage 2 system architecture,
procedure and flows, Policy and Charging Control for the 5G System defined in
TS 23.501 [2], TS 23.502 [3] and TS 23.503 [4] in order to support wireline
access network and Fixed Wireless Access. The specifications defined in TS
23.501 [2], TS 23.502 [3] and TS 23.503 [4] apply to the wireline access
network and Fixed Wireless Access.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G system, Stage 2\".
[4] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G
System\".
[5] BBF TR-124 issue 5: \"Functional Requirements for Broadband Residential
Gateway Devices\".
[6] BBF TR-101 issue 2: \"Migration to Ethernet-Based Broadband Aggregation\".
[7] BBF TR-178 issue 1: \"Multi-service Broadband Network Architecture and
Nodal Requirements\".
[8] CableLabs DOCSIS MULPI: \"Data-Over-Cable Service Interface Specifications
DOCSIS 3.1, MAC and Upper Layer Protocols Interface Specification\".
[9] BBF TR-456 issue 2: \"AGF Functional Requirements\".
[10] BBF WT-457: \"FMIF Functional Requirements\".
NOTE: Technical Report of BBF WT-457 will be TR-457 which will be available
when finalized by BBF.
[11] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\".
[12] BBF TR-177 Issue 1 Corrigendum 1: \"IPv6 in the context of TR-101\".
[13] IETF RFC 6788: \"The Line-Identification Option\".
[14] 3GPP TS 23.003: \"Numbering, Addressing and Identification\".
[15] Void.
[16] IETF RFC 6603: \"Prefix Exclude Option for DHCPv6-based Prefix
Delegation\".
[17] Void.
[18] BBF TR-069: \"CPE WAN Management Protocol\".
[19] BBF TR-369: \"User Services Platform (USP)\".
[20] IETF RFC 3046: \"DHCP Relay Agent Information Option\".
[21] IETF RFC 4604: \"Using Internet Group Management Protocol Version 3
(IGMPv3) and Multicast Listener Discovery Protocol Version 2 (MLDv2) for
Source-Specific Multicast\".
[22] 3GPP TR 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[23] 3GPP TS 38.413: \"NG RAN; NG Application Protocol (NGAP)\".
[24] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[25] 3GPP TS 22.011: \"Service accessibility\".
[26] 3GPP TS 23.122: \"Non-Access-Stratum (NAS) functions related to Mobile
Station (MS) in idle mode\".
[27] CableLabs WR-TR-5WWC-ARCH: \"5G Wireless Wireline Converged Core
Architecture\".
[28] IETF RFC 3376: \"Internet Group Management Protocol, Version 3\".
[29] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS)\".
[30] BBF TR-198: \"DQS:DQM systems functional architecture and requirements\".
[31] 3GPP TS 23.203: \"Policy and charging control architecture\".
[32] 3GPP TS 33.126: \"Lawful Interception Requirements\".
[33] IETF RFC 2236: \"Internet Group Management Protocol, Version 2\".
[34] IETF RFC 4861: \"Neighbor Discovery for IP version 6 (IPv6)\".
[35] IETF RFC 1112: \"Internet Group Management Protocol\".
[36] IETF RFC 2710: \"Multicast Listener Discovery Version for IPv6\".
[37] IETF RFC 2010: \"Operational Criteria for Root Name Servers\".
[38] BBF TR-470: \"5G FMC architecture\".
[39] 3GPP TS 29.519: \"Policy Data, Application Data and Structured Data for
exposure\".
[40] 3GPP TS 23.041: \"Public Warning System\".
[41] IEEE Publication (2017): \"Guidelines for Use of Extended Unique
Identifier (EUI), Organizationally Unique Identifier (OUI), and Company ID
(CID)\". https://standards.ieee.org/content/dam/ieee-
standards/standards/web/documents/tutorials/eui.pdf.
[42] 3GPP TS 29.413: \"Application of the NG Application Protocol (NGAP) to
non-3GPP access\".
[43] Void.
[44] 3GPP TS 24.502: \"Access to the 3GPP 5G Core Network (5GCN) via non-3GPP
access networks\".
[45] 3GPP TS 23.402: \" Architecture enhancements for non-3GPP accesses\".
[46] BBF TR-181: \"Device Data Model for TR-069\".
[47] IETF RFC 8415: \"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1], TS 23.501 [2] , TS 23.502 [3] and TS 23.503 [4] apply. A term
defined in TS 23.501 [2], TS 23.502 [3] or TS 23.503 [4] takes precedence over
the definition of the same term, if any, in any other specifications.
**RG Level Wireline Access Characteristics:** Wireline access technology
specific QoS information corresponding to a specific wireline access
subscription, which is provided by the AMF to the W-AGF at RG registration.
**Wireline access Control Plane protocol (W-CP)** : Protocol used to transport
AS and NAS signalling between the 5G-RG and the W-AGF over the Y4 reference
point. W-CP is specified by BBF and CableLabs. There is no assumption that
W-CP refers to only a single protocol or only a specific protocol layer.
**Wireline access User Plane protocol (W-UP)** : Protocol used to carry PDU
Session user plane traffic between the 5G-RG and the W-AGF over the Y4
reference point. W-UP is specified by BBF and CableLabs. There is no
assumption that W-UP refers to only a single protocol or only a specific
protocol layer.
**Legacy Wireline access Control Plane protocol (L-W-CP)** : L-W-CP is a
legacy control plane protocol between the FN-RG and W-AGF. L-W-CP is specified
by BBF and CableLabs. There is no assumption that L-W-CP refers to only a
single protocol or only a specific protocol layer.
**Legacy Wireline access User Plane protocol (L-W-UP)** : L-W-UP is a legacy
user plane protocol between the FN-RG and W-AGF. W-UP is specified by BBF and
CableLabs. There is no assumption that L-W-UP refers to only a single protocol
or only a specific protocol layer.
**Authenticable Non-3GPP (AUN3) device:** A device that does not support NAS
signalling, is connected to 5GC via a RG and can be authenticated by 5GC over
the RG.
5GS specifications do not support a device using the same subscription to
access 5GS as a UE and as an AUN3 device.
**Non-Authenticable Non-3GPP (NAUN3) device:** A device that does not support
NAS signalling, is connected to 5GC via a RG and for which authentication with
5GC is not supported.
NOTE 1: AUN3 and NAUN3 device can connect to RG through WLAN (collocated or
not collocated with the RG) and/or wired Ethernet connections.
NOTE 2: A device can operate as a UE over NG-RAN and as a AUN3 or NAUN3 via a
RG, if the device implements UE functionality.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], TS 23.501 [2], TS 23.502 [3] and TS 23.503 [4] apply. An abbreviation
defined in TS 23.501 [2], TS 23.502 [3] or TS 23.503 [4] takes precedence over
the same abbreviation, if any, in any other specifications.
5G-RG 5G Residential Gateway
5G-BRG 5G Broadband Residential Gateway
5G-CRG 5G Cable Residential Gateway
ACS Auto-Configuration Server
FN-RG Fixed Network RG
FN-BRG Fixed Network Broadband RG
FN-CRG Fixed Network Cable RG
FWA Fixed Wireless Access
IGMP Internet Group Management Protocol
L-W-CP Legacy Wireless access Control Plane Protocol
L-W-UP Legacy Wireless access User Plane Protocol
MLD Multicast Listener Discovery
RG Residential Gateway
RG-LWAC RG Level Wireline Access Characteristics
SNPN Stand-alone Non Public Network
USP User Services Platform
W-5GAN Wireline 5G Access Network
W-5GCAN Wireline 5G Cable Access Network
W-5GBAN Wireline BBF Access Network
W-CP Wireline access Control Plane protocol
W-UP Wireline access User Plane protocol
# 4 High level features
This clause specifies high level description equivalent to TS 23.501 [2].
## 4.1 General
The roaming support for W-5GAN access is not specified in this release.
The usage of Trusted or Untrusted access to 5GC by a 5G-RG or by a FN RG is
not applicable.
## 4.2 Network Access Control
### 4.2.0 General
This clause specifies the delta related to network access control defined in
TS 23.501 [2] clause 5.2.
### 4.2.1 Network selection
In the case of 5G-RG or FN-RG connected via W-5GAN the PLMN selection
specification defined in TS 22.011 [25] and in TS 23.122 [26] and the SNPN
selection specification defined in TS 24.502 [44] is not applicable. The HPLMN
is implicitly selected by wired physical connectivity between 5G-RG or FN-RG
and W-AGF.
NOTE 1: The 5G-RG or FN-RG can only connect to a single physical wired access
W-5GAN to a W-AGF configured at line provisioning by the operator, in addition
no PLMN information is advertised by AS protocols in W-5GAN, since the Network
selection feature is not supported.
The roaming scenario is not supported in this Release of the specification.
In the case of 5G-RG connected via FWA TS 23.501 [2] clause 5.2.2 applies with
the following difference:
\- The PLMN selection defined in TS 22.011 [25] and in TS 23.122 [26] applies
with the UE replaced by 5G-RG.
### 4.2.2 Identification and authentication
In the case of 5G-RG connected via W-5GAN or FWA, the specification defined in
TS 23.501 [2] clause 5.2.3 applies with the following difference:
\- UE is replaced by 5G-RG.
In the case of FN-RG connected via W-5GAN, the specification defined in TS
23.501 [2] clause 5.2.3 applies with the following differences:
\- UE is replaced by FN-RG.
\- The W-AGF provides the NAS signalling connection to the 5GC on behalf of
the FN-RG.
\- The W-5GAN may authenticate the FN-BRG per BBF specification BBF TR-456 [9]
and WT-457 [10]. The W-5GAN may authenticate the FN-CRG per CableLabs DOCSIS
MULPI [8].
### 4.2.3 Authorisation
In the case of 5G-RG connected via W-5GAN or FWA, the specification defined in
TS 23.501 [2] clause 5.2.4 applies with the following differences:
\- UE is replaced by 5G-RG.
In the case of FN-RG connected via W-5GAN, the specification defined in TS
23.501 [2] clause 5.2.4 applies with the following differences:
\- UE is replaced by FN-RG.
\- W-AGF performs the UE Registration procedure on behalf of the FN-RG.
### 4.2.4 Access control and barring
In the case of 5G-RG or FN-RG connected via W-5GAN the Access Control and
Barring defined in TS 23.501 [2] clause 5.2.5 is not applicable.
In the case of 5G-RG connected via FWA the specification defined in TS 23.501
[2] clause 5.2.5 applies with the following difference:
\- UE is replaced by 5G-RG.
### 4.2.5 Policy control
Policy control is specified in clause 9.
### 4.2.6 Lawful Interception
In the case of 5G-RG connected via FWA the specification defined in TS 23.501
[2] clause 5.2.7 applies with the following difference:
\- UE is replaced by 5G-RG.
In the case of 5G-RG connected via W-5GAN, the definition and functionality of
Lawful Interception defined in TS 33.126 [32] applies with the following
difference:
\- UE is replaced by 5G-RG.
In the case of FN-RG connected via W-5GAN, the definition and functionality of
Lawful Interception defined in TS 33.126 [32] applies with the following
difference:
\- UE is replaced by FN-RG, with e.g. the difference that FN-RG may not have a
globally unique PEI (as described in clause 4.7.7) and does not hold any 3GPP-
based subscriber credentials or subscriber identity information.
## 4.3 Registration and Connection Management
### 4.3.1 Registration management
Registration management when 5G-RG or FN-RG is connected to 5GC via wireline
access is described in TS 23.501 [2] clause 5.5.1.
Registration management when 5G-RG is connected to 5GC via NG RAN access is
described in TS 23.501 [2], clause 5.3.2.
### 4.3.2 Connection management
Connection management when 5G-RG or FN-RG is connected to 5GC via wireline
access is described in clause 5.5.2 of TS 23.501 [2].
Connection management when 5G-RG is connected to 5GC via NG RAN access is
described in clause 5.3.3 of TS 23.501 [2].
### 4.3.3 Mobility Restrictions
#### 4.3.3.1 General
Mobility Restrictions restrict service access of an 5G-RG depending on RG
location.
For a 5G-RG connecting over NG-RAN, the Mobility Restriction functionality as
described in clause 5.3.4.1 of TS 23.501 [2] applies.
For an 5G-RG connecting over wireline access, the Mobility Restriction
functionality is described in this clause.
Mobility restrictions do not apply to scenarios with FN-BRG.
NOTE 1: Since access to 5GC for FN-BRG subscriptions are identified by a SUPI
determined from the GLI as described in clause 4.7.3 and clause 4.7.8. Such
subscriptions are by definition restricted to a specific location.
NOTE 2: For FN-CRG subscriptions, HFC Node ID is used to identify the location
of FN-CRG, thus service area restrictions for the FN-CRG can be identified by
an HFC_Node ID, or by a list of HFC_Node ID.
Mobility Restrictions for wireline access consists of Forbidden Area and
Service Area Restrictions, as described in the following clauses.
#### 4.3.3.2 Management of Forbidden Area in wireline access
In a Forbidden Area, the 5G-RG, based on subscription, is not permitted by the
5GC to initiate any communication with the 5GC for this PLMN or SNPN.
The UDM stores the Forbidden Area for wireline access in the same way as for
3GPP access, with the following differences:
\- For subscriptions for 5G-BRG, GLI is used to describe the Forbidden Area.
\- For subscriptions for 5G-CRG and FN-CRG, HFC Node IDs are used to describe
the Forbidden Area (instead of TA).
\- The Forbidden Area in UDM can be encoded as a \"allow list\" indicating the
non-forbidden area. In this case all GLI or HFC_Node ID values not included in
the list are considered forbidden.
NOTE: The use of \"allow list\" is to ensure an efficient Forbidden Area
definition if only a small set of GLI / HFC Node ID values are not forbidden.
Forbidden Area is enforced by AMF, based on subscription data and the location
information received from W-AGF. The AMF rejects a Registration Request from a
5G-RG or the W-AGF acting on behalf of a FN-CRG in a Forbidden Area with a
suitable cause code. The 5G-RG behaviour depends on the network response
(cause code from AMF) that informs the RG that communication is forbidden.
#### 4.3.3.3 Management of Service Area Restrictions in wireline access
The subscription data in the UDM for a 5G-BRG includes a Service Area
Restriction which may contain either Allowed or Non-Allowed Areas specified by
using explicit GLI(s) and/or other geographical information (e.g.,
longitude/latitude, zip code, etc.).
The subscription data in the UDM for a 5G-CRG and FN-CRG includes a Service
Area Restriction which may contain either Allowed or Non-Allowed Areas
specified by using explicit HFC Node IDs and/or other geographical information
(e.g., longitude/latitude, zip code, etc.).
The geographical information used to specify allowed or non-allowed area is
only managed in the network, and the network will map it to a list of GLI(s)
or HFC Node IDs before sending Service Area Restriction information to the
PCF.
The UDM stores the Service Area Restrictions for the 5G-RG or FN-CRG as part
of the subscription data. The PCF in the serving network may (e.g. due to
varying conditions such as 5G-RG\'s location, time and date) further adjust
Service Area Restrictions of a 5G-RG, either by expanding an allowed area or
by reducing a non-allowed area. The UDM and the PCF may update the Service
Area Restrictions of a 5G-RG or a FN-CRG at any time.
During registration, if the Service Area Restrictions of the 5G-RG or FN-CRG
is not present in the AMF, the AMF fetches from the UDM the Service Area
Restrictions of the 5G-RG or FN-CRG that may be further adjusted by the PCF.
The serving AMF shall enforce the Service Area Restrictions of a 5G-RG and a
FN-CRG. The AMF receives the location information (GLI, HFC Node IDs) where
the RG is connected from the W-AGF via N2.
The network does not send any Allowed Area or Non-Allowed Area to the 5G-RG
for wireline access. If the 5G-RG initiates communication in an Allowed Area,
the network accepts the communication as allowed by the subscription. If the
5G-RG initiates Service Request or SM signalling in a Non-Allowed Area, the
AMF rejects the request with a suitable cause code indicating that the
5G-RG/W-AGF should not retry Service Request and SM signalling while being
connected to the same line.
Upon change of serving AMF due to mobility, the old AMF may provide the new
AMF with the Service Area Restrictions of the 5G-RG that may be further
adjusted by the PCF.
## 4.4 Session management
### 4.4.0 General
This clause specifies the delta related to session management defined in TS
23.501 [2] clause 5.6.
The LADN service defined in clause 5.6.5 in TS 23.501 [2] does not apply for
RG connected to 5GC via wireline access.
When handling DHCP signalling coming from a wireline BBF access, the SMF (as
well as an external DHCP server used by SMF) shall support the DHCP signalling
as described in in BBF TR-456 [9].
NOTE: As described in clause 5.6.14 of TS 23.501 [2], to enable Framed Routes
for a PDU Session, SMF can take the UPF capabilities for Framed Routes into
account when selecting a UPF for a PDU Session.
### 4.4.1 Session management for 5G-RG
Session management of 5G-RG connected to 5GC via wireline access follows the
principle defined in TS 23.501 [2] clause 5.6 with the following difference:
\- UE is replaced by 5G-RG.
\- 5G-RG is connected to 5GC via wireline RAT type instead of 3GPP access.
### 4.4.2 Session management for FN-RG
Session management of FN-RG follows the principle defined in TS 23.501 [2]
clause 5.6 with the follow difference:
\- UE is replaced by W-AGF
\- FN-RG is connected to 5GC via wireline access instead of 3GPP access.
\- Secondary authentication/authorization by a DN-AAA server during the
establishment of a PDU Session is applicable neither to FN-RG nor to N5GC
devices.
\- For FN-BRG, only SSC modes 1 or 2 can be used, depending on the type of FN-
BRG as described in TRâ€‘456 [9] and WT-457 [10].
## 4.5 QoS model
### 4.5.0 General overview
The QoS model of TS 23.501 [2] clause 5.7 is applicable to the W-5GAN
scenario, with the difference that the W-AGF acts as an Access Network (AN).
The principle for classification and marking of User Plane traffic and mapping
of QoS flows to W-UP resources is illustrated in Figure 4.5-1.
Figure 4.5-1: The principle for classification and User Plane marking for QoS
Flows and mapping to W-UP resources for a PDU Session
When the W-AGF receives N2 requests related with PDU Session resources, the
W-AGF maps the QoS profile(s) received from the 5GC to W-UP level QoS.
When the 5G-RG receives NAS message related with PDU Session QoS, the 5G-RG
maps the QoS rule(s) received in NAS to W-UP level QoS.
One W-UP resource can be used as the default W-UP resource. There shall be one
and only one Default W-UP resource per PDU session. The 5G-RG shall send all
QoS Flows to this W-UP resource for which there is no mapping information to a
specific W-UP resource.
Handling of UL traffic by the 5G-RG:
\- When the 5G-RG transmits an UL PDU, the 5G-RG shall determine the QFI
associated with the UL PDU (by using the QoS rules of the PDU Session), it
shall encapsulate the UL PDU inside an access layer dependent W-UP packet and
shall forward the W-UP packet to W-AGF via the W-UP resource associated with
this QFI.
Handling of DL traffic by W-AGF:
\- When the W-AGF receives a DL PDU via N3, it identifies of the PDU Session
and optionally the QFI in order to determine the W-UP resource to use for
sending the DL PDU to the 5G-RG. The W-AGF may include also in the W-UP header
the Reflective QoS Indicator (RQI), which shall be used by the 5G-RG to enable
reflective QoS.
The W-AGF will map 5QI received from the 5GC into access-specific QoS
parameters relevant to the wireline access network. The mapping of 5QI to
W-5GBAN QoS parameters is specified by the BBF for W-5GBAN in [9]. The mapping
of 5QI to W-5GCAN QoS parameters is specified for W-5GCAN in CableLabs WR-
TR-5WWC-ARCH [27].
QFI or other QoS parameters are carried via W-UP to the 5G-CRG as specified in
CableLabs WR-TR-5WWC-ARCH [27].
The QFI and RQI are carried via W-UP to 5G-RG as specified in BBF TR-456 [9].
### 4.5.1 Wireline access specific 5G QoS parameters
#### 4.5.1.0 Overview
The 5G QoS parameters specified in clause 5.7.2 of TS 23.501 [2] are
applicable to wireline access network, with the following differences:
\- The parameters defined in clause 4.5.1.2 are applicable for the wireline
access network related PDU sessions.
\- UE-AMBR is not applicable to wireline access. The AMF should not provide
the subscribed UE-AMBR to the W-AGF.
#### 4.5.1.1 Void
#### 4.5.1.2 RG Level Wireline Access Characteristics
The wireline access networks may exhibit QoS control mechanisms and related
thresholds, such as QoS class specific maximum bit rates, which the W-AGF
needs to be aware of, in order to provide appropriate mapping of the QoS
characteristics of the 5G QoS flows to the wireline technology specific QoS
parameters.
These wireline access characteristics are considered to be relevant for a
specific wireline access subscription, and correspond to RG level QoS
information in the 5GC.
While the wireline access characteristics are important for implementing the
end to end QoS mechanisms, across the 5G-RG/FN-RG, the W-5GAN and the 5GC,
they only need to be acted on in the 5G-RG/FN-RG and the W-5GAN.
In order to support the W-AGF in implementing the mapping between 5G QoS
parameters and wireline access specific parameters, the AMF may provide the RG
Level Wireline Access Characteristics (RG-LWAC) to the W-AGF at the time of
the RG registration. When the UDM notifies the AMF of the updated RG-LWAC via
Nudm_SDM_Notification service, the AMF may update the RG-LWAC to the W-AGF via
NGAP UE Context Modification procedure.
Given that the 5GC does not act on these parameters, their structure is out of
scope in 3GPP specifications and they are handled as a transparent data
container. BBF and CableLabs may define the content and structure of this
container for their own use.
The UE subscription data parameters RG Level Wireline Access Characteristics
are defined in clause 8.1.1.
### 4.5.2 QoS model applied to FN-RG
The FN-RG does not support 3GPP signalling and therefore, mapping and
interworking between 5G QoS and the wireline access network resources is
managed by the W-AGF on behalf of the FN-RG.
The mapping of W-5GAN resources and 5GC QoS is configured in the W-AGF for the
FN-CRG is specified by CableLabs. Resource management within the W-5GAN for
the FN-CRG is specified by CableLabs.
The mapping of W-5GAN resources and 5GC QoS is configured in the W-AGF for the
FN-BRG is specified by BBF. Resource management within the W-5GAN for the FN-
BRG is specified by BBF.
### 4.5.3 Differentiated QoS for devices behind 5G-RG
During PDU session establishment and PDU session modification, if the SMF
provides the 5G-RG with QoS flow descriptions, the SMF may additionally signal
Non-3GPP QoS Assistance Information (N3QAI) for each QoS flow to the 5G-RG).
Based on the N3QAI together with QoS rule information, the 5G-RG may reserve
resources in the non-3GPP network behind the 5G-RG (e.g. home LAN network).
N3QAI consists of the following QoS information: QoS characteristics,
GFBR/MFBR, Maximum Packet Loss Rate, ARP and Periodicity (if available at the
SMF).
NOTE 1: How 5G-RG uses the Non-3GPP QoS Assistance Information to enforce QoS
in the non-3GPP network is outside the scope of 3GPP.
NOTE 2: Transferring information like Periodicity to the 5G-RG is not meant to
support TSC/TSN like flows but to support consumer real time applications like
XR (extended Reality, etc.).
## 4.6 User Plane management
### 4.6.1 General
The management of the user plane follows the description in clause 5.8 of TS
23.501 [2] with additional specification described below in this clause.
### 4.6.2 IP address allocation
#### 4.6.2.1 General
IP address allocation is performed as described in TS 23.501 [2] clause
5.8.2.2, with the differences and additions described in this clause.
Stateless IPv6 Address Autoconfiguration applies with the differences
described in clause 4.6.2.4.
In addition to the IP address management features described in TS 23.501 [2]
clause 5.8.2.2 the 5GC network functions and RG support the following
mechanisms:
a. IPv6 address allocation using DHCPv6 may be supported for allocating
individual /128 IPv6 address(es) for a PDU Session. The details of IPv6
address allocation using DHCPv6 are described in clause 4.6.2.2.
b. IPv6 Prefix Delegation using DHCPv6 may be supported for allocating
additional IPv6 prefixes for a PDU Session. The details of Prefix Delegation
are described in clause 4.6.2.3.
The mechanisms in a. and b. above are only applicable for IPv6 and IPv4v6 PDU
Session types.
The requested IPv6 address or set of IPv6 Prefixes may be (as defined in TS
23.501 [2] clause 5.8.2.2.1):
\- allocated from a local pool in the SMF or
\- obtained from the UPF. In that case the SMF shall interact with the UPF via
N4 procedures to obtain a suitable IP address/Prefix, or
\- obtained from an external server.
When obtaining the IP address from the UPF, the SMF provides the UPF with the
necessary information allowing the UPF to derive the proper IP address (e.g.
the network instance, IP version, size of the IP address or Prefix the UPF is
to allocate).
The SMF may also provide IP configuration parameters (e.g. MTU value) to the
5G-RG, as described in clause 5.6.10 of TS 23.501 [2].
NOTE: In order to provide an IP MTU value that is specifically suitable for
W-5GAN without considering N3 in case of combined W-AGF/UPF, the SMF can e.g.
be configured with such MTU for a given DNN and/or for a given slice whether
the DNN and/or the slice only serves wireline access and a UPF combined with
the W-AGF has been selected for the PDU Session.
In this clause, unless specified otherwise, the RG may correspond either to a
5G RG or to a FN RG.
#### 4.6.2.2 IPv6 Address Allocation using DHCPv6
Optionally, and instead of using Stateless IPv6 Address Autoconfiguration,
individual 128-bit IPv6 address(es) may be assigned to a PDU Session.
In this case, after PDU Session Establishment, the SMF sends a Router
Advertisement message (solicited or unsolicited) towards the RG. The SMF shall
set the Managed Address Configuration Flag (M-flag) in the Router
Advertisement messages to indicate towards the RG that IPv6 Address allocation
using DHCPv6 is available, as described in RFC 4861 [34]. In that case the
IPv6 address of the RG is allocated using DHCPv6 Identity Association for Non-
temporary Addresses (IA_NA) and mechanisms defined in RFC 8415 [47].
The SMF may receive a Router Solicitation message, soliciting a Router
Advertisement message.
When using DHCPv6 address allocation, a prefix (e.g. /64) may be allocated for
the PDU Session at PDU Session Establishment from which the /128 addresses are
selected. The SMF determines the size of the prefix for a PDU Session to a
specific DNN and S-NSSAI based on subscription data and local configuration.
The individual /128 address(es) allocated to the RG as part of DHCP IA_NA
procedure are then selected from the prefix allocated to the PDU Session. For
statically assigned prefix, the subscription data in UDM for a DNN and S-NSSAI
includes the prefix. Alternatively, individual 128-bit address(es) are
allocated for the PDU Session without allocating a prefix to the PDU Session
and provided to the RG as part of DHCP IA_NA procedure.
When a prefix is allocated to the PDU Session, the SMF provides the prefix to
the PCF instead of each /128 address. When individual /128 address(es) are
allocated without allocating a prefix to the PDU Session, the SMF provides the
/128 bits address(es) to PCF. Whether the SMF allocates a prefix for the PDU
Session or individual 128-bit addresses is transparent to the RG and W-5GAN.
If Prefix Delegation (as described in clause 4.6.2.3) is also supported, a SMF
may receive both DHCP options for IA_NA and IA_PD together in a single DHCPv6
message. An SMF may provide a reply to both IA_NA and IA_PD in the same
message or alternatively process the DHCPv6 IA_NA before the DHCPv6 IA_PD.
The SMF may receive multiple different IA_NA related DHCP requests within the
same PDU Session.
NOTE: This is applicable if the RG acts as a DHCP relay for devices behind the
RG.
When IPv6 Address Allocation using DHCPv6 is used, 5GC does not support IPv6
multi-homing for enabling SSC mode 3 and PDU Sessions with multiple PDU
Session Anchors.
#### 4.6.2.3 IPv6 Prefix Delegation via DHCPv6
In addition to what is the specified in clause 5.8.2.2.4 of TS 23.501 [2],
there is following difference:
\- UE is replaced by 5G-RG and FN-RG.
\- For IPv6 stateless IPv6 address autoconfiguration or IPv6 address
allocation using DHCPv6, the SMF determines the maximum size of the prefix
that may be allocated for the PDU Session based on subscription data and local
configuration.
\- If IPv6 address allocation using DHCPv6 is used, the DHCPv6 message may
include a request for a delegated prefix (IA_PD) together with a request for
an IPv6 address (IA_NA). Alternatively, a delegated prefix may be requested
after an IPv6 address has been assigned using IA_NA.
\- If the DHCPv6 request indicates support for prefix exclusion via the
OPTION_PD_EXCLUDE option code in an OPTION_ORO option and if the SMF accepts
this option, the SMF delegates a prefix excluding the default prefix with help
of OPTION_PD_EXCLUDE. Prefix exclusion procedures shall follow IETF RFC 6603
[16].
#### 4.6.2.4 The procedure of Stateless IPv6 Address Autoconfiguration
Stateless IPv6 Address Autoconfiguration applies as described in clause
5.8.2.2.3 of TS 23.501 [2] with the differences described below.
When the W-AGF is serving an FN-RG, the W-AGF may include in the PDU Session
Establishment Request an interface identifier of the FN-RG IPv6 link-local
address associated with the PDU Session. If the SMF receives an interface
identifier in the PDU Session Establishment Request message, the SMF provides
this interface identifier value as the UE interface identifier in the PDU
Session Establishment Accept message. To ensure that the link-local address
used by the FN-RG does not collide with the link-local address of the SMF in
this case, the SMF selectes a different link-local address for use as the SMF
link local address for the PDU Session. If the PDU Session Establishment
Request message does not contain an interface identifier, the SMF selects
interface identifier for the UE, and SMF link-local address, as described in
clause 5.8.2.2.3 of TS 23.501 [2].
NOTE 1: An FN-RGs is configuring its IPv6 link local address based on its MAC
address and is not able to use an interface identifier selected by SMF as
described in clause 5.8.2.2.3 of TS 23.501 [2].
In case of wireline access, independent of whether SMF received an interface
identifier in the PDU Session Establishment Request message or not, the SMF
includes the SMF link local address in the PDU Session Establishment Accept
message.
NOTE 2: The SMF link local address is needed by the W-AGF to support
procedures towards the FN-RG defined in BBF TR-456 [9].
### 4.6.3 Packet Detection Rule
PDR used to support PDU Sessions for RG follow the specifications in TS 23.501
[2] clause 5.8.2.11.3 with the clarifications and additions shown below.
For PDU Session used for IPTV service, (see also clause 4.6.6):
\- Packets Filter Set support Packet Filters for IGMP, including IGMPv2
specified in RFC 2236 [33], IGMPv3 specified in RFC 4604 [21], for MLDv1
specified in RFC 2710 [36] and MLDv2 specified in RFC 4604 [21]. The PDR may
also contain IP Multicast addressing information that may refer to ranges of
IP multicast addresses. Such IP Multicast addressing information is not part
of the PDI. The packets filters for IGMPv1 defined in RFC 1112 [35] are not
supported.
### 4.6.4 Forwarding Action Rule
FAR used to support PDU Sessions for RG follow the specifications in TS 23.501
[2] clause 5.8.2.11.6 with the clarifications and additions and difference
shown below.
For PDU Sessions used for IPTV service (see also clause 4.6.6):
\- Following additional \"Action\" values are used to support IPTV service:
\- \"IP Multicast Accept\" indicates whether in the case of IGMP and MLD
Membership Report message to accept the multicast join and add the PDU Session
to the requested multicast group distribution. This may also imply acting as
an IP Multicast Router as described in clause 7.7.1.1
NOTE 1: The IGMP \"Join message\" and MLD \"Join message\" are generic terms
used in this document to indicate the request of a host to join a multicast
group which can express via IGMP and MLD Report message (e.g. Membership
Report) or via Join message.
NOTE 2: In this specification the generic term IGMP refers to both IGMPv2 and
IGMPv3 unless specifically defined. The term MLD refers to both MLDv1 and
MLDV2 unless specifically defined.
\- \"IP Multicast Accept\" indicates that when UPF detects the IGMPv3 Leave
message or a MLD Done message via the PDU Session, the UPF needs also to
ensure that the PDU Session is removed from the requested multicast group
distribution.
\- \"IP Multicast Deny\" indicates that the UPF shall not accept the
corresponding IGMP and MLD Membership Report message to join a multicast
group.
### 4.6.5 Usage Reporting Rule
URR used to support PDU Sessions for RG follow the specifications in TS 23.501
[2] clause 5.8.2.11.5 with the clarifications and additions shown below:
For PDU Sessions used for IPTV service (see also clause 4.6.6), an URR may
indicate a Reporting trigger (defined in TS 23.501 [2] clause 5.8.2.11.5) with
a value Reporting Trigger set to \"IGMP reporting\" for IGMP or set to \"MLD
reporting\" for MLD where the UPF is to report to the SMF when
\- it adds a PDU session to the DL replication tree associated with an IP
Multicast flow;
\- it removes a PDU session from the DL replication tree associated with an IP
Multicast flow.
The corresponding notification shall contain the (Source IP address of the DL
multicast flow, Destination IP address of the DL multicast flow).
NOTE: The corresponding notification can be used by the SMF to report the
information to the PCF and/or to CHF.
### 4.6.6 Usage of N4 to support IPTV
The SMF sends to the UPF acting as PSA N4 rules such as PDR, FAR related to IP
Multicast traffic allowed for the PDU Session of a 5G-RG. IP Multicast traffic
allowed for the PDU Session corresponds to IPTV services allowed for the user.
IP Multicast Addressing information identifies such traffic. In the case
Source Specific Multicast is configured to be used on the PDU Session, IP
Multicast Addressing information refers to both IP Multicast address and
Source IP address.
The SMF may need to take into account UPF capability to support the features
described in this clause when selecting an UPF to serve a PDU Session. For
IPv6 PDU session IPTV services will be based on MLD , for IPV4 PDU session on
IGMP.
N4 rules for IP Multicast traffic related to IPTV service may correspond to:
\- Rules related with UL IGMP or MLD traffic:
\- a PDR identifying IGMP signalling or MLD together with IP Multicast
Addressing information identifying a set of IP multicast groups;
NOTE 1: The IP Multicast Addressing information may correspond to ranges of IP
Multicast addresses
\- a FAR with:
\- an \"IP Multicast Accept\" action in order to request the UPF to accept UE
requests to join the corresponding IP multicast group(s); or
\- an \"IP Multicast Deny\" action in order to request the UPF to deny UE
requests to join the corresponding IP multicast group(s);
\- possibly a URR with a Reporting Trigger set to \"IGMP reporting\" for IGMP
or set to \"MLD reporting\" for MLD.;
\- Rules related with DL IP Multicast traffic:
\- a PDR identifying IP Multicast Addressing information (DL IP Multicast
traffic);
NOTE 2: The IP Multicast Addressing information may correspond to ranges of IP
Multicast addresses
\- a FAR asking to add outer header = GTP-u tunnel related with the PDU
Session of the 5G RG;
\- a QER indicating the QoS to use towards the 5G-RG for the IP Multicast
traffic that has been replicated.
## 4.7 Identifiers
### 4.7.1 General
As described in TS 23.501 [2], each subscriber in the 5G System shall be
allocated one 5G Subscription Permanent Identifier (SUPI) for use within the
3GPP system. As described in TS 23.501 [2], each FN-RG or 5G-RG accessing the
5G System shall be assigned a Permanent Equipment Identifier (PEI).
The clauses below describe specific aspects for supporting 5G-RG and FN-RG.
### 4.7.2 SUPI and SUCI for 5G-BRG support
The SUPI for an 5G-BRG shall contain an IMSI, as described in clause 5.9.2 of
TS 23.501 [2].
The SUCI provided by the 5G-BRG to the network contains the concealed SUPI, as
described in TS 33.501 [11].
### 4.7.3 SUPI and SUCI for FN-BRG support
The SUPI for an FN-BRG subscription shall, based on operator configuration,
either contain an IMSI or a GLI as defined in clause 4.7.8. A SUPI containing
a GLI takes the form of a NAI whose user part is the GLI and whose realm part
is an identifier of the operator owning the subscription.
The SUCI provided by the W-AGF to the 5GC for FN-BRG always corresponds to a
SUPI containing a GLI. This SUCI acts as pseudonym of the SUPI and the UDM
performs a mapping to the actual SUPI that, depending on operator
configuration, contains either an IMSI or the same GLI that was provided in
the SUCI.
As described in TS 23.003 [14], the SUCI also contains an identifier of the
Home network, i.e. the identifier of the operator owning the subscription.
### 4.7.4 SUPI and SUCI for 5G-CRG and FN-CRG support
The SUPI for a FN-CRG subscription shall, based on operator configuration,
contain either an IMSI, as described in clause 5.9.2 of TS 23.501 [2], or a
GCI (Global Cable identifier defined in clause 4.7.9).
The SUPI for a 5G-CRG subscription shall, based on operator configuration,
contain either an IMSI, as described in clause 5.9.2 of TS 23.501 [2], or a
GCI (Global Cable identifier defined in clause 4.7.9).
Only 5G-CRG whose SUPI corresponds to an IMSI may use 3GPP access to connect
to 5GC.
A SUPI containing a GCI takes the form of a NAI where the user part is the GCI
and the realm part is an identifier of the operator managing the subscription.
NOTE 1: The realm part used to identify the operator managing the subscription
can differ depending on whether the wireline access network belongs to a PLMN
or SNPN. The NAI format for SUPI containing GCI for PLMN and SNPN is defined
in TS 23.003 [14].
The SUCI provided by the 5G-CRG to the network contains the concealed SUPI, as
described in TS 33.501 [11].
The SUCI provided to the network for FN-CRG support always corresponds to a
SUPI containing a GCI. This SUCI acts as pseudonym of the SUPI and the UDM
performs a mapping to the SUPI that, depending on operator configuration,
contains either an IMSI or the same GCI than in the SUCI.
As described in TS 23.003 [14], for both cases where the SUCI contains an IMSI
or contains a GCI, the SUCI contains an identifier of the Home network i.e. an
identifier of the operator managing the subscription.
NOTE 2: If the SUCI contains an IMSI, the identifier of the operator managing
the subscription is carried in the MCC/MNC part of the IMSI as defined in TS
23.003 [14].
### 4.7.5 Line ID
The Line ID is defined in BBF Specifications, see BBF TR-470 [38].
### 4.7.6 HFC identifier
The HFC_Identifier may contain a cable modem MAC address or an overall HFC
account identifier, as defined by CableLabs in DOCSIS MULPI [8].
### 4.7.7 PEI
If the 5G-RG (i.e. 5G-BRG and 5G-CRG) supports at least one 3GPP access
technology (i.e. NG-RAN, E-UTRAN), the 5G-RG must be allocated a Permanent
Equipment Identifier (PEI) in the IMEI or IMEISV format, as described in TS
23.501 [2]. The 5G-RG shall present this PEI to the network independent of
access technology used by the 5G-RG (3GPP access technology or W-5GAN access
technology).
If the 5G-BRG supports only W-5GAN access, the PEI shall contain the 5G-BRG
MAC address.
If the 5G-CRG supports only W-5GAN access, the PEI shall contain the cable
modem MAC address.
For FN-RG (i.e. FN-BRG and FN-CRG), the W-AGF shall provide a PEI containing:
\- The FN-RG MAC address: this shall be used by the W-AGF when it is known by
configuration that the MAC address received by the W-AGF is unique (no other
entity can use the same MAC address) and corresponds to the permanent MAC
address configured on the RG by the manufacturer.
NOTE 1: This assumes that the W-AGF can see the actual permanent MAC address
of the FN-RG and not the MAC address of any intermediate entity (e.g. DSLAM).
\- The MAC address received by the W-AGF, together with an indication provided
by the W-AGF that this address cannot be used as an Equipment identifier of
the FN-RG: this shall be used by the W-AGF when the conditions to provide a
PEI containing the FN-RG MAC address are not met.
NOTE 2: This is to support the case of legacy deployments for FN RG where
either multiple FN RG can share the same MAC address or where the MAC address
received by the W-AGF is not that of the FN RG but the MAC address of an
intermediate entity between the FN RG and the W-AGF.
NOTE 3: When the PEI contains an indication that the MAC address cannot be
used as an Equipment identifier of the FN-RG, the PEI cannot be trusted for
regulatory purpose but it can be stored in CDR and used for troubleshooting.
### 4.7.8 Global Line Identifier
For usage with 5GC, a Global Line Identifier (GLI) is specified in order to
define a globally unique identifier of the line connecting the RG to the
network. In this release an RG is associated with a unique GLI.
For FN BRG, the GLI is used to build a SUCI. For FN-BRG the GLI may be used to
build a SUPI. See clause 4.7.3. For all types of RG, the GLI is used as User
Location Information on wireline access.
The GLI contains an identifier of the Line ID source and the Line ID value.
The identifier of the Line ID source ensures the unicity of the GLI while the
Line ID may not be unique in some deployments. The identifier of the Line ID
source and Line ID are administered by the W-AGF operator.
The Global Line Identifier is a variable length identifier encoded as defined
in TS 23.003 [14] and in BBF TRâ€‘470 [38].
### 4.7.9 Global Cable Identifier
For usage with 5GC, a Global Cable Identifier (GCI) is specified in order to
define a globally unique identifier of the line connecting the CRG to the
network. In this release an RG is associated with a unique GCI.
The GCI contains the HFC_Identifier which is defined in CableLabs WR-TR-5WWC-
ARCH [27].
For FN CRG, the GCI is used to build a SUCI. For FN CRG the GCI may be used to
build a SUPI. See clause 4.7.4. For all types of CRG the HFC Node ID is used
to build User Location Information on Cable access.
The identifier of the HFC Node ID and the HFC_Identifier are administered by
the W-AGF operator.
The Global Cable Identifier is a variable length identifier encoded as defined
in TS 23.003 [14] and CableLabs WRâ€‘TRâ€‘5WWCâ€‘ARCH [27].
### 4.7.10 RAT types dedicated for Wireline access
The AMF, as described in TS 23.501 [2] clause 5.3.2.3, determines the RAT Type
for Wireline access, taking into account the Global W-AGF Node ID and possibly
ULI information provided by the W-AGF. The RAT Type may allow to distinguish
between Wireline, Wireline-Cable access andWireline-BBF access.
### 4.7.11 SUPI and SUCI for N5GC device or AUN3 device support
The SUPI for non-5G capable (N5GC) device or AUN3 device connecting via CRG
shall contain a network-specific identifier. A SUPI containing a network-
specific identifier takes the form of a Network Access Identifier (NAI) as
defined in TS 23.003 [14].
The SUCI provided by the W-AGF to the AMF is derived from the EAP-Identity
message received from the N5GC device or AUN3 device, as defined in TS 33.501
[11]. The format of this SUCI is defined in TS 23.003 [14].
## 4.8 Security aspects
TS 23.501 [2] clause 5.10 applies to the FN-CRG with the following deltas:
\- Mutual authentication of the FN-CRG and the wireline access network is
completed as specified by CableLabs DOCSIS MULPI [8]. The successful
completion of the authentication of the FN-CRG is conveyed by the W-AGF
serving the FN-CRG to the AMF.
\- UE is replaced by W-AGF on behalf of the FN-CRG for the balance of TS
23.501 [2] clause 5.10 and clauses.
\- See TS 33.501 [11] for additional requirements
TS 23.501 [2] clause 5.10 applies to the 5G-CRG with the following deltas:
\- The UE is replaced by the 5G-CRG
\- Signalling security aspects between the 5G-CRG and the W-AGF are specified
by CableLabs in WR-TR-5WWC-ARCH [27].
\- See TS 33.501 [11] for additional requirements
## 4.9 Support of specific services
### 4.9.0 General
This clause specifies high level definition of services specific for WWC
scenario.
PWS functionality as described in TS 23.041 [40] is not supported for Wireline
access but may be supported by RG(s) connected over 3GPP access.
### 4.9.1 IPTV
IPTV is defined as multimedia services such as television/video/
audio/text/graphics/data delivered over IP-based networks managed to support
the required level of QoS/QoE, security, interactivity and reliability. STB
obtains IPTV service via RG, including 5G-RG and FN-RG, which are connected to
5GC.
The procedures to support IPTV is specified in clause 7.7.1.
## 4.10 UE behind 5G-RG and FN-RG
An RG connecting via W-5GAN or NG-RAN access towards 5GC can provide
connectivity for a UE behind the RG to access an N3IWF or TNGF. It is assumed
that the UE is 5GC capable, i.e. supports untrusted non-3GPP access and/or
trusted non-3GPP access. This allows the RG, W-5GAN and the RG\'s connectivity
via 5GC to together act as untrusted/trusted N3GPP access to support UEs
behind the RG.
When FN-RG/5G-RG is serving a UE, the control and user plane packets of the UE
is transported using a FN-RG/5G-RG IP PDU session and then from PSA UPF of
that PDU session to an IWF. A single FN-RG/5G-RG IP PDU session can be used to
serve multiple UEs.
Figure 4.10-1 shows the non-roaming architecture for a UE, behind a 5G-RG,
accessing the 5GC via TNGF where the combination of 5G-RG, W-5GAN and UPF
serving the 5G-RG is acting as a trusted Non-3GPP access network.
Figure 4.10-2 shows the non-roaming architecture for a UE, behind a 5G-RG,
accessing the 5GC via TNGF where the combination of 5G-RG, W-5GAN and UPF
serving the 5G-RG is acting as a trusted Non-3GPP access network.
Annex A shows the non-roaming architecture for a UE, behind a FN-RG/5G-RG,
accessing the 5GC via N3IWF where the combination of FN-RG/5G-RG, W-5GAN and
UPF serving the 5G-RG is acting as an untrusted Non-3GPP access network.
NOTE 1: FN-RG and W-5GAN acting as trusted Non-3GPP access is not considered
in this specification as it is assumed that FN-RG does not support EAP-5G.
Figure 4.10-1: Non-roaming architecture for UE behind 5G-RG using trusted
N3GPP access
The 5G-RG can be connected to 5GC via W-5GAN, NG-RAN or via both accesses. The
UE can be connected to 5GC via 5G-RG, NG-RAN or via both accesses.
Figure 4.10-2: Architecture for UE behind 5G-RG using untrusted N3GPP access
The TNGF and Ta reference point are defined in TS 23.501 [2]. In addition to
the requirements described in TS 23.501 [2], the Ta reference point should be
able to carry the TNAP ID to the TNGF.
NOTE 2: The reference architecture in figure 4.10-1 only shows the
architecture and the network functions directly connected to W-5GAN or TNGF,
and other parts of the architecture are the same as defined in clause 4.2 of
TS 23.501 [2].
NOTE 3: The reference architecture in figure 4.10-1 supports service based
interfaces for AMF, SMF and other NFs not represented in the figure.
NOTE 4: The two N2 instances in Figure 4.10-1 apply to a single AMF for a
5G-RG which is simultaneously connected to the same 5G Core Network over 3GPP
access and W-5GAN.
NOTE 5: For trusted non-3GPP access, UE connects to the overlay 5G network
using the trusted non-3GPP access approach. In addition to being connected to
the underlay 5G network, the 5G-RG also acts as TNAP with respect to the TNGF
in the overlay network i.e. it has an established Ta reference point with the
TNGF.
NOTE 6: Support for QoS differentiation can be achieved in a similar way as it
is handled when a UE connects to a PLMN via SNPN (as defined in clauses
5.30.2.7 and D.7 of TS 23.501 [2]). Also differentiated charging, both in the
RG\'s PLMN and in the UE\'s PLMN, can be achieved based on existing
mechanisms. This is further described in Annex B.
Support of NSWO for 3GPP UE behind an RG is specified in clause 4.10d.
NOTE 7: For trusted non-3GPP access, UE connects to the overlay 5G network
using the trusted non-3GPP access approach. In addition to being connected to
the underlay 5G network, the 5G-RG also acts as TNAP with respect to the TNGF
in the overlay network i.e. it has an established Ta reference point with the
TNGF.
A 5G-RG acting as a TNAP shall provide its TNAP ID. to the TNGF and the TNGF
provides this TNAP ID as part of ULI (user Location Information) sent to the
5GC; this information is propagated to the PCF that may use it to determine
PCC rules depending on whether an UE is using a 5G-RG as a host or as a guest.
NOTE 8: QoS and charging differentiation based on user location (e.g. home or
guest users) can be applied when the user is connected via a TNGF reached over
a 5G-RG. The PCF may use the TNAP ID, which is available to it as a part of
ULI. For example, if the TNAP ID is included in the UE\'s policy control
subscription information the UE is considered a home user. Alternatively, the
PCF may use TNAP ID provided by an AF using the Service Specific parameter
provisioning as defined in clause 9.8.
## 4.10a Non-5G capable device behind 5G-CRG and FN-CRG
For isolated 5G networks (i.e. roaming is not considered) with wireline
access, non-5G capable (N5GC) devices connecting via W-5GAN can be
authenticated by the 5GC using EAP based authentication method(s) as defined
in TS 33.501 [11]. The following call flow describes the overall registration
procedure of such a device.
Roaming is not supported for N5GC devices.
The usage of N5GC device correspond to a subscription record in UDM/UDR that
is separate from that of the CRG.
Figure 4.10a-1: 5GC registration of Non-5GC device
1\. The W-AGF registers the FN-CRG to 5GC as specified in clause 7.2.1.3 or
the 5G-CRG registers to 5GC as specified in clause 7.2.1.1.
2\. The CRG is configured as L2 bridge mode and forwards any L2 frame to
W-AGF. 802.1x authentication may be triggered. This can be done either by N5GC
device sending a EAPOL-start frame to W-AGF or W-AGF receives a frame from an
unknown MAC address.
How the CRG is configured to work in L2 bridge mode and how the W-AGF is
triggered to apply procedures for N5GC devices is defined in CableLabs WR-
TR-5WWC-ARCH [27].
The N5GC device send an EAP-Resp/Indentity including its Network Access
Identifier (NAI) in the form of username\@realm.
3\. W-AGF, on behalf of the N5GC device, sends a NAS Registration Request
message to AMF with a device capability indicator that the device is non-5G
capable. For this purpose, the W-AGF creates a NAS Registration Request
message containing a SUCI. The W-AGF constructs the SUCI from the NAI received
within EAP-Identity from the N5GC device as defined in TS 33.501 [11].
Over N2 there is a separate NGAP connection per N5GC device served by the
W-AGF.
When it provides (over N2) ULI to be associated with a N5GC device, the W-AGF
builds the N5GC\'s ULI using the GCI (see clause 4.7.9) of the CRG connecting
the N5GC device.
NOTE: How the W-AGF determines the CRG connecting a N5GC device is specified
in CableLabs WR-TR-5WWC-ARCH [27].
4\. AMF selects a suitable AUSF as specified in TS 23.501 [2] clause 6.3.4.
5\. EAP based authentication defined in TS 33.501 [11] is performed between
the AUSF and N5GC device.
Once the N5GC device has been authenticated, the AUSF provides relevant
security related information to the AMF. AUSF shall return the SUPI (this SUPI
corresponds to a NAI that contains the username of the N5GC device and a realm
as defined in TS 33.501 [11]) to AMF only after the authentication is
successful.
NOTE: Each N5GC device is registered to 5GC with its own unique SUPI.
6\. The AMF performs other registration procedures as required (see TS 23.502
[3] clause 4.2.2.2.2).
When providing a PEI for a N5GC device, the W-AGF shall provide a PEI
containing the MAC address of the N5GC device. The W-AGF may, based on
operator policy, encode the MAC address of the N5GC device using the IEEE
Extended Unique Identifier EUI-64 format (see IEE Publication [41]).
7\. The AMF sends Registration Accept message to W-AGF.
Once the registration procedure is completed, the W-AGF requests the
establishment of a PDU Session on behalf of the N5GC device. Only one PDU
session per N5GC device is supported. The procedure is the same as the PDU
Session establishment procedure specified in clause 7.3.4 with the difference
as below:
After successful registration, PDU Session establishment/modification/release
procedure specified in clause 7.3.4, 7.3.6, and 7.3.7 apply with the
difference as below:
\- FN-RG is replaced by N5GC device.
The W-AGF shall request the release of the NGAP connection for each N5GC
device served by a CRG whose NGAP connection has been released.
5G-CRG behaves as FN-CRG (i.e. L2 bridge mode) when handling N5GC devices.
## 4.10b Differentiated services for NAUN3 devices behind 5G-RG
NAUN3 devices cannot be authenticated by 5GC but may e.g. be locally
authenticated by the 5G-RG using pre-shared secret. Differentiated services
(QoS, network slicing) may be provided for NAUN3 devices as defined in this
clause.
NAUN3 devices may be associated with \"Connectivity Group IDs\" where each
Connectivity Group ID corresponds to a separate physical or virtual port on
the 5G-RG. These ports could, for example, refer to separate physical ethernet
ports and/or to separate WLAN SSIDs and/or to a separate VLAN. The devices
that connect to a certain logical port are considered part of the same
Connectivity Group ID. How this configuration on the 5G-RG is done is out of
scope of this specification.
Each Connectivity Group ID is then mapped to a separate PDU Session that is
established by the 5G-RG based on the procedures defined in clause 7. The
overall architecture is illustrated in Figure-4.10b-1.
Figure 4.10b-1: Example scenario for NAUN3 devices behind 5G-RG based on
connectivity groups
The 5G-RG is configured with the (virtual) port information (e.g. VLANs and
SSIDs) based on TR-69 [18], TR-360 and TR-181 [46]. URSP rules can be provided
to the RG to indicate how to map Connectivity Group ID to the parameters of
the PDU Session used to carry the traffic of corresponding devices e.g. DNN,
S-NSSAI, etc.
NOTE: In addition, the mapping between a \"virtual port\" and DNN/S-NSSAI can
be configured via TR-69 [18]/TR-181 [46].
How the NAUN3 devices are configured to use a specific SSID or connect to a
certain Ethernet port on the 5G-RG is out of scope of this specification.
Differentiation of charging and QoS may be provided via PCC rules (for
different service flows) related with dedicated PDU Sessions for NAUN3
devices. Isolation of devices using a specific Connectivity Group ID into a
specific network slices, i.e. with separate S-NSSAIs may also be provided.
## 4.10c Authenticable Non-3GPP devices behind 5G-RG
This clause defines the support of AUN3 devices, i.e. Authenticable Non-3GPP
devices (AUN3) as defined in clause 3.1, behind a 5G-RG. This clause applies
only to 5G-RG connected via wireline access.
Figure 4.10c-1 shows the architecture for support of AUN3 device.
Figure 4.10c-1: AUN3 device behind 5G-RG
Differentiated services for AUN3 devices behind 5G-RG are provided as
specified below:
\- Each AUN3 device has its own UDM/UDR subscription data including its own
SUPI and policy control subscription data.
\- The interface between 5G-RG and AUN3 devices is out of scope of 3GPP.
\- In order to serve the AUN3 device in 5GC, a 5G-RG issues a NAS register and
handles RM and CM related signalling on behalf of an AUN3 device that it is
requesting to be served and relays EAP signalling between the AUN3 device and
the 5GC.
\- A 5G-RG serving an AUN3 device establishes a single PDU Session on behalf
on this AUN3 device.
\- The AMF and the 5G-RG maintain a separate NAS connection per AUN3 device.
This includes maintaining a GUTI and NAS (RM, CM, security, etc.) context per
AUN3 device.
\- A 5G-RG shall be connected to the 5GC (be in RM-REGISTERED and CM-CONNECTED
mode) over Wireline access to serve an AUN3 device: the 5G-RG shall not issue
a NAS register or service request on behalf of an AUN3 device if it is itself
not registered and connected to the 5GC.
\- The 5G-RG is configured with URSP for each AUN3 devices it serves. The UE
PCF selected by the AMF at the registration of an AUN3 device sends this URSP
to 5G-RG via the AMF and the NAS connection of the AUN3 device.
\- The AUN3 devices and the 5G-RG belong to the same PLMN.
\- A 5G-RG uses default values, which are the same for all AUN3 devices it
serves, to populate the parameters in the Registration Request message built
on behalf of an AUN3 device. For example, the 5G-RG issues the Registration
Request with no S-NSSAI and the AMF selects the default S-NSSAI in the
subscription of the AUN3 device.
\- There shall be a separate N2 connection per AUN3 device that is in state
CM-CONNECTED.
\- The W-CP and W-UP protocols shall be able to manage multiple separate
Registrations and PDU Sessions for different SUPIs between the same pair of
5G-RG and W-AGF. In particular, W-CP needs to be able to differentiate NAS
messages related to a 5G-RG and to each different AUN3 device served by this
5G-RG and W-UP needs to distinguish between user plane packets for a 5G-RG and
each different AUN3 device served by this 5G-RG.
\- When the registration of an AUN3 device has successfully completed, the
5G-RG establishes a PDU Session on behalf of the AUN3 device. This PDU Session
is handled by 5GC as part of the AUN3 subscription and is associated with the
SUPI of AUN3 device. An AUN3 device can at a given time only use a single PDU
Session. The parameters to establish this PDU session are based on the URSP
(if any) for the AUN3 device.
\- Different QoS parameters may apply to PDU sessions of different AUN3
devices.
\- Roaming is not applicable to subscriptions for AUN3 devices.
## 4.10d Support of NSWO for 3GPP UE behind a RG
NSWO as defined in clauses 4.2.15 and 5.42 of TS 23.501 [2] may be supported
for UE(s) connected via a 5G-RG, and/or for UE(s) connected via a FN-RG.
When this feature is supported, the RG and the W-5GAN need to support the WLAN
Access functionality defined in clauses 4.2.15 and 5.42 of TS 23.501 [2]. The
WLAN Access functionality includes the support of the SWa\' interface to
NSWOF. The SWa\' support in Wireline access network has no impact on 3GPP
specifications.
NOTE: W-5GAN specifications and deployments can ensure that a AAA proxy is
used to support SWa\' interface with NSWOF(s) on behalf of RG(s). This can be
used for FN-RG that do not support SWa\'. This AAA proxy does not need to
support the functionalities of a 3GPP AAA proxy defined in TS 23.402 [45].
When NSWO applies, the user plane traffic of the UE is not traversing the
UE\'s 5GC.
The specification of functionalities to support NSWO in the wireline access
network is out of 3GPP scope including specifications on how the offloaded
traffic is carried in W-5GAN and bypass the 5GC of the UE.
Editor\'s note: For BBF and CableLabs wireline access the above text will
refer to the associated BBF and CableLabs specifications when these
specifications are available.
The UE can also connect to 5GC using 5GS credentials as defined in clause 5.42
of TS 23.501 [2].
A 5G RG shall not issue authentication request over SWa\' for the UE if it is
itself not registered to 5GC.
## 4.11 Fixed Wireless Access
For the 5G-RG connected to 5GC via NG-RAN the specifications defined TS 23.501
[2], TS 23.502 [3] and TS 23.503 [4] applies with the following modification:
\- The UE corresponds to the 5G-RG.
\- The 5G-RG may support LTE access connected to EPC and EPC interworking as
defined in TS 23.501 [2], clause 5.17. This is controlled by SMF Selection
Subscription data defined in Table 5.2.3.3.1-1 of TS 23.502 [3].
\- The configuration of 5G-RG via ACS server based on TR-069 [18] and TR-369
[19] is specified clause 9.6.
\- The Home Routing roaming is supported for 5G-RG connected via NG RAN in
this release.
\- 5G Multi-Operator Core Network (5G MOCN) is supported for 5G-RG connected
via NG RAN as defined in clause 5.18 of TS 23.501 [2]
\- The LBO roaming for 5G-RG connected via NG RAN is not specified in this
release.
\- The LADN service defined in clause 5.6.5 in TS 23.501 [2] applies to the
5G-RG connected to 5GC via 3GPP access. The specification in clause 5.6.5 in
TS 23.501 [2] applies via 5G-RG replacing UE with the following difference:
\- UE Configuration Update procedure is referred to the procedures in clause
7.2.3.1.
NOTE 1: HR roaming over 3GPP access is defined for 5G_RG but in some countries
it can not apply due to local regulations.
\- If the 5G-RG is registered via both 3GPP access and W-5GAN, and the AMF has
received W-AGF identities from the AGF, the AMF may provide the W-AGF
identities to the SMF also when AMF forwards N1 SM container sent by the 5G-RG
via 3GPP access.
NOTE 2: If the SMF receives the W-AGF information also in case of 5G-RG
sending a PDU Session Establishment via 3GPP access, based on operator
configuration, the SMF can take this into account for selecting a UPF
collocated with the W-AGF.
## 4.12 Hybrid Access
### 4.12.1 General
This clause specifies the support of Hybrid Access considering both the
support of PDU session and MA PDU session.
Hybrid Access applies to a 5G-RG capable of connecting to both NG-RAN and to
W-5GAN. Hybrid Access also applies to a 5G-RG capable of connecting to
W-5GAN/5GC and E-UTRAN/EPC using EPC interworking architecture. Hybrid Access
does not apply to FN-RG.
The following Hybrid Access scenarios are supported with single-access PDU
sessions:
\- Hybrid Access using PDU session carried only on a single access, either NG-
RAN or W-5GAN, but that cannot be simultaneously on both accesses. Such PDU
Session can be handed over between NG-RAN and W-5GAN using procedures
described in clause 4.9.2 of TS 23.502 [3], but with UE replaced by 5G-RG and
N3IWF replaced by W-5GAN.
\- Hybrid Access using single access connectivity for 5G-RG supporting LTE/EPC
and EPC interworking. In that case mobility between W-5GAN/5GS and E-UTRAN/EPC
is handled using interworking procedures described in clause 4.11.3 of TS
23.502 [3], but with UE replaced by 5G-RG and N3IWF replaced by W-5GAN.
The following Hybrid Access scenarios are supported with multi-access
connectivity:
\-- Hybrid Access with Multi-Access PDU Session connectivity over NG-RAN and
W-5GAN and operator-controlled traffic steering. This scenario is further
detailed in clause 4.12.2.
\- Hybrid Access with simultaneous multi-access connectivity to LTE/EPC and
W-5GAN/5GS using EPC interworking. This scenario is further detailed in clause
4.12.3.
In this Release of the specification, a RG that supports MA PDU Sessions and
LTE/EPC access as described in clause 4.12.2, shall also support MA PDU using
LTE/EPC as 3GPP access as defined in clause 4.12.3.
### 4.12.2 Hybrid Access with Multi-Access PDU Session connectivity over NG-
RAN and W-5GAN
This clause applies to the case where multi-access PDU Session connectivity
via NG-RAN and W-5GAN is supported in the 5G-RG and network. The Hybrid Access
architecture of 5G-RG is defined in TS 23.501 [2] in Figure 4.2.8.4-1. This
scenario uses the ATSSS solution described in clause 5.33 of the Release 16
version of TS 23.501 [2], with the following difference:
\- UE is replaced by 5G-RG.
\- Non-3GPP access(es) is specifically referred to wireline access.
The Release 17, ATSSS functionalities defined in TS 23.501 [2], TS 23.502 [3]
and TS 23.503 [4] are not supported, except for the feature described in
clause 4.12.3.
### 4.12.3 Hybrid Access with multi-access connectivity over E-UTRAN/EPC and
W-5GAN
#### 4.12.3.1 General
This clause applies to the case where multi-access connectivity via both EPC
and 5GC is supported in the 5G-RG and network. In this case, multi-access
connectivity using ATSSS via both EPC and 5GC may be provided as described in
this clause.
For a 5G-RG, a Multi-Access PDU Session may use user-plane resources of an
associated PDN Connection on 3GPP access in EPC. This enables a scenario where
a MA PDU Session can simultaneously be associated with user-plane resources on
3GPP access network connected to EPC and W-5GAN connected to 5GC. Such a PDN
Connection in EPS would thus be associated with multi-access capability in
5G-RG and PGW-C+SMF.
The feature is supported as defined in clause 5.32 of TS 23.501 [2] (Release
17) and TS 23.502 [3] (Release 17) with following differences:
\- UE is replaced by 5G-RG.
\- 5G-RG is connected to 5GC via a non-3GPP access corresponding to W-5GAN.
\- MA PDU Sessions of Ethernet PDU Session type where the 3GPP access
corresponds to E-UTRAN/EPC are not applicable for 5G-RG.
#### 4.12.3.2 Void
#### 4.12.3.3 Void
## 4.13 Support of FN-RG
FN-RG is a legacy type of residential gateway that does not support N1
signalling and is not 5GC capable. The architecture to support FN-RG is
depicted in clause 4.2.8.4 in TS 23.501 [2]. Support for FN-RG connectivity to
5GC is provided by means of W-AGF supporting 5G functionality on behalf of the
FN-RG, e.g. UE NAS registration and session management functionality. In
particular, the W-AGF supports the following functionality on behalf of the
FN-RG:
\- Has access to configuration information, as defined in BBF TR-456 [9],
WT-457 [10] and CableLabs WR-TR-5WWC-ARCH [27], to be able to serve FN-RGs and
to construct AS and NAS messages.
\- Acting as end-point of N1 towards AMF, including maintaining CM and RM
states and related dynamic information received from 5GC. This also includes
support of URSP.
\- Mapping between Y5 towards FN-RG and N1/N2 towards 5GC as well as mapping
between a Y5 user plane connection and a PDU Session user plane tunnel on N3.
Authentication of FN-RG may be done by the W-AGF, as defined by BBF and
Cablelabs. The W-AGF provides an indication on N2 that the FN-RG has been
authenticated. The W-AGF also provides a SUCI or a 5G-GUTI as described in TS
23.501 [2].
## 4.14 Support of slicing
Slicing as defined in TS 23.501 [2] is supported with following clarifications
and modifications:
\- 5G-RG may receive USRP rules mapping application flows to S-NSSAI (and
other 5GC related parameters). For 5G-RG, the detection of application flows
may refer to traffic from devices within the customer premises.
NOTE: In this case, even though an URSP rule refers to the IP PDU Session
type, Non-IP Traffic descriptors e.g. layer 2 related Traffic descriptors can
be used to identify application flows.
\- For 5G-RG access over 3GPP access (FWA), slicing is supported as described
in TS 23.501 [2].
\- For 5G-RG access over Wireline, the Wireline access is assumed to be able
to carry slicing information in W-CP together with NAS signalling between the
5G-RG and the W-AGF.
\- The W-AGF shall support the same requirements for AMF selection based on
slicing request from the UE than defined for N3IWF / TNGF in TS 23.501 [2]
clause 5.15.
## 4.15 Support for IMS services
When FN RG is used, support IMS Emergency sessions without a SUPI are not
supported.
## 4.16 Access to non-public networks via wireline access network
### 4.16.1 Access to SNPN services via wireline access network
Access to SNPN defined in clause 5.30 of TS 23.501 [2] via a wireline access
network follows the same specification and procedures used for accessing a
PLMN via a wireline access with the following modifications:
\- The SNPN is implicitly selected by wired physical connectivity between
5G-RG or FN-RG and W-AGF.
\- In the case of 5G-RG connected via FWA, the 5G-RG shall support the
capability defined for the SNPN-enabled UE as specified in clauses 5.30.2.3
and 5.30.2.4.1 of TS 23.501 [2] where the UE is replaced by 5G-RG.
\- The access to SNPN via FN-CRG is supported as follows: the W-AGF is
configured to use a SNPN Identifier (as defined in clause 5.30.2.1 of TS
23.501 [2]) instead of a PLMN Identifier in the procedure for FN-CRG
Registration via W-5GAN defined in clause 7.2.1.3. The access to SNPN via FN-
BRG is not supported in this Release.
\- The SUPI for a 5G-CRG containing IMSI is described in clause 5.9.2 of TS
23.501 [2]. The SUPI in NSI type may include the NID of SNPN as defined in
clause 28.7.2 of TS 23.003 [14].
\- The SUPI for a 5G-CRG and FN-CRG containing GCI is specified in clause
4.7.4 and in clause 28.15.2 of TS 23.003 [14]. The realm part of NAI format
for a SUPI containing a GCI identifying the operator owning the subscription
may include the NID of the SNPN.
\- The SUPI for a 5G-BRG and FN-BRG containing GLI is specified in clauses
4.7.2, 4.7.3 and 28.16.2 of TS 23.003 [14]. The realm part of NAI format for a
SUPI containing a GLI identifying the operator owning the subscription may
include the NID of the SNPN.
\- RG using credentials owned by a Credentials Holder separate from the SNPN
is not applicable. UE behind RG accessing to SNPN via N3IWF or TNGF as defined
in clause 4.10 with credentials owned by Credentials Holder is supported as
specified in clause 5.30.2.9 of TS 23.501 [2] where the Credentials Holder\'s
AAA server or AUSF are reachable via N3IWF or TNGF. The support of UE behind a
RG accessing to SNPN with credentials owned by Credentials Holder directly
reachable from RG, i.e. without N3IWF and TNGF, is not specified in this
Release.
\- The onboarding procedure specified in clause 5.30.2.10 of TS 23.501 [2] is
not applicable in this Release for a RG.
### 4.16.2 Access to Public Network Integrated NPN services via wireline
access network
Considering that the Public Network Integrated NPNs are NPNs made available
via PLMNs e.g. by means of dedicated DNNs, or by one (or more) Network Slice
instances allocated for the NPN and that the W-AGF may support more than one
network slices and different W-AGFs may support different sets of network
slices, therefore the access to PNI-NPN defined in clause 5.30 of TS 23.501
[2] via a wireline access network applies with the following modifications:
\- In case of 5G-RG and FN-RG connected via wired physical connectivity to
W-AGF the Closed Access Group does not apply to 5G-RG/FN-RG and to W-AGF. The
access restriction is implicitly applied since the RG\'s subscription
information includes only the relevant network slice(s) (i.e. the network
slice(s) related to PLMN and NPI-NPN subscribed) and the fact the 5G-RG/FN-RG
is physically connected to W-AGF implies that the subscribed slice(s) are
applicable from the user physical location.
\- In the case of 5G-RG connected via FWA, the 5G-RG may support the CAG
procedure as specified in clause 5.30.3 of TS 23.501 [2] where the 5G-RG
replaces the UE.
NOTE: The connection via FWA is not applicable to a FN-RG.
# 5 Network Function
## 5.0 General
This clause specifies the definition network function specific for W-AGF and
the delta to network function defined in TS 23.501 [2].
## 5.1 Network Function Functional description
### 5.1.1 W-AGF
The functionality of W-AGF in the case of Wireline 5G Access network includes
the following:
\- Termination of N2 and N3 interfaces to 5G Core Network for control - plane
and user-plane respectively.
\- Handling of N2 signalling from SMF (relayed by AMF) related to PDU Sessions
and QoS.
\- Relaying uplink and downlink user-plane packets between the 5G-RG and UPF
and between FN-RG and UPF. This involves:
\- Enforcing QoS corresponding to N3 packet marking, taking into account QoS
requirements associated to such marking received over N2.
\- N3 user-plane packet marking in the uplink.
\- Supporting AMF discovery and selection defined in TS 23.501 [2] clause
6.3.5 where the 5G-S-TMSI is not used for AMF selection since the wireline AS
layer can only carry the GUAMI.
\- Termination of wireline access protocol on Y4 and Y5.
\- In the case of FN-RG the W-AGF acts as end point of N1 on behalf of the FN-
RG.
In the case of Wireline 5G Broadband Access network the definition of W-AGF
functionalities is specified in BBF TR-456 [9] and WT-457 [10].
NOTE: The W-AGF is specified as AGF (Access Gateway Function) in BBF TR-456
[9] for supporting 5G-RG and FN-RG and as FMIF (Fixed Mobile Interworking
Function) for supporting FN-RG only in the case of presence of BNG in WT-457
[10]. Both cases for FN-RG support, i.e. AGF and FMIF, have identical
interfaces towards 5GC, i.e. it is transparent to 5GC whether AGF or FMIF is
used and no difference between AGF or FMIF cases is defined in this
specification.
In the case of Wireline 5G Cable Access network the definition of W-AGF
functionalities is specified by Cablelabs WR-TR-5WWC-ARCH [27].
# 6 Control and User Plane Protocol Stacks
## 6.1 General
This clause specifies the protocol stacks between 5G-RG, FN-RG and 5GS
entities for supporting W-5GAN.
## 6.2 Control Plane Protocol Stacks for W-5GAN
### 6.2.1 Control Plane Protocol Stacks between the 5G-RG and the 5GC
Figure 6.2.1-1: Control Plane stack for W-5GAN for 5G-RG
The control plane protocol stack between 5G-RG and AMF is defined in figure
6.2.1-1.
For W-5GBAN, the W-CP protocol stack between 5G-BRG and W-AGF is defined in
BBF TR-456 [9]. For W-5GCAN, the W-CP protocol stack between 5G-CRG and W-AGF
is defined in WR-TR-5WWC-ARCH [27].
The protocol stack between 5GC/AMF and W-AGF is defined in TS 23.501 [2]
clause 8.
The W-CP protocol stack:
\- supports transfer of NAS signalling between the 5G-RG and the W-AGF;
\- supports to carry AS parameters (e.g. SUCI or 5G-GUTI, Requested NSSAI and
Establishment Cause) and NAS packets;
\- supports the setup, modification and removal of at least one W-UP resource
per PDU session;
\- may support the setup, modification and removal of multiple W-UP resources
per PDU session.
For the 5G-RG connected via NG-RAN the protocol stack defined in TS 23.501 [2]
clause 8.2.2 applies with UE corresponding to 5G-RG.
### 6.2.2 Control Plane Protocol Stacks between the FN-RG and the 5GC
Figure 6.2.2-1: Control Plane stack for W-5GAN for FN-RG
The control plane protocol stack between FN-RG and AMF is defined in figure
6.2.2-1. The W-AGF acts as an N1 termination point on behalf of FN-RG.
For W-5GBAN, the L-W-CP protocol stack, between FN-BRG and W-AGF is defined in
BBF TR-456 [9] and WT-457 [10]. For W-5GCAN, the L-W-CP protocol stack between
FN-CRG and W-AGF is defined in WR-TR-5WWC-ARCH [27].
## 6.3 User Plane Protocol Stacks for W-5GAN
### 6.3.1 User Plane Protocol Stacks between the 5G-RG and the 5GC
Figure 6.3.1-1: User Plane stack for W-5GAN for 5G-RG
The user plane protocol stack between 5G-RG and UPF is defined in figure
6.3.1-1.
For W-5GBAN, the W-UP protocol stack between 5G-BRG and W-AGF is defined in
BBF TR-456 [9]. For W-5GCAN, the W-UP protocol stack between 5G-CRG and W-AGF
is defined in WR-TR-5WWC-ARCH [27].
The protocol stack between 5GC/UPF and W-AGF is defined in TS 23.501 [2]
clause 8.
For the W-UP protocol stack:
\- W-UP supports at least one W-UP resource per PDU session. This will be the
default W-UP resource.
\- W-UP may support multiple W-UP resources per PDU session and associate
different QoS profiles (QFIs) to different W-UP resources.
\- W-UP supports transmission of uplink and downlink PDUs according to clause
4.5.
\- W-UP supports access specific QoS parameters that can be mapped from 3GPP
QoS parameters (e.g.5QI, RQI) received from the 5GC.
For the 5G-RG connected via NG-RAN the protocol stack defined in TS 23.501 [2]
clause 8.3.1 applies with 5G-RG replacing the UE.
### 6.3.2 User Plane Protocol Stacks between the FN-RG and the 5GC
Figure 6.3.2-1: User Plane stack for W-5GAN for FN-RG
The user plane protocol stack between FN-RG and UPF is defined in figure
6.3.2-1.
For W-5GBAN, the L-W-UP protocol stack between FN-BRG and W-AGF is defined in
BBF TR-456 [9] and WT-457 [10]. For W-5GCAN, the L-W-UP protocol stack between
FN-CRG and W-AGF is defined in WR-TR-5WWC-ARCH [27].
# 7 System procedure
## 7.1 General
This clause describes the differences in respect the procedures defined in TS
23.502 [3] clause 4.
## 7.2 Connection, Registration and Mobility Management procedures
The listed parameters in the procedures are not exhaustive, but more
parameters can be used as described in the protocol specifications.
Where parameters have not been described, the meaning of the parameter is the
same as for 3GPP access as described in TS 23.502 [3], TS 24.501 [22], TS
38.413 [23].
### 7.2.1 Registration Management procedures
This clause specifies delta for Registration Management procedure defined in
TS 23.502 [3] clause 4.2 for 5G-RG and FN-RG.
#### 7.2.1.1 5G-RG Registration via W-5GAN
The 5G-RG registration management procedures are followed for both W-5GBAN and
W-5GCAN.
Clause 7.2.1.1 specifies how a 5G-RG can register to 5GC via aW-5GAN. It is
based on the Registration procedure specified in TS 23.502 [3] clause
4.2.2.2.2. The NAS protocol is transported between 5G-RG and W-AGF as
documented in BBF TRâ€‘456 issue 2 [43] and CableLabs WRâ€‘TRâ€‘5WWCâ€‘ARCH [27]. If
the 5G-RG needs to be authenticated, mutual authentication is executed between
the 5G-RG and AUSF. The details of the authentication procedure are specified
in TS 33.501 [11]. In Registration and subsequent Registration procedures via
W-5GAN access, the NAS messages are always exchanged between the 5G-RG and the
AMF. When possible, the 5G-RG can be authenticated by reusing the existing UE
security context in AMF for the 5G-RG.
Figure 7.2.1.1-1 only shows authentication flow using EAP-AKA\' (specifically
in step 6c, step 7a and step 7b) but other methods are possible:
Authentication procedures that 5G-RG and the 5GC shall support, are specified
in TS 33.501 [11]. Specific EAP authentication methods (see TS 33.501 [11])
for 5G-CRG with non-3GPP identities and credentials may be used for isolated
network (see TS 33.501 [11]).
Figure 7.2.1.1-1: 5G-RG Registration via W-5GAN
1\. The 5G-RG connects to a W-5GAN with procedures outside the scope of 3GPP
and creates an initial signalling connection using W-CP protocol stack. This
connection shall support transfer of AS parameters and NAS messages between
5G-RG and W-AGF.
2\. Void.
3\. The 5G-RG using W-CP protocol stack sends a message that contains the
Access Network parameters (GUAMI if available, the selected PLMN or SNPN,
Requested NSSAI and Establishment Cause) and a NAS Registration Request
message (SUCI or 5G-GUTI as defined in TS 24.501 [22], security parameters/UE
security capability, NSSAI parameters, UE MM Core Network Capability, PDU
session status, Follow-on request). The Establishment cause provides the
reason for requesting a signalling connection with 5GC.
NOTE 1: While PLMN or SNPN selection is not supported for W-5GAN access, the
5G RG provides a selected PLMN or SNPN ID in Access Network parameters sent to
the W-AGF. In this version of the specifications, this selected PLMN or SNPN
ID is the home domain of the SUCI. This information is transparently
transferred from 5G RG to AUSF via the W-AGF and the AMF; it ensures the AUSF
and the 5G RG consider the same information for Key derivations defined in TS
33.501 [11].
NOTE 2: The steps from 1 to 3 depend on BBF decision for what protocols to use
for NAS transport. The step needs to be revised based on their decision.
4\. The W-AGF shall select an AMF based on the received AN parameters and
local policy, as specified in clause 6.3.5 of TS 23.501 [2]. The W-AGF shall
then forward the Registration Request received from the UE to the selected AMF
within an N2 initial UE message (NAS message, ULI, Establishment cause, UE
context request, selected PLMN or SNPN ID).
5\. The selected AMF may decide to request the SUCI by sending a N2 Downlink
NAS transport message (NAS Identity Request) message to W-AGF. This NAS
message and the response are sent between W-AGF and 5G-RG as described in BBF
TR-456 [43] and CableLabs WRâ€‘TRâ€‘5WWCâ€‘ARCH [27]. In this case the RG shall
answer with a NAS Identity response.
6\. The AMF may decide to authenticate the 5G-RG by invoking an AUSF. In this
case, the AMF shall select an AUSF as specified in TS 23.501 [2] clause 6.3.4
based on SUPI or SUCI. As defined in 33.501 [11], the AMF transfers the SUCI
and the selected PLMN or SNPN ID to the AUSF.
The AUSF executes the authentication of the UE as specified in TS 33.501 [11].
The AUSF selects a UDM as described in clause 6.3.8 of TS 23.501 [2] and gets
the authentication data from UDM. The authentication packets are encapsulated
within NAS authentication messages. Between W-AGF and AMF, the messages are
encapsulated within N2 downlink/uplink NAS transport messages. After the
successful authentication the AUSF provides relevant security related
information to the AMF. If the AMF provided a SUCI to AUSF, the AUSF shall
return the SUPI to AMF only after the authentication is successful.
The AMF decides if the Registration Request needs to be rerouted as described
in clause TS 23.502 [3] clause 4.2.2.2.3, where the initial AMF refers to the
AMF.
7a. If NAS security context does not exist, the NAS security initiation is
performed as described in TS 33.501 [11]: the AMF initiates NAS Security Mode
command. If the 5G-RG had no NAS security context in step 1, the UE includes
the full Registration Request message as defined in TS 24.501 [22]. If an EAP-
AKA\' authentication was successfully executed in step 6, the AMF shall
encapsulate the EAP-Success received from AUSF within the NAS Security Mode
Command message. The message is encapsulated within a N2 downlink NAS
transport message.
The AMF initiates a NGAP/N2 procedure to provide the 5G-AN with security
context as specified in TS 38.413 [23].
7b. The W-AGF shall forward the NAS Security Mode Command message to 5G-RG.
7c. The 5G-RG completes the authentication procedure (if initiated in step 6),
creates a NAS security context as defined in TS 33.501 [11] and sends the NAS
Security Mode Complete message (IMEISV) to the AMF.
7d. The W-AGF relays the NAS Security Mode Complete message to the AMF in a N2
Uplink NAS transport message.
8\. [Conditional] The AMF may request the PEI from the 5G-RG as described in
clause 4.2.2.2.2, step 11 of TS 23.502 [3].
9\. The AMF performs step 12-16 in TS 23.502 [3] clause 4.2.2.2.2. At AMF
registration to UDM for the 5G-RG, the Access Type non-3GPP access is used.
The RAT type used toward PCF and UDM shall indicate wireline access. The AMF
determines Access Type and RAT Type based on the Global RAN Node ID associated
with the N2 interface.
10\. The AMF sends an N2 Initial Context Setup Request message as defined in
TS 38.413 [23] and TS 29.413 [42] possibly including as additional W-AGF
specific parameter the RG Level Wireline Access Characteristics.
11a. Void.
11b. Void.
12\. W-AGF notifies the AMF that the 5G-RG context was created by sending a N2
Initial Context Setup Response.
13\. The AMF sends N2 Downlink NAS transport with the NAS Registration Accept
message (as defined in step 21 TS 23.502 [3] clause 4.2.2.2.2) to the W-AGF,
which forwards the NAS Registration accept message to the 5G-RG.
14\. [Conditional] The 5G-RG responds with NAS Registration Complete message
as described in TS 23.502 [3] clause 4.2.2.2.2 step 22 and W-AGF forwards the
NAS Registration Complete message to AMF in a N2 Uplink NAS transport message.
The N2 Uplink NAS transport message to AMF may contain W-AGF identities. The
AMF stores the received W-AGF identities in the UE context.
NOTE 3: The W-AGF identities contains a list of Identifiers (i.e. a list of
FQDN and/or IP address(es)) of N3 terminations at W-AGF and can be used by SMF
as input to select an UPF during PDU Session Establishment, as described in
clauses 7.3.1.1 and 7.3.4.
15\. The AMF performs step 23-24 in TS 23.502 [3] clause 4.2.2.2.2.
#### 7.2.1.2 5G-RG Deregistration via W-5GAN
Figure 7.2.1.2-1: 5G-RG Deregistration procedure via W-5GAN
1\. The Deregistration procedure is triggered by one of the events:
1a. For 5G-RG-initiated Deregistration as in Figure 4.2.2.3.2-1, steps 1 to 7
of TS 23.502 [3].
1b. For network initiated deregistration as in Figure 4.2.2.3.3-1, steps 1 to
6 of TS 23.502 [3].
If the 5G-RG is in CM-CONNECTED state either in 3GPP access, W-5GAN access or
both:
\- the AMF may explicitly deregister the 5G-RG by sending a Deregistration
request message (Deregistration type, access type set to -W-5GAN) to the 5G-RG
as in Figure 4.2.2.3.3-1, step 2 of TS 23.502 [3]. The 5G-RG will interpret
access type set to non-3GPP as referring to wireline access.
\- the UDM may want to request the deletion of the subscribers RM contexts and
PDU Sessions with the reason for removal set to subscription withdrawn to the
registered AMF as in Figure 4.2.2.3.3-1, step 1 of TS 23.502 [3].
2\. AMF to W-AGF: The AMF sends a N2 UE Context Release Command message to the
W-AGF with the cause set to Deregistration to release N2 signalling as defined
in clause 4.12.4.2, step 4 of TS 23.502 [3].
3\. The W-AGF may initiate the release of the signalling connection between
5G-RG and W-AGF.
NOTE: Whether this step is needed, and if so, the details of this step is
defined by BBF.
4\. W-AGF to AMF: The W-AGF acknowledges the N2 UE Context Release Command
message by sending N2 UE Context Release Complete message to the AMF as
defined in clause 4.12.4.2, step 7 of TS 23.502 [3].
#### 7.2.1.3 FN-RG Registration via W-5GAN
The FN-RG registration management procedures are followed for both W-5GBAN and
W-5GCAN. The FN-RG does not support N1 but instead the W-AGF handles the NAS
signalling on behalf of the FN-RG as defined by BBF TR-456 [9] and WT-457 [10]
for FN-BRG and by WT-TR-5WWC-ARCH [27] for FN-CRG.
When the connectivity is established between the FN-RG and the W-AGF in the
W-5GAN, the W-AGF may authenticate the FN-RG; this is controlled by local
policies and defined in BBF specifications. Then when the RM state of the FN-
RG is \"RM-DEREGISTERED\" the W-AGF shall perform registration to 5GC as
described in this clause, otherwise it performs Service Request as defined in
clause 7.2.2.
Once the FN-RG is in RM-REGISTERED and CM-CONNECTED the W-AGF may setup PDU
session(s) on behalf of the FN-RG (as described in clause 7.3.4).
Figure 7.2.1.3-1: FN-RG Registration via W-5GAN
1\. The FN-RG connects to a W-AGF (W-5GAN) via a layer-2 (L2) connection,
based on Wireline AN specific procedure.
The FN-RG is authenticated by the W-5GAN based on Wireline AN specific
mechanisms.
2\. W-AGF selects an AMF based on the AN parameters and local policy. W-AGF
may use the Line ID / HFC identifier provided from the Wireline AN to
determine the 5GC and AN parameters to be used for the FN-RG registration. How
the W-AGF can determine the necessary 5GC and AN parameters is defined in BBF
TR-456 [9], WT-457 [10] or CableLabs WR-TR-5WWC-ARCH [27].
3\. W-AGF performs initial registration on behalf of the FN-RG to the 5GC. The
W-AGF sends a Registration Request to the selected AMF within an N2 initial UE
message (NAS Registration Request, ULI, Establishment cause, UE context
request, Allowed NSSAI, Authenticated Indication).
The NAS Registration Request contains the SUCI or 5G-GUTI of the FN-RG,
security parameters/UE security capability, UE MM Core Network Capability, PDU
Session Status, Follow-on request, Requested NSSAI. The 5G-GUTI, if available,
has been received from the AMF during a previous registration and stored in
W-AGF.
The NSSAI parameters are provided based on W-AGF configuration. Based on W-AGF
configuration of the 5GC NAS parameters, one or multiple Requested S-NSSAI may
be used; e.g. when the W-AGF has been configured to use a specific slice for
RG management purposes.
The following differences exist, compared to 5G-RG case:
\- The W-AGF use SUCI as defined in clause 4.7.3 and clause 4.7.4.
\- The Authenticated Indication indicates to AMF and 5GC that the FN-RG has
been authenticated by the access network.
The SUCI is built by the W-AGF based on:
\- In the case of a BBF access: the GLI as defined in clause 4.7.8 together
with an identifier of the Home network as described in TS 23.003 [14].
\- In the case of a Cable access: the GCI as defined in clause 4.7.8 together
with an identifier of the Home network as described in TS 23.003 [14].
NOTE 1: Further description for how W-AGF obtain parameters required in AS and
NAS message e.g. to build the SUCI is defined in BBF TR-456 [9], WT-457 [10]
and CableLabs WR-TR-5WWC-ARCH [27].
4 If the AMF receives a SUCI, the AMF shall select an AUSF as specified in TS
23.501 [2] clause 6.3.4 based on SUCI. If 5G-GUTI is provided, there is no
need to map SUCI to SUPI and steps 5-9 can be skipped.
5\. AMF sends an authentication request to the AUSF in the form of,
Nausf_UEAuthentication_Authenticate. It contains the SUCI of the FN-RG. It
also contains an indication that the W-5GAN has authenticated the FN-RG.
6\. AUSF selects a UDM as described in clause 6.3.8 of TS 23.501 [2] and sends
a Nudm_UEAuthentication_Get Request to the UDM. It contains the SUCI of the
FN-RG and indication that the W-5GAN has authenticated the FN-RG.
7\. UDM invokes the SIDF to map the SUCI to a SUPI.
8\. UDM sends a Nudm_UEAuthentication_Get Response to the AUSF. It contains
the SUPI corresponding to the SUCI. It also contains an indication that
authentication is not required for the FN-RG.
9\. AUSF sends a Nausf_UEAuthentication_Authenticate Response to the AMF. This
response from AUSF indicates that authentication is successful. The response
contains the SUPI corresponding to the SUCI.
The procedure described in TS 23.502 [3] clause 4.2.2.2.3 may apply (the AMF
decides if the Registration Request needs to be rerouted, where the initial
AMF refers to the AMF).
10a. AMF initiates a NAS security mode command procedure upon successful
authentication as defined in TS 33.501 [11].
The NAS security mode command is sent from the AMF to the W-AGF in a N2
Downlink NAS transport message.
10b. W-AGF responds to the AMF with a NAS Security Mode Complete message in a
N2 Uplink NAS transport message. A NAS security context is created between
W-AGF and AMF.
11\. The AMF performs steps 11-16 in TS 23.502 [3] clause 4.2.2.2.2.
The AMF may be configured by local policies to issue EIR check:
\- Only if the PEI is an IMEI; or
\- Only if the PEI is an IMEI or a user device trusted MAC address.
These local policies may be defined on a per RAT Type basis.
At FN-RG registration to UDM, the Access Type non-3GPP access is used. The
UDM, based on Access and Mobility Subscription information authorizes the FN-
RG to access the 5GC. For FN-CRG, the AMF compares the list of serving area
restrictions it receives from the UDM against the ULI from the W-AGF to check
if the location information is allowed for the FN-CRG, as defined in clause
9.5.1. The AMF may also interact with the PCF for obtaining the Access and
Mobility policy for the FN-RG.
12a. Upon receiving NAS Security Mode Complete, the AMF shall send an N2
Initial Context Setup Request message as defined in TS 38.413 [23] and TS
29.413 [42] including possibly as additional W-AGF specific parameter the RG
Level Wireline Access Characteristics to the W-AGF.
12b W-AGF notifies to the AMF that the FN-RG context was created by sending a
N2 Initial Context Setup Response.
13\. The AMF sends the N2 Downlink NAS transport with NAS Registration Accept
message (5GS registration result, 5G-GUTI, Equivalent PLMNs or SNPNs, Non-3GPP
TAI, Allowed NSSAI, Rejected NSSAI, Configured NSSAI, 5GS network feature
support, network slicing indication, Non-3GPP de-registration timer value,
Emergency number lists, SOR transport container, NSSAI inclusion mode) to the
W-AGF.
The following parameters are ignored by the W-AGF if received from the AMF:
Emergency number lists, SOR transport container, NSSAI inclusion mode.
NOTE 2: Further description on how W-AGF handles the parameters received from
5GC is provided in BBF TR-456 [9], WT-457 [10] and CableLabs WR-TR-5WWC-ARCH
[27].
14\. The W-AGF sends a N2 Uplink NAS transport message, including a NAS
Registration Complete message, back to the AMF when the procedure is
completed. The W-AGF shall store the 5G-GUTI to be able to send it in
potential later NAS procedures.
15\. The AMF performs step 23-24 in TS 23.502 [3] clause 4.2.2.2.2.
The W-AGF may continue by establishing PDU session(s) on behalf of the FN-RG.
#### 7.2.1.4 FN-RG Deregistration via W-5GAN
The deregistration procedure for the FN-RG is similar to that of 5G-RG
described in clause 7.2.1.2 but with the following differences:
\- The 5G-RG is replaced with a FN-RG.
\- In step 1a and 1b, the W-AGF sends and receives NAS deregistration
request/accept messages on behalf of FN-RG.
\- UE-initiated deregistration procedure can be initiated by the W-AGF, when
it has lost connectivity to the FN-RG.
\- For both UE/Network-initiated deregistration procedures, the W-AGF may
initiate the release of the signalling connection between the FN-RG and W-AGF
based on legacy protocols.
NOTE: As described in clause 6.2.2, the message exchanges between the FN-RG
and W-AGF are based on legacy protocols in the wireline access network.
### 7.2.2 Service Request procedures
#### 7.2.2.1 5G-RG Service Request procedure via W-5GAN Access
The Service Request procedure via W-5GAN shall be used by a 5G-RG in CM-IDLE
state over W-5GAN to request the re-establishment of the NAS signalling
connection and the re-establishment of the user plane for all or some of the
PDU Sessions which are associated to non-3GPP access.
NOTE 1: For a W-5GAN access, the Service Request procedure is never a response
to a Paging i.e. Paging does not apply on a W-5GAN access.
The Service Request procedure via W-5GAN shall be used by a 5G-RG in CM-
CONNECTED state over wireline access to request the re-establishment of the
user plane for one or more PDU Sessions which are associated to non-3GPP
access.
Figure 7.2.2.1-1: 5G-RG Triggered Service Request procedure via W-5GAN
1\. The 5G-RG connects to a W-5GAN as described in step 1 of Figure 7.2.1.1-1.
2\. Void.
3\. The 5G-RG using W-CP protocol stack sends a message that contains the
Access Network parameters (GUAMI and Establishment Cause) and a NAS Service
Request message (List Of PDU Sessions To Be Activated, security parameters,
PDU Session status, Uplink Data Status, 5G-S-TMSI). The Establishment cause
provides the reason for requesting a signalling connection with 5GC. In this
release of the specification no Selected PLMN or SNPN parameter is sent by a
5G RG.
4\. The W-AGF shall then forward the Service Request received from the 5G-RG
to the selected AMF within an N2 initial UE message (NAS Service Request
message, User Location Information, Establishment cause, UE context request).
5\. The AMF may initiate NAS authentication/security procedure as defined in
step 6 and step 7 in clause 7.2.1.1.
If the UE in CM-IDLE state triggered the Service Request to establish a
signalling connection only, after successful establishment of the signalling
connection the UE and the network can exchange NAS signalling and steps 6 and
14 are skipped.
6\. Steps 4-11 in TS 23.502 [3] figure 4.2.3.2-1 are performed for each
requested PDU session user plane.
7\. (If the 5G RG was CM-IDLE) AMF sends an N2 Initial Context Setup Request
message (N2 SM information received from SMF(s), RG Level Wireline Access
Characteristics, GUAMI, Allowed NSSAI, UE security capability, Security Key,
Trace Activation, Masked IMEISV).
If the 5G RG was CM-CONNECTED the AMF sends N2 SM information received from
SMF(s).
The W-AGF ignores any UE security capability received in a N2 Initial Context
Setup Request message.
NOTE 2: The UE Security Capability IE is mandatory in NGAP protocol, but it is
not applicable to wireline access, so the AMF can provide any value and the
W-AGF ignores it.
8\. Void.
9\. [Conditional, if the 5G RG was CM-IDLE] A signalling connection using W-CP
protocol stack is established between the 5G-RG and W-AGF.
NOTE 3: Steps 9-11 are defined by BBF/Cablelabs.
Steps 10 and 11 are carried out for each PDU Session indicated in step 7
10\. Based on its own policies and configuration and based on the QoS flows
and QoS parameters received in the previous step, the W-AGF shall determine
what W-UP resources are needed for the PDU session.
11\. The W-AGF sets up the W-UP resources for the PDU session. This step is
specified by BBF for W-5BGAN and by CableLabs for W-5GCAN. The access
dependent W-UP resource setup procedure shall map to the identity of the PDU
Session associated with the W-UP resource.
12\. W-AGF notifies the AMF that the 5G-RG context was created by sending a N2
Initial Context Setup Response (N2 SM information that provides AN Tunnel
Info, List of accepted QoS Flows, List of rejected QoS Flows per PDU Session
ID for PDU Sessions whose UP connections are activated).
13\. AMF sends NAS Service Accept via W-AGF to the 5G-RG.
14\. All steps after step 14 in TS 23.502 [3] figure 4.2.3.2-1 are performed
for each requested PDU Session user plane.
When the 5G-RG is in CM-CONNECTED state over W-5GAN access and the network
receives downlink data for a PDU Session over wireline access that has no user
plane connection, the steps 1-4a in clause 4.2.3.3 of TS 23.502 [3] (Network
Triggered Service Request) shall be performed with the following exceptions:
\- The (R)AN corresponds to an W-AGF.
\- The UE corresponds to the 5G-RG.
\- In step 4a of TS 23.502 [3] clause 4.2.3.3, the steps 2b-6 in figure
7.3.1.1-1 are performed to establish the W-UP resources and to establish N3
tunnel. In steps 2b and 6, no NAS message is exchanged with the UE.
#### 7.2.2.2 FN-RG Service Request procedure via W-5GAN Access
The Service Request procedure via W-5GAN shall be used by a W-AGF when the CM
state in W-AGF for a FN-RG is CM-IDLE over W-5GAN to request the re-
establishment of the NAS signalling connection and the re-establishment of the
user plane for all or some of the PDU Sessions which are associated to
non-3GPP access.
The Service Request procedure via W-5GAN shall be used by a W-AGF when the CM
state in W-AGF for a FN-RG is CM-CONNECTED over wireline access to request the
re-establishment of the user plane for one or more PDU Sessions which are
associated to non-3GPP access.
Figure 7.2.2.2-1: FN-RG Service Request procedure via W-5GAN
1\. If the FN-RG has lost the L2 connection with W-AGF, the FN-RG connects to
a W-AGF (W-5GAN) via a layer-2 (L2) connection, based on Wireline AN specific
procedure.
2\. If step 1 was done, the FN-RG may be authenticated by the W-5GAN based on
Wireline AN specific procedure.
3\. The W-AGF shall then send a Service Request to the selected AMF within an
N2 initial UE message (NAS Service Request message, User Location Information,
Establishment cause, UE context request, Auth_Indicate).
4\. The AMF may initiate NAS authentication/security procedure as defined in
steps 5-10 in clause 7.2.1.3.
If the W-AGF triggered the Service Request to establish a signalling
connection only, after successful establishment of the signalling connection
the W-AGF and the network can exchange NAS signalling and steps 5 and 10 are
skipped.
5\. Steps 4-11 in TS 23.502 [3] figure 4.2.3.2-1 are performed for each
requested PDU session user plane.
6\. (If the FN-RG CM state was CM-IDLE) AMF sends an N2 Initial Context Setup
Request message (N2 SM information received from SMF(s), RG Level Wireline
Access Characteristics, GUAMI, Allowed NSSAI, UE security capability, Security
Key, Trace Activation, Masked IMEISV).
If the FN-RG CM state in W-AGF was CM-CONNECTED the AMF sends N2 SM
information received from SMF(s).
The W-AGF ignores any UE security capability received in a N2 Initial Context
Setup Request message.
NOTE: The UE Security Capability IE is mandatory in NGAP protocol, but it is
not applicable to a wireline access, so the AMF can provide any value and the
W-AGF ignores it.
Step 7 is carried out for each PDU Session indicated in step 6.
7\. Based on its own policies and configuration and based on the QoS flows and
QoS parameters received in the previous step, the W-AGF shall determine what
W-UP resources are needed for the PDU session.
The W-AGF may perform BBF specific resource reservation with the AN, that is,
it sets up the L-W-UP resources for the PDU session. This step is specified by
BBF for W-5GBAN and by CableLabs for W-5GCAN.
8\. W-AGF notifies the AMF that the FN-RG context in W-AGF was created by
sending a N2 Initial Context Setup Response (N2 SM information that provides
AN Tunnel Info, List of accepted QoS Flows, List of rejected QoS Flows per PDU
Session ID for PDU Sessions whose UP connections are activated).
9\. AMF sends NAS Service Accept to W-AGF.
10\. All steps after step 14 in figure 4.2.3.2-1 of TS 23.502 [3] are
performed for each requested PDU session user plane.
When the FN-RG CM state in W-AGF is CM-CONNECTED over W-5GAN access and the
network receives downlink data for a PDU Session over wireline access that has
no user plane connection, the steps 1-4a in clause 4.2.3.3 of TS 23.502 [3]
(Network Triggered Service Request) shall be performed with the following
exceptions:
\- The (R)AN corresponds to an W-AGF.
\- The UE corresponds to the FN-RG.
\- In step 4a, the steps 6-10 in figure 7.2.2.2-1 are performed to establish
the L-W-UP resources and to establish N3 tunnel. In step 6, the AMF does not
send the NAS Service Accept message to the UE.
### 7.2.3 5G-RG and FN-RG Configuration Update
#### 7.2.3.0 General
This clause specifies delta for Configuration Update procedure defined in TS
23.502 [3] clause 4.2.4 for 5G-RG and FN-RG.
#### 7.2.3.1 5G-RG Configuration Update via W-5GAN Access
The 5G-RG Configuration Update procedures via W-5GAN may be used by the
network at any time to update 5G-RG configuration which includes:
\- Access and Mobility Management related parameters decided and provided by
the AMF. This includes the Configured NSSAI and its mapping to the Subscribed
S-NSSAIs, the Allowed NSSAI and its mapping to Subscribed S-NSSAIs.
\- 5G-RG Policy (i.e. URSP) provided by the PCF.
The procedure described in TS 23.502 [3] clause 4.2.4.2 is used for the AMF to
change the 5G-RG configuration for access and mobility management related
parameters, with the following differences:
\- The UE is replaced by the 5G-RG.
\- The (R)AN corresponds to the W-5GAN.
Figure 7.2.3.1-1: 5G-RG Configuration Update procedure for access and mobility
management related parameters
In Step 0, the AMF determines the necessity of 5G-RG configuration change due
to various reasons, but UE mobility change is not applicable in this release
of specification. If a 5G-RG is in CM-IDLE, the AMF can wait until the 5G-RG
is in CM-CONNECTED state as Network Triggered Service Request is not
applicable.
In step 1, the AMF sends UE Configuration Update Command to the 5G-RG. The
following parameters are not included: Mapping Of Allowed NSSAI, Configured
NSSAI for the Serving PLMN or SNPN, Mapping Of Configured NSSAI, MICO,
Operator-defined access category definitions, SMS Subscribed Indication.
Step 2c is not applicable in this procedure.
Step 3a is not applicable since it is only for NAS parameters that can be
updated without transition from CM-IDLE are included, e.g. MICO mode.
The procedure for UE Configuration Update procedure for transparent UE Policy
delivery described in TS 23.502 [3] clause 4.2.4.3 is used for the PCF to
change or provide new 5G-RG policies in the 5G-RG, with the following
differences:
\- The UE is replaced by the 5G-RG.
\- The (R)AN corresponds to the W-5GAN.
\- The means for carrying NAS messages between 5G-RG and W-AGF within the
W-GAN are to be defined by BBF.
\- Step 2 is not applicable since the Network Triggered Service Request is not
applicable in the case of W-5GAN.
Figure 7.2.3.1-2: 5G-RG Configuration Update procedure for transparent UE
Policy delivery
#### 7.2.3.2 FN-RG related Configuration Update via W-5GAN Access
The FN-RG related Configuration Update procedures via W-5GAN may be used by
the network at any time to update FN-RG configuration in W-AGF which includes:
\- Access and Mobility Management related parameters decided and provided by
the AMF. This includes the Configured NSSAI and its mapping to the Subscribed
S-NSSAIs, the Allowed NSSAI and its mapping to Subscribed S-NSSAIs.
\- FN-RG related Policy (i.e. URSP) provided by the PCF.
The W-AGF acts as an N1 termination point on behalf of FN-RG. Therefore, the
configuration update procedures described in clause 7.2.3.1, shown in figure
7.2.3.1-1, apply to the FN-RG, with the following additional differences:
\- The 5G-RG is replaced by the W-AGF which is acting as a UE towards the 5GC
on behalf of the FN-RG.
\- In step 1 the AMF sends the UE Configuration Update Command to the FN-RG,
which is received by the W-AGF terminating the N1 and acting as a UE on behalf
of the FN-RG. The W-AGF stores the UE Configuration as defined in clause 9.4.
If requested by the AMF, the W-AGF shall acknowledge the UE Configuration
Update Command.
\- Step 2d is not applicable.
\- When requested by the AMF, in step 4 the W-AGF starts the registration
procedure described in clause 7.2.1.3.
\- The Emergency service is not applicable.
Figure 7.2.3.2-1: FN-RG related Configuration Update procedure for access and
mobility management related parameters
The procedure of UE Configuration Update procedure for transparent UE Policy
delivery described in TS 23.502 [3] clause 4.2.4.3 is used by the PCF to
change or provide new FN-RG policies in the W-AGF, with the following
differences:
\- The UE is replaced by the W-AGF which is acting as a UE towards the 5GC on
behalf of the FN-RG.
\- The (R)AN corresponds to the W-5GAN.
\- The FN-RG is only registered over W-5GAN.
\- Step 2 is not applicable since the Network Triggered Service Request is not
applicable in the case of W-5GAN.
\- In step 3, the W-AGF receives the delivery of UE policies on behalf of FN-
RG.
\- The FN-RG policies are managed by W-AGF as defined in clause 9.5.2.2.
How the W-5GAN applies the configuration update to the wireline network is to
be defined by the BBF for the FN-BRG and by CableLabs for the FN-CRG.
The operator may configure the W-AGF locally by provisioning means not
specified by 3GPP as an alternative to the Configuration Update procedure for
UE Policy delivery. The 3GPP Configuration Update will take precedence over a
locally configured policy for FN-BRGs or FN-CRGs being serviced by the 5GC.
Figure 7.2.3.2-2: FN-RG related Configuration Update procedure for transparent
UE Policy delivery
### 7.2.4 Reachability procedures
The procedures described in TS 23.502 [3] clause 4.2.5 are not applicable for
5G-RG and FN-RG access via W-5GAN.
### 7.2.5 AN Release
#### 7.2.5.1 General
The AN Release procedure via W-5GAN access is used by the W-5GAN or the AMF to
release the logical NG-AP signalling connection and the associated N3 User
Plane connections between the W-5GAN and the 5GC.
#### 7.2.5.2 5G-RG AN Release via W-5GAN
The procedure will move the 5G-RG from CM-CONNECTED to CM-IDLE in AMF, and all
5G-RG related context information is deleted in the W-AGF.
Both W-AGF initiated and AMF-initiated AN release in the W-5GAN procedures are
shown in Figure 7.2.5-1.
Figure 7.2.5-1: 5G-RG AN release in the W-AGF
1 The 5G-RG has already registered in the 5GC and may have established one or
multiple PDU Sessions.
2\. The W-AGF detects that the 5G-RG is not reachable.
3\. The W-AGF sends a N2 UE Context Release Request message to the AMF This
step is equivalent to step 1b of Figure 4.2.6-1 in TS 23.502 [3].
NOTE 1: The triggers for W-AGF to send UE Context Release Request are defined
by BBF in [9] and in CableLabs WR-TR-5WWC-ARCH [27] and may e.g. include
events where W-AGF has lost of synchronisation of physical link, loss of PPPoE
session, or detects that the RG has been replaced.
NOTE 2: AN Release procedure can also be triggered by an AMF internal event
and in that case step 2 and step 3 do not take place.
4\. AMF to W-AGF: If the AMF receives the N2 UE Context Release Request from
W-AGF or if due to an internal AMF event the AMF wants to release N2
signalling, the AMF sends an N2 UE Context Release Command (Cause) to the
W-AGF. The cause indicated is cause from step 3 or a cause due to internal AMF
event. This step is equivalent to step 2 in Figure 4.2.6-1 of TS 23.502 [3].
5\. If the W-CP signalling connection and W-UP resources has not been released
yet, the W-AGF releases the W-CP connection and W-UP resources with a
procedure out of scope of 3GPP. The W-AGF sends to the 5G-RG the indication of
the release reason if received in step 4.
6\. W-AGF to AMF: The W-AGF confirms the release of the 5G-RG-associated
N2-logical connection by returning N2 UE Context Release Complete (list of PDU
Session ID(s) with active N3 user plane) to the AMF as in step 4 defined in
clause 4.2.6 of TS 23.502 [3]. The AMF marks the 5G-RG as CM-IDLE state in
non-3GPP access.
7\. For each of the PDU Sessions in the N2 UE Context Release Complete, the
steps 5 to 7 in TS 23.502 [3] clause 4.2.6 are performed (PDU Session Update
SM Context). After the AMF receives the Nsmf_PDUSession_UpdateSMContext
Response as in step 7 of TS 23.502 [3] clause 4.2.6, the AMF considers the N3
connection as released. If list of PDU Session ID(s) with active N3 user plane
is included in step 3, then this step is performed before step 4.
#### 7.2.5.3 FN-RG AN Release via W-5GAN
The AN release procedure for the FN-RG is similar to that of 5G-RG described
in clause 7.2.5.2 but with the following differences:
\- The 5G-RG is replaced with a FN-RG.
\- In step 5, the W-AGF may initiate the release of the L-W-CP signalling and
L-W-UP resources between the FN-RG and W-AGF based on legacy protocols.
NOTE: The message exchanges between the FN-RG and W-AGF are based on legacy
protocols in the wireline access network as described in clause 6.2.2.
### 7.2.6 N2 procedures
#### 7.2.6.0 General
This clause specifies delta for N2 procedures defined in TS 23.502 [3] clause
4.2.7 for 5G-RG and FN-RG.
#### 7.2.6.1 N2 procedures via W-5GAN Access
At power up, restart and when modifications are applied, the W-AGF node and
AMF use non-UE related N2 signalling to exchange configuration data. The N2
Configuration as described in TS 23.502 [3] clause 4.2.7.1 is used with the
following differences:
\- The 5G-AN corresponds to the W-AGF.
The Creating NGAP UE-TNLA-bindings during Registration and Service Request
procedure as described in TS 23.502 [3] clause 4.2.7.2.1 is used for 5G-RG
connecting to 5GC via W-5GAN Access, with the following differences:
\- The 5G-AN corresponds to the W-AGF.
\- The UE corresponds to 5G-RG.
The Creating NGAP UE-TNLA-bindings during Registration and Service Request
procedure as described in TS 23.502 [3] clause 4.2.7.2.1 is used for FN-RG
connecting to 5GC via W-5GAN Access with the following differences:
\- The 5G-AN corresponds to the W-AGF.
\- The UE corresponds to W-AGF on behalf of FN-RG.
\- If the W-AGF does not have any UE identities (i.e. a GUAMI or a 5G-S-TMSI)
for the FN-RG, e.g. during Initial Registration procedure, the following
differences are further applied:
\- In step 2, the W-AGF shall handle the access specific messages received
from the FN-RG as described in BBF TR456 [9] and WT-457 [10], e.g. PPPoE
messages, and does not forward them to the AMF via the selected TNL
association. Instead, the W-AGF shall send NAS messages on behalf of the FN-RG
to the AMF via the selected TNL association.
\- Step 3 can only take place during the Initial Registration procedure.
\- The AMF may decide to modify the NGAP UE-TNLA-binding toward other 5G-AN
nodes such as W-AGF. This is done if AMF is changed and old AMF have existing
NGAP UE-TNLA-bindings toward another W-AGF.
The Creating NGAP UE-TNLA-bindings during handovers as described in TS 23.502
[3] Clause 4.2.7.2.2 is not applicable to the scenario when 5G-RG or FN-RG is
access to 5GC via W-5GAN.
Re-Creating NGAP UE-TNLA-bindings subsequent to NGAP UE-TNLA-binding release
as described in TS 23.502 [3] clause 4.2.7.2.3 is used for 5G-RG connecting to
5GC via W-5GAN Access with the following exceptions:
\- The 5G-AN corresponds to the W-AGF.
\- The UE corresponds to 5G-RG.
Re-Creating NGAP UE-TNLA-bindings subsequent to NGAP UE-TNLA-binding release
as described in TS 23.502 [3] clause 4.2.7.2.3 is used for FN-RG connecting to
5GC via W-5GAN Access with the following exceptions:
\- The 5G-AN corresponds to the W-AGF.
\- The UE corresponds to W-AGF on behalf of FN-RG.
### 7.2.7 5G-RG and FN-RG Capability Match Request procedure
This procedure is not applicable to 5G-RG and FN-RG access via wireline
access.
### 7.2.8 Connection, Registration and Mobility Management procedures for AUN3
devices
#### 7.2.8.1 AUN3 device Registration via W-5GAN
An authenticable non-3GPP devices (AUN3) may get connected behind 5G-RG as
defined in clause 4.10c.
This clause specifies how an AUN3 device can be registered via 5G-RG.
Figure 7.2.8.1-1: 5GC registration of AUN3 device
1\. The 5G-RG registers to 5GC as specified in clause 7.2.1.1:
Any AUN3 device connection request prior to step 1 shall be rejected by the
5G-RG.
2\. The AUN3 device connects to the 5G-RG via non-3GPP access network (e.g.,
WLAN). The realm of the NAI used by AUN3 device to contact the 5G-RG may be
used as a trigger for 5G-RG to apply procedures for AUN3 devices. An
authentication procedure is triggered. This can be done either by AUN3 device
sending a EAPOL-start frame to the 5G-RG or 5G-RG receives a frame from an
unknown MAC address. The 5G-RG receives a permanent identifier from the AUN3
device (e.g. an NAI in form of username\@realm). If the realm part is
different from the realm associated with the PLMN that the 5G-RG belongs to,
the 5G-RG stops performing following procedure and reject the AUN3 device.
NOTE: How the 5G-RG is triggered to apply procedures for AUN3 devices is
defined by BBF and/or CableLabs.
3\. This shall be same as step 3 of 7.2.1.1-1 with the following addition:
\- W-CP AN parameters may contain an indicator that the W-CP connection is for
an AUN3 device;
\- The 5G-RG always provides a SUCI as AUN3 device identity information in the
registration request and constructs the SUCI from the NAI received within EAP-
Identity issued by the AUN3 device as defined in TS 33.501 [11];
\- The 5G-RG uses default values, which are the same for all AUN3 devices it
serves, to populate the parameters in the Registration Request message built
on behalf of an AUN3 device. For example, the 5G-RG issues the Registration
Request with no S-NSSAI; and
\- When W-AGF provides (over N2) ULI to be associated with an AUN3 device, if
the AUN3 device is connected behind a 5G-BRG, the W-AGF builds the AUN3\'s ULI
using the ULI of the 5G-BRG connecting the AUN3 device. If AUN3 device is
connected behind the 5G-CRG, the W-AGF builds the ULI using the ULI of the
5G-CRG connecting the AUN3 device.
4\. The W-AGF selects an AMF based on the received AN parameter provided by
the 5G-RG and based on local policy, as specified in clause 6.3.5 of TS 23.501
[2].
The W-AGF sends an NGAP INITIAL UE message to the selected AMF. The W-AGF
indicates to AMF if there is an existing 5G-RG N2 connected to the same line
(that the initial NAS message is received).
5\. AMF selects AUSF as specified in clause 6.3.4 of TS 23.501 [2].
6\. The AUSF executes the authentication of the AUN3 device following TS
33.501 [11]. The AUSF selects the UDM as described in clause 6.3.8 of TS
23.501 [2] and gets the authentication data of the AUN3 device, from UDM. EAP
based authentication defined in TS 33.501 [11] is performed between the AUSF
and the AUN3 device. Once the AUN3 device has been authenticated, the AUSF
provides relevant security related information to the AMF. AUSF shall return
the SUPI corresponding to the AUN3 device to AMF only after the authentication
is successful.
7\. Same as step 8 to 12 of figure 7.2.1.1-1 with following modifications
\- The 5G RG uses the MAC address of the AUN3 device as a PEI;
\- If the W-AGF indicated in step 4 that there is no existing 5G-RG N2
connected to the same line, then the AMF rejects the registration request and
steps 9 onwards are skipped. Otherwise, the procedure continues in step 9.
8\. The AMF sends the Registration Accept message related to the AUN3 device
to the 5G-RG. This step is executed over the NAS signalling connection and the
N2 connection related to the AUN3 device.
9\. The 5G-RG sends the Registration Complete message related to the AUN3
device to the AMF, when the procedure is completed. This step is executed over
NAS signalling connection and N2 connection related to the AUN3 device. The
5G-RG shall store the 5G-GUTI of AUN3 device to be able to use it potential
later NAS procedures related with the AUN3 device.
10\. The 5G-RG receives the URSP corresponding to the AUN3 and continues by
requesting the establishment of a PDU Session on behalf of the AUN3 device as
specified in clause 7.3.1.
#### 7.2.8.2 AUN3 device De-registration via W-5GAN
AUN3 device may get connected behind 5G-RG as defined in clause 4.10c. This
clause specifies how an AUN3 device can be de-registered via 5G-RG.
Figure 7.2.8.2-1: 5GC De-registration of an AUN3 device
1a. The AUN3 device triggers a disconnection request to the 5G-RG.
NOTE: Detail procedures how AUN3 device triggers the de-registration request
is out of scope of 3GPP.
1a. The 5G-RG sends a De-registration request on behalf of the AUN3 device.
This triggers step 1a of Figure 7.2.1.2-1 with the deregistration targeting
the AUN3 device and not the 5G-RG. This step is executed over the AUN3
device\'s NAS signalling connection and AUN3 device\'s N2 connection.
1b. The network (AMF or UDM) may determine to de-register an AUN3. This
triggers step 1b of Figure 7.2.1.2-1 with the deregistration targeting the
AUN3 device and not the 5G-RG.
2\. AMF to W-AGF: The AMF sends a N2 UE Context Release Command message to the
W-AGF as defined in step 2 of Figure 7.2.1.2-1 but for the N2 connection
related with the AUN3 device. W-AGF removes W-CP AN context information for
the AUN3 device.
3\. As defined in step 3 of Figure 7.2.1.2-1 but for the signalling connection
related with the AUN3 device.
#### 7.2.8.3 5G-RG Deregistration via W-5GAN when it is also serving AUN3
devices
Figure 7.2.8.3-1: 5G-RG Deregistration procedure via W-5GAN when serving AUN3
devices
1-3. The same as steps 1-3 for Figure 7.2.1-1 with the following modification:
In the case of 5G-RG initiated deregistration, 5G-RG shall first deregister
each of the registered AUN3 devices connected to it (if any) before initiating
the deregistration of itself.
4\. W-AGF controls if there exist any AUN3 devices connected to the 5G-RG that
are registered to the 5GC through the W-AGF. If there are no AUN3 devices,
then steps 5 and 6 shall be ignored.
5\. [conditional] For each AUN3 device identified in step 4, the W-AGF shall
send AN Release request as specified in clause 4.2.6 of TS 23.502 [3]. Here,
the cause should indicate the disconnection of 5G-RG.
6\. [conditional] Upon receiving the AN Release request with the cause
specified in step 5, the AMF shall initiate deregistration of the AUN3 device
as specified in clause 4.2.2.3.3 of TS 23.502 [3].
7\. The W-AGF may initiate the release of the signalling connection between
5G-RG and W-AGF.
NOTE: Whether this step is needed, and if so, the details of this step are
defined by BBF and/or CableLabs.
8\. The RG disconnects the AUN3 device. How this is done is outside of 3GPP
scope.
## 7.3 Session Management procedures
### 7.3.0 General
This clause specifies the delta for Session Management procedure defined in TS
23.502 [3] clause 4.3 for 5G-RG and FN-RG.
### 7.3.1 5G-RG Requested PDU Session Establishment via W-5GAN
#### 7.3.1.1 5G-RG PDU Session establishment via W-5GAN
Clause 7.3.1.1 specifies how a 5G-RG can establish a PDU Session via an W-5GAN
as well as to hand over an existing PDU Session between 3GPP access and
W-5GAN. The procedure applies in non-roaming scenarios.
The PDU Session Establishment procedure specified in TS 23.502 [3] clause
4.3.2.2.1 applies with the following changes.
Figure 7.3.1.1-1: 5G-RG PDU Session establishment via W-5GAN
1\. The 5G-RG shall send a PDU Session Establishment Request message to AMF as
specified in step 1 in clause 4.3.2.2.1 of TS 23.502 [3]. This message shall
be sent to W-AGF via the W-CP signalling connection and the W-AGF shall
transparently forward it in a N2 Uplink NAS transport message (NAS message,
User location information, W-AGF identities) to AMF in the 5GC.
The W-AGF identities parameter may be included by the W-AGF and contains a
list of Identifiers (i.e. a FQDN and/or IP address(es)) of N3 terminations at
W-AGF and can be used by SMF in step 8 in TS 23.502 [3] clause 4.3.2.2.1 as
input to select an UPF.
If the 5G-RG needs Hybrid Access with Multi-Access PDU Session service, the
5G-RG requests a MA PDU Session as defined in clause 4.12. In that case, Steps
of TS 23.502 [3] clause 4.3.2.2.1 apply as modified by clause 4.12.
2a. Steps 2-11 specified in TS 23.502 [3] clause 4.3.2.2.1 are executed
according to the PDU Session Establishment procedure over 3GPP access with the
deviation that in step 3 an additional parameter W-AGF identities received by
the AMF from the W-AGF can be sent from AMF to SMF. SMF can use W-AGF
identities in step 8 of TS 23.502 [3] clause 4.3.2.2.1 for UPF selection.
For the LADN service, if the AMF detects the requested DNN is corresponding to
a LADN DNN or the default DNN of the requesting S-NSSAI is a LADN DNN, and the
access type of 5G-RG equals to wireline access, the AMF will assign \"UE
Presence in LADN service area\" indication to be \"OUT\", and provide this
indication to SMF.
NOTE: This induces the SMF to reject the PDU Session establishment request
2b. As described in steps 11 and 12 of TS 23.502 [3] clause 4.3.2.2.1, the AMF
shall under request of the SMF send a N2 PDU Session Resource Setup Request
message to W-AGF to establish the access resources for this PDU Session. The
differences with steps 11 and 12 of TS 23.502 [3] clause 4.3.2.2.1 are:
\- The W-AGF shall ignore RSN if received from 5GC.
3\. Based on its own policies and configuration and based on the QoS flows and
QoS parameters received in the previous step, the W-AGF shall determine what
W-UP resources are needed for the PDU session. For example, the W-AGF may
decide to establish one W-UP resource and associate all QoS profiles with this
W-UP resource. In this case, all QoS Flows of the PDU Session would be
transferred over one W-UP resource.
4a. The W-AGF sets up the W-UP resources for the PDU session. This step is
specified by BBF for W-5BGAN and by CableLabs for W-5GCAN. The access
dependent W-UP resource setup procedure shall provide the identity of the PDU
Session associated with the W-UP resource. The W-UP resource setup procedure
should support to bind W-UP resources to individual QFI(s) as specified in
clause 4.4. The W-UP resource request may also contain other access layer
information (e.g., VLAN id) specific for the W5GAN.
5\. After all W-UP resources are established, the W-AGF shall forward to 5G-RG
via the W-CP signalling connection the PDU Session Establishment Accept
message received in step 2b.
6\. The W-AGF shall send to AMF an N2 PDU Session Resource Setup Response (PDU
Session ID, AN Tunnel Info, List of accepted/rejected QFI(s), User Plane
Security Enforcement Policy Notification).
7\. All steps specified in TS 23.502 [3] clause 4.3.2.2.1 after step 14 are
executed according to the PDU Session Establishment procedure over 3GPP
access.
#### 7.3.1.2 PDU Session Establishment with ACS Discovery
This clause specifies how a 5G-RG can establish a PDU Session with ACS
Discovery. The ACS discovery mechanism is further specified in clause 9.6.2.
When a 5G-RG performs ACS Discovery during PDU session establishment
procedure, the UE Requested PDU Session Establishment via 3GPP Access as
described in TS 23.502 [3] clause 4.3.2.2.1 is used, with the following
differences:
\- UE is replaced by 5G-RG.
\- In FWA scenario the (R)AN is replaced by NG RAN access network, in wireline
scenario the (R)AN is replaced by W-5GAN and in HA scenario the (R)AN
represents the selected access where the PDU session is being established.
\- Step 1. When the 5G-RG sends the PDU session establishment request it
includes the DNN which is corresponding to the ACS (per local configuration or
per URSP policies). The UE may send in PCO a request to provide ACS
information. The UE may include the ACS information request in a DHCP request
sent after PDU Session has been established.
\- Step 4. The UDM may send the ACS information to the SMF together with the
subscription data based on the DNN.
\- Step 10. The SMF includes the ACS information in the N1 SM information
(PCO) if it has been requested by the UE in step 1 and if it is available at
the SMF (if received in Step4).
\- Step 19: The 5G-RG may request to receive ACS information via DHCP as
described in clause 9.6.2.
\- The 5G-RG uses the received ACS information to establish a connection with
the ACS.
NOTE: The ACS discovery via PCO or via DHCP are mutually exclusive.
### 7.3.2 5G-RG or Network Requested PDU Session Modification via W-5GAN
The UE or network requested PDU Session Modification procedure via W-5GAN
access is depicted in figure 7.3.2-1. The procedure applies in non-roaming
scenarios.
The procedure below is based on the PDU Session Modification procedure
specified in TS 23.502 [3] clause 4.3.3.2.
Figure 7.3.2-1: 5G-RG or Network Requested PDU Session Modification via W-5GAN
1\. If the PDU Session Modification procedure is initiated by the UE, the UE
shall send a PDU Session Modification Request message to AMF as specified in
TS 23.502 [3] step 1 of clause 4.3.2.2. The message shall be sent to W-AGF via
W-CP signalling connection. The W-AGF shall transparently forward the PDU
Session Modification Request to AMF/SMF.
2\. The steps 1a (from AMF) to 1e and steps 2-3 as per the PDU Session
Modification procedure in TS 23.502 [3] clause 4.3.3.2 are executed.
3\. The AMF sends N2 PDU Session Resource Modify Request (N2 SM information
received from SMF, NAS message) message to the W-AGF. This step is the same as
step 4 in clause 4.3.3.2.
4\. The W-AGF may issue W-CP resource modification procedure (out of scope of
3GPP) with the 5G-RG that is related with the information received from SMF.
Based on the N2 SM information received from the SMF, the W-AGF may perform
following:
4a. [Conditional] The W-AGF may decide to create a new W-UP resource for the
new QoS Flow(s).
4b. [Conditional] The W-AGF may decide to add or remove QoS Flow(s) to/from an
existing W-UP resource.
4c. [Conditional] The W-AGF may decide to delete an existing W-UP resource,
e.g. when there is no QoS Flow mapped to this W-UP resource.
NOTE: If the W-AGF has included the Default W-UP resource indication during
the establishment of one of the W-UP resources of the PDU Session, the W-AGF
may not update the mapping between QoS Flows and W-UP resources.
5\. The W-AGF acknowledges N2 PDU Session Resource Modify Request by sending a
N2 PDU Session Resource Modify Response Message to the AMF to acknowledge the
success or failure of the request.
6\. Step 7 as per the PDU Session Modification procedure in TS 23.502 [3]
clause 4.3.3.2 is executed.
7\. The W-AGF sends the PDU Session Modification Command to 5G-RG (if received
in step 3) and receives the response message from 5G-RG.
Steps 4a/4c and step 7 may happen consecutively. Steps 7b map happen before
step 4b/4d.
8\. The W-AGF forwards the NAS message to the AMF.
9\. All the steps after step 10 in TS 23.502 [3] clause 4.3.3.2 are executed
according to the general PDU Session Modification procedure.
### 7.3.3 5G-RG or Network Requested PDU Session Release via W-5GAN
Clause 7.3.3 specifies how a 5G-RG or network can release a PDU Session via a
W-5GAN. The 5G-RG requested PDU Session Release procedure via W-5GAN access
applies in non-roaming scenarios.
If the 5G-RG is simultaneously registered to a 3GPP access in a PLMN or SNPN
different from the PLMN or SNPN of the W-AGF, the functional entities in the
following procedures are located in the PLMN or SNPN of the W-AGF.
NOTE: If the 5G-RG is simultaneously registered to 3GPP access in the same
PLMN or SNPN as W-5GAN access, when W-5GAN is not available to the 5G-RG (e.g.
5G-RG is disconnected from W-5GAN) or 5G-RG is in CM-IDLE for W-5GAN access,
the 5G-RG may perform the PDU Session Release procedure via 3GPP access as
described in TS 23.502 [3] clause 4.3.4.
Figure 7.3.3-1: 5G-RG or Network Requested PDU Session Release via W-5GAN
access
1\. One or more PDU Sessions are already established for the 5G-RG using the
procedure described in clause 7.3.1.
2\. The 5G-RG sends a PDU session release request (N1 SM container (PDU
Session Release Request), PDU Session ID) to the AMF via the W-AGF as defined
in clause 4.3.4 of TS 23.502 [3].
3\. The steps 1a (from AMF) to 3 according to the PDU Session Release
procedure defined in TS 23.502 [3] clause 4.3.4.2 are executed.
4\. This step is the same as step 4 in clause 4.3.4.2 of TS 23.502 [3].
5\. Upon receiving AN session release request message from the AMF, the W-AGF
can trigger the release of the corresponding W-UP resource with procedure out
of scope of 3GPP.
6\. This step is the same as step 6 in clause 4.3.4.2 of TS 23.502 [3].
7\. Step 7 according to the PDU Session Release procedure defined in clause
4.3.4.2 are executed.
8\. The W-AGF delivers the NAS message (N1 SM container (PDU Session Release
Command), PDU Session ID, Cause) to the 5G-RG.
9\. The 5G-RG sends a NAS message (N1 SM container (PDU Session Release Ack),
PDU Session ID) to the W-AGF.
10\. This step is the same as step 9 in clause 4.3.4.2 of TS 23.502 [3].
Steps 5 and 8 may happen consecutively. Step 9 may happen before step 5.
11\. All steps after step 9 in the PDU Session Release procedure defined in TS
23.502 [3] clause 4.3.4.2 are executed.
The network requested PDU Session Release procedure via W-5GAN access is the
same as the network requested PDU Session Release Procedure specified in TS
23.502 [3] clause 4.3.4.2 for Non-Roaming with the following differences:
\- The (R)AN corresponds to a W-AGF.
\- In step 5, upon receiving N2 SM request to release the AN resources
associated with the PDU Session from the AMF, the W-AGF can trigger the
release of the corresponding W-UP resource to the 5G-RG as specified in step
5, in Figure 7.3.3-1.
### 7.3.4 FN-RG related PDU Session Establishment via W-5GAN
The procedure below is based on the PDU Session Establishment procedure
specified in TS 23.502 [3] clause 4.3.2.2.1.
Figure 7.3.4-1: FN-RG related PDU Session Establishment via W-5GAN
0\. [Optional] FN-RG sends an IP address/prefix request to the W-AGF via the
L2 connection established in clause 7.2.1.3.
NOTE: This IP address/prefix request can also be sent by FN-RG later in this
procedure; the W-AGF may store this and complete the address allocation via
5GC after the PDU session setup. The means of carrying the IP address/prefix
request/response between FN-BRG and W-AGF is defined in BBF TR-456 [9], WT-457
[10] and between FN-CRG and W-AGF is defined in CableLabes WR-TR-5WWC-ARCH
[27].
1\. After the registration procedure is completed, the W-AGF may establish PDU
session(s) on behalf of the FN-RG. The trigger for W-AGF to initiate a PDU
establishment process is defined in BBF TR-456 [9], WT-457 [10] and CableLabs
WR-TR-5WWC-ARCH [27].
The W-AGF generates a PDU session ID and derives the parameters for the PDU
Session (PDU Session type, S-NSSAI, DNN, SSC mode, etc.) based on signalling
received from the FN-RG (DHCP, IPv6 RS, etc.), on local configuration, and on
information received from the 5GC (e.g. during the Registration procedure or
when received URSP rules) and stored on the W-AGF.
If W-AGF has received a DHCPv4/DHCPv6 request from the FN-RG, it may request a
PDU Session with deferred IP address allocation.
The W-AGF sends a NAS PDU Establishment Request to the AMF. This request
contains the PDU Session ID, and may contain a Requested PDU Session Type, a
Requested SSC mode, 5GSM Capability PCO, SM PDU DN Request Container, Number
of Packet Filters. In the case of PDU Session Type IPv6 or IPv4v6, the PDU
Session Establishment Request may contain an interface identifier of the FN-RG
IPv6 link local address associated with the PDU Session.
The W-AGF sends NAS PDU Establishment Request in a N2 Uplink NAS transport
message (NAS message, User location information, W-AGF identities).
The W-AGF identities contains a list of Identifiers (i.e. a FQDN and/or IP
address(es)) of N3 terminations at W-AGF and can be used by SMF in step 8 in
TS 23.502 [3] clause 4.3.2.2.1 as input to select an UPF.
2a. The PDU session request is processed in the 5GC as per steps 2-11 of TS
23.502 [3] clause 4.3.2.2.1. These steps are for UPF selection and resource
reservation/allocation in the UPF. With regard to TS 23.502 [3], an additional
parameter is sent from AMF to SMF i.e. the list of Identifiers (i.e. a FQDN
and/or IP address(es)) of N3 terminations at W-AGF received by the AMF from
the W-AGF. The SMF can use it in step 8 for UPF selection as per clause
4.3.2.2.1. In the case of PDU Session Type IPv6 or IPv4v6, in step 11 of TS
23.502 [3] clause 4.3.2.2.1:
\- The PDU Session Establishment Accept contains the SMF IPv6 link local
address associated with the PDU Session if the RAT Type in the
Nsmf_PDUSession_CreateSMContext request equals to wireline access.
\- The PDU Session Establishment Accept contains the interface identifier of
the FN-RG IPv6 link local address if provided in step 1. Otherwise a SMF
allocated FN-RG interface identifier is provided.
2b. The SMF responds via AMF as defined in step 11 of clause 4.3.2.2.1 in TS
23.502 [3] with an N2 PDU Session Resource Setup Request that includes QoS
profile(s), PDU Session ID, PDU Session Establishment Accept and the N3 tunnel
endpoint information for the UPF. The differences with step 11/12 of TS 23.502
[3] clause 4.3.2.2.1 are:
\- The W-AGF shall ignore RSN if received from 5GC.
3\. Based on its own policies, configuration and based on the QoS flows, QoS
parameters received in the previous step, the W-AGF shall determine what W-UP
resources are needed for the PDU session.
The W-AGF may, as defined in BBF TR-456 [9], WT-457 [10] and CableLabs WR-
TR-5WWC-ARCH [27], perform Access specific resource reservation with the AN,
that is, it sets up the W-UP resources for the PDU session.
4\. The W-AGF allocates AN N3 tunnel information for the PDU Session and
includes the AN N3 tunnel endpoint information in the N2 PDU Session Resource
Setup Response message to the AMF.
5\. The PDU session setup procedure is completed in 5GC. All steps after step
13 as specified in TS 23.502 [3] figure 4.3.2.2.1 are executed.
6a. If W-AGF requested deferred IP address allocation in step 1 and this was
accepted by the network, the W-AGF sends on the user Plane of the PDU Session
any DHCP or RS message received beforehand from the FN-RG to the 5GC to obtain
the IP address/prefix.
6b. W-AGF completes the IP address/prefix allocation with the FN-RG via the
established L2 connection. If W-AGF did not request deferred IP address
allocation in step 1a, the IP address/prefix sent back to the FN-RG is the UE
IP address/prefix delivered in NAS message in step 2b. If W-AGF requested
deferred IP address allocation in step 1a, the IP address/prefix sent back to
the FN-RG is the UE IP address/prefix delivered via deferred IP address
allocation procedures in step 6a.
### 7.3.5 CN-initiated selective deactivation of UP connection of an existing
PDU Session associated with W-5GAN Access
The procedure described in TS 23.502 [3] clause 4.3.7 (CN-initiated selective
deactivation of UP connection of an existing PDU Session) is used for CN-
initiated selective deactivation of UP connection for an established PDU
Session associated with W-5GAN Access of a 5G-RG/FN-RG in CM-CONNECTED state,
with the following exceptions:
\- The NG-RAN corresponds to a W-AGF.
\- The user plane resource between the 5G-RG/FN-RG and W-AGF, is released not
with RRC signalling but with procedure in the scope of BBF/Cablelabs.
### 7.3.6 FN-RG or Network Requested PDU Session Modification via W-5GAN
The PDU session modification procedure for the FN-RG is similar to that of
5G-RG described in clause 7.3.2 but with the following differences:
\- The 5G-RG is replaced with an FN-RG.
\- W-AGF acts on behalf of FN-RG, as an endpoint for N1 signalling. The
triggers for initiating PDU Session Modification by the W-AGF are defined by
BBF (BBF TR-456 [9]) and Cablelabs.
\- If applicable, based on BBF specification BBF TR-456 [9] and Cablelabs
specification, in step 1, the W-AGF initiates a PDU Session Modification
Request to the AMF on behalf of FN-RG.
\- W-AGF may issue L-W-CP resource modification procedure with the FN-RG that
is related with the information received from the SMF as in step 4. The
actions performed by W-AGF are defined by BBF (BBF TR-456 [9]) and Cablelabs.
\- In step 4, L-W-UP resources may be modified by the W-AGF.
\- Steps 7a and 7b of clause 7.3.2 are not valid for the FN-RG. The W-AGF
creates an Uplink NAS transport message to the AMF, which contains the PDU
Session Modification Ack as in step 8.
### 7.3.7 FN-RG or Network Requested PDU Session Release via W-5GAN
The PDU session release procedure for the FN-RG is similar to that of 5G-RG
described in clause 7.3.3 but with the following differences:
\- The 5G-RG is replaced with an FN-RG.
\- W-AGF acts on behalf of FN-RG, as an endpoint for N1 signalling.
\- In step 2, the W-AGF sends a PDU session release request to the AMF on
behalf of FN-RG.
\- In step 5, upon receiving AN session release request message from the AMF,
the W-AGF can trigger the release of the corresponding L-W-UP resource with
procedure in scope of BBF/CableLabs.
\- Steps 8 and 9 of clause 7.3.3 are not valid for the FN-RG. The W-AGF
creates an Uplink NAS transport message to the AMF, which contains the PDU
Session Release Ack as in step 10.
### 7.3.8 Session Management Procedures for AUN3 devices
#### 7.3.8.1 PDU Session Establishment of AUN3 device behind 5G-RG
This clause specifies the PDU Session Establishment for an AUN3 device served
by a 5G-RG as defined in clause 4.10c.
A distinct PDU session is established for each AUN3 device.
After the registration from the AUN3 device, the 5G-RG initiates the
establishment of a PDU Session on behalf of the AUN3 device
The PDU Session is established as specified in clause 7.3.1.1 with following
differences:
\- Steps 1a, 1b and 2b are executed over the AUN3 device\'s NAS signalling
connection and AUN3 device\'s N2 connection.
\- At step 3 in figure 4.3.2.2.1 of TS 23.502 [3], the AMF sends the AUN3 SUPI
as the SUPI of the PDU session in the Nsmf_PDUSession_CreateSMContext Request
sent to the SMF.
\- Steps 5 and 6 are executed over the AUN3 device\'s N2 connection and AUN3
device\'s NAS signalling connection.
\- At step 7b in figure 4.3.2.2.1 [3] of TS 23.502 [3], the SMF sends in the
Npcf_SMPolicyControl_Create Request the SUPI of the PDU session (i.e. the AUN3
SUPI).
#### 7.3.8.2 PDU Session Modification of AUN3 device behind 5G-RG
This clause specifies the PDU Session Modification for an AUN3 device served
by a 5G-RG as defined in clause 4.5.3.
The PDU Session modification procedure shall use clause 7.3.2 with following
differences:
\- Step 1 is executed over the AUN3 device\'s NAS signalling connection and
AUN3 device\'s N2 connection.
\- At step 1a in figure 4.3.3.2-1 of TS 23.502 [3], the AMF sends the AUN3
SUPI as the SUPI of the PDU session.
\- At step 2 in figure 4.3.3.2-1 of TS 23.502 [3], the SMF sends in the
Npcf_SMPolicyControl_Update Request the SUPI of the PDU session (i.e. the AUN3
SUPI).
\- Steps 3 and 5 are executed over the AUN3 device\'s N2 connection.
\- Steps 7 and 8 are executed over the AUN3 device\'s N2 connection and AUN3
device\'s NAS signalling connection.
\- Only 5GC initiated PDU Session modification is supported in this Release.
#### 7.3.8.3 PDU Session Release of AUN3 device behind 5G-RG
This clause specifies the PDU Session Release for an AUN3 device served by a
5G-RG as defined in clause 4.10c. This clause applies only to 5G-RG.
AUN3 device may trigger explicit request for connection release, or it may be
unreachable (on the 5G-RG to AUN3 device interface). In such scenarios 5G-RG
may need to release the PDU session of the AUN3 device.
NOTE: How an AUN3 device can trigger the release of a PDU Session is out of
scope of 3GPP specifications.
PDU session release for a specific AUN3 device can also be initiated by the
5GC (e.g., the subscription of the AUN3 device expires).
The PDU Session release procedure shall use clause 7.3.3 with following
differences:
\- Step 1 is executed over the AUN3 device\'s NAS signalling connection and
AUN3 device\'s N2 connection.
In step 1a of figure 4.3.4.2-1 of TS 23.502 [3], the 5G-RG sends the PDU
Session Release message on the AUN3 device\'s NAS connection.
\- Steps 4 and 6 are executed over the AUN3 device\'s N2 connection.
\- Steps 8-10 are executed over the AUN3 device\'s N2 connection and AUN3
device\'s NAS signalling connection.
## 7.4 SMF and UPF interactions
SMF and UPF interactions for 5G-RG and FN-RG follow the procedures defined in
TS 23.502 [3] clause 4.4.
## 7.5 User Profile management procedures
When 5G-RG or FN-RG is used, the User Profile management procedures in TS
23.502 [3] clause 4.5 apply, with the differences described below:
\- The UE in TS 23.502 [3] clause 4.5 is replaced by 5G-RG or FN-RG.
\- When 5G-RG or FN-RG is connected via W-5GAN, steering of roaming
information is not applicable, since roaming is not supported.
\- The AMF updates 5G-RG context and FN-RG context stored at W-AGF to modify
the RG Level Wireline Access Characteristics.
## 7.6 Handover procedure
### 7.6.1 General
This clause includes the differences for 5G-RG comparing to TS 23.502 [3]
clause 4.9.
Handover procedures in this clause are not supported for FN-RG. SRVCC is not
applicable to RG.
### 7.6.2 Handover within NG-RAN
If the 5G-RG is connected via FWA, the procedures in TS 23.502 [3] clause
4.9.1 apply with the differences shown as below:
\- UE is replaced by 5G-RG.
### 7.6.3 Handover procedures between 3GPP access / 5GC and W-5GAN access
#### 7.6.3.1 Handover of a PDU Session procedure from W-5GAN access to 3GPP
access
This clause specifies how to hand over a 5G-RG from a source W-5GAN access to
a target 3GPP access and how a 5G-RG can handover a PDU Session from W-5GAN
access to 3GPP access. It is based on the PDU Session Establishment procedure
for 3GPP access as specified in clause 4.3.2 of TS 23.502 [3].
Figure 7.6.3.1-1: Handover of a PDU Session procedure from W-5GAN access to
3GPP access
The Handover of a PDU Session procedure specified in TS 23.502 [3] clause
4.9.2.1 applies with the following changes.
1-2. These steps are the same as steps 1-2 in TS 23.502 [3] clause 4.9.2.1
with the difference that the UE is replaced by 5G-RG.
3\. The SMF executes the release of resources in W-5GAN access by performing
steps 4 to 6 specified in clause 7.3.3, followed by step 7a specified in
clause 4.3.4.2 of TS 23.502 [3] in order to release the resources over the
source W-5GAN access. Because the PDU Session shall not be released, the SMF
shall not send the NAS PDU Session Release Command to the 5G-RG. Hence, in
steps 4 and 6 of clause 7.3.3 as well as in step 7a in clause 4.3.4.2 of TS
23.502 [3], the messages do not include the N1 SM container but only the N2
PDU Session Resource Release Command (resp. Response). Since the PDU Session
is not to be released, the SMF shall not execute step 7b in clause 4.3.4.2 of
TS 23.502 [3] and the SM context between the AMF and the SMF is maintained.
Steps 2 and 3 shall be repeated for all PDU Sessions to be moved from to
W-5GAN access to 3GPP access.
#### 7.6.3.2 Handover of a PDU Session procedure from 3GPP to W-5GAN access
This clause specifies how to hand over a 5G-RG from a source 3GPP access to a
target W-5GAN access and how a 5G-RG can handover a PDU Session from 3GPP
access to W-5GAN access. It is based on the PDU Session Establishment
procedure for W-5GAN access as specified in clause 7.3.1.
Figure 7.6.3.2-1: Handover of a PDU Session from 3GPP access to W-5GAN access
The Handover of a PDU Session procedure specified in TS 23.502 [3] clause
4.9.2.2 applies with the following changes.
1\. If the 5G-RG is not registered via W-5GAN access, the 5G-RG shall initiate
Registration procedure as defined in clause 7.2.1.1.
2\. The 5G-RG performs PDU Session Establishment procedure in W-5GAN access
with the PDU Session ID of the PDU Session to be moved as specified in clause
7.3.1.
3 This step is the same as step 3 in TS 23.502 [3] clause 4.9.2.2 with the
difference that the UE is replaced by 5G-RG. If the User Plane of the PDU
Session is already deactivated in 3GPP access, this step is skipped.
Steps 2 and 3 shall be repeated for all PDU Sessions to be moved from 3GPP
access to W-5GAN access.
### 7.6.4 Handover procedures between 3GPPaccess / EPS and W-5GAN/5GC access
#### 7.6.4.1 Handover from 3GPP access / EPS to W-5GAN / 5GC
Figure 7.6.4.1-1: Handover from EPS to W-5GAN/5GC
The procedure specified in clause 4.11.3.1 of TS 23.502 [3] (Handover from EPS
to 5GC-N3IWF) applies with the following changes.
0\. Initial status: one or more PDN connections have been established in EPC
between the 5G-RG and the PGW-C+SMF via E-UTRAN.
1\. The 5G-RG initiates Registration procedure via W-5GAN access according to
clause 7.2.1.1.
2\. The 5G-RG initiates a PDU Session Establishment with Existing PDU Session
indication in 5GC via W-5GAN access according to clause 7.3.1.
3\. This step is the same as step 3 in clause 4.11.3.1 of TS 23.502 [3].
#### 7.6.4.2 Handover from W-5GAN / 5GC access to 3GPP-access / EPS
Figure 7.6.4.2-1: Handover from W-5GAN/5GC to EPS
0\. Initial status: one or more PDU Sessions have been established via W-5GAN
/ 5GC access. During PDU Session setup, and in addition to what is specified
in clause 4.3.2.2.1 of TS 23.502 [3], the PGW-C+SMF sends the FQDN related to
the S5/S8 interface to the HSS+UDM which stores it.
1\. If the UE is not attached to EPC/E-UTRAN, the UE initiates Handover Attach
procedure in E-UTRAN as described in TS 23.401 [24] for a non-3GPP to EPS
handover with \"Handover\" indication, except note 17.
If the UE is attached in EPC/E-UTRAN, the UE initiates the PDN Connection
establishment with \"Handover\" indication procedure as described in TS 23.401
[24].
2\. The combined PGW-C+SMF initiates a network requested PDU Session Release
via W-5GAN access according to clause 7.3.3, steps 4-7 to release the 5GC and
W-5GAN resources with the following exception:
\- Nsmf_PDUSession_SMContexStatusNotify service operation invoked by the SMF
indicates the PDU Session is moved to another system.
\- The Npcf_SMPolicyControl_Delete service operation to PCF shall not be
performed.
## 7.7 Support of specific services
### 7.7.0 General
This clause specifies the procedure for specific services for WWC scenario
defined in clause 5.
### 7.7.1 IPTV
#### 7.7.1.1 Overview
In this Release of the specification, in order to support IPTV services,
following principles apply:
\- the 5G-RG supports IP PDU Session Type;
\- IP multicast traffic received from N6 interface is replicated by UPF and
sent over PDU Sessions;
\- IGMP or MLD messages from the STB or from the 5G-RG are terminated and
managed by the UPF acting as PSA;
\- IGMPv2 specified in RFC 2236 [33], IGMPv3 specified in RFC 4604 [21], for
MLDv1 specified in RFC 2710 [36] and MLDv2 specified in RFC 4604 [21] are
supported
NOTE 1: Whether IGMP or MLD is exchanged with 5G RG or another entity (e.g.
STB) is out of the scope of 3GPP.
NOTE 2: In this specification the generic term IGMP refers to both IGMPv2 and
IGMPv3 unless specifically defined. The term MLD refers to both MLDv1 and
MLDV2 unless specifically defined.
NOTE 3: The IGMP \"Join message\" and MLD \"Join message\" are generic terms
used in this document to indicate the request of a host to join a multicast
group which can express via IGMP and MLD Report message (e.g. Membership
Report) or via Join message.
\- The SMF controls the support of IPTV by the UPF acting as PSA using PDR,
FAR, QER, URR. This includes control of which IGMP and MLD requests the UPF is
to accept or to deny.
This clause describes the procedures that support IPTV in 5G system including
the procedures below:
\- Registration and PDU Session Establishment procedure for IPTV is shown in
clause 7.7.1.1.1. The Registration Procedure is used to register to 5GS and
the PDU Session Establishment Procedure is used to establish the PDU Session
used for IPTV Service.
\- IPTV Access procedure shown in clause 7.7.1.1.2 may, depending on the
deployment, be used to access the IPTV network, e.g. completing the IPTV
Authentication and IP allocation.
\- Unicast/Multicast Packets transmission procedure shown in clause 7.7.1.1.3.
The procedure specifies how to transmit unicast/multicast packets related with
IPTV service over 5GC.
In this Release of the specification, the 5GC does not assume any traffic
replication capability in the 5G AN (NG-RAN or W-5GAN).
NOTE 4: In this release of the specification, the case of different STBs
behind a 5G-RG is supported only when the STBs share the same access right.
##### 7.7.1.1.1 Registration and PDU Session Establishment procedure for IPTV
5G-RG perform Registration procedure described in clause 4.2.2.2.2 of TS
23.502 [3] with the following differences:
\- UE is replaced by 5G-RG.
5G-RG perform PDU Session establishment procedure described in clause
4.3.2.2.1 of TS 23.502 [3] applies with the following differences and
clarifications:
\- UE is replaced by 5G-RG.
\- In step 1 of clause 4.3.2.2.1 of TS 23.502 [3], 5G-RG may indicate within
the Protocol Configuration Options element that the UE requests to obtain the
IPv4 address with DHCPv4.
\- 5G-RG shall establish an IP-based PDU Session with a specific (DNN,
S-NSSAI) for IPTV service.
\- In step 7b and 9 of clause 4.3.2.2.1 of TS 23.502 [3], the PCF provides PCC
Rules including information related to IPTV Service. This is specified in
clause 9.3.1.
\- The SMF sends to the UPF acting as PSA N4 rules such as PDR, FAR related to
IP Multicast traffic allowed for the PDU Session. This may take place at steps
10a and 16a of clause 4.3.2.2.1 of TS 23.502 [3]. Such N4 rules are further
described in clause 4.6. IP Multicast traffic allowed for the PDU Session
corresponds to IPTV services allowed for the user.
NOTE: The interactions between STB and 5G-RG are specified in TR-124 [5] in
BBF and not shown in this clause.
##### 7.7.1.1.2 IPTV Access procedure
In the case of IPTV network access control based on the DHCP procedure, 5G-RG
may be configured to retrieve via DHCP the IP address that it will use to
access IPTV services. The DHCP procedure described in TS 23.501 [2] clause
5.8.2.2 is carried out with the difference shown below:
\- When the SMF receives the Uplink DHCP message, the SMF may be configured to
insert the IPTV access control information as received in subscription data
from UDM to the uplink DHCP message.
NOTE 1: The IPTV access control information can include a line ID defined in
RFC 3046 [20] or any other identity which can be used to identify the IPTV
subscriber. This is based on IPTV deployment and 3GPP doesn\'t define the IPTV
access control information that the SMF copies from subscription data to DHCP
signalling.
NOTE 2: The interactions between STB and 5G-RG is specified in BBF TR-124 [5].
NOTE 3: The description of interactions among the elements part of the IPTV
network is out of 3GPP scope.
##### 7.7.1.1.3 Unicast/Multicast Packets transmission procedure
5GS can support Unicast Service from IPTV network directly.
In order to obtain the multicast service from IPTV network, the Multicast
Packets transmission procedure should be performed. The procedure in figure
7.7.1.1-3 describes how the 5G-RG joins an IP multicast group.
Figure 7.7.1.1-3: 5G-RG join IP Multicast Packets transmission procedure
1\. The 5G-RG sends an IGMP or MLD Join message via the IP PDU Session user
plane.
2\. When UPF receives the IGMP or MLD Join, the UPF may identify IGMP and MLD
packets based on PDR received over N4 as described in clause 4.6 and handle
the IGMP and MLD Join accordingly based on FAR as described in clause 4.6. An
example is given as below:
\- If the IP Multicast Addressing information included in the IGMP or MLD Join
message is allowed to be accessed via the PDU Session , the UPF shall add the
PDU Session to the requested multicast group. If requested by an URR, the UPF
notifies the SMF that the UE is joining to a multicast group, providing the
associated IP Multicast Addressing information.
\- If the IP Multicast Addressing information included in the IGMP or MLD Join
message is not allowed to be accessed via the PDU Session, the UPF shall not
add the PDU Session to the requested multicast group.
The UPF acts as a Multicast Router as defined in IETF RFC 2236 [33], IETF RFC
4604 [21] and IETF RFC 2710 [36]. This may include following actions:
\- if the IGMP or MLD Join message is the first IGMP or MLD request the UPF
has received about the target IP multicast traffic: the UPF exchanges N6
signalling such as PIM (Protocol-Independent Multicast) in order to connect to
the N6 multicast distribution tree related with this IP multicast traffic;
This ensures that the UPF receives the DL multicast traffic.
\- The IP multicast related signalling protocol used on N6 (e.g. Sparse Mode
PIM-SM) to be supported over N6 is defined by local policies on the UPF.
2b. if the SMF had set the corresponding URR Reporting trigger with a value
\"IP multicast join/leave\" (as defined in clause 4.6.5), the UPF issues an
UPF report to the SMF and the corresponding IP Multicast addressing
information
2c. if the PCF had set the corresponding Policy Control Request Trigger set to
\"UE join to a multicast group\" trigger\" (as defined in clause 9.7), the SMF
issues a SMF initiated SM Policy Association Modification (as defined in TS
23.502 [3] clause 4.16.5) reporting to the PCF the corresponding IP Multicast
addressing information.
3-4. When the UPF receives IP multicast packets from multicast server in IPTV
network, the UPF select the PDU Session(s) where to transmit the multicast
packets based on the multicast group, constructed in step 2 and fulfilling the
FAR and QER rules described in clause 7.7.1.1.1.
NOTE 1: The interactions between STB and 5G-RG are specified in BBF TR-124 [5]
and are not shown in figure 7.7.1.1-3.
The 5G-RG may leave the IP Multicast Group as follows:
\- sending an unsolicited IGMP Leave or MLD Done message;
\- IGMPv2 Leave message or a IGMPv3 Membership Report with indication of State
Change Record or MLD Done message to request to leave a specific IP Multicast
Group. The Message may be solicited by UPF via an IGMP MLD Query message.
NOTE 2: The Membership Query is typically used in IPTV system to recover from
error conditions such as when the Leave message has been dropped by
intermediate node or when the STB has been powered off without being able to
send a Leave Message.
Figure 7.7.1.1-4: 5G-RG leave IP Multicast Packets transmission procedure
1a The UPF acting as a Multicast Router as defined in IETF RFC 2236 [33] and
IETF RFC 3376 [28] may send an IGMP Query or an MLD Query message.
1b The 5G-RG may send a IGMP or MLD Membership Report message where the
address of a IP Multicast Group is no more included in the list. This message
may be the answer to the query in step 1a or it may be sent unsolicited.
1c The 5G-RG may send an IGMPv2 Leave message or a IGMPv3 Membership Report
with indication of State Change Record or MLD Done message to request to leave
a specific IP Multicast Group.
2 When UPF receives the IGMP or MLD message in step 1b or 1c the UPF may
identify the IGMP and MLD packets based on PDR received over N4 as described
in clause 4.6.3 and handle the IGMP and MLD message accordingly as below:
\- If the IP Multicast Addressing information included in the IGMP or MLD
Report message does not include the IP address(es) of a multicast group the
UPF stop forwarding the packet to the 5G-RG.
\- if the UPF receives an IGMP Leave or MLD Done message, the UPF stops
forwarding multicast packets related to the IP multicast Group to the 5G-RG.
The UPF acts as a Multicast Router as defined in IETF RFC 2236 [33], IETF RFC
4604 [21] and IETF RFC 2010 [37]. This may include following actions:
\- the UPF may exchange N6 signalling such as PIM (Protocol-Independent
Multicast) in order to leave a IP multicast Group if no other 5G-RG are
connected to the same IP multicast Group; This ensures that the UPF does no
more receive the DL multicast traffic, if not needed.
\- The IP multicast related signalling protocol used on N6 (e.g. Sparse Mode
PIM-SM) to be supported over N6 is defined by local policies on the UPF.
3\. if the SMF had set the corresponding URR Reporting trigger with a value
\"IP multicast join/leave\" (as defined in clause 4.6.5), the UPF issues an
UPF report to the SMF the corresponding IP Multicast addressing information
4\. if the PCF had set the corresponding Policy Control Request Trigger set to
\"UE join to a multicast group\" trigger\", the SMF issues a SMF initiated SM
Policy Association Modification (as defined in TS 23.502 [3] clause 4.16.5)
reporting to the PCF the corresponding IP Multicast addressing information.
##### 7.7.1.1.4 AF request to provision Multicast Access Control List
information into UDR
Figure 7.7.1.1.4: AF request to provision Multicast Access Control List
information into UDR
NOTE 1: The 5GC NFs used in this scenario are assumed to all belong to the
same PLMN (HPLMN).
1\. To create a new request, the AF invokes an Nnef_IPTV_configuration service
operation. The request contains the Multicast Access Control List, a GPSI or
an External Group Id, AF Transaction Id, application identifier and may
contain a DNN and/or a S-NNSAI. To update or remove an existing request, the
AF invokes Nnef_IPTV_configuration_Update or Nnef_IPTV_configuration_Delete
service operation providing the corresponding AF Transaction Id.
2\. The AF sends its request to the NEF. The NEF ensures the necessary
authorization control, including throttling of AF requests and, as described
in clause 4.3.6.1 of TS 23.502 [3], mapping from the information provided by
the AF into information needed by the 5GC.
3\. (in the case of Nnef_IPTV_configuration_Create or Update): The NEF stores
the AF request information in the UDR (Data Set = Application Data; Data
Subset = IPTV_configuration, Data Key = AF Transaction Internal ID, S-NSSAI
and DNN and/or SUPI/Internal-Group-Id).
(in the case of Nnef_IPTV_configuration_Delete): The NEF deletes the AF
requirements in the UDR (Data Set = Application Data; Data Subset =
IPTV_configuration, Data Key = AF Transaction Internal ID).
The NEF responds to the AF.
4\. The PCF(s) that have subscribed to modifications of AF requests (Data Set
= Application Data; Data Subset = IPTV_configuration, Data Key =
SUPI/Internal-Group-Id) receive a Nudr_DM_Notify notification of data change
from the UDR.
5\. The PCF determines if existing PDU Sessions are potentially impacted by
the AF request. For each of these PDU Sessions, the PCF updates the SMF with
corresponding new PCC rule(s) by invoking Npcf_SMPolicyControl_UpdateNotify
service operation as described in steps 5 and 6 in clause 4.16.5 of TS 23.502
[3].
Table 7.7.1.1.4-1 shows an example of a Multicast Access Control list provided
by the AF in the IPTV domain to the NEF. The Multicast Access Control List
defines the access right status (i.e. fully allowed, preview allowed, not
allowed) of each of the Multicast channels per subscriber identified by a
GPSI.
Table 7.7.1.1.4-1: Example of a Multicast Access Control list provided by the
AF in the IPTV domain
           IP Multicast Addressing information 1 (related to Channel 1)   IP Multicast Addressing information 2 (related to Channel 2)   IP Multicast Addressing information 3 (related to Channel 3)
* * *
GPSI 1 Fully allowed Not allowed Preview allowed
The NEF maps the GPSI into the SUPI, assigned to a 5G-RG, as described in step
2 in Figure 7.7.1.1.4-1. and stores the Multicast Access Control List in the
UDR as shown in Table 7.7.1.1.4-2.
Table 7.7.1.1.4-2: Example of a Multicast Access Control list stored in UDR
within the Application Data Set
DataKey IP Multicast Addressing information 1 (related to TV Channel 1) IP
Multicast Addressing information 2 (related to TV Channel 2) IP Multicast
Addressing information 3 (related to TV Channel 3)
* * *
SUPI for 5G-RG 1 Fully allowed Not allowed Preview allowed SUPI for 5G-RG 2
Fully allowed Fully allowed Not allowed SUPI for 5G-RG 3 Fully allowed Preview
allowed Preview allowed
If source Specific Multicast is to be used for a TV Channel, IP Multicast
Addressing information corresponds to IP Multicast address and Source IP
address.
The PCF is assumed to have subscribed to relevant modifications of that UDR
data defined in the Table 7.7.1.1.4-2.
# 8 Network Function services
## 8.0 General
This clause specifies the delta related to Network Function services
description defined in TS 23.502 [3] clause 5.2. For 5G RG in FWA mode TS
23.502 [3] clause 5.2 applies.
## 8.1 UDM Services
### 8.1.1 Nudm_SubscriberDataManagement (SDM) Service
#### 8.1.1.1 General
In addition to the Subscription data types used in the
Nudm_SubscriberDataManagement Service, as defined in Table 5.2.3.3.1-1 of TS
23.502 [3], the additional data types defined in Table 8.1.1.1-1 below are
applicable for RGs connected to 5GC via W-5GAN.
Table 8.1.1.1-1: Wireline access specific UE Subscription data types
Subscription data type Field Description
* * *
Access and Mobility Subscription data (data needed for UE Registration and
Mobility Management) RG Level Wireline Access Characteristics The RG level
Wireline Access Characteristics parameter provides QoS information for the
W-AGF, as defined in clause 4.5.1.2. This parameter is handled by the UDM as a
transparent container.
In the case of Wireline access, the Forbidden area information within Table
5.2.3.3.1-1 of TS 23.502 [3] may correspond to a (set of) allowed Global Line
ID.
## 8.2 Void
## 8.3 BSF Services
### 8.3.1 General
The Nbsf_Management_Register/Deregister and Discovery service operations
defined in TS 23.502 [3] are extended to allow registration/deregistration and
discovery of the binding information when one or multiple /128 IPv6 address or
UE IPv6 prefix shorter than /64 is/are assigned to a PDU session.
## 8.4 PCF Services
### 8.4.1 General
PCF services defined in TS 23.502 [3] apply with modifications described in
this clause.
### 8.4.2 Npcf_SMPolicyControl
The Npcf_SMPolicyControl_Create and Npcf_SMPolicyControl_Update, defined in TS
23.502 [3], are extended to be able to provide PCF with one or multiple
allocated /128 IPv6 UE address or with UE IPv6 prefix shorter than /64.
The Npcf_SMPolicyControl_Update, defined in TS 23.502 [3], is extended to be
able to provide PCF with information on a released /128 IPv6 address or on a
released UE IPv6 prefix shorter than /64.
### 8.4.3 Npcf_AMPolicyControl
#### 8.4.3.1 Npcf_AMPolicyControl_Create service operation
The input data listed in clause 5.2.5.2.2 in TS 23.502 [3] apply when an AM
Policy Association is created for a 5G-RG, except for the handling of RFSP
information that applies only if a 5G RG is registered over 3GPP access.
The input information when the UE registers via W-5GAN includes the Access
type set to non-3GPP access, the User Location Information including the GLI
or the HFC node Id.
The output information when the UE registers via W-5GAN is defined in clause
9.5 and the Policy Control Request triggers applicable for for RG access via
W-5GAN are defined in clause 9.5.3.
#### 8.4.3.2 Npcf_AMPolicyControl_Update service operation
The input data listed in clause 5.2.5.2.5 in TS 23.502 [3] apply when an AM
Policy Association is updated for a 5G-RG or for a FN-RG, except for the
notification of UE location change (if an RG registers only on Wireline
access), PRA changes or RFSP index change.
PCRT on UE location change apply when a 5G RG registers on a second access (5G
RG using Hybrid access).
The output information when the UE registers via W-5GAN is defined in clause
9.5 and the Policy Control Request triggers applicable when RG accesses via
W-5GAN are defined in clause 9.5.3.
The Access type change trigger requests the AMF to report a new Access Type
and RAT Type to the PCF. When the UE simultaneous connects over both 3GPP and
wireline non-3GPP access type, the AMF reports the list of Access Type and RAT
combinations available in the UE access and mobility context in the
Npcf_AMPolicyControl_Update service operation.
## 8.5 Nnef_IPTVconfiguration service
### 8.5.1 General
**Service description:** This service provides:
\- Request authorization of NF Service Consumer requests.
\- Request parameter mapping from NF Service Consumer requests to 5GC
parameters and vice versa as described in clause 7.7.1.1.x
\- NF Service Consumer request configuration of Multicast Access control list
as described in clause 7.7.1.1.4.
### 8.5.2 Nnef_IPTVconfiguration_Create operation
**Service operation name:** Nnef_IPTVconfiguration_Create
**Description:** Authorize the request and forward the request for IPTV
configuration information.
**Inputs (required):** AF Transaction Id, GPSI or External-Group-ID,
application identifier, Multicast Access Control List.
The AF Transaction Id refers to the request.
**Inputs (optional):** DNN, S-NSSAI.
**Outputs (required):** Operation execution result indication.
**Outputs (optional):** None.
### 8.5.3 Nnef_IPTVconfiguration_Update operation
**Service operation name:** Nnef_IPTVconfiguration_Update
**Description:** Authorize the request and forward the request to update IPTV
configuration information.
**Inputs (required):** AF Transaction Id.
The AF Transaction Id identifies the NF Service Consumer request to be
updated.
**Inputs (optional):** Multicast Access Control List.
**Outputs (required):** Operation execution result indication.
**Outputs (optional):** None.
### 8.5.4 Nnef_IPTVconfiguration_Delete operation
**Service operation name:** Nnef_IPTVconfiguration_Delete
**Description:** Authorize the request and forward the request to delete(s)
request for IPTV configuration information.
**Inputs (required):** AF Transaction Id.
The AF Transaction Id identifies the NF Service Consumer request for IPTV
configuration to be deleted.
**Inputs (optional):** None.
**Outputs (required):** Operation execution result indication.
**Outputs (optional):** None.
## 8.6 UDR Services
### 8.6.1 Nudr_DataManagement (DM) Service
#### 8.6.1.1 General
The UDM makes use of the Nudr_DM service to perform the mapping of the
SUPI/IMSI associated with the Line ID or HFC-Identifier included in the SUCI.
In addition to the Subscription data types and corresponding Subscription Data
keys used in the Nudr_DM_Service, as defined in TS 23.502 [3], the
Subscription data types and corresponding Subscription data keys defined for
the Nudr_DM Service in Table 8.6.1.1-1 and Table 8.6.1.1-2 are applicable for
FN-RGs connected to 5GC.
Table 8.6.1.1-1: UE Subscription data types
Subscription data type Field Description
* * *
Subscription identifier translation Other Identifier Of The Subscription
(Global Line ID or Global Cable ID) Global Line ID or Global Cable ID included
in SUCI provided by the W-AGF to the 5GC for FN-RG support and used as
pseudonym of the SUPI. SUPI Corresponding SUPI
Table 8.6.1.1-2: Data keys
Data Set Data Subset Data Key Data Sub Key
* * *
Subscription Data Subscription identifier translation Global Line ID or Global
Cable ID -
# 9 Policy and Charging Control Framework and Configuration by ACS
## 9.0 General
This clause specifies the delta related to Policy and charging control
framework defined in TS 23.503 [4] and the configuration of the 5G-RG by the
ACS.
## 9.1 Session management related policy control
### 9.1.0 General
This clause specifies the delta related to UE policy distribution defined in
TS 23.503 [4] clause 6.1.3 for 5G-RG and FN-RG.
### 9.1.1 Session binding
The session binding mechanism defined in TS 23.503 [4] clause 6.1.3.2.2
applies. In addition, the PDU session parameters considered for session
binding are:
\- For IPv6 PDU session type, one or multiple UE IPv6 address or one or
multiple IPv6 prefixes /64 or shorter prefixes.
\- For IPv4v6 PDU session type, one UE IPv4 address and one or multiple IPv6
prefixes /64 or shorter prefixes.
### 9.1.2 Policy Control Request Triggers relevant for SMF and wireline access
type
The Policy Control Request Triggers relevant for SMF and wireline access
define the conditions when the SMF shall interact again with PCF after a PDU
Session established via W-5GAN. PCR triggers defined in Table 6.1.3.5 in TS
23.503 [4] are supported for W-5GAN scenario with the following not supporting
ones:
\- PLMN change.
\- Location change (serving area).
\- Location change (serving CN node in 5GS).
\- Location change (serving CN node in EPC).
\- Change of UE presence in Presence Reporting Area.
\- 3GPP PS Data Off status change.
\- GFBR of the QoS Flow can no longer (or can again) be guaranteed.
\- UE resumed form suspend data.
\- Manageable Ethernet Port detected.
\- Port Management Information Container available.
Additionally, the new triggers defined in clause 9.7 for IPTV service are also
applied for a 5G-RG connected via W-5GAN scenario.
## 9.2 Network Functions and entities
### 9.2.1 General
This clause specifies the delta related to Network Function and entities
defined in TS 23.503 [4] clause 6.2 for 5G-RG and FN-RG.
The functional description of the NEF, NWDAF, UDR and CHF applies as described
in TS 23.503 [4].
### 9.2.2 Policy Control Function (PCF)
The PCF provides session management policy control for single access PDU
sessions over non 3GPP wireline and multiaccess PDU sessions over both 3GPP
and non 3GPP wireline access.
The session management related functionality defined in clause 6.2.1 of TS
23.503 [4] applies for 5G-RG and FN-RG, with the following modifications for
W-5GAN:
\- Determination of Maximum Packet Loss Rate for UL/DL does not apply.
\- QoS Notification Control does not apply.
NOTE: No requirements to support MPS or Mission Critical Services over
wireline non 3GPP access are defined in this Release.
The non-session management related functionality defined in clause 6.2.2 of TS
23.503 [4] applies for 5G-RG and FN-RG, with the following modifications for
W-5GAN:
\- the UE-AMBR control by the Visited Network does not apply.
\- the Service Area Restrictions for a FN-BRG does not apply.
\- the 5G-RG and FN-RG replaces the UE.
\- the PCF provides Access and mobility related policy control as described in
clause 9.5.1.
\- the PCF provides UE access selection and PDU session selection
\- the PCF provides the UE access selection and PDU Session selection related
policy control as defined in clause 9.5.2.
The policy control subscription data defined in TS 23.503 [4] applies for
5G-RG and FN-RG connected via W-5GAN access, except for the definition of MPS
data for a 5G-RG or FN-RG that is not applicable in this Release.
The policy control subscription data defined in TS 23.503 [4] applies for a
5G-RG and FN-RG connected via W-5GAN, except for the definition of MPS data
for a 5G-RG or FN-RG that is not applicable in this Release.
The V-PCF and H-PCF functionality does not apply for session and non-session
policy control for 5G-RG and FN-RG users in this Release.
### 9.2.3 Session Management Function (SMF)
The SMF enforces policy decisions related to service data flow detection,
authorized QoS, charging, gating, traffic usage reporting, packet routing and
forwarding and traffic steering for single access PDU session over W-5GAN and
multiaccess PDU sessions over W-5GAN and 3GPP as defined in clause 6.2.2 of TS
23.503 [4] with the following modifications for W-5GAN:
\- Reporting RAN/NAS Release Cause over wireline is not supported.
\- The Maximum Packet Loss Rate for UL and DL is not forwarded to the wireline
non-3GPP access.
### 9.2.4 Application Function (AF)
The AF requests for policy control functionality described in clause 6.2.3 of
TS 23.503 [4] applies with the following clarification for W-5GAN:
\- Indication that the QoS targets can no longer (or can again) be fulfilled
is not supported.
NOTE: No requirements to support MPS or Mission Critical Services over
wireline non 3GPP access are defined in this release.
### 9.2.5 Access and Mobility Management Function (AMF)
The policy control related functionality defined in TS 23.503 [4] applies,
with the clarification that the UE-AMBR control by the visited network is only
applicable for a 5G-RG registered over 3GPP access.
## 9.3 Policy and charging control rule
Policy and charging control rule for 5G-RG PDU Session is described in TS
23.503 [4] clause 6.3 with the clarification and difference in this clause.
### 9.3.1 PCC rule information to support IPTV service
\- PCF shall take Multicast Access Control list described in clause 7.7.1.1.4
as input to policy decision in the case of PDU Session used for IPTV service.
PCC rules sent to SMF may indicate allowed IP Multicast Addressing information
as defined in Table 9.3.1-1.
\- The \"Gate status\" is not applicable to IGMP transmitted over PDU Session
used for IPTV service.
Comparing to Table 6.3.1 in TS 23.503 [4], additional PCC rule information for
PDU Session used for IPTV service is described in Table 9.3.1-1.
Table 9.3.1-1: The additional PCC rule information for PDU Session used for
IPTV service
Information name Description Category PCF permitted to modify for a dynamic
PCC rule in the SMF Differences compared with table 6.3. in TS 23.203 [31]
* * *
IPTV **_This part defines the additional PCC rule information for PDU Session
used for IPTV service._**  
IP Multicast traffic control information indicates whether the service data
flow, corresponding to the service data flow template, may be allowed or not
allowed (NOTE 1). Optional Yes Added NOTE 1: The corresponding IP Multicast
Addressing information in provided in the SDF template. The SDF template may
refer to \"any\" IP Multicast address (for example allowing the user to access
to receive any IPTV channel).
## 9.4 PDU Session related policy information
This clause specifies the delta related to PDU session related policy
information defined in TS 23.503 [4] clause 6.4 for 5G-RG and FN-RG.
## 9.5 Non-session management related policy information
### 9.5.1 Access and mobility related policy information
This clause specifies the delta related to Access and Mobility related policy
information defined in TS 23.503 [4] clause 6.1.2.1 for 5G-RG and FN-RG.
The access and mobility policy control encompass the management of service
area restrictions for a 5G-BRG or a 5G-CRG connecting to 5GC via W-5GAN or
simultaneously via NG-RAN and W-5GAN.
The management of service area restrictions enables the PCF of the serving
PLMN or SNPN to modify the service area restrictions based on operator defined
policies at any time, either by expanding a list of allowed GLIs or HFC Node
IDs or by reducing the list of non-allowed GLIs or HFC Node IDs. Operator
defined policies in the PCF may depend on input data such as time of day, or
UE context information provided by other NFs, etc.
The AMF reports the subscribed service area restrictions in NG-RAN received
from UDM during 5G-RG Registration in NG-RAN procedure when local policies in
the AMF indicate that Access and Mobility Control is enable within the PLMN or
SNPN. The AMF may request update of the service area restrictions applicable
to NG-RAN when the policy control request triggers listed in clause 6.1.2.5 in
TS 23.503 [4], are met.
The AMF reports the subscribed service area restrictions in W-5GAN received
from UDM during 5G-RG Registration in W-5GAN procedure when local policies in
the AMF indicate that Access and Mobility Control is enable within the PLMN or
SNPN. The AMF may request update of the service area restrictions applicable
to W-5GAN when the policy control request triggers listed in clause 9.5.3 are
met.
The AMF receives the modified service area restrictions from the PCF and then
use them as described in clause 4.3.3.3.
No mobility events, such a change of UE location or change of AMF applies when
provisioning the service area restrictions for a 5G-BRG or a 5G-CRG when
connected via W-5GAN.
The PCF may provide the service area restrictions applicable to a 5G-RG
connected to 5GC via W-5GAN or via NG-RAN or simultaneously connected to 5GC
via W-5GAN and NG-RAN to AMF. The PCF may provide the service area
restrictions applicable to a FN-CRG to the AMF.
The Service Area Restrictions provided to AMF for a 5G-RG connected via NG-RAN
is according to the information listed in listed in TS 23.503 [4] clause 6.5.
The Service Area Restrictions provided to AMF for a 5G-RG connected via W-5GAN
is according to the information listed in Table 9.5-1.
For a 5G-RG simultaneously connected to 5GC via W-5GAN and NG-RAN the PCF
provides Service Area Restrictions for both W-5GAN and NG-RAN.
The Service Area Restrictions provided to AMF for a FN-CRG connected via
W-5GAN is according to the information listed in Table 9.5-1.
Table 9.5-1: Access and mobility related policy control information for 5G-RG
and FN-CRG accessing via W-5GAN
+-------------+-------------+-------------+-------------+------------+ | Information | Description | Category | PCF | Scope | | name | | | permitted | | | | | | to modify | | | | | | in a AM | | | | | | context in | | | | | | the AMF | | +=============+=============+=============+=============+============+ | **Service | *This part | | | | | Area | defines the | | | | | R | service | | | | | estrictions | area | | | | | for a | r | | | | | 5G-BRG** | estrictions | | | | | | applicable | | | | | | for a | | | | | | 5G-BRG _| | | | +-------------+-------------+-------------+-------------+------------+ | List of | List of | Conditional | Yes | AM context | | allowed | allowed | | | | | GLIs | GLIs | (NOTE 1) | | | | | | | | | | | (NOTE 2) | | | | | | (NOTE 3). | | | | +-------------+-------------+-------------+-------------+------------+ | List of | List of | Conditional | Yes | AM context | | non-allowed | non-allowed | | | | | GLIs | GLIs | (NOTE 1) | | | | | | | | | | | (NOTE 3). | | | | +-------------+-------------+-------------+-------------+------------+ |__Service |_ This part | | | | | Area | defines the | | | | | R | service | | | | | estrictions | area | | | | | for a | r | | | | | 5G-CRG or | estrictions | | | | | for a | applicable | | | | | FN-CRG*_| for a | | | | | | 5G-CRG or | | | | | | for a | | | | | | FN-CRG_ | | | | +-------------+-------------+-------------+-------------+------------+ | List of | List of | Conditional | Yes | AM context | | allowed HFC | allowed HFC | | | | | Node IDs | Node IDs | (NOTE 1) | | | | | | | | | | | (NOTE 2) | | | | +-------------+-------------+-------------+-------------+------------+ | List of | List of | Conditional | Yes | AM context | | non-allowed | non-allowed | | | | | HFC Node | HFC Node | (NOTE 1) | | | | IDs | IDs (NOTE | | | | | | 2). | | | | +-------------+-------------+-------------+-------------+------------+ | NOTE 1: If | | | | | | service | | | | | | area | | | | | | r | | | | | | estrictions | | | | | | is enable. | | | | | | | | | | | | NOTE 2: | | | | | | Either the | | | | | | list of | | | | | | allowed | | | | | | (GLIs or | | | | | | HFC Node | | | | | | IDs) or the | | | | | | list of | | | | | | non-allowed | | | | | | (GLIs or | | | | | | HFC Node | | | | | | IDs) are | | | | | | provided by | | | | | | the PCF. | | | | | +-------------+-------------+-------------+-------------+------------+
The _list of allowed GLIs or the list of allowed HFC Node IDs_ indicates the
locations where the 5G-RG is allowed to be registered, see clause 4.3.3.3 for
the description on how AMF uses this information.
### 9.5.2 UE access selection and PDU Session selection related policy
information
#### 9.5.2.1 5G-RG
This clause specifies the delta related to UE policy distribution defined in
TS 23.503 [4] clause 6.1.2.2 and related to URSP defined in TS 23.503 [4]
clause 6.6. for 5G-RG.
If the PCF provides the URSP policy to the 5G-RG, the PCF should neither
include NSWO indication nor any ANDSP policies. The 5G-RG shall ignore any
NSWO indication or any ANDSP policies if received from the 5GC. The 5G-RG
shall use the URSP policy as specified in TS 23.503 [4], for example for the
association of application and PDU session, slices, etc.
The URSP indicates for the application of Auto-Configuration Server (ACS)
which PDU session type, NSSAI and/or DNN is to be used. The 5G-RG establishes
the connectivity to the management entity (e.g. ACS) via user plane connection
on a PDU session according to the URSP.
UE Policy procedures defined in clause 6.1.2.2 of TS 23.503 [4] are applicable
as follows:
\- Roaming is not applicable to W-5GAN access in this release of
specification.
In order to support the case when AUN3 devices may be connected via 5G-RG,
specific URSP rules may be configured by the PCF for the SUPI associated with
the AUN3 device.
UE Route Selection Policy information targeting an AUN3 device (i.e. sent to a
5G-RG in the NAS connection corresponding to an AUN3 device) follows the
structure defined in clause 6.2.2 of TS 23.503 [4] with following differences:
\- As an AUN3 can have only one PDU Session, its URSP shall contain a match
all TD.
In order to support the case when NAUN3 devices may be connected via 5G-RG,
specific URSP rules may be configured by the PCF on 5G-RG.
URSP rules for NAUN3 devices connected to 5G-RG follow the structure defined
in clause 6.6.2 of TS 23.503 [4] and may contain any combination of the
following traffic descriptors:
\- **IP Descriptors:** For IP traffic from NAUN3 devices connected to 5G-RG,
IP descriptors are matched against header information contained in IP packets
sent by NAUN3 devices; IP descriptors are only applicable for traffic from
NAUN3 devices if network address translation (NAT) is performed for that
traffic.
\- **Non-IP descriptors:** For Ethernet traffic from NAUN3 devices connected
to 5G-RG, Non-IP descriptors are matched against header information contained
in Ethernet frames sent by NAUN3 devices.
\- **Connectivity Group ID:** For traffic from a NAUN3 device connected to
5G-RG, Connectivity Group ID in the URSP rule is matched against the
Connectivity Group ID that the NAUN3 device is associated with (see clause
4.10b).
#### 9.5.2.2 FN-RG
This clause specifies the delta related to UE policy distribution defined in
TS 23.503 [4] clause 6.1.2.2 and related to URSP defined in TS 23.503 [4]
clause 6.6 for 5G-RG.
If the PCF provides the URSP rules related to FN-RG to the W-AGF, the PCF
should not include NSWO indication. The PCF should not provide ANDSP policies.
The W-AGF shall ignore any NSWO indication or any ANDSP policies if received
from the 5GC.
The W-AGF shall use the URSP policy as specified in TS 23.503 [4] with the
following modifications:
\- Traffic descriptor;
\- the Application Descriptor is not applicable;
\- the DNN is not applicable;
\- The Connection Capabilities Descriptor is not applicable.
NOTE 1: The FN-RG initiates the W-5GAN session with the W-AGF, for example
PPPoE, and consequently the W-AGF does not receive any indication of the
application used for that session (e.g. whether it used for web browsing or
for any specific application) and any DNN indication from the application,
hence the policy including the Application Descriptors and/or DNN will never
match the traffic.
If the PCF sends UE policy (e.g. URSP), the W-AGF shall store it for the
duration that FN-RG is registered. When the FN-RG is deregistered, the UE
policy can be removed. Whether it is done immediately, or after a certain
period (e.g. for quick recovery from disconnection or fault), or stored
permanently it is left to implementation and is out of the scope of this TS.
If the URSP for the FN-RG are present in W-AGF (e.g. pre-configured or
received from PCF) the W-AGF shall use them as defined for a UE with URSP.
If the URSP for the FN-RG are not present in W-AGF, the W-AGF acts based on
local configuration, as defined for a UE without URSP.
It is assumed that the FN-RG configuration (provided via BBF TR-069 [18]/BBF
TR-369 [19]), the URSP rules and the local configuration in the W-AGF are
consistent with each other. If the W-AGF detects conflicting requirements
based on URSP, local configuration, or requests from the FN-RG, then the URSP
rules takes precedence since they are considered the most updated and aligned
to the current 5G system conditions.
UE Policy procedures defined in clause 6.1.2.2 of TS 23.503 [4] are applicable
with the following modification:
\- Roaming is not applicable to W-5GAN access in this release of
specification.
### 9.5.3 Policy Control Request Triggers relevant for AMF and wireline access
type
The Policy Control Request Triggers relevant for AMF and wireline access type
define the conditions when the AMF shall interact again with PCF after the AM
Policy Association. PCR triggers defined in Table 6.1.2.5 in TS 23.503 [4] are
supported for W-5GAN scenario with the following not supporting ones:
\- Location change (tracking area).
\- Change of UE presence in Presence Reporting Area.
\- RFSP index change.
\- UE-AMBR change.
\- PLMN change.
Additionally, the following PCR triggers are added regarding the wireline
access type:
Table 9.5.3-1: Policy Control Request Triggers relevant for AMF and wireline
access type
+----------------------+----------------------+----------------------+ | Policy Control | Description | Condition for | | Request Trigger | | reporting | +======================+======================+======================+ | Access Type change | The Access Type and | PCF (AM Policy) | | | the RAT Type has | | | (NOTE 1) | changed | | +----------------------+----------------------+----------------------+ | NOTE 1: The RAT type | | | | is reported for 3GPP | | | | access, or when the | | | | 5G-RG or FN-RG | | | | registers over | | | | wireline access | | | | (i.e. W-AGF). | | | +----------------------+----------------------+----------------------+
The UE Policy related PCR triggers like location change, PRA change and PLMN
change are not applicable for wireline access.
## 9.6 Configuration and Management from ACS
### 9.6.1 General
Once the 5G-RG connects to 5GC, the 5G-RG shall establish a PDU session for
interaction with the ACS to support the functionalities as described in BBF
TR-069 [18] or in BBF TR-369 [19].
NOTE: Whether and how to use the objects received from the ACS by RG is out of
3GPP scope.
### 9.6.2 ACS Discovery
The ACS information may be associated to the RG subscription in the UDM / UDR.
In this case the ACS information may be provided to the RG with at least one
of the following methods:
\- via DHCP interaction if the RG sends DHCP signalling indicating a request
for ACS information. The RG sends a DHCPv4 request including a request for ACS
information and receives ACS information from the DHCP as specified in BBF
TR-069 [18] clause 3.1 for ACS Discovery or in BBF TR-369 [19] R-DIS.1 and
R-DIS.2.
\- during the PDU session establishment procedure via PCO (protocol
Configuration Option) sent in N1 SM message if the 5G-RG has asked to be
provided with ACS information via PCO. This applies for 5G-RG only.
The ACS information (e.g. URL of the ACS) is defined in BBF TR-069 [18] or in
BBF TR-369 [19].
If the RG performs ACS discovery via DHCP process and the SMF is not the DHCP
server (e.g. in the case of Ethernet PDU session), the ACS URL is provided by
the external DHCP server. In this case, the whole process is transparent to
the 5GC and the 5GC is not aware of the ACS information. If the RG performs
ACS discovery via DHCP process and the SMF is the DHCP server the ACS
information is provided by SMF as part of DHCP process and the SMF shall
support the DHCP procedure defined in BBF TR-069 [18] Amendment 6 clause 3.2
or in USP (BBF TR-369 [19]).
If the SMF is to provide ACS information to the RG (via PCO or DHCP), it gets
this ACS information from SMF subscription data.
The request of ACS information via PCO or via DHCP are mutually exclusive.
The RG may be pre-configured with an ACS information.
The 5G-RG shall consider the ACS information received with the following
descending priority order:
1) ACS information received during the DHCP process.
2) ACS information received during the PDU session establishment procedure
from SMF PCO. This applies for 5G-RG only.
3) The pre-configured ACS information in the RG.
### 9.6.3 ACS Information Configuration by the 3rd party
The ACS information may be configured by a 3rd party AF to the 5GC per
subscriber when the SMF is to provide ACS information to the RG. Subsequently,
the ACS discovery via PCO or via DHCP with the DHCP server in the SMF may
apply as described in clause 9.6.2.
Figure 9.6.3-1: ACS information configuration procedure
The ACS information configuration procedure enables the 3^rd^ party AF to
configure the ACS information (e.g. URL or IP address) to the 5GC.
1\. The 3rd party AF provides the ACS information, in the
Nnef_ParameterProvision_Update Request to the NEF as in step 1 of TS 23.502
[3] figure 4.15.6.2-1.
2\. As in step 2 of TS 23.502 [3] figure 4.15.6.2-1 where the provisioned data
is the ACS information.
3\. As in steps 3 and 4 of TS 23.502 [3] figure 4.15.6.2-1 where the
provisioned data is the ACS information.
4\. As in step 5 of TS 23.502 [3] figure 4.15.6.2-1.
5\. As in step 6 of TS 23.502 [3] figure 4.15.6.2-1.
6\. As in step 6 of TS 23.502 [3] figure 4.15.6.2-1 in order to update SMF
with ACS information.
### 9.6.4 URSP for FN RG
A W-AGF needs to be able to determine the (DNN, S-NSSAI) parameters of the PDU
Sessions it requests on behalf of a FN RG. The W-AGF requests such PDU
Sessions upon data trigger (e.g. PPPoE , DHCP, etc.) received over a data path
identified by a VLAN and a GLI; this is defined in BBF specifications (BBF
TR-456 [9] and BBF TR-470 [38]).
Thus the W-AGF needs to be configured to request different PDU Sessions for
different VLAN(s) terminated at different FN RG(s).
NOTE 1: The VLAN configuration depends on the served FN RG as a W-AGF service
area can serve different Wireline access networks with different VLAN
configurations.
The corresponding W-AGF configuration about parameters of the PDU Sessions to
request for a GLI corresponds to URSP that the W-AGF receives from the PCF for
a SUPI corresponding to a GLI.
The URSP(s) may be used to map VLAN(s) at transport level (S-tags as defined
in BBF TR-470 [38]) on the V interface of the W-AGF (identifying the target
service of the corresponding data flows, e.g. internet / IMS Voice / IPTV)
towards Route Selection components including PDU Session type, DNN, S-NSSAI,
SSC mode, etc.
NOTE 2: UDR policy data related with a FN-RG subscription (UE Policy Section,
see clause 5.4.2.3 of TS 29.519 [39]) can be configured accordingly.
## 9.7 new PCRT (Policy Control Request Trigger)
The Policy Control Request Triggers relevant for SMF are described in TS
23.503 [4] clause 6.1.3.5 with the clarification and difference shown in this
clause.
Table 9.7-1
Policy Control Request Trigger Description Difference compared with table 6.2
and table A.4.3-2 in TS 23.203 [31] Conditions for reporting Motivation
* * *
5G-RG join to a multicast group The 5G-RG has joined to an IP Multicast Group
(NOTE 1). New PCF To support IPTV as defined in clause 7.7.1 5G-RG Leave to a
multicast group The 5G-RG has left an IP Multicast Group (NOTE 1). New PCF To
support IPTV as defined in clause 7.7.1 NOTE 1: When the SMF reports this
condition it indicates the corresponding IP multicast Addressing information.
NOTE: The corresponding notification can be used by the PCF to manage Preview
Rights related with an IP multicast flow corresponding to an IPTV channel. In
this case the PCF is responsible to remove the 5G RG authorization to receive
an IP multicast flow when the preview duration has elapsed.
## 9.8 AF-based service parameter provisioning for TNAP ID
To support location dependent policies when a UE connects using trusted
non-3GPP access procedures via a TNAP collocated with a 5G-RG, as described in
Figure 4.10-1, an AF may provide one or more TNAP IDs for a UE. A TNAP IDs
provided by an AF refers to a TNAP that is collocated with a 5G-RG.
The guidance provided by the AF is sent to the HPLMN of the UE and may apply
to a single UE identified by GPSI The request cannot be sent with Any UE or a
group of UE as a target.
For TNAP service parameter provisioning (i.e., creating, updating and
deleting), the Nnef_ServiceParameter service defined in clause 4.15.6.7 of TS
23.502 [3] is performed with the following modification:
\- Service Description contains an AF service Identifier indicating that the
request is for providing TNAP information.
\- The GPSI of the target UE is provided.
\- Service Parameters include TNAP ID(s).
The PCF may compare the TNAP ID provided by the AF with the TNAP ID received
in the User Location Information when the UE connects via trusted non-3GPP
access. The PCF may apply different policies depending on whether UE is at the
TNAP/RG indicated by the AF or not. In case the PCF has both subscribed TNAP
ID and AF-provided TNAP ID, the PCF decides based on configuration whether to
apply both or one of them.
## 9.9 Policy control subscription information management
This clause specifies the delta related to policy control subscription
information defined in clause 6.2.1.3 of TS 23.503 [4] for 5G-RG and FN-RG.
To support that the PCF of a UE may, as described in clause 4.10, take the
TNAP ID into account in policy decisions when the UE connects via trusted
non-3GPP access over wireline access, following information may be supported
in PDU Session policy control subscription information for the UE that is
defined in Table 6.2-2 of TS 23.503 [4]:
Table 9.9-1: Extract of Table 6.2-2 of TS 23.503 [4]
Information name Description Category
* * *
List of TNAP ID(s) The list of identifiers of TNAP collocated with 5G-RG
associated with the subscriber Optional
# 10 Support of additional functionalities
## 10.0 General
This clause specifies the delta related to the Rel-16 additional
specifications included in TS 23.273 [29] (LCS).
## 10.1 User Location Information
The User Location Information may correspond to:
\- In the case of W-5GCAN: TAI and HFC node ID.
NOTE 1: HFC node ID identifies the point of attachment of the 5G-CRG.
\- In the case of W-5GBAN: TAI and GLI. The GLI contains an identifier of the
Line ID source and the Line ID value.
NOTE 2: A combination of Line ID and identifier of the Line ID source
identifies the attachment point of the 5G-BRG.
An indication of whether the ULI corresponds to a DSL or to a PON line may
also be provided.
\- In the case of 5G-RG connected via 3GPP access: TAI and Cell Information
(as described in TS 23.502 [3] clause 4.10 and TS 23.401 [24] clause 5.9.1).
###### ## Annex A (informative): UE behind RG using untrusted Non-3GPP access
procedures
This Annex describes how untrusted Non-3GPP access to 5GC can be provided to a
UE via a 5G-RG and FN-RG connected to 5GC.
Figure A-1: Non-roaming architecture for UE behind 5G-RG using untrusted N3GPP
access
The 5G-RG can be connected to 5GC via W-5GAN, NG-RAN or via both accesses. The
UE can be connected to 5GC via untrusted non-3GPP access (via 5G-RG), NG-RAN
or via both accesses.
NOTE 1: The reference architecture in figure A-1 only shows the architecture
and the network functions directly connected to W-5GAN or N3IWF, and other
parts of the architecture are the same as defined in TS 23.501 [2] clause 4.2.
NOTE 2: The reference architecture in figure A-1 supports service based
interfaces for AMF, SMF and other NFs not represented in the figure.
NOTE 3: The two N2 instances in Figure A-1 apply to a single AMF for a 5G-RG
which is simultaneously connected to the same 5G Core Network over 3GPP access
and Wireline 5G Access Network.
NOTE 4: The UE can as well be registered and connected via 3GPP access.
Figure A-2: Non-roaming architecture for UE behind FN-RG using untrusted N3GPP
access
The FN-RG can be connected to 5GC via W-5GAN The UE can be connected to 5GC
via untrusted non-3GPP access (via FN-RG), NG-RAN or via both accesses.
NOTE 5: The reference architecture in figure A-2 only shows the architecture
and the network functions directly connected to Wireline 5G Access Network or
N3IWF, and other parts of the architecture are the same as defined in clause
4.2 of TS 23.501 [2].
NOTE 6: The reference architecture in figure A-2 supports service based
interfaces for AMF, SMF and other NFs not represented in the figure.
NOTE 7: For untrusted non-3GPP access, UE connects to the overlay 5G network
using the untrusted non-3GPP access approach as illustrated above.
###### ## Annex B (informative): Support for differentiated charging and QoS
for UEs behind RG
For the traffic of UEs behind a RG, QoS differentiation in the RG\'s PDU
Session can be provided on a per UE\'s IPsec Child Security Association basis.
The UE\'s N3IWF/TNGF determines the IPsec child SAs as defined in clauses 4.12
and 4.12a of TS 23.502 [3] as well as the DSCP value used in the outer IP
header of that IPsec child SA. It is assumed that the same set of DSCP values
and corresponding QoS are applicable independent of whether UE-requested or
network-initiated QoS is used.
To support QoS differentiation for the UE\'s traffic, QoS mapping rules
between the RG\'s 5GC and the UE\'s 5GC are governed by an SLA (or network
configuration in case of single operator), which includes the mapping between
the DSCP marking for the IPsec child SAs and the corresponding QoS parameters
and also the N3IWF/TNGF IP address(es). The non-alteration of the DSCP field
on NWu/NWt is also governed by the SLA and by transport-level arrangements
that are outside of 3GPP scope. The SLA also governs the RG PDU session IP
addresses.
The RG\'s PCF and SMF may provide PCC rules and QoS rules for the available
mappings as determined by the SLA. The packet detection filters in the RG\'s
UPF can be based on the N3IWF/TNGF IP address and the DSCP markings on
NWu/NWt.
UE\'s SMF/PCF may use the UE\'s local IP address, which is the N6 address of
the RG\'s PDU session, to enable differentiated QoS and charging when the UE
is accessing N3IWF/TNGF via a W-5GAN.
Differentiated charging is enabled by the awareness of N3IWG/TNGF and RG PDU
Session IP addresses and also the mapping between DSCP marking and QoS
parameters included in the SLA.
#