# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document is to identify key issues, potential security and privacy
requirements and solutions with respect to enhancement for 5G multicast-
broadcast services. Specifically:
\- Study the security enhancement enabling UE\'s receiving Multicast MBS
Session data in RRC Inactive state. Analysis whether existing security
mechanisms for UE in RRC connected state can be reused or new security
enhancement are needed.
\- Study the security impact and potential enhancement if supporting feasible
and efficient resource utilization for the same broadcast content to be
provided to 5G MOCN network sharing scenarios.
\- Other security issues if identified.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 23.700-47: \"Study on architectural enhancements for 5G multicast-
broadcast services\".
[3] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[4] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[5] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC); Protocol
specification\".
[6] 3GPP TS 23.247: \"5G multicast-broadcast services; Stage 2\".
[7] 3GPP TS 33.535: \"Authentication and Key Management for Applications
(AKMA) based on 3GPP credentials in the 5G System (5GS)\".
[8] 3GPP TS 33.246: \"Security of Multimedia Broadcast/Multicast Service
(MBMS)\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
## 3.2 Symbols
Void
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
MOCN Multi-Operator Core Network
TMGI Temporary Mobile Group Identity
# 4 Assumptions
Void.
# 5 Key issues
## 5.1 Key issue#1: security handling in MOCN network sharing scenario
### 5.1.1 Key issue details
In MOCN network sharing scenario, multiple CNs are connected to the same NG-
RAN. As documented in TR 23.700-47 [2], the efficiency of resource utilization
for the same broadcast content is studied. For the same broadcast content, the
AF will set up multiple broadcast MBS sessions towards those CNs. Each CN will
deliver the same content towards the same shared NG-RAN node. The NG-RAN node
only delivers one copy of the broadcast content over the air.
As specified in clause W.4 of TS 33.501 [3], user-plane procedure is
applicable for broadcast service. MBSTF may protect the traffic transmission
with encryption and/or integrity. The security protection of MBS traffic is
supported in service layer. In MOCN network sharing scenario, the multiple CNs
may enable their own security towards the content. The UE will receive the MBS
keys from their serving PLMN. However, the NR-RAN broadcasts only one copy of
the content. The security impact needs analysis if security are activated for
the same content to be provided to 5G MOCN network sharing scenarios. For
example, UEs from PLMN1 may be unable to decipher the content if the NG-RAN
node chooses to broadcast the ciphered content from the CN of PLMN2, since the
MTK generated and distributed by the PLMN1 may be different from the MTK that
will be used by the PLMN2 to protect the MBS traffic.
If the content is protected using CN-specific keys, which is not a serving
PLMN for an UE in the shared RAN, then UEs not having the key will fail to
properly process the content, should the network send only one of the copies.
### 5.1.2 Security threats
If the content is not protected by application (in another words, CA/DRM does
not apply) then reusing the existing security procedure in service layer may
cause processing failure in UEs in MOCN network sharing scenario. The UEs will
be out of MBS if it is not served by the PLMN that is protecting the MBS
traffic, as the UE does not have the appropriate MTK (key that will be used to
protect the MBS content at the service layer) to handle the protected traffic.
### 5.1.3 Potential security requirements
The 5G system should provide the means to protect the traffic in the service
layer in MOCN network sharing scenario.
NOTE: If the content is protected by application, the security protection in
service layer is not required.
## 5.2 Key issue#2: TMGI Protection
### 5.2.1 Key issue details
According to TS 23.003 [4] and TS 38.331 [5], TMGI is defined as Temporary
Mobile Group Identity. Temporary Mobile Group Identity (TMGI) is used within
MBMS to uniquely identify Multicast and Broadcast bearer services. The TMGI is
composed of MBMS Service ID, Mobile Country Code (MCC), and Mobile Network
Code (MNC).
TMGI is used by the Core Network (CN) of MBS UEs and by MBS UEs as a temporary
identity for monitoring of the Paging channel for CN paging if configured by
upper layers for MBS multicast reception (e.g., see clause 7.2.5.2 of TS
23.247 [6]).
TMGI is a temporary identity. However, since it is being utilized for MBS
group paging and its value reused for paging different UEs, as well as being
transmitted in cleartext, the privacy attack and DoS attack may be possible.
### 5.2.2 Security threats
An attacker eavesdrop over the paging channel for MBS UEs may be capable of
the following privacy attacks:
\- inferring members of the MBS group presence in the paging area.
### 5.2.3 Potential security requirements
The 5G system may provide means to mitigate the privacy attack which infers
the members of the MBS group by group paging with TMGI.
# 6 Proposed solutions
## 6.1 Mapping of solutions to key issues
Table 6.1-1: Mapping of solutions to key issues
Solutions **KI#1** **KI#2**
* * *
#1: MBS Traffic Key distribution for MOCN deployment scenarios X  
#2: **MOCN security handling for MBS** X  
**#3: Security protection for UEs in MOCN network sharing scenario** X
## 6.2 Solution #1: MBS Traffic Key distribution for MOCN deployment scenarios
### 6.2.1 Introduction
This solution addresses Key Issue #1 to provision appropriate keys (keys that
will be used to protect the MBS content at the service layer) to the UE to
handle the protected MBS traffic over the MOCN deployment scenarios. The MBS
Traffic Key (MTK) is generated by the AF and provided to the CN NF to
distribute and use it.
The AF performs the MSK and MTK generation and provides the MSK and MTK for
all deployment scenarios (where all NG-RAN nodes are shared by PLMNs and the
scenario where only part of the NG-RAN nodes are shared by the PLMNs).
### 6.2.2 Solution details
#### 6.2.2.1 General
If the MTK is derived by the AF and provided it to the PLMNs, then all the
PLMNs of the MOCN will distribute the same MTK to all the MBS authorized UEs
it serves. Therefore the UEs in a shared RAN even if the serving PLMN are
different, will have the same MTK and UEs will be able to handle the protected
content even if it is protected by the non-serving PLMN.
The security aspects of MOCN deployment scenario to be considered as multiple
BM-SC deployment scenario detailed in clause 6.3.4 of TS 33.246 [8] for MBS
key management.
#### 6.2.2.2 Control plane procedures
Figure 6.2.2-1: MTK generation and distribution for MOCN deployment scenario
Figure 6.2.2-1 includes only the relevant steps specified in TS 23.247 [6] for
the AF to provide the MTK and to the NEF/MBSF and details of distribution of
the MTK by the NEF/MBSF for MBS traffic protection. As shown in the Figure
6.2.2-1, the steps 1 to 6 are performed for the PLMN-1 and also for the PLMN-2
for the MBS session ID.
0) The AF generates the MTK, MTK ID, MSK, MSK ID and selects the security
algorithm for the MBS session ID. It is up to the AF implementation to select
a MCC and MNC among the PLMNs for the Key Domain ID. As mentioned in clause
6.3.2.1 of TS 33.246 [8], the UE should not try to use the MCC and MNC in
another context, e.g. the UE should not compare the received MCC \|\| MNC to
parameters in radio level.
1) The AF provides the security data (MTK, MTK ID, MSK, MSK ID and selected
algorithm(s)) to the NEF/MBSF.
2-3) The MBSF includes the received security data in the multicast session
security context and provides it to the MB-SMF. The SMF obtains the multicast
session security context from the MB-SMF and provides it to the UE, as
specified in TS 33.501 [3].
4-5) The NEF/MBSF provides the received security data to the MBSTF. Upon
receiving the security data from the NEF/MBSF, the MBSTF uses the provided MTK
for MBS traffic protection, instead of deriving a MTK for the specified MBS
session ID.
6) The NEF/MBSF provides response for the received Nnef_MBSSession_Create
request.
#### 6.2.2.3 User plane procedures
The UE registers to the MBS service and receives the MBS traffic as specified
in TS 33.501 [3] with the following changes:
\- The AF provides the MSK, MSK ID, MTK and MTK ID to the MBS Security
Function (MBSSF) for the MBS session ID.
\- The MBSSF uses the provided MSK for protection of the MTK and the provided
MTK for MBS traffic protection, instead of deriving MSK and MTK for the
specified MBS session ID.
\- The MBSSF delivers the MSK, MSK ID, MTK and MTK ID received from the AF to
the UE, as specified in TS 33.501 [3] appropriately.
#### 6.2.2.4 Key update procedure
The MTK is updated based on the change of the authorization information or
based on the local policy (e.g. key lifetime expiration) as detailed in TS
33.501 [3]. In such cases, the MBSF or MB-SMF in PLMN1 triggers the MTK update
procedure by requesting the AF to provide a fresh MTK. The key update request
message includes the MBS session ID. If the AF has generated a fresh MTK, the
AF provides the fresh MTK to the NEF/MBSF in the Nnef_MBSSession_Update
request. Then the refreshed MTK is delivered to the UE as specified in TS
33.501 [3].
As both PLMN1 and PLMN2 supports MOCN, the MTK in PLMN2 should also be
updated. Therefore, the AF initiates the MTK update procedure for the PLMN2 by
sending the updated MTK to the NEF/MBSF in PLMN2, in the
Nnef_MBSSession_Update request.
If MSK needs to be updated, then the AF provides the newly generated MSK along
with the MTK and the associated MSK ID and MTK ID to the PLMNs. Then the
refreshed MSK and MTK is delivered to the UE as specified in TS 33.501 [3].
### 6.2.3 System impact
The key distribution procedure aligns with the session management procedure as
defined in TS 23.247 [6]. The only change is that the MSK and MTK are
generated by the AF and not by the MBS security function. New procedures for
MTK distribution and update between AF and MBSTF are required.
### 6.2.4 Evaluation
This solution details the security aspects of MBS for MOCN scenario using both
control plane and user plane based procedures when MBS content is protected at
the service layer. The solution is applicable for the scenarios where all NG-
RAN nodes are shared by PLMNs and the scenario where only part of the NG-RAN
nodes are shared by the PLMNs.
This solution details the distribution of the MTK key (that will be used to
protect the MBS content at the service layer) to the UE to handle the
protected MBS traffic over the MOCN deployment scenarios. The same key is
distributed by multiple PLMNs.
This solution is backwards compatible with legacy UEs.
This solution is backwards compatible with legacy NG-RAN.
## 6.3 Solution #2: **MOCN security handling for MBS**
### 6.3.1 Introduction
This solution addresses the key issue #1 \"security handling in MOCN network
sharing scenario\" from present document.
### 6.3.2 Solution details
#### 6.3.2.1 MOCN Broadcast Procedure
Figure 6.3.2.1-1: MOCN broadcast procedure
UE#1 belongs to PLMN A, UE#2 belongs to PLMN B, and UE #3 belongs to PLMN C.
And corresponding MBSTF, MB-SMF, MB-UPF are independently present for each
operator / PLMN A, B and C.
Step 1. MOCN TMGI allocation is performed by MB-SMF. TS 23.247 [6] can be
referred for normal TMGI allocation. Same procedure is followed but the TMGI
structure used is MOCN TMGI shown in this document in section 6.3.2.2.
Step 2. Separate service announcement is made for broadcast services to UE#1,
UE#2 and UE#3 by respective PLMNs.
Step 3. This step is without involving AF option. All operators use unique key
id for MOCN and derive the keys for MSK, MTK which is common for MOCN
broadcast scenario.
Step 4. Traffic protection uses common one across all operators.
Step 5. When the media stream from AF is received to each MB-UPF of PLMN A, B,
C, each MB-UPF of each PLMN will forward the media stream to MOCN RAN.
Step 6. MOCN RAN considers only one media stream content and ignores the rest
of the media stream content received from rest of the TMGI. RAN decides based
on the common MOCN TMGI ID used in media stream. Clause 6.3.2.2 describes
possible ways to arrive at a common MOCN TMGI.
Step 7. PTM transmission is made from MOCN RAN to all UE of different
operators.
#### 6.3.2.2 Common MOCN TMGI
Current Temporary Mobile Group Identity (TMGI) is used within MBMS to uniquely
identify Multicast and Broadcast bearer services. But this ID is unique to a
particular PLMN. Different PLMNs uses their own TMGI id for set of UEs belong
to them.
Considering the MOCN for broadcast usecase in 5G, TMGI can't be unique only to
one operator and it has to be common across the different PLMNs. This solution
proposes four possible ways to arrive at a common MOCN TMGI. Figure 1
illustrates these mechanisms.
Figure 6.3.2.2-1: Possible mechanisms for a common MOCN TMGI
1) MBMS service ID and default MOCN MCC and MNC configured by the operators.
Values for MCC and MNC can be reserved for MOCN usecase and used across
different operators.
2) MBMS service ID and AF ID instead of MNC, MCC. AF_ID is defined in TS
33.535 [7].
3) Addition of new field to include AF_ID with MBMS service ID and with
MCC=MNC=Zero.
4) Addition of new field to include MOCN_ID with MBMS service ID and with
MCC=MNC=Zero.
NOTE: Which of these mechanisms should be standardized is not addressed. This
can be aligned with SA2.
#### 6.3.2.3 MOCN keys MSK MTK
Considering the MOCN for broadcast usecase in 5G, common mechanisms to derive
MSK and MTK are required across the different PLMNs. This solution proposes
three possible mechanisms for MOCN key identification. This proposal considers
configurations of common fields for MOCN. For example, setting Key domain ID
to a default value for all PLMNs involved in the MOCN. Figure 2 illustrates
these proposed mechanisms.
**MOCN MSK**
1) Key domain can be set as default values or set to zero or new MOCN ID can
be introduced instead of key domain ID. Differentiation bit needs to be set to
show the difference between MOCN ID or key domain ID.MSK ID remains as before
4 bytes.
2) Key domain ID can be set to Zero or default value. MSK ID can remain as
before with 4 bytes. MOCN ID can be introduced, and range of values are
defined. For many such MOCN use cases, where different broadcast cases of RAN
sharing will be assigned a MOCN ID value. MSK ID remains as before 4 bytes.
3) Key domain ID can be set to Zero or default value. MSK ID remains as before
4 bytes. AF ID is newly introduced and assigned the FQDN of AF & security
protocol identifier. MSK ID remains as before 4 bytes.
**MOCN MTK**
1) Key domain can be set as default values or set to zero or new MOCN ID
introduced instead of key domain ID. Differentiation bit needs to be set to
show the difference between MOCN ID or key domain ID.MSK ID remains as before
4 bytes & MTK as 2 bytes.
2) Key domain ID can be set to Zero or default. MSK ID remains as before 4
bytes. MOCN ID is newly introduced, and range of values are defined. For many
such MOCN use cases, where different broadcast cases of RAN sharing will be
assigned a MOCN ID value. MSK ID remains as before 4 bytes & MTK as 2 bytes.
3) Key domain ID can be set to Zero or default. MSK ID remains as before 4
bytes. AF ID is newly introduced and assigned the FQDN of AF & security
protocol identifier. MSK ID remains as before 4 bytes & MTK as 2 bytes.
Figure 6.3.2.2-2: Possible options for MSK and MTK for MOCN
NOTE 1: Which of these mechanisms should be standardized is not addressed.
NOTE 2: How to derive the same key using common identifiers is not addressed.
NOTE 3: Need to coordinate with SA2 on proposed TMGI definition.
### 6.3.3 System impact
System impact is not provided.
### 6.3.4 Evaluation
Evaluation is not provided.
## 6.4 Solution #3: security protection for UEs in MOCN network sharing
scenario
### 6.4.1 Introduction
To address the issue, the solution proposed that MBSF/NEF needs to decide to
send one or more copies based on security activation status and indicate RAN
node. If the security in service layer is not activated, the RAN can reuse the
network resource based on the indication and send one copy to save the
overhead. Otherwise, more copies are required.
If service layer security is activated, then optimized radio resource
utilization for MBS is not used for MOCN network sharing scenario.
### 6.4.2 Solution details
{width="4.610027340332459in" height="4.0941447944007in"}
Figure 6.4.2-1: Call flow of security protection for UEs in MOCN network
sharing scenario
As shown in the Figure 6.4.2-1, the details of security protection is
summarized as following:
1\. AF performs TMGI allocation and MBS session creation as specified in
clause 7.1.1.2 or clause 7.1.1.3 of TS 23.247 [6]. The AF may include
Associated Session Identifier in this step.
2\. NEF/MBSF checks authorization of AF. In addition, NEF/MBSF confirms the
security activation status for the MBS session. The security activation status
implies whether security protection is applied or not.
If security protection is applied, then NEF/MBSF removes Associated Session
Identifier if received in step 1, which means RAN will not be able to reuse
the network resource if already existed for the same service.
3\. NEF/MBSF further provides Associated Session Identifier if applicable to
MB-SMF.
4-5. Continue the MBS session creation procedure.
6\. MB-SMF continues the broadcast MBS session creation towards the NG-RAN as
specified in TR 23.700-47 [2].
MB-SMF invokes Namf_MBSBroadcast_ContextCreate Request with further including
Associated Session Identifier (if applicable) in the N2 SM container received
in step 1.
NOTE: If pre-configured association of MBS Session ID is used, then the
security activation status can also be preconfigured. If security protection
is applied, RAN will not reuse the network resource if already existed for the
same service.
The NG-RAN node determines whether to use the previously allocated radio
resources of the MBS session based on whether Associated Session ID is
received as specified in TR 23.700-47 [2]. When the NG-RAN node receives the
DL MBS data of the requested MBS session afterwards, it will not send the
received data in the air interface if reusing the network resource. Otherwise,
the NG-RAN node treat the session as the newly request session and creates new
Broadcast MBS Session Context.
8-9. Continue the procedure as specified in TS 23.247 [6].
### 6.4.3 System impact
The procedure aligns with the broadcast session management procedure as
specified in TS 23.247 [6].
### 6.4.4 Evaluation
The solution addresses the key issue#1 in present document and provides a mean
to protect the traffic in the service layer in MOCN network sharing scenario.
To achieve this, the NEF/MBSF removes the Associated Session ID to the RAN if
security protection is applied in service layer.
# 7 Conclusions
## 7.1 Conclusion on Key Issue #1
Following conclusions are made on Key Issue #1: Security handling in MOCN
network sharing scenario:
\- If the content is protected at the application layer, then the security
protection at the service layer may not be required.
\- For MBS traffic protection at the service layer, the AF may perform the MTK
and MSK generation and provide the MTK and MSK to the MOCN participating
networks, further
\- If the network decides to use the AF provided keys, then the user-plane
procedure as in solution#1 will be used as a basis for normative work;
\- If the network decides not to use the AF provided keys, then the service
layer security without optimized radio resource utilization for MBS as
described in solution#3 will be used as a basis for normative work.
## 7.2 Conclusions to Key Issue #2
Following conclusions are made on Key Issue #2 \"TMGI Protection\":
\- It is concluded that no normative work is required for the Key Issue #2.
#