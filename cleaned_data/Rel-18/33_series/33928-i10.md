# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
# Introduction
The LI technical specifications (TS 33.126 [2], TS 33.127 [3], TS 33.128 [4])
contain the normative part of the LI requirements and the technical report TR
33.929 [5] contains additional information as an implementation guidance for
LI. The ADMF that receives the warrant information from the Law Enforcement
Agencies has the task of provisioning the LI functions present in various
Network Functions (NFs) of the serving CSP network. Upon provisioning, the LI
is activated in those NFs, and accordingly, the LI functions within those NFs
monitor the target\'s communications and provide the LI as required by the
warrant.
The scope of the NFs that provide the LI functions within the CSP network is
determined based on various factors such as LI service type, CSP deployment
choice, scope of LI as authorized in the warrant. The present document
provides the logic used within the ADMF in provisioning the LI functions
considering those points.
# 1 Scope
The present document provides ADMF provisioning logic for LI in association
with the LI functions defined in TS 33.126 [2], TS 33.127 [3] and TS 33.128
[4].
# 2 References {#references-1}
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 33.126: \"Lawful Interception Requirements\".
[3] 3GPP TS 33.127: \"Lawful Interception (LI) Architecture and Functions\".
[4] 3GPP TS 33.128: \"Lawful Interception (LI) Protocol and Procedures\".
[5] 3GPP TR 33.929: \"Lawful Interception (LI) Implementation Guidance\".
[6] ETSI TS 103 221-1: \"Lawful Interception (LI); Internal Network
Interfaces; Part 1: X1\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
None.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
# 4 ADMF and provisioning
## 4.1 Overview
According to the LI model defined in ETSI TS 103 221-1 [6], the ADMF as an
administration function establishes and manages the Lawful Interception (LI).
In doing so, the ADMF performs the target provisioning at various Network
Elements (NEs) using the X1 protocol as defined in ETSI TS 103 221-1 [6].
Within the LI architecture model defined in TS 33.127 [3] and TS 33.128 [4],
the ADMF has two sub-functions referred to as Lawful Interception Control
Function (LICF) and Lawful Interception Provisioning Function (LIPF). The LICF
receives the warrant information from the LEA over LI_HI1 interface. The LIPF
performs the provisioning of all LI functions within various NFs of CSP
network including the MDF2 and MDF3. See figure 4.1-1 below for an overview.
Figure 4.1-1: LIPF in ADMF provisioning of NEs
With respect to the LI model of ETSI 103 221-1 [6], the LIPF plays the role of
ADMF (as defined in ETSI 103 221-1 [6], and the LI functions (within the NFs)
MDF2, and MDF3 play the role of NE (as defined in ETSI 103 221-1 [6]).
The present document focuses on LIPF provisioning logic of LI functions, MDF2,
MDF3 over the LI_X1. Henceforth, the term LIPF logic is used in the present
document. See clause 5 for details of LIPF logic.
## 4.2 General
A separate box is used to represent each of the NF in which an LI function is
provisioned by the LIPF. In the illustration shown below in figure 4.2-1,
P-CSCF and MGCF are two NFs and are represented by two separate boxes.
Figure 4.2-1: Separate box for each NF that has the LI function
The LI function present within a NF and provisioned by the LIPF is represented
within the parenthesis. In the illustration shown in figure 4.2-2, the IRI-POI
in P-CSCF and IRI-POI in MGCF are provisioned by the LIPF.
Figure 4.2-2: LI function as applicable to the NF
The possible target identities that are applicable to the LI function present
in a NF are represented within another parenthesis that begin with \"Target
Id:\". In the illustration shown in figure 4.2-3, the possible target
identities for an IRI-POI in P-CSCF and IRI-POI in MGCF are PEI (IMEI only),
IMEI, IMPU and IMPI.
Figure 4.2-3: Possible target identifiers are in parentheses
Some of the flow-charts have a callout description shown next to the
provisioned box. The text within the callout description provides a hint on
the conditions that would enable the LI function to provide the interception.
When such a condition for the interception is obvious, no such call-out
description is provided. In the illustration shown in figure 4.2-4, no callout
description is given for the IRI-POI of P-CSCF implying no further clarity is
needed. The callout description for the IRI-POI in MGCF is to hint that the
IRI-POI in an MGCF is used only when an IMS session is redirected to a CS
domain (see TR 33.929 [5]).
Figure 4.2-4: Call out next to the NF describe the conditionality of
interception
The conditions given inside the call-out description are outside the scope of
LIPF logic. However, the LIPF logic is aware of the condition in an overall
scheme of things.
Most of the flow-charts have follow up tables that identify the scope of NF
domain in providing the LI functions.
In the illustration shown in table 4.2-1:
\- P-CSCF has CC-TF in a non-roaming case, has IRI-POI (for non-emergency
services only) and CC-TF in VPLMN with LBO and CC-TF (for emergency services
only) in VPLMN with HR (home-routed).
\- MGCF has CC-TF in a non-roaming case, CC-TF in HPLMN with roaming (both LBO
and HR) when an incoming session is redirected over a CS domain.
\- IMS-AGW has CC-POI when P-CSCF has the CC-TF and IM-MGW has the CC-POI
whenever the MGCF has the CC-TF.
Note that for each clause the relevant table is to be used as an aid to
understand the LIPF logic and it is outside the scope of LIPF logic. However,
the LIPF logic is aware of the condition in an overall scheme of things.
Table 4.2-1: Scope of NF domain that provide the LI functions
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN             HPLMN
P-CSCF n/a IRI-POI (NOTE 1) n/a n/a n/a P-CSCF CC-TF CC-TF n/a CC-TF (NOTE 2)
n/a IMS-AGW CC-POI CC-POI n/a CC-POI (NOTE 2) n/a MGCF (NOTE 3) CC-TF n/a CC-
TF n/a CC-TF IM-MGW (NOTE 3) CC-POI n/a CC-POI n/a CC-POI
NOTE 1: For non-emergency sessions only.
NOTE 2: For emergency sessions only.
NOTE 3: Only when an incoming session to a target is redirected over a CS
domain.
# 5 LIPF logic
## 5.1 Background
According to TS 33.126 [2] clause 6.4, the CSP is expected to only deliver
Interception Product relating to specific CSP services. In other words, the
CSP is expected to perform the interception only for the services required by
the warrant. The interception may be performed for more than one service when
required by the warrant.
NOTE: The term \"interception\" used in the present document refers to the
step that involves actual capturing and then delivery of the Intercept Product
to the LEMF.
This clause considers the following possibilities in the analysis:
\- The intended target may have subscribed to only a specific service and in
this case, by default, the interception would apply only to such service when
specified in the warrant. The CSP network would provide the interception as
and when the service is accessed by the target.
\- The intended target may have subscribed to multiple services and in this
case, the interception would have to be done based on the service type(s)
specified in the warrant as and when CSP network detects that such services
are accessed by the target.
\- A NF may be involved in providing only a particular service and in this
case, by default, the interception performed by the POI present in that NF
would apply to such service when specified in the warrant.
\- A NF may be involved in providing multiple services and in this case, the
interception performed by the POI present in that NF would have to be based on
the service type applicable to the warrant.
\- There may be multiple warrants with differing service types active on a
target, in this case, all applicable services would have to be intercepted at
the POIs, and the MDFs would have to then deliver Interception Product based
on the service type (s) applicable to the warrant.
In supporting the above scenarios, as per clause 4.4 of TS 33.128 [4], the
LIPF will have to provision the POIs, TFs and the MDF2/MDF3 according to the
CSP service type(s) applicable to a warrant.
To cover all the scenarios mentioned above, the service type may have to be
part of LI provisioning data sent to the MDFs. Whether a service type will
have to be provisioned to the POIs and TFs as an indication will depend on the
services provided by the NFs that have such POIs and TFs.
In addition to the CSP service type, a few other factors present in the
warrant may influence the LIPF logic in provisioning the POIs, TFs and
MDF2/MDF3. Few examples are:
\- Delivery type.
\- LALS triggering.
\- CSP deployment options.
\- The target type (local Vs non-local ID).
For the target non-local ID, Voice, RCS and Messaging type of services are
supported in the present document. In this case, the other party communicating
with the target non-local ID happens to access the service provided by the
CSP.
This clause illustrates the LIPF logic through a series of flow-charts in
provisioning the POIs and the TFs. The provisioning aspect of MDF2/MDF3 are
not shown unless such details provide additional clarity.
## 5.2 Governing scenarios
With respect to the interception performed within the CSP network, there are
five scenarios:
1\. The target (or party communicating with a target non-local ID) is non-
roaming.
2\. The target (or party communicating with a target non-local ID) is outbound
roaming with HR.
3\. The target (or party communicating with a target non-local ID) is outbound
roaming with LBO.
4\. The target (or party communicating with a target non-local ID) is inbound
roaming with HR.
5\. The target (or party communicating with a target non-local ID) is inbound
roaming with LBO.
Scenario 4 is also referred to as N9HR or S8HR, depending on whether the
packet core is 5GC or EPC. As indicated clause 5.1, a target can be a non-
local ID only when the service type is Voice or Messaging.
The same NF that provides an LI function may be present in one or more of the
above scenarios. The LIPF logic, even though may not be aware of the roaming
nature of a target, will have to accommodate the above five scenarios while
provisioning the LI functions.
## 5.3 Top-level LIPF provisioning logic
### 5.3.1 LIPF logic for initial configuration
The provisioning for Identity Association Caching is considered as a part of
initial configuration. Likewise, part of the S8HR/N9HR LI also requires some
initial configuration (see clause 5.5.2).
The details of initial configuration for N9HR/S8HR are illustrated in figure
5.5.2-1 (clause 5.5.2). The initial configuration of Identity Association
Caching is required if and only if the CSP has deployed the Identity
Association Caching service. Likewise, the initial configuration for N9HR/S8HR
is required if and only if the interception of voice calls for inbound roaming
targets is required in a home-routed roaming scenario.
### 5.3.2 LI provisioning logic in LIPF
When Location Acquisition service is deployed in the CSP network, a warrant
may be received to authorize Location Acquisition service for the targeted
user. This may be a standalone warrant of its own or may be tagged along with
the warrant issued to perform the service-based interception.
The details of LI provisioning logic for Location Acquisition are illustrated
in clause 5.9. The details of service-based LI provisioning logic in LIPF are
illustrated in clause 5.3.3.
### 5.3.3 Service-based LI provisioning logic in LIPF
The flow-chart in figure 5.3-1 shows a top-level logic within the LIPF to
branch off into separate processes according to the service type defined in
the present document.
Figure 5.3.3-1: Top-level view of LIPF logic in handling the service type
Based on the LI functionality defined in the present document:
\- For the service type of Data, it is assumed that the NFs in the packet core
network are involved and hence, provide the IRI and CC interception.
\- For the service type of Voice, it is assumed that the NFs in the IMS domain
are involved and hence, provide the IRI and CC interception.
\- For the service type of Messaging (that includes SMS and MMS), the NFs in
the packet core network, IMS or MMS Proxy Relay are involved and hence,
provide the IRI and CC interception. The interception of SMS has only the
IRIs. For, the service type of Messaging, the LI provisioning for the service
type RCS is also done (see below) if supported and applicable to the target.
\- For the service type of PTC, the PTC Server is involved and hence, provides
the IRI and CC interception.
\- For the service type of LALS, the LI-LCS Client provides the IRI
interception, and the CC interception does not apply to LALS.
For the service type RCS, the RCS Server, the HTTP Content Server, the File
Transfer Localization Function are involved and hence, provide the IRI and CC
interception.
When the service type \"Messaging\" is explicitly specified in a warrant, the
provisioning for the service type RCS is also performed by the LIPF, if the
latter is supported and applicable to the target. If the warrant explicitly
includes both \"Messaging\" and \"RCS\" as the service types, the LI
provisioning for the service type RCS is done only once.
The UDM and HSS are also the NFs that have the IRI-POI and the provisioning of
IRI-POI in UDM and HSS is independent of the service type indicated in the
warrant as long as the target is not indicated as a non-local ID. The
provisioning of IRI-POI in the UDM and HSS for a target identifier is done
only once.
When multiple service types are applicable for a target identifier, the LIPF
may provision the LI function in a NF only once including all the applicable
service types. Alternatively, the LIPF may determine the services that need to
be intercepted at the LI function present in a NF and then provision that LI
function for all services together.
## 5.4 Data
### 5.4.1 Scope of interception
For the service type of Data, the NFs present in the packet core network
provide the LI functions. This clause illustrates the LIPF logic for 5GC and
EPC as the two packet core networks.
The interception of service type of Data includes:
\- Delivery of IRI, or CC based on the delivery type indicated in the warrant.
\- When required, the delivery of packet data header reporting.
\- When required, the delivery of LALS reports based on the LALS triggering.
The CSP may have differing implementation options for the packet data header
reporting and LALS triggering.
In the case of EPC, the CSP may also have differing deployment options in
choosing the NFs (SGW-based Vs PGW-based) that provide the interception.
### 5.4.2 Top-level view
When the target identifier is one or more of IMSI, IMEI, MSISDN, the LI
functions in EPC are provisioned. When the target identifier is one or more
variants of SUPI, PEI, GPSI, the LI functions in 5GC are provisioned.
Figure 5.4.2-1 provides the top-level view of LIPF logic for the service type
of Data.
Figure 5.4.2-1: Top-level view of LIPF logic for the service type Data
Within figure 5.4.2-1, PEI collectively represents PEIIMEI and PEIIMEISV.
Likewise, SUPI represents SUPIIMSI and SUPINAI whereas GPSI represents
GPSIMISDN and GPSINAI.
### 5.4.3 5GC
#### 5.4.3.1 The flow-chart
Figure 5.4.3.1-1 shows the LIPF logic in provisioning the LI functions for the
5GC for the service type of Data.
Figure 5.4.3.1-1: LIPF logic for the service type Data in 5GC
For the delivery type of IRI + CC, the IRI-POIs and the CC-TFs are
provisioned. For the delivery type of IRI, the IRI-POIs and the IRI-TFs are
provisioned. For the delivery type of CC, the CC-TFs are provisioned.
Figure 5.4.3.1-2 shows the LIPF logic in provisioning the LI functions for
additional data services in 5GC.
Figure 5.4.3.1-2: LIPF logic for the additional data services in 5GC
The details of LI provisioning for AKMA, NEF based services , ECS and 5G Media
Streaming are illustrated in clause 5.4.3.3.
#### NOTE: Even though the figure 5.4.3.1-2 shows that LI provisioning for
AKMA is part of LI provisioning for the service type Data, AKMA may have to be
intercepted independently in order to support other services.5.4.3.2
Interception
##### 5.4.3.2.1 PDHR
There are two deployment options for the packet data header reporting. It is
expected that the CSP implements one of the two deployment options.
In PDHR option 1, the IRI-POI in the UPF (based on a trigger from IRI-TF
present in the SMF) generates the xIRI. Accordingly, the IRI-TFs in SMFs are
provisioned.
In PDHR option 2, the CC-POI present in the UPF (based on a trigger from CC-TF
present in the SMF) delivers the UP packets as xCC to the MDF3, which in turn,
forwards the same to the MDF2 and MDF2 would then generate the IRI messages
from the received xCC. Accordingly, the CC-TFs in SMFs, and the PDHR handling
function in MDF3 are provisioned.
##### 5.4.3.2.2 LALS triggering
There are two deployment options for LALS triggering. It is expected that the
CSP implements one of the two deployment options.
In LALS triggering option 1, the LTF present in the host NF that has the
associated IRI-POI triggers the LI-LCS Client. Accordingly, the LTFs in AMFs
and SMFs are provisioned.
In LALS triggering option 2, the LTF present in the MDF2 triggers the LI-LCS
Client. Accordingly, the LTF in MDF2 is provisioned.
##### 5.4.3.2.3 UDM
The UDM is expected to provide the IRI-POI functions in the HPLMN only.
##### 5.4.3.2.4 Summary
Table 5.4.3.2.4-1 provides the scope of NF domain that provides the IRI-
POI/CC-TF/CC-POI functions for the service type of Data in the 5GC for various
scenarios.
Table 5.4.3.2.4-1: Scope of NF domain in 5GC providing the LI functions
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN     HPLMN
UDM IRI-POI n/a IRI-POI n/a IRI-POI  
AMF IRI-POI IRI-POI n/a IRI-POI n/a  
SMF IRI-POI IRI-POI n/a IRI-POI IRI-POI  
SMF CC-TF CC-TF n/a CC-TF CC-TF  
UPF CC-POI CC-POI n/a CC-POI CC-POI  
PDHR Option 1 SMF IRI-TF IRI-TF n/a IRI-TF IRI-TF UPF IRI-POI IRI-POI n/a IRI-
POI IRI-POI Option 2 SMF CC-TF CC-TF n/a CC-TF CC-TF UPF CC-POI CC-POI n/a CC-
POI CC-POI MDF3 PDHR PDHR n/a PDHR PDHR LALS triggering Option 1 AMF LTF LTF
n/a LTF n/a SMF LTF LTF n/a LTF LTF Option 2 MDF2 LTF LTF n/a LTF LTF
NOTE 1: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NF for the indicated scenario.
NOTE 2: The LIPF is not aware of the above role played by the host NFs in
providing the LI functions.
NOTE 3: MDF2, MDF3 and LI-LCS Client which are also involved in providing the
LI functions are not shown in the tables above.
#### 5.4.3.3 LI provisioning for additional data services in 5GC
##### 5.4.3.3.1 LI provisioning for AKMA
LI provisioning for AKMA is required when there is a need to provide the
interception of encryption services between the target UE and the application
function that makes use of AKMA-provided cryptographic keys (see TS 33.128
[4]).
Figure 5.4.3.3.1-1 shows the LIPF logic for provisioning the LI functions in
AAnF for AKMA.
Figure 5.4.3.3.1-1: LI provisioning for AKMA
Within the figure, SUPI collectively represents SUPIIMSI and SUPINAI. AKMA
stands for Authentication and Key Management for Applications. AAnF is the
AKMA Anchor Function. AF is the Application Function.
The table 5.4.3.3.1-1 provides the scope of NF domain providing the LI
functions for AKMA.
Table 5.4.3.3.1-1: Scope of NF domain providing the LI functions for AKMA
NFs with the LI function LI function
* * *
AAnF IRI-POI AAnF IRI-TF AF IRI-POI
NOTE: MDF2 which is also involved in providing the LI function is not shown in
the tables above.
##### 5.4.3.3.2 LI provisioning for NEF based services
###### 5.4.3.3.2.1 Scope of interception
This clause references to the LI functions provided in the NEF. The following
is a list of 5GC services to which the LI functions are provided in the NEF:
\- NIDD using NEF.
\- Device triggering.
\- MSISDN-less SMS.
\- Parameter provisioning.
\- AF session with QoS.
The details of the above are described in TS 33.128 [4].
###### 5.4.3.3.2.2 The flow-chart
Figure 5.4.3.3.2.2-1 shows the LIPF logic for provisioning the LI functions in
NEF.
Figure 5.4.3.3.2.2-1: LI for NEF based services.
For all except the parameter provisioning, GPSI and SUPI are used as the
target identifiers. For parameter provisioning, only the GPSI is used as a
target identifier.
GPSI collectively represents GPSIMSISDN and GPSINAI. SUPI collectively
represents SUPIIMSI and SUPINAI.
###### 5.4.3.3.2.3 Interception
The CC-POI in NEF is used only for the NIDD using the NEF.
The table 5.4.3.3.2.3-1 provides the scope of LI functions provided in NEF.
Table 5.4.3.3.2.3-1: Scope of LI functions in NEF
NEF-based services NEF LI functions
* * *
NIDD using NEF IRI-POI CC-POI Device triggering IRI-POI n/a MSISDN-less SMS
IRI-POI n/a Parameter provisioning IRI-POI n/a AF session with QoS IRI-POI n/a
NOTE 1: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NEF for the indicated scenario.
NOTE 2: The LIPF is not aware of the above role played by the NEF in providing
the LI functions.
NOTE 3: MDF2 and MDF3 which are also involved in providing the LI functions
are not shown in the tables above.
##### 5.4.3.3.3 LI provisioning for Edge Computing Service
The Edge Computing Service (ECS) may be provided by the CSP or a third party
service provider. Either way, the service provider that provides the ECS will
have to provide the LI functions. EES present in the ECS provider\'s network
provides the LI functions. When CSP provides the ECS, the LI applies only when
target is non-roaming or inbound roaming. The details of this are described in
TS 33.128 [4].
Figure 5.4.3.3.3-1 shows the LIPF logic for provisioning the LI functions in
EES for ECS.
Figure 5.4.3.3.3-1: LI provisioning for ECS
Within figure 5.4.3.3.3-1, GPSI collectively represents GPSIMSISDN and
GPSINAI. The EECID (EEC Identifier) is ECS specific.
The table 5.4.3.3.3-1 provides the scope of NF domain providing the LI
functions for ECS.
Table 5.4.3.3.3-1: Scope of NF domain providing the LI functions for ECS
NF with the LI function CSP provides ECS ECS is provided by third party
provider
* * *
                                               CSP                                       ECS provider                              
                            Roaming            Roaming                                                                             
                            Not                Outbound                                  Inbound        Not   Outbound   Inbound
EES IRI-POI n/a IRI-POI n/a n/a n/a IRI-POI
NOTE 1: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the EES for the indicated scenario.
NOTE 2: The LIPF is not aware of the roaming situations of the target.
NOTE 3: MDF2 which is also involved in providing the LI function is not shown
in the tables above.
##### 5.4.3.3.4 LI provisioning for 5G Media Streaming
The AF that handles the 5G Media Streaming (5G MS) provides the LI for 5G MS.
The LI applies when a target is non-roaming or inbound roaming in the CSP
network. The details of LI for 5G MS are described in TS 33.128 [4].
Figure 5.4.3.3.4-1 shows the LIPF logic for provisioning the LI functions in
5G MS AF.
Figure 5.4.3.3.4-1: LI provisioning for 5G MS
Within the figure, GPSI collectively represents GPSIMSISDN and GPSINAI.
The table 5.4.3.3.4-1 provides the scope of NF domain providing the LI
functions for 5G MS.
Table 5.4.3.3.4-1: Scope of NF domain providing the LI functions for 5G MS
NF with the LI function Not-roaming Roaming
* * *
                                          VPLMN     HPLMN
5G MS AF IRI-POI IRI-POI n/a
NOTE 1: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the 5G MS AF for the indicated scenario.
NOTE-2: The LIPF is not aware of the roaming situation of the target.
NOTE 3: MDF2 which is also involved in providing the LI function is not shown
in the tables above.
### 5.4.4 EPC
#### 5.4.4.1 The flow-chart
Figure 5.4.4.1-1 shows the LIPF logic in determining the host NFs in EPC that
have the LI functions for the service type of Data.
Figure 5.4.4.1-1: LIPF logic for the service type Data in EPC
For the delivery type of IRI + CC, the IRI-POIs, the CC-TFs and the CC-POIs
(when EPC is deployed without CUPS) are provisioned. For the delivery type of
IRI, the IRI-POIs and the IRI-TFs (when EPC is deployed with CUPS) are
provisioned. For the delivery type of CC, the CC-TFs and the CC-POIs (when EPC
is deployed without CUPS) are provisioned.
For the LI within the EPC, the CSP may deploy either an SGW-based interception
or a PGW-based interception. The LIPF logic in supporting the two deployment
options is illustrated in figure 5.4.4.1-2.
Figure 5.4.4.1-2: Two deployment options in EPC
The LIPF includes a parameter while provisioning the SGW/SGW-C and PGW/PGW-C.
To PGW/PGW-C, with the SGW based deployment option:
\- Provide LI functions only for the targets that are outbound roaming with
HR.
SGW/SGW-C, with the PGW based deployment option:
\- Provide LI functions only for the targets that are inbound roaming with HR.
The above parameter is needed to avoid both SGW/SGW-C and PGW/PGW-C end up
performing the interceptions for the same packet data session.
Figure 5.4.4.1-3 shows the LIPF logic in provisioning the LI functions for
additional data services in EPC.
Figure 5.4.4.1-3: LIPF logic for the additional data services in EPC
The details of LI provisioning for SCEF based services are illustrated in
clause 5.4.4.3.
#### 5.4.4.2 Interception
##### 5.4.4.2.1 PDHR
There are two deployment options for the packet data header reporting. It is
expected that the CSP implements one of the two deployment options.
In PDHR option 1, the IRI-POI present in the SGW-U/PGW-U (based on a trigger
from IRI-TF present in the SGW-C/PGW-C) or the IRI-POI present in the SGW/PGW
generates the xIRI. Accordingly, the IRI-TFs in SGW-C/PGW-C and IRI-POI in
SGW/PGW are provisioned.
In PDHR option-2, the CC-POI present in the SGW-U/PGW-U (based on a trigger
from CC-TF present in the SGW-C/PGW-C) or the CC-POI present in the SGW/PGW
delivers the UP packets as xCC to the MDF3, which in turn, forward the same to
the MDF2, and MDF2 then would generate the IRI messages from the received xCC.
Accordingly, the CC-TF in SGW-C/PGW-C, CC-POI in SGW/PGW and the PDHR handling
function in MDF3 are provisioned.
##### 5.4.4.2.2 LALS triggering
There are two deployment options for LALS triggering. It is expected that the
CSP implements one of the two deployment options.
In LALS triggering option 1, the LTF present in the host NF that has the
associated IRI-POI triggers the LI-LCS client. Accordingly, the LTFs in MME,
SGW, PGW, SGW-C and PGW-C (when EPC is deployed with CUPS) are provisioned.
In LALS triggering option 2, the LTF present in the MDF2 triggers the LI-LCS
Client. Accordingly, the LTF in MDF2 is provisioned.
##### 5.4.4.2.3 SGW/PGW deployment options
For the IRI/CC generation, two deployment options are considered:
\- SGW-based.
\- PGW-based.
The CSP expected to implement one of the two options.
When SGW/SGW-C is provisioned, if the deployment option is PGW-based approach,
then the SGW/SGW-C does not perform an interception unless the target is
inbound roaming with HR. Similarly, when the PGW/PGW-C is provisioned, if the
deployment option is SGW-based approach, then the PGW/PGW does not perform the
interception unless the target is outbound roaming with HR.
##### 5.4.4.2.4 HSS
The HSS is expected to provide the IRI-POI functions in the HPLMN only.
##### 5.4.4.2.5 Summary
Table 5.4.4.2.5-1 provides the scope of NF domain that provides the IRI-
POI/CC-TF/CC-POI functions for the service type of Data in the EPC for an SGW-
based deployment option.
Table 5.4.4.2.5-1: Scope of NF domain in EPC providing the LI functions (SGW-
based deployment) NFs with LI function
                    Non-roaming   Roaming with LBO   Roaming with HR
* * *
                                  VPLMN              HPLMN             VPLMN     HPLMN
HSS IRI-POI n/a IRI-POI n/a IRI-POI  
MME IRI-POI IRI-POI n/a IRI-POI n/a  
SGW IRI-POI IRI-POI n/a IRI-POI n/a  
SGW CC-POI CC-POI n/a CC-POI n/a  
PGW n/a n/a n/a n/a IRI-POI  
PGW n/a n/a n/a n/a CC-POI  
SGW-C IRI-POI IRI-POI n/a IRI-POI n/a  
SGW-C CC-TF CC-TF n/a CC-TF n/a  
SGW-U CC-POI CC-POI n/a CC-POI n/a  
PGW-C n/a n/a n/a n/a IRI-POI  
PGW-C n/a n/a n/a n/a CC-TF  
PGW-U n/a n/a n/a n/a CC-POI  
PDHR Option 1 SGW IRI-POI IRI-POI n/a IRI-POI n/a SGW-C IRI-TF IRI-TF n/a IRI-
TF n/a SGW-U IRI-POI IRI-POI n/a IRI-POI n/a PGW n/a n/a n/a n/a IRI-POI PGW-C
n/a n/a n/a n/a IRI-TF PGW-U n/a n/a n/a n/a IRI-POI Option 2 SGW CC-POI CC-
POI n/a CC-POI n/a SGW-C CC-TF CC-TF n/a CC-TF n/a SGW-U CC-POI CC-POI n/a CC-
POI n/a PGW n/a n/a n/a n/a CC-POI PGW-C n/a n/a n/a n/a CC-TF PGW-U n/a n/a
n/a n/a CC-POI MDF3 PDHR PDHR n/a PDHR PDHR LALS triggering Option 1 SGW LTF
LTF n/a LTF n/a SGW-C LTF LTF n/a LTF n/a PGW n/a n/a n/a n/a LTF PGW-C n/a
n/a n/a n/a LTF Option 2 MDF2 LTF LTF n/a LTF LTF
Table 5.4.4.2.5-2 provides the scope of NF domain that provides the IRI-
POI/CC-TF/CC-POI functions for the service type of Data in the EPC for a PGW-
based deployment option.
Table 5.4.4.2.5-2: Scope of NF domain in EPC providing the LI functions (PGW-
based deployment)
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN     HPLMN
HSS IRI-POI n/a IRI-POI n/a IRI-POI  
MME IRI-POI IRI-POI n/a IRI-POI n/a  
SGW n/a n/a n/a IRI-POI n/a  
SGW n/a n/a n/a CC-POI n/a  
PGW IRI-POI IRI-POI n/a n/a IRI-POI  
PGW CC-POI CC-POI n/a n/a CC-POI  
SGW-C n/a n/a n/a IRI-POI n/a  
SGW-C n/a n/a n/a CC-TF n/a  
SGW-U n/a n/a n/a CC-POI n/a  
PGW-C IRI-POI IRI-POI n/a n/a IRI-POI  
PGW-C CC-TF CC-TF n/a n/a CC-TF  
PGW-U CC-POI CC-POI n/a n/a CC-POI  
PDHR Option 1 SGW n/a n/a n/a IRI-POI n/a SGW-C n/a n/a n/a IRI-TF n/a SGW-U
n/a n/a n/a IRI-POI n/a PGW IRI-POI IRI-POI n/a n/a IRI-POI PGW-C IRI-TF IRF-
TF n/a n/a IRI-TF PGW-U IRI-POI IRI-POI n/a n/a IRI-POI Option 2 SGW n/a n/a
n/a CC-POI n/a SGW-C n/a n/a n/a CC-TF n/a SGW-U n/a n/a n/a CC-POI n/a PGW
CC-POI CC-POI n/a n/a CC-POI PGW-C CC-TF CC-TF n/a n/a CC-TF PGW-U CC-POI CC-
POI n/a n/a CC-POI MDF3 PDHR PDHR n/a PDHR PDHR LALS triggering Option 1 SGW
n/a n/a n/a LTF n/a SGW-C n/a n/a n/a LTF n/a PGW LTF LTF n/a n/a LTF PGW-C
LTF LTF n/a n/a LTF Option 2 MDF2 LTF LTF n/a LTF LTF
NOTE 1: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NF for the indicated scenario.
NOTE 2: The LIPF is not aware of the above role played by the host NFs in
providing the LI functions.
NOTE 3: MDF2, MDF3 and LI-LCS Client which are also involved in providing the
LI functions are not shown in the tables above.
#### 5.4.4.3 LI provisioning for additional data services in EPC
##### 5.4.4.3.1 LI provisioning for SCEF/IWK-SCEF based services
###### 5.4.4.3.1.1 Scope of interception
This clause references to the LI functions provided in the SCEF and IWK-SCEF.
NIDD happens to be one of those services. The following is a list of EPC
services to which the LI functions are provided in the SCEF and IWK-SCEF:
\- NIDD using SCEF.
\- Device triggering.
\- MSISDN-less SMS.
\- Parameter provisioning.
\- AS session with QoS.
The details of the above are described in TS 33.128 [4].
###### 5.4.4.3.1.2 The flow-chart
Figure 5.4.4.3.1.2-1 shows the LIPF logic for provisioning the LI functions in
SCEF/IWK-SCEF.
Figure 5.4.4.3.1.2-1: LIPF logic for provisioning the LI functions in
SCEF/IWK-SCEF
For all except the parameter provisioning, MSISDN, IMSI and External
Identifier are used as the target identifiers. For parameter provisioning,
only the MSISDN and the External Identifier are used as a target identifier.
###### 5.4.4.3.1.3 Interception
The LI functions in the SCEF are provided in a non-roaming case and in the
HPLMN for a roaming case. The LI functions in the IWK-SCEF are provided in the
VPLMN for a roaming case.
The CC-POI in SCEF and IWK-SCEF is used only for the NIDD using the SCEF.
The table 5.4.4.3.1.3-1 provides the scope of LI functions provided in SCEF
and IWK-SCEF.
Table 5.4.4.3.1.3-1: Scope of LI functions in SCEF
SCEF based services NFs with LI functions
* * *
                           Non-roaming             Roaming                                 
                           SCEF                    IWK-SCEF   VPLMN   HPLMN                
                                                              SCEF    IWK-SCEF   SCEF      IWK-SCEF
NIDD using SCEF IR-POI n/a n/a IRI-POI IRI-POI n/a CC-POI n/a n/a CC-POI CC-
POI n/a Device triggering IR-POI n/a n/a IRI-POI IRI-POI n/a MSISDN-less SMS
IR-POI n/a n/a IRI-POI IRI-POI n/a Parameter provisioning IR-POI n/a n/a IRI-
POI IRI-POI n/a AS session with QoS IR-POI n/a n/a IRI-POI IRI-POI n/a
NOTE 1: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NFs for the indicated scenario.
NOTE 2: The LIPF is not aware of the above role played by the SCEF or IWK-SCEF
in providing the LI functions and not the roaming situations of the target.
NOTE 3: MDF2 and MDF3 which are also involved in providing the LI functions
are not shown in the tables above.
## 5.5 Voice
### 5.5.1 Scope of interception
For the service type of Voice, the NFs present in IMS domain provide the LI
functions except for the case of inbound roaming targets with home routed
roaming architecture.
A target can be a subscriber of the CSP, an inbound roamer or a non-local ID.
In the case where a target is a non-local ID, the party communicating with the
target can be non-roaming, inbound roamer or outbound roamer. When a target is
non-local ID, provisioning of HSS and LTF are not applicable.
The interception of service type of Voice includes:
\- Delivery of IRI, or CC based on the delivery type indicated in the warrant.
\- When required, the delivery of LALS reports based on the LALS triggering.
\- Whether a target is non-local ID.
\- IMS services such as redirection, conferencing, application of media such
as music or announcements.
The CSP may have differing implementation options for the interception of IRI
and CC, for local as well as non-local ID targets. The CSP may also have
differing implementation options for LALS triggering.
The CSP may have either an LBO based roaming architecture or a home-routed
based roaming architecture.
### 5.5.2 Initial configuration for N9HR/S8HR
To support the N9HR/S8HR (i.e. scenario 4 listed in clause 5.2), the LIPF will
have to configure the BBIFF/BBIFF-C present in the packet core network. This
applies to all inbound roaming users using the IMS service.
Figure 5.5.2-1 provides the LIPF logic for N9HR/S8HR that is applicable to all
inbounding roaming users using IMS services.
Figure 5.5.2-1: LIPF logic for initial configuration for N9HR/S8HR
When the packet core network is 5GC, the BBIFF-C function is provided by the
SMF and when the packet core network is EPC, the BBIFF-C/BBIFF function is
provided by the SGW-C/SGW.
### 5.5.3 Top level LIPF logic for service type voice
When a target ID is an IMPU, the warrant may specify whether a target is non-
local ID. The host NFs that provide the LI functions when the target is non-
local ID can be different from the host NFs that provide the LI functions when
the target is not a non-local ID. The provisioning of IRI-POI in HSS and
provisioning of LTF in support of LALS triggering applies only when the target
is not a non-local ID.
Figure 5.5.3-1 provides the top-level view of LIPF logic for the service type
of Voice.
Figure 5.5.3-1: Top level view of LIPF logic for service type of Voice
Within figure 5.5.3-1, PEI (IMEI only) represents PEIIMEI. The target identity
in the IMPI format may contain a value derived from a SUPI or an IMSI. The
target identity in the IMPU format containing a SIP URI or TEL URI may contain
a value derived from a GPSI, MSISDN, an E.164 number, or IMSI. Only IMPU is
used for target non-local ID.
The LMISF-IRI is provisioned to support the interception of inbound roaming
target (or party communicating with a target non-local ID target is inbound
roaming) with HR that uses IMS services. The LMISF-IRI is expected to provide
the LI functions only for non-emergency services.
### 5.5.4 LIPF logic for targets that are not non-local ID
#### 5.5.4.1 The flowchart
Figures 5.5.4.1-1, 5.5.4.1-2, 5.5.4.1-3 and 5.5.4.1-4 show the LIPF logic for
the service type of Voice when the target is not a non-local ID.
Figure 5.5.4.1-1: Top level LIPF logic for service type of Voice when target
is not a non-local ID
For the delivery type of IRI + CC, the IRI-POIs and the CC-TFs are
provisioned. For the delivery type of IRI, the IRI-POIs are provisioned. For
the delivery type of CC, the CC-TFs are provisioned.
Figure 5.5.4.1-2 shows the LIPF logic for the provisioning of IRI-POIs and
figure 5.5.4.1-3 shows the LIPF logic for the provisioning of CC-TFs.
Figure 5.5.4.1-2: LIPF logic for delivery type of IRI for service type of
Voice when target is not a non-local ID
The S-CSCF, E-CSCF, P-CSCF, IBCF, MGCF and AS (in figure 5.5.4.1-2) provide
IRI-POI functions under certain conditions as noted within the illustration.
To prevent those IRI-POIs from providing the LI functions when not supposed
to, the LIPF may have to include a parameter during the provisioning. If
STIR/SHAKEN is required to be intercepted in the network, then the
provisioning of IRI-POIs in IBCF and AS include the parameter
ReportDiversionPASSporTInfo if the target identity is IMPU. Additional
STIR/SHAKEN related provisioning is illustrated in figure 5.5.4.1-5.
Figure 5.5.4.1-3: LIPF logic for delivery type of CC for service type of Voice
when target is not a non-local ID
The IBCF, MGCF and AS (in figure 5.5.4.1-3) provide CC-TF functions under
certain conditions as noted within the illustration. To prevent those CC-TFs
from triggering the CC-POIs when not supposed to, the LIPF may have to include
a parameter during the provisioning.
Figure 5.5.4.1-4 illustrates the LIPF logic for LALS triggering.
Figure 5.5.4.1-4: LIPF logic for LALS triggering for the service type of Voice
In LALS triggering option 1, the host NF that provides the LTF is same as the
NF that provides the IRI-POI functions. And therefore, the host NFs that
provide the LTF can be different based on the IMS deployment options.
The P-CSCF, IBCF and LMISF-IRI (in figure 5.5.4.1-4) provide LTF under certain
conditions as noted within the illustration. Under special scenario, the
S-CSCF may provide the IRI-POI for emergency services (instead of E-CSCF) as
specified in TS 33.127 [3]. To prevent those LTFs from providing the LI
functions when not supposed to, the LIPF may have to include a parameter
during the provisioning.
Figure 5.5.4.1-5 illustrates the LIPF logic for additional STIR/SHAKEN related
provisioning.
Figure 5.5.4.1-5: LIPF logic for additional STIR/SHAKEN related provisioning
For STIR/SHAKEN related reporting, IBCF, AS, P-CSCF (VPLMN with LBO), LMISF-
IRI (VPLMN with HR) provide the IRI-POI functions. The LIPF logic shown in
figure 5.5.4.1-5 is additional logic required to support the LI for
STIR/SHAKEN.
As illustrated in figure 5.5.4.1-2, the IRI-POIs in P-CSCF, LMISF-IRI and AS
are provisioned as part IMS-based voice LI. Likewise, the IRI-POI in IBCF is
also provisioned for IMS-based voice LI when the alternate option is used.
When the STIR/SHAKEN is required to be intercepted in the network, the IRI-
POIs in IBCF and AS are to be provisioned with ReportDiversionPASSporTInfo
value when the target identity is IMPU.
#### 5.5.4.2 Interception
##### 5.5.4.2.1 IMS deployment
There are two deployment options for IMS for intercepting the service type of
Voice (TS 33.127 [3]):
\- Default.
\- Alternate option.
It is expected that the CSP implements one of the two deployment options.
The conditions under which IRI-POI or CC-TF functions have to provisioned are
illustrated within the drawing and are further clarified in table 5.5.4.2.3-1
and 5.5.4.2.3-2.
##### 5.5.4.2.2 LALS triggering
There are two deployment options for LALS triggering. It is expected that the
CSP implements one of the two deployment options.
In LALS triggering option 1, the LTF present in the host NF that has the
associated IRI-POI triggers the LI-LCS Client. In LALS triggering option 2,
the LTF presents in the MDF2 triggers the LI-LCS Client.
##### 5.5.4.2.3 Summary
Table 5.5.4.2.3-1 provides the scope of NF domain that provides the IRI-
POI/CC-TF/CC-POI functions for the service type of Voice with the IMS
deployment option Default.
Table 5.5.4.2.3-1: Scope of NF domain in IMS providing the LI functions with
Default option
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN             HPLMN
HSS IRI-POI n/a IRI-POI n/a IRI-POI  
AS (NOTE 6, NOTE 12) IRI-POI n/a IRI-POI n/a IRI-POI  
AS (NOTE 7) CC-TF n/a CC-TF n/a CC-TF  
MRFP (NOTE 7) CC-POI n/a CC-POI n/a CC-POI  
S-CSCF (NOTE 8) IRI-POI n/a IRI-POI n/a IRI-POI  
E-CSCF (NOTE 8) IRI-POI IRI-POI n/a IRI-POI n/a  
P-CSCF n/a IRI-POI (NOTE 1) n/a n/a n/a  
P-CSCF CC-TF CC-TF n/a CC-TF (NOTE 2) n/a  
IMS-AGW CC-POI CC-POI n/a CC-POI (NOTE 2) n/a  
MGCF (NOTE 3) CC-TF n/a CC-TF n/a CC-TF  
IM-MGW (NOTE 3) CC-POI n/a CC-POI n/a CC-POI  
IBCF (NOTE 14) IRI-POI IRI-POI IRI-POI IRI-POI IRI-POI  
IBCF (NOTE 4) CC-TF n/a CC-TF n/a CC-TF  
TrGW (NOTE 4) CC-POI n/a CC-POI n/a CC-POI  
LMISF-IRI (NOTE 1) n/a n/a n/a IRI-POI n/a  
LMISF-CC (NOTE 1) n/a n/a n/a CC-POI n/a  
LALS triggering Option 1 S-CSCF LTF n/a LTF n/a LTF E-CSCF LTF LTF n/a LTF n/a
P-CSCF n/a LTF (NOTE 1) n/a n/a n/a LMISF-IRI n/a n/a n/a LTF (NOTE 1) n/a
Option 2 MDF2 LTF LTF LTF LTF LTF
Table 5.5.4.2.3-2 provides the scope of NF domain that provides the IRI-
POI/CC-TF/CC-POI functions for the service type of Voice with the IMS
deployment option Alternate option.
Table 5.5.4.2.3-2: Scope of NF domain in IMS providing the LI functions with
Alternate option
* * *
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN              HPLMN
HSS IRI-POI n/a IRI-POI n/a IRI-POI
AS (NOTE 6, NOTE 12) IRI-POI n/a IRI-POI n/a IRI-POI
AS (NOTE 7) CC-TF n/a CC-TF n/a CC-TF
MRFP (NOTE 7) CC-POI n/a CC-POI n/a CC-POI
P-CSCF IRI-POI IRI-POI n/a IRI-POI (NOTE 2) IRI-POI
P-CSCF CC-TF CC-TF n/a CC-TF (NOTE 2) CC-TF
IMS-AGW CC-POI CC-POI n/a CC-POI (NOTE 2) CC-POI
MGCF (NOTE 3) IRI-POI n/a IRI-POI n/a IRI-POI
MGCF (NOTE 3) CC-TF n/a CC-TF n/a CC-TF
IM-MGW (NOTE 3) CC-POI n/a CC-POI n/a CC-POI
IBCF IRI-POI\ IRI-POI\ IRI-POI\ IRI-POI\ IRI-POI\  
(NOTE 13) (NOTE 2, 14) (NOTE 13) (NOTE 2, 14) (NOTE 13)
IBCF (NOTE 4) CC-TF n/a CC-TF n/a CC-TF
TrGW (NOTE4) CC-POI n/a CC-POI n/a CC-POI
LMISF-IRI (NOTE 1) n/a n/a n/a IRI-POI n/a
LMISF-CC (NOTE 1) n/a n/a n/a CC-POI n/a
LALS Triggering Option 1 P-CSCF LTF LTF n/a LTF (NOTE 2) LTF
                                       IBCF               n/a               n/a                LTF (NOTE 5)   n/a            n/a
                                       LMISF-IRI          n/a               n/a                n/a            LTF (NOTE 1)   n/a
                         Option 2      MDF2               LTF               LTF                LTF            LTF            LTF
* * *
NOTE 1: For non-emergency sessions only.
NOTE 2: For emergency sessions only.
NOTE 3: Only when an incoming session to a target is redirected over a CS
domain.
NOTE 4: Only when target is outbound roaming or when an incoming session to a
target is redirected over an IP domain, or to an outbound roaming party with
LBO.
NOTE 5: Only when the target is outbound roaming without a redirection.
NOTE 6: When the interception of conferencing services is required.
NOTE 7: When the content interception of conferencing, or application of
music/ is required.
NOTE 8: For IMS emergency sessions in fixed networks when the S-CSCF is on the
signalling path, S-CSCF may optionally (instead of E-CSCF) provide the IRI-POI
functions with the default option.
NOTE 9: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NF for the indicated scenario.
NOTE 10: The LIPF is not aware of the above role played by the host NFs in
providing the LI functions.
NOTE 11: MDF2, MDF3 and LI-LCS Client which are also involved in providing the
LI functions are not shown in the tables above.
NOTE 12: When the interception of STIR/SHAKEN is required.
NOTE 13: Only when target is outbound roaming or when an incoming session to a
target is redirected over an IP domain, or to an outbound roaming party with
LBO, or when the interception of STIR/SHAKEN is required.
NOTE 14: Only when the interception of STIR/SHAKEN is required.
##### 5.5.4.2.4 STIR/SHAKEN
Since the IRI-POI in AS, in support of LI for special services such as
conferencing, is always provisioned, the LIPF logic has to ensure that when
the STIR/SHAKEN is required to be intercepted and the target Id is IMPU, the
ReportDiversionPASSporTInfo is included as part of that provisioning.
Likewise, the IRI-POI in IBCF is also provisioned except for the case when the
default option for IMS LI is deployed. The diagram shown in figure 5.5.4.1-5
illustrates that when STIR/SHAKEN is required to be intercepted and the target
Id is IMPU, the IRI-POI in IBCF is provisioned even with the default option of
IMS LI with ReportDiversionPASSporTInfo is included.
In general, when the STIR/SHAKEN is required to be intercepted in the network,
and the target Id is IMPU, the IRI-POIs in AS and the IBCF are provisioned
with ReportDiversionPASSporTInfo parameter included.
The diagram shown in figure 5.5.4.2.4-1 below illustrates the LI provisioning
just from STIR/SHAKEN perspective. However, from an overall provisioning
perspective, it is embedded within the LIPF logic of IMS LI provisioning as
illustrated in clause 5.5.4.1.
Figure 5.5.4.2.4-1: Localized LI provisioning view from STIR/SHAKEN
perspective
The inclusion of ReportDiversionPASSporTInfo for provisioning of IRI-POI in
P-CSCF and LMISF-IRI is not required.
Table 5.5.4.2.4-1 shows the NFs that will have to provide the STIR/SHAKEN LI
(signing) for various scenarios and table 5.5.4.2.4-2 shows the NFs that will
have to provide the STIR/SHAKEN LI (verification) for various scenarios.
The signing for STIR/SHAKEN happens in the HPLMN except for the emergency
sessions it can also happen in the VPLMN. In these tables the indicated
scenarios are from the perspective of target.
Table 5.5.4.2.4-1: Scope of NF domain in IMS providing the LI functions for
STIR/SHAKEN (signing)
Scenario HPLMN VPLMN
* * *
                                                        CSP choice AS       CSP choice is IBCF
Emergency call IBCF IBCF IBCF  
RCD present AS AS n/a  
Intra-CSP session signing/verification required AS AS n/a  
Intra-CSP session signing/verification not required Intra-CSP session n/a n/a
n/a Inter-CSP session AS IBCF n/a
Table 5.5.4.2.4-2: Scope of NF domain in IMS providing the LI functions for
STIR/SHAKEN (verification)
Scenario HPLMN VPLMN
* * *
                                                        CSP choice AS       CSP choice is IBCF
Emergency callback AS IBCF See NOTE 1  
Inbound roaming with LBO n/a n/a P-CSCF  
Inbound roaming with Home-Routed n/a n/a LMISF-IRI  
Intra-CSP session signing/verification required AS AS See NOTE 1  
Intra-CSP session signing/verification not required Intra-CSP session AS (see
NOTE 2) AS (see NOTE 2) See NOTE 1 Inter-CSP session AS IBCF (see NOTE 3) See
NOTE 1
NOTE 1: Same as in the row for inbound roaming (LBO) and inbound roaming (HR).
NOTE 2: This is the case where the redirection happens with the outgoing SIP
INVITE containing the validation result and the REQUEST URI is a target
identity (see TS 33.128 [4], clause 7.11.2.3). The AS may or may not interact
with the Verification AS.
NOTE 3: The IRI-POI is in IBCF. The IRI-POI can be in AS for the special
redirection case depicted in NOTE 2 (see TS 33.128 [4], clause 7.11.2.3).
The indicated CSP choice is applicable when the signing/verification of only
inter-CSP session is required. The CSP choice for signing and verification
need not be the same.
### 5.5.5 LIPF logic for targets that are non-local ID
#### 5.5.5.1 The flowchart
Figures 5.5.5.1-1, 5.5.5.1-2 and 5.5.5.1-3 show the LIPF logic for the service
type of Voice when the target is a non-local ID.
Figure 5.5.5.1-1: LIPF logic for service type of Voice when target is a non-
local ID
For the delivery type of IRI + CC, the IRI-POIs and the CC-TFs are
provisioned. For the delivery type of IRI, the IRI-POIs are provisioned. For
the delivery type of CC, the CC-TFs are provisioned.
Figure 5.5.5.1-2 shows the LIPF logic for the provisioning of IRI-POIs and
figure 5.5.5.1-3 shows the LIPF logic for the provisioning of CC-TFs.
Figure 5.5.5.1-2: LIPF logic for delivery type of IRI for service type of
Voice when target is a non-local ID
The P-CSCF, IBCF and MGCF (in figure 5.5.5.1-2) provide IRI-POI functions
under certain conditions as noted within the illustration. To prevent those
IRI-POIs from providing the LI functions when not supposed to, the LIPF may
have to include a parameter during the provisioning.
If STIR/SHAKEN is required to be intercepted in the network, the provisioning
of IRI-POI in IBCF include the parameter ReportDiversionPASSporTInfo.
Additional STIR/SHAKEN related provisioning for target non-local ID is
illustrated in figure 5.5.5.1-4.
Figure 5.5.5.1-3: LIPF logic for delivery type of CC for service type of Voice
when target is a non-local ID
The P-CSCF, IBCF and MGCF (in figure 5.5.5.1-3) provide CC-TF functions under
certain conditions as noted within the illustration. To prevent those CC-TFs
from triggering the CC-POI when not supposed to, the LIPF may have to include
a parameter during the provisioning.
Figure 5.5.5.1-4 illustrates the LIPF logic for additional STIR/SHAKEN related
provisioning for target non-local ID.
Figure 5.5.5.1-4: LIPF logic for additional STIR/SHAKEN related provisioning
for target non-local ID
For STIR/SHAKEN related reporting IBCF, AS, P-CSCF (VPLMN with LBO), LMISF-
IRI-POI (VPLMN with HR) provide the IRI-POI functions. The LIPF logic shown in
figure 5.5.5.1-4 is additional logic required to support the STIR/SHAKEN when
the target is non-local ID.
As illustrated in figure 5.5.5.1-2, the IRI-POIs in P-CSCF, LMISF-IRI are
provisioned as part IMS-based voice LI. Likewise, the IRI-POI in IBCF is also
provisioned for IMS-based voice LI when default option is used in HPLMN, or
when alternate options are used in both HPLMN and VPLMN.
When the interception of STIR/SHAKEN is required in the network, the IRI-POIs
in IBCF and AS are to be provisioned with ReportDiversionPASSporTInfo value.
#### 5.5.5.2 Interception
##### 5.5.5.2.1 IMS deployment
There are two deployment options for IMS for intercepting the service type of
Voice (TS 33.127 [3]):
\- Default.
\- Alternate option.
It is expected that the CSP implements one of the two deployment options.
The conditions under which IRI-POI or CC-TF functions have to provided are
illustrated within the drawing and are further clarified in tables 5.5.5.2.2-1
and 5.5.5.2.2-2. The LIPF may have to indicate to the IRI-POI and CC-TF the
condition in which they have to provide the respective functions.
##### 5.5.5.2.2 Summary
Table 5.5.5.2.2-1 provides the scope of NF domain that provides the IRI-
POI/CC-TF/CC-POI functions for the service type of Voice with the IMS
deployment option Default in HPLMN.
Table 5.5.5.2.2-1: Scope of NF domain in IMS providing the LI functions with
Default in HPLMN
NF with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                      VPLMN              HPLMN             VPLMN     HPLMN             
                                      Default            Alternate
P-CSCF n/a IRI-POI n/a n/a n/a n/a P-CSCF n/a CC-TF n/a n/a n/a n/a IMS-AGW
n/a CC-POI n/a n/a n/a n/a AS (NOTE 5) IRI-POI n/a n/a IRI-POI n/a IRI-POI
MGCF IRI-POI n/a n/a IRI-POI n/a IRI-POI MGCF CC-TF n/a n/a CC-TF n/a CC-TF
IM-MGW CC-POI n/a n/a CC-POI n/a CC-POI IBCF IRI-POI IRI-POI (NOTE 5) IRI-POI
IRI-POI IRI-POI (NOTE5) IRI-POI IBCF CC-TF n/a CC-TF CC-TF n/a CC-TF TrGW CC-
POI n/a CC-POI CC-POI n/a CC-POI LMISF-IRI n/a n/a n/a n/a IRI-POI n/a LMISF-
CC n/a n/a n/a n/a CC-POI n/a
Table 5.5.5.2.2-2 provides the scope of NF domain that provides the IRI-
POI/CC-TF/CC-POI functions for the service type of Voice with the IMS
deployment option Alternate option in HPLMN.
Table 5.5.5.2.2-2: Scope of NF domain in IMS providing the LI functions with
Alternate option in HPLMN
NF with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                      VPLMN              HPLMN             VPLMN     HPLMN     
                                      Default            Alternate
P-CSCF n/a IRI-POI n/a n/a n/a n/a P-CSCF n/a CC-TF n/a n/a n/a n/a IMS-AGW
n/a CC-POI n/a n/a n/a n/a AS (NOTE 5) IRI-POI n/a n/a IRI-POI n/a IRI-POI
S-CSCF IRI-POI n/a n/a IRI-POI n/a IRI-POI MGCF CC-TF n/a n/a CC-TF n/a CC-TF
IM-MGW CC-POI n/a n/a CC-POI n/a CC-POI IBCF (NOTE 5) IRI-POI IRI-POI IRI-POI
IRI-POI IRI-POI I-IRI-POI IBCF CC-TF n/a CC-TF CC-TF n/a CC-TF TrGW CC-POI n/a
CC-POI CC-POI n/a CC-POI LMISF-IRI n/a n/a n/a n/a IRI-POI n/a LMISF-CC n/a
n/a n/a n/a CC-POI n/a
NOTE 1: In tables 5.5.5.2.2-1 and 5.5.5.2.2-2, the use of the phrase non-
roaming/roaming applies to the party communicating with the target non-local
ID.
NOTE 2: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NF for the indicated scenario.
NOTE 3: The LIPF is not aware of the above role played by the host NFs in
providing the LI functions.
NOTE 4: MDF2, MDF3 and LI-LCS Client which are also involved in providing the
LI functions are not shown in the tables above.
NOTE 5: Only when the interception of STIR/SHAKEN is required.
##### 5.5.5.2.3 STIR/SHAKEN
When the target is non-local ID, the IRI-POI in AS is not provisioned for IMS-
LI. The IRI-POI in IBCF is provisioned except for the case where the alternate
option is deployed in the HPLMN for IMS LI (target non-local ID) and default
option is used for IMS-LI in the VPLMN (target non-local ID).
The diagram shown in figure 5.5.4.2.4-4 illustrates that when the interception
of STIR/SHAKEN is required in the network, and the target Id is IMPU, and the
target is non-local ID, the IBCF is provisioned even when the alternate option
for IMS LI is used in the HPLMN and default option is used for IMS LI in the
VPLMN.
The diagram shown in figure 5.5.4.1-5 (clause 5.5.4.1) illustrates the LI
provisioning just from STIR/SHAKEN perspective. However, from an overall
provisioning perspective for target non-local ID, it is embedded within the
LIPF logic of IMS LI provisioning as illustrated in clause 5.5.5.1.
Table 5.5.5.2.3-1 shows the NFs that will have to provide the STIR/SHAKEN LI
(signing) for various scenarios and table 5.5.5.2.3-2 shows the NFs that will
have to provide the STIR/SHAKEN LI (verification) for various scenarios.
The signing for STIR/SHAKEN happens in the HPLMN. In these tables the
indicated scenarios are from the perspective of the party communicating with
the target non-local ID.
Table 5.5.5.2.3-1: Scope of NF domain in IMS providing the LI functions for
STIR/SHAKEN (signing)
Scenario CSP choice AS CSP choice is IBCF
* * *
RCD present AS AS  
Intra-CSP session n/a n/a  
Inter-CSP session Intra-CSP session signing/verification is required AS AS
Intra-CSP session signing/verification not required AS IBCF
Table 5.5.5.2.3-2: Scope of NF domain in IMS providing the LI functions for
STIR/SHAKEN (verification)
Scenario HPLMN VPLMN
* * *
                                     CSP choice AS                                         CSP choice is IBCF   Default     Alternate
Inbound roaming with LBO n/a n/a P-CSCF IBCF  
Inbound roaming with Home-Routed n/a n/a LMISF-IRI LMISF-IRI  
Intra-CSP session n/a n/a n/a n/a  
Inter-CSP session Intra-CSP session signing/verification is required AS AS See
NOTE See NOTE Intra-CSP session signing/verification not required AS IBCF See
NOTE See NOTE
NOTE: Same as in the rows for inbound roaming (LBO) and inbound roaming (HR).
The indicated CSP choice is applicable when the signing/verification of only
inter-CSP session is required. The CSP choice for signing and verification
need not be the same.
## 5.6 Messaging
### 5.6.1 Scope of interception
The illustrations shown in this clause for the service type Messaging
includes:
\- MMS.
\- SMS.
The interception for the MMS is done by the IRI-POI and CC-POI present in the
MMS Proxy Relay. The interception for the SMS is done by the IRI-POI present
in the SMSF and the MME (when MME provides the SMS service) and the IMS domain
for SMS over IMS.
A target can be a subscriber of the CSP, an inbound roamer or a non-local ID.
In the case where a target is a non-local ID, the party communicating with the
target can be non-roaming, inbound roamer or outbound roamer. When a target is
non-local ID, provisioning of HSS and LTF are not applicable.
For N9HR/S8HR, the LI functions for the inbound roamers are provided in the
LMISF-IRI. To support the interception in LMISF-IRI, the initial configuration
for N9HR/S8HR will have to be done as illustrated in clause 5.5.2.
The interception of service type of Messaging includes:
\- Delivery of IRI or CC based on the delivery type indicated in the warrant
(the delivery of CC is applicable to MMS only).
\- Whether a target is non-local ID.
\- When required, the delivery of LALS reports based on the LALS triggering
(applicable to SMS only).
In view of SMS over IMS, the CSP may have either an LBO based roaming
architecture or a home-routed based roaming architecture. The CSP may have
differing implementation options for LALS triggering.
Table 5.6.1-1 shows the target identities that are applicable to different
type of SMS use.
Table 5.6.1-1: Target IDs as applicable to the interception of service type
Messaging
+-------+-------+-------+-------+-------+-------+-------+------+------+ | SMS | GPSI | SUPI | PEI | M | IMSI | IMEI | IMPU | IMPI | | m | | | | SISDN | | | | | | ethod | | | | | | | | | +=======+=======+=======+=======+=======+=======+=======+======+======+ | MMS | YES | n/a | n/a | YES | n/a | n/a | n/a | n/a | +-------+-------+-------+-------+-------+-------+-------+------+------+ | MMS | YES | n/a | n/a | YES | n/a | n/a | n/a | n/a | | (t | | | | | | | | | | arget | | | | | | | | | | non- | | | | | | | | | | local | | | | | | | | | | ID) | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+------+ | SMS | YES | As | As | YES | As | YES | YES | YES | | over | | IMPI | IMEI | ( | IMPI | | | | | IMS | ( | | | NOTE) | | | | | | (l | NOTE) | | | | | | | | | ocal) | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+------+ | SMS | YES | n/a | n/a | YES | n/a | n/a | YES | n/a | | over | | | | | | | | | | IMS | | | | | | | | | | (non- | | | | | | | | | | local | | | | | | | | | | ID) | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+------+ | SMS | YES | YES | YES | As | As | As | n/a | n/a | | over | | | | GPSI | SUPI | PEI | | | | 5GS | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+------+ | SMS | YES | n/a | n/a | As | n/a | n/a | n/a | n/a | | over | | | | GPSI | | | | | | 5GS | | | | | | | | | | (t | | | | | | | | | | arget | | | | | | | | | | non- | | | | | | | | | | local | | | | | | | | | | ID) | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+------+ | SMS | n/a | n/a | n/a | YES | YES | YES | n/a | n/a | | over | | | | | | | | | | EPS | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+------+ | SMS | n/a | n/a | n/a | YES | n/a | n/a | n/a | n/a | | over | | | | | | | | | | EPS | | | | | | | | | | (t | | | | | | | | | | arget | | | | | | | | | | non- | | | | | | | | | | local | | | | | | | | | | ID) | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+------+
The target identity PEI collectively represents PEIIMEI and PEIIMEISV.
Likewise, SUPI represents SUPIIMSI and SUPINAI whereas GPSI represents
GPSIMISDN and GPSINAI. The target identity in the IMPI format may contain a
value derived from a SUPI or an IMSI. The target identity in the IMPU format
containing a SIP URI or TEL URI may contain a value derived from a GPSI,
MSISDN, an E.164 number, or IMSI.
NOTE: The GPSI and MSISDN may also be the target IDs as an IMPU.
A part of LIPF logic is based on the target identity applicability shown in
table 5.6.1-1.
### 5.6.2 LIPF logic for service type messaging
#### 5.6.2.1 Flowcharts
Figure 5.6.2.1-1 provides the top-level view of LIPF logic for the service
type of Messaging.
Figure 5.6.2.1-1: Top-level view of LIPF logic for service type of Messaging
The IRI-POI in HSS, UDM and LMISF-IRI are provisioned only when a target is
not a non-local ID.
Figure 5.6.2.1-2 shows the LIPF logic for service type Messaging with SMS over
IMS.
Figure 5.6.2.1-2: LIPF logic for service type of Messaging for SMS over IMS
The P-CSCF (in figure 5.6.2.1-2) provides IRI-POI functions under certain
conditions as noted within the illustration. To prevent the IRI-POI in P-CSCF
from providing the LI functions when not supposed to, the LIPF may have to
include a parameter during the provisioning.
Figure 5.6.2.1-3 shows the LIPF logic for LALS triggering with service type of
Messaging.
Figure 5.6.2.1-3: LIPF logic for LALS triggering for the service type of
Messaging
The P-CSCF (in figure 5.6.2.1-3) provides LTF functions under certain
conditions as noted within the illustration. To prevent LTF in P-CSCF from
providing the LI functions when not supposed to, the LIPF may have to include
a parameter during the provisioning.
#### 5.6.2.2 Interception
##### 5.6.2.2.1 IMS deployment
There are two deployment options for IMS for intercepting the service type of
Messaging for SMS over IMS:
\- Default.
\- Alternate option.
It is expected that the CSP implements one of the two deployment options.
The conditions under which IRI-POI functions have to be provisioned are
illustrated within the drawing and are further clarified in tables from
5.6.2.2.3-2 to 5.6.2.2.3-5.
##### 5.6.2.2.2 LALS triggering
There are two deployment options for LALS triggering. It is expected that the
CSP implements one of the two deployment options.
In LALS triggering option 1, the LTF present in the host NF that has the
associated IRI-POI triggers the LI-LCS Client. In LALS triggering option 2,
the LTF presents in the MDF2 triggers the LI-LCS Client.
##### 5.6.2.2.3 Summary
Table 5.6.2.2.3-1 provides the scope of NF domain that provides the IRI-
POI/CC-POI/LTF functions for the service type of Messaging.
Table 5.6.2.2.3-1: Scope of NF domain providing the LI functions for service
type Messaging
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                                                    VPLMN              HPLMN                                    VPLMN     HPLMN
MMS Proxy Relay IRI-POI n/a IRI-POI n/a IRI-POI  
MMS Proxy Relay CC-POI n/a CC-POI n/a CC-POI  
SMSF IRI-POI IRI-POI n/a IRI-POI n/a  
MME (with SMS service) IRI-POI IRI-POI n/a IRI-POI n/a  
IMS NFs See tables 5.6.2.2.3-2 to 5.6.2.2.3-5.  
LALS triggering Option 1 SMSF LTF LTF n/a LTF n/a MME LTF LTF n/a LTF n/a IMS
NFs See tables 5.6.2.2.3-2 and 5.6.2.2.3-3  
Option 2 MDF2 LTF LTF LTF LTF LTF
Table 5.6.2.2.3-2 provides the scope of NF domain in the IMS that provides the
IRI-POI/LTF for SMS over IMS when the target is not a non-local ID with
default IMS deployment option.
Table 5.6.2.2.3-2: Scope of NF domain in IMS providing the LI functions for
SMS over IMS (local ID) with Default
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN              HPLMN
P-CSCF n/a IRI-POI (NOTE 1) n/a n/a n/a  
E-CSCF IRI-POI IRI-POI n/a IRI-POI n/a  
S-CSCF IRI-POI n/a IRI-POI n/a IRI-POI  
LMISF-IRI n/a n/a n/a IRI-POI (NOTE 1) n/a  
LALS triggering Option 1 P-CSCF n/a LTF (NOTE 1) n/a n/a n/a E-CSCF n/a LTF
n/a LTF n/a S-CSCF LTF n/a LTF n/a LTF LMISF-IRI n/a n/a n/a LTF (NOTE1) n/a
Option 2 MDF2 LTF LTF LTF LTF LTF
Table 5.6.2.2.3-3 provides the scope of NF domain in the IMS that provides the
IRI-POI/LTF for SMS over IMS when the target is not a non-local ID with
Alternate IMS deployment option.
Table 5.6.2.2.3-3: Scope of NF domain in IMS providing the LI functions for
SMS over IMS (local ID) with Alternate option
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN              HPLMN
P-CSCF IRI-POI IRI-POI n/a IRI-POI (NOTE 2) IRI-POI  
IBCF n/a n/a IRI-POI n/a n/a  
LMISF-IRI n/a n/a n/a IRI-POI (NOTE 1) n/a  
LALS triggering Option 1 P-CSCF LTF LTF n/a LTF (NOTE 2) n/a IBCF n/a n/a LTF
n/a n/a LMISF-IRI n/a n/a n/a LTF (NOTE 1) n/a Option 2 MDF2 LTF LTF LTF LTF
LTF
Table 5.6.2.2.3-4 provides the scope of NF domain in the IMS that provides the
IRI-POI/LTF for SMS over IMS when the target is a non-local ID with default
IMS deployment option.
Table 5.6.2.2.3-4: Scope of NF domain in IMS providing the LI functions for
SMS over IMS (non-local ID) with Default
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN     HPLMN
P-CSCF n/a IRI-POI n/a n/a n/a S-CSCF IRI-POI n/a IRI-POI n/a IRI-POI LMISF-
IRI n/a n/a n/a IRI-POI n/a
Table 5.6.2.2.3-5 provides the scope of NF domain in the IMS that provides the
IRI-POI/LTF for SMS over IMS when the target is a non-local ID with Alternate
IMS deployment option.
Table 5.6.2.2.3-5: Scope of NF domain in IMS providing the LI functions for
SMS over IMS (non-local ID) with Alternate option
NFs with LI function Non-roaming Roaming with LBO Roaming with HR
* * *
                                       VPLMN              HPLMN             VPLMN     HPLMN
P-CSCF IRI-POI IRI-POI n/a n/a IRI-POI IBCF n/a n/a IRI-POI n/a n/a LMISF-IRI
n/a n/a n/a IRI-POI n/a
NOTE 1: Only for SMS over IMS not involving the emergency centre.
NOTE 2: Only for SMS over IMS to emergency centres.
NOTE 3: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NF for the indicated scenario.
NOTE 4: The LIPF is not aware of the above role played by the host NFs in
providing the LI functions
NOTE 5: MDF2, MDF3 and LI-LCS Client which are also involved in providing the
LI functions are not shown in the tables above.
## 5.7 PTC
### 5.7.1 Scope of interception
The illustrations shown in this clause are for the service type PTC.
The interception of service type of PTC is done by the IRI-POI and CC-POI
present in the PTC server and includes delivery of IRI or CC based on the
delivery type indicated in the warrant.
The following target identifiers are applicable to the service type of PTC for
provisioning the IRI-POI/CC-POI at the PTC Server:
\- IMPU.
\- IMPI.
\- MCPTT ID.
\- Instant ID URN.
\- Chat group ID.
The following target identifiers are applicable to the service type of PTC for
provisioning the IRI-POI at the HSS:
\- IMPU.
\- IMPI.
The target identity in the IMPU format may contain a SIP URI, TEL URI.
### 5.7.2 LIPF logic for service type of PTC
Figure 5.7.2-1 illustrates the LIPF logic for the provisioning of IRI-POI/CC-
POI in the PTC server.
Figure 5.7.2-1: LIPF logic for provisioning the IRI-POI/CC-POI in PTC Server
for the service type of PTC
When the Chat Group ID is used as the target ID, the PTC server happens to
intercept when the indicated chat group ID is used for a PTC chat session.
## 5.8 LALS
### 5.8.1 Scope of interception
The illustrations shown in this clause are for the service type LALS.
The interception of service type of LALS includes the delivery of target's
location information either immediate (at the time of provisioning) or
periodic by the LI-LCS Client.
### 5.8.2 LIPF logic for service type of LALS
Figure 5.8.2-1 illustrates the LIPF logic for the provisioning of LI-LCS
Client.
Figure 5.8.2-1: LIPF logic the provisioning of LI-LCS Client for the service
type of LALS
## 5.9 Location Acquisition
The figure 5.9-1 shows the LIPF logic in provisioning the LI functions for
Location Acquisition.
Figure 5.9-1: LIPF logic for Location Acquisition
The LAF is a Location Acquisition specific LI function present in the ADMF.
Therefore, the provisioning of LAF is treated as internal to the ADMF. The
provisioning of MDF2 is required if and only if the delivery method for
Location Acquisition includes IRI-based reporting which is indicated with the
Delivery Type of HI2Delivery.
The target identity SUPI collectively represents the SUPIIMSI and SUPINAI. The
target identity GPSI collectively represents the GPSIMSISDN and GPSINAI.
## 5.10 RCS
### 5.10.1 Scope of interception
The illustrations shown in this clause are for the service type RCS. The RCS
services may be provided by the CSP or by a third party service provider. In
the latter case, the provisioning logic defined below applies to the RCS
service provider. The S-CSCF in the CSP domain if involved may still need to
report the RCS registration related events.
A target can be a subscriber of the RCS service provider or a non-local ID. In
the case where a target is a non-local ID, the party communicating with the
target is a subscriber of RCS service provider.
The interception of service type of RCS is done by the IRI-POI and CC-POI
present in the RCS server, the IRI-POI and CC-POI present in the HTTP Content
Server and File Transfer Localization Function and the IRI-POI present in the
S-CSCF (always CSP).
For the cases where the file transfer related events cannot be associated to a
provisioned target identity in the HTTP Content Server and the File Transfer
Localization Function, the TFs (IRI-TF and CC-TF) present in the RCS Server
trigger the POIs (i.e. the triggered IRI-POI and the triggered CC-POI) in the
HTTP Content Server and File Transfer Localization Function.
For one file transfer related event, either the triggered IRI-POI or non-
triggered IRI-POI in the HTTP Content Server and the File Transfer
Localization Function generate the xIRIs. Likewise, to deliver the content of
the file, either the triggered CC-POI or non-triggered CC-POI in the HTTP
Content Server and the File Transfer Localization Function generate the xCC.
If the File Transfer Localization Function is not deployed by the RCS Service
Provider, the reporting what would have been done by the LI function in the
File Transfer Localization Function cannot be done.
The IRI-POI present in the S-CSCF reports just the RCS Registration related
xIRI when the same cannot be reported by the IRI-POI present in the RCS Server
(i.e. the case where IMS and RCS services are provided by different service
providers).
### 5.10.2 LIPF logic for service type of RCS
Figure 5.10.2-1 illustrates the LIPF logic for the service type RCS.
Figure 5.10.2-1: LIPF logic for provisioning for the service type RCS
Figure 5.10.2-2 illustrates the RCS LI provisioning logic as applicable to
CSP. and figure 5.10.2-3 illustrates the RCS-LI provisioning logic as
applicable to the third party service provider.
Figure 5.10.2-2: RCS LI provisioning as applicable to a CSP
Figure 5.10.2-3: RCS LI provisioning as applicable to third party service
provider
As shown in figure 5.10.2-2, the provisioning of IRI-POI in HSS is not
applicable for target non-local ID. Also, provisioning of IRI-POI in the HSS
is not applicable for the RCS provider when different from a CSP. The
provisioning of an IRI-POI in the S-CSCF is not required if the RCS server is
deployed in CSP network.
Figure 5.10.2-4 illustrates the LIPF logic for additional LI provisioning for
RCS.
Figure 5.10.2-4: Additional LIPF logic for provisioning for the service type
RCS
The provisioning of IRI-POI, CC-POI in HTTP Content Server and File Transfer
Localization Function is only for the POIs triggered from the IRI-TF, CC-TF
present in the RCS Server.
The following target identifiers are applicable to the service type of RCS for
provisioning the IRI-POI/CC-POI at the RCS Server:
\- IMPU.
\- IMPI.
\- PEI (IMEI only).
\- IMEI.
The target identity in the IMPU format may contain a SIP URI, TEL URI.
The following target identifiers are applicable to the service type of RCS for
provisioning the IRI-POI/CC-POI at the HTTP Content Server and File Transfer
Localization Function:
\- SIP URI.
\- TEL URI.
\- GPSI.
\- SUPI.
\- IMSI.
\- MSISDN.
\- Email Address.
The target identity in the GPSI format may contain a GPSIIMSI or GPSINAI. The
target identity in the SUPI format may contain SUPIIMSI or SUPINAI.
### 5.10.3 Interception
#### 5.10.3.1 Deployment
The CSP may or may not deploy a File Transfer Localization Function.
If the File Transfer Localization Function is not deployed, then reporting of
xIRIs and xCC that were supposed to be reported from IRI-POI and CC-POI in the
File Transfer Localization Function is not possible. This limitation happens
when a target or party communicating with the target non-local ID downloads a
file from the HTTP Content Server.
The RCS Server and the IMS may be managed by different service providers. When
the RCS Server is deployed and managed by a different provider, the IRI-POI in
the S-CSCF present of the IMS provider network is able to report RCS
registration related xIRIs.
#### 5.10.3.2 Summary
Table 5.10.3.2-1 provides the scope of NF domain that provides the IRI-
POI/IRI-TF/CC-TF/CC-POI functions for the service type of RCS.
Table 5.10.3.2-1: Scope of NF providing the LI functions for RCS
NF with the LI function CSP provides IMS and RCS IMS provider is different
from RCS provider
* * *
                                                                   IMS provider                                  RCS provider                                  
                                        Roaming                    Roaming                                                                                     
                                        Not                        Outbound                                      Inbound        Not       Outbound   Inbound
HSS (target local) IRI-POI IRI-POI n/a IRI-POI IRI-POI n/a n/a HSS (target
non-local) n/a n/a n/a n/a n/a n/a n/a S-CSCF n/a n/a n/a IRI-POI IRI-POI n/a
n/a RCS Server IRI-POI IRI-POI n/a n/a n/a n/a IRI-POI RCS Server CC-POI CC-
POI n/a n/a n/a n/a CC-POI RCS Server IRI-TF IRI-TF n/a n/a n/a n/a IRI-TF RCS
Server CC-TF CC-TF n/a n/a n/a n/a CC-TF HTTP Content Server IRI-POI IRI-POI
n/a n/a n/a n/a IRI-POI HTTP Content Server CC-POI CC-POI n/a n/a n/a n/a CC-
POI File Transfer Localization Function IRI-POI IRI-POI n/a n/a n/a n/a IRI-
POI File Transfer Localization Function CC-POI CC-POI n/a n/a n/a n/a CC-POI
NOTE 1: The use of \"n/a\" in the above table implies that the LI function is
not applicable to the NF for the indicated scenario.
NOTE 2: The LIPF is not aware of the above role played by the NFs in providing
the LI functions nor the roaming situations of the target or the party
communicating with the target non-local ID.
NOTE 3: The LIPF is aware of whether RCS services are provided by CSP (that
provides the IMS services) or in third party service provider.
NOTE 4: MDF2 and MDF3 which are also involved in providing the LI functions
are not shown in the tables above.
###### ## Annex C (informative): Bibliography
#