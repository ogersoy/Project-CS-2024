# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document studies the charging aspects for enhanced support of non-
public networks on the TS 23.501 [2], TS 23.502 [3], TS 23.503 [4], TS 23.228
[5] and TS 23.167 [6] incorporating conclusions from TR 23.734 [7] and TR
23.700-07 [8].
The following is studied:
\- Charging scenarios and potential charging requirements for Non-Public
Networks (i.e. Stand-alone Non-Public Network (SNPN) or Public Network
Integrated NPN (PNI-NPN)).
\- Possible charging solutions for Non-Public Networks with potential impact
on charging architecture, charging functions and charging procedures.
\- End user charging and Inter-Provider charging by considering the different
business roles.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System (5GS); Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.503: \"Policy and charging control framework for the 5G System
(5GS); Stage 2\".
[5] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
[6] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
[7] 3GPP TR 23.734: \"Study on enhancement of 5G System (5GS) for vertical and
Local Area Network (LAN) services\".
[8] 3GPP TR 23.700-07: \"Study on enhanced support of Non-Public Networks
(NPN)\".
[9] 3GPP TS 22.261: \"Service requirements for the 5G system; Stage 1\".
[10] 3GPP TS 28.557: \"Management of Non-Public Networks (NPN); Stage 1 and
stage 2\".
[11] 3GPP TS 32.256: \"5G connection and mobility domain charging; stage 2\".
[12] 3GPP TS 32.255: 5G data connectivity domain charging; Stage 2\".
[13] 3GPP TR 32.847: \"Study on Charging Aspects for Network Slicing Phase
2\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in TR 21.905 [1] and
the following apply. A term defined in the present document takes precedence
over the definition of the same term, if any, in TR 21.905 [1].
## 3.2 Symbols
Void.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
CAG Closed Access Group
CSC Communication Service Customer
CSP Communication Service Provider
DNN Data Network Name
N3IWF Non-3GPP InterWorking Function
NID Network identifier
NPN-OP NPN Operator
NPN-SC NPN Service Customer
NPN-SP NPN Service Provider
PNI-NPN Public Network Integrated NPN
SNPN Stand-alone Non-Public Network
# 4 Background
## 4.1 General
In SA1, Non-Public Networks service requirements are documented in TS 22.261
[9]. In SA2, there are two study items and two work items which are related to
Non-Public Networks. The corresponding studies are documented in TR 23.734 [7]
and TR 23.700-07 [8], respectively and the normative work is documented in TS
23.501 [2], TS 23.502 [3], TS 23.503 [4], TS 23.228 [5] and TS 23.167 [6].
A Non-Public Network (NPN) is a 5GS deployed for non-public use, see TS 22.261
[9]. As described in TS 23.501 [2], an NPN is either:
\- a Stand-alone Non-Public Network (SNPN), i.e. operated by an NPN operator
and not relying on network functions provided by a PLMN; or
\- a Public Network Integrated NPN (PNI-NPN), i.e. a non-public network
deployed with the support of a PLMN.
Functionality and architecture of Stand-alone NPN are described in clause
4.2.1 and functionality and architecture of Public Network Integrated NPNs are
described in clause 4.2.2.
## 4.2 Non-public networks functionality and architecture
### 4.2.1 Stand-alone Non-Public Network (SNPN)
SNPN 5GS deployments are based on the architecture depicted in clause 4.2.3 TS
23.501 [2], the architecture for 5GC with untrusted non-3GPP access (Figure
4.2.1-1) for access to SNPN services via a PLMN (and vice versa).
Figure 4.2.1-1: Non-roaming architecture for 5G Core Network with untrusted
non-3GPP access
To access SNPN services, a UE that has successfully registered with a PLMN
over 3GPP access may perform another registration via the PLMN User Plane with
an SNPN (using the credentials of that SNPN). In order to obtain access to
Non-Public Network services when the UE is camping in NG-RAN of a PLMN, the UE
obtains IP connectivity, discovers and establishes connectivity to an N3IWF in
the Stand-alone Non-Public Network. The architecture for access to SNPN
services via PLMN is depicted in Figure 4.2.1-2.
Figure 4.2.1-2: Access to Stand-alone Non-Public Network services via PLMN
To access PLMN services, a UE in SNPN access mode that has successfully
registered with an SNPN may perform another registration via the SNPN User
Plane with a PLMN (using the credentials of that PLMN). In order to obtain
access to PLMN services when the UE is camping in NG-RAN of Stand-alone Non-
Public Network, the UE obtains IP connectivity, discovers and establishes
connectivity to an N3IWF in the PLMN. The architecture for access to PLMN
services via SNPN is depicted in Figure 4.2.1-3.
Figure 4.2.1-3: Access to PLMN services via Stand-alone Non-Public Network
### 4.2.2 Public Network Integrated NPN (PNI-NPN)
Public Network Integrated NPNs are NPNs made available via PLMNs e.g. by means
of dedicated DNNs, or by one (or more) Network Slice instances allocated for
the NPN. When a PNI-NPN is made available via a PLMN, then the UE needs to
have a subscription for the PLMN in order to access PNI-NPN.
A Closed Access Group (CAG) identifies a group of subscribers who are
permitted to access one or more CAG cells associated to the CAG. CAG is used
for the PNI-NPNs to prevent UE(s), which are not allowed to access the NPN via
the associated cell(s), from automatically selecting and accessing the
associated CAG cell(s).
## 4.3 Charging modes
As per TS 23.501 [2], in the context of Non-Public Networks, responsibilities
regarding operations need to be clearly defined and assigned to roles. NPN
charging can be built upon the roles related to NPN management specified in
the clause 4.2 of TS 28.557 [10] without the consideration on the network
equipment and infrastructure. Non-public networks in 5G environment involves
the services or capabilities provided by multiple service providers in the
form of following business roles:
\- NPN Operator (NPN-OP): a Network Operator (NOP) is limited to 5G networks
for non-public use, i.e. NPNs.
\- NPN Service Provider (NPN-SP): a Communication Service Provider (CSP) which
provides communication services for non-public use, e.g. vertical, tenant,
NOP.
\- NPN Service Customer (NPN-SC): a Communication Service Customer (CSC) which
consumes communication services for non-public use, e.g. end user, vertical,
tenant.
Considering the different business models such as B2B, B2C, and B2B2X,
charging modes for non-public networks include (but not limited to):
\- End user charging;
\- Inter-provider charging.
Depending on the scenarios an organisation can play one or several roles
simultaneously, and apply charging models based on corresponding business
relationship, e.g.:
\- Charging models for NPN-SP to charge NPN-SC for using NPN services.
\- Charging models for NPN-OP to charge NPN-SP for using their networks and
related network services.
\- When NPN-OP and NPN-SP role are provided by the same enterprise, to charge
NPN-SC role for using their networks and NPN services.
In deployments, there could be business scenarios where one or more of the
business roles are supported by a single enterprise. The present document does
not impose any restrictions to the possible deployment scenarios.
# 5 Charging scenarios and key issues for SNPN
## 5.1 Topic 1: Converged charging for data connectivity in SNPN
### 5.1.1 Use cases
#### 5.1.1.1 Use case #1a: End users access the SNPN service directly
SNPN 5GS deployments are based on the 5G system architecture depicted in
clause 4.2.3 of TS 23.501 [2].
Charged Party: An End User (UE) who accessed SNPN services.
Charging Party: SNPN operator who charges the End user for data connectivity
in SNPN.
The potential charging requirements and key issues for this UC are: REQ-
CH_SNPN_DC-01 and Key Issue #1a.
#### 5.1.1.2 Use case #1b: End users access the SNPN service via PLMN
SNPN 5GS deployments are based on the 5G system architecture depicted in
clause 4.2.3 of TS 23.501 [2], the architecture for 5GC with untrusted
non-3GPP access for access to SNPN services via a PLMN (and vice versa).
Charged Party: An End User (UE) has a subscription with the PLMN and SNPN
which allows access of the SNPN service via PLMN.
Charging Party:
\- SNPN operator charges the End user for data connectivity in SNPN.
The potential charging requirements and key issues for this UC are: REQ-
CH_SNPN_DC-01 and Key Issue #1a.
#### 5.1.1.3 Use case #1c: End users access the PLMN service via SNPN
SNPN 5GS deployments are based on the 5G system architecture depicted in
clause 4.2.3 of TS 23.501 [2], the architecture for access to PLMN services
via SNPN is depicted in Figure 4.2.1-3. To access PLMN services, a UE in SNPN
access mode establishes the data connectivity to an N3IWF in the PLMN.
Charged Party: The PLMN has a agreement with the SNPN which allows end users
accessing the PLMN service via SNPN.
Charging Party:
\- SNPN operator charges the PLMN for data connectivity to or from PLMN via
SNPN.
The potential charging requirements and key issues for this UC are: REQ-
CH_SNPN_DC-02 and Key Issue #1b.
### 5.1.2 Potential charging requirements
**REQ-CH_SNPN_DC-01:** The SNPN should support collecting charging information
of data connectivity charging in SNPN per UE for SNPN services.
**REQ-CH_SNPN_DC-02:** The SNPN should support collecting charging information
of data connectivity charging via SNPN per PLMN for PLMN services.
### 5.1.3 Key issues
The following key issues are identified:
\- **Key Issue #1a** : the charging information collection and reporting in
SNPN for data connectivity per UE.
\- **Key Issue #1b** : the charging information collection and reporting in
SNPN for data connectivity per PLMN.
### 5.1.4 Possible solutions
#### 5.1.4.1 Solution #1: Data connectivity in SNPN Charging per UE directly
##### 5.1.4.1.1 General
This solution #1 which _relying on_ 5G data connectivity converged charging
architecture defined in TS 32.255 [12], with the extension of SNPN charging
per UE, addresses the Key Issue #1a.
##### 5.1.4.1.2 Reference architecture
Based on figure 4.2.1-3, the CHF in the SNPN is added. The UE is charged by
CHF in the SNPN for 5G data connectivity in SNPN.
Figure 5.1.4.1.2-1: Data connectivity of SNPN Charging per UE directly in SBI
representation
##### 5.1.4.1.3 Message flows
The message flows are the same with the 5G data connectivity per PDU session
charging specified in the TS 32.255 [12].
SMF in the SNPN reports the Charging Data Request contains SNPN ID (PLMN ID
and NID identifying an SNPN) to the CHF in the SNPN.
#### **5.1.4.2 Solution #2: Data connectivity in SNPN Charging per UE (access
the SNPN via PLMN)**
##### **5.1.4.2.1 General**
This solution #2 which _relying on_ 5G data connectivity converged charging
architecture defined in TS 32.255 [12], with Charging UE by SNPN, addresses
the Key Issue #1a for access SNPN via PLMN.
##### **5.1.4.2.2 Reference architecture**
Based on figure 4.2.1-2 the CHF in the SNPN is added. The UE is charged by CHF
in the SNPN for data connectivity via PLMN.
Figure 5.1.4.2.1-1: Data connectivity of SNPN Charging (access the SNPN via
PLMN)
##### **5.1.4.2.3 Message flows**
For access the SNPN services, the message flows for the PDU session
establishment, PDU session modification, PDU session release of 5G data
connectivity charging would be the same as in clauses 5.2.2.13.2.1,
5.2.2.13.3.1 and 5.2.2.13.4.1 of TS 32.255 [12].
The SMF in SNPN reports the Charging Data Request contains access type
(\"Non-3GPP access\") to the CHF belongs to the same SNPN, using PLMN ID and
NID to identify the SNPN.
#### **5.1.4.3 Solution #3: Data connectivity in SNPN Charging per PLMN
(access the PLMN via SNPN)**
##### **5.1.4.3.1 General**
This solution #3 which _relying on_ 5G data connectivity converged charging
architecture defined in TS 32.255 [12], with the extension of SNPN charging
per PLMN for accessing the PLMN service, addresses the Key Issue #1b, covering
the REQ-CH_SNPN_DC-02.
##### **5.1.4.3.2 Reference architecture**
Based on figure 4.2.1-3, the CHF in the SNPN is added. The PLMN is charged by
CHF in the SNPN for 5G data connectivity to support of accessing the PLMN
service.
Figure 5.1.4.3.2-1: Data connectivity in SNPN Charging (access the PLMN via
SNPN)
##### **5.1.4.3.3 Message flows**
For access the PLMN services via SNPN, the message flows for the PDU session
establishment, PDU session modification, PDU session release of 5G data
connectivity charging would be the same as in clauses 5.2.2.13.2.1,
5.2.2.13.3.1 and 5.2.2.13.4.1 of TS 32.255 [12].
The CHF in SNPN charges the volume usage per PLMN based on the accumulation of
usage for UEs belonging to the same PLMN. In the solution, the SMF reports the
charging Data request contains the PLMN ID.
### 5.1.5 Evaluation
Solution #1 and solution #2 solve the key issue #1a:
\- Solution #1 focus on the access SNPN service directly for end user charging
based on PDU session charging via SMF in SNPN.
\- Solution #2 focus on the access the SNPN service via PLMN for end user
charging based on PDU session charging via SMF.
\- The UE is charged by CHF in the SNPN for 5G data connectivity to support of
accessing the SNPN service via PLMN.
\- The UE is charged by CHF in the PLMN for 5G data connectivity to support of
accessing PLMN.
Solution #3 solves the key issue 1b for the interworking case:
\- Solution #3 focus on the access the PLMN service via SNPN for inter-
provider charging.
\- The solution 3 solves the data connectivity in SNPN Charging per PLMN
(access the PLMN via SNPN) for inter-provider charging, which aggregates usage
for UEs belonging to the same PLMN.
\- For inter-provider charging, the PLMN ID is required and this relies on
that the SNPN can provide the PLMN identifier.
### 5.1.6 Conclusion
The Solution #1, Solution #2 and Solution #3 are selected to the normative
work.
## 5.2 Topic 2: Converged charging for access connection in SNPN
### 5.2.1 Use cases
#### 5.2.1.1 Use case #2a: Network access control
The combination of a PLMN ID and Network Identifier (NID) identifies an SNPN.
If a UE performs the registration or service request procedure in an SNPN
identified by a PLMN ID and a NID and there is no subscription for the UE,
then AMF rejects the UE with a cause code to prevent the UE from automatically
selecting and registering with the same SNPN as described in TS 23.501 [2].
\- The NPN-OP provides the SNPN to NPN-SP (e.g. vertical industry customer),
and NPN-SP provides NPN services to NPN-SC. It is important for NPN-OP to
collect usage for SNPN resources associated to access connection for the
purpose of charging or statistics.
The potential charging requirements for this UC are: REQ-eNPN_CH_SNPN_AC-01,
REQ-eNPN_CH_SNPN_AC-02.
#### 5.2.1.2 Use case #2b: Converged charging for number of UEs
The maximum number of UEs, corresponding to the maximum number of UEs
associated with Network Identifier, represents the maximum number of UEs using
the SNPN network simultaneously.
For the SNPN, it is important for NPN-OP to collect number of UEs per Network
Identifier of vertical industry customers for the purpose of charging or
statistics. In addition, NPN-OP can perform tiered charging for different
number of UEs threshold.
The potential charging requirements for this UC are: REQ-eNPN_CH_SNPN_AC-03,
REQ-eNPN_CH_SNPN_AC-04.
#### 5.2.1.3 Use case #2c: Converged charging for number of PDU sessions
The maximum number of PDU sessions, corresponding to the maximum number of PDU
sessions associated with Network Identifier, represents the maximum number of
PDU sessions using the SNPN network simultaneously.
For the SNPN, it is important for NPN-OP to collect number of PDU sessions per
Network Identifier of vertical industry customers for the purpose of charging
or statistics. In addition, NPN-OP can perform tiered charging for different
number of PDU sessions threshold.
The potential charging requirements for this UC are: REQ-eNPN_CH_SNPN_AC-03,
REQ-eNPN_CH_SNPN_AC-05.
### 5.2.2 Potential charging requirements
**REQ-eNPN_CH_SNPN_AC-01:** The 5G system should support converged charging
per UE for SNPN network access and usage.
**REQ-eNPN_CH_SNPN_AC-02:** The 5G system should support converged charging
per vertical industry consumer for SNPN network access and usage.
**REQ-eNPN_CH_SNPN_AC-03:** The 5G system should support converged charging
per Network Identifier for SNPN network access and usage.
**REQ-eNPN_CH_SNPN_AC-04:** The 5G system should support converged charging
per Network Identifier for SNPN network access and usage, based on \"number of
UEs\".
**REQ-eNPN_CH_SNPN_AC-05:** The 5G system should support converged charging
per Network Identifier for SNPN network access and usage, based on \"number of
PDU sessions\".
### 5.2.3 Key issues
This key issue is for investigating how to support converged charging for
access connection in SNPN considering REQ-eNPN_CH_SNPN_AC-01, REQ-
eNPN_CH_SNPN_AC-02, REQ-eNPN_CH_SNPN_AC-03, REQ-eNPN_CH_SNPN_AC-04 and REQ-
eNPN_CH_SNPN_AC-05. This investigation covers the following:
\- **Key Issue #2a:** Identification of the charging information for converged
charging for SNPN network access and usage;
\- **Key Issue #2b:** Identification of the main interactions with the NFs to
obtain the charging information;
\- **Key Issue #2c:** The charging mechanism supporting converged inter-
provider charging for SNPN network access and usage.
### 5.2.4 Possible solutions
#### 5.2.4.1 Solution #1: End user charging for SNPN network usage of access
##### 5.2.4.1.1 General
This solution #1 which _relying on_ 5G connection and mobility converged
charging architecture defined in TS 32.256 [11], with the extension of
including Network Identifier for SNPN network access in registration
management charging per UE, addresses the Key Issue #2a and Key Issue #2b.
In this solution, AMF collects charging information including Network
Identifier per UE registration to the 5GS, and the charging information for
end user usage of access in SNPN network reported by AMF is obtained by CHF.
The subclause below describes registration management charging. The following
scenarios specified in TS 32.256 [11] are supported:
\- PEC;
\- IEC;
\- ECUR.
For deregistration procedures, only PEC scenario is supported.
##### 5.2.4.1.2 General Registration -- PEC charging
This solution is the same as clause 6.1.4.1.2 with:
\- \"CAG Identifier(s)\" replaced by \"Network Identifier\".
##### 5.2.4.1.3 General Registration -- IEC
This solution is the same as clause 6.1.4.1.3 with:
\- \"CAG Identifier(s)\" replaced by \"Network Identifier\".
##### 5.2.4.1.4 General Registration -- ECUR
This solution is the same as clause 6.1.4.1.4 with:
\- \"CAG Identifier(s)\" replaced by \"Network Identifier\".
##### 5.2.4.1.5 Deregistration -- PEC charging
This solution is the same as clause 6.1.4.1.5 with:
\- \"CAG Identifier(s)\" replaced by \"Network Identifier\".
#### 5.2.4.2 Solution #2: Converged charging for number of UEs
##### 5.2.4.2.1 General
This solution #2, charges vertical industry customer when \"Number of UEs\"
threshold for the Network Identifier is reached or \"maximum number of UEs\"
for the Network Identifier is reached, which addresses the Key Issue #2a, Key
Issue #2b and Key Issue #2c.
##### 5.2.4.2.2 Architecture description
A new NF NPNACF (Non-Public Network Admission Control Function) is introduced
to the solution. The converged charging architecture for NPNACF (CTF) based
solution as depicted in figure 5.2.4.2.2-1 is proposed for converged charging
for number of UEs per Network Identifier.
Figure 5.2.4.2.2-1: NPNACF (CTF) converged charging architecture
##### 5.2.4.2.3 Procedures description
The figure 5.2.4.2.3-1 describes the high-level charging procedure for NPNACF
(CTF) based converged charging.
Figure 5.2.4.2.3-1: NPNACF (CTF) based converged charging-IEC
0ch. CHF obtains the \"maximum number of UEs\" per Network Identifier.
The NPNACF is configured per Network Identifier, with \"maximum number of
UEs\" and a set of \"Number of UEs\" intermediate thresholds (downwards and
upwards triggers) under the \"maximum number of UEs\".
Registration procedure per TS 32.256 [11] clause 5.2.2.2.3 steps 1\~16.
3\. The AMF sends NumOfUEsUpdate_Request to NPNACF. The NPNACF checks
availability and updates Number of UEs per Network Identifier.
3ch-a: For a Network Identifier one \"Number of UEs\" threshold is reached or
\"maximum number of UEs\" is reached.
3ch-b: The NPNACF sends Charging Data Request to CHF for reporting number of
UEs for the Network Identifier.
3ch-c. Account and rating control based on number of UEs for the Network
Identifier.
3ch-d. CHF provides response to NPNACF by sending Charging Data Response.
4\. The NPNACF sends NumOfUEsUpdate_Response to AMF.
5\. Registration procedure per TS 32.256 [11], clause 5.2.2.2.3 steps 17\~24.
NOTE : The support for controlling number of UEs per Network Identifier is out
of scope of the present document.
#### 5.2.4.3 Solution #3: Converged charging for number of PDU sessions
##### 5.2.4.3.1 General
This solution #3, charges vertical industry customer when \"Number of PDU
sessions\" threshold for the Network Identifier is reached or \"maximum number
of PDU sessions\" for the Network Identifier is reached, which addresses the
Key Issue #2a, Key Issue #2b and Key Issue #2c.
##### 5.2.4.3.2 Architecture description
A new NF NPNACF (Non-Public Network Admission Control Function) is introduced
to the solution. The converged charging architecture for NPNACF (CTF) based
solution as depicted in figure 5.2.4.2.2-1 is proposed for converged charging
for number of PDU sessions per Network Identifier.
##### 5.2.4.3.3 Procedures description
The figure 5.2.4.3.3-1 describes the high-level charging procedure for NPNACF
(CTF) based converged charging.
Figure 5.2.4.3.3-1: NPNACF (CTF) based converged charging-IEC
0ch. CHF obtains the \"maximum number of PDU sessions\" per Network
Identifier.
1\. The NPNACF is configured per Network Identifier, with \"maximum number of
PDU sessions\" and a set of \"Number of PDU sessions\" intermediate thresholds
(downwards and upwards triggers) under the \"maximum number of PDU sessions\".
2\. PDU session establishment procedure per TS 32.255 [12], clause 5.2.2.2.2
steps 1\~9.
3\. The SMF sends NumOfPDUsUpdate_Request to NPNACF. The NPNACF checks
availability and updates Number of PDU sessions per Network Identifier.
3ch-a: For a Network Identifier one \"Number of PDU sessions\" threshold is
reached or \"maximum number of PDU sessions\" is reached.
3ch-b: The NPNACF sends Charging Data Request to CHF for reporting number of
PDU sessions for the Network Identifier.
3ch-c. Account and rating control based on number of PDU sessions for the
Network Identifier.
3ch-d. CHF provides response to NPNACF by sending Charging Data Response.
4\. The NPNACF sends NumOfPDUsUpdate_Response to SMF.
PDU session establishment procedure per TS 32.255 [12] clause 5.2.2.2.2 steps
10\~14.
NOTE : The support for controlling PDU sessions per Network Identifier is out
of scope of the present document.
#### 5.2.4.4 Solution #4: Converged charging for number of UEs or PDU sessions
using separate CCS
##### 5.2.4.4.1 General
This solution addresses the key issues #2a, 2b and 2c covering potential
requirements _REQ-eNPN_CH_SNPN_AC-03, REQ-eNPN_CH_SNPN_AC-04 and REQ-
eNPN_CH_SNPN_AC-05 based on_ distributed charging architecture split between
two Converged Charging Systems (CCS) _and exchanges between them_.
Two types of subscribers are considered in the context of SNPN: the NPN-SC,
and the individual end-user \"UE\" served under the NPN. Each type of
subscriber is handled under a dedicated CCS: \"NPN CCS\" and \"UE CCS\"
respectively.
UE CCS of the PLMN performs charging functionalities for individual UEs, and
includes in particular:
\- CHF exposing Nchf services associated to individual UEs.
\- ABMF/RF hosting individual UE account balance and subscribed services, as
well as the rates for services.
NPN CCS of the PLMN performs charging functionalities for NPN-SC, and includes
in particular:
\- CHF exposing Nchf services associated to individual UEs.
\- ABMF/RF hosting individual NPN-SC account balance and subscribed services,
as well as the rates for services.
How the account balance and subscribed services are provisioned (for both NPN-
SC and individual UE) is unspecified and expected to be covered at BSS and OSS
level.
A new reference point (ChX) is defined between CHF in NPN CCS and the CHF in
UE CCS enabling association between individual UE charging and NPN-SC
charging. This association is achieved by UE CCS responsible for individual UE
charging consuming this new charging service exposed by the NPN-SC CCS.
The new reference (ChX) may use the Nchf_ConvergedCharging service with
extensions or use a completely new Nchf service.
For UE:
\- the 5G data connectivity charging from SMF is specified in TS 32.255 [12]
\- the 5G connection and mobility charging from AMF is specified in TS 32.256
[11]
and uses Nchf_ConvergedCharging service exposed by CHF in UE CCS.
##### 5.2.4.4.2 Architecture description
Figure 5.2.4.4.2-1: Distributed charging architecture in reference point
representation
Figure 5.2.4.4.2-2: Distributed charging architecture in service based
representation
##### 5.2.4.4.3 Procedures description
This would be the same as for the figure 6.1.4.4.3-1 for the number of PDU
sessions and 6.1.4.4.3-2 for the number of UEs with the possibility of using
Network Identifier and PLMN Id to identify the SNPN.
### 5.2.5 Evaluation
#### **5.2.5.1 Evaluation of possible solutions for end user charging for SNPN
network usage of access**
Solution #1 has proposed end user charging for SNPN network usage of access,
enabling the AMF to collect charging information which including Network
Identifier per UE registration to the 5GS, and the charging information for
end user usage of access in SNPN network reported by AMF is obtained by CHF.
#### **5.2.5.2 Evaluation of possible solutions for converged charging for
number of UEs**
Solution #2 and #4 propose solutions on converged charging for number of UEs.
The following table lists the characteristics of the two solutions.
Table 5.2.5.2-1: Comparison between Solution #2 and #4
+------------------------+------------------------+------------------+ | | NF controlling number | NF acts as a CTF | | | of UEs per PNI-NPN | | +========================+========================+==================+ | Solution #2: NPNACF | NPNACF | NPNACF | | (CTF) based converged | | | | charging for number of | (New NF) | | | UEs | | | +------------------------+------------------------+------------------+ | Solution #4: Separate | CHF | AMF | | CCS based converged | | | | charging for number of | (New NPN CCS) | | | UEs | | | +------------------------+------------------------+------------------+
The principles of solution #2 are inline with the NSACF charging of Network
Slicing in TR 32.847 [13], and the identification of the SNPN can be based on
e.g. Network Identifier.
The principles of solution #4, are inline the solution for network slice
charging based on 5G data connectivity in TS 32.255 [12] annex D.
#### **5.2.5.3 Evaluation of possible solutions for converged charging for
number of PDU sessions**
Solution #3 and #4 propose solutions on converged charging for number of PDU
sessions. The following table lists the characteristics of the two solutions.
Table 5.2.5.3-1: Comparison between Solution #3 and #4
+------------------------+------------------------+------------------+ | | NF controlling number | NF acts as a CTF | | | of PDU sessions per | | | | NPI-NPN | | +========================+========================+==================+ | Solution #3: NPNACF | NPNACF | NPNACF | | (CTF) based converged | | | | charging for number of | (New NF) | | | PDU sessions | | | +------------------------+------------------------+------------------+ | Solution #4: Separate | CHF | SMF | | CCS based converged | | | | charging for number of | (New NPN CCS) | | | PDU sessions | | | +------------------------+------------------------+------------------+
The principles of solution #3 are inline with the NSACF charging of Network
Slicing in TR 32.847 [13], and the identification of the SNPN can be based on
e.g. Network Identifier.
The principles of solution #4, are inline the solution for network slice
charging based on 5G data connectivity in TS 32.255 [12] annex D.
### 5.2.6 Conclusion
Based on the evaluation in clause 5.2.5.1, solution #1 is the only solution
for end user charging for SNPN network usage of access. The solution #1 is
selected to the normative work.
Based on the evaluation in clause 5.2.5.2, solution #2 needs support for
controlling number of UEs for SNPN per Network Identifier which is not
currently supported by SA WG2. Solution #4 needs support a new interface
between CHF in NPN CCS and CHF in UE CCS which is not currently supported, and
it also has some impact on PDU session establishment procedure in SMF, and
registration procedure in AMF, which require converged charging. It is
concluded that using converged charging mechanism for simultaneous number of
UEs per network slice to support converged charging for number of UEs per SNPN
in normative work of release 18. It can solve a unique S-NSSAI is allocated
for one SNPN.
Based on the evaluation in clause 5.2.5.3, solution #3 needs support for
controlling PDU sessions for SNPN per Network Identifier which is not
currently supported by SA WG2. Solution #4 needs support a new interface
between CHF in NPN CCS and CHF in UE CCS which is not currently supported, and
it also has some impact on PDU session establishment procedure in SMF, and
registration procedure in AMF, which require converged charging. It is
concluded that using converged charging mechanism for simultaneous number of
PDU sessions per network slice to support converged charging for number of PDU
sessions per SNPN in normative work of release 18. It can solve a unique
S-NSSAI is allocated for one SNPN.
## 5.3 Topic 3: Converged charging for data connectivity in PLMN
### 5.3.1 Use cases
#### 5.3.1.1 Use case #3a: End users access the PLMN service via SNPN
SNPN 5GS deployments are based on the 5G system architecture depicted in
clause 4.2.3 of TS 23.501 [2], the architecture for access to PLMN services
via SNPN is depicted in Figure 4.2.1-3. To access PLMN services, a UE in SNPN
access mode establishes the data connectivity to an N3IWF in the PLMN.
Charged Party: The End User (UE) has a subscription with the SNPN and PLMN
which allows access of the PLMN service.
Charging Party:
\- PLMN operator charges the 5G data connectivity for the End user.
The potential charging requirements for this UC are: REQ-CH_PLMN_DC**-** 01
and Key Issue #3a.
#### 5.3.1.2 Use case #3b: End users access the SNPN service via PLMN
SNPN 5GS deployments are based on the 5G system architecture depicted in
clause 4.2.3 of TS 23.501 [2], the architecture for 5GC with untrusted
non-3GPP access for access to SNPN services via a PLMN.
Charged Party: The SNPN has a agreement with the PLMN which allows End users
accessing the SNPN service via PLMN.
Charging Party:
\- PLMN charges the 5G data connectivity for the SNPN.
The potential charging requirements and key issues for this UC are: REQ-
CH_PLMN_DC-02 and key issue #3b.
### 5.3.2 Potential charging requirements
**REQ-CH_PLMN_DC-01:** The 5G system should support collecting charging
information based on the 5G data connectivity usage per UE.
**REQ-CH_PLMN_DC-02:** The 5G system should support collecting charging
information based on the 5G data connectivity usage per SNPN.
### 5.3.3 Key issues
The following key issues are identified:
\- **Key Issue #3a** : the charging information collection and reporting in 5G
system for 5G data connectivity per UE.
\- **Key Issue #3b** : the charging information collection and reporting in 5G
system for 5G data connectivity for PLMN per SNPN.
### 5.3.4 Possible solutions
#### **5.3.4.1 Solution #1: Data connectivity in PLMN Charging per UE (access
the PLMN via SNPN)**
##### **5.3.4.1.1 General**
This solution #1 which _relying on_ 5G data connectivity converged charging
architecture defined in TS 32.255 [12], with the extension of PLMN Charging
via SNPN access per UE, addresses the Key Issue #3a.
##### **5.3.4.1.2 Reference architecture**
Based on figure 4.2.1-3, the CHF in the PLMN is added. The UE is charged by
CHF in the PLMN for 5G data connectivity of PLMN services.
Figure 5.3.4.1.2-1 Data connectivity in PLMN Charging per UE (access the PLMN
via SNPN)
##### **5.3.4.1.3 Message flows**
For access the PLMN services, the message flows for the PDU session
establishment, PDU session modification, PDU session release of 5G data
connectivity charging would be the same as in clauses 5.2.2.13.2.1,
5.2.2.13.3.1 and 5.2.2.13.4.1 of TS 32.255 [12].
The SMF in the PLMN reports the Charging Data Request contains RAT type
specifics to SNPN
#### **5.3.4.2 Solution #2: Data connectivity in PLMN Charging per SNPN
(access the SNPN via PLMN)**
##### **5.3.4.2.1 General**
This solution #2 which _relying on_ 5G data connectivity converged charging
architecture defined in TS 32.255 [12], with the charging for the usage in the
PLMN per SNPN by PLMN, addresses the Key Issue #3b.
##### **5.3.4.2.2 Reference architecture**
Based on figure 4.2.1-2, the CHF in the PLMN is added. The SNPN is charged by
CHF in the PLMN for data connectivity.
Figure 5.3.4.2.2-1: Data connectivity in PLMN Charging per SNPN (access the
SNPN via PLMN)
##### **5.3.4.2.3 Message flows**
For access the SNPN services, the message flows for the PDU session
establishment, PDU session modification, PDU session release of 5G data
connectivity charging would be the same as in clauses 5.2.2.13.2.1,
5.2.2.13.3.1 and 5.2.2.13.4.1 of TS 32.255 [12].
The NWu (for NPN) between the UE and the N3IWF in the SNPN for establishing a
secure tunnel between UE and the N3IWF over the PLMN. The SMF in PLMN can
distinguish the usage packet transferred to N3IWF in SNPN, and sends the
volume to the CHF in the PLMN belongs to same N3IWF address.
The CHF in PLMN charges the volume usage per SNPN based on the accumulation of
usage reporting per UE, may with the same N3IWF address.
### **5.3.5 Evaluation**
The Solution #1 solves the key issue #3a:
\- solves the data connectivity in PLMN (access the PLMN via SNPN) for End
user charging, with a RAT type specific to a SNPN and with a SNPN ID (PLMN ID
and NID identifying SNPN), if available.
\- For end user charging, the SNPN ID is not necessary. Without the SNPN ID,
there is no impact on the Solution #1.
The Solution #2 solves the key issue #3b:
\- solves the data connectivity in PLMN (access the SNPN via PLMN) for inter-
provider charging, with the volume usage per SNPN based on the accumulation of
usage reporting per UE, with the same N3IWF address to indicate the SNPN.
### **5.3.6 Conclusion**
Solution #1 and Solution #2 are selected to the normative work.
# 6 Charging scenarios and key issues for PNI-NPN
## 6.1 Topic 1: Converged charging for access connection in PNI-NPN
### 6.1.1 Use cases
#### 6.1.1.1 Use case #1a: Network access control
Relying on PLMN network, PNI-NPN provides logically independent 5G non-public
network for vertical industry customers through network slice instances/
dedicated DNNs, and supporting of CAG feature. CAG is used for access control
to prevent unauthorized UEs from trying to access a PNI-NPN.
The NPN-OP provides the PNI-NPN to NPN-SP (e.g. vertical industry customer),
and NPN-SP provides NPN services to NPN-SC. It is important for NPN-OP to
collect usage for PNI-NPN resources associated to access connection for the
purpose of charging or statistics.
The potential charging requirements for this UC are: REQ-eNPN_CH_PNI-
NPN_AC-01, REQ-eNPN_CH_PNI-NPN_AC-02.
#### 6.1.1.2 Use case #1b: Converged charging for number of UEs
For vertical industry consumers, some enterprise UEs may be restricted to only
access the non-public network of the enterprise, even if PLMN coverage is
available in the same geographic area. To use Closed Access Group, enterprise
UE may subscribe the CAG information, indicating CAG Identifiers the UE is
allowed to access.
The maximum number of UEs, corresponding to the maximum number of UEs
associated with CAG Identifier, represents the maximum number of UEs using the
PNI-NPN network simultaneously in restricted area. If the enterprise has one
or more CAG Identifiers, the maximum number of UEs can be calculated per CAG
Identifier.
For the PNI-NPN with CAG scenarios, it is important for NPN-OP to collect
number of UEs per CAG Identifier of vertical industry customers for the
purpose of charging or statistics. In addition, NPN-OP can perform tiered
charging for different number of UEs threshold.
The potential charging requirements for this UC are: REQ-eNPN_CH_PNI-
NPN_AC-03, REQ-eNPN_CH_PNI-NPN_AC-04.
#### 6.1.1.3 Use case #1c: Converged charging for number of PDU sessions
The maximum number of PDU sessions, corresponding to the maximum number of PDU
sessions associated with CAG Identifier, represents the maximum number of PDU
sessions supported by the PNI-NPN network in restricted area. If the
enterprise has one or more CAG Identifiers, the maximum number of PDU sessions
can be calculated per CAG Identifier.
For the PNI-NPN with CAG scenarios, it is important for NPN-OP to collect
number of PDU sessions per CAG Identifier of vertical industry customers for
the purpose of charging or statistics. In addition, NPN-OP can perform tiered
charging for different number of PDU sessions threshold.
The potential charging requirements for this UC are: REQ-eNPN_CH_PNI-
NPN_AC-03, REQ-eNPN_CH_PNI-NPN_AC-05.
### 6.1.2 Potential charging requirements
**REQ-eNPN_CH_PNI-NPN_AC-01:** The 5G system should support converged charging
per UE for PNI-NPN network access and usage.
**REQ-eNPN_CH_PNI-NPN_AC-02:** The 5G system should support converged charging
per vertical industry consumer for PNI-NPN network access and usage.
**REQ-eNPN_CH_PNI-NPN_AC-03:** The 5G system should support converged charging
per CAG Identifier for PNI-NPN network access and usage.
**REQ-eNPN_CH_PNI-NPN_AC-04:** The 5G system should support converged charging
per CAG Identifier for PNI-NPN network access and usage, based on \"number of
UEs\".
**REQ-eNPN_CH_PNI-NPN_AC-05:** The 5G system should support converged charging
per CAG Identifier for PNI-NPN network access and usage, based on \"number of
PDU sessions\".
### 6.1.3 Key issues
This key issue is for investigating how to support converged charging for
access connection in PNI-NPN considering REQ-eNPN_CH_PNI-NPN_AC-01, REQ-
eNPN_CH_PNI-NPN_AC-02, REQ-eNPN_CH_PNI-NPN_AC-03, REQ-eNPN_CH_PNI-NPN_AC-04
and REQ-eNPN_CH_PNI-NPN_AC-05. This investigation covers the following:
\- **Key Issue #2a:** Identification of the charging information for converged
charging for PNI-NPN network access and usage;
\- **Key Issue #2b:** Identification of the main interactions with the NFs to
obtain the charging information;
\- **Key Issue #2c:** The charging mechanism supporting converged inter-
provider charging for PNI-NPN network access and usage.
### 6.1.4 Possible solutions
#### 6.1.4.1 Solution #1: End user charging for PNI-NPN network usage of
access
##### 6.1.4.1.1 General
The CAG information of the UE is included in the subscription as part of the
Mobility Restrictions as defined in clause 5.30.3 of TS 23.501 [2]:
\- an Allowed CAG list i.e. a list of CAG Identifiers the UE is allowed to
access; and
\- optionally, a CAG-only indication whether the UE is only allowed to access
5GS via CAG cells.
This solution #1 which _relying on_ 5G connection and mobility converged
charging architecture defined in TS 32.256 [11], with the extension of
including CAG Identifier(s) for PNI-NPN network access in registration
management charging per UE, addresses the Key Issue #2a and Key Issue #2b.
Figure 6.1.4.1.1-1: 5G connection and mobility converged charging
architecture\ defined in TS 32.256 [11]
In this solution, AMF collects charging information including CAG
Identifier(s) per UE registration to the 5GS, and the charging information for
end user usage of access in PNI-NPN network reported by AMF is obtained by
CHF.
The subclause below describes registration management charging. The following
scenarios specified in TS 32.256 [11] are supported:
\- PEC;
\- IEC;
\- ECUR.
For deregistration procedures, only PEC scenario is supported.
##### 6.1.4.1.2 General Registration -- PEC charging
The following figure 6.1.4.1.2-1 describes a Registration charging message
flow in PEC charging applicable to:
\- Initial Registration in 5GS;
\- Mobility Registration Update;
\- Periodic Registration Update; or
\- Emergency Registration.
Figure 6.1.4.1.2-1: Registration -- PEC charging
1-14c. Registration procedure initiated by UE.
10: The new AMF notifies the old AMF that the registration of the UE in the
new AMF is completed.
14d: If necessary, the old AMF is requested by UDM to delete Registration
Management contexts and PDU Sessions.
14dCh: The old AMF interacts with the CHF as per deregistration procedure
described in figure 6.1.4.1.5-1.
21\. The AMF verifies whether UE access is allowed by Mobility Restrictions as
defined in TS 23.501 [2]. Upon successful procedure, Registration Accept sent
to the UE.
21ch-a. The AMF sends Charging Data Request [Event] including CAG
Identifier(s) to CHF for the UE successful registration.
21ch-b. The CHF creates the CDR for this registration.
21ch-c. The CHF acknowledges by sending Charging Data Response [Event] to the
AMF.
##### 6.1.4.1.3 General Registration -- IEC
The following figure 6.1.4.1.3-1 describes a Registration charging message
flow in IEC, based on the clause 6.1.4.1.2 Registration description:
Figure 6.1.4.1.3-1: Registration -- IEC
1-14c. Registration procedure initiated by UE.
15-16: AM policy association procedure.
16ch-a. The AMF sends Charging Data Request [Event] including CAG
Identifier(s) to CHF for the UE registration to be granted authorization,
rated and accounted.
16ch-b. Account and Rating control by the CHF for the registration and CDR
creation.
16ch-c. The CHF acknowledges by sending Charging Data Response [Event] and the
AMF, granting authorization to the registration.
17 to 24. Same steps as in Figure 6.1.4.1.2-1.
##### 6.1.4.1.4 General Registration -- ECUR
The following figure 6.1.4.1.4-1 describes a Registration charging message
flow in ECUR, based on the clause 6.1.4.1.2 Registration description:
Figure 6.1.4.1.4-1: Registration -- ECUR
1-14c. Registration procedure initiated by UE.
15-16: AM policy association procedure.
16ch-a. The AMF sends Charging Data Request [Initial] including CAG
Identifier(s) to CHF for the UE registration to be granted authorization.
16ch-b. Account and Rating control by the CHF for the registration and open a
CDR.
16ch-c. The CHF acknowledges by sending Charging Data Response [Initial] and
the AMF, granting authorization to the registration.
17 to 21. Same steps as in Figure 6.1.4.1.2-1.
21ch-a. The AMF sends Charging Data Request [Termination] including CAG
Identifier(s) to CHF for the UE successful registration.
21ch-b. The CHF closes the CDR for this registration.
21ch-c. The CHF acknowledges by sending Charging Data Response [Termination]
to the AMF.
##### 6.1.4.1.5 Deregistration -- PEC charging
The Deregistration message flows are applicable to:
\- UE-initiated deregistration
\- Network-initiated Deregistration.
The following figure 6.1.4.1.5-1 describes a UE-initiated deregistration in
PEC charging, based on figure 5.2.2.2.8.1 of TS 32.256 [11] description:
Figure 6.1.4.1.5-1: UE-initiated Deregistration -- PEC charging
1\. Deregistration procedure initiated by UE.
1ch-a. The AMF sends Charging Data Request [Event] including CAG Identifier(s)
to CHF for the UE deregistration.
1ch-b. The CHF creates the CDR for this deregistration.
1ch-c. The CHF acknowledges by sending Charging Data Response [Event] to the
AMF.
7: The AMF sends NAS message Deregistration Accept to UE. In case of
Deregistration type is switch-off, the Deregistration Accept message is not
sent.
The following figure 6.1.4.1.5-2 describes a Network-initiated Deregistration
in PEC charging, based on figure 5.2.2.2.8.2 of TS 32.256 [11] description:
Figure 6.1.4.1.5-2: Network-initiated Deregistration -- PEC charging
1\. AMF receives Nudm_UECM_DeregistrationNotification from UDM.
2\. Deregistration Request sent towards the UE. In case of Implicit
Deregistration, the Deregistration Request message is not sent.
2ch-a. The AMF sends Charging Data Request [Event] including CAG Identifier(s)
to CHF for the UE successful deregistration.
2ch-b. The CHF creates the CDR for this deregistration.
2ch-c. The CHF acknowledges by sending Charging Data Response [Event] to the
AMF.
[3-8]. Deregistration procedure steps.
#### 6.1.4.2 Solution #2: Converged charging for number of UEs
##### 6.1.4.2.1 General
This solution #2, charges vertical industry customer when \"Number of UEs\"
threshold for the CAG Identifier is reached or \"maximum number of UEs\" for
the CAG Identifier is reached, which addresses the Key Issue #2a, Key Issue
#2b and Key Issue #2c.
##### 6.1.4.2.2 Architecture description
A new NF NPNACF (Non-Public Network Admission Control Function) is introduced
to the solution. The converged charging architecture for NPNACF (CTF) based
solution as depicted in figure 6.1.4.2.2-1 is proposed for converged charging
for number of UEs per CAG Identifier.
Figure 6.1.4.2.2-1: NPNACF (CTF) converged charging architecture
##### 6.1.4.2.3 Procedures description
The figure 6.1.4.2.3-1 describes the high-level charging procedure for NPNACF
(CTF) based converged charging.
Figure 6.1.4.2.3-1: NPNACF (CTF) based converged charging
0ch. CHF obtains the \"maximum number of UEs\" per CAG Identifier.
1\. The NPNACF is configured per CAG Identifier, with \"maximum number of
UEs\" and a set of \"Number of UEs\" intermediate thresholds (downwards and
upwards triggers) under the \"maximum number of UEs\".
2\. Number of UEs per CAG Identifier availability check and update procedure.
2ch-a: For a CAG Identifier one \"Number of UEs\" threshold is reached or
\"maximum number of UEs\" is reached.
2ch-b: The NPNACF sends Charging Data Request to CHF for reporting number of
UEs for the CAG Identifier.
2ch-c. Account and rating control based on number of UEs for the CAG
Identifier.
2ch-d. CHF provides response to NPNACF by sending Charging Data Response.
NOTE : The support for controlling number of UEs per CAG Identifier is
dependent on SA WG2.
#### 6.1.4.3 Solution #3: Converged charging for number of PDU sessions
##### 6.1.4.3.1 General
This solution #3, charges vertical industry customer when \"Number of PDU
sessions\" threshold for the CAG Identifier is reached or \"maximum number of
PDU sessions\" for the CAG Identifier is reached, which addresses the Key
Issue #2a, Key Issue #2b and Key Issue #2c.
##### 6.1.4.3.2 Architecture description
A new NF NPNACF (Non-Public Network Admission Control Function) is introduced
to the solution. The converged charging architecture for NPNACF (CTF) based
solution as depicted in figure 6.1.4.2.2-1 is proposed for converged charging
for number of PDU sessions per CAG Identifier.
##### 6.1.4.3.3 Procedures description
The figure 6.1.4.3.3-1 describes the high-level charging procedure for NPNACF
(CTF) based converged charging.
Figure 6.1.4.3.3-1: NPNACF (CTF) based converged charging-IEC
0ch. CHF obtains the \"maximum number of PDU sessions\" per CAG Identifier.
1\. The NPNACF is configured per CAG Identifier, with \"maximum number of PDU
sessions\" and a set of \"Number of PDU sessions\" intermediate thresholds
(downwards and upwards triggers) under the \"maximum number of PDU sessions\".
2\. PDU session establishment procedure per TS 32.255 [12] clause 5.2.2.2.2
steps 1\~9.
3\. The SMF sends NumOfPDUsUpdate_Request to NPNACF. The NPNACF checks
availability and updates Number of PDU sessions per CAG Identifier.
3ch-a: For a CAG Identifier one \"Number of PDU sessions\" threshold is
reached or \"maximum number of PDU sessions\" is reached.
3ch-b: The NPNACF sends Charging Data Request to CHF for reporting number of
PDU sessions for the CAG Identifier.
3ch-c. Account and rating control based on number of PDU sessions for the CAG
Identifier.
3ch-d. CHF provides response to NPNACF by sending Charging Data Response.
4\. The NPNACF sends NumOfPDUsUpdate_Response to SMF.
5\. PDU session establishment procedure per TS 32.255 [12] clause 5.2.2.2.2
steps 10\~14.
NOTE : The support for controlling PDU sessions per CAG Identifier is
dependent on SA WG2.
#### 6.1.4.4 Solution #4: Converged charging for number of UEs or PDU sessions
using separate CCS
##### 6.1.4.4.1 General
This solution addresses the key issues #2a, 2b and 2c covering potential
requirements _REQ-eNPN_CH_PNI-NPN_AC-03 and REQ-eNPN_CH_PNI-NPN_AC-03 based
on_ distributed charging architecture split between two Converged Charging
Systems (CCS) _and exchanges between them_.
Two types of subscribers are considered in the context of NPN: the NPN-SC, and
the individual end-user \"UE\" served under the NPN. Each type of subscriber
is handled under a dedicated CCS: \"NPN CCS\" and \"UE CCS\" respectively.
UE CCS performs charging functionalities for individual UEs, and includes in
particular:
\- CHF exposing Nchf services associated to individual UEs.
\- ABMF/RF hosting individual UE account balance and subscribed services, as
well as the rates for services.
NPN CCS performs charging functionalities for NPN-SC, and includes in
particular:
\- CHF exposing Nchf services associated to individual NPN-SCs.
\- ABMF/RF hosting individual NPN-SC account balance and subscribed services,
as well as the rates for services.
How the account balance and subscribed services are provisioned (for both NPN-
SC and individual UE) is unspecified and expected to be covered at BSS and OSS
level.
A new reference point (ChX) is defined between CHF in NPN CCS and the CHF in
UE CCS enabling association between individual UE charging and NPN-SC
charging. This association is achieved by UE CCS responsible for individual UE
charging consuming this new charging service exposed by the NPN-SC CCS.
The new reference (ChX) may use the Nchf_ConvergedCharging service with
extensions or use a completely new Nchf service.
For UE:
\- the 5G data connectivity charging from SMF is specified in TS 32.255 [12];
\- the 5G connection and mobility charging from AMF is specified in TS 32.256
[11];
and uses Nchf_ConvergedCharging service exposed by CHF in UE CCS.
##### 6.1.4.4.2 Architecture description
Figure 6.1.4.4.2-1: Distributed charging architecture in reference point
representation
Figure 6.1.4.4.2-2: Distributed charging architecture in service based
representation
##### 6.1.4.4.3 Procedures description
The figure 6.1.4.4.3-1 describes the high-level charging procedure for UE PDU
session converged charging influenced by NPN converged charging using
distributed charging architecture.
Figure 6.1.4.4.3-1: UE PDU session converged Charging influenced by NPN
converged charging
1\. Steps according to TS 32.255 [12] clause 5.2.2.2.2 for individual UE
charging covered by UE CCS.
9ch1-a. **Charging data request [Initial]:** SMF (CTF) sends the request to
the UE CHF for the service to be granted authorization to start, and to
reserve the number of units if required.
**9ch1-b. Account, Rating, Reservation control:** UE CCS rates the requests
either based on the number of units requested or on internal unit
determination, if possible, the NPN CCS performs the corresponding reservation
of funds on the UE\'s account balance.
9ch1-c. **Determine NPN CHF:** UE CCS determines that the UE PDU session
charging needs input from NPN charging, the determination can for example be
based on CAG identifier.
9ch2-a. **Charging service request [Initial]:** UE CCS (acting like a CTF)
sends the request to the NPN CHF for the service to be granted authorization
to start, and to reserve the number of units if required.
**9ch2-b. Account, Rating, Reservation control:** NPN CCS rates the requests
either based on the number of units requested or on internal unit
determination, if possible, the NPN CCS performs the corresponding reservation
of funds on the NPN-SC\'s account balance. Examples of type of units could be
\"number of PDU sessions\", the number of units would always be one if there
is a one-to-one relationship between charging data request and charging
service request i.e., (the trigger for charging service request is reception
of a charging data request in the UE CCS).
9ch2-c. **Open CDR:** based on policies, the NPN CHF opens a CDR for the NPN-
SC related to the service.
**9ch2-d. Charging service response [Initial]:** The NPN CHF grants
authorization to UE CHF for the service to start, with the reserved number of
units e.g., \"number of PDU sessions\".
9ch1-d. **Open CDR:** based on policies, the UE CHF opens a CDR for the UE
related to the service.
**9ch2-e. Charging data response [Initial]:** The UE CHF grants authorization
to SMF (CTF) for the service to start, with the reserved number of units e.g.,
\"number of bytes\".
2\. PDU session establishment procedure per TS 32.255 [12] clause 5.2.2.2.2
from step 10.
The figure 6.1.4.4.3-2 describes the high-level charging procedure for UE
registration converged charging influenced by NPN converged charging using
distributed charging architecture.
Figure 6.1.4.4.3-2: UE Registration converged charging influenced by NPN
converged charging
1\. Steps according to TS 32.256 [11] clause 5.2.2.2.4 for individual UE
charging covered by UE CCS.
16ch1-a. **Charging data request [Initial]:** AMF (CTF) sends the request to
the UE CHF for the service to be granted authorization to start, and to
reserve the number of units if required.
**16ch1-b. Account, Rating, Reservation control:** UE CCS rates the requests,
if possible, the NPN CCS performs the corresponding reservation of funds on
the UE\'s account balance.
16ch1-c. **Determine NPN CHF:** UE CCS determines that the UE registration
charging needs input from NPN charging, the determination can for example be
based on CAG identifier.
16ch2-a. **Charging service request [Initial]:** UE CCS (acting like a CTF)
sends the request to the NPN CHF for the service to be granted authorization
to start, and to reserve the number of units if required.
**16ch2-b. Account, Rating, Reservation control:** NPN CCS rates the requests,
if possible, the NPN CCS performs the corresponding reservation of funds on
the NPN-SC\'s account balance. Examples of type of units could be \"number of
UE registrations\", the trigger for charging service request could be
reception of a charging data request in the UE CCS.
16ch2-c. **Open CDR:** based on policies, the NPN CHF opens a CDR for the NPN-
SC related to the service.
**16ch2-d. Charging service response [Initial]:** The NPN CHF grants
authorization to UE CHF for the registration to continue.
16ch1-d. **Open CDR:** based on policies, the UE CHF opens a CDR for the UE
related to the service.
**16ch2-e. Charging data response [Initial]:** The UE CHF grants authorization
to AMF (CTF) for the registration to continue.
2\. Registration procedure per TS 32.256 [11] clause 5.2.2.2.4 from step 17.
### 6.1.5 Evaluation
#### 6.1.5.1 Evaluation of possible solutions for end user charging for PNI-
NPN network usage of access
Solution #1 has proposed end user charging for PNI-NPN network usage of
access, enabling the AMF to collect charging information which including CAG
Identifier(s) per UE registration to the 5GS, and the charging information for
end user usage of access in PNI-NPN network reported by AMF is obtained by
CHF.
#### 6.1.5.2 Evaluation of possible solutions for converged charging for
number of UEs
Solution #2 and #4 propose solutions on converged charging for number of UEs.
The following table lists the characteristics of the two solutions.
Table 6.1.5.2-1: Comparison between Solution #2 and #4
+------------------------+------------------------+------------------+ | | NF controlling number | NF acts as a CTF | | | of UEs per PNI-NPN | | +========================+========================+==================+ | Solution #2: NPNACF | NPNACF | NPNACF | | (CTF) based converged | | | | charging for number of | (New NF) | | | UEs | | | +------------------------+------------------------+------------------+ | Solution #4: Separate | CHF | AMF | | CCS based converged | | | | charging for number of | (New NPN CCS) | | | UEs | | | +------------------------+------------------------+------------------+
The principles of solution #2 are inline with the NSACF charging of Network
Slicing in TR 32.847 [13], and the identification of the PNI-NPN can be based
on e.g. CAG Identifier.
The principles of solution #4, are inline the solution for network slice
charging based on 5G data connectivity in TS 32.255 [12] annex D.
#### 6.1.5.3 Evaluation of possible solutions for converged charging for
number of PDU sessions
Solution #3 and #4 propose solutions on converged charging for number of PDU
sessions. The following table lists the characteristics of the two solutions.
Table 6.1.5.3-1: Comparison between Solution #3 and #4
+------------------------+------------------------+------------------+ | | NF controlling number | NF acts as a CTF | | | of PDU sessions per | | | | NPI-NPN | | +========================+========================+==================+ | Solution #3: NPNACF | NPNACF | NPNACF | | (CTF) based converged | | | | charging for number of | (New NF) | | | PDU sessions | | | +------------------------+------------------------+------------------+ | Solution #4: Separate | CHF | SMF | | CCS based converged | | | | charging for number of | (New NPN CCS) | | | PDU sessions | | | +------------------------+------------------------+------------------+
The principles of solution #3 are inline with the NSACF charging of Network
Slicing in TR 32.847 [13], and the identification of the PNI-NPN can be based
on e.g. CAG Identifier.
The principles of solution #4, are inline the solution for network slice
charging based on 5G data connectivity in TS 32.255 [12] annex D.
### 6.1.6 Conclusion
Based on the evaluation in clause 6.1.5.1, solution #1 is the only solution
for end user charging for PNI-NPN network usage of access. The solution #1 is
selected to the normative work.
Based on the evaluation in clause 6.1.5.2, solution #2 needs support for
controlling number of UEs for PNI-NPN per CAG Identifier which is not
currently supported by SA WG2. Solution #4 needs support a new interface
between CHF in NPN CCS and CHF in UE CCS which is not currently supported, and
it also has some impact on PDU session establishment procedure in SMF, and
registration procedure in AMF, which require converged charging. It is
concluded that using converged charging mechanism for simultaneous number of
UEs per network slice to support converged charging for number of UEs per PNI-
NPN in normative work of release 18. It can solve a unique S-NSSAI is
allocated for one PNI-NPN. Multiple PNI-NPNs share the same S-NSSAI is not
supported in this release.
Based on the evaluation in clause 6.1.5.3, solution #3 needs support for
controlling number of PDU sessions for PNI-NPN per CAG Identifier which is not
currently supported by SA WG2. Solution #4 needs support a new interface
between CHF in NPN CCS and CHF in UE CCS which is not currently supported, and
it also has some impact on PDU session establishment procedure in SMF, and
registration procedure in AMF, which require converged charging. It is
concluded that using converged charging mechanism for simultaneous number of
PDU sessions per network slice to support converged charging for number of PDU
sessions per PNI-NPN in normative work of release 18. It can solve a unique
S-NSSAI is allocated for one PNI-NPN. Multiple PNI-NPNs share the same S-NSSAI
is not supported in this release.
## 6.2 Topic 2: Converged charging for data connectivity in PNI-NPN
### 6.2.1 Use cases
#### 6.2.1.1 Use case #1a: End user charging for PNI-NPN data connectivity
It is important for NPN-OP to collect usage for PNI-NPN data connectivity for
the purpose of charging or statistics.
The potential charging requirements for this UC are: REQ-eNPN_CH_PNI-
NPN_DC-01, REQ-eNPN_CH_PNI-NPN_DC-02.
### 6.2.2 Potential charging requirements
**REQ-eNPN_CH_PNI-NPN_DC-01:** The 5G system should support converged charging
per UE for PNI-NPN data connectivity.
**REQ-eNPN_CH_PNI-NPN_DC-02:** The 5G system should support converged charging
per vertical industry consumer for PNI-NPN data connectivity.
**REQ-eNPN_CH_PNI-NPN_DC-03:** The 5G system should support converged charging
per CAG Identifier for PNI-NPN data connectivity.
### 6.2.3 Key issues
This key issue is for investigating how to support converged charging for data
connectivity in PNI-NPN considering REQ-eNPN_CH_PNI-NPN_DC-01, REQ-
eNPN_CH_PNI-NPN_DC-02, and REQ-eNPN_CH_PNI-NPN_DC-03. This investigation
covers the following:
\- **Key Issue #2c:** Identification of the charging information collection
and reporting for converged charging for PNI-NPN data connectivity.
### 6.2.4 Possible solutions
#### 6.2.4.1 Solution #1: End user charging for PNI-NPN data connectivity
##### 6.2.4.1.1 General
This solution #1 which _relying on_ 5G data connectivity converged charging
architecture defined in TS 32.255 [12], with the extension of including CAG
Identifier(s) for PNI-NPN network data connectivity charging per UE, addresses
the Key Issue #2c.
##### 6.2.4.1.2 Reference architecture
In this solution, SMF collects charging information including CAG
Identifier(s) per UE, and the charging information for end user charging for
PNI-NPN data connectivity reported by SMF is obtained by CHF.
Figure 6.2.4.1.2-1: 5G data connectivity converged charging architecture\
defined in TS 32.255 [12]
##### 6.2.4.1.3 Message flows
The message flows are the same with the 5G data connectivity per PDU session
charging specified in the TS 32.255 [12].
SMF reports the Charging Data Request contains CAG Identifier(s) to the CHF in
the PNI-NPN.
### 6.2.5 Evaluation
Solution #1 has proposed end user charging for PNI-NPN data connectivity,
enabling the SMF to collect charging information which including CAG
Identifier(s) per UE, and the charging information for end user charging for
PNI-NPN data connectivity reported by SMF is obtained by CHF. Solution #1
needs support for SMF to collect CAG Identifier(s) and needs support by CT
WG4. Solution #1 can solve a unique CAG Identifier(s) is allocated for one
PNI-NPN, but it does not support multiple PNI-NPNs sharing the same CAG
Identifier(s).
In addition to CAG Identifier(s), the charging information collected by SMF in
solution #1 can also be S-NSSAI or dedicated DNNs, or dedicated DNN and
S-NSSAI combination to identify PNI-NPN.
### 6.2.6 Conclusion
Based on the evaluation in clause 6.2.5, solution #1 is the only solution for
end user charging for PNI-NPN data connectivity. The solution #1 based on
S-NSSAI, dedicated DNNs, or a combination to identify PNI-NPN is selected to
the normative work, any other attribute is dependent on support from SMF.
# 7 Conclusions and recommendations
The functionality, architecture, and charging modes for Non-public networks as
the background are described in the present technical report. In addition, use
cases, potential charging requirements, key issues are identified and possible
solutions for SNPN and PNI-NPN are developed and evaluated. The present
document made conclusions on the following aspects:
\- Converged charging for data connectivity in SNPN, in clause 5.1.6;
\- Converged charging for access connection in SNPN, in clause 5.2.6;
\- Converged charging for data connectivity in PLMN, in clause 5.3.6;
\- Converged charging for access connection in PNI-NPN, in clause 6.1.6;
\- Converged charging for data connectivity in PNI-NPN, in clause 6.2.6.
To support converged charging for Non-public networks in normative work, it is
recommended to specify the requirements, architectures and solutions for the
aspects mentioned above based on the conclusions of the corresponding
solutions documented in clauses 5.1.6, 5.2.6, 5.3.6, 6.1.6 and 6.2.6 of the
present document.
#