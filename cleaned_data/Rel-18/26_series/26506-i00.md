# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# Introduction
# 1 Scope
The present document specifies the architecture for real-time media
communication. To support MNO and third-party services for real-time media, it
is specified the essential functionalities and interfaces. The primary scope
of this Technical Specification is the documentation of the following aspects:
\- A real-time media communication architecture mapped to the 5GS architecture
and any SA2 stage 2 architecture additions, with relevant core building
blocks, reference point, and interfaces to support modern operator and third-
party media services, based on the 5GMS architecture
\- Provide all relevant reference points and interfaces to support different
collaboration scenarios between 5G System operator and third-party media
communication service provider, including but not limited to an AR media
communication service provider.
\- Call flows and procedures for different real-time communication service
types,
\- Specify support for AR relevant functionalities such as split-rendering or
spatial computing on top of a 5G System based on this architecture
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document in the same
Release as the present document.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 26.998: \"Support of 5G glass-type Augmented Reality / Mixed
Reality (AR/MR) devices\".
[3] 3GPP TS 26.119: \"Media Capabilities for Augmented Reality\".
[4] 3GPP TS 26.113: \"Enabler for Immersive Real-time Communication\".
[5] 3GPP TR 26.930: \"Study on the enhancement for Immersive Real-Time
communication for WebRTC\".
[6] 3GPP TS 26.501: \"5G Media Streaming (5GMS); General description and
architecture\".
[7] 3GPP TS 23.558: \"Architecture for enabling Edge Applications\".
[8] 3GPP TS 38.321: \"NR; Medium Access Control (MAC) protocol
specification\".
[9] 3GPP TS 36.321: \"LTE; Medium Access Control (MAC) protocol
specification\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
Definition format (Normal)
**\ :** \.
**example:** text used to clarify abstract rules by applying them literally.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
Symbol format (EW)
\ \
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
AR Augmented Reality
EAS Edge Application Server
ECS Edge Configuration Server
EEC Edge Enabler Client
EES Edge Enabler Server
IETF Internet Engineering Task Force
ICE Interactive Connectivity Establishment
IMS IP Multimedia Subsystem
MCU Multi-point Control Unit
MR Mixed Reality
MSH Media Session Handler
MTSI Multimedia Telephony Service for IMS
NAT Network Address Translation
RTC Real-Time Media Communication
SDP Session Description Protocol
SFU Selective Forwarding Unit
STUN Session Traversal Utilities for NAT
TURN Traversal Using Relays around NAT
W3C World Wide Web Consortium
WebRTC Web Real-Time Communication
# 4 Real-time Media Communication Architecture
## 4.1 Overall architecture for Real-Time Media Communication (RTC)
Real-Time media Communication (RTC) over 5G system in the context of this
specification is defined as the delivery of delay-sensitive media from one
peer to another with support of 5G network. AR conversational service
described in TR 26.998 [2] is a typical use cases for RTC, which enables end-
users to directly communicate real-time media including AR/MR media contents
as specified in TS 26.119 [3]. As identified in clause 8.4 of TR 26.998, there
may be different options to enable such AR conversational service, for example
re-use of parts of MTSI such as the IMS data channel or 5G Media Streaming for
managed services.
The overall RTC architecture is shown in Figure 4.1-1 as below.
Figure 4.1-1: Real-time media communication (RTC) in 5G System
NOTE: The functions indicated by the yellow filled boxes are in scope of the
present document for RTC. The functions indicated by the grey boxes are
defined in 5G System specifications. The functions indicated by the blue boxes
are neither in scope of 5G RTC nor 5G System specifications.
The media data is exchanged between two or more RTC endpoints over 5G System.
The RTC endpoint is an endpoint configured by RTC architecture in the present
document. It is typically a UE, but an edge computing server can also be the
RTC endpoint. The Application Provider provides a RTC Aware-Application on the
UE to make use of RTC endpoint and network functions using interfaces and
APIs. RTC architecture provides the core functions and entities to support
WebRTC-based service over 5G System, two main functions are defined in trusted
DN.
\- RTC AF: An Application Function similar to that defined in TS 26.501 [6],
dedicated to real-time media communication
\- RTC AS: An Application Server dedicated to real-time media communication
NOTE: Both RTC AF and RTC AS in external DN are out of scope of the present
specification.
The detailed RTC architecture mapping to the overall high-level architecture
in Figure 4.1-1 is shown in Figure 4.1-2 below. Note that Figure 4.1-2
illustrates only the half portion of Figure 4.1-1 (the link from one RTC
endpoint to RTC AF and RTC AS), as the rest of portion is symmetric.
Figure 4.1-2: RTC General Architecture
NOTE1: Some of functions may not be required depending on the collaboration
scenario. Description of collaboration scenario and its architecture variant
are specified in Annex A.
NOTE2: The WebRTC framework is a WebRTC protocol stack and its implementation,
defined in W3C and IETF. Media codecs and other media processing functions are
specified in TS 26.119 [3].
NOTE3: Red ovals indicate API provider functions.
The subfunctions inside RTC AF, RTC AS, and RTC endpoint are defined in clause
4.2 and the interfaces shown in Figure 4.1-2 are defined in clause 4.3.
## 4.2 Functions and entities
### 4.2.1 General
This clause defines minimal and essential functions and extra functions and
entities may appear in some cases. The definitions of extra functions and
entities are specified in TS 26.113 [4] and TR 26.930 [5].
### 4.2.2 Provisioning function
The provisioning function may enable an application provider to perform
provisioning of the following functionalities:
\- QoS support provisioning for WebRTC sessions
\- Charging provisioning for WebRTC sessions
\- Collection of consumption and QoE metrics data provisioning related to
WebRTC sessions
\- Offering ICE functionality provisioning such as STUN and TURN servers
\- Offering WebRTC signalling servers provisioning, potentially with
interoperability to other signalling servers.
The provisioning function may not be relevant to all collaboration scenarios
and some of the 5G support functionality may be offered without application
provider provisioning.
NOTE: The integration/collocation of this RTC AF and WebRTC signalling
function is possible. Co-located WebRTC signalling function is able to act as
a RTC AF which is accessible to 5GC, and replace some of this RTC AF's
interfaces and APIs with WebRTC signalling function. For example, interfaces
and APIs between this RTC AF and UE will be replaced to avoid
concurrent/redundant requests from UE.
### 4.2.3 Configuration function
The configuration function stores WebRTC-related configuration information and
makes them accessible to the UE. It stores information and recommendations to
operate network-assisted WebRTC sessions over 5G system.
The configuration information may consist of static information such as the
following:
\- Recommendations for media configurations
\- Configurations of STUN and TURN server locations
\- Configuration about consumption and QoE reporting
\- Discovery information for WebRTC signalling and data channel servers and
their capabilities in static and/or dynamic way.
NOTE: The integration/collocation of this RTC AF and WebRTC signalling
function is possible. Co-located WebRTC signalling function is able to act as
a RTC AF which is accessible to 5GC, and replace some of this RTC AF's
interfaces and APIs with WebRTC signalling function. For example, interfaces
and APIs between this RTC AF and UE will be replaced to avoid
concurrent/redundant requests from UE.
### 4.2.4 RTC Media Session Handler (MSH)
The RTC MSH is an entity running on the UE, which assists with the 5G
integration of the WebRTC application. It exchanges, on behalf of the
application, information about the WebRTC sessions with the network.
The RTC MSH receives information about a new WebRTC session from the
application. It relays the information to the Network Support Function. It
also receives events and other network information about the WebRTC session
from the Network Support Function, which it may relay to the application.
In addition, one of subfunction in RTC MSH is the metric collection and
reporting. It executes the collection of QoS and QoE metrics measurements from
the WebRTC Framework and the WebRTC application and sends metrics reports to
the RTC AF for the purpose of metrics analysis or to enable potential
transport optimizations by the network.
### 4.2.5 Network support function
The support functionality includes the following:
\- Network Support Function receives information from the UE and/or other ASs
about a WebRTC session and its state
\- Network Support Function requests the network that QoS should be allocated
(or satisfied) for a starting or modified session
\- Network Support Function receives notification from the network about
changes to the QoS allocation for the ongoing WebRTC session
\- Network Support Function exchanges information about the WebRTC session
with the trusted STUN/TURN/Signalling function, e.g. to identify a WebRTC
session and associate it with a QoS template.
NOTE: The integration/collocation of this RTC AF and WebRTC signalling
function is possible. Co-located WebRTC signalling function is able to act as
a RTC AF which is accessible to 5GC, and replace some of this RTC AF's
interfaces and APIs with WebRTC signalling function. For example, interfaces
and APIs between this RTC AF and UE will be replaced to avoid
concurrent/redundant requests from UE.
### 4.2.6 Trusted ICE functions
The MNO may offer trusted ICE functions to the WebRTC application to be used
during the WebRTC ICE gathering phase. These functions may be STUN and TURN
servers that facilitate NAT and firewall traversal.
The MNO-operated trusted ICE functions may assist with the 5G integration of
the WebRTC application. This could be done by triggering network assistance to
starting or ongoing WebRTC sessions.
### 4.2.7 Trusted WebRTC signalling function
The trusted WebRTC signalling function is used to setup and manage MNO-
operated WebRTC applications. They offer a standardized signalling protocol
for the session setup to both parties of the WebRTC session. The WebRTC
signalling function handles the offer/answer exchange and has an access to the
SDP in both directions.
The WebRTC signalling function may use that knowledge to offer network
assistance and other 5G features to the endpoints of the WebRTC session.
The WebRTC signalling function manages media flow sessions in both uplink and
downlink directions.
### 4.2.8 Trusted inter-working function
This function provides inter-working functionality to enable MNO-facilitated
WebRTC sessions that involve endpoints across different MNOs. They may for
example provide cross-network signalling functionality to allow WebRTC
signalling server that are hosted in different networks to communicate, in
order to establish and manage the WebRTC sessions.
### 4.2.9 Trusted transport gateway function
A transport gateway function may be offered by the MNO to support cross-
operator WebRTC sessions. It may offer the border control function for user
plane (e.g., topology hiding, IPv4-IPv6 translation) as a gateway, which is
located at the network boundary where different operators or third-party
network connects. It works under the control of the trusted inter-working
function.
Note: Detailed functionality is specified in TR 26.930 [5].
### 4.2.10 Trusted media function
A media server may be offered by the MNO to support WebRTC sessions. It may
offer a wide range of functionality such as:
\- a content server that serves content to the WebRTC application, e.g.
through a data channel
\- media processing functionality: may be used by the WebRTC application as a
relay that performs some media processing function such as transcoding,
recording, 3D reconstruction, etc.
\- scene composition functionality: the server may compose a 3D scene and
distribute it to several point-to-point WebRTC sessions
\- Multi-point Control Unit (MCU) functionality: the server may offer multi-
party conferencing functionality to merge a number of point-to-point WebRTC
sessions
\- Selective Forwarding Unit (SFU) functionality: the server may offer the
selection, copy, and forwarding functionality of IP steams produced by
multiple RTC endpoints (i.e., participants).
\- Maintain uplink and downlink flow context (QoS, remote control and etc.) by
interacting with the WebRTC signalling function.
### 4.2.11 Trusted application supporting web function
A web server may be offered by the MNO to support applications by providing
web service entry point, authorization/authentication, sharing files, or
scheduling conferencing sessions.
## 4.3 Interfaces
### 4.3.1 RTC-1: Provisioning interface
The RTC-1 interface allows the Application Provider to provision support for
RTC sessions that are offered by it. The provisioning may cover the following
aspects:
\- QoS support for WebRTC sessions
\- Charging provisioning for WebRTC sessions
\- Collection of consumption and QoE metrics data related to WebRTC sessions
\- Offering ICE functionality such as STUN and TURN servers
\- Offering WebRTC signalling function, potentially with interoperability to
other signalling servers
The provisioning interface is not relevant to all collaboration scenarios and
some of the 5G support functionality may be offered without application
provider provisioning.
### 4.3.2 RTC-3: RTC AS to RTC AF interface
The RTC AS may exchange information regarding the RTC session with the RTC AF.
This information may cover QoS flow information and QoS allocation as well as
QoE and consumption reports. The RTC AF may subscribe to information about the
status of the QoS flow, which it may share with the RTC AS, e.g. in form of
bitrate recommendations.
### 4.3.3 RTC-4: Media-centric transport interface
This interface is used to exchange the WebRTC traffic with the other endpoint
as well as to exchange signalling information related to the WebRTC session
with the trusted application servers.
The traffic includes:
\- Media streams sent over RTP
\- Application data sent over data channel
\- WebRTC Signalling data along with STUN and TURN servers
\- Other application data
RTC-4 may further be grouped into two sub-interfaces as follows.
**RTC-4s:**
The RTC-4s interface is an interface between the WebRTC framework and the RTC
AS such as WebRTC Signalling function. This interface is used for the exchange
of signalling information related to the WebRTC session between two or more
WebRTC endpoints using trusted application servers. In some cases where the
signalling is not handled by WebRTC framework, the RTC-4s interface is an
interface between the native WebRTC applications and the WebRTC Signalling
server.
**RTC-4m:**
This interface is used for transmission of media and other related data
between two or more RTC endpoints.
The traffic includes
\- Media data transmitted over RTP
\- Application data transmitted using Data channel
\- Media related meta-data transmitted using Data channel
NOTE 1: The Media Server should maintain the status for both uplink and
downlink traffic and a separate interface for supporting downlink and uplink
is expected to be defined in this specification.
NOTE 2: WebRTC-enabled UE should support streaming functions for uplink and
downlink traffic. Therefore a new entity in UE may be defined.
### 4.3.4 RTC-5: Control transport interface
The RTC-5 interface is an interface between the RTC MSH and the RTC AF. It is
used to convey configuration information from the RTC AF to the RTC MSH and to
request support for a starting/ongoing WebRTC session. The configuration
information may consist of static information such as the following:
\- Recommendations for media configurations
\- Configurations of STUN and TURN server locations
\- Configuration about consumption and QoE reporting
\- Discovery information for WebRTC signalling and data channel servers and
their capabilities
The support functionality includes the following:
\- RTC MSH receives the configuration information
\- RTC MSH informs the RTC AF about a WebRTC session and its state
\- RTC MSH requests QoS allocation for a starting or modified session
\- RTC MSH receives notification about changes to the QoS allocation for the
ongoing WebRTC session
\- RTC MSH receives the updated information about the WebRTC session with the
RTC STUN/TURN/Signalling function, e.g. to identify a WebRTC session and
associate it with a QoS template
The RTC functionality that offer application functions to the WebRTC
application may equally be provided by Application Servers (RTC AS) instead of
RTC AF. These then use a dedicated interface RTC-3 to request configurations
and network support for the ongoing WebRTC sessions from the RTC AF.
### 4.3.5 RTC-6: Client API
The RTC MSH is a function in the UE that provides access to RTC support
functions to the native WebRTC applications. These functions may be offered on
request, i.e., through the RTC-6 interface, or transparently without direct
involvement of the application. The RTC MSH may assist indirectly in the ICE
negotiation by providing a list of STUN and TURN server candidates that offer
RTC functionality. The RTC MSH also collects QoE metric reports and submits
consumption reports. It may also offer media configuration recommendations to
the application through RTC-6.
### 4.3.6 RTC-7: Client interface
This interface is similar in functionality to RTC-6. The difference lies in
the face that this interface may not be exposed as an API to application
developers but may be in form of a direct communication between the RTC MSH
and the WebRTC framework. The WebRTC framework hides away all details of the
QoS allocation and network support from the application. It autonomously and
transparently invokes the functions offered by the RTC MSH to provide support
for the RTC session.
### 4.3.7 RTC-8: Application interface
This is a proprietary interface between the application and the application
provider, which may be used to exchange configuration information related to
the RTC session or the application.
## 4.4 RTC Architecture extension
### 4.4.1 Introduction
This clause defines an architecture that enables a RTC Application Provider to
provision resources in the Edge Data Network (EDN) for an application through
the RTC-1 interface.
Media processing in the edge may be achieved in one of two different ways at
the application layer:
1\. Client-driven management. RTC Applications that are aware of the edge
processing can directly request an edge resource and discover the Edge
Application Server (EAS) that is best suited to serve the application.
2\. Application Function-driven management. The RTC AF automatically allocates
edge resources for new streaming sessions on behalf of the application using
information in the RTC provisioning session.
An Edge-enabled RTC Client leverages the Edge Computing capabilities as
defined in TS 23.558 [7].
### 4.4.2 Extended RTC architecture for Edge Computing
#### 4.4.2.1 General
The RTC architecture can be extended to add support for media processing in
the edge. The extended architecture is an integration of the RTC architecture
defined in TS 26.506 with the architecture for enabling Edge Applications
defined in TS 23.558 [7] and TS 26.501 [6].
The extended RTC architecture supports both client-driven as well as
Application Function-driven management of the edge processing session.
The RTC Application Provider may request the deployment of edge resources as
part of the Provisioning Session.
\- The RTC Application Provider provisions the edge provisioning through
RTC-1, a similar fashion as defined in TS 26.512 clause 7.10, enabling client-
driven and/or Application Function driven edge configuration.
\- In the client-driven approach, the WebRTC Application becomes aware of the
support of edge processing in the network and takes steps, such as using the
EDGE-5 APIs, to discover and locate a suitable RTC AS instance in the Edge DN,
similar to the process defined in TS 26.501 clause 8.1.
\- In the Application Function driven approach, the RTC Application Provider
requests RTC AF to deploy edge processing for the media sessions of the
corresponding Provisioning Session, similar to the process defined in TS
26.501 clause 8.2. The WebRTC Application may get aware of the deployed EAS
through the Application Service Provider through RTC-8 or through the RTC MSH
through RTC-5 (and possibly RTC-6). The EAS is provided together such that the
associated can be made by UE between two set of data. Additionally, the EAS
may also be discovered through other means, such as DNS resolution with
support from the DNS server (e.g., EASDF/DNS resolver) as specified in 3GPP TS
23.548 .
When the WebRTC application is a web application, the implementation of the
EDGE-5 interface to discover the RTC AS/EAS location by accessing the EEC is
difficult as the Web browser providers may not implement interfaces necessary
for supporting edge enabled RTC applications/services. Also, in the
Application Function-driven approach the Application Client (AC) and EEC are
not used to discover the RTC AS/EAS location.
To resolve the above EAS discovery issue in the Application Function-driven
approach and when the WebRTC application is a web application, the EAS
information can be shared with the RTC MSH by the RTC AF using RTC-5
interface.
NOTE: Other methods that can be used for sharing EAS information (e.g.,
sharing EAS hostname to the WebRTC application by RTC-8 or by other means and
then using DNS resolution) are FFS.
Figure 4.4.2-1: Edge-enabled RTC architecture
NOTE: This architecture diagram is an example for CS-2 scenario.
#### 4.4.2.2 Edge Application Server (EAS)
EAS is the application server resident in the EDN, performing edge-based
processing for AR functionalities such as split rendering and spatial
computing. The Application Client (AC) connects to the EAS in order to avail
the services of the application with the benefits of Edge Computing.
It is possible that the server functions of an application are available only
as an EAS.
However, it is also possible that certain server functions are available both
at the edge and in the cloud as an EAS and an Application Server resident in
the cloud.
The EAS can use the 3GPP Core Network capabilities in the following ways, all
of which are optional to support:
a) invoking 3GPP Core Network capabilities via the edge enabler layer through
the Edge Enabler Server (EES)
b) invoking 3GPP Core Network function (e.g., PCF) APIs directly, if it is an
entity trusted by the 3GPP Core Network; and
c) invoking the 3GPP Core Network capabilities through the capability exposure
functions, i.e., SCEF/NEF/SCEF+NEF.
The functions of Edge enabler Client (EEC), Edge Enabler Server (EES), Edge
Configuration Server (ECS) are as defined in TS 23.558 [7].
#### 4.4.2.3 Edge Interfaces
Based on the extended architecture, the following interfaces are defined for
performing edge-based processing for AR functionalities such as split
rendering and spatial computing:
1\. A RTC AF that is edge-enabled shall support EES functionality including:
\- EDGE-1 API for supporting registration and provisioning of EEC functions,
and discovery by them of EAS instances.
\- EDGE-3 API towards the EAS function of RTC AS instances.
\- EDGE-6 API for registering with an ECS function.
\- EDGE-9 API for media session relocation.
2\. A RTC AS that is edge-enabled shall support EAS functionality including
the EDGE-3 API for registration with the EES.
3\. A RTC MSH that is edge-enabled should support EEC functionality including:
\- Invoking the EES function using the EDGE‑1 API.
\- Invoking the ECS function using the EDGE‑4 API.
\- EDGE-5 API exposed to the Application Client.
4\. A WebRTC Application that is edge-enabled shall support Application Client
functionality and should invoke the ECS function using the EDGE‑5 API.
# 5 Procedures for basic RTC architecture
## 5.1 General
The RTC procedures that are defined in this clause are classified based on the
collaboration scenarios that are described in Annex A. Depending on the
scenario, only a subset of the functions that are defined in clause 4.2 may be
involved.
In general, the RTC call flow may consist of the following procedures.
\- Provisioning
\- Configuration
\- ICE candidates discovery
\- Session establishment
\- QoS request (either client-driven or WebRTC signalling function/server-
driven)
\- WebRTC traffic delivery
\- QoS updates
\- Session termination
## 5.2 Common Procedure
### 5.2.1 Provisioning
An application provider may use the RTC-1 interface to provision network
assistance and other resources for its RTC sessions.
This procedure is common to the different collaboration scenarios.
Figure 5.2.1-1: Provisioning procedure
### 5.2.2 Configuration
The Configuration procedure is used to pre-configure the RTC MSH with
information that it makes available to RTC applications through the RTC-6
interface.
This information includes the following:
\- The location and capabilities of trusted ICE functions
\- The location and capabilities of trusted WebRTC Signaling functions
\- The edge configuration as defined in clause 6.
The RTC MSH retrieves the configuration information from the RTC AF.
The configuration procedure is illustrated in Figure 5.2.2-1:
Figure 5.2.2-1: Configuration procedure
The steps are as follows:
1\. An ASP provisions resources for its RTC sessions
2\. A single retrieval of the configuration information is done:
a. The RTC MSH requests the configuration information for RTC sessions. It may
provide the application identifier to retrieve configuration information
specific to that application.
b. The RTC AF provides the requested configuration information.
The RTC MSH makes the information available to the Application through the
RTC-6 interface.
## 5.3 Call flow for Over-the-top (OTT) RTC sessions (CS#1)
The RTC session is established between two RTC endpoints using external
signalling mechanisms. Each endpoint of the connection that is using the 5G
system may benefit from 5G network support for the network path within that 5G
network.
The following call flow applies to this scenario.
Figure 5.3-1: Call flow for Over-the-top (OTT) RTC sessions (collaboration
scenario 1)
The working assumptions are:
\- The application on UE1 and the remote endpoint (e.g., UE2 or server for
edge computing) use an external WebRTC signalling function to establish the
WebRTC session.
0\. A provisioning session may have been created by the AP with the MNO.
Network assistance for the RTC session is achieved through the following
steps:
1\. The application on UE1 uses application-specific signalling functions to
establish a WebRTC session with remote endpoint.
2\. The application informs the RTC MSH about the new RTC session and shares
information about the media streams and their associated 5-Tuples.
3\. The RTC MSH requests network assistance for the RTC session and provides
the transport and bandwidth information to the Network Support AF.
4\. The Network Support AF uses the N5 or N33 interface to request QoS
allocation. It may request differential charging based on pre-existing
provisioning for these sessions.
5\. Confirmation of QoS allocation is notified to the Network Support AF and
the RTC MSH.
6\. The Network Support AF will also subscribe to events related to the QoS
flows of the RTC session with the PCF and SMF.
7\. The Network Support AF receives notifications about any changes to the QoS
flows of the RTC session from the PCF or the SMF.
8\. The Network Support AF sends notifications to the RTC MSH about changes to
the session. This information may contain for example be bitrate
recommendations.
9\. Alternatively, the MSH may interact with the UE Modem to trigger to query
the recommended bitrate on the uplink or downlink direction.
10\. The UE Modem then sends the ANBRQ (Access Network Bit Rate Query)
signalling to the RAN as defined in TS 38.321 [8] for NR access and TS
36.321[9] for LTE access.
11\. The RAN, based on the network status, returns the recommended bitrate to
the UE modem as requested. The recommended bit rate is in kbps at the physical
layer at the time when the decision is made.
NOTE 1: The UE may determine the corresponding IP layer bitrate based on the
long-term average of the IP packet sizes, L2 header sizes, and ROHC header
sizes, but the translation methodologies and the estimation error levels
required to implement accurate media bitrate adaptation have not been
specified. The UE may determine the corresponding IP layer bitrate based on
the long-term average of the IP packet sizes, L2 header sizes, and ROHC header
sizes, but the translation methodologies and the estimation error levels
required to implement accurate media bitrate adaptation have not been
specified.
NOTE 2: The eNodeB may determine the corresponding IP layer bitrate based on
the long-term average of the IP packet sizes, L2 header sizes, and ROHC header
sizes, but the translation methodologies and the estimation error levels
required to implement accurate media bitrate adaptation have not been
specified.
NOTE 3: The recommended/queried bitrate as signalled over the LTE and NR
access is defined to be in kbps at the physical layer. The uplink/downlink
bitrate at the physical layer is $r_{UL/DL} = \frac{\sum_{k}^{}L_{k}}{T}$,
where $L_{k}$is the bit-length of the _k_ -th successfully
transmitted/received TB by the UE within the window _T_. In TS 36.321[9] and
38.321[8], a window length of 2000 ms is applied.
12\. The RTC MSH forwards the bitrate recommendation to the RTC application.
13\. The application may act on the bitrate recommendation, e.g. by reducing
the uplink media bitrate.
14\. The application may request remote endpoint to adjust the bitrate of the
downlink media.
## 5.4 Call flow for Network-supported RTC sessions (CS#2)
The MNO offers access to trusted ICE functionality to UEs that wish to
participate in RTC sessions. The session establishment takes into account the
configured trusted ICE functions.
The call flow is as follows.
Figure 5.4-1: Call flow for Network-supported RTC sessions (collaboration
scenario 2)
The working assumptions are:
\- The application on UE1 and remote endpoint use an external WebRTC
signalling function to establish the WebRTC session.
0\. A provisioning session may have been created by the AP with the MNO.
Call flow using network-supported RTC session is achieved through the
following steps:
1\. The RTC AF uses the RTC-5 interface to provide the RTC MSH with a list of
trusted STUN/TURN servers that the UE may use for establishing RTC sessions.
2\. The application queries the RTC MSH for the list of trusted ICE servers.
3\. The UE discovers and tests the ICE candidates to validate that they are
suitable for the connection.
4\. The application on UE1 and the remote endpoint use an external RTC
signalling function to exchange information about ICE candidates and to
exchange the SDP offer/answer.
Then, the WebRTC session is established using the most suitable ICE candidate.
5\. The STUN or TURN server in ICE function, upon reception of the allocation
request by the application (or WebRTC framework) may extract the 5-Tuple
information for each of the media sessions and convey the information to the
Network Support AF in RTC AF for requesting QoS assistance.
6\. The Network Support AF uses the N5 interface to request QoS allocation. It
may request differential charging based on pre-existing provisioning for these
sessions.
7\. Confirmation of QoS allocation is notified to the Network Support AF and
the RTC MSH.
8\. The Network Support AF will also subscribe to events related to the QoS
flows of the WebRTC session with the PCF and SMF.
9\. The Network Support AF receives notifications about any changes to the QoS
flows of the WebRTC session from the PCF or the SMF. Then, the Network Support
AF sends notifications to the ICE function (STUN/TURN server).
10\. The STUN/TURN server may forward the bitrate recommendation to the RTC
MSH, if the allocation session is still active.
11\. Alternatively, the MSH may interact with the UE Modem to trigger to query
the recommended bitrate on the uplink or downlink direction.
12\. The UE Modem then sends the ANBRQ (Access Network Bit Rate Query)
signalling to the RAN as defined in TS 38.321 [8] for NR access and TS 36.321
[9] for LTE access.
13\. The RAN, based on the network status, returns the recommended bitrate to
the UE modem as requested. The recommended bit rate is in kbps at the physical
layer at the time when the decision is made.
NOTE 1: The UE may determine the corresponding IP layer bitrate based on the
long-term average of the IP packet sizes, L2 header sizes, and ROHC header
sizes, but the translation methodologies and the estimation error levels
required to implement accurate media bitrate adaptation have not been
specified. The UE may determine the corresponding IP layer bitrate based on
the long-term average of the IP packet sizes, L2 header sizes, and ROHC header
sizes, but the translation methodologies and the estimation error levels
required to implement accurate media bitrate adaptation have not been
specified.
NOTE 2: The eNodeB may determine the corresponding IP layer bitrate based on
the long-term average of the IP packet sizes, L2 header sizes, and ROHC header
sizes, but the translation methodologies and the estimation error levels
required to implement accurate media bitrate adaptation have not been
specified.
NOTE 3: The recommended/queried bitrate as signalled over the LTE and NR
access is defined to be in kbps at the physical layer. The uplink/downlink
bitrate at the physical layer is $r_{UL/DL} = \frac{\sum_{k}^{}L_{k}}{T}$,
where $L_{k}$is the bit-length of the _k_ -th successfully
transmitted/received TB by the UE within the window _T_. In TS 36.321[9] and
38.321[8], a window length of 2000 ms is applied.
14\. The application may act on the bitrate recommendation, e.g. by reducing
the uplink media bitrate.
15\. Media traffic is delivered to remote endpoint. If TURN server is present
in the configuration, RTC-4m interface is involved.
## 5.5 Call flow for MNO-Facilitated RTC sessions (CS#3)
In collaboration scenario 3, MNO hosts the WebRTC sessions by providing a
trusted WebRTC signalling function in the RTC AS. In addition, a trusted media
server is also present in RTC AS to support SFU and MCU functionality. Note
that, when the WebRTC application is a web-based application, the RTC MSH
function is not supported.
The call flows for this scenario when RTC MSH is involved are as shown in
Figure 5.5.1.
Figure 5.5.1: Call flows for MNO facilitated RTC sessions (collaboration
scenario 3)
The RTC Application Provider may create a **_Provisioning Session_** with the
RTC AF and starts provisioning the usage of the RTC Streaming session between
two endpoints. During the establishment phase, the used features such as
content consumption measurement, logging, collection and reporting; QoE
metrics measurement, logging, collection and reporting; dynamic policy;
network assistance; are negotiated and detailed configurations are exchanged.
The RTC Application Provider **_Provisioning_** **_Session_** phase is
optionally performed prior to the establishment of any related WebRTC sessions
by the RTC Application Provider. Detailed procedure is addressed in clause
5.2.1.
The **_ICE candidate discovery_** phase is performed with the following steps
in an MNO-facilitated RTC system:
1\. Configuration information: The RTC AF uses the RTC-5 interface to provide
the RTC MSH with a list of trusted STUN/TURN servers, trusted WebRTC
signalling function and data channel servers and their capabilities. The UE
may use this configuration information for establishing RTC sessions.
2\. ICE Servers request: The application queries the RTC MSH for the list of
trusted ICE servers.
3\. ICE candidate validation: The UE discovers and tests the ICE candidates to
validate that they are suitable for the connection.
The **_WebRTC session establishment_** phase is performed with the following
steps in an MNO-facilitated RTC system:
4\. Query configuration information: The WebRTC framework queries the RTC MSH
for the WebRTC signalling function information. In some cases where the
signalling is not handled by WebRTC framework, the native WebRTC application
queries the RTC MSH for the WebRTC Signalling server information.
5\. Configuration information: RTC MSH sends the WebRTC signalling function
and data channel servers and their capabilities information to WebRTC
framework or in some cases with native WebRTC application.
In **_SDP exchange_** phase, two or more WebRTC endpoints exchange signalling
information related to the WebRTC session such as ICE candidates, SDP
offer/answer using the trusted WebRTC signalling function.
NOTE: Figure 5.5.1 illustrates that SDP offer is generated by the WebRTC
Framework or native WebRTC Application. However, in SFU/MCU mode, SDP offer is
generated by Media Function in RTC AS.
_6\. SDP offer_ : The WebRTC Framework or native WebRTC Application creates a
request with SDP offer which includes the ICE candidates and sends it to the
WebRTC signalling function.
_7\. Determine_ remote endpoint _location_ : The WebRTC signalling function
uses the registration information to locate the remote endpoint
_8\. SDP offer_ : The WebRTC signalling function forwards the request to
remote endpoint.
_9\. SDP answer_ : Upon accepting the offer, remote endpoint responds to
signalling function with SDP answer.
_10\. SDP answer_ : WebRTC signalling function sends the SDP answer to the
UE1.
With this, a WebRTC session is established between RTC endpoints using the
most suitable ICE candidate and the WebRTC signalling function.
The **_Dynamic policy_** phase is then performed to allocate QoS for the media
streams of the RTC session with the following steps:
_11\. QoS request_ : The WebRTC signalling function sends a request to RTC AF
for the allocation of QoS for the session. The RTC AF sends a request to the
PCF to allocate QoS for the media streams of the RTC session
_12\. Confirmation_ : PCF or SMF confirms the successful allocation of network
support or QoS allocation.
If the Network support function feature is supported in the RTC AF, then the
Network Support Function AF (NS-AF) offers the bitrate recommendation request
API based on existing policy templates, through the usage of either the
_Npcf_PolicyAuthorization_ API over N5 interface, or the
_Nnef_AFSessionWithQoS_ over N33 interface to the PCF. If no corresponding AF
application session context already exists, the NS-AF uses the
_Npcf_PolicyAuthorization_Create_ method over N5 interface with the
appropriate service information to create and provision an application session
context. The **_Network assistance_** phase is performed with the following
steps in an MNO-facilitated RTC system.
_13\. Subscribe to QoS events_ : The NS-AF also subscribes to events related
to the QoS flows of the WebRTC session with the PCF and SMF.
_14\. QoS events_ : The NS-AF receives notifications about any changes to the
QoS flows of the WebRTC session from the PCF or the SMF.
_15\. QoS notifications/ Bitrate recommendations_ : The NS-AF may send
notifications to the RTC MSH about the changes in QoS flow. When the allocated
session is active, the RTC MSH forwards the bitrate recommendation to the
application.
_16\. Adjust media bitrate_ : The WebRTC application may act on adjusting the
bitrate recommendation, e.g., by reducing the uplink media bitrate.
After successful creation of a WebRTC session and the bitrate negotiations,
the actual **_WebRTC session_** over 5G may start:
17\. Media transfer:
a) The WebRTC Application may connect to the selected TURN server and/or Media
Function in the RTC AS through the RTC-4m interface and real-time
communication starts, and the media is delivered to the remote endpoint.
b) In some cases, a peer-to-peer connection is also possible and the media is
delivered directly to the remote endpoint.
18\. Method calls and notifications: Supporting information about the WebRTC
session is passed from the WebRTC framework to the RTC MSH.
19\. Reporting, network assistance, and dynamic policy: The RTC MSH exchanges
supporting information about the WebRTC session with the RTC AF.
20\. End session: The WebRTC Application informs the WebRTC framework that the
RTC session has ended. It is also sent to the WebRTC Signalling Function to
terminate the session.
21\. Session ending event: The WebRTC framework informs the RTC MSH about the
end of the RTC session.
22\. Final reporting: The RTC MSH performs any final reporting to the RTC AF.
# 6 Procedures for Edge Processing
## 6.1 Client-driven Management of RTC Edge Processing
The detailed call flow for client-driven management of edge processing session
is shown in Figure 6.1-1.
Figure 6.1-1. Client-driven management of RTC edge processing
The **_Edge Computing Provisioning_** phase is a provisioning phase, that may
be repeated several times (e.g., to extend edge processing coverage to new
geographical areas or to increase the capacity of an already provisioned
area). All steps in this phase are optional and performed on need basis. The
steps are:
1\. Spawn ECS: In this step, a new ECS instance is instantiated to manage new
or increased demand for edge processing.
2\. Spawn RTC AF: In this step, a new RTC AF that is edge-enabled is
instantiated to handle new or increased demand for WebRTC sessions with edge
processing.
3\. EES Configuration: The EES is configured for a specific Edge Data Network
(EDN).
4\. EES Registration with ECS: The EES registers with the ECS that is in
authority over the target EDN.
The **_RTC Application Provider Provisioning_** phase is performed prior to
the establishment of any related WebRTC sessions by the RTC Application
Provider. Subsequent updates to the provisioning session are possible.
5\. Create Provisioning Session: In this step, the RTC Application Provider
creates a new provisioning session.
6\. Provision RTC features: In this step, the RTC Application Provider may
create different configurations such as QoS support, charging, collection of
consumption, offering STUN/TURN servers, WebRTC signalling function, Edge
Processing, etc.
The WebRTC Application initiates a new RTC session:
7\. Application Initialization: The user launches the WebRTC Application. The
WebRTC application performs any required initialization steps.
8\. Start session: The WebRTC Application invokes the WebRTC framework with
appropriate real-time streaming access parameters.
9\. Session starting event: The application informs the RTC MSH about the
start of a new WebRTC session over 5G.
10\. Retrieve service access information: The RTC MSH retrieves Service Access
Information from the RTC AF appropriate to the WebRTC session.
11\. Determine eligibility for requesting edge resources: Using information
from the Service Access Information, the RTC MSH determines whether the WebRTC
session is eligible for requesting edge resources.
If the eligibility criteria are met in the previous step, the UE discovers an
EAS instance offering RTC AS functionality in the **_Client-based Edge
Computing Discovery_** phase:
12\. Locate EAS instances: The RTC MSH asks the EEC to discover the location
of one or more suitable EAS instances offering the RTC AS capability that can
serve the application.
13\. Locate local EES: The EEC queries the ECS for a suitable EES (EDGE-4
API).
14\. Register with EES: The EEC registers with the selected EES (EDGE-1 API).
15\. Request list of "RTC AS" EAS instances: The EEC queries the EES for one
or more EAS instances offering the "RTC AS" capability that can serve the
session, using EAS discovery filters (see Table 8.5.3.2-2 in [2]) provided by
the Application Client, e.g. "RTC AS" for EAS type, appropriate values for
service feature(s), and other EAS characteristics.
The optional sub-flow **_RTC AS Provisioning_** is for provisioning an
additional RTC AS instance if a suitable EAS instance offering the **\"** RTC
AS**\"** capability cannot be located. The steps are:
16\. Check resource template: The RTC AF checks the provisioned edge
processing resource template for the related application to determine the
requirements of the application.
17\. Instantiate new EAS/RTC AS: The RTC AF requests the MnS to instantiate a
new RTC AS EAS instance with the specified requirements and considering
parameters provided in the query by the EEC.
18\. Spawn RTC AS instance: The MnS creates a new instance of the EAS offering
RTC AS capability with the requested placement and resources.
19\. EAS configuration: The newly instantiated RTC AS EAS instance is
configured.
20\. Register EAS with EES: The newly instantiated EAS instance registers
itself with the triggering EES.
21\. Configure provisioned features: This may include configuring and
launching the server-side application in the RTC AS.
Completion of UE Edge Computing Discovery phase:
22\. List of suitable "-RTC AS" EAS instances: The EES/RTC AF responds to the
EEC with a list of "RTC AS" EAS instances and their characteristics in an EAS
discovery response (see Table 8.5.3.3-1 in [16]).
23\. Select preferred "RTC AS" EAS instance: The AC and/or EEC select(s) a
"RTC AS" EAS instance from the provided list, based on the AC's desired
criteria.
After successful discovery of a "RTC AS" EAS instance, the actual **_WebRTC
session_** over 5G may start:
24\. Media transfer: The WebRTC Application connects to the selected EAS "RTC
AS" and the real-time streaming starts.
25\. Method calls and notifications: Supporting information about the WebRTC
session is passed from the WebRTC framework to the RTC MSH.
26\. Reporting, network assistance, and dynamic policy: The RTC MSH exchanges
supporting information about the WebRTC session with the RTC AF.
27\. End session: The WebRTC Application informs the WebRTC framework that the
RTC session has ended.
28\. Session ending event: The WebRTC framework informs the RTC MSH about the
end of the RTC session.
29\. Final reporting: The RTC MSH performs any final reporting to the RTC AF.
## 6.2 AF-driven Management of RTC Edge Processing
The detailed call flow for AF-driven management of edge processing session by
using the RTC MSH is shown in Figure 6.2-1.
Figure 6.2-1. AF-driven management of RTC edge processing
The steps are:
1\. Steps 1-4 as described in TS 26.501 clause 8.1.
2\. Create Provisioning Session: In this step, the RTC Application Provider
creates a new provisioning session.
3\. Provision RTC features: In this step, the RTC Application Provider may
create different configurations such as QoS support, charging, collection of
consumption, offering STUN/TURN servers, WebRTC signalling function, edge
processing, etc.
4\. RTC AS provisioning if need, as described in Figure 6.1-1, steps 16-21.
The WebRTC Application initiates a new RTC session:
5\. Start session: The WebRTC Application invokes the WebRTC framework with
appropriate real-time streaming access parameters.
6\. Session starting event: The application informs the RTC MSH about the
start of a new WebRTC session over 5G.
7\. Retrieve Service Access Information: The RTC MSH retrieves Service Access
Information from the RTC AF appropriate to the WebRTC session.
8\. Determine eligibility for requesting edge resources: Using information
from the Service Access Information, the RTC MSH determines whether the WebRTC
session is eligible for requesting edge resources.
9\. Start the media streaming as defined in Figure 6.1-1, steps 24-26.
10\. Continue the final steps as defined in Figure 6.1-1, steps 27-29.
###### ## Annex A (normative): Architecture variants for collaboration
scenarios
# A.1 General
This clause addresses the derivative architecture for each of the
collaboration scenarios. The four collaboration scenarios are summarized below
and further details is specified in Annex A.
The four collaboration scenarios are specified based on the location of
required functional entities in trusted domain as defined as follows.
\- 5G support for OTT WebRTC: in this scenario the WebRTC session runs
completely over the top. However, the MNO may offer support in form of QoS
allocation, bitrate recommendations, and QoE report collection based on
request by the UE.
\- MNO-provided trusted WebRTC functions: in this scenario the MNO offers
trusted support functions such as ICE servers to the WebRTC application on the
UE.
\- MNO-facilitated WebRTC services: the MNO hosts and facilitates WebRTC
sessions by providing a trusted WebRTC signalling function, which may also
offer 5G network assistance.
\- Inter-operable WebRTC services: collaboration scenario 3 is extended with
functions to support MNO to MNO inter-operability.
NOTE: Collaboration scenario 4 is in the scope of this specification. Some of
its details, which are not specified in the current version of the document,
will be specified, after the relevant works are finished.
The list of key functional entities in trusted domain differs from
collaboration scenarios as described in Table A.1-1.
Table A.1‑1: Mapping of key functions to each collaboration scenarios
Functions **Collaboration scenario 1** **Collaboration scenario 2**
**Collaboration scenario 3** **Collaboration scenario 4**
* * *
**Provisioning function** Optional Optional Optional Optional **Configuration
function** Optional Required Optional (maybe fulfilled by WebRTC signalling
function) Optional (maybe fulfilled by WebRTC signalling function) **RTC MSH**
Required Optional Optional Optional **Network support function** Required
Required Optional (maybe fulfilled by WebRTC signalling function) Optional
(maybe fulfilled by WebRTC signalling function) **Trusted ICE function** N/A
Required Optional Optional **Trusted WebRTC signalling function** N/A N/A
Required Required **Trusted media function** N/A Optional Optional Optional
NOTE: The collaboration scenario 3 may further split depending on the role of
MNO, as addressed in TR 26.930.
# A.2 Collaboration scenario 1:
Figure A.2-1 shows the architecture variant for the collaboration scenario 1
when the WebRTC session is completely running over the top. For this case,
many of WebRTC-related entities are not the scope of this specification.
However, Network Support Function is present in the trusted domain to support
QoS allocation, bitrate recommendations, and QoE report collection.
Figure A.2-1: Derivative RTC architecture for collaboration scenario 1
# A.3 Collaboration scenario 2:
Figure A.3-1 shows the architecture variant for the collaboration scenario 2
when MNO provides the trusted WebRTC functions such as ICE function. It also
contains the configuration function to support the network-assisted WebRTC
sessions over 5G system.
Figure A.3-1: Derivative RTC architecture for collaboration scenario 2
NOTE: RTC-4m interface is present only when the ICE function contains the TURN
server in this scenario.
# A.4 Collaboration scenario 3:
Figure A.4-1 shows the architecture variant for the collaboration scenario 3
when MNO hosts the WebRTC sessions by providing the trusted WebRTC signalling
server in RTC AS. In addition, trusted media server is present in RTC AS to
support SFU and MCU functionality.
Figure A.4-1: Derivative RTC architecture for collaboration scenario 3
# A.5 Collaboration scenario 4:
NOTE: This scenario is extended from collaboration scenario 3 by supporting
interoperability between multiple MNOs. The details are FFS.
#