# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
This Technical Report identifies and evaluates a set of potential improvements
and extensions, referred to as key topics. The key topics are
\- Content Preparation
\- Traffic Identification
\- Additional / New transport protocols
\- Uplink media streaming
\- Background traffic
\- Content Aware Streaming
\- Network Event usage
\- Per-application-authorization
\- Support for encrypted and high-value content
\- Scalable distribution of unicast Live Services
\- Network Slicing Extensions for 5G Media Streaming
\- 3GPP Service Handler and URLs
For each of the above key topics, the following objectives are identified:
1\. Document the above key topics in more detail, in particular how they
relate to the 5GMS Architecture and protocols.
2\. Study collaboration scenarios between the 5G System and Application
Provider for each of the key topics.
3\. Based on the 5GMS Architecture, develop one or more deployment
architectures that address the key topics and the collaboration models.
4\. Map the key topics to basic functions and develop high-level call flows.
5\. Identify the issues that need to be solved.
6\. Provide candidate solutions (including call flows) for each of the
identified issues.
7\. Coordinate work with other 3GPP groups e.g. SA2, SA3, SA5, and others as
needed.
8\. Coordinate work with external organizations such as DASH-IF, CTA WAVE,
ISO/IEC JTC29 WG3 (MPEG Systems), or IETF, as needed.
9\. Identify gaps and recommend potential normative work for stage-2 call
flows and possibly stage-3.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] Akamai Blog, \"A QUICk Introduction to HTTP/3\", April 2020,
https://developer.akamai.com/blog/2020/04/14/quick-introduction-http3
[3] Fielding, R., Nottingham, M., and J. Reschke, \"HTTP/1.1\", Work in
Progress, Internet-Draft, draft-ietf-httpbis-messaging-13, 14 December 2020,
http://www.ietf.org/internet-drafts/draft-ietf-httpbis-messaging-13.txt
[4] Belshe, M., Peon, R., and M. Thomson, Ed., \"Hypertext Transfer Protocol
Version 2 (HTTP/2)\", RFC 7540, May 2015, https://www.rfc-
editor.org/info/rfc7540
[5] draft-ietf-quic-http-34, \"Hypertext Transfer Protocol Version 3
(HTTP/3)\", February 2021
[6] D. Bhat, A. Rizk, and M. Zink, \"Not so QUIC: A Performance Study of DASH
over QUIC,\" NOSSDAV\'17: Proceedings of the 27th Workshop on Network and
Operating Systems Support for Digital Audio and VideoJune 2017 Pages 13--18
https://doi.org/10.1145/3083165.3083175
[7] AWS: \"Achieving Great Video Quality Without Breaking the Bank\",
Streaming Media June 2019,
[8] Netflix, \"Optimized shot-based encodes: Now Streaming!\", Netflix Blog,
May 2018, https://netflixtechblog.com/optimized-shot-based-encodes-now-
streaming-4b9464204830
[9] DASH-IF/DVB: \"Report on Low-Latency Live Service with DASH\", July 2017,
available here: https://dash-industry-
forum.github.io/docs/Report%20on%20Low%20Latency%20DASH.pdf
[10] DASH-IF: \"IOP Guidelines v5, Low-latency Modes for DASH\", available
here: https://dash-industry-forum.github.io/docs/CR-Low-Latency-Live-r8.pdf
[11] ISO/IEC 23009-1: \"Information technology --- Dynamic adaptive streaming
over HTTP (DASH) --- Part 1: Media presentation description and segment
formats\".
[12] IETF RFC 8673: \"HTTP Random Access and Live Content\".
[13] 3GPP TR 26.939: \"Guidelines on the Framework for Live Uplink Streaming
(FLUS)\".
[14] 3GPP TS 26.238: \"Uplink Streaming\".
[15] 3GPP TS 26.501: \"5G Media Streaming (5GMS); General description and
architecture\".
[16] 3GPP TS 26.512: \"5G Media Streaming (5GMS); Protocols\".
[17] ISO/IEC 13818-1:2019: \"Information technology --- Generic coding of
moving pictures and associated audio information --- Part 1: Systems\".
[18] SCTE 35 2020: \"Digital Program Insertion Cueing Message\",
https://www.scte.org/pdf-redirect/?url=https://scte-cms-resource-
storage.s3.amazonaws.com/SCTE-35-2020_notice-1609861286512.pdf
[19] ISO/IEC 23000-19:2020: \"Information technology --- Multimedia
application format (MPEG-A) ---Part 19: Common media application format (CMAF)
for segmented media\".
[20] ISO/IEC 23009-1:2019/DAMD1: \"Information technology --- Dynamic adaptive
streaming over HTTP (DASH) --- Part 1: Media presentation description and
segment formats --- Amendment 1: CMAF support, events processing model and
other extensions\".
[21] VSF TR-06-01:2020, \"RIST Simple Profile\",
https://vsf.tv/download/technical_recommendations/VSF_TR-06-1_2020_06_25.pdf
[22] VSF TR-06-02: \"RIST Main Profile\",
https://www.videoservicesforum.org/download/technical_recommendations/VSF_TR-06-2_2020_03_24.pdf
[23] 3GPP TS 23.501: \"System architecture for the 5G System (5GS)\".
[24] 3GPP TS 23.502: \"Procedures for the 5G System (5GS)\".
[25] 3GPP TS 29.517: \"5G System; Application Function Event Exposure Service;
Stage 3\".
[26] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
nodes; Stage 3\".
[27] IETF RFC 6733: \"Diameter Base Protocol\".
[28] 3GPP TS 29.514: \"5G System; Policy and Charging Control over Rx
reference point; Stage 3\".
[29] IETF RFC 7657: \"Differentiated Services (Diffserv) and Real-Time
Communication\", November 1995.
[30] IETF RFC 3168: \"The Addition of Explicit Congestion Notification (ECN)
to IP\", September 2001.
[31] C. Krasic, M. Bishop, and A. Frindell, Ed., draft-ietf-quic-qpack-21,
\"QPACK: Header Compression for HTTP/3\", Work in Progress, Internet-Draft, 2
February 2021.
[32] IETF RFC 9000: \"QUIC: A UDP-Based Multiplexed and Secure Transport\",
May 2021.
[33] IETF RFC 9001: \"Using TLS to Secure QUIC\", May 2021.
[34] IETF, RFC 9002: \"QUIC Loss Detection and Congestion Control\", May 2021.
[35] IETF RFC 5681: \"TCP Congestion Control\".
[36] M. Kuehlewind and B. Trammell, draft-ietf-quic-manageability-11,
\"Manageability of the QUIC Transport Protocol\", Work in Progress, Internet-
Draft, 30 June 2021.
[37] N. Cardwell et. al. \"BBR Updates: Internal Deployment, Code, Draft
Plans\", 9 March 2021,
https://datatracker.ietf.org/meeting/110/materials/slides-110-iccrg-bbr-
updates-00.pdf
[38] ETSI TS 103 799: \"Publicly Available Specification (PAS); DASH-IF
Content Protection Information Exchange Format\".
[39] ISO/IEC JTC1/SC29/WG11/N19062 23090‑8 FDIS: \"MPEG-I: Network-based Media
Processing --- Network-Based Media Processing Specification\".
[40] 3GPP TS 26.247: \"Transparent end-to-end Packet-switched Streaming
Service (PSS); Progressive Download and Dynamic Adaptive Streaming over HTTP
(3GP-DASH)\".[41] 3GPP TS 23.503: \"Policy and charging control framework for
the 5G System (5GS); Stage 2\".
[42] 3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".
[43] 3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs;
Stage 3\".
[44] 3GPP TS 29.122: \"T8 reference point for Northbound APIs\".
[45] 3GPP TS 29.512: \"5G System; Session Management Policy Control Service;
Stage 3\".
[46] 3GPP TS 26.803: \"5G Media Streaming (5GMS); Architecture extensions\".
[47] 3GPP TS 23.558: \"Architecture for enabling Edge Applications (EA)\".
[48] 3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to
support network data analytics services\".
[49] Tdoc S4-210723: \"Generic architecture for data collection and
reporting\", submission from BBC, Dolby Laboratories Inc., LM Ericsson and
Qualcomm Incorporated to SA4#114-e, May 19-28, 2021.
[50] Tdoc S2-2103267: \"Extension of Naf_EventExposure for observed service
experience data collection from UEs\", CR from InterDigital to SA2#144e, Apr
12-16, 2021.
[51] 3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia telephony;
Media handling and interaction\".
[52] Tdoc S2-2104496: \"Extension of Naf_EventExposure for observed service
experience data collection from UEs\", CR from Qualcomm Incorporated to
SA2#145e, May 17-28, 2021.
[53] 3GPP TS 26.118: \"Virtual Reality (VR) profiles for streaming
applications\".
[54] 3GPP TS 26.346: \"Multimedia Broadcast/Multicast Service (MBMS);
Protocols and codecs\".
[55] 3GPP TS 29.554: \"Background Data Transfer Policy Control Service; Stage
3\".
[56] 3GPP TS 28.530: \"Management and orchestration; Concepts, use cases and
requirements\".
[57] 3GPP TS 28.531: \"Management and orchestration; Provisioning\".
[58] 3GPP TS 28.532: \"Management and orchestration; Generic management
services\".
[59] 3GPP TS 28.533: \"Management and orchestration; Architecture framework\".
[60] 3GPP TS 28.540: \"Management and orchestration; 5G Network Resource Model
(NRM); Stage 1\".
[61] 3GPP TS 28.541: \"Management and orchestration; 5G Network Resource Model
(NRM); Stage 2 and stage 3\".
[62] 3GPP TS 28.542: \"Management and orchestration of networks and network
slicing; 5G Core Network (5GC) Network Resource Model (NRM); Stage 1\".
[63] 3GPP TS 28.543: \"Management and orchestration of networks and network
slicing; 5G Core Network (5GC) Network Resource Model (NRM); Stage 2 and stage
3\".
[64] 3GPP TS 28.545: \"Management and orchestration; Fault Supervision (FS)\".
[65] 3GPP TS 28.546: \"Management and orchestration of networks and network
slicing; Fault Supervision (FS); Stage 2 and stage 3\".
[66] 3GPP TS 28.552: \"Management and orchestration; 5G performance
measurements\".
[67] 3GPP TS 28.554: \"Management and orchestration; 5G end to end Key
Performance Indicators (KPI)\".
[68] 3GPP TS 23.434: \" Service Enabler Architecture Layer for Verticals
(SEAL); Functional architecture and information flows \".
[69] 3GPP TS 23.700‑99: \" Study in Network slice capability exposure for
application layer enablement (NSCALE)\".
[70] 3GPP TS 29.520: \" 5G System; Network Data Analytics Services; Stage 3\".
[71] 3GPP TR 23.700-40: \"Study on enhancement of network slicing; Phase 2\".
[72] 3GPP TS 26.531: "Data Collection and Reporting; General Description and
Architecture".
[73] 3GPP TR 26.802: \"Multicast Architecture Enhancement for 5G Media
Streaming\".
[74] IETF RFC 822: \"STANDARD FOR THE FORMAT OF ARPA INTERNET TEXT MESSAGES\",
August 13, 1982.
[75] IETF RFC 1521: \"MIME (Multipurpose Internet Mail Extensions)\",
September 1993.
[76] IETF RFC 2474: \"Definition of the Differentiated Services Field (DS
Field) in the IPv4 and IPv6 Headers\".
[77] IETF RFC 2475: \"An Architecture for Differentiated Services\".
[78] IETF RFC 3246: \"An Expedited Forwarding PHB (Per-Hop Behavior)\".
[79] IETF RFC 2597: \"Assured Forwarding PHB Group\".
> [80] S. Hurst, draft-hurst-quic-rtp-tunnelling: \"QRT: QUIC RTP
> Tunnelling\", Internet-Draft, Work in Progress.
>
> [81] J. Ott and M. Engelbart, draft-engelbart-rtp-over-quic: \"RTP over
> QUIC\", Internet-Draft, Work in Progress.
>
> [82] SRT Alliance, "Secure Reliable Transport (SRT) Protocol",
> https://github.com/Haivision/srt
>
> [83] M.P. Sharabayko and M.A. Sharabayko, draft-sharabayko-srt-over-quic-00
> ,"Tunnelling SRT over QUIC", Internet-Draft, Work in Progress, 28 July 2021.
>
> [84] Robin Marx, Luca Niccolini, Marten Seemann, draft-ietf-quic-qlog-main-
> schema-01, \"Main logging schema for qlog\", Internet-Draft, Work in
> Progress, 25 October 2021.
>
> [85] Robin Marx, Luca Niccolini, Marten Seemann, draft-ietf-quic-
> qlog-h3-events-00, \"HTTP/3 and QPACK event definitions for qlog\",
> Internet-Draft, Work in Progress, 10 June 2021.
>
> [86] Robin Marx, Luca Niccolini, Marten Seemann, draft-ietf-quic-qlog-quic-
> events-00, \"QUIC event definitions for qlog\", Internet-Draft, Work in
> Progress, 10 June 2021.
>
> [87] Roger Pantos and William May, Jr., \"HTTP Live Streaming\", RFC 8216,
> August 2017.
[88] 3GPP TR 26.925: \"Typical traffic characteristics of media services on
3GPP networks\".
[89] 3GPP TR 26.917: \"Multimedia Broadcast Multicast Services (MBMS) and
Packet-switchedStreaming Service (PSS) enhancements to support television
services\".
[90] \"DASH-IF WebRTC-based Streaming\", https://dashif.org/news/webrtc/
[91] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[92] IETF RFC 6750: \"The OAuth 2.0 Authorization Framework: Bearer Token
Usage\".
[93] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\".
> [94] 3GPP TS 26.531: \"Data Collection and Reporting; General Description
> and Architecture\".
>
> [95] 3GPP TS 26.532: \"Data Collection and Reporting; Protocols and
> Formats\".
>
> [96] 3GPP TS 26.511: \"5G Media Streaming (5GMS); Profiles, codecs and
> formats\".
>
> [97] ETSI TS 103 770: \"Digital Video Broadcasting (DVB); Service Discovery
> and Programme Metadata for DVB-I\".
[98] Android Developer Documentation: \"Handling Android App Links\",\
https://developer.android.com/training/app-links
[99] 3GPP TS 26.347: \"Multimedia Broadcast/Multicast Service (MBMS);
Application Programming Interface and URL\".
[100] ETSI TS 103 769: \"Digital Video Broadcasting (DVB); Adaptive media
streaming over IP multicast\".
[101] 3GPP TS 23.247: \"Architectural enhancements for 5G multicast-broadcast
services\".
> [102] 3GPP TS 29.558: \"Enabling Edge Applications; Application Programming
> Interface (API) specification; Stage 3\".
[103] IETF RFC 2045: \"Multipurpose Internet Mail Extensions Part One: Format
of Internet Message Bodies\".
[104] IETF RFC 3986: \"Uniform Resource Identifier (URI): Generic Syntax\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
## 3.2 Symbols
Void.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
CDN Content Delivery Network
DS Differentiated Service
EAS Edge Application Server
EES Edge Enabler Server
FAR Forward Action Rule
MAR Multi-Access Rule
NRF Network Repository Function
PDR Packet Detection Rule
PFCP Packet Forwarding Control Protocol
QER QoS Enforcement Rule
QLOG QUIC Logging
PHB Per-Hop Behaviour
PFD Packet Flow Description
SDF Service Data Flow
URL Uniform Resource Locator
URR Usage Reporting Rule
# 4 5G Media Streaming
The 5G Media Streaming architecture is defined in TS 26.501 [15].
Protocols and APIs are specified in TS 26.512 [16].
Profiles, codecs and formats are provided in TS 26.511 [96].
# 5 Key Topics
## 5.1 Introduction
This clause introduces several key topics related to 5G Media Streaming.
## 5.2 Content Preparation
### 5.2.1 Overview
[TS 26.501 [15] includes the high-level concept of content preparation and/or
modification within the 5G Media Streaming System. However, Content
Preparation has not yet been defined in detail in TS 26.512 [16]. The extent
of content preparation support (including. use- cases, functionalities and
features, and resulting formats) needed in the existing 5G Media Streaming
Architecture, and how these functions can be realized in with current 5GMS
architecture are subject of this study.]
Content preparation may be applied in the following scenarios:
> 1\. In uplink streaming: on an uplinked stream, providing the resulting
> content to Application Provider.
>
> 2\. In downlink streaming: on an input stream from an Application Provider,
> providing the resulting content for distribution.
>
> 3\. Between uplink and downlink streaming: on an uplink stream, providing
> the resulting content for distribution.
Two aspects are of relevance for the discussion on Content Preparation:
> \- Uplink ingest content formats and protocols
>
> \- Content preparation instructions
On uplink ingest formats, a survey of existing formats is needed to understand
the available options. Examples include
> 1) MPEG-2 Transport Stream [17] with SCTE metadata [18].
>
> 2) CMAF content [19] with timed metadata tracks.
>
> 3) CMAF content [19] with a manifest such as the MPD [20].
>
> 4) Reliable Internet Stream Transport (RIST) is an open source, open
> specification transport protocol designed for reliable transmission of video
> over lossy networks (including the internet) with low latency and high
> quality. It is currently under development under the Video Services Forum\'s
> \"RIST Activity Group.\" To date, two open specifications have been
> produced:
>
> a. TR-06-1 (RIST Simple Profile) [21], first released in 2018, defines the
> basic ARQ (Automatic Repeat Query) technology used to recover lost packets.
> It has been updated in 2020 to include an optional \"RTT Echo\" message that
> streamlines the process of configuring packet buffers.
>
> b. TR-06-2 (RIST Main Profile) [22], released in 2020, defines additional
> functions required for commercial applications, including stream encryption,
> sender/receiver authentication, in-band data tunneling, and bandwidth
> optimization.
>
> 5) Secure Reliable Transport (SRT) is an open-source video transport
> protocol maintained by the SRT Alliance [82].
### 5.2.2 Gap Analysis of 26.512
TS 26.512 [16] defines a very limited set of features for content preparation:
1\. The location for content preparation template provisioning.
2\. CRUD Operation for content preparation template.
The current specification neither defines the uplink ingest formats nor the
content preparation instructions.
### 5.2.3 Use-cases
#### 5.2.3.1 Basic CMAF/DASH/HLS multi-rate live streaming of user-generated
content
+----------------------------------------------------------------------+ | **Description** | | | | Kim is subscribed to an Application for live streaming of captured | | videos from her everyday life. Based on the previous number and | | diversity of Kim's usual audience (e.g. close friends), the | | Application/Application Provider has an "audience codecs-rates" | | profile which represents the typical number of streams based on | | Kim's previous streaming sessions and provides the corresponding | | Content Preparation Template to the MNO as Kim starts the session | | live stream session. | | | | While Kim is streaming a single stream through her device's uplink, | | the MNO processes the received content based on the Content | | Preparation Template and provides multi-rate tracks for | | distribution. | | | | If new users join Kim's streaming session which cannot be supported | | with the current codecs-rates, the Application/Application Provider | | may update the Content Preparation Template in the session, and the | | MNO updates the content preparation process accordingly. | +======================================================================+ | **Categorization** | | | | **Delivery: Live Streaming** | | | | **Device: Any device connected to the cell network** | +----------------------------------------------------------------------+ | **Preconditions** | | | | 1. On the device: | | | | > a. A 3GPP supported encoder is installed. | | > | | > b. UE is 5GMS capable. | | > | | > c. UE's Application is installed which supports 5GMS. | | | | 2. On the network: | | | | > a. The AS may or may not have resources for running a requested | | > content preparation with the update to the Content Preparation | | > Template and responds accordingly. | +----------------------------------------------------------------------+ | **Nominal Cost Analysis** | | | | The cost of service increases linearly with the number of uplink | | ingest streams. | | | | The cost of service increases less than linearly with the number of | | download streaming clients because the encoding and caching | | requirement are common to a large number of viewers. | +----------------------------------------------------------------------+ | **Potential Standardization Status and Needs** | | | | The Content Preparation Template is expected to define uplink ingest | | format(s) as well as the following instructions for content | | preparation: | | | | 1. Input characteristics. | | | | 2, Outputs characteristics. | | | | 3. The media processes and/or functionalities applied. | | | | 4. Mechanism for updating the content preparation template. | | | | Content preparation for CMAF streaming when the uplink ingest format | | in CMAF and output is CMAF content with DASH and HLS manifests for | | live and on-demand services. In this case, the Content Preparation | | Template should include the following: | | | | > 1\. Uplink ingest characteristics such as: | | > | | > a. Video characteristics | | > | | > b. Audio characteristics | | > | | > c. Format of the subtitle track(s) | | > | | > d. Metadata tracks and presence of media track events | | > | | > e. Ingest protocols | | > | | > 2\. Instructions such as: | | > | | > a. CMAF/DASH publishing profile | | > | | > b. Configuration of Switching sets: | | > | | > i. Ladder of bit rate/quality | | > | | > ii. The encoder configuration for each track | | > | | > iii. Nominal and maximum segment duration | | > | | > iv. Frequency and characteristics of random access and switching | | > points | | > | | > v. Initialization segment characteristics | | > | | > vi. Content protection scheme and encryption mode | | > | | > vii. Metadata and annotation such as roles, languages, ratings, | | > and accessibility | | > | | > viii. Metadata tracks associated with the switching set or | | > individual tracks | | > | | > ix. Media track events to be included in each track | | > | | > x. Chunk encoding for low latency streaming | | > | | > c. Period structure, splicing opportunities, and conditions | | > | | > d. 5GMSd AS URL exposed at M4 | | > | | > e. Segments Addressing modes | | > | | > f. Trick mode and thumbnail navigation tracks | | > | | > g. Service description | | > | | > h. Content splicing/ad opportunity signaling | | > | | > i. Subtitle generation from the uplink ingest audio track(s) | | > | | > j. Multi-language support (when audio tracks for two or more | | > languages are ingested). | | > | | > k. Manifest format, annotations, and metadata | +----------------------------------------------------------------------+
### 5.2.4 Collaboration Scenarios
#### 5.2.4.1 Content preparation before downlink streaming
In this collaboration, the 5GMSd Application Provider requests content
preparation for its stream before distribution. Figure 5.2.4.1-1 shows such a
scenario.
Figure 5.2.4.1-1: Content preparation before downlink streaming
In this case:
1\. The Application Provider defines the required content preparation and
requests the 5GMSd AF to create the process using the Content Preparation
Template (CPT) through M1d.
2\. The 5GMSd AF configures the 5GMSd AS according to the media
transformation(s) specified in the Content Preparation Template (M3d) and
responds to the Application Provider (M1d).
3\. The media is streamed from Application Provider to 5GMSd AS (M2d).
4\. The content is transformed by 5GMSd AS according to the Content
Preparation Template and provided for distributions (M4d).
5\. The Application Provider may update, retrieve, or destroy the Content
Preparation Template using M1d.
Editor's Note: How does _DistributionConfiguration_ relate to CPT? Does the
CPT define the initial/generic formats (such as HLS and DASH) and
_DistributionConfiguration_ defines a subset of it for distribution?
#### 5.2.4.2 Content preparation after uplink ingest streaming
In this collaboration, the 5GMSu Application Provider or 5GMSu Aware
Application requests content preparation for the uplink ingest stream and
delivery to 5GMSu Application Provider. Figure 5.2.4.2-1 shows such a
scenario.
Figure 5.2.4.2-1: Content preparation after uplink ingest streaming
In this case:
1\. The Application Provider defines the required content preparation and
requests the 5GMSu AF to create the process using the Content Preparation
Template (CPT) through M1u.
2\. The 5GMSu AF configures the 5GMSu AS according to the media
transformation(s) specified in the Content Preparation Template (M3u) and
responds to the Application Provider (M1u).
3\. The media is streamed from 5GMSu Client to 5GMSu AS (M4u).
4\. The content is transformed by 5GMSu AS according to the Content
Preparation Template and egested to the Application Provider (M2u).
5\. The Application Provider/Application may update, retrieve, or destroy the
Content Preparation Template using M1u/M5u.
#### 5.2.4.3 Content preparation between uplink ingest and downlink streaming
In this collaboration, the 5GMSu Application Provider requests content
preparation for the uplink ingest stream from one UE and before downlink
streaming to other UEs. Figure 5.2.4.3-1 shows such a scenario.
Figure 5.2.4.3-1: Content preparation after uplink ingest streaming
In this case:
> 1\. The Application Provider defines the required content preparation and
> requests the 5GMSd AF to create the process using the Content Preparation
> Template (CPT) through M1d.
>
> 2\. The 5GMSd AF configures the 5GMSd AS according to the media
> transformation(s) specified in the Content Preparation Template (M3d) and
> responds to the Application Provider (M1d).
>
> 3\. The 5GMSu AF configures the 5GMSu AS according to the media
> transformation(s) specified in the Content Preparation Template (M3u) and
> responds to the Application Provider (M1u).
>
> 4\. The content is transferred to 5GMSd AS and transformed according to the
> Content Preparation Template (I2). I2 is an implementation specific
> interface and is considered out of scope of this document.
>
> 5\. The content is streamed to the 5GSd Client from 5GMSd AS (M4d).
>
> 6\. The Application Provider/Application may update, retrieve, or destroy
> the Content Preparation Template (M1d).
NOTE 1: In the above steps, the I1 interface is not used for the simplicity.
In section 5.6, two alternative call flows are presented that use I1
interface. I1 is an implementation specific interface and is considered out of
scope of this document.
NOTE 2: In the deployment of this collaboration scenario, 5GMSu AS and 5GMSd
AS may be co-located and therefore the I2 interface is not exposed. Similarly,
5GMSu AF and 5GMSd AF may be co-located.
### 5.2.5 Deployment Architectures
Editor's Note: Based on the 5GMS Architecture, develop one or more deployment
architectures that address the key topics and the collaboration models.
### 5.2.6 Mapping to 5G Media Streaming and High-Level Call Flows
#### 5.2.6.1 Call flow for content preparation before downlink streaming
The call flow is shown in Figure 5.2.6.1-1.
Figure 5.2.6.1-1: High-level call flow for content preparation before downlink
streaming
Steps:
1\. The 5GMSd Application Provider creates a Provisioning Session with the
5GMSd AF (M1d).
2\. The 5GMSd Application Provider provisions the 5GMSd AF with one or more
Content Preparation Templates defining instructions for content preparation,
as well as the required output format(s) (M1d).
3\. The 5GMSd AF, based on the received Content Preparation Templates,
requests the 5GMSd AS to verify availability of resources for content
preparation (M3d, procedures not specified):
a. Syntax checking of Content Preparation Template(s).
b. Semantic validation of Content Preparation Template(s).
c. Basic assessment of 5GMSd AS resource availability implied by the Content
Preparation Template(s).
4\. The 5GMSd AF acknowledges to the 5GMSd Application Provider the successful
creation of Content Preparation Templates (M1d).
5\. The 5GMSd Application Provider provisions the 5GMSD AF with a Content
Hosting Configuration that references one or more Content Preparation
Templates created in step 2 above (M1d).
6\. The 5GMSd AF, based on the received Content Hosting Configuration,
requests the 5GMSd AS to confirm the availability of distribution resources
(M3d, procedures not specified).
7\. The 5GMSd AF acknowledges to the 5GMSd Application Provider the successful
creation of the Content Hosting Configuration (M1d).
8\. The 5GMSd Application Provider feeds the content to the 5GMSd AS (M2d).
9\. The 5GMSd Application Provider optionally provides the service access
information to the 5GMSd-Aware Application (M8d, out of scope)
If needed, steps 10--14 may optionally be executed:
10\. The 5GMSd-Aware Application requests the 5GMSd Application Provider to
use the service (M8d).
11\. The 5GMSd Application Provider provides the 5GMSd AF with updated Content
Preparation Template(s) (M1d).
12\. The 5GMSd AF, based on the modified Content Preparation Template(s),
requests an updated confirmation of downlink streaming resource availability
(M3d).
13\. The 5GMSd AF acknowledges to the 5GMSd Application Provider that the
Content Preparation Template(s) have been successfully updated (M1d).
14\. The 5GMSd Application Provider acknowledges to the 5GMSd AF the use of
the service (M8d).
The rest of the call flow concerns the 5GMS downlink streaming process:
15\. The 5GMS-Aware Application request the 5GMSd Client to start an uplink
streaming session (M6d/M7d).
16\. If Service Access Information was not provided in step 9, the 5GMSd
Client requests this information from the 5GSMd AF (M5d).
17\. The 5GMSd Client requests start of the downlink streaming session from
the 5GSMd AF (M5d).
> 18\. The 5GMSd AF requests instantiation of the content preparation process
> (M3d).
>
> 19\. The 5GMSd AS instantiates the media preparation process if it (or any
> of its parts) are not already running.
>
> 20\. The 5GMSd AF acknowledges the instantiation of the content preparation
> process (M3d).
Steps 18--20 are not needed if another user has already requested the content
and therefore the content preparation process is already running on the 5GMS
AS, or if this process was instantiated in earlier steps of the workflow (e.g.
in step 3 or step 12).
One use-case for steps 18--20 is when a user requests a content format that is
not included in the previously instantiated content preparation process. In
this case, 5GMSd AS may add new processes to the content preparation
processing to provide the requested content format.
> 21\. The downlink media streaming starts (M4d).
Finally:
22\. The 5GMSd AS releases its resources after observing a period of
interactivity.
NOTE: Step 22 is implementation-dependent.
#### 5.2.6.2 Call flow for content preparation after uplink streaming
The call flow is shown in Figure 5.2.6.2-1.
Figure 5.2.6.2-1: Call flow for content preparation after uplink streaming
Steps:
1\. The 5GMSu Application Provider creates a Provisioning Session with the
5GMSu AF (M1u).
2\. The 5GMSu Application Provider creates one or more Content Preparation
Templates defining instructions for content preparation, as well as the
required output format(s) (M1u).
3\. The 5GMSu AF, based on the received Content Preparation Templates requests
the 5GMSu AS to verify availability of content preparation and contribution
resources, e.g. to allocate 5GMSu content ingest and contribution egest
resources. (M3u, procedures not specified):
a. Syntax checking of Content Preparation Template.
b. Semantic validation of Content Preparation Template.
c. Basic assessment of 5GMSu AS resource availability implied by the Content
Preparation Template.
4\. The 5GMSu AF acknowledges to the 5GMSu Application Provider the successful
creation of Content Preparation Templates, as well as successful provisioning
of content preparation (M1u).
5\. The 5GMSu Application Provider optionally provides the service access
information to the 5GMSu-Aware Application (M8u, out of scope)
If needed, steps 6--10 may optionally be executed.
6\. The 5GMSu-Aware Application requests the 5GMSu Application Provider to
support impending reception of uplink streaming content (M8u)
7\. The 5GMSu Application Provider provides the 5GMSu AF with updated Content
Preparation Template(s) (M1u).
8\. The 5GMSu AF, based on the modified Content Preparation Templates,
requests an updated confirmation of uplink streaming resource availability
(M3u).
9\. The 5GMSu AF acknowledges to the 5GMSu Application Provider that the
Content Preparation Templates have been successfully updated (M1u).
10\. The 5GMSu Application Provider acknowledges to the 5GMSu AF the use of
the service (M8u).
The rest of the call flow concerns the 5GMS uplink streaming process:
11\. The 5GMSu-Aware Application request the 5GMSu Client to start an uplink
streaming session (M6/7u).
12\. If Service Access Information was not provided in Step 5, the 5GMSu
Client requests this information from the 5GSMu AF (M5u).
13\. The 5GMSu Client requests start of the uplink streaming session from the
5GSMu AF (M5u).
NOTE 1: Although the above step is defined by the stage 2 design in TS 26.501
[15], it is not realised in Release 16 by stage 3 procedures defined in TS
26.512 [16].
14\. The 5GMSd AF requests instantiation of the content preparation process
(M3u).
15\. The 5GMSd AS instantiate the media preparation process if it has not
started before (M3u).
16\. The 5GMSd AF acknowledges the instantiation of the content preparation
process (M3u).
Steps 14--16 may not be needed if the content preparation process has been
instantiated during earlier steps in the call flow (such as between 3 and 8).
17\. Uplink media streaming from the 5GMSu Client to the 5GMSu AS commences
(M4u).
18\. Media streaming egest from the 5GMSu AS to the 5GMSu Application Provider
(M2u) commences.
Finally:
19\. The 5GMSu AS releases its resources after observing a period of
interactivity. Note that this is implementation dependent.
NOTE 2: The 5GMSu Application Provider also sets up the M2u configuration
during the provisioning section. The details of such set-up are not shown in
the above call flow.
Editor's Note: The M2u configuration process is the subject of the uplink
streaming topic of this study.
#### 5.2.6.3 Baseline call flow for content processing between uplink
streaming and downlink streaming
Figure 5.2.6.3-1 shows the call flow for this scenario.
Figure 5.2.6.3-1: High-level call flow for content preparation\ between uplink
streaming and downlink streaming
Steps:
> 1\. Identical to steps 1--7 in 5.2.6.1-1.
>
> 2\. The 5GMS Application Provider creates a Provisioning Session with the
> 5GMSu AF (M1u).
>
> 3\. The 5GMSu AF requests the 5GMSu AS to confirm the uplink resources
> availability. (M3u, procedures not specified).
>
> 4\. The 5GMSu AF acknowledges to the 5GMSu Application Provider of the
> successful provisioning (M1u).
>
> 5\. The 5GMS Application optionally provides the service access information
> to the 5GMSu-Aware Application (M8u, out of scope).
6\. The 5GMS-Aware Application request the 5GMSu Client to start an uplink
streaming session (M6/7u).
7\. If Service Access Information was not provided in step 5, the 5GMSu Client
requests this information from the 5GSMu AF (M5u).
8\. The 5GMSu Client requests start of the uplink streaming session from the
5GSMu AF (M5u).
> 9\. The uplink media streaming starts (M4u).
>
> 10\. The 5GMSu AS streams the content to the 5GMSd AS (I2, not specified).
>
> 11\. The 5GMS Application Provider optionally provides the service access
> information to the 5GMSd-Aware Application (M8d, out of scope).
>
> 12\. Identical to steps 10--14 in 5.2.6.1-1.
>
> 13\. Identical to steps 15--21 in 5.2.6.1-1.
>
> 14\. The 5GMSu AS releases its resources after observing a period of
> interactivity.
NOTE 1: Step 14 is implementation-dependent.
> 15\. The 5GMSd AS releases its resources after observing a period of
> interactivity.
NOTE 2: Step 15 is implementation-dependent.
### 5.2.7 Potential open issues
#### 5.2.7.1 Open issues in collaboration scenario 1: Content preparation
before downlink streaming
**Open issue 1: Content Preparation Template information**
TS 26.512 [16] only mentions that the format of the Content Preparation
Template is identified by its MIME type. At least one format needs to be
defined for the instruction in Content Preparation Template for common
services such as multi-rate streaming.
**Open issue 2: Support of other protocols**
The current specification only supports HTTP pull and DASH-IF ingest. Other
protocols may need to be added.
**Open issue 3: Address translation for complex pull requests**
Figure 5.2.7.2-1 shows an example in which the content preparation takes
segments _n_ and _n+1_ from the upstream 5GMSd Application Provider and
combines them into one segment with double duration for delivery to the 5GMSd
Client. The goal could be to achieve higher compression efficiency for
distribution.
Figure 5.2.7.2-1: An example of a media distribution by pull
Steps:
1\. The 5GMSd Client requests a media segment http://cdn.com/segment123.mp4
through M4d.
2\. The requested URL is mapped in the Content Hosting distribution
configuration ("cdn.com" => "originprovider.com/video/" and transformation of
request URL using the rule {n} => {n, n+1}). Two separate requests are made
via M2d to the 5GMSd Application Provider for the following media segments:
\- http://originprovider.com/video/segment246.mp4
\- http://originprovider.com/video/segment247.mp4
3\. The 5GMSd Application Provider provides the two requested media segments
to the Content Preparation subfunction, which in turn merges the two segments
into one, delivers the output segment to the Cache.
4\. The Cache subfunction delivers the merged media segment to the UE via an
M4d response.
NOTE: It is assumed that the initialization segment is available for
initialization of the decoder in the content preparation module.
Table 7.6.3.1 1 in TS 26.512 [16] defines the content hosting configuration
resource. Each Content Hosting Configuration may include one or more
Distribution Configurations, each one with an optional Content Preparation
Template. However, the Content Hosting Configuration is currently allowed to
include only one Ingest Configuration.
The Ingest Configuration defines the input format for content preparation.
Currently, two ingest protocols are specified in clause 8.2 of [16]: HTTP
pull-based ingest and DASH-IF push-based. In the case of HTTP pull, if a
request is received in M4d that can't be satisfied, an HTTP pull request is
made through M2. The _PathRewriteRules_ currently defined in clause 7.6.3 of
[16] do not address step 2 of the above example (i.e. transforming one request
into two different requests).
#### 5.2.7.2 Open issues in collaboration scenario 2: content preparation
after uplink streaming
In addition of the above issues of collaboration scenario 1, the following
issues may be considered.
In this case, the content is delivered to the 5GMSu Application Provider
through M2u.
**Open issue 4: Egest protocols**
TS 26.512 [16] Table 8.1-1 defines the ingest protocols at M2d. But the egest
protocols for M2u are not defined. One possibility is use already defined
ingest protocols also as possible egest protocols. However, it must be
investigated whether the current definitions of these protocols are adequate
for egest.
Editor's Note: We recommend addressing this issue in uplink streaming topic of
this study.
**Open issue 5: Egest Configuration**
TS 26.512 [16] Content Hosting Configuration resource defines an Ingest
Configuration. It is not clear whether the same resource can be used for Egest
configuration and whether the parameters are adequate.
Editor's Note: We recommend addressing this issue in uplink streaming topic of
this study.
#### 5.2.7.3 Open issues in collaboration scenario 3: content preparation
between uplink and downlink
Since both uplink and downlink is used, the following issues should be
considered.
**Open issue 6: Signalling the connection between the uplink and downlink**
Assuming the previous issues are addressed, then the Content Hosting
Configuration resource for uplink and downlink would be separately used in M1u
and M1d. The uplink Content Hosting Configuration's egest configuration should
be aligned with the downlink Content Hosting Configuration's ingest
configuration as is shown in the following figure.
The following issues must be addressed:
1\. Is the protocol left to the network operator and only direct connection
between two Application Servers signalled?
2\. Is any (optional) standard protocol needed for the connection? If so,
which protocols?
3\. Are the current Ingest Configuration's (and its counterpart for Egest)
parameters adequate for setting up the connection between uplink and downlink?
4\. Do the connection configuration and 5GMS Application Server's addresses
need to be hidden from the 5GMS Application Provider?
### 5.2.8 Candidate Solutions
#### 5.2.8.1 Content Preparation Template requirements
##### 5.2.8.1.1 Unencrypted single CMAF track to single unencrypted CMAF
switching set
The Content Preparation Template must define the following parameters:
1\. The address/location of the input CMAF segments.
2\. Output CMAF switching set configuration:
a. _Output manifest parameters:_ The characteristics that are typically
described in a manifest such as an MPEG‑DASH MPD [11]. While these parameters
are per track, they can be described once if one or more of them are common
across tracks. Examples:
i. _Packaging parameters:_ Container profile, codec/profile/level, bit rate,
container profiles, maximum SAP period, start with SAP.
ii. _Video parameters:_ Width, height, sample aspect ratio, frame rate.
iii. _Audio parameters:_ sampling rate, audio channel configuration.
b. _Internal encoding parameters:_ The parameters used for encoding each track
that are not presented in the output manifest, such as bit rate control,
motion search area, and algorithm, CBR/VBR/Capped VBR encoding, use of
specific quality metrics.
i. Common encoding parameters (usually common in a codec/profile/level).
ii. Vendor-defined (implementation-specific) parameters.
#### 5.2.8.2 Content Preparation Template candidates
##### 5.2.8.2.1 CMAF input format candidate 1: DASH MPD manifest
In this case, the characteristics of the input CMAF track can be described by
a DASH MPD manifest in order to correctly initialise the media transcoder in
the Content Preparation subfunction of the 5GMS AS. The manifest may include
information such as codec/profile/level, as well as general characteristics of
the media, such as maximum segment duration, video width, height and frame
rate, the existence of any SEI messages and other metadata, the existence of
any events schemes, as well as the location of each segment in the input CMAF
track. In the case of uplink media streaming, where HTTP pull is used to egest
the transcoded segments via M2u, the manifest can even optionally define the
locations of CMAF segments on the 5GMSu AS.
##### 5.2.8.2.2 CMAF input format candidate 2: A new document format
A new document format can be used for describing the input CMAF segments. The
advantage of such a solution is when the same format is used for describing
the output CMAF formats.
##### 5.2.8.2.3 CMAF output format candidate 3: Extended manifest format
In this approach, a standard manifest format is used for describing the output
manifest parameters, but it is extended to also carry the internal encoding
parameters (both common and vendor-defined).
An example is to use MPEG‑DASH MPD format and add descriptors to the
adaptation set and/or representations for the internal encoding parameters.
Two classes of descriptors can be added:
1\. The common encoding descriptor per codec, carrying common parameters.
2\. Vendor-specific descriptors, carrying vendor-defined parameters.
Since the MPD essential and supplemental descriptor syntax allows different
scheme URIs to be defined, both of the above features can be expressed using
the same descriptor data type.
##### 5.2.8.2.4 CMAF output format candidate 4: Manifest with supplementary
encoding parameters document
In this approach, a standard manifest format is used to describe the output
manifest parameters and a separate document is used to describe the internal
encoding parameters.
An example is the following elements:
1\. MPEG‑DASH MPD format for output manifest parameters.
2\. A JSON document containing an array of objects that each include a DASH
Representation identifier referencing a Representation in the MPD. Each object
also includes encoding parameters for the Representation. The common encoding
parameters may be extended with vendor-specific parameters inside a child
object tagged with a URI that uniquely identifies the vendor.
For example, the MPD in Listing 5.2.8.2.4‑1 below has two representations: R1
and R2. (For simplicity the adaptation set is not shown.) The internal
encoding parameters document in Listing 5.2.8.4.‑2 has a JSON array containing
two elements. Each element refers to one DASH Representation in the MPD by its
_id_ attribute value. Each array element includes the encoding parameters for
the corresponding Representation. The second element includes a vendor-
specific encoding parameter that is signaled using the vendor URN. The other
items in that object are defined by the vendor.
Listing 5.2.8.2.4‑1: MPEG-DASH MPD
+------------------------------------+ | \ | | | | \ | | | | \ | | | | \ | +------------------------------------+
Listing 5.2.8.2.4‑2: Supplementary encoding parameters document in JSON format
+----------------------------------------------------------------------+ | [{ Rid = \'R1\'; search-window =64; frame-rate= 30; ...}; | | | | { Rid = \'R2\'; search-window =64; frame-rate= 60; | | {vendor=\'urn:companyA:encoding:CAE\', mode=\'segment-based\', | | context=\'sports\' ...}]; | +----------------------------------------------------------------------+
##### 5.2.8.2.5 CMAF output format candidate 5: A document defining both the
output manifest and encoding parameters
In this approach, a new document format is defined to describe both the
manifest output parameters and the internal encoding parameters.
An example of such a solution would be a JSON document containing an array of
objects that each include the following information:
1\. Output manifest parameters.
2\. Common internal encoding parameters.
3\. Vendor-specific internal encoding parameters tagged with the vendor's
identifier (such as a URI).
Another alternative would be to use the DASH Industry Forum's Content
Protection Information Exchange Format (CPIX) [38] and possibly extend it to
carry additional parameters that are needed.
#### 5.2.8.3 Combining the Content Preparation Template candidate solutions
Since both input, outputs and encoding information need to be provided in the
Content Preparation Template, the following solutions are possible for the
overall template by combining the candidate solutions described in clause
5.2.8.2 above:
1\. Single MPD:
a. One adaptation set with one input representation describing the input
according to 5.2.8.2.1
b. One adaptation set with multiple input representation describing the output
tracks according to 5.2.8.2.3
2\. A document consisting of two MPDs, with possibly a supplementary document:
a. One MPD describing the input according to 5.2.8.2.1 and
b. One of the following:
i. One MPD describing the outputs and encoding format according to 5.2.8.2.3,
or
ii. One MPD describing the outputs and one document describing the encoding
parameters according to 5.2.8.2.4.
3\. Single JSON document:
a. One item describing the input representation according to 5.2.8.2.2, and
b. An array of objects according to 5.2.8.2.5, each of which describes:
i. One output.
ii. The encoding parameter for that output.
#### 5.2.8.4 Combined CMAF input and output formats candidate: NBMP Workflow
Description Document
The NBMP Workflow Description Document (WDD) [39] can describe the entire
workflow. In this use case, the WDD describes the input format, as well as the
array of tasks/function instances, each of which defines the CMAF output track
as well as the encoding parameters for that track, as is shown in the
following figure:
Figure 5.2.8-1: Using NBMP WDD to describe CMAF content preparation
The NBMP WDD in this case describes the input CMAF as the input of workflow,
and the function, configurations, and output of each task. Since many features
of the NBMP specification are not used in this specific workflow, the WDD
features can be profiled to a suitable subset of descriptors defined by NBMP
in [39].
The NBMP specification allows so-called _function templates_ to be defined.
One way to simplify the support for NBMP by 5GMSd AS would therefore be to
define a function template for each Content Preparation Use Case. For example,
the 5GMS CMAF Content Preparation function template could define (among other
things):
1\. Input CMAF media profile using explicit description: MPEG‑DASH MPD or HLS
m3u8 playlist.
2\. The push/pull protocols for ingesting CMAF content at M2d.
3\. The required CMAF output formats.
4\. The transcoder's common and vendor-specific configuration parameters
5\. Multiple codec output.
6\. Reporting, monitoring and notification parameters for each transcoding
function.
Another advantage of the NBMP WDD format is that it can be used to describe
other Content Preparation use cases and therefore one single format may be
able to address several applications.
In this approach:
1\. A function reference template is created for the CMAF content preparation
2\. A profile of NBMP spec is defined to simplify the NBMP Workflow
requirements.
#### 5.2.8.5 Address translation for complex pull requests
Open issue 3 of 5.2.7.1 provide a gap in address translation. There are three
possibilities for addressing this gap:
1\. Keep _PathRewriteRules_ as is, and therefore exclude content preparation
cases with more than one input and/or with more complex translation to be used
with push protocol(s) only.
2\. Extend the current request URL transformation capabilities of the 5GMSd
Content Hosting feature.
3\. Keep _PathRewriteRules_ as is and include an additional (and more
sophisticated) address translation function as a part of the Content
Preparation subfunction of the 5GMSd AS.
Figure 5.2.8.5-1 shows the architecture for the third option above.
Figure 5.2.8.5-1: A candidate solution for the example of media distribution
by pull
Steps:
1\. The 5GMSd Client requests a media segment http://cdn.com/segment123.mp4
through M4d.
2\. The requested URL is mapped according to the _PathRewriteRules_ in the
Content Hosting distribution configuration and provided to the address
translator of the Content Preparation module.
3\. The address translator module transforms the received request into two
separate requests via M2d to the 5GMSd Application Provider for the following
media segments:
\- http://originprovider.com/video/segment246.mp4
\- http://originprovider.com/video/segment247.mp4
4\. The 5GMSd Application Provider provides the two requested media segments
to the Content Preparation subfunction, which in turn merges the two segments
into one, delivers the output segment to the Cache.
5\. The Cache subfunction delivers the merged media segment to the UE via an
M4d response.
NOTE: It is assumed that the initialization segment is available for
initialization of the decoder in the content preparation module.
### 5.2.9 Conclusion and recommendations
This study explored three deployment scenarios for content preparation:
1) content preparation before downlink distribution,
2) content preparation after uplink streaming, and
3) content preparation between uplink streaming and downlink distribution.
The call flows for all deployment scenarios are defined along with the gap
analysis of TS 26.512 in addressing those scenarios.
As this study shows, the use of the content preparation template is not
explained adequately in TS 26.501. Furthermore, TS 26.512 needs several
extensions to make the use content preparation template interoperable in
5GMSA.
The following extensions are recommended:
\- Inclusion of content preparation deployment scenarios and associated call
flows
## 5.3 Traffic Identification
### 5.3.1 Description
For different features like usage of QoS or different charging rules within
the 5G Media Streaming Architecture, it is necessary for the 5G System to
identify the traffic flows. The increased usage of transport encryption (e.g.
HTTPS) increases the difficulty of detecting the packets for certain
application flows. Existing detection methods, such as using "significant
parts of the URL to be matched" (contained in a Packet Flow Description, see
below), are impractical for HTTPS traffic, since the URL is carried in the
encrypted payload.
Multimedia streaming applications might not be able to uniquely identify the
5-tuple of the streaming session, since the 5-tuples are often changing. This
is due to factors such as load balancing, CDN distribution, multiple
concurrent requests for different types of resources, etc. This study will
address how to properly configure the 5G System to enable efficient detection
of application flows (service data flows) e.g. for event reporting, and QoS
profile usage, etc.
Note that the TS 23.50x specifications use different terminology from the TS
29.xxx specifications. Furthermore, TS 23.503 [41] uses slightly different
terms than TS 23.501 [23] and TS 23.502 [24]. The two common terms are defined
in TS 23.503:
**\- Packet flow:** A specific user data flow from and/or to the UE.
**\- Service data flow** : An aggregate set of packet flows carried through
the UPF that matches a service data flow template.
The terms _traffic detection_ [23] and _application detection_ [23] refer to
the process of finding matching service data flows among all packet flows.
This logic is defined in TS 23.503 as an _application detection filter_.
The procedures in TS 23.502 use the term _flow description_ , which is only a
subset of an _IP Packet Filter Set_ (as defined in TS 23.501).
Figure 5.3.1-1 depicts the chain of functions (taken from TS 29.244 [26],
Figure 5.2.1-1) within an UPF.
Figure 5.3.1-1: Packet processing flow in the UP function (Figure 5.2.1-1 from
TS 29.244 [26])
The steps are as follows:
1\. The UPF always first looks up the Packet Forwarding Control Protocol
(PFCP) session context to which a packet belongs. The PFCP session context is
an individual PDU session or a standalone PFCP session not tied to any PDU
session.
2\. Then there are so-called Packet Detection Rules (PDR), which implement
traffic detection of the service data flows with respect to different
conditions.
NOTE: A PDR is direction specific. Thus, an Uplink (UL) PDR and a Downlink
(DL) PDR are needed to detect a bidirectional Service Data Flow.
3\. Based on the PDR result, the next rules are executed, namely Multi-Access
Rule (MAR), Forward Action Rule (FAR), QoS Enforcement Rule (QER), and Usage
Reporting Rule (URR).
NOTE: Only the Forward Action Rule (FAR) is mandatory. The QoS Enforcement
Rule (QER) is only present for QoS Flows. The Usage Reporting Rule (URR) is
only available when traffic volume measurements (e.g. for charging) are
needed.
The Packet Detection Rule (PDR) is based on Service Data Flow Templates, which
contain one or more Service Data Flow (SDF) Filters or an Application
Identifier. An Application Identifier refers to one or more Packet Flow
Descriptions (PFDs).
A Service Data Flow (SDF) Filter contains for IP PDU Sessions a single IP
Packet filter, i.e. any combination of
\- Source/destination IP address or IPv6 prefix.
\- Source / destination port number.
\- Protocol ID of the protocol above IP/Next header type.
\- Type of Service (ToS) (IPv4) or Traffic class (IPv6) and Mask.
\- Flow Label (IPv6).
\- Security parameter index.
\- Packet Filter direction.
A PFD includes a PFD ID; and one or more of the following:
\- 3-tuple(s) comprising protocol, server-side IP address and port number.
\- the significant parts of the URL to be matched, e.g. host name.
\- a domain name matching criterion and information about applicable
protocol(s).
The application detection filter can be configured in the SMF and the SMF then
provides it in the Service Data Flow Template to the UPF. Alternatively, the
Service Data Flow Template for traffic handling in the UPF is received from
the dynamic PCC Rule.
Besides, the Management of Packet Flow Descriptions enables the UPF to perform
accurate application detection when PFD(s) are provided by an Application
Service Provider (ASP) and then to apply enforcement actions as instructed in
a PCC Rule.
The operator is able to configure pre-defined PCC Rules in the SMF or dynamic
PCC Rules in the PCF. A PCC rule includes either a list of Service Data Flow
filters or an application identifier for Service Data Flow detection. The PCC
rule further includes charging control information, i.e. charging key and
optionally a Sponsor identifier or an ASP identifier or both.
The application identifier references one or more PFDs, which are managed
using the PFD Management API. Depending on the service level agreements
between the operator and the Application Server Provider, it may be possible
for the ASP to provide to the SMF individual PFDs or the full set of PFDs for
each application identifier maintained by the ASP via the PFD Management
service in the NEF (PFDF). The PFDs become part of the application detection
filters in the SMF/UPF and are thereafter used as part of the logic to detect
traffic generated by an application. The ASP may remove or modify some or all
of the PFDs which have been provided previously for one or more application
identifiers. The SMF may report the application stop to the PCF for an
application instance identifier as defined in clause 5.8.2.8.4 of TS 23.501
[5] if the removed/modified PFD in SMF/UPF would result in an inability to
detect traffic for that application instance.
The ASP manages (i.e. provisions, updates, deletes) the PFDs through the NEF
(PFDF). The PFD(s) are transferred to the SMF through the NEF (PFDF). The PFDF
is a logical functionality in the NEF which receives PFD(s) from the ASP
through the NEF, stores the PFD(s) in the UDR and provides the PFD(s) to the
SMF(s) either on the request from ASP PFD management through NEF (PFDF) (push
mode) or on the request from SMF (pull mode). Finally, the PFDF functionality
is a service provided by the NEF.
The ASP may provide/update/remove PFDs with an allowed delay to the NEF
(PFDF). Upon reception of the request from the ASP, the NEF (PFDF) checks if
the ASP is authorized to provide/update/remove those PFD(s) and request the
allowed delay. The NEF (PFDF) may be configured with a minimum allowed delay
based on SLA to authorize the allowed delay provided by the ASP. When both the
requesting ASP and the requested allowed delay are successfully authorized,
the NEF (PFDF) translates each external Application Identifier to the
corresponding Application Identifier known in the core network. The NEF (PFDF)
stores the PDF(s) into the UDR.
The Application Identifier is simply an index to a set of application
detection rules configured in the UPF. It is an identifier that can be mapped
to a specific application traffic detection rule.
The procedure is depicted Figure 5.3.1‑2 below:
Figure 5.3.1‑2:
The PFD (Packet Flow Description) is a set of information enabling the
detection of application traffic.
Each PFD may be identified by a PFD ID. A PFD ID is unique in the scope of a
particular Application Identifier. Conditions for when a PFD ID is included in
the PFD are described in TS 29.551 [6]. There may be different PFD types
associated with an Application Identifier.
### 5.3.2 Collaboration Scenarios
#### 5.3.2.1 General Collaboration Scenarios
The 5GMSd Application Provider negotiates with the MNO an SLA to provide
differentiated treatment, including network QoS and charging for its 5GMSd-
Aware Application. Depending on the QoS needs and the connectivity realization
between the MNO network and the Data Network hosting the 5GMS function,
additional transport-level arrangements need to be considered. The SLA and
transport-level arrangements are outside the scope of 3GPP. The Application
Provider provides the necessary information to the MNO to detect the traffic,
to ensure its correct and exclusive identification. The MNO detects the
traffic correctly and applies the agreed traffic treatment.
Due to privacy concerns, the content hosting is provided by the Application
Provider in an external Data Network. However, the 5GMSd Application Provider
leverages the network features either via a 5GMSd AF in the external Data
Network (Figure 5.9.2‑1) or via a 5GMSd AF in the trusted Data Network (Figure
5.9.2‑2).
{width="6.460983158355206in" height="2.313449256342957in"}
Figure 5.9.2-1: Collaboration 1 (Collaboration 3 of TS 26.501)
{width="6.1083814523184605in" height="2.1871948818897637in"}
Figure 5.9.2-2: Collaboration 2 (Collaboration 4 of TS 26.501)
In order to use flow-based network features (such as different QoS classes or
different charging policies), the 5G System needs to detect the relevant
traffic.
#### 5.3.2.2 Differentiated Services/ToS-enabled Collaboration Scenarios
Differentiated Services (DS) [76, 77] is a scalable scheme for managing
application traffic by classifying the traffic into a set of coarse-grained
traffic classes. A Differentiated Service (DS) domain is a continuous set of
DS-capable routers, which are operated with a common set of configurations.
Each IP packet in a DS domain is marked and conditioned according to its
traffic class. A 6-bit DS Code Point (DSCP) of the 8-bit differentiated
services field (DS field) is used for marking. The DS field replaces the ToS
field in the IPv4 packet headers and the Traffic Class field in the IPv6
header.
End host systems may mark IP packets with a specific DSCP value prior to
transmission. DS-enabled routers treat the packet according to the DSCP value
when performing routing operations on it. Border gateway routers typically
mark packets with a DSCP value based on some traffic policy, overriding any
value set by hosts.
NOTE: Usage of Differentiated Services across administrative borders is
technically possible. The preservation of the DSCP field by networks between
the MNO network and the external Data Networks hosting the 5GMS functions is
assumed to be governed by an SLA and by transport-level arrangements that are
outside 3GPP scope. When the DSCP field is used only for traffic
identification, preservation of the DSCP field could be achieved by using a
tunnelling solution.
The RFCs defining Differentiated Services recommend a set of Per-Hop Behaviors
(PHB), namely:
\- Default Forwarding (DF) PHB, defined in section 4.1 of RFC 2474 [76], is
used for traffic without special treatment.
\- Class Selector PHB, defined in section 4.2.2.2 of RFC 2474 [76] is used for
maintaining backwards compatibility with the IP precedence field of ToS.
\- Expedited Forwarding (EF) PHB, defined by RFC 3246 [78], is dedicated to
low loss or low latency traffic.
\- Assured Forwarding (AF) PHB, defined by RFC 2597 [79], offers different
levels of forwarding assurances.
The DS domain operator can also implement additional custom PHBs.
In the context of ToS-based traffic identification and separation, it is
reasonable to assume the Data Network north of the UPF (N6) is DS-enabled. The
5G System is embedded in a larger DS domain, using same ToS values across
multiple devices in order to provide Quality of Service Support like a DSCP-
enabled link. However, it is not required to deploy DS capable routers for
using in order to use the ToS field in the IP packet filter set for traffic
identification.
According to clause 4.1 of TS 26.501 [15], the 5GMS functions may be deployed
within the trusted Data Network or an external Data network. As noted above,
DS Code Points are often reset at network domain borders, but not always.
There may be deployments e.g., with localized Edge Computing or with direct
peering realizations, where the DSCP values can be used up to the 5GMSd AF
and/or 5GMS AS in an external Data Network. In this case, the logical DS
domain is extended to include those externally-deployed 5GMS functions.
Figure 5.3.2.2-1 illustrates a deployment with a DS domain between the 5G
System and the 5GMS functions deployed in the external DN. (The model is also
valid for deployments in which the 5GMS functions both reside in the trusted
DN.)
{width="6.497109580052493in" height="2.332191601049869in"}
Figure 5.3.2.2-1: 5GMS deployment within a DS domain
Figure 5.3.2.2-2 illustrates a deployment with a DS domain between the 5G
System and an externally deployed 5GMSd AS. The 5GMSd AF is deployed in the
trusted DN.
{width="6.69375in" height="2.4027777777777777in"}
Figure 5.3.2.2-1: 5GMS deployment within a DS domain
### 5.3.3 Deployment Architectures
The following figure depicts a potential architecture design for the
realization of traffic detection. The architecture shows the involved network
functions in the traffic detection.
{width="4.547244094488189in" height="5.141732283464567in"}
Figure 5.3.3-1: Relevant architecture components
### 5.3.4 Mapping to 5G Media Streaming and High-Level Call Flows
#### 5.3.4.1 General
The Service Data Flow Templates support multiple different combinations to
define parameters for traffic detection. This clause describes the common
parameter combinations to detect specifically media streaming application
traffic.
The Service Data Flow Template can take the form of either Service Data Flow
filters (i.e. IP Packet Filter Sets) or an Application Id referencing Packet
Flow Descriptions (PFDs).
An IP Packet Filter Set can contain different combinations of parameter
values. Unspecified parameter values in the IP Packet Filter Sets are used to
match any value of the corresponding information in the header of an IP
packet. Common IP Packet Filter Set combinations are:
\- 5-Tuple: The source and destination IP addresses, source and destination
port numbers (potentially expressed as a small range of values) and the
Protocol ID. This method of traffic detection is further described in clause
5.3.4.2 below.
\- ToS: The source IP address and the Type of Service (ToS). This method of
traffic detection is further described in clause 5.3.4.3 below.
NOTE: The Type of Service field is used here to map an application data flow
to a specific PCC rule.
A Packet Flow Description (PFD) can contain different parameters. Common
parameters are:
\- Domain Name: The Internet domain name of an application server. This method
of traffic detection is not described further in the present document.
#### 5.3.4.2 Usage of 5-tuples for Traffic Identification
The application detection filters in the UPF can be configured based on a pre-
configured PCC rule (i.e. in the SMF and provided to the UPF) or a dynamic PCC
rule (i.e. provided by the PCF) By interacting with the PCF (possibly via the
NEF) the 5GMS AF is able to provision, update and remove a dynamic PCC rule
which contains Service Data Flow description parameters for traffic handling
and traffic detection in the UPF.
When using 5-tuples for traffic detection, the following fields of the IP
Packet Filter Set are used:
\- Source/destination IP address or IPv6 prefix.
\- Source/destination port number.
\- Protocol identifier of the protocol above IP/Next header type.
\- Packet Filter direction (uplink or downlink).
NOTE: These fields are encoded in the Flow Description field, defined in
clause 5.3.8 of TS 29.514 [28].
As shown in figure 5.3.4.2-1 (below), the 5GMSd AF in the external DN can send
a request using _Nnef_AFsessionWithQos_ API to provision, update or remove a
request to reserve resources for a specific application/flow with specific
flow descriptions. After the AF request authorization, the NEF interacts with
the PCF, providing the flow description together with the QoS reference, the
optional other parameters like Alternative Service Requirements, period of
time or traffic volume, etc.
Figure 5.3.4.2-1:Flow description usage for traffic flow identification
If the request is authorised, the PCF determines the required QoS parameters
based on the information provided by NEF/AF. After the _Nnef_AFsessionWithQoS_
_Create Procedure, a transaction identifier is allocated by the NEF to
identify this AF Session. Then the 5GMSd AF can subsequently invoke the
_Nnef_AFsessionWithQoS_Update_ API with this transaction identifier to update
the flow description.
Alternatively, the 5GMSd AF in the trusted DN can directly send a request
using _Npcf_PolicyAuthorization_ API to provision, update and remove a request
to reserve resources for a specific application/flow with specific flow
descriptions.
Then the PCF initiates the PDU Session modification procedure to provide the
updated PCC rule to the SMF and the SMF updates the PDRs in the UPF for the
application/traffic identification and policy handling.
However, when a new TCP connection is opened and the old one is closed, the
5-tuple in the Flow Description needs to be changed. (This may be from the
consequence of factors such as load balancing, multiple concurrent requests
for different types of resources, use of a shared TCP connection pool, etc.)
In such cases, the 5GMSd AF can invoke the NEF/PCF-related APIs with new flow
description to update the PDRs installed in UPF to follow the changed
transport layer 5-tuples for application/flow identification.
#### 5.3.4.3 Usage of ToS Traffic Class for Traffic Identification
The following is a simplified call flow when using the ToS Traffic Class for
Traffic Identification, meaning, only the Type of Service field is used within
a SDF Filter. The Type of Service (ToS) is an 8-bit field within the IP header
(both IPv4 and IPv6) that can be used to convey a 6-bit DS Code Point (DSCP)
value as described in clause 5.3.2.2, and for ECN marking [30]. Here, and in
the candidate solution presented in clause 5.3.6, only the leading 6 bits are
considered for traffic identification.
It is assumed here that the QoS flow should be used (e.g. for Premium QoS) as
described in TS 26.512, Annex A.
Figure 5.3.4.3-1: ToS usage within an application traffic detection rule
(simplified)
Figure 5.3.4.3-1 depicts a call flow for ToS-based traffic detection. It is
assumed here that the 5GMSd AF provides the ToS value for traffic
identification in the Policy Activation response message (step 5). Another
solution might be that the Media Session Handler allocates a ToS value and
then provides the value to the 5GMSd AF.
The call flow works as the following steps:
1: The Media Session Handler activates a Dynamic Policy and provides the
Policy Template Id with the activation request (among other parameters).
The 5GMSd AF triggers the activation of a Dynamic PCC rule:
2: The 5GMSd AF uses the Policy Authorization Service API and triggers a PCC
rule activation. The 5GMSd AF provides the UE IP address, an IP Packet Filter
Set with the ToS value and the UE IP address of the requesting UE and QoS
parameters.
3: As result, the PCF uses the _Npcf_SMPolicyControl_ APIs to provide a new
PCC rule to the SMF.
4: The SMF uses the PDU Session Modification procedure to add/modify a QoS
Rule in the UE SDAP entity.
5: The SMF uses the N4 interface to provide a new Packet Detection Rule (PDR)
together with other rules for the UE to the UPF. Once the new rule is
installed in the UPF, the UPF starts taking actions on the detected traffic.
6: If the Dynamic Policy can be activated, the 5GMSd AF provides a value for
the ToS field in return.
NOTE 1: The ToS Value is not immediately provided to the Media Session Handler
to prevent race conditions.
7: The Media Player prepares a new TCP connection and sets the ToS value
nominated by the 5GMSd AF on the TCP socket using the _setsockopt()_ API or
equivalent. As a result, all TCP packets for the flow will be marked by the UE
with the ToS value.
8: The TCP Connection is established, and the traffic is marked with the ToS
field. The UPF detects the traffic (by inspecting the IP header) and handles
it according to the policy in the PCC Rule.
NOTE 2: The PCC Rule is scoped by the PDU Session, so the treatment of the ToS
field value by the UPF is limited to the requesting UE. The UPF first looks up
the relevant PDRs for a PDU session based on the incoming GTP Tunnel Id.
The UPF also needs to detect the downlink traffic matching the uplink traffic.
There are different solutions to achieve this:
A: The 5GMSd AS uses the same ToS field for downlink traffic as used for
uplink traffic.
NOTE 3: This solution may not work for cases where traffic crosses operational
domain boundaries, since the ToS header field is often reset by border IP
routers.
B: The UPF captures the 5-tuple carrying a specific ToS field from the TCP
_SYN_ Packet that establishes the connection in the uplink direction. As
result, the UPF automatically creates a new PDR in the opposite direction
derived by inverting the address fields found in the _SYN_ packet.
NOTE 4: The connection handshake of other transport protocols may be more
difficult to detect.
C: Often, the UEs in a PLMN are shielded from public Internet traffic by means
of firewalls that employ Network Address Translation (NAT). In order to set
the ToS field within the Trusted DN to an appropriate value, the N6‑NAT may
set the downlink ToS to the same value as the uplink ToS.
NOTE 5: This is similar to solution A above.
#### 5.3.4.4 Usage of Packet Flow Descriptions for Traffic Identification
The following are simplified call flows for the realization of the traffic
identification leveraging Packet Flow Descriptions (PFDs).
In the first call flow (Figure 5.3.4.4‑1) the provisioning step is described,
in which one or more PFDs for the traffic identification of a single
application are provisioned. The provisioned PFDs for the application are
identified by the Application Identifier.
Figure 5.3.4.4-1: PFD Provisioning using the PFD Management API (simplified)
In the second call flow (Figure 5.3.4.4‑2) the on-demand usage of a set of
PFDs for an application is described.
Figure 5.3.4.4-2: PFD usage within an application detection filter
(simplified)
Here, the 5GMSd AF resides within the Trusted Data Network and interacts
directly with the PCF. When activating an QoS flow, the 5GMSd AF provides to
the PCF the Application Identifer for detecting the 5G Media Streaming traffic
together with the UE IP address and other policy information.
When the 5GMSd AF resides in an external Data Network, the 5GMSd AF instead
uses the equivalent NEF API (such as the _Nnef_AFsessionWithQoS_ or
_Nnef_ChargeableParty_ service APIs) and provides the (external) Application
Identifier, referencing one or more PFDs, to the NEF.
The 5GMSd AF can update the PFDs during an ongoing media streaming session.
When updating, the 5GMS AF uses the NEF PFD management APIs. The system then
automatically updates the Packet Detection Rules in the UPF used for traffic
detection.
### 5.3.5 Potential open issues
The exact behaviour and information that needs to be provided to and by the
5GMSd AF as well as the Media Session Handler need to be specified.
The following open issues have been identified:
1\. The _Nnef_AFsessionWithQOS_ and _Nnef_ChargeableParty_ stage 3 APIs, as
defined in TS 29.522 [43], only supports a Packet Flow Description (through
the FlowInfo Type) or an Application Identifier for referencing one or more
PFDs. Other information elements of the Service Data Flow Filter (like a ToS
value) are not supported. Note, the _FlowInfo_ type from TS 29.122 [44] is
different from the _FlowInformation_ type in TS 29.512 [45].
### 5.3.6 Candidate Solutions
#### 5.3.6.1 Overview
This section gives an overview of the different candidate solutions for
application traffic flow identification within a PDU Session beyond providing
(non-wildcarded) 5-tuples. Solutions fall into one of the following two
categories:
\- _Charging separation-only:_ Only the application detection filters in the
UPF are provisioned with either IP Packet Filter Set (PFS) or PFD parameters,
\- _QoS separation:_ The application detection filters in the UE and in the
UPF are provisioned with either IP Packet Filter Set or PFD parameters in
order to mark packets with the appropriate QFI inside the 5G System.
NOTE 1: Both types of solution may also be used for traffic policing.
NOTE 2: In context of the following candidate solutions to the Traffic
Identification key issue, only the leading 6 bits of the Type of Service (ToS)
field are considered. In case of Differentiated Services [D], these bits
convey the DS field, as described in clause 5.3.2.2.
#### 5.3.6.2 Candidate IP-PFS Solution 1: Using IP ToS marking for downlink-
only QoS flow mapping
This candidate solution focuses on a scenario where only downlink traffic
needs to be mapped to a specific QoS Flow and handled differently by the 5G
System. Related uplink traffic is handled using default QoS.
To describe the traffic identification of a unidirectional flow with ToS at
the Npcf_PolicyAithorization API, a flow description element containing only
the direction information should be provided in addition to the ToS property.
NOTE: Such a solution is counterproductive for TCP- and QUIC-based transports,
i.e. protocols depending on acknowledgements. Such solutions can make sense
for RTP/UDP based flows, such as in Media Production.
#### 5.3.6.3 Candidate IP-PFS Solution 2: Using IP ToS marking for uplink-only
QoS flow mapping
This candidate solution focuses on a scenario where only uplink traffic needs
to be mapped to a specific QoS Flow and handled differently by the 5G System.
Related downlink traffic is handled using default QoS.
To describe the traffic identification of a unidirectional flow with ToS at
the Npcf_PolicyAithorization API, a flow description element containing only
the direction information should be provided in addition to the ToS property.
NOTE: Such a solution is counterproductive for TCP- and QUIC-based transports,
i.e. protocols depending on acknowledgements. Such solutions can make sense
for RTP/UDP based flows, such as in Media Production.
#### 5.3.6.4 Candidate IP-PFS Solution 3a: Using IP ToS marking for bi-
directional QoS flow mapping, initiated by downlink traffic
This candidate solution focuses on a scenario where both downlink and uplink
traffic for a particular application flow within a PDU Session shared by
several different application flows (from the same or different UE
applications) needs to be mapped to a specific QoS Flow and handled
differently by the 5G System. The UPF is provisioned with a QoS Rule before
the 5GMS-related application flow establishment. The UE QoS rule indicates the
usage of reflective QoS. In this candidate solution, the 5GMS AF initiates the
QoS Flow establishment by using specific ToS values in the downlink traffic.
Figure 5.3.6.4-1:
Assumptions:
\- A PCC rule for the UE is activate in the 5G System. The PCC rule contains a
Service Data Flow Filter with a ToS value and the UE IP address.
\- Reflective QoS is enabled for the PDU Session in question (used here in
step 3).
Steps:
Provisioning: The 5GMS System is provisioned for Dynamic Policy usage as
defined in clause 5.7.2 of TS 26.501 [15]. As a result, various functions of
the 5G System are provisioned for QoS usage as follows:
1\. The 5GMS Client has received Service Access Information (through M6 or
M5), providing the information needed to use the Dynamic Policy Invocation
API. Here, the _sdfMethod_ indicates the usage of ToS. The 5GMS Client has
activated a Dynamic Policy as described in clause 5.7 of TS 26.501 [15].
2\. The 5GMS AF has provisioned the information for a Dynamic PCC rule with
the PCF (possibly through NEF).
3\. The PCF has authorized the request and created a PCC rule. The PCF has
sent the PCC rule to the SMF, which has forwarded the QoS rule to the UE
(indicating "reflective QoS" here) and to the UPF.
During media plane usage:
4\. The 5GMS Client initiates connection establishment by sending a TCP _SYN_
packet. The packet is forwarded by the UE SDAP entity (Layer 2) and the UPF to
the 5GMS AS.
5\. The 5GMS AS looks up the ToS policy, including the ToS value for this
UE/network. Details are out of scope for 3GPP.
NOTE: The 5GMS AS may also wait until the first HTTP request message is
received to determine the purpose of the request. A 5GMS Client may use the
TCP connection for subsequent HTTP transactions (persistent TCP connection).
6\. The 5GMS AS sends a TCP _SYN--ACK_ to the UE to continue the TCP
connection establishment handshake. The 5GMS AS sets the ToS field value. The
packet reaches the UPF on its path to the UE.
7\. The UPF detects a PDR match for the UE. Here, the PDR for the UE IP
address contains the ToS value. (The PDR was provided to the UPF in an earlier
step as described in clause 5.3.4.3.)
8\. The UPF encapsulates the downlink IP packet inside an N3 packet. The UPF
sets the QFI value in the N3 packet header.
9\. The UPF sends the N3 packet to the RAN and the RAN marks the QFI value in
the SDAP layer, sending the packet to the UE.
10\. The UE SDAP entity (Layer 2) detects a new QFI.
11\. Reflective QoS is activated for the PDU Session and the UE creates a "UE-
derived QoS Rule" as defined in TS 23.501 [23], clause 5.7.5.2.
12\. The UE SDAP entity (Layer 2) forwards the TCP _SYN/ACK_ to the 5GMS
Client.
13\. The 5GMS Client send the TCP _ACK_ to complete the TCP connection
handshake. (This packet does not need to be marked with a specific ToS value
by the 5GMS Client.
14\. The UE SDAP entity (Layer 2) detects a PDR match for the UE. Here, the
PDR is the 5-tuple as stored in the UE-derived QoS rule.
15\. The UE SDAP entity (Layer 2) encapsulates the IP packet containing the
TCP _ACK_ into the according radio protocols, including the QFI marking.
The 5GMS Client continues to use the established TCP connection.
Discussion:
\- The 5GMS AS needs to determine whether QoS should be used for this session
and which ToS value to use.
\- The _Npcf_PolicyAuthorization_ API allows a ToS value to be provisioned
(without a direction indication), but the _Nnef_AFsessionWithQOS API_ does not
support provisioning of a ToS value.
\- The uplink traffic is not marked with a ToS field.
#### 5.3.6.5 Candidate IP-PFS Solution 3b: Using IP ToS marking for bi-
directional QoS flow mapping, initiated by downlink traffic
This candidate solution focuses on a scenario where both downlink and uplink
traffic for a particular application flow within a PDU Session shared by
several different application flows (from the same or different UE
applications) needs to be mapped to a specific QoS Flow and handled
differently by the 5G System. In this candidate solution, the 5GMS AF
initiates the QoS Flow establishment by using specific ToS values in the
downlink traffic.
The difference between this and Solution 3a is that the UE receives a QoS rule
containing an uplink Packet Filter with ToS.
{width="6.6715277777777775in" height="6.0375in"}
Figure 5.3.6.5-1:
Assumptions:
\- A PCC rule for the UE is activate in the 5G System. The PCC rule contains a
Service Data Flow Filter with a ToS value and the UE IP address.
Steps:
Provisioning: The 5GMS System is provisioned for Dynamic Policy usage as
defined in clause 5.7.2 of TS 26.501 [15]. As result, various functions of the
5G System are provisioned for QoS usage as follows:
1\. The 5GMS Client has received Service Access Information (through M6 or
M5), providing the information needed to use the Dynamic Policy Invokation
API. Here, the _sdfMethod_ indicates the usage of ToS. The 5GMS Client has
activated a Dynamic Policy as described in clause 5.7 of TS 26.501 [15].
2\. The 5GMS AF has provisioned the information for a Dynamic PCC rule with
the PCF (possibly through NEF).
3\. The PCF has authorized the request and created a PCC rule. The PCF has
sent the PCC rule to the SMF, which has forwarded the QoS rule to the UE and
to the UPF. The QoS Rule for the UE contains the ToS value.
During media plane usage:
4\. The 5GMS Client initiates connection establishment by sending a TCP _SYN_
packet. The packet is forwarded by the UE SDAP entity (Layer 2) and the UPF to
the 5GMS AS.
5\. The 5GMS AS looks up the ToS policy, including the ToS value for this
UE/network.
NOTE: The 5GMS AS may also wait until the first HTTP request message is
received to determine the purpose of the request. A 5GMS Client may use the
TCP connection for subsequent HTTP transactions (persistent TCP connection).
6\. The 5GMS AS sends a TCP _SYN--ACK_ to the UE to continue the TCP
connection establishment handshake. The 5GMS AS sets the ToS field value. The
packet reaches the UPF on its path to the UE.
7\. The UPF detects a PDR match for the UE. Here, the PDR for the UE IP
address contains the ToS value. (The PDR was provided to the UPF in an earlier
step as described in clause 5.3.4.3.)
8\. The UPF encapsulates the downlink IP packet inside an N3 packet. The UPF
sets the QFI value in the N3 packet header.
9\. The UPF sends the N3 packet to the RAN and the RAN marks the QFI value in
the SDAP layer, sending the packet to the UE.
10\. The UE SDAP entity (Layer 2) forwards the TCP _SYN--ACK_ to the 5GMS
Client.
11\. The 5GMS Client send the TCP _ACK_ to complete the TCP connection
handshake. (This packet does not need to be marked with a specific ToS value
by the 5GMS Client.
12\. The UE detects a QoS Rule match for the UE. Here, the IP Packet Filter
contains only the ToS value.
13\. The UE SDAP entity (Layer 2) encapsulates the IP packet containing the
TCP _ACK_ into the according radio protocols, including the QFI marking.
The 5GMS Client continues to use the established TCP connection.
Discussion:
\- The 5GMS AS needs to determine whether QoS should be used for this session
and which ToS value to use.
\- The _Npcf_PolicyAuthorization_ API allows a ToS value to be provisioned
(without a direction indication), but the _Nnef_AFsessionWithQOS API_ does not
support provisioning of a ToS value.
#### 5.3.6.6 Candidate IP-PFS Solution 4a: Using ToS marking for bi-
directional QoS flow mapping, initiated by uplink traffic
This candidate solution focuses on a scenario where both downlink and uplink
traffic for a particular application flow within a PDU Session shared by
several application flows needs to be mapped to a specific QoS Flow and
handled separated by the 5G System. In this candidate solution, the 5GMS
Client initiates the QoS Flow establishment by using specific ToS values in
the uplink traffic. Here, the reception of the ToS-marked IP Packet in the UPF
triggers the creation of a new QoS rule in the UPF, similar to reflective QoS
principles.
NOTE: Creation of a new QoS rule derived from an IP packet is defined as "UE-
derived QoS rule" creation in clause 5.3.4 (Reflective QoS) of TS 23.501 [15].
Figure 5.3.6.6-1:
Assumptions:
\- A PCC rule for the UE is activate in the 5G System. The PCC rule contains a
Service Data Flow Filter with a ToS value and the UE IP address.
\- Reflective QoS is enabled for the PDU Session in question.
Steps:
Provisioning: The 5GMS System is provisioned for Dynamic Policy usage as
defined in clause 5.7.2 of TS 26.501 [15]. As result, various functions of the
5G System are provisioned for QoS usage as follows:
1\. The 5GMS Client has received Service Access Information (through M6 or
M5), providing the information needed to use the Dynamic Policy Invokation
API. Here, the _sdfMethod_ indicates the usage of ToS. The 5GMS Client has
activated a Dynamic Policy as described in clause 5.7 of TS 26.501 [15].
2\. The 5GMS AF has provisioned the information for a Dynamic PCC rule with
the PCF (possibly through NEF).
3\. The PCF has authorized the request and created a PCC rule. The PCF has
sent the PCC rule to the SMF, which has forwarded the QoS rule to the UE and
to the UPF.
During media plane usage
4\. The 5GMS Client initiates connection establishment by sending a TCP _SYN_
packet. The packet is forwarded by the UE SDAP entity (Layer 2) and the UPF.
The 5GMS Client has set a ToS value in the TCP _SYN_ packet, as provided by
the 5GMS AF in an earlier step (see clause 5.3.4.3).
5\. The UPF detects a PDR match for the UE. Here, the PDR for the PDU Session
(e.g. identified by the TEID) contains the ToS value. (The PDR was provided to
the UPF in an earlier step as described in Clause 5.3.4.3.)
6\. The UPF creates a "UPF derived QoS Rule", similar to the "UE derived QoS
Rule" (see TS 23.501 [15], clause 5.7.5.2). The UPF derives the IP Packet
Filter set (similar to the derivation in the "UE derived QoS rule") by taking
the IP addresses, protocol identifier and port numbers into the IP Packet
Filter Set.
7\. The UPF forwards the TCP _SYN_ packet to the 5GMS AS.
8\. The 5GMS AS replies with a TCP _SYN--ACK_ packet to continue the TCP
connection establishment handshake.
9\. The UPF detects a PDR match for the UE. Here, the PDR for the UE contains
the 5-tuple of the TCP connection.
10\. The UPF encapsulates the downlink IP packet into an N3 packet. The UPF
sets the QFI value in the N3 packet header.
11\. The UPF sends the N3 packet to the UE via the RAN.
12\. The UE SDAP entity (Layer 2) detects a new QFI value.
13\. Since Reflective QoS is activated for the PDU Session, the UE creates a
"UE-derived QoS Rule" as defined in TS 23.501 [23], clause 5.7.5.2.
14\. The UE SDAP entity (Layer 2) forwards the TCP _SYN--ACK_ to the 5GMS
Client.
15\. The 5GMS Client sends the TCP _ACK_ to complete the TCP connection
handshake. (Unlike in step 4, this packet does not need to be marked with a
specific ToS value by the 5GMS Client.)
16\. The UE SDAP entity (Layer 2) detects a PDR match for the UE. Here, the
PDR is the 5-tuple as stored in the UE derived QoS rule.
17\. The UE encapsulates the IP packet into the according radio protocols,
including the QFI marking.
The 5GMS Client continues to use the established TCP connection.
Discussion:
\- TS 23.501 [23] defines only a "UE-derived QoS Rule". The concept does not
exist for the UPF.
\- The _Npcf_PolicyAuthorization_ API allows a ToS value to be provisioned
(without a direction indication), but the _Nnef_AFsessionWithQOS API_ does not
support provisioning of a ToS value.
#### 5.3.6.7 Candidate IP-PFS Solution 4b: Using ToS marking for bi-
directional QoS flow mapping, initiated by uplink traffic
This candidate solution focuses on a scenario where both downlink and uplink
traffic for a particular application flow within a PDU Session shared by
several application flows needs to be mapped to a specific QoS Flow and
handled separated by the 5G System. In this candidate solution, the 5GMS
Client initiates the QoS Flow establishment by using specific ToS values in
the uplink traffic. Here, the IP packet with the ToS value reaches the 5GMS AS
and is re-used for downlink traffic.
Figure 5.3.6.7-1:
Assumptions:
\- A PCC rule for the UE is activate in the 5G System. The PCC rule contains a
Service Data Flow Filter with a ToS value and the UE IP address.
\- Reflective QoS is enabled for the PDU Session in question.
Steps:
Provisioning: The 5GMS System is provisioned for Dynamic Policy usage as
defined in clause 5.7.2 of TS 26.501 [15], Clause 5.7.2. As result, various
functions of the 5G System are provisioned for QoS usage as follows:
1\. The 5GMS Client has received Service Access Information (through M6 or
M5), providing the information needed to use the Dynamic Policy Invokation
API. Here, the _sdfMethod_ indicates the usage of ToS. The 5GMS Client has
activated a Dynamic Policy as described in clause 5.7 of TS 26.501 [15].
2\. The 5GMS AF has provisioned the information for a Dynamic PCC rule with
the PCF (possibly through NEF).
3\. The PCF has authorized the request and created a PCC rule. The PCF has
sent the PCC rule to the SMF, which has forwarded the QoS rule to the UE and
to the UPF.
During Media Plane usage
4\. The 5GMS Client initiates connection establishment by sending a TCP _SYN_
packet. The packet is forwarded by the UE SDAP entity (Layer 2) and the UPF to
the 5GMS AS. The 5GMS Client has set a ToS value in the TCP _SYN_ packet, as
provided by the 5GMS AF in an earlier step (see clause 5.3.4.3).
5\. The 5GMS AS reads the ToS value from the uplink packet. The 5GMS AS uses
the uplink ToS value to mark all downlink packets in that TCP connection.
NOTE: When the 5G System employs an N6 NAT, the N6 NAT may set the downlink
ToS value to the same value as the uplink ToS value.
6\. The 5GMS AS sends a TYP _SYN--ACK_ back to the UE. The packet reaches the
UPF on its path to the UE.
7\. The UPF detects a PDR match for the UE. Here, the PDR for the UE IP
address contains the ToS value. (The PDR was provided to the UPF in an earlier
step as described in clause 5.3.4.3.)
8\. The UPF encapsulates the downlink IP packet into an N3 packet. The UPF
sets the QFI value in the N3 packet header.
9\. The UPF sends the N3 packet to the RAN and the RAN marks the QFI value in
the SDAP layer, sending the packet to the UE.
10\. The UE SDAP entity (Layer 2) detects a new QFI value.
11\. Since Reflective QoS is activated for the PDU Session, the UE SDAP entity
(Layer 2) creates a "UE-derived QoS Rule" as defined in TS 23.501 [23], clause
5.7.5.2.
12\. The UE SDAP entity (Layer 2) forwards the TCP _SYN--ACK_ to the 5GMS
Client.
13\. The 5GMS Client send the TCP _ACK_ to complete the TCP connection
handshake. (Unlike in step 4, this packet does not need to be marked with a
specific ToS value by the 5GMS Client.)
14\. The UE SDAP entity (Layer 2) detects a PDR match for the UE. Here, the
PDR is the 5-tuple as stored in the UE-derived QoS rule.
15\. The UE SDAP entity (Layer 2) encapsulates the IP packet into the
according radio protocols, including the QFI marking.
The 5GMS Client continues to use the established TCP connection.
Discussion:
\- The 5GMS AS needs to determine whether QoS should be used for this session
and which ToS value to use.
\- The _Npcf_PolicyAuthorization_ API allows a ToS value to be provisioned
(without a direction indication), but the _Nnef_AFsessionWithQOS API_ does not
support provisioning of a ToS value.
#### 5.3.6.7 Candidate IP-PFS Solution 4c: Using ToS marking for bi-
directional QoS flow mapping, initiated by uplink traffic
This candidate solution focuses on a scenario where both downlink and uplink
traffic for a particular application flow within a PDU Session shared by
several application flows needs to be mapped to a specific QoS Flow and
handled separated by the 5G System. In this candidate solution, the 5GMS
Client initiates the QoS Flow establishment by using specific ToS values in
the uplink traffic. A ToS-based QoS rule is already provisioned, so that the
Uplink Traffic is mapped to the correct QoS Flow.
Figure 5.3.6.7-1:
Assumptions:
\- A PCC rule for the UE is activate in the 5G System. The PCC rule contains a
Service Data Flow Filter with a ToS value and the UE IP address.
\- A QoS rule with a ToS and a QFI value for uplink traffic is provisioned.
Steps:
Provisioning: The 5GMS System is provisioned for Dynamic Policy usage as
defined in clause 5.7.2 of TS 26.501 [15], Clause 5.7.2. As result, various
functions of the 5G System are provisioned for QoS usage as follows:
1\. The 5GMS Client has received Service Access Information (through M6 or
M5), providing the information needed to use the Dynamic Policy Invokation
API. Here, the _sdfMethod_ indicates the usage of ToS. The 5GMS Client has
activated a Dynamic Policy as described in clause 5.7 of TS 26.501 [15].
2\. The 5GMS AF has provisioned the information for a Dynamic PCC rule with
the PCF (possibly through NEF).
3\. The PCF has authorized the request and created a PCC rule. The PCF has
sent the PCC rule to the SMF, which has forwarded the QoS rule to the UE and
to the UPF.
During Media Plane usage:
4\. The 5GMS Client initiates connection establishment by sending a TCP _SYN_
packet. The 5GMS Client has set a ToS value in the TCP _SYN_ packet, as
provided by the 5GMS AF in an earlier step (see clause 5.3.4.3).
5\. The UE SDAP entity detects a matching ToS value in the uplink traffic.
6\. The UE SDAP entity (Layer 2) encapsulates the IP packet into the according
radio protocols, including the QFI marking
7\. The 5GMS AS reads the ToS value from the uplink packet. The 5GMS AS uses
the uplink ToS value to mark all downlink packets in that TCP connection.
NOTE: When the 5G System employs an N6 NAT, the N6 NAT may set the downlink
ToS value to the same value as the uplink ToS value.
8\. The 5GMS AS sends a TYP _SYN--ACK_ back to the UE. The packet reaches the
UPF on its path to the UE.
9\. The UPF detects a PDR match for the UE. Here, the PDR for the UE IP
address contains the ToS value. (The PDR was provided to the UPF in an earlier
step as described in clause 5.3.4.3.)
10\. The UPF encapsulates the downlink IP packet into an N3 packet. The UPF
sets the QFI value in the N3 packet header.
11\. The UPF sends the N3 packet to the RAN and the RAN marks the QFI value in
the SDAP layer, sending the packet to the UE. The UE SDAP entity (Layer 2)
forwards the TCP _SYN--ACK_ to the 5GMS Client.
12\. The 5GMS Client send the TCP _ACK_ to complete the TCP connection
handshake.
13\. The UE SDAP entity (Layer 2) detects a ToS match for the UE.
14\. The UE SDAP entity (Layer 2) encapsulates the IP packet into the
according radio protocols, including the QFI marking.
The 5GMS Client continues to use the established TCP connection.
Discussion:
\- The 5GMS AS needs to determine whether QoS should be used for this session
and which ToS value to use.
\- The _Npcf_PolicyAuthorization_ API allows a ToS value to be provisioned
(without a direction indication), but the _Nnef_AFsessionWithQOS API_ does not
support provisioning of a ToS value.
### 5.3.7 Conclusions
This Key Issue explored different solutions for traffic identification, so
that the 5G System can detect different application flows and is enabled to
apply an appropriate Policy and Charging Rules (PCC) to the associated
traffic. The Policy and Changing Rules are needed, when the 5G System should
tread the application traffic differently than the normal traffic, e.g. with
better QoS or with different charging rules. The 5G System supports different
means for direction-specific traffic detection. The use of the following
traffic detection schemes is studied in detail in the context of 5G Downlink
Media Streaming, e.g. assuming DASH content delivery:
\- **5-tuple:** UE IP address, server IP address, protocol, UE port and server
port.
\- **Type of Service (ToS) field:** The ToS field is an 8-bit field within the
IP header, that can be used to convey the 6-bit DSCP value. In IPv6, the
Traffic Class field.
\- **Packet Flow Description:** 3-tuple of Server IP address, protocol and
server port.
The use of the Flow Label (IPv6 only), the security parameter index (IPsec)
and the domain name (part of the Packet Flow Description) are not studied in
detail. It is recommended to study IPsec and the usage of the security
parameter index for traffic identification is a subsequent study.
NOTE: PFDs also support URL-based and domain name traffic detection. However,
the URL is increasingly often encrypted (e.g. by the use of TLS or alternative
encrypted transport) and therefore not visible to the network and domain name
are also getting encrypted as encrypted forms of DNS and ECH are adopted.
Although TS 23.501 [23] defines a rich set of traffic detection schemes within
the Packet Filter Set structure, only a subset of the schemes can be
dynamically provisioned using NEF APIs calls. Values for the ToS field, the
Flow Label (IPv6 only), and the Security Parameter Index (IPsec only) can only
be manually provisioned.
The data model of the Dynamic Policy API supports the selection of ToS,
_FlowLabel_ or Domain Names within the _SdfMethod_ data type. However, there
is no detailed definition on the usage of the feature, including the values
for the ToS field. It is recommended to specify the usage of ToS and the
configuration of the ToS values within a normative work item.
## 5.4 Additional/new transport protocols
### 5.4.1 Description
#### 5.4.1.1 General
Media streaming applications are continued to use HTTP-based distribution
protocols, but newer versions of HTTP such as HTTP/2 or HTTP/3 are introduced,
see for example also TR 26.925 [88], clause 6.1.4. The architectural and
performance impacts of such protocols for 5G-based media distribution is
unclear and requires study. The study also considers how Media Players may use
functionalities existing in new transport protocols, and also investigate the
impact of new transport protocols on 5GMS usage and traffic identification
(e.g. Service Data Flow Descriptions).
Based on SMTP (Simple Mail Transport Protocol) [W] and reusing MIME
(Multipurpose Internet Mail Extensions) notation [74][75], HTTP protocol (also
known as web protocol), powers most websites, mobile apps, and videos. It was
created by Tim Berners-Lee at CERN in 1989 and has been enhanced over the
years to keep up with the ever-changing World Wide Web. Currently, the web is
a mixture of HTTP/1.1 [3] and HTTP/2 [4] adoption. Most well-known websites
are running HTTP/2, while smaller websites and late adopters plan to migrate
to HTTP/2 in the near future as it is relatively easy to implement. HTTP/2 is
used by about 45% of websites and supported by all major web browsers. HTTP/3
is only used by about 5% of websites now and not well-supported by web
browsers yet. However. significant HTTP/3 deployments are emerging. For
example, YouTube™ has for a long time been offering a pre-RFC draft version to
any client that wants to use it, especially the Chrome™ browser. Other
browsers are expected to follow soon after waiting for the QUIC and HTTP/3
RFCs to be published before mainlining that feature.
HTTP/2 introduces the \"Streams\" concept at HTTP level and each stream can
have different priorities. All objects can from a web-page can be multiplexed
in single long-lived TCP connection. Also, HTTP/uses header compression
(HPACK) to avoid verbose/clear text. Also, HTTP/2 pseudo-mandates TLS to
prevent "middle boxes" from messing up with the content. However, HTTP/2 does
not remove the drawbacks of TCP's head-of-line blocking - packet loss on one
stream will block all other streams until recovery even if packets for all
other streams are correctly received.
HTTP/2 testing shows [2] that the delivery of large objects over HTTP/2 can be
slower than over HTTP/1.1 when there is packet loss. This is because HTTP/2
uses a single TCP connection, versus about six connections which most web
browsers open over HTTP/1.1. In addition, the TCP congestion control
algorithms reduce the TCP congestion window size, resulting in fewer bytes
sent over the wire when using just one TCP connection.
HTTP/2 provides on average a 5% to 15% performance improvement on page load
times over HTTP/1.1 [2]. HTTP/1.1 allows persistent TCP connections, but
requests still had to be serialized, resulting in the well-known \"HTTP head
of queue blocking\". In order to improve downloads, many TCP flows still
needed to be parallelized to speed up delivery.
The solution to this problem is to use HTTP/2 over a different transport
protocol that provides more efficient congestion control. One option would be
to upgrade and modify TCP, but modifying TCP implementations is viewed as an
impossible task. For example, middle boxes such as NAT, Firewalls, and Load
balancers are problematic, because they get rarely upgraded which prevents any
updates to TCP. TCP is also hard to evolve as it is almost always implemented
as part of operating system kernels, requiring an updated operating system as
part of TCP updates. Hence, it was considered easier to introduce a new
transport protocol on top of UDP, that can be implemented outside the
operating system kernel, in the user space. This new transport protocol is
referred to as QUIC.
That, in essence, is what HTTP/3 [5] is: HTTP/2 over User Datagram Protocol
(UDP) based on IETF QUIC. HTTP/3 is a thin layer on top of QUIC [32] including
QPACK header compression [31]. The main QUIC functions are connection and
stream multiplexing [32], fast startup[32], loss recovery, in-order delivery
(within stream) [32], flow control [32]. TLS1.3 (handshake) [33], loss
recovery and congestion control [34].
HTTP/3 always uses the QUIC protocol as its transport layer, although QUIC may
also be used to carry other application-level protocols. For 5MBS, the term
"HTTP/3" will always be used to refer to "HTTP/3 over QUIC", unless the text
refers specifically to QUIC in explaining its effect on HTTP/3.By multiplexing
multiple concurrent logical streams over a single UDP-based transport
association, and by giving each stream its own independent byte offset
numbering space, packet loss in one stream does not block progress on other
logical streams in the same QUIC connection. (However, the affected stream
will still block when packets are lost, so as to guarantee in-order delivery
of payloads to the application.).
{width="3.625in" height="1.5052384076990377in"}
Figure 5.4-1: HTTP/2 and HTTP/3 protocol stacks
For an entertaining introduction to QUIC and HTTP/3, please check
https://www.youtube.com/watch?v=B1SQFjIXJtc.
However, using HTTP/3 over QUIC for adaptive streaming still requires study as
under certain circumstances, the quality using QUIC may even degrade for DASH-
based streaming than it would increase [6]. The evaluation results show that
using the unmodified DASH algorithms on top of QUIC may not provide the
anticipated performance boost when compared to the standard DASH over TCP.
The main expected benefit of QUIC is being able to multiplex requests for all
Adaptation Sets onto the same transport association, and then to manage the
network QoS on that aggregate connection. This has a valuable operational
benefit to a CDN operator (including the 5GMS AS) in reducing the number of
UDP ports that a server needs to keep open. Another benefit is being able to
migrate connections from one IP address to another with minimal interruption
to either client or server. This is useful when the client moves, but it is
also useful when the server changes (e.g. in edge computing relocation Use
Cases).
Because HTTP/3 and IETF QUIC are new protocols, there are several questions
about performance and management that need to be investigated during this
study.
#### 5.4.1.2 Performance Considerations for HTTP/3 over 5G Networks
The IETF specifications for HTTP/3 [5][31] and the core QUIC functions [32,
33, 34] are now approved in the IETF, and have been broadly deployed by a
number of browser vendors and content providers, since the IETF QUIC working
group has focused on specification, implementation, and, after the
specifications were sufficiently stable, deployment, all in parallel. The
performance of HTTP/3 in environments that have not been encountered during
deployments to date is still an open question. Of greatest interest for this
study, is the performance of HTTP/3 in 5G networks. Although deployment of 5G
networks has begun, most deployment experience with HTTP/3 in mobile networks
over the past few years has been in non-5G networks.
When end users have used HTTP/3 to access servers outside the 5G core network,
3GPP terminal mobility was handled transparently by the 3GPP network, and the
UE's IP address(es) didn't change. If a server's IP addresses changed, this
was often not visible to the user, due to the widespread deployment of CDNs
and load balancers in data centers. If edge computing resource IP addresses
change in relocation use cases, QUIC connection migration could be used to
reduce the impact on user experience, but this needs to be analyzed carefully.
MPEG-DASH has provided years of good user experience running over HTTP/1.1. As
use cases arise which require very low latency, it is reasonable to better
understand how, and when, MPEG-DASH might take advantage of HTTP/3 and analyze
whether this has any implications for this study.
[6] raised the issue that MPEG-DASH performance might be lower over HTTP/3
than over HTTP/2. This reference was comparing Google's pre-standardization
QUIC implementation to highly optimized HTTP/2 over TCP implementations, and
is about five years old, as of this writing, but the point remains -- we need
to know more about unmodified MPEG-DASH over standardized HTTP/3
implementations.
In particular, in the downlink media streaming Use Case, the server chooses
the algorithm but the client media player decides whether to use a long-lived
connection or to drop and reconnect when changing representation/rendition or
adaptation/switching set, and the decision on connection (re)use is often
delegated by the client application to a library, and this library might not
offer an API to influence connection reuse. QUIC optimisations for reducing
connection setup time (0-RTT or 1-RTT handshake (as described in [32])
mitigate this suboptimal use of connections to some extent, but the if the
client, directly or indirectly by delegating the decision to the library,
chooses to close and open connections, any QUIC congestion control algorithm
begins probing for available bandwidth with no information about path
characteristics. The connection handling characteristics of common APIs need
to be analyzed as part of this study.
#### 5.4.1.3 Performance Considerations for IETF QUIC over 5G networks
The standardized QUIC congestion control and recovery procedures in [34] are
chosen to emulate TCP's standardized behaviours ([35], plus extensions). These
are quite conservative, and not match current work on delay-based congestion
control and recovery mechanisms, which have also seen wide deployment in QUIC
implementations. In principle, delay-based congestion control and recovery
mechanisms should improve user experience for streaming media applications,
but this isn't known yet, and this needs to be carefully analyzed. One of the
core functions of QUIC is the capability to migrate connections without
application involvement when endpoint IP addresses change, rather than
requiring the detection of a connection failure, teardown of that connection,
and setup of a new connection. Connection migration is one of the key QUIC
functions that we do not have a great deal of experience with -- implementers
in the IETF said they were concentrating on performance for a connection, and
many had not completely implemented or tested connection migrations at scale
(data point is from October 2020).
#### 5.4.1.4 Management Considerations for HTTP/3 in 5G networks
One of the biggest distinctions between HTTP/2 over TCP and HTTP/3 over QUIC
has been the encryption of almost all transport-level information carried in
QUIC. This information, which was not encrypted in TCP even when it was
carrying encrypted payloads, was often used in network management to identify
and troubleshoot performance problems on the Internet. In most of experience
with HTTP/3 deployments to date, content providers (e.g. Google/YouTube,
Facebook, etc.) have terminated at least one end of the encrypted end-to-end
connections, allowing them to identify problems at the QUIC transport level.
That might be true in 5G deployments, or it might not be the case. If that is
not the case, it would be very useful to consider the guidance in [36] as part
of this study. It is also likely that operator deployments which relied on
split-TCP connections to improve performance over radio links will require
reconsideration for QUIC-based HTTP/3, since QUIC transport-level information
is not available unless a device has a security context for the encrypted QUIC
connection. It is likely that we will need to enhance the 3GPP QoS framework,
and that if an application is using QUIC, 5-tuples are not sufficient for per-
flow QoS.
Although QUIC can be implemented as part of operating system kernels, it is
commonly implemented in user space, allowing frequent updates to congestion
control and recovery procedures, including introduction of entirely new
procedures (e.g. BBR, \"Bottleneck Bandwidth and Round-trip propagation time\"
congestion control [37]). It is likely that the performance characteristics of
HTTP/3 applications will vary more dynamically than HTTP/1.1 implementations
that have been used by MPEG-DASH in the past. This may also have implications
for existing applications if they migrate from MPEG-DASH over HTTP/1.1 or
HTTP/2, to MPEG-DASH over HTTP/3.
#### 5.4.1.5 HTTP/3 client operation with an HTTP/3 server
There are many details involved, but the following description gives a sense
of how little changes at the application layer when 5GMS begins using HTTP/3
as its application protocol.
1\. To open an HTTP/3 connection and retrieve a resource, an HTTP/3 client
possesses a target URI providing a _scheme_ , which needs to be \"https:\", an
_authority_ , which must include a resolvable DNS name, and (optionally) a
_path_ describing the location of the resource at the authority. This target
URI may be obtained in various ways (configuration, dynamic lookup when the
HTTP/3 client begins operation, or even from a resource that the HTTP/3 client
has already retrieved).
2\. The location is resolved to an IP address, by looking up a DNS name, using
HTTPS, or other mechanisms that would be used to resolve any other URI
authority.
3\. Once in possession of the IP address for the HTTP/3 server, the HTTP/3
client attempts to open an HTTP/3 connection to the HTTP/3 server. In order to
use HTTP/3, the HTTP/3 client communicates with the HTTP/3 server using the
underlying QUIC protocol, sent over UDP. During connection establishment, the
HTTP/3 client and HTTP/3 server perform a TLS 1.3 handshake, and HTTP/3
support is indicated by selecting the ALPN token \"h3\" in the TLS handshake.
When the TLS 1.3 handshake is complete, both HTTP/3 client and HTTP/3 server
have validated the connection.
4\. When connection validation is complete, the HTTP/3 client can begin
performing normal HTTP requests over the HTTP/3 connection. In the case of M4d
interactions, for example, the HTTP/3 client issues an HTTP GET request.
5\. When the HTTP/3 server receives an HTTP request, it responds using normal
HTTP status codes, and then performs the requested operation if the request
has succeeded.
#### 5.4.1.6 QLOG metrics reporting for HTTP/3 and QUIC
One adjustment to the 5GMS architecture to accommodate HTTP/3 could be to
provide additional metrics reporting at Layer 7 and Layer 4. In addition to
DASH application metrics, providing metrics on HTTP/3 protocol operation and,
perhaps, even on QUIC might be useful for 5GMS System operators.
When DASH is used as a streaming protocol, DASH metrics would continue to be
available when a DASH client creates an HTTP/3 connection to an HTTP/3 server.
When a non-DASH client, for example, an HLS [87] client, creates an HTTP/3
connection to an HTTP/3 server, a different mechanism would be necessary for
metrics reporting. A capability called "QLOG", currently under development in
the QUIC working group of the Internet Engineering Task Force, is one such
mechanism.
QLOG is composed of three related specifications:
\- a protocol-independent schema specification and mapping to JSON in [84]
\- a specification for HTTP/3-level events [85], and
\- a specification for QUIC-level events [86].
QLOG events can be stored, aggregated, and reported in a variety of ways. In
particular, QLOG events can be collected at both endpoints of a connection, so
these events could be reported by an HTTP client, an HTTP server, or both, if
comparison is desired.
QLOG could be used to collect HTTP-level events for any HTTP-based streaming
protocol running over HTTP/3.
QLOG could also be used to collect QUIC-level events for any streaming
protocol encapsulated in QUIC, but consideration of this usage can be deferred
until such protocols are identified.
### 5.4.2 Collaboration Scenarios
A service provider/content provider runs an adaptive media streaming service
between HTTP/3 and QUIC enabled 5G Media Streaming AS and an HTTP/3 and QUIC
enabled UE using 5G Media Streaming over M2d and M4d.
#### 5.4.2.1 General
The QUIC protocol [32] is a general-purpose transport protocol, although most
current deployments have been in conjunction with HTTP/3 [5]. Even when
limiting discussion to HTTP/3 over QUIC, this capability can be relevant to
multiple key topics described in the present document, as well as the basic
procedures for 5G Media Streaming described in TS 26.501 [15], in both
downlink and uplink directions.
#### 5.4.2.2 HTTP/3 collaboration for downlink media streaming
For this key topic, the discussion will focus on the collaboration scenario
where a 5GMS Application Provider runs an adaptive media streaming service
between an HTTP/3-enabled 5GMSd AS and an HTTP/3-enabled 5GMSd Client using
downlink media streaming over M2d and M4d. This is Collaboration Scenario 2,
from clause A.2 in TS 26.501 [15], reproduced in figure 5.4.2‑1 below.
{width="6.69375in" height="2.394342738407699in"}
Figure 5.4.2-1: Collaboration 2 (unchanged from Figure A.2-1 in TS 26.501
[15])
#### 5.4.2.3 Collaboration for uplink media streaming using HTTP/3
For this key topic, the discussion will focus on a media plane only
collaboration scenario where the 5GMSu AS is deployed in the trusted domain.
This collaboration scenario is described in clause 5.5.2.2 and illustrated in
figure 5.5.2.2-1.
\- If HTTP/3 is used as the uplink application protocol at reference point
M4u, the uplink media is streamed from the Media Streamer subfunction of an
HTTP/3-enabled 5GMSu Client to an HTTP/3-enabled 5GMSu AS.
\- If HTTP/3 is used as the media egest application protocol at reference
point M2u, the egest media is sent from an HTTP/3-enabled 5GMSu AS to an
HTTP/3-enabled 5GMSu Application Provider.
Editor's Note: Clause 5.5.2.7, describing a \"hybrid, i.e. end-to-end form of
collaboration across uplink media streaming and downlink media streaming
services\", and clause 5.2.4.3 on \"Content preparation between uplink ingest
and downlink streaming\", would be useful to cover in clause 5.4 as well.
Editor's Note: Uplink ingest formats are also a key topic in this study, and
clause 5.2.1 names several existing uplink ingest formats to be studied. Even
for the formats not routinely carried over HTTP (e.g. RTP-based RIST [21][22]
and SRT [82]), discussions are underway in the Internet Engineering Task Force
to specify direct mappings onto QUIC (for instance, [80] and [81] for RTP and
[83] for SRT). If these uplink ingest formats are included in the final TR, a
new 5.4.2.X clause should be added, describing the impact of encapsulating
these non-HTTP protocols in QUIC.
### 5.4.3 Deployment Architectures
#### 5.4.3.1 General
A minimal deployment architecture that would provide HTTP/3 as transport for
downlink and uplink media streaming is shown in figure 5.4.3.1-1.
Figure 5.4.3.1-1: Deployment Architecture for HTTP/3
The addition of HTTP/3 as a supported protocol at reference points M2 and M4
in the 5G media streaming architecture has little effect on the overall
architecture. For example, a 5G System using HTTP/3 would resolve Fully-
Qualified Domain Names (FQDNs) in the same way as with previous versions of
HTTP, as described in annex B of TS 26.501 [15].
The biggest impact would be on implementations adjusting the endpoints they
expose.
To use HTTP/3 for downlink or uplink media streaming, the 5GMS AS exposes
HTTP/3 endpoints at reference points M2 and M4. This is in addition to the
HTTP/1.1 and (optionally) HTTP/2 endpoints, as described in clause 6.2.1.2 of
TS 26.512 [15].
In the following discussion, the term _HTTP/3 client_ is used for the entity
that initiates an HTTP/3 connection, and the term _HTTP/3 server_ is used for
the entity that the HTTP/3 client wishes to communicate with.
#### 5.4.3.2 HTTP/3 deployment in downlink media streaming
To use HTTP/3 for pull-based content ingest, the 5GMSd Application Provider
exposes an HTTP/3-based origin endpoint to the 5GMSd AS at reference point
M2d. This is in addition to the HTTP/1.1 and (optionally) HTTP/2 endpoints, as
described in clause 6.2.1.2 of TS 26.512 [15]. Here, the 5GMS AS acts as an
HTTP/3 client, the 5GMSd Application Provider acts as an HTTP/3 server, and
HTTP operation proceeds as usual at M2d.
To use HTTP/3 for push-based content ingest, the 5GMSd AS exposes an
HTTP/3-based origin endpoint to the 5GMSd Application Provider at reference
point M2d. Here, the 5GMSd Application Provider acts as an HTTP/3 client, the
5GMS AS acts as an HTTP/3 server, and HTTP operation proceeds as usual at M2d.
To use HTTP/3 between the 5GMSd Client and the 5GMSd AS at reference point
M4d, the 5GMSd Client acts as an HTTP/3 client, and the 5GMS AS acts as an
HTTP/3 server, so that HTTP operation would proceeds as usual at M4d.
Because, as described in clause 6.2.1.2 of TS 26.512 [15], the 5GMSd
Application Provider may use any supported HTTP protocol version for push-
based content ingest at interface M2d, and the Media Stream Handler may use
any supported HTTP protocol version at interface M4d, no other changes to the
architecture are needed.
#### 5.4.3.3 HTTP/3 deployment in uplink media streaming
To use HTTP/3 for uplink media streaming, the 5GMSu AS exposes an HTTP/3-based
endpoint to the 5GMSu Client at interface M4u. Here, the 5GMSu Client acts as
an HTTP/3 client, the 5GMS AS would act as an HTTP/3 server, and HTTP
operation proceeds as usual at M4u.
Separately, the 5GMSu AS may expose an HTTP/3-based endpoint to the 5GMSu
Application Provider at reference point M2u for media egest. Here, the 5GMS AS
acts as an HTTP/3 client, the 5GMSu Application Provider acts as an HTTP/3
server, and HTTP operation proceeds as usual at M2u.
5.4.3.4 Usage of HTTP/3 at reference point M5
Editor's Note: This section should be filled in as other key issues (clause
5.3 on traffic identification, clause 5.12 on network slicing) progress.
### 5.4.4 Mapping to 5G Media Streaming and High-Level Call Flows
#### 5.4.4.1 General
Using HTTP/3 for 5GMS functions that currently use earlier versions of HTTP
(either HTTP/1.1 or HTTP 2/) can provide performance improvements, such as:
1\. "Single-threading" HTTP requests and responses -- HTTP/1.1 doesn't have
any way of disambiguating response packets when multiple requests are
outstanding on a connection, so the server sends responses as "next request
received, next response returned", even if the HTTP client has "pipelined"
multiple requests without waiting for responses to its outstanding requests.
2\. Avoiding TCP "Head-of-Line" ("front-of-queue") blocking -- both HTTP/1.1
and HTTP/2 use TCP, so a missing response packet blocks all further response
packets from being delivered to the application until the missing response
packet has been detected and successfully retransmitted by TCP.
3\. Setting up connections in at most one "Round-Trip Time", or RTT -- HTTP/3
can set up a new connection in a single RTT. This is significantly faster than
HTTP/1.1 or HTTP/2, because they use TCP, which requires a three-way TCP
handshake, and then at least one more RTT to perform a TLS 1.3, and
potentially multiple RTTs.
But beyond these performance improvements, there are very few impacts of
adding the capability to use HTTP/3 to high-level call flows in 5GMS
environments.
### 5.4.5 Potential open issues
#### 5.4.5.1 Introduction
Most of the potential questions previously identified in clause 5.4.1 don't
appear to be continuing concerns, as HTTP/3 has been deployed on the Internet
at scale. A few open issues are worth noting here.
#### 5.4.5.2 Streaming Protocols taking advantage of HTTP/3 capabilities
Because so many media providers have used HTTP-based transport mechanisms,
they have been forced to provide "workarounds" to overcome the TCP-related
deficiencies that HTTP implementations were forced to deal with. Confirming
with the predominant implementors of HLS, MPEG-DASH, SRT, and even RTP what
their timeframes are for versions of these protocols that take advantage of
HTTP/3 capabilities would be useful, but these versions are already starting
to appear. Preliminary proposals for "Tunnelling SRT over QUIC" [SRT-QUIC],
and multiple proposals for RTP over HTTP/3, or even directly over QUIC, have
been submitted to the IETF.
#### 5.4.5.3 3GPP-specific impediments to HTTP/3 deployment
One well-recognized impediment to HTTP/3 deployment in the broader Internet is
that it is carried over QUIC, which is a well-behaved transport protocol that
detects and responds to path congestion, but QUIC runs over the UDP protocol,
which is not understood to be well-behaved. Traditional UDP protocols have
been query--response protocols, such as DNS domain name resolution (\"what is
the IP address for this domain name?\" followed by \"This is the IP address
for that domain name\"), and normally use well-known port numbers (if you send
a UDP packet to port 53, network firewalls will assume that it is a DNS query,
and unlikely to cause congestion).
HTTP/3, like any other protocol running over QUIC, will look like a highly
encrypted UDP protocol, and it **might** use the UDP port number that matches
the TCP port number of the same protocol running over TCP, but that is not a
requirement, so network operators often investigate UDP packets being sent to
an unfamiliar port number, especially if that traffic does not seem to be
simple query-response traffic.
If their investigation is not reassuring, they may block UDP packets being
sent to an unfamiliar port number at an unfamiliar IP address, and even if
they don't block that traffic, they may rate-limit the traffic to prevent
their network links being overwhelmed by unknown traffic that might not
respond to congestion indications. So, on the Internet, HTTP applications that
attempt to use HTTP/3 are prepared to fall back to HTTP/2 or even HTTP/1.1
over TCP, which is more reassuring for network operators.
#### 5.4.5.4 Adaptive Streaming clients operating on top of HTTP/3
capabilities
Adaptive streaming clients are implemented to overcome the TCP-related
deficiencies that HTTP implementations were forced to deal with. Today's
adaptive streaming clients are typically not aware that they are operating on
top of HTTP/3 and QUIC instead of HTTP/1.1 and TCP. A DASH client as
documented in clause 13 of TS 26.512 [?] includes some typical functions that
may be impacted by operation on top of HTTP/3, in particular:
\- _Throughput estimation:_ An estimate of the network throughput from the
5GMSd Application Server, which is typically computed as the object size
divided by the download time where the download time is the time difference
between the first and the last bytes received for that object. According to
[DASH-QUIC], measuring the throughput of multiplexed audio and video streams
over a single UDP socket results in additional response latency for the (much
smaller) audio segments, whose individual throughput is not captured during
the calculation of channel throughput.
\- _Request Scheduling:_ The adaptive streaming client schedules requests
under the assumption of TCP operation. It typically operates for example audio
and video on two HTTP sessions with separate sockets, and each of the sockets
maintains its own independent socket buffer. By contrast, requests for audio
and video are typically multiplexed onto a single HTTP/3 session on a single
UDP socket with a single socket buffer. Therefore, the HTTP responses from
both the streams interfere, and a higher response rate for one stream affects
the queuing delay for the responses on the other stream.
Based on these operations, it is important that the adaptive streaming client:
1\. Is aware that it is operating on top of HTTP/3.
2\. Adapts its operation based on HTTP/3 properties
Details are for further study.
#### 5.4.5.5 5GMS Operation taking advantage of HTTP/3 capabilities
5G Media Streaming provides the ability to support regular OTT media streaming
by providing additional and auxiliary information between the Media Session
Handler and the 5GMSd AF. Supported functions in Rel-16 include telco CDN,
network assistance and for example metrics reporting. It would be appropriate
to adjust 5GMS function to HTTP/3 based delivery. As an example, certain DASH
metrics are designed for TCP based streaming and would preferably be updated
to account for HTTP/3 based delivery.
Editor's Note: Identify the impact of including QLOG events on 5GMS metrics
reporting.
#### 5.4.5.6 Addition of HTTP/3 as a supported HTTP version in 3GPP
specifications
Clause 6.2.1.2 of TS 26.512 [15] describes the required and supported versions
of HTTP for the 5GMS AF and 5GMS AS. For these functions to use HTTP/3, that
clause must be updated, to add HTTP/3 as a supported HTTP version.
In addition to that update, it will be necessary to decide whether support for
HTTP/3, and use of HTTP/3, should be required, encouraged, or permitted, over
each of the relevant reference points.
Given our expectations for the pace of HTTP/3 deployment in 3GPP environments,
our recommendation would be to permit HTTP/3 over most of the relevant
reference points, in order to allow operators to plan for, and gain
operational experience with, HTTP/3 usage in their environments.
#### 5.4.5.7 Pace of HTTP/3 deployment in 3GPP environments
HTTP/3 is ready at this time for use by some 3GPP operators with some types of
5GMS streaming applications, but the actual pace of deployment at any specific
3GPP operator will be based on
1\. The availability of HTTP/3 implementations on UEs, 5GMS AF instances, and
5GMS AS instances.
2\. The ability of operators and end users to see improvements in QoE with
HTTP/3, which depends on the choice of streaming protocols in use, and support
for HTTP/3 transport in those streaming protocols.
3\. The benefits of HTTP/3 on media plane interfaces (M2, M4) may realize more
benefit than control plane interfaces (M1, M5), although, for example, there
may be benefits from multiplexing M5 transactions into a single long-lived
HTTP/3 session.
4\. The readiness of a 3GPP operator to support HTTP/3 and the underlying QUIC
protocol, which may involve more than 5G Media Streaming. If the operator
plans to use HTTP/3 in Service-Based Architecture, or plans to use QUIC in
ATSSS, the operator may choose to deploy HTTP/3 for 5GMS with those other
usages in mind.
### 5.4.6 Candidate Solutions
Editor's Note: Provide candidate solutions (including call flows) for each of
the identified issues.
#### 5.4.6.1 Metrics reporting using QLOG events
Editor's Note: Contribution pending.
5.4.7 Conclusion and Recommendations
The study of this Key Issue has explored the ways in which the latest version
of HTTP, HTTP/3, can be deployed to support the 5G Media Streaming
architecture, and the potential open issues arising from this deployment.
1\. Because the architectural impact of moving from HTTP/1.1 or HTTP/2 to
HTTP/3 on any 5GMS reference point is limited, this study has focused on
minimal collaboration scenarios and deployment architectures for simplicity.
The study of this Key Issue makes the following recommendations:
1\. SA4 should begin work on updating 5GMS stage three specifications for
reference points that currently use HTTP to allow the use of HTTP/3, to allow
early deployment and to identify any unforeseen open issues with using HTTP/3
in a 5G System.
2\. At this time, support for HTTP/3 in 5GMS specifications, and usage of
HTTP/3, should be allowed, but not required.
## 5.5 Uplink media streaming
### 5.5.1 Description
#### 5.5.1.1 Overview
Uplink media streaming functionality is currently under-specified in TS 26.501
[15] and TS 26.512 [16]. This part of the study investigates the gaps and
potential solutions for completing the uplink streaming procedures, and
associated protocols and APIs.
#### 5.5.1.2 Gap analysis of TS 26.501
The original focus of Rel-16 3GPP TS 26.501 [15] is on the overall system
architecture, description of high-level procedures and call flows pertaining
to downlink media streaming services.
In TS 26.501, there is significant imbalance in the scope and details of the
described procedures for downlink vs. uplink media streaming. Key issues
include the following:
1\. The procedures for downlink media streaming include session establishment,
provisioning of various types of configuration information, metrics reporting,
consumption reporting, dynamic policy and network assistance. In comparison,
the described procedures for uplink media streaming are limited to session
management, remote control, and network assistance. It is unclear for uplink
streaming whether and how the configurations for content preparation, content
protocols discovery, dynamic policy, metrics reporting, etc., should be
defined and how the associated functions will operate.
\- Absent in clause 6 are procedural description and call flow regarding QoE
metrics collection and reporting in uplink media streaming as compared to the
presence of such text in clause 5.5 on metrics collection and reporting in
downlink media streaming.
2\. For downlink streaming, it is described that access to Service Access
Information by the 5GMSd Client may be provided either over M8d by the
Application Provider, or else fetched by the Client via M5u. For uplink
streaming, the solely described method for the 5GMSu Client to obtain Service
Access Information is via application metadata delivery over M8u. The only
exception to this rule is the alternative method for provisioning Service
Access Information to the 5GMSu Client by the 5GMSu AF, associated with remote
control sessions in reference to remote control use cases and operational
mechanisms in the context of FLUS (Framework for Live Uplink Streaming) as
described in TR 26.939 [13] and TS 26.238 [14]. However, it should be noted
that due to the limited description of the relationship between the uplink
streaming framework and use cases, defined procedures and APIs in TS 26.512,
it is unclear whether or how remote control sessions associated with uplink
streaming delivery can make use of those interface procedures and APIs.
3\. Clause 4.3 is missing the description of Service Access Information
parameters for a metrics configuration set pertaining to uplink media
streaming, as compared to the presence of such information for downlink media
streaming in clause 4.2.3. In particular, the "Metrics" parameter of the
downlink streaming metrics configuration set is explicitly bound to the 3GPP
"metrics" scheme and corresponds to one or more of the QoE metrics for either
a progressive download or 3GP-DASH streaming service as defined in TS 26.247
[26]. On the other hand, given the lack of definition by SA4 of uplink
streaming QoE metrics collection and reporting related functionality for
existing application service specifications, there is no associated list of
metrics on collection and reporting by the 5GMSu Client that can be
referenced. Therefore, the following items are studied:
a. Identify the quality metrics for uplink streaming.
b. Identify the subset of metrics in a. that can be collected by UE and cannot
be collected by the network entities such as the 5GMSu AF or the 5GMSu AS.
4\. For downlink streaming, the consumption reporting provides reports of the
usage of download streaming of one single content. However, any contribution
reporting from UE for uplink streaming currently is not addressed. Therefore,
the following items are studied:
a. Identify the parameters useful for contribution reporting including the
user's initiated and interactivity events, as well as the user's preferences
for the uplink session such as hiding or reporting the location.
b. Identify the subset of parameters in a. that can be collected by UE that
cannot be collected by the network entities such as the 5GMSu AF or the 5GMSu
for reporting the usage pattern to the Application Provider.
c. Comparing the UE direct reporting of parameters (and metrics in item 3,
above) to the collection of those parameters and metrics by the EVEX data
collection AF.
#### 5.5.1.3 Gap analysis of TS 26.512
Similar to TS 26.512, the originally-defined features, protocols and APIs for
5GMS services mainly pertain to downlink media streaming services. More
recently, as part of the specification maintenance process, additional
descriptive, clarification and corrective text towards supporting uplink
streaming services has been incorporated. However, remaining shortcoming
include:
1\. The latter informationis centered on identifying relevance of existing and
downlink streaming centric interface functionality for uplink streaming. For
instance, provisioning and subsequent execution of content protocol discovery,
dynamic policy invocation, and metrics reporting are regarded as applicable to
support for uplink media streaming services. Also, content preparation via
M1-based configuration of Content Preparation Templates may be considered a
means for defining manipulations by a 5GMSu AS of media content uploaded from
the 5GMSu Client. Such content manipulation may be associated with network-
based media processing (NBMP) of uplink-delivered streaming media content
(e.g., user-generated content of social media services, professionally-
produced uplink streaming of sports events or concerts) as defined in FLUS
[13] and further evaluated in the FS_FLUS_NBMP study item. However, further
assessment of the potential linkage between content preparation and NBMP
should be conducted.
2\. Although the Metrics Reporting Configuration resource as part of M1
provisioning procedures and described in clause 4.3.9 is intended to apply to
either downlink or uplink media streaming, the corresponding data model of
that resource (see clause 7.8.3) contains no explicitly-referenceable metrics
for collection and reporting associated with uplink streaming services. This
is due to the absence of a 3GPP-defined metrics scheme for uplink media
streaming as it exists for downlink media streaming (e.g., the 3GPP scheme
_urn:‌3GPP:‌ns:‌PSS:‌DASH:‌QM10_).
\- It would be desirable in this study to identify a candidate set of QoE
metrics associated with uplink media streaming services, and as specified by a
3GPP-defined metrics scheme, to be collected by the 5GMSu Client and reported
to the 5GMSu AF.
\- Up to now, in the development of the 5GMS architecture and associated
protocols and APIs, very little attention has been given to defining control
plane functionality that can offer unique/beneficial features to the end-user,
network operator or Application Provider in the context of uplink media
streaming service operation. Such value-added functionality could be enabled
by leveraging the information available in the 5GMS network (e.g.,
subscription class, service characteristics, user/device mobility, network
conditions) and which may be static or dynamic in nature. This is also an area
that should be further studied.
#### 5.5.1.4 Gap analysis between TS 26.238 (FLUS) and TS 26.512 (5G Media
Streaming)
TS 26.238 provides the following features:
1\. The FLUS Control Source may discover multiple FLUS sinks.
2\. The FLUS Control Source may discover the capabilities of each discovered
FLUS Sink, including its network-based media processing capabilities.
3\. The FLUS Control Source may also request a FLUS Sink to perform media
processing.
4\. The UE capabilities (formats, connectivity protocol, remote control) may
be discovered by a FLUS Control Sink.
TS 26.512 uplink streaming currently lacks the above features.
### 5.5.2 Collaboration Scenarios
Editor's Note: Study collaboration scenarios between the 5G System and
Application Provider for each of the key topics.
#### 5.5.2.1 Overview
A set of key collaboration scenarios between an 5GMSu Application Provider and
the 5G System Provider is described below.
Scenarios associated with Media Plane only collaboration and which may also
involve downlink media distribution are presented first. Subsequently,
scenarios pertain to both Control Plane and Media Plane collaboration and
which may or may not involve downlink media distribution are presented.
NOTE: In the collaboration scenario descriptions and diagrams below, an
interface or API marked with a prime (′), e.g., M1′ or M2u′, denotes that
while that interface/API functionally maps to its 3GPP-defined counterpart
(e.g., M1 or M2u), its protocol and format are defined by the 5GMSu
Application Provider. The implementation of these interfaces is up to the
5GMSu Application Provider discretion.
#### 5.5.2.2 Collaboration Scenario 1
This scenario pertains to a media plane only collaboration for which the 5GMSu
AS is deployed in the trusted domain. Here, the 5GMS System Provider is
assumed to offer uplink streaming capabilities as a service to an external
5GMSu Application Provider.
NOTE: Although a Provisioning Session is shown in Figure 5.5.2.2-1 between the
(external) 5GMSu Application Provider and the 5GMSu AF, due to the absence of
the M5u interface in this diagram, there is no control plane collaboration
between the 5GMSu Application Provider and the 5GMS System Provider.
{width="6.229166666666667in" height="2.2304429133858266in"}
Figure 5.5.2.2-1: Collaboration 1
#### 5.5.2.3 Collaboration Scenario 2
This scenario pertains to a media plane only collaboration for which the 5GMSu
AS is deployed in the external domain and the 5GMSu AF is not involved.
Specifically, the M1′ and/or M2u′ protocols do not follow 3GPP specifications.
Figure 5.5.2.2-1: Collaboration 2
#### 5.5.2.4 Collaboration Scenario 3
In this collaboration scenario, both the 5GMSu AS and 5GMSu AF are present.
The 5GMSu AS resides in the external domain and does not employ 5GMS protocols
and formats for uplink media reception from the 5GMSu Client, nor for content
egest. The 5GMSu AF is used to interact with the 5G System, e.g., for dynamic
policy invocation and/or other uplink streaming related network features such
as metrics reporting and network assistance).
Figure 5.5.2.3-1: Collaboration 3
#### 5.5.2.5 Collaboration Scenario 4
In this collaboration scenario, both the 5GMSu AS and 5GMSu AF are present and
follow 3GPP specifications. Both the 5GMSu AS and 5GMSu AF reside in the
external DN/domain.
Figure 5.5.2.4-1: Collaboration 4
#### 5.5.2.6 Collaboration Scenario 5
This scenario is similar to collaboration scenario 4, with the exception that
the 5GMSu AS and 5GMSu AF reside in the trusted DN/domain. An additional
difference from collaboration scenario 4 is that the M2u API is used by the
external 5GMSu Application Provider for content egest.
{width="6.572916666666667in" height="2.3535279965004374in"}
Figure 5.5.2.5-1: Collaboration 5
#### 5.5.2.7 Collaboration Scenario 6
This scenario represents a hybrid, i.e. end-to-end form of collaboration
across uplink media streaming and downlink media streaming services. An
external 5GMS Application Provider relies on the 5GMS System Provider to
support both the uplink streaming media transmission by 5GMSu Clients and
subsequent distribution of that content via downlink media streaming for
reception by 5GMSd Clients.
Editor's Note: The study on the key topic "Content Preparation" includes a use
case whereby content preparation is used between uplink and downlink media
streaming, and that use case can be considered as a specific example of this
collaboration scenario.
### 5.5.3 Deployment Architectures
Editor's Note: Based on the 5GMS Architecture, develop one or more deployment
architectures that address the key topics and the collaboration models.
### 5.5.4 Mapping to 5G Media Streaming and High-Level Call Flows
#### 5.5.4.1 Collaboration scenario 1 call flow
Figure 5.5.4.1‑1 provides a high-level call flow for the scenario depicted in
clause 5.5.2.2.
> Figure 5.5.4.1-1: Collaboration scenario 1 Call flow
Steps:
1\. The 5GMSu Application Provider creates a Provisioning Session for uplink
streaming with the 5GMSu AF.
2\. The 5GMSu Application Provider creates a Content Publishing Configuration
as part of the Provisioning Session that defines the instructions for content
egest (M1u).
3\. The 5GMSu AF, based on the received Content Publishing Configuration,
requests the 5GMSu AS to instantiate the content preparation process (M3u).
4\. The 5GMSu AS initialises the content preparation process.
5\. The 5GMSu AS acknowledges the initialisation of the required process
(M3u).
NOTE: M3u procedures between the 5GMS AF and the 5GMS AS are outside the scope
of TS 26.512 [16].
6\. The 5GMSu AF acknowledges the successful creation of the Content
Publishing Configuration to the 5GMSu Application Provider (M1u).
At some later point in time:
7\. The 5GMSu Application Provider optionally provides Service Access
Information to the 5GMS-Aware Application (M8, out of scope).
8\. Uplink media streaming starts from the 5GMSu Client to the 5GMSu AS (M4u).
9\. Media streaming egest starts from the 5GMSu AS to the 5GMSu Application
Provider (M2u).
Finally:
10\. The 5GMSu AS releases its resources after observing a period of
inactivity.
NOTE: Step 10 is implementation-dependent.
#### 5.5.4.2 Collaboration scenario 2 call flow
Figure 5.5.4.2‑1 provides a high-level call flow for the scenario depicted in
clause 5.5.2.3.
Figure 5.5.4.2-1: Collaboration scenario 2 Call flow
Steps:
1\. The 5GMSu Application Provider creates a Provisioning Session for uplink
streaming with the 5GMSu AF (M1u′).
2\. The Provisioning function requests the 5GMSu AS to initialise the required
content prepatation process (M3u′).
3\. The 5GMSu AS initialises the content preparation process.
4\. The 5GMSu AS acknowledges the initialisation of the required process
(M3u′).
5\. The Provisioning function acknowledges the successful creation of the
Provisioning Session to the 5GMSu Application Provider (M1u′).
At some later point in time:
6\. The 5GMSu Application Provider provides Service Access Information to the
5GMS-Aware Application (M8, out of scope).
7\. Uplink media streaming starts from the 5GMSu Client to the 5GMSu AS (M4u).
8\. Media streaming egest starts from the 5GMSu AS to the 5GMSu Application
Provider (M2u).
Finally:
9\. The 5GMSu AS releases its resources after observing a period of
inactivity.
NOTE: Step 9 is implementation-dependent.
#### 5.5.4.3 Collaboration scenario 3 call flow
Figure 5.5.4.3-1: Collaboration scenario 3 Call flow
Steps:
1\. The 5GMSu Application Provider creates a Provisioning Session with its
internal Provisioning function (M1u′).
2\. The Provisioning function requests the 5GMSu-like AS to initialise the
required content preparation process instantiation (M3u′).
3\. The 5GMSu-like AS instantiates the content preparation process.
4\. The 5GMSu-like AS acknowledges the Provisioning the instantiation of
required process (M3u′).
5\. The Provisioning function acknowledges successful provisioning to the
5GMSu Application Provider (M1u′).
6\. The 5GMSu Application Provider creates a Provisioning Session for uplink
streaming with the 5GMSu AF.
X. The 5GMSu Application Provider creates a Content Publishing Configuration
as part of the Provisioning Session that defines the instructions for content
egest (M1u).
At some later point in time:
7\. The 5GMSu Application Provider optionally provides Service Access
Information to the 5GMS-Aware Application (M8, out of scope).
8\. The 5GMS-Aware Application requests the 5GMSu Client to start an uplink
streaming session (M6u/M7u).
9\. The 5GMSu Client optionally (and in the case step 5 was not performed)
requests Service Access Information from the 5GSMu AF (M5u).10. Uplink media
streaming starts from the 5GMSu Client to the 5GMSu-like AS (M4u′).
11\. Media streaming egest starts from the 5GMSu-like AS to the 5GMSu
Application Provider (M2u′).
Finally:
12\. The 5GMSu AS releases its resources after observing a period of
inactivity.
NOTE: This step is implementation dependent.
#### 5.5.4.4 Collaboration scenario 4 call flow
Figure 5.5.4.4-1: Collaboration scenario 5 Call flow
Steps:
1\. The 5GMSu Application Provider creates a Provisioning Session for uplink
streaming with the 5GMSu AF (M1u′).
2\. The 5GMSu Application Provider creates a Content Publishing Configuration
as part of the Provisioning Session that defines the instructions for content
egest (M1u′).
3\. The 5GMSu AF, based on the received publishing configuration, requests the
5GMSu AS to confirm the availability of content resources for egest (M3u).
NOTE: M3u procedures between the 5GMS AF and the 5GMS AS are outside the scope
of TS 26.512 [16].
4\. The 5GMSu AF acknowledges the successful creation of the Content
Publishing Configuration to the 5GMSu Application Provider (M1u′).
At some later point in time:
5\. The 5GMSu Application Provider requests that the 5GMSu AF initialises the
content preparation process (M1u′).
6\. The 5GMSd AF requests initialisation of the content preparation process
(M3u).
7\. The 5GMSd AS initialises the content preparation process, if is not
already running (M3u).
8\. The 5GMSd AS acknowledges the initialisation of the content preparation
process (M3u).
9\. The 5GMSu AF acknowledges the initialisation of the cotent preparation
process (M1u′).
10\. The 5GMSu Application Provider provides Service Access Information to the
5GMS-Aware Application (M8, out of scope).
11\. The 5GMS-Aware Application requests the 5GMSu Client to start an uplink
streaming session (M6u/M7u).
Alternatively:
12\. The 5GMS-Aware Application requests the 5GMSu Client to start an uplink
streaming session (M6u/M7u).
13\. The 5GMSu Client requests Service Access Information from the 5GSMu AF
(M5u).
14\. The 5GMSd AF requests initialisation of the content preparation process
(M3u).
15\. The 5GMSd AS initialises the content preparation process, if is not
already running (M3u).
16\. The 5GMSd AF acknowledges the initialisation of the content preparation
process (M3u).
17\. The 5GMSMu AF provides Service Access Information to the 5GMSu Client
(M5u).
Then:
18\. Uplink media streaming starts from the 5GMSu Client to the 5GMSu AS
(M4u).
19\. Media streaming egest starts from the 5GMSu AS to the 5GMSu Application
Provider (M2u′).
Finally:
20\. The 5GMSu AS releases its resources after observing a period of
inactivity.
NOTE: This step is implementation-dependent.
#### 5.5.4.5 Collaboration scenario 5 call flow
Figure 5.5.4.5-1: Collaboration scenario 5 Call flow
Steps:
1\. The 5GMSu Application Provider creates a Provisioning Session with the
5GMSu AF.
2\. The 5GMSu Application Provider requests the 5GMSu AF to create one Content
Publishing Configuration that defines the instructions for content egest
(M1u).
3\. The 5GMSu AF, based on the received Content Publishing Configuration,
requests the 5GMSu AS to confirm the availability of content resources for
egest.
NOTE 1: M3u procedures between the 5GMS AF and the 5GMS AS are outside the
scope of TS 26.512 [?].
4\. The 5GMSu AF acknowledges to the 5GMSu Application Provider the successful
creation of the Content Publishing Configuration (M1u).
At some later point in time:
5\. The 5GMSu Application Provider requests that the 5GMSu AF initialises the
content preparation process (M1u).
6\. The 5GMSd AF requests initialisation of the content preparation process
(M3u).
7\. The 5GMSd AS initialises the content preparation process, if is not
already running (M3u).
8\. The 5GMSd AS acknowledges the initialisation of the content preparation
process (M3u).
9\. The 5GMSu AF acknowledges the initialisation of the cotent preparation
process (M1u).
10\. The 5GMSu Application Provider provides Service Access Information to the
5GMS-Aware Application (M8, out of scope).
11\. The 5GMS-Aware Application requests the 5GMSu Client to start an uplink
streaming session (M6u/M7u).
Alternatively:
12\. The 5GMS-Aware Application requests the 5GMSu Client to start an uplink
streaming session (M6u/M7u).
13\. The 5GMSu Client requests Service Access Information from the 5GSMu AF
(M5u).
14\. The 5GMSd AF requests initialisation of the content preparation process
(M3u).
15\. The 5GMSd AS initialises the content preparation process, if is not
already running (M3u).
16\. The 5GMSd AF acknowledges the initialisation of the content preparation
process (M3u).
17\. The 5GMSMu AF provides Service Access Information to the 5GMSu Client
(M5u).
Then:
18\. Uplink media streaming starts from the 5GMSu Client to the 5GMSu AS
(M4u).
19\. Media streaming egest starts from the 5GMSu AS to the 5GMSu Application
Provider (M2u).
Finally:
20\. The 5GMSu AS releases its resources after observing a period of
interactivity.
NOTE: This step is implementation dependent.
As is shown, a new resource type, the Content Publishing Configuration is
added. This describes the configuration of the egest (M2u) used in step 19.
#### 5.5.4.6 Collaboration scenario 6 call flow
The call flow for this collaboration scenario is described in 5.2.6.3.
### 5.5.5 Potential open issues
#### 5.5.5.1 Potential open issues in 5G Media Streaming stage 3
The following open issues seem to exist in TS 26.512 [16]:
1\. Lack of a standard template (or clear reference on how to use an existing
standard template) for inclusion in a Content Publishing Configuration, i.e.
to be able to provide content preparation instructions in a defined,
interoperable format that the 5GMS AF supports through M1.
2\. Lack of definition of protocols for media egest from the 5GMSu AS to the
5GMSu Application Provider in uplink throughvia M2u.
NOTE: The Content Protocols Discovery APIs allows the 5GMSu Application
Provider to discover the supported egest protocols by 5GMSu AS. However,
clause 8.1 of TS 26.512 does not currently list any specific egest protocols
alongside those for downlink ingest streaming.
3\. Lack of content publishing API, i.e. a similar functionality to Content
Hosting Configuration in downlink streaming, for provisioning the uplink
streaming through M1u..
> 4\. Lack of Service Access Information for uplink streaming.
For downlink streaming, TS 26.512 [16] defines a _StreamingAccess_ object as
part of the _Service‌Access‌Infromation_ resource. The _StreamingAccess_
object includes a URL string that points to a media download resource or a
manifest that describes a media presentation. In the case of uplink streaming,
TS 26.512 does not yet specify which uplink streaming protocols are supported
in M5u. Furthermore, it is not clear how the Media Session Handler would
retrieve the entry point for uplink streaming to the 5GMSu AS.
#### 5.5.5.2 Potential open issues compared with FLUS
##### 5.5.5.2.1 General
Clause 5.5.1.3 describes the uplink streaming features from TS 26.238 [14]
that are missing from TS 26.512 [16]. This section translates these missing
FLUS features into potential new 5G Media Streaming features.
Table 5.5.5.2 shows a list of FLUS features and the equivalent features
missing from TS 26.512. Note that in this table, the missing features of TS
26.512 are only listed for further discussion below, i.e. this is not a list
of proposed features to be added.
Table 5.5.5.2‑1: Mapping existing additional features of FLUS to 5GMS
architecture
Feature # Existing support in FLUS Equivalent in 5GMS Needed or not?
* * *
1 The FLUS Control Source can discover multiple FLUS sinks. The 5GMSu Client
can discover multiple 5GMSu AS instances. Supported by Edge Application Server
(EAS) profile discovery as defined in TR 26.803 [Y] (see Discussion 1 below).
2 The FLUS Control Source can discover the capabilities of each discovered
FLUS Sink, including its network-based media processing capabilities. The
UE5GMSu Client can discover the capabilities of each discovered 5GMSu AS.
Supported by EAS profile discovery (see Discussion 1 below). 3 The FLUS
Control Source can also request a FLUS Sink to perform media processing. The
UE can also request the 5GMSu AS to perform media processing. Not needed if
the Content Preparation Template supports a generic media processing
description such as NBMP (see Discussion 2 below). 4 The UE capabilities
(formats, connectivity protocol, remote control) may be discovered by a FLUS
Control Sink. The 5GMSu Client capabilities may be discovered by 5GMSu AF. Not
needed in this form, since this information can be provided by 5GMS
Application Provider (see Discussion 3 below).
See the discussions below for further explanation.
##### 5.5.5.2.2 Discussion 1
The FLUS Discovery Server provides the means for a FLUS Control Source to
discover multiple FLUS sinks and their capabilities. In the 5GMS architecture,
various 5GMSd AS instances might have different capabilities. However, TS
26.512 does not provide a framework for describing 5GMS AS capabilities or any
capability-based discovery mechanism.
TR 26.803 [46] proposes an edge-enabled 5GMS architecture for discovering EAS-
enhanced 5GMSd AS instances and their capabilities by an Edge-Enabled Client
(EEC) using EAS discovery filters. One possible way to discover 5GMSu AS
capabilities and/or to instantiate a new 5GMSu AS with the desired
capabilities is to use the procedure described in TS 26.803 [46] for the 5GMSu
AS. This approach requires that the 5GMSu Client's Media Session Handler
supports the EEC logical function, the 5GMSu AF supports the EES logical
function, and the 5GMSu AS supports the EAS logical function, as defined by TS
23.558 [47].
##### 5.5.5.2.3 Discussion 2
In some deployment scenarios, the request for media processing is performed by
a FLUS Control Source by including a media processing document in its request
to the FLUS Control Sink. Since in the present document content preparation is
investigated for uplink streaming collaboration scenarios (clause 5.2.4.2 in
the content preparation key topic), such functionality can also be used for
media processing. If the content preparation template supports a generic media
processing description framework such as NBMP, then content preparation can be
used to provide equivalent functionality to media processing in the FLUS
specification.
The 5GMS Content Preparation Template is provisioned through the M1 interface
whereas in FLUS it is possible that the media processing is provisioned using
the equivalent of the M5u interface. To provide the UE with the ability to
provision Content Preparation Templates, the following are possible options:
A. The 5GMSu-Aware Application (if needed) provides the desired Content
Preparation Template to the 5GMSu Application Provider via M8u and then the
Application Provider requests provisioning of the Content Preparation Template
through M1u, or
B. The Media Session Handler in the 5GMSu Client requests the setting up of a
Content Preparation Template by direct interaction with the 5GMSu AF via M5u.
In this case, M5u needs to be extended to support Content Preparation Template
provisioning requests from the Media Session Handler.
The current design supports option A. Option B seems unnecessary for the
following reasons:
\- It wouldn't be scalable to maintain a separate uplink streaming
Provisioning Session at the 5GMSu AF for each and every UE, especially as the
number of UEs becomes large.
\- In the current design, it is possible to create a separate Provisioning
Session for each class of UE. In this approach, the UE signals its
capabilities to the 5GMSu AF when requested Service Access Information at M5u,
and then it is the task of 5GMSu AF to match the declared UE capabilities
against the right uplink Provisioning Session metadata when responding to the
request.
##### 5.5.5.2.4 Discussion 3
In the 5GMS architecture, the session is generally provisioned by the 5GMSu
Application Provider. The Application Provider may already know the 5GMSu
Client's capabilities, for example through information in a user profile, or
provided by the 5GMSu-Aware Application via M8u. Therefore, the need for the
5GMSu AF to discover the 5GMSu Client capabilities through M5u seems
unnecessary.
### 5.5.6 Candidate Solutions
Since TS 26.512 [16] already defines solutions for the content ingest
concerning the open issues of 5.5.5, one possible approach is to allow similar
data structures, APIs, and protocols for content egest.
NOTE: The candidate solution provided in the present document merely shows the
desired features (by mirroring the distribution features) and is not intended
as a proposed solution.
#### 5.5.6.1 Content egest protocols
The existing ingest protocols can be used for egest.
Table 5.5.6.1-1: Adding egest content protocols
Description Term identifier Clause
* * *
Content ingest protocols at interface M2d  
HTTP pull-based content ingest protocol _urn:3gpp:5gms:content-protocol:http-
pull-ingest_ 8.2 DASH-IF push-based content ingest protocol
_urn:3gpp:5gms:content-protocol:dash-if-ingest_ 8.3 **Content egest protocols
at interface M2u**  
HTTP pull-based content ingest protocol _urn:3gpp:5gms:content-protocol:http-
pull-ingest_ 8.2 DASH-IF push-based content ingest protocol
_urn:3gpp:5gms:content-protocol:dash-if-ingest_ 8.3
The highlighted rows indicate the added protocols.
#### 5.5.6.2 Content Publishing Configuration API
An M1u API, similar to the M1d Content Hosting Configuration API as used for
content ingest, can be defined for content egest.
Table 2: Operations supported by the Content Egest Configuration API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create Content | cont | POST | Used to create | | Publishing | ent-publishing | | a Content | | Configuration | -configuration | | Publishing | | | | | Configuration | | | | | resource. | +----------------+----------------+----------------+----------------+ | Retrieve | | GET | Used to | | Content | | | retrieve an | | Publishing | | | existing | | Configuration | | | Content | | | | | Publishing | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Update Content | | PUT, | Used to modify | | Egest | | | an existing | | Configuration | | PATCH | Content Egest | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Delete Content | | DELETE | Used to delete | | Publishing | | | an existing | | Configuration | | | Content | | | | | Publishing | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Purge Content | content-pu | POST | This operation | | Publishing | blishing-confi | | is used to | | Configuration | guration/purge | | invalidate | | cache | | | some or all | | | | | cached media | | | | | resources | | | | | associated | | | | | with this | | | | | Content | | | | | Publishing | | | | | Configuration. | +----------------+----------------+----------------+----------------+
As is shown in the table, the sub-resource path in particular is changed for
this resource, and other aspects remain identical to Content Hosting
Configuration API.
#### 5.5.6.3 Content Publishing Configuration Template
The Content Publishing Configuration resource, modelled after the Content
Hosting Configuration resource, is shown in Table 5.5.6.3-1.
Table 5.5.6.3-1: Definition of Content Publishing Configuration resource
+-------------------+------------+-------------+-------------------+ | Property name | Data Type | Cardinality | Description | +===================+============+=============+===================+ | _name_ | String | 1..1 | A name for this | | | | | Content | | | | | Publishing | | | | | Configuration. | +-------------------+------------+-------------+-------------------+ | _Publish | Object | 1..1 | Describes the | | ingConfiguration_ | | | 5GMSu Application | | | | | Provider\'s | | | | | origin server to | | | | | which media | | | | | resources will be | | | | | egested via | | | | | interface M2u. | +-------------------+------------+-------------+-------------------+ | _path_ | String | 1..1 | The relative path | | | | | which will be | | | | | used to address | | | | | the media | | | | | resources at | | | | | interface M2u. | | | | | | | | | | This path is | | | | | provided by the | | | | | 5GMSu AF in the | | | | | case of | | | | | pull-based egest. | +-------------------+------------+-------------+-------------------+ | _pull_ | Boolean | 1..1 | Indicates whether | | | | | to the 5GMSu AS | | | | | shall use Pull or | | | | | Push for egesting | | | | | the content. | +-------------------+------------+-------------+-------------------+ | _protocol_ | URI String | 1..1 | A fully-qualified | | | | | term identifier | | | | | allocated in the | | | | | name space | | | | | _urn:3gpp:5gms: | | | | | content-protocol_ | | | | | that identifies | | | | | the content egest | | | | | protocol. | | | | | | | | | | The set of | | | | | supported | | | | | protocols is | | | | | defined in Table | | | | | XXX. | +-------------------+------------+-------------+-------------------+ | _entryPoint_ | String | 1..1 | An entry point to | | | | | egest the | | | | | content. The | | | | | semantics of the | | | | | entry point are | | | | | dependent on the | | | | | selected egest | | | | | protocol. | | | | | | | | | | In the case of | | | | | Pull ingest | | | | | (_pull_ flag is | | | | | set to True), | | | | | this parameter is | | | | | returned by the | | | | | 5GMSu AF to the | | | | | 5GMSu Application | | | | | Provider and | | | | | indicates the | | | | | entry point for | | | | | pulling the | | | | | content. In this | | | | | case, the | | | | | _entryPoint_ | | | | | shall be used as | | | | | the base URL. In | | | | | this case, the | | | | | relative URL | | | | | content address | | | | | is provided out | | | | | of band (e.g. | | | | | with a manifest | | | | | through M8u) to | | | | | the 5GMSu | | | | | Application | | | | | Provider. | | | | | | | | | | In case of Push | | | | | (_pull_ flag is | | | | | set to _false_), | | | | | the _entryPoint_ | | | | | shall be provided | | | | | to the 5GMSu AF | | | | | to indicate the | | | | | location to which | | | | | content is to be | | | | | pushed. In this | | | | | case, the | | | | | _entryPoint_ | | | | | shall be used as | | | | | the base URL. | +-------------------+------------+-------------+-------------------+ | _Contributi | Object | 1..N | Specifies content | | onConfigurations_ | | | preparation for | | | | | the egested | | | | | content. | +-------------------+------------+-------------+-------------------+ | _contentPrepa | String | 0..1 | Indicates that | | rationTemplateId_ | | | content | | | | | preparation prior | | | | | to egest is | | | | | requested by the | | | | | 5GMSu Application | | | | | Provider. | +-------------------+------------+-------------+-------------------+ | _can | String | 1..1 | All resources of | | onicalDomainName_ | | | the upload shall | | | | | be accessible | | | | | through this | | | | | _default_ FQDN | | | | | assigned by the | | | | | 5GMSu AF. | +-------------------+------------+-------------+-------------------+ | _certificateId_ | String | 0..1 | When content is | | | | | distributed using | | | | | TLS [16], the | | | | | X.509 certificate | | | | | for the origin | | | | | domain is shared | | | | | with the 5GMSd AF | | | | | so that it can be | | | | | presented by the | | | | | 5GMSd AS in the | | | | | TLS handshake at | | | | | M2d. This | | | | | attribute | | | | | indicates the | | | | | identifier of the | | | | | certificate to | | | | | use. | +-------------------+------------+-------------+-------------------+
Note that in the above table:
1\. The Pull mode is defined when the Application Service Provider pulls the
content from the 5GMSu AS, and conversely, the Push mode is defined when the
5GMSu AS pushed the content to Application Service Provider.
2\. Each parameter description is updated based on item 1.
3\. Since in the Pull mode, the Application Service Provider needs to have the
content URL addresses, it is assumed that that information is provided by
other means (e.g. through M8u by the 5GMSu Aware Application).
4\. The _DistributionConfigurations_ property in the Content Hosting
Configuration resource for M1d is here replaced by the
_ContributionConfigurations_ property.
5\. The _ContributionConfigurations.contentPreparationTemplateId_ property
identifies the Content Preparation Template to be used. Like the Content
Preparation Template resource as defined for downlink streaming in TS 26.512
[16], the data model of this resource is determined by its MIME content type.
#### 5.5.6.4 Uplink entry point
The _StreamingAccess_ object in the Service Access Information resource can be
extended to support uplink streaming entry points. This object may include the
following information:
> \- A URN, indicating an uplink streaming protocol provisioned for use over
> M4u (e.g. MPEG DASH, HLS, DASH-IF Ingest profile 1 or profile 2)
>
> \- The entry URL for the above service (i.e. address of the 5GMSu AS for
> uplink streaming delivery by Media Streamer over M4u).
Additionally, the _StreamingAccess_ property may include alternative media
uplink streaming protocols for the same Provisioning Session by making it an
array. For instance, two different entry points may be described in the
Service Access Information for uplink streaming using DASH-IF Ingest profile 1
and profile 2.
An example of such extension is shown in the following table:
Table 5.5.6.4‑1: Definition of ServiceAccessInformation resource\ (based on an
extract from clause 11.2.3.1 of TS 26.512 [16])
+--------------+--------------+-------------+-------+--------------+ | Property | Type | Cardinality | Usage | Description | | name | | | | | +==============+==============+=============+=======+==============+ | _provisioni | String | 1..1 | RO | Unique | | ngSessionId_ | | | | id | | | | | | entification | | | | | | of the M1d | | | | | | Provisioning | | | | | | Session. | +--------------+--------------+-------------+-------+--------------+ | _..._ | | | | | +--------------+--------------+-------------+-------+--------------+ | _Stre | A | 1..1 | RO | | | amingAccess_ | rray(Object) | | | | +--------------+--------------+-------------+-------+--------------+ | > _med | Urn | 1..1 | RO | A | | iaEntryType_ | | | | ful | | | | | | ly-qualified | | | | | | term | | | | | | identifier | | | | | | from the | | | | | | controlled | | | | | | vocabulary | | | | | | _urn:3gpp | | | | | | :5gms:conten | | | | | | t-protocol_ , | | | | | | as specified | | | | | | in clause 8, | | | | | | indicating | | | | | | the type of | | | | | | media | | | | | | service | | | | | | available at | | | | | | * | | | | | | mediaEntry _. | +--------------+--------------+-------------+-------+--------------+ | > _media~~Pl | Url | 1..1 | RO | For downlink | | ayer~~Entry _| | | | streaming: | | | | | | Depending on | | | | | | the type of | | | | | | media entry | | | | | | indicated in | | | | | |_ medi | | | | | | aEntryType _, | | | | | | either a | | | | | | pointer to a | | | | | | document | | | | | | that defines | | | | | | a media | | | | | | presentation | | | | | | (e.g. MPD | | | | | | for DASH | | | | | | content) | | | | | | that can be | | | | | | consumed via | | | | | | M4d, or else | | | | | | the URL of a | | | | | | media | | | | | | resource | | | | | | that can be | | | | | | streamed at | | | | | | M4d. | | | | | | | | | | | | For uplink | | | | | | streaming: | | | | | | Depending on | | | | | | the type of | | | | | | media entry | | | | | | indicated in | | | | | |_ medi | | | | | | aEntryType*, | | | | | | either a URL | | | | | | endpoint on | | | | | | the 5GMSu AS | | | | | | to which | | | | | | media can be | | | | | | streamed | | | | | | directly at | | | | | | M4u, or else | | | | | | the URL of a | | | | | | document | | | | | | that can be | | | | | | downloaded | | | | | | from the | | | | | | 5GMSu AS | | | | | | which | | | | | | contains the | | | | | | parameters | | | | | | for uplink | | | | | | media | | | | | | streaming at | | | | | | M4u. | +--------------+--------------+-------------+-------+--------------+
### 5.5.7 Conclusion
This key issue has explored five collaboration scenarios for uplink streaming
in the 5G Media Streaming architecture. For each scenario, a high-level call
flow has been developed. Several gaps were identified during this process.
Additionally, the uplink steaming features of TS 26.501 [15] and TS 26.512
[16] were compared with both TS 26.238 [14] as well as the download streaming
features of TS 26.501 and TS 26.512, and the missing features are identified.
As this study shows, uplink streaming is severely underspecified in TS 26.501
and TS 26.512 in Release 16, and the following gaps are identified:
1\. Collaboration scenarios and their associated call flows described in
clauses 5.5.2 and 5.5.3.
2\. Protocol(s) for egesting uplink streaming to the 5GMSu Application
Provider through M2.
3\. Content Publishing Configuration API to enable a 5GMSu Application
Provider to create, update, retrieve and delete a publishing template through
M1.
4\. Content Publishing Template to describe the publishing configuration from
the 5GMSu AS to the 5GMSu Application Provider, including content preparation
prior to egest.
5\. Entry point for the UE's uplink media streaming to the 5GMSu AS that is
obtained by the UE through M5.
## 5.6 Background traffic
### 5.6.1 Description
Mobile Network Operators (MNO) are faced with the challenge of overload of
their networks during peak hours. The following diagram shows a typical
distribution of traffic over the day hours in a residential area:
{width="6.69375in" height="3.2284722222222224in"}
Figure 5.6.1-1: Example of traffic distribution over time
Note that the traffic distribution is also highly dependent on the geographic
area. For instance, traffic distribution in a residential area maybe quite
different from traffic distribution in a business or commercial area. Another
example is traffic along roads during commute hours, which maybe higher by
orders of magnitude than traffic during other hours.
As can be seen from the diagram, the traffic distribution is non-
uniform/uneven throughout the day, which leads to congestion during the peak
hours and very low utilization during off-peak hours. To alleviate this
situation, the MNO may incentivize offloading traffic to off-peak hours to
balance the network resource usage throught the day. The incentives may be
provided in terms of preferential charging and guaranteed QoS.
### 5.6.2 Collaboration Scenarios
MNO and content provider enter an SLA that allows the content provider to
distribute its content during off-peak hours to a set of receivers in a pre-
determined geographic location.
Collaboration scenarios 2,4,5,7, and 8 from [TS256.501] are potential
collaboration scenarios for traffic offloading using Background Data Transfer.
### 5.6.3 Deployment Architectures
There is no anticipated change to the 5G media streaming architecture to
enable the usage of Background Data Transfer (BDT) for media distribution.
### 5.6.4 Mapping to 5G Media Streaming and High-Level Call Flows
The following is a potential high-level call flow for the configuration and
usage of a BDT session in 5G media streaming:
Figure 5.6.4-1: Potential call flow for BDT session configuration and
establishment
### 5.6.5 Potential open issues
The extensions to the client APIs, Provisioning API, and 5GMSd AF services to
enable signaling and management of background data traffic sessions need to be
specified.
### 5.6.6 Candidate Solutions
#### 5.6.6.1 Existing APIs to provision Background Data Transfer
The NEF offers the _ResourceManagementOfBdt_ API, as defined in clause 5.4 of
TS29.122 [44], to allow AF consumers to create, manage, and track Background
Data Transfer (BDT) policies. The NEF also offers the _ApplyingBdtPolicy_ API
to request the application of a previously defined BDT policy for a particular
UE or group of UEs.
The PCF offers the _Npcf_BDTPolicyControl_ API, as defined in clause 5 of
TS29.554 [55], to allow consumers to create and update BDT policies. The NF
consumer may subscribe to notifications about any changes to the network
conditions that affect a BDT policy.
A BDT policy consists of multiple transfer policies, each bounded by a time
window in wallclock time. The 5GMS AF will select one of the transfer policies
to apply.
#### 5.6.6.2 Potential Solution
Background Data Transfer is a generic feature that may be used by an
Application Service Provider to pre-load content during time periods
recommended by the MNO onto a UE. This feature can be suitable for multimedia
streaming services but was developed to support other use-cases (such as
automotive).
In this potential solution, the support for background data transfer in 5GMS
can be realized by the following procedures:
1\. Provisioning by the 5GMS Application Provider to enable the usage of
background data traffic and to define the background data transfer policy. The
BDT policy may be part of the general QoS policy templates.
2\. Creation, updating, and monitoring the usage of the background data
transfer policy in collaboration with the PCF. This may be done using the
procedures described in 5.6.6.1.
3\. Communication of the background data transfer policy to the UE, e.g. as
part of the access information.
4\. Registration by the 5GMS-Aware Application (via the Media Session Handler)
with the 5GMS AF to use background data transfer.
5\. Notification by the 5GMS AF to the Media Session Handler of an opportunity
to perform background data transfer.
6\. Activation of the background data transfer policy for the QoS flow, over
which the transfer will happen.
Provisioning the background data transfer feature (step 1) is realized through
an extension to the dynamic policy template as defined in clause 7.9.3 of TS
26.512 [16]. The dynamic policy template may, for example, be extended to
include an additional property _BdtReqData_ as defined in clause 5.6.2.3 of TS
29.554 [55].
The 5GMS AF uses the provisioning information to create or select a background
data transfer policy within the PCF. For this purpose, it may use the
_Npcf_BDTPolicyControl_ or the _ResourceManagementOfBdt_ API.
Once the policy is created, future downlink media streaming sessions will be
able to use the defined background data transfer policy. The 5GMS AF provides
the information about the background data transfer policy to the UE as part of
the Service Access Information at reference point M5.
The M6 interface is extended to allow the application to request background
download of content from the Media Session Handler. As a result, the Media
Session Handler registers with the 5GMS AF to receive notifications about the
availablity of a background data transfer opportunity. Once a download
opportunity manifests itself, the 5GMS AF notifies the Media Sesssion Handler
about the time window available for background content download, and the Media
Session Handler will either perform the download itself, or else invoke the
application to download the content. In case the MSH performs the download,
appropriate extensions to the M6 API would be required to manage the access to
and notification about completed/aborted download operations.
NOTE: Integration of background data transfer with 5MBS is for future study.
Alignment with the xMB API should be considered as part of this.
### 5.6.7 Conclusion
Background Data Transfer (BDT) is a feature that is offered by the 5G System
to allow for data transfer during specific time windows with pre-arranged QoS
and charging policies. Both PCF and NEF offer the required APIs to configure
and use BDT. The discussion and the potential solution lay out the necessary
extensions to integrate BDT as part of 5GMS procedures.
It is recommended that normative work is started to address the following
objectives:
1\. Define the necessary extensions to 5GMS stage 2 and stage 3 to define the
procedures and APIs to enable the use of Background Data Transfer in 5GMS,
including:
a) Provisioning of BDT for content hosting and distribution through M1
b) Configuration of BDT and subscribe/notification for transfer opportunities
and time windows through M5.
c) Usage of BDT by the application through M6.
2\. Liaise with other relevant 3GPP groups to align on the usage of the BDT
feature.
## 5.7 Content-Aware Streaming
### 5.7.1 Description
Content-Aware Encoding and statistical multiplexing of services are important
and relevant technologies in the media industry. The impacts and opportunities
of such technologies for 5GMS is not fully understood and requires study. For
example, the currently-defined 5GMSd Application Function (AF) based network
assistance solution is exclusively triggered by the Media Player, which
instructs the Media Session Handler to interact with the Network. It might be
more efficient for such network assistance functionality to be obtained
directly from the content provider based on dynamic content complexity.
Greater interaction with the 5GMS Application Provider during the lifetime of
a session should be studied.
According to [2], if one analyses, almost any movie or television show scene
by scene, you'll notice the content has varying needs in terms of its
fundamental complexity. Scenes with a lot of action and detail need a lot more
bits in order to hit a quality target, whereas other scenes---say, a
newsreader delivering a monologue---can achieve the same quality target with a
reduced number of bits.
As an example, a game sequences provided for XR Traffic was encoded with x265
over 1 minute in Figure 5.7.1‑1. One can see that at the same quality, the
number of bits required to represent the content can be quite different.
[[CHART]]{.chart}
Figure 5.7.1-1: Bit rate and quality over time for an example sequence.\ (Blue
bits, red PSNR in dB × 100)
Ideally, to maintain quality, one wants the bit rate to vary over time to
maintain consistent quality regardless of the complexity of the scene. Four
different scene types may be considered, and they differ in complexity- easy,
moderate, hard, and very hard to compress. The "very hard" content might be a
panning shot over a crowd, a shot of confetti falling, or simply a scene with
a lot of high motion. Scenes such as these require more bits to convert all
the motion and detail into a high-quality output that can be decoded and
recreated accurately. A moderate scene, perhaps a close-up of a car, or an
easy scene, like a single person speaking with no camera movement, will
require fewer bits to deliver the same quality target as the harder scenes. In
order to most efficiently encode the entire video, ideally a rate control mode
that allocates more bits to the complex scenes, and fewer bits to the easier
ones.
Different rate control algorithms exist:
> \- **CBR:** Constant-Bit Rate encoding keeps the bit rate at a constant
> level, but the quality fluctuates. In ancient systems such as MPEG-2 TS,
> this is even addressed by sending lots of filler data just to keep the pipe
> constant
>
> \- **VBR:** Variable Bit Rate encoding following the principle from above to
> keep the quality constant. This is often also referred to as Content-Aware
> Encoding nowadays (CAE).
>
> \- **Capped VBR:** in this case the basic idea is to ensure that you have a
> mix of the above, i.e. a certain bit rate is never exceeded, but in case the
> content does not need the data rate, less data is sent.
The below diagram attempts to address and show these issues, but is more
confusing then helpful.
{width="6.395833333333333in" height="2.8125in"}
Figure 5.7-2: Capped VBR rate control encoding compared with CBR and VBR
Variance in bit rates for different users may also result on the device and
the consumption model. For a smaller screen, quite likely quality and bit rate
requirements can be lower than for example going to a large screen such as a
4K TV.
The 3GPP QoS model contradicts this, as typically resources and QoS parameters
are assigned for a session and only GBR is addressed.
From a adaptive bitaret streaming perspective, this content model needs to
also be viewed as part on the streaming model, as the complexity of the
content may be addressed based on the buffer availability, and also the
situation of the network needs to be studied.
1) On-demand Streaming:
a. Stationary streaming of C-VBR/CBR content: Typically one operates with
receiver buffer levels of 5-30 seconds [check details in TS 26.512]. One tries
to keep the buffer filled. As soon as your buffer drains below some threshold,
the client triggers a down-switch to a more sustainable bit rate. Switching
typically can happen at segment boundaries, for example every 2 seconds.
b. Start-up and seek. In this case, one starts basically starts from an empty
buffer. In order to have quick and stable start up and good quality right
away, there may be a benefit to get a higher short-term bit rate from the
network to fill the buffer quicker to at least the switching threshold as you
would not start playback until the threshold is reached. This is a very
instantaneous action and needs to be fulfilled instantanteously, at most after
1 second.
c. Stationary streaming of VBR/CAE content: In this case you basically operate
on buffers of 5-30 seconds as above. The client typically has a map of the bit
rate over time profile. In this case the client knows how much bit rate it
needs for the next 5-10 seconds in order to keep the buffer stable and it can
provide this information in a continuous manner to the network. The network
will then grant a certain bit rate. This aspect may be fulfilled with using
existing 5GMS functionalities.
2) Live Streaming and especially low-latency live streaming:
a. _General:_ In this case the buffer is something of duration 1-5 seconds, it
can be kept really low for low-latency streaming. Typically, one operates e2e
latency of 3-5 seconds, so the buffer in the client is low. In addition, the
client does not know the exact bit rate of the content as it is produced on
the fly. Switching can typically be done every 1--2 seconds.
b. _Stationary streaming CBR:_ the buffer is much more susceptible, and you
may have a threshold of maybe 500 ms when the client needs a fast arriving
Segment is not arriving fast enough. This aspect may be fulfilled with using
existing 5GMS functionalities.
c. Start-up is similar to on-demand streaming as your buffer is anyways low.
So no difference.
d. Yet another and probably the most interesting case is the live case, for
which the content and each of Representations are VBR encoded, but more
following the content complexity and VBR/CAE is done as shown below. The
content complexity is not known in advance, but it needs to be provided on an
content ingest interface to the network. In this case, the network should
provision very fast and dynamically the bit rate if needed, but can relax.
There are many other cases, where content complexity and device
characteristics need to be taken into account when addressing quality of
service.
### 5.7.2 Collaboration Scenarios
In the following, difference collaboration scenarios are provided. In Figure
5.7-3, content is generated by a third-party content provider in different
formats and configurations, taking into account for example:
> 1) Different device types (resolution, frame rates, codecs).
>
> 2) Different streams (target qualities and bit rates).
>
> 3) Encoding parameters (CBR, VBR, etc.).
{width="6.322916666666667in" height="2.5in"}
Figure 5.7-3: Content-Aware Streaming based on static parameters
The network and client can make use of this information in order to optimize
the streaming.
In a second variant, not only static information is provided, but also dynamic
information with the media stream. This data is provided from the content
provider to the 5G Media Streaming system and the client.
{width="6.572916666666667in" height="2.8020833333333335in"}
Figure 5.7-4: Content-Aware Streaming based on dynamic parameters
The client can use the information for:
> \- Optimizing its own quality.
>
> \- Acting fairly in a way that it only requests higher bit rates when the
> content is more complex, but leaves remaining capacity to the community.
In an On-Demand service, the use of the information is client controlled, i.e.
the network is unaware of content complexity.
> \- Client downloads a description of the content variations and the
> associated quality initially.
>
> \- Client now brokers with the network for an average bit rate, but ability
> to request higher bit rate when content is complex
>
> \- DASH client includes logic to use the VBR options smartly to ask for
> "boosts" ahead of time when content is complex
Live Streaming and Ingest (network more actively included in streaming):
> \- Encoder provides as early as possible indication that content for same
> quality is getting a complex.
>
> \- Network uses this and identifies, if and how to fulfill this for the
> clients that request it.
>
> \- To not confuse client throughput estimation, communication between
> network and client is necessary.
### 5.7.3 Deployment Architectures
Editor's Note: Based on the 5GMS Architecture, develop one or more deployment
architectures that address the key topics and the collaboration models.
### 5.7.4 Mapping to 5G Media Streaming and High-Level Call Flows
Editor's Note: Map the key topics to basic functions and develop high-level
call flows.
### 5.7.5 Potential open issues
Editor's Note: Identify the issues that need to be solved.
### 5.7.6 Candidate Solutions
Editor's Note: Provide candidate solutions (including call flows) for each of
the identified issues.
## 5.8 Network Event usage
### 5.8.1 Description
#### 5.8.1.1 Events exposed by 5GMS AF
The 5GMS AF performs several critical support operations for media streaming
sessions. It also is responsible for collecting information about the progress
and status of media streaming sessions. This information may be of interest to
the AP or to other NFs in the network.
Thee 5G architecture defines event exposure mechanisms by the AF to other NFs
in the network. TS 23.501 [23] and TS 23.502 [24] define the stage 2 Exposure
service that can be offered by the AF. In TS 29.517 [25], the stage 3
realization of the Event Exposure service is specified as a RESTful API.
The resource structure is replicated in the following figure for convenience:
An Event Consumer subscribes to an application event and provides a URL on
which it desires to receive the related event notifications. Both periodic
reporting and immediate event reporting options are available. Event Filter
Information and Event Reporting Information definitions as specified in TS
23.502 [24] and TS 29.517 [25] are used by the Event Consumer to indicate the
desired event parameters and method of reporting for the selected event set.
So far, the following _AfEvent_ s are defined:
Enumeration value Description Applicability
* * *
_SVC_EXPERIENCE_ Indicates that the event subscribed is service experience
data for an application. _ServiceExperience_ _UE_MOBILITY_ Indicates that the
event subscribed is UE mobility information. _UeMobility_ _UE_COMM_ Indicates
that the event subscribed is UE communication information. _UeCommunication_
_EXCEPTIONS_ Indicates that the event subscribed is exceptions information.
_Exceptions_
Additional _AFEvent_ s may be defined.
#### 5.8.1.2 Events consumed by 5GMS AF
The 5GMSd AF may subscribe for event notifications related to application
sessions, and receive event notifications for these sessions. Currently, TS
26.512 [16] requires the 5GMSd AF to subscribe with the PCF for the following
types of event notifications:
> \- Service Data Flow QoS notification control;
>
> \- Service Data Flow deactivation;
>
> \- Resources allocation outcome.
Additional events of interest to the 5GMSd AF are for further study.
### 5.8.2 Collaboration Scenarios
The Application Provider (AP) is outsourcing part of its content hosting to
the MNO. The AP makes use of the Provisioning APIs to configure its content
distribution. The AP would like to track the usage of the network resources
for the distribution of its content as well as the QoE for its mobile
subscribers. At the same time, it may choose to limit access to this
information by the MNO to protect the AP's service interests and/or user's
privacy. The AP configures data collection from UEs and the 5GMSd AS(s) to
identity the data to be collected as well as the permitted entities and access
levels to that data. The 5GMSd AF triggers the data collection accordingly and
uses the AF Event Exposure framework to notify Event consumers about collected
data and events.
### 5.8.3 Deployment Architectures
The deployment architecture for the data collection and exposure by the 5GMSd
AF is depicted by the following figure:
{width="4.3565748031496065in" height="2.0659722222222223in"}
Figure 5.8.3‑1: Provisioning and Exposure Architecture
### 5.8.4 Mapping to 5G Media Streaming and High-Level Call Flows
The following is a sample call flow of the operation of the data collection
and exposure by the 5GMSd AF:
Figure 5.8.4‑1: Call flow for event exposure
A description of the steps is as follows:
1\. _Provision data collection:_ The Application Provider provisions the data
collection by configuring the data that is to be collected for all streaming
sessions of this Provisioning Session.
2\. _Trigger data collection:_ The 5GMS AF determines the data that is to be
collected from the UE and provides this configuration to the Media Session
Handler.
3\. _Trigger data collection:_ The 5GMS AF determines the data that is to be
collected by the 5GMS AS and uses the M3 interface to configure the 5GMS AS.
4\. _Subscribe-notify pattern -- Subscribe:_ In this phase, Event Consumers
subscribe for the reception of notifications from the 5GMS AF. This phase may
happen at any time. Subscriptions may be updated and canceled.
5\. _Consumption and QoE reports:_ The Media Session Handler collects logs and
information and sends them to the 5GMS AF.
6\. _Access logs:_ The 5GMS AS collects logs and sends the information to the
5GMS AF
7\. _Data aggregation and filtering:_ In this phase, the 5GMS AF aggregates
the information received in the data collection phase, determines for each
Event consumer the allowed level of access, and provides the information to
the Event Consumers.
8\. If an Event Consumer opted for the subscribe-notify pattern, the 5GMS AF
sends a notify message to that Event Consumer.
9\. In case the Event Consumer opted for the Query pattern, by setting the
_immRep_ flag to true, the 5GMS AF sends a one-time response with the event
information to that Event Consumer.
### 5.8.5 Potential open issues
The following events are expected to be defined:
> • Consumption reporting: this event contains reports sent by the UE about
> the consumption of the service, in terms of streaming session establishment.
>
> • Quality of Experience Metrics reporting: this event contains reports sent
> by the UE about the QoE of the streaming sessions.
>
> • Network Assistance: this event contains reports collected by the AF on the
> usage of network assistance such as bitrate recommendation and bitrate boost
> requests that have been offered for a streaming session.
>
> • QoS and Charging usage: this event contains reports about QoS and charging
> policy requests made by the 5GMS AF for a streaming session.
>
> • Access logs: this event contains reports about the access to the streaming
> content that is hosted by the network.
The granularity of the access to this information depends on the authorized
access level. For each of these events, the triggers for the data collection
and the levels of access to the collected data need to be defined as well.
### 5.8.6 Candidate Solution
#### 5.8.6.1 UE Data Collection via Direct and Indirect Methods
The 5GMS AF is designed to be the recipient of various types of application
event information specific to media streaming, such as consumption reports,
metrics reports and AF-based network assistance interactions, from the 5GMS
Client (its Media Session Handler) over the M5 interface. Such _collection_ of
UE data is referred to in SA2's eNA_Ph2 work item (see TS 23.288 [48]) as
"direct data collection".
It is possible that data collection from the UE is accomplished by the M8
application layer interface between the 5GMS-Aware Application and the 5GMS
Application Provider (or, more generically, the Application Service Provider),
and in turn forwarded by the ASP to the 5GMS AF, for further exposure s event
services to NF consumers. Such mechanism, also referred by SA2 in [48] as
"indirect data collection", is not specified in TS 26.501 [6] and TS 26.512
[7], mainly because M8 functionality is outside the scope of 5GMS, and
additionally, there was no use case/requirement in the 5GMSA/5GMS3 work items
to drive the related stage 2 and stage 3 definition. On the other hand, due to
the outreach from SA2 for AF support of indirect data collection, as shown by
Figure 5.8.6.1-1, at least from the standpoint of such UE data being specific
to media streaming services, it would make sense to define the requisite
interface (i.e., between the ASP and the 5GMS AF) to support indirect data
collection.
Figure 5.8.6.1-1: Indirect UE data collection\ (copied from TR 23.700-91 [8])
While in principle the M1 interface could be extended for the purpose of
indirect data collection (as even suggested by SA2 in the above diagram),
logically it would make more sense to define a separate (SBI-based) interface
for such purpose. M1 is mainly intended to support provisioning of session-
based media streaming services. Indirect UE data collection by the 5GMS AF
from the ASP corresponds to a more peripheral or auxiliary feature and might
be better served by defining a separate interface or API exposed by the 5GMS
AF, for example R1, which is the interface name identified in the BBC _et al._
discussion paper [49], as shown in Figure 5.8.6.1-2.
{width="6.377952755905512in" height="3.358267716535433in"}
Figure 5.8.6.1-2: Generic reference architecture for UE data collection and
reporting\ (copied from S4-210723 [4])
It can be seen from the above diagram that R1 represents more than simply the
indirect data collection procedure (referred to in Figure 5.8.6.1-2 as
"indirect reporting from ASP"), by including reporting provisioning and event
subscription and event publication (event exposure, e.g., via notifications)
to the ASP, as further described in [49].
Note that reporting-related provisioning may pertain to the configuration of
rules to be applied by the AF in the processing (e.g., anonymization,
normalization, filtering, aggregation) of the data it has collected via direct
or indirect methods. Such processing rules may differ for data to be reported
by the AF to the ASP versus the data to be reported by the AF (via event
exposure) to other NF consumers such as the NWDAF. From that perspective, when
the Data Collection AF is instantiated inside a 5GMS AF, the reporting
provisioning/configuration function logically belongs to M1 as part of overall
provisioning functionality for 5G Media Streaming. Such extension of M1 along
with additional specification of R1 is also reflected in [49] as shown in
Figure 5.8.6.1-3:
{width="6.727777777777778in" height="3.5597222222222222in"}
Figure 5.8.6.1-3: 5GMS instantiation of generic architecture for data
collection and reporting\ (copied from S4-210723 [49])
The details of R1 coupling to and decoupling from M1 should be further studied
for each of the R1 functions, with particular regard for the associated
procedures, resources and data structures, for example, via emulation of M1
mechanisms and/or reuse of those defined for the Naf Event Exposure service
defined in TS 29.517 [25].
#### 5.8.6.2 AF Collection of CDN Access Logs
As indicated in TS 26.501, the 5GMS AS acts as a CDN server (e.g., edge
server) in the hosting and delivery of streaming media content (i.e., of
ingested/egested content in downlink/uplink streaming). The corresponding
content hosting related information, i.e., CDN access logs, available at the
5GMS AS can be forwarded to the 5GMS AF for subsequent event exposure to
consumer entities such as the NWDAF or the Application (Service) Provider.
Doing so requires the specification of an interface between the 5GMS AS and
5GMS AF. Such interface is logically represented by M3, although this internal
interface, intended for the exchange of content hosting related information,
is not further described/specified in Rel-16 TS 26.501 and TS 26.512. As part
of the present study, it would seem possible to define M3 for the transfer of
CDN log information between these entities. However, as defined in TS 26.501,
M3 is intended to represent an undefined interface between the 5GMS AF and
5GMS AS for the exchange of content hosting related information. Therefore, it
would be more logical to define an SBI-based reporting interface across R3, as
shown in Figure 5.8.6.1-3, for the transfer of CDN access logs.
#### 5.8.6.3 Candidate media-related information for Event Exposure
As indicated previously, the stage 2 and stage 3 specifications for the
_Naf_EventExposure_ service are provided by TS 23.502 [24] and TS 29.517 [25],
respectively. Up through Release 16, the categories of UE data at the AF
available for event information subscription by NF consumers are the
following:
\- Service Experience information for an application;
\- UE mobility information;
\- UE communication information; and
\- Exceptions information.
Comparison of the above categories with QoE metrics (as defined in TS 26.247
[40] for progressive download and DASH streaming services) and service
experience and UE communication information types eligible for Naf event
exposure (as defined in TS 23.288 [48]) shows the only common information
attribute to be **_throughput_**. "Average throughput" is a defined quality
metric in TS 26.247 for both progressive download and 3GP-DASH services, and
"Throughput" is a defined type of performance data from the AF in TS 23.288.
However, it is not unreasonable to expect that other QoE metrics collected by
the 5GMS AF (based on TS 26.247 definitions for progressive download and DASH
streaming) will also be eligible for event exposure to the NWDAF. In
particular, at SA2#144-e, a CR to Rel-17 TS 23.288 in S2-2103267 [50] was
agreed which adds "QoE metrics" as an additional type of service data related
to Service Experience information for subscription by the NWDAF from the AF.
Although the identified QoE metrics in that CR references those defined by
MTSI in TS 26.114 [51], a CR from Qualcomm in S2-2104496 [52] proposes the
inclusion in TS 23.288 of QoE metrics defined for 3GP-DASH and progressive
download (per TS 26.247 [40]), VR (per TS 26.118 [53]), MBMS (per TS 26.346
[54]) and 5GMS (per TS 26.512 [45]). Therefore, it is possible that the QoE
metrics defined by the 5GMS architecture will be adopted as valid service data
for NWDAF subscription to _Naf_EventExposure_ services in Rel-17 TS 23.288
[48] and TS 29.517 [25].
The definition of application event types, data components and formats
relating to media streaming should be coordinated by SA4 with SA2 and CT3 in
the production of the associated stage 2 and stage 3 specifications of
_Naf_EventExposure_ services.
## 5.9 Per-application-authorization
### 5.9.1 Description
#### 5.9.1.1 General
Operation of certain 5GMSA and 5G System enabled services include an SLA
between the Application Provider and the 5GMS System provider. Different
solutions to enable per-application authorization should be studied. . "Per-
application authorization" refers to scenarios where one or more 5GMS-Aware
Applications are hosted on the same UE (e.g. a SmartPhone) and may access
services only from the associated 5GMS Application Provider.
The 5G System provider may offer one common 5GMSd AF or dedicated 5GMSd AFs.
In the later case, the one 5GMSd AF instance services only a single 5GMSd
Application Provider.
A set of example collaboration scenarios are described in clause 5.9.2.
#### 5.9.2.2 OAuth 2.0
OAuth 2.0 [91][92] is commonly used to provide authorization to RESTful HTTP
APIs. OAuth separates the authorization server from the resource server. This
typically simplifies deployments, since not every resource server such as an
HTTP server needs to also provide authorization functionality. The separation
of the authorization server from the resource server allows reusing access
credentials for different services or between different parties.
The OAuth 2.0 architecture defines four main roles:
\- _Resource Owner:_ A user or entity which can authorize access to a
resource.
\- _Resource Server:_ A function hosting the (protected) resource.
\- _Client:_ A function which desires to access the resource hosted on the
resource server.
\- _Authorization Server:_ A function which authenticates the resource owner
and provides different types of access tokens.
The roles can be visualized by the following simple example:
EXAMPLE: A user stores some personal photos on cloud storage. When the user
wants to print a photo using an external print service, rather than
downloading the photo onto a local drive and then uploading the photo to the
print service, the user can instead authorize the print service to fetch the
photo from the protoected cloud storage. The Resource Owner here is the user.
The Resource Server is the cloud storage. The print service is the Client.
The usage of OAuth 2.0 for the purpose of authorzing access to Network
Function services is defined by SA3 in clause 13.4 of TS 33.501 [93].
In one possible 5G Media Streaming scenario, the 5GMS Application Provider
subsidizes access to QoS and other network resources for its own applications.
To ensure that only authorized 5GMS-Aware Applications are allowed to access
these provisioned reousrces, the 5GMS Application Provider offers an
authorization server (or configures such a server provided by the 5G System)
that is used to authorize access to the Network Assistance feature of the 5GMS
AF.
Here:
\- The 5GMS Application Provider acts as the Resource Owner, because it owns
the Provisioning Session defining the QoS and charging policies.
\- The 5GMS AF acts as the Resource Server.
\- The Client is the Media Session Handler.
### 5.9.2 Collaboration Scenarios
#### 5.9.2.1 Collaboration A: UE hosting multiple Applications
This collaboration scenario focuses on cases where one or more 5GMSd-Aware
Applications are hosted on the same UE and are using the same 5GMSd Client.
This may be the case when the 5GMSd Client is provided as an Operating System
level service. The 5GMSd Client supports isolation of the different 5GMSd-
Aware Applications.
{width="6.723094925634296in" height="3.74in"}
Figure 5.9.2-1: Per-Application Authorization Collaboration Scenario
Each 5GMSd-Aware Application uses an M8d reference point instance to connect
to its 5GMSd Application Provider.
The 5G System provider offers a common 5GMSd AF within the trusted DN. The
5GMSd AF supports request and provider isolation so that 5GMSd Application
Provider #1 and #2 are not interfering with each other. For example, 5GMSd
Application Provider#1 has agreed different charging conditions than Provider
#2 and the 5G System should ensure that only 5GMSd-Aware Application #1 can
benefit from the conditions. Another example is different QoS levels, e.g.
5GMSd-Aware Application #1 is entitled to receive higher QoS than Application
#2.
#### 5.9.2.2 Collaboration B: Applications with multiple subscription levels
This collaboration scenario focuses on cases where an Application Provider is
offering multiple subscription levels to its consumers, for example 4K Premium
or SD Standard QoS. This example is inspired by the use case from TS 26.512
[16], Annex A.2.
{width="6.727551399825022in" height="3.8in"}
Figure 5.9.2-2: Per-Application Authorization Collaboration Scenario
Each 5GMSd-Aware Application uses an M8d reference point instance to connect
to its 5GMSd Application Provider. The 5GMSd Application Provider is aware
about the different subscription levels of the user.
The 5G System provider offers a common 5GMSd AF within the trusted DN. The
5GMSd AF needs to determine that 5GMSd Aware Application #1 is entitled to
higher bit rates than 5GMSd-Aware Application #2.
### 5.9.3 Role distribution in the 5GMS deployments
The 5G Media Streaming architecture can be used for different application
service offerings. Annex A in TS 26.512 [16] describes three different Dynamic
Policy usage examples: Premium QoS, Conditional Zero Rating and Background
Download. In all the three cases, different network features are used to
realise the Dynamic Policy, e.g. an increase in network resource utilization
when consuming HD content with the corresponding network QoS.
It is assumed in all three examples that the 5GMS Application Provider (and
the Application Service Provider) has an agreement with the 5G System provider
to use the relevant network feature.
{width="6.631944444444445in" height="5.307482502187226in"}
Figure 5.9.3-1: Applying roles for 5G Media Streaming Architecture functions
Figure 5.9.2-1 illustrates the different roles and responsibilities:
\- The resource in question is a network policy.
\- The 5G System Provider is the resource owner in this case, since it
provides the 5G connectivity service.
\- The 5GMSd-Aware Application is the Resource User. It instructs the 5GMSd
Client to activate a certain dynamic policy, based on the service subscription
and the selected content.
\- The 5GMS Application Provider is the Resource Owner. It checks that the
requested dynamic policy matches the application service subscription. For
example (with reference to clause A.2 in TS 26.512 [16]), when the user has an
HD video subscription, the user should only be authorised to activate a
dynamic policy corresponding to the HD operating point.
### 5.9.4 Mapping to 5G Media Streaming and High-Level Call Flows
Editor's Note: Map the key topics to basic functions and develop high-level
call flows.
### 5.9.5 Potential open issues
Editor's Note: Identify the issues that need to be solved.
### 5.9.6 Candidate Solutions
#### 5.9.6.1 General
#### 5.9.6.2 Solution 1: Use of a Callback for authorization
This solution is based on the concept that the 5GMS AF can contact the 5GMS
Application Provider (ASP) whenever a new Dynamic Policy is activated by a
5GMS Client.
The 5GMS Application Provider provides a different authorization token (e.g. a
random number or a random string) via M8 to each 5GMS-Aware Application, so
that each application can identify itself uniquely to the 5GMS AF.
When activating a Dynamic Policy, the 5GMS-Aware Application passes the token
(via an M6 API call) to the Media Session Handler. When the Media Session
Handler desires to activate a dynamic policy, it presents the authorization
token to the 5GMS AF by invoking an M5 operation. Upon receit of such a token,
the 5GMS AF executes a callback to the 5GMS Application Provider in order to
verify, whether this authorization token is valid. When the token is valid,
the UE application is authorized to activate this policy.
The authorization token is provided e.g. during the login procedure or is
requested at a later stage. The UE Application may fetch metadata for the
media assets at some stage.
The call flow is depicted below, assuming that the authorization token is
provided with the application service login response.
Figure 5.9.6.2-1: Usage of a callback for policy activation authorization
The steps are as follows:
1\. When the user wants to use the 5GMS-Aware Application to consume e.g.
video content, the user needs to authenticate with the application and the
5GMS Application Provider. (In some cases, this authorization can be
cached/stored by the application, so that the user is not always challenged to
provide the login credentials.)
NOTE: The application may be a native application (e.g. an Android
application) or a browser application.
2\. The 5GMS Application Provider determines the policy rights to which this
application service subscription is entitled (e.g. the user may have
subscribed to an SD quality video service or a 4K quality video service).
According to the subscription entitlement level, the 5GMS Application Provider
creates an authorization token and passes this token together with the login
response back to the application.
3\. When the 5GMS-Aware Application (immediately or later) invokes the Media
Session Handler to activate the network service from the 5GMS AF, the
application passes the authorization token to the Media Session Handler. The
authorization token can embed a user identifier, or the user identifier may be
passed as separate (anonymised) parameter.
4\. When the Media Session Handler activates a dynamic policy, it provides the
the token to the 5GMS AF, e.g. as an HTTP query parameter.
5\. The 5GMS AF then verifies the authorization token with the 5GMS
Application Provider, using a callback function.
This callback URL can be stored by the 5GMS AF together with the Policy
Template parameters so that the use of the network policy resource can be
revalidated periodically with the 5GMSd Application Provider.
6\. When the 5GMS AF has verified that the 5GMS Aware Application is
authorized to active the dynamic policy (based on the token), the 5GMS AF
invokes the appropriate procuedres on the NEF or PCF. For example, the 5GMS AF
triggers the addition of a QoS flow by invoking the _Nnef_AFsessionWithQoS_
service.
#### 5.9.6.3 Solution 2: Time-limited authorization token provisioning
In order to reduce the number of callbacks, tokens with a limited validity
duration may be provisioned with the 5GMS AF and the 5GMS-Aware Applications.
In this solution the 5GMSd Application Provider provisions a set of valid
authorization tokens, including expiry time, in the 5GMS AF in advance via M1.
As in Solution 1, the Media Session Handler passes an authorization token when
invoking the 5GMS AF at M5. The 5GMA AF authorizes the Media Sesssion
Handler's request based on this token.
Since the token validity is time-limited, the 5GMS Application Provider must
periodically update the set of valid authorization tokens provisioned at the
5GMS AF and the 5GMS-Aware Application is responsible for refreshing the token
used by the Media Session Handler. For example, the application may be
configured to periodically fetch a new token from the 5GMS Application
Provider.
Figure 5.9.6.3-1: Usage of time-limited tokens for policy activation
authorization
The steps are as follows:
1\. The 5GMS Application Provider provisions tokens on the 5GMS AF before any
5GMS-Aware Application tries to activate any Dyanmic Policy. The token is
provisioned together with the Policy Template definitions.
2\. When a user (and the 5GMS-Aware Application) successfully authenticates
with the 5GMS Application Provider, the 5GMS-Aware Application receives a
time-limited authorization token. The 5GMS-Aware Application typically stores
the token.
The difference with Solution 1 is the use of the token by the 5GMS AF:
3\. When a 5GMS-Aware Application wishes to activate a Dynamic Policy, it
provides the authorization token to the 5GMS AF. The 5GMS AF then validates
the token using a simple lookup against it list of currently valid tokens
without reference to the 5GMS Application Provider.
### 5.9.7 Conclusions
The Key Issue explores the usage of OAuth 2.0 for per-application
authorization of different 5G System features. It is recommended to specify
the usage of OAuth 2.0 (according to the SA3 guidelines) within a normative
work item.
## 5.10 Support for encrypted and high-value content
### 5.10.1 Description
Content is increasingly encrypted for distribution for different reasons, e.g.
Content Protection, Conditional Access, or integrity of playback. The
management of keys for different use cases is a prime concern. Examples
include scalable access to keys, secure storage of keys, key availabilities.
It is envisioned that an MNO can provide key management and/or key
distribution services for content providers. In particular, providing scalable
and secure key management within 5GMS for multiple different devices needs
further study.
Examples for secure media specification are for example provided by the
MovieLabs ECP requirements and other content providers requirements.
In a specific example, a live sports service provider wants to offer a live
stream. Examples include where the content needs to be delivered with low
latency (typically encoder to glass in 3--10 seconds) in order to be on par
with regular TV distribution means. Other services may also be considered.
The service may require different tools and functionalities levels of
security:
1\. _Conditional access supported by DRM management._ As an example, users
need to get a master key for decrypting the secondary level keys.
2\. _Key rotation in order to support live streaming._ As an example, these
keys are changed periodically but protected by the master key.
3\. _DRM and key management_ to ensure playback rules, for example to avoid
that clients attempting early playback of the content too early and have
advantages in betting/wagering, skipping content, etc.
4\. _Watermarking._ The content is distributed and a unique signature is added
at the latest possible time (in the device, at the Edge). An example of such
approach can be found here https://learn.akamai.com/en-us/webhelp/adaptive-
media-delivery/adaptive-media-delivery-implementation-
guide/GUID-3F89E64C-415D-452D-9541-BB650CD783B9.html.
5\. _Content encryption._
6\. _A secure implementation_ (use of TEE, Secure Media Path).
### 5.10.2 Collaboration Scenarios
It is assumed that the content provider provides DRM protections for the
content. However, beyond this different collaboration models between the
content provider and 5G System operator/MNO exist.
As examples, the MNO provides infrastructure to the content service provider
in order to support security related functions.
\- The service provider may want to provide scalable access to the content and
in particular the key distribution. Hence it uses 5G Media streaming servers
to support secure key distribution.
\- The streaming service provider wants to rule playback, for example to avoid
that the situation whereby users can see the streamed content too early while
at the same time, the streaming service provider does not want to delay the
distribution artificially either and want to give the clients the ability to
download the main content (without buffer underruns).
\- The service provider asks for fairness in the client, but the client cannot
be trusted to act fairly. Hacked clients are possible. Clients may have DRM
systems that the service providers will use.
\- The service provider asks for a watermarking solution from the MNO.
Encryption (as already defined in TS 26.511 [96]) and secure keys may be used
for other purposes, for example for conditional access or DRM systems. In some
cases, keys are also provided in hierarchically, depending on business rules,
security levels and deployment scenarios.
In an extension of the above use case, the content is distributed via multiple
operators network. In this case, the encryption may be done by the service
provider and the service provider provides the keys to the MNO. In another
case, the service is offered by the MNO and the MNO does encryption and key
management.
### 5.10.3 Deployment Architectures
Editor's Note: Based on the 5GMS Architecture, develop one or more deployment
architectures that address the key topics and the collaboration models.
### 5.10.4 Mapping to 5G Media Streaming and High-Level Call Flows
Editor's Note: Map the key topics to basic functions and develop high-level
call flows.
### 5.10.5 Potential open issues
Editor's Note: Identify the issues that need to be solved.
### 5.10.6 Candidate Solutions
Editor's Note: Provide candidate solutions (including call flows) for each of
the identified issues.
## 5.11 TV-grade mass distribution of unicast Live Services
### 5.11.1 Description
#### 5.11.1.1 General
Live TV services of different scale (professional, user-generated, session-
based, etc.) are increasingly distributed over broadband and mobile networks.
Live TV services are characterized by:
\- scalability (in terms of concurrent users),
\- consistent quality,
\- high bandwidth requirements,
\- target latency constraints, and
\- TV Experiences.
#### 5.11.1.2 Scalability
Consistent support of the distribution of such services to a different scale
of users and in a concurrent fashion is a prime concern. 5G Media Streaming is
expected to support such service distribution and end-to-end optimizations.
Improvements and optimizations on the architectural level and stage 3 are
expected to be studied.
#### 5.11.1.3 Consistent quality
TV Services are expected to provide a consistent quality over time. Consistent
quality can be defined as the service staying within a set of Operation Point
boundaries to the largest extent. Specific aspects are:
> \- Meeting the latency requirements, namely staying at the target, not
> exceeding the maximum, and not falling below the minimum. Measuring
> deviation from the target, as well creating events when exceeding the
> boundaries, is relevant. For more details see clause 5.11.15.
>
> \- Meeting the target playback rate, i.e. how often the playback rate is
> changed from 1.0, and if there are cases when the playback rate is outside
> of the range. For more details see clause 5.11.15.
>
> \- Staying within the boundaries of the target bit rates and meeting the
> target. This measurement includes those cases where the bit rate falls to 0,
> i.e. the service is stalled. All of this can be measured by the 5GMS Client.
Table 13.2.6‑2 in TS 26.512 [16] defines a set of Operation Point parameters,
repeated below, to which the Media Player is configured and that it exposes to
the 5GMS-Aware Application as status information in notification events at
reference point M7 when the current Operation Point changes. This
configuration setting may be included in the media presentation manifest, or
it may alternatively be provided through private application means. Generally,
consistent quality refers to meeting the Operation Point parameters as shown
in table 5.11.1.3-1 below . The Media Player and the network are expected to
collaborate to meet the quality requirements.
Table 5.11.1.3-1: Operation Point Information (see TS 26.512, Table 13.2.6-2)
+-------------+-------------+-------------+-------------+-------------+ | _Oper | Operation | The | | | | ationPoint_ | Point | currently | | | | | Parameters | configured | | | | | | operation | | | | | | point | | | | | | parameters | | | | | | according | | | | | | to which | | | | | | the DASH | | | | | | client is | | | | | | operating. | | | +=============+=============+=============+=============+=============+ | | _Mode_ | Enum | The | | | | | | following | | | | | | operation | | | | | | modes are | | | | | | defined: | | | | | | | | | | | | _live_ : The | | | | | | DASH client | | | | | | operates to | | | | | | maintain | | | | | | configured | | | | | | target | | | | | | latencies | | | | | | using | | | | | | playback | | | | | | rate | | | | | | adjustments | | | | | | and | | | | | | possibly | | | | | | resync. | | | | | | | | | | | | _Vod_ : The | | | | | | DASH client | | | | | | operates | | | | | | without | | | | | | latency | | | | | | r | | | | | | equirements | | | | | | and | | | | | | rebuffering | | | | | | may result | | | | | | in | | | | | | additional | | | | | | latencies | | +-------------+-------------+-------------+-------------+-------------+ | | _max | Integer | maximum | | | | BufferTime_ | | buffer time | | | | | | in | | | | | | m | | | | | | illiseconds | | | | | | for the | | | | | | service. | | +-------------+-------------+-------------+-------------+-------------+ | | _switch | Integer | buffer time | | | | BufferTime_ | | threshold | | | | | | below which | | | | | | the DASH | | | | | | clients | | | | | | attempts to | | | | | | switch | | | | | | Repre | | | | | | sentations. | | +-------------+-------------+-------------+-------------+-------------+ | | _Latency_ | | Defines the | | | | | | latency | | | | | | parameters | | | | | | used by the | | | | | | DASH client | | | | | | when | | | | | | operating | | | | | | in live | | | | | | mode. | | +-------------+-------------+-------------+-------------+-------------+ | | | _Target_ | Integer | The target | | | | | | latency for | | | | | | the service | | | | | | in | | | | | | mi | | | | | | lliseconds. | +-------------+-------------+-------------+-------------+-------------+ | | | _Max_ | Integer | The maximum | | | | | | latency for | | | | | | the service | | | | | | in | | | | | | mi | | | | | | lliseconds. | +-------------+-------------+-------------+-------------+-------------+ | | | _Min_ | Integer | The maximum | | | | | | latency for | | | | | | the service | | | | | | in | | | | | | mi | | | | | | lliseconds. | +-------------+-------------+-------------+-------------+-------------+ | | _Pl | MediaType | Defines the | | | | aybackRate_ | | playback | | | | | _audio, | rate | | | | | video, all_ | parameters | | | | | | used by the | | | | | | DASH client | | | | | | for catchup | | | | | | mode and | | | | | | d | | | | | | eceleration | | | | | | to avoid | | | | | | buffer | | | | | | underruns | | | | | | and | | | | | | maintaining | | | | | | target | | | | | | latencies. | | +-------------+-------------+-------------+-------------+-------------+ | | | _Max_ | Real | The maximum | | | | | | playback | | | | | | rate for | | | | | | the | | | | | | purposes of | | | | | | au | | | | | | tomatically | | | | | | adjusting | | | | | | playback | | | | | | latency and | | | | | | buffer | | | | | | occupancy | | | | | | during | | | | | | normal | | | | | | playback, | | | | | | where 1.0 | | | | | | is normal | | | | | | playback | | | | | | speed. | +-------------+-------------+-------------+-------------+-------------+ | | | _Min_ | Real | The minimum | | | | | | playback | | | | | | rate for | | | | | | the | | | | | | purposes of | | | | | | au | | | | | | tomatically | | | | | | adjusting | | | | | | playback | | | | | | latency and | | | | | | buffer | | | | | | occupancy | | | | | | during | | | | | | normal | | | | | | playback, | | | | | | where 1.0 | | | | | | is normal | | | | | | playback | | | | | | speed. | +-------------+-------------+-------------+-------------+-------------+ | | _Bandwidth_ | | Defines the | | | | | | operating | | | | | | bandwidth | | | | | | parameters | | | | | | used by the | | | | | | DASH client | | | | | | used for a | | | | | | specific | | | | | | media type | | | | | | or | | | | | | aggregated. | | | | | | The values | | | | | | are on IP | | | | | | level. | | +-------------+-------------+-------------+-------------+-------------+ | | | _Target_ | Integer | The target | | | | | | bandwidth | | | | | | for the | | | | | | service in | | | | | | bit/s that | | | | | | the client | | | | | | is | | | | | | configured | | | | | | to consume. | +-------------+-------------+-------------+-------------+-------------+ | | | _Max_ | Integer | The maximum | | | | | | bandwidth | | | | | | for the | | | | | | service in | | | | | | bit/s that | | | | | | the client | | | | | | is | | | | | | configured | | | | | | to consume. | +-------------+-------------+-------------+-------------+-------------+ | | | _Min_ | Integer | The minimum | | | | | | bandwidth | | | | | | for the | | | | | | service in | | | | | | bit/s that | | | | | | the client | | | | | | is | | | | | | configured | | | | | | to consume. | +-------------+-------------+-------------+-------------+-------------+ | | _Pla | | Player | | | | yerSpecific | | specific | | | | Parameters_ | | parameters | | | | | | may be | | | | | | provided, | | | | | | for example | | | | | | about the | | | | | | used | | | | | | algorithm, | | | | | | etc. | | +-------------+-------------+-------------+-------------+-------------+
#### 5.11.1.4 High bandwidth requirements
TV Services typically have certain bit rate requirements that need to be met.
Clause 5.1 of TR 26.925 [88] provides an overview. These figures are valid for
both HDR/non-HDR video:
+----------------------------------------------------------------------+ | - 720p HD: 2 - 5 Mbps | | | | NOTE 1: Today typically 3 Mbps for HEVC [15] and 5Mbps for AVC | | [14], but bitrate reductions expected with better encoding and | | coding tools. See Clause 6.1.2. | | | | - Full HD: 3 - 12 Mbps | | | | NOTE 2: Today typically 5-7 Mbps for HEVC [15] and 10-12 Mbps for | | AVC [14], but bitrate reductions expected with better encoding and | | coding tools. See Clause 6.1.2. | | | | - 4k UHD: 5- 25Mbps | | | | NOTE 3: today typically 8-16 Mbps for HEVC [15] and 15-25 Mbps for | | AVC [14], but bitrate reductions expected with better encoding and | | coding tools. See Clause 6.1.2. | | | | - 8k UHD: 20 - 80 Mbps | | | | NOTE 4: Today typically up to 80 Mbps for HEVC [15], but bitrate | | reductions expected with better encoding and coding tools. See | | Clause 6.1.2. | | | | NOTE 5: On 8k UHD: currently not specified in 3GPP TS 26.116. | | Bitrate figures are based on limited available deployment data. | +----------------------------------------------------------------------+
These figures may be used as indication of bit rate requirements for services.
#### 5.11.1.5 Target latency constraints
Based on a report developed jointly between DVB and DASH-IF on Low-Latency
DASH [9], this clause defines details on how to support consistent latency in
DASH for linear TV services. In [9], several definitions had been introduced,
repeated here for consistency.
_\- End-to-End Latency (EEL)_ : The latency for an action that is captured by
the camera until its visibility on the remote screen.
_\- Encoder-Display Latency (EDL)_ : The latency of the linear playout output
(which typically serves as input to distribution encoder(s)) to the screen.
_\- Packager-Display Latency_ : The latency after the output of the
distribution encoder to the screen.
_\- CDN latency_ : The delay caused by the CDN delivery from CDN input to CDN
output.
_\- Live Edge Start-up Delay (LSD)_ : The time between a user action (service
access or service join) and the time until the first media sample of the
service is perceived by the user when joining at the live edge. Typically also
the channel change time.
_\- Seek Start-up Delay (SSD)_ : The time between a user action (service
access or service join) and the time until the first media sample of the
service is perceived by the user when seeking to a time shift buffer.
Those two categories, latency and delay are subject to be controllable by the
service provider for a consistent service offering. In the remainder,
primarily the Encoder-Display Latency (EDL) and the Live Edge Start-up Delay
are considered, but for some use cases also the End-to-End Latency (EEL) may
be relevant. Figure 5.11.1‑1 provides a schematic overview of the different
latencies.
{width="6.510416666666667in" height="2.8645833333333335in"}
Figure 5.11.1‑1: Different latencies and delays relevant for low-latency
distribution
The Low Latency DASH scenario is a variant of the Live Services recommended
approach focused on ensuring that the Encoder-Display Latency of the DASH
Media Presentation is comparable to the latency when distributing over
terrestrial, cable or satellite broadcast. Latency in broadcast is not a
unique universal value, as it is influenced by many factors such as the
duration of the broadcast encoding pipeline, the latency of the transport
channel which can slightly differ per type (satellite, cable, IPTV or,
DTT...), or the artificial delays introduced by local content moderation
regulations. However, most of the measurements converge on a 3 - 10 seconds
latency between the moment where the source signal is acquired for encoding
and the moment when it\'s played back on the TVs, i.e the EDL. Start-up delay
requirements are typically in the range of 1-2 seconds. For details refer to
[9].
Low-latency mode are supported to minimize the architectural impacts on
existing workflows. Figure 5.11.1‑2 provides a basic flow of information for
operating a low-latency DASH service as defined in DASH-IF's Low-latency Modes
for DASH [10]. The DASH packager gets information on the general description
of the service as well as the encoder configuration. The encoder produces CMAF
chunks and fragments. The chunks are mapped by the MPD packager onto Segments
and provided to the network in incremental fashion using HTTP/1.1 chunked
transfer.
{width="6.65625in" height="3.2708333333333335in"}
Figure 5.11.1-2 Basic operation flow Low-Latency DASH
HTTP chunked transfer coding needs to be supported up from the ingest into the
packager up to the CDN edge, whereas the last mile delivery is expected happen
using HTTP chunked transfer coding or HTTP in regular mode. If HTTP chunked
transfer coding is supported by the DASH player, it basically means that a
media segment carrying the latest moment of the program (also known as the
\"live edge time\" as defined in clause 4 of this document) could be consumed
on the player while it\'s still being produced by the encoder and the
packager.
In case chunked segments are used, clients may want to access partially
available Segments for example for fast random access, see ISO/IEC 23009-1
[11]. However, requesting available byte ranges of a partially available
Segment, i.e., Segments still being produced, is not consistently supported in
CDNs, but solutions are provided in RFC8673 [X6]. This functionality may also
be needed to support common segment handling for low-latency DASH and low-
latency HLS.
Key aspects for low-latency live distribution include:
> _-_ Consistent support for chunked transfer from ingest to client.
>
> _-_ Support for partially access of non-complete resources.
>
> _-_ End-to-end optimizations to support the latency requirements.
#### 5.11.1.6 TV Experiences
TR 26.917 [89] studied and identified requirements for TV Experiences. Clause
4.3 of TR 26.917 [89], reproduced below, provides a summary from a user-
experience perspective:
+----------------------------------------------------------------------+ | - content delivery up to UHD resolution. | | | | - mechanisms to restrict the reception of some or all Subscribed TV | | services to groups of subscribers (e.g. based on the recipients of | | the services are subscribers of the MNO, roaming subscribers of | | other MNOs, or not subscribed to any MNO). | | | | - combinations of SD, FHD and UHD resolution TV transport services. | | | | - support network broadcast geographic area coverage management | | considering following criteria: | | | | - OTT provider request (including the potential coverage | | information of TV service information) | | | | - available network unicast/broadcast capacity of 3GPP network | | | | - number of users under broadcast network coverage | | | | - The location information of UE | | | | - support audio and video formats typically supported by TV Content | | Providers for SD and HD TV transport services and UHD TV transport | | services. | | | | - support codecs typically supported by TV Content Providers for HD | | TV services and UHD TV services. | | | | - support accessibility functions typically supported by TV Content | | Providers (e.g. subtitling, closed captioning, audio descriptions, | | anonymous reception, reporting to support ratings, reporting | | enforcement, etc.). | | | | - regulatory mandates typically supported by TV Content Providers | | (blackouts, emergency alerts, etc.). | | | | - interactivity functions typically supported by TV Content | | Providers (interactive services, second screen, personalization, | | etc.). | | | | - ad insertion use cases typically supported by TV Content | | Providers (targeted ad insertion, ad replacement, etc.), | | | | - encryption, security and conditional access functions typically | | supported by TV Content Providers. | | | | - concurrent delivery of multiple application components (TV | | service application signalling, statistical multiplexing, etc.). | | | | - random access and channel change times comparable to existing HD | | TV services. | +----------------------------------------------------------------------+
#### 5.11.1.7 Summary of service requirements for Mass grade TV distribution
The following assumptions for the study are captured
\- Target for a maximum end-to-end service delay of 3 seconds (Packager-
Display latency). This is measured from the input into the DASH Packager to
the output of the DASH Player.
\- Target for a tune-in to an ongoing DASH Live stream of maximum 1.5 seconds
(Live Edge Startup Delay). This is measured between the user action to tune-in
(e.g. pressing a button) and the first frame is output from the DASH Player
(still fulfilling the target of the Packager-Display Latency).
\- There is a requirement on a maximum ADG referring to the time difference
between the first user to see a frame of media and the last user to see that
same frame of media. It should be possible to remain below 1 second apart and
within the target latency, i.e. _max(ADG)_ = 1 second.
\- The DASH MPD can prepared so that the DASH Player can operate at different
Latencies, e.g. low latency, normal latency or timeshift (video-on-demand
profile).
\- TV Experiences as summarized in clause 5.11.1.6.
### 5.11.2 Deployment Architectures
#### 5.11.2.1 Distribution of low-latency media streams
A deployment architecture suitable for low-latency CMAF streaming is shown in
Figure 5.11.2.1-1.
{width="6.614589895013124in" height="2.088888888888889in"}
Figure 5.11.3-1 Deployment architecture for low-latency CMAF streaming
In this case:
1\. A live stream is ingested into a live encoder.
2\. The encoded stream is packaged into CMAF chunks.
3\. The packaged CMAF chunks are uploaded to an origin server using chunked
transfer encoding input.
4\. Segments are then available for retrieval by a CDN on demand and moved
through the CDN all the way to the client.
#### 5.11.2.2 Operation Point -- Establishment and Monitoring
This clause deals with providing consistent quality in 5G Media Streaming as
part of an Operation Point. Figure 5.11.2.2-1 shows how Operation Points and
policies can be matched in a basic setup.
{width="6.512321741032371in" height="2.6325317147856517in"}
Figure 5.11.2.2-1 Operation Point workflow
The content-defined Operation Points are shown in the User Plane setup in
Figure 5.11.2.2-1.
1\. A set of Policy Templates is agreed in advance between the 5GMS
Application Provider and the 5G System operator. These may be provisioned in
the 5GMS AF via reference point M1. Policy templates represent long term
agreements made between the 5GMS Application Provider and the 5GMS System
operator.
2\. Service Operation Points, defined in terms of the parameters reproduced in
table 5.11.1.3‑1, are long-lived profiles that will be used by media streaming
sessions as references.
3\. Based on communication with the 5GMS-Aware Application, the UE device
characteristics, the prevailing network conditions and so on, the Media Player
selects a suitable Operation Point.
4\. Based on the parameters of the currently selected Operation Point, the
policies in the 5G network are established, by the Media Session Handler
instantiating one of the available Policy Templates by invoking the Dynamic
Policies API at reference point M5. The streaming session uses at most one of
the allowed policy templates at any point in time.
The above workflow is expected to be operational for 5G Media Streaming as
defined today in TS 26.512 [15]. What is needed in order to execute the
workflow is the following
1) Well-defined Operation Points in the content. The Service Description as
defined in ISO/IEC 23009-1 is mentioned in TS 26.512 [15] as a high-level
statement:
* * *
The MPD may contain a one or several **ServiceDescription** elements that
include operational parameters. The MPD may also include multiple
configurations for the media (different codecs, different content protection,
different resolutions, etc.), for example for playback under different
operating policies. The handling of this information is documented in clause
13.2.
* * *
but not yet in TS 26.247 [40]. More details are needed, including some
examples.
2) Media Session Handling APIs allowing a 5GMS-Aware Application to make use
of dynamic policies, network assistance and metrics reporting in the 5GMS
Client are not yet specified at reference point M6 in TS 26.512 [15]. In
particular, clause 12.2 is incomplete for Dynamic Policy Information and
Network Assistance information.
3) Media Player metrics are not yet defined on the Media Streaming Handler API
at reference point M7 defined in clause of TS 26.512 [15]. In particular, the
extent to which the Media Player is (un)able to obey the currently selected
Operation Point parameters needs to be signalled to the Media Session Handler
in order to potentially drive the selection of a different Operation Point.
### 5.11.3 Collaboration Scenarios
#### 5.11.3.1 General
The following collaboration scenarios may be considered:
> 1) Live content is provided to the MNO as an (uncompressed or mezzanine-
> compressed) contribution feed, and the MNO does the encoding and packaging
> for distribution.
>
> 2) Live content is encoded and packaged by the content provider (for example
> as low-latency CMAF) and uploaded to the MNO. The MNO may produce an MPD for
> its distribution. However, the content provider augments the media with
> production and/or encoding timestamps (e.g. producer reference times) in
> order to permit latency measurements.
>
> 3) The origin server is external to the MNO network and content is pulled
> through the 5GMS AS on demand by the clients.
#### 5.11.3.2 Distribution of low-latency media streams
For all of the collaboration scenarions described in clause 5.11.3.1 above,
the content provider and the service provider agree on:
> \- The MNO may monitor if the end-to-end latency target is maintained. This
> may for example be done by proper reporting.
>
> \- The desired latency from glass-to-glass is met for example to be 3
> seconds.
>
> \- That the content is provided in low-latency, but also for consumption in
> time shift mode.
\- That the content can be accessed before the whole segment is uploaded.
### 5.11.4 Mapping to 5G Media Streaming and High-Level Call Flows
#### 5.11.4.1 General: Distribution of "Operation Point Services"
This clause provides an extension to the general call flow in clause 6.2.3 of
TS 26.501 [15] in order to address operation point services.
Figure 5.11.4.1-1: High-level procedure for DASH content for Operation Point
handling
Prerequisites:
\- The 5GMSd Application Provider has provisioned the 5G Media Streaming
System and has set up content ingest.
\- The 5GMSd-Aware Application has received the Service Announcement from the
5GMSd Application Provider.
Extended Steps:
1: Policy Templates are defined
12: Media Player informs application about the current set of Operation
Points.
13: 5GMSd-Awaer Application selects an Operation Point.
14: Media Player provdes Operation Point parameters to the Media Session
Handler.
15: Media Session Hahdnler selects a Dynamic Policy based on the provided
Operation Point parameters.
21: Media Player provides Operation Point metrics to the Media Session
Handler.
22: Media Session Handler sends Operation Point measurements and events to the
5GMSd AF.
#### 5.11.4.2 Collaboration 1: MNO provides encoding and packaging
In this case, the specific aspects are as follows:
> 1) A native stream is ingested into the network. This may be an MPEG-2 TS
> stream, an RTMP stream, etc. The stream may have time codes included that
> relate media time to real-time.
>
> 2) Along with the ingest, a provisioning agreement between the content
> provider and the MNO exists on one or several Service Operation Points and
> Policy Templates. It may be that only one of the two is defined, and the
> other one is derived, or both are defined.
>
> 3) The MNO encodes, packages and distributes the content according to the
> agreed Service Operation Points. The encoding and packaging may take into
> account the information from the Operation Points but may also take into
> account the information in the ingested media stream in order to control the
> latency.
>
> 4) The Operation Point metrics collated by the 5GMS AF are used by the MNO
> to validate that the Service Operation Point is met, or to adjust the Policy
> Templates accordingly.
#### 5.11.4.3 Collaboration 2: MNO provides DASH distribution
In this case, the specific aspects are as follows:
> 1) CMAF content is provided externally. The content is announced to the MNO
> for distribution.
>
> 2) The ingest happens in a way such that the latency requirements can be
> met.
>
> 3) A provisioning agreement between the content provider and the MNO exists
> on one or several Service Operation Points and Policy Templates. It may be
> that only one of the two is defined, and the other one is derived, or both
> are defined.
>
> 4) The MNO distributes the content according to the agreed Service Operation
> Points, i.e. meeting bit rate and latency requirements. The MNO generates
> the media presentation manifests accordingly, for example the MPD and/or the
> HLS manifest.
>
> 5) The Operation Point metrics collated by the 5GMS AF are used by the MNO
> to validate that the Service Operation Point is met, or to adjust the Policy
> Templates accordingly.
#### 5.11.4.4 Collaboration 3: MNO acts as CDN
In this case, the specific aspects are as follows:
> 1) DASH or HLS content is provided externally. The content is announced to
> the MNO for distribution.
>
> 2) The ingest happens in a way such that the latency requirements can be
> met.
>
> 3) A provisioning agreement between the content provider and the MNO exists
> on one or several Servcie Operation Points and Policy Templates. It may be
> that only one of the two is defined, and the other one is derived, or both
> are defined.
>
> 4) The MNO distributes the content according to the agreed Service Operation
> Points, i.e. meeting bit rate and latency requirements.
>
> 5) The Operation Point metrics collated by the 5GMS AF are used by the MNO
> to validate that the Service Operation Point is met, or to adjust the Policy
> Templates accordingly.
#### 5.11.4.5 Operation Point example
An example for an operation point is provided below:
\- Mode = Live.
\- maxBufferTime = 4000.
\- switchBufferTime = 500.
\- Latency: target=3000, maximum=5000, minimum=3000.
\- PlaybackRate: max=1.2, min=0.8.
\- Bit rate: target = 4000000, max=6000000, min=1000000.
### 5.11.5 Potential open issues
The following aspects are not yet addressed in the current 5G Media Streaming
specifications:
> \- On M1d:
\- The establishment of consistent provisioning for Live TV services of
different scale, providing the required Service Operation Points.
\- The ability to support Collaboration 1, for which the MNO provides encoding
and packaging.
> \- On M2d:
\- Ingest protocols that support chunk-based ingest and do not add latency by
the use of chunked transfer. (No aggregation of chunks into resources.) Note,
support for HTTP Chunked Transfer encoding is a requirement of HTTP 1.1
Clients and Servers. The gap is, that an 5GMS AS implementation is free to
wait until the full segment is received.
\- Signaling of Operation Points along with the content in Collaboration 2.
> \- On M4d:
\- Consistent support of low-latency streaming formats.
\- Time synchronisation between server and client so that performance
(particularly latency) can be measured accurately.
\- Support for advanced TV Experiences.
> \- On M5d:
\- Metrics to monitor the operation of the service and if it meets operation,
in particular the latency.
> \- On M6d:
\- Dynamic policies, network assistance and metrics reporting.
> \- Other:
\- Support TV service requirements.
### 5.11.6 Candidate Solutions
For the above open issues, the following candidate solutions are considered:
> \- On M1d:
\- Policy Template updates to support TV services.
\- Provisioning extension to support Collaborations 1, 2 and 3.
> \- On M2d:
\- DASH-IF Ingest Specification: https://dashif-
documents.azurewebsites.net/Ingest/master/DASH-IF-Ingest.html
\- MPD extensions to support signalling of Operation Points using Service
Description.
> \- On M4d:
\- DASH-IF Low-Latency Extensions: https://dash-industry-
forum.github.io/docs/CR-Low-Latency-Live-r8.pdf
\- UTC Time Sync that can be used by the 5GMS AS and the 5GMS Client in order
to measure latency accurately. A 3GPP-based network time source may be
provided.
\- New DASH and CMAF functionalities that support enhanced TV services, such
as pre-selection.
> \- On M5d:
\- Updates to DASH QoE metrics reporting for monitoring latency and Audience
Drift Gap.
> \- On M6d:
\- Extensions to M6 to address the requirements.
> \- General support:
\- DASH-IF Low-Latency Extensions: https://dash-industry-
forum.github.io/docs/CR-Low-Latency-Live-r8.pdf
### 5.11.7 Conclusions
Live TV services of different scale (professional, user-generated, session-
based, etc.) are increasingly distributed over broadband and mobile networks,
including 5G Networks. Live TV services are characterized by at least the
following aspects: (1) scalability (in terms of concurrent users), (2)
consistent quality, (3) high bandwidth requirements, (4) target latency
constraints, and (5) advanced TV Experiences.
To address these type services a consistent support in the 5G Media Streaming
Architecture, the protocols and codecs is needed. It is identified that the
combination of low-latency CMAF formats, chunked transfer from content
provider to the device, as well as consistent signaling and support of service
quality are key aspects to the work.
It is recommended to support and optimize the deployment of unicast live TV
services in 5G Systems. For this purpose, the following follow-up aspects are
recommended to be addressed:
1\. Architectural and procedural considerations
a) At least one call flow into that documents provisioning, ingest,
distribution, presentation and monitoring aspects of low-latency live
streaming services using CMAF Chunks.
b) Updates to reference points to support provisioning, ingest, distribution,
presentation and monitoring aspects of low-latency live services using CMAF
Chunks.
c) Typical configurable service parameters and operation points in terms of
bit rates, latencies, Audience Drift Gaps, etc.
2\. Protocols, codecs, metrics and capabilities:
a) Define capability mechanisms in order to identify the support of low-
latency modes in 5GMS networks and clients
b) Provisioning to support operation points and policy templates for low-
latency live streaming.
c) Create necessary extensions to support DASH and HLS chunked CMAF low-
latency modes in an end-to-end workflow.
d) Provide necessary protocols to scalably support time synchronization across
5GMS Applications, AS and 5GMS Clients (at appropriate precision).
e) Extend QoE metrics schemes and metrics reporting functionality to address
monitoring of Operation Point metrics for potential operational improvements.
f) Provide extensions to formats and manifests support advanced TV
experiences.
g) Informative guidelines on using different Operation Points for low-latency
live streaming.
## 5.12 Network Slicing Extensions for 5G Media Streaming
### 5.12.1 Description
#### 5.12.1.1 Overview
Network slicing standardization has progressed in 3GPP in sub working groups
of both the SA and RAN groups. In particular, network slicing standardization
that is relevant to our work in 3GPP SA4 has been specified in the SA2, SA5,
SA6, and CT3 sub working groups.
3GPP SA2 specified network slicing related standardization in the following
technical specifications:
\- TS 23.501 [23]: In this TS, SA2 specified network slicing concepts such as
identification and selection of network slice (S-NSSAI and NSSAI),
standardized SST values, Network slicing subscription aspects, UE NSSAI
configuration and NSSAI storage aspects, network slicing support for roaming,
interworking with EPS, network slice-specific authentication and
authorization, network slice admission control etc.
\- TS 23.502 [24]: In this TS, SA2 specified procedures related to network
slicing such as network slice-specific authentication and authorization
procedure, network slice admission control function procedures, network slice
admission control support for roaming, network slice admission control
function (NSACF) services etc.
While 3GPP SA2 has specified architectural concepts about using network
slices, 3GPP SA5 has specified the architecture, provisioning, and management
(creation, modification, and termination) of network slices in addition to
defining roles related to 5G networks and network slicing, and management
models for network slicing. The network slicing related standardization
specified by 3GPP SA5 can be found in the following technical specifications:
\- TS 28.530 [56]: Describes general concepts such as management of 5G
networks and network slicing, principles of network slicing management
framework, slice profile and service profiles, and business level requirements
\- TS 28.531 [57]: Describes requirements such as creation, modification,
activation, deactivation of network slice instances. network slice subnet
instances, and 3GPP NF instances. Operations for management of network slice
instances and network slice subnet instances is also specified.
\- TS 28.532 [58]: Describes management and orchestration concepts such as
provisioning management services, fault supervision management services, and
performance assurance management services. Corresponding stage-3 management
service specification is also specified.
\- TS 28.533 [59]: Describes the architecture framework for management of
network slicing including the architecture reference model for management
interactions with NFV MANO, ZSM framework, and NWDAF
\- TS 28.540 [60]: Describes 5G Network Resource Model (NRM) for NR and NG-RAN
specifying aspects related to requirements for management of network slice and
network slice subnets.
\- TS 28.541 [61]: Describes stage-2 and stage-3 specification of 5G NRM
including the information model definitions for network slice NRM such as
NetworkSlice, NetworkSliceSubnet, ServiceProfile, and SliceProfile.
\- TS 28.542 [62]: Describes stage-1 NRM for 5G Core Network.
\- TS 28.543 [63]: Describes stage-2 and stage-3 NRM for 5G Core Network.
\- TS 28.545 [64]: Describes stage-1 fault supervision aspects about
management and orchestration of networks and network slicing.
\- TS 28.546 [65]: Describes stage-2 and stage-3 fault supervision aspects
about management and orchestration of networks and network slicing.
\- TS 28.552 [66]: Describes 5G performance measurements related to network
slicing instances.
\- TS 28.554 [67]: Describes 5G end to end key performance indicators (KPIs)
related to network slicing.
In addition to the SA2 and SA5 groups, 3GPP SA6 has specified network slicing
related standardization in the following technical specifications:
\- TS 23.434 [68]: Specifies the functional architecture for service enabler
architecture layer (SEAL) and the procedures, information flows, and APIs for
each service within SEAL in order to support vertical applications over the
3GPP system. As part of this specification, aspects related to network slice
capability management is specified including procedures and information flows
for network slice capability management.
\- TR 23700-99 [69]: Proposes application architecture aspects solutions and
enhancements to SEAL using the NSCALE application layer enablement.
Finally, some work related to network slicing has been done by the 3GPP CT3
group in the following technical specifications:
\- TS 29.520 [70]: Specifies the stage-3 definition of Network Data Analytics
Function Services of the 5G system. Proposes the data model for network slice
information that NWDAF can provide to authorized consumers.
#### 5.12.1.2 Network Slicing Extensions in SA4
Though the 3GPP SA4 technical specifications related to 5G Media Streaming
have touched upon network slicing, the standards could be significantly
enhanced with further study and specification related to network slicing
aspects. Some of the items currently being worked in SA4 that can be enhanced
to incorporate network slicing based specification are presented below. Table
5.12.1.2-1 lists the Release-16 architecture items that can benefit from
further specification on network slicing.
Table 5.12.1.2-1: Release-16 Items for further Network Slicing related
specification
+--------------------+------------------------------------------------+ | Work Items | Aspects for study related to network slicing | +====================+================================================+ | 5G Media Streaming | TS 26.501 [15] and TS 26.512 [16] have | | | added specification text for dynamic policy. | | | However, aspects related to network slicing | | | and dynamic policy are not adequately | | | addressed. TS 26.501 [15] briefly discusses | | | dynamic policy based on network slicing for | | | downlink streaming. Dynamic policy aspects for | | | other use cases (media processing, uplink | | | streaming etc.) can be studied. | | | | | | Provisioning aspects on M1d interface with | | | respect to network slicing. Study | | | integration/interworking of management API | | | with provisioning aspects of media services | | | with network slicing | | | | | | Aspects related to management of QoS for | | | network slices of media services. How does QoS | | | work with network slicing? | | | | | | Aspects related to realization of media | | | services with multiple network slices, and | | | multi-network slice scenarios. | | | | | | Realization of use cases with network slicing. | +--------------------+------------------------------------------------+
Table 5.12.1.2-2 lists candidate list of Release-17 items that can benefit
with further specification on network slicing related aspects.
Table 5.12.1.2-2: Release-17 Items for further Network Slicing related
specification
+----------------------------------+----------------------------------+ | Work Items | Aspects for study related to | | | network slicing | +==================================+==================================+ | 5GMS_EDGE | There is minimal specification | | | in TR 26.803 [46] related to | | | network slicing. The TR can | | | greatly benefit from identifying | | | and specifying network slicing | | | aspects related to edge | | | computing such as below: | | | | | | Use cases: Realization of | | | current edge use cases using | | | network slicing keeping in view | | | the control and management | | | aspects of network slicing | | | architecture as standardized in | | | 3GPP SA2 and SA5. | | | | | | EAS relocation in relation to | | | network slicing impact, | | | architecture, and procedures for | | | supporting EAS relocation with | | | network slicing. | +----------------------------------+----------------------------------+ | EVEX | SA4 has started standardization | | | of a reference architecture for | | | data collection and reporting in | | | TS 26.531 [72]. The TR can | | | benefit from incorporating | | | network slicing related data | | | collection: | | | | | | Study information elements and | | | procedures related to data | | | collection about network slices | | | e.g., from NWDAF as specified in | | | TS 29.520 [70] and TS 28.541 | | | [61]. | | | | | | Slice optimization: Study | | | optimizing network slice | | | parameters for SA4 media | | | services using metrics | | | (analytics) collected using | | | above method. | | | | | | Editor's Note: Possible study | | | directions include study of how | | | slice related data from NWDAF | | | could be useful, who is the | | | customer of such data, and any | | | required API support to retrieve | | | such data. | +----------------------------------+----------------------------------+ | 5MBUSA | TR 26.802 [73] describes | | | aspects related to multicast. | | | Study can be performed to | | | identify the relationship | | | between 5G multicast and network | | | slicing and answer questions | | | such as below: | | | | | | 5G multicast media service using | | | network slicing: How to realize | | | 5G multicast and broadcast | | | services using network slicing. | | | | | | Hybrid Services: Study network | | | slicing impact on the hybrid | | | services key issue described in | | | TR 26.802 [73]. Investigate | | | whether different network slices | | | can be used with different | | | delivery systems for hybrid | | | services. | +----------------------------------+----------------------------------+ | NOTE: The scope of the EVEX Work | | | Item does not currently include | | | consuming analytics data from | | | the NWDAF. | | +----------------------------------+----------------------------------+
Editor's Note: Study to include aspects related to network slice usage e.g.,
how application/OS/UE can map different application traffic to network slices.
NOTE: In general, all the items in tables 5.12.1.2-1 and 5.12.1.2-2 are listed
here to present areas for further study on aspects related to network slicing.
The current scope of each of these work items may not include study of network
slicing aspects.
The scope of the study proposed in the above tables is not exhaustive or
final. More study topics can be identified in different work areas being
discussed in SA4. The study can include how existing and new use cases can
benefit with the network slicing specification. However, such a study in SA4
cannot be done in isolation. Multiple study/work items are currently underway
in different SA groups. It is recommended that SA4 study consider such studies
and work in other groups while specifying media service level network slicing
standardization. The following are some of the study/work items in other
groups that may be relevant to study in SA4:
\- [3GPP SA2] TR 23.700-40 [71]: Study on enhancement of network slicing;
Phase 2.
\- [3GPP SA6] TS 23.434 [68]: Service Enabler Architecture Layer for Verticals
(SEAL); Functional architecture and information flows.
\- [3GPP SA6] TR 23.700-99 [69]: Study in Network slice capability exposure
for application layer enablement (NSCALE).
NOTE: For maintaining alignment with the specifications in other groups, it is
recommended that correspondence with those groups is done using standard 3GPP
liaison procedures.
### 5.12.2 Collaboration Scenarios
Editor's Note: Study collaboration scenarios between the 5G System and
Application Provider for each of the key topics.
### 5.12.3 Deployment Architectures
Editor's Note: Based on the 5GMS Architecture, develop one or more deployment
architectures that address the key topics and the collaboration models.
### 5.12.4 Mapping to 5G Media Streaming and High-Level Call Flows
Editor's Note: Map the key topics to basic functions and develop high-level
call flows.
### 5.12.5 Potential open issues
The following potential open issues are identified:
1) Usage of network slicing identification information as part of service
provisioning information (M1)
2) Applicable stage 2 and stage 3 aspects related to impact to QoS
specification during service provisioning because of network slicing
3) Usage of network slicing identification information during dynamic policy
procedures (M5)
4) Applicable stage 2 and stage 3 aspects related to impact to QoS
specification because of network slicing in dynamic policy procedures
5) Will one AF be sufficient to interact with all network slices? Or, is there
a separate AF for each slice?
6) Provisioning of media services with multiple network slices -- Enhancements
to M1 interface
7) QoS Management for network slices -- will the QoS be provisioned and
managed separately for each slice by the ASP?
8) Determining the need for AF-to-AF communication to support interoperability
if 5GMS AF instances from different vendors are deployed in the same 5GMS
System.
NOTE: There is no impact on SA2 architecture because the concept of a service
spanning multiple network slices or PDU Sessions is not in SA2's scope.
9) Impacts of network slicing on Rel-16/Rel‑17 dynamic policy invocation APIs.
10) Methods for deploying, supporting, and resolving slice specific AS
instances including modification of media description documents (e.g., DASH
MPD), DNS etc.
### 5.12.6 Candidate Solutions
#### 5.12.6.1 Network slices and Operation Points provisioned at M1
The 5GMS Application Provider may use the M1 provisioning interface to define
a set of network slices that can be used for the media streaming sessions that
it offers. This is done when the 5GMS Application Provider would like to
request that its media traffic is isolated from other traffic. This may
facilitate features such charging and QoS accounting.
It may associate each operation point (e.g. 4K HDR, HD, SD) with a dedicated
network slice. Access to each network slice at reference point M4 is
restricted to UEs with a valid subscription to that service level. The list or
groups of users that are to be authorized to use a certain slice is provided
by the 5GMS Application Provider during the provisioning step and can be
updated subsequently.
Figure 5.12.6.1‑1 below shows a call flow for this solution:
Figure 5.12.6.1‑1: Call flow for provisioning network slices and Operation
Points
The steps are as follows:
1\. The 5GMS Application Provider provisions the configuration for all
upcoming media streaming sessions in the 5GMS AF at reference point M1.
a. The Application Provider declares a requirement for one or more network
slices that correspond to the operation points that it offers for the media
streaming service.
b. The 5GMS AF requests the MnS to create or update a set of network slices
based on the provided provisioning information. The MnS for network slice
management capability exposure is currently being studied in SA5 in TR 28.824.
The characteristics of a network slice are stored as part of the
ServiceProfile as defined in TS 28.541.
c. The Media Session Handler in the 5GMS Client retrieves Service Access
Information from the 5GMS AF. The response includes a mapping between the
operation point and the S-NSSAI that should be used by the session.
2\. The 5GMS-Aware Application retrieves the entry point for the media
streaming session from the 5GMS Application Provider at reference point M8.
The returned entry point contains information about the allowed Operation
Points, e.g. in the DASH service descriptor.
3\. The 5GMS-Aware Application selects one of the offered Operation Points.
4\. The application informs the Media Session Handler about the start of a new
media streaming session and indicates the selected Operation Point.
5\. The Media Session Handler informs the 5GMS AF about the starting media
streaming session and the desired Operation Point.
6\. The 5GMS AF requests the application of the corresponding QoS profile to
the media streaming session.
7\. The Media Session Handler may request the establishment of a new PDU
session or the modification of an existing PDU session to use the allowed
network slice as indicated by the S-NSSAI. Note that the PDU session is
dedicated for the media streaming session traffic. The PDU session
establishment and update procedures are defined in clause 8.3 of TS 24.501.
8\. The AMF may request admission control to use the selected slice from the
NSACF.
9\. If allowed, the PDU session is established/updated to use the selected
S-NSSAI.
10\. Media streaming commences at reference point M4.
To support this high-level procedure:
\- The streaming session uses the eMBB SST slice/service type.
\- The Slice Differntiator is mapped to an operation point of the service that
is indicated through the _externalReference_ as defined in clause 7.9.3.1 of
TS 26.512 [16].
### 5.12.7 Conclusion
1\. The collaboration scenarios, deployment architectures, and potential open
issues concerning network slicing extensions are to be studied further in
Release 18.
2\. Impact of network slicing is across multiple work items. Therefore, study
for network slicing extensions is to be looked at from the perspective of
multiple work items.
## 5.13 Key Issue #12: 3GPP Service Handler and URLs
### 5.13.1 Description
In many cases, media services are deployed on top of 3GPP systems, in
particular the 5G System. In a typical architecture as shown in Figure
5.13.1-1, a media service is provided as an IP service on top of the 5G
System.
Figure 5.13.1-1 Baseline Architecture -- Third-party Service Over-the Top
In this scenario, UE applications are not assumed to have knowledge of 5G
Media Streaming, for example a DVB-I Client. Hence, the terms _Media Service
Application_ and _Portal Application_ are used throughout this Key Issue
instead of 5GMS-Aware Application. In a possible normative work stage, the
terms may be replaced with for example \"non 5G-aware\" application.
NOTE: The case where a 5GMS-Aware Application translates a conventional media
service entry URL to a 3GPP Service URL is not precluded.
In this context, a _Media Service Provider_ refers to a party that makes use
of the 5G System for media delivery but uses only a subset of the
functionalities provided by the 5G System.
The media service is announced in a Portal Application running in the UE, for
example a portal web page or similar electronic service guide, as a link
published on social media, or as an entry in a DVB-I service list [97]. In all
cases, the service announcement includes a media service entry point URL. When
a service is selected in the Portal Application, it launches the URL of the
corresponding media service entry point.
In the general case, the media service entry point is consumed by a separate
Media Service Application in the UE which takes responsibility for interacting
with the UE modem to stream the media (downlink or uplink) of the selected
media service.
NOTE: In some deployments, the functions of the Media Service Application are
a system service provided by the UE Operating System, or the Portal
Application and the Media Service Application are fused together and installed
as a single application. In such cases, the Portal Service Provider and Media
Service Provider are typically a single entity also.
The Android UE Operating System allows a URL to be used by one application to
launch a specific other application on the same UE [98]. An application
wishing to handle certain URI prefixes does so by declaring a suitable _intent
filter_ in its application manifest (a so-called _web URI intent_
declaration).
Android recognises three different types of link:
\- _Deep links_ are URIs of any scheme that take users directly to a specific
part of an application.
\- _Web links_ are deep links that use the HTTP and HTTPS schemes.
NOTE: On Android 12 and higher, clicking a web link (that is not an Android
App Link) always shows content in a web browser.
\- _Android App Links_ , available from Android 6.0 onwards (API level 23 and
higher), are web links that use the HTTP and HTTPS schemes and contain the
_autoVerify_ attribute. This attribute allows the application to designate
itself as the default handler of a given type of link. Android App Links
leverage HTTP URLs and association with a website. If no installed application
has declared an intent for the trigger URL, the content at that URL is instead
displayed in a web browser, from where the user may be invited to install the
application.
iOS supports similar functionalities. Details are for future study.
A basic call flow for the general case (where the Media Service Application is
separate from the Portal Application and the Media Service Provider is
separate from the Portal Service Provider) is provided in figure 5.13.1-2.
{width="6.69375in" height="3.8027777777777776in"}
Figure 5.13.1-2 Baseline call flow -- over-the-top third-party service
The call flow is as follows:
1\. The user installs the Portal Application.
2\. The user installs the Media Service Application. The manifest of the Media
Service Application declares an Intent filter for one or more media entry
point URL prefixes.
3\. The Portal Service Provider receives a media service entry point from the
Media Service Provider.
4\. A UE establishes a connection to the 5G System.
5\. Through this connection (or by other means) the Portal Application
discovers the set of currently available media services and their entry point
URLs.
6\. The user selects a media service in the Portal Application\'s user
interface.
7\. The Portal Application requests the media service entry point URL
corresponding to the media service selected in the previous step.
**8\. Because the media service entry point URL matches one of the declared
Intent filters for the Media Service Application, the UE Operating System
intercepts the request and instead launches the Media Service Application,
passing the URL as a parameter.**
9\. The Media Service Application now requests content from the Media Service
Provider.
### 5.13.2 Collaboration Scenarios and Deployment Architectures
3GPP has developed several specifications whereby a third-party service may
use additional 5G System functionalities, either as supporting functions (e.g.
5GMS Media Session Handler and 5GMS AF) or as essential functions (e.g.
delivery via MBMS for which an MBMS Client is needed). Such 3GPP-defined
functions may be in the UE, in the network, or both. This is shown in figure
5.13.2-1.
{width="6.354330708661418in" height="2.795275590551181in"}
Figure 5.13.2-1 Architecture extended with 5GS functions
Examples of 3GPP-defined functions include, but are not limited to:
\- DASH/HLS Service + using MBMS User Services.
\- DASH/HLS Service + using 5G Broadcast Services (i.e. MBMS Receive-Only
Mode).
\- DASH/HLS Service + using MBS User Services.
\- DASH/HLS Service + using 5G Media Streaming functionalities.
\- XR Service using 5G Edge Enablers.
The third-party service may be served/supported through a 5G System. In order
to do so, a dedicated client function needs to be initialized in order to
carry out specific functions, for example:
\- MBMS Client (UE) and BMSC (see TS 26.346 [54] and TS 26.347 [99]).
\- MBS Client (UE) and MBSF/MBSTF (see TS 23.247 [101], TS 26.501 [15], TS
26.512 [16]).
\- 5GMS Media Session Handler (UE) and 5GMS AF (see TS 26.501 [15], TS 26.512
[16]):
\- Consumption Reporting.
\- Metrics Reporting.
\- Dynamic Policies.
\- 5G Broadcast Receiver (UE).
\- Edge-Enabler Client (UE) and Edge Application Server.
### 5.13.3 Mapping to 5G Media Streaming and high-level call flows
Figure 5.13.3-1 provides the potential call flow for launching a dedicated 5G
System function.
Figure 5.13.3-1 Call flows to launch dedicated 5G System functionalities
The call flow is as follows:
> 1\. The Portal Service Provider receives a media service entry point from
> the Media Service Provider.
>
> 2\. The Media Service Provider establishes a provisioning session with the
> 5G System for the service.
>
> 3\. A UE establishes a connection to the 5G System.
>
> 4\. Through this connection (or by other means) the Portal Application
> discovers the set of currently available media services and their entry
> point URLs.
>
> 5\. The user selects a media service in the Portal Application\'s user
> interface.
>
> 6\. The Portal Application requests the media service entry point URL
> corresponding to the media service selected in the previous step.
>
> **7\. Once the entry point is received,_now by some magic_ , the device-
> centric dedicated 5GS UE function (e.g. 5GMS Media Session Handler, MBMS
> Client, MBS Client, etc.) is launched.**
>
> 8\. Once launched, the UE connects to the peer network functions (e.g. 5GMS
> AF, BM‑SC, MBSF, etc.) and establishes additional functionality.
>
> **9\. By _another magic_ , the Media Service Application is automatically
> launched.**
NOTE: If the Media Service Application is fused with the Portal Application,
this launch step is an internal function call.
> 10\. The Media Service Application now requests content from the Media
> Service Provider and is supported by the 5G System function launched in step
> 7.
In particular, the magic execution in steps 7 and 9 have not been discussed in
detail before now. Different implementation options may exist but may require
changes to existing applications.
### 5.13.4 Potential open issues
#### 5.13.4.1 Overview
As indicated in clause 5.13.3, the main open question in relation to the
present document is how the dedicated 5G functions (e.g. 5GMS Media Session
Handler, MBMS Client, MBS Client, etc.) are launched. A few options are
considered in the following.
1: An API is created to the device function and the application initializes
the function through these APIs -- this is, for example, what TS 26.347 [99]
assumes.
\- Problem: the application on the device needs to have specific provisioning
to establish this function.
\- Unlikely to be broadly available.
2: Using a non-HTTP(S) URL as a Media Entry Point that resolves the link by
specific handling.
\- This option is, for example, done for MBMS User services in TS 26.347 [99].
\- The URL contains sufficient information to access the service.
\- However, the problem here is that the URL is not automatically handled by
the UE Operating System (e.g. Android) or browser.
3: Using an HTTP(S) URL as a Media Entry Point that triggers some specific
actions
\- This allows the service to be activated by the user simply \"clicking\" it,
or by advertising the link in some portal-based user experience. For example,
HTTP URLs in SMS text messages are \"clickable\" in Android.
\- Once the user has selected the link described by the URL, the service
bootstraps by setting up the appropriate 3GPP functions and connects to the
network.
In particular option 3 is attractive because it is aligned with existing
application development practices. The main issue is to consult a UE-resident
URL handler/resolver that bootstraps the service URL and does all the
appropriate actions, for example:
\- Enable MBMS reception,
\- Set up a 5G Media Streaming session (Media Session Handler -- 5GMS AF) and
so on.
\- In one specific case at least (MBMS Receive-Only Mode service) this needs
to be done only on the UE.
The basic idea is to specify 3GPP-defined HTTP URLs that:
\- Initiate execution of this service bootstrapping with a basic function on
the UE to support:
\- Initiating some pre-installed functions (e.g. Receive-Only Mode operation).
\- Launching device functions.
\- Allow additional network functions to support the resolution of the service
URL, for example go to a specific AF providing more service-related
information and launching network functions.
Until now, 3GPP has avoided the detailed question of how to bootstrap 5G Media
Streaming and has deferred such aspects to implementation, device pre-
configuration, and so on. We understand that device pre-configuration such as
OMA Device Management (DM) is no longer broadly in operation.
Hence, candidate solutions for adding a _3GPP Service Handler_ in the UE and
network for the purpose of 5GMS service launch are considered in the following
clause, as shown in figure 5.13.4-1.
{width="6.354330708661418in" height="2.795275590551181in"}
Figure 5.13.4-1 Architecture with 3GPP Service Handler
Based on the Figure 5.13.4-1, different potential solutions exist:
1: _Network-based resolution:_
\- Request URL is constructed such that it is resolved in a dedicated 3GPP
network function.
\- Request URL resolves to a network function that triggers some support
function in network.
\- Network function returns media service entry point URL to the UE, for
example in the form of an HTTP(S) redirection.
NOTE: This network functionality resembles that of the DVB‑MABR _Multicast
rendezvous service_ when it is deployed in the network (see clause 6.1 of ETSI
TS 103 769 [100]).
\- Media Service Application is launched based on returned media entry point
URL, for example by means of Android App Link intent.
2: _UE-based resolution:_
\- Request URL is a 3GPP Service URL constructed to include service
information, service parameters and media entry point URL.
\- In this case, the 3GPP Service URL triggers the handling of the URL by:
\- Optionally, communicating with the network function to establish functions
in the network (possibly getting additional service parameters and media entry
point URL).
\- Launching the dedicated 5G System functions based on the URL parameters.
\- Launching the Media Service Application using the media entry point URL
extracted from the 3GPP Service URL, for example by means of Andoid App Link
intent.
Both solutions are valid and are discussed in more detail in the remainder of
this clause.
#### 5.13.4.2 Network-based resolution
If no handler is available for the media service entry point URL on the UE, it
simply resolves to a 3GPP network function. This scenario is shown in figure
5.13.4.2-1. The application provider's media service entry point URL is
directly handled in the UE.
{width="6.354330708661418in" height="2.795275590551181in"}
Figure 5.13.4.2-1 Architecture with 3GPP Service Handler in network-based
solution
Figure 5.13.4.2-2 provides the potential call flow for a network-based
solution.
Figure 5.13.4.2-2 Call Flow with 3GPP Service Handler in network only
The call flow is as follows:
1\. The Portal Service Provider receives a media service entry point from the
Media Service Provider.
2\. The Media Service Provider establishes a provisioning session with the 5G
System for the service.
3\. A UE establishes a connection with the 5G System.
4\. Through this connection (or by other means) the Portal Application
discovers the set of currently available media services and their entry point
URLs.
5\. The user selects a media service in the Portal Application\'s user
interface.
6\. The Portal Application requests the media service entry point URL
corresponding to the service selected in the previous step. This points
directly to the 3GPP Service Handler in the network.
7\. The 3GPP Service Handler in the network launches the relevant network
function(s).
8\. The 3GPP Service Handler in the network redirectsthe Portal Application to
the Media Service Application by returning a URL matching one of the declared
intents of the Media Service Application.
9\. The Media Service Application is automatically launched based on the URL
10\. The Media Service Application now requests content from the Media Service
Provider and is supported by the 5G System function.
#### 5.13.4.3 UE-based solution with optional network-based resolution
In a second case, the URL is resolved in a 3GPP Service Handler function in
the UE, but may optionally be assisted by a resolution in the network, as
shown in figure 5.13.4.3-1. The application provider URL is directly handled
in the UE-based 3GPP Service Handler, but additional service parameters may be
obtained by it from the network-based 3GPP Service Handler.
{width="6.354330708661418in" height="2.795275590551181in"}
Figure 5.13.4.3-1 Architecture with 3GPP Service Handler combined in network
and UE
Figure 5.13.4.3-2 provides the potential call flow for a combined solution.
Figure 5.13.4.3-2 Call flow with 3GPP Service Handler with combined solution
The call flow is as follows:
1\. The portal service provider receives a media service entry point from the
Media Service Provider.
2\. The Media Service Provider establishes a provisioning session with the 5G
System for the service.
3\. A UE establishes a connection to the 5G System.
4\. Through this connection (or by other means) the Portal Application
discovers the set of currently available media services and their entry point
URLs.
5\. The user selects a media service in the Portal Application\'s user
interface.
6\. The Portal Application requests the media service entry point URL
corresponding to the media service selected in the previous step, which points
to the local 3GPP service handler.
7\. The UE-based 3GPP Service Handler may collect additional service
parameters from its peer network-based 3GPP Service Handler.
8\. The UE-based 3GPP Service Handler launches the Dedicated 5GS UE Function
(e.g. 5GMS Media Session Handler, MBMS Client, MBS Client, etc.). Launch may
be achieved by invoking the defined APIs of the Dedicated 5GS UE function, for
example those for the MBMS Client defined in TS 26.347 [99]. If these APIs do
not exist, then the the UE-based 3GPP Service Handler and the Dedicated 5GS UE
Function may be considered \"one\" functional block and this step is an
function call internal to that block.
9\. The Dedicated 5GS UE Function may collect information from its peer
Dedicated 5GS Network Function (e.g. 5GMS AS, BM-SC, MBSF, etc.).
10\. The UE-based 3GPP Service Handler also launches the Media Service
Application on the UE.
11\. Inter-process communication between the Media Service Application, UE-
based 3GPP Service Handler and the Dedicated 5GS UE Function is established --
this may for example allow to exchange status information, get notifications
as typically provided over M6.
12\. The Media Service Application now requests content from the Media Service
Provider using the URL for the media service in the way described in clause
5.13.1, for example through Android app links, or by using the APIs defined by
the Media Service Application to hand over the media URL.
### 5.13.5 Candidate Solutions -- 3GPP Service and URL handler
#### 5.13.5.1 Solution 1: 3GPP Service and HTTP URL handler
In order to address the cases in clause 5.13.4, it is proposed to:
\- Register a unique host name in the 3GPP-managed domain 3gppservices.org for
each 3GPP service as part of 3GPP specifications such that service instances
can be referenced under a controlled URL, e.g.
http://ms.launch.3gppservices.org and https://ms.launch.3gppservices.org for
5G Media Streaming services.
\- Specify a website/redirection mechanism in case a suitable 3GPP Service
Handler is not already installed on the UE to handle the URL.
\- The URL itself needs to be constructed in such a way that it can be
resolved to the media service, for example by embedding the media entry point
URL.
\- Specify an application/service that realises the UE-based 3GPP Service
Handler which declares an intent filter so that the application acts as the
default handler for the 3GPPP Services domain name registered above. The
intent filter includes the following declarations:
\- The DEFAULT category to allow the application to respond to implicit
intents.
\- The BROWSABLE category in order for the intent filter to be invoked when
clicking a link in a browser.
\- \ tags including the _android:scheme_ attribute for both HTTP and
HTTPS.
\- A \ tag including the _android:host_ attribute with the registered
3GPP Services domain.
\- Verify ownership details see here.
An example intent filter is provided below:
* * *
\\ \\ \\ \\ \ \\ \\ \ \\ \
* * *
Based on this setup, the following set of actions and calls happen:
1\. A 3GPP Service Handler background service is pre-installed on the UE by
the vendor or installed once by the user. The manifest includes an intent
filter that declares an interest in the 3GPP Services domain.
2\. The Media Service Provider has a service with an entry point URL.
3\. The Media Service Provider negotiates all service parameters with the 5G
System (provisioning).
4\. The Media Service Provider creates a bootstrapping URL (much like a
landing page URL).
\- http://_\ _.launch.3gppservices.org/_\ _
\- https://_\ _.launch.3gppservices.org/_\ _
Example service type identifiers could include:
\- ms with a service parameter that identifies or resolves to a 5GMS
Provisioning Session to indicate the necessity to initiate media session
handling for 5G Media Streaming.
\- mbms with MBMS parameters for Receive-Only Mode operation to indicate the
necessity to launch the MBMS Client in order to initiate reception of a MBMS
User Service.
\- mbs with an MBS Service identifier to indicate the necessity to launch the
MBS Client in order to initiate reception of a 5G Multicast--Broadcast User
Service.
\- ims to indicate use of the IP Multimedia Subsystem.
\- etc.
Service parameters are formatted as path elements and/or query parameters and
could include:
\- A service identifier that is preferably globally unique so that the same
value can be used in different 5G Systems.
\- The service entry point URL of an application service to be launched by the
UE-based 3GPP Service Handler.
5\. The Media Service Provider provides:
\- Only the 3GPP Service URL to a Portal Service Provider, search engine,
etc., if the service requires 3GPP service launch. This may embed the service
entry point URL.
\- Both the service entry point URL and the 3GPP Service URL, if the 3GPP
service is only an enhancement to launch the third-party service.
6\. The Portal Service Provider provides these URLs to the Portal Application
running on the UE, e.g. as part of a script, for display in a web page etc.
When the service is selected by the user, the Portal Application obtains or
generates a 3GPP Service URL and submits a request for it.
7\. If a 3GPP Service Handler for the requested service type identifier is
already installed on the UE, it is invoked in the background by the mobile
Operating System via its registered intent filter to handle the URL and:
\- Uses the service parameters to establish the 3GPP service in the background
(if appropriate or available) and potentially connects to the network.
\- Extracts the media service entry point URL from the 3GPP Service URL and
uses it to the Media Service Application.
\- Establish Inter-Process Communication with other UE functions, as required.
\- The Media Session Handler (Media Player or Media Streamer) may be launched
by the 3GPP Service Handler, if separate from the Media Service Application.
8\. If a 3GPP Service Handler for the requested service type identifier is not
yet installed on the UE:
\- A network service is called and runs the 3GPP Service URL resolution. In
the simplest case, this resolution, included in the MNO\'s network, redirects
to the media service or
\- An HTTP 404 client error response is returned by the UE Operating System
and the Portal Application either terminates the service or uses the alternate
over-the-top entry point.
#### 5.13.5.2 Solution 2: Extended Media Service Application URL
In this case the media service URL is extended with query parameters (or
similar) of interest to the 3GPP Service Handler. This requires the Media
Service Application to understand that it requires/benefits from a 3GPP
service and requires it to launche the 3GPP Service Handler application. The
Media Service Application needs to be specifically built for this, adding for
example intent filters.
http://\/?3GPP-service=\
#### 5.13.5.3 Solution 3: Dedicated URL and DNS Resolution
In another option, at least the first option may be addressed with a DNS
resolution. In this case
1) A common 3gpp: URL scheme automatically launches a 3GPP resolver.
2) The 3GPP resolver uses DNS service resolution to request _SRV_ records.
3) The resolution provides all required service parameters.
4) In case of Receive-Only Mode operation, DNS service resolution may happen
within the UE based on pre-configuration.
5) Alternative or new record types may be defined.
\- URI DNS record may be suitable for this use case.
mbs://netflux.com/series8 mbs URI-DNS DNS query URI dns://netflux.com
An example URI DNS record is provided as follows:
> _mbs-rom._tcp IN URI 10 1 \"http://www.example.com/path/service-
> announcement\"
Figure 5.13.5.3-1 provides a service architecture with DNS functionality.
{width="6.248031496062992in" height="2.6181102362204722in"}
Figure 5.13.5.3-1 Service architecture with DNS functionality
The problem with such an approach is that the URL does not use the HTTP scheme
and hence is not supported by the Android intent filter mechanism. A dedicated
DNS query would have to be implemented.
#### 5.13.5.4 Assessment of solutions
Solution 1, registering a 3GPP Service domain for use in URLs as described in
clause 5.3.4.1, has multiple benefits in comparison with the other candidate
solutions:
\- URL is clickable, and can for example be added to web pages, text messages
and so on. This is not the case for solution 3.
\- If service is not found, this can be returned to portal and alternative URL
may be used.
\- Can be applied for any third-party application and does not require any
changes to app. This is not the case for solution 2.
\- Is likely extensible also to iOS to install a similar function on the
device.
\- Service can be launched including Interprocess Communication (IPC). Not the
case for solution 2 and 3.
#### 5.13.5.5 Open issues
A few open issues still exist, but may be left to implementation:
\- It is unclear if the 3GPP Service Handler application can be launched as a
background service on common UE Operating Systems.
\- How could this model work for webRTC-based services?
\- Does the service scale properly?
\- What are security/authorization aspects?
\- What are the implications of every MNO running its own 3GPP Service Handler
as a background service?
\- Can such a 3GPP Service Handler be pre-installed on a device by the UE
vendor as a common UE Operating System function?
\- How can the lifecycle of the 3GPP Service Handler background application be
managed and monitored?
### 5.13.6 Specific cases
#### 5.13.6.1 Specific case: MBMS-ROM Service + CMAS-based launch of service
In this case, an Emergency Service Provider also wants to distribute the
Emergency Alerts through LTE-based 5G Broadcast. This is for example relevant
in at least two cases:
1\. UE consumes service from broadcast network and hence is camped on the LTE-
based 5G Broadcast ROM service and therefore receives the SIB messages from
the MBMS ROM system.
2\. MNO PLMN is not accessible and therefore the UE camps on the broadcast
network because it is the only available system, for example in disaster
situations during which the mobile network is not up and running, or in remote
coverage areas.
In addition, an Emergency Media Broadcast Service may be provided. Assume the
setup documented in figure 5.13.6‑1.
{width="6.695138888888889in" height="3.5069444444444446in"}
Figure 5.13.6-1 Potential Architecture for Emergency Warning through 5G
Broadcast with pointers to media services
Using the principles of Solution 1,
\- Define a URL for 3GPP services as part of 3GPP specifications, e.g.
services.3gpp.org
\- Define a service sub-domain mbms
\- Add the relevant parameters from mbms-URL as defined in TS 26.347, clause
8.4 to the URL
\- In operation,
\- install a background app that handles the URL.
\- Emergency media application provider has a service and wants to provide it
through MBMS.
\- The 3GPP System provides a URL to the Emergency service provider with all
relevant parameters
\- http://3gpp-services.com/mbms/\/\
\- The Emergency media application service provider provides to the CMAS
provider.
\- Only the 3GPP MBMS Service URL, if the service is only available over MBMS.
\- Both URLs, the unicast and the 3GPP service URL, if the 3GPP service is
available on both.
\- The emergency service provider adds the URLs to a CMAS message as a textual
description.
\- The user reads the message and clicks on the 3GPP Service URL.
\- The click deep-links to the 3GPP Service app and the service app.
\- identifies MBMS and launches the MBMS client.
\- Identifies the third-party entry point and launches the URL.
Figure 5.13.6-2 provides the architecture and messages exchanged for the above
use cases.
{width="4.192913385826771in" height="3.0039370078740157in"}
Figure 5.13.6-2 Architecture and messages to CMAS-based service launch
The following call flow and actions happen.
1\. User gets emergency notifications, click on "registered" URL.
2\. Android system sends the URL to the service handler (background app).
3\. The service handler does two things:
a: Start the middleware based on part of the URL (e.g. frequency, TMGI).
b: Start the application and send a URL.
4\. The "UE Service Handler" serves as an HTTP proxy for the Application#2.
a. Gets files from the MW.
b. Serves files to Media app.
In this case, it may not be necessary that the URL includes the application
service entry point, but the entry point is included in a service announcement
file related to the 5G UE functions. As an example, the service entry point is
part of the MBMS User Service Description.
#### 5.13.6.2 Specific case: Launch of 5G Media Streaming service by 5GMS-
Aware Application
##### 5.13.6.2.1 Introduction
With reference to candidate Solution 1 outlined in clause 5.13.5.1, clause
5.13.6.2.2 proposes a format for a 3GPP Service URL that can be used by a
5GMS-Aware Application (playing the dual role of Portal Application and Media
Service Application) to launch a 5G Media Streaming Session using an external
service identifier proposed in clause 5.13.6.2.3. The proposal is aligned with
clause B.1 of TS 26.501 [15] which describes a DNS-based solution to MNO-
specific Service Access Information acquisition.
In this proposal, the 5GMS Media Session Handler plays the role of 3GPP
Service Handler. A procedure for handling the 5GMS Service URL in the Media
Session Handler is proposed in clause 5.13.6.2.4.
##### 5.13.6.2.2 5GMS Service URL format
The 3GPP Service URL format used to initiate 5G Media Streaming sessions takes
the following form:
> http _[_ s _]_ ://ms.launch.3gppservices.org/service-
> id/_{external_service_id}_?_{query_parameters}_
The parameters of the 5GMS Service URL are as follows:
Table 5.13.6.2.2‑1: 5GMS Service URL parameters
+--------------------------+-------------+--------------------------+ | Path element | Cardinality | Description | +==========================+=============+==========================+ | _external_service_id_ | 1 | An External Service | | | | Identifier that resolves | | | | to a Provisioning | | | | Session in the 5GMS | | | | System (see NOTE). | +--------------------------+-------------+--------------------------+ | Query parameter | Cardinality | Description | +--------------------------+-------------+--------------------------+ | _af-host-address_ | 0..* | The Fully Qualified | | | | Domain Name and optional | | | | port number of a 5GMS AF | | | | endpoint to be used by | | | | the Media Session | | | | Handler at reference | | | | point M5 with the format | | | | _hostname[:port]_. | | | | | | | | More than one occurrence | | | | of this parameter may be | | | | present in the Service | | | | URL to indicate | | | | alternative host | | | | endpoint addresses. Any | | | | of these may be used by | | | | the Media Session | | | | Handler at reference | | | | point M5. | | | | | | | | Supplied by the invoking | | | | 5GMS-Aware Application | | | | when the 5GMS AF is | | | | deployed in an External | | | | DN. The endpoint | | | | address(es) may, for | | | | example, have been | | | | passed to the 5GMS-Aware | | | | Application via | | | | reference point M8. | | | | | | | | If omitted, the Media | | | | Session Handler assumes | | | | the default 5GMS AF host | | | | endpoint address | | | | _ms. | | | | af.3gppservices.org:443_ | | | | is to be used at | | | | reference point M5. | +--------------------------+-------------+--------------------------+ | _media-entry-point_ | 0..1 | A Media Entry Point | | | | reference expressed as a | | | | fully qualified URL at | | | | reference point M4. | | | | | | | | If supplied, used by the | | | | Media Session Handler to | | | | launch the Media Stream | | | | Handler (Media Player or | | | | Media Streamer) after | | | | successfully initiating | | | | media session handling. | +--------------------------+-------------+--------------------------+ | _content-type_ | 0..* | A MIME content type | | | | string conforming to | | | | section 5 of | | | | RFC 2045 [103] | | | | identifying a type of | | | | Media Entry Point that | | | | is acceptable to the | | | | Media Stream Handler | | | | (Media Player or Media | | | | Streamer). | | | | | | | | More than one occurrence | | | | of this parameter may be | | | | present in the Service | | | | URL to indicate that | | | | more than one type of | | | | Media Entry Point is | | | | acceptable. | | | | | | | | Used by the Media | | | | Session Handler to | | | | eliminate unacceptable | | | | Media Entry Points from | | | | those listed in the | | | | Service Access | | | | Information. | | | | | | | | It is an error to supply | | | | this parameter if an | | | | explicit Media Entry | | | | Point is specified using | | | | _media-entry-point_. | +--------------------------+-------------+--------------------------+ | _profile_ | 0..* | A URI (encoded per | | | | section 2.1 of | | | | RFC 3986 [104]) | | | | identifying a media | | | | streaming profile that | | | | is acceptable to the | | | | Media Stream Handler | | | | (Media Player or Media | | | | Streamer). | | | | | | | | More than one occurrence | | | | of this parameter may be | | | | present in the Service | | | | URL to indicate that | | | | more than one media | | | | streaming profile is | | | | acceptable. | | | | | | | | Used by the Media | | | | Session Handler to | | | | eliminate unacceptable | | | | Media Entry Points from | | | | those listed in the | | | | Service Access | | | | Information. | | | | | | | | It is an error to supply | | | | this parameter if an | | | | explicit Media Entry | | | | Point is specified using | | | | _media-entry-point_. | +--------------------------+-------------+--------------------------+ | NOTE: Addition to | | | | table 7.2.3.1‑1 of | | | | TS 26.512 [16]. | | | | Several different | | | | External Application | | | | Identifiers may be | | | | associated with a | | | | Provisioning Session, | | | | but a given External | | | | Application Identifier | | | | is associated with at | | | | most one Provisioning | | | | Session in each 5G | | | | System, ensuring unique | | | | resolution. | | | +--------------------------+-------------+--------------------------+
The _external_service_id_ path element and _af-host_ query parameter
correspond to the **baseline Service Announcement** for 5G Media Streaming
envisaged in TS 26.501 [15]. Together, they enable a full set of Service
Access Information to be retrieved by the Media Session Handler from the 5GMS
AF using the M5 Service Access Information API.
The _media-entry-point_ parameter is used to support the procedure where the
Media Session Handler launches media playback in the Media Stream Handler
(Media Player or Media Streamer) after successfully retrieving a full set of
Service Access Information via reference point M5 (if needed) and after
successfully initiating media session handling.
The remaining parameters are used for client-side filtering of Media Entry
Point information provided in the Service Access Information and selection of
one Media Entry Point by the Media Session Handler. (They are mutually
exclusive with the _media-entry-point_ parameter.) In this case, media
playback by the Media Stream Handler (Media Player or Media Streamer) is
launched by the Media Session Handler with its chosen Media Entry Point.
If the 5GMS-Aware Application wants to launch media streaming itself (rather
than have the Media Session Handler launch media streaming on its behalf), the
_media-entry-point_ query parameter and all client-side filtering parameters
are omitted from the Service URL. In this case, the Media Session Handler only
initiates media session handling for the 5GMS Provisioning Session identified
by the External Application Identifier.
The list of parameters could be extended to allow a 5GMS-Aware Application to
pass a complete set of Service Access Information (previously acquired by it
via reference point M8) to the Media Session Handler, thereby avoiding the
need for it to invoke the M5 Service Access Information API on the 5GMS AF.
However, since not all parameters available in M5 Service Access Information
are provided back to the 5GMS Application Provider by the M1 Provisioning
APIs, a fully comprehensive solution may not be possible.
Note the use of a new External Service Identifier rather than the Provisioning
Session ID in the 5GMS Service URL. The Provisioning Session ID is different
for every 5GMS System, and it is subject to change in a given 5GMS System if
5GMS services are reprovisioned. Both facets of the Provisioning Session ID
are therefore inconvenient for a 5GMS-Aware Application that is intended to
work on different 5GMS Systems. Using a stable, cross-system identifier to
retrieve Service Access Information is significantly preferable.
##### 5.13.6.2.3 External Service Identifier format
For an External Service Identifier to be useful and convenient in the context
of 5G Media Streaming:
**1\. It needs to be unique on a given 5GMS System** so that it can be used
for retrieval of Service Access Information at reference point M5.
\- Attempting to create more than one Provisioning Session at reference point
M1 with the same External Service Identifier is an error.
**2\. It needs to be the same across all 5G Systems** so that a single 5GMS-
Aware Application is portable between 5G Systems.
\- Implies a need for External Service Identifier values to be allocated by a
party other than an MNO.
\- Values could be allocated by a centralised registry function (e.g., run by
3GPP).
\- For better scalability, values could be allocated in a distributed fashion
by each Application Service Provider (5GMS Application Provider).
A globally unique identifier, such as a URI (e.g., a URN or tag URI), UUID,
Fully-Qualified Domain Name or reverse FQDN (e.g. _uk.co.bbc.iplayer.vod_)
would satisfy both of the above requirements.
It is proposed that TS 26.512 [2] specifies that the External Service
Identifier is formatted as a reverse FQDN for the following reasons:
i) A reverse FQDN is likely to be considerably shorter than a UUID.
ii) Unlike a URI, a reverse FQDN does not typically require percent encoding
to embed its value in the 3GPP Service URL.
iii) Reverse FQDNs are typically used by application developers as part of
class package names.
##### 5.13.6.2.4 Procedures for 5GMS Service URL handling
The Media Session Handler plays the role of 3GPP Service Handler for 5GMS
Service URLs by registering itself as the URL handler for the domain name
_ms.launch.3gppservices.org_ (e.g., by declaring an intent filter in an
Android application manifest). Hence, the Media Session Handler is launched
when a 5GMS-Aware Application requests a 5GMS Service URL (e.g., by means of
an Android intent filter).
Based on the information supplied in the 5GMS Service URL, the Media Session
Handler forms the M5 request URL for Service Access Informaiton as follows:
> http _[_ s _]_ ://_{apiRoot}_ /3gpp-m5/service-access-
> information/_{external_service_id}_
NOTE: This implies a change to clause 11.2.2 in TS 26.512 [16] which currently
specifies the use of the Provisioning Session ID to retrieve Service Access
Information as the final path element of the request URL.
1\. If the Media Session Handler was invoked with one or more _af-host-
address_ query parameters, the Media Session Handler chooses one to substitute
into _{apiRoot}_ in the above request URL.
a. This corresponds to collaboration scenarios where the 5GMS AF is deployed
in the External DN.
b. The party operating the 5GMS AF is responsible for ensuring that the
hostname(s) resolve to the correct IP address(es) in the External DN.
c. If the port number is omitted from any _af-host-address_ , port 443 is
assumed.
d. If more than one _af-host-address_ query parameter is supplied in the
Service URL, the Media Session Handler may use an alternative host endpoint
address at reference point M5 if the one it is using fails to respond after
some implementation-specific number of retries.
2\. If the _af-host-address_ query parameter is omitted, the default host name
_ms.af.3gppservices.org_ and port number 443 is used instead.
a. This corresponds to collaboration scenarios where the 5GMS AF is deployed
in the Trusted DN.
b. The 5G System operator is responsible for supporting resolution of this
well-known host name to the correct IP address(es) in the Trusted DN, e.g., by
managing appropriate DNS records.
c. The 5G System operator is responsible for ensuring that a resilient service
is available at this host endpoint address. If the hostname resolves to
multiple IP addresses, the Media Session Handler may use a different one at
reference point M5 if the one it is using fails to respond after some
implementation-specific number of retires.
d. It is recognised that correct resolution of the hostname may be hampered if
the end user configures an alternative DNS resolution service. Unless the
Media Session Handler can override this and use the 5G System DNS resolution
service, this is considered a failure case for 5G Media Streaming session
initiation that is reportable to the end user.
3\. If the Media Session Handler was invoked with the optional _media-entry-
point_ query parameter, the Media Session Handler issues a request for this
URL (thereby chaining the Media Stream Handler), but only after it has
successfully retrieved the Service Access Information from the 5GMS AF.
Depending on the success (or otherwise) of retrieving the Service Access
Information (and optionally chaining the Media Stream Handler with the media
entry point), the Media Session Handler returns an appropriate HTTP status
code to the invoking 5GMS-Aware Application.
### 5.13.7 Conclusion
Until now, 3GPP specifications for 5G Media Streaming have avoided addressing
the detailed question of how to bootstrap 3GPP-defined UE and network
functions such as the Media Session Handler or the MBMS/MBS Client. This is
deferred to implementation, device pre-configuration, and so on. However, the
lack of specification covering this Key Issue is hindering adoption of 5GS-
supported media services because today UE applications may have to be modified
in order to support such services.
3GPP defines the ability to use DNS Resolution and non-HTTP URL handling.
However, handling non-3GPP URLs in common devices is not broadly supported by
commonly available high-level UE Operating Systems and HTTP-based URL handling
is preferred. Of the candidate solutions studied in clause 5.13.5, Solution 1
(clause 5.13.5.1), namely creating an HTTP(S) URL that is 3GPP-owned, is
preferred.
Based on this conclusion, it is proposed to:
\- Extend the baseline 5G Media Streaming architecture to add a 3GPP Service
and URL Handler in the UE and the network according to figure 5.13.3-1.
\- Address provisioning, message exchange and call flows in order to support
different use cases, namely the case for which the URL is resolved in the
network, the URL is resolved in the UE, and the case for which the URL is
resolved in a combination of network and UE as discussed in clause 5.13.3.
\- Specify a concrete URL format for 3GPP services with individual host names
registered in the 3GPP-managed domain launch.3gppservices.org as part of 3GPP
specifications, and ensure that this can be used in the context of 3GPP-based
services, namely:
\- Specify a suitable website redirection mechanism in case a suitable 3GPP
Service Handler is not already installed on the device to handle the URL.
The URL itself needs to be sufficiently unambiguous to resolve to the service
entry point URL and may embed the service entry point URL as well.
\- Specify 3GPP Service URL instantiations with parameters suitable for
launching at least the Media Session Handler for 5G Media Streaming, MBMS
Client (including Receive-Only Mode services) and MBS Client.
\- Provide the ability for a 5GMS-Aware Application to create a Service URL in
order to bootstrap 5G Media Streaming.
\- Investigate and study the application of 3GPP services and URL handling
beyond 5G Media Streaming.
\- Specify an external service identifier assigned by the 5GMS Application
Provider that can be used to launch 5G Media Streaming sessions on different
5GMS Systems via a common 3GPP Service URL.
\- Modify the Provisioning Session resource to include one (or more) of these
identifiers.
\- Modify the Service Access Information API to accept this instead of a
Provisioning Session identifier.
\- Specify a default 5GMS AF host name to be used by the Media Session Handler
when the 3GPP Service URL does not specify one.
## 5.14 5GMS Application Server configuration and management
### 5.14.1 Description
#### 5.14.1.1 5GMS AS configuration
The general architecture for 5G Media Streaming illustrated in figure 4.2‑1 of
TS 26.501 [15] specifies M3 as a reference point between the 5GMS Application
Function and the 5GMS Application Server.
In the case of downlink media streaming, clause 4.2.1 of [15] specifies that
reference point M3d is for internal interactions between these system actors
for the purposes of configuring the content hosting feature for 5G Media
Streaming:
* * *
\- M3d: (Internal and NOT SPECIFIED): Internal API used to exchange
information for content hosting on a 5GMSd AS within the trusted DN.
* * *
Furthermore, clause 9 of TS 26 512 [16] does not specify procedures at
reference point M3:
* * *
APIs of this reference point are not specified within this release.
* * *
Because there is no interface standardised at reference point M3 in the
current release, a 5G System operator must follow one of the following courses
to deploy a 5GMS System:
1\. Deploy compatible 5GMS AS and 5GMS AF instances with a proprietary
configuration interface at reference point M3.
\- Achieving this aim may necessitate procurement of both functions from the
same vendor.
2\. Implement a proprietary configuration interface at reference point M3
between incompatible 5GMS AS and 5GMS AF instances as a system integration
exercise.
Both approaches are unattractive to a 5G System operator for different and
obvious reasons. From this, it may be inferred that deployment of the 5GMS
architecture is hampered by the lack of standardisation at reference point M3.
#### 5.14.1.2 5GMS AS management
In a deployment of the 5G Media Streaming architecture (a so-called \"5GMS
System\") a 5GMS AF manages a set of one or more 5GMS AS instances that
collectively deliver the required content hosting services for downlink media
streaming and/or content publishing services for uplink media streaming.
In order to deliver the required service levels, the 5GMS AF needs to know:
1\. Whether each 5GMS AS instance under its management is currently operating
correctly.
\- If not, the 5GMS AF may need to start a new 5GMS AS instance to replace the
one that is no longer operating.
2\. Whether each 5GMS AS instance under its management is currently operating
comfortably within the envelope of its system capabilities.
\- If the 5GMS AS instance in question is overloaded, the 5GMS AF may need to
start an additional 5GMS AS instance in order to satisfy the committed service
levels.
\- If the population of 5GMS AS instances has slack capacity, the 5GMS AF may
shut down one or more 5GMS AS instances in order to avoid wasting system
resources.
In the present release, the 5GMS AF does not have standardised access to
health and load information about the set of 5GMS AS instances under its
management via reference point M3 unless the 5GMS AS is deployed as an Edge
Application Server (EAS). From this, it may be inferred that non-edge
deployments of the 5GMS architecture are hampered by the lack of
standardisation at reference point M3.
### 5.14.2 Deployment architectures
Especially in the case where the 5GMS AS is deployed as a set of Edge
Application Server instances, but also in the general case where the 5GMS AS
is realised using multiple physical server devices, there may be a large set
of 5GMS AS instances to be configured and managed by the 5GMS AF. It is the
responsibility of the 5GMS AF to determine which Content Hosting
Configurations and/or Content Publishing Configurations to deploy on each 5GMS
AS instance in order to balance the load of downlink and/or uplink media
streaming appropriately between them to achieve the agreed service levels.
It is especially important in a mixed deployment of the 5GMS System that a
5GMS AF from one vendor can configure and manage a 5GMS AS instance from a
different vendor in an interoperable manner. For this reason:
1\. It is considered desirable to standardise the configuration of the 5GMS AS
at reference point M3.
2: It is considered desirable to standardise a management interface that
enables a 5GMS AF to monitor the status of the estate of 5GMS AS instances it
is responsible for. This may be further generalised to a management interface
that enables any Application Function to monitor the status of the estate of
Application Server instances it is responsible for.
NOTE: This Key Issues does not address the topic of dynamic operational
traffic migration between 5GMS AS instances.
### 5.14.3 Collaboration scenarios
Figure 5.14.3‑1 shows the collaboration between a 5GMS AF and a 5GMS AS it is
managing. TS 26.501 [15] designates the reference point between these two
logical entities as M3.
Figure 5.14.3‑1: Collaboration between 5GMS AF and 5GMS AS under its
management
Generalising this collaboration, any Application Function in the 5G System may
be managing an Application Server instance. This generalised collaboration is
depicted in figure 5.14.3‑2:
Figure 5.14.3‑2: Generalised collaboration between any AF and an AS under its
management
The relationship between an Application Function and an Application Server
instance it is managing is somewhat similar to the relationship between the
NRF and an Application Function instance it is managing. As defined in clause
5.2.7.2 of TS 23.502 [24], the NRF exposes an _Nnrf_AFManagement_ service that
allows an Application Function instance to register its profile with the NRF
and subsequently to report regular heartbeats, including an indication of
current Application Function load.
Figure 5.14.3‑3: Service-Based interfaces for AS and AF management
Using this architectural template, an AS management service interface can be
imagined between the AS and the AF, referred to in the above figure as
_Naf_ASManagement_.
Figure 5.14.3‑4 illustrates the subcase where an AS is deployed as an Edge
Application Server (EAS). When it starts up, the EAS instance registers itself
with an Edge Enabler Service (EES) using the _Eees_EASRegistration_ procedure
at reference point EDGE‑3, as defined in clauses 6.5.4 and 8.4.3 of TS 23.558
[47].
Figure 5.14.3‑4: Architectural arrangement for EAS registration with EES
The purpose of this registration is to populate an entry in an EAS instance
catalogue maintained by the EES to assist in later discovery of appropriate
EAS instances by Application Clients. To this end, the EAS provides at the
time of registration an EAS Profile (see clause 8.2.4 of [47]) describing its
capabilities, as well as availability information such as time and location
constraints.
The stage 2 definition of the EAS Profile in table 8.2.4‑1 of [47] describes
the concept of an _availability reporting period_ property. Based on this
property definition, it may be inferred that the EES should periodically check
the availability of the EAS instance after successful registration.
NOTE: In this release, the availability reporting procedure is not further
elaborated in TS 23.558 [47], nor does TS 29.558 [102] specify a stage 3
service operation to realise it.
### 5.14.4 Mapping to 5G Media Streaming and high-level call flows
#### 5.14.4.1 Configuration of 5GMSd AS
Figure 5.14.4.1‑1 shows the high-level call flow for configuring the 5GMSd AS
in response to provisioning of the content hosting features in the 5GMSd AF.
Figure 5.14.4.1‑1: High-level call flow for configuration of 5GMS AS by 5GMSd
AF
The steps in this call flow are summarised as follows, with variations from TS
26.501 [15] highlighted in **bold** :
1\. The 5GMSd Application Provider creates an umbrella Provisioning Session by
invoking the appropriate operation at reference point M1d. The 5GMSd AF
allocates a Provisioning Session Identifier and a canonical 5GMSd AS host name
for the Provisioning Session and includes these values in the resource
representation it returns to the 5GMSd Application Provider.
2\. In the case where HTTPS-based content distribution is desired at reference
point M4d, the 5GMSd Application Provider optionally creates server
certificate subresources under the Provisioning Session umbrella resource
created in step 1 by invoking the appropriate operation at reference point
M1d.
3\. In the case where processing of content is required in the 5GMSd AS
between content ingest at reference point M2d and content distribution at
reference point M4d, the 5GMSd Application Provider optionally creates Content
Preparation Template subresources under the Provisioning Session umbrella
resource created in step 1 by invoking the appropriate operation at reference
point M1d.
4\. The 5GMSd Application Provider provisions the content hosting feature by
invoking the appropriate operation at reference point M1d. A Content Hosting
Configuration subresource is created under the Provisioning Session umbrella
resource created in step 1. This may reference server certificates provisioned
in step 2 and/or Content Preparation Templates provisioned in step 3.
As a direct result of step 4:
**5\. The 5GMSd AF configures in some or all of the 5GMSd AS instance(s) under
its management any server certificates referenced by the new Content Hosting
Configuration provisioned in step 4 that are not already configured.**
**6\. The 5GMSd AF configures in some or all of the 5GMSd AS instance(s) under
its management the Content Preparation Templates referenced by the new Content
Hosting Configuration provisioned in step 4.**
**7\. The 5GMSd AF configures in some or all of the 5GMSd AS instance(s) under
its management the Content Hosting Configuration provisioned in step 4. This
may reference server certificates provisioned in step 5 and/or Content
Preparation Templates provisioned in step 6.**
Finally:
8\. The 5GMSd AF responds to the 5GMSd Application Provider at reference point
M1d indicating whether the operation at step 4 was successful or not.
#### 5.14.4.2 Configuration of 5GMSu AS
Figure 5.14.4.2‑1 shows the high-level call flow for configuring the 5GMSu AS
in response to provisioning of the content publishing features in the 5GMSu
AF.
Figure 5.14.4.2‑1: High-level call flow for configuration of 5GMSu AS by 5GMSu
AF
The steps in this call flow are summarised as follows, with variations from TS
26.501 [15] highlighted in **bold** :
1\. The 5GMSu Application Provider creates an umbrella Provisioning Session by
invoking the appropriate operation at reference point M1u. The 5GMSu AF
allocates a Provisioning Session Identifier and a canonical 5GMSu AS host name
for the Provisioning Session and includes these values in the resource
representation it returns to the 5GMSu Application Provider.
2\. In the case where HTTPS-based content contribution is desired at reference
point M4u, the 5GMSu Application Provider optionally creates server
certificate subresources under the Provisioning Session umbrella resource
created in step 1 by invoking the appropriate operation at reference point
M1u.
3\. In the case where processing of content is required in the 5GMSu AS
between content ingest at reference point M4u and content egest at reference
point M2u, the 5GMSu Application Provider optionally creates Content
Preparation Template subresources under the Provisioning Session umbrella
resource created in step 1 by invoking the appropriate operation at reference
point M1u.
4\. The 5GMSu Application Provider provisions the content publishing feature
by invoking the appropriate operation at reference point M1u. A Content
Publishing Configuration subresource is created under the Provisioning Session
umbrella resource created in step 1. This may reference server certificates
provisioned in step 2 and/or Content Preparation Templates provisioned in step
3.
As a direct result of step 4:
**5\. The 5GMSu AF configures in some or all of the 5GMSu AS instance(s) under
its management any server certificates referenced by the new Content
Publishing Configuration provisioned in step 4 that are not already
configured.**
**6\. The 5GMSu AF configures in some or all of the 5GMSu AS instance(s) under
its management the Content Preparation Templates referenced by the new Content
Publishing Configuration provisioned in step 4.**
**7\. The 5GMSu AF configures in some or all of the 5GMSu AS instance(s) under
its management the Content Publishing Configuration provisioned in step 4.
This may reference server certificates provisioned in step 5 and/or Content
Preparation Templates provisioned in step 6.**
Finally:
8\. The 5GMSu AF responds to the 5GMSu Application Provider at reference point
M1u indicating whether the operation at step 4 was successful or not.
#### 5.14.4.3 Management of 5GMS AS
Figure 5.14.4.3‑1 below shows the call flow for management of a 5GMS AS by a
5GMS AF.
Figure 5.14.4.3‑1: Call flow for management of a 5GMS AS by a 5GMS AF
NOTE 1: The management of a 5GMSu AS instance by the 5GMSu AF are identical to
the management of a 5GMSd AS instance by the 5GMSd AF.
NOTE 2: The call flows below may be generalised to apply to the management of
an Application Server by any Application Function.
The steps are as follows:
1\. A new 5GMS AS instance is spawned by the 5GMS AF. The identity of the
managing 5GMS AF instance is passed to the 5GMS AS as a start-up parameter.
NOTE: For the sake of simplicity, the managing 5GMS AF instance is the same as
that which spawns the 5GMS AS instance in the figure. This need not
necessarily be the case.
2\. The 5GMS AS instance registers with its managing 5GMS AF by invoking the
_Naf_ASManagement_‌AFRegister_ service operation on it.
3\. The 5GMS AS instance may register to receive status update notifications
from its managing 5GMS AF by invoking the
_Naf_ASManagement_‌AFStatusSubscribe_ service operation on it.
Operation of the 5GMS AS proceeds with the following two steps occurring
asynchronously in parallel:
4\. The 5GMS AS instance periodically sends heartbeat messages to its managing
5GMS AF by invoking the _Naf_ASManagement_‌AFUpdate_ service operation on it.
The heartbeat message includes information about the current 5GMS AS load.
5\. The managing 5GMS AF periodically sends status notifications to all 5GMS
AS instances that subscribed to these notifications in step 3 above by
invoking the _Naf_ASManagement_‌AFStatusNotify_ service operation on them.
This may, for example, notify subscribers that another 5GMS AS instance
managed by the same 5GMS AF instance has registered, deregistered or sent a
heartbeat.
Finally:
6\. At some later point in time, the 5GMS AF decides to destroy the 5GMS AS
instance.
NOTE: For the sake of simplicity, the managing 5GMS AF instance is the same as
that which destroys the 5GMS AS instance in the figure. This need not
necessarily be the case.
7\. If it registered to receive status notifications in step 3, the 5GMS AS
instance cancels its subscription by invoking the
_Naf_ASManagement_‌AFStatusUnsubscribe_ service operation on its managing 5GMS
AF.
8\. The 5GMS AS instance deregisters from its managing 5GMS AF by invoking the
_Naf_ASManagement_‌AFStatusUnsubscribe_ service operation on it.
### 5.14.5 Potential open issues
While the value of Application Server registration and heartbeats at reference
point M3 is plain, the utility of subscribe--notify operations is less clear.
The call flow documented in clause 5.14.4.3 above (where a 5GMS AS instance
periodically reports its health and current load to its managing 5GMS AF)
mimics the design of an AF reporting its health and load to the NRF, as
introduced in clause 5.14.3. An alternative approach would be to align with
the design pattern of the Edge Application architecture defined in TS 23.558
[47] by specifying that a 5GMS AF is responsible for periodically checking the
availability of the 5GMS AS instances it is managing. Both alternative design
patterns are represented in the 5G System specifications and there are no
clear arguments in favour of one approach over the other. However, the lack of
a concrete specification of this availably checking procedure in TS 29.558
[102] tends to favour the more complete NRF approach defined in clause 5.2.7.2
of TS 23.502 [24] over that of the Edge Application Architecture.
The topic of traffic migration between 5GMS AS instances cuts across this Key
Issue, as well as that of the Edge Application Architecture. It is suggested
that this topic is the subject of future study.
### 5.14.6 Candidate solutions
#### 5.14.6.1 Configuration of 5GMS AS
A candidate design of the M3 Application Server configuration API based on the
call flows documented in clause 5.14.4.1 and 5.14.4.2 is summarised in figure
5.14.6.1‑1 below:
Figure 5.14.6.1‑1: Candidate design of M3 configuration AP
The proposed applicability of the M3 API operations is summarised in table
5.14.6.1‑1 below:
Table 5.14.6.1‑1: Applicability of M3 API operations
API name Operation Applicability
* * *
_M3_ServerCertificatesProvisioing_ _createServerCertificate_ Downlink, uplink
_destroyServerCertificate_  
_M3_ContentPreparationProvisioning_ _createContentPreparationTemplate_
Downlink, uplink _updateContentPreparationTemplate_  
_destroyContentPreparationTemplate_  
_M3_ContentHostingConfiguration_ _createContentHostingConfiguration_ Downlink
_updateContentHostingConfiguration_  
_destroyContentHostingConfiguration_  
_M3_ContentPublishingConfiguration_ _createContentPublishingConfiguration_
Uplink _updateContentPublishingConfiguration_  
_destroyContentPublishingConfiguration_
#### 5.14.6.2 Management of AS
A candidate design of the _Naf_ASManagement_ service offered by the AF to AS
instances and based on the call flow documented in clause 5.14.4.3 is
summarised in figure 5.14.6.2‑1 below:
Figure 5.14.6‑1: Candidate design of the Naf_ASManagement service\ and direct
comparison with the existing Nnrf_AFManagement service
The proposed applicability of the _Naf_ASManagement_ service operations is
summarised in table 5.14.6.2‑1 below:
Table 5.14.6.2‑1: Applicability of M3 API operations
API name Operation Invoker(s)
* * *
_Naf_ASManagement_ _ASRegister_ AS _ASUpdate_  
_ASDeregister_  
_ASStatusSubscribe_  
_ASStatusUnsubscribe_  
_ASNotify_ Any AF
### 5.14.7 Conclusion and recommendations
The case for standardising the configuration of 5GMS AS instances by the 5GMS
AF at reference point M3 is made in clauses 5.14.1.1 and 5.14.2. Relevant
collaboration scenarios are documented in clause 5.14.3 and an illustrative
mapping to call flows for both downlink media streaming (clause 5.14.4.1) and
uplink media streaming (clause 5.14.4.2) are provided. A candidate M3
Application Server configuration API based on these calls flows is proposed in
clause 5.14.6.1.
It is recommended:
1\. To pursue standardisation of 5GMS AS configuration at reference point M3
as an extension to TS 26.501 [15] and TS 26.512 [16] based on the design
proposed in clause 5.14.6.1.
The case for standardising the management of 5GMS AS instances by the 55GMS AF
at reference point M3 is made in clauses 5.14.1.2 and 5.14.2. Relevant
collaboration scenarios are documented in clause 5.14.3, including a
generalisation of this concept to any kind of Application Server managed by
any Application Function. An illustrative generic high-level call flow is
provided in clause 5.14.4.3. A candidate _Naf_ASManagement_ service API based
on this call flow is proposed in clause 5.14.6.2.
It is recommended:
2\. To pursue standardisation of a generic AS management service for use at
any reference point between an AS instance and its managing AF (including
reference point M3) in liaison with SA2, based on the design proposed in
clause 5.14.6.2.
3\. To reference the registration and heartbeat procedures of this generic AS
management service in the high-level call flows defined in TS 26.501 [15].
# 6 Conclusions
## 6.1 List of Conclusions
Table 6.1-1 points to conclusions and next steps for each of the key issues
studied in the present document.
Table 6.1-1: Index of Key Issues, Conclusions, and Next Steps
Key Issue Conclusions and Next Steps clause
* * *
Key Issue #1: Content Preparation 5.2.9 Key Issue #2: Traffic identification
5.3.7 Key Issue #3: Additional/new transport protocols 5.4.7 Key Issue #4:
Uplink Media Streaming 5.5.7 Key Issue #5: Background Traffic 5.6.7 Key Issue
#6: Content-Aware Streaming --- Key Issue #7: Network Event usage 5.8.5 Key
Issue #8: Per-application authorization 5.9.7 Key Issue #9: Support for
encrypted and high-value content --- Key Issue #10: TV-grade mass distribution
of unicast Live Services 5.11.7 Key Issue #11: Network Slicing Extensions for
5G Media Streaming 5.12.7 Key Issue #12: 3GPP Service Handler and URLs 5.13.7
Key Issue #13: 5GMS Application Server configuration and management 5.14.7
## 6.2 Content preparation
The study of this key issue demonstrates that the use of the Content
Preparation Template is not explained adequately in TS 26.501 Release 16.
Furthermore, TS 26.512 needs several extensions to make the use of the Content
Preparation Template interoperable in the 5GMS architecture.
The following extensions are recommended:
\- Inclusion of content preparation deployment scenarios and associated call
flows in Stage 2.
\- Extending the Content Preparation Templates Provisioning API and defining
the 5GMS AF/AS requirements needed for the deployment scenarios identified in
the study in Stage 3.
## 6.3 Traffic **i** dentification
The 5G System offers different solutions for traffic identification and
traffic detection. Traffic identification is essential so that the 5G System
can detect application flows to which, for instance, an appropriate Policy and
Charging Rule (PCC) is applied.
It is recommended to study use-cases with IPsec and the usage of the security
parameter index for traffic identification further in a subsequent study.
Existing stage 2 procedures already support the use of different traffic
identification mechanisms.
The following extensions are recommended for stage 3:
\- Extensions to the M5 API to support the configuration of ToS values for the
identification of traffic associated with a Dynamic Policy.
\- Describe the usage of usage of ToS/DSCP for traffic identification within
an informative annex.
## 6.4 Additional/new transport protocols
The latest version of HTTP, HTTP/3, [5] can be used for at least some types of
media immediately, but some existing 3GPP Stage 3 specifications are
explicitly tied to specific versions of HTTP and need to be updated to allow
HTTP/3 as a supported version, in order to allow deployment of this new
protocol.
HTTP/3 is defined in the IETF and has been completed in the QUIC working group
and approved for publication as an RFC but has not been published yet because
of a normative dependency on other documents. The HTTP/3 document is stable
(has not changed since February 2021)
When HTTP is used in 5GMS applications, it is often used with application-
level protocols such as DASH or HLS that are defined (partially) outside of
3GPP. Some usages in 5GMS will depend on support for HTTP/3 in these
application-level protocols.
The following actions are recommended:
\- Update 5GMS stage 3 specifications to allow the use of HTTP/3 at relevant
reference points in the 5GMS architecture, to allow early deployment and to
identify any unforeseen open issues with using HTTP/3 in a 5G System.
\- At this time, support for HTTP/3 in 5GMS specifications, can be allowed,
but not required.
## 6.5 Uplink media streaming
The study of this key issue demonstrates that uplink streaming is severely
underspecified in TS 26.501 and TS 26.512 in Release 16, and several gaps are
identified.
The following extensions are recommended:
1\. Inclusion of collaboration scenarios and associated call flows in Stage 2.
2\. Specification of egest protocol(s), Content Publishing Configuration APIs
and a corresponding Content Publishing Configuration resource, and the UE's
uplink streaming entry point in Stage 3.
## 6.6 Background traffic
Background Data Transfer (BDT) offers Mobile Network Operators (MNOs) and
application service providers a tool to deliver content opportunistically at
beneficial costs during low traffic time windows. The usage of BDT for media
streaming services and potential enhancements to the 5GMS procedures and APIs
have been studied and documented in the present document.
Existing stage 2 procedures already support the use of BDT. It is recommended
to define the necessary parameter extensions to the M1, M5, and M6 reference
points to provide access to BDT. Any normative work has to take into account
the available BDT procedures developed by other 3GPP groups.
## 6.7 Content-aware streaming
No conclusion has yet been reached for this key issue.
Initial considerations are provided in clause 5.7. It is recommended to study
it further at an appropriate time.
## 6.8 Network Event usage
The 5GMS AF performs several critical support operations for media streaming
sessions and collects information about the progress and status of media
streaming sessions. This information can be of interest to the 5GMS
Application Provider or to other Network Functions in the 5G Sytem.
The following extensions (Stage 2 and Stage 3) are recommended:
\- Identify and define the media-related data to be exposed by the 5GMS AF
towards the 5G System and other event consumer entities. Work with other 3GPP
groups for carriage in existing AF events or the definition of new AF Events.
\- Enhance the 5GMS AF data collection to support direct and indirect
collection of UE data pertaining to media sessions.
\- Devise mechanisms to control the access to the collected media session
data.
\- Define a generic architecture within which media-specific solutions for the
configuration and subsequent operation of data collection and data reporting
(via event exposure) by the AF can be specified.
## 6.9 Per-application-authorization
The 5G Media Streaming Architecture enables a 5GMS-Aware Application to access
certain network features, in alignment with the 5GMS Application Provider. The
Key Issue explores the usage of OAuth 2.0 for per-application authorization of
different 5G System features, for example to prevent misuse. The Key Issue
specifically addresses use-cases, when a UE hosts multiple 5GMS-Aware
Applications from different 5GMS Application Providers.
It is recommended to specify the usage of OAuth 2.0 (according to the SA3
guidelines) within a normative work item.
## 6.10 Support for encrypted and high-value content
No conclusion has yet been reached for this key issue.
Initial considerations are provided in clause 5.10. It is recommended to study
it further at an appropriate time.
## 6.11 TV-grade mass distribution of unicast Live Services
Live TV services of different scale (professional, user-generated, session-
based, etc.) are increasingly distributed over broadband and mobile networks,
including 5G Networks. Live TV services are characterized by at least the
following aspects: (1) scalability (in terms of concurrent users), (2)
consistent quality, (3) high bandwidth requirements, (4) target latency
constraints, and advanced TV Experiences.
To address these type services a consistent support in the 5G Media Streaming
Architecture, the protocols and codecs is needed. It is identified that the
combination of low-latency CMAF formats, chunked transfer from content
provider to the device, as well as consistent signaling and support of service
quality are key aspects to the work.
Based on the discussion and conclusions in clause 5.11.7, it is recommended to
support and optimize the deployment of unicast live TV services in 5G Systems.
For this purpose, the following follow-up aspects are recommended to be
addressed:
1\. Integrate into TS 26.501 (Stage 2)
a) At least one call flow into that documents provisioning, ingest,
distribution, presentation and monitoring aspects of low-latency live
streaming services using CMAF Chunks.
b) Updates to reference points to support provisioning, ingest, distribution,
presentation and monitoring aspects of low-latency live services using CMAF
Chunks.
c) Typical configurable service parameters and operation points in terms of
bit rates, latencies, Audience Drift Gaps, etc.
2\. Address updates to relevant stage-3 specifications (e.g., TS 26.511, TS
26.512, TS 26.247) to add consistent support of low-latency live streaming
services, including:
a) Define capability mechanisms in order to identify the support of low-
latency modes in 5GMS networks and clients.
b) Provisioning to support operation points and policy templates for low-
latency live streaming.
c) Create necessary extensions to support DASH and HLS chunked CMAF low-
latency modes in an end-to-end workflow.
d) Provide necessary protocols to scalably support time synchronization across
5GMS Applications, AS and 5GMS Clients (at appropriate precision).
e) Extend QoE metrics schemes and metrics reporting functionality to address
monitoring of Operation Point metrics for potential operational improvements.
f) Provide extensions to formats and manifests support advanced TV
experiences.
g) Informative guidelines on using different Operation Points for low-latency
live streaming.
3\. Study even lower-latency streaming technologies based on the use cases and
considerations of the DASH-IF webRTC streaming report [94].
## 6.12 Network Slicing Extensions for 5G Media Streaming
**As described in TS 28.530,** network slicing is a paradigm where logical
networks/partitions are created, with appropriate isolation, resources and
optimized topology to serve a purpose or service category (e.g. use
case/traffic category, or for MNO-internal reasons) or customers (logical
system created \"on demand\"). Media services can be delivered to end users
using such different network slices. **As documented in clause 5.12 of the
present document, aspects related to network slicing are not adequately
addressed in TS 26.501 and 26.512. The following are the conclusions so far in
the study:**
1\. The collaboration scenarios, deployment architectures, and potential open
issues concerning network slicing extensions are to be studied further in
Release 18.
2\. The impact of network slicing is across multiple work items. Therefore,
study for network slicing extensions is to be looked at from the perspective
of multiple work items.
## 6.13 3GPP Service Handler and URLs
Until now, 3GPP specifications for 5G Media Streaming have avoided addressing
the detailed question of how to bootstrap 3GPP-defined UE and network
functions such as the Media Session Handler or the MBMS/MBS Client. This is
deferred to implementation, device pre-configuration, and so on. However, the
lack of specification covering this Key Issue is hindering adoption of 5GS-
supported media services because today UE applications may have to be modified
in order to support such services.
3GPP defines the ability to use DNS Resolution and non-HTTP URL handling.
However, handling non-3GPP URLs in common devices is not broadly supported by
commonly available high-level UE Operating Systems and HTTP-based URL handling
is preferred. Of the candidate solutions studied in clause 5.13.5, Solution 1
(clause 5.13.5.1), namely creating an HTTP(S) URL that is 3GPP-owned, is
preferred.
Based on this conclusion, it is proposed to:
1\. Extend the baseline 5G Media Streaming architecture to add a 3GPP Service
and URL Handler in the UE and the network according to figure 5.13.5-1.
2\. Address provisioning, message exchange and call flows in order to support
different use cases, namely the case for which the URL is resolved in the
network, the URL is resolved in the UE, and the case for which the URL is
resolved in a combination of network and UE as discussed in clause 5.13.5.
3\. Specify a concrete URL format for 3GPP services with individual host names
assigned in the 3GPP-managed domain launch.3gppservices.org as part of 3GPP
specifications, and ensure that this can be used in the context of 3GPP-based
services, namely:
a) Void.
b) Specify a suitable website redirection mechanism in case a suitable 3GPP
Service Handler is not already installed on the UE.
4\. The URL itself needs to be sufficiently unambiguous to resolve to the
service entry point URL and may embed the service entry point URL as well.
5\. Specify 3GPP Service URL instantiations with parameters suitable for
launching at least the Media Session Handler for 5G Media Streaming, MBMS
Client (including Receive-Only Mode services) and MBS Client.
6\. Provide the ability for a 5GMS-Aware application to create a Service URL
in order to bootstrap 5G Media Streaming.
7\. Investigate and study the application of 3GPP services and URL handling
beyond 5G Media Streaming.
8 Specify an external service identifier assigned by the 5GMS Application
Provider that can be used to launch 5G Media Streaming sessions on different
5GMS Systems via a common 3GPP Service URL.
\- Modify the Provisioning Session resource to include one (or more) of these
identifiers.
\- Modify the Service Access Information API to accept this instead of a
Provisioning Session identifier.
9\. Specify a default 5GMS AF host name to be used by the Media Session
Handler when the 3GPP Service URL does not specify one.
## 6.14 5GMS Application Server configuration and management
**The 5G Media Streaming architecture in TS 26.501 [15] defines a reference
point between the 5GMS AF and the 5GMS AS but does not further define its
purpose and procedures in the present release. This hampers interoperability
between 5GMS AS instances procured from different vendors and the 5GMS AF that
manages them which, in turn, acts as a barrier to the adoption and deployment
of the 5GMS System by network operators.**
**The study of this Key Issue recommends:**
1\. Extending the 5GMS System to standardise the interface used by the 5GMS AF
to configure 5GMS AS instances.
a) Define high-level procedures and call flows at reference point M3 in TS
26.501 [15] in line with the conclusions of the Key Issue.
b) Specify detailed procedures and a RESTful API at reference point M3 in TS
26.512 [16] in line with the conclusions of the Key Issue.
2\. Extending the 5G System to standardise a generic interface to be used by
an Application Function to manage Application Server instances.
a) Define high-level procedures and call flows in line with the conclusions of
the Key Issue in a new Technical Specification. The high-level design and work
split to be discussed with SA2. This new specification to be referenced by
existing high-level procedures and call flows for 5G Media Streaming in TS
26.501 [15] in the context of reference point M3.
b) Specify detailed procedures and protocols in line with the conclusions of
the Key Issue in a new Technical Specification. The detailed design and work
split to be discussed with SA2 and/or CT3.
# 7 Recommendations
5G Media Streaming provides significant opportunities to integrate operator
and third-party media streaming services into 5G Systems. The report provides
at set of considered extensions to 5G Media Streaming as defined in TS 26.501,
as well as the format and protocol specifications in TS 26.511 and TS 26.512,
respectively. Advances in 5G System technologies, external enhancement and
developments in other SDOs such as IETF, DASH-IF or MPEG, as well as initial
experiences from deployments have led to a set of conclusions in clause 6.
Based on the details in the report, the following next steps are proposed.
1\. Initiate stage 2 and stage 3 work on Network Event usage based on the
conclusions in clause 6.8. Note that this is already addressed in TS 26.531
[94] and TS 26.532 [95], respectively.
2\. Provide relevant extensions to the Stage 2 5G Media Streaming architecture
defined in TS 26.501 [15] based on the conclusions in clause 6. Candidates for
these extensions are:
a) Content preparation deployment scenarios and associated call flows in Stage
2 according to clause 6.2.
b) Inclusion of collaboration scenarios and associated call flows in Stage 2
for uplink media streaming according to clause 6.5.
c) Inclusion and extensions of procedures and call flows for end-to-end low
latency live streaming based on the conclusions in clause 6.11.
d) Extend the baseline 5G Media Streaming architecture to add a 3GPP Service
and URL Handler in the UE and the network based on the conclusions in clause
6.13.
e) Inclusion of collaboration scenarios and associated call flows for
configuration of 5GMS AS instances at reference point M3, based on the
conclusions in clause 6.14.
f) Referencing of generic procedures and call flows for the management of AS
instances in the context of the 5GMS architecture at reference point M3, based
on the conclusions in clause 6.14.
3\. Provide relevant extensions to 5G Media Streaming protocols and formats
based on the conclusions in clause 6. Candidates for these extensions are:
a) Stage-3 follow-up work from 5G Media Streaming architecture extensions
referred to above based on conclusions in clauses 6.2, 6.5, or 6.11.
b) Extensions to 5GMS protocols to support traffic identification based on the
conclusions in clause 6.3
c) Addition of HTTP/3 to the 5GMS protocols as an optional alternative based
on the conclusions in clause 6.4.
d) Addition of necessary parameter extensions to the M1, M5, and M6 reference
points to provide access to Background Data Transfer based on the conclusions
in clause 6.6.
e) Specification of the usage of OAuth 2.0 (according to the SA3 guidelines)
for 5GMS protocols based on the conclusions in clause 6.9.
f) Specifications for the 3GPP Service Handler and 3GPP Service URL including
the necessary UE functions to support automatic launch of 5G System services
in the context of 5G Media Streaming based on the conclusions in clause 6.13.
g) Specification of a RESTful API for configuration of the 5GMS AS via
reference point M3 in TS 26.512 [16] based on the conclusions of clause 6.14.
4\. Continue the study of additional extensions to 5G Media Streaming.
Potential candidate topics based on this Technical Report are:
a) Content-aware streaming based on the initial considerations in clause 5.7.
b) Study even lower-latency streaming technologies based on the use cases and
considerations of the DASH-IF WebRTC streaming report [94].
c) Distribution of encrypted and high-value content based on the
considerations in clause 5.10.
d) Network slicing extensions for 5G Media Streaming based on the conclusions
in clause 6.12.
e) Investigate and study the application of 3GPP services and URL handling
beyond 5G Media Streaming based on the conclusions in 6.13.
5\. Liaise with SA2 and other relevant groups on the standardisation of a
generic Application Server management service based on the conclusions of
clause 6.14.
All work topics will benefit from continuously checking relevance and support
across 3GPP members. In addition, close coordination with other groups in 3GPP
on 5G System and radio-related matters, edge computing, applications,
operational management and security as well, in communication with experts in
MPEG, DASH-IF, CTA WAVE on DASH, HLS and CMAF, as well as with IETF on new
protocols.
###### ## Annex A: Media Streaming Protocols
# A.1 Status and usage of Web protocols
The site HTTPArchive.org [x1] offers some insights into the uptake of
different HTTP protocol versions by publicly accessible websites. The Report
"State of the Web" contains statistics about the number of TCP connections per
page and the number of HTTP/2 requests over a time period. The site crawls
millions of URLs every month. The URLs are taken from the Chrome User
Experience Report.
Currently, around 70% of websites support HTTP/2. Unfortunately, the site does
not show statistics for video usage.
The site quic.netray.io [x2] offers some insights into the HTTP/3 (QUIC) take-
up.
## A.1.1 M4d protocol usage
It is anticipated that MPEG‑DASH would be used by many Application Providers
on the M4d Interface if 5GMS services become widely deployed. MPEG‑DASH
defines the manifest format and also the media segment format. MPEG‑DASH
allows several different ways to use the underlying HTTP transport, depending
on the DASH Profile.
For traffic identification, the identification of the transport protocol (TCP
or UDP) used on interface M4d is essential, since the transport protocol needs
to be described in the Service Data Flow Template. HTTP/1.1 and HTTP/2 both
use TCP transport. HTTP/3 uses a UDP-based QUIC transport. Furthermore,
HTTP/1.1. often leverages multiple TCP connections simultaneously, while
HTTP/2 and HTTP/3 allow more efficient reuse of the transport through the
technique of non-blocking request multiplexing on a single transport
connection.
## A.1.2 Results of HTTP protocol version usage study
Editor's Note: It is currently unclear how to document the results of the
transport connection usage study. It is clear, this this represents only a
small snapshot on how the different HTTP versions are used and currently only
focused on browser based clients.
Within a small study, the transport protocol usage of three major video-on-
demand providers were studied, namely YouTube, Netflix and Amazon. The study
leveraged browser-based DASH players, using the popular web browsers Google
Chrome (version 87.0.4280.141, 64-bit running on Win 10 Pro Version 2004 b
19041.746) and Mozilla Firefox (version 84.0.2, 64-bit running on Win 10 Pro
Version 2004 b 19041.746). The intention was to get more insights into HTTP
usage.
a) Accessing YouTube with Chrome, we found that YouTube in a Chrome Browser
uses MPEG‑DASH with HTTP/3 transport. Several YouTube clips were selected, and
HTTP/3 was consistently used for retrieving both media segments and other
content. Detailed investigations showed that only a single HTTP/3 connection
was established to the server.
b) Accessing Amazon Prime with Chrome, we found that Amazon Prime uses
MPEG‑DASH. For some movies, HTTP/2 is used for all content (including media
segments). Some other movies used HTTP/1.1 for media segments and HTTP/2 for
non-media segments. It is not clear on which basis the application protocol is
selected.
c) Accessing Netflix with Firefox, we found that Netflix uses MPEG‑DASH with
HTTP/1.1. Some objects, such as images, are fetched using HTTP/2.
d) Accessing YouTube with Firefox, we found that YouTube uses MPEG‑DASH with
HTTP/1.1. Non-video transactions use HTTP/2.
#