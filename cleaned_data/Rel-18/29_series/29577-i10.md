# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies the stage 3 protocol and data model for the
Nipsmgw and Nrouter Service Based Interface. It provides stage 3 protocol
definitions and message flows, and specifies the API for each service offered
by the IP-SM-GW and SMS Router.
The 5G System stage 2 architecture and procedures are specified in 3GPP TS
23.501 [2] and 3GPP TS 23.502 [3].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition are specified in TS 29.500 [4] and TS
29.501 [5].
The Stage 2 architecture, procedures and services to support service based
short message service (SMS) in 5G system (5GS) is specified in 3GPP TS 23.540
[14].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[5] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[6] OpenAPI: \"OpenAPI Specification Version 3.0.0\",
[https://spec.openapis.org/oas/v3.0.0]{.underline}.
[7] 3GPP TR 21.900: \"Technical Specification Group working methods\".
[8] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[9] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[10] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[11] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
[12] IETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange
Format\".
[13] IETF RFC 7807: \"Problem Details for HTTP APIs\".
[14] 3GPP TS 23.540: \"5G System; Technical realization of Service Based Short
Message Service; Stage 2\".
[15] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces; Stage 3\".
[16] 3GPP TS 23.040: \"Technical realization of the Short Message Service
(SMS)\".
[17] 3GPP TS 24.011: \"Point-to-Point (PP) Short Message Service (SMS) support
on mobile radio interface\".
[18] IETF RFC 2387: \"The MIME Multipart/Related Content-type\".
[19] IETF RFC 2045: \"Multipurpose Internet Mail Extensions (MIME) Part One:
Format of Internet Message Bodies\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**Gateway MSC For Short Message Service (SMS‑GMSC):** function of an MSC
capable of receiving a short message from an SC, interrogating an HLR/HSS/UDM
for routing information and SMS info, and delivering the short message to the
VMSC/SGSN/MME/SMSF of the recipient MS/UE.
**IP-Short-Message-Gateway (IP-SM-GW):** function responsible for protocol
interworking between the IP-based UE and the SC.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
IP-SM-GW IP Short Message Gateway
SM MO Short Message Mobile Originated
SM MT Short Message Mobile Terminated
SMSF Short Message Service Function
# 4 Overview
## 4.1 Introduction
Within the 5GC, the IP-SM-GW offers services to the UDM or SMS-GMSC via the
Nipsmgw service based interface, the SMS Router offers services to the UDM or
SMS-GMSC via the Nrouter service based interface (see 3GPP TS 23.540 [14],
3GPP TS 23.501 [2] and 3GPP TS 23.502 [3]).
Figure 4.1-1 and Figure 4.1-2 provide the reference model (in service based
interface representation and in reference point representation), with focus on
the IP-SM-GW and SMS Router and the scope of the present specification.
Figure 4.1-1: Reference model -- IP-SM-GW
Figure 4.1-2: Reference model -- SMS Router
The functionalities supported by the IP-SM-GW and SMS Router are listed in
3GPP TS 23.540 [14].
# 5 Services offered by the IP-SM-GW and SMS Router
## 5.1 Introduction
The IP-SM-GW offers to other NFs the following service:
\- Nipsmgw_SMService
The SMS Router offers to other NFs the following service:
\- Nrouter_SMService
The Nipsmgw_SMService service and Nrouter_SMService service are specified in
3GPP TS 23.540 [14].
Table 5.1-1 summarizes the corresponding APIs defined for this specification.
Table 5.1-1: API Descriptions
Service Name Clause Description OpenAPI Specification File apiName Annex
* * *
Nipsmgw_SMService 6.1 IP-SM-GW SMService Service
TS29577_Nipsmgw_SMService.yaml nipsmgw-smservice A.2 Nrouter_SMService 6.2 SMS
Router SMService Service TS29577_Nrouter_SMService.yaml nrouter-smservice A.3
## 5.2 Nipsmgw_SMService Service
### 5.2.1 Service Description
The Nipsmgw_SMService service provides SBI-based MT SM transmit through IP-SM-
GW. The IP-SM-GW is acting as NF Service Producer, while the UDM or SMS-GMSC
is the NF Service Consumer.
Following functionalities are provided by the Nipsmgw_SMService service:
\- Provide Routing Information;
\- Transmit downlink SMS message.
The Nipsmgw_SMService service supports the following service operations.
Table 5.2.1-1: Service operations supported by the Nipsmgw_SMService service
+----------------+----------------+----------------+----------------+ | Service | Description | Operation | Example | | Operations | | | Consumer(s) | | | | Semantics | | +================+================+================+================+ | RoutingInfo | Provide | Re | UDM | | | Routing | quest/Response | | | | Information. | | | +----------------+----------------+----------------+----------------+ | MtForwardSm | Transmit | Re | SMS-GMSC | | | downlink SMS | quest/Response | | | | message. | | | +----------------+----------------+----------------+----------------+
### 5.2.2 Service Operations
#### 5.2.2.1 Introduction
See Table 5.2.1-1 for an overview of the service operations supported by the
Nipsmgw_SMService service.
#### 5.2.2.2 RoutingInfo
##### 5.2.2.2.1 General
The RoutingInfo service operation shall be used to provide the SMSF Instance
Id to the IP-SM-GW.
It is used in the following procedures:
\- Successful Mobile Terminated short message transfer via IP-SM-GW (see
clause 5.1.4 of 3GPP TS 23.540 [14]).
\- Unsuccessful Mobile Terminated short message transfer via IP-SM-GW (see
clause 5.1.6 of 3GPP TS 23.540 [14]).
The NF Service Consumer (e.g. UDM) shall provide the SMSF Instance Id to the
IP-SM-GW by using the HTTP PUT method as shown in Figure 5.2.2.2.1-1.
Figure 5.2.2.2.1-1: Routing Information creation
1\. The NF Service Consumer shall send a PUT request to the resource
representing the UE\'s Mobile Terminated Short Message Information resource
(i.e. .../mt-sms/{gpsi}) of the IP-SM-GW to update or create the routing
information for a given UE. The payload body of the PUT request shall contain:
\- SMSF Instance Id.
2a. If the resource does not exist (there is no previous routing information
stored in IP-SM-GW for that user), IP-SM-GW stores the received routing data
and returns a \"201 Created\" response with the \"Location\" header containing
the URI of the created resource.
The PUT response body shall include:
\- the IP address of the IP-SM-GW (to be sent by the UDM to the SMS-GMSC);
and/or
\- the FQDN of the IP-SM-GW (to be sent by the UDM to the SMS-GMSC).
2b. If the resource exists (there is previous routing information stored in
IP-SM-GW for that user), the IP-SM-GW updates the routing data by replacing it
with the received information, and responds with \"200 OK\" or \"204 No
Content\".
2c. On failure, or redirection, one of the HTTP status code listed in Table
6.1.3.3.3.1-3 shall be returned.
#### 5.2.2.3 MtForwardSm
##### 5.2.2.3.1 General
The MtForwardSm service operation shall be used to transmit downlink SMS
message via IP-SM-GW.
It is used in the following procedures:
\- Successful Mobile Terminated short message transfer via IP-SM-GW (see
clause 5.1.4 of 3GPP TS 23.540 [14]).
\- Unsuccessful Mobile Terminated short message transfer via IP-SM-GW (see
clause 5.1.6 of 3GPP TS 23.540 [14]).
The NF Service Consumer (e.g. SMS-GMSC) shall transmit downlink SMS message to
the IP-SM-GW by using the HTTP POST method as shown in Figure 5.2.2.3.1-1.
Figure 5.2.2.3.1-1: Transmit downlink SMS message
1\. The NF Service Consumer shall send a POST request to the resource
representing the UE\'s Mobile Terminated Short Message Information resource
(i.e. .../mt-sms/{gpsi}/sendsms) of the IP-SM-GW. The payload body of the POST
request shall contain the SMS message to be sent.
2a. On success, \"200 OK\" shall be returned with \"SmsDeliveryData\" object
contains the MT SMS Delivery Report in the response body.
2b. On failure, or redirection, one of the HTTP status code listed in Table
6.1.3.3.4.2.2-2 shall be returned.
## 5.3 Nrouter_SMService Service
### 5.3.1 Service Description
The Nrouter_SMService service provides SBI-based MT SM transmit through SMS
Router. The SMS Router is acting as NF Service Producer, while the UDM or SMS-
GMSC is the NF Service Consumer.
Following functionalities are provided by the Nrouter_SMService service:
\- Provide Routing Information;
\- Transmit downlink SMS message.
The Nrouter_SMService service supports the following service operations.
Table 5.3.1-1: Service operations supported by the Nrouter_SMService service
+----------------+----------------+----------------+----------------+ | Service | Description | Operation | Example | | Operations | | | Consumer(s) | | | | Semantics | | +================+================+================+================+ | RoutingInfo | Provide | Re | UDM | | | Routing | quest/Response | | | | Information. | | | +----------------+----------------+----------------+----------------+ | MtForwardSm | Transmit | Re | SMS-GMSC | | | downlink SMS | quest/Response | | | | message. | | | +----------------+----------------+----------------+----------------+
### 5.3.2 Service Operations
#### 5.3.2.1 Introduction
See Table 5.3.1-1 for an overview of the service operations supported by the
Nrouter_SMService service.
#### 5.3.2.2 RoutingInfo
##### 5.3.2.2.1 General
The RoutingInfo service operation shall be used to provide the SMSF Instance
Id to the SMS Router.
It is used in the following procedures:
\- Successful Mobile Terminated short message transfer via SMS Router (see
clause 5.1.3 of 3GPP TS 23.540 [14]).
\- Unsuccessful Mobile Terminated short message transfer via SMS Router (see
clause 5.1.9 of 3GPP TS 23.540 [14]).
The NF Service Consumer (e.g. UDM) shall provide the SMSF Instance Id to the
SMS Router by using the HTTP PUT method as shown in Figure 5.3.2.2.1-1.
Figure 5.3.2.2.1-1: Routing Information creation
1\. The NF Service Consumer shall send a PUT request to the resource
representing the UE\'s Mobile Terminated Short Message Information resource
(i.e. .../mt-sms/{gpsi}) of the SMS Router to update or create the routing
information for a given UE. The payload body of the PUT request shall contain:
\- SMSF Instance Id.
2a. If the resource does not exist (there is no previous routing information
stored in SMS Router for that user), SMS Router stores the received routing
data and returns a \"201 Created\" response with the \"Location\" header
containing the URI of the created resource.
The PUT response body shall include:
\- the IP address of the SMS Router (to be sent by the UDM to the SMS-GMSC);
and/or
\- the FQDN of the SMS Router (to be sent by the UDM to the SMS-GMSC).
2b. If the resource exists (there is previous routing information stored in
SMS Router for that user), the SMS Router updates the routing data by
replacing it with the received information, and responds with \"200 OK\" or
\"204 No Content\".
2c. On failure, or redirection, one of the HTTP status code listed in Table
6.2.3.3.3.1-3 shall be returned.
#### 5.3.2.3 MtForwardSm
##### 5.3.2.3.1 General
The MtForwardSm service operation shall be used to transmit downlink SMS
message via SMS Router.
It is used in the following procedures:
\- Successful Mobile Terminated short message transfer via SMS Router (see
clause 5.1.3 of 3GPP TS 23.540 [14]).
\- Unsuccessful Mobile Terminated short message transfer via SMS Router (see
clause 5.1.9 of 3GPP TS 23.540 [14]).
The NF Service Consumer (e.g. SMS-GMSC) shall transmit downlink SMS message to
the SMS Router by using the HTTP POST method as shown in Figure 5.3.2.3.1-1.
Figure 5.3.2.3.1-1: Transmit downlink SMS message
1\. The NF Service Consumer shall send a POST request to the resource
representing the UE\'s Mobile Terminated Short Message Information resource
(i.e. .../mt-sms/{gpsi}/sendsms) of the SMS Router. The payload body of the
POST request shall contain the SMS message to be sent.
2a. On success, \"200 OK\" shall be returned with \"SmsDeliveryData\" object
contains the MT SMS Delivery Report in the response body.
2b. On failure, or redirection, one of the HTTP status code listed in Table
6.2.3.3.4.2.2-2 shall be returned.
# 6 API Definitions
## 6.1 Nipsmgw_SMService Service API
### 6.1.1 Introduction
The Nipsmgw_SMService shall use the Nipsmgw_SMService API.
The API URI of the Nipsmgw_SMService API shall be:
**{apiRoot}/\ /\**
The request URIs used in HTTP requests from the NF service consumer towards
the NF service producer shall have the Resource URI structure defined in
clause 4.4.1 of 3GPP TS 29.501 [5], i.e.:
**{apiRoot}/\ /\/\**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [5].
\- The \ shall be \"nipsmgw-smservice\".
\- The \ shall be \"v1\".
\- The \ shall be set as described in clause
6.1.3.
### 6.1.2 Usage of HTTP
#### 6.1.2.1 General
HTTP/2, IETF RFC 7540 [11], shall be used as specified in clause 5 of 3GPP TS
29.500 [4].
HTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [4].
The OpenAPI [6] specification of HTTP messages and content bodies for the
Nipsmgw_SMService API is contained in Annex A.
#### 6.1.2.2 HTTP standard headers
##### 6.1.2.2.1 General
See clause 5.2.2 of 3GPP TS 29.500 [4] for the usage of HTTP standard headers.
##### 6.1.2.2.2 Content type
JSON, IETF RFC 8259 [12], shall be used as content type of the HTTP bodies
specified in the present specification as specified in clause 5.4 of 3GPP TS
29.500 [4]. The use of the JSON format shall be signalled by the content type
\"application/json\".
\"Problem Details\" JSON object shall be used to indicate additional details
of the error in a HTTP response body and shall be signalled by the content
type \"application/problem+json\", as defined in IETF RFC 7807 [13].
Multipart messages shall also be supported (see clause 6.1.2.4) using the
content type \"multipart/related\", comprising:
\- one JSON body part with the \"application/json\" content type; and
\- one binary body part with 3gpp vendor specific content subtypes.
The 3gpp vendor specific content subtypes defined in Table 6.1.2.2.2-1 shall
be supported.
Table 6.1.2.2.2-1: 3GPP vendor specific content subtypes
* * *
content subtype Description vnd.3gpp.sms Binary encoded payload, encoding SMS
payload, as specified in 3GPP TS 23.040 [16] and 3GPP TS 24.011 [17]. NOTE:
Using 3GPP vendor content subtypes allows to describe the nature of the opaque
payload (e.g. SMS payload) without having to rely on metadata in the JSON
payload.
* * *
See clause 6.1.2.4 for the binary payloads supported in the binary body part
of multipart messages.
#### 6.1.2.3 HTTP custom headers
The mandatory HTTP custom header fields specified in clause 5.2.3.2 of 3GPP TS
29.500 [4] shall be supported, and the optional HTTP custom header fields
specified in clause 5.2.3.3 of 3GPP TS 29.500 [4] may be supported.
#### 6.1.2.4 HTTP multipart messages
HTTP multipart messages shall be supported, to transfer opaque SMS payload
(e.g. SMS message, CP Ack, etc.), in the following service operations (and
HTTP messages):
\- MtForwardSm service operation;
HTTP multipart messages shall include one JSON body part and one binary body
part comprising content of SMS payload content (see clause 6.1.6.5).
The JSON body part shall be the \"root\" body part of the multipart message.
It shall be encoded as the first body part of the multipart message. The
\"Start\" parameter does not need to be included.
The multipart message shall include a \"type\" parameter (see IETF RFC 2387
[18]) specifying the media type of the root body part, i.e.
\"application/json\".
NOTE: The \"root\" body part (or \"root\" object) is the first body part the
application processes when receiving a multipart/related message, see IETF RFC
2387 [18]. The default root is the first body within the multipart/related
message. The \"Start\" parameter indicates the root body part, e.g. when this
is not the first body part in the message.
A binary body part shall include a Content-ID header (see IETF RFC 2045 [19]),
and the JSON body part shall make a reference to the binary body part using
the Content-ID header field.
Examples of multipart/related messages can be found in Annex B.
### 6.1.3 Resources
#### 6.1.3.1 Overview
This clause describes the structure for the Resource URIs and the resources
and methods used for the service.
Figure 6.1.3.1-1 depicts the resource URIs structure for the Nipsmgw_SMService
API.
Figure 6.1.3.1-1: Resource URI structure of the Nipsmgw_SMService API
Table 6.1.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 6.1.3.1-1: Resources and methods overview
+----------------+----------------+----------------+----------------+ | Resource | Resource URI | HTTP method or | Description | | purpose/name | (relative path | custom | (service | | | after API URI) | operation | operation) | +================+================+================+================+ | MtSmInfos | /mt-sm-infos | | | | | | | | | (Collection) | | | | +----------------+----------------+----------------+----------------+ | MtSmInfo | /mt-s | PUT | Create Routing | | | m-infos/{gpsi} | | Information | | (Document) | | | for MT SMS. | +----------------+----------------+----------------+----------------+ | | /mt-sm-infos/ | sendsms | It is used for | | | {gpsi}/sendsms | | the | | | | (POST) | MtForwardSm | | | | | service | | | | | operation, to | | | | | allow NF | | | | | Service | | | | | Consumer to | | | | | send SMS | | | | | payload in | | | | | downlink | | | | | direction. | +----------------+----------------+----------------+----------------+
#### 6.1.3.2 Resource: MtSmInfos (Collection)
##### 6.1.3.2.1 Description
This resource represents the collection of Mobile Terminated Short Message
Information in IP-SM-GW.
This resource is modelled with the Collection resource archetype (see clause
C.2 of 3GPP TS 29.501 [5]).
No HTTP method has been defined for this resource.
##### 6.1.3.2.2 Resource Definition
Resource URI: **{apiRoot}/nipsmgw-smsevice/\ /mt-sm-infos**
This resource shall support the resource URI variables defined in table
6.1.3.2.2-1.
Table 6.1.3.2.2-1: Resource URI variables for this resource
Name Data type Definition
* * *
apiRoot string See clause 6.1.1
##### 6.1.3.2.3 Resource Standard Methods
No HTTP method has been defined for the Mobile Terminated Short Message
Information collection resource.
#### 6.1.3.3 Resource: MtSmInfo (Document)
##### 6.1.3.3.1 Description
This resource represents an individual Mobile Terminated Short Message
Information in IP-SM-GW.
This resource is modelled with the Document resource archetype (see clause C.1
of 3GPP TS 29.501 [5]).
##### 6.1.3.3.2 Resource Definition
Resource URI: **{apiRoot}/nipsmgw-smsevice/\ /mt-sm-infos/{gpsi}**
This resource shall support the resource URI variables defined in table
6.1.3.3.2-1.
Table 6.1.3.3.2-1: Resource URI variables for this resource
+---------+-----------+----------------------------------------------+ | Name | Data type | Definition | +=========+===========+==============================================+ | apiRoot | string | See clause 6.1.1 | +---------+-----------+----------------------------------------------+ | gpsi | gpsi | Represents the Generic Public Subscription | | | | Identifier with MSISDN (see | | | | 3GPP TS 23.501 [2] clause 5.9.8) | | | | | | | | pattern: See pattern of type Gpsi in | | | | 3GPP TS 29.571 [15] | +---------+-----------+----------------------------------------------+
##### 6.1.3.3.3 Resource Standard Methods
##### 6.1.3.3.3.1 PUT {#put .H6}
This method creates an individual resource of Mobile Terminated Short Message
Information in the IP-SM-GW, or updates the indicated resource of Mobile
Terminated Short Message Information in the IP-SM-GW.
This method shall support the URI query parameters specified in table
6.1.3.3.3.1-1.
Table 6.1.3.3.3.1-1: URI query parameters supported by the PUT method on this
resource
* * *
Name Data type P Cardinality Description Applicability n/a
* * *
This method shall support the request data structures specified in table
6.1.3.3.3.1-2 and the response data structures and response codes specified in
table 6.1.3.3.3.1-3.
Table 6.1.3.3.3.1-2: Data structures supported by the PUT Request Body on this
resource
* * *
Data type P Cardinality Description CreateRoutingData M 1 Representation of
the UE\'s Mobile Terminated Short Message Information to be created in the IP-
SM-GW, or to be updated in the IP-SM-GW.
* * *
Table 6.1.3.3.3.1-3: Data structures supported by the PUT Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Creat | M | 1 | 201 Created | This case | | edRoutingData | | | | represents | | | | | | the | | | | | | successful | | | | | | creation of | | | | | | an UE\'s | | | | | | Mobile | | | | | | Terminated | | | | | | Short Message | | | | | | Information. | | | | | | | | | | | | The HTTP | | | | | | response | | | | | | shall include | | | | | | a | | | | | | \"Location\" | | | | | | HTTP header | | | | | | that contains | | | | | | the resource | | | | | | URI of the | | | | | | created | | | | | | resource. | +---------------+---+-------------+---------------+---------------+ | Creat | M | 1 | 200 OK | Upon success, | | edRoutingData | | | | a response | | | | | | body | | | | | | containing a | | | | | | r | | | | | | epresentation | | | | | | of the | | | | | | updated UE\'s | | | | | | Mobile | | | | | | Terminated | | | | | | Short Message | | | | | | Information | | | | | | shall be | | | | | | returned. | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | Upon success, | | | | | Content | an empty | | | | | | response body | | | | | | shall be | | | | | | returned | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | manadatory | | | | | | HTTP error | | | | | | status code | | | | | | for the PUT | | | | | | method listed | | | | | | in | | | | | | Ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Red | | | | | | irectResponse | | | | | | may be | | | | | | inserted by | | | | | | an SCP, see | | | | | | cl | | | | | | ause 6.10.9.1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4]. | | | | | +---------------+---+-------------+---------------+---------------+
Table 6.1.3.3.3.1-4: Headers supported by the 201 response code on this
resource
* * *
Name Data type P Cardinality Description Location string M 1 Contains the URI
of the newly created resource, according to the structure: {apiRoot}/nipsmgw-
smsevice/\/mt-sm-infos/{gpsi}
* * *
Table 6.1.3.3.3.1-5: Headers supported by the 307 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same | | | | | | IP-SM-GW or | | | | | | IP-SM-GW | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
Table 6.1.3.3.3.1-6: Headers supported by the 308 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same | | | | | | IP-SM-GW or | | | | | | IP-SM-GW | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
##### 6.1.3.3.4 Resource Custom Operations
##### 6.1.3.3.4.1 Overview {#overview-2 .H6}
Table 6.1.3.3.4.1-1: Custom operations
Operation name Custom operaration URI Mapped HTTP method Description
* * *
sendsms /mt-sm-infos/{gpsii}/sendsms POST Send MT SMS message or the related
Delivery Report.
##### 6.1.3.3.4.2 Operation: sendsms {#operation-sendsms .H6}
##### 6.1.3.3.4.2.1 Description {#description-2 .H6}
This custom operation is used for NF Service Consumers to send SMS message in
downlink direction.
##### 6.1.3.3.4.2.2 Operation Definition {#operation-definition .H6}
This custom operation is used to send a SMS payload to an UE\'s Mobile
Terminated Short Message Information resource in the IP-SM-GW.
This operation shall support the request data structures specified in table
6.1.3.3.4.2.2-1 and the response data structure and response codes specified
in table 6.1.3.3.4.2.2-2.
Table 6.1.3.3.4.2.2-1: Data structures supported by the POST Request Body on
this resource
* * *
Data type P Cardinality Description SmsData M 1 Representation of the MT SMS
message to be sent.
* * *
Table 6.1.3.3.4.2.2-2: Data structures supported by the POST Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Sm | M | 1 | 200 OK | This case | | sDeliveryData | | | | represents | | | | | | the | | | | | | successful of | | | | | | sending SMS | | | | | | message in | | | | | | downlink | | | | | | direction, | | | | | | with | | | | | | necessary | | | | | | response data | | | | | | on the | | | | | | received | | | | | | delivery | | | | | | report. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 400 Bad | This case | | roblemDetails | | | Request | represents an | | | | | | unsuccessful | | | | | | delivery of | | | | | | SMS message. | | | | | | | | | | | | The \"cause\" | | | | | | attribute may | | | | | | be used to | | | | | | indicate one | | | | | | of the | | | | | | following | | | | | | application | | | | | | errors: | | | | | | | | | | | | > \- | | | | | | > SMS_PAYL | | | | | | OAD_MISSING, | | | | | | > if the | | | | | | > expected | | | | | | > SMS payload | | | | | | > content is | | | | | | > missing; | | | | | | > | | | | | | > \- | | | | | | > SMS_PA | | | | | | YLOAD_ERROR, | | | | | | > if error | | | | | | > exists in | | | | | | > the SMS | | | | | | > payload | | | | | | > content. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 404 Not Found | This case | | roblemDetails | | | | represents an | | | | | | unsuccessful | | | | | | delivery of | | | | | | SMS payload. | | | | | | | | | | | | The \"cause\" | | | | | | attribute may | | | | | | be used to | | | | | | indicate one | | | | | | of the | | | | | | following | | | | | | application | | | | | | errors: | | | | | | | | | | | | > \- | | | | | | > | | | | | | ROUTING_INFO | | | | | | _NOT_FOUND, | | | | | | > if the | | | | | | > routing | | | | | | > information | | | | | | > for SMS to | | | | | | > be operated | | | | | | > is invalid | | | | | | > or not | | | | | | > found in | | | | | | > IP-SM-GW. | | | | | | > | | | | | | > \- | | | | | | > USER | | | | | | _NOT_FOUND, | | | | | | > if the UE | | | | | | > identified | | | | | | > by the GPSI | | | | | | > is not | | | | | | > found in | | | | | | > the | | | | | | > IP-SM-GW. | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | manadatory | | | | | | HTTP error | | | | | | status code | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | Ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Red | | | | | | irectResponse | | | | | | may be | | | | | | inserted by | | | | | | an SCP, see | | | | | | cl | | | | | | ause 6.10.9.1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4]. | | | | | +---------------+---+-------------+---------------+---------------+
Table 6.1.3.3.4.2.2-3: Headers supported by the 307 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same | | | | | | IP-SM-GW or | | | | | | IP-SM-GW | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
Table 6.1.3.3.4.2.2-4: Headers supported by the 308 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same | | | | | | IP-SM-GW or | | | | | | IP-SM-GW | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
### 6.1.4 Custom Operations without associated resources
In this release of this specification, no custom operations without associated
resources are defined.
### 6.1.5 Notifications
In this release of this specification, no notification procedures are defined.
### 6.1.6 Data Model
#### 6.1.6.1 General
This clause specifies the application data model supported by the API.
Table 6.1.6.1-1 specifies the data types defined for the Nipsmgw_SMService
service based interface protocol.
Table 6.1.6.1-1: Nipsmgw_SMService specific Data Types
Data type Clause defined Description Applicability
* * *
CreateRoutingData 6.1.6.2.2 Information used for creating or updating the
routing information of the user.  
CreatedRoutingData 6.1.6.2.3 Information used for receiving the MT SMS.  
SmsData 6.1.6.2.4 Information within request message for delivering SMS.  
SmsDeliveryData 6.1.6.2.5 Information within response message invoking
MtForwardSm service operation, for delivering MT SMS Delivery Report.
Table 6.1.6.1-2 specifies data types re-used by the Nipsmgw_SMService service
based interface protocol from other specifications, including a reference to
their respective specifications and when needed, a short description of their
use within the Nipsmgw_SMService service based interface.
Table 6.1.6.1-2: Nipsmgw_SMService re-used Data Types
Data type Reference Comments Applicability
* * *
ProblemDetails 3GPP TS 29.571 [15] Common Data Type used in response bodies  
RedirectResponse 3GPP TS 29.571 [15] Redirect Response  
Gpsi 3GPP TS 29.571 [15] General Public Subscription Identifier  
NfInstanceId 3GPP TS 29.571 [15] NF Instance ID  
RefToBinaryData 3GPP TS 29.571 [15] Information for indicating the binary
content of SMS payload.  
Ipv4Addr 3GPP TS 29.571 [15] IPv4 address  
Ipv6Addr 3GPP TS 29.571 [15] IPv6 address  
SupportedFeatures 3GPP TS 29.571 [15] Supported Features  
Fqdn 3GPP TS 29.571 [15] Fully Qualified Domain Name  
Supi 3GPP TS 29.571 [15] Subscription Permanent Identifier
#### 6.1.6.2 Structured data types
##### 6.1.6.2.1 Introduction
This clause defines the structures to be used in resource representations.
##### 6.1.6.2.2 Type: CreateRoutingData
Table 6.1.6.2.2-1: Definition of type CreateRoutingData
Attribute name Data type P Cardinality Description Applicability
* * *
smsfId NfInstanceId M 1 This IE shall be present, and it shall contain the NF
instance ID of the SMSF to receive the downlink MT SM.  
supi Supi O 0..1 SUPI  
supportedFeatures SupportedFeatures C 0..1 This IE shall be present if at
least one optional feature defined in clause 6.1.8 is supported.
##### 6.1.6.2.3 Type: CreatedRoutingData
Table 6.1.6.2.3-1: Definition of type CreatedRoutingData
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +===========+===========+===+===========+===========+===========+ | i | Ipv4Addr | C | 0..1 | This IE | | | psmgwIpv4 | | | | shall be | | | | | | | present | | | | | | | if | | | | | | | a | | | | | | | vailable. | | | | | | | | | | | | | | When | | | | | | | present, | | | | | | | this IE | | | | | | | indicates | | | | | | | the IPv4 | | | | | | | address | | | | | | | of the | | | | | | | IP-SM-GW | | | | | | | to | | | | | | | receive | | | | | | | the | | | | | | | downlink | | | | | | | short | | | | | | | message. | | | | | | | | | | | | | | See NOTE | | +-----------+-----------+---+-----------+-----------+-----------+ | i | Ipv6Addr | C | 0..1 | This IE | | | psmgwIpv6 | | | | shall be | | | | | | | present | | | | | | | if | | | | | | | a | | | | | | | vailable. | | | | | | | | | | | | | | When | | | | | | | present, | | | | | | | this IE | | | | | | | indicates | | | | | | | the IPv6 | | | | | | | address | | | | | | | of the | | | | | | | IP-SM-GW | | | | | | | to | | | | | | | receive | | | | | | | the | | | | | | | downlink | | | | | | | short | | | | | | | message. | | | | | | | | | | | | | | See NOTE | | +-----------+-----------+---+-----------+-----------+-----------+ | i | Fqdn | C | 0..1 | This IE | | | psmgwFqdn | | | | shall be | | | | | | | present | | | | | | | if | | | | | | | a | | | | | | | vailable. | | | | | | | | | | | | | | When | | | | | | | present, | | | | | | | this IE | | | | | | | indicates | | | | | | | the FQDN | | | | | | | of the | | | | | | | IP-SM-GW | | | | | | | to | | | | | | | receive | | | | | | | the | | | | | | | downlink | | | | | | | short | | | | | | | message. | | | | | | | | | | | | | | See NOTE | | +-----------+-----------+---+-----------+-----------+-----------+ | corr | string | O | 0..1 | Co | | | elationId | | | | rrelation | | | | | | | ID | | +-----------+-----------+---+-----------+-----------+-----------+ | supporte | Supporte | C | 0..1 | This IE | | | dFeatures | dFeatures | | | shall be | | | | | | | present | | | | | | | if at | | | | | | | least one | | | | | | | optional | | | | | | | feature | | | | | | | defined | | | | | | | in clause | | | | | | | 6.1.8 is | | | | | | | s | | | | | | | upported. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE: At | | | | | | | least, | | | | | | | one of | | | | | | | IP-SM-GW | | | | | | | addresses | | | | | | | shall be | | | | | | | included. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
##### 6.1.6.2.4 Type: SmsData
Table 6.1.6.2.4-1: Definition of type SmsData
Attribute name Data type P Cardinality Description Applicability
* * *
smsPayload RefToBinaryData M 1 This IE shall be present, and it shall contain
the reference to the SMS Payload Information binary data (see clause 6.1.6.5)
##### 6.1.6.2.5 Type: SmsDeliveryData
Table 6.1.6.2.5-1: Definition of type SmsDeliveryData
Attribute name Data type P Cardinality Description Applicability
* * *
smsPayload RefToBinaryData M 1 This IE shall be present, and it shall contain
the reference to the SMS Payload Information binary data (see clause 6.1.6.5)
#### 6.1.6.3 Simple data types and enumerations
##### 6.1.6.3.1 Introduction
This clause defines simple data types and enumerations that can be referenced
from data structures defined in the previous clauses.
##### 6.1.6.3.2 Simple data types
The simple data types defined in table 6.1.6.3.2-1 shall be supported.
Table 6.1.6.3.2-1: Simple data types
* * *
Type Name Type Definition Description Applicability
* * *
#### 6.1.6.4 Data types describing alternative data types or combinations of
data types
In this release of this specification, no alternative data types or
combinations of data types are defined.
#### 6.1.6.5 Binary data
##### 6.1.6.5.1 Binary Data Types
Table 6.1.6.5.1-1: Binary Data Types
Name Clause defined Content type
* * *
SMS Payload Information 6.1.6.5.2 vnd.3gpp.sms
##### 6.1.6.5.2 SMS Payload Information
SMS Payload Information shall encode a SMS payload as specified in 3GPP TS
23.040 [16] and 3GPP TS 24.011 [17], using the vnd.3gpp.sms content-type.
SMS Payload Information may encode e.g. the following content:
\- CP-DATA, CP-ACK, CP-ERROR as specified in 3GPP TS 23.040 [16] and 3GPP TS
24.011 [17].
### 6.1.7 Error Handling
#### 6.1.7.1 General
For the Nipsmgw_SMService API, HTTP error responses shall be supported as
specified in clause 4.8 of 3GPP TS 29.501 [5]. Protocol errors and application
errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [4] shall be supported
for an HTTP method if the corresponding HTTP status codes are specified as
mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS 29.500 [4].
In addition, the requirements in the following clauses are applicable for the
Nipsmgw_SMService API.
#### 6.1.7.2 Protocol Errors
No specific procedures for the Nipsmgw_SMService service are specified.
#### 6.1.7.3 Application Errors
The application errors defined for the Nipsmgw_SMService service are listed in
Table 6.1.7.3-1.
Table 6.1.7.3-1: Application errors
Application Error HTTP status code Description
* * *
SMS_PAYLOAD_MISSING 400 Bad Request The expected SMS payload content is
missing. SMS_PAYLOAD_ERROR 400 Bad Request Errors exist in the format of SMS
payload. USER_NOT_FOUND 404 Not Found The provided subscriber identifier is
not found. ROUTING_INFO_NOT_FOUND 404 Not Found The routing information for
SMS to be operated is invalid or not found in IP-SM-GW
### 6.1.8 Feature negotiation
The optional features in table 6.1.8-1 are defined for the Nipsmgw_SMService
API. They shall be negotiated using the extensibility mechanism defined in
clause 6.6 of 3GPP TS 29.500 [4].
Table 6.1.8-1: Supported Features
Feature number Feature Name Description
* * *
### 6.1.9 Security
As indicated in 3GPP TS 33.501 [8] and 3GPP TS 29.500 [4], the access to the
Nipsmgw_SMService API may be authorized by means of the OAuth2 protocol (see
IETF RFC 6749 [9]), based on local configuration, using the \"Client
Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [10])
plays the role of the authorization server.
If OAuth2 is used, an NF Service Consumer, prior to consuming services offered
by the Nipsmgw_SMService API, shall obtain a \"token\" from the authorization
server, by invoking the Access Token Request service, as described in 3GPP TS
29.510 [10], clause 5.4.2.2.
NOTE: When multiple NRFs are deployed in a network, the NRF used as
authorization server is the same NRF that the NF Service Consumer used for
discovering the Nipsmgw_SMService service.
The Nipsmgw_SMService API defines the following scopes for Oauth2
authorization as specified in 3GPP TS 33.501 [8]:
Table 6.1.9-1: OAuth2 scopes defined in Nipsmgw_SMService API
Scope Description
* * *
\"nipsmgw_smservice\" Access to the Nipsmgw_SMService API.
\"nipsmgw_smservice:mtsminfos:write\" Access to write MT SM Infos
\"nipsmgw_smservice:sendsms:invoke\" Access to invoke Send SMS
### 6.1.10 HTTP redirection
An HTTP request may be redirected to a different IP-SM-GW service instance,
within the same IP-SM-GW or a different IP-SM-GW of an IP-SM-GW set, e.g. when
an IP-SM-GW service instance is part of an IP-SM-GW (service) set or when
using indirect communications (see 3GPP TS 29.500 [4]).
An SCP that reselects a different IP-SM-GW producer instance will return the
NF Instance ID of the new IP-SM-GW producer instance in the 3gpp-Sbi-Producer-
Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [4].
If an IP-SM-GW within an IP-SM-GW set redirects a service request to a
different IP-SM-GW of the set using a 307 Temporary Redirect or 308 Permanent
Redirect status code, the identity of the new IP-SM-GW towards which the
service request is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id
header of the 307 Temporary Redirect or 308 Permanent Redirect response as
specified in clause 6.10.9.1 of 3GPP TS 29.500 [4].
## 6.2 Nrouter_SMService Service API
### 6.2.1 Introduction
The Nrouter_SMService shall use the Nrouter_SMService API.
The API URI of the Nrouter_SMService API shall be:
**{apiRoot}/\ /\**
The request URIs used in HTTP requests from the NF service consumer towards
the NF service producer shall have the Resource URI structure defined in
clause 4.4.1 of 3GPP TS 29.501 [5], i.e.:
**{apiRoot}/\ /\/\**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [5].
\- The \ shall be \"nrouter-smservice\".
\- The \ shall be \"v1\".
\- The \ shall be set as described in clause
6.2.3.
### 6.2.2 Usage of HTTP
#### 6.2.2.1 General
HTTP/2, IETF RFC 7540 [11], shall be used as specified in clause 5 of 3GPP TS
29.500 [4].
HTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [4].
The OpenAPI [6] specification of HTTP messages and content bodies for the
Nrouter_SMService API is contained in Annex A.
#### 6.2.2.2 HTTP standard headers
##### 6.2.2.2.1 General
See clause 5.2.2 of 3GPP TS 29.500 [4] for the usage of HTTP standard headers.
##### 6.2.2.2.2 Content type
JSON, IETF RFC 8259 [12], shall be used as content type of the HTTP bodies
specified in the present specification as specified in clause 5.4 of 3GPP TS
29.500 [4]. The use of the JSON format shall be signalled by the content type
\"application/json\".
\"Problem Details\" JSON object shall be used to indicate additional details
of the error in a HTTP response body and shall be signalled by the content
type \"application/problem+json\", as defined in IETF RFC 7807 [13].
Multipart messages shall also be supported (see clause 6.2.2.4) using the
content type \"multipart/related\", comprising:
\- one JSON body part with the \"application/json\" content type; and
\- one binary body part with 3gpp vendor specific content subtypes.
The 3gpp vendor specific content subtypes defined in Table 6.2.2.2.2-1 shall
be supported.
Table 6.2.2.2.2-1: 3GPP vendor specific content subtypes
* * *
content subtype Description vnd.3gpp.sms Binary encoded payload, encoding SMS
payload, as specified in 3GPP TS 23.040 [16] and 3GPP TS 24.011 [17]. NOTE:
Using 3GPP vendor content subtypes allows to describe the nature of the opaque
payload (e.g. SMS payload) without having to rely on metadata in the JSON
payload.
* * *
See clause 6.2.2.4 for the binary payloads supported in the binary body part
of multipart messages.
#### 6.2.2.3 HTTP custom headers
The mandatory HTTP custom header fields specified in clause 5.2.3.2 of 3GPP TS
29.500 [4] shall be supported, and the optional HTTP custom header fields
specified in clause 5.2.3.3 of 3GPP TS 29.500 [4] may be supported.
#### 6.2.2.4 HTTP multipart messages
HTTP multipart messages shall be supported, to transfer opaque SMS payload
(e.g. SMS message, CP Ack, etc.), in the following service operations (and
HTTP messages):
\- MtForwardSm service operation;
HTTP multipart messages shall include one JSON body part and one binary body
part comprising content of SMS payload content (see clause 6.2.6.4).
The JSON body part shall be the \"root\" body part of the multipart message.
It shall be encoded as the first body part of the multipart message. The
\"Start\" parameter does not need to be included.
The multipart message shall include a \"type\" parameter (see IETF RFC 2387
[18]) specifying the media type of the root body part, i.e.
\"application/json\".
NOTE: The \"root\" body part (or \"root\" object) is the first body part the
application processes when receiving a multipart/related message, see IETF RFC
2387 [18]. The default root is the first body within the multipart/related
message. The \"Start\" parameter indicates the root body part, e.g. when this
is not the first body part in the message.
A binary body part shall include a Content-ID header (see IETF RFC 2045 [19]),
and the JSON body part shall make a reference to the binary body part using
the Content-ID header field.
Examples of multipart/related messages can be found in Annex B.
### 6.2.3 Resources
#### 6.2.3.1 Overview
This clause describes the structure for the Resource URIs and the resources
and methods used for the service.
Figure 6.2.3.1-1 depicts the resource URIs structure for the Nrouter_SMService
API.
Figure 6.2.3.1-1: Resource URI structure of the Nrouter_SMService API
Table 6.2.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 6.2.3.1-1: Resources and methods overview
+----------------+----------------+----------------+----------------+ | Resource | Resource URI | HTTP method or | Description | | purpose/name | (relative path | custom | (service | | | after API URI) | operation | operation) | +================+================+================+================+ | MtSmInfo | /mt-s | PUT | Create Routing | | | m-infos/{gpsi} | | Information | | (Document) | | | for MT SMS. | +----------------+----------------+----------------+----------------+ | | /mt-sm-infos/ | sendsms | It is used for | | | {gpsi}/sendsms | | the | | | | (POST) | MtForwardSm | | | | | service | | | | | operation, to | | | | | allow NF | | | | | Service | | | | | Consumer to | | | | | send SMS | | | | | payload in | | | | | downlink | | | | | direction. | +----------------+----------------+----------------+----------------+
#### 6.2.3.2 Resource: MtSmInfos (Store)
##### 6.2.3.2.1 Description
This resource represents the collection of Mobile Terminated Short Message
Information in SMS Router.
This resource is modelled with the Store resource archetype (see clause C.3 of
3GPP TS 29.501 [5]).
No HTTP method has been defined for this resource.
##### 6.2.3.2.2 Resource Definition
Resource URI: **{apiRoot}/nrouter-smsevice/\ /mt-sm-infos**
This resource shall support the resource URI variables defined in table
6.2.3.2.2-1.
Table 6.2.3.2.2-1: Resource URI variables for this resource
Name Data type Definition
* * *
apiRoot string See clause 6.2.1
##### 6.2.3.2.3 Resource Standard Methods
No HTTP method has been defined for the Mobile Terminated Short Message
Information collection resource.
#### 6.2.3.3 Resource: MtSmInfo (Document)
##### 6.2.3.3.1 Description
This resource represents an individual Mobile Terminated Short Message
Information in SMS Router.
This resource is modelled with the Document resource archetype (see clause C.1
of 3GPP TS 29.501 [5]).
##### 6.2.3.3.2 Resource Definition
Resource URI: **{apiRoot}/nrouter-smsevice/\ /mt-sm-infos/{gpsi}**
This resource shall support the resource URI variables defined in table
6.2.3.3.2-1.
Table 6.2.3.3.2-1: Resource URI variables for this resource
+---------+-----------+----------------------------------------------+ | Name | Data type | Definition | +=========+===========+==============================================+ | apiRoot | string | See clause 6.2.1 | +---------+-----------+----------------------------------------------+ | gpsi | gpsi | Represents the Generic Public Subscription | | | | Identifier with MSISDN (see | | | | 3GPP TS 23.501 [2] clause 5.9.8) | | | | | | | | pattern: See pattern of type Gpsi in | | | | 3GPP TS 29.571 [15] | +---------+-----------+----------------------------------------------+
##### 6.2.3.3.3 Resource Standard Methods
##### 6.2.3.3.3.1 PUT {#put-1 .H6}
This method creates an individual resource of Mobile Terminated Short Message
Information in the SMS Router, or updates the indicated resource of Mobile
Terminated Short Message Information in the SMS Router.
This method shall support the URI query parameters specified in table
6.2.3.3.3.1-1.
Table 6.2.3.3.3.1-1: URI query parameters supported by the PUT method on this
resource
* * *
Name Data type P Cardinality Description Applicability n/a
* * *
This method shall support the request data structures specified in table
6.2.3.3.3.1-2 and the response data structures and response codes specified in
table 6.2.3.3.3.1-3.
Table 6.1.3.3.3.1-2: Data structures supported by the PUT Request Body on this
resource
* * *
Data type P Cardinality Description CreateRoutingData M 1 Representation of
the UE\'s Mobile Terminated Short Message Information to be created in the SMS
Router, or to be updated in the SMS Router.
* * *
Table 6.2.3.3.3.1-3: Data structures supported by the PUT Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Creat | M | 1 | 201 Created | This case | | edRoutingData | | | | represents | | | | | | the | | | | | | successful | | | | | | creation of | | | | | | an UE\'s | | | | | | Mobile | | | | | | Terminated | | | | | | Short Message | | | | | | Information. | | | | | | | | | | | | The HTTP | | | | | | response | | | | | | shall include | | | | | | a | | | | | | \"Location\" | | | | | | HTTP header | | | | | | that contains | | | | | | the resource | | | | | | URI of the | | | | | | created | | | | | | resource. | +---------------+---+-------------+---------------+---------------+ | Creat | M | 1 | 200 OK | Upon success, | | edRoutingData | | | | a response | | | | | | body | | | | | | containing a | | | | | | r | | | | | | epresentation | | | | | | of the | | | | | | updated UE\'s | | | | | | Mobile | | | | | | Terminated | | | | | | Short Message | | | | | | Information | | | | | | shall be | | | | | | returned. | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | Upon success, | | | | | Content | an empty | | | | | | response body | | | | | | shall be | | | | | | returned | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | manadatory | | | | | | HTTP error | | | | | | status code | | | | | | for the PUT | | | | | | method listed | | | | | | in | | | | | | Ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Red | | | | | | irectResponse | | | | | | may be | | | | | | inserted by | | | | | | an SCP, see | | | | | | cl | | | | | | ause 6.10.9.1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4]. | | | | | +---------------+---+-------------+---------------+---------------+
Table 6.2.3.3.3.1-4: Headers supported by the 201 response code on this
resource
* * *
Name Data type P Cardinality Description Location string M 1 Contains the URI
of the newly created resource, according to the structure: {apiRoot}/nrouter-
smsevice/\/mt-sm-infos/{gpsi}
* * *
Table 6.2.3.3.3.1-3: Headers supported by the 307 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same SMS | | | | | | Router or SMS | | | | | | Router | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
Table 6.2.3.3.3.1-6: Headers supported by the 308 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same SMS | | | | | | Router or SMS | | | | | | Router | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
##### 6.2.3.3.4 Resource Custom Operations
##### 6.2.3.3.4.1 Overview {#overview-4 .H6}
Table 6.2.3.3.4.1-1: Custom operations
Operation name Custom operaration URI Mapped HTTP method Description
* * *
sendsms /mt-sm-infos/{gpsii}/sendsms POST Send MT SMS message or the related
Delivery Report.
##### 6.2.3.3.4.2 Operation: sendsms {#operation-sendsms-1 .H6}
##### 6.2.3.3.4.2.1 Description {#description-5 .H6}
This custom operation is used for NF Service Consumers to send SMS message in
downlink direction.
##### 6.2.3.3.4.2.2 Operation Definition {#operation-definition-1 .H6}
This custom operation is used to send a SMS payload to an UE\'s Mobile
Terminated Short Message Information resource in the SMS Router.
This operation shall support the request data structures specified in table
6.2.3.3.4.2.2-1 and the response data structure and response codes specified
in table 6.2.3.3.4.2.2-2.
Table 6.2.3.3.4.2.2-1: Data structures supported by the POST Request Body on
this resource
* * *
Data type P Cardinality Description SmsData M 1 Representation of the MT SMS
message to be sent.
* * *
Table 6.2.3.3.4.2.2-2: Data structures supported by the POST Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Sm | M | 1 | 200 OK | This case | | sDeliveryData | | | | represents | | | | | | the | | | | | | successful of | | | | | | sending SMS | | | | | | message in | | | | | | downlink | | | | | | direction, | | | | | | with | | | | | | necessary | | | | | | response data | | | | | | on the | | | | | | received | | | | | | delivery | | | | | | report. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 400 Bad | This case | | roblemDetails | | | Request | represents an | | | | | | unsuccessful | | | | | | delivery of | | | | | | SMS message. | | | | | | | | | | | | The \"cause\" | | | | | | attribute may | | | | | | be used to | | | | | | indicate one | | | | | | of the | | | | | | following | | | | | | application | | | | | | errors: | | | | | | | | | | | | > \- | | | | | | > SMS_PAYL | | | | | | OAD_MISSING, | | | | | | > if the | | | | | | > expected | | | | | | > SMS payload | | | | | | > content is | | | | | | > missing; | | | | | | > | | | | | | > \- | | | | | | > SMS_PA | | | | | | YLOAD_ERROR, | | | | | | > if error | | | | | | > exists in | | | | | | > the SMS | | | | | | > payload | | | | | | > content. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 404 Not Found | This case | | roblemDetails | | | | represents an | | | | | | unsuccessful | | | | | | delivery of | | | | | | SMS payload. | | | | | | | | | | | | The \"cause\" | | | | | | attribute may | | | | | | be used to | | | | | | indicate one | | | | | | of the | | | | | | following | | | | | | application | | | | | | errors: | | | | | | | | | | | | > \- | | | | | | > | | | | | | ROUTING_INFO | | | | | | _NOT_FOUND, | | | | | | > if the | | | | | | > routing | | | | | | > information | | | | | | > for SMS to | | | | | | > be operated | | | | | | > is invalid | | | | | | > or not | | | | | | > found in | | | | | | > SMS Router. | | | | | | > | | | | | | > \- | | | | | | > USER | | | | | | _NOT_FOUND, | | | | | | > if the UE | | | | | | > identified | | | | | | > by the GPSI | | | | | | > is not | | | | | | > found in | | | | | | > the SMS | | | | | | > Router. | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | manadatory | | | | | | HTTP error | | | | | | status code | | | | | | for the POST | | | | | | method listed | | | | | | in | | | | | | Ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Red | | | | | | irectResponse | | | | | | may be | | | | | | inserted by | | | | | | an SCP, see | | | | | | cl | | | | | | ause 6.10.9.1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4]. | | | | | +---------------+---+-------------+---------------+---------------+
Table 6.2.3.3.4.2.2-3: Headers supported by the 307 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same SMS | | | | | | Router or SMS | | | | | | Router | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
Table 6.2.3.3.4.2.2-4: Headers supported by the 308 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same SMS | | | | | | Router or SMS | | | | | | Router | | | | | | (service) set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
### 6.2.4 Custom Operations without associated resources
In this release of this specification, no custom operations without associated
resources are defined.
### 6.2.5 Notifications
In this release of this specification, no notification procedures are defined.
### 6.2.6 Data Model
#### 6.2.6.1 General
This clause specifies the application data model supported by the API.
Table 6.2.6.1-1 specifies the data types defined for the Nrouter_SMService
service based interface protocol.
Table 6.2.6.1-1: Nrouter_SMService specific Data Types
Data type Clause defined Description Applicability
* * *
CreatedRoutingData 6.2.6.2.2 Information used for receiving the MT SMS.
Table 6.2.6.1-2 specifies data types re-used by the Nrouter_SMService service
based interface protocol from other specifications, including a reference to
their respective specifications and when needed, a short description of their
use within the Nrouter_SMService service based interface.
Table 6.2.6.1-2: Nrouter_SMService re-used Data Types
Data type Reference Comments Applicability
* * *
CreateRoutingData 6.1.6.2.2 Information used for creating or updating the
routing information of the user.  
SmsData 6.1.6.2.4 Information within request message invoking MtForwardSm
service operation, for delivering MT SMS.  
SmsDeliveryData 6.1.6.2.5 Information within response message invoking
MtForwardSm service operation, for delivering MT SMS Delivery Report.  
ProblemDetails 3GPP TS 29.571 [15] Common Data Type used in response bodies  
RedirectResponse 3GPP TS 29.571 [15] Redirect Response  
Gpsi 3GPP TS 29.571 [15] General Public Subscription Identifier  
NfInstanceId 3GPP TS 29.571 [15] NF Instance ID  
RefToBinaryData 3GPP TS 29.571 [15] Information for indicating the binary
content of SMS payload.  
Ipv4Addr 3GPP TS 29.571 [15] IPv4 address  
Ipv6Addr 3GPP TS 29.571 [15] IPv6 address  
SupportedFeatures 3GPP TS 29.571 [15] Supported Features  
Fqdn 3GPP TS 29.571 [15] Fully Qualified Domain Name
#### 6.2.6.2 Structured data types
##### 6.2.6.2.1 Introduction
This clause defines the structures to be used in resource representations.
##### 6.2.6.2.2 Type: CreatedRoutingData
Table 6.2.6.2.2-1: Definition of type CreatedRoutingData
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +===========+===========+===+===========+===========+===========+ | r | Ipv4Addr | C | 0..1 | This IE | | | outerIpv4 | | | | shall be | | | | | | | present | | | | | | | if | | | | | | | a | | | | | | | vailable. | | | | | | | | | | | | | | When | | | | | | | present, | | | | | | | this IE | | | | | | | indicates | | | | | | | the IPv4 | | | | | | | address | | | | | | | of the | | | | | | | SMS | | | | | | | Router to | | | | | | | receive | | | | | | | the | | | | | | | downlink | | | | | | | short | | | | | | | message. | | | | | | | | | | | | | | See NOTE | | +-----------+-----------+---+-----------+-----------+-----------+ | r | Ipv6Addr | C | 0..1 | This IE | | | outerIpv6 | | | | shall be | | | | | | | present | | | | | | | if | | | | | | | a | | | | | | | vailable. | | | | | | | | | | | | | | When | | | | | | | present, | | | | | | | this IE | | | | | | | indicates | | | | | | | the IPv6 | | | | | | | address | | | | | | | of the | | | | | | | SMS | | | | | | | Router to | | | | | | | receive | | | | | | | the | | | | | | | downlink | | | | | | | short | | | | | | | message. | | | | | | | | | | | | | | See NOTE | | +-----------+-----------+---+-----------+-----------+-----------+ | r | Fqdn | C | 0..1 | This IE | | | outerFqdn | | | | shall be | | | | | | | present | | | | | | | if | | | | | | | a | | | | | | | vailable. | | | | | | | | | | | | | | When | | | | | | | present, | | | | | | | this IE | | | | | | | indicates | | | | | | | the FQDN | | | | | | | of the | | | | | | | SMS | | | | | | | Router to | | | | | | | receive | | | | | | | the | | | | | | | downlink | | | | | | | short | | | | | | | message. | | | | | | | | | | | | | | See NOTE | | +-----------+-----------+---+-----------+-----------+-----------+ | supporte | Supporte | C | 0..1 | This IE | | | dFeatures | dFeatures | | | shall be | | | | | | | present | | | | | | | if at | | | | | | | least one | | | | | | | optional | | | | | | | feature | | | | | | | defined | | | | | | | in clause | | | | | | | 6.1.8 is | | | | | | | s | | | | | | | upported. | | +-----------+-----------+---+-----------+-----------+-----------+ | NOTE: At | | | | | | | least, | | | | | | | one of | | | | | | | SMS | | | | | | | Router | | | | | | | addresses | | | | | | | shall be | | | | | | | included. | | | | | | +-----------+-----------+---+-----------+-----------+-----------+
#### 6.2.6.3 Simple data types and enumerations
##### 6.2.6.3.1 Introduction
This clause defines simple data types and enumerations that can be referenced
from data structures defined in the previous clauses.
##### 6.2.6.3.2 Simple data types
The simple data types defined in table 6.2.6.3.2-1 shall be supported.
Table 6.2.6.3.2-1: Simple data types
* * *
Type Name Type Definition Description Applicability
* * *
##### 6.2.6.3.3 Enumeration: \
The enumeration \ represents \. It shall comply with the
provisions defined in table 6.1.6.3.3-1.
Table 6.2.6.3.3-1: Enumeration \
Enumeration value Description Applicability
* * *
#### 6.2.6.4 Data types describing alternative data types or combinations of
data types
In this release of this specification, no alternative data types or
combinations of data types are defined.
#### 6.2.6.5 Binary data
See clause 6.1.6.5.
### 6.2.7 Error Handling
#### 6.2.7.1 General
For the Nrouter_SMService API, HTTP error responses shall be supported as
specified in clause 4.8 of 3GPP TS 29.501 [5]. Protocol errors and application
errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [4] shall be supported
for an HTTP method if the corresponding HTTP status codes are specified as
mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS 29.500 [4].
In addition, the requirements in the following clauses are applicable for the
Nrouter_SMService API.
#### 6.2.7.2 Protocol Errors
No specific procedures for the Nrouter_SMService service are specified.
#### 6.2.7.3 Application Errors
The application errors defined for the Nrouter_SMService service are listed in
Table 6.2.7.3-1.
Table 6.2.7.3-1: Application errors
Application Error HTTP status code Description
* * *
SMS_PAYLOAD_MISSING 400 Bad Request The expected SMS payload content is
missing. SMS_PAYLOAD_ERROR 400 Bad Request Errors exist in the format of SMS
payload. USER_NOT_FOUND 404 Not Found The provided subscriber identifier is
not found. ROUTING_INFO_NOT_FOUND 404 Not Found The routing information for
SMS to be operated is invalid or not found in SMS Router
### 6.2.8 Feature negotiation
The optional features in table 6.2.8-1 are defined for the Nrouter_SMService
API. They shall be negotiated using the extensibility mechanism defined in
clause 6.6 of 3GPP TS 29.500 [4].
Table 6.2.8-1: Supported Features
Feature number Feature Name Description
* * *
### 6.2.9 Security
As indicated in 3GPP TS 33.501 [8] and 3GPP TS 29.500 [4], the access to the
Nrouter_SMService API may be authorized by means of the OAuth2 protocol (see
IETF RFC 6749 [9]), based on local configuration, using the \"Client
Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [10])
plays the role of the authorization server.
If OAuth2 is used, an NF Service Consumer, prior to consuming services offered
by the Nrouter_SMService API, shall obtain a \"token\" from the authorization
server, by invoking the Access Token Request service, as described in 3GPP TS
29.510 [10], clause 5.4.2.2.
NOTE: When multiple NRFs are deployed in a network, the NRF used as
authorization server is the same NRF that the NF Service Consumer used for
discovering the Nrouter_SMService service.
The Nrouter_SMService API defines the following scopes for Oauth2
authorization as specified in 3GPP TS 33.501 [8]:
Table 6.2.9-1: OAuth2 scopes defined in Nrouter_SMService API
Scope Description
* * *
\"nrouter_smservice\" Access to the Nrouter_SMService API.
\"nrouter_smservice:mtsminfos:write\" Access to write MT SM Infos
\"nrouter_smservice:sendsms:invoke\" Access to invoke Send SMS
### 6.2.10 HTTP redirection
An HTTP request may be redirected to a different SMS Router service instance,
within the same SMS Router or a different SMS Router of an SMS Router set,
e.g. when an SMS Router service instance is part of an SMS Router (service)
set or when using indirect communications (see 3GPP TS 29.500 [4]).
An SCP that reselects a different SMS Router producer instance will return the
NF Instance ID of the new SMS Router producer instance in the 3gpp-Sbi-
Producer-Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [4].
If an SMS Router within an SMS Router set redirects a service request to a
different SMS Router of the set using a 307 Temporary Redirect or 308
Permanent Redirect status code, the identity of the new SMS Router towards
which the service request is redirected shall be indicated in the 3gpp-Sbi-
Target-Nf-Id header of the 307 Temporary Redirect or 308 Permanent Redirect
response as specified in clause 6.10.9.1 of 3GPP TS 29.500 [4].
###### ## Annex A (normative): OpenAPI specification
# A.1 General
This Annex specifies the formal definition of the API(s) defined in the
present specification. It consists of OpenAPI specifications in YAML format.
This Annex takes precedence when being discrepant to other parts of the
specification with respect to the encoding of information elements and methods
within the API(s).
NOTE 1: The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
Informative copies of the OpenAPI specification files contained in this 3GPP
Technical Specification are available on a Git-based repository that uses the
GitLab software version control system (see clause 5.3.1 of 3GPP TS 29.501 [5]
and clause 5B of 3GPP TR 21.900 [7]).
# A.2 Nipsmgw_SMService API
openapi: 3.0.0
info:
version: \'1.1.0-alpha.2\'
title: \'Nipsmgw_SMService Service API\'
description: \|
IP-SM-GW SMService.
© 2023, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
externalDocs:
description: 3GPP TS 29.577 V18.1.0; 5G System; IP Short Message Gateway and
SMS Router For Short Message Services; Stage 3
url: \'https://www.3gpp.org/ftp/Specs/archive/29_series/29.577/\'
security:
\- oAuth2ClientCredentials:
\- nipsmgw-smservice
\- {}
servers:
\- url: \'{apiRoot}/nipsmgw-smservice/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in clause 4.4 of 3GPP TS 29.501.
paths:
/mt-sm-infos/{gpsi}:
put:
summary: Create the routing information for a given UE
operationId: RoutingInfo
tags:
\- Creation of Routing Info
security:
\- {}
\- oAuth2ClientCredentials:
\- nipsmgw_smservice
\- oAuth2ClientCredentials:
\- nipsmgw_smservice
\- nipsmgw_smservice:mtsminfos:write
parameters:
\- name: gpsi
in: path
required: true
description: Generic Public Subscription Identifier (GPSI)
schema:
type: string
requestBody:
content:
application/json:
schema:
\$ref: \'#/components/schemas/CreateRoutingData\'
required: true
responses:
\'201\':
description: Routing Information is created in IP-SM-GW
content:
application/json:
schema:
\$ref: \'#/components/schemas/CreatedRoutingData\'
headers:
Location:
description: >
\'Contains the URI of the newly created resource, according to the structure:
{apiRoot}/nipsmgw-smservice/\/mt-sm-infos/{gpsi}\'
required: true
schema:
type: string
\'200\':
description: Routing Information is updated in IP-SM-GW
content:
application/json:
schema:
\$ref: \'#/components/schemas/CreatedRoutingData\'
\'204\':
description: Routing Information is updated in IP-SM-GW
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'502\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/502\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/mt-sm-infos/{gpsi}/sendsms:
post:
summary: Send SMS payload for a given UE
operationId: SendSMS
tags:
\- Send MT SMS message and the delivery report
security:
\- {}
\- oAuth2ClientCredentials:
\- nipsmgw_smservice
\- oAuth2ClientCredentials:
\- nipsmgw_smservice
\- nipsmgw_smservice:sendsms:invoke
parameters:
\- name: gpsi
in: path
required: true
description: Generic Public Subscription Identifier (GPSI)
schema:
type: string
requestBody:
content:
multipart/related: # message with a binary body part
schema:
type: object
properties:
jsonData:
\$ref: \'#/components/schemas/SmsData\'
binaryPayload:
type: string
format: binary
encoding:
jsonData:
contentType: application/json
binaryPayload:
contentType: application/vnd.3gpp.sms
headers:
Content-Id:
schema:
type: string
required: true
responses:
\'200\':
description: sending delivery report
content:
multipart/related: # message with a binary body part
schema:
type: object
properties:
jsonData:
\$ref: \'#/components/schemas/SmsDeliveryData\'
binaryPayload:
type: string
format: binary
encoding:
jsonData:
contentType: application/json
binaryPayload:
contentType: application/vnd.3gpp.sms
headers:
Content-Id:
schema:
type: string
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'502\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/502\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
components:
securitySchemes:
oAuth2ClientCredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
nipsmgw-smservice: Access to the nipsmgw-smservice API
nipsmgw-smservice:mtsminfos:write: Access to write MT SM Infos
nipsmgw-smservice:sendsms:invoke: Access to invoke Send SMS
schemas:
CreateRoutingData:
description: Information used for creating or updating the routing information
of the user.
type: object
required:
\- smsfId
properties:
smsfId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/NfInstanceId\'
supi:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Supi\'
supportedFeatures:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
CreatedRoutingData:
description: Information used for receiving the MT SMS.
type: object
properties:
ipsmgwIpv4:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
ipsmgwIpv6:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr\'
ipsmgwFqdn:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Fqdn\'
correlationId:
type: string
supportedFeatures:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
SmsData:
description: Information within request message for delivering SMS.
type: object
required:
\- smsPayload
properties:
smsPayload:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RefToBinaryData\'
SmsDeliveryData:
description: >
Information within response message invoking MtForwardSm service operation,
for delivering
MT SMS Delivery Report.
type: object
required:
\- smsPayload
properties:
smsPayload:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RefToBinaryData\'
# A.3 Nrouter_SMService API
openapi: 3.0.0
info:
version: \'1.1.0-alpha.2\'
title: \'Nrouter_SMService Service API\'
description: \|
SMS Router SMService.
© 2023, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
externalDocs:
description: 3GPP TS 29.577 V18.1.0; 5G System; IP Short Message Gateway and
SMS Router For Short Message Services; Stage 3
url: \'https://www.3gpp.org/ftp/Specs/archive/29_series/29.577/\'
security:
\- oAuth2ClientCredentials:
\- nrouter-smservice
\- {}
servers:
\- url: \'{apiRoot}/nrouter-smservice/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in clause 4.4 of 3GPP TS 29.501.
paths:
/mt-sm-infos/{gpsi}:
put:
summary: Create the routing information for a given UE
operationId: RoutingInfo
tags:
\- Creation of Routing Info
security:
\- {}
\- oAuth2ClientCredentials:
\- nrouter_smservice
\- oAuth2ClientCredentials:
\- nrouter_smservice
\- nrouter_smservice:mtsminfos:write
parameters:
\- name: gpsi
in: path
required: true
description: Generic Public Subscription Identifier (GPSI)
schema:
type: string
requestBody:
content:
application/json:
schema:
\$ref:
\'TS29577_Nipsmgw_SMService.yaml#/components/schemas/CreateRoutingData\'
required: true
responses:
\'201\':
description: Routing Information is created in SMS Router
content:
application/json:
schema:
\$ref: \'#/components/schemas/CreatedRoutingData\'
headers:
Location:
description: >
\'Contains the URI of the newly created resource, according to the structure:
{apiRoot}/nrouter-smservice/\/mt-sm-infos/{gpsi}\'
required: true
schema:
type: string
\'200\':
description: Routing Information is updated in SMS Router
content:
application/json:
schema:
\$ref: \'#/components/schemas/CreatedRoutingData\'
\'204\':
description: Routing Information is updated in SMS Router
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'502\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/502\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
/mt-sm-infos/{gpsi}/sendsms:
post:
summary: Send SMS payload for a given UE
operationId: SendSMS
tags:
\- Send MT SMS message and the delivery report
security:
\- {}
\- oAuth2ClientCredentials:
\- nrouter_smservice
\- oAuth2ClientCredentials:
\- nrouter_smservice
\- nrouter_smservice:sendsms:invoke
parameters:
\- name: gpsi
in: path
required: true
description: Generic Public Subscription Identifier (GPSI)
schema:
type: string
requestBody:
content:
multipart/related: # message with a binary body part
schema:
type: object
properties:
jsonData:
\$ref: \'TS29577_Nipsmgw_SMService.yaml#/components/schemas/SmsData\'
binaryPayload:
type: string
format: binary
encoding:
jsonData:
contentType: application/json
binaryPayload:
contentType: application/vnd.3gpp.sms
headers:
Content-Id:
schema:
type: string
required: true
responses:
\'200\':
description: sending delivery report
content:
multipart/related: # message with a binary body part
schema:
type: object
properties:
jsonData:
\$ref: \'TS29577_Nipsmgw_SMService.yaml#/components/schemas/SmsDeliveryData\'
binaryPayload:
type: string
format: binary
encoding:
jsonData:
contentType: application/json
binaryPayload:
contentType: application/vnd.3gpp.sms
headers:
Content-Id:
schema:
type: string
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'502\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/502\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
components:
securitySchemes:
oAuth2ClientCredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
nrouter-smservice: Access to the nrouter-smservice API
nrouter-smservice:mtsminfos:write: Access to write MT SM Infos
nrouter-smservice:sendsms:invoke: Access to invoke Send SMS
schemas:
CreatedRoutingData:
description: Information used for receiving the MT SMS.
type: object
properties:
routerIpv4:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr\'
routerIpv6:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr\'
routerFqdn:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Fqdn\'
supportedFeatures:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
###### ## Annex B (Informative): HTTP Multipart Messages
# B.1 Example of HTTP multipart message
This Annex provides a (partial) example of HTTP multipart message. The example
does not aim to be a complete representation of the HTTP message, e.g.
additional information or headers can be included.
This Annex is informative and the normative descriptions in this specification
prevail over the description in this Annex if there is any difference.
# B.2 Example HTTP multipart message with SMS binary data
Example HTTP multipart message with SMS binary data:
> POST /example.com/nipsmgw-smservice/v1/mt-sm-infos/{gpsi}/sendsms HTTP/2
>
> Content-Type: multipart/related; boundary=----Boundary
>
> Content-Length: xyz
>
> \------Boundary
>
> Content-Type: application/json
>
> {
>
> \"smsPayload\": {
>
> \"contentId\": \"sms\"
>
> },
>
> }
>
> \------Boundary
>
> Content-Type: application/vnd.3gpp.sms
>
> Content-Id: sms
>
> { ... SMS Message binary data ...}
>
> \------Boundary
The JSON part of the HTTP POST message includes an attribute named
\"smsPayload\" which refers to RefToBinaryData structure. The \"contentId\" of
RefToBinaryData is encoded as a string and used to reference the value of the
Content-ID header field of the binary body part.
#