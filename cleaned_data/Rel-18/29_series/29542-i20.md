# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies the stage 3 protocol and data model for the
Nsmf Service Based Interfaces for Non-IP Data Delivery (NIDD). It provides
stage 3 protocol definitions and message flows, and specifies the API for the
service offered by the SMF.
The 5G System stage 2 architecture and procedures are specified in 3GPP TS
23.501 [2] and 3GPP TS 23.502 [3].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition are specified in 3GPP TS 29.500 [4] and
3GPP TS 29.501 [5].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[5] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[6] OpenAPI: \"OpenAPI Specification Version 3.0.0\",
https://spec.openapis.org/oas/v3.0.0.
[7] 3GPP TR 21.900: \"Technical Specification Group working methods\".
[8] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[9] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[10] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[11] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
> [12] IETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange
> Format\".
[13] IETF RFC 7807: \"Problem Details for HTTP APIs\".
[14] 3GPP TS 29.541: \"5G System (5GS); Network Exposure (NE) function
services for Non-IP Data Delivery (NIDD) and Short Message Services (SMS);
Stage 3\".
[15] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces; Stage 3\".
# 3 Definitions, symbols and abbreviations
## 3.1 Terms
Void.
## 3.2 Symbols
Void.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5GC 5G Core Network
AMF Access and Mobility Management Function
H-SMF Home SMF
I-SMF Intermediate SMF
NEF Network Exposure Function
NIDD Non-IP Data Delivery
MT Mobile Terminated
SMF Session Management Function
V-SMF Visited SMF
# 4 Overview
## 4.1 Introduction
Within the 5GC, the SMF offers services to the NF service consumers via the
Nsmf service based interface (see 3GPP TS 23.501 [2] and 3GPP TS 23.502 [3]).
Figure 4.1-1 provides the reference model (in service based interface
representation and in reference point representation), with focus on the
services specified within the present specification.
Figure 4.1-1: Reference model -- SMF
N29 is the reference point between the (H-)SMF and the NEF.
The functionalities supported by the SMF are listed in clause 6.2.2 of 3GPP TS
23.501 [2].
# 5 Services offered by the SMF for NIDD
## 5.1 Introduction
The SMF supports the following service(s) for NIDD.
Table 5.1-1: NF Service(s) provided by SMF for NIDD
Service Name Description Example Consumer
* * *
Nsmf_NIDD This service allows the NF consumer NF to deliver NIDD MT data to
PDU sessions. NEF
## 5.2 Nsmf_NIDD Service
### 5.2.1 Service Description
The Nsmf_NIDD service operates on the PDU Sessions. The service operations
exposed by this service allow an NF consumer (i.e. NEF) to deliver NEF
anchored Mobile Terminated (MT) data for a given PDU session of a UE towards
the SMF.
The Nsmf_NIDD service supports the following service operations:
Table 5.2.1-1: Service operations supported by the Nsmf_NIDD service
+----------------+----------------+----------------+----------------+ | Service | Description | Operation | Example | | Operations | | | Consumer(s) | | | | Semantics | | +================+================+================+================+ | Delivery | Deliver MT | Re | NEF | | | NIDD user data | quest/Response | | | | to the PDU | | | | | session of the | | | | | UE. | | | +----------------+----------------+----------------+----------------+
### 5.2.2 Service Operations
#### 5.2.2.1 Introduction
See Table 5.2.1-1 for an overview of the service operations supported by the
Nsmf_NIDD service.
#### 5.2.2.2 Delivery
##### 5.2.2.2.1 General
The Delivery service operation shall be used to transfer NEF anchored MT data
for a given PDU session.
It is used in the following procedures:
\- NEF anchored Mobile Terminated Data Transport (see clause 4.25.5 of 3GPP TS
23.502 [3]).
The NF Service Consumer (i.e. NEF) shall deliver MT data to the SMF by using
the HTTP POST method (\"deliver\" custom operation) as shown in Figure
5.2.2.2.1-1.
Figure 5.2.2.2.1-1: Transfer MT Data
1\. The NF Service Consumer shall send a POST request to the URI of
\"deliver\" custom operation on an Individual PDU session resource in the SMF.
The payload body of the POST request shall contain the MT data to be
delivered.
NOTE: The URI of the individual PDU session resource is provided by SMF to the
NEF during SMF-NEF connection creation (see clause 5.2.2.2.1 of 3GPP TS 29.541
[14]).
2a. On success, \"204 No Content\" shall be returned.
2b. On failure or redirection, one of the HTTP status code listed in Table
6.1.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the message body
may contain a DeliverError or ProblemDetails object, with the \"cause\"
attribute indicating the cause of the failure. If Estimated Maximum Waiting
Time is received from AMF, the SMF shall include it in the message body.
# 6 API Definitions
## 6.1 Nsmf_NIDD Service API
### 6.1.1 Introduction
The Nsmf_NIDD service shall use the Nsmf_NIDD API.
The API URI of the Nsmf_NIDD API shall be:
**{apiRoot}/\ /\/**
The request URI used in HTTP request from the NF service consumer towards the
NF service producer shall have the Resource URI structure defined in clause
4.4.1 of 3GPP TS 29.501 [5], i.e.:
**{apiRoot}/\ /\/\**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [5].
\- The \ shall be \"nsmf-nidd\".
\- The \ shall be \"v1\".
\- The \ shall be set as described in clause
6.1.3.
### 6.1.2 Usage of HTTP
#### 6.1.2.1 General
HTTP/2, IETF RFC 7540 [11], shall be used as specified in clause 5 of 3GPP TS
29.500 [4].
HTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [4].
The OpenAPI [6] specification of HTTP messages and content bodies for the
Nsmf_NIDD API is contained in Annex A.
#### 6.1.2.2 HTTP standard headers
##### 6.1.2.2.1 General
The usage of HTTP standard headers shall be supported as specified in clause
5.2.2 of 3GPP TS 29.500 [4].
##### 6.1.2.2.2 Content type
The following content types shall be supported:
\- the JSON format (IETF RFC 8259 [12]). The use of the JSON format shall be
signalled by the content type \"application/json\". See also clause 5.4 of
3GPP TS 29.500 [4].
\- the Problem Details JSON Object (IETF RFC 7807 [13]). The use of the
Problem Details JSON object in a HTTP response body shall be signalled by the
content type \"application/problem+json\".
NOTE: \"application/json\" is used in a response that includes a payload body
containing an application-specific data structure, see clause 4.8 of 3GPP TS
29.501 [5].
Multipart messages shall also be supported (see clause 6.1.2.4) using the
content type \"multipart/related\", comprising:
\- one JSON body part with the \"application/json\" content type; and
\- one or two binary body parts with 3gpp vendor specific content subtypes.
The 3gpp vendor specific content subtypes defined in Table 6.1.2.2.2-1 shall
be supported.
Table 6.1.2.2.2-1: 3GPP vendor specific content subtypes
* * *
content subtype Description vnd.3gpp.5gnas Binary encoded payload, encoding a
5GS NAS message or 5G NAS IEs, as specified in 3GPP TS 24.501 [7].
* * *
See clause 6.1.6.5 for the binary payloads supported in the binary body part
of multipart messages.
#### 6.1.2.3 HTTP custom headers
In this release of the specification, no specific custom headers are defined
for the Nsmf_NIDD service.
For 3GPP specific HTTP custom headers used across all service based
interfaces, see clause 5.2.3 of 3GPP TS 29.500 [4].
### 6.1.3 Resources
#### 6.1.3.1 Overview
Figure 6.1.3.1-1 describes the resource URI structure of the Nsmf_NIDD API.
Figure 6.1.3.1-1: Resource URI structure of the Nsmf_NIDD API
Table 6.1.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 6.1.3.1-1: Resources and methods overview
Resource name Resource URI HTTP method or custom operation Description
* * *
Individual PDU session /pdu-sessions/{pduSessionRef}/deliver deliver (POST)
Delivery Service Operation
#### 6.1.3.2 Resource: Individual PDU session
##### 6.1.3.2.1 Description
This resource represents an individual PDU session created in SMF for NIDD.
This resource is modelled with the Document resource archetype (see clause C.1
of 3GPP TS 29.501 [5]).
##### 6.1.3.2.2 Resource Definition
Resource URI: **{apiRoot}/nsmf-nidd/\ /pdu-
sessions/{pduSessionRef}**
This resource shall support the resource URI variables defined in table
6.1.3.2.2-1.
Table 6.1.3.2.2-1: Resource URI variables for this resource
Name Definition
* * *
apiRoot See clause 6.1.1 apiVersion See clause 6.1.1 pduSessionRef PDU session
reference assigned by the SMF during SMF-NEF Connection creation.
##### 6.1.3.2.3 Resource Standard Methods
None.
##### 6.1.3.2.4 Resource Custom Operations
##### 6.1.3.2.4.1 Overview {#overview-2 .H6}
Table 6.1.3.2.4.1-1: Custom operations
Custom operaration URI Mapped HTTP method Description
* * *
{resourceUri}/deliver POST Delivery service operation.
##### 6.1.3.2.4.2 Operation: deliver {#operation-deliver .H6}
###### # 6.1.3.2.4.2.1 Description
This custom operation enables to deliver NEF anchored MT data for a given PDU
session towards the SMF.
###### # 6.1.3.2.4.2.2 Operation Definition
This operation shall support the request data structures specified in table
6.1.3.2.4.2.2-1 and the response data structure and response codes specified
in table 6.1.3.2.4.2.2-2.
Table 6.1.3.2.4.2.2-1: Data structures supported by the POST Request Body on
this resource
* * *
Data type P Cardinality Description DeliverReqData M 1 Representation of the
payload of a Deliver Request
* * *
Table 6.1.3.2.4.2.2-2: Data structures supported by the POST Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | Successful | | | | | Content | delivery of | | | | | | MT data. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection. | | | | | | | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | DeliverError | O | 0..1 | 504 Gateway | The \"cause\" | | | | | Timeout | attribute may | | | | | | be used to | | | | | | indicate the | | | | | | following | | | | | | application | | | | | | errors: | | | | | | | | | | | | - | | | | | | UE_NO | | | | | | T_REACHABLE, | | | | | | if the UE is | | | | | | not reachable | | | | | | to deliver | | | | | | the mobile | | | | | | terminated | | | | | | data; if | | | | | | Estimated | | | | | | Maximum | | | | | | Waiting Time | | | | | | shall be | | | | | | included if | | | | | | available; | | | | | | | | | | | | See table | | | | | | 6.1.7.3-1 for | | | | | | the | | | | | | description | | | | | | of these | | | | | | errors. | +---------------+---+-------------+---------------+---------------+ | NOTE 1: The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the POST | | | | | | method listed | | | | | | in Table | | | | | | 5.2.7.1-1 of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | other than | | | | | | those | | | | | | specified in | | | | | | the table | | | | | | above also | | | | | | apply, with a | | | | | | P | | | | | | roblemDetails | | | | | | data type | | | | | | when needed | | | | | | (see clause | | | | | | 5.2.7 of | | | | | | 3GPP TS 2 | | | | | | 9.500 [4]). | | | | | | | | | | | | NOTE 2: | | | | | | Red | | | | | | irectResponse | | | | | | may be | | | | | | inserted by | | | | | | an SCP, see | | | | | | cl | | | | | | ause 6.10.9.1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4]. | | | | | +---------------+---+-------------+---------------+---------------+
Table 6.1.3.2.4.2.2-3: Headers supported by the 307 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same SMF or | | | | | | SMF (service) | | | | | | set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
Table 6.1.3.2.4.2.2-4: Headers supported by the 308 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same SMF or | | | | | | SMF (service) | | | | | | set. | | | | | | | | | | | | For the case, | | | | | | when a request | | | | | | is redirected | | | | | | to the same | | | | | | target resource | | | | | | via a different | | | | | | SCP, see | | | | | | clause 6.10.9.1 | | | | | | in | | | | | | 3GPP T | | | | | | S 29.500 [4]. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
### 6.1.4 Custom Operations without associated resources
None
### 6.1.5 Notifications
None.
### 6.1.6 Data Model
#### 6.1.6.1 General
This clause specifies the application data model supported by the API.
Table 6.1.6.1-1 specifies the data types defined for the Nsmf_NIDD service
based interface protocol.
Table 6.1.6.1-1: Nsmf_NIDD specific Data Types
Data type Clause defined Description Applicability
* * *
DeliverReqData 6.1.6.2.2 Information within Deliver Request  
DeliverAddInfo 6.1.6.2.3 Deliver Error Response Additional Information  
DeliverError 6.1.6.4.1 Deliver Error Response
Table 6.1.6.1-2 specifies data types re-used by the N~\~ service based
interface protocol from other specifications, including a reference to their
respective specifications and when needed, a short description of their use
within the N~\~ service based interface.
Table 6.1.6.1-2: Nsmf_NIDD re-used Data Types
Data type Reference Comments Applicability
* * *
RefToBinaryData 3GPP TS 29.571 [15] Cross-Reference to binary data encoded
within a binary body part in an HTTP multipart message.  
ProblemDetails 3GPP TS 29.571 [15] Error description  
DurationSec 3GPP TS 29.571 [15] Duration in units of seconds  
RedirectResponse 3GPP TS 29.571 [15] Redirect Response
#### 6.1.6.2 Structured data types
##### 6.1.6.2.1 Introduction
This clause defines the structures to be used in resource representations.
##### 6.1.6.2.2 Type: DeliverReqData
Table 6.1.6.2.2-1: Definition of type DeliverReqData
Attribute name Data type P Cardinality Description Applicability
* * *
mtData RefToBinaryData M 1 This IE shall reference the Mobile Terminated Data
(see clause 6.1.6.5.1).
##### 6.1.6.2.3 Type: DeliverAddInfo
Table 6.1.6.2.3-1: Definition of type DeliverAddInfo
Attribute name Data type P Cardinality Description Applicability
* * *
maxWaitingTime DurationSec C 0..1 This IE shall contain the estimated maximum
wait time (see clause 4.25.5 of 3GPP 23.502 [3]).
#### 6.1.6.3 Simple data types and enumerations
##### 6.1.6.3.1 Introduction
This clause defines simple data types and enumerations that can be referenced
from data structures defined in the previous clauses.
##### 6.1.6.3.2 Simple data types
The simple data types defined in table 6.1.6.3.2-1 shall be supported.
Table 6.1.6.3.2-1: Simple data types
* * *
Type Name Type Definition Description Applicability
* * *
#### 6.1.6.4 Data types describing alternative data types or combinations of
data types
##### 6.1.6.4.1 Type: DeliverError
Table 6.1.6.4.1-1: Definition of type DeliverError as a list of \"to be
combined data types\"
Data type Cardinality Description Applicability
* * *
ProblemDetails 1 Detail information of the problem  
DeliverAddInfo 1 Additional information to be returned in error response.
#### 6.1.6.5 Binary data
##### 6.1.6.5.1 Mobile Terminated Data
Mobile Terminated Data shall encode the Data Contents of the Payload Container
specified in 3GPP TS 24.501 [7], using the vnd.3gpp.5gnas content-type, as
summarized in Table 6.1.6.5.1-1.
Table 6.1.6.5.1-1: Mobile Terminated Data
+----------------------+----------------------+----------------------+ | Mobile Terminated | Reference | Related NAS SM | | Data | | message | | | (3 | | | | GPP TS 24.501 [7]) | | +======================+======================+======================+ | Payload container | 9.11.3.39 | DL NAS Transport | | contents in octets 4 | | | | to n | | | +----------------------+----------------------+----------------------+
### 6.1.7 Error Handling
#### 6.1.7.1 General
For the Nsmf_NIDD API, HTTP error responses shall be supported as specified in
clause 4.8 of 3GPP TS 29.501 [5]. Protocol errors and application errors
specified in table 5.2.7.2-1 of 3GPP TS 29.500 [4] shall be supported for an
HTTP method if the corresponding HTTP status codes are specified as mandatory
for that HTTP method in table 5.2.7.1-1 of 3GPP TS 29.500 [4].
In addition, the requirements in the following clauses are applicable for the
Nsmf_NIDD API.
#### 6.1.7.2 Protocol Errors
No specific procedures for the Nsmf_NIDD service are specified.
#### 6.1.7.3 Application Errors
The common application errors defined in Table 5.2.7.2-1 of 3GPP TS 29.500 [4]
may be used for the Nsmf_NIDD service.
The application errors defined for the Nsmf_NIDD service are listed in Table
6.1.7.3-1.
Table 6.1.7.3-1: Application errors
Application Error HTTP status code Description
* * *
UE_NOT_REACHABLE 504 Gateway Timeout The UE is not reachable for the service.
### 6.1.8 Feature negotiation
The optional features in table 6.1.8-1 are defined for the Nsmf_NIDD API. They
shall be negotiated using the extensibility mechanism defined in clause 6.6 of
3GPP TS 29.500 [4].
Table 6.1.8-1: Supported Features
Feature number Feature Name Description
* * *
### 6.1.9 Security
As indicated in 3GPP TS 33.501 [8] and 3GPP TS 29.500 [4], the access to the
Nsmf_NIDD API may be authorized by means of the OAuth2 protocol (see IETF RFC
6749 [9]), based on local configuration, using the \"Client Credentials\"
authorization grant, where the NRF (see 3GPP TS 29.510 [10]) plays the role of
the authorization server.
If OAuth2 is used, an NF Service Consumer, prior to consuming services offered
by the Nsmf_NIDD API, shall obtain a \"token\" from the authorization server,
by invoking the Access Token Request service, as described in 3GPP TS 29.510
[10], clause 5.4.2.2.
NOTE: When multiple NRFs are deployed in a network, the NRF used as
authorization server is the same NRF that the NF Service Consumer used for
discovering the Nsmf_NIDD service.
The Nsmf_NIDD API defines scopes for OAuth2 authorization as specified in 3GPP
TS 33.501 [15]; it defines a single scope consisting on the name of the
service (i.e., \"nsmf-nidd\"), and it does not define any additional scopes at
resource or operation level.
### 6.1.10 HTTP redirection
An HTTP request may be redirected to a different SMF service instance, within
the same SMF or a different SMF of an SMF set, e.g. when an SMF service
instance is part of an SMF (service) set or when using indirect communications
(see 3GPP TS 29.500 [4]).
An SCP that reselects a different SMF producer instance will return the NF
Instance ID of the new SMF producer instance in the 3gpp-Sbi-Producer-Id
header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [4].
If an SMF within an SMF set redirects a service request to a different SMF of
the set using an 307 Temporary Redirect or 308 Permanent Redirect status code,
the identity of the new SMF towards which the service request is redirected
shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the 307 Temporary
Redirect or 308 Permanent Redirect response as specified in clause 6.10.9.1 of
3GPP TS 29.500 [4].
###### ## Annex A (normative): OpenAPI specification
# A.1 General
This Annex specifies the formal definition of the Nsmf_NIDD Service API. It
consists of OpenAPI 3.0.0 specifications, in YAML format.
This Annex takes precedence when being discrepant to other parts of the
specification with respect to the encoding of information elements and methods
within the API(s).
NOTE: The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
Informative copies of the OpenAPI specification files contained in this 3GPP
Technical Specification are available on a Git-based repository, that uses the
GitLab software version control system (see 3GPP TS 29.501 [5] clause 5.3.1
and 3GPP TR 21.900 [7] clause 5B).
# A.2 Nsmf_NIDD API
openapi: 3.0.0
info:
version: \'1.2.0-alpha.1\'
title: \'Nsmf_NIDD\'
description: \|
SMF NIDD Service.
© 2022, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
externalDocs:
description: 3GPP TS 29.542 V18.0.0; 5G System; Session Management Services
for Non-IP Data Delivery (NIDD); Stage 3
url: https://www.3gpp.org/ftp/Specs/archive/29_series/29.542/
servers:
\- url: \'{apiRoot}/nsmf-nidd/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in clause 4.4 of 3GPP TS 29.501.
security:
\- {}
\- oAuth2ClientCredentials:
\- nsmf-nidd
paths:
\'/pdu-sessions/{pduSessionRef}/deliver\':
post:
summary: Delivery Service Operation
tags:
\- Individual PDU session
operationId: Deliver
parameters:
\- name: pduSessionRef
in: path
description: PDU session reference
required: true
schema:
type: string
requestBody:
description: representation of the payload of Deliver Request
required: true
content:
multipart/related: # message with a binary body part
schema:
type: object
properties:
jsonData:
\$ref: \'#/components/schemas/DeliverReqData\'
binaryMtData:
type: string
format: binary
encoding:
jsonData:
contentType: application/json
binaryMtData:
contentType: application/vnd.3gpp.5gnas
headers:
Content-Id:
schema:
type: string
responses:
\'204\':
description: successful transfering of Delivery
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'502\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/502\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
\'504\':
description: unsuccessful delivery of mobile terminated data - gateway timeout
content:
application/json:
schema:
\$ref: \'#/components/schemas/DeliverError\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
components:
securitySchemes:
oAuth2ClientCredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
nsmf-nidd: Access to the nsmf-nidd API
schemas:
#
# STRUCTURED DATA TYPES
#
DeliverReqData:
description: Representation of the payload of a Deliver Request.
type: object
properties:
mtData:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/RefToBinaryData\'
required:
\- mtData
DeliverAddInfo:
description: Additional information in an error response to a Deliver Request.
type: object
properties:
maxWaitingTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\'
#
# DATA TYPES DESCRIBING ALTERNATIVE OR COMBINATION OF DATA TYPES
#
DeliverError:
description: Representation of the payload in an error response to a Deliver
Request.
allOf:
\- \$ref: \'TS29571_CommonData.yaml#/components/schemas/ProblemDetails\'
\- \$ref: \'#/components/schemas/DeliverAddInfo\'
#