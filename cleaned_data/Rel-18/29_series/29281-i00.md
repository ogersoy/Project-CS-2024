# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document defines the user plane of GTP used on:
\- the Gn and Gp interfaces of the General Packet Radio Service (GPRS);
\- the Iu, Gn and Gp interfaces of the UMTS system;
\- the S1-U, S11-U, S2a, S2b, X2, S4, S5, S8, S12, M1 and Sn interfaces of the
Evolved Packet System (EPS);
\- the F1-U, Xn, W1-U, N3, N9, N19, N3mb and N19mb interfaces of the 5G System
(5GS).
This definition ensures full backwards compatibility with RNC, SGSN and GGSN
implementations according to release 7 of 3GPP TS 29.060 [6].
NOTE: Releases previous to Release-8 have used 3GPP TS 29.060 [6] as normative
definition of the user plane of GTP. This shall be considered when essential
corrections are included in the present document or in pre-release-8 version
of 3GPP TS 29.060 [6].
Fallback from GTPv1-U to GTPv0-U shall not be supported. Therefore, 3GPP Rel-8
and onwards GTPv1-U entity should not listen to the well-known GTPv0 port
3386. If GTPv1 entity listens to the GTPv0 port, the entity shall silently
discard any received GTPv0-U message.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[3] 3GPP TS 23.007: \"Restoration procedures\".
[4] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[5] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[6] 3GPP TS 29.060: \"General Packet Radio Service (GPRS); GPRS Tunnelling
Protocol (GTP) across the Gn and Gp interface\".
[7] 3GPP TS 29.274: \"3GPP Evolved Packet System; Evolved GPRS Tunnelling
Protocol for EPS (GTPv2)\".
[8] 3GPP TS 32.295: \"Telecommunication management; Charging management;
Charging Data Record (CDR) transfer\".
[9] IETF RFC 768 (STD 0006): \"User Datagram Protocol\", J. Postel.
[10] IETF RFC 791 (STD 0005): \"Internet Protocol\", J. Postel.
[11] IETF RFC 4291: \"IP Version 6 Addressing Architecture\".
[12] 3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network
layer security\".
[13] 3GPP TS 23.121: \"Architectural requirements for Release 1999\".
[14] 3GPP TS 43.129: \"Packet-switched handover for GERAN A/Gb mode; Stage
2\".
[15] IETF RFC 2460: \"Internet Protocol, Version 6 (IPv6) Specification\".
[16] 3GPP TS 25.413: \"UTRAN Iu interface RANAP signalling\".
[17] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall
description; Stage 2\".
[18] 3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS);
Architecture and functional description; Stage 2\".
[19] IETF RFC 4604 (2006): \"Using Internet Group Management Protocol Version
3 (IGMPv3) and Multicast Listener Discovery Protocol Version 2 (MLDv2) for
Source-Specific Multicast\".
[20] IETF RFC 4607 (2006): \"Source-Specific Multicast for IP\".
[21] 3GPP TS 33.102: \"3G Security; Security architecture\".
[22] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE): Security
architecture \".
[23] 3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".
[24] 3GPP TS 36.323: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Packet Data Convergence Protocol (PDCP) specification\".
[25] 3GPP TS 36.425: \"E-UTRAN X2 interface user plane protocol\".
[26] IETF RFC 2474, \"Definition of the Differentiated Services Field (DS
Field) in the IPv4 and IPv6 Headers\".
[27] 3GPP TS 36.465: \"Evolved Universal Terrestrial Radio Access (E-UTRAN)
and Wireless LAN (WLAN) Xw interface user plane protocol\".
[28] 3GPP**** TS**** 23.501: \"System Architecture for the 5G System; Stage
2\".
[29] 3GPP**** TS**** 23.502: \"Procedures for the 5G System; Stage 2\".
[30] 3GPP**** TS**** 38.425: \"NG-RAN; NR user plane protocol\".
[31] 3GPP**** TS**** 38.415: \"NG-RAN; PDU Session User Plane Protocol\".
[32] 3GPP TS 33.250: \"Security assurance specification for the PGW network
product class\".
[33] 3GPP TS 23.527: \"5G System; Restoration Procedures\".
[34] 3GPP TS 38.300: \"NR; NR and NG-RAN Overall Description; Stage 2\".
[35] 3GPP TS 38.323: \"NR; Packet Data Convergence Protocol (PDCP)
specification\".
[36] IETF RFC 8200: \"Internet Protocol, Version 6 (IPv6) Specification\"
[37] IETF RFC 6437: \"IPv6 Flow Label Specification\".
[38] 3GPP**** TS**** 37.340: \"Evolved Universal Terrestrial Radio Access
(E-UTRA) and NR; Multi-connectivity; Stage 2\".
[39] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
Nodes\".
[40] 3GPP TS 23.247: \"Architectural enhancements for 5G multicast-broadcast
services\".
[41] IETF RFC 5905: \"Network Time Protocol Version 4: Protocol and Algorithms
Specification\".
[42] 3GPP TS 37.470: \"W1 interface; General aspects and principles\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**Common Tunnel Endpoint Identifier (C-TEID):** Unambiguously identifies a
tunnel endpoint in the receiving GTP-U protocol entity for a given UDP/IP
endpoint. The sending end side of a GTP tunnel locally assigns the C-TEID
value used in the TEID field and signals it to the destination Tunnel Endpoint
using a control plane message.
**GTP-U Message:** GTP-U (user plane) messages are either user plane messages
or signalling messages. User plane messages are used to carry user data
packets between GTP-U entities. Signalling messages are sent between network
nodes for path management and tunnel management.**GTP-U peer:** node
implementing at least one side of any of the GTP user plane based protocols.
RNC, SGSN, GGSN, eNodeB, SGW, ePDG, gNB, N3IWF, UPF, PGW or TWAN or MME.
**GTP-U Tunnel:** A GTP-U tunnel is identified in each node with a TEID, an IP
address and a UDP port number. A GTP-U tunnel is necessary to enable
forwarding packets between GTP-U entities.
**GTP-U Tunnel Endpoint** : A GTP-U tunnel endpoint identifies a user plane
context (e.g EPS bearer, PDU session or a RAB) for which a received GTP-U
packet is intended. A given GTP-U tunnel endpoint may receive GTP-U packets
from more than one source GTP-U peer (See clause 4.3.0).**UDP/IP Path:**
Connection-less unidirectional or bidirectional path defined by two end-
points. An IP address and a UDP port number define an end-point. A UDP/IP path
carries GTP messages between network nodes related to one or more GTP tunnels.
**GTP-PDU:** GTP Protocol Data Unit (PDU) is a GTP-U message, which may be
either a G-PDU or a signalling message.
**G-PDU:** User data packet (T-PDU) plus GTP-U header, sent between GTP
network nodes.
**Signalling Message:** A GTP-U message (GTP-PDU that is not a G-PDU) sent
between GTP network nodes. These may be Path Management messages or Tunnel
Management messages.
**T-PDU:** A user data packet, for example an IP datagram, sent between a UE
and a network entity in an external packet data network. A T-PDU is the
payload that is tunnelled in the GTP-U tunnel.
**Tunnel Endpoint Identifier (TEID):** Unambiguously identifies a tunnel
endpoint in the receiving GTP-U protocol entity for a given UDP/IP endpoint.
The receiving end side of a GTP tunnel locally assigns the TEID value the
transmitting side has to use. The TEID values are exchanged between tunnel
endpoints using control plane message.
**Trusted WLAN Access Network** : see 3GPP TS 23.402 [23].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
C-TEID Common Tunnel Endpoint IDentifier
EN-DC E-UTRA-NR Dual Connectivity
ePDG Evolved Packet Data Gateway
GSN GPRS Support Node
GGSN Gateway GPRS Support Node
G-PDU GTP encapsulated user Plane Data Unit
GTP GPRS Tunnelling Protocol
GTP-C GTP Control
GTP-U GTP User
IE Information Element
IGMP Internet Group Management Protocol
IP Internet Protocol
IPv4 Internet Protocol version 4
IPv6 Internet Protocol version 6
MME Mobility Management Entity
PDU Packet Data Unit
PGW PDN Gateway
QoS Quality of Service
RANAP Radio Access Network Application Part
RNC Radio Network Controller
SGSN Serving GPRS Support Node
SGW Serving Gateway
TEID Tunnel Endpoint IDentifier
T-PDU Transport PDU
TWAN Trusted WLAN Access Network
UDP User Datagram Protocol
UTRAN UMTS Terrestrial Radio Access Network
# 4 General
## 4.1 GTP Path
For the definition of UDP/IP Path and GTP Endpoint, see 3GPP TS 29.060 [6].
## 4.2 GTP-U Tunnels
### 4.2.1 GTP-U Tunnel description
GTP-U Tunnels are used to carry encapsulated T-PDUs and signalling messages
between a given pair of GTP-U Tunnel Endpoints. The Tunnel Endpoint ID (TEID)
which is present in the GTP header shall indicate which tunnel a particular
T-PDU belongs to. In this manner, packets are multiplexed and de-multiplexed
by GTP-U between a given pair of Tunnel Endpoints. The TEID value to be used
in the TEID field shall be signalled to the peer GTP-U entity using a control
plane protocol like GTPv1-C, GTPv2-C, RANAP or S1-AP.
In what follows we refer to the outer GTPv1-U IP packet as the IP packet that
carries a GTPv1-U packet. The inner IP packet in a GTPv1-U packet (T-PDU) is
either
\- An IP packet sent to the UE/MS in the downlink direction over one or more
tunnels from the external network identified by the APN.
\- An IP packet sent from a UE/MS in the uplink direction over one or more
tunnels to the external network identified by the APN.
NOTE 1: Not all tunnels in 3GPP networks will necessarily be GTPv1-U,
NOTE 2: The inner MTU size of the GTPv1-U tunnel is typically not the same as
the outer MTU size of the IP path carrying the outer IP packets.
The maximum size of a T-PDU that may be transmitted without fragmentation by
GGSN or the MS is defined in 3GPP TS 23.060 [4].
### 4.2.2 IP transport
According to IETF RFC 791 [10], any IPv4 router in the backbone may fragment
the outer IPv4 GTPv1-U packet with a flag of DF=0.
Unnecessary fragmentation should be avoided when possible due to the
following;
\- Fragmentation is bandwidth inefficient, since the complete IP header is
duplicated in each fragment.
\- Fragmentation is CPU intensive since more fragments require more processing
at both GTPv1-U endpoints and IP routers. It also requires additional memory
at the receiver.
\- If one fragment is lost, the complete packet has to be discarded. The
reason is there is no selective retransmission of IP fragments provided in
IPv4 or IPv6.
Recommendations on how to set the default inner MTU size at the PDN GW and
UE/MS to avoid IP fragmentation of both inner IP packets (in the PDN GW or
UE/MS) and outer IP packets in the backbone are specified in clause 9.3 of
3GPP TS 23.060 [4].
### 4.2.3 GTP-U Tunnel IP transport
**Functionality for IP transport and IP fragmentation at a RAN node on the Iu
interface or S12 is defined in** 3GPP TS 25.414 **[16].**
**Functionality for IP transport and IP fragmentation at an eNodeB on the S1-U
and X2 interface is defined in** 3GPP TS 36.300 **[17].**
**Functionality for IP transport and IP fragmentation at an NG-RAN on the N3
and Xn interface is defined in** 3GPP TS 38.300 **[34].**
**Functionality for IP transport and IP fragmentation** for interconnecting an
ng-eNB-CU and an ng-eNB-DU of an ng-eNB within an NG-RAN **on the W1-U
interface is defined in** 3GPP TS 37.470 **[42].**
The outer GTPv1-U packet layer shall support IPv4 as defined by IETF RFC 791
[10] and should support IPv6 as defined by IETF RFC 8200 [36].
The following text as well as clauses 4.2.4 and 4.2.5 apply only to core
network GTPv1-U endpoints.
GTPv1-U tunnel endpoints do not need to change the hopcount/TTL or to perform
any IP routing functions in respect to inner IP packet other than the
functions explicitly stated here. However, other co-located functions may do
so. For example, the GGSN/PGW/UPF may change the hopcount/TTL as the IP
datagram enters/leaves the Gi/SGi/N6 interface from/to the GTPv1-U tunnel
interface and IP packets may be discarded or rejected at any point by a co-
located function due to local policy and/or QoS (the policy enforcement
point).
### 4.2.4 Ingress GTP tunnel (GTPv1-U sending endpoint)
An inner IP packet shall be encapsulated at the GTPv1-U sender with a GTP
header, UDP and IP header. If the resulting outer IP packet is larger than the
MTU of the first link towards the destination GTPv1-U endpoint, fragmentation
of the IP packet shall be performed by the sender as per IETF RFC 791 [10] for
an outer layer of IPv4 and IETF RFC 8200 [36] for an outer layer of IPv6. The
GTPv1-U sender should preferably fragment the IP packet to the smallest MTU of
any link between GTPv1-U sender and GTPv1-U receiver.
Fragmentation policy of the inner datagram is implementation dependent but
shall interwork with IETF RFC 791 [10] for inner IPv4 datagrams and IETF RFC
8200 [36] for inner IPv6 packets.
### 4.2.5 Egress GTP tunnel (GTPv1-U receiving endpoint)
The GTPv1-U receiving endpoint packets shall reassemble any IP fragments in
datagrams received from the GTPv1-U sending endpoint as per IETF RFC 791 [10]
for outer IPv4 datagrams and as per IETF RFC 8200 [36] for outer IPv6
datagrams. The IP reassembly buffer in the receiving endpoint shall be at
least the inner MTU size plus the size of the tunnel headers (outer IP header,
outer UDP header, and GTP header, including any GTP extension headers).
The completely reassembled IP packet shall then be passed to the
IP/UDP/GTPv1-U layers to extract the inner IP packet which is then processed
further according to the receiving node\'s functionality.
### 4.2.6 IP Multicast Distribution of User Plane Data for MBMS and MBS
#### 4.2.6.1 General
In GPRS and EPS, MBMS data may be delivered between the GGSN and RNC, or
between the MBMS GW and the eNodeB or RNC, using IP multicast transport, as
specified in clause 6.5 of 3GPP TS 23.246 [18].
In 5GS, MBS data may be delivered between the 5GC and NG-RAN using 5GC
Individual MBS traffic delivery (applicable only to multicast MBS sessions)
and/or 5GC Shared MBS traffic delivery (applicable to broadcast and multicast
MBS sessions), as specified in clause 4.1 of 3GPP TS 23.247 [40]. The user
plane from the MB-UPF to NG-RANs (for 5GC Shared MBS traffic delivery) and the
user plane from the MB-UPF to UPFs (for 5GC Individual MBS traffic delivery)
may use IP multicast transport via a common GTP-U tunnel per MBS session, or
use unicast transport via separate GTP-U tunnels at NG-RAN or at UPF per MBS
session, as specified in clause 6.7 of 3GPP TS 23.247 [40].
Specific requirements for IP multicast distribution of user plane data are
specified in clause 4.2.6.2.
#### 4.2.6.2 IP multicast distribution of User Plane Data
When using IP multicast transport, GTP-U Multicast Tunnels shall be used for
unidirectional transfer of the encapsulated T-PDUs from one GTP-U Tunnel
Endpoint acting as an IP multicast source to multiple GTP-U Tunnel Endpoints
acting as IP multicast listeners. The Common Tunnel Endpoint ID (C-TEID) which
is present in the GTP header shall indicate which tunnel a particular T-PDU
belongs to. The C-TEID value to be used in the TEID field shall be allocated
at the source Tunnel Endpoint and signalled to the destination Tunnel Endpoint
using a control plane protocol, i.e. GTPv1-C and RANAP, GTPv2-C and S1-AP, 5GC
SBIs and/or NGAP. One C-TEID shall be allocated per MBMS bearer service or per
MBS session.
The destination IP address in the outer GTPv1-U IP header shall be an address
in the multicast address range as specified in IETF RFC 4607 [20].
If the RNC decides to receive IP multicast packets, then the RNC shall join
the IP multicast group as specified by IETF RFC 4604 [19] and IETF RFC 4607
[20].
If the eNodeB supports MBMS as specified in 3GPP TS 23.246 [18], it shall join
the IP multicast group as specified in IETF RFC 4604 [19] and IETF RFC 4607
[20].
If the gNB supports MBS as specified in 3GPP TS 23.247 [40], it shall join the
IP multicast group as specified in IETF RFC 4604 [19] and IETF RFC 4607 [20].
The characteristics for point-to-multipoint GTP-U Multicast Tunnels used for
MBMS or MBS are the same as for a point-to-point GTP-U Tunnels unless
specified otherwise. The differences are specified in clause 7.1.
## 4.3 GTP-U Protocol Entity
### 4.3.0 General
The GTP-U protocol entity provides packet transmission and reception services
to user plane entities in the RNC, SGSN, GGSN, eNodeB, SGW, ePDG, PGW, TWAN,
MME, gNB, N3IWF, UPF and MB-UPF. The GTP-U protocol entity receives traffic
from a number of GTP-U tunnel endpoints and transmits traffic to a number of
GTP-U tunnel endpoints. There is a GTP-U protocol entity per IP address.
The TEID in the GTP-U header is used to de-multiplex traffic incoming from
remote tunnel endpoints so that it is delivered to the User plane entities in
a way that allows multiplexing of different users, different packet protocols
and different QoS levels. The GTP-U protocol supports the possibility for one
GTP-U tunnel endpoint to receive packets from multiple remote GTP-U endpoints.
This may be used in the following scenarios:
\- Tracking Area Update procedure with Serving GW change and data forwarding
as specified in clause 5.3.3.1A of 3GPP TS 23.401 [5], if the above capability
is supported by the receiving eNB;
\- Dual connectivity in 5GC as specified in clause 5.11.1 of 3GPP TS 23.501
[28], where the master and secondary NG-RAN may be assigned the same uplink
F-TEID of the UPF by the SMF for uplink traffic of the same PDU session; and
\- IPv6 multihoming scenario as specified in clause 5.6.4.3 of 3GPP TS 23.501
[28], where the downlink traffic from multiple PDU Session Anchors of the same
PDU session may be assigned the same N9 F-TEID of the branching point UPF by
the SMF.
### 4.3.1 Handling of Sequence Numbers
This functionality is provided only when the S bit is set to 1 in the GTP-U
header.
For PGW, SGW, ePDG, eNodeB, TWAN, MME, gNB, N3IWF, and UPF, the usage of
sequence numbers in G-PDUs is optional, but if GTP-U protocol entities in
these nodes are relaying G-PDUs to other nodes, then they shall relay the
sequence numbers as well For all other cases, the PGW, SGW, ePDG, eNodeB,
TWAN, MME, gNB, N3IWF and UPF should set the \"S\" flag to 0 in the GTPv1
header which then indicates that the sequence number is not used in the T-PDU.
An RNC, SGSN or GGSN shall reorder out of sequence T-PDUs when in sequence
delivery is required. This is optional at the SGSN for UTRAN access. The GTP-U
protocol entity shall deliver to the user plane entity only in sequence T‑PDUs
and notify the sequence number associated to each of them. The notification of
the sequence number is not necessary at the GGSN, but it is mandatory at the
SGSN and RNC. The user plane entity shall provide a sequence number to the
GTP-U layer together with T-PDUs to be transmitted in sequence. GTP-U protocol
entities at the GGSN may optionally generate autonomously the sequence number,
but should be able to use sequence numbers provided by the user plane entity.
The sequence number is handled on a per GTP-U Tunnel (that is TEID) basis.
During relocations and handovers, if a buffered packet is forwarded from the
source to the target GTP-U protocol entity along with PDCP T-PDU extension
headers, the source of the T-PDU may be considered different and may not relay
the sequence numbers.
When the sequence number is included in the GTP-U header, a user plane entity
acting as a relay of T-PDUs between GTP-U protocol entities, or between PDCP
(or SNDCP) protocol entities and GTP-U protocol entities, shall relay the
sequence numbers between those entities as well. In this way it is possible to
keep consistent values of sequence numbers from the GGSN to the UE (MS in
GPRS) by relaying the sequence number across the CN GTP-U bearer, the Iu GTP-U
bearer and the Radio bearer (via PDCP or SNDCP N-PDU numbers). This
functionality is beneficial during SRNS relocation.
For GTP-U signalling messages having a response message defined for a request
message, Sequence Number shall be a message number valid for a path. Within a
given set of continuous Sequence Numbers from 0 to 65535, a given Sequence
Number shall, if used, unambiguously define a GTP-U signalling request message
sent on the path (see clause Reliable delivery of signalling messages). The
Sequence Number in a signalling response message shall be copied from the
signalling request message that the GTP-U entity is replying to. For GTP-U
messages not having a defined response message for a request message, i.e. for
messages Supported Extension Headers Notification and Error Indication, the
Sequence Number shall be ignored by the receiver.
## 4.4 Protocol stack
### 4.4.0 GTP-PDU Stacks
The protocol stack for a GTP-PDU G-PDU is shown in Figure 4.4-1. The protocol
stack for a GTP-PDU signaling message is shown in Figure 4.4-2.
Figure: 4.4-1 G-PDU Protocol Stack
NOTE: T-PDU may contain an IP Datagram, Ethernet or unstructured PDU Data
frames as specified in 3GPP TS 23.501 [28].
Figure: 4.4-2 Signalling Message Protocol Stack
### 4.4.1 UDP/IP
UDP/IP is the only path protocol defined to transfer GTP messages in the
version 1 of GTP.
A GTPv1-U peer shall support the User Datagram Protocol (UDP) as defined by
IETF RFC 768 [9] shall be used.
A GTPv1-U peer shall support IPv4 as defined by IETF RFC 791 [10] and should
support IPv6 as defined by IETF RFC 8200 [36].
The DSCP marking as defined by IETF RFC 2474 [26] shall be set:
\- based on the QCI, and optionally the ARP priority level, of the associated
EPS bearer, as described in clause 4.7.3 of 3GPP TS 23.401 [5];
\- based on the 5QI and ARP of the associated 5G QoS Flow, as described in
clause 5.7.1.6 and clause 5.7.1.7 of 3GPP TS 23.501 [28].
### 4.4.2 UDP header and port numbers
#### 4.4.2.0 General
For the GTP-U messages described below (other than the Echo Response message,
see clause 4.4.2.2), the UDP Source Port or the Flow Label field (see IETF RFC
6437 [37]) should be set dynamically by the sending GTP-U entity to help
balancing the load in the transport network.
When using GTP-U over IPv6 (see IETF RFC 8200 [36]), the UDP checksum shall
not be set to zero by the sending GTP-U entity unless it is ensured that the
peer GTP-U entity and the path in-between supports UDP zero checksum.
NOTE 1: GTP-U entities complying with an earlier version of the specification
or on path IPv6 middleboxes can implement IPv6 as specified in IETF RFC 2460
[15] and discard UDP packets containing a zero checksum.
NOTE 2: How a sending GTP-U entity knows whether the peer GTP-U entity and the
path in-between supports UDP zero checksum is out of scope of this
specification.
#### 4.4.2.1 Echo Request Message
The UDP Destination Port number for GTP-U request messages is 2152. It is the
registered port number for GTP-U.
#### 4.4.2.2 Echo Response Message
The UDP Destination Port value shall be the value of the UDP Source Port of
the corresponding request message.
The UDP Source Port shall be the value from the UDP Destination Port of the
corresponding request message.
#### 4.4.2.3 Encapsulated T-PDUs
The UDP Destination Port number shall be 2152. It is the registered port
number for GTP-U.
#### 4.4.2.4 Error Indication
The UDP destination port for the Error Indication shall be the user plane UDP
port (2152).
NOTE: In network deployments including non-GTP-aware stateful firewalls, those
firewalls must be configured to allow response messages coming from a
different UDP port and IP address than the triggering message.
#### 4.4.2.5 Supported Extension Headers Notification
The UDP destination port for the Supported Extension Headers Notification
shall be the user plane UDP port (2152).
#### 4.4.2.6 End Marker
The UDP Destination Port number shall be 2152. It is the registered port
number for GTP-U.
The UDP Destination Port and UDP Source Port shall be the same as those of the
corresponding GTP-U tunnel for which the End Marker message is sent.
#### 4.4.2.7 Tunnel Status
The UDP destination port for the Tunnel Status shall be the user plane UDP
port (2152).
### 4.4.3 IP header and IP addresses
#### 4.4.3.1 Echo Request Message
The IP Source Address shall be an IP address of the source GTP-U entity from
which the message is originating.
The IP Destination Address in a GTP request message shall be an IP address of
the destination GTP-U entity.
#### 4.4.3.2 Echo Response Message
The IP Source Address shall be copied from the IP destination address of the
GTP request message to which this GTP‑U entity is replying.
The IP Destination Address shall be copied from the IP Source Address of the
GTP request message to which this GTP‑U entity is replying.
#### 4.4.3.3 Encapsulated T-PDUs
The IP Source Address shall be an IP address of the source GTP-U entity from
which the message is originating.
The IP Destination Address shall be an IP address of the destination GTP-U
entity.
#### 4.4.3.4 Error Indication
The IP source address shall be an address of the source GTP-U entity from
which the message is originated
NOTE: In network deployments including non-GTP-aware stateful firewalls, those
firewalls must be configured to allow response messages coming from a
different UDP port and IP address than the triggering message.
The IP destination address for Error Indication shall be the source address of
the GTP-PDU that is the cause for this GTP-U entity to send this message.
#### 4.4.3.5 Supported Extension Headers Notification
The IP Source Address for the Supported Extension Headers Notification shall
be copied from the IP destination address of the GTP message that triggered
the GTP-U entity to send this message.
The IP Destination Address for the Supported Extension Headers Notification
shall be copied from the IP source address of the GTP message that triggered
the GTP-U entity to send this message.
#### 4.4.3.6 End Marker
The IP Source Address shall be an IP address of the source GTP-U entity from
which the message is originating.
The IP Destination Address shall be an IP address of the destination GTP-U
entity.
The IP Destination Address and IP Source Address shall be the same as those of
the corresponding GTP-U tunnel for which the End Marker message is sent.
#### 4.4.3.7 Tunnel Status
The IP Source Address shall be an IP address of the source GTP-U entity from
which the message is originating.
The IP Destination Address shall be an IP address of the destination GTP-U
entity.
The IP Destination Address and IP Source Address shall be the same as the
corresponding GTP-U tunnel (to send G-PDU) for which the Tunnel Staus message
is sent.
## 4.5 Transmission Order and Bit Definitions
As specified in 3GPP TS 29.060 [6], clause 5.
## 4.6 New Functionality
With regard to the previous releases, the present specification may define
some new functions. Such new functions shall ensure full backwards
compatibility with Pre-Rel-8 nodes conforming to 3GPP TS 29.060 [6]. If the
new functions are specified with the Extension Headers, bits 8 and 7 of the
Extension Header Type shall be set to 0, 0 respectively or 0, 1 respectively.
If the new functions are specified with Information Elements, such Information
Elements shall be TLV-encoded and optional.
# 5 GTP-U header
## 5.1 General format
The GTP-U header is a variable length header whose minimum length is 8 bytes.
There are three flags that are used to signal the presence of additional
optional fields: the PN flag, the S flag and the E flag. The PN flag is used
to signal the presence of N-PDU Numbers. The S flag is used to signal the
presence of the GTP Sequence Number field. The E flag is used to signal the
presence of the Extension Header field, used to enable future extensions of
the GTP header defined in this document, without the need to use another
version number. If and only if one or more of these three flags are set, the
fields Sequence Number, N-PDU and Extension Header shall be present. The
sender shall set all the bits of the unused fields to zero. The receiver shall
not evaluate the unused fields. For example, if only the E flag is set to 1,
then the N-PDU Number and Sequence Number fields shall also be present, but
will not have meaningful values and shall not be evaluated.
**Always present fields:**
\- Version field: This field is used to determine the version of the GTP-U
protocol. The version number shall be set to \'1\'.
\- Protocol Type (PT): This bit is used as a protocol discriminator between
GTP (when PT is \'1\') and GTP\' (when PT is \'0\'). GTP is described in this
document and the GTP\' protocol in 3GPP TS 32.295 [8]. Note that the
interpretation of the header fields may be different in GTP\' than in GTP.
\- Extension Header flag (E): This flag indicates the presence of a meaningful
value of the Next Extension Header field. When it is set to \'0\', the Next
Extension Header field either is not present or, if present, shall not be
interpreted. When it is set to \'1\', the Next Extension Header field is
present, and shall be interpreted, as described below in this clause.
\- Sequence number flag (S): This flag indicates the presence of a meaningful
value of the Sequence Number field. When it is set to \'0\', the Sequence
Number field either is not present or, if present, shall not be interpreted.
When it is set to \'1\', the Sequence Number field is present, and shall be
interpreted, as described below in this clause.\ For the Echo Request, Echo
Response, Error Indication and Supported Extension Headers Notification
messages, the S flag shall be set to \'1\'. Since the use of Sequence Numbers
is optional for G-PDUs, the PGW, SGW, ePDG, eNodeB and TWAN should set the
flag to \'0\'. However, when a G-PDU (T-PDU+header) is being relayed by the
Indirect Data Forwarding for Inter RAT HO procedure, then if the received
G-PDU has the S flag set to \'1\', then the relaying entity shall set S flag
to \'1\' and forward the G-PDU (T-PDU+header). In an End marker and Tunnel
Status messages the S flag shall be set to \'0\'.
\- N-PDU Number flag (PN): This flag indicates the presence of a meaningful
value of the N-PDU Number field. When it is set to \'0\', the N-PDU Number
field either is not present, or, if present, shall not be interpreted. When it
is set to \'1\', the N-PDU Number field is present, and shall be interpreted,
as described below in this clause.
\- Message Type: This field indicates the type of GTP-U message.
\- Length: This field indicates the length in octets of the payload, i.e. the
rest of the packet following the mandatory part of the GTP header (that is the
first 8 octets). The Sequence Number, the N-PDU Number or any Extension
headers shall be considered to be part of the payload, i.e. included in the
length count.
\- Tunnel Endpoint Identifier (TEID): This field unambiguously identifies a
tunnel endpoint in the receiving GTP‑U protocol entity. The receiving end side
of a GTP tunnel locally assigns the TEID value the transmitting side has to
use. The TEID value shall be assigned in a non-predictable manner for PGW
S5/S8/S2a/S2b interfaces (see 3GPP TS 33.250 [32]). The TEID shall be used by
the receiving entity to find the PDP context, except for the following cases:
\- The Echo Request/Response and Supported Extension Headers notification
messages, where the Tunnel Endpoint Identifier shall be set to all zeroes.
\- The Error Indication message where the Tunnel Endpoint Identifier shall be
set to all zeros.
\- When setting up a GTP-U tunnel, the GTP-U entity shall not assign the value
\'all zeros\' to its own TEID. However, for backward compatibility, if a GTP-U
entity receives (via respective control plane message) a peer\'s TEID that is
set to the value \'all zeros\', the GTP-U entity shall accept this value as
valid and send the subsequent G-PDU with the TEID field in the header set to
the value \'all zeros\'.
**Optional fields:**
\- Sequence Number: If Sequence Number field is used for G-PDUs
(T-PDUs+headers), an increasing sequence number for T-PDUs is transmitted via
GTP-U tunnels, when transmission order must be preserved. For Supported
Extension Headers Notification and Error Indication messages, the Sequence
Number shall be ignored by the receiver, even though the S flag is set to
\'1\'.
\- N-PDU Number: This field is used at the Inter SGSN Routeing Area Update
procedure and some inter-system handover procedures (e.g. between 2G and 3G
radio access networks). This field is used to co-ordinate the data
transmission for acknowledged mode of communication between the MS and the
SGSN. The exact meaning of this field depends upon the scenario. (For example,
for GSM/GPRS to GSM/GPRS, the SNDCP N-PDU number is present in this field).
\- Next Extension Header Type: This field defines the type of Extension Header
that follows this field in the GTP‑PDU.
* * *
              Bits
Octets 8 7 6 5 4 3 2 1 1 Version PT (*) E S PN  
2 Message Type  
3 Length (1^st^ Octet)  
4 Length (2^nd^ Octet)  
5 Tunnel Endpoint Identifier (1^st^ Octet)  
6 Tunnel Endpoint Identifier (2^nd^ Octet)  
7 Tunnel Endpoint Identifier (3^rd^ Octet)  
8 Tunnel Endpoint Identifier (4^th^ Octet)  
9 Sequence Number (1^st^ Octet)^1)\ 4)^  
10 Sequence Number (2^nd^ Octet)^1)^ ^4)^  
11 N-PDU Number^2)\ 4)^  
12 Next Extension Header Type^3)\ 4)^
* * *
NOTE 0: (*) This bit is a spare bit. It shall be sent as \'0\'. The receiver
shall not evaluate this bit.
NOTE 1: 1) This field shall only be evaluated when indicated by the S flag set
to 1.
NOTE 2: 2) This field shall only be evaluated when indicated by the PN flag
set to 1.
NOTE 3: 3) This field shall only be evaluated when indicated by the E flag set
to 1.
NOTE 4: 4) This field shall be present if and only if any one or more of the
S, PN and E flags are set.
Figure 5.1-1: Outline of the GTP-U Header
## 5.2 GTP-U Extension Header
### 5.2.1 General format of the GTP-U Extension Header
The format of GTP-U Extension Headers is depicted in figure 5.2.1-1. The
Extension Header Length field specifies the length of the particular Extension
header in 4 octets units. The Next Extension Header Type field specifies the
type of any Extension Header that may follow a particular Extension Header. If
no such Header follows, then the value of the Next Extension Header Type shall
be 0.
* * *
Octets 1 Extension Header Length 2 -- m Extension Header Content m+1 Next
Extension Header Type
* * *
Figure 5.2.1-1: Outline of the Extension Header Format
The length of the Extension header shall be defined in a variable length of 4
octets, i.e. m+1 = n*4 octets, where n is a positive integer.
Bits 7 and 8 of the Next Extension Header Type define how the recipient shall
handle unknown Extension Types, see Figure 5.2.1-2. The recipient of an
extension header of unknown type but marked as \'comprehension not required\'
for that recipient shall read the \'Next Extension Header Type\' field (using
the Extension Header Length field to identify its location in the GTP-PDU).
The recipient of an extension header of unknown type, but marked as
\'comprehension required\' for that recipient, shall:
\- If the message with the unknown extension header was a request or a G-PDU,
send a Supported Extension Headers Notification to the originator of the GTP-
PDU, discard the message and log an error.
Bits 7 and 8 of the Next Extension Header Type have the following meaning:
+------+--------------------------------------------------------------+ | Bits | Meaning | | | | | 8 7 | | +------+--------------------------------------------------------------+ | 0 0 | Comprehension of this extension header is not required. An | | | Intermediate Node shall forward it to any Receiver Endpoint | +------+--------------------------------------------------------------+ | 0 1 | Comprehension of this extension header is not required. An | | | Intermediate Node shall discard the Extension Header Content | | | and not forward it to any Receiver Endpoint. Other extension | | | headers shall be treated independently of this extension | | | header. | +------+--------------------------------------------------------------+ | 1 0 | Comprehension of this extension header is required by the | | | Endpoint Receiver but not by an Intermediate Node. An | | | Intermediate Node shall forward the whole field to the | | | Endpoint Receiver. | +------+--------------------------------------------------------------+ | 1 1 | Comprehension of this header type is required by recipient | | | (either Endpoint Receiver or Intermediate Node) | +------+--------------------------------------------------------------+
Figure 5.2.1-2: Definition of bits 7 and 8 of the Extension Header Type
An Endpoint Receiver is the ultimate receiver of the GTP-PDU (e.g. an RNC or
the GGSN for the GTP-U plane). An Intermediate Node is a node that handles GTP
but is not the ultimate endpoint (e.g. an SGSN for the GTP-U plane traffic
between GGSN and RNC).
+----------------------------------+----------------------------------+ | Next Extension Header Field | Type of Extension Header | | Value | | +----------------------------------+----------------------------------+ | 0000 0000 | No more extension headers | +----------------------------------+----------------------------------+ | 0000 0001 | Reserved - Control Plane only. | +----------------------------------+----------------------------------+ | 0000 0010 | Reserved - Control Plane only. | +----------------------------------+----------------------------------+ | 0000 0011 | Long PDCP PDU Number. | | | | | | See NOTE 2. | +----------------------------------+----------------------------------+ | 0010 0000 | Service Class Indicator | +----------------------------------+----------------------------------+ | 0100 0000 | UDP Port. Provides the UDP | | | Source Port of the triggering | | | message. | +----------------------------------+----------------------------------+ | 1000 0001 | RAN Container | +----------------------------------+----------------------------------+ | 1000 0010 | Long PDCP PDU Number. | | | | | | See NOTE 3. | +----------------------------------+----------------------------------+ | 1000 0011 | Xw RAN Container | +----------------------------------+----------------------------------+ | 1000 0100 | NR RAN Container | +----------------------------------+----------------------------------+ | 1000 0101 | PDU Session Container. See | | | NOTE 4. | +----------------------------------+----------------------------------+ | 1100 0000 | PDCP PDU Number [4]-[5]. See | | | NOTE 1. | +----------------------------------+----------------------------------+ | 1100 0001 | Reserved - Control Plane only. | +----------------------------------+----------------------------------+ | 1100 0010 | Reserved - Control Plane only. | +----------------------------------+----------------------------------+ | NOTE 1: As an exception to the | | | comprehension rule specified | | | above, for a G-PDU with a Next | | | Extension Header Field set to | | | the value \"1100 0000\", the SGW | | | shall consider this | | | corresponding extension header | | | as \'comprehension not | | | required\'. | | | | | | NOTE 2: This value shall be used | | | by a source eNB or gNB complying | | | with this release of the | | | specification. | | | | | | NOTE 3: This value shall not be | | | used by a source eNB or gNB | | | complying with this release of | | | the specification. It may be | | | received from a source eNB | | | complying with an earlier | | | release of the specification, | | | i.e. not supporting the | | | extension header value \"0000 | | | 0011\". | | | | | | NOTE 4: For a GTP-PDU with | | | several Extension Headers, the | | | PDU Session Container should be | | | the first Extension Header. | | +----------------------------------+----------------------------------+
Figure 5.2.1-3: Definition of Extension Header Type
### 5.2.2 Extension Header types
Extension header types marked as \"Reserved -- Control Plane only\" in figure
5.2.1-3 are not used in the GTP user plane. These extension header types are
defined in 3GPP TS 29.060 [6].
The following clauses define the format of the extension header types
applicable to the GTP user plane.
#### 5.2.2.1 UDP Port
This extension header may be transmitted in Error Indication messages to
provide the UDP Source Port of the G-PDU that triggered the Error Indication.
It is 4 octets long, and therefore the Length field has value 1.
* * *
              Bits
Octets 8 7 6 5 4 3 2 1 1 0x01  
2-3 UDP Port number  
4 Next Extension Header Type (note)
* * *
NOTE: The value of this field is 0 if no other Extension header follows.
Figure 5.2.2.1-1: UDP Port Extension Header
#### 5.2.2.2 PDCP PDU Number
This extension header is transmitted, for example in UTRAN, at SRNS relocation
time, to provide the PDCP sequence number of not yet acknowledged N-PDUs. It
is 4 octets long, and therefore the Length field has value 1.
When used during a handover procedure between two eNBs at the X2 interface
(direct DL data forwarding) or via the S1 interface (indirect DL data
forwarding) in E-UTRAN, bit 8 of octet 2 is spare and shall be set to zero.
When used during a handover procedure between two NG-RANs at the Xn interface
(direct DL data forwarding) or via the N3 interface (indirect DL data
forwarding), bits 5-8 of octet 2 are spare and shall be set to zero.
NOTE 1: The PDCP PDU number field of the PDCP PDU number extension header has
a maximum value which requires 15 bits (see 3GPP TS 36.323 [24]); thus, bit 8
of octet 2 is spare.
NOTE 2: The PDCP PDU number field of the PDCP PDU number extension header has
a maximum value which requires 12 bits (see 3GPP TS 38.323 [35]); thus, bit
5-8 of octet 2 are spare.
* * *
              Bits
Octets 8 7 6 5 4 3 2 1 1 0x01  
2 PDCP PDU number  
3 PDCP PDU number.  
4 Next Extension Header Type (Note 3)
* * *
NOTE 3: The value of this field is 0 if no other Extension header follows.
Figure 5.2.2.2-1: PDCP PDU Number Extension Header
#### 5.2.2.2A Long PDCP PDU Number
This extension header is used for direct X2 or indirect S1 DL data forwarding
during a Handover procedure between two eNBs. This extension header is also
used for direct Xn or indirect N3 DL data forwarding during a Handover
procedure between two NG-RANs. The Long PDCP PDU number extension header is 8
octets long, and therefore the Length field has value 2.
The PDCP PDU number field of the Long PDCP PDU number extension header has a
maximum value which requires 18 bits (see 3GPP TS 36.323 [24] and 3GPP TS
38.323 [35]). Bit 2 of octet 2 is the most significant bit and bit 1 of octet
4 is the least significant bit, see Figure 5.2.2.2A-1. Bits 8 to 3 of octet 2,
and Bits 8 to 1 of octets 5 to 7 shall be set to 0.
NOTE: A G-PDU which includes a PDCP PDU Number contains either the extension
header PDCP PDU Number or Long PDCP PDU Number.
* * *
              Bits
Octets 8 7 6 5 4 3 2 1 1 0x02  
2 Spare PDCP PDU number  
3 PDCP PDU number  
4 PDCP PDU number  
5 Spare  
6 Spare  
7 Spare  
8 Next Extension Header Type (Note 1)
* * *
NOTE 1: The value of this field is 0 if no other Extension header follows.
Figure 5.2.2.2A-1: Long PDCP PDU Number Extension Header
#### 5.2.2.3 Service Class Indicator
This extension header identifies the service class indicator (SCI) associated
with the T-PDU carried by the downlink G-PDU. This information may be used by
the A/Gb mode GERAN access for improved radio utilisation (see clause 5.3.5.3
of 3GPP TS 23.060 [4]).
In this version of the specification, this extension header may be transmitted
over the Gn/Gp, S5/S8 and S4 interface. An eNodeB, RNC or MME shall ignore
this information if received over the S1-U, S12, Iu, S11-U or any other
interfaces not defined above, but still shall handle the G-PDU.
NOTE1: This extension header is also sent over the S1-U, S12, Iu interface and
S11-U if the SGW receives the Service Class Indicator from S5/S8 for a UE
having a user plane connection with an RNC or an eNodeB. This can happen when
the PGW does not have an accurate knowledge of the current RAT of the user
e.g. after a handover from GERAN to (E)UTRAN.
It is 4 octets long and therefore the Length field has the value 1.
* * *
              Bits
Octets 8 7 6 5 4 3 2 1 1 0x01  
2 Service Class Indicator  
3 Spare  
4 Next Extension Header Type (note)
* * *
NOTE: The value of this field is 0 if no other Extension header follows.
Figure 5.2.2.3-1: Service Class Indicator Extension Header
If the bit 8 of octet 2 is set to 0, this indicates an operator specific
Service Class Indicator value is included. Otherwise, it shall indicate that a
standardised SCI is included.
NOTE 2: No standardized SCI value is defined in this release, it is intended
to standardize SCIs in a future release.
Bits 8 to 1 of the octet 2 represent the binary coded value of the SCI,
applications with similar Radio Resource Management treatment in GERAN shall
be represented by the same value.
The octet 2 is coded as shown in Table 5.2.2.3-1.
Bits 8 to 1 of the octet 3 are spare bits and shall be set to zero.
Table 5.2.2.3-1: Service Class Indicator
+----------------------------------------+ | Service Class Indicator (SCI), octet 2 | | | | Bit | | | | **8** | | | | 0 Operator-specific SCI | | | | Bits | | | | **7 6 5 4 3 2 1** | | | | 0 0 0 0 0 0 0 | | | | to | | | | 0 0 0 1 1 1 1 Operator-specific SCIs | | | | 0 0 1 0 0 0 0 | | | | to | | | | 1 1 1 1 1 1 1 Spare for future use | | | | Bit | | | | **8** | | | | 1 Standardised SCI | | | | Bits | | | | **7 6 5 4 3 2 1** | | | | 0 0 0 0 0 0 0 | | | | to | | | | 1 1 1 1 1 1 1 Spare for future use | +----------------------------------------+
#### 5.2.2.4 RAN Container
This extension header may be transmitted in a G-PDU over the X2 user plane
interface between the eNBs. The RAN Container has a variable length and its
content is specified in 3GPP TS 36.425 [25]. A G-PDU message with this
extension header may be sent without a T-PDU.
* * *
                 Bits
Octets 8 7 6 5 4 3 2 1 1 0xn  
2-(4n -1) RAN Container  
4n Next Extension Header Type (NOTE)
* * *
NOTE: The value of this field is \'0\' if no other Extension header follows.
Figure 5.2.2.4-1: RAN Container Extension Header
#### 5.2.2.5 Xw RAN Container
This extension header may be transmitted in a G-PDU over the Xw user plane
interface between the eNB and the WLAN Termination (WT). The Xw RAN Container
has a variable length and its content is specified in 3GPP TS 36.465 [27]. A
G-PDU message with this extension header may be sent without a T-PDU.
* * *
                 Bits
Octets 8 7 6 5 4 3 2 1 1 0xn  
2-(4n -1) Xw RAN Container  
4n Next Extension Header Type (NOTE)
* * *
NOTE: The value of this field is \'0\' if no other Extension header follows.
Figure 5.2.2.5-1: Xw RAN Container Extension Header
#### 5.2.2.6 NR RAN Container
This extension header may be transmitted in a G-PDU over the X2-U, Xn-U and
F1-U user plane interfaces, within NG-RAN and, for EN-DC, within E-UTRAN. The
NR RAN Container has a variable length and its content is specified in 3GPP TS
38.425 [30]. A G-PDU message with this extension header may be sent without a
T-PDU.
* * *
                 Bits
Octets 8 7 6 5 4 3 2 1 1 0xn  
2-(4n -1) NR RAN Container  
4n Next Extension Header Type (NOTE)
* * *
NOTE: The value of this field is \'0\' if no other Extension header follows.
Figure 5.2.2.6-1: NR RAN Container Extension Header
#### 5.2.2.7 PDU Session Container
This extension header shall be transmitted in:
\- G-PDUs over the N3 and N9 user plane interfaces, between NG-RAN and UPF, or
between two UPFs;
\- G-PDUs over the N3mb and N19mb user plane interfaces, between the MB-UPF
and NG-RAN, or between the MB-UPF and UPF; and
\- in End Marker packets over data forwarding tunnels in 5GS, for data
forwarding between 5GS and EPS.
The PDU Session Container has a variable length and its content is specified
in 3GPP TS 38.415 [31].
A G-PDU message with this extension header may be sent without a T-PDU, e.g.
when the G-PDU message is used as a dummy GTP-U packet for QoS Monitoring per
QoS flow as specified in clause 5.33.3.2 of 3GPP**** TS**** 23.501**[28]** ,
where the PDU Session Container contains QoS Monitoring related parameters. An
Intermediate UPF between the PSA UPF and the NG-RAN shall forward any received
such G-PDU messages together with the GTP-U PDU Session Container extension
header to the next GTP-U entity.
* * *
                 Bits
Octets 8 7 6 5 4 3 2 1 1 0xn  
2-(4n -1) PDU Session Container  
4n Next Extension Header Type (NOTE)
* * *
NOTE: The value of this field is \'0\' if no other Extension header follows.
Figure 5.2.2.7-1: PDU Session Container Extension Header
# 6 GTP-U Message Formats
## 6.1 General
GTP-U defines a set of messages between the two ends of the user plane of the
interfaces Iu, Gn, Gp, S1-U, S11-U, S2a, S2b, S4, S5, S8, S12, X2, M1, Sn, Xn,
N3, N9 and N19.
GTP-U messages are sent across a GTP user plane tunnel. A GTP-U message may be
either a signalling message across the user plane tunnel, or a G-PDU message.
\- GTP-U signalling messages are used for user plane path management, or for
user plane tunnel management.
\- G-PDU is a vanilla user plane message, which carries the original packet
(T-PDU). In G-PDU message, GTP-U header is followed by a T-PDU.
A T-PDU is an original packet, for example an IP datagram, Ethernet frame or
unstructured PDU Data, from an UE, or from a network node in an external
packet data network.
The complete range of message types defined for GTPv1 is defined in 3GPP TS
29.060 [6]. The table below includes those applicable to GTP user plane. The
three columns to the right define which of the three protocols sharing the
common header of GTPv1 (GTP-C, GTP-U or GTP\') might implement the specific
message type.
Table 6.1-1: Messages in GTP-U
Message Type value (Decimal) Message Reference GTP-C GTP-U GTP\'
* * *
1 Echo Request X X x 2 Echo Response X X x 3-25 Reserved in 3GPP TS 32.295 [8]
and 3GPP TS 29.060 [6]  
26 Error Indication X  
27-30 Reserved in 3GPP TS 29.060 [6]  
31 Supported Extension Headers Notification X X  
32-252 Reserved in 3GPP TS 29.060 [6]  
253 Tunnel Status X  
254 End Marker X  
255 G-PDU X
## 6.2 Presence requirements of Information Elements
As specified in 3GPP TS 29.060 [6], clause 7.1.1.
# 7 GTP-U Messages
## 7.1 General
GTP-U Tunnels are used to carry encapsulated T-PDUs and signalling messages
between a given pair of GTP-U Tunnel Endpoints. The Tunnel Endpoint ID (TEID)
which is present in the GTP header shall indicate which tunnel a particular
T-PDU belongs to. In this manner, packets are multiplexed and de-multiplexed
by GTP-U between a given pair of Tunnel Endpoints. The TEID value to be used
in the TEID field shall be negotiated for instance during the GTP-C Create PDP
Context and the RAB assignment procedures that take place on the control
plane.
For IP Multicast Distribution of User Plane Data for MBMS and MBS:
\- the TEID value to be used in the TEID field shall be allocated at the
source Tunnel Endpoint and signalled to the destination Tunnel Endpoint as
specified in clause 4.2.6;
\- because of the point-to-multipoint characteristics of IP Multicast
Distribution, the path management messages Echo Request and Echo Response, the
tunnel management message Error Indication, the message Supported Extension
Headers Notification and the message End Marker shall not be used.
User payload is transmitted in G-PDU packets. A G-PDU is a packet including a
GTP-U header and a T-PDU. A G-PDU may include extension headers. A G-PDU shall
not include any information element.
GTP-U signalling messages are classified into path management messages,
defined in clause 7.2 of the present document, and tunnel management messages,
defined in clause 7.3 of the present document.
## 7.2 Path Management Messages
### 7.2.1 Echo Request
A GTP-U peer may send an Echo Request on a path to the other GTP-U peer to
find out if it is alive (see clause Path Failure). Echo Request messages may
be sent for each path in use. A path is considered to be in use if at least
one PDP context, EPS Bearer, PDU Session, MBMS UE context, or MBMS bearer
context uses the path to the other GTP-U peer. When and how often an Echo
Request message may be sent is implementation specific but an Echo Request
shall not be sent more often than every 60 s on each path. This doesn\'t
prevent resending an Echo Request with the same sequence number according to
the T3-RESPONSE timer.
Even if there is no path in use, a GTP-U peer shall be prepared to receive an
Echo Request at any time and it shall reply with an Echo Response. The
optional Private Extension contains vendor or operator specific information.
Handling of the Recovery Time Stamp is specified in 3GPP TS 23.007 [3] and
3GPP TS 23.527 [33].
Table 7.2.1-1: Information Elements in an Echo Request
Information element Presence requirement Reference
* * *
Recovery Time Stamp Optional 8.7 Private Extension Optional 8.6
For the GTP-U tunnel setup between two nodes for forwarding user traffic, e.g.
between eNodeBs for direct forwarding over X2, Echo Request path maintenance
message shall not be sent except if the forwarded data and the normal data are
sent over the same path.
### 7.2.2 Echo Response
The message shall be sent as a response to a received Echo Request.
The Restart Counter value in the Recovery information element shall not be
used, i.e. it shall be set to zero by the sender and shall be ignored by the
receiver. The Recovery information element is mandatory due to backwards
compatibility reasons.
Handling of the Recovery Time Stamp is specified in 3GPP TS 23.007 [3] and
3GPP TS 23.527 [33].The optional Private Extension contains vendor or operator
specific information.
Table 7.2.2-1: Information Elements in an Echo Response
Information element Presence requirement Reference
* * *
Recovery Mandatory 8.2 Recovery Time Stamp Optional 8.7 Private Extension
Optional 8.6
### 7.2.3 Supported Extension Headers Notification
This message indicates a list of supported Extension Headers that the GTP
entity on the identified IP address can support. This message is sent only in
case a GTP entity was required to interpret a mandatory Extension Header but
the GTP entity was not yet upgraded to support that extension header. The GTP
endpoint sending this message is marked as not enabled to support some
extension headers (as derived from the supported extension header list). The
peer GTP entity may retry to use all the extension headers with that node, in
an attempt to verify it has been upgraded. Implementers should avoid repeated
attempts to use unknown extension headers with an endpoint that has signalled
its inability to interpret them.
Table 7.2.3-1: Information Elements in Supported Extension Headers
Notification
Information element Presence requirement Reference
* * *
Extension Header Type List Mandatory 8.5
## 7.3 Tunnel Management Messages
### 7.3.1 Error Indication
When a GTP-U node receives a G-PDU for which no EPS Bearer context, PDP
context, PDU Session, MBMS Bearer context, or RAB exists, the GTP-U node shall
discard the G-PDU. If the TEID of the incoming G-PDU is different from the
value \'all zeros\' the GTP-U node shall also return a GTP error indication to
the originating node. GTP entities may include the \"UDP Port\" extension
header (Type 0x40), in order to simplify the implementation of mechanisms that
can mitigate the risk of Denial-of-Service attacks in some scenarios.
Handling of the received Error Indication and the Recovery Time Stamp is
specified in 3GPP TS 23.007 [3] and 3GPP TS 23.527 [33].
The information element Tunnel Endpoint Identifier Data I shall be the TEID
fetched from the G-PDU that triggered this procedure.
The information element GTP-U Peer Address shall be the destination address
(e.g. destination IP address, MBMS Bearer Context) fetched from the original
user data message that triggered this procedure. A GTP-U Peer Address can be a
GGSN, SGSN, RNC, PGW, SGW, ePDG, eNodeB, TWAN, MME, gNB, N3IWF, or UPF
address. The TEID and GTP-U peer Address together uniquely identify the
related PDP context, RAB, PDU session or EPS bearer in the receiving node.
The optional Private Extension contains vendor or operator specific
information.
Table 7.3.1-1: Information Elements in an Error Indication
Information element Presence requirement Reference
* * *
Tunnel Endpoint Identifier Data I Mandatory 8.3 GTP-U Peer Address Mandatory
8.4 Recovery Time Stamp Optional 8.7 Private Extension Optional 8.6
### 7.3.2 End Marker
#### 7.3.2.1 General
The End Marker message indicates the end of the payload stream on a given
tunnel, i.e. a G-PDU that arrives after an End Marker message on this tunnel
may be silently discarded. Table 7.3.2.1-1 specifies the information element
included in the End Marker message.
If an End Marker message is received with a TEID for which there is no
context, then the receiver shall ignore this message.
The optional Private Extension contains vendor or operator specific
information.
Table 7.3.2.1-1: Information Elements in End Marker message
Information element Presence requirement Reference
* * *
Private Extension Optional 8.6
#### 7.3.2.2 End Marker in EPS
The End Marker message(s) shall be sent after sending the last G-PDU that
needs to be sent on a GTP-U tunnel as specified in 3GPP TS 23.401 [5] or after
receiving an End Marker Indication as specified in clause 5.7.1 of 3GPP TS
23.402 [23].
The End Marker message(s) shall be sent for each GTP-U tunnel, except for the
case of an E-UTRAN Initiated E-RAB modification procedure. During an E-UTRAN
Initiated E-RAB modification procedure, the SGW shall send End marker
message(s) to the eNodeB on the old S1-U tunnel for the tunnel(s) that are
switched, i.e. if the S1 eNodeB F-TEID of the GTP-U tunnel provided by the MME
in a Modify Bearer Request or Modify Access Bearer Request is not the same as
the one previously stored in the SGW. Each GTP-U tunnel is identified with a
respective TEID value in the GTP-U header.
An MME may receive End Marker packets over an S11-U tunnel during the
following procedures:
\- Inter-MME TAU procedure;
\- Establishment of S1-U bearer during Data Transport in Control Plane CIoT
EPS optimisation.
The MME shall discard the End Marker packets. The MME may also initiate the
release of the corresponding S11-U resources; however the release of the S11-U
resources is implementation dependent.
#### 7.3.2.3 End Marker in 5GS
The End Marker message(s) shall also be sent after sending the last G-PDU that
needs to be sent on a GTP-U tunnel or after receiving an End Marker Indication
as specified in 3GPP**** TS**** 23.501**[28]** and 3GPP**** TS****
23.502**[29]**. End marker packets sent over data forward tunnels in 5GS, for
data forwarding between 5GS and EPS, shall be sent with the PDU Session
Container extension header including the Qos Flow Identifier of one of the QoS
flows mapped to the same E-RAB.
For QoS Flows transferred to and from Secondary RAN Node in Dual Connectivity
(see clause 4.14.1 of 3GPP TS 23.502 [29]), end marker packets shall be sent
over old tunnel for the transferred QoS flows without the Qos Flow Identifier
included as specified in 3GPP TS 37.340 [38].
End Marker messages shall not be sent over the N19 interface.
### 7.3.3 Tunnel Status
The Tunnel Status message is optional. A GTP-U entity, if it supports the
message, may send one or more Tunnel Status message to the peer GTP-U entity
to provide the status information related to the corresponding GTP-U tunnel in
the sending GTP-U entity. Table 7.3.2.1-1 specifies the information element
included in the Tunnel Status message.
If a Tunnel Status message is received with a TEID for which there is no
context, or the message is not supported, then the receiver shall ignore this
message.
The optional Private Extension contains vendor or operator specific
information.
Table 7.3.3-1: Information Elements in Tunnel Status message
Information element Presence requirement Reference
* * *
GTP-U Tunnel Status Information Mandatory 8.7 Private Extension Optional 8.6
# 8 Information Elements
## 8.1 Information Element Types
A GTP-U Signalling message may contain several information elements. The TLV
(Type, Length, Value) or TV (Type, Value) encoding format shall be used for
the GTP information elements. The information elements shall be sorted, with
the Type fields in ascending order, in the signalling messages. The Length
field contains the length of the information element excluding the Type and
Length field.
For all the length fields, bit 8 of the lowest numbered octet is the most
significant bit and bit 1 of the highest numbered octet is the least
significant bit.
Within information elements, certain fields may be described as spare. These
bits shall be transmitted with the value defined for them. To allow for future
features, the receiver shall not evaluate these bits.
The most significant bit in the Type field is set to 0 when the TV format is
used and set to 1 for the TLV format.
Figure 8.1-1: Type field for TV and TLV format
The complete range of information element types defined for GTPv1 is defined
in 3GPP TS 29.060 [6]. The table below includes those applicable to GTP user
plane.
Table 8.1-1: Information Elements
IE Type Value Format Information Element Reference
* * *
0-13 TV Reserved in 3GPP TS 29.060 [6]  
14 TV Recovery 8.2 15 TV Reserved in 3GPP TS 29.060 [6]  
16 TV Tunnel Endpoint Identifier Data I 8.3 17-132 TV/TLV Reserved in 3GPP TS
29.060 [6]  
133 TLV GSN Address. See NOTE 1. 8.4 134-140 TLV Reserved in 3GPP TS 29.060
[6]  
141 TLV Extension Header Type List 8.5 142-229 TLV Reserved in 3GPP TS 29.060
[6]  
230 TLV GTP-U Tunnel Status Information 8.7 231 TLV Recovery Time Stamp 8.7
232-237 TLV Spare. For future use.  
238-254 TLV Reserved in 3GPP TS 29.060 [6]  
255 TLV Private Extension 8.6 NOTE 1: This IE is named as \" GTP-U Peer
Address\" in the rest of this specification.
## 8.2 Recovery
The value of the restart counter shall be set to 0 by the sending entity and
ignored by the receiving entity. This information element is used in GTP user
plane due to backwards compatibility reasons.
Figure 8.2-1: Restart Counter Information Element
## 8.3 Tunnel Endpoint Identifier Data I
The Tunnel Endpoint Identifier Data I information element contains the Tunnel
Endpoint Identifier used by a GTP entity for the user plane.
* * *
              Bits                                                            
     Octets   8                                   7   6   5   4   3   2   1   
     1        Type = 16 (Decimal)                                             
     2 - 5    Tunnel Endpoint Identifier Data I
* * *
Figure 8.3-1: Tunnel Endpoint Identifier Data I Information Element
## 8.4 GTP-U Peer Address
The GTP-U peer Address information element contains the address of a GTP. The
Length field may have only two values (4 or 16) that determine if the Value
field contains IPv4 or IPv6 address.
The IPv4 address structure is defined in RFC 791 [10].
The IPv6 address structure is defined in RFC 4291 [11].
The encoded address might belong not only to a GSN, but also to an RNC,
eNodeB, SGW, ePDG, gNB, N3IWF, UPF, PGW or TWAN.
Figure 8.4-1: GTP-U Peer Address Information Element
## 8.5 Extension Header Type List
This information element contains a list of \'n\' Extension Header Types. The
length field is set to the number of extension header types included.
Figure 8.5-1: Extension Header Type List Information Element
## 8.6 Private Extension
The Private Extension information element contains vendor specific
information. The Extension Identifier is a value defined in the Private
Enterprise number list in the most recent \"Assigned Numbers\" RFC (RFC 1700
or later).
This is an optional information element that may be included in any GTP
Signalling message. A signalling message may include more than one information
element of the Private Extension type.
Figure 8.6-1: Private Extension Information Element
## 8.7 GTP-U Tunnel Status Information
The GTP-U Tunnel Status Information contains the status information related to
the corresponding GTP-U tunnel in the sending GTP-U entity.
                  Bits
* * *
     Octets       8                                                            7      6   5   4   3   2   1   
     1 to 2       Type = 230 (decimal)                                                                        
     3 to 4       Length = n                                                                                  
     5            Spare                                                        SPOC                           
     6 to (n+4)   These octet(s) is/are present only if explicitly specified
Figure 8.7-1: GTP-U Tunnel Status Information
The octet 5 shall be encoded as follows:
\- Bit 1 -- SPOC (Start Pause Of Charging): when set to \"1\", this indicates
a request to the receiving GTP-U entity to stop usage measurement for the
URR(s) with the Applicable for Start of Pause of Charging Flag set to \"1\" as
specified in 3GPP TS 29.244 [39] for the PFCP session (identified by the IP
address and TEID of the header of the Tunnel Status message). The GTP-U entity
shall forward Tunnel Status message to the upstream GTP-U entity if it is not
a PSA UPF or PGW-U connecting to N6/SGi interface.
\- Bit 2 to 8 -- Spare, for future use and set to \"0\".
## 8.7 Recovery Time Stamp
The Recovery Time Stamp IE is coded as shown in Figure 8.7-1. It indicates the
UTC time when the GTP-U entity started. Octets 4 to 7 are encoded in the same
format as the first four octets of the 64-bit timestamp format as defined in
clause 6 of IETF RFC 5905 [41].
NOTE: The encoding is defined as the time in seconds relative to 00:00:00 on 1
January 1900.
* * *
                  Bits                                                                                     
     Octets       8                                                            7   6   5   4   3   2   1   
     1            Type = aa (decimal)                                                                      
     2 to 3       Length = n                                                                               
     4 to 7       Recovery Time Stamp value                                                                
     8 to (n+3)   These octet(s) is/are present only if explicitly specified
* * *
Figure 8.7-1: Recovery Time Stamp
# 9 Error Handling
## 9.1 Protocol Errors
As specified in 3GPP TS 29.060 [6], clauses 11.1.
## 9.2 Path Failure
Path failure handling procedures are specified in 3GPP TS 23.007 [17] and 3GPP
TS 23.527 [33].
# 10 Security
Network domain security is specified in 3GPP TS 33.102 [21] and 3GPP TS 33.401
[22].
# 11 Reliable Delivery of Signalling Messages
Each path maintains a queue with signalling messages to be sent to the peer.
The message at the front of the queue, if it is a request for which a response
has been defined, shall be sent with a Sequence Number, and shall be held in a
path list until a response is received. Each path has its own list. The
Sequence Number shall be unique for each outstanding request message sourced
from the same IP/UDP endpoint.
The T3-RESPONSE timer shall be started when a signalling request message (for
which a response has been defined) is sent. A signalling message request or
response has probably been lost if a response has not been received before the
T3-RESPONSE timer expires. At the expiry of the timer the request is
retransmitted if the total number of request attempts is less than N3‑REQUESTS
times.
All received request messages shall be responded to and all response messages
associated with a certain request shall always include the same information.
Duplicated response messages shall be discarded. A response message without a
matching outstanding request should be considered as a duplicate.
If a GTP protocol entity is not successful with the transfer of a signalling
message, it shall inform the upper layer of the unsuccessful transfer so that
the controlling upper entity may take the necessary measures.
# 12 GTP Parameters
## 12.1 General
The GTP system parameters defined here and their recommended values shall not
be fixed, but shall be possible to configure as described in clause \'Reliable
delivery of messages\'.
## 12.2 Timers
The timer T3-RESPONSE holds the maximum wait time for a response of a request
message.
## 12.3 Others
The counter N3-REQUESTS holds the maximum number of attempts made by GTP to
send a request message. The recommended value is 5.
# 13 Tunnelling Scenarios
## 13.1 General
There are user packets sent between network nodes without a GTP-U reference
point defined. The scenarios and applicability of GTP-U tunnelling are
described in the following clauses.
## 13.2 Tunnelling between SGWs
GTP T-PDU tunnelling is applicable from the old SGW to the new S GW only when
indirect forwarding is applicable during a S1-based Handover procedure or
inter-RAT handover procedure with SGW Relocation, as described in the 3GPP TS
23.401 [5].For the GTP-U tunnel setup between SGWs, path maintenance messages
do not need to be sent.
GTP T-PDU tunnelling is applicable from the old SGW to the forwarding SGW
during a TAU/RAU with SGW change procedure when indirect data forwarding is
used to forward DL data buffered in the old SGW to the UE via the forwarding
SGW, as described in the clause 5.3.3.1A of 3GPP TS 23.401 [5].
## 13.3 Transfer of the user plane data between PDN GWs
GTP shall not specify tunnelling between PDN GWs. Transfer of UE-to-UE traffic
between PDN GWs shall use the SGi interface.
## 13.4 Tunnelling between SGSNs
T-PDUs, stored in the old SGSN and not yet sent to the MS, shall be tunnelled
to the new SGSN as a part of the Inter SGSN Routeing Update procedure
described in 3GPP TS 23.060 [4]. Some T-PDUs may still be on their way from
the GGSN/PGW to the old SGSN because they have been sent before the tunnel
change. These T-PDUs shall also be tunnelled to the new SGSN.
For intersystem SRNS Relocation, the establishment of the GTP tunnel(s) for
the forwarding of G-PDUs is as described in the 3GPP TS 23.121 [13] and in the
3GPP TS 23.060 [4] specifications.
For PS Handover, the establishment of the GTP tunnel(s) for the forwarding of
G-PDUs is as described in the 3GPP TS 43.129 [14].
The GTP T-PDU tunnelling between SGSNs is applicable also for RAU interaction
with a Gn/Gp SGSN when forwarding DL data buffered in the old Gn/Gp SGSN to
the UE, via the new SGSN (e.g. when direct tunnel is not established) as
described in the 3GPP TS 23.060 [4].
## 13.5 Tunnelling between Source RNC and Target RNC
For the 3G-3G SRNS Relocation, the establishment of the GTP tunnel for the
forwarding of G-PDUs between source and target RNC, is as described in the
3GPP TS 23.121 [13] and in the 3GPP TS 23.060 [4] specifications.
## 13.6 Transfer of the user plane data between GGSNs
GTP shall not specify tunnelling between GGSNs. Transfer of MS-to-MS traffic
between GGSNs shall use the Gi interface.
## 13.7 Tunnelling between RNC and eNodeB
GTP T-PDU tunnelling is applicable between RNC and eNodeB during an inter-RAT
handover between E-UTRAN and UTRAN Iu mode procedure as described in the 3GPP
TS 23.401 [5].
## 13.8 Tunnelling between SGSN and eNodeB
GTP T-PDU tunnelling is applicable between SGSN and eNodeB during an inter-RAT
handover between E-UTRAN and GERAN A/Gb mode/UTRAN Iu mode procedure as
described in the 3GPP TS 23.401 [5].
GTP T-PDU tunnelling between SGSN and eNodeB is applicable also for a TAU
interaction with a Gn/Gp SGSN when forwarding DL data buffered in the old
Gn/Gp SGSN to the UE via the target eNodeB, if such forwarding is supported by
the eNodeB as described in the clause 5.3.3.1A of 3GPP TS 23.401 [5].
## 13.9 Tunnelling between Source eNodeB and Target eNodeB
GTP T-PDU tunnelling is applicable between eNodeBs during an X2-based handover
and E-UTRAN initiated E-RAB modification procedure as described in the 3GPP TS
23.401 [5].
## 13.10 Tunnelling between SGSN and RNC
GTP T-PDU tunnelling between SGSN and RNC is applicable also for a TAU
interaction with a Gn/Gp SGSN when forwarding DL data buffered in the old
Gn/Gp SGSN to the UE, via the new RNC (e.g. when direct tunnel is
established), if such forwarding is supported by the RNC as described in the
clause 5.3.3.1A of 3GPP TS 23.401 [5].
## 13.11 Tunnelling between SGSN and SGW
GTP T-PDU tunnelling is applicable from the old Gn/Gp SGSN to the forwarding
SGW during a TAU/RAU interaction with a Gn/Gp SGSN when indirect data
forwarding is used to forward DL data buffered in the old Gn/Gp SGSN to the UE
via the forwarding SGW, as described in the clause 5.3.3.1A of 3GPP TS 23.401
[5].
## 13.12 Tunnelling between SGW and eNodeB
GTP T-PDU tunnelling between SGW and eNodeB is applicable also for a TAU with
SGW change procedure when forwarding DL data buffered in the old SGW to the UE
via the target eNodeB, if such forwarding is supported by the eNodeB as
described in the clause 5.3.3.1A of 3GPP TS 23.401 [5].
## 13.13 Tunnelling between SGW and RNC
GTP T-PDU tunnelling between SGW and RNC is applicable also for a RAU with SGW
change procedure when forwarding DL data buffered in the old SGW to the UE via
the new RNC when Direct Tunnel is used at the target side, if such forwarding
is supported by the RNC as described in the clause 5.3.3.1A of 3GPP TS 23.401
[5].
## 13.14 Tunnelling between SGW and SGSN
GTP T-PDU tunnelling between SGW and SGSN is applicable also for a RAU with
SGW change procedure when forwarding DL data buffered in the old SGW to the UE
via the new SGSN when Direct Tunnel is not used at the target side as
described in the clause 5.3.3.1A of 3GPP TS 23.401 [5].
###### ## Annex A (Normative): PDU session user plane protocol over N9, N3mb
and N19mb
The PDU session user plane protocol shall be supported over the N9, N3mb and
N19mb interface as specified in 3GPP**** TS**** 38.415**[31].**
#