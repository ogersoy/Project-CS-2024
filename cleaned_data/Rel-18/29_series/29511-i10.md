# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document describes the stage 3 protocol and data model for the
N5g-eir Service Based Interface between the 5G-EIR and its consumers over
which the service to check the equipment identity as described in 3GPP TS
23.501 [2] is performed. It provides the stage 3 protocol definitions and
message flows, and specifies the API for each service offered by the 5G-EIR.
The 5G System stage 2 architecture and procedures are specified in 3GPP TS
23.501 [2] and 3GPP TS 23.502 [3].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition are specified in 3GPP TS 29.500 [4] and
3GPP TS 29.501 [5].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[5] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[6] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces; Stage 3\".
[7] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
[8] OpenAPI Initiative, \"OpenAPI Specification Version 3.0.0\",
https://spec.openapis.org/oas/v3.0.0.[9] IETF RFC 8259: \"The JavaScript
Object Notation (JSON) Data Interchange Format\".
[10] IETF RFC 7807: \"Problem Details for HTTP APIs\".
[11] 3GPP TS 33.501: \"Security Architecture and Procedures for 5G System\".
[12] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[13] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[14] 3GPP TR 21.900: \"Technical Specification Group working methods\".
[15] 3GPP TS 29.524: \"5G System; Cause codes mapping between 5GC interfaces;
Stage 3\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
**N5g-eir:** Service-based interface exhibited by 5G-EIR
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5G-EIR 5G-Equipment Identity Register
EIR Equipment Identity Register
PEI Permanent Equipment Identifier
# 4 Overview
## 4.1 Introduction
N5g-eir is a Service-based interface exhibited by 5G-EIR (5G-Equipment
Identity Register) which is an optional network function that supports the
following functionality:
\- Check the status of Equipment\'s identity (e.g. to check that it has not
been prohibited listed).
The reference point N17 (see Fig 4-1 below) shows the interaction between the
5G-Equipment Identity Register 5G-EIR and the AMF (Access and Mobility
Management Function) enabling the check of the status of the mobile equipment
identity.
Figure 4-1: Reference Model -- N5g-eir
During any procedure establishing a signalling connection with the UE the
network may optionally perform an ME identity check with 5G-EIR via the
N5g-eir_Equipment Identity Check Service exhibited by 5G-EIR.
# 5 Services offered by the 5G-EIR NF
## 5.1 Introduction
The following NF service is offered by the N5g-eir to check the ME whether it
is prohibited listed or not:
> \- N5g-eir_EquipmentIdentityCheck
Table 5.1-1: NF Services provided by 5G-EIR
Service Name Description Consumer
* * *
N5g-eir_EquipmentIdentityCheck This service offered by the 5G-EIR allows the
consumer to check the Permanent Equipment Identifier (PEI) and check whether
the PEI is in the prohibited list or not. AMF
The N5g-eir_Equipment Identity Check service is specified in 3GPP TS 23.502
[3], clause 4.2.2.2.2
Table 5.1-2 summarizes the corresponding APIs defined for this specification.
Table 5.1-2: API Descriptions
**Service Name** **Clause** **Description** **OpenAPI Specification File**
**apiName** **Annex**
* * *
N5g-eir_EquipmentIdentityCheck 6.1 5G-EIR Equipment Identity Check Service
TS29511_N5g-eir_EquipmentIdentityCheck.yaml n5g-eir-eic A.2
The N5g-eir_Equipment Identity Check service is specified in 3GPP TS 23.502
[3], clause 4.2.2.2.2
## 5.2 N5g-eir_EquipmentIdentityCheck Service
### 5.2.1 Service Description
The N5g-eir_Equipment Identity Check service is provided by the 5G-EIR to
check the Permanent Equipment Identifier (PEI) whether it is in the prohibited
list or not. The service can be consumed by AMF which initiates ME identity
check by invoking the N5g-eirEquipmentIdentityCheckGet service operation (see
clause 5.2.4.2. of 3GPP TS 23.502 [3]).
During the initial registration the Permanent Equipment Identifier is obtained
from the UE. The AMF operator may check the PEI with an EIR.
### 5.2.2 Service Operations
#### 5.2.2.1 Introduction
#### 5.2.2.2 CheckEquipmentIdentity
##### 5.2.2.2.1 General
The CheckEquipmentIdentity operation shall be used to check the PEI and
determine whether the subscriber is allowed to use the equipment, in the
following procedures:
\- ME Identity check procedure (see clause 4.7 of 3GPP TS 23.502 [3]);
##### 5.2.2.2.2 Procedure using CheckEquipmentIdentity Operation
The NF Service Consumer (e.g. AMF) shall check the PEI by using the HTTP GET
method as shown in Figure 5.2.2.2.2-1.
Figure 5.2.2.2.2-1: PEI status check by the NF Service Consumer
1\. The NF Service Consumer (e.g. AMF) sends a GET request to the resource
representing the PEI equipment Status. It shall include the PEI as a query
parameter and, optionally, the SUPI and/or GPSI may also be included.
2a. On success, \"200 OK\" with the message body containing the equipment
status of the PEI.
2b. If the PEI is not known, \"404 Not Found\" with the message body
containing a ProblemDetails object, with the \"details\" attribute set to
\"ERROR_EQUIPMENT_UNKNOWN\". When receiving the response from the 5G-EIR, the
NF Service Consumer (e.g. AMF) shall check the equipment Status and the
detailed problem. Dependent upon the result, the NF Service Consume will
decide its subsequent actions (e.g. sending a Registration Reject if the
5G-EIR indicates that the PEI is unknown or prohibited listed).
The definition of the equipment-status resource is specified in clause 6.1.3.
# 6 API Definitions
## 6.1 N5g-eir_EquipmentIdentityCheck Service API
### 6.1.1 API URI
The N5g-eir_EquipmentIdentityCheck Service shall use the
N5g-eir_EquipmentIdentityCheck API.
The API URI of the N5g-eir_EquipmentIdentityCheck API shall be:
**{apiRoot}/\ /\**
The request URI used in HTTP request from the NF service consumer towards the
NF service producer shall have the structure defined in subclause 4.4.1 of
3GPP TS 29.501 [5], i.e.:
**{apiRoot}/\ /\/\**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [5].
\- The \ shall be \"n5g-eir-eic\".
\- The \ shall be \"v1\".
\- The \ shall be set as described in subclause
6.1.3.
### 6.1.2 Usage of HTTP
#### 6.1.2.1 General
HTTP/2, as defined in IETF RFC 7540 [7], shall be used as specified in clause
5 of 3GPP TS 29.500 [4].
HTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [4].
HTTP messages and bodies for the N5g-eir_EquipmentIdentityCheck Service shall
comply with the OpenAPI [8] specification contained in Annex A.
#### 6.1.2.2 HTTP standard headers
##### 6.1.2.2.1 General
The usage of HTTP standard headers shall be supported as specified in clause
5.2.2 of 3GPP TS 29.500 [4].
##### 6.1.2.2.2 Content type
The following content types shall be supported:
\- JSON, as defined in IETF RFC 8259 [9]. The use of the JSON format shall be
signalled by the content type \"application/json\". See also clause 5.4 of
3GPP TS 29.500 [4].
\- The Problem Details JSON Object (IETF RFC 7807 [10]. The use of the Problem
Details JSON object in a HTTP response body shall be signalled by the content
type \"application/problem+json\".
#### 6.1.2.3 HTTP custom headers
##### 6.1.2.3.1 General
In this release of this specification, no custom headers specific to the
N5g-eir_EquipmentIdentityCheck Service are defined. For 3GPP specific HTTP
custom headers used across all service based interfaces, see clause 5.2.3 of
3GPP TS 29.500 [4].
### 6.1.3 Resources
#### 6.1.3.1 Overview
Figure 6.1.3.1-1: Resource URI structure of the n5g-eir-eic API
Table 6.1.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 6.1.3.1-1: Resources and methods overview
Resource name Resource URI HTTP method or custom operation Description
* * *
equipmentStatus /equipment-status GET Retrieve the equipment status of the PEI
#### 6.1.3.2 Resource: equipmentStatus
##### 6.1.3.2.1 Description
This resource represents the equipmentStatus for a PEI.
##### 6.1.3.2.2 Resource Definition
Resource URI: {apiRoot}/n5g-eir-eic/\/equipment-status
This resource shall support the resource URI variables defined in table
6.1.3.2.2-1.
Table 6.1.3.2.2-1: Resource URI variables for this resource
Name Data type Definition
* * *
apiRoot string See clause 6.1.1
##### 6.1.3.2.3 Resource Standard Methods
###### 6.1.3.2.3.1 GET
This method shall support the URI query parameters specified in table
6.1.3.2.3.1-1.
Table 6.1.3.2.3.1-1: URI query parameters supported by the GET method on this
resource
* * *
Name Data type P Cardinality Description pei Pei M 1 The PEI of the UE shall
be included for equipment identify checking supi Supi O 0..1 The SUPI of the
UE gpsi Gpsi O 0..1 The GPSI of the UE supported-features SupportedFeatures C
0..1 This IE shall be present if at least one optional feature defined in
clause 6.1.6 is supported.
* * *
This method shall support the request data structures specified in table
6.1.3.2.3.1-2 and the response data structures and response codes specified in
table 6.1.3.2.3.1-3.
Table 6.1.3.2.3.1-2: Data structures supported by the GET Request Body on this
resource
* * *
Data type P Cardinality Description n/a
* * *
Table 6.1.3.2.3.1-3: Data structures supported by the GET Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Ei | M | 1 | 200 OK | Upon success, | | rResponseData | | | | a response | | | | | | body | | | | | | containing | | | | | | the Equipment | | | | | | Status shall | | | | | | be returned | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing a | | | | | | different | | | | | | URI, or the | | | | | | same URI if | | | | | | this is a | | | | | | redirection | | | | | | triggered by | | | | | | an SCP to the | | | | | | same target | | | | | | resource via | | | | | | another SCP. | | | | | | In the former | | | | | | case, the URI | | | | | | shall be an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance | | | | | | within the | | | | | | same 5G-EIR | | | | | | or 5G-EIR | | | | | | (service) | | | | | | set. (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing a | | | | | | different | | | | | | URI, or the | | | | | | same URI if | | | | | | this is a | | | | | | redirection | | | | | | triggered by | | | | | | an SCP to the | | | | | | same target | | | | | | resource via | | | | | | another SCP. | | | | | | In the former | | | | | | case, the URI | | | | | | shall be an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance | | | | | | within the | | | | | | same 5G-EIR | | | | | | or 5G-EIR | | | | | | (service) | | | | | | set. (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 404 Not Found | The equipment | | roblemDetails | | | | identify | | | | | | checking has | | | | | | failed. | | | | | | | | | | | | The \"cause\" | | | | | | attribute may | | | | | | be used to | | | | | | indicate one | | | | | | of the | | | | | | following | | | | | | application | | | | | | errors: | | | | | | | | | | | | - | | | | | | ERROR_EQUIP | | | | | | MENT_UNKNOWN | | | | | | | | | | | | See table | | | | | | 6.1.5.3-1 for | | | | | | the | | | | | | description | | | | | | of this | | | | | | error. | +---------------+---+-------------+---------------+---------------+ | NOTE : The | | | | | | mandatory | | | | | | HTTP error | | | | | | status codes | | | | | | for the GET | | | | | | method listed | | | | | | in Table | | | | | | 5.2.7.1-1 of | | | | | | 3GPP TS | | | | | | 29.500 [4] | | | | | | other than | | | | | | those | | | | | | specified in | | | | | | the table | | | | | | above also | | | | | | apply, with a | | | | | | P | | | | | | roblemDetails | | | | | | data type | | | | | | when needed | | | | | | (see clause | | | | | | 5.2.7 of | | | | | | 3GPP TS 2 | | | | | | 9.500 [4]). | | | | | | | | | | | | NOTE 2: | | | | | | Redi | | | | | | rectResponses | | | | | | may be | | | | | | inserted by | | | | | | an SCP, see | | | | | | cl | | | | | | ause 6.10.9.1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [4]. | | | | | +---------------+---+-------------+---------------+---------------+
Table 6.1.3.2.3.1-4: Headers supported by the 307 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same 5G-EIR | | | | | | or 5G-EIR | | | | | | (service) set. | | | | | | | | | | | | Or the same | | | | | | URI, if a | | | | | | request is | | | | | | redirected to | | | | | | the same target | | | | | | resource via a | | | | | | different SCP. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
Table 6.1.3.2.3.1-5: Headers supported by the 308 Response Code on this
resource
+-----------------+-----------+---+-------------+-----------------+ | Name | Data type | P | Cardinality | Description | +-----------------+-----------+---+-------------+-----------------+ | Location | string | M | 1 | An alternative | | | | | | URI of the | | | | | | resource | | | | | | located on an | | | | | | alternative | | | | | | service | | | | | | instance within | | | | | | the same 5G-EIR | | | | | | or 5G-EIR | | | | | | (service) set. | | | | | | | | | | | | Or the same | | | | | | URI, if a | | | | | | request is | | | | | | redirected to | | | | | | the same target | | | | | | resource via a | | | | | | different SCP. | +-----------------+-----------+---+-------------+-----------------+ | 3gpp-S | string | O | 0..1 | Identifier of | | bi-Target-Nf-Id | | | | the target NF | | | | | | (service) | | | | | | instance ID | | | | | | towards which | | | | | | the request is | | | | | | redirected | +-----------------+-----------+---+-------------+-----------------+
### 6.1.4 Data Model
#### 6.1.4.1 General
This clause specifies the application data model supported by the API.
Table 6.1.4.1-1 specifies the data types defined for the n5g-eir-eic service
based interface protocol.
Table 6.1.4.1-1: n5g-eir-eic specific Data Types
Data type Clause defined Description
* * *
EirResponseData 6.1.4.2.2  
EquipmentStatus 6.1.4.3.3 Equipment status of the PEI, this data type is
string.
Table 6.1.6.1-2 specifies data types re-used by the N~\~ service based
interface protocol from other specifications, including a reference to their
respective specifications and when needed, a short description of their use
within the N~\~ service based interface.
Table 6.1.4.1-2: 5g-eir-eic re-used Data Types
+-------------------+----------------------+-----------------------+ | Data type | Reference | Comments | +===================+======================+=======================+ | Pei | 3GPP TS 29.571[6] | Data type | | | | representing the PEI | | | | of the UE. | +-------------------+----------------------+-----------------------+ | Supi | 3GPP TS 29.571 [6] | Data type | | | | representing the SUPI | | | | of the subscriber. | | | | | | | | pattern: See pattern | | | | of type Supi in | | | | 3GPP TS 29.571 [6] | +-------------------+----------------------+-----------------------+ | ProblemDetails | 3GPP TS 29.571 [6] | Common data type for | | | | error responses | +-------------------+----------------------+-----------------------+ | Gpsi | 3GPP TS 29.571 [6] | Data type | | | | representing the GPSI | | | | of the subscriber. | +-------------------+----------------------+-----------------------+ | SupportedFeatures | 3GPP TS 29.571 [6] | Supported Features | +-------------------+----------------------+-----------------------+ | RedirectResponse | 3GPP TS 29.571 [6] | Response body of the | | | | redirect response | | | | message. | +-------------------+----------------------+-----------------------+
#### 6.1.4.2 Structured data types
##### 6.1.4.2.1 Introduction
This clause defines the structures to be used in resource representations.
##### 6.1.4.2.2 Type: EirResponseData
Table 6.1.4.2.2-1: Definition of type EirResponseData
Attribute name Data type P Cardinality Description
* * *
status EquipmentStatus M 1 Status of the UE
#### 6.1.4.3 Simple data types and enumerations
##### 6.1.4.3.1 Introduction
This clause defines simple data types and enumerations that can be referenced
from data structures defined in the previous clauses.
##### 6.1.4.3.2 Simple data types
The simple data types defined in table 6.1.4.3.2-1 shall be supported.
Table 6.1.4.3.2-1: Simple data types
* * *
Type Name Type Definition Description \
* * *
##### 6.1.4.3.3 Enumeration: EquipmentStatus
Table 6.1.4.3.3-1: Enumeration EquipmentStatus
Enumeration value Description
* * *
\"WHITELISTED\" Indicates the PEI is permitted whitelisted \"BLACKLISTED\"
Indicates the PEI is prohibited listed \"GREYLISTED\" Indicates the PEI is
tracking listed
### 6.1.5 Error Handling
#### 6.1.5.1 General
HTTP error handling shall be supported as specified in clause 5.2.4 of 3GPP TS
29.500 [4].
The Cause codes mapping performed by AMF between the following HTTP responses
returned by the EIR services to the AMF and the 5GMM related values is
specified in clause 4.5.2 of 3GPP TS 29.524 [15].
#### 6.1.5.2 Protocol Errors
Protocol Error Handling shall be supported as specified in clause 5.2.7 of
3GPP TS 29.500 [4].
#### 6.1.5.3 Application Errors
The common application errors defined in the Table 5.2.7.2-1 in 3GPP TS 29.500
[4] may also be used for the N5g-eir_EquipmentIdentityCheck service, and the
following application errors listed in Table 6.1.5.3-1 are specific for the
N5g-eir_EquipmentIdentityCheck service.
Table 6.1.5.3-1: Application errors
Application Error HTTP status code Description
* * *
ERROR_EQUIPMENT_UNKNOWN 404 Not Found Indicate the mobile equipment is not
known in the EIR.
### 6.1.6 Feature Negotiation
The optional features in table 6.1.6-1 are defined for the
N5g-eir_EquipmentIdentityCheck API. They shall be negotiated using the
extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [4].
Table 6.1.6-1: Supported Features
+----------------+--------------+-----+----------------------+ | Feature number | Feature Name | M/O | Description | +================+==============+=====+======================+ | 1 | ES3XX | M | Extended Support of | | | | | HTTP 307/308 | | | | | redirection | | | | | | | | | | An NF Service | | | | | Consumer (e.g. AMF) | | | | | that supports this | | | | | feature shall | | | | | support handling of | | | | | HTTP 307/308 | | | | | redirection for any | | | | | service operation of | | | | | the | | | | | Eq | | | | | uipmentIdentityCheck | | | | | service. An NF | | | | | Service Consumer | | | | | that does not | | | | | support this feature | | | | | does only support | | | | | HTTP redirection as | | | | | specified for 3GPP | | | | | Release 15. | +----------------+--------------+-----+----------------------+
### 6.1.7 Security
#### 6.1.7.1 General
The security mechanisms for service based interfaces are specified in clause
13 of 3GPP TS 33.501 [11] and in clause 6.7.3 of 3GPP TS 29.500 [4]. The
access to the N5g-eir_EquipmentIdentityCheck API may be authorized by means of
the OAuth2 protocol (see IETF RFC 6749 [12]), based on local configuration,
using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP
TS 29.510 [13]) plays the role of the authorization server.
The N5g-eir_EquipmentIdentityCheck API defines scopes for OAuth2 authorization
as specified in 3GPP TS 33.501 [11]; it defines a single scope consisting on
the name of the service (i.e., \"n5g-eir-eic\"), and it does not define any
additional scopes at resource or operation level.
Security Protection Edge Proxy (SEPP), as specified in 3GPP TS 33.501 [11],
shall be used between service based interfaces across PLMNs. The NFs in a PLMN
shall use the SEPP as a HTTP/2 proxy for the HTTP/2 messages that carry
\":authority\" pseudo header with a uri-host formatted as specified in clause
6.1.4.3 of 3GPP TS 29.500 [4]
#### 6.1.7.2 Transport Layer Security Protection of Messages
As specified in clause 13.1 of 3GPP TS 33.501 [11], TLS shall be used for the
security protection of messages at the transport layer for the N5g-eir service
based interface if network security is not provided by other means.
The protocol stack for the N5g-eir service based interface is shown on Figure
6.1.7.2-1.
Figure 6.1.7.2-1: SBI Protocol Stack
The N5g-eir service based interface uses HTTP/2 protocol (see clause 5.2) with
JSON (see clause 5.4) as the application layer serialization protocol. For the
security protection at the transport layer, 5G-EIR NF shall support TLS and
TLS shall be used within a PLMN if network security is not provided by other
means, as specified in 3GPP TS 33.501 [11].
#### 6.1.7.3 Authorization of 5G-EIR NF Service Access
As specified in clause 13.4.1 of 3GPP TS 33.501 [11] OAuth 2.0 (see IETF RFC
6749 [12]) may be used for authorization of N5g-eir_EquipmentIdentityCheck
service access. The 5G-EIR NF and the NRF (as defined in 3GPP TS 29.510 [13])
shall support the OAuth 2.0 authorization framework with \"Client
Credentials\" grant type as specified in clause 4.4 of IETF RFC 6749 [12]. The
NRF shall act as the Authorization Server providing the access tokens to the
NF service consumers to access the service provided by the 5G-EIR. If the
5G-EIR NF receives an OAuth 2.0 authorization token in the \"Authorization\"
HTTP request header field, the N5g-eir_EquipmentIdentityCheck service shall
validate the access token, its expiry and its access scope before allowing
access to the requested resource, as specified in clause 7 of IETF RFC 6749
[12].
### 6.1.8 HTTP redirection
An HTTP request may be redirected to a different 5G-EIR service instance,
within the same 5G-EIR or a different 5G-EIR of an 5G-EIR set, e.g. when an
5G-EIR service instance is part of an 5G-EIR (service) set or when using
indirect communications (see 3GPP TS 29.500 [4]). See also the ES3XX feature
in clause 6.1.6.
An SCP that reselects a different 5G-EIR producer instance will return the NF
Instance ID of the new 5G-EIR producer instance in the 3gpp-Sbi-Producer-Id
header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [4].
If an 5G-EIR within an 5G-EIR set redirects a service request to a different
5G-EIR of the set using an 307 Temporary Redirect or 308 Permanent Redirect
status code, the identity of the new 5G-EIR towards which the service request
is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the
307 Temporary Redirect or 308 Permanent Redirect response as specified in
clause 6.10.9.1 of 3GPP TS 29.500 [4].
###### ## Annex A (normative): OpenAPI specification
# A.1 General
This Annex specifies the formal definition of the
N5g-eir_EquipmentIdentityCheck Service API. It consists of an OpenAPI 3.0.0
specification, in YAML format.
This Annex takes precedence when being discrepant to other parts of the
specification with respect to the encoding of information elements and methods
within the API(s).
NOTE : The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
Informative copies of the OpenAPI specification files contained in this 3GPP
Technical Specification are available on a Git-based repository that uses the
GitLab software version control system (see 3GPP TS 29.501 [5] clause 5.3.1
and 3GPP TR 21.900 [14] clause 5B).
# A.2 N5g-eir_EquipmentIdentityCheck Service API
openapi: 3.0.0
info:
version: \'1.3.0-alpha.1\'
title: \'5G-EIR Equipment Identity Check\'
description: \|
5G-EIR Equipment Identity Check Service.
Â© 2022, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
externalDocs:
description: 3GPP TS 29.511 V18.0.0; 5G System; Equipment Identity Register
Services; Stage 3
url: \'https://www.3gpp.org/ftp/Specs/archive/29_series/29.511/\'
servers:
\- url: \'{apiRoot}/n5g-eir-eic/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in clause 4.4 of 3GPP TS 29.501
security:
\- {}
\- oAuth2ClientCredentials:
\- n5g-eir-eic
paths:
/equipment-status:
get:
summary: Retrieves the status of the UE
operationId: GetEquipmentStatus
tags:
\- Equipment Status (Document)
parameters:
\- name: pei
in: query
description: PEI of the UE
required: true
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Pei\'
\- name: supi
in: query
description: SUPI of the UE
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Supi\'
\- name: gpsi
in: query
description: GPSI of the UE
required: false
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Gpsi\'
\- name: supported-features
in: query
description: supported features of the NF consumer
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
responses:
\'200\':
description: Expected response to a valid request
content:
application/json:
schema:
\$ref: \'#/components/schemas/EirResponseData\'
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
description: PEI Not Found
content:
application/problem+json:
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ProblemDetails\'
\'406\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/406\'
\'414\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/414\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'502\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/502\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
description: Unexpected error
components:
securitySchemes:
oAuth2ClientCredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
n5g-eir-eic: Access to the N5g-eir_EquipmentIdentityCheck API
schemas:
EirResponseData:
description: Represents equipment status data provided in an EIR response
message.
type: object
required:
\- status
properties:
status:
\$ref: \'#/components/schemas/EquipmentStatus\'
EquipmentStatus:
description: Represents equipment status of the PEI. This data type is a
string.
type: string
enum:
\- WHITELISTED # PERMITTED
\- BLACKLISTED # PROHIBITED
\- GREYLISTED # TRACKING
#