# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
Z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document defines the (U)SIM Application Programming Interface
extending the \"UICC API for Java Card™\" [2].
This API allows to develop a (U)SAT application running together with a (U)SIM
application and using GSM/3G network features.
The present document includes information applicable to network operators,
service providers, server -- (U)SIM -- and database manufacturers.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] ETSI TS 101 220: \"Integrated Circuit Cards (ICC); ETSI numbering system
for telecommunication; Application providers (AID)\".
[2] ETSI TS 102 241 V9.2.0: \"UICC API for Java Card™\"
[3] 3GPP TS 31.102: \"Characteristics of the USIM Application\".
[4] 3GPP TS 51.011 Release 4: \"Specification of the Subscriber Identity
Module- Mobile Equipment (SIM -- ME) interface\".
[5] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service (CBS)\".
[6] 3GPP TS 31.101: \"UICC-terminal interface; Physical and logical
characteristics\".
[7] 3GPP TS 31.111: \"USIM Application Toolkit (USAT)\".
[8] 3GPP TS 51.014 Release 4: \"Specification of the SIM Application Toolkit
for the Subscriber Identity Module -- Mobile Equipment (SIM -- ME)
interface\".
[9] 3GPP TS 31.115: \"Secured packet structure for the (U)SIM Toolkit
applications\".
[10] 3GPP TS 23.040: \"Technical realization of the Short Message Service
(SMS)\".
[11] Sun Microsystems \"Application Programming Interface, Java Card™
Platform, 3.0.1 Classic Edition\".
[12] Sun Microsystems \"Runtime Environment Specification, Java Card™
Platform, 3.0.1 Classic Edition\".
[13] Sun Microsystems \"Virtual Machine Specification Java Card™ Platform,
3.0.1 Classic Edition\".
Note: SUN Java Card™ Specifications can be downloaded at
http://java.sun.com/products/javacard
[14] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions defined in
ETSI TS 102 241 [2] apply.
**(U)SAT Framework :** (U)SAT extension of the CAT Runtime Environment.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations defined in ETSI TS
102 241 [2] apply.
# 4 Description
## 4.0 Overview
This API is an extension to the ETSI TS 102 241 [2] \"UICC API for Java
Card™\" and requires the implementation of this specification.
The classes and interfaces described in this specification inherit
functionality from the classes and interfaces specified in the \"UICC API for
Java Card™\".
The (U)SAT Framework described in this specification is an extension of the
CAT Runtime Environment defined in ETSI TS 102 241 [2].
## 4.1 (U)SIM Java Card™ Architecture
The overall architecture of the (U)SIM API is based on the \"UICC API for Java
Card™\" defined in ETSI TS 102 241 [2].
Figure 1: (U)SIM Java Card™ Architecture
# 5 File Access API
The (U)SIM file access API consists of the package _uicc.usim.access_. This
package defines additional constants to those defined in the _uicc.access_
package from ETSI TS 102 241 [2]. The access to the file system, defined in TS
51.011 [4] and TS 31.102 [3], is the one specified in ETSI TS 102 241 [2] via
the UICC _FileView_ Interface. When selecting a cyclic file the current record
number is defined, this applies also to files located under DF~GSM~.
# 6 (U)SAT Framework
## 6.0 Overview
The (U)SIM toolkit API consists of the _uicc.usim.toolkit_ package for toolkit
features defined in TS 31.111 [7] and TS 51.014 [8], and is based on the
_uicc.toolkit_ package defined in ETSI TS 102 241 [2]_._
## 6.1 Applet triggering
See ETSI TS 102 241 [2].
### 6.1.1 Exception Handling
The following clause describes the handling of exceptions by the (U)SAT
Framework in addition to the behaviour defined in ETSI TS 102 241 [2] for the
CAT Runtime Environment.
If an Applet triggered by EVENT_FORMATTED_SMS_PP_ENV event throws an
ISOException with the reason code (0x6FXX), it shall be sent to the terminal.
Other Exceptions shall not be propagated to the terminal.
## 6.2 Definition of Events
The following events can trigger a Toolkit Applet in addition to the events
defined in ETSI TS 102 241 [2], all short values are reserved in ETSI TS 102
241 [2]:
Table 1: (U)SAT event list
* * *
Event Name Reserved short value EVENT_FORMATTED_SMS_PP_ENV 2
EVENT_FORMATTED_SMS_PP_UPD 3 EVENT_UNFORMATTED_SMS_PP_ENV 4
EVENT_UNFORMATTED_SMS_PP_UPD 5 EVENT_UNFORMATTED_SMS_CB 6
EVENT_MO_SHORT_MESSAGE_CONTROL_BY_NAA 10 _EVENT_FORMATTED_SMS_CB_ 24
_EVENT_EVENT_DOWNLOAD_IWLAN_ACCESS_STATUS_ 30
_EVENT_EVENT_DOWNLOAD_NETWORK_REJECTION_ 31
_EVENT_EVENT_DOWNLOAD_CSG_CELL_SELECTION_ 33 _EVENT_FORMATTED_USSD_ 121
_EVENT_UNFORMATTED_USSD_ 122 _EVENT_EVENT_DOWNLOAD_IMS_REGISTRATION_ 119
_EVENT_EVENT_DOWNLOAD_INCOMING_IMS_DATA_ 120
* * *
_EVENT_FORMATTED_SMS_PP_ENV, EVENT_UNFORMATTED_SMS_PP_ENV,\
EVENT_FORMATTED_SMS_PP_UPD, EVENT_UNFORMATTED_SMS_PP_UPD_
> There are two ways for a card to receive a Short Message Point to Point: via
> an ENVELOPE(SMS-PP Download) APDU as defined in TS 31.111 [7] and TS 51.014
> [8] or an UPDATE RECORD EF~SMS~ APDU as defined in TS 31.102 [3] and TS
> 51.011 [4]. The EF~SMS~ can be either located under the DF~Telecom~ or under
> any ADF as defined in TS 31.102 [3] and TS 51.011 [4].
>
> The received Short Message may be:
\- formatted according to TS 31.115 [9] or an other protocol to identify
explicitly the toolkit applet for which the message is sent;
\- unformatted (e.g. a toolkit applet specific protocol ) then the (U)SAT
Framework will pass this data to all registered toolkit applets.
> When the Short Message is received as Concatenated Short Messages as defined
> in TS 23.040 [10], it is the responsibility of the (U)SAT Framework to link
> single Short Messages together to re -- assemble the original message before
> any further processing. The original Short Message shall be placed in one
> SMS TPDU TLV (with TP-UDL field coded on one octet) included in the
> _USATEnvelopeHandler_. The concatenation control headers used to re-assemble
> the short messages in the correct order shall not be present in the SMS
> TPDU. The TP-elements of the SMS TPDU and the Address (TS -- Service-Centre-
> Address) shall correspond to the ones in the last received Short Message
> (independently of the Sequence number of Information-Element-Data).
>
> The minimum requirement for the (U)SAT Framework is to process a
> concatenated short message with the following properties:
\- the Information Element Identifier is equal to the 8-bit reference number.
\- it contains uncompressed 8 bit data or uncompressed UCS2 data.
> _EVENT_FORMATTED_SMS_PP_ENV_
>
> Upon reception of a TS 31.115 [9] formatted Short Message Point to Point
> (Single or Concatenated) via an ENVELOPE, the (U)SAT Framework shall:
\- verify the security of the Short Message as per TS 31.115 [9];
\- trigger the toolkit applet registered with the corresponding TAR;
\- take the optional Application Data posted by the triggered toolkit applet
if present;
\- secure and send the response packet using SMS-DELIVER-REPORT or SMS-SUBMIT.
When the toolkit applet is triggered, data shall be provided deciphered.
_EVENT_UNFORMATTED_SMS_PP_ENV_
Upon reception of an unformatted Short Message Point to Point (Single or
Concatenated) via an ENVELOPE, the (U)SAT Framework shall trigger all the
Toolkit Applets registered to this event.
> NOTE: As a consequence of the _EnvelopeResponseHandler_ availability rules
> specified in clause 6.6, only the first triggered toolkit applet is
> guaranteed to be able to send back a response.
_EVENT_FORMATTED_SMS_PP_UPD_
> Upon reception of a TS 31.115 [9] formatted Short Message Point to Point
> (Single or Concatenated) via an UPDATE RECORD EF~SMS~, the (U)SAT Framework
> shall:
\- update the EF~SMS~ file with the data received, it is then up to the
receiving toolkit applet to change the SMS stored in the file (i.e. the
toolkit applet need to have access to the EF~SMS~ file)
\- verify the security of the Short Message as per TS 31.115 [9];
\- convert the UPDATE RECORD EF~SMS~ APDU into a COMPREHENSION TLV List;
\- trigger the toolkit applet registered with the corresponding TAR;
When the toolkit applet is triggered, data shall be provided deciphered.
The _USATEnvelopeHandler_ provided to the applet shall:
\- return _BTAG_SMS_PP_DOWNLOAD_ to the _getTag()_ method call**;**
\- return the Comprehension TLV list length to the _getLength()_ method call;
The _USATEnvelopeHandler_ provided to the applet shall contain the following
COMPREHENSION TLVs:
\- Device Identities TLV
> The Device Identities Comprehension TLV is used to store the information
> about the absolute record number in the EF~SMS~ file and the value of the
> EF~SMS~ record status byte, and is formatted as defined below:
* * *
Device identities Comprehension TLV Device Identities tag length = 02 Absolute
Record Number Record Status
* * *
> With the absolute record number the toolkit applet can update EF~SMS~ in
> absolute mode to change the received SMS (e.g. in a readable text).
>
> For Concatenated Short Message the Absolute Record Number and the Record
> Status will correspond to the last UPDATE RECORD EF~SMS~ APDU received.
\- Address TLV
> The value is the TS-Service-Centre-Address (RP-OA) of the last UPDATE RECORD
> EF~SMS~ APDU.
\- SMS TPDU TLV
> The value is the SMS TPDU provided deciphered and reassembled, if needed
\- AID TLV
> The AID comprehension TLV is present only if the EF~SMS~ file updated is
> under an ADF. The value is the AID of the ADF as defined TS 31.111 [7].
>
> The order of the TLVs given in the _USATEnvelopeHandler_ is not specified,
NOTE: To get each COMPREHENSION TLV, it is recommended that the applet uses
the _ViewHandler.findTLV()_ methods
> _EVENT_UNFORMATTED_SMS_PP_UPD_
>
> Upon reception of an unformatted Short Message Point to Point (Single or
> Concatenated) via UPDATE RECORD EF~SMS~ APDU, the (U)SAT Framework shall :
\- update the EF~SMS~ file with the data received;
\- convert the UPDATE RECORD EF~SMS~ APDU data into a COMPREHENSION TLV List
(as described for _EVENT_FORMATTED_SMS_PP_UPD_);
\- trigger all the Toolkit Applets registered to this event.
> The content of EF~SMS~ may have been modified by a previously triggered
> Toolkit Applet..
_EVENT_FORMATTED_SMS_CB, EVENT_UNFORMATTED_SMS_CB_
> The received Cell Broadcast Message, via an ENVELOPE (CELL BROADCAST
> DOWNLOAD) APDU as defined in TS 31.111 [7] and TS 51.014 [8] and, can be
> either:
\- formatted according to TS 31.115 [9] or an other protocol to identify
explicitly the toolkit applet for which the message is sent;
\- unformatted ( e.g. using a toolkit applet specific protocol ), then the
(U)SAT Framework will pass this data to all registered toolkit applets.
> When the Cell Broadcast Message is received as multiple pages as defined in
> TS 23.041 [5], it is the responsibility of the (U)SAT Framework to link
> single pages together to re‑assemble the original message before any further
> processing. The original Cell Broadcast message shall be placed in one Cell
> Broadcast page TLV included in the _USATEnvelopeHandler_. The message
> parameters shall correspond to the ones in the last received Cell Broadcast
> page (independently of the Page Parameter).
>
> _EVENT_FORMATTED_SMS_CB_
>
> Upon reception of a TS 31.115 [9] formatted Cell Broadcast message, the
> (U)SAT Framework shall:
\- verify the security of the Cell Broadcast message as per TS 31.115 [9];
\- trigger the toolkit applet registered with the corresponding TAR;
When the toolkit applet is triggered, data shall be provided deciphered.
> _EVENT_UNFORMATTED_SMS_CB_
Upon reception of an unformatted Cell Broadcast message, the (U)SAT Framework
shall trigger all the Toolkit Applets registered to this event.
_EVENT_MO_SHORT_MESSAGE_CONTROL_BY_NAA_
Upon reception of an ENVELOPE (MO SHORT MESSAGE CONTROL defined in TS 51.014
[8] and TS 31.111 [7]) APDU as defined in TS 31.101 [6] and TS 51.011 [4] the
(U)SAT Framework shall trigger the Toolkit Applet registered to this event.
The (U)SAT Framework shall not allow more than one Toolkit Applet to be
registered to this event at a time(e.g. if a Toolkit Applet is registered to
this event but not in selectable state the (U)SAT Framework shall not allow
another Toolkit Applet to register to this event).
_EVENT_FORMATTED_USSD, EVENT_UNFORMATTED_USSD_
> The received USSD String, via an ENVELOPE (USSD Data Download) APDU as
> defined in TS 31.111 [7], may be:
  * formatted according to TS 31.115 [9] or an other protocol to identify explicitly the toolkit applet for which the message is sent;
  * unformatted (e.g. a toolkit applet specific protocol) then the (U)SAT Framework will pass this data to all registered toolkit applets.
> When the USSD Message is received as concatenated as defined in TS 31.115
> [9], it is the responsibility of the (U)SAT Framework to link single USSD
> Messages together to re‑assemble the original message before any further
> processing. The original USSD message shall be placed in one USSD String TLV
> included in the _USATEnvelopeHandler_. The USSD String parameters (DCS, PFI,
> CCF) shall correspond to the ones in the last received USSD String
> (independently of the CCF Sequence number).
>
> _EVENT_FORMATTED_USSD_
Upon reception of a TS 31.115 [9] formatted USSD Message via an ENVELOPE, the
(U)SAT Framework shall:
  * verify the security of the USSD Message as per TS 31.115 [9];
  * trigger the toolkit applet registered with the corresponding TAR;
  * take the optional Application Data posted by the triggered toolkit applet if present;
  * secure and send the response packet.
When the toolkit applet is triggered, data shall be provided deciphered.
_EVENT_UNFORMATTED_USSD_
> Upon reception of an unformatted USSD String via an ENVELOPE, the (U)SAT
> Framework shall trigger all the Toolkit Applets registered to this event.
>
> Note: As a consequence of the _EnvelopeResponseHandler_ availability rules
> specified in clause 6.6, only the first triggered toolkit applet is
> guaranteed to be able to send back a response.
_EVENT_EVENT_DOWNLOAD_IWLAN_ACCESS_STATUS_
_EVENT_EVENT_DOWNLOAD_NETWORK_REJECTION_
_EVENT_EVENT_DOWNLOAD_CSG_CELL_SELECTION_
_EVENT_EVENT_DOWNLOAD_IMS_REGISTRATION_
_EVENT_EVENT_DOWNLOAD_INCOMING_IMS_DATA_
Upon reception of an ENVELOPE (Event Download) APDU command as defined in TS
31.111 [7] the (U)SAT Framework shall trigger all the Toolkit applets
registered to the corresponding event.
The following events defined in TS 31.111 [7] shall be raised upon reception
of the corresponding APDU defined in either TS 51.011 [4] or TS 31.101 [6].
> _EVENT_PROFILE_DOWNLOAD_
>
> _EVENT_MENU_SELECTION, EVENT_MENU_SELECTION_HELP_REQUEST_
>
> _EVENT_CALL_CONTROL_BY_NAA_
>
> _EVENT_TIMER_EXPIRATION_
>
> _EVENT_EVENT_DOWNLOAD_MT_CALL_
>
> _EVENT_EVENT_DOWNLOAD_CALL_CONNECTED_
>
> _EVENT_EVENT_DOWNLOAD_CALL_DISCONNECTED_
>
> _EVENT_EVENT_DOWNLOAD_LOCATION_STATUS_
>
> _EVENT_EVENT_DOWNLOAD_USER_ACTIVITY_
>
> _EVENT_EVENT_DOWNLOAD_IDLE_SCREEN_AVAILABLE_
>
> _EVENT_EVENT_DOWNLOAD_CARD_READER_STATUS_
>
> _EVENT_STATUS_COMMAND_
>
> _EVENT_EVENT_DOWNLOAD_LANGUAGE_SELECTION_
>
> _EVENT_EVENT_DOWNLOAD_BROWSER_TERMINATION_
>
> _EVENT_EVENT_DOWNLOAD_DATA_AVAILABLE_
>
> _EVENT_EVENT_DOWNLOAD_CHANNEL_STATUS_
>
> _EVENT_EVENT_DOWNLOAD_ACCESS_TECHNOLOGY_CHANGE_
>
> _EVENT_EVENT_DOWNLOAD_DISPLAY_PARAMETER_CHANGED_
>
> _EVENT_EVENT_DOWNLOAD_LOCAL_CONNECTION_
>
> _EVENT_EVENT_DOWNLOAD_NETWORK_SEARCH_MODE_CHANGE_
>
> _EVENT_EVENT_DOWNLOAD_BROWSING_STATUS_
>
> _EVENT_PROACTIVE_HANDLER_AVAILABLE_
>
> _EVENT_EXTERNAL_FILE_UPDATE_
>
> _EVENT_FIRST_COMMAND_AFTER_ATR_
>
> _EVENT_UNRECOGNIZED_ENVELOPE_
## 6.3 Registration
A Toolkit Applet shall register to events described in 6.2 as defined in ETSI
TS 102 241 [2].
Constants for these events are available in
_uicc.usim.toolkit.ToolkitConstants_ interface in Annex A.
The _uicc.toolkit.ToolkitException_ TAR_NOT_DEFINED shall be thrown if a
Toolkit Applet has no TAR defined and registers to events:
EVENT_FORMATTED_SMS_PP_ENV, EVENT_FORMATTED_SMS_PP_UPD,
_EVENT_FORMATTED_SMS_CB, EVENT_FORMATTED_USSD_.
The _uicc.toolkit.ToolkitException_.EVENT_ALREADY_REGISTERED shall be thrown
if there is another Toolkit Applet already registered to
_EVENT_MO_SHORT_MESSAGE_CONTROL_BY_NAA._
## 6.4 Proactive command handling
There is no extension of the CAT Runtime Environment by the (U)SAT Framework
for proactive command handling.
## 6.5 Envelope response handling
For the events defined in the present document, the following rules apply:
A Toolkit Applet can post a response by using the _post()_ method or the
_postAsBERTLV()_ method defined in ETSI TS 102 241 [2]. The (U)SAT Framework
shall return the Status Word as defined in TS 31.111 [7] and in TS 51.014 [8]
depending on the current NAA.
Case of EVENT_MO_SHORT_MESSAGE_CONTROL_BY_NAA:
\- The rules defined for _EVENT_CALL_CONTROL_BY_NAA_ in ETSI TS 102 241 [2]
apply.
Case of EVENT_UNFORMATTED_SMS_PP_ENV:
_\- See_ ETSI TS 102 241 [2].
Case of EVENT_FORMATTED_SMS_PP_ENV:
\- When the _post()_ or the _postAsBERTLV()_ method is invoked, the (U)SAT
Framework shall, according to bit 6 of the second octet of the SPI defined in
TS 31.115 [9], build a SMS-DELIVER-REPORT or a SMS-SUBMIT.
In case of a SMS-DELIVER-REPORT, the (U)SAT Framework shall return the Status
Word for RP-ACK or RP-ERROR as defined in TS 31.111 [7] and in TS 51.014 [8]
depending on the current NAA.
In case of SMS-SUBMIT the boolean value method parameter shall be ignored by
the (U)SAT Framework. If the SMS-SUBMIT is to be used, the (U)SAT Framework
shall build and issue a Send Short Message proactive command as defined in TS
31.111 [7] and in TS 51.014 [8] depending on the current NAA .
Case of EVENT_FORMATTED_USSD:
  * When the _post()_ or the _postAsBERTLV()_ method is invoked, the (U)SAT Framework shall build a USSD String to be sent back in the Return Result Component contained in the subsequent Facility message. In that case the (U)SAT Framework shall return the Status Word as defined in TS 31.111 [7].
Case of EVENT_UNFORMATTED_USSD:
_\- See_ ETSI TS 102 241 [2].
## 6.6 System Handler management
For the handler management of the _ProactiveHandler_ , the
_ProactiveResponseHandler_ , the _EnvelopeHandler_ and the
_EnvelopeResponseHandler_ , the rules defined in ETSI TS 102 241 [2] apply.
**_USATEnvelopeHandler:_**
**_The single system instance of the USATEnvelopeHandler and the single system
instance of the EnvelopeHandler are two distinct objects instances._**
  * When available the _USATEnvelopeHandler_ shall remain available and its content shall remain unchanged from the invocation to the termination of the _processToolkit()_ method.
```{=html}
``` \- The TLV List provided in the _USATEnvelopeHandler_ are the same as in
the _EnvelopeHandler_.
  * The handler availability of the _USATEnvelopeHandler_ is the same handler availability as the _EnvelopeHandler_ including all the events defined in ETSI TS 102 241 [2].
The following table describes the minimum availability of the handlers for all
the events at the invocation of the _processToolkit()_ method of the Toolkit
Applet. The rules described in this table apply in addition to the rules
described in \"UICC API for Java Card™\"
Table 2: Handler availability for each event
+-------------+-------------+-------------+-------------+-------------+ | EVENT_ | Reply busy | Enve | E | Nb of | | | allowed | lopeHandler | nvelopeResp | triggered / | | | | / | onseHandler | registrered | | | | | | Applet | | | | USATEnve | | | | | | lopeHandler | | | +-------------+-------------+-------------+-------------+-------------+ | _F | Y | Y | Y | 1 / n (per | | ORMATTED_S | | | | TAR) | | MS_PP_ENV | (see Note | | | | | | 1) | | | | +-------------+-------------+-------------+-------------+-------------+ | _F | N | Y | N | 1 / n (per | | ORMATTED_S | | | | TAR) | | MS_PP_UPD | | | | | +-------------+-------------+-------------+-------------+-------------+ | _UNF | Y | Y | Y | n / n | | ORMATTED_S | | | | | | MS_PP_ENV | | | | | +-------------+-------------+-------------+-------------+-------------+ | _UNF | N | Y | N | n / n | | ORMATTED_S | | | | | | MS_PP_UPD | | | | | +-------------+-------------+-------------+-------------+-------------+ | _FORMATTED | Y | Y | N | 1/n (per | | ___ SMS_CB | | | | TAR) | +-------------+-------------+-------------+-------------+-------------+ | _UNFORMATT | Y | Y | N | n / n | | ED_SMS_CB | | | | | +-------------+-------------+-------------+-------------+-------------+ | _MO\ | N | Y | Y | 1 / 1 | | _SHORT_MES | | | | | | SAGE_CONTR | | | | | | OL_BY_NAA | | | | | +-------------+-------------+-------------+-------------+-------------+ | _FORMAT | Y | Y | Y | 1 / n (per | | TED ___ USSD | | | | TAR) | +-------------+-------------+-------------+-------------+-------------+ | UNFORMAT | Y | Y | Y | n / n | | TED ___ USSD | | | | | +-------------+-------------+-------------+-------------+-------------+ | EVEN | | | | | | T_DOWNLOAD | | | | | +-------------+-------------+-------------+-------------+-------------+ | \ | Y | Y | N | n/n | | _IWLAN_ACC | | | | | | ESS_STATUS | | | | | +-------------+-------------+-------------+-------------+-------------+ | _NETWORK | Y | Y | N | n/n | | _REJECTION | | | | | +-------------+-------------+-------------+-------------+-------------+ | _IMS_R | Y | Y | N | n/n | | EGISTRATION | | | | | +-------------+-------------+-------------+-------------+-------------+ | _INCOMING | Y | Y | N | n/n | | _IMS_DATA | | | | | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1: The | | | | | | framework | | | | | | may reply | | | | | | busy and | | | | | | not trigger | | | | | | the toolkit | | | | | | applet if | | | | | | e.g. a PoR | | | | | | using SMS | | | | | | SUBMIT is | | | | | | required in | | | | | | the | | | | | | incoming | | | | | | message and | | | | | | a proactive | | | | | | session is | | | | | | ongoing. | | | | | +-------------+-------------+-------------+-------------+-------------+
## 6.7 (U)SAT Framework behaviour
The (U)SAT Framework is a (U)SAT extension of the CAT Runtime Environment as
defined in ETSI TS 102 241 [2]. In addition, the (U)SAT Framework shall
consider the EVENT_EVENT_DOWNLOAD_* defined in this specification when issuing
the SET UP EVENT LIST system proactive command.
# 7 UICC toolkit applet
See ETSI TS 102 241 [2].
# 8 Geo Location API
The Geo Location API consists of the package _uicc.usim.geolocation_. This
package defines services to allow an Applet to perform a geographical location
operation, depending of the ME capabilities. When a geographical location
operation is requested, the API will follow a defined way to choose either
\"Geographical Location Request\" toolkit command or \"Provide Local
Information\" toolkit command as defined in TS 31.111 [7] to determine the
location information. The result is formatted using GAD shapes as defined in
TS 23.032 [14].
###### ## Annex A (normative): Java Card™ (U)SIM API
The attached files \"31130_Annex_A_Java.zip\", and \"31130_Annex_A_HTML.zip\"
contains source files and html documentation for the Java Card™ (U)SIM API.
###### ## Annex B (normative): Java Card™ (U)SIM API identifiers
The attached file \"31130_Annex_B_Export_files.zip\" contains the export files
for the uicc.usim.* package.
###### ## Annex C (normative): (U)SIM API package version management
The following table describes the relationship between each TS 31.130
specification version and its packages AID and Major, Minor versions defined
in the export files.
+-----------+---------------+---------------+---------------+--------+ | TS 31.130 | uic | uicc | | | | | c.usim.access | .usim.toolkit | | | | | package | package | | | +-----------+---------------+---------------+---------------+--------+ | | AID | Major, Minor | AID | Major, | | | | | | | | | | | | Minor | +-----------+---------------+---------------+---------------+--------+ | | A0 00 00 00 | 1.0 | A0 00 00 00 | 1.0 | | | 87 10 05 FF | | 87 10 05 FF | | | | FF FF FF 89 | | FF FF FF 89 | | | | 13 10 00 00 | | 13 20 00 00 | | +-----------+---------------+---------------+---------------+--------+ | 7.1.0 | A0 00 00 00 | 1.0 | A0 00 00 00 | 1.1 | | | 87 10 05 FF | | 87 10 05 FF | | | | FF FF FF 89 | | FF FF FF 89 | | | | 13 10 00 00 | | 13 20 00 00 | | +-----------+---------------+---------------+---------------+--------+ | 7.2.1 | A0 00 00 00 | 1.0 | A0 00 00 00 | 1.2 | | | 87 10 05 FF | | 87 10 05 FF | | | | FF FF FF 89 | | FF FF FF 89 | | | | 13 10 00 00 | | 13 20 00 00 | | +-----------+---------------+---------------+---------------+--------+ | 10.1.0 | A0 00 00 00 | 1.0 | A0 00 00 00 | 1.7 | | | 87 10 05 FF | | 87 10 05 FF | | | | FF FF FF 89 | | FF FF FF 89 | | | | 13 10 00 00 | | 13 20 00 00 | | +-----------+---------------+---------------+---------------+--------+ | 10.2.0 | A0 00 00 00 | 1.0 | A0 00 00 00 | 1.8 | | | 87 10 05 FF | | 87 10 05 FF | | | | FF FF FF 89 | | FF FF FF 89 | | | | 13 10 00 00 | | 13 20 00 00 | | +-----------+---------------+---------------+---------------+--------+
The package AID coding is defined in ETSI TS 101 220 [1]. The (U)SIM API
packages\' AID are not modified by changes to Major or Minor Version.
The Major Version shall be incremented if a change to the specification
introduces byte code incompatibility with the previous version.
The Minor Version shall be incremented if a change to the specification does
not introduce byte code incompatibility with the previous version.
The package _uicc.usim.access_ contains only constants, therefore it may not
be loaded on the UICC.
###### ## Annex D (normative): USIM API jar files
The attached files \"31130_Annex_D.jar\", contains class files for the Java
Card™ (U)SIM API.
#